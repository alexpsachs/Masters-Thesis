{
    "nuclearace": "Still needs some more testing.\n. The problem is, I have no idea how to use CocoaPods. I understand the benefits, I've just found it easier for Swift based things to just use copy/paste. \n. Added support\n. The reason I didn't use starscream goes back to #2. And from the fact that I've had trouble trying to use full Swift frameworks. Although looking at the API, it is nice that it separates between Strings and Data. Which would simplify some of the client. \n. Another reason I didn't use starscream is that using Swift frameworks automatically means you're limited to iOS 8+. Which is also why I don't distribute this as a framework.\n. Actually, it's really easy to just include starscream. So I might do that\n. I'm actually in the process of moving to starscream per #3.\n. Also, using CocoaPods would mean iOS 8+ only, and I'm not sure if I want to do that right now. \n. http://blog.cocoapods.org/CocoaPods-0.36/\n. Basically you can't have dynamic libraries in iOS 7. And you can't build static Swift libraries.\n. @banjun if you want to open another that will merge. I don't have time to manually sort out conflicts.\n. Also, you don't really need to include an example. One is linked in the README\n. I can look into making it work better with Objective-C, but I didn't write the client to explicitly work with Objective-C. Since I don't really like Objective-C.\n. @lightsprint09 I changed some things and added some new methods that should be accessible from Objective-C.\n. 1.2 has been released, this is going to merged soon.\n. @banjun I think I did it. But I have no idea.\n. @banjun if you want to update the README to include a CocoaPods install section, I'll merge it.\n. @hanishabsigh can you provide a message that fails to get parsed. You can uncomment https://github.com/socketio/socket.io-client-swift/blob/master/SwiftIO/SocketEngine.swift#L409 to see messages before they get sent to the socket.io-client parser.\n. I'm actually finding a few problems with regex. Mostly due to the differences between NSString and String.\n. @hanishabsigh It seems to work for me on the latest. Please note #13 though. Since it can cause the regex to fail sometimes. Which is why I changed some things.\n. @hanishabsigh try after 44e27810766a6ff4879d888bbab220ea8ef6073b\n. This client is able to get this for me:\njavascript\nsocket.emit(\"jsonTest\", {foo: \"string\\ntest test\"})\n. @hanishabsigh so does https://github.com/socketio/socket.io-client-swift/commit/c67e7a3003fc5e9c218335fedec02b643dd7fcfb fix it\n. see https://github.com/Automattic/engine.io/issues/315\n. I wouldn't treat the 1.2 branch as stable enough to warrant defaulting to it. When 1.2 is released I'll merge the 1.2 branch into master\n. Currently CocoaPods gets from the release tags. Which are for the master branch.\n. You can add any query parameters with the connectWithParams method. Unless I'm misunderstanding what it is.\n. swift\nsocket.connectWithParams([\n    \"test\": 2.1,\n    \"d\": \"dassdfasdfasd\"\n    ])\nFor example\n. I'll look into it\n. @Katafalkas @chirag04 Is ab77d72 what you're looking for? I haven't had time to test it yet. I have to learn how.\n. The connectParams option\nSent from my iPhone\n\nOn May 29, 2015, at 9:46 PM, khanhankkhan notifications@github.com wrote:\nwhat replaces 'connectWithParams' on the newest version of socket io for swift 1.2 client ??\n\u2014\nReply to this email directly or view it on GitHub.\n. This seems kind of redundant. Is something breaking?\n. I think I'm going to redo parsing\n. Since it's basically the same as it's been for months\n. Master should handle parsing better\n. Oh, does the socket not get anymore events after that?\n. Because a message of 1 would be disconnect event.\n. Try adding\n\nswift\nsocket.onAny {println(\"got event: \\($0.event) with items \\($0.items)\")}\nIt sounds like the server is closing your connection.\n. 41 means it's a message. And the message is 1. Which is the disconnect event.\n. I'm writing a handler for the disconnect event. But getting a disconnect event usually means the server is doing it on purpose. As most of the time if it's an error you won't get anything.\n. Added handler. Now, unless you can provide evidence that something's going on with the client that's causing the server to disconnect (which is highly possible) I'm going to close this.\n. #18\n. I don't need more information than it wasn't called. \nTry adding\nswift\nsocket.onAny {println(\"got event: \\($0.event) with items \\($0.items)\")}\n. Hm, I'll have to look into it\n. I'll add it. It's like 3 lines of code \n. There's no good way to deal with that though. It would probably require redoing handlers.\n. Rooms are something done on the server. \njavascript\nio.sockets.on(\"connection\", function(socket) {\n    socket.join(\"testRoom\")\n}\n. https://github.com/nuclearace/Socket.IO-Client-Swift/issues/19\n. No, because Objective-C doesn't have variadic functions you have to use an array\n. You can't, but it shouldn't be sent as [{hello: \"world\"}].\nBecause\nswift\nfunc emit(event:String, items:AnyObject...) {}\nis actually the same as\nswift\nfunc emit(event:String, items:[AnyObject]) {}\nBut with some syntactic sugar so you can do emit(\"test\", 1, 2, 3, 4, \"test\" 2.2) \n. Although you're right, it's not right\n. Does Carthage require a whole Xcode thing. Because I explicitly made it so I wouldn't be committing one.  Also, it's not really adding OS X support. I actually don't test at all on iOS really. All testing I do is from OS X.\n. The reason the project has CocoaPods support in the first place is someone added it. Frankly, I hate all the dependency managers for Xcode, and I prefer to use git for dependency tracking.\n. I do agree that the SwiftIO folder should be renamed. It's actually something I've been meaning to do, just been too lazy to do it.\n. > Carthage will only build Xcode schemes that are shared from your .xcodeproj\nI really don't want to include a whole .xcodeproj. I hate that kind of thing in a github repo. I'd rather stick to CocoaPods and/or git.\ntl;dr: I hate Xcode dependency managers.\n. I'd add it, the problem is I don't really know enough about it so that if someone says it's broken, how to go about fixing it.\n. If you can merge the latest master, I'll merge your branch.\n. Does carthage support 1.2\n. Cool, I'll look into this later today. Just some style things that trigger me, but I can change back.\nWhile the style Apple uses is\nswift\nvar variable: Type\nI generally don't like this. Because : is used a bunch, I prefer to only use a space after : when it's used in a function call, not type declaration.\n. Hm, I'm going to have to test around with this a bit. I'm still unsure if Carthage support is something I want to incorporate. \n. The problem is once this is merged, I don't really want to keep up with another dependency manager. And I don't even know how I would keep the carthage one updated\n. Since it makes use of Xcode schemas.\n. I'm in the process of merging this in another branch\n. Can you look at https://github.com/socketio/socket.io-client-swift/tree/carthage\n. I tested to see it would build frameworks. Didn't test if they actually work. I've had difficulties with dynamic frameworks in the past\n. I mean the ones in the merged branch, I wasn't sure if I messed something up.\n. I want to merge the changes to the source files separately from the carthage support. So I'm merging from another branch. https://github.com/socketio/socket.io-client-swift/pull/50 Comment on Carthage here\n. What conditions is this happening? First message? Randomly? When I specific message happens?\n. WebSocket.swift:283\nWebSocket.swift:602\n. What optimization setting is being used.\n. Also, it is actually this line that's causing the crash? https://github.com/socketio/socket.io-client-swift/blob/master/SwiftIO/SocketEngine.swift#L470 i.e Do you have the latest version\n. The only way I could foresee that line causing a bad access is if the client got released\n. https://github.com/socketio/socket.io-client-swift/releases/tag/v1.5.1 might fix this\n. What conditions is this happening? First message? Randomly? When I specific message happens?\n. https://github.com/socketio/socket.io-client-swift/issues/29\n. What conditions is this happening? First message? Randomly? When I specific message happens?\n. https://github.com/socketio/socket.io-client-swift/issues/29\n. Don't add the / to the nsp. Just add \"kwik\"\n. I'll make it so adding it doesn't cause it to crash though\n. Pass everything inside an array. This is how I emulate variadic parameters in objc.\nswift\nfunc test1(a:AnyObject...) {}\nfunc test2(b:[AnyObject]) {}\nThose two functions are basically the same, but in Swift you can do\nswift\ntest1(1, \"test\", [\"foo\": \"bar\"], 2.2)\nWhich will be the same as\nswift\ntest2([1, \"test\", [\"foo\", \"bar\"], 2.2])\n. The CocoaPods version only does Swift 1.1. If you're using Swift 1.2 you'll need to manually install the 1.2 branch. Just copy the SwiftIO folder into your Xcode project.\n. That should've been fixed in 1.2 https://github.com/socketio/socket.io-client-swift/blob/1.2/SwiftIO/SocketPacket.swift#L207\n. https://github.com/socketio/socket.io-client-swift/commit/d308111a8fd4529bf3971632322acf2da56dff20\n. I have no idea how to set up nginx, can you provide a server that does this? Also, does this work with the javascript client correctly?\n. Seems to be some kind of race condition with polling\n. Workaround - have it force WebSockets\nswift\nlet socket = SocketIOClient(socketURL: \"localhost:8080\", options: [\"forceWebsockets\": true])\n. Actually it looks like nginx is doing some kind of caching?\n. I'll try to fix it tomorrow. Basically it's trying to poll constantly and getting a reply each time.\n. It is a cache problem.\n. I'll have to write a method for obj-c, since onAny uses a tuple. Which aren't accessible from Obj-c\n. I think you'd do\nobjective-c\n[socket onAny:^(SocketAnyEvent* e) {\n    NSLog(e.event);\n    NSLog(@\"%@\", e.items);\n}];\n. That's after latest commit\n. Objective-C is so terribly ugly. The Swift version is so much nicer.\n. On any is always called first.\n. https://github.com/socketio/socket.io-client-swift/blob/master/SwiftIO/SocketAnyEvent.swift#L27 Is public and @objc so it should be available to Objective-C\n. Ehhhh, I thought about doing delegation with Objective-C (rather than using blocks) since I don't like how Objective-C translates Swift functions. Also, I'm not an Objective-C dev, my Swift knowledge is 100x more than Objective-C.\nThoughts?\n\n. Hm, what would you have tweaked so that it works better with Objective-C?\n. Is the onAny method ever called?\n. Also I note that your socketURL doesn't specify a port. Is your socket.io server running on port 80? I've had people complain about running socket.io behind nginx.\n. Hm, I seem to be able to connect to a socket.io server on port 80 fine\n. Hm, when I try to use the IP in your code I don't get any messages.\n. @tzapu @pwnsdx where are you declaring your socket? It sounds like it's being deallocated before it's supposed to.\n. Don't add the first slash to the option \n. It should never get to the engine prepended with a slash. Unless you do something stupid like [\"nsp\": \"//chat\"] In which case I'd say your code is broken.\nhttps://github.com/socketio/socket.io-client-swift/blob/master/SwiftIO/SocketIOClient.swift#L107\n. Actually, that's for an old version. https://github.com/socketio/socket.io-client-swift/blob/master/SwiftIO/SocketParser.swift#L186 \n. Are you on the latest version? I'm having trouble reproducing.\n. If so can you provide a minimal server example that reproduces it.\n. Because it sounds similar to https://github.com/nuclearace/Socket.IO-Client-Swift/issues/27\n. Hm, are you sending these emitWithAcks as soon as you connect? I'm noticing a case if you're using polling/websockets the server sometimes doesn't respond to them.\n. Found a race condition\n. Actually finding a few bugs\n. In the meantime, you can try setting a timeout on the ack, and then if you get \"No ACK\" in the ack reply you can resend it. Or you can try forcing WebSockets or polling. Should have a fix by later today\n. Should be fixed from https://github.com/socketio/socket.io-client-swift/pull/44\n. Can you provide a stack trace of the crash? Also, how is the socket being rejected? Is the authentication being done in the first handshake?\n. https://github.com/socketio/socket.io-client-swift/compare/engineerrors to track changes\n. Got a fix coming along\n. @chirag04 this should be fixed in v2.0.1\n. Thanks for the good issue report.\nI don't really know Objective-C well, but from your test code it looks like you're creating a local variable named socket and working with that. Once socket goes out of scope it should be released.\nDoes this happen if you make the socket a member of the viewcontroller?\nI usually have the socket be a member of the viewcontroller, and then do things like this in the viewDidLoad https://github.com/nuclearace/socket.io-client-swift-example/blob/master/TicTacIOiOS/ViewController.swift#L28\n. Also, I should note I have no idea if Objective-C blocks are as powerful as Swift closures.\n. Hm, actually I'm getting this too.\n. What's weird is this seems to work in Swift. \n. Also the code it's highlighting isn't the problem.\n. Swift 1.2 seems to get the line right, but I still can't figure out why it's happening\n. What's even weirder is that it doesn't seem to happen when I do something crazy like\n``` objective-c\nSocketIOClient* gSocket;\nvoid testSocketAck()\n{\n    gSocket = [[SocketIOClient alloc] initWithSocketURL:@\"localhost:8080\" options:nil];\n[gSocket on: @\"connect\" callback: ^(NSArray* data, void (^ack)(NSArray*)) {\n    NSLog(@\"connected\");\n    [gSocket emitWithAckObjc:@\"ack\" withItems:@[@1]](1, ^(NSArray* data) {\n        NSLog(@\"Got ack\");\n        NSLog(@\"%@\", data[0]);\n        [gSocket emitObjc:@\"test\" withItems:@[]];\n    });\n}];\n\n[gSocket connect];\n\n}\n```\n. Ugh, I found a really ugly workaround.\nIf you have a global variable that references your object, and then use that inside blocks it works.\n. @ahallora Actually I think I've found a solution\n``` objective-c\n- (void) sendMessage {\n    __block int i;\n[[self socket] emitWithAckObjc:@\"ack\" withItems:@[@1]](1, [^(NSArray* data) {\n    NSLog(@\"Got ack\");\n\n    [[self socket] emitObjc:@\"test\" withItems:@[]];\n    i = 1 + 1;\n} copy]);\n\n}\n```\nCan you confirm that sending the copy message to the block fixes it.\nIf that's the case, I'll update the readme\n. This is actually a problem with Swift-Objective-C compatibility. I worked out a small demo here\n. I'm having difficulty reproducing, because once you turn off the server, the client should immediately try and reconnect once and fail. It'll then wait 5 seconds and fail again. Then it'll wait 5 more seconds and try again, which depending on whether you've started the server by now will either fail and then succeed the next try, or succeed now.\n. Also there isn't any undocumented options, they're all listed here https://github.com/socketio/socket.io-client-swift#options\n. oops\n. I think I fixed it?\n. Although I forgot to update the description to say it supports Swift 1.2, oh well, I'll do that next version.\n. Let me know @justinmakaila if this still works. I'll merge if it does.\n. @justinmakaila Have a chance to look at it?\n. I renamed it because it fits more with project name, I would've changed them all but I wanted to keep the fiddling with Xcode to a minimum, but it seems I still messed it up.\n. Also what do you mean conflicts?\n. I'm confused, the library itself is causing this generic problem with NSArray?\nYour test code is rather silly, that loop would never execute. Can you provide an example of how you're using it with the library.\nAlso look into upgrading to Xcode 6.3/Swift 1.2. Because I'm not going to be applying fixes to pre-2.0\n. That's really strange, I don't think I'm doing anything that should interfere with NSArray or NSDictionary\n. That's strange, well if it works I'll close the issue\n. Sure open a pull request and I'll review it and make comments. And when it looks good I'll merge it. \n. @ramki982 I merged it\n. What version of Xcode are you using. \n. That's why. I updated the project for Swift 1.2, which requires the Swift compiler in Xcode 6.3. If you can't upgrade to 6.3 you'll have to use the last Swift 1.1 release.\nhttps://github.com/socketio/socket.io-client-swift/releases/tag/v1.5.2\n. Interesting, I haven't really done any leakage checking in a while.\n. Try the latest version. I'm actually unsure on how to build for carthage. Carthage support was added by someone else\n. Can you actually incorporate the frameworks generated by carthage into a project? I tried once and it gave me some errors. \n. You can set the namespace when you create the socket\nswift\nlet socket = SocketIOClient(socketURL: \"localhost\", opts: [\"nsp\": \"swift\"])\nAnd yeah, you'll need to declare the socket to be a member of a class or have global scope.\n. @daniel-shin1104 does that work\n. How is the server set up so I can test it. Half of the stuff socket.io can do is poorly documented or isn't used much.\n. Weird, because that's how I thought I tested it, and it worked.\nJavaScript\nvar io = require('socket.io')(8080, {path: \"/swift\"})\nswift\nlet socket = SocketIOClient(socketURL: \"localhost:8080\", opts: [\"path\": \"/swift\"])\n. I think it works because socket.io is cleaning up my incorrect url and only looking at the end ?transport=\n. It would be a combination of a url with the port and a .path config if the server is using a custom path.. @digitalbrain does that work\n. I'm not sure the best way to handle going into the background. My suggestion would be to close the socket, and then readd it when you come back.\n. Right, that's why I said readd. I'm willing to hear any ideas on how to make coming back from the background better. \nThe library itself is platform independent. I actually do most testing from OS X.\n. Add an onAny handler\nswift\nsocket.onAny {println(\"got event: \\($0.event) with items \\($0.items)\")}\nobjective-c\n[socket onAny:^(SocketAnyEvent* event) {\n     NSLog(@\"Got event: %@, with items: %@\", event.event, event.items);\n}];\n. Why not just do\n``` swift\nsocket.on(\"multipleItems\") {data, ack in\n    if var arr = data?[0] as? [AnyObject] {\n        arr.append(5)\n        println(arr)\n    }\n}\nsocket.on(\"jsonTest\") {data, ack in\n    if var json = data?[0] as? [NSObject: AnyObject] {\n        json[\"bob\"] = \"bob\"\n        println(json)\n    }\n}\n```\n. Also, how did you find out the type of the things? When I try to reflect an array I get things like Swift._ArrayTypeMirror>.\nAre you using it from Objective-C?\n. I'm not against this change, I'm just trying to remember why I did AllowFragments.\n. Ugh, this is a pain in the ass. It's like the pyramid of doom all over again\n. swift\ndispatch_async(self.emitQueue) {[weak self] in\n    if let this = self where this.connected {\n        if this.websocket {\n            SocketLogger.log(\"Writing ws: \\(msg):\\(data)\", client: this)\n            this.sendWebSocketMessage(msg, withType: type, datas: data)\n        } else {\n            SocketLogger.log(\"Writing poll: \\(msg):\\(data)\", client: this)\n            this.sendPollMessage(msg, withType: type, datas: data)\n        }\n    }\n}\nI do like how this one can be rewritten though.\n. Does that look to be a step in the right direction?\n. I'll do some testing later, but I must bed\n. Try adding the log option when you make the socket. \nswift\nlet socket = SocketIOClient(socketURL: \"localhost:8080\", opts: [\"log\": true])\nobjective-c\nSocketIOClient* socket = [[SocketIOClient alloc] initWithSocketURL: @\"localhost:8080\" opts:@{@\"log\": @YES}];\n. That'll let you see all the stuff the socket is doing.\n. Also try seeing if your server is actually sending \"auth_success\". Because that isn't a client event.\n. emit requires an array in Objective-C because I can't do Swift style variadics.\nobjective-c\n[socket emit:@\"echo\" withItems:@[@\"echo test\"]];\nIt's to allow sending multiple items per message.\n. ``` swift\n// Swift method\npublic func emit(event:String, _ items:AnyObject...)\n// vs.\n// Objective-C method\npublic func emit(event:String, withItems items:[AnyObject])\n```\nThey're functionally the same, but the first has some Swift syntactic sugar.\nswift\nsocket.emit(\"test\", 1, \"foo\", \"echo test\")\nobjective-c\n[socket emit:@\"echo\" withItems:@[@1, @\"foo\", @\"echo test\"]];\n. If you're sending JSON you should use an NSDictionary. \n. There's no way for the client to know if a string is json or not. You'll need to use NSDictionary or have your server parse the json string. The client turns NSDictionary into JSON.\n. Are you using Xcode 6.3?\n. You need 6.3 or an earlier version of the socket.io-client\n. Use the cookies option.\n``` swift\nlet cookieProps = [\n    NSHTTPCookieOriginURL: \"http://localhost\",\n    NSHTTPCookiePath: \"/\",\n    NSHTTPCookieName: \"myCookie\",\n    NSHTTPCookieValue: \"234\"\n]\nlet cookie = NSHTTPCookie(properties: cookieProps)!\nlet cookieArray = [cookie]\nlet socket = SocketIOClient(socketURL:\"localhost:8080\", opts: [\"cookies\": cookieArray])\n. However, if you're looking to set actual header fields, that's something it doesn't support. And I don't know why you would need to. Sounds like a bad API if you're doing that.\n. What is false? Does the socket still connect but connected says false? \n. I'll look into it. But Connect is an async method. So it would make sense it would say false right there. \n. Is this app written in swift? If so, you can just create a global variable.\n. How are you creating the client?\n. swift\nlet socket = SocketIOClient(socketURL: \"localhost:8080\", opts: [\"nsp\": \"swift\"])\n```\nWill connect to /swift\n. The client is expecting socket.io 1.0+\n. What does your url look like?\n. Use an Xcode version that has swift 1.2. Or use an earlier version of the client. \n. javascript\nsocket.on(\"canUpdate\", function(amount, ack) {\n    ack(true)\n})\n. You can send cookies during the handshake using the \"cookies\" options.\n. No idea, I've not seen that before.\n. I updated the objective c example in the readme. It should provide an example\n. If you add code directly inside the block passed to the function is it executed? Sounds like it could be a swift-objective-c issue \n. @sauvikatinnofied can you create the socket with logging on and pastebin it?\n. Also @cmorss, I'll have to relearn how to do it myself. I didn't add CocoaPods support, someone else did. What imports have you tried?\n. @sauvikatinnofied are you calling the ack function on the server?\n. I recall if you follow the steps to creating a cocoa project, it's something shorter.\n. @PengsreangSrun Are you using emitWithAck?\n. Also, it's up to the server to actually respond to that ack.\n. Do you know if the server is supposed to respond with something. Also do other events work?\nSent from my iPhone\n\nOn Jun 7, 2015, at 9:19 PM, PengsreangSrun notifications@github.com wrote:\n@nuclearace I used with emitWithAck but i cannot receive anything back!\n\u2014\nReply to this email directly or view it on GitHub.\n. It looks like it wants \\n to be escaped before sending\n. Is it being notified of a reconnect event? \n\nWhen I turn wifi off from my laptop running OS X I get\nGot error: The operation couldn't be completed. Socket is not connected\nSocket reconnecting: The operation couldn't be completed. Socket is not connected\nReconnect tries left: -1\n. Also, does this iPad have 3G/LTE?\n. This must be some weird case where it handles differently than OS X. Because when I test on OS X it always emits an error if the wifi drops.\n. Hm, when I did a simple test with an iphone it seemed to handle going into airplane mode and when it just loses wifi.\n. Hm, when I try this on the iphone simulator it fires a disconnect.\n. Okay, but when I do it from an actual iphone it doesn't, weird.\n. Weird, I'll look into it.\n. I'm having trouble reproducing. Going into the background is something the library doesn't account for, because I don't target iOS specifically.\n. Yes I know, I'm saying I wrote the library to be agnostic as to what platform it's on i.e. OS X/iOS. But I can't get eventCode to equal .HasSpaceAvailable\n. Commenting out that line should actually break things, since it's not sending any messages. But I guess it shows that it's happening somewhere during sending.  Does this happen when using polling or WebSockets?\n. How often are you emitting?\n. I think 60 times a second is kinda insane for socket.io. Have you tried doing any instruments profile?\n. Also is this the latest version of the client?\n. Well there is no garbage collector. It's all done with ARC. At least from the client side. So unless this is a Objective-C/Swift issue, it should be reproducible from Swift.\n. To me it looks like it thinks the things sent to emit are being leaked.\n. Yeah sending a lot messages very quickly seems to stack the memory up.\n. I'm having trouble pinpointing it. It doesn't seem to detect a leak when using Instruments. Maybe some sort of caching going on?\n. Okay, I think it's coming from https://github.com/socketio/socket.io-client-swift/blob/master/SocketIOClientSwift/SocketIOClient.swift#L283\n. Gonna have to test this one out. Unless I'm missing something, it seems like Swift is retaining when it shouldn't anymore.\n. Yeah, instruments not detecting leaks was annoying. It's actually occurring very early in the emit process.\nhttps://github.com/socketio/socket.io-client-swift/blob/master/SocketIOClientSwift/SocketIOClient.swift#L260 I don't think it's correctly releasing items.\n. Huh, just changing it from\nswift\n        dispatch_async(emitQueue) {\n            self._emit([event] + items)\n        }\nto \n``` swift\n        let arr = [event] + items\n    dispatch_async(emitQueue) {\n        self._emit(arr)\n    }\n\n```\nGives a slight improvement.\n. Last time I checked, no. From the testing I did it seems to be related a closure capture. Which leads me to believe it's actually just Swift's ARC. It could also be the memory tracking isn't great for tracking Swift. \n. I haven't had time to create a minimal reproducing case.\n. You need to use the connectParams option. Should be in the readme under options. \n. No it's a value of that dictionary. Opts is where you turn on logging and things like that. But it's where I moved connectParams\n. swift\nlet socket = SocketIOClient(socketURL: \"localhost:8080\", opts: [\n    \"connectParams\": [\n        \"blah\": \"blah\"\n    ]\n])\n. If you have logging on, does it say anything? Do you have a custom socket.io path defined?. iOS doesn't allow background execution of WebSockets as far as I know.\n. That's an old version, try updating.\n. Oh I know why. It's because NSURLSession is holding a strong retain to the engine\n. Also, what do you mean receive data? Are events not working, or are you wanting an ack?\n. If you want an ack, I don't see any emitWithAck. Check the front readme for what that would look like in Objective-C.\n. I'm working on it. Swift 2 breaks the regex library I'm using pretty good\n. You can try using the swift-2 branch, but beware, some things changed, and I'm still testing things.\n. Also if you notice any edge cases where it breaks let me know.\n. Changes will be tracked in the #96 \n. @lightsprint09 any idea why the build is failing? I haven't made any radical code changes.\n. Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'XCTestConfiguration isn't available'\n. Also, at some point we should probably add tests for OS X\n. It's best to default to weak. Especially for async.\n. @lightsprint09 I think the reason travis is failing is because of xctool. I think there's a bug in the 0.2.5 version that they just upgraded to.\n. @bocodigital I'll merge this into master and push a new pod once Xcode 7 is released fully. \n. Going to merge this over since Xcode 7 is going to be coming out soon\n. @bocodigital There should be a new version on cocoapods\n. What's the crash?\n. @sovannarithsok Do you have a stack trace?\n. What do you mean doesn't have a stack trace? If it crashed I would think it would have some sort of stack trace? How easy is it to reproduce?\n. Hm, I noticed in your OP that you said you're first creating it with local scope, it should be a property of a class. But as for the crash I'm not really sure. The second screenshot looks like a crash in one of the libraries I'm using.\n. Also the first screenshot leads me to believe that perhaps the client is being released but the engine still thinks it exists. But I don't think that should be happening (anymore)\n. Okay, I'm seeing a weird crash when the pingInterval is set to something that small.\n. I see what's going on\n. You'll need to convert it into either NSData, or an array of ints before you can send it.\n. As for converting, I'm not exactly sure. I've never worked with that specific use case.\n. Something must not be configured right, are you sure that your socket is connected when you're sending?\n. The simplest would be\nobjective-c\n[socket emit:@\"test\" withItems:@[@1]];\nAlso be sure this isn't a case where the socket is going out of scope (ie you actually declare the socket inside a method and not as a property). Also, I would setup all your event handlers before you call connect.\n. Emit takes an array of items. This is because Objective-C doesn't have Swift variadics.\n. If you're using Objective-C you need to put things inside an NSArray and then pass it to emit. And you can include NSArray, NSDictionary (JSON), NSString, and literals. But don't expect to send a json string and the server to handle it as json. If you have to send JSON you need to send it as a NSDictionary.\n. That's weird, I'm not exactly sure what could cause that. I'll try making a small change to master.\n. @hankbao Have you tried the latest master?\n. Done\n. Any luck?\n. The sid can still be nil if there is no engine attacked, which should really only happen during a reconnect.\n. What do you mean the server is receiving a nil sid? I thought the issue was the client's sid was still nil after connect.\n. Oh, there was an old issue about netty-socketio I guess this is why. Looking into it.\n. Actually, I was doing something wrong.\n. Okay, it looks like the node.js version correctly creates a sid when you force websockets. I've never tried setting up a netty-socketio server, is there an easy guide or something?\n. @NachoSoto Can you checkout master and see if it's still broken?\n. @NachoSoto Have you checked if it's fixed?\n. Do you have JavaScript clients that force WebSockets connecting to this server?\n. I'll try to look into it when I get home.\n\nIf you're familiar with setting up java servers, the actual code is really simple\n\nI've done a bit of Spring stuff, but that's about it.\n. Looks like it's fixed.\n. Have you tried creating the socket with forcePolling\n. Would it be possible to create a small project that reproduces it? Because I'm having trouble reproducing it. \nSent from my iPhone\n\nOn Jun 21, 2015, at 9:23 PM, PengsreangSrun notifications@github.com wrote:\nI tried both of forcePolling and forceWebsocket, but it was useless!\n\u2014\nReply to this email directly or view it on GitHub.\n. Any more on this issue?\n. I haven't been able to reproduce it.\n. Oh, yeah pongsmissed should probably be reset on connects.. I need a stack trace\n. #97 continue in\n. Probably lost in a refactoring\n. It's fixed in the latest master, I'll push a new minor version later \n. > why wasn't this written in Objective-C\n\nBecause Swift is much nicer than Objective-C, and is the future of Apple development. \nAs for your problem, are you trying this from Xcode 7? Because if so, you'll need to checkout the Swift 2 branch.\n. https://github.com/socketio/socket.io-client-swift/tree/swift-2\n. What version of the client are you using?\n. That sounds like the Swift version, in which case it's Swift 1.2 with xcode 6.3. What version of socket.io-client did cocoa-pods install?  If you just copied the example from the README you'll need to update the version it installs to 2.3.6.\nI should probably just update the README each time.\n. If what @banjun says is correct, I'll update the readme to include that.\n. This is a question I have no idea how to answer, I don't really use CocoaPods much.\n. How are you closing the old socket?\n. swift\nlet socket = SocketIOClient(socketURL: \"blah\", opts: [\"log\": true])\n. I haven't been able to reproduce it.\n. I'm having trouble reproducing with your example app\n. Hm, if it only happens on mavericks I would say it's a bug in NSURLSession in mavericks\n. This isn't really a problem. The reason it takes an array is because socket.io lets you send multiple items per message. With Swift it's easy to get around using variadic parameters. I'm not aware of an easier Objective-C solution than to use the equivalent array of AnyObject.\n``` swift\n// Swift\npublic func emit(event:String, _ items:AnyObject...)\n// Objective-C\npublic func emit(event:String, withItems items:[AnyObject])\n```\n. It really isn't an issue. The reason it takes an nsarray is because with socket.io you can send multiple items with one message. \n. It won't be sent as an array, the client will go through each item in the array and parse it. The Swift and Objective-C APIs are functionally the same, Swift just adds some syntactic sugar that will turn\nswift\nsocket.emit(\"event\", 2, 3, [\"test\": test\"])\ninto\nswift\nsocket.emit(\"event\", [2, 3, [\"test\": test\"]])\nBut this doesn't exist in Objective-C (that I'm aware of).\n. Seems to be working for me.\n. @lightsprint09 Which version did you downgrade to?\n. If your git branch is detached from HEAD if you do git status it should tell you what commit you're on.\n. Okay, I think I broke namespaces.\n. How are you trying to join the namespace?\n. How about\nswift\nsocket!.nsp = \"/\\(game.name)\")\n. If this this is just a straight OS X command line project you'll need to call CFRunLoopRun() at the end of main.swift I believe. Also, don't add handlers after calling connect. While they'll probably get added before it connects, it's better if you add them before. \n. I'll look more into it tomorrow though \n. It's because by default with OS X command line programs they don't have a run loop, the program runs until it reaches the end of main. \n. I don't think this one is going to be easy to debug. My only suggestion would be to turn on socket logging and see if a client is trying to send/receive the events that fail.\n. I've never seen a crash there. What are the sircumstances?\n. It's hard for me to debug because I don't have an iOS device, and I don't think the new Xcode's have iOS 7 simulators.\n. I can try bumping the version of the WebSocket library\n. For production? Probably, and if that fixes it, it's a bug in Swift.\n. Actually might be related to https://github.com/daltoniam/Starscream/issues/77\n. From what I've gathered, this is actually a bug in Swift 1.2. Probably some bad optimization that it's doing. Hopefully it gets fixed in Swift 2\n. Can anyone confirm that this is fixed in Swift 2?\n. I don't have a 32-bit device to test on, so it's kind of hard for me to debug\n. It's a known bug, currently lowering the optimization level is the only way to fix. It's because of bad optimization on 32 bit devices that the Swift compiler is doing\n. I really have mixed feelings about Carthage. I prefer to not include Xcode stuff in the repo. That's why I had a separate branch for Carthage. \n. I'll look into it again tomorrow. \n. @NachoSoto Have you checked that this doesn't break CocoaPods? If it doesn't break CocoaPods I'll merge it in. The only thing I'm going to have to work out is how I should develop it (properly) without breaking the Carthage support. (I'm not a Cocoa/iOS/OS X dev, I just know Swift fairly well). And the last time I tried working with Carthage, the frameworks it output always seemed to be broken for me (I was probably doing something wrong)\n. Doesn't seem to break it.\n. Are you on Xcode 6.4? Sounds like a Swift version error.\n. You'll need the latest version of Xcode, or find a version of the client that works with that version.\n. Also note that older versions of the client are probably buggy\n. There's no way to know when an emit is sent, it's all done asynchronously. The only thing you can be sure of is the order that they're sent out.\n. Well for one I think your socketURL is a little off.\nswift\nlet socket = SocketIOClient(socketURL: \"1.1.1.1:8080\")\nAlso, I wouldn't try emitting until after the socket is connected. And I wouldn't connect until all your handlers are added.\n. Are your emits called before the socket actually connects? If you need them to be called as soon as the socket is connected you can put them into a handler for \"connect\".\n. @Beck-Sisyphus It's up to the server to respond/request an ack. If the event isn't supposed to respond with one then it won't send one, and then ack will be nil.\n@JAManfredi If the client's deinit is being called then it's going out of scope. You always want to make sure that the client is in scope. Changing the engine's reference to strong is causing a reference cycle, so neither of them get released.\nThe example on the README is assuming you put it into main.swift and then add a run loop via CFRunLoopRun()\n. Once the connect event is emitted the socket is connected.\n. I'm not sure, I'd have to see how you're actually declaring the socket and where.\n. I don't quite get what you're asking. What do you mean the correct syntax?\n. ``` javascript\nvar json = {\n    test: \"test\",\n    bob: 1\n}\nfor (key in json) {\n    console.log(key)\n}\n```\nYou mean something like this?\n. https://github.com/socketio/socket.io-client-swift/issues/182 I ran into this error message here\n. See https://github.com/nuclearace/Socket.IO-Client-Swift/issues/19\n. It's on the readme \nobjective-c\n[socket emitWithAck:@\"canUpdate\" withItems:@[@(cur)]](0, ^(NSArray* data) {\n    [socket emit:@\"update\" withItems:@[@{@\"amount\": @(cur + 2.50)}]];\n});\n. Should be fixed\n. The problem with emitWithAck is I believe it's up to the server to send the ack. I don't really know of a best practice to assure that the data was sent. Have you experienced this as a problem?\n. What's the crash?\n. Are you building this from Carthage? Because I've always had errors like this when using Carthage builds. I'm not the one who added Carthage support, so I don't really know how to fix them.\n. Oh, yeah. That's basically the same thing Carthage will do. It's something to do with dynamic frameworks I think. You could just try including the Swift files inside your App, you'll need to import the Swift bridging header Xcode generates.\n. I'm not entirely sure then, I've never had much success creating frameworks.\n. If you just copy the files directly into a project and add them to your target it should work fine. As for the Library not loaded: @rpath/SocketIO.framework/SocketIO I've gotten that before and had no idea what was going on, which is why I'm partial to copying Swift project source files.\n. If you copied them it should work without importing anything. You just have to make sure you've added the files to your build target\n. Oh you're using this from Objective-C. In that case you're going to need to import your auto generated project header, and then you may need to do some forward declarations. I can never remember exactly what to do since I don't use Objective-C\n. This is the test code I used for Objective-C testing https://gist.github.com/nuclearace/675036e113150f6cc0e1\n. Where #import \"SwiftIOObjc-Swift.h\" is the Auto-generated Swift bridging header\n. That's because the import is dependent on the name of your project. \n. 1. Create new Swift single view iOS App named TestTest\n2. Copy all *.swift files from socket.io-client-swift into your project. Making sure to add them to your target.\n3. Create new Objective-C file.\n4. Add #import \"TestTest-Swift.h\" to file\n``` objective-c\nimport \nimport \"TestTest-Swift.h\"\n@interface TestTest : NSObject\n@property(readwrite) SocketIOClient* socket;\n\n(id)init;\n\n@end\n@implementation TestTest : NSObject\n\n\n(id)init\n{\n    if (self = [super init]) {\n        _socket = [[SocketIOClient alloc] initWithSocketURL:@\"test\" opts:nil];\n    }\nreturn self;\n}\n\n\n@end\n```\nWorks for me\n. Well that import is specifically if you're using CocoaPods.\n. Also under the section for installing manually it links to the document that Apple provides for mixing Objective-C and Swift. Your problem is mentioned under Importing Swift into Objective-C\n. Some tests would be probably be good. Right now this is what I'm using for testing. https://gist.github.com/nuclearace/12c52b9fe910a9402fcc It's pretty crude at the moment. But it gives an idea of how I was testing it.\n. You can probably remove the cytu.be things in the tests. I only use that to make sure I haven't completely broken everything\n. Can we include the server as well?\n. How else would anyone run the tests?\n. Is there an issue with just have a TestServer directory in this repo?\n. I'm getting some errors while testing. They look like it could actually be Swift not compiling things correctly. Does this happen to you?\n. Actually nvm. I think it's something with the server.\n. This is really weird. And it's not really easy to pick apart what's going on, at least for me. I'm not used to doing iOS/OS X unit testing.\n. What's weird is when I try and test the buffer myself using another server it seems to work. \n. But I'm looking at your server in debug mode it it's sending correctly. So it must be something weird happening on the client.\n. I bet I know what's happening. It's a bug in the client.\n. Maybe, TBH I'm not really sure what's going on.\n. I'll have a closer look tonight.\n. What's weird for the tests that fail is that it looks like it's not even really emitting those events. Like it looks like it's handling the connect event when it really should be handling emitJSON\n. I feel like weird things are happening with the tests.\n. Specifically with the ack tests.\n. Okay I see what's going on\n. https://github.com/socketio/socket.io-client-swift/commit/150e26aefd8cc8b5b2bbfba8311bfd9862bb1927 should fix things. I noticed some tests still fail when be run all at once. But they pass when run individually.\n. No idea.\n. Looks fine to merge to me. Is there anything else you wanted to do?\n. What conditions does this happen?\n. Kinda need more information, some logs would be nice.\n. Also merging with #116 since they're probably the same thing.\n. You'll need to use the Swift-2 branch\n. There'll be an error event emitted.\n. Probably because you're not using the Swift-2 branch\n. I wouldn't think it would be useable from watchOS in the first place. Do the watches even have networking capabilities? I thought you would have to use the iPhone and push stuff to the watch.\n. I would say yes, since it's a WebSocket issue.\n. The ack will be null if the server didn't request an ack.\n. swift\nlet socket = SocketIOClient(socketURL: \"localhost:8080\", opts: [\"connectParams\": [\"thing\": \"value\"]])\nYou could use connectParams\n. objective-c\nSocketIOClient* socket = [[SocketIOClient alloc] initWithSocketURL: @\"localhost:8080\" opts: @{@\"connectParams\": @{@\"thing\": @\"value\"}}];\n. @mohdsafadsaal The config stuff has moved to the SocketManager in the latest version.. @bdavid68 It's crude, but this shows some basic usage: https://github.com/nuclearace/socket.io-client-testing/blob/master/Sources/main.swift. It's because Objective-C doesn't have variadics and apparently Swift 2 makes it so it won't bridge to NSArray. Really quite annoying. I'll have to make a separate API for Objective-C like I do for emit.\n. Should be fixed. I'm going to look into a better solution. I really want to use Swift's variadics, but it annoys me to have two APIs. \n. Eh, I'm not going to, but I'd rather just drop support for Objective-C. The Swift API is much better. But most places still seem to use Objective-C, so I'll try to make the Objective-C API as clean as I can.\n. Yeah the blogpost is a bit outdated now. But I'm having trouble reproducing. Wrapping the data in array actually sends the data inside an array for me. \n. You can try launching your server with\nDEBUG=* node index.js to see what's actually going on.\n. Right now all handlers are executed on the main thread. I've been meaning to add an option for changing it though\n. The only issue I could foresee with adding handlers somewhere where you're not connecting is you're actually adding handlers to a different socket instance. Because I generally always have an addHandlers method that attaches the handlers, and connect somewhere else.\n. Stupid Objective-C\n. It's because of some changes that'll be made in Swift 2 I believe.\n. Is the socket a property of some object/controller? You can also try turning on logging via the log option.\n. Also, are you declaring the socket locally? Because the socket should be a property of an object. \n. I think this is a case of Apple not allowing real multitasking. I think you're calling close but then your app gets suspended. So maybe create a background task and then close the task when you get a disconnect from the server. \n. Yeah, this is where I'm not entirely sure what the best thing to do is. I'm not an iOS developer. I just know Swift, and wrote the library in Swift. If you want and try and follow what I did in the app I based this on here's the start of the shutdown process.\nhttps://github.com/nuclearace/CytubeChatiOS/blob/1.1/CytubeChat1.0/AppDelegate.swift#L40 Again, I have no idea if this was good or not, it just seemed to work.\n. I'm not sure how to go about making this better. This is mostly because iOS doesn't play nice with background execution. There might be things I could do if this library were only for iOS, but it's also for OS X (and in the future, maybe open source Swift)\n. https://github.com/socketio/socket.io-client-swift/commit/0fd8a9540bd78280a9ad775fac5cfed1d778e671\n. I'm having trouble reproducing.\n. One thing I did run into when testing on iOS 9 is that it requires SSL, unless you specify as thing in the info.plist.\n. Can you create a small project that reproduces the problem? Also include the server.\n. I've never been able to reproduce this. I assume it's something to do with how the server is set up\n. Hm, I know that there was a case where the flask implementation of socket.io had an issue with the client because the author of the implementation didn't know you could connect directly to with websockets.\n. Yes, it works fine on a basic node server\n. So it sounds like it could be a problem with the simulator?\n. That would explain why I wasn't able to reproduce it, since I do all my testing using OS X\n. My only concern is that the new enum isn't exposed to Objective-C. Other than that it looks good. \n. Probably a problem with engine.io\n. What xcode version are you using.\n. Probably using a new version of Xcode\n. I think this is a limitation of the WebSockets library I use. Try forcing polling as a workaround until I can investigate further.\n. Also could be related to something I just fixed/updated\n. After the last update?\n. I'm not sure if that's possible. iOS multitasking is pretty restrictive. \nSent from my iPhone\n\nOn Aug 20, 2015, at 4:41 AM, mp3il notifications@github.com wrote:\nHi,\nAny example of a possible usage of socket.io in a background task? (when the iOS app isn't in the foreground)\nI'm looking for a way to keep sending data to the server even if the screen is locked/the user moved into another app.\nThanks\n\u2014\nReply to this email directly or view it on GitHub.\n. I haven't really looked into it, since I wrote this library to be platform independent. But I think it has to with it only allowing VoIP connections in the background.\n. Yeah, but I actually have no idea how to properly do it with this library. (If it's even possible)\n. No, if you need swift 2.0 you'll need to manually install it from the repo. \n\nSent from my iPhone\n\nOn Aug 24, 2015, at 8:29 AM, Christophe Braud notifications@github.com wrote:\nHi,\nDo you have a pod for Xcode 7 and Swift 2.0?\n\u2014\nReply to this email directly or view it on GitHub.\n. If you checkout the swift 2 branch it is. \n\nSent from my iPhone\n\nOn Aug 24, 2015, at 10:15 AM, Christophe Braud notifications@github.com wrote:\nThe source code is compatible with Swift 2.0?\n\u2014\nReply to this email directly or view it on GitHub.\n. Was this with Swift 2?\n. What version of socket.io are you using?\n. Also is this being compiled on Xcode 7 beta?\n. Is there a particular case when this happens?\n. Well, It looks like it's happening inside the printQueue, so if you turn off logging it shouldn't crash.\n. How are you sending the data. Like what does the server emit look like?\n. Might be related to https://github.com/socketio/socket.io-client-swift/issues/116\n. You can try forcing polling, so that it doesn't use the websockets library, which seems to be causing the crash.\n. Rooms are a server side feature.\n. http://socket.io/docs/rooms-and-namespaces/#rooms\n. I don't understand what problem you're running into\n. I don't know if that will cause any problems, I didn't create the websocket library. \n. Thanks\n. What version of the JavaScript client are you using?\n\nSent from my iPhone\n\nOn Aug 31, 2015, at 4:52 AM, Ludovico Russo notifications@github.com wrote:\nI'm using the flask-socketio server in combination with js socket.io-client that works very well, however, I'm not able to connect with socket.io-client.swift.\nThis is the code I use in js:\nvar path = 'http://localhost:5000'\n    var socket = io.connect(path);\n    console.log(path)\n    socket.on('connect', function() {\n        socket.emit('connected')\n        console.log('connected')\n    });\nand this in swift\nlet socket = SocketIOClient(socketURL: \"http://localhost:5000\", options:[\"log\": true])\n...\nfunc socketHandler() {\n        socket.on(\"connect\") {data, ack in\n            println(\"socket connected\")\n        }\n```\n    self.socket.on(\"added\") {data, ack in\n        println(\"added\")\n    }\nself.socket.on(\"error\") {data, ack in\n    println(\"error\")\n}\n\nself.socket.onAny{println(\"got event: \\($0.event) with items \\($0.items)\")}\n\n}\n```\n...\n override func viewDidLoad() {\n      ...\nsocketHandler()\n    self.socket.connect()\n...\nHere is the logs of swift client\n2015-08-31 10:51:34.281 test[34757:3990559] SocketClient: Adding handler for event: connect\n2015-08-31 10:51:34.321 test[34757:3990559] SocketClient: Adding handler for event: added\n2015-08-31 10:51:34.323 test[34757:3990559] SocketClient: Adding handler for event: error\n2015-08-31 10:51:34.323 test[34757:3990559] SocketClient: Adding engine\n2015-08-31 10:51:34.323 test[34757:3990559] SocketEngine: Starting engine\n2015-08-31 10:51:34.323 test[34757:3990559] SocketEngine: Handshaking\n2015-08-31 10:51:34.323 test[34757:3990559] SocketEngine: Doing polling request\n2015-08-31 10:51:34.368 test[34757:3990561] SocketEngine: Got polling response\nThe http request the two codes generate are different:\nGET /socket.io/?EIO=3&transport=polling&t=1441010930064-34&sid=27b39693eafe4017a3677dc105cd1ccf    # Javascript\nGET /socket.io/?transport=polling&b64=1 # Swift\n\u2014\nReply to this email directly or view it on GitHub.\n. Is there any kind of logging you can turn on for the server? \n\nSent from my iPhone\n\nOn Aug 31, 2015, at 8:02 AM, Ludovico Russo notifications@github.com wrote:\n1.3.6, with flask-socketio compatible with socket.io 1\n\u2014\nReply to this email directly or view it on GitHub.\n. What happens if you try to force websockets on the client?\n. Also, this wouldn't be the first time I've seen a socket.io server not properly handle missing request fields. https://github.com/socketio/socket.io-client-swift/issues/100\n. Well with that it looks like whatever WebSocket library flask is using doesn't like WebSockets. Or it's because the flask-socketio server isn't handling the request properly\n. On a standard node.js socket.io server, if the server is configured to use websockets you can have the client only use websockets.\n\njavascript\nvar socket = require('socket.io-client')(\"http://localhost:8080\", {transports: [\"websocket\"]})\nAnd this is reflected in the Swift client.\nswift\nlet socket = SocketIOClient(socketURL: \"localhost:8080\", opts: [\"forceWebsockets\": true])\n. Does travis support Swift?\n. I'll talk to @rauchg and see about what we can do for travis-ci testing. I know at one point it was turned on for this repo.\n. Would it be possible to add a before_script that launches the node server? I know that the travis environment has node installed\n. Well if that's the case, would it make sense to just stand up a test server that the tests point to?\n. Yeah, I have a VPS that I use. The only thing is that if the tests change I'd have to manually update the test server. Or find a way to auto-update\n. I think temporarily I'll just manually update the server\n. So, it looks travis is running into some kind of problem\n*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'API violation - multiple calls made to -[XCTestExpectation fulfill] for connect.'\n. Eck, it seems to be the same problem of sometimes the test pass and other times it fails\n. https://travis-ci.org/socketio/socket.io-client-swift/builds/78425251\n. Yeah when run locally all the tests pass\n. The most common thing seems to be an error dealing with multiple calls to -[XCTestExpectation fulfill] like I posted above\n. If it's getting there that means either the client got released or something called stopPolling, which gets called in close.\n. It looks like from your picture that something has called close on the engine. In which case it's normal to get to this check.\n. Although I believe that this check is from an earlier version of the client where the engine was only added once. I think it could probably be taken out\n. I guess the right thing to do would be to mock a socket.io server. But I really don't feel writing a mock server.\n. Isn't it something like\n``` objective-c\nimport \n``\n. Nice, I thought it might have something to do with too many connections. This also speeds up the tests significantly.\n. Is this an issue though? Specifying https should be enough\n. I don't seesecurelisted on the README for options\n. I'll add something to the README\n. I have no idea, this doesn't seem like it would be because of this library.\n. I'll merge this, but I'm going to make a few changes.\n. I remember getting an error like this before. I don't remember what I did to fix it... I think it has to do with dynamic frameworks\n. You'll need to check out the Swift 2 branch if you want Swift 2 support \n. I would suggest manually installing it \n. Couple of things:\nI'm not really a fan of guard. I think just using ifs is fine.\nI also do not like using Swift's error handling unless absolutely needed. Use optional if you can.\n. Also, I applaud you for trying to use my earlier style system, but I've decided to go with the flow and use a space after:`  You've kinda mixed and matched, I'd appreciate it if you cleaned it up.\n. I just don't see the need for guard, especially in these use cases. An if seems just as effective.\nAs for try/catch... It's more because I don't like the way Swift does it. While I understand the reason why you need to do do {} catch I just think it's ugly, whereas using optionals, while it means you don't get the specific reason for the failure, is better. At least in this case. Since we don't really care about a specific reason for failure.\nAnd like I said, I really wish Swift would introduce Haskell's/Scala's Either type, or Rust's Result type. It would make exception handling prettier imo.\nhttp://www.scala-lang.org/api/2.9.3/scala/Either.html\n. The point of Either/Result is you don't need special error handling, you can just pattern match on Left and Right. Left being used for an error message string, and right for the successful value.\n. I would prefer if we stayed with optionals.\n. Also, here's an example of Either in Swift.\n``` swift\nenum Either {\n    case Left(E)\n    case Right(T)\n}\nfunc testEither(n: Int) -> Either {\n    if n < 0 {\n        return Either.Left(\"Less than 0\")\n    } else {\n        return Either.Right(n + 4)\n    }\n}\nlet a = testEither(0)\nswitch a {\ncase Either.Left(let error):\n    print(\"error: (error)\")\ncase Either.Right(let value):\n    print(\"Success: (value)\")\n}\n```\n. Yeah, I wasn't suggesting implementing Either in Swift for the library. I suspect it'll be added to Swift later. Since it's a major feature of functional languages. And Swift draws a lot of influence from functional programming.\n. This looks good to me. Is it ready for merging? Or was there something else you wanted to do\n. You need to use the Swift 2 branch\n. Also, I have no idea how to get carthage to compile the Swift 2 branch.\n. I'll have to look into this later, I know little about carthage building.\n. And if you really need too. You can add the swift files manually to your project. \n. It disgusts me that this is possible in socket.io. I would suggest not using non-string types for events, it just seems like bad design.\n. The emit would be\nswift\nsocket.emit(\"whisper\", [\"msg\": msg, \"nick\": s.username, \"name\": data.uname])\n. Define couldn't send. Were you getting a compile error? Or the server wasn't receiving the message\n. Does the socket successfully connect to the client? Have you made sure that you're scoping the socket correctly? I feel like 80% of the time people say it doesn't work is because they don't understand how scope and ARC work in Swift.\n. Any progress?\n. Does Xcode 6.4 even have the OS X 10.11 SDK?\n. I still think this might be a toolchain issue. You should try using Xcode 7 and the swift 2 version of the client. \n. Two things. Generally I take the approach that unless there's an explicit reason to perform a strong capture, always perform a weak capture. This way you avoid crazy cases where you've got a strong reference that's keeping your object alive.\nAlso, the weak references in the WebSocket are intentional. https://github.com/daltoniam/Starscream/commit/889d2880eb4585373b1bc3907574399347d440ff\n. @hankbao I thought you fixed that in the thing I merged yesterday? Is it still present in the default WebSocket? I generally try to back-patch those sort of things. If it's still an issue there I'd make an issue there.\n. You're welcome to provide a fix, I'm having trouble reproducing it on the swift-2 branch. But I do most of my testing on OS X.\n. @hankbao That's fine. I don't think this is really a major issue \n. > dispatch_* is guaranteed to be invoked some time in the future, which means that the cycle will always be broken.\nI wasn't aware of that\n. I would prefer to keep the WebSockets library as is. If you think the weaks are uneeded, make an issue on that repo I generally try to keep up with that\n. Taking the weaks out is fine if what you say about dispatch_* always executing the closure is true. I just wasn't sure about the WebSocket one, since I didn't write it. \n. The ones in https://github.com/daltoniam/Starscream/commit/889d2880eb4585373b1bc3907574399347d440ff Not sure if you removed some of these.\n. And fyi, I'm all for taking the weaks out, I just wasn't sure if there's going to be some edge case where there's a strong retain that's keeping the client from being released.\n. Are you sure that the client isn't being released?\n. Is this going to cause problems for Xcode 7 users? If so, this should probably be merged into an Xcode 7.1 branch\n. As long as it doesn't affect the building of the other targets, I'm fine with putting it here.\n. @lightsprint09 How's this?\n. Can you provide some more information? When does this happen? Can you turn on logging and provide output.\n. I need more information about the problem and how to reproduce.\n. Well first off, I seem to be having trouble with node.js 4.0.0 and buffers\n. Yeah with node.js 4.0.0 and socket.io sending Buffers seems to be broken. \n. Okay, I fixed my 4.0.0 issue. We need to update the engine version in socket.io to the latest\n. Okay, from what I'm seeing so far, it's a problem when the client is switching from polling to websockets. Doesn't seem to happen when using polling or websockets only\n. Should be fixed in the latest version. Although the latest version will require Swift 2 and Xcode 7, which should be coming out in 2 days\n. You're probably missing some forward declaration.\n``` objective-c\nifndef SwiftIOObjc_Tester_h\ndefine SwiftIOObjc_Tester_h\n@class SocketIOClient;\n@interface Tester : NSObject\n@property (readwrite, nonatomic) SocketIOClient* socket;\n\n(id)init;\n(void)connect;\n(void)sendMessage:(NSString*)msg;\n\n@end\nendif\n```\n. @NachoSoto I believe he's copying the swift files directly. In which case you don't need define modules, just import the auto-generated Swift bridging header, and forward declare the type.\n. Try adding\nobjective-c\n@class SocketIOClient;\n. Okay, I guess you only need @class when you're doing it in a header file.\nThis works for me\n``` objective-c\n@import Foundation;\nimport \"SwiftIOObjc-Swift.h\"\n@interface Tester : NSObject \n@property (readwrite, nonatomic) SocketIOClient* socket;\n\n(id)init;\n(void)connect;\n(void)sendMessage:(NSString*)msg;\n\n@end\n@implementation Tester : NSObject\n\n\n(id)init\n{\n    if (self = [super init]) {\n        self.socket = [[SocketIOClient alloc] initWithSocketURL:@\"localhost:8080\" opts:@{@\"log\": @NO, @\"connectParams\": @{@\"thing\": @\"value\"}}];\n[[self socket] onAny:^(SocketAnyEvent* event) {\n    // NSLog(@\"Got event: %@, with items: %@\", event.event, event.items);\n}];\n\n[[self socket] onObjectiveC:@\"connect\" callback:^(NSArray* data, void (^ack)(NSArray*)) {\n    NSLog(@\"socket connected\");\n}];\n\n[[self socket] onObjectiveC:@\"currentAmount\" callback:^(NSArray* data, void (^ack)(NSArray*)) {\n    double cur = [[data objectAtIndex:0] floatValue];\n\n    [[self socket] emitWithAck:@\"canUpdate\" withItems:@[@(cur)]](0, ^(NSArray* data) {\n        [[self socket] emit:@\"update\" withItems:@[@{@\"amount\": @(cur + 2.50)}]];\n    });\n\n    ack(@[@\"Got your ack, \", @\"dude\"]);\n    NSLog(@\"Sent ack\");\n}];\n\n}\nreturn self;\n}\n\n\n(void)connect\n{\n    [[self socket] connectWithTimeoutAfter: 5 withTimeoutHandler: ^{\n        NSLog(@\"Client failed to connect\");\n    }];\n}\n\n\n(void)sendMessage:(NSString*)msg\n{\n    for (int i = 0; i < 1004000; i++) {\n        [[self socket] emit:@\"test\" withItems:@[msg]];\n    }\n}\n\n\n@end\n. Changed. Does this fix your problem?\n. @NachoSoto I'm just going to update the README\n. The ping interval is controlled by the server https://github.com/socketio/socket.io-client-swift/blob/master/SocketIOClientSwift/SocketEngine.swift#L405\n. What do you mean doesn't work anymore without an error? What's the error you're getting\n. If you turn on logging for the client what does it say\n. swift\nlet socket = SocketIOClient(socketURL: \"10.0.1.3:8001\", opts: [\"log\": true])\n```\n. What does your server look like? Are you using any middleware? Is it the node.js implementation of socket.io?\n. Also, are you pointing directly at the socket.io server? \n. So the simple server works, but when you try and use harmony stuff it doesn't work?\n. It works for me if I change the server to\njavascript\nserver.connection({\n  port: 8000,\n  labels: [\"api\"]\n});\nserver.connection({\n  port: 8001,\n  labels: [\"chat\"]\n});\nAnd point the client to localhost:8001\n. Yes it does\n. Although, I will say that your example used iOS, and I tested using OS X.\n. But in theory, it shouldn't matter. Since the client is written agnostic of OS\n. I think I'm going to tweak the closing stuff\n. Should be fixed in the latest master\n. Make sure you're on the latest version\n. What are your options for creating the client? Are you forcing websockets?\n. I'm having trouble reproducing on OS X\n. And what are params?\n. I can't seem to reproduce on OS X. Until I can get around to testing iOS you might try setting up your server to the default, which is polling and websockets. And forcing the client to use polling.\nAlso, are you using a default node http server?\n. Is this only happening with real devices?\n. Have you tried any other devices?\n. I suspect this one is going to be tough to pinpoint\n. I'm also having a hard time reproducing on my iPhone 6 plus iOS 8.4\n. I wasn't able to reproduce. So it's probably some weird edge case\n. It may also be helpful to turn on logging for the node server. \nDEBUG=* node index.js\n. That's weird... I don't really see anything in that change that should've broken anything\n. What does your connection to your test server look like? I'm able to connect to it fine the way I'm setting the client up.\n. It shouldn't matter, but what platform are you using the client on?\n. Because there's nothing in that range that should cause an invalid HTTP upgrade (there was nothing touched dealing with handshaking) and I can't reproduce it on OS X.\n. Also, I don't think config.setTransports(Transport.WEBSOCKET) only sets WebSockets. Because I seem to still be able to connect using forced polling.\n. There's nothing really in that log that looks out of the ordinary other than the transport close.\n. For reference, this is where the invalid HTTP upgrade message comes from https://github.com/socketio/socket.io-client-swift/blob/master/SocketIOClientSwift/WebSocket.swift#L332\n. And the last thing around then that might have something to do with it is https://github.com/socketio/socket.io-client-swift/commit/d6e1510cbf6f7524e6985ceb98bbb78784494dca\n. Okay the websocket version in master should basically be the same as it is in the source repo. Minus the combined file for security. So if it still happens in the latest master. It could be a problem with the library itself.\n. https://github.com/daltoniam/Starscream/issues/123\n. How about the latest master?\n. It's probably because of the last / in your first url\n. As it's written right now, each socket will create one connection. \n. Is there an explicit need for this feature?\n. I'll have to look into it. The swift client isn't written as a rewrite of the browser version. It was written from scratch to comply with the socket.io protocol. \n. I'll look into it.\n. Is CocoaPods currently broken?\n. So even if you change so finishTasksAndInvalidate, it still sometimes crashes in doRequest?\n. I don't think flushWaitForPost calls doRequest. It'll call itself though.\n. Have you tried adding a check for closed here? https://github.com/socketio/socket.io-client-swift/blob/master/SocketIOClientSwift/SocketEngine.swift#L349 I think that would stop the recursion\n. Also, do you have some example code that can reproduce the problem semi-regularly?\n. Does the latest master fix it? I'm going to refactor polling stuff shortly.\n. I'm actually having difficulty reproducing it for some reason with your example. \n. Okay, I was able to reproduce with forced polling\n. Can you check the latest master?\n. Ugh, I think I introduced that old test bug where sometimes the tests randomly fail.\n. Probably the same problem we had before. But I think we need multiple sockets to test namespaces and polling stuff.\n. @lightsprint09 do you have any suggestions with this? I'd like to try and separate the sockets based on what they're testing. But having 4 different sockets seems to be causing travis problems.\n. Going to go ahead and merge this and continuously work on adding more tests\n. Yeah, moving forward it'll be done more with mocking. Eventually I'm going to add some tests for the transport upgrading and connecting to namespaces. But the parsing stuff will mock tested. The client tests are pretty easy to mock out. But I think I'm going to need to refactor the engine to make easier to do testing on. \n. How are you creating the socket? This looks like if you aren't properly retaining the socket by using a property\n. Don't emit before you're sure the socket is connected. If you need to emit things as soon it's connected you can add a handler for connect. Currently the socket doesn't buffer emits. But it looks like the connection is being properly established. \n. {@\"nsp\" : @\"/myNameSpace\"}\n. Yeah, I would like to say this is a flaw in the protocol. Allowing a mixed type is a problem for languages that are statically typed.\n. Check if the latest master fixes your case. There's still the ugly problem if you try and include binary data in the error message\n. Another solution that would require a bit more work would be to cut out the server and instead test the output from the socket client to the engine and from the engine to the server, and vise versa. This would require some rewriting of some methods. Not sure if I want to go down that road just yet\n. This would only work if socket.io didn't allow you to have multiple values in the event handler\njavascript\nsocket.on('news', (data1, data2, data3) => {});\nIs fine in JavaScript\nHowever, since Swift is statically typed, there's no nice way of doing this besides using an array.\n. Yes, using an array allows you to mimic the variable arguments that JavaScript has. Also, I didn't know about that when I first created the library, so for a little while, it actually was the case that it was AnyObject instead of [AnyObject]\n. How are you creating the socket\n. I know that iOS 9 changed some things regarding SSL stuff. Are you using a weak key exchange? Also you could try implementing the NSURLSessionDelegate that implements one of the appropriate methods.\n. Not really, I haven't really experimented using SSL. But I suspect that if you implement the URLSession(_:didReceiveChallenge:completionHandler:) for NSURLSessionDelegate you'll be able to learn more\n. Any progress?\n. Probably related to https://developer.apple.com/library/prerelease/ios/technotes/App-Transport-Security-Technote/\n. Any progress on this?\n. Closing since it's probably related to ATP\n. What server are you using?\n. Well then what socket.io server where you running?\n. What version of socket.io are you using?\n. What's the message that's causing the crash? You can turn on logging\n. Okay, I see what you're saying. I would say it's an error to point to a server that isn't a socket.io server. But I can look into seeing what can be done\n. Sounds like another issue I've seen, make sure you're on the latest version of Xcode\n. Also does carthage support Swift 2?\n. Okay, I'm seeing the problem now. Weird\n. Only seems to happen on the iOS build of carthage\n. Should be fixed in 3.1.6\n. Yes this framework\n. https://github.com/socketio/socket.io-client-swift/releases/tag/v3.1.6\n. Do you have an Apple developer's license?\n. Weird, it didn't give me any errors when I built it. \n. No idea. These problems are why I advocate just copying Swift source files, or using gitmodules.\n. @NachoSoto Any ideas?\n. So they should all be set to developer?\n. It should be safe\n. Is this still a problem in the latest version?\n. In your example server code you're doing io.emit, shouldn't it be socket.emit?\n. Never heard of that issue before\n. Anymore feedback on this?\n. You may be able to use an adapted version of https://github.com/socketio/socket.io-client-swift/blob/master/SocketIOClientSwift/SocketEngine.swift\n. Yeah, I would say that if you can, start the socket already on the namespace (if you know it beforehand). Or have some special logic inside your connect handler. Since the way socket.io confirms joining a namespace is with a connect event\n. I don't know if this a good approach. I don't think that typos in options is really that big of a problem.\n. Heh, yeah. I've got another solution in mind though\n. Similar to what you had, but using an enum.\n``` swift\npublic typealias SocketOptionsDictionary = [SocketIOClientOptions: AnyObject]\npublic enum SocketIOClientOptions: String {\n    case ConnectParams = \"connectParams\"\n    case Reconnects = \"reconnect\"\n    case ReconnectAttempts = \"reconnectAttempts\"\n    case ReconnectWait = \"reconnectWait\"\n    case ForcePolling = \"forcePolling\"\n    case ForceWebsockets = \"forceWebsockets\"\n    case Nsp = \"nsp\"\n    case Cookies = \"cookies\"\n    case Log = \"log\"\n    case Logger = \"logger\"\n    case SessionDelegate = \"sessionDelegate\"\n    case Path = \"path\"\n    case ExtraHeaders = \"extraHeaders\"\n    case HandleQueue = \"handleQueue\"\n}\n```\nWould need a convenience init on the client for Objective-C\n. I was thinking something more along the lines of https://github.com/socketio/socket.io-client-swift/commit/40ac53844d908e65cfb870ca27cfa2356c3034e1\n. That way also has the benefit in that it won't be a compatibility breaking change.\n. #212 Is probably the better way to go about it.\n. @lightsprint09 What do you think?\n. Also I guess travis is dead\n. This good for merge?\n. It's going to be a major version change I think, since we changed the constructor interface\n. Yeah, I like your idea. The only concern I have is it's going to throw a lot of people off, since they're probably used to doing it the old way.\n. Hm, I'll toy around with this approach a bit in the other branch\n. Yeah, I ended up setting my default crash reporting to not do anything. It's really quite annoying. I have no idea why it's doing it.\n. It's obviously not something wrong with the library though. Since it's not crashing the compiler.\n. I have no idea how to fix this. This is some bug with Xcode, since the project compiles fine. \n. I ended up just doing defaults write com.apple.CrashReporter DialogType Server so it wouldn't pop up the dialog everytime. This used to happen a lot in the early versions of Swift. \n. How are you calling disconnect? From the main thread?\n. That's going to run into the problem where the app is going to get suspended before it can disconnect. I've never really thought a good platform neutral solution to it.\n. I really wouldn't know, I'm not an iOS dev. But perhaps some sort of background task \n. I don't doubt that you're running into this issue. I would chalk it up to iOS's limitations \n. That's expected behavior. When apps go into the background they get suspended. One solution is to change the server's timeout. Or just have it so you're not relying on when a socket disconnects\n. There's one change I could make, but I'm not sure it would really do anything.\n. https://github.com/socketio/socket.io-client-swift/commit/02971e14c2d59ef3ade6e6e6c1ef876a4485b964 is about the only thing I can think to do \n. Yeah, at this point it's better not trying to support iOS 7 anymore.\n. The problem is the server doesn't know the connection is closed until the ping timeout.\n. His app is getting suspended before it can send the message\n. Is this still a problem?\n. How did you import the project \n. Did you add the WebSocket.swift file \n. Is this server an actual socket.io server? Or is it just a raw websockets server? Because this library needs a socket.io server.\n. Make sure you're on the latest version\n. Also, it could be related to https://github.com/daltoniam/Starscream/issues/77\n. You could turn off optimizations for a quick fix.\n. I guess I can add an option that allows toggling this setting.\n. I did not write the WebSocket library, but I assume it's used for the very reason you need it. I just never assumed anyone would be using socket.io to create a VoIP application. Since it seems raw WebSockets or UDP streams would be more efficient\n. Also need to make sure it doesn't break cocoapods \n. Is the server expecting an actual array? If so you'll have to doubly wrap your first array\n. Oh, if that's the case. You need a singular dictionary. \n. First off, your socket url looks wrong. It looks like you should be using the Path option. You can use the SessionDelegate option to set a delegate. Also you should update to the latest version\nswift\nlet socket = SocketIOClient(socketURL: \"https://xx.xxx.255.xx/\", options: [.Path(\"xatsocket\"), .SocketDelegate(self))\n. objective-c\nSocketIOClient* socket = [[SocketIOClient alloc] initWithSocketURL:@\"https://xx.xxx.255.xx/\" options:@{@\"path\": @\"xatsocket\", @\"socketDelegate\": self}];\n. swift\nSocketIOClient* socket = [[SocketIOClient alloc] initWithSocketURL:@\"\" options:@{@\"path\": @\"xatsocket\", @\"socketDelegate\": self}]\nSeems to work for me\n``` objective-c\n@interface Tester : NSObject \n@property (readwrite, nonatomic) SocketIOClient* socket;\n\n(id)init;\n(void)connect;\n(void)sendMessage:(NSString*)msg;\n(void)URLSession:(NSURLSession )session didReceiveChallenge:(NSURLAuthenticationChallenge )challenge\n completionHandler:(void (^)(NSURLSessionAuthChallengeDisposition disposition, NSURLCredential * __nullable credential))completionHandler;\n\n@end\n```\n. Are you sure that your class is implementing NSURLSessionDelegate\n. I don't know Objective-C well, but don't you have declare protocol conformance with\nobjective-c\n@interface Tester : NSObject <NSURLSessionDelegate>\n. That seems to work for me. Is this a node.js server? \n.  Seems to work for me\n. Rooms are a server feature\n. Probably because of https://github.com/daltoniam/Starscream/issues/77 which only seems to be fixed by turning off optimizations.\n. #116 \n. That should be scoped internal, so it'll only be visible if you include the source files directly\n. I moved Logger into a static variable. And my prefered way of installing Swift libraries is via copying\n. You only get about 5 seconds of background execution before you app is suspended. There's multiple closed issues about this. It's just something inherent in iOS.\n. Where are you trying to emit from? When you say that it could happen even right after a successful connection does that mean putting emits into a connect event handler?\n. Also, have you tried turning on logging?\nObjective-C\nSocketIOClient* socket = [[SocketIOClient alloc] initWithSocketURL:@\"localhost:8080\" options:@{@\"log\": @YES}];\nswift\nlet socket = SocketIOClient(socketURL: \"localhost:8080\", options: [.Log(true)])\n. Hm, that's a good suggestion, right now error is only used on connection failures. But it might be good to emit it for other non-fatal errors\n. Does this happen if you force WebSocket?\n. The default socket.io connection starts with HTTP long-polling and then upgrades to WebSocket if it can. Forcing WebSockets causes it to skip the long-polling\n. My guess is you were causing some weird race condition, which is hard to reproduce. If you could provide a minimal example project where it happens that would be helpful\n. If you turn on logging does it say that it's emitting?\n. I would think that would be some kind of problem with NSURLSession or something along those lines. Have you tried testing this with forced WebSocket?\n. Is there a set number of connections that it opens before they subsequently start failing?\n. 20-60 is a pretty large range. Have you tried testing some sort of rate limiter? Also is there some sort of error message that happens?\n. What platform are you testing on?\n. When I test this outside of XCTest it seems to work.\n``` swift\nlet NUM_SOCKETS = 90\nvar connects = 0\nlet sockets = SocketIOClient)\nfor socket in sockets {\n    socket.on(\"connect\") {data, ack in\n        connects++\n    }\n    socket.connect()\n}\nlet waitTime = dispatch_time(DISPATCH_TIME_NOW, Int64(1 * NSEC_PER_SEC))\ndispatch_after(waitTime, dispatch_get_main_queue()) {\n    assert(connects == NUM_SOCKETS, \"Did not connect all sockets: (connects)\")\n}\n``\n. Anymore on this?\n. @lightsprint09 Anymore on this?\n. I think it has to do with https://github.com/daltoniam/Starscream/issues/153 in which there's nothing really we can do.\n. Probably related to how the NSDictionary is turned into a Set<SocketClientOptions>. That being said, it's most likely a bug in Swift. Since there's no capture lists being done that could leak. Also, using Instruments to do memory debuging for Swift is kinda sketchy.\n. It's hard for me to recommend using old versions. If you think it's important to avoid this leak I would recommend using a small Swift class that holds your socket\n. Hm, are you sure it's not Apple's new App Transport Security? It'll only connect to secure connections that meet a certain criteria. You can add handlers forerroranddisconnect` to see if it's failing\nAlso, your connect method looks like you've just picked up Swift. Here's a better one using a capture list and avoiding force unwrapping.\n``` swift\nfunc connect() {\n    socket.on(\"connect\") {[weak self] (data, ack) -> Void in\n        print(\"finish connect\")\n        self?.socket.emit()\n    }\nsocket.on(\"auth\") {[weak self] (data, ack) -> Void in\n    print(\"finish auth\")\n}\n\nsocket.connect()\n\n}\n``\n. Any updates?\n. This doesn't really tell me anything. I would at least need a line number for where it's crashing\n. Any updates? \n. Does the server have those namespaces open?\n. Not that I'm aware of\n. How are you joining from the browser?\n. Because when I test socket.io-client against a namespace the server doesn't have open it doesn't connect\n. Or rather it looks like it goes to the default namespace handler but doesn't emit aconnectevent\n. There'sconnectParams`\n. Any updates?\n. Closing because of lack of updates\n. That's weird, because when I kill a node server I get a disconnect event\n. That particular error message is an engine.io error message I believe. Do you know which server is sending it?\n. Okay, here's what I think could be happening.\n- You connect to the proxy and everything is going fine\n- You kill the server it's connected on.\n- For whatever reason the client doesn't think anything is wrong.\n- It sends another poll to the proxy which then sends it to some other server.\n- Other server doesn't know what to do with a random poll request.\nDoes that seem about right?\n. You can see if the latest master fixes anything\n. When you say it's not working with one server, does that mean one server behind that proxy? This is quite annoying to debug since I've never tried running socket.io from behind a proxy, I've always found it a pain.\n. I mean with the latest master. Because with the latest master it should attempt to reconnect if it gets an engine error message.\n. The specific error that's happening is because it's trying to connect with an sid that's not valid\n. Does your setup prohibit the use of WebSockets?\n. Hm, yeah this is going to be hard for me to debug, since I've never tried proxying socket.io\n. Are you forcing polling?\n. I have no idea what sails.js does differently than a default socket.io server. But you can send custom parameters with connectParams\n. Does this only happen with optimizations on? If so it's a known bug that can only be fixed by lowering optimizations\n. Dup #241 \n. Does this only happen with optimizations on? If so it's a known bug that can only be fixed by lowering optimizations\n. Do you know what message it's crashing on\n. https://github.com/daltoniam/Starscream/issues/77\n. Then I'll need to know what message it's crashing on\n. Can't reproduce on OS X\n. Hopefully a patch in the WebSocket library will fix it\n. Same as #240\n. Does it only happen if you compile the library with optimizations? If so see https://github.com/daltoniam/Starscream/issues/77\n. How did you install the library? It could be the library is already compiled with optimizations\n. I really have no idea if CocoaPods would compile the library with optimizations separately from your build settings. The only way to test would be to manually add the Swift files and compile them like that.\n. Does your server pass the new requirements for SSL? Also make sure your server is configured properly\n. How would the default client handle a message of unknown type? Because an engine message of 4{\"name:\\\"hello\\\"}\" would become an invalid client packet\n. This is probably unrelated to your on not being fired. \n. I think it's more accurate to re-add the functionality to re-use a sid. Since iirc right now it's basically always forcing new.\n. When you say gets stuck on the old sid, do you mean it actually tries reconnecting with the old one?\n. Are you on the latest version of the client? Because I thought reconnects should remove the engine and sid entirely. (This is being redone so it doesn't have to re-add the engine)\n. Actually reading the socket.io-client it says the sid should be updated on reconnects... some I'm not sure if it should ever re-use it.\n. Your welcome to try it, but pretty much anything that isn't a numbered release is experimental.\n. Note that it won't try a reconnect. It should just emit an error event\n. Any luck?\n. swift\nlet dict = [\"someKey\": true]\nsocket.emit(\"someEvent\", dict)\n. https://github.com/apple/swift-corelibs-foundation/blob/master/Docs/Status.md going to be important for this library.\n. What do you mean?\n. Well, I don't think anything in WebSocket is actually using Security. Since commenting it out doesn't seem to break anything.\n. I guess it's always imported with Foundation on Darwin.\n. So I have the linux branch to test this out... It's not looking good. I think it would require dropping ObjC support for the protocols or do the ugly thing done in that branch. Plus I'm seeing some URLSession crashes from unimplemented stuff.. Doing something like\n``` swift\nprivate class CustomLogger : SocketLogger {\n        var log = true\n/// Normal log messages\nfunc log(message: String, type: String, args: AnyObject...) {\n    print(message)\n}\n\n/// Error Messages\nfunc error(message: String, type: String, args: AnyObject...) {\n    print(message)\n}\n\n}\n```\nWorks for me\n. works for me \nobjective-c\nself.socket = [[SocketIOClient alloc] initWithSocketURL:@\"localhost:8080\" options:@{@\"connectParams\": @{@\"hello\": @\"test\"}}];\nhave you made sure you're only sending strings in connect params\n. I really have no desire to create a purely Objective-C version of this. Swift offers compatibility with Objective-C, and is much nicer to write in. \n. You can't, Swift doesn't support static libraries because the ABI isn't stable yet.\n. Should be reported https://github.com/daltoniam/Starscream\n. Should be reported https://github.com/daltoniam/Starscream\n. Should be reported https://github.com/daltoniam/Starscream\n. Should be reported https://github.com/daltoniam/Starscream\n. Should be reported https://github.com/daltoniam/Starscream\n. Should be reported https://github.com/daltoniam/Starscream\n. This should be merged into https://github.com/daltoniam/Starscream first, then I will update\n. You can check the status\n. What is the current sdk. Because it works fine with Xcode 7.2. You probably forgot to add stuff to your target\n. You have to check the status of the socket. https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIOClientStatus.swift#L28\n. Wouldn't the other targets also need to be changed\n. I just tested the Swift Package Manager for this project and I can say that it was much easier to use than Carthage or CocoaPods was. That being said, it'll be awhile before it's to the point where it could replace Carthage or CocoaPods.\n. Honestly all the framework builds should be renamed so that they become SocketIOClientSwift\n. The only reason is because that's the actual name of the project.\n. Will be fixed in #278 \n. What version of xcode are you using\n. I'm not sure why it would say that. How are you including the library?\n. If the api you're using sends acks for emits you can use emitWithAck. Which should be in the example on the readme\n. swift\nsocket.emitWithAck(\"canUpdate\", cur)(timeoutAfter: 0) {data in\n    // after the server acks\n}\n. javascript\n socket.on(\"ackack2\", function(data, int, ack) {\n        console.log(\"got ackack2\")\n        console.log(data)\n        ack(\"got ackack2\")\n})\nswift\nsocket.emitWithAck(\"ackack2\", 1, 5)(timeoutAfter: 0) {data in print(data[0])}\n. Your server code has too many arguments for that emit. It should only have two.\n. Does the socket even connect? I notice in your example it doesn't look like you're setting the port for the client.\n. I'm not sure what else to say, all my tests seem to be working\n. I don't see any reason why that would solve anything unless your server is configured to only use websockets\n. You can't connect to a namespace using the url. You have to use the Nsp(String) option.\nswift\nlet socket = SocketIOClient(socketURL: \"localhost:8080\", options: [.Nsp(\"/login\")])\n. Right now I think you'd have to readd the socket with the new options.\n. Well it wouldn't involve much, just changing the availability of connectParams to public. I just didn't anticipate someone needing to change them after the connection is established.\n. 4ed4681cc413d1aa9e052ad45a87b04a9d82bb0c\n. If someone creates a PR that adds support for it I will.\n. Make sure you're not pointing to localhost or another host that the device cannot reach.\n. If your server's TLS connection doesn't conform to Apple's new security requirements you might need that.\n. My only other thought is that you're not giving the right URL\n. Looks like some kind of network issue\n. Looks like you are emitting, so my guess is you're not interacting with your api correctly.\n. See if it's fixed in 5.0.0\n. Seems a little odd to only put the method call inside the websocket method. It should probably be in SocketEngine.handleOpen somewhere. Since by default socket.io should start by using long-polling and then upgrade to WebSocket\n. Also the method should not be optional, and yet do !.\n. I think for this PR the implementation that the client gives should be empty. Since there's actually another packet that says the socket.io connection is connected\n. @banjun If you're still around, is 3587c20 the right way to change the name of the framework CocoaPods spits out?\n. @banjun thanks\n. What do you mean \"a button to reconnect,\" like a button that calls reconnect?\n. @alexeyhippie you can see if the latest master is any better. If it is I can push a new version. If you're using cocapods you can do pod 'Socket.IO-Client-Swift', :git => 'https://github.com/socketio/socket.io-client-swift.git'\n@PeterL1n I haven't been able to reproduce your crashes. Do you have a crashlog or better yet a line number?\n. Try the latest master. I haven't released a version with the new code because I'm unsure if it's going to break things even more. It seems to work for me \n. Really? Because https://github.com/socketio/socket.io-client-swift/compare/v5.3.1...master shouldn't be on 5.3.1\n. Is there an easy way to reproduce this?\n. I went ahead and pushed a new version. \n. I would just stick with whatever the defaults are\n. Might be a bug in the ping counter. I'm starting to regret making the engine reusable. Seems to cause more problems than it's worth \n. Unfortunately not, this library is for socket.io only.\n. If #import <Socket_IO_Client_Swift/Socket_IO_Client_Swift-Swift.h> works then you're on pre-5.2.0\n. Have you tried 5.2.1, there was a bug fix in it.\n. Oh wait, I'm seeing these too\n. You can use .ForcePolling(true) as a temporary workaround.\n. I filed a bug report here, as I think it's a problem with the WebSocket library: https://github.com/daltoniam/Starscream/issues/158\n. I released a new version that reverts to an older websockets version until it's fixed.\n. > I didn't write a server side code\nIf you want to get acks from the server, you have to write it to do so.\n\nI also want to send message direct to other user\n\nThis isn't possible with socket.io\n. Well direct client to client isn't possible. And I don't think you can do direct broadcast from the client. Best you could do would be to have the server listen for an event and then have it be broadcasted by the server. Im not entirely sure about server stuff though \n. Swift doesn't support static libraries because its ABI isn't stable.\n. What's the crash log?\n. v5.2.3 should be as stable as 4.X since that bug in websocket got reverted. That being said, I have no idea if #286 is a bug in the client or if it's because of the way it's being used. And I can't seem to reproduce it.\n. v5.0.0 did fix a small memory leak caused by reflection though. But it wasn't a massive leak. It would only become a problem if you somehow created tons of clients. \n. Going to require some refactoring, since the engine does a lot of manipulations with the URL because of engine.io. So I'll just do a quick hack to drop trailing /s\n. I used a mixture of both \n. Bad request is probably an engine error. I don't understand why it'd only happen for new sockets and not the first, unless you're actually reopening a closed socket (which while it might work, isn't really tested that much)\n. You can't have a query in the url. Instead you have to use ConnectParams\nswift\nlet socket = SocketIOClient(socketURL: \"188.166.230.9:8170\", options: [.ConnectParams([\"token\": \"032361d52e7ce3bc11cc843e\"), .Log(true)])\n. Be sure that you're adding handlers for each socket. \n. Have you tried turning on logging\n. I haven't been able to reproduce. There shouldn't be anything tying the sockets together. Is it always the same server that's connecting or is it always the first socket.\n. Adding sid and transport to the params is unnecessary, the engine will add those separately. \n. It'll only convert it to base64 if it's using polling. Otherwise it'll send it raw through websockets\n. Here's some code that I have that tests sending images. All it does is send an image to the client which the client just sends back, but I use it to make sure sending NSData doesn't corrupt it.\n``` javascript\n// Wait for imageTest event to start the test\nsocket.on(\"imageTest\", ack => {\n    console.log(\"Got image test\")\n    fs.readFile(\"CaTBHah.png\", (err, data) => {\n        ack(data)\n    })\n})\nsocket.on(\"imageTestSend\", img => {\n    fs.writeFile(\"CaTBHah2.png\", img)\n})\n```\nswift\nsocket.emitWithAck(\"imageTest\")(timeoutAfter: 0) {data in\n    guard let img = data[0] as? NSData else { fatalError(\"Error getting image\") }\n    socket.emit(\"imageTestSend\", img)\n}\n. Yeah, it would look mostly the same. You just have to turn your image into NSData and emit it\n. If your server doesn't follow apple's guidelines for secure connections the connection will probably get rejected. And in the case of self-signed certs I think you'll need to set a sessionDelegate to handle the challenge\n. I'm not sure myself, you'll have to google\n. The same way you would using swift. But using objective-c syntax. There should be an example on the readme\n. Actually I forgot you have to enclose everything in an NSArray first.\n. But the objective-c example on the readme does cover sending a nsdictionary \n. No this isn't a regression. Paths are required to add a trailing /\n. I guess I can add a check and add one if it's missing \n. I have no idea, since it doesn't have anything to do with this library. Google push notifications on iOS\n. https://developer.apple.com/notifications/ I really have no idea, I've never used push notifications, but I would assume no, since that would require background execution\n. Like https://github.com/socketio/socket.io-client-swift/commit/2a25027077f3de92eb842482ee2595c11c6455ab ? \n. Should be fixed in the latest master\n. I don't know how you managed to cause that unless you're running on a potato. But you can try 5.3.3\n. Is the socket a property of a class. Most of the time people complain about events not being emitted the socket is being released because it isn't being stored as a property.\n. What version are you using?\n. Those crashes should be fixed in 5.3.3\n. Hm, 0f70079382b1e1b50e0f74400c954a1f9af53a77 might fix those two crashes, but I'm not sure\n. I'm not sure how long this will to take to add, since it's going to require some thought on how to do it nicely, since right now there's no way to access the headers. \nIf you're willing to make a few changes to the source you could probably insert a hack.\nhttps://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketEnginePollable.swift#L114 is where polling requests are handled. I'm not entirely sure the websocket side of things though.\n. What server are you using? Because it seems to work fine with the node.js one.\n. Okay then it's probably because the golang version doesn't double encode utf8 like the node version does, in which case you'll have to make a change to the client.\nhttps://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketFixUTF8.swift#L28 these functions should probably just immediatly return the string in your case\n. I'll try and add an option to toggle this \n. v5.4.0 has an option to toggle double encoding\n. You can use emitWithAck, but that requires the server to actually ack, otherwise everything with timeout\n. Did you figure this out?\n. Is the socket being retained properly? It should be a property of a class\n. If you turn logging on do you see a message about emitted when not connected?\n. It looks like it's sending fine. What does the server say\n. I meant logging via DEBUG=* node index.js\n. Oh I see, it's because the client is sending a post while it's upgrading. Quick fix is to force polling or websockets. I'll have to go through the upgrade code again \n. I haven't had time to debug it\n. You can try the development branch, I added some commits there that deal with polling and websocket\n. Does that branch fix it?\n. I'm not sure, I added some checks I think, but I haven't seen it.\n. What's the code you're using to connect with the js client?\n. And also the Swift client\n. It looks like the server is sending an Array, so your serverData[1] is wrong. It should be serverData[0] as? NSArray. Which looks like it contains an array of dictionaries\n. Are you sure the server sending an event named chat?\n. Just because one client sends a message to the server doesn't mean it gets sent to all clients. The server has to send another message.\n. Don't you have to include the event name? I'm not sure on the server api.\n. But I'm pretty sure this is a server problem\n. If the server is properly sending the messages adding a handler for chat should work.\nswift\nsocket.on(\"chat\") {data, ack in }\n. If you look at my example I have a method that adds the handlers. https://github.com/nuclearace/socket.io-client-swift-example/blob/master/TicTacIOiOS/ViewController.swift#L25\n. You can turn on logging for the socket to see if it's even getting the message.\n. swift\nlet socket = SocketIOClient(socketURL: NSURL(), options: [.Log(true)])\n. The message is sent, but the only message that the engine looks like it's getting is \"3 message to send is what are you doing ?\" which doesn't look like a valid socket.io packet. What server version are you using?\n. Does this same server code work for the JS client? Because I think something's not right with your server code.\n. No, I mean does this server work with a JavaScript client? Because I don't think your server is right.\n. This is the code I tested sending a message to all clients on a server.\njavascript\nio.sockets.on(\"connection\", (socket) => {\n    socket.on(\"message\", (msg) => {\n        io.emit(\"message\", msg)\n    })\n}\n. The important bit is io.emit(\"message\", msg) which sends a message to all connected clients\n. Which actually seems to the same thing as your socket.broadcast.emit. Which I got working fine, so either your event names don't match up, or your client is being released too early because it isn't a property.\n. I think socket.broadcast.emit sends the message to all sockets except socket\n. It is the Objective-C version, since Swift and Objective-C have interop\n. Anymore info on this?\n. Oops, thanks\n. 99% sure it's because your socket isn't a property and is thus being released by ARC.\n. @mayuroks If it's the same issue as this one, you should read up on ARC.. Are you sure that the socket is a property? 99% of the time people complain about events not being sent/received they don't understand or forget about ARC, and so the socket is being released as soon as it goes out of scope.\n. I'm not sure, your logs don't really show anything helpful.\n. What do you mean by performance test?\n. One thing I forgot to ask, did your app go into the background when it was disconnected? Because that would explain why.\nAs for connection stability, I can test that tomorrow. But throughout is harder to measure, since it's dependent on network stuff \n. I've had a connection last 25+ minutes, so I think it's pretty stable with regards to connection\n. No, I was testing on os x \n. Should probably report on https://github.com/daltoniam/Starscream\n. Have you made sure that your url is the correct url for the socket.io server?\n. Well, a request timing out is indicative of a connection problem. Either the wrong url or some other connection issue.\n. If your socket.io is on localhost then you'll have to use the IP of your computer, instead of localhost. Otherwise if your socket.io server isn't using https it's likely to fail because of iOS's restrictions on secure connections.\n. I'm not sure, this seems like a configuration problem. \n. Wrong url or port or something inbetween messing it up. \n. This would be done server-side. The client can only send messages directly to the server, not to other clients.\n. You can try just recreating the socket, and connect that one.\n. Yeah, you'll probably need to use SessionDelegate as well. I don't have any examples of that, but you should be able find some online.\n. Not sure how this is a library problem\n. Socket.io is currently on version 1.4.5 iirc. This library should work with socket.io 1.0+\n. I'm about to push a new version\n. Should be fixed\n. You need to Xcode 7.3 for the latest version\n. What? Can you explain a bit more\n. I haven't looked at it in awhile, but the solution I had for the app I used this on was to check when there was a change from wifi to cell and re-add the socket. Because iirc I couldn't figure out a platform neutral way to handle it \n. Without a reliable way to reproduce even a line number isn't very helpful. It's most likely some sort of race condition.\n. It's probably because .Cookies is typed as .Cookies([NSHTTPCookie]), but NSHTTPCookieStorage.cookies returns an optional. So you'll have to unwrap that optional\n. It's not something I intend to support, since you can get much of the same behavior by adding handlers for connect, reconnect, etc. Also I think it's a growing opinion in the Swift community that KVO isn't the best way to do things\n. You can add an event handler for connect that will be fired when the socket connects\n. This is most likely a problem with your code. All I can tell you is that by default, socket handlers will be executed on the main queue, while all parsing/emiting is done on background queues. If you want handlers to be executed from a different queue then you need to create the socket like\nswift\nSocketIOClient(socketURL: url, options: [.HandleQueue(someBackgroundQueue)])\n. Not a library issue\n. Create the socket with .Reconnects(false)\n. The only reason the event handler would be called more than once is because the server sent the message more than once. So check your server code, because it's probably not set up correctly\n. It could be, I've never tried storing sockets in a dictionary. But I wouldn't think it would cause a problem.\n. Did you ever resolve this?\n. Are you on Xcode 7.3?\n. I'm not accepting anything that's in Objective-C. Should be rewritten in Swift. Also, this would need to go added to the upstream WebSocket, and then I'd update the dependency.\n. https://github.com/daltoniam/Starscream/issues/169\n. Because it makes it more difficult to support other package managers and installing manually more difficult. And also because I want to support swift3 ahead of time. https://github.com/socketio/socket.io-client-swift/blob/swift3/Source/WebSocket.swift and it makes it easier to make changes releated to that.\n. Are you actually connecting to a socket.io server? \n. This is too vague. Can you give more information?\n. Are you sure the socket is a property and not a local variable?\n. Those log messages don't really help. Are you sure you're sending the data correctly? It could be you're not understanding the api correctly.\nAnd yes, the socket has to be a property, otherwise it'll be released when it goes out of scope \n. There's objective-c on the README. The only way to know the server got a message is if you do emitWithAck, and if the server knows it should send an ack back\n. Oh, you're using emitWithAck, which is probably not what you want.\nobjective-c\n[socket emitWithAck:@\"canUpdate\" withItems:@[@(cur)]](0, ^(NSArray* data) {\n    [socket emit:@\"update\" withItems:@[@{@\"amount\": @(cur + 2.50)}]];\n});\nemitWithAck returns a closure which takes a timeout and a callback. You have to call that callback before the emit will send. Also note that just because you're using emitWithAck, the server doesn't have to ack it, the server has to be coded to send back an ack.\n. swift\nlet mySocket = SocketIOClient(socketURL: NSURL(string: \"http://localhost:8080\")!, options: [.ConnectParams([\"token\": \"1\"])])\n. What do you mean? Shouldn't iOS handle certs\n. The only time I think you'd have to worry is if you're using a self-signed cert, or your cert doesn't meet Apple's requirements.\n. Oh I think I see, ws isn't public. \nI guess you can do:\nswift\n(client.engine as? SocketEngine)?.ws?.security = SSLSecurity(usePublicKeys: true)\nUntil I expose ws on SocketEngineSpec\n. Well you'll have to cast socket.engine to SocketEngine\n. I don't know Objective-C well enough to show you how\n. Why is this a pull request, it should be an Issue.\n. Are you sure that the server API is supposed to ack? emitWithAck will only get an ack if the server sends one.\n. Anything more on this?\n. @rauchg This is something for you I think.\n. I can't do anything about this. It's up to @rauchg to change that link.\n. No, because it's not yet supported in the WebSocket dependency. That being said, unless you're sending rather large messages every time, compression is probably overkill. I've heard it can create a bottleneck if you send a lot of small messages really quickly with compression turned on.\n. You can add handlers for connect, disconnect, reconnect and reconnectAttempt if you want to know different statuses. \n. Right, because iOS doesn't allow background execution but under certain cases.\n. @rodericj explicit disconnection is probably the safest way to do things.. When you say your local server is WebSocket, does that mean it's a plain WebSocket server? Because if that's so, you'll have to use the WebSocket class for it. SocketIOClient is only for socket.io servers.\n. Socket.io is a technology that's built on polling/WebSocket. It has its own protocol for sending messages, so a basic WebSocket server isn't going to follow that protocol. This library is meant for interfacing with socket.io servers, not plain WebSocket servers. You can use Starscream (what this library uses for WebSocket) if you want to connect to a plain WebSocket server.\n. Does it still happen in 6.1.0? My guess is doRequest isn't being called from the right dispatch_queue\n. @MishraVikas1 Do you have any more on this? Like what request is causing it?\n. That's weird because doRequest has a check against invalidation.\n. @px751 When does this happen? Theoretically doRequest should check against invalidation. So my guess is something is invalidating on another queue. Also the line numbers in that log are a little wonky I think.\n. Yeah, this one might be tough to debug \n. Well something is calling stopPolling() after this code path gets past the check. Are you adding a new socket after you call disconnect? \n. I do see some weirdness in the websocket disconnect logic that I'll have to look into to.\n. If you can reproduce locally and want to test a change, change https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketEngine.swift#L283 to\nswift\nif closed || !connected {\n    postSendClose(nil, nil, nil)\n    return\n}\nI'm always hesitant to change things dealing with the connection/disconnection since it's rather squishy.\n. You can also test the latest development branch\n. It would be https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketEngine.swift#L289\n. I still haven't been able to reproduce this. If anyone could find a way to produce it with like 90% reproducibility that'd be helpful.\n. @Arnadus Many thanks, I see it now\n. Should be fixed in development\n. I'm not sure how much more I can do. Do you have a reliable way to reproduce?\n. I haven't been able to reproduce, if someone can provide a sample project, that would help.. What version are you using?\n. Because that file doesn't exist anymore.\n. The status property \n. You compare it with https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIOClientStatus.swift#L28\n. socket.status == .Connected\n. I should add a FAQ somewhere. I'm almost certain it's because you're forgetting about ARC. The socket needs to be a property of a class, local variables won't work since they'll be released as soon as the socket goes out of scope.\n. Well the idea is that you should only call disconnect when you're done with the socket. And only reuse a closed socket when you know what you're doing.\n. Sending a JSON string like socket.emit(\"jsonStringTest\", \"{\\\"myEvent\\\":\\\"Cute Without the \\\\\\\"E\\\\\\\" (Cut From the Team)\\\"}\") works fine for me.\n. You ofc have to call JSON.parse in the server to convert it though.\n. @gamugamu I don't think this is a problem with this client, because it would happen on node.js servers as well. And emitting is a fairly straightforward task that has tests to verify the correct strings are being created https://github.com/socketio/socket.io-client-swift/blob/master/SocketIO-MacTests/SocketBasicPacketTest.swift. I've had problems reported with the flask-socket.io implementations before.\n. Is the problem that the socket that sends the message is receiving it as well? Because if that's the case you're using the wrong method on the server.\n. Did you figure this out? \n. What kind of connect params cause it to mess up? Because it looks to me that the query is being escaped\n. Nvm I see.\n. duplicate of #356 \n. This was originally done because re-using sockets after calling disconnect wasn't supported. I think it can be changed safely.\n. They're just strings, canUpdate and update would be events for this api, while dude is just string data.\n. What characters\n. You'd have to write your own engine client that conforms to https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketEngineClient.swift\n. And the engine conforms to https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketEngineSpec.swift\n. There's the .ConnectParams([String: AnyObject]) option \n. Like it says in the readme, SocketIOClientOptions have to be turned into a dictionary in Objective-C\nobjective-c\nNSDictionary* options = @{@\"connectParams\": @{@\"someThing\": @1}};\n. Have you set the background execution permissions?\n. Background execution is the one thing I'm never sure of, since I've not really tried and getting it working myself. And I really wouldn't ever think to use socket.io for VoIP.\n. When does this crash?\n. Oh I see\n. Actually I'm having trouble reproducing. Just calling didError with that string doesn't seem to crash mine.\n. What version are you on?\n. I noticed it too, it's because after calling disconnect it does another long poll, which it shouldn't. \n. @orozkoinsider is your server node.js based or something else. Because I've had people say that non-node.js servers don't allow WebSocket first. \n. Socket.io doesn't use cookies by default\n. Your error looks different than the one that happens when you disconnect. I've been able to reproduce the disconnect error, it's a logic error where the client is doing a poll after it sends a disconnect. It's not really a big problem, just a slight annoyance.\n. @ysfox @JunfeiW you can see if the latest development fixes the problem\n. If you only have one of a listener, or you want to remove all listeners for an event, you can use\nswift\nsocket.off(\"event\")\nbut if you want to be super specific you'll have to save the UUID that's returned from on\nswift\nlet uuid = socket.on(\"event\", someHandler)\nsocket.off(id: uuid)\n. Is this actually a socket.io server? Or are you trying to connect directly to a websocket server? Because that won't work, it has to be a socket.io server.\n. I think you want something like Starscream, which is just a WebSocket client.\n. try setting socket.reconnects to false\n. Did that solve your problem?\n. Have you tried checking whether it's actually connected or not?\n. swift\nif socket.status == .Connected { }\n. All pull request for WebSocket should be made at https://github.com/daltoniam/Starscream. Also you shouldn't change podspec to point to yours, I would create a new version and push it. \n. You can use the ConnectParams option to provide connection parameters \n. Probably, since the library is most likely looking for the jwt during the connection \n. Okay I lied, you want to use case ExtraHeaders([String: String]) since it's expecting it to be apart of the header.\n. how do you do it with js\n. For your ConnectParams try using [\"token\": token]\n. Did you solve this?\n. That looks to be a problem with Swift itself on iOS 7. In which case the only solution would be to avoid that code path by using the Swift initializers, which would mean using a Swift class. That being said, support for iOS 7 is probably something that is going to be dropped from this library in the near future.\n. Yes. \n. @shanshuiren are you using it from Objective-C? Because it looks like the problem is related to Swift on iOS 7.  In which case the only way to avoid it would be to avoid that code path by using the SocketIOClientOption initializer.\n. Are you implementing the appropriate SessionDelegate method that handles SSL challenges? \n. Is your URL the same for the non-ssl one? Just with https? Maybe your url is wrong.\n. Have you turned on logging to see if it it's being sent?\n. Have you checked the server with debugging on to see if it's getting it but malformed? I think a malformed packet should cause a disconnect but I'm not sure.\n. Flushing probe wait is because during the upgrade process from polling to websockets I found that trying to do anymore polling would cause a disconnect. So during that upgrade time it buffers until it finishes upgrading.\n. Hm maybe. flushProbeWait should be called after a switch to websockets. But maybe there's some case where it adds to probeWait after flushing.. That would be this path https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIO/Engine/SocketEngine.swift#L637. Which would mean that the socket failed to upgrade... This isn't a path I test regularly since it's difficult to trigger. It would be interesting to know the state of the engine at that moment.. It's entirely up to you where to call the connect. But sockets are independent of each other, so you'd have to call connect on each of them.\n. That's because iOS doesn't let you do background execution for this kind of thing unless you do some trickery involving VoIP which probably isn't what you're doing.\n. As long as the app is in the foreground and the socket isn't released, then it should remain connected.\n. Is your event handler being added? Also I see that your emit is the same as the event you're expecting from the server, is that correct?\n. Are you sure you're pointing to a socket.io server?\n. This library can send NSData directly. That being said it will turn it into base64 if the transport being used is http-polling. But as far as the server and client they will get binary. If you emit base64 then you'll be doing the decoding manually on the server. \n. I've never done profiling on it. I just send NSData since it's less code.\n. I've seen other people say airplane mode doesn't signal a disconnection. Not sure if that's a problem with this library or something else though since disconnections are signaled from the networking. But if you need to record connection stuff you'd have to modify the Engine since it's responsible for pongs. \n. https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketEngine.swift#L395\n. I'm not aware of a socket.io heartbeat event. I know that engine.io has a ping/pong mechanism.\n. Does it work if both sockets are in the same viewcontroller? You shouldn't be putting a socket on a viewcontroller anyway; there should be some object that holds the socket that always exists as long as it should.\n. The reason it doesn't work with two ViewControllers is because one of the controllers isn't loaded. ViewControllers are released when they aren't in the view hierarchy anymore. One way to have them persist would be to a have static SocketManager that holds them.\n. I'm actually toying with the idea of including a manager with the library, since a lot of people seem to be writing their own.\n. something like \n``` swift\npublic class SocketClientManager : NSObject {\n    public static let sharedManager = SocketClientManager()\npublic private(set) var sockets = [SocketIOClient]()\n\nprivate override init() {}\n\nfunc addSocket(socket: SocketIOClient) {\n    sockets.append(socket)\n}\n\n}\n```\nand then\n``` swift\nlet manager = SocketClientManager.sharedManager\nmanager.addSocket(SocketIOClient(socketURL: NSURL()))\nmanager.sockets[0]\n``\n. No you'd have to domanager.sockets[0].emit()`\n. I'm working on a manager right now that's a bit different.\n``` swift\npublic final class SocketClientManager : NSObject {\n    public static let sharedManager = SocketClientManager()\nprivate var sockets = [String: SocketIOClient]()\n\npublic subscript(string: String) -> SocketIOClient? {\n    get {\n        return sockets[string]\n    }\n\n    set(socket) {\n        sockets[string] = socket\n    }\n}\n\npublic func addSocket(socket: SocketIOClient, labeledAs label: String) {\n    sockets[label] = socket\n}\n\npublic func removeSocket(withLabel label: String) -> SocketIOClient? {\n    return sockets.removeValueForKey(label)\n}\n\npublic func removeSocket(socket socket: SocketIOClient) -> SocketIOClient? {\n    var returnSocket: SocketIOClient?\n\n    for (label, dictSocket) in sockets where dictSocket === socket {\n        returnSocket = sockets.removeValueForKey(label)\n    }\n\n    return returnSocket\n}\n\npublic func removeSockets() {\n    sockets.removeAll()\n}\n\n}\n```\nswift\nlet manager = SocketClientManager.sharedManager\nmanager[\"room1\"] = socket1\nmanager[\"room1\"]?.emit(\"hello\")\n. Really depends on the logic where you want to connect.\n. Is this a socket.io server or a plain WebSockets server? This library requires a socket.io server.\n. I'm not sure. I know there's some problem where you can't make it a static framework.\n. I'm able to connect to a url that points to an ipv6 address fine. \nI do see a crash when you use an ipv6 address directly though.\nEdit: Crash was because I was forgetting [] in the ipv6 url.\n. Well theoretically this library doesn't make any assumptions. It's based on NSURLSession and NSStream.\n. Are you also forcing Websockets?\n. That's why. Websockets doesn't use NSURLSession, it uses raw streams. You'd need to force polling.\n. No idea, since I don't know what SSL pinning is.\n. Looks like you might have to change something in here https://github.com/socketio/socket.io-client-swift/blob/master/Source/WebSocket.swift#L876\n. Actually you may be able to just add a custom SSLCert before you call the connect method.\nswift\nsocket.engine?.ws?.security = // However you create an SSLSecurity\nBut I don't how that works so you're on your own.\n. Erm, actually no. Because the engine isn't added until after.\n. Yeah, I'm adding an option to make it easy to set this.\n. https://github.com/socketio/socket.io-client-swift/commit/e163598ee6e6535cad73b7a8f0e2962ff2542f0e See if the latest development with that .Security option fixes it.\n. Although I just noticed that I need to make one change.\n. Unrelated: You should definitely learn swift. It's much more pleasant to write in than Objective-C imo. \n. It should be public in the dev branch\n. Strange, but honestly I have not used this library from Objective-C, so I'm not sure how to fix that.\n. You'll have to use https://github.com/socketio/socket.io-client-swift/tree/swift3\n. Working on it. I was just using the latest trunk releases\n. Okay you can try now.\n. How are you adding it to the other project? I don't officially support betas, so you're probably better off adding the source files directly to your project \n. It could be that that project is still using Swift 2 that's what's happening to one of mine. I had to do convert to latest syntax.\n. Yeah, that converter is far from perfect. I noticed it was doing some crazy stuff.\n. Your cert might not meet Apple's requirements \n. Can you open this against the 2.3 branch I just made?\n. Well since iOS 9 App Transport Security should have forced you to either Allow Arbitrary Loads or use SSL. I did notice that this was happening on macOS now though.\n. Would be a bug in the Websocket library.\n. Can you turn on logging? I've not seen this before.\n. @fvvliet It looks like @CoderEic is trying to connect to a plain websocket server, which is expected to fail since this library requires a socket.io server. So I suspect your problem may be different.\n. @fvvliet How are you creating the socket? Are you using the .Path option? \n. If you're trying to connect to a plain websocket server try https://github.com/daltoniam/Starscream. This library requires a socket.io server.\n. Does it still work?\n. Anything further on this?\n. Is this a plain websocket server? This is made to connect to socket.io servers. \n. That's why. This requires a socket.io server. If you want a plain websocket client look into https://github.com/daltoniam/Starscream.\n. Does it emit a disconnect immediatly?\n. Try 6.1.4, I found a bug in disconnections.\n. Going into the background with the socket connected is considered undefined behavior, since background execution is not permitted. I'll have to test turning off the wifi though.\n. Does it work in 6.1.2?\n. Try 6.1.4\n. Anything further on this?\n. I've seen that error, but it was a long time ago, so I don't remember how to fix it.\n. I'm not seeing this behavior in the latest version. \n. What?\n. Joining rooms is done serverside.\n. I've never seen this before. Are you sending the JSON as a Dictionary or a String?\n. Does it have to be sent as a string? The client can automatically turn Dictionaries and Arrays into JSON strings.\n. Why can't you force websockets and use secure?\n. Are you also using the .SelfSigned option? It's only used by the Websocket library.\n. Just to make sure it isn't a problem with polling, does it work if you're not using SSL and forcePolling?\n. And that was with the forcePolling option, right?\n. So it's a problem with polling\n. Hm, it seems to work with socket.io on node.js\n. Anything more on this?\n. The ping isn't something that you control on the client side. It's controlled on the server.\n. The server tells the client what the ping interval is during the handshaking.\n. No, that's different.\n. No, this is probably a case of different dispatch queues modifying something\n. That may fix it, it may not. It's some race condition based on improper access to the ack manager.\n. I've changed some things in the dev branch if you want to test those out.\n. There's already a Swift 3 branch\n. https://github.com/socketio/socket.io-client-swift/tree/swift3\n. Well, right now it's not really designed with adding a custom WebSocket. So in the time being you'll have to fork and change the code. But I'm going to look into making it so you can swap out engines/websockets/etc\n. This should be possible now in a limited way by subclassing WebSocket and overriding things and then overriding the connect method on the client.. This is because the websocket library does not yet support tunneling through proxies. There's an open pull request that adds support for it, but until then it will continue to fail.\nhttps://github.com/daltoniam/Starscream/pull/202\n. Hm, I haven't (and probably won't) had time to set up a test setup. But once that pull request is merged and I update the dependency I'll look into a little bit more.\n. It's still blocked by the WebSocket dependency.. Is it just a warning or does it cause the build to fail?\n. What is stomp?\n. If it's a server, no. This requires a socker.io server. You can check out Starscream if you want a straight websocket library. \nIf it's a Swift websocket library, there's no way currently to switch out the default websocket.\n. How is your server configured?\n. I suspect that your path might be wrong.\n. Is the server actually running socket.io? Because socket.io itself will be a server. Also your paths should always end with a /\n. How did you set this up? In the end something should be calling node index.js which will start the server. I don't know anything about Xcode Server, but it sounds fishy if you haven't written any JavaScript to set up the socket.io server.\n. I don't know enough to help. But it's probably because of the path.\n. I don't know what the path is, you'd have to check how the server is configured. By default you don't set a custom path.\n. This would be a Starscream problem I believe. \n. This is a crash in the websocket dependency. https://github.com/daltoniam/Starscream\n. I am not an expert on Starscream, so it would be best to redirect it there. I follow that repo so I'll see any discussion of the issue as well.\n. See https://github.com/socketio/socket.io-client-swift/issues/420\n. Doesn't the swift package manager require swift 3?\n. But it might have something to do with the websocket subdirectory. I'm having trouble getting the swiftpm to work for me.\n. Try 6.1.5\n. That looks like a swift version problem\n. You can just copy the source files to your project\n. Are you sure you're on the Swift 3 branch?\n. What version?\n. Can I close this then?\n. Xcode 8 is still beta, so I don't know if Carthage works with it yet \n. Is this fixed by that recent merge?\n. iOS doesn't let you do background execution for this kind of thing.\n. If you take out the APPLICATION_EXTENSION_API_ONLY from the build does it work?\n. Does https://github.com/socketio/socket.io-client-swift/tree/development branch work?\n. Mark them as @nonobjc, not private\n. Try the swift3 branch\n. I'm not sure, if you have Xcode setup right, and are on the swift3 branch, it should compile.\n. I've never tried to use CocoaPods with betas, could be something related to that.\n. Are you on the swift3 branch\n. Oh I haven't updated it for that beta yet\n. Downloading it now\n. This might take awhile, swiftc seems to want to segfault on something now\n. I don't think your project is setup right.\n. It should work for the most part, except for websocket SSL. \nhttps://github.com/socketio/socket.io-client-swift/blob/swift3/Source/WebSocket.swift#L310 Crashes swiftc, so you'll have to wait for betaX for them to fix that.\n. I also noticed that JSONSerialization is now turning Booleans into 0's and 1's, so some of the tests fail now. But until I read somewhere that this was intentional, and won't cause problems for sending json, I would be wary.\n. On that note, it might be related to https://github.com/apple/swift/pull/4366\n. The swift3 branch should compile on beta6.\n. Depends, is swift 3 going to be released as default on Xcode 8? What about Swift 2.3?\n. @minoue10 Then when Xcode is released publicly it'll be merged into master and a new version will come out.\n. I'll also have to check and see if CocoaPods supports Xcode 8 yet. I'd hate to merge it now and then find out that I have to do some annoying stuff to tell CocoaPods where to find the right toolchain to build it.\n. And another minor thing is that I'll have to turn off travis-ci until they update. But I would have to do that regardless, last time it took them about a week or two to update to Xcode.\nEdit: They already have the GM.\n. Looks like they need to update xctools for Xcode8. \n. Are you on the development branch? I'll be dropping a new version when Xcode 8 is released proper.\n. When I wrote that it wasn't out yet. I'm downloading it now.\n. Swift 3 code is in development now. There'll probably be a new release today\n. As I suspected would happen, CocoaPods sucks and is broken for Xcode 8.\n. Figured out how to kerjiggle CocoaPods into pushing the new version.\n. Yes\n. What Xcode are you on? \nAlso I had to use CocoaPods 1.1.0rc2. And it still messed up git remotes... I can't wait till the swift package manager is mature enough where I can drop CocoaPods.\n. If you want to use Swift 2.3 you'll have to use the swift2.3 branch. \n. In your path, add an /\n. Your cert might not be compliant to Apple's standards.\n. That'll happen if you call disconnect on a socket that hasn't been connected.\n. I'm not able to reproduce. It worked following your steps\n. WebSocket problem.\n. I don't develop the websocket library, so I'm not really sure. If you can come up with a way to reproduce it 95% of the time I might be able to look at it.\n. You'll probably have to configure your SSLSecurity correctly. Which I don't know how to do, since I've never done this.\n. There's a property called pubKeys where you put your keys.\n. WebSocket problem\n. Yeah, are you on the current version? I think this is a known issue with the WebSocket library, but I thought it was fixed.\n. I don't know if it increases speed of connect, socket.io starts sending stuff as soon as the polling is up, there's a slight pause during the upgrade. The reason it uses polling first is because some firewalls/proxies block websockets. So polling lets socket.io work behind those.\n. Are these from the WebSocket? If it's not, there's probably little I could do since I use NSURLSession for polling.\n. If you're doing .ForceWebsockets(true) then they are from the WebSocket. There's already a .ReconnectWait option for the socket. Also you can probably override the OS's TCP connect timeout max.\n. If you don't use .ForceWebsockets then it's probably starting with polling and then upgrading to websockets. \n. Is this socket a property? Because if it's not, it's getting released and the end of its scope.\n. If you turn on logging it'll tell you if the socket is being released.\n. You have to init the socket differently. \nobjective-c\nSocketIOClient* socket = [[SocketIOClient alloc] initWithSocketURL:url options:@{@\"log\": @YES}];\n. Are you supposed to be using a namespace? That's the only case I can think of when it won't emit connect.\n. This would be a question for https://github.com/daltoniam/Starscream. I don't maintain the WebSocket dependency.\n. What, I've never seen it take more than 7 or 8 seconds to compile.\n. Also, you'll want to branch off of development and make changes there.\n. Going to close this, since compile time should be a Swift issue itself.. disconnect is only called when the socket is not going to try and reconnect anymore. reconnect is the event for saying something happened and it's going to try and reconnect. reconnectAttempt is fired every attempt.\n. reconnect implies the socket has been disconnected, and is trying to reconnect. You can turn off automatic reconnects and then you'll get the disconnect immediately, but then it's up to you to reconnect/re-add the socket.\n. I don't think you want to set usePublicKeys to true. Have you tried setting that to false?\n. CFNetwork SSLHandshake failed Probably means that you're doing something wrong. You have to make sure that everything is done according to Apple's security specs, or it won't work. SSL stuff is done using Apple's frameworks.\n. There's a reason there's a connect event that gets fired. You never want to call connect() on a socket twice. You also never want to try and emit before a socket is connected. Pretty much all methods on the client are async. So once you call connect() it'll go on its way.  So you're probably hitting https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIOClient.swift#L222\nYou want to do\nswift\nsocket.on(\"connect\") {data, ack in\n    // Doing any sending that needs to be done\n}\n. You'll need to establish the connection before they could ever hit the button to send the message in that case. Your establishConnection method shouldn't be calling sendTextMessage(), because connect is async, so it'll more likely than not not be connected when it tries to send.\n. So does it not emit when you push the button? Have you added handlers for error or disconnect \n. Okay, yeah I've never tried connecting from an AppDelegate.\n. I'm about 99% sure that you're not making your socket a property.\n2016-08-20 04:51:07.232 socket[1174:119195] LOG SocketIOClient: Client is being released\n2016-08-20 04:51:07.497 socket[1174:119241] LOG SocketEngine: Engine is being released\n. Looks like the same WebSocket crash that happens occasionally. Does this happen when the socket goes into the background?\n. This crash log doesn't really help\n. I've already made a lot of those changes I believe.\n. Yeah I'm not sure this is enough information. I would need a way to reproduce reliably.\n. I have no idea, it could be because of the engine being released before it's connected. But this is all hard to debug.\n. Most likely fixed with the DispatchQueue refactoring.. Has it been built yet?\n. It's been awhile since I've used cocoapods. But I would double check that you aren't doing something weird.\n. When does this happen?\n. I'm not quite sure what you mean? I'm able to get my test server working fine.\n. Well that error is coming from NSURLSession. Is it when you app goes into the background? Because that would expected.\n. Thanks, that makes things look less suck\n. You could use acks if you have control over the server and could write it to use them. Otherwise I'm not sure of a good way. \n. When it's idle it's probably whatever NSURLSession and the WebSocket is while idle. I wouldn't expect to be much. \nAs for your app, how many events are going through it? If you're trying to send like 20 or so a second you might be sucking power. \n. Yes, you have to turn the image into binary and send that.\n. Or you could have a method that just adds your handlers for a socket. I don't like the idea of reusing sockets, I didn't originally build it to do that, it was tacked on later, I don't think it's that great.\nfunc addHandlersForSocket(socket: SocketIOClient)\n. Google how to turn a UIImage to NSData, or if it's already on the filesystem you can just get the data directly. Then you can just emit it.\n. oh I guess I forgot to update the pod's output framework.\n. What\n. Are you sure you're pointing at a socket.io server? That looks like you're hitting nginx.\n. The client should add the default socket.io path for you. /socket.io/ isn't a namepsace, it's the .Path.\n. What is a nettalk server? Does it use socket.io? This library only connects to socket.io servers.\n. What do you mean server? An http client? WebSocket client? If you just want to interface with HTTP just use NSURLSession. Starscream is good if you want a WebSocket client.\n. Looks like a websocket error.. I need some logs. The first one doesn't have anything from the library.\n. I didn't see any truncation. But the refactor looks better. Merged either way.\n. It compiles fine for me.\n. You need the Xcode GM now.\n. The swift3 branch has been merged into development\n. Sometime today\n. Should be up now.\n. Is this something the javascript client does?\n. Shouldn't the open packet be sent over WebSocket anyway?\n. Right, but is a connect event being emitted when forcing websocket? Because the websocket methods shouldn't be sending events to the client directly, they should come through the websocket and be sent the handle method.\n. https://github.com/socketio/socket.io-client-swift/blob/development/Source/SocketIOClient.swift#L188\nhttps://github.com/socketio/socket.io-client-swift/blob/development/Source/SocketParsable.swift#L39\n. Is your project a Swift 3 project, and are you using the current version?\n. I mean, it's been updated to Swift 3. How are you including the library?\n. Ah, that's why. You'll have to use the swift2.3 branch. v8.0.0 is Swift 3.0. 2.3 is only meant to be jumping point to Swift 3.\n. There is no swift3 branch now. Master is swift3 ready\n. That's what I used to push the update. It messed with my remotes though. \n. @HaraldBregu What Swift version is your project. v8.0.0 of the client is for Swift 3. Check the README for other versions of Swift.\n. @wy358688217 I've seen that happen when you try and use Swift frameworks in command-line applications. It has to do with Swift frameworks aren't static, they have to be bundled with the app.\n. Make sure you're including the Framework properly.\n. What version of Xcode and the client?\n. Well, you need xcode 8 for the 8.0.0 version.\n. What's the crash?\n. Can you post some logs?\n. I'm not sure you can use self there. You might have to move creating the socket to the init.\n. Looks like a simulator thing.\n. It supports Swift 3. Which is in Xcode 8. Is your project a Swift 3 project?\n. The library has been updated for Swift 3. I think most people's problems is that they're using package managers which are slow to update for Swift. Which is why I'd suggest git submoduling.\n. At least until the package managers catch up with Swift 3.\n. Looks like a crash in the websocket library\n. I'll see about updating the websocket version.\n. dyld: Library not loaded happens when you aren't properly embedding the library in your app. \n. Track in #508 \n. What cocoapods version?\n. Use the config constructor like in the readme\n. Stuff that works in simulator but fails on devices is usually a Swift issue. My Objective-C tests seem to init the socket.\n. Be sure to embed the framework. \n. Works for me in Swift\n``` swift\nsocket.on(\"aaaa\") {data, ack in\n    guard let obj = data[0] as? NSDictionary else { return }\n    guard let a = obj[\"a\"] as? Int else { return }\n    guard let b = obj[\"b\"] as? NSDictionary else { return }\n    guard let c = b[\"c\"] as? NSDictionary else { return }\n    guard let test = c[\"test\"] as? String else { return }\nprint(obj)\nprint(a)\nprint(b)\nprint(c)\nprint(test)\n\n}\n```\njavascript\nsocket.emit('aaaa', {\n    'a': 1,\n    'b': {\n        'c': {\n            'test': 'foo'\n        }\n    }\n});\n. If you look at your log, you'll see that the client is being released. Which means you're not properly setting it as a property.\n. That socket is a local variable it will be released as soon as it goes out of scope\n. what's the type of URL.host?\n. I've noticed a lot of times that error is actually a lie. And is actually pointing out that the URL is wrong.\nhttps://github.com/nuclearace/socket.io-client-swift-spm-example/blob/master/Sources/main.swift#L4\n. socketURL needs to be a URL, not a string.\n. What version of the client are you using?\n. If you take everything of the init like:\nswift\nlet url = URL(string: \"http://localhost:8080/\")!\nlet config = [.log(true), .forcePolling(true)] as SocketIOClientConfiguration\nlet socket = SocketIOClient(socketURL: url, config: config)\nDoes it give the same error?\n. Are you importing Foundation?\n. Ah, you'll have to do Foundation.URL if there's a collision.\n. What version of cocoapods are you using?\n. Can you open this up against https://github.com/daltoniam/Starscream so it can be reviewed there?\n. Probably fixed in the DispatchQueue refactor.. There's not really a way to stop an emit once it's called, the pipeline for sending is done asynchronously, and the emit packet could be anywhere from still in the parser to in a buffer waiting to send. As for handlers being called after disconnect, I don't think they currently check the socket's status. You could add your own check in your handler for the socket's status. As for removeAllHandlers, I don't think it currently removes ackHandlers, just event handlers. I did that because normally ack handlers are transient and shouldn't be lasting too long.\n. I don't care about opening that class, so if you want to make a PR that's fine.\n. Could you open this against development?\n. Are you supposed to be connecting to a namespace? Got message: 3 Just means that it got a pong\n. This would be better opened on https://github.com/daltoniam/Starscream\n. If you setup TLS properly, this framework will work.\n. Looks like it can't connect to the server?\n. What version of cocoapods?\n. @RozenAstrayChen Are you on Xcode 8? The swift2.3 branch compiles fine there.\n@petemillermultimedia You can have cocoapods point at a branch I believe.\n. Yeah, that's not going to work. http://guides.cocoapods.org/using/the-podfile.html#from-a-podspec-in-the-root-of-a-library-repo\n. Is your server actually a socket.io server? Or is it a WebSocket server? If it's the latter. You need https://github.com/daltoniam/Starscream, which is a plain old WebSocket client. (Also used in this library)\nIf it is a socket.io server, make sure that your socket is properly scoped as a property, or global variable. Otherwise it'll be released immediately after going out of scope.\n. If /parse is the socket.io path, it needs to be set via the .path(String) option\n. Also a log would help\n. The log from setting the log option\n. Oh, it looks like your socket isn't scoped properly. If you look at the log the client and engine are being released during the connection. This is probably the most common mistake I see. You have to make the socket a property or it will be released immediately after it goes out of scope\n. My guess is most people just copy and paste from the readme, forgetting about ARC. The readme examples only work copy and pasted if they're done in a main.swift or main function \n. Can thread sanitizer be on during a running app? The unit tests probably won't detect the more critical problems, since they aren't doing any tests with socket.io. At one point we had integration tests, but they don't work well with travis. Might look into having them just be manually run tests.\n. Hm, yeah, polling is pretty ugly. I'm probably missing a dispatch somewhere in the polling code. Around this code perhaps? https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketEnginePollable.swift#L139\n. The idea was that the engine and client could be separated, so each has their own handle, parse, and emit queues. And it's more to do with async than performance, I don't want to block the main queue while I do a bunch of parsing and such. Plus I use dispatch queues to try and limit access to resources. The trouble with polling is that I don't think I properly put back the response on a correct queue. Right now it looks like URLSession will call https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketEnginePollable.swift#L116 this callback on the main queue, which is wrong. Trouble is URLSession is OperationQueue based, not DispatchQueue based.\n. Re-use of the engine is something I don't really like, and was added later. I'd rather throw the engine away after a disconnect. Which is what .forceNew does. \n. I haven't had time to look into it. \n. Looks like your URL is wrong. Something like that usually happens when you point to the webserver instead of the actual socket.io port. \n. Do you have a .path(String) that you should be setting? The path should be what you set in the socket.io server, if you set one. A path being http://myurl.com:8080/something/ In this case you'd have to use. \nswift\nlet socket = SocketIOClient(socketURL: URL(string: \"http://myurl.com:8080/\")!, config: [.path(\"/something/\")])\n. And your port is the same port that socket.io is using? What version of socket.io are you on?\n. Ah, that's why. This library requires socket.io 1.0+.\n. I don't know, socket.io 0.9 is pretty old, I would update if possible.\n. What version are you on? The current version looks like https://github.com/socketio/socket.io-client-swift/blob/master/SocketIO-MacTests/SocketObjectiveCTest.m#L38\n. Ah, I need to update the readme.\n. Sounds like Xcode being dumb, which isn't unusual.\n. Be sure you're up-to-date and you're using the latest version of cocoapods\n. Or git submodule\n. Yes, you have to use the swift2.3 branch.\n. Last I checked watchOS couldn't be supported because of some things used in the websocket dependency not being available on it.\n. I believe NSStream.\n. Probably fixed in the DispatchQueue refactors.. How did you do it? It's not something I explicitly support.\n. Are you trying to send optionals inside of json? Because that will fail. JSONSerialization can't handle Optional. You have to make sure you only send values that can be in JSON, or NSNull.\n. That doesn't make sense though, unless maybe reconnect wait is like 0? That is the only way I could think those queues would clash from that method. \n. I currently don't have enough bandwidth to investigate this thoroughly. And this could take some effort to debut. If it's only a problem with polling you could try forcing websockets. But beyond that idk\n. My other workaround is what I did for the app I made this for. I turned off automatic reconnecting, and instead handled reconnecting myself.\n. Probably fixed in the DispatchQueue refactors.. You'd have to test it out.\n. What do you mean none are working in upload? You should be able to send the file by turning it into NSData and sending that.\n``` swift\nguard let a = try? Data(contentsOf: myURL) else { return }\nsocket.emit(\"event\", a)\n```\n. You need the Swift2.3 branch.\n. Also, you should move to swift 3 asap. Swift 2.3 is just meant to be a temporary version while you update to 3. And I'll likely be dropping support for it in the future.\n. Have you tried the latest version?\n. I might have goofed the readme. It's not one method. Check the swift version and you'll clearly see it's two methods.\n. Yeah looks like I messed up the objc example on the readme\n. I don't know objc that well. But emitWithAck returns an object that you call timingOutAfter on. \n. Not sure what to say. 8.1 is most definitely written in swift 3. And I was able to validate and push the update with whatever the current version of cocoapods is\n. Might be. Usually have to create a new branch for new versions. 8.1 might be using swift 3.0.1 which is why it'd want to update. \n. Oh I see. I think I PR had this fixed. I'll test development, and if it's fixed there I'll merge development and bump the version.\n. Looks like development fixes some issues, I'l merge it.\n. It was merged a few days ago.\n. One last thing, this should opened against development rather than master.\n. Is this in the WebSocket dependency? I don't think I explicitly use it in the library. Also what version of Swift is Xcode using?\n. What version are you using?\n. Are you using a sessionDelegate config option? Might be related to #552 \n. What?\n. I'm not sure that it'd be this library... I try not to do anything that is tied to a specific platform.\n. Should be fixed in 8.1.2\n. Does this still happen after the DispatchQueue refactors?. What version of socket.io is the server?\n. If you have the ability to turn on logging in the server, I'd recommend seeing what's going on.\n. Is the server actually expecting an ack? It won't respond to with an ack unless it's explicitly told to do so iirc.\n. Not sure, I'll have to look at it again, could be the ack numbers are getting confused.\n. Well, if it is a bug, not much you can. You could try throttling the emits, or if possible, make it so if something times out it retries. Not ideal, but not sure what else to do.\n. You need the swift 2.3 branch, not 7.0.3.\n. I can't control that unfortunately, but it's not really an issue.\n. Those logs look like the emit is working. What's the issue?\n. Where does it show binary data? And how are you sending \"bytearray  as NSData of UIImage\"? You'll want to turn that UIImage into a png, jpg or some other kind of image representation before you send it. You can google how to do that. But once you have NSData representing the image in a common format, you can send that. And then the server/other clients can do with that what they want.\n. How are you emitting?\n. Right but that's because you can do\njavascript\nsocket.emit(\"someEvent\", 1, {\"test\": 1}, true)\nAnd then do\njavascript\nsocket.on(\"someEvent\", (int, obj, bool) => { })\nIn JavaScript.\n. If you're getting something enclosed in an array that means something is broken with the encoder. Either they've changed the socket.io protocol on me or something else is going on.\n. Right, and in the socket.io protocol data is sent in the format 2[\"someEvent\", arg1, arg2, arg3]. Which is why I do https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIOClient.swift#L211.\nSo that when it gets to https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketPacket.swift#L89 it turns it into that proper format.\n. And there are tests for the parsing and encoding, so I would hope I would catch failures if it's a code change that broke something.\n. https://github.com/socketio/socket.io-client-swift/blob/master/SocketIO-MacTests/SocketBasicPacketTest.swift#L48\n. Yeah the reason there are two methods is to take advantage of Swift's variadic parameters so make the api more like the JavaScript client.\n. Might have to setup some exception for TLS for that domain. Apple's security requirements are pretty strict. Pretty much everything on iOS needs to be SSL.. You want an actual websocket client. This library isn't a websocket client. Checkout https://github.com/daltoniam/Starscream.\n. Are you adding handlers after connecting? Because that's bad, you should add them before connecting.\nWhat is the server getting?. Need more information than this.. Probably related to #716 . Upgrade Xcode then? And what library are you using? This library or some other library?. This library isn't a raw socket library. It's for socket.io.. This isn't a standalone Websocket client. Checkout https://github.com/daltoniam/Starscream. . Indeed, because socket.io double encodes strings for some reason. If you're not using the node.js based server you can turn that off.. It should still be received by the server correctly.. What exactly is happening?. It's getting back from the server that it could upgrade though?\n2016-12-03 17:38:18.349426 Votecast[967:508045] LOG SocketEngine: Got message: 0{\"sid\":\"ybjBdl48KC6JfVE6AABC\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\nBut moreover, that looks like you're creating a local socket instead of a property, which is wrong.  The socket should be a property so that it isn't released when it goes out of scope.. You'll need to find a reproducible case. If you can find one then you should open an issue on the websocket's repo. . Are you trying to connect to a socket.io server? . A socket.io server is a server using https://github.com/socketio/socket.io. Which is what this library is expecting to connect to.. Yes, it only is for socket.io.. That's a pretty straightforward error. You shouldn't be trying to send something before the connect event is fired. But are you actually connecting to a socket.io server?. That got message doesn't look like something socket.io would send. The first thing socket.io should be sending is a connect packet that has some connection information. . Are you sure that you're not looking for a straight Websocket client? Because if you're changing to so much that it isn't getting the proper packets to connect you're getting into fork land. . Does primus follow the socket.io protocol? Because that's the only way this client would work with it.. I don't know of one.. Are you running a socket.io server or are you running a WebSocket server? This library is only for socket.io servers.. I think you want a pure WebSocket client then. Checkout out https://github.com/daltoniam/Starscream. What is the error?. Doing someone like\nswift\nlet instance = SocketIOClient(socketURL: URL(string: \"\")!, config: [.connectParams([:])])\nworks.. It compiles for me. Are you on the latest version?. I'll fix that. It should be noted however that the WebSocket library I use is not written to be Objective-C compatible. So if you're using things from it, I would highly recommend using Swift. . Is this a node.js server? Is it getting to the server garbled or is it just the log that looks messed up? socket.io currently double encodes utf-8. Although that should be getting fixed soon.. You can try adding .forceWebsockets(true) to the config. That should avoid the double encoding problem. What version of socket.io are you on?. What version of the server?. socket.io 2.0 fixes some unicode issues.. Does this happen with large payloads? This is an issue with the websocket library itself.. https://github.com/daltoniam/Starscream/pull/289 Looks like a known issue.. This should be in handleOpen perhaps after https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketEngine.swift#L374. I see this particular crash being reported but I have no idea how to reproduce myself.. Probably fixed in the DispatchQueue refactors.. That looks like you're not interfacing with your server correctly. It might be expecting some data to be sent during the handshake . You're creating the client wrong, you're going to need https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIOClientOption.swift#L32. This library doesn't parse the socket url for parameters, so you have to add connect parameters separately. . Make sure you're using the correct host.. They share static logger.. You should be able to.. Maybe cocoapods is setting the wrong swift version?. What version of socket.io?. I mean what version of socket.io server. . This should be fixed in development. I'll move it to master when 8.3 is released.. Make sure you're on the latest version. Does this even work in the js-client? I've never seen this done before.. Doesn't seem like it would, since you're passing some JavaScript object, instead of a JSON object.. No, that isn't supported. That looks like an extension @nkzawa added on top of socket.io and socket.io-client, rather than a core aspect of socket.io. If it is a core feature I can look to implement it though.\nI have not looked at its implementation, but it probably does some wrapping around sending raw binary directly through socket.io, just exposing a stream interface.. If it is just an extension, you could probably reverse its protocol using this client. Or just build your own Swift version of it.. Well, streaming video isn't something I'd do with socket.io in any case, you'd probably want to drop to raw UDP sockets and use RTP if you want to stream audio/video. But if you want to send images, you could split the data up if you're worried about it being too big. You just have to split it in a way you can reconstruct it.. Yeah if you manually add them like that JSON will conflict, it wasn't meant to be a public declaration.. You'll have to rename it.. This will probably be fixed in the refactoring being done for #661 . Yep, it should already be in the development branch.. Needs to be opened on development. Connect should work. Have you turned on debugging on the server?. Do you have a way to reproduce?. Probably fixed in the DispatchQueue refactors.. Try reading the socket.io documentation on namespaces.. Right, because iOS doesn't allow background networking unless you have a certain permission enabled, and then you must start a background task.. Probably not putting the right socket.io url.. What?. Try adding the config .doubleEncodeUTF8(true). I thought socket.io fixed the double encode error.. I changed the default back always double encode utf8, so should be fixed.. What's the stacktrace for the crash?. Because this seems to work in Swift.. Weird. This doesn't seem to crash in Swift. Is this just with Objective-C? If so, not sure there's much I can do.. I'm not sure if the object should be a Swift object. I don't think it would matter, but maybe it does.. I would love to. But that'd require the WebSocket dependency to be updated, which isn't something I actually maintain. (It's just included here manually.). What is your emit?. Is the server expecting an ack message? The server has to be designed to ack, it won't do it for you iirc.. If not you have to use the regular emit.. Also what versions are you using?. What version of socket.io on the server are you using?. If possible you should turn on debugging on the server and see what's happening. Also the log you've given doesn't look like a full log, just looks like ping/pongs.. It should be socket.io 1.3.0+. Although 1.0+ might work.\nDo you get anything in a connect handler?. Also, when you call emitWithAck, are you then calling the timingOut(after:) method? Because it won't send until you call that. It should do some logging saying that it's trying to emit something.. @ErMaheshwari Might want to check server logs too. Since it looks like it should be sending.. You can emit JSON, or several other types.. https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketTypes.swift#L29. I think it's something on the server side.\njavascript\nDEBUG=* node index.js\nWill start the server in debug mode, where you can see what exactly socket.io is getting.. I've released 8.3.1, which should fix CocoaPods.. I can fix the first warning. But the other one will be fixed in an update to the WebSocket dependency. I just include the dependency here. But track changes done  from the upstream.. @FelipeKazuo Are you actually using socket.io on your microcontroller? If no, this library won't work with a raw WebSocket server.. Compiler warnings should be fixed in 8.3.2. Duplicate. Can you provide some example logs?. What version was this on?. What server version?. Try using doubleEncodeUTF8(true). Or just use the newest version, I reverted a change. I thought socket.io fixed the double encoding issue. Guess not.. This shouldn't be neeeded anymore with socket.io 2.0. . If the sent data is JSON, it should automatically be converted into a Dictionary.. That's up to you to determine when to stop sending and disconnect.. Can you open this against development. . Are you sure that your handleQueue is not doing something that blocks the queue?. What version of Xcode are you using? You need the latest version.. Need a reproducible case.. Might be fixed in the 9.0.. What version of Xcode are you using? https://cocoapods.org/pods/Socket.IO-Client-Swift Shows 8.3.3. You need Xcode 8.3 to use the latest version.. swift\nsocket.emit(\"myEvent\", [1, 3, 5, 5]). You should probably read https://socket.io/docs/. It gives you an idea of how to use socket.io. Instead of manually adding your connect parameters to your URL you should use the connectParams option.. Is the second use of the singleton called after the first already establishes a connection?. Just going off of Google translate, but if you want to listen to an event, you just need to do.\nswift\nsocket.on(\"myEvent\") {data in\n  // My event code\n}. Look at the readme. Need some more information. What handlers are you adding? It looks like it should be connecting.. Are you sure you're using the server API correctly?. Try StackOverflow or the slack for socket.io. Not really a library issue.. What xcode version are you using?. Have you figured this out?. Are you on a spotty connection?. Does it work after restarting the app after changing the times?. If you can put the server into debug and see what requests it's doing that'd be helpful. The logs posted don't say much.. I'm not sure how changing the device time could break this library unless there's a bug in URLSession or the WebSocket dependency.. I'm not sure, I don't explicitly set the cookies. Unless they're given https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketEngine.swift#L196. Use acks if the server supports them in the API.. @faizan-carameltech I could add this on my own if you don't think you'd be able to update the PR.. https://github.com/socketio/socket.io-client-swift/commit/c03fc96f04972856c430be9d5f8fc16b376c6875. Make sure you're on the latest version.. Make sure you're on 8.3.3. Is this new behavior in socket.io? I don't remember it doing this before. Namespaces are usually independent of path. Also shouldn't this be looking for a .path options supplied in config? That is currently the way you specify custom paths.\nWhat version of socket.io server did you test this in?. Also this should be opened against development, not master.. Yeah this was a design choice. I didn't write this client to be like the Java one. The main issue I have with this is that there is another option called .path which is different from a namespace, and is actually apart of the url for the socket.io protocol. And I feel like taking the path from the socketURL to be the namespace would bring confusion, which is why I opted to move both options to configurations.\nYou could also configure the client like:\nswift\nlet socket = SocketIOClient(socketURL: myURL, config: [.nsp(\"/mynamespace\")])\nRather than setting the nsp directly.. Totally agree with you.. @OneSman7 23c7641. KVO is best avoided in Swift. Most idiomatic for this library would be a new system event that sent is on changes.. But what is wrong with listening for connect, disconnect, reconnect and reconnectAttempt?These usually mean a status change.. swift\nsocket.on(\"connect\") { ... }\nsocket.on(\"disconnect\") { ... }\nsocket.on(\"reconnect\") { ... }\nsocket.on(\"reconnectAttempt\") { ... }. Not directly. But the periods between calling connect() and receiving connect indicate connecting. Likewise, the period between receiving reconnect and a connect are connecting.. Simplest would be to add a handleEvent(\"statusChange\"...) call at the end of this. But like I said, there's currently no connecting status.. Right, I'm saying the way I would want this kind of feature added is through a new status and client event.. Which, unless someone raises a PR, will come after the clean up of the DispatchQueues.. Also, I must've been smoking something. There is a connecting status, it is only set after calling connect, and this status change isn't announced.. @patmalt 1eb39d6\n. Yeah I was thinking the same thing. It's weirder with the changes in https://github.com/socketio/socket.io-client-swift/commit/dd2167a09f8b2e1dc125ad9f6a07bbe7c578c588.\nThe only issue is that would be major version bump.. That error is mostly likely coming from the URLSession itself timing out. https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketEngine.swift#L271\nWhich gets communicated up when it times out. I'm not sure how to best solve this issue. . Probably because Apple is very strict about TLS. . Would probably need something like #662. ping and pong events have been added in v13.. Sorry it took so long to get around to this. A note about this: it'll only affect the initial connection or when forcing http long-polling. Once a WebSocket connection is established the headers aren't sent again.. Not sure if it's your actual code, but adding handlers after calling connect is not good. You should add them before calling connect. Likewise, not sure if it's just the example code, but calling emit right after connect is most likely not going to emit anything, since connect becomes async, which is why you see the error Tried emitting serie when not connected.\nAll emits should happen in connect or in code that will only be called when the socket is connected.. You should add all handlers before calling connect. Besides that, make sure your event names are correct.. Check the API you're using and the event names you've added. You can also turn on logging and search for \"handling event\" to see the events the client is trying to handle. Or you can add an onAny handler.\nswift\nsocket.onAny {event in\n    print(event.event)\n}. All I see in that log is pings and pongs. So it looks like you're connected successfully. I would make sure that you're using your API correctly.. @Nik20112 Make sure that you're interfacing with your API correctly, i.e, if the server sends \"hello_world\", you've added a handler for \"hello_world\", and not \"Hello_world\".\nYou can search your whole log for the event names you're expecting to get. They should at least make it to the engine's parser. If they aren't, that indicates that you're connecting the wrong server or are not correctly authenticated with it. Authentication is something that is up to the programmer, it's not handled by the lib.. Look through the logs and see what events are being sent, or print out what comes in the onAny handler. If those two don't work, you'll have to check your API.. I haven't tested, but I think status is an int in Objective-C, and you could probably compare it to however SocketIOClientStatus gets bridged. I encourage people to use Swift if possible, since that's what I intended this library to used from, and as such the Objective-C API is going to be suboptimal.. I've never tried, but it will probably involve fiddling with a custom URLSession delegate and the SSLSecurity stuff on the WebSocket. All of which I am not very familiar with.. Should be able to translate the Swift way. config in objective-c is just a dictionary.\nswift\nlet socket = SocketIOClient(socketURL: url, config: [.path(\"/my/custom/path\")])\nPath option. How does the android url look? Maybe you want a namespace and not a path?. Yeah I think in the android client that's a namespace. (This is why I purposefully didn't use this feature, since it confuses namespacing and paths)\nTry using the .nsp(String) option.. objective-c\n@{@\"nsp\":@\"/pda\"}. (Going off of google translate) Are you sure you have the correct socket url?. Can you give some logs from the client? Preferably from when it connects?\nswift\nlet socket = SocketIOClient(socketURL: url, config: [.log(true)])\nTo turn on logging.. Not sure what happened to the log, but I see it in the email. Everything looks like it is connecting successfully. I see some events being received and trying to be handled. One thing I noticed is some handlers are being added after the connect. That might be why some events aren't being called.. From your logs I'm not seeing any messages coming in from the server, just acks for things that you've sent. Have you verified that the events are coming through? You can search the logs for your event name, they should at least make it to the engine's parser.. What version was this?. Currently you can't configure the User-Agent, it is set to whatever URLSession uses.. I haven't done extensive testing, but it should still work.. ~~One thing is you'll need to pass .doubleEncodeUTF8(false), since they fixed that in 2.0.~~\nJk, looks like this still isn't the case.. So further investigation reveals that indeed, the unicode change is fixed. But there's no way to make it backwards compatible. So I'll have to make a new major version for 2.0. @Codeido The newest version (10.0) should be compatible with 2.0. The main breaking change is with unicode encoding, so if you don't care if unicode becomes spaghetti, you can still use an older version.. .disconnect is fired when the client gives up reconnecting. .reconnect is what is fired when the socket will attempt to reconnect (such as the connection dropping).. https://nuclearace.github.io/Socket.IO-Client-Swift/Enums/SocketClientEvent.html. Looks like it's the websocket dependency. Are you on the latest version of the client? . Closing since bugs in the WebSocket library aren't fixed here.. The answer currently is yes. I'm going to add some helper methods that do the dispatching for methods so it's not a giant pyramid of indent, but any access to properties need to be on the handleQueue.. The more I dig into this, the weirder it becomes. Some of the methods run into strange behavior if the client tries dispatching, like off, and some it just can't, like the ones that return values.\nSo I'm starting to lean towards having the user explicitly dispatching, rather than introducing a bunch of trampoline methods and inconsistency.. If you turn on logging, do you see the event come in? You search the output for your event. If it's being sent, it should at least make it to engine. . It looks like you're interacting with your API, so check and see if you're interacting correctly. . Make sure that you're interacting with your API correctly, i.e sending the correct events after receiving some event. . What?. Not sure how this library could cause that. What?. What do you mean multiple connections? It shouldn't connect more than once per connect call. Have you added more than one connect handler? . You would have to do it at the client level using Data; the Swift client doesn't have WebSocket compression support.. Compression was added v10.1.0. Are you able to reproduce this yourself? Would be helpful to know what message it is choking on. Also what are the client and server versions?. What string is it crashing on. Also what is the client and server versions . Client 1.0? 1.0 is ancient; the latest socket.io 1.0 compatible client version is 9.0.  If the server using 2.0 you need 10.0.. Is the server using 2.0? They changed how unicode is done in 2.0 which is not compatible with older versions.. What server and client version?. Yes, you need 10. There shouldn't be any major code changes.. If you want to change the path of the server you need to use the path config.. Are you handling the self signed cert in your session delegate?. What client and server are you using? If you are using socket.io 2.0 you must use v10 of the client. If you're on socket.io you must use v9.. When you say latest, do you mean v10? If your server is socket.io 1.0 you have to use v9.0.1 of the client. v10 is not backwards compatible with socket.io 1.0.. What?. Right, the idea is you can add multiple handlers for the same event. If you only want one handler per event, make sure you only add it once. Or remove the one you add using one of the off methods.. There's already a Swift 4 branch for socket.io 2.0. But when Swift 4 is released proper I'll create a Swift 4 compatible version for socket.io 1.0+ and 2.0+.. @pekebyte looks like something the faq can help with. https://nuclearace.github.io/Socket.IO-Client-Swift/faq.html. Background execution isn't something this library is meant for, because Apple is very strict about what you can do in the background. https://github.com/socketio/socket.io-client-swift/issues/627. Dup of #683.. Hm, this looks like a bridging error, since it's an error in the bridging header. . For some reason this guy https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketEngineSpec.swift#L47 isn't being bridged correctly. Does this still happen in the latest version?. Yeah, I haven't looked into this issue yet. Not sure what it could be since the Objective-C tests themselves pass, and it looks like an issue with the bridging that's happening.. Are you defining a swift version somewhere?. @chirag225 I'm not able to reproduce. I just tested with 11.1.2 and CocoaPods and I was able to use SocketIO in Objective-C fine. I'm not sure why your thing is bridging like that. I used Xcode 8.3.3.\n\n```ruby\nproject 'SocketIOSwiftiOS.xcodeproj'\nUncomment the next line to define a global platform for your project\nplatform :ios, '9.0'\ntarget 'SocketIOSwiftiOS' do\n  # Comment the next line if you're not using Swift and don't want to use dynamic frameworks\n  use_frameworks!\npod 'Socket.IO-Client-Swift', '~> 11.1.2' # Or latest version\ntarget 'SocketIOSwiftiOSUITests' do\n    inherit! :search_paths\n    # Pods for testing\n  end\nend\n```. @chirag225 That might fix your issue. But it doesn't explain why you needed to do that yourself. It should be the Swift compiler's job to make a bridging header. Maybe there's some other settings that have been changed?. @jose920405 Does this project only have socket.io has a dependency? If not, have you tried just having socket.io in the project? \nI guess another thing to note is that my initial project was created as a Swift project, which then added Objective-C files.. Let me try from an objc project.. @jose920405 @chirag225 \n1. New blank Objective-C based iOS project with Xcode 8.3.3\n2. Create Podfile\n```ruby\nproject 'SocketIOObjc.xcodeproj'\nUncomment the next line to define a global platform for your project\nplatform :ios, '9.0'\ntarget 'SocketIOObjc' do\n  # Comment the next line if you're not using Swift and don't want to use dynamic frameworks\n  use_frameworks!\npod 'Socket.IO-Client-Swift', '~> 11.1.2' # Or latest version\nend\n``\n3.pod repo update && pod install4. Use the new .xcworkspace created\n5. Add@import SocketIO;`\n6. Compile\nI get no errors doing this.. Oh this project started in Xcode 7? Maybe it has something to do with that. Is something defining a SWIFT_VERSION in the build settings?. The latest version is built using swift 3.1. Not sure if that'll fix anything though.. What are your target versions? I haven't tested anything lower than iOS 10 in awhile.. That's an objective-c based project and I don't have control over the bridging header. . Anything more on this?. Oh, yeah. If the server returns that from an engine request it will probably think that's a message since it starts with 404:.. What?. Most of the remaining documentation is in the WebSocket dependency, which I manually include here since it was easier in the early days of Swift to just include dependencies. I don't change it but for upstream changes.. Oh. I'm not sure. The documentation is written for Swift, so it doesn't always match up with the Objective-C interface.. Is your server a plain WebSockets server? This library is not a plain WebSockets library; it's for socket.io.. It's always had this issue, and it never was a \"normal dependency.\" This project is pretty old, so old it predates most package manager support for Swift, so the best solution was to manually include source files for dependencies in your projects (people are still doing this.) However, it means it was harder to keep the local copy up-to-date. Every time I would try and update the local copy, I would lose the changes needed to support Objective-C. \nThe main reason for moving the files out of the repo was to keep track of the manual changes made to Starscream and to make it easier to keep it up-to-date with the upstream. The changes made are very minor; just some things so that Objective-C doesn't complain.. Well, I could do that if I wanted to drop Objective-C support (which has crossed my mind a few times.) The only other reason to have a fork is to test new Swift version that break syntax (which in early Swift was every minor release.)\nYou could use the custom fork if you want. It's generally up-to-date.. It's probably related to the DispatchQueue refactoring. Are you accessing the socket on the same queue given as the handleQueue? If no, then thats probably why.. Anymore on this?. Are you getting a connect event?. What?. The .error client event communicates errors, however the API is inconsistent and I'm planning on standardizing it.. You should validate that your urls are correct before giving them to the client.. This library isn't a WebSocket client. Check out https://github.com/daltoniam/Starscream (It's what this library uses for WebSocket.). I wouldn't trust Instruments for leak detections in Swift. I notice a lot of times it gives false positives (especially with String).. Crashing for what reason?. Yeah that image doesn't help much diagnose why it might be crashing.. I don't quite understand what you're trying to do. But, that feels like a pretty bad UI that you have to add dynamic event handlers like that. Better would be to use acks for sent events.. Can you not call one of the off methods before the on then?. Nope, that's the best way to make sure a specific handler only exists once.. Background execution isn't explicitly supported. Does it reconnect when the app comes back into the foreground?. By default the socket uses the main queue. You can pass a different handle queue using the handleQueue option.. Also, setting the handleQueue to a concurrent queue will most likely cause a crash, it must be a serial queue.. I'll add the connected namespace to the connect event's data.\nswift\nsocket.on(clientEvent: .connect) {data, ack in\n  guard nsp = data[0] as? String else { return }\n  // Use nsp\n}. You might be able to manually set the connect params on the engine. https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketEngineSpec.swift#L40. Yeah I need to remove the manual install from the readme. You'll have to some extra work to get manual install to work now, since it uses some system libraries that have to be linked in.. You have to add the zlib header as a private header for your project and change the Swift framework path to point to the zlib folder.. There's a cookie's option.. https://github.com/socketio/socket.io-client-swift/blob/swift4.0/Source/SocketEngine.swift#L224. Use the Swift 4 branch . Do you have some logs? Was this on Wifi? If it was on 3G/LTE that might be common, since those connections are going to be unreliable.. Maybe something is wrong with your auth logic? These logs don't say much. I would need the output of the client's logging from around the time it disconnected.. Yeah, if you try and send messages when the socket isn't connected it won't send them. You have to make sure you only send when the socket is connected.. Do you have some logs? Was this on Wifi? If it was on 3G/LTE that might be common, since those connections are going to be unreliable.. What version of the client?. The cocoapods website says 11.0.0 is there. Did you update the pod repo to make sure it's current?. It should most definitely be Swift 3 compatible. There's another branch for Swift 4 though. . Oh, I must've accidentally removed that from the pod spec. @srinivasgadda I've updated to podspec and pushed a new version, so hopefully it resolves that issues without having to manually intervene.. @Spadille what version and what is the error?. What server version are you using? If it's socket.io 2.0+ make sure you're using client version 10+.  Else you'll want 9. If you take off forceWebsockets does it work? Are you able to check server logs?. I'll have to look at the namespace logic again. I remember it used to be that it should join the default namespace first, and then move to the other namespace.. This is what the socket.io-protocol states https://github.com/socketio/socket.io-protocol#multiplexing about namespaces.\n\nWhen the socket.io transport connection is established, a connection attempt to the / namespace is assumed (ie: the server behaves as if the client had sent a CONNECT packet to the / namespace).\nIn order to support multiplexing of multiple sockets under the same transport, additional CONNECT packets can be sent by the client to arbitrary namespace URIs (eg: /another).\n\nThat's what this logic should be handling:\nhttps://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIO/Parse/SocketParsable.swift#L42. I will look into this more later today.. Namespaces seem to work for me. What versions of the server are y'all using?. Also can you give an example server that doesn't work with this client?. You can't write what version the server is running and create a basic example? I suspect it has to do with the way you're making the server where it doesn't create a default namespace.. And what version is the server? . Ah, I think I see what's going on.. If someone wants to try the development branch, I've made some changes. If those work I'll make a new release.. cd2454373a081b54947e3f94b916cdeb8a6c9c33. Just use the development branch.. v12.1.1 has been released.. @juanitozambada I don't support old versions. . See https://github.com/socketio/socket.io-client-swift/issues/736. No idea.. I don't even know where those messages are coming from. So I have no idea.. What?. I'm not sure how to save logs to the phone. Try searching online.. Have you run pod repo update?. How did you install the lib?\n\nERROR: handshake failed ... Server returned status code 403 \n\nIdk, sounds like you're using your API wrong.. What version of the lib?. And how did you install the lib?. Have you done a repo update and pod update? I tested CocoaPods myself and it worked fine.. What other dependencies are you using? I wonder if they're conflicting.. Hm, yeah. I wonder if there's a way to figure out which one is causing the conflict... I'm also not sure the best way to solve this issue.. I'm guessing I'll have to change the names of these modules in my fork of Starscream.. https://github.com/daltoniam/Starscream/issues/361. This might have been fixed in 11.1.0.. @thully @tbaranes Can you see if just adding the development branch of socket.io to your Cartfile and building fixes it? I'm trying something out.. From my testing it seems to be fixed. But knowing how package managers play with each other, I'll probably break everything else.. @nboyd-sportdx were you using Carthage or cocoapods? If carthage did you use the development branch?. @LeonidKokhnovich Try github \"socketio/socket.io-client-swift\" \"development\". If that works I can make a new release.. I'll make a new release tonight then.. @Nathan187 What do you mean?. Should be fixed in 11.1.2. Is the socket.io library itself being bridged? How did you install the library? Via CocoaPods?. Okay. Manually installing is no longer officially supported since you have to fiddle with adding system libs. You can try version 10.0.1, which still had manual install, otherwise you'll have to use CocoaPods or the Swift Package Manager.. 3.1. Is this solved?. Oh, Carthage probably broke with the last thing. I'll have to figure out how to fix that.. If you add github \"nuclearace/Starscream\" ~> 8.0.1 to the Cartfile does it help anything.. Usually you get both an IPv4 and IPv6 address, so everything should still work.. Like I said, most ISPs that support IPv6 will provide both a IPv6 and IPv4 address. And if they don't there's things like 6in4. Not sure, I don't run the lib through this tool.. I appreciate the PR, but I actually prefer () over Void. If you look at most Apple code, they use (). And actually Void is just defined as typealias Void = (). Oh, oops. This was one of the reasons I moved Starscream to a fork and out of this project. I think I can fix this.. Should hopefully be fixed in 11.0.1.. Create the socket in an init.. There's no specific documentation for the life cycle of the WebSocket specifically, since it gets recreated for each connection.\nThe client behaves roughly like this:\nNotConnected->Connecting->Connected->\\->\\<Engine reports disconnect>\nFrom there a few things can happen.\nIf disconnect was called or the client isn't set to automatically reconnect: Status is disconnected and a disconnect event is emitted.\notherwise: reconnect is emitted and client attempts to reconnect, emitting reconnectAttempt events.. Yes, 11.0.1 should have re-exposed SSLSecurity to Objective-C.. What?. The event names must match up. So if they send an event \"send message\" you have to have a handler for \"send message\".. What is your server doing? Is it rebroadcasting the message from one client to all the others?. What does your client code look like?. It's generally bad form to add handlers in a method like this. Generally it's better to know what your handlers are upfront, and them once. But where is the socket object declared? If it's a local variable and not a property or global variable it's possible it's being released too early. It'll also help you if you can turn on logging for the client. . I mean you would only have one handler for that message, and you add it once. Otherwise you run the risk of getting an event when you don't have a handler for it, in which case it'll be lost.\nSimplified example:\n```swift\nimport SocketIO\nlet socket = SocketIOClient(socketURL: myUrl, config: [.log(true)])\nfunc addHandlers() {\n  self.socket.on(\"chatMessage\") {data, ack in }\n}\n// somewhere addHandlers is called, and then connect is called\n```\nBeyond this help, I'm not sure what else to tell you.. That sounds like you're adding the event handler multiple times... You need to add it one time.  And if you're doing something complicated like dynamic events, you're going to have to make sure that you add the event handler before sending the event, and making sure that you remove the event after it is fired, or use the .once handler.. Manually adding is no longer supported since Starscream was moved to be a dependency. You'd have to copy the Starscream files and add some additional things to get the system modules working.. Have you added use_frameworks! to your Podfile? That's what the error says and what's in the readme https://github.com/socketio/socket.io-client-swift#cocoapods-100-or-later.. I'm sure it's possible, but I don't have the time to figure out the steps. Basically what you have to do is copy the client files, copy the starscream files, remove the imports for the starscream lib. And then figure out how to import the libraries it needs. The last part is what willl take the most effort . Right, you'll have to take a look at https://github.com/nuclearace/Starscream/tree/socket.io to see how it includes those libraries. . Thanks, should be fixed.. Reusing a socket has never been quite kosher for this library. Your best bet is to create a new socket after one disconnects.. No idea. I don't support Xcode betas officially until it releases. There's usually branches for new Swift versions (like the Swift 4 branch.) But including them in a project isn't supported.. Most likely related to https://github.com/socketio/socket.io-client-swift/issues/754, which is waiting on upstream changes.. Duplicate.. Also see if 11.1.0 with Starscream 8.0.3 fixes things.. Actually, I wonder if this is related to the submodule this library is using. I'll reopen and take a closer look at Carthage.. Will fix in #754.. Need more information on what is happening. This doesn't sound a bug per se, but something wrong with your API.. There's not really a way to solve this on the client side unless you send something in the payload that could be used to tell it was sent from that device. Otherwise you'll have to change the server so that it doesn't emit to the sending device.. The .once method will add a single use handle, after it's called once it won't be called again. Use .on if you want a handler than can be used multiple times. . What do you mean \"handler on SocketIOManager not invoked\"?\nThe line LOG SocketIOClient: Handling event: get message with data: means the client is about to call any event handlers that match that event name. If no handlers match that event name, it won't call any. \nIt's completely up to you to make sure you're using your API correctly.\nHowever some best practices IMO:\n- Don't use dynamic events that require keeping track of different event handlers. It's complicated and error prone. Instead use an API with a predefined set of events and use the payloads to do any dynamic dispatching.\n- If you absolutely must do some sort of dynamic events. Use .once so that you don't have to worry about removing handlers yourself.\nIn addition, it's crucial that you understand Swift's ARC. A lot of times when people say their events aren't being called, what's actually happening is their client is being released because they declared it as a local variable.. I can't really be of anymore help since I don't what your API is like. But it sounds like the problem is most likely in the server logic if you think your client is being configured for the correct events. My knowledge of socket.io server is limited, so I won't be able to help much there. . From my experience, automatic reconnect only really functions well when the app is in the foreground. The library has never really been able to handle going from the foreground to the background without adding a bunch of OS dependent code. My solution was to just disconnect the socket when it goes into the background and manually connect when it reenters. . I am not sure I can be of much help in this case. The library itself doesn't handle low level networking, such as determining when a device has switched from wifi to cell (and I don't think it ever should.) So it relies on URLSession when polling and Streams when on WebSockets. If those don't communicate that the connection has broken. Or don't function correctly, there's nothing the library can do.\nThat being said, can you elaborate on \n\nDespite attempting to reconnect repeatedly it won't reconnect.\n\nWhat do the logs say it is doing?. >I'm setting the SocketIOClient object to nil so it should be completely released and ready to re-establish a connection, right?\nIf you're setting the SocketIOClient object to nil you have to create a new one and connect it. At that point it's not \"reconnecting\" it's a new client. But if you're doing all that, it should connect.. I'm not sure what would be the cause then. You'd have to start debugging the client. The logs I'm referring to are the ones when you have the .log(true) config set.. That I'm not sure of. You could provide a custom SocketLogger with the logger option, but you'd have to define it in Swift.. @bhartsb Unfortunately, I'm not going to have time to dig deep into this right now. I'll be off-on next week. So you're best bet would be fiddle with it yourself.. That's an interesting proposition. Not sure I can comment on it much right now though. As for the issue. I can offer some hints.\nSince it looks like you're forcing WebSockets, it might actually be an issue with Starscream and how it handles this case. Is it possible to not force websockets?. The overhead is not that much and yes it will upgrade to WebSockets once it establishes a working polling connection. . @bhartsb Sorry the wait, I went on vacation. Yes, reconnectWait is currently in seconds.\nSo it is getting something back? The 330[[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]] is a bit strange.\n. @bhartsb so is this issue resolved? If so I'll close the issue.\nI appreciate the offer, but I'm pretty busy with work, and with this library and another I have, I don't think I would have enough time to spend to be of any help. I appreciate the offer though.. What? The title doesn't explain the issue enough.. I don't see any errors there; it looks like a normal connection. Make sure you're using your API correctly (on the correct namespace, sent the correct events etc).. Beta versions aren't supported officially, so there's no guarantee it will work or build. The swift4 branch is just around for testing. . But I'll look into it when I get a chance. . I wonder why it's checking out 8.0.2, it should be checking out 8.0.3. I found the issue, it should be fixed in 11.1.1.. Duplicate of #772. I think it's related to the sub module this library has for testing. Is there a way to tell Carthage not to init submodules on the client side? I think the long term solution is to add a Cartfile to this project. But I won't be able to do that today I don't think . This is no longer supported since it will require some fiddling and changing code around. . Duplicate of #715 . This is probably related to #754. For which there is only a workaround. I haven't thought of a good solution to this issue.. @AOrumbaev correct. Beta version are not supported in any official capacity. There is a swift4 branch but there is no guarantee that it works or even builds.. Closing as a duplicate of #772.. Make sure that your token is set when calling establish connection, if not, don't try and connect.. Yes, I think this would be great. Granted it doesn't break travis and is still easy to debug/develop.\nOne note though, I'm using a custom Starscream repo because there were like two changes that had to be made for some ObjC compatibility. Would it be possible to keep my fork?. Also for Carthage frameworks. Do you have to include the Checkout in this repo? Or is the .resolved and Cartfile enough?. Also, should be opened against development. @lightsprint09 I don't actually have access to the settings on this repo, otherwise I would've changed that setting.\nhttps://github.com/nuclearace/Starscream/tree/socket.io is where I keep the changes for this project.\n. @lightsprint09 https://github.com/socketio/socket.io-client-swift/issues/761 was one of the reasons I moved Starscream into its own repo. I kept breaking this everytime I synced the local copy of Starscream.. Also https://github.com/socketio/socket.io-client-swift/issues/598. I tried to get those changes put into the upstream but the response was Starscream is meant for Swift, so those changes were best left out. \ud83e\udd37\u200d\u2640\ufe0f . Also @lightsprint09 it might make more sense to just do it on the Swift 4.0 branch. Since Swift 4 is right around the corner.. Are you using Carthage? Because this sounds like #754 . Should be fixed in 11.1.2. Duplicate of #754. If you add github \"socketio/socket.io-client-swift\" \"development\" Does it fix it? If yes I'll make a new release today.. What is the nature of the race? I don't quite see how making it a static property would help. Need to identify where queue access violations are happening. (I see one now). _connect is a instance method though, so there shouldn't be any shared state between the engines. What is your reconnectWait?. Using a shared serial queue would mean that multiple sockets in one app would be sharing a queue. I'm not sure if that would be better. It would limit the number of threads when you have a ton of sockets going at once. But then it would mean that work in one socket would block work in another.\nWould have to test these trade-offs.. It should also be noted that the client is only queue safe within itself. Accesses to the socket must be done on its handleQueue. Or there's a possibility that races will happen.. Are you using the workspace that cocoapods makes?. What version are you using? All the self collisions should be avoided. However, if you're trying to use Starscream AND this library in the same project you're going to have an issue. You'll have to use the fork that this library uses.. Try pod repo update. This needs to be opened against development. . Are you trying to use the Xcode beta with Swift 4? If so, you have to use the Swift 4 branch.. How did you install the lib?. I don't understand chinese. So not sure what this issue is saying.. I can't see anything wrong here. Try turning on logging and see if you notice anything . Yes it should be .log(true).. Maybe something in your self.socket.emit(\"client_connect\", [\"client_id\": 33]) emit? If something in that does authentication such that an emit of get_workers won't do anything, maybe there's something wrong there.\nAnother thing is if your url is using a namespace, i.e http://someurl.com/mynamesapce In the JS and Android client, would be done with the .nsp(String) option in this client.. Ah yes, I see in your above comment you're doing something like that. \nswift\nvar socket = SocketIOClient(socketURL: URL(string: \"http://206.225.95.239:8383/client\")!)\nshould actually be\nswift\nvar socket = SocketIOClient(socketURL: URL(string: \"http://206.225.95.239:8383\")!, config: [.nsp(\"/client\")])\nSorry I missed that before.. I should probably put something in the FAQ about that.. https://github.com/socketio/socket.io-client-swift/releases/tag/swift2.3. If you add a event handler for the .disconnect or .reconnect client events you should get some indication. . Exposing the handlers is something I want to do. The issue is they're defined in a way that wouldn't be exposed to objc. I might be able to think of a workaround though. . @santhoshsk1918 See 91eea96. It opens up a bunch of previously internal things. Including the handlers. The only downside is most of the stuff will be Swift only.. If it's just inserting you can use the .cookies or .extraHeaders options. \nBut currently there's no way to intercept response headers. There's this issue for that, but the demand hasn't been high enough for me to look into it. What error?. What do you mean second connection? Have you turned on logging on the client?. Why does the node server crash?. Headers should be added for all polling messages if you use the extraHeaders or cookies options.\nhttps://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIO/Engine/SocketEnginePollable.swift#L74\nhttps://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIO/Engine/SocketEnginePollable.swift#L101\nAnd on the initial connection and for the initial WebSockets connection\nhttps://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIO/Engine/SocketEngine.swift#L275\nhttps://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIO/Engine/SocketEngine.swift#L330 . I believe https://github.com/socketio/socket.io-client-swift/releases/tag/v10.0.1 is going to be the last version that supports iOS 7.. I don't quite understand the issue. What do you mean leakage of data? I've never seen anything like that. What transport was being used here?. @JoyGY one thing I see is that you're adding handlers while the socket is running. This is generally a bad idea, since there's always the possibility that the handler would be added after the event is received. You should add all handlers before calling connect.. https://github.com/socketio/socket.io-client-swift/issues/766 reference this. Are you seeing the event you're looking for in the log output? You should see your event in the logs followed by a message that looks like \"Got binary data: ...\". That's if you're actually sending Buffers from the server. What version of socket.io are you using on the server?. Also, the log posted above does show getting an event named \"data\" however it doesn't include the rest of the lifecycle of that event. Does it make it through the parses? You should see a log line that says the client is attempting to handle data.. @JoyGY I mean what server version? 2.0.x?. @JoyGY Are you saying that the log cuts out trying to print the message for that event? I think I remember seeing that somewhere.... If that's not it, I'm not really understanding the issue. Are you saying that your data event doesn't have all the data that you expect, but that you are getting a data event?. Hm, I'm not sure what more I can do. My only suggestion would be to start debugging the client and see where things are failing.\nThis is where the Engine gets the string data and parses it: https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIO/Engine/SocketEngine.swift#L503\nThis is where the client turns the engine string into something that can be handled by the client: https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIO/Parse/SocketParsable.swift#L71 . @JoyGY No worries about the english. You say it can only be displayed in the log? If that's the case here's some things you can look for:\nLook for messages that say \"Parsing: 2[\"data\"......]\". That's where the client is creating the packets to call event handlers with. At the end of those messages it should print the created packet or some ERROR log line.. There shouldn't be any limitation that I know of regarding how large a payload could be, except maybe Int.max items. Which would probably cause problems for the server before the client.. Again, your log output cuts out before it shows any messages about parsing the \"data\" event. It looks like it is emitting events for \"auth\", but without the rest of the log I can't see what it's doing.. @JoyGY In that code example, is this socket inside of a function or method? Or is it a global variable? Either way, you should put the .on(\"data\"....) before the emits.\nRegarding your questions:\n1. There shouldn't be anything that's limiting the size of the data, unless there's something I don't know about.\n2. If you see in the log that the \"data\" event is being received, but your handler isn't being called, that could mean something is happening in the parse phase.\n3. Maybe.\n4. I don't know of any other socket.io clients that are for socket.io 2.0 and native iOS.. Yeah I'm not sure, you'll have to debug the client to see what's happening. But just to clarify, your socket is a global variable or attached to a class instance? It's not just declared in a function? Because if it's not in a global variable or class instance it'll be reclaimed by ARC.. @JoyGY No problem, glad you got it sorted out.. I have never tested with large data sets? What sizes are we talking about?. @JoyGY is this the same issue as #806? If so can we track everything there?. Currently this is correct. All encryption stuff is provided by Apple. I'm about to start work on using two different WebSocket clients which will allow using this lib on Linux. But that shouldn't affect you as long as this is being used on Apple platforms.. Are you trying to use this in Swift 4?. How are y'all install the lib?. I just tried CocoaPods and everything worked for me.. Swift 4 will be supported in v12. . Swift 4 will be supported in v12.0.0.. Should be out now.. v12.0.0 is for Swift 4.0. What Xcode version was this with? I got no errors testing this on Xcode 9 and Swift 4.. I think those warnings are because of documentation stuff. The documentation is written for the Swift client's api, so it won't always match up with the Objective-C translation.. Yeah, I'm not getting any errors building and running the tests on Xcode 9. Is something overriding a SWIFT_VERSION setting?. @olgadanylova I'm not aware of any other libs; I haven't looked in ages. This lib should work in ObjC on all Apple platforms except Watch.\nI still think something is setting a SWIFT_VERSION to something lower than 4.0. that \"Value of optional type 'String?' not unwrapped; did you mean to use '!' or '?'?\" was for an old version of Swift where the string init returned an optional; it shouldn't in Swift 4.0.. \n. Be sure to do pod repo update before doing pod update. It no longer does this automatically.. It depends on what you expect in the event. There might not be anything in the event, in which case count would be 0.. Are you trying to use this in Swift 3.x? The latest version is for Swift 4.. As @aligermiyanoglu says, this is a sign that something is setting the SWIFT_VERSION to 3.x. The latest version needs it set to 4.0.. Can you try rebasing on development?. @lightsprint09 Any progress on this? I think this will really help ease things.. @lightsprint09 So I've been playing around with this in a test branch. I keep getting this. I remember seeing this before when I tried using Carthage but I can never remember how to fix it.. I figured it out. Needed a copy files phase.. @lightsprint09 I've fixed the tests and merged these changes in. Feel free to open another PR with anymore changes this might need. I'll have to fix the Podfile to point to the normal upstream Starscream again, but that's not a big deal.. See https://github.com/daltoniam/Starscream/pull/202. I think it's been abandoned, but if this is ever merged then it'll start working.. Connect directly to the server? I'm not entirely sure.. Well, you have to import the framework, that's why you're getting an unresolved identifier error. . You should do import SocketIO in any file you need to access stuff defined in this library.. I've never seen that kind of error before. Are you trying to include this library's source files in your targets or something? Are you using the workspace that CocoaPods creates for you?. I think this is telling you that you've added this file to the SocketIO target, which is meaningless.. What version is the server? Versions past 9.0 contain a breaking unicode change that only support socket.io 2.0+.. Shouldn't be relevant for the latest version, since it doesn't use my custom Starscream anymore.. Yeah, this was the breaking change introduced in 12.1.0. You're going to need to do SocketIO.SSLSecurity.. Please make sure that you have Swift 4.0 installed. You can check by doing swift --version. Oh, make sure you add // swift-tools-version:4.0 to the top of your package file. . Did that fix the issue?. My test project builds fine and the travis build is fine, so I'm not sure.. So I guess I need to update the readme a bit better, it only shows adding the dependency, not what a fully correct Package.swift would look like.\nThis is a full SPM package file that uses the lib.\nhttps://github.com/nuclearace/socket.io-client-testing/blob/master/Package.swift. It's just some made up name for the target.. Something is setting the Swift version to 3.2. I don't think CocoaPods correctly updates the Swift Version in its Pods targets. It should be Swift 4.0.. Is this before or after calling a connect method? After calling connect config becomes read-only.. Something is setting your Swift Version to 3.2. Check all your targets and any pod targets.. From what I've seen CocoaPods doesn't automatically fix the SWIFT_VERSION for the pod target.. Manually adding isn't supported anymore. You'll need to use one of the supported package managers.. @lightsprint09 How does this look?. What version of the client and server are you using?. Ah that\u2019s why. The latest version of the client is for 2.0. 2.0 has a breaking Unicode change that you\u2019re seeing here. I said I would release a Swift 4 version of the 1.0 client but I never got around to it. . You have to send binary data as Data objects, not arrays. . Joining multiple namespaces isn't supported. You will need multiple sockets for each namespace.. My only concern is that it will be too different from the reference implementation, but if it works that would be nice. Honestly I haven't looked into the JS version and how it actually does namespaces behind the scenes. I vaguely remember it has a higher abstraction called a manager that this library lacks.. I need to update the readme, but to develop on the latest version you'll need to do carthage update. I think adding a manager might be a bit more work, since it might require restructuring the client in a few places. I would have to see how it's implemented before I make a decision if it's a good thing to add now.. So @alihen, looking at the js client. Each individual client can only connect to a single namespace.  https://github.com/socketio/socket.io-client/blob/master/lib/socket.js#L220. What this library lacks, and what I'm working on adding now is a \"Manager\" that will allow multiple clients to share a single Engine. Currently they must all have separate engines.. Although this is going to be a pretty drastic change to how things work currently... so I'm not sure if it's worth it.. https://github.com/socketio/socket.io-client-swift/commit/ba5f8ba4d9622fec81112653c74a54ba4f3810b9. @alihen You can check out #844. It'll be a somewhat radical change in the API that'll require adding a fair bit of documentation so people can update their code for compatibility.. That\u2019s very large for websockets and this library. The best you\u2019ll be able to do is set The handle queue to be something else besides the main queue. But sending such large messages frequently is going to be slow. . That wouldn\u2019t be thread safe. There are some stateful things that happen inside the client and it uses GCD and a serial queue to manage thread safety.. I should update the docs to specify that the handleQueue needs to be serial queue, and maybe make it clearer about what it means. But it isn't fully synchronous. Once emit gets to the engine it becomes async, likewise, once a message gets to the client it gets put on the handleQueue.. You probably won't see crashes using a concurrent queue unless you're using acks or sending binary data. Since those are the two things that use state. Or if you're adding handlers after connect, that might cause a race condition that results in a crash.. There's a difference between being async and having concurrent processing. I have no desire to add support for concurrent queues at this time, since it means dealing with locks and other such things which are difficult to reason with and manage.. Do you have a code example and log output? What does, \"it did not work,\" mean?. Someone else reported something like that: ~~https://github.com/socketio/socket.io-client-swift/issues/823~~ Correct issue: https://github.com/socketio/socket.io-client-swift/issues/842. And that's the wrong issue. @lightsprint09 For which package manager?. I'm not sure. Although thinking about it more I guess it is a little odd to have a patch number.. @lightsprint09 I've moved it back to 3.0.. @lightsprint09 How so? There's a new API for doing namespaces.. @lightsprint09 What do you mean the old socket.io version? It should support 2.0+. 1.0 hasn't been supported since 9 iirc.. @lightsprint09 What's breaking in the new stuff on 1.0? The major 2.0 change was a change in unicode handling which affected HTTP polling. So you wouldn't really see breaking changes until you started using unicode. And actually 12 is missing one of the changes 2.0 introduced (in 12 the sid is wrong for namespaced sockets) . https://github.com/socketio/socket.io-client-swift/blob/development/Source/SocketIO/Client/SocketIOClient.swift#L57. Probably won't work with the lib. I'm not sure why Carthage is not happy. Although I will say you should update to Swift 4 asap. It's not that big a change, and will probably solve this issue since I no longer use a custom Starscream impl. I solved this by doing \nshell\nrm -rf /Users/username/Library/Caches/org.carthage.CarthageKit/DerivedData/ /Users/username/Library/Caches/org.carthage.CarthageKit/dependencies/. _ContigiousArrayStorage is an internal Swift entity. And SocketIOClientOption is just an enum with value memory semantics, so it's impossible for users to control when it's released. And the SocketIOClientConfiguration is another value type, so it would be released automatically by ARC without needing weak or unowned declarations.\nFrom my experience, Xcode is pretty bad at determining leaks in Swift code. You see tons of \"leaks\" in the standard library.. Are you using your api correctly? Have you checked the server logs to see why it's disconnecting?. Hm. Yeah I'm not sure. I've never seen messages before a connect packet.. Ports below a certain number generally require the application run as a superuser. Besides that, make sure you understand Apple's strict requirements for TLS connections.. \"I can't just make it work\" is not helpful. What does not work? How are you creating the client? Have you turned on logging? Have you checked the FAQ?. @fabrijp For an iOS project you'll probably want to use CocoaPods or Carthage, SPM support for iOS projects isn't very good. You'll have to read up on using those package managers in iOS projects. Generally when you use a library, you should have a basic understanding of how to install them.. You can check if the client is attempting to reconnect with a .reconnect event listener. .disconnect is only fired once reconnection fails or the client doesn't reconnect.. Is this on a clean project? IIRC those modules were removed in favor of a true dependency on Starscream.. The latest release should work with Swift 4.. Generally you should also be wary of using !, but in this case if the assumption that applicationDidBecomeActive will always be called and always be called before anything else is true, I think this would be okay. So I'm not really sure.\nBut this isn't really an issue with the library, and more of an implementation issue. . If you turn on logging in the client was is printed?. Also be warned, checking the engine's connected status in this way might not mean the actual socket.io-client is connected, especially if you're using namespaces. And this code will not be compatible with v13, which is going to be a major change to the structure of the library.. Hm, I wonder if the ping counter is getting messed up with multiple ping asyncs. If you add the .forceNew config does it fix it?. @smartKrunal I'm saying v13 is going change the way the api is structured. So code like this will break. Just an FYI.. forceNew(true). Also you initial config is conflicting. forcePolling(true) and forceWebsockets(true) Won't do anything together, only one of them should be true. Won't break anything, but forceWebsockets will trump polling.. @smartKrunal I don't use skype anymore.\nAlso, I'll be releasing a v12.1.3 that includes a change that should fix this without forceNew.. WebSocket.swift shouldn't be in this project in the latest version.. It\u2019s the Starscream dependency, which I don\u2019t have control when they release a new version. . forceNew should generally be enough.. @stefanoa Ah, so in this case err is nil and there is data about the 503? That makes sense to add a status check here.. @stefanoa checked e877bb2 to look at status codes when polling.. @meiyongsheng You probably don't want to use socket.io transfer large amounts of data. Should probably use regular HTTP for that. That being said, you can send Data objects in payloads back and forth from the server.. @nefy55 Are you sure you're adding the right event name? AFAIK socket.io doesn't have a default \"message\" event.. @nefy55 Have you turned on logging and seen what's coming over from the server?. @usrpark Your server must be on socket.io 1.0. The latest version of the client only supports 2.0+.. @headlessme You should be able to modify the headers directly, (note this should be done on the engineQueue for safety.. Oh, duh. I think I had been wanting to make this mutable for a while but kept forgetting to do that. https://github.com/socketio/socket.io-client-swift/issues/684 This is the original request.. @olgadanylova You shouldn't be creating SocketIOClients directly. You should be calling this method I would recommend checking out the migration guide. Oops. @thully This works fine in v13.0, and I don't know of any reason it would've changed between those versions. Are you sure your server isn't always expecting some data? Because if that's the case the server is probably either crashing or just rejecting the event.. @mugx what\u2019s the minimum iOS target bitcode supports?. This is a question better suited for stackoverflow. It's not an issue with the library, but rather the way you're structuring your app.. What do you mean raw? You can send messages through the engine using the write method on it. . Note that those are engine messages though. So they\u2019d need to be encoded in the socket.io format before sending. So I wouldn\u2019t recommend doing that unless your server is just using engine.io. @GF106 You can just do\nswift\nsocket.emit(\"myEvent\", 1, \"someString\")\nYou can translate that to Objective-C but you just wrap your data in an array.. Is your server an actual socket.io server or just a WebSocket server? This library is just for socket.io. You should use Starscream or its objc equiv if you need a Websocket client. . No, why would you do this? This is defeating the purpose of using a library like this. Since you're affectively bypassing the entire library and writing directly to engine.io.. What? . Try turn on logging in both the client and server and see what is being sent/received.. Sounds like you're not using the latest Swift version.. @bennyban Read the migration guide You shouldn't create SocketIOClients directly.. @bennyban what does the log output say?. 2017-11-19 23:23:47.052558+0800 auction[31586:1307196] LOG SocketManager: Manager is being released\nLooks like a classic case of not not retaining the manager. . 2018-03-23 12:14:22.440236+0200 Tir test[48926:998128] LOG SocketManager: Manager is being released \nShould tell you what's going on. The manager must be a property or a global or it will get released by ARC. The README examples just assume you're running at the top level main.swift or inside a main function.. @ZvOlCuOk2009 I can't write your app for you. The docs are available. Check out the FAQs and the 12to13 sections for some examples. Those plus the readme example show pretty much all you would need for a very basic implementation.. Sounds like the wrong Swift version. . @kacak9229 This is an issue for StackOverflow.. @kacak9229 The question is really more general than just this library, it's a design question. You'll get a faster response if you ask the question on stackoverflow.. @kacak9229 I would make sure the token is there before doing anything with the socket. . @kacak9229 You'd either need a new socket, or if you're using the newest version, update the manager's configs.. @YugoCode Not really, it doesn't even look like the parser is running. Are you blocking the handleQueue with something? That's the only thing I can think of that would stop messages reaching the parser. \nhttps://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIO/Manager/SocketManager.swift#L339. @YugoCode Well in that contrived example you aren't setting up a run loop. You need to call CFRunLoopRun. @kajz3reczka @muslimrao calling CFRunLoopRun in an iOS app is a no-no. You only need to call that when you\u2019re writing a command-line app where you don\u2019t have an event loop. Duplicate of #679.. Hm, actually that issue is similar, but not the same.. Oh idk. I think it needs to be selectively turned on for certain SDKs since I don't think macOS supports it.. @tw23 This should be fixed in 13.1.0.. I think you answered your own question.. @SadekSyed Thanks, this is a bug introduced in 13. This will be fixed in 13.1.. @SadekSyed Can you try the development branch and see if this is fixed?. Duplicate of https://github.com/socketio/socket.io-client-swift/issues/587. Your server will need to broadcast messages received from other sockets.. Just sending an event to the server doesn't mean other clients will get an event. The server needs to send another event to the other sockets.. Unfortunately this wouldn't be possible in Swift without doing very bad things. https://stackoverflow.com/a/25694072. If you look at your logs more carefully, you'll see the issue.\nI wonder if I should just make it so the library traps if a Manager is released while being connected. This seems to catch 80% of people who don't understand how ARC works.. I haven't really been working on this branch much anymore. The annoying things you have to get around \\@objc stuff kind of ruins it.. How are you installing the lib?. Clear your Carthage build cache. What is this? There shouldn\u2019t be anything wrong with Unicode if you\u2019re using the right version of socket.io (2.0). If you\u2019re trying to use 1.0 and the current version then it\u2019ll be broken yes. Also, there\u2019s a reason this library has Swift in the title. It should be written in swift, not objective c . If that\u2019s the case and the server is using 2.0, then this still should be written in Swift before I can be merged. . Also if you could provide a server/message example that causes the issue. Does it happen for all Chinese characters or only certain strings?. I will double check, but last time I tested sending Unicode/Chinese characters in socket.io 2.0 I didn\u2019t see any issues. . @TomZid Are you doing something with the encoding before sending it on the serverside? I've been testing this locally using various unicode strings and I haven't seen any issue with the client decoding polling messages.. Also what server version are you using?. I thought this would've been fixed in 12.1.3.  You can try adding some prints to https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIO/Engine/SocketEngine.swift#L515 to see why it stops pinging.. I don't know why the engine queue would be delayed so much... If we have to use a new queue it'll get more complicated since you'll need to add locking.. @vincedev Well first off, if you're using socket.io 1.0 and anything higher than 9.0 on the client, you have a version mismatch. Anything past 9.0 is for 2.0.. I don't think it would cause this issue though. The most visible breaking change has to do with how unicode is handled.. I would still recommend updating to 2.0 though. It's not much lift on the server-side.. @vincedev Sorry, I've been busy with work related things and have just now gotten around to looking at it. I haven't been able to reproduce, but I will say that such short ping times are far from the default socket.io ping times. (Ping every 25 seconds, timeout after 60.) \nI've tried lowering the ping interval down to a second and haven't seen a timeout yet after ~20 minutes. So my guess is it could be tied to either how busy the engine queue gets (should be uncommon since the engine queue should be fast) or how busy the system is (highly unlikely on modern systems.)\n(Note this was testing on the latest version). Okay, now I'm able to reproduce when I use an actual app. When I just ran a bare bones run loop I wasn't able to reproduce. . Switching to a dispatch timer doesn't seem to solve the issue either.. @vincedev I may have figured it out. I think it's AppNap thinking there's nothing meaningful going on, maybe because there's no UI updates being done? So it lowers the priority of the app's queueing and throttles the timers.\n\n. When I add some\nswift\nlet activity = ProcessInfo.processInfo.beginActivity(options: .userInitiated, reason: \"some reason\")\nInside the app, it seems to not timeout. Although that's probably not the best solution.. https://developer.apple.com/library/content/documentation/Performance/Conceptual/power_efficiency_guidelines_osx/AppNap.html. It should be the app's responsibility I think.. This isn't something the library will be able to detect. All the underlying networking is handled by the OS, so if it doesn't notify us of a disconnection, there's nothing it can do.. Can you look at your logs and see if there's anything there? Generally though the best solution when dealing with background stuff is to take over reconnect logic from the library.. I don't know how this could be an issue with the library. This library doesn't do any direct writing to streams. That's all handled by the networking libraries.. Are all your interactions with the client done on the handleQueue?. Yes, the client is not thread safe, so all interaction with it should be on the queue that it is given (or the main queue, which is the default).. You need to the latest Swift/Xcode for the latest version.. Have you made sure that the SWIFT_VERSION is set properly on everything?. Manual import is no longer supported.. What version are you trying to use?. Closing for inactivity.. @hariios123 Make sure you're using the workspace CocoaPods makes for you.. If you're using the SPM you should have a Package.swift file for your project that looks something like this: https://github.com/nuclearace/socket.io-client-testing/blob/master/Package.swift. You should read up on how to use the SPM. https://github.com/nuclearace/SwiftBot/blob/master/Package.swift is a pretty simple example of how to use it.. Make sure you clear any related package manager's caches.. Could it be related to https://github.com/Carthage/Carthage#nested-dependencies\n\nIf the embedded framework in your project has dependencies to other frameworks you must link them to application target (even if application target does not have dependency to that frameworks and never uses them).\n\n. In english please.. Have you tried cleaning your project and/or cocoapods? . Installing manually isn't officially supported since there's some dependency stuff that has to be sorted out.. @headlessme I will need to look at the fix and test things out.. Sounds like you'd want Apple Push Notifications.. Yes.. Unless you force polling, headers are only sent on the initial connection. Otherwise a websocket connection is established and they aren't sent again.. If you've just copied and pasted the example in the readme, it assumes you create a run loop. So would need to call CFRunLoopRun after calling connect.. Can you provide more detail? What version are you using on the client/server, what configs are used, server settings (ping info.). @bl82 I'm not sure, there's a lot going on in your logs. What kind of connection management are you doing. I see a lot of manager being released and client being released messages.. So the error event shouldn't need a reconnect call, if something breaks the connection it should automatically reconnect. Beyond that, I'm not sure, I haven't been able to reproduce this. So a sample server/client that shows the issue happening would help.. Very strange. I wonder if it was some server or networking issue.. I actually need to update that documentation, reconnect() shouldn't emit a .disconnect anymore. It emits .reconnect.. Hm. 13.1.0 did change how some connect stuff is done.\nhttps://github.com/socketio/socket.io-client-swift/pull/881/files. First guess would be this. https://github.com/socketio/socket.io-client-swift/pull/881/files#diff-0a1f28547352834d5f60fc457346f374R132. Easiest thing to do would probably step through a debugger and see what's happening.. @bl82 I'm still not able to reproduce locally, so I'm going to need a project that demonstrates the issue.. @bhautikmobileappdev @bl82 Anymore on this? I would like to get to the bottom of this, but I've not been able to reproduce.. @bl82 can you explain the bad flow and how you fixed Incase someone else runs into it?\n@kinza88 Are you doing any load balancing between multiple socket.io servers that would cause the client to hit a server it didn\u2019t originally make the request to?. Or are you putting the socket into to the background and reopening the app?. @kinza88 No, I was never able to reproduce.. @ryan2x That's what the docs and CHANGELOG are for. It's also mentioned in the CHANGELOG for 13 to checkout the migration guide. I guess a link would have been more helpful, but it still mentions where to find it.. This really isn't an issue. But more of a design question, which is better suited for StackOverflow.. What version of socket.io are you using?. Because I'm not seeing this version with the latest server version (2.0.4).. This is more of an issue of their server implementation. Join packets don't need to have a trailing \",\". It works fine with the reference JS implementation.. Do you have the latest Xcode installed?. That's why. The latest version of the client requires the newest xcode.. This is something reported before, but I've never figured out what the issue was.. Closing for inactivity.. The only issue is this would have to be it's own branch. Since socket.io 1.0 is outdated now and I no longer update it.. I'll make a branch for this then.. Made a 1.0-swift4 branch.. Have you tried debugging where it should be getting the connected status? . Well the first thing would be to check the logs. If it\u2019s the default namespace the socket should go to connected once the engine is connected. . Well, I don't have an apple watch, so I'm not able to debug this myself.. What server version are you using?. Hm, I guess you're right. I'll update the namespace joining code. Although the JS server seems to work without this trailing ,.. @vsergeev1988 If you could see if the latest development branch fixes it, that'd be helpful.. Derp, should be fixed now.. Read the migration guide. Try looking at the rest of the migration guide. It provides a more realistic starting point.\n```swift\nclass Manager {\n    let socketManager = SocketManager(socketURL: someURL)\nfunc addHandlers() {\n    let socket = socketManager.socket(forNamespace: \"/swift\")\n\n    // Add handlers\n}\n\n}\n```. The first part assumed that you were doing that in main. Those errors are just standard Swift errors telling you that you're doing it wrong. Instance member instantiation must either be done lazily or in an init method.. See: https://github.com/socketio/socket.io-client-swift/issues/926#issuecomment-356097180\nYour getChannel can basically be\nswift\nfunc getChannel() {\n  let socket = manager.defaultSocket\n  // All the rest of your code that references socket\n}. I can't write your code for you. All I can tell you is:\n\nIn v13 you create a SocketManager for a connection to socket.io.\nThe manager needs to be retained so that it isn't released by ARC, just like the clients used to be.\nThe manager has socket(forNamespace:) and defaultSocket for getting SocketIOClients\nThose SocketIOClients have almost the same API as they did in previous versions. Not much has changed. You can call .on, .emit, .connect like you did before.\nYou can call socket(forNamespace:) and defaultSocket and get back the same socket from the first call, so you don't need to store it anywhere, you just need the manager.\n\nTo sum up. You just need to add a manager property and replace all your old socket.connect etc with manager.defaultSocket.connect and manager.defaultSocket.on\n  . I'm afraid I can't help anymore than that. If that's not enough, I suggest going back to the old version until you have the time to spend understanding the new API.. PRs should be opened against the development branch.. Manually merged into development.. Because the library uses Grand Central Dispatch for threading, if you aren't doing this inside of an App, you will need to manually start the main runloop by calling CFRunLoopRun(). You should know however that once this is called, nothing after it will be executed. So your while true loop will need to be redone using some other way.. In any case, you'll need to redo your while true. Since that's going to block the handleQueue. If you want to listen for a status change. There's a .statusChange client event you can listen for.. What do the logs say?. Also make sure that the manager is not being released by ARC. That would be one cause for connect not happening.. LOG SocketManager: Manager is being released\nThat's why. See the FAQ. Have you checked the logs? Make sure the manager isn't being released.. Are you running this inside of an app or just a main.swift? If you're not running inside of an app you need to start the main runloop.. Well, if logs aren't being printed then something is going very wrong.... Manager needs to be a property or a global. If it's not, then the manager will be released and it won't work. The actual socket object doesn't need to be stored; you can always access it from defaultSocket or the socket(forNamespace:) method. . Have you tried turning on some debugging on the server side?. @mouchegmouradian What version of the server are using?. The latest version of the client only supports socket.io 2.0. You\u2019ll need to use the socket.io 1.0 branch. . Socket.io 2.0 introduces a breaking Unicode change which would explain the bad encoding. . @mostafatabal 2018-01-20 12:25:29.650973+0300 socketIo[638:5854432] LOG SocketManager: Manager is being released\nThat's probably why. The manager is being released by ARC. It needs to be a property or a global. . Not sure how that could happen, the client's connect will eventually call the manager's connect if the manager isn't connected.. What?. If your manager is being released, then you're not properly maintaining it. Make sure that it's a property of an object that exists for as long as the connection needs to.. This isn't enough information to know what's going on. Make sure that you're using your server API correctly.. Turn on logging and see what's happening. . Can you post some logs from the client and server?. I'm not sure, it looks like the server and client are pinging each other.. I'm not sure, it looks like the engine connects and is pinging. Are you sure that you're sending all the credentials your API needs?. I'm not sure then, because it looks like the socket connects, \n2018-02-01 19:41:39.331213+0530 Demo[12012:602517] LOG SocketIOClient: Handling event: connect with data: []\nbut then I see no emits trying to happen and nothing comes back from the server. Oh, yes that would be why. To use namespaces you have to specify the nsp config in the old versions of the client. @{@\"nsp\": @\"/device\"}. It's just another config option. It's not in the docs anymore because it was removed in 13.0 in favor of a new API to use namespaces.. objc\nNSURL url=[NSURL URLWithString:@\"https://app.mydemo.io/rt.mydemo.io\"];\nsocket = [[SocketIOClient alloc] initWithSocketURL:url config:@{@\"nsp\": @\"/device\"}];\nNSLog(@\"The socket url is %@\", url);\n[socket on:@\"connect\" callback:^(NSArray data, SocketAckEmitter* ack) {\nNSLog(@\"socket connected \");. Perhaps some sort of TLS issue?. If you're seeing these messages, it means you're not properly keeping hold of the manager and socket, or whatever is holding them.. It's not because of not invalidating the URLSession. It's because the config you use to include the session delegate is keeping it alive.. Going to need more info. Can you provide some logs? Are you correctly using your API?. Closing for inactivity.. Instead of using defaultSocket, does manager.socket(forNamespace: \"/client\") work? Also you'll need to use the connectParams options instead putting them in the URL.. Make sure all interaction with the client is on the handleQueue. The client is not thread/queue safe.. Yes, you should be using one queue (the handleQueue) to interact with the socket.. @MarcoBrescianini Thanks. This was a leftover from when there was more complicated queueing going on. Now that that is cleaned up, this should be straightforward.\nCan you checkout the latest development branch?. Ah... Yeah I guess that makes sense. @MarcoBrescianini The exclusive access issue should be fixed in development. Sorry it took so long, been busy with actual work stuff.. You shouldn't need to call removeAllHandlers unless you've strong captured a self or captured the manager or socket. But to cause a socket to deinit you need to call removeSocket. But if you want to deinit all of them at once you have to set the manager to nil.. It gets a bit more complicated since socket.io supports sending raw binary in objects at the application level. Internally it has to go through each object and remove the binary and add placeholders for them. So you would still have to handle this case.. Right, this is why I introduced SocketData. You should not make sockets yourself. You should either use defaultSocket or call socket(forNamespace:) to get a socket to use.. @shravansukumar Yes.. No, this library is for interacting with socket.io.. Please check out the docs and the README. They show how to properly create sockets.. Make sure you're using the API correctly for the version you have. That's just a Swift error.. Well, unless you're forcing polling, you would have to reconnect to send the other headers. I'll have to double check if the client can set extraHeaders while it's still connected (I wouldn't count on it). I haven't done any energy impact on this lib on iPhone in a very long time. But in theory it shouldn't be that energy hungry unless it's emitting or if the server has set a crazy ping rate.. You'll probably need to use SSLSecurity.. What server and client versions are you using? This should be impossible since everything is put through a JSON serializer.. And there are tests for emits.. Is this a socket.io server?. I'm not sure how that's possible then. How are you seeing this invalid json?. This is one of the tests that makes sure the packet format isn't getting broken. (I admit I need to redo these tests to not compare strings). You might want to call removeAllHandlers before you set some controller to nil. You might have a strong reference that's causing a cycle.. @sonysum I don't understand the issue then. Can you explain a bit more?. Is your namespace really \"/rt.demoSocket.io/client\" or should it just be \"/client\"? Also make sure that you're properly storing the manager.. What do your logs say?. And is your server sending anything? Do you see anything in the logs where the socket/engine is getting things back?. Sounds like you have an API issue then, which I can't help with. I can only give some suggestions.\n\nMake sure your manager is a property or it will be release by ARC and nothing will work.\nMake sure you have the right namespace. If you use a url like \"https://mysocket.url/namespace\" in a JS client then the namespace you need in the Swift version is \"/namespace\".\nMake sure you add all handlers before calling connect, or there's no guarantee that they will be called.\nMake sure you're sending the right events at the right times.. Sounds like you're trying to send a unsupported type through the client.. What version of socket.io are you using on the server?. The latest version of the client requires socket.io 2.0, which has a breaking unicode change. So things like emoji would probably be garbled in the client if your server is socket.io 1.0. Use the socket1.0 swift 4 branch if you need socket 1.0 support.. Good question, and one I don't really have a good answer to. Swift doesn't have a very good testing ecosystem IMO. It lacks good mocking support built into the core, so it's hard to test how methods/functions are called. So your best bet is doing something like this where you subclass something and make sure public methods are being called like you expect.. @tolgaytoklar Generally it's been my recommendation to turn off manual reconnects when the application goes into the background and re-establish the socket once the app comes back. Background execution has always caused problem with this library. (Since it's written to work on multiple platforms it doesn't do any special casing for iOS). I think you're looking for a WebSocket library. You should checkout Starscream in that case. This library is for interfacing with servers that implement the socket.io protocol.. You need to know the type of the data you expect to get back. But once you do you can just cast to it.\n\nFor example if your data is JSON:\nswift\nsocket.on(\"myEvent\") {data, ack in\n    guard let dict = data[0] as? [String: Any] else { return }\n    // Use dict\n}. @aimensasi What do you mean? No, the client will always turn the socket.io data into the respective types.. Otherwise you would just get back a string.. @astrike30 are you able to receive messages? Can you post server/client logs?. Can you post some logs?. 2018-04-03 23:55:22.421797+0400 SwiftIPhone[36889:1387350] LOG SocketManager: Manager is being released. The manager needs to be a propery or global. It's getting released by ARC.. Can you post logs? Just posting code doesn't help in this case.. Can you post some code?. @PXLZHM Is the server configured for WebSockets? Are you behind a proxy (Starscream doesn't support this yet, it's an outstanding feature request)? . What do the server logs say? Esp those printed with DEBUG=*. What do you mean?. @muhd-ali The manager shouldn't be a local variable. It will get released by ARC and everything will fall down after that.. @tangenttw It looks you're declaring your manager to be a local variable. This is a mistake because of ARC. As soon as the function returns the manager will be released, and everything falls down after that. The manager should be a property of something.. @deepakyadeedya Don't create a SocketIOClient yourself. Use the socket(forNamespace:) method on the manager.. Can you explain a bit more? This looks like a logic error in your API. The client isn't going to do any data manipulation, and packets are treated independently.. Is the manager a property? Can you post some logs?. It looks like the engine is never getting anything to begin with. Make sure that you're using your API correctly.. Rooms are a server side feature only. Have you verified that messages are being received in the server?. @Arunbalaji001 Instead of calling [manager emitAll:@\"join_user\" withItems:[SharedData sharedConstants].commonuserid];, if you just call emit on the socket, does that work?. What?. Dude what. Is everything being released here? Because the statement reason parameter is empty and nil should not be true unless something very very wrong is going on.. \ud83e\udd26\u200d\u2642\ufe0f . @opfeffer Should be sometime this week I hope.. The README code assumes you're adding stuff directly to main.swift or a main function. A real app would be structured differently. (With the main point being theSocketManager should not be released by ARC.\nAlso, if you're new to Objective-C, I would recommend using Swift, it's much easier to learn than ObjC.. Can you post some logs? Pref when you socket/manager are being created.. Everything looks normal to me. I see it connecting and pinging. But no emit tries or getting anything back. Which usually means you're not using your API correctly.. Actually, I see where there is one emit after connect. But then nothing else. Is the server getting what you emit?. I'm not sure then. Nothing in the lib should have changed/broken from the new version of Xcode. As far as I'm aware.. @simformsolutions Can you post logs?. If someone could help debug this, that would be helpful. Because I am not able to reproduce the issue. Debugging is going to involve DEBUG=* node on the server to see what the socket.io server is actually getting.. Having a SocketManager as a local is very bad. It will be released by ARC and with it everything else.. What version of the client and server? Are you doing any emits outside of a .connect handler, or when it's not known if the socket is connect?. And is this server running locally? I cannot reproduce on the latest version (which is the only supported version).. Tracking in #996.. That sounds like some sort of error with your toolchain.. You should just be able to rename one of the files. The actual file names don't matter. It's the types that matter. You might have to change the name of one of them.. @marcuschoong as the Starscream files are in the same target as the socket.io ones, you can remove the import. . Did you get anywhere with this? Sorry I couldn't get back sooner.. You'll need to pass in either sessionDelegate or a SSLSecurity options, or possibly both, depending on your case.. If you're adding through CocoaPods make sure all targets have a SWIFT_VERSION > 4. The most recent version of the lib is for the current version of Swift.. Was this going to be ported to Swift? You should also add a test case for this.. Using socket.io for images/video, esp if it's meant to be realtime, is probably a bad idea. That being said, you can Data objects in dictionaries and the lib will handle it correctly when sending.. @payalu The simplest case is just\nswift\nsocket.emit(\"myDataEvent\", Data())\nBut you can also have Data inside dictionaries and arrays.\nTurning your image data into a Data object is something I can't help with though, you'll need to ask that sort of question on StackOverflow. . Probably you aren't setting the current URL for working in the sandbox.. Be sure to update your pod specs. pod repo update.. What is the crash reason? . Yes I thought about adding such a feature. And one does exist for sending SocketData. The issue is that Swift's codable doesn't really play nice with unknown payloads with dictionary and arrays. Not saying it's impossible, just that the interface exposed probably isn't going to be very pretty or intuitive.\nYou're welcome to give it a shot though, I don't have time much these days to work on stuff in-depth. . Can you rebase this so that the merges are gone?. Also, you a mention concurrent queue. The library is not designed to handle concurrent queues. https://github.com/socketio/socket.io-client-swift/blob/development/Source/SocketIO/Manager/SocketManager.swift#L89. I guess I forgot to update the documentation for the handleQueue option.. @alevinru As mentioned in the previous PR, this library is designed around the principal that it should only work around serial queues, and indeed it can only really work with serial queues because of the way that socket.io works. This would be one change that would be needed to make it work with serial queues, but there would need to be more.\nFor example, adding handlers vs executing them would need to locked, managing the binary data that socket.io sends back (which is the part that would start breaking with concurrent queues) would need to be locked. And there's probably others that would also need to be change.\nWhen I wrote this library it originally had a pretty complex queue system, and I had hoped to make it work with concurrent queues, but it quickly became apparent that the complexity, and how socket.io behaves in JS and the other clients, made this not feasible.. @alevinru The handleQueue is not really the internal queue in this case. It's the queue that all interaction with the manager/client should be done, and the queue must be a serial queue.. @alevinru Yes exactly. There's a note on that in the docs for the client. https://nuclearace.github.io/Socket.IO-Client-Swift/Classes/SocketIOClient.html. I'll add a note for it for the manager as well.\nI'm going to close this PR. I appreciate the work, but this isn't something I think the library can or should support.. @alevinru It's still incorrect to use a concurrent queue as the handleQueue regardless. Because of the way socket.io sends binary, packets must be processed in sequence. A concurrent queue would make it impossible to correctly attach binary to packets without adding more queues. Which means more locks and dispatching. \nThe strong capture can be its own PR.. Sorry for missing this. Does the logs spit out something about an unknown session id? . @Ketan-Wadyalkar Please read the FAQ and a little on ARC; the manager is being released from memory as soon as it goes out of scope.. @iosnatarajan what server version are you using?. @iosnatarajan The latest versions of the client only support socket.io 2.0. So either you need to upgrade your server, or use the swift4.0 branch that supports socket.io 1.0.. @jaragones sockets must be created with the SocketManager.socket(forNamespace:) method. So your second attempt would need to use that method. The first method is not supported in this library. Namespaces must be created explicitly. . @MD04-TanTan You also need to make sure you're using the workspace CocoaPods creates for you.. I don't understand the issue.. This sounds more like a programming issue rather than an issue with the library. I'm not sure of the best way to communicate to a client that a server is busy.. No, you'll need to use the swift4 branch that still supports socket.io 1.0. The latest versions only support socket.io 2.0. I strongly recommend upgrading the server, as 1.0 is no longer supported.. Check out the migration guide from going from pre-v13 versions.. It explains that actual socket clients are created through a manager. Which also is where configs go now.. V13 is a major API change, so I would check the readme example and the docs for how the new API is laid out.. @alekzernov The manager must be a property or a global, otherwise it will be released and the connection will go.. Also, you must use the socket(forNamespace) on the manager.. @alekzernov It's basically the same, except you pass the URL and the configs to the manager. And then use socket(forNamespace:) or defaultSocket to get a socket. . No, the manager must be a property or a global. If and when it goes out of scope it will bring down the connection with it. And furthermore, you shouldn't be making SocketIOClients yourself unless you're familiar with how the manager is structured. See the README and the docs for examples on how to make clients.. Please do no open multiple issues.. @gorbat-o All configs are the same for the most part, but are on the manager. Generally you only explicitly make SocketMangers, since they are the ones responsible for clients. Clients are obtained from the socket(forNamespace:) method.. It gets passed into the manager.. @gorbat-o You shouldn't need to call setConfigs directly, (although I don't think it would hurt anything). The Manager init takes a config object.. @ANKITASRI04 Your manager isn't a property or global variable, so it's getting released by ARC. Please checkout the FAQs, it discusses this.. Can you post some logs for the client?. This looks like the client is functioning properly, so it's probably an error in how you're managing the emits. Which isn't something I can help with.. If you add a log to your second emit method, does it print anything? The log you posted above doesn't show any logging for that emit.. In that case there's something wrong with your outlet, since the method isn't even being called.. Right, but in your logs you posted above, I don't see any messages for emitting \"clientCameraPanningEvents\". I also don't see any error saying an emit was tried while the socket wasn't connect. Which leads me to believe that the client never got an emit call for that, since it should log that emit or log an error.. I still don't see anything where it even attempts to emit your \"clientCameraPanningEvents\". Another thing I'm confused of is the lifetimes of your sockets. It looks like you recreate the socket when the view loads? I think that is fine as long as you're not trying to emit before the socket is connected.. What? . Is this for macOS or iOS? But yes, the manager must be a strong property or a global. Also, the readme examples just assume you're running that code in main.swift or in a main function. It also leaves off starting the run loop.. What is the pingInterval on the server?. Did this happen after bringing the app back from the background? Because in general on iOS you'll want to turn off automatic reconnection and do that manually, since background execution is very limited on iOS and it causes problems for the client.. Are you by chance adding multiple handlers for reconnect? Multiple handlers can be added for events. So just blinding calling on inside of some viewDidLoad isn't going to be safe.. I don't see how a reconnectAttempt event could be called that quickly unless it's going through the handlers loop. Especially since there's no other logging in-between them.. Yeah, adding handlers inside of a connect is bad. Connect could be called on the same socket multiple times, including when the socket actually reconnects. Generally you should add all handlers before calling connect.. The general workflow should be: get socket -> add handlers for socket -> call connect.. There's an example on the README. But also:\n```swift\nclass SomeClass {\n  let manager = SocketManager(socketURL: someURL)\nfunc setup() {\n    let defaultSocket = manager.defaultSocket\n    // Add my handlers\n  }\nfunc connect() {\n    socket.connect()\n  }\n}\n. Can you post some logs? I don't see anything wrong with the code.. @webtamizhan If you look at the docs for [extraHeaders](https://nuclearace.github.io/Socket.IO-Client-Swift/Enums/SocketIOClientOption.html#/s:8SocketIO0A14IOClientOptionO12extraHeadersACs10DictionaryVyS2SGcACmF), it takes a dictionary of `[String: String]`. Which in obj-c is just an NSDictionary.. I added a test for it [here](https://github.com/socketio/socket.io-client-swift/blob/d07441e7fa4c2b5fdc25582198a9ba38f451747b/Tests/TestSocketIOObjc/ManagerObjectiveCTest.m#L16). I would try debugging the server and see what is coming over in the request.. @mPradeepa Looks like you're upgrading to v13. You should checkout out the new API docs as well as the [migration guide](https://nuclearace.github.io/Socket.IO-Client-Swift/12to13.html). v13 was a \"big\" change for the library.. @OneSman7 That sounds plausible. Would you be able to try out your change, and if it looks good, raise a PR?. Hmm I remember this leak can happen when the URLSessionDelegate (the engine in this case) isn\u2019t cleaned up in the URLSession by calling invalidate. Which I think happens in stopPolling. . So that guard block needs to have more logic in it to handle the case where the client is gone, I think.. I think that is a good idea. \ud83d\udc4d . You probably should open this against the Starscream project. This library doesn\u2019t use any direct networking. .swift\nlet manager = SocketManager(socketURL: url, config: [.reconnects(false)]))\n``. Make sure all interaction with the client is on thehandleQueue`. The client is not thread safe.. What server version?. Yeah, this currently isn't supported, because the actual type of the configs aren't representable in Objective-C. There would need to be a method that takes an NSDictionary and does the conversion like the init does.. Make sure your URL is actually https. Besides that, you'll probably need to use the URLSessionDelegate option if you want real SSL pinning.. Make sure you're properly handling your session delegate methods to handle your cert.. You should look into Apple's security requirements, they're pretty strict for production apps.\nSome reading:\nhandling challenges\nGeneral security for networking on page 36 specifically the App Transport Security section.. You shouldn't need to call CFRunLoopRun in a regular App. You only need to call that for command line apps.. @Nitish34 Be sure you're specifying somewhere in your project files what Swift version your code is. The library requires the latest version of Swift.. @Nitish34 This library only supports Swift 4, so you'll need to make sure your project is using Swift 4.. @Nitish34 what errors are you getting when your project is in Swift 4 mode?. Are you using the workspace that CocoaPods creates? You have to use that one.. I was able to make a new project, pod init, add pod 'Socket.IO-Client-Swift', '~> 13.2.0' to the Podfile, pod install, and then use the new workspace that CocoaPods created and use the module with no issues in Xcode 9.3.. Memory analysis for Swift is notoriously error prone, especially between module boundaries.  I don't see how this code would leak anything.. This is actually needed for socket.io when it sends messages that have binary data in them. In the case of long-polling it needs to send them as base64 encoded strings after the initial JSON payload.. @shacharudi I'm not very familiar with the inner workings of the actual engine on the server side. But I would recommend doing DEBUG=* however_you_start_your_server and see what gets spit out.. @MrShiY What version is the server using?. @MrShiY I meant what server version. This library only supports socket.io 2.0. 2.0 introduced a breaking unicode change, which is what you're probably seeing. . If you need socket.io 1.0 support, you'll need to use the (unmaintained) 1.0 branch.. This library is completely platform agnostic. It relies on the underlying networking libraries to tell it if the connection has gone away. Your best bet is to add some availability checks yourself. Is this happening when the client is doing long-polling or WebSockets, or both?. Be sure that you're setting a SWIFT_VERSION for your project.. I've not seen that second issue, but others have apparently. The CI system also doesn't seem to run into the issue when testing the library using SPM. I will try and look into this a bit more.. Yes, you can check out https://github.com/nuclearace/socket.io-client-testing. Which is just a scratch project I use to test some stuff for this lib.. I can't help much here. I'm not very familiar with how CloudFront expects traffic to be routed.. @ImranIB This doesn't look like a socket.io server. Were you trying to use this library as a WebSocket library? If so you should checkout Starscream. @Rupasekhar Usually when this happens. Something is not properly setting the SWIFT_VERSION. This shouldn't be a problem with the library itself, it already declares what SWIFT_VERSION to use. . @Rupasekhar Your best bet is just to create a whole new SocketManager, client, and handlers if you need to change connectParams. . @Rupasekhar That's up to you how you want to structure your app.. The thing you want to be wary of is that the Manager should be retained for as long as the connection should be around.. It's unmaintained now. https://github.com/socketio/socket.io-client-swift/tree/1.0-swift4. All interaction with the client should be done on the handleQueue which by default is the main queue. If you try and access the client outside of that queue, you're prone to race conditions and crashes.\nThat being said, that stack trace really isn't enough to go on.. @huforrest Are you trying to connect to a socket.io server or a plain WebSockets server? This library is only for socket.io servers.. @MD04-TanTan Is your problem solved?. Manual install support isn't something that will be officially supported anymore, since it would require also manually adding Starscream sources to the project. . @XiaoFei326 It looks like your manager is getting released. Check out the migration guide For moving to the latest version.. I don't quite understand your question? This looks like something shown on the README?. If you want to emit with an ack it would look like.\nswift\nsocket.emitWithAck(\"canUpdate\", cur).timingOut(after: 0) {data in\n   // do something with data\n}. @EvangelNancy If this is a command line app you need to call dispatchMain.. @KonamiWu Just a stack trace isn't very helpful. Can you post some log output?. @hansemannn That stacktrace doesn't really help. It just shows that the library called back into your code, which then did some stuff that caused a crash. My gut tells me that it's something to do with dispatch queues. By default the library uses the main queue to dispatch callbacks to.. If you want to connect to a raw WebSocket server you should use Starscream. This library is for connecting to a socket.io server. Socket.io happens to use websockets as one possible transport. . @binloan If that's the case, then from looking at your log, you're not properly holding onto the SocketManager. If the SocketManager isn't strongly held it will be released by ARC and bring down the connection.\nYou can see that in the:\n2018-08-29 22:54:19.917096+0200 Jet Prototype[2095:348148] LOG SocketManager: Manager is being released\n2018-08-29 22:54:19.917176+0200 Jet Prototype[2095:348197] LOG SocketEngine: Starting engine. Server: http://192.168.1.21:1337\n2018-08-29 22:54:19.917198+0200 Jet Prototype[2095:348148] LOG SocketIOClient{/}: Client is being released. Yeah this looks like a bug.. Hm, the idea for this was to allow cookies from the initial polling connection to carry over to the websocket connection.. @hschouman Have you tested if this ever actually returns cookies? There's a scheme difference between urlWebSocketWithSid and urlPollingWithSid, and session will only ever have the polling url.. @hschouman One last thing, can you change this to be opened against development?. @JadianZheng Make sure the SWIFT_VERSION flag is set to 4 or higher.. I've verified that the codebase compiles with Xcode 10 beta. So it must be some configuration issue.. Duplicate of #1081 . What server version are you using? The current version of the client requires socket.io 2.0+. 1.0 isn't supported anymore.. See the close reason in https://github.com/socketio/socket.io-client-swift/issues/1087. Bug reports should be submitted in english. . @sanyamjain65 Configs are added on the manager, and are passed down to sockets.. Are you using load balancing? You might have to set the forceNew config option to force a new engine for reconnecting, since by default it will try to reuse the previous session id.. Have you tried forceNew? This log isn't very helpful, since it looks like the server is returning a 500. Also, if you're using iOS, it's probably worth disabling automatic reconnecting and explicitly handle creating/reconnecting yourself. iOS doesn't play nicely with background connections, especially with this library.. Have you tried adding the .forceNew(true) config? Also you shouldn't need to call .joinNamespace(), it's probably best to use the manager to control the sockets.. Right .reconnects(false) means you will have to manage the connectivity of the socket. The most bulletproof way to handle that is just to recreate a socket when the app comes back into the foreground. [.reconnects(true), .forceNew(true)] might work for you though. btw I'm basing all this on the assumption that something in your server doesn't like the sid being present. Otherwise you would need to find out why the server is returning a bad request. . @Pradeepkn Is this resolved or? . What? The client doesn't use isoLatin1, it uses unicode. And the latest version of the client only works with socket.io 2.0, since the way that unicode was encoding changed between 1 and 2.. Once strings get to you, they should be standard Swift strings, which are fully unicode compatible. What issues are you seeing?. What server version? The current version of the client only supports socket.io 2.0. If your server is 1.0 you will see garbled unicode, since there was a breaking change between 1 and 2.. @lianxiang1 What server version? See my above post.. Looks like that only supports socket.io 1.0, so the current version of the client will not work with it, you'll see your issue. You'll have to use the 1.0 branch. Note that it's no longer supported however.. Looks like there's an issue on that project about it. https://github.com/mrniko/netty-socketio/issues/566. Also just an FYI, this client is only built for the reference implementation of socket.io, which is the node based socket.io. It's up to other vendors to respect the socket.io protocol.. @hailie-rei Make sure you're using your API correctly. That's the error returned when you try connecting to a namespace the server hasn't created.. @hailie-rei You'll need to create a manager for each socket in that case. Sockets share a single connection with a manager, so they share the same configs.. Please see the FAQs. You're not properly maintaining a strong reference to the manager, so it's being released by ARC.. Make sure all targets have a Swift version > 4. Doing a clean pod install sometimes helps.. @liuhuan3344 Make sure you store the SocketManager, if that isn't properly retained, nothing will connect.. @habiburrahuman Did you do a clean pod install? Usually this error happens if you change xcode versions and don't do a complete clean install. . I verified that it still compiles in 4.2, so it must be some CocoaPods thing.. @habiburrahuman were you able to resolve this?. @sanyamjain65 I'm not sure what's going on here. I would double check that you've followed the standard CocoaPods installation. (The one in the README makes assumptions that you know how to use CocoaPods). Yes, background execution is not explicitly supported with this library. You can try various ways of tricking iOS to giving you a little bit more time in the background, but generally iOS will close connections that go into the background.. You're welcome to give it a shot at implementing this. . I hope to get a new version out this week.. This looks pretty good! Can you open this against the development branch?. Excellent, one thought I have though: Would it make sense to wrap the user provided callback with one that wraps and dispatches on the handleQueue? If we don't do that we'd need to document on the method that the provided closure won't be executed on the handle queue.. Something maybe like\n``swift\n{[weak self] in \n  guard let this = self else { return }\n  this.handleQueue.async { /* call callback */ }\n}. Awesome, this looks good! I'll merge this in once 13.3.1 is merged into master (should be this week.). @FLGiOS Is this a socket.io server? This library won't work with any WebSocket server. If you need that, checkout https://github.com/daltoniam/Starscream.. Can you post some log output?. Are you connecting to the right endpoint for the socket.io server? Also what configs are you setting/how are you creating the manager?. What params, and what version are you using?. @vonox7 Can you open this against development?. This doesn't look like an issue with this library.. Use the [extraHeaders](https://nuclearace.github.io/Socket.IO-Client-Swift/Enums/SocketIOClientOption.html#/s:8SocketIO0A14IOClientOptionO12extraHeadersACs10DictionaryVyS2SGcACmF) option.. Make sure you do a clean CocoaPods install and check all Swift versions, this happens if the Swift version is not set correct. It should be a min of Swift 4.. Installing from source is no longer supported. You should use one of the package managers to install the lib.. Can you post some logs from the client? Also, you should look into updating, this is a rather old version.. @sjaq Going from what I saw in the email message, do you still have/messages` in your URL?. Also, if you can post logs from when it wasn't calling event handlers on the namespaced socket, that'd be helpful.. Are you using the latest Xcode and a clean CocoaPods install?. If I remember the server api, what you want is to use the path option.\n``swift\nSocketManager(socketURL: someURL, config: [.path(\"/api/\")]). I'm not sure Network is going to be long term future. Starscream is actually thinking about moving to [NIO](https://github.com/apple/swift-nio) and [NIO Transport Services](https://github.com/apple/swift-nio-transport-services). Which would allow this lib to be used from all Swift supported platforms, not just Apple ones.. But regardless, I plan to keep Starscream up-to-date. So if Starscream goes with Network, so to will this lib.. Yes, if Starscream releases a new version that includesNetwork`, it'll be incorporated into this lib. . @khimani91 Make sure you do a clean pod install.. Hm... It looks like Starscream doesn't support Xcode 9 anymore. That's a bit annoying they did it in a minor version.. @balkrishanyadav You should probably read the 12to13 guide as well as the FAQs. The example on the readme also shows how to create clients.. What version of the server is this? This sounds like some socket.io 1.0 vs 2.0 issue. 2.0 had a breaking change in the way unicode was sent over the wire.. @wchuang I'm not able to reproduce this. I'm able to send and receive emoji just fine with the latest client and socket.io versions.. That stack trace doesn't look related to this work. It looks like a crash that occasionally happens in Starscream. Do you have a way to reproduce the crashes? Without that the stacktrace isn't very helpful.\n@headlessme I believe I got rid of the optional bit because it shouldn't have a noticeable impact passing an empty closure when you'll inevitably still create one down the line. . @vonox7 I can certainly look into the crashes. But this hasn't even been released yet, so if you're using the development branch in a production app, it's on you for releasing an unstable app. The development branch is not meant to be production-stable code.. @vonox7 I'm not entirely sure how it could be related yet if they are. This will be hard to debug without a reproducible case.. Also, that stack trace looks like it ends in a Starscream path that doesn't even interact with this feature?. @vonox7 Actually going through this code again, because of that final dispatch queue stuff that it does, it probably is better to make sure we propagate nil when no closure is given. I don't see how it could have caused huge performance problems and crashes unless you were sending a ton of messages in a very short amount of time.\nDid you want to PR that change? It is usually faster to make the change yourself and open a PR that I can review.. @vonox7 your PR has been merged. Looks like your server is returning an invalid namespace error. I'd make sure you're following the API of your server.. Make sure you're cleanly installing the dependency.. Have you verified this complies? I'm getting an error for not unwrapping an optional.. Unfortunately socket.io no longer supports 1.0 officially, therefore you'll have to point to the branch for this.. Why is this needed? My previous experience with Xcode is that you can leave the Swift version at the last major version and it will pick up the newest compatible version.. Also this would need to be opened on the development branch.. Okay, just to play it as safe as possible, I'm going to go ahead and release 13.4.0 now before merging this. And this can be the starting point for v14.0.0. (Really the last release should have probably been 14 since Starscream actually broke semver in the last release).. Because of the differences in type systems between the two languages, the Swift version packs event data into a type erased array. So to actually use the data you need to know the type of the data.\nswift\nmanager.defaultSocket.on(\"new message\") {data, ack in\n   guard let dict = data[0] as? [String: Any] else { return }\n}. Not sure I understand this question. Can you elaborate more?. Make sure the server is behaving correctly. If the socket calls the connect handler, that means the socket has established a connection to the server.. How many points are you sending per-second? One thing you could try doing is using the raw emit views that were added. These bypass a destructuring operation that otherwise has to happen for each emit. And depending on the size/nesting of the objects you were sending, might have some impact on performance.. I'm not sure in that case. I've not done heavy stress testing on the client, but sending that many messages that quickly might run into some overhead. You can use the new emits with completion handlers to get a very rough idea of how long it takes to send a message. . From what I can see, the client is successfully connecting. As you see connect handler being called.. I would make sure that you are using your API correctly. It doesn't look like the client ever receives those events.. I can only help so much here. The client can only send events to the server, it's up to the server to handle those events and then send other events to other sockets. Sending an event on one client does not mean that other clients are going to get an event.. @Sea-Eagle That's going to be on you to decide how to implement. You might try asking on StackOverflow though.. Have you tried doing a clean install of your dependencies? Also make sure your Swift versions are set correctly in your targets.. Make sure that you're using your API correctly. Also you should check the logs for those expected events. If they aren't in the logs at all, then they aren't getting sent by the server.. How are you installing the framework?. @fanglinwei can you post some logs for this? I can't reproduce locally.. Can you post some logs around this happening?. Can you post the actual client logs? I want to see what the engine/manager/client think they should do in this case.. Oh I think I misunderstood the issue. Currently the client doesn't remove handlers on a disconnect, you'll have to manually call removeAllHandlers.. Does manually calling removeAllHandlers before your disconnect solve your issue?. Use connectParams. @wfy-answer It would look something like:\nobjective-c\nNSDictionary* opts = @{@\"connectParams\": @{@\"something\": @\"someValue\"}};. That's a pretty strange error to be seeing, are you able to reliably reproduce it?. I'm a little unsure what your issue is? If this is about receiving connect events, but not receiving disconnect events, it's most likely related to how iOS does background execution. The library doesn't have a way to tell whether or not app goes into the background.. @BRLOKESH What exactly is the issue? I'm not sure what you're trying to do.. What?. Unfortunately Starscream broke SemVer with one of their versions. You'll have to use an older version of the client, or use the latest xcode. Starscreams's maintainers have stated they're not going to fix this.. Because Swift doesn't have the ability to have n-args to functions, the library wraps the args in an array itself.\nSee if this type of thing works:\nswift\n// Inside your event handler\nguard let dataArray = data[0] as? [Any], let first = dataArray[0] as? [String: Any] else {\n  // ..\n}. @webMing Can you not cast the first argument to NSString?. Also, can you post logs of the initial socket connection? It might shed some light on why it's not connecting.. Ah right, statusChange's data arg is an enum type. So in Objective-C it's going to be an int I believe. But the Swift bridging should also create an Objective-C way of referring to the various cases, I just haven't looked at what they are in ObjC. https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIO/Client/SocketIOStatus.swift#L29. Hm, this \"statusChange\" issue may be an issue with the bridged API. I'm going to need to investigate further.. Okay, I think I see how to fix this. It will require a minor version bump. Basically it looks like if, in Swift, you pass an @objc enum to Objective-C, you must pass the rawValue instead of the Swift enum.. @webMing I plan on releasing a new version this week.. Nice! Could you do me a favor, and add an entry for v14.0.0 in the changelog detailing this addition? It just so happened I was about to release a new one soon.. Excellent thanks! I should be releasing a new version sometime this week.. This isn't supported in an official manner at the moment. You could subclass SocketManager and override the parseEngineMessage method, and then call the event handler method on the correct socket.. @VishveshLad Probably the best solution is to not rely on the socket for automatic reconnection/connection logic on iOS. Because the lib is platform agnostic (with linux support still a wanted goal in the future), the client doesn't make any special cases for iOS and its background execution model.\nThe general solution would be do add a background execution task to disconnect the socket, and then when the socket comes back into the foreground, reconnect it.. See the test case. It shows how to use the new form.. Especially on iOS and other systems that don't support background execution, it's probably best to take manual control of connecting/disconnecting. The client is reliant on the underlying networking to notify it of any connection issues.\nThat being said, can you post some logs that happen during your scenario?. @headlessme Yeah go ahead and make that change. IIRC, that's probably how it should've been in the first place.. @sooryaraj What Swift version is this?. Can you provide some logs that show this issue?. I'm not sure what the issue is. Can you provide some more context and logs?. Can you provide more detailed logs that show the engine messages?. Have you made sure you're doing a clean install of the dependency?. @sangriel what server version are you using?. Is there no swift option yet?\n. If we add any new projects we'll have to manually add them.\n. I don't like using Objective-C API's like this in Swift. I would prefer to keep the requirement of conforming to a specific protocol to get the name of the type. Or ditch it entirely and just change altType to type\n. I would much prefer that this be kept an optional return type. Or if Swift ever introduces an Either type, that would be better\n. This is much too condensed. It serves it better if it's split into more lines.\n. Should be named SocketGenericParser just to be consistent.\n. [Character] is the style I like to use\n. There's no need to break this out. ws?.writeString(msg) won't crash if ws is nil\n. I actually prefer using if let\n. Is there a reason you're removing the weak self? Generally when you dispatch async you don't want to create a strong reference\n. I would keep this weak, there's no need to keep a strong reference.\n. Don't use assert\n. Again, I don't think it's good to keep strong references like this\n. There's no reason this should change to a strong reference\n. Should be a weak this\n. weak self is fine here\n. There's not really a reason for this to be strong. \n. Should be weak self\n. Should be weak self\n. Should be weak self\n. Should be weak self\n. Should be weak self\n. Indentation is a little wonky in this file\n. I believe these weak references are on purpose, otherwise there's a case where the WebSocket won't be released.\n. I'm also against unsigned types. Just use checks or treat negatives as 0\n. Is the optimization really worth it? I'd prefer to keep as is, unless you've determined this is a bottleneck\n. Also thanks, I keep finding places where I've forgotten to remove the old style.\n. Forgot to remove it.\n. You shouldn't need type declarations here. \nswift\nlet handler = SocketEventHandler(event: event) {data, ack in\nShould be fine\n. Shouldn't this be a weak reference?\n. Seems to be a build error here\n. I'm talking about referencing self.handlers inside of this entire block\n. Why is this needed?\n. This messes up the syntax highlighting.\n. Same here\n. It's needed because in Swift switches must be exhaustive. And because we don't care about every option possible here, we need a default.\n. It's some black magic reflection to the value regardless of the case.\n. Yes\n. Yeah\n. It's required by hashable\n. Yeah\n. Opposed to what? I don't see a case where you'd have multiple items for the same option.\n. Valid point\n. The NSURLSessionDelegate could also be the SocketEngineClient\n. If someone wanted to build off the engine.\n. Are you sure that's valid? \nswift\ncase (\"connectParams\", let params) where params is [String: AnyObject]:\n    return .ConnectParams(params) // still wants to cast\n. Also this option really doesn't make sense anymore. Maybe I'm not understanding how socket.io-client is supposed to handle reconnects (the protocol is kinda sketchy,) but it seems that it should always get a new sid on reconnect. So this option would only be good if there's some bug in the engine after a reconnect attempt, and you want to have a new engine every time.\n. semicolons are bad\n. This should probably be a computed property rather than a method.\nswift\npublic var isRequired: Bool {\n    return ackNum != -1\n}\nBut to take a step back. I don't remember required acks being a thing. Were they recently added?\n. Should still be a computed property. \n. Can we just put the signal right after the remove?. Can we put the signal right after the remove?. Mutate what? If you can find some source for that. Because that would be incredibly surprising. I'm thinking about rewriting the queue system anyway, there are way too many of them.. Thanks. Yeah that makes me want to redo the queue structure for the entire client even more. Rather than having like 3 or 4 queues per entity, just have 1 or 2. . But this looks good until that is done.. I'd rather avoid KVO. I'm not a fan of it.. swift\nws?.delegate = nil. swift\nengine?.client = nil. engineDidSendPing. engineDidReceivePong. This should have better logging info.  This should also be log, not error.. This should have better logging info. This should also be log, not error.. Instead of an empty string, can you log something like \"Sent Ping\"?. The data array can be empty, empty string doesn't mean anything.. The data array can be empty, empty string doesn't mean anything.. Instead of an empty string, can you log something like \"Received Pong\"?. This was one of the custom changes I have to make to Starscream I believe.. This'll need docstrings eventually. . How about a !.isEmpty?. Or maybe move that check into flush... as a guard and unconditionally call it?. I'm fine with this way in that case! Would you mind also adding some documentation comments to these methods that explain this failure case? I think those will be helpful when I come back in 6 months and try to refactor and end up breaking it again :).. You can condense this line and the one above, right?. nit: nix the space. You shouldn't need to put completion in the capture list.. One last thing, does it make sense to also add a nicer Swift version of this that uses variadics? I think it should be possible to define\nswift\nopen func emit(_ event: String, _ items: SocketData..., completion: () -> ())  { /* call to base version like the other methods */ }. This needs to do the transformation from SocketData to something representable in JSON. See the other swift-centric methods.. If this is notifying when switching transports, it should be named something websocketUpgrade and the payload documented.. I think this one can stay non-nil right? If you're calling this method then you're explicitly wanting to use the callback feature.. Have you verified this with unicode characters and socket.io 1.0?. I think you might need more checks here. Does this compile for tvOS/macOS targets?. You should be able to specify multiple things here. #available(iOS 11.0, macOS 10.13, *). ",
    "Katafalkas": "How come ? Do you have a link to that information ? Cant seem to find it.\n. \n\n```\nFrom Xcode 6.3 beta 3 release notes:\n\nutf16Count is removed from String. Instead use count on the UTF16 view of the String. (17627758)\n```\n\n@hanishabsigh @nuclearace \n. as I understand currently pods are enabled only for 1.2 branch, right ? if so - whats the harm of changing podspces just for 1.2 branch ? Or what am I missing ?\n. @nuclearace connectWithParams was what I was looking for. The error was on my side, messed up jwt signatures. \n. Cheers ! This will work for me, altho it might be a problem for someone who has multiple handlers for the same event, and want to remove a specific handler.\n. ",
    "banjun": "Yes, CocoaPods does not support Swift pods on iOS 7.\nWhile theoretically we can make a swift library hybrid for both as a submodule and as a pod, I understand that it may need some more work to maintain.\nAnyway, I rebased on Starscream commits. this should work with both CocoaPods and submodule.\nhttps://github.com/banjun/socket.io-client-swift/tree/cocoapods-starscream\nI think this PR 4 may be closed because this conflicts with the current master.\n. I'll rebase and open another one without the example. Thanks!\n. pod trunk push validation may fail with this podspec like below..., as v1.1.0 tag does not contain LICENSE file.\n-> Socket.IO-Client-Swift (1.1.0)\n    - WARN  | [iOS] Unable to find a license file\nin the case, please tag after the merge commit and modify podspec's s.source line.\nfor example, :tag => 'v1.1.0' -> :tag => 'v1.1.0-pod'\n. @nuclearace thank you for merging! :+1: \nI confirmed we can now pod search socket.io, pod install with pod 'Socket.IO-Client-Swift', and add s.dependency 'Socket.IO-Client-Swift', '~> 1.1' to another pod!\n. :+1: 2.0.2 works correctly. Thanks!\n. When you use CocoaPods, socket.io will be compiled to a module (framework). This import seems to work, although I have not used from Objective-C.\n```\nimport \n``\n. @nuclearace Asnameis the key for your pod, usemodule_name` to change its framework name.\nsee for example:\nhttps://github.com/banjun/ikemen/blob/1765b23b900dcf279b4263361bb4026e8605a0bb/\u203bikemen.podspec\n. ",
    "jamesalopez": "I grabbed latest and it looks like you fixed this issue yesterday. Great work!\n. ",
    "hanishabsigh": "My object that fails is very large, here is an example I was able to track down:\nThe following fails:\n\"42[\\\"auto\\\",{\\\"message_of_the_date\\\":\\\"line one\\nline two\\\"}]\"\nThe following succeeds:\n\"42[\\\"auto\\\",{\\\"message_of_the_date\\\":\\\"line one line two\\\"}]\"\nThe line break in the message of the day causes the parsing of the groups to break.\n. @nuclearace I just noticed you made some parsing changes, this was tested prior to those changes, thanks\n. @nuclearace This still isn't working for me, incoming messages can't even get passed the following line: https://github.com/socketio/socket.io-client-swift/blob/e932d0a26ba81573545ca055660dcb41e277e0fe/SwiftIO/SocketParser.swift#L224\nReplacing line 224 with the following worked:\nlet messageGroups = stringMessage[\"(\\\\d*)\\\\/?(\\\\w*)?,?(\\\\d*)?\\\\[\\\"(.*?)\\\",?(.*?)?\\\\]$\", NSRegularExpressionOptions.DotMatchesLineSeparators].groups()\n. @nuclearace Checking against the latest commit isn't working, something about the changes in SwiftRegex. So far from what I can tell regex.firstMatchInString in the groups method isn't returning anything. Still investigating. Thanks\n. Ok, fixed it by changing the following:\nfinal var targetRange: NSRange {\n    return NSRange(location: 0,length: countElements(target))\n}\nTo this:\nfinal var targetRange: NSRange {\n    return NSRange(location: 0,length: target.utf16Count)\n}\nI think the error I was experiencing was happening because my json had variable-width Unicode characters. Found someone having the same issues with swift on StackOverflow: http://stackoverflow.com/questions/25882503/how-can-i-use-nsregularexpression-on-swift-strings-with-variable-width-unicode-c\n. @nuclearace Yes, that commit fixes it, thanks.\n. Yes, I wasn't receiving an ack for some of my messages because the first regex was outputting some sort of groups. Plus, this seems more efficient.\n. Been debugging this for a few hours. I'm seeing significant memory growth when emitting events quickly. Been hard to figure where this is happening and instruments hasn't detected any leaks. Has anybody made any progress since August?\n. @lucianocn @ninehundredt have you guys made any progress on this?\n. I'm seeing this issue as well. We initially thought it might have something to do with unicode characters in our packets. We are debugging it now with our server team but haven't made much progress. It is occurring on an iPhone 5 running 8.1.3.\n. I'm still seeing this when compiling with Swift 2.0 and running on a 32-bit device.\n. @nuclearace That works, thanks for the quick response!\n. @nuclearace Can you tag a new release and bump the podspec when you get a chance? Thanks!\n. It was happening because I wasn't giving log a value. The only other difference you had was setting the class to private, but that didn't make any difference. I think that is a very odd error... but it works now, thanks!\n. ",
    "bjonica": "pod 'Socket.IO-Client-Swift', :git => 'https://github.com/socketio/socket.io-client-swift.git', :branch => '1.2'\n. ",
    "chirag04": "@nuclearace can these params be set in the header instead of querystring or both.\nThe server looks at the cookie in the header for authentication. \nios client can pass the cookie using this method if you send these params in the header.\n. @nuclearace ab77d7260e3f8647ffbac9905a9e22ab8633c4b8 worked like a charm. \nCan you merge it in the master with some documentation around it?\n. Yes authentication is done in first handshake. Some like this:\nio.use(function(socket, next) {\n     if(false) return next(err);\n});\nI can send you the stack trace in some time.\n. sweet. I will test it and let you know.\n. ",
    "khanhankkhan": "what replaces 'connectWithParams' on the newest version of socket io for swift 1.2 client ??\n. How are you connecting? Are you connecting to just an IP and port? Or are you connecting with additional parameters as well, such as \"host:1234/?something=token\" ?\n. Is 'connectParams' not the second input (a dictionary) to the SocketIOClient constructor ?\nsocketIO = SocketIOClient(socketURL: URLString, opts:[\"token\" : escapedToken])\nThe Server side is using '1.3.5'\nSocketIOClient does not have a member named 'connectParams'\nsocketIO?.connectParams = [\"token\" : escapedToken]\nIs there a way for me to set the 'headers' from the SocketIOClient constructor as an alternative? I've tried:\nsocketIO = SocketIOClient(socketURL: URLString, opts:[\"token\" : escapedToken])\nsocketIO?.engine = SocketEngine(client: socketIO!, opts:[\"token\" : escapedToken])\nsocketIO?.engine?.ws = WebSocket(url:NSURL(string:URLString)!)\nsocketIO?.engine?.ws?.headers = [\"token\" : escapedToken]\nBut on the fails to connect callback I get \ntimed out trying to connect opts: Optional([\"token\": .....]) headers?Optional([:])\n. ",
    "guy-a": "connectWithParams was only sending params on re-connect, for me.\nconnectParams works great!\nThanx\n. ",
    "Ulianko": "Yes, no events at all\n. But Im not disconnected. I also didnt received disconnect callback. \n. Yes I have it there. Also some debug NSLogs\n2015-03-18 22:48:49.915 CallMe[71146:3725427] Engine got message: 40\ngot event: connect with items nil\nsocket connected\n2015-03-18 22:48:58.380 CallMe[71146:3725392] Engine got message: 3probe\n2015-03-18 22:48:58.483 CallMe[71146:3725427] Engine got message: 6\n2015-03-18 22:48:58.570 CallMe[71146:3725408] Engine got message: 41\n2015-03-18 22:48:58.572 CallMe[71146:3725408] Error parsing message: 1\n2015-03-18 22:49:14.913 CallMe[71146:3725408] Engine got message: 3\n. Ok so server tell me disconnect but lib cant parse it and disconnect socket ?\n. Ok, thanks \n. Youre right, problem is with entering background state. When I close it from running application there is no problem. But Ive tried your solution with background task, but nothing changed.\n. Okay Ive spent some hours with this and it turns out that it has problems with closing socket in background. Forget about closing it in didEnterBackground .. Ive made simple call from one of my screens and when I calling it from main queue it is working perfectly .. when I call it from dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{\nits not working stable\n. Will you look at this bug ?\n. Hi, Ive just found the problem. I think socket engine is deallocated before this happend SocketLogger.log(\"Writing poll: %@ has data: %@\", client: this,\n                        args: msg, data == nil ? false : true)\n                    this.sendPollMessage(msg, withType: type, datas: data)\nWhen I commented out line 160 (SocketIOClient.swift): engine = nil ... it works well also from background task...\nI think its not nessesery because engine will be deallocated when client will be deallocated.\n. Should I make pull request ?\n. thank you\n. ",
    "amincheloh": "i found problem when connect with netty-socketio it said\nclient did not complete upgrade - closing transport\n. ",
    "MobileDev418": "Is there support for join event on a client?. same problem.\nOn my client.js file is working fine. here is an example.\nsocket.on('messagehistory', function (messages) {\n    console.log(messages);\n});\nBut on my swift side, I can't get anything.\nsocket.on(\"messagehistory\") { messages, ack in\n    print(messages)\n});\nI did connect the socket server successfully. here is my connection code...\nsocket.on(\"connect\") { data, ack in\n    self.socket.emit(\"authentication\", access_token)\n    self.socket.on(\"authenticated\"){ data, ack in\n        print(\"authenticated success\")\n        self.socket.emit(\"join\", room)\n    }\n}\nsocket.on('messagehistory', function (messages) {\n    console.log(messages);\n});\nsocket.connect()\nPlease give me advice.. Same Problem, I am using v13.3.0 for swift.\nhere is my code.\nlet manager = SocketManager(socketURL: URL(string: \"http://chat.server.com:80/chatroom\")!, config: [.forceWebsockets(true)])\nlet socket = manager.defaultSocket\nroomId = \"testroom\"\nsocket.on(\"connect\") { data, ack in\n               self.socket.emit(\"authentication\", token)\n               self.socket.on(\"authenticated\"){ data, ack in\n                                   self.socket.emit(\"join\", self.roomId)\n               }\n}\nAfter authentication successed, join event not working.\n2018-10-07 04:53:05.118524+0800 [2534:320512] LOG SocketEngine: Got message: 0{\"sid\":\"gPAyoWxmuZ0fHsbvAAAI\",\"upgrades\":[],\"pingInterval\":25000,\"pingTimeout\":5000}\n2018-10-07 04:53:05.120676+0800 [2534:320357] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-10-07 04:53:05.120704+0800 [2534:320512] LOG SocketEngine: Got message: 40\ngot event: ping with items Optional([])\n2018-10-07 04:53:05.121112+0800 [2534:320512] LOG SocketEngine: Writing ws:  has data: false\n2018-10-07 04:53:05.121272+0800 2534:320512] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2018-10-07 04:53:05.121280+0800 [2534:320357] LOG SocketManager: Engine opened Connect\n2018-10-07 04:53:05.121647+0800 [2534:320357] LOG SocketIOClient{/}: Socket connected\n2018-10-07 04:53:05.121851+0800 [2534:320357] LOG SocketIOClient{/}: Handling event: statusChange with data: [connected]\ngot event: statusChange with items Optional([connected])\n2018-10-07 04:53:05.122398+0800 [2534:320357] LOG SocketIOClient{/}: Handling event: connect with data: [\"/\"]\ngot event: connect with items Optional([\"/\"])\nsocket connected\n2018-10-07 04:53:05.124503+0800 [2534:320357] LOG SocketIOClient{/}: Emitting: 2[\"authentication\",{\"access_token\":\"yVzHVY3w3xK1xks8vQPkLpkO6wbkexvGc4vx1i1no4u7g8yzli4rDdeP8A9VGVBRJtKAllb6TYbiXFOUIHz6wZowjyObWj9PM\"}\n2018-10-07 04:53:05.126258+0800 [2534:320357] LOG SocketIOClient{/}: Adding handler for event: authenticated\nnsp : /\n2018-10-07 04:53:05.126851+0800 [2534:320357] LOG SocketParser: Parsing 0\n2018-10-07 04:53:05.128025+0800 [2534:320357] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2018-10-07 04:53:05.130454+0800 [2534:320512] LOG SocketEngineWebSocket: Sending ws: 2[\"authentication\",{\"access_token\":\"yVzHVY3w3xK1xks8vQPkLpkO6wbkexvGc4vx1i1no4u7g8yzli4rDdeP8A9VGVBRJtKAllb6TYbiXFOUIHz6wZowjyObWj9PM\"}\n2018-10-07 04:53:05.408410+0800 [2534:320530] LOG SocketEngine: Got message: 3\n2018-10-07 04:53:05.408946+0800 [2534:320357] LOG SocketIOClient{/}: Handling event: pong with data: []\ngot event: pong with items Optional([])\n2018-10-07 04:53:06.036717+0800 [2534:320512] LOG SocketEngine: Got message: 42[\"authenticated\",true]\n2018-10-07 04:53:06.037383+0800 [2534:320357] LOG SocketParser: Parsing 2[\"authenticated\",true]\n2018-10-07 04:53:06.039344+0800 [2534:320357] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [authenticated, 1]; id: -1; placeholders: -1; nsp: /}\n2018-10-07 04:53:06.040202+0800 [2534:320357] LOG SocketIOClient{/}: Handling event: authenticated with data: [1]\ngot event: authenticated with items Optional([1])\nreceive authenticated event\n2018-10-07 04:53:06.041081+0800 [2534:320357] LOG SocketIOClient{/}: Emitting: 2[\"join\",\"testroom\"], Ack: false\n2018-10-07 04:53:06.041788+0800 [2534:320512] LOG SocketEngine: Writing ws: 2[\"join\",\"testroom\"] has data: false\n2018-10-07 04:53:06.041966+0800 [2534:320512] LOG SocketEngineWebSocket: Sending ws: 2[\"join\",\"testroom\"] as type: 4\n2018-10-07 04:53:31.810296+0800 [2534:320357] LOG SocketIOClient{/}: Handling event: ping with data: []\ngot event: ping with items Optional([])\n2018-10-07 04:53:31.810951+0800 [2534:320545] LOG SocketEngine: Writing ws:  has data: false\n2018-10-07 04:53:31.811117+0800 [2534:320545] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2018-10-07 04:53:32.112808+0800 [2534:320545] LOG SocketEngine: Got message: 3\n2018-10-07 04:53:32.113341+0800 [2534:320357] LOG SocketIOClient{/}: Handling event: pong with data: []\nhope good news. :). ",
    "abo": "how can i emit { hello: 'world' } in objective-c , not [{ hello: 'world' }] , \n. ",
    "justinmakaila": "Also added a new v1.4.2 tag\n. Carthage requires a Run Script build phase to strip x86 symbols when submitting to the App Store, but needs nothing extra committed to the repo. You can read more here.\nBy OS X support, I meant there's now an OS X target, which Carthage uses to build, and technically, a library does not support Carthage unless it builds for iOS and OSX. \n. I did the work for you. I respect if you don\u2019t want to pull it, as I\u2019ll just use my own fork. But the option is there.\n\u2014Justin Makaila\nOn Thu, Mar 26, 2015 at 1:31 PM, Erik Little notifications@github.com\nwrote:\n\n\nCarthage will only build Xcode schemes that are shared from your .xcodeproj\nI really don't want to include a whole .xcodeproj. I hate that kind of thing in a github repo. I'd rather stick to CocoaPods and/or git.\ntl;dr: I hate Xcode dependency managers.\nReply to this email directly or view it on GitHub:\nhttps://github.com/socketio/socket.io-client-swift/pull/28#issuecomment-86634703\n. All it is is an added Xcode project which wraps the files so they can be built as a .framework.\u00a0\n\n\n\u2014Justin Makaila\nOn Thu, Mar 26, 2015 at 1:35 PM, Erik Little notifications@github.com\nwrote:\n\nI'd add it, the problem is I don't really know enough about it so that if someone says it's broken, how I'd go about fixing it.\nReply to this email directly or view it on GitHub:\nhttps://github.com/socketio/socket.io-client-swift/pull/28#issuecomment-86637570\n. Word, I\u2019ll get that in a bit and comment back here when it\u2019s done.\n\n\u2014Justin Makaila\nOn Thu, Mar 26, 2015 at 1:39 PM, Erik Little notifications@github.com\nwrote:\n\nIf you can merge the latest master, I'll merge your branch.\nReply to this email directly or view it on GitHub:\nhttps://github.com/socketio/socket.io-client-swift/pull/28#issuecomment-86638805\n. Carthage is nothing but a fancy CLI for wrapping the xcodebuild tools to checkout and build all of your dependencies.\n\n\u2014Justin Makaila\nOn Thu, Mar 26, 2015 at 1:41 PM, Erik Little notifications@github.com\nwrote:\n\nDoes carthage support 1.2\nReply to this email directly or view it on GitHub:\nhttps://github.com/socketio/socket.io-client-swift/pull/28#issuecomment-86639469\n. Merged in master and began updating some documentation and Swift style stuff. I'll continue adding documentation and style guide conformance over time to my fork, but this is ready to go to get carthage in.\n\nCarthage is supported for releases >= v2.0.2\n. I find that extremely difficult to read. Especially with the lack of whitespace.\n\u2014Justin Makaila\nOn Thu, Apr 9, 2015 at 1:29 PM, Erik Little notifications@github.com\nwrote:\n\nCool, I'll look into this later today. Just some style things that trigger me, but I can change back.\nWhile the style Apple uses is\nswift\nvar variable: Type\nI generally don't like this. Because : is used a bunch, I prefer to only use a space after : when it's used in a function call, not type declaration.\nReply to this email directly or view it on GitHub:\nhttps://github.com/socketio/socket.io-client-swift/pull/28#issuecomment-91301845\n. I recommend setting up a new project, going through CocoaPods integration, and then going through Carthage integration.\n\nThe benefits, IMO, are obvious. Everything will live inside of it\u2019s own namespace and framework, so you can import SocketIO rather than having everything live in the global namespace. Even if users don\u2019t use carthage, they can still open up the .xcodeproj, build the project, and then drop that .framework into their project.\nI\u2019m not a fan of dropping tons of .swift files into my project.\nI also believe, being the main SocketIO repository, you\u2019d be doing a disservice to the entire iOS development community by rejecting a pull request which adds support for one of the main dependency managers based on personal bias.\u00a0\nEDIT\nRemoved email stuff\n. Yes, yes I do :+1:. However, if we\u2019re talking about that last comment, that was my email client.\n\u2014Justin Makaila\nOn Thu, Apr 9, 2015 at 3:16 PM, Xaekai notifications@github.com wrote:\n\nYou sure do love your whitespace.\nReply to this email directly or view it on GitHub:\nhttps://github.com/socketio/socket.io-client-swift/pull/28#issuecomment-91332039\n. You don't have to do anything. If you do, personally mention be, because at this rate, I'll be maintaining my own fork.\n\n\u2014Justin Makaila\nOn Thu, Apr 9, 2015 at 7:59 PM, Erik Little notifications@github.com\nwrote:\n\nSince it makes use of Xcode schemas.\nReply to this email directly or view it on GitHub:\nhttps://github.com/socketio/socket.io-client-swift/pull/28#issuecomment-91384073\n. Here's another link to the Carthage repo: http://github.com/Carthage/Carthage. You can find everything you want to know there.\n\n\u2014Justin Makaila\nOn Thu, Apr 9, 2015 at 7:58 PM, Erik Little notifications@github.com\nwrote:\n\nThe problem is once this is merged, I don't really want to keep up with another dependency manager. And I don't even know how I would keep the carthage one updated\nReply to this email directly or view it on GitHub:\nhttps://github.com/socketio/socket.io-client-swift/pull/28#issuecomment-91383961\n. They work, otherwise I wouldn\u2019t have made the pull request. I\u2019m currently using them, built by Carthage, in a production app.\n\n\u2014Justin Makaila\nOn Thu, Apr 9, 2015 at 9:01 PM, Erik Little notifications@github.com\nwrote:\n\nI tested to see it would build frameworks. Didn't test if they actually work. I've had difficulties with dynamic frameworks in the past\nReply to this email directly or view it on GitHub:\nhttps://github.com/socketio/socket.io-client-swift/pull/28#issuecomment-91392050\n. I'll check it out tomorrow\n\n\u2014Justin Makaila\nOn Fri, Apr 10, 2015 at 12:11 AM, Erik Little notifications@github.com\nwrote:\n\nLet me know @justinmakaila if this still works.\nReply to this email directly or view it on GitHub:\nhttps://github.com/socketio/socket.io-client-swift/pull/50#issuecomment-91423871\n. Tons of conflicts and the OS X build fails because it can't find the umbrella header SocketIO.h. Did you rename it? Also, what was the motive behind renaming the SocketIO directory to SocketIOClientSwift?\n. git conflicts. I'm gonna run through this in a bit. I may just manage my own fork.\n. \n",
    "Xaekai": "You sure do love your whitespace.\n. ",
    "gtennis": "It happens quite randomly and crashes in different places. Therefore I created 3 different issues.\n. It happens quite randomly and crashes in different places. Therefore I created 3 different issues.\n. It happens quite randomly and crashes in different places. Therefore I created 3 different issues.\n. ",
    "ashokrkm": "Thanks that fixed it.\n. OK Thanks, this worked:\n[socket emitObjc:@\"add-user\" withItems:@[ @{@\"username\":@\"user1\", @\"key\":@\"key1\"} ] ];\n. sure, i can. is there a way to send a private message to you?\n. yes it works with javascript and also works with https://github.com/pkyeck/socket.IO-objc correctly\n. sent.\n. i have turned off the proxy buffering off\nif i connect using  https://github.com/pkyeck/socket.IO-objc\nit works fine without any race condition and connects only once.\nnginx config\n```\n    location /socket.io {\n        proxy_pass http://XXXX:5000/socket.io;\n        proxy_redirect off;\n        proxy_buffering off;\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"Upgrade\";\n}\n\n```\n. OK great. thanks.\nit is a really basic setup.\nhere is the complete nginx server config, just proxies to socket.io running on port 5000 in localhost. if you want to try from your local machine anytime.\n```\n    worker_processes  auto;\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    server {\n        listen       80;\n        location /socket.io {\n            proxy_pass http://localhost:5000/socket.io;\n            proxy_redirect off;\n            proxy_buffering off;\n\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\n            proxy_http_version 1.1;\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection \"Upgrade\";\n        }\n    }\n}\n\n```\n. thanks for the patch, it seems to be better, connections come to node instance only once.\nBut nginx still gets multiple requests. Is this OK? \n```\n   ==> node.log <==\n   Sat Mar 28 2015 16:14:00 GMT-0700 (PDT): connected        CDdF50Bmvmqb3kxBAAL1\n   Sat Mar 28 2015 16:14:00 GMT-0700 (PDT): added tEPn 1 clients now        connected\n==> /opt/local/logs/access_kwik.log <==\n   10.0.1.22 - - [28/Mar/2015:16:13:59 -0700] \"GET /socket.io/?transport=polling&b64=1 HTTP/1.1\" 200 100 \"-\" \"kwik/1 CFNetwork/711.2.23 Darwin/14.0.0\"\n   10.0.1.22 - - [28/Mar/2015:16:14:00 -0700] \"GET /socket.io/?transport=polling&sid=CDdF50Bmvmqb3kxBAAL1&b64=1 HTTP/1.1\" 200 4 \"-\" \"kwik/1 CFNetwork/711.2.23 Darwin/14.0.0\"\n   10.0.1.22 - - [28/Mar/2015:16:14:00 -0700] \"POST /socket.io/?transport=polling&sid=CDdF50Bmvmqb3kxBAAL1 HTTP/1.1\" 200 2 \"-\" \"kwik/1 CFNetwork/711.2.23 Darwin/14.0.0\"\n   10.0.1.22 - - [28/Mar/2015:16:14:00 -0700] \"GET /socket.io/?transport=polling&sid=CDdF50Bmvmqb3kxBAAL1&b64=1 HTTP/1.1\" 200 15 \"-\" \"kwik/1 CFNetwork/711.2.23 Darwin/14.0.0\"\n   10.0.1.22 - - [28/Mar/2015:16:14:00 -0700] \"POST /socket.io/?transport=polling&sid=CDdF50Bmvmqb3kxBAAL1 HTTP/1.1\" 200 2 \"-\" \"kwik/1 CFNetwork/711.2.23 Darwin/14.0.0\"\n```\n. thanks for the fix! Objective-C was terrible, but once used to it, it is awesome!\nIf i have an event defined, and also have onAny, both are getting hit.\nThis is totally fine, but just want to make sure it is the expected behavior.\n[socket on:@\"data\" callback:^(NSArray* data, void (^ack)(   NSArray*)) {\n       NSLog(@\"data:%@\", data);\n   }];\n   [socket onAny:^(SocketAnyEvent* e) {\n       NSLog(@\"%@\", e.event);\n       NSLog(@\"%@\", e.items);\n   }];\nIn this case it hits both onAny, and also on - both get executed.\n. great thanks works well!\n. Awesome!\n. For now blocks are working fine and not missing anything.\n. Don't have any inputs to make it better, works great as of now.\n. ",
    "ripitrust": "yeah \nthis is correct \nthanks\n. ",
    "trungnguyen1791": "I can't find \"SocketAnyEvent\" after using pods? Maybe u missing something here \n. ",
    "pwnsdx": "Hello,\nYes my server is running on port 80. I do not use nginx but Express.\nThanks.\n\nLe 31 mars 2015 \u00e0 20:14, Erik Little notifications@github.com a \u00e9crit :\nAlso I note that your socketURL doesn't specify a port. Is your socket.io server running on port 80? I've had people complain about running socket.io behind nginx.\n\u2014\nReply to this email directly or view it on GitHub.\n. Very strange :/\n\nWith my code?\n\nLe 1 avr. 2015 \u00e0 04:07, Erik Little notifications@github.com a \u00e9crit :\nHm, I seem to be able to connect to a socket.io server on port 80 fine\n\u2014\nReply to this email directly or view it on GitHub.\n. Oh, interesting as I still don\u2019t know how to fix that :/\nOn 29 Apr 2015, at 07:32, tzapu notifications@github.com wrote:\nhi,\ni am also having the same problem, no messages at all, not even \"connected\"\nusing example tic tac toe server, swify project works fine, objc project does nothing. node server sees the connection and issues 'adding player'\ncheers\nSocketIOClient* socket = [[SocketIOClient alloc] initWithSocketURL:@\"http://localhost:8900\" options:nil];\n    NSLog(@\"before connect\");\n    [socket on: @\"connect\" callback: ^(NSArray* data, void (^ack)(NSArray_)) {\n        NSLog(@\"connected\");\n        //[socket emitObjc:@\"echo\" withItems:@[@\"echo test\"]];\n        //[[socket emitWithAckObjc:@\"ackack\" withItems:@[@\"test\"]] onAck:0 withCallback:^(NSArray_ data) {\n            NSLog(@\"Got data\");\n        //}];\n    }];\n```\n[socket onAny:^(SocketAnyEvent* e) {\n    NSLog(e.event);\n    NSLog(@\"%@\", e.items);\n}];\n[socket connect];\n```\n\u2014\nReply to this email directly or view it on GitHub https://github.com/socketio/socket.io-client-swift/issues/39#issuecomment-97311184.\n. \n",
    "tzapu": "hi,\ni am also having the same problem, no messages at all, not even \"connected\"\nusing example tic tac toe server, swify project works fine, objc project does nothing. node server sees the connection and issues 'adding player'\ncheers\n```\nSocketIOClient socket = [[SocketIOClient alloc] initWithSocketURL:@\"http://localhost:8900\" options:nil];\n    NSLog(@\"before connect\");\n    [socket on: @\"connect\" callback: ^(NSArray data, void (^ack)(NSArray)) {\n        NSLog(@\"connected\");\n        //[socket emitObjc:@\"echo\" withItems:@[@\"echo test\"]];\n        //[[socket emitWithAckObjc:@\"ackack\" withItems:@[@\"test\"]] onAck:0 withCallback:^(NSArray data) {\n            NSLog(@\"Got data\");\n        //}];\n    }];\n[socket onAny:^(SocketAnyEvent* e) {\n    NSLog(e.event);\n    NSLog(@\"%@\", e.items);\n}];\n\n[socket connect];\n\n```\n. oh boy, i feel so silly, you are completely correct. i am declaring the socket now as a global @property and am getting events fine.\nthank you very much\n. ",
    "k7": "we should use var opts = [\"nsp\": \"/chat\"]\nor else the socket.io server will give no socket for namespace undefined\n``` javascript\nClient.prototype.ondecoded = function(packet) {\n  if (parser.CONNECT == packet.type) {\n    this.connect(packet.nsp);\n  } else {\n    var socket = this.nsps[packet.nsp];\n    if (socket) {\n      socket.onpacket(packet);\n    } else {\n      debug('no socket for namespace %s', packet.nsp);\n    }\n  }\n};\n```\nps: I have updated the latest repo code.\n. Now I know why. \nI have sent the wrong args in emit and the server parser error\nin client  \nswift\nself.socket.emit(\"authentication\", \"{\\\"token\\\":\\\"\\(token)\\\"}\")\nin server\n``` javascript\n// socket.io-parser \n// index.js\nfunction decodeString(str) {\n...\n  // look up json data\n  if (str.charAt(++i)) {\n    try {\n      var a = str.substr(i)\n      p.data = json.parse(a);\n    } catch(e){\n      return error();\n    }\n  }\n...\n}\n```\n. thank you.\n. ",
    "CallumOz": "I am working on an application that communicates with Let's Chat\nThe events that I have the problems with are \"account:whoami\" and \"rooms:list\".\nI am using the latest Cocoapod version 1.4.4\n. Yes these emitWithAcks are sent in the callback:\n```\nself.socket.on(\"connect\") { [weak self] data, ack in\n        ...\n}\n```\n. ",
    "ahallora": "Thanks for a quick reply - I will look into it and report my findings. :smile: \nI know less swift than objective-c so I have my work cut out for me. :smile: \n. Awesome, it works! Thank you so much! :+1: :smiley: \n. ",
    "pmanijak": "Your questions are reasonable. I admit this issue does appear ridiculous upon first glance. Please allow me to elaborate:\n1. Yes, the library itself is causing the problem. Removing the import statement causes the build to succeed.\n2. Yes, the test code is silly, and the loop would never execute. Here is the point: The only interaction this code has with the library is that this code is in the same project as the \"import Socket_IO_Client_Swift\" statement. This code could be in a different file, and the compile error still occurs. \nHowever, to satisfy your question: Imagine I have a json object represented somewhere in my Swift code. That json could be something like this:\njavascript\n{\n    \"things\": [{\n        \"foo\": 1\n    },{\n        \"foo\": 2\n    }]\n}\nIn Swift I could then do something like:\nswift\nif let json = NSJSONSerialization.JSONObjectWithData(...) as? NSDictionary {\n  if let array = json[\"things\"] as? NSArray {\n    for thing in array {\n      let foo = thing[\"foo\"]\n      // Do something with foo\n    }\n  }\n}\nI also agree that Swift 1.2 is the future. Perhaps we've discovered an issue with the Apple compiler.\n. I'm downloading Xcode 6.3 now to test it with that. I'll continue investigating.\n. This works fine with Xcode 6.3 and version 2.0.2 of this library. \n. ",
    "ramki982": "Thanks a bunch\n. Done @nuclearace - i have created a pull request.Let me know your thoughts\n. oh ok great thanks\n. Thanks Erik\nOn Friday 17 April 2015, Erik Little notifications@github.com wrote:\n\nClosed #54 https://github.com/socketio/socket.io-client-swift/issues/54.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/54#event-283851492\n.\n\n\nSent from Gmail Mobile\n. ",
    "Harigharan": "I am using XCode 6.2.\n. Thanks for the quick response. I will update my xcode to 6.3 and update you.\n. I updated the XCode Version to 6.3. compilation issues is fixed. thanks for the information..\n. ",
    "yannickl": "Yes you can retrieve parameters via the socket.handshake.query property in the connection callback.\nIf you want to use a middleware (e.g. for authentication) you will need to follow this one:\njavascript\nio.use(function (socket, next) {\n    var token = socket.request._query.token;\n    // ...\n    next();\n}\nIt works fine for me.\n. This is an iPad Wifi, I don't have the 3G/LTE.\nI forgot to mention I also set the reconnects to false and reconnectAttempts to 0.\nI don't have any events. So when I turn off my wifi the iPad didn't know that the connection is closed.\nMay be this is not a good idea to put the reconnects to false but I really need to know when the connection is closed or lost.\n. I will test it tomorrow with an iOS simulator on an another macbook to check whether it works. It seems that the Websocket class didn't notice about the connection lost. I need to go further with the investigation.\n. I can reproduce the issue with my iPhone and my iPad with this code:\nIn node.js:\n``` javascript\nvar options = {\n  pingTimeout: 3000,\n  pingInterval: 3000,\n  transports: ['websocket'],\n  allowUpgrades: false,\n  cookie: false\n};\nvar app = require('express')();\nvar server = require('http').Server(app);\nvar io = require('socket.io')(server, options);\nserver.listen(3000, function (err) {\n  console.log('server running...');\n});\nio.on('connection', function (socket) {\n  console.log('connected');\nsocket.on('disconnect', function () {\n    console.log('disconnected');\n  })\n});\n```\nIn swift (for iOS):\n``` swift\nimport UIKit\nimport Socket_IO_Client_Swift\nclass ViewController: UIViewController {\n  let socket  = SocketIOClient(socketURL: \"192.168.0.30:3000\", opts: [\n    \"reconnects\": false,\n    \"reconnectAttempts\": 0,\n    \"forceWebsockets\": true\n    ])\noverride func viewDidLoad() {\n    super.viewDidLoad()\nsocket.onAny { event in\n  println(\"Got event: \\(event.event), with items: \\(event.items)\")\n}\n\nsocket.connect()\n\n}\n}\n```\nHere is the workflow:\n1.  Run the server (app.js) on the macbook\n=> the server is running\n2.  Connect the client (swift)\n=> both the server and the client received a connected event\n3.  Turn off the wifi of the macbook\n=> after 3 seconds the server receive the disconnected event, but the swift client nothing...\n. Have you found the workaround? Or this is a problem from my code?\n. It's my bad, I just see your commit: https://github.com/socketio/socket.io-client-swift/commit/fcebc870c3f7af84bafcfa2370c15f9e9d2cb9e5\nThank you, I'm going to try it right now!\n. Here the client options:\nswift\nlet options = [\n   \"reconnects\": false,\n   \"reconnectAttempts\": 0,\n   \"log\": true,\n   \"connectParams\": params,\n   \"forceWebsockets\": true\n]\nThe server options:\njavascript\n  var options = {\n    pingTimeout: 3000,\n    pingInterval: 10000,\n    transports: ['websocket'],\n    allowUpgrades: true,\n    cookie: false\n  };\nThe problem occurred randomly, I can't reproduce it voluntary but it happens very often. \n. Here is an example of the parameters:\nswift\nlet params = [\n    \"created\": \"2015-09-21T19:31:33+0200\",\n    \"nonce\": \"W5TVkz7sxqUsY36KgekNQEVNt6LymyICgoUoTbh7ehQ=\",\n    \"passwordDigest\": \"M2NmMTFjMjMyNTY3NDIwOWE1NTA4MDhiZDc2NjRmMjM5ZmViNmFlOGJiZmNjOTUwZmRkNTg3Mzg3MzI0ODkwMA==\",\n    \"playerId\": -1,\n    \"role\": \"a\",\n    \"teamColor\": \"r\",\n    \"username\": \"a\"\n]\n. I didn't try yet with an \"empty\" server. I'm going to test with an empty one, but this is strange because it worked fine before with Swift 1.3 and the previous version of the client.\nIt seems to work with the simulator, but with my iPads (air iOS8.4 and iOS9, mini 2 iOS8.4 and iOS9) it works one time in five (it is an approximate ratio).\n. I just tried with an empty project (client and server side) and I have the same issue (but very, very rarely 1 time in 30-40). I tried with my iPhone 6 and I have the same issue.\nHere the client code:\n``` swift\nimport UIKit\nimport Socket_IO_Client_Swift\nclass ViewController: UIViewController {\n  let socket = SocketIOClient(socketURL: \"192.168.0.11:3000\", opts: [\n    \"log\": 1,\n    \"forceWebsockets\": 1,\n    \"reconnectAttempts\": 0,\n    \"reconnects\": 0,\n    \"connectParams\": [\n      \"created\": \"2015-09-21T21:27:01+0200\",\n      \"nonce\": \"ZEC+2jS0ZPU9HdJ5/JH41435dtN0dIVTorw/Xi2UAtQ=\",\n      \"passwordDigest\": \"N2E0NDQ1ZjJjMGJiYWE3YjI4OWE0OTZkOTg2Nzc2NzVkMzczZjM2MjMzODNiZjliODA1OWZmZDRhZTFjYjQzMg==\",\n      \"playerId\": 1,\n      \"role\": \"p\",\n      \"teamColor\": \"r\",\n      \"username\": 1\n    ]])\noverride func viewDidLoad() {\n    super.viewDidLoad()\nsocket.onAny { (event: SocketAnyEvent) -> Void in\n  print(\"Got event: \\(event.event), with items: \\(event.items)\")\n}\n\nsocket.connect()\n\n}\n}\n```\nThe server code:\n``` javascript\nvar app = require('http').createServer(handler)\nvar io = require('socket.io')(app);\nfunction handler (req, res) {\n  res.end();\n}\napp.listen(3000);\nio.on('connection', function (socket) {\n  console.log(\"connection\");\n});\n```\n. Do you have the same problem?\nI don't think the issue comes from the server because it works fine with the previous version. I don't hope it comes from the Swift compiler (I had this kind of issue in release mode with another library in swift 1.2). I'll investigate more deeply the code tomorrow.\n. Here you can find a server log (with the sample code I post before) when the issue occurred with the iPad:\nengine handshaking client \"7SoqEoiPqclvUN9yAAAG\" +15s\n  engine:socket sending packet \"open\" ({\"sid\":\"7SoqEoiPqclvUN9yAAAG\",\"upgrades\":[],\"pingInterval\":25000,\"pingTimeout\":60000}) +0ms\n  engine:socket flushing buffer to transport +1ms\n  engine:ws writing \"0{\"sid\":\"7SoqEoiPqclvUN9yAAAG\",\"upgrades\":[],\"pingInterval\":25000,\"pingTimeout\":60000}\" +0ms\n  engine:transport setting request +0ms\n  socket.io:server incoming connection with id 7SoqEoiPqclvUN9yAAAG +11s\n  socket.io:client connecting to namespace / +0ms\n  socket.io:namespace adding socket to nsp / +0ms\n  socket.io:socket socket connected - writing packet +0ms\n  socket.io:socket joining room 7SoqEoiPqclvUN9yAAAG +0ms\n  socket.io:client writing packet {\"type\":0,\"nsp\":\"/\"} +0ms\n  socket.io-parser encoding packet {\"type\":0,\"nsp\":\"/\"} +15s\n  socket.io-parser encoded {\"type\":0,\"nsp\":\"/\"} as 0 +0ms\n  engine:socket sending packet \"message\" (0) +0ms\n  engine:socket flushing buffer to transport +0ms\n  engine:ws writing \"40\" +0ms\nconnection\n  socket.io:socket joined room 7SoqEoiPqclvUN9yAAAG +1ms\n  socket.io:client client close with reason transport close +59ms\n  socket.io:socket closing socket - reason transport close +0ms\n  socket.io:client ignoring remove for 7SoqEoiPqclvUN9yAAAG +0ms\nThe server running on a Mac OSX 10.10.5.\n. Yes I know, that's strange, but it can help us to focus on the client side (I guess).\n. It seems to work now! I'll check in the next few days that nothing wrong happens. :+1: \n. Unfortunately the problem is still here... It seems happen less often but  I still have \"Invalid HTTP upgrade\" error.\n. The first tests are positives. I'll keep you in touch in the next few days. :+1: \n. Today I had no problem, so it seems to be ok now. Thank you!\n. Sorry I was out, I just added a test case to check that.\nThe problem can occur when you pass a serialised date for example:\nswift\n[\n    \"created\": \"2016-05-04T18:31:15+0200\"\n]\nThank you for the merge. \ud83d\udc4d \n. ",
    "hankbao": "Yep, the latest commit is OK now.\n. I've linked the iOS framework into my app and played it for a while. It's just fine. However I've not tested the OS X framework.\n. I encountered this issue on one of my iOS projects recently. I close the socket.io client with fast set to true when the app enters background and recreate another one when the app enters foreground and then connect to the server immediately. In the connect event callback, I need to send the client sid to the server. Normally the sid is there. However in some rare condition, it could be nil.\n. @nuclearace Could you merge the change onto carthage branch so that I can test it with my project? Thanks.\n. I've seen several related crash reports in previous version of my app. However current version contains the change has just been shipped. I shall feedback a few days later.\n. This is the callstack when crashing:\n* thread #8: tid = 0x111509, 0x0000000114424e08 libunwind.dylib`_Unwind_Resume + 27, queue = 'com.apple.root.default-qos', stop reason = EXC_BAD_ACCESS (code=1, address=0x10)\n    frame #0: 0x0000000114424e08 libunwind.dylib`_Unwind_Resume + 27\n    frame #1: 0x0000000113c75c74 libswiftCore.dylib`swift_unknownRetainUnowned + 388\n  * frame #2: 0x0000000113118c80 SocketIO`SocketIO.WebSocket.(weakSelf=0x00007f84eb306d80) -> () -> ()).(closure #2) + 80 at WebSocket.swift:144\n    frame #3: 0x00000001130e6e57 SocketIO`reabstraction thunk helper from @callee_owned () -> (@unowned ()) to @callee_unowned @convention(block) () -> (@unowned ()) + 39 at SocketEngine.swift:0\n    frame #4: 0x000000011410bfad libdispatch.dylib`_dispatch_call_block_and_release + 12\n    frame #5: 0x000000011412c4bb libdispatch.dylib`_dispatch_client_callout + 8\n    frame #6: 0x0000000114114d3f libdispatch.dylib`_dispatch_root_queue_drain + 1829\n    frame #7: 0x0000000114114615 libdispatch.dylib`_dispatch_worker_thread3 + 111\n    frame #8: 0x0000000114474a9d libsystem_pthread.dylib`_pthread_wqthread + 729\n    frame #9: 0x00000001144723dd libsystem_pthread.dylib`start_wqthread + 13\n. The weak remained in WebSocket.connect() method actually causes a nasty race condition problem. \nThe WebSocket instance within SocketEngine is released in createWebsocket but may still be accessed in a global concurrent queue in WebSocket.connect().\nlet weakSelf = self will try to unwrap and retain a deallocated object and eventually crashes the app.\n. @nuclearace There is a race condition in WebSocket.connect(). Please see my comment above.\nI would like to open an issue about that if you think that is appropriate.\n. @nuclearace IMO, the multithreads race condition in connect method is different from the use-after-release problem caused by a unowned object and that is not fixed by weak-referencing self. After turned on forceWebsocket, it's now easy to reproduce the problem on iOS 9 GM if you connect-close-connect quickly.\n. @nuclearace @lightsprint09 OK. But I'm quite busy currently and it's almost at midnight in China. I'd rather work on this issue tomorrow.\n. ",
    "naivefun": "set:\nsocket.nsp = \"namespace\" then connect\nBut how can I switch namespace?\n. ",
    "phwowcs": "This is my mistake, I declared 'socket'  in viewDidLoad() function so it was not working. \n. ",
    "danishin": "What I meant was to replace default path '/socket.io' by custom path. \nvar url = \"\\(self.client!.socketURL)\\(self.socketPath)/socket.io/?transport=\"\nself.socketPath should replace '/socket.io' here instead of inserting one before it.\nWhat can be done is to simply set '/socket.io' as default path if no custom path is specified since that's what server does.\n. something like\nif let path = opts![\"path\"] as? String { self.socketPath = path } \nelse { self.socketPath = '/socket.io'}\n. http://socket.io/docs/server-api/#server#path(v:string):server\nYou can refer to the link. It explains the 'path' option on server-side\n. That's because socket.io only looks at the first matching path and disregard the rest. So if you specified '/swift' as custom path in server, it will basically filter all '/swift/*' as socket.io bound http requests. And since other than the initial handshake, conventional url scheme has no significance in socket.io, it still is considered as valid connection and, therefore no error.\n'(URL)/swift/socket.io' is what is being generated with your code and socket.io server filters for '(URL)/swift/*'.\nIf you log out the incoming http requests on your server, you will see the trailing '/socket.io' path.\nWhile this isn't semantically significant, there is no reason to have this trailing path.\n. Also not retaining pointer caused compiler error for XCode6.3-beta unlike XCode6.3 GM. It is a good catch by compiler though I wonder why it was removed for GM..\n. Looks good to me! Thanks for your work\n. @nuclearace Is it restrictive as in not allowing WebSockets at all (afaik it seems to allow low-level TCP socket connection only?) or as in only allowing when the intention is sound like being used for signaling channel for voip functionality?\n. ",
    "Daniet": "hola\nno he podido conectarse al web socket especifico, al usar este codigo me sale error al compilar \n    let socket = SocketIOClient(socketURL: URL(string: \"http://172.20.2.73:5151\")!, option[\"path\":\"/swift\"], config: [.log(true), .forcePolling(true)])\n    . ",
    "Spandana-Gajangi": "How to add path to socket io where socketIo and node server runs on same port.\nlike node server runs on http://someurl:3000\nsocket should run on http://someurl:3000/socket. ",
    "digitalbrain": "thank you ;) \n. ",
    "obsobsobs": "But the documentation says:\nclose(#fast:Bool) - Closes the socket. Once a socket is closed it should not be reopened\n. ok thank you :D\n. because if you have an array of dictionaries, you have to cast them all too ... i spend 1 day to find a better solution, i came to NSJSONReadingOptions.MutableContainers\n. i m using Swift, i debugged every step and i saw that they are NSCFArray and NSCFDictionary\nif i cast them to a MutableDictionary... they won't work it crashes with: \n*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: '-[__NSCFDictionary setObject:forKey:]: mutating method sent to immutable object'\n. Thank you \n. you can download the iOS Library and the Simulators in xcode. \n. ok \ud83d\ude0a \nunder iOS. If you go into the background for ~2min (the app get suspended), i get eventCode == .HasSpaceAvailable.\n. ",
    "jlohiys": "\nI'm not sure the best way to handle going into the background. My suggestion would be to close the socket, and then readd it when you come back.\n\nwhen we come back, it wont give all the messages. Some messages are getting lost. ",
    "rfgallagher1": "Thanks, that's what I had, but since none of the Events in the documentation seemed to fit I assumed there was another way. Thanks!\n. ",
    "dhvlgolakiya": "Thanks, problem is solved. I can get event auth_success and others. But now, I can't emit any object string. If I pass nsdictionary in \"emit: withItems:\" , the object is send to server but, If I pass string than it is not reach to server. Also clent can receive data from server but can't send data to server on \"emit: withItems:\".\n. My message object is like:\nNSMutableDictionary *message = [[NSMutableDictionary alloc] init];`\n [message setObject:@\"senderId\" forKey:@\"from\"];\n [message setObject:@\"receiverId\" forKey:@\"to\"];\n [message setObject:@\"Testing\" forKey:@\"message\"];\n [message setObject:[NSNumber numberWithLongLong: 1430724348000 ] forKey:@\"messageSentTime\" ];\nI'm parsing it into JSON using SBJSON:\nSBJSON *jsonParser = [SBJSON new];\n  NSString* valueString =[jsonParser stringWithObject:message];\nI\"m emitting array of string like:\n[self.socket emit:@\"msg_10\" withItems:@[valueString]];\nwhere valuestring is JSON string like:\n{\"from\":\"senderId\",\"messageSentTime\":1430724348000,\"message\":\"Testing\",\"to\":\"receiverId\"}\nBut emit is not working. But now if I send directly message object like:\n[self.socket emit:@\"msg_10\" withItems:@[message]];\nThan emit is working, So I want to know is it supports json string in array or only object (NSDictionary)?\n. I'm using namespace in socket connection. Is any issue with that?\n. Is any way to parse JSON string or NSDictionary is compulsory?\nThanks once again.\n. ",
    "tolgaytoklar": "I am using 6.1.1\n. Oh, okay. Thank you.\n. Hey @lucianocn How did you handle this problem? \nLooks like I have same problem.\nhttps://github.com/socketio/socket.io-client-swift/issues/385\n. Yes, I can see it on the logs. It's sending.\n2016-06-05 2:13 GMT+03:00 Erik Little notifications@github.com:\n\nHave you turned on logging to see if it it's being sent?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/385#issuecomment-223783447,\nor mute the thread\nhttps://github.com/notifications/unsubscribe/AAu1FYkjdNmT-mhJzpWYrcSUYW5FFgf9ks5qIgaEgaJpZM4IuOjG\n.\n\n\nTolgay Toklar\nBursa,Turkey\n. Same issue happened right now. My log:\n2016-06-06 19:19:35.224 Ribony[1186:498662] Log SocketIOClient: Adding\nhandler for event: connect\n2016-06-06 19:19:35.224 Ribony[1186:498662] Log SocketIOClient: Adding\nhandler for event: disconnect\n2016-06-06 19:19:35.224 Ribony[1186:498662] Log SocketIOClient: Adding\nhandler for event: error\n2016-06-06 19:19:35.224 Ribony[1186:498662] Log SocketIOClient: Adding\nhandler for event: reconnectAttempt\n2016-06-06 19:19:35.224 Ribony[1186:498662] Log SocketIOClient: Adding\nhandler for event: processmessage\n2016-06-06 19:19:35.225 Ribony[1186:498662] Log SocketIOClient: Adding\nengine\n2016-06-06 19:19:35.226 Ribony[1186:498662] Log SocketEngine: Starting\nengine\n2016-06-06 19:19:35.226 Ribony[1186:498662] Log SocketEngine: Handshaking\n2016-06-06 19:19:35.226 Ribony[1186:498662] Log SocketEngine: Doing polling\nrequest\n2016-06-06 19:19:35.648 Ribony[1186:498662] Log SocketEngine: Got polling\nresponse\n2016-06-06 19:19:35.651 Ribony[1186:498667] Log SocketEngine: Got message:\n0{\"sid\":\"3otwJn3vt0ALcwR9ANAM\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2016-06-06 19:19:35.653 Ribony[1186:498667] Log SocketEngine: Doing polling\nrequest\n2016-06-06 19:19:35.868 Ribony[1186:498664] Log SocketEngine: Got polling\nresponse\n2016-06-06 19:19:35.868 Ribony[1186:498664] Log SocketEngine: Doing polling\nrequest\n2016-06-06 19:19:35.872 Ribony[1186:498667] Log SocketEngine: Got message:\n40\n2016-06-06 19:19:35.875 Ribony[1186:498623] Log SocketParser: Parsing 0\n2016-06-06 19:19:35.875 Ribony[1186:498623] Log SocketParser: Decoded\npacket as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2016-06-06 19:19:35.876 Ribony[1186:498623] Log SocketIOClient: Socket\nconnected\n2016-06-06 19:19:35.876 Ribony[1186:498623] Log SocketIOClient: Handling\nevent: connect with data: (\n)\nJoining room\n2016-06-06 19:19:35.880 Ribony[1186:498694] Log SocketIOClient: Emitting:\n2[\"joinToRoom\",{\"Chtoken\":\"074dd49f4110a2667683050dccd0b6ae\",\"UserPass\":\"1\",\"Username\":\"tolgay007\",\"AnonId\":\"anony-b9f57f4cd9f3bfe\",\"newA\":1}]\n2016-06-06 19:19:35.880 Ribony[1186:498667] Log SocketEngine: Writing poll:\n2[\"joinToRoom\",{\"Chtoken\":\"074dd49f4110a2667683050dccd0b6ae\",\"UserPass\":\"1\",\"Username\":\"tolgay007\",\"AnonId\":\"anony-b9f57f4cd9f3bfe\",\"newA\":1}]\nhas data: 0\n2016-06-06 19:19:35.881 Ribony[1186:498667] Log SocketEngine: Sending poll:\n2[\"joinToRoom\",{\"Chtoken\":\"074dd49f4110a2667683050dccd0b6ae\",\"UserPass\":\"1\",\"Username\":\"tolgay007\",\"AnonId\":\"anony-b9f57f4cd9f3bfe\",\"newA\":1}]\nas type: 4\n2016-06-06 19:19:35.882 Ribony[1186:498667] Log SocketEngine: POSTing:\n143:42[\"joinToRoom\",{\"Chtoken\":\"074dd49f4110a2667683050dccd0b6ae\",\"UserPass\":\"1\",\"Username\":\"tolgay007\",\"AnonId\":\"anony-b9f57f4cd9f3bfe\",\"newA\":1}]\n2016-06-06 19:19:35.882 Ribony[1186:498667] Log SocketEngine: Doing polling\nrequest\n2016-06-06 19:19:36.103 Ribony[1186:498667] Log SocketEngine: Sending ws:\nprobe as type: 2\n2016-06-06 19:19:36.239 Ribony[1186:498694] Log SocketEngine: Got message:\n3probe\n2016-06-06 19:19:36.240 Ribony[1186:498694] Log SocketEngine: Upgrading\ntransport to WebSockets\n2016-06-06 19:19:36.240 Ribony[1186:498694] Log SocketEngine: Sending\npoll:  as type: 6\n2016-06-06 19:19:36.344 Ribony[1186:498695] Log SocketEngine: Got polling\nresponse\n2016-06-06 19:19:36.345 Ribony[1186:498695] Log SocketEngine: Sending ws:\nas type: 5\n2016-06-06 19:19:36.345 Ribony[1186:498695] Log SocketEngine: Flushing\nprobe wait\n2016-06-06 19:19:36.347 Ribony[1186:498694] Log SocketEngine: Got message: 6\n2016-06-06 19:20:00.655 Ribony[1186:498695] Log SocketEngine: Writing ws:\nhas data: 0\n2016-06-06 19:20:00.655 Ribony[1186:498695] Log SocketEngine: Sending ws:\nas type: 2\n2016-06-06 19:20:00.827 Ribony[1186:498695] Log SocketEngine: Got message: 3\n2016-06-06 19:20:25.655 Ribony[1186:498884] Log SocketEngine: Writing ws:\nhas data: 0\n2016-06-06 19:20:25.655 Ribony[1186:498884] Log SocketEngine: Sending ws:\nas type: 2\n2016-06-06 19:20:25.865 Ribony[1186:498884] Log SocketEngine: Got message: 3\n2016-06-06 19:20:50.655 Ribony[1186:498946] Log SocketEngine: Writing ws:\nhas data: 0\n2016-06-06 19:20:50.655 Ribony[1186:498946] Log SocketEngine: Sending ws:\nas type: 2\n2016-06-06 19:20:51.335 Ribony[1186:498946] Log SocketEngine: Got message: 3\n2016-06-06 19:21:15.655 Ribony[1186:499024] Log SocketEngine: Writing ws:\nhas data: 0\n2016-06-06 19:21:15.656 Ribony[1186:499024] Log SocketEngine: Sending ws:\nas type: 2\n2016-06-06 19:21:15.801 Ribony[1186:499024] Log SocketEngine: Got message: 3\n2016-06-06 19:21:40.655 Ribony[1186:499107] Log SocketEngine: Writing ws:\nhas data: 0\n2016-06-06 19:21:40.655 Ribony[1186:499107] Log SocketEngine: Sending ws:\nas type: 2\n2016-06-06 19:21:40.868 Ribony[1186:499107] Log SocketEngine: Got message: 3\n2016-06-06 19:18 GMT+03:00 Tolgay Toklar tolgay007@gmail.com:\n\nYes, I can see it on the logs. It's sending.\n2016-06-05 2:13 GMT+03:00 Erik Little notifications@github.com:\n\nHave you turned on logging to see if it it's being sent?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/385#issuecomment-223783447,\nor mute the thread\nhttps://github.com/notifications/unsubscribe/AAu1FYkjdNmT-mhJzpWYrcSUYW5FFgf9ks5qIgaEgaJpZM4IuOjG\n.\n\n\nTolgay Toklar\nBursa,Turkey\n\n\nTolgay Toklar\nBursa,Turkey\n. One more thing: When this problem happens, there is no problem with\nconnection because i can sending message.\n2016-06-06 19:23 GMT+03:00 Tolgay Toklar tolgay007@gmail.com:\n\nSame issue happened right now. My log:\n2016-06-06 19:19:35.224 Ribony[1186:498662] Log SocketIOClient: Adding\nhandler for event: connect\n2016-06-06 19:19:35.224 Ribony[1186:498662] Log SocketIOClient: Adding\nhandler for event: disconnect\n2016-06-06 19:19:35.224 Ribony[1186:498662] Log SocketIOClient: Adding\nhandler for event: error\n2016-06-06 19:19:35.224 Ribony[1186:498662] Log SocketIOClient: Adding\nhandler for event: reconnectAttempt\n2016-06-06 19:19:35.224 Ribony[1186:498662] Log SocketIOClient: Adding\nhandler for event: processmessage\n2016-06-06 19:19:35.225 Ribony[1186:498662] Log SocketIOClient: Adding\nengine\n2016-06-06 19:19:35.226 Ribony[1186:498662] Log SocketEngine: Starting\nengine\n2016-06-06 19:19:35.226 Ribony[1186:498662] Log SocketEngine: Handshaking\n2016-06-06 19:19:35.226 Ribony[1186:498662] Log SocketEngine: Doing\npolling request\n2016-06-06 19:19:35.648 Ribony[1186:498662] Log SocketEngine: Got polling\nresponse\n2016-06-06 19:19:35.651 Ribony[1186:498667] Log SocketEngine: Got message:\n0{\"sid\":\"3otwJn3vt0ALcwR9ANAM\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2016-06-06 19:19:35.653 Ribony[1186:498667] Log SocketEngine: Doing\npolling request\n2016-06-06 19:19:35.868 Ribony[1186:498664] Log SocketEngine: Got polling\nresponse\n2016-06-06 19:19:35.868 Ribony[1186:498664] Log SocketEngine: Doing\npolling request\n2016-06-06 19:19:35.872 Ribony[1186:498667] Log SocketEngine: Got message:\n40\n2016-06-06 19:19:35.875 Ribony[1186:498623] Log SocketParser: Parsing 0\n2016-06-06 19:19:35.875 Ribony[1186:498623] Log SocketParser: Decoded\npacket as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2016-06-06 19:19:35.876 Ribony[1186:498623] Log SocketIOClient: Socket\nconnected\n2016-06-06 19:19:35.876 Ribony[1186:498623] Log SocketIOClient: Handling\nevent: connect with data: (\n)\nJoining room\n2016-06-06 19:19:35.880 Ribony[1186:498694] Log SocketIOClient: Emitting:\n2[\"joinToRoom\",{\"Chtoken\":\"074dd49f4110a2667683050dccd0b6ae\",\"UserPass\":\"1\",\"Username\":\"tolgay007\",\"AnonId\":\"anony-b9f57f4cd9f3bfe\",\"newA\":1}]\n2016-06-06 19:19:35.880 Ribony[1186:498667] Log SocketEngine: Writing\npoll:\n2[\"joinToRoom\",{\"Chtoken\":\"074dd49f4110a2667683050dccd0b6ae\",\"UserPass\":\"1\",\"Username\":\"tolgay007\",\"AnonId\":\"anony-b9f57f4cd9f3bfe\",\"newA\":1}]\nhas data: 0\n2016-06-06 19:19:35.881 Ribony[1186:498667] Log SocketEngine: Sending\npoll:\n2[\"joinToRoom\",{\"Chtoken\":\"074dd49f4110a2667683050dccd0b6ae\",\"UserPass\":\"1\",\"Username\":\"tolgay007\",\"AnonId\":\"anony-b9f57f4cd9f3bfe\",\"newA\":1}]\nas type: 4\n2016-06-06 19:19:35.882 Ribony[1186:498667] Log SocketEngine: POSTing:\n143:42[\"joinToRoom\",{\"Chtoken\":\"074dd49f4110a2667683050dccd0b6ae\",\"UserPass\":\"1\",\"Username\":\"tolgay007\",\"AnonId\":\"anony-b9f57f4cd9f3bfe\",\"newA\":1}]\n2016-06-06 19:19:35.882 Ribony[1186:498667] Log SocketEngine: Doing\npolling request\n2016-06-06 19:19:36.103 Ribony[1186:498667] Log SocketEngine: Sending ws:\nprobe as type: 2\n2016-06-06 19:19:36.239 Ribony[1186:498694] Log SocketEngine: Got message:\n3probe\n2016-06-06 19:19:36.240 Ribony[1186:498694] Log SocketEngine: Upgrading\ntransport to WebSockets\n2016-06-06 19:19:36.240 Ribony[1186:498694] Log SocketEngine: Sending\npoll:  as type: 6\n2016-06-06 19:19:36.344 Ribony[1186:498695] Log SocketEngine: Got polling\nresponse\n2016-06-06 19:19:36.345 Ribony[1186:498695] Log SocketEngine: Sending ws:\nas type: 5\n2016-06-06 19:19:36.345 Ribony[1186:498695] Log SocketEngine: Flushing\nprobe wait\n2016-06-06 19:19:36.347 Ribony[1186:498694] Log SocketEngine: Got message:\n6\n2016-06-06 19:20:00.655 Ribony[1186:498695] Log SocketEngine: Writing ws:\nhas data: 0\n2016-06-06 19:20:00.655 Ribony[1186:498695] Log SocketEngine: Sending ws:\nas type: 2\n2016-06-06 19:20:00.827 Ribony[1186:498695] Log SocketEngine: Got message:\n3\n2016-06-06 19:20:25.655 Ribony[1186:498884] Log SocketEngine: Writing ws:\nhas data: 0\n2016-06-06 19:20:25.655 Ribony[1186:498884] Log SocketEngine: Sending ws:\nas type: 2\n2016-06-06 19:20:25.865 Ribony[1186:498884] Log SocketEngine: Got message:\n3\n2016-06-06 19:20:50.655 Ribony[1186:498946] Log SocketEngine: Writing ws:\nhas data: 0\n2016-06-06 19:20:50.655 Ribony[1186:498946] Log SocketEngine: Sending ws:\nas type: 2\n2016-06-06 19:20:51.335 Ribony[1186:498946] Log SocketEngine: Got message:\n3\n2016-06-06 19:21:15.655 Ribony[1186:499024] Log SocketEngine: Writing ws:\nhas data: 0\n2016-06-06 19:21:15.656 Ribony[1186:499024] Log SocketEngine: Sending ws:\nas type: 2\n2016-06-06 19:21:15.801 Ribony[1186:499024] Log SocketEngine: Got message:\n3\n2016-06-06 19:21:40.655 Ribony[1186:499107] Log SocketEngine: Writing ws:\nhas data: 0\n2016-06-06 19:21:40.655 Ribony[1186:499107] Log SocketEngine: Sending ws:\nas type: 2\n2016-06-06 19:21:40.868 Ribony[1186:499107] Log SocketEngine: Got message:\n3\n2016-06-06 19:18 GMT+03:00 Tolgay Toklar tolgay007@gmail.com:\n\nYes, I can see it on the logs. It's sending.\n2016-06-05 2:13 GMT+03:00 Erik Little notifications@github.com:\n\nHave you turned on logging to see if it it's being sent?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/385#issuecomment-223783447,\nor mute the thread\nhttps://github.com/notifications/unsubscribe/AAu1FYkjdNmT-mhJzpWYrcSUYW5FFgf9ks5qIgaEgaJpZM4IuOjG\n.\n\n\nTolgay Toklar\nBursa,Turkey\n\n\nTolgay Toklar\nBursa,Turkey\n\n\nTolgay Toklar\nBursa,Turkey\n. Sorry for, emails. I think i found the problem. When this happens I see\n\"flushing proble wait\" log message on logs. What is this?\n2016-06-06 19:25 GMT+03:00 Tolgay Toklar tolgay007@gmail.com:\n\nOne more thing: When this problem happens, there is no problem with\nconnection because i can sending message.\n2016-06-06 19:23 GMT+03:00 Tolgay Toklar tolgay007@gmail.com:\n\nSame issue happened right now. My log:\n2016-06-06 19:19:35.224 Ribony[1186:498662] Log SocketIOClient: Adding\nhandler for event: connect\n2016-06-06 19:19:35.224 Ribony[1186:498662] Log SocketIOClient: Adding\nhandler for event: disconnect\n2016-06-06 19:19:35.224 Ribony[1186:498662] Log SocketIOClient: Adding\nhandler for event: error\n2016-06-06 19:19:35.224 Ribony[1186:498662] Log SocketIOClient: Adding\nhandler for event: reconnectAttempt\n2016-06-06 19:19:35.224 Ribony[1186:498662] Log SocketIOClient: Adding\nhandler for event: processmessage\n2016-06-06 19:19:35.225 Ribony[1186:498662] Log SocketIOClient: Adding\nengine\n2016-06-06 19:19:35.226 Ribony[1186:498662] Log SocketEngine: Starting\nengine\n2016-06-06 19:19:35.226 Ribony[1186:498662] Log SocketEngine: Handshaking\n2016-06-06 19:19:35.226 Ribony[1186:498662] Log SocketEngine: Doing\npolling request\n2016-06-06 19:19:35.648 Ribony[1186:498662] Log SocketEngine: Got polling\nresponse\n2016-06-06 19:19:35.651 Ribony[1186:498667] Log SocketEngine: Got\nmessage:\n0{\"sid\":\"3otwJn3vt0ALcwR9ANAM\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2016-06-06 19:19:35.653 Ribony[1186:498667] Log SocketEngine: Doing\npolling request\n2016-06-06 19:19:35.868 Ribony[1186:498664] Log SocketEngine: Got polling\nresponse\n2016-06-06 19:19:35.868 Ribony[1186:498664] Log SocketEngine: Doing\npolling request\n2016-06-06 19:19:35.872 Ribony[1186:498667] Log SocketEngine: Got\nmessage: 40\n2016-06-06 19:19:35.875 Ribony[1186:498623] Log SocketParser: Parsing 0\n2016-06-06 19:19:35.875 Ribony[1186:498623] Log SocketParser: Decoded\npacket as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2016-06-06 19:19:35.876 Ribony[1186:498623] Log SocketIOClient: Socket\nconnected\n2016-06-06 19:19:35.876 Ribony[1186:498623] Log SocketIOClient: Handling\nevent: connect with data: (\n)\nJoining room\n2016-06-06 19:19:35.880 Ribony[1186:498694] Log SocketIOClient: Emitting:\n2[\"joinToRoom\",{\"Chtoken\":\"074dd49f4110a2667683050dccd0b6ae\",\"UserPass\":\"1\",\"Username\":\"tolgay007\",\"AnonId\":\"anony-b9f57f4cd9f3bfe\",\"newA\":1}]\n2016-06-06 19:19:35.880 Ribony[1186:498667] Log SocketEngine: Writing\npoll:\n2[\"joinToRoom\",{\"Chtoken\":\"074dd49f4110a2667683050dccd0b6ae\",\"UserPass\":\"1\",\"Username\":\"tolgay007\",\"AnonId\":\"anony-b9f57f4cd9f3bfe\",\"newA\":1}]\nhas data: 0\n2016-06-06 19:19:35.881 Ribony[1186:498667] Log SocketEngine: Sending\npoll:\n2[\"joinToRoom\",{\"Chtoken\":\"074dd49f4110a2667683050dccd0b6ae\",\"UserPass\":\"1\",\"Username\":\"tolgay007\",\"AnonId\":\"anony-b9f57f4cd9f3bfe\",\"newA\":1}]\nas type: 4\n2016-06-06 19:19:35.882 Ribony[1186:498667] Log SocketEngine: POSTing:\n143:42[\"joinToRoom\",{\"Chtoken\":\"074dd49f4110a2667683050dccd0b6ae\",\"UserPass\":\"1\",\"Username\":\"tolgay007\",\"AnonId\":\"anony-b9f57f4cd9f3bfe\",\"newA\":1}]\n2016-06-06 19:19:35.882 Ribony[1186:498667] Log SocketEngine: Doing\npolling request\n2016-06-06 19:19:36.103 Ribony[1186:498667] Log SocketEngine: Sending ws:\nprobe as type: 2\n2016-06-06 19:19:36.239 Ribony[1186:498694] Log SocketEngine: Got\nmessage: 3probe\n2016-06-06 19:19:36.240 Ribony[1186:498694] Log SocketEngine: Upgrading\ntransport to WebSockets\n2016-06-06 19:19:36.240 Ribony[1186:498694] Log SocketEngine: Sending\npoll:  as type: 6\n2016-06-06 19:19:36.344 Ribony[1186:498695] Log SocketEngine: Got polling\nresponse\n2016-06-06 19:19:36.345 Ribony[1186:498695] Log SocketEngine: Sending\nws:  as type: 5\n2016-06-06 19:19:36.345 Ribony[1186:498695] Log SocketEngine: Flushing\nprobe wait\n2016-06-06 19:19:36.347 Ribony[1186:498694] Log SocketEngine: Got\nmessage: 6\n2016-06-06 19:20:00.655 Ribony[1186:498695] Log SocketEngine: Writing\nws:  has data: 0\n2016-06-06 19:20:00.655 Ribony[1186:498695] Log SocketEngine: Sending\nws:  as type: 2\n2016-06-06 19:20:00.827 Ribony[1186:498695] Log SocketEngine: Got\nmessage: 3\n2016-06-06 19:20:25.655 Ribony[1186:498884] Log SocketEngine: Writing\nws:  has data: 0\n2016-06-06 19:20:25.655 Ribony[1186:498884] Log SocketEngine: Sending\nws:  as type: 2\n2016-06-06 19:20:25.865 Ribony[1186:498884] Log SocketEngine: Got\nmessage: 3\n2016-06-06 19:20:50.655 Ribony[1186:498946] Log SocketEngine: Writing\nws:  has data: 0\n2016-06-06 19:20:50.655 Ribony[1186:498946] Log SocketEngine: Sending\nws:  as type: 2\n2016-06-06 19:20:51.335 Ribony[1186:498946] Log SocketEngine: Got\nmessage: 3\n2016-06-06 19:21:15.655 Ribony[1186:499024] Log SocketEngine: Writing\nws:  has data: 0\n2016-06-06 19:21:15.656 Ribony[1186:499024] Log SocketEngine: Sending\nws:  as type: 2\n2016-06-06 19:21:15.801 Ribony[1186:499024] Log SocketEngine: Got\nmessage: 3\n2016-06-06 19:21:40.655 Ribony[1186:499107] Log SocketEngine: Writing\nws:  has data: 0\n2016-06-06 19:21:40.655 Ribony[1186:499107] Log SocketEngine: Sending\nws:  as type: 2\n2016-06-06 19:21:40.868 Ribony[1186:499107] Log SocketEngine: Got\nmessage: 3\n2016-06-06 19:18 GMT+03:00 Tolgay Toklar tolgay007@gmail.com:\n\nYes, I can see it on the logs. It's sending.\n2016-06-05 2:13 GMT+03:00 Erik Little notifications@github.com:\n\nHave you turned on logging to see if it it's being sent?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/385#issuecomment-223783447,\nor mute the thread\nhttps://github.com/notifications/unsubscribe/AAu1FYkjdNmT-mhJzpWYrcSUYW5FFgf9ks5qIgaEgaJpZM4IuOjG\n.\n\n\nTolgay Toklar\nBursa,Turkey\n\n\nTolgay Toklar\nBursa,Turkey\n\n\nTolgay Toklar\nBursa,Turkey\n\n\nTolgay Toklar\nBursa,Turkey\n. Well, that was my fault sorry :) It is working well.\n. Oh, i downgraded to 9.0.1 and fixed. Thanks\n2017-06-08 21:06 GMT+03:00 Erik Little notifications@github.com:\n\nWhen you say latest, do you mean v10? If your server is socket.io 1.0 you\nhave to use v9.0.1 of the client. v10 is not backwards compatible with\nsocket.io 1.0.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/707#issuecomment-307182362,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAu1FaXdGO_A3Go8Kv46RviiZzitqWBAks5sCDgSgaJpZM4N0aM-\n.\n\n\n-- \nTolgay Toklar\nBursa,Turkey\n. ",
    "Soniy7x": "yes, connected says false but this was connected.\n. I see. Thank U!\n. ",
    "emadd": "Thanks.  I ended up placing the socket on a singleton class.\n. ",
    "amitarcher": "Thanks it working but it's facing issue with 0.9.16 seems we need to upgrade socket.io.\nJust one more thing\nwas getting error at line 224 socketengine.swift\n let req = NSMutableURLRequest(URL: NSURL(string: self.urlPolling! + \"&sid=(self.sid)&b64=1\")!)\nafter replacing this with \nvar __url = urlPolling + \"&b64=1\" as NSString;\n        var urlStr : NSString = __url.stringByAddingPercentEscapesUsingEncoding(NSUTF8StringEncoding)!\n        var polUrl : NSURL = NSURL(string: urlStr as String)!\nlet reqPolling = NSMutableURLRequest(URL: polUrl)\nits doing good thanks man\n. ",
    "sauvikatinnofied": "Thank you very much @nuclearace. I just updated my Xcode to v6.3.1.Project built successfully. \n.  I have this code\n``` objective-c\n- (void)sendEvent:(NSString*)event eventData:(id)data withCompletionHandler:(MessageSendingCompletionHandler)completionHandler{\n[_socketClient emitWithAck:event withItems:@[data]](0, ^(NSArray* data) {\n    completionHandler();\n});\n\n}\n```\nand a break point is added on completionHandler(). Event is emitted successfully, server is also listening the event perfectly, but my completionHandler() is never called. Please suggest me how to execute this completion block.\n. No @nuclearace , it is not executed. First I was trying with a simple NSLog(@\"Data Sent\"). But it never executed.\n. Sorry for late reply. User this type of code snippet in server side, \n``` objective-c\n- (void)sendEvent:(NSString*)event eventData:(id)data withCompletionHandler:(MessageSendingCompletionHandler)completionHandler{\n[_socketClient emitWithAck:event withItems:@[data]](0, ^(NSArray* data) {\n    completionHandler();\n});\n\n}\n```\nnow my completion handler is being executed from server side.\njavascript\n        socket.on('newIncomingMessageFromUser', function(message, cb) {\n            if (cb) {\n              cb(messageObject);\n            }\n        });\nThank you so much for being generous in helping us.\n. Thank you very much for your quick reply.\n. ",
    "cdagli": "Hello Hohl, it works with passport.socketio already. I am using it on the server side. \n. ",
    "hohl": "@nuclearace Thank you. I'll give it a try.\n. ",
    "cmorss": "I've installed into my Objective-C project via cocapods and can't seem to get the import statement correct. I've read the Apple docs on importing Swift into Objective-C projects to no avail. Can you also include the correct #import statement in the readme as well?  Thanks.\n. @nuclearace I created a new project to figure out what I needed to import. This seems to work:\n```\nimport \"Socket_IO_Client_Swift/Socket_IO_Client_Swift-Swift.h\";\n```\n. Thanks for the update but does closing this issue mean that it'll be fixed soon?\n. Thanks so much. Very much appreciated.\nOn Tue, Jun 23, 2015 at 5:36 PM, Erik Little notifications@github.com\nwrote:\n\nIt's fixed in the latest master, I'll push a new minor version later\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/104#issuecomment-114682945\n.\n\n\ncharlie.morss@gmail.com\n. ",
    "PengsreangSrun": "I have been facing problem with emit and I cannot receive data back. So how can I do?Please help me!\n. @nuclearace I used with emitWithAck but i cannot receive anything back!\n. yes, server is responded and other events are also work out!\n. if possible, can u drop code of receive data back?\n. I am definitely sure for connection!\n. Can you show me how to emit and on event because i have followed what you show me on readme but it is still useless. Anyways, when I connect, i need to add option like this:\noptions:@{@\"reconnects\":@true,@\"reconnectAttempts\":@5,@\"reconnectWait\":@5,@\"forcePolling\":@false,@\"forceWebsockets\":@true,@\"nsp\":@\"/\"}\nand then it starts connecting but i still have problems with emit and on event. Please help!!!\n. @nuclearace  This is my emit code:\n NSArray *arr = [[NSArray alloc] initWithObjects:data, nil];\n        [socket emit:requestName withItems:arr];\nbefore emitting, whether we need to convert to array or not because my data is id. However, when i do not convert data to array, error will happen. \n. Thank you for your telling me but I still have doubts with parameter that we emit. Can we emit data with only array and dictionary? How's about string? I cannot emit JSon string!\n. Thank you very much for helping me. From now I emit data with a NSDictionary!\n. I tried both of forcePolling and forceWebsocket, but it was useless!\n. ",
    "ankitthakur": "I just found its integration with Pods.\n. ",
    "packedbox": "Yes you\u2019re right it was just to check were the leaks could come from.\nI tried to go deeper in the code to check what could be wrong but I must admit i\u2019m a complete newbie in Swift and the code is using async queues so It\u2019s not easy to debug. \nThe leaking behavior is present with all combinaisons of forcepolling and forcewebsocket. I tried to use the instruments to track the leak \nsetting only forcepolling gives a slighly different pattern in the memory view ( no \"steps\" in the memory )\n\n. I stream data that I receive from a BLE device the rate should be around 60hz \n. Ii have tried instrument but its not clear what's leaking looks like NSString and NSNumber \nYes it's the lastest version ( I downloaded it yesterday )\nMaybe it's the garbage collector that can't cope with the pace, I might need to switch to raw sockets and stay away from NSObjects for this\n. yes you're right i'm too used of using c#\n. Hi I use this code to creat the socket : \nself.socket = [[SocketIOClient alloc] initWithSocketURL:@\"192.168.1.66:4567\" options:nil];\n. ",
    "ingacash": "I'm also having problems with the memory usage growing with each call to emit. I'm using swift and the latest version of socket.io-client-swift. Here is my code:\n``` swift\n    var socketIOClient: SocketIOClient?\nfunc socketIOClientStart {\n    socketIOClient = SocketIOClient(socketURL: \"http://x.x.x.x:xxxx\")\n    socketIOClient!.on(\"connect\") { data, ack in\n        NSTimer.scheduledTimerWithTimeInterval(2.0, target: self, selector: Selector(\"emit\"), userInfo: nil, repeats: true)\n    }\n    socketIOClient!.connect(timeoutAfter: 5) {\n        print(\"Connection timeout\")\n    }\n}\n\nfunc emit() {\n    socketIOClient!.emit(\"foo\", \"bar\")\n}\n\n```\n. ",
    "HeineSkov": "Any news regarding this memory leak? \n. ",
    "hifall": "Is this issue fixed?\n. If you think it's a Swift issue, maybe we can escalate this to the Swift team? Or more investigation is needed?\n. I am also seeing the same issue. And here is the call stack:\nSocket error!\nSocket error!\nSocket reconnecting...\nSocket attempting to reconnect...\n2016-07-10 18:15:17.357 StoreExample[40511:5869820] Attempted to create a task in a session that has been invalidated\n2016-07-10 18:15:17.365 StoreExample[40511:5869820] * Terminating app due to uncaught exception 'NSGenericException', reason: 'Task created in a session that has been invalidated'\n* First throw call stack:\n(\n    0   CoreFoundation                      0x0000000110454d85 exceptionPreprocess + 165\n    1   libobjc.A.dylib                     0x0000000112a9adeb objc_exception_throw + 48\n    2   CFNetwork                           0x00000001141348ed -[__NSURLSessionLocal taskForClass:request:uploadFile:bodyData:completion:] + 386\n    3   CFNetwork                           0x0000000114135960 -[__NSURLSessionLocal dataTaskForRequest:completion:] + 77\n    4   ClientLib                            0x000000010fb30963 TFE8ClientLibPS_20SocketEnginePollable9doRequestfTCSo12NSURLRequest12withCallbackFTGSqCSo6NSData_GSqCSo13NSURLResponse_GSqCSo7NSError__T__T + 1331\n    5   ClientLib                            0x000000010fb30418 TFE8ClientLibPS_20SocketEnginePollable10doLongPollfCSo12NSURLRequestT + 232\n    6   ClientLib                            0x000000010f990910 TFFC8ClientLib12SocketEngine7connectFT_T_U_FT_T + 80\n    7   ClientLib                            0x000000010f990957 _TTRXFo__dT__XFdCb__dT + 39\n    8   libdispatch.dylib                   0x0000000113ba8d9d _dispatch_call_block_and_release + 12\n    9   libdispatch.dylib                   0x0000000113bc93eb _dispatch_client_callout + 8\n    10  libdispatch.dylib                   0x0000000113baf82c _dispatch_queue_drain + 2215\n    11  libdispatch.dylib                   0x0000000113baed4d _dispatch_queue_invoke + 601\n    12  libdispatch.dylib                   0x0000000113bb1996 _dispatch_root_queue_drain + 1420\n    13  libdispatch.dylib                   0x0000000113bb1405 _dispatch_worker_thread3 + 111\n    14  libsystem_pthread.dylib             0x0000000113f064de _pthread_wqthread + 1129\n    15  libsystem_pthread.dylib             0x0000000113f04341 start_wqthread + 13\n)\nlibc++abi.dylib: terminating with uncaught exception of type NSException\n(lldb) \nThis happened after a socket error and it tried to reconnect.\n. @nuclearace, in order to test your fix, should I change SocketEngine.swift like this?\npublic func disconnect(reason: String) {\n        if closed || !connected {\n            postSendClose(nil, nil, nil)\n            return\n        }\n        guard connected else { return closeOutEngine(reason) }\n        ........\n. This happened in 6.1.4.\n. More info on this, for the purpose of potentially easier reproduction:\nI saw this on a simulated iPhone 5s, Xcode 7.3.1, OS X El Capitan. It was in a not-so-stable network, with VPN switched on/off from time to time.\nAlthough that was the environment where it happened, it doesn't necessarily mean that any of the factors above contributes to the occurrence of the bug. I just saw the issue a couple of times, so I have not found a consistent way to reproduce this.\nAlthough from personal experience, this doesn't happen every day, but as @paulcarpenter says, if your user base grows, this issue will happen more. And when it happens, it crashes the whole app, which is not good. So I support for some serious investigations here.\n. @nuclearace, as mentioned by @paulcarpenter, postSendClose is not a method in 6.1.4. So how to test your fix (if the offer still valid) now?\n. Right. In Xcode 7.3, after I added the swift files and tried to compiled my framework, it errored: Swift is not supported for static libraries.\nBut maybe we can compile your lib into a framework first, then link to it? Haven't tried that yet. Just a thought.\n. @drekka, thanks for the hint. But any chance you could provide a bit more detail on \"Change your build target from a static library to a framework\", or provide any pointer to it? I am building my framework following this link: https://github.com/jverkoey/iOS-Framework.\nThanks!\n. @drekka, thanks for getting back to me! I am indeed not up to date on iOS framework building these days. I will definitely do some research in this area by following your link shortly.\nAgain, thanks for the link.\n. I am seeing this issue as well. Consistently. I am using the Socket.IO server, rather than a plain websocket server.\n. 2016-06-30 02:14:05.580 SIMChatExample[1154:470799] LOG SocketIOClient: Adding handler for event: connect\n2016-06-30 02:14:05.582 SIMChatExample[1154:470799] LOG SocketIOClient: Adding handler for event: currentAmount\n2016-06-30 02:14:05.582 SIMChatExample[1154:470799] LOG SocketIOClient: Adding engine\n2016-06-30 02:14:05.584 SIMChatExample[1154:470799] LOG SocketEngine: Starting engine. Server: https://www.xxxxxxx.com:3001\n2016-06-30 02:14:05.584 SIMChatExample[1154:470799] LOG SocketEngine: Handshaking\n2016-06-30 02:14:05.586 SIMChatExample[1154:470825] LOG SocketEnginePolling: Doing polling request\n2016-06-30 02:14:08.204 SIMChatExample[1154:470854] LOG SocketEnginePolling: Got polling response\n2016-06-30 02:14:08.211 SIMChatExample[1154:470825] LOG SocketEngine: Got message: 0{\"sid\":\"UKI5OUV7hiNRRnoaAAAF\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2016-06-30 02:14:08.219 SIMChatExample[1154:470825] LOG SocketEnginePolling: Doing polling request\n2016-06-30 02:14:08.219 SIMChatExample[1154:470825] LOG SocketEngineClient: Connect\n2016-06-30 02:14:08.221 SIMChatExample[1154:470825] LOG SocketEngine: Writing poll:  has data: 0\n2016-06-30 02:14:08.225 SIMChatExample[1154:470825] LOG SocketEnginePolling: Sending poll:  as type: 2\n2016-06-30 02:14:08.226 SIMChatExample[1154:470825] LOG SocketEnginePolling: Created POST string: 1:2\n2016-06-30 02:14:08.226 SIMChatExample[1154:470825] LOG SocketEnginePolling: POSTing\n2016-06-30 02:14:08.227 SIMChatExample[1154:470825] LOG SocketEnginePolling: Doing polling request\n2016-06-30 02:14:08.622 SIMChatExample[1154:470825] LOG SocketEnginePolling: Got polling response\n2016-06-30 02:14:08.624 SIMChatExample[1154:470825] LOG SocketEnginePolling: Doing polling request\n2016-06-30 02:14:08.627 SIMChatExample[1154:470864] LOG SocketEngine: Got message: 40\n2016-06-30 02:14:08.628 SIMChatExample[1154:470864] LOG SocketIOClient: Should parse message: 0\n2016-06-30 02:14:08.630 SIMChatExample[1154:470864] LOG SocketParser: Parsing 0\n2016-06-30 02:14:08.631 SIMChatExample[1154:470864] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2016-06-30 02:14:08.631 SIMChatExample[1154:470864] LOG SocketIOClient: Socket connected\n2016-06-30 02:14:08.631 SIMChatExample[1154:470864] LOG SocketIOClient: Handling event: connect with data: (\n)\nsocket connected!!!!!!\n2016-06-30 02:14:08.632 SIMChatExample[1154:470799] LOG SocketIOClient: Adding handler for event: iOSServerResponse\n2016-06-30 02:14:08.636 SIMChatExample[1154:470825] LOG SocketIOClient: Emitting: 2[\"visitorTextMessage\",{\"msg\":\"Hello from Swift!\",\"room\":\"iOS room\"}]\n2016-06-30 02:14:08.637 SIMChatExample[1154:470825] LOG SocketEngine: Writing poll: 2[\"visitorTextMessage\",{\"msg\":\"Hello from Swift!\",\"room\":\"iOS room\"}] has data: 0\n2016-06-30 02:14:08.637 SIMChatExample[1154:470825] LOG SocketEnginePolling: Sending poll: 2[\"visitorTextMessage\",{\"msg\":\"Hello from Swift!\",\"room\":\"iOS room\"}] as type: 4\n2016-06-30 02:14:09.878 SIMChatExample[1154:470864] LOG SocketEnginePolling: Got polling response\n2016-06-30 02:14:09.879 SIMChatExample[1154:470854] LOG SocketEnginePolling: Created POST string: 70:42[\"visitorTextMessage\",{\"msg\":\"Hello from Swift!\",\"room\":\"iOS room\"}]\n2016-06-30 02:14:09.879 SIMChatExample[1154:470854] LOG SocketEnginePolling: POSTing\n2016-06-30 02:14:09.879 SIMChatExample[1154:470825] LOG SocketEngine: Got message: 3\n2016-06-30 02:14:09.879 SIMChatExample[1154:470854] LOG SocketEnginePolling: Doing polling request\n2016-06-30 02:14:09.881 SIMChatExample[1154:470864] LOG SocketEnginePolling: Doing polling request\n2016-06-30 02:14:10.277 SIMChatExample[1154:470854] LOG SocketEngine: Sending ws: probe as type: 2\n2016-06-30 02:14:10.658 SIMChatExample[1154:470854] LOG SocketEngine: Got message: 3probe\n2016-06-30 02:14:10.659 SIMChatExample[1154:470854] LOG SocketEngine: Upgrading transport to WebSockets\n2016-06-30 02:14:10.659 SIMChatExample[1154:470854] LOG SocketEnginePolling: Sending poll:  as type: 6\n2016-06-30 02:14:10.659 SIMChatExample[1154:470854] LOG SocketEnginePolling: Created POST string: 1:6\n2016-06-30 02:14:10.660 SIMChatExample[1154:470854] LOG SocketEnginePolling: POSTing\n2016-06-30 02:14:10.661 SIMChatExample[1154:470854] ERROR SocketEnginePolling: Tried to do polling request when not supposed to\n2016-06-30 02:14:10.708 SIMChatExample[1154:470822] LOG SocketEnginePolling: Got polling response\n2016-06-30 02:14:10.708 SIMChatExample[1154:470822] LOG SocketEngine: Sending ws:  as type: 5\n2016-06-30 02:14:10.709 SIMChatExample[1154:470822] LOG SocketEngine: Flushing probe wait\n2016-06-30 02:14:10.711 SIMChatExample[1154:470854] LOG SocketEngine: Got message: 6\n. I am calling the API like this:\n```\n    let socket = SocketIOClient(socketURL: NSURL(string: \"https://www.xxxxxxx.com:3001\")!, options: [.Log(true), .ForcePolling(false)])\nsocket.on(\"connect\") {data, ack in\n    print(\"socket connected!!!!!!\")\n\n    //socket.emit(\"iOSVisitorJoined\", [\"user\": \"iOS Visitor\", \"room\": \"iOS room\", \"page\": \"SIMChat\", \"url\": \"SIMChat\"])\n\n    socket.emit(\"visitorTextMessage\", [\"room\": \"iOS room\", \"msg\": \"Hello from Swift!\"])\n\n    socket.on(\"iOSServerResponse\") {data, ack in\n        print(data)\n    }\n\n    /*\n    socket.emitWithAck(\"visitorJoined\", cur)(timeoutAfter: 0) {data in\n        socket.emit(\"update\", [\"amount\": cur + 2.50])\n    }\n    */\n}\n\n```\n. Well, hardly so. Receiving messages is quite slow (> 10 seconds) and sometimes messages are lost.\n. Would a backoff algorithm help? That is, if a reconnect fails, increase the wait time before trying to reconnect again. This would reduce \"socket congestion\" on the server.\n. @nuclearace, what you do mean by \"Are these from the WebSocket?\"\nI am using websockets, rather than long polling.\n. I am not using .ForceWebsockets(true).\nAlso, I have already used .ReconnectWait(25) to mitigate this issue on our end. It turned out that the ~10 sockets came down to ~5 at the moment.\n. I just saw this crash on my iPhone.\n. No, I am not sending many. Like one every few seconds. \"significant\" in my previous message was perhaps an exaggeration. Again, no real worry here.\n. ",
    "S2V": "I have same problem. Use carthage: \n\ngithub \"socketio/socket.io-client-swift\" ~> 6.1.6\n\nThis happend when server is 'down' - server is real off. In console I have print \n\nSocketManager -> ERROR: ([{\n    code = \"invalid_token\";\n    message = \"invalid signature\";\n    type = UnauthorizedError;\n}], )\n\nEach message increases  memory consumption  \u02dc100KB  and generated many thread's.\n\n. ",
    "alevinru": "I have found that emitting from 1000 async NSOperations within a NSOperationQueue which has maxConcurrentOperationCount = 25 leads to about 20 acks won't be called back due to not safe incrementing of SocketIOClient private currentAck.. OK, i'll try. Now it's safe to use concurrent queue\nBefore the fix i've tried to use main queue and there were a lot of crashes nevertheless. @nuclearace Ok, but i'm not about the internal queue of the library. I have an event bus inside my app and it concurrently emits with ack to socket.io. Then the library generates ack numbers, and only after it pushes operations into the internal library's serial queue. That is why the ack generation have to be thread-safe.\nI've tried the library as it is without the semaphores and it crashes a lot because some simultaneous emits receive the same ack numbers.. @nuclearace Do you mean i shouldn't just emit from any part of my code, but have to dispatch a block operation to the SocketManager's handleQueue?. @nuclearace This is quite strange not to merge this PR, because it brings nothing negative, just a more convenient way to use the library. And the callback retained by self reference is still leaking regardless of the serial or concurrent question. @nuclearace I don't use a concurrent queue as the handleQueue - It's serial and i understand why it is required. \nBut i don't understand why i need to wrap every call to emit:withAck: into a dispatch-to handleQueue block?\nI.e. instead of just:\n[self.socket emitWithAck:@\"event\" with:@[@payload]];\nWe need to remember somewhere the socket handleQueue instance and:\ndispatch_async(socketHandleQueue, ^{\n        [self.socket emitWithAck:@\"event\" with:@[@payload]];\n    });\nEven if someone has configured SocketManager instance with default main queue as handleQueue, the app may be in background at the time of the emit - then the call to emitWithAck:with: will be dispatched from some background queue, not the SocketManager's handleQueue.\nAs i see in your code there's no need to demand this dispatching to socketHandleQueue before emitting because all the packets are then processed serially from the serial handleQueue.\nThe only issue is ack number generation and acks Set mutation after receiving ack.. Yes, we can, but the order doesn't matter with defer.  Defer makes it signalling after the func execution's over.. I suppose it's important to use defer here because as far as i know mutating funcs actually mutate after the function has finished.. https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Methods.html\nChapter \"Modifying Value Types from Within Instance Methods\"\n\nThe method can then mutate (that is, change) its properties from within the method, and any changes that it makes are written back to the original structure when the method ends.. For the queueing there are nice built-in classes OperationQueue and Operation. Apple says it's thread-safe and it seems so with my experience. Just need to subclass and implement KVO for the properties and a pair of methods as it's written in docs.. KVO is ugly indeed, but it's only a dozen of lines about it when subclassing an asynchronous Operation with no obligation to read these lines after. This is the cost of OperationQueue benefits. It's like a kind of oblation :). \n",
    "gkoeneke": "Thanks, Erik.  It took some work through the night, still up, but we finally got it all working.  We appreciate it!\n. ",
    "ManuPerfo": "Hi @nuclearace ,\nI am currently working on a project where I need to implement Socket security. I have socket looks like this \nself.appDelegate.deviceStatusSocket = SocketIOClient(socketURL:  Consatants.domain, options: [\"connectParams\":[\"accessToken\" : authtoken ,\"userId\": userId]]\nBut this not connecting with the host \nWe also have a a client side node socket looks like \nsocket = io(socketPath, { query: \"accessToken=\" + userTokenData.id + \"&userId=\" + userTokenData.userId });\nand this is working fine \nWhat I want to do with the iOS code  to make the socket gets connected with the host\n. ",
    "zhangqippp": "@nuclearace ,Yes, I got a version of 1.3.1 with cocoa pods, don't notice that.\n. run into the same problem in iOS 8.3 and iOS 7.x, once in a while, have no idea why it happened\n. ",
    "bogdand84": "I'll give it a shot.\nThanks!\n. ",
    "NachoSoto": "I took a quick look at the changes and everything looks good!\n. Cool I think this looks good!\nI'm going to open another PR to add support for Apple TV soon, too :)\n. I just encountered this issue. I'm connecting to the server with \"forceWebsockets\": true, and the server is receiving a nil sid on connection.\nThis is what I'm doing:\n``` swift\nlet options: [String: AnyObject!] = [\n    \"forceWebsockets\": true\n]\nsocket = SocketIOClient(socketURL: socketURL, options: options)\nsocket.connect()\n```\nThis is all I see in my console before my server detects the missing sid:\nSocketClient: Adding handler for event: error\nSocketClient: Adding handler for event: connect\nSocketClient: Adding engine\nSocketEngine: Starting engine\nSocketEngine: Handshaking\nI'm using version 2.3.8.\n. I'm using this socket.io library on the server side, and on connect, this line throws an Exception because the sid is an empty string.\nNote that if I don't pass \"forceWebsockets\": true in options, this is not an issue. So it seems like this may be a problem with the SocketEngine?\nPlease let me know if I can provide more information!\n. @nuclearace awesome! I guess this is the same as #22?\n. Wait, you mean that you can reproduce the same problem in netty-socketio using a JS client? I guess that means the problem is on the server implementation?\nUpdate:\nLooks like netty-socketio is currently expecting sids to be UUID (https://github.com/mrniko/netty-socketio/pull/132), which is incorrect.\n. What exactly did you reproduce? Sorry, it's not entirely clear from the screenshot.\nAre you saying the node.js also produces an error?\n. Will do! Thanks for the quick response and fix.\n. @nuclearace I just did. Same error :(\n. Yeah and that's working fine:\nvar socket = io(\"http://localhost:3001\", { transports: [ 'websocket' ] });\n. > I've never tried setting up a netty-socketio server, is there an easy guide or something?\nIf you're familiar with setting up java servers, the actual code is really simple: https://github.com/mrniko/netty-socketio#server.\nPlease let me know if I can help setting that up, as that would probably help you debug this issue :)\n. I created a really simple test server so that you can debug this.\nIt's really simple to run, simply clone it and execute mvn compile exec:java. It'll start listening on port 3001, and you can reproduce the issue connecting to it using socket.io-client-swift.\nYou'll see this exception being thrown during handshake:\njava.lang.IllegalArgumentException: Invalid UUID string:\n    at java.util.UUID.fromString(UUID.java:194)\n    at com.corundumstudio.socketio.transport.WebSocketTransport.channelRead(WebSocketTransport.java:111)\nLet me know if I can do anything else!\n. My bad, I did something wrong when getting your fix from master so I wasn't actually testing that! Good news is, looks like 5057226a6cfa3e732ac5ac3aa29ecd29e580ddc1 did actually fix this!\nIf you'd like, you can verify this yourself with that test server (hopefully it's useful for you in the future as well), but this looks solved on my end :)\n. @rpwilsonrph what do you mean by \"it will not generate the .h\"? What header are you referring to?\n. Carthage feelings aside, it's worth noting that source-code is not everything in a library. Like I mentioned, things like base SDK, deployment target, optimization levels, additional build flags, etc. are just important, and an Xcode project is the canonical way in Cocoa to represent and persist these additional details.\nIf you really disagree about this, it would be great at least to provide built frameworks with the project releases, here in Github, for iOS, Mac, and watchOS.\nI predict, however, that this would add more work for you.\nThank you for your time.\n. @nuclearace glad to hear! Thanks for the merge :)\n\nThe only thing I'm going to have to work out is how I should develop it (properly) without breaking the Carthage support. (I'm not a Cocoa/iOS/OS X dev, I just know Swift fairly well). And the last time I tried working with Carthage, the frameworks it output always seemed to be broken for me (I was probably doing something wrong)\n\nThe good thing about Carthage is that, as long as the project builds, you know that Carthage supports is not broken.\nIn any case, I'll be glad to help if anything comes up. I'm going to be using this library pretty often now so I look forward to helping more!\n. @hsavit1 you probably want to use the modern module syntax:\nobjc\n@import SocketIO\n. I would just capture self strongly, there's no reason to make it weak in any of these cases.\n. > @nuclearace IMO, the multithreads race condition in connect method is different from the use-after-release problem caused by a unowned object and that is not fixed by weak-referencing self. After turned on forceWebsocket, it's now easy to reproduce the problem on iOS 9 GM if you connect-close-connect quick\nThat's right, there's a very big difference between unowned and weak. In that sense, something like this commit is right because unowned can crash the app.\n\nlet weakSelf = self will try to unwrap and retain a deallocated object and eventually crashes the app.\n\nI'm sorry, but that's completely wrong. if self is a weak reference, doing if let weakSelf = self won't crash the app. self will have been nil-ed out (because it's weak, not unowned), which means that doing if-let simply defines weakSelf only if it's not nil. That's completely safe.\n\nTwo things. Generally I take the approach that unless there's an explicit reason to perform a strong capture, always perform a weak capture. This way you avoid crazy cases where you've got a strong reference that's keeping your object alive.\n\nUsing weak is useful for places where you want to avoid a retain cycle, like here.\nBut all the ones I've removed in this PR are unnecessary:\n- dispatch_* is guaranteed to be invoked some time in the future, which means that the cycle will always be broken.\n- weak introduces an unnecessary performance hit: there needs to be extra work to monitor references to them nil-out.\n- weak introduces unnecessary complexity: you need to consider in each code path what the right behavior should be if self is dealloced. We can simplify the code by avoiding this.\n- weak introduces more code than needed: look at how much code I removed: weak self, guard, etc. Code becomes a lot simpler, while keeping the same behavior.\n. Thanks for the comments guys!\n. Why would an issue be more helpful? I've already done the work for you.\nIs there a particular reason you disagree with this other than wanting to keep weak because you don't understand it?\nWhat about the rest of changes?\n. Cool. Which one aren't you sure about? Maybe one of them is actually needed.\n. It's not just for the optimization, it's mostly simplifying the code to make it easier to maintain :)\n. And because it means we no longer have to think about what should happen if self is nil everywhere.\n. > The ones in daltoniam/Starscream@889d288 Not sure if you removed some of these.\nI haven't :)\n\nAnd fyi, I'm all for taking the weaks out, I just wasn't sure if there's going to be some edge case where there's a strong retain that's keeping the client from being released.\n\nI studied each of them very rigorously (I didn't just got rid of all weaks). I only removed the ones where it's guaranteed that the cycle will be broken. In the case of dispatch, the block disappears (and with it, its strong self reference) as soon as it's invoked. It's impossible that that will create a cycle. There's actually never a cycle because self doesn't own the block.\n. Thanks :star: \n. It won't. If you try to build the new framework you'll get this error:\n\nBut other than that, nothing is affected, so I think it's safe and simpler to integrate this already for anyone who wants to build this for the Apple TV.\nIf you prefer, though, we can leave it in a separate branch.\n. :+1: \n. @victorpimentel what you want to do is limit the platforms you want to build for. You should always do that, as I doubt you need to build for all 3 architectures, which is very time consuming :)\ncarthage update --platform ios\ncarthage update --platform macosx\nOr with Carthage 0.9\ncarthage update --platform ios,macosx\n. Did you @import SocketIO;?\n. See #172. You need to use the --platform setting to limit the platforms you want to build for. Example:\ncarthage update --platform ios,macosx\n. @nuclearace good call!\n. I can confirm this is a regression: I just upgraded from 07f9d4f548dd612b60268985dd6dc718fe7c0c54 to f933b7addc0461a77f1069abed1d60791526376d without changing any code and I'm unable to connect to my server, with this very same error.\nYou can easily reproduce this by using my test server, for example: https://github.com/NachoSoto/Netty-Test-Server\n. > That's weird... I don't really see anything in that change that should've broken anything\nNote that I don't know which commit in this commit range broke it, all I know is that the regression is from one commit to the other.\n\nWhat does your connection to your test server look like?\n\nI'm connecting to the server with these options:\nswift\nlet options: [String : AnyObject] = [\n    \"forceWebsockets\": true,\n    \"log\": false,\n    \"reconnectAttempts\": 3\n]\nSo note that I'm forcing web sockets. On the server (using Netty-socketio) I have:\n``` java\nprivate static Configuration createConfig() {\n    final Configuration config = new Configuration();\n    config.setTransports(Transport.WEBSOCKET);\nreturn config;\n\n}\n``\n. Same here\n. Looks like the signing identity is set to the distribution certificate instead of development for those targets.\n. Yes, and set to \"not code sign\" for simulator.\n. This is a bug inXcode 7, fixed inXcode 7.1 beta 3`\n. Totally. I'll prepare a PR today!\n. It won't\n. > Does this only happen with optimizations on? If so it's a known bug that can only be fixed by lowering optimizations\nCurious: where are you tracking thus known bug? I'd like to bring it to the attention of the Swift compiler team if it's really a bug.\n. I use this With Carthage and the name has not been a problem. Why would you change the name?\n. That seems like a problem with CocoaPods, who's not respecting the product name.\n. It's not a philosophy problem, I'm being 100% serious: if CocoaPods isn't respecting Xcode's product name setting then that's something that needs to be either fixed in CocoaPods, or make sure that the Podfile is correct, not masking the problem by changing the product name to whatever CocoaPods happens to have right now.\n. I don't think it makes sense to suffix a framework with the word \"Swift\". It's irrelevant to a client of the module what language was used to compile it.\n. You probably don't want to ignore tasks that failed to be created, failing silently. Maybe change this to ! instead?\n. Ditto\n. Why this change? Looks like the project file is in the repo, which is extremely important (as explained in #117).\n. +1\n. You can simplify this by doing for data in datas ?? []. That way you reduce the indentation level.\n. These 2 queues seem like an implementation detail, should they be private (or internal)?\n. This can be private?\n. All these can be private too, right?\n. Seems like all files make use this singleton, but it gets set when creating a SocketIOClient? That's probably going to lead to some confusing behavior. I'd recommend not making it a singleton, or at least not making it mutable.\n. You can just do .Closed here\n. You can just do .Connected\n. I think this would be more correct as engine!.open(connectParams). You probably don't want to ignore if addEngine didn't do the right thing.\n. Maybe you want to add assert(timeoutAfter >= 0) to make sure users don't pass negative values\n. You don't need to make this weak here\n. This doesn't need to be weak\n. This doesn't need to be weak\n. Remove?\n. You can just do filter { $0.event != event }\n. This doesn't need to be weak\n. Doesn't need to be weak\n. This isn't necessary in Swift 2 anymore, it will create a description automatically.\n. Maybe use Logger here instead?\n. Logger?\n. This doesn't need to be weak\n. This doesn't need to be weak\n. This doesn't need to be weak\n. This doesn't need to be weak\n. This doesn't need to be weak\n. This doesn't need to be weak\n. This doesn't need to be weak\n. I prefer to avoid early returns that can be problematic if you don't notice them in the future. But I understand that's an stylistic choice (unlike some other things in this PR), so I'll chose whatever you guys prefer.\n. Why not? It doesn't make any sense to pass a negative timeout. What should be the expected behavior? The dispatch_after would be invoked right away so it would timeout right away.\n. Sorry! I'll fix\n. This strong reference is only kept for a short period of time (while this block is invoked). This won't cause a retain cycle. I'll explain more separately though.\n. This is a small optimization: there's no need to iterate through postWait if ws is nil anyway.\n. Apple is against unsigned types (they've almost removed them from all their APIs), but I do agree with that solution, specially since Swift guards against overflows.\n. No, $0 won't outlive this declaration so there's no need to not make it strong.\n. Nice :)\n. This isn't defined in the targets, so you'll need to set it to YES explicitly for iOS and tvOS.\n. If you make this an enum with associated String values instead, you can statically guarantee that all keys are unique.\n. Why is this weak? the delegate won't have a strong reference to the engine so there's no risk of retain cycle.\n. I'd recommend doing switch (key, value), because then you can do case (\"forceNew\", let value) where value is Bool) and will automatically have the right type.\n. This needs to be set to 3 (see https://github.com/jspahrsummers/xcconfigs/blob/master/tvOS/tvOS-Base.xcconfig#L15)\n. ",
    "lightsprint09": "I think so. I tried a lot of configurations this morning but non of them worked.\nAlso I found out that node is available in the OS X environment. I will try to fix travis and make the external server obsolete.\n. I think I downloaded the version during WWDC about 3-4 weeks ago\n. I donwloaded it manually. So there is no checkout point...\n. namespaces seem to stop working again.\n. ``` swift\nsocket = SocketIOClient(socketURL: baseURL.absoluteString, opts: nil)\n   socket!.on(\"update\") {data, ack in\n     dispatch_async(dispatch_get_main_queue()) {\n     updateCallback(self.gameSerializer.deserializeGame(data!.firstObject as! NSDictionary))\n   }\n   }\n    socket!.connect()\n    socket!.nsp = \"\\(game.name)\"\n    socket!.joinNamespace()\n\n```\n. Ok. If it is ok I\u00b4ll give it a try to convert in into real test cases.\n. I added the basic tests for emiting many types of data. It would be great to get some feedback\n. I am going to refactor the tests and reopen the pr\n. I pushed a new version.\nIt contains test cases for various datatypes. All of them are tested with emit and emitWithAck.\nSome tests do not pass. There are some problems sending Buffer with an acknowledgment and some tests only pass sometimes or when executed exclusively.\nI also pushed a new version of the server tests.\nI hope we can fix the remaining tests and merge it into master/swift2\n. In the Swift repository? It is possible but does it make sense\n. Cloning the test server separately. But this is not the best way.\nIs there a possibility in git to link to the other repo?\n. No. I don't think so.\nI copy everything and commit it\n. This is actually some kind of bug. I noticed that sending Buffers back cause los of some data... I don't know why\n. At some point there is one data item missing coming from the server. It is always missing when there is a Buffer is involved \n. My abstraction is not as is good as it should.\nI could remove the Buffers from the server and it will work. But the bug with the buffer will stay...\n. Did you test it with emit or ack? I think only ack is the problem. Emit works finde\n. It could be. But it could be a bug in the bad test implementation.\n. This is a good idea. Take some time...\n. I will take a look at all the tests again. Maybe I can spot a mistake\n. So I checked the tests again. They work fine.\nI added 2 test cases to test JSON/multEmit without Buffer/Binary data. They both pass. \nOther tests with Binary still fail. \nI think this proves that the binary data causes the tests to fail. The tests should be valid\n. Wow! Good job. All tests are passing\nOk, sometimes some tests fail when run all at once. Any idea why this is happening \n. Not at the moment.\nI will open a new PR if I find something to improve\n. The new OS fully supports NSURLSession and is capable of connection over WIFI autonomously. I found a post at the dev-forum where they describe that CFNetwork should be available soon. This should solve the problem.\n. in https://github.com/socketio/socket.io-client-swift/blob/master/Source/WebSocket.swift there is a lot of CF-Stuff...\n. should be done with this https://github.com/lightsprint09/socket.io-client-swift/commit/25464ffb9de4a80c15b4c60eb0ff858c60b4bace\n. My fault...\n. I do not know...\nI am currently testing this out. Opened the PR to early.\nSorry for that. Will reopen when done\n. And yes it supports Swift 2, iOS 9 :)\nhttp://blog.travis-ci.com/2015-08-27-xcode-70-beta-for-oss/\n. Ok. I think turning travis back shouldn't be a problem.\nI think getting a test server working is harder. Any idea which is better than heroku\n. This was not meant to be merged at this state. Tests are still failing on Travis and the test server problem is not solved yet. \nThis breaks nothing. But if possible revert it. \nWe need some kind of server to run the node/socket on to test the swift code against. As I mentioned before this could be a heroku server or something coustom. \nI want to hear your opinion about the server first before I will  implement it\n. I don't think this is possible because Travis only provides a container runtime. This is of course iOS. I don't think it is possible to run code from a foreign container runtime\n. Yeah. Heroku is free but start up time is about 30 seconds. This slows tests down but should work. Another possibility is to host it somewhere els where the server stays always on\n. We could use github web hooks to automatically deploy new tests. Or something that works out of the box\n. Do the tests pass locally ?\n. Is it normal that the debugger stops here\n\n. Is this an intended behavior?\nclient is not nil and reason is \"canceled\"\n. I just found that travis does not support outside internet connection...\nI\u00b4ll contact them for solution\n. year... but this would be a lot of work\n. I was wrong.\nTravis support said it is indeed possible to reach external services. I take another look into in\n. I got this mail as well.\nI did not think that socket.io caused this. But it could be.\n. I think guard does really well when showing exits in a method -  it is more like a keyword\nWhy not using try/catch. It is a create mechanism for errors and using optional for errors is much less expressiv. \nI will go over the code and improve the style\n. I don't get the point of theses Either types.\nIf you throw an Error you can with information attached it is nearly the same?\nWould it be ok to stay with try/catch or should I remove it in favor of optionals\n. Ok, fixed the classname\nI will stay with optionals because is natural in swift. I won't implement the Either type because it feels not natural and people are not familiar with this. \nIn my opinion native language features should be used in favor of other reimplementations because people are familiar with them\n. After reading your code example I got the idea of the Either type. It looks quite interesting, but I would not use it for error handling\nIt would make sense to use the  Either type in SocketEventHandler for obj-c callbacks\n. ready :+1: \n. @hankbao it would be great to create a test case to test against automatically\n. I think we are all in different time zones :+1: \n. SocketStringReader sounds good!\n. It would be great to cover this functions with tests... In my opinion every new functions should be tested, before the PR is merged\n. did but try ///socket.io/?transport=polling&b64=1\n. I didn't have time to take a look at it. Hopefully I find some time tomorrow\n. I would not kill the old tests\nThey are as important as the new ones\n. did you remove all the old tests\n. This would more follow the unit test principles. I think it is an good idea but it come with a lot of work.\nI would see our current approach more like an integration test. \nI tried the whole day to fix the test on travis. They run perfectly on the Mac even executed by xctool. Maybe there is an issue with the polling, because polling does fail often and I don't know why.\nMay you could take a look at the polling code\n. I think it helps. And does not break anything\nBut a real type save solution would be even better\n. this commit partly proves it https://github.com/socketio/socket.io-client-swift/commit/5d867f4f6524f302d52fdc60c6907b6687dc8733 ;)\nlook at AbstractTest\n. Ok? What other solution?\n. Like this?\n``` swift\nenum SocketInitialOptionsEnum {\n    case ConnectionParameter([String: AnyObject]?)\n    case Reconnects(Bool)\nfunc toString() -> String {\n    switch self {\n    case ConnectionParameter:\n        return \"connectParams\"\n    case Reconnects:\n        return \"reconnects\"\n    }\n}\n\n}\n```\n. this solution is defiantly better then mine.\nBut it is not Typesave. Wait a few days. I want to explore some more typesave solutions\n. I like your solution.\nI don't like nsp for a shortcut. It doesn't seem clear to me\n. It is... https://www.traviscistatus.com\n. I think so\n. Mh yeah. Now is would be a good time to ship other API changes...\n. But you can use the old API as well as the new one\n. Is this fixed?\n. ok. But some changes in the project must be related with the highlight failures I guess \n. 7.1 should be released alongside iOS 9.1 during the next hours\n. with let newSocket = SocketIOClient(socketURL: AbstractSocketTest.serverURL, options: [.ForceWebsockets(true)])\nEvery connection times out\n. Without forced WebSockets about 20-60. \n. ok 63 work, 64 doesn't \n. Mac OS\n. Did not have the time to investigate any further\n. see #130 for reasons\n. Thanks for you feedback.\nMaybe I should try to break this up into two separate PRs. One for cross-platform target, the other for eventually removing Starscream code.\nCan you give me more information where you did these customization in Starscream\nYou can set the default branch to development, so all PRs will go against development by default.. I close this for now.. sure. . I did not find time. I will try to do it next week.. When using development in carthage I get No available version for github \"daltoniam/Starscream\" satisfies the requirement: ~> 3.0.2. Is it correct to declare a requirement with minor version number?. Carthage. Namespacing seems to be broken.... I know.\nDoes v13 supports the old socket.io version?. 12 worked fine with 1.0 I guess. not not an explicit swift option.\nBut it works fine\n. Ok I understand that.\nI would remove the alt type. It is a bit confusing\n. This is a good name. I was not sure how to name it\n. ok\n. I would useguard let  pingInterval = pingInterval else { return }\n. but you win one indentation. It makes sense in methods with long single lines of code\n. would it make sense to change the parameter type from Int to UInt\n. debug purpose?\n. this shouldn't be necessary \n. I don`t understand what this line does.\n. oh I see. Some options are only used by the engine?\n. ok. \nswift\nreturn Mirror(reflecting: option).children.first?.value as? AnyObject\nwould this work?\n. Is this necessary anymore?\n. i would rename it to options...\n-> I don't like shortcuts \n. I this a clear solution.\nBecause I don't see at first sight that this should be a Set.\n. ok.\n. I would remove the typealias and use Set<SocketIOClientOption> directly in the API because everybody knows about Set but nobody knows about this secret SocketOptionsSet \n. ",
    "bocodigital": "Is there a new cocoa pod for this yet?\n. ok thanks\n. ",
    "sovannarithsok": "@nuclearace I have updated my issue that is easy for you to understand my problem \n\n\n. @nuclearace  The message with Option Log:\nSocketClient: Adding handler for event: connect\n  SocketClient: Adding handler for event: disconnect\n  SocketClient: Adding engine\n  SocketEngine: Starting engine\n  SocketEngine: Handshaking\n  SocketEngine: Got message: 0{\"sid\":\"OIbtmRBl-ojfZgqpAARR\",\"upgrades\":  [],\"pingInterval\":500,\"pingTimeout\":60000}\n. @nuclearace I have problem  with iPhone 5 iOS 7.1.2 with UInt64 above . if I change to UInt32, it's not crash but the socket is always loop with connect and disconnect.  \n. ",
    "alexpersian": "I am observing the same issues in a current project using this Socket.IO Swift library.\nMultiple connected, disconnect, reconnects without any code or user prompts.\nThe amount of reconnections varies, and doesn't seem to have any real rhyme or reason. Sometimes it will be 4-5 at a time, other times it will be 30-50 at a time.\nBased on other research it seems like it may be something related to Socket.IO itself, rather then contained within the Swift implementation.\nHere is an issue on the main project from back in 2011. It was closed as it was deemed not relevant in 1.0, but it seems they were running into a lot of the same issues as this.\nhttps://github.com/socketio/socket.io/issues/438\nI don't library in and out, but it seems to be an error in the handshaking process.\n. Hmm, was there any resolution to this issue?\n. ",
    "mephi1984": "I got same issue.\nBrief research shows me, that issue is in SocketEngine.swift file. \n```swift\n    private func sendPing() {\n        guard connected else { return }\n    // Server is not responding\n    if pongsMissed > pongsMissedMax {\n        client?.engineDidClose(reason: \"Ping timeout\")\n\n        return\n    }\n\n```\nIn my case, pongsMissed always 4, pongsMissedMax is 3, that's why connection drops. However, on reconnect, pongsMissed never reset to 0, so connection drops, then reconnect again, then drops again, then reconnect again, and so on.\nI added workaround, by resetting pongsMissed to 0 at same place when connected is set to true, totally 2 search matches.\nDo I need to submit pull request?. Hi, I updated code according to suggestions.. ",
    "rw86347": "I am using xcode 6.3.2\n. My college believe it is 1.1 or 1.2\n. ",
    "hfossli": "I can confirm that this works\n```\nimport \n```\n. If this helps reducing 20 seconds of compilation now and the code is not suffering readability then I don't understand why it can't be merged. When is the \"free string compilation time lunch\" coming?. Moved to https://github.com/socketio/socket.io-client-swift/pull/643. ",
    "danipralea": "@rpwilsonrph the header file is automatically generated. See http://swiftoverload.com/using-swift-in-your-objective-c-project/\n. I have the same issue\n. That's the .m file I have the screenshot for.\nAnd yes, I have imported the Gogogab-Swift.h file into the .m file of my Service Singleton.\nThank you for your quick response.\nAttaching here a full overview of the beginning of my .m file:\n\n. Yes, I forgot to say that I copied the files directly.\n. I did. Now I have 'Receiver 'SocketIOClient' for class message is a forward declaration'.\n\nEDIT: There is no bridging header you mentioned in the project files.\n\n. Thank you for clearance :+1: \n. ",
    "ninehundredt": "I have also been having issues with the disconnect function. How can I enable logging to investigate further? Thanks in advance. \n. Appreciate it! \n. ",
    "lucianocn": "@hanishabsigh I solved handling the socket in a singleton and disconnecting it when necessary. So it do not multiply the connections each connect.\n. @nuclearace the real issue is the #311.\nI thought it was a problem with version 5.4.x, but it is happening with all versions.\n. Just adding a NSThread sleepForTimeInterval, before the emit, it got working properly now.\nAny ideas?\n``` obj-c\nNSURL url = [[NSURL alloc] initWithString:SERVER_SOCKETIO_URL];\nSocketIOClient socket = [[SocketIOClient alloc] initWithSocketURL:url options:nil];\n[socket on:@\"connect\" callback:^(NSArray data, SocketAckEmitter ack) {\n    NSLog(@\"SocketIO: Connected.\");\n[NSThread sleepForTimeInterval:1.0];\nNSLog(@\"SocketIO: Joining room %@.\", [Authenticator getUnitID]);\n[socket emit:@\"joinRoom\" withItems:@[@{@\"room\": @\"14\"}]];\n\n}];\n```\n. I'm using it as:\nobj-c\n@property (strong, nonatomic) SocketIOClient *socketIOClient;\nJust the first time it is not joining the room, but if I reconnect it is working fine\n(Adding the NSThread sleepForTimeInterval it is working well even in the first connection).\nobj-c\n2016-02-18 17:12:45.310 App[522:121799] <SocketIOClientSwift.SocketIOClient: 0x14d5c9e0>\n. Unsuccessful Joined Room (Log):\nobj-c\n2016-02-18 22:34:31.361 App[94874:6832969] LOG SocketIOClient: Adding handler for event: connect\n2016-02-18 22:34:31.361 App[94874:6832969] LOG SocketIOClient: Adding engine\n2016-02-18 22:34:31.362 App[94874:6832969] LOG SocketEngine: Starting engine\n2016-02-18 22:34:31.363 App[94874:6832969] LOG SocketEngine: Handshaking\n2016-02-18 22:34:31.363 App[94874:6832969] LOG SocketEnginePolling: Doing polling request\n2016-02-18 22:34:32.066 App[94874:6833167] LOG SocketEnginePolling: Got polling response\n2016-02-18 22:34:32.068 App[94874:6833148] LOG SocketEngine: Got message: 0{\"sid\":\"XHNdScM_ZAL-XbbUAAFr\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2016-02-18 22:34:32.070 App[94874:6833148] LOG SocketEnginePolling: Doing polling request\n2016-02-18 22:34:32.250 App[94874:6833159] LOG SocketEnginePolling: Got polling response\n2016-02-18 22:34:32.251 App[94874:6833148] LOG SocketEngine: Got message: 40\n2016-02-18 22:34:32.251 App[94874:6833148] LOG SocketIOClient: Should parse message: 0\n2016-02-18 22:34:32.252 App[94874:6833148] LOG SocketParser: Parsing 0\n2016-02-18 22:34:32.252 App[94874:6833148] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2016-02-18 22:34:32.252 App[94874:6833159] LOG SocketEnginePolling: Doing polling request\n2016-02-18 22:34:32.253 App[94874:6833148] LOG SocketIOClient: Socket connected\n2016-02-18 22:34:32.254 App[94874:6833148] LOG SocketIOClient: Handling event: connect with data: (\n)\n2016-02-18 22:34:32.317 App[94874:6833159] LOG SocketIOClient: Emitting: 2[\"joinRoom\",{\"room\":14}]\n2016-02-18 22:34:32.318 App[94874:6833159] LOG SocketEngine: Writing poll: 2[\"joinRoom\",{\"room\":14}] has data: 0\n2016-02-18 22:34:32.319 App[94874:6833159] LOG SocketEnginePolling: Sending poll: 2[\"joinRoom\",{\"room\":14}] as type: 4\n2016-02-18 22:34:32.320 App[94874:6833159] LOG SocketEnginePolling: Created POST string: 26:42[\"joinRoom\",{\"room\":14}]\n2016-02-18 22:34:32.320 App[94874:6833159] LOG SocketEnginePolling: POSTing\n2016-02-18 22:34:32.321 App[94874:6833159] LOG SocketEnginePolling: Doing polling request\n2016-02-18 22:34:32.917 App[94874:6833151] LOG SocketEngine: Sending ws: probe as type: 2\n2016-02-18 22:34:33.073 App[94874:6833151] LOG SocketEngine: Got message: 3probe\n2016-02-18 22:34:33.073 App[94874:6833151] LOG SocketEngine: Upgrading transport to WebSockets\n2016-02-18 22:34:33.074 App[94874:6833151] LOG SocketEnginePolling: Sending poll:  as type: 6\n2016-02-18 22:34:33.175 App[94874:6833159] LOG SocketEnginePolling: Got polling response\n2016-02-18 22:34:33.176 App[94874:6833159] LOG SocketEngine: Sending ws:  as type: 5\n2016-02-18 22:34:33.176 App[94874:6833151] LOG SocketEngine: Got message: 6\n2016-02-18 22:34:33.176 App[94874:6833159] LOG SocketEngine: Flushing probe wait\n\nSuccessful Joined Room (Log):\nobj-c\n2016-02-18 22:37:43.694 App[95119:6839673] LOG SocketIOClient: Adding handler for event: connect\n2016-02-18 22:37:43.695 App[95119:6839673] LOG SocketIOClient: Adding engine\n2016-02-18 22:37:43.695 App[95119:6839673] LOG SocketEngine: Starting engine\n2016-02-18 22:37:43.695 App[95119:6839673] LOG SocketEngine: Handshaking\n2016-02-18 22:37:43.695 App[95119:6839673] LOG SocketEnginePolling: Doing polling request\n2016-02-18 22:37:44.389 App[95119:6839863] LOG SocketEnginePolling: Got polling response\n2016-02-18 22:37:44.390 App[95119:6839870] LOG SocketEngine: Got message: 0{\"sid\":\"_RC9uSfKcHL2IyXLAAFs\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2016-02-18 22:37:44.392 App[95119:6839870] LOG SocketEnginePolling: Doing polling request\n2016-02-18 22:37:44.552 App[95119:6839880] LOG SocketEnginePolling: Got polling response\n2016-02-18 22:37:44.553 App[95119:6839880] LOG SocketEnginePolling: Doing polling request\n2016-02-18 22:37:44.553 App[95119:6839866] LOG SocketEngine: Got message: 40\n2016-02-18 22:37:44.553 App[95119:6839866] LOG SocketIOClient: Should parse message: 0\n2016-02-18 22:37:44.554 App[95119:6839866] LOG SocketParser: Parsing 0\n2016-02-18 22:37:44.554 App[95119:6839866] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2016-02-18 22:37:44.555 App[95119:6839866] LOG SocketIOClient: Socket connected\n2016-02-18 22:37:44.555 App[95119:6839866] LOG SocketIOClient: Handling event: connect with data: (\n)\n2016-02-18 22:37:44.584 App[95119:6839877] LOG SocketIOClient: Emitting: 2[\"joinRoom\",{\"room\":14}]\n2016-02-18 22:37:44.584 App[95119:6839877] LOG SocketEngine: Writing poll: 2[\"joinRoom\",{\"room\":14}] has data: 0\n2016-02-18 22:37:44.585 App[95119:6839877] LOG SocketEnginePolling: Sending poll: 2[\"joinRoom\",{\"room\":14}] as type: 4\n2016-02-18 22:37:44.585 App[95119:6839877] LOG SocketEnginePolling: Created POST string: 26:42[\"joinRoom\",{\"room\":14}]\n2016-02-18 22:37:44.586 App[95119:6839877] LOG SocketEnginePolling: POSTing\n2016-02-18 22:37:44.586 App[95119:6839877] LOG SocketEnginePolling: Doing polling request\n2016-02-18 22:37:45.262 App[95119:6839866] LOG SocketEngine: Sending ws: probe as type: 2\n2016-02-18 22:37:45.445 App[95119:6839870] LOG SocketEngine: Got message: 3probe\n2016-02-18 22:37:45.445 App[95119:6839870] LOG SocketEngine: Upgrading transport to WebSockets\n2016-02-18 22:37:45.446 App[95119:6839870] LOG SocketEnginePolling: Sending poll:  as type: 6\n2016-02-18 22:37:45.446 App[95119:6839870] LOG SocketEnginePolling: Created POST string: 1:6\n2016-02-18 22:37:45.447 App[95119:6839870] LOG SocketEnginePolling: POSTing\n2016-02-18 22:37:45.447 App[95119:6839870] LOG SocketEnginePolling: Doing polling request\n2016-02-18 22:37:45.547 App[95119:6839876] LOG SocketEnginePolling: Got polling response\n2016-02-18 22:37:45.547 App[95119:6839876] LOG SocketEngine: Sending ws:  as type: 5\n2016-02-18 22:37:45.547 App[95119:6839870] LOG SocketEngine: Got message: 6\n2016-02-18 22:37:45.548 App[95119:6839876] LOG SocketEngine: Flushing probe wait\n. @nuclearace I'm sure that the server is not receiving the emit, because I track it with console.log:\n``` javascript\nvar server     = require('http').createServer(),\n    io         = require('socket.io')(server),\n    port       = 5000;\nconsole.log('SocketIO: listening on port %s', port);\nio.on('connection', function (socket){\n    console.log('SocketIO: Connected socket %s', socket.id);\nsocket.on('joinRoom', function (data) {\n    console.log('SocketIO: Joining room %s', data.room); // Not being called.\n    socket.join(data.room);\n});\n\nsocket.on('disconnect', function () {\n    console.log('SocketIO: Disconnected socket %s', socket.id);\n});\n\n});\nserver.listen(port);\n```\n\nUnsuccessful Joined Room (Log):\nsocketio-0 SocketIO: Connected socket /#aYQrslobWu84PAHkAAFw\n\nSuccessful Joined Room (Log):\nsocketio-0 SocketIO: Connected socket /#pioRHpdhzRaxJ7_fAAFv\nsocketio-0 SocketIO: Joining room 14\n. I confirmed the bug, here are the logs:\nWhen emit but server do not receive (very rare to occur):\niOS:\nobj-c\n2016-02-26 13:03:01.559 App[513:36960] LOG SocketIOClient: Adding handler for event: connect\n2016-02-26 13:03:01.559 App[513:36960] LOG SocketIOClient: Adding handler for event: line\n2016-02-26 13:03:01.560 App[513:36960] LOG SocketIOClient: Adding engine\n2016-02-26 13:03:01.562 App[513:36960] LOG SocketEngine: Starting engine\n2016-02-26 13:03:01.563 App[513:36960] LOG SocketEngine: Handshaking\n2016-02-26 13:03:01.563 App[513:36960] LOG SocketEnginePolling: Doing polling request\n2016-02-26 13:03:02.246 App[513:36997] LOG SocketEnginePolling: Got polling response\n2016-02-26 13:03:02.249 App[513:36995] LOG SocketEngine: Got message: 0{\"sid\":\"78LKHdguTTppk-v8AABA\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2016-02-26 13:03:02.259 App[513:36995] LOG SocketEnginePolling: Doing polling request\n2016-02-26 13:03:02.449 App[513:36995] LOG SocketEnginePolling: Got polling response\n2016-02-26 13:03:02.450 App[513:36995] LOG SocketEnginePolling: Doing polling request\n2016-02-26 13:03:02.455 App[513:36995] LOG SocketEngine: Got message: 40\n2016-02-26 13:03:02.456 App[513:36995] LOG SocketIOClient: Should parse message: 0\n2016-02-26 13:03:02.458 App[513:36995] LOG SocketParser: Parsing 0\n2016-02-26 13:03:02.461 App[513:36995] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2016-02-26 13:03:02.461 App[513:36995] LOG SocketIOClient: Socket connected\n2016-02-26 13:03:02.461 App[513:36995] LOG SocketIOClient: Handling event: connect with data: (\n)\n2016-02-26 13:03:02.906 App[513:37021] LOG SocketIOClient: Emitting: 2[\"joinRoom\",{\"room\":14}]\n2016-02-26 13:03:02.906 App[513:37012] LOG SocketEngine: Writing poll: 2[\"joinRoom\",{\"room\":14}] has data: 0\n2016-02-26 13:03:02.907 App[513:37012] LOG SocketEnginePolling: Sending poll: 2[\"joinRoom\",{\"room\":14}] as type: 4\n2016-02-26 13:03:02.908 App[513:37012] LOG SocketEnginePolling: Created POST string: 26:42[\"joinRoom\",{\"room\":14}]\n2016-02-26 13:03:02.909 App[513:37012] LOG SocketEnginePolling: POSTing\n2016-02-26 13:03:02.910 App[513:37012] LOG SocketEnginePolling: Doing polling request\n2016-02-26 13:03:03.177 App[513:37021] LOG SocketEngine: Sending ws: probe as type: 2\n2016-02-26 13:03:03.344 App[513:37021] LOG SocketEngine: Got message: 3probe\n2016-02-26 13:03:03.344 App[513:37021] LOG SocketEngine: Upgrading transport to WebSockets\n2016-02-26 13:03:03.345 App[513:37021] LOG SocketEnginePolling: Sending poll:  as type: 6\n2016-02-26 13:03:03.441 App[513:36995] LOG SocketEnginePolling: Got polling response\n2016-02-26 13:03:03.441 App[513:36995] LOG SocketEngine: Sending ws:  as type: 5\n2016-02-26 13:03:03.442 App[513:36995] LOG SocketEngine: Flushing probe wait\n2016-02-26 13:03:03.444 App[513:37012] LOG SocketEngine: Got message: 6\n---> 2016-02-26 13:03:27.261 App[513:37021] LOG SocketEngine: Writing ws:  has data: 0\n---> 2016-02-26 13:03:27.262 App[513:37021] LOG SocketEngine: Sending ws:  as type: 2\n---> 2016-02-26 13:03:27.479 App[513:37021] LOG SocketEngine: Got message: 3\n\nApp.js\njavascript\nengine intercepting request for path \"/socket.io/\" +11s\nengine handling \"GET\" http request \"/socket.io/?transport=polling&b64=1\" +0ms\nengine handshaking client \"78LKHdguTTppk-v8AABA\" +0ms\nengine:socket sending packet \"open\" ({\"sid\":\"78LKHdguTTppk-v8AABA\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}) +1ms\nengine:polling setting request +0ms\nengine:socket flushing buffer to transport +0ms\nengine:polling writing \"97:0{\"sid\":\"78LKHdguTTppk-v8AABA\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\" +0ms\nengine:socket executing batch send callback +0ms\nsocket.io:server incoming connection with id 78LKHdguTTppk-v8AABA +0ms\nsocket.io:client connecting to namespace / +0ms\nsocket.io:namespace adding socket to nsp / +2ms\nsocket.io:socket socket connected - writing packet +1ms\nsocket.io:socket joining room /#78LKHdguTTppk-v8AABA +0ms\nsocket.io:client writing packet {\"type\":0,\"nsp\":\"/\"} +7ms\nsocket.io-parser encoding packet {\"type\":0,\"nsp\":\"/\"} +0ms\nsocket.io-parser encoded {\"type\":0,\"nsp\":\"/\"} as 0 +0ms\nengine:socket sending packet \"message\" (0) +0ms\nSocketIO: Connected socket /#78LKHdguTTppk-v8AABA\nsocket.io:socket joined room /#78LKHdguTTppk-v8AABA +1ms\nengine intercepting request for path \"/socket.io/\" +172ms\nengine handling \"GET\" http request \"/socket.io/?transport=polling&b64=1&sid=78LKHdguTTppk-v8AABA\" +1ms\nengine setting new request for existing client +0ms\nengine:polling setting request +0ms\nengine:socket flushing buffer to transport +0ms\nengine:polling writing \"2:40\" +0ms\nengine:socket executing batch send callback +0ms\nengine intercepting request for path \"/socket.io/\" +188ms\nengine handling \"GET\" http request \"/socket.io/?transport=polling&b64=1&sid=78LKHdguTTppk-v8AABA\" +0ms\nengine setting new request for existing client +0ms\nengine:polling setting request +0ms\nengine upgrading existing transport +553ms\nengine:socket might upgrade socket transport from \"polling\" to \"websocket\" +1ms\nengine:ws received \"2probe\" +167ms\nengine:ws writing \"3probe\" +0ms\nengine:socket writing a noop packet to polling for fast upgrade +101ms\nengine:polling writing \"1:6\" +0ms\nengine:ws received \"5\" +163ms\nengine:socket got upgrade packet - upgrading +0ms\nengine:polling closing +0ms\nengine:polling transport discarded - closing right away +0ms\nengine intercepting request for path \"/socket.io/\" +15ms\nengine handling \"POST\" http request \"/socket.io/?transport=polling&b64=1&sid=78LKHdguTTppk-v8AABA\" +0ms\nengine bad request: unexpected transport without upgrade +0ms\nengine:ws received \"6\" +187ms\nengine:socket packet +0ms\n. When everything goes fine:\niOS:\nobj-c\n2016-02-26 13:06:27.717 App[518:37771] LOG SocketIOClient: Adding handler for event: connect\n2016-02-26 13:06:27.717 App[518:37771] LOG SocketIOClient: Adding handler for event: line\n2016-02-26 13:06:27.717 App[518:37771] LOG SocketIOClient: Adding engine\n2016-02-26 13:06:27.720 App[518:37771] LOG SocketEngine: Starting engine\n2016-02-26 13:06:27.720 App[518:37771] LOG SocketEngine: Handshaking\n2016-02-26 13:06:27.720 App[518:37771] LOG SocketEnginePolling: Doing polling request\n2016-02-26 13:06:28.403 App[518:37805] LOG SocketEnginePolling: Got polling response\n2016-02-26 13:06:28.407 App[518:37805] LOG SocketEngine: Got message: 0{\"sid\":\"Y42PJAfxZ-Cc5IxiAABB\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2016-02-26 13:06:28.415 App[518:37805] LOG SocketEnginePolling: Doing polling request\n2016-02-26 13:06:28.585 App[518:37816] LOG SocketEnginePolling: Got polling response\n2016-02-26 13:06:28.585 App[518:37816] LOG SocketEnginePolling: Doing polling request\n2016-02-26 13:06:28.587 App[518:37816] LOG SocketEngine: Got message: 40\n2016-02-26 13:06:28.587 App[518:37816] LOG SocketIOClient: Should parse message: 0\n2016-02-26 13:06:28.588 App[518:37816] LOG SocketParser: Parsing 0\n2016-02-26 13:06:28.590 App[518:37816] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2016-02-26 13:06:28.590 App[518:37816] LOG SocketIOClient: Socket connected\n2016-02-26 13:06:28.591 App[518:37816] LOG SocketIOClient: Handling event: connect with data: (\n)\n2016-02-26 13:06:28.873 App[518:37816] LOG SocketIOClient: Emitting: 2[\"joinRoom\",{\"room\":14}]\n2016-02-26 13:06:28.875 App[518:37816] LOG SocketEngine: Writing poll: 2[\"joinRoom\",{\"room\":14}] has data: 0\n2016-02-26 13:06:28.876 App[518:37816] LOG SocketEnginePolling: Sending poll: 2[\"joinRoom\",{\"room\":14}] as type: 4\n2016-02-26 13:06:28.876 App[518:37816] LOG SocketEnginePolling: Created POST string: 26:42[\"joinRoom\",{\"room\":14}]\n2016-02-26 13:06:28.876 App[518:37816] LOG SocketEnginePolling: POSTing\n2016-02-26 13:06:28.877 App[518:37816] LOG SocketEnginePolling: Doing polling request\n2016-02-26 13:06:29.259 App[518:37804] LOG SocketEngine: Sending ws: probe as type: 2\n2016-02-26 13:06:29.418 App[518:37816] LOG SocketEngine: Got message: 3probe\n2016-02-26 13:06:29.418 App[518:37816] LOG SocketEngine: Upgrading transport to WebSockets\n2016-02-26 13:06:29.419 App[518:37816] LOG SocketEnginePolling: Sending poll:  as type: 6\n2016-02-26 13:06:29.522 App[518:37802] LOG SocketEnginePolling: Got polling response\n2016-02-26 13:06:29.523 App[518:37802] LOG SocketEngine: Sending ws:  as type: 5\n2016-02-26 13:06:29.525 App[518:37802] LOG SocketEngine: Flushing probe wait\n2016-02-26 13:06:29.525 App[518:37816] LOG SocketEngine: Got message: 6\nApp.js:\njavascript\nsocket.io:socket joined room /#E1gExsEvG3szH054AABC +0ms\nengine intercepting request for path \"/socket.io/\" +196ms\nengine handling \"GET\" http request \"/socket.io/?transport=polling&b64=1&sid=E1gExsEvG3szH054AABC\" +0ms\nengine setting new request for existing client +1ms\nengine:polling setting request +0ms\nengine:socket flushing buffer to transport +0ms\nengine:polling writing \"2:40\" +0ms\nengine:socket executing batch send callback +0ms\nengine intercepting request for path \"/socket.io/\" +311ms\nengine handling \"GET\" http request \"/socket.io/?transport=polling&b64=1&sid=E1gExsEvG3szH054AABC\" +0ms\nengine setting new request for existing client +0ms\nengine:polling setting request +0ms\nengine upgrading existing transport +423ms\nengine:socket might upgrade socket transport from \"polling\" to \"websocket\" +0ms\nengine:ws received \"2probe\" +159ms\nengine:ws writing \"3probe\" +0ms\nengine:socket writing a noop packet to polling for fast upgrade +100ms\nengine:polling writing \"1:6\" +0ms\nengine intercepting request for path \"/socket.io/\" +17ms\nengine handling \"POST\" http request \"/socket.io/?transport=polling&b64=1&sid=E1gExsEvG3szH054AABC\" +0ms\nengine setting new request for existing client +1ms\nengine:polling received \"26:42[\"joinRoom\",{\"room\":14}]\" +0ms\nengine:socket packet +0ms\nsocket.io-parser decoded 2[\"joinRoom\",{\"room\":14}] as {\"type\":2,\"nsp\":\"/\",\"data\":[\"joinRoom\",{\"room\":14}]} +0ms\nsocket.io:socket got packet {\"type\":2,\"nsp\":\"/\",\"data\":[\"joinRoom\",{\"room\":14}]} +0ms\nsocket.io:socket emitting event [\"joinRoom\",{\"room\":14}] +0ms\nsocket.io:socket joining room 14 +0ms\nsocket.io:socket joined room 14 +1ms\nengine:ws received \"5\" +160ms\nengine:socket got upgrade packet - upgrading +0ms\nengine:polling closing +0ms\nengine:polling transport discarded - closing right away +0ms\nengine:ws received \"6\" +193ms\nengine:socket packet +0ms\n. PS: You can check that the iOS SocketIO log are different.\n. @nuclearace thanks for the quick answer ;)\n\nI tried @{@\"forcePolling\": @YES} and here is the received log:\n(Joined successfully in the room)\nApp.js:\njavascript\n  socket.io:socket joined room /#XhgT7F-W1sbYXLtpAABG +0ms\n  engine intercepting request for path \"/socket.io/\" +172ms\n  engine handling \"GET\" http request \"/socket.io/?transport=polling&b64=1&sid=XhgT7F-W1sbYXLtpAABG\" +0ms\n  engine setting new request for existing client +0ms\n  engine:polling setting request +0ms\n  engine:socket flushing buffer to transport +0ms\n  engine:polling writing \"2:40\" +0ms\n  engine:socket executing batch send callback +1ms\n  engine intercepting request for path \"/socket.io/\" +163ms\n  engine handling \"GET\" http request \"/socket.io/?transport=polling&b64=1&sid=XhgT7F-W1sbYXLtpAABG\" +0ms\n  engine setting new request for existing client +0ms\n  engine:polling setting request +1ms\n  engine intercepting request for path \"/socket.io/\" +913ms\n  engine handling \"POST\" http request \"/socket.io/?transport=polling&b64=1&sid=XhgT7F-W1sbYXLtpAABG\" +0ms\n  engine setting new request for existing client +0ms\n  engine:polling received \"26:42[\"joinRoom\",{\"room\":14}]\" +1ms\n  engine:socket packet +0ms\n  socket.io-parser decoded 2[\"joinRoom\",{\"room\":14}] as {\"type\":2,\"nsp\":\"/\",\"data\":[\"joinRoom\",{\"room\":14}]} +0ms\n  socket.io:socket got packet {\"type\":2,\"nsp\":\"/\",\"data\":[\"joinRoom\",{\"room\":14}]} +0ms\n  socket.io:socket emitting event [\"joinRoom\",{\"room\":14}] +0ms\n  socket.io:socket joining room 14 +1ms\n  socket.io:socket joined room 14 +0ms\n. @nuclearace any news on it?\n. @nuclearace alright! thanks!\n. @nuclearace this bug has been fixed?\nI was a little away from the project, so I jumped version 5.5.0 to 6.1.1 :P\n. Hi @tolgaytoklar,\nUnfortunately I moved my project to Firebase ;(\n. ",
    "EduardoAlberti": "The issue is intermittent, you have to call 'closeWithFast' in the same time when the socket is reconnecting. Also, don't use the 'start' button, instead, you have to restart the app in every try.\nRemember, the issue is presented on Mavericks only.\nHope this helps you.\n. Cool, thank you. \n. I have a similar behavior, but no need to call socket.disconnect(). What I'm doing to test is:\nI have a SocketIO server that restart every 5 Sec and this client connected to it. The behavior is:\n2016-08-22 11:27:30.878 socket reconnect\n2016-08-22 11:27:30.878  socket reconnectAttempt\n2016-08-22 11:27:32.284 socket error\n2016-08-22 11:27:34.178 socket reconnectAttempt\n2016-08-22 11:27:34.179  socket reconnectAttempt\n2016-08-22 11:27:35.088  socket connected\nAfter a few minutes of this behavior the client stops reconnecting and never connect again.\nHoping this helps to solve the issue.\n. ",
    "TalhaAkkas": "of course not but my api for example in server side expects given item to be a object not array so i need to send dictionary. so some body can be need it too\n. ",
    "Spriter": "I got the same problem as @lightsprint09. Any solution so far ?\nUpdate: There seems to be a problem with namespaces. Without namespaces its working well.\n. ",
    "ddreier": "That did it! I don't know why (yet), but it's working now. That's the great thing about working on a new platform. :P\n. ",
    "MihaelIsaev": "I have crash on this line too, and I catch it only in release mode and only on iPhone 4S iOS 8.1.4, on iPad Air iOS 8.1.4 and on simulators it works fine.\nprintln(bytes) //works fine\nprintln(bytes[0]) //crash\nHow to fix it?(\n. I fixed it by changing Swift compiler optimization level from Fastest to None\nBefore\n\nAfter\n\nIs it bad solution for production?\n. Compile app without optimization is really bad for release?\nYes, it looks like bug in Swift 1.2, but maybe we can find another way for this part of code which will work fine with Swift 1.2?\n. @jaykon I have no any performance problems in big application released to the AppStore since August 2015, so I think you can use this solution without any performance risk\n. Actually the same error with master branch\nMikes-Macbook-Pro:socket.io-client-swift-master mihael$ swift build\nFetching https://github.com/nuclearace/Starscream\nFetching https://github.com/daltoniam/zlib-spm.git\nFetching https://github.com/daltoniam/common-crypto-spm\nFetching https://github.com/IBM-Swift/CommonCrypto.git\nCloning https://github.com/daltoniam/zlib-spm.git\nResolving https://github.com/daltoniam/zlib-spm.git at 1.1.0\nCloning https://github.com/nuclearace/Starscream\nResolving https://github.com/nuclearace/Starscream at 8.0.2\nCloning https://github.com/IBM-Swift/CommonCrypto.git\nResolving https://github.com/IBM-Swift/CommonCrypto.git at 0.1.4\nCompile Swift Module 'StarscreamSocketIO' (3 sources)\n/Users/mihael/Downloads/socket.io-client-swift-master/.build/checkouts/Starscream-7041816469376470600/Source/Compression.swift:30:8: error: no such module 'CZLib'\nimport CZLib\n   ^\n/Users/mihael/Downloads/socket.io-client-swift-master/.build/checkouts/Starscream-7041816469376470600/Source/Compression.swift:30:8: error: no such module 'CZLib'\nimport CZLib\n   ^\n/Users/mihael/Downloads/socket.io-client-swift-master/.build/checkouts/Starscream-7041816469376470600/Source/Compression.swift:30:8: error: no such module 'CZLib'\nimport CZLib\n   ^\n<unknown>:0: error: build had 1 command failures\nerror: exit(1): /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/swift-build-tool -f /Users/mihael/Downloads/socket.io-client-swift-master/.build/debug.yaml`\n\n@nuclearace Could you please help?. @nuclearace Yeah it works in 11.1.1, thanks!\nIt would be great if you could fix it in swift4 branch as well.. ",
    "stephensilber": "Not sure if this is related, but I have a user that gets this crash but only when they are on a wifi network:\nThread : Crashed: com.apple.root.default-qos\n0  Socket_IO_Client_Swift         0x000000010046679c function signature specialization <Arg[0] = Exploded, Arg[1] = Exploded, Arg[2] = Owned To Guaranteed> of Socket_IO_Client_Swift.WebSocket.(processHTTP in _36A71CEA378D31C7E60930417F41D52F) (Socket_IO_Client_Swift.WebSocket)(Swift.UnsafePointer<Swift.UInt8>, bufferLen : Swift.Int) -> Swift.Bool (WebSocket.swift:383)\n1  Socket_IO_Client_Swift         0x00000001004652ac function signature specialization <Arg[0] = Owned To Guaranteed> of Socket_IO_Client_Swift.WebSocket.(processInputStream in _36A71CEA378D31C7E60930417F41D52F) (Socket_IO_Client_Swift.WebSocket)() -> () (WebSocket.swift:321)\n2  Socket_IO_Client_Swift         0x0000000100464a08 function signature specialization <Arg[0] = Owned To Guaranteed, Arg[1] = Exploded, Arg[2] = Owned To Guaranteed> of Socket_IO_Client_Swift.WebSocket.stream (Socket_IO_Client_Swift.WebSocket)(ObjectiveC.NSStream, handleEvent : C.NSStreamEvent) -> () (WebSocket.swift:286)\n3  Socket_IO_Client_Swift         0x0000000100460938 @objc Socket_IO_Client_Swift.WebSocket.stream (Socket_IO_Client_Swift.WebSocket)(ObjectiveC.NSStream, handleEvent : C.NSStreamEvent) -> () (WebSocket.swift)\n4  CoreFoundation                 0x0000000182d3c070 _signalEventSync + 192\n5  CoreFoundation                 0x0000000182d48e88 _cfstream_solo_signalEventSync + 236\n6  CoreFoundation                 0x0000000182d3bb88 _CFStreamSignalEvent + 480\n7  CFNetwork                      0x000000018270e8a0 SocketStream::dispatchSignalFromSocketCallbackUnlocked(SocketStreamSignalHolder*) + 64\n8  CFNetwork                      0x000000018270e418 SocketStream::socketCallback(__CFSocket*, unsigned long, __CFData const*, void const*) + 216\n9  CFNetwork                      0x000000018270e2fc SocketStream::_SocketCallBack_stream(__CFSocket*, unsigned long, __CFData const*, void const*, void*) + 88\n10 CoreFoundation                 0x0000000182d9f530 __CFSocketPerformV0 + 668\n11 CoreFoundation                 0x0000000182d9c240 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + 24\n12 CoreFoundation                 0x0000000182d9b4e4 __CFRunLoopDoSources0 + 264\n13 CoreFoundation                 0x0000000182d99594 __CFRunLoopRun + 712\n14 CoreFoundation                 0x0000000182cc52d4 CFRunLoopRunSpecific + 396\n15 Foundation                     0x0000000183bfd4c8 -[NSRunLoop(NSRunLoop) runMode:beforeDate:] + 316\n16 Socket_IO_Client_Swift         0x0000000100464588 function signature specialization <Arg[0] = Owned To Guaranteed, Arg[1] = Exploded, Arg[2] = Owned To Guaranteed> of Socket_IO_Client_Swift.WebSocket.(initStreamsWithData in _36A71CEA378D31C7E60930417F41D52F) (Socket_IO_Client_Swift.WebSocket)(ObjectiveC.NSData, Swift.Int) -> () (WebSocket.swift:264)\n17 Socket_IO_Client_Swift         0x0000000100463b34 function signature specialization <Arg[0] = Owned To Guaranteed> of Socket_IO_Client_Swift.WebSocket.(createHTTPRequest in _36A71CEA378D31C7E60930417F41D52F) (Socket_IO_Client_Swift.WebSocket)() -> () (WebSocket.swift:205)\n18 Socket_IO_Client_Swift         0x000000010045f7ec partial apply forwarder for Socket_IO_Client_Swift.WebSocket.(connect (Socket_IO_Client_Swift.WebSocket) -> () -> ()).(closure #2) (WebSocket.swift:141)\n19 libdispatch.dylib              0x00000001950d5994 _dispatch_call_block_and_release + 24\n20 libdispatch.dylib              0x00000001950d5954 _dispatch_client_callout + 16\n21 libdispatch.dylib              0x00000001950e2780 _dispatch_root_queue_drain + 1848\n22 libdispatch.dylib              0x00000001950e3c4c _dispatch_worker_thread3 + 108\n23 libsystem_pthread.dylib        0x00000001952b522c _pthread_wqthread + 816\nWebSocket.swift - line 383\n. hard to say for sure, but after letting our tests run longer than usual, we didn't get any errors. We generally got 5+ errors in that time period. Appreciate the quick reply/fix!\n. yeah, after updating to 2.4.3 it seems to be fixed\n. I had the same problem and temporarily worked around it by disabled \"forceWebsockets\" which I previously had set to true for a different issue with the socket.io library\n. ",
    "ArfanMirza": "@MihaelIsaev  thanks.. that is work for me too....\n. Please fix this.. my application is crashing after updates\n. No.. it is Objective-C.. \n. Actually, i already using socket.io library, that is working fine with http://domain.com, but if i change the port to 8080 (or any other) from default 80, then this is not connecting, after fighting with code, i think may be i need to update socket.io library, and i did.. After update library, this and other crash (post separately) started. \n. I update yesterday, so it is latest version.\n. No, I am using Xcode_6.4\n. This crash log track by fabric/crashlytics sdk.\n. Yes, when image send or receive...\n. ohh Great.. let me try that..\n. Thread : Crashed: com.apple.root.default-qos\n0  StudyMile                      0x001392b8 function signature specialization  of StudyMile.WebSocket.(processRawMessage in 9DCBBF7F97B0B8012CDCF2EE28EA7D1E) (StudyMile.WebSocket)(Swift.UnsafePointer, bufferLen : Swift.Int) -> () (WebSocket.swift:491)\n1  StudyMile                      0x00137d2c function signature specialization  of StudyMile.WebSocket.(processRawMessage in _9DCBBF7F97B0B8012CDCF2EE28EA7D1E) (StudyMile.WebSocket)(Swift.UnsafePointer, bufferLen : Swift.Int) -> () (WebSocket.swift)\n2  StudyMile                      0x001366c8 function signature specialization  of StudyMile.WebSocket.(processInputStream in _9DCBBF7F97B0B8012CDCF2EE28EA7D1E) (StudyMile.WebSocket)() -> () (WebSocket.swift:349)\n3  StudyMile                      0x00135af0 function signature specialization  of StudyMile.WebSocket.stream (StudyMile.WebSocket)(ObjectiveC.NSStream, handleEvent : C.NSStreamEvent) -> () (WebSocket.swift:286)\n4  StudyMile                      0x00131504 @objc StudyMile.WebSocket.stream (StudyMile.WebSocket)(ObjectiveC.NSStream, handleEvent : C.NSStreamEvent) -> () (WebSocket.swift)\n5  CoreFoundation                 0x24e4e207 _signalEventSync + 146\n6  CoreFoundation                 0x24e58631 _cfstream_solo_signalEventSync + 204\n7  CoreFoundation                 0x24e4de93 _CFStreamSignalEvent + 326\n8  CFNetwork                      0x2490fb05 SocketStream::dispatchSignalFromSocketCallbackUnlocked(SocketStreamSignalHolder) + 40\n9  CFNetwork                      0x2490f7f1 SocketStream::socketCallback(CFSocket_, unsigned long, __CFData const_, void const_) + 148\n10 CFNetwork                      0x2490f727 SocketStream::SocketCallBack_stream(__CFSocket, unsigned long, __CFData const_, void const_, void_) + 58\n11 CoreFoundation                 0x24ea089b __CFSocketPerformV0 + 554\n12 CoreFoundation                 0x24e9dfaf __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION + 14\n13 CoreFoundation                 0x24e9d3bf __CFRunLoopDoSources0 + 218\n14 CoreFoundation                 0x24e9ba25 __CFRunLoopRun + 772\n15 CoreFoundation                 0x24de8201 CFRunLoopRunSpecific + 476\n16 CoreFoundation                 0x24de8013 CFRunLoopRunInMode + 106\n17 Foundation                     0x25b5213d -[NSRunLoop(NSRunLoop) runMode:beforeDate:] + 264\n18 StudyMile                      0x001355b4 function signature specialization  of StudyMile.WebSocket.(initStreamsWithData in _9DCBBF7F97B0B8012CDCF2EE28EA7D1E) (StudyMile.WebSocket)(ObjectiveC.NSData, Swift.Int) -> () (WebSocket.swift:264)\n19 StudyMile                      0x00134914 function signature specialization  of StudyMile.WebSocket.(createHTTPRequest in _9DCBBF7F97B0B8012CDCF2EE28EA7D1E) (StudyMile.WebSocket)() -> () (WebSocket.swift:205)\n20 StudyMile                      0x001301e0 partial apply forwarder for StudyMile.WebSocket.(connect (StudyMile.WebSocket) -> () -> ()).(closure #2) (WebSocket.swift:141)\n21 libdispatch.dylib              0x33af42e3 _dispatch_call_block_and_release + 10\n22 libdispatch.dylib              0x33afe381 _dispatch_root_queue_drain + 1388\n23 libdispatch.dylib              0x33aff3c3 _dispatch_worker_thread3 + 94\n24 libsystem_pthread.dylib        0x33c5bdc1 _pthread_wqthread + 668\n25 libsystem_pthread.dylib        0x33c5bb14 start_wqthread + 8\n. any solution for this?\n. Got a warning email from project.. Please guide me or fix this asap..\nWhen i transfer image from web to ios, this crash occur\n. Actually, i already using socket.io library, that is working fine with http://domain.com, but if i change the port to 8080 (or any other) from default 80, then this is not connecting, after fighting with code, i think may be i need to update socket.io library, and i did.. After update library, this and other crash (post separately) started.\n. **Transfer image in Base64Data form. \n. ",
    "stewa": "With the current master branch this crashes for me too on 32 bit hardware with apps build in Release mode.\n. ",
    "jaykon": "the same problem in Swift 2.0 + Xcode 7.\n@MihaelIsaev 's way work,but i can't confirm if it have any performance problem.\n. i have the same problem when using cocoapod.\nbut everything is fine when i just download zip from github and copy files to my project.. i found\npod 'Socket.IO-Client-Swift', '~> 9.0.1' ,\nis for swift 3,Build settings set 3.1 is ok\n (so there is something wrong in 1.0-swift4 branch introduce)\nSo I try to install \"1.0-swift4 branch\"\nuse\npod 'Socket.IO-Client-Swift',:git=>'https://github.com/socketio/socket.io-client-swift',:branch=>'1.0-swift4'\nbut it is not success\uff0cresult in pod install error:\nPre-downloading: Socket.IO-Client-Swift from https://github.com/socketio/socket.io-client-swift, branch 1.0-swift4\n[!] Failed to load 'Socket.IO-Client-Swift' podspec: \n[!] Invalid Socket.IO-Client-Swift.podspec file: undefined method `swift_version=' for #.\n#  from /var/folders/cl/45yr1pn905qgbzg2dkh76j4r0000gn/T/d20190227-26910-9mg1i5/Socket.IO-Client-Swift.podspec:20\n #  -------------------------------------------\n #    s.requires_arc = true\n\ns.swift_version = \"4.2\"\n #\n #  -------------------------------------------. i  clean each time.\nyou can see tag v9.0.1 file:\nSocket.IO-Client-Swift.podspec\nis for swift 3.1\n\nin branch \"1.0-swift4\" ,introduction  still show me to use\npod 'Socket.IO-Client-Swift', '~> 9.0.1' \nis wrong\uff0cbecause it is tag v9.0.1\uff0cfor swift 3.1. ",
    "sasavranic": "I have this problem too. Latest socket.io library. iPod touch device. On iPhone 6 work ok\n. With: \n   pod 'Socket.IO-Client-Swift', '~> 3.1.4'\nI have not this problems, now I'm using latest 4 version\n. One more thing, only when I change scheme to Release instead of Debug.\nWith Debug scheme work correctly\n. Optimisation is already set to NONE for DEBUG and RELEASE\n. Ahhh, my bad!\nPods / Socket.io lib, optimisation must be set to NONE. Not enough to set only for main project.\n. Yes it's weird.\nAs I said, if I'm running single socket.io behind nginx etc... I have got disconnect too. Work perfect.\n. Can we have some error handler, so when unknown session appear to do a socket.reconnect()?\n. I will check tomorrow with 3 servers, now only 1 server work and haproxy and still nothing, but there is a small difference. Check log\n```\n2015-11-19 17:44:46.312 yovsno[3847:2951362] Log SocketEngine: Got polling response\n2015-11-19 17:44:46.313 yovsno[3847:2951362] Log SocketEngine: Doing polling request\n2015-11-19 17:44:46.316 yovsno[3847:2951362] Log SocketEngine: Got message: \n502 Bad Gateway\n\n502 Bad Gateway\nnginx/1.4.6 (Ubuntu)\n\n\n2015-11-19 17:44:46.317 yovsno[3847:2951362] ERROR SocketEngine: Got message: \n502 Bad Gateway\n\n502 Bad Gateway\nnginx/1.4.6 (Ubuntu)\n\n\n2015-11-19 17:44:46.317 yovsno[3847:2951362] Log SocketIOClient: Handling event: reconnect with data: (\n    Disconnect\n)\nSIO secure socket reconnect\nSIO reconnect data [Disconnect]\n2015-11-19 17:44:46.320 yovsno[3847:2951362] Log SocketIOClient: Starting reconnect\n2015-11-19 17:44:49.453 yovsno[3847:2951379] Log SocketEngine: Got polling response\n2015-11-19 17:44:49.454 yovsno[3847:2951379] Log SocketEngine: Doing polling request\n2015-11-19 17:44:49.457 yovsno[3847:2951379] Log SocketEngine: Got message: \n502 Bad Gateway\n\n502 Bad Gateway\nnginx/1.4.6 (Ubuntu)\n\n\n2015-11-19 17:44:49.458 yovsno[3847:2951379] ERROR SocketEngine: Got message: \n502 Bad Gateway\n\n502 Bad Gateway\nnginx/1.4.6 (Ubuntu)\n\n\n2015-11-19 17:44:51.616 yovsno[3847:2951301] Log SocketEngine: Got polling response\n2015-11-19 17:44:51.617 yovsno[3847:2951301] Log SocketEngine: Doing polling request\n2015-11-19 17:44:51.620 yovsno[3847:2951301] Log SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2015-11-19 17:44:51.620 yovsno[3847:2951301] ERROR SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2015-11-19 17:44:51.668 yovsno[3847:2951362] Log SocketEngine: Got polling response\n2015-11-19 17:44:51.669 yovsno[3847:2951362] Log SocketEngine: Doing polling request\n2015-11-19 17:44:51.670 yovsno[3847:2951362] Log SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2015-11-19 17:44:51.673 yovsno[3847:2951362] ERROR SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2015-11-19 17:44:51.721 yovsno[3847:2951301] Log SocketEngine: Got polling response\n2015-11-19 17:44:51.722 yovsno[3847:2951301] Log SocketEngine: Doing polling request\n2015-11-19 17:44:51.723 yovsno[3847:2951379] Log SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2015-11-19 17:44:51.723 yovsno[3847:2951379] ERROR SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n....\n2015-11-19 17:44:56.324 yovsno[3847:2951268] Log SocketIOClient: Trying to reconnect\n2015-11-19 17:44:56.325 yovsno[3847:2951268] Log SocketIOClient: Handling event: reconnectAttempt with data: (\n    \"-1\"\n)\n2015-11-19 17:44:56.326 yovsno[3847:2951268] Log SocketIOClient: Adding engine\n2015-11-19 17:44:56.328 yovsno[3847:2951268] Log SocketEngine: Starting engine\n2015-11-19 17:44:56.329 yovsno[3847:2951268] Log SocketEngine: Handshaking\n2015-11-19 17:44:56.329 yovsno[3847:2951268] Log SocketEngine: Doing polling request\nSIO reconnectAttempt data [-1]\n2015-11-19 17:44:56.350 yovsno[3847:2951362] Log SocketEngine: Got polling response\n2015-11-19 17:44:56.351 yovsno[3847:2951362] Log SocketEngine: Doing polling request\n2015-11-19 17:44:56.352 yovsno[3847:2951388] Log SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2015-11-19 17:44:56.353 yovsno[3847:2951388] ERROR SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2015-11-19 17:44:56.354 yovsno[3847:2951388] Log SocketIOClient: Handling event: reconnect with data: (\n    Disconnect\n)\nSIO secure socket reconnect\nSIO reconnect data [Disconnect]\n2015-11-19 17:44:56.407 yovsno[3847:2951362] Log SocketEngine: Got polling response\n2015-11-19 17:44:56.407 yovsno[3847:2951362] Log SocketEngine: Doing polling request\n2015-11-19 17:44:56.415 yovsno[3847:2951388] Log SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2015-11-19 17:44:56.415 yovsno[3847:2951388] ERROR SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2015-11-19 17:44:56.443 yovsno[3847:2951388] Log SocketEngine: Got polling response\n2015-11-19 17:44:56.448 yovsno[3847:2951301] Log SocketEngine: Got message: 0{\"sid\":\"eqd2x-sP3PiNPxzQAAAA\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2015-11-19 17:44:56.450 yovsno[3847:2951301] Log SocketEngine: Doing polling request\n2015-11-19 17:44:56.462 yovsno[3847:2951362] Log SocketEngine: Got polling response\n2015-11-19 17:44:56.463 yovsno[3847:2951362] Log SocketEngine: Doing polling request\n2015-11-19 17:44:56.465 yovsno[3847:2951362] Log SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2015-11-19 17:44:56.466 yovsno[3847:2951362] ERROR SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2015-11-19 17:44:56.649 yovsno[3847:2951301] ERROR SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2015-11-19 17:44:56.667 yovsno[3847:2951362] Log SocketEngine: Got polling response\n2015-11-19 17:44:56.668 yovsno[3847:2951362] Log SocketEngine: Doing polling request\n2015-11-19 17:44:56.671 yovsno[3847:2951362] Log SocketEngine: Got message: 40/secure\n2015-11-19 17:44:56.671 yovsno[3847:2951362] Log SocketParser: Parsing 0/secure\n2015-11-19 17:44:56.672 yovsno[3847:2951362] Log SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: -1; nsp: /secure}\n2015-11-19 17:44:56.674 yovsno[3847:2951362] Log SocketIOClient: Socket connected\n2015-11-19 17:44:56.675 yovsno[3847:2951362] Log SocketIOClient: Handling event: connect with data: (\n)\nSIO []\nSIO secure socket connected   <<<<<< I'm connected again!!!!\n2015-11-19 17:44:56.703 yovsno[3847:2951362] Log SocketEngine: Got polling response\n2015-11-19 17:44:56.706 yovsno[3847:2951301] Log SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2015-11-19 17:44:56.707 yovsno[3847:2951301] ERROR SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2015-11-19 17:44:56.707 yovsno[3847:2951301] Log SocketIOClient: Handling event: reconnect with data: (\n    Disconnect\n)\n2015-11-19 17:44:56.708 yovsno[3847:2951301] Log SocketIOClient: Starting reconnect\n2015-11-19 17:44:56.713 yovsno[3847:2951362] Log SocketEngine: Doing polling request\n2015-11-19 17:44:56.766 yovsno[3847:2951407] Log SocketEngine: Got polling response\n2015-11-19 17:44:56.767 yovsno[3847:2951407] Log SocketEngine: Doing polling request\n2015-11-19 17:44:56.768 yovsno[3847:2951362] Log SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2015-11-19 17:44:56.771 yovsno[3847:2951362] ERROR SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\nSIO secure socket reconnect\nSIO reconnect data [Disconnect]\n2015-11-19 17:44:56.831 yovsno[3847:2951362] Log SocketEngine: Got polling response\n.....\nand so on\n```\nand after 15 seconds I'm again connected on device, but on server I have 30 connections to socket :)\n. and is always reconnectAttempt -1, not moving to -2, -3...\nWhen I move to single socket server, this version working good, and this is output from log on disconnect/connect\n2015-11-19 18:06:15.530 yovsno[3860:2954800] Log SocketIOClient: Handling event: reconnect with data: (\n    \"Socket Disconnected\"\n)\nSIO secure socke2015-11-19 18:06:15.531 yovsno[3860:2954800] Log SocketIOClient: Starting reconnect\nt reconnect\nSIO reconnect data [Socket Disconnected]\n2015-11-19 18:06:25.536 yovsno[3860:2954718] Log SocketIOClient: Trying to reconnect\n2015-11-19 18:06:25.537 yovsno[3860:2954718] Log SocketIOClient: Handling event: reconnectAttempt with data: (\n    \"-1\"\n)\n2015-11-19 18:06:25.538 yovsno[3860:2954718] Log SocketIOClient: Adding engine\n2015-11-19 18:06:25.540 yovsno[3860:2954718] Log SocketEngine: Engine is being deinit\n2015-11-19 18:06:25.541 yovsno[3860:2954718] Log SocketEngine: Starting engine\n2015-11-19 18:06:25.541 yovsno[3860:2954718] Log SocketEngine: Handshaking\n2015-11-19 18:06:25.543 yovsno[3860:2954718] Log SocketEngine: Doing polling request\nSIO reconnectAttempt data [-1]\n2015-11-19 18:06:25.782 yovsno[3860:2954752] ERROR SocketIOClient: Could not connect to the server.\n2015-11-19 18:06:25.782 yovsno[3860:2954752] Log SocketIOClient: Handling event: error with data: (\n    \"Could not connect to the server.\"\n)\nSIO secure socket error Could not connect to t2015-11-19 18:06:25.783 yovsno[3860:2954752] Log SocketIOClient: Handling event: reconnect with data: (\n    \"Could not connect to the server.\"\n)\nhe server.\nSIO secure socket reconnect\nSIO reconnect data [Could not connect to the server.]\n2015-11-19 18:06:35.536 yovsno[3860:2954718] Log SocketIOClient: Trying to reconnect\n2015-11-19 18:06:35.537 yovsno[3860:2954718] Log SocketIOClient: Handling event: reconnectAttempt with data: (\n    \"-2\"\n)\n2015-11-19 18:06:35.538 yovsno[3860:2954718] Log SocketIOClient: Adding engine\n2015-11-19 18:06:35.540 yovsno[3860:2954718] Log SocketEngine: Engine is being deinit\n2015-11-19 18:06:35.540 yovsno[3860:2954718] Log SocketEngine: Starting engine\n2015-11-19 18:06:35.540 yovsno[3860:2954718] Log SocketEngine: Handshaking\n2015-11-19 18:06:35.541 yovsno[3860:2954718] Log SocketEngine: Doing polling request\nSIO reconnectAttempt data [-2]\nSIO showing offline view\n2015-11-19 18:06:35.647 yovsno[3860:2954802] ERROR SocketIOClient: Could not connect to the server.\n2015-11-19 18:06:35.648 yovsno[3860:2954802] Log SocketIOClient: Handling event: error with data: (\n    \"Could not connect to the server.\"\n)\nSIO secure socket error Could not connect to the server.\n2015-11-19 18:06:35.650 yovsno[3860:2954802] Log SocketIOClient: Handling event: reconnect with data: (\n    \"Could not connect to the server.\"\n)\nSIO secure socket reconnect\nSIO reconnect data [Could not connect to the server.]\n2015-11-19 18:06:45.536 yovsno[3860:2954718] Log SocketIOClient: Trying to reconnect\n2015-11-19 18:06:45.537 yovsno[3860:2954718] Log SocketIOClient: Handling event: reconnectAttempt with data: (\n    \"-3\"\n)\n2015-11-19 18:06:45.538 yovsno[3860:2954718] Log SocketIOClient: Adding engine\n2015-11-19 18:06:45.539 yovsno[3860:2954718] Log SocketEngine: Engine is being deinit\n2015-11-19 18:06:45.540 yovsno[3860:2954718] Log SocketEngine: Starting engine\n2015-11-19 18:06:45.541 yovsno[3860:2954718] Log SocketEngine: Handshaking\n2015-11-19 18:06:45.542 yovsno[3860:2954718] Log SocketEngine: Doing polling request\nSIO reconnectAttempt data [-3]\n. No\n. Problem solved on server side, nginx was bad configured.\nAbout haproxy and 3 node servers, all servers must have \"socket.io-redis\" library installed. This library is important for sharing Session ID on broken connections.\n. Test case: \n1) We are connected to socket and we are going into background (close app)\n2) We turning off socket on server\n3) We opening app again (app goes into foreground)\nhere is a log\n```\n2015-12-02 09:16:55.735 yovsno[2717:1096148] Log SocketIOClient: Closing socket\n2015-12-02 09:16:55.736 yovsno[2717:1096148] Log SocketIOClient: Disconnected: Closed\n2015-12-02 09:16:55.736 yovsno[2717:1096148] Log SocketEngine: Engine is being closed.\n2015-12-02 09:16:55.737 yovsno[2717:1096148] Log SocketEngine: Sending ws:  as type: 1\n2015-12-02 09:16:55.738 yovsno[2717:1096148] Log SocketIOClient: Handling event: disconnect with data: (\n    Closed\n)\nSIO secure socket disconnect 'Closed'   <<<<<<<< app is in background, socket disconnected\n\n\n\nnow we opening app, connecting to socket\n\n\n\n2015-12-02 09:17:08.550 yovsno[2717:1096148] Log SocketIOClient: Adding engine\n2015-12-02 09:17:08.550 yovsno[2717:1096148] Log SocketEngine: Engine is being deinit\n2015-12-02 09:17:08.552 yovsno[2717:1096148] Log SocketEngine: Starting engine\n2015-12-02 09:17:08.553 yovsno[2717:1096148] Log SocketEngine: Handshaking\n2015-12-02 09:17:08.554 yovsno[2717:1096148] Log SocketEngine: Doing polling request\n2015-12-02 09:17:12.080 yovsno[2717:1097844] Log SocketEngine: Got polling response\n2015-12-02 09:17:12.082 yovsno[2717:1097841] Log SocketEngine: Got message: 503 Service Unavailable\nNo server is available to handle this request.\n\nand now socket library is dead! no more activity \n```\nNow, I implement this hack in function doLongPool() and after that ERROR event is sent to library as regular  \n```\nvar htmlError: Bool = false\nlet dataString: String! = String(data: data!, encoding: NSUTF8StringEncoding)\n     if dataString != nil && dataString.rangeOfString(\"\") != nil {\n        htmlError = true\n     }\n if err != nil || data == nil || htmlError == true {\n      // handle error\n\n```\nIt's very strange because in this situation \"err\" is nil.\n. Tell me, is branch \"engine-refactoring\" safe to checkout for production or it's in progress yet\n. Ok, I forked branch this morning ... we will see\n. ",
    "tundeoa": "I'm on Xcode 6.0.1\n. ",
    "Beck-Sisyphus": "Hi  nuclearance,\nThanks for the reply. I've changed to :8080, and move the socket to ViewDidLoad. This new line appears:\n\nGot event: connect, with items: nil\n\nSometimes it is error message:\n\nGot event: reconnect, with items: Optional((\n    \"connection closed by server\"\n))\nGot event: reconnectAttempt, with items: Optional((\n    \"-1\"\n))\n\nBut all my emit functions are still not working yet. Can I say the connection is established?\nTried earlier version of Xcode (6.3) but same result appears. \n. I tried, but no ack comes back still. \n''''\nsocket.on(\"connect\") {data, ack in\n            print(\"socket connected\")\n            print(data)\n            print(ack)\n        }\n''''\nIs there any environment setup I should look into?\n. @nuclearace Good call. I'm calling my teammate to add a callback to respond to me. So can you tell if the connection is on after I call socket.connect() ?\n. I realize that there are multiple forms of emit in socketIO, so I wonder if a JSON file is needed, or I should pass parameters separately to emit? I changed my client side a bit:\nserver side:\n```\n   soc.on(\"fb_login\", function(req, cb) {\n      var fb_token = req.fb_token || null;\n      var fb_id = req.fb_id || null;\n      var user_id = req.user_id || null;\n  if (!fb_token || !fb_id) {\n      console.error(\"[fb_login] No fb_token or fb_id provided\");\n      return cb({status: false});\n  }\n\n}\n```\nclient side:\nsocket.emitWithAck(\"fb_login\",\n            [\"fb_token\"  :  FBSDKAccessToken.currentAccessToken().tokenString],\n            [\"fb_id\"     :  FBSDKAccessToken.currentAccessToken().userID],\n            [\"user_id\"   :  \"beck\"]) (timeout: 4) { data in\n            print(data)\n        }\n. I realize there is no need to create a JSON file by ourselves, socket IO handles that for you. Just pass in a dictionary and it will be good.\nreference: http://socket.io/blog/socket-io-on-ios/#sending-json\n. My server side is asking if he decodes JSON emit correctly; if not, what is the correct syntax to write?\nsoc.on(\"fb_login\", function(req, cb) {\n      var fb_token = req.fb_token || null;\n      var fb_id = req.fb_id || null;\n      var user_id = req.user_id || null;\nif (!fb_token || !fb_id) {\n      console.error(\"[fb_login] No fb_token or fb_id provided\");\n      return cb({status: false});\n  }\n}\n. I should say in this way. In the Node.js, how to read a JSON key and extract the value afterwards\n. It's strange after I update to 2.4.0 for swift-2 branch it starts to crash. Here is my cocoapods profile and screen shot:\npod 'Socket.IO-Client-Swift', :git => \"https://github.com/socketio/socket.io-client-swift.git\", :branch => \"swift-2\"\n\n. ",
    "JAManfredi": "Im not 100% sure why yet, but I couldn't connect using the library in Objective-C or Swift using the exact same example thats given in the README. After further investigation the deinit() for the client and then the engine was being called. After even further investigation I fixed this by changing the weak reference in the SocketEngine class to strong, ie. var client:SocketEngineClient? instead of weak var client:SocketEngineClient? \nHowever this doesn't make sense because it should theoretically cause a retain cycle having a strong reference from client to engine and back again, no? Instead it seems to be keeping the main object (SocketIOClient) instantiated which definitely shouldn't be happening in the first place. \nAny thoughts?\n. @nuclearace Thanks for the reply Erik. I understood what was going wrong as well as what removing the weak reference did, however why would the client be going out of scope? Im not so sure I completely see why this is happening though. I declared a property in the AppDelegate which is being used to control the connection. The 3rd party libraries worked fine like this, which Is why Im so confused I guess. Im sure theres something simple Im missing here. \n. Im having this same issue as well. \n. ",
    "gastonmorixe": "I can't connect neither under iOS 9. \nThe operation couldn\u2019t be completed. No such file or directory\n. @nuclearace thanks! Right now I just build everything over the swift API and consume my one from objc part. But yeah, it'd be great to have it working on objc directly. \n. @nuclearace I wish too but it is not that easy in real-world. :) thanks \n. I have specified to bypass it so far.\n. btw I am using swift 2 beta 5\n. Hi @nuclearace  I just decided to move to pusher because my client couldn't wait for this.\nI don't have much time TBH but I will try to help you out here.\nServer\n``` js\nvar io = require(\"socket.io\")(3001)\nvar socketioJwt = require(\"socketio-jwt\")\nio.use(socketioJwt.authorize({\n  secret: \"XXXXX\",\n  handshake: true\n}))\n```\niOS\n``` swift\nimport Foundation\npublic class STMeetingWebsockets: NSObject {\nlet socket: SocketIOClient = {\n    var error: NSError?\n    let authToken = \"XXXX\"\n    return SocketIOClient(socketURL: XXXXX, opts: [\"connectParams\" : [\"token\": (authToken ?? \" \")] ])\n}()\n\n@objc public func startOnConnect(onConnect: ((socket: SocketIOClient?) -> Void)?, onError: (Void -> Void)?) {\n\n    self.socket.on(\"connect\") { data, ack in\n        print(\"Socket.io connected \ud83d\udc4c\")\n\n        if let connectCallback = onConnect{\n            connectCallback(socket: self.socket)\n        }\n    }\n\n    self.socket.on(\"error\") { error in\n        print(\"Socket.io error \u2757\u2757\u2757\", error)\n\n        if let errorCallback = onError{\n            errorCallback()\n        }\n    }\n\n    socket.connect()\n\n}\n\n```\n. ",
    "Gopabandhu17": "@nuclearace \ngetting following error while calling connect() :-\n2019-02-25 16:26:36.081620+0530 DemoSocket[10289:198937] LOG SocketIOClient{/}: Handling event: error with data: [\"Could not connect to the server.\"]\nerror\n2019-02-25 16:26:38.000812+0530 DemoSocket[10289:198937] LOG SocketManager: Trying to reconnect\n2019-02-25 16:26:38.001480+0530 DemoSocket[10289:198937] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [-3]\n2019-02-25 16:26:38.001989+0530 DemoSocket[10289:199052] LOG SocketEngine: Starting engine. Server: http://192.168.0.12\n2019-02-25 16:26:38.002238+0530 DemoSocket[10289:199052] LOG SocketEngine: Handshaking\n2019-02-25 16:26:38.002777+0530 DemoSocket[10289:199052] LOG SocketEnginePolling: Doing polling GET http://192.168.0.12/socket.io/?transport=polling&b64=1\n2019-02-25 16:26:38.016625+0530 DemoSocket[10289:199052] ERROR SocketEnginePolling: Error during long poll request\n2019-02-25 16:26:38.016801+0530 DemoSocket[10289:199052] ERROR SocketEngine: Error\n2019-02-25 16:26:38.016984+0530 DemoSocket[10289:198937] ERROR SocketManager: Error\n2019-02-25 16:26:38.017153+0530 DemoSocket[10289:198937] LOG SocketIOClient{/}: Handling event: error with data: [\"Error\"]\nCan you please tell me what is the problem that i am getting this error.\n. Error :-\n2019-02-26 11:27:12.765340+0530 DemoSocket[2193:42423] LOG SocketManager: Trying to reconnect\n2019-02-26 11:27:12.765824+0530 DemoSocket[2193:42423] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [-2]\n2019-02-26 11:27:12.766210+0530 DemoSocket[2193:42505] LOG SocketEngine: Starting engine. Server: http://localhost:80\n2019-02-26 11:27:12.766463+0530 DemoSocket[2193:42505] LOG SocketEngine: Handshaking\n2019-02-26 11:27:12.767042+0530 DemoSocket[2193:42505] LOG SocketEnginePolling: Doing polling GET http://localhost:80/socket.io/?transport=polling&b64=1\n2019-02-26 11:27:12.780481+0530 DemoSocket[2193:42505] ERROR SocketEnginePolling: Error during long poll request\n2019-02-26 11:27:12.780651+0530 DemoSocket[2193:42505] ERROR SocketEngine: Error\n2019-02-26 11:27:12.780856+0530 DemoSocket[2193:42423] ERROR SocketManager: Error\n2019-02-26 11:27:12.781139+0530 DemoSocket[2193:42423] LOG SocketIOClient{/}: Handling event: error with data: [\"Error\"]\nCode :-\n{\nlet manager = SocketManager(socketURL: URL(string: \"http://localhost:80\")!, config: [.log(true), .compress])\nvar socket: SocketIOClient!\noverride func viewDidLoad() {\n\n\n    socket = manager.defaultSocket\n    socket.joinNamespace()\n\n    socket.on(clientEvent: .connect) {data, ack in\n        print(\"socket connected\")\n    }\n\n    self.socket.on(clientEvent: .error) {data, ack in\n\n        print(\"error\")\n\n    }\n\n    socket.connect()\n}\n\nSo, what is the problem that i am getting this issue and if any one have any solution or suggestion than please let me know.. ",
    "vishaluae": "Thanks for the info! :) It helped!\n. ",
    "mp3il": "Sorry, found in the example,\nclosing.\n. Actually the fact that the server ack once he got the data, thats means everything is good, but once \"NO ACK\" happens I think I will queue up and will try to re-send it once the socket connectivity is back.\nIm doing some tests, once I will come up with some results I will update.\nand still- would love to hear from people that wanted to make sure that all data is getting to the server and how did they accomplish it. \nThanks!\n. ",
    "samyakjain": "Can you share the example\n. ",
    "evixar": "In a static library :\nerror: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool: unknown option character `X' in: -Xlinker\nUsage: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool -static [-] file [...] [-filelist listfile[,dirname]] [-arch_only arch] [-sacLT] [-no_warning_for_no_symbols]\nUsage: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool -dynamic [-] file [...] [-filelist listfile[,dirname]] [-arch_only arch] [-o output] [-install_name name] [-compatibility_version #] [-current_version #] [-seg1addr 0x#] [-segs_read_only_addr 0x#] [-segs_read_write_addr 0x#] [-seg_addr_table ] [-seg_addr_table_filename ] [-all_load] [-noall_load]\n. In a objc framework at runtime : \ndyld: Library not loaded: @rpath/SocketIO.framework/SocketIO\n  Referenced from: /private/var/mobile/Containers/Bundle/Application/D6B335FF-F31E-4C91-9229-2AF55C205843/ATInternetDemoApp-ObjC.app/Frameworks/SmartTrackerFramework.framework/SmartTrackerFramework\n  Reason: image not found\n. Nope, not using Carthage. I just add the swift files to my objC framework. Compile my framework, use it in an objc App and it crashes :(\n. In the future i won't have the hand on the app. Our customer have to just include our framework in their app :( Can't tell them to include swift files ;)\n. ",
    "andreiantonescu": "Had the same error when using CocoaPods < 0.36. \nMaybe you'll find some tips here: http://blog.cocoapods.org/CocoaPods-0.36/\n. ",
    "mbelkin": "I'm still getting this error on an Objective-C project after copying the files directly into xcode (as instructed). I've spent 2 days trying to debug this and have scoured every stack overflow question I could find. Any tips? \nA few other notes:\n1. The project doesn't build for iOS 7. I get the error ld: warning: Auto-Linking supplied '/Code/Distinc.tt_v2/iOS/Distinctt/Distinctt/Frameworks/SocketIO.framework/SocketIO', embedded dylibs/frameworks are only supported on iOS 8.0 and later (@rpath/SocketIO.framework/SocketIO)\n2. When I target iOS 8, the project builds but once it runs I get the Library not loaded: @rpath/SocketIO.framework/SocketIO error\n3. The import statement in the readme file did not work for me. I had to use #import <SocketIO/SocketIO-Swift.h> before I could get anything to start building\n4. I also tried CocoaSeeds and had the same result\n. I already copied the files inside the SocketIOClientSwift folder directly. Is there more I should do?\n. I'm not sure I follow. Here are the precise steps I've taken:\n1. Clone repo\n2. Copy all the (.swift) files from the SocketIOClientSwift folder into my project.\n3. Make sure all files are added to my build targets (box checked)\n4. In the .m file I'm using SocketIO from: #import <SocketIO/SocketIO-Swift.h>\n5. Connect and use socket client. I.e.\n_socket = [[SocketIOClient alloc] initWithSocketURL:@\"http://localhost:3000\" opts:nil];\n[_socket connect];\n[_socket emit:@\"test\" withItems:@[message]];\n. Could you or someone else please provide some assistance? I understand that you don't use Objective C, but a lot of the world still does. This is an official library but the included instructions do not work in Objective C. I think this should be as high a priority as any other feature requests or improvements. As I said, I've literally spent 2 solid days just trying to debug this with no result. I use dozens of libraries and have never had this much trouble with an integration.\nHas anyone been able to get this working on Objective C without using cocoapods? My problem with cocoapods is the iOS8+ requirement and the fact that adding the use frameworks bit caused issues with other libraries I was using.\n. Thank you for re-opening this!\nCan you describe the steps you took? Maybe if you started with a blank Objective C project template and tried it from scratch we might uncover some missing steps? \nThat import statement in my project doesn't work. I get 'SwiftIOObjc-Swift.h' file not found.\n. That worked! They key was the import statement: #import \"[TargetName]-Swift.h\". I didn't see that referenced on here or in Apple's documentation. \nThank you so much for your help. Would you like me to submit a pull request to update the readme file to reflect this? I believe what it currently says #import <Socket_IO_Client_Swift/Socket_IO_Client_Swift-Swift.h> is out of date.\n. I'm experiencing the same thing \u2014\u00a0any ideas? What's strange is I noticed it builds to my phone just fine but won't run on the simulator.\n. ",
    "leewaycn": "but now ,there comes a new problem . In swift 3 and Xcode 8.all these steps can't work.\nwhile I add the files (in swift3 version8) into my project written in OC, the bridge file won't auto be generated .\nas I thought for more than two weeks , I did as the Carthage ways or I want to build a framework of Socket.IO ,but finally all this works can't do as I thought.\nNow ,can somebody figure what is the point to fix my problem? thx.\n. but now ,there comes a new problem . In swift 3 and Xcode 8.all these steps can't work.\nwhile I add the files (in swift3 version8) into my project written in OC, the bridge file won't auto be generated .\nas I thought for more than two weeks , I did as the Carthage ways or I want to build a framework of Socket.IO ,but finally all this works can't do as I thought.\nNow ,can somebody figure what is the point to fix my problem? thx.\n. I have the same problem these days .and I want to build a framework,but it doesn't work.can anybody help ? and tell me how to build a framework by the way.\n. dyld: Library not loaded: @rpath/MySocketIO.framework/MySocketIO\n  Referenced from: /var/containers/Bundle/Application/21EA20A0-7ACD-4D7A-BD25-8C90201A7E40/DemoSwiftForSocketFramework.app/DemoSwiftForSocketFramework\n  Reason: image not found\n. I had dragged the framework in my projects. but no helps.\n. ",
    "pkuhonker": "you can make a new framework with the swift source , then load the framework to OC project. In OC project ,you need use \"@import yourframeworkname;\".. I also has the problem .Fixed?. 3x\uff01You are so nice! @nuclearace . same error for me. I'm using swift4. @deepakraj27 maybe you should update your pod by 'pod repo update'. ",
    "dsbcourtney": "Thanks. Should there be some error messages if it fails a connection? \n. ",
    "someoneAnyone": "NSURLSession is supported... what dependency does socket.io have on CFNetwork? Sorry but I don't understand.\n. If you're moving towards using NSURL as a parameters you might be interested in the:\n``` swift\nlet urlString = \"http://foobar.com/\"\nlet url = NSURL(string: urlString)!\n// https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSURL_Class/#//apple_ref/occ/instm/NSURL/URLByAppendingPathComponent:\nurl.URLByAppendingPathComponent(\"socket.io\")\n```\nURLByAppendingPathComponent can cleanly manipulate url strings... there is also NSURLComponents which offers other higher level query building.\n. Sorry I over simplified the example. I add handlers and get connect Events for each but then only one will continue to get updates. \n. I have. Here is another example...\n``` Swift\n for (index, oldSite) in sites.enumerate() {\n            // let socket = NightscoutSocketIOClient(site: oldSite)\n            let socket = SocketIOClient(socketURL: \"(oldSite.url.URLByDeletingLastPathComponent)\", options: [.Log(true), .ForceNew(true), .ForcePolling(false)])\n        socket.on(\"disconnect\") { data, ack in\n            print(\"socketSignal complete\")\n        }\n\n        // Listen to connect.\n        socket.on(\"connect\") { data, ack in\n            print(\"socketSignal connected for \\(socket.socketURL)\")\n        }\n\n        socket.on(\"dataUpdate\") { data, ack in\n            print(\"socketSignal dataUpdate for \\(socket.socketURL)\")                \n        }\n        sockets.append(socket)\n    }\n\n```\nMy log says... but the network is good.\nSocketIOClient: Handling event: reconnect with data: (\n    \"The network connection was lost.\"\n)\n. I've tried several different ways of establishing separate socket connections but i seem to get one (the first one) ever stay connected and return data.\n. ok, I'll keep debugging... thank you for checking.\n. I found a bug in my code where the same property was being recycled instead of created for each connection. Sorry about that.\n. ",
    "SimpleApp": "Is this thread the final word regarding watchOS support ?\n. Ok thanks. \nJust for info, judging by this https://madebymany.com/blog/apple-watch-what-can-you-do-with-it post, it seems like some build of SocketRocket was at some point building on watchkit. I've asked this project for a status on watchOS, because their podspec also don't mention watchos...\n. ",
    "yuhua-chen": "hmm...gotcha. And I found the reference in the docs. Thanks :smiley: \n. ",
    "guapollo": "what's the object-c way to do this?\n. Works! Thanks!\n. ",
    "nigharsh": "Updated for 2017\nvar socket = SocketIOClient(socketURL: URL(string: \"localhost:8080\")!, config: [.connectParams([\"<key>\" : \"<value>\"])]). ",
    "mohdsafadsaal": "Hi ,\nI don't find socket io client with this params. \nIs there any alternative method to pass query parameters on connect method ?. ",
    "anuroopkanayil": "how to use connect parameters in swift 4. ",
    "bbdroid": "@nuclearace Can you please provide the demo using SocketManager?\nI am getting difficulty to connect to socket server with authorization header.\nAppreciate your help!. @githubforIT How did you resolve it? I am facing same issue. I appreciate if you can share your solution.\nRegards!. @nuclearace I am also facing same issue using the latest version.. ",
    "malexdev": "Alright, so it looks like if I surround what I send to the server in an array, this works:\nswift\n    func emit(message: String, json: String, callback: (response: String?) -> Void) -> Void {\n        if connected() {\n            NSLog(\"Emitting message '\\(message)' with JSON payload \\(json), requesting ack\")\n            let ack = socket.emitWithAck(message, [json])\n            ack(timeoutAfter: 5, callback: { (response: NSArray?) -> Void in\n                if let str = response?.firstObject as? String {\n                    if str == \"NO ACK\" {\n                        NSLog(\"No ack from server\")\n                        callback(response: nil)\n                    } else {\n                        callback(response: str)\n                    }\n                } else {\n                    NSLog(\"Unexpected response from server: \\(response)\")\n                    callback(response: nil)\n                }\n            })\n        }\n    }\nHowever this isn't needed for non-ack functions like this:\nswift\n    func emit(message: String, json: String) {\n        if connected() {\n            NSLog(\"Emitting message '\\(message)' with JSON payload \\(json)\")\n            socket.emit(message, json)\n        }\n    }\nI'm fine with working around it, as shown in my first function, but I am curious if this is intended. \nThanks!\n. Yeah, I'm seeing it coming in as an array in the socket.io debug statements, but it doesn't come in as an array to my code. I must be doing something somewhere else that I've forgotten about (it's been a while since I've worked on this project). I don't think this was an issue with socket.io. \nThanks for your time, and sorry for the bother!\n. ",
    "davecom": "Yeah, my socket is an ivar, so I don't think that's the issue.  I've simplified my example significantly to show it here:\nlet socket = SocketIOClient(socketURL: \"myServerNotPostedPubliclysAddress\")\n```\nfunc applicationDidFinishLaunching(aNotification: NSNotification) {\n        //setup socket\n        socket.on(\"connect\") {data, ack in\n            print(\"socket connected\")\n        }\n    socket.on(\"message\") {data, ack in\n        print(\"message received\")\n    }\n\n    if let r = room {\n        roomField.stringValue = r\n        socket.connect() //message received works here\n        socket.emit(\"create\", r)\n    }\n}\n\n```\n@IBAction func connectToRoom(sender: AnyObject!) {\n            if let r = room {\n                socket.connect() // no message received works here, but emits work after this\n                socket.emit(\"create\", r)\n            }\n    }\nIn either case, emit works fine and other clients (web/JavaScript) get my emits fine.  The issue is the on handler for \"message\" is not called when connect() is called from another method.  It's bizarre I know.  Looking for any ideas.\n. ",
    "meismyles": "On iOS9 now and having the same issue. Was there a fix for this?\n. Odd, I'm just playing around with it now. Admittedly I'm using Flask-SocketIO but I run it on an iOS 8 simulator and it works perfectly, swap to the iOS 9 simulator and get the error.\n. Yeah thats been resolved now in the v1.0 alpha/beta release. Works with either upgrading from polling to websockets, or just direct websockets. I'm going to step through it now and see if I can see where it fails. The server seems to think the connection is accepted, but the client just keeps retrying with that error.\n. Has the client been tested to work with iOS 9 and Swift 2.0 with a node server?\n. disconnectStream(...) is called in the delegate for the stream methods in WebSocket.swift:\npublic func stream(aStream: NSStream, handleEvent eventCode: NSStreamEvent) {\n    ...\nThe value of aStream.streamError in here is:\nError Domain=NSPOSIXErrorDomain Code=2 \"No such file or directory\"\nHowever, potentially an issue with the iOS 9 simulator. Weirdly it works fine on iOS 9 on an actual device, just not the simulator. Also, seems to be reports of people having the same error above (for different applications/frameworks) on iOS 9 with just the simulator. Some have even said that the error began occurring only after updating from Yosemite to El Capitan.\n. Saw a similar issue you had responded to earlier @nuclearace and it was something to do with the host value. I just tried playing with the host ip value of the server with the following results:\nhost='0.0.0.0'\n- Connects fine on iOS 8 from both device and simulator.\n- Connects fine on iOS 9 from device.\n- Connection fails on iOS 9 from simulator.\nhost='192.168.1.14' - my actual LAN ip\n- Connects fine on iOS 8 from both device and simulator.\n- Connects fine on iOS 9 from device.\n- Connection fails on iOS 9 from simulator.\nhost='127.0.0.1'\n- Connects fine on iOS 8 from simulator.\n- Connects fine on iOS 9 from simulator.\n- Obviously connection fails from device since its running on localhost.\nSo... not really sure what is going on / what the issue is. These results combined with the findings in the post above leave me confused.\nEdit: Here is the similar issue: https://github.com/socketio/socket.io-client-swift/issues/182\n. Either the simulator or El Capitan. Seems like it's one of the two. Since others have reported the issue only happening after updating from Yosemite to El Capitan, I'de possibly say something related to the underlying networking in El Capitan? No idea what though.\n. But I guess a workaround is to make sure the servers host ip value is '127.0.0.1' when using the simulator. This seems to work.\nThen change that to '0.0.0.0' or whatever other value you require when testing on devices.\n. Contrary to my previous post, you can set the servers IP to 0.0.0.0 but the simulator must still connect to 127.0.0.1.\nA little work around I am using at the moment is:\n- Set the servers IP to 0.0.0.0.\n- Use the following code in your app to determine if its a simulator or device so it connects to the correct IP:\n#if (arch(i386) || arch(x86_64)) && os(iOS)\n  static let serverURL = \"http://127.0.0.1:PORT\" // for simulator\n  #else\n  static let serverURL = \"http://MACHINES_LOCAL_IP:PORT\" // for local devices\n  #endif\n. They actually expanded the scope of applications allowed to communicate in the background.\nNow allow apps if they fall into a number of categories such as playing audio, location updates (navigation), VoIP, Newsstand, background fetch, remote notifications, etc.\nSee: https://developer.apple.com/library/ios/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/BackgroundExecution/BackgroundExecution.html\n. Oh yeah, I was just letting the OP know that it is now theoretically allowed, not that it is possible with this library. I'll potentially be attempting it soon so I'll report back if I have any success.\n. Woops, forgot to reply. I implemented this client recently in an iOS app that plays audio and setting my applications background mode to audio kept the socket open and connected when the app was in the background. So it should work fine.\n. Yeah it should work fine with Swift 2 as far as I'm aware. Other Swift 2 frameworks are working fine with it. I'm on the latest version of Xcode too.\nIs this just an issue I'm having or is everyone unable to add the framework using Carthage?\n. Hmm, weird.\n. 3.1.6 of what? This framework or?\n. Getting these errors now when running carthage update --platform iOS:\n*** WARNING: Skipping build for \"iphonesimulator\" SDK because the necessary signing identity \"iPhone Distribution\" is not installed\n*** WARNING: Skipping build for \"iphoneos\" SDK because the necessary signing identity \"iPhone Distribution\" is not installed\nOther frameworks build fine still, just this one thats giving that error.\n. Yeah\n. Hmm, will have to have a look in the morning, see if anyone else is having a similar issue.\n. Never did this get working. Could this be anything to do with you potentially code signing the project to your developer account (if you have on) when you build it? And then it looking for your details when I try to build it?\n. Doesn't solve it for me. Still getting the same error.\n. You just trying to close the socket when the app enters the background?\n. Well if you are, you may want to close it in the methods in AppDelegate rather than relying on notifications.\nFor example, either of these depending on your application type:\n```\nfunc applicationDidEnterBackground(application: UIApplication) {\n    // Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later.\n    // If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.\n}\n...\nfunc applicationWillTerminate(application: UIApplication) {\n    // Called when the application is about to terminate. Save data if appropriate. See also applicationDidEnterBackground:.\n    UIApplication.sharedApplication().endReceivingRemoteControlEvents()\n}\n``\n. See my last message. Also, those methods are app wide so you don't need to worry about closing the socket in every view like you would with your method.\n. Weird. The second I close the socket or kill my app it closes immediately.\n. Just a warning, if you set that background mode and the application doesn't actually do it, it will be rejected from the app store.\n. Yeah, if it doesn't actually perform the background operation type you specify then it will be rejected. How are you determining the socket hasn't disconnected, from the server or the app?\n. Well I honestly can't think of a reason why it doesn't close. I assume you are calling theclose()` method on the socket instance and not just waiting for the app to kill it when its removed from memory?\nI've just tested by adding the close call in my AppDelegate:\nfunc applicationDidEnterBackground(application: UIApplication) {\n    // Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later.\n    // If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.\n    SocketHandler.sharedInstance.socket.close()\n}\nTested it about 30 times and it closed immediately every time.\n. Ah woopsie. Read your earlier comment the wrong way round, as in working on v7 and not working on v9.\nI'll see if I can test it on v7 now.\n. Can't install iOS 7 simulators in El Cap so guess thats me out sorry.\n. Odd. Does it matter that the connection hangs on? If its really necessary to close it, a bit of a dirty hack but what about sending a message from the device to the server so that the server can close the connection?\n. So does the app not send the disconnect message, or the server not receive it? Or the server receives it but doesn't disconnect the socket?\n. Well I'd definitely be disconnecting it in AppDelegate rather than using notifications. Notifications may not be received immediately and so the app could already be in the background.\nBut if you're disconnecting it in AppDelegate I don't see why it wouldn't do it. I've never seen any reports of things not working in the methods in AppDelegate unless the application is set up incorrectly regarding background modes. It should finish executing whatever is in there before it finally is suspended (unless it takes a very long period of time, e.g. > 3 mins in which case the OS may forcefully kill it). But this is an incredibly quick task. Are the methods in AppDelegate definitely being called? If you put a print statement before and after the close call are they both executed?\n. Personally I wouldn't use beginBackgroundTaskWithExpirationHandler for this. I don't really see closing the socket as a background task that still needs to be executed? If you see the top answer of this there are some potential downsides to using this: http://stackoverflow.com/questions/12071726/how-to-use-beginbackgroundtaskwithexpirationhandler-for-already-running-task-in\nCan't you just call socket.close() in applicationWillTerminate:? And make sure you have Application does not run in background set to YES in your info.plist.\nDo you need to listen for the disconnect event on the device? Can't you just assume that if the application is closed then the socket is closed?\nBut I mean, I'm not exactly sure what your app is or how it works.\n. ",
    "carlosen14": "i'm having the same issue, on Yosemite was working perfect on IOS8 and IOS9 with the same code, after upgrade to El Capitan, it only works locally if the server is 127.0.0.1 if i set my mac's ip it doesn't connect.\n. ",
    "c8439": "Online users only hundreds of TCP, there were more than 5000, but also continue to add, established\n\n. ",
    "aniketc-gslab": "@meismyles , I am also going through the same issue, but when I activated Audio and VoIP background modes (and marked the socket.io client as voip = true while initializing) the connected socket is giving me the log as\n2016-03-30 12:11:12.213 GSLVideoCallApp[3318:1287745] LOG SocketEngine: Writing ws: has data: 0\n2016-03-30 12:11:12.214 GSLVideoCallApp[3318:1287745] LOG SocketEngine: Sending ws: as type: 2\n2016-03-30 12:11:12.218 GSLVideoCallApp[3318:1287744] ERROR SocketEngine: connection closed by server\nWhen I am switching the app to background and 2-3 minutes after locking the phone.\nIs there something wrong I am doing or missing something.\n. @kshrikant when you call, say\nsocket.connect()\nto listen to the successful connection establishment to the server you have to add a handler like the following\nswift\nsocket.on(\"connect\") {data, ack in\n    print(\"socket connected\")\n }\nAnd to capture a failure condition to establish a connection you can add a handler like \nswift\nsocket.on(\"error\") {data, ack in\n    print(\"This block can be used to capture different errors and not only the error to connect, you can always see the error description 'data' \")\n }\n. ",
    "shoaibhussan": "@meismyles please tell whether you were able to connect socket in background or not,\nif yes,then please help us too.\nThanks\n. Thanks to God,i have done it with few lines of code,now i can send and recieve data even in background.\n. Just added following lines of codes in appdelegate and it started work.\n- (void)applicationDidEnterBackground:(UIApplication *)application {\n    UIApplication *app = [UIApplication sharedApplication];\n    UIBackgroundTaskIdentifier bgTask;\n    bgTask = [app beginBackgroundTaskWithExpirationHandler:^{\n        [app endBackgroundTask:bgTask];\n    }];\n}\n. ",
    "okankocyigit": "Has anybody solved this problem?. @hahaGitHub how did you solve this?\n. ",
    "princenaman": "Any update or workaround sample?. ",
    "TofPlay": "The source code is compatible with Swift 2.0?\n. Great :+1: :smile: \n. ",
    "bl82": "2016-12-03 17:38:17.768447 Votecast[967:508007] LOG SocketIOClient: Adding handler for event: connect\n2016-12-03 17:38:17.768796 Votecast[967:508007] LOG SocketIOClient: Adding handler for event: disconnect\n2016-12-03 17:38:17.769475 Votecast[967:508007] LOG SocketIOClient: Adding handler for event: connect_error\n2016-12-03 17:38:17.769629 Votecast[967:508007] LOG SocketIOClient: Adding handler for event: chapter.update\n2016-12-03 17:38:17.769748 Votecast[967:508007] LOG SocketIOClient: Adding handler for event: event.update\n2016-12-03 17:38:17.769867 Votecast[967:508007] LOG SocketIOClient: Adding handler for event: chapter_member_status.update\n2016-12-03 17:38:17.770013 Votecast[967:508007] LOG SocketIOClient: Adding engine\n2016-12-03 17:38:17.773394 Votecast[967:508007] LOG SocketEngine: Starting engine. Server: my server\n2016-12-03 17:38:17.773512 Votecast[967:508007] LOG SocketEngine: Handshaking\n2016-12-03 17:38:17.779697 Votecast[967:508007] LOG SocketEnginePolling: Doing polling request\n2016-12-03 17:38:17.780127 Votecast[967:508007] LOG SocketIOClient: Client is being released\n2016-12-03 17:38:18.348302 Votecast[967:508007] LOG SocketEnginePolling: Got polling response\n2016-12-03 17:38:18.349426 Votecast[967:508045] LOG SocketEngine: Got message: 0{\"sid\":\"ybjBdl48KC6JfVE6AABC\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2016-12-03 17:38:18.352046 Votecast[967:508045] LOG SocketEngine: Writing poll:  has data: false\n2016-12-03 17:38:18.352282 Votecast[967:508045] LOG SocketEnginePolling: Sending poll:  as type: 2\n2016-12-03 17:38:18.352428 Votecast[967:508045] LOG SocketEnginePolling: Created POST string: 1:2\n2016-12-03 17:38:18.353341 Votecast[967:508045] LOG SocketEnginePolling: POSTing\n2016-12-03 17:38:18.353500 Votecast[967:508045] LOG SocketEngine: Engine is being released. @nuclearace @ipandage Were you able to resolve this issue?\n913 #918 Same here.. @nuclearace @thully @kinza88\nI wonder if this was resolved, started happening with update 13.1.0\nRelated issues, I've posted my conf and logs there:\n918\n913 . Same problem for me I constantly get \"Session ID unknown\" error:\nMy Podfile:\n```\nsource 'https://github.com/CocoaPods/Specs.git'\nplatform :ios, '8.4'\nuse_frameworks!\ntarget 'Votecast' do\npod 'Socket.IO-Client-Swift' # Or latest version\npod 'Fabric'\npod 'Crashlytics'\npod 'MBProgressHUD'\npod 'PNChart'\nend\nMy SocketIO swift class:\nimport Foundation\nimport SocketIO\n@objc public class SocketProvider : NSObject {\nlet str = \"https://dev.votecast.dk/\" //Prod server\n\nvar descr = \"SocketProvider class\"\nvar socket : SocketIOClient\nvar manager : SocketManager\n\nInit of Socket Manager:\n        self.manager = SocketManager(socketURL: URL(string: str)!, config: [.log(true), .connectParams([\"user_id\": id])])\n        self.socket = manager.defaultSocket\n        self.socket.on(\"connect\") {data, ack in\n        let dict = [[\"sid\":self.socket.sid]]\n\n        loggerHandler(dict, \"connected\")\n        print(\"socket connected\")\n    }\n\n```\nWhen I try to connect using forceWebsocket I get: \"Invalid HTTP upgrade\" socket error and connection drops abruptly.\nWhen I switch to default configuration or forcePolling I get: \n2018-01-03 17:39:46.374430+0200 Votecast[38357:921519] LOG SocketEnginePolling: Got poll message: 97:0{\"sid\":\"9Ln0tyN13zNfDQx_AAnx\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":15000}\nI attach both logs to this comment.\nsocket_io_swift_13_1_websocket.log\nsocket_io_swift_13_1_default.log\n. @nuclearace Here is my full code for connection management:\n```\n    @objc public func connectSocketIOSimple(loggerHandler: @escaping (Array?, NSString?) -> Void) {\n        self.manager = SocketManager(socketURL: URL(string: str)!, config: [.log(true), .forceNew(true), .connectParams([\"user_id\": id])])\n        self.socket = manager.defaultSocket\n    self.socket.on(\"connect\") {data, ack in\n\n        let dict = [[\"sid\":self.socket.sid]]\n\n        loggerHandler(dict, \"connected\")\n        print(\"socket connected\")\n    }\n\n    self.socket.on(\"reconnect\") {data, ack in\n\n        let dict = [[\"sid\":self.socket.sid]]\n\n        loggerHandler(dict, \"connected\")\n        print(\"socket connected\")\n    }\n\n    self.socket.on(\"user connected\") {data, ack in\n        print(data)\n    }\n\n    self.socket.on(\"disconnect\") {data, ack in\n        self.manager.reconnect()\n\n        print(\"socket diconnected\")\n    }\n\n    self.socket.on(\"error\") {data, ack in\n        self.manager.reconnect()\n        print(\"socket error\")\n    }\n\n    self.socket.on(\"chapter.update\") {data, ack in\n        print(data)\n        loggerHandler(data, \"chapter.update\")\n    }\n\n    self.socket.on(\"event.update\") {data, ack in\n        print(data)\n        loggerHandler(data, \"event.update\")\n    }\n\n    self.socket.on(\"event.transition\") {data, ack in\n        print(data)\n        loggerHandler(data, \"event.transition\")\n    }\n\n    self.socket.on(\"chapter.transition\") {data, ack in\n        print(data)\n        loggerHandler(data, \"chapter.transition\")\n    }\n\n    self.socket.on(\"chapter_member_status.update\") {data, ack in\n        print(data)\n        loggerHandler(data, \"chapter_member_status.update\")\n    }\n\n    //New events handlers\n\n    self.socket.on(\"event.started\") {data, ack in\n        print(data)\n        loggerHandler(data, \"event.started\")\n    }\n\n    self.socket.on(\"event.stopped\") {data, ack in\n        print(data)\n        loggerHandler(data, \"event.stopped\")\n    }\n\n    self.socket.on(\"event.restarted\") {data, ack in\n        print(data)\n        loggerHandler(data, \"event.restarted\")\n    }\n\n    self.socket.on(\"chapter.vote.started\") {data, ack in\n        print(data)\n        loggerHandler(data, \"chapter.vote.started\")\n    }\n\n    self.socket.on(\"chapter.vote.cancelled\") {data, ack in\n        print(data)\n        loggerHandler(data, \"chapter.vote.cancelled\")\n    }\n\n    self.socket.on(\"chapter.vote.completed\") {data, ack in\n        print(data)\n        loggerHandler(data, \"chapter.vote.completed\")\n    }\n\n    self.socket.on(\"chapter.approve.started\") {data, ack in\n        print(data)\n        loggerHandler(data, \"chapter.approve.started\")\n    }\n\n    self.socket.on(\"chapter.approve.cancelled\") {data, ack in\n        print(data)\n        loggerHandler(data, \"chapter.approve.cancelled\")\n    }\n\n    self.socket.on(\"chapter.approve.completed\") {data, ack in\n        print(data)\n        loggerHandler(data, \"chapter.approve.completed\")\n    }\n\n    self.socket.on(\"chapter.values.reset\") {data, ack in\n        print(data)\n        loggerHandler(data, \"chapter.values.reset\")\n    }\n\n    self.socket.on(\"chapter_member.update\") {data, ack in\n        print(data)\n        loggerHandler(data, \"chapter_member.update\")\n    }\n\n\n    self.socket.connect()\n}\n\n. @nuclearace I am not sure as well, it was working in just before I returned to develop new feature and updated from cocoapods, let me know, what I can investigate further? it is a blocker for me right now. feature I was working on is done, but during testing sockets no longer communicate properly. btw I was running test from simulator.. @nuclearace server is set to both transports:\ntransports: [\n            'websocket',\n            'polling'\n        ]\nAnd version of Socket IO on server is 2.x. @nuclearace Hmmmm.... Magic happened. I don't know how guys I am working with set up their server connection. Nobody notified me of any changes there, neither before the event nor today. But currently connection and sockets are working perfectly! And correctly switching between polling and websockets :+1: Although I did pod deintegrate and pod install again, switching to previous version 13.0.0, and when I found out that it is working just fine, I tried to reproduce the issue and did one more pod deintegrate and pod install again with 13.1.0 version, after that it worked like charm! :1st_place_medal: . @nuclearace @Dumk0 Removed reconnect from on disconnect and from on error handlers. Same result and log flood is 100% reproducible, upon quick start/stop of socket session on version 13.1.0.\nMeanwhile version 13.0.0 working 100% correctly, tested simultaneously on 5 devices... \nYou may wish to reopen this bug. If I can help you somehow, I can try to provide you with something.. @nuclearace I think you can close it. It boiled down to incorrect flow in my case. Which was fixed.. > @bl82 can you explain the bad flow and how you fixed Incase someone else runs into it?\nI recommend taking backend team with mobile developers to trace this issue, check with debug and break points whole flow and see if you have somewhere in code duplicated calls for either creating a connect after disconnect or reconnecting. My flow was flawed, during slight change of backend logic, when new condition (edge case) arrived and flow started working in different way, skipping necessary check and recreating connections multiple times. Such issues are better tracked with careful step-by-step debug of your own code. I also recommend making all Socket Connection methods and management to be put in separated class.. @ryan2x @nuclearace As for me I did migration from 12 to 13 version, before facing this issue. Don't think it is related. Maybe it is causing similar behaviour if not migrated to v13 properly.. Same for me, my SocketIO init:\nself.manager = SocketManager(socketURL: URL(string: str)!, config: [.log(true), .connectParams([\"user_id\": id, \"room_code\": roomId])])\nself.socket = manager.defaultSocket\nself.socket.on(\"connect\") {data, ack in\nlet dict = [[\"sid\":self.socket.sid]]\nloggerHandler(dict, \"connected\")\nprint(\"socket connected\")\n}\n```\n  . @ConnectDevVS Yes, we made a code review in our team, traced whole flow with backend. Bug came from our side. During incorrect flow connect/reconnect/disconnect sequence.. @ConnectDevVS Our flow when was reviewed in details, we found an edge case that initiated recurrent connections to socket manager. We are not using forceNew. I can only advice Android and backend team to start tracing you flow code step-by-step. Also pay attention that you should not call reconnect manually on disconnect handlers.. ",
    "tulburg": "2016-12-18 22:47:50.978466 WooCast[8042:2136773] LOG SocketIOClient: Handling event: error with data: [\"Tried emitting goof when not connected\"]\n2016-12-18 22:47:50.978600 WooCast[8042:2136773] LOG SocketIOClient: Adding handler for event: connected\n2016-12-18 22:47:50.978728 WooCast[8042:2136773] LOG SocketIOClient: Adding handler for event: error\n2016-12-18 22:47:50.978847 WooCast[8042:2136773] LOG SocketIOClient: Adding handler for event: connect\n2016-12-18 22:47:50.978905 WooCast[8042:2136773] LOG SocketIOClient: Adding engine\n2016-12-18 22:47:50.981571 WooCast[8042:2136773] LOG SocketEngine: Starting engine. Server: http://192.168.1.13:8010\n2016-12-18 22:47:50.981637 WooCast[8042:2136773] LOG SocketEngine: Handshaking\n2016-12-18 22:47:50.982762 WooCast[8042:2136773] LOG SocketEnginePolling: Doing polling request\nGot event: error, with items: Optional([\"Tried emitting goof when not connected\"])\n[\"Tried emitting goof when not connected\"]\n2016-12-18 22:47:51.012090 WooCast[8042:2136773] LOG SocketIOClient: Client is being released\n2016-12-18 22:47:51.204526 WooCast[8042:2136773] LOG SocketEnginePolling: Got polling response\n2016-12-18 22:47:51.206152 WooCast[8042:2136803] LOG SocketEngine: Got message: 0{\"sid\":\"Tv_M_ifOLL9uLHBXAAAT\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2016-12-18 22:47:51.207291 WooCast[8042:2136803] LOG SocketEngine: Writing poll:  has data: false\n2016-12-18 22:47:51.207523 WooCast[8042:2136803] LOG SocketEnginePolling: Sending poll:  as type: 2\n2016-12-18 22:47:51.209615 WooCast[8042:2136803] LOG SocketEnginePolling: Created POST string: 1:2\n2016-12-18 22:47:51.210560 WooCast[8042:2136803] LOG SocketEnginePolling: POSTing\n2016-12-18 22:47:51.210676 WooCast[8042:2136803] LOG SocketEngine: Engine is being released. ",
    "gpr321": "WebSocket the connect function,when i do connect operation,it always block at the \"self.createHTTPRequest()\",but when when my controller is dealloced the thread was still block at the \"self.createHTTPRequest()\", but i modify like this :\n /* can i modify like this\n    weak var wself = self;\n    dispatch_async(socketconnect_queue!, {\n        wself?.isCreated = true\n        wself?.createHTTPRequest()\n        wself?.isCreated = false\n    })\n    /\nit works, what i want to ask is : is there any problem fix like this??\n. ",
    "daltoniam": "I happen to stumble across this... I fixed this in my latest check in here:\nhttps://github.com/daltoniam/Starscream/commit/f46e64b1792421f8b5583628b23f4fb9c172d351\n. ",
    "ludusrusso": "1.3.6, with flask-socketio compatible with socket.io 1\n. Not so much,\nthis is what I get when the swift client connects:\nclient connected\n127.0.0.1 - - [31/Aug/2015 14:21:36] \"GET /socket.io/?transport=polling&b64=1 HTTP/1.1\" 200 -\nand this is the one from javascript\nclient connected\n127.0.0.1 - - [31/Aug/2015 14:22:13] \"GET /socket.io/?EIO=3&transport=polling&t=1441023733317-0 HTTP/1.1\" 200 -\nThe server seems to correct recognize the connection, but I'm not able to capture messages from the client.\n. forcing websocket I got this:\n2015-08-31 17:01:25.717 test[41184:4220660] SocketClient: Adding handler for event: connect\n2015-08-31 17:01:25.717 test[41184:4220660] SocketClient: Adding handler for event: added\n2015-08-31 17:01:25.718 test[41184:4220660] SocketClient: Adding handler for event: error\n2015-08-31 17:01:25.718 test[41184:4220660] SocketClient: Adding engine\n2015-08-31 17:01:25.718 test[41184:4220660] SocketEngine: Starting engine\n2015-08-31 17:01:25.718 test[41184:4220660] SocketEngine: Handshaking\n2015-08-31 17:01:25.791 test[41184:4220682] ERROR SocketClient: Invalid HTTP upgrade\n2015-08-31 17:01:25.792 test[41184:4220682] SocketClient: Handling event: error with data: (\n    \"Invalid HTTP upgrade\"\n)\n2015-08-31 17:01:25.793 test[41184:4220682] SocketClient: Handling event: reconnect with data: (\n    \"Invalid HTTP upgrade\"\n)\n2015-08-31 17:01:25.793 test[41184:4220682] SocketClient: Starting reconnect\n2015-08-31 17:01:25.793 test[41184:4220682] SocketClient: Trying to reconnect\n2015-08-31 17:01:25.794 test[41184:4220682] SocketClient: Handling event: reconnectAttempt with data: (\n    \"-1\"\n)\n2015-08-31 17:01:25.796 test[41184:4220682] SocketClient: Adding engine\n2015-08-31 17:01:25.798 test[41184:4220682] SocketEngine: Starting engine\n2015-08-31 17:01:25.798 test[41184:4220682] SocketEngine: Handshaking\n2015-08-31 17:01:25.800 test[41184:4220682] SocketEngine: Engine is being deinit\n2015-08-31 17:01:25.805 test[41184:4220682] ERROR SocketClient: Invalid HTTP upgrade\n2015-08-31 17:01:25.805 test[41184:4220682] SocketClient: Handling event: error with data: (\n    \"Invalid HTTP upgrade\"\n)\ngot event: error with items Optional((\n    \"Invalid HTTP upgrade\"\n))\nerror\ngot event: reconnect with items Optional((\n    \"Invalid HTTP upgrade\"\n))\ngot event: reconnectAttempt with items Optional((\n    \"-1\"\n))\ngot event: error with items Optional((\n    \"Invalid HTTP upgrade\"\n))\nOk, I'm trying to understand how flask-socketio works!\n. Ok, \nafter a full reinstallation of the entire python virtual env I solved the problem.\nI don't know if there was a problem in the previous installation or if the last commits of @miguelgrinberg fixed it. \nAnyway I think I can close the issue\n. ",
    "miguelgrinberg": "@ludusrusso There's logging support in the server side. Add logger=True, engineio_logger=True arguments to your server constructor to get logging for Socket.IO and Engine.IO.\nI have been able to use the Swift client with long-polling. Forcing WebSocket is not going to work, the Engine.IO server expects the connection to be established with long-polling and then upgraded to WS, exactly like it happens with the JS client. I have not tried the WebSocket upgrades myself, but I know of a user that has been able to get WS working without the force websocket flag. I need to experiment more with the Swift client, I have literally tested it for a couple of hours, so haven't been able to run as much testing as I need.\n. @nuclearace I was not aware this was allowed in the JS client. I implemented the Python server from the specs, which clearly state the client must connect on long-polling and then upgrade. I'll look into the direct websocket connection.\n. @manju1981 you are running in \"threading\" mode, which does not support the websocket transport. I will see if I can make the error message more clear.\nAlso, please write a bug in my Socket.IO project(s) for any problems you have with my Python server.\n. ",
    "manju1981": "Hi Miguel,\nI too facing same issue as above below is the server side log. Steps to recreate\n1. Pythond 2.7.10\n2. created virtual environment and below is python code\nfrom flask import Flask\nfrom flask_socketio import SocketIO, emit\napp = Flask(name)\napp.config['SECRET_KEY'] = 'secret!'\nsocketio = SocketIO(app)\n@socketio.on('connect')\ndef test_connect():\n    print('Client connected')\n    emit('message', {'data': 'Connected'})\n@socketio.on('disconnect')\ndef test_disconnect():\n    print('Client disconnected')\nif name == 'main':\n    app.debug = True\n    socketio.run(app, host='127.0.0.1',port=5000,  logger=True, engineio_logger=True)\n Even i am using swift socket io client \n(sandalmatching)INmanjurn:src manjurn$ python WebSocket.py\nServer initialized for threading.\n- Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)\n- Restarting with stat\n  Server initialized for threading.\n  1639dab20ba94d63bce087ecd26f04e2: Sending packet OPEN with {'pingInterval': 25000, 'pingTimeout': 60000, 'upgrades': [], 'sid': '1639dab20ba94d63bce087ecd26f04e2'}\n  Client connected\n  emitting event \"message\" to 1639dab20ba94d63bce087ecd26f04e2 [/]\n  1639dab20ba94d63bce087ecd26f04e2: Sending packet MESSAGE with 2[\"message\",{\"data\":\"Connected\"}]\n  1639dab20ba94d63bce087ecd26f04e2: Sending packet MESSAGE with 0\n  1639dab20ba94d63bce087ecd26f04e2: Received request to upgrade to websocket\n  127.0.0.1 - - [12/Sep/2015 21:23:14] \"GET /socket.io/?transport=websocket HTTP/1.1\" 500 -\n  Traceback (most recent call last):\n  File \"/Users/manjurn/virtualEnv/sandalmatching/lib/python2.7/site-packages/flask/app.py\", line 1836, in call\n    return self.wsgi_app(environ, start_response)\n  File \"/Users/manjurn/virtualEnv/sandalmatching/lib/python2.7/site-packages/engineio/middleware.py\", line 32, in call\n    return self.engineio_app.handle_request(environ, start_response)\n  File \"/Users/manjurn/virtualEnv/sandalmatching/lib/python2.7/site-packages/socketio/server.py\", line 305, in handle_request\n    return self.eio.handle_request(environ, start_response)\n  File \"/Users/manjurn/virtualEnv/sandalmatching/lib/python2.7/site-packages/engineio/server.py\", line 215, in handle_request\n    transport, b64)\n  File \"/Users/manjurn/virtualEnv/sandalmatching/lib/python2.7/site-packages/engineio/server.py\", line 280, in _handle_connect\n    s.handle_get_request(environ, start_response)\n  File \"/Users/manjurn/virtualEnv/sandalmatching/lib/python2.7/site-packages/engineio/socket.py\", line 75, in handle_get_request\n    start_response)\n  File \"/Users/manjurn/virtualEnv/sandalmatching/lib/python2.7/site-packages/engineio/socket.py\", line 109, in _upgrade_websocket\n    self.server.async['websocket_class'])\n  TypeError: getattr(): attribute name must be string\n. @miguelgrinberg Any work around to get it working?. I am going to raise this bug in Socket.IO project. \n. ",
    "jigarPatel37": "I am using Socket.IO-Client-Swift with pods in my chat aplication in xcode 8.0 with swift 3.0.\nIt's gives some error like as under is there any solution for this. And application will crash....\nERROR SocketEnginePolling: The network connection was lost.\nERROR SocketEngine: The network connection was lost.\nERROR SocketIOClient: The network connection was lost.\nERROR SocketEnginePolling: Could not connect to the server.\nERROR SocketEngine: Could not connect to the server.\nERROR SocketIOClient: Could not connect to the server.\nERROR SocketEngine: Session ID unknown\nERROR SocketIOClient: Session ID unknown\n. ",
    "brightsider": "Then why options contains secure if this doesn't use?\n. It was previously in the README, and there were no instructions for migration. May be worth add in the README that the need to specify the address with https?\n. ",
    "umbrella-sultan-ramazanov": "Yes, this very strange, but I tested in two app. All was normal, TestFlight build created successfully, but when I include socket.io library (other than that, nothing has changed) Apple started send email every build. It is not critical, but the annoying and unexplainably.\n. After last library updates, Apple stopped send warning emails. This still inexplicably but issue was solved.\n. In new version \"options\" must to be changed to \"opts\". Erik, please change Example for Obj-C in README. This will reduce the number of questions and problems.\n. ",
    "ibrahimennafaa": "Same here ... \n. ",
    "artemcarabash": "Had the same Problem, to solve it  just drag and drop your SocketIOClientSwift.framework to General tab Embedded Binaries.\n\n. ",
    "adi2412": "Sorry. Thanks for your help!\n. So do I need to import it manually? I'm not quite sure how to import this to my project.\nThanks for your help!\n. ",
    "secretfader": "So far as I understand, xcode-select should setup the compiler correctly. Thanks for the quick response, @nuclearace \u2013 I'll jump to the Swift 2 branch and see how it goes!\n. After upgrading Xcode, I tried again to compile the swift-2 branch. Still no luck. Carthage complains about the code signing certificate:\n** BUILD FAILED **\nCode Sign error: No code signing identities found: No valid signing identities (i.e. certificate and private key pair) were found.\nA shell task failed with exit code 65:\n** BUILD FAILED **\nThe following build commands failed:\n    Check dependencies\n(1 failure)\nOther libraries, like Alamofire compile without errors.\n. @nuclearace Great. Thank you!\n. ",
    "damionvega": "I believe this is a Carthage issue: https://github.com/Carthage/Carthage/issues/235\n. Oh sorry, it's just a struct prop which is a string (project under NDA)\nstruct URL {\n  static var host = \"http://api.myproject.co\"\n  // ...other URLs\nA lie meaning that the app will run?\n. Gotcha. Do you know what this means (copied from readme)?\n\n. 8.0.2\nCarthage output:\n*** Checking out socket.io-client-swift at \"v8.0.2\"\n. Yes. Is there a different URL initializer?\n\n. Nevermind, the problem is my URL class is colliding with it. Thanks for your help \ud83d\ude04 \n. ",
    "mkaya93": "Hi again,\nyes I did this before but I couldn't send the message with this emmit.\nself.mySocket.emit(\"whisper\", [\"msg\": \"test\", \"nick\": \"nick\", \"name\": \"Name\"])\n. server wasn't receving the message\n. ",
    "edimoldovan": "@nuclearace I edited the title of the issue--it is about an iOS app, but I forgot to mention that.\nHowever, I am not sure i understand your question.\n. Xcode delete and reinstall, then workspace/project recreate fixed the thing. No version change, just these.\n. No error, it doesn't connect anymore.\n\ned\nhimself@eduardmoldovan.com\n@edimoldovan\n\nOn 17 Sep 2015, at 15:12, Erik Little notifications@github.com wrote:\nWhat do you mean doesn't work anymore without an error? What's the error you're getting\n\u2014\nReply to this email directly or view it on GitHub.\n. Happy to try that, but seams that I don\u2019t know how to enable that in the options. Could you help wit that? I read the docs, this is probably not the right way to do it as nothing happens:\nlet socket = SocketIOClient(socketURL: \"10.0.1.3:8001\", opts: [\n        \"logger\": \"SocketLogger\u201d])\n. Here\u2019s the log output:\n\n2015-09-17 18:43:54.672 ws[66554:14313675] Log SocketIOClient: Adding handler for event: connect\n2015-09-17 18:43:54.673 ws[66554:14313675] Log SocketIOClient: Adding handler for event: yo\n2015-09-17 18:43:54.673 ws[66554:14313675] Log SocketIOClient: Adding engine\n2015-09-17 18:43:54.674 ws[66554:14313675] Log SocketEngine: Starting engine\n2015-09-17 18:43:54.674 ws[66554:14313675] Log SocketEngine: Handshaking\n2015-09-17 18:43:54.675 ws[66554:14313675] Log SocketEngine: Doing polling request\n2015-09-17 18:43:54.722 ws[66554:14313780] ERROR SocketIOClient: The operation couldn\u2019t be completed. No such file or directory\n2015-09-17 18:43:54.726 ws[66554:14313780] Log SocketIOClient: Handling event: error with data: (\n    \"The operation couldn\\U2019t be completed. No such file or directory\"\n)\n2015-09-17 18:43:54.726 ws[66554:14313780] Log SocketIOClient: Handling event: reconnect with data: (\n    \"The operation couldn\\U2019t be completed. No such file or directory\"\n)\n2015-09-17 18:43:54.726 ws[66554:14313780] Log SocketIOClient: Starting reconnect\n. This is the repo: https://github.com/edimoldovan/socketio-hapi/tree/master/server-harmony\nAlso the simple server one works, the harmony is the es6 one. \nAnd yes, pointing directly to the socket.io server on port 8001.\n. No, it doesn\u2019t work with any, harmony is just syntactically different.\n. Indeed it does. but that is a bit strange isn\u2019t it, the ip I had there is my local machine\u2019s ip in the local network. \nIf you try a ifconfig in terminal and provide the IP you see there into the above server connection, does that work for you?\n. OK, this means that the issue is probably with my machine, network. Thanks a lot for the trouble, I am closing the issue.\n. True, but the fact that localhost works for me from the emulator, my local machine ip doesn\u2019t, is really strange. \n. ",
    "victorpimentel": "I'm sorry, but is this causing trouble to anyone using Carthage? If you create a sample project and add this to Cartfile:\ngithub \"socketio/socket.io-client-swift\" \"swift-2\"\nIt fails when you try to install this framework using Carthage and Xcode 7.1:\n\u2192 carthage update\n*** Fetching socket.io-client-swift\n*** Checking out socket.io-client-swift at \"60e014295517d9a5770b5743f81d1d59f6b89454\"\n*** xcodebuild output can be found in /var/folders/q_/75868zgn3d548f5t_n8r69_h0000gn/T/carthage-xcodebuild.OrIjZj.log\n*** Building scheme \"SocketIO-Mac\" in Socket.IO-Client-Swift.xcodeproj\n*** Building scheme \"SocketIO-iOS\" in Socket.IO-Client-Swift.xcodeproj\n*** Building scheme \"SocketIO-tvOS\" in Socket.IO-Client-Swift.xcodeproj\nParse error: unexpected SDK key \"appletvos\"\nPointing the Cartfile to the changeset before this pull request was merged (17444dd), correctly generates the frameworks with no errors at all.\nI don't know exactly how to solve this or if this is just a Carthage limitation and this does not happen with Cocoapods or any other dependency manager, I didn't investigate this much further. In any case, IMHO, now that we have a Xcode 7 GM we should have two branches, one for Xcode 7 and another one for Xcode 7.1, at least until 7.1 reaches the GM point.\n. ",
    "falsecz": "sorry I've forgotten append versions info\nnodejs v0.12.7\nnpm socket.io 1.3.6\nsocket.ui-client-swift v2.4.5\nXCode 6.4\n. It works, Thank You!\n. ",
    "zackz-woolloo": "Thanks for fixing this.\n. ",
    "kevinmartin": "All fixed! :+1: \n. You can't compare structs. I looked at other Swift-based event dispatchers that support removing specific handlers and they use id's like this to compare them.\n. ",
    "gafurovmsk": "\nIs this only happening with real devices?\n\nHi! I have the same problem! And yes, this reproduced with only real devices. Everything is fine in simulators. Is there any solution of this problem ?. ",
    "asapach": "Yes, we were implementing a native mobile (iOS) app on top of an existing socket.io endpoint and it came as a surprise that the iOS client doesn't have parity with the browser version. We have many namespaces as a way of multiplexing multiple logical streams of data -- and having a separate connection for each stream sounds like a massive waste of resources.\n. ",
    "tbaranes": "The last CocoaPods release doesn't support tvos, so if you release a new pod supporting tvos right now, that will break your pod. They have a workout allowing us to work on the tvos using CocoaPods, that's why I think a branch will be a good start waiting they release the tvos support.\n. Fixed\n. Thanks for your reply. We will make more analyses with the server team. I will come back to you once I have more information\n. Don't really know why we are getting some bad request, but enabling \"automatically reconnect\" seems to be a working solution.\n. What is the swift3 branch? I found only the 2.3 one\n. ",
    "codingrhythm": "Yes. The reason is in the callback block of datatask in flushWaitForPost method will call doRequest method. session waits the first datatask to complete and then invalidate itself, the second datatask within doRequest method will crash. As all datatasks are invoked from different thread, the order of execution is not guaranteed. \n. @nuclearace Hi Erik, Thanks for your reply. I made a demo application to show case the crash.\nhttps://github.com/codingrhythm/socketio-crash\nThe crash happens every time when you click the disconnect button after you connect with delegate. It happens in iOS 9. and I am using the latest socket.io swift lib\nPlease note, in the info.plist, i set the NSAllowsArbitraryLoads to True to allow self signed ssl for dev env\n. flushWaitingForPost() calls doPoll(), doPoll() calls doRequest()\n. @nuclearace this fixed the crash during disconnecting, however it crashes again with same error when I am trying to connect after disconnecting.\ncheck the demo app\nhttps://github.com/codingrhythm/socketio-crash\n1. Connect with delegate\n2. Disconnect\n3. Connect again (crash)\n. Works like charm! Cheers! You are the best!\n. ",
    "Amitmundra": "Hi,\nI am facing similar type of issue in XMPPManager(Objective C) library, when close the connection and reconnect again then crashes occured, May you help me to solve this issue?. ",
    "vinitam": "I'm doing something like this:\nin the .h:\n@property(nonatomic) SocketIOClient *socketIO;\nWhile establishing connection:\nself.socketIO = [[SocketIOClient alloc] initWithSocketURL:MYURL opts:MYPARAMS];\n[self.socketIO emit:@\"connect\" withItems:[NSArray arrayWithObject:[NSString stringWithFormat:@\"{token: %@}\",token]]];\n[self.socketIO on:@\u201cMYEVENT\u201d callback:^(NSArray* data, SocketAckEmitter* ack) {\n        NSLog(@\u201cevent fired\u201d);\n}];\n[self.socketIO emit:@\"authenticate\" withItems:[NSArray arrayWithObject:[NSString stringWithFormat:@\"{token: %@}\",token]]];\n [self.socketIO onAny:^(SocketAnyEvent * event) {\n        NSLog(@\"socket event !!!!!%@\",event);\n    }];\n[self.socketIO connect];\n. I wrote a new handler:\n[self.socketIO on:@\"connect\" callback:^(NSArray* data, SocketAckEmitter* ack) {\n    [self.socketIO emit:@\"connect\" withItems:[NSArray arrayWithObject:[NSString stringWithFormat:@\"{token: %@}\",token]]];\n}];\nBut I do not get the connect event and I keep getting the logs:\nLog SocketEngine: Writing ws:  has data: 0\nLog SocketEngine: Sending ws:  as type: 2\nLog SocketEngine: Got message: 3\n. One thing I am doing for namespace is that I am giving the namespace in opts as {@\"nsp\" : @\"myNameSpace\"}. Do I need to do anything in addition to this.\n. The namespace was the issue. Thanks :)\n. ",
    "cgilboy": "Thanks for your reply!  \nSo using an array in Swift allows you to mimic a variable argument event handler in JS. Is that desirable because Socket.io actually allows emitting events with multiple data arguments, or because socket.io supports a generic event emitter/receiver interface? I'm not sure where to find documentation on this sort of thing.\n. Gotcha. I'm now looking at the Java socket.io implementation and I see the same pattern. Thanks :)\n. ",
    "larten": "The backend developer is away, but I will post if he will be available.\nOn the client side:\n``` swift\nself.socket = SocketIOClient(socketURL: url)\n    print(\"SocketUrl: \\(socket.socketURL), secure: \\(socket.secure)\")\n\n    self.socket.onAny {\n        print(\"SocketIOManager got event on \\(self.tag): \\($0.event), with items: \\($0.items)\")\n        self.cb(event: $0.event, items: $0.items);\n    }\n\n```\nwhere url starts with https.\nThe strange is, that in browser client it's working without any ssl exception (and browser show certificate as trusted).\n. The backend code:\n``` javascript\nvar fs = require('fs');\nvar https = require('https');\nvar querystring = require('querystring');\nvar express = require('express'), app = module.exports.app = express();\nvar sslOptions = {\n    key: fs.readFileSync(__dirname + '/ssl/xxx.com.key'),\n    cert: fs.readFileSync(__dirname + '/ssl/xxx.com.crt'),\n    ca: fs.readFileSync(__dirname + '/ssl/godaddy.bundle.crt')\n};\nvar server = https.createServer(sslOptions, app);\nvar io = require('socket.io').listen(server);  //pass a http.Server instance\nserver.listen(8080);  //listen on port 8080\n```\n. Sorry, but I don't know what is weak key exchange :)\nSecure communication and certificates are not my strong part. Do you have any more hint about custom NSURLSessionDelegate?\n. Not yet. The application is now on review by Apple without SSL socket. If they don't accept this, then I must solve this problem.\n@Sealos This time this is disabled, but I'm affraid Apple will push back.\nI'm using now Yosomite, but I plan to upgrade and I will check it. Thanks!\n. No.\nThe app went through the Apple review, so now it stay on http with disabled ATS (NSAllowsArbitraryLoads).\n. Where is your connect method call?\n. ",
    "Sealos": "@larten, try this:\n- Disable ATS (Via NSAllowsArbitraryLoads in your Info.plist), check if you can establish a connection, but it's not recommended to leave it disabled.\n- If you have OS X v10.11 (El Capitan), theres a curl command available to check if your certificate fulfills all the ATP requirements, for example, even if you have a certificate and its not self signed, it could have issues with Certificate Transparency, or the certificate TLS version\n. @nuclearace I haven't found any issue using this on SSL, it's most likely an ATP issue.\n. @JAManfredi check your Info.plist configuration (One of my previous comment explains this)\nThis runs on both the simulator and physical device.\n``` swift\nprivate let url = \"https://x:3000\"\nlet socket = SocketIOClient(socketURL: url)\nfunc setupSocketIO() {\n    socket.on(\"connect\") { data, ack in\n        logger(\"socket connected\")\n        socket.emit(\"chat message\", \"what\")\n    }\nsocket.on(\"chat message\") { data, ack in\n    logger(data)\n}\n\nsocket.connect()\n\n}\n```\nProduces the following:\nSocketHelper.swift(18): socket connected\nSocketHelper.swift(23): [what sent by server.]\nI believe it's not an issue with this library.\n. ",
    "yyppaag": "ubuntu  + nginx (proxy), but no IOJS running on that server\n. No socket.io server is running. just normal domain like (www.google.com).\n. Version 3.1.4  Using pod install ,  XCode 7 && swift 2.0 && OS X 10.11\n. can not assume that name can use  dataUsingEncoding,  sometimes it just cann't .    For this situation , you can just connect to www.google.com, and you will get the crash.\n. I think no matter whatever server I connect to it is,  lib should not crash...\n. Thank you !\n. ",
    "YilunLiu": "I have the same issue.\n* WARNING: Skipping build for \"iphonesimulator\" SDK because the necessary signing identity \"iPhone Distribution\" is not installed\n* WARNING: Skipping build for \"iphoneos\" SDK because the necessary signing identity \"iPhone Distribution\" is not installed\nIt happens when I build for TvOs or iOS. Everything works fine for building for Mac.\n. Setting distribution code signing to developer fixed the problem for iOS\n. ",
    "jeremyfromearth": "It's at the bottom of viewDidLoad.\n. Ok, I figured out what was going on. I'll chalk it up to my own inexperience with Socket.io. :/\nI didn't realize that the socket was actually passed to the \"connection\" callback and that is where I should have been adding other event listeners. \nThanks for you help!\n``` javascript\nvar server = require('http').createServer();\nvar io = require('socket.io')(server);\nio.on('connection', function(socket){\n    console.log('connection');\n    console.log('server: sending ping');\n    socket.on('pong', function() {\n        console.log('server received pong');\n    });\nsocket.on('message', function(message) {\n    console.log('server received message: ' + message);\n});\nsocket.emit('ping');\n\n});\nio.listen(8900);\n```\n. ",
    "Hillsrion": "Thanks a lot, I spent too many time looking for the solution . ",
    "AlexChesters": "IIRC this CocoaPods issue is related to not having a high enough deployment target, @alinandrews I'd change the line:\npod 'Socket.IO-Client-Swift', '~> 3.1.4' # Or latest version\"\nTo read:\npod 'Socket.IO-Client-Swift', '~> 4.1.2'\nAnd see if the issue still occurs after running pod update\n. Do you ever make a connection? Does this line DDLogVerbose(@\"socket CONNECTED!\"); ever get called?\n. @NBibikov I don't believe that \"disables\" SSL, it merely allows HTTP connections to be made\n. You can use this library in Objective-C quite easily using CocoaPods if that is an option for you\n. I'm using socket.io fine on iOS 8 and above using Cocoapods, @benben-hello how have you installed the library?\n. Found on the status property of the Socket\n. in v5.2.0 the project name was changed, you'll have to update your cocoapods installation of the library to 5.2.0 or above.\nThen you can import like in your example\n. You can use this library in Objective-C code perfectly fine. Did you read the section in the README?\n. It would help the maintainers a lot if you posted the console output from the crash, otherwise they will struggle to determine where the issue is occurring.\n. @Siretfel\n\nCan I use the library with a non-socket.io server?\n\nAs @nuclearace has already pointed out above:\n\nit has to be a socket.io server\n\nSo no, you can't.\n. @arashdoescode I'm assuming @nuclearace did a typo, and meant to write iOS 7?\n. ",
    "alinandrews": "Guys\u00a0\nThanks for the follow ups. I wee offline for some weeks to see the messages.The issue was only from my end in the cocoa pods. \u00a0I had resolved it\u00a0\nGreat follow up to fix the issue. Thanks.\u00a0\nSent from Outlook\nOn Thu, Nov 19, 2015 at 2:15 PM -0800, \"Alex Chesters\" notifications@github.com wrote:\nIIRC this CocoaPods issue is related to not having a high enough deployment target, @alinandrews I'd change the line:\npod 'Socket.IO-Client-Swift', '~> 3.1.4' # Or latest version\"\nTo read:\npod 'Socket.IO-Client-Swift', '~> 4.1.2'\nAnd see if the issue still occurs\n\u2014\nReply to this email directly or view it on GitHub.\n. I don't remember now. I believe, I did cocoa pods complete re installation\nand did the following in podfile.\nsource 'https://github.com/CocoaPods/Specs.git'\nplatform :ios, '8.0'\nuse_frameworks!\npod 'Socket.IO-Client-Swift', '~> 3.1.4' # Or latest version\nIt did work.\nOn Wed, Nov 30, 2016 at 1:37 PM, spa-sandeep notifications@github.com\nwrote:\n\n@alinandrews https://github.com/alinandrews How you Solve this issue ?\nI am also Getting Same\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/208#issuecomment-263808797,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AFUPcEDjKFSVgAdPkxTcNPbpnroUF_Dkks5rDS6mgaJpZM4GPOoG\n.\n. \n",
    "spa-sandeep": "@alinandrews How you Solve this issue ?  I am also Getting Same . ",
    "2fours": "I call it from this event: [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(pause:) name:UIApplicationDidEnterBackgroundNotification object:nil] which I add in my view controller's viewDidLoad.\n. Assuming we're on iOS is there a way to do it consistently?\n. Correct.\nOn Oct 18, 2015 3:58 PM, \"Myles Ringle\" notifications@github.com wrote:\n\nYou just trying to close the socket when the app enters the background?\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/215#issuecomment-149053907\n.\n. @meismyles thanks I tried closing it from appdelegate, and also tried using [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:  neither seemed to make any difference.\n. Weird I'll see if I can reproduce the issue in a test project.\nOn Oct 19, 2015 10:28 AM, \"Myles Ringle\" notifications@github.com wrote:\nWeird. The second I close the socket or kill my app it closes immediately.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/215#issuecomment-149270530\n.\n. If I kill the app it disconnects immediately, or even if I put the phone to sleep by pressing power button. If I can make a simple project to reproduce the issue does that help? I didn't have this problem with 0.9.x. \n. If I use the simulator with iphone 6s and ios 9 it seems to work fine. I'm seeing the issues on an iphone 4 with 7.1. \n. Think I got this working. On 7.1.2 it seems the socket connection is put into a state where it can't send or receive from the server a lot more aggressively than on 8+ when home is pressed. If I configure things to use the voip background mode then the socket seems to disconnect every time. Not sure if this is the best solution but beginBackgroundTaskWithExpirationHandler: didn't seem to work.\n. Doesn't actually do voip stuff? How else could we get around it then. I can see when the app resumes that the disconnect completes, so 7.1.2 is definitely \"pausing\" the socket when home is pressed.\n. From the server.\n. On iOS 7.1.2?\n. Thanks I will try this and see if it helps.\n. 02971e1 doesn't seem to make any difference. Thanks everyone for your help.\n. The websocket close is implemented by sending a message from the device to the server. I'm using it to determine if the client is connected for the purpose of incrementing the badgenum new message count so the more timely it disconnects the better.\n. Think I found something. \n\nI put back the beginBackgroundTaskWithExpirationHandler: code with one change, I was calling endBackgroundTask when the socket disconnect event was received. If I comment this out it seems to disconnect every time.\n[self.socket on:@\"disconnect\" callback:^(NSArray * data, SocketAckEmitter * ack) {\n        DDLogInfo(@\"socket disconnect\");\n     //   [[UIApplication sharedApplication] endBackgroundTask:_bgTaskId];\n    }];\nThis seems to indicate there is some sort of timing issue between the socket actually being disconnected and the socket disconnect event being fired.\n. The documentation for applicationDidEnterBackground states that you only get 5 seconds: \nYour implementation of this method has approximately five seconds to perform any tasks and return. If you need additional time to perform any final tasks, you can request additional execution time from the system by calling beginBackgroundTaskWithExpirationHandler:. In practice, you should return from applicationDidEnterBackground: as quickly as possible. If the method does not return before time runs out your app is terminated and purged from memory.\nI'd rather use beginBackgroundTaskWithExpirationHandler and have more control over that time. I'm already using it elsewhere and it works well. I agree that closing the socket shouldn't need to be a background task - apparently on iOS > 7.1.2 this is the case. I don't need to listen for the disconnect on the device and now that I've uncovered the behavior I won't, but I still think the behavior is strange and should be looked at by the developer of the library. Thanks.\n. Not sure if this helps but I put some logging in the doDisconnect function of WebSocket.swift and it looks like doDisconnect gets called twice:\n2015-10-19 17:29:32.261 surespot[1694:8617] Log WebSocket: doDisconnect, 0, error: Optional(Error Domain=Websocket Code=1000 \"connection closed by server\" UserInfo=0x17d22360 {NSLocalizedDescription=connection closed by server})\n2015-10-19 17:29:32.272 surespot[1694:8617] Log WebSocket: doDisconnect, 0, error: nil\nSo perhaps the first doDisconnect is getting called prematurely? \n. Not seeing this anymore with https://github.com/socketio/socket.io-client-swift/commit/6c779e84d2d3ae079db9fba536c6c1755409a875 and 1.4.5 on the server.\n. Hm I can't reproduce it in a demo project I'll take a closer look at my code. Thanks.\n. This is how I differentiate disconnects for now (v13.2.0) until there's concrete status codes or something:\n[self.socket.defaultSocket on:@\"disconnect\" callback:^(NSArray * data, SocketAckEmitter * ack) {\n    //server disconnect seems to yield data of \"Socket Disconnected\" vs client with \"Disconnect\" so only attempt reconnect when server disconnects\n    id object0 = [data objectAtIndex:0];\n    if ([object0 isEqualToString:@\"Socket Disconnected\"]) {\n        [self reconnect];\n    }\n}];. @wongzigii Luckily we're in control of when to update the libraries we depend on and can check to see if things are broken. Perhaps one could even write a unit test. Also me saying \"until there's concrete status codes or something\" hints to the existence of obvious issues like the one you point out.. This is how I do it for now (v13.2.0) until there's concrete status codes or something:\n[self.socket.defaultSocket on:@\"disconnect\" callback:^(NSArray * data, SocketAckEmitter * ack) {\n    //server disconnect seems to yield data of \"Socket Disconnected\" vs client with \"Disconnect\" so only attempt reconnect when server disconnects\n    id object0 = [data objectAtIndex:0];\n    if ([object0 isEqualToString:@\"Socket Disconnected\"]) {\n        [self reconnect];\n    }\n}];. ",
    "Glagnar": "I have the issue where eventough the client closes the connection, the server only gets the disconnect event after about 30 seconds.\nswift\nprivate var socket: SocketIOClient?\npublic func stopConnection() {\n   debugPrint(\"Remote Connection Closing\")\n   socket?.close()\n   socket = nil\n}\nIn my case, the client disconnects and does some cleanup in the \nsocket?.on(\"disconnect\")\nbut the server waits for 30 seconds before firing the disconnect.\nRunning iOS 7.2 btw.\n. ",
    "Farbod909": "Hi,\nI'm not sure if this applies to you guys, but I found that the best way that socket io has been working for me is with the use of a singleton.\nI created the following singleton class:\n``` Swift\nclass SocketIOManager {\nstatic let sharedInstance = SocketIOManager()\n\nvar socket: SocketIOClient\n\ninit() {\n\n   self.socket = SocketIOClient(\n            socketURL: \"someUrl.com\",\n            options: [.ForcePolling(true)]\n   )\n\n}\n\nfunc connectSocket() {\n    self.socket.connect()\n}\nfunc disconnectSocket() {\n    self.socket.disconnect()\n}\nfunc socketStatus() -> SocketIOClientStatus {\n    return socket.status\n}\n\n}\n```\nAfter doing all that, I can easily call SocketIOManager.sharedInstance.connectSocket() and SocketIOManager.sharedInstance.disconnectSocket() anywhere and it connects and disconnects from the server immediately.\nI'm sorry if this is not what you are looking for, but I also had a problem where the server was not receiving my disconnect event, so I figured I'd post my solution here. In my case, I'm assuming the problem was because multiple instances of the socket variable were being created and calling socket.disconnect() may not have been disconnecting the correct instance. Creating a singleton makes sure there is only one instance.\n. ",
    "codeHusky": "Drag and drop, add to target\n. Oh, oops!\n. ",
    "cmnewfan": "it is not a socket.io server, i guess i can not use this library with the server\n. ",
    "ruandao": "\n\ni was use the last version:\nCommits on Apr 12, 2016\n1b4b571be66e28cf20632e289c4c1a9b6fafce60\n. ",
    "janiduw": "That would be helpful. May I know how this property was initially planned to be used ?\n. The actual use case is that there is a voip server running on an embedded device. This device does not have any access to the internet. I'm planning to use socket.io on this embedded device to push real time information to the iOS app, things like device temperature etc.\n. ",
    "ramazanpolat": "@janiduw Can you provide how you keep the Socket connection when in background?\n. ",
    "Catharsis68": "Thanks for the fast response!\nThe Dict in Swift looks like this:\nswift\nlet authConfig = [\n                    \"user\": \"bla\",\n                    \"password\": \"blo\",\n                    \"language\": \"EN\",\n                    \"number\": 16000\n                ]\nThought they are equal.\n. ",
    "dtorguet": "Ups! Thanks very much.\nCould you write it in objective-C please\n. Thanks very much! ;)))\n. Sorry but (@\"socketDelegate\": self )no work!  I updated to v4.0.4 also I try with (@\"SessionDelegate\": self)  but neither worked.\nSocketIOClient* socket = [[SocketIOClient alloc] initWithSocketURL:@\"https://xx.126.255.xx/\" options:@{@\"path\": @\"xatsocket/\", @\"SessionDelegate\": self, @\"log\": @YES, @\"forcePolling\": @YES}];\n never call to NSURLSessionDelegate.\nany idea that does not work?\nI need to call URLSession: didReceiveChallenge: completionHandler:\nMy class have the protocol implemented.\n@interface DetailsViewController : UIViewController\nand the protocol's method too.\nThanks\n. sorry but for me, (@\"socketDelegate\": self) no work!\nthat's a pitty!\nThanks\n. yes, this is my code in a ViewController\n.h\nimport \n@interface DetailsViewController : UIViewController < NSURLSessionDelegate >\n.m\n- (void)viewDidLoad {\nself.socket = [[SocketIOClient alloc] initWithSocketURL:@\"https://xx.126.255.xx/\" options:@{@\"path\": @\"xatsocket\", @\"socketDelegate\": self}];\n    [self.socket on:@\"connect\" callback:^(NSArray* data, SocketAckEmitter* ack) {\n        NSLog(@\"socket connected\");\n    }];\n    [self.socket on:@\"currentAmount\" callback:^(NSArray* data, SocketAckEmitter* ack) {\n        double cur = [[data objectAtIndex:0] floatValue];\n    self.socket emitWithAck:@\"canUpdate\" withItems:@[@(cur)];\n    [ack with:@[@\"Got your currentAmount, \", @\"dude\"]];\n    }];\n     [self.socket connect];\n}\npragma mark - NSURLSessionDelegate\n\n(void)URLSession:(NSURLSession )session didReceiveChallenge:(NSURLAuthenticationChallenge )challenge\n  completionHandler:(void (^)(NSURLSessionAuthChallengeDisposition disposition, NSURLCredential * credential))completionHandler{\n    if([challenge.protectionSpace.authenticationMethod isEqualToString:NSURLAuthenticationMethodServerTrust]){\n        if([challenge.protectionSpace.host isEqualToString:@\"xx.126.255.xx\"]){\n            NSURLCredential *credential = [NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust];\n            completionHandler(NSURLSessionAuthChallengeUseCredential,credential);\n        }\n    }\n  }\n\nany idea?\n. yes I write \n@interface DetailsViewController : UIViewController <NSURLSessionDelegate>\n. ",
    "luzianscherrer": "Did you ever get this working? I am having the exact same issue, the delegate is not getting called despite having set\n[params setObject:self forKey:@\"sessionDelegate\"];\nI'm using the same object for dataTaskWithRequest connections and there the - (void)URLSession:(NSURLSession *)session didReceiveChallenge:(NSURLAuthenticationChallenge *)challenge completionHandler:(void (^)(NSURLSessionAuthChallengeDisposition, NSURLCredential * _Nullable))completionHandler does get called.\n. Yes.\nAm 14.06.2016 15:21 schrieb \"Erik Little\" notifications@github.com:\n\nAre you also forcing Websockets?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/395#issuecomment-225878673,\nor mute the thread\nhttps://github.com/notifications/unsubscribe/ACI-DL_bLYzDr5ZB_Cn28OdUFFzmEIRRks5qLqregaJpZM4I1NB1\n.\n. Very helpful, thanks! You are absolutely right, when I remove the forceWebsockets parameter the NSURLSessionDelegate does get called as expected. But now I wonder: how can I get SSL pinning working when I need to have forceWebsockets enabled?\n. It's as simple as this: normally any SSL certificate which is issued by a CA that is in the iOS truststore is allowed. With SSL pinning you just allow that one specific certificate that you expect from your server. This is usually done in the - (void)URLSession:(NSURLSession *)session didReceiveChallenge:(NSURLAuthenticationChallenge *)challenge completionHandler:(void (^)(NSURLSessionAuthChallengeDisposition disposition, NSURLCredential * __nullable credential))completionHandler; callback.\n. Thanks for that pointer. Looks like it's about time to learn Swift :/\n. But the comment \nparameter usePublicKeys: is to specific if the publicKeys or certificates should be used for SSL pinning validation\n\nabove the init method looks somewhat promising...\n. Cool, thanks. I'll do that but it will take some time... I'll get back to you asap.\n. Unrelated: that's what I'm hearing all the time :)\n. Sorry I'm not really getting it. The idea would be to pass in an instance of a SSLSecurity object as parameter \"security\", right? But how could I do that since SSLSecurity is declared as a private class?\n. Ah, I was just about to write that SSLSecurity should extend NSObject in order to be able to access it from Obj-C...\nBut currently I'm fighting with another problem: I'm having some difficulties upgrading to the latest version (was using 4.1.5 before). I was using #import <Socket_IO_Client_Swift/Socket_IO_Client_Swift-Swift.h> before and have now changed to #import <SocketIOClientSwift/SocketIOClientSwift-Swift.h>. The latter contains the correct definitions for the new stuff (SSLSecurity, etc) but somehow the former seems to still get used or referenced because when I click on one of your methods, Xcode jumps to the former. I've tried clean/rebuild many times and I'm currently not sure what this is all about.\n. In my case that workaround didn't help. If I do it that way then it crashes at SocketIOClient.swift line 116 (which is the end of the deinit { ... } ) with EXC_BAD_ACCESS.\n. I can confirm the same thing. After adding [self.manager disconnect]; before every [self.socket disconnect]; in my code, things are working as expected again.. ",
    "jgimenez": "Yes, in my package.json I'm using \"socket.io\": \"~1.3.7\"\n. I'm trying to figure out how to reproduce then. Will reopen if I find out. Thanks for your time.\n. ",
    "arietis": "Will try, thanks! :)\n. ",
    "robinhayward": "I don't use Cocoapods so yes, the files are in my (Swift) project\n. It's not always possible to use Cocoapods, it's a shame no one is interested in manually installable source these days.\n. Ah awesome, sorry, I just mis-interpreted 'closed' as the end of the discussion.\nThanks very much!\n. ",
    "Antowkos": "I know about few seconds of background execution. You didn't understand me right. \nThe bug happens sometimes. It could happen even right after successful connection without minimize/maximize app. I try to describe it again:\nImplementation of SocketIOClient created and connected. Status is SocketIOClientStatusConnected. I can receive messages from server. But emit:withItems: method not work.\n. Nope. I emit sometime after connection. But before emit i check socket client's status and it's SocketIOClientStatusConnected. Actually it doesn't matter when i will emit after this bug occur. I won't be able to emit until reconnect.\nAbout logging - I will try to turn it on, but i'm not sure it will say something. I subscribe to error event but it never happens. \n. Hi again. I tried to turn on logs and i can see the following when everything is ok: \nLog SocketIOClient: Emitting: 2[\"myEvent\",{\"id\":600}]\nLog SocketEngine: Writing ws: 2[\"myEvent\",{\"id\":600}] has data: 0\nLog SocketEngine: Sending ws: 2[\"myEvent\",{\"id\":600}] as type: 4\nBut when the bug occur i can see only this\nLog SocketIOClient: Emitting: 2[\"myEvent\",{\"id\":600}]\nIn both cases after all i see this staff:\n...\nLog SocketEngine: Writing poll:  has data: 0\nLog SocketEngine: Sending poll:  as type: 2\nLog SocketEngine: POSTing: 1:2\nLog SocketEngine: Doing polling request\nLog SocketEngine: Got polling response\nLog SocketEngine: Got message: 3\nLog SocketEngine: Doing polling request\nLog SocketEngine: Writing poll:  has data: 0\nLog SocketEngine: Sending poll:  as type: 2\nLog SocketEngine: POSTing: 1:2\nLog SocketEngine: Doing polling request\nLog SocketEngine: Got polling response\nLog SocketEngine: Got message: 3\nLog SocketEngine: Doing polling request\nLog SocketEngine: Writing poll:  has data: 0\nLog SocketEngine: Sending poll:  as type: 2\n...\nSo i don't see any errors or something like that. Just silence after emit.\n. I tried to force WebSockets and now i can't catch this bug. It works more stable and faster. What exactly does this forceWebsockets option do?\n. ",
    "SerhiiPrime": "I have the same bug, after each \"connect\" I have to emit new client configurations to my server, but sometimes emit action doesn't perform.\nsocket.on(\"connect\") {data, ack in\n       socket.emit(\"updateSession\", /*some token*/)\n    }\n. In the right case I have: \nLog SocketIOClient: Emitting: 2[\"updateSession\",{\"user\":\"565c56588712008d324bd01e\"}]\nLog SocketEngine: Writing ws: 2[\"updateSession\",{\"user\":\"565c56588712008d324bd01e\"}] has data: 0\nLog SocketEngine: Sending ws: 2[\"updateSession\",{\"user\":\"565c56588712008d324bd01e\"}] as type: 4\nBut its hardly to reproduce incorrect case\n. ",
    "patriksharma": "Hello , \nDoes anyone knows what is this bug. I'm facing same issue. I got connected and authenticated true using emit. When I call another event to change password , its not showing any output to me.\n```\nlet PasswordDict: [String : AnyObject] = [\n    \"newPassword\" :\"123456\" as AnyObject,\n    \"password\" :\"654321\" as AnyObject\n\n    ]\n\nself.hubConnection.emit(\"USER_CHANGE_PASSWORD\", with: [PasswordDict as Any])\n```\nLog response : \n```\nEmitting: 2[\"USER_CHANGE_PASSWORD\",{\"newPassword\":\"123456\",\"password\":\"654321\"}]\n2016-09-28 15:22:07.017 FApp[21664:1267871] LOG SocketEngine: Writing poll: 2[\"USER_CHANGE_PASSWORD\",{\"newPassword\":\"123456\",\"password\":\"654321\"}] has data: false\n2016-09-28 15:22:07.018 FApp[21664:1267871] LOG SocketEnginePolling: Sending poll: 2[\"USER_CHANGE_PASSWORD\",{\"newPassword\":\"123456\",\"password\":\"654321\"}] as type: 4\n2016-09-28 15:22:07.018 FApp[21664:1267871] LOG SocketEnginePolling: Created POST string: 71:42[\"USER_CHANGE_PASSWORD\",{\"newPassword\":\"123456\",\"password\":\"654321\"}]\n2016-09-28 15:22:07.018 FApp[21664:1267871] LOG SocketEnginePolling: POSTing\n2016-09-28 15:22:07.019 FApp[21664:1267871] LOG SocketEnginePolling: Doing polling request\n2016-09-28 15:22:07.353 FApp[21664:1268409] LOG SocketEngine: Writing poll:  has data: false\n2016-09-28 15:22:07.354 FApp[21664:1268409] LOG SocketEnginePolling: Sending poll:  as type: 2\n. @nuclearace  closing issue. its rsolved. All i need to do is add callback to emit event to get result. \n. @mohammedalicelik\n self.hubConnection.emitWithAck(\"EVENTNAME\", tmp as! SocketData)(5) {data in\n                   print (data)\n            }\n\n```. @nuclearace  why closed that issue ? I never received any response on that ?\n. ",
    "art-of-dreams": "Yea, i'm not very experienced at swift, noticed this leak in my obj-c app and decided just let you know. So is it better to use version 3.1.6 from obj-c?\n. Clearly, thanks for the reply.\n. ",
    "Lincolnnus": "Hi Erik,\nThe bug was from the server end, we've fixed that. Seems the secure flag\ndoes not matter.\nThanks for your advise on the Swift code.\nOn Tuesday, 1 December 2015, Erik Little notifications@github.com wrote:\n\nAny updates?\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/234#issuecomment-160720545\n.\n\n\nBest Regards,\nShaohuan Li\n. ",
    "cqin5": "@nuclearace Sorry that I forgot about this. \n. ",
    "aly-irshad": "Hello @nuclearace ,\nHaving the same type of crash on SocketEventHandler.executeCallback in SocketIOClient.swift line no 430  and unable to track the reason. The screenshot might help you to understand whats the issue.\n\n. Hello @nuclearace,\nMeans I should use the same queue for all socket operations. Actually I am having multiple queues for every listener I am adding to the socket. Is this is the problem. Please correct if I am wrong.. Ok Thanks, I will update my code accordingly.. ",
    "janroures": "i've also tried joining with         \nsocket = SocketIOClient(socketURL: path, options: [.Log(true), .ForcePolling(true), .Nsp(\"/whatever\")]) \nand\nsocket = SocketIOClient(socketURL: path, options: [.Log(true), .ForcePolling(true), .Nsp(\"whatever\")])\nbut non of these work either. thanks.\n. sometimes they are, sometimes they aren't. is it possible to \"open\" a namespace from the client?\nbtw, thanks for such a quick response.\n. then, how is it that I can open it from the browser client but not the ios app? My goal is that the user has to join a namespace of his choice. any approach for this? thanks\n. var socket = io.connect('http://\"ip\":\"port\"/'+whatever);\nthat's what I'm using\n. that's odd. Is there any way to send data to the server along the connect event? Would like to send the namespace \"name\" so I can open it from the server before joining from the client. Thanks.\n. Will look into it. Thanks.\n. ",
    "dpakthakur": "let manager = SocketManager(socketURL: URL(string: SOCKET_URL)!, config: [.log(true), .compress])\nlet socket = manager.socket(forNamespace: \"/whateverNamespace\");. Check my answer in #236. This is an issue with cocoa pods I think. Do the following steps to run.\n1. Close Xcode and Re-open. Then Shift + Cmd + K to clean. \n2. Product -> Build For -> Testing (Shift Cmd U)\n3. You will still see the error, but you just have to hit the \"Run\" button on Top Left of Xcode until build automatically succeeds and then the error goes. . ",
    "ramden": "The structure is like this\njavascript\n                 haproxy \n(load balancer, initial connect location)\n                       |\n     ---------------------------------\n     |                 |             |\n   node1        node2        node3(this node)\nI believe its node3 (the library was connected to at first). When terminating node3 the library should do a reconnect to haproxy ip instead of continue pooling. The library gets stuck when loosing its session and doesn't do reconnect. \nThe most logical thing that comes into my mind is : continue pooling, have a timeout parameter (that can be passed into the library) when timeout is over do a reconnect that would reconnect to haproxy (that would forward it to node1 or node2).\n. Yes, the app is connected to node 3 from diagram. When the node3 stops, we get this sort of problems, does not reconnect so it would go to haproxy again and be reconnected to some other active node\n. It is setup with tcp mode and working very well with one node (on multiple nodes with android) .We will try the newest master\n. Now it got worse. For test we connect to the server, then we kill node. Upon starting node again (only one node this time) the library is connecting trying to reconnect. After randomly 3 - 10 times it reconnects. The whole time we get (on server) that the client connected. Then it connects again and again 10 times until it stops\n. In the described scenario a force new would make sense. The problem is that after 5XX and 4XX it gets stuck on the old sid. We have to close the app (put to background) and reopen to get a new sid, but as long as the screen is opened the session is lost forever\n. Yes, the disconnect is not fired, the 502 and 503 responses from the server are just being displayed as logs. The reconnect loop continues with the old sid (until closing the app and reopen = disconnect, connect)\n. Yes, currently on last version (4.1.2)\n. ",
    "cwoloszynski": "I just realized that I had prefixed the hostname with 'ws://'.  For those that follow behind, the socketURL is not expected to have a protocol indicator.\n. Thanks for the pointer to connectParams.  \nFor those that might have the same question, I used the following code to address this issue.  \nself.socket = SocketIOClient(socketURL: baseWebSocketServerURL, \noptions: [SocketIOClientOption.ConnectParams([\"__sails_io_sdk_version\":\"0.11.0\"])])\nThis allowed me to use Sails.js v0.11.0 without having to modify the server.\n. ",
    "zaigham-mt": "Optimization level is set to None. We have tried it for Fast but using that crash was more frequent.\n. We have tried it for optimizations off and on , but still have crashes.\nOn Mon, Nov 23, 2015 at 8:55 PM, NachoSoto notifications@github.com wrote:\n\nDoes this only happen with optimizations on? If so it's a known bug that\ncan only be fixed by lowering optimizations\nCurious: where are you tracking thus known bug? I'd like to bring it to\nthe attention of the Swift compiler team if it's really a bug.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/241#issuecomment-158977338\n.\n\n\nBest Regards\nZaigham Maqsood\nskype: zaigham.maqsood\n. I am getting same message as civocr.\nOn Tue, Nov 24, 2015 at 7:01 AM, civocr notifications@github.com wrote:\n\nI'm getting the same type of crash on the following line:\nif dataLength == 127 {\nlet bytes = UnsafePointer((buffer+offset))\n* dataLength = bytes[0].bigEndian *\nSocket_IO_Client_Swift`Socket_IO_Client_Swift.WebSocket.(buffer=,\nbufferLen=, self=) (Socket_IO_Client_Swift.WebSocket)(Swift.UnsafePointer,\nbufferLen : Swift.Int) -> () + 5948 at WebSocket.swift:495, queue =\n'com.apple.root.default-qos', stop reason = EXC_BAD_ACCESS\n(code=EXC_ARM_DA_ALIGN, address=0x16a3880a)\nIt only seems to crash if I'm using an SSL connection. Optimisation is set\nto None -00\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/241#issuecomment-159129836\n.\n\n\nBest Regards\nZaigham Maqsood\nskype: zaigham.maqsood\n. Some times I am getting another crash.Attached screenshot.\nwarning: could not load any Objective-C class information from the dyld\nshared cache. This will significantly reduce the quality of type\ninformation available.\nOn Tue, Nov 24, 2015 at 3:13 PM, Zaigham Maqsood \nzaigham.maqsood@maavratech.com wrote:\n\nI am getting same message as civocr.\nOn Tue, Nov 24, 2015 at 7:01 AM, civocr notifications@github.com wrote:\n\nI'm getting the same type of crash on the following line:\nif dataLength == 127 {\nlet bytes = UnsafePointer((buffer+offset))\n* dataLength = bytes[0].bigEndian *\nSocket_IO_Client_Swift`Socket_IO_Client_Swift.WebSocket.(buffer=,\nbufferLen=, self=) (Socket_IO_Client_Swift.WebSocket)(Swift.UnsafePointer,\nbufferLen : Swift.Int) -> () + 5948 at WebSocket.swift:495, queue =\n'com.apple.root.default-qos', stop reason = EXC_BAD_ACCESS\n(code=EXC_ARM_DA_ALIGN, address=0x16a3880a)\nIt only seems to crash if I'm using an SSL connection. Optimisation is\nset to None -00\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/241#issuecomment-159129836\n.\n\n\nBest Regards\nZaigham Maqsood\nskype: zaigham.maqsood\n\n\nBest Regards\nZaigham Maqsood\nskype: zaigham.maqsood\n. I am getting it for IOS 9.0.\nOn Tue, Nov 24, 2015 at 10:30 PM, Erik Little notifications@github.com\nwrote:\n\nCan't reproduce on OS X\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/241#issuecomment-159349221\n.\n\n\nBest Regards\nZaigham Maqsood\nskype: zaigham.maqsood\n. on line s.delegate?.websocketDidReceiveMessage(s, text: str! as String) getting EXC_Bad_Access\n. ",
    "civocr": "I'm getting the same type of crash on the following line:\nif dataLength == 127 {\n                let bytes = UnsafePointer((buffer+offset))\n               * dataLength = bytes[0].bigEndian *\nSocket_IO_Client_Swift`Socket_IO_Client_Swift.WebSocket.(buffer=, bufferLen=, self=) (Socket_IO_Client_Swift.WebSocket)(Swift.UnsafePointer, bufferLen : Swift.Int) -> () + 5948 at WebSocket.swift:495, queue = 'com.apple.root.default-qos', stop reason = EXC_BAD_ACCESS (code=EXC_ARM_DA_ALIGN, address=0x16a3880a)\nIt only seems to crash if I'm using an SSL connection. Optimisation is set to None -00\n. Optimisations for Debug are set to None [-O0]\nI tried adding SWIFT_OPTIMIZATION_LEVEL = \"-Onone\" to my build settings but still crashes when a big dataset is returned over the socket\n. cocopods\nplatform :ios, '8.3'\nuse_frameworks!\npod 'Socket.IO-Client-Swift', '~> 4.1.2'\n. sorry this was my mistake. I was trying to set my project to swift optimisation none. I changed the socket pod project to none and it works\n. ",
    "guilhermeKodama": "I am getting the same error when streaming a sensor signal in a high frequency (1k/s)\n\"could not load any Objective-C class information. This will significantly reduce the quality of type information available.\"\n. ",
    "NBibikov": "No connection is not established now. But this code have worked and i think that i don't edit it after that\n. I have disabled SSL with line \"Allow Arbitrary Loads\" in info.plist. is that correct? About server settings - Android client has connection and works well. Can this be  with wrong settings on server?\n. Oh, ok! @AlexChesters what i need do on client side or server side for check SSL?\n. ",
    "sharjeel-ahmed": "So is this a bug or not? my on event not being fired. \n. ",
    "ilandbt": "Works... thanks.\n. But my app is crashing in random places with the socket object.. see in image:\nhttps://image.ibb.co/jq1XNv/sio1.png\nits my crashlytics report.\nit seems very random crashes but all of them are in SocketIO. That's exactly my problem it crashes every time in a different location in SocketIo's code.\nThanks anyway.. ",
    "oleduc": "For that we will need a replacement for the objective-c Security framework.\n. We can't use objective-c frameworks on linux. Security framework is an objective-c library, or at least I think so.\n. Oh good, I thought we were using it for SSL.\n. ",
    "yanniks": "Any updates on this?. ",
    "vyacheslavk": "Yes! Thx. that solved my problem\n. ",
    "orensha": "Hi, i changed the to Xcode 7.2 and now the swift files compile.\nbut i have another problem. I\u2019m using the \u2018connected\u2019 variable of \u2018SocketIOClient\u2019  but in the current sdk it doesn\u2019t apear. what other option do i have replacing it? thanks\nOn Dec 16, 2015, at 5:42 PM, Erik Little notifications@github.com<mailto:notifications@github.com> wrote:\nWhat is the current sdk. Because it works fine with Xcode 7.2. You probably forgot to add stuff to your target\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/socketio/socket.io-client-swift/issues/264#issuecomment-165148734.\n. Thanks it works.\nOn Dec 22, 2015, at 4:58 PM, Erik Little notifications@github.com<mailto:notifications@github.com> wrote:\nYou have to check the status of the socket. https://github.com/socketio/socket.io-client-swift/blob/master/Source/SocketIOClientStatus.swift#L28\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/socketio/socket.io-client-swift/issues/264#issuecomment-166637318.\n. had a mix of the older version. thanks.\n. but i got another problem now. what replaces the 'connected' variable in 'SocketIOClient' ?\nim checking in my code if im connected or connecting.\n. yes but how does it work? what do i compare it with>\n. I'v tried it, but i think my problem is that my project doesn't recognize the new swift files. thanks ill check it out.\n. ok found the problem with this line. because im writing in objective c i cant use the swift syntax and use \"_socketIOClient.status == .Connected\", instead there is the objective c translation of the enum: \"_socketIOClient.status == SocketIOClientStatusConnected\". \n. now using the new sdk. im trying to connect but get this logs:\nLOG SocketIOClient: Adding handler for event: connect\n LOG SocketIOClient: Adding handler for event: update\n LOG SocketIOClient: Client is being released\nwhy client being released?\n. thanks man. forgot to set it as a property of the class. cheers.\n. Hi, i didnt use pods, i dragged the source files to the projects. but i tried to use pods after your answer and got all of this errors\n\nthats the pod file\n\n. ",
    "sotownsend": "Hey @NachoSoto \nYes, you are correct.  I have not had issues with issuing this directly with carthage.  Let me illustrate when I do have an issue...\nIf I have a custom framework, hosted on Github, that uses CocoaPods to construct it's dependencies:\n\nThe resulting framework, when built by the xcodeproject, has a dynamic import for the framework at the path @rpath/Socket_IO_Client_Swift.framework/Socket_IO_Client_Swift  The Socket_IO_Client_Swift naming convention for the framework is dynamically assigned by CocoaPods based on the pod's name.\nNow if my custom framework is then taken and used in a carthage project, I only have to tell the user to include the socket.io dependency in their cart file as carthage will just build the cocoa-pods managed xcodeproj.\n\nHowever, when carthage builds the custom framework and the socket.io framework, the custom framework will attempt to import @rpath/Socket_IO_Client_Swift.framework/Socket_IO_Client_Swift but carthage will have built the framework based on the original product name of SocketIO so the linker will only have a framework at @rpath/SocketIO.framework/SocketIO.\n\nIn a much more trivial sense, using carthage with import Socket_IO_Client_Swift will fail assuming you dump the cache from ~/Library/Xcode.  You have to use the name import SocketIO when using carthage.\n\n. @NachoSoto I agree with your sentiment, but that is a question of philosophy :)\nCould you please reconsider this pull request?  Pretty please?  :)  Alternatively, we could add a flag to the pod-spec to change the product-name to SocketIO.\n. ",
    "benben-hello": "Version 7.2 \n. Yes, IOS9 without any problem but in 8.3 will not compile\n. When I reading the source code, I found that when I call disconnect method the 'reconnects = false', but when I again call the connect method I have not found   the 'reconnects = true',So, I don't know the reason is because of this\n. @sagardesai16 Did you solve this problem?\n. When the user logged out I should  call disconnect ,but the user login I should  call connect,However  It won't be reconnect forever.\n. I use the singleton, like this\n```\n@interface SCWebSocket ()\n@property (nonatomic,strong) SocketIOClient *socket;\n@end\n@implementation SCWebSocket\nstatic id instance = nil;\n/\n *  \u9ed8\u8ba4\u7684SCWebSocke \u5b9e\u4f8b\n \n *  @return \u8fd4\u56de\u4e00\u4e2a \u9ed8\u8ba4\u7684SCWebSocke \u5b9e\u4f8b\n /\n+ (instancetype)defaultClient {\n    static dispatch_once_t onceToken = 0;\n    dispatch_once(&onceToken, ^{\n        instance = [[self alloc] init];\n    });\n    return instance;\n}\npragma mark - \u521d\u59cb\u5316\n\n(instancetype)init {\n    self = [super init];\n    if (self) {self.socket = [[SocketIOClient alloc] initWithSocketURL:[NSURL URLWithString:SCAppBaseURLString] options:@{\n                                                                                                           @\"log\" : @NO,\n                                                                                                           @\"forcePolling\" : @YES,\n                                                                                                           @\"reconnectWait\" : @(5)\n                                                                                                           }];\n\n//\u76d1\u542c\u4e8b\u4ef6\n[self.socket on:@\"connect\" callback:^(NSArray * data, SocketAckEmitter * ack) {\n    SCLogDebug(@\"==SCWebSocket=\u8fde\u63a5\u6210\u529f%@\",data);\n    if ([SCUser currentUser].userId) {\n        [self emit:@\"online\" withItems:@[@{@\"userId\":[SCUser currentUser].userId}]];\n    }\n}];\n\n[self.socket on:@\"disconnect\" callback:^(NSArray * data, SocketAckEmitter * ack) {\n    SCLogDebug(@\"\u65ad\u5f00\u8fde\u63a5===%@\",data);\n}];\n\n[self.socket on:@\"reconnect\" callback:^(NSArray *data, SocketAckEmitter *ack) {\n    SCLogDebug(@\"\u91cd\u8fde\u4e2d...\");\n}];\n\n//\u8fde\u63a5\u51fa\u9519\u4e86\n[self.socket on:@\"error\" callback:^(NSArray * data, SocketAckEmitter * ack) {\n    SCLogError(@\"==SCWebSocket=\u51fa\u9519\u4e86\uff1a%@----%@\",data,ack);\n}];\n\n//\u76d1\u542c\u7cfb\u7edf\u901a\u77e5\n[self.socket on:@\"notification\" callback:^(NSArray * data, SocketAckEmitter * ack) {\n    [[NSNotificationCenter defaultCenter] postNotificationName:kOfficialNotification object:data];\n}];\n\n//\u76d1\u542c\u5220\u9664\n[self.socket on:@\"delete\" callback:^(NSArray * data, SocketAckEmitter * ack) {\n    [[NSNotificationCenter defaultCenter] postNotificationName:kDeleteNotification object:data];\n}];\n\n//\u76d1\u542c\u7981\u8a00,\u5c01\u505c\n[self.socket on:@\"push\" callback:^(NSArray * data, SocketAckEmitter * ack) {\n    if (data) {\n        NSString *dataString = [data firstObject];\n        NSError* error;\n        NSData* messageData=[dataString dataUsingEncoding:NSUTF8StringEncoding];\n        NSDictionary* dataDic=[NSJSONSerialization JSONObjectWithData:messageData options:NSJSONReadingMutableContainers error:&error];\n        NSNumber *typeNumber = [dataDic objectForKey:@\"pushType\"];\n        switch (typeNumber.intValue) {\n            //\u9519\u8bef,\u56e0\u542b\u6709\u654f\u611f\u8bcd\u88ab\u7981\u6b62\u64cd\u4f5c\n            case 0:\n\n                break;\n            //\u8d26\u53f7\u88ab\u5c01\u505c \u65e0\u6cd5\u8fde\u63a5\u5373\u65f6\u901a\u8baf\u670d\u52a1\u5668\n            case 1:\n            {\n                NSData *pushData=[[dataDic objectForKey:@\"pushContent\"] dataUsingEncoding:NSUTF8StringEncoding];\n                NSDictionary *pushContent=[NSJSONSerialization JSONObjectWithData:pushData options:NSJSONReadingMutableContainers error:nil];\n                NSString *punishTime = [NSString stringWithFormat:@\"\u60a8\u7684\u8d26\u53f7\u5df2\u88ab\u5c01\u505c\u81f3:%@ \u6682\u65f6\u65e0\u6cd5\u767b\u9646\",[pushContent objectForKey:@\"punishTime\"]];\n\n                UIAlertController *alertController = [UIAlertController alertControllerWithTitle:@\"\u8d26\u53f7\u5c01\u505c\u901a\u77e5\" message:punishTime preferredStyle:UIAlertControllerStyleAlert];\n\n                UIAlertAction *action = [UIAlertAction actionWithTitle:@\"\u786e\u5b9a\" style:UIAlertActionStyleDestructive handler:^(UIAlertAction * _Nonnull action) {\n                    AppDelegate* appDelegate =(AppDelegate *)[UIApplication sharedApplication].delegate;\n                    [appDelegate switchToLoginView];\n                }];\n\n                [alertController addAction:action];\n\n                [[UIApplication sharedApplication].keyWindow.rootViewController presentViewController:alertController animated:YES completion:nil];\n\n            }\n                break;\n\n            //\u7981\u8a00\n            case 2:\n\n                break;\n            //\u5ef6\u8fdf\u53d1\u9001\n            case 3:{\n                NSError* terror;\n                NSData* timeData=[[dataDic objectForKey:@\"pushContent\"] dataUsingEncoding:NSUTF8StringEncoding];\n                NSDictionary* timeDic=[NSJSONSerialization JSONObjectWithData:timeData options:NSJSONReadingMutableContainers error:&terror];\n\n                    NSNumber *time = [timeDic objectForKey:@\"emitDelayTime\"];\n                    [[NSNotificationCenter defaultCenter]postNotificationName:kSendTimeNotification object:time];\n                break;\n            }\n\n            default:\n                break;\n        }\n    }\n}];\n\n}\nreturn self;\n}\n```\n. \n\n",
    "ka05": "Please excuse my ignorance but I don't understand what acks are or how i would use them in my api. Ive looked around a bit but I cant find anything about how to make my api send acks. Could you please point me in the right direction?\n. Okay thanks but what are acks? and how can I implement that on the server?\n. Okay I have just tried that and im still not getting anything back. Additionally nothing is being logged out on the server when the emit in the swift code is called. I must be doing something very wrong.\nHere is the server code:\nvar app = express();\nserver = app.listen(process.env.PORT || 3000);\nvar io = require('socket.io').listen(server);\nio.on('connection', function(socket){\n  socket.on('validateLogin', function(data, int, ack){\n    console.log(\"validateLogin called\");\n    ack(\"Testing Ack\");\n  });\n});\nAnd the swift code:\nlet socket = SocketIOClient(socketURL: \"https://uno-server.herokuapp.com\", options:[\"log\": true]) // class variable\nsocket.connect() // is being called in my viewDidLoad()\n// this is called on button tapped\nsocket.emitWithAck(\"validateLogin\", \"test\")(timeoutAfter: 0) {data in\n   print(data[0])\n}\n. Okay I thought so. I originally only had (data, ack) but I looked at the example you provided earlier and it said (data, int, ack). I was thrown off by that but tried it anyways. I just tried by taking out the \"int\" argument and it still doesnt work. \n. Yeah, it connects. For some reason Heroku does port forwarding so when i hit https://uno-server.herokuapp.com it connects without needing the port but the emits dont seem to be working.\n. Thanks, I just tried by running my server locally and it worked so it must be something to do with heroku. Sorry I wasted your time with this issue.\n. I thought I should mention that I did see the other issues regarding namespaces but they were all for Objective C and Im trying to do this in swift, just in case you thought this was a duplicated issue.\n. Thank you. my apologies for missing that.\n. ",
    "LeoMobileDeveloper": "Solved by adding forceWebsockets \nself.client = [[SocketIOClient alloc] initWithSocketURL:@\"http://api.uau.com.cn:19092\"\n                                                    options:@{@\"log\": @YES,\n                                                              @\"forcePolling\":@YES,\n                                                              @\"nsp\":@\"/public\",\n                                                              @\"forceWebsockets\":@YES\n                                                              }\n          ];\n. ",
    "thangnguyendt": "I fixed the issue -> there is no document on the server that explain to add more arguments in the socket.on function \nno document on the server side describe this -> only found it it your server index.js code\n this.socket.on(\"playerMove\", function(x, y) {   // -> this means function (data1, data2, .....)\n        self.game.playerMove(self, x, y)\n    })\n. ",
    "ffager83": "Thank you nuclearace for the quick reply! \nHmm, I need to look into that again then. Last time that caused multiple events (duplicates) after reconnect, but I'll try to figure something out. Dunno why, afaik, I only had one connect() listed. \nIf you ever have the time and figure out a solution to this, that would be much appreciated, but I guess this could be listed as a \"more exotic\" case..aka. not a everyday issue, so my guess is that the priority for this will be kept pretty low. :) \nAnyway, keep up the good work! \n. Heh, well yeah..thats what I suspected as well. \nI'll take a look at that, but not sure if thats something I manage to change/fix. \nBut at least good to know where to start looking. thx\n. Well, I'll be damned.. I got it working! \nChanging connectParams to public from private fixed this issue. \nThe \"issue\", more like special feature request.. \nThis doesn't enable me to send the token as a cookie, but as a query string, which for the moment is just as good! The backend already has support for token as a cookie or as query string. \nBig thanks to you @nuclearace for this! I owe you one..  :beer: \n. ",
    "cesar-oyarzun-m": "yeah I'm sure that I'm not pointing to localhost and yes the device can reach the host. I'm using HTTPS connection, do I have to add \n<key>NSAppTransportSecurity</key>\n    <dict>\n    <key>NSAllowsArbitraryLoads</key>\n    <true/>\nit works when I run with xcode in the same device, but when I do enterprise build it won't work\n. Thanks, I have try different ways still not luck. Do you think maybe server side?. Is really weird that the HTTPS rest call works but the socket io doesn't.\n<key>NSExceptionDomains</key>\n<dict>\n<key>api.com</key>\n<dict>\n  <!--Include to allow subdomains-->\n  <key>NSIncludesSubdomains</key>\n  <true/>\n  <!--Include to allow HTTP requests-->\n  <key>NSTemporaryExceptionAllowsInsecureHTTPLoads</key>\n  <true/>\n  <!--Include to specify minimum TLS version-->\n  <key>NSTemporaryExceptionMinimumTLSVersion</key>\n  <string>TLSv1.1</string>\n</dict>\n\nand \n<key>NSAppTransportSecurity</key>\n<dict>\n<!--Include to allow all connections (DANGER)-->\n<key>NSAllowsArbitraryLoads</key>\n  <true/>\n</dict>\n. mmm the URL is right bc I'm testing with Xcode and run the app and everything works, but when I do the build for Ad-hoc distribution doesn't work. Maybe some configuration or something is doing the packaging of the app. I don't know if some one else have had this issue.\n. @nuclearace I'm checking the logs of my app that is already install in the Ipad. I'm getting\nJan 11 11:41:43 iPad-Mini networkd[90] <Error>: -[NETAWDManager reportStats:metricID:] AWDServerConnection newMetricContainerWithIdentifier failed for metric 2686983, server 0x12ce2f150, not reporting:\n<AWDLibnetcoreTCPConnectionReport: 0x12ce34f30> {\n    cellularFallbackReport =     {\n        dataUsageSnapshotsAtNetworkEvents =         (\n                        {\n                bytesIn = 5400;\n                bytesOut = 2100;\n            }\n        );\n        \"fallbackTimer_msecs\" = 0;\n        fellback = 0;\n        networkEvents =         (\n            \"NETWORK_EVENT_DATA_STALL_AT_APP_LAYER\"\n        );\n        \"timeToNetworkEvents_msecs\" =         (\n            3640\n        );\n    };\n    clientIdentifier = \"scala.Exp-Retail\";\n    connectionStatisticsReport =     {\n        DNSAnswersCached = 1;\n        \"DNSResolvedTime_msecs\" = 5;\n        RTTvariance = 42;\n        \"appDataStallTimer_msecs\" = 3;\n        appReportingDataStallCount = 1;\n        \"bestRTT_msecs\" = 113;\n        betterRouteEventCount = 0;\n        bytesDuplicate = 720;\n        bytesIn = 6400;\n        bytesOut = 2100;\n        bytesOutOfOrder = 0;\n        bytesRetransmitted = 770;\n        cellularFallback = 0;\n        cellularRRCConnected = 0;\n        connected = 1;\n        connectedInterfaceType = \"INTERFACE_TYPE_WIFI\";\n        \"connectionEstablishmentTime_msecs\" = 106;\n        connectionReuseCount = 0;\n        \"currentRTT_msecs\" = 109;\n        \"flowDuration_msecs\" = 43552;\n        interfaceType = \"INTERFACE_TYPE_WIFI\";\n        kernelReportedStalls = 0;\n        kernelReportingConnectionStalled = 0;\n        kernelReportingReadStalled = 0;\n        kernelReportingWriteStalled = 0;\n        packetsDuplicate = 0;\n        packetsIn = 12;\n        packetsOut = 12;\n        packetsOutOfOrder = 0;\n        packetsRetransmitted = 0;\n        \"smoothedRTT_msecs\" = 106;\n        synRetransmissionCount = 0;\n        tcpFastOpen = 0;\n        \"timeToConnectionEstablishment_msecs\" = 112;\n        \"timeToConnectionStart_msecs\" = 6;\n        \"timeToDNSResolved_msecs\" = 6;\n        \"timeToDNSStart_msecs\" = 1;\n        trafficClass = 0;\n    };\n    delegated = 0;\n    reportReason = \"REPORT_REASON_DATA_STALL_AT_APP_LAYER\";\n}\n[467] <Warning>: Log SocketEngine: Sending ws:  as type: 2\n[467] <Warning>: ERROR SocketIOClient: The operation couldn\u2019t be completed. Socket is not connected\n[467] <Warning>: Log SocketIOClient: Handling event: error with data: (\n    \"The operation couldn\\U2019t be completed. Socket is not connected\"\n)\n[467] <Warning>: Log SocketIOClient: Handling event: reconnect with data: (\n    \"The operation couldn\\U2019t be completed. Socket is not connected\"\n)\n[467] <Warning>: Log SocketIOClient: Starting reconnect\n. @nuclearace I fix that problem I'm connecting to different network now I don't have that message and my logs looks like that I'm connected, but I still can't receive or send messages in the socket connection\nJan 11 12:12:40 -iPad-Mini Exp_Retail[472] <Warning>: [Fabric] Unable to locate application icon\nJan 11 12:12:40 -iPad-Mini Exp_Retail[472] <Warning>: [Crashlytics] Version 3.5.0 (97)\nJan 11 12:12:40 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketIOClient: Adding handler for event: connect\nJan 11 12:12:40 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketIOClient: Adding handler for event: disconnect\nJan 11 12:12:40 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketIOClient: Adding handler for event: message\nJan 11 12:12:40 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketIOClient: Adding engine\nJan 11 12:12:40 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Starting engine\nJan 11 12:12:40 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Handshaking\nJan 11 12:12:40 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Doing polling request\nJan 11 12:12:41 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Got polling response\nJan 11 12:12:41 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Got message: 0{\"sid\":\"jixyAl2ETXQDGt2jAHdc\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\nJan 11 12:12:41 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Doing polling request\nJan 11 12:12:41 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Got polling response\nJan 11 12:12:41 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Doing polling request\nJan 11 12:12:41 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Got message: 40\nJan 11 12:12:41 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketParser: Parsing 0\nJan 11 12:12:41 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\nJan 11 12:12:41 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketIOClient: Socket connected\nJan 11 12:12:41 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketIOClient: Handling event: connect with data: (\n)\nJan 11 12:12:41 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Sending ws: probe as type: 2\nJan 11 12:12:41 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Got message: 3probe\nJan 11 12:12:41 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Upgrading transport to WebSockets\nJan 11 12:12:41 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Sending poll:  as type: 6\nJan 11 12:12:41 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: POSTing: 1:6\nJan 11 12:12:41 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Doing polling request\nJan 11 12:12:42 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Got polling response\nJan 11 12:12:42 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Sending ws:  as type: 5\nJan 11 12:12:42 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Flushing probe wait\nJan 11 12:12:42 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Got message: 6\nto log backtraces.\nJan 11 12:13:06 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Writing ws:  has data: 0\nJan 11 12:13:06 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Sending ws:  as type: 2\nJan 11 12:13:06 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Got message: 3\nJan 11 12:13:12 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketIOClient: Emitting: 2[\"message\",{\"payload\":{\"uuid\":\"60137e95-d5ab-4480-9716-e6188cde838a\"},\"channel\":\"organization\",\"name\":\"fling\",\"type\":\"broadcast\"}]\nJan 11 12:13:12 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Writing ws: 2[\"message\",{\"payload\":{\"uuid\":\"60137e95-d5ab-4480-9716-e6188cde838a\"},\"channel\":\"organization\",\"name\":\"fling\",\"type\":\"broadcast\"}] has data: 0\nJan 11 12:13:12 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Sending ws: 2[\"message\",{\"payload\":{\"uuid\":\"60137e95-d5ab-4480-9716-e6188cde838a\"},\"channel\":\"organization\",\"name\":\"fling\",\"type\":\"broadcast\"}] as type: 4\nJan 11 12:13:31 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Writing ws:  has data: 0\nJan 11 12:13:31 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Sending ws:  as type: 2\nJan 11 12:13:31 -iPad-Mini Exp_Retail[472] <Warning>: Log SocketEngine: Got message: 3\n. @nuclearace I found the problem, when I do the distribution build for some reason the token is empty, here is the code for the connection.\n```\npublic  class SocketManager {\npublic var socket = SocketIOClient(socketURL: hostUrl, options: [\"log\": true,\n    \"reconnects\": true,\n    \"reconnectAttempts\": 5,\n    \"reconnectWait\": 5,\n    \"connectParams\": [\"token\":tokenSDK]])\npublic func start_socket() -> Promise {\n  self.socket.connect()\n}\n```\nthere is some other way of passing the params? Ok I found a solution I just change how to initialize the var like this.\npublic var socket:SocketIOClient?\n public func start_socket() -> Promise<Bool> {\n  self.socket = SocketIOClient(socketURL: hostUrl, options: [\"log\": true,\n        \"reconnects\": true,\n        \"reconnectAttempts\": 5,\n        \"reconnectWait\": 5,\n        \"connectParams\": [\"token\":tokenSDK]])\n  self.socket.connect()\n}\nSomething to consider if you want to publish your app into the apple store, this should be the right way!\n. ",
    "xing-ou": "nice, it's fixed in 5.0.0\n. ",
    "leo0307vb": "I updated the call to engineDidOpen and set it not optional \n. ",
    "alexeyhippie": "swift\nforceNew = true\nhelps of course \n. Hey, @nuclearace \nthanks, I tried the same with 5.3.1 - if forceNew is false then app connects well, but after first disconnect it keeps connects and disconnects right after connection established, with [Ping timeout] error. if forceNew is true - it reconnects well.\n. Yes, this is actually was latest master, sorry for misleading. So there is no error I got on 5.0.0, but instead it keeps connects and immediately disconnects with ping timeout error. \n. In fact, git says that there is no difference in sources for \n-    pod 'Socket.IO-Client-Swift', '~> 5.3.1'\n  and \n-    pod 'Socket.IO-Client-Swift', :git => 'https://github.com/socketio/socket.io-client-swift.git'\n. Don't know why, pod didn't download any difference between  '~> 5.3.1' :git => 'https://github.com/socketio/socket.io-client-swift.git'\nNow, in 5.3.2, there is no original error, so I think this issue is solved. But there is another with failed reconnection and ping timeout, if forceNew = false. \nHere is logs: \n2016-02-05 14:50:28.089 Xeepic[63209:26247342] LOG SocketIOClient: Trying to reconnect\n2016-02-05 14:50:28.090 Xeepic[63209:26247342] LOG SocketIOClient: Handling event: reconnectAttempt with data: (\n    \"-1\"\n)\n2016-02-05 14:50:28.091 Xeepic[63209:26247342] ERROR SocketEngine: Engine tried opening while connected. Assuming this was a reconnect\n2016-02-05 14:50:28.091 Xeepic[63209:26247342] LOG SocketEngine: Engine is being closed.\n2016-02-05 14:50:28.091 Xeepic[63209:26247342] LOG SocketEngine: Sending ws:  as type: 1\n2016-02-05 14:50:28.092 Xeepic[63209:26247342] LOG SocketEngine: Starting engine\n2016-02-05 14:50:28.094 Xeepic[63209:26247342] LOG SocketEngine: Handshaking\n2016-02-05 14:50:28.406 Xeepic[63209:26257168] LOG SocketEngine: Got message: 0{\"sid\":\"qeKxVTXkLt2Piq6XAAfV\",\"upgrades\":[],\"pingInterval\":500,\"pingTimeout\":5000}\n2016-02-05 14:50:28.407 Xeepic[63209:26257168] LOG SocketEngine: Got message: 40\n2016-02-05 14:50:28.407 Xeepic[63209:26257168] LOG SocketIOClient: Should parse message: 0\n2016-02-05 14:50:28.408 Xeepic[63209:26257168] LOG SocketParser: Parsing 0\n2016-02-05 14:50:28.408 Xeepic[63209:26257168] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2016-02-05 14:50:28.409 Xeepic[63209:26257168] LOG SocketIOClient: Socket connected\n2016-02-05 14:50:28.409 Xeepic[63209:26257168] LOG SocketIOClient: Handling event: connect with data: (\n)\n2016-02-05 14:50:28.910 Xeepic[63209:26247342] LOG SocketIOClient: Starting reconnect\n2016-02-05 14:50:28.910 Xeepic[63209:26247342] LOG SocketIOClient: Handling event: reconnect with data: (\n    \"Ping timeout\"\n)\nit repeats each 5 seconds, as timeout\nProbably there is something wrong with settings on server side. What ping timeout and ping period should be used, you think? \n. Thanks, I will check it with project server guys. \nBut these logs aren't something unusual in this case?\n. Update: \nsetup default period (25000) and timeout (60000) on server side fix the second issue. \nEven more, I found out that this reconnect bug appears only when I set app flow on pause (i.e through debugger) and not appears if connection fails because of network. \n. ",
    "PeterL1n": "I think I experienced the similar problems. It crushes the program a lot.\n. ForceNew does not help\n. I downgraded to 5.3.0 and it works fine. The problem only exists in 5.3.1\nIt is not hard to recreate the issue at all. It is extremely common that my app crushes using slow 4G network.\nYou can set a button to reconnect, and press it multiple times.\nOther conditions that will cause it fails include when the there is a socket request and you turn down the server in the middle, the app will crush.\n5.3.1 is too unstable, I recommend taking it down\n. I found out that when using iPhone 5 or older device, the client sends out Base64\nBut when on iPhone 5s or newer device, the client does not convert NSData to Base64, but something else.\nIs there any reason for this?\nIf I convert the data to base64 myself\nlet base64String:String = imageData.base64EncodedStringWithOptions(.Encoding64CharacterLineLength)\nthen send out the base64String, the server can work on all device.\n. However, I did turned on ForceWebSockets, and on the server side, it looks like it was using Websockets. \n. Problem solved. It is a server side bug.\n. @satyamub \nIt is the same as sending string and receiving string.\nI send NSData on the iOS side, and receive byte[] on the server.\n. @satyamub \nThere are two ways of transferring data using socket.io\nOne is to send binary bits directly, and another is to send base64String.\nI would recommend just sending binary bits, because the size of the data is smaller than base64String.\n- For sending binary bits:\n  You don't convert UIImage to base64String. Instead, convert UIImage to NSData.\nAfterward, directly send the NSData to the server:\nlet data: NSData = (some data here)\nsocket.emit(\"image\", nickname, data)\nOn the server, you will receive the byte[], and do whatever you need with it. If you want to store it to the disk, then search google how to write byte[] to disk.\n- Base64String\n  If you insist to use base64String, then convert UIImage to base64String like what you have done.\n  Send the String to the server\nlet base64String: String = (your base64String)\nsocket.emit(\"image\", nickname, base64String)\nYou will receive a String parameter on JAVA server. You need to convert it back to byte[], then do whatever you need\nI can't give you codes, because currently I am not at my computer.\n. @satyamub Oh I am sorry. I thought you were using Java server.\nI do not have experience with receiving data in node js\n. Yes it does support ipv6\n. ",
    "prgorasiya": "Disconnecting manager first works for me.\nMy code is as follow\nsocket?.onAny { (data) in\n            if data.event == \"reconnectAttempt\" {\n                self.socketManager?.disconnect()\n                self.connectSocket()\n            }\n        }. Disconnecting manager first works for me.\nMy code is as follow\nsocket?.onAny { (data) in\n            if data.event == \"reconnectAttempt\" {\n                self.socketManager?.disconnect()\n                self.connectSocket()\n            }\n        }. Disconnecting manager first works for me.\nMy code is as follow\nsocket?.onAny { (data) in\n            if data.event == \"reconnectAttempt\" {\n                self.socketManager?.disconnect()\n                self.connectSocket()\n            }\n        }. Disconnecting manager first works for me.\nMy code is as follow\nsocket?.onAny { (data) in\n            if data.event == \"reconnectAttempt\" {\n                self.socketManager?.disconnect()\n                self.connectSocket()\n            }\n        }. ",
    "xclidongbo": "/Users/lidongbo/Desktop/Foundation/IOS/Test_SocketIO/Test_SocketIO/ViewController.m:15:9: 'Socket_IO_Client_Swift/Socket_IO_Client_Swift-Swift.h' file not found\n. 2016-08-31 15:07:31.139 iphoneLive[3763:1005694] LOG SocketIOClient: Disconnected: Got unknown error from server \n404 Not Found\n\n404 Not Found\nnginx/1.6.3\n\n\n2016-08-31 15:07:31.139 iphoneLive[3763:1005011] LOG SocketEnginePolling: Doing polling request\n2016-08-31 15:07:31.140 iphoneLive[3763:1005011] Attempted to create a task in a session that has been invalidated\n2016-08-31 15:10:55.842 iphoneLive[3763:1005694] LOG SocketEngine: Engine is being closed.\n2016-08-31 15:10:55.843 iphoneLive[3763:1005694] LOG SocketEnginePolling: Created POST string: 1:1\n2016-08-31 15:10:55.843 iphoneLive[3763:1005694] ERROR SocketEnginePolling: Tried to do polling request when not supposed to\n2016-08-31 15:10:55.843 iphoneLive[3763:1005694] LOG SocketIOClient: Handling event: disconnect with data: (\n    \"Got unknown error from server \n\\n404 Not Found\n\\n\n\\n404 Not Found\n\\nnginx/1.6.3\n\\n\n\\n\n\\n\"\n)\n2016-08-31 15:10:55.914 iphoneLive[3763:1005011] Bugly:  Trapped uncaught exception 'NSGenericException', reason: 'Task created in a session that has been invalidated' \n(\n    0   CoreFoundation                      0x0000000182f7edc8  + 148\n    1   libobjc.A.dylib                     0x00000001825e3f80 objc_exception_throw + 56\n    2   CFNetwork                           0x000000018356b110  + 144\n    3   iphoneLive                          0x0000000100371194 TFE10iphoneLivePS_20SocketEnginePollable9doRequestfTCSo12NSURLRequest12withCallbackFTGSqCSo6NSData_GSqCSo13NSURLResponse_GSqCSo7NSError__T__T + 1052\n    4   iphoneLive                          0x0000000100370d5c TFE10iphoneLivePS_20SocketEnginePollable10doLongPollfCSo12NSURLRequestT + 236\n    5   iphoneLive                          0x000000010034922c TFC10iphoneLive12SocketEngine7connectfT_T + 2308\n    6   iphoneLive                          0x0000000100349fe4 TToFC10iphoneLive12SocketEngine7connectfT_T + 40\n    7   iphoneLive                          0x000000010032186c _TFC10iphoneLive14SocketIOClient7connectfT12timeoutAfterSi18withTimeoutHandlerGSqFT_TT + 764\n    8   iphoneLive                          0x0000000100321564 TFC10iphoneLive14SocketIOClient7connectfT_T + 52\n    9   iphoneLive                          0x0000000100321ba4 TToFC10iphoneLive14SocketIOClient7connectfT_T + 40\n    10  iphoneLive                          0x0000000100311860 26-[moviePlay addNodeListen]_block_invoke_2.971 + 204\n    11  iphoneLive                          0x0000000100305028 __54-[moviePlay requestNetworkForSetNodejsInfoByComplete:]_block_invoke + 544\n    12  iphoneLive                          0x0000000100275c28 __52-[NetworkTools requestWithParameters:success:error:]_block_invoke + 104\n    13  iphoneLive                          0x000000010012fefc __71-[NetworkManager requestNetworkWithServerUrl:parameters:success:error:]_block_invoke + 324\n    14  iphoneLive                          0x000000010037caa0 __116-[AFHTTPSessionManager dataTaskWithHTTPMethod:URLString:parameters:uploadProgress:downloadProgress:success:failure:]_block_invoke.97 + 212\n    15  iphoneLive                          0x000000010039f064 __72-[AFURLSessionManagerTaskDelegate URLSession:task:didCompleteWithError:]_block_invoke_2.150 + 224\n    16  libdispatch.dylib                   0x0000000102351a7c _dispatch_call_block_and_release + 24\n    17  libdispatch.dylib                   0x0000000102351a3c _dispatch_client_callout + 16\n    18  libdispatch.dylib                   0x00000001023574e4 _dispatch_main_queue_callback_4CF + 2096\n    19  CoreFoundation                      0x0000000182f34d50  + 12\n    20  CoreFoundation                      0x0000000182f32bb8  + 1628\n    21  CoreFoundation                      0x0000000182e5cc50 CFRunLoopRunSpecific + 384\n    22  GraphicsServices                    0x0000000184744088 GSEventRunModal + 180\n    23  UIKit                               0x0000000188146088 UIApplicationMain + 204\n    24  iphoneLive                          0x00000001002f7f08 main + 124\n    25  libdyld.dylib                       0x00000001829fa8b8  + 4\n)\n2016-\n. Podfile:\n```\nsource 'https://github.com/CocoaPods/Specs.git'\nplatform :ios, \"8.0\"\nuse_frameworks!\npod 'Socket.IO-Client-Swift', '~> 8.0.0'\n```\nCocoapods Version:0.39\nWhen I open the Project use .xcworkspace,there is some alert \"Convert to Current Swift Syntax\".\nIs it support swift 3?\n. I update Cocoapods version.\nNow is 1.0.1.\niPHone 6 is OK,but iPhone 5,there is two errors:\n```\nld: warning: ignoring file /Users/lidongbo/Library/Developer/Xcode/DerivedData/Test_SocketIO-cocbjjuxtejknkalqumxkteusdjc/Build/Products/Debug-iphoneos/SocketIO.framework/SocketIO, file was built for arm64 which is not the architecture being linked (armv7): /Users/lidongbo/Library/Developer/Xcode/DerivedData/Test_SocketIO-cocbjjuxtejknkalqumxkteusdjc/Build/Products/Debug-iphoneos/SocketIO.framework/SocketIO\nld: warning: ignoring file /Users/lidongbo/Library/Developer/Xcode/DerivedData/Test_SocketIO-cocbjjuxtejknkalqumxkteusdjc/Build/Products/Debug-iphoneos/Pods.framework/Pods, file was built for archive which is not the architecture being linked (armv7): /Users/lidongbo/Library/Developer/Xcode/DerivedData/Test_SocketIO-cocbjjuxtejknkalqumxkteusdjc/Build/Products/Debug-iphoneos/Pods.framework/Pods\nUndefined symbols for architecture armv7:\n  \"OBJC_CLASS$__TtC8SocketIO14SocketIOClient\", referenced from:\n      objc-class-ref in ViewController.o\nld: symbol(s) not found for architecture armv7\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n```\n. @nuclearace \nIt's some problem about cocoapods 1.0.1.\nif I use 'use_frameworks!',  .h file cant create.\n. ",
    "tomizimobile": "Great, thanks for the quick response.\n. ",
    "thegoal": "I don't want Ack from server , I want to send client to client , and broadcast form client too. But emit isnt working , i am not able to receive an emitted event . Following are the logs. ..... \nGot event: connect, with items: Optional((\n))\n2016-01-22 10:09:56.517 TicTacIOiOS[822:12555] LOG SocketEngine: Writing ws:  has data: 0\n2016-01-22 10:09:56.518 TicTacIOiOS[822:12555] LOG SocketEngine: Sending ws:  as type: 2\n2016-01-22 10:09:56.604 TicTacIOiOS[822:12556] LOG SocketIOClient: Emitting: 2[\"chatMessage\",\"Hi how are you buddy\"]\n2016-01-22 10:09:56.605 TicTacIOiOS[822:12556] LOG SocketEngine: Writing ws: 2[\"chatMessage\",\"Hi how are you buddy\"] has data: 0\n2016-01-22 10:09:56.606 TicTacIOiOS[822:12556] LOG SocketEngine: Sending ws: 2[\"chatMessage\",\"Hi how are you buddy\"] as type: 4\n2016-01-22 10:10:00.130 TicTacIOiOS[822:12557] LOG SocketEngine: Got message: 3\n. Ok .Thanks @nuclearace . I am moving to this approach now.\n. ",
    "Abreu0101": "Thank for replay and sorry for the delay, now it's working, I only changed to (I will notify if the problem persist, but in this moment is working fine):\nfunc stopSocket(){\n         if let socket = self.socket{\n            socket.removeAllHandlers()\n        }\n        self.socket?.disconnect()\n}\n. ",
    "andyshephard": "Sure, I've removed those two parameters and it's functioning now.\nI have it working on a local instance with no problem, the remote instance required me to add the 'secure' flag, but the communication is working now.\nThank you!\n. ",
    "satyamub": "@PeterL1n I am experiencing this same issue.. I am able to implement a normal chat interface however when it comes to image sending and receiving... I am not able to understand how to do it.\nI am able to understand the concept after seeing this however I am not sure what to change at server end. Can you please help me with code snippets!!\n. Did you implement any method in server to get the images?\nHow do you retrieve the image at client side?\n. @nuclearace can't client send image and server receive then sends back!!!\n. Thats true @PeterL1n .. I just want to see the code snippet while sending and the function signature and implementation at server. I am novice in node thats why don't know what to write.\nI think at client end \nlet base64String:String = imageData.base64EncodedStringWithOptions(.Encoding64CharacterLineLength) //Conversion\nsocket.emit(\"image\", nickname, base64String)\nNot sure what to write at server side.\nPlease rectify me if I am wrong in above statement and my question!!\n. @PeterL1n just one question I wanted to ask if that the below will work If I will send NSData to Server \nServer side code\n    clientSocket.on('images', function(clientNickname, data){\n    var currentDateTime = new Date().toLocaleString();\n    var dataType = \"imageType\"\n   delete typingUsers[clientNickname];\n    io.emit(\"userTypingUpdate\", typingUsers);\n    io.emit('newChatMessage', clientNickname, data, currentDateTime,dataType);\n  });\n. @PeterL1n ... Sir can you please help in doing the server side code\n. @AndrewBoryk have you tried to lock and device and check if the user stays online?\n. @LamourBt can you please let me know if you have resolve the issue of late loading? Its urgent!!\n. ",
    "rachelxj": "Can you please give me an example of sessionDelegate? \n. Hi @CheerCc , I think you can just replace the url with the domain you used to apply to the cert, it'll be working.\n. ",
    "AlexCai21": "hi, @rachelxj ,now i have the same problem with yours. i want to encrypt my data use SSL too,my company will buy an authentication cert to encrypt.Do you solve this problem?If you have some methods to do, please tell me how to do.Thanks\n. during i communicate to server,i want to use  authentication certificates to encrypt my data(by SSLSecurity),but i only find this certificates property in WebSocket.swift,but now i just use SocketIOClient to communicate,so i do not know how to use the certificates property in the SocketIOClient class\n. sorry,can you tell me how to use in Obj-C, just know Swift a little,3Q very much.\nin Obj-C like this ? \nsocket.engine.ws.security\n. OK,Thank you anyway,i try it\n. @rajeevwhiz\nHi, I think you can't use a self-sign certificate, because Apple don't allow this operation.If you want to try by a self-sign certificate, I suggest you can add this parameter \"selfSigned\" to config. I had used authentication certificates to connect test our server, whatever I do, also failed. In fact, I just connect the server domain, and the domain name is same with our authentication certificates.And connect success.I think, you can communicate with server staff, tell him to allow Apple's requirements.. Thanks for your reply.Yes, my local sever is WebSocket.So whether the SocketIOClient can't take it compatible with WebSocket,even if i add the @\"forceWebsockets\" : @YES in the init method?\n When i use the framework of SIOSOCKET, no matter local and cloud,both of them is OK.i don't know the  difference between yours and  SIOSOCKET.\n. OK.Thanks for your suggestion.I will try it.\n. So you mean that server send ping to my client side, and when i recevice the ping this  library will reply pong to server automatically?\n. OK , Thanks, i think i have idea to solve my problem. Thanks for your reply.\n. yeah.I try to set usePublicKeys to NO.It still not connect to server.The log is CFNetwork SSLHandshake failed (-9807).So I think maybe the problem that  the version of  SSL is not same with server.In your library the SSL version is ?\n. Now my option is like this \nNSString *cerPath = [[NSBundle mainBundle] pathForResource:@\"cloud.schideron.com.cn\" ofType:@\"cer\"];\n    NSData *certData = [NSData dataWithContentsOfFile:cerPath];\n    SSLCert *cert = [[SSLCert alloc] initWithData:certData];\n    SSLSecurity *security = [[SSLSecurity alloc] initWithCerts:@[cert] usePublicKeys:NO];\n    NSDictionary *socketOptionsDict = @{@\"forceNew\" : @YES,\n                                        @\"reconnects\": @YES,\n                                        @\"forceWebsockets\" : @YES,\n                                        @\"Security\" : security,\n                                        @\"log\" : @YES\n                                        };.\nIn the WebSocket.swift, I see only the func public func stream(aStream: NSStream, handleEvent eventCode: NSStreamEvent) has call the property security.I guess whether my connection still without SSL?\n. ",
    "sveinhal": "It is a regression (something that used to work, that doesn't anymore), but I guess it is a regression by design. Which is fine, as long as the behaviour is documented.\n. ",
    "KhaledAld": "@nuclearace  Thx ^_^\n. ",
    "andrewkouri": "What was the problem?. ",
    "CFKevinRef": "Pretty much like that, yes.\n. Fixed in 2a25027, thanks!\n. ",
    "soufianeEssabbane": "ocketIOClientSwift\nSocketLogger.swift line 53\nSocketLogger.(abstractLog in _5A5B34CAD36769831C85A7C9760DE2EE)(String, message : String, type : String, args : [AnyObject]) -> ()\n9\nSocketIOClientSwift \nSocketLogger.swift line 40\nSocketLogger.log(String, type : String, args : [AnyObject]...) -> ()\n10\nSocketIOClientSwift \nSocketLogger.swift line 39\nprotocol witness for SocketLogger.log(String, type : String, args : [AnyObject]...) -> () in conformance DefaultSocketLogger\n11\nSocketIOClientSwift \nSocketParsable.swift line 157\nSocketParsable.parseSocketMessage(String) -> ()\n12\nSocketIOClientSwift \nSocketIOClient.swift line 443\nSocketIOClient.(parseEngineMessage(SocketIOClient) -> (String) -> ()).(closure #1)\n13\nSocketIOClientSwift \nSocketAckManager.swift line 0\nthunk\n. Hi, thank you for the replay.\nI'm using cocoapods and i did install the latest version \"pod 'Socket.IO-Client-Swift', '~> 5.3.2'\" but doesn't seems to be working ? my app crashes like all the time randomly. can you please explain why this is happening ? (just so that I understand).\nto get it working should I download the master repo ? \nagain thanks\n. I'm using it in an objective c project, declaring socketIO Client as a property in my delegate. I start connexion at launch like this : \n     self.socket = [[SocketIOClient alloc] initWithSocketURL:url options:@{@\"log\": @YES, @\"forcePolling\": @YES}];\n```\n    [self.socket on:@\"connect\" callback:^(NSArray data, SocketAckEmitter ack) {\n            [_socket emit:@\"id\" withItems:@[userId]];\n    }];\n[self.socket on:@\"ping\" callback:^(NSArray* data, SocketAckEmitter* ack) {\n\n\n        [_socket emit:@\"pong\" withItems:@[@{@\"sender\":userId}]];\n}];\n\n[self.socket on:@\"newMessage\" callback:^(NSArray* data, SocketAckEmitter* ack) {\n    if (data) {\n\n        NSDictionary * message = (NSDictionary*)[data objectAtIndex:0];\n            [self.socket emit:@\"delivered\" withItems:@[@{@\"_id\":sktMessage.socketMessageId}]];\n        }\n    }\n}];\n\n[self.socket connect];\n\n```\n. the update seems to be working\n. thanks (please if you see something wrong in my code tell me)\n. ",
    "zevarito": "It is an ivar, I will try it as a property, thanks!\nOn Monday, 8 February 2016, Erik Little notifications@github.com wrote:\n\nIs the socket a property of a class. Most of the time people complain\nabout events not being emitted the socket is being released because it\nisn't being stored as a property.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/305#issuecomment-181618439\n.\n\n\nSent from Gmail Mobile\n. It worked, thanks!\n. ",
    "Division": "I'm using version 5.3.1\n. Less often it is crashing with this:\n\n. Thank you a lot. I will update.\n. Was it the same issue in 5.3.1? Occures when server forces the polling mode.\nCan I expect it to be fixed in 5.3.3?\n\n\n. ",
    "gen1us2k": "golang implementation\n. But on device it not crashes, but failed to decode json\n. And it works on android/browser clients\n. @nuclearace Thanks. I'll test and give you feedback\n. @nuclearace It works. Thank you\n. ",
    "Sudheeshvs": "I am using below method for getting acknowledgement from sever.\nself.socket.emitWithAck(\"event\", event.object) (timeoutAfter: 0, callback: {data in\nvar eventJson : JSON = JSON(data)[0]\n})\nHere i use timeout value as 0.\nwhen i use this approach i am not getting No Ack, get getting response.\nBut rare chance i will not get the response. Please help me how to handle this.\nAnother simple question how to know the socketIO version number using Swift.\n. ",
    "gamugamu": "My sorries, after further research I found out I wasn't using the latest version of socketio from the server side. Upgrading it and it work nicely now. Thank you for your reactivity! \n. Please @nuclearace, this is not urgent. I have found for the moment a workaround passing my data from iOS to my python socket server, and then resending it to my js client. Using my socket python server as a bridge fixed the issue.\nSince it is involving flask socket-io, which you didn't code, iOS and js client side, and specific version of each code. Finding the bug could be really a mess there. The fact that my pi server can receive my iOS message, I'm actually into the idea that the bug could be inside flask-socketio. Anyway, the bridge workaround is maybe the right way to perform this in my specific case. Thank you anyway for your nice library.\n. I don't think the problem is related with this issue. But since a json is just a string with a specifique format,  it may be the way you encode it, or its size. Did you try a simple test, sending a nsstring like: @\"{\\'key\\':\\'value\\'}\".\nSince this is a socket communication, it won't surprise me if it is about the json size.\n. ",
    "thesugarrush": "nuclearace,\nthank you..thank you.\nI got it to work by doing this like u suggested:\nsocket.on(\"channel-found\") {serverData, ack in\n            let eventDataTemp = serverData[0] as? NSArray;\n            let eventData = eventDataTemp![0] as? Dictionary<String, String>;\n            print(\"eventName = \\(eventData![\"name\"]!)\");\n            print(\"eventNJwt = \\(eventData![\"jwt\"]!)\");\nHopefully this will help somebody else that has similar issue. I am closing this issue now.\n. Hello,\nWhat I did to work-around this issue is by explicitly specify the socket.reconnect = true, before socket.connects. \nSo, in the initial connection options, even if you set the reconnect flag to true (see no 1). \nBut after socket.disconnect, that flag value for some reason no longer honored. \nSo what i did was to set the flag to true again before socket.connect (see no 2) somewhere in the code when you start socket connection to your backend.\nNo 1:\nprivate var socket = SocketIOClient(socketURL: NSURL(string:  socketHostname,\n        options: [\n            **.Reconnects(true),**\n            .ReconnectAttempts(50),\n            .ReconnectWait(3),\n            .Log(false),\n            .ForcePolling(false),\n            .ForceWebsockets(true),\n            .ForceNew(true), // this only happens when disconected\n            .Secure(true),\n            .SelfSigned(true)\n        ]);\nNo 2:\n// this is workaround for socket-ioswift client bug: https://github.com/socketio/socket.io-client-swift/issues/442\nsocket.reconnects = true;\n// end of workaround\nsocket.connect();\nThis seems to solve my problem executing socket.disconnect() not auto-reconnecting the second time around...\nHope this helps...\n. ",
    "LamourBt": "Yes I am sure, once I run the application on both my emulator and my phone, the console.log() of the server show that I have two connections and I could send messages from both devices and i will see the messages that I have sent in the console.log of the server. the problem is that I cannot retrieve the messages back into the client  where I pushed them into an data structure to populate my UITableView\n. So when the server receive the message, I broadcast it to everyone in the chat socket.broadcast.emit({username:socket.username,message:data}); so I dont think i have to a problem in the server, it is just what method to use to query the message back in the client side \n. I could use it like that also, socket.broadcast.emit(\"chat\",{username:socket.username,message:data});\nBut how to get the message from the client side ? \n. so where you think i should call it this because I did try that code in the viewDidLoad() but it was not called \n. As you can see the message was sent and i try to add the call socket.on(\"chat\"){contents,akc in } but nothing happened\n. I sent the message \"what are you doing?\" and the version is socket.io@1.4.5\n. do you mean if i am using this server to connect with my swift application? and if that's the question yes I am.. (server--> to ios app in swift )\n. I am not really sure on that but i did install node.js on the server then socket.io. if you could show me on how to detect if JS client is allowed on the server\n. this code is outside of the  io.on(\"connection\")  or inside.... and also i dont need to call it into my application right\n. found the problem you were right it was a server problem i should not use socket.broadcast.emit(\"chat\",{username:socket.username,message:data}) instead i should have used _io.emit() _. Thank you \n. It's not a library problem but I was hoping to find a better way to do it ... \n. @satyamub yes I had to resize the image from the client side then send it \n. From your experience, which approach you think is better and efficient (let's say a lot images are being transfer and retrieved), sending NSDATA from client to server, then on the server i decode then save it into database. Or sending as Base64 \n. @nuclearace  when would the full swift 3.0 be available ? \n. @nuclearace is socket.io is fully ready for swift 3.0 ios 10.0 ?\n. ",
    "heisian": "ah yes.. the n00bz...\n. ",
    "mayuroks": "iOS beginner here. If anyone can explain the solution, it will be really helpful.. ",
    "JunfeiW": "while I check server log, I found, \" socket.io:socket closing socket - reason transport close +0ms\", no full explanation for reason\n. Well, I agreed with you, I think I should provide the log first. please wait for a moment.\nA  long time connection will have my situation, not just seconds, about half an hour.\nThe reason I created issue here not socket.io, is because, I have a socket.io js client, I didn't find its disconnection like this.\n. removed since it is really annoy\n. the same\n. part of the server log is : \nsocket.io:socket closing socket - reason transport close +0ms\n[2016-03-01 06:25:39.501] [INFO] [default] - a client leave: 8F58F12A-EF0D-40A1-A9A2-F580C113FD92\nsocket.io-parser encoding packet {\"type\":2,\"data\":[\"leave\",\"8F58F12A-EF0D-40A1-A9A2-F580C113FD92\"],\"nsp\":\"/\"} +25s\nas you can see from client log, its do authorize after connected to server, so it is weird\n. part of my code  \n```\n  self.ioClient = [[SocketIOClient alloc] initWithSocketURL:[NSURL URLWithString:@\"......\"] options:@{@\"log\": @YES, @\"forceWebsockets\": @YES}];\n    self.ioClient.reconnectWait = 1;\n    [self.ioClient on:@\"connect\" callback:^(NSArray data, SocketAckEmitter ack) {\n        NSLog(@\"socket connected\");\n        [self auth];\n}];\n\n```\n. Yeah, I don't well in this. The log is too long, while no obvious error info are provided.\nAny idea to perform a performance test on this lib?\n. I mean, we should test the stability and performance. Otherwise it hard to tell if the lib can be used at production env.\nI have used this for a while, and most of time, it words perfectly, but after a while the connection become not stable, and isn't recovered automatically.\nSo from my point of view, most of the function is working perfectly, but we needs to do a performance test to make this more robust. What's your opinion?\n. I suggest we can test the throughput and connection stability.\n. Nope, I just put it there and do nothing.\nWell, I mean some traffic to simulate the real env\n. Awesome! Great thanks!\nHave you tried bad network condition, since the system is required to auto recover.\n. Version 7.3 (7D175)\n. I came across the same problem with the latest version of socket.io node (1.4.2), and socket.io-swift(6.1.2)\n. @nuclearace, I have tried the latest development version. I can't reproduced the error anymore.\nSo I think it should be fixed.\n. I will try to check it in the future usage, if any problem, I will notify it here.\n. It seems that when app goes into background, it is crashed because of socket.io\n. I don't know what kind of tools you are using? I use carthage, which works fine\n. But when build there are a lot of warning about buffer\n. @rheza,  I just use  ios platform, so about tvOS, I'm not sure about it.\n. using the lastest 8.0.0 version\nI tried at ios 9.2, crashed either\n. In fact, crash happened occasionally  when socket is closed by remote.\nSo it is really a big problem, please fix it @nuclearace \n. Any advice for this?\nIt is impact a lot of ios 10 users.\n. I  tried ios 8.0.1, the problem seems disappeared, still under test, keep updating...\n. Still some crash\n0x2375e24 <+588>:  bl     0x2379934                 ; function signature specialization <Arg[0] = Exploded> of SocketIOClientSwift.WebSocket.(processOneRawMessage in _ED38407276FC67CE6D5C84F7A1133F2A) (inBuffer : Swift.UnsafeBufferPointer<Swift.UInt8>) -> Swift.UnsafeBufferPointer<Swift.UInt8> at WebSocket.swift\n0x2375e28 <+592>:  mov    r4, r0\n0x2375e2c <+596>:  sub    r5, r1, r4\n. 0x2342a68 <+1240>: mov    r6, r0\n0x2342a6c <+1244>: mov    r5, #0\n0x2342a70 <+1248>: movw   r1, #0xd054\n0x2342a74 <+1252>: mov    r2, r8\n0x2342a78 <+1256>: movt   r1, #0x4\n0x2342a7c <+1260>: ldr    r0, [sp, #0x14]\n0x2342a80 <+1264>: ldr    r1, [pc, r1]\n0x2342a84 <+1268>: mov    r3, r4\n0x2342a88 <+1272>: str    r6, [sp]\n0x2342a8c <+1276>: bl     0x2389ee4                 ; symbol stub for: objc_msgSend\n0x2342a90 <+1280>: mov    r0, r4\n0x2342a94 <+1284>: bl     0x2389fd4                 ; symbol stub for: swift_unknownRelease\n0x2342a98 <+1288>: mov    r0, r6\n0x2342a9c <+1292>: bl     0x2389eec                 ; symbol stub for: objc_release\n0x2342aa0 <+1296>: mov    r0, r8\n0x2342aa4 <+1300>: bl     0x2389eec                 ; symbol stub for: objc_release\n0x2342aa8 <+1304>: cmp    r5, #0\n0x2342aac <+1308>: bne    0x2342ad0                 ; <+1344> at WebSocket.swift:828\n0x2342ab0 <+1312>: tst    r10, #2\n0x2342ab4 <+1316>: bne    0x2342ac4                 ; <+1332> at WebSocket.swift:828\n0x2342ab8 <+1320>: mov    r0, r10\n0x2342abc <+1324>: bl     0x2389fa8                 ; symbol stub for: swift_release\n0x2342ac0 <+1328>: b      0x2342ad0                 ; <+1344> at WebSocket.swift:828\n0x2342ac4 <+1332>: bfc    r10, #1, #1\n0x2342ac8 <+1336>: mov    r0, r10\n0x2342acc <+1340>: bl     0x2389fd4                 ; symbol stub for: swift_unknownRelease\n0x2342ad0 <+1344>: ldr    r0, [sp, #0x24]\n0x2342ad4 <+1348>: bl     0x2389eec                 ; symbol stub for: objc_release\n0x2342ad8 <+1352>: ldr    r8, [sp, #0x20]\n0x2342adc <+1356>: ldr    r4, [sp, #0x1c]\n0x2342ae0 <+1360>: mov    r0, r4\n0x2342ae4 <+1364>: bl     0x2389fa8                 ; symbol stub for: swift_release\n0x2342ae8 <+1368>: mov    r0, r8\n0x2342aec <+1372>: bl     0x2389eec                 ; symbol stub for: objc_release\n0x2342af0 <+1376>: add    r4, sp, #96\n0x2342af4 <+1380>: vld1.64 {d8, d9}, [r4:128]\n0x2342af8 <+1384>: sub    sp, r7, #24\n0x2342afc <+1388>: pop    {r8, r10, r11}\n0x2342b00 <+1392>: pop    {r4, r5, r6, r7, pc}\n. How to check whether the websocket version upgraded or not?\nI use carthage, suppose it does everything for me\n. Turns out it is carthage problem. \nFor others info,  check xcode User legacy swift Language version to No\nand remove carthage directory.\nTry again\n. As documented :\nRequires Swift 3/Xcode 8.x\nIf you need swift 2.3 use the swift2.3 branch (Pre-Swift 3 support is no longer maintained)\nIf you need swift 2.2 use 7.x (Pre-Swift 3 support is no longer maintained)\nIf you need Swift 2.1 use v5.5.0 (Pre-Swift 2.2 support is no longer maintained)\nIf you need Swift 1.2 use v2.4.5 (Pre-Swift 2 support is no longer maintained)\nIf you need Swift 1.1 use v1.5.2. (Pre-Swift 1.2 support is no longer maintained)\n. ",
    "iCyberon": "@nuclearace Thanks for suggestion. Reported https://github.com/daltoniam/Starscream/issues/179\n. @nuclearace Have no idea, just got a crash report from one of the users.\n. ",
    "brendomaciel": "Yes I do. Also I tested with the ports 8080 and 8900 (as the example).\n. A detail: I am using the simulator. But in my application, I realize requests to load other data via GET and they work. But when I try to make a connection using the Socket.IO it does not work.\n. My server is using HTTP only. But the flag \"App Transport Security Settings -> Allow Arbitrary Load\" with value \"YES\" does not disable these iOS security restrictions? If they are unset, the request is not allowed.\n. What are the possible configuration errors?\n. Ok, thanks for the support.\n[UPDATE]\nHey, @nuclearace. Sorry, really it was the problem with the port. Thank you for your time and availability.\n. ",
    "shirishbankar1": "What was the solution you found.. ",
    "imthiyasmohamed": "Awesome. ",
    "AndrewBoryk": "@satyamub I have the connection set to disconnect if user locks screen or goes to home screen. \n. Is there a way to stop socket from connecting, disconnect it, and try to connect again?\n. How do you recommend best practice for recreating the socket?\nI'm trying to do:\n[self.socket disconnect];\nself.socket = nil;\n[self socketOn];\n(socketOn basically sets up the socket, so in essence:\nNSDictionary *connectOptions = [[NSDictionary alloc] initWithObjectsAndKeys:@YES, @\"forceWebsockets\", @5, @\"secure\", @YES, @\"log\", connectParams, @\"connectParams\", nil];\nself.socket = [[SocketIOClient alloc] initWithSocketURL:url options:connectOptions];\nand then [socket connect]\n. You can close this issue, I updated to your latest commit and everything is fixed. I was around 2 months behind\n. ",
    "hero2201": "i fixed the leaking by changed \"forcePolling\": @YES to \"forceNew\": @YES\n. ",
    "jb522185660": "how do to solve it\uff0cI have the same problem\n. I found I can use it now.Drag all socket io file into the project,then convert to swift 3.0.Maybe any syntax need to be change manually.No problem temporary.\n. ",
    "dani5447": "Ok, thank you\n. @j364960953 I had to \n- extend NSURLSessionDelegate on the class\n- use this instantiation: (the selfsigned and sessiondelegate options)\nlet socketClient = SocketIOClient(socketURL: NSURL(string: baseURL)!, options: [SocketIOClientOption.Log(true), SocketIOClientOption.ForcePolling(true), SocketIOClientOption.SelfSigned(true), SocketIOClientOption.SessionDelegate(self), SocketIOClientOption.ConnectParams([\"__sails_io_sdk_version\":\"0.11.0\"]),\n            SocketIOClientOption.Cookies([currCookie])])\n- Add a session delegate method at the bottom of the class:\nfunc URLSession(session: NSURLSession,\n        task: NSURLSessionTask,\n        didReceiveChallenge challenge: NSURLAuthenticationChallenge,\n        completionHandler: (NSURLSessionAuthChallengeDisposition, NSURLCredential?)\n        -> Void) {\n            completionHandler(NSURLSessionAuthChallengeDisposition.UseCredential, NSURLCredential(forTrust: challenge.protectionSpace.serverTrust!))\n    }\n. Alright it may be something with how sails js is doing sockets then that is incompatible. Thanks!\n. ",
    "yaleidev": "@dani5447  hello ,How you solve?\n. thanks!\n. ",
    "Heiyuan": "thanks!\n. ",
    "mohangslab083": "@dani5447  Thanks, this helped me .. \ud83d\udc4d  :). @TaoistKing  Getting the same Error.\n. ",
    "githubforIT": "I am using this swift library in obj-c project. With respect to this issue, I have written this code as follows but my delegate never gets called. Any idea what could be missing?\nsocket = [[SocketIOClient alloc] initWithSocketURL:url config:@{@\"log\": @YES, @\"forcePolling\": @YES, @\"selfSigned\": @YES, @\"sessionDelegate\":self }];\nAdd here is my delegate.\n\n(void)URLSession:(NSURLSession )session task:(NSURLSessionTask )task didReceiveChallenge:(NSURLAuthenticationChallenge )challenge completionHandler:(void (^)(NSURLSessionAuthChallengeDisposition disposition, NSURLCredential credential))completionHandler{ completionHandler(NSURLSessionAuthChallengeUseCredential, [NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust]); }. I got it working.. Actually, when I implemented the didReceiveChallenge delegate method in the AppDelegate and set the sessionDelegate to its instance, it started working.\n\nAppDelegate appDelegate = (AppDelegate )[[UIApplication sharedApplication]delegate];\nsocket = [[SocketIOClient alloc] initWithSocketURL:url config:@{@\"log\": @YES, @\"forcePolling\": @YES, @\"selfSigned\": @YES, @\"sessionDelegate\":appDelegate }];\n. I am using this library in obj-c project, everything was working great before I turned my server to https. At the moment I turned to https I was encountering invalid certificate issue which I had addressed by implementing didReceiveChallenge delegate method. Now, I am getting this error ;\nCannot GET /socket.io/?transport=polling&b64=1\nsocket = [[SocketIOClient alloc] initWithSocketURL:[[NSURL alloc] initWithString:@\"https://localhost:xxxx\"] config:@{@\"log\": @YES, @\"forcePolling\": @YES, @\"selfSigned\": @YES, @\"sessionDelegate\":appDelegate}];\nI have also given a try by placing following key and value in config.\n@\"path\":@\"/node_modules/socket.io\"\nAny prompt help will be really appreciated.. Thanks, I have resolved myself.. It required a server side fix.. ",
    "hoangbossemo": "@githubforIT how to fix it?. ",
    "hemanthalluri": "I want to try local notifications using SOCKETIO., when the app is running on simulator everything is fine. But when It's running on iPhone, when the app enters into background task suspends/ get paused. Please help me regarding this issue. Please clean the project and build again. Everything worked for me. I run on Xcode 8.1 with Swift 3. . Could you please tell me how to include socket.io swift client lib in own project..? . ",
    "miketw2014": "@githubforIT  I tried to use the same method as you, however, I often get an AppDelegate retain message sent to deallocated instance error. \nMay I ask, Did you encounter an error on the same path as mine? . ",
    "zabaat": "just in case someone hits this in the future\nhttp://stackoverflow.com/questions/32590533/connect-sails-io-with-an-ios-swift-app/42050944#42050944. ",
    "eh1255": "I should have noticed that there was an update to Xcode. Thanks for the pointer!\n. ",
    "sagardesai16": "Socket connection is closed whenever we try to switch the network, say switching from wifi to 3G.\nIt tries to reconnect, but unable to reconnect. can you please help?\n. ",
    "BTopbas": "Tiny example for unwrapping? I add ! to end of cookies. No error but also cant auth. I print cookies debug console so i am sure i have cookies. but failing to add socket.\n. Okey. My fault. I forget to implement redis. Everything is working. Thanks for help.\n. ",
    "kshrikant": "Sorry @nuclearace  i didnt get you can please explain me through code ?\n. Thank you it worked for me.... @nuclearace @aniketc-gslab firstly i was doing the same but it was not coming inside socket.on (\"connect\"). Now it working fine.\n. @nuclearace any idea ? Please can u tell me how to resolve this ?\n. @nuclearace  Yes, After receiving message at server side it is broadcasting as well.Is that issue from server ? We did that because we need authentication from server once i sent message from my device. If that is wrong implementation how we can get authentication after sending message from device ? BTW same implementation working fine in android.\n. ",
    "utkarshs07": "Hey thanks for quick reply :) found the bug. \nActually the problem was - I was connecting with the server using same namespace again & again but wasn't disconnecting properly before creating a new connection so event handlers were still there. Now i am generating random string for each connection, it's working fine now. \n. I'm facing one more problem, I'd be glad if you advise me..\nAs i mentioned above that I'm working on webRTC and signaling using socket.io.\nCase is there're multiple participants in a room and i need to communicate with them privately so i'm creating n-1 private connections using namespace feature.\nAs you can see in above code.. when i get WRTCSignalingTypeNewParticipant event, It means new participant joined the room, so in this event i'm getting that user's id and using that id i'm creating a private socket of that user and storing into NSMutableDictionary for further use.\nAfter successful call/answer signaling a delegate method gets fired and at this stage i need to share some network information with user using that user's private socket which i've previously created, connected and stored in Dictionary.\nso when i fetch that socket connection from Dictionary and emit network info into that connection sometimes not received by other client or sometimes works.\ni'm also checking status of connections it's showing disconnected ..\ni am little confused here. what should i do in this case?\ni think it's some kinda reconnect issue ...\nor is it because of i'm doing something wrong in my code ? is process of storing in Dictionary and fetching causing this problem?\n. ",
    "AhtashamImtiyaz": "Hey @utkarshs07, How did you solve this problem? Did you generated the random string in the server side or client side? \n. ",
    "muh-azharudheen": "@utkarshs07 , how did you solve this problem. any workaround with this.\n. ",
    "Ezechiele": "No i'm on 7.2.1, my fault sorry i thought i had updated xCode\n. ",
    "objectiveSee": "@nuclearace I'd be happy to port changes into starscream, though it would be better to just include that as a sub-pod. What's the current reason for not using starscream as a dependency on this pod?\n. ",
    "yosiat": "@nuclearace Hi, do you still open for pull requests to add per message deflate support?. ",
    "myusuf08": "first, i already connect socket with this code\nNSURL* url = [[NSURL alloc] initWithString:@\"mylink\"];\n    SocketIOClient* socket = [[SocketIOClient alloc] initWithSocketURL:url options:@{@\"log\": @YES, @\"forcePolling\": @YES}];\n[socket connect];\nsecond: i send emit with json object and set json object as dictionary\nNSMutableDictionary *params ..\n[socket emit:@\"checkMe\" withItems:[NSArray arrayWithObject:params]];\nand only this i got in my log\nLOG SocketEnginePolling: POSTing\nLOG SocketEnginePolling: Doing polling request\nLOG SocketEngine: Writing poll:  has data: 0\n LOG SocketEnginePolling: Sending poll:  as type: 2\nCreated POST string: 1:2\nthere is no log from server, but i already send emit\nplease help :(\nsee my code in my third comment\n.  NSString socketID = [[NSUserDefaults standardUserDefaults]objectForKey:@\"socketID\"];\n    [socket on:@\"connect\" callback:^(NSArray data, SocketAckEmitter* ack) {\n        NSMutableDictionary *params = [[NSMutableDictionary alloc]initWithDictionary:@{@\"sid\":socketID}];\n        //\n        NSDictionary * auth = @{@\"isAuthenticated\":checkisAuthenticated,@\"credentials\":@{@\"uid\":checkcredentialsuid,@\"id\":checkcredentialsid,@\"exp\":checkcredentialsexp,@\"valid\":checkcredentialsvalid,@\"iat\":checkcredentialsiat}};\n        //\n        NSDictionary * info = @{@\"lastseen\":wholastseen,@\"username\":whousername,@\"status\":whostatus,@\"email\":whoemail,@\"createdAt\":whocreatedAt,@\"cellphone\":whocellphone,@\"active\":whoactive,@\"profile\":@{@\"middleName\":whoprofilemiddleName,@\"lastName\":whoprofilelastName,@\"birthday\":whoprofilebirthday,@\"sex\":whoprofilesex,@\"cover\":whoprofilecover,@\"status\":@{@\"message\":whoprofilestatusmessage,@\"postedAt\":whoprofilestatuspostedAt},@\"pictureResId\":whoprofilepictureResId,@\"rel\":whoprofilerel,@\"firstName\":whoprofilefirstName,@\"avatar\":@{@\"stockId\":whoprofileavatarstockId,@\"avatarId\":whoprofileavataravatarId}}};\n        //\n        [params setObject:auth forKey:@\"auth\"];\n        [params setObject:info forKey:@\"info\"];\n        [socket emit:@\"checkMe\" withItems:[NSArray arrayWithObject:params]];\n        NSLog(@\"socket connected \");\n}];\n. im using local variable in my func, and i call my func in viewdidload, so i\nmust set global varial that socket? Like this?\n@property(strong.nonatomic)socket *socket ??\nOn Sunday, 17 April 2016, Erik Little notifications@github.com wrote:\n\nAre you sure the socket is a property and not a local variable?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly or view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/346#issuecomment-210934580\n. still not get anything from server after send emit , i already set property..\n\nmy friend succes implement this in android, and him tes send with my data json object and work(get notif from server after send emit)\nmaybe i fail send emit?\nbtw,in my log emit send 4 time , is this right?\nfirst, LOG SocketIOClient: Emitting: 2\nsec,LOG SocketEngine: Writing poll: 2\nthr,LOG SocketEnginePolling: Sending poll: 2\nfour,LOG SocketEnginePolling: Created POST string: 809:42\nhelp please\n. yes im sure, my json data is correct , because i already test in android using socketio too,\nmaybe u hv more example code to send emit in obj-c ?\nhow can i know , emit has already send?and how to know log from server when emit sucess send?\n. i using this,\n[self.socket emitWithAck:@\"checkMe\" withItems:[NSArray arrayWithObject:params]];\n        [ack with:[NSArray arrayWithObject:params]];\nbut emit not sending,\ni just need to listen in this :\n[self.socket on: @\"checkMe|response\"  callback:^(NSArray * item, SocketAckEmitter * emitt) {\n        NSLog(@\"checkme successfull %@\",item);\n    }];\nbut no respon :(\n. how you solve this ?. same. ",
    "oikios": "i also meet this question. my android colleague did success. but i did always wrong. it's the same to you.  how did you solve this eventually\uff1f help.\n. ",
    "rajeevwhiz": "@CheerCc Can you share how you resolve this? Why did you do to pin the certificate? I am trying to pin a self-sign certificate and running into similar issue. \n. I am trying to PIN a self-signed cert and configuring the socket with URLSessionDelegate\n\nsocket  = SocketIOClient(\n        socketURL: URL(string: \"https://serverurl:8081\")!,\n        config: [.connectParams([\"token\": token]),\n                 .log(true),\n                 .forceNew(true),\n                 .selfSigned(true),\n                 .sessionDelegate(appDelegate)\n        ])`\n\nbut AppDelegate.urlSession(_ session: URLSession, didReceive challenge: URLAuthenticationChallenge, completionHandler) method never gets called! What am I missing?\nLooks like selfSigned(true) making the app to just ignore the certificate. \nI also tried \n\nsocket = SocketIOClient(\n        socketURL: URL(string: \"https://serverurl:8081\")!,\n        config: [.connectParams([\"token\": token]),\n                 .log(true),\n                 .sessionDelegate(appDelegate),\n                 .forceWebsockets(true), \n                 .security(SSLSecurity(usePublicKeys: false)),\n                .forceNew(true)\n        ])\n\nwith this I am getting SocketIOClient: Handling event: error with data: [\"Invalid SSL certificate\"]. Okay got it working... \nlet  file_der = Bundle.main.path(forResource: \"certificate\", ofType: \"der\")\nvar certs = [SSLCert]()\nif let certificateData = try? Data(contentsOf: URL(fileURLWithPath: file_der!)) as Data {\n     let certificate = SSLCert(data: certificateData)\n      certs.append(certificate)\n}\nsocket = SocketIOClient(\n        socketURL: URL(string: \"https://serverurl:8081\")!,\n        config: [.connectParams([\"token\": token]),\n                 .log(true),\n                 .selfSigned(true),\n                 .forceWebsockets(true), \n                 .security(SSLSecurity(certs: certs, usePublicKeys: true)),\n                .forceNew(true)\n])\n. Closing... found the issue. . Using latest from master - it was also there on Swift4 branch earlier. ",
    "petrorington": "@nuclearace Do you know how to check if socket connection is valid or not?\n. @nuclearace Yes, I'm familiar with those handlers.\nBut the problem is that they are not called when the app is in background.\nSo I couldn't catch when the connection is dropped.\nWhen the app goes foreground again, I see the socket connection status is still valid.\nI'm checking status property (SocketIOClientStatus) and it's Connected though.\n. ",
    "mbalex99": "I'm wondering why disconnect never gets fired. When I go to airplane mode reconnect and reconnectAttempt gets fired but disconnect doesn't get fired.\n. @hahaGitHub I don't do anything, it's automatically attempting to connect.\n. @nuclearace Thanks for the quick reply but how do you listen for reserved events from the server. \nHeartbeats should be from the server -> client and then the client responds back?\nAre you saying I have to do this on the server side?\njavascript\nsetInterval(() => {\n    socket.forEach(s => {\n          s.emit('heartbeat', {})\n    });\n}, 2000)\n. Was the websocket version upgraded when swift was upgraded? I cannot confirm this crash on my app. \nMaybe some threading issue? \n. You can take a look at the podspec file and look at the dependencies\nOn Wed, Sep 21, 2016 at 8:26 AM JunfeiW notifications@github.com wrote:\n\nHow to check whether the websocket version upgraded or not?\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/502#issuecomment-248647262,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ACFSMaTlCWIZR042Qgz-F6OIM9oPQzQOks5qsUyOgaJpZM4KAL6q\n.\n\nMaximilian Alexander\nmbalex99@gmail.com\nwww.maxofeden.com\n. \n",
    "hahaGitHub": "@mbalex99 \n1.After the app goes background and goes foreground again\uff0cwhat do you do ,so it can automatically tries to reconnect.\n2. I can not see the logs, \"reconnect\", \"reconnectAttempt\" and \"connect\".when i close the wifi ,i just see the log,\"error\".\n. thanks.\ni use the latest version.when i change the wifi,it's automatically attempting to connect.\nwhen goes background and goes foreground again,it can not automatically to connect.\n. sorry,this is not a server.i don't develop the server. i use the client to connent ourself server with host url.\nwhen i use the interface connect ,i see the log with the ERROR SocketEnginePolling.\n. thank you for your answer.i am waiting for the other answer.\nalso i find the versions, 6.1.3 and 6.1.2,are different.\n. yes.it works in 6.1.2.\n. ok.thanks.\n. thanks.the 6.1.4 works well.\n. @nuclearace?\n. i used xcode7 and socket-io-client. now i use Xcode 8 beta 6,and i downloaded swift3 branch ,to replace previous version io files,and then build error.\nwhat else i need to set?\n. ",
    "rodericj": "I've had a similar issue to what @petrorington described above. My current assumption is that the connected state is stored in a file or something and the file only gets removed on explicit disconnect. \nOur workaround would be to explicitly disconnect the socket so that we as a client have a bit more of a deterministic experience with the library, though the viability of this for our specific needs is unknown.. We experienced this when attempting to emit while the socket was not connected. This happened on startup of our app when a user attempted to open a push notification which sent an emit. We were checking the connection status but it was falsely returning .conntected when it actually was not. Not sure if it is relevant to your situation, but are you attempting to send an emit before the connection actually happens?. ",
    "HenryHengZJ": "any updates on this? Is explicit disconnection the only way?. ",
    "MishraVikas1": "Its happening in 6.1.0 as well. In SocketEngine.swift, there is a method named disconnect() which is calling do request method.\nCrash only occurs when network keeps fluctuating.\n. I fixed this by making below changes in library files (SocketIOClient.swift)\nfunc didDisconnect(reason: String) {\n        guard status != .Disconnected else { return }\n```\n    DefaultSocketLogger.Logger.log(\"Disconnected: %@\", type: logType, args: reason)\nstatus = .Disconnected\nreconnects = true\n\n// Make sure the engine is actually dead.\nengine?.disconnect(reason)\nhandleEvent(\"disconnect\", data: [reason], isInternalMessage: true)\n\n}\n```\nChanged reconnects to true from false. \nWill this change have any side effects? If no, plz update in git repo so we can use this through cocoapods again.\n. ",
    "aligermiyanoglu": "Hi, \nI am experiencing similar issue, you can check on:\nhttp://crashes.to/s/b20e5c6a150 \nBest\n. @paulcarpenter you could be right about spotty network connections guess. Our users also have lagy network conditions\n. You can solve the issue by changing \"Swift Language Version\" to 4.0 under Build Settings of pod project of 'Socket.IO-Client-Swift' framework. ",
    "px751": "Same problem here ! Here is the log if needed. Please ask if you need more infos\nSocketIOSwift Version : 6.1.0\n\n. I dont really know, it seems to be when the app disconnects...\nHere are the details : http://crashes.to/s/77c635c5d77\nI dont really know how to reproduce this problem but we have more that 100 users who are impacted, almost all on iOS 9.\nI call the SocketIO diconnect function when the user leaves the app, maybe this comes from there, the app is kind of already in background and the background task crashes (?)\n. @nuclearace Please tell me when I can make this issues private, I dont like having these info on a free access on a application in production :)\n. I the [socketClient diconnect] this in the \"- (void)applicationDidEnterBackground:(UIApplication *)application\" function, this class is a singelton\nJust before I stop the localisation service, and save the user class, but I dont think this is linked\nOh, and I dont know if this information is important, but my app is in Obj-c, not swift\nFYI, the server is using SocketIO version ~1.3.2\n. \nI've tries to debug but It seems that the function is not called when the socket io disconnects, but only at connexion or re-connexion, I am going to try to crash the server and see if this comes from this part\n. Let me know if you have a clue so I can test\n. ",
    "paulcarpenter": "Also seeing this intermediately for the first time after using the library for a few weeks. It does seem to show up with a user who has notoriously spotty network connections on his phone. I'll give the latest development branch a try, and follow up if I see it again.\n. Also still happening in 6.1.4 for me. As our user base is growing, we're starting to see lots of these show up (and we still don't have that many users). Going to try @nuclearace's drop-in fix in our beta builds, but a real investigation of this would be great.\nEDIT 2 minutes later: postSendClose is not a method in 6.1.4.\n. I tried setting the session variable to nil explicitly in public func stopPolling() but I'm still seeing the error and getting the crash reports. I can't find any other method in the library that is invalidating the session; and I can't find any information that says how and when the system might invalidate the session silently.\nAny more help we can get with this?\n. Unfortunately, this just came back from one of our testers. Seems to be much less common now, but not entirely gone. In the swift3 branch, it throws on line 105 of SocketEnginePollable, on the same old session?.dataTaskWithRequest(req, completionHandler: callback).resume() and Task created in a session that has been invalidated\n. ",
    "Arnadus": "I don't know if it can help but I've been able to reproduce it quite often (100% time after 15-20 seconds running) by connecting and disconnecting the socket in a tiny amount of time.\nCheck the example below, just call the \"doCrash\" method.\n```\nclass CrashTest {\nvar socket:SocketIOClient!\nvar url : String = \"http://www.example.com\" //TO BE CHANGED\n\ninit() {\n    socket = SocketIOClient(socketURL: NSURL(string: url)!, options: [.Log(true)])\n    socket.reconnects = false\n}\n\n// to be called when socket is ready\nfunc start(){\n    NSTimer.scheduledTimerWithTimeInterval(0.01, target: self, selector: #selector(check), userInfo: nil, repeats: true)\n}\n\n@objc func check() {\n    dispatch_async(dispatch_get_main_queue(), {\n        if self.socket.status != .NotConnected{\n            self.socket.disconnect()\n        }\n        self.socket.connect()\n\n\n    })\n}\n\nstatic func doCrash(){\n    let crashTest = CrashTest()\n    crashTest.start()\n}\n\n}\n```\n. ",
    "rehsals": "I can confirm that this crash still persists on 6.1.6. But it happens really rare when the app goes into background.\n. I think thread sanitizer works only with simulator but it can be on during a running app. That was the way I found out about mentioned data races.\n. ",
    "therudite": "Yes, I get it 1 out of 5 times. \n\n. Yes, it is sending and websocket is connected as well but this is not getting reflected in socket status.\n. ",
    "Lwdthe1": "Swift 2.3 is happening the same issue apparently. disconnect is called from AppDelegate's applicationDidEnterBackground method. Here's the log and error stack:\n\nExcuse the do{} catch{} blocks. I was trying to debug.\n. ",
    "daicaga": "I'm using\npod 'Socket.IO-Client-Swift', '~> 7.0.3'\nand it happened as well.\n. Hi @nuclearace \nI got this issue:\n2016-10-31 15:17:01.274 AAA[10125:3815887] LOG SocketEnginePolling: POSTing\\\n2016-10-31 15:17:01.275 AAA[10125:3815887] LOG SocketEnginePolling: Doing polling request\\\n2016-10-31 15:17:04.076 AAA[10125:3815233] LOG SocketEnginePolling: Got polling response\\\n2016-10-31 15:17:04.077 AAA[10125:3815233] LOG SocketEnginePolling: Doing polling request\\\n2016-10-31 15:17:04.080 AAA[10125:3816150] LOG SocketEngine: Got message: 0\\{\"sid\":\"PuDEqYrvZKcRiqevAjaC\",\"upgrades\":[],\"pingInterval\":10000,\"pingTimeout\":5000\\}\\\n2016-10-31 15:17:04.080 AAA[10125:3815233] ERROR SocketEngine: Engine URLSession became invalid\\\n2016-10-31 15:17:04.080 AAA[10125:3815233] ERROR SocketEngine: Engine URLSession became invalid\\\n2016-10-31 15:17:04.080 AAA[10125:3816150] LOG SocketIOClient: Starting reconnect\\\n2016-10-31 15:17:04.080 AAA[10125:3815233] ERROR SocketIOClient: Engine URLSession became invalid\\\n2016-10-31 15:17:04.081 AAA[10125:3815233] LOG SocketIOClient: Handling event: error with data: (\\\n    \"Engine URLSession became invalid\"\\\n)\\\n2016-10-31 15:17:04.081 AAA[10125:3816150] LOG SocketIOClient: Handling event: reconnect with data: (\\\n    \"Ping timeout\"\\\n)\\\n2016-10-31 15:17:04.082 AAA[10125:3815233] LOG SocketEngine: Engine is being closed.\\\n2016-10-31 15:17:04.090 AAA[10125:3816150] LOG SocketIOClient: Trying to reconnect\\\n2016-10-31 15:17:04.101 AAA[10125:3815233] LOG SocketEnginePolling: Created POST string: 1:1\\\n2016-10-31 15:17:04.102 AAA[10125:3815233] LOG SocketEnginePolling: Doing polling request\\\n2016-10-31 15:17:04.103 AAA[10125:3816150] LOG SocketIOClient: Handling event: reconnectAttempt with data: (\\\n    \"-1\"\\\n)\\\n2016-10-31 15:17:04.103 AAA[10125:3815233] ERROR SocketEnginePolling: The request timed out.\\\n2016-10-31 15:17:04.104 AAA[10125:3815233] ERROR SocketEngine: The request timed out.\\\n2016-10-31 15:17:04.104 AAA[10125:3816150] LOG SocketEngine: Starting engine. Server: http://192.688.10.15:8888\\\n2016-10-31 15:17:04.105 AAA[10125:3816150] LOG SocketEngine: Handshaking\\\n2016-10-31 15:17:04.105 AAA[10125:3815233] ERROR SocketIOClient: The request timed out.\\\n2016-10-31 15:17:04.105 AAA[10125:3816150] LOG SocketEnginePolling: Doing polling request\\\n2016-10-31 15:17:04.114 AAA[10125:3815233] LOG SocketIOClient: Handling event: error with data: (\\\n    \"The request timed out.\"\\\n)\\\n2016-10-31 15:17:04.122 AAA[10125:3815233] ERROR SocketEngine: Engine URLSession became invalid\\\n2016-10-31 15:17:04.122 AAA[10125:3816150] Attempted to create a task in a session that has been invalidated\\\n2016-10-31 15:17:04.122 AAA[10125:3815233] ERROR SocketEngine: Engine URLSession became invalid\\\n2016-10-31 15:17:04.124 AAA[10125:3815233] ERROR SocketIOClient: Engine URLSession became invalid\\\n2016-10-31 15:17:04.124 AAA[10125:3815233] LOG SocketIOClient: Handling event: error with data: (\\\n    \"Engine URLSession became invalid\"\\\n)\\\n2016-10-31 15:17:04.125 AAA[10125:3816150] *** Terminating app due to uncaught exception 'NSGenericException', reason: 'Task created in a session that has been invalidated'\\\n*** First throw call stack:\\\n(0x181a96db0 0x1810fbf80 0x182083110 0x101b92458 0x101b920a0 0x101b87be8 0x101b88ce0 0x101b9e27c 0x101b9df70 0x101ba2bc4 0x101ba0404 0x101ba021c 0x101ba046c 0x101b8a540 0x101b8a21c 0x101b8b904 0x101b8bb1c 0x101b951f0 0x101b7e798 0x10247da7c 0x10247da3c 0x10248a554 0x10248172c 0x10247da3c 0x10248cc9c 0x10248c364 0x1816f9470 0x1816f9020)\\\nlibc++abi.dylib: terminating with uncaught exception of type NSException\\\nIt makes my app crash.\nAny suggestion?\nThanks!\n. ",
    "laeroah": "Any updates on this issue? We are still seeing it in version 8.2.0.. ",
    "tahirbinpasha": "did anyone found the solution ?\n\n. not able to reproduce it but caught on crashlytics.. ",
    "mjracca": "I have almost the same issue, and to fix this is urgent.\nIt seams like when sending an event with simple NSStrings it work's fine, but when I send a json string then the other platform doesn't receive the event.\nAny way of fixing this?\n. ",
    "adnanafzal565": "Please provide any solution for this.. ",
    "ysfox": "In Java servion,I sove it like this \nI join th session and formId in my url,Java connected is OK and our server get the session and formId,Now problem is in iOS,I can't send the session and formId?how can do it? TKS!!!\n`    private void initSocket() {\n        String si = null;\n        this.spHelper = new SharedPreferencesHelper(_this, \"niugu_config\");\n        if (httpController.isLogin())\n            si = spHelper.getString(\"session\");\n        LogUtil.e(\"session=\" + si);\n        try {\n            socket = IO.socket(NetUrl.SOCKET_URL + \"?SESSION=\" + si + \"&formId=\" + roomId);\n            socket.on(Socket.EVENT_CONNECT,\n                    args -> {\n                        LogUtil.e(\"\u5df2\u8fdb\u5165\u623f\u95f4:\" + roomId + \"\\n\" + String.valueOf(args));\n                    })\n                    .on(Socket.EVENT_DISCONNECT,\n                            args -> {\n                                LogUtil.e(\"\u5df2\u9000\u51fa\u623f\u95f4:\" + roomId + \"\\n\" + String.valueOf(args));\n                            })\n                    .on(\"niugu\", args -> {\n                        for (Object obj : args) {\n                            String msgStr = String.valueOf(obj);\n                            LogUtil.e(\"\u3010\u6536\u5230\u65b0\u6d88\u606f\u3011\" + msgStr);\n                            try {\n                                org.json.JSONObject jObj = new org.json.JSONObject(msgStr);\n                                if (jObj.getString(\"action\").equals(\"createMessage\")) {//todo \u5176\u4ed6\u7684action?\n                                    NgMsg ngMsg = JSONObject.parseObject(jObj.getString(\"data\"), NgMsg.class);\nMessage msg = new Message();\n                                msg.what = 111;\n                                Bundle bd = new Bundle();\n                                bd.putSerializable(\"msg\", ngMsg);\n                                msg.setData(bd);\n                                newMsg.sendMessage(msg);\n                            }\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                    }\n                });\n        socket.connect();\n    } catch (URISyntaxException e) {\n        e.printStackTrace();\n    }\n}`\n. I use object-c Bridge model\uff0cin bridge.h can\u2018t find ConnectParams method...\n. the swift.h bridge file like blow,no find connectParams...method\n`/// Not so type safe way to create a SocketIOClient, meant for Objective-C compatiblity. If using Swift it's recommended to use init(socketURL: NSURL, options: Set)\n- (nonnull instancetype)initWithSocketURL:(NSURL * __nonnull)socketURL options:(NSDictionary * __nullable)options;\n/// Connect to the server.\n- (void)connect;\n/// Connect to the server. If we aren't connected after timeoutAfter, call handler\n- (void)connectWithTimeoutAfter:(NSInteger)timeoutAfter withTimeoutHandler:(void (^ __nullable)(void))handler;\n- (void)didConnect;\n- (void)didDisconnect:(NSString * __nonnull)reason;`\n. you mean is like this ???\n`        NSURL* url = [[NSURL alloc] initWithString:[NSString stringWithFormat:@\"http://192.168.12.101:3000\"]];\n        SocketIOClient* socket = [[SocketIOClient alloc] initWithSocketURL:url options:@{@\"forcePolling\": @YES}];\n```\n    [socket.engine setConnectParams:@{@\"SESSION\": authModel.sessionId, @\"formId\": @(self.roomId)}];\n    [socket on:@\"connect\" callback:^(NSArray data, SocketAckEmitter ack) {\n        CFLog(@\"%@-------%@\",data,ack);\n    }];\n[socket on:@\"niugu\" callback:^(NSArray* data, SocketAckEmitter* ack) {\n    CFLog(@\"%@-------%@\",data,ack);\n}];\n\n[socket connect];`\n\n```\n. how to set parameters during my first connected our servers????\nI set the parameters in cookies,but get worry!\n. ",
    "zackzeno": "Yes, I used to use a VoIP library called Sinch and it worked perfectly, so I know that I have the correct permissions. \nI am trying to switch over to socket io so I can detect presence and send custom messages.\n\nOn May 19, 2016, at 5:03 PM, Erik Little notifications@github.com wrote:\nHave you set the background execution permissions?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly or view it on GitHub\n. Alright, I guess I'll try the underlying web socket library used here. \n\nI'm trying to stay swifty and Apple hasn't ported the socket stuff well yet.\n\nOn May 19, 2016, at 9:09 PM, Erik Little notifications@github.com wrote:\nBackground execution is the one thing I'm never sure of, since I've not really tried and getting it working myself. And I really wouldn't ever think to use socket.io for VoIP.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly or view it on GitHub\n. \n",
    "ATLCTO": "Our server went down and it crashed the iOS app because % in 100% is a formatting string.\n\"Got unknown error from server <!DOCTYPE html>\\n    <html>\\n    <head>\\n      <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1\\\">\\n      <style type=\\\"text/css\\\">\\n        html, body, iframe { margin: 0; padding: 0; height: 100%; }\\n        iframe { display: block; width: 100%; border: none; }\\n      </style>\\n    <title>Application Error</title>\\n    </head>\\n    <body>\\n      <iframe src=\\\"//s3.amazonaws.com/heroku_pages/error.html\\\">\\n        <p>Application Error</p>\\n      </iframe>\\n    </body>\\n    </html>\"\n. \n. ",
    "oinsider": "Same here, when writing some data in the socket I get the same error. \nThe config that I am using:\n        return SocketIOClient(socketURL: NSURL(string:Servers.secureHostUrl)!,\n                                     options:  [.Log(true),\n                                                     .Secure(true),\n                                                     .ForceWebsockets(true)\n            ])\nMy log:\nLOG SocketEngine: Got message: 3\nLOG SocketEnginePolling: Got polling response\nLOG SocketEnginePolling: Doing polling request\nLOG SocketEngine: Writing poll:  has data: 0\nLOG SocketEnginePolling: Sending poll:  as type: 2\nLOG SocketEnginePolling: Created POST string: 1:2\nLOG SocketEnginePolling: POSTing\nLOG SocketEnginePolling: Doing polling request\nLOG SocketEnginePolling: Got polling response\nLOG SocketEnginePolling: Doing polling request\nLOG SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\nERROR SocketEngine: Session ID unknown\nERROR SocketIOClient: Session ID unknown\nLOG SocketIOClient: Handling event: error with data: (\n    \"Session ID unknown\"\n)\nI also noticed that if I force the websockets the connection can\u00b4t even be stablished.\nMy log when I force the websockets:\nLOG SocketIOClient: Adding handler for event: loginResponse\nLOG SocketIOClient: Starting reconnect\nLOG SocketIOClient: Handling event: reconnect with data: (\n    \"Socket Disconnected\"\n)\nLOG SocketIOClient: Trying to reconnect\nLOG SocketIOClient: Handling event: reconnectAttempt with data: (\n    \"-1\"\n)\nLOG SocketEngine: Starting engine\nLOG SocketEngine: Handshaking\nLOG SocketIOClient: Trying to reconnect\nLOG SocketIOClient: Handling event: reconnectAttempt with data: (\n    \"-2\"\n)\n. @nuclearace does the library store the cookies when pulling to maintain the connection? maybe in android and web library this cookie is stored somewhere\n. Hi, I am also getting the same error. The debugger is telling me that is coming from the handler.executeCallback(data, withAck: ack, withSocket: self) method in the SocketIOClient.swift. \nI am using the swift 3 version of the library.\nIs there any way of knowing if the event has not been delivered, or if an error like this one happened?\n. Thanks @nuclearace I just tried @oldshuren's socket.io-client-swift fork with proxy connect and almost works. At least I can see the wss connection even if the server is closing it. \n\n. I also will try to make it work, thanks!\n. Sorry @nuclearace it was my fault, I wasn't using the correct branch.\nI noticed that there was a redeclaration of allowedURLCharacterSet and urlEncode, removing the files just worked for me.\nThanks!\n. Same here\n. ",
    "njawahire": "thanks nuclearace it helped me...... \n. ",
    "tomergev": "This answer did not work for me! Instead I did this (and it worked!): \nsocket.on(\"event\" , someHandler);  \nsocket.removeListener(\"event\", someHandler);. ",
    "Siretfel": "No it is not a socket.io server. Can I use the library with a non-socket.io server?\n. @AlexChesters and @nuclearace thanks for your answer. Obviously I did not pay attention to that restriction. I will search for an alternative. \n. ",
    "roma86": "Thank you\n. Yes, thank you. I am sorry do not mentions that. \n. @nuclearace i can not get your point. Can you explain, please?\n. Thankyou. Should i redirect this issue to the repo you are linked, or there are no way to determine the problem from such raw description and one screenshot?\n. ",
    "arashdoescode": "How do i do that?\n. If it is not connected what are the possibilities?\n. The problem is currently is with the authorization library that Im using on the serverside, which is socket.io-jwt, it requires the authorization headers. So basically my approach will be to emit the token from the authentication back to the front end.\nsocket.on('authorized', function(data) {\n    socket.emit('token', data);\n});\nTell me whether this approach is safe to do?\n\nI have asked a new question kindly close this question, if it is not relevant anymore.\nThanks\n. Is this the only way?\n. I keep getting this error, got this from the log from socket client swift\n\nHandling event: error with data: (\n        {\n        code = \"credentials_required\";\n        message = \"No Authorization header was found\";\n        type = UnauthorizedError;\n    }\n)\n. The code after I changed to your suggestion.\n```\nimport UIKit\nimport SocketIOClientSwift\nimport KeychainAccess\nclass SocketIOManager: NSObject {\n    static let sharedInstance = SocketIOManager()\nlet keychain = Keychain(server: \"https://testing.herokuapp.com\", protocolType: .HTTPS)\n\nvar token: String {\n    get {\n        return String(keychain[\"token\"])\n    }\n}\n\nlazy var socket: SocketIOClient = SocketIOClient(socketURL: NSURL(string: \"https://testing.herokuapp.com\")!,\n                                                 options: [.Log(true), .ConnectParams([\"Authorization\": self.token])])\n\noverride init() {\n    super.init()\n\n}\n\n\nfunc establishConnection() {\n    socket.connect()\n}\n\nfunc closeConnection() {\n    socket.disconnect()\n}\n\nfunc onJob(lat: String, long: String) {\n    socket.emit(\"onJob\", lat, long)\n}\n\n}\n```\n. I tried Extraheaders before ConnectParams, still getting errors. I even wrote a stackoverflow question, but couldn't find an answer. I'm screwed :( \nHere's the question\nhttp://stackoverflow.com/questions/37549701/secret-or-public-key-must-be-provided-ios-swift-socket-io-jwt\nBtw I couldn't find this open source tag on SO\n. I took directly from this open sourced library https://github.com/auth0/socketio-jwt\nAssumed that libraries has been called.\n```\nio.use(socketioJwt.authorize({\n  secret: config.SECRET,\n  handshake: true\n}));\nio\n     .on('connection', function(socket) {\n  })\n.on('authenticated', function(socket){\n   console.log('connected & authenticated: ' + socket.decoded_token);\n       socket.on('genieOnJob', function(data) {\n      console.log(data);\n});\n\n});\n```\n. I did that already, if you take a look at SO question.\n. Already solved it, thanks Erik\n. @nuclearace What do you mean support will be dropped?\n. For your advise in app.delegate, where should i put it? let say if put the app in background and whenever trying to connect it again ,the socket will lost it connection\n. Just for clarity, if i establish the connection in any screen, the connection will persist in any other screen? only if the app still active?\n. Sorry for the late reply, I made a mistake on my part. Thank you for pointing that out.\n. Yeah if it on the same viewController it does work.\nI don't really understand this part there should be some object that holds the socket that always exists as long as it should.\nTo be honest Im quite confused to where should I put the socket, For example\nIf i put \nsocket in the app.delegate\nlet socket: SocketIOClient = SocketIOClient(socketURL: NSURL(string: \"https://testing.herokuapp.com\")!,options: [.Log(true)])\nI don't how to access its object in other view Controller\n. static SocketManager like a class? could show me one example. Thank you\n. Thanks Erik, but should I call socket manager in app delegate?\n```\n func applicationDidBecomeActive(application: UIApplication) {\n    let manager = SocketClientManager.sharedManager\n   manager.addSocket(SocketIOClient(socketURL: NSURL()))\n    manager.sockets[0]\n}\n\n```\n. Just to clarify in View Controller, Could I do\nmanager.addSocket.emit() ?\n. So technically i need to do for loop? for each socket?\n. Last question, should I connect the socket in app.delegate?\n. ",
    "oldshuren": "Ok, thanks!\nI modified podspec because 'path' and 'branch' attribute in my Podfile\ndidn't work. But even I changed the podspec, it still didn't work. I'll\nchanged it back.\nOn Tue, May 31, 2016 at 12:11 PM, Erik Little notifications@github.com\nwrote:\n\nAll pull request for WebSocket should be made at\nhttps://github.com/daltoniam/Starscream. Also you shouldn't change\npodspec to point to yours, I would create a new version and push it.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/pull/380#issuecomment-222738670,\nor mute the thread\nhttps://github.com/notifications/unsubscribe/AHRzfF-u6m77eZ1vn5ApKBElpLBBf6GPks5qHF3LgaJpZM4IqPzb\n.\n. \n",
    "UmaMadhavi": "how to send authorisation headers when using socket.io\n. my server side provided me web sockets \n. in the place of \"my event\" should i send api path?. @nuclearace . I am not understanding that one . actually i have added my code like this\n let socket = SocketIOClient(socketURL: URL(string: \"http://\"+SERV_HOST_PORT+\"/gs-guide-websocket/info?access_token=\\(accessToken!)\")!, config: [.log(true), .forcePolling(true)])\n\n        socket.emit(\"/upsock/tripupdate/\\(tripId!)\", parameters)\n        socket.on(\"connect\") {data, ack in\n        print(\"Connected...\")\n        }\n    socket.connect()\n\nIn this scenario i am getting authentication failed full authorisation required to access. Can u please tell me where is my mistake.\n . when i add using connectParams it does not call at all.\n. ",
    "nithinreddygaddam": "Can you please tell me how you solved this problem? and did you create an Auth0 account for your application?\n. ",
    "spartangian": "I had the same problem. But I already made it work. In my situation I just did this:\nvar socket = SocketIOClient(socketURL: URL(string: \"https://blah-blah.io\")!, config: SocketIOClientConfiguration(arrayLiteral: SocketIOClientOption.connectParams([\"jwt\": self.token])))\nhope this will help someone\nFYI: I am using swift 3 and updated xcode\n. ",
    "ngaddamLogi": "Send the token string using emit like an other regular string. You can check my server code in here: https://github.com/nithinreddygaddam/Server-SocketChat/blob/master/index.js\nit is an iOS chat application built using socket.io. The server code and iOS application is made public for your reference.. ",
    "AdnanMunir": "\nSend the token string using emit like an other regular string\n\nngaddam can you please share your code ? I am doing following:\n        manager = SocketManager(socketURL: URL(string: url)!, config: [.secure(true),.log(true),.forceNew(true),.forceWebsockets(true),.extraHeaders([\"Authorization\":\"Bearer (token)\"])])\n        socket = manager.defaultSocket\n        socket.connect()\nbut its not working\n. ",
    "shanshuiren": "I have the same problem. Any solution?\n. @nuclearace  Yes, i'm using it from Objective-C.\n. try  @\"forceWebsockets\":@true. ",
    "kennyiproperty": "hi,\nThis is what I did, is there something extra still needed? Thank you.\n```\n- (void)URLSession:(NSURLSession )session didReceiveChallenge:(NSURLAuthenticationChallenge )challenge completionHandler:(void (^)(NSURLSessionAuthChallengeDisposition, NSURLCredential * _Nullable))completionHandler {\n    NSLog(@\"test\");\ncompletionHandler(NSURLSessionAuthChallengeUseCredential, [NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust]);\n\n}\n```\n. the url is different but i'm suspecting it's with this I'm getting. I notice for successful connections sid is passing something over but for the failed connection sid is nil. Does the sid need to have something for it to connect successfully? Thank you very much for the help.\nhttps://test.com/chatsocket/socket.io?transport=polling&b64=1&sid=\n. ok I have figured out the issue. What was happening is that the @\"path\":@\"/testsocket/socket.io\" parameter style for the ios library is different from the web version. The iOS needed an extra \"/\" at the end. So the error was because the end URL is incorrect. This is now resolved and thanks very much for the help!\n. ",
    "ururk": "I'm finding the same behavior with the current version of the client (8.2.0) + server (1.7.2), but I haven't checked the logs to see if I'm getting the same errors. Is this a potential bug, or is there a way to detect that emits aren't being sent yet?. ",
    "petemillermultimedia": "I think I see an issue in SocketEngine.swift. The write() method has a case which does\nself.probeWait.append((msg, type, data))\n\nbut in flushProbeWait() the code does\n for waiter in probeWait {\n    write(waiter.msg, withType: waiter.type, withData: waiter.data)\n }\n probeWait.removeAll(keepingCapacity: false)\n\nwhich results in deleting the waiters. Is this intended?\npublic func write(_ msg: String, withType type: SocketEnginePacketType, withData data: [Data]) {\n| engineQueue.async {\n\u00a0 | guard self.connected else { return }\n\u00a0 | \u00a0\n\u00a0 | if self.websocket {\n\u00a0 | DefaultSocketLogger.Logger.log(\"Writing ws: %@ has data: %@\",\n\u00a0 | type: self.logType, args: msg, data.count != 0)\n\u00a0 | self.sendWebSocketMessage(msg, withType: type, withData: data)\n\u00a0 | } else if !self.probing {\n\u00a0 | DefaultSocketLogger.Logger.log(\"Writing poll: %@ has data: %@\",\n\u00a0 | type: self.logType, args: msg, data.count != 0)\n\u00a0 | self.sendPollMessage(msg, withType: type, withData: data)\n\u00a0 | } else {\n\u00a0 | self.probeWait.append((msg, type, data))\n\u00a0 | }\n\u00a0 | }\n\u00a0 | }\n\u00a0\nprivate func flushProbeWait() {\n| DefaultSocketLogger.Logger.log(\"Flushing probe wait\", type: logType)\n\u00a0 | \u00a0\n\u00a0 | for waiter in probeWait {\n\u00a0 | write(waiter.msg, withType: waiter.type, withData: waiter.data)\n\u00a0 | }\n\u00a0 | \u00a0\n\u00a0 | probeWait.removeAll(keepingCapacity: false)\n\u00a0 | \u00a0\n\u00a0 | if postWait.count != 0 {\n\u00a0 | flushWaitingForPostToWebSocket()\n\u00a0 | }\n\u00a0 | }\n\u00a0\n. I have an intermittent issue where an emit call in \"onConnect\" is basically ignored, i.e.\nsocket!.on(\"connect\") {data, ack in\n    socket.emit(\"authenticate\", obj)\n}\nI observed in the logs that the emit message was queued but no POST operation occurred. I also observed that flushProbeWait is called from WebSocket.swift doDisconnect() shortly after connecting, before upgrading. I haven't been able to demonstrated it decisively, but I suspect that the flush operation deleted the message.. \"me too\".  I'm not ready to move to Swift 3.0, how do I get a working pod for Swift 2.3?\n. I'm setting my podfile to\n  pod 'Socket.IO-Client-Swift', '7.0.3'\nwhich is the version shown under the swift2.3 branch. Is that the correct way to point to the branch?\n. ",
    "mrikh": "Any updates regarding this?. ",
    "itkith": "I am trying to create a  common class to listen message from socket when user is on different view controller or app is in background mode. Socket.on is not hitting on receiving of message. Kindly help?. ",
    "Humbhiashwani": "I am trying to create a common class to listen message from socket when user is on different view controller or app is in background mode. Socket.on is not hitting on receiving of message. Kindly help?. ",
    "drekka": "@hifall Change your build target from a static library to a framework. You can then use socket.io in it without issues. You can also build socket.io as a framework as import that. In my project I'm building socket.io and other frameworks using carthage without issues. \n. Whoa. That information is really out of date - don't do that :-) \nBuilding a framework these days is dead simple. In Xcode add a new target using the Framework & Library/Cocoa Touch Framework template. Then just add your code like you would for a static library. XCode will build a *.framework file ready for use. \nI did a quick search and found this article: https://robots.thoughtbot.com/creating-your-first-ios-framework It seems to be very good in that it shows how easy it is, then goes on to handling dependencies, CocoaPods and  Carthage support, and testing. Pretty much everything you would do as part of building an API.\n. Hi @bhartsb - it sounds like you are using socket.io from Swift. Which class are you adding @objc to?\n. ok. Can't speak for web sockets, but here is basically what I did to use the socket.io framework:\n1. Build the socket.io/socket.io-client-swift project using carthage. \n   1. Add github \"socketio/socket.io-client-swift\" to my project's Cartfile.\n   2. Run carthage update\n2. Add the resulting framework into my project as I would for any other framework.\n3. Add an import:\n#import <SocketIOClientSwift/SocketIOClientSwift-Swift.h>\n4. Instantiate socket:\nobject\n   SocketIOClient *socket = [[SocketIOClient alloc] initWithSocketURL:_serverURL options:@{@\"log\":@YES}];\n   // Configure the socket ...\nHope that helps.\n. Understand. So far, it's been working fine on another machine and a different project. However I've not tried to work with anything that involves the system Security framework.\n. Yep. Thanks. Look like everything is good now.\n. Nuts. It's back. I may have been mistaken about it being fixed. I'm using the development branch of socket.io-swift.\n. Okies. I switched to the Swift3 branch and it looks like it's solved the problem. Looks like it's a Swift version issues or something similar. Now having problems with XCode failing to copy the Swift libraries into the app. Missmatch ABI. \nSwitched back to development branch. Getting no umbrella header again.\n. Hi, nope. Develop is showing the\ntype argument 'SecKeyRef' (aka 'struct __SecKey *') is neither an Objective-C object nor a block type\nError as well.\n. Looks like problem is in Source/SSLSecurity.swift line 224 where it returns an array of SecKeyRef. Fine for Swift, but doesn't translate to Objective-C because SecKeyRef is a struct and you cannot put a struct into a NSArray. Might have to wrap them in NSValues or make this code private so Objective-C cannot see it.\n. Thanks\n. Dam, still not working in final app. Libswiftcore not found. Closing until I've resolved this.\n. ",
    "bhartsb": "I too am trying to get this library working from Objective-C.  I've added a framework, added the swift source files, and built the framework.   I shouldn't need to add @objc to the class as it is already inheriting from NSObject.  The documentation herein regarding this seems to be missing some steps. \n. I have an objective c project that I want to use the swift library in.  I found out that there's a auto generated bridging header file that I have to include in my objective-C file that I want to use this swift library from.  Not withstanding I'm not sure that this is even the correct library to use since I'm using websockets.I saw other issues where another library for specifically websockets was being mentioned.\n\nOn Jun 21, 2016, at 6:31 PM, Derek Clarkson notifications@github.com wrote:\nHi @bhartsb - it sounds like you are using socket.io from Swift. Which class are you adding @objc to?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub, or mute the thread.\n. Thanks!\n\nSent from my iPhone\n\nOn Jun 21, 2016, at 6:59 PM, Derek Clarkson notifications@github.com wrote:\nok. Can't speak for web sockets, but here is basically what I did to use the socket.io framework:\nBuild the socket.io/socket.io-client-swift project using carthage.\nAdd github \"socketio/socket.io-client-swift\" to my project's Cartfile.\nRun carthage update\nAdd the resulting framework into my project as I would for any other framework.\nAdd an import:\nimport \nInstantiate socket:\nSocketIOClient *socket = [[SocketIOClient alloc] initWithSocketURL:_serverURL options:@{@\"log\":@YES}];\n// Configure the socket ...\nHope that helps.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub, or mute the thread.\n. So what I have is a messaging app, and when I simulate a poor network connection, and try to send multiple msgs (text, audio, or photo), it is desirable to have some timeout, mark the msgs that didn't send undelivered, and provide the user the option to resend or not.  If I can't stop the original emit once it is called then the next time they do connect the old emit will fire anyway, even if the user didn't say resend. That is the reason for in-flight cancelling.  Also after a disconnect and reconnect, the message fires, is received by the server but the ack callback doesn't happen.  This is odd because the server responds back to the awk method specified.  It is like the server has the wrong (old) connection info for the awk.  Ideas???\n\nThe workaround could be that I send with each emitWithAck a timeout time and if when the server receives the message, and it is after this timeout time, it drops the message.  This would accomplish almost the same thing as being able to cancel the in-flight emit.    \nAlso what is setReconnects:?\n. My app has location sharing as a feature and has to send location data when in the background.  Is there anything else you can suggest?  \nWhen the user is location sharing I need to be able to reconnect while the app is in the background. I've tested this with users in cars many times and it seems to work 90-95% of the time.  However once in a while, it doesn't.  I.e. it can't reconnect even when the app is brought to the foreground.  Every time it tries to reconnect it will disconnect first, then set the socketIOSwift = nil, and then try to open a new connection, per the code sample I gave in this ticket.  \nIt is a very hard to isolate issue.  Last night I repeated the test about a dozen times.   The test is where I'm in my house connected to wifi and then put the app in the background and then leave the house, walk out of the distance of wifi and then bring the app to the foreground.  Wala it won't reconnect.  This was repeatable every time.  Today the same exact test doesn't fail.  It is like the cell tower configuration in my neighborhood is different during the day than during the night. \nI may be reaching for straws, but it seems like when the app is in the background, loses connection (whether on wifi or cellular), then the cellular tower changes, it can't reconnect.  I.e. it can't reconnect if it loses connection to one cellular tower A and then the cellular tower changes to B before it can reconnect. \n. Can you tell me which logs to look at?  Are you referring to connecting to\nxcode and looking at logs from there?\nOn Fri, Aug 18, 2017 at 1:54 PM, Erik Little notifications@github.com\nwrote:\n\nI am not sure I can be of much help in this case. The library itself\ndoesn't handle low level networking, such as determining when a device has\nswitched from wifi to cell (and I don't think it ever should.) So it relies\non URLSession when polling and Streams when on WebSockets. If those don't\ncommunicate that the connection has broken. Or don't function correctly,\nthere's nothing the library can do.\nThat being said, can you elaborate on\nDespite attempting to reconnect repeatedly it won't reconnect.\nWhat do the logs say it is doing?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/778#issuecomment-323458554,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AG3Ilz67C3vrIB96mwHHAfAEbo9j1FLnks5sZfoVgaJpZM4O7P4X\n.\n. Also, even if the library doesn't handle low-level networking, shouldn't I be able to create a whole new connection without having to close and re-open the app?  Before reconnecting I'm setting the SocketIOClient object to nil so it should be completely released and ready to re-establish a connection, right?  . Yes I'm doing it as shown in the code I've posted, and so as you say it is a \"new client\" but it is not connecting.  Whenever this occurs I have to completely shut and reopen my app and then it creates a new client and connects right away.  Any ideas on what I can do?\n\nIt is not my being fooled by a bad connection.  This has been happening for months, but I just haven't known what to do about it.  Now my app binary has been rejected by Apple so I have to address it.  Not to repeat myself but I have method \"renewConnection\" that if there isn't an established connection to the server within 4 seconds it nils the old client and creates a new one and attempts a connection.\nBut in these peculiar instances the new client doesn't connect.. Actually I do have it set to true/YES so how do I access this log?  It does\nnot appear in the list when I connect to the device in\nXcode->window->devices.\nOn Fri, Aug 18, 2017 at 6:19 PM, Erik Little notifications@github.com\nwrote:\n\nI'm not sure what would be the cause then. You'd have to start debugging\nthe client. The logs I'm referring to are the ones when you have the\n.log(true) config set.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/778#issuecomment-323491089,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AG3IlxXg-9dg784Sa3BAvhadPh7Sc-Cnks5sZjgogaJpZM4O7P4X\n.\n. I know that I can view the log live in Xcode, but when this issue occurs I'm usually not tethered to my computer.  Is there a way to view the log output (I'm assuming this is console output?) from when the device was not tethered?. I found this so I'll try it first:\nhttps://stackoverflow.com/questions/9097424/logging-data-on-device-and-retrieving-the-log\n\nHow to download the log using iTunes: https://support.apple.com/en-us/HT201301\nMy app is mostly objective c.\nBTW, I'd like to propose something. Can you email me directly at bhartsb at\ngmail dot com.\nOn Fri, Aug 18, 2017 at 7:41 PM, Erik Little notifications@github.com\nwrote:\n\nThat I'm not sure of. You could provide a custom SocketLogger\nhttps://nuclearace.github.io/Socket.IO-Client-Swift/Protocols/SocketLogger.html\nwith the logger\nhttps://nuclearace.github.io/Socket.IO-Client-Swift/Enums/SocketIOClientOption.html#/s:FO8SocketIO20SocketIOClientOption6loggerFMS0_FPS_12SocketLogger_S0_\noption, but you'd have to define it in Swift.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/778#issuecomment-323494963,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AG3Il5YnZrN__pCQi9SsJmSS4ujr5RIKks5sZktDgaJpZM4O7P4X\n.\n. Well that is pretty much the direction this has been taking but I would like to propose something longer-term.  As far as this issue I've been \"fiddling\" with it for months.  I have little idea why it is happening or how to reproduce it reliably, but maybe the logs will give a hint.  I'm going to try again tonight with walking down the street to see if it magically reappears.  . I'll just temporarily post my proposition here.  Just FYI this my app: https://drive.google.com/file/d/0B4VrKDriBUuuc1dweWR3enRkcTA/view?usp=sharing\n\nI'm trying to release it.  It has been in development a long time.   It depends on numerous open source libraries some more important than others.  I'm wearing too many hats so I'd like to offer stock in exchange for a higher level of support by you for socket.io-client-swift.  Anyway, I thought I'd throw it out there.  \nI've often thought that the main committers of open source projects could adopt this model.  Choosing wisely of course which projects they think are likely to go somewhere.. Yes think over the proposition, and get back to me when and if you want to\nnegotiate something.  The app has a fair chance at doing well I think.\nPer the long polling non-forced web sockets option.  I guess I could, I\ntried it and it seems to work.   Long polling as I understand has more\noverhead, but can I assume that it will use websockets when possible?  And\nI don't know what the issue is with Starscream, but I will take your word\nfor it.  So I'll try it and see.  Thanks.\nOn Fri, Aug 18, 2017 at 9:27 PM, Erik Little notifications@github.com\nwrote:\n\nThat's an interesting proposition. Not sure I can comment on it much right\nnow though. As for the issue. I can offer some hints.\nSince it looks like you're forcing WebSockets, it might actually be an\nissue with Starscream and how it handles this case. Is it possible to not\nforce websockets?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/778#issuecomment-323499549,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AG3IlwDwlBD1DEn_ROtjArqsn0k0BEgHks5sZmQ0gaJpZM4O7P4X\n.\n. @nuclearace So not forcing Websockets doesn't help.   I've gone in and changed my code so that I'm only creating socketIOSwift one time when the app launches, and depending on the reconnects to work.   But the sequence that breaks it most of the time is with cell data off and wifi on open my app.   Put the app in the background and turn on cell data.   Walk out of my house out and walk beyond the range of wifi.  Open the app and note that it won't send data anymore.  The logs don't show anything about disconnecting or reconnecting but the connection goes out to lunch.  \n\nIt won't go out to lunch if I start connected to cell data and remain on cell data.  Not over a short distance but I'll have to do more testing driving.\nAlso per the reconnectWait config is it seconds or milliseconds?  . Here's a sample bit of the log (when it is out to lunch) that looks like it is sending something but getting null back:\n2017-08-22 03:50:30.616 Pindragon[2688:626246] LOG SocketEngine: Sending ws: 230[\"getSocketIDsIndicatingUserAliasIsOnline\",[\"jade_socketID\",\"ree_socketID\",\"crystal_socketID\",\"iphone5so4_socketID\",\"iphone6s_socketID\",\"bhartpindragon_socketID\",\"stem_socketID\",\"Handle_socketID\",\"bethany11_socketID\",\"iphone7_socketID\",\"jjhart_socketID\",\"bethany_socketID\",\"iphone6sb_socketID\",\"rio1_socketID\",\"Bethany_socketID\",\"cat_socketID\"]] as type: 4\n2017-08-22 03:50:30.799 Pindragon[2688:626182] LOG SocketEngine: Got message: 4330[[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]]\n2017-08-22 03:50:30.799 Pindragon[2688:626182] LOG SocketIOClient: Should parse message: 330[[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]]\n2017-08-22 03:50:30.801 Pindragon[2688:626182] LOG SocketParser: Parsing 330[[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]]\n2017-08-22 03:50:30.801 Pindragon[2688:626182] LOG SocketParser: Decoded packet as: SocketPacket {type: 3; data: [<__NSArrayM 0x170c438a0>(\n,\n,\n,\n,\n,\n,\n,\n,\n,\n,\n,\n,\n,\n,\n,\n\n)\n. @nuclearace Yes, you said you were going to be unavailable so NP. Thanks for clarifying on the reconnectWait.  So I believe the issue turned out to be that  I was reading a pertinent value from the keychain and the keychain sometimes returns nil if it isn't ready.  This was infrequent intermittent behavior which why it took so long to find it.\nI just resubmitted my app to Apple today after fixing a few other issues as well.  My offer is still open if you want to discuss it at some point.  It could be limited to just things related to socket.io-client-swift as they arise or expanded if you were interested to encompass some other backend to client, network and scaling kinds of things as I need help.  . Okay I understand feel free to reach out if you change your mind as I think the app is likely to do pretty well.  It better because I have years invested into it.\nSent from my iPhone\n\nOn Aug 29, 2017, at 4:03 PM, Erik Little notifications@github.com wrote:\n@bhartsb so is this issue resolved? If so I'll close the issue.\nI appreciate the offer, but I'm pretty busy with work, and with this library and another I have, I don't think I would have enough time to spend to be of any help. I appreciate the offer though.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub, or mute the thread.\n. \n",
    "b9AobJ": "why have not oc,if use swift to create static framework,it will be add libSwiftBridge.a,has 100M+. i have same problem,pls quickly check this,my project use it\n. ",
    "ZvOlCuOk2009": "@drekka  I'm adding a dependency, and get the following error:\n*** Building scheme \"Starscream\" in Starscream.xcodeproj\nBuild Failed\n    Task failed with exit code 65:\n    /usr/bin/xcrun xcodebuild -project /Users/admin/Test\\ Tiras/Carthage/Checkouts/Starscream/Starscream.xcodeproj -scheme Starscream -configuration Release -derivedDataPath /Users/admin/Library/Caches/org.carthage.CarthageKit/DerivedData/8.3.2_8E2002/Starscream/3.0.3 -sdk watchos ONLY_ACTIVE_ARCH=NO BITCODE_GENERATION_MODE=bitcode CODE_SIGNING_REQUIRED=NO CODE_SIGN_IDENTITY= CARTHAGE=YES archive -archivePath /var/folders/2r/nmnc_7gx06j5b51q854nm48h0000gn/T/Starscream SKIP_INSTALL=YES GCC_INSTRUMENT_PROGRAM_FLOW_ARCS=NO CLANG_ENABLE_CODE_COVERAGE=NO (launched in /Users/admin/Test Tiras/Carthage/Checkouts/Starscream). Please tell me how to properly create a request for objective - c. Having a host: dev.tircloud.com, and port:3100.\nMy code from the example:\nNSURL* url = [[NSURL alloc] initWithString:@\"https://dev.tircloud.com:3100\"];\nSocketManager* manager = [[SocketManager alloc] initWithSocketURL:url config:@{@\"log\": @YES, @\"compress\": @YES}];\nSocketIOClient* socket = manager.defaultSocket;\n\n[socket on:@\"connect\" callback:^(NSArray* data, SocketAckEmitter* ack) {\n    NSLog(@\"socket connected\");\n}];\n\n[socket on:@\"currentAmount\" callback:^(NSArray* data, SocketAckEmitter* ack) {\n    double cur = [[data objectAtIndex:0] floatValue];\n\n    [[socket emitWithAck:@\"canUpdate\" with:@[@(cur)]] timingOutAfter:0 callback:^(NSArray* data) {\n        [socket emit:@\"update\" with:@[@{@\"amount\": @(cur + 2.50)}]];\n    }];\n\n    [ack with:@[@\"Got your currentAmount, \", @\"dude\"]];\n}];\n\n[socket connect];\n\nBut I'm not getting a successful connection, here logs:\n2018-03-23 12:14:22.430736+0200 Tir test[48926:998128] LOG SocketIOClient{/}: Adding handler for event: connect\n2018-03-23 12:14:22.432152+0200 Tir test[48926:998128] LOG SocketIOClient{/}: Adding handler for event: currentAmount\n2018-03-23 12:14:22.435026+0200 Tir test[48926:998128] LOG SocketIOClient{/}: Handling event: statusChange with data: [connecting]\n2018-03-23 12:14:22.435560+0200 Tir test[48926:998128] LOG SocketIOClient{/}: Joining namespace /\n2018-03-23 12:14:22.436038+0200 Tir test[48926:998128] LOG SocketManager: Tried connecting socket when engine isn't open. Connecting\n2018-03-23 12:14:22.436218+0200 Tir test[48926:998128] LOG SocketManager: Adding engine\n2018-03-23 12:14:22.440236+0200 Tir test[48926:998128] LOG SocketManager: Manager is being released\n2018-03-23 12:14:22.442009+0200 Tir test[48926:998389] LOG SocketEngine: Starting engine. Server: https://dev.tircloud.com:3100\n2018-03-23 12:14:22.462745+0200 Tir test[48926:998389] LOG SocketEngine: Handshaking\n2018-03-23 12:14:22.466015+0200 Tir test[48926:998389] LOG SocketEnginePolling: Doing polling GET https://dev.tircloud.com:3100/socket.io/?transport=polling&b64=1\n2018-03-23 12:14:23.803681+0200 Tir test[48926:998405] TIC TCP Conn Failed [1:0x600000168100]: 12:8 Err(-65554)\n2018-03-23 12:14:24.442311+0200 Tir test[48926:998405] Task <34D418DB-0729-4DB7-9367-C2BE069E3F2C>.<1> HTTP load failed (error code: -1003 [12:8])\n2018-03-23 12:14:24.452838+0200 Tir test[48926:998405] Task <34D418DB-0729-4DB7-9367-C2BE069E3F2C>.<1> finished with error - code: -1003\n2018-03-23 12:14:24.726916+0200 Tir test[48926:998390] ERROR SocketEnginePolling: A server with the specified hostname could not be found.\n2018-03-23 12:14:24.730534+0200 Tir test[48926:998390] ERROR SocketEngine: A server with the specified hostname could not be found.\n2018-03-23 12:14:24.732097+0200 Tir test[48926:998390] LOG SocketEngine: Engine is being released. @nuclearace . I need to connect to the server and send it requests, using a socket io. I have a host and a port. I found a library that works with ios but how to generate the correct query I do not know. @nuclearace. @nuclearace I made SocketManager and SocketIOClient with strong properties. And now I do not release the client. But I get a log with other errors. Maybe they'll tell you what's wrong with me:\n2018-03-23 13:52:44.080629+0200 Tir test[52162:1064976] LOG SocketIOClient{/}: Adding handler for event: connect\n2018-03-23 13:52:44.082422+0200 Tir test[52162:1064976] LOG SocketIOClient{/}: Adding handler for event: currentAmount\n2018-03-23 13:52:44.083995+0200 Tir test[52162:1064976] LOG SocketIOClient{/}: Handling event: statusChange with data: [connecting]\n2018-03-23 13:52:44.084255+0200 Tir test[52162:1064976] LOG SocketIOClient{/}: Joining namespace /\n2018-03-23 13:52:44.084465+0200 Tir test[52162:1064976] LOG SocketManager: Tried connecting socket when engine isn't open. Connecting\n2018-03-23 13:52:44.084642+0200 Tir test[52162:1064976] LOG SocketManager: Adding engine\n2018-03-23 13:52:44.088797+0200 Tir test[52162:1065175] LOG SocketEngine: Starting engine. Server:  https://dev.tircloud.com:3100\n2018-03-23 13:52:44.089238+0200 Tir test[52162:1065175] LOG SocketEngine: Handshaking\n2018-03-23 13:52:44.092081+0200 Tir test[52162:1065175] LOG SocketEnginePolling: Doing polling GET https://dev.tircloud.com:3100/socket.io/?transport=polling&b64=1\n2018-03-23 13:52:44.290171+0200 Tir test[52162:1065175] [BoringSSL] Function nw_protocol_boringssl_handshake_negotiate_proceed: line 387 Handshake failed. Disconnecting the session\n2018-03-23 13:52:46.590152+0200 Tir test[52162:1065175] TIC TCP Conn Failed [1:0x6040001696c0]: 3:-9800 Err(-9800)\n2018-03-23 13:52:46.752933+0200 Tir test[52162:1065177] TIC TCP Conn Failed [2:0x604000168e80]: 3:-9800 Err(-9800)\n2018-03-23 13:52:46.824552+0200 Tir test[52162:1065177] TIC TCP Conn Failed [3:0x600000169180]: 3:-9800 Err(-9800)\n2018-03-23 13:52:46.825600+0200 Tir test[52162:1065177] NSURLSession/NSURLConnection HTTP load failed (kCFStreamErrorDomainSSL, -9800)\n2018-03-23 13:52:46.827135+0200 Tir test[52162:1065177] Task <6D317F1E-A7BC-4FE8-9FAD-DF9B031B91E9>.<1> HTTP load failed (error code: -1200 [3:-9800])\n2018-03-23 13:52:46.827871+0200 Tir test[52162:1065175] Task <6D317F1E-A7BC-4FE8-9FAD-DF9B031B91E9>.<1> finished with error - code: -1200\n2018-03-23 13:52:47.005444+0200 Tir test[52162:1065175] ERROR SocketEnginePolling: An SSL error has occurred and a secure connection to the server cannot be made.\n2018-03-23 13:52:47.007556+0200 Tir test[52162:1065175] ERROR SocketEngine: An SSL error has occurred and a secure connection to the server cannot be made.\n2018-03-23 13:52:47.010932+0200 Tir test[52162:1064976] ERROR SocketManager: An SSL error has occurred and a secure connection to the server cannot be made.\n2018-03-23 13:52:47.011853+0200 Tir test[52162:1064976] LOG SocketIOClient{/}: Handling event: error with data: [\"An SSL error has occurred and a secure connection to the server cannot be made.\"]\n2018-03-23 13:52:47.012178+0200 Tir test[52162:1064976] LOG SocketManager: Starting reconnect\n2018-03-23 13:52:47.012441+0200 Tir test[52162:1064976] LOG SocketManager: Trying to reconnect\n2018-03-23 13:52:47.013829+0200 Tir test[52162:1064976] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [-1]\n2018-03-23 13:52:47.015351+0200 Tir test[52162:1065175] LOG SocketEngine: Starting engine. Server:  https://dev.tircloud.com:3100\n2018-03-23 13:52:47.015523+0200 Tir test[52162:1065175] LOG SocketEngine: Handshaking\n2018-03-23 13:52:47.031603+0200 Tir test[52162:1065175] LOG SocketEnginePolling: Doing polling GET  https://dev.tircloud.com:3100/socket.io/?transport=polling&b64=1\n2018-03-23 13:52:47.118131+0200 Tir test[52162:1065175] TIC TCP Conn Failed [4:0x60400016abc0]: 3:-9800 Err(-9800)\n2018-03-23 13:52:47.187258+0200 Tir test[52162:1065177] TIC TCP Conn Failed [5:0x60000016a500]: 3:-9800 Err(-9800)\n2018-03-23 13:52:47.246149+0200 Tir test[52162:1065175] TIC TCP Conn Failed [6:0x60400016abc0]: 3:-9800 Err(-9800)\n2018-03-23 13:52:47.251350+0200 Tir test[52162:1065175] NSURLSession/NSURLConnection HTTP load failed (kCFStreamErrorDomainSSL, -9800)\n2018-03-23 13:52:47.251549+0200 Tir test[52162:1065175] Task <3661B0B6-F082-402D-B195-7E6B33BD3601>.<1> HTTP load failed (error code: -1200 [3:-9800])\n2018-03-23 13:52:47.252177+0200 Tir test[52162:1065177] Task <3661B0B6-F082-402D-B195-7E6B33BD3601>.<1> finished with error - code: -1200\n2018-03-23 13:52:47.252580+0200 Tir test[52162:1065177] ERROR SocketEnginePolling: An SSL error has occurred and a secure connection to the server cannot be made.\n2018-03-23 13:52:47.252751+0200 Tir test[52162:1065177] ERROR SocketEngine: An SSL error has occurred and a secure connection to the server cannot be made.\n2018-03-23 13:52:47.252946+0200 Tir test[52162:1064976] ERROR SocketManager: An SSL error has occurred and a secure connection to the server cannot be made.\n2018-03-23 13:52:47.253361+0200 Tir test[52162:1064976] LOG SocketIOClient{/}: Handling event: error with data: [\"An SSL error has occurred and a secure connection to the server cannot be made.\"]\n2018-03-23 13:52:57.014935+0200 Tir test[52162:1064976] LOG SocketManager: Trying to reconnect\n2018-03-23 13:52:57.015280+0200 Tir test[52162:1064976] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [-2]\n2018-03-23 13:52:57.016170+0200 Tir test[52162:1065178] LOG SocketEngine: Starting engine. Server:  https://dev.tircloud.com:3100\n2018-03-23 13:52:57.016606+0200 Tir test[52162:1065178] LOG SocketEngine: Handshaking\n2018-03-23 13:52:57.017613+0200 Tir test[52162:1065178] LOG SocketEnginePolling: Doing polling GET https://dev.tircloud.com:3100/socket.io/?transport=polling&b64=1\n2018-03-23 13:52:57.091830+0200 Tir test[52162:1065357] TIC TCP Conn Failed [7:0x604000169540]: 3:-9800 Err(-9800)\n2018-03-23 13:52:57.167923+0200 Tir test[52162:1065357] TIC TCP Conn Failed [8:0x60400016a440]: 3:-9800 Err(-9800)\n2018-03-23 13:52:57.231783+0200 Tir test[52162:1065359] TIC TCP Conn Failed [9:0x600000169180]: 3:-9800 Err(-9800)\n2018-03-23 13:52:57.232840+0200 Tir test[52162:1065359] NSURLSession/NSURLConnection HTTP load failed (kCFStreamErrorDomainSSL, -9800)\n2018-03-23 13:52:57.233077+0200 Tir test[52162:1065359] Task .<1> HTTP load failed (error code: -1200 [3:-9800])\n2018-03-23 13:52:57.233424+0200 Tir test[52162:1065357] Task .<1> finished with error - code: -1200\n2018-03-23 13:52:57.237128+0200 Tir test[52162:1065357] ERROR SocketEnginePolling: An SSL error has occurred and a secure connection to the server cannot be made.\n2018-03-23 13:52:57.242179+0200 Tir test[52162:1065357] ERROR SocketEngine: An SSL error has occurred and a secure connection to the server cannot be made.\n2018-03-23 13:52:57.245282+0200 Tir test[52162:1064976] ERROR SocketManager: An SSL error has occurred and a secure connection to the server cannot be made.\n2018-03-23 13:52:57.918602+0200 Tir test[52162:1064976] LOG SocketIOClient{/}: Handling event: error with data: [\"An SSL error has occurred and a secure connection to the server cannot be made.\"]\n2018-03-23 13:53:07.015704+0200 Tir test[52162:1064976] LOG SocketManager: Trying to reconnect\n2018-03-23 13:53:07.015967+0200 Tir test[52162:1064976] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [-3]\n2018-03-23 13:53:07.016208+0200 Tir test[52162:1065178] LOG SocketEngine: Starting engine. Server:  https://dev.tircloud.com:3100\n2018-03-23 13:53:07.016560+0200 Tir test[52162:1065178] LOG SocketEngine: Handshaking\n2018-03-23 13:53:07.016877+0200 Tir test[52162:1065178] LOG SocketEnginePolling: Doing polling GET https://dev.tircloud.com:3100/socket.io/?transport=polling&b64=1\n2018-03-23 13:53:08.096608+0200 Tir test[52162:1065447] TIC TCP Conn Failed [10:0x60400016a2c0]: 3:-9800 Err(-9800)\n2018-03-23 13:53:08.155390+0200 Tir test[52162:1065359] TIC TCP Conn Failed [11:0x60000016abc0]: 3:-9800 Err(-9800)\n2018-03-23 13:53:09.235045+0200 Tir test[52162:1065447] TIC TCP Conn Failed [12:0x60400016abc0]: 3:-9800 Err(-9800)\n2018-03-23 13:53:09.237348+0200 Tir test[52162:1065447] NSURLSession/NSURLConnection HTTP load failed (kCFStreamErrorDomainSSL, -9800)\n2018-03-23 13:53:09.238813+0200 Tir test[52162:1065447] Task .<1> HTTP load failed (error code: -1200 [3:-9800])\n2018-03-23 13:53:09.244522+0200 Tir test[52162:1065359] Task .<1> finished with error - code: -1200\n2018-03-23 13:53:09.246190+0200 Tir test[52162:1065359] ERROR SocketEnginePolling: An SSL error has occurred and a secure connection to the server cannot be made.\n2018-03-23 13:53:09.246408+0200 Tir test[52162:1065359] ERROR SocketEngine: An SSL error has occurred and a secure connection to the server cannot be made.\n2018-03-23 13:53:09.248655+0200 Tir test[52162:1064976] ERROR SocketManager: An SSL error has occurred and a secure connection to the server cannot be made.\n2018-03-23 13:53:09.249045+0200 Tir test[52162:1064976] LOG SocketIOClient{/}: Handling event: error with data: [\"An SSL error has occurred and a secure connection to the server cannot be made.\"]\n2018-03-23 13:53:17.017753+0200 Tir test[52162:1064976] LOG SocketManager: Trying to reconnect\n2018-03-23 13:53:17.018030+0200 Tir test[52162:1064976] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [-4]\n2018-03-23 13:53:17.020269+0200 Tir test[52162:1065515] LOG SocketEngine: Starting engine. Server:  https://dev.tircloud.com:3100\n2018-03-23 13:53:17.020976+0200 Tir test[52162:1065515] LOG SocketEngine: Handshaking\n2018-03-23 13:53:17.021820+0200 Tir test[52162:1065515] LOG SocketEnginePolling: Doing polling GET  https://dev.tircloud.com:3100/socket.io/?transport=polling&b64=1\n2018-03-23 13:53:17.083732+0200 Tir test[52162:1065515] TIC TCP Conn Failed [13:0x60400016ab00]: 3:-9800 Err(-9800)\n2018-03-23 13:53:17.137498+0200 Tir test[52162:1065520] TIC TCP Conn Failed [14:0x60000016a500]: 3:-9800 Err(-9800)\n2018-03-23 13:53:17.186798+0200 Tir test[52162:1065515] TIC TCP Conn Failed [15:0x60400016ab00]: 3:-9800 Err(-9800)\n2018-03-23 13:53:17.188881+0200 Tir test[52162:1065515] NSURLSession/NSURLConnection HTTP load failed (kCFStreamErrorDomainSSL, -9800)\n2018-03-23 13:53:17.189453+0200 Tir test[52162:1065515] Task <4DECACAF-21E4-4245-9108-BC186A54AC2A>.<1> HTTP load failed (error code: -1200 [3:-9800])\n2018-03-23 13:53:17.190014+0200 Tir test[52162:1065447] Task <4DECACAF-21E4-4245-9108-BC186A54AC2A>.<1> finished with error - code: -1200\n2018-03-23 13:53:17.190586+0200 Tir test[52162:1065447] ERROR SocketEnginePolling: An SSL error has occurred and a secure connection to the server cannot be made.\n2018-03-23 13:53:17.190832+0200 Tir test[52162:1065447] ERROR SocketEngine: An SSL error has occurred and a secure connection to the server cannot be made.\n2018-03-23 13:53:17.191164+0200 Tir test[52162:1064976] ERROR SocketManager: An SSL error has occurred and a secure connection to the server cannot be made.\n2018-03-23 13:53:17.191585+0200 Tir test[52162:1064976] LOG SocketIOClient{/}: Handling event: error with data: [\"An SSL error has occurred and a secure connection to the server cannot be made.\"]\n. No, I have version 8.3.2. ",
    "adnanawan12": "The problem occurs when you are behind NAT64/DNS64 network. In other words when you are using IPv6-only Networks (not url pointing to IPv6 adress). \nGo through the following documents to test the app (Test for IPv6 DNS64/NAT64 Compatibility Regularly\n)\nhttps://developer.apple.com/library/mac/documentation/NetworkingInternetWeb/Conceptual/NetworkingOverview/UnderstandingandPreparingfortheIPv6Transition/UnderstandingandPreparingfortheIPv6Transition.html#//apple_ref/doc/uid/TP40010220-CH213-SW1\n\nI get the following error.\nGot event: error, with items: Optional(<_TtCs21_SwiftDeferredNSArray 0x14fb6ed0>(\nThe operation couldn\u2019t be completed. (NSURLErrorDomain error -1004.)\n)\n. ",
    "iamlogiq": "@nuclearace Thanks for the link but it still doesn't build on my end. Doest it build for you?\n. @nuclearace  actually the swift3 branch isn't really swift3 compatible. Even when you try to convert it to swift3 when you load the xcode project it still doesn't build. Have you actually got it to build on Xcode 8 Beta?\n. @nuclearace Hey, the project does build by itself but when I use it in my project I get alot of Swift Compiler Errors. Have you tried to build it within another project?\n. @nuclearace I actually added the whole content of the source files to my project instead of adding it with a pod file and it is not building due to errors in socketio code. I find it weird that it builds by itself yet has errors when you add it to a project. I just want to confirm you're getting the same errors when you add it to a project?\n. @nuclearace I did upgrade my project and it builds / runs with no error. When I add the source files for socketIO i get error related to NSData and the new Data replacement function. Maybe it's an Xcode 8 bug but for some reason it's not converting NSData to Data and I get a cascade of errors. I'll try to figure out how to solve it or hopefully it goes away with the next XCode 8 beta release. Thanks for the help\n. ",
    "alionthego": "Hi guys.  Did you manage to get it up and running with swift 3?\n. Hi.  Thanks for your reply.  It's working well for me also and I am using SSL.  Just wondering though why I have to select allow arbitrary loads to YES in my info.plist for it to work.  Selecting NO which is my preferred option prevents the connection.\n. i think cert is okay because my app runs fine with allow arbitrary loads set to NO and I'm able to access SSL services.  It's just socketIO that doesn't work when switch to allow arbitrary loads to NO.  I'm pretty new to .js.  This is the top of my index.js file:\nvar app = require('express')();\nvar https = require('https');\nvar fs = require('fs');\nvar options = {\n  key: fs.readFileSync('/example.com.key'),\n  cert: fs.readFileSync('/example.com.crt'),\n  ca: fs.readFileSync('/example_intermediate.crt')\n};\nvar server = https.createServer(options, app);\nSorry for the thread drift...\nAgain if I switch allow arbitrary loads to YES everything works fine.  If it's selected to NO everything except socketIO works fine.  I have not altered socketIO code in any way.\n. hi again.  thanks for your patience.  i'm very new to this.  i have imported the source code untouched.  created my socket class and using the following to connect:\nvar socket: SocketIOClient = SocketIOClient(socketURL: URL(string: \"https://www.mySite.com:3000\")!)\nmy index file includes what i have above and then:\nvar io = require('socket.io')(server);\nserver.listen(3000, function(){\n  console.log('Listening on *:3000');\n});\nio.on('connection', function(socket){\n  console.log('a user connected');\n....\n. I am using Swift 4.0 Xcode 9 and trying to install SocketIO for use in my chat application for iOS devices.\nI tried installing using the Swift Package Manager but the Library is not recognized.  The following is my Package.swift file:\n```\n// swift-tools-version:4.0\n// The swift-tools-version declares the minimum version of Swift required to build this package.\nimport PackageDescription\nlet package = Package(\n    name: \"MyApp\",\n    dependencies: [\n    .package(url: \"https://github.com/socketio/socket.io-client-swift\", .upToNextMajor(from: \"12.0.0\"))\n]\n\n)\n```\nOn command line when I type 'swift build' the packages are fetched but there is an error:\n\"warning: no targets to build in package\"\nWhen I try to import SocketIO in my app I get:\n\"No such module 'SocketIO'\" error.\nSwift 4.0 is installed.\nAfter the build, a .build (greyed out) folder and Package.resolved file are visible in the project root directory.. Sorry, I'm very new to SocketIO and Project Manager.  What is \"Runner\" referring to in your Package.swift file from the link above?  \"socket.io-test\" is your project name.. ",
    "mercury": "Yes it works fine with Swift 3 except if you dont use SSL. Works fine as it should if used it with SSL connection.\n. The JS code you have supplied doesn't say anything about sockets. You are just creating https server in that code. Can you post your code that creates a socket server ?\n. ",
    "rajabpour": "hi,\nI need this for swift 3!\nwhen it possible???. ",
    "axenovV": "Solved : handshake._query.token.\n. ",
    "GitterYang": "2016-06-23 11:46:22.937 WebSocketTest[1596:519919] LOG SocketIOClient: Adding handler for event: connect\n2016-06-23 11:46:22.940 WebSocketTest[1596:519919] LOG SocketIOClient: Adding handler for event: currentAmount\n2016-06-23 11:46:22.940 WebSocketTest[1596:519919] LOG SocketIOClient: Adding engine\n2016-06-23 11:46:22.945 WebSocketTest[1596:519919] LOG SocketEngine: Starting engine. Server: ws://115.29.193.48:8088\n2016-06-23 11:46:22.945 WebSocketTest[1596:519919] LOG SocketEngine: Handshaking\n2016-06-23 11:46:22.949 WebSocketTest[1596:519961] LOG SocketEnginePolling: Doing polling request\n2016-06-23 11:46:23.311 WebSocketTest[1596:519959] ERROR SocketEnginePolling: The network connection was lost.\n2016-06-23 11:46:23.312 WebSocketTest[1596:519959] ERROR SocketEngine: The network connection was lost.\n2016-06-23 11:46:23.313 WebSocketTest[1596:519959] ERROR SocketIOClient: The network connection was lost.\n2016-06-23 11:46:23.315 WebSocketTest[1596:519959] LOG SocketIOClient: Handling event: error with data: (\n    \"The network connection was lost.\"\n)\n. I have pod the latest version.\nwhen I connected socket, I call [socket disconnect], after one minute, it call the error method, show \"The request timed out.\", I want to know which condition can fire this error message? Is it caused by heartbeat? @nuclearace \n. Thank u. ",
    "fvvliet": "We have the same log results\n. [2016-06-28 07:44:12.337] AppDelegate.logProjectSettings():356 CHAT: https://api.twypapp.com/test/chat\n2016-06-28 07:44:19.491 Testing[39187:1496610] LOG SocketIOClient: Adding handler for event: connect\n2016-06-28 07:44:19.491 Testing[39187:1496610] LOG SocketIOClient: Adding handler for event: disconnect\n2016-06-28 07:44:19.491 Testing[39187:1496610] LOG SocketIOClient: Adding handler for event: reconnect\n2016-06-28 07:44:19.491 Testing[39187:1496610] LOG SocketIOClient: Adding handler for event: chat_message\n2016-06-28 07:44:19.491 Testing[39187:1496610] LOG SocketIOClient: Adding handler for event: business_event\n2016-06-28 07:44:19.491 Testing[39187:1496610] LOG SocketIOClient: Adding engine\n2016-06-28 07:44:19.492 Testing[39187:1496610] LOG SocketEngine: Starting engine\n2016-06-28 07:44:19.492 Testing[39187:1496610] LOG SocketEngine: Handshaking\n2016-06-28 07:44:19.492 Testing[39187:1496610] LOG SocketEnginePolling: Doing polling request\n2016-06-28 07:44:20.237 Testing[39187:1496803] ERROR SocketEnginePolling: The network connection was lost.\n2016-06-28 07:44:20.237 Testing[39187:1496803] ERROR SocketEngine: The network connection was lost.\n2016-06-28 07:44:20.238 Testing[39187:1496803] ERROR SocketIOClient: The network connection was lost.\n2016-06-28 07:44:20.238 Testing[39187:1496803] LOG SocketIOClient: Handling event: error with data: (\n    \"The network connection was lost.\"\n)\n2016-06-28 07:44:20.238 Testing[39187:1496803] LOG SocketEngine: Engine is being closed.\n2016-06-28 07:44:20.238 Testing[39187:1496803] LOG SocketEnginePolling: Created POST string: 1:1\nReceived event: error, with items: Optional(<_TtCs21_SwiftDeferredNSArray 0x7fc65a9010d0>(\nThe network connection was lost.\n)\n)\n2016-06-28 07:44:20.239 Testing[39187:1496803] LOG SocketEnginePolling: Doing polling request\n2016-06-28 07:44:20.447 Testing[39187:1496786] LOG SocketIOClient: Starting reconnect\n2016-06-28 07:44:20.447 Testing[39187:1496786] LOG SocketIOClient: Handling event: reconnect with data: (\n    \"The network connection was lost.\"\n)\n. Hello @nuclearace , see below\n```\n    let debugging = true\nlet connectionParams  = [\n    \"reconnectAttempts\" : -1, // infinite retries\n    \"reconnectWait\" : 5,\n    \"reconnects\" : true,\n    \"log\" : debugging\n]\n\nlet url = NSURL(string: Configuration.chatURL)\nself.socket = SocketIOClient(socketURL: url!, options: connectionParams)\n\n```\n. Nope, we sticked to the working older version. And a year ago the project stopped so no update on this issue.... @butterpuf :  The project is more than a year old and the app has been retrieved from the store but what I found in the code is this. Hope it helps...\npod 'Socket.IO-Client-Swift', :git => 'https://github.com/bosmagit/socket.io-client-swift.git', :branch =>'v5.2.3_swift2.3'\n. ",
    "cprovatas": "Same issue here but only when connected to wifi, not using cellular.  Any help would be appreciated\n. ",
    "Komal2905": "Same issue here too\n. ",
    "kinza88": "hello @fvvliet \nDid you find any solution to this?. okay.. thankyou. . hey @vatsalkodinariya did you find any solution? Coz i am facing the same problem. how did you solve this error? \n@nuclearace @mhtranbn @milan-mgu . @milan-mgu hey any solution to this?. @thully hey did you find any solution to your problem?. @nuclearace . Hey I am sorry I got late to respond to your email. \nI have tried that code again. At this very point, the there is no disconnection error. \nBut the handler is not listening the response. \nRequest is sent, response comes back but it doesn't get listened. It gets printed in the logs only. \nHowever i could see this error:\n2017-11-28 17:24:50.448986+0500 TestApiProject[8166:383893] LOG SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2017-11-28 17:24:50.449257+0500 TestApiProject[8166:383893] ERROR SocketEngine: Session ID unknown\nCan you help me regarding this? \nI have gone through other related issues but didn't find any appropriate help. \n. @nuclearace @thully \nHey .. Did you find any solution to this problem?\n. @nuclearace \nI need you to have a look in this issue. \nThanks in advance. . Then what can i do to minimize this error?\nAt this point the socket gets disconnected and while it is taking time in reconnection, the request gets lost. Can you suggest me some way to check the connection status of socket? \nI found that in android we can find using socket.isConnected() or in iOS as socket.status but on using this status:\nprint (socket.status)\n\"SocketIOClientStatus\" gets printed whereas I was expecting it to be \"connected\" or \"not connected\" or something like that. \nI am already using handlers for connected, disconnected state. \nBut I want something to check socket connection status a moment before sending emit request.  Can you suggest me some appropriate solution? . Hey.. did you find any solution to this? \n@odedsh @nuclearace . Hey.. did you get any solution to this problem?\n@nuclearace @bhautikmobileappdev . LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-01-09 14:00:32.683163+0500 Cuufy[306:35607] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-01-09 14:00:32.684144+0500 Cuufy[306:42757] LOG SocketEngine: Writing ws:  has data: false\n2018-01-09 14:00:32.684372+0500 Cuufy[306:42757] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2018-01-09 14:00:34.009715+0500 Cuufy[306:42757] **ERROR** SocketEngine: The operation couldn\u2019t be completed. Socket is not connected\n2018-01-09 14:00:34.010192+0500 Cuufy[306:35607] **ERROR** SocketManager: The operation couldn\u2019t be completed. Socket is not connected\n2018-01-09 14:00:34.010751+0500 Cuufy[306:35607] LOG SocketIOClient{/}: Handling event: error with data: [\"The operation couldn\u2019t be completed. Socket is not connected\"]\n2018-01-09 14:00:34.012332+0500 Cuufy[306:35607] LOG SocketManager: Starting reconnect\n2018-01-09 14:00:34.013333+0500 Cuufy[306:35607] LOG SocketIOClient{/}: Handling event: statusChange with data: [connecting]\n2018-01-09 14:00:34.013748+0500 Cuufy[306:35607] LOG SocketIOClient{/}: Handling event: reconnect with data: [\"The operation couldn\u2019t be completed. Socket is not connected\"]\n2018-01-09 14:00:34.013887+0500 Cuufy[306:35607] LOG SocketManager: Trying to reconnect\n2018-01-09 14:00:34.014341+0500 Cuufy[306:35607] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [-1]\n2018-01-09 14:00:34.016010+0500 Cuufy[306:35607] LOG SocketManager: Adding engine\n2018-01-09 14:00:34.016686+0500 Cuufy[306:35607] LOG SocketEngine: Engine is being released\n2018-01-09 14:00:34.017595+0500 Cuufy[306:42742] LOG SocketEngine: Starting engine. Server: https://URL:5105/\n2018-01-09 14:00:34.017717+0500 Cuufy[306:42742] LOG SocketEngine: Handshaking\n2018-01-09 14:00:34.018133+0500 Cuufy[306:42742] LOG SocketEnginePolling: Doing polling GET https://www.binexsolutions.com:5105/socket.io/?transport=polling&b64=1\n2018-01-09 14:00:36.689597+0500 Cuufy[306:42757] LOG SocketEnginePolling: Got polling response\n2018-01-09 14:00:36.690024+0500 Cuufy[306:42757] LOG SocketEnginePolling: Got poll message: 97:0{\"sid\":\"nfR94Z0JH4inbDU9AAAZ\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2018-01-09 14:00:36.690809+0500 Cuufy[306:42757] LOG SocketEngine: Got message: 0{\"sid\":\"nfR94Z0JH4inbDU9AAAZ\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2018-01-09 14:00:36.696378+0500 Cuufy[306:35607] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-01-09 14:00:36.696861+0500 Cuufy[306:35607] LOG SocketManager: Engine opened Connect\n2018-01-09 14:00:36.697034+0500 Cuufy[306:35607] LOG SocketIOClient{/}: Socket connected\n2018-01-09 14:00:36.697233+0500 Cuufy[306:35607] LOG SocketIOClient{/}: Handling event: statusChange with data: [connected]\n2018-01-09 14:00:36.697458+0500 Cuufy[306:35607] LOG SocketIOClient{/}: Handling event: connect with data: [\"/\"]\n2018-01-09 14:00:36.697600+0500 Cuufy[306:35607] *************** SOCKET CONNECTED\nconnected\n2018-01-09 14:00:36.698156+0500 Cuufy[306:42757] LOG SocketEnginePolling: Doing polling GET https://www.binexsolutions.com:5105/socket.io/?transport=polling&b64=1&sid=nfR94Z0JH4inbDU9AAAZ\n2018-01-09 14:00:36.704386+0500 Cuufy[306:42757] LOG SocketEngine: Writing poll:  has data: false\n2018-01-09 14:00:36.704643+0500 Cuufy[306:42757] LOG SocketEnginePolling: Sending poll:  as type: 2\n2018-01-09 14:00:36.704950+0500 Cuufy[306:42757] LOG SocketEnginePolling: Created POST string: 1:2\n2018-01-09 14:00:36.706386+0500 Cuufy[306:42757] LOG SocketEnginePolling: POSTing\n2018-01-09 14:00:36.710479+0500 Cuufy[306:42757] LOG SocketEnginePolling: Doing polling POST https://www.binexsolutions.com:5105/socket.io/?transport=polling&b64=1&sid=nfR94Z0JH4inbDU9AAAZ\n2018-01-09 14:00:36.711886+0500 Cuufy[306:35607] LOG SocketIOClient{/}: Emitting: 24[\"join\",{\"jwt\":\"******\"}]\n2018-01-09 14:00:36.712754+0500 Cuufy[306:42742] LOG SocketEngine: Writing poll: 24[\"join\",{\"jwt\":\"******\"}] has data: false\n2018-01-09 14:00:36.713540+0500 Cuufy[306:42742] LOG SocketEnginePolling: Sending poll: 24[\"join\",{\"jwt\":\"******\"}] as type: 4\n2018-01-09 14:00:37.293414+0500 Cuufy[306:42883] LOG SocketEnginePolling: Got polling response\n2018-01-09 14:00:37.293722+0500 Cuufy[306:42883] LOG SocketEnginePolling: Got poll message: 2:40\n2018-01-09 14:00:37.294048+0500 Cuufy[306:42883] LOG SocketEngine: Got message: 40\n2018-01-09 14:00:37.294639+0500 Cuufy[306:35607] LOG SocketParser: Parsing 0\n2018-01-09 14:00:37.295230+0500 Cuufy[306:35607] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2018-01-09 14:00:37.295837+0500 Cuufy[306:42883] LOG SocketEnginePolling: Doing polling GET https://URL:5105/socket.io/?transport=polling&b64=1&sid=nfR94Z0JH4inbDU9AAAZ\n2018-01-09 14:00:38.694690+0500 Cuufy[306:42888] LOG SocketEnginePolling: Created POST string: 282:424[\"join\",{\"jwt\":\"******\"}]\n2018-01-09 14:00:38.696074+0500 Cuufy[306:42888] LOG SocketEnginePolling: POSTing\n2018-01-09 14:00:38.696693+0500 Cuufy[306:42888] LOG SocketEnginePolling: Doing polling POST https://www.binexsolutions.com:5105/socket.io/?transport=polling&b64=1&sid=nfR94Z0JH4inbDU9AAAZ\n2018-01-09 14:00:38.698497+0500 Cuufy[306:42888] LOG SocketEnginePolling: Got polling response\n2018-01-09 14:00:38.698741+0500 Cuufy[306:42888] LOG SocketEnginePolling: Got poll message: 1:3\n2018-01-09 14:00:38.699252+0500 Cuufy[306:42888] LOG SocketEngine: Got message: 3\n2018-01-09 14:00:38.699658+0500 Cuufy[306:35607] LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-01-09 14:00:38.700512+0500 Cuufy[306:42888] LOG SocketEnginePolling: Doing polling GET https://www.binexsolutions.com:5105/socket.io/?transport=polling&b64=1&sid=nfR94Z0JH4inbDU9AAAZ\n2018-01-09 14:00:38.966968+0500 Cuufy[306:42816] LOG SocketEngineWebSocket: Sending ws: probe as type: 2\n2018-01-09 14:00:39.009808+0500 Cuufy[306:42888] LOG SocketEnginePolling: Got polling response\n2018-01-09 14:00:39.010326+0500 Cuufy[306:42888] LOG SocketEnginePolling: Got poll message: 64:434[{\"message\":\"Joined Successfully\",\"code\":200,\"success\":true}]\n2018-01-09 14:00:39.011089+0500 Cuufy[306:42888] LOG SocketEngine: Got message: 434[{\"message\":\"Joined Successfully\",\"code\":200,\"success\":true}]\n2018-01-09 14:00:39.012114+0500 Cuufy[306:35607] LOG SocketParser: Parsing 34[{\"message\":\"Joined Successfully\",\"code\":200,\"success\":true}]\n2018-01-09 14:00:39.013086+0500 Cuufy[306:35607] LOG SocketParser: Decoded packet as: SocketPacket {type: 3; data: [{\n    code = 200;\n    message = \"Joined Successfully\";\n    success = 1;\n}]; id: 4; placeholders: -1; nsp: /}\n2018-01-09 14:00:39.013219+0500 Cuufy[306:42888] LOG SocketEnginePolling: Doing polling GET https://www.binexsolutions.com:5105/socket.io/?transport=polling&b64=1&sid=nfR94Z0JH4inbDU9AAAZ\n2018-01-09 14:00:39.013463+0500 Cuufy[306:35607] LOG SocketIOClient{/}: Handling ack: 4 with data: [{\n    code = 200;\n    message = \"Joined Successfully\";\n    success = 1;\n}]\n2018-01-09 14:08:21.965744+0500 Cuufy[306:35607] LOG OnAckCallback: OnAckCallback for 4 being released\n2018-01-09 14:08:21.967943+0500 Cuufy[306:35607] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-01-09 14:08:21.972928+0500 Cuufy[306:42757] LOG SocketEngine: Got message: 3probe\n2018-01-09 14:08:21.973552+0500 Cuufy[306:42757] LOG SocketEngine: Received probe response, should upgrade to WebSockets\n2018-01-09 14:08:21.973725+0500 Cuufy[306:42757] LOG SocketEngine: Upgrading transport to WebSockets\n2018-01-09 14:08:21.974067+0500 Cuufy[306:42757] LOG SocketEnginePolling: Sending poll:  as type: 6\n2018-01-09 14:08:21.974350+0500 Cuufy[306:42757] LOG SocketEnginePolling: Created POST string: 1:6\n2018-01-09 14:08:21.975033+0500 Cuufy[306:42757] LOG SocketEnginePolling: POSTing\n2018-01-09 14:08:21.975423+0500 Cuufy[306:35607] LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-01-09 14:08:21.977430+0500 Cuufy[306:42757] LOG SocketEngine: Flushing probe wait\n2018-01-09 14:08:21.990905+0500 Cuufy[306:42757] LOG SocketEngine: Writing poll:  has data: false\n2018-01-09 14:08:21.991113+0500 Cuufy[306:42757] LOG SocketEnginePolling: Sending poll:  as type: 2\n2018-01-09 14:08:23.213012+0500 Cuufy[306:42883] LOG SocketEnginePolling: Got polling response\n2018-01-09 14:08:23.213370+0500 Cuufy[306:42883] LOG SocketEnginePolling: Got poll message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2018-01-09 14:08:23.214575+0500 Cuufy[306:42883] LOG SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\n2018-01-09 14:08:23.215156+0500 Cuufy[306:42883] **ERROR** SocketEngine: Session ID unknown\n2018-01-09 14:08:23.215468+0500 Cuufy[306:35607] **ERROR** SocketManager: Session ID unknown\n2018-01-09 14:08:23.215768+0500 Cuufy[306:35607] LOG SocketIOClient{/}: Handling event: error with data: [\"Session ID unknown\"]\n2018-01-09 14:08:23.216178+0500 Cuufy[306:42883] LOG SocketEngine: Switching to WebSockets\n@nuclearace  This the way how i get it. It is clear from the logs that the socket was connected. Then for some reasons it got disconnected. After that it tried to reconnect and it and did it. But then it encountered the error \"Session Id unknown\"\nCan you suggest some appropriate solution? \nP.s Socket.io version is 13.1.0\n. @nuclearace \nNo there is no load balancing. There is only one server.\nAlthough I am calling socket.disconnect() when the app goes in background and then calling socket.connect()when app comes in foreground. @nuclearace any updates?. @nuclearace I need your help. Thankyou. . ",
    "butterpuf": "@fvvliet Can you tell the older version that does not have this issue?. ok thankyou. @DaVincii Hi, Can you guid how we can simulate \"Session ID unknown\" error. That, the app create session with a node but request to some other node. Because I am facing this error a lot. But unable to find what I am doing wrong. Any test case that can help me?. ",
    "AkAyush": "Hi Socket team,\nI am also facing the same issue , can you guys please suggest a solution.. ",
    "dzagey": "I have this same problem, is there any solution?\n. ",
    "jimmychaohc": "I just tested 6.1.4 and it is working. Thanks!!\n. ",
    "nhebling": "After a few hours try and error, I removed socket.io and now I'm just using plain websockets. I had to do this radical step as I could not invest more time and the socket connection is an essential part of the app.\nMaybe I will give it a try in a few month, but as of now socket.io not used by me anymore.\n. ",
    "NickWarrior": "Can you give me some advice\n.   [self.client on:@\"new_message\" callback:^(NSArray * _Nonnull data, SocketAckEmitter * _Nonnull ack) {}];\nwhy this fuction not be invoke\n. Problem is solved, beacuse fuction invoke corretly\n. ",
    "i-am-chris": "how do you join a \"room\" in obj-c\n. yes. i have this on server side:\n`io.sockets.on('connection', function (socket) {\n```\n// when the client emits 'adduser', this listens and executes\nsocket.on('adduser', function(username){\n    // store the username in the socket session for this client\n    socket.username = username;\nconsole.log(username);\n    // store the room name in the socket session for this client\n    socket.room = 'room1';\n    // add the client's username to the global list\n    usernames[username] = username;\n    // send client to room 1\n    socket.join('room1');\n    // echo to client they've connected\n    socket.emit('updatechat', 'poppins', 'you have connected to '+socket.room);\n    // echo to room 1 that a person has connected to their room\n    socket.broadcast.to('room1').emit('updatechat', 'poppins', username + ' has connected to this room');\n    socket.emit('updaterooms', rooms, 'room1');\n});\n// when the client emits 'sendchat', this listens and executes\nsocket.on('sendchat', function (data) {\n    // we tell the client to execute 'updatechat' with 2 parameters\n    io.sockets.in(socket.room).emit('updatechat', socket.username, data);\nconsole.log(socket.username + ' say: '+data);\n});\n```\n});`\nHow do i listen on \"room1\" and emit to that room (broadcast) ?\n. ",
    "giacgbj": "let jsonStr = [this is the JSON as a String]\nand this is the JSON I send with emitWithAck:\nlet jsonToSend = try! NSJSONSerialization.JSONObjectWithData(jsonStr.dataUsingEncoding(NSUTF8StringEncoding)!, options: .AllowFragments)\n. No, I cannot send it as a string.\nWhat's strange is that without TLS it works properly. \nCould it be due to the fact that when I use Secure(true) I can't use ForceWebsockets(true)?\n. If I enable it, I can't even connect to the server. \nThe logs are:\nLOG SocketEngine: Starting engine. Server: https://[OMISSIS]\nLOG SocketEngine: Handshaking\nCFNetwork SSLHandshake failed (-9807)\nERROR SocketEngine: The operation couldn\u2019t be completed. (OSStatus error -9807.)\nERROR SocketIOClient: The operation couldn\u2019t be completed. (OSStatus error -9807.)\nLOG SocketIOClient: Handling event: error with data: (\n    \"The operation couldn\\U2019t be completed. (OSStatus error -9807.)\"\n)\nLOG SocketIOClient: Starting reconnect\nLOG SocketIOClient: Handling event: reconnect with data: (\n    \"The operation couldn\\U2019t be completed. (OSStatus error -9807.)\"\n)\nLOG SocketIOClient: Trying to reconnect\nLOG SocketIOClient: Handling event: reconnectAttempt with data: (\n    \"-1\"\n)\nLOG SocketEngine: Starting engine. Server: https://[OMISSIS]\nLOG SocketEngine: Handshaking\nCFNetwork SSLHandshake failed (-9807)\nERROR SocketEngine: The operation couldn\u2019t be completed. (OSStatus error -9807.)\nERROR SocketIOClient: The operation couldn\u2019t be completed. (OSStatus error -9807.)\nLOG SocketIOClient: Handling event: error with data: (\n    \"The operation couldn\\U2019t be completed. (OSStatus error -9807.)\"\n)\nThe error \"OSStatus -9807\" seems to be related to the fact that I'm using a self-signed certificate, so I added an handler which accepts such a certificate using \"SocketIOClientOption.SessionDelegate\". Unfortunately, the connection only works if I don't set ForceWebsockets(true).\n. Unfortunately, I didn't use it because of \"Don't do this, iOS will yell at you\" :D\nWhat did you really mean?\n.SelfSigned option solves both the connect and the base64 problems.\nObviously, I won't use a self-signed certificate in production environments, but I was obliged to use it during the developing phase.\nIf you think that the behaviors I had using the options in such ways are normal, I'll close this issue.\n. It worked: I tested it before using SSL.\n. I thought you meant neither using SSL nor forcePolling. \nTo be clear, without using SSL:\nForceWebsockets(false)\nForcePolling(false)\nOK\n\nForceWebsockets(false)\nForcePolling(true)\nKO (plus signs replaced by spaces in base64)\n\nForceWebsocket(true)\nForcePolling(false)\nOK\n\nForceWebsocket(true)\nForcePolling(true)\nOK\n. ",
    "stevenlfg": "is this problem same to this one?https://github.com/socketio/socket.io-client-swift/issues/406\nThank you!\n. What do you think is the main reason for the problem\uff1fThank you very much!\n. I find that struct SocketAck did not  implement the protocol Comparable.Is this reason?\n\n. @nuclearace Can you tell me a solution to avoid this problem\uff1fThank you !\n. Because the problem of this crash is the occasional,I've changed some in this file. This can avoid the problem?\n\n. @nuclearace ok,thank you very much!\n. ",
    "iosnatarajan": "@nuclearace May I know the way to that Swift 3 branch?\nThanks!\n. @nuclearace, Server version is 1.4.5.\nThanks!. ",
    "serieuxchat": "Thanks very much for the quick reply! We are currently just using Starscream plain web sockets, but being able to use socket.io would be just awesome! For now I am, indeed, planning to just fork and change the code (probably by just removing the final requirement). But being able to use a web socket subclass without modifying the code would be great (if it's done in a future release). Have a great day!\n. ",
    "hdoom": "Prepend @nonobjc to the field and the method on lines 58 and 244 in SSLSecurity.swift.\nSeems to be a bug in Swift (https://forums.developer.apple.com/message/47692#47692).\n. That's exactly how it works for me. Did you try Project - Clean and purging your DerivedData folder before rebuilding? (I'm using Xcode 7.3.1 / Swift 2.2.1 btw)\n. ",
    "ghost": "I fixed it. The new code is below (advised by @hdoom )\n@nonobjc var pubKeys: [SecKeyRef]?\n@nonobjc func publicKeyChainForTrust(trust: SecTrustRef) -> [SecKeyRef] {\nBut it doesn't work...\n\nSocketIOClientSwift-Swift.h:144:37: Type argument 'SecKeyRef' (aka 'struct __SecKey *') is neither an Objective-C object nor a block type\n\n'Socket.IO-Client-Swift', '~> 6.1.5'\n. Thanks @hdoom !\n. Xcode version 7.3.1 and what's client?\nIf you ask me about build version -> I build in iOS 8.0\nSocket.IO-Client version 8.0.0\n. really?\nOK, I am going to try.\n. and if I use socket.io-client 7.0.3 but still have this problem.\nHow I fix this problem?\n. Got it, thanks :). This worker for me.\nhttps://stackoverflow.com/questions/49578686/my-ajax-request-stopped-working-properly-on-ios-11-3. in form <input id=\"multiFilesAdjuntos\" name=\"filesAdjuntos[]\" multiple=\"\" type=\"file\" class=\"btn btn-xs btn-default\" data-buttonText=\"Find file\">\njust after the submit\n` $('body').on( \"submit\",my_form_id, function (event) {\n            event.preventDefault();\n\n            if(!$('#multiFilesAdjuntos').val()){\n             $('#multiFilesAdjuntos').attr('disabled', true);\n              }`.\n",
    "Dwar3xwar": "Any updates on this issue? \n. Any update on this?. ",
    "QaiserAbbas": "hi, any update or pull is merged or not ? Its long time now on this Issue . any update on this issue ?\n. so we do not have any option to bypass proxy ?\nOn Thu, Sep 28, 2017 at 4:29 PM, Erik Little notifications@github.com\nwrote:\n\nClosed #819\nhttps://github.com/socketio/socket.io-client-swift/issues/819.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/819#event-1269586013,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ATlg1lkU9GR8ZP3DgWSFuXVN7GO4iWf8ks5sm4MhgaJpZM4PnHoD\n.\n. \n",
    "jlgl10nes": "Any updates on this issue? I see it \"on hold\"\nFor a scalable use of socket.io it's almost a mandatory enhancement to use a load balancer (proxy), the alternatives are painful.. ",
    "aputinski": "It's just a warning, but the app will get rejected from the AppStore\n. @nuclearace any thoughts on merging this?\n. This was the only actual error. Does this seem correct? Data.Base64EncodingOptions => Data.Base64DecodingOptions\n. ",
    "alexanderkhitev": "@nuclearace It's the STOMP Websocket\n. ",
    "magicdawn": "so /realtime/ws/ works. the trailing slash matters\n. ",
    "klaasscho1": "I don't know exactly, all the socket.io stuff is configured by Xcode Server automatically and I can't access the settings easily since it's all pretty hidden.\n. I tried pointing it to multiple paths.\n[server]/xcode/internal/socket.io returns Welcome to socket.io.\n[server]/xcode/internal/socket.io/1/ returns NgzsfCXGGUeiHsTg7j90:60:60:xhr-polling,jsonp-polling (or something similar)\nAnd server/xcode/internal/socket.io/socket.io.js returns the contents of the JS library.\nI tried using all of them but all of them return them return Got unknown error from server [contents of file]\n. How can I check if the server is running socket.io? I'm pretty sure, but maybe it isn't.\nI tried adding the / to the end, but it's still giving the same error.\n. Xcode Server uses it internally to communicate changes with the overview webpage you can run on it. I'm not 100% sure how they start it but I'm pretty certain it is started somehow because I've taken a look in their JavaScript and they use socket.io functions for a lot of things.\n. Alright, that's fair. One last question though; what exact file should the path point to? Like, what should I see in the browser when I navigate to it? Is it the one with the SOmjlPS9nHRsklVqCIN-:60:60:xhr-polling,jsonp-polling or is it the one that says Welcome to socket.io.?\n. ",
    "jingweili911": "My projects have achieved mixed oc and swift, and just add socket.io-client-swift inside the Source file will be given Type argument 'SecKeyRef' (aka 'struct __SecKey *') is neither an Objective-C object nor a block type, it is not what is missing library file, or in what setting did not do Xcode.\npod 'Socket.IO-Client-Swift', '~> 6.1.4'\n. ",
    "Hunter-Nomad": "\nDoesn't the swift package manager require swift 3?\n\nI do not know whether there are swift 2 of a package manager, and because of the fastened from version 3\n\nBut it might have something to do with the websocket subdirectory. I'm having trouble getting the swiftpm to work for me.\n\nOk)) Understand. If you can figure out how to fix it will be very grateful. It is now vitally important task for me.))) I need to send and read data by swift socket.\nThank you very much!!\n. Try, now\n. Sorry, it's not work\n\nbash-3.2$ swift build\nCloning https://github.com/socketio/socket.io-client-swift\nHEAD is now at f15a6dc bump version\nResolved version: 6.1.5\nCompile Swift Module 'SocketIOClientSwift' (23 sources)\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketPacket.swift:195:54: error: 'inout' before a parameter name is not allowed, place it before the parameter type instead\n    static func shred(data: AnyObject, inout binary: [NSData]) -> AnyObject {\n                                       ~~~~~~        ^\n                                                     inout \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketAckEmitter.swift:39:23: error: missing argument label 'ack:' in call\n        socket.emitAck(ackNum, withItems: items)\n                      ^\n                       ack: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketAckEmitter.swift:45:23: error: missing argument label 'ack:' in call\n        socket.emitAck(ackNum, withItems: items)\n                      ^\n                       ack: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketPacket.swift:195:54: error: 'inout' before a parameter name is not allowed, place it before the parameter type instead\n    static func shred(data: AnyObject, inout binary: [NSData]) -> AnyObject {\n                                       ~~~~~~        ^\n                                                     inout \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketPacket.swift:195:54: error: 'inout' before a parameter name is not allowed, place it before the parameter type instead\n    static func shred(data: AnyObject, inout binary: [NSData]) -> AnyObject {\n                                       ~~~~~~        ^\n                                                     inout \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketPacket.swift:195:54: error: 'inout' before a parameter name is not allowed, place it before the parameter type instead\n    static func shred(data: AnyObject, inout binary: [NSData]) -> AnyObject {\n                                       ~~~~~~        ^\n                                                     inout \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketPacket.swift:195:54: error: 'inout' before a parameter name is not allowed, place it before the parameter type instead\n    static func shred(data: AnyObject, inout binary: [NSData]) -> AnyObject {\n                                       ~~~~~~        ^\n                                                     inout \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketPacket.swift:195:54: error: 'inout' before a parameter name is not allowed, place it before the parameter type instead\n    static func shred(data: AnyObject, inout binary: [NSData]) -> AnyObject {\n                                       ~~~~~~        ^\n                                                     inout \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketClientManager.swift:66:24: error: 'removeValueForKey' has been renamed to 'removeValue(forKey:)'\n        return sockets.removeValueForKey(label)\n                       ^~~~~~~~~~~~~~~~~\n                       removeValue       forKey: \nSwift.Dictionary:7:26: note: 'removeValueForKey' has been explicitly marked unavailable here\n    public mutating func removeValueForKey( key: Key) -> Value?\n                         ^\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketClientManager.swift:73:36: error: 'removeValueForKey' has been renamed to 'removeValue(forKey:)'\n            returnSocket = sockets.removeValueForKey(label)\n                                   ^~~~~~~~~~~~~~~~~\n                                   removeValue       forKey: \nSwift.Dictionary:7:26: note: 'removeValueForKey' has been explicitly marked unavailable here\n    public mutating func removeValueForKey( key: Key) -> Value?\n                         ^\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketPacket.swift:195:54: error: 'inout' before a parameter name is not allowed, place it before the parameter type instead\n    static func shred(data: AnyObject, inout binary: [NSData]) -> AnyObject {\n                                       ~~~~~~        ^\n                                                     inout \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:128:39: error: cannot call value of non-function type 'Bool'\n        DefaultSocketLogger.Logger.log(\"Engine is being released\", type: logType)\n        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:144:22: error: missing argument label 'error:' in call\n            didError(error)\n                     ^\n                     error: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:146:36: error: missing argument label 'reason:' in call\n            client?.engineDidError(\"Got unknown error from server (msg)\")\n                                   ^\n                                   reason: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:153:66: error: missing argument label 'n:' in call\n            let noPrefix = message[message.startIndex.advancedBy(2)..:0: note: 'init(URL:)' has been explicitly marked unavailable here\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:198:40: error: 'requestHeaderFieldsWithCookies' has been renamed to 'requestHeaderFields(with:)'\n            let headers = NSHTTPCookie.requestHeaderFieldsWithCookies(cookies!)\n                                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n                                       requestHeaderFields            with: \n:0: note: 'requestHeaderFieldsWithCookies' has been explicitly marked unavailable here\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:208:24: error: value of optional type 'dispatch_queue_t?' not unwrapped; did you mean to use '!' or '?'?\n        dispatch_async(emitQueue) {\n                       ^\n                                !\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:245:28: error: 'URL' has been renamed to 'url'\n        return (urlPolling.URL!, urlWebSocket.URL!)\n                           ^~~\n                           url\n:0: note: 'URL' has been explicitly marked unavailable here\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:245:47: error: 'URL' has been renamed to 'url'\n        return (urlPolling.URL!, urlWebSocket.URL!)\n                                              ^~~\n                                              url\n:0: note: 'URL' has been explicitly marked unavailable here\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:252:40: error: 'requestHeaderFieldsWithCookies' has been renamed to 'requestHeaderFields(with:)'\n            let headers = NSHTTPCookie.requestHeaderFieldsWithCookies(cookies!)\n                                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n                                       requestHeaderFields            with: \n:0: note: 'requestHeaderFieldsWithCookies' has been explicitly marked unavailable here\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:274:41: error: missing argument label 'message:' in call\n        DefaultSocketLogger.Logger.error(\"%@\", type: logType, args: error)\n                                        ^\n                                         message: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:275:32: error: missing argument label 'reason:' in call\n        client?.engineDidError(error)\n                               ^\n                               reason: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:276:20: error: missing argument label 'reason:' in call\n        disconnect(error)\n                   ^\n                   reason: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:280:54: error: missing argument label 'reason:' in call\n        guard connected else { return closeOutEngine(reason) }\n                                                     ^\n                                                     reason: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:282:39: error: cannot call value of non-function type 'Bool'\n        DefaultSocketLogger.Logger.log(\"Engine is being closed.\", type: logType)\n        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:285:35: error: missing argument label 'reason:' in call\n            return closeOutEngine(reason)\n                                  ^\n                                  reason: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:289:33: error: missing argument label 'str:' in call\n            sendWebSocketMessage(\"\", withType: .Close, withData: [])\n                                ^\n                                 str: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:290:28: error: missing argument label 'reason:' in call\n            closeOutEngine(reason)\n                           ^\n                           reason: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:292:31: error: missing argument label 'reason:' in call\n            disconnectPolling(reason)\n                              ^\n                              reason: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:299:23: error: value of optional type 'dispatch_queue_t?' not unwrapped; did you mean to use '!' or '?'?\n        dispatch_sync(emitQueue) {\n                      ^\n                               !\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:309:45: error: missing argument label 'message:' in call\n            DefaultSocketLogger.Logger.error(\"Outstanding poll when switched to WebSockets,\" +\n                                            ^\n                                             message: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:313:29: error: missing argument label 'str:' in call\n        sendWebSocketMessage(\"\", withType: .Upgrade, withData: [])\n                            ^\n                             str: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:322:39: error: cannot call value of non-function type 'Bool'\n        DefaultSocketLogger.Logger.log(\"Flushing probe wait\", type: logType)\n        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:324:24: error: value of optional type 'dispatch_queue_t?' not unwrapped; did you mean to use '!' or '?'?\n        dispatch_async(emitQueue) {\n                       ^\n                                !\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:343:28: error: missing argument label 'str:' in call\n            ws.writeString(msg)\n                           ^\n                           str: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:346:27: error: incorrect argument label in call (have 'keepCapacity:', expected 'keepingCapacity:')\n        postWait.removeAll(keepCapacity: true)\n                          ^~~~~~~~~~~~~\n                           keepingCapacity\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:350:32: error: missing argument label 'reason:' in call\n        client?.engineDidClose(reason)\n                               ^\n                               reason: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:354:36: error: missing argument label 'msg:' in call\n        client?.parseEngineMessage(message)\n                                   ^\n                                   msg: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:392:39: error: missing argument label 'reason:' in call\n                client?.engineDidOpen(\"Connect\")\n                                      ^\n                                      reason: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:395:22: error: missing argument label 'error:' in call\n            didError(\"Error parsing open packet\")\n                     ^\n                     error: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:409:39: error: cannot call value of non-function type 'Bool'\n        DefaultSocketLogger.Logger.log(\"Got binary data: %@\", type: \"SocketEngine\", args: data)\n        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:410:39: error: missing argument label 'data:' in call\n        client?.parseEngineBinaryData(data.subdataWithRange(NSMakeRange(1, data.length - 1)))\n                                      ^\n                                      data: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:414:39: error: cannot call value of non-function type 'Bool'\n        DefaultSocketLogger.Logger.log(\"Got message: %@\", type: logType, args: message)\n        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:420:46: error: missing argument label 'message:' in call\n            if !checkIfMessageIsBase64Binary(message) {\n                                             ^\n                                             message: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:421:43: error: missing argument label 'msg:' in call\n                checkAndHandleEngineError(message)\n                                          ^\n                                          msg: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:428:41: error: missing argument label 'string:' in call\n            fixedString = fixDoubleUTF8(message)\n                                        ^\n                                        string: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:435:27: error: missing argument label 'message:' in call\n            handleMessage(fixedString[fixedString.startIndex.successor()..:0: note: 'defaultSessionConfiguration()' has been explicitly marked unavailable here\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:473:36: error: missing argument label 'reason:' in call\n            client?.engineDidClose(\"Ping timeout\")\n                                   ^\n                                   reason: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:479:18: error: missing argument label 'msg:' in call\n            write(\"\", withType: .Ping, withData: [])\n                 ^\n                  msg: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:491:43: error: cannot call value of non-function type 'Bool'\n            DefaultSocketLogger.Logger.log(\"Upgrading transport to WebSockets\", type: logType)\n            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:494:28: error: missing argument label 'message:' in call\n            sendPollMessage(\"\", withType: .Noop, withData: [])\n                           ^\n                            message: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:501:24: error: value of optional type 'dispatch_queue_t?' not unwrapped; did you mean to use '!' or '?'?\n        dispatch_async(emitQueue) {\n                       ^\n                                !\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:534:36: error: missing argument label 'reason:' in call\n            client?.engineDidClose(\"Disconnect\")\n                                   ^\n                                   reason: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:543:26: error: missing argument label 'error:' in call\n                didError(reason)\n                         ^\n                         error: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEngine.swift:545:40: error: missing argument label 'reason:' in call\n                client?.engineDidClose(\"Socket Disconnected\")\n                                       ^\n                                       reason: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketPacket.swift:195:54: error: 'inout' before a parameter name is not allowed, place it before the parameter type instead\n    static func shred(data: AnyObject, inout binary: [NSData]) -> AnyObject {\n                                       ~~~~~~        ^\n                                                     inout \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:50:40: error: 'requestHeaderFieldsWithCookies' has been renamed to 'requestHeaderFields(with:)'\n            let headers = NSHTTPCookie.requestHeaderFieldsWithCookies(cookies!)\n                                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n                                       requestHeaderFields            with: \n:0: note: 'requestHeaderFieldsWithCookies' has been explicitly marked unavailable here\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:72:39: error: cannot call value of non-function type 'Bool'\n        DefaultSocketLogger.Logger.log(\"Created POST string: %@\", type: \"SocketEnginePolling\", args: postStr)\n        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:74:19: error: 'init(URL:)' has been renamed to 'init(url:)'\n        let req = NSMutableURLRequest(URL: urlPollingWithSid)\n                  ^\n:0: note: 'init(URL:)' has been explicitly marked unavailable here\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:75:32: error: 'dataUsingEncoding(:allowLossyConversion:)' has been renamed to 'data(usingEncoding:allowLossyConversion:)'\n        let postData = postStr.dataUsingEncoding(NSUTF8StringEncoding, allowLossyConversion: false)!\n                               ^~~~~~~~~~~~~~~~~\n                               data\nFoundation.String:21:17: note: 'dataUsingEncoding(:allowLossyConversion:)' has been explicitly marked unavailable here\n    public func dataUsingEncoding( encoding: NSStringEncoding, allowLossyConversion: Bool = default) -> NSData?\n                ^\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:77:20: error: missing argument label 'req:' in call\n        addHeaders(req)\n                   ^\n                   req: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:79:13: error: 'HTTPMethod' has been renamed to 'httpMethod'\n        req.HTTPMethod = \"POST\"\n            ^~~~~~~~~~\n            httpMethod\n:0: note: 'HTTPMethod' has been explicitly marked unavailable here\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:81:13: error: 'HTTPBody' has been renamed to 'httpBody'\n        req.HTTPBody = postData\n            ^~~~~~~~\n            httpBody\n:0: note: 'HTTPBody' has been explicitly marked unavailable here\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:92:19: error: 'init(URL:)' has been renamed to 'init(url:)'\n        let req = NSMutableURLRequest(URL: urlPollingWithSid)\n                  ^\n:0: note: 'init(URL:)' has been explicitly marked unavailable here\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:94:20: error: missing argument label 'req:' in call\n        addHeaders(req)\n                   ^\n                   req: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:95:20: error: missing argument label 'req:' in call\n        doLongPoll(req)\n                   ^\n                   req: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:100:45: error: missing argument label 'message:' in call\n            DefaultSocketLogger.Logger.error(\"Tried to do polling request when not supposed to\", type: \"SocketEnginePolling\")\n                                            ^\n                                             message: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:104:39: error: cannot call value of non-function type 'Bool'\n        DefaultSocketLogger.Logger.log(\"Doing polling request\", type: \"SocketEnginePolling\")\n        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:106:18: error: 'dataTaskWithRequest(:completionHandler:)' has been renamed to 'dataTask(with:completionHandler:)'\n        session?.dataTaskWithRequest(req, completionHandler: callback).resume()\n                 ^~~~~~~~~~~~~~~~~~~\n                 dataTask            with: \n:0: note: 'dataTaskWithRequest(_:completionHandler:)' has been explicitly marked unavailable here\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:110:18: error: missing argument label 'req:' in call\n        doRequest(req) {[weak self] data, res, err in\n                 ^\n                  req: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:153:39: error: cannot call value of non-function type 'Bool'\n        DefaultSocketLogger.Logger.log(\"POSTing\", type: \"SocketEnginePolling\")\n        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:155:18: error: missing argument label 'req:' in call\n        doRequest(req) {[weak self] data, res, err in\n                 ^\n                  req: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:185:60: error: missing argument label 'string:' in call\n            if let n = Int(reader.readUntilStringOccurence(\":\")) {\n                                                           ^\n                                                           string: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:193:44: error: missing argument label 'message:' in call\n                    self.parseEngineMessage(str, fromPolling: true)\n                                           ^\n                                            message: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:203:39: error: cannot call value of non-function type 'Bool'\n        DefaultSocketLogger.Logger.log(\"Sending poll: %@ as type: %@\", type: \"SocketEnginePolling\", args: message, type.rawValue)\n        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:207:44: error: cannot call value of non-function type 'Bool'\n            fixedMessage = doubleEncodeUTF8(message)\n                           ~~~~~~~~~~~~~~~~^\n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:215:63: error: missing argument label 'data:' in call\n            if case let .Right(bin) = createBinaryDataForSend(data) {\n                                                              ^\n                                                              data: \n/Users/User/Projects/swift/socketOS5/socketOS5/Packages/SocketIOClientSwift-6.1.5/Source/SocketEnginePollable.swift:62:35: error: incorrect argument label in call (have 'keepCapacity:', expected 'keepingCapacity:')\n        defer { postWait.removeAll(keepCapacity: true) }\n                                  ^~~~~~~~~~~~~\n                                   keepingCapacity\n:0: error: build had 1 command failures\nerror: exit(1): /Library/Developer/Toolchains/swift-DEVELOPMENT-SNAPSHOT-2016-06-06-a.xctoolchain/usr/bin/swift-build-tool -f /Users/User/Projects/swift/socketOS5/socketOS5/.build/debug.yaml\n\n:( \nI think it's not so easy to solve\n. Understand. Thank you for your attempt)\nTell me how to connect your library without using Swift Package Manager or CocoaPods\n. ",
    "ChinaArJun": "@nuclearace Is the latest version\n. Thank you very much for your reminder, I am mistaken, the company is currently using the old version, I found the answer in the new version, in the\nCloseConnection func () {\nSocket.disconnect ()\n/ / Add new means\nSocket.didConnect ()\n}\nThank you\n. yes\n. ",
    "valtambok": "I see. Thank you @nuclearace \n. ",
    "jimmyzzzzzzz": "I finally got it to work. So, unlike other pod packages, this one requires you to set code sign and provision manually in build setting. I set it as same as my main project's settings and it worked.\n. ",
    "parasdaff": "I have tried using swift3 branch but still facing issues.\n\n. @nuclearace  i am using the same branch, here is the pod i am using to pull from branch swift3\npod 'Socket.IO-Client-Swift',:git =>'https://github.com/socketio/socket.io-client-swift', :branch => 'swift3'\n. ",
    "jamescahall": "I'm getting 33 errors and 4 warnings myself and can't compile using the .swift files directly (no cocoa pods).\n\n\n. Yes\n. Issue compiling in beta 6\n. When do you expect to have the compilation issues for Beta 6 resolved?  We'd like to start prepping for iOS 10 release.\n. Any update?  We'd like to be able to prep for the next iOS release and have had to remove this library until it's fixed.\n. Developers need to submit apps before public versions are out.  The GM is basically the public version.\n. ",
    "Pourias": "I have the same problem here.. (I'm using SWIFT3 branch Xcode8 IOS10) but keep getting all the errors which I think is Swift3 related.  Loosk like its around error handling\n\n. ",
    "minoue10": "Sooo Xcode 8 GM is out today \ud83d\ude2c  When can we expect this to be fixed and merged? I'd prefer not having to refer to a branch for this anymore.\n. @nuclearace  from https://developer.apple.com/swift/blog/?id=36\n\nSwift 3 is the primary development language supported within Xcode 8\n. @nuclearace The GM for Xcode 8 was released yesterday: https://developer.apple.com/xcode/\nJust wondering when we can expect a new version :) Love your library, I'd just like to be able to test my app on Xcode 8 and on iOS 10 simulators as soon as possible, since iOS 10 will be released to the public next Tuesday (9/13).\n. @nuclearace what do you mean by \nwhen Xcode 8 is released proper.\n\n?\nXcode 8 is already out on the Mac App Store, so that's as proper as it's going to get, I think.\nAlso, Xcode 7 isn't compatible with iOS 10 devices (and iOS10 was released today), so I'd really like to move to Xcode 8 as soon as possible.\n. ",
    "williamgp": "Not compiling in Xcode 8 GM- getting a few of these errors:\nPassing non-escaping parameter 'callback' to function expecting an @escaping closure\n. At what point will the Swift 3 branch become the Master?\n. ",
    "Lukafin": "I also can't build my project with SocketIO in Xcode 8 GM.\n. Now i tried with development branch, all the errors are gone, but now i get a new one:\n\"No such module SocketIOClientSwift\" when calling \"import SocketIOClientSwift\" in my class.\nI am using cocoapods version 1.0.0 (also tried with 1.1.0 RC1)\n. Swift 3 branch doesn't exist anymore.\n. Have you pushed your latest changes to dev. branch yet?\n. I tried with the latest code and i get \"module file was created by an older version of the compiler, rebuild and try again\".  So the error \"No such module SocketIOClientSwift\" is gone but i have a new one. Any idea?\n. Xcode 8 (final). \nI tried now with  CocoaPods 1.1.0rc2 and it works.\nAnd yes, i agree with you and cant wait until swift package manager is included in Xcode.\n. ",
    "clOudbb": "Plz tell me , Should I use which branch in xcode 8 release version? thxxxx\ud83d\ude01\n. ",
    "harry1064": "I have update the SocketIOClientSwift to 8.0.0 and using Xcode 8 when i build the project i got this\n\n. ",
    "DrBeak1": "Just tried to switch today (xcode 8, cocoapods 1.1.0rc2, socketio 8.0.1) and getting 36 errors.\n\nNot sure what I did wrong ... I've read through this thread and many others. Nothing seems to work.\n. @vikiBenHaim1 you were able to get things working using swift 3.0 (aka, master)? \n. @nuclearace I definitely agree with that; this was NOT a problem with xcode 7. Any suggestions for getting this working? I've tried everything I can think of; from removing all cocoapods and reinstalling, to adjusting framework and header search paths, cleaning the build, deleting derived data ... nothing seems to work. \nNOTE: I suspect this may be related to cocoapods and not specifically to SocketIO so I posted up there. I will link to any solutions from there and close this when I get things sorted out.\n. Solution noted here\n. ",
    "vikiBenHaim1": "I have the same problem.\nI tried to set SocketIOClientSwift target to use legacy swift language version without update swift version https://thatthinginswift.com/swift-2-xcode-8/, \nnot work too....\n. Hi, \nI downloaded the new Socket IO Client Swift version , and added the changes according the documentation and now it's worked.\nThanks.\n. ",
    "brianfang": "@vikiBenHaim1 What is documentation you referred so that you get things done ? thanks.\n. ",
    "ErMaheshwari": "Hi I am using latest socket-io for swift 3.0 , I am able to connect my local host, but when i am emiting the message , its not emiting.. I am emiting one of my server event @\"send_message\", with\nsocket.emitWithAck , NO ACK getting print, before send message event , I am\ndoing authentication.\nBut No Luck.\nYour Help will be appreciated.\nOn Mon, Mar 27, 2017 at 8:19 PM, Erik Little notifications@github.com\nwrote:\n\nWhat is your emit?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/635#issuecomment-289477107,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ABCF3KspbBSX7ZhET4WVbd_K5qQP2xiKks5rp8xzgaJpZM4Mo-YF\n.\n\n\n-- \nThanks and Regards,\nPriyank Maheshwari\n. I tried only emit too , but no luck , I am using swift 3.0.\nhttps://github.com/socketio/socket.io-client-swift\nOn Mon, Mar 27, 2017 at 9:00 PM, Erik Little notifications@github.com\nwrote:\n\nIf not you have to use the regular emit.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/635#issuecomment-289490104,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ABCF3Nldmm8BmBrrNvo5Xz0QnqZ1aP0gks5rp9YjgaJpZM4Mo-YF\n.\n\n\n-- \nThanks and Regards,\nPriyank Maheshwari\n. is this the sample handler method ? or do we need to copy this too.\nsocket.on(\"currentAmount\") {data, ack in\n    if let cur = data[0] as? Double {\n        socket.emitWithAck(\"canUpdate\", cur).timingOut(after: 0) {data in\n            socket.emit(\"update\", [\"amount\": cur + 2.50])\n        }\n    ack.with(\"Got your currentAmount\", \"dude\")\n}\n\n}\nOn Mon, Mar 27, 2017 at 9:09 PM, Er Maheshwari \nmaheshwaribangalore@gmail.com wrote:\n\nI tried only emit too , but no luck , I am using swift 3.0.\nhttps://github.com/socketio/socket.io-client-swift\nOn Mon, Mar 27, 2017 at 9:00 PM, Erik Little notifications@github.com\nwrote:\n\nIf not you have to use the regular emit.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/635#issuecomment-289490104,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ABCF3Nldmm8BmBrrNvo5Xz0QnqZ1aP0gks5rp9YjgaJpZM4Mo-YF\n.\n\n\n--\nThanks and Regards,\nPriyank Maheshwari\n\n-- \nThanks and Regards,\nPriyank Maheshwari\n. What version shall I use at server could you please tell me, that i can tell after asking my server guy. but you please let me know whats the right version has to be used at server end.. Yes, socket get connect , get the callback in connect handler. in the same handler i do the auth emit, using json object with required params. These are the below logs, at server end checked the version using 1.5.0.\nCould you please let me know if I am forming the json object, as my server is accepting the json data.\n  let dict = [\"key\": \"Value\"]\n\n        do {\n            let jsonData = try JSONSerialization.data(withJSONObject: dict, options: .prettyPrinted)\n            // here \"jsonData\" is the dictionary encoded in JSON data\n\n            let decoded = try JSONSerialization.jsonObject(with: jsonData, options: [])\n            // here \"decoded\" is of type `Any`, decoded from JSON data\n\n            // you can now cast it with the right type\n            if let dictFromJSON = decoded as? [String:String] {\n                // use dictFromJSON\n\n                self.socket.emit(\"authenticate\", dictFromJSON)\n\n            }\n        } catch {\n            print(error.localizedDescription)\n        }\n\nSocketEnginePolling: Created POST string: 362:42[\"authenticate\u201d,{\u201ctoken\u201d:\u201dsomeValueOfTocken\u201d}]\n2017-03-29 18:29:09.712664 LOG SocketEnginePolling: POSTing\n2017-03-29 18:29:09.713161 LOG SocketEnginePolling: Doing polling request\n2017-03-29 18:29:10.364419 LOG SocketEngine: Writing poll:  has data: false\n2017-03-29 18:29:10.365091 LOG SocketEnginePolling: Sending poll:  as type: 2\n2017-03-29 18:29:10.366632 LOG SocketEngine: Writing poll:  has data: false\n2017-03-29 18:29:10.367474 LOG SocketEnginePolling: Sending poll:  as type: 2\n2017-03-29 18:29:10.457790 LOG SocketEnginePolling: Created POST string: 1:21:2\n2017-03-29 18:29:10.458633 LOG SocketEnginePolling: POSTing\n2017-03-29 18:29:10.459013 LOG SocketEnginePolling: Doing polling request\n2017-03-29 18:29:10.657771 LOG SocketEnginePolling: Got polling response\n2017-03-29 18:29:10.658564 LOG SocketEnginePolling: Doing polling request\n2017-03-29 18:29:10.659795 LOG SocketEngine: Got message: 3\n2017-03-29 18:29:11.004019 LOG SocketEnginePolling: Got polling response\n2017-03-29 18:29:11.004837 LOG SocketEnginePolling: Doing polling request\n2017-03-29 18:29:11.006136 LOG SocketEngine: Got message: 3\n2017-03-29 18:29:21.812093 LOG SocketEngine: Writing poll:  has data: false\n2017-03-29 18:29:21.812627 LOG SocketEnginePolling: Sending poll:  as type: 2\n2017-03-29 18:29:21.813188 LOG SocketEnginePolling: Created POST string: 1:2\n2017-03-29 18:29:21.814046 LOG SocketEnginePolling: POSTing\n2017-03-29 18:29:21.814418 LOG SocketEnginePolling: Doing polling request\n2017-03-29 18:29:22.032575 LOG SocketEnginePolling: Got polling response\n2017-03-29 18:29:22.033374 LOG SocketEnginePolling: Doing polling request\n2017-03-29 18:29:22.034600 LOG SocketEngine: Got message: 3\n2017-03-29 18:29:37.855310 LOG SocketEngine: Writing poll:  has data: false\n2017-03-29 18:29:37.855838 LOG SocketEnginePolling: Sending poll:  as type: 2\n2017-03-29 18:29:37.856582 LOG SocketEnginePolling: Created POST string: 1:2. Thanks i will try to let u know , could you please let me knows socket-io accept only json data ?. Ok, then why i am not able to do :(. ",
    "matthiasp42": "That's it :)\nThank you for your quick help!\n. ",
    "nadia-am": "@nuclearace i have the save problem\nvar url = \"https://test.tx/\"\n        let manager = SocketManager(socketURL: URL(string: url )!, config: [.log(true), .compress])\n        let socket = manager.defaultSocket\n        socket.on(clientEvent: .connect) {data, ack in\n            print(\"socket connected\")\n        }\n        socket.onAny{\n            print(\"got event: ($0.event) with items ($0.items)\")\n        }\n        socket.connect()    \n        var x = 0\n        while true {\n            print(socket.status)\n            x = x+1\n            print(x)\n        }\nit stuck in connecting\nhow can i solve it\n  . I am running this code inside of my app.. i remove while do i want to listen for connect event but it doesnt happen.\npython\nsocket.on(clientEvent: .connect) {data, ack in\n            print(\"socket connected\")\n        }. python\nLOG SocketIOClient{/}: Adding handler for event: connect\nLOG SocketIOClient{/}: Adding handler for event: statusChange\nLOG SocketIOClient{/}: Adding handler for event: connect\nLOG SocketIOClient{/}: Handling event: statusChange with data: [connecting]\nLOG SocketIOClient{/}: Joining namespace /\nLOG SocketManager: Tried connecting socket when engine isn't open. Connecting\nLOG SocketManager: Manager is being released\nLOG SocketEngine: Starting engine. Server: https://my ip address/\nLOG SocketEngine: Handshaking\nLOG SocketEnginePolling: Doing polling GET https://my ip address/socket.io/?transport=polling&b64=1\nLOG SocketEnginePolling: Got polling response\nLOG SocketEnginePolling: Got poll message: 97:0{\"sid\":\"ZuYDeUge8vQnd1i5AADy\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\nLOG SocketEngine: Got message: 0{\"sid\":\"ZuYDeUge8vQnd1i5AADy\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\nLOG SocketEngine: Writing poll:  has data: false\nLOG SocketEnginePolling: Sending poll:  as type: 2\nLOG SocketEnginePolling: Created POST string: 1:2\nLOG SocketEnginePolling: POSTing\nLOG SocketEngine: Engine is being released. thanks alot . it works.. i found the problem, it was because of my ShadowSocks. i turn it off then run the simulator.  it works correctly.. ",
    "lzantal": "Got this same issue when I started on my project this week. \nYou can't use self signed certificate with iOS. Even setting setting \n\"App Transport Security Settings\" in Info.plist doesn't work for some reason. I just grabbed a wildcard ssl and it runs fine now.\n. ",
    "udayvatturi": "Thank You. I will try that. \n. ",
    "alexvimodev": "Is there any option to resolve this problem ? Or can you give me some input to debug and fix it from my end ?\n. The problem is; it is not happening in my phones... :(\nIf I found, I will update you..\n. Is there any option to resolve this problem ? Or can you give me some input to debug and fix it from my end ?\n. Yes... Today only I downloaded the source from github.\n. ",
    "rekt0x": "There is not much to configure with SSLSecurity. The only parameter that can be supplied to the constructor is usePublicKeys - which is by default false.\nswift\npublic convenience init(usePublicKeys: Bool = false) { /*... */ }\nBut I don't want to use public keys, I want to use certificates. So I guess usePublicKeys should be false.\n. @irakliitavadze Yeah, I got it working with this code:\nswift\nlet socket = SocketIOClient(socketURL: URL(string: \"<url here>\")!, config: [\n        .log(false),\n        .secure(true),\n        .forceNew(true),\n        .forceWebsockets(true), // SSL pinning works only on forcedWebsockets. Do not set it to false and do not remove this line!\n        .security(SSLSecurity(usePublicKeys: true))\n        ]). ",
    "bot2600": "Have you verified it is connecting with web sockets? From what I see if it stays polling SSLSecurity is not called. I haven't tried loading the certs from my bundle, but I have built them passing NSData to SSLCert and passing that array to SSLSecurity and had it work fine. \n. ok, I'll just open that class and that one method\n. this is covered in https://github.com/socketio/socket.io-client-swift/pull/515#issuecomment-249829170\nand his fix fixes me as well\n. ",
    "2h4u": "I have the same problem as @christianlanz.\nAs you can see I pass the cert manually to the SSLSecurity constructor and everything works fine. But as soon as I try to intercept the connection (perform an man in the middle attack) with an SSL Proxy, socketio acceps the certificate from the SSL-proxy and I can see the everyting in plaintext -> ssl pinning isnt working.\nHere is my code:\n  let paths = Set([\".der\", \".DER\"].map { fileExtension in\n    Bundle.main.paths(forResourcesOfType: fileExtension, inDirectory: nil)\n    }.joined())\n\n  var certs = [SSLCert]()\n\n  for path in paths {\n    if let certificateData = try? Data(contentsOf: URL(fileURLWithPath: path)) as Data {\n      let certificate = SSLCert(data: certificateData)\n      certs.add(certificate)\n    }\n  }\n\n  socket = SocketIOClient(socketURL: URL(string: \"https://examplehost.com\")!, config: [\n    .log(true),\n    .secure(true),\n    .forceNew(true),\n    .security(SSLSecurity(certs: certs, usePublicKeys: false))\n    ])\n\nIs there a flag that I need to set or is there something else missing?. @OneSman7 Multiple points:\n1. I don't share your opinion on the minor issue thing because a lot of other common librarys are using the shared HTTPCookieStorage e.g. Alamofire (https://github.com/Alamofire/Alamofire). \nThe shared HTTPCookieStorage can also be used by the Foundation framework if you doing some networking with it: (https://developer.apple.com/documentation/foundation/nsmutableurlrequest/1415485-httpshouldhandlecookies)\nSo I don't think it's minor at all.\n\n\n1080 is just a partial fix because usually you don't want to use the cookies from the shared HTTPCookieStorage. You want to use the cookies which you passed the SocketManager via it's config (SocketManager().config = [ .cookies([HTTPCookie]) ]).\nIt's very confusing if you are passing the SocketManager just the needed cookie but then its using a lot more cookies.. @OneSman7 okay I see, you are right. But #1080 isn't a full fix because it can happen that you interact with a server in multiple ways, for example: via websocket and REST-API. In this scenario it wouldn't be a surprise if you don't want to share the cookies between the REST-API calls and the websocket. But with the current implementation there is just no way to achieve this.\n\nSo in my opinion we should support 2 cases:\n1. Keeping the cookies of websocket and REST-API separated.\n2. Sharing the cookies between websocket and REST-API but only as opt-in option to prevent unindented behavior.\nThis could be achieved if we create a new field for SocketManager.config, for a HTTPCookieStorage, so the developer can set whatever he wants either a custom one or the \"default\"-shared one. If it's not set, the SocketEngine should create a custom one.\nSomething like this:\n```\n// Puts the engine back in its default state\nprivate func resetEngine() {\n    let queue = OperationQueue()\n    queue.underlyingQueue = engineQueue\n\n    closed = false\n    connected = false\n    fastUpgrade = false\n    polling = true\n    probing = false\n    invalidated = false\n    session = Foundation.URLSession(configuration: .ephemeral, delegate: sessionDelegate, delegateQueue: queue)\n    session!.configuration.httpCookieStorage = cookieStorage ?? HTTPCookieStorage.init()\n    sid = \"\"\n    waitingForPoll = false\n    waitingForPost = false\n}\n\n```. @OneSman7 ok i testet this now but unfortunately I can't set a new HTTPCookieStorage because session!.configuration is not mutable and I didn't find a way to set it another way.\nAnother approach would be that we use the .ephemeral configuration instead of the .default configuration for the initialization of the Foundation.URLSession() to solve this problem. \nBut I can't test if the cookies which are set during a long poll are still available for the websockets since my applications doesn't use such a mechanic. Could you try this with your application? @OneSman7 . ",
    "irakliitavadze": "@christianlanz did you resolve your problem?. @bilawal-liaqat hello, did you resolve your problem?. So problem was fixed on backend side. We added .key, .crt and https module. \nBut one interesting moment on Android a socket works without changes on backend.. ",
    "satishVekariya": "same problem, none of solution work!!!. Thanks for replay!!\nYa, I'm sure, my URL is https and its working well on Android platform.\nWhat do you mean real SSL pinning??. Above code is not for real pinning!!\n. ",
    "LayDownAll": "How to set up cookie in objective. ",
    "ElliotXY": "[socket on:@\"connect\" callback:^(NSArray* data, SocketAckEmitter* ack)\n             {\n                 NSLog(@\"socket connected\");\n             }];\nthis function\nand also socket on:@\"error\"does not work\n. .h\n@interface SocketManage : NSObject\n{\n    //Socket\n    SocketIOClient* socket;\n}\n+(instancetype)shareInstance;\n-(void)connectSocket;\n.m\n@implementation SocketManage\n- (instancetype)shareInstance\n  {\n  static SocketManage *socketManage = nil;\n  static dispatch_once_t onceToken;\n  dispatch_once(&onceToken, ^{\n      socketManage = [self new];\n  });\n  return socketManage;\n  }\n//Socket\n            socket = [[SocketIOClient alloc] initWithSocketURL:[NSString stringWithFormat:@\"%@\", url] options:cookieProperties];\n```\n        //\u662f\u5426\u8fde\u63a5\n        [socket on:@\"connect\" callback:^(NSArray data, SocketAckEmitter ack)\n         {\n             NSLog(@\"socket connected\");\n         }];\n    //\u83b7\u53d6\u6d88\u606f\n    [socket on:@\"message\" callback:^(NSArray* data, SocketAckEmitter* ack)\n     {\n         //\u6dfb\u52a0\u5b57\u5178\uff0c\u4f20\u9012\n         NSMutableDictionary *dict_MSG = [NSMutableDictionary dictionary];\n         [dict_MSG setValue:data forKey:kReceiveDict];\n         //\u521b\u5efa\u901a\u77e5\n         NSNotification *notification =[NSNotification notificationWithName:kReceiveMSG object:nil userInfo:dict_MSG];\n         //\u901a\u8fc7\u901a\u77e5\u4e2d\u5fc3\u53d1\u9001\u901a\u77e5\n         [[NSNotificationCenter defaultCenter] postNotification:notification];\n\n     }];\n\n    //\u6d4b\u8bd5\n    [socket on:@\"debug\" callback:^(NSArray* data, SocketAckEmitter* ack)\n     {\n         NSLog(@\"%@\",data);\n     }];\n    [socket on:@\"command\" callback:^(NSArray* data, SocketAckEmitter* ack)\n     {\n         NSLog(@\"%@\",data);\n     }];\n\n    //\u51fa\u9519\n    [socket on:@\"error\" callback:^(NSArray* data, SocketAckEmitter* ack)\n     {\n         NSLog(@\"socket error\");\n     }];\n\n    //\u91cd\u8fde\n    [socket on:@\"reconnect\" callback:^(NSArray* data, SocketAckEmitter* ack)\n     {\n         NSLog(@\"socket reconnect\");\n     }];\n\n    [socket on:@\"currentAmount\" callback:^(NSArray* data, SocketAckEmitter* ack)\n     {\n         double cur = [[data objectAtIndex:0] floatValue];\n\n         [socket emitWithAck:@\"canUpdate\" withItems:@[@(cur)]](0, ^(NSArray* data)\n                                                               {\n                                                                   [socket emit:@\"update\" withItems:@[@{@\"amount\": @(cur + 2.50)}]];\n                                                               });\n\n         [ack with:@[@\"Got your currentAmount, \", @\"dude\"]];\n     }];\n\n    [socket connect];\n\n```\nI use it as a instance,is it a good thing?\nIn some cases, socket on:@\"connect\" does not work,and also there is no error message ,because socket on:@\"error\"  does not work too.\n. And surly socket is not getting released\n. [socket on:@\"log\" callback:^(NSArray* data, SocketAckEmitter* ack)\n                 {\n                     NSLog(@\"log = %@\",data);\n                 }]; this funcktion does not work.\nI run my app\uff0cand surely the socket is not being released\uff0cand the status of socket is connecting\uff0cbut socket on: every does not work\n. Thanks for reply.\nthe log is:\n2016-08-12 13:51:29.791 imp cloud[7724:1689435] Log SocketEngine: Engine is being deinit\n2016-08-12 13:51:29.797 imp cloud[7724:1689435] Log SocketIOClient: Adding handler for event: connect\n2016-08-12 13:51:29.797 imp cloud[7724:1689435] Log SocketIOClient: Adding handler for event: message\n2016-08-12 13:51:29.797 imp cloud[7724:1689435] Log SocketIOClient: Adding handler for event: debug\n2016-08-12 13:51:29.797 imp cloud[7724:1689435] Log SocketIOClient: Adding handler for event: command\n2016-08-12 13:51:29.799 imp cloud[7724:1689435] Log SocketIOClient: Adding handler for event: error\n2016-08-12 13:51:29.799 imp cloud[7724:1689435] Log SocketIOClient: Adding handler for event: reconnect\n2016-08-12 13:51:29.799 imp cloud[7724:1689435] Log SocketIOClient: Adding handler for event: currentAmount\n2016-08-12 13:51:29.804 imp cloud[7724:1689435] Log SocketIOClient: Adding engine\n2016-08-12 13:51:29.804 imp cloud[7724:1689435] Log SocketEngine: Starting engine\n2016-08-12 13:51:29.804 imp cloud[7724:1689435] Log SocketEngine: Handshaking\n2016-08-12 13:51:29.804 imp cloud[7724:1689435] Log SocketEngine: Doing polling request\n2016-08-12 13:51:29.865 imp cloud[7724:1689469] Log SocketEngine: Got polling response\n2016-08-12 13:51:29.865 imp cloud[7724:1689469] Log SocketEngine: Got message: 0{\"sid\":\"FaCA5jAyZdSM6p2NACoc\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2016-08-12 13:51:29.866 imp cloud[7724:1689469] Log SocketEngine: Doing polling request\n2016-08-12 13:51:29.959 imp cloud[7724:1689585] Log SocketEngine: Sending ws: probe as type: 2\n2016-08-12 13:51:29.965 imp cloud[7724:1689659] Log SocketEngine: Got message: 3probe\n2016-08-12 13:51:29.965 imp cloud[7724:1689659] Log SocketEngine: Upgrading transport to WebSockets\n2016-08-12 13:51:29.965 imp cloud[7724:1689659] Log SocketEngine: Sending poll:  as type: 6\n2016-08-12 13:51:29.966 imp cloud[7724:1689659] Log SocketEngine: POSTing: 1:6\n2016-08-12 13:51:29.966 imp cloud[7724:1689659] Log SocketEngine: Doing polling request\n2016-08-12 13:51:30.067 imp cloud[7724:1689536] Log SocketEngine: Got polling response\n2016-08-12 13:51:30.068 imp cloud[7724:1689536] Log SocketEngine: Sending ws:  as type: 5\n2016-08-12 13:51:30.068 imp cloud[7724:1689536] Log SocketEngine: Flushing probe wait\n2016-08-12 13:51:30.068 imp cloud[7724:1689492] Log SocketEngine: Got message: 6>\n2016-08-12 13:51:55.171 imp cloud[7724:1689665] Log SocketEngine: Writing ws:  has data: 0\n2016-08-12 13:51:55.171 imp cloud[7724:1689665] Log SocketEngine: Sending ws:  as type: 2\n2016-08-12 13:51:55.180 imp cloud[7724:1689665] Log SocketEngine: Got message: 3\n2016-08-12 13:54:00.170 imp cloud[7724:1690304] Log SocketEngine: Writing ws:  has data: 0\n2016-08-12 13:54:00.171 imp cloud[7724:1690304] Log SocketEngine: Sending ws:  as type: 2\n2016-08-12 13:54:00.183 imp cloud[7724:1690365] Log SocketEngine: Got message: 3\n\nStill,The status of socket is connecting ,but [socket on:@\"connect\" callback:^(NSArray* data, SocketAckEmitter* ack)\n         {\n             NSLog(@\"socket connected\");\n         }]; This function does not work!\n. Is this log OK\uff1f\n. @nuclearace  Can you help me?\n. @nuclearace Many tahnks,I have found the reason,it is due to our server\u2018s wrong Logic.\nThis issue can be closed,Thank you!\n. ",
    "MeGaPk": "@nuclearace you are lucky... I have 20-30 seconds... on my macbook pro. \n. +1, in 8.1.1 i have same problem\nBut maybe solution.... In engineDidClose() method just comment self.waitingPackets.removeAll()\n. Update:\nI get same crash, when server send data, like \"Your auth data failed\" and make disconnect.\n. @orensha can you please show your pod file?\n. @nuclearace thanks!. Options:\nNSDictionary *options = @{\n                @\"forceWebsockets\": @(YES),\n                @\"forcePolling\": @(NO),\n                @\"log\": @(YES),\n                @\"token\": token,\n                @\"appType\": @\"client\",\n                @\"clientType\": @\"ios\",\n                @\"extraHeaders\": @{@\"token\": token, @\"app-type\": @\"client\", @\"client-type\": @\"ios\"},\n                @\"connectParams\": @{@\"token\": token, @\"app-type\": @\"client\", @\"client-type\": @\"ios\"}\n        };. \n. \n. @nuclearace just long wait work with reconnecting every 2-5 minutes.. need swift 4 for that. ",
    "zhushengxiong": "I found that you fixed an issue with @\u201cdisconnect\u201d in 6.1.4. Does it work? Can you help me to solve\nthis problem? @nuclearace \n. What should I do when socket is disconnected unexpected\uff1f I should remind the app user that network is bad or something else, and reLogin if the socket is disconnected. But I has no response with it. I should do something on the UI if it happens. Is there any solution?\n. Maybe I should create a timer to count the time when a method invoked, and setting a timeout if there is no response for it. But it's no graceful. It seems not to be a trouble for my Android and JS colleagues, because disconnect will be called if only the socket is disconnected. It's logical.\n. OK, Thanks\uff01It works. I will manage the socket by myself. If it disconnects, I offer to connect it. \n. ",
    "monobono": "Just to be sure: Option name keys need to be in cammelCase eg. 'security' instead of 'Security' if you call them from Objective-C\n. ",
    "suhair": "@nuclearace  thanks for quick response. sendTextMessage method is called way after the connection is established in response to a button tap so I can't wrap the emit method inside the on handler, right?. I am not hitting the not connected error without wrapping it on connect handler. \nfunc sendTextMessage(){\n        socket.emit(\"connectUser\", \"Dummy data\")\n}\nThis does not trigger the emit on the server. I checked the same event through browser and it works fine. Thanks again for reply.\n. That's done for debugging and ignore it. I am establishing connection inside the app delegate as follows.\n```\n   func applicationDidBecomeActive(application: UIApplication) {\n    SocketIOManager.sharedImstance.establishConnection()\n\n\n}\n\n```\nI am logging the connection and disconnection events on the server. Server shows connection established and then i trigger the button to emit as above. It does not show disconnection until i move the app to background when i disconnect the socket so i think the connection is already active when the sendTextMessage and emit is triggered.\n. Have not added the handlers for error and disconnect on the iOS. I will try it now. Just tried to move the code from app delegate to viewDidLoad of the view controller and it works as expected triggering the emt event on the server.\noverride func viewDidLoad() {\n        super.viewDidLoad()\n        SocketIOManager.sharedInstance.establishConnection()\n }\n. When I establish connection inside app delegate i get the following error after the app is idle for some time.\nCommunications error: <OS_xpc_error: <error: 0x107ff7b40> { count = 1, contents =\n    \"XPCErrorDescription\" => <string: 0x107ff7ef0> { length = 22, contents = \"Connection interrupted\" }\n}>\nThis does not happens when the connection is established inside viewDidLoad.\n. Thanks @nuclearace.\n. ",
    "FNet92": "yes! You are right! Thank you! \n. ",
    "yxztj": "@nuclearace Yes we know it's important to reproduce the issues. But due to low repro rate and uncertain scenario with end users, it's really hard for us to narrow down that way.\nAlso we don't want to leave the crashes there. Are there any possible code paths that might lead to crashes with the stack traces above?\n. @nuclearace In our code sometimes we create a new SocketIOClient instance to replace the old one, regardless which state the old client is in. Is it safer that we hold the reference to the old one and check the state before releasing it?\n. @nuclearace I think I might have found something. There are 2 threads calling createWebsocketAndConnect at the same time, leading to race condition.\nIn engineHandleQueue thread, SocketEngine would recreate the websocket on SocketEngine.websocketDidDisconnect.\n\nMeanwhile, on main thread SocketIOClient is also creating websocket in _tryReconnect:\n\nSince both threads are calling the same function, there should be some unexpected behaviors.\nCould there be any fix based on the investigation above?\n. @nuclearace We are using default parameters for socket io client. I tried but still don't have a solid repro for this, since race condition is a random edge case. But we are facing this issue for several months. I couldn't find a clue until reviewing all threads in the crash report.\nCan we limit that websocket creating could only been performed on specific thread? Or is there any particular consideration when _tryReconnect decides to dispatch on the main thread?\n. @nuclearace Sorry for pushing but this is currently the No.1 crash in our app(over 1k incidents). Can we have a quick fix or workaround for the issue? Thanks.\n. @nuclearace Thanks. I'm turning off the automatic reconnecting too and see if the amount of crashes gets down.\n. ",
    "mavris": "No.\nI did something wrong or it's something with cocoapods?\n. ",
    "EddieLukeAtmey": "Hi, I just upgrade to xcode 8 and using socketIO 8 (latest) and this is happening. Can you help me please (I use cocoapods). How did you fix this?\n. I'm just here to verify that it CAN work with xcode 8. I've imported this to my project, using cocoapod of course. At first, I also struggle with the module not found. I did a clean up:\n1. Close project.\n2. Delete pod files, delivered files, pod frameworks, workspace file\n3. pod install\n4. Reopen workspace, upgrade swift syntax if xcode ask for, build a few times.\nAfter that, the \"module not found\" goes away. Not sure if I did anything more than that.\nIn pod, I just declare pod 'Socket.IO-Client-Swift\nEdit: Alright, I just remembered that I've updated pod repo to the newest (using git, not pod command)\n. ",
    "Parilar": "Its random\nAm 23.08.2016 15:33 schrieb \"Erik Little\" notifications@github.com:\n\nWhen does this happen?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/465#issuecomment-241731552,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AHyBnvTrDi0lL1vi3qjsJE6VxWOwKs9Tks5qivaMgaJpZM4JqtPc\n.\n. Its working fine. But sometimes i got this error After some time\n\nAm 24.08.2016 12:45 schrieb \"Erik Little\" notifications@github.com:\n\nI'm not quite sure what you mean? I'm able to get my test server working\nfine.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/465#issuecomment-242024042,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AHyBnv0QW6rk6pK8ml7LSEQBP_SqlXhvks5qjCDbgaJpZM4JqtPc\n.\n. The App is in foreground\n\n2016-08-26 18:18:08.396 MyApp.temp_caseinsensitive_rename[5449:6155199] ERROR SocketEngine: Engine URLSession became invalid\n2016-08-26 18:18:08.397 MyApp.temp_caseinsensitive_rename[5449:6162726] LOG SocketEngineClient: Connect\n2016-08-26 18:18:08.397 MyApp.temp_caseinsensitive_rename[5449:6162485] LOG SocketEngine: Writing poll:  has data: 0\n2016-08-26 18:18:08.398 MyApp.temp_caseinsensitive_rename[5449:6155199] ERROR SocketIOClient: Engine URLSession became invalid\n2016-08-26 18:18:08.397 MyApp.temp_caseinsensitive_rename[5449:6162485] LOG SocketEnginePolling: Sending poll:  as type: 2\n2016-08-26 18:18:08.400 MyApp.temp_caseinsensitive_rename[5449:6155199] LOG SocketIOClient: Handling event: error with data: (\n    \"Engine URLSession became invalid\"\n)\n2016-08-26 18:18:08.400 MyApp.temp_caseinsensitive_rename[5449:6155199] LOG SocketEngine: Engine is being closed.\n2016-08-26 18:18:08.404 MyApp.temp_caseinsensitive_rename[5449:6155199] ERROR SocketEngine: Engine URLSession became invalid\n2016-08-26 18:18:08.404 MyApp.temp_caseinsensitive_rename[5449:6155199] ERROR SocketEngine: Engine URLSession became invalid\n2016-08-26 18:18:08.405 MyApp.temp_caseinsensitive_rename[5449:6155199] ERROR SocketIOClient: Engine URLSession became invalid\n2016-08-26 18:18:08.406 MyApp.temp_caseinsensitive_rename[5449:6155199] LOG SocketIOClient: Handling event: error with data: (\n    \"Engine URLSession became invalid\"\n)\n2016-08-26 18:18:19.165 MyApp.temp_caseinsensitive_rename[5449:6155199] LOG SocketIOClient: Trying to reconnect\n2016-08-26 18:18:19.166 MyApp.temp_caseinsensitive_rename[5449:6155199] LOG SocketIOClient: Handling event: reconnectAttempt with data: (\n    \"-2\"\n)\n. ",
    "sungju881203": "@nuclearace hey just giving you heads up that the demos from socket.io isn't working. nothing works!!!\n. ",
    "manmal": "@nuclearace  For me, it happens when I set forceNew to true and connect twice. On second connect, another NSURLSession is created (via resetEngine()), but it seems that it is invalid.\nUPDATE: \nThe session's invalidation happens in stopPolling(), which is called in my case because of a call to disconnect() due to a timeout:\n```\n        dispatch_after(time, handleQueue) {[weak self] in\n            if let this = self where this.status != .Connected && this.status != .Disconnected {\n                this.status = .Disconnected\n                this.engine?.disconnect(\"Connect timeout\")\n            handler?()\n        }\n    }\n\n```\n. ",
    "rmnblm": "Reusing sockets isn't that great, you're right, but hopefully you understand the problem I'm facing here. I don't really understand your suggestion, could you provide me some implementation details on how you'd do it? \u263a\ufe0f \n. I was able to send and receive the buffer from an iOS Device to a Node.js server and then displaying it in a React.js component. Maybe someone needs these snippets in the future and will be grateful.\niOS Client\nMethod body to create a UIImage\nUIGraphicsBeginImageContext(CGSize(width: bounds.size.width, height: bounds.size.height))\nlayer.render(in: UIGraphicsGetCurrentContext()!)\nlet image: UIImage = UIGraphicsGetImageFromCurrentImageContext()!\nUIGraphicsEndImageContext()\nreturn image\nMethod body to create a Data object\nlet image = canvasView.getImage() // calling above method\nlet data = UIImageJPEGRepresentation(image, 1.0)\nSocketIOManager.sharedInstance.sendDisplayStream(data!)\nEmit the data\nfunc sendDisplayStream(_ data: Data) {\n    socket?.emit(\"deviceDisplayStream\", data)\n}\nNode.js server\nReceive the data and forward it to a specified room\nsocket.on('deviceDisplayStream', buffer => {\n    server.in('room1').emit('deviceDisplayStream', buffer);\n});\nReact Component\nReceive the data and create a local URL to reference\nSocketClient.on('deviceDisplayStream', buffer => {\n      console.log(buffer);\n      const blob = new Blob([buffer], { type: 'image/jpeg' });\n      const urlCreator = window.URL || window.webkitURL;\n      const imageUrl = urlCreator.createObjectURL(blob);\n      this.setState({ url: imageUrl });\n});\nRender method to display the image\nrender() {\n    return (\n      <div>\n        <img src={this.state.url} alt=\"test\" />\n      </div>\n    );\n  }\n. ",
    "Calvin-Huang": "@xclidongbo  You need to specify your socket-server path and namespace by setting SocketIOClient with options.\ncase Nsp(String) // The namespace to connect to. Must begin with /. Default is /\ncase Path(String) // If the server uses a custom path. ex: \"/swift/\". Default is \"\"\nFrom my experience, our socket.io opened on http://xxx.domain.xxx/socket.io/?productId=2312 by socket.io default value.\nAnd I tried to use the url with query to connect to socket.io server just like what I did in js version. But I failed.\nlet socket = SocketIOClient(socketURL: NSURL(string: \"http://xxx.domain.xxx/socket.io\n/?productId=2312\")!)\nIn Socket.IO-Client-Swift swift, we need to assign namespace and connect params manually.\nlet socket = SocketIOClient(socketURL: NSURL(string: \"http://xxx.domain.xxx/\")!, config: [.Nsp(\"/socket.io/\"), .ConnectParams([\"productId\": 2312])])\n. @nuclearace  Sorry, You're right. That's the .Path.\nBut in our server side code is namespace indeed.\n```\nio.of('/socket.io/').on('connection', function (socket) {\nvar productId = socket.handshake.query.productId;\n  console.log(\"socket connected\uff0cproductId:\" + productId);\n  var redisClient = redis.createClient();\n  redisClient.subscribe('productDetail:' + productId);\nredisClient.on('message', function(channel, message) {\n    console.log(\"Send message: \"+ message + \" -> \" + '\u300cproductDetail' + productId + '\u300d');\n    socket.emit(channel, message);\n  });\nsocket.on('disconnect', function() {\n    redisClient.quit();\n  });\n});\n```\n. ",
    "nhjariwala": "@nuclearace Thanks for  your response.\nNO Nettalk Server doesn't used socket.io.\nIs there any cross platform client library available for Server that don't use socket.io ?\nSorry for bothering you.\n. ",
    "theroadisnear": "my bad, there was an error on my part,\n. ",
    "yusufkildan": "Also I have same issue.\n. I'm using Firebase so I received this error messages.This error is a xCode bug but I find the solution : \nhttp://stackoverflow.com/questions/38456471/secitemadd-always-returns-error-34018-in-xcode-8-in-ios-10-simulator\nhttps://firebase.googleblog.com/2016/08/ios-10-xcode-8-and-swift-3.html\n. ",
    "viny76": "The same ...\n. ",
    "gianlucainnocente": "Here the same...\n. ",
    "joenot443": "Same issue over here.. Just to confirm, @nuclearace, does this library only work when connecting other socket.io servers? Or will a regular socket server work?. ",
    "mhtranbn": "mee too, please support! @nuclearace . Many thanks @nuclearace \ud83d\udcaf . ",
    "vincedev": "HI,\nTried using the merged changes for Swift 3 on macOS.\nI have errors when compiling.\nThe compiler complains about symbols unavailable for macOS under 10.10 (namely DispatchQueue.global(qos:), DispatchQoS.QoSClass.default in SSLSecurity.swift).\nSocket IO's deployment target is set to macOS 10.9.\n. @kinza88 @nuclearace  \nHi, I'm facing a very similar issue.\nIn my case this happens on macOS (didn't see similar behavior on iOS).  \nAlthough reconnection works for me, the connection with the server keeps being closed because the server didn't get the PING in time.\nLogging produces this output :\n\n2017-12-01 10:16:35.897967+0100 Application[19936:973300] LOG SocketEngine: Got message: 3\n2017-12-01 10:16:37.882025+0100 Application[19936:973300] LOG SocketEngine: Writing ws:  has data: false\n2017-12-01 10:16:37.882136+0100 Application[19936:973300] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-12-01 10:16:37.897835+0100 Application[19936:973300] LOG SocketEngine: Got message: 3\n2017-12-01 10:16:39.882151+0100 Application[19936:965577] LOG SocketEngine: Writing ws:  has data: false\n2017-12-01 10:16:39.882520+0100 Application[19936:965577] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-12-01 10:16:39.898686+0100 Application[19936:965577] LOG SocketEngine: Got message: 3\n2017-12-01 10:16:41.882477+0100 Application[19936:965577] LOG SocketEngine: Writing ws:  has data: false\n2017-12-01 10:16:41.883000+0100 Application[19936:965577] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-12-01 10:16:41.907961+0100 Application[19936:973300] LOG SocketEngine: Got message: 3\n2017-12-01 10:16:48.909072+0100 Application[19936:965578] ERROR SocketEngine: \n2017-12-01 10:16:48.909941+0100 Application[19936:959424] ERROR SocketIOClient: \n2017-12-01 10:16:48.910204+0100 Application[19936:959424] LOG SocketIOClient: Handling event: error with data: [\"\"]\n2017-12-01 10:16:48.911094+0100 Application[19936:959424] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\n2017-12-01 10:16:48.911310+0100 Application[19936:959424] LOG SocketIOClient: Starting reconnect\n2017-12-01 10:16:48.911715+0100 Application[19936:959424] LOG SocketIOClient: Handling event: reconnect with data: [\"\"]\n2017-12-01 10:16:48.912023+0100 Application[19936:959424] LOG SocketIOClient: Trying to reconnect\n2017-12-01 10:16:48.912507+0100 Application[19936:959424] LOG SocketIOClient: Handling event: reconnectAttempt with data: [-1]\n2017-12-01 10:16:48.915810+0100 Application[19936:959424] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\n2017-12-01 10:16:48.920342+0100 Application[19936:974381] LOG SocketEngine: Starting engine. Server: http://host.fr.office:57570\n2017-12-01 10:16:48.920816+0100 Application[19936:974381] LOG SocketEngine: Handshaking\n// etc\n\nThe log says at some point an error is being triggered, but associated data contains an empty string, so I can't understand what's happening :\n\nHandling event: error with data: [\"\"]\n\nI'm using version 12.1.3 of socket.io-client-swift, originally upgraded from 12.1.2 (same issue). I'm using default ping timeout options, ping every 2 seconds, timeout after 5 seconds, and the server promptly closes the connection.\nThis is highly reproducible, in experiments, within 1-2 minutes the error happens.\nAny clue on this ? Can it be a timer somewhere that doesn't fire or something ?. Further experiment shows the issue doesn't raise on OSX 10.10. Didn't tried on OSX 10.11, but see it on macOS 10.12 and 10.13.. @nuclearace : thanks for replying, cache cleared, everything is fine now \ud83d\udc4d . @nuclearace : I did put some debug printing into sendPing() and here are my results.\nWhile most of the time ping is sent in time, it happens that it delayed (sometimes for many seconds) :\n2017-12-05 15:37:51 +0000: Sendind ping again...\n2017-12-05 15:37:51 +0000:  sendPing()\n2017-12-05 15:37:51 +0000: Checking pong missed...\n2017-12-05 15:37:51 +0000: Writing ping....\n2017-12-05 15:37:51 +0000: Scheduling new ping\n2017-12-05 15:38:03 +0000: Sendind ping again...\n2017-12-05 15:38:03 +0000:  sendPing()\n2017-12-05 15:38:03 +0000: Checking pong missed...\n2017-12-05 15:38:03 +0000: Writing ping....\n2017-12-05 15:38:03 +0000: Scheduling new ping\n2017-12-05 15:38:05 +0000: Sendind ping again...\n2017-12-05 15:38:05 +0000:  sendPing()\n2017-12-05 15:38:05 +0000: Checking pong missed...\n2017-12-05 15:38:05 +0000: Writing ping....\n2017-12-05 15:38:05 +0000: Scheduling new ping\n2017-12-05 15:38:07 +0000: Sendind ping again...\n2017-12-05 15:38:07 +0000:  sendPing()\n2017-12-05 15:38:07 +0000: Checking pong missed...\n2017-12-05 15:38:07 +0000: Writing ping....\n2017-12-05 15:38:07 +0000: Scheduling new ping\n2017-12-05 15:38:14 +0000: Sendind ping again...\n2017-12-05 15:38:14 +0000:  sendPing()\n2017-12-05 15:38:14 +0000: Checking pong missed...\n2017-12-05 15:38:14 +0000: Writing ping....\n2017-12-05 15:38:14 +0000: Scheduling new ping\nI clearly see delays like 12 seconds, or 7 seconds...\nSo our server uses small timeout, ping every 2 seconds, timeout after 5 seconds..\nI can't see clearly why pings are delayed like this, can it be the engineQueue is busy in any way ?\nWould using a separate queue resolve the problem ? \ud83e\udd14 \n. @nuclearace I did put together a minimal server, and minimal application to try to replicate the problem.\nPlease check out both server and app in attachements.\nRunning the sample app for about 20 min I have been disconnected two times due to ping timeout.\nSocketIOPing.zip\nserver.js.zip\nPlease note that on server-side I use v1.4.5 of socket.io which is the version running on our servers, and both app and server are running locally on my machine.\nHere's what I have in Xcode console :\n2017-12-07 10:06:33.459763+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: ping with data: []\n2017-12-07 10:06:33.462170+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: pong with data: []\n2017-12-07 10:06:35.458844+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: ping with data: []\n2017-12-07 10:06:35.460793+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: pong with data: []\n2017-12-07 10:06:37.458942+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: ping with data: []\n2017-12-07 10:06:37.461110+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: pong with data: []\n2017-12-07 10:06:44.462269+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: error with data: [\"\"]\n2017-12-07 10:06:44.462633+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: statusChange with data: [connecting]\n2017-12-07 10:06:44.462726+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: reconnect with data: [\"\"]\n2017-12-07 10:06:44.462962+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [-1]\n2017-12-07 10:06:44.509604+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: ping with data: []\n2017-12-07 10:06:44.509941+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: statusChange with data: [connected]\n2017-12-07 10:06:44.510375+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: connect with data: [\"/\"]\n2017-12-07 10:06:44.524403+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: news with data: [{\n2017-12-07 10:06:44.528518+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: pong with data: []\n2017-12-07 10:06:44.700578+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: pong with data: []\n2017-12-07 10:06:46.509943+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: ping with data: []\n2017-12-07 10:06:46.512049+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: pong with data: []\n2017-12-07 10:06:52.981487+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: ping with data: []\n2017-12-07 10:06:52.984617+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: pong with data: []\n....\n....\n2017-12-07 10:14:31.850652+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: ping with data: []\n2017-12-07 10:14:31.853581+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: pong with data: []\n2017-12-07 10:14:38.859349+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: error with data: [\"\"]\n2017-12-07 10:14:38.859768+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: statusChange with data: [connecting]\n2017-12-07 10:14:38.859837+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: reconnect with data: [\"\"]\n2017-12-07 10:14:38.859931+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [-1]\n2017-12-07 10:14:38.902743+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: ping with data: []\n2017-12-07 10:14:38.902968+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: statusChange with data: [connected]\n2017-12-07 10:14:38.903043+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: connect with data: [\"/\"]\n2017-12-07 10:14:38.926976+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: news with data: [{\n2017-12-07 10:14:38.930436+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: pong with data: []\n2017-12-07 10:14:39.151074+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: pong with data: []\n2017-12-07 10:14:40.903124+0100 SocketIOPing[1772:7747144] LOG SocketIOClient{/}: Handling event: ping with data: []\n. @nuclearace Oh well didn't realize that, thanks for telling me that.\n. There are a bunch of fixes, but indeed didn't notice anything regarding ping or pong . Alright, I'll update socket.io version on server and post back the results, probably tomorrow when I get time.. Same behavior with latest socket.io on server side, but at least I now get a valuable error string :\nHandling event: error with data: [\"connection closed by server\"]\n. @nuclearace I wonder if you replicated this behavior using the samples I uploaded ?. @nuclearace : Hi, can you confirm you reproduce the bug using the sample I provided. I didn't hear from you for 13 days on this, still the issue has a \"unconfirmed\" label, so maybe it's time to confirm the bug, or close this issue ?. @nuclearace : good to know \ud83d\udc4d \nI've been trying to debug a little, and I admit it's hard to know what's happening on the queue.\nWhat I can tell is the problem isn't related to network latency or so (I reproduce the issue on my machine running both server and client, as well as on a local network).\nI did try to ping the server manually, writing something through the socket, using a timer but at some point it was blocked (I imagine for the same reason the [socket.io] ping doesn't get fired).\nI'll go further in debugging and post back if I find something.\n. @nuclearace \nGood catch!  When I think I was trying to debug some kind of lock mess somewhere \ud83d\ude06 ...\nI tried this by my side and could not trigger any timeout, so this definitely is the way to go I think..\n\nthat's probably not the best solution\n\nMaybe not, but as far as I can tell, isn't it the only solution ?\nAfter all, the app starts communicating with a server and must maintain the communication so we need a way to tell the OS, and prevent it from considering the app does nothing.\nI also was looking for an Info.plist flag to add, but could not find it so far..\nConsidering this API is the way to go (it is for me now without anything else), do you think it's the app responsibility to call it, or the library should go ahead and call it at appropriate time ?. ",
    "keab42": "Is there a rough ETA on the swift 3 branch hitting master?\n. ",
    "San-Jeevan": "Yeah, alot of errors. But it appears your library is not the only one struggling to adapt to Swift3.\nI really cannot afford to lose time so I am currently downgrading both to iOS9 and Xcode7\n. CocoaPods.\nI did pod install.\nLook it may just be me and it all works for everyone else. I am now back in xcode7 so I can debug the swift3 issues.\nAll I did was launch xcode8. select stay with swift 2.3.\nGo to this library and chose SWIFT_LEGACY YES in build settings. (otherwise it gave build errors)\n. I managed to tempfix this by reverting to older version\npod 'Socket.IO-Client-Swift', '7.0.0'\n. ",
    "vikmis007": "\n@nuclearace  Still unable to install Socket 8.0.0 . See the attached screenshot\n. will it work with 1.1.0.rc.2 pod version??\n. ",
    "HaraldBregu": "I have the same problem, i updated Xcode to 8 and socket.io-client-swift do not work anymore.\nHow can i use it now? It is any solution?\n. @nuclearace \nI used \"pod 'Socket.IO-Client-Swift', '~> 8.0.0'\" to support swift 3 and xcode 8.x and now seams that there are no issues. \nBut to use it if i add this class @import SocketIO; i cant use SocketIOClient with issue \"no visible @interface for SocketIOClient\"\n. ",
    "wy358688217": "\n\nI was the OC project, tried a variety of methods finally compiled successfully, but failed to run\n.  @nuclearace But mine not command-line applications. So ,how to fixed?\n. \n @nuclearace My solution is to select YES, and then it can work.\n. ",
    "nouellette": "It's just new logging using Swfit 3 in xcode simulators. My mistake, so many references to sockets i just assumed. Closing issue.\n. ",
    "nog31": "Same problem !!! got message : Socket.io 1.0 now available....with all in HTML, like the socket.io webpage...\n. ",
    "slashpook": "It seems that if I use (forceNew:true) as parameter, it's work\n. ",
    "Chaser-Z": "Yeah.There are many error in  Xcode 8\n. ",
    "rheza": "I can confirm, there is a lot of error on Xcode 8. Any suggestion guys ?\n. @JunfeiW \nI can't even update my carthage now,\n\"* Building scheme \"SocketIO-tvOS\" in Socket.IO-Client-Swift.xcodeproj\n** CLEAN FAILED \nThe following build commands failed:\n    Check dependencies\n(1 failure)\n* BUILD FAILED *\nThe following build commands failed:\n    Check dependencies\n(1 failure)\nwarning: no umbrella header found for target 'SocketIO-tvOS', module map will not be generated\"\n. Should i just add this library manually, instead of using  package managers ?\nThanks\n. another tip also, if you add the framework manually, you don't need to have import SocketIO on top of file.\n. That's easy than I Thought.\nsocket = SocketIOClient(socketURL: NSURL(string: \"http://localhost:8080\")!,config:[.ForceWebsockets(true)])\nThanks\n. Hi, Did you manage to solve this issues ? how ?\nI also encounter this when the app is on review by apps team.  Is it because the websockets force on when connection to socket.io server ?, I just resubmitted the app with all optimization set to none flag. hopefully it's run okay now.\n\nThread 14 name:  Dispatch queue: NSOperationQueue 0x1700381e0 :: NSOperation 0x17024d7a0 (QOS: DEFAULT)\nThread 14:\n0   libsystem_kernel.dylib          0x00000001838ad314 __semwait_signal + 8\n1   libsystem_c.dylib               0x00000001837cc8b0 nanosleep + 212\n2   libsystem_c.dylib               0x00000001837cc7d0 usleep + 64\n3   SocketIO                        0x000000010052f834 specialized WebSocket.(initStreamsWithData(Data, Int) -> ()).(closure #1) (WebSocket.swift:365)\n4   SocketIO                        0x00000001005356c8 partial apply for WebSocket.(initStreamsWithData(Data, Int) -> ()).(closure #1) (WebSocket.swift:0)\n5   Foundation                      0x0000000185381804 __NSBLOCKOPERATION_IS_CALLING_OUT_TO_A_BLOCK__ + 16\n6   Foundation                      0x00000001852c6760 -[NSBlockOperation main] + 96\n7   Foundation                      0x00000001852b6b18 -[__NSOperationInternal _start:] + 612\n8   Foundation                      0x0000000185383ba0 __NSOQSchedule_f + 228\n9   libdispatch.dylib               0x000000018376a9a0 _dispatch_client_callout + 16\n10  libdispatch.dylib               0x0000000183778ad4 _dispatch_queue_serial_drain + 928\n11  libdispatch.dylib               0x000000018376e2cc _dispatch_queue_invoke + 884\n12  libdispatch.dylib               0x000000018377aa50 _dispatch_root_queue_drain + 540\n13  libdispatch.dylib               0x000000018377a7d0 _dispatch_worker_thread3 + 124\n14  libsystem_pthread.dylib         0x00000001839731d0 _pthread_wqthread + 1096\n15  libsystem_pthread.dylib         0x0000000183972d7c start_wqthread + 4\n\nThanks. ",
    "btelintelo": "another safety tip: import SocketIO is new...used to be import SocketIOClientSwift.  At first I thought it was some crazy cocoapods problem.\n. ",
    "Dohab": "More explanation:\nI'm running Xcode 8.0\nSwift 3\ncase 1:\nWhen I use the master build, every thing is cool, running smoothly on the emulator.\nBut my iPhone is running on 9.3, So when I change the target to 9.3 in both my project and socket.io project, I get dyld: library not loaded error.\ncase 2:\nWhen I use branch 2.3 , targeting 9.3, I get Module compiled with Swift 2.3 cannot be imported in Swift 3.0 error, even with Use Legacy Swift Language Version set to YES\n. @nuclearace \nYou are right, but If that the case, then why it works when I set the Deployment target to 10, but not when 9.3 is selected in the project it self?\n. Ok,\nI fixed it by clicking the + sign under Build Phases on the left upper corner, and choosing  \"New Copy Files Phase\" , and picked Framework as Destination, then added SocketIO.framework under that.\n. ",
    "Gagster": "Hi, Where can I get the version 8.0.1?\nI've tried to use pod, but it saids that the latest one is 8.0.0 \n: (  plz Help~\n. so did I! Can't down load 8.0.2 with pod\n. ",
    "legel": "I think it may have to do with namespaces...\n. Indeed!  For whatever reason, I removed the namespace declaration in the Swift code previously, but I added it back with the argument .nsp(\"/chat\") in SocketIOClient() and it's back online!\nlet socket = SocketIOClient(socketURL: URL(string: \"https://example.com\")!, config: [.log(true), .forcePolling(true), .nsp(\"/chat\")])\n. ",
    "dmiedema": "FWIW I was just successful with updating/building ObjC target with 8.0.2\nI did run pod repo update to ensure I had the latest specs\n\nPodfile  (with some details removed) and Cocoapods version\n\nsh\n\u276f pod --version\n1.0.1\n``` rb\nUncomment this line to define a global platform for your project\nplatform :ios, '9.0'\ninhibit_all_warnings!\ninstall! 'cocoapods', :deterministic_uuids => false\ndef shared_pods\n  [list of pods shared between targets]\nend\ndef shared_test_pods\n  [shared pods for tests]\nend\ntarget 'Target2' do\n  platform :ios, '9.0'\n  # Uncomment this line if you're using Swift or would like to use dynamic frameworks\n  use_frameworks!\n# Pods for Target2\n  shared_pods\n# Web Sockets\n  pod 'Socket.IO-Client-Swift', '~> 8.0.2'\n [other pods]\ntarget 'Target2 Tests' do\n    inherit! :search_paths\n    shared_test_pods\n  end\ntarget 'Target2 UITests' do\n    inherit! :search_paths\n  end\nend\ntarget 'Target1' do\n  platform :ios, '8.0'\n  # Comment this line if you're not using Swift and don't want to use dynamic frameworks\n  use_frameworks!\n# Pods for Target1\n  shared_pods\ntarget 'Target1 Tests' do\n    inherit! :search_paths\n    shared_test_pods\n  end\nend\n```\n\n\nBoth targets contain no swift aside from SocketIO-client-swift in Target2\n. ",
    "EstefaniaTenntaDiaz": "thanks!, this work for me :D \nlet socket = SocketIOClient(socketURL: URL(string: \"http://localhost:5000\")!, config: [.log(true), .forcePolling(true), .connectParams([\"user_id\": \"myuserid\", \"otherparam\": \"otherparam\"])])\n. ",
    "Samuel-liuse": "supplement\nI check the sdk ,i find\nNSURL* url = [[NSURL alloc] initWithString:stringUrl];\nself.socket = [[SocketIOClient alloc] initWithSocketURL:url config:@{@\"log\": @YES, @\"forcePolling\": @YES}];\nthis two lines could not perform the swift fuc:\npublic init(socketURL: NSURL, config: SocketIOClientConfiguration = [])\non the phone,but still work well on simulator.\nOn Monday i need to release the version to appStore,please help...\n. ",
    "Praphin": "Same issue here. Please help me out\n. Worked.\nself.socket emitWithAck:@\"canUpdate\" with:@[@{ @\"email\"  : @\"test\",\n                                                       }];\nThanks u so much :)\n. ",
    "Krystel": "I'm facing the same issue with the init in Objective-c. It doesn't seem to connect.\nDid anyone find a solution yet? \n. ",
    "emrekilic": "This my socket settings. Are there anything wrong in this code block? I just copy pasted from README.md and i only changed event name to \"data\" from \"currentAmount\".\n```\noverride func viewDidLoad() {\n        super.viewDidLoad()\n        // Do any additional setup after loading the view, typically from a nib.\n        let socket = SocketIOClient(socketURL: NSURL(string: (\"http://192.168.1.100:3000\"))!, config: [.Log(true), .ForcePolling(true)])\n    socket.on(\"connect\") {data, ack in\n        print(\"socket connected\")\n    }\n    socket.on(\"data\") {data, ack in\n        if let status = data[0] as? String {\n            print(status)\n        }\n    }\n    socket.connect()\n}\n\n```\n. You absolutely right about it. Now i tried and working flawlessly. Thanks for your efforts. This issue can be close now. It was my fault.\n. \u00d6rnek kodlar\u0131 oldu\u011fu gibi viewdidload a yap\u0131\u015ft\u0131rmaktan oluyor bu hata. socket de\u011fi\u015fkeni global tan\u0131mlanmal\u0131. \u015eu \u015fekilde;\nvar socket: SocketIOClient?\noverride func viewDidLoad() {\n        super.viewDidLoad()\n        // Do any additional setup after loading the view, typically from a nib.\n        socket = SocketIOClient(socketURL: NSURL(string: (url))!, config: [.Log(true), .ForcePolling(true)])\n    socket!.on(\"connect\") {data, ack in\n        print(\"socket connected\")\n    }\n    socket!.on(\"data\") {data, ack in\n        if let status = data[0] as? String {\n            print(status)\n        }\n    }\n    socket!.connect()\n}\n\nBu \u015fekilde kullanabilirsin. Adam\u0131m?!?!?. O zaman benim kar\u015f\u0131la\u015ft\u0131\u011f\u0131mdan daha farkl\u0131 bir hatan var demektir. Log dan anlayamad\u0131m ben hatay\u0131. Yeni bir issue a\u00e7arsan yard\u0131mc\u0131 olurlar. Kolay gelsin. ",
    "mohammedalicelik": "Emre, yardim etsene bi adamim. Bi cikaramadim. Sen simdi neyi deyistirdin? @emrekilic @emrekilic . How did you make the callback on the emit @patriksharma . use .extraHeaders. ",
    "wangiv2": "after add below code in the end of pod file is resolved\n\npost_install do |installer|\n installer.pods_project.targets.each do |target|\n     target.build_configurations.each do |config|\n         config.build_settings['SWIFT_VERSION'] = '3.0'\n     end\n end\n\n. ",
    "TaoistKing": "More Information:\nWhen a iPhone 6Plus is connected to my Mac, the building will succeed, but will crash upon launch:\n\ndyld: Library not loaded: @rpath/SocketIOClientSwift.framework/SocketIOClientSwift\n  Referenced from: /var/containers/Bundle/Application/0398A438-1B83-4F89-AA83-EDFE6E38C4EF/Chatchat.app/Chatchat\n  Reason: image not found\n\nWhen a iPhone 5c is connected to my Mac, the building will fail with errors above:\n\nld: warning: Auto-Linking supplied '/Users/xiaoming/Library/Developer/Xcode/DerivedData/Chatchat-cbljmmhhqfbdjoeqrkgtasbkniad/Build/Products/Debug-iphoneos/Socket.IO-Client-Swift/SocketIOClientSwift.framework/SocketIOClientSwift', file was built for arm64 which is not the architecture being linked (armv7): /Users/xiaoming/Library/Developer/Xcode/DerivedData/Chatchat-cbljmmhhqfbdjoeqrkgtasbkniad/Build/Products/Debug-iphoneos/Socket.IO-Client-Swift/SocketIOClientSwift.framework/SocketIOClientSwift\nUndefined symbols for architecture armv7:\n\"OBJC_CLASS$__TtC19SocketIOClientSwift14SocketIOClient\", referenced from:\nobjc-class-ref in ContactsTableViewController.o\nld: symbol(s) not found for architecture armv7\n. Sorry about this issue, seems there is API changes from older versions , these errors no longer exist after I adapt to new APIs.\n. @kikolobo Maybe Not. I rebuilt socket.io framework with Xcode 8.1 beta3, and it works well Now.\nThere might be something different from Xcode 8.0 and 8.1, framework which built by 8.0 can't be used with 8.1.\n. \n",
    "wenssh": "this pr cause a new crash, see /issues/562. Can you review this pr again? thanks.\n. Came up with the same crash, the version is 8.1.1\n. ",
    "BhawnaBhandari24": "I am pretty new to socket programming.  The final goal is to load a webView which should go over mobile network. Should i be using WebSockets for that or is there any documentation i can go through before trying to address the issue.\n. I tried this but when i switch to wifi the request does not route through mobile network\nsocket = SocketIOClient(socketURL: URL(string: \"https://xxx.xxx.xxx:22790\")!, config: [.log(true),.secure(true),.path(\"/vzconnect/cdi/v1/authorize/\"),.connectParams([\"auth_request\":\"ew0KCSJpc3MiOiAiNjg2MzNjYjMtZjFhNy00MDJiLWFjZDMtYjAzMDZiYjY5MWQwIiwNCgkiYXVkIjogImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC92emNvbm5lY3QvIiwNCgkiY2xpZW50X2lkIjogIjY4NjMzY2IzLWYxYTctNDAyYi1hY2QzLWIwMzA2YmI2OTFkMCIsDQoJInJlZGlyZWN0X3VyaSI6ICJodHRwOi8vZXhhbXBsZS5jb20iLA0KCSJzY29wZSI6ICJvcGVuaWQiLA0KICAgICAgICAicmVfdHlwZSI6InRlIiwNCgkibm9uY2UiOiAibi0wUzZfV3pBMk1qIiwNCgkiZXhwIjogMTU3Nzg2NTYwMDAwMCwNCgkic2lkIjogIjUxZjY3MTRiLTIzZGYtNDYwMC04MTI2LWU2NjM3OWZjZjgyNiIsDQoJImNkaSI6IHsNCgkJIm1lcmNoYW50aWQiOiAiMjAxNDUwIiwNCgkJIm1lcmNoYW50bmFtZSI6ICJOaWtlIiwNCgkJImltX3VzZWNhc2UiOiAibWMiDQoJfSwNCgkiY3B1YiI6IHsNCgkJInZmcCI6ICI0ZDU0NTE3YTRkNDQ1OTMyNGY0ODc3Nzg0ZDZhNDEzMTRkNDQ0MTc3NGQ3NzRlNmE1OTM1M2EwYjBkZjRiYWI3ZDFkMDFlYWZkNmQ4Y2IxMGM5ZTcwNTlmOGQxZDZhZDA5MDA5MjRkNjE2MmViOGIxYWQzMWU0Ig0KCX0NCn0=\",\"r\":\"f\"])])\n        socket?.on(\"connect\") {data, ack in\n            print(\"socket connected\")\n        }\n        socket?.connect()\nOn mobile network : \nI am getting the response\nOn wifi : \n2016-09-30 11:29:18.664474 MobileIDOverWifi[815:146386] [] nw_socket_connect connectx failed: [64] Host is down\n2016-09-30 11:29:18.666594 MobileIDOverWifi[815:145950] ERROR SocketEnginePolling: Could not connect to the server.\n2016-09-30 11:29:18.666803 MobileIDOverWifi[815:145950] ERROR SocketEngine: Could not connect to the server.\n2016-09-30 11:29:18.666950 MobileIDOverWifi[815:145950] ERROR SocketIOClient: Could not connect to the server.\nLet me know if something can be done.\n. ",
    "martinpfannemueller": "I cannot compile at the moment either. I suppose we have the same problem. Xcode wants me to convert the Swift code to version 3.0. However, as you state you are already using Swift 3. I am using Cocoapods version 1.1.0.rc.2 and I require version 8.0.2. I e.g. tried to remove the Pods folder and use \"pod install\" as well as setting the build target to iOS 10 for testing. Any ideas?\nEDIT: Okay I could fix my problems by looking into issue #500 \nI had to delete the Pods folder, the workspace file as well as the derived data of Xcode. Then I ran \"pod install\" again. I was still asked about transforming the code to Swift 3 but this time Xcode suggests to simply set the current used swift version in my project settings to 3.0\nAfter that everything works again!\n. ",
    "maximoufaev": "I have cleared it up. I had to change the projects minimum target to iOS 10.0 and that cleared out all the swift issues. \n. ",
    "aksperiod": "+1\n. @nuclearace I am using Xcode 8 beta 6 and getting the same errors when trying to build. I am upgrading to Xcode 8 release version and I will let you know what happens.\n\n. Upgraded to Xcode X release, same problem.\nSame as @petemillermultimedia my podfile included:\npod 'Socket.IO-Client-Swift', '7.0.3'\n. Ah, thanks a bunch.\nFor anyone else who finds this problem use:\npod 'Socket.IO-Client-Swift', :git => 'https://github.com/socketio/socket.io-client-swift.git', :branch => 'swift2.3'\n. ",
    "RozenAstrayChen": "i slove this problem , i download  file and copy to my project will be used! Thx\n. ",
    "NiravJariwala": "I am facing same issue.. and keep trying but unable to figure out..!!\nAny help..??\nThanks\n. ",
    "skparticles": "Guys,\n  It is very critical for us to fix. Anybody fixed the similar issue. \n. Socket URL = http://dev.ourappurl.com\nIn our Android Client, we have pointed with the above URL it works. But in iOS same URL with no response including any error.\nAndroid Code:\n```\nString socketServerURL = \"http://dev.ourappurl.com\";\nIO.Options opts = new IO.Options();\n        opts.forceNew = false;\n        opts.reconnection = true;\n        opts.reconnectionDelay = 50000;\n    Log.i(\"Socket.io\",\"Init\");\n    Socket mSocket = IO.socket(socketServerURL,opts);\n\n    mSocket.on(Socket.EVENT_CONNECT,onConnect);\n    //  mSocket.on(\"time\",onTime);\n    mSocket.on(Socket.EVENT_DISCONNECT,onDisconnect);\n    mSocket.on(Socket.EVENT_CONNECT_ERROR, onConnectError);\n    mSocket.on(Socket.EVENT_CONNECT_TIMEOUT, onConnectError);\n    //SK - Debugging Channel\n    mSocket.connect();\n\n```\n@nuclearace \n1. \" If /parse is the socket.io path, it needs to be set via the .path(String) option\"\nWe have removed parse and it is working on the Android.\n2.\"Also a log would help.\"\nMay I know, which log that I can share.\n. XCode log \nSocketIOClient: Adding engine\n2016-10-05 18:20:49.419248 SocketIOSwiftInObjectiveCProject[2208:762110] LOG SocketEngine: Starting engine. Server: http://dev.ourappurl.com\n2016-10-05 18:20:49.419329 SocketIOSwiftInObjectiveCProject[2208:762110] LOG SocketEngine: Handshaking\n2016-10-05 18:20:49.420437 SocketIOSwiftInObjectiveCProject[2208:762110] LOG SocketEnginePolling: Doing polling request\n2016-10-05 18:20:49.420630 SocketIOSwiftInObjectiveCProject[2208:762110] LOG SocketIOClient: Client is being released\n2016-10-05 18:20:50.698697 SocketIOSwiftInObjectiveCProject[2208:762110] LOG SocketEnginePolling: Got polling response\n2016-10-05 18:20:50.701794 SocketIOSwiftInObjectiveCProject[2208:762172] LOG SocketEngine: Got message: 0{\"sid\":\"hfTV_NDObTszUdq7AAAl\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2016-10-05 18:20:50.704848 SocketIOSwiftInObjectiveCProject[2208:762172] LOG SocketEngine: Writing poll:  has data: false\n2016-10-05 18:20:50.705306 SocketIOSwiftInObjectiveCProject[2208:762172] LOG SocketEnginePolling: Sending poll:  as type: 2\n2016-10-05 18:20:50.707294 SocketIOSwiftInObjectiveCProject[2208:762172] LOG SocketEnginePolling: Created POST string: 1:2\n2016-10-05 18:20:50.709240 SocketIOSwiftInObjectiveCProject[2208:762172] LOG SocketEnginePolling: POSTing\n2016-10-05 18:20:50.709410 SocketIOSwiftInObjectiveCProject[2208:762172] LOG SocketEngine: Engine is being released\n. Attached SocketIOSwiftInObjectiveC Xcode Project.\nhttps://drive.google.com/file/d/0B1jfEVVBBWQeaGlvMUJMNDNXVGM/view?usp=sharing\nFixed broken link\n. Sorry, How can I make it correctly?  It is connecting well with Android client for the past one month. During prototype, I have tested with previous swift version, it works well.  Where I need to update in the sample project that I have attached.\n. Now I got it. I have declared property in class level and working fine. Thankyou so much. \n. https://drive.google.com/open?id=0B1jfEVVBBWQeMHlqVFlRNHpMS1U\nFixed version of SocketIOSwiftInObjectiveC XCode Project. So that it may helpful to others.\n. Thanks. I don't know much about swift. May I know, how to add callback method in Objective-C version. \n. I think this the correct version of Objective-C in readme file\n```\n[socket on:@\"currentAmount\" callback:^(NSArray data, SocketAckEmitter ack) {\n             double cur = [[data objectAtIndex:0] floatValue];\n         OnAckCallback *callback = [self.socket emitWithAck:@\"canUpdate\" with:@[@(cur)]];\n\n         [callback timingOutAfter:0 callback:^(NSArray* data) {\n             [socket emit:@\"update\" with:@[@{@\"amount\": @(cur + 2.50)}]];\n        }];\n          [ack with:@[@\"Got your currentAmount, \", @\"dude\"]];\n        }];\n\n```\n. Got solution \nServer Code\n```\nsocket.on('chatMessage',function(data,fun){\n    var to;\n     var jsonObject;\n    jsonObject = JSON.parse(data);\n    console.log(\"Chat JsonObjectParsed :\" + jsonObject);\n    to = jsonObject.to;\n     console.log(\"to :\" + to);\n     fun(data);\n  });\n```\nClient Code Working\n```\nNSError *error;\nNSDictionary *sendDict = [NSDictionary dictionaryWithObjectsAndKeys:\n                             @\"6NEYPCHZJt\",@\"to\",\n                             nil];\nNSData *sendDictData = [NSJSONSerialization dataWithJSONObject:sendDict options:NSJSONWritingPrettyPrinted error:&error];\nNSString *sendDictDataJsonString = [[NSString alloc] initWithData:sendDictData encoding:NSUTF8StringEncoding];\nNSArray *array = [NSArray arrayWithObjects:sendDictDataJsonString, nil];\nOnAckCallback callback = [self.socket emitWithAck:@\"chatMessage\" with:array];\n[callback timingOutAfter:5 callback:^(NSArray * callbackArray) {\n                NSString responseDictDataJsonString = callbackArray[0];\n                NSError jsonError;\n                NSData objectData = [responseDictDataJsonString dataUsingEncoding:NSUTF8StringEncoding];\n                NSDictionary *json = [NSJSONSerialization JSONObjectWithData:objectData\n                                                                  options:NSJSONReadingMutableContainers\n                                                                    error:&jsonError];         \n                NSLog(@\"Response String %@\",responseDictDataJsonString);\n                NSLog(@\"Response to = %@\",[json objectForKey:@\"to\"]);\n}];\n```. To run socket.io continuously( Since my app is VOIP app). I have added background task Audio to run.  It is running now.. I think this is still an issue. Because before, I can able to add code directly and everything working fine. Now I can't able to add code directly.  This one blocks to upgrade my entire project. . I managed to update all other pod files successfully and updated latest socket.io server also. The only problem of adding Socket.IO-Client-Swift 11.0.2 either by manual or by a pod. . When I use use_frameworks! it creates issues in ParseUI pod and Google Speech pod. I can able to fix google speech pod but can't fix ParseUI pod. \nMy only option to upgrade my ios client needs to add code directly. Any way that I can add code directly?https://github.com/socketio/socket.io-client-swift/issues/767. I have commented import StarscreamSocketIO but it is showing error on commenting \n1.CZLib and \n2.CommonCrypto\nSocket.IO.11.0.2_Except_CZLib_And_CommonCrypto.zip\n. I will try but am not that expert. Is there is any way to export library as a framework?. So that I can include as a framework instead of source code. Something similar to ParseUI having options to download as framework https://github.com/parse-community/ParseUI-iOS/releases/tag/1.1.7. . This how we do for Parse-SDK-iOS-OSX https://github.com/parse-community/Parse-SDK-iOS-OSX\nCompiling for yourself\nIf you want to manually compile the SDK, clone it locally, and run the following commands in the root directory of the repository:\nTo pull in extra dependencies\n git submodule update --init --recursive\nTo install all the gems\n bundle install\nBuild & Package the Frameworks\n rake package:frameworks\nCompiled frameworks will be in 2 archives: Parse-iOS.zip and Parse-OSX.zip inside the build/release folder, and you can link them as you'd please.. My friend helped me to move socket.io source code from pod to an swift project(without pod). From there I managed to import inside my objective-c project.\nsocketIos.zip\n. ",
    "kikolobo": "Found same issues here... I am getting lots of thread sanitizer warnings:\nThis is most likely because something is called from different threads.\nMy warnings occur around the public func doPoll() { in the: SocketEnginePollable.swift file\n\nheres the extended info from LLDB debugger:\n``` son\n\"stop_description\" : \"Data race detected\",\n  \"summary\" : \"Data race in SocketIO.SocketEngine.waitingForPoll.getter : Swift.Bool at 0x7d4400000b40\",\n  \"threads\" : [\n    {\n      \"index\" : 0,\n      \"name\" : \"\",\n      \"parent_thread_id\" : 0,\n      \"running\" : 1,\n      \"thread_id\" : 12,\n      \"thread_os_id\" : 498251,\n      \"trace\" : [\n  ]\n},\n{\n  \"index\" : 1,\n  \"name\" : \"\",\n  \"parent_thread_id\" : 17,\n  \"running\" : 1,\n  \"thread_id\" : 17,\n  \"thread_os_id\" : 38912,\n  \"trace\" : [\n\n  ]\n}\n\n],\n  \"unique_tids\" : [\n```\n. This is really annoying and hard to debug. I simplified the socket and still get this error randomly but constantly. I am targeting iOS9 and using iPad simulator. Also I am using Swift 3.\n. @rehsals \n\nI think thread sanitizer works only with simulator but it can be on during a running app. That was the way I found out about mentioned data races.\n\nYes it can be on while running the app. (that's the whole point of the sanitizer) You have to enable the threadSanitizer in the scheme. It will not be available if you are compiling with legacy swift 2.x .. Only pure objective-c and/or Swift 3.\nIt will show on runtime errors sub tab in the messages/error tab in xCode.\nOnce enable connect to a server and send some traffic to see the threadSanitizer fire. This is an important issue that affects the stability of all the app if it is not fixed soon.\nping: @nuclearace \n. @nuclearace   It seems the issue is at polling. If I use .forceWebsockets(true) option on connect the race condition only occurs when trying to reconnect again if for some reason I disconnect. Or when pinging/ponging:\n\n\n. @nuclearace  Il take a look and try to test.. Thanks for the comment.\n. @nuclearace Not on that line.. I tried it and it didn't fixed it.  I am searching elsewhere but I don't have a lot of context of the code at this point. Hope we can solve this soon. It randomly produces crashes.\nSpecially on reconnects.\n. Question: Why are you dispatching to all those queues? Why not only dispatch on callbacks or closures?  All that threading sounds hard to keep track what happens where and the performance gains might be killed by the thread problems.\n. Re-using engine did not fixed race condition. Hope this can get fixed soon.\nI am suspecting one fix could be to use only one queue for dispatch and that that queue is not the main thread.\n. @nuclearace Hi.. Just checking.. No new developments here? This have potential to crash the whole app... Would be important to fix to be able to use the code in production ready app.\n. \ud83d\ude15\n. Can you turn on Thread Sanitizer in XCODE. This crash might be related to:\nhttps://github.com/socketio/socket.io-client-swift/issues/531\nIt looks like an object is being deallocated before it is used : EXC_BAD_ACCESS\n. I think this is very possible... Even if wait time is not 0.. Remember that race condition does not mean that things happen at the same time, it means that the same thing happens on multiple threads. So I guess this method should only be called from one thread?\n. ",
    "DevKang": "note\nconnection address is not real\n. @nuclearace thanks for asking :) \nthis url is using in other project already(Android application). and i used this repo in my project, and it works with this url with secure option is false.\nAny other suggestions? Im suffering from this problem for my all day...\n. No We dont use path we use IP Addres + Port only\n. Port is same. and server use socket.io v0.9.16\n. :( Oh... yep..  That`s too sad... can u recommend me other repo for lower socket.io version ??\n. ",
    "iphonist": "check the 'edit scheme'. whether debug-mode or not . ",
    "VergaraF": "Which is the latest version? I even did pod update and it still gives me the option to upgrade from 2.3 to 3 and lots of errors after doing so.\n. Import the Swift files manually, that would do it. Not the best choice, but it seems to fix it just fine.\n. ",
    "CraftLogan": "I am having the same issue. It wants to upgrade from 2.3 to 3.0 and then many errors appear. I also have the latest pods version. Any ideas?\n. ",
    "chunxige": "but it doesn't work ,i met same error\n. xcode 8.2.2. thanks a lot ,I solved the problem by  updating to latest version. ",
    "cms5x": "If using Cocoapods, in your Podfile try to use this: - Socket.IO-Client-Swift (fromhttps://github.com/socketio/socket.io-client-swift, branchswift2.3) instead of ~> 7.0.3 as the swift2.3 branch seems to have some changes ahead of 7.0.3\n. ",
    "szuniverse": "What kind of dependecies?\n. Thanks\n. ",
    "snehasen1990": "\nfacing same issue!!!!. ",
    "DonorRaja": "facing same issue my also any one plz help .... ",
    "pmusolino": "Hi, how you solved?. I don't understand if is possible for an app that use the v.1 of socket.io-client-swift to connect to a server that use the v.2. Do you have any suggestion about it? . I try to explain in a simple way:\ni have this method\nself.socket?.on(\"message\", callback: { (data, ack) in\n            //do something with data\n        })\nand 4 view controllers allocated where this method is used (we can imagine that is implemented in every viewDidLoad).\nWhen the server emit a \"message\", on the client side i receive, on every handler on \"message\", 4 responses. 4 responses X 4 handlers = 16 identical responses. The question is: there is a simple way to register every on handler only one time? The result that i want is to have only one response for every handler (a total of 4 event, one for every handler \"message\").\n. It's the method I currently use, but I thought there was some cleaner method to fix the \"problem\" :). Same problem here after library update to Socket.IO-Client-Swift 11 (was 10.0.1).\n\n. This:\npod 'Alamofire', '~> 4.5'\n  pod 'PromiseKit', \"~> 4.2\"\n  pod 'KeychainAccess', '~> 3.0.1'\n  pod 'IQKeyboardManagerSwift', '~> 4.0'\n  pod 'SwiftyBeaver', '~> 1.3'\n  pod 'MGSwipeTableCell', '~> 1.5'\n  pod 'DZNEmptyDataSet', '~> 1.8'\n  pod 'SideMenu', '~> 2.3'\n  pod 'Jibber-Framework', '~> 2.0', :configurations => ['Debug']\n  pod 'Fabric'\n  pod 'Crashlytics'\n  pod 'PullToRefresher', '~> 2.0'\n  pod 'OneSignal', '>= 2.5.2', '< 3.0'\n  pod 'ObjectMapper', '2.2.7'\n  pod 'Kingfisher', '3.10.2'. You can fix the problem cleaning the project and removing derived data.. I noticed that it happens even if you have another open Xcode project that uses Socket.IO (eg the demo project).\n. ",
    "Shayeeb": "Thanks for your help.Somehow a dictionary with optional phone number value was being created and it was creating the issue.\n. ",
    "slashmo": "I could luckily fix this one on my own. The trick was to add RxCocoa to the Link Binaries with Libraries section of my UnitTest target as well.\n. ",
    "alibinpasha": "I have a question related to this ? \nI am currently working on Chat Application, how can i send my Image file as buffer\n. ",
    "icykey": "I am getting the same error...\n. I think the crash happens because we are passing in 'self' as NSURLSessionDelegate.  This did work before though.   I was able to workaround this by creating a separate NSURLSessionDelegate Class, then set the config parameter like this.\n[parameter setObject:[[mySessionDelegate alloc]init] forKey:@\"sessionDelegate\"];\n. I don't have this problem, my application keeps a singleton of SocketIOSwift object around. deInit is never called... why are you calling deinit? Try setting the mySessionDelegate to nil before deinit.\n. ",
    "pikciu": "I think you should update your README :P \npod 'Socket.IO-Client-Swift', '= 7.0.3'\ndidn't work for me (idk why). I had to use:\npod 'Socket.IO-Client-Swift', :git => 'https://github.com/socketio/socket.io-client-swift.git', :branch => 'swift2.3'\nFunny thing is that in both cases it installed v7.0.3...\nI cannot update to swift 3. I'm using few pods and not all of them supports swift 3 :/\nAnyway thanks for info.\n. ",
    "AndySoHotRightNow": "Thanks for getting back Eric.\nUpdated to the latest version (8.1.1) and still not receiving an ack when timeout is 0\n```\nself.client.emitWithAck(\"read\", message.id).timingOut(after: 0) {data in\nprint(\"Ack received? :( \")\n}\n```\nBut receiving it when timeout >0.\n```\nself.client.emitWithAck(\"read\", message.id).timingOut(after: 1) {data in\nprint(\"Ack received! :) \")\n}\n```\nDoes it work with your code when you set the timeout to 0?\n. ",
    "iHunterX": "` public func timingOut(after seconds: Int, callback: @escaping AckCallback) {\n        guard let socket = self.socket else { return }\n```\n    socket.ackQueue.sync() {\n        socket.ackHandlers.addAck(ackNumber, callback: callback)\n    }\nsocket._emit(items, ack: ackNumber)\n\nguard seconds != 0 else { return }\n\nlet time = DispatchTime.now() + Double(UInt64(seconds) * NSEC_PER_SEC) / Double(NSEC_PER_SEC)\n\nsocket.handleQueue.asyncAfter(deadline: time) {\n    socket.ackHandlers.timeoutAck(self.ackNumber, onQueue: socket.handleQueue)\n}\n\n}`\n```\nHis code here\nHave to put some time for sv to return \n. ",
    "pablogeek": "I have the same problem. Has anyone solved this?. @maksTheAwesome Have you figured it out? I'm having the same problem. ",
    "martinprot": "Hi\nPlease try with the Xcode project enclosed in my previous message.\nI tried to manually include socket.io sources in my project. Xcode tries to convert to Swift 3, and says \"no source need to be changed\", and it compiles correctly.\nI have the feeling there's a problem with the cocoapod project configuration\nAh, and i'm using XCode 8.1 GM, don't know if related.\n. Thanks for your feedback, please tell me when it's merged !\n. Yes, I can confirm, the problem is solved ! \ud83d\udc4d\n. ",
    "lazarte": "Using Socket.IO-Client-Swift (6.1.2) from pod have this issue. Yes I'm connecting to the primus with socket.io transformer. I got an message from the server so meaning the handshake is successful?. Actually that message emit from our server. Manually added this code from this pull request 489 seems to trigger the connect event?. @nuclearace below is the code for the primus server don't know why the client doesn't trigger the connect event. On the other hand using socket.io works fine. But want to know why its not working with the primus.\nvar Primus = require('primus')\nvar primus = Primus.createServer({\n  port: 3002, transformer: 'websockets'\n});\nprimus.on('connection', function (spark) {\n  spark.write({\"type\":0,\"data\":[\"@HandShake\",\"Hello\"]});\n});. ",
    "TestSmirk": "this same to me. Fixed?. restart XCode is fine to use . xcworkspace file.. ",
    "bogdanbalta": "It was an issue after updating pods, it was badly compiled. Cleaning, remaking and recompiling pods project after update from 8.0.2 to 8.1.1 fixed this issue.\n. ",
    "huangrun": "The network indicator in the status bar is rotating all the time because i use cocodpods to install the library,I find that install the library manually will solve the problem.I want to know whether someone have the problem? and how to solve it perfectly,thanks!\n. ",
    "ridvank": "I have the same issue here on XCode 8.1. App is crashed when disconnect.\n. ",
    "kirualex": "any way to mitigate the crash in the meantime?. ",
    "dominikweifieg": "Same exception thrown here.\n. Ok, did some more debugging. The problem is parseQueue.sync in the engineDidClose function of SocketIOClient.\nThe engineDidClose function is called by two threads at the same time and the parseQueue.sync then blocks both threads.\nHere is the first thread:\n\nAnd here the second:\n\nAs @michaelfreund wrote, changing parseQueue.sync to parseQueue.async solves the problem. Both threads will arrive in the function and both will trigger an asynchronous removeAll on the waiting packets. \nAnother solution would be to make sure that SocketIOClient.engineDidClose gets called only once, which in turn means that SocketEngine.closeOutEngine gets called only once. It currently gets called twice SocketEngine.disconnect, once through the call to disconnectPolling and once directly in the guard condition at the beginning of the function.\n. ",
    "michaelfreund": "Same issue here with 8.1.1, Xcode Version 8.1 (8B62) and Swift 3.\nWe're using https://github.com/facundoolano/socketio-auth on the server side to manage socket authentication. If authentication fails, the server will emit \"unauthorized\" and close connection.\nWe're receiving the event emitted from the server with socket.on(\"unauthorized\"), but immediately after that, the app crashes on the same line as seen in the screenshot by @jayjac.\n. In SwiftIOClient.swift either adding attributes: .concurrent to\nswift\nprivate let parseQueue = DispatchQueue(label: \"com.socketio.parseQueue\", attributes: .concurrent)\nor changing parseQueue.sync to parseQueue.async in public func engineDidClose did solve the problem.\nBut I'm very new to Swift & iOS development. So i'm not quite sure, let's say ... what I'm doing \ud83d\ude48\nAny help would be highly appreciated\n. ",
    "jayjac": "I haven't been able to reproduce the crash so it seems like it's been fixed.\nThanks.. ",
    "crickabhi": "(Swift)I am also facing the same issue.\n. 1.4.8\nOn Tue, Nov 8, 2016 at 10:56 AM, friendlynandy notifications@github.com\nwrote:\n\n1.4 and it was working fine before i upgraded to Xcode 8.\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/564#issuecomment-259049068,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AKKeMdetonMeJ_K7WR98JZiiOHC_QpEgks5q8AgbgaJpZM4KrEYl\n.\n. I can get you the ngix log from the server. Whenever this happens I see lot\nof connect timeout request and just after that polling request which go in\nan infinite loop.\n\nOn 09-Nov-2016 5:59 pm, \"Erik Little\" notifications@github.com wrote:\n\nIf you have the ability to turn on logging in the server, I'd recommend\nseeing what's going on.\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/564#issuecomment-259403811,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AKKeMcoCKcWff6iqLD5cz9NKNUZh8ubWks5q8byigaJpZM4KrEYl\n.\n. In recent times after I had upgraded to xcode 8 swift 2.3.\n\nOn 09-Nov-2016 6:38 pm, \"friendlynandy\" notifications@github.com wrote:\n\n@crickabhi https://github.com/crickabhi From when your are facing this\nproblem?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/564#issuecomment-259410638,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AKKeMc9ARu7YeKtw4pU93iCVd7RZK3YZks5q8cXNgaJpZM4KrEYl\n.\n. v6.1.2 and it is same now as well.\nI think so that the problem is only with emit.\n\nOn 09-Nov-2016 6:47 pm, \"friendlynandy\" notifications@github.com wrote:\n\n@crickabhi https://github.com/crickabhi What was the version you were\nusing then and now.\nIs the problem only with emit?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/564#issuecomment-259411613,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AKKeMf9jbQFmXj9NGPK3x8-eIe92L80Jks5q8ccLgaJpZM4KrEYl\n.\n. When socket!.emitWithAck(event, emitData) events are fired one after another, it disconnects the ongoing valid socket connection and then reconnects but with different session id. \nPlease help me out in using the valid old socket connection without disconnecting it.\n. \n",
    "friendlynandy": "1.4 and it was working fine before i upgraded to Xcode 8.\n. @nuclearace  I was using socket.io-client-swift v6.1.4 before .\nI tried v6.1.4 too.\nBut same error on both sending and receiving messages. But receiving successful connect event is fine but not on new message event. Please help its bit urgent.\nThank you.\n. But there was no changes in server from long time. It was working fine.\n. @crickabhi From when your are facing this problem? \n. @crickabhi What was the version you were using then and now?\nIs the problem only with emit?\n. ",
    "YoonChangKIM": "Has this issue been resolved yet?\nI also have same issue.\n2016-12-07 16:26:27.575467 xxx[5122:2083126] LOG SocketEnginePolling: Created POST string: 69:42[\"enterCounseling\",\"client\",\"xxx\",\"xxx\",4803,\"xxx\"]\n2016-12-07 16:26:27.575938 xxx[5122:2083126] LOG SocketEnginePolling: POSTing\n2016-12-07 16:26:27.576097 xxx[5122:2083126] LOG SocketEnginePolling: Doing polling request\n2016-12-07 16:26:47.074531 xxx[5122:2083363] LOG SocketEngine: Writing poll:  has data: false\nSocketEngine didn't recv 'polling response'. And then \n2016-12-07 16:26:59.864179 xxx[5122:2082751] ERROR SocketEnginePolling: Could not connect to the server.\n2016-12-07 16:26:59.864560 xxx[5122:2082751] ERROR SocketEngine: Could not connect to the server.\n2016-12-07 16:26:59.864829 xxx[5122:2082751] ERROR SocketIOClient: Could not connect to the server.\n2016-12-07 16:26:59.865209 xxx[5122:2082751] LOG SocketIOClient: Handling event: error with data: [\"Could not connect to the server.\"]\nSocket disconnected like this.. @nuclearace \nWhat is a socket.io server?\nAre you meaning not my server?\nIn my server, I using node.js. It includes SSL.\nThis problem occured with changing 'forever' to 'pm2'.\nIn 'forever' it works well. but in 'pm2' it doesn't work like above example.\nPlease help me... @nuclearace \nThank you.\nBut I think your feedback is in case there is a problem with the server.\nI provide android app and web service, too.\nThey use socket.io, too.\nBut only occured this problem in iOS..\nI don't know why... ",
    "RahulKasar": "Hi,\nThanks for the response. Yes the server expects an acknowledgement. This issue occurs when two way communication starts and the communication happens with fraction of seconds i.e sending and receiving of continuos events from client and server.\nThanks\n. Hi ,\nI am using socketioclient swift 2.3 version\nI am initialising the socket with the following parameters \n SocketIOClient(socketURL: NSURL(string: connectionURL)!, config: [.Log(false), .ForceWebsockets(true), .ForcePolling(true), .SelfSigned(true) ,.Secure(true) ,.ConnectParams([\"token\" :currentUser.refreshToken ])]) \nSend Event \n``` swift\n sendEvent(event: String,emitData: NSDictionary, completionHandler:  (response: String?) -> Void) -> Void {\n  let ack = socket!.emitWithAck(event, emitData)\nack(timeoutAfter: 100, callback: { (response: Array?) -> Void in\n                let arrResp : NSArray? = response as? NSArray\n                if let str = arrResp?.firstObject as? String {\n                if str == \"NO ACK\" {\n\n\n                    let otherDesc = String(format: \"Event = %@ Error = %@\",event,str)\n\n\n\n                    completionHandler(response: nil)\n                } else {\n\n\n\n                    completionHandler(response: str)\n                }\n            } else {\n\n\n\n\n                NSLog(\"Unexpected response from server: \\(response)\")\n                completionHandler(response: nil)\n            }\n        })\n\n}\n```\nreceive server event in SocketEngine.swift\n``` swift\n  public func parseEngineMessage(message: String, fromPolling: Bool) {\n        DefaultSocketLogger.Logger.log(\"Got message: %@\", type: logType, args: message)\n    let reader = SocketStringReader(message: message)\n    let fixedString: String\n\n    if message.hasPrefix(\"b4\") {\n        return handleBase64(message)\n    }\n\n    guard let type = SocketEnginePacketType(rawValue: Int(reader.currentCharacter) ?? -1) else {\n        checkAndHandleEngineError(message)\n\n        return\n    }\n\n    if fromPolling && type != .Noop && doubleEncodeUTF8 {\n        fixedString = fixDoubleUTF8(message)\n    } else {\n        fixedString = message\n    }\n\n    switch type {\n    case .Message:\n        handleMessage(fixedString[fixedString.startIndex.successor()..<fixedString.endIndex])\n\n        **let socketServiceManager  : SocketServiceManager = SocketServiceManager()\n       socketServiceManager.didReceiveServerEvent()**\n\n    case .Noop:\n        handleNOOP()\n    case .Pong:\n        handlePong(fixedString)\n    case .Open:\n        handleOpen(fixedString[fixedString.startIndex.successor()..<fixedString.endIndex])\n    case .Close:\n        handleClose(fixedString)\n    default:\n        DefaultSocketLogger.Logger.log(\"Got unknown packet type\", type: logType)\n    }\n}\n\n```\nPlease provide your thoughts on this. \nThanks,\n. Hello ,\nThanks for the response. Can you please let me know what should be done for this issue. This is causing huge trouble in my application.\nThanks\n. ",
    "kilirushi": "Thanks you so much. I fixed it.\n. ",
    "ali-nawaz-dev": "Thanks for response.. I have connected socket with server as this\nstIOsocketClient = [[SocketIOClient alloc] initWithSocketURL:url config:@{@\"log\": @YES, @\"forcePolling\": @NO,@\"forceNew\":@YES, @\"connectParams\": @{@\"ns\": @\"/company/1\"}}];\nIt made connection with server and start emitting but server has no data or request to receive.\nPlease note \"/company/\" is a namespace.\n. ",
    "vshahpledge": "My emit call looked like this:\nlet authDict = [\"token\": self.keychainManager.token,\n                  \"version\": \"1.1.0\"]\n    self.io.emit(\"authentication\", authDict)\n. I've submitted a PR: #572 \n. You can see the issue here:\npublic func emit(_ event: String, _ items: SocketData...) {...}\npublic func emitWithAck(_ event: String, _ items: SocketData...) -> OnAckCallback {...}\nboth emit methods only accept arrays of SocketData.\n. In Swift when you define a parameter in a method like items: SocketData... items automatically becomes an array.\nfrom the docs:\nThe values passed to a variadic parameter are made available within the function\u2019s body as an array of the appropriate type.\nSo even for a single item passed in to the method (in my case, a dictionary) it gets stored in an array.\n. Turns out I was calling the wrong method in my own code. Instead of calling this I should've been calling this from my own methods since my own method already wrapped the arguments in an array.\nI apologize for my hastiness. Thanks for helping me troubleshoot this. I closed my PR since it's not necessary anymore.\n. ",
    "alims": "I used \"connectParams\".Its worked.Thx for your solution @mohammedalicelik . ",
    "robinqhuang": "It turns out token need to be as connectParams. ",
    "antwerpenR": "Thanks @nuclearace  - indeed Starscream does what I need.. ",
    "danscrim": "Okay, figured it out: It looks like the documentation on the README is wrong. \nThis is no longer valid:\n[socket emit:@\"update\" withItems:@[@{@\"amount\": @(cur + 2.50)}]]; \nInstead, it should be:\n[socket emit:@\"update\" with:@[@{@\"amount\": @(cur + 2.50)}]];\n. ",
    "dionifreitas": "Sorry. I found the error, i had used \"socket.use(function(socket, next){})\" (server-side) with two calls to \"next();\".\nSorry for the inconvenience.\n. ",
    "Meonardo": "@iHunterX I set the request timeout interval by myself.\nI store the request object in a container object, when I got a response I remove it from its container.\nSo the timeout count down by 0, I check the object if it exist in the container, if it do exist I think the request is TIMEOUT.(I m new to this if there is a callback method do tell me!)\n. ",
    "terenceLuffy": "Get the same error here, adding listening before connection doesn't change anything.. @nuclearace I think I find out the cause.\nThe steps are:\nCreate three sockets s1, s2, s3\ns1 connected event received, and then fire multiple emits\ns2 connected event received, and then fire multiple emits\ns3 connected event received, and then fire multiple emits\nso far all success\nthen after less than 30 seconds, I received \"[\"Ping timeout\"]\" for both s1 and s2, then it trigger reconnect event \"reconnectAttempt\" with attempted times and then it keeps failing for many times. During the retry, if s3 disconnected somehow, either s1 or s2 can connect. I can see different SocketEngine is created, three different web sockets are created, different urlRequests are created in each web socket object, but the three urlRequests are exactly pointed to the same server, no namespace is specified inside (only have namespace in data to be sent?) the request: \n\n { GET request, url wss://chs-somehost:8080/socket.io/?transport=websocket&token=Bearer%208Ba90vyzwmOQKVPCYsbQZSIq3prGbCFyJ2-jF3XlNnRZSOxtQdDn4JY5tzRiOqnBFRXSOjRfCQ0aSN4Y28OKGt5P5kXXRsG2BAn7r7j37hSVhQnZ45w5WnQjmbJ0QwhbIkSrlqvRDDT0AIahrb4TPmQCF0e0WYADXL00kpIoc6fqKbYUGz1QmJssHGueWv63a3YgU8fxG7TvIHrpdf1hqCX4ykHasY0PtfJDEjfyhoDAn8zbt6yZ7Y0Rn6KlffsDRj7fA39yg4jECMDcuY2iE2OIa9566jTCscbJq_-BNBAbS6zIwiaxhwloCLlJVuZzKYiSjbnX47JU543W2Q-PJ9WJLpYDm9dVw354nvyHTkvJz_NWV-hih3NVkjRwsAYSLOSFuKdcx_oGeeuFe9hRtyk9Q2g5reH3SIOiBjQPYeycRd0GlE0CHBNuo_wzYNLA }\n\nSo I think the reason is s1, s2 and s3 (same server different namespaces) fighting for the only one channel to connect with, do you have any idea what might happen? Or do you have any example for multiple namespaces in web socket connections? This issue only happens in iOS 8 and 9, not iOS 10.. I finally found the problem!!!!!!\nIn WebSocket class, there is a static queue private static let sharedWorkQueue = DispatchQueue(label: \"com.vluxe.starscream.websocket\", attributes: []), this queue is shared by all web sockets. This is the problem, the one who occupy this queue will kick other web sockets out, and this issue seems has been changed in iOS 10, that's why it only works in iOS 10.\n\n/\n Specify the dispatch queue upon which the client callbacks will be invoked.\n Passing NULL for the queue will prevent future callbacks from being invoked.\n * Specifying a dispatch queue using this API will unschedule the stream from\n * any run loops it had previously been scheduled upon - similarly, scheduling\n * with a runloop will disassociate the stream from any existing dispatch queue.\n /\n@available(iOS 7.0, *)\npublic func CFReadStreamSetDispatchQueue(_ stream: CFReadStream!, _ q: DispatchQueue!). @nuclearace He/she is asking why it receives multiple response for the same push. I guess the listener is added multiple times.. \n",
    "WangBoX": "step\uff1a\n1\u3001this.parsePollingMessage(str)\n2\u3001let str = reader.read(count: n)\n            handleQueue.async { self.parseEngineMessage(str, fromPolling: true) }\n\n3\u3001let readString = message[currentIndex..<message.characters.index(currentIndex, offsetBy: count)]\ncrash\uff1afatal error: cannot increment beyond endIndex. ",
    "shacharudi": "Did anyone found a solution for this?. I was having similar problems sending Emoji and Hebrew characters, using .forceWebsockets(true) solved it. thanks!. Thanks for your reply @nuclearace!\nDo you have an idea why my engine.io server will produce this error due to this code? this is happening consistently without performing any specific action on the client side.\nI don't know if other devs also faced this issue but would it be possible to add a flag that runs this code optionally?  (by default of course).. Thanks @nuclearace , I will try your debug suggestion and see if anything comes up.. ",
    "nguyenhunga5": "I have same error :(. ",
    "Lionyy": "temporary handle\uff1a\n```\n        let currentPosition = message.distance(from: message.startIndex, to: currentIndex)\n        let totalLength = message.distance(from: message.startIndex, to: message.endIndex)\n        let maxCount = min(count, totalLength - currentPosition)\n    let readString = message[currentIndex..<message.characters.index(currentIndex, offsetBy: maxCount)]\n\n    advance(by: maxCount)\n\n```\n        . Check your socketIO client configure follow your server:\nFor example\uff0c\n@\"forcePolling\":@NO,\n@\"forceWebsockets\":@YES,. ",
    "fulang0208": "thanks, i have resolve this problem,  i set force polling false, it correct. ",
    "sarankumar291": "@nuclearace Socket is stable on good internet connection like on 4g and faster wi-fi but when the device is connected to slower network, 3g and 2g socket connection is unstable. its getting disconnecting and reconnecting often. . ",
    "jfalexvijay": "Sorry, I forgot to mention... It is not happening in my phone.. It is happening only in my customers phone. I got this crash report from a bug reporter API.\nI will try to find out how to reproduce this issue.. ",
    "hsh0107": "log error. in swift 2.3 I init like this\n SocketInstance = SocketIOClient(socketURL: URL(string: NetWork.ShareInatance.urlPath(\"socketConnet\",type:.socket))!, options: [SocketIOClientOption.connectParams(dic as! [String : Any])]). just print error, I dou not know. in swift 3.0 let instance = SocketIOClient(socketURL: URL(string: \"\")!, config: [.connectParams([:])]) can not work . Yes\uff0cin swift 2.2 let instance = SocketIOClient(socketURL: URL(string: \"\")!, config: [.connectParams([:])]) \uff0cit work\uff0cbut I write with swift 3.0 I init let instance = SocketIOClient(socketURL: URL(string: \"\")!, config: [.connectParams([:])]) can not work\uff0cit does not work. ",
    "DreamcoffeeZS": "I send the  same chinese character sometimes it is correctly returned, sometimes it is messed up. \nthe message in http request is ok but when nodejs received , log print  or  send back are all messed up. And I can't find a patten how to repeat the bug. Sometimes ok sometimes not. half half chance . forceWebsockets(true)  DoubleEncodeUTF8 all tried, doesn't  work. problem still there. I am using v8.2.0 iOS  client.. latest version. ",
    "lazybetrayer": "I have the same problem, but in my case .forceWebsockets(true) fixes the problem.. ",
    "Saulenco": "the data that i receive is around the 2- 3 Mb\na small example \nNSInvalidArgumentException', reason: '*** NSAllocateMemoryPages(2261002) failed. Thanks dude that helped , i guess that my google search skills still suck :) . ",
    "andrebraga": "If you are using a self signed certificate you have to force using socket instead of upgrade negotiation. The way the library is currently structured, the option to accept self signed certs is passed straight to the socket engine, but your connection will fail at the URLSession level.. Sure, because you're not heeding @nuclearace 's advice:\n\nRight, because iOS doesn't allow background networking unless you have a certain permission enabled, and then you must start a background task.\n\nPlease read on background tasks on iOS and the iOS background permissions. Hint:\nUIApplication beginBackgroundTask(withName taskName: String?, expirationHandler handler: (() -> Void)? = nil) -> UIBackgroundTaskIdentifier. ",
    "hamin": "@rajeevwhiz is there a way to make this work without forcing web sockets only? Can the long polling transport be configured to be pinned to your ssl cert?. ",
    "ffleandro": "@rajeevwhiz How do I import SSLCert?\nIf your method works, it's exactly what I'm looking for.. found it. Had to import Starscream\nTried your code and it is complaining that I need to pass manager when constructing SocketIOClient.. I couldn't get your code to compile.\nFollowing the docs I've reached the following snippet:\n```\n        let  ca_cert = Bundle.main.path(forResource: \"ca\", ofType: \"cert\")\n        let  intermediate_cert = Bundle.main.path(forResource: \"intermediate\", ofType: \"cert\")\n        var certs = SSLCert\n        if let certificateData = try? Data(contentsOf: URL(fileURLWithPath: ca_cert!)) as Data {\n            let certificate = SSLCert(data: certificateData)\n            certs.append(certificate)\n        }\n    if let certificateData = try? Data(contentsOf: URL(fileURLWithPath: intermediate_cert!)) as Data {\n        let certificate = SSLCert(data: certificateData)\n        certs.append(certificate)\n    }\n\n    let security: SocketIO.SSLSecurity = SocketIO.SSLSecurity(certs: certs, usePublicKeys: false)\n    security.security.validatedDN = false\n\n    let manager = SocketManager(\n        socketURL: URL(string: \"https://myip:5000\")!,\n        config: [\n            //.connectParams([\"token\": token])\n            .log(true),\n            .selfSigned(true),\n            .forceWebsockets(true),\n            .forceNew(true),\n            .security(security)]\n    )\n\n    let socket = manager.defaultSocket\n\n    socket.on(clientEvent: .connect) {data, ack in\n        os_log(\"Socket connected!\", type: .debug)\n    }\n\n    socket.on(\"test\") {data, ack in\n        guard let test = data[0] as? String else { return }\n\n        os_log(\"on test: %s\", type: .debug, test)\n    }\n\n    socket.connect()\n\n```\nI'm not seeing the invalid Certificate error, but I'm also not getting a success connect.\nCould you point me in the right direction?\nEDIT:\n1. So I wasn't seeing a connect because the SocketManager was being released.\n1. Digging some more on the docs I discovered I had to disable domain validation since my server is running on a local network with no guarantee of static ip/domain.\n1. After those changes, I think I found a bug in Starscream. More details on daltoniam/Starscream#378. Has anyone any sample code that can put me in the right direction?. ",
    "mlusas": "Yeah, so, I totally missed the detail.  The solution was in the documentation, and simply written.  Here is the highlighted change that needs to be made: \n.timingOut(after: 3, callback: { dataArray in \ninstead of \n(3) { dataArray in\nEXAMPLE\n```\nself.socket.emitWithAck(\"checkLocation\", locationId).timingOut(after: 3, callback: { dataArray in\n     var success = false\n if dataArray[0] as! String == \"NO ACK\" {\n       debugPrint(\"No acknowledgement\")\n       return false\n }\n\n print(\"Server Acknowledged message\")\n return true\n\n}\n```. ",
    "anngdev": "It happens only on heroku server. it works fine on local server.\nMy server code is:\n```\nvar app = require('express')();\nvar http = require('http').Server(app);\nvar io = require('socket.io')(http);\nio.on('connection', function(socket){\n  socket.on('chatmessage', function(msg){\n    console.log('listening on *:'+process.env.PORT || 5000);\n    io.emit('chatmessage', msg);\n  });\n});\nhttp.listen(process.env.PORT || 5000, function(){\n  console.log('listening on *:'+process.env.PORT || 5000);\n});\n```\nhttps://morning-peak-67693.herokuapp.com/. [self.socket connect] is called only once, I was add breakpoint and I sure about that.\nThe problem is it only happen on heroku (with the same server code) :(\n. ",
    "codeninja88": "Where are you issuing your connect function... i had this issue a few weeks ago and fixed it by moving my connect function to the App Delegate so that it is called only once.. ",
    "ipandage": "@codeninja88  how did you solve it , can you be more specific\uff1f. The problem was detected in the test. ",
    "joyalserrao": "but in socket.io tester (Web version)  same url  it will work fine. but not in app .\n// my code \n```objective-c\n@property (nonatomic,strong)  SocketIOClient* socket;\n@synthesize socket;\n(  NSURL *url=[NSURL URLWithString:@\"http://XX.XX.XX.XX:3000?type=user&id=175\"];\n    socket = [[SocketIOClient alloc]initWithSocketURL:url config:@{@\"log\": @YES, @\"forcePolling\": @YES}];\n[socket on:@\"connect\" callback:^(NSArray* data, SocketAckEmitter* ack) {\n    NSLog(@\"socket connected\");\n\n}];\n[socket on:@\"job_update\" callback:^(NSArray* data, SocketAckEmitter* ack) {\n    NSLog(@\"job update %@, %@\",data, ack);\n\n}];\n\n[socket onAny:^(SocketAnyEvent *event) {\n    NSLog(@\"Receive Event %@\", event);\n}];\n\n[socket connect];)\n\n```\n@nuclearace \n. My logos:\n2017-01-23 17:23:03.576 Soket1[62127:837607] LOG SocketIOClient: Adding handler for event: connect\n2017-01-23 17:23:03.577 Soket1[62127:837607] LOG SocketIOClient: Adding handler for event: job_update\n2017-01-23 17:23:03.578 Soket1[62127:837607] LOG SocketIOClient: Adding engine\n2017-01-23 17:23:03.580 Soket1[62127:837607] LOG SocketEngine: Starting engine. Server: http://XX.XX.XX.XX:3000?type=user&id=175\n2017-01-23 17:23:03.580 Soket1[62127:837607] LOG SocketEngine: Handshaking\n2017-01-23 17:23:03.582 Soket1[62127:837607] LOG SocketEnginePolling: Doing polling request\n2017-01-23 17:23:04.471 Soket1[62127:837607] LOG SocketEnginePolling: Got polling response\n2017-01-23 17:23:04.472 Soket1[62127:837671] LOG SocketEngine: Got message: 0{\"sid\":\"6XHpqRtByjzwtftmAAs3\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2017-01-23 17:23:04.474 Soket1[62127:837670] LOG SocketEngine: Writing poll:  has data: false\n2017-01-23 17:23:04.474 Soket1[62127:837671] LOG SocketEnginePolling: Doing polling request\n2017-01-23 17:23:04.475 Soket1[62127:837670] LOG SocketEnginePolling: Sending poll:  as type: 2\n2017-01-23 17:23:04.475 Soket1[62127:837671] LOG SocketEngineClient: Connect\n2017-01-23 17:23:04.476 Soket1[62127:837670] LOG SocketEnginePolling: Created POST string: 1:2\n2017-01-23 17:23:04.478 Soket1[62127:837670] LOG SocketEnginePolling: POSTing\n2017-01-23 17:23:04.479 Soket1[62127:837670] LOG SocketEnginePolling: Doing polling request\n2017-01-23 17:23:04.897 Soket1[62127:837607] LOG SocketEnginePolling: Got polling response\n2017-01-23 17:23:04.897 Soket1[62127:837670] LOG SocketEngine: Got message: 44\"User info is invalid.\"\n2017-01-23 17:23:04.897 Soket1[62127:837607] LOG SocketEnginePolling: Doing polling request\n2017-01-23 17:23:04.898 Soket1[62127:837670] LOG SocketIOClient: Should parse message: 4\"User info is invalid.\"\n2017-01-23 17:23:04.898 Soket1[62127:837670] LOG SocketParser: Parsing 4\"User info is invalid.\"\n2017-01-23 17:23:04.899 Soket1[62127:837670] LOG SocketParser: Decoded packet as: SocketPacket {type: 4; data: [User info is invalid.]; id: -1; placeholders: -1; nsp: /}\n2017-01-23 17:23:04.899 Soket1[62127:837670] LOG SocketIOClient: Handling event: error with data: [User info is invalid.]\n2017-01-23 17:23:04.900 Soket1[62127:837607] Receive Event SocketAnyEvent: Event: error items: Optional([User info is invalid.])\n2017-01-23 17:23:05.320 Soket1[62127:837607] LOG SocketEnginePolling: Got polling response\n2017-01-23 17:23:05.321 Soket1[62127:837607] LOG SocketEnginePolling: Doing polling request\n2017-01-23 17:23:05.321 Soket1[62127:837670] LOG SocketEngine: Got message: 3\n@nuclearace . @nuclearace ok, but In chrome Socket.io tester response . i didn't add any additional info . same url added in chrome socket.io tester. . ok. thank you . Its working fine. I can able to connect . \n socket = [[SocketIOClient alloc]initWithSocketURL:url config:@{@\"connectParams\":@{@\"type\":@\"user\",@\"id\":@\"175\"},@\"log\":@YES,@\"forcePolling\":@YES}];. ",
    "Mekonom": "Connect your mobile phone to local network where your server runs , then get your server local ip , give this ip in your ios project as host. . ",
    "harianbu": "I had this same problem ..what I can do.... ",
    "vatsalkodinariya": "Socket.IO-Client-Swift', '~> 8.0.2. We have socket.io 1.4.8 installed on server.. ",
    "mkhalloufi": "We are facing the same issue... \n@vatsalkodinariya were you able to solve the problem? . ",
    "lRoMYl": "For those who are still facing this issue, try updating it to 8.3.3, I no longer have this issue after upgrading it to the latest version.\nAs for those who still encountered similar issues, I did found out that this issue only occur when emitting data with special characters/unicode, more specifically it only occur to \"subscribe\" event.. ",
    "bharathreddy-97": "I am receiving this error too. I am using Socket IO Client Version 13.1.3. Is anyone else getting this error?. yes i am getting connect event(empty array).. In the .connect event ack no is -1. What might be the problem?. I finally solved it. The problem was due to namespaces. My server was expecting a namespace. I added it like this in config options [.nsp(\"/mynamespacename\")] and everything worked.. I rolled it back to version 12.1.3 and it is working for it. @nuclearace  Can you check this?. @xRena This is the code from the app. Hope it helps\n`          \n       let config = SocketIOClientConfiguration(arrayLiteral: .log(true),.nsp(\"/****\"),.path(\"/******\"))\n\n        self.mSocket = SocketIOClient(socketURL: URL.init(******)!, config: config)\n\n        self.mSocket.on(\"connect\", callback: {\n\n                 your code here\n\n        })\n\n        self.mSocket.connect()\n\n`\nMake sure that socket is a global variable.. @rodericj  No, we are not trying to emit before connecting. After connection is established(in connect success callback) we are emitting.. ",
    "shams-ahmed": "@MeGaPk any chance you can submit a PR?. Closing ticket, can't reproduce all the time. \nthanks. ",
    "SanjithKanagavel": "Is this fixed ? I still see this happening in xcode 8.3.. Yes. It happened in latest version. You can unblock and make the changes compiler requests. And it should work. . ",
    "yonivav": "happens to me too.\nIn my podFile i wrote:\n```\ntarget 'Shindan' do\n  use_frameworks!\n.\n.\npod 'Socket.IO-Client-Swift'\nand it downloaded 8.2 version:\nDownloading dependencies\n.\n.\nUsing Socket.IO-Client-Swift (8.2.0)\n```\nIs it my mistake ? what should i do ?\n. ",
    "SahebRoy92": "Yes, It does work \nWe are using this code in client JS to send the image through socket server from this - https://www.npmjs.com/package/socket.io-stream\n socket.emit('uploadimage', { my: 'data' });\n   ss(socket).on('file', function(stream) {\n   fs.createReadStream('abc.png').pipe(stream);\n });. From iOS when we are calling `socket.emit(\"uploadimage\", \"Test\")` and we are getting this response\n\nSocketIOClient: Handling event: $stream with data: [file, {\n\"$stream\" = \"a1ffe263-e821-4b19-a48d-6b22f8c275c9\";\n}]\nSocketIOClient: Handling event: $stream-read with data: [a1ffe263-e821-4b19-a48d-6b22f8c275c9, 16384]. So, can you tell me the correct procedure to send image / stream video from iOS via Socketio?\n\nI have tried to compress image data and sent them directly but i am talking about large image ~2mb. What would be the correct approach?. So basically its all down to splitting data and sending them, reconstructing it in server side.\nUsing emitData. Ok that settles it then, I have been going nuts as to why isnt my iOS app cannot get the stream from my backend.\nIt settles it then I am closing this. ",
    "bhoopendrayash": "Does Socket.io provide video audio calls? Or it uses Any other protocol?. ",
    "Maverick-03": "Does it work with swift as well?. ",
    "milan-mgu": "@mhtranbn  How did you solved ? please let me know.. ",
    "CreativeBuilds": "I would like to know this fix as I am getting the same error.\n. ",
    "NyeinEiEiTun": "I also happened same case like you. But in my case, i called soketio.run() function in the \"applicationWillEnterForeground\" function of AppDelegate.  Hope this helps you\n. Please use \"connect\" .I am using this swift library from objective-c project. Here is my code.\n\n\nwe can connect or disconnect to socket.io. No I did not use the CocoaPods to install socket.io lib. I have imported swift files to objective-c project manually according to this link, https://developer.apple.com/library/content/documentation/Swift/Conceptual/BuildingCocoaApps/MixandMatch.html.\nhttps://lh3.googleusercontent.com/-oO0TwaZmzqk/WXchakJwb7I/AAAAAAAADfM/hpmn9lEQYYQmZ_yY9F4hGfv9XLWVXjv6gCL0BGAYYCw/h1600/Screen%2BShot%2B2017-07-25%2Bat%2B6.42.01%2BPM.png. which swift version is supported in version 10.0.1?. thanks so much for ur replies \ud83d\udc4d . @nuclearace Sorry for my late responses. Yes I could use 10.0.1 with swift 3. Now I can use xcode 8.3.2 for my projecct :). Thanks so much for your help. @yirankege u using swift or objective c?\n. then tried to add use_framework! in your pod file. Yes you r right. But it doesn't work? What error did you got?\n. which version of xcode are u using? xcode 8.2.1?\n. I also have some problem in installing socket.io version 11 using cocoapods. Because I'm implementing objective c project and also have to use other objective-c pod libraries. If we install swift pod file in objective-c project, we need to use use_frameworks!. But using that causes other library won't work in my project. So I have decided not to install the socket.io using cocoa pods. \nBut socket.io version 11 used starscreams as the dependency. So It is not okay for me to install manually. That's why I have decided to use socket.io version 10.0.1 as @nuclearace  suggested.. Then u use the manual installation using socket.io version 10.0.1.\nYou can find the instructions for manual installation here. https://developer.apple.com/library/content/documentation/Swift/Conceptual/BuildingCocoaApps/MixandMatch.html.\nto get the socket.io library files, You need to install socket.io version 10.0.1 using cocoapods. Then you file the socket.io pod file in ur project. Then copy that file and manually add to ur project. After copying that file, remove the socket.io from pod file again. . If you can rewrite your project with swift, your problem would be solved. But I have no choice. That is my last option. \ud83d\ude06 \ud83d\ude06 . You r welcome :). @yirankege. \ud83d\ude32  You still need the bridging header after using the cocoapods?. Later, I will try ur way \ud83d\udc4d . ",
    "DoktorBog": "I have same issues too! Socket service go to disconnect after 5 minute. ",
    "fukemy": "did someone solve it?. ",
    "musicabbage": "My config params\nNSDictionary *options = @{@\"forceWebsockets\":@YES\n                              ,@\"reconnects\":@YES\n                              ,@\"reconnectWait\":@1\n                              ,@\"forceNew\":@YES\n                              };. clear up ur problem first, did u have this issue in a regular way?\nIf yes, make sure u didn't added listeners multi times as @terenceLuffy said.\nIf not... I can help u nothing bcoz I'm trying to figure it out as well \ud83d\ude02\ud83d\ude02\ud83d\ude02\ud83d\ude02. I got the same problem \u27a1\ufe0f #630 \nbut Im pretty sure I added the listener only 1 time, it usually happens on unstable network . The handlers of SocketIOClient is an array, this means that how many times the target had been added into handlers, ALL of them will be executed, neither its the same object nor different. ",
    "lishuanglong521": "How to solve the problem?. \u63a8\u9001\u51fa\u73b0\u4e71\u7801\u95ee\u9898\u600e\u4e48\u89e3\u51b3. how get the socket.io version?. ",
    "roshanman": "analysis chines error.\neg.\n\\U00e8\\U0081\\U0094\\U00e9\\U0080\\U009a11 => \u00e8\u0081\u0094\u00e9\u0080\u009a11. ",
    "peres": "Here is a stack trace for the case where I have a separate session delegate with no extra retains (the third in my list).\nI didn't have Swift errors enabled in my breakpoint list yesterday, and from the Objective-C end it looked like it was crashing in initWithSocketURL:config:, but it's actually choking in connect. Sorry for the mishap.\n```\nThread 1Queue : com.apple.main-thread (serial)\n0  0x00000001005c84b4 in swift_unknownRetain ()\n1  0x0000000100196e34 in initializeWithCopy for SocketIOClientOption ()\n2  0x00000001003fdaf4 in _ArrayBuffer.getElement(Int, wasNativeTypeChecked : Bool) -> A ()\n3  0x000000010040d8ec in Array.subscript.getter ()\n4  0x0000000100190918 in SocketIOClientConfiguration.subscript.getter at ~/SocketIOTest/socket.io-client-swift/Source/SocketIOClientConfiguration.swift:55\n5  0x0000000100193bec in protocol witness for IndexableBase.subscript.getter in conformance SocketIOClientConfiguration ()\n6  0x00000001003e78e0 in IndexingIterator.next() -> A._Element? ()\n7  0x0000000100144d00 in SocketEngine.init(client : SocketEngineClient, url : URL, config : SocketIOClientConfiguration) -> SocketEngine at ~/SocketIOTest/socket.io-client-swift/Source/SocketEngine.swift:86\n8  0x0000000100145c74 in SocketEngine.__allocating_init(client : SocketEngineClient, url : URL, config : SocketIOClientConfiguration) -> SocketEngine ()\n9  0x000000010015e8bc in SocketIOClient.addEngine() -> SocketEngineSpec at ~/SocketIOTest/socket.io-client-swift/Source/SocketIOClient.swift:123\n10 0x000000010015ec4c in SocketIOClient.connect(timeoutAfter : Int, withHandler : () -> ()?) -> () at ~/SocketIOTest/socket.io-client-swift/Source/SocketIOClient.swift:146\n11 0x000000010015e998 in SocketIOClient.connect() -> () at ~/SocketIOTest/socket.io-client-swift/Source/SocketIOClient.swift:130\n12 0x000000010015f03c in @objc SocketIOClient.connect() -> () ()\n13 0x0000000100021da8 in -[MyPushClient setupPushClient:] at ~/SocketIOTest/MyPushClient.m:110\n14 0x00000001000217fc in -[MyPushClient connect:] at ~/SocketIOTest/MyPushClient.m:69\n15 0x0000000100020d6c in -[ViewController connectButtonPressed:] at ~/SocketIOTest/ViewController.m:27\n16 0x0000000196ab8d30 in -[UIApplication sendAction:to:from:forEvent:] ()\n17 0x0000000196ab8cb0 in -[UIControl sendAction:to:forEvent:] ()\n18 0x0000000196aa3128 in -[UIControl _sendActionsForEvents:withEvent:] ()\n19 0x0000000196ab859c in -[UIControl touchesEnded:withEvent:] ()\n20 0x0000000196ab80c4 in -[UIWindow _sendTouchesForEvent:] ()\n21 0x0000000196ab3328 in -[UIWindow sendEvent:] ()\n22 0x0000000196a83da0 in -[UIApplication sendEvent:] ()\n23 0x000000019726d75c in __dispatchPreprocessedEventFromEventQueue ()\n24 0x0000000197267130 in __handleEventQueue ()\n25 0x0000000190b82b5c in CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION ()\n26 0x0000000190b824a4 in __CFRunLoopDoSources0 ()\n27 0x0000000190b800a4 in __CFRunLoopRun ()\n28 0x0000000190aae2b8 in CFRunLoopRunSpecific ()\n29 0x0000000192562198 in GSEventRunModal ()\n30 0x0000000196aee7fc in -[UIApplication _run] ()\n31 0x0000000196ae9534 in UIApplicationMain ()\n32 0x0000000100022424 in main at ~/SocketIOTest/main.m:14\n33 0x000000018fa915b8 in start ()\n```\nThe item the getter is trying to retrieve in line 3 of the stack trace is the (dead) session delegate: I checked backingArray, which is still holding the stale item at the moment of the crash (see the dump below). I can also confirm that the program had just hit a breakpoint in the delegate's dealloc a moment before the crash happened.\nbackingArray    [SocketIO.SocketIOClientOption] 5 values    \n[0] SocketIO.SocketIOClientOption   sessionDelegate\n[1] SocketIO.SocketIOClientOption   connectParams\n[2] SocketIO.SocketIOClientOption   log\n[3] SocketIO.SocketIOClientOption   secure\n[4] SocketIO.SocketIOClientOption   path\n. I know that it's working with Swift, since the built-in delegate is written and managed in Swift and there is no crash in that case. I might try a Swift implementation in my app if I manage the time. By the way, should the delegate be a Swift object, or should the object holding the SocketIOClient be a Swift object? Or both?\nIt's a tricky convergence: I have Objective-C code defining an object bridged to Swift, and the object in question is possibly the only case in the whole of Foundation of a delegate retained by its user object (NSURLSession). It certainly leaves room for doubts.. It turns out that the object that owns a SocketIOClient must be a Swift object if you want to use a custom session delegate. Tried both with a separate delegate object, and by making the owner the session delegate, too (i.e. the self case). Works in both. WTF.\nMaybe this hints you at the problem. Or you might want to add it to the documentation. For me this case is closed.. ",
    "PodalakurPrasanth": "Hi i am Getting same issue in swift 3.0. if u find the solution please share  the answer to this mail. prasanth.iossoft@gmail.com. Hi  socket get connect.  but getting data is like empty \"[]\" i am getting like this .i have one URL in that URL getting Randoms numbers. but i am getting nil.. \"socketio/socket.io-client-swift\" ~> 8.3.0\nOn Mon, Mar 27, 2017 at 9:01 PM, Erik Little notifications@github.com\nwrote:\n\nAlso what versions are you using?\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/635#issuecomment-289490470,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ATSHpoW1K7YTEI5oQcfkaLIYKBbQ29lyks5rp9ZngaJpZM4Mo-YF\n.\n. They are given one URL and event \"\\random\" and \"capture\". They given these\nthree. That URL generates random number every 4 sec. They are saying use\nsocket.io kit.\n\nOn 27-Mar-2017 11:00 PM, \"Erik Little\" notifications@github.com wrote:\n\nIs the server expecting an ack message? The server has to be designed to\nack, it won't do it for you iirc.\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/635#issuecomment-289490035,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ATSHph6rHBkAjZWUdY9qyxQ-_MDY7si9ks5rp9YYgaJpZM4Mo-YF\n.\n. Hi I am using  pod 'Socket.IO-Client-Swift', '~> 8.2'\nAnd xcode 8.2.1 and swift 3.0\nthese are version i am using . finally i am getting result \"[]\" this\n\nThanks&Regards,\nPrasanth.P\nOn 27-Mar-2017 11:37 PM, \"Priyank Maheshwari\" notifications@github.com\nwrote:\n\nWhat version shall I use at server could you please tell me, that i can\ntell after asking my server guy. but you please let me know whats the right\nversion has to be used at server end.\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/635#issuecomment-289495114,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ATSHpgwRCATIEs8RqnfxUpbjGBt0E1kgks5rp9nogaJpZM4Mo-YF\n.\n. Thank you for given guidance to me\n\nOn 29-Mar-2017 6:40 PM, \"Priyank Maheshwari\" notifications@github.com\nwrote:\n\nThese are the below logs, at server end checked the version using 1.5.0.\nCould you please let me know if I am forming the json object, as my server\nis accepting the json data.\nlet dict = [\"key\": \"Value\"]\n    do {\n        let jsonData = try JSONSerialization.data(withJSONObject: dict, options: .prettyPrinted)\n        // here \"jsonData\" is the dictionary encoded in JSON data\n\n        let decoded = try JSONSerialization.jsonObject(with: jsonData, options: [])\n        // here \"decoded\" is of type `Any`, decoded from JSON data\n\n        // you can now cast it with the right type\n        if let dictFromJSON = decoded as? [String:String] {\n            // use dictFromJSON\n\n            self.socket.emit(\"authenticate\", dictFromJSON)\n\n        }\n    } catch {\n        print(error.localizedDescription)\n    }\n\nSocketEnginePolling: Created POST string: 362:42[\"authenticate\u201d,{\u201ctoken\u201d\n:\u201dsomeValueOfTocken\u201d}]\n2017-03-29 18:29:09.712664 LOG SocketEnginePolling: POSTing\n2017-03-29 18:29:09.713161 LOG SocketEnginePolling: Doing polling request\n2017-03-29 18:29:10.364419 LOG SocketEngine: Writing poll: has data: false\n2017-03-29 18:29:10.365091 LOG SocketEnginePolling: Sending poll: as type:\n2\n2017-03-29 18:29:10.366632 LOG SocketEngine: Writing poll: has data: false\n2017-03-29 18:29:10.367474 LOG SocketEnginePolling: Sending poll: as type:\n2\n2017-03-29 18:29:10.457790 LOG SocketEnginePolling: Created POST string:\n1:21:2\n2017-03-29 18:29:10.458633 LOG SocketEnginePolling: POSTing\n2017-03-29 18:29:10.459013 LOG SocketEnginePolling: Doing polling request\n2017-03-29 18:29:10.657771 LOG SocketEnginePolling: Got polling response\n2017-03-29 18:29:10.658564 LOG SocketEnginePolling: Doing polling request\n2017-03-29 18:29:10.659795 LOG SocketEngine: Got message: 3\n2017-03-29 18:29:11.004019 LOG SocketEnginePolling: Got polling response\n2017-03-29 18:29:11.004837 LOG SocketEnginePolling: Doing polling request\n2017-03-29 18:29:11.006136 LOG SocketEngine: Got message: 3\n2017-03-29 18:29:21.812093 LOG SocketEngine: Writing poll: has data: false\n2017-03-29 18:29:21.812627 LOG SocketEnginePolling: Sending poll: as type:\n2\n2017-03-29 18:29:21.813188 LOG SocketEnginePolling: Created POST string:\n1:2\n2017-03-29 18:29:21.814046 LOG SocketEnginePolling: POSTing\n2017-03-29 18:29:21.814418 LOG SocketEnginePolling: Doing polling request\n2017-03-29 18:29:22.032575 LOG SocketEnginePolling: Got polling response\n2017-03-29 18:29:22.033374 LOG SocketEnginePolling: Doing polling request\n2017-03-29 18:29:22.034600 LOG SocketEngine: Got message: 3\n2017-03-29 18:29:37.855310 LOG SocketEngine: Writing poll: has data: false\n2017-03-29 18:29:37.855838 LOG SocketEnginePolling: Sending poll: as type:\n2\n2017-03-29 18:29:37.856582 LOG SocketEnginePolling: Created POST string:\n1:2\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/635#issuecomment-290084829,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ATSHpk_jTbIHoy3oiyo6ALVdeAhcsO7Yks5rqlhhgaJpZM4Mo-YF\n.\n. \n",
    "alvincrisuy": "Hi, thank you for updating the new release for Swift 3.1. However, would it be possible to remove some of the Swift Compiler Warnings?\n\n\n\n. In SocketIO-Swift.h\n\n\n\n\n\n\n\nIs it possible to remove this warnings?. I have the same issue. How did you resolve this?. ",
    "FelipeKazuo": "Hi, I am trying to use this socketio to communicate my macbook to a 3D printer I am developing. I am connecting to a microcontroller (NodeMCU, I don't know if it matters).\nI receive the following messages on the microcontroller:\nGET /socket.io/?transport=polling&b64=1 HTTP/1.1\nHost: 192.168.0.16:80\nAccept: /\nAccept-Language: pt-br\nConnection: keep-alive\nAccept-Encoding: gzip, deflate\nUser-Agent: 3DPrinterIC/1 CFNetwork/811.4.18 Darwin/16.5.0 (x86_64)\nMy log is:\nSocketEngine: Starting engine. Server: http://192.168.0.16:80\n2017-03-28 18:05:08.433846-0300 3DPrinterIC[11162:95863] LOG SocketEngine: Handshaking\n2017-03-28 18:05:08.434140-0300 3DPrinterIC[11162:95863] LOG SocketEnginePolling: Doing polling request\n2017-03-28 18:05:11.435585-0300 3DPrinterIC[11162:95863] ERROR SocketEnginePolling: The request timed out.\n2017-03-28 18:05:11.435736-0300 3DPrinterIC[11162:95863] ERROR SocketEngine: The request timed out.\n2017-03-28 18:05:11.435826-0300 3DPrinterIC[11162:95863] ERROR SocketIOClient: The request timed out.\n2017-03-28 18:05:11.436126-0300 3DPrinterIC[11162:95863] LOG SocketIOClient: Handling event: error with data: [\"The request timed out.\"]\n2017-03-28 18:05:22.532266-0300 3DPrinterIC[11162:95863] LOG SocketIOClient: Trying to reconnect\n2017-03-28 18:05:22.532454-0300 3DPrinterIC[11162:95863] LOG SocketIOClient: Handling event: reconnectAttempt with data: [-30]\nThe code I am using is the example shown on GitHub.\nWhat can I be doing wrong if I am receiving data on my microcontroller?\nThanks in advance. ",
    "JordanOsterberg": "Issue resolved, although there are some compiler warnings. Closed.. ",
    "AflyingApple": "Log:\n2017-03-31 09:26:43.409963+0800 Delivery[2357:479969] LOG SocketEngine: Writing poll:  has data: false\n2017-03-31 09:26:43.410293+0800 Delivery[2357:479969] LOG SocketEnginePolling: Sending poll:  as type: 2\n2017-03-31 09:26:43.410583+0800 Delivery[2357:479969] LOG SocketEnginePolling: Created POST string: 1:2\n2017-03-31 09:26:43.411217+0800 Delivery[2357:479969] LOG SocketEnginePolling: POSTing\n2017-03-31 09:26:43.411383+0800 Delivery[2357:479969] LOG SocketEnginePolling: Doing polling request\n2017-03-31 09:26:43.788461+0800 Delivery[2357:479147] LOG SocketEnginePolling: Got polling response\n2017-03-31 09:26:43.789089+0800 Delivery[2357:479147] LOG SocketEnginePolling: Doing polling request\n2017-03-31 09:26:43.790372+0800 Delivery[2357:479882] LOG SocketEngine: Got message: 3\n2017-03-31 09:27:00.723365+0800 Delivery[2357:479147] LOG SocketEnginePolling: Got polling response\n2017-03-31 09:27:00.724012+0800 Delivery[2357:479147] LOG SocketEnginePolling: Doing polling request\n2017-03-31 09:27:00.726377+0800 Delivery[2357:480102] LOG SocketEngine: Got message: 42[\"getOrder\",[{\"id\":\"911\",\"addtime\":\"2017-03-31 09:27:00\",\"address\":\"\u00e5\u00b9\u00bf\u00e4\u00b8\u009c\u00e7\u009c\u0081,\u00e6\u00b7\u00b1\u00e5\u009c\u00b3\u00e5\u00b8\u0082,\u00e7\u00bd\u0097\u00e6\u00b9\u0096\u00e5\u008c\u00ba\u00e6\u0098\u008e\u00e6\u0098\u009fup\u00e5\u0090\u008d\u00e5\u00ad\u0097\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e6\u0098\u009f\u00e6\u0098\u009f\u00e4\u00b9\u00a0\u00e6\u0098\u008e\u00e6\u00b3\u00bd\u00e5\u00a9\u0086\u00e5\u00a9\u0086\u00e5\u0098\u00b4\"}]]\n2017-03-31 09:27:00.726693+0800 Delivery[2357:480102] LOG SocketIOClient: Should parse message: 2[\"getOrder\",[{\"id\":\"911\",\"addtime\":\"2017-03-31 09:27:00\",\"address\":\"\u00e5\u00b9\u00bf\u00e4\u00b8\u009c\u00e7\u009c\u0081,\u00e6\u00b7\u00b1\u00e5\u009c\u00b3\u00e5\u00b8\u0082,\u00e7\u00bd\u0097\u00e6\u00b9\u0096\u00e5\u008c\u00ba\u00e6\u0098\u008e\u00e6\u0098\u009fup\u00e5\u0090\u008d\u00e5\u00ad\u0097\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e6\u0098\u009f\u00e6\u0098\u009f\u00e4\u00b9\u00a0\u00e6\u0098\u008e\u00e6\u00b3\u00bd\u00e5\u00a9\u0086\u00e5\u00a9\u0086\u00e5\u0098\u00b4\"}]]\n2017-03-31 09:27:00.726972+0800 Delivery[2357:480102] LOG SocketParser: Parsing 2[\"getOrder\",[{\"id\":\"911\",\"addtime\":\"2017-03-31 09:27:00\",\"address\":\"\u00e5\u00b9\u00bf\u00e4\u00b8\u009c\u00e7\u009c\u0081,\u00e6\u00b7\u00b1\u00e5\u009c\u00b3\u00e5\u00b8\u0082,\u00e7\u00bd\u0097\u00e6\u00b9\u0096\u00e5\u008c\u00ba\u00e6\u0098\u008e\u00e6\u0098\u009fup\u00e5\u0090\u008d\u00e5\u00ad\u0097\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e6\u0098\u009f\u00e6\u0098\u009f\u00e4\u00b9\u00a0\u00e6\u0098\u008e\u00e6\u00b3\u00bd\u00e5\u00a9\u0086\u00e5\u00a9\u0086\u00e5\u0098\u00b4\"}]]\n2017-03-31 09:27:00.746043+0800 Delivery[2357:480102] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [getOrder, <__NSArrayM 0x17025e330>(\n{\n    address = \"\\U00e5\\U00b9\\U00bf\\U00e4\\U00b8\\U009c\\U00e7\\U009c\\U0081,\\U00e6\\U00b7\\U00b1\\U00e5\\U009c\\U00b3\\U00e5\\U00b8\\U0082,\\U00e7\\U00bd\\U0097\\U00e6\\U00b9\\U0096\\U00e5\\U008c\\U00ba\\U00e6\\U0098\\U008e\\U00e6\\U0098\\U009fup\\U00e5\\U0090\\U008d\\U00e5\\U00ad\\U0097\\U00e5\\U0098\\U00bb\\U00e5\\U0098\\U00bb\\U00e5\\U0098\\U00bb\\U00e5\\U0098\\U00bb\\U00e6\\U0098\\U009f\\U00e6\\U0098\\U009f\\U00e4\\U00b9\\U00a0\\U00e6\\U0098\\U008e\\U00e6\\U00b3\\U00bd\\U00e5\\U00a9\\U0086\\U00e5\\U00a9\\U0086\\U00e5\\U0098\\U00b4\";\n    addtime = \"2017-03-31 09:27:00\";\n    id = 911;\n}\n)\n]; id: -1; placeholders: -1; nsp: /}\n2017-03-31 09:27:00.756739+0800 Delivery[2357:480102] LOG SocketIOClient: Handling event: getOrder with data: [<__NSArrayM 0x17025e330>(\n{\n    address = \"\\U00e5\\U00b9\\U00bf\\U00e4\\U00b8\\U009c\\U00e7\\U009c\\U0081,\\U00e6\\U00b7\\U00b1\\U00e5\\U009c\\U00b3\\U00e5\\U00b8\\U0082,\\U00e7\\U00bd\\U0097\\U00e6\\U00b9\\U0096\\U00e5\\U008c\\U00ba\\U00e6\\U0098\\U008e\\U00e6\\U0098\\U009fup\\U00e5\\U0090\\U008d\\U00e5\\U00ad\\U0097\\U00e5\\U0098\\U00bb\\U00e5\\U0098\\U00bb\\U00e5\\U0098\\U00bb\\U00e5\\U0098\\U00bb\\U00e6\\U0098\\U009f\\U00e6\\U0098\\U009f\\U00e4\\U00b9\\U00a0\\U00e6\\U0098\\U008e\\U00e6\\U00b3\\U00bd\\U00e5\\U00a9\\U0086\\U00e5\\U00a9\\U0086\\U00e5\\U0098\\U00b4\";\n    addtime = \"2017-03-31 09:27:00\";\n    id = 911;\n}\n)\n]\n2017-03-31 09:27:08.642616+0800 Delivery[2357:479882] LOG SocketEngine: Writing poll:  has data: false\n2017-03-31 09:27:08.642943+0800 Delivery[2357:479882] LOG SocketEnginePolling: Sending poll:  as type: 2\n2017-03-31 09:27:08.643182+0800 Delivery[2357:479882] LOG SocketEnginePolling: Created POST string: 1:2\n2017-03-31 09:27:08.643816+0800 Delivery[2357:479882] LOG SocketEnginePolling: POSTing\n2017-03-31 09:27:08.643983+0800 Delivery[2357:479882] LOG SocketEnginePolling: Doing polling request\n2017-03-31 09:27:08.690916+0800 Delivery[2357:479147] LOG SocketEnginePolling: Got polling response\n2017-03-31 09:27:08.691904+0800 Delivery[2357:479147] LOG SocketEnginePolling: Doing polling request\n2017-03-31 09:27:08.693205+0800 Delivery[2357:480102] LOG SocketEngine: Got message: 3\n2017-03-31 09:27:12.274586+0800 Delivery[2357:479147] LOG SocketEnginePolling: Got polling response\n2017-03-31 09:27:12.275219+0800 Delivery[2357:479147] LOG SocketEnginePolling: Doing polling request\n2017-03-31 09:27:12.277764+0800 Delivery[2357:480057] LOG SocketEngine: Got message: 42[\"getOrder\",[{\"id\":\"911\",\"addtime\":\"2017-03-31 09:27:00\",\"address\":\"\u00e5\u00b9\u00bf\u00e4\u00b8\u009c\u00e7\u009c\u0081,\u00e6\u00b7\u00b1\u00e5\u009c\u00b3\u00e5\u00b8\u0082,\u00e7\u00bd\u0097\u00e6\u00b9\u0096\u00e5\u008c\u00ba\u00e6\u0098\u008e\u00e6\u0098\u009fup\u00e5\u0090\u008d\u00e5\u00ad\u0097\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e6\u0098\u009f\u00e6\u0098\u009f\u00e4\u00b9\u00a0\u00e6\u0098\u008e\u00e6\u00b3\u00bd\u00e5\u00a9\u0086\u00e5\u00a9\u0086\u00e5\u0098\u00b4\"}]]\n2017-03-31 09:27:12.278109+0800 Delivery[2357:480057] LOG SocketIOClient: Should parse message: 2[\"getOrder\",[{\"id\":\"911\",\"addtime\":\"2017-03-31 09:27:00\",\"address\":\"\u00e5\u00b9\u00bf\u00e4\u00b8\u009c\u00e7\u009c\u0081,\u00e6\u00b7\u00b1\u00e5\u009c\u00b3\u00e5\u00b8\u0082,\u00e7\u00bd\u0097\u00e6\u00b9\u0096\u00e5\u008c\u00ba\u00e6\u0098\u008e\u00e6\u0098\u009fup\u00e5\u0090\u008d\u00e5\u00ad\u0097\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e6\u0098\u009f\u00e6\u0098\u009f\u00e4\u00b9\u00a0\u00e6\u0098\u008e\u00e6\u00b3\u00bd\u00e5\u00a9\u0086\u00e5\u00a9\u0086\u00e5\u0098\u00b4\"}]]\n2017-03-31 09:27:12.278387+0800 Delivery[2357:480057] LOG SocketParser: Parsing 2[\"getOrder\",[{\"id\":\"911\",\"addtime\":\"2017-03-31 09:27:00\",\"address\":\"\u00e5\u00b9\u00bf\u00e4\u00b8\u009c\u00e7\u009c\u0081,\u00e6\u00b7\u00b1\u00e5\u009c\u00b3\u00e5\u00b8\u0082,\u00e7\u00bd\u0097\u00e6\u00b9\u0096\u00e5\u008c\u00ba\u00e6\u0098\u008e\u00e6\u0098\u009fup\u00e5\u0090\u008d\u00e5\u00ad\u0097\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e5\u0098\u00bb\u00e6\u0098\u009f\u00e6\u0098\u009f\u00e4\u00b9\u00a0\u00e6\u0098\u008e\u00e6\u00b3\u00bd\u00e5\u00a9\u0086\u00e5\u00a9\u0086\u00e5\u0098\u00b4\"}]]\n2017-03-31 09:27:12.285597+0800 Delivery[2357:480057] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [getOrder, <__NSArrayM 0x17025c620>(\n{\n    address = \"\\U00e5\\U00b9\\U00bf\\U00e4\\U00b8\\U009c\\U00e7\\U009c\\U0081,\\U00e6\\U00b7\\U00b1\\U00e5\\U009c\\U00b3\\U00e5\\U00b8\\U0082,\\U00e7\\U00bd\\U0097\\U00e6\\U00b9\\U0096\\U00e5\\U008c\\U00ba\\U00e6\\U0098\\U008e\\U00e6\\U0098\\U009fup\\U00e5\\U0090\\U008d\\U00e5\\U00ad\\U0097\\U00e5\\U0098\\U00bb\\U00e5\\U0098\\U00bb\\U00e5\\U0098\\U00bb\\U00e5\\U0098\\U00bb\\U00e6\\U0098\\U009f\\U00e6\\U0098\\U009f\\U00e4\\U00b9\\U00a0\\U00e6\\U0098\\U008e\\U00e6\\U00b3\\U00bd\\U00e5\\U00a9\\U0086\\U00e5\\U00a9\\U0086\\U00e5\\U0098\\U00b4\";\n    addtime = \"2017-03-31 09:27:00\";\n    id = 911;\n}\n)\n]; id: -1; placeholders: -1; nsp: /}\n2017-03-31 09:27:12.286149+0800 Delivery[2357:480057] LOG SocketIOClient: Handling event: getOrder with data: [<__NSArrayM 0x17025c620>(\n{\n    address = \"\\U00e5\\U00b9\\U00bf\\U00e4\\U00b8\\U009c\\U00e7\\U009c\\U0081,\\U00e6\\U00b7\\U00b1\\U00e5\\U009c\\U00b3\\U00e5\\U00b8\\U0082,\\U00e7\\U00bd\\U0097\\U00e6\\U00b9\\U0096\\U00e5\\U008c\\U00ba\\U00e6\\U0098\\U008e\\U00e6\\U0098\\U009fup\\U00e5\\U0090\\U008d\\U00e5\\U00ad\\U0097\\U00e5\\U0098\\U00bb\\U00e5\\U0098\\U00bb\\U00e5\\U0098\\U00bb\\U00e5\\U0098\\U00bb\\U00e6\\U0098\\U009f\\U00e6\\U0098\\U009f\\U00e4\\U00b9\\U00a0\\U00e6\\U0098\\U008e\\U00e6\\U00b3\\U00bd\\U00e5\\U00a9\\U0086\\U00e5\\U00a9\\U0086\\U00e5\\U0098\\U00b4\";\n    addtime = \"2017-03-31 09:27:00\";\n    id = 911;\n}\n)\n]\nsocket \n[self.socket on:@\"callFunction\" callback:^(NSArray *data, SocketAckEmitter *ack) {\n\n    HBLog(@\"callFunction%--@\",data);\n\n}\nSocket cannot receive returned information\n. ",
    "SinoGao": "socket.io-client-swift:8.1.1;\nsocket.io:1.7.2\n. \n. ",
    "betoHub": "Now it works! . ",
    "itzhangbao": "How did you get it to work? thk. Using doubleEncodeUTF8 (true) doesn't work, it's still messy. @nuclearace I return to version 9.0.1, which can be displayed norm.. ",
    "syedrazackimran": "thanks for pervious question , i have another quires how can i stop emitting ! i need to stop emitting on particular time !  . thanks for your response !! i fixed that !! . ",
    "AngeSohone": "Hi, please someone can share to me ressource or example code to use more than one socket in ios app.\nI need to have 02 sockets\nThanks. ",
    "johnharutyunyan": "I also have this problem and  also have the latest version (Xcode 8.3.1) \nAfter pod install , Xcode give me 6 errors from Sockets. ",
    "lk321": "Update all packages to the latest version.\npod update. ",
    "MaxAdamyan": "I do not know the case but here is crash report:\ncom.apple.main-thread\n0  libsystem_kernel.dylib         0x187b78e64 __psynch_mutexwait + 8\n1  libsystem_pthread.dylib        0x187c44c5c _pthread_mutex_lock_wait + 96\n2  libsystem_pthread.dylib        0x187c44e64 _pthread_mutex_lock_slow + 300\n3  CoreFoundation                 0x188aca2a4 _CFStreamUnscheduleFromRunLoop + 152\n4  CoreFoundation                 0x188b3a118 _CFStreamSetDispatchQueue + 168\n5  **                             0x100168e08 WebSocket.cleanupStream() -> () (WebSocket.swift:444)\n6  **                             0x100169814 @objc WebSocket.__deallocating_deinit (WebSocket.swift:934)\n7  **                             0x1000a5994 SocketEngine.createWebsocketAndConnect() -> () (SocketEngine.swift:248)\n8  **                             0x1000a536c SocketEngine.connect() -> () (SocketEngine.swift:190)\n9  **                             0x1000a60c8 @objc SocketEngine.connect() -> () (SocketEngine.swift)\n10 **                             0x100118854 specialized SocketIOClient.connect(timeoutAfter : Int, withHandler : () -> ()?) -> () (SocketIOClient.swift:148)\n11 **                             0x100116064 SocketIOClient._tryReconnect() -> () (SocketIOClient.swift:428)\n12 **                             0x100119c3c specialized SocketIOClient.engineDidClose(reason : String) -> () (SocketIOClient.swift:412)\n13 **                             0x100115a84 @objc SocketIOClient.didDisconnect(reason : String) -> () + 4296284804\n14 **                             0x1000a6a3c SocketEngine.sendPing() -> () (SocketEngine.swift)\n15 **                             0x1000a6fac SocketEngine.(sendPing() -> ()).(closure #1) (SocketEngine.swift)\n16 libdispatch.dylib              0x187a369a0 _dispatch_client_callout + 16\n17 libdispatch.dylib              0x187a43604 _dispatch_continuation_pop + 448\n18 libdispatch.dylib              0x187a4fc1c _dispatch_source_latch_and_call + 204\n19 libdispatch.dylib              0x187a388a0 _dispatch_source_invoke + 804\n20 libdispatch.dylib              0x187a3b4a0 _dispatch_main_queue_callback_4CF + 668\n21 CoreFoundation                 0x188b2d0c0 __CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE__ + 12\n22 CoreFoundation                 0x188b2acdc __CFRunLoopRun + 1572\n23 CoreFoundation                 0x188a5ad94 CFRunLoopRunSpecific + 424\n24 GraphicsServices               0x18a4c4074 GSEventRunModal + 100\n25 UIKit                          0x18ed13130 UIApplicationMain + 208\n26 **                             0x10008de9c main (SocketIOClientSpec.swift:27)\n27 libdyld.dylib                  0x187a6959c start + 4\n. ",
    "qasimsina": "Are you mean i call establishConnection again? in second or any view that use Socket IO singleton?. ",
    "perlish": "i think socket.connect() should be called just one time, \nother view have to use sharedInstance of socket\nif it's not work, maybe there is bug @nuclearace . ",
    "uthaman22": "[self.socket onAny:^(SocketAnyEvent *event) {\n        [self socketIO:self.socket didReceiveEvent:event];\n    }]; \nSame issue only calls for connecting and connected and not working for any other emit events like below.\n[[self.socket emitWithAck:@\"setUser\" with:@[@(58575)]] timingOutAfter:0 callback:^(NSArray* data) {\n            NSLog(@\"socket set user\");\n}\nHow to achieve the pong listener in objective-c project and can't proceed further for this both issues in my project.\n. ",
    "chirag225": "Xcode  8.3.2. Still facing this issue pod 'Socket.IO-Client-Swift',   xcode 8.3.3\n 1 ) Could not build module 'SocketIO'\n2 ) Property with 'retain (or strong)' attribute must be of object type for   @property (nonatomic, strong) dispatch_queue_t _Nonnull handleQueue;. Hello anyone here to solve this my problem . can anyone help me out this problem . @jose920405 have you resolve this issue ?. yes still could not build module error are there in latest version . still not resolve this issue in pod 'Socket.IO-Client-Swift', '~> 11.1.2' . what should i change or what should  i do with bridging Please help me out.....  Thank you..... This my pod dependency \nPodfile.txt\nproject is in objc . When i downgrade to Socket.IO-Client-Swift 8.3.3 \n\n. Hello i did some modification in code\ni used \n #if OS_OBJECT_USE_OBJC\n@property (nonatomic, strong, nullable) dispatch_queue_t  handleQueue;\nelse\n@property (nonatomic, assign, nullable) dispatch_queue_t  handleQueue;\nendif\ninstead of \n@property (nonatomic, strong) dispatch_queue_t _Nonnull handleQueue;\nnow no more error comes \n. Yes thats i am searching for, i think somewhere in Xcode setting need to change, can you share some point which should i check for swift compiler Thank you..... @jose920405 have you find any solution ? i checked all build setting but no luck :( . @nuclearace can you Suggest me what should i check from Xcode setting or pod setting because it was working in older version Thank you.... Hello, https://github.com/TransitApp/SVHTTPRequest/pull/52\ncan you look into this, They solved  same problem . I test in Xcode 9 GM seed but no luck :(. No \ud83d\udc4d   Thank you for Everything \nSocket lib was conflict with other deprecated lib thats why module Error Occurs Now its Working \nThank you Again . @MD04-TanTan  what error r you suffering ?. ",
    "ashwingattani": "i am not completely sure of what a spotty connection is. However as far as i understand, my internet is working fine and does not loses connection for any other application. Its only happening for the app i am using socket.io with!. ",
    "nthieu90": "Event: error\n Description: SocketAnyEvent: Event: error items: Optional([\"Got unknown error from server ok\"])\nMessage from debugger: Terminated due to memory issue. I restart  many time but it still not connect. I checked on socket.io-client-java and it works find. . Is there any way can fix on client-side? As Android doesn't have this problem.. Before I changed time, I get this info:\n\nLOG SocketEngine: Got message: 0{\"sid\":\"PIBabljZiJpIh8PVAA9c\",\"upgrades\"[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\nLOG SocketEngine: Writing poll:  has data: false\nLOG SocketEnginePolling: Sending poll:  as type: 2\nSocketEnginePolling: Doing polling request\nLOG SocketEngineClient: Connect\nLOG SocketEnginePolling: Created POST string: 1:2\nLOG SocketEnginePolling: POSTing\nLOG SocketEnginePolling: Doing polling request\nLOG SocketEnginePolling: Got polling response\nLOG SocketEngine: Got message: 40\nLOG SocketIOClient: Should parse message: 0\nLOG SocketParser: Parsing 0\nLOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\nLOG SocketIOClient: Socket connected\n\nbut after I changed time, I get the same sid\n\nLOG SocketEnginePolling: Got polling response LOG SocketEngine: Got message: 0{\"sid\":\"PIBabljZiJpIh8PVAA9c\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\nLOG SocketEngine: Writing poll:  has data: false\nLOG SocketEnginePolling: Sending poll:  as type: 2\nLOG SocketEnginePolling: Doing polling request\nLOG SocketEngineClient: Connect\nLOG SocketEnginePolling: Created POST string: 1:2 \nLOG SocketEnginePolling: POSTing\nLOG SocketEnginePolling: Doing polling request\nLOG SocketEnginePolling: Got polling response\nLOG SocketEnginePolling: Doing polling request\nLOG SocketEngine: Got message: {\"code\":1,\"message\":\"Session ID unknown\"}\nERROR SocketEngine: Session ID unknown\nERROR SocketIOClient: Session ID unknown\nLOG SocketIOClient: Handling event: error with data: [\"Session ID unknown\"]\nLOG SocketEngine: Engine is being closed.\nLOG SocketEnginePolling: Created POST string: 1:1\nLOG SocketEnginePolling: Got polling response\nLOG SocketEnginePolling: Doing polling request\nLOG SocketIOClient: Starting reconnect\nLOG SocketIOClient: Handling event: reconnect with data: [\"Session ID unknown\"]\nLOG SocketIOClient: Trying to reconnect\n\nAnd I try to restart app, it still get the dam sid but cannot connect. Clear cache and it can connect:\nURLCache.shared.removeAllCachedResponses(). ",
    "longkt90": "Hi @nuclearace, @nthieu90, server guy here.\nFirst client issue a GET request to:\n/socket.io/?transport=polling&b64=1\nserver return a Set-Cookie header without MaxAge or Expire from https://github.com/socketio/engine.io/blob/81ef0bc939ed7f83a4c4b9df0fb2d313b9bf2cad/lib/server.js#L320 \nE.g:\nHTTP/1.1 200 OK\nContent-Type: text/plain; charset=UTF-8\nContent-Length: 100\nSet-Cookie: io=vKkfG9BFA44eSz7xAAxN; Path=/; HttpOnly\nDate: Tue, 25 Apr 2017 13:30:36 GMT\nRequest logs for normal request:\nengine intercepting request for path \"/socket.io/\" +23s\n  engine handling \"GET\" http request \"/socket.io/?transport=polling&b64=1\" +1ms\n  engine handshaking client \"MZK3FmCm7QlznrGKAAAB\" +0ms\n  engine:socket sending packet \"open\" ({\"sid\":\"MZK3FmCm7QlznrGKAAAB\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}) +1ms\n  engine:polling setting request +0ms\n  engine:socket flushing buffer to transport +0ms\n  engine:polling writing \"97:0{\"sid\":\"MZK3FmCm7QlznrGKAAAB\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\" +0ms\n  engine:socket executing batch send callback +1ms\n  socket.io:server incoming connection with id MZK3FmCm7QlznrGKAAAB +2m\n  socket.io:client connecting to namespace / +1ms\n  socket.io:namespace adding socket to nsp / +0ms\n  socket.io:socket socket connected - writing packet +0ms\n  socket.io:socket joining room MZK3FmCm7QlznrGKAAAB +0ms\n  socket.io:client writing packet {\"type\":0,\"nsp\":\"/\"} +0ms\n  socket.io-parser encoding packet {\"type\":0,\"nsp\":\"/\"} +3.0m\n  socket.io-parser encoded {\"type\":0,\"nsp\":\"/\"} as 0 +0ms\n  engine:socket sending packet \"message\" (0) +2ms\n  socket.io:socket joined room MZK3FmCm7QlznrGKAAAB +1ms\n  socket.io:client writing packet {\"type\":1,\"nsp\":\"/\"} +15s\n  socket.io-parser encoding packet {\"type\":1,\"nsp\":\"/\"} +15s\n  socket.io-parser encoded {\"type\":1,\"nsp\":\"/\"} as 1 +0ms\n  engine:socket sending packet \"message\" (1) +15s\n  socket.io:socket closing socket - reason server namespace disconnect +0ms\n  socket.io:client ignoring remove for MZK3FmCm7QlznrGKAAAB +0ms\n  socket.io:client forcing transport close +0ms\n  socket.io:client client close with reason forced server close +0ms\n  engine intercepting request for path \"/socket.io/\" +9s\n  engine handling \"POST\" http request \"/socket.io/?transport=polling&b64=1&sid=MZK3FmCm7QlznrGKAAAB\" +0ms\n  engine setting new request for existing client +0ms\nlogs for request from clients having time set too far away from present (more than 1 hour):\nengine intercepting request for path \"/socket.io/\" +1m\n  engine handling \"POST\" http request \"/socket.io/?transport=polling&b64=1&sid=NK2vgX-vmAGCmmqeAAAA\" +1ms\nthere is no handshake for old clients - I think this more about the cookie expiration, it's still fine if the client time only few minutes different. It's working fine if the client's time is in the future.\nIf I try to \"POST\" to \"/socket.io/?transport=polling&b64=1&sid=NK2vgX-vmAGCmmqeAAAA I get this error:\n{\n  \"code\": 1,\n  \"message\": \"Session ID unknown\"\n}\nAny idea to fix this? I'm thinking about explicitly set maxAge for this cookie.. ",
    "nhatminh12369": "Hi @nuclearace,\nI think the issue is that when we change the device time to the past, the system returns the cached result from previous call.\nMay I suggest one fix in the library itself? Change line 194 in SocketEngine.swift to:\nlet reqPolling = NSMutableURLRequest(url: urlPolling, cachePolicy: .reloadIgnoringLocalCacheData, timeoutInterval: 0.0)\nWe don't call connect often, so, I think it should be fine for not caching the request.. ",
    "faizan-carameltech": "Sorry I was busy with work that I could not keep up with this PR.  @nuclearace are you planing to support this on your own?. @nuclearace that would be really great. I was just going through the latest changes you have made in master. It's a lot to keep up with. I have my own deadlines pending and therefore I don't think I will be able to mange this PR in the near future.\nI really appreciate the great work you are doing. And I really hope you can put pingSent and pongReceived listener support in your upcoming commits.. What other info you require in logs? I will accommodate that. Furthermore closing this PR and opening a new one against development branch with the suggested changes.. ",
    "praveen200": "I got same error.\nIs Someone give  answer of above question?. ",
    "Nik20112": "Yes its resolved\nThanks. Hi,\nThanks for the reply. Now I m successfully connected to Socket event handler method not called. While I am sending data from iOS to Android its working fine but while android send the data into iOS. So that time not called any socket methods at iOS Side.\nCan you please help me on this? Please see the below code and let me know if anything wrong on this while receving the data.\n```swift\nimport UIKit\nimport SocketIO\nclass SocketManager: NSObject {\nstatic var singleton = SocketManager()\n\n//let socket = SocketIOClient(socketURL: URL(string: BundleValues.sharedInstance.WebSocketURL() as String)!, options: [.Log(true), .ForcePolling(true), .Reconnects(true)])\nlet socket = SocketIOClient(socketURL: URL(string: \"https://test1234.nl:3000\")!, config: [.log(true), .forcePolling(true)])\noverride init() {\n    super.init()\n}\n\n//MARK:- Establish socket connection\nfunc establishConnection(activeSerieId : Int) {\n\n    socket.connect()\n    socket.on(\"connect\") {data, ack in\n\n        if activeId > 0 {\n            SocketManager.singleton.connectToServerWithId(activeId, completionHandler: { (userList : [AnyObject]?) in\n            })\n        }\n    }\n}\n\n//MARK:- Close socket connection\nfunc closeConnection() {\n    socket.disconnect()\n}\n\n//MARK:- Connecting to the Room using Id\nfunc connectToServerWithSerieId(_ activeId: Int, completionHandler:@escaping(_ userList : [AnyObject]?)->Void) {\n\n    socket.emit(\"activeId\", activeId)\n    socket.on(\"activeresult\") { (dataArray, socketAck) -> Void in\n    NotificationCenter.default.post(name: NSNotification.Name(rawValue: \"receivedRaceResultNotification\"), object: dataArray[0] as! [String: AnyObject])\n    }\n}\n\n}\n```\n. Hi,\nPlease do me fever for this.\nPlease list out the all event handler methods for me and when I can cross check event name is correct or not? and below calling of event handlers is correct?\n```\n//MARK:- Establish socket connection\n    func establishConnection(activeId : Int) {\n    socket.on(\"connect\") {data, ack in\n\n        if activeId > 0 {\n            SocketManager.singleton.connectToServerWithId(activeId, completionHandler: { (userList : [AnyObject]?) in\n            })\n        }\n    }\n    socket.connect()\n}\n\n```. Hi,\nI have integrated \".onAny\" event handler and logging and pulling as well but receiver side can't call the method and below log is there: Honestly, I don't know the issue where it is? Please help\n```\n: LOG SocketEngine: Writing poll:  has data: false\n: LOG SocketEnginePolling: Sending poll:  as type: 2\n : LOG SocketEnginePolling: Created POST string: 1:2\n : LOG SocketEnginePolling: POSTing\n: LOG SocketEnginePolling: Doing polling POST https://test1234.nl:3000/socket.io/?transport=polling&b64=1&sid=fb6LRYy_xWH60vy1AASL\n: LOG SocketEnginePolling: Got polling response\n: LOG SocketEngine: Got message: 3\n: LOG SocketEnginePolling: Doing polling GET https://test1234.nl:3000/socket.io/?transport=polling&b64=1&sid=fb6LRYy_xWH60vy1AASL\n29  syncdefaultsd[115] : (Note ) marked \"com.me.keyvalueservice\" topic as \"enabled\" on \n: LOG SocketEngine: Writing poll:  has data: false\n  : LOG SocketEnginePolling: Sending poll:  as type: 2\n  : LOG SocketEnginePolling: Created POST string: 1:2\n  : LOG SocketEnginePolling: POSTing\n  : LOG SocketEnginePolling: Doing polling POST https://test1234.nl:3000/socket.io/?transport=polling&b64=1&sid=fb6LRYy_xWH60vy1AASL\n  : LOG SocketEnginePolling: Got polling response\n  : LOG SocketEngine: Got message: 3\n  : LOG SocketEnginePolling: Doing polling GET https://test1234.nl:3000/socket.io/?transport=polling&b64=1&sid=fb6LRYy_xWH60vy1AASL\n  locationd[69] : Gesture EnabledForTopClient: 1 (SiriCalled)\n  : LOG SocketEngine: Writing poll:  has data: false\n  : LOG SocketEnginePolling: Sending poll:  as type: 2\n  : LOG SocketEnginePolling: Created POST string: 1:2\n  : LOG SocketEnginePolling: POSTing\n  : LOG SocketEnginePolling: Doing polling POST https://test1234.nl:3000/socket.io/?transport=polling&b64=1&sid=fb6LRYy_xWH60vy1AASL\n : LOG SocketEnginePolling: Got polling response\n : LOG SocketEngine: Got message: 3\n : LOG SocketEnginePolling: Doing polling GET https://test1234.nl:3000/socket.io/?transport=polling&b64=1&sid=fb6LRYy_xWH60vy1AASL\n  : LOG SocketEngine: Writing poll:  has data: false\nUpdate Code:\n//MARK:- Establish socket connection\n    func establishConnection(activeId : Int) {\n    socket.on(\"connect\") {data, ack in\n\n        if activeId > 0 {\n            SocketManager.singleton.connectToServerWithId(activeId, completionHandler: { (userList : [AnyObject]?) in\n            })\n        }\n    }\n\n    socket.onAny {event in\n        debugPrint(\"onAny handler:::::\",event.event)\n    }\n\n    socket.connect()\n}\n\n//MARK:- Close socket connection\nfunc closeConnection() {\n    socket.disconnect()\n}\n\n//MARK:- Connecting to the Room using activeId\nfunc connectToServerWithActiveId(_ activeId: Int, completionHandler:@escaping(_ userList : [AnyObject]?)->Void) {\n\n    socket.emit(\"activeId\", activeId)\n    socket.on(\"result\") { (dataArray, socketAck) -> Void in\n    NotificationCenter.default.post(name: NSNotification.Name(rawValue: \"receivedRaceResultNotification\"), object: dataArray[0] as! [String: AnyObject])\n    }\n}\n\n```. Can you plz explain in details?\nOn May 17, 2017 15:54, \"Erik Little\" notifications@github.com wrote:\n\nAll I see in that log is pings and pongs. So it looks like you're\nconnected successfully. I would make sure that you're using your API\ncorrectly.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/685#issuecomment-302049740,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AFTmhLCAV-pOYzAMEz47anrkB86mAELlks5r6sq_gaJpZM4NZ-VB\n.\n. Thanks. Is any way how can I know that correct event name which is using by\nserver without contact to server guy?\n\nOn May 17, 2017 4:54 PM, \"Erik Little\" notifications@github.com wrote:\n@Nik20112 https://github.com/nik20112 Make sure that you're interfacing\nwith your API correctly, i.e, if the server sends \"hello_world\", you've\nadded a handler for \"hello_world\", and not \"Hello_world\".\nYou can search your whole log for the event names you're expecting to get.\nThey should at least make it to the engine's parser. If they aren't, that\nindicates that you're connecting the wrong server or are not correctly\nauthenticated with it. Authentication is something that is up to the\nprogrammer, it's not handled by the lib.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/685#issuecomment-302061433,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AFTmhEGzcFerRCBzY2UeQnSVFMuA_x99ks5r6tjdgaJpZM4NZ-VB\n.\n. Hi,\nWhen I print the log inside onAny handler its returns me statusChange, connect and info events. All are events which is integrated at server side? and is it compulsory to call this method? But I have also add \"raceresult\" event name but can't print this method with this onAny handler so is there any issue from my side or server side?. Hi,\nPlease help me can't called \"raceresult\" event handler method while android send event to iOS but when I send event to android its working fine. I also checked the android code as well.\nAm I missing something? Please help me to solve this issue.\n```\nfunc addHandlers(activeSerieId : Int) {\n        debugPrint(\"addHandlers\")\n        debugPrint(\"Socket Details and Active Serie Id:::::\",socket,activeSerieId)\n    // Called on every event\n    socket.onAny {debugPrint(\"got event: \\($0.event) with items \\($0.items)\")}\n\n    // Socket Events\n    socket.on(\"connect\") {data, ack in\n        debugPrint(\"socket connected\")\n\n        // Sending messages\n        self.socket.emit(\"serie\", activeSerieId)\n    }\n\n    socket.on(\"raceresult\") { (dataArray, socketAck) -> Void in\n        NotificationCenter.default.post(name: NSNotification.Name(rawValue: \"receivedRaceResultNotification\"), object: dataArray[0] as! [String: AnyObject])\n    }\n\n    socket.connect()\n\n}\n\n```\nThanks. Hi,\nPlease see below event log after enable the log. Please see and let me know the issue from app side or server side if there.\n```\n\"Socket Details and Active Serie Id:::::\"  1942\n2017-05-27 00:23:04.607 Timer[836:689256] LOG SocketIOClient: Adding handler for event: connect\n2017-05-27 00:23:04.610 Timer[836:689256] LOG SocketIOClient: Adding handler for event: raceresult\n2017-05-27 00:23:04.629 Timer[836:689256] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\n\"got event: statusChange with items Optional([SocketIO.SocketIOClientStatus])\"\n2017-05-27 00:23:04.631 Timer[836:689256] LOG SocketIOClient: Adding engine\n2017-05-27 00:23:04.647 Timer[836:689319] LOG SocketEngine: Starting engine. Server: https://v2.Timer.nl:3000\n2017-05-27 00:23:04.650 Timer[836:689319] LOG SocketEngine: Handshaking\n2017-05-27 00:23:04.653 Timer[836:689319] LOG SocketEnginePolling: Doing polling GET https://v2.Timer.nl:3000/socket.io/?transport=polling&b64=1\n2017-05-27 00:23:05.710 Timer[836:689294] LOG SocketEnginePolling: Got polling response\n2017-05-27 00:23:05.731 Timer[836:689294] LOG SocketEngine: Got message: 0{\"sid\":\"i3wBALrI1Z3W_fUQAAka\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2017-05-27 00:23:05.749 Timer[836:689294] LOG SocketEngineClient: Connect\n2017-05-27 00:23:05.750 Timer[836:689294] LOG SocketEnginePolling: Doing polling GET https://v2.Timer.nl:3000/socket.io/?transport=polling&b64=1&sid=i3wBALrI1Z3W_fUQAAka\n2017-05-27 00:23:05.753 Timer[836:689294] LOG SocketEngine: Writing poll:  has data: false\n2017-05-27 00:23:05.754 Timer[836:689294] LOG SocketEnginePolling: Sending poll:  as type: 2\n2017-05-27 00:23:05.764 Timer[836:689294] LOG SocketEnginePolling: Created POST string: 1:2\n2017-05-27 00:23:05.769 Timer[836:689294] LOG SocketEnginePolling: POSTing\n2017-05-27 00:23:05.770 Timer[836:689294] LOG SocketEnginePolling: Doing polling POST https://v2.Timer.nl:3000/socket.io/?transport=polling&b64=1&sid=i3wBALrI1Z3W_fUQAAka\n2017-05-27 00:23:05.904 Timer[836:689319] LOG SocketEnginePolling: Got polling response\n2017-05-27 00:23:05.905 Timer[836:689319] LOG SocketEngine: Got message: 40\n2017-05-27 00:23:05.907 Timer[836:689319] LOG SocketIOClient: Should parse message: 0\n2017-05-27 00:23:05.908 Timer[836:689256] LOG SocketParser: Parsing 0\n2017-05-27 00:23:05.910 Timer[836:689256] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2017-05-27 00:23:05.911 Timer[836:689256] LOG SocketIOClient: Socket connected\n2017-05-27 00:23:05.912 Timer[836:689256] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\n\"got event: statusChange with items Optional([SocketIO.SocketIOClientStatus])\"\n2017-05-27 00:23:05.912 Timer[836:689256] LOG SocketIOClient: Handling event: connect with data: []\n\"got event: connect with items Optional([])\"\n\"socket connected\"\n2017-05-27 00:23:05.913 Timer[836:689319] LOG SocketEngine: Got message: 42[\"info\",\"Welcome to Timer raceresults broadcast\"]\n2017-05-27 00:23:05.916 Timer[836:689319] LOG SocketIOClient: Should parse message: 2[\"info\",\"Welcome to Timer raceresults broadcast\"]\n2017-05-27 00:23:05.917 Timer[836:689319] LOG SocketEngine: Got message: 42[\"info\",\"Local servertime is 1495824785558\"]\n2017-05-27 00:23:05.918 Timer[836:689319] LOG SocketIOClient: Should parse message: 2[\"info\",\"Local servertime is 1495824785558\"]\n2017-05-27 00:23:05.919 Timer[836:689319] LOG SocketEngine: Got message: 42[\"info\",\"Please connect to a specific room\"]\n2017-05-27 00:23:05.920 Timer[836:689319] LOG SocketIOClient: Should parse message: 2[\"info\",\"Please connect to a specific room\"]\n2017-05-27 00:23:05.922 Timer[836:689256] LOG SocketIOClient: Emitting: 2[\"serie\",1942]\n2017-05-27 00:23:05.923 Timer[836:689319] LOG SocketEnginePolling: Doing polling GET https://v2.Timer.nl:3000/socket.io/?transport=polling&b64=1&sid=i3wBALrI1Z3W_fUQAAka\n2017-05-27 00:23:05.931 Timer[836:689256] LOG SocketParser: Parsing 2[\"info\",\"Welcome to Timer raceresults broadcast\"]\n2017-05-27 00:23:05.932 Timer[836:689319] LOG SocketEngine: Writing poll: 2[\"serie\",1942] has data: false\n2017-05-27 00:23:05.933 Timer[836:689319] LOG SocketEnginePolling: Sending poll: 2[\"serie\",1942] as type: 4\n2017-05-27 00:23:05.934 Timer[836:689256] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [info, Welcome to Timer raceresults broadcast]; id: -1; placeholders: -1; nsp: /}\n2017-05-27 00:23:05.939 Timer[836:689256] LOG SocketIOClient: Handling event: info with data: [Welcome to Timer raceresults broadcast]\n\"got event: info with items Optional([Welcome to Timer raceresults broadcast])\"\n2017-05-27 00:23:05.940 Timer[836:689256] LOG SocketParser: Parsing 2[\"info\",\"Local servertime is 1495824785558\"]\n2017-05-27 00:23:05.940 Timer[836:689256] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [info, Local servertime is 1495824785558]; id: -1; placeholders: -1; nsp: /}\n2017-05-27 00:23:05.946 Timer[836:689256] LOG SocketIOClient: Handling event: info with data: [Local servertime is 1495824785558]\n\"got event: info with items Optional([Local servertime is 1495824785558])\"\n2017-05-27 00:23:05.947 Timer[836:689256] LOG SocketParser: Parsing 2[\"info\",\"Please connect to a specific room\"]\n2017-05-27 00:23:05.947 Timer[836:689256] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [info, Please connect to a specific room]; id: -1; placeholders: -1; nsp: /}\n2017-05-27 00:23:05.948 Timer[836:689256] LOG SocketIOClient: Handling event: info with data: [Please connect to a specific room]\n\"got event: info with items Optional([Please connect to a specific room])\"\n2017-05-27 00:23:06.735 Timer[836:689297] LOG SocketEnginePolling: Got polling response\n2017-05-27 00:23:06.735 Timer[836:689297] LOG SocketEngine: Got message: 3\n2017-05-27 00:23:06.739 Timer[836:689297] LOG SocketEnginePolling: Doing polling GET https://v2.Timer.nl:3000/socket.io/?transport=polling&b64=1&sid=i3wBALrI1Z3W_fUQAAka\n2017-05-27 00:23:06.740 Timer[836:689297] LOG SocketEnginePolling: Created POST string: 16:42[\"serie\",1942]\n2017-05-27 00:23:06.741 Timer[836:689297] LOG SocketEnginePolling: POSTing\n2017-05-27 00:23:06.742 Timer[836:689297] LOG SocketEnginePolling: Doing polling POST https://v2.Timer.nl:3000/socket.io/?transport=polling&b64=1&sid=i3wBALrI1Z3W_fUQAAka\n2017-05-27 00:23:06.940 Timer[836:689294] LOG SocketEnginePolling: Got polling response\n2017-05-27 00:23:06.941 Timer[836:689294] LOG SocketEngine: Got message: 42[\"info\",\"Joined room serie_1942\"]\n2017-05-27 00:23:06.942 Timer[836:689294] LOG SocketIOClient: Should parse message: 2[\"info\",\"Joined room serie_1942\"]\n2017-05-27 00:23:06.942 Timer[836:689256] LOG SocketParser: Parsing 2[\"info\",\"Joined room serie_1942\"]\n2017-05-27 00:23:06.943 Timer[836:689256] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [info, Joined room serie_1942]; id: -1; placeholders: -1; nsp: /}\n2017-05-27 00:23:06.943 Timer[836:689256] LOG SocketIOClient: Handling event: info with data: [Joined room serie_1942]\n\"got event: info with items Optional([Joined room serie_1942])\"\n2017-05-27 00:23:06.945 Timer[836:689294] LOG SocketEnginePolling: Doing polling GET https://v2.Timer.nl:3000/socket.io/?transport=polling&b64=1&sid=i3wBALrI1Z3W_fUQAAka\n\"SocketManager.singleton.socket.status\"\n\"connected\"\n2017-05-27 00:23:31.482 Timer[836:689294] LOG SocketEngine: Writing poll:  has data: false\n2017-05-27 00:23:31.483 Timer[836:689294] LOG SocketEnginePolling: Sending poll:  as type: 2\n2017-05-27 00:23:31.484 Timer[836:689294] LOG SocketEnginePolling: Created POST string: 1:2\n2017-05-27 00:23:31.485 Timer[836:689294] LOG SocketEnginePolling: POSTing\n2017-05-27 00:23:31.486 Timer[836:689294] LOG SocketEnginePolling: Doing polling POST https://v2.Timer.nl:3000/socket.io/?transport=polling&b64=1&sid=i3wBALrI1Z3W_fUQAAka\n2017-05-27 00:23:31.723 Timer[836:689455] LOG SocketEnginePolling: Got polling response\n2017-05-27 00:23:31.723 Timer[836:689455] LOG SocketEngine: Got message: 3\n2017-05-27 00:23:31.724 Timer[836:689455] LOG SocketEnginePolling: Doing polling GET https://v2.Timer.nl:3000/socket.io/?transport=polling&b64=1&sid=i3wBALrI1Z3W_fUQAAka\n2017-05-27 00:23:56.772 Timer[836:689487] LOG SocketEngine: Writing poll:  has data: false\n2017-05-27 00:23:56.773 Timer[836:689487] LOG SocketEnginePolling: Sending poll:  as type: 2\n2017-05-27 00:23:56.774 Timer[836:689487] LOG SocketEnginePolling: Created POST string: 1:2\n2017-05-27 00:23:56.776 Timer[836:689487] LOG SocketEnginePolling: POSTing\n2017-05-27 00:23:56.776 Timer[836:689487] LOG SocketEnginePolling: Doing polling POST https://v2.Timer.nl:3000/socket.io/?transport=polling&b64=1&sid=i3wBALrI1Z3W_fUQAAka\n2017-05-27 00:23:57.013 Timer[836:689455] LOG SocketEnginePolling: Got polling response\n2017-05-27 00:23:57.014 Timer[836:689455] LOG SocketEngine: Got message: 3\n2017-05-27 00:23:57.015 Timer[836:689455] LOG SocketEnginePolling: Doing polling GET https://v2.Timer.nl:3000/socket.io/?transport=polling&b64=1&sid=i3wBALrI1Z3W_fUQAAka\n```. Hi,\nCan you please explain in details? What steps I have follow to solve this issue?. ",
    "Hi-World": "ok  Thanks\uff01\uff01\uff01\uff01. ",
    "softctrl": "sorry for open on the master branch. So about the behavior:\nI have a socket io server that have namespace configured.\nI have two clients, one for Android and another for iOS.\nMy android client just do this:\nfinal Socket socket = IO.socket(\"https://my-ip/my-namespace\");\n**And it just works well without any other changing on this code.\nOn the iOS side i just create my socket client in a similar way:\nlet socket = SocketIOClient(socketURL: URL(string: \"https://my-ip/my-namespace\",\n                                  config: [.log(true), .forcePolling(true)])\nSo, with that, it not works. I need to change this to:\nlet socket = SocketIOClient(socketURL: URL(string: \"https://my-ip\",\n                                  config: [.log(true), .forcePolling(true)])\nsocket.nsp = \"/my-namespace\"\nSo, i think that all libraries need to work in the same path. Wy the client Java works right and the Swift code does not?\nthanks for your time.\n. I just miss to send you the versions of the client:\nJava -> socket.io-client-0.8.3\nSwift -> pod 'Socket.IO-Client-Swift', '~> 8.3.0'\nOn the server side i am using nodejs with the \"socket.io\": \"1.7.2\", but the problem is not here. On the Android project i have an behavior and on the iOS i have another.. ok, so if it is a design choice so thats ok. thanks. sorry my bad. i do not want to close.. ",
    "meiyongsheng": "How to transfer pictures (larger pictures). How to transfer pictures (larger pictures). ",
    "patmalt": "Post a system wide notification?. I am confused on what you mean. Is there an existing protocol for connect, disconnect, .. etc? . I also want the ability to know when the socket is connecting. Do any of the previous events correspond to \"connecting\"? \nAlso, reconnecting is different from disconnecting and then connecting the socket again, correct?. I do not want to worry about handling additional state and the edge cases around this suggested method when status is already available. I just need a way to know the new status when it changes.. SocketIOClient is already handling all of state that I need. Adding handleEvent(\"xyz\") will introduce unnecessary complexity to my code. In addition, I need the .connecting status found in SocketIOClientStatus, which you have stated does not exist for handleEvent. I do not want to reason about when I am in a connecting state when SocketIOClient has taken care of that for me.. Ah, I see what you mean. Sorry for the confusion. I suppose this issue is more of an enhancement request.. Right, I just want to be informed when the status field changes on SocketIOClient.. I do not believe this is an issue with the SocketIO framework. I apologize for the noise.. ",
    "ishegg": "@rajeevwhiz you should post your solution anyway for posterity.. ",
    "wongzigii": "@nuclearace Hello, is there any plan for this issue in the next release?. @2fours This will break if the string change in the future release.. This works https://github.com/daront/socket.io-client-swift/commit/ae4ccac98e65b0544e414efa46c2b88046bf88fc. I have the same problem. @ilandbt Did you finally solve this issue? My socket is not receiving disconnect event from server, too. FYI this may relate to #1016. ",
    "fuchenxi": "_socketIO = [[SocketIOClient alloc] initWithSocketURL:[NSURL URLWithString:@\"http://172.28.22.244:8888\"]  config:@{@\"log\":@YES,  @\"forcePolling\":@YES, @\"path\" : @\"/pda/\"}];\n\n. The original url is not with the path, when combined with path, print \"Got unknow error from the service\".But android is normal.. android url is \"http://172.28.22.244:8888/pda\". Hah, the problem has been solved, thank you very much. ",
    "wave2588": "@nuclearace   I'm sure it's right.  . \n\n\nThe client can send message out but cannot receive any message. @nuclearace     https://ohnxaafnw.qnssl.com/o_1bgb0ga0l1cj01evr1v8o1bad1cktk.png\n                      https://ohnxaafnw.qnssl.com/o_1bgb0ga0l1d7m1aoe1n9d1f1u5vbl.png\n\n       Could you please check message again, I add the hander before connect, I still cannot receive message.. @nuclearace    H, I met a crash when i use SocketIOClient\n\nhttps://ohnxaafnw.qnssl.com/o_1bgf9r7da184pjpq16cnqap1uuqg.png. @nuclearace   8.3.0   . Please help me to solve this issue.. ",
    "hidejack": "when i use socket.io client , reconnect and reconnecting event has no message recieved after the connection is successful,I'm confused about that.. I disconnected from wifi , then, I switched back to wifi. reconnect and reconnecting has no message recieved. Do servers need to add codes?. ",
    "marcuschoong": "@nuclearace \nwonder to ask whether the user-agent is still can't configure by ourselves?. solved by following\nhttps://github.com/socketio/socket.io-client-swift/issues/1007. @KKKiller Do you able to solve it ?. I having the same problem but change the import paths to zlib folder doesn't work for me. please help. Hi,\nCase close when upgrade ruby and pod the latest version with 13.1.0.\nThank you.\n. problem solve with the following:\nhttps://github.com/socketio/socket.io-client-swift/issues/920\n@property (strong, nonatomic) SocketManager* manager;. the problem solve after i rename one of the file, however it appear another error that the \"import Starscream\" not found in the ScoketIOClientOption.swift eventhought the folder was place on the project.\n\n. @nuclearace \nI'm still couldn't complete solve the problem, is that possible you can list me the step for how to manually add this source file into objective c project?. problem solve by adding the following to initWithSocketURL\n@\"extraHeaders\":@{@\"user-agent\":[lib getUserAgent]}. ",
    "DenisLaboureyras": "OK thanks for your answers ! I will test it. ",
    "fceldeiro": "Sorry for the late response.\nRegarding to the version, yes, I am in the latest one.. ",
    "gupalov": "Thank you for your answer @nuclearace . ",
    "VikBob": "How does the application switch to the front background?. ",
    "vuevrn": "I am getting the same crash. \nIt crashes here on readString saying \"fatal error: cannot increment beyond endIndex\"\nmutating func read(count: Int) -> String {\n   // crashes on readString\n    let readString = message[currentIndex..<message.characters.index(currentIndex, offsetBy: count)]\n    advance(by: count)\n    return readString\n}\n\nI am getting this error in some cases only, it's working fine for some users, but crashes for other users. May be this is an issue - I am copying this from here.. https://stackoverflow.com/questions/38813676/string-endindex-incrementing-error\n\"That may work in some cases, but can crash with a runtime exception if the strings contain characters outside of the \"basic multilingual plane\" (Emojis, flags, ...).\"\nPlease help. Thank you.\n. It's crashing here,\n5113:42[\"show inbox\",{\"conversations\":[{\"_id\":\"59350005e86086161fbe91e0\",\"datecreated\":\"2017-06-05T06:53:57.240Z\",\"deleted\":[],\"archived\":[],\"seen\":[],\"ad\":{\"aid\":\"971402\",\"title\":\"a\",\"price\":\"0\",\"image\":0,\"is_sold\":\"0\",\"is_removed\":\"0\",\"is_new_item\":\"0\",\"is_priority\":\"0\"},\"sender\":{\"userid\":\"93976\",\"username\":\"c\",\"avatar\":\"\",\"bikeshop\":{\"sid\":\"0\"}},\"recipient\":{\"userid\":\"93591\",\"username\":\"chonghao\",\"avatar\":\"a\",\"bikeshop\":{\"sid\":\"0\"}},\"__v\":10,\"message\":{\"createdAt\":\"2017-06-05T06:56:04.440Z\",\"conversationId\":\"59350005e86086161fbe91e0\",\"body\":\"\ud83d\udc4e\",\"author\":\"93591\",\"meta\":\"text\",\"_id\":\"59350084e86086161fbe9208\"}}]}]\nclient v 1.0 , although it's working fine for some other users. for some it's crashing here.. sorry. client 8.3.3. server is using socket io 2.0.1, so I need 10.0. thank you for the help.. ",
    "geopapyrus": "this is crashing 8.8% of my app sessions!. server 2.0.1, client 9.0.0\nshould I bump up the client to 10? Do I have to change the client code if I upgrade?\nthanks. ",
    "ijean": "Thanks.. ",
    "MRodSebastian": "Yes, im using this method in mi sessionManager\nswift\nfunc urlSession(_ session: URLSession, didReceive challenge: URLAuthenticationChallenge, completionHandler: @escaping (URLSession.AuthChallengeDisposition, URLCredential?) -> Void) {\n        if challenge.protectionSpace.authenticationMethod == NSURLAuthenticationMethodServerTrust {\n            let serverTrust = challenge.protectionSpace.serverTrust\n            completionHandler(Foundation.URLSession.AuthChallengeDisposition.useCredential, URLCredential(trust: serverTrust!))\n        }\n    }\nBut it's never called.... ",
    "EmotionV": "i have same question. how do you solve that . ",
    "sinkync": "Thanks a lot, It works. We re using socket.io on server and client v10. I downgraded to v9 and fixed.. ",
    "pekebyte": "Hi,\nI am kind of newbie on swift development, but I had done several projects with socket.io on web in the past.\nI succesfully import your Swift 4 branch on my project adding this to my Podfile\npod 'Socket.IO-Client-Swift', :git => 'https://github.com/socketio/socket.io-client-swift.git', :branch => 'swift4.0'\nAnd had no problems building the project. Then I tried with this code\n```\nlet socket = SocketIOClient(socketURL: URL(string: \"http://tuptip.dev\")!, config: [.log(true), .compress])\n    socket.on(clientEvent: .connect) {data, ack in\n        print(\"socket connected\")\n    }\n\n    socket.connect()\n\n```\nAnd this throws me the following message:\nOG SocketEnginePolling: Got poll message: 97:0{\"sid\":\"aSEgh2S6EucfeQjGAAAN\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}2:40\nSo I added to the config .forceWebsockets(true) and had this response:\n2017-09-12 18:57:19.594020-0400 marketplace[21821:2106484] LOG SocketEngine: Starting engine. Server: http://myserver.dev\n2017-09-12 18:57:19.594191-0400 marketplace[21821:2106484] LOG SocketEngine: Handshaking\n2017-09-12 18:57:19.622503-0400 marketplace[21821:2106484] LOG SocketEngine: Engine is being released\nNo \"socket connected\" printed. How I can make this thing work? xD. \nThanks in advance for any help provided.. Thanks a lot! It worked!.. ",
    "vshalvaghasiya": "give me solution please ?\n. ",
    "jinsust": "I see demo code is like\n[socket emit:@\"update\" withItems:@[@{@\"amount\": @(cur + 2.50)}]];\nWhen I use withItems I got an error:\nNo visible @interface for 'SocketIOClient' declares the selector 'emit:withItems:'. use emit:with  method like this:\n [_socket emit:@\"webrtc\" with:@[msg]];. ",
    "oyosc": "hello,i meet the same issue with you,can you tell me how to solve this problem?. ",
    "longxdragon": "how to solve this problem? @jinsust . ",
    "jose920405": "+1.  No \ud83d\ude22 . hi @chirag225 .\nyou definitely had to go down to 8.3.3?\nyou could not run the last 11.1.2, as did @nuclearace ?\nI went back to doing all the steps from 0 again and I still have the error in import.\n\n. Hi @nuclearace ,\nMi xcode is 8.3.2 and I keep replicating the problem, doing everything from the beginning of time, from pod init.\nCan you give us a step by step of how you do it? and help us updating the readme, because surely the steps that are there do not work for objective-c. @nuclearace thank you very very much.\nMy project had no pods, I'm just starting pods just for this library.\n```\ntarget 'myProj QA' do\n  # Comment the next line if you're not using Swift and don't want to use dynamic frameworks\n  use_frameworks!\n# Pods for myProj QA\n  pod 'Socket.IO-Client-Swift', '~> 11.1.2'\nend\n```\nI am working on a project that has not been updated for more than 1 year and is written completely in objective c, the only files that had in swift, are those of this module. This project is only running in xcode 7.3 and what I try to do is run it in xcode 8.\nI'm not sure which version of the library is being used, except that the library has been imported manually. When I try to run xcode 8, the only thing that failed was everything related to socketio, because syntax converted from xcode not works correctly.. \n. \ud83d\ude2e  Let me try. Thank you\n. Apparently not the cause, the problem persists. IOS 10 too.\nWhen run xcode 8 ==> ios 10\nWhen run xcode 7.3 ==> ios 9. I think maybe the problem is that this module does not work except for xcode 8.3.3 and later, because in mine that is 8.3.2 it is impossible to make it work.\nI removed all the implementation that I had made to support this library and tried to run the project again and all the files in the library had syntax errors. It makes me think that this xcode does not have the syntax or the correct version of swift from where the changes were made.\nI even went down to the version that said @chirag225  that worked for him and I had the same problem.\nAllow me to update my xcode to 8.3.3 and confirm if this solves the problem.. hi @chirag225. \nI have not worked on this at the moment. My boss gave me one priority thing to do and I have postponed this test I was going to do with xcode 8.3.3. ",
    "badechanti": "I am new to IOS developer and pod concept. I am using Mac O.S 10.12.6 , xcode - 8.3.3 and swift4\nwhen i am trying establish socket io connection it is throws error like \"No such module 'SocketIO'\"\nplease help me to short out the issue\n\nIf I add Source file directory I am getting  \"No such module 'StarscreamSocketIO'\"\nbelow I am providing Screen shot also\n\n. ",
    "MD04-TanTan": "Could you tell me how to import socket.io-client-swift to a Objective C project. I installed it from cocoapods but then xcode can not complie success. I used xcode 9.4 . Thanks @chirag225 . I have fix it done . Could you tell me import socket.io-client-swift lib to objective c project? I installed it from cocoapods success but then xcode not complie. Could you tell me how to import 'socket.io-client-swift' lib to objective c project?\n. \n\nThanks for reply @jaragones  i tried to build many times but it's not working \n. Thanks u guys !!!! I found it, the problem is missing \" use_frameworks! \" keyword in my pod file . Hi @Rupasekhar  !! Could u tell me how to import this lib to a Objective C project?. I installed it from cocoapods but my xcode (9.4) can not complie with ~201 error . ",
    "jonjes468250": "sorry \ni found error with my code  . ",
    "hashier": "But now people (I) wonder what should I do if I had socket.io-client-swift and Starscream before in my project.\nShould I now remove Starscream and just let the copied version be in there? Are there any differences between Starscream and StarscreamSocketIO? What if they diverge? Why not just stay with a normal dependency?. Any recommendations how to set up cocoapods now? I used Starscream in cocoapods, now with the updated SocketIO what's your suggestion? Remove Starscream from the Podfile and just use the one that comes bundled with SocketIO?\nStill it feels a bit clunky not to just have a dependency in the cocapod spec file to Starscream (but I get it, if you need changes on Starscream. I just hope I don't end up at some point that Starscream has features I need that you don't have in your copy of Starscream and I can't use Starscream because of name clashes.). Thanks for all this insight! Much appreciated.. ",
    "jtjacka": "I have feeling it is related to this commit.  https://github.com/socketio/socket.io-client-swift/commit/99faafe7234c6fa9780b91c8d4b5a99263723cce @alevinru \nEdit: Possibly not, looks like this commit was in there before 8.3.3. ",
    "devliuhuan": "if not set nps\uff0csocket.io can not send any business data after it connected. ",
    "vksid": "How can I validate url in iOS ?\ncanOpenUrl method in iOS return false for url \"ws://example.com\". ",
    "kotvrt": "@timvermeulen Hey Tim, did you manage to connect in the end? I'm having issues connecting to the same websocket but I'm trying in Python. Just wanted to follow up on this as you may have some useful info for me. Thanks!. ",
    "timvermeulen": "@yudevit I haven't attempted it since, sorry about that \ud83d\ude15. Thanks @pandeyshivang, works great!. ",
    "ArbabR": "Hey @timvermeulen \nreplace URL(string: \"wss://streamer.cryptocompare.com\")!\nwith\nURL(string: \"https://streamer.cryptocompare.com/\")! and it will connect without any issue.\nBut I am stuck at \nself.socket?.emitWithAck(\"SubAdd\", [ \"subs\" : [\"0~CCCAGG~BTC~USD\"]]).timingOut(after: 0, callback: { (data) in\n                print(\"data is : (data)\")\n            })   \ncallback never called :(. Change swift version in Xcode. ",
    "pandeyshivang": "yeah finally @timvermeulen @nuclearace @yudevit @IdeaCentricity @banjun ,\n```\nimport SocketIO\nclass SocketIOManager :NSObject{\n    var data:NSString?\n    static let sharedInstant = SocketIOManager()\n    var socket: SocketIOClient = SocketIOClient(socketURL: NSURL(string: \"https://streamer.cryptocompare.com\")! as URL, config: [.log(true), .forcePolling(true)])\noverride init() {\n    super.init()\n    print(\"init called\")\n    let dict = [ \"subs\" : [\"5~CCCAGG~BTC~USD\"]]\n\n\n    socket.on(clientEvent: .connect) {data, ack in\n        print(\"socket connected \\(data) \\(ack)\")\n        self.socket.emit(\"SubAdd\", dict)\n    }\n\n\n    socket.on(\"m\", callback: {data,ack in\n        print(\"M printed\")\n        print(\"M \\(data)\")\n        let myString: String = String(describing: data[0])\n        if myString == \"3~LOADCOMPLETE\"{\n             self.socket.emit(\"SubRemove\", dict)\n           // SocketIOManager.init()\n        }else {\n            var myStringArr = myString.components(separatedBy: \"~\")\n            print(\"Price Updated \\(myStringArr[5])\")\n\n        }\n\n\n    })\n}\nfunc establishConnection() {\n    socket.connect()\n\n}\nfunc closeConnection() {\n    socket.disconnect()\n}\n\n}\n```. @imobdevtech  follow this(Swift) implemention in JAVA and use https://github.com/socketio/socket.io-client-java\n. @imobdevtech wait...i'll share code . @imobdevtech  i think you were missing or wrong emit before soket.onlistener callback.. > Found the right way for Java version. The following should work:\n\nJSONObject object = new JSONObject();\nJSONArray arr = new JSONArray();\ntry {\narr.put(\"11~BTC'\");\nobject.put(\"subs\", arr);\nsocket.emit(\"SubAdd\", object);\n} catch (JSONException e) {\ne.printStackTrace();\n}\n\nplease try to use hashmap and arraylist instead of jsonobject and array. ",
    "imobdevtech": "@pandeyshivang have you do same thing in android because in iOS your solution works but in android it is not working .. @pandeyshivang we already follow all the step which is in swift but we stuck at emit statement , everytime we got 1 - bad request . can you please share that portion code in android if feasible . @pandeyshivang finally find the solution thank you for your support. ",
    "cbadhrinath": "\n@pandeyshivang finally find the solution thank you for your support\n\ncould you please post the correct solution you found. I'm having the same issue here.. Found the right way for Java version. The following should work:\nJSONObject object = new JSONObject();\nJSONArray arr = new JSONArray();\ntry {\narr.put(\"11~BTC'\");\nobject.put(\"subs\", arr);\nsocket.emit(\"SubAdd\", object);\n} catch (JSONException e) {\ne.printStackTrace();\n}. @pandeyshivang The performance is the same as HashMap and no extra overhead. \nAlso, considering that we are dealing with actual JSON on the request, I highly recommend it.\nThe actual docs use JSONObject too.\nhttps://github.com/socketio/socket.io-client-java - check the readme.. ",
    "DaVincii": "For socket.io v2.0.3 (js client):\nWhen you use socket.io on client side the client socket.io makes some network calls as explained:\n1. When io.connect() is called, the  socket.io library makes a call to the server which looks like \n?EIO=3&transport=polling&t=LqtOnHh, server responds with something like  \"90:0{\"sid\":\"pcJM_AEZirrJT-DuAAUy\",\"upgrades[],\n\"pingInterval\":3600000,\"pingTimeout\":3600000}2:40\"\nhere the server generates a socket object on server side and sends its id back to the client.\n2. After this client makes call to the server which is something like \n?EIO=3&transport=polling&t=LqtR6Rn&sid=0JFGcEFNdrS-XBZeAAXM, this is the long poll call that client makes to the server, if you see here it is passing the sessionId which it received in first call above, if the call goes to same node which generated that sessionId, the node identifies the socket connection for which the request has been made and responds.\nBut behind ELB the call may go to some other node that didn't generate this sessioIs, in that case the node will not be able to identify the sessionId for which the call was made and hence responds with {\"code\":1,\"message\":\"Session ID unknown\"}\nYou will also see this error in case of long polling not getting answered or getting timeout.. @butterpuf  use stickiness to get rid of this problem. ",
    "p3x-robot": "for me, it was with nginx ssl http2, and it was polling, so the good config is:\njs\n const ioSocket = io('', {\n      // Send auth token on connection, you will need to DI the Auth service above\n      // 'query': 'token=' + Auth.getToken()\n      path: '/socket.io',\n      transports: ['websocket'],\n      secure: true,\n    });. ",
    "vijeshv": "?EIO=3&transport=polling&t=LqtOnHh\nwhat is the significance of t=LqtOnHh\nis t a timestamp . but  how LqtOnHh is comuting?. ",
    "ambujshukla": "You can install the files via cocoapod. It has no issue like this.\npod 'Socket.IO-Client-Swift'\n. ",
    "KKKiller": "so what should if i want to use it manual,what is the extar work?. what should i do about CommonCrypto. About your reply   \"You have to add the zlib header as a private header for your project and change the Swift framework path to point to the zlib folder.\" \n I'm sorry to tell you  that  i don't know hot to make it. can you show me  step by step. such as how to add a private header to my project and how to point the folder.\n  A thousand thanks!. ",
    "akdsouza": "For someone still having the issue, adding pod 'Starscream', '<= 3.0.5' solves the issue. See https://github.com/daltoniam/Starscream/issues/575. ",
    "mueslifante": "I have the same problem\n. ",
    "b593771943": "it was on Wifi:\n2017-07-10 10:04:50.794147  socket reconnectAttempt\n2017-07-10 10:04:50.797302  statusChange - socket_connecting\n2017-07-10 10:05:01.793191 socket reconnectAttempt\n2017-07-10 10:05:01.794646  statusChange - socket_connecting\n2017-07-10 10:05:12.794515 socket reconnectAttempt\n2017-07-10 10:05:12.797918 statusChange - socket_connecting\n2017-07-10 10:05:15.225965 statusChange - socket_connected\n2017-07-10 10:05:15.757522 statusChange - socket_connected\n2017-07-10 10:05:15.800963 statusChange - socket_connected\n2017-07-10 10:05:16.287677 connectAuth\n2017-07-10 10:05:16.609601 statusChange - socket_notConnected\n2017-07-10 10:05:16.614179  socket reconnect\n2017-07-10 10:05:16.618157  socket reconnectAttempt\n2017-07-10 10:05:16.621194 statusChange - socket_connecting\n2017-07-10 10:05:16.631455 statusChange - socket_notConnected\n2017-07-10 10:05:16.861426  socket error\n2017-07-10 10:05:16.864212  statusChange - socket_notConnected\n2017-07-10 10:05:16.889238 statusChange - socket_notConnected\n2017-07-10 10:05:16.955097 socket error\n2017-07-10 10:05:16.958250 statusChange - socket_notConnected\n2017-07-10 10:05:17.881664  statusChange - socket_notConnected\n2017-07-10 10:05:23.200070  socket reconnectAttempt\n2017-07-10 10:05:23.202101  statusChange - socket_connecting\n2017-07-10 10:05:23.204333  statusChange - socket_notConnected\n2017-07-10 10:05:26.407202  statusChange - socket_notConnected. 2017-07-10 10:39:17.063829  socket error\n2017-07-10 10:39:17.067776  statusChange - socket_notConnected\n2017-07-10 10:39:17.454527  socket reconnectAttempt\n2017-07-10 10:39:17.456139  statusChange - socket_connecting\n2017-07-10 10:39:19.455016  socket reconnectAttempt\n2017-07-10 10:39:19.456552  statusChange - socket_connecting\n2017-07-10 10:39:28.072323  socket reconnectAttempt\n2017-07-10 10:39:28.074662  statusChange - socket_connecting\n2017-07-10 10:39:29.523116  socket reconnectAttempt\n2017-07-10 10:39:29.524550  statusChange - socket_connecting. I send the message when the socketClient is not connected, and set to send a timeout of 20 seconds.     Even if the socket is  connected  before the timeout, the message still Can't be sent successfully. Thanks for your anwser. ",
    "goharika": "the last one, I haven't add version on pod so it should be last one. I have add from frameworks too, it seems working, but it mean I have done both pod install and manual too, in some cases apple reject such installations, or bringing errors. ",
    "vincelupo": "edit:  I updated my pod file to say  > 10 instead of > 11 and ran \"POD UPDATE\" and it pulled 10.2.  That makes me think that there isn't a cocoaPod for v11 yet.  \nWhat is the latest version of it?    I can't seem to pod install v11.\n```\nuse_frameworks!\ntarget \u2018SocketChat\u2019 do\n    pod 'Socket.IO-Client-Swift\u2019,  '~> 10.0.0' # Or latest version\n    pod 'Starscream', '~> 2.0.3'\nend\n```. ",
    "9527001": "\u5168\u662f\u5916\u56fd\u4eba\u5417\n. The version of current cocoapods is 11.0.0 ? I'm 1.2.1 . why?. @nuclearace. ",
    "srinivasgadda": "I am using the pod with 11.0.1 but still no such module error. I have noticed that the framework was not converted to Swift 3 syntax. When I try to convert, it is giving more than 150 errors in the pod project.\npod 'Socket.IO-Client-Swift', '~> 11.0.1'. I found the issue that the library's swift language version not defined. I went to Build Settings for the framework and chosen Swift 3 as swift language. Now, able to get it.. ",
    "Spadille": "same issue with Xcode 8.33, swift 3 and cocopods 1.3.1, I tried every solution before but did not work. @nuclearace It's version 11.1.1 and the error is 'no such module', thanks!. ",
    "goroya": "Me too on cocoapod 1.4.0.beta.1.\n. ",
    "nhnam": "try import #import  instead of #import . It has been changed to #import . ",
    "jbmolle": "Yes I can check server logs.\nI have socket.on(\"connection\") on the server and it doesn't get called. Should I check something else on the server?\nIf I take off forceWebsockets, it doesn't work. I get:\n0{\"sid\":\"Btz7E9OP_NKfwL3IAAAA\",\"upgrades\":[websockets],\"pingInterval\":25000,\"pingTimeout\":60000}\nand then it upgrades to websocket and get stuck like when I force it.\nThanks,\nJB. Here is the log on the server for Android:\n Wed, 12 Jul 2017 13:29:42 GMT engine intercepting request for path \"/socket.io/\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT engine handling \"GET\" http request \"/socket.io/?EIO=3&token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6IjU4YjVhNDFlNDUzYTcxMTEwMGZhN2U4YSIsImV4cCI6MTQ5OTk0MDYxMC40MDd9.0ZgQ5pFb-OtCcPTDgiHT3pp-7aIT5Ih-42ohk3buJ4I&transport=polling\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT engine handshaking client \"4sX3iIJ1WC_26ZHeAAAA\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT engine:socket sending packet \"open\" ({\"sid\":\"4sX3iIJ1WC_26ZHeAAAA\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000})\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT engine:polling setting request\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT engine:socket flushing buffer to transport\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT engine:polling writing \"97:0{\"sid\":\"4sX3iIJ1WC_26ZHeAAAA\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT engine:socket executing batch send callback\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT socket.io:server incoming connection with id 4sX3iIJ1WC_26ZHeAAAA\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT socket.io:client connecting to namespace /\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT socket.io:namespace adding socket to nsp /\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT socket.io:socket socket connected - writing packet\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT socket.io:socket joining room 4sX3iIJ1WC_26ZHeAAAA\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT socket.io:socket packet already sent in initial handshake\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT socket.io:socket joined room 4sX3iIJ1WC_26ZHeAAAA\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT engine intercepting request for path \"/socket.io/\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT engine handling \"POST\" http request \"/socket.io/?EIO=3&token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6IjU4YjVhNDFlNDUzYTcxMTEwMGZhN2U4YSIsImV4cCI6MTQ5OTk0MDYxMC40MDd9.0ZgQ5pFb-OtCcPTDgiHT3pp-7aIT5Ih-42ohk3buJ4I&sid=4sX3iIJ1WC_26ZHeAAAA&transport=polling\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT engine setting new request for existing client\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT engine:polling received \"\ufffd40/user\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT engine:socket packet\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT socket.io-parser decoded 0/user as {\"type\":0,\"nsp\":\"/user\"}\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT socket.io:client connecting to namespace /user\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT socket.io:namespace adding socket to nsp /user\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT mquery findOne users { _id: 58b5a41e453a711100fa7e8a } { fields: {} }\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT socket.io:socket socket connected - writing packet\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT socket.io:socket joining room /user#4sX3iIJ1WC_26ZHeAAAA\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT socket.io:client writing packet {\"type\":0,\"nsp\":\"/user\"}\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT socket.io-parser encoding packet {\"type\":0,\"nsp\":\"/user\"}\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT socket.io-parser encoded {\"type\":0,\"nsp\":\"/user\"} as 0/user,\nellistra-backend_1  | Wed, 12 Jul 2017 13:29:42 GMT engine:socket sending packet \"message\" (0/user,)\nellistra-backend_1  | Connection\nConnection means that my socket is connected.\nAnd on iOS I get this:\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine intercepting request for path \"/socket.io/\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine handling \"GET\" http request \"/socket.io/?transport=polling&b64=1&token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6IjU4YjVhNDFlNDUzYTcxMTEwMGZhN2U4YSIsImV4cCI6MTUwMDQ1Mzg4My4zMzR9.k7NHlgkPD5CJESaqjqCC2dF4SMrb6UJe2v75C5iO190\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine handshaking client \"Koo0tc4_d46CgF21AAAA\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine:socket sending packet \"open\" ({\"sid\":\"Koo0tc4_d46CgF21AAAA\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000})\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine:polling setting request\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine:socket flushing buffer to transport\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine:polling writing \"97:0{\"sid\":\"Koo0tc4_d46CgF21AAAA\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine:socket executing batch send callback\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT socket.io:server incoming connection with id Koo0tc4_d46CgF21AAAA\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT socket.io:client connecting to namespace /\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT socket.io:namespace adding socket to nsp /\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT socket.io:socket socket connected - writing packet\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT socket.io:socket joining room Koo0tc4_d46CgF21AAAA\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT socket.io:socket packet already sent in initial handshake\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT socket.io:socket joined room Koo0tc4_d46CgF21AAAA\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine intercepting request for path \"/socket.io/\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine handling \"GET\" http request \"/socket.io/?transport=polling&b64=1&token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6IjU4YjVhNDFlNDUzYTcxMTEwMGZhN2U4YSIsImV4cCI6MTUwMDQ1Mzg4My4zMzR9.k7NHlgkPD5CJESaqjqCC2dF4SMrb6UJe2v75C5iO190&sid=Koo0tc4_d46CgF21AAAA\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine setting new request for existing client\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine:polling setting request\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine intercepting request for path \"/socket.io/\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine handling \"POST\" http request \"/socket.io/?transport=polling&b64=1&token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6IjU4YjVhNDFlNDUzYTcxMTEwMGZhN2U4YSIsImV4cCI6MTUwMDQ1Mzg4My4zMzR9.k7NHlgkPD5CJESaqjqCC2dF4SMrb6UJe2v75C5iO190&sid=Koo0tc4_d46CgF21AAAA\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine setting new request for existing client\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine:polling received \"1:2\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine:socket packet\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine:socket got ping\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine:socket sending packet \"pong\" (undefined)\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine:socket flushing buffer to transport\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine:polling writing \"1:3\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine intercepting request for path \"/socket.io/\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine handling \"GET\" http request \"/socket.io/?transport=polling&b64=1&token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6IjU4YjVhNDFlNDUzYTcxMTEwMGZhN2U4YSIsImV4cCI6MTUwMDQ1Mzg4My4zMzR9.k7NHlgkPD5CJESaqjqCC2dF4SMrb6UJe2v75C5iO190&sid=Koo0tc4_d46CgF21AAAA\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine setting new request for existing client\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine:polling setting request\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:24 GMT engine:socket executing batch send callback\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:35 GMT engine intercepting request for path \"/socket.io/\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:35 GMT engine handling \"GET\" http request \"/socket.io/?transport=polling&b64=1&token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6IjU4YjVhNDFlNDUzYTcxMTEwMGZhN2U4YSIsImV4cCI6MTUwMDQ1Mzg4My4zMzR9.k7NHlgkPD5CJESaqjqCC2dF4SMrb6UJe2v75C5iO190\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:35 GMT engine handshaking client \"ZpfTQvTD3cVYiolHAAAB\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:35 GMT engine:socket sending packet \"open\" ({\"sid\":\"ZpfTQvTD3cVYiolHAAAB\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000})\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:35 GMT engine:polling setting request\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:35 GMT engine:socket flushing buffer to transport\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:35 GMT engine:polling writing \"97:0{\"sid\":\"ZpfTQvTD3cVYiolHAAAB\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:35 GMT engine:socket executing batch send callback\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:35 GMT socket.io:server incoming connection with id ZpfTQvTD3cVYiolHAAAB\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:35 GMT socket.io:client connecting to namespace /\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:35 GMT socket.io:namespace adding socket to nsp /\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:35 GMT socket.io:socket socket connected - writing packet\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:35 GMT socket.io:socket joining room ZpfTQvTD3cVYiolHAAAB\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:35 GMT socket.io:socket packet already sent in initial handshake\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:35 GMT socket.io:socket joined room ZpfTQvTD3cVYiolHAAAB\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:44 GMT engine intercepting request for path \"/socket.io/\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:44 GMT engine handling \"GET\" http request \"/socket.io/?transport=polling&b64=1&token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6IjU4YjVhNDFlNDUzYTcxMTEwMGZhN2U4YSIsImV4cCI6MTUwMDQ1Mzg4My4zMzR9.k7NHlgkPD5CJESaqjqCC2dF4SMrb6UJe2v75C5iO190\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:44 GMT engine handshaking client \"cJMY_CAb3ucdF5HOAAAC\"\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:44 GMT engine:socket sending packet \"open\" ({\"sid\":\"cJMY_CAb3ucdF5HOAAAC\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000})\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:44 GMT engine:polling setting request\nellistra-backend_1  | Wed, 12 Jul 2017 13:28:44 GMT engine:socket flushing buffer to transport\nIf it can helps. Hi,\nI've done more digging in the Swift code and I may have found where the problem comes from. \nIn SocketParsable.swift, we join the namespace in the function handleConnect(_ packetNamespace: String) which is called only when we get the event .connect. \nBut I never get this event and so I never join the namespace. \nIn SocketIOClient.swift, when I put this piece of code in open func engineDidOpen(reason: String):\nif reason == \"Connect\" {\n  joinNamespace(nsp)\n}\nthen everything works.\nI don't know if this hack is good. Nuclearace, let me know what you think.\nBest,\nJB. ",
    "jameslin0928": "We also encountered the same problem, but also solved by the @jbmolle method. ",
    "kjoe07": "this code should be part of the library . i have to recview this code for more undertanding but the truth is server on windows is responding to the connect event but server running on linux ubunto 16 is not respondign to the event un least this code is added. i check it in test that logic to see if in that way i get the message form server . well after a pod update i used 10.0.0 but today i updated to 12.0.0 and in deed in cloud ubuntu server is not working with the namespace without the mentioned solution. in windows locally runing node 6.10 is working perfect. i gave you maore details about the server in minutes. yes send a private message to pass data of the server\n. here is server soket file using loopback and nodejs\n\"use strict\";\nconst assert = require('assert');\nconst async = require('async');\nconst _ = require('underscore');\nconst app = require('../server');\nmodule.exports = function (app, io) { \n    var vendedorSocket = io.of('/vendedor').use(function (socket, next) {\n        var accessToken = socket.handshake.query.accessToken;\n        if (!accessToken) {\n            return next(new Error('There is no access token to make a handshake'));\n        }\n        app.models.AccessToken.findById(accessToken, function (err, accesstoken_inst) {\n            if (err) return next(new Error(err));\n            if (!accesstoken_inst) return next(new Error('The access token provided is not valid or expired.'))\n            socket.id = accesstoken_inst.id;\n            socket.userId = accesstoken_inst.userId;\n            return next();\n        });\n    });\nfunction throwSocketException(socket, message) {\n    socket.emit('exception', {message: message});\n}\nvendedorSocket.on('connection', function (socket) {\n    console.log('Un vendedor se ha conectado');\n    socket.on('setLocation', function(data){\n        try{\n                assert(data.lng, \"No longitude provided.\");\n                assert(data.lat, \"No latitude provided\");\n                assert(data.idvendedor, \"No idvendedor provided\");\n                console.log('Ha cambiado la ubicaci\u00f3n de un vendedor');\n                app.models.mapa.find({where: {vendedorId: data.idvendedor, activa: true }}, function(err, ubicaciones_inst) {\n                    if (err) throw(err);\n                    if(ubicaciones_inst && ubicaciones_inst.length > 0){\n                        ubicaciones_inst.forEach(function (ubicacion) {\n                            ubicacion.activa = false;\n                            ubicacion.save();\n                        });\n                    }\n                });\n                var geopoint = {lat: data.lat, lng: data.lng};\n                app.models.mapa.create({coordenadas: geopoint, activa: true, vendedorId: data.idvendedor, created: Date.now()}, function(err, ubicacion_inst){\n                    if(err) throw(err);\n                    else if(ubicacion_inst){\n                        socket.emit('locationChanged', ubicacion_inst);\n                    }\n                });\n        }\n        catch(ex){\n            throwSocketException(socket, ex.message);\n        }\n    });\n});\n\n};. how to test it\n. sorry for the late response, can not test development branch yesterday but now i can confirm is working good in the server it was not working the socket connection. so you may now make a new release.. perhas i have to make a converstion to swift 4 ill try an say. true the project was using swift 3.2. ",
    "gNetLabs": "We have encountered the same problem and have fixed it the same way. If this code is acceptable it should be released. . The development branch is working for me. . ",
    "microacup": "We have the same problem, solved by the @jbmolle method. ",
    "TomZid": "I have solved the same issue by @jbmolle method,thanks. @huFly can you please explane how you solve your problem cause I encountered the same issue. 2017-10-21 14:33:23.793838+0800 JSQMessages[10266:1151709] LOG SocketEngine: Got message: 42/im/user,[\"message\",{\"nickName\":\"\u5c0f\u5609\",\"message\":\"{\\\"questions\\\":[{\\\"questionId\\\":\\\"5820160000078895\\\",\\\"question\\\":\\\"\u501f\u6b3e\u63d0\u73b0\u65f6\u95f4\\\"},{\\\"questionId\\\":\\\"5820160000078896\\\",\\\"question\\\":\\\"\u501f\u6b3e\u5230\u8d26\u65f6\u95f4\\\"},{\\\"questionId\\\":\\\"5820160000078897\\\",\\\"question\\\":\\\"\u501f\u6b3e\u5ba1\u6838\u65f6\u95f4\\\"},{\\\"questionId\\\":\\\"5820160000078887\\\",\\\"question\\\":\\\"\u81ea\u52a8\u63d0\u73b0\u5230\u4fe1\u7528\u5361\u8fd8\u662f\u94f6\u884c\u5361\uff08\u501f\u8bb0\u5361\uff09\\\"},{\\\"questionId\\\":\\\"5820160000078885\\\",\\\"question\\\":\\\"\u663e\u793a\u6210\u529f\u501f\u6b3e\u4e86\uff0c\u600e\u4e48\u53c8\u81ea\u52a8\u653e\u5f03\u4e86\\\"},{\\\"questionId\\\":\\\"5820160000078937\\\",\\\"question\\\":\\\"\u600e\u4e48\u89e3\u7ed1\u4fe1\u7528\u5361/\u94f6\u884c\u5361\\\"},{\\\"questionId\\\":\\\"5820160000078938\\\",\\\"question\\\":\\\"\u7ed1\u5b9a\u94f6\u884c\u5361\u65f6\u7cfb\u7edf\u5f02\u5e38/\u7cfb\u7edf\u7e41\u5fd9\\\"},{\\\"questionId\\\":\\\"5820160000078923\\\",\\\"question\\\":\\\"\u8fd8\u6b3e\u65e0\u6cd5\u63d0\u4ea4/\u7cfb\u7edf\u63d0\u793a\u9519\u8bef\u6216\u7e41\u5fd9\\\"},{\\\"questionId\\\":\\\"5820160000078924\\\",\\\"question\\\":\\\"\u903e\u671f\u8fd8\u6b3e\u662f\u5426\u4f1a\u6709\u903e\u671f\u8bb0\u5f55\u548c\u7f5a\u606f\\\"},{\\\"questionId\\\":\\\"5820160000078925\\\",\\\"question\\\":\\\"\u5df2\u7ecf\u6263\u6b3e\u4e3a\u4ec0\u4e48\u8fd8\u663e\u793a\u6709\u6b20\u6b3e\\\"}],\\\n2017-10-21 14:33:23.795895+0800 JSQMessages[10266:1151709] LOG SocketIOClient: Should parse message: 2/im/user,[\"message\",{\"nickName\":\"\u5c0f\u5609\",\"message\":\"{\\\"questions\\\":[{\\\"questionId\\\":\\\"5820160000078895\\\",\\\"question\\\":\\\"\u501f\u6b3e\u63d0\u73b0\u65f6\u95f4\\\"},{\\\"questionId\\\":\\\"5820160000078896\\\",\\\"question\\\":\\\"\u501f\u6b3e\u5230\u8d26\u65f6\u95f4\\\"},{\\\"questionId\\\":\\\"5820160000078897\\\",\\\"question\\\":\\\"\u501f\u6b3e\u5ba1\u6838\u65f6\u95f4\\\"},{\\\"questionId\\\":\\\"5820160000078887\\\",\\\"question\\\":\\\"\u81ea\u52a8\u63d0\u73b0\u5230\u4fe1\u7528\u5361\u8fd8\u662f\u94f6\u884c\u5361\uff08\u501f\u8bb0\u5361\uff09\\\"},{\\\"questionId\\\":\\\"5820160000078885\\\",\\\"question\\\":\\\"\u663e\u793a\u6210\u529f\u501f\u6b3e\u4e86\uff0c\u600e\u4e48\u53c8\u81ea\u52a8\u653e\u5f03\u4e86\\\"},{\\\"questionId\\\":\\\"5820160000078937\\\",\\\"question\\\":\\\"\u600e\u4e48\u89e3\u7ed1\u4fe1\u7528\u5361/\u94f6\u884c\u5361\\\"},{\\\"questionId\\\":\\\"5820160000078938\\\",\\\"question\\\":\\\"\u7ed1\u5b9a\u94f6\u884c\u5361\u65f6\u7cfb\u7edf\u5f02\u5e38/\u7cfb\u7edf\u7e41\u5fd9\\\"},{\\\"questionId\\\":\\\"5820160000078923\\\",\\\"question\\\":\\\"\u8fd8\u6b3e\u65e0\u6cd5\u63d0\u4ea4/\u7cfb\u7edf\u63d0\u793a\u9519\u8bef\u6216\u7e41\u5fd9\\\"},{\\\"questionId\\\":\\\"5820160000078924\\\",\\\"question\\\":\\\"\u903e\u671f\u8fd8\u6b3e\u662f\u5426\u4f1a\u6709\u903e\u671f\u8bb0\u5f55\u548c\u7f5a\u606f\\\"},{\\\"questionId\\\":\\\"5820160000078925\\\",\\\"question\\\":\\\"\u5df2\u7ecf\u6263\u6b3e\u4e3a\u4ec0\u4e48\u8fd8\u663e\u793a\u6709\n2017-10-21 14:33:23.797369+0800 JSQMessages[10266:1151709] LOG SocketEngine: Got message: 40/im/user\n2017-10-21 14:33:23.808589+0800 JSQMessages[10266:1151709] LOG SocketIOClient: Should parse message: 0/im/user\n2017-10-21 14:33:23.953537+0800 JSQMessages[10266:1147652] LOG SocketParser: Parsing 2/im/user,[\"message\",{\"nickName\":\"\u5c0f\u5609\",\"message\":\"{\\\"questions\\\":[{\\\"questionId\\\":\\\"5820160000078895\\\",\\\"question\\\":\\\"\u501f\u6b3e\u63d0\u73b0\u65f6\u95f4\\\"},{\\\"questionId\\\":\\\"5820160000078896\\\",\\\"question\\\":\\\"\u501f\u6b3e\u5230\u8d26\u65f6\u95f4\\\"},{\\\"questionId\\\":\\\"5820160000078897\\\",\\\"question\\\":\\\"\u501f\u6b3e\u5ba1\u6838\u65f6\u95f4\\\"},{\\\"questionId\\\":\\\"5820160000078887\\\",\\\"question\\\":\\\"\u81ea\u52a8\u63d0\u73b0\u5230\u4fe1\u7528\u5361\u8fd8\u662f\u94f6\u884c\u5361\uff08\u501f\u8bb0\u5361\uff09\\\"},{\\\"questionId\\\":\\\"5820160000078885\\\",\\\"question\\\":\\\"\u663e\u793a\u6210\u529f\u501f\u6b3e\u4e86\uff0c\u600e\u4e48\u53c8\u81ea\u52a8\u653e\u5f03\u4e86\\\"},{\\\"questionId\\\":\\\"5820160000078937\\\",\\\"question\\\":\\\"\u600e\u4e48\u89e3\u7ed1\u4fe1\u7528\u5361/\u94f6\u884c\u5361\\\"},{\\\"questionId\\\":\\\"5820160000078938\\\",\\\"question\\\":\\\"\u7ed1\u5b9a\u94f6\u884c\u5361\u65f6\u7cfb\u7edf\u5f02\u5e38/\u7cfb\u7edf\u7e41\u5fd9\\\"},{\\\"questionId\\\":\\\"5820160000078923\\\",\\\"question\\\":\\\"\u8fd8\u6b3e\u65e0\u6cd5\u63d0\u4ea4/\u7cfb\u7edf\u63d0\u793a\u9519\u8bef\u6216\u7e41\u5fd9\\\"},{\\\"questionId\\\":\\\"5820160000078924\\\",\\\"question\\\":\\\"\u903e\u671f\u8fd8\u6b3e\u662f\u5426\u4f1a\u6709\u903e\u671f\u8bb0\u5f55\u548c\u7f5a\u606f\\\"},{\\\"questionId\\\":\\\"5820160000078925\\\",\\\"question\\\":\\\"\u5df2\u7ecf\u6263\u6b3e\u4e3a\u4ec0\u4e48\u8fd8\u663e\u793a\u6709\u6b20\u6b3e\\\"}],\\\"answe\n2017-10-21 14:33:23.954570+0800 JSQMessages[10266:1147652] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [message, {\n    callType = out;\n    createTime = \"2017-10-21 14:33:23\";\n    createTimeStr = \"2017-10-21 14:33:23\";\n    filesize = 0;\n    fromUser = 7500000001616012;\n    isAI = YES;\n    message = \"{\\\"questions\\\":[{\\\"questionId\\\":\\\"5820160000078895\\\",\\\"question\\\":\\\"\\U501f\\U6b3e\\U63d0\\U73b0\\U65f6\\U95f4\\\"},{\\\"questionId\\\":\\\"5820160000078896\\\",\\\"question\\\":\\\"\\U501f\\U6b3e\\U5230\\U8d26\\U65f6\\U95f4\\\"},{\\\"questionId\\\":\\\"5820160000078897\\\",\\\"question\\\":\\\"\\U501f\\U6b3e\\U5ba1\\U6838\\U65f6\\U95f4\\\"},{\\\"questionId\\\":\\\"5820160000078887\\\",\\\"question\\\":\\\"\\U81ea\\U52a8\\U63d0\\U73b0\\U5230\\U4fe1\\U7528\\U5361\\U8fd8\\U662f\\U94f6\\U884c\\U5361\\Uff08\\U501f\\U8bb0\\U5361\\Uff09\\\"},{\\\"questionId\\\":\\\"5820160000078885\\\",\\\"question\\\":\\\"\\U663e\\U793a\\U6210\\U529f\\U501f\\U6b3e\\U4e86\\Uff0c\\U600e\\U4e48\\U53c8\\U81ea\\U52a8\\U653e\\U5f03\\U4e86\\\"},{\\\"questionId\\\":\\\"5820160000078937\\\",\\\"question\\\":\\\"\\U600e\\U4e48\\U89e3\\U7ed1\\U4fe1\\U7528\\U5361/\\U94f6\\U884c\\U5361\\\"},{\\\"questionId\\\":\\\"5820160000078938\\\n2017-10-21 14:33:23.956275+0800 JSQMessages[10266:1147652] LOG SocketParser: Parsing 0/im/user\n2017-10-21 14:33:23.956584+0800 JSQMessages[10266:1147652] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: -1; nsp: /im/user}\n2017-10-21 14:33:23.956883+0800 JSQMessages[10266:1147652] LOG SocketIOClient: Socket connected\n2017-10-21 14:33:23.957488+0800 JSQMessages[10266:1147652] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\n2017-10-21 14:33:23.957865+0800 JSQMessages[10266:1147652] LOG SocketIOClient: Handling event: connect with data: [\"/im/user\"]\n2017-10-21 14:33:25.037629+0800 JSQMessages[10266:1147652] LOG SocketIOClient: Emitting: 2/im/user,[\"allotAgent\",{\"channel\":\"PH\",\"nickName\":\"7500000001616012\",\"custId\":\"7500000001616012\",\"appId\":\"9999\"}]\n2017-10-21 14:33:25.037863+0800 JSQMessages[10266:1152725] LOG SocketEngine: Writing ws: 2/im/user,[\"allotAgent\",{\"channel\":\"PH\",\"nickName\":\"7500000001616012\",\"custId\":\"7500000001616012\",\"appId\":\"9999\"}] has data: false\n2017-10-21 14:33:25.038004+0800 JSQMessages[10266:1152725] LOG SocketEngineWebSocket: Sending ws: 2/im/user,[\"allotAgent\",{\"channel\":\"PH\",\"nickName\":\"7500000001616012\",\"custId\":\"7500000001616012\",\"appId\":\"9999\"}] as type: 4\n2017-10-21 14:33:25.067819+0800 JSQMessages[10266:1152725] LOG SocketEngine: Got message: 42/im/user,[\"status\",{\"nickName\":\"7500000001616012\",\"message\":\"\u5750\u5e2d\u5206\u914d\u6210\u529f\uff0c123321\u4e3a\u60a8\u670d\u52a1\u3002\",\"filesize\":0,\"fromUser\":7500000001616012,\"callType\":\"in\",\"toUser\":2,\"createTime\":\"2017-10-21 14:33:25\",\"statusMsgType\":1,\"chaType\":\"status\"}]\n2017-10-21 14:33:25.068115+0800 JSQMessages[10266:1152725] LOG SocketIOClient: Should parse message: 2/im/user,[\"status\",{\"nickName\":\"7500000001616012\",\"message\":\"\u5750\u5e2d\u5206\u914d\u6210\u529f\uff0c123321\u4e3a\u60a8\u670d\u52a1\u3002\",\"filesize\":0,\"fromUser\":7500000001616012,\"callType\":\"in\",\"toUser\":2,\"createTime\":\"2017-10-21 14:33:25\",\"statusMsgType\":1,\"chaType\":\"status\"}]\n2017-10-21 14:33:25.068492+0800 JSQMessages[10266:1147652] LOG SocketParser: Parsing 2/im/user,[\"status\",{\"nickName\":\"7500000001616012\",\"message\":\"\u5750\u5e2d\u5206\u914d\u6210\u529f\uff0c123321\u4e3a\u60a8\u670d\u52a1\u3002\",\"filesize\":0,\"fromUser\":7500000001616012,\"callType\":\"in\",\"toUser\":2,\"createTime\":\"2017-10-21 14:33:25\",\"statusMsgType\":1,\"chaType\":\"status\"}]\nHere is the log.However, I found that this is not the truely reason, because the normal display message is truncated either.. \nI think I found the possible reason of missing message, the picture above is a screenshot of breakpoint debugging. When the correct event content is received, the connection state is still connecting so the message can not be transmitted normally. But I'm not sure this is the result of my misuse of API. Please guide me.. > open func handleEvent(_ event: String, data: [Any], isInternalMessage: Bool, withAck ack: Int = -1) {\n\n//        guard status == .connected || isInternalMessage else { return }\n\n\nI deleted this line of code, although there are potential problems in logic, but it works right now.. Hi nuclearace, that message is sent via polling instead of websocket, so your code logic is correct. But another thing bothered me, when I received this message sent by polling may cause the subsequent messages repeating, what I can be sure that the server did send only once. I will continue debuging to solve the problem, if you have good advice please tell me.\n\u90a3\u6761\u6d88\u606f\u662f\u901a\u8fc7polling\u53d1\u51fa\u7684\u800c\u4e0d\u662fwebsocket\uff0c\u6240\u4ee5\u4f60\u7684\u4ee3\u7801\u903b\u8f91\u662f\u6b63\u786e\u7684\u3002\u4f46\u662f\u53e6\u5916\u4e00\u4ef6\u4e8b\u60c5\u56f0\u6270\u4e86\u6211\uff0c\u5f53\u6211\u6536\u5230\u8fd9\u6761polling\u53d1\u9001\u7684\u6d88\u606f\u53ef\u80fd\u4f1a\u9020\u6210\u63a5\u4e0b\u6765\u7684\u6d88\u606f\u91cd\u590d\u63a5\u6536\uff0c\u6211\u80fd\u786e\u5b9a\u7684\u662f\u670d\u52a1\u5668\u786e\u5b9e\u53ea\u53d1\u9001\u4e86\u4e00\u6b21\u3002\u6211\u4f1a\u7ee7\u7eed\u8c03\u8bd5\u4ee5\u6c42\u89e3\u51b3\u95ee\u9898\uff0c\u5982\u679c\u4f60\u6709\u597d\u7684\u5efa\u8bae\u8bf7\u544a\u8bc9\u6211. @shanshuiren what if the message is sent by polling,may it leak receiving.. \nI used the version of v12.0.0.I found the problem of wrong decoding, that is, Chinese sent through longpolling can not be parsed correctly. After further analysis found that utf8 can not be resolved correctly. I compared the java version of the code, it is found that the swift version is less fault-tolerant, So I wrote the code following the java code.\nThe following address is Java's processing code: https://github.com/socketio/engine.io-client-java/blob/master/src/main/java/io/socket/utf8/UTF8.java\nOn 12/03/2017 20:46, Erik Little wrote: What is this? There shouldn\u2019t be anything wrong with Unicode if you\u2019re using the right version of socket.io (2.0). If you\u2019re trying to use 1.0 and the current version then it\u2019ll be broken yes. Also, there\u2019s a reason this library has Swift in the title. It should be written in swift, not objective c\n\u2014You are receiving this because you authored the thread.Reply to this email directly, view it on GitHub, or mute the thread.\n{\"api_version\":\"1.0\",\"publisher\":{\"api_key\":\"05dde50f1d1a384dd78767c55493e4bb\",\"name\":\"GitHub\"},\"entity\":{\"external_key\":\"github/socketio/socket.io-client-swift\",\"title\":\"socketio/socket.io-client-swift\",\"subtitle\":\"GitHub repository\",\"main_image_url\":\"https://cloud.githubusercontent.com/assets/143418/17495839/a5054eac-5d88-11e6-95fc-7290892c7bb5.png\",\"avatar_image_url\":\"https://cloud.githubusercontent.com/assets/143418/15842166/7c72db34-2c0b-11e6-9aed-b52498112777.png\",\"action\":{\"name\":\"Open in GitHub\",\"url\":\"https://github.com/socketio/socket.io-client-swift\"}},\"updates\":{\"snippets\":[{\"icon\":\"PERSON\",\"message\":\"@nuclearace in #893: What is this? There shouldn\u2019t be anything wrong with Unicode if you\u2019re using the right version of socket.io (2.0). If you\u2019re trying to use 1.0 and the current version then it\u2019ll be broken yes. Also, there\u2019s a reason this library has Swift in the title. It should be written in swift, not objective c \"}],\"action\":{\"name\":\"View Pull Request\",\"url\":\"https://github.com/socketio/socket.io-client-swift/pull/893#issuecomment-348763767\"}}}. It seems to happen for all Chinese words which is send by polling, like the following which is decoded by utf8  \n1:61288:42/im/user,[\"message\",{\"nickName\":\"\u00e5\u00b0\u008f\u00e5\u0098\u0089\",\"message\":\"{\\\"questions\\\":[{\\\"questionId\\\":\\\"5820160000078895\\\",\\\"question\\\":\\\"\u00e5\u0080\u009f\u00e6\u00ac\u00be\u00e6\u008f\u0090\u00e7\u008e\u00b0\u00e6\u0097\u00b6\u00e9\u0097\u00b4\\\"},{\\\"questionId\\\":\\\"5820160000078896\\\",\\\"question\\\":\\\"\u00e5\u0080\u009f\u00e6\u00ac\u00be\u00e5\u0088\u00b0\u00e8\u00b4\u00a6\u00e6\u0097\u00b6\u00e9\u0097\u00b4\\\"},{\\\"questionId\\\":\\\"5820160000078897\\\",\\\"question\\\":\\\"\u00e5\u0080\u009f\u00e6\u00ac\u00e6\u00ac\\302\u00be\u00e5\u00ae\u00a1\u00e6\u00a0\u00b8\u00e6\u0097\u00b6\u00e9\u0097\u00b4\\\"},{\\\"questionId\\\":\\\"5820160000078887\\\",\\\"question\\\":\\\"\u00e8\u0087\u00aa\u00e5\u008a\u00a8\u00e6\u008f\u0090\u00e7\u008e\u00b0\u00e5\u0088\u00b0\u00e4\u00bf\u00a1\u00e7\u0094\u00a8\u00e5\u008d\u00a1\u00e8\u00bf\u0098\u00e6\u0098\u00af\u00e9\u0093\u00b6\u00e8\u008d\u00a1\u00e8\u00bf\u0098\u00e6\u0098\u00af\u00e9\u0093\u00b6\u00e8\\302\u00a1\u008d\u00a1\u00e8\u00bf\u0098\u00e6\u0098\u00af\u00e9\u0093\u00b6\u00e8\\302\u00a1\\302\u008c\u008d\u00a1\u00e8\u00bf\u0098\u00e6\u0098\u00af\u00e9\u0093\u00b6\u00e8\\302\u00a1\\302\u008c\\303\u00e5\u008d\u00a1\u00ef\u00bc\u0088\u00e5\u0080\u009f\u00e8\u00ae\u00b0\u00e5\u008d\u00a1\u00ef\u00bc\u0089\\\"},{\\\"questionId\\\":\\\"5820160000078885\\\",\\\"question\\\":\\\"\u00e6\u0098\u00be\u00e7\u00a4\u00ba\u00e6\u0088\u0090\u00e5\u008a\u009f\u00e5\u0080\u009f\u00e6\u00ac\u00be\u00e4\u00ba\u0086\u00ef\u00bc\u008c\u00e6\u0080\u008e\u00e4\u00b9\u0088\u00e5\u008f\u0088\u00e8\u0087\u00aa\u00e5\u008a\u00a8\u00e6\u0094\u00be\u00e5\u00bc\u0083\u00e4\u00ba\u0086\\\"},{\\\"questionId\\\":\\\"5820160000078937\\\",\\\"question\\\":\\\"\u00e6\u0080\u008e\u00e4\u00b9\u0088\u00e8\u00a7\u00a3\u00e7\u00bb\u0091\u00e4\u00bf\u00a1\u00e7\u0094\u00a8\u00e5\u008d\u00a1/\u00e9\u0093\u00b6\u00e8\u00a1\u008c\u00e5\u008d\u00a1\\\"},{\\\"questionId\\\":\\\"5820160000078938\\\",\\\"question\\\":\\\"\u00e7\u00bb\u0091\u00e5\u00ae\u009a\u00e9\u0093\u00b6\u00e8\u00a1\u008c\u00e5\u008d\u00a1\u00e6\u0097\u00b6\u00e7\u00b3\u00bb\u00e7\u00bb\u009f\u00e5\u00bc\u0082\u00e5\u00b8\u00b8/\u00e7\u00b3\u00bb\u00e7\u00bb\u009f\u00e7\u00b9\u0081\u00e5\u00bf\u0099\\\"},{\\\"questionId\\\":\\\"5820160000078923\\\",\\\"question\\\":\\\"\u00e8\u00bf\u0098\u00e6\u00ac\u00be\u00e6\u0097\u00a0\u00e6\u00b3\u0095\u00e6\u008f\u0090\u00e4\u00ba\u00a4/\u00e7\u00b3\u00bb\u00e7\u00bb\u009f\u00e6\u008f\u008f\\302\u0090\u00e7\u00a4\u00ba\u00e9\u0094\u0099\u00e8\u00af\u00af\u00e6\u0088\u0096\u00e7\u00b9\u0081\u0096\u00e7\u00b9\u0081\\303\u00e5\u00bf\u0099\\\"},{\\\"questionId\\\":\\\"5820160000078924\\\",\\\"question\\\":\\\"\u00e9\u0080\u00be\u00e6\u009c\u009f\u00e8\u00bf\u0098\u00e6\u00ac\u00be\u00e6\u0098\u00af\u00e5\u0090\u00a6\u00e4\u00bc\u009a\u00e6\u009c\u0089\u00e9\u0080\u00be\u00e6\u009c\u009f\u00e8\u00ae\u00b0\u00e5\u00bd\u0095\u00e5\u0092\u008c\u00e7\u00bd\u009a\u00e6\u0081\u00af\\\"},{\\\"questionId\\\":\\\"5820160000078925\\\",\\\"question\\\":\\\"\u00e5\u00b7\u00b2\u00e7\u00bb\u008f\u00e6\u0089\u00a3\u00e6\u00ac\u00be\u00e4\u00b8\u00ba\u00e4\u00bb\u0080\u00e4\u00b9\u0088\u00e8\u00bf\u0098\u00e6\u0098\u00be\u00b9\u0088\u00e8\u00bf\u0098\u00e6\u0098\u00be\\303\u00e7\u00a4\u00ba\u00e6\u009c\u0089\u00e6\u00ac\u00a0\u00e6\u00ac\u00be\\\"}],\\\"answer\\\":null,\\\"promptMsg\\\":\\\"\u00e6\u00ac\u00a2\u00e8\u00bf\u008e\u00e5\u0085\u0089\u00e4\u00b8\u00b4\u00e4\u00bd\u00a0\u00e6\u0088\u0091\u00e8\u00b4\u00b7\u00ef\u00bc\u008c\u00e5\u00be\u0088\u00e9\u00ab\u0098\u00e5\u0085\u00b4\u00e4\u00b8\u00ba\u00e6\u0082\u00a8\u00e6\u009c\u008d\u00e5\u008a\u00a1\u00ef\u00bc\u0081\u00e5\u00b0\u008f\u00e5\u0098\u0089\u00e7\u008c\u009c\u00e6\u0082\u00a8\u00e7\u009a\u0084\u00e9\u0097\u00ae\u00e9\u00a2\u0098\u00e5\u008f\u00af\u00e8\u0083\u00bd\u00e6\u0098\u00af:\\\"}\",\"filesize\":0,\"fromUser\":. The messages send by websocket is ok,the problem is the ones send by polling.I do not know the reason of it,but i have been confirmd from the backend that the encoding of pooling and websocket is the same.. I am not sure about the server side,tommorow I will give the answer. Yet I have fixed this issue by my previous code,and sure it does work.I am not sure if it is caused by our misusing the API or something else.I appreciate you rapidly reply.. same issue with me. ",
    "dolphinfuntek": "@nuclearace \nthe problem relation with socket.io server commit\njs\nNamespace.prototype.use = function(fn){\n  if (this.server.eio) {\n    debug('removing initial packet');\n    delete this.server.eio.initialPacket; // if comment out the code, it works!\n  }\n  this.fns.push(fn);\n  return this;\n};\nsocket.io server version must be greater than / equal 2.0.2\nwhen i call the socket api, web and android is worked except swift. ",
    "juanitozambada": "@nuclearace \nI am using the plugin nativescript-socketio which uses:\nsocket.io-client-swift version 9.0.1 and I can not work with namespaces.\nCan anybody help me?. ",
    "huFly": "oh, i solve it by add  \"swift compiler -> import paths\" with the zlib folder path . the wey like info.plist path, not the example of SocketIO-iOS. is our server problem and it had been solved. ",
    "aholzer": "@nuclearace I have a similar issue. The socket connection works well under normal circumstances. However, when I press the lock button of the phone while my app is running and then unlock the phone again, the socket connection cannot reconnect, it basically goes through the following statuses (the status is printed every time an onAny:  event is received). @banjun Does your app also behave like mine?\nLet me know there something special I should be doing to close or open the connection, or to reconnect manually? I could not find a best practice how to. Let me know if you need more information about the issue. \n2017-07-30 15:01:06.645825-0500 SpeakUp[730:184895] SWIFTIO status 1 SocketIOClientStatusDisconnected\n2017-07-30 15:01:06.646016-0500 SpeakUp[730:184895] SWIFTIO status 1 SocketIOClientStatusDisconnected\n2017-07-30 15:01:11.971916-0500 SpeakUp[730:184895] SWIFTIO status 2 SocketIOClientStatusConnecting\n2017-07-30 15:01:12.141199-0500 SpeakUp[730:184895] SWIFTIO status 2 SocketIOClientStatusConnecting\n2017-07-30 15:01:12.141767-0500 SpeakUp[730:184895] SWIFTIO status 0 SocketIOClientStatusNotConnected\n2017-07-30 15:01:12.142962-0500 SpeakUp[730:184895] SWIFTIO status 0 SocketIOClientStatusNotConnected\n2017-07-30 15:01:12.143714-0500 SpeakUp[730:184895] SWIFTIO status 0 S2017-07-30 15:01:12.144441-0500 SpeakUp[730:184895] SWIFTIO status 2 SocketIOClientStatusConnecting\n2017-07-30 15:01:12.975369-0500 SpeakUp[730:184895] SWIFTIO status 3 SocketIOClientStatusConnected\n2017-07-30 15:01:12.975819-0500 SpeakUp[730:184895] SWIFTIO status 3 SocketIOClientStatusConn4895] SWIFTIO status 3 SocketIOClientStatusConnected\n2017-07-30 15:01:13.036419-0500 SpeakUp[730:184895] SWIFTIO status 3 SocketIOClientStatusConnected\n2017-07-30 15:01:13.978724-0500 SpeakUp[730:184895] SWIFTIO status 3 SocketIOClientStatusConnected\n2017-07-30 15:01:13.990580-0500 SpeakUp[730:184895] SWIFTIO status 3 SocketIOClientStatusConnected\n2017-07-30 15:01:14.228523-0500 SpeakUp[730:184895] SWIFTIO status 0 SocketIOClientStatusNotConnected\n. ",
    "azfartommy": "I hide those messages using this approach: https://stackoverflow.com/questions/37800790/hide-strange-unwanted-xcode-8-logs?answertab=votes#tab-top\nFor now. I will ignore it. But still, anyone know where these messages coming from?. ",
    "liwei5544": "\u8c03\u8bd5\u4fe1\u606f \u5982\u4f55\u4fdd\u5b58\u5230\u624b\u673a. ",
    "Seonift": "It's solved. thanks!. ",
    "oskarko": "@nuclearace you saved my day! Thanks!!. ",
    "akshayshikre": "Thanx. ",
    "bingfengzhu": "update doc. ",
    "SalvatoreAD": "Have you tried installing the pod?\npod 'Starscream', '~> 2.0.3'\n. Last version with pod. I updated pod to the latest beta version. I came back to the previous version that works correctly.. i try extraHeaders and cookies, but i receive error\n. At the first connection, the server replies with an html page with bad gateway error, but the second connection goes fine.. when I get the first error, I reconnect and it works. in general I have to put the cookie in the socket header. on Android I use the transport. can you help me?. Additionally, when I receive this error, the node server crash. the server crashes because it fails to read the cookie I send. (in req.headers.cookie). how can I place cookie string in headers? . Ok thank you so much. I did the tests and the cookie arrived correctly. so there was a server side issue.. @nuclearace I edit my code like this:\n\nlet manager = SocketManager(socketURL: myURL, config: [SocketIOClientOption.log(true), SocketIOClientOption.reconnects(true), SocketIOClientOption.sessionDelegate(self), SocketIOClientOption.compress, SocketIOClientOption.extraHeaders([\"Cookie\" : cookie, \"Cache-control\": \"no-cache\"])])\nsocket = manager.defaultSocket       \n socket.on(\"connect\") { data, ack in\n             print(\"Connesso\")\n}\n socket.on(\"error\") { data, ack in     \n}\nsocket.connect()\n\nthe log does not appear. The previous version ( I used v12.1.3) worked properly, with this SocketManager no longer.. Is this syntax correct?\n\nvar socket:SocketIOClient! = nil\nlet manager = SocketManager(socketURL: myURL, config: [SocketIOClientOption.log(true), SocketIOClientOption.reconnects(true), SocketIOClientOption.sessionDelegate(self), SocketIOClientOption.compress, SocketIOClientOption.extraHeaders([\"Cookie\" : cookie, \"Cache-control\": \"no-cache\"])])\nsocket = manager.defaultSocket\nsocket.on(\"connect\") { data, ack in\nprint(\"Connesso\")\n}\nsocket.on(\"error\") { data, ack in\n}\nsocket.connect(). ok seems to work again. thanks and close. \n",
    "18667366881": "thank . ERROR: handshake failed ... Server returned status code 403   Excuse me, what's the reason for that?. ",
    "tutanck": "I have the same problem here : \n\nI tried to install the 'Starscream' pod ... Still not working \n. @nahuelnewsdeveloper\nUse the cocoapod to install socketIo instead of doing it manually. Using the pod will resolve dependencies and automatically install the StarsCream pod for you. ",
    "Nalbornoz": "I've the same error... please help. ",
    "thully": "I'm having this issue too - I get the same build error as Codeido has above since updating to Socket.io 11.0. I only have one dependency aside from socket.io and Starscream, and that dependency (Polyline) doesn't use CZLib or CommonCrypto. \n(I should also note that I'm using Carthage, not Cocoapods)\nI was above to work around this issue by moving Carthage/Checkouts/Starscream/zlib/module.modulemap from my project directory to a different location. Now it no longer complains - which is weird, since I'm using the frameworks from the Build directory and don't have the Checkouts projects loaded in Xcode. If I move the whole Checkouts directory somewhere else I get an error complaining that CZLib and CommonCrypto cannot be found.\nAny idea what is going on here? I see why this would happen with dependencies that use CZLib or CommonCrypto, but mine don't.... It doesn't seem to be fixed. I still get the \"Redefinition of module\" errors when building with 11.1.1 and StarscreamSocketIO 8.0.4. I'm using Carthage for my dependency resolution, and I cleared the Carthage directory before the rebuild to make sure there were no residual files. I can work around this problem by deleting the Carthage/Checkouts/Starscream/zlib/module.modulemap file - then the build error goes away.. I am noticing this error on pre-9.0 versions as well, just not as often. The annoying thing is having to recreate the socket and re-add all the socket listeners - and my app has multiple components that use the same socket. Is there a way to get all the currently-registered listeners so that I can readd them to the new socket? . As a side question, what would be best practices with this library to make sure reconnection works reliably? Should I be re-creating my socket object manually in some circumstances, or is forceNew(true) enough? . Does that hold for explicitly-requested disconnects as well (i.e. disconnects initiated by calling socket.disconnect(), or disconnects initiated by the server)? We're been using a wrapper around the library to allow us to do custom authentication and handle calls to emit when not connected.In this wrapper we had also been tracking all the added handlers as well and reconstructing the socket object on disconnect to avoid a problem similar to above. Is that unnecessary with forceNew?. This was a server issue. ",
    "miktav": "I had the same problem as @Codeido. I followed the technique described in Mike Weller's answer here:\nhttps://stackoverflow.com/questions/25248598/importing-commoncrypto-in-a-swift-framework\nHe creates a target called CommonCryptoModuleMap which fixes the redefinition problem for CommonCrypto. I followed the same technique to create a CZLibModuleMap, with this for my Run Script:\nmkdir -p \"${BUILT_PRODUCTS_DIR}/zlibModuleMap\"\ncat < \"${BUILT_PRODUCTS_DIR}/zlibModuleMap/module.modulemap\"\nmodule zlib [system] {\n    header \"${SDKROOT}/usr/include/zlib.h\"\n    export *\n}\nEOF\nAfter this my project built and I was successfully able to connect to my socket.io server running locally.. ",
    "nboyd-sportdx": "has anyone got this to work?\n(update)...got it to work.  cleaning build folder...not sure what's going on w/ xcode. why is this closed?  problem persists.... tried it...not working\n. ",
    "LeonidKokhnovich": "@nuclearace I have the same issue with the following cartfile:\ngithub \"nuclearace/Starscream\" ~> 8.0.4\ngithub \"socketio/socket.io-client-swift\" ~> 11.1.1. @nuclearace Thank you for such a fast support with the problem. Yes, it fixes the issue with the following cartfile update:\ngithub \"nuclearace/Starscream\" ~> 8.0.4\ngithub \"socketio/socket.io-client-swift\" \"development\". I still see the issue on the latest version: 13.1.0. ",
    "Nathan187": "this is working for me as well. i'm notorious for cutting corners and not RFTM.   if you can get another test case/subject before doing a release...that may help.  sorry for any inconvenience and thank you for your hard work\n. just wondering if it was something i was doing wrong....but i'll drop the subject now.  thanks for your hardwork. yes, i am using Carthage\ngithub \"nuclearace/Starscream\" ~> 8.0.4\ngithub \"socketio/socket.io-client-swift\" \"development\"\nis working for me. sorry about that.  was able to get my project working. ",
    "hungvh1904": "Still facing issue with cocoapods :(\npod 'Socket.IO-Client-Swift', '~> 11.1.3'\npod 'Starscream', '~> 3.0.3'. ",
    "yirankege": "when i used the CocoaPods to install socket.io lib.i don't know how to import files in my project.i builded a new project to use the CocoaPods ,but it's still wrong.so i want to know how to  do that .\n. @nuclearace  can you tell me how use  Cocoapod import my project?. @nuclearace objective-c. @NyeinEiEiTun \nplatform :ios, '8.0'\nuse_frameworks!\ntarget \u2018aaa\u2019 do\npod 'Socket.IO-Client-Swift','~> 11.0'\nend\nit's my cocoapod\u2018s use.i think that's right.  this's my test project. Xcode 8 will not be able to build the targets \u201cSocket.IO-Client-Swift\u201d and \u201cStarscreamSocketIO\u201d, and certain editing features will not function properly until the Swift source code in these targets has been converted.\nThis action can be performed later using \u201cConvert to Current Swift Syntax\u201d in the Edit menu.\nfirst my project is Objective-c and it needs me to update my swift version ,so i don't understand this\uff0ci didn't do anything.. xcode 8.3.3. maybe the version i imported sokect.io is too low?\n. yes,i think so,i just can't find the way to use cocoapod or Manual installation\u3002 . that is not good idea, i even want to rewirte the project with swift.\ni will try using your method first.. @NyeinEiEiTun  thank you so much.. i think i find the way.let me have a try first. i builded a new project, project is objective-c. first new a file of swift and bulid a bridge file,then use cocoapod import socket.now i can use @import SocketIO in my objective-c file.it has been completed,now i can use socket.io on my project.. creation should be before use.. i have found a way to solve it.. ",
    "BBK-PiJ-2016-11": "Thanks for that @nuclearace !. It does, thanks a lot!. ",
    "pinkladywithcoco": "Hi nuclearace \nMany thanks for the prompt reply!\nBut my ISP just told me that they dont support IPv6 and only IPv4 is provided.\nWill IPv6 clients still be able to connect to my server???\n. Thanks for confirming that :)\n\nCan Socket.io listen to both IPv6 and IPv4?  is so how??? . \n",
    "ldbfrank": "No, can NOT.. It seems the only way is that you should modify file SocketIOClient.swift directly.. Now, you could use Socket.io-client-swift 11.0.1 and Starscream 8.0.2 ! It good!. Thanks nuclearace! I have tested, it work!. SSLSecurity could see from Objective-C?. Oh, the Starscream from git is old version, I have download 8.0.2. Sorry, I have compiled successful. Thanks.. Can't find SSLCert in Objective-C. ",
    "IbrahimKZ": "I have found solution using https://github.com/acmacalister/jetfire for Objective-C instead of SSLSecurity.. ",
    "Harryiosdev": "Yes the event name is same thats why its working on sender side to receive message  but not working on receiver side to receive message.\n. Yes, I am using it for group chat in iOS and  , I want it to broadcast message  to other users\n. I am using this link to code in my app\nhttp://www.appcoda.com/socket-io-chat-app/. This is the code i used to send message and receives.\nfunc sendTextMessage(Message: [String: String], completionHandler: @escaping (_ userList: [String: AnyObject]?) -> Void) {\n        socket.emit(\"send message\", Message)\n        socket.on(\"get message\") { ( dataArray, ack) -> Void in\n            self.socket.removeAllHandlers()\n            completionHandler( dataArray[0] as? [String: AnyObject])\n        }\n    }\nIs there something wrong please let me know. It means , your are saying that i need to remove the socket.on(\"get message\") in the send message section an to code it separately like this\nPlease check it and confirm.\nAslo I need to turn on login for client?\nIs it making sense?\nfunc sendTextMessage(Message: [String: String], completionHandler: @escaping (_ userList: [String: AnyObject]?) -> Void) {\n        socket.emit(\"send message\", Message) \n    }\nfunc getChatMessage(completionHandler: @escaping (_ userList: [String: AnyObject]?) -> Void) {\n   socket.removeAllHandlers()\n    socket.on(\"get message\") { ( dataArray, ack) -> Void in\n        print(dataArray)\n        print(ack)\n        completionHandler( dataArray[0] as? [String: AnyObject])\n    }\n}\n\nPlease confirm.. I have initialised socket now with  .log as you mentioned.\nAlso made separate handler to get the message after sending.\nBut if i am not adding \nsocket.removeAllHandlers()\nbefore get message then i am getting \nthe ist messt sending for its time,\n2nd msg  two times, \n3rd msg three time,\nwhen i came out of the group and again joining the group then i am getting in same sequence\nCan you plz guide me in this. Thanks a lot  It works\nYour effort is really appriciable\nyou are a genius......\nThanks again. Thanks for your reply\nLet me try with that , and I will let you know.\nThanks Again buddy\n. Sorry to say \n/but after placing socket.Once with socket.on, its not working\nThis is happening , \non socketIOClient side\nand printing in my console.\n LOG SocketIOClient: Handling event: get message with data: \nwhere \"get message\"  is my handler name\nbut the handler  on SocketIOManager not invoked.\nHere is the handler code form SocketIOManager class is \nsocket.removeAllHandlers()\n        socket.on(\"get message\") { ( dataArray, ack) -> Void in\n            print(dataArray)\n            print(ack)\n            completionHandler( dataArray[0] as? [String: AnyObject])\n        }\nPlease check it and  let me know\nThanks \n. Alright, i understand that according to you its not calling may be the handler not matching.\nbut can you please tell me why its working from sender side and not on other users side in case of broadcasting ?\nWhenever send message its invoked correctly, but when otherUser send message to sender back   its not working thats  what happening my side.\nLast time the same thing happened couple of days back, you suggested me the initialisation of socket method and it worked. can you please suggest this time also.\nPlease guide me.. Hi, nuclearace\nThanks for your guidence, Your suggestions really helped . \nYou are a genius.\nThanks again.. ",
    "fernandomorgan": "\ud83d\udc4d thank you!. ",
    "mBilal5674": "As usualy you did not off emit calling like\nSocketIOManager.sharedInstance.socketIOClient.off(\"getConversation\"). ",
    "lamobratory": "Ok fixed, nothing to do with the actual library but rather with the format of the information that I was sending.. @mostafatabal it was a long time ago, sorry... but I remember the way I was sending the info... I have this code:\n```\n-(void)initWebSocket\n{\n    if(self.socket==nil)\n    {\n        __weak typeof(self) weakSelf = self;\n    NSString *sLink = [self.viewPresenter getRestaurantRealTimeLink];\n\n    // https://github.com/daltoniam/Starscream\n    self.socket = [[WebSocket alloc] initWithUrl:[NSURL URLWithString:sLink] protocols:nil];\n\n    self.socket.onConnect = ^{\n\n        // NSLog(@\"socket onConnect\");\n        [weakSelf.timerAliveSocket invalidate];\n        weakSelf.timerAliveSocket = nil;\n\n        weakSelf.retrySocketSeconds = 0;\n\n        [weakSelf.timerRetrySocket invalidate];\n        weakSelf.timerRetrySocket = nil;\n\n        weakSelf.timerAliveSocket = [NSTimer scheduledTimerWithTimeInterval:10 target:weakSelf selector:@selector(pingSocket) userInfo:nil repeats:YES]; // used because after 1 min the socket is closed if we don't ping it\n\n        // get the data again in case we had some problems with the internet\n        [weakSelf.viewPresenter getRestaurantTopology:NO loadNextSequence:YES];\n    };\n\n    self.socket.onDisconnect = ^(NSError * _Nullable error) {\n\n        // NSLog(@\"socket onDisconnect\");\n\n        [weakSelf.timerAliveSocket invalidate];\n        weakSelf.timerAliveSocket = nil;\n\n        [weakSelf showDisconnectionWindow];\n    };\n\n    self.socket.onText = ^(NSString * _Nonnull jsonString)\n    {\n        // NSLog(@\"socket onText %@\", jsonString);\n\n        // convert this into a json\n        NSError *err;\n\n        NSData *data = [jsonString dataUsingEncoding:NSUTF8StringEncoding];\n        id json = [NSJSONSerialization JSONObjectWithData:data options:0 error:&err];\n\n        if(err==nil && json!=nil && [json isKindOfClass:[NSDictionary class]])\n        {\n            NSDictionary *jsonDict = (NSDictionary*)json;\n            [weakSelf parseReceivedMessage:jsonDict];\n        }\n    };\n\n    [self.socket connect];\n}\n\n}\n```\nMaybe this helps you.. ",
    "mostafatabal": "@lamobratory \ni've same issue you have , please can help me to solve this problem , what is the solution ?. @nuclearace \nThanks , i made the socket manager global , and it's works fine, thanks agian .. @nuclearace \nnode js server :-\nvar io = require('socket.io')();\nio.on('connection', function(socket) {\n  console.log('connected!');\n  console.log('roomId request: ' + socket.handshake.query.roomId);\n  let roomId = socket.handshake.query.roomId;\n  socket.on(roomId, function(data) {\n    console.log('----------------------------------------------')\n    console.log(\"data: \" + data);\n   socket.emit(roomId,data);\n    console.log('----------------------------------------------')\n  });\n});\nio.listen(8080);. @nuclearace \ni fired even Any :- \nlog is \n2018-01-21 11:26:41.465357+0300 Etmam[20490:6959969] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2018-01-21 11:26:44.507206+0300 Etmam[20490:6958729] ping\n2018-01-21 11:26:45.585741+0300 Etmam[20490:6958729] (\n)\n2018-01-21 11:26:47.956496+0300 Etmam[20490:6962518] LOG SocketEngine: Got message: 3\n2018-01-21 11:26:47.956843+0300 Etmam[20490:6958729] LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-01-21 11:26:49.339490+0300 Etmam[20490:6958729] pong\n2018-01-21 11:26:49.808872+0300 Etmam[20490:6958729] (\n)\n. it solved, thanks. @Huppys \nthe problem in my server .js \nif you see in past comment you will find :-\nvar io = require('socket.io')();\nio.on('connection', function(socket) {\n  console.log('connected!');\n  console.log('roomId request: ' + socket.handshake.query.roomId);\n  let roomId = socket.handshake.query.roomId;\n  socket.on(roomId, function(data) {\n    console.log('----------------------------------------------')\n    console.log(\"data: \" + data);\n   socket.emit(roomId,data);\n    console.log('----------------------------------------------')\n  });\n});\nio.listen(8080);\ni changed socket.emit(roomId,data); to io.emit(roomId,data) not socket ..\n. ",
    "Patrick-Remy": "Unfortunately not, also I am using a library that needs submodules in the same Cartfile... ",
    "mohammadZ74": "same problem here . 13.1.0. ",
    "DanteCY": "I have the same error,not now I'm reslove it.\n1.downlod Starscream-master project\n2.unzip and copy the contents  copy it to socket.io-client-swift-master/Source/Starscream/\n3.replace import StarscreamSocketIO with import Starscream\nok. ",
    "aorumbayev": "Does not work on Xcode 9 beta 6 & iOS 11 beta 8.\nThough worked fine after cleaning & removing derived data and running on Xcode 8.3.3 & iOS 10.3.3. ",
    "kacak9229": "What sort of method do you think I should implement to ensure that my token is set beforehand?\nMy current method is the best that I could come up with. Store it in a keychain then only do socket.connect.\nThanks. Hey Thully just wondering, how does your Singleton Design structure? I'm using token and I have a lot of problems\nThis is my Singleton Design, I'm building an app similar like Uber\n```\nimport SocketIO\nclass SocketIOManager: NSObject {\nstatic let sharedInstance = SocketIOManager()\n\nvar socket: SocketIOClient!\n\nprivate override init() {\n    self.socket = SocketIOClient(socketURL: URL(string: mainURL)!, config: [.log(false), .compress, .connectParams([\"token\": getToken()])])\n    super.init()\n}\n\nfunc establishConnection() {\n   socket.connect()\n\n}\n\nfunc closeConnection() {\n    socket.disconnect()\n}\n\n}\n```\nIs this good enough?\n. I thought that by posting here, people with experience could help me. Am I wrong?. Alright thanks! \nI want to ask you personally if you were me. and If your app is heavily depending on token.\nWould you go for for\n\nInit method - (Problem if token is not there then it initialized the socket without token)\n\nvar socket: SocketIOClient!\n    private override init() {\n        socket =  SocketIOClient(socketURL: URL(string: mainURL)!, config: [.log(false), .compress, .connectParams([\"token\": getToken()])])\n        super.init()\n    }\nor\n\nInitialize the socket object in the establishConnection - (Problem socket is going to be nil when trying to launch the app)\n\n```\nvar socket: SocketIOClient!\nfunc establishConnection() {\n       socket = SocketIOClient(socketURL: URL(string: mainURL)!, config: [.log(false), .compress, .connectParams([\"token\": \"asdasdasdsa\"])])\n       socket.connect()\n}\n\n```\nJust your opinion, if you don't mind\nThanks!. Just wondering if token is not present anymore, I clear the token\nkeychain[\"token\"] = nil\nThe .connectParams will still have the token\nlazy var socket = SocketIOClient(socketURL: URL(string: mainURL)!, config: [.log(false), .compress, .connectParams([\"token\": keychain[\"token\"]!])])\nHow do I clear the token inside .connectPrams?. Are you talking about adding forceNew(true) ? to \nSocketIOClient(socketURL: URL(string: mainURL)!, config: [.log(false), .compress, .forceNew(true), .connectParams([\"token\": keychain[\"token\"]!])]) \nIs it correct?. ",
    "luoqisheng": "Hi, the engineQueue which named com.socketio.engineHandleQueue in SocketEngine.swift should  be a static property. If not, when the using forceNew to create a SocketIOClient, reconnecting will create a new engineQueue, and racing condition may happens. like this( a lot of engineQueue):\n\n. thanks for your reply! when the using forceNew to create a SocketIOClient, each connecting action will make a new socket engine, and this will create a new queue ( com.socketio.engineHandleQueue), as the picture showing, Thread 55,57,51,49,28,36  accessing _connect func.  there is not serial guarantee.  making it a static property, com.socketio.engineHandleQueue will be a shared serial queue, would it be better? . if the engine released during the stream callback was fired. the websocket may be a dangling pointer?  should I close the stream sync in the queue(com.vluxe.starscream.websocket) before the engine released?. SocketManager's addEngine() method, recreate engine, but since the engine was the sessiondelegate which will not be released. i donot know which config you mean. but I  found 2+ instances of engine,and it do should not happen.  and I the  engineDidClose() could be called without invaild the engine. ",
    "TimorDjd": "Yes,I used workspace that cocoapods makes;. ",
    "hansemannn": "Mhh, the only library that uses Starscream as a dependency should be this one, that's why I'm wondering. I am using latest (10.2.0), so I'm not sure how any others are not running into this issue. Thanks for catching up btw!. What a second, 10.2.0 is oudated (11.2.1 is current). But when not specifying the version or using 11.2.1 in the Podfile, it throws an error:\n```\n[!] Unable to satisfy the following requirements:\n\nSocket.IO-Client-Swift (~> 11.1.2) required by Podfile\n\nNone of your spec sources contain a spec satisfying the dependency: Socket.IO-Client-Swift (~> 11.1.2).\nYou have either:\n * out-of-date source repos which you can update with pod repo update or with pod install --repo-update.\n * mistyped the name or version.\n * not added the source repo that hosts the Podspec to your Podfile.\nNote: as of CocoaPods 1.0, pod repo update does not happen on pod install by default.\n```\nHappening with pod 'Socket.IO-Client-Swift', '~> 11.1.2', using pod 'Socket.IO-Client-Swift' autoselects 10.2.1. Thx!. That was a long way..Needed to upgrade CP, do a fresh setup, clean and repo-update. But it seems to grab the correct version now, thank you! :-). Hey there! I'm having the same issue with pod 'Socket.IO-Client-Swift', '~> 12.1.3'. . Getting the same crash here! Full log of the crashed thread:\nThread 0 Crashed:\n0   JavaScriptCore                  0x000000022f24c820 JSC::LLInt::setUpCall+ 8091680 (JSC::ExecState*, JSC::Instruction*, JSC::CodeSpecializationKind, JSC::JSValue, JSC::LLIntCallLinkInfo*) + 304\n1   JavaScriptCore                  0x000000022eb00014 llint_entry + 32212\n2   JavaScriptCore                  0x000000022eafffb8 llint_entry + 32120\n3   JavaScriptCore                  0x000000022eafffb8 llint_entry + 32120\n4   JavaScriptCore                  0x000000022eafffb8 llint_entry + 32120\n5   JavaScriptCore                  0x000000022eb0002c llint_entry + 32236\n6   JavaScriptCore                  0x000000022eaf802c vmEntryToJavaScript + 316\n7   JavaScriptCore                  0x000000022f19e228 JSC::Interpreter::executeCall+ 7377448 (JSC::ExecState*, JSC::JSObject*, JSC::CallType, JSC::CallData const&, JSC::JSValue, JSC::ArgList const&) + 424\n8   JavaScriptCore                  0x000000022f365878 JSC::profiledCall+ 9242744 (JSC::ExecState*, JSC::ProfilingReason, JSC::JSValue, JSC::CallType, JSC::CallData const&, JSC::JSValue, JSC::ArgList const&) + 196\n9   JavaScriptCore                  0x000000022eb30b38 JSObjectCallAsFunction + 376\n10  MyApp                           0x000000010006cf0c 0x100054000 + 102156\n11  MyApp                           0x000000010072ed70 0x100054000 + 7187824\n12  SocketIO                        0x000000010105eeb0 partial apply for thunk for @escaping @callee_unowned @convention(block) (@unowned NSArray, @unowned SocketAckEmitter) -> () + 143024 (<compiler-generated>:0)\n13  SocketIO                        0x000000010105d3f4 specialized SocketIOClient.handleEvent(_:data:isInternalMessage:withAck:) + 136180 (<compiler-generated>:0)\n14  SocketIO                        0x000000010105ae54 SocketIOClient.handlePacket(_:) + 126548 (<compiler-generated>:0)\n15  SocketIO                        0x000000010107a200 specialized SocketManager._parseEngineMessage(_:) + 254464 (<compiler-generated>:0)\n16  SocketIO                        0x000000010107928c partial apply for closure #1 in SocketManager.engineDidClose+ 250508 (reason:) + 32\n17  SocketIO                        0x00000001010426f8 thunk for @escaping @callee_guaranteed () -> () + 26360 (<compiler-generated>:0)\n18  libdispatch.dylib               0x00000002270a7d58 _dispatch_call_block_and_release + 32\n19  libdispatch.dylib               0x00000002270a92f0 _dispatch_client_callout + 20\n20  libdispatch.dylib               0x00000002270b4fe4 _dispatch_main_queue_callback_4CF + 1016\n21  CoreFoundation                  0x0000000227631280 __CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE__ + 16\n22  CoreFoundation                  0x000000022762bf24 __CFRunLoopRun + 1912\n23  CoreFoundation                  0x000000022762b494 CFRunLoopRunSpecific + 452\n24  GraphicsServices                0x00000002298debe8 GSEventRunModal + 104\n25  UIKitCore                       0x000000025523a68c UIApplicationMain + 216\n26  MyApp                           0x00000001000599b4 0x100054000 + 22964\n27  libdyld.dylib                   0x00000002270e1050 start + 4. ",
    "daver234": "Yep that is the problem.  Thanks.. ",
    "jetricy": "I've fixed it by reference the project  StarstreamSocket, like picture below.\n\n. ",
    "gunjotSinghMansa": "I am also getting the same issue. I have installed the library with carthage. What to do?. ",
    "navy-xie": "In your 'Build Settings' -> 'Swift Compiler  - Search Paths' -> 'Import Paths', add the path of the fold 'zlib', for example, $SRCROOT/$PROJECT_NAME/zlib, and then it should work.. ",
    "JoyGY": "\u8865\u5145\u4e00\u4e0b\uff0c\u6211\u7684\u662fswift\u7684\u9879\u76ee. ```objc\nlet socket = SocketIOClient(socketURL: URL(string: \"my sever url\")!, config: [.log(true)])\nsocket.emit(\"data\", [\"position\"])\nsocket.on(\"data\") { (data, ack) in\n    print(\"-get-data--message---(data)---(ack)\")\n}\n```\nI am using the above setting method, but I get to the data in the print is not all, sometimes interface transmit to the amount of data are large, in this method did not show receiving data, but through the inside of the underlying file you have seen this data in the Log output.\nI am not sure whether my own setting has the problem or what other reason, I hope you can guide, thank you\uff01\n\u6211\u7528\u7684\u662f\u4ee5\u4e0a\u7684\u8bbe\u7f6e\u65b9\u6cd5\uff0c\u4f46\u662f\u6211\u5728print\u4e2d\u83b7\u53d6\u5230\u7684data\u6570\u636e\u5e76\u4e0d\u662f\u5168\u90e8\u7684\uff0c\u6709\u7684\u65f6\u5019\u63a5\u53e3\u4f20\u8f93\u8fc7\u6765\u7684\u6570\u636e\u91cf\u5f88\u5927\u5f88\u5927\u7684\u65f6\u5019\uff0c\u5728\u8fd9\u4e2a\u65b9\u6cd5\u4e2d\u5374\u6ca1\u6709\u663e\u793a\u63a5\u6536\u6570\u636e\uff0c\u4f46\u662f\u901a\u8fc7\u60a8\u5e95\u5c42\u6587\u4ef6\u91cc\u9762\u7684Log\u8f93\u51fa\u4e2d\u5374\u6709\u770b\u5230\u8fd9\u6570\u636e\u3002\n\u6211\u4e0d\u786e\u5b9a\u662f\u4e0d\u662f\u6211\u81ea\u5df1\u7684\u8bbe\u7f6e\u6709\u95ee\u9898\u8fd8\u662f\u4ec0\u4e48\u5176\u4ed6\u7684\u539f\u56e0\uff0c\u5e0c\u671b\u60a8\u6307\u5bfc\u4e00\u4e0b\uff0c\u8c22\u8c22. 2017-09-18 11:14:30.543 XFAWealthForPC[41927:15457164] LOG SocketIOClient: Emitting: 2[\"data\",[\"position\"]]\n2017-09-18 11:14:30.543 XFAWealthForPC[41927:15457363] LOG SocketEngine: Writing ws: 2[\"data\",[\"position\"]] has data: false\n2017-09-18 11:14:30.543 XFAWealthForPC[41927:15457164] LOG SocketIOClient: Adding handler for event: data\n2017-09-18 11:14:30.543 XFAWealthForPC[41927:15457363] LOG SocketEngine: Sending ws: 2[\"data\",[\"position\"]] as type: 4\n2017-09-18 11:14:32.547 XFAWealthForPC[41927:15457363] LOG SocketEngine: Got message: 42[\"data\",{\"name\":\"position\",\"account\":\"GZA2017\",\"data\":[{\"0\":\"000001\",\"3\":9.7,\"4\":800,\"10\":\"GZA2017\",\"20\":\"SZSE\",\"21\":\"PAB\",\"22\":\"1\",\"23\":\"CNY\",\"31\":9.52,\"73\":\"SPREAD_SZSE_11\",\"115\":9.52,\"505\":\"\u5e73\u5b89\u94f6\u884c\",\"1504\":1,\"1508\":\"0\",\"bodAmount\":7616,\"bodQuantity\":800,\"bodShortQuantity\":0,\"realizedPL\":0,\"unrealizedPL\":143.99999999999977,\"bodPL\":143.99999999999977,\"execPL\":0,\"costPrice\":9.52,\"totalQuantity\":800,\"totalAmount\":  ......\nThis is the Log output which I get the data, but I am in func on (event: String callback: @escaping _, NormalCallback) - > UUID {} This method is not available in this part of the data, I want to know if I want to get this part of the data should be how to do\n\u8fd9\u662f\u6211\u83b7\u53d6\u5230\u7684Log\u8f93\u51fa\u91cc\u9762\u7684\u6570\u636e\uff0c\u4f46\u662f\u6211\u5728func on(_ event: String, callback: @escaping NormalCallback) -> UUID {} \u8fd9\u4e2a\u65b9\u6cd5\u4e2d\u5374\u83b7\u53d6\u4e0d\u5230\u8fd9\u90e8\u5206\u6570\u636e\uff0c\u6211\u60f3\u77e5\u9053\u5982\u679c\u6211\u60f3\u5f97\u5230\u8fd9\u90e8\u5206\u6570\u636e\u5e94\u8be5\u600e\u4e48\u505a\n. I tried this way today, but it doesn't work\uff0care there any other solutions?. I use 11.1.3 today, before using the 11.1.2. But they have the same problem.. This log to get the data, I think may be because the data volume is too big, at the time of parsing may be intercepted, so the method to get data and can't get to the data, I hope that I get the data in the method of the content of the log output\uff01\nNow I don't know what the server version is on my side, I can ask the server side version tomorrow.May is the latest version.. 2017-09-18 20:55:46.530 XFAWealthForPC[85021:16877153] LOG SocketEngine: Got message: 42[\"auth\",true]\n2017-09-18 20:55:46.531 XFAWealthForPC[85021:16877153] LOG SocketIOClient: Should parse message: 2[\"auth\",true]\n2017-09-18 20:55:46.651 XFAWealthForPC[85021:16876586] LOG SocketParser: Parsing 2[\"auth\",true]\n2017-09-18 20:55:46.651 XFAWealthForPC[85021:16876586] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [auth, 1]; id: -1; placeholders: -1; nsp: /}\n2017-09-18 20:55:46.652 XFAWealthForPC[85021:16876586] LOG SocketIOClient: Handling event: auth with data: [1]\n2017-09-18 20:55:46.667 XFAWealthForPC[85021:16877162] LOG SocketEngine: Got message: 42[\"data\",{\"name\":\"position\",\"account\":\"GZA2017\",\"data\":[{\"0\":\"000001\",\"3\":9.65,\"4\":800,\"10\":\"GZA2017\",\"20\":\"SZSE\",\"21\":\"PAB\",\"22\":\"1\",\"23\":\"CNY\",\"31\":9.52,\"73\":\"SPREAD_SZSE_11\",\"115\":9.52,\"505\":\"\u5e73\u5b89\u94f6\u884c\",\"1504\":1,\"1508\":\"0\",\"bodAmount\":7616,\"bodQuantity\":800,\"bodShortQuantity\":0,\"realizedPL\":0,\"unrealizedPL\":104.00000000000063,\"bodPL\":104.00000000000063,\"execPL\":0,\"costPrice\":9.52,\"totalQuantity\":800,\"totalAmount\":7616,\"todayBuyAmount\":0,\"todayBuyQuantity\":0,\"todaySellAmount\":0,\"todaySellQuantity\":0,\"depositAmount\":0,\"depositQuantity\":0,\"withdrawAmount\":0,\"withdrawQuantity\":0,\"bod\":{\"0\":\"000001\",\"4\":\"800\",\"10\":\"GZA2017\",\"38\":\"0\",\"115\":\"0\",\"470\":\"0\",\"schema\":{\"header\":{},\"symbol\":{\"tag\":0},\"bid\":{\"tag\":1},\"ask\":{\"tag\":2},\"price\":{\"tag\":3},\"quantity\":{\"tag\":4},\"status\":{\"tag\":5},\"orderNo\":{\"tag\":6},\"exchNo\":{\"tag\":7},\"tranNo\":{\"tag\":8},\"request\":{\"tag\":9},......\nI am got data, in this message  \"LOG SocketEngine: Got message: 42\" ,But you can't get in this method\n open func on(_ event: String, callback: @escaping SocketIO.NormalCallback) -> UUID\nBut sometimes I can also be obtained from the above the method to transmit the data, may be because of the relatively small amount of data, so can make a successful resolution.I guess you have set over there if access to parse the data content too much time there will be a problem, cannot successfully returns to on method.This is just my guess, don't know right.As the Log output data is a bit more, so only part of the, today is roughly measuring the amount of data: the number of string a total of 69441. But after may transmit more data.\n\u4f46\u662f\u6709\u7684\u65f6\u5019\u6211\u4e5f\u53ef\u4ee5\u4ece\u4ee5\u4e0a\u8fd9\u4e2a\u65b9\u6cd5\u4e2d\u83b7\u53d6\u5230\u670d\u52a1\u5668\u4f20\u9012\u8fc7\u6765\u7684\u6570\u636e\uff0c\u53ef\u80fd\u662f\u56e0\u4e3a\u6570\u636e\u91cf\u6bd4\u8f83\u5c0f\uff0c\u6240\u4ee5\u80fd\u89e3\u6790\u6210\u529f\u3002\u6211\u731c\u60f3\u662f\u4e0d\u662f\u60a8\u90a3\u8fb9\u6709\u8bbe\u7f6e\u5982\u679c\u83b7\u53d6\u5230\u7684\u6570\u636e\u5185\u5bb9\u592a\u591a\u7684\u65f6\u5019\u89e3\u6790\u7684\u65f6\u5019\u4f1a\u6709\u95ee\u9898\uff0c\u4e0d\u80fd\u6210\u529f\u8fd4\u56de\u5230on\u65b9\u6cd5\u4e2d\u3002\u8fd9\u4ec5\u4ec5\u662f\u6211\u7684\u731c\u6d4b\uff0c\u4e0d\u77e5\u9053\u5bf9\u4e0d\u5bf9\u3002\u7531\u4e8eLog\u8f93\u51fa\u7684\u6570\u636e\u6709\u70b9\u591a\uff0c\u6240\u4ee5\u53ea\u622a\u53d6\u4e86\u4e00\u90e8\u5206\uff0c\u4eca\u5929\u5927\u81f4\u6d4b\u4e86\u4e00\u4e0b\u6570\u636e\u91cf\uff1a\u5b57\u7b26\u4e32\u6570\u91cf\u4e00\u517169441. \u4f46\u662f\u4ee5\u540e\u53ef\u80fd\u4f1a\u4f20\u8f93\u66f4\u591a\u7684\u6570\u636e\u3002\n. \n\u6211\u7684\u610f\u601d\u662fsocket\u4f20\u8f93\u8fc7\u6765\u7684\u6240\u6709\u6570\u636e\uff0c\u6709\u4e00\u90e8\u5206\u6211\u80fd\u63a5\u6536\u5230\uff0c\u4f46\u662f\u6709\u4e00\u90e8\u5206\u4e0d\u80fd\u63a5\u6536\u5230\uff0c\u4f46\u662f\u4e0d\u80fd\u63a5\u6536\u5230\u7684\u90a3\u90e8\u5206\u6570\u636e\u53ef\u4ee5\u5728\u5e95\u5c42\u7684Log\u8f93\u51fa\u4e2d\u770b\u5230\uff0c\u56e0\u6b64\u6211\u731c\u60f3\u662f\u4e0d\u662f\u56e0\u4e3a\u90a3\u90e8\u5206\u6570\u636e\u6570\u636e\u91cf\u592a\u5927\u6240\u4ee5\u4e0d\u80fd\u6b63\u786e\u7684\u8fd4\u56de\u5230on\u7684\u56de\u8c03\u65b9\u6cd5\u4e2d\nI mean all the data transmission over the socket, there's a part of me will receive, but have not received a part, but the part of the not received data  to be seen in the bottom of the Log output, so I guess it is probably part of the data is too big so you can't return to the correct callback the on method. I'm very sorry, my English is not very good, please forgive me. I have another question. I want to know if you have any restrictions on the big data you transfer over there.  For example, more than a few bytes will not be returned, or anything else.\nBecause of the same data, Android can receive it back there, but the IOS can only be displayed in Log, and cannot be obtained in the callback method of the on method\u3002\n. 2017-09-18 20:55:41.257 XFAWealthForPC[85021:16877189] LOG SocketEngine: Sending ws: 2[\"auth\",\"7Tkv92r-EozasekjT0R4j3ycVCrWe3LK.TY5IHL7198PiEM\\/tbib0yjMMv\\/uCJzQqSNGDNiGZKQs\"] as type: 4\n2017-09-18 20:55:46.502 XFAWealthForPC[85021:16876586] LOG SocketIOClient: Emitting: 2[\"data\",\"position\"]\n2017-09-18 20:55:46.506 XFAWealthForPC[85021:16876586] LOG SocketIOClient: Adding handler for event: data\n2017-09-18 20:55:46.506 XFAWealthForPC[85021:16877171] LOG SocketEngine: Writing ws: 2[\"data\",\"position\"] has data: false\n2017-09-18 20:55:46.506 XFAWealthForPC[85021:16876586] LOG SocketParser: Parsing 2[\"auth\",false]\n2017-09-18 20:55:46.506 XFAWealthForPC[85021:16877171] LOG SocketEngine: Sending ws: 2[\"data\",\"position\"] as type: 4\n2017-09-18 20:55:46.507 XFAWealthForPC[85021:16876586] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [auth, 0]; id: -1; placeholders: -1; nsp: /}\n2017-09-18 20:55:46.507 XFAWealthForPC[85021:16876586] LOG SocketIOClient: Handling event: auth with data: [0]\nsocket --gy-- auth --22--**[0]---**<SocketIO.SocketAckEmitter: 0x60000023aa80>\n2017-09-18 20:55:46.530 XFAWealthForPC[85021:16877153] LOG SocketEngine: Got message: 42[\"auth\",true]\n2017-09-18 20:55:46.531 XFAWealthForPC[85021:16877153] LOG SocketIOClient: Should parse message: 2[\"auth\",true]\n2017-09-18 20:55:46.651 XFAWealthForPC[85021:16876586] LOG SocketParser: Parsing 2[\"auth\",true]\n2017-09-18 20:55:46.651 XFAWealthForPC[85021:16876586] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [auth, 1]; id: -1; placeholders: -1; nsp: /}\n2017-09-18 20:55:46.652 XFAWealthForPC[85021:16876586] LOG SocketIOClient: Handling event: auth with data: [1]\nsocket --gy-- auth --22--**[1]---**<SocketIO.SocketAckEmitter: 0x608000230ae0>\n2017-09-18 20:55:46.667 XFAWealthForPC[85021:16877162] LOG SocketEngine: Got message: 42[\"data\",{\"name\":\"position\",\"account\":\"GZA2017\",\"data\":[{\"0\":\"000001\",\"3\":9.65,\"4\":800,\"10\":\"GZA2017\",\"20\":\"SZSE\",\"21\":\"PAB\",\"22\":\"1\",\"23\":\"CNY\",\"31\":9.52,\"73\":\"SPREAD_SZSE_11\",\"115\":9.52,\"505\":\"\u5e73\u5b89\u94f6\u884c\",\"1504\":1,\"1508\":\"0\",\"bodAmount\":7616,\"bodQuantity\":800,\"bodShortQuantity\":0,\"realizedPL\":0,\"unrealizedPL\":104.00000000000063,\"bodPL\":104.00000000000063,\"execPL\":0,\"costPrice\":9.52,\"totalQuantity\":800,\"totalAmount\":7616,\"todayBuyAmount\":0,\"todayBuyQuantity\":0,\"todaySellAmount\":0,\"todaySellQuantity\":0,\"depositAmount\":0,\"depositQuantity\":0,\"withdrawAmount\":0,\"withdrawQuantity\":0,\"bod\":{\"0\":\"000001\",\"4\":\"800\",\"10\":\"GZA2017\",\"38\":\"0\",\"115\":\"0\",\"470\":\"0\",\"schema\":{\"header\":{},\"symbol\":{\"tag\":0},\"bid\":{\"tag\":1},\"ask\":{\"tag\":2},\"price\":{\"tag\":3},\"quantity\":{\"tag\":4},\"status\":{\"tag\":5},\"orderNo\":{\"tag\":6},\"exchNo\":{\"ta.... \nI carefully looked at the output data of Log, LOG SocketParser: Parsing 2[\"auth\" false] is to obtain \u201cauth\u201d validation data before, after successfully sent [\"data\", \"position\"],  then the returned data is required to display the data\n. let socketGY = SocketIOClient(socketURL: URL(string: \"my sever url\")!, config: [.log(true)])\n```objc\n      socketGY.on(clientEvent: .connect) {data, ack in\n            //Verification auth\n            socketGY.emit(\"auth\", UserVerifySessionId)\n       //send request message\n        socketGY.emit(\"data\", with: [\"position\"])\n\n       //get data\n        socketGY.on(\"data\", callback: { (data , ack) in\n            print(\"data = \\(data)\")\n        })\n    }\n\nsocketGY.connect()\n\n```\nThis is the code that I use socketIO\nI want to ask, what kind of solution do you recommend to meet such a problem?\n1., if you really get the data parsing process, because the amount of data is too large to cause no return, is it necessary for me to modify your underlying source code?\n2., if there is data from the Log output that indicates the transfer, does that mean that the data is received here, but that there is a problem in parsing the data to the return method?\n3. although it can receive data, sometimes can not receive data, it may be that server data transmission problem? For example, when a large amount of data and a small amount of data transmission in different ways, resulting in receiving data, the data can not be returned to normal?\n4., the server is using the socketIO over there. If the client receives data on this side all the time, what other third party replacement can you use? What do you recommend?\n\u6211\u60f3\u95ee\u4e00\u4e0b\uff0c\u9047\u5230\u8fd9\u6837\u7684\u95ee\u9898\uff0c\u60a8\u63a8\u8350\u4ec0\u4e48\u6837\u7684\u89e3\u51b3\u601d\u8def\uff1f\n1.\u5982\u679c\u771f\u7684\u662f\u83b7\u53d6\u5230\u6570\u636e\u89e3\u6790\u7684\u8fc7\u7a0b\u56e0\u4e3a\u6570\u636e\u91cf\u592a\u5927\u800c\u5bfc\u81f4\u6ca1\u6709\u529e\u6cd5\u8fd4\u56de\u7684\u8bdd\uff0c\u662f\u4e0d\u662f\u6211\u9700\u8981\u4fee\u6539\u60a8\u7684\u5e95\u5c42\u6e90\u7801\uff1f \n2.\u5982\u679c\u4eceLog\u8f93\u51fa\u4e2d\u6709\u663e\u793a\u4f20\u8f93\u8fc7\u6765\u7684\u6570\u636e\uff0c\u90a3\u662f\u4e0d\u662f\u8bf4\u660e\u8fd9\u8fb9\u63a5\u6536\u5230\u4e86\u6570\u636e\uff0c\u4f46\u662f\u5728\u89e3\u6790\u6570\u636e\u5230\u8fd4\u56de\u65b9\u6cd5\u4e2d\u51fa\u4e86\u95ee\u9898\uff1f\n3.\u867d\u7136\u6709\u7684\u65f6\u5019\u80fd\u63a5\u6536\u5230\u6570\u636e\uff0c\u6709\u7684\u65f6\u5019\u4e0d\u80fd\u63a5\u6536\u6570\u636e\uff0c\u90a3\u53ef\u80fd\u4f1a\u662f\u670d\u52a1\u5668\u90a3\u8fb9\u4f20\u8f93\u6570\u636e\u7684\u95ee\u9898\u5417?\u6bd4\u5982\u6570\u636e\u91cf\u5927\u548c\u6570\u636e\u91cf\u5c0f\u7684\u65f6\u5019\u7684\u4f20\u8f93\u65b9\u5f0f\u4e0d\u540c\uff0c\u5bfc\u81f4\u63a5\u6536\u6570\u636e\u7684\u65f6\u5019\uff0c\u5bf9\u5927\u7684\u6570\u636e\u65e0\u6cd5\u6b63\u5e38\u8fd4\u56de\uff1f\n4.\u670d\u52a1\u5668\u90a3\u8fb9\u4f7f\u7528\u7684\u662fsocketIO,\u5982\u679c\u5ba2\u6237\u7aef\u8fd9\u8fb9\u63a5\u6536\u6570\u636e\u4e00\u76f4\u6709\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ec0\u4e48\u5176\u4ed6\u7684\u7b2c\u4e09\u65b9\u66ff\u6362\u5417\uff1f\u60a8\u6709\u4ec0\u4e48\u63a8\u8350\u5417\uff1f. I try this way put the .on(\"data\"....) before the emits.But isn't work.\nIf the request method is same, but the received data can be successfully resolved some normal return but only some of the Log output and back can not, it is not that the received data format is different?\nIf that's the problem above, then it's the data transfer over the server, right?\n\u5982\u679c\u8bf7\u6c42\u65b9\u6cd5\u76f8\u540c\uff0c\u4f46\u662f\u63a5\u6536\u5230\u7684\u6570\u636e\u6709\u7684\u80fd\u89e3\u6790\u6210\u529f\u6b63\u5e38\u8fd4\u56de\uff0c\u4f46\u662f\u6709\u7684\u53ea\u80fd\u5728Log\u4e2d\u8f93\u51fa\u5e76\u4e0d\u80fd\u6210\u529f\u8fd4\u56de\uff0c\u90a3\u662f\u4e0d\u662f\u8bf4\u660e\u63a5\u6536\u5230\u7684\u6570\u636e\u683c\u5f0f\u662f\u4e0d\u540c\u7684\uff1f\n\u5982\u679c\u662f\u4e0a\u9762\u7684\u95ee\u9898\u7684\u8bdd\uff0c\u90a3\u5c31\u8bf4\u660e\u662f\u670d\u52a1\u5668\u90a3\u8fb9\u4f20\u8f93\u6570\u636e\u7684\u95ee\u9898\u4e86\u5bf9\u5427\uff1f\n. my socket is a global variable \uff0cDon't worry, it will be reclaimed by ARC.  \nIt's 2 in the morning, so I can only try again tomorrow, thank you for your patience, thank you very much. I'm very sorry, I studied the problem carefully, and asked the server developer questions about the data, in fact your framework is no problem, the server returns the data which has a return value is 5e-324, when using JSON analytical system, because the data with the decimal point is too long, that NSNmber is not fit to data offside. \nReference URL\uff1a http://blog.csdn.net/jijiji000111/article/details/52471000, \nthen the server management modify the return value, data analysis is successful, \nSorry for the trouble you have caused us, I'm really so sorry.\n. I'm not sure how big the data is, but what I'm sure is that the amount of data that we need to transmit is going to be very large. I later found that when the socket transfers data, if the amount of data is large, it will be subcontracted, but I don't know if I should set something up for receiving big data. My socket is set like this\n\u6211\u4e5f\u4e0d\u786e\u5b9a\u5177\u4f53\u591a\u5927\u7684\u6570\u636e\uff0c\u4f46\u662f\u6211\u53ef\u4ee5\u786e\u5b9a\u7684\u662f\u6211\u4eec\u9700\u8981\u4f20\u8f93\u7684\u6570\u636e\u91cf\u4f1a\u975e\u5e38\u5927\u3002\u6211\u540e\u6765\u67e5\u5230socket\u4f20\u8f93\u6570\u636e\u7684\u65f6\u5019\uff0c\u5982\u679c\u6570\u636e\u91cf\u5f88\u5927\u7684\u8bdd\u4f1a\u5206\u5305\uff0c\u4f46\u662f\u6211\u4e0d\u77e5\u9053\u5bf9\u4e8e\u63a5\u6536\u5927\u6570\u636e\u7684\u65f6\u5019\u6211\u662f\u4e0d\u662f\u5e94\u8be5\u8bbe\u7f6e\u4e00\u4e9b\u4ec0\u4e48\uff1f\u6211\u7684socket\u662f\u8fd9\u6837\u8bbe\u7f6e\u7684\nobjc\nlet socket = SocketIOClient(socketURL: URL(string: \"my sever url\")!, config: [.log(true), .compress])\nIf I need to receive big data, how should I set my socket? I hope you can teach me, thank you!\n\u5982\u679c\u6211\u9700\u8981\u63a5\u6536\u5927\u91cf\u7684\u6570\u636e\u7684\u8bdd\uff0c\u6211\u5e94\u8be5\u600e\u4e48\u8bbe\u7f6esocket\uff0c\u5e0c\u671b\u60a8\u53ef\u4ee5\u6307\u5bfc\u4e00\u4e0b\uff0c\u8c22\u8c22\uff01. Yes,you can.I'm sorry, is my fault, the two problems are the same, is my description is a little problem, I'm sorry. ",
    "maweis1981": "I thought you can use cocoapods or Carthage to manage your depends thirdparty library, that is a good habit.\ngood luck.. ",
    "danielsGit": "Well, turning on logging means?\nlet socket = SocketIOClient(socketURL: URL(string: \"http://neeleez.com:8383/client\")!, config: [.log(false), .compress])\nI need to set the false as true?. This is my full code.\nvar socket = SocketIOClient(socketURL: URL(string: \"http://206.225.95.239:8383/client\")!)\noverride func viewDidLoad() {\n    super.viewDidLoad()\n\n    // Do any additional setup after loading the view.\n    socket.on(\"connect\") {data, ack in\n        print(\"my socket connected\")\n\n        // var param = [String: Any]()\n        // param[\"client_id\"] = 33\n\n        self.socket.emit(\"client_connect\", [\"client_id\": 33])\n        self.socket.emit(\"get_workers\")\n    }\n\n    socket.on(\"get_all_workers\") { (data, ack) in\n        print(\"Get All Workers\")\n    }\n\n    socket.on(clientEvent: .disconnect) { (data, ack) in\n        print(\"Socket disconnected\")\n    }\n\n    socket.connect()\n}\n\nit logs \"my socket connected\" but \"Get All Workers\" doesn't logged. Any suggestion would be appreciate.. No error in my code? Actually server seems ok because android is working fine. I think this issue is coming from iOS client. \nin server console, it doesn't logged me as connected but in iOS client side, \"my socket connected\" logged.\nAny clue from this?. Yes it works. Thanks a lot. . ",
    "mrrobo1510": "ok. i'll check and contact to you soon if have a problem incurred. thanks for your support. Hi  nuclearace, i was try handle  event  as you say but it not work. I will describe so you can better understand more how our application scenario. I have 2 phone register socket IO also, phone 1 will send data to phone 2 through socket , phone 2 will wait and received data from phone 1. But sometime phone 1 or phone 2 will lost connect socket also, so phone 1 will not send success or phone 2 will not received success. So  i think how to resolve in your lib we will know when  socket lost connection and reconnect , as you say handle event .disconnect or .reconnect  , but it not work.You can check the below code.Please give me any solution about that..Thanks you again!\n**[socketIO on:@\"connect_error\" callback:^(NSArray * arrdata , SocketAckEmitter * ack) {\n    NSLog(@\"___________ Socket Manager connect_error\");\n}];\n[socketIO on:@\"connect_failed\" callback:^(NSArray * arrdata , SocketAckEmitter * ack) {\n    NSLog(@\"___________ Socket Manager connect_failed\");\n}];\n[socketIO on:@\"disconnect\" callback:^(NSArray * arrdata , SocketAckEmitter * ack) {\n    NSLog(@\"___________ Socket Manager error\");        \n}];**\n\n. ",
    "santhoshsk1918": "ok Thanks\n. ",
    "deepakraj27": "yes same error for me. I'm using swift4. ",
    "udayBabariya": "\nf let data: Data = Data(base64Encoded: String(noPrefix), options: .ignoreUnknownCharacters){\n...\n...\n}\n\njust put noPrifix as String.. ",
    "RichAppz": "Do you know when this will be available? This is the last error to be completed. Can anyone help with this? If I can\u2019t get it working will have to roll back. I really wish I could just debug properly! Don't understand what you are asking - can you elaborate. Like I said debugging on the device is almost impossible due to poor tools - Everything is working beautifully on the simulator which is what I can debug to my hearts content!. I have a new MacBook to set up over the coming days, maybe I can try debugging again once it is set up - maybe it's this laptop. Let you know asap. ",
    "olgadanylova": "Thanks for the quick response!\nXcode 9 + Objective-C\nhttp://bit.ly/2jLxIfW. This project was firstly written in Xcode 8, then I've updated it to the recommended settings in Xcode 9.. Just checked my Swift project (it is the same to ObjC project). This error\n\nValue of optional type 'String?' not unwrapped; did you mean to use '!' or '?'?\n\noccurred in the Swift project too - I've fixed it.\nAnd there are no more warnings which were in my ObjC project.\nIs this the only lib I could use for iOS? \nIs there any lib for ObjC?\nWhat lib can I use for mac os?\nThank you for your response!. OK, I'll check. Anyway I've got all the answers I needed - thanks once more!. Hello! I've installed v 13 via cocoapods, but this warning is still here and the WebSocket.swift class is also present. You've made my day! Thanks!. Can be marked as closed.. we've found the solution by changing our server's confing. Closed.. ",
    "akpatrick": "Hello! unfortunately im getting the same error\ni just updated to xcode 9 and v12.0.0\nValue of optional type 'String?' not unwrapped; did you mean to use '!' or '?'?\nin SocketEngine.swift line 28. thanks that fixed it, it was set to Swift 3.x. ",
    "thonydam": "I set the swift compiler version for specific pods via the Podfile:\n```\nswift4 = ['Socket.IO-Client-Swift']\npost_install do |installer|\n  installer.pods_project.targets.each do |target|\nswift_version = '3.2'\n\nif swift4.include?(target.name)\n  swift_version = '4.0'\nend\n\nif swift_version\n  target.build_configurations.each do |config|\n    config.build_settings['SWIFT_VERSION'] = swift_version\n  end\nend\n\nend\nend\n```. ",
    "Vuong-Dao": "got same problem, any update?. ",
    "Caspert": "Thanks for the response. Which framework do you point at? The import SocketIO inside my ViewController.swift or an other library?. I've already try that, but than I receive the following hint: File 'SocketIOManager.swift' is part of module 'SocketIO'; ignoring import When I try then typing SocketIOClient, auto-completion doesn't fill it out and still get above message.. \n\n. I just added the pod via the pod file. Than open the newly created workspace, that white paper one... I just recreate the project one time and is working now. Thanks for your input and help!. ",
    "premveer": "No such module 'Starscream' appearing for me\n. ",
    "IrfanMarwat": "Thanks for reply. My swift version: Apple Swift version 4.0 (swiftlang-900.0.65 clang-900.0.37).. No It did'nt. I was trying this in a simple perfect template project. I\nalso try with the sample for spm. But no luck.\nOn Tue, Oct 3, 2017 at 4:26 PM, Erik Little notifications@github.com\nwrote:\n\nDid that fix the issue?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/socketio/socket.io-client-swift/issues/827#issuecomment-333825900,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AO8gG8_PZqOuk859MmiXZWkyyRzCvmIIks5soigPgaJpZM4PqPeF\n.\n. \n",
    "QuentinArnault": "Client side, we are on v 11.1.3 of Socket.IO-Client-Swift.\nServer side, I asked to our back end team.. Server side we are using v1.3.7.. Ok, I switched back the pod to version 9.0.1, and it works. Thanks.. ",
    "alihen": "I've attemped this in https://github.com/Superbalist/socket.io-client-swift/commit/bbf5367844beccd795209e83b0c466a40e4923db and seems to be working in our implementation of socket.io.\nWe're currently using v11.1.3 - I'll submit a PR for the current version once we upgrade.\nComments/suggestions welcome. I'll do more reading on how other clients deal with this and try bring a future PR in line with those where possible. ",
    "kojiba": "ok, checked code and its looks like a major fuckup\ninstead of \n/// The queue that all interaction with the client should occur on. This is the queue that event handlers are\n    /// called on.\n    @objc\n    public var handleQueue = DispatchQueue.global()\nwe need to use DispatchQueue.global() to creating always new queue to process responces. imho U need to add a configuration parameter to use always different processing queues\n. ok, but anyway communication library is mustn't be syncronous. changed all to DispatchQueue.global(qos: .background).async\nfor first tests its works +- fine. double check the apple docs, cause now it seems better(faster working) to create standalone queue for each request/response, so I am not sure that staticQueue.async will work better\nI will tune this for myself locally, but keep this in mind c:. ",
    "dk250": "`\n// create socket 1 \nSocketIOClient *socket1 = [[SocketIOClient alloc] initWithSocketURL:[[NSURL alloc] initWithString:@\"https://test.lqy.com\"] config:@{@\"log\": @YES, @\"nsp\":@\"test1\" }];\n [socket1 on:@\"connect\" callback:^(NSArray * _Nonnull data, SocketAckEmitter * _Nonnull ack) {\n        NSLog(@\"socket1 connected successfully\");\n    }];\n[socket1 connect];\n//create socket 2\nSocketIOClient *socket2 = [[SocketIOClient alloc] initWithSocketURL:[[NSURL alloc] initWithString:@\"https://test.lqy.com\"] config:@{@\"log\": @YES, @\"nsp\":@\"test2\" }];\n [socket2 on:@\"connect\" callback:^(NSArray * _Nonnull data, SocketAckEmitter * _Nonnull ack) {\n        NSLog(@\"socket2 connected successfully\");\n    }];\n[socket2 connect];\n`\nSocket1 can connect successful and log \"socket1 connected successfully\", but socket2 is failed. no call back. . I think I have solved my problem. The socket2 can not connect the server successfully, because it is a local variable.  I make it to be member variable of class. It works. Thank u.. ",
    "TruongDang": "I need to use v11.1.3 for the reason that my project is developing on swift version 3. github \"socketio/socket.io-client-swift\" ~> 11.1.3\ngithub \"daltoniam/Starscream\" ~>  2.0.3\nCan I use it?. ",
    "fabrijp": "Sorry, I\u2019m just trying to add it to a new iOS project. I never used Managed Packages before and just creating a Package.swift with the dependencies like discribled in the readme file, running swift package resolve isnt helping me much to start using it. \n\nOn Oct 23, 2017, at 21:11, Erik Little notifications@github.com wrote:\n\"I can't just make it work\" is not helpful. What does not work? How are you creating the client? Have you turned on logging? Have you checked the FAQ?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub, or mute the thread.\n. Got it to work with Carthage. Thank you !\nOn Oct 23, 2017, at 21:30, Erik Little notifications@github.com wrote:\n@fabrijp https://github.com/fabrijp For an iOS project you'll probably want to use CocoaPods https://cocoapods.org/ or Carthage https://github.com/Carthage/Carthage, SPM support for iOS projects isn't very good. You'll have to read up on using those package managers in iOS projects. Generally when you use a library, you should have a basic understanding of how to install them.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub https://github.com/socketio/socket.io-client-swift/issues/848#issuecomment-338643275, or mute the thread https://github.com/notifications/unsubscribe-auth/AEu0woGSBtFE_UeyEwWpgx-A3so8UNkJks5svIbvgaJpZM4QCuIa.\n\n\n. ",
    "CAMOBAP795": "The same problem for me, clean project && rm ~/Library/Developer/Xcode/DerivedData didn't help. ### Long story short (step by step solution)\n\nFind which source lead to compilation error. In my case it was one of UIViewController implementation, MyViewController.swift\n\nFind related .swiftdeps file, in my case MyViewController.swiftdeps\ncat ~/Library/Developer/Xcode/DerivedData/HelloWorld-*/Build/Intermediates.noindex/HelloWorld.build/Debug-iphonesimulator/HelloWorld.build/Objects-normal/x86_64/MyViewController.swiftdeps | grep zlib\n* you may have different path\n\n\nCommand above produce several lines:\n```\n\n\"/Developers/Projects/HelloWorld/Pods/Starscream/zlib/module.modulemap\"\n\"/Developers/Projects/HelloWorldLibrary/Pods/Starscream/zlib/module.modulemap\"\n```\nHere is where duplication comes, now it's up to you how you will resolve it, there is no universal advice (for me it was to delete directory from last line)\n\nLong story\nI'm working on library which I will distribute as closed source product, technically as framework, so I build this library locally, and as far as I understood implicitly it have references to all module.modulemap files, so once I included this framework as local pod it gave me this errors\nBTW Anyone can advice good article/doc which will explain swift compilation process, all these: .swiftdeps, .swiftmodule, and how swift toolchain/pipeline works?. @zenkimoto rename which you propose will not help because *. swiftdeps under control of xcode, and it will overwrite any changes. @zenkimoto so your proposal to do mv /Developers/Projects/HelloWorld/Pods/Starscream/zlib/module.modulemap /zlib.modulemap, right?\nThere is maybe several conflict modulemap files so easier to mv/rm whole Pods directory. @zenkimoto thanks, yep this helped me to, looks like it's not clear from my comment above I will improve it. ",
    "zenkimoto": "Same here.  I'm also trying to build a closed source product and I can confirm the module dependency duplication.  Also removing DerivedData didn't help.  Anyone got any ideas?. In your case, try renaming the file: /Developers/Projects/HelloWorld/Pods/Starscream/zlib/module.modulemap to say something like zlib.modulemap. @CAMOBAP795 The modulemap file, not *.swiftdeps.. @CAMOBAP795 Yes.  I was able to rename the modulemap file and get it to compile.  I was wondering if that would help you out too.. ",
    "willdenms": "Same problem here. I've been trying to work around this for a while. Has anyone had any luck?. ",
    "leonnoel777": "Same problem... how to solve this..?? . ",
    "smartKrunal": "@nuclearace  right now i am using v12. you want to say that, if i am install v13, then this kind of issue may not be occur ?\ni cant get exact meaning. what you trying to say. please help me to resolving this issue.. ```\n& This is client logs\n2017-11-07 11:22:03.333528+0530 Techne[5209:2753090] [MC] Lazy loading NSBundle MobileCoreServices.framework\n2017-11-07 11:22:03.340013+0530 Techne[5209:2753090] [MC] Loaded MobileCoreServices.framework\n2017-11-07 11:22:03.351985+0530 Techne[5209:2753090] [MC] System group container for systemgroup.com.apple.configurationprofiles path is /private/var/containers/Shared/SystemGroup/systemgroup.com.apple.configurationprofiles\n2017-11-07 11:22:03.399739+0530 Techne[5209:2753090] LOG SocketIOClient: Adding handler for event: connect\n2017-11-07 11:22:03.401355+0530 Techne[5209:2753090] LOG SocketIOClient: Adding handler for event: disconnect\n2017-11-07 11:22:03.401799+0530 Techne[5209:2753090] LOG SocketIOClient: Adding handler for event: reconnect\n2017-11-07 11:22:03.402135+0530 Techne[5209:2753090] LOG SocketIOClient: Adding handler for event: reconnectAttempt\n2017-11-07 11:22:03.402445+0530 Techne[5209:2753090] LOG SocketIOClient: Adding handler for event: statusChange\n2017-11-07 11:22:03.402661+0530 Techne[5209:2753090] LOG SocketIOClient: Adding handler for event: error\n2017-11-07 11:22:03.405613+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : \n2017-11-07 11:22:03.406192+0530 Techne[5209:2753090] LOG SocketIOClient: Adding engine\n2017-11-07 11:22:03.410453+0530 Techne[5209:2753227] LOG SocketEngine: Starting engine. Server: (kBaseUrl)http://xxxxxx/\n2017-11-07 11:22:03.410693+0530 Techne[5209:2753227] LOG SocketEngine: Handshaking\n2017-11-07 11:22:03.701648+0530 Techne[5209:2753227] LOG SocketEngine: Got message: 0{\"sid\":\"oafkcLCFmNDQ9PflAACz\",\"upgrades\":[],\"pingInterval\":10000,\"pingTimeout\":7000}\n2017-11-07 11:22:03.704919+0530 Techne[5209:2753090] LOG SocketIOClient: Engine opened Connect\n2017-11-07 11:22:03.704924+0530 Techne[5209:2753227] LOG SocketEngine: Got message: 40\n2017-11-07 11:22:03.705181+0530 Techne[5209:2753090] LOG SocketIOClient: Socket connected\n2017-11-07 11:22:03.705260+0530 Techne[5209:2753227] LOG SocketIOClient: Should parse message: 0\n2017-11-07 11:22:03.705471+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\n2017-11-07 11:22:03.705532+0530 Techne[5209:2753227] LOG SocketEngine: Got message: 42[\"joinRoom\",{}]\nSocket StatusChange !!! SocketSid : oafkcLCFmNDQ9PflAACz\n2017-11-07 11:22:03.705701+0530 Techne[5209:2753227] LOG SocketIOClient: Should parse message: 2[\"joinRoom\",{}]\n2017-11-07 11:22:03.705899+0530 Techne[5209:2753227] LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:22:03.705976+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: connect with data: [\"/\"]\n2017-11-07 11:22:03.706057+0530 Techne[5209:2753227] LOG SocketEngineWebSocket: Sending ws:  as type: 2\nSocket Connected Successfully !!! SocketSid : oafkcLCFmNDQ9PflAACz Time : 2017-11-07 05:52:03 +0000\n2017-11-07 11:22:03.710595+0530 Techne[5209:2753090] LOG SocketParser: Parsing 0\n2017-11-07 11:22:03.712369+0530 Techne[5209:2753090] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2017-11-07 11:22:03.712617+0530 Techne[5209:2753090] LOG SocketParser: Parsing 2[\"joinRoom\",{}]\n2017-11-07 11:22:03.714691+0530 Techne[5209:2753090] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [joinRoom, {\n}]; id: -1; placeholders: -1; nsp: /}\n2017-11-07 11:22:03.715987+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: joinRoom with data: [{\n}]\n2017-11-07 11:22:03.811730+0530 Techne[5209:2753236] LOG SocketEngine: Got message: 3\n2017-11-07 11:22:04.033970+0530 Techne[5209:2753227] [Firebase/Core][I-COR000003] The default Firebase app has not yet been configured. Add [FIRApp configure] to your application initialization. Read more: https://goo.gl/ctyzm8.\n2017-11-07 11:22:04.036 Techne[5209]  [Firebase/Core][I-COR000003] The default Firebase app has not yet been configured. Add [FIRApp configure] to your application initialization. Read more: https://goo.gl/ctyzm8.\n2017-11-07 11:22:13.485140+0530 Techne[5209:2753090] +[CATransaction synchronize] called within transaction\n2017-11-07 11:22:13.485483+0530 Techne[5209:2753090] +[CATransaction synchronize] called within transaction\n2017-11-07 11:22:33.027305+0530 Techne[5209:2753236] LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:22:33.027427+0530 Techne[5209:2753236] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-11-07 11:22:33.032048+0530 Techne[5209:2753780] SocketStream write error [0x1c4172d80]: 1 32\n2017-11-07 11:22:33.036371+0530 Techne[5209:2753445] [] nw_socket_get_input_frames recvmsg(fd 7, 1024 bytes): [57] Socket is not connected\n2017-11-07 11:22:33.056010+0530 Techne[5209:2753236] ERROR SocketEngine: The operation couldn\u2019t be completed. Broken pipe\n2017-11-07 11:22:33.062419+0530 Techne[5209:2753090] ERROR SocketIOClient: The operation couldn\u2019t be completed. Broken pipe\n2017-11-07 11:22:33.062641+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: error with data: [\"The operation couldn\u2019t be completed. Broken pipe\"]\nSocket Error !!! SocketSid : \n2017-11-07 11:22:33.062832+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : \n2017-11-07 11:22:33.102759+0530 Techne[5209:2753090] LOG SocketIOClient: Disconnected: The operation couldn\u2019t be completed. Broken pipe\n2017-11-07 11:22:33.103001+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : \n2017-11-07 11:22:33.103329+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: disconnect with data: [\"The operation couldn\u2019t be completed. Broken pipe\"]\nSocket Disconnected !!! SocketSid :  Time : 2017-11-07 05:52:33 +0000\ndataArray : [\"The operation couldn\u2019t be completed. Broken pipe\"]\n2017-11-07 11:22:33.205286+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : \n2017-11-07 11:22:33.206116+0530 Techne[5209:2753783] LOG SocketEngine: Starting engine. Server: (kBaseUrl )http://xxxxxxxxxxxxx\n2017-11-07 11:22:33.206543+0530 Techne[5209:2753783] LOG SocketEngine: Handshaking\n2017-11-07 11:22:33.595150+0530 Techne[5209:2753780] LOG SocketEngine: Got message: 0{\"sid\":\"4zeWffUZbOwJGmD9AAC0\",\"upgrades\":[],\"pingInterval\":10000,\"pingTimeout\":7000}\n2017-11-07 11:22:33.596630+0530 Techne[5209:2753090] LOG SocketIOClient: Engine opened Connect\n2017-11-07 11:22:33.596786+0530 Techne[5209:2753090] LOG SocketIOClient: Socket connected\n2017-11-07 11:22:33.596867+0530 Techne[5209:2753780] LOG SocketEngine: Got message: 40\n2017-11-07 11:22:33.597076+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : 4zeWffUZbOwJGmD9AAC0\n2017-11-07 11:22:33.597196+0530 Techne[5209:2753780] LOG SocketIOClient: Should parse message: 0\n2017-11-07 11:22:33.597293+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: connect with data: [\"/\"]\n2017-11-07 11:22:33.597358+0530 Techne[5209:2753780] LOG SocketEngine: Got message: 42[\"joinRoom\",{}]\n2017-11-07 11:22:33.597470+0530 Techne[5209:2753780] LOG SSocket Connected Successfully !!! SocketSid : 4zeWffUZbOwJGmD9AAC0 Time : 2017-11-07 05:52:33 +0000\n2017-11-07 11:22:33.597978+0530 Techne[5209:2753090] LOG SocketParser: Parsing 0\n2017-11-07 11:22:33.598176+0530 Techne[5209:2753090] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\nocketIOClient: Should parse message: 2[\"joinRoom\",{}]\n2017-11-07 11:22:33.601611+0530 Techne[5209:2753090] LOG SocketParser: Parsing 2[\"joinRoom\",{}]\n2017-11-07 11:22:33.602221+0530 Techne[5209:2753090] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [joinRoom, {\n}]; id: -1; placeholders: -1; nsp: /}\n2017-11-07 11:22:33.602560+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: joinRoom with data: [{\n}]\n2017-11-07 11:22:33.602933+0530 Techne[5209:2753780] LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:22:33.603132+0530 Techne[5209:2753780] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-11-07 11:22:33.711453+0530 Techne[5209:2753782] LOG SocketEngine: Got message: 3\n2017-11-07 11:22:43.896992+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : 4zeWffUZbOwJGmD9AAC0\n2017-11-07 11:22:43.897391+0530 Techne[5209:2753090] LOG SocketIOClient: Disconnected: Ping timeout\n2017-11-07 11:22:43.897616+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : 4zeWffUZbOwJGmD9AAC0\n2017-11-07 11:22:43.897948+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: disconnect with data: [\"Ping timeout\"]\nSocket Disconnected !!! SocketSid : 4zeWffUZbOwJGmD9AAC0 Time : 2017-11-07 05:52:43 +0000\ndataArray : [\"Ping timeout\"]\n2017-11-07 11:22:43.898879+0530 Techne[5209:2753780] LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:22:43.899036+0530 Techne[5209:2753780] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-11-07 11:22:43.899377+0530 Techne[5209:2753780] LOG SocketEngine: Engine is being closed.\n2017-11-07 11:22:43.901805+0530 Techne[5209:2753780] LOG SocketEngineWebSocket: Sending ws:  as type: 1\n2017-11-07 11:22:44.001306+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : \n2017-11-07 11:22:44.002472+0530 Techne[5209:2753780] LOG SocketEngine: Starting engine. Server: (kBaseUrl)http://xxxxx:xxx/\n2017-11-07 11:22:44.002634+0530 Techne[5209:2753780] LOG SocketEngine: Handshaking\n2017-11-07 11:22:44.326579+0530 Techne[5209:2753445] LOG SocketEngine: Got message: 0{\"sid\":\"8iTjaaa2LNiCepZ6AAC1\",\"upgrades\":[],\"pingInterval\":10000,\"pingTimeout\":7000}\n2017-11-07 11:22:44.327654+0530 Techne[5209:2753090] LOG SocketIOClient: Engine opened Connect\n2017-11-07 11:22:44.327818+0530 Techne[5209:2753090] LOG SocketIOClient: Socket connected\n2017-11-07 11:22:44.328097+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : 8iTjaaa2LNiCepZ6AAC1\n2017-11-07 11:22:44.328407+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: connect with data: [\"/\"]\nSocket Connected Successfully !!! SocketSid : 8iTjaaa2LNiCepZ6AAC1 Time : 2017-11-07 05:52:44 +0000\n2017-11-07 11:22:44.329052+0530 Techne[5209:2753445] LOG SocketEngine: Got message: 40\n2017-11-07 11:22:44.329240+0530 Techne[5209:2753445] LOG SocketIOClient: Should parse message: 0\n2017-11-07 11:22:44.329607+0530 Techne[5209:2753090] LOG SocketParser: Parsing 0\n2017-11-07 11:22:44.330326+0530 Techne[5209:2753090] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2017-11-07 11:22:44.329759+0530 Techne[5209:2753445] LOG SocketEngine: Got message: 42[\"joinRoom\",{}]\n2017-11-07 11:22:44.330667+0530 Techne[5209:2753445] LOG SocketIOClient: Should parse message: 2[\"joinRoom\",{}]\n2017-11-07 11:22:44.330874+0530 Techne[5209:2753090] LOG SocketParser: Parsing 2[\"joinRoom\",{}]\n2017-11-07 11:22:44.331446+0530 Techne[5209:2753090] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [joinRoom, {\n}]; id: -1; placeholders: -1; nsp: /}\n2017-11-07 11:22:44.331742+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: joinRoom with data: [{\n}]\n2017-11-07 11:22:44.332108+0530 Techne[5209:2753445] LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:22:44.332253+0530 Techne[5209:2753445] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-11-07 11:22:44.430722+0530 Techne[5209:2753831] LOG SocketEngine: Got message: 3\n2017-11-07 11:22:54.897173+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : 8iTjaaa2LNiCepZ6AAC1\n2017-11-07 11:22:54.897562+0530 Techne[5209:2753090] LOG SocketIOClient: Disconnected: Ping timeout\n2017-11-07 11:22:54.897785+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : 8iTjaaa2LNiCepZ6AAC1\n2017-11-07 11:22:54.898234+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: disconnect with data: [\"Ping timeout\"]\nSocket Disconnected !!! SocketSid : 8iTjaaa2LNiCepZ6AAC1 Time : 2017-11-07 05:52:54 +0000\ndataArray : [\"Ping timeout\"]\n2017-11-07 11:22:54.899276+0530 Techne[5209:2753874] LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:22:54.899446+0530 Techne[5209:2753874] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-11-07 11:22:54.899790+0530 Techne[5209:2753874] LOG SocketEngine: Engine is being closed.\n2017-11-07 11:22:54.901329+0530 Techne[5209:2753874] LOG SocketEngineWebSocket: Sending ws:  as type: 1\n2017-11-07 11:22:54.999688+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : \n2017-11-07 11:22:55.000511+0530 Techne[5209:2753780] LOG SocketEngine: Starting engine. Server:(kBaseUrl)http://xxxxx:xxx/\n2017-11-07 11:22:55.000663+0530 Techne[5209:2753780] LOG SocketEngine: Handshaking\n2017-11-07 11:22:55.747418+0530 Techne[5209:2753780] LOG SocketEngine: Got message: 0{\"sid\":\"Hdgu9MFUtD2jjHb0AAC2\",\"upgrades\":[],\"pingInterval\":10000,\"pingTimeout\":7000}\n2017-11-07 11:22:55.748439+0530 Techne[5209:2753090] LOG SocketIOClient: Engine opened Connect\n2017-11-07 11:22:55.748605+0530 Techne[5209:2753090] LOG SocketIOClient: Socket connected\n2017-11-07 11:22:55.748878+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : Hdgu9MFUtD2jjHb0AAC2\n2017-11-07 11:22:55.749188+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: connect with data: [\"/\"]\nSocket Connected Successfully !!! SocketSid : Hdgu9MFUtD2jjHb0AAC2 Time : 2017-11-07 05:52:55 +0000\n2017-11-07 11:22:55.749817+0530 Techne[5209:2753780] LOG SocketEngine: Got message: 40\n2017-11-07 11:22:55.750005+0530 Techne[5209:2753780] LOG SocketIOClient: Should parse message: 0\n2017-11-07 11:22:55.750211+0530 Techne[5209:2753090] LOG SocketParser: Parsing 0\n2017-11-07 11:22:55.750750+0530 Techne[5209:2753090] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2017-11-07 11:22:55.750359+0530 Techne[5209:2753780] LOG SocketEngine: Got message: 42[\"joinRoom\",{}]\n2017-11-07 11:22:55.751069+0530 Techne[5209:2753780] LOG SocketIOClient: Should parse message: 2[\"joinRoom\",{}]\n2017-11-07 11:22:55.751270+0530 Techne[5209:2753090] LOG SocketParser: Parsing 2[\"joinRoom\",{}]\n2017-11-07 11:22:55.751869+0530 Techne[5209:2753090] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [joinRoom, {\n}]; id: -1; placeholders: -1; nsp: /}\n2017-11-07 11:22:55.752165+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: joinRoom with data: [{\n}]\n2017-11-07 11:22:55.752528+0530 Techne[5209:2753780] LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:22:55.752675+0530 Techne[5209:2753780] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-11-07 11:22:56.148024+0530 Techne[5209:2753875] LOG SocketEngine: Got message: 3\n2017-11-07 11:23:05.897112+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : Hdgu9MFUtD2jjHb0AAC2\n2017-11-07 11:23:05.897503+0530 Techne[5209:2753090] LOG SocketIOClient: Disconnected: Ping timeout\n2017-11-07 11:23:05.897726+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : Hdgu9MFUtD2jjHb0AAC2\n2017-11-07 11:23:05.898269+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: disconnect with data: [\"Ping timeout\"]\nSocket Disconnected !!! SocketSid : Hdgu9MFUtD2jjHb0AAC2 Time : 2017-11-07 05:53:05 +0000\ndataArray : [\"Ping timeout\"]\n2017-11-07 11:23:05.899311+0530 Techne[5209:2753923] LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:23:05.899480+0530 Techne[5209:2753923] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-11-07 11:23:05.899827+0530 Techne[5209:2753923] LOG SocketEngine: Engine is being closed.\n2017-11-07 11:23:05.901404+0530 Techne[5209:2753923] LOG SocketEngineWebSocket: Sending ws:  as type: 1\n2017-11-07 11:23:06.000503+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : \n2017-11-07 11:23:06.001211+0530 Techne[5209:2753874] LOG SocketEngine: Starting engine. Server: (kBaseUrl)http://xxxxx:xxx/\n2017-11-07 11:23:06.001358+0530 Techne[5209:2753874] LOG SocketEngine: Handshaking\n2017-11-07 11:23:06.564134+0530 Techne[5209:2753923] LOG SocketEngine: Got message: 0{\"sid\":\"fvxfvfpw1rvy10ndAAC3\",\"upgrades\":[],\"pingInterval\":10000,\"pingTimeout\":7000}\n2017-11-07 11:23:06.565345+0530 Techne[5209:2753090] LOG SocketIOClient: Engine opened Connect\n2017-11-07 11:23:06.565518+0530 Techne[5209:2753090] LOG SocketIOClient: Socket connected\n2017-11-07 11:23:06.565793+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : fvxfvfpw1rvy10ndAAC3\n2017-11-07 11:23:06.566105+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: connect with data: [\"/\"]\nSocket Connected Successfully !!! SocketSid : fvxfvfpw1rvy10ndAAC3 Time : 2017-11-07 05:53:06 +0000\n2017-11-07 11:23:06.567737+0530 Techne[5209:2753923] LOG SocketEngine: Got message: 40\n2017-11-07 11:23:06.567938+0530 Techne[5209:2753923] LOG SocketIOClient: Should parse message: 0\n2017-11-07 11:23:06.568154+0530 Techne[5209:2753090] LOG SocketParser: Parsing 0\n2017-11-07 11:23:06.568748+0530 Techne[5209:2753090] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2017-11-07 11:23:06.568308+0530 Techne[5209:2753923] LOG SocketEngine: Got message: 42[\"joinRoom\",{}]\n2017-11-07 11:23:06.569079+0530 Techne[5209:2753923] LOG SocketIOClient: Should parse message: 2[\"joinRoom\",{}]\n2017-11-07 11:23:06.569281+0530 Techne[5209:2753090] LOG SocketParser: Parsing 2[\"joinRoom\",{}]\n2017-11-07 11:23:06.570032+0530 Techne[5209:2753090] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [joinRoom, {\n}]; id: -1; placeholders: -1; nsp: /}\n2017-11-07 11:23:06.570336+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: joinRoom with data: [{\n}]\n2017-11-07 11:23:06.570716+0530 Techne[5209:2753923] LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:23:06.570861+0530 Techne[5209:2753923] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-11-07 11:23:06.784021+0530 Techne[5209:2753925] LOG SocketEngine: Got message: 3\n2017-11-07 11:23:16.896790+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : fvxfvfpw1rvy10ndAAC3\n2017-11-07 11:23:16.897187+0530 Techne[5209:2753090] LOG SocketIOClient: Disconnected: Ping timeout\n2017-11-07 11:23:16.897411+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : fvxfvfpw1rvy10ndAAC3\n2017-11-07 11:23:16.897745+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: disconnect with data: [\"Ping timeout\"]\nSocket Disconnected !!! SocketSid : fvxfvfpw1rvy10ndAAC3 Time : 2017-11-07 05:53:16 +0000\ndataArray : [\"Ping timeout\"]\n2017-11-07 11:23:16.898608+0530 Techne[5209:2753923] LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:23:16.898770+0530 Techne[5209:2753923] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-11-07 11:23:16.899271+0530 Techne[5209:2753923] LOG SocketEngine: Engine is being closed.\n2017-11-07 11:23:16.901291+0530 Techne[5209:2753923] LOG SocketEngineWebSocket: Sending ws:  as type: 1\n2017-11-07 11:23:16.999558+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : \n2017-11-07 11:23:17.000266+0530 Techne[5209:2753985] LOG SocketEngine: Starting engine. Server: (kBaseUrl)http://xxxxx:xxx/\n2017-11-07 11:23:17.000459+0530 Techne[5209:2753985] LOG SocketEngine: Handshaking\n2017-11-07 11:23:17.228693+0530 Techne[5209:2753987] LOG SocketEngine: Got message: 0{\"sid\":\"e-wdmHnN_707tVyYAAC4\",\"upgrades\":[],\"pingInterval\":10000,\"pingTimeout\":7000}\n2017-11-07 11:23:17.229756+0530 Techne[5209:2753090] LOG SocketIOClient: Engine opened Connect\n2017-11-07 11:23:17.229932+0530 Techne[5209:2753090] LOG SocketIOClient: Socket connected\n2017-11-07 11:23:17.230208+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : e-wdmHnN_707tVyYAAC4\n2017-11-07 11:23:17.230521+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: connect with data: [\"/\"]\nSocket Connected Successfully !!! SocketSid : e-wdmHnN_707tVyYAAC4 Time : 2017-11-07 05:53:17 +0000\n2017-11-07 11:23:17.231355+0530 Techne[5209:2753987] LOG SocketEngine: Got message: 40\n2017-11-07 11:23:17.231546+0530 Techne[5209:2753987] LOG SocketIOClient: Should parse message: 0\n2017-11-07 11:23:17.231754+0530 Techne[5209:2753090] LOG SocketParser: Parsing 0\n2017-11-07 11:23:17.232798+0530 Techne[5209:2753090] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2017-11-07 11:23:17.231901+0530 Techne[5209:2753987] LOG SocketEngine: Got message: 42[\"joinRoom\",{}]\n2017-11-07 11:23:17.233142+0530 Techne[5209:2753987] LOG SocketIOClient: Should parse message: 2[\"joinRoom\",{}]\n2017-11-07 11:23:17.233348+0530 Techne[5209:2753090] LOG SocketParser: Parsing 2[\"joinRoom\",{}]\n2017-11-07 11:23:17.233924+0530 Techne[5209:2753090] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [joinRoom, {\n}]; id: -1; placeholders: -1; nsp: /}\n2017-11-07 11:23:17.234216+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: joinRoom with data: [{\n}]\n2017-11-07 11:23:17.234613+0530 Techne[5209:2753987] LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:23:17.234761+0530 Techne[5209:2753987] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-11-07 11:23:17.330256+0530 Techne[5209:2753923] LOG SocketEngine: Got message: 3\n2017-11-07 11:23:27.896857+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : e-wdmHnN_707tVyYAAC4\n2017-11-07 11:23:27.897247+0530 Techne[5209:2753090] LOG SocketIOClient: Disconnected: Ping timeout\n2017-11-07 11:23:27.897469+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : e-wdmHnN_707tVyYAAC4\n2017-11-07 11:23:27.897799+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: disconnect with data: [\"Ping timeout\"]\nSocket Disconnected !!! SocketSid : e-wdmHnN_707tVyYAAC4 Time : 2017-11-07 05:53:27 +0000\ndataArray : [\"Ping timeout\"]\n2017-11-07 11:23:27.898657+0530 Techne[5209:2754013] LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:23:27.898947+0530 Techne[5209:2754013] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-11-07 11:23:27.899286+0530 Techne[5209:2754013] LOG SocketEngine: Engine is being closed.\n2017-11-07 11:23:27.901191+0530 Techne[5209:2754013] LOG SocketEngineWebSocket: Sending ws:  as type: 1\n2017-11-07 11:23:27.999214+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : \n2017-11-07 11:23:27.999919+0530 Techne[5209:2754027] LOG SocketEngine: Starting engine. Server:(kBaseUrl)http://xxxxx:xxx/\n2017-11-07 11:23:28.000103+0530 Techne[5209:2754027] LOG SocketEngine: Handshaking\n2017-11-07 11:23:28.585370+0530 Techne[5209:2753985] LOG SocketEngine: Got message: 0{\"sid\":\"dUQRk_rMwRxaHsT-AAC5\",\"upgrades\":[],\"pingInterval\":10000,\"pingTimeout\":7000}\n2017-11-07 11:23:28.586688+0530 Techne[5209:2753090] LOG SocketIOClient: Engine opened Connect\n2017-11-07 11:23:28.586710+0530 Techne[5209:2753985] LOG SocketEngine: Got message: 40\n2017-11-07 11:23:28.587045+0530 Techne[5209:2753090] LOG SocketIOClient: Socket connected\n2017-11-07 11:23:28.587242+0530 Techne[5209:2753985] LOG SocketIOClient: Should parse message: 0\n2017-11-07 11:23:28.587466+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: statusChange with data: [SocketIO.SocketIOClientStatus]\nSocket StatusChange !!! SocketSid : dUQRk_rMwRxaHsT-AAC5\n2017-11-07 11:23:28.587859+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: connect with data: [\"/\"]\nSocket Connected Successfully !!! SocketSid : dUQRk_rMwRxaHsT-AAC5 Time : 2017-11-07 05:53:28 +0000\n2017-11-07 11:23:28.588536+0530 Techne[5209:2753090] LOG SocketParser: Parsing 0\n2017-11-07 11:23:28.588806+0530 Techne[5209:2753090] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2017-11-07 11:23:28.589649+0530 Techne[5209:2753985] LOG SocketEngine: Got message: 42[\"joinRoom\",{}]\n2017-11-07 11:23:28.589859+0530 Techne[5209:2753985] LOG SocketIOClient: Should parse message: 2[\"joinRoom\",{}]\n2017-11-07 11:23:28.590099+0530 Techne[5209:2753090] LOG SocketParser: Parsing 2[\"joinRoom\",{}]\n2017-11-07 11:23:28.590165+0530 Techne[5209:2753985]2017-11-07 11:23:28.590743+0530 Techne[5209:2753090] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [joinRoom, {\n}]; id: -1; placeholders: -1; nsp: /}\n LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:23:28.591280+0530 Techne[5209:2753985] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-11-07 11:23:28.591333+0530 Techne[5209:2753090] LOG SocketIOClient: Handling event: joinRoom with data: [{\n}]\n2017-11-07 11:23:28.729923+0530 Techne[5209:2754013] LOG SocketEngine: Got message: 3\n2017-11-07 11:23:37.996168+0530 Techne[5209:2754027] LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:23:37.996518+0530 Techne[5209:2754027] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-11-07 11:23:38.218116+0530 Techne[5209:2754088] LOG SocketEngine: Got message: 3\n2017-11-07 11:23:38.996349+0530 Techne[5209:2754088] LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:23:38.996611+0530 Techne[5209:2754088] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-11-07 11:23:39.127543+0530 Techne[5209:2754027] LOG SocketEngine: Got message: 3\n2017-11-07 11:23:48.996625+0530 Techne[5209:2754126] LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:23:48.996887+0530 Techne[5209:2754126] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-11-07 11:23:49.265750+0530 Techne[5209:2754088] LOG SocketEngine: Got message: 3\n2017-11-07 11:23:49.996497+0530 Techne[5209:2754088] LOG SocketEngine: Writing ws:  has data: false\n2017-11-07 11:23:49.996760+0530 Techne[5209:2754088] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2017-11-07 11:23:50.186289+0530 Techne[5209:2754126] LOG SocketEngine: Got message: 3\n```. @nuclearace  so should i  pass forceNew(false) or forceNew(true) ?. Yo... it Resolved.....\nThank You Very Very Much @nuclearace\nCan you please give your email & skype id. Or this is my email id krunal.smartsensesolutions@gmail.com.\nYou send just simple mail on my id.. @nuclearace Whenever I am installing pod, The library gives errors & warnings in swift 3. These are not issues, But Suggestion is there from my side, Whenever you Release new build next time, if possible then you can take this change also.\n\n. ",
    "stefanoa": "I tested on v13.3.0 and I can confirm the issue is still there, the problem is related to the use of a proxy (in our case HAProxy). \nTo recreate the issue simply install the socket.io server behind a proxy, connect a client to it and simply perform a server restart; the reconnect will fail indefinitely.\nThis is because the proxy will respond with a valid HTTP code (503 in our case) and than the polling mechanism somehow fails to correctly detect the problem.\nThe issue is in SocketEnginePollable in\n```\nfunc doLongPoll(for req: URLRequest) {\n        waitingForPoll = true\n        doRequest(for: req) {[weak self] data, res, err in\n            guard let this = self, this.polling else { return }\n        // err should be != nil also for status code != 200 but currently is nil even for 503 (Bad Gateway)\n        if err != nil || data == nil {\n            DefaultSocketLogger.Logger.error(err?.localizedDescription ?? \"Error\", type: \"SocketEnginePolling\")\n\n            if this.polling {\n                this.didError(reason: err?.localizedDescription ?? \"Error\")\n            }\n\n            return\n        }\n        // If the server returns an error code (503 for example) the error is undetected and the flow continue here but the reconnect fails indefinitely\n\n        DefaultSocketLogger.Logger.log(\"Got polling response\", type: \"SocketEnginePolling\")\n\n        if let str = String(data: data!, encoding: .utf8) {\n            this.parsePollingMessage(str)\n        }\n\n        this.waitingForPoll = false\n\n        if this.fastUpgrade {\n            this.doFastUpgrade()\n        } else if !this.closed && this.polling {\n            this.doPoll()\n        }\n    }\n}\n\n```\nIf a restart of the server is done (to release new features for example) the connection on the client is lost but the reconnect fails indefinitely. I added some comments in the code to explain the problem.\nI patched the code to consider as errors all the HTTP status codes different from 200 and it works correctly for us.. @nuclearace It works for me but maybe it is better to manage the statusCode in the doRequest method because the issue can happen in other cases. \n. ",
    "0xpablo": "Re-reading the docs, it seems that all interactions must be done on the handle queue. Oops.. ",
    "nefy55": "@nuclearace Yes I am sure. Server sends messages with this name : \"message\" . But \u0131 not listen messages. . I tried all of them. But not received. ",
    "dereknex": "@nefy55 do you  have check you namespace?\ntry the following code:\nobjective-c\nNSURL* url = [[NSURL alloc] initWithString:@\"ws://127.0.0.1:8000\"];\n_manager = [[SocketManager alloc] initWithSocketURL:url config:@{@\"log\": @YES}];\nSocketIOClient* socket = [_manager socketForNamespace:@\"/test\"];. ",
    "SusheelYadavAhex": "Hi @nefy55 , are you able to listen to socket events ? Actually i am able to connect to socket through namespace and able to sent the jwt token to socket also, but unable to listen to events. \nCurrently i am implementing like this . \n// Connecting to Socket\n```\n    NSURL url=[NSURL URLWithString:@\"https://app.demo.io\"];\n    socket = [[SocketIOClient alloc] initWithSocketURL:url config:@{@\"log\": @YES}];  // In oder to check the log\n    NSLog(@\"The socket url is %@\", url);\n    [socket on:@\"connect\" callback:^(NSArray data, SocketAckEmitter *ack) {\n        NSLog(@\"socket connected \");\n```\n// Joining namespace after socket connection .\n```\n        NSString *nameSpaceStr = [NSString stringWithFormat:@\"/rt.demo.io/device\"];\n        [socket joinNamespace:nameSpaceStr];\n```\n// Get User Login Token from Login API\n```\n    NSString *savedValue = [[NSUserDefaults standardUserDefaults]\n                            stringForKey:@\"token\"];\n    NSLog(@\"The login token from user defaults  %@\", savedValue);\n\nNSMutableDictionary *message = [[NSMutableDictionary alloc] init];\n        [message setObject:savedValue forKey:@\"id\"];\n        [self.socket emit:@\"setDetails\" with:@[message]];\n        NSLog(@\"Emit message : sending login token to socket %@\",message);\n```\n// Listentng Socket Events\n```\n        [self.socket on:@\"getVideoCallStatus\" callback:^(NSArray * data , SocketAckEmitter  *ack) {\n             NSLog(@\"On message listening hearing from server  %@\", data);\n            NSLog(@\"On mesage ack is %@\", ack);\n    }];\n\n```\nIf u have worked on it. Could you help me out please . ! \n. Yes, Thanks for ur response . \nThe response i'am getting from Client \nThe socket url is https://app.myapp.io/rt.myapp.io/device\n2018-02-01 19:41:37.051878+0530 Demo[12012:602440] LOG SocketIOClient: Adding handler for event: connect\n4ED7B7EC-BCC8-4F75-B95F-0FFBA9FDC99B\n2018-02-01 19:41:37.052350+0530 Demo[12012:602440] LOG SocketIOClient: Adding handler for event: auth_success\n1E76E7E2-A202-429A-BC69-DE505D0CF9D3\n2018-02-01 19:41:37.052593+0530 Demo[12012:602440] LOG SocketIOClient: Adding handler for event: error\nD006FFBB-B228-4112-82C1-6980AA6529E9\n2018-02-01 19:41:37.052778+0530 Demo[12012:602440] LOG SocketIOClient: Adding handler for event: testing\n564D6156-18C4-4B1D-9201-B4EADD3FFF04\n2018-02-01 19:41:37.052933+0530 Demo[12012:602440] LOG SocketIOClient: Adding handler for event: testing\n54345998-EEA8-46C8-AE7A-11BDDF13B44D\n2018-02-01 19:41:37.593903+0530 Demo[12012:602440] LOG SocketIOClient: Adding engine\n2018-02-01 19:41:37.596417+0530 Demo[12012:602440] LOG SocketEngine: Starting engine. Server: https://app.myapp.io/rt.myapp.io/device\n2018-02-01 19:41:37.596631+0530 Demo[12012:602440] LOG SocketEngine: Handshaking\n2018-02-01 19:41:37.598085+0530 Demo[12012:602440] LOG SocketEnginePolling: Doing polling request\n2018-02-01 19:41:39.321129+0530 Demo[12012:602440] LOG SocketEnginePolling: Got polling response\n2018-02-01 19:41:39.325063+0530 Demo[12012:602517] LOG SocketEngine: Got message: 0{\"sid\":\"ERI4DzO5FOIKyt6ZAAAB\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2018-02-01 19:41:39.326886+0530 Demo[12012:602518] LOG SocketEngine: Writing poll:  has data: false\n2018-02-01 19:41:39.327063+0530 Demo[12012:602517] LOG SocketEnginePolling: Doing polling request\n2018-02-01 19:41:39.327154+0530 Demo[12012:602518] LOG SocketEnginePolling: Sending poll:  as type: 2\nParse engine opem\n2018-02-01 19:41:39.327513+0530 Demo[12012:602517] LOG SocketEngineClient: Connect\n2018-02-01 19:41:39.328427+0530 Demo[12012:602517] LOG SocketEngine: Got message: 40\n2018-02-01 19:41:39.328567+0530 Demo[12012:602518] LOG SocketEnginePolling: Created POST string: 1:2\n2018-02-01 19:41:39.329208+0530 Demo[12012:602517] LOG SocketIOClient: Should parse message: 0\n2018-02-01 19:41:39.329366+0530 Demo[12012:602518] LOG SocketEnginePolling: POSTing\n2018-02-01 19:41:39.329494+0530 Demo[12012:602517] LOG SocketParser: Parsing 0\n2018-02-01 19:41:39.329792+0530 Demo[12012:602518] LOG SocketEnginePolling: Doing polling request\n2018-02-01 19:41:39.330162+0530 Demo[12012:602517] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2018-02-01 19:41:39.330828+0530 Demo[12012:602517] LOG SocketIOClient: Socket connected\ndid connected called in swift code SocketIOClientStatus\n2018-02-01 19:41:39.331213+0530 Demo[12012:602517] LOG SocketIOClient: Handling event: connect with data: []\n2018-02-01 19:41:39.331841+0530 Demo[12012:602440] socket connected\n2018-02-01 19:41:39.332221+0530 Demo[12012:602440] The ack is \n2018-02-01 19:41:39.332835+0530 Demo[12012:602440] The data arry is (\n)\n2018-02-01 19:41:40.958111+0530 Demo[12012:602440] LOG SocketEnginePolling: Got polling response\n2018-02-01 19:41:40.958377+0530 Demo[12012:602440] LOG SocketEnginePolling: Doing polling request\n2018-02-01 19:41:40.958429+0530 Demo[12012:602518] LOG SocketEngine: Got message: 3\n2018-02-01 19:42:04.876226+0530 Demo[12012:602517] LOG SocketEngine: Writing poll:  has data: false\n2018-02-01 19:42:04.876575+0530 Demo[12012:602517] LOG SocketEnginePolling: Sending poll:  as type: 2\n2018-02-01 19:42:04.877047+0530 Demo[12012:602517] LOG SocketEnginePolling: Created POST string: 1:2\n2018-02-01 19:42:04.877331+0530 Demo[12012:602517] LOG SocketEnginePolling: POSTing\n2018-02-01 19:42:04.877498+0530 Demo[12012:602517] LOG SocketEnginePolling: Doing polling request\n2018-02-01 19:42:05.329398+0530 Demo[12012:602440] LOG SocketEnginePolling: Got polling response\n2018-02-01 19:42:05.329824+0530 Demo[12012:602440] LOG SocketEnginePolling: Doing polling request\n2018-02-01 19:42:05.329923+0530 Demo[12012:602747] LOG SocketEngine: Got message: 3\nThe response getting from server is . \nIn server, r\u00e9sponse is not getting  anything, instead the (android and web ppl are able to connect to socket remotely, the problem is with iOS client only )\nThank you \nSusheel Yadav . \n. @nuclearace, Any idea, why i am not able to connect ?  . I dn't think so. \nwill it may be any security reasons, that apple is blocking for IOS (Because socket is connecting properly for android and web ppl). Currently we are using nginx server, will that makes any difference connecting to server and not showing up any message.\nBy the way, when i disconnected the socket from IOS Client end, i am getting this console message . \nThe application did enter background called !!\n2018-02-08 12:35:50.406437+0530 Demo[33460:1367848] disconnect Socket called from socketmanager.m file\n2018-02-08 12:35:50.407220+0530 Demo[33460:1367848] LOG SocketIOClient: Closing socket\nSocket Disconnected from Server\n2018-02-08 12:35:50.407701+0530 Demo[33460:1367848] LOG SocketIOClient: Disconnected: Disconnect\nDIsconnecte\n2018-02-08 12:35:50.407871+0530 Demo[33460:1367848] LOG SocketEngine: Engine is being closed.\n2018-02-08 12:35:50.408042+0530 Demo[33460:1367848] LOG SocketEnginePolling: Created POST string: 1:1\n2018-02-08 12:35:50.408293+0530 Demo[33460:1367848] LOG SocketEnginePolling: Doing polling request\n2018-02-08 12:35:50.408687+0530 Demo[33460:1367848] LOG SocketIOClient: Handling event: disconnect with data: [\"Disconnect\"]\n2018-02-08 12:35:51.460100+0530 Demo[33460:1367848] LOG SocketEnginePolling: Got polling response\n2018-02-08 12:35:51.460964+0530 Demo[33460:1367908] LOG SocketEngine: Got message: 6\nWhile connecting to socket and disconnecting, i am able to get the response , but the server is not responding. Is there any thing else which we need to do apart from this to figure out the issue from where it is (Client or Server)? Can u suggest me the best possible way to sort it out .. ! \nThanks .\n. @nuclearace , waiting for ur reply . ! \nCould you help me out with this issue .\n. Yes .. i am sending exactly what API Needs .. . our socket connection is open for all, we are using namespace for emitting and receiving the event. \nlets say suppose this is my url to connect to socket . \n NSURL *url=[NSURL URLWithString:@\"https://app.mydemo.io/rt.mydemo.io/device\"];\nNow : my name space is rt.mydemo.io/device , from above url . \nCurrently we are doing like this .. \n NSURL url=[NSURL URLWithString:@\"https://app.mydemo.io/rt.mydemo.io/device\"];\nsocket = [[SocketIOClient alloc]initWithSocketURL:url config:@{@\"connectParams\":@{@\"type\":@\"user\"},@\"log\":@YES,@\"forcePolling\":@YES}];\n    NSLog(@\"The socket url is %@\", url);\n [socket on:@\"connect\" callback:^(NSArray data, SocketAckEmitter* ack) {\n        NSLog(@\"socket connected  \");\nCould you please share the updated answer like how to connect to socket through namespace .. \nThank you . \n. could you elaborate about the above process . I mean can u just explain with an example from above stated socket url of mine.. \nwhere i need to include @{@\"nsp\":@\"/device\"}? \n. yes could you explain though namespace once.. A small snippet like code to connect to socket through namespace .. . Okay. let me check once . \nThanks .. \n. Hey , we are able to connect to socket url without namespace . Is there any possibility to connect to socket url with namespace .. \nNote : namespace is mandatory for our socket connection. \nwaiting for ur reply . . @nuclearace, could you say me how to emit the message from namespace object . \nCurrently i am doing like this \n\nInitially i am connecting to socket and then join with namespace (I am successfully connecting to socket)\nNext i need to emit the message. (i am unable to emit the message, i need to send the JWT Token to socket server with key as \"id\" )\n\n```\nNSURL *url=[NSURL URLWithString:@\"https://app.demo.io\"];\n    socket = [[SocketIOClient alloc] initWithSocketURL:url config:nil];\n    NSLog(@\"The socket url is %@\", url);\n[socket on:@\"connect\" callback:^(NSArray* data, SocketAckEmitter* ack) {\n    NSLog(@\"socket connected \");\n\n// Joining namespace after socket connection .\n        NSString *nameSpaceStr = [NSString stringWithFormat:@\"/rt.demo.io/client\"];\n        [socket joinNamespace:nameSpaceStr];\n// Emiting the message\n[self.socket emit:@\"giveDetails\" with:[list valueForKey:@\"id\"]];\ngiveDetails is the event name . \n```\nWaiting for your reply . \n. This is my Console message once i got connected to socket server . \n2018-05-30 12:12:15.629041+0530 DemoApp [8004:2903278] LOG SocketEngine: Got message: 40/soc/client,\n2018-05-30 12:12:15.629386+0530 DemoApp[8004:2903278] LOG SocketIOClient: Should parse message: 0/soc/client,\n2018-05-30 12:12:15.630121+0530 DemoApp[8004:2903278] LOG SocketEngine: Got message: 42/soc/client,[\"test_ack\",{\"message\":\"working\"}]\n2018-05-30 12:12:15.630564+0530 DemoApp [8004:2903278] LOG SocketIOClient: Should parse message: 2/soc/client,[\"test_ack\",{\"message\":\"working\"}]\n2018-05-30 12:12:15.630901+0530 DemoApp[8004:2902694] LOG SocketParser: Parsing 0/soc/client,\n2018-05-30 12:12:15.631281+0530 DemoApp[8004:2902694] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: -1; nsp: /soc/client}\n2018-05-30 12:12:15.631447+0530 DemoApp[8004:2902694] LOG SocketIOClient: Socket connected\ndid connected called in swift code SocketIOClientStatus\n2018-05-30 12:12:15.631795+0530 DemoApp[8004:2902694] LOG SocketIOClient: Handling event: connect with data: []\n2018-05-30 12:12:15.632159+0530 DemoApp[8004:2902532] LOG SocketIOClient: Joining namespace\n2018-05-30 12:12:15.632382+0530 DemoApp[8004:2902532] the event is happening\n2018-05-30 12:12:15.632527+0530 DemoApp [8004:2902532] The login token we are fetching in socketmanager.m file  eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJmY2E2NzFkYzMwYjI4YWNkODM1ZjU4NzViYjQ5ZGI5MCIsImlhdCI6MTUyNzYwMzUzNiwiZXhwIjoxNTI3Njg5OTM2fQ.sFg8xQBk2Gl2c2MMNBAoGWff02VBMDJzUHJ9axXyKSo\n2018-05-30 12:12:15.632897+0530 DemoApp[8004:2902532] The first emit dictionary is {\n    id = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCe9.eyJ1c5VySWQiriJmY2E2NzFkYzMwYjI4YWNkODM1ZjU4NzViYjQ5ZGI5MCIsImlhdCI6MTUyNzYwMzUzNiwiZXhwIjoxNTI3Njg5OTM2fQ.sFg8xQBk2Gl2c2MMNBAoGWff02VBMDJzUHJ9axXyKSo\";\n    \"user_agent\" = ios;\n}\nthe event message string  is  %@ setDetails\n2018-05-30 12:12:15.633468+0530 DemoApp[8004:2902694] LOG SocketParser: Parsing 2/soc/client,[\"test_ack\",{\"message\":\"working\"}]\n2018-05-30 12:12:15.650366+0530 DemoApp[8004:2902694] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [test_ack, {\n    message = working;\n}]; id: -1; placeholders: -1; nsp: /soc/client}\n2018-05-30 12:12:15.650797+0530 DemoApp[8004:2902694] LOG SocketIOClient: Handling event: test_ack with data: [{\n    message = working;\n}]\n2018-05-30 12:12:15.633699+0530 DemoApp[8004:2903278] LOG SocketEngine: Writing ws: 0/soc/client has data: false\n2018-05-30 12:12:15.651542+0530 DemoApp[8004:2903278] LOG SocketEngine: Sending ws: 0/soc/client as type: 4\n2018-05-30 12:12:15.634366+0530 DemoApp[8004:2903300] LOG SocketIOClient: Emitting: 2/soc/client,[\"setDetails\",{\"id\":\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJmY2E2NzFkYzMwYjI4YWNkODM1ZjU4NzViYjQ5ZGI5MCIsImlhdCI6MTUyNzYwMzUzNiwiZXhwIjoxNTI3Njg5OTM2fQ.sFg8xQBk2Gl2c2MMNBAoGWff02VBMDJzUHJ9axXyKSo\",\"user_agent\":\"ios\"}]\n2018-05-30 12:12:15.652910+0530 DemoApp[8004:2903300] LOG SocketEngine: Writing ws: 2/soc/client,[\"setDetails\",{\"id\":\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJmY2E2NzFkYzMwYjI4YWNkODM1ZjU4NzViYjQ5ZGI5MCIsImlhdCI6MTUyNzYwMzUzNiwiZXhwIjoxNTI3Njg5OTM2fQ.sFg8xQBk2Gl2c2MMNBAoGWff02VBMDJzUHJ9axXyKSo\",\"user_agent\":\"ios\"}] has data: false\n2018-05-30 12:12:15.666752+0530 DemoApp[8004:2903300] LOG SocketEngine: Sending ws: 2/soc/client,[\"setDetails\",{\"id\":\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJmY2E2NzFkYzMwYjI4YWNkODM1ZjU4NzViYjQ5ZGI5MCIsImlhdCI6MTUyNzYwMzUzNiwiZXhwIjoxNTI3Njg5OTM2fQ.sFg8xQBk2Gl2c2MMNBAoGWff02VBMDJzUHJ9axXyKSo\",\"user_agent\":\"ios\"}] as type: 4\n2018-05-30 12:12:15.938557+0530 DemoApp[8004:2902694] LOG SocketEngine: Got message: 40/soc/client,\n2018-05-30 12:12:15.939091+0530 DemoApp[8004:2902694] LOG SocketIOClient: Should parse message: 0/soc/client,\n2018-05-30 12:12:15.940284+0530 DemoApp[8004:2902694] LOG SocketEngine: Got message: 42/soc/client,[\"test_ack\",{\"message\":\"working\"}]\n2018-05-30 12:12:15.940367+0530 DemoApp[8004:2903300] LOG SocketParser: Parsing 0/soc/client,\n2018-05-30 12:12:15.940600+0530 DemoApp[8004:2902694] LOG SocketIOClient: Should parse message: 2/soc/client,[\"test_ack\",{\"message\":\"working\"}]\n2018-05-30 12:12:15.941015+0530 DemoApp[8004:2903300] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: -1; nsp: /soc/client}\n2018-05-30 12:12:15.941205+0530 DemoApp[8004:2903300] LOG SocketIOClient: Socket connected\ndid connected called in swift code SocketIOClientStatus\n2018-05-30 12:12:15.941560+0530 DemoApp[8004:2903300] LOG SocketIOClient: Handling event: connect with data: []\n2018-05-30 12:12:15.941893+0530 DemoApp[8004:2902532] LOG SocketIOClient: Joining namespace\n2018-05-30 12:12:15.942100+0530 DemoApp[8004:2902532] the event is happening\n2018-05-30 12:13:03.578815+0530 DemoApp[8004:2903300] LOG SocketEngine: Writing ws: 0/soc/client has data: false\n2018-05-30 12:13:03.580204+0530 DemoApp[8004:2903300] LOG SocketEngine: Sending ws: 0/soc/client as type: 4\n2018-05-30 12:13:03.579189+0530 DemoApp[8004:2903278] LOG SocketIOClient: Emitting: 2/soc/client,[\"setDetails\",{\"id\":\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJmY2E2NzFkYzMwYjI4YWNkODM1ZjU4NzViYjQ5ZGI5MCIsImlhdCI6MTUyNzYwMzUzNiwiZXhwIjoxNTI3Njg5OTM2fQ.sFg8xQBk2Gl2c2MMNBAoGWff02VBMDJzUHJ9axXyKSo\",\"user_agent\":\"ios\"}]\n2018-05-30 12:13:03.582248+0530 DemoApp[8004:2903278] LOG SocketEngine: Writing ws: 2/soc/client,[\"setDetails\",{\"id\":\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJmY2E2NzFkYzMwYjI4YWNkODM1ZjU4NzViYjQ5ZGI5MCIsImlhdCI6MTUyNzYwMzUzNiwiZXhwIjoxNTI3Njg5OTM2fQ.sFg8xQBk2Gl2c2MMNBAoGWff02VBMDJzUHJ9axXyKSo\",\"user_agent\":\"ios\"}] has data: false\n2018-05-30 12:13:03.582355+0530 DemoApp[8004:2903278] LOG SocketEngine: Sending ws: 2/soc/client,[\"setDetails\",{\"id\":\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJmY2E2NzFkYzMwYjI4YWNkODM1ZjU4NzViYjQ5ZGI5MCIsImlhdCI6MTUyNzYwMzUzNiwiZXhwIjoxNTI3Njg5OTM2fQ.sFg8xQBk2Gl2c2MMNBAoGWff02VBMDJzUHJ9axXyKSo\",\"user_agent\":\"ios\"}] as type: 4\n2018-05-30 12:13:04.422962+0530 DemoApp[8004:2902532] Right Camera Button Was Tapped!\n2018-05-30 12:13:04.423176+0530 DemoApp[8004:2902532] The Right emit method dict is {\n    data =     {\n        direction = 30;\n    };\n    \"receiver_hub_id\" = 866460030804222;\n}\n2018-05-30 12:13:08.255540+0530 DemoApp[8004:2904023] LOG SocketEngine: Writing ws:  has data: false\n2018-05-30 12:13:08.255867+0530 DemoApp[8004:2904023] LOG SocketEngine: Sending ws:  as type: 2\n2018-05-30 12:13:08.256397+0530 DemoApp[8004:2904023] LOG SocketEngine: Writing ws:  has data: false\n2018-05-30 12:13:08.260956+0530 DemoApp[8004:2904023] LOG SocketEngine: Sending ws:  as type: 2\n2018-05-30 12:13:08.761465+0530 DemoApp[8004:2902532] Right Camera Button Was Tapped!\n2018-05-30 12:13:08.761799+0530 DemoApp[8004:2902532] The Right emit method dict is {\n    data =     {\n        direction = 30;\n    };\n    \"receiver_hub_id\" = 866460030804222;\n}\n2018-05-30 12:13:09.339897+0530 DemoApp[8004:2903862] LOG SocketEngine: Got message: 3\n2018-05-30 12:13:09.363611+0530 DemoApp[8004:2902532] Right Camera Button Was Tapped!\n2018-05-30 12:13:09.364085+0530 DemoApp[8004:2902532] The Right emit method dict is {\n    data =     {\n        direction = 30;\n    };\n    \"receiver_hub_id\" = 866460030804222;\n}\n2018-05-30 12:13:09.386531+0530 DemoApp[8004:2903016] LOG SocketEngine: Got message: 40/soc/client,\n2018-05-30 12:13:09.386874+0530 DemoApp[8004:2903016] LOG SocketIOClient: Should parse message: 0/soc/client,\n2018-05-30 12:13:09.387172+0530 DemoApp[8004:2903016] LOG SocketEngine: Got message: 42/soc/client,[\"test_ack\",{\"message\":\"working\"}]\n2018-05-30 12:13:09.387413+0530 DemoApp[8004:2903016] LOG SocketIOClient: Should parse message: 2/soc/client,[\"test_ack\",{\"message\":\"working\"}]\n2018-05-30 12:13:09.394352+0530 DemoApp[8004:2902694] LOG SocketParser: Parsing 0/soc/client,\n2018-05-30 12:13:09.394875+0530 DemoApp[8004:2902694] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: -1; nsp: /soc/client}\n2018-05-30 12:13:09.402562+0530 DemoApp[8004:2902694] LOG SocketIOClient: Socket connected\ndid connected called in swift code SocketIOClientStatus\n2018-05-30 12:13:09.403066+0530 DemoApp[8004:2902694] LOG SocketIOClient: Handling event: connect with data: []\n2018-05-30 12:13:09.403775+0530 DemoApp[8004:2902532] LOG SocketIOClient: Joining namespace\n2018-05-30 12:13:09.404184+0530 DemoApp[8004:2902532] the event is happening\n2018-05-30 12:13:09.405104+0530 DemoApp[8004:2902532] The login token we are fetching in socketmanager.m file  eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJmY2E2NzFkYzMwYjI4YWNkODM1ZjU4NzViYjQ5ZGI5MCIsImlhdCI6MTUyNzYwMzUzNiwiZXhwIjoxNTI3Njg5OTM2fQ.sFg8xQBk2Gl2c2MMNBAoGWff02VBMDJzUHJ9axXyKSo\n2018-05-30 12:13:09.405778+0530 DemoApp[8004:2902532] The first emit dictionary is {\n    id = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJmY2E2NzFkYzMwYjI4YWNkODM1ZjU4NzViYjQ5ZGI5MCIsImlhdCI6MTUyNzYwMzUzNiwiZXhwIjoxNTI3Njg5OTM2fQ.sFg8xQBk2Gl2c2MMNBAoGWff02VBMDJzUHJ9axXyKSo\";\n    \"user_agent\" = ios;\n}\n2018-05-30 12:13:09.406308+0530 DemoApp[8004:2903300] LOG SocketEngine: Writing ws: 0/soc/client has data: false\nthe event string is sokjet emthod!!!!!!!!!    !!!! %@ setDetails\n2018-05-30 12:13:09.414241+0530 DemoApp[8004:2903300] LOG SocketEngine: Sending ws: 0/soc/client as type: 4\n2018-05-30 12:13:09.406531+0530 DemoApp[8004:2902694] LOG SocketParser: Parsing 2/soc/client,[\"test_ack\",{\"message\":\"working\"}]\n2018-05-30 12:13:09.415970+0530 DemoApp[8004:2902694] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [test_ack, {\n    message = working;\n}]; id: -1; placeholders: -1; nsp: /soc/client}\n2018-05-30 12:13:09.416375+0530 DemoApp[8004:2902694] LOG SocketIOClient: Handling event: test_ack with data: [{\n    message = working;\n}]\n2018-05-30 12:13:09.395192+0530 DemoApp[8004:2903016] LOG SocketEngine: Got message: 40/soc/client,\n2018-05-30 12:13:09.417683+0530 DemoApp[8004:2903016] LOG SocketIOClient: Should parse message: 0/soc/client,\n2018-05-30 12:13:09.426523+0530 DemoApp[8004:2902694] LOG SocketParser: Parsing 0/soc/client,\n2018-05-30 12:13:09.426727+0530 DemoApp[8004:2902694] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: -1; nsp: /soc/client}\n2018-05-30 12:13:09.426785+0530 DemoApp[8004:2902694] LOG SocketIOClient: Socket connected\ndid connected called in swift code SocketIOClientStatus\n2018-05-30 12:13:09.426905+0530 DemoApp[8004:2902694] LOG SocketIOClient: Handling event: connect with data: []\n2018-05-30 12:13:09.427424+0530 DemoApp[8004:2902532] LOG SocketIOClient: Joining namespace\nNote :  I am connecting to server and able to emit my first message (login token and ios object), but it keep on adding to server..\n2. up next i need to emit another message ( The Right emit method dict in my console method) . \nWaiting for your reply, \nBest Regards\nSusheel Yadav . \n. Could you explain me clearly how i need to call  the second emit method .Because initially i was calling the first emit method like this \n```\n-(void)emiitMethod {\nNSString *iosObject  = @\"ios\";\nNSString *savedLoginToken = [[NSUserDefaults standardUserDefaults]\n                        stringForKey:@\"token\"];\nNSMutableDictionary *dictionary = [[NSMutableDictionary alloc] init];\n[dictionary setObject: savedLoginToken forKey:@\"id\"];\n[dictionary setObject:iosObject forKey:@\"user_agent\"];\n[self.socket emit:@\"setDetails\" with:@[dictionary]];   // Here setDetails is my emit Messsage .\n\n```\nit was emitting properly,  and i can see the logs in sever side also. \nwhile emitting second message also ,i am doing the same . \n```\n- (IBAction)cameraRotationAction:(UIButton *)sender {\nNSString *rightDirection = @\"30\";\nNSDictionary *dirDic = @{\n                         @\"direction\":rightDirection\n                             };\nNSMutableDictionary *emit_message_dict = [[NSMutableDictionary alloc] init];\n[emit_message_dict setObject:self.hubIdString forKey:@\"receiver_hub_id\"];\n[emit_message_dict setObject:dirDic forKey:@\"data\"];\nNSLog(@\"The Right emit method dict is %@\", emit_message_dict);\n\n[self.socket emit:@\"clientCameraPanningEvents\" with:@[emit_message_dict]];    // Here  clientCameraPanningEvents is my second emit message\n\n}\n```\nBut unfortunately , this emit message was not working . Can u say me where exactly it went wrong . \nNote:  I am using correct emit message also ,  i have checked with backend team as well . \nThanks . \n. One more thing , while emitting my message (ie dictionary) for the first time , it keep on adding to the server , how to restrict that . . Could you please look into this file , i am sharing an attachement file, this is how i am calling socket methods in my view Controllers. \nSocketManager.h File.pdf\nThanks , \nWaiting for your response. \n. @nuclearace , Could you please look into this.It would be helpful to me . No, the second emit method is not calling, and i cannot see logs of my second emit method also . .  The method is calling i can see the emit log dictionary in my Xcode console . \nNote:  The second emit method itself not calling . \n[self.socket emit:@\"clientCameraPanningEvents\" with:@[emit_message_dict]];    // Here  clientCameraPanningEvents is my second emit message , it is not calling\nand i can see my previous first emit message logs in response  when i am calling my second emit message. \n. Here is my log when i am emitting second time . \nLeft cameraRotation button is clicked\n2018-06-01 19:58:32.234827+0530 DemoAPP [9889:3695697] The left emit method dict is {\n    data =     {\n        direction = \"-30\";\n    };\n    \"receiver_hub_id\" = 866460030804222;\n}\n2018-06-01 19:58:32.306922+0530 DemoAPP [9889:3695877] LOG SocketEngine: Got message: 40/soc/client,\n2018-06-01 19:58:32.307176+0530 DemoAPP[9889:3695877] LOG SocketIOClient: Should parse message: 0/soc/client,\n2018-06-01 19:58:32.307553+0530 DemoAPP[9889:3695877] LOG SocketEngine: Got message: 42/soc/client,[\"test_ack\",{\"message\":\"working\"}]\n2018-06-01 19:58:32.307606+0530 DemoAPP[9889:3695926] LOG SocketParser: Parsing 0/soc/client,\n2018-06-01 19:58:32.307671+0530 DemoAPP[9889:3695877] LOG SocketIOClient: Should parse message: 2/soc/client,[\"test_ack\",{\"message\":\"working\"}]\n2018-06-01 19:58:32.307780+0530 DemoAPP[9889:3695926] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: -1; nsp: /soc/client}\n2018-06-01 19:58:32.308105+0530 DemoAPP[9889:3695926] LOG SocketIOClient: Socket connected\ndid connected called in swift code SocketIOClientStatus\n2018-06-01 19:58:32.308261+0530 DemoAPP[9889:3695926] LOG SocketIOClient: Handling event: connect with data: []\n2018-06-01 19:58:32.308502+0530 DemoAPP[9889:3695697] LOG SocketIOClient: Joining namespace\n2018-06-01 19:58:32.308617+0530 DemoAPP[9889:3695697] LOG SocketIOClient: Adding handler for event: ttt\n24CE54A6-41FB-442F-88BD-9B31111BD167\n2018-06-01 19:58:32.308833+0530 DemoAPP[9889:3695697] LOG SocketIOClient: Adding handler for event: disconnect\n11FA1226-D1DA-4B1B-9D61-09DB47232385\n2018-06-01 19:58:32.309457+0530DemoAPP[9889:3695697] LOG SocketIOClient: Adding handler for event: reconnect\n495CA2BC-D964-494B-BFE9-41B1D22781E0\n2018-06-01 19:58:32.309658+0530 DemoAPP[9889:3695926] LOG SocketParser: Parsing 2/soc/client,[\"test_ack\",{\"message\":\"working\"}]\n2018-06-01 19:58:32.309909+0530 DemoAPP[9889:3695786] LOG SocketEngine: Writing ws: 0/soc/client has data: false\n2018-06-01 19:58:32.309966+0530  DemoAPP[9889:3695877] LOG SocketIOClient: Emitting: 2/sock/client,[\"setDetails\",{\"id\":\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJjZGQ0ZDQ5OGNlN2M5ZGE2NjBkZDFkNDMzN2JmODM1ZSIsImlhdCI6MTUyNzg2MzI2NSwiZXhwIjoxNTI3OTQ5NjY1fQ.ou0NMkekMfg_XB2hJAAr4xU_6JTu9NJCQgRYy5pxcf8\",\"user_agent\":\"ios\"}]\n2018-06-01 19:58:32.310284+0530  DemoAPP[9889:3695786] LOG SocketEngine: Sending ws: 0/soc/client as type: 4\n2018-06-01 19:58:32.310319+0530  DemoAPP[9889:3695926] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [test_ack, {\n    message = working;\n}]; id: -1; placeholders: -1; nsp: /soc/client}\n2018-06-01 19:58:32.310457+0530 WooHooDemo[9889:3695926] LOG SocketIOClient: Handling event: test_ack with data: [{\n    message = working;\n}]\nNot able to figure it out where it went wrong. \nNOTE :  Can u say me how to check the emit log error. \n. Yes , initially i was calling the socket connect method in ViewDidLoad it was connecting fine . From my point of view , the second emit method is not calling , i think it is overridding with my first emit method. \n@nuclearace , can u please look into this code snippet and let me know where it went wrong . \nCan u please, suggest me which code snippet is correct in order to connect to socket. \nScenario 1\n```\n    NSURL url=[NSURL URLWithString:@\"https://app.myapp.io\"];\n    socket = [[SocketIOClient alloc] initWithSocketURL:url config:@{@\"log\": @YES}];\n   [socket on:@\"connect\" callback:^(NSArray data, SocketAckEmitter *ack) {\n        [socket setForceNew:YES];\n// **     Joining namespace after socket connection ** .\n                NSString *nameSpaceStr = [NSString stringWithFormat:@\"/soc/client\"];\n                [socket joinNamespace:nameSpaceStr];\n}];\n[socket connect];\n[self emiitMethod];\n\n```\nWhen i am implementing the scenario 1 , it keep on emitting my first emit method continuously, and second emit method is not working . \nCurrently i am using your Swift SDK in my Objective - C Project . The process i did was i just drag and drop the socket files , it asked me for Bridging-Header as default so i created it .. Will it make any difference .  \nScenario 2: \n```\n  NSURL url = [[NSURL alloc] initWithString:@\"https://app.myapp.io\"];\n  self.manager = [[SocketManager alloc] initWithSocketURL:url config:@{@\"log\": @YES, @\"compress\": @YES}];\n    NSString nameSpaceStr = [NSString stringWithFormat:@\"/soc/client\"];\n    self.socClient = [[SocketIOClient alloc] initWithManager: self.manager nsp:nameSpaceStr];\n self.socClient = self.manager.defaultSocket;\n// Checking auth Status .\n    [self.socClient on:@\"auth_success\" callback:^(NSArray * data , SocketAckEmitter  *ack) {\n        NSLog(@\"Socket auth_success message data is %@\", data);\n    }];\n[self.socClient connect];\n[self socketSetUp];\n\n```\nWhile i am implementing the second scenario , my socket is not connecting to server . I have installed the SDK thru cocoa pods version ( pod 'Socket.IO-Client-Swift', '~> 13.2.0' )\nNote : 1. If you have any code snippet in order to connect to socket do share with me. I need it in objective - C . \nCan u elaborate me , when to emit my first method. \nPlease find the below attachment of my socket model class .\nSocketManager.h.File.pdf\nI Would be waiting for your reply . . ",
    "usrpark": "thank you!. ",
    "headlessme": "The extraHeaders dictionary seems to be immutable (although I pass a mutable dictionary in the SocketManager options), and the property is readonly so I can't assign a new value directly. I've tried replacing the dictionary and modifying it in place:\nstreamSocketMgr.engine.extraHeaders = @{ @\"myHeader\": @\"thing\" } // assignment to readonly property\nor\n[streamSocketMgr.engine.extraHeaders setObject:@\"thing\" forKey:@\"myHeader\"]; // selector not found. Also seeing this issue - version 13.1.1. @nuclearace thoughts on getting the above fix merged?. See comment on #1118 as I haven't been able to reproduce this.. Great! I've changed the base branch. Good idea \u2013 added!. Great! Thanks for the quick review turnaround \ud83d\udc4d . @nuclearace any idea when this release will happen? Don't want to rush you, but we're waiting on it to get a new SDK out of the door \ud83d\ude04 Thanks!\n. I can't recreate this - which library versions and under what conditions do you see this? The PR I created only passed through the wrapped version of the completion handler if it was not nil: https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-0a1f28547352834d5f60fc457346f374R334\n . Ok good to know - thanks @nuclearace. @vonox7 I'm sure a PR would be welcomed to resolve any areas you think need improvement before this feature gets released \u2013 GitHub is all about collaboration after all \ud83d\ude04 . How does that look?. Changing SocketEngine.swift around line 547 from\nif pongsMissed > pongsMissedMax {\n    client?.engineDidClose(reason: \"Ping timeout\")\n    return\n}\nto\nif pongsMissed > pongsMissedMax {\n    closeOutEngine(reason: \"Ping timeout\")\n    return\n}\nseems to help, at least for disconnects caused by ping timeouts. I'm not sure what the other consequences of this might be, or whether other instances of client?.engineDidClose should also be replaced...\n. @nuclearace any thoughts on this? I'm happy to put together a PR if this change looks sensible.. Fixed. Added a method for Swift. I also added the method signature to the SocketIOClientSpec, but not sure if that's needed?. Ah yea of course, added.. ",
    "GF106": "It worked\n_manager = [[SocketManager alloc] initWithSocketURL:url config@{@\"connectParams\":@{@\"token\": params}, @\"log\": @yES}];. Raw Message means not to use json, but just send a message.. I use it. \nMy code:\n[_socketClient emit@\"auth\" with: [NSArray array withObjects:MyArray. nil]];\nResult: \n157:42[\"auth\", {MyArray(json}]\nhow to specify your number, not 157:42?\nMy server does not understand me.. Yes my server actual socket.io. \nOn Windows OS, I use a library for Visual Studio. With it, I'll post clean messages socket.send(\"421[\"auth\"{\"username\" : MyName}]\") without using the json conversion.\nis it possible to send in the same way?. Well thank you. But can I epigonomize this meaning 157:42?\ninsert my value. ",
    "mugx": "@nuclearace the minimum should be iOS9. ",
    "honchy": "I come into the same problem.. ",
    "ravichaudhary10": "I am facing the same problem. \nUsing -\nXcode 9.3 on MacOS 10.13.5.\nSocket.IO-Client-Swift 13.2.0\nSwift language version 4.1\nHave you come up with any solution so far?. ",
    "canaksoy": "same problem. `class SocketIOManager: NSObject {\nstatic let sharedInstance = SocketIOManager()\n\nvar manager : SocketManager!\nvar socket: SocketIOClient!\n\nprivate override init() {\n\n    super.init()\n}\n\nfunc establishConnection() {\n    socket.connect()\n}\n\nfunc closeConnection() {\n    socket.disconnect()\n}\n\nfunc createManager() {\n    manager = SocketManager(socketURL: AppCache.shared.socketUrl, config: [.log(true), .forceNew(true), .compress, .connectParams([\n        \"token\" : AppCache.shared.token,\n        \"conversation_id\": AppCache.shared.convID\n        ]) ])\n    socket = manager.socket(forNamespace: \"/chat\")\n}\n\nfunc releaseManager() {\n    manager = nil\n    socket = nil\n}\n\n}`\nusing manager like this. solved my same problem. ",
    "vielucasluu": "same problem. ",
    "bennyban": "Objective-C \nNSURL url = [[NSURL alloc] initWithString:@\"http://aworld.cn\"];\n    NSDictionary config = @{\n                             @\"log\":@YES,\n                             @\"forcePolling\":@YES,\n                             @\"forceNew\":@YES\n                             };\n    SocketManager manager = [[SocketManager alloc] initWithSocketURL:url config:config];\n    SocketIOClient nspSocket =[manager socketForNamespace:@\"/chatroom\"];\n[nspSocket on:@\"connect\" callback:^(NSArray data, SocketAckEmitter ack) {\n        NSLog(@\"socket connected\");\n    }];\n    [nspSocket connect];\nAs above\uff0csocket not connect success\uff0chow to  solve this problem\uff1f\nthank you\n. @nuclearace . @nuclearace . 2017-11-19 23:23:45.438485+0800 auction[31586:1307196] LOG SocketIOClient{/chatroom}: Joining namespace /chatroom\n2017-11-19 23:23:45.438745+0800 auction[31586:1307196] LOG SocketIOClient{/chatroom}: Adding handler for event: connect\n2017-11-19 23:23:47.049500+0800 auction[31586:1307196] LOG SocketIOClient{/chatroom}: Handling event: statusChange with data: [connecting]\n2017-11-19 23:23:47.049696+0800 auction[31586:1307196] LOG SocketManager: Tried connecting socket when engine isn't open. Connecting\n2017-11-19 23:23:47.049807+0800 auction[31586:1307196] LOG SocketManager: Adding engine\n2017-11-19 23:23:47.052558+0800 auction[31586:1307196] LOG SocketManager: Manager is being released\n2017-11-19 23:23:47.052662+0800 auction[31586:1308204] LOG SocketEngine: Starting engine. Server: http://aworld.cn\n2017-11-19 23:23:47.052810+0800 auction[31586:1308204] LOG SocketEngine: Handshaking\n2017-11-19 23:23:47.054072+0800 auction[31586:1308204] LOG SocketEnginePolling: Doing polling GET http://aworld.cn/socket.io/?transport=polling&b64=1\n2017-11-19 23:23:47.139450+0800 auction[31586:1308204] LOG SocketEnginePolling: Got polling response\n2017-11-19 23:23:47.142175+0800 auction[31586:1308204] LOG SocketEnginePolling: Got poll message: 97:0{\"sid\":\"jga86ZbRXkZ_024QAAAO\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2017-11-19 23:23:47.150247+0800 auction[31586:1308204] LOG SocketEngine: Got message: 0{\"sid\":\"jga86ZbRXkZ_024QAAAO\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2017-11-19 23:23:47.155142+0800 auction[31586:1308204] LOG SocketEngine: Writing poll:  has data: false\n2017-11-19 23:23:47.155431+0800 auction[31586:1308204] LOG SocketEnginePolling: Sending poll:  as type: 2\n2017-11-19 23:23:47.156711+0800 auction[31586:1308204] LOG SocketEnginePolling: Created POST string: 1:2\n2017-11-19 23:23:47.157165+0800 auction[31586:1308204] LOG SocketEnginePolling: POSTing\n2017-11-19 23:23:47.157315+0800 auction[31586:1308204] LOG SocketEngine: Engine is being released\nthis is console output. ",
    "jettangs": "I knew it\n```swift\nlet manager = SocketManager(socketURL: URL(string: \"http://localhost:17111?abc=123\")!,config: [.log(false), .compress, .connectParams([\"token\":\"abc\"])])\nlet socket = manager.defaultSocket\n```. ",
    "priyankakanojia36": "changing swift version doesnt help. still stuck\n. need some other solution. ",
    "tobitech": "Please what's the fix for this. I'm using it in an Objective-C project?. ",
    "YugoCode": "@nuclearace Any idea?. @nuclearace I was not sure, if I'm blocking handleQueue in some way, so I created a new project/repo:\nhttps://github.com/YugoCode/SocketIO_Swift/tree/master/Sources/Test\nHere I'm only trying to connect to the server and again the connection handler won't be called. \nDo you see any problems in my code? Could you maybe test, if it connects to a socketio server of yours?\n\nI tried v13.0.1 and v12.1.3. I know the server works, because connecting with JavaScript on the same machine is working. So the problem is my code?. ",
    "kajz3reczka": "@nuclearace CFRunLoopRun work but when I call CFRunLoopRun after connect to socket (all in viewDidLoad) view controller doesn't show :( Any idea?. @nuclearace so is any way to have 100% working socket connection without CFRunLoopRun? ofc in iOS app\n. ",
    "muslimrao": "Having the same issue... Any solution for this?.. I also tried CFRunLoopRun but after the viewController not worked.. @nuclearace\n@kajz3reczka\nI figure out the solution. It worked for me.. Just declare a variable in global. \nlet manager = SocketManager(socketURL: URL(string: \"ws://127.0.0.1:3001\")!, config: [.log(true)])\n\n. ",
    "tjwio": "Ahh okay cool, you don't happen to know how to force carthage to build with bitcode enabled by any chance?\nThanks!. ",
    "c4mmcnamara": "For the debug configuration you may want to consider setting BITCODE_GENERATION_MODE to marker instead of bitcode.   Some reference: https://medium.com/@heitorburger/static-libraries-frameworks-and-bitcode-6d8f784478a9. ",
    "klaus01": "The problem is that the Starscream library does not specify SWIFT_VERSION. @daltoniam\nYou can manually specify SWIFT_VERSION for the Starscream library.\n\n. ",
    "SadekSyed": "Thanks Erik\nI'm no Swift expert by any means(I actually just started with it), but I got a build error on line 139 of SocketEngine.swift and on a limb changed it from\nprivate var security: SocketIO.SSLSecurity?\nto \nprivate var security: SSLSecurity?\nAfter that it ran without error and your code solved my initial problem.\nTill next time. ",
    "amir-272015": "Same issue I'm having with 13.1.1\nAny solution?. ",
    "NIKMC": "Same issue I have too with 13.1.0. ",
    "Davidpacheco1": "Can you explain a little more? @nuclearace . Got it, tks. @nuclearace . ",
    "zzyspace": "Solved. Using sudo xcode-select -switch /Applications/Xcode_9.app if you have multiple Xcode.. ",
    "EdwinXiang": "print this logs\uff1a\n2017-11-30 17:49:41.308896 LOBO[3272:998436] LOG SocketIOClient{/}: Adding handler for event: connect\n2017-11-30 17:49:41.309297 LOBO[3272:998436] LOG SocketIOClient{/}: Handling event: statusChange with data: [connecting]\n2017-11-30 17:49:41.309505 LOBO[3272:998436] LOG SocketManager: Tried connecting socket when engine isn't open. Connecting\n2017-11-30 17:49:41.309595 LOBO[3272:998436] LOG SocketManager: Adding engine\n2017-11-30 17:49:41.310443 LOBO[3272:998436] LOG SocketManager: Manager is being released\n2017-11-30 17:49:41.310599 LOBO[3272:998489] LOG SocketEngine: Starting engine. Server: http://192.168.10.2:9094\n2017-11-30 17:49:41.310693 LOBO[3272:998489] LOG SocketEngine: Handshaking\n2017-11-30 17:49:41.338752 LOBO[3272:998505] LOG SocketEngine: Engine is being released. oh, it so bad! let me think how to Explain to you.\nit means that i connect my server,it works! We made a heartbeat connection with the server\u3002However, sometimes the server returns a busy error result\u3002we don't know how to solve it? Do you understand? Is there any good proposal? thank you very much!. ",
    "psykotox": "Hello,\nI have the same problem on my Mac with the SocketIOPing of vincedev and the latest socket.io server v2.0.4 (nodejs 9.3.0).\nIf I increase the timeout the problem doesn't disappear, it happens less often but he's still here.\nThe ping frequency is not respected and this is critical for the stability of the connection.\nIncreasing the timeout to a higher value only hides the problem.\nHow are you trying to replicate the problem ? With which version of each component ? It's really weird, several people I work with have tested on different Macs and they all have the problem.... ",
    "haemi": "I understand your point but it seems as if something's changed in the library as this flow/use case is no problem with e.g. 8.3.1. ",
    "intoxicated": "@nuclearace dose it suppose to be handled in handleQueue?  Supposedly, a class name WSocket (has socket: SOcketIOClient property) has join() or leave() method that invokes socket.emit method. These join and leave method has to be called in handleQueue? . I see! I will sync all client actions into the queue and see how it goes. Thanks. ",
    "schm03": "All updated, thank you.\nFollowed installation instructions.  No little red warnings in project as of this writing.\nIs this the place to ask the questions?. I'm a bit confused, incidentally, because I still see references to \"Starscream\" in the SocketIO files I've just downloaded, and I thought I read somewhere that such references have been deprecated.\nI changed one of those to \"Import SocketIO\" but still get the same error.\n?!?. > You should read up on how to use the SPM.\n\nhttps://github.com/nuclearace/SwiftBot/blob/master/Package.swift is a\npretty simple example of how to use it.\n--\nYou are receiving this because you authored the thread.\nReply to this email directly or view it on GitHub:\nhttps://github.com/socketio/socket.io-client-swift/issues/905#issuecomment-352025309\n\nI appreciate your attempts to help your users, and I see that you must\nhave a pretty busy schedule doing so.\nUnfortunately, I cannot find enough information to assist someone who is a\nprofessional developer but has little or no XCode and no Swift experience.\nIt all gets down to time. I have about 5 hours into this and nothing to\nshow for it.  I don't know how the open source community can thrive doing\nthings this way, but it seems to.  It certainly weeds out people who have\nother responsibilities and cannot make unlimited time investments in a\nhurry.\nThank you again.\n. ",
    "cdn34": "I believe so\n\nIs there anywhere else I need to change it ?. Got it working, thanks for the help. Didn't set it for the library itself.\n\n. ",
    "MiladFaridnia": "Could you please add it again (manually install support) to your library.. ",
    "MincDev": "I really wish manual install could be added again. I have been struggling for the last 4 hours trying to get the package manager working.. ",
    "hariios123": "\nplease give solution for this.no module starscream\ni added pod file after that also it showing this error\n. ",
    "phoikoi": "For anyone else that runs into this problem, one more thing to check is that your Podfile references the same iOS version as your project settings, e.g. platform :ios, '11.3'.  This seemed to be the thing that was causing this problem for me.. ",
    "machive": "So, now I am fighting this issue in the PusherSwift library. I updated the release number to 11.3 and did a pod update but it does not seem to make a difference. \nAny ideas?. ",
    "huongnguyen166": "Delete Pods folder and run pod install again works for me. ",
    "maintainer": "For others who will land on this page after googling this error.\nCheck that you have correct swift version on the first line of your Package.swift\nLike this:\n// swift-tools-version:4.0. ",
    "shrawan2015": "For me: \n\"swift package tools-version --set-current\" command solved above issue. \nAnd then run \"swift package fetch\" to fetch data. ",
    "milotolboom": "I have tried cleaning Carthage caches by using rm -rf ~/Library/Caches/org.carthage.CarthageKit and deleting the Carthage build folder.\nI built the framework using carthage update --no-use-binaries --platform iOS.\nThe problem still occurs though. Changing to another package manager also isn't an option.. I have found that the project is unable to run if I remove the Carthage/Checkouts/Starscream/zlib folder. The Checkouts folder is not commited in my github repo and shouldn't be, the build folder is. I assume there is something wrong with Carthage building the frameworks?. ",
    "timofverberg": "I have the same problem after installing manually, and I have tried cleaning the project. Any ideas?. ",
    "odedsh": "@kinza88  @headlessme \nIn our code we listen to 'reconnectAttempt' event and based on the number of failed attempts we \n    [_manager disconnect];\n    [_manager didDisconnectWithReason:@\"Reconnect Failed\"];\n.\n",
    "nickngsr": "I'm seeing the same thing, posted my log in here #1016 just gets stuck in a reconnect loop from then on, this is not the behaviour in v12, that works fine. With v13 if I issue a disconnect on the socket within the reconnect attempt event handler it will connect on the next reconnect attempt. So this is inline with the above fix, it seems like the flag is not reset and therefore it will not try and connect.. I have the same issue.\nIf I listen to the 'reconnectAttempt' event, which is still fired as expected, and in that I call disconnect on the SocketManager, the reconnect attempt will work. This doesn't seem to fire the 'disconnect' event.\nIt may be worth noting that the socket in question is on a non-root namespace. ```\n2018-06-18 18:29:05.424781+0100 four[2661:2628085] LOG SocketManager: Starting reconnect\n2018-06-18 18:29:05.425002+0100 four[2661:2628085] LOG SocketIOClient{/ipad}: Handling event: statusChange with data: [connecting]\n2018-06-18 18:29:05.425093+0100 four[2661:2628085] LOG SocketIOClient{/ipad}: Handling event: reconnect with data: [\"Socket Disconnected\"]\nReconnect\n2018-06-18 18:29:05.425401+0100 four[2661:2628085] LOG SocketManager: Trying to reconnect\n2018-06-18 18:29:05.425491+0100 four[2661:2628085] LOG SocketIOClient{/ipad}: Handling event: reconnectAttempt with data: [-1]\nReconnect Attempt\n2018-06-18 18:29:05.437001+0100 four[2661:2628085] LOG SocketManager: Adding engine\n2018-06-18 18:29:05.437254+0100 four[2661:2628112] LOG SocketEngine: Engine is being released\n2018-06-18 18:29:05.437425+0100 four[2661:2628251] LOG SocketEngine: Starting engine. Server: https://xxxx\n2018-06-18 18:29:05.437449+0100 four[2661:2628251] LOG SocketEngine: Handshaking\n2018-06-18 18:29:05.437613+0100 four[2661:2628251] LOG SocketEnginePolling: Doing polling GET https://xxxx/socket.io/?transport=polling&b64=1\n2018-06-18 18:29:05.438333+0100 four[2661:2628123] TIC Read Status [1:0x0]: 1:57\n2018-06-18 18:29:05.438352+0100 four[2661:2628123] TIC Read Status [1:0x0]: 1:57\n2018-06-18 18:29:05.561286+0100 four[2661:2628112] LOG SocketEnginePolling: Got polling response\n2018-06-18 18:29:05.561445+0100 four[2661:2628112] LOG SocketEnginePolling: Got poll message: \n502 Bad Gateway\n\n502 Bad Gateway\nnginx\n\n\n2018-06-18 18:29:05.561648+0100 four[2661:2628112] LOG SocketEngine: Got message: \n502 Bad Gateway\n\n502 Bad Gateway\nnginx\n\n\n2018-06-18 18:29:05.562229+0100 four[2661:2628085] ERROR SocketManager: Got unknown error from server \n502 Bad Gateway\n\n502 Bad Gateway\nnginx\n\n\n2018-06-18 18:29:05.562381+0100 four[2661:2628085] LOG SocketIOClient{/ipad}: Handling event: error with data: [\"Got unknown error from server \\r\\n502 Bad Gateway\\r\\n\\r\\n502 Bad Gateway\\r\\nnginx\\r\\n\\r\\n\\r\\n\"]\n2018-06-18 18:29:08.630287+0100 four[2661:2628085] LOG SocketManager: Trying to reconnect\n2018-06-18 18:29:08.630664+0100 four[2661:2628085] LOG SocketIOClient{/ipad}: Handling event: reconnectAttempt with data: [-2]\nReconnect Attempt\n2018-06-18 18:29:08.631158+0100 four[2661:2628085] LOG SocketManager: Tried connecting an already active socket\n2018-06-18 18:29:11.930020+0100 four[2661:2628085] LOG SocketManager: Trying to reconnect\n2018-06-18 18:29:11.930204+0100 four[2661:2628085] LOG SocketIOClient{/ipad}: Handling event: reconnectAttempt with data: [-3]\nReconnect Attempt\n````\nThe socket manager is a property of a singleton class that is never disposed of. Yeah I got it to work doing the same thing, #909 has a proposed fix that seems to make sense . ",
    "sandeepsipl": "Yes, As soon as the notification received on the iPhone, I want the status \"Delivered\" even if the application is not running in the background. I know its possible because Whatsapp doing it.\nis it possible using this library? . ",
    "faizantariq1": "@sandeepsipl  did you done that thing???.... ",
    "archerhan": "Oh dude, this saved me!. ",
    "NikhilPrajapat1994": "thanks.\ncalling CFRunLoopRun() after \n socket.connect() works for me. ",
    "evagnostic": "I have been stuck on the same issue for over 2 days. Please help! I am using version 13.1.0.\nCalling CFRunLoopRun() afterwards causes my socket to remain \"connecting\" status. Any idea?\nSocketService: onAny  SocketAnyEvent: Event: statusChange items: Optional([connecting])\n2017-12-20 23:23:10.546157-0800 SwiftApp[31101:16036715] LOG SocketIOClient{/}: Joining namespace /\n2017-12-20 23:23:10.546630-0800 SwiftApp[31101:16036715] LOG SocketManager: Tried connecting socket when engine isn't open. Connecting\n2017-12-20 23:23:10.546721-0800 SwiftApp[31101:16036715] LOG SocketManager: Adding engine\n2017-12-20 23:23:10.547260-0800 SwiftApp[31101:16037019] LOG SocketEngine: Starting engine. Server: https://staging.myapp.com/\n2017-12-20 23:23:10.547533-0800 SwiftApp[31101:16037019] LOG SocketEngine: Handshaking\n2017-12-20 23:23:10.547899-0800 SwiftApp[31101:16037019] LOG SocketEnginePolling: Doing polling GET https://staging.myapp.com/socket.io/?transport=polling&b64=1\n2017-12-20 23:23:10.894291-0800 SwiftApp[31101:16037019] LOG SocketEnginePolling: Got polling response\n2017-12-20 23:23:10.894458-0800 SwiftApp[31101:16037019] LOG SocketEnginePolling: Got poll message: 97:0{\"sid\":\"JHyZl39a_r-GMG9LAAF9\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2017-12-20 23:23:10.894776-0800 SwiftApp[31101:16037019] LOG SocketEngine: Got message: 0{\"sid\":\"JHyZl39a_r-GMG9LAAF9\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2017-12-20 23:23:10.895313-0800 SwiftApp[31101:16037019] LOG SocketEnginePolling: Doing polling GET https://staging.myapp.com/socket.io/?transport=polling&b64=1&sid=JHyZl39a_r-GMG9LAAF9\n2017-12-20 23:23:10.895546-0800 SwiftApp[31101:16037019] LOG SocketEngine: Writing poll:  has data: false\n2017-12-20 23:23:10.895680-0800 SwiftApp[31101:16037019] LOG SocketEnginePolling: Sending poll:  as type: 2\n2017-12-20 23:23:10.895877-0800 SwiftApp[31101:16037019] LOG SocketEnginePolling: Created POST string: 1:2\n2017-12-20 23:23:10.896312-0800 SwiftApp[31101:16037019] LOG SocketEnginePolling: POSTing\n2017-12-20 23:23:10.896618-0800 SwiftApp[31101:16037019] LOG SocketEnginePolling: Doing polling POST https://staging.myapp.com/socket.io/?transport=polling&b64=1&sid=JHyZl39a_r-GMG9LAAF9\n2017-12-20 23:23:10.974104-0800 SwiftApp[31101:16037639] LOG SocketEnginePolling: Got polling response\n2017-12-20 23:23:10.974250-0800 SwiftApp[31101:16037639] LOG SocketEnginePolling: Got poll message: 2:40\n2017-12-20 23:23:10.974377-0800 SwiftApp[31101:16037639] LOG SocketEngine: Got message: 40\n2017-12-20 23:23:10.974614-0800 SwiftApp[31101:16037639] LOG SocketEnginePolling: Doing polling GET https://staging.myapp.com/socket.io/?transport=polling&b64=1&sid=JHyZl39a_r-GMG9LAAF9\n2017-12-20 23:23:11.156850-0800 SwiftApp[31101:16037021] LOG SocketEnginePolling: Got polling response\n2017-12-20 23:23:11.157009-0800 SwiftApp[31101:16037021] LOG SocketEnginePolling: Got poll message: 1:3\n2017-12-20 23:23:11.157272-0800 SwiftApp[31101:16037021] LOG SocketEngine: Got message: 3\n2017-12-20 23:23:11.157484-0800 SwiftApp[31101:16037021] LOG SocketEnginePolling: Doing polling GET https://staging.myapp.com/socket.io/?transport=polling&b64=1&sid=JHyZl39a_r-GMG9LAAF9\nIf I dont call CFRunLoopRun(), everything looks normal except the fact that only events called are ping and pong. I am expecting other handlers to be triggered but nothing happens.\nSocketService: onAny  SocketAnyEvent: Event: statusChange items: Optional([connecting])\nSocketService: onAny  SocketAnyEvent: Event: ping items: Optional([])\nSocketService: onAny  SocketAnyEvent: Event: statusChange items: Optional([connected])\nSocketService: onAny  SocketAnyEvent: Event: connect items: Optional([\"/\"])\nSocketService: socket connected\nSocketService: onAny  SocketAnyEvent: Event: pong items: Optional([])\nSocketService: onAny  2017-12-20 23:29:34.239664-0800 SwiftKara[31275:16044001] LOG SocketEngine: Writing poll:  has data: false\nSocketService: onAny  SocketAnyEvent: Event: pong items: Optional([])\nSocketService: onAny  2017-12-20 23:29:59.932172-0800 SwiftKara[31275:16043761] LOG SocketEngine: Writing poll:  has data: false\nSocketService: onAny  SocketAnyEvent: Event: pong items: Optional([])\nSocketService: onAny  SocketAnyEvent: Event: ping items: Optional([])\nSocketService: onAny  SocketAnyEvent: Event: pong items: Optional([])\nSocketService: onAny  SocketAnyEvent: Event: ping items: Optional([])\nSocketService: onAny  SocketAnyEvent: Event: pong items: Optional([])\nSocketService: onAny  SocketAnyEvent: Event: ping items: Optional([])\nSocketService: onAny  SocketAnyEvent: Event: pong items: Optional([])\nSocketService: onAny  SocketAnyEvent: Event: ping items: Optional([])\nSocketService: onAny  SocketAnyEvent: Event: pong items: Optional([])\nSocketService: onAny  SocketAnyEvent: Event: ping items: Optional([])\nSocketService: onAny  SocketAnyEvent: Event: pong items: Optional([]) . Thanks! This code below worked for me. \nmanager.setConfigs([.reconnects(false)])\nsocket.disconnect()\nmanager.removeSocket(socket)\nmanager = nil\nsocket = nil. ",
    "varkrishna": "but unable to update UserInterface, after adding  \" CFRunLoopRun() \" `\nimport UIKit\nimport SocketIO\nclass ViewController: UIViewController {\noverride func viewDidLoad() {\n    super.viewDidLoad()\n    print(\"view loaded\")\n    self.connect()\n\n    // Do any additional setup after loading the view, typically from a nib.\n}\n\noverride func didReceiveMemoryWarning() {\n    super.didReceiveMemoryWarning()\n    // Dispose of any resources that can be recreated.\n}\n\nfunc connect(){\n        let man = SocketManager(socketURL: URL(string: \"http://localhost:3000\")!)\n        let cl : SocketIOClient = man.defaultSocket\n        cl.on(\"hello\") { (d, e) in\n            print(\"someoxne Said \\(d)\")\n        }\n        cl.on(\"connect\") { (d, e) in\n            print(\"socket connected \\(d)\")\n            cl.emit(\"chat message\", with: [\"from IOS\"])\n\n            let btn = UIButton(frame: CGRect(x: 0, y: 0, width: 200, height: 200))\n            btn.setTitle(\"send\", for: .normal)\n            btn.backgroundColor = UIColor.red\n            print(\"btn created \\(btn)\")\n            DispatchQueue.main.async {\n                self.view.addSubview(btn)\n            }\n            //CFRunLoopStop(CFRunLoopGetCurrent())\n        }\n        cl.connect()\n        CFRunLoopRun()\n    return\n}\n\n}\n`\n. ",
    "bhautikmobileappdev": "@nuclearace \npod 'Socket.IO-Client-Swift', '10.0.1'. ",
    "Dumk0": "Don't you think reason can be in \nself.manager.reconnect() in self.socket.on(\"disconnect\")\naccording to docs\n\nreconnect()\nTries to reconnect to the server.\nThis will cause a disconnect event to be emitted, as well as an reconnectAttempt event.\n\nso in theory you are causing endless loop on first disconnect. ",
    "ryan2x": "I bumped into this issue, and it turns out that migration from 12.x to 13.x you need to keep let socketManager = SocketManager(socketURL: someURL) in your class level (not a temporary variable). in 12.x, you keep SocketIOClient (aka, socket). Gee, can somebody make it more obvious when making this change. This is the place that I found out this change: https://github.com/socketio/socket.io-client-swift/blob/master/Usage%20Docs/12to13.md. ",
    "Brances": "hello,in OC ,When the network is unconnected\uff0cI take the initiative to call  [socket disconnect];But the log has been printed on the console,I don't understand.\nThe logs:\n2018-05-18 17:00:33.483088+0800 Delivery[1030:258011] LOG SocketEngine: Writing ws:  has data: false\n2018-05-18 17:00:33.484839+0800 Delivery[1030:258011] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2018-05-18 17:00:33.486843+0800 Delivery[1030:253545] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-05-18 17:00:33.539325+0800 Delivery[1030:258012] LOG SocketEngine: Got message: 3\n2018-05-18 17:00:33.541451+0800 Delivery[1030:253545] LOG SocketIOClient{/}: Handling event: pong with data: []\n. ",
    "dgouyette": "I'm using  https://github.com/playframework/play-socket.io plugin in my server.\nNamespace sent to server should have   a suffix , (to  be consistent), like in \n``` \nprivate func createPacketString() -> String {\n        let typeString = String(type.rawValue)\n        // Binary count?\n        let binaryCountString = typeString + (type == .binaryEvent || type == .binaryAck ? \"(String(binary.count))-\" : \"\")\n        // Namespace?\n        let nspString = binaryCountString + (nsp != \"/\" ? \"(nsp),\" : \"\")\n        // Ack number?\n        let idString = nspString + (id != -1 ? String(id) : \"\")\n    return completeMessage(idString)\n}\n\n``` \nNo ?\n. Thanks. . ",
    "ConnectDevVS": "Im facing this issue on 'Socket.IO-Client-Swift', '~> 13.1.0' . did anyone have a solution for this?\n@bl82 : were you able to find a solutions for this\n. @bl82 : Thanks for the rely\nAlso, can you give me some more idea of what went wrong or what you guys did that gave rise to this issue. Im trying to figure what measure to resolve this and this info will be of great help. We are using a simple node server, and our android counter part were able to connect to it seamlessly.\nWhen \"forceNew\" parameter is given in the configuration, the iOS app was able to reconnect back after disconnection, without this parameter, when connection is lost, it just continue to reconnect without success.\n. ",
    "nguyentuananh56hust": "This issue is solved!\nJust set strong for manager.. ",
    "shanecowherd": "Agreed! I am not sure how to make the pull request require a new branch.  On my fork I put it in the branch 1.X/Swift4. Branch updated, ready to commit.. ",
    "vsergeev1988": "On the backend we have this: https://github.com/playframework/play-socket.io\nWe made some tests and was trying to connect to our backend using official JS client (https://github.com/socketio/socket.io-client) and it works ok with this server. The command, received on the backend from this JS client was \"0/testRoom1,\" - with the comma after namespace.. @nuclearace I have updated to the latest development branch and it works ok now on connect to namespace, but I still have the same error on disconnect.\n  . @nuclearace works great now, thank you!. ",
    "vkoptilov": "\nNOT SOLVED!!!!\n  . \nthis is my old code and early it works, but now i don't know how this should work^ please help. THX, for help! Problem solved, . ",
    "whereAreTheGuGuda": "It\u2018s working .  and  Just have a error in json, . ",
    "mouchegmouradian": "@nuclearace We are using 1.5.1. @nuclearace Any ideas ?\n(Sorry to bother you but I really need to sort this out). @nuclearace Okay that would explain it :)\nIt seems to work with 1.0-swift4 branch \nthanks. ",
    "kim68666343": "How can you sure that's the matter about encoding? @mouchegmouradian . ",
    "Huppys": "@mostafatabal How did you solve it?. ",
    "sairamgubba94": "https://stackoverflow.com/questions/48551895/tried-connecting-on-an-already-connected-socket-socket-io-client-swift\nCheck this out. ",
    "maksTheAwesome": "I wish I know. I've pulled back socket.io-client to the latest 12.1.3 version and it works fine for me now.. @pablogeek Actually I did not. I rolled socket.io-client back to 12.1.3 and the problem was gone. So I never returned to the issue.. ",
    "xRena": "@maksTheAwesome can you share your code how you implement client now? \n. @bharathreddy-97 can you share your implementation with version 12.1.3? I have this problem now . On iOS app 12.1.3 on server 2.1.0. No, I try to have stable connection only for now. I have prepared funcions to emit but now I don't use them. ",
    "jp1987": "Having the exact same issue, rolling back to 12.1.3. fixed it for me. I noticed that Starscream went from 3.0.5 to 2.1.1, so problem is probably on that side.. ",
    "kepterne": "Actually I have experienced the same error. \nWS server was under ssl terminating load balancer AND nginx proxy (don't ask me why). \nSo if request contains Host: :443, ssl termination fails it. \nWhen I changed\nlet hostValue = request.allHTTPHeaderFields?[headerWSHostName] ?? \"(url.host!):(port!)\"\nto\nlet hostValue = request.allHTTPHeaderFields?[headerWSHostName] ?? \"(url.host!)\"\nit started working.. ",
    "ligwang": "Hi, @maksTheAwesome\nI am facing on same issue. Now the socket version I am using is v13.2.1\nSo should I use v12.1.3? then this problem is solved?\n. ",
    "Ramzi-Alqrainy": "@nuclearace any luck here? we are stuck here. . ",
    "jbeoris": "I was having the same issue but was able to resolve it by creating strong immutable references to the manager and client objects within my service class. I would try replacing 'var' with 'let' for both values and then replacing the way you are currently setting the socket value with\nsocket = manager.socket(forNamespace: \"swift\")\n. ",
    "mrchriswindsor": "need to add this:\n    var socketManager:SocketManager!. ",
    "gaoguanghui": "Did you fixed it ?. ",
    "MarcoBrescianini": "Yes I'll try the latest development branch, and i'll let you know. Hi @nuclearace I've tried the latest commit on the development branch, and It worked. However, I get a runtime error whenever I try to emit another event from the same thread of execution of an ack callback. The execution flow is the following:\nSocketAckManager.executeAck -> Do something -> OnAckCallback.timingOutAfter -> Runtime error\nThis happens if client emits are performed on the main queue, and the SocketManager handle queue is not changed from the default one (main queue). Thread of execution doesn't leave the main queue, and you get a runtime exception because SocketAckManager struct is being mutated while it is already mutating.\nHowever, if you set SocketManager's handle queue to a background queue, this exception doesn't occur obviously. \nYou can get more insights from the log attached:\nSimultaneous accesses to 0x6040000feec8, but modification requires exclusive access.\nPrevious access (a modification) started at SocketIO`SocketIOClient.handleAck(_:data:) + 480 (0x107b95d90).\nCurrent access (a modification) started at:\n0    libswiftCore.dylib                 0x000000010e49cf00 swift_beginAccess + 505\n1    SocketIO                           0x0000000107b90580 SocketIOClient.ackHandlers.materializeForSet + 38\n2    SocketIO                           0x0000000107b693b0 OnAckCallback.timingOut(after:callback:) + 449\n3    SocketIO                           0x0000000107b69be0 @objc OnAckCallback.timingOut(after:callback:) + 124\n4    MyApp                              0x00000001086d6ca0 -[app method] + 426\n5    MyApp                              0x00000001086ef0d0 -[app method] + 578\n6    MyApp                              0x00000001086d17f0 -[app method] + 341\n7    MyApp                              0x0000000107aa6290 -[app method] + 722\n8    CoreFoundation                     0x000000010965f2e0 invoking + 140\n9    CoreFoundation                     0x000000010965f100 -[NSInvocation invoke] + 320\n10   MyApp                              0x0000000107b4f410 -[app method] + 617\n11   MyApp                              0x00000001086dca20 -[app method] + 142\n12   MyApp                              0x00000001086d2c20 -[app method] + 321\n13   MyApp                              0x00000001086d6830 38-[app method]_block_invoke + 345\n14   SocketIO                           0x0000000107b69c70 thunk for @callee_unowned @convention(block) (@unowned NSArray) -> () + 61\n15   SocketIO                           0x0000000107b6a790 partial apply for thunk for @callee_unowned @convention(block) (@unowned NSArray) -> () + 58\n16   SocketIO                           0x0000000107b6c350 SocketAckManager.executeAck(:with:) + 387\n17   SocketIO                           0x0000000107b95bb0 SocketIOClient.handleAck(:data:) + 513\n18   SocketIO                           0x0000000107b97090 SocketIOClient.handlePacket(:) + 833\n19   SocketIO                           0x0000000107bae180 SocketManager.parseEngineMessage(:) + 1507\n20   SocketIO                           0x0000000107badfb0 closure #1 in SocketManager.parseEngineMessage(:) + 71\n21   SocketIO                           0x0000000107bae060 partial apply for closure #1 in SocketManager.parseEngineMessage(:) + 100\n22   SocketIO                           0x0000000107b69ba0 thunk for @callee_owned () -> () + 41\n23   libdispatch.dylib                  0x000000010d79916b _dispatch_call_block_and_release + 12\n24   libdispatch.dylib                  0x000000010d79a1b2 _dispatch_client_callout + 8\n25   libdispatch.dylib                  0x000000010d7a3eb8 _dispatch_main_queue_callback_4CF + 1260\n26   CoreFoundation                     0x000000010969de30 CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE + 9\n27   CoreFoundation                     0x0000000109661b00 __CFRunLoopRun + 2402\n28   CoreFoundation                     0x00000001096616f0 CFRunLoopRunSpecific + 409\n29   GraphicsServices                   0x00000001119c7988 GSEventRunModal + 62\n30   UIKit                              0x000000010a26c537 UIApplicationMain + 159\n31   MyApp                              0x0000000107aa3610 main + 111\n32   libdyld.dylib                      0x000000010d80ed80 start + 1\nIn my humble opinion SocketAckManager should be modified to be a class, to avoid this exception. What do you think about it?\n. Nice! Thanks man, have a good day!. ",
    "kristoff-it": "Actually, data currently gets decoded as [Any], small inprecision on my part.. I see, I definitely don't know enough about how contents are framed to work on this. Maybe this feature should be kept in mind for when the project will undergo a big rewrite, as it seems to me that a cast to a struct is a fairly idiomatic use case for Swift.\n. ",
    "shravansukumar": "So, I should do something like this socket = manager.socket(forNamespace: \"/watch\")?. Thanks @nuclearace ! Did the trick for me!. Just to make things clear, you are asking me to add another parameter in config array, .handleQueue(someQueue) while I create my SocketClient, and while I'm using the socket, I'll be dispatching it in that queue right? \n. ",
    "BrenoVin": "I try some thing and this work for me\n\nI create a manager with my .extraHeaders\n\nmanager = SocketManager(socketURL: url, config: [.extraHeaders([\"Authorization\":\"token\"])])\n  socket = manager.defaultSocket\n- when I my token is refreshed I call the reconnect()\n\nand in the .reconnectAttempt socket event I set the token again\n\nself.manager.setConfigs([.extraHeaders([\"Authorization\": \"new_token\"])])\n. ",
    "murad1981": "it turned about to be something else other than SocketIO, we're using WebRTC along with SocketIO and it's casing this issue when capturing video frames.. ",
    "kvaDrug": "The server is nginx/1.10.3 (Ubuntu)  and client is 13.1.1.. It uses socket.io v2.0.4.. Backend programmer told me that he received [\"id\": 6, \"type\": \"mentor\"] string. I was able to fix this problem by using Data generated by JSONSerialization instead of raw Dictionary. But, if I will have more free time I will try to investigate this problem deeper.. I was able to fix my problem by disabling built-in reconnection:\nmanager = SocketManager(socketURL: serverURL, config: [.reconnects(false)])\nAnd then I created a Timer that will periodically check if the socket is connected and reconnects if necessary.. ",
    "bjbjbjbj": "@property (strong, nonatomic) SocketIOClient bj;\n@property (strong, nonatomic) SocketManager bj2;\nSocketManager manager = [[SocketManager alloc] initWithSocketURL:url config:@{@\"log\": @YES, @\"compress\": @YES}];\n    self.bj2 = manager;\n    SocketIOClient socket = manager.defaultSocket;\n    self.bj = socket;\nARC release. ",
    "sonysum": "If i call 'removeAllHandlers' its will remove for all other controller i still want want to listen \nhow can i do?. ",
    "IOSFreak455": "my namespace is  \" /rt.demoSocket.io/client \" only . . I was getting something like this \nLOG SocketIOClient: Emitting: 2/rt.demoSocket.io/client,[\"LoginDetails\",{\"id\":\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6IjU5ZjIzYzNiZjQ4ZTlmNGNlYjYzOWZlNyIsImlhdCI6MTUyMDI1Mjc1N30._wvoRGjv5Im7pNf06_rhi_zWMK2Vy0Wa32LsGegY7HA\"}]\n2018-03-05 17:56:01.881042+0530 Demo[6456:470489] LOG SocketIOClient: Adding handler for event: gettingCallStatus\nD31A0DC6-FF07-4E88-BF1C-45F5EB210902\n2018-03-05 17:56:01.881112+0530 Demo[6456:471288] LOG SocketEngine: Writing ws: 2/rt.demoSocket.io/client,[\"setDetails\",{\"id\":\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6IjU5ZjIzYzNiZjQ4ZTlmNGNlYjYzOWZlNyIsImlhdCI6MTUyMDI1Mjc1N30._wvoRGjv5Im7pNf06_rhi_zWMK2Vy0Wa32LsGegY7HA\"}] has data: false\n2018-03-05 17:56:01.881294+0530 Demo[6456:470489] LOG SocketIOClient: Adding handler for event: auth_success\n. No i dn't see anything.  Except this thing from socket , once i send the login token to socket through emit message. \n```\n2018-03-05 17:56:01.881042+0530 Demo[6456:470489] LOG SocketIOClient: Adding handler for event: gettingCallStatus\nD31A0DC6-FF07-4E88-BF1C-45F5EB210902\n```\nAnd moreover, my login token keeps on adding on the server, i can see the logs printing continuously in my Xcode Console . \nis this the making problem to our listening events .? \nNote : When i tested locally i am able to listen to socket events Properly .. \n. ",
    "ltsuchiya": "We are using 1.48 on our server and swift socket io 12.1.3\nI have found that our data is coming in as iso-latin-1, not sure if this is related to socket io or a problem on our end. \nWe have resolved it by encoding the received string back as iso-latin then decoding it into a utf8 string on the app side.. ",
    "aimensasi": "is there a way to prevent the engine from converting the JSON data . ",
    "Antamokhin": "I have same problem too. There is production flask server, tested with browser.\nWhen connecting through ios:\n```\nlet address = \"ws://localhost:5000/\"\nlet manager = SocketManager(socketURL: URL(string: address)!, config: [.log(true), .compress, .forceWebsockets(false)])\nlet socket = manager.socket(forNamespace: \"/anon\")\nsocket.on(clientEvent: .connect) {data, ack in\n     print(\"socket connected\")//never print\n}\nsocket.connect()\n```\nconnect just to '/' (not to '/anon') namespace will be triggered, but ios doesn't receive connect event .\nWhen i set .forceWebosckets(true) it doesn't works at all:(. 2018-04-03 23:55:22.419166+0400 SwiftIPhone[36889:1387350] LOG SocketIOClient{/anon}: Adding handler for event: connect\n2018-04-03 23:55:22.419599+0400 SwiftIPhone[36889:1387350] LOG SocketIOClient{/anon}: Handling event: statusChange with data: [connecting]\n2018-04-03 23:55:22.419953+0400 SwiftIPhone[36889:1387350] LOG SocketIOClient{/anon}: Joining namespace /anon\n2018-04-03 23:55:22.420179+0400 SwiftIPhone[36889:1387350] LOG SocketManager: Tried connecting socket when engine isn't open. Connecting\n2018-04-03 23:55:22.421295+0400 SwiftIPhone[36889:1387350] LOG SocketManager: Adding engine\n2018-04-03 23:55:22.421797+0400 SwiftIPhone[36889:1387350] LOG SocketManager: Manager is being released\n2018-04-03 23:55:22.421888+0400 SwiftIPhone[36889:1387468] LOG SocketEngine: Starting engine. Server: ws://localhost:5000/\n2018-04-03 23:55:22.422201+0400 SwiftIPhone[36889:1387350] LOG SocketIOClient{/anon}: Client is being released\n2018-04-03 23:55:22.422369+0400 SwiftIPhone[36889:1387468] LOG SocketEngine: Handshaking\n2018-04-03 23:55:22.425341+0400 SwiftIPhone[36889:1387468] LOG SocketEngine: Engine is being released\nWhen .forceWebsockets(true)\n2018-04-03 23:57:53.459484+0400 SwiftIPhone[36986:1390892] LOG SocketIOClient{/anon}: Adding handler for event: connect\n2018-04-03 23:57:53.459963+0400 SwiftIPhone[36986:1390892] LOG SocketIOClient{/anon}: Handling event: statusChange with data: [connecting]\n2018-04-03 23:57:53.460250+0400 SwiftIPhone[36986:1390892] LOG SocketIOClient{/anon}: Joining namespace /anon\n2018-04-03 23:57:53.460652+0400 SwiftIPhone[36986:1390892] LOG SocketManager: Tried connecting socket when engine isn't open. Connecting\n2018-04-03 23:57:53.460806+0400 SwiftIPhone[36986:1390892] LOG SocketManager: Adding engine\n2018-04-03 23:57:53.461624+0400 SwiftIPhone[36986:1390892] LOG SocketManager: Manager is being released\n2018-04-03 23:57:53.461840+0400 SwiftIPhone[36986:1390892] LOG SocketIOClient{/anon}: Client is being released\n2018-04-03 23:57:53.461690+0400 SwiftIPhone[36986:1390985] LOG SocketEngine: Starting engine. Server: ws://localhost:5000/\n2018-04-03 23:57:53.462246+0400 SwiftIPhone[36986:1390985] LOG SocketEngine: Handshaking\n2018-04-03 23:57:53.465429+0400 SwiftIPhone[36986:1390985] LOG SocketEnginePolling: Doing polling GET http://localhost:5000/socket.io/?transport=polling&b64=1\n2018-04-03 23:57:53.565013+0400 SwiftIPhone[36986:1391095] LOG SocketEnginePolling: Got polling response\n2018-04-03 23:57:53.568265+0400 SwiftIPhone[36986:1391095] LOG SocketEnginePolling: Got poll message: 109:0{\"sid\":\"8c929048a4444954b893b60753f10cde\",\"pingTimeout\":60000,\"pingInterval\":25000,\"upgrades\":[\"websocket\"]}2:40\n2018-04-03 23:57:53.582269+0400 SwiftIPhone[36986:1391095] LOG SocketEngine: Got message: 0{\"sid\":\"8c929048a4444954b893b60753f10cde\",\"pingTimeout\":60000,\"pingInterval\":25000,\"upgrades\":[\"websocket\"]}\n2018-04-03 23:57:53.597628+0400 SwiftIPhone[36986:1391095] LOG SocketEngine: Got message: 40\n2018-04-03 23:57:53.599035+0400 SwiftIPhone[36986:1391095] LOG SocketEngine: Writing poll:  has data: false\n2018-04-03 23:57:53.600181+0400 SwiftIPhone[36986:1391095] LOG SocketEnginePolling: Sending poll:  as type: 2\n2018-04-03 23:57:53.603291+0400 SwiftIPhone[36986:1391095] LOG SocketEnginePolling: Created POST string: 1:2\n2018-04-03 23:57:53.604570+0400 SwiftIPhone[36986:1391095] LOG SocketEnginePolling: POSTing\n2018-04-03 23:57:53.604955+0400 SwiftIPhone[36986:1391095] LOG SocketEngine: Engine is being released\nwhen false. solved! thanks :). ",
    "PXLZHM": "My situation is different. When I use \"forceWebSocket (true)\", I can't connect and use \"forcePolling (true)\" is OK.. This is the log for \"forceWebSocket (true)\". Only so much.\n\n2018-03-27 11:29:24.952466+0800 SocketDemo[1075:285236] LOG SocketIOClient{/rider/task}: Adding handler for event: connect\n2018-03-27 11:29:24.952937+0800 SocketDemo[1075:285236] LOG SocketIOClient{/rider/task}: Adding handler for event: new message\n2018-03-27 11:29:24.953091+0800 SocketDemo[1075:285236] LOG SocketIOClient{/rider/task}: Adding handler for event: disconnect\n2018-03-27 11:29:24.953676+0800 SocketDemo[1075:285236] LOG SocketIOClient{/rider/task}: Handling event: statusChange with data: [connecting]\n2018-03-27 11:29:24.953817+0800 SocketDemo[1075:285236] LOG SocketManager: Tried connecting socket when engine isn't open. Connecting\n2018-03-27 11:29:24.953885+0800 SocketDemo[1075:285236] LOG SocketManager: Adding engine\n2018-03-27 11:29:24.955365+0800 SocketDemo[1075:285285] LOG SocketEngine: Starting engine. Server: http://192.168.101.210:3000\n2018-03-27 11:29:24.955447+0800 SocketDemo[1075:285285] LOG SocketEngine: Handshaking. \n",
    "huapeng222": "I also had similar problems.\nBut I only do it in 4G.\nWhen i open my App,\nit's fine,\nbut when i  press home ,I'll disconnect,\nthen,I open my App, Reconnect, \nIt took me a long time to connect successfully.(60-90s)\nIf I switch to WiFi,\nit's fine\nNSDictionary *dic =@{@\"log\": [NSNumber numberWithBool:isLog],\n                             @\"forceNew\": @YES,\n                             @\"timeout\":@10,\n                             @\"compress\":@YES,\n                             @\"forceWebsockets\": @YES,\n                             };\n if (!self.socketManager) {\n            [self.socketManager disconnect];\n            self.socketManager=nil;\n}\nself.socketManager=[[SocketManager alloc] initWithSocketURL:url config:dic];\nself.webSocket = self.socketManager.defaultSocket;\n[self.webSocket connect];\nAnd when I remove forceWebsockets,use forcePolling .\nIt's fine,\nBut I have to use websocket to send data to server\n. Lock this link\nhttps://github.com/daltoniam/Starscream/issues/575\nadd pod 'Starscream', '<= 3.0.5'. ",
    "choiceyou": "I understand already, thank you all the same! haha!. ",
    "JustSAT": "@nuclearace Okay, for example api returns me array of group_id \n{\n    \"group_ids\": [1, 2, 3]\n}\nI need to get detail information about each group using another socket \"request\" (for example getGroupInfo). In loop I declare \"once\" listener for \"getGroupInfo\" and emit \"getGroupInfo\" with [[\"group_id\":groups[i]]] data. \nEach once callback returns me the information about first group in loop, but in logs I see that server return me different information.\nI hope this is more clear about the situation.\nThank you for answer.. ",
    "Arunbalaji001": "SocketManager manager;\n    SocketIOClient socket;\n\"SocketManager\" is declared as the manager and the \"SocketIoClient\" is declared as socket.\nIn the console, it is showing the are messages sent but not showing anything about the socket received.\nLogs :\n018-03-26 16:49:18.942306 datelah[2324:754465] LOG SocketIOClient{/}: Joining namespace /\n2018-03-26 16:49:18.942966 datelah[2324:754465] LOG SocketManager: Tried connecting socket when engine isn't open. Connecting\n2018-03-26 16:49:18.943399 datelah[2324:754465] LOG SocketManager: Adding engine\n2018-03-26 16:49:25.386674 datelah[2324:754883] LOG SocketEngine: Starting engine. Server: http://192.168.0.109:9005\n2018-03-26 16:49:25.386935 datelah[2324:754883] LOG SocketEngine: Handshaking\n2018-03-26 16:49:25.388457 datelah[2324:754883] LOG SocketEnginePolling: Doing polling GET http://192.168.0.109:9005/socket.io/?transport=polling&b64=1\n2018-03-26 16:49:25.677721 datelah[2324:754891] LOG SocketEnginePolling: Got polling response\n2018-03-26 16:49:25.679886 datelah[2324:754891] LOG SocketEnginePolling: Got poll message: 97:0{\"sid\":\"cMDOxgYsL68hrm5AAAAZ\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2018-03-26 16:49:25.691134 datelah[2324:754891] LOG SocketEngine: Got message: 0{\"sid\":\"cMDOxgYsL68hrm5AAAAZ\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\n2018-03-26 16:49:25.722136 datelah[2324:754465] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-03-26 16:49:25.722654 datelah[2324:754465] LOG SocketManager: Engine opened Connect\n2018-03-26 16:49:25.722934 datelah[2324:754891] LOG SocketEnginePolling: Doing polling GET http://192.168.0.109:9005/socket.io/?transport=polling&b64=1&sid=cMDOxgYsL68hrm5AAAAZ\n2018-03-26 16:49:25.722977 datelah[2324:754465] LOG SocketIOClient{/}: Socket connected\n2018-03-26 16:49:25.723278 datelah[2324:754465] LOG SocketIOClient{/}: Handling event: statusChange with data: [connected]\n2018-03-26 16:49:25.723748 datelah[2324:754465] LOG SocketIOClient{/}: Handling event: connect with data: [\"/\"]\n2018-03-26 16:49:25.724306 datelah[2324:754891] LOG SocketEngine: Writing poll:  has data: false\n2018-03-26 16:49:25.727234 datelah[2324:754891] LOG SocketEnginePolling: Sending poll:  as type: 2\n2018-03-26 16:49:25.732347 datelah[2324:754891] LOG SocketEnginePolling: Created POST string: 1:2\n2018-03-26 16:49:25.733603 datelah[2324:754891] LOG SocketEnginePolling: POSTing\n2018-03-26 16:49:25.733990 datelah[2324:754891] LOG SocketEnginePolling: Doing polling POST http://192.168.0.109:9005/socket.io/?transport=polling&b64=1&sid=cMDOxgYsL68hrm5AAAAZ\n2018-03-26 16:49:25.778918 datelah[2324:754893] LOG SocketEnginePolling: Got polling response\n2018-03-26 16:49:25.779374 datelah[2324:754893] LOG SocketEnginePolling: Got poll message: 2:40\n2018-03-26 16:49:25.779980 datelah[2324:754893] LOG SocketEngine: Got message: 40\n2018-03-26 16:49:25.780463 datelah[2324:754465] LOG SocketParser: Parsing 0\n2018-03-26 16:49:25.782125 datelah[2324:754465] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2018-03-26 16:49:25.782280 datelah[2324:754893] LOG SocketEnginePolling: Doing polling GET http://192.168.0.109:9005/socket.io/?transport=polling&b64=1&sid=cMDOxgYsL68hrm5AAAAZ\n2018-03-26 16:49:25.830647 datelah[2324:754892] LOG SocketEngineWebSocket: Sending ws: probe as type: 2\n2018-03-26 16:49:25.840207 datelah[2324:754893] LOG SocketEnginePolling: Got polling response\n2018-03-26 16:49:25.840511 datelah[2324:754893] LOG SocketEnginePolling: Got poll message: 1:3\n2018-03-26 16:49:25.841025 datelah[2324:754893] LOG SocketEngine: Got message: 3\n2018-03-26 16:49:25.841827 datelah[2324:754465] LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-03-26 16:49:25.842236 datelah[2324:754893] LOG SocketEnginePolling: Doing polling GET http://192.168.0.109:9005/socket.io/?transport=polling&b64=1&sid=cMDOxgYsL68hrm5AAAAZ\n2018-03-26 16:49:25.888109 datelah[2324:754891] LOG SocketEngine: Got message: 3probe\n2018-03-26 16:49:25.889765 datelah[2324:754891] LOG SocketEngine: Received probe response, should upgrade to WebSockets\n2018-03-26 16:49:25.890016 datelah[2324:754891] LOG SocketEngine: Upgrading transport to WebSockets\n2018-03-26 16:49:25.890223 datelah[2324:754891] LOG SocketEnginePolling: Sending poll:  as type: 6\n2018-03-26 16:49:25.890702 datelah[2324:754891] LOG SocketEnginePolling: Created POST string: 1:6\n2018-03-26 16:49:25.891583 datelah[2324:754891] LOG SocketEnginePolling: POSTing\n2018-03-26 16:49:25.891949 datelah[2324:754465] LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-03-26 16:49:25.986085 datelah[2324:754892] LOG SocketEnginePolling: Got polling response\n2018-03-26 16:49:25.986449 datelah[2324:754892] LOG SocketEnginePolling: Got poll message: 1:6\n2018-03-26 16:49:25.986791 datelah[2324:754892] LOG SocketEngine: Got message: 6\n2018-03-26 16:49:25.987275 datelah[2324:754892] LOG SocketEngine: Switching to WebSockets\n2018-03-26 16:49:25.987885 datelah[2324:754892] LOG SocketEngineWebSocket: Sending ws:  as type: 5\n2018-03-26 16:49:25.988482 datelah[2324:754892] LOG SocketEngine: Flushing probe wait\n2018-03-26 16:49:41.604850 datelah[2324:754465] righta arry is :(\n    \"type..\"\n)\n2018-03-26 16:49:41.611460 datelah[2324:754465] LOG SocketIOClient{/}: Emitting: 2[\"new_message\",{\"userto\":\"1\",\"message\":\"type..\",\"userfrom\":\"2\"}]\n2018-03-26 16:49:41.612309 datelah[2324:754465] array is :(\n        {\n        message = \"type..\";\n        userfrom = 2;\n        userto = 1;\n    }\n)\n2018-03-26 16:49:41.613690 datelah[2324:754926] LOG SocketEngine: Writing ws: 2[\"new_message\",{\"userto\":\"1\",\"message\":\"type..\",\"userfrom\":\"2\"}] has data: false\n2018-03-26 16:49:41.613994 datelah[2324:754926] LOG SocketEngineWebSocket: Sending ws: 2[\"new_message\",{\"userto\":\"1\",\"message\":\"type..\",\"userfrom\":\"2\"}] as type: 4\n2018-03-26 16:49:41.616259 datelah[2324:754465] rightcell\n2018-03-26 16:49:41.625246 datelah[2324:754465] chat array value A:a\n2018-03-26 16:49:48.454637 datelah[2324:754465] righta arry is :(\n    \"type..\",\n    Anitha\n)\n2018-03-26 16:49:48.455546 datelah[2324:754465] LOG SocketIOClient{/}: Emitting: 2[\"new_message\",{\"userto\":\"1\",\"message\":\"Anitha\",\"userfrom\":\"2\"}]\n2018-03-26 16:49:48.455895 datelah[2324:754465] array is :(\n        {\n        message = Anitha;\n        userfrom = 2;\n        userto = 1;\n    }\n)\n2018-03-26 16:49:48.456571 datelah[2324:754937] LOG SocketEngine: Writing ws: 2[\"new_message\",{\"userto\":\"1\",\"message\":\"Anitha\",\"userfrom\":\"2\"}] has data: false\n2018-03-26 16:49:48.456810 datelah[2324:754937] LOG SocketEngineWebSocket: Sending ws: 2[\"new_message\",{\"userto\":\"1\",\"message\":\"Anitha\",\"userfrom\":\"2\"}] as type: 4\n2018-03-26 16:49:48.458609 datelah[2324:754465] rightcell\n2018-03-26 16:49:48.459165 datelah[2324:754465] chat array value A:a\n2018-03-26 16:49:48.470669 datelah[2324:754465] rightcell\n2018-03-26 16:49:48.478191 datelah[2324:754465] chat array value A:a\n2018-03-26 16:49:52.228034 datelah[2324:754465] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-03-26 16:49:52.228468 datelah[2324:754926] LOG SocketEngine: Writing ws:  has data: false\n2018-03-26 16:49:52.230496 datelah[2324:754926] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2018-03-26 16:49:52.472385 datelah[2324:754926] LOG SocketEngine: Got message: 3\n2018-03-26 16:49:52.472850 datelah[2324:754465] LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-03-26 16:49:52.885530 datelah[2324:754465] righta arry is :(\n    \"type..\",\n    Anitha,\n    Hello\n)\n2018-03-26 16:49:52.886843 datelah[2324:754465] LOG SocketIOClient{/}: Emitting: 2[\"new_message\",{\"userto\":\"1\",\"message\":\"Hello\",\"userfrom\":\"2\"}]\n2018-03-26 16:49:52.887422 datelah[2324:754465] array is :(\n        {\n        message = Hello;\n        userfrom = 2;\n        userto = 1;\n    }\n)\n2018-03-26 16:49:52.887547 datelah[2324:754926] LOG SocketEngine: Writing ws: 2[\"new_message\",{\"userto\":\"1\",\"message\":\"Hello\",\"userfrom\":\"2\"}] has data: false\n2018-03-26 16:49:52.887784 datelah[2324:754926] LOG SocketEngineWebSocket: Sending ws: 2[\"new_message\",{\"userto\":\"1\",\"message\":\"Hello\",\"userfrom\":\"2\"}] as type: 4\n2018-03-26 16:49:52.919632 datelah[2324:754465] rightcell\n2018-03-26 16:49:52.919963 datelah[2324:754465] chat array value A:a\n2018-03-26 16:49:52.922719 datelah[2324:754465] rightcell\n2018-03-26 16:49:52.930987 datelah[2324:754465] chat array value A:a\n2018-03-26 16:49:52.942004 datelah[2324:754465] rightcell\n2018-03-26 16:49:52.949870 datelah[2324:754465] chat array value A:a\n2018-03-26 16:50:19.716488 datelah[2324:754465] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-03-26 16:50:19.717041 datelah[2324:755029] LOG SocketEngine: Writing ws:  has data: false\n2018-03-26 16:50:19.717564 datelah[2324:755029] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2018-03-26 16:50:20.415392 datelah[2324:755029] LOG SocketEngine: Got message: 3\n2018-03-26 16:50:20.416137 datelah[2324:754465] LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-03-26 16:50:47.207898 datelah[2324:754465] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-03-26 16:50:47.208521 datelah[2324:755065] LOG SocketEngine: Writing ws:  has data: false\n2018-03-26 16:50:47.209022 datelah[2324:755065] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2018-03-26 16:50:47.282921 datelah[2324:754942] LOG SocketEngine: Got message: 3\n2018-03-26 16:50:47.283670 datelah[2324:754465] LOG SocketIOClient{/}: Handling event: pong with data: []\n. This is code of the server, that I am running in my system. Sending and receiving via android client and web client works seamlessly. I am not receiving sockets in this iOS client only.\nServer\n   var app = require('express')();\n   var http = require('http').Server(app);\n    var socket = require('socket.io')(http);var port = 9005;\n\n\n\n\n       socket.on('connection', function(client){\n       console.log('connected');\n\n\n          client.on('join_user', function (roomid) {\n      var roomid = roomid;\n       client.join(roomid);\n       console.log('roomid: ' + roomid);\n      });\n\n\n\nclient.on('new_message', function (data) {\n// we tell the client to execute 'new message'\n var to_roomid = data.userto;\n console.log('message:',data.message);\n//client.broadcast.emit('my_message', data); \nclient.to(to_roomid).emit('my_message', data); \nconsole.log('toid:',to_roomid);\n\n});\n\n  client.on('typing', function (data) {\n      var to_roomid = data.userto;\n\n       console.log(\"typing\"+to_roomid);\n     client.to(to_roomid).emit('typing',data);\n   });\n\n    // when the client emits 'stop typing', we broadcast it to others\n      client.on('stop_typing', function (data) {\n  var to_roomid = data.userto;\n  console.log('stoptyping'+to_roomid);\n\n         client.to(to_roomid).emit('stop_typing',data);\n        });\n\n         });\n\n\n      http.listen(port, function(){\n         console.log('listening on *:'+port);\n       });\n\n. Would be highly helpful to know if there is a way to listen to this server via iOS client.. does using rooms the server have something to do with this problem ? . yes, messages are received by the server when sent from this client and forwarded to the correct rooms. After I sent the message to the server, I get the following in the Xcode log : \n2018-03-27 12:12:00.767136 datelah[2561:821843] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-03-27 12:12:00.767652 datelah[2561:821843] Got event: ping, with items: (\n)\n2018-03-27 12:12:00.768062 datelah[2561:823602] LOG SocketEngine: Writing poll:  has data: false\n2018-03-27 12:12:00.768482 datelah[2561:823602] LOG SocketEnginePolling: Sending poll:  as type: 2\nwhen the client is at ideal I get the following in Xcode : \n```\n2018-03-27 12:13:51.194206 datelah[2561:821843] LOG SocketManager: Engine opened Connect\n2018-03-27 12:13:51.194403 datelah[2561:821843] LOG SocketIOClient{/}: Socket connected\n2018-03-27 12:13:51.194610 datelah[2561:821843] LOG SocketIOClient{/}: Handling event: statusChange with data: [connected]\n2018-03-27 12:13:51.194901 datelah[2561:821843] Got event: statusChange, with items: (\n    connected\n)\n2018-03-27 12:13:51.195240 datelah[2561:821843] LOG SocketIOClient{/}: Handling event: connect with data: [\"/\"]\n2018-03-27 12:13:51.195455 datelah[2561:821843] Got event: connect, with items: (\n    \"/\"\n)\n2018-03-27 12:13:51.197243 datelah[2561:823723] LOG SocketEnginePolling: Sending poll:  as type: 2\n2018-03-27 12:13:51.197572 datelah[2561:823723] LOG SocketEnginePolling: Created POST string: 1:21:21:2\n2018-03-27 12:13:51.198433 datelah[2561:823723] LOG SocketEnginePolling: POSTing\n2018-03-27 12:14:18.687768 datelah[2561:821843] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-03-27 12:14:18.687971 datelah[2561:823839] LOG SocketEngine: Writing poll:  has data: false\n2018-03-27 12:14:18.688314 datelah[2561:821843] Got event: ping, with items: (\n)\n2018-03-27 12:14:18.688486 datelah[2561:823839] LOG SocketEnginePolling: Sending poll:  as type: 2\n```. Thank you.. After a bit of testing I found that the client is not emitting \"join_user\" event to server, due to which it was not receiving any messages sent to its room as the client have not joined into its specified room. Then I found that I have to use \"[socket on  \"connect\",----------] \" listener instead of \"[socket on  \"connection\",--------] \" to listen if the socket is connected. After I rectified that, the \"join_user\" event emitted fine and the client received the messages sent to its room perfectly.\nThank you for your time..\n. ",
    "meMuhammadkamal": "I was using wrong version:\n 13.1.0 instead of this 11.1.3. ",
    "opfeffer": "This looks cool -- is there an ETA when 3.2.0 might get released?\nThanks for your work!. ",
    "AleksandrKh": "I start it:\n```\n        manager = SocketManager(socketURL: url, config: [\n                        .connectParams(params),\n                        .log(log),\n                        .forceNew(true),\n                        .compress\n                        ])\n        socket = manager.defaultSocket\n    ... attaching handlers\n\n   socket!.connect()\n\nAnd then have:\n2018-04-04 01:02:57.915391+0500 app[54208:8964902] LOG SocketIOClient{/}: Adding handler for event: connect\n2018-04-04 01:02:57.917369+0500 app[54208:8964902] LOG SocketIOClient{/}: Adding handler for event: error\n2018-04-04 01:02:57.917616+0500 app[54208:8964902] LOG SocketIOClient{/}: Adding handler for event: disconnect\n2018-04-04 01:02:57.917758+0500 app[54208:8964902] LOG SocketIOClient{/}: Adding handler for event: message\n2018-04-04 01:02:57.919692+0500 app[54208:8964902] LOG SocketIOClient{/}: Handling event: statusChange with data: [connecting]\n2018-04-04 01:02:57.919955+0500 app[54208:8964902] LOG SocketIOClient{/}: Joining namespace /\n2018-04-04 01:02:57.920521+0500 app[54208:8964902] LOG SocketManager: Tried connecting socket when engine isn't open. Connecting\n2018-04-04 01:02:57.920698+0500 app[54208:8964902] LOG SocketManager: Adding engine\n2018-04-04 01:02:57.934377+0500 app[54208:8965591] LOG SocketEngine: Starting engine. Server: https://dev.com\n2018-04-04 01:02:57.934577+0500 app[54208:8965591] LOG SocketEngine: Handshaking\n2018-04-04 01:02:57.935745+0500 app[54208:8965591] LOG SocketEnginePolling: Doing polling GET https://dev.com/socket.io/?transport=polling&b64=1...\n2018-04-04 01:02:58.599372+0500 app[54208:8965588] [BoringSSL] Function boringssl_session_errorlog: line 2881 [boringssl_session_read] SSL_ERROR_ZERO_RETURN(6): operation failed because the connection was cleanly shut down with a close_notify alert\n2018-04-04 01:02:58.599814+0500 app[54208:8965588] [BoringSSL] Function boringssl_session_errorlog: line 2881 [boringssl_session_read] SSL_ERROR_ZERO_RETURN(6): operation failed because the connection was cleanly shut down with a close_notify alert\n2018-04-04 01:02:58.600055+0500 app[54208:8965588] [BoringSSL] Function boringssl_session_errorlog: line 2881 [boringssl_session_read] SSL_ERROR_ZERO_RETURN(6): operation failed because the connection was cleanly shut down with a close_notify alert\n2018-04-04 01:02:58.839171+0500 app[54208:8965585] LOG SocketEnginePolling: Got polling response\n2018-04-04 01:02:58.841086+0500 app[54208:8965585] LOG SocketEnginePolling: Got poll message: 96:0{\"sid\":\"g8iph99f7d81f0\",\"upgrades\":[\"websocket\"],\"pingInterval\":3000,\"pingTimeout\":10000}\n2018-04-04 01:02:58.844662+0500 app[54208:8965585] LOG SocketEngine: Got message: 0{\"sid\":\"g8iph99f7d81f0\",\"upgrades\":[\"websocket\"],\"pingInterval\":3000,\"pingTimeout\":10000}\n2018-04-04 01:02:58.858864+0500 app[54208:8964902] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-04-04 01:02:58.858909+0500 app[54208:8965585] LOG SocketEnginePolling: Doing polling GET https://dev.com/socket.io/?transport=polling...\n2018-04-04 01:02:58.859124+0500 app[54208:8964902] LOG SocketManager: Engine opened Connect\n2018-04-04 01:02:58.859475+0500 app[54208:8965585] LOG SocketEngine: Writing poll:  has data: false\n2018-04-04 01:02:58.859790+0500 app[54208:8964902] LOG SocketIOClient{/}: Socket connected\n2018-04-04 01:02:58.860122+0500 app[54208:8965585] LOG SocketEnginePolling: Sending poll:  as type: 2\n2018-04-04 01:02:58.860421+0500 app[54208:8964902] LOG SocketIOClient{/}: Handling event: statusChange with data: [connected]\n2018-04-04 01:02:58.861939+0500 app[54208:8965585] LOG SocketEnginePolling: Created POST string: 1:2\n2018-04-04 01:02:58.862461+0500 app[54208:8964902] LOG SocketIOClient{/}: Handling event: connect with data: [\"/\"]\nConnected\n01:02:58.865743+0500 app[54208:8965585] LOG SocketEnginePolling: POSTing ...\n2018-04-04 01:02:58.868395+0500 app[54208:8964902] LOG SocketIOClient{/}: Emitting: ...\n2018-04-04 01:02:58.868727+0500 app[54208:8965585] LOG SocketEnginePolling: Doing polling POST https://dev.com/socket.io/?transport=polling...\n2018-04-04 01:02:58.870425+0500 app[54208:8965585] LOG SocketEngine: Writing poll: ...\n2018-04-04 01:02:59.142100+0500 app[54208:8965778] LOG SocketEnginePolling: Got polling response\n2018-04-04 01:02:59.145903+0500 app[54208:8965778] LOG SocketEnginePolling: Got poll message: 2:40\n2018-04-04 01:02:59.147074+0500 app[54208:8965778] LOG SocketEngine: Got message: 40\n2018-04-04 01:02:59.147851+0500 app[54208:8964902] LOG SocketParser: Parsing 0\n2018-04-04 01:02:59.147852+0500 app[54208:8965778] LOG SocketEnginePolling: Doing polling GET https://dev.com/socket.io/?transport=polling...\n2018-04-04 01:02:59.148329+0500 app[54208:8964902] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2018-04-04 01:02:59.161838+0500 app[54208:8965591] LOG SocketEnginePolling: POSTing\n2018-04-04 01:02:59.162566+0500 app[54208:8965591] LOG SocketEnginePolling: Doing polling POST https://dev.com/socket.io/?transport=polling&...\n2018-04-04 01:02:59.311763+0500 app[54208:8965586] LOG SocketEngineWebSocket: Sending ws: probe as type: 2\n2018-04-04 01:02:59.416829+0500 app[54208:8965781] LOG SocketEngine: Got message: 3probe\n2018-04-04 01:02:59.417119+0500 app[54208:8965781] LOG SocketEngine: Received probe response, should upgrade to WebSockets\n2018-04-04 01:02:59.417513+0500 app[54208:8965781] LOG SocketEngine: Upgrading transport to WebSockets\n2018-04-04 01:02:59.417679+0500 app[54208:8965781] LOG SocketEnginePolling: Sending poll:  as type: 6\n2018-04-04 01:02:59.417899+0500 app[54208:8964902] LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-04-04 01:02:59.427762+0500 app[54208:8965585] LOG SocketEnginePolling: Got polling response\n2018-04-04 01:02:59.428683+0500 app[54208:8965585] LOG SocketEnginePolling: Got poll message: 1:3\n2018-04-04 01:02:59.430585+0500 app[54208:8965585] LOG SocketEngine: Got message: 3\n2018-04-04 01:02:59.432181+0500 app[54208:8964902] LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-04-04 01:02:59.432193+0500 app[54208:8965585] LOG SocketEngine: Switching to WebSockets\n2018-04-04 01:02:59.435535+0500 app[54208:8965585] LOG SocketEngineWebSocket: Sending ws:  as type: 5\n2018-04-04 01:02:59.436145+0500 app[54208:8965585] LOG SocketEngine: Flushing probe wait\n2018-04-04 01:03:02.150122+0500 app[54208:8965585] LOG SocketEngine: Writing ws:  has data: false\n2018-04-04 01:03:02.150122+0500 app[54208:8964902] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-04-04 01:03:02.150450+0500 app[54208:8965585] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2018-04-04 01:03:02.230775+0500 app[54208:8965585] LOG SocketEngine: Got message: 3\n2018-04-04 01:03:02.231148+0500 app[54208:8964902] LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-04-04 01:03:05.150340+0500 app[54208:8965585] LOG SocketEngine: Writing ws:  has data: false\n2018-04-04 01:03:05.150340+0500 app[54208:8964902] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-04-04 01:03:05.150546+0500 app[54208:8965585] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2018-04-04 01:03:05.230786+0500 app[54208:8965591] LOG SocketEngine: Got message: 3\n2018-04-04 01:03:05.231783+0500 app[54208:8964902] LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-04-04 01:03:08.386731+0500 app[54208:8965591] LOG SocketEngine: Writing ws:  has data: false\n2018-04-04 01:03:08.386735+0500 app[54208:8964902] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-04-04 01:03:08.386995+0500 app[54208:8965591] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2018-04-04 01:03:08.476313+0500 app[54208:8965585] LOG SocketEngine: Got message: 3\n2018-04-04 01:03:08.476627+0500 app[54208:8964902] LOG SocketIOClient{/}: Handling event: pong with data: []\n. It seems no, server does not receive any message. \nAlso I definitely should receive a message from the server, but I don't get any:\n        socket!.on(\"message\") {data, ack in\n            // Works in Xcode 9.2\n            // Nothing if compiled in Xcode 9.3\n        }\n```\n. @simformsolutions I still do not understand what the problem is. @simformsolutions did you have socket manager as a variable inside function scope?. it was pretty hidden server problem, thanks for the help. ",
    "simformsolutions": "@AleksandrKh @nuclearace I am too facing the same issue, the handler is being added but didn't get a response.. @AleksandrKh @nuclearace I resolved the issue, as my socket manager was released just after added.. ",
    "v-emelyanov": "I have same problem xcode 9.3. ",
    "NipunRuwanpathirana": "I have the same problem in Xcode 9.3 just updated.\nSwift 3.3 and Socket.IO-Client-Swift 11.1.3\nvar socket: SocketIOClient = SocketIOClient(socketURL: url!,\n                                                config: [.log(true),\n                                                         .selfSigned(true),\n                                                         .forceWebsockets(true),\n                                                         .forceNew(true)\n        ])\n@nuclearace  I also open an issue with my scenario on #1001 I think those related. ",
    "duytuan001": "I have same problem xcode 9.3. ",
    "tooolkit": "maybe you could try add {@\"forceWebsockets\":@(YES)} in the config. ",
    "MQdoyourbest": "I don't know how to use it on objective-c language.. ",
    "payalu": "Can you give example for supporting  binary data upload through this library ? I need it for my chat application.. Yes i understood this emit event \nsocket.emit(\"myDataEvent\", Data())\nbut what should i write in \"myDataEvent\" --> in script ?\nI can send data inside dictionaries and arrays.But how can i get that data values in socket script (.js file) and save it as a file in server.\n. ",
    "hwangey": "@\"forceWebsockets\" :@true  -> remove . ",
    "quoctc": "Now I solved that problem, but I can't connect to my socket server. I think the socket does not support this API: Doing polling GET https://192.168.4.1:8800/socket.io/?transport=polling&b64=1\nWhat happens If my socket server does not support this API?. This is error:\n2018-05-04 17:31:22.238976+0700 xxx[52531:8504334] LOG SocketIOClient{/}: Adding handler for event: connect\n2018-05-04 17:31:22.239242+0700 xxx[52531:8504334] LOG SocketIOClient{/}: Adding handler for event: error\n2018-05-04 17:31:22.239444+0700 xxx[52531:8504334] LOG SocketIOClient{/}: Handling event: statusChange with data: [connecting]\n2018-05-04 17:31:22.239584+0700 xxx[52531:8504334] LOG SocketIOClient{/}: Joining namespace /\n2018-05-04 17:31:22.239706+0700 xxx[52531:8504334] LOG SocketManager: Tried connecting socket when engine isn't open. Connecting\n2018-05-04 17:31:22.239810+0700 xxx[52531:8504334] LOG SocketManager: Adding engine\n2018-05-04 17:31:22.240279+0700 xxx[52531:8504379] LOG SocketEngine: Starting engine. Server: https://192.168.4.1:8800\n2018-05-04 17:31:22.240377+0700 xxx[52531:8504379] LOG SocketEngine: Handshaking\n2018-05-04 17:31:22.240678+0700 xxx[52531:8504379] LOG SocketEnginePolling: Doing polling GET https://192.168.4.1:8800/socket.io/?transport=polling&b64=1\nOptional()  :::: Optional()\nOptional()  :::: \n2018-05-04 17:32:23.950605+0700 xxx[52531:8504399] Task <71084CCE-4F7A-49C8-BA99-5D256EA22160>.<1> finished with error - code: -1001\n2018-05-04 17:32:23.962226+0700 xxx[52531:8504388] ERROR SocketEnginePolling: The request timed out.\n2018-05-04 17:32:23.962539+0700 xxx[52531:8504388] ERROR SocketEngine: The request timed out.. Not yet, But I know where the problem is, So I have trying to use another lib can solve that problem. The problem because of the socket server that we create on server does not same as yours. ",
    "Sunrise17": "Dear @quoctc, have you solved the issue to connect to your ssl socket server (on Python) from Swift with required certs?. ",
    "sootra": "Created a sample app and tested connect and disconnect alone. Works fine. I am using another class where i connect socket.io which is actually crashing the app. The object of that class was not strong. dealloc of that class is getting called when i started using socket.io. Previously that was working fine. So i guess the strong reference of socket.io objects is causing some reference issue to the whole project. . There was a weak reference in that class. When changed to strong, the crash disappeared. . ",
    "Ketan-Wadyalkar": "@nuclearace Thanks for quick response and My bad that i didn't checked FAQ before raising this issue.\nI have updated my code and it's working fine for web-socket but i am facing the above mentioned issue when i try to connect to the socket created by android app.\nThere is no issue in the socket, i am able to connect the socket using android app & Starscream library for iOS.\nAny suggestion on how to do this using socket.io ?\nAlso it would be really helpful if you can guide me on how to write jsonstring on socket.\nThanks in advance.. ",
    "jaragones": "Awesome! I feel silly now! Thanks for your time, it worked!! :). @MD04-TanTan, in your pod file you add next lines:\nuse_frameworks!\n    pod 'Socket.IO-Client-Swift'\nOn your controller, you need to add \n@import SocketIO;\nAfter running \"pod install\", it can be that XCode tells you an error that \"SocketIO couldn't be found\", try to build anyway, it will fix this \"missing link\" issue.\n. @MD04-TanTan also notice that you have a comment under your target 'CustomCell' that tells you to uncomment line if you are using Swift \n```\nuse_frameworks!\n```\n. ",
    "ArtemShvydky": "Thank you so much! I haven't seen this branch. . ",
    "alekzernov": "I do not understand this guide. help please understand. What nps?. extension SocketIOClient {\nconvenience init(for myObject: MyObject) {\n    guard let url = URL(string: \"http://\\(myObject.host):\\(myObject.port)\") else {\n        fatalError(\"Unable to construct valid url for myObject \\(myObject)\")\n    }\n    let manager = SocketManager(socketURL: url, config: [.log(true), .reconnectWait(5)])\n    let socket = manager.defaultSocket\n    self.init(manager: socket.manager!, nsp: \"\")\n}\n\n}\nDid as in the documentation all exactly does not work (((. can tell how to use the manager in my case? in version 12 there was an initializer at the client's socket where it was possible to transfer the link and parameters now it is not present could not prompt analogue of this action. I understand that it should be like this then\nextension SocketIOClient {\nconvenience init(for myObject: MyObject) {\n    guard let url = URL(string: \"http://\\(myObject.host):\\(myObject.port)\") else {\n        fatalError(\"Unable to construct valid url for myObject \\(myObject)\")\n    }\n    let manager = SocketManager(socketURL: url)\n    self.init(manager:manager, nsp: \"/\")\n}\n\n}\nBut it does not work for me ((\nthe server does not even understand that I'm connecting to it. ",
    "gorbat-o": "Thank you for the fast answer.\nI still don't understand where I have to put the .forceWebsockets(true) condition. It didn't find it in the documentation.. Ok I finally found it with manager.setConfigs([.forceWebsockets(true)])\nBut the socket is not receiving anything\nthat worked before\nsocket!.on(\"joinThreadResponse\") { data, ack in\n}. Ok, I get it.\nBut still not working with the socket.on() function\nit never calls the callback. ",
    "liuxinSaberFans": "@property (nonatomic, strong) SocketManager * manager;\n@property (nonatomic, strong) SocketIOClient * socket;\nReplace this with the following two\nSocketManager manager\nSocketIOClient socket. ARC Automatically released\nSocketManager manager = [[SocketManager alloc] initWithSocketURL:url config:@{@\"log\":@YES, @\"compress\":@YES}];\nSocketIOClient socket = [manager defaultSocket];. ",
    "NarasimhaDo": "2500ms. Not after bringing the app back from the background. Use case is :\nApp is loaded \nSocket is connected\nDisconnected the network\nAfter few seconds, connected to network\nSocket tries to reconnect for n number of times.   [_socketIO on:@\"connect\" callback:^(NSArray data, SocketAckEmitter ack){\n            NSLog(@\"teh socket id is %@ *\",_socketIO.sid);\n            [self socketReconnect]; //is this causing issue?\n            [self disconnect];\n}];\n-(void)socketReconnect\n{\n    [_socketIO on:@\"reconnect\" callback:^(NSArray data, SocketAckEmitter ack){\n        NSLog(@\"socket starting reconnect ** %@\",data);\n    }];\n}\n-(void)disconnect\n{\n    [_socketIO on:@\"disconnect\" callback:^(NSArray data, SocketAckEmitter ack){\n        NSLog(@\"socket starting disconnect\");\n    }];\n}\n. Before calling connect, if we try to add handlers won't it throw error as the socket would be nil ?. can you please share small code snippet for demonstrating the workflow?. Thanks nuclearace! It worked like a charm! Thanks a ton!. 2018-12-17 17:50:10.799123+0530 DemoApp[2382:681711] connecting to socket\n2018-12-17 17:50:10.869857+0530 DemoApp[2382:681711] socket connected :: xNDgfWoRILV6arciAACz (socketID)\n2018-12-17 17:51:07.822233+0530 DemoApp[2382:681711] User logging out -> socket disconnecting\n2018-12-17 17:51:07.824516+0530 DemoApp[2382:681711] socket disconnected from client\n-------------------- socket server restarted --------------------\n2018-12-17 17:53:52.101874+0530 DemoApp[2382:681711] socket connected :: rGlir5Q9AKiqeXPZAAAH (socketID)\nNotes : \nAfter socket server got restarted , client is receiving onConnect method called automatically (should not, as the client was already logged out (disconnected)). 2018-12-17 18:29:30.442719+0530 DemoApp[19774:531010] libMobileGestalt MobileGestalt.c:890: MGIsDeviceOneOfType is not supported on this platform.\n2018-12-17 18:29:30.669262+0530 DemoApp[19774:531010] the launch options is (null)\n2018-12-17 18:29:30.669449+0530 DemoApp[19774:531010] the launch options is (null)\n2018-12-17 18:29:30.851201+0530 DemoApp[19774:531010] the network connected to wifi 1\n2018-12-17 18:29:30.881476+0530 DemoApp[19774:531010] db path is  /Users/narasimhudu/Library/Developer/CoreSimulator/Devices/F530DA8D-7614-484D-8E73-2F919CC2C0AD/data/Containers/Data/Application/124FABFB-002B-41F8-88CA-F5F05627546B/Documents/DemoApp.db\n2018-12-17 18:29:31.026244+0530 DemoApp[19774:531293] the network connected to wifi 2\n2018-12-17 18:29:31.028496+0530 DemoApp[19774:531293] the network connected to wifi 2\n2018-12-17 18:29:32.004458+0530 DemoApp[19774:531010] the search string is  \n2018-12-17 18:29:32.012219+0530 DemoApp[19774:531010] Push registration success.\n2018-12-17 18:29:32.033757+0530 DemoApp[19774:531287] 4.9.0 - [Firebase/Analytics][I-ACS023007] Firebase Analytics v.40009000 started\n2018-12-17 18:29:32.035019+0530 DemoApp[19774:531287] 4.9.0 - [Firebase/Analytics][I-ACS023008] To enable debug logging set the following application argument: -FIRAnalyticsDebugEnabled (see http://goo.gl/RfcP7r)\n2018-12-17 18:29:32.187433+0530 DemoApp[19774:531311] 4.9.0 - [Firebase/Messaging][I-FCM001000] FIRMessaging Remote Notifications proxy enabled, will swizzle remote notification receiver handlers. If you'd prefer to manually integrate Firebase Messaging, add \"FirebaseAppDelegateProxyEnabled\" to your Info.plist, and set it to NO. Follow the instructions at:\nhttps://firebase.google.com/docs/cloud-messaging/ios/client#method_swizzling_in_firebase_messaging\nto ensure proper integration.\n2018-12-17 18:29:32.194418+0530 DemoApp[19774:531010] the generate fcm token is 152\n2018-12-17 18:29:32.289234+0530 DemoApp[19774:531010] user_id available\n2018-12-17 18:29:32.292752+0530 DemoApp[19774:531010] the dict is \n2018-12-17 18:29:32.293068+0530 DemoApp[19774:531010] connecting socket\n2018-12-17 18:29:32.299259+0530 DemoApp[19774:531272] 4.9.0 - [Firebase/Messaging][I-FCM012002] Error in application:didFailToRegisterForRemoteNotificationsWithError: remote notifications are not supported in the simulator\n2018-12-17 18:29:32.301541+0530 DemoApp[19774:531272] 4.9.0 - [Firebase/Messaging][I-FCM012002] Error in application:didFailToRegisterForRemoteNotificationsWithError: remote notifications are not supported in the simulator\n2018-12-17 18:29:32.324998+0530 DemoApp[19774:531319] the data is voip not exist {\n    message = success;\n    success = 1;\n}\n2018-12-17 18:29:32.377231+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: get_online_users\n2018-12-17 18:29:32.377623+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: receive_message\n2018-12-17 18:29:32.377759+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: typing\n2018-12-17 18:29:32.377874+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: message_sent\n2018-12-17 18:29:32.378024+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: message_read\n2018-12-17 18:29:32.378177+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: message_delivered\n2018-12-17 18:29:32.378320+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: group_updated\n2018-12-17 18:29:32.378428+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: group_created\n2018-12-17 18:29:32.378593+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: new_online\n2018-12-17 18:29:32.378753+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: new_offline\n2018-12-17 18:29:32.378944+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: get_new_users_available_status\n2018-12-17 18:29:32.379333+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: new_dnd\n2018-12-17 18:29:32.379693+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: unread_messages_count\n2018-12-17 18:29:32.379840+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: user_created\n2018-12-17 18:29:32.380116+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: get_user_last_seen\n2018-12-17 18:29:32.380274+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: user_unread_messages_count\n2018-12-17 18:29:32.380539+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: get_missing_messages\n2018-12-17 18:29:32.380790+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: sync_offline_messages\n2018-12-17 18:29:32.381074+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: logout\n2018-12-17 18:29:32.381310+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: user_pic_updated\n2018-12-17 18:29:32.382259+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: disconnect\n2018-12-17 18:29:32.382499+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: socket_error\n2018-12-17 18:29:32.382801+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: video_call_user\n2018-12-17 18:29:32.405643+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: video_call_permission\n2018-12-17 18:29:32.405843+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: video_signal\n2018-12-17 18:29:32.406040+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: stop_video_call\n2018-12-17 18:29:32.406167+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: screen_share_permission\n2018-12-17 18:29:32.406326+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: sharing_signal\n2018-12-17 18:29:32.406469+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: stop_screen_sharing\n2018-12-17 18:29:32.406650+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: share_screen\n2018-12-17 18:29:32.407503+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: is_calling_screen_active\n2018-12-17 18:29:32.407831+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: account_verified\n2018-12-17 18:29:32.408023+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: get_active_devices\n2018-12-17 18:29:32.408320+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: delete_message\n2018-12-17 18:29:32.408622+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: recall_message\n2018-12-17 18:29:32.408977+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Closing socket\n2018-12-17 18:29:32.409309+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Disconnected: Namespace leave\n2018-12-17 18:29:32.433712+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: statusChange with data: [disconnected]\n2018-12-17 18:29:32.434245+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: disconnect with data: [\"Namespace leave\"]\n2018-12-17 18:29:32.434615+0530 DemoApp[19774:531010] the socket disconnect (\n    \"Namespace leave\"\n) \n2018-12-17 18:29:32.435592+0530 DemoApp[19774:531010] socket disconnected\n2018-12-17 18:29:32.435704+0530 DemoApp[19774:531010] the socket disconnet data is called\n2018-12-17 18:29:32.436012+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: private_chat_permission\n2018-12-17 18:29:32.436142+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: end_private_chat\n2018-12-17 18:29:32.436300+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: check_private_chat\n2018-12-17 18:29:32.436413+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: init_private_chat\n2018-12-17 18:29:32.436547+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: get_all_burnouts\n2018-12-17 18:29:32.436740+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: user_status_updated\n2018-12-17 18:29:32.436858+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: reconnect\n2018-12-17 18:29:32.436969+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: disconnect\n2018-12-17 18:29:32.437122+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Adding handler for event: connect\n2018-12-17 18:29:32.437247+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: statusChange with data: [connecting]\n2018-12-17 18:29:32.437400+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Joining namespace /\n2018-12-17 18:29:32.437625+0530 DemoApp[19774:531010] LOG SocketManager: Tried connecting socket when engine isn't open. Connecting\n2018-12-17 18:29:32.437783+0530 DemoApp[19774:531010] LOG SocketManager: Adding engine\n2018-12-17 18:29:32.439508+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: error with data: [\"Tried emitting when not connected\"]\n2018-12-17 18:29:32.453071+0530 DemoApp[19774:531287] LOG SocketEngine: Starting engine. Server: http://192.168.2.55:8080\n2018-12-17 18:29:32.453263+0530 DemoApp[19774:531287] LOG SocketEngine: Handshaking\n2018-12-17 18:29:32.453688+0530 DemoApp[19774:531287] LOG SocketEnginePolling: Doing polling GET http://192.168.2.55:8080/socket.io/?transport=polling&b64=1&platform=4&is_background=0&user_id=33&device_name=iPhone%208%20Plus&token=0jhWvsQF04rVSwNjeJ0g5xy8lS7rPVEQ\n2018-12-17 18:29:32.460525+0530 DemoApp[19774:531319] LOG SocketEnginePolling: Got polling response\n2018-12-17 18:29:32.460728+0530 DemoApp[19774:531319] LOG SocketEnginePolling: Got poll message: 96:0{\"sid\":\"mEseJQeozIo0A9f_AAAh\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":5000}2:40\n2018-12-17 18:29:32.461118+0530 DemoApp[19774:531319] LOG SocketEngine: Got message: 0{\"sid\":\"mEseJQeozIo0A9f_AAAh\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":5000}\n2018-12-17 18:29:32.464502+0530 DemoApp[19774:531319] LOG SocketEngine: Got message: 40\n2018-12-17 18:29:32.464777+0530 DemoApp[19774:531319] LOG SocketEnginePolling: Doing polling GET http://192.168.2.55:8080/socket.io/?transport=polling&b64=1&platform=4&is_background=0&user_id=33&device_name=iPhone%208%20Plus&token=0jhWvsQF04rVSwNjeJ0g5xy8lS7rPVEQ&sid=mEseJQeozIo0A9f_AAAh\n2018-12-17 18:29:32.465986+0530 DemoApp[19774:531319] LOG SocketEngine: Writing poll:  has data: false\n2018-12-17 18:29:32.466337+0530 DemoApp[19774:531319] LOG SocketEnginePolling: Sending poll:  as type: 2\n2018-12-17 18:29:32.467099+0530 DemoApp[19774:531319] LOG SocketEnginePolling: Created POST string: 1:2\n2018-12-17 18:29:32.467649+0530 DemoApp[19774:531319] LOG SocketEnginePolling: POSTing\n2018-12-17 18:29:32.468153+0530 DemoApp[19774:531319] LOG SocketEnginePolling: Doing polling POST http://192.168.2.55:8080/socket.io/?transport=polling&b64=1&platform=4&is_background=0&user_id=33&device_name=iPhone%208%20Plus&token=0jhWvsQF04rVSwNjeJ0g5xy8lS7rPVEQ&sid=mEseJQeozIo0A9f_AAAh\n2018-12-17 18:29:32.473909+0530 DemoApp[19774:531287] LOG SocketEnginePolling: Got polling response\n2018-12-17 18:29:32.474071+0530 DemoApp[19774:531287] LOG SocketEnginePolling: Got poll message: 33:42[\"new_online\",{\"user_id\":\"33\"}]96:42[\"get_users_available_status\",{\"online\":[\"138\",\"54\",\"6\",\"46\",\"70\",\"33\",\"102\",\"157\"],\"dnd\":[]}]\n2018-12-17 18:29:32.474507+0530 DemoApp[19774:531287] LOG SocketEngine: Got message: 42[\"new_online\",{\"user_id\":\"33\"}]\n2018-12-17 18:29:32.474915+0530 DemoApp[19774:531287] LOG SocketEngine: Got message: 42[\"get_users_available_status\",{\"online\":[\"138\",\"54\",\"6\",\"46\",\"70\",\"33\",\"102\",\"157\"],\"dnd\":[]}]\n2018-12-17 18:29:32.475691+0530 DemoApp[19774:531287] LOG SocketEnginePolling: Doing polling GET http://192.168.2.55:8080/socket.io/?transport=polling&b64=1&platform=4&is_background=0&user_id=33&device_name=iPhone%208%20Plus&token=0jhWvsQF04rVSwNjeJ0g5xy8lS7rPVEQ&sid=mEseJQeozIo0A9f_AAAh\n2018-12-17 18:29:32.477364+0530 DemoApp[19774:531272] LOG SocketEngineWebSocket: Sending ws: probe as type: 2\n2018-12-17 18:29:32.480787+0530 DemoApp[19774:531272] LOG SocketEnginePolling: Got polling response\n2018-12-17 18:29:32.480953+0530 DemoApp[19774:531272] LOG SocketEnginePolling: Got poll message: 1:3\n2018-12-17 18:29:32.481096+0530 DemoApp[19774:531272] LOG SocketEngine: Got message: 3\n2018-12-17 18:29:32.481595+0530 DemoApp[19774:531272] LOG SocketEnginePolling: Doing polling GET http://192.168.2.55:8080/socket.io/?transport=polling&b64=1&platform=4&is_background=0&user_id=33&device_name=iPhone%208%20Plus&token=0jhWvsQF04rVSwNjeJ0g5xy8lS7rPVEQ&sid=mEseJQeozIo0A9f_AAAh\n2018-12-17 18:29:32.482911+0530 DemoApp[19774:531287] LOG SocketEngine: Got message: 3probe\n2018-12-17 18:29:32.484339+0530 DemoApp[19774:531287] LOG SocketEngine: Received probe response, should upgrade to WebSockets\n2018-12-17 18:29:32.484906+0530 DemoApp[19774:531287] LOG SocketEngine: Upgrading transport to WebSockets\n2018-12-17 18:29:32.485541+0530 DemoApp[19774:531287] LOG SocketEnginePolling: Sending poll:  as type: 6\n2018-12-17 18:29:32.486476+0530 DemoApp[19774:531287] LOG SocketEnginePolling: Created POST string: 1:6\n2018-12-17 18:29:32.487036+0530 DemoApp[19774:531287] LOG SocketEnginePolling: POSTing\n2018-12-17 18:29:32.595194+0530 DemoApp[19774:531319] LOG SocketEnginePolling: Got polling response\n2018-12-17 18:29:32.595452+0530 DemoApp[19774:531319] LOG SocketEnginePolling: Got poll message: 1:6\n2018-12-17 18:29:32.595708+0530 DemoApp[19774:531319] LOG SocketEngine: Got message: 6\n2018-12-17 18:29:32.595830+0530 DemoApp[19774:531319] LOG SocketEngine: Switching to WebSockets\n2018-12-17 18:29:32.595944+0530 DemoApp[19774:531319] LOG SocketEngineWebSocket: Sending ws:  as type: 5\n2018-12-17 18:29:32.596127+0530 DemoApp[19774:531319] LOG SocketEngine: Flushing probe wait\n2018-12-17 18:29:32.731544+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-12-17 18:29:32.732017+0530 DemoApp[19774:531010] LOG SocketManager: Engine opened Connect\n2018-12-17 18:29:32.732325+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Socket connected\n2018-12-17 18:29:32.732593+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: statusChange with data: [connected]\n2018-12-17 18:29:32.733592+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: connect with data: [\"/\"]\n2018-12-17 18:29:32.734872+0530 DemoApp[19774:531010] socket connceted :: mEseJQeozIo0A9f_AAAh\n2018-12-17 18:29:32.735146+0530 DemoApp[19774:531010] the suer ID 33\n2018-12-17 18:29:32.736040+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Emitting: 21[\"version_management\",{\"app_version\":\"1.1.10\"}]\n2018-12-17 18:29:32.736352+0530 DemoApp[19774:531319] LOG SocketEngine: Writing ws: 21[\"version_management\",{\"app_version\":\"1.1.10\"}] has data: false\n2018-12-17 18:29:32.736499+0530 DemoApp[19774:531319] LOG SocketEngineWebSocket: Sending ws: 21[\"version_management\",{\"app_version\":\"1.1.10\"}] as type: 4\n2018-12-17 18:29:32.736636+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Emitting: 2[\"get_new_users_available_status\",{\"user_id\":\"33\",\"token\":\"0jhWvsQF04rVSwNjeJ0g5xy8lS7rPVEQ\"}]\n2018-12-17 18:29:33.179058+0530 DemoApp[19774:531319] LOG SocketEngine: Writing ws: 2[\"get_new_users_available_status\",{\"user_id\":\"33\",\"token\":\"0jhWvsQF04rVSwNjeJ0g5xy8lS7rPVEQ\"}] has data: false\n2018-12-17 18:29:33.179137+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Emitting: 2[\"sync_undelivered_messages\",{\"user_id\":\"33\"}]\n2018-12-17 18:29:33.179223+0530 DemoApp[19774:531319] LOG SocketEngineWebSocket: Sending ws: 2[\"get_new_users_available_status\",{\"user_id\":\"33\",\"token\":\"0jhWvsQF04rVSwNjeJ0g5xy8lS7rPVEQ\"}] as type: 4\n2018-12-17 18:29:33.179343+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Emitting: 2[\"user_unread_messages_count\",{\"user_id\":\"33\"}]\n2018-12-17 18:29:33.179380+0530 DemoApp[19774:531319] LOG SocketEngine: Writing ws: 2[\"sync_undelivered_messages\",{\"user_id\":\"33\"}] has data: false\n2018-12-17 18:29:33.179572+0530 DemoApp[19774:531319] LOG SocketEngineWebSocket: Sending ws: 2[\"sync_undelivered_messages\",{\"user_id\":\"33\"}] as type: 4\n2018-12-17 18:29:33.179754+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Emitting: 22[\"get_all_burnouts\",{}]\n2018-12-17 18:29:33.179986+0530 DemoApp[19774:531319] LOG SocketEngine: Writing ws: 2[\"user_unread_messages_count\",{\"user_id\":\"33\"}] has data: false\n2018-12-17 18:29:33.180619+0530 DemoApp[19774:531319] LOG SocketEngineWebSocket: Sending ws: 2[\"user_unread_messages_count\",{\"user_id\":\"33\"}] as type: 4\n2018-12-17 18:29:33.180948+0530 DemoApp[19774:531319] LOG SocketEngine: Writing ws: 22[\"get_all_burnouts\",{}] has data: false\n2018-12-17 18:29:33.181188+0530 DemoApp[19774:531319] LOG SocketEngineWebSocket: Sending ws: 22[\"get_all_burnouts\",{}] as type: 4\n2018-12-17 18:29:33.181472+0530 DemoApp[19774:531319] LOG SocketEngine: Got message: 431[{\"success\":false,\"message\":\"No updates\"}]\n2018-12-17 18:29:33.182015+0530 DemoApp[19774:531319] LOG SocketEngine: Got message: 42[\"get_new_users_available_status\",{\"online\":[\"6\",\"33\",\"46\",\"54\",\"70\",\"138\"],\"dnd\":[]}]\n2018-12-17 18:29:33.189109+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Emitting: 2[\"get_missing_messages\",{\"message_ids\":[\"6096\",\"6095\",\"6094\",\"6093\",\"6092\",\"6091\",\"6090\",\"6089\",\"6088\",\"6087\",\"6086\",\"6085\",\"6084\",\"6083\",\"6082\",\"6081\",\"6080\",\"6079\",\"6078\",\"6077\",\"6076\",\"6075\",\"6074\",\"6073\",\"6072\",\"6071\",\"6070\",\"6069\",\"6068\",\"6067\",\"6066\",\"6065\",\"6064\",\"6063\",\"6062\",\"6061\",\"6060\",\"6059\",\"6058\",\"6057\",\"6056\",\"6055\",\"6054\",\"6053\",\"6052\",\"6051\",\"6050\",\"6046\",\"6045\",\"6044\",\"6043\",\"6042\",\"6041\",\"6040\",\"6018\",\"6017\",\"6016\",\"6014\",\"6012\",\"6011\",\"6010\",\"6009\",\"6008\",\"6007\",\"6006\",\"6005\",\"6004\",\"6003\",\"6002\",\"6001\",\"6000\",\"5999\",\"5998\",\"5997\",\"5996\",\"5995\",\"5994\",\"5993\",\"5992\",\"5991\",\"5990\",\"5989\",\"5988\",\"5987\",\"5986\",\"5985\",\"5984\",\"5983\",\"5982\",\"5981\",\"5980\",\"5979\",\"5978\",\"5977\",\"5976\",\"5975\",\"5974\",\"5973\",\"5972\",\"5971\"],\"user_id\":\"33\"}]\n2018-12-17 18:29:33.189444+0530 DemoApp[19774:531311] LOG SocketEngine: Writing ws: 2[\"get_missing_messages\",{\"message_ids\":[\"6096\",\"6095\",\"6094\",\"6093\",\"6092\",\"6092018-12-17 18:29:33.189546+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Emitting: 23[\"get_all_burnouts\",{}]\n1\",\"6090\",\"6089\",\"6088\",\"6087\",\"6086\",\"6085\",\"6084\",\"6083\",\"6082\",\"6081\",\"6080\",\"6079\",\"6078\",\"6077\",\"6076\",\"6075\",\"6074\",\"6073\",\"6072\",\"6071\",\"6070\",\"6069\",\"6068\",\"6067\",\"6066\",\"6065\",\"6064\",\"6063\",\"6062\",\"6061\",\"6060\",\"6059\",\"6058\",\"6057\",\"6056\",\"6055\",\"6054\",\"6053\",\"6052\",\"6051\",\"6050\",\"6046\",\"6045\",\"6044\",\"6043\",\"6042\",\"6041\",\"6040\",\"6018\",\"6017\",\"6016\",\"6014\",\"6012\",\"6011\",\"6010\",\"6009\",\"6008\",\"6007\",\"6006\",\"6005\",\"6004\",\"6003\",\"6002\",\"6001\",\"6000\",\"5999\",\"5998\",\"5997\",\"5996\",\"5995\",\"5994\",\"5993\",\"5992\",\"5991\",\"5990\",\"5989\",\"5988\",\"5987\",\"5986\",\"5985\",\"5984\",\"5983\",\"5982\",\"5981\",\"5980\",\"5979\",\"5978\",\"5977\",\"5976\",\"5975\",\"5974\",\"5973\",\"5972\",\"5971\"],\"user_id\":\"33\"}] has data: false\n2018-12-17 18:29:33.190062+0530 DemoApp[19774:531311] LOG SocketEngineWebSocket: Sending ws: 2[\"get_missing_messages\",{\"message_ids\":[\"6096\",\"6095\",\"6094\",\"6093\",\"6092\",\"6091\",\"6090\",\"6089\",\"6088\",\"6087\",\"6086\",\"6085\",\"6084\",\"6083\",\"6082\",\"6081\",\"6080\",\"6079\",\"6078\",\"6077\",\"6076\",\"6075\",\"6074\",\"6073\",\"6072\",\"6071\",\"6070\",\"6069\",\"6068\",\"6067\",\"6066\",\"6065\",\"6064\",\"6063\",\"6062\",\"6061\",\"6060\",\"6059\",\"6058\",\"6057\",\"6056\",\"6055\",\"6054\",\"6053\",\"6052\",\"6051\",\"6050\",\"6046\",\"6045\",\"6044\",\"6043\",\"6042\",\"6041\",\"6040\",\"6018\",\"6017\",\"6016\",\"6014\",\"6012\",\"6011\",\"6010\",\"6009\",\"6008\",\"6007\",\"6006\",\"6005\",\"6004\",\"6003\",\"6002\",\"6001\",\"6000\",\"5999\",\"5998\",\"5997\",\"5996\",\"5995\",\"5994\",\"5993\",\"5992\",\"5991\",\"5990\",\"5989\",\"5988\",\"5987\",\"5986\",\"5985\",\"5984\",\"5983\",\"5982\",\"5981\",\"5980\",\"5979\",\"5978\",\"5977\",\"5976\",\"5975\",\"5974\",\"5973\",\"5972\",\"5971\"],\"user_id\":\"33\"}] as type: 4\n2018-12-17 18:29:33.190078+0530 DemoApp[19774:531010] LOG SocketParser: Parsing 0\n2018-12-17 18:29:33.211417+0530 DemoApp[19774:531010] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2018-12-17 18:29:33.211429+0530 DemoApp[19774:531311] LOG SocketEngine: Writing ws: 23[\"get_all_burnouts\",{}] has data: false\n2018-12-17 18:29:33.211589+0530 DemoApp[19774:531010] LOG SocketParser: Parsing 2[\"new_online\",{\"user_id\":\"33\"}]\n2018-12-17 18:29:33.211639+0530 DemoApp[19774:531311] LOG SocketEngineWebSocket: Sending ws: 23[\"get_all_burnouts\",{}] as type: 4\n2018-12-17 18:29:33.211935+0530 DemoApp[19774:531311] LOG SocketEngine: Got message: 42[\"user_unread_messages_count\",[{\"unread_messages\":1,\"entity_type\":1,\"entity_id\":6}]]\n2018-12-17 18:29:33.211943+0530 DemoApp[19774:531010] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [new_online, {\n    \"user_id\" = 33;\n}]; id: -1; placeholders: -1; nsp: /}\n2018-12-17 18:29:33.212078+0530 DemoApp[19774:531311] LOG SocketEngine: Got message: 432[{\"success\":true,\"data\":[]}]\n2018-12-17 18:29:33.212550+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: new_online with data: [{\n    \"user_id\" = 33;\n}]\n2018-12-17 18:29:33.213315+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Emitting: 2[\"get_new_users_available_status\",{\"user_id\":\"33\",\"token\":\"0jhWvsQF04rVSwNjeJ0g5xy8lS7rPVEQ\"}]\n2018-12-17 18:29:33.213497+0530 DemoApp[19774:531311] LOG SocketEngine: Writing ws: 2[\"get_new_users_available_status\",{\"user_id\":\"33\",\"token\":\"0jhWvsQF04rVSwNjeJ0g5xy8lS7rPVEQ\"}] has data: false\n2018-12-17 18:29:33.213524+0530 DemoApp[19774:531010] LOG SocketParser: Parsing 2[\"get_users_available_status\",{\"online\":[\"138\",\"54\",\"6\",\"46\",\"70\",\"33\",\"102\",\"157\"],\"dnd\":[]}]\n2018-12-17 18:29:33.213628+0530 DemoApp[19774:531311] LOG SocketEngineWebSocket: Sending ws: 2[\"get_new_users_available_status\",{\"user_id\":\"33\",\"token\":\"0jhWvsQF04rVSwNjeJ0g5xy8lS7rPVEQ\"}] as type: 4\n2018-12-17 18:29:33.213800+0530 DemoApp[19774:531010] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [get_users_available_status, {\n    dnd =     (\n    );\n    online =     (\n        138,\n        54,\n        6,\n        46,\n        70,\n        33,\n        102,\n        157\n    );\n}]; id: -1; placeholders: -1; nsp: /}\n2018-12-17 18:29:33.214281+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: get_users_available_status with data: [{\n    dnd =     (\n    );\n    online =     (\n        138,\n        54,\n        6,\n        46,\n        70,\n        33,\n        102,\n        157\n    );\n}]\n2018-12-17 18:29:33.214515+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-12-17 18:29:33.214775+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-12-17 18:29:33.216315+0530 DemoApp[19774:531010] LOG SocketParser: Parsing 31[{\"success\":false,\"message\":\"No updates\"}]\n2018-12-17 18:29:33.216588+0530 DemoApp[19774:531010] LOG SocketParser: Decoded packet as: SocketPacket {type: 3; data: [{\n    message = \"No updates\";\n    success = 0;\n}]; id: 1; placeholders: -1; nsp: /}\n2018-12-17 18:29:33.216737+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling ack: 1 with data: [{\n    message = \"No updates\";\n    success = 0;\n}]\n2018-12-17 18:29:33.216970+0530 DemoApp[19774:531010] teh data is (\n        {\n        message = \"No updates\";\n        success = 0;\n    }\n)\n2018-12-17 18:29:33.217126+0530 DemoApp[19774:531010] LOG SocketParser: Parsing 2[\"get_new_users_available_status\",{\"online\":[\"6\",\"33\",\"46\",\"54\",\"70\",\"138\"],\"dnd\":[]}]\n2018-12-17 18:29:33.217340+0530 DemoApp[19774:531010] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [get_new_users_available_status, {\n    dnd =     (\n    );\n    online =     (\n        6,\n        33,\n        46,\n        54,\n        70,\n        138\n    );\n}]; id: -1; placeholders: -1; nsp: /}\n2018-12-17 18:29:33.217502+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: get_new_users_available_status with data: [{\n    dnd =     (\n    );\n    online =     (\n        6,\n        33,\n        46,\n        54,\n        70,\n        138\n    );\n}]\n2018-12-17 18:29:33.218054+0530 DemoApp[19774:531010] LOG SocketParser: Parsing 2[\"user_unread_messages_count\",[{\"unread_messages\":1,\"entity_type\":1,\"entity_id\":6}]]\n2018-12-17 18:29:33.218399+0530 DemoApp[19774:531010] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [user_unread_messages_count, <__NSArrayM 0x6000034e4960>(\n{\n    \"entity_id\" = 6;\n    \"entity_type\" = 1;\n    \"unread_messages\" = 1;\n}\n)\n]; id: -1; placeholders: -1; nsp: /}\n2018-12-17 18:29:33.218611+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: user_unread_messages_count with data: [<__NSArrayM 0x6000034e4960>(\n{\n    \"entity_id\" = 6;\n    \"entity_type\" = 1;\n    \"unread_messages\" = 1;\n}\n)\n]\n2018-12-17 18:29:33.219228+0530 DemoApp[19774:531010] LOG SocketParser: Parsing 32[{\"success\":true,\"data\":[]}]\n2018-12-17 18:29:33.219461+0530 DemoApp[19774:531010] LOG SocketParser: Decoded packet as: SocketPacket {type: 3; data: [{\n    data =     (\n    );\n    success = 1;\n}]; id: 2; placeholders: -1; nsp: /}\n2018-12-17 18:29:33.219610+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling ack: 2 with data: [{\n    data =     (\n    );\n    success = 1;\n}]\n2018-12-17 18:29:33.219755+0530 DemoApp[19774:531010] get all burnout list (\n        {\n        data =         (\n        );\n        success = 1;\n    }\n)\n2018-12-17 18:29:33.221530+0530 DemoApp[19774:531010] Statement FAILED is message exist or not (no more rows available)\n2018-12-17 18:29:33.253000+0530 DemoApp[19774:531319] LOG SocketEngine: Got message: 433[{\"success\":true,\"data\":[]}]\n2018-12-17 18:29:33.253424+0530 DemoApp[19774:531319] LOG SocketEngine: Got message: 42[\"get_new_users_available_status\",{\"online\":[\"6\",\"33\",\"46\",\"54\",\"70\",\"138\"],\"dnd\":[]}]\n2018-12-17 18:29:33.277393+0530 DemoApp[19774:531010] LOG SocketParser: Parsing 33[{\"success\":true,\"data\":[]}]\n2018-12-17 18:29:33.277714+0530 DemoApp[19774:531010] LOG SocketParser: Decoded packet as: SocketPacket {type: 3; data: [{\n    data =     (\n    );\n    success = 1;\n}]; id: 3; placeholders: -1; nsp: /}\n2018-12-17 18:29:33.277879+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling ack: 3 with data: [{\n    data =     (\n    );\n    success = 1;\n}]\n2018-12-17 18:29:33.278021+0530 DemoApp[19774:531010] the burn out list data is (\n        {\n        data =         (\n        );\n        success = 1;\n    }\n)\n2018-12-17 18:29:33.278139+0530 DemoApp[19774:531010] get all burnout list (\n        {\n        data =         (\n        );\n        success = 1;\n    }\n)\n2018-12-17 18:29:33.280103+0530 DemoApp[19774:531010] Statement FAILED is message exist or not (no more rows available)\n2018-12-17 18:29:33.280797+0530 DemoApp[19774:531010] LOG SocketParser: Parsing 2[\"get_new_users_available_status\",{\"online\":[\"6\",\"33\",\"46\",\"54\",\"70\",\"138\"],\"dnd\":[]}]\n2018-12-17 18:29:33.281322+0530 DemoApp[19774:531010] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [get_new_users_available_status, {\n    dnd =     (\n    );\n    online =     (\n        6,\n        33,\n        46,\n        54,\n        70,\n        138\n    );\n}]; id: -1; placeholders: -1; nsp: /}\n2018-12-17 18:29:33.281551+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: get_new_users_available_status with data: [{\n    dnd =     (\n    );\n    online =     (\n        6,\n        33,\n        46,\n        54,\n        70,\n        138\n    );\n}]\n2018-12-17 18:29:35.382499+0530 DemoApp[19774:531010] the time is 2018-12-17 18:29:32\n2018-12-17 18:29:35.382837+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Emitting: 24[\"sync_messages_by_time\",{\"time\":\"2018-12-17 18:29:32\"}]\n2018-12-17 18:29:35.383013+0530 DemoApp[19774:531311] LOG SocketEngine: Writing ws: 24[\"sync_messages_by_time\",{\"time\":\"2018-12-17 18:29:32\"}] has data: false\n2018-12-17 18:29:35.383188+0530 DemoApp[19774:531311] LOG SocketEngineWebSocket: Sending ws: 24[\"sync_messages_by_time\",{\"time\":\"2018-12-17 18:29:32\"}] as type: 4\n2018-12-17 18:29:35.408828+0530 DemoApp[19774:531294] LOG SocketEngine: Got message: 434[{\"success\":true,\"data\":[]}]\n2018-12-17 18:29:35.409207+0530 DemoApp[19774:531010] LOG SocketParser: Parsing 34[{\"success\":true,\"data\":[]}]\n2018-12-17 18:29:35.409599+0530 DemoApp[19774:531010] LOG SocketParser: Decoded packet as: SocketPacket {type: 3; data: [{\n    data =     (\n    );\n    success = 1;\n}]; id: 4; placeholders: -1; nsp: /}\n2018-12-17 18:29:35.409791+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling ack: 4 with data: [{\n    data =     (\n    );\n    success = 1;\n}]\n2018-12-17 18:29:35.409928+0530 DemoApp[19774:531010] teh delete and recall data is (\n        {\n        data =         (\n        );\n        success = 1;\n    }\n)\n2018-12-17 18:29:35.737510+0530 DemoApp[19774:531010] teh data is (\n    \"NO ACK\"\n)\n2018-12-17 18:29:35.737765+0530 DemoApp[19774:531010] LOG OnAckCallback: OnAckCallback for 0 being released\n2018-12-17 18:29:35.737978+0530 DemoApp[19774:531010] LOG OnAckCallback: OnAckCallback for 1 being released\n2018-12-17 18:29:38.437760+0530 DemoApp[19774:531010] LOG OnAckCallback: OnAckCallback for 2 being released\n2018-12-17 18:29:38.437954+0530 DemoApp[19774:531010] LOG OnAckCallback: OnAckCallback for 3 being released\n2018-12-17 18:29:38.438107+0530 DemoApp[19774:531010] LOG OnAckCallback: OnAckCallback for 4 being released\n2018-12-17 18:29:59.847673+0530 DemoApp[19774:531334] LOG SocketEngine: Writing ws:  has data: false\n2018-12-17 18:29:59.847670+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-12-17 18:29:59.847860+0530 DemoApp[19774:531334] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2018-12-17 18:29:59.849172+0530 DemoApp[19774:531334] LOG SocketEngine: Got message: 3\n2018-12-17 18:29:59.849386+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-12-17 18:30:24.848564+0530 DemoApp[19774:531294] LOG SocketEngine: Writing ws:  has data: false\n2018-12-17 18:30:24.848564+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-12-17 18:30:24.848764+0530 DemoApp[19774:531294] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2018-12-17 18:30:24.850042+0530 DemoApp[19774:531294] LOG SocketEngine: Got message: 3\n2018-12-17 18:30:24.850216+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-12-17 18:30:28.426799+0530 DemoApp[19774:531010] appdelegate search string is\n2018-12-17 18:30:31.546341+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Closing socket\n2018-12-17 18:30:31.546596+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Disconnected: Namespace leave\n2018-12-17 18:30:31.546642+0530 DemoApp[19774:531785] LOG SocketEngine: Writing ws: 1/, has data: false\n2018-12-17 18:30:31.546739+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: statusChange with data: [disconnected]\n2018-12-17 18:30:31.546750+0530 DemoApp[19774:531785] LOG SocketEngineWebSocket: Sending ws: 1/, as type: 4\n2018-12-17 18:30:31.546888+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: disconnect with data: [\"Namespace leave\"]\n2018-12-17 18:30:31.547012+0530 DemoApp[19774:531010] the socket disconnect (\n    \"Namespace leave\"\n) ***\n2018-12-17 18:30:31.548116+0530 DemoApp[19774:531010] socket starting disconnect\n2018-12-17 18:30:31.549144+0530 DemoApp[19774:531010] socket disconnected from client\n2018-12-17 18:30:31.551054+0530 DemoApp[19774:531010] Statement FAILED is message exist or not (no more rows available)\n2018-12-17 18:30:31.946163+0530 DemoApp[19774:531010] Statement FAILED is message exist or not (no more rows available)\n2018-12-17 18:30:31.972611+0530 DemoApp[19774:531010] [<__NSCFString 0x60000342bdb0> valueForUndefinedKey:]: this class is not key value coding-compliant for the key api_key.\n2018-12-17 18:30:31.973424+0530 DemoApp[19774:531010] the socket is is (null) ** (null)\n2018-12-17 18:30:32.007298+0530 DemoApp[19774:531294] the data is voip not exist {\n    errorCode = 2;\n    message = \"UnAuthorized Request\";\n    success = 0;\n}\n2018-12-17 18:30:32.166431+0530 DemoApp[19774:531010] [MC] System group container for systemgroup.com.apple.configurationprofiles path is /Users/narasimhudu/Library/Developer/CoreSimulator/Devices/F530DA8D-7614-484D-8E73-2F919CC2C0AD/data/Containers/Shared/SystemGroup/systemgroup.com.apple.configurationprofiles\n2018-12-17 18:30:32.166916+0530 DemoApp[19774:531010] [MC] Reading from private effective user settings.\n2018-12-17 18:30:45.412006+0530 DemoApp[19774:531010] LOG SocketManager: Starting reconnect\n2018-12-17 18:30:45.412177+0530 DemoApp[19774:531010] LOG SocketManager: Trying to reconnect\n2018-12-17 18:30:45.412401+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [-1]\n2018-12-17 18:30:45.412698+0530 DemoApp[19774:531785] LOG SocketEngine: Starting engine. Server: http://192.168.2.55:8080\n2018-12-17 18:30:45.412806+0530 DemoApp[19774:531785] LOG SocketEngine: Handshaking\n2018-12-17 18:30:45.413082+0530 DemoApp[19774:531785] LOG SocketEnginePolling: Doing polling GET http://192.168.2.55:8080/socket.io/?transport=polling&b64=1&platform=4&is_background=0&user_id=33&device_name=iPhone%208%20Plus&token=0jhWvsQF04rVSwNjeJ0g5xy8lS7rPVEQ\n2018-12-17 18:30:45.518390+0530 DemoApp[19774:532341] [] nw_socket_handle_socket_event [C11:2] Socket SO_ERROR [61: Connection refused]\n2018-12-17 18:30:45.519352+0530 DemoApp[19774:532341] TIC TCP Conn Failed [11:0x600000fab300]: 1:61 Err(61)\n2018-12-17 18:30:45.521195+0530 DemoApp[19774:532341] Task <97D240BE-3490-4377-8781-DD183D4D22CB>.<1> HTTP load failed (error code: -1004 [1:61])\n2018-12-17 18:30:45.521463+0530 DemoApp[19774:531785] Task <97D240BE-3490-4377-8781-DD183D4D22CB>.<1> finished with error - code: -1004\n2018-12-17 18:30:45.539693+0530 DemoApp[19774:532341] ERROR SocketEnginePolling: Could not connect to the server.\n2018-12-17 18:30:45.539977+0530 DemoApp[19774:532341] ERROR SocketEngine: Could not connect to the server.\n2018-12-17 18:30:45.540139+0530 DemoApp[19774:531010] ERROR SocketManager: Could not connect to the server.\n2018-12-17 18:30:45.540276+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: error with data: [\"Could not connect to the server.\"]\n2018-12-17 18:30:55.413137+0530 DemoApp[19774:531010] LOG SocketManager: Trying to reconnect\n2018-12-17 18:30:55.413339+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [-2]\n2018-12-17 18:30:55.413571+0530 DemoApp[19774:532342] LOG SocketEngine: Starting engine. Server: http://192.168.2.55:8080\n2018-12-17 18:30:55.413702+0530 DemoApp[19774:532342] LOG SocketEngine: Handshaking\n2018-12-17 18:30:55.414041+0530 DemoApp[19774:532342] LOG SocketEnginePolling: Doing polling GET http://192.168.2.55:8080/socket.io/?transport=polling&b64=1&platform=4&is_background=0&user_id=33&device_name=iPhone%208%20Plus&token=0jhWvsQF04rVSwNjeJ0g5xy8lS7rPVEQ\n2018-12-17 18:30:55.421212+0530 DemoApp[19774:532454] LOG SocketEnginePolling: Got polling response\n2018-12-17 18:30:55.421365+0530 DemoApp[19774:532454] LOG SocketEnginePolling: Got poll message: 96:0{\"sid\":\"WZiCBS7K7Qvt8gqRAAAG\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":5000}2:40\n2018-12-17 18:30:55.421529+0530 DemoApp[19774:532454] LOG SocketEngine: Got message: 0{\"sid\":\"WZiCBS7K7Qvt8gqRAAAG\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":5000}\n2018-12-17 18:30:55.422910+0530 DemoApp[19774:532454] LOG SocketEngine: Got message: 40\n2018-12-17 18:30:55.422910+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: ping with data: []\n2018-12-17 18:30:55.423165+0530 DemoApp[19774:532454] LOG SocketEnginePolling: Doing polling GET http://192.168.2.55:8080/socket.io/?transport=polling&b64=1&platform=4&is_background=0&user_id=33&device_name=iPhone%208%20Plus&token=0jhWvsQF04rVSwNjeJ0g5xy8lS7rPVEQ&sid=WZiCBS7K7Qvt8gqRAAAG\n2018-12-17 18:30:55.429243+0530 DemoApp[19774:531010] LOG SocketManager: Engine opened Connect\n2018-12-17 18:30:55.429384+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Socket connected\n2018-12-17 18:30:55.429502+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: statusChange with data: [connected]\n2018-12-17 18:30:55.429437+0530 DemoApp[19774:532454] LOG SocketEngine: Writing poll:  has data: false\n2018-12-17 18:30:55.429636+0530 DemoApp[19774:532454] LOG SocketEnginePolling: Sending poll:  as type: 2\n2018-12-17 18:30:55.429675+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: connect with data: [\"/\"]\n2018-12-17 18:30:55.430248+0530 DemoApp[19774:532454] LOG SocketEnginePolling: Created POST string: 1:2\n2018-12-17 18:30:55.430459+0530 DemoApp[19774:531010] socket connceted :: WZiCBS7K7Qvt8gqRAAAG\n2018-12-17 18:30:55.430920+0530 DemoApp[19774:532454] LOG SocketEnginePolling: POSTing\n2018-12-17 18:30:55.431080+0530 DemoApp[19774:531010] No user login\n2018-12-17 18:30:55.431294+0530 DemoApp[19774:532454] LOG SocketEnginePolling: Doing polling POST http://192.168.2.55:8080/socket.io/?transport=polling&b64=1&platform=4&is_background=0&user_id=33&device_name=iPhone%208%20Plus&token=0jhWvsQF04rVSwNjeJ0g5xy8lS7rPVEQ&sid=WZiCBS7K7Qvt8gqRAAAG\n2018-12-17 18:30:55.431639+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Emitting: 2[\"force_disconnect\"]\n2018-12-17 18:30:55.432026+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Closing socket\n2018-12-17 18:30:55.432241+0530 DemoApp[19774:532454] LOG SocketEngineWebSocket: Sending ws: probe as type: 2\n2018-12-17 18:30:55.432421+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Disconnected: Namespace leave\n2018-12-17 18:30:55.433015+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: statusChange with data: [disconnected]\n2018-12-17 18:30:55.433246+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: disconnect with data: [\"Namespace leave\"]\n2018-12-17 18:30:55.433526+0530 DemoApp[19774:531010] the socket disconnect (\n    \"Namespace leave\"\n) *\n2018-12-17 18:30:55.434664+0530 DemoApp[19774:531010] socket starting disconnect\n-------------------- socket server restarted --------------------\n2018-12-17 18:30:55.435118+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: error with data: [\"Tried emitting when not connected\"]\n2018-12-17 18:30:55.435140+0530 DemoApp[19774:532454] LOG SocketEngine: Got message: 3probe\n2018-12-17 18:30:55.435357+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: error with data: [\"Tried emitting get_new_users_available_status when not connected\"]\n2018-12-17 18:30:55.435518+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: error with data: [\"Tried emitting user_unread_messages_count when not connected\"]\n2018-12-17 18:30:55.435798+0530 DemoApp[19774:532454] LOG SocketEngine: Received probe response, should upgrade to WebSockets\n2018-12-17 18:30:55.436721+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: error with data: [\"Tried emitting when not connected\"]\n2018-12-17 18:30:55.436977+0530 DemoApp[19774:531010] LOG SocketParser: Parsing 0\n2018-12-17 18:30:55.436977+0530 DemoApp[19774:532454] LOG SocketEngine: Upgrading transport to WebSockets\n2018-12-17 18:30:55.437139+0530 DemoApp[19774:531010] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2018-12-17 18:30:55.437244+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Socket connected\n2018-12-17 18:30:55.437372+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: statusChange with data: [connected]\n2018-12-17 18:30:55.437437+0530 DemoApp[19774:532454] LOG SocketEnginePolling: Sending poll:  as type: 6\n2018-12-17 18:30:55.437508+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: connect with data: [\"/\"]\n2018-12-17 18:30:55.437707+0530 DemoApp[19774:531010] socket connceted :: WZiCBS7K7Qvt8gqRAAAG\n2018-12-17 18:30:55.438277+0530 DemoApp[19774:531010] No user login\n2018-12-17 18:30:55.438470+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Emitting: 2[\"force_disconnect\"]\n2018-12-17 18:30:55.438637+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Closing socket\n2018-12-17 18:30:55.439020+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Disconnected: Namespace leave\n2018-12-17 18:30:55.439166+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: statusChange with data: [disconnected]\n2018-12-17 18:30:55.439466+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: disconnect with data: [\"Namespace leave\"]\n2018-12-17 18:30:55.439638+0530 DemoApp[19774:531010] the socket disconnect (\n    \"Namespace leave\"\n) *\n2018-12-17 18:30:55.439937+0530 DemoApp[19774:531010] socket starting disconnect\n2018-12-17 18:30:55.440624+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: error with data: [\"Tried emitting when not connected\"]\n2018-12-17 18:30:55.440887+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: error with data: [\"Tried emitting get_new_users_available_status when not connected\"]\n2018-12-17 18:30:55.441063+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: error with data: [\"Tried emitting user_unread_messages_count when not connected\"]\n2018-12-17 18:30:55.442225+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: error with data: [\"Tried emitting when not connected\"]\n2018-12-17 18:30:55.442514+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: pong with data: []\n2018-12-17 18:30:55.651695+0530 DemoApp[19774:532342] LOG SocketEnginePolling: Got polling response\n2018-12-17 18:30:55.651879+0530 DemoApp[19774:532342] LOG SocketEnginePolling: Got poll message: 33:42[\"new_online\",{\"user_id\":\"33\"}]78:42[\"get_users_available_status\",{\"online\":[\"46\",\"6\",\"54\",\"70\",\"33\"],\"dnd\":[]}]\n2018-12-17 18:30:55.652038+0530 DemoApp[19774:532342] LOG SocketEngine: Got message: 42[\"new_online\",{\"user_id\":\"33\"}]\n2018-12-17 18:30:55.652233+0530 DemoApp[19774:531010] LOG SocketParser: Parsing 2[\"new_online\",{\"user_id\":\"33\"}]\n2018-12-17 18:30:55.652275+0530 DemoApp[19774:532342] LOG SocketEngine: Got message: 42[\"get_users_available_status\",{\"online\":[\"46\",\"6\",\"54\",\"70\",\"33\"],\"dnd\":[]}]\n2018-12-17 18:30:55.653011+0530 DemoApp[19774:531010] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [new_online, {\n    \"user_id\" = 33;\n}]; id: -1; placeholders: -1; nsp: /}\n2018-12-17 18:30:55.653107+0530 DemoApp[19774:532342] LOG SocketEngine: Switching to WebSockets\n2018-12-17 18:30:55.653988+0530 DemoApp[19774:531010] LOG SocketParser: Parsing 2[\"get_users_available_status\",{\"online\":[\"46\",\"6\",\"54\",\"70\",\"33\"],\"dnd\":[]}]\n2018-12-17 18:30:55.654291+0530 DemoApp[19774:532342] LOG SocketEngineWebSocket: Sending ws:  as type: 5\n2018-12-17 18:30:55.654946+0530 DemoApp[19774:531010] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [get_users_available_status, {\n    dnd =     (\n    );\n    online =     (\n        46,\n        6,\n        54,\n        70,\n        33\n    );\n}]; id: -1; placeholders: -1; nsp: /}\n2018-12-17 18:30:55.655207+0530 DemoApp[19774:532342] LOG SocketEngine: Flushing probe wait\n2018-12-17 18:30:55.656568+0530 DemoApp[19774:532342] LOG SocketEngine: Writing ws: 2[\"force_disconnect\"] has data: false\n2018-12-17 18:30:55.669594+0530 DemoApp[19774:532342] LOG SocketEngineWebSocket: Sending ws: 2[\"force_disconnect\"] as type: 4\n2018-12-17 18:30:55.669801+0530 DemoApp[19774:532342] LOG SocketEngine: Writing ws: 1/, has data: false\n2018-12-17 18:30:55.669947+0530 DemoApp[19774:532342] LOG SocketEngineWebSocket: Sending ws: 1/, as type: 4\n2018-12-17 18:30:55.670105+0530 DemoApp[19774:532342] LOG SocketEngine: Writing ws: 2[\"force_disconnect\"] has data: false\n2018-12-17 18:30:55.670234+0530 DemoApp[19774:532342] LOG SocketEngineWebSocket: Sending ws: 2[\"force_disconnect\"] as type: 4\n2018-12-17 18:30:55.670399+0530 DemoApp[19774:532342] LOG SocketEngine: Writing ws: 1/, has data: false\n2018-12-17 18:30:55.670552+0530 DemoApp[19774:532342] LOG SocketEngineWebSocket: Sending ws: 1/, as type: 4\n2018-12-17 18:30:57.501370+0530 DemoApp[19774:531010] the time is 2018-12-17 18:30:55\n2018-12-17 18:30:57.501665+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: error with data: [\"Tried emitting when not connected\"]\n2018-12-17 18:30:57.502397+0530 DemoApp[19774:531010] the time is 2018-12-17 18:30:55\n2018-12-17 18:30:57.502648+0530 DemoApp[19774:531010] LOG SocketIOClient{/}: Handling event: error with data: [\"Tried emitting when not connected\"]\n2018-12-17 18:30:58.595905+0530 DemoApp[19774:531010] teh data is (\n    \"NO ACK\"\n)\n2018-12-17 18:30:58.596527+0530 DemoApp[19774:531010] LOG OnAckCallback: OnAckCallback for 5 being released\n2018-12-17 18:30:58.596898+0530 DemoApp[19774:531010] teh data is (\n    \"NO ACK\"\n)\n2018-12-17 18:30:58.597279+0530 DemoApp[19774:531010] LOG OnAckCallback: OnAckCallback for 7 being released\n2018-12-17 18:31:00.631464+0530 DemoApp[19774:531010] the burn out list data is (\n    \"NO ACK\"\n)\n2018-12-17 18:31:00.631733+0530 DemoApp[19774:531010] LOG OnAckCallback: OnAckCallback for 6 being released\n2018-12-17 18:31:00.631887+0530 DemoApp[19774:531010] the burn out list data is (\n    \"NO ACK\"\n)\n2018-12-17 18:31:00.632006+0530 DemoApp[19774:531010] LOG OnAckCallback: OnAckCallback for 8 being released\n2018-12-17 18:31:00.632120+0530 DemoApp[19774:531010] teh delete and recall data is (\n    \"NO ACK\"\n)\n2018-12-17 18:31:00.632245+0530 DemoApp[19774:531010] LOG OnAckCallback: OnAckCallback for 9 being released\n2018-12-17 18:31:00.632362+0530 DemoApp[19774:531010] teh delete and recall data is (\n    \"NO ACK\"\n)\n2018-12-17 18:31:00.632474+0530 DemoApp[19774:531010] LOG OnAckCallback: OnAckCallback for 10 being released\n2018-12-17 18:31:01.817526+0530 DemoApp[19774:531010] [<__NSCFString 0x6000034fee20> valueForUndefinedKey:]: this class is not key value coding-compliant for the key api_key.\n2018-12-17 18:31:01.818563+0530 DemoApp[19774:531010] [<__NSCFString 0x6000034fd800> valueForUndefinedKey:]: this class is not key value coding-compliant for the key api_key.\n. Hi nuclerace! Have you seen the client log?. Thanks nuclearace, however manually calling removeAllHandlers did not solve the issue. Now at client app we are not receiving onConnect** callback after socket.io server restarts, but at the server end the client is reconnected with a new socketID after server is restarted.. ",
    "mlabgamestudio": "Here are logs when socket.io connected in didbecomeactive\n`2018-06-01 23:21:33.597953+0300 DeryaAbla2[12069:6764425] LOG SocketManager: Tried connecting socket when engine isn't open. Connecting\n2018-06-01 23:21:33.598027+0300 DeryaAbla2[12069:6764425] LOG SocketManager: Adding engine\n2018-06-01 23:21:33.599022+0300 DeryaAbla2[12069:6764602] LOG SocketEngine: Starting engine. Server: http://localhost:8080\n2018-06-01 23:21:33.599063+0300 DeryaAbla2[12069:6764602] LOG SocketEngine: Handshaking\n2018-06-01 23:21:33.599421+0300 DeryaAbla2[12069:6764602] LOG SocketEnginePolling: Doing polling GET http://localhost:8080/socket.io/?transport=polling&b64=1\nok\n2018-06-01 23:21:33.657735+0300 DeryaAbla2[12069:6764602] LOG SocketEnginePolling: Got polling response\n2018-06-01 23:21:33.657826+0300 DeryaAbla2[12069:6764602] LOG SocketEnginePolling: Got poll message: 97:0{\"sid\":\"9pE72mTnh1Dko8ZiPVQu\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}2:40\n2018-06-01 23:21:33.659479+0300 DeryaAbla2[12069:6764602] LOG SocketEngine: Got message: 0{\"sid\":\"9pE72mTnh1Dko8ZiPVQu\",\"upgrades\":[\"websocket\"],\"pingInterval\":25000,\"pingTimeout\":60000}\nsocket deniyor\n2018-06-01 23:21:33.664398+0300 DeryaAbla2[12069:6764602] LOG SocketEngine: Got message: 40\n2018-06-01 23:21:33.664507+0300 DeryaAbla2[12069:6764602] LOG SocketEnginePolling: Doing polling GET http://localhost:8080/socket.io/?transport=polling&b64=1&sid=9pE72mTnh1Dko8ZiPVQu\n2018-06-01 23:21:33.712544+0300 DeryaAbla2[12069:6764602] LOG SocketEngine: Writing poll:  has data: false\n2018-06-01 23:21:33.713464+0300 DeryaAbla2[12069:6764602] LOG SocketEnginePolling: Sending poll:  as type: 2\n2018-06-01 23:21:33.719018+0300 DeryaAbla2[12069:6764602] LOG SocketEnginePolling: Created POST string: 1:2\n2018-06-01 23:21:33.721543+0300 DeryaAbla2[12069:6764602] LOG SocketEnginePolling: POSTing\n2018-06-01 23:21:33.721604+0300 DeryaAbla2[12069:6764602] LOG SocketEnginePolling: Doing polling POST http://localhost:8080/socket.io/?transport=polling&b64=1&sid=9pE72mTnh1Dko8ZiPVQu\n2018-06-01 23:21:33.730643+0300 DeryaAbla2[12069:6764425] LOG SocketManager: Engine opened Connect\nsocket connected [\"/\"]\n2018-06-01 23:21:33.730952+0300 DeryaAbla2[12069:6764425] LOG SocketParser: Parsing 0\n2018-06-01 23:21:33.731127+0300 DeryaAbla2[12069:6764425] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n[{\n    baslik = \"\";\n    cikis = \"\";\n    mesaj = \"\";\n}]\nGELD\u0130\u0130\u0130\n2018-06-01 23:21:33.797683+0300 DeryaAbla2[12069:6764616] LOG SocketEngineWebSocket: Sending ws: probe as type: 2\n2018-06-01 23:21:33.804219+0300 DeryaAbla2[12069:6764658] LOG SocketEnginePolling: Got polling response\n2018-06-01 23:21:33.804276+0300 DeryaAbla2[12069:6764658] LOG SocketEnginePolling: Got poll message: 1:3\n2018-06-01 23:21:33.804337+0300 DeryaAbla2[12069:6764658] LOG SocketEngine: Got message: 3\n2018-06-01 23:21:33.804727+0300 DeryaAbla2[12069:6764658] LOG SocketEnginePolling: Doing polling GET http://localhost:8080/socket.io/?transport=polling&b64=1&sid=9pE72mTnh1Dko8ZiPVQu\n2018-06-01 23:21:33.826484+0300 DeryaAbla2[12069:6764616] LOG SocketEngine: Got message: 3probe\n2018-06-01 23:21:33.826548+0300 DeryaAbla2[12069:6764616] LOG SocketEngine: Received probe response, should upgrade to WebSockets\n2018-06-01 23:21:33.826592+0300 DeryaAbla2[12069:6764616] LOG SocketEngine: Upgrading transport to WebSockets\n2018-06-01 23:21:33.826616+0300 DeryaAbla2[12069:6764616] LOG SocketEnginePolling: Sending poll:  as type: 6\n2018-06-01 23:21:33.826647+0300 DeryaAbla2[12069:6764616] LOG SocketEnginePolling: Created POST string: 1:6\n2018-06-01 23:21:33.827074+0300 DeryaAbla2[12069:6764616] LOG SocketEnginePolling: POSTing\nTTTTTTTTTTTTTT [{\n    tarihcek = \"01.06.2018\";\n}]\n2018-06-01 23:21:33.926479+0300 DeryaAbla2[12069:6764600] LOG SocketEnginePolling: Got polling response\n2018-06-01 23:21:33.926535+0300 DeryaAbla2[12069:6764600] LOG SocketEnginePolling: Got poll message: 1:6\n2018-06-01 23:21:33.926688+0300 DeryaAbla2[12069:6764600] LOG SocketEngine: Got message: 6\n2018-06-01 23:21:33.926732+0300 DeryaAbla2[12069:6764600] LOG SocketEngine: Switching to WebSockets\n2018-06-01 23:21:33.926758+0300 DeryaAbla2[12069:6764600] LOG SocketEngineWebSocket: Sending ws:  as type: 5\n2018-06-01 23:21:33.926826+0300 DeryaAbla2[12069:6764600] LOG SocketEngine: Flushing probe wait\n2018-06-01 23:21:35.102853+0300 DeryaAbla2[12069:6764616] TIC Read Status [2:0x0]: 1:57\n2018-06-01 23:21:35.103021+0300 DeryaAbla2[12069:6764616] TIC Read Status [2:0x0]: 1:57\n2018-06-01 23:21:49.358194+0300 DeryaAbla2[12069:6764615] TIC Read Status [12:0x0]: 1:57\n2018-06-01 23:21:49.358351+0300 DeryaAbla2[12069:6764615] TIC Read Status [12:0x0]: 1:57\n2018-06-01 23:21:59.112145+0300 DeryaAbla2[12069:6764617] LOG SocketEngine: Writing ws:  has data: false\n2018-06-01 23:21:59.112451+0300 DeryaAbla2[12069:6764617] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2018-06-01 23:21:59.146858+0300 DeryaAbla2[12069:6764617] LOG SocketEngine: Got message: 3`. By the way I had to make some change when I installed Socket.io library via pod. Because there were 17 errors at first. Do you think this can be the issue?. Any help would be great.Please. ",
    "Rupasekhar": "I still think something is setting a SWIFT_VERSION to something lower than 4.0. that \"Value of optional type 'String?' not unwrapped; did you mean to use '!' or '?'?\" was for an old version of Swift where the string init returned an optional; it shouldn't in Swift 4.0.\n\nIt resolved 17 runtime errors only, but still \"on\" is not invoking. @nuclearace Pls help us out.\n. Ya, I will Ckeck it now. Thanks for ur quick reply. I'm facing another scenario problem. \nI had initialised socketmanager and socket client in appdelegate of didfinishWithLaunchOptions, and invoked connect method in after sucessfully login. then only my ON method which is in appdelegate is getting called without any issue.\nNow i need to send loggedin userid and devicetoken in config for connectParams key. So in appdelegate of didfinishWithLaunchOptions we never get loggedin userid and devicetoken. So after login, when invoking connect method am initialising again with new connectParams and  my ON method which is in appdelegate is not getting called.\nI hope you understand my scenario. Pls do help me out.\n. Ok, whole new SocketManager, client objects have to initialise in AppDelegate only right?\nam I right?. ",
    "webtamizhan": "Still i cannot receive Authorization Header even using extraHeaders.\nself.manager = [[SocketManager alloc] initWithSocketURL:url config:@{@\"log\" : @YES, @\"nsp\" : @\"/\", @\"extraHeaders\" : @{@\"Authorization\" : token}}];\nis that right way?\nCan i have some sample code please?. ",
    "OneSman7": "Packets are lost if they were in postWait and web socket failed to connect, thus websocketDidDisconnect(error: Error?) is called.. @nuclearace  Yes. I will prepare PR.\nWe are also using forceNew flag, so on each connect a new engine is created.\nBefore rebooting our server sends engine close message to all clients. But sometimes on server reconnect old SocketEnginePolling object survives and keeps polling receiving server errors, but not reporting error events since it has no client. Thus it hangs in infinite loop until server revives. Since that moment it pings server as usual along with working engine.\nI am trying to isolate the issue and want to create PR that fixes both issues.. LOG SocketEngine: Got message: 1\nLOG SocketManager: Starting reconnect\nLOG SocketIOClient{/chat_v1}: Handling event: statusChange with data: [connecting]\nLOG SocketEnginePolling: Doing polling GET\nLOG SocketIOClient{/chat_v1}: Handling event: reconnect with data: [\"1\"]\nLOG SocketManager: Trying to reconnect\nLOG SocketIOClient{/chat_v1}: Handling event: reconnectAttempt with data: [-1]\nLOG SocketManager: Adding engine\nLOG SocketEngine: Starting engine. Server: \nLOG SocketEngine: Handshaking\nThere is no \"Engine is being released\" message after \"Adding engine\" message :(. Exactly! Thank you!\n```\nprivate func addEngine() {\n        DefaultSocketLogger.Logger.log(\"Adding engine\", type: SocketManager.logType)\n    engine?.engineQueue.sync {\n        self.engine?.client = nil\n    }\n\n    engine = SocketEngine(client: self, url: socketURL, config: config)\n}\n\n```\nWhen new engine is created, old one is left without client, but not disconnected. It then receives server error, so checkAndHandleEngineError is called.\n```\nprivate func checkAndHandleEngineError(_ msg: String) {\n        do {\n            let dict = try msg.toDictionary()\n            guard let error = dict[\"message\"] as? String else { return }\n        /*\n         0: Unknown transport\n         1: Unknown sid\n         2: Bad handshake request\n         3: Bad request\n         */\n        didError(reason: error)\n    } catch {\n        client?.engineDidError(reason: \"Got unknown error from server \\(msg)\")\n    }\n}\n\n```\nSince no json is received client?.engineDidError() is called. But this engine already has no client. So it continues with polling. Forever :)\nIf this engine receives server error before it looses client, than client handles it (our code) and disconnects engine.. I tried to disconnect old engine explicitly when creating new one and it seems to work. This seems ok since we create new one only on connect/reconnect. What do you think?\n```\nprivate func addEngine() {\n        DefaultSocketLogger.Logger.log(\"Adding engine\", type: SocketManager.logType)\n    engine?.engineQueue.sync {\n        self.engine?.client = nil\n        self.engine?.disconnect(reason: \"Adding new engine\")\n    }\n\n    engine = SocketEngine(client: self, url: socketURL, config: config)\n}\n\n```. Great \ud83d\udc4d\nCreated a PR #1034.. Added PR #1058 . >Overall looks fine. Do you think this should only be done when some config is set?\nI looked where addHeaders was called, it was only on making long poll request and creating web socket request. As for the first case, all cookies/headers work is done by URLSession, so I thought I will only make my changes where this work is not done because of Starscream.. My intention was to pass cookies to support load balancers, not to change the way long polling sessions are created.\nAccording to docs (https://developer.apple.com/documentation/foundation/httpcookiestorage) we may have cookies obtained by other means by the app or from UIWebView (which is deprecated). WKWebView do not use shared storage. Thus I see this problem as minor for most apps.\nIt may be possible to create custom session configuration from default session configuration, but it will also refer to the shared cookie storage. The problem is with httpCookieStorage property: \"For default and background sessions, the default value is the shared cookie storage object.\". I cannot see a way to create custom HTTPCookieStorage objects :(\nI'd say that the best way to mitigate your issue will be to filter cookies by domain to match request domain in addHeaders() method.\n@nuclearace @vonox7 I can create PR with these changes later today or tomorrow. I am in process of updating XCode to the latest version and migrating my project with Socket.IO to the latest Swift version. After I complete theses tasks I will make changes, test it on our server to see if load balancers still work and then create PR.. @vonox7 also look here #1080. I guess it will also fix the issue. @2h4u \n\nI wanted to say that there is no need for a critical fix. The issue may be fixed in the next update. I wanted to accentuate that it is difficult to create a session with not shared cookie storage since it will almost certainly require to implement custom cookie storage system.\nThe whole idea of this PR was to pass to web socket connection more cookies than were set in config. Cookies from config were already being passed. But load balancers installed on our servers used cookies to indicate to which machine our client should send packets after initial connection. Some upgrades to web sockets failed since request to upgrade was sent to the default machine which may not match machine it was connected to before. It happened because the request lacked cookie which would tell load balancer how to route request. These are the cookies that originated after polling connection was established, I could not assign them before connecting. #1080 will fix issue since it will only pass to socket.io server cookies that were created by this server. I see no problem in that.. @2h4u \n\nOk. I see you seek not to prevent passing cookies from polling to web socket connection, but to prevent polling from using shared cookie storage altogether. I see no problem in that since load balancers support needs only to pass cookies from the current polling session storage, it does not matter if it is shared or not.\nYou could create a PR with these changes and make them merged in the upcoming release.\nOne comment though. It may be simpler to add just a single flag to the config useSharedCookieStorage which defaults to false. Config already has custom cookies property to set custom cookies, so no need to pass whole custom storage.\nAnd also please test that cookies that are added after polling connection is established pass on successfully to web socket connection request.\n@nuclearace what do you think?. Found this after made comment in my PR #1058 (https://github.com/socketio/socket.io-client-swift/pull/1058#issuecomment-425062388).\nThis PR also fixes bug described there. It is only left to decide whether it will be better to pass filtered cookies to addHeaders method or to filter them by domain inside addHeaders method.. Oh. I see, I was not aware of the plans, just researched about a concrete framework.\nI saw that Starscream abstracted the transport into streams (implementations of WSStream protocol).\nSo I thought that it will be a good idea to have an option in this lib to select which stream to use. Thus every client will be able to adjust configuration based on its platform and other parameters.. If you mean that it will be supported as soon as Starscream releases this functionality I can close this issue.. Ok. closing this issue.. No problem, I just copied existing code.. It was in flushProbeWait(). That was the problem since this method needs to be called on web socket success and failure, but flushWaitingForPostToWebSocket() only on success. If called on failure, POST packets are just dropped into failed socket.\nAnother way will be to check in flushWaitingForPostToWebSocket() if socket is connected.. \ud83d\udc4c will also change to !.isEmpty and test. done. yes, made this too. ",
    "Elhoej": "version: socket.io@2.1.1 . ",
    "hschouman": "Hello,\nI have the same issue :-/\n@satishVekariya did you found a solution ?\nIf not : are you sure your certificate is in binary ? if not you should try to convert it with the following command :\nopenssl x509 -in cert.cer -outform der -out cert.der\nIn my case, the key or certification seems to be correctly set but I can see everything as plain text in Charles Proxy...\nMy config with a certificate :\nif let url = Bundle.main.url(forResource: \"cert\", withExtension: \"der\") {\n    let data = try Data(contentsOf:url)\n    let sslSecurity = SocketIO.SSLSecurity(certs: [SSLCert(data: data)], usePublicKeys: false)\n    return [.log(true), .reconnectWait(5), .compress, .secure(true), .security(sslSecurity), .forceNew(true), .cookies([])]\nI also tried with the public key as following :\n(I used https://github.com/btnguyen2k/swiftutils to store the public key to the keychain)\nlet key = try RSAUtils.addRSAPublicKey(keyString, tagName: Constant.publicTagKey)\nif let key = key {\n    let sslSecurity = SocketIO.SSLSecurity(certs: [SSLCert(key: key)], usePublicKeys: true)\n    return [.log(true), .reconnectWait(5), .compress, .secure(true), .security(sslSecurity), .forceNew(true), .cookies([])]\n}\nI use the version 13.3.0 of the lib. I finally succeed doing it.\nyou should add an URLSessionDelegate in the config and compare the server certificate with the client one.\nYou can follow the explanations of this article :\nhttps://medium.com/@andersongusmao/certificate-pinning-technique-on-ios-af0f0813e88. For more information on my use case with cookies here, I use session affinity on heroku :\nhttps://devcenter.heroku.com/articles/session-affinity\nBut I guess there are other use cases with cookies here. Sure and you only want the cookies relative to the current connection/url or I miss something ?. You are right. In my case I have the same result with the two schemes because the cookies are stored with the base url (path == \"/\").\nI've just fixed that.. ",
    "weifans": "@nuclearace Can you see my question?. @techvj I gave up SMP and chose Carthage to solve this problem.. @nuclearace Thank you very much for your reply\uff01\nI feel that the method of use is wrong.\nHow to use SPM specifically, have you tested it? Can you talk about it in detail?\n. @nuclearace This link didn't help me.\nI hope you can take the time to test SPM.\nIt won't take you too much time, there really is a problem, I tested it in a new project.\nThere is a problem with the dependency package.\n\nThank you very much, I hope to get your support.\n. ",
    "techvj": "@weiFans did you find solution for this. ",
    "Nag91777": "I don't have an SSL Certificate. But other Socket IO clients are accessing without SSL Certificate, like Android and Javascript with default SSL Configuration.. Hi Nuclearace, I followed all the session delegate methods as per Apple documentation, still we are facing the same issue.\nMy question is do we need to insert any SSL Certificate that is provided by client or do we need to generate a Certificate and insert it.. ",
    "czbalazs": "@Nag91777 Have you managed to solve the issue? If so, could you please give me some insights?. ",
    "Nitish34": "@nuclearace. I have tried mentioning swift version but it was giving a error. But by default it takes swift version 3.2 as mentioned .. @nuclearace I just want to include socket client in my iOS \"bundle\" which I can use somewhere else also. . It is swift 4.. @hemrajjhariya. Try clean and delete derived data. That trick works and make sure there is no other socket project running or ongoing. Thats how I resolved it. @hemrajjhariya.What I have done in my project was. I created a dynamic lib, then pod init in that, added socket library. Pod install. Open workspace import socketio. Clean and build using generic device as a target that's it. Use your library. . @hemrajjhariya in my project there was a socket dependency so I have done that via pod install. . Yes I m using workspace only.. ",
    "Hemrajjhariya": "@nuclearace trying to do the same thing and getting errors. Is there any solution for it.\n. @Nitish34 I have my own custom cocoaPod with Name 'ABC' and in ABC pod spec file I have added   s.dependency 'Socket.IO-Client-Swift', '~> 12.0.0'. Now, when I run command pod spec lint. I'm getting the same errors which you had mentioned above.\n. @Nitish34 I'm not trying to install Socket lib from pod file in the project. What I am trying is, that adding Socket as s.dependency 'Socket.IO-Client-Swift', '~> 12.0.0' in my framework Podspec file and  when I run command pod spec lint then it is giving error.. ",
    "DongHa0": "same too  What's the solution\uff1f THX. \nthis. ",
    "pdupris": "The enableSOCKSProxy option is useful for debugging with Charles proxy.. ",
    "MrShiY": "@nuclearace 13.1.3\nI also  detect the older version 9.0, it is fine, why is the new version bad ?\nThe newest version 13.2.1  also is bad.\nThe message was saved to database, after that, was sent to client side. But Android is fine, iOS is bad.. @zixinxiaohei  \u6211\u81ea\u5df1\u5904\u7406\u4e86,\u628a\u6d88\u606f\u90fd\u7ed9base64\u4e00\u4e0b\u518d\u53d1,\u53ef\u80fd\u65b0\u7248\u672c\u5e93\u6709\u95ee\u9898,\u6211\u6709\u4e2a\u5de5\u7a0b\u7528\u76849.0\u7684\u5c31\u6ca1\u6709\u8fd9\u4e2a\u95ee\u9898.. ",
    "zixinxiaohei": "I also have the same problem in Version 13.2.1 ,but no see doubleEncodeUTF8 ,\ndoubleEncodeUTF8 Has been removed \uff08\u63a5\u6536\u7684\u4e2d\u6587\u7684\u5185\u5bb9\u4e71\u7801\uff09\uff0chow can I do\uff1f. I use swift language ,This phenomenon does not occur with the simulator, this problem occurs with the real machine.\uff08\u6a21\u62df\u5668\u4e0d\u4f1a\u51fa\u95ee\u9898\uff0c\u771f\u673a\u5c31\u4f1a\u51fa\u73b0\u5185\u5bb9\u4e71\u7801\uff09. ",
    "954788": "@ilandbt My solution is to listen to error event, determine if the hint in data is no network, and then proceed.. ",
    "fotiDim": "Add an empty Swift file and answer yes when Xcode asks you to add the bridging header.. ",
    "VisionMkhabela": "Ok its working I figured it out, should have used the manager instead of the client. ",
    "vonox7": "This commit introduces a major flaw: ALL cookies for ALL domains used in the app are sent to the socket-io-Server. So if the app uses a WebView, even those cookies set in the WebView will be sent to the socket.io server. @nuclearace @OneSman7 \nThe problem is, that SocketEngine.resetEngine() uses the default URLSession configuration. The cookies are stored to disk AND are shared to with other libraries/usecases in the app. Shouldn't we use an own URLSessionConfiguration just for socket.io to allow the usecase from this pull request?\nI see a very big security issue in this change.. Note that this feature introduced major crashes. When reverting it (see https://github.com/vonox7/socket.io-client-swift/commits/v-revert-completion-handler ) the crashes are gone.\nCrashed: NSOperationQueue 0x280ab42e0 (QOS: UNSPECIFIED)\nEXC_BAD_ACCESS KERN_INVALID_ADDRESS 0x0000000a35918130\nStacktrace:\nCrashed: NSOperationQueue 0x280ab42e0 (QOS: UNSPECIFIED)\n0  libobjc.A.dylib                0x1d853cd70 objc_msgSend + 16\n1  Starscream                     0x1050ff6a8 protocol witness for WSStream.write(data:) in conformance FoundationStream (WebSocket.swift:241)\n2  Starscream                     0x105105c30 closure #1 in WebSocket.dequeueWrite(_:code:writeCompletion:) (WebSocket.swift:1268)\n3  Starscream                     0x1050fd244 thunk for @escaping @callee_guaranteed () -> () (<compiler-generated>)\n4  Foundation                     0x1d9de3b6c __NSBLOCKOPERATION_IS_CALLING_OUT_TO_A_BLOCK__ + 16\n5  Foundation                     0x1d9cebcc8 -[NSBlockOperation main] + 72\n6  Foundation                     0x1d9ceb19c -[__NSOperationInternal _start:] + 740\n7  Foundation                     0x1d9de5a40 __NSOQSchedule_f + 272\n8  libdispatch.dylib              0x1d8d8f6c8 _dispatch_call_block_and_release + 24\n9  libdispatch.dylib              0x1d8d90484 _dispatch_client_callout + 16\n10 libdispatch.dylib              0x1d8d66e14 _dispatch_continuation_pop$VARIANT$armv81 + 404\n11 libdispatch.dylib              0x1d8d664f8 _dispatch_async_redirect_invoke + 592\n12 libdispatch.dylib              0x1d8d72afc _dispatch_root_queue_drain + 344\n13 libdispatch.dylib              0x1d8d7335c _dispatch_worker_thread2 + 116\n14 libsystem_pthread.dylib        0x1d8f72190 _pthread_wqthread + 472\n15 libsystem_pthread.dylib        0x1d8f74d00 start_wqthread + 4\nI think, that the main cause of this issue is that @headlessme introduced for every single call a requestHandler-closure, even when it is empty ({}). Before this commits, it was nil. This a) introduces a major performance hit and b) apparently is somehow not 100% save which leads to a lot of crashes in production.\nRelated issue: https://github.com/socketio/socket.io-client-swift/issues/1118. This PR introduces major crashes in productions, see https://github.com/socketio/socket.io-client-swift/issues/1096#issuecomment-436576960\nI created a fork which reverts this PR and leads to a crash-free library: https://github.com/vonox7/socket.io-client-swift/commits/v-revert-completion-handler. Note: we need the current (unreleased) Starscream version, as we need the newly introduced callback from there.. @nuclearace Starscream released now this feature :). @headlessme I also can't recreate it, just when I deploy the library to production the crashes occour.\nThere are many occurences that have this faulty pattern:\n1) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-0a1f28547352834d5f60fc457346f374R216: {} gets created and passed.\n2) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-0a1f28547352834d5f60fc457346f374R233: completion should be optional and default to nil\n3) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-0a1f28547352834d5f60fc457346f374R250: {} gets created and passed.\n4) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-0a1f28547352834d5f60fc457346f374R318: wrappedCompletion closure gets created, even when not used\n5) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-82f151b5e75e68a03348f7b49ecc92bdR112: completion should be optional and default to nil\n6) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-f4c64640e3bdff245461736366db089eR343: {} gets created and passed.\n7) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-f4c64640e3bdff245461736366db089eR351: {} gets created and passed.\n8) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-f4c64640e3bdff245461736366db089eR369: {} gets created and passed.\n9) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-f4c64640e3bdff245461736366db089eR547: {} gets created and passed.\n10) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-f4c64640e3bdff245461736366db089eR614: completion should be optional and default to nil\n11) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-68876de916c9842709454984f828e6d9R68: completion should be optional and default to nil\n12) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-68876de916c9842709454984f828e6d9R216: completion should be optional and default to nil\n13) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-05aa04316266fce09c354930d7e392ebR141: completion should be optional and default to nil\n14) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-05aa04316266fce09c354930d7e392ebR184: if completion is nil, we should also pass nil to the completion param.\n15) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-d92ca8e6cf38ee3f5cce2f6aa0995b07R41: completion should be optional and default to nil\n16) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-d92ca8e6cf38ee3f5cce2f6aa0995b07R60: completion should be optional and default to nil\n17) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-3f5960a15123f6282c649b10d18adf28R293: {} gets created and passed.\n18) https://github.com/socketio/socket.io-client-swift/pull/1097/files#diff-1c4c08a7f3a6b280a37a22d512291f7aR191: completion should be optional and default to nil\nI'm not sure if I found all faulty occurences, but this bad pattern is almost everywhere.. @nuclearace Then how can you explain why commit 4ce1e92 on https://github.com/vonox7/socket.io-client-swift/commits/v-revert-completion-handler fixes this issue to 100%, and without it i got hundreds of crashes from various users?. @nuclearace All I can say that after reverting this PR in my branch https://github.com/vonox7/socket.io-client-swift/commits/v-revert-completion-handler, this issue was resolved. I don't say that this isn't also an issue on Starscream. But do you see why this is a big performance hit and why reverting this PR also resolves the issue?. @nuclearace yes, I'm currently making a PR that propagates nil.. And yes, I make a ton of message, thats why I use sockets and not a simple http connection.\nPR: https://github.com/socketio/socket.io-client-swift/pull/1119. you're right, fixed in next PR. You are right. I removed the unnecessary function calls.. ",
    "annethereshewent": "so the problem was a small typo, it was supposed to be socket.on('chat_history', ....) instead of socket.on('chat-history', ...). this is good to close. apologies for the inconvenience!. ",
    "huforrest": "@Rupasekhar I have similar problem. When I build my project, I also got 17 runtime errors. Have you solved this problem? And how did you solve it?. @Rupasekhar I finally solved this problem. Here is my solution:\n1 I go to Build Settings > Swift Language Version, and I set the swift version to 4.1\n2 In Podfile I changed Socket.IO-Client-Swift version to 13.3.0 like this pod 'Socket.IO-Client-Swift', '~> 13.3.0'\n3 pod update. @nuclearace I use node.js http server and here is my server code:\nvar app = require('express')();\nvar http = require('http').Server(app);\nvar io = require('socket.io')(http);\nio.on('connection', function(socket){\n  console.log('a user connected');\nsocket.broadcast.emit('user connection event', \"a user connected\");\nsocket.on('disconnect', function(){\n    console.log('user disconnected');\nio.emit('user connection event', \"a user disconnected\");\n\n});\nsocket.on('chat message', function(msg){\n    socket.broadcast.emit('chat message', msg);\n  });\n});\nhttp.listen(8900, function(){\n  console.log('listening on *:8900');\n});\nAnd I have already started the server. @nuclearace I finally found the answer for my problem on the stack overflow website. And here is the url \"https://stackoverflow.com/questions/39207652/swift-ios-application-does-not-connect-to-server-using-socket-io\".. @MD04-TanTan I have the similar problem. But I could not complie with Swift project (Swift 4, Xcode 9.4.1). And I installed Socket.IO-Client-Swift (13.2.1). I wonder whether Socket.IO-Client-Swift (13.2.1) support Swift 4.. @MD04-TanTan I finally solved this problem. Here is my solution:\n1 I go to Build Settings > Swift Language Version, and I set the swift version to 4.1\n2 In Podfile I changed Socket.IO-Client-Swift version to 13.3.0 like this pod 'Socket.IO-Client-Swift', '~> 13.3.0'\n3 pod update. The client code I have posted above is written in javascript, what I wanna know is that how to write it in socket.io-client-swift. It seems that socket.io-client-swift only provides the following two functions:\nopen func emit( event: String, _ items: SocketData...)\nopen func emit( event: String, with items: [Any]). ",
    "lilongCoder": "Thank you,sir.I have solved the question. App can crash Because of querystring urlcode.Your urlcode method of SocketExtensions class has less allowdCharacters.If client has other characters in pragrams, percentEncodedQuery of urlWebSocket would crash.. ",
    "WeilerCode": "@MD04-TanTan add use_frameworks! to Podfile. ",
    "nitishmaropost": "@huforrest : Thanks. This fixed the issue.. ",
    "zhangjunjiecq": "v13.0.1 can connect to the specified nameSpace, but it cannot be used above this version.\nI want to know why. ",
    "bbwlcwd": "how to do it?. ",
    "EvangelNancy": "thanks, it works\uff1a\uff09. ",
    "binloan": "I'm sorry but Sails.js uses Socket.io as basis. So yes i'm trying to connect to one.. @nuclearace Well I do hold the manager strongly. But you still had a point. My wrapping class was disposed before the manager could connect.\nThanks for the hint!. ",
    "tradingstratagem": "Wow, fixed very fast  :D. Params: strings, like token:<jwt token>\nVersion: 13.3.1\n. any news here?. ",
    "JadianZheng": "@nuclearace I had set the swift version to 4.2 or 4 before the error happen. \nBut as you say, I try the follow step, the error disappear:\n(Maybe the diff is pod install before or after the swift version set ?)\n1. Remove Pods and Podfile.lock\n2. Clear builds and Deived Data \n3. Reset the target's swift version to 4\n4. Reinstall all pods\n(Hope this can help others). ",
    "lianxiang1": "my server use \u201cnetty-socketio\u201c 1.7.16 . \u4f60\u4eec\u7528\u7684\u63a5\u6536\u4e2d\u6587 \u4f1a\u4e0d\u4f1a\u4e71\u7801\uff1f\u8be5\u600e\u4e48\u5904\u7406. hi I have the same problem @nuclearace \n`//NSData *jsonData = [jsonString dataUsingEncoding:NSUTF8StringEncoding];\nNSData *jsonData = [jsonString dataUsingEncoding:NSISOLatin1StringEncoding];`\n\nWhen I use NSUTF8StringEncoding to parse callback data \uff0cChinese is messy code. but ,use NSISOLatin1StringEncoding is right.\n. ",
    "liuhuan3344": "Thank you.. ",
    "sanyamjain65": "I figured out the solution.\nThe way to include options has been revised in the latest version.\nI did the following and it worked:-\nmanager  = SocketManager(socketURL:  URL(string:\"myurl:123\")!, config: [.log(true), .forceNew(true), .reconnectAttempts(10), .reconnectWait(6000), .connectParams([\"key\":\"value\"]), .forceWebsockets(true), .compress])\nsocket = manager?.defaultSocket. @nuclearace Thanks for the help.. @nuclearace i found what the problem was.\n\nIf any third party libraries/ frameworks are used in a dynamic framework then those libraries/frameworks should also be present in the app your custom framework is used.\nhence, i just needed to install the SocketIO framework using cocoapod in the app in which i was installing my custom framework.\nand also thanks for your help.. ",
    "Pradeepkn": "Here is my code on initial setup and I am emitting the event after I make sure socket is connected.\nlet manager = SocketManager(socketURL: URL(string: \"http://smartkey.trackagps.com:8888\")!,config: [.log(true),.connectParams([:])])\n    var socket:SocketIOClient!\noverride init() {\n    super.init()\n    self.socket = manager.defaultSocket;\n    self.socket.joinNamespace() // Create a socket for the /swift namespac\n}\n\nThis happens on app goes to background and coming back to foreground. I am not using load balancing.\nThis happens every time I go to background on my iOS device and launching once again.\n. ```\nPasting once again the error response\n2018-09-10 18:53:40.690869+0530 SmartKey[60310:8239983] LOG SocketEnginePolling: Doing polling GET http://smartkey.trackagps.com:8888/socket.io/?transport=polling&b64=1&sid=TTCY-wrci4QpVAe5AAbZ\n2018-09-10 18:53:43.962437+0530 SmartKey[60310:8239909] [Snapshotting] Snapshotting a view (0x142829e00, UIKeyboardImpl) that is not in a visible window requires afterScreenUpdates:YES.\n2018-09-10 18:53:47.078641+0530 SmartKey[60310:8239984] TIC Read Status [3:0x1c017e540]: 1:57\n2018-09-10 18:53:47.205093+0530 SmartKey[60310:8240272] LOG SocketEnginePolling: Got polling response\n2018-09-10 18:53:47.205296+0530 SmartKey[60310:8240272] LOG SocketEnginePolling: Got poll message: <!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\n\n\n\n500 - Internal server error.\n\n\n<!--\n\nbody{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}\n\nfieldset{padding:0 15px 10px 15px;} \n\nh1{font-size:2.4em;margin:0;color:#FFF;}\n\nh2{font-size:1.7em;margin:0;color:#CC0000;} \n\nh3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} \n\n#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:\"trebuchet MS\", Verdana, sans-serif;color:#FFF;\n\nbackground-color:#555555;}\n\n#content{margin:0 0 0 2%;position:relative;}\n\n.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}\n\n-->\n\n\n\n\nServer Error\n\n\n2018-09-10 18:53:47.206385+0530 SmartKey[60310:8240272] LOG SocketEngine: Got message: html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"\n\n\n\n500 - Internal server error.\n\n\n<!--\n\nbody{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}\n\nfieldset{padding:0 15px 10px 15px;} \n\nh1{font-size:2.4em;margin:0;color:#FFF;}\n\nh2{font-size:1.7em;margin:0;color:#CC0000;} \n\nh3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} \n\n#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:\"trebuchet MS\", Verdana, sans-serif;color:#FFF;\n\nbackground-color:#555555;}\n\n#content{margin:0 0 0 2%;position:relative;}\n\n.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}\n\n-->\n\n\n\n\nServer Error\n\n\n\n\n\n500 - Internal server error.\n\n\n<!--\n\nbody{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}\n\nfieldset{padding:0 15px 10px 15px;} \n\nh1{font-size:2.4em;margin:0;color:#FFF;}\n\nh2{font-size:1.7em;margin:0;color:#CC0000;} \n\nh3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} \n\n#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:\"trebuchet MS\", Verdana, sans-serif;color:#FFF;\n\nbackground-color:#555555;}\n\n#content{margin:0 0 0 2%;position:relative;}\n\n.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}\n\n-->\n\n\n\n\nServer Error\n\\r\\n\\r\\n\\r\\n\\r\\n500 - Internal server error.\\r\\n",
    "kkwd": "The ISO terminal is a small end encoding.. Android and Web Chinese normal, IOS client Chinese garbled, server UTF-8. Other project versions of server 1.7.16 https://github.com/mrniko/netty-socketio\n. Thank you. ",
    "hailie-rei": "@nuclearace Thank you! You are right. My server creates namespaces dynamically, and the namespace was incorrect. \nIn my case, I have to send additional parameter for connection. I use .connectParams option for manager:\nmanager = SocketManager(socketURL: URL(string: url)!, config: [.log(true), .compress, .forceNew(true), .forceWebsockets(true), .connectParams([\"key\" : \"value1\"])])\nbut for every socket values for this parameter (key in my example) are different. Is there a possibility to set connect parameters for every socket separately? \nThanks. ",
    "mpadovani": "I`m create a singleton, but I can not hear the channel\n```\nimport SocketIO\nimport Foundation\nclass SocketIOManager: NSObject {\n    static let sharedInstance = SocketIOManager()\nvar socket = SocketManager(socketURL: URL(string: \"https://dev.socket.myhosting.com.br:3000?token=token\")!, config: [.log(true), .forcePolling(true)])\n\noverride init() {\n    super.init()\n}\n\nfunc establishConnection() {\n    socket.connect()\n\n}\n\nfunc closeConnection() {\n    socket.disconnect()\n}\n\n}\n```\nIn AppDelegate connect, and ready polling\nv2[3991:1747006] LOG SocketEnginePolling: Doing polling GET https://dev.socket.myhosting.com.br:3000/socket.io/?transport=polling&b64=1&sid=hHqq62XAtLP-fxLsAAgg\nIn viewcontroller on viewDidLoad:\nSocketIOManager.sharedInstance.socket.defaultSocket.on(\"found.\\(session.currentUser!.id)\") { (data, ack) in\n            print(\"HereI!!\")\n            print(ack)\n            print(data)\n        }\n. ",
    "habiburrahuman": "Thanks dude. ",
    "VishveshLad": "\nYes, background execution is not explicitly supported with this library. You can try various ways of tricking iOS to giving you a little bit more time in the background, but generally, iOS will close connections that go into the background.\nI face one issue that my app in the background then open app go in foreground mode I called one emit socket call but I can't receive any response from the server. I was checked, there was socket state show me connected at that time.\nWhat is the solution for this issue? Please give me a response as soon as early. Thank you.. \n",
    "JessieWu0921": "I have the same issue. the same crash info. ",
    "tutu1990": "I have the same issue. the same crash info . ",
    "TimothyTim": "When is this going to be released?. ",
    "AgentFeeble": "Are there any updates on this? I see it's been merged into the develop branch, is there any way we can get a release for it?. Awesome, thank you \ud83d\udc4d. ",
    "ZhangYizhe": "sure.\n`\n2018-10-02 19:42:25.920763+0800 [5729:7377357] LOG SocketManager: Starting reconnect\n2018-10-02 19:42:25.920952+0800 [5729:7377357] LOG SocketIOClient{/}: Handling event: statusChange with data: [connecting]\n2018-10-02 19:42:25.921071+0800 [5729:7377357] LOG SocketIOClient{/}: Handling event: reconnect with data: [\"Socket Disconnected\"]\n2018-10-02 19:42:25.921172+0800 [5729:7377357] LOG SocketManager: Trying to reconnect\n2018-10-02 19:42:25.921333+0800 [5729:7377357] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [-1]\n2018-10-02 19:42:25.921563+0800 [5729:7377447] LOG SocketEngine: Starting engine. Server: http://192.168.7.92:3000\n2018-10-02 19:42:25.921676+0800 [5729:7377447] LOG SocketEngine: Handshaking\n2018-10-02 19:42:25.921893+0800 [5729:7377447] LOG SocketEnginePolling: Doing polling GET http://192.168.7.92:3000/socket.io/socket-007/?transport=polling&b64=1&runningCode=M0hhBBSkMGg71%2FhbUpHu&token=cc5952186bf64974aae4dfde53\n2018-10-02 19:42:26.105114+0800 [5729:7377486] LOG SocketEnginePolling: Got polling response\n2018-10-02 19:42:26.105224+0800 [5729:7377486] LOG SocketEnginePolling: Got poll message: \n502 Bad Gateway\n\n502 Bad Gateway\nnginx\n\n\n2018-10-02 19:42:26.105351+0800 [5729:7377486] LOG SocketEngine: Got message: \n502 Bad Gateway\n\n502 Bad Gateway\nnginx\n\n\n2018-10-02 19:42:26.105536+0800 [5729:7377357] ERROR SocketManager: Got unknown error from server \n502 Bad Gateway\n\n502 Bad Gateway\nnginx\n\n\n2018-10-02 19:42:26.105682+0800 [5729:7377357] LOG SocketIOClient{/}: Handling event: error with data: [\"Got unknown error from server \\r\\n502 Bad Gateway\\r\\n\\r\\n502 Bad Gateway\\r\\nnginx\\r\\n\\r\\n\\r\\n\"]\n2018-10-02 19:42:36.516372+0800 [5729:7377357] LOG SocketManager: Trying to reconnect\n2018-10-02 19:42:36.516702+0800 [5729:7377357] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [-2]\n2018-10-02 19:42:36.516978+0800 [5729:7377357] LOG SocketManager: Tried connecting an already active socket\n2018-10-02 19:42:46.759503+0800 [5729:7377357] LOG SocketManager: Trying to reconnect\n2018-10-02 19:42:46.759848+0800 [5729:7377357] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [-3]\n2018-10-02 19:42:46.760157+0800 [5729:7377357] LOG SocketManager: Tried connecting an already active socket\n`. in AppDelegate\n```\n            var manager : SocketManager? = nil\n            let url = \"http://192.168.7.92:3000\"\n            let path = \"/socket.io\"\n            manager = SocketManager(socketURL: URL(string: url)!, config: [.log(true), .compress,.path(path),.connectParams([\"token\":\"oijfroiaoisdnoiwerua292wlsjk\",\"runningEnvCode\":\"1001\",])])\n            let socket = manager.defaultSocket\n        socket.on(\"reply\") { (result, ack) in\n            AudioServicesPlaySystemSound(1016);\n            print(result)\n        }\n        socket.connect()\n\n```\nsend function:\n```\nfunc sendMessage(manager : SocketManager) {\n            let socket = manager.defaultSocket\n    socket.emit(\"send_chatting\", msg(receiver: \"2672\", message: \"123123\"))\n}\n\nstruct msg : SocketData {\n    let receiver: String\n    let message: String\n\n    func socketRepresentation() -> SocketData {\n        return [\"receiver\": receiver, \"message\": message]\n    }\n}\n\n```. After communicating with my colleagues on the server side, I found that it was the failure of my request to declare receipt.. ",
    "elliotstokes": "Ive also found the same issue. With the code\nmanager.config = [.compress, .connectParams([\"token\": \"A\"])]\n        let socket = manager.defaultSocket\n        socket.connect()\nif I re-run that code after disconnecting with token B the server receives token A on the second connect. Ive tried setting forceNew to true but the params are still cached.\nVersion 14.0.0\nEdit\nNot sure if I'm missing something but calling connect() and disconnect() on the manager instead of the socket itself appears to fix everything. ie. manger.connect() instead of manager.defaultSocket.connect(). ",
    "stardustWK": "1 should remove .swift-version file\n2 in Socket.IO-Client-Swift.podspec file should remove s.pod_target_xcconfig = {\n      'SWIFT_VERSION' => '4.0'\n  },  and add s.swift_version = '4.2'. for the user, an other solution: add code in your podfile\npost_install do |installer|\n  installer.pods_project.targets.each do |target|\n      if ['socket.io-client-swift'].include? target.name\n          target.build_configurations.each do |config|\n              config.build_settings['SWIFT_VERSION'] = '4.2'\n          end\n      end\n  end\nend. ",
    "OuMeng1991": "\nMake sure you do a clean CocoaPods install and check all Swift versions, this happens if the Swift version is not set correct. It should be a min of Swift 4.\n\nThanks!This problem has solved.. > I'm not sure what the issue is. Can you provide some more context and logs?\nPrinted logs\uff1a [] nw_socket_handle_socket_event [C248.1:1] Socket SO_ERROR [54: Connection reset by peer]\nThis error will be reported every time the line is dropped, but the re-link will never be able to connect.\n. ",
    "sjaq": "Ran into the same issue as described by OP. When connecting to a namespaced socket like so:\nswift\n    let manager = SocketManager(socketURL: URL(string: \"wss://...\")!, config: [.log(true), .secure(true), .compress])\n    let socket = manager.socket(forNamespace: \"/messages\")\nI can see the data coming in but my event handlers won't fire. Changing my server to emit the data on the root namespace and changing my client to use defaultSocket correctly fires the handlers.. @nuclearace the \"/messages\" in the url was just my last ditch effort of getting it to work without having to change the server code. Originally I had the same issues with just a \"wss://servername.tld\" url. \nHere's a sample of the log, you can see that events are emitted from the server before my client receives a connection event.\n```swift\n    let manager = SocketManager(socketURL: URL(string: \"ws://localhost:5000\")!, config: [.log(true), .compress])\n    let socket = manager.socket(forNamespace: \"/messages\")\nsocket.on(clientEvent: .connect) { data, ack in\n  debugPrint(\"Connected to server\", data)\n}\n\nsocket.on(\"status\") { [unowned self] data, ack in\n  if let dict = data[0] as? Dictionary<String, Any> {\n    self.updateStatus(Status(dict: dict))\n  }\n}\n\nsocket.connect()\n\n```\n2019-02-05 09:33:59.756213+0100 ZeroThree[12607:1651254] LOG SocketIOClient{/messages}: Adding handler for event: connect\n2019-02-05 09:33:59.756376+0100 ZeroThree[12607:1651254] LOG SocketIOClient{/messages}: Adding handler for event: message\n2019-02-05 09:33:59.756413+0100 ZeroThree[12607:1651254] LOG SocketIOClient{/messages}: Adding handler for event: status\n2019-02-05 09:33:59.756670+0100 ZeroThree[12607:1651254] LOG SocketIOClient{/messages}: Handling event: statusChange with data: [connecting]\n2019-02-05 09:33:59.756697+0100 ZeroThree[12607:1651254] LOG SocketIOClient{/messages}: Joining namespace /messages\n2019-02-05 09:33:59.756775+0100 ZeroThree[12607:1651254] LOG SocketManager: Tried connecting socket when engine isn't open. Connecting\n2019-02-05 09:33:59.756796+0100 ZeroThree[12607:1651254] LOG SocketManager: Adding engine\n2019-02-05 09:33:59.758600+0100 ZeroThree[12607:1651301] LOG SocketEngine: Starting engine. Server: ws://localhost:5000\n2019-02-05 09:33:59.758655+0100 ZeroThree[12607:1651301] LOG SocketEngine: Handshaking\n2019-02-05 09:33:59.760640+0100 ZeroThree[12607:1651301] LOG SocketEnginePolling: Doing polling GET http://localhost:5000/socket.io/?transport=polling&b64=1\n2019-02-05 09:33:59.869719+0100 ZeroThree[12607:1651307] [] nw_socket_handle_socket_event [C1.1:2] Socket SO_ERROR [61: Connection refused]\n2019-02-05 09:33:59.888028+0100 ZeroThree[12607:1651307] LOG SocketEnginePolling: Got polling response\n2019-02-05 09:33:59.888170+0100 ZeroThree[12607:1651307] LOG SocketEnginePolling: Got poll message: 109:0{\"sid\":\"ed0121e726c4494a97381d79b0f9bbcb\",\"upgrades\":[\"websocket\"],\"pingTimeout\":60000,\"pingInterval\":25000}2:40\n2019-02-05 09:33:59.888739+0100 ZeroThree[12607:1651307] LOG SocketEngine: Got message: 0{\"sid\":\"ed0121e726c4494a97381d79b0f9bbcb\",\"upgrades\":[\"websocket\"],\"pingTimeout\":60000,\"pingInterval\":25000}\n2019-02-05 09:33:59.905621+0100 ZeroThree[12607:1651307] LOG SocketEngine: Got message: 40\n2019-02-05 09:33:59.905761+0100 ZeroThree[12607:1651307] LOG SocketEnginePolling: Doing polling GET http://localhost:5000/socket.io/?transport=polling&b64=1&sid=ed0121e726c4494a97381d79b0f9bbcb\n2019-02-05 09:33:59.906071+0100 ZeroThree[12607:1651307] LOG SocketEngine: Writing poll:  has data: false\n2019-02-05 09:33:59.906114+0100 ZeroThree[12607:1651307] LOG SocketEnginePolling: Sending poll:  as type: 2\n2019-02-05 09:33:59.906153+0100 ZeroThree[12607:1651307] LOG SocketEnginePolling: Created POST string: 1:2\n2019-02-05 09:33:59.906418+0100 ZeroThree[12607:1651307] LOG SocketEnginePolling: POSTing\n2019-02-05 09:33:59.906495+0100 ZeroThree[12607:1651307] LOG SocketEnginePolling: Doing polling POST http://localhost:5000/socket.io/?transport=polling&b64=1&sid=ed0121e726c4494a97381d79b0f9bbcb\n2019-02-05 09:33:59.927371+0100 ZeroThree[12607:1651300] LOG SocketEngineWebSocket: Sending ws: probe as type: 2\n2019-02-05 09:33:59.928757+0100 ZeroThree[12607:1651306] LOG SocketEngine: Got message: 3probe\n2019-02-05 09:33:59.928810+0100 ZeroThree[12607:1651306] LOG SocketEngine: Received probe response, should upgrade to WebSockets\n2019-02-05 09:33:59.928846+0100 ZeroThree[12607:1651306] LOG SocketEngine: Upgrading transport to WebSockets\n2019-02-05 09:33:59.928881+0100 ZeroThree[12607:1651306] LOG SocketEnginePolling: Sending poll:  as type: 6\n2019-02-05 09:33:59.928915+0100 ZeroThree[12607:1651306] LOG SocketEnginePolling: Created POST string: 1:6\n2019-02-05 09:33:59.929060+0100 ZeroThree[12607:1651306] LOG SocketEnginePolling: POSTing\n2019-02-05 09:33:59.929234+0100 ZeroThree[12607:1651306] LOG SocketEnginePolling: Got polling response\n2019-02-05 09:33:59.929292+0100 ZeroThree[12607:1651306] LOG SocketEnginePolling: Got poll message: 1:6\n2019-02-05 09:33:59.929334+0100 ZeroThree[12607:1651306] LOG SocketEngine: Got message: 6\n2019-02-05 09:33:59.929367+0100 ZeroThree[12607:1651306] LOG SocketEngine: Switching to WebSockets\n2019-02-05 09:33:59.929393+0100 ZeroThree[12607:1651306] LOG SocketEngineWebSocket: Sending ws:  as type: 5\n2019-02-05 09:33:59.929553+0100 ZeroThree[12607:1651306] LOG SocketEngine: Flushing probe wait\n2019-02-05 09:33:59.930356+0100 ZeroThree[12607:1651306] LOG SocketEngine: Got message: 3\n2019-02-05 09:34:00.025719+0100 ZeroThree[12607:1651254] LOG SocketIOClient{/messages}: Handling event: ping with data: []\n2019-02-05 09:34:00.025812+0100 ZeroThree[12607:1651254] LOG SocketManager: Engine opened Connect\n2019-02-05 09:34:00.025917+0100 ZeroThree[12607:1651321] LOG SocketEngine: Writing ws: 0/messages, has data: false\n2019-02-05 09:34:00.025958+0100 ZeroThree[12607:1651321] LOG SocketEngineWebSocket: Sending ws: 0/messages, as type: 4\n2019-02-05 09:34:00.025982+0100 ZeroThree[12607:1651254] LOG SocketParser: Parsing 0\n2019-02-05 09:34:00.026474+0100 ZeroThree[12607:1651254] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2019-02-05 09:34:00.026613+0100 ZeroThree[12607:1651254] LOG SocketIOClient{/messages}: Handling event: pong with data: []\n2019-02-05 09:34:00.026658+0100 ZeroThree[12607:1651254] LOG SocketIOClient{/messages}: Handling event: pong with data: []\n2019-02-05 09:34:00.052222+0100 ZeroThree[12607:1651321] LOG SocketEngine: Got message: 42/messages,[\"status\",{\"created_at\":\"2019-02-05 08:27:33.737936\",\"updated_at\":\"2019-02-05 08:27:33.737945\",\"collected_at\":\"2019-01-01 00:00:00\",\"carrier\":\"Dummy\",\"signal\":\"12\",\"battery\":\"99\"}]\n2019-02-05 09:34:00.052309+0100 ZeroThree[12607:1651321] LOG SocketEngine: Got message: 40/messages\n2019-02-05 09:34:00.058718+0100 ZeroThree[12607:1651254] LOG SocketParser: Parsing 2/messages,[\"status\",{\"created_at\":\"2019-02-05 08:27:33.737936\",\"updated_at\":\"2019-02-05 08:27:33.737945\",\"collected_at\":\"2019-01-01 00:00:00\",\"carrier\":\"Dummy\",\"signal\":\"12\",\"battery\":\"99\"}]\n2019-02-05 09:34:00.059069+0100 ZeroThree[12607:1651254] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [status, {\n    battery = 99;\n    carrier = Dummy;\n    \"collected_at\" = \"2019-01-01 00:00:00\";\n    \"created_at\" = \"2019-02-05 08:27:33.737936\";\n    signal = 12;\n    \"updated_at\" = \"2019-02-05 08:27:33.737945\";\n}]; id: -1; placeholders: -1; nsp: /messages}\n2019-02-05 09:34:00.059279+0100 ZeroThree[12607:1651254] LOG SocketParser: Parsing 0/messages\n2019-02-05 09:34:00.059344+0100 ZeroThree[12607:1651254] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: -1; nsp: /messages}\n2019-02-05 09:34:00.059383+0100 ZeroThree[12607:1651254] LOG SocketIOClient{/messages}: Socket connected\n2019-02-05 09:34:00.059422+0100 ZeroThree[12607:1651254] LOG SocketIOClient{/messages}: Handling event: statusChange with data: [connected]\n2019-02-05 09:34:00.059857+0100 ZeroThree[12607:1651254] LOG SocketIOClient{/messages}: Handling event: connect with data: [\"/messages\"]\n\"Connected to server\" [\"/messages\"]. ",
    "ChiragBhutani1988": "I am using it in one of my existing project. Earlier I was using an old version of Socket.io client and now I have deleted the old files which I had added manually and I am trying to update it using cocoapods.\nI am using XCode10.0 and I am using an existing podfile for this. I didn't understand the meaning of \"a clean CocoaPods install\". Please explain.. ",
    "khimani91": "I have used Xcode 9.4.1 and I have done this command also still error... . ",
    "wchuang": "Many thanks for your reply. \nI will ask our backend engineer. But is it the server side's issues? Because it's be intercepted by socket.io swift client. So it cannot send anymore.. It still cannot send the Emoji. We use the latest version of Socket.io both on iOS client (Objective-C) and server side (Node.js).\nDoes anyone face this situation? Please give me some hint, thanks. :)). ",
    "AmitPrajapatiagile": "I was facing same issue. Solved!!\nadd pod 'Starscream', '<= 3.0.5'. ",
    "dlpigpen": "@AmitPrajapatiagile am\n it works for me. Thanks. ",
    "choumingg": "\nI was facing same issue. Solved!!\nadd pod 'Starscream', '<= 3.0.5'\n\nit works for me. Thanks. ",
    "devtechvalens": "not worked for me. ",
    "DmitryPR": "I have verified it compiles, what optional is not unwrapped?. I am using your library as s.dependecy in the podfile and unfortunately cannot specify branch in there.\nhttps://github.com/salemove/ios-bundle/blob/master/SalemoveSDK.podspec#L26. Could I release this unofficially so it could still be linked as a dependency from cocoapods?. As a framework developer I encountered an issue that the dependencies that I am using are not having the swift-version defined. \nThis leads to 2 problems:\n1) The podspec should really specify what swift version it has been adapted to, so the integrators know in advance what to expect when trying to solve different version problem\n2) https://github.com/CocoaPods/cocoapods-packager/issues/210 and https://github.com/CocoaPods/CocoaPods/issues/7327. Think I got these changes from your update to Swift 4.0 but I reverted them and just updated the Swift version and NSData -> Data change. . You are correct, added the fix. ",
    "sonathati": "Found it myself.\nswift\nmanager = SocketManager(socketURL: URL(string: \"http://192.168.1.2:5000/\")!, config: [.log(true), .connectParams([\"user\":123])]). ",
    "caichunjian520": "Thanks for your reply. There are about 40-60 points per-second when I draw and send to server. But if I saved all points (hundreds of points) of a pre-defined canvas on the device and send the points to server, the server will get all the points within 3 seconds.\nAs I draw on the screen with my finger, each time when the app get a new point, it will call socket.io function, it works very smoothly on website , but not on iOS. (I do exactly the same logic both on website and iOS app)\nTo make it simpler, I make a button to click and send 100 strings to server, so socket.emit function will be called 100 times. Still not smoothly.\nI also changed socket.emit to socket.rawEmitView.emit you mentioned. The issue is still exist.. ",
    "Sea-Eagle": "But getlocation handler not calling and In server as well no log is printing. I want to get driver location in my client app, for every update, from driver app we are updating to socket location we want the same location client app, so for that one we want to use getlocation event but its not calling in ios app. Thanks for quick response nuclearace, can you help me in getting data from how server, how can I do that from iOS client side and what is the best way to do that . ",
    "Deepal-axs": "Same issue as mentioned. @Sea-Eagle did you find any solutions for this ? @nuclearace please guide. . ",
    "deepal15": "Try using 1.0-Swift4 branch. seems to be solved in this branch for now.. ",
    "daljeet16": "Issue was in my project structure, which contains the older version of the pod. Deleting that resolve my issue.. ",
    "nghminh163": "i fixed by update xcode. Thanks a lots. ",
    "hk1554075856": "Thanks for your reply.I have found the reason.\n. ",
    "magnuspyke": "I'm getting the same issue:  I create a brand new iOS project in XCode, download socket.io-client-swift from Github, copy the SocketIO folder under the Source folder to my project, and try and build the project.  Build fails with \"No such module 'Startscream'\" in SocketIOClientOption.swift file.. FYI - I managed to successfully install socket.io-client-swift into an iOS project using CocoaPods following the approach in this article - https://medium.com/@spiromifsud/realtime-updates-in-ios-swift-4-using-socket-io-with-mysql-and-node-js-de9ae771529.. ",
    "fanglinwei": "@nuclearace \nI found out that the reason is when initializing SocketManager.\nIf I useconnectParams to pass the get parameter, there will be problems, such as disconnecting and reconnecting.\nBut when I initialize theurl and splicing the get parameter, there is no problem.\nI wrote a demo, you can download it and test it.socketioTest. ",
    "janvennemann": "@nuclearace, I'm having the same issue. When i disconnect via the socket client everything is fine, no reconnect happens. Now, if the server restarts the client reconnects shortly after. I expect the client to stay disconnected until i specifically reconnect it manually.\nA simple test case:\niOS client:\n```swift\nimport UIKit\nimport SocketIO\nclass ViewController: UIViewController {\nprivate var manager = SocketManager(socketURL: URL(string: \"http://localhost:3210\")!);\noverride func viewDidLoad() {\n    super.viewDidLoad()\nlet socket = self.manager.defaultSocket\nsocket.on(\"connect\") { (data, ack) in\n  print(\"connect\")\n}\nsocket.on(\"disconnect\") { (data, ack) in\n  print(\"disconnect\")\n}\nsocket.connect()\n\nDispatchQueue.main.asyncAfter(deadline: .now() + 2.0) {\n  socket.disconnect() // just disconnecting the client will make it reconnect after server restart\n  //socket.manager?.disconnect() // disconnecting the whole manager works as expected.\n}\n\n}\n}\nsocket.io node.js serverjs\nconst io = require('socket.io');\nconst server = io(3210);\n```\nLogs:\n2019-02-05 20:16:30.902367+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Adding handler for event: connect\n2019-02-05 20:16:30.902948+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Adding handler for event: disconnect\n2019-02-05 20:16:30.904117+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: statusChange with data: [connecting]\n2019-02-05 20:16:30.904247+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Joining namespace /\n2019-02-05 20:16:30.904434+0100 socket-test[76663:9803276] LOG SocketManager: Tried connecting socket when engine isn't open. Connecting\n2019-02-05 20:16:30.904544+0100 socket-test[76663:9803276] LOG SocketManager: Adding engine\n2019-02-05 20:16:30.907935+0100 socket-test[76663:9803339] LOG SocketEngine: Starting engine. Server: http://localhost:3210\n2019-02-05 20:16:30.908061+0100 socket-test[76663:9803339] LOG SocketEngine: Handshaking\n2019-02-05 20:16:30.910371+0100 socket-test[76663:9803339] LOG SocketEnginePolling: Doing polling GET http://localhost:3210/socket.io/?transport=polling&b64=1\n2019-02-05 20:16:30.986352+0100 socket-test[76663:9803339] LOG SocketEnginePolling: Got polling response\n2019-02-05 20:16:30.987017+0100 socket-test[76663:9803339] LOG SocketEnginePolling: Got poll message: 95:0{\"sid\":\"zqWUQ4CoI1Zt2c9mAAAC\",\"upgrades\":[\"websocket\"],\"pingInterval\":2000,\"pingTimeout\":5000}\n2019-02-05 20:16:30.988009+0100 socket-test[76663:9803339] LOG SocketEngine: Got message: 0{\"sid\":\"zqWUQ4CoI1Zt2c9mAAAC\",\"upgrades\":[\"websocket\"],\"pingInterval\":2000,\"pingTimeout\":5000}\n2019-02-05 20:16:30.996417+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: ping with data: []\n2019-02-05 20:16:30.996441+0100 socket-test[76663:9803339] LOG SocketEnginePolling: Doing polling GET http://localhost:3210/socket.io/?transport=polling&b64=1&sid=zqWUQ4CoI1Zt2c9mAAAC\n2019-02-05 20:16:30.996565+0100 socket-test[76663:9803276] LOG SocketManager: Engine opened Connect\n2019-02-05 20:16:30.996801+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Socket connected\n2019-02-05 20:16:30.996932+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: statusChange with data: [connected]\n2019-02-05 20:16:30.997202+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: connect with data: [\"/\"]\n2019-02-05 20:16:30.997463+0100 socket-test[76663:9803339] LOG SocketEngine: Writing poll:  has data: false\n2019-02-05 20:16:31.047770+0100 socket-test[76663:9803339] LOG SocketEnginePolling: Sending poll:  as type: 2\n2019-02-05 20:16:31.048003+0100 socket-test[76663:9803339] LOG SocketEnginePolling: Created POST string: 1:2\n2019-02-05 20:16:31.048319+0100 socket-test[76663:9803339] LOG SocketEnginePolling: POSTing\n2019-02-05 20:16:31.048448+0100 socket-test[76663:9803339] LOG SocketEnginePolling: Doing polling POST http://localhost:3210/socket.io/?transport=polling&b64=1&sid=zqWUQ4CoI1Zt2c9mAAAC\n!!! connect\n2019-02-05 20:16:31.048831+0100 socket-test[76663:9803339] LOG SocketEnginePolling: Got polling response\n2019-02-05 20:16:31.048938+0100 socket-test[76663:9803339] LOG SocketEnginePolling: Got poll message: 2:40\n2019-02-05 20:16:31.049040+0100 socket-test[76663:9803339] LOG SocketEngine: Got message: 40\n2019-02-05 20:16:31.049196+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: websocketUpgrade with data: [[\"sec-websocket-accept\": \"CBdfUFVHiU4RtQnKjDm7AhVje3o=\", \"upgrade\": \"websocket\", \"connection\": \"Upgrade\"]]\n2019-02-05 20:16:31.049208+0100 socket-test[76663:9803339] LOG SocketEnginePolling: Doing polling GET http://localhost:3210/socket.io/?transport=polling&b64=1&sid=zqWUQ4CoI1Zt2c9mAAAC\n2019-02-05 20:16:31.049450+0100 socket-test[76663:9803276] LOG SocketParser: Parsing 0\n2019-02-05 20:16:31.049456+0100 socket-test[76663:9803339] LOG SocketEngineWebSocket: Sending ws: probe as type: 2\n2019-02-05 20:16:31.061533+0100 socket-test[76663:9803276] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2019-02-05 20:16:31.061570+0100 socket-test[76663:9803339] LOG SocketEnginePolling: Got polling response\n2019-02-05 20:16:31.061686+0100 socket-test[76663:9803339] LOG SocketEnginePolling: Got poll message: 1:3\n2019-02-05 20:16:31.061809+0100 socket-test[76663:9803339] LOG SocketEngine: Got message: 3\n2019-02-05 20:16:31.061942+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: pong with data: []\n2019-02-05 20:16:31.061982+0100 socket-test[76663:9803339] LOG SocketEnginePolling: Doing polling GET http://localhost:3210/socket.io/?transport=polling&b64=1&sid=zqWUQ4CoI1Zt2c9mAAAC\n2019-02-05 20:16:31.099733+0100 socket-test[76663:9803355] LOG SocketEngine: Got message: 3probe\n2019-02-05 20:16:31.100036+0100 socket-test[76663:9803355] LOG SocketEngine: Received probe response, should upgrade to WebSockets\n2019-02-05 20:16:31.100164+0100 socket-test[76663:9803355] LOG SocketEngine: Upgrading transport to WebSockets\n2019-02-05 20:16:31.100339+0100 socket-test[76663:9803355] LOG SocketEnginePolling: Sending poll:  as type: 6\n2019-02-05 20:16:31.100506+0100 socket-test[76663:9803355] LOG SocketEnginePolling: Created POST string: 1:6\n2019-02-05 20:16:31.100887+0100 socket-test[76663:9803355] LOG SocketEnginePolling: POSTing\n2019-02-05 20:16:31.101082+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: pong with data: []\n2019-02-05 20:16:31.167047+0100 socket-test[76663:9803355] LOG SocketEnginePolling: Got polling response\n2019-02-05 20:16:31.167150+0100 socket-test[76663:9803355] LOG SocketEnginePolling: Got poll message: 1:6\n2019-02-05 20:16:31.167252+0100 socket-test[76663:9803355] LOG SocketEngine: Got message: 6\n2019-02-05 20:16:31.167370+0100 socket-test[76663:9803355] LOG SocketEngine: Switching to WebSockets\n2019-02-05 20:16:31.167471+0100 socket-test[76663:9803355] LOG SocketEngineWebSocket: Sending ws:  as type: 5\n2019-02-05 20:16:31.167611+0100 socket-test[76663:9803355] LOG SocketEngine: Flushing probe wait\n2019-02-05 20:16:33.104174+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Closing socket\n2019-02-05 20:16:33.104180+0100 socket-test[76663:9803339] LOG SocketEngine: Writing ws:  has data: false\n2019-02-05 20:16:33.104358+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Disconnected: Namespace leave\n2019-02-05 20:16:33.104337+0100 socket-test[76663:9803339] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2019-02-05 20:16:33.104442+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: statusChange with data: [disconnected]\n2019-02-05 20:16:33.104507+0100 socket-test[76663:9803339] LOG SocketEngine: Writing ws: 1/, has data: false\n2019-02-05 20:16:33.104553+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: disconnect with data: [\"Namespace leave\"]\n!!! dis2019-02-05 20:16:33.104627+0100 socket-test[76663:9803339] LOG SocketEngineWebSocket: Sending ws: 1/, as type: 4\nconnect\n2019-02-05 20:16:33.104754+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: ping with data: []\n2019-02-05 20:16:33.105170+0100 socket-test[76663:9803339] LOG SocketEngine: Got message: 3\n2019-02-05 20:16:33.105311+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: pong with data: []\n2019-02-05 20:16:35.299871+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: ping with data: []\n2019-02-05 20:16:35.299903+0100 socket-test[76663:9803338] LOG SocketEngine: Writing ws:  has data: false\n2019-02-05 20:16:35.300150+0100 socket-test[76663:9803338] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2019-02-05 20:16:35.301275+0100 socket-test[76663:9803338] LOG SocketEngine: Got message: 3\n2019-02-05 20:16:35.301556+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: pong with data: []\n2019-02-05 20:16:37.299914+0100 socket-test[76663:9803337] LOG SocketEngine: Writing ws:  has data: false\n2019-02-05 20:16:37.299914+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: ping with data: []\n2019-02-05 20:16:37.300091+0100 socket-test[76663:9803337] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2019-02-05 20:16:37.301011+0100 socket-test[76663:9803337] LOG SocketEngine: Got message: 3\n2019-02-05 20:16:37.301177+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: pong with data: []\n2019-02-05 20:16:39.300008+0100 socket-test[76663:9803339] LOG SocketEngine: Writing ws:  has data: false\n2019-02-05 20:16:39.300032+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: ping with data: []\n2019-02-05 20:16:39.300233+0100 socket-test[76663:9803339] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2019-02-05 20:16:39.301442+0100 socket-test[76663:9803339] LOG SocketEngine: Got message: 3\n2019-02-05 20:16:39.301658+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: pong with data: []\n2019-02-05 20:16:41.495863+0100 socket-test[76663:9803337] LOG SocketEngine: Writing ws:  has data: false\n2019-02-05 20:16:41.495882+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: ping with data: []\n2019-02-05 20:16:41.496112+0100 socket-test[76663:9803337] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2019-02-05 20:16:41.496958+0100 socket-test[76663:9803339] LOG SocketEngine: Got message: 3\n2019-02-05 20:16:41.497139+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: pong with data: []\n2019-02-05 20:16:43.495970+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: ping with data: []\n2019-02-05 20:16:43.495979+0100 socket-test[76663:9803337] LOG SocketEngine: Writing ws:  has data: false\n2019-02-05 20:16:43.496179+0100 socket-test[76663:9803337] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2019-02-05 20:16:43.497004+0100 socket-test[76663:9803339] LOG SocketEngine: Got message: 3\n2019-02-05 20:16:43.497157+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: pong with data: []\n2019-02-05 20:16:44.658389+0100 socket-test[76663:9803276] LOG SocketManager: Starting reconnect\n2019-02-05 20:16:44.658567+0100 socket-test[76663:9803276] LOG SocketManager: Trying to reconnect\n2019-02-05 20:16:44.658868+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [-1]\n2019-02-05 20:16:44.659208+0100 socket-test[76663:9803337] LOG SocketEngine: Starting engine. Server: http://localhost:3210\n2019-02-05 20:16:44.659345+0100 socket-test[76663:9803337] LOG SocketEngine: Handshaking\n2019-02-05 20:16:44.659643+0100 socket-test[76663:9803337] LOG SocketEnginePolling: Doing polling GET http://localhost:3210/socket.io/?transport=polling&b64=1\n2019-02-05 20:16:44.668115+0100 socket-test[76663:9803339] [] nw_socket_handle_socket_event [C4.1:2] Socket SO_ERROR [61: Connection refused]\n2019-02-05 20:16:44.669891+0100 socket-test[76663:9803339] [] nw_socket_handle_socket_event [C4.2:2] Socket SO_ERROR [61: Connection refused]\n2019-02-05 20:16:44.671055+0100 socket-test[76663:9803339] TIC TCP Conn Failed [4:0x600003e7c000]: 1:61 Err(61)\n2019-02-05 20:16:44.675372+0100 socket-test[76663:9803339] Task <8B14817F-C381-4ECD-B75B-7BFAACD70DB2>.<1> HTTP load failed (error code: -1004 [1:61])\n2019-02-05 20:16:44.675555+0100 socket-test[76663:9803354] Task <8B14817F-C381-4ECD-B75B-7BFAACD70DB2>.<1> finished with error - code: -1004\n2019-02-05 20:16:44.677437+0100 socket-test[76663:9803339] ERROR SocketEnginePolling: Could not connect to the server.\n2019-02-05 20:16:44.677664+0100 socket-test[76663:9803339] ERROR SocketEngine: Could not connect to the server.\n2019-02-05 20:16:44.677811+0100 socket-test[76663:9803276] ERROR SocketManager: Could not connect to the server.\n2019-02-05 20:16:44.677937+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: error with data: [\"Could not connect to the server.\"]\n2019-02-05 20:16:55.657754+0100 socket-test[76663:9803276] LOG SocketManager: Trying to reconnect\n2019-02-05 20:16:55.658055+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [-2]\n2019-02-05 20:16:55.658393+0100 socket-test[76663:9803337] LOG SocketEngine: Starting engine. Server: http://localhost:3210\n2019-02-05 20:16:55.658643+0100 socket-test[76663:9803337] LOG SocketEngine: Handshaking\n2019-02-05 20:16:55.659111+0100 socket-test[76663:9803337] LOG SocketEnginePolling: Doing polling GET http://localhost:3210/socket.io/?transport=polling&b64=1\n2019-02-05 20:16:55.668714+0100 socket-test[76663:9803748] LOG SocketEnginePolling: Got polling response\n2019-02-05 20:16:55.668854+0100 socket-test[76663:9803748] LOG SocketEnginePolling: Got poll message: 95:0{\"sid\":\"a-t5k9s9SzmS4e64AAAB\",\"upgrades\":[\"websocket\"],\"pingInterval\":2000,\"pingTimeout\":5000}\n2019-02-05 20:16:55.668987+0100 socket-test[76663:9803748] LOG SocketEngine: Got message: 0{\"sid\":\"a-t5k9s9SzmS4e64AAAB\",\"upgrades\":[\"websocket\"],\"pingInterval\":2000,\"pingTimeout\":5000}\n2019-02-05 20:16:55.669914+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: ping with data: []\n2019-02-05 20:16:55.669972+0100 socket-test[76663:9803748] LOG SocketEnginePolling: Doing polling GET http://localhost:3210/socket.io/?transport=polling&b64=1&sid=a-t52019-02-05 20:16:55.670025+0100 socket-test[76663:9803276] LOG SocketManager: Engine opened Connect\nk9s9SzmS4e64AAAB\n2019-02-05 20:16:55.674466+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Socket connected\n2019-02-05 20:16:55.674634+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: statusChange with data: [connected]\n2019-02-05 20:16:55.674799+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: connect with data: [\"/\"]\n!!! connect\n2019-02-05 20:16:55.675474+0100 socket-test[76663:9803748] LOG SocketEngine: Writing poll:  has data: false\n2019-02-05 20:16:55.675678+0100 socket-test[76663:9803748] LOG SocketEnginePolling: Sending poll:  as type: 2\n2019-02-05 20:16:55.675874+0100 socket-test[76663:9803748] LOG SocketEnginePolling: Created POST string: 1:2\n2019-02-05 20:16:55.676244+0100 socket-test[76663:9803748] LOG SocketEnginePolling: POSTing\n2019-02-05 20:16:55.676606+0100 socket-test[76663:9803748] LOG SocketEnginePolling: Doing polling POST http://localhost:3210/socket.io/?transport=polling&b64=1&sid=a-t5k9s9SzmS4e64AAAB\n2019-02-05 20:16:55.677290+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: websocketUpgrade with data: [[\"sec-websocket-accept\": \"asH7PBPw89BcKPCmSs5XtMh0l0I=\", \"upgrade\": \"websocket\", \"connection\": \"Upgrade\"]]\n2019-02-05 20:16:55.677429+0100 socket-test[76663:9803337] LOG SocketEngineWebSocket: Sending ws: probe as type: 2\n2019-02-05 20:16:55.678282+0100 socket-test[76663:9803753] LOG SocketEnginePolling: Got polling response\n2019-02-05 20:16:55.678487+0100 socket-test[76663:9803753] LOG SocketEnginePolling: Got poll message: 2:40\n2019-02-05 20:16:55.678685+0100 socket-test[76663:9803753] LOG SocketEngine: Got message: 40\n2019-02-05 20:16:55.678943+0100 socket-test[76663:9803276] LOG SocketParser: Parsing 0\n2019-02-05 20:16:55.679010+0100 socket-test[76663:9803753] LOG SocketEnginePolling: Doing polling GET http://localhost:3210/socket.io/?transport=polling&b64=1&sid=a-t5k9s9SzmS4e64AAAB\n2019-02-05 20:16:55.679235+0100 socket-test[76663:9803276] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2019-02-05 20:16:55.679596+0100 socket-test[76663:9803753] LOG SocketEngine: Got message: 3probe\n2019-02-05 20:16:55.679915+0100 socket-test[76663:9803753] LOG SocketEngine: Received probe response, should upgrade to WebSockets\n2019-02-05 20:16:55.680092+0100 socket-test[76663:9803753] LOG SocketEngine: Upgrading transport to WebSockets\n2019-02-05 20:16:55.680274+0100 socket-test[76663:9803753] LOG SocketEnginePolling: Sending poll:  as type: 6\n2019-02-05 20:16:55.680513+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: pong with data: []\n2019-02-05 20:16:55.686013+0100 socket-test[76663:9803748] LOG SocketEnginePolling: Got polling response\n2019-02-05 20:16:55.686108+0100 socket-test[76663:9803748] LOG SocketEnginePolling: Got poll message: 1:3\n2019-02-05 20:16:55.686210+0100 socket-test[76663:9803748] LOG SocketEngine: Got message: 3\n2019-02-05 20:16:55.686355+0100 socket-test[76663:9803748] LOG SocketEngine: Switching to WebSockets\n2019-02-05 20:16:55.686364+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: pong with data: []\n2019-02-05 20:16:55.686464+0100 socket-test[76663:9803748] LOG SocketEngineWebSocket: Sending ws:  as type: 5\n2019-02-05 20:16:55.686568+0100 socket-test[76663:9803748] LOG SocketEngine: Flushing probe wait\n2019-02-05 20:16:57.670029+0100 socket-test[76663:9803676] LOG SocketEngine: Writing ws:  has data: false\n2019-02-05 20:16:57.670073+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: ping with data: []\n2019-02-05 20:16:57.670279+0100 socket-test[76663:9803676] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2019-02-05 20:16:57.671375+0100 socket-test[76663:9803676] LOG SocketEngine: Got message: 3\n2019-02-05 20:16:57.671594+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: pong with data: []\n2019-02-05 20:16:59.861943+0100 socket-test[76663:9803748] LOG SocketEngine: Writing ws:  has data: false\n2019-02-05 20:16:59.861949+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: ping with data: []\n2019-02-05 20:16:59.862265+0100 socket-test[76663:9803748] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2019-02-05 20:16:59.863958+0100 socket-test[76663:9803337] LOG SocketEngine: Got message: 3\n2019-02-05 20:16:59.864314+0100 socket-test[76663:9803276] LOG SocketIOClient{/}: Handling event: pong with data: []. ",
    "AnswerNo2": "\nUse connectParams\n\nmy project write by Object-C\uff0cand your project write by Swift , how to write in O-C? please! thank you . > @wfy-answer It would look something like:\n\nobjc\nNSDictionary* opts = @{@\"connectParams\": @{@\"something\": @\"someValue\"}};\n\nthank you so much , last night my colleagues and me star your project ,haha. ",
    "UninhibitedSoul": "I turned it on after I turned off the phone to move cellular data for two seconds.\nIf turn off the mobile phone to move cellular data for half a minute and then turn it on, this problem will not occur.. Code\n```\nimport UIKit\nimport SocketIO\nimport SwiftyJSON\nlet timeoutVaule: Double = 2\nclass TavanMessageEngine: NSObject {\nstatic let sharedMessageEngine = TavanMessageEngine.init()\n\nvar socketManager: SocketManager?\n\nvar websocket: SocketIOClient?\n\nvar mUserId: String?\n\nvar isFirstConnect = true\n\nprivate override init() { }\n\nfunc connect(websocketURL: URL, mUserId: String, printLog: Bool = false ) {\n\n    let confi = SocketIOClientConfiguration.init(arrayLiteral: .log(printLog), .connectParams([\"userid\" : mUserId]))\n\n    self.socketManager = SocketManager.init(socketURL: websocketURL, config: confi)\n\n    self.mUserId = mUserId\n    self.websocket = socketManager?.defaultSocket\n\n    socketListenOnClientEvent(websocket!)\n\n    self.websocket?.connect()\n}\n\nfunc disconnect() {\n\n    websocket?.disconnect()\n    websocket = nil\n}\n\nfunc checkRoomExisted(_ rooomId: String, isExisted: @escaping (Bool) -> Void ){\n\n    websocket?.emitWithAck(\"check-room\", rooomId).timingOut(after: timeoutVaule, callback: { [weak self] (response) in\n        guard let strongSelf = self else { return }\n\n        let jsonData = SwiftyJSON.JSON(response)\n        let data = jsonData.array?.first\n\n        // repsonse = NO ACK\n        if let responseString = data?.string, responseString == SocketAckStatus.noAck.rawValue {\n\n            strongSelf.socketManager?.reconnect()\n            return\n        }\n\n        guard let existed = data?.bool, existed == true else{\n            isExisted(false)\n            printLog(\"checkRoom , room not existed \ud83d\ude13)\")\n            return\n        }\n        printLog(\"checkRoom , room existed \ud83d\ude42)\")\n        isExisted(true)\n    })\n}\n\nfunc socketListenOnClientEvent(_ socket: SocketIOClient) {\n\n    socket.on(clientEvent: .connect) { [weak self] (data, ack) in\n        guard let strongSelf = self else { return }\n\n        if strongSelf.isFirstConnect == true {\n            strongSelf.isFirstConnect = false\n            printLog(\"socket connected\")\n\n        } else { // reconnect -> connect\n\n            strongSelf.checkRoomExisted(\"test\", isExisted: { (isExisted) in\n                printLog(\"socket reconnect -> connect RRRRRRRRRRRRRRRRRRR\")\n            })\n        }\n    }\n\n    socket.on(clientEvent: .disconnect) { (data, ack) in\n        printLog(\"socket disconnect|||||||||||\")\n    }\n\n    socket.on(clientEvent: .reconnect) { (data, ack) in\n        printLog(\"socket reconnetct ------ - ------\")\n    }\n}\n\n}\n```. ",
    "Yogesh-MV": "I am also facing the same issue. ",
    "freedbrt": "Did you try emitWithAck() function?\n. ",
    "apateluk": "Thanks for the pointer, I ended up with this in the end.\n```\n            guard let dataArray = data[0] as? [Any] else {\n                return\n            }\n        for row in dataArray {\n            guard let currentrow = row as? [String: Any] else {\n                return\n            }\n            guard let eventType = currentrow[\"type\"] as? Int, let longitude = currentrow[\"longitude\"] as? Double, let latitude = currentrow[\"latitude\"] as? Double else {\n                return\n            }\n\n```. ",
    "webMing": "\n@webMing Can you not cast the first argument to NSString?\nI have do this, but it crash, and i find ret is _Swiftype. i will try again .... \n. > Also, can you post logs of the initial socket connection? It might shed some light on why it's not connecting.\n\nI will post logs, and it can connect success, but when i Implement   [socket on:@\"connecting\" callback:^{}] method,  which para may  connecting or connected or other connect status event ,i \nfind those methods not call.. > Ah right, statusChange's data arg is an enum type. So in Objective-C it's going to be an int I believe. But the Swift bridging should also create an Objective-C way of referring to the various cases, I just haven't looked at what they are in ObjC\nThis is test demo in my OC project ,you may have a try .\n@import SocketIO;\n@interface ViewController ()\n@property (strong, nonatomic) SocketManager *manager;\n@property (strong, nonatomic) SocketIOClient *socket;\n@end\n-(void)viewDidAppear:(BOOL)animated{\n    [super viewDidAppear:animated];\n    [self configure];\n}\n- (void)configure{\n    NSURL* url = [[NSURL alloc] initWithString:@\"https://localhost:8080\"];\n    self.manager = [[SocketManager alloc] initWithSocketURL:url config:@{@\"log\": @YES, @\"compress\": @YES}];\n    self.socket = self.manager.defaultSocket;\n    [self.socket on:@\"connecting\" callback:^(NSArray* data, SocketAckEmitter* ack) {\n        // this method not call.... while statusChange is connecting\n        NSLog(@\"socket connecting\");\n    }];\n    [self.socket on:@\"statusChange\" callback:^(NSArray* data, SocketAckEmitter* ack) {\n        //when excute this method crash\n        NSInteger status = [[data firstObject] integerValue];\n        if (status == SocketIOStatusConnecting) {\n            //do other thing.\n        }\n    }];\n    [self.socket connect];\n}\nlogs\n```\n2019-01-12 00:08:07.190984+0800 ModelO[2953:125439] LOG SocketIOClient{/}: Adding handler for event: connecting\n2019-01-12 00:08:07.191311+0800 ModelO[2953:125439] LOG SocketIOClient{/}: Adding handler for event: statusChange\n2019-01-12 00:08:07.191565+0800 ModelO[2953:125439] LOG SocketIOClient{/}: Handling event: statusChange with data: [connecting]\n2019-01-12 00:08:15.044914+0800 ModelO[2953:125439] -[_SwiftValue integerValue]: unrecognized selector sent to instance 0x600001118990\n2019-01-12 00:08:15.048586+0800 ModelO[2953:125439]  Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[_SwiftValue integerValue]: unrecognized selector sent to instance 0x600001118990'\n First throw call stack:\n(\n    0   CoreFoundation                      0x000000010dc5f1bb exceptionPreprocess + 331\n    1   libobjc.A.dylib                     0x000000010d1fd735 objc_exception_throw + 48\n    2   CoreFoundation                      0x000000010dc7df44 -[NSObject(NSObject) doesNotRecognizeSelector:] + 132\n    3   CoreFoundation                      0x000000010dc63ed6 forwarding + 1446\n    4   CoreFoundation                      0x000000010dc65da8 _CF_forwarding_prep_0 + 120\n    5   ModelO                              0x000000010c756c0b __27-[ViewController configure]_block_invoke_2 + 123\n    6   SocketIO                            0x000000010ca77c43 $SSo7NSArrayC8SocketIO0B10AckEmitterCIeyByy_SayypGAEIeggg_TR + 67\n    7   SocketIO                            0x000000010ca77cad $SSo7NSArrayC8SocketIO0B10AckEmitterCIeyByy_SayypGAEIeggg_TRTA + 13\n    8   SocketIO                            0x000000010ca6b646 $S8SocketIO0A12EventHandlerV15executeCallback4with0G3Ack0gA0ySayypG_SiAA0A8IOClientCtF + 166\n    9   SocketIO                            0x000000010ca7517f $S8SocketIO0A8IOClientC11handleEvent_4data17isInternalMessage7withAckySS_SayypGSbSitF + 2111\n    10  SocketIO                            0x000000010ca74916 $S8SocketIO0A8IOClientC17handleClientEvent_4datayAA0aeF0O_SayypGtF + 134\n    11  SocketIO                            0x000000010ca6fe27 $S8SocketIO0A8IOClientC6statusAA0A8IOStatusOvW + 247\n    12  SocketIO                            0x000000010ca6fd1a $S8SocketIO0A8IOClientC6statusAA0A8IOStatusOvs + 218\n    13  SocketIO                            0x000000010ca71108 $S8SocketIO0A8IOClientC7connect12timeoutAfter11withHandlerySd_yycSgtF + 664\n    14  SocketIO                            0x000000010ca70e1b $S8SocketIO0A8IOClientC7connectyyF + 59\n    15  SocketIO                            0x000000010ca70e54 $S8SocketIO0A8IOClientC7connectyyFTo + 36\n    16  ModelO                              0x000000010c756aaf -[ViewController configure] + 831\n    17  ModelO                              0x000000010c756769 -[ViewController viewDidAppear:] + 89\n    18  UIKitCore                           0x0000000116978544 -[UIViewController _setViewAppearState:isAnimating:] + 947\n    19  UIKitCore                           0x000000011697b27d __64-[UIViewController viewDidMoveToWindow:shouldAppearOrDisappear:]_block_invoke + 42\n    20  UIKitCore                           0x00000001169795e2 -[UIViewController _executeAfterAppearanceBlock] + 78\n    21  UIKitCore                           0x0000000116f9d20e _runAfterCACommitDeferredBlocks + 634\n    22  UIKitCore                           0x0000000116f8bb2c _cleanUpAfterCAFlushAndRunDeferredBlocks + 384\n    23  UIKitCore                           0x0000000116fac2de __34-[UIApplication _firstCommitBlock]_block_invoke_2 + 153\n    24  CoreFoundation                      0x000000010dbc462c __CFRUNLOOP_IS_CALLING_OUT_TO_A_BLOCK + 12\n    25  CoreFoundation                      0x000000010dbc3de0 __CFRunLoopDoBlocks + 336\n    26  CoreFoundation                      0x000000010dbbe654 __CFRunLoopRun + 1284\n    27  CoreFoundation                      0x000000010dbbde11 CFRunLoopRunSpecific + 625\n    28  GraphicsServices                    0x00000001143d21dd GSEventRunModal + 62\n    29  UIKitCore                           0x0000000116f9181d UIApplicationMain + 140\n    30  ModelO                              0x000000010c7574d0 main + 112\n    31  libdyld.dylib                       0x00000001100b8575 start + 1\n)\nlibc++abi.dylib: terminating with uncaught exception of type NSException\n(lldb) \n```\nWhen [self.socket on:@\"statusChange\" callback:^{ NSInteger status = [[data firstObject] integerValue];}] is called , crashed. because  [data firstObject]  is a _SwiftValue. and    [self.socket on:@\"connecting\" callback:^(NSArray data, SocketAckEmitter ack) {}] is not called when connect status is connecting; \nIs there something wrong with my demo configure? Or do I have to set other build options\uff1f\nenv : pod 'Socket.IO-Client-Swift','~> 13.3.0'. > Okay, I think I see how to fix this. It will require a minor version bump. Basically it looks like if, in Swift, you pass an @objc enum to Objective-C, you must pass the rawValue instead of the Swift enum.\nEn,Solving is really fast And another thing that confuses me is why I focus on 'connecting ,connect, disconect ...' those events but those method not call when  socket`s connect status  did change. What i think is that the sockets connect status change and if you you implement socket on \"connenting\" method it should call.. When will you release the new version \uff1f \ud83d\ude01. Hi nuclearace,I find this problem still exists. Im sure my new version is  v14.0.0\n\nThe  _SwiftValue  type still not convert any OC type.   @nuclearace . ",
    "julonglu": "need Bridging Header\ncreate one swift file. ",
    "sooryaraj": "\n@sooryaraj What Swift version is this?\n\nswift 4. ",
    "IvanOnishchenko": "Forgot add to pod file  \"use_frameworks!\". ",
    "Tdreamy": "manager = SocketManager(socketURL: url, config: [.log(true), .cookies([cookie])])\n        self.manager!.defaultSocket.on(clientEvent: .connect) { weak self in\n            self?.connectSig.accept(true)\n        }\n        client!.on(clientEvent: SocketClientEvent.error) { (data, ack) in\n            DLog(data)\n        }\n        client!.on(\"responseTick\") { (data, ack) in\n            DLog(data)\n        }\n        client!.connect()\n. ",
    "hatjs880328s": "how can i disconnect all sockets right now ?!!. 2019-03-15 15:48:50.969586+0800 imp cloud[4768:1072557] LOG SocketEngine: Handshaking\n2019-03-15 15:48:51.244831+0800 imp cloud[4768:1072557] LOG SocketEngine: Got message: 0{\"sid\":\"KZp2x4EvkxUmS1gFBxsv\",\"upgrades\":[],\"pingInterval\":25000,\"pingTimeout\":60000}\n2019-03-15 15:48:51.245077+0800 imp cloud[4768:1072382] LOG SocketManager: Trying to reconnect\n2019-03-15 15:48:51.245114+0800 imp cloud[4768:1072382] LOG SocketIOClient{/api/v1}: Handling event: reconnectAttempt with data: [4]\n2019-03-15 15:48:51.245141+0800 imp cloud[4768:1072382] LOG SocketIOClient{/}: Handling event: reconnectAttempt with data: [4]\n2019-03-15 15:48:51.245176+0800 imp cloud[4768:1072382] LOG SocketManager: Tried connecting an already active socket\n2019-03-15 15:48:51.245256+0800 imp cloud[4768:1072382] LOG SocketIOClient{/api/v1}: Handling event: ping with data: []\n2019-03-15 15:48:51.245280+0800 imp cloud[4768:1072382] LOG SocketIOClient{/}: Handling event: ping with data: []\n2019-03-15 15:48:51.245301+0800 imp cloud[4768:1072557] LOG SocketEngine: Got message: 40\n2019-03-15 15:48:51.245315+0800 imp cloud[4768:1072382] LOG SocketManager: Engine opened Connect\n2019-03-15 15:48:51.245340+0800 imp cloud[4768:1072382] LOG SocketIOClient{/}: Socket connected\n2019-03-15 15:48:51.245366+0800 imp cloud[4768:1072382] LOG SocketIOClient{/}: Handling event: statusChange with data: [connected]\n2019-03-15 15:48:51.245393+0800 imp cloud[4768:1072382] LOG SocketIOClient{/}: Handling event: connect with data: [\"/\"]\n2019-03-15 15:48:51.245406+0800 imp cloud[4768:1072557] LOG SocketEngine: Writing ws:  has data: false\n2019-03-15 15:48:51.245426+0800 imp cloud[4768:1072557] LOG SocketEngineWebSocket: Sending ws:  as type: 2\n2019-03-15 15:48:51.245438+0800 imp cloud[4768:1072382] LOG SocketParser: Parsing 0\n2019-03-15 15:48:51.245454+0800 imp cloud[4768:1072557] LOG SocketEngine: Got message: 42[\"status\",{\"code\":401,\"message\":\"401 - Invalid identity credential: Not authorized.\"}]\n2019-03-15 15:48:51.245478+0800 imp cloud[4768:1072382] LOG SocketParser: Decoded packet as: SocketPacket {type: 0; data: []; id: -1; placeholders: 0; nsp: /}\n2019-03-15 15:48:51.245495+0800 imp cloud[4768:1072557] LOG SocketEngine: Got message: 41\n2019-03-15 15:48:51.245531+0800 imp cloud[4768:1072382] LOG SocketParser: Parsing 2[\"status\",{\"code\":401,\"message\":\"401 - Invalid identity credential: Not authorized.\"}]\n2019-03-15 15:48:51.245630+0800 imp cloud[4768:1072382] LOG SocketParser: Decoded packet as: SocketPacket {type: 2; data: [status, {\n    code = 401;\n    message = \"401 - Invalid identity credential: Not authorized.\";\n}]; id: -1; placeholders: -1; nsp: /}\n2019-03-15 15:48:51.245675+0800 imp cloud[4768:1072557] ERROR SocketEngine: \u672a\u80fd\u5b8c\u6210\u64cd\u4f5c\u3002\uff08\u201cStarscream.WSError\u201d\u9519\u8bef 1\u3002\uff09\n2019-03-15 15:48:51.245682+0800 imp cloud[4768:1072382] LOG SocketIOClient{/}: Handling event: status with data: [{\n    code = 401;\n    message = \"401 - Invalid identity credential: Not authorized.\";\n}]\n2019-03-15 15:48:51.245730+0800 imp cloud[4768:1072382] LOG SocketParser: Parsing 1. ",
    "sangriel": "my version is socket io swift client 14.0.0 using swfit 4.2 and xcode 9\n. ",
    "naderio": "in the JavaScript API, when an event expecting an ack is sent by server, the client provides the ack callback as last argument in event handler.\nnot a way to \"require\" an ack .. more like \"an ack is expected\"\n. ",
    "zhangtaotao": "if I want to pong time but  The data array can is empty,. "
}