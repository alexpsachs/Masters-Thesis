{
    "petersirka": "Thanks! My english is poor, thanks.\n. Hi, what version of partial.js and OS are you using?\n\nThanks.\n. Please, could you try to update partial.js? And give me your feedback.\nThanks.\n. Hi, thanks for report a problem. I fixed it, but new version of partial.js will be a few days.\nHow to solve a problem?\n$ cd /path/to/your/project/\n$ node index\nThanks!\n. What Operating System do you use? What version of partial.js do you use?\nPlease write me - error message.\nThanks.\n. Can you pack (.zip) your project and send it to me?\nE-mail: petersirka@gmail.com\nThank you.\n. \nDownload this code and run it. Please give me your feedback.\nhttp://www.partialjs.com/upload/test.zip\n. @nuky89 great!\n@Gigiz and you?\n. Thank you!\n. I updated this example.\n. Hi, thank you for report a problem. I fixed this problem.\nPlease reinstall partial.js via NPM and give me your feedback:\n$ sudo npm install -g partial.js\nThank you.\n. I tried it now:\n\nRun this commands:\n$ sudo npm install -g partial.js\nmkrdir test\ncd test\npartial.js -version\npartial.js\n... and send me your screen shot. Thank you.\n. @eMarek problem is in NPM. e.g.: partial.js has no dependencies (see to package.json).\nOne time I had similar problem as you. Try to clean two directories:\n/usr/lib/node_modules/\n/usr/local/lib/node/\nand re-install partial.js ...\nThank you + give me your feedback.\n. I don't understand.... I tested functionality on OSX, Windows and Ubuntu 12.04:\n\n\nPlease check if exists below directory:\n\nReally I don't understand.\n. You can download \"empty project\": http://partialjs.com/upload/empty-project.zip\n. Hi @khoaho,\nDid you replace 8000 port for process.env.PORT?\nInsert this code to partial.js website /yourwebsite/modules/#.js\n``` javascript\nexports.onError = function(err, name, uri) {\n// directory \"/yourwebsite/logs/\" must exists\n// save error to log file\nthis.log(err.toString(), name, uri, err.stack);\n\n};\n```\nI try to test partial.js on IISNODE and I have problem with the static files.\nTry it:\n1. add a new website to IIS\n   \n2. add a new host to hosts\n   \n3. update web.config\n   \n4. test it\n   \nThank you :-)\n. There is one problem. Your website must run as \"website\" not \"in website\".\nhttp://www.netscriptcad.com\nor\nhttp://blog.netscriptcad.com\nIn short time I will try to test your problem on Windows Server.\nI will give a feedback.\n. I'm so sorry. I have to wait for colleague (he is on holiday) because I haven't privileges.\nDid you try to copy partial.js project into root? I'm sorry, I cannot help you - It is beyond me.\n. Hi @khoaho,\nsend me your website with the web.config (petersirka@gmail.com). I'll try to test it at home.\n\"Where can I track log files of Node.js & partial.js in the remote server?\"\n``` javascript\n// Catch all errors\n// /yourwebsite/modules/#.js\nexports.onError = function(err, name, uri) {\nconsole.log(err.toString(), err.stack);\n\nvar path = uri === null ? '' : uri.href;\nthis.log(err, '|', 'name: ' + (name || '').toString(), '|', 'path: ' + path);\n\n};\n```\nThank you.\n. I replied. Thank you.\n. Is possible to download virtual with Chromium?\nThanks.\n. I understand.... I will try to test on Ubuntu today evening.\n. I did not know that Google Chrome is Chromium on the Linux.\nI tested on Ubuntu 12.04 Desktop:\n\nPlease, download the Chat again: http://www.partialjs.com/upload/chat.zip and send me a screenshot.\nThanks.\n. Hi @eMarek,\nI don't know how to explain it :-) ... Your reply is in the file: https://github.com/petersirka/partial.js/blob/master/examples/authorization/modules/%23.js (#.js)\n``` javascript\nexports.onAuthorization = function(req, res, flags, callback) {\nvar self = this;\n\n// check the cookie\n// req.cookie(@name {String}) return {String}\nvar cookie = req.cookie(self.config.cookie);\nif (cookie === null || cookie.length < 10) {\n    callback(false);\n    return;\n}\n\n// Decode the cookie value\n// Framework.decode(@value {String}, @key {String}) return {Object}\n// Look at this: Global.js --> self.res.cookie(self.config.cookie, self.app.encode({ id: user.id, ip: self.req.ip }, 'user'), new Date().add('m', 5));\nvar obj = self.decode(cookie, 'user');\n\nif (obj === null || obj === '' || obj.ip !== req.ip) {\n    callback(false);\n    return;\n}\n\n// we check if user is logged\n// simple cache for logged users\nvar user = self.cache.read('user_' + obj.id);\nif (user !== null) {\n\n    // if is user logged then we will add user information to request.session\n    req.session = user;\n    callback(true);\n    return;\n}\n\nvar db = self.database('users');\n\n// find a user in database\ndb.one('doc.id === {0}'.format(obj.id), function(user) {\n\n    if (user === null) {\n        callback(false);\n        return;\n    }\n\n    // save user information to cache\n    self.cache.write('user_' + user.id, user, new Date().add('m', 5));\n    req.session = user;\n\n    callback(true);\n});\n\n};\n```\nI hope that I helped you.\n. Yes. The benefit of onAuthorize is async access.\n. Yes, but best practices is write a route with the logged flag.\nExample:\n``` javascript\nframework.onAuthorization = function(req, res, flags, callback) {\n     req.session = { isLogged: true };\n     callback(true);\n};\n// In a controller:\nfunction my_controller_view() {\n    var self = this;\n    var isLogged = self.session && self.session.isLogged;\n}\n```\n. Hi @eMarek,\nsorry - I updated the example.\nLook here:\nhttps://github.com/petersirka/partial.js-modules\nhttps://github.com/petersirka/partial.js-modules/tree/master/authorization\nThanks!\n. Hi @eMarek,\nIn last update I have 2 problems with the session. Empty object is a big problem because I do not verify which is used or no. Then I created a session module and discovered this problem. Next problem was in storing session to the cache or database. I'm really sorry, but this update opened more options. I added a user object to the controller and request:\ncontroller.user; (default null)\ncontroller.session; (default null)\nWhat happend with the cache?\nI unified the function names.\nNow I'm writting detailed documentation and sorry for all complications.\nThanks!\n. Cache\nYes\nSession\nI added a new example Memcached (I didn't test it):\nhttps://github.com/petersirka/partial.js-modules/tree/master/session\nYes, session is still possible to use without session.js module.\n\nMany thanks :-)\n. It's there BIG problem. I fixed it.\nToday I'll update NPM version. Please download partial.js from GitHub (only index.js).\nThanks for report! I'll must update an unit test.\n. Hi @eMarek,\nyou must disable the layout:\n``` javascript\nexports.install = function(framework) {\n    framework.route('/', landingPage);\nframework.route('/loadPanel', loadPanel, ['+xhr']);\n\n// xhr        = XHR GET reuqest\n// xhr, post  = XHR POST request\n// +xhr       = XHR POST or GET request\n\n};\nfunction landingPage() {\n    var self = this;\n    self.view('company');\n}\nfunction loadPanel() {\n    var self = this;\nif (self.xhr)\n    self.layout('');\n\n/*\n    Response View\n    name {String}\n    model {Object}\n    headers {Object} :: optional\n    isPartial {Boolean} :: optional\n    return {Controller or String} :: if isPartial === true then return {String}\n*/\nself.view(self.post.choice);\n\n// ==========================================\n// OR\n// ==========================================\n\nvar output = [];\n\n// render \"view\" to string\noutput.push(self.view('view1', null, true));\noutput.push(self.view('view2', null, true));\n\n/*\n    Response Content\n    contentBody {String} :: required\n    contentType {String} :: required\n    return {Controller}\n*/\nself.content(output.join('\\n'), 'text/html');\n\n}\n```\n. Good idea. In the afternoon I thought about it, but I don't know. I have one solutions for you yet:\n\nyourwebsite/modules/#.js\n\n``` javascript\n// this code affect all controllers\nframework.on('controller', function(controller, name) {\nif (!controller.xhr)\n    return;\n\nif (controller.url.indexOf('/loadPanel') !== -1)\n    return;\n\ncontroller.setLayout('');\n\n});\n```\nOR\n``` javascript\nexports.install = function(framework) {\n    framework.route('/', landingPage);\n    framework.route('/loadPanel', loadPanel, ['xhr']);\n};\n// this code affect only this controller\nexports.onRequest = function(controller) {\nif (!controller.xhr)\n    return;\n\nif (controller.url.indexOf('/loadPanel') !== -1)\n    return;\n\ncontroller.setLayout('');\n\n});\n```\n. @eMarek,\nI'm so sorry ....\njavascript\ncontroller.layout('');\n. javascript\nexports.onLoaded = function(framework) {\n    framework.on('controller', function(controller, name) {\n    // ...\n    // ...\n    // ...\n    };\n};\n. Hi\u00a0@veslo1,\ngood choice is translate \"views\" only.\nFor example:\n``` javascript\nexports.install = function(framework) {\n    framework.route('/{language}/', view_homepage);\n    framework.route('/{language}/products/', view_products);\n};\nfunction view_homepage(language) {\n    language = language || 'en';\n    this.view('homepage-' + language);\n};\n// ....\n// ....\n```\nOR\n``` javascript\nexports.install = function(framework) {\n    framework.route('/', view_homepage);\n};\nexports.onRequest = function(controller) {\n    // this code affect only this controller\n    var language = controller.req.cookie('language') || '';\nif (language === '')\n    language = controller.req.headers['accept-language'];\n\ncontroller.language = language.indexOf('cz') !== -1 ? 'cz' : language.indexOf('sk') !== -1 ? 'sk' : 'en';\n\n};\nfunction view_homepage() {\n    var self = this;\n// self.language === {String}\n\nself.view('homepage-' + self.language);\n\n};\n```\nOR\n\nyourwebsite/modules/#.js\n\n``` javascript\nexports.onLoaded = function(framework) {\n// this code affect all controllers\nframework.on('controller', function(controller, name) {\n    var language = controller.req.cookie('language') || '';\n\n    if (language === '')\n        language = controller.req.headers['accept-language'];\n\n    controller.language = language.indexOf('cz') !== -1 ? 'cz' : language.indexOf('sk') !== -1 ? 'sk' : 'en';\n});\n\n};\n```\n\nyourwebsite/modules/controller.js\n\n``` javascript\nexports.install = function(framework) {\n    framework.route('/', view_homepage);\n};\nfunction view_homepage() {\n    var self = this;\n// self.language === {String}\n\nself.view('homepage-' + self.language);\n\n};\n```\n\nhttps://github.com/petersirka/partial.js/tree/master/examples/localization-resources\n. Hi @mochja :-(\nsorry, LESS implementation in partial.js is simple. I'm preparing a new version of partial.js and I will implement new delegate for CSS and JS processing. So you can use 3rd module for CSS processing.\nCurrent supported options: https://github.com/petersirka/partial.js/blob/master/examples/css-less/public/css/p.css\nNew version will be in a few days.\n. Hi @mochja,\nI updated partial.js version:\nhttps://github.com/petersirka/partial.js/tree/master/examples/external-compile-sass\n. Hi\u00a0@eMarek,\nI prefer a model for data binding and for others repository. Repository is a global storage for all views and a model for current view. It's not standard, It's my best practice.\n. Please test it. After the view() is cleaned a controller.\n``` javascript\n    if(post.userID) {\n    // model.ID = post.userID;\n\n    self.database('users').one(function(doc) {\n\n        //does user with 'userID' exist\n        return doc.ID === post.userID;\n\n    }, function(doc) {\n\n        model = doc;\n\n        self.view('settings/user-edit', model);\n    });\n\n    // ========================================\n    // HERE HERE HERE HERE\n    // ========================================\n    return;\n}\n\n```\nCode review:\n``` javascript\nfunction view_user_edit() {\n    var self = this;\n    var post = self.post;\nif (!post.userID) {\n    self.view('settings/user-edit', { ID: '' });\n    return;\n}\n\nself.database.one(expression('doc.id === post.userID', ['doc', 'post'], post), function(doc) {\n    self.view('settings/user-edit', doc);\n});\n\n}\n```\n. \"expression\" returns a function and the \"return value\" is executed string. This is \"magic\" :8ball:. Now I think that is bad practice because function will be executed every time and this is slowly than classic callback function - really sorry. Every coin has two side, one side is less code and other side is slowly performance - you must choose (I'm for the performance).\n\"expression\" use:\n``` javascript\nfunction arrayFindAll(arr, filter) {\nvar length = arr.length;\nvar selected = [];\n\nfor (var i = 0; i < length; i++) {\n    var value = arr[i];\n    if (filter(value))\n        selected.push(value);\n}\n\nreturn selected;\n\n};\nfunction arrayFindAllWithIndex(arr, filter) {\nvar length = arr.length;\nvar selected = [];\n\nfor (var i = 0; i < length; i++) {\n    var value = arr[i];\n    // i === index\n    if (filter(value, i))\n        selected.push(value);\n}\n\nreturn selected;\n\n};\nconsole.log(arrayFindAll([1, 2, 3, 4, 5, 6, 7, 8, 9, 10], expression('value > 5', ['value'])));\nconsole.log(arrayFindAll([1, 2, 3, 4, 5, 6, 7, 8, 9, 10], expression('value > myvalue && value < myvalue + 5', ['value', 'myvalue'], 3)));\n// expression('value > 5', ['value'])\nfunction(value) {\n    return value > 5;\n};\n// expression('value > myvalue && value < myvalue + 5', ['value', 'myvalue'], 3)))\nfunction(value, myvalue) {\n    return value > myvalue && value < myvalue + 5;\n};\n// We must add index param\nconsole.log(arrayFindAllWithIndex([1, 2, 3, 4, 5, 6, 7, 8, 9, 10], expression('value > 5', ['value', 'index'])));\nconsole.log(arrayFindAllWithIndex([1, 2, 3, 4, 5, 6, 7, 8, 9, 10], expression('value > myvalue && value < myvalue + 5', ['value', 'index', 'myvalue'], 3)));\n// expression('value > myvalue && value < myvalue + 5', ['value', 'index', 'myvalue'], 3)\nfunction(value, index, myvalue) {\n    return value > myvalue && value < myvalue + 5;\n};\n// BAD!!!!\n// myvalue === index\nconsole.log(arrayFindAllWithIndex([1, 2, 3, 4, 5, 6, 7, 8, 9, 10], expression('value > myvalue && value < myvalue + 5', ['value', 'myvalue'], 3)));\n// expression('value > myvalue && value < myvalue + 5', ['value', 'myvalue'], 3)\nfunction(value, myvalue) {\n    return value > myvalue && value < myvalue + 5;\n};\n```\n. > Why are here three parameters? Is myvalue automaticaly replaced with 3 in some mysterious way?\nYes, but not replace. It's not mysterious, it's closure :-). For example:\n``` javascript\nfunction fn(query, properties, param1, param2, etc..) {\n    return function() {\n        var param = [];\n        for (var i = 0; i < arguments.length; i++)\n            param.push(arguments[i]);\n    param.push(param1);\n    param.push(param2);\n\n    return eval('function(' + properties.join(',') + ') { return ' + query + ' };').apply(this, param);\n};\n\n}\n```\n\nAnyway I do not want to harass you.\n\nIt's ok :+1: \n. This is full declaration of expression.\nYou'll understand.\n``` javascript\nvar expressionCache = {};\nfunction expression(query, params) {\nvar name = params.join(',');\nvar fn = expressionCache[query + '-' + name];\n\nif (!fn) {\n    fn = eval('(function(' + name +'){' + (query.indexOf('return') === -1 ? 'return ' : '') + query + '})');\n    expressionCache[query + name] = fn;\n}\n\nvar values = [];\n\nfor (var i = 2; i < arguments.length; i++)\n    values.push(arguments[i]);\n\nreturn (function() {\n    var arr = [];\n\n    for (var i = 0; i < arguments.length; i++)\n        arr.push(arguments[i]);\n\n    for (var i = 0; i < values.length; i++)\n        arr.push(values[i]);\n\n    return fn.apply(this, arr);\n});\n\n}\n```\nThank you.\n. Hi @KiPSOFT,\nAre you using some database module? If you can, please write me more information about your problem. \n\nNow you can solve your problem like this:\n``` javascript\nframework.on('service', function(count) {\nif (count % 20 === 0) {\n    // resources\n    // databases (framework.databases = {})\n    // reconfigure\n}\n\nif (count % 10 === 0) {\n    // stats (websocket, web, files)\n}\n\nif (count % 5 === 0) {\n    // cache for static files\n    // cache for static files (range/streaming)\n}\n\n});\n```\nI added new event \"clear\" into new version. New version will be available in few days.\nIf you have some tips or recommendation write me.\njavascript\nframework.on('clear', function(name) {\n    switch (name) {\n        case 'stats':\n        case 'static':\n        case 'resources':\n            break;\n    }\n});\n. Ahaa. So I know what you want.\nI will add new event.\nThanks.\n. Hi @goldalworming,\njavascript\ncd yourwebsite\nnpm install partial.js\nnode index\nor \njavascript\nsudo npm install -g partial.js\ncd yourwebsite\nnode index\n. No ... You must install other modules:\nRedis:\nhttps://github.com/mranney/node_redis\nMySQL:\nhttps://github.com/felixge/node-mysql\nExample:\njavascript\ncd yourwebsite\nnpm install redis\nnpm install mysql\nnpm install partial.js\nnode index\nor install as global module\njavascript\nsudo npm install -g redis\nsudo npm install -g mysql\nsudo npm install -g partial.js\ncd yourwebsite\nnode index\npartial.js is web application framework without dependencies :+1: \n. @goldalworming, read please: https://github.com/petersirka/partial.js/issues/6\nAnd give me the feedback. Thanks.\n. Download https://github.com/petersirka/partial.js/archive/master.zip and remove all files without examples directory. Then run each example via terminal. That's all :-)\n. cd /programming/nodejs/partial.js-master/examples/\nnpm install partial.js\nnode index\n. Hi @jfelipesilva,\nIf your browser doesn't support WebSocket then Socket.io communicate throught XHR. This is not good because speed is very low. http://socket.io/#browser-support\nIn partial.js you must write this feature.\n. Hi @eMarek,\nno, but you can write route to file:\nhttps://github.com/petersirka/partial.js/blob/master/examples/download-file-counter/controllers/default.js\nBe careful, because you lose a features of controller.\n. https://github.com/petersirka/partial.js/blob/master/index.js#L5190\nWhy did you add .json file extension to url?\n. Hi, this is my tip:\nHTML\n- all templates you can store in public directory\n- is there auto HTTP cache\n- you don't need to write a controller\n/public/views/products.html\n/public/views/users.html\nJSON\n- generate in a controller\n- more options\n. Please download framework from GitHub, because I fixed problem with 401 Unauthorized.\nI'll publish new version after the weekend.\nI hope this is the solution for your problem:\n``` javascript\nexports.install = function(framework) {\n    framework.route('#401', error401);\n};\n// Unauthorized\nfunction error401() {\n    var self = this;\n// redirect to login form\nself.redirect('/login/?url=' + encodeURIComponent(self.req.uri.path));\n\n}\n```\n. Nothing. All files in public directory are public.\nSolution:\n``` javascript\nexports.install = function(framework) {\n// /download/1/ == 1.html\n// /download/2/ == 2.html\n// /download/3/ == 3.html\n// etc.\n\nframework.route('/download/{name}/', only_logged, ['logged']);\n\n// forbidden access to raw files\nframework.file('private *.html', function(req, res) {\n    return req.url.indexOf('.html') === -1;\n}, unauthorized);\n\n};\nfunction only_logged(name) {\nvar self = this;\n\n// check if file is exist\n// response file\nself.file(name + '.html');\n\n}\nfunction unauthorized(req, res) {\n    // this === framework\n    // new version will contain this.response401(req, res) - 401 unauthorized\n    this.response404(req, res);\n// or\n// res.writeHead(401);\n// res.end();\n\n}\n```\n. You wrote file handler for all static files. If you open http://ip:port/anything.html or anything.css then server response will 401. Please write me what you need and I'll try write a simple example.\nPS: I published new version\n. Aaa yes, I know what you want.\n401 will not executed because framework.response401(req,res) is outside of controller. Response401 return the response, but not execute a controller. File handler is outside of classic controller.\n. Hi @KiPSOFT,\ntest your code through Chrome or Firefox.\nThis works without problems:\nhttp://www.partialjs.com/upload/chat.zip\n\nIs possible that node.js WebSocket (module) doesn't support (RFC 6455 standard).\n. I don't know where is the problem.\npartial.js supports: standard RFC 6455, plain text (frame)\nYou must test all options. Sorry.\n. I'll test it in sunday and give a feedback. Thanks.\n. I'll add encode/decode string into the WebSocket.\nThanks.\n. Hi @nonameplum,\nDisabling compression can causes a serious problem.\nWhat happen if You use \u201eLESS\u201c OR \u201eSASS\u201c or \u201eAUTO-VENTOR-PREFIXES\u201c?\nI will add a new config item to disable the compression of JavaScript.\nThanks\n. Yes, documentation is bad. The problem is in two things:\n1. my english is bad\n2. I'm alone on all\nI'll add on/off option of JavaScript compression and I'll update the documentation of partial.js.\nThank you for your feedback.\n. Hi @capslow,\ncan you send me your js file? What version of total.js do you have?\nDisable minification:\nhttp://docs.totaljs.com/v1.7.x/en.html#api~FrameworkConfiguration~allow-compile-js\n. Thanks, no problem :+1: \n. Hi @eMarek,\nplease send me a screenshot of request headers. Thank you.\n. OK, try to add 'json' flag into the route.\nExample:\njavascript\nframework.route('/login/json/', json_login, ['json']);\nPlease give me a feedback.\n. Super.\nXHR flag:\n- request header must contain = X-Requested-With with XMLHttpRequest value (classic web browser AJAX request)\nJSON flag:\n- request body must contain a valid JSON string\nYou can use json and xhr flag together.\nThanks.\n. Hi @addremove,\nJSON - A content type of the request must be application/json\nXHR - Request must contain header X-Requested-With:XMLHttpRequest, this is a classic AJAX/XHR request\nThanks.\n. HI @sahilsethi16,\ndid you mean from the server-side or client-side?\nThanks.\nE.g. from client-side:\nhttps://github.com/petersirka/jquery.upload\n. @mansouridonia do you want to call this web service in Total.js application? Can you write me on Total.js Messenger, it will be faster.. Hi @gyuha :-)\nWhat do you want to do with the session? ... or .... What do you want to store into the session?\n. I updated partial.js and wrote a session module:\nhttps://github.com/petersirka/partial.js-modules\nFor more information about the new version:\nhttps://github.com/petersirka/partial.js/blob/master/changes.txt\n. Hi @KiPSOFT,\nwauu, many thanks. I'll write new better documentation in few days.\nThanks!\n. Which link can I use on web page?\n. I added link into the readme.\nThanks!\n. Please stop :-)\nI'll write new documentation in few days.\nPS: If documentation will be completed then you can continue.\nMany thanks!\n. Hi @Mirodil,\npartial.js supports multiple layouts:\nChange layout in a controller:\njavascript\nfunction view_homepage() {\n    var self = this;\n    self.layout('new-layout-name');\n    self.view('homepage');\n}\nChange layout in a view:\n@{layout('new-layout-name')}\nExample: https://github.com/petersirka/partial.js/tree/master/examples/views\nTry prefixes: https://github.com/petersirka/partial.js/tree/master/examples/mobile\n. You can use a \"partial content\":\nExample:\nhttps://github.com/petersirka/partial.js/tree/master/examples/routing-partial\nPartial content is asynchronous. You can load data from DB and wait for the result. Partial content can be global or specific. All views are synchronous.\nOr use async feature:\nExample:\nhttps://github.com/petersirka/partial.js/tree/master/examples/async\n\nIf you don't understand I'll write an example.\n. Asynchronous work is longer as default timeout:\n1. you can set up default timeout in the framework config file (default-request-timeout = 3000 (default - 3 seconds)\n2. or you can set up default timeout in the definition of route:\nExample:\nhttps://github.com/petersirka/partial.js/tree/master/examples/routing-timeout\n\nWhat is async?\nAsync is a class for asynchronous work. Async class helps you to do several things at the same time.\n. I'm writing a new documentation. There will a complete explanation.\nThanks.\n. Thanks - I'll look. \n. Hi @goldalworming,\nYes, it's better use other library. I found big problem with authorization and today (evening) I'll update NPM partial.js package - so then update your partial.js. I'll write example with oauth.\nThanks.\n. I'll write an example and update partial.js version today.\n. Hi\u00a0@goldalworming,\nI updated the version. Download: https://github.com/petersirka/partial.js/releases/tag/1.2.5-1\nI'm preparing an example of OAuth, please write me - Which module of OAuth do you use?\n. Super, I'll write an example with the passport.js today.\n. I looked on the passport.js and everyauth. Modules are written for Express.js and this is a problem. I must write own auth for Google, Facebook, Twitter and OpenID. Other modules haven't good documentation.\nReally sorry, I have no more time.\n. Yes ...\nonValidation:\nonValidation = is for object / values validation\nself.validate(object) == read all properties and on each property call onValidation.\n\nonAuthorization:\nIs called when a route has contain \"logged\" / \"unlogged\" flag.\nThanks.\n. You can use \"role route flags\".\nExample:\nhttps://github.com/petersirka/partial.js/tree/master/examples/routing-flags-roles\n. Hi @goldalworming,\nthere is only one alternative: XHR, but partial.js doesn't support pooling between SSE/WebSocket and XHR. You must write this feature :-)\n. partial.js supports SSE/WebSocket/XHR in one app. You must write a shared communication between SSE/WebSocket/XHR.\nTIP:\nWrite a custom module in partial.js and on each request (SSE/WebSocket/XHR) call a module.\n. Hi @goldalworming,\nPotentially can use node-oauth, but it is not guaranteed. You can rewrite (in its examples):\nres (response) -> controller.res;\nreq (request) -> controller.req;\nIf you use controller.res somewhere then before using you must call controller.close() for preventing of timeout. Please give me a feedback about using node-oauth according to article.\nPS: I wrote Login with Facebook (https://github.com/petersirka/partial.js-modules/tree/master/facebook)\nThanks!\n. Hi @KiPSOFT \n``` javascript\nvar self = this;\nself.view500(errorMessage);\n// or\nself.statusCode = 500;\nself.view('my-view-name');\n// or\nself.statusCode = 500;\nself.json({ error: 'Error' });\n```\n. Hi @klavs,\nI do not know whether it is a good idea. I'ts not problem to rewrite controller.view() for a custom engine. I must thinking about it.\nPS: If I'll have a free time then I'll write a custom module with hogan.js view engine. Now I'm writting a new documentation.\nThanks.\n. Hi @eMarek,\nYou must add into the config-debug/config-release a new value:\nstatic-accepts-custom       : .map\nFramework doesn't support all file types because of security. Default accepts this extensions: .jpg, .png, .gif, .ico, .js, .css, .txt, .xml, .woff, .ttf, .eot, .svg, .zip, .rar, .pdf, .docx, .xlsx, .doc, .xls, .html, .htm, .appcache.\n\"static-accepts-custom\" adds a new value into the above list.\nThanks.\n. Yes, I added it into the default.\nIn few days I'll update NPM partial.js package.\nThanks!\n. Hi @eMarek, I updated the version.\nDownload: https://github.com/petersirka/partial.js/releases/tag/1.2.5-1\n. Hi @royalgarter,\nGood idea:\njavascript\nself.port = process.env.PORT || port || 8000;\nBut I must change it to:\njavascript\nself.port = port || process.env.PORT || 8000;\nBecause defined port by the user has a higher priority. I updated framework.run() (https://github.com/petersirka/partial.js/blob/master/changes.txt)\nIMPORTANT:\nE-shop has very old code and framework version too. Today you can write similar eshop with the new version of partial.js more easier and faster.\nSolving of the problem with Heroku:\njavascript\nframework.run(http, false, process.env.PORT);\nIf you have some questions, please write me an e-mail. Thank you for your compliment :+1: \n. I don't know If should I add function or not. I don't know if It has a sense.\n. Hi @superpan3000,\nyou can not put a model into the layout, use a repository object. I disabled putting a model into the layout. Model is for current view - not for the layout.\nController:\njavascript\nfunction index(){\n    var self = this;\n    self.repository.model = { menu: { url:'/product', name:'Product' }};\n    self.view('index');\n}\nIndex:\nhtml\n<ul class=\"menu_index\">\n    <li><a href=\"@{repository.menu.url}\">@{repository.menu.name}</a></li>\n</ul>\nLayout:\nhtml\n<body>\n    <ul class=\"menu_layout\">\n        <li><a href=\"@{repository.menu.url}\">@{repository.menu.name}</a></li>\n    </ul>\n    <div>@{body}</div>\n</body>\nTIP: for creating a dynamic menu - look here:\nhttps://github.com/petersirka/partial.js/tree/master/examples/routing-partial\nand combine with:\nhttps://github.com/swc4848a/partial.js/tree/master/examples/templating\nThank you :-)\nIMPORTANT: watch out for @{}\n. Yes, differences:\n- repository is a temporary object for a current request / response\n- global is a static temporary object for ALL REQUEST / RESPONSE\nRepository:\nif your app will have 1000x of requests - then the framework will create 1000x of repository objects\nGlobal:\nif your app will have 1000x of requests - then framework use a global variable: framework.global == controller.global\nSorry for my EN.\nThanks.\n. partial.js doesn't support advanced conditions in templates (Template conditions).\nWhy?\nI optimized rendering for better performance and my thought for rendering: data must be prepared for rendering. Rendering of views and templates must be simple and effective. This is for compliance MVC pattern.\nSolution:\n1. create two arrays with menu items\n2. filter one menu array in partial content\nIf you have some questions or do you need some tips, write me.\nThanks.\n. Yes... The problem is in async but sometimes it has advantages. You must call a return - for stop next executing.\nThanks.\n. Hi @Mirodil,\nYou must add flag 'post' into the route:\njavascript\nframework.route('/login/facebook/callback', AccountController.facebook_callback, ['post']);\nBest practices:\nActions should be defined in a controller file (not in other files).\n. Here are defined all flags:\nhttp://docs.partialjs.com/HttpRouteOptionsFlags/\n. Yes.... But you can create same route with no 'post' flag. I will try add new flag for GET/POST together.\njavascript\nframework.route('/login/facebook/callback', AccountController.facebook_callback, ['post']);\nframework.route('/login/facebook/callback', AccountController.facebook_callback);\nDefine action:\n``` javascript\nfunction facebook_callback() {\n    var self = this;\nif (self.req.method === 'POST') {\n}\n\nself.empty();\n\n}\n```\n. Hi @KiPSOFT,\nYes but I must improve the quality and grammar of documentation. Sorry for delay. Thanks.\n. Hi @Mirodil,\njavascript\napi.completeTask1() // What does it do?\napi.completeTask2() // What does it do?\nI need more code. Try to set timeout to longer:\njavascript\nframework.route('/path/', view, { timeout: 10000 });\nhttp://docs.partialjs.com/Framework/#framework.route\nhttp://docs.partialjs.com/HttpRouteOptions/#timeout\n. Try to set timeout to longer. If is created a request into the controller then is set timeout according to route automatically. Give me a feedback.\nAre async tasks from third Party, yes?\nThanks.\n. Which API do you use? I will test it.\n. Ahh OK. Check if your module calls a callback. If you'll need help, contact me.\nThanks! I close this issue.\n. I forgot: you can set timeout to big number or disabled it for this request:\njavascript\nfunction some_view() {\n    var self = this;\n    clearTimeout(self.subscribe.timeout);\n}\nIf you have suspect for some error in partial.js contact me. I'll test timeout today.\n. Here is updated code:\nhttp://d.pr/f/8R6e\n---- I delete the code tomorrow.\n``` javascript\nexports.install = function(framework) {\n    framework.route('/', viewHomepage, { timeout: 20000 });\n};\nfunction viewHomepage() {\nvar self = this;\n\nself.await(function(next){\n    setTimeout(function() {\n        console.log('I am here');\n        next();\n    }, 1000 * 5);\n});\n\n// this run all async tasks\nself.complete(function() {\n    self.plain('done :)');\n});\n\n// or - below code executes \"complete\" function automatically\n\n// self.viewAync();\n// self.jsonAync();\n// self.viewAync();\n// self.fileAync();\n// self.redirectAync();\n\n}\n```\n. Hi @ZaLiTHkA,\nthanks, I fixed it.\n. Hi @eMarek,\ndefinition serves for setting of framework. In definition you can define some schemas or functionality. It's similar as global module.\nhttp://docs.partialjs.com/how-does-it-work/definitions/\nExample:\nhttps://github.com/petersirka/partial.js/tree/master/examples/framework-schema\n. We do not need configuration file.\n. Framework doesn't support auto reloading of controller.\nThe solution for you:\nhttp://stackoverflow.com/questions/11175676/restart-node-upon-changing-its-file\nI used \"supervisor\".\nThanks.\n. Hi @greatwar,\nI updated framework version and I added auto-refreshing changes:\nhttp://www.youtube.com/watch?v=4wLq_bJ_sfs\n. Hi @greatwar,\nTry to use of dynamic URL param:\n``` js\nframework.route('/{a}/{b}/shop/', view_shop);\nframework.route('/{a}/shop/', view_shop);\nframework.route('/shop/', view_shop);\nfunction view_shop(a, b) {\na = a || '';\nb = b || '';\n\n// ...\n// ...\n\n}\n```\nDo you understand? \n. I understand, you can't run 2 (or more) apps in one domain.\nI'll try to think how I can add this feature into the framework. Maybe I'll add this feature this week.\nThanks!\n. Hi @zygis, \n``` js\nframework.route('#404', error404);\n// --------\nfunction error404() {\n    var self = this;\nif (self.req.method === 'POST') {\n    // POST\n}\n\nif (self.xhr) {\n    // XHR\n}\n\nself.statusCode = 404;\nself.plain(utils.httpStatus(self.statusCode));\n\n}\n```\nThanks!\n. Ahaa, yes - sorry. This is problem. If you haven't defined a POST route - then framework will block all POST requests. I did it for safety (prevent for DDOS attacks).\n. This must go:\njs\nframework.route(\"/some/post\", function () {\n    this.plain('OK');\n}, ['post']);\n. > so it doesn't matter what's inside\n\nNo you must return some response because framework executed a timeout. This is very important.\n\n``` js\nexports.install = function(framework) {\n    framework.route('/some/post/', json_post, ['post']);\n};\nfunction json_post() {\n    var self = this;\n    self.json(self.post);\n    console.log(self.post);\n}\n```\n\n. Like this:\n``` js\nframework.route('/some/{path}/', json_post, ['post']);\n// ------------------------------------------------------------\nfunction json_post(path) {\n    // ...\n    // ...\n    // ...\n}\n```\n. Now I noticed - download new version of partial.js (or download source from GitHub - here is unpublished new version):\nhttp://www.partialjs.com/upload/empty-project.zip\nThanks!\n. Please write me your code, I'll test it.\nWhich reverse proxy are you using? (Nginx?) I'll test it.\n. You can define routes like this:\njs\nvar builder = '/';\nfor (var i = 0; i < 10; i++) {\n     builder += '{a' + i + '}/';\n     framework.route(builder, json_post, ['post']);\n}\n. Hi @zygis,\nyes there is a problem. I made a mistake in NPM package. I'll update partial.js version tomorrow. New version will be more stable and will contain great features.\nMany thanks for reporting.\n. Hi @zygis,\nI updated framework version.\nMany thanks!\n. Hi @goldalworming,\nthis is problem. Framework expected executing of controller.view, controller.json, controller.redirect, etc.. I must add new function for preventing of error.\nSolution:\n``` js\nfunction view_htmlstream() {\nvar self = this;\n\n// preventing of timeout\nself.subscribe.success();\n\nself.res.writeHead(200, { 'Content-Type': 'text/html' });   \nself.res.write('partial.js<br>');\nself.res.write('is<br>');\nself.res.write('very<br>');\nself.res.write('cool<br>');\n\n// close a response\n// IMPORTANT: this executes response.close();\nself.close();\n\n}\n```\nI added new function into the framework but I must wait with its publishing.\n``` js\nfunction view_htmlstream() {\nvar self = this;\n\nself.custom();\n\nself.res.writeHead(200, { 'Content-Type': 'text/html' });   \nself.res.write('partial.js<br>');\nself.res.write('is<br>');\nself.res.write('very<br>');\nself.res.write('cool<br>');\n\n}\n```\n. Yes because framework execute a timeout.\n``` js\n// this prevents a timeout\nself.subscribe.success();\n// then\nsetInterval ....\n// IMPORTANT: execute controller.close()\n```\nThanks. Give me a feedback.\n. Hi @goldalworming,\nif your .js/.css name will contain .min or -min ... then will not compiled.\nThanks.\n. Hi @eMarek,\nyes:\njs\nallow-compile-js    : false\nallow-compile-css   : false\n. Hi @greatwar,\nyes, I rewrote this functionality.\nSimple solution:\n``` js\n// define system route with 401\nexports.install = function(framework) {\n    framework.route('#401', view_401);\n}\nfunction view_401() {\nvar self = this;\n\nif (self.flags.indexOf('unlogged') !== -1) {\n    self.redirect('/login/form/');\n    return;\n}\n\nif (self.flags.indexOf('logged') !== -1) {\n    self.redirect('/your/account/');\n    return;\n}\n\nself.plain('Unauthorized');\n\n}\n```\nDo you understand?\n. Hi @gnetsys,\ntry to use http://docs.partialjs.com/FrameworkViews/#routeImage (and look here: https://github.com/petersirka/partial.js/blob/master/examples/views-route-to-file/views/subpage.html)\njs\n$(\"#demo\").background(@{routeImage('theimage.jpg')});\nOr create a custom helper:\n\n/definitions/your-definition-name-for-helper.js\n\n``` js\n// @{imagedirectory}\nframework.helpers.imagedirectory = '/img/background/theimage.jpg';\n// @{imagedirectory('theimage.jpg')}\nframework.helpers.imagedirectory = function(name) {\n    return '/img/background/' + name;\n};\n```\n. Hi @zygis,\nthis is a fucking situation. I fixed this problem but I think it's not good. Why?\nJSON flag should contain application/json content type. I don't know what to do. I left it so.\nI'll update partial.js version in few days. Please download source from GitHub.\nThanks.\n. Hi @sakateka,\nthanks ... I fixed it. So:\nIn new version this works:\njs\nframework.route(\"/api\", callback, {flags: [\"json\"], timeout: 10000});\nframework.route(\"/api\", callback, {flags: [\"post\"], timeout: 10000});\nframework.route(\"/api\", callback, {flags: [\"json\", \"put\"], timeout: 10000});\nIMPORTANT: for \"json\" flag must exist this condition: content-type must be an application/json.\nThanks!\n. Show me your request headers.\nThanks!\n2014/1/2 \u00aeygimantas notifications@github.com\n\nframework.route(\"/api\", post, {flags: [\"post\"], timeout: 10000});\nrequest body:\nkey1=value1&key2=value2\nresponse\nServer: nginx/1.5.7\nDate: Thu, 02 Jan 2014 09:09:34 GMT\nContent-Type: text/plain; charset=utf-8\nTransfer-Encoding: chunked\nConnection: keep-alive\nX-Powered-By: partial.js v1311\nCache-Control: private\nVary: Accept-Encoding\n400: Bad Request\nflags: [\"json\"] works as expected.\n\nReply to this email directly or view it on GitHubhttps://github.com/petersirka/partial.js/issues/52#issuecomment-31442663\n.\n\n\nS pozdravom Peter \u00a9irka\nWeb Site Design s.r.o.\nWeb Developer\npetersirka@gmail.com\n+421 903 163 302\n. You can use \"raw\" flag ... Then you do not use content-type in the request (but you must parse manually body from controller.post).\nThanks.\n. I found a bug in \"raw\" flag. I fixed it.\nReally sorry.\n. I published new version of partial.js. Please update your version and give me a feedback. IMPORTANT: if you want a RAW data then the request must have a content-type !== application/json.\nThanks!\n. Try to add: \"post\" flag.\nThanks!\n2014/1/2 \u00aeygimantas notifications@github.com\n\nNot working. Same response.\nPOST http://domain.tld/api\nContent-Type http://domain.tld/apiContent-Type: application/x-www-form-urlencoded\nkey1=value1&key2=value2\n-- response --\n0\n\nReply to this email directly or view it on GitHubhttps://github.com/petersirka/partial.js/issues/52#issuecomment-31462925\n.\n\n\nS pozdravom Peter \u00a9irka\nWeb Site Design s.r.o.\nWeb Developer\npetersirka@gmail.com\n+421 903 163 302\n. Hi @squidge,\nthis is problem :-( ... why? Microsoft JScript wants run a node.js binary file and this is bad. Otherwise: NPM should execute partial.js binary file (and this is not true).\nDownload empty project: https://github.com/petersirka/partial.js/releases ... and start coding :-)\n. Hi @raistlinthewiz,\nI long thought about it and it is not good idea. It is pretty and clean but the configuration file is part of initialize script.\nI hope that you'll understand. Maybe in a future.\nReally sorry.\nThanks.\n. Hi @hockeyst,\n``` js\n// ONLY:\n// http://subdomain.website.debug/\nframework.route('[subdomain]/', subdomain);\n// http://eshop.website.debug/\nframework.route('[eshop]/', subdomain);\n// http://blog.website.debug/\nframework.route('[blog]/', subdomain);\n// http://eshop.website.debug/\n// http://blog.website.debug/\nframework.route('[eshop,blog]/', subdomain);\n// ALL:\n// http://*.website.debug/\n// http://website.debug/\nframework.route('/', root);\n// ONLY:\n// http://website.debug/contact/\nframework.route('[]/contact/', contact);\n```\nI fixed [www] from routing of subdomain (https://github.com/petersirka/partial.js/blob/master/changes.txt#l41)\nDo you understand?\n. I recommend to run subdomain as a next node.js app.\n. Ahh I know what you need ...\n``` js\nfunction sudomain() {\n   var self = this;\n   // self.subdomain -> future version\nvar subdomain = self.req.subdomain;\n// IMPORTANT: subdomain contains also www (this I fixed in new version)\n   // new version will be this week (maybe)\nself.json(subdomain);\n}\n```\nThanks.\n. Thanks :-)\nNew version will be very good.\n. Hi @sakateka,\nthank you very much for report this problem. I fixed it.\nI'll publish new version maybe this week.\nThanks!\n. Hi @eMarek,\nit works with new version only :) .. I rewrote all examples and I'm preparing an update of documentation. You must wait :-)\nI hope that new version will this week. If you do not want to wait - download the new version from GitHub (https://github.com/petersirka/partial.js/tree/master/minify/partial.js).\nThanks\n. But I'm preparing new documentation.\nNew version has many changes:\nhttps://github.com/petersirka/partial.js/blob/master/changes.txt\nI do everything alone :-)\nThanks!\n. I'd like, but I don't have any experience with Angular +4. So we need to wait for someone who updates example to Angular +4.. Hi @eMarek,\nyes it's possible:\njs\n// DEFAULT: 200\nself.status = 401;\nFull code:\n``` js\nfunction auth_expiry() {\n    var self = this;\nif (\"user still has session\") {\n    self.json({ says: \"okay\", msg: \"You still have session!\" });\n}\nelse {\n    self.status = 401;\n    self.json({ says: \"error\", msg: \"Your session has expired!\" });\n}\n\n}\n```\n. Hi @eMarek,\nI published new version. Thanks.\n. Hello @yyken,\nplease write me:\n- browser name\n- browser version\n- your OS\n- node.js version\n- partial.js version\nThanks!\n. Try current version and give me a feedback:\nhttp://www.partialjs.com/upload/chat.zip\n\n. Super :+1: \nThanks.\n. No difference, only more comfortable :+1:\n. Hi @yyken,\nI'll try to add this feature according a documentation).\nThanks!\n. Hi @yyken,\nI fixed it.\nI published new version v1.3.0-1, so download it from http://www.partialjs.com/upload/empty-project.zip or https://github.com/petersirka/partial.js/releases.\nThanks! :+1: \n. Hi @asafama,\nmany thanks for your compliments, really appreciate it.\nWhich version of partial.js do you use?\nCould you write a simple example with partial.js and Grunt? I'll test it (send me your example to my e-mail petersirka@gmail.com as attachment (ZIP)).\nI must see the URL (accurate) address to image.\nThanks!\n. Angular.js problem:\nYou have older version of partial.js. You must install a new version or download version from https://github.com/petersirka/partial.js/releases.\nWhy don't you provide .sql file so we can import to our database?\nSQL importing is problem of modules, not partial.js. If MySQL module or Postgres module supports importing data from .sql file then partial.js also supports this functionality :+1: \nThanks!\n. Through NPM should be updated the framework to latest version.\nProblem is in the parameter \"-g\" because NPM is using different paths (I have problem too). Better is installing partial.js to each project.\n. Hi @goldalworming,\n1 problem:\nthis is MySQL documentation https://github.com/felixge/node-mysql ... Really sorry I don't know how it works.\nMaybe:\n``` js\nvar mysql = require('mysql');\nvar pool  = mysql.createPool({ database: 'DATABASE NAME', host: 'example.org', user: 'bob', password: 'secret' });\n// override the framework prototype\nframework.database = function(callback) {\n    return pool.getConnection(callback);\n};\n```\n2 problem:\nI fixed this problem. The problem was in model. Thanks!\n``` html\n model === array \n@{template('users', model)}\n older version \n@{template('users', model.rows)}\n```\n. Hi @thelinuxlich,\nI fixed it in upcoming version.\nThanks.\n. Thanks! I fixed it.\nI found problem with paths. To change path from relative (current) to absolute we'll must add ~ char at the begin path. It's working.\nThanks!\nPS: updated version is in source on GitHub.\n. Hi @yyken,\nYou can't disable HTML minification. But If you have problem with the JavaScript code then you must disable JS compression in the config file:\nallow-compile-js        : false\nSometimes I have similar problems but at last time I'm writing good code :-)\nThanks!\n. Ahh yes...\nyou must change a script tag to:\n<script type=\"text/javascript\">\nI'll fix this problem. Thanks.\n. Hi @thelinuxlich,\nHow do you mean?\nSend me email with debugging.js attachment and please write me your OS name + version.\nThanks.\n. @thelinuxlich please write me about your problem.\nThanks.\n. Hi @eMarek,\nEncode/decode functions wrote my colleague. Functions use XOR operation with ASCII code (today is not all 100% secured). Encode/Decode declaration is in utils.js (String.prototype.encode/String.prototype.decode).\nsecret\nsecret is as sugar (self.config.secret + '=' + key)\nIs framework.encode secure enough for encoding passwords?\nMaybe :-) but you can rewrite prototype and use http://nodejs.org/api/crypto.html for encode/decode values.\nThanks!\n. Yes ... this feature you can disabled:\nframework.encode(value, key, [isUnique]);\nframework.encode('123456', 'MyPASSWORD', false);\n. Hi @eMarek,\nI made some big changes.\n- added: controller.hash(type, value, [salt]);\n- added: controller.encrypt(value, [key], [isUnique])\n- added: controller.decrypt(value, [key], [jsonConvert])\n- added: string.sha256([salt])\n- added: string.sha512([salt])\n- updated: string.sha1() -> string.sha1([salt])\n- updated: string.md5() -> string.md5([salt])\n- renamed: string.encode() \u2013> string.encrypt([key], [isUnique])\n- renamed: string.decode() \u2013> string.decrypt([key])\n- renamed: string.htmlEncode() -> string.encode()\n- renamed: string.htmlDecode() -> string.decode()\n``` js\ncontroller.hash('sha256', '123456'); // SALT IS CONFIG.SECRET\ncontroller.hash('sha1', '123456', 'custom salt');\ncontroller.hash('md5', '123456', false); // SALT IS DISABLED\n'123456'.sha256(); // RAW SHA\n'123456'.sha256('custom salt'); // WITH CUSTOM SALT\n'123456'.sha512(this.config.secret); // WITH CONFIG.SECRET\n```\nAll changes:\nhttps://github.com/petersirka/partial.js/blob/master/changes.txt\nThis are last big changes. I think that it's better.\nThanks.\n. Thanks :-) I must to wait.\nDownload from here:\nhttp://d.pr/f/NMmr\n. Download from here:\nhttp://d.pr/f/P95q\n. Good idea, I added it.\n. I'll add these features :+1: but we must to wait for new version :-)\n. I'm waiting for this functionality in node.js.\n. Hi @thelinuxlich,\n- framework. is a global variable\n- utils. is a global variable\n- builders. is a global variable\nModule for logging:\njs\nexports.log = function(message) {\n   console.log(message);\n};\nOther module:\njs\nexports.now = function() {\n    // framework. is global variable\n    // utils. is global variable\n    // builders. is global variable\n    framework.module('log').log('now()');\n};\nOR\nOther module:\n``` js\nvar instance;\nexports.now = function() {\n    instance.module('log').log('now()');\n};\nexports.install = function(framework) {\n   instance = framework;\n};\n```\n. Yes. Module is a \"special controller\".\nOther options:\n``` js\nexports.install = function(framework) {\n    framework.route('/module/', view_module);\n};\n// http://docs.partialjs.com/FrameworkController/#exports.usage\nexports.usage = function(detailed) {\n    return detailed ? 'detailed usage' : 'usage';\n};\n// http://docs.partialjs.com/FrameworkController/#exports.request\nexports.request = function() {\n    // this === module\n}\nfunction view_module() {\n    this.view('module-view');\n}\n```\n. Great idea!\nI'll add functionality into the controller.\nCurrent version:\njs\nthis.custom();\nvar buffer = new Buffer(\"R0lGODlhAQABAIAAAAAAAAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==\", 'base64');\nthis.res.write(buffer.toString('binary'), 'binary');\n. Is it not correctly.\nUse my code.\n. js\nvar isSecure = this.req.uri.protocol === 'https';\nOR in new version:\n``` js\ncontroller.isSecure;\nreq.isSecure;\nframework.route('/', view_homepage_http, ['http']);\nframework.route('/', view_homepage_https ['https']);\nframework.route('/both/', view_http_https);\n```\nThanks for tip! :+1: \n. New changes: https://github.com/petersirka/partial.js/blob/master/changes.txt\n. Is it not possible.\nOnly:\nexports.install = function(framework) {\n    framework.route('/{a}/', view_all);\n    framework.route('/{a}/{b}', view_all);\n    framework.route('/{a}/{b}/{c}', view_all);\n    framework.route('/{a}/{b}/{c}/{d}/', view_all);\n};\nOR\nexports.install = function(framework) {\n    framework.route('#404', view_all);\n};\n. Hi @gw0,\nAll tests are in test directory \"test\". I don't know how coffeescript works and partial.js is written only for plain JavaScript.\nHow to run a test?\nnode app.framework-debug.js\nnode app.builders.js\nnode app.less.js\nnode app.javascript.js\nnode app.utils.js\nThanks.\n. I'm still thinking....\n. - for simple prototyping (and it's to saving a memory and improvements a performance) and it's hard to explain it :-)\n- node.js modules are different from partial.js definitions and modules\n- which parts?\nAll informations about working of framework you can find in the framework documentation.\nhttp://docs.partialjs.com\n. Hi @eMarek,\nyes.\nWhy definitions?\nthis picture writes work:\n\n- in the definition you can configure a module or framework without modification code of module or framework\n- if you have a module from 3rd party then you can configure this module in a definition (example: partial.js modules)\nYou know that all important settings of framework or modules will stored in definitions - (this is my idea). And there is still a possibility use the framework without definitions :+1: \n. A module is a good way.\n. Create a new module e.g. utils.js and then add new functions there. This module you can copy between projects.\n. \"request-begin\" in executed before \"controller\". But it's the same.\n. Why do you not use an authorization module?\nhttps://github.com/petersirka/partial.js-modules/tree/master/authorization\nExample:\n``` js\nframework.on('controller', function(controller, name) {\n// example\n   if (controller.user.isExpired && controller.url !== 'you-must-login') {\n   // This cancel an action\n   controller.cancel();\n   controller.redirect('/you-must-login/');\n   return;\n\n}\n});\n```\n. I gave \"return\" because I suppose code to continue. Return does not affect canceling of controller.\nSteps:\n1. routing\n2. executing of events (controller.cancel() works)\n3. executing of action in controller (controller.cancel() doesn't work - because action is executed)\n. Yes ... partial routing.\nhttps://github.com/petersirka/partial.js/tree/master/examples/routing-partial\n. Yes, because you must create a route to file (framework.file())\nMore:\nhttps://github.com/petersirka/partial.js/blob/master/examples/routing/controllers/default.js\n. Yes because files are others than web pages. Files are optimized for the performance.\nSolution:\njs\nframework.route('/files/script/', file_script, ['partial1',......]);\n\nhtml\n<script type=\"text/javascript\" src=\"/files/script/\"></script>\n. You know but you must create a file route. This is not bad :-)\n. So, this is problem.\nAll partial contents are stored in:\nself.framework.routes.partial;\nself.framework.routes.partialGlobal;\nBut this feature I can add.\n. Yes.\n. I'm working on it but this is problem :8ball: ... partial content is executed in a controller context but by the files framework doesn't create a controller context. This is really problem.\n. I know but it's a bit complicated because I must create async class between file function and partials. I'm thinking about it.\n. Hi @thelinuxlich,\nI don't add this functionality. Really sorry. Solution for you:\n``` js\nfunction process_file(req, res, isValidation) {\n    var async = new utils.Async();\n    var partials = ['a', 'b', 'c']\n    var length = partials.length;\nfor (var i = 0; i < length; i++) {\n    var partialFn = self.framework.routes.partial[partials[i]];\n    if (partialFn)\n        async.await(partials[i], partialFn);\n}\n\nasync.run(function() {\n    // complete\n    res.responseFile(....);\n});\n\n}\n```\nThanks!\n. No because haven't any context. But this is solution ...\njs\nasync.await(partials[i], function(next) {\n    partialFn(next, req, res);\n});\n. Hi @zygis,\nit's easy:\ncontroller >\n``` js\nself.res.cookie('new-cookie-1', 'value-1', new Date().add('d', 1));\nself.res.cookie('new-cookie-2', 'value-2', new Date().add('d', 2));\nself.res.cookie('new-cookie-3', 'value-3', new Date().add('d', 3));\n// IMPORTANT:\nself.req.cookie('new-cookie-1') === ''; // (because cookie doesn't exist in current request)\n```\n---> new request to the controller\n``` js\nconsole.log(self.req.cookie('new-cookie-1'));\nconsole.log(self.req.cookie('new-cookie-2'));\nconsole.log(self.req.cookie('new-cookie-3'));\n// remove a cookie\nself.res.cookie('new-cookie-2', '', new Date().add('d', -1));\n```\n. Fuck ... I fixed it. Sorry - many thanks!!!\nPlease download a new version from GitHub:\nhttps://github.com/petersirka/partial.js/tree/master/minify/partial.js\n. Maybe today :+1: or tomorrow :-1:\nI'm working on it.\n. Hi @zygis,\nI published new version.\nThanks.\n. Add next environment is really big problem. I'm thinking about it. Now you can create test for a debug mode or for release mode.\nReally sorry. Maybe in the future, but I don't know now.\n. How will behave a test?\n- debug = disable cache, compiling every time\n- release = enable cache, compiling one time\n- test?\nI don't know now - how to add the test environment into the framework. It is problem.\n. I added framework.on('configure', ...\n. framework.injectConfig no - because is executed after is framework loaded. But:\n``` js\nframework.on('configure', function(config) {\n   console.log(config);\n});\nframework.run(....);\n```\n. Yes, this is good.\n. :+1: \n. I added: framework.configure('your-filename', [rewrite]);\nframework.configure(array, [rewrite]);\nframework.configure(filename, [rewrite]);\nThanks.\n``` js\nframework.once('configure', function(config) {\n   framework.configure('config-test', true);\n});\nframework.run(...);\n```\n. What do you mean?\nYou can define an IP in the config or in:\njs\nframework.run(http, port, '192.168.11.1');\n... or I don't understand you, please write me more.\nThanks :-)\n. I need whole example. Please send me an example to my e-mail: petersirka@gmail.com. I'll find the problem.\n. You have a problem in the file routing:\nSolution:\njs\nfunction send_nutm(req, res, isValidation) {\n    if (isValidation)\n         return req.url === '/nu.js';\n    var partials = ['validate_parameters','nu_to_nutm','cookie_sniffer','request_logger'];\n    run_partials(partials,req,res);    \n}\nExample: https://github.com/petersirka/partial.js/blob/master/examples/static-file-handling/controllers/default.js\nDocumentation write: http://docs.partialjs.com/Framework/#framework.file\n. Yes. You must write a validation for the request.\nFor validation you can use:\n``` js\nframework.file('*.txt', function(req, res) {\n   return req.url.indexOf('.txt') !== -1;\n}, ....);\n// or new implementation:\nframework.file('*.txt', function(req, res, isValidation) {\n   if (isValidation)\n       return req.url.indexOf('.txt') !== -1;\n// ....\n   // ....\n});\n```\n. Is there a bug... I fixed it. I made a lot of changes. File routing supports only GET params. I improved performance.\nPlease if you have more time download partial.js from GitHub and try to test it on your project.\nMany thanks!\n. Hi @thelinuxlich,\nyes:\nframework.responseFile(req, res, filename, [downloadName], [headers]);\nhttp://docs.partialjs.com/Framework/#framework.responseFile\nAnd in the new version of partial.js you can use:\njs\nframework.responseCustom(req, res);\nres.success = true;\nres.writeHead(200, { 'Content-Type': 'application/javascript' });\nres.write(n);\nres.end();\nresponse Custom clears temporary data. I hope that I understand :-)\n. Then use:\nhttp://docs.partialjs.com/Framework/#framework.responseContent\n. I had big changes from yesterday (without commit) so I canceled your pull request.\nI added symbol to regexp: https://github.com/petersirka/partial.js/blob/master/utils.js#L14\nThanks :+1: \n. Yes, it's possible. Framework supports subdomain (not domain) routing only, so - you must create conditions for each domain in each action.\nNginx configuration:\nserver {\n    listen      80;\n    server_name www.domain1.com;\n    server_name www.domain2.com;\n    server_name www.domain3.com;\n    charset     utf-8;\n    location / {\n        proxy_set_header   Host             $http_host;\n        proxy_set_header   X-Forwarded-For  $remote_addr;\n        proxy_set_header   X-NginX-Proxy    true;\n        proxy_pass         http://127.0.0.1:8000;\n        proxy_redirect     off;\n        break;\n    }\n}\nHow to get a domain name?\njs\nfunction view_homepage() {\n    var self = this;\n    self.plain('Current domain: ' + self.req.uri.hostname);\n}\n. No ... This is date/time of start application. \nHow to get uptime? http://nodejs.org/api/process.html#process_process_uptime\n. No, isn't.\nRead here:\nhttps://github.com/angular/angular.js/commit/3a75b1124d062f64093a90b26630938558909e8d\n. Try to use in partial.js:\nExample:\n``` js\nexports.install = function(framework) {\n    framework.route('/form/', json_form, ['json']);\n}\nfunction json_form() {\n    var self = this;\n    var model = self.post;\nconsole.log(model);\nself.empty();\n\n}\n```\n. Image manipulation use GraphicsMagick as default.\nYou must disable it or install GraphicsMagick.\nChange code like this:\n``` js\nfunction file_handler(req, res, isValidation) {\nif (isValidation)\n    return req.url.contains('/images/') && req.url.contains(['.jpg', '.gif', '.png']);\n\n// this === framework\nvar self = this;\n\n// Get file extension\nvar extension = req.url.substring(req.url.lastIndexOf('.'));\n\n// Get ID in FileCache\nvar id = req.url.replace('/images/', '').replace(extension, '');\n\n// Get module\n// All modules: https://github.com/petersirka/partial.js-modules\nvar filecache = self.module('filecache');\n\nfilecache.read(id, function(err, header, stream) {\n\n    if (err) {\n        self.response404(req, res);\n        return;\n    }\n\n    // Response image\n    self.responseImageWithoutCache(req, res, stream, function(image) {\n\n        image.resize('20%');\n        image.minify();\n\n        // Max 8 colors\n        if (extension !== '.jpg')\n            image.colors(8);\n        else\n            image.quality(90);\n\n        if (extension === '.gif')\n            image.flop().flip();\n\n        if (extension === '.jpg')\n            image.sepia();\n\n        // Convert image to image type\n        image.output(extension);\n\n    }, {}, true);\n\n});\n\n}\n```\nIMPORTANT: I don't know but in my computer I must start node.js application with ImageMagick as super user because SPAWN doesn't work - in GraphicsMagick all works fine.\n. No ... Download GraphicsMagick from www.graphicsmagick.org.\nhttp://en.wikipedia.org/wiki/GraphicsMagick\n. Yes, it is good.\n. This is an example and yes, you're right ...\nI'll update this example if I have more time :+1: \nThanks!\n. I looked on the example and contains pooling, see here:\nhttps://github.com/brianc/node-postgres#client-pooling\n. So, the example is OK :100: \n. Yes but pg module creates pool automatically.\nAuthor writes that this is a classic connection without pooling:\nhttps://github.com/brianc/node-postgres#simple\n. OK, please write me - what is the standard and I'll add :-)\n. Use:\nhttp://docs.partialjs.com/Framework/#framework.encrypt\nhttp://docs.partialjs.com/Framework/#framework.decrypt\n``` js\nvar hash = framework.encrypt('My name is Peter', 'MyKEEEEYY');\n// or\nvar hash = framework.encrypt({ name: 'Peter', id: 34 }, 'MyKEEEEYY');\n// ===============\n// For decrypting:\n// ===============\n// If you expect string:\nconsole.log(framework.decrypt(hash, 'MyKEEEEYY', false));\n// If you expect object:\nconsole.log(framework.decrypt(hash, 'MyKEEEEYY'));\n```\nCORS: http://en.wikipedia.org/wiki/Cross-origin_resource_sharing\nExample: https://github.com/petersirka/partial.js/blob/master/examples/cors/controllers/default.js\n. You can use:\nhttp://docs.partialjs.com/FrameworkController/#controller.stream\njs\ncontroller.stream('image/jpeg', queryStream);\n. No ... because websocket doesn't support sending stream. Websocket supports only text plain messaging. On the background is implemented \"binary\" protocol but yet doesn't work.\nPS: you must convert the stream to the string ...\n. Is the stream large?\nIf no, so then use:\n``` js\nvar output = '';\nstream.on('data', function(chunk) {\n    output += chunk.toString('utf8');\n});\nstream.on('end', function() {\n    self.send(output);\n});\n```\n. Ahhh yes, thanks - I updated comment.\n:100: \nI wish you a happy new year and best wishes for 2014 :-)\n. Hi @DevAlien,\nthank you for your feedback.\nWhy the folder templates and the folder contents are not inside the folder views?\nBecause files are more different. Templates and Views are compiled and Contents are rendered as raw. Templates and Views markup is different too.\nAccording the name of controller must the \"views\" directory contains directory with the controller name. (example: https://github.com/petersirka/partial.js/tree/master/examples/views).\nWhy is it so?\nif you will have larger project then structure of the project will be cleaner. Everything has its place. For example: if your project renders products from a database or static content (e.g. advert, banners, etc.) or views then you know where is the file stored. If your client says, please update my Google Identificator or change the visual of product in products list - you know quickly where to change it. And everything is designed for reusability in other projects (so you can easy copy the template between projects).\nYou don't have to use contents or templates. All directories/functionality are optional.\nAt the end:\nFramework supports:\n1. views (dynamic content rendering)\n2. templates (rendering items from a database, it's optimized for repeat rendering)\n3. contents (rendering static contents, it's fast)\nAnd all are optional. In express.js/koa is problem in the larger project, it will be a massacre (and koa is a low-level framework). Many thanks!\nIf you have some questions or you will need help, contact me.\n. You must add .geojson into the config. The framework doesn't accept all requests.\nconfig-debug:\nconfig-release:\nstatic-accepts-custom      : .geojson\n. I found a bug - sorry.\nYou URL address contains white characters (%20) ... I fixed this problem in development version. Good practice: don't use white characters in URL address and all URL address write with lower case.\n. Hi @goldalworming,\nI updated partial.js version. Please update your version and give a feedback.\nThanks!\n. F*ck ... Really sorry.\nI fixed this problem and now I published new version of partial.js.\nThanks! Please update your version from NPM or https://github.com/petersirka/partial.js/releases\nThis was the big bug.\n. I'm working with the websocket now and all it works.\nI must see example.\nThanks.\n. Hi @goldalworming,\nyou must use:\n``` js\nframework.database = function() {\n}\n```\nFramework doesn't contain framework.db() prototype.\n. Yes ... but theoretically - try:\n``` js\nframework.db = function() {\n    return 'OK';\n}\nframework.eval(function() {\n    Controller.prototype.db = function() {\n        return framework.db.apply(framework, arguments);\n    };\n});\n```\n. Hi @triplekdev,\ntoday I'll write a module with SWIF view engine.\nThanks.\n. Here you have:\nhttps://github.com/petersirka/partial.js-modules/tree/master/swig\nPlease try to test it.\n. I see ... GitHub has some problems ... Repository is exists and works, but now didn't work.\n. Download all modules from: http://www.858project.com/partial.js-modules.zip\n. Hi @goldalworming,\nwhich version of partial.js do you use?\nThanks.\n. Try to update partial.js from NPM and give me a feedback.\nCurrent version: 1.3.1-3\n. Super, thanks.\n. Hi @DevAlien,\npartial.js uses Douglas Crockford compiler/minifier (www.crockford.com). This big man worked in Yahoo. You must write 100% good JavaScript code or try to use https://github.com/petersirka/partial.js/tree/master/examples/external-compile-uglifyjs\nThanks!\nHi @goldalworming, thanks :+1: \n. JavaScript compiler/minifier replaces all white characters between code ... therefore you must add semicolons.\nThanks. \n. @DevAlien uglify compresses also inline code.\n. Hi @goldalworming,\nyou can use dynamic template/view:\n```\n@{template('{name}', [{ name: 'Peter' }, { name: 'Jano' }])}\n@{view('@{name}', { name: 'Peter' })}\n// or\ncontroller.template(...)\ncontroller.view(viewname/HTML, [model], [isPartial])\n```\n... or use:\nhttp://docs.partialjs.com/FrameworkFileSystem/\nThanks.\n. Hi @goldalworming,\nyes:\ncontroller.view('~/base/index');\nTry and give a feedback.\nThanks.\n. use:\nthis.view('...');\nor\nself.view('...');\nI don't know what you have defined....\nTry.\n. The name of controller do not affect templates. Only views. So:\n@{template('additional', model)}\nload -> /templates/additional.html\nThis must work (but model must contain some data (array)).\n. Please take me similar screenshot:\n\nThanks!\n. Can you send me your example on my e-mail - petersirka@gmail.com?\nI'll test it.\nThanks.\n. yes ... in config-debug / config-release you can change all directories:\nhttp://docs.partialjs.com/configuration/\n. You can create this functionality. Framework supports dynamic views and templates or you can create custom helpers for rendering data ... You have many options, all is on you.\nAnd maybe I don't understand :-)\n. Hi @zygis,\ntry to add 'xss' flag or set:\njs\nframework.onXSS = null;\nThanks.\n. Hi @thelinuxlich,\nI'm preparing new changes. Framework will renamed because I'm not owner domain of partialjs.com. Not all people are good and I made a mistake a long time ago. I cleaned my project because I want to start from begin with new name and with a stable version. I'll publish a new stable releases (today) and present new name + homepage.\nThanks :+1: \n. Hi @triplekdev,\nwau :-/ ... in OSX works:\n$\u00a0mkdir website\n$\u00a0cd website\n$ total.js -n\nI'll try to test it.\nThanks!\n. Hi @triplekdev,\nI updated executable file and I registered new name total. Please updated total.js version from NPM.\nC:\\> total --help\n. Yes :+1: \n. Hi @eMarek,\nyes. Newest versions will contain only hotfixes (or small improvements). And the future?\nhttps://github.com/petersirka/total.js/issues/milestones?with_issues=no\nThanks :-)\n. @xstable I don't have any access to partialjs.com domain. The domain was stolen and I can't do anything with it. So yes, Total.js framework is another project by the same author.\n. Yes, this man stole my domain. I have his contact, but he is very bad man. Again: I can't do anything with this domain. The worst thing in the world are people.\nPS: Thank you.\n. Hi @goldalworming,\nI must see the code. I suppose that you always add new event in loop into the event listener.\nThanks.\n. Here is problem:\njs\ncon.on('connect', function() {});\nYou must use:\njs\npool.getConnection(function(err, connection) { ...\n. This is mysql function.\nHow do you obtain con variable?\n. DB:\njs\nvar hs = require('node-handlersocket');\nframework.db = function(fn) {\n     var con = hs.connect(function() {\n          fn(con);\n     });\n};\nUsage:\n``` js\nframework.db(function(con) {\n    var recursive = function(index) {\n        if (index <= 0) {\n            con.close();\n            return;\n        }\n   // HERE YOUR CODE\n   index.insert(..., function(err, result) {\n        recursive(--index);\n   });\n});\n\n// RUN\nrecursive(40000);\n\n};\n```\n. Example:\njs\nframework.db(function(con) {\n    var recursive = function(index, num) {\n    ...\n    ...\n    recursive(--index, num);\n    // or\n    recursive(--index, 123456);\n    ...\n    ...\n    // RUN\n    recursive(40000, 12345);  // 12345 - custom number\n. You can use events but not in loop. Recursive solves problem with maxlistener and always waits to end. It's complicated to explain it. You must thinking async :100: \nEvents are good for most scenarios, but not for all.\n. You can use async or recursive :-) Both are good. For this problem is better to use a recursion. :+1: \n. Hi @zygis,\nyes, because URL address contains .extension (.tld). URL cannot contain file extension.\nSolution:\njs\n// /some/url/?value=email@domain.tld\nconsole.log(controller.get.value);\nThanks.\n. Hello @zygis,\ntheoretically it is possible:\njs\nprocess.removeAllListeners('SIGTERM');\nprocess.on('SIGTERM', function() {\n    // your code here\n});\nor ...\nrewrite framework.stop():\njs\nframework.stop = function() {\n    // your code here\n}\nThanks!\n. yes ... you must add into path ~\nconsole.log(utils.combine(\"~/../data/temporary\"));\nI must add this trick into the documentation :+1: \nTry it.\nThanks\n. :-D and what do you want?\nGive me an idea.\n. Mhh, I know what do you want.\nThis function is important for the framework.\nYou must write own function :1234: \n. @visionmedia, yes .... really sorry, express is faster than total.js (1/2 faster).\nI didn't know about production mode. 1000000x sorry.\nI updated a benefits.\nThanks.\n. Hi @KiPSOFT,\nI'll try it. Thanks.\n. Hmm this is problem... This file is a watcher for watching changes in files. I don't know what should I do. You can create a new file debug.js with:\njs\nvar framework = require('total.js');\nvar http = require('http');\nvar port = parseInt(process.argv[2]);\nframework.run(http, true, port);\nI don't know :1234: \n. Now I installed:\n\nIt is very interesting.\n. \nPS: I updated package via --force command ... Maybe, this is problem.\n. I updated to a new version v1.2.1 without changes ... please try to install.\nGive me a feedback.\n. Hi Fayez,\ncan you write a small example for me? I'll test it. I'm waiting.\nThanks.\n. Mhh, please try to change: flags: ['upload', 'xhr'] and give me a feedback.\n. OK, I'll test it.\n. It works:\n``` js\nexports.install = function(framework) {\n    framework.route('/', view_homepage);\n    // IMPORTANT: be careful to large files\n    // framework.route('/upload/', json_upload, ['upload']);\n    framework.route('/upload/', json_upload, { flags: ['upload'], length: 1024 * 1024 });\n};\nfunction view_homepage() {\n    var self = this;\n    self.view('homepage');\n}\nfunction json_upload() {\n    var self = this;\n    console.log(self.files);\n    self.json(self.files);\n}\n```\n``` html\nUpload\n\n\nfunction upload() {\n    var fd = new FormData();\n  // send to server as uploadFile field\n  fd.append('uploadFile', document.getElementById('file').files[0]);\n  // create xhr\n  var xhr = new XMLHttpRequest();\n  xhr.open(\"POST\", '/upload/');\n  xhr.send(fd);\n}\n\n```\n\n. Super :+1: \n. GitHub contains a new (BETA) version.\nHere is latest stable version: https://github.com/totaljs/framework/releases\nHere is an explanation (NPM version):\nhttps://groups.google.com/forum/#!topic/totaljs/TcynsmKHTz4\n. I published new version, currently is all OK.\n. It's not stupid question, I'll update documentation.\nempty-project or created project from command-line contains:\n/your-web-app/debug.js\n/your-web-app/release.js\n/your-web-app/test.js\nDebug mode:\nnode debug\nTest mode:\nnode test\nProduction:\nnode release\nYou can rename these files. Examples contain start script index, example\nnode index\nI recommend using a Sublime Text editor and download node.js build-system. If you'll have some questions, write me.\n. And ... sorry, port and IP setting:\nconfig-debug\ndefault-ip                      : 127.0.0.1\ndefault-port                    : 8000\nconfig-release\ndefault-ip                      : 127.0.0.1\ndefault-port                    : 8000\nAnd Heroku port/ip setting:\ndefault-ip                    : auto\ndefault-port                  : auto\n. Hi @Ronto,\nhere are all tags of view: http://docs.totaljs.com/FrameworkViews/\nInsert a partial view:\nhtml\n@{view('navigation')}\n<!-- with a model -->\n@{view('navigation', { model: 'value' })}\nTemplate must contain a model\n@{template('navigation', [{ url: '/1/' }, { url: '/2/' }, { url: '/3/' })}\n. Hi @LeventeNagy,\nplease write me all values from the request header (create a screenshot).\nThanks.\n. Yes .... Problem is in XHR flag ... your request doesn't contain:\nX-Requested-With: XMLHttpRequest\nSo, remove XHR flag and all will work.\nThanks :+1: \n. Can you send me some example? I'll test it.\n. Hi @goldalworming, try to use:\n```\nNGINX CONFIG\nworker_processes\u00a0 1;\n\u00a0\nevents {\n\u00a0\u00a0\u00a0\u00a0worker_connections\u00a0 1024;\n}\n\u00a0\nhttp {\n\u00a0\n\u00a0\u00a0\u00a0\u00a0include\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 mime.types;\n\u00a0\u00a0\u00a0\u00a0default_type\u00a0 application/octet-stream;\n\u00a0\u00a0\u00a0\u00a0sendfile\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 on;\n\u00a0\n\u00a0\u00a0\u00a0\u00a0keepalive_timeout\u00a0 65;\n\u00a0\n    server {\n        listen      80;\n        server_name www.mywebsite.com;\n        server_name subunit.mywebsite.com;\n        server_name subunit2.mywebsite.com;\n        server_name www.secondwebsite.com;\n        charset     utf-8;\n    location @proxy {\n        proxy_set_header   Host             $http_host;\n        proxy_set_header   X-Forwarded-For  $remote_addr;\n        proxy_set_header   X-NginX-Proxy    true;\n        proxy_pass         http://127.0.0.1:8000;\n        proxy_redirect     off;\n        break;\n    }\n\n    location / {\n        try_files $uri.html $uri $uri/ @proxy;\n    }\n\n    location ~ /. {\n        access_log    off;\n        log_not_found off;\n        deny all;\n    }\n}\n\nserver {\n    listen      80;\n    server_name app.mywebsite.com;\n    charset     utf-8;\n\n    location @proxy {\n        proxy_set_header   Host             $http_host;\n        proxy_set_header   X-Forwarded-For  $remote_addr;\n        proxy_set_header   X-NginX-Proxy    true;\n        proxy_pass         http://127.0.0.1:8001;\n        proxy_redirect     off;\n        break;\n    }\n\n    location / {\n        try_files $uri.html $uri $uri/ @proxy;\n    }\n\n    location ~ /. {\n        access_log    off;\n        log_not_found off;\n        deny all;\n    }\n}\n\n}\n```\n. Hi @goldalworming,\nYou must create a controller prototype for rds:\n``` js\nframework.rds = function() {\n    return rdsclient;\n};\nframework.eval(function() {\n    Controller.prototype.rds = framework.rds;\n});\n// OR\nself.framework.rds.hget()\n// or\nframework.rds.hget()\n// instead of\nself.rds.hget()\n```\nThanks.\n. Hi @goldalworming,\nthis is not possible :-) ... sorry.\n. Currently no, is not possible. Sorry\n. Do you want to create a SQL query? :-)\nDoes it work?\n:+1: \n. Hi @goldalworming,\nyou can set a domain name, example:\njs\nself.res.cookie('ngrok', 'value', new Date().add('day', 1), { domain: '.ngrok.com' });\nThanks.\n. You must update this module. I think that this module will not have any changes in the near future.\n. Hi @BreakThrough-Apps,\nthe problem is in URL address, URL address must start with /api/.\nOtherwise: can you send me your example?\nThanks :-)\n. Hi @flienteen,\nI fixed this problem, many thanks!\nNew version will be (maybe) this weekend. Please download total.js from GitHub, there is a good version.\n. Hi @LeventeNagy,\nI'll create some example in the near future.\nThanks.\n. Hi @mikeyoon,\nyes I'll add this mimetypes.\n\nI might be able to help out with some guidance.\nI'll be happy :-)\n. I added .stl and .mtl into the content-types. But you must manually allow this content-types for accepting. Example:\n\njs\nframework.accepts('.stl');\nframework.accepts('.mtl');\nor add to the config:\nstatic-accepts-custom             : .stl, .mtl\nThanks.\n. Hi @goldalworming,\nit's not possible because controller is not created. All public functions are STATIC FUNCTIONS.\nSorry :-)\n. Yes ... Default for partial views: controller.layout('')\nIn partial views framework skips the layout, but I'll fix it.\nThanks.\n. I fixed this problem (currently yet only on GitHub), please download version from GitHub :-)\n. Example:\n@{!model.html} === SHOW RAW DATA\n@{!repository.html} === SHOW RAW DATA\n@{model.html} === SHOW ENCODED DATA\n@{repository.html} === SHOW ENCODED DATA\n. In your case is model.created a string. (Try console.log(typeof(model.created))). So you must create a Date object ...\njs\nnew Date(Date.parse('2014-03-21T02:05:59+07:00')).format('dd-mm-yyyy');\n. Only option is create an own helper :-)\n. Hi @Ronto,\n``` js\nfunction create() {\n    var self = this;\n// POSTED DATA\nconsole.log(self.post);\n// ...\n// ...\n// ...\n\n}\n```\n. It is OK .. If you'll need help, contact me.\n. Hi @goldalworming,\ntry to add into your config:\ndefault-ip                     : auto\nIf you have set an IP in index.js - remove it.\n. Disable error logging:\njs\nframework.onError = utils.noop;\nDisable start informations:\njs\n// put before framework.run()\nframework.console = utils.noop;\nHeroku uses forever. I don't use any similar tools, look into my uptime (minutes): http://www.totaljs.com/usage\n. Here is example: https://github.com/totaljs/examples/tree/master/heroku\n. Hi,\n1. if I run node index ...\n   ... theoretically - OS closes all user applications. Do you have own VPS?\n\n\nif I user forever it return 404: Not Found ...\n   404 is from total.js? Do you use a proxy server?\n\nThanks\n. Open web developer console in browser and look into the response headers (X-Powered-By:total.js v1.3.1) ... send me screenshot .\n. I must see nginx settings for this site.\nContact me on my e-mail: petersirka(at)gmail(dot)com.\n. Hi @goldalworming,\nremove XHR flag. Your request doesn't contain XmlHttpRequest header.\n. Can you send me simple example?\nI'll test it.\n. Hi @nuky89,\nimportant:\ncontext (object context) is not Controller context in all exports functions, example:\nIn controller:\njs\nexports.scan = function() {\n    var self = this;\n    // !!! self IS NOT CONTROLLER !!!\n   // you must use: framework.model() ... not self.model()\n};\nWhat's wrong in my method?\nI don't know ... I must test it.\nWhere I should put my part of code that doesn't depend by web server but have to access at data (using controllers of course)?\nCreate your own module.\nThanks.\n. Framework is global variable and you can get all features everywhere (it's not bad). Object of controller is created after the URL route is valid ... but initialized is after the start.\nFramework loads the parts sequentially:\n- controllers\n- modules\n- components\n- definitions (in this file you can set all modules or components or controllers)\nI recommend:\n- write business logic into the modules\n- controller must process only requests\nSo your problem:\n- create a module game as directory with team.js and mach.js scripts and index.js (this is initial script) ... like this https://github.com/totaljs/examples/tree/master/framework-modules/modules\n- framework is a global variable so you can use it everywhere\n- use definitions only for settings (DB, game module, etc.)\n- modul will execute every day all as you need (e.g. different intervals)\nI designed total.js as modular framework. I'll add new features tomorrow (very interesting) for the business logic. Sorry for my anwsers ... today I haven't any free time.\nIf you need some answer for your questions, please create an simple example (with problematic code) and I'll add some comments and code for understanding. Sorry for my bullshit :100: \n. Hi @goldalworming,\nis there problem in HTTP headers... I think that NGROK doesn't copy all headers ... total.js adds X-Proxy header and this will be a problem. MAYBE :-)\n. Hi @itugay,\nthanks for tip. I know brackets and I'll look into the documetation.\nThanks.\n. Hi @goldalworming,\ncan you create a small example?\nThanks.\n. Your model is array ... You must validate only one object from the array.\nDo you understand?\n. I must test it.\nPlease write me small example in total.js (small) - I'll test it.\n. Hi @jamc,\nI fixed this bug yesterday. I'll publish HOTFIX tomorrow.\nPlease download new version (1.3.1) from GitHub.\nThanks.\n. PS: for render scripts use:\n@{place('scripts')}\nExample: https://github.com/totaljs/examples/tree/master/views-place\n. Hi @gnetsys,\nI must see the error. All works.\n\nThanks.\n. Yes, because repository.title is undefined. You must declare this property. Repository does not same as model.\n... be defined once as a globally?\njs\nframework.on('controller', function(controller, name) {\n    controller.repository.title = 'Administrator';\n});\n. It's too complicated. Think simply :-)\n. Hi @itugay,\nwhat's the problem? :-)\nThis feature is in framework core and improvements speed, reduces memory, etc..\nThanks.\n. All text in <pre> or <code> tag is not compressed :-D .... I can create exception but I must have a reason.\nThanks :-)\n. @itugay how do you imagine it?\n. Hi @itugay,\nlast thing, please describe me: Why you need this?\nThanks.\n. I added a new option into the config:\nallow-compress-html             : true (default) OR false\n. Hi @toshipon,\nmany thanks for some changes ... I reviewed your code and I found some anomalies:\n- you rewrite parameter \"name\" to \"url\", OK but name is not meant as url, because name is name of script, style, etc.. URL is as additional option\n- you removed \"/\" in creating of url ... this is very bad, because \"/\" is meant - load script from the website root. If you want to get some address e.g. /categories/shoes/ ... then your e.g. common directory will be loaded from /categories/shoes/common/ ... and not from /common/ and this is a problem.\nSo I can't merge your code into the total.js code.\nI hope that you understand.\nThanks :+1: \n. Hi @goldalworming,\ntimeout is created when the \"action\" in \"controller\" that doesn't return a response.\nSo I must see your code in this action. Please send me it via email.\n. Hi @nuky89,\ncurrently it's not possible. I'll try to add this feature in next version (this weekend).\nThanks.\n. Hi @nuky89,\nI looked on this feature and to extend this function is a problem. I'm downloading some content as a stream and this stream is piped into the response. So to manipulate with it is a big problem (... and the next problem: response is automatically gzipped).\nSolution for you:\n``` js\nutils.download('http://www.google.com', function(err, response) {\nvar data = '';\n\nresponse.on('data', function(buffer) {\n    data += buffer.toString('utf8');\n});\n\nresponse.on('end', function() {\n    // data = data.replace('</head>, 'HEADER</head>');\n    console.log(data);\n});\n\n});\n```\nSorry :-(\n. Hi @goldalworming,\nI created new example: https://github.com/totaljs/examples/tree/master/xml-sitemap\nThanks.\n. I created simple example:\nhttps://github.com/totaljs/examples/tree/master/xml-sitemap-workers\n. Hi @btray77,\nthanks! I'll fix it today ...\nPS: you can create a pull request: https://github.com/totaljs/documentation\nThanks :+1: \n. I fixed it.\nThanks.\nPS: I must create a new tutorial :100: \n. Hi @lstep,\nWhich page do you mean?\nI updated: readme.md and homepage of documentation.\nThanks.\n. I updated command.\nThanks.\n. Hi @lstep,\nI'm thinking ... I'll give you a feedback.\n. Hi @lstep,\nI've been thinking about it. HTTPS can't add to debug.js because HTTPS needs custom settings (certificates) and this is problem. debug.js is a bit other file than others.\nMy question:\nWhy do you not want to use a NGINX as PROXY? Develop in HTTP mode and in a production use HTTPS through NGINX. NGINX supports SPDY too and in NGINX you can create a balancer easily. \n@rdewolff I added a new feature - a global config for both modes (debug/release).\n. OK, I understand ... I'll create a place in debug.js for setting HTTP/HTTPS. OK?\n. Download it, rename it to debug.js and try it:\nhttps://github.com/totaljs/framework/blob/master/empty-project/debug.min.js\nThanks.\n. Hi @mateuszgachowski,\nLESS in total.js supports only constants and functions (I updated documentation). It is a simple helper :1234: \nI'm so sorry, but I haven't plan to extend it :-1: \n. I think that advanced LESS and SASS is unnecessary. Why? Total.js LESS supports constants and functions and supports auto-vendor-prefixes. So you can create a rich and fast applications.\nThis is my opinion.\nPS: yes, original LESS is possible to add like SASS.\n. Hi @goldalworming,\nhere: http://docs.totaljs.com/FrameworkUtils/#utils.ls\nExample:\njs\nutils.ls(framework.path.templates(), function(files, directories) {\n   // CALLBACK\n});\n. Hi @goldalworming,\nyou have to find some FTP module for node.js ... Total.js doesn't support FTP.\nOther is possible.\nThanks :-)\n. Here is some one:\nhttps://github.com/mscdex/node-ftp\n. Hi @sonnyCZE,\nit's there a performance problem (historically) .. I fixed this problem on GitHub version.\nChangelog:\nhttps://github.com/totaljs/framework/blob/master/changes.txt\nThanks!\nPS: \u010eakujem\n. Thanks! :100: \n. Hi @goldalworming,\nplease download total.js from GitHub and give me a feedback.\nThanks.\n. I committed new changes before 2 hours.\nDownload again.\n. It works:\n\n. This doesn't work:\nhttp://home.ekuitas.com/test/\n. And I must see flags of route, please create a screenshot.\n. I know, but domain refers to other domain.\nI'll send you example.\n. I know where is the problem .... You must add a JSON flag.\n. Hi @goldalworming,\nYou must add \"next()\", try it:\njs\n// if (err){throw err; rc.quit();return;}\nif (err){throw err; rc.quit(); next(); return;}\nThanks.\n. It's weird code :1234:\n. What is rc?\n. Maybe like this:\n``` js\nfunction some_action() {\nvar self = this;\nvar result = [];\n\nrc.zrange(['cust', '0', '-1'], function(err, data) {\n\n    if (err) {\n        rc.quit();\n        self.throw500(err);\n        return;\n    }\n\n    var length = data.length;\n\n    if (data.length === 0) {\n        self.json(result);\n        return;\n    }\n\n    // Create array\n    var arr = [];\n\n    for (var i = 0; i < length; i++)\n        arr.push('cust:' + data[i]);\n\n    var fn_async = function(item, next) {        \n        rc.hgetall(item, function(err, datacust) {\n\n            if (err) {\n                rc.quit();\n                self.throw500(err);\n                return;\n            }\n\n            if (datacust)\n                datacust.id = data[framework.global.rows.length];\n\n            result.push(datacust);\n        });\n    };\n\n    var fn_complete = function() {\n        rc.quit();\n        self.json(result);\n    };\n\n    // Walk through the array (async)\n    arr.wait(fn_async, fn_complete);\n\n});\n\n}\n```\n. Sorry:\njs\ndatacust.id = data[result.length];\n. FUCK, sorry:\n``` js\nfunction some_action() {\nvar self = this;\nvar result = [];\n\nrc.zrange(['cust', '0', '-1'], function(err, data) {\n\n    if (err) {\n        rc.quit();\n        self.throw500(err);\n        return;\n    }\n\n    var length = data.length;\n\n    if (data.length === 0) {\n        self.json(result);\n        return;\n    }\n\n    // Create array\n    var arr = [];\n\n    for (var i = 0; i < length; i++)\n        arr.push('cust:' + data[i]);\n\n    var fn_async = function(item, next) {        \n        rc.hgetall(item, function(err, datacust) {\n\n            if (err) {\n                rc.quit();\n                self.throw500(err);\n                return;\n            }\n\n            if (datacust)\n                datacust.id = data[result.length];\n\n            result.push(datacust);\n            next();\n        });\n    };\n\n    var fn_complete = function() {\n        rc.quit();\n        self.json(result);\n    };\n\n    // Walk through the array (async)\n    arr.wait(fn_async, fn_complete);\n\n});\n\n}\n```\n. Hi @flyzb618,\nI'll see on it.\n. I looked on it but I don't know. Sorry.\nDefinitions\nAll definitions are loaded once (maybe this is the problem) after the framework is ready.\nSource\nAll source scripts are loaded once when they are needed.\n. @asessa 1000000000000x thanks.\nI really appreciate it.\n. Please add into the code your name.\nThanks.\n. Hi @acardinale,\nframework alway returns relative path with a trailing slash.\nSolution:\njs\nconsole.log('/' + controller.req.path.join('/'));\n// returns: /mypath/example\n// or\nconsole.log(controller.req.uri.pathname);\nThanks.\n. Many thanks!\n. Hi @goldalworming,\nyou can attach an event:\njs\nframework.on('request-end', function(req, res) {\n    // do something\n});\nThanks\n. Hi @tohachan,\nmany thanks. Is there a bug. I must create a rollback but I'll fix it.\n. Peace, nothing happened.\n. Hi @traskat,\nplease what version of total.js do you use? Can you send me your example on my e-mail?\nThanks :-)\n. Hi @joshuataylor,\nhave you installed total.js? Try to download an empty-project from https://github.com/totaljs/framework/releases and give me a feedback.\n. Hi @kevinriver,\nI updated info a few days ago in Total.js documentation:\nPeter Sirka's configuration:\n```html\n/my-app-folder/\n/my-app-folder/node_modules/  create it manually and this directory will contain all Node.js modules \n/my-app-folder/apps/  directory will contain your Total.js apps, e.g: \n/my-app-folder/apps/totaljs_com-www/\n/my-app-folder/apps/componentator_com-www/\n/my-app-folder/apps/...\n```\nHow can I install Total.js?\nbash\ncd /my-app-folder/\nnpm install total.js\nSafe configuration:\n```html\n/apps/  directory will contain your Total.js apps, e.g: \n/apps/totaljs_com-www/\n/apps/totaljs_com-www/node_modules  create it manually and this directory will contain all Node.js modules for this app \n/apps/componentator_com-www/\n/apps/componentator_com-www/node_modules  create it manually and this directory will contain all Node.js modules for this app \n/apps/...\n```\nHow can I install Total.js?\nbash\ncd /apps/totaljs_com-www/\nnpm install total.js\n\nhttps://youtu.be/mE9cavUIMQY?t=20s\nThank you!. I have updated documentation about it:\nhttps://docs.totaljs.com/latest/en.html#pages~Getting%20started~(recommendation-for-directory-structure)\nThank you.. Hi @KiPSOFT,\nwhich version of total.js do you use? Do you have latest version from GitHub?\nThanks.\n. I found a problem:\njs\n// YOU HAVEN'T DEFINED AN ACTION\nframework.route('/loginKontrol', ['xhr', 'post']);\n// FIX:\nframework.route('/loginKontrol', ['xhr', 'post'], view_loginkontrol);\nGive me a feedback.\n. It's ok, thanks!\n. Hi @goldalworming,\nand where is the problem? Each request allocates more memory and node.js clean it. I must see your index  /homepage code. Look here: http://www.totaljs.com/usage ... 43.72 MB total allocated and current: 14.21 MB in 5300 requests. It's not bad.\n. Your code is not clean and you are using dot template engine. So maybe problem is here.\nTry to measure clean code, example:\njs\nfunction execute(param){\n    var self = this;\n    self.json({ success: false, rows: null, err: 'notfound' });\n}\nAnd give me a feedback.\n. So, you must create a next step. Gradually add more function, give me a feedback.\n. Hi @goldalworming,\nyes because you must define a upload flag into the route.\njs\nframework.route('/upload', test4, ['upload']);\n. form.maxFieldsSize = 200 is same as:\nframework.route('/upload/', upload, { flags: ['upload'], length: 200 })\nnode-formidable will not work in total.js.\n. Hmmm, here is a problem. I'm watching on it.\nI must add:\n1. limit for uploaded file\n2. limit for data field\nCurrently framework validates whole length of request data without fields data.\n. Hi @redwoz,\ncan you send me a whole example on my e-mail? petersirkaATgmailDOTcom\nThanks.\n. Problem resolved. The problem was in older version of total.js.\n. Hi @asessa,\nthanks, I fixed it  :dancers: \nI added you into contributors.\nThanks.\n. Hi @bilikaz, many thanks for contributing.\nI hesitate for this functionality because developer can check easily that value is null or undefined.\n``` js\n// 1.\nif (object === null or object === undefined) {}\n// 2.\nif (!object) {}\n```\nI think that is unnecessary.\nMany thanks!\n. Hi @goldalworming,\ncan you send me minified javascript? I'll look into it.\nThanks.\n. Great!\nI can update minificator, this is very good idea for prevent many problems.\nThanks.\n. Hi @goldalworming,\nyou have problem here:\ndefault ---> ReferenceError: fs is not defined ([object Object]) ReferenceError: fs is not defined\nat Object.execute (/home/lmvm/web/proxyblog/controllers/default.js:57:19)\nSolution: ~/controllers/Default.js\n``` js\nvar fs = require('fs');\n// .....\n// .....\n// .....\n```\nGive me a feedback.\n. Definition supports \"require\". Send me example for the check.\nThanks.\n2014-08-27 9:15 GMT+02:00 arief nur andono notifications@github.com:\n\n@petersirka https://github.com/petersirka does total.js 1.6.1 not\nsupported require in definitions anymore?\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/totaljs/framework/issues/190#issuecomment-53534483.\n\n\nS pozdravom\nPeter \u0160irka\nBrutal Web Developer\nTelef\u00f3n: +421903163302\nE-mail: petersirka@gmail.com\n. Hi @goldalworming,\nI know, this is big problem also for me too.\nI'll look into it.\n. Hi @goldalworming, sorry I forgot on you.\njs\nvar pages = self.view(tplfile, result, true);\nif (pages === null) {\n    self.content('Contact Administrator. something wrong with the template.', 'text/html');\n    return;\n}\nSorry and thanks\n. This is problem. I don't know that is good idea, but I can return a string or error (not null) from the function. I must think about it, but this is a way too.\n. Hi @mateuszgachowski,\nI agree. Today I'll update a reading of views.\nThanks.\n. It's implemented in new version.\nThanks.\n. Hmm, this is not good way. Tell me more about your project. I'll try to find a good solution for your needs.\nThanks.\n. Hi @goldalworming,\nyes, I'll update it in new version. Thanks.\n. Hi @goldalworming,\nI added:\njs\nconsole.log(pagination.isFirst);\nconsole.log(pagination.isLast);\nconsole.log(pagination.first());\nconsole.log(pagination.last());\nI updated a returned object:\njs\nvar page = pagination.first();\nconsole.log(page.url);\nconsole.log(page.page);\nconsole.log(page.selected);\nconsole.log(page.enabled); // NEW\nI added transformations:\n``` js\nPagination.addTransform('custom', function(optionalArgument1, optionalArgumentN) {\n   // return a custom object \n   var self = this;\n   return self.render();\n});\nconsole.log(pagination.transform('custom', 5));\n// GLOBAL transformation\nPagination.setDefaultTransform('custom');\n// usage:\nconsole.log(pagination.render());\n```\nThanks!\n. Hi @traskat,\nyes I renamed \"repository\" to \"items\" and I forgot to update a documentation.\nSorry: cache.items (stable)\nThanks!\n. Hi @traskat,\nframework supports:\nget,options,post,delete,put,upload,head,trace,patch,propfin\nThanks.\n. Yes,\nframework.route('/some-url/post/', some_action, ['post']);\nframework.route('/some-url/put/', some_action, ['put']);\nframework.route('/some-url/', some_action, ['get', 'delete']);\n. Hi @g13013,\nthis works correctly:\n``` javascript\nrequire('total.js');\nF.route('/', function() {\n    var self = this;\n    // the framework doesn't send the content if the request method will be HEAD\n    self.plain('TEST');\n}, ['get', 'head']);\nF.http('debug');\n```\nThanks.\nPS: works only with v1.7.3 (currently: BETA version)\n. No problem. I fixed the head method in the new version. There was a bug.\nThanks.\n. Do you mean for the version v1.7.2?\n. @g13013 I want to publish it in the coming days :+1: \nI'm testing it in many projects.\nThanks!\n. Hi @asessa,\nmhhh I understand. I'll think about it how to fix it.\nI'll give a feedback.\n. Super! Many thanks.\n2014-09-16 15:56 GMT+02:00 Andrea Sessa notifications@github.com:\n\n@petersirka https://github.com/petersirka true, I've updated it with\nallow-custom-titles\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/totaljs/framework/pull/198#issuecomment-55745873.\n\n\nS pozdravom\nPeter \u0160irka\nBrutal Web Developer\nTelef\u00f3n: +421903163302\nE-mail: petersirka@gmail.com\n. Hi @wahono77,\nI think that yes because you need to communicate only between client and server. You have to communicate through the standard methods GET/POST/PUT/DELETE or WebSocket or classic Socket. Total.js supports everything what you need.\nThanks.\n. Here are all examples (+90):\nhttps://github.com/totaljs/examples\nRouting example:\nhttps://github.com/totaljs/examples/tree/master/routing-flags\nAngular.js + Angular.js Resources:\nhttps://github.com/totaljs/examples/tree/master/angularjs-mongodb-rest-resources\nIf you will have some questions, write me.\nThanks.\n. Hi @traskat,\ncan you send me some a small example? I'll fix it.\nMany thanks!\n. I see a problem:\nframework.route('/api-1/', api()); - WRONG\nframework.route('/api-1/', api); - GOOD\nGive me a feedback.\n. It's ok :-)\nThanks.\n. Hi @KiPSOFT,\nI removed this property, because I added a middleware (same is in express.js). So I had to add a more functionality like express.js. This was a big change and sorry for backward compatibility.\nThanks.\n. But remained:\n```\nPOST/PUT:\ncontroller.post --> controller.req.body\ncontroller.body --> controller.req.body\ncontroller.req.body\nGET/DELETE:\ncontroller.get --> controller.req.query\ncontroller.query --> controller.req.query\ncontroller.req.query\n``\n. Yes, I normalized names because older version framework has many unnecessary links. Socontroller.frameworkwas removed becauseframeworkis a global variable.controller.configis a property that reads a value fromframework.config`.\nI don't know about the problem of websocket authorization. Can you describe it?\nThanks.\n. Problem is in auth module. Can you send me this module? I'll fix it (or download new total.js and authorization module).\nThanks.\n. And what version of total.js do you use?\nI tried to test an example in auth module and it works without any problem.\n. Hmmm on v1.6.1 it works.\nBTW: I mean this example: https://github.com/totaljs/modules/tree/master/auth/example\n. Aha ... Do you have some example? I'll fix it. Thanks\n. OK I understand. Tomorrow I'll create an own example and I'll test it.\nThanks and I'll give a feedback.\n. Hi\u00a0@KiPSOFT,\nI found a problem in WebSocket routing. I'm surprised.\nPlease download latest version from GitHub and try to test it. The problem was not in auth module.\nThanks.\n. Thanks, I found a problem in the framework :-1:. I fixed it on GitHub, please download the latest version. Else ... You forgot to add a MODULE('auth').onAuthorization delegate for user authorization.\nGive me a feedback.\n. Sorry for bugs :100: \nThanks!\n. Hi @dpoellath,\nauth in websocket is same as in classic requests. You can use e.g. cookies (but important: it works reading cookies only, not writing --> instead of res argument in F.onAuthorize is socket instance) and authorize flag.\nIf you will have a problem, contact me. I'll write you a simple example.\nThank you!. Please try to read this blog (try to understand without auth.js module):\nhttps://blog.totaljs.com/blogs/tutorials/20161114-how-to-create-custom-authorization-mechanism/\nAgain: If you will have a problem, contact me. I'll write you a simple example.. Hi @BlaShadow,\nonly option is middleware. Middleware is executed before a controller and after a controller is executed framework.on('request-end', ...). I need more informations :)\nThanks.\n. Yes.\nframework.route('/', view_homepage, ['#middleware']) or\nframework.route('/', view_homepage, { middleware: 'middleware' }, flags: [...]).\n. I forgot, you can use some middleware for all request:\nframework.use('middleware');\nThanks.\n. Hi @mateuszgachowski,\nyes and I fixed it. I moved request.xhr (obtaining) above a middleware.\nPlease download total.js from GitHub.\nThanks.\n. I published v1.6.2.\nThanks. \n. Hi @darrudi. Yes, but framework supports file route. Currently I'm flying to Dublin, but at the evening I'll write you example. Thanks.\n. Hi, I'm here.\nOK I'll think about it (I have some idea for this case).\nI'll give a feedback.\n. So I worked on it and I found several problems:\n1. performance\n2. complexity\n3. existing functionality\nSo currently I don't see a way how to solve this case. Framework supports file routes and you can define own file handler for handling static files (it's not simple, but powerful).\nMaybe help you, example:\nhttps://github.com/totaljs/examples/blob/master/static-file-handling/controllers/default.js\nAnd for getting file names use:\njs\nconsole.log(req.path); // String Array -> Splitted url\nThanks.\n. Yes, the problem:\n``` js\nfunction reRoute(req, res, isValid) {\n    var regex = /\\/(attachment|thumb|icon|avatar)\\/(.*)/;\n    var matches = regex.exec(req.uri.pathname);\n    // missing a request validation\n    if (isValid)\n        return matches; // this is very important\n    getThumbnail(req, res, matches[2]);\n}\nfunction getThumbnail(req, res, filename) {\n    var path = makeAbsolutePathFromUuid(filename);\n    var stream = fs.createReadStream(path);\n    self.framework.responseStream(req, res, 'application/octet-stream', stream);\n}\n```\n. You're welcome.\nAnd for getting a content-type use:\nhttp://docs.totaljs.com/FrameworkUtils/#utils.getContentType\nThanks!\n. Hi @goldalworming,\n``` js\nvar headers = {};\nheaders['User-Agent'] = 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:28.0) Gecko/20100101 Firefox/28.0';\nheaders['Accept'] = 'text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8';\nheaders['Accept-Language'] = 'en-US,en;q=0.5';\nheaders['Accept-Encoding'] = 'gzip, deflate';\nheaders['Referer'] = 'https://ibank.klikbca.com/';\nheaders['Cookie'] = 'ARPT=R3534516605; JSESSIONID=1707JnNBdT0J392cQPyG7026hn0Pn7Lnw7pgQcKMQtnTNPC5S3zZ!-1681179253; d26954=%7B%22v4a%22%3A%7B%22r%22%3A%220%22%7D%2C%22v4b%22%3A%7B%22f%22%3A%220%22%7D%2C%22v7%22%3A%7B%22s%22%3A%22%22%7D%2C%22v4%22%3A%7B%22j%22%3A%22%22%7D%2C%22timestamp%22%3A%222014-10-03%2007%3A13%3A30%22%2C%22ki%22%3A%221%22%2C%22v6%22%3A%7B%22u%22%3A%22%22%2C%22k%22%3A%22bca.1.20130617-1%22%7D%7D%7C%7C9268a03668844c9c4b2e4e327c3d440d8031d72ab395b5540decf6a40bd0752f; u26954=NmIwMTNkYTRmODhkYTkxMDk0MTQ4MWViZDRmMzYzZjUwMGY1MmMwODYxMjY3ZTcyNmU5ODVmNzI4MWNlNjkyOTQxMTc5YjNiNTBkNWVmMzk1NjhlZjgyNDIwMmVjNDkzZTA4NGVhZmY5YWVlYmIwODg5Y2NmNzI2MTRjYTliZTc1ZjkyMGM4ZTdkMDA0MjAzNGI5NmUzOTQ3NDgwMWFmMjQ1YzgxZDQ1ZTdkODZjMWRlMTc3ZWU4ZTQ4MGNiYzdhNWQxNGJlMjRhODE5YzljNzMxNjcwNTYwZDM5NWQyZjY0ZjUxYzUwOTBhNTFlNWNkYWUwODkzOGNkYzc4NzljZTY3MzJlYzk4NDMyMTRkMTM3ZmEzMTg5OGVlYjYzMmU1M2YyNjc1NzliMmZkYzdhY2QwNzA2ZjUzNjBiM2NmYzYxZDc5ZDg2NTEwNTY0NjQyZDI4NjE0N2NlYWJhZDJmODIwZTViN2FmMjZmOTgzNTJjM2M3YTFhNzk3MjFiNTVlMWU5NDAzNjg1Yzc5N2Y2OWYyYzU0MWNmOTcyYWFhNTA3NzY3OTliZjcyNGU5OTY4ZTFmNWRjMGQxMDFlODg0Yzg4OGNjOTEwNTg0M2FmMDJmY2FhZjc4NzlhZDcwM2M5ZTQ5NjBhODg4ZTgyMGNkNzYyMDY5YjQzNzBjODdhMjJ8MXxpQmFua0Zvcm0%3D';\nheaders['Content-Type'] = 'application/x-www-form-urlencoded';\nUtils.request('URL', ['post'], 'POSTDATA=value%28actions%29=login&value%28user_id%29=ariefnurxxxx&value%28user_ip%29=223.255.230.55&value%28pswd%29=xxxxxx&value%28Submit%29=LOGIN', function(err, data, status) {\n    console.log(err, data, status);\n}, null, headers);\n```\nthanks.\n. Hi @pssupport,\n- do you use some modules (internal, external)?\n- What version of total.js do you use? Can you download the latest version from GitHub?\nPS: I tested it and everything works.\nThanks.\n. I fixed it on NPM.\nThanks.\n. Hi @yanickrochon,\ngood tip for auth module. The controller event is not bad idea, but I have a fear because it is a new code to execute (but it's possible). Give me a feedback :-)\n. @yanickrochon, I don't have any idea to create the name of the event, so please help :+1:\n``` js\nmodule.exports.install = function(framework, options) {\nSUGAR = (framework.config.name + framework.config.version + SUGAR).replace(/\\s/g, '');\n\nframework.onAuthorization = authorization;\nframework.on('service', service);\n\nif (options)\n    users.options = Utils.copy(options);\n\n// HERE HERE HERE HERE HERE\n// \"auth\"?, \"authorization\"?, or?  \nframework.emit('WHAT-NAME?', users);\n\n};\n```\nThanks all.\n. :) @yanickrochon I understand. You asked me for better event management and you mentioned auth module. I copied a chunk of code from the module for your needs (if are). I wanted help you.\nSo here is the full code of auth for update. So if you have some idea to new features, please update it:\nhttps://github.com/totaljs/modules/blob/master/auth/v1.00/auth.js#L280\nFor * EDIT *: yes, you're right :+1: \n. Hi @pssupport, many thanks for reporting. Can you test a version on GitHub? I tested it and everything works. Thanks.\n. @pssupport GitHub version is the version in progress. So NPM version is more stable but currently it isn't :100: I tune new version. I'll try to fix the problem in older version. Thanks.\n. I published a new version.\nClosed.\n. Hi @pssupport, this is a problem. But I'll update debug.js and I'll add a new event e.g. restart. OK?\n. I understand a part. I can add events debug-start (onetime), debug-stop (always) and debug-restart (always, skip first run). If debug.js finds changed files then stops the framework and executes again.\nIs it sufficient for you? Thanks :-)\n. @pssupport OK I'll add it. My english is bad too, native language is Slovak (similar as Russian). So we understand together :+1: ... I'll give you a feedback.\n. @pssupport download this file https://github.com/totaljs/framework/blob/master/empty-project/debug.js ... This file emits debug-start and debug-restart events. For debug-stop use exit event. Give me a feedback.\n. Mhhh I fixed it. The event: framework.on('exit') must work but I see small problem. Try to add console.log() into the event. Please test these new changes.\n. You're welcome :-) ... How to get config? This is a problem, you should send it through worker.send(framework.config) or you can get these data directly from the file like this:\nNot tested:\njs\nvar utils = require('total.js/utils');\nvar config = fs.readyFileSync('../config-debug').toString('utf8').parseConfig();\n. Hi @pssupport,\ndownload debug.js from https://github.com/totaljs/framework/tree/master/helpers. You are using older version, surely :-)\nThanks and give me a feedback.\n. Hi @darrudi,\nI understand. You must replace the executable file of total.js. I found this file here:\n/usr/local/lib/node_modules/total.js/bin/total and replace with (https://github.com/totaljs/framework/tree/master/bin). Thanks.\n. Hi @joerg-krause,\nyes (I know about it) ... Static file doesn't allow to receive any data (it is for a performance). You must create a classic route without any extension. Or try to use:\n``` js\nfunction static(req, res, isValidation) {\nif (isValidation)\n    return true;\n\nvar data = '';\n\nreq.on('data', function(chunk) {\n    data += chunk.toString('utf8');\n});\n\nreq.on('end', function() {\n   console.log(data);\n   res.send(data);\n});\n\n}\n```\nThanks.\n. Hi @joerg-krause,\nclassic route can't contain extension because this is the only way how framework knows whether it's static file or a classic route. This is only one restriction. So try to create route without extension:\njs\nframework.route('/static/', function() {\n    console.log(this.body);\n    this.plain();\n}, ['post']);\n. Solution:\n``` js\nframework.on('request', function(req) {\nif (req.url !== '/api/static.txt')\n    return;\n\nreq.on('data', function(chunk) {\n    req.buffer = chunk.toString('utf8');\n});\n\n});\nframework.file('my custom file handler', function(req, res, isValidation) {\n    if (isValidation)\n        return req.url.startsWith('/api/static.txt');\nconsole.log(req.buffer);\nres.send(req.buffer);\n\n});\n```\nThanks. PS: tested v1.7.0\n. Hi @wgallios, why you closed this request?\n. Hi @fym201,\ncan you send me d:\\node-app\\bigtree_total\\controllers\\api\\user.js:12:14 a whole code?\nThanks.\n. Hmmm, can you send me a small example on my e-mail? I'll test it.\nThanks.\n. I didn't receive any e-mail. Thanks.\n. Hi @tkang007,\nI fixed it, but you must wait for a new version :-(\nI'm working on it 24 hours per day :-)\nI just start to learn total.js for finding sql gateway possibility for analytic reporting solution.\nSounds good.\nWelcome any similar examples recommending.\nPlease describe me more about your ideas.\nThanks!\n. Hi @darrudi,\nwhat version of total.js do you use? I fixed some problem in mails several days ago.\nThanks.\n. Hi @darrudi,\nI know where is the problem. I fixed it now. Please download and re-test. Thanks!\n. @darrudi please download mail.js again and I'll wait for your new issues :+1: \nThanks.\n. Can you create a pull request? Looks good.\n. I'm going to update it.\n. Fixed. Thanks!\n. @darrudi please what is your full name? I'll add you to contributors. Thanks.\n. I added you, so welcome :-)\nThanks!\n. Hi @darrudi,\nI suppose that developer does not publish every day new version. Config file affects all etags. Get last modified date is an expensive operation (IO). For that I recommend using versions (https://github.com/totaljs/examples/tree/master/static-version).\nThanks.\n. Hi @Antoine-Pous,\nthe value attribute is not supported because @{text} is bound with the model. So try to use:\njs\nfunction some_action() {\n    this.view('your-view', { colorpicker: '#0074cd' });\n}\nBut I think that it's not bad idea, I'll try to update this functionality.\nThanks!\n. Hi @darrudi, hmmm thanks for explanation. So I'm waiting on the change (if you fixed it).\n. Hi @stact,\nserver.js:\njavascript\nvar options = { port: process.env.PORT, ip: process.env.IP };\nrequire('total.js').http('debug', options);\nThanks and merry christmas!\n. \n. Hi @satrong,\nI fixed it. I did not expect it :100: ... so I removed auto adding script tag.\nThanks. Please download latest version from GitHub.\n. Please try your change on the below example:\nhttps://www.dropbox.com/s/g7dbgklh4znbpgz/authorization-www-basic.zip\nAnd give me a feedback.\nThanks!\n. Hmm, you have older version (maybe). Here is the latest:\nhttps://github.com/totaljs/framework/blob/master/index.js#L12133\nreq.authorization() --- returns still not null object. Can you re-test with the new version?\n. And @asessa thank you for your time and work!\n. OK .... but the problem: we can't read the credentials because if auth is not empty the method sends a response automatically. And what happens if the credentials are not correct - we must send a response with login form again. My code solve this problem. Example:\n``` javascript\nfunction my_solution_action() {\nvar auth = self.baa();\nif (auth.empty) {\n    self.baa('Your credentials:');\n    return;\n}\n\n// MongoDB\nDATABASE('users').findOne({ login: auth.user, password: auth.password }, function(err, doc) {\n\n    if (doc === null) {\n        // IMPORTANT:\n        self.baa('Your credentials again:');\n        return;\n    }\n\n    self.plain('YOU ARE LOGGED');\n});\n\n}\n```\n``` javascript\nfunction your_solution_action() {\nvar auth = self.baa('Your credentials:');\nif (auth.empty)\n    return;\n\n// MongoDB\nDATABASE('users').findOne({ login: auth.user, password: auth.password }, function(err, doc) {\n\n    if (doc === null) {\n        // IMPORTANT:\n        auth = self.baa('Your credentials again:');\n\n        // THE PROBLEM BECAUSE AUTH IS NOT EMPTY\n        // HOW TO SEND BACK \"LOGIN FORM\"?\n        if (auth.empty)\n            return;\n       return;\n    }\n\n    self.plain('YOU ARE LOGGED');\n});\n\n}\n```\nWhat do you think about it? Thanks\n. Hi @satrong,\nyes and sorry for it. One company contacted me and they wanted: they have many models which is need to set (they don't use Mongoose). So I had to change loading the framework dependencies.\nInitialization: Modules --> Packages --> Models --> Definitions --> Controllers\nHow to solve this problem?\n1. add require to mongoose in each model\n2. wrap the model with framework.on('load', function() {})\nThanks and sorry for this complication.\n. Super! I published a new version now (with new homepage and new documentation).\nDownload it.\n. Hi @LeventeNagy,\nwe had to change the order loading dependencies, so it is currently:\nInitialization: Modules --> Packages --> Models --> Definitions --> Controllers\nSolution:\n1. create your own modul e.g. bookshelf with your definition.\n2. or wrap the content of the model into the framework.on('load', function() {});\nSorry for this change :-( but it was very important.\nThanks!\n. Thanks! And Happy New Year too :-))))\n. Hi @LeventeNagy,\nwhat version of total.js do you use?\nI looked into it. The problem:\n1. the framework executes 408 (request-timeout) because passport does not respond\n2. set timeout to route to 0 or false, or add self.custom():\n``` js\nfunction auth() {\n    var self = this;\n    self.custom(); //\n    passport.authenticate('local')(self.req, self.res, function(err) {\n        if (err)\n            return console.log(err);\n    // important change in this case:\n    self.res.json({ object: self.user });\n});\n\n}\n```\nThe session module is missing (use: https://github.com/totaljs/examples/blob/master/passport.js/definitions/modules.js)\nI looked into passport.js examples and they work correctly.\nThanks.\nPS: I found a small bug in new total.js version (1.7.0), if middleware does not exist the framework throws exception of exception). I fixed it (https://github.com/totaljs/framework/tree/v1.7.1). Thanks.\n. I'll look on it today evening. I'll give you a feedback.\nThanks.\n. Hi @LeventeNagy,\nplease download v1.7.1 again. It's better optimized for passport.js.\nAnd full example:\n``` javascript\nrequire('total.js');\nvar passport = require('passport');\nvar LocalStrategy = require('passport-local').Strategy;\npassport.use(new LocalStrategy(function(username, password, done) {\n    var user = { alias: '123456' };\n    if (username === '123456' && password === '123456')\n        return done(null, user);\n    return done(null, false, { message: 'Incorrect credentials.' });\n}));\nF.route('/login/', function() {\n    var self = this;\n    self.body.username = self.query.username;\n    self.body.password = self.query.password;\n// this is better way: failureRedirect: '/failure/'\npassport.authenticate('local', { session: false })(self.req, self.res, function(err) {\n    if (err)\n        return self.throw500(err);\n    self.json(self.user);\n});\n\n}, ['#passport']);\nF.middleware('passport', passport.initialize());\nF.http('debug');\n```\nAnd open ...\nplain\nhttp://127.0.0.1:8000/login/?username=123456&password=123456\nPS: If you want to use session (install module) you must create these delegates serializeUser and deserializeUser.\nThanks!\n. You don't have the latest version from GitHub (I see it in the exception).\nhttps://www.totaljs.com/share/example-passport.zip and install passport and passport-local and give me a feedback.\n. No, I thank! I found a small bug with your help, thanks.\n. Hi @harry-stot, many thanks for your change. Please add this function into the documentation into String prototypes https://github.com/totaljs/documentation/blob/master/public/v1.7.0/en.json and into the  https://github.com/totaljs/framework/blob/v1.7.1/changes.txt ... Thanks :-)\n. Please add it into the documentation. Thanks\n. Hi @darrudi,\nI fixed it https://github.com/totaljs/framework/tree/v1.7.1, thanks!\n. @darrudi I renamed _layout.html in v1.7.0, but I added it into the new documentation (currently on GitHub).\n. Sorry for this change.\nAnd I thanks.\n. Hi @satrong, your english is good -> I understand.\nCan you send me all headers from the request? It will be better.\nThanks.\n. ... and @satrong which IP is correct in headers for you?\nThanks.\n. You can get real IP, right? So your code is correct:\njs\nvar ip = self.req.headers[\"x-real-forwarded-for\"] || self.req.ip\nWhere is the problem? Those headers are generated through CDN?\n. Ahaa, I understand. I suggest:\nCreate some definitions:\njavascript\nframework.on('controller', function(controller) {\n    controller.realip = self.req.headers[\"x-real-forwarded-for\"] || self.req.ip;\n});\nUsage in controller:\n``` javascript\nexports.install = function() {\n   framework.route('/', plain_homepage);\n};\nfunction plain_homepage() {\n    var self = this;\n    self.plain('My IP:' + self.realip);\n}\n``\n. Hi @mateuszgachowski,\nthe framework knows 4x types of configuration file:\n1.config- global for all modes\n2.config-debug- for development\n3.config-release- for production\n4.config-text` - for testing\nBut I can add this option into the new version. But we must more specify behaviours.\n. Yes.\nI'll add framework.useConfig() today or do you want to add?\nYour idea is good:\njs\nframework.useConfig('filename in the application root'); // OK?\n// or\n// what do you think about framework.configure(filename)?\nBut this method must be executed before the framework initialization F.http() or F.https().\nWhat do you think about it?\nThanks.\n. Yes that's good idea. OK I'll add it today. I'll give you a feedback.\nSo I'll create: framework.useConfig() or framework.configure()? What do you think?\n. OK I added it:\nhttps://github.com/totaljs/framework/tree/v1.7.1 try it :-)\nThanks.\n. Hi @Antoine-Pous,\nthis is not possibble, because:\nClients are not supposed to send URI-fragments to servers when they retrieve a document.\nSource: http://en.wikipedia.org/wiki/Fragment_identifier\nThanks.\n. Can we pass values to the controller from the view?\nWhy do you need this?\nI can get the fragment with a bit of client-side JavaScript.\nClient-side:\njavascript\nfunction locationHashChanged() {\n    var hash = location.hash;\n    // jQuery request\n    $.get('/api/' + hash + '/', function(d) {\n        $('#some-container').html(d);\n    });\n}\nwindow.onhashchange = locationHashChanged;\nServer-side (controller):\n``` javascript\nexports.install = function() {\n    framework.route('/api/{hash}/', view_hash);\n};\nfunction view_hash(hash) {\n    var self = this;\n    // disable layout\n    self.layout('');\n    // respond: view according to the hash\n    self.view(hash);\n}\n```\nDo you understand? Thanks.\n. Hi @GeoCloud,\nhttps://github.com/totaljs/framework/blob/v1.7.1/changes.txt\nThanks.\n. Hi @stact,\nholy shit, you're right. I'll publish a new version today. I'll give you feedback.\nThanks.\n. Hi @stact I published it now.\nThanks.\n. :-) Hi @LeventeNagy super :-) thanks.\n. Many thanks!\n. Hi @dacrhu,\nAdd it into the config\nplain\ndefault-image-converter       : im\nCode:\njs\nvar image = Image.load('filename');\nThanks.\n. Yes! :+1: \n. Thanks, I fixed it.\n. Hi @ludydoo,\njavascript\nfunction some_action() {\n    var date = new Date(self.body.date);\n    console.log(date);\n    self.plain(date.format('yyyy-MM-dd HH:mm'));\n}\nThanks!\n. For this case I created a SchemaBuilder:\nFull example, save as app.js and run node app.js (you must have a latest version of total.js):\n``` javascript\nrequire('total.js');\nvar T = SCHEMA('T');\nvar Director = T.create('Director');\nDirector.define('name', 'string(100)'); // the max length of string for this field (because of DB) :-)\nDirector.define('born', Date);\nDirector.define('died', Date);\nDirector.define('films', '[Film]');\nDirector.setSave(function(error, model, options, callback) {\n    console.log('SAVE:', model.$clean());\n    callback(SUCCESS(true));\n});\nvar Film = T.create('Film');\nFilm.define('name', String);\nFilm.define('date', Date);\nF.route('/', function() {\n    this.content('var data = \\'{\"name\":\"John Wick\", \"born\":\"1987-10-10T04:00:00.000Z\", \"died\":\"2015-01-01T04:00:00.000Z\", \"films\":[{\"name\":\"Film 1\",\"date\":\"2011-01-01T04:00:00.000Z\"},{\"name\":\"Film 2\",\"date\":\"2012-01-01T04:00:00.000Z\"},{\"name\":\"Film 3\",\"date\":\"2014-01-01T04:00:00.000Z\"}]}\\';$.ajax(\"/\", { type: \"POST\", data: data, success: function(r) { console.log(r); }, contentType: \"application/json\" });', 'text/html');\n});\nF.route('/', function() {\n    this.body.$save(this.callback());\n}, ['json', 'post', '*T/Director']);\nF.http('debug');\n```\nI know, you'll have many questions.\n. 1. https://github.com/totaljs/examples/tree/master/framework-schema-and-validation\n2. http://docs.totaljs.com/v1.7.x/en.html#api~Builders.SchemaBuilder\n3. or contact me :+1: \nI have a plan to create more examples with SchemaBuilder.\n. You can write me on my e-mail: petersirka(AT)gmail(DOT)com.\nComposer:\nImagine you that you have one document with multiple dependencies. And composer is for it, so you can compose the model by yourself. Nothing more, nothing less :)\n. Hi @dacrhu,\ngood idea, but should the method add a date stamp before the filename?\nThanks\n. Sorry, I mean whether is the date important for filename. My idea is filename without date because each line in log file will have date/time stamp. What do you think about it?\n. Sorry I don't understand completely. But logs will same as today in near future. I added:\njavascript\nF.logger('access', true, false, 'OK'); \ncontroller.logger('access', true, false, 'OK');\nLOGGER('access', true, false, 'OK');\n. No no, I understand you. Try it, but I removed a date from a filename because you can specify the filename. It's a development version, so please test it. Thanks!\nSource code: https://github.com/totaljs/framework/tree/v1.7.3\nThe change: https://github.com/totaljs/framework/commit/ce72a3517ebe56047ed1e34f213737b398edb611\n. Yes, so can be this solution in new version?\nThanks.\n. Hi @dacrhu,\nI fixed it and it's better/faster about about 30%. Please download latest version from GitHub (branch: 1.7.3)\nhttps://github.com/totaljs/framework/commit/576efeea16a07d4d10013ae746d52fb36802790b\nThanks.\n. Hi @tegeek,\nthanks for feedback.\nThe packages are similar as your idea (but they will need to be packed):\nhttp://docs.totaljs.com/v1.7.x/en.html#pages~Packages\nCan you create a small example (.zip) with your idea of directory structure? The example should not work. Thanks!\n. You don't need to change the source-code. I want to see some \"example application\" with good directory structure. I want to understand it.\nUnit tests in total.js are not a magic. The framework starts the server and perform requests or methods to tests. Controllers are tested via internal requests into controller actions or the framework tests the methods. So you can inject some depedency during the test.\nThis example describes the functionality of unit-tests in total.js:\nhttps://github.com/totaljs/examples/tree/master/assertion-testing\nThanks\n. I'm here. It's not bad idea but it's too different than total.js. The directory structure is the base of the framework. I thought about it and currently I don't see a way for implementation it in near future. But I'll think about it. I want to improve the current state of the framework, so maybe for large application (for some peoples) is need to update the core of the framework. The change is not code only, there is a more things (documentation, examples, etc.). Thanks for your idea, I'll think about it and maybe I'll implement a part of them.\n:100: \n. I have closed this issue.\n. Hi @goandylok,\nI don't see the light at the end of the tunnel :1234:  ... The problem: you want to edit views with some designer app. The problem is in routing of static files because the designer app doesn't know where are static files (because they are in public directory).\nSo only way is change the configuration of designer app and set the directory for static files.\nPS: many thanks for your compliments, I appreciate it.\n. I have closed this issue.\n. Hi @admorphit,\nI assumed that you'll have own layout in views directory because I want to inject a package view to your layout. Try to create layout.html file into /app/views/ directory.\nThanks.\nGive me a feedback.\nPS: I'll update documentation about this information.\n. Thanks :-)\n. Hi @fatihky,\nyou must turn on default-websocket-encodedecode. Here is a screenshot from an example: https://github.com/totaljs/examples/tree/master/websocket.\n\nThanks.\n. Great! Thanks!\n. Hi @neonnds,\nI understand. Currently I don't think about splitting the view engine and the validation into the single files (I don't see any benefits now). The modular design is not bad, but it's not the win (everything has pros and cons). As an idea into the near future: OK. I want a total solution with several options for different developers.\nI added option to rewrite the view engine and other functionality. The validation can be overwritten too Utils.validation().\nThanks for the feedback!\n. Hi @darrudi,\nthis is very interesting.\nDo you use some middleware?\nDo you work with a raw response object?\nCan you send me on my e-mail (some) login name and password for testing? I'm worried about response headers, why is there 302 .... Don't worry, we'll solve it.\nThanks!\n. The language it's ok, design is intuitive.\nI don't see any problem in my Chrome and Firefox (under OSX) everything works correctly. As I say: 302 code in the response is very interesting. I think that I must see a code.\nAre you sure that you do not use res.redirect in websocket?\nThanks.\n. @darrudi thanks! Please give me a feedback, I'd like to help you.\n. Hi @darrudi any news?\nThanks.\n. Hi @darrudi,\nthanks for feedback.\n. Hi @evmek,\nolder versions of total.js support coffee script, but I had to remove it because I had a lot of work with it. Also v1.7.x doesn't support coffee scripts. Sorry :-1: \nThanks!\n. Hi @sarankup,\nthe framework supports multiple layouts. The layout is a plain html (view) file with one tag @{body} in addition.\nviews/layout1.html\nhtml\n...\n<h1>Layout 1</h1>\n@{body}\n...\nviews/layout2.html\nhtml\n...\n<h1>Layout 2</h1>\n@{body}\n...\nviews/index.html\nhtml\n@{layout('layout2')}\nMy content.\nviews/contact.html\nhtml\n@{layout('layout1')}\nMy content.\nviews/nolayout.html\nhtml\n@{layout('')}\nWithout layout.\nIn views: http://docs.totaljs.com/v1.7.x/en.html#api~FrameworkViews~%40%7Blayout\nIn controllers: http://docs.totaljs.com/v1.7.x/en.html#api~FrameworkController~controller.layout\nIn config: http://docs.totaljs.com/v1.7.x/en.html#api~FrameworkConfiguration~default-layout\nThanks!\n. I close this issue.\n. Hi @neonnds,\nI created a module with handlerbars:\nhttps://github.com/totaljs/modules/blob/master/View%20Engines/handlebars/v1.00/handlebars.js\nHOT NEWS: I added today:\nhttps://bufferwall.com/blogs/2015-03-26-beta-version-total-js-supports-multiple-view-engines-together/\nThanks.\n. Hi @sarankup,\nshow me the server-side route implementation. I think that the problem is in XSS (because CKEditor sends HTML content), try to add xss to route flags and give me a feedback.\nThanks\n. Try to change it:\njavascript\nframework.route('/postsubmit', postsubmit, ['post', 'xss']);\nAnd give me a feedback. The framework has built-in security mechanism for Cross-site scripting (XSS).\nThanks.\n. Great! Thanks.\n. Hi @hepr,\ndo you have the latest beta version?\n$ npm install total.js@beta\nGive me a feedback.\nThanks.\n. OK super. I'll publish a new version in few days.\nThanks!\n. HI @sarankup,\nI have tested favicon('logo.png') and it works correctly. Try to add .png to @{favicon()} and check it via HTML source-code.\n\n\nAre there any advantage one method over the other, interms of performance, speed...\nYou can add a multiple values into the @{js()}. Good point, I must write recommendation into the documentation.\nGive me a feedback.\n. Super :+1: \n. Hi @sarankup,\nyou can use:\nhtml\nGET/DELETE: @{query.m}\nPOST/PUT: @{body.m}\nMODEL: @{model.m}\n``` javascript\n// model will be contain a GET/DELETE params\nself.view('/passport', self.query);\n// or\n// model will be contain a POST/PUT params\nself.view('/passport', self.body);\n``\n. Hi @manglade,jsonflag is not possible to use withgetmethod, becausejsonflag checks if the request content-type isapplication/json-> and it will never be. If you removejson` flag -> everything will be work correctly.\nThanks\n. @manglade, sorry ... :-D :-D I read very quickly and I have skipped the important.\nI'll look into it today and I'll give you a feedback.\nThanks.\n. I have fixed it, please try it:\nnpm install total.js@beta\nThanks :+1: \n. I have tested it now and everything works.\nhttps://www.dropbox.com/s/r7rnswfehdbhi5p/test.js\n1. GET with application/json header: executes json_test\n2. GET without application/json header: executes 404\n3. POST with application/json header: executes json_test_b\n4. POST without application/json header: connection destroyed\n5. POST with application/json and bad data: executes 400 - bad request\nIt works.\n. I think that you have a bad version of total.js. Check the version like this:\n\n. Hi @manglade,\nNPM contains -52 build, try to install it.\n. Hi @maxxam11,\nyou do not to run debug.js with forever because debug.js watchs the application. Debug.js runs the application in other thread and if the application has a critical bug then the debug.js waits for a change in some application script (and then re-runs it again). Debug.js is only for development.\nForever use for release.js.\n. Hi @LeventeNagy,\njavascript\nF.onAuthorization = function(req, res, flags, next) {\n    next(req.isAuthenticated());\n};\nYou must not redirect in onAuthorization because the route mechanism waits for the result and then evaluates other routes.\nThanks :-)\n. No problem, it's ok.\n. I understand, but all directories (with expect public) are in plural (so you can create configs directory) and implementation for config directory is really hard for current state (we must think on existing documetation, examples and projects). I don't see any benefits, what are benefits?\nThanks.\n. I understand, but I must keep backward compatibility. We can create only configs directory, but what will it do? (behavior)\nThanks.\n. I'm thinking about it, give me a time. I'm considering...\nThanks.\n. Sorry for delay. Done, this behaviour has been added.\nnpm install total.js@beta\nThanks.\n. Behaviour:\nhtml\n/configs/my-custom-config         - this config file is loaded for all modes (debug, release, test)\n/configs/my-custom-config-debug   - this config file is loaded only for debug mode\n/configs/my-custom-config-release - this config file is loaded only for release mode\n/configs/my-custom-config-test    - this config file is loaded only for test mode\n. Hi @LeventeNagy,\nI need an example with the problem, can you send me it on my e-mail?\nWhy?\n- you create authcheck middleware and I don't see its using.\n- I don't see implementation of `passport.js'\nThere will be a small bug because I haven't peformed any big changes in middlewares.\nThanks! \n. Hmm, it's weird. I have problem with v1.7.2 and v1.8.0. Why do you use passport.js? I have checked examples with passport.js (passport.js and passport.js-bearer-local) and they work correctly.\nThanks.\n. OK and why do you use passport.js? You can use simple auth.js module or custom solution. It's not hard to write it.\n. Great! Thanks.\n. @LeventeNagy if you want to implement OAUTH2 (Google, Facebook, etc.) use https://github.com/totaljs/modules/tree/master/Security/oauth2, it's very easy.\n. :-) thanks! I'm looking forward to you.\n. I appreciate your work.\nI have my own guidelines for development, and I have no intention of changing that.\nI won't merge your pulled request.\nSorry and thanks again.\n. Hi @darrudi,\nI don't have any e-mail from you. Can you send me e-mail again with the problem?\nI'm waiting.\nThanks.\n. Hi @darrudi,\nthe problem is in cassandra driver. I think that the module doesn't close opened pool. Notice that: you create 4 requests and new requests will hang because I think that cassandra driver has 4 opened pools and any pool is not released.\nTry, here is the answer:\n``` javascript\nfunction test() {\n    var self = this;\nconsole.log('-> Before executing the query');\nself.plain('Got it!');\n\ndriver.execute('SELECT * FROM domain', [], function(err, result) {\n\n    console.log('-> After executing the query');\n    throw new Error('Raising an exception here <--');\n});\n\n}\n```\nThanks.\n. Hi @meongx,\nmultiple no, but you can use (one) virtual directory:\nhttp://docs.totaljs.com/v1.8.x/en.html#api~FrameworkConfiguration~directory-public-virtual\nor you can map specific files like this:\njavacript\nF.map('/layout.html', F.path.views('layout.html'));\nand you can map a whole directory in the beta version  npm install total.js@beta:\n``` javacript\nF.map('/views/', F.path.views());\n// or with filter\nF.map('/views/', F.path.views(), ['.html']);\n```\nWhy total.js doesn't support multiple public directories?\nThe performance is a reason..\nThanks.\n. Hi, don't worry - no performance issue.. Hi @satrong,\nthanks. I'll test it today + I'll give you a feedback.\n. Hi @satrong,\nI have tested it and I don't see any problem. Everything works. Which version of total.js do you have?\nCan you create an example on my e-mail? It will be best.\nThanks.\n. The problem is in Uglify, because it doesn't know that @{} is server side tag. Try to comment your definition with onCompileScript and everything will be ok or better solution:\n``` html\n\n{\"a\":1,\"b\":2,\"c\":@{place(\"initData\")}}\n\n\nvar data = JSON.parse(document.getElementById('data').innerHTML);\nconsole.log(data);\n\n```\nI have disabled allow-compile-js and then allow-compile-html --> result: a behaviour of the framework works correctly.\nThanks.\n. Hi @martinambrus,\nI have updated total.js@beta on NPM npm install total.js@beta. I have fixed the HTML compressor, but it's not easy. I must test it on my projects.\nPlease install the beta version and try it.\nThanks.\n. You can download it from GitHub and copy all files (index, mail, builders, internal, nosql, utils and image) to /node_modules/total.js/. Thanks!\n. Hi @capslow,\nyes and you have two ways:\n1. disable the timeout F.route('/url/', action, [0, flags]) (\n2. increase the timeout F.route('/url/', action, [10000, flags]) (10 seconds)\nor other way to change the timeout:\nF.route('/url/', action, { timeout: false })\nThanks and give me the feedback.\n. @jhonny111s 3 seconds https://docs.totaljs.com/latest/en.html#api~FrameworkConfiguration~default-request-timeout. Hi @neonnds,\nthe framework contains streaming functions, it works automatically if the request contains Range header https://github.com/totaljs/framework/blob/v1.8.1/index.js#L3728 :)\nSo you can use: controller.file() or F.responseFile().\n. Example: https://github.com/totaljs/examples/tree/master/video-streaming\n. http://en.wikipedia.org/wiki/Favicon but right, I can remove one from it.\nhtml\n<link rel=\"shortcut icon\" href=\"/favicon.ico\" type=\"image/x-icon\" />\n<link rel=\"icon\" href=\"/favicon.ico\" type=\"image/x-icon\" />\nThanks.\n. I have removed rel=\"icon\".\nThanks!\nnpm install total.js@beta\n. @gnetsys can you show me the error?\n. Hi @gnetsys,\nI have fixed it. Thanks for the report.\nnpm install total.js@beta\n. Hi @LeventeNagy,\nit's not stupid question.\nIs uploads directory out of public directory?\n. So the problem is here.\nYou must create a file handler or move upload directory to public directory or change http://docs.totaljs.com/v1.8.x/en.html#api~FrameworkConfiguration~directory-public-virtual to upload directory :+1:\n. Thanks!\n. Hi @sarankup,\ncan you show me some code from definitions/mongodb.js and controllers/monogodefault.js? Just send me e-mail.\nThanks!\n. Please send me the code in controllers/mongodefault.js between 140-160 lines.\nThanks.\n. OK, I don't see any problem. Only way how to prevent this problem is add a sleep time into debug.js.\nUpdate debug.js / release.js:\n``` javascript\n// ===================================================\n// IMPORTANT: only for development\n// total.js - web application framework for node.js\n// http://www.totaljs.com\n// ===================================================\nvar fs = require('fs');\nvar options = {};\n// options.ip = '127.0.0.1';\n// options.port = parseInt(process.argv[2]);\n// options.config = { name: 'total.js' };\n// options.https = { key: fs.readFileSync('keys/agent2-key.pem'), cert: fs.readFileSync('keys/agent2-cert.pem')};\n// HERE:\noptions.sleep = 3000;\n...\n```\nPlease give me a feedback. I have a similar problem on my server (sometimes).\n. Here is another way:\n``` javascript\nvar isOnline = false;\nMC.connect('mongodb://localhost:27017/mydatabase',function(err,db) {\n    if(err) throw err;\n    DB=db;\n    isOnline = true;\n});\nF.middleware('online', function(req, res, next) {\n    if (isOnline)\n        return next();\n    res.send('OFFLINE');\n    next = null;\n});\nF.use('online');\n```\n. @max258 can you create some example for understanding?\nhtml\n@{meta} renders current meta tags\n@{meta('title', 'description (optional)', 'keywords (optional)')} sets all meta tags\n@{title('title')} sets the current title into the @{meta} and @{title}\n@{description('description')} sets the current description into the @{meta} and @{description}\n@{keywords('keywords')} sets the current keywords into the @{meta} and @{keywords}\nDisable adding of config.name into the title in all subpages.\nhttp://docs.totaljs.com/v1.8.x/en.html#api~FrameworkConfiguration~allow-custom-titles\n\n@LeventeNagy thanks for the prompt reply.\n. @max258 I understand. I have one solution for you, you can rewrite http://docs.totaljs.com/v1.8.x/en.html#api~Framework~framework.onMeta like this:\njavascript\nF.onMeta = function(title, description, keywords, image) {\n    var builder = '';\n    if (title)\n        builder += '<title>' + U.encode(title) + '</title>';\n    if (description)\n        builder += '<meta name=\"description\" content=\"' + U.encode(description) + '\" />';\n    if (keywords)\n        builder += '<meta name=\"keywords\" content=\"' + U.encode(keywords) + '\" />';\n    return builder;\n};\nThanks :+1: \n. You have to use controller.place or controller.section (missing in docs, I'll add it):\nLayout:\nhtml\n<html>\n<head>\n    @{section('meta')}\n</head>\nAdd meta tags from a controller:\njavascript\nfunction some_action() {\n    this.section('meta', '<meta name=\"twitter:title\" content=\"BLA BLA\" />');\n    this.view('someview');\n}\nAdd meta tags from a view:\nhtml\n@{section meta}\n<meta name=\"twitter:title\" content=\"BLA BLA\" />\n@{end}. Hi @sarankup,\njohn.js\njavascript\nexports.getName = function() {\n    return 'John';\n};\npeter.js\njavascript\nfunction some_action() {\n    this.plain(F.controller('john').getName());\n}\n. Hi @max258,\n1.) yes, two routes can be merged like this:\n``` javascript\nF.route('/register/', view_register);\nF.route('/register/', view_register, ['post']);\nF.route('/register/', view_register, ['put']);\n// or you can use multiple flags\nF.route('/register/', view_register, ['post', 'put', 'get']);\n```\nI don't understand F.route('/register', view_register, ['view page','post']), what does it mean view page in the flags?\n2.) self.body (self.post is the alias) is always plain empty project {}.\njavascript\nfunction view_register() {\n    var self = this;\n    switch (self.req.method) {\n        case 'post':\n            self.view('index', self.body);\n            break;\n        case 'get':\n            self.view('index');\n            break;\n    }\n}\nHere is a very good solution for submitting of forms:\nhttps://github.com/totaljs/examples/tree/master/contact-form\n. Hi @dbelca,\nmany thanks for your compliment. I have found a problem in the documentation, here is a solution:\njavascript\nF.assert(name, url, flags, callback, [data], [cookies], [headers]);\nI'll update documentation. \nMany thanks.\nPS: give me a feedback.\n. Try this:\njavascript\nexports.run = function() {\n    F.assert('Test auth', '/', ['get'], function(err, data, code) {\n        console.log(data);\n    }, null, null, { 'authorization': 'Basic ' + new Buffer('petersirka:123456').toString('base64') });\n};\nBut important in http auth:\njavascript\nresult.empty = result.user.length === 0 || result.password.length === 0;\nMy advice: add key as username and password. The password can't be empty.\nThanks.\n. Hi @capslow,\nyes ... I added controller.jsonp() to new total.js version, try it: npm install total.js@beta.\nUsage:\njavascript\nfunction some_action() {\n    var self = this;\n    var callback = self.query.callback || 'myCallback';\n    self.jsonp(callback, { name: 'total.js' });\n}\nPlease give me a feedback.\nThanks.\n. Hi @evmek,\nwhich browser do you use? thanks.\n. Great. But, important:\nChrome creates multiple requests when the server doesn't respond in short time. So be careful.\n. Hi @maxxam11,\nI have fixed it. Please download the latest beta version npm install total.js@beta.\nThanks\n. Hi,\nyes, because you must run node.js with:\nbash\n$ node --harmony debug.js\nThanks.\n. Which version of node.js do you have?\n. Only: node.js +v0.11.x and io.js +v1.0.\n. @goldalworming Connection.prototype.$$query is example how to create sync method, try this:\n``` javascript\nvar Connection = require('mysql/lib/Connection');\nConnection.prototype.$$query = function(query, parameters) {\n    // this === connection\n    var self = this;\n    return function(callback) {\n        // callback must be the last argument\n        self.query(query, parameters, callback);\n    };\n};\n```\n... or use https://github.com/petersirka/node-sqlagent#generators-in-totaljs\nThanks.\n. Yes, because you must run node.js with --harmony argument:\nbash\nnode --harmony debug.js\n. Yes:\nhttps://github.com/petersirka/node-sqlagent#generators-in-totaljs\nNo problem.\n. javascript\nself.db(function(err, connection){\n  async(function *() {\n    obj.post = yield sync(connection.$$query(\"select * from post where ?\", {id:'1'}))();\n    obj.tes = yield sync(connection.$$query(\"select * from post where ?\", {id:'1'}))();\n    connection.release();\n    self.json({rows: obj});\n  })(self);    \n});\nor\njavascript\nself.db(function(err, connection) {\n    async(function*() {\n        obj.post = yield sync(connection.$$query(\"select * from post where ?\", { id: '1' }))();\n        obj.tes = yield sync(connection.$$query(\"select * from post where ?\", { id: '1' }))();\n        self.json({ rows: obj });\n    })(self, function() {\n        connection.release();\n    });\n});\n. JavaScript is asynchronous:\n``` javascript\nvar global = 1;\nguserstable.update({_id:new ObjectId(self.query.id),uid:self.query.uid},{$set:{econ:1}},function(err,docs){\n    // This method will be called when the database returns a response\n    global = 10;\n});\n// in this line will be \"global\" still 1.\nconsole.log(global);\nguserstable.update({_id:new ObjectId(self.query.id),uid:global},{$set:{econ:1}},function(err,docs){\n    // This method will be called when the database returns a response\n    global = false;\n});\n```\nOrdering:\n``` javascript\nvar global = 1;\nvar pendinglist = [];\npendinglist.push(function(next) {\n    guserstable.update({_id:new ObjectId(self.query.id),uid:self.query.uid},{$set:{econ:1}},function(err,docs){\n        // This method will be called when the database returns a response\n        global = 10;\n        next();\n    });\n});\npendinglist.push(function(next) {\n    // in this line will be \"global\" still 1.\n    console.log('LOG \"global\" --->', global);\n    next();\n});\npendinglist.push(function(next) {\n    guserstable.update({_id:new ObjectId(self.query.id),uid:global},{$set:{econ:1}},function(err,docs){\n        // This method will be called when the database returns a response\n        global = false;\n        next();\n    });\n});\npendinglist.push(function(next) {\n    // in this line will be \"global\" still 1.\n    console.log('LOG \"global\" --->', global);\n    next();\n});\npendinglist.async();\n```\nThanks.\n. Read on end of this page:\nhttp://docs.totaljs.com/v1.8.x/en.html#pages~Controllers\nThanks.\n. Hi @xdascx,\ncan you send me your SMTP informations on my e-mail? I must test it.\nThanks.\n. Hi @xdascx,\ntry to change your exim mail server:\n\nExim does have a work around for this, using allow_auth_unadvertised as described here, you can do something like this:\n\nhosts   = *\ncontrol = allow_auth_unadvertised\nSource: http://serverfault.com/questions/313562/exim-configuration-503-auth-command-used-when-not-advertised. I will update code of the mail if your problem will persist.\nGive me a feedback ASAP.\n. Hi @xdascx,\nI have fixed it. Please download the latest beta version (is stable) npm install total.js@beta.\nThanks!\n. Hi @darrudi,\ngood question. This is not possible in current version (but I'll think about it).\nOnly solution is NGINX as reverse proxy. Why do you not to use it?\n. @darrudi I have added a new method F.listener(req, res):\n``` javascript\nrequire('total.js').http('debug');\n// We add a new web server\nvar https = require('https');\nvar fs = require('fs');\nvar options = {\n  key: fs.readFileSync('test/fixtures/keys/agent2-key.pem'),\n  cert: fs.readFileSync('test/fixtures/keys/agent2-cert.pem')\n};\nhttps.createServer(options, F.listener).listen(8000);\n```\nCan it be? :+1: \nPlease download the framework from GitHub https://github.com/totaljs/framework/tree/v1.9.0\n. Hi @teckays,\nplease serialize model.response to JSON and write me it here + which version of total.js do you use?\n``` html\n@{repository.arr = [1, 2, 3, 4]}\n@{foreach item in repository.arr}\n    \n@{end}\n```\nThanks.\n. @teckays please download latest version of total.js npm install total.js@beta (stable release candidate) and then try to write @{json(model)} and send me the output from HTML.\nThanks.\n. Great. So which data do you want to fill into the tag <my-component item=\"@{item}\"></my-component> from the model?\nPlease send me the output from @{json(model.response)}.\nThanks :-)\n. @teckays ok, so you can use this:\nhtml\n@{foreach item in model.response}\n    <my-component item=\"@{json(item).escape()}\"></my-component>\n@{end}\n. Ohh sorry, use .encode().\n. Great :-)\n. Hi Julien,\ncan you use beta version for your project? npm install total.js@beta\nI need error log again. Thanks.\n. Hi @darrudi,\nthanks :-D ... I'm going to test it. Informations are very good.\nI'll give you a feedback.\n. Hi @alsemany,\n``` javascript\nvar map = function(doc) {\n    return doc;\n};\nDATABASE('users').all(map, function(err, docs) {\n    console.log(docs);\n});\n```\nor if you use (harmony argument) node --harmony yourapp.js then you can use arrow functions:\njavascript\nDATABASE('users').all(n => n, function(err, docs) {\n    console.log(docs);\n});\n\nkindly how to get docs outside the callback function\n\nYou must use --harmony argument again:\n- Generators in NoSQL https://github.com/petersirka/nosql#generators\n- Usage in total.js http://docs.totaljs.com/v1.9.x/en.html#pages~Synchronous%20programming\njavascript\nvar users = yield sync2(DATABASE('users').$$all(n => n.age > 10));\nThanks.\n. Hi @JuniperChicago,\nmany thanks. Can you perform your pull-request into the https://github.com/totaljs/framework/tree/v1.9.1? Many thanks :+1: \n. Thanks!\n. Hi @CCharlieLi,\nthe JavaScript compressor doesn't check semicolons, only compresses JavaScript. HTML and CSS compressors don't check content too. So if you write a bad code then the bad code is compressed.\nSolution:\n- use Uglify https://github.com/totaljs/examples/tree/master/external-compile-uglifyjs\n- disable compression http://docs.totaljs.com/v1.9.x/en.html#api~FrameworkConfiguration~allow-compile-script\nThanks.\n. @CCharlieLi I understand, the compressor in total.js doesn't check missing semicolons. It's too complicated add it but I will think on it.\nThanks.\n. Hi @sarankup,\nhttp://docs.totaljs.com/v1.9.x/en.html#pages~View%20engine\nhtml\nRaw output: @{!query.recentpost}\nEncoded output: @{query.recentpost}\n. Hi @LeventeNagy,\nplease try the latest beta version npm install total.js@beta and give me a feedback with the console output if the problem will persist.\nThanks.\n. Hmm can you send me a whole example on my e-mail?\nI want to publish a new version but I'll wait for solve this problem.\nThanks.\n. No, I have 4 Linux Ubuntu servers with more than 25 total.js projects in production.\n. The problem was solved.\n. Hi @zixd,\n@LeventeNagy wrote me: Removed re-installed via command line, now it works fine.\nMy questions for you:\n1. Which version and distribution of linux do you have?\n2. Please try to install latest version of node.js\nThanks and thanks for your compliment, I appreciate it.\n. Great! Thanks too.\n. Hi @dacrhu,\nI have added it, try npm install total.js@beta.\nUsage:\njavascript\nvar mail = F.mail(..);\nmail.headers = {};\nmail.headers.Precedence = 'bulk';\nPlease try it and give me a feedback.\nThanks.\n. Hi @liaosankai,\nmany thanks for your update. I have implemented it into the v1.9.2 branch without beginItems and endItems (I don't see any benefits of them).\nThanks!\n. Hi @evmek,\nf*uck --> I'm going to fix it now.\n1000x thanks!\n. @evmek many thanks again. I have fixed it now, please download latest beta npm install total.js@beta. Thanks :+1: \n. Hi @evmek,\nmany thanks for your changes. Sometimes I write nice bullshits. I have fixed it.\nThanks.\n. Ooo shit. Many thanks!\nI have fixed it in https://github.com/totaljs/framework/tree/v1.9.3 branch.\nThanks :+1: \n. Hi @liaosankai,\ncan you send me your package file?\nThanks.\n. Hi @liaosankai,\nmany thanks. I found a bug on Windows.\nPlease try new beta: npm install -g total.js@beta\n\nbash\ncd firstpackage\ntotalpackage create firstpackage\nGive me a feedback.\n. Rename the package file firstpackage.package to helloworld.package because I found an unexpected problem with filename and package id export.id = \"\" (in index.js). export.id can't be different than its filename because the package is extracted into /tmp/ directory according its filename, but its executed be another name. I must think about it.\nThanks!\nPS: firstpackage2.package, please send me the file. I'll perform many tests on Windows this week.\n. Open your helloworld2.package in some text editor. All files in the file are without extension. Try to create package without . (dot) at the end of the command.\nBAD:\nbash\ntotalpackage create helloworld2.package .\nGOOD:\nbash\ntotalpackage create helloworld2.package\nThanks.\nGive me a feedback.\nI must check the totalpackage application on Windows.\n. I have tested it on Windows 7 and everything works correctly now.\nThanks!\n. @molda do you have latest beta version?\nInstall total.js beta as global module npm install -g total.js@beta\n. Great! I want to publish a new version this week.\n. Hi @maxxam11,\nI think that your tag contians TAB <tag TAB id=\"tag1\">. Can you send me your HTML on my email? Thanks!\n. Hi @maxxam11,\nany news? Thanks.\n. @maxxam11 can you send me the view as file? ... Because I don't know how to read it from your comment.\n. Hmmm, thanks! I found the problem.\nI'll give you a feedback.\nThanks!\n. Hi @maxxam11,\nI have fixed it now, but the problem is too complicated.\nCan you test it? npm install total.js@beta\nThanks.\n. You didn't use the new beta version:\nnpm install total.js@beta ---> 1.9.3-13\nGive me a feedback.\n. Great. Thanks.\n. Hi @liaosankai,\nthis is not possible with me. I'll fix it today. Thanks for the report.\nI'll give you a feedback.\n. Hi @liaosankai,\nI have published a new beta version. Please try it. Thanks! :+1: \nnpm install total.js@beta\n. Thanks!\n. Yes, it's there a problem. I'll fix it today.\nThanks.\n. I have updated the module:\n- fixed expiration\n- add custom settings\njavascript\nMODULE('flash').expire = 10;\nNew URL address to script:\nhttps://github.com/totaljs/modules/blob/master/Miscellaneous/flash/flash.js\nThanks!\n. Show me your routes, they must contain middleware 'flash'.\n. Hi,\nI have added it now npm install total.js@beta.\nThanks!\n. Hi @liaosankai,\nyou can use both solutions. I should prefer the first way because in different languages can be @{model.count} defined differently.\nAvoid long text :-)\n. Good idea (I'll add it). Thanks.\n. Hi @VarunBatraIT,\nyou can use F.mail() or controller.mail() each function returns MailMessage object. Why do you use F.onMail?\nThanks.\n. I understand, but why do you need to add a name into the address to field?\nYou use F.logmail() for a plain text mail.\n. I understand. I'll look on it.\nThanks.\n. And sorry I forgot to anwser your question: \"Explain Brutal Web Developer\":\nBrutal means --> without any limits :-D\n. I have added it into the framework. Try it: npm install total.js@beta.\n``` javascript\ncontroller.mail('Brutal Web Developer petersirka@gmail.com', ...);\ncontroller.mail('Brutal Web Developer petersirka@gmail.com', ...);\n// or\nvar mail = new Mail.Message();\nmail.to('Brutal Web Developer petersirka@gmail.com');\nmail.to('petersirka@gmail.com', 'Brutal Web Developer');\nmail.cc('Brutal Web Developer petersirka@gmail.com');\nmail.cc('petersirka@gmail.com', 'Brutal Web Developer');\n```\nThanks!\n. Hi @evgeny-t,\nmany thanks.\nI don't have any problem with uploading:\n\n- please, try to install total.js@beta\n- can you record some video? \n- which OS do you use? (OSX, Windows or Linux)\nThanks.\n. Hmm this is very interesting, I'm not able to reproduce it.\nTry to upload from your browser (15 uploads):\nhttp://test.totaljs.com\nDo you have Hangouts / GTalk?\nThanks.\n. @evgeny-t Any news?\n. Hi @molda,\nyes, please try to download latest beta npm install total.js@beta, it's stable and give me a feedback.\nThanks.\n. I have found a problem in total.js documentation.\njavascript\n// This must works:\nF.map('/admin/', F.path.private('admin'));\nThe problem is in the paths between Windows and Unix. For mapping that will work you must use F.path object. Please try it and I must change the documentation.\n. I have published a new beta version (I have fixed paths).\nPlease try it and give me a feedback.\nThanks\n. Hi @molda,\nplease try it again npm install total.js@beta. Thanks.\n. @molda I have published a new beta version.\nCan you test it on your computer? I have only the virtual pc and my view can be wrong.\nThanks!\n. Great, thanks!\n. Hi @VarunBatraIT,\nF.restful supports only flags, but you can define in them the middleware:\njavascript\nF.resful('/users/', ['#middlewareA', '#middlewareB'], query_users, get_users, ...);\nThanks!\n. Hi @liaosankai,\nplease download the framework from GitHub https://github.com/totaljs/framework/tree/v1.9.3\nI added F.onParseQuery delegate:\njavascript\nF.onParseQuery = function(value) {\n    if (!value)\n       return {};\n    return qs.parse(value);\n};\nThis delegate is executed when the framework parsing data from URL or REQUEST BODY.\nGive me a feedback.\nThanks!\n. I'll publish new release today.\nThanks!\n. Hi @LeventeNagy,\nI see the problem in a view template. Can you show your view template?\nThanks.\n. Hmmm. Are you sure, you have the latest version?\nCan you send me a whole example with node_modules directory on my email?\n. @dacrhu thanks, I see the problem in my code:\n@{import('meta', 'head', default.css', 'default.js', 'favicon.ico')} // bad\n@{import('meta', 'head', 'default.css', 'default.js', 'favicon.ico')} // good\nMy mistake in the empty-project. I'm fixing it.\n. I fixed the empty-project in releases.\nThanks!\n. Hi @dacrhu,\ncan you send me a whole code of your action or a scope of async (where is the sync called)?\nThanks!\n. Hmmm, try this:\njavascript\nyield sync(SOURCE('memcached').get)('activation-' + this.body.type + '-' + this.user.userName);\nUPDATED:\nSorry, try to add before the callback console.log(arguments). My another question: Does the action function begin with function *your_action_name() { ...?\n. It works correctly, please look into my example:\nhttps://www.dropbox.com/s/wd65yt960mgvl5w/test-sync.zip\n. @dacrhu this is bug :-D ... I'll fix it today.\n. Please try it:\nnpm install total.js@beta\n. The problem was fixed. Solution: re-installed node.js.\n. Hi @LeventeNagy,\nohh shit yes, you're right. I forgot on documentation.\nIf your package contains:\n- your.package/controllers/some-controller-name.js\n- your.package/models/some-model-name.js\n- your.package/index.js --> exports.booting = true\nThen the framework unpacks all files and evaluates them as classic framework files with except static files and views.\nSo the files will be visible for the framework like this:\n- /controllers/some-controller-name.js\n- /models/some-model-name.js\nIn short: package can contains a part of application.\nDo you undestand?\n. Hi @rsmogura thanks!\nI'll update only arrow function because of backward compatibility.\nThanks!\n. I'll add you into the contributor's list.\nThanks.\n. Hi @maxxam11,\nwhich version of total.js do you use?\n1.9.3 works correctly:\nView:\nhtml\n<div>A B C  D</div>\nOutput:\nhtml\n<div>A B C D</div>\nThanks.\n. OK, you have old beta version. Can you upgrade total.js to newest beta?\nAnd if there will be a problem, can you send me a small example on my email?\nThanks!\n. Shit, yes you're right. I have fixed it.\nPlease try the new beta version npm install total.js@beta.\nThanks!\n. I'm waiting for your feedback :-)\n. Thanks!\n. Please try again the beta version npm install total.js@beta.\nThanks.\n. For me everything works correctly.\nI have performed some tests and all is OK.\nCan you send me a small example?\n\n. Hmm, this works for me.\nCan you send me a whole example (zipped) on my email?\nThanks.\n. Hi @liaotzukai,\nmany thanks! I fixed it and I added you as contributor readme.md and package.json.\nPlease try the fix (I don't have Windows).\nBranch: https://github.com/totaljs/framework/tree/v1.9.4\nThanks!\n. @liaosankai :+1: I updated contributors.\nThanks!\n. Hi @liaosankai,\nmany thanks!\nI have created new branch v1.9.6 https://github.com/totaljs/framework/tree/v1.9.6 and I have published a new beta version npm install total.js@beta with your fix.\nThanks!!!!!!!\n. I must test it. I have problems with my WebSocket projects:\n\n. OK, I found the problem.\nI updated BETA version on NPM.\nThanks!\n. Hi @adrianrey05,\nthere is a bug, sorry ... I'm going to fix it. You're right.\n. Hi @adrianrey05, really sorry for this bug. Please download the latest beta npm install total.js@beta and give me a feedback.\n1000x sorry.\nThank you!\n. Great! Thanks, yes I have :+1:  ... And I wish you all the best!\nThanks!\n. Hi @liaosankai,\nnamespace works via dynamic routes and I considered it as rooms:\njavascript\nF.websocket('/{namespace-room}/', action1);\nF.websocket('/students/{namespace-room}/', action2);\nDo you want to separate clients to different groups? I'm finding a simple solution for you :+1: \n\nE.g. you can use socket.io in total.js without any problem:\nDisallow websocket in the configuration file: http://docs.totaljs.com/v1.9.x/en.html#api~FrameworkConfiguration~allow-websocket\njavascript\nvar io = require('socket.io')(F.server);\n. I'm closing this issue. Give me a feedback if you find some problems :-)\n. I'll try it.\n. Thanks.\n. I have seen it and it's really nice.\n1000x thanks.\n. I found a problem with MongoDB. The SchemaInstance.$clean() is for MongoDB needed because the MongoDB module uses for calculating document's size this:\njavascript\nfor (var key in obj) {\n    // all properties with $_schema (I renamed it to $schema).\n}\n\nI was looking for the problem 30 minutes and some my projects didn't work.\nSo the $clean() creates a copy of the model and removes all hidden unnecessary properties.\nCurrently is everything OK in v1.9.6 branch on the GitHub.\nThanks.\n. Yes, you're right. Shit happen.\nI have renamed it to $$schema because exist $$async and $$result.\nPS: this doesn't work:\njavascript\nif (model.$_schema)\n        delete model.$_schema;\n// we must crawl all properties and all array values\nThis solution works correctly:\nhttps://github.com/totaljs/framework/blob/v1.9.6/builders.js#L1897\nThanks again.\n. No no no, please don't apologize. I copie each change from the latest branch into my server because I can see all bugs. I'm testing all changes and some things we can't test. AppMonitor says truth :+1: about all bugs.\nYour change is a benefit for the framework.\nThanks again!\n. The framework doesn't change original array because:\nhttps://github.com/totaljs/framework/blob/v1.9.4/builders.js#L2108 the framework copies all values to new plain object framework_utils.copy(m).\nOr did you test it? I didn't test array.\n. Yes, you're right.\nI'll fix it.\n. I think that the best solution for it will be:\n- serialize to JSON with the filter for unnecessary properties\n- deserialize\n- return object\nI must perform performance tests whether the JSON will be better or no.\nMongoDB? I must test it.\n. I have added new clone function.\nI think that's everything ok now.\nPlease download latest branch or download new beta from NPM npm install total.js@beta. There is your update with U.request().\nThanks.\n. Thanks. I have published a new beta version: npm install total.js@beta.\n- I have fixed the problem with the layout and mail\n- options argument is optional in MailMessage.send() (I have fixed it).\n1000x Thanks.\n. I understand, but I have in my work SMTP server without any options (only HOSTNAME).\nLocal config is meant only for controller.mail() and F.mail().\nOr do you mean something else?\nPlease write if you have some idea.\n. 2 ms timeout is for that. So the answer: yes. I used the method in 20+ projects, but I can create something similar as you write.\n. @deadman2000\nI have added just another solution, example:\n``` javascript\nvar message = F.mail(.....);\n// Removes timeout\nmessage.manually();\n// You must send the email manually\nmessage.send();\n```\nWhat do you think about it? npm install total.js@beta\n. Hi @neoPix,\nI have looked into the code and onLocate is executed before the middleware, but onLocate doesn't perform nothing complicated.\nYou have 3 ways how to solve this problem:\n1 create middleware:\njavascript\nF.middleware('language', function(req, res, next) {\n    req.$language = 'YOUR_LANGUAGE';\n    // or\n    // req.$language = F.onLocate(req, res, req.isStaticFile);\n    next();\n});\n2 controller's event:\njavascript\nF.on('controller', function(controller) {\n    controller.language = controller.req.$language = F.onLocate(controller.req, controller.res, controller.req.isStaticFile);\n});\n3 update session middleware via first point.\nIt's good for you?\nGive me a feedback.\n. I have fixed a problem with empty response.\nPlease synchronize the latest branch.\nThanks!\n. I have fixed clone again. I found the big problem with cloning Date.\nDownload the latest beta again npm install total.js@beta.\n. I have fixed ArrayBuffer:\n``` javascript\n// client-side\nsocket = new WebSocket('ws://127.0.0.1:8000/');\nsocket.binaryType = 'arraybuffer';\n...\nsocket.send(str2ab('TEST ARRAY BUFFER'));\n// server-side\ncontroller.on('message', function(client, arraybuffer) {\n    console.log(ab2str(arraybuffer));\n    // output: TEST ARRAY BUFFER\n});\n// HELPERS FOR BOTH: client-side & server-side\nfunction ab2str(buf) {\n  return String.fromCharCode.apply(null, new Uint16Array(buf));\n}\nfunction str2ab(str) {\n  var buf = new ArrayBuffer(str.length*2); // 2 bytes for each char\n  var bufView = new Uint16Array(buf);\n  for (var i=0, strLen=str.length; i < strLen; i++) {\n    bufView[i] = str.charCodeAt(i);\n  }\n  return buf;\n}\n```\nBut your example doesn't work with protobufjs, exception Error: Parse error at line 1: unexpected '{' Error: Parse error at line 1: unexpected '{' andArrayBuffer now works correctly --> npm install total.js@beta.\nThanks.\n. Ohhh Great! Thanks!\n. This week will be the new version of total.js.\nThanks.\n. Hi @liaosankai 100x sorry.\nI have fixed it, please try npm install total.js@beta and give me the feedback.\n. Great! I'm closing this issue.\n. Hi @lpinca,\nmhhh --> thanks, I have added it npm install total.js@beta.\n. Hi @liaosankai,\nplease download index.js from this branch https://github.com/totaljs/framework/tree/v1.9.6. I have added encoding. Please give me the feedback.\nThanks!\n. Great, I'm closing issue.\nI'll publish a new version next week.\n. Please send me your code on my email.\nThanks.\n. Hi @neonnds,\ntry this:\njavascript\nself.file('~' + F.path.root('/files/test.png'));\nThanks.\n. Yes, the problem was on OS Windows, so I had to switch relative to absolute.\nMany thanks!\n. Hi @stakost,\ndo you use a reverse proxy or no?\n. Is this way for you?\n``` javascript\nexports.install = function() {\n    F.route('/', view_index);\n};\nfunction view_index() {\n    var self = this;\n    var viewname = 'index';\n    switch (self.req.headers['host']) {\n        case 'somedomain.com':\n            viewname = 'view1';\n            break;\n        case 'domainsome.net':\n            viewname = 'view2';\n            break;\n    }\n    self.view(viewname);\n}\n``\n. If you will havereq.headers['host']` empty then add into your nginx config:\n``` lua\nlocation / {\n    # THIS ONE:\n    proxy_set_header   Host             $http_host;\n# Others\nproxy_set_header   X-Forwarded-Protocol $scheme;\nproxy_set_header   X-Forwarded-For  $remote_addr;\nproxy_set_header   X-NginX-Proxy    true;\nproxy_pass         http://127.0.0.1:8001;\nproxy_http_version 1.1;\nproxy_redirect     off;\nbreak;\n\n}\n}\n```\n. Hi @Poliformado,\nI have created a simple example with WebSocket for understanding.\nWebsocket:\nhttps://github.com/totaljs/examples/tree/master/views-websocket\nOlder XHR (AJAX):\nhttps://github.com/totaljs/examples/tree/master/views-xhr\nThanks.\n. Nooooooooo :-(\nI'm going to fix it, really sorry.\n. I have fixed it.\nPlease install latest beta npm install -g total.js@beta. Really sorry again.\n. @liaosankai I have updated in the beta version F.websocket(). Flags can contain origins + protocols like this F.websocket(..., ['https://www.privater.eu', 'https://www.totaljs.com', 'roomA', 'roomB']).\n. Hi @adrianrey05,\nyes, because each application begins from the / root path.\nYou can change the mapping of static files easily:\nhttp://docs.totaljs.com/v1.9.x/en.html#api~FrameworkConfiguration~static-url-script\nhttp://docs.totaljs.com/v1.9.x/en.html#api~FrameworkConfiguration~static-url-style\nhtml\nstatic-url-script     : /faq/js/\nstatic-url-style      : /faq/css/\nAnd the web routing in second app must start too with:\njavascript\nF.route('/faq/');\nDo you understand? ... or I don't understand :-D\n. OK and does this example.com:81/faq/ work?\nPS: english is ok for me\n. OK and send me please the content (create screenshot or whatever) of public directory in /faq/ app.\nThanks.\n. OK, I see the problem:\nhttps://github.com/adrianrey05/total-faq/tree/master/public\nAppend scripts and styles into the /public/faq/ directory and everything will be ok.\nThanks :-)\n. /faq/views/index.html is routed into /public/faq/views/index.html.\nDo you understand? :-)\n. I'll add a feature into the framework for this case.\nI'll will think about it.\n. Hi @adrianrey05,\ndone, I have added it.\nTry a new beta version npm install total.js@beta.\nHow does it work?\nAdd into your app config the line below:\nhtml\ndefault-root    : /faq/\n. Hi @adrianrey05,\nyes, you're right. I have fixed it. Please download the latest beta npm install total.js@beta.\nThanks.\n. Hi @dmilovanovic,\nyes you're right. I found the bug in view caching.\nPlease download latest beta npm install total.js@beta and give me a feedback.\nThanks!\n. Great!\nThanks.\n. Hi @gallegogt,\nI have fixed it.\nnpm install -g total.js@beta\nThanks.\n. Hi @adrianrey05:\n1. don't use debug.js\n2. if you use node > 12 then remove --harmony argument\nWhy don't use debug.js?\nbecause debug.js runs another instance of total.js.\nSolution:\n- create /app/index.js\n- append require('total.js').http('debug');\n- save\n- run it in the CMD\nThanks.\n. Hi @Haajsaiko,\nAction in the controller:\n``` javascript\n// self.query ===> parsed values from URL (GET)\n// self.body  ===> parsed values from a request body (POST/PUT/DELETE)\nvar model = self.body;\n// model contains form fields\nself.mail('petersirka@gmail.com', 'Test e-mail', '~email', model);\n```\nMail template:\nhtml\n<div>name: @{model.form_field_name1}</div>\n<div>email: @{model.form_field_name2}</div>\n<div>phone: @{model.form_field_name3}</div>\n<div>body: @{model.form_field_name4}</div>\nDo you understand?\nThanks.\n. Do you have a small example? Send me it on my email petersirka@gmail.com and I'll look into it.\nThanks..\n. I found the problem, update your route to mail like this:\njavascript\nF.route('/mail/', redirect_mail, ['post']);\nThe framework rejected your form, you create a nice fallback :+1: (therefore the model was empty)\nhtml\n<a  class=\"btn btn-success\" href=\"/mail/\">Send message</a>\nGive me a feedback.\n. I'll answer tomorrow because I'm out. Thanks!\n. I'm here. I found the problem:\n- you have declared two same routes to two different actions\njavascript\nF.route('/', view_index);\n// F.route('/', json_index);\n. I'm closing issue, I don't have any response.\n. When I use F.route('/mail/', redirect_mail); in the mail I have blank fields in the mail:\nyes, because your model is empty (self.body too)\nPlease study this example:\nhttps://www.dropbox.com/s/jbzhxag5xwrn2ej/contact-form.zip?dl=0\nThanks\n. Hi @maxxam11,\nyes, you're right.\n``` javascript\nvar options = {};\noptions.https = {\n  key: fs.readFileSync('test/fixtures/keys/agent2-key.pem'),\n  cert: fs.readFileSync('test/fixtures/keys/agent2-cert.pem')\n};\nrequire('total.js').https('debug', options);\n```\nhttp://docs.totaljs.com/v1.9.x/en.html#api~Framework~framework.https\nPS: I recommend to use NGINX as reverse proxy for it.\n. Please give me a feedback if it works. I didn't use node.js HTTPS.\nThanks!\n. Great! Thanks.\n. Thanks!\n. I'm thinking about it and that's not good idea, because pagination starts from 1. Otherwise: pagination.first() starts from 1 not from 0. I have to perform a rollback :+1: but thanks!\n. Bohes dobre si to dal!\nJa som sa zase pom\u00fdlil. Ja som k*... ospravedl\u0148ujem sa. Vraciam sp\u00e4\u0165 :-D\n. Fakt sa ospravedl\u0148ujem, je to tam.\n10000000x :100:  sorry a \u010fakujem\n. @DusanDragulaGR publikoval som nov\u00fa beta npm install total.js@beta -- e\u0161te raz d\u00edk.\n. Hi @liaosankai,\nthis is a problem because F.log is multi-argument and true can be a value. I recommend to rewrite prototype and replace Fs.appendFileSync() instead of Fs.appendFile(). Create a definition or module with this content:\n``` javascript\nvar Fs = require('fs');\nF.log = function() {\nvar self = this;\nvar now = new Date();\nvar filename = now.getFullYear() + '-' + (now.getMonth() + 1).toString().padLeft(2, '0') + '-' + now.getDate().toString().padLeft(2, '0');\nvar time = now.getHours().toString().padLeft(2, '0') + ':' + now.getMinutes().toString().padLeft(2, '0') + ':' + now.getSeconds().toString().padLeft(2, '0');\nvar str = '';\nvar length = arguments.length;\n\nfor (var i = 0; i < length; i++) {\n    var val = arguments[i];\n    if (val === undefined)\n        val = 'undefined';\n    else if (val === null)\n        val = 'null';\n    else if (typeof(val) === OBJECT)\n        val = util.inspect(val);\n    str += (str ? ' ' : '') + val;\n}\n\nself.path.verify('logs');\nFs.appendFileSync(utils.combine(self.config['directory-logs'], filename + '.log'), time + ' | ' + str + '\\n');\nreturn self;\n\n};\n```\nThanks.\n. No problem :-) and sorry for it.\n. Thanks!\nI have fixed it.\nPlease download utils.js from https://github.com/totaljs/framework/tree/v1.9.7.\nThanks again!\n. Hi @maxxam11, do you have a small example? Thanks\n. Try to new beta npm install total.js@beta.\nThe second number on the screenshot below is count of requests:\n\nThanks and give me a feedback.\n. Try to run your script like this:\nbash\nnode --nouse-idle-notification --expose-gc yourscript.js\nThanks.\n. Hi @liaosankai,\nfor this case is good internal QueryString module:\n``` javascript\nvar Qs = require('querystring');\nparams['xyz'] = 123;\ndelete params.b;\nconsole.log(Qs.stringify(params));\n```\nhttps://nodejs.org/dist/latest-v4.x/docs/api/querystring.html\n\nI have added a new method for views npm install total.js@beta:\n``` html\n @{href({ key1: 1, key2: 2 })} \n @{href('key1=value1&key2=value2')} \n @{href('key', 'value')} \nASC\nDESC\nReset search\n OUTPUT \n e.g. current URL: /?search=total&sort=5 \nASC\nDESC\nReset search\n```\nThe method updates current QueryString and returns modified current relative URL.\nThanks.\n. No problem :-)\nThe only one problem with this method is that the method can't remove a value. The value can be changed, not removed.\nThanks\n. Hi @Haajsaiko,\nwhich example? Please write me URL.\nThanks.\n. Hmmm I have tested it and everything works correctly. Can you send me your example on my email?\n. This works:\njavascript\nDATABASE('logos').find({}).toArray(this.callback('index'));\nand this didn't work:\njavascript\nDATABASE('logos').find().toArray(this.callback('index'));\n. You have sent me only a part of the code. I didn't see your data, I have tested it on my database from MongoDB example. Do you have teamviewer? Contact me on my email or hangouts: petersirka. I want to help you.\n. Hi @liaosankai,\nthe framework doesn't have any solution for it. My recommendation:\n1. each new client has to obtain a timestamp from the server e.g. Date.now()\n2. then you have to maintain the timestamp on client-side e.g. setInterval() each 1 second\n3. each message from client-side will contain this timestamp\n4. you will obtain information of duration between the client-side and server-side\n5. you have to synchronize timestamp of each client each 5 minutes\nThis is sufficient.\nThanks :-)\n. I found a bug in websocket controller.send(), so please download the latest version from GitHub :-)\nI'll publish the new version this week.\nThanks.\n. Hi @LeventeNagy,\nI have updated the module on GitHub, try it:\n``` javascript\n// MODULE('flash').expire = '5 minutes';\nMODULE('flash').expire = '1 second';\n// or you can set special expiration for specific route:\nF.route('/message/', ..., ['#flash', { expire: '1 minute' }]);\n```\nGive me a feedback.\n. And do you download the module from GitHub?\n. Please try it again.\n. Hi @SleepShadowWeb, this is not possible. I know what you want. A web server with the port is initialized when is the framework started. So you can't change the port.\nOnly way how to handle it: run multiple apps on different ports.\nCan you write me why do you need this?\nThanks.\n. I understand what you want but this is not possible. As I wrote, the framework runs on the one port and you can't change this port when is the framework running. You have to create master process with child total.js applications which they will run on different ports.\nSorry :-(\n. Yes, you're right.\nThanks.\n. Hi @evgeny-t,\nwhich version of total.js do you use?\n. Mmmt, I wrote garbage before :-D\n. I think that with PM2 cluster will not work.\nTry to write your own implementation of cluster and run it as classic app in PM2.\nhttps://github.com/totaljs/examples/blob/master/cluster/index.js\n\nI'll look into the PM2 problem with the cluster today and I'll give you a feedback.\n. Hi @evgeny-t,\nit works correctly:\n\n\n\nTry to install latest beta version.\n. I have tested it on node.js v4.4.0 and everything works correctly too.\nThanks.\n. Hi @liaosankai,\nplease download the latest beta version npm install total.js@beta (IMPORTANT: it's 2.0). I have added catching of this exception and when it will be exist then I kill the connection.\nGive me a feedback.\n. Sorry and yes.\n- F.cors() automatically creates own route for cors requests (the browser sends a preflight and the framework doesn't execute controller, only it responds for the request)\n- F.route() with cors evalutes F.route() and then registers a cors route with same URL + flags via F.cors()\nv1.9.7 supports new cors mechanism and v2.0.0 removed old.\nMy answer for your question:\n- yes, you can use a new flag or:\n``` javascript\nF.route('/api/users/', some_action1, ['get']);\nF.route('/api/users/', some_action2, ['post']);\nF.route('/api/users/', some_action3, ['put']);\nF.route('/api/users/', some_action4, ['delete']);\nF.cors('/api/users/', ['get', 'post', 'put', 'delete', 'credentials']);\n// is same as\nF.route('/api/users/', some_action4, ['get', 'post', 'put', 'delete', 'cors', 'credentials']);\n``\n. No,websocketis a bit different. Websocket is cors enabled by default. You can only restrict websocket flags about e.g. your own originhttp://(default*) or protocol e.g.chat,private, etc..\n. I understand, but node.js doesn't trigger any event for this case. For this case I have addedping`:\nhttp://docs.totaljs.com/v1.9.x/en.html#api~FrameworkConfiguration~default-interval-websocket-ping\nTry to wait. I tried to simulate it 2 hours before and without result.\n. Do you use nginx?\nTry to use:\njavascript\ncontroller.on('open', function(client) {\n   client.socket.setTimeout(0);\n});\n. Hmmm and how do you define a route? I have tested it and everything works correctly.\n. I understand, I think that yes .. I will think about it today, ok?\n. mmmt... I'll look into it .... I'll fix the problem.\n. @liaosankai how do you send a message? I have updated controller.send() method, do you use it? Or where is the problem? Is the websocket connection destroyed? Or?\n. @liaosankai please download the latest beta npm install total.js@beta. I have found a bug in origin validator. Give me a feedback.\n. Hi @LeventeNagy:\n1. which version of total.js do you use?\n2. which OS do you use?\nThanks.\n. Can you test it on total.js 2.0 --> npm install total.js@beta?\nI know about this bug in v1.9.7 :\n1. when image() doens't contain any operations.\n2. windows doesn't have associated convert as global path for CMD (try to use GraphicsMagick or try to write convert in CMD whether it exists or no).\nI prepare v1.9.8 with bug fixes, but I recommend to use total.js 2.0.\nThanks.\n. OK and try to run in your CMD convert argument, what's the output?\n. My big mistake :100: \nYour code is bad.\nTry 1:\njavascript\nvar image = self.files[0].image();\nimage.blur(5);\nimage.save(....);\nTry 2:\n- filename contains only filename not a full path\n- path contains a path to the real file in tmp\njavascript\nImage.load(self.files[0].path, true).make(function(image) {\n    image.save('/public/tmp/'+self.files[0].path);\n    self.json('done');\n});\nGive me a feedback.\n. You can't save file to file.path because when do you responds via controller.json() or controller.view() or etc. then the framework removes all uploaded files. You can disable it via controller.noClear() (but I don't recommend it).\nServer-side:\n``` javascript\nvar file = self.files[0];\nvar target = 'my-new-file.jpg';\nfile.image().make(function(image) {\n    image.output('jpg');\n    image.quality(90);\n    image.save(F.path.public(target), () => self.json(target));\n});\n```\nClient-side:\njavascript\nvar response = JSON.parse(SERVERRESPONSE);\n$(document.body).append('<img src=\"/' + response + '\" />');\nPS: you can't serialize self.json(image) because image is an instance of the FrameworkImage and FrameworkImage executes only CMD/TERMINAL.\n. I have renamed it to String.removeTags().\nThanks!\n. ``` javascript\nconst DIACRITICS2 = {225:'a',228:'a',269:'c',271:'d',233:'e',283:'e',357:'t',382:'z',250:'u',367:'u',252:'u',369:'u',237:'i',239:'i',244:'o',243:'o',246:'o',353:'s',318:'l',314:'l',253:'y',255:'y',263:'c',345:'r',341:'r',328:'n',337:'o'};\nconst DIACRITICS=[{base:\" \",chars:\"\\u00a0\"},{base:\"0\",chars:\"\\u07c0\"},{base:\"A\",chars:\"\\u24b6\\uff21\\u00c0\\u00c1\\u00c2\\u1ea6\\u1ea4\\u1eaa\\u1ea8\\u00c3\\u0100\\u0102\\u1eb0\\u1eae\\u1eb4\\u1eb2\\u0226\\u01e0\\u00c4\\u01de\\u1ea2\\u00c5\\u01fa\\u01cd\\u0200\\u0202\\u1ea0\\u1eac\\u1eb6\\u1e00\\u0104\\u023a\\u2c6f\"},{base:\"AA\",chars:\"\\ua732\"},{base:\"AE\",chars:\"\\u00c6\\u01fc\\u01e2\"},{base:\"AO\",chars:\"\\ua734\"},{base:\"AU\",chars:\"\\ua736\"},{base:\"AV\",chars:\"\\ua738\\ua73a\"},{base:\"AY\",chars:\"\\ua73c\"},{base:\"B\",chars:\"\\u24b7\\uff22\\u1e02\\u1e04\\u1e06\\u0243\\u0181\"},\n    {base:\"C\",chars:\"\\u24b8\\uff23\\ua73e\\u1e08\\u0106C\\u0108\\u010a\\u010c\\u00c7\\u0187\\u023b\"},{base:\"D\",chars:\"\\u24b9\\uff24\\u1e0a\\u010e\\u1e0c\\u1e10\\u1e12\\u1e0e\\u0110\\u018a\\u0189\\u1d05\\ua779\"},{base:\"Dh\",chars:\"\\u00d0\"},{base:\"DZ\",chars:\"\\u01f1\\u01c4\"},{base:\"Dz\",chars:\"\\u01f2\\u01c5\"},{base:\"E\",chars:\"\\u025b\\u24ba\\uff25\\u00c8\\u00c9\\u00ca\\u1ec0\\u1ebe\\u1ec4\\u1ec2\\u1ebc\\u0112\\u1e14\\u1e16\\u0114\\u0116\\u00cb\\u1eba\\u011a\\u0204\\u0206\\u1eb8\\u1ec6\\u0228\\u1e1c\\u0118\\u1e18\\u1e1a\\u0190\\u018e\\u1d07\"},{base:\"F\",chars:\"\\ua77c\\u24bb\\uff26\\u1e1e\\u0191\\ua77b\"},\n    {base:\"G\",chars:\"\\u24bc\\uff27\\u01f4\\u011c\\u1e20\\u011e\\u0120\\u01e6\\u0122\\u01e4\\u0193\\ua7a0\\ua77d\\ua77e\\u0262\"},{base:\"H\",chars:\"\\u24bd\\uff28\\u0124\\u1e22\\u1e26\\u021e\\u1e24\\u1e28\\u1e2a\\u0126\\u2c67\\u2c75\\ua78d\"},{base:\"I\",chars:\"\\u24be\\uff29\\u00cc\\u00cd\\u00ce\\u0128\\u012a\\u012c\\u0130\\u00cf\\u1e2e\\u1ec8\\u01cf\\u0208\\u020a\\u1eca\\u012e\\u1e2c\\u0197\"},{base:\"J\",chars:\"\\u24bf\\uff2a\\u0134\\u0248\\u0237\"},{base:\"K\",chars:\"\\u24c0\\uff2b\\u1e30\\u01e8\\u1e32\\u0136\\u1e34\\u0198\\u2c69\\ua740\\ua742\\ua744\\ua7a2\"},{base:\"L\",chars:\"\\u24c1\\uff2c\\u013f\\u0139\\u013d\\u1e36\\u1e38\\u013b\\u1e3c\\u1e3a\\u0141\\u023d\\u2c62\\u2c60\\ua748\\ua746\\ua780\"},\n    {base:\"LJ\",chars:\"\\u01c7\"},{base:\"Lj\",chars:\"\\u01c8\"},{base:\"M\",chars:\"\\u24c2\\uff2d\\u1e3e\\u1e40\\u1e42\\u2c6e\\u019c\\u03fb\"},{base:\"N\",chars:\"\\ua7a4\\u0220\\u24c3\\uff2e\\u01f8\\u0143\\u00d1\\u1e44\\u0147\\u1e46\\u0145\\u1e4a\\u1e48\\u019d\\ua790\\u1d0e\"},{base:\"NJ\",chars:\"\\u01ca\"},{base:\"Nj\",chars:\"\\u01cb\"},{base:\"O\",chars:\"\\u24c4\\uff2f\\u00d2\\u00d3\\u00d4\\u1ed2\\u1ed0\\u1ed6\\u1ed4\\u00d5\\u1e4c\\u022c\\u1e4e\\u014c\\u1e50\\u1e52\\u014e\\u022e\\u0230\\u00d6\\u022a\\u1ece\\u0150\\u01d1\\u020c\\u020e\\u01a0\\u1edc\\u1eda\\u1ee0\\u1ede\\u1ee2\\u1ecc\\u1ed8\\u01ea\\u01ec\\u00d8\\u01fe\\u0186\\u019f\\ua74a\\ua74c\"},\n    {base:\"OE\",chars:\"\\u0152\"},{base:\"OI\",chars:\"\\u01a2\"},{base:\"OO\",chars:\"\\ua74e\"},{base:\"OU\",chars:\"\\u0222\"},{base:\"P\",chars:\"\\u24c5\\uff30\\u1e54\\u1e56\\u01a4\\u2c63\\ua750\\ua752\\ua754\"},{base:\"Q\",chars:\"\\u24c6\\uff31\\ua756\\ua758\\u024a\"},{base:\"R\",chars:\"\\u24c7\\uff32\\u0154\\u1e58\\u0158\\u0210\\u0212\\u1e5a\\u1e5c\\u0156\\u1e5e\\u024c\\u2c64\\ua75a\\ua7a6\\ua782\"},{base:\"S\",chars:\"\\u24c8\\uff33\\u1e9e\\u015a\\u1e64\\u015c\\u1e60\\u0160\\u1e66\\u1e62\\u1e68\\u0218\\u015e\\u2c7e\\ua7a8\\ua784\"},{base:\"T\",chars:\"\\u24c9\\uff34\\u1e6a\\u0164\\u1e6c\\u021a\\u0162\\u1e70\\u1e6e\\u0166\\u01ac\\u01ae\\u023e\\ua786\"},\n    {base:\"Th\",chars:\"\\u00de\"},{base:\"TZ\",chars:\"\\ua728\"},{base:\"U\",chars:\"\\u24ca\\uff35\\u00d9\\u00da\\u00db\\u0168\\u1e78\\u016a\\u1e7a\\u016c\\u00dc\\u01db\\u01d7\\u01d5\\u01d9\\u1ee6\\u016e\\u0170\\u01d3\\u0214\\u0216\\u01af\\u1eea\\u1ee8\\u1eee\\u1eec\\u1ef0\\u1ee4\\u1e72\\u0172\\u1e76\\u1e74\\u0244\"},{base:\"V\",chars:\"\\u24cb\\uff36\\u1e7c\\u1e7e\\u01b2\\ua75e\\u0245\"},{base:\"VY\",chars:\"\\ua760\"},{base:\"W\",chars:\"\\u24cc\\uff37\\u1e80\\u1e82\\u0174\\u1e86\\u1e84\\u1e88\\u2c72\"},{base:\"X\",chars:\"\\u24cd\\uff38\\u1e8a\\u1e8c\"},{base:\"Y\",chars:\"\\u24ce\\uff39\\u1ef2\\u00dd\\u0176\\u1ef8\\u0232\\u1e8e\\u0178\\u1ef6\\u1ef4\\u01b3\\u024e\\u1efe\"},\n    {base:\"Z\",chars:\"\\u24cf\\uff3a\\u0179\\u1e90\\u017b\\u017d\\u1e92\\u1e94\\u01b5\\u0224\\u2c7f\\u2c6b\\ua762\"},{base:\"a\",chars:\"\\u24d0\\uff41\\u1e9a\\u00e0\\u00e1\\u00e2\\u1ea7\\u1ea5\\u1eab\\u1ea9\\u00e3\\u0101\\u0103\\u1eb1\\u1eaf\\u1eb5\\u1eb3\\u0227\\u01e1\\u00e4\\u01df\\u1ea3\\u00e5\\u01fb\\u01ce\\u0201\\u0203\\u1ea1\\u1ead\\u1eb7\\u1e01\\u0105\\u2c65\\u0250\\u0251\"},{base:\"aa\",chars:\"\\ua733\"},{base:\"ae\",chars:\"\\u00e6\\u01fd\\u01e3\"},{base:\"ao\",chars:\"\\ua735\"},{base:\"au\",chars:\"\\ua737\"},{base:\"av\",chars:\"\\ua739\\ua73b\"},{base:\"ay\",chars:\"\\ua73d\"},\n    {base:\"b\",chars:\"\\u24d1\\uff42\\u1e03\\u1e05\\u1e07\\u0180\\u0183\\u0253\\u0182\"},{base:\"c\",chars:\"\\uff43\\u24d2\\u0107\\u0109\\u010b\\u010d\\u00e7\\u1e09\\u0188\\u023c\\ua73f\\u2184\"},{base:\"d\",chars:\"\\u24d3\\uff44\\u1e0b\\u010f\\u1e0d\\u1e11\\u1e13\\u1e0f\\u0111\\u018c\\u0256\\u0257\\u018b\\u13e7\\u0501\\ua7aa\"},{base:\"dh\",chars:\"\\u00f0\"},{base:\"dz\",chars:\"\\u01f3\\u01c6\"},{base:\"e\",chars:\"\\u24d4\\uff45\\u00e8\\u00e9\\u00ea\\u1ec1\\u1ebf\\u1ec5\\u1ec3\\u1ebd\\u0113\\u1e15\\u1e17\\u0115\\u0117\\u00eb\\u1ebb\\u011b\\u0205\\u0207\\u1eb9\\u1ec7\\u0229\\u1e1d\\u0119\\u1e19\\u1e1b\\u0247\\u01dd\"},\n    {base:\"f\",chars:\"\\u24d5\\uff46\\u1e1f\\u0192\"},{base:\"ff\",chars:\"\\ufb00\"},{base:\"fi\",chars:\"\\ufb01\"},{base:\"fl\",chars:\"\\ufb02\"},{base:\"ffi\",chars:\"\\ufb03\"},{base:\"ffl\",chars:\"\\ufb04\"},{base:\"g\",chars:\"\\u24d6\\uff47\\u01f5\\u011d\\u1e21\\u011f\\u0121\\u01e7\\u0123\\u01e5\\u0260\\ua7a1\\ua77f\\u1d79\"},{base:\"h\",chars:\"\\u24d7\\uff48\\u0125\\u1e23\\u1e27\\u021f\\u1e25\\u1e29\\u1e2b\\u1e96\\u0127\\u2c68\\u2c76\\u0265\"},{base:\"hv\",chars:\"\\u0195\"},{base:\"i\",chars:\"\\u24d8\\uff49\\u00ec\\u00ed\\u00ee\\u0129\\u012b\\u012d\\u00ef\\u1e2f\\u1ec9\\u01d0\\u0209\\u020b\\u1ecb\\u012f\\u1e2d\\u0268\\u0131\"},\n    {base:\"j\",chars:\"\\u24d9\\uff4a\\u0135\\u01f0\\u0249\"},{base:\"k\",chars:\"\\u24da\\uff4b\\u1e31\\u01e9\\u1e33\\u0137\\u1e35\\u0199\\u2c6a\\ua741\\ua743\\ua745\\ua7a3\"},{base:\"l\",chars:\"\\u24db\\uff4c\\u0140\\u013a\\u013e\\u1e37\\u1e39\\u013c\\u1e3d\\u1e3b\\u017f\\u0142\\u019a\\u026b\\u2c61\\ua749\\ua781\\ua747\\u026d\"},{base:\"lj\",chars:\"\\u01c9\"},{base:\"m\",chars:\"\\u24dc\\uff4d\\u1e3f\\u1e41\\u1e43\\u0271\\u026f\"},{base:\"n\",chars:\"\\u24dd\\uff4e\\u01f9\\u0144\\u00f1\\u1e45\\u0148\\u1e47\\u0146\\u1e4b\\u1e49\\u019e\\u0272\\u0149\\ua791\\ua7a5\\u043b\\u0509\"},{base:\"nj\",\n        chars:\"\\u01cc\"},{base:\"o\",chars:\"\\u24de\\uff4f\\u00f2\\u00f3\\u00f4\\u1ed3\\u1ed1\\u1ed7\\u1ed5\\u00f5\\u1e4d\\u022d\\u1e4f\\u014d\\u1e51\\u1e53\\u014f\\u022f\\u0231\\u00f6\\u022b\\u1ecf\\u0151\\u01d2\\u020d\\u020f\\u01a1\\u1edd\\u1edb\\u1ee1\\u1edf\\u1ee3\\u1ecd\\u1ed9\\u01eb\\u01ed\\u00f8\\u01ff\\ua74b\\ua74d\\u0275\\u0254\\u1d11\"},{base:\"oe\",chars:\"\\u0153\"},{base:\"oi\",chars:\"\\u01a3\"},{base:\"oo\",chars:\"\\ua74f\"},{base:\"ou\",chars:\"\\u0223\"},{base:\"p\",chars:\"\\u24df\\uff50\\u1e55\\u1e57\\u01a5\\u1d7d\\ua751\\ua753\\ua755\\u03c1\"},{base:\"q\",chars:\"\\u24e0\\uff51\\u024b\\ua757\\ua759\"},\n    {base:\"r\",chars:\"\\u24e1\\uff52\\u0155\\u1e59\\u0159\\u0211\\u0213\\u1e5b\\u1e5d\\u0157\\u1e5f\\u024d\\u027d\\ua75b\\ua7a7\\ua783\"},{base:\"s\",chars:\"\\u24e2\\uff53\\u015b\\u1e65\\u015d\\u1e61\\u0161\\u1e67\\u1e63\\u1e69\\u0219\\u015f\\u023f\\ua7a9\\ua785\\u1e9b\\u0282\"},{base:\"ss\",chars:\"\\u00df\"},{base:\"t\",chars:\"\\u24e3\\uff54\\u1e6b\\u1e97\\u0165\\u1e6d\\u021b\\u0163\\u1e71\\u1e6f\\u0167\\u01ad\\u0288\\u2c66\\ua787\"},{base:\"th\",chars:\"\\u00fe\"},{base:\"tz\",chars:\"\\ua729\"},{base:\"u\",chars:\"\\u24e4\\uff55\\u00f9\\u00fa\\u00fb\\u0169\\u1e79\\u016b\\u1e7b\\u016d\\u00fc\\u01dc\\u01d8\\u01d6\\u01da\\u1ee7\\u016f\\u0171\\u01d4\\u0215\\u0217\\u01b0\\u1eeb\\u1ee9\\u1eef\\u1eed\\u1ef1\\u1ee5\\u1e73\\u0173\\u1e77\\u1e75\\u0289\"},\n    {base:\"v\",chars:\"\\u24e5\\uff56\\u1e7d\\u1e7f\\u028b\\ua75f\\u028c\"},{base:\"vy\",chars:\"\\ua761\"},{base:\"w\",chars:\"\\u24e6\\uff57\\u1e81\\u1e83\\u0175\\u1e87\\u1e85\\u1e98\\u1e89\\u2c73\"},{base:\"x\",chars:\"\\u24e7\\uff58\\u1e8b\\u1e8d\"},{base:\"y\",chars:\"\\u24e8\\uff59\\u1ef3\\u00fd\\u0177\\u1ef9\\u0233\\u1e8f\\u00ff\\u1ef7\\u1e99\\u1ef5\\u01b4\\u024f\\u1eff\"},{base:\"z\",chars:\"\\u24e9\\uff5a\\u017a\\u1e91\\u017c\\u017e\\u1e93\\u1e95\\u01b6\\u0225\\u0240\\u2c6c\\ua763\"}];\nfor(var DIACRITICSMAP={},i=0;i<DIACRITICS.length;i+=1)for(var chars=DIACRITICS[i].chars,j=0;j<chars.length;j+=1)DIACRITICSMAP[chars[j]]=DIACRITICS[i].base;\nfunction removeDiacritics2(str) {\n    var buf = '';\n    for (var i = 0, length = str.length; i < length; i++) {\n    var c = str[i];\n    var code = c.charCodeAt(0);\n    var isUpper = false;\n    var r = DIACRITICS2[code];\n\n    if (r === undefined) {\n        code = c.toLowerCase().charCodeAt(0);\n        r = DIACRITICS2[code];\n        isUpper = true;\n    }\n\n    if (r === undefined) {\n        buf += c;\n        continue;\n    }\n\n    c = r;\n    if (isUpper)\n        c = c.toUpperCase();\n    buf += c;\n}\n\nreturn buf;\n\n};\nfunction removeDiacritics(str) {\n    return str.replace(/[^\\u0000-\\u007e]/g, function(c) {\n        return DIACRITICSMAP[c] || c;\n    });\n};\nvar a = '\u013e\u0161\u0165\u00fd\u017e\u010d\u00e1\u013e\u010d\u0161\u013e\u010d\u00e1\u00ed\u00e9\u0160\u0164\u010e';\nvar b = 'lstyzcalcslcaieSTD';\nconsole.time('old');\nfor (var i = 0; i < 100000; i++)\n    removeDiacritics2(a);\nconsole.timeEnd('old');\nconsole.time('new');\nfor (var i = 0; i < 100000; i++)\n    removeDiacritics(a);\nconsole.timeEnd('new');\n```\nold: 120ms\nnew: 286ms\n. But yes, it's better for UTF8 chars.\n. Hi @FKasa, what the hell, you're right. I have fixed it in v2.0.0.\n``` javascript\nvar number = 100;\nconsole.log(number.add('+10'));\n// output: 110\nconsole.log(number.add('-10'));\n// output: 90\nconsole.log(number.add('*10'));\n// output: 1000\nconsole.log(number.add('/10'));\n// output: 10\nconsole.log(number.add('10%'));\n// output: 10\nconsole.log(number.add('+10%'));\n// output: 110\nconsole.log(number.add('-90%'));\n// output: 10\nconsole.log(number.add('*10%'));\n// output: 1000\nconsole.log(number.add('/10%'));\n// output: 10\n```\nThank you!\n. Please download all *.js files from GitHub branch 2.0.0 and copy them to node_modules/total.js directory.\nhttps://github.com/totaljs/framework/tree/v2.0.0\n. @FKasa shiit, I don't know about it. I'll remember it.\nThanks.\n. HI @aubergine10\nyes, I have a lot of problems in documentation with grammar. I'll be really happy when you help me with it.\nI prepare a new documentation for total.js v2.0.0 https://github.com/totaljs/documentation so you can edit this branch (I'll be happy).\nFile:\nhttps://github.com/totaljs/documentation/tree/master/public/v2.0.x/en.json\nPlease commit each change because I have problem with merging file en.json (it's too big) when is a change. Thank you !!!!!! \ud83d\udc4d  \ud83d\udcaf  \ud83d\udc4d \n. I appreciate it \ud83d\udc4d \n. exports.usage() returns information about usage of model, module, controller. The method F.usage() collects all information from all dependencies.\nOutput from the method F.usage() (serialized into the JSON):\nhttp://www.gpslocalization.com/usage/\nThe picture below shows all registered modules, try to find reqstats module and its usage is null because the module doesn't contain exports.usage.\n\nDo you understand?\nThank you!\n. Yes and no. usage offers only information about module/model/controller usage (nothing more).\n. Yes \ud83d\udcaf \n. I understand but I think that it's not a good idea because documentation is offline and I'll minify the en.json file. I don't have any problem with editing the file, a good tool for editing JSON https://tickplant.com/powerjsoneditor/ and Sublime Text with String utilities plugin, it supports json escape and json unescape. I don't want to change a structure of the docs, it's not perfect but it works \ud83d\udc4d \nI need improve a grammar. Thank you\n. Thank you!\n. Hmm, maybe you have right. The fields are correct in our country, but I can rename it. I didn't realize it.\n. Replaced.\nThank you.\n. Hi @aubergine10, yes I discovered this problem some time ago. I have increased script version, please refresh the webapp (CMD+R) and try it again. It must work.\nThank you!\n. Thank you! I use it too.\n. Hi @aubergine10,\nI have fixed it and I have added a new total.js schema types Email, Zip, Phone, Camelize, Lower and Upper. Please try it on your side.\nThank you!\n. Hmmm, I don't see any problem with Save Schema:\nhttps://designer.totaljs.com/8cc84a07dfbde59314b72fcb10ed20/\nPassword: 123456\nI don't know how to simulate it.\nPS: I have changed the version to 0.2.0.\n. Yes. The passwords are encrypted in DB. But yes, you're right, I'll add auto-generate password or better solution is to implement user accounts (I didn't have free time for it).\n. I have added generating random number password.\nThank you.\nI will think about your last comment.\n. I have postponed this task.\n. Code 1 and Code 2\nOhhh shit, you're right. I have fixed it and yes the code can be optimized better (I'll look into it).\nCode 3\nYes, you're right, I'll change it.\nThank you!\n. I have improved the code. What do you think about Camelize, do I have to rename it?\n. The framework performs trim for all strings. You can disable this behaviour via schema.trim = false. Yes, I have renamed Camelize to Capitalize, it will be better.\nI think that other types are not important. Otherwise we can update their in schema.setPrepare(). What do you think?\nThank you for improving words.\nPS: please download the framework from GitHub https://github.com/totaljs/framework/tree/v2.0.0\n. Too complicated and with minimal benefits. You can use schema.setPrepare() method for preparing values.\n. I don't see any benefits. You can use:\n``` javascript\n// settigns must be an array\nschema.define('settings', '[lower(10)]');\n// or\nschema.define('settings', 'String');\nschema.setPrepare(function(name, value) {\n    if (name === 'settings')\n        return value.toLowerCase().split(',').trim();\n});\n``\n. This is bad because your functionInvalid Datereturnstrueand it's not a valid date object. My solution returnsfalse` \ud83d\udc4d \nThanks.\n. OK, try this:\njavascript\nvar dt = new Date('BULLSHIT');\nconsole.log(isDate(dt)); // true\nconsole.log(dt); // Invalid Date\n. Definitely not. I have optimized code \ud83d\udcaf \n``` javascript\nfunction oldis(obj) {\n    return (obj && typeof(obj.getTime) === 'function') ? true : false;\n};\nfunction newis(obj) {\n    return ( obj instanceof Date && obj.toString() !== 'Invalid Date' );\n}\nvar dtA = new Date();\nvar dtB = new Date('INVALID');\nconsole.time('old');\nfor (var i = 0; i < 10000000; i++) {\n    oldis(dtA);\n    oldis(dtB);\n}\nconsole.timeEnd('old');\nconsole.time('old');\nfor (var i = 0; i < 10000000; i++) {\n    newis(dtA);\n    newis(dtB);\n}\nconsole.timeEnd('old');\n```\nhtml\nold: 16.002ms\nnew: 3153.651ms\n. Your method is still slowed. But yes this solves all problems with date object:\n``` javascript\nfunction oldis(obj) {\n    return (obj instanceof Date && typeof(obj.getTime) === 'function') ? true : false;\n};\nfunction newis(obj) {\n    return ( obj instanceof Date );\n};\nvar dtA = new Date();\nvar dtB = new Date('INVALID');\nconsole.time('old');\nfor (var i = 0; i < 10000000; i++) {\n    oldis(dtA);\n    oldis(dtB);\n}\nconsole.timeEnd('old');\nconsole.time('new');\nfor (var i = 0; i < 10000000; i++) {\n    newis(dtA);\n    newis(dtB);\n}\nconsole.timeEnd('new');\n```\nI' going to change it, satisfied? \ud83d\udc4d \n. OK done\n- https://github.com/totaljs/framework/blob/v2.0.0/changes.txt#L61\n- https://github.com/totaljs/framework/blob/v2.0.0/utils.js#L1450\nThank you.\n. Hi @docgit, thank you! I have fixed it.\nhttps://github.com/totaljs/framework/blob/v2.4.0/utils.js#L1583\nThank you!. Yes, you're right. I have fixed it.\n. String and then Number. Now it's good:\n``` javascript\nif (typeval === 'string') {\n    if (val)\n        tmp = val.trim().parseDate();\n} else if (typeval === 'number')\n    tmp = new Date(val);\nif (framework_utils.isDate(tmp))\n    tmp = self.$onprepare(property, tmp, undefined, model)\nelse\n    tmp = (defaults ? isUndefined(defaults(property, false, self.name), null) : null);\n``\n. Hi @danielbernalo, my english is bad too, so don't worry (I understand to you). TheU.send()` method has a problem with couting of percentage, because I don't have any information about file size.\nThe stream argument supports 3 types:\n1. string as filename, we can get the file size, but it's a bit complicated to obtain it\n2. stream as ReadableStream and here we can't get the file size (and here is a big problem)\n3. buffer as Buffer and here we have the buffer length\nI have updated the method and now it returns EventEmitter.\n``` javascript\nrequire('total.js');\nvar e = U.send('somefile.txt', '/users/petersirka/desktop/file.txt', 'http://127.0.0.1:8000/', NOOP);\ne.on('data', function(chunk, percentage) {\n    // chunk will be null\n    // percentage will be always 100\n});\n```\nDo you need a percentage? Is it very important for you?\nDownload all files from this branch: https://github.com/totaljs/framework/tree/v2.0.0 and replace total.js directory in node_modules directory.\nThanks!\n. Here you have the method with the progress :-)\n``` javascript\nrequire('total.js');\nvar Http = require('http');\nvar Https = require('https');\nvar Fs = require('fs');\nvar Url = require('url');\nvar Events = require('events');\nfunction send(filename, url, callback, headers, method) {\nvar BOUNDARY = '----totaljs' + Math.random().toString(16).substring(2);\nvar h = {};\n\nif (headers)\n    U.extend(h, headers);\n\nvar name = U.getName(filename);\nvar NEWLINE = '\\r\\n';\n\nh['Cache-Control'] = 'max-age=0';\nh['Content-Type'] = 'multipart/form-data; boundary=' + BOUNDARY;\nh['X-Powered-By'] = 'total.js';\n\nvar uri = Url.parse(url);\nvar options = { protocol: uri.protocol, auth: uri.auth, method: method || 'POST', hostname: uri.hostname, port: uri.port, path: uri.path, agent: false, headers: h };\nvar e = new Events.EventEmitter();\n\nvar response = function(res) {\n    res.body = '';\n    res.on('data', (chunk) => res.body += chunk.toString('utf8'));\n    res.on('end', function() {\n        var self = this;\n        e.emit('end', self.statusCode, self.headers);\n        e.removeAllListeners();\n        e = null;\n        callback(null, self.body, self.statusCode, self.headers);\n    });\n};\n\nFs.lstat(filename, function(err, info) {\n\n    if (err) {\n        // File not found\n        e.removeAllListeners();\n        e = null;\n        callback(err);\n        return;\n    }\n\n    var size = info.size;\n    var connection = options.protocol === 'https:' ? Https : Http;\n    var req = connection.request(options, response);\n\n    req.on('error', function(err) {\n        e.removeAllListeners();\n        e = null;\n        callback(err);\n    });\n\n    var length = 0;\n    var header = NEWLINE + NEWLINE + '--' + BOUNDARY + NEWLINE + 'Content-Disposition: form-data; name=\"File\"; filename=\"' + name + '\"' + NEWLINE + 'Content-Type: ' + U.getContentType(U.getExtension(name)) + NEWLINE + NEWLINE;\n\n    req.write(header);\n\n    var stream = Fs.createReadStream(filename);\n\n    stream.on('data', function(chunk) {\n        length += chunk.length;\n        e.emit('data', chunk, ((length / size) * 100) >> 0);\n    });\n\n    stream.on('end', () => req.end(NEWLINE + NEWLINE + '--' + BOUNDARY + '--'));\n    stream.pipe(req, { end: false });\n});\nreturn e;\n\n};\nvar upload = send('/users/petersirka/desktop/somefile.zip', 'http://127.0.0.1:8000/', (e, r) => console.log(r));\nupload.on('data', function(chunk, percentage) {\n    console.log(percentage);\n});\n```\n. Why not? Great idea.\n. Thank you!\nhttps://github.com/totaljs/framework/blob/v2.0.0/changes.txt#L47\n. Total.js supports:\n``` javascript\nvar today = new Date();\nvar tomorrow = today.add('1 day');\nvar yesterday = today.add('-1 day');\nvar fortnight = today.add('2 weeks');\n```\nRewrite Date.now() method isn't good idea, because this method is used in many scripts. I think that current funcionallity is sufficient. Thanks!\n. I haved added return new Date(this.getTime() + ( type - type%1 )); to Date.add().\nThanks :-)\n. I think that this method has to return the Date object all the time solution 1.\n``` javascript\n// Solution 1:\n// It's easy to create a timestamp\nnew Date().add(30430).getTime();\n// Solution 2:\n// Or this is a complicated way how to get a date, but simple way for getting the timestamp\nnew Date(new Date().add(30430));\n```\nWhat do you mean about it?\n. Yes, I know.\nCookies support string expiration e.g. 2 days and I have to update all modules because they contain older implementation. So I'm going to change it today.\n. Yes, you're right. Your first solution is really great! Thank you! https://github.com/totaljs/framework/blob/v2.0.0/index.js#L9532\n. Great idea but it doesn't work as I need. String(undefined) returns \"undefined\" and this is not a good result. But thanks!\n. Ohh yes, you're right.\njavascript\nglobal.$STRING = function(value) {\n    return value != null ? value.toString() : ''; // is faster than String(value)\n}\nOK I have replaced it.\nThank you! \ud83d\udcaf \ud83d\udc4d \n. My test:\n``` javascript\nglobal.$STRINGA = function(value) {\n  var type = typeof(value);\n    if (value && type[0] !== 'O')\n      return value.toString();\n    return '';\n};\nglobal.$STRINGB = function(value) {\n    return value != null ? value.toString() : '';\n}\nglobal.$STRINGC = function(value) {\n    return value != null ? String(value) : '';\n}\nconsole.time('A');\nfor (var i = 0; i < 10000000; i++) {\n  $STRINGA(undefined)\n  $STRINGA(null)\n  $STRINGA(0)\n  $STRINGA('');\n}\nconsole.timeEnd('A');\nconsole.time('B');\nfor (var i = 0; i < 10000000; i++) {\n  $STRINGB(undefined)\n  $STRINGB(null)\n  $STRINGB(0)\n  $STRINGB('');\n}\nconsole.timeEnd('B');\nconsole.time('C');\nfor (var i = 0; i < 10000000; i++) {\n  $STRINGC(undefined)\n  $STRINGC(null)\n  $STRINGC(0)\n  $STRINGC('');\n}\nconsole.timeEnd('C');\n```\nAvg. results:\nhtml\nA: 122ms\nB: 119ms\nC: 136ms\n. Hi @maxxam11,\nplease try to download the latest beta, I removed some events and the mail library was complete rewrited. Try it according to the documentation below:\nhttp://docs.totaljs.com/latest/en.html#api~FrameworkMail\n. It looks dodgy, but it works correctly. Second question: yes, but property transfers only reference to the F.global. But better solution will be to remove this property from the controller.\n. @aubergine10 removed \ud83d\udc4d \nThank you!\n. Good enhancement.\nI'm going to implement it.\n. I have added it.\nThank you \ud83d\udcaf \n. I don't know about it. What do we do with the rest of them? e.g. ip, xhr, etc.. It's not applicated for all properties, so I suggest to skip this change.\n. Hi\u00a0@aubergine10,\nsorry for dealy and yes, you're. I'll update it. Thanks!\n. @aubergine10 really nice update. Thank you (I and total.js) very much!\n\ud83d\udc4d \n. @aubergine10 if you have a company or your company works with total.js please send me a logo. I'd like to publish it on the website.\n. OK I'll wait :-)\n. Hi,\nno no, it's an older code, I forgot on it. I have removed it.\n. Hi @maxxam11,\nwhich version of total.js do you use? Try latest beta npm install total.js@beta because it's works correctly.\n. The problem has been fixed.\n. We disussed it on Skype :-)\n. Hi @KiPSOFT,\ndid you have json flag in the route?\n. @KiPSOFT this declaration is deprecated. Try this: http://docs.totaljs.com/latest/en.html#api~Framework~framework.websocket\n. Yes, but I have to wait for a new version. I hope that next week I'll publish it.\nSorry and thanks!\n. Hi @KrzysztofWilczek,\nyes I understand. For this case total.js supports configs directory, read here http://docs.totaljs.com/latest/en.html#pages~Directory%20structure\n. Ohh I forgot on the enviroment, sorry.\nThen you can use F.useConfig() method, creates some definition file and according to the enviroment set the config file. http://docs.totaljs.com/latest/en.html#api~Framework~framework.useConfig\n. I have tested F.useConfig() on OSX + Windows and everything works correctly.\n@karolgorecki can you test it with the latest beta version? npm install total.js@beta\nconfigs directory is read by fs.readdirSync and I think that this method sorts the files.\n. @karolgorecki thanks, I have fixed it on GitHub branch v2.\nI have looked into the source-code and the framework reads config files like this:\nhtml\n/configs/config-file1\n/configs/config-file2\n/configs/config-file3\n/config\n/config-debug\nSimple solution, create a definition:\njavascript\n// your-app/enviroments/\nvar path = F.path.root('enviroments');\nU.ls(path, function(directories, files) {\n    // files without extension are considered as directories\n    // your conditions put here:\n    directories.forEach(filename => F.useConfig('~' + directories[0]));\n});\n. Hi @kinglo,\nsorry for my opinion, but TypeScript is really useless. I don't see any benefits of it (same as CoffeScript, etc.). I like simple solutions with common sense \ud83d\udc4d and total.js is about that.\nSo I don't see any support for TS now. Who wants to use TS then can use ASP.NET MVC.\nThanks!\n. Hi, yes, but read this:\nhttp://maxprog.net.pl/node-js/total-js-angular2-typescript/. I don't belive TS (sorry, it's my opinion) - really I don't need it, but I agree that TS can be helpful for a lot of developers. It's like a sado sex, a few people practices it \ud83d\udc4d . @teddis I agree with valuable of TS, but I (personally) don't need it. Everyone can use TypeScript/Dart/CoffeeScript/Etc. but I don't have any support for it. Nothing more.. Hi @dacrhu\nI don't see totaljs --translate command:\nbash\ncd yourapp\ntotaljs --translate\nI'm waiting for a feedback.\nPS:  try to use total.js 2.0? npm install -g total.js@beta\n. Hmm.... Do your views contain the localization markup <h1>@(TEXT)</h1>? \n. Sorry for additional job (I think that you will update your project), but this markup is very important for localization mechanism.\nAll the best!\n. @gevMgevorgyan and where is the problem?. total --translate creates a resource file with text for localize. So then you need to translate the resource file and store it in /resources/arm.resource. Then you need to set F.onLocale delegate. More info in documentation.\n\nDocumentation\nExample. Hi @liaosankai,\nDoes self.query.keyword contain a string value?\n. OK, so try it:\n\njavascript\nself.query.keyword && builder.search('title', self.query.keyword);\nbuilder.callback(function(err, response) {\nThanks!\n. I fixed this bug here https://github.com/totaljs/framework/blob/v2.0.1/\nThanks!\n. PS: npm install total.js@beta\n. Hi @adrianrey05,\nit works correcly. The option etag-version updates etag about etag-version value. I have tested it now: \n\nThis behaviour works in release mode. If you want to release cache then decrease this property https://docs.totaljs.com/latest/en.html#api~FrameworkConfiguration~default-response-maxage or use versions https://docs.totaljs.com/latest/en.html#pages~File%3A%20versions (I use versions for my projects too).\nThank you!\n. :-D\n. I recommend to use versions instead of changing of ETag because caching depends on browsers.\n\nversions https://docs.totaljs.com/latest/en.html#pages~File%3A%20versions\nor you can create own File route without caching. You can use versions or you can add a timestamp to each URL .... but this solution can decrease a HTTP performance.\n\nYou need to know that browser doesn't respect Etag value.  Browser caches files according to the URL. So the best way is to change a name of URL when you change a file. For e.g. from logo.png to logo2.png.. @ameykshirsagar this is not possible what you want. Maybe we can add a new option for it, but this is not good solution. Thanks!\n. Your idea is not possible for the current state, but we can add e.g. exports.namespace=\"mycode\" and the framework registers this namespace as a global variable for both sides (server/client). This is possible.\n. I have looked into it and it's very hard to add it. The isomorphic variable is initialized before the framework is loaded and according this variable is created a mapping. I wonder that this is not good idea and I tought that the implemetation will be more simple. I hope that you have a solution for it now.\nSorry \ud83d\udc4e \n. Hi, thank you.\nI have fixed it. Please test it npm install total.js@beta.\n. Ho do you use roles? I found a problem in roles before few weeks ago.\n\nCan you create a small example for me? Inpsire by these example authorization-roles or routing-flags-roles. Send me it on my email.\n. Thank you, I'm going to test it.\n. Try to update the route like this:\njavascript\nF.route('/usersfiles', users_files, ['@admin', 'authorize']);\nauthorize flag is very important for it. Give me a feedback. Thank you.\n. Yes, I'll add it into the documentation.\nThank you!\n. Hi @maxxam11,\nyes, you right --> I fixed it some time ago https://github.com/totaljs/framework/tree/v2.0.2. You can use latest stable beta npm install total.js@beta.\nThank you!\n. Hi @maxxam11,\nyes, I have updated it because of performance. It's a problem for you?\n. You can use this:\njavascript\nif (cache != null)\n    console.log('is not null and not undefined');\nThank you \ud83d\udc4d \n. Hi @KiPSOFT,\nfunc/ word is missing in the route URL:\nplain\nhttp://crms.link/func/crm/medya/dosyaYukle\n                     /crm/medya/dosyaYukle\nThank you.\nPS: remove post flag, is useless.\n. I understand but HTTP protocol sends a full relative url address, so Total.js sees:\n/func/crm/medya/dosyaYukle\nTry to create route with func or update configlike this:\nhtml\ndefault-root      : /func/\nhttps://docs.totaljs.com/latest/en.html#api~FrameworkConfiguration~default-root\n. only I assume ... Try it and give me a feedback.\n. I have to look into the code or can you create a small example?\n. Can I see a full declaration of a route?\n. @KiPSOFT sorry for delay. Please try to remove authorization, does it work? Are you sure that the request is directed correctly into the route? I mean on a problem with the Apache... Thank you.\n. @metalvexis how do you run this app? I mean: which command did you use in command-line?\nThank you.\n. Hmmm, it's really interesting. Try to install latest version of Node.js +4. I use macOS only so if you find a problem, contact me.\n. Hi @maxxam11,\nyes, cache is a simple object which stores values and references directly. You can handle the problem with clone as  you wrote, but implementation of it as a default behaviour is not a good way - because of performance.\nThank you.\n. Hi @harry-stot,\nthank you very much.\n- String.encode() is better my implementation\n- String.decode() --> what is this? and what does it do? https://github.com/totaljs/framework/pull/435/commits/4146c88e308588d9f01d4ea1c1a204148a3683e9#diff-14ef994fa167d355bdaf9b44add54b87R2999\nThank you.\n. I have added your code for String.decode, thank you!\nhttps://github.com/totaljs/framework/commit/0f60c1f8dc143f655a9422ee370eeb4838ff1acc\n. Hi @ameykshirsagar,\nTotal.js supports text/cache-manifest, here is a simple example https://github.com/totaljs/examples/tree/master/html-appcache-offline. Give me a feedback.\nThank you.\n. Hi @adrianrey05,\ncan I see generated code?\n. I understand, this code is generated for SQL Agent module. Currently AppDesigner doesn't support NoSQL embedded database exporting, but I'll add it to my todo list.\nSorry and thank you.\nPS: update your Total.js version \ud83d\udc4d current v2.1.0.\n. Hi @mnicolas80,\nif you want to use configuration then you have to load a framework in a worker:\njavascript\n// Loads the framework without HTTP server\nF.load('debug', ['config'], '../');\nconsole.log(CONFIG('weather-api')); // it works! :-)\n. Any news?\n. Which version of Total.js do use? ... and which OS?\n. Can you send me example?\n. HI @mnicolas80, please try to use my example:\nhttps://www.dropbox.com/s/xp6ud6ffovgmxwa/workers.zip\nThank you.\nBTW: process.send() has a limit for data length.\n. @mnicolas80 I have updated example. Thank you!\n. Hi @adrianrey05,\njavascript\nObject.keys(F.connections).forEach(function(id) {\n    var controller = F.connections[id];\n    controller.send({ yes: true });\n});\nor you have to know a path:\n- https://docs.totaljs.com/latest/en.html#api~Framework~framework.findConnections\n- https://docs.totaljs.com/latest/en.html#api~Framework~framework.findConnection\nThank you\n. Sorry, but I don't see any benefits of this method. It's useless for most projects. I recommend to create a module with same functionality.\nThank you!\n. @binarygeotech I appreciate it. I want fit framework and advanced mapping (according to me) is useless. A module is good way for it.\nThank you!\n. Hi @adrianrey05,\nI have tested WebSocket and everything works correctly. Can you create a small full example with this problem? Please send me it on my email. Thank you!\n. So does it work or no?\nHow can I simulate it? Your example doesn't work.\n. Hi @jack0088,\n- Here is a simple tutorial https://docs.totaljs.com/latest/en.html#pages~Tutorial\n- 100+ examples https://github.com/totaljs/examples\n- Source-code: Total.js BlogEngine https://github.com/totaljs/blogengine\n- Source-code: Total.js Eshop https://github.com/totaljs/eshop\n- Source-code: Total.js CMS https://github.com/totaljs/cms\n- Source-code: Total.js HelpDesk https://github.com/totaljs/helpdesk\n\nPS: We want to create a better tutorial for learning.\nThank you!\n. @hepr thank you!\n. Install Total.js locally, there is a Node.js problem with finding framework files.\nhttps://nodejs.org/dist/latest-v6.x/docs/api/modules.html#modules_loading_from_node_modules_folders\nbash\n$ cd server-sent-events\n$ npm install total.js\n$ node index.js\nThank you!\n. Thank you, you're right. I'll add it into the docs.\n. Hi @hepr, thank you ... I'll look into it today.\n. @hepr I have fixed it. Please try latest beta version npm install total.js@beta.\nI test it on my server.\nThank you!\n. Hi @harry-stot, this method is primary targeted for decoding basic HTML characters like <, >, &, ', \" and other chars like \u00e9, \u00e1, \u00fd, \u017e, \u010d, \u013e, \u00ed, etc. are useless for decoding, why? Look here http://www.thesauruslex.com/typo/eng/enghtml.htm --> yes we can extend decoding class.\nWhy do you need to decode these chars? If you use UTF8 document encoding then you don't have any problem with any charset. So therefore I don't understand why do you want to decode all chars. I have more than 80 projects and I didn't need this functionality.\n. @harry-stot what do you think about it?\n. HI @ameykshirsagar, of course:\n- controller https://github.com/totaljs/examples/blob/master/framework-install-controller/index.js\n- model (with e.g. Schema) https://github.com/totaljs/examples/blob/master/framework-install-model/index.js\nThank you.\n. Thank you! I have fixed it in a new branch.\n. Hi @adrianrey05,\nmy mistake. I have fixed it. Thank you!\n. Hi @Athuli7,\nthere was a bug. I have fixed it.\nSolution:\nYou have to replace @{foreach i ... for e.g. @{foreach m .... The problem is in i variable (newest version will contain my fix).\n. Hi @Athuli7,\n- which version of Total.js do you use?\n- do you use debug mode?\n. Can I see the view?\n. It's not good idea to use repository.data.advocate[repository.entity] ... Why don't you prepare data before rendering?\n``` javascript\nvar repository = self.repository;\nvar model = repository.data && repository.data.advocate && repository.data.advocate[repository.entity];\nif (!model)\n    return self.throw404();\nself.view('advocate_details', model);\n```\nI found a bug in the view engine compiler. I'm going to fix it.\n. I have fixed it. Try it: npm install total.js@beta (don't worry and it's stable - maybe next week will be a new version).\nThank you!\n. Beta still contains latest dev branch and this beta is stable (yet). \ud83d\udc4d \n. Hi @hepr,\nit works correctly. You have to convert text via terminal/command-line $ totaljs --translate command in your app directory.\n```html\n// TRANSLATE('fr', 'Dashboard')     --> returns Dashboard\n// TRANSLATOR('fr', '@(Dashboard)') --> returns Dashboard\nT956107380        : Dashboard\n// RESOURCE('Dashboard') --> returns Dashboard\nDashboard         : Dashboard\n```\nTRANSLATE() - converts text to hash\nTRANSLATOR() - converts @() text to hash\n\nWhy hashing? Saves CPU and memory consumption.\nThank you!\n. Hi @Humsas,\ntry to use latest beta version npm install total.js@beta and give me a feedback.\nU.isNullOrEmpty has been removed because it's useless you can use if (str) { console.log('is not null and not empty'); }. I'll remove it from docs, thank you! I forgot on it.. I know where is the problem, show me your action in a controller. Thank you.. Otherwise:\n\nif you respond via controller.view() or controller.json() then the controller removes all uploaded files\nyou have to call controller.noClear() and when an image is processed you have to call controller.clear() or req.clear(), example:\n\njavascript\n...\nself.noClear();\nvar stream = fs.createWriteStream(filename);\nimage.pipe(stream);\nCLEANUP(stream, function() {\n    self.clear();\n});\n...\nOR\njavascript\n...\nvar stream = fs.createWriteStream(filename);\nimage.pipe(stream);\nCLEANUP(stream, function() {\n    self.json({ success: true });\n    // or\n    // self.view('success');\n});\n...\nIf you upload multiple files then you can use .wait() prototype in Array\njavascript\n...\nself.files.wait(function(file, next) {\n    if (file.isImage()) \n        file.quality(90).output('jpg').save('yourfilename', next);\n    else\n        next();\n}, () => self.json({ success: true }));\n.... Then you have to create the whole example for me.\nI'll test it ASAP.. Hi @mmautomatizacion,\nif you want to use socket.io then:\nInstructions:\n1. disable Total.js WebSocket in Total.js config: allow-websocket   : false\n2. then bind socket.io in some definition file: var io = require('socket.io')(F.server);\n\nAd your problem, try to remove events before you attach new events.\njavascript\nsocket.removeAllListeners('connection', ...);\nsocket.on('connection', ...);\nThank you.. Great! Thank you.. Hi @martinjirku,\nyes. JS minificator doesn't analyse the code, only compresses it. It will be too complicated. You can change it:\nhttps://github.com/totaljs/examples/tree/master/external-compile-uglifyjs\n:-( sorry.\n. Hi @yexing,\ncan you show me a full error message? ... and can you show me your code to call a DB?\nThank you very much!. Thank you a lot!\nI have fixed it and I have published a new beta version npm install total.js@beta.. HI @maxxam11,\nit's correct. The capitalize method is primary targeted on names.\nBut I can add an argument e.g. onlyFirst, example 'first second'.capitalize(true). . Please download source-code from GitHub (and replace all files in node_modules/total.js):\nhttps://github.com/totaljs/framework/tree/v2.4.0\nThank you!. @lazaridis-com you can contact us on info@totaljs.com or via Total.js Gitter (private chat) or here if you have some suggestions.\nThank you!. Hi @ameykshirsagar,\nyes:\n```javascript\nObject.keys(F.workers).forEach(function(key) {\n    var worker = F.workers[key];\n    // e.g.\n    worker.kill();\n});\nThank you.. Hi @stakost,\netag-version changes etag but I think that you have a problem with browser cache, right? I recommend to use versions feature for changing filenames - https://docs.totaljs.com/latest/en.html#pages~File%3A%20versions.\nLast-modified header works same than etag. There is a problem in browser cache.\nGive me a feedback.\n. Yes, because etag-version is always other. I recommend change etag-version in your config files. I'll try to add a real last-modified date to files into a new Total.js version (I'll give you a feedback when I publish a new beta).\nThank you!. I have looked into it and it's a bit complicated. I have to think about it because I have to rewrite a main method for creating requests (it isn't complicated for http request, but https requests are harder). I don't know now whether proxies will be implemented in the newest version or in next version.\nI'll give you a feedback.. I recommend to use request module now but here is the method which performs requests:\nhttps://github.com/totaljs/framework/blob/v2.4.0/utils.js#L410. I won't implement proxy in near time. It's complicated for the current state.. Hi @Humsas,\nyes you're right. I have fixed it. I hope that new version will be next week.\nhttps://github.com/totaljs/framework/tree/v2.4.0. Hi @neonnds,\nI have fixed that example. Please download it again.\nhttps://github.com/totaljs/examples/blob/master/external-compile-sass/definitions/sass.js#L10\nThank you!. Please format code on GitHub...\nAlways send data as JSON, that's my recommendation.\nTotal.js uses a standard deserializer:\nhttps://nodejs.org/dist/latest-v6.x/docs/api/querystring.html#querystring_querystring_parse_str_sep_eq_options\nYou can rewrite it:\nhttps://docs.totaljs.com/latest/en.html#api~Framework~framework.onParseQuery\n. Hi @li0nsar3c00l,\nthis is not a bug, as documentation says that search value has to be string - no other.\nhttps://docs.totaljs.com/latest/en.html#api~DatabaseBuilder~builder.search\nConverting values cost CPU.. You can find numbers via builder.where() or builder.between() or save it as string ... I create search property for each document, this is my recommendation :-). Yes, I agree - but I have a zero budget for all, so I do what I can.... I improve docs continuously.\nHere is a real usage:\nhttps://github.com/totaljs/eshop/blob/master/models/products.js#L38\nhttps://github.com/totaljs/blogengine/blob/master/models/blogs.js#L36. Hi,\nI'm going to check it.. I have tested it and everything works correctly. Which browser did yo use?\nChrome:\n- writes status 200, but the file is read from cache\n\nFirefox:\n- shows status correctly\n\n\nI used cluster with 4 instances and I tried several requests together.\nThank you!. No problem! Thank you.. New version doesn't use etag for comparing etags by default (but the server sends it), it uses Last-modified date only. I think where can be that problem.. This is not possible, you have to change the file only (you have to perform touch file). Where is the problem here? Framework uses a real modification file date as Last-modified date.. I cannot use the model passed to the partial view in javascript directly.\nHow do you mean it?\nThis works:\nhtml\n<script>\n@{if model.alert}\n     alert('@{model.alertmessage}');\n@{fi}\n</script>\nBut I recommend:\n```html\n@{json(model, 'modeldata')}\n\n    var model = JSON.parse(document.getElementById('modeldata').innerHTML);\n    console.log(model);\n\n.javascript\n\nvar x = '@{model.alertmessage}';</p>\n<p>// or\n// but alertmessage has to contain apostrophes/quotes\nvar x = @{!model.alertmessage};\n\n``. For future questions you can use __Total.js messenger__ (it's faster):\n<https://messenger.totaljs.com>. Hi @s2dent, why do you need it?. Is there any news?. I recommend to userdebugmode for this case or you can decrease the cache for 1 minute (config):\n-default-interval-clear-cache   : 1(each minute).. I assume that you store views from e.g. DB on HDD, right?. For this case can use:\nhttps://docs.totaljs.com/latest/en.html#api~FrameworkController~controller.viewCompile. No problem.. Hi @shide1989,\nshit, thank you. I have published a new beta version:$ npm install total.js@beta` (it's stable)\n1000x thank you!. Hi @binarygeotech, thank you very much. I use a new branch 2.5.0 and I have fixed it there.\nhttps://github.com/totaljs/framework/blob/v2.5.0/changes.txt#L22\n100x thank you!. Hi @ckpiggy,\nthere is no difference. It's about words. I prefer workflows than operations.. Try to register CORS via:\njavascript\nF.cors('/location/', ['GET', 'POST', 'PUT', 'DELETE']);\nDocs: https://docs.totaljs.com/latest/en.html#api~Framework~F.cors\nAnd give me a feedback :-). Don't use F.cors() and F.route(..['cors'])...\nTry again:\njavascript\n// missing *\nF.cors('/location/*', ['GET', 'POST', 'PUT', 'DELETE']);. I have to test it.\nThank you!. Thank you! I have fixed it.\nhttps://github.com/totaljs/framework/blob/v2.5.0/changes.txt#L30. I'll check it.. @harry-stot I have fixed it. Please try to download it from GitHub or NPM: npm install total.js@beta. Give me a feedback.\n100x thank you for this report.. Hi @ivanlunardi,\nit works correctly:\n```javascript\nrequire('total.js');\nRESTBuilder.make(function(builder) {\n    builder.url('http://getstatuscode.com/403');\n    builder.exec(function(err, data, response) {\n        console.log(response.status);\n    });\n});\n```\nDo you have some example?. Any news?. Error contains only network errors (timeout/bad hostname/etc). I have to update docs about this info.. Hi, sorry - my bad. I have fixed it. Please test it again.. Do you use it from URL?. This is OK, but my question is: How did you install this module?. So you can't have the same problem because I fixed it:\nhttps://github.com/totaljs/modules/blob/master/Miscellaneous/flash/flash.js#L84. Hi @Humsas,\nyou're right. I have fixed it.\nPlease download it from:\nhttps://github.com/totaljs/framework/tree/v2.5.0\n. Hi @lyquocnam,\nhow do you mean it? Here is a simple info about Total.js sitemap file: https://docs.totaljs.com/latest/en.html#pages~File%3A%20sitemap\nThank you!. Hi @s2dent, I have fixed it. Please test it $ npm install total.js@beta.\nThank you!. Hi @ameykshirsagar.\nYes. It's very complicated to describe it but I'll try to find a solution for it tomorrow, OK?. I have added it as a new option in configuration file.\nhtml\n// A default value\ndefault-errorbuilder-status    : 200\nor you can change it manually:\njavascript\nerror_builder_instance.status = 400;\nYou can test it now npm install total.js@beta.\nThank you!. Hi @hbakhtiyor,\n- https://docs.totaljs.com/latest/en.html#api~FrameworkConfiguration~allow-head\n- or F.route('/', YOUR_ACTION, ['head'])\nThank you!. Hi @harry-wood, thank you very much. Can I add you a login to totaljs.com homepage? You can edit text directly and I'll be very happy!\nPlease write me email: petersirka@gmail.com\nThank you. No problem, thank you! I'll update it today.. Hi @destan, yes this is my check because some users have nullable values in some required fields. Then I can't synchronized same accounts from different social networks. So email address is an OAuth 2.0 identificator for me.. Hmmm, I have enabled logging. Try to login again. I'm curious.. @nikhilknoldus Thank you. I know .. but Github doesn't send email field. I have tested it on my profile and GitHub returns my profile with email address. I don't want to enable profiles with no email.\nThank you!. Hi. Framework doesn't have implemented promises. Can you write me where do you want to implement them?. Promises are slow but I understand that in some situations can improve readability of the code. I recommend to use Total.js Schemas.\njavascript\nfunction some_action_in_controller() {\n   var self = this;\n   NOSQL('products').find().where('year', 2017).callback(self.callback('viewname'));\n   // @{model} in will contain array of all produts from Database\n   // when DB returns an error then controller's returns 500\n}\nDocumentation: https://docs.totaljs.com/latest/en.html#api~FrameworkController~controller.callback\nSchemas:\n\ndb https://github.com/totaljs/eshop/blob/master/models/products.js#L21\ncontroller https://github.com/totaljs/eshop/blob/master/controllers/api.js#L65. For downloading data from another website you can use RESTBuilder or U.request() or U.download().\n\nThen I recommend to use Schemas again because it supports chaining (example).\nOther solutions for multiple async operations in a row:\n- Array.async() https://docs.totaljs.com/latest/en.html#api~Array.prototype~Array.prototype.async\n- Array.wait() https://docs.totaljs.com/latest/en.html#api~Array.prototype~Array.prototype.wait\n. @ajimix what is your controller name?. All views are loaded according controller name.\ncontrollers/test.js:\n```javascript\nexports.install = function() {\n    F.route('/test/', view);\n};\nfunction view() {\n    // is routed to \"/views/test/index.html\" (all controllers with except \"default\" controller\n    // if the file doens't exist then it finds same view in parent directory\n    this.view('index');\n}\n```\ncontrollers/default.js:\n```javascript\nexports.install = function() {\n    F.route('/', view);\n};\nfunction view() {\n    // is routed to \"/views/index.html\"\n    this.view('index');\n}\n```\nI have tested it now and everything works correctly. Which OS do you use? Do you have TeamViewer? I can connect to you via TeamViewer - if you agree write me on https://messenger.totaljs.com\nThank you!. Here is a note:\nhttps://docs.totaljs.com/latest/en.html#pages~View%20engine~(defining-views-in-sub-directories)\nBut yes, I have to improve it in docs.. Hi @ckpiggy,\nI'll test it today.\nThank you!. There is a bug. I'll fix it today.. Hi, I have fixed it. New version will work correctly.\nTemporary fix for the current version:\njavascript\nF.route('/api/test', test_json, ['post', 'json', '*Content#*Create'])\nThank you!. BTW: I have published a new beta version $\u00a0npm install total.js@beta (it should be stable :-D). Hi\u00a0@dima1034,\njavascript\nF.on('ready', function() {\n    F.server.on('connection', function(socket) {\n        socket.setKeepAlive(true, 10);\n    });\n});\nDocumentation:\nhttps://nodejs.org/dist/latest-v7.x/docs/api/net.html#net_socket_setkeepalive_enable_initialdelay\nThank you!. I think that it is about the socket. \n\nhttp://stackoverflow.com/questions/12651466/how-to-set-the-http-keep-alive-timeout-in-a-nodejs-server\nI'll perform some tests\n\n. So socket.setKeepAlive() is the only one way how to set keep-live connection. I didn't find another solution for it. As I wrote --> Total.js uses Node.js built-in http server.\nThank you!. @subbu05 which eshop? Premium or classic? Which version of Total.js + Eshop do you use?. @subbu05 I have tested it and everything works correctly. I have latest version from https://my.totaljs.com. Historically was a some similar bug in the eshop.\nPlease try to download latest version from my.totaljs.com and give me a feedback.\nThank you!. Hi @ChukkChukk, yes ... Sometimes GitHub doesn't send email address and this is the problem. Are you sure you have public your email address?\nThank you!. @ckpiggy I'll look into it this week. It's out of my scope but I'll try to solve it.\nThank you.. @ckpiggy next.js has been a bit changed, I looked into it but I didn't have more free time for it up to now.. I have solved this problem here:\nhttps://github.com/totaljs/framework/issues/515. Hi @frunjik,\nthank you very much and thank you for your typos. I have a request for you :-D can you create a pull request on branch v2.6.0? There is a new version and I'll publish it this week (I belive).\nThank you very much again!. BTW: I can perform your change if you don't have time.\n\ud83d\udcaf thank you. Thank you!. @hessel does it work?. Can I debug it from my Mac? What do I need for it?. @BlueMagnificent thank you very much! You saved me a lot of time. I'll add it into the documentation.\n@hessel thank you too and yes, I'll add it.\nThank you!. Hi @camilohaze,\nI have tested it and everything works correctly:\n```javascript\nvar users = NOSQL('users').find();\nusers.join('address', 'address').where('iduser', 'id').first();\nusers.join('tags', 'tags').where('iduser', 'id');\nusers.callback(function(err, response) {\n     console.log(response);\n});\n```\nusers.nosql:\njson\n{\"id\":1,\"name\":\"Peter\"}\n{\"id\":2,\"name\":\"Lucia\"}\n{\"id\":3,\"name\":\"Igor\"}\n{\"id\":4,\"name\":\"Jozef\"}\n{\"id\":5,\"name\":\"Anna\"}\naddress.nosql:\njson\n{\"iduser\":1,\"name\":\"Bratislava\"}\n{\"iduser\":3,\"name\":\"Kosice\"}\n{\"iduser\":5,\"name\":\"Zvolen\"}\ntags.nosql:\njson\n{\"iduser\":1,\"name\":\"Node.js\"}\n{\"iduser\":1,\"name\":\"JavaScript\"}\n{\"iduser\":1,\"name\":\"Total.js\"}\nResults:\njson\n{\"id\":1,\"name\":\"Peter\",\"address\":{\"iduser\":1,\"name\":\"Bratislava\"},\"tags\":[{\"iduser\":1,\"name\":\"Node.js\"},{\"iduser\":1,\"name\":\"JavaScript\"},{\"iduser\":1,\"name\":\"Total.js\"}]}\n{\"id\":2,\"name\":\"Lucia\",\"tags\":[]}\n{\"id\":3,\"name\":\"Igor\",\"address\":{\"iduser\":3,\"name\":\"Kosice\"},\"tags\":[]}\n{\"id\":4,\"name\":\"Jozef\",\"tags\":[]}\n{\"id\":5,\"name\":\"Anna\",\"address\":{\"iduser\":5,\"name\":\"Zvolen\"},\"tags\":[]}. I have fixed it.\nPlease download https://github.com/totaljs/framework/blob/v2.6.0/nosql.js and replace it in your /node_modules/total.js/.\nThank you!\nPS: Give me a feedback.. Great! Thank you!. Hi @rosbm,\nI'll test it today.. @rosbm which .send() method do you use?. :-D Which? Mail.send() or message.send()? Can you send me a line of your code with .send() method?. You have a problem with mail.on('error'), right? I thought that you mean a callback. I'm going to test it.. Better is to use send with callback. I'll test error within sending and everything works correctly. I will need more info for debugging.. Yes and my personal and fake server (there was a timeout error). Can you send me on my email your SMTP server? You don't have to send credentials.. Hi @rosbm, I have tested error event and everything works correctly. I can simulate it as you write. Please try to update Total.js version to latest version.\nThank you!. Any news?. Hi @adrianrey05,\nplease try to install Total.js again as a global module $\u00a0npm install -g total.js. You have older version. Give me a feedback.. Hmmm, latest version is 2.6.2:\nhttps://www.npmjs.com/package/total.js\n\nWhich version of Node.js have you got?. It's very interesting. Try to install $ npm install -g total.js@2.6.2.. Theoretically:\nInitialization:\n```javascript\nrequire('total.js').http('debug');\nconst nuxt = new Nuxt(config)\nF.middleware('nuxt', nuxt.render);\n```\nRoutes:\n```javascript\nF.route('/api/', action, ['nuxt']);\n// Or register nuxt middleware for all requests\n// F.use('nuxt');\n``. Can you send me your app (example) on my email withoutnode_modules? I have to test it.. - please install total.js betanpm install total.js@beta`\n- run it again :-)\nThank you!. BTW: code of nuxt with another dependencies is a big hidden shit.. \ud83e\udd47 \ud83d\udc4d  \ud83d\udcaf Nuxt uses res.send(BUFFER) for static files and Total.js expected res.send(code, body, [contentype]). So I have updated res.send().. Hi @ckpiggy, yes --> there was a bug. I have fixed it.\nPlease download total.js from GitHub https://github.com/totaljs/framework/tree/v2.6.3 and replace all files in node_modules/total.js/ directory.\nThank you very much for your report!. Hi @ckpiggy, RegExp can be used only for dynamic parameters.\njavascript\nF.route('/api/{/\\d+/}/', action);\nBut you have to use a route with function:\njavascript\nvar reg = /^(?!/api)[/A-Za-z0-9]*$/;\nF.route(url => reg.test(url), action);\nThank you and give me a feedback!. About Nuxt.js read here:\nhttps://github.com/totaljs/framework/issues/515. Hi @ckpiggy,\nwhere did you find this implementation of Total.js HTTPS? I'll fix it.\nTry this:\njavascript\nconst fs = require('fs')\nconst path = require('path')\nconst https = require('https')\nconst options = {}\noptons.https = {};\noptons.https.key = fs.readFileSync(path.join( __dirname, '/certs', 'server.key'))\noptons.https.cert = fs.readFileSync(path.join( __dirname, '/certs', 'server.crt'))\nrequire('total.js').https('release',options)\nThank you!\nBTW: I recommend to use NGINX as reverse proxy with HTTP/2\n. No problem.. Hi @ivanlunardi, can you send me an example on my email?. Hi @ckpiggy,\n```javascript\nfunction file_test (req, res) {\n    const filename = path.basename(req.url)\n    const filepath = path.join('3d', filename)\n// This is the problem because \"this\" is not a context of controller\n// Filehandler needs to use methods in \"res\" object\n// BAD: this.file(filepath)\nres.file(filepath);\n\n}\n``\nI'll try to fix error message.. Hi @mjiricka,\nthe problem is bigger than I thought. I'll give you feedback today.. Hi @mjiricka,\nplease try to use <https://github.com/totaljs/framework/tree/v2.8.0>. I have improved SMTP sender.. Read here:\n<https://docs.totaljs.com/latest/en.html#pages~Troubleshooting~(hosting-total-js-applications-in-iis-on-windows)>. @trsh you can use relative path like thisrequire('../../../xx.js'). Therefore the framework has a simple structure.. @ckpiggyinstallmethod is evaluated immediately, it can't be async. Aboutasync, sure I will think about its implemention into the framework, but it's too early. Backward compatibility is very important for my. not all developers use v8 node.. I don't see any sense for implementation of promises toinstallmethod. The framework executesinstall` immediately and in order synchronously.\n```javascript\nexports.install = function(options) {\n    mongo.connect(url).then(function (db) {   \n        console.log('did connect to db ' + url)\n        F.database = function (collection) {\n            return collection ? db.collection(collection) : db\n        };\n    // Just you need to emit an event if the DB is ready\n    EMIT('database', db);\n});\n\n};\n```\nOther dependencies:\njavascript\nON('database', function(db) {\n    console.log('DB IS READY');\n});\n. bash\n$\u00a0cd framework/test\n$\u00a0bash run.sh\nThank you!. This tests download some content from Total.js website, are you sure you have stable internet connection?. run.sh is prepared for Travis, I need to test it on Travis. It's a bit complicated.. Thank you. We can use node 6.11 in travis, can you update it?. Thank you!. Good job!. Hi D\u00e1vid,\nI have fixed it, please install latest beta version of Total.js from NPM:\n\n$ sudo npm install -g total.js@beta\n\nThank you!. Does it work?. Great! Thank you!. No, controller.body will work within DELETE method too, browser sends data in body.. I understand. My english is bad too, I'm going to fix it.\nThank you. I have removed it. Thank you!\nBTW: documentation is waiting for a new version of Total.js.. Hi @raythree,\nI forgot to update documentation. F.test() is deprecated now, don't use it. Here is a simple solution for your needs:\n```javascript\nON('test-begin', function() {\n     console.log('begin');\n});\nON('test-end', function() {\n     console.log('end');\n});\n```\nAnd thank you for your compliments, I appreciate it.. Where did you place this event?\nI have tested it here and everything works correctly:\nhttps://github.com/totaljs/examples/tree/master/assertion-testing\nStart script:\n```javascript\nrequire('total.js').http('test');\nON('test-end', function() {\n     console.log('DONE');\n});\n``. Are you sure you don't useF.test()`? Try my example:\nassertion-testing.zip\n. No problem. I'll fix docs.\nThank you!. I found a problem in your test script:\njavascript\nTEST('Test model schema', function () {\n  let m = new MyModel( {\n    name: 'bill'\n  });  \n  m.validate((err) => {\n    // uuid required\n    FAIL(err === null) // HERE --> here this test ends\n    m.uuid = U.GUID(24);\n    m.validate((err) => {\n      OK(err === null) // --> and this is the problematic part, for this you need  anew TEST()\n    });\n  });\n});\n\nTEST() expects the only one result FAIL() or OK() or multiple calls in a row immediately\n\nSolution:\n```javascript\nTEST('Test model schema', function () {\n  let m = new MyModel( {\n    name: 'bill'\n  });\n  m.validate((err) => {\n    // uuid required\n    FAIL(err === null);\n    m.uuid = U.GUID(24);\nTEST('Validate schema', function () {\n    m.validate((err) => {\n        OK(err === null)\n    });\n });\n\n});\n});\n``. You do not have to useF.restful2(). UseF.restful()- but it doesn't supportpatch` ... or create your own routes directly:\njavascript\nF.route('/users/',              action_query]);\nF.route('/users/{id}/',         action_read]);\nF.route('/users/',              action_create,  ['post']);\nF.route('/users/{id}/',         action_update,  ['put']);\nF.route('/users/{id}/{field}/', action_patch,   ['patch']);\nF.route('/users/{id}',          action_remove,  ['delete']);\nF.restfull() creates same code on background.\nBTW: I prefer sending of smaller documents less than 1 kB, in other words I don't use PATCH method \ud83d\udc4d . F.restful() won't be deprecated, I don't plan it so yet. BTW: you can extend F instance by adding method e.g. restful3() with your needs.. Hi @raythree,\nthe framework doesn't use schema directory, but I can update debug.js by adding a new directory for watching. Which directory do you want to watch?. Jo @raythree,\nI have added it. You can test it: $ npm install total.js@beta. Please be careful because I have improved NoSQL embedded counter and it's backwards incompatible (it will convert older files to a new version), but it works perfectly.\nThank you!. That's true. It needs to be called because you can have this case:\njavascript\nF.route('/', home_auth, ['authorize']);\nF.route('/', home_unauth, ['unauthorize']);\n// or\nF.route('/contact/', contact_both); // for auth/unauth\n// or\nF.route('/terms/', terms_auth, ['authorize']);\nF.route('/terms/', terms_all);\nFramework needs to know whether the request is authorized or no. So therefore is called every request.. Hi @dacrhu,\nat can't be in URL address because it's a part of it. @ is used for basic auth e.g. http://name:password@totaljs.com. The second problem is that email address contains . (dot) and Total.js recognizes dot in the URL address as a static file. \n\ndon't use email address as an identificator in URL\nyou can replace charts to e.g. @ --> -- and . --> __ and the conversion on the server-side will be simple:dacr--dacr__hu\nI recommend to use as identificators only fixed numbers and strings without diacritics\n\nThank you!. Hi @raythree,\ncan you send me an example with /static directory and this configuration? I'll test it.\nThank you!. I found a problem. Your CSS and JS is re-compressed again via Total.js. You need to disable a compression in config and everything will work correctly:\nhtml\nallow-compile-script    : false\nallow-compile-style     : false\nThank you!. Give me a feedback if it won't work \ud83e\udd47 . I recommend to use https://docs.totaljs.com/latest/en.html#api~HttpFile~file.image:\n```javascript\nvar file = self.files[0];\nfile.image().make(function(builder) {\n     builder.quality(90);\n     builder.minify();\n     builder.save(F.path.public(file.filename, function(err, is) {\n });\n\n});\n```\nThank you.. I know where is the problem. I need to see your controller's action, put the whole code from the action please.. Yes, correct.\n\nframework automatically removes all uploaded files when the action is responded\ncontroller.noClear() prevents removing of uploaded files\ncontroller.clear() removes uploaded files\n\n```javascript\nfunction action_create() {\n    let self = this;\n    let body = self.body;\n    let newName = 'uploads/' + self.files[0].filename;\n    let file = self.files[0];\nself.noClear(); // prevents clearing uploaded files\n\nfile.image().make(function(builder) {\n    builder.quality(90);\n    builder.minify();\n    builder.save(F.path.public(newName), function(err, isSaved) {\n        self.clear(); // clears all uploaded files\n        if (!isSaved) {\n            console.log(\"Image not saved! \");\n            console.log(err);\n        } else {\n            console.log(\"Saved! \");\n        }\n    });\n});\n\nTeacher.save(function(err, list) {\n    if (err) {\n        self.plain(err);\n    } else {\n        if (list) {\n            self.json(list);\n        } else {\n            self.json({ err: \"Erro na cria\u00e7\u00e3o\" });\n        }\n    }\n});\n\n}\n```\nIf you put Teacher.save() to builder.save callback then everything will work without noClear() and clear(). BTW: remove cors from routes and create a global CORS rule via https://docs.totaljs.com/latest/en.html#api~Framework~F.cors.. Do you want to read a file in get request? If yes:\njavascript\nF.file('/download/*.*', function(req, res) {\n    res.file(F.path.root('debug.js'));\n});. I don't understand, I didn't see any file in your code. Why do you use mongoose? Your code is not clean for me, I recommend to use Total.js Schemas with SQL Agent with MongoDB.\n. I understand. You can send the photo in the same request, but I don't recommend it because the image needs to be converted to BASE64 and length of encoded file will be 2 times bigger.\nI recommend to use separated requests. BTW: Look to SQL Agent and Total.js Schemas, it's better solution than mongoose.. Hi @raythree,\nthank you, but here is some info about it:\nhttps://docs.totaljs.com/latest/en.html#pages~Troubleshooting~(smtp-settings-for-gmail-office-and-zoho)\nBTW: ciphers is needed. I didn't find any info about secureConnection in Node.js documetantion in TLS. secure is a switcher only: https://github.com/totaljs/framework/blob/master/mail.js#L465. Hi @frunjik,\nyes, but there are 3 features:\n\nbuffer as Buffer e.g.:\n\njavascript\nbuilder.file('file', 'logo.png', Fs.readFileSync('logo.png'));\n\nwithout buffer e.g.:\n\njavascript\nbuilder.file('file', '/absolute/path/to/logo.png');\n\nbuffer as String e.g.:\n\njavascript\nbuilder.file('file', '/absolute/path/somefile.bin', 'logo.png');\nDo you understand?\n. The method offers 3 possibilities, so you can choose the right one.. Sorry ... I understand now, you're right. New version of Total.js (tomorrow) will have the only one declaration of .file() method.\nThank you!. Hi,\nyou need to convert newlines to unix style --> \\n only without \\r. Total.js uses this parsing for all files e.g. sitemap, workflows, resources, etc... I think that you have a problem with timeout. Can you show me a part where do you create a request?. Hmm, really I don't know where can be a problem. You need to debug it step-by-step. I can help you within support but as I wrote, I don't know where can be the problem and I need to debug it too.. Total.js responds with 206 automatically if the request headers contain range key.. Can I see a part of Total.js code where do you use request/response?. I'll test it today.. Hi @ckpiggy, I don't know why Facebook uses range  header with valuebytes=0-524287, from where is this value? Because an initial value for range header has to be bytes=0- because the request doesn't know the file size. So therefore my question.. I have tested it in Paw app and everything works correctly. I'll try to install postman.. I have tested it in postman and postman has a bug (I think) :-D .... I know now... I have fixed it...  Try to download this source-code: https://github.com/totaljs/framework/tree/v2.8.1 and try to test it again.. Hi,\ngreat. Yes, you could but I don't recommend it.\n\nTotal.js supports handling of static files automatically (so /app/public/ are really public directory)\nfor Express you had to find some modules always, but Total.js contains all what you need\nso don't find modules in NPM and always look to Total.js docs or write me on messenger.totaljs.com. I saw this tests 4-6 months ago and I have updated framework for these needs. But the big problem: uwebsocket can't process POST/PUT/DELETE data and therefore I didn't continue to create something like utotal.\n\nGood news: Therefore I added +v2.6.0 a new method F.custom(mode, http, request, response, options) just for similar cases.  It's not problem to create own HTTP module in pure C for the performance.\nThank you! \ud83d\udc4d \n. Hi, of course. You can find more info here:\nhttps://docs.totaljs.com/latest/en.html#api~ErrorBuilder~ErrorBuilder.addTransform\n```javascript\nErrorBuilder.addTransform('custom', function(isResponse) {\n    var builder = [];\nfor (var i = 0, length = this.items.length; i < length; i++) {\n    var err = this.items[i];\n    // err.name\n    // err.error\n    // err.path\n    // err.index\n    builder.push(err.error);\n}\n\n// isResponse: the output needs to be String because it will be returned in RESPONSE\n// If you want return e.g. XML, then set: builder.setContentTyp('text/xml');\n// If you want change a HTTP status, then set: builder.status = 400;\nreturn isResponse ? builder.join(';') : builder;\n\n});\n```. Good question.\n\nyou need to call setTransform manually in the schema: error.setTransform('mytransform');\nor try to use schema.setError(function(...) {})\n\nI'll think about better solution If it won't be enough.\n. Then try to use schema.setError(function(...) {}). Hi,\nthank you! Please perform this update to branch +2.8.1: https://github.com/totaljs/framework/tree/v2.8.1. Or I can update it too but you won't be in contributors (therefore I want it from you). . Thank you! I have improved it a bit.\nCan you send me your real name? I have added you to contributor's list.\n\ud83d\udc4d . :-D I can add your real name ... or is there a way to translate it to English? I can replace your name in readme for the real name (I don't have any problem with it) :-D.\nI have published a new beta version: $\u00a0npm install total.js@beta. And new release: I don't know, maybe next month.. 100x thank you! My big mistake.. I have published a new beta version.. Hi @maxxam11,\nhmmm, there is arrow function and with MODEL() it doesn't work but with F.model() it works. Which version of Total.js was your previous?. Can you test Total.js beta? Try: npm install total.js@beta --> it's stable.. @ckpiggy there is a bug. I have fixed it + I have published a new beta version $ npm install total.js@beta (stable).\n@luoage thank you!. Thank you!. Great, thank you! I need to update prepare_error because problem can be displayed in debug mode only. In release mode the problem is hidden because of security. . @ckpiggy can you update it? Maybe planA will be enough. Thank you!\n. Show me your route declaration please with this schema.. I know so... You can't declare two same fields with different filter. This is not possbible. I recommend to set schema.setValidate() for create or create two schemas create and update. I recommend to create two schemas.. Hi @DarkKnight1992,\ncan you show me your implementation of area in view?. I need to see code before rendering. Otherwise: can you create a simple example?. - download empty-project\n- add your code with a problematic part\n- compress it to zip\n- send me it petersirka@gmail.com\nBTW: I have tested <map in views and it has been rendered correctly.. The problem can be in Angular.... Try to look into the source-code directly whether contains NaN. Open Network tab in Web Developer Tools and check the response.. BTW: recover Total.js config to default because your paths are bad.. Remove all bad records:\nhtml\ndirectory-public : ../../public --> BAD\ndirectory-views : ../../public --> BAD\nallow-compile-css : false\nallow-compile-html : false\nallow-compile-js : false\nstatic-url : ../../public --> BAD\nstatic-url-css : ../../public --> BAD\nstatic-url-download : ../../public --> BAD\nstatic-url-font : ../../public --> BAD\nstatic-url-image : ../../public --> BAD\nstatic-url-js : ../../public --> BAD\nstatic-url-video : ../../public --> BAD\ndirectory-* + static-* can't contain this phrase ../ or ./. So if the response is correct the problem will be on client-side scripting.. You can use own structure, but you need to keep rules. All directories start from app root so you can't use ../ or ./ because you will be outside of app root. The problem is in different OS. \n```javascript\n// Default\ndirectory-public    : /public/\n// means --> /some/path/yourapp/public/\n// If you want to use another directory in APP ROOT then use:\ndirectory-public    : /shared/\n// means --> /some/path/yourapp/shared/\n// If you want to use another directory outside of APP ROOT then use:\ndirectory-public    : ~/absolute/path/on/your/server/\n// means --> /absolute/path/on/your/server/\n// I don't recommend it because this paths will use packages and modules\n```\nSo my recommendation:\n- don't change directory structure on the server-side\n- customize client-side by your needs in public directory or in virtualized app directory\n. root is according to the location of debug.js or release.js. In other words: root is process.cwd() --> current working directory.\nroot can't be defined in config file because Total.js reads config from app root. I need more info for thinking.\n. Look here maybe you'll find info:\n- https://github.com/qarmazi-labs/totaljs-angular2-starter-kit\n- http://maxprog.net.pl/node-js/total-js-angular2-typescript/. I don't use ES6, but if it works then OK \ud83d\udc4d  and if no, then I don't know.... Great! \ud83d\udc4d \ud83d\udcaf . Or directly in the route:\nhttps://docs.totaljs.com/latest/en.html#api~Framework~F.route\njavascript\nF.route('/relative/', action, 512); // 512 kB\nF.route('/relative/', action, ['flag1', 'flag2'], 1024); // 1024 kB. @DarkKnight1992 I found bug in the latest version with a body length --> received bytes are not converted to kB for classic requests with except multipart/form-data. Next week will be a new version with this fix.. I sleep, but you need to use allow-compile-script instead of allow-compile-js. Thank you. Yes because the framework expects blocks in the file\nhttps://docs.totaljs.com/latest/en.html#pages~Blocks%20(JS%2BCSS%2BHTML)\nIs it a problem for you?. I understand, but is it a problem for you (double creating files in tmp directory)?. There is a problem in release mode because static files are cached/use HTTP cache. I created versions file a in the past and this file can rename file without real renaming (it creates virtual rename), documentation: https://docs.totaljs.com/latest/en.html#pages~File%3A%20versions\nOther ways:\n- change etag (but is not effective for most browsers)\n- a real renaming of static files\nAll advices/ways need to restart app. So we will see, but I'd like to help.. I have looked into the source-code and the solution is to remove all *.js and *.css files from temporary directory and perform F.touch() method for clearing internal cache. The framework will process again all requested files.\nProcessing:\n- framework checks internal cache whether the file has been processed\n- if yes, it returns the file according to the cache\n- if no, it checks whether the file is existing in tmp directory\n- if yes, it returns it\n- if no, it processes it again\nBut you can create a route for clearing cache:\n```javascript\nROUTE('/internal/update/', function() {\n// Responds with empty response\nthis.empty();\n\n// Clears internal cache\nF.touch();\n\n// Removess all .js and .css files from TMP\nU.ls(F.path.temp(), function(files) {\n    F.unlink(files, NOOP);\n    // Now users get all refreshed files\n}, function(filename, isFolder) {\n    var ext = U.getExtension(filename);\n    return ext === 'js' || ext === 'css';\n});\n\n});\n``\nBTW: I'll try to add a skip of creating.jsfiles intmpdirectory if the files won't contain blocks or something similar.. I have addedF.config['allow-compile']which can disable the whole compilation. Try it:$ npm install total.js@beta`.\nBut as I wrote, you will need to perform F.touch() because internal cache contains size and last modification date.. Maybe this week. New version will be hotfix.. Hi @mahdi-gh1373,\n\nyou need to disable a compilation of JavaScript via allow-compile-script    : false in config\nor rename all scripts to e.g. bootstrap.min.js, angular-sanitize.min.js because .min. are not compiled again\n\nThank you.. Can I see your schema declaration?. Yes, there is a problem. Because the schema is created from the whole response, not from rows only.\nYou need to update your schema:\n```javascript\nNEWSCHEMA('ServiceRow').make(function(schema) {\n    schema.define('id', 'String(40)');\n    schema.define('Title', 'String(30)');\n    schema.define('TimeStamp', Date);\n    schema.define('docType', 'String(40)');\n});\nNEWSCHEMA('Service').make(function(schema) {\n    schema.define('rows', '[ServiceRow]');\n});\n```\nand now it should work:\njavascript\n    builder.schema('service');\n    builder.exec(function (err, response) {\n          console.log(response.rows);\n          // each item should be ServiceRow\n    });. Can you send me a small example on my email?. No problem.. Something new?. Sorry for delay. This is solution:\n```javascript\nNEWSCHEMA('ServiceRowValue').make(function(schema) {\n    schema.define('id', 'String');\n    schema.define('TimeStamp', 'Date');\n    schema.define('Title', 'String');\n});\nNEWSCHEMA('ServiceRow').make(function (schema) {\n   schema.define('id', 'String(40)');\n   schema.define('key', '[String]');\nschema.define('value', 'ServiceRowValue');\n   // Or just use Object:\n   // schema.define('value', 'Object');\nschema.setSave(function($) {\n    console.log($.model);\n    $.callback(SUCCESS(true));\n   });\n});\nNEWSCHEMA('Service').make(function (schema) {\n   schema.define('rows', '[ServiceRow]');\n});\n``. Hi, I don't know how, but.jpegwas missing in acceptable list. I have added it. Easy fix for the current version, just editconfig`:\nhtml\nstatic-accepts-custom        : .jpeg\nI want to publish a new version of Total.js this week.. Hi @bkhurram, sorry for delay.\nThis won't work, code evaluation is not supported in resources with except localization.\nhttps://docs.totaljs.com/latest/en.html#pages~Localization\nFor example:\nhtml\n@(This text will be localized @{resource('en', 'key')} automatically.)\nAnd then you need to use translation tools for creating localization:\nhttps://docs.totaljs.com/latest/en.html#pages~Localization~(translation-tools)\nGenerated en.resource:\nhtml\nkey               : LABEL\nT1301838957       : This text will be localized @{resource('en', 'key')} automatically.\nOutput:\nhtml\nThis text will be localized LABEL automatically.. This is not possible.. Or it's possible but you need to return a resource name according to URL in the F. onLocale delegate.. javascript\nF.onLocale = function(req) {\n    if (req.url === '/')\n        return 'home-en';\n    if (req.url === '/contact/')\n        return 'contact-en';\n   return 'en';\n};. I understand, but I don't have any plan for it. I recommend to use one resource for one localization.. I don't want to add this functionality. BTW: you can create a definition with this code and you have what you want.. Yes, it needs to be called each request because you need to know which user is logged in each route's action. Total.js supports these flags:\n\nauthorize for logged users\nunauthorize for unlogged users\nwithout flag for all logged and unlogged users together\n\nFor understanding:\nImagine we have an eshop application which have pages for all users and logged users. Homepage has to be rendered for all users (logged and unlogged together). But if some user is logged, you need to show his name in e.g.  layout --> so for this case is needed to execute F.onAuthorize too. Current solution will work because F.onAuthorize is executed for all (controlller's) routes.\nSolution for you:\n- instead of F.onAuthorize create own middleware\nDo you understand?\n. Just add services here:\nhttps://github.com/totaljs/framework/blob/master/helpers/debug.js#L14. Try use this example: empty-project.zip\nIt works, can you send me your example?\n. Shit, there is a problem in Windows. It works on my Mac. I'm going to fix it.. Please try to install latest beta version $ npm install total.js@beta and give me a feedback. Thank you!. Hi,\nof course, it's case-sensitive as configuration too. My rule: use everytime lower-case chars.. OMG, you're right. 100x sorry, my mistake.\nI have fixed it, try $ npm install total.js@beta.\nThank you \ud83d\udcaf \ud83e\udd47 . OMG! I'm fucker. Thank you again. Please reinstall beta again.. Great! Thank you again!. Do you use NGINX as reverse proxy? Or do you use something else?. Check your Nginx config:\n```nginx\nlocation / {\n    proxy_set_header   Host             $http_host;\nproxy_set_header   X-Forwarded-Protocol $scheme;\n\n# IMPORTANT: SET THE HEADER BELOW\nproxy_set_header   X-Forwarded-For  $remote_addr;\n\nproxy_set_header   X-NginX-Proxy    true;\nproxy_pass         http://0.0.0.0:8000;\nproxy_redirect     off;\nproxy_http_version 1.1;\nproxy_set_header Upgrade          $http_upgrade;\nproxy_set_header Connection       \"upgrade\";\nbreak;\n\n}\n```. I recommend to use Premium SuperAdmin, it creates similar configs automatically and with SSL certificates.. Hi @Vallevard, currently no. Now Total.js can communicate with client-side only, but I have a plan to create a client for WebSocket on server-side.\nTrust me, here is my first implementation:\nhttps://github.com/totaljs/framework/blob/v2.8.1/websocketclient.js. HI\u00a0@Vallevard,\nI have a good message, I have implemented WebSocket client successfully into the framework. If you want to test it - install beta version of Total.js $ npm install total.js@beta.\nHow does it work?\n```javascript\nrequire('total.js');\nWEBSOCKETCLIENT(function(client) {\nclient.connect('ws://127.0.0.1:8000/');\n\nclient.on('open', function() {\n    console.log('OPEN');\n});\n\nclient.on('close', function() {\n    console.log('CLOSE');\n});\n\nclient.on('message', function(message) {\n    console.log('MESSAGE', message);\n});\n\n// Default options:\n// client.options.type = 'json';\n// client.options.compress = true;\n// client.options.reconnect = 3000;\n// client.options.encodedecode = true;\n\n// Sending:\n// client.send({ some: 'object' });\n\n});\n``. Hi @bkhurram, this is not possible. Resource can't contain a reference to another resource.. Hi @dacrhu,\nI have tested it and everything works. Can you test latest beta version$ npm install total.js@beta`? Or do you have a live URL for testing?\nCan I see your client-side source-code?. Can I see it via TeamViewer? Can you write me on Total.js messenger? It will be faster --> https://messenger.totaljs.com ... I have tested your code and works correctly. Maybe the problem will be in the schema, but I need to see your source-code.. Omg, I'm blind. @molda you're right.. Then I need to test it in this case.. @dacrhu I need to test it, do you have TeamViewer or Google Remote Desktop? Write me email or write me on Total.js messenger.. Hi @michalCapo, can I see your initialization code?. And where is the horizon integration?. Does horizon use WebSocket?. You need to create a definition file e.g. definitions/horizon.js:\n```javascript\nconst Horizon = require('@horizon/server');\nconst Options = {\n    project_name: 'myProject',\n    auto_create_collection: true,\n    auto_create_index: true,\n    auth: {\n        token_secret: 'my_super_secret_secret'\n    }\n};\nON('load', function() {\n    F.global.horizon = Horizon(F.server, Options);\n    // or global.horizon = Horizon(...)\n});\n```\nTotal.js/Debug creates a separated thread, it's a bit complicated to explain it.. Thank you, Sometimes I'm faster, but today is weekend.. And extend it directly:\n```javascript\nU.check = function() {\n};\n// typeof(val) === 'string' is much faster than your:\nU.isString = function() {\n};\n```. Ohh, thank you! You're right. I have fixed it.\nhttps://github.com/totaljs/documentation/commits/master. Hi,\nyes because the framework is not initialized correctly.\n\nF.http() and F.load() loads/inits the framework and app dependencies\n\n```javascript\nF.load(false, ['models']);\nON('load', function() {\n    // Now \"load\" event will work\n});\n```\nIf you don't load the framework then define schema in this file directly:\n```javascript\nrequire('total.js');\nconst program = require('commander');\nNEWSCHEMA('User').make(function(schema) {\n    schema.define('name', 'String');\n    schema.define('email', 'String');\n    schema.setSave(function($) {\n        console.log($.model);\n        $.callback();\n    });\n});\nif (program.args.length !== 2) {\n    program.outputHelp(txt => txt);\n} else {\n    $MAKE('User', { name: 'Peter', email: 'petersirka@gmail.com' }, function(err, model) {\n        !err && model.$save();\n    });\n}\n``. Yes, it's missing ... I'll add it. BTW: It's not new.... Hi\u00a0@gmenih341,\ncan I see the code on this line/manager.js:1675:10`?\nWhich version of Total.js + jComponent do you use? BTW: instead of $.components.GET() use AJAX('GET /api/endpoint/', options, function(response) {.\nThank you!. @gmenih341 please write me the whole exception.. But before the line below is something:\nat endpoint_handler (/home/grega/Projects/Work/totaljs_project/controllers/manager.js:1675:10)\nAnd I need to see it and send me the content .setQuery() of Product schema.. I'm going to travel, so I will back around 3 hours.. Is there any news?. Hmm, there is a problem in Node.js:\nhttps://stackoverflow.com/questions/8083410/how-can-i-set-the-default-timezone-in-node-js\nMaybe this will work on Linux:\nbash\nenv TZ='Europe/Amsterdam' node server.js\nBut I don't recommend to change UTC, the work with UTC is better than some local timezone.. UTC has great benefits:\n\neach client sends data in UTC format (JSON uses UTC time)\nclient converts received dates in UTC to LocalTime automatically (JSON uses UTC time)\ntime is universal between all continents. Yes, you're right.. Hi,\nNoSQL embedded database is for small projects. I recommend to keep the database size for max. 20 000 documents (e.g. 3-6 MB file).. I'll add it into the documentation.. Hi @raisty, can you write me how do you run cluster? You can use preddefined helper:\nhttps://docs.totaljs.com/latest/en.html#api~FrameworkCluster\n\nBTW: you can run cluster in debug mode, there is no problem (important it won't work with require('total.js/debug')).. And does it work? BTW: you can use debug instead of release.. Hi @twisig, can you show me your model?. Why don't you want to create a server? It's a big problem to simulate the server.. Fixed: totaljs_mongo_helper.zip\n. Hi @twisig,\nI don't want to add a support for creating tables beacuse creating is a bit complex and SQL Agent supports 4 databases. Of course, you can create table via SQL Agent .query() method: https://github.com/totaljs/node-sqlagent#query but you need to write a raw SQL QUERY.. My opinion: it's useless. You can easily create table via:\njavascript\nvar sql = DB();\nsql.query('CREATE TABLE users ....');\nsql.exec(console.log);\nI want to keep simplicity.. > But i think @petersirka glad make row in own readme file about your plugin.\nOf course. SQL Agent emits database event:\njavascript\nON('database', function() {\n     console.log('Mongo is ready');\n});. Yes, it's missing... I'll add it.. Thank you! Year 2018 will be mainly about Total.js products.\nTotal.js framework:\n- add new features which will make the development more efficient\n- improve performance\n- improve stability\n- keep backward compatability but I want to remove older code\n- improve docs\n- extend community\n- create an example for larger apps (with cluster and redis)\n- create an example with LDAP\n- create new tutorials about creating apps\nTotal.js products:\n- new version of Eshop and CMS\n- update HelpDesk app\n- improve Total.js Messenger\n- create some free apps for OpenPlatform\n- create NoSQL embedded wrapper for MongoDB or PostgreSQL\n- improve docs for products on Wiki\n- add new Flow/Dashboard/Flowboard components\njComponent:\n- create new components\n- extend community\n- improve wiki\nOther:\n- Find a hosting partner\n- Find partners\n- Find money for larger development\n- Update homepage\nSo we will see. I want to continue, I love it. My work is my hobby.. My question is same.. Hi @michalCapo,\nthis prototype is for internal usage therefore is missing.. Hi @davidAlittle,\nyou can add Flow/Dashboard/Flowboard to your existing project, but they have to be written in Total.js. Total.js is around +70% of everything in all Total.js products. I don't see any problem to create standalone product with Flow/Flowboard/Dashboard and Total.js, the result will same and much simpler.\nDo you have a problem with overhead or do you have some collisions?\nThank you!\n. Which framework do you use with VUE on server-side?. It's electron app, hmmm. What do you want to use Flow for? Otherwise: you can run Total.js (Flow+Dashboard) on another port than Node.js server and they will work together without any problem.. I\u2019m in my bed. You can run Total.js framework in the Electron instance (but you will start Total.js on another port) or you can run a child process with Total.js Flow. There is multiple ways how to do it. You need to find the best way and I\u2019d like to help you. Just write me on Total.js messenger. Thank you!. I want to implement it, but http2() is experimental in Node.js and I want to wait stable state of this module. Therefore I recommend to use a reverse proxy e.g. Nginx with HTTP2. . I'm closing this issue now, but I'll add a support for HTTP2 in the future.. Hi @Pourya8366, what is the output from console?. @lyquocnam just copy all files/components to public directory. We don't have capacities for creating examples of each library. Try my advice and let me know.. Hi @raisty,\njust remove ! from URL in AJAXCACHE method. Let me know.. Of course. But headers must be allowed on server-side. Send me some example on my email, I'll test it.. Hi, model is not shared with layout. You need to use repository.\n. It's valid for most of EU ZIP numbers. You can change validation here: https://docs.totaljs.com/latest/en.html#api~Framework~F.validators or you can create a custom validation in the schema declaration.. Hi, I have fixed readme. Email templating works correctly in Total.js +2.9. Docs: https://docs.totaljs.com/latest/en.html#api~Framework~F.mail. @Pourya8366 can you send me a simple project with the first solution?. Hi @ckpiggy,\nyou have several options for it:\nconfig:\nhtml\ndefault-errorbuilder-status   : 400\nCustom ErrorBuilder transformation:\n```javascript\nErrorBuilder.addTransform('custom', function(isResponse) {\n    var builder = [];\nfor (var i = 0, length = this.items.length; i < length; i++) {\n    var err = this.items[i];\n    // err.name\n    // err.error\n    // err.path\n    // err.index\n    builder.push(err.error);\n}\n\n// this === ErrorBuilder instance\nthis.status = 400;\n\nreturn isResponse ? builder.join(';') : builder;\n\n}, true);\n```\nOr directly in the schema:\njavascript\nerror.status = 400;. Hi, you're right ... it's a bug. I have fixed it. Try stable beta $ npm install total.js@beta.. Hi @ckpiggy, I have fixed it $ npm install total.js@beta ... . Does it work?. Can you write more info? What does the console read?. Ok and what's happend when you open https://127.0.0.1:8000?. isn't secure:\n:-) of course because the browser doesn't accept your certificate as trusted. Do you have SSL from some trusted authority? I think that localhost won't work as trusted ..... @ckpiggy you can use multiple times OK() or FAIL() but not in another callback. This is correct.\n```javascript\nTEST('long run 1', function () {\n  OK(true, 'long run 1');\n});\nTEST('long run 2', function () {\n  OK(true, 'long run 2');\n});\n// etc..\nTEST('next', function () {\n  OK(true, 'the next test')\n})\n```\nIn other word: OK() and FAIL() ends the current test. It's something similar to your finished example. Solution:\njavascript\nTEST('long run', function () {\n  setTimeout(function () {\n    OK(true, 'long run 0')\n    OK(true, 'long run 1')\n    OK(true, 'long run 2')\n    OK(true, 'long run 3')\n    OK(true, 'long run 4')\n    OK(true, 'long run 5')\n  }, 100)\n});. Yes, but in a row ...  But I'll add not in some callback.. Yes, this can solve your problem.. Hi @ckpiggy,\nno, it's not plan because each module loads/processes code into the memory. So it doesn't matter if the code is in smaller modules or in the one bigger file. One bigger file saves memory because each module creates a new instance of module. The code is not pretty, but it's optimized for the best performance. \nThe code contains comments and the line sometimes contains max. 3 chars...\n\nMy plan is to keep current funcionallity and max improve it. The code contains older codet too (not much) but it must stay because of backward compatibility. I agree, code is bigger but functionality too.\nThank you!\n\nRoadmap:\nI prepare v3 with great new/updated features. E.g. components can contain new async render method --> this is really cool feature (I rewrote a part of View Engine). And next: schemas contain .setInsert() and .setUpdate() delegates.\nhttps://github.com/totaljs/framework/blob/v3.0.0/changes.txt\n. I'm solving it.... Hi @ivanlunardi,\ncan you try latest beta version? $\u00a0npm install total.js@beta. Great!. Hi @ivanlunardi,\nI have published stable release 2.9.4 with this fix. $ npm install total.js. Try this:\n```javascript\nvar cookies = {};\nF.helpers.getConstants = function ( callback ) {\nlet constants = {};\n\nRESTBuilder.make(function ( builder ) {\n    builder.cookies( cookies );\n    builder.cook( true );\n\n    builder.exec(function ( err, response, output ) {\n        console.log(\"Cookies:\", cookies );\n\n        /**\n         * Outputs:\n         * Cookies: { csrftoken: '8Cn3at5n9oW1CgxrXmbrELIxjdpDAGYj',\n         * sessionid: 'dseh0llwjhi8hk7rfix38igi7s648fy1' }\n         */\n\n        if ( callback ) {\n            callback( constants );\n        }\n    });\n});\n\n};\n``.RESTBuilder.make(function ( builder ) {creates a new instance of RESTBuilder, so it's useless to setbuilder.cookie()after you perform.exec()`.. > So, what is happening here? Are the cookies reset after .exec() ... or what are you saying?\nNo. All is about reference to cookie object. RESTBuilder binds received cookies after .exec. I wrote you about it in Total.js messenger. As I said: I help you within Total.js support.. I'm closing this issue.... Yes documentation is not perfect, but it's good. Each method/property/delegate has own description. Everyone can improve this documentation. It's very complicated to describe some practices because Node offers a lot of modules and then the biggest problem are lazy developers.\nThe entire platform of Total.js makes only the one developer with help of some another developers like Martin, Denis, etc.. We don't have any money, no investment, no big names, no big companies so just look on it from my side what I do. You have everything still free and it still not enough. Please help, please improve documentation or write blogs. If you don't have any time for it just send some money (e.g. 5000 $) and I trust me I'll invest them for better docs and tutorials. Really I do what I can.\nIt's not a problem to test some funcionallity without web server, just run it in Node:\n```javascript\nrequire('total.js');\nNEWSCHEMA('User').make(function(schema) {\n    schema.define('name', 'String(50)');\nschema.addWorkflow('test', function($) {\n    console.log('I am here!');\n    $.success();\n});\n\n});\n$WORKFLOW('User', 'test', console.log);\n```\nReally, is it so complicated? I don't think so. You can perform a lot of tests for understading like my example above.\n. I'll update section Schema this month in docs.. No, you can open issue here https://github.com/totaljs/documentation or you can improve docs too :-). Hi,\nI'm solving it.... Hi,\nI have fixed it, please try to install latest beta version: $\u00a0npm install total.js@beta and give me a feedback.\nThank you for the report!. Hi @ckpiggy,\nyou can disable it easily:\nhttps://docs.totaljs.com/latest/en.html#api~FrameworkConfiguration~default-websocket-encodedecode\nBut you will have a problem with UTF-8 chars.. @blaasvaer please don't create issues which are not issues.. I'll answer later, I'm on a business trip to thursday. @BlueMagnificent  thank you!. javascript\nfunction view_something () {\n    var options = {};\n    this.$get(options, this.callback('/timetracker/projects'));\n}. @blaasvaer put it to some definition file. We do what we can and as I wrote you must buy a support and personally helped you a lot. Please don't create issues on GitHub. GitHub is for real bugs, improvements, ideas, etc.. For basic questions use Messenger or StackOverflow.\n@twisig yes and therefore @blaasvaer can create a post on StackOverflow.\n@binarygeotech thank you!. Hi @miguelavaqrod yes, you're right. I have updated res.binary() but I can't publish it as a beta version yet because I have unfinished update for NoSQL :-D.\nTomorrow I'll publish a new beta version into the NPM and I'll give you a feedback!\nThank you!. Thank you! I appreciate it.\nI have published a new beta version into the NPM, please re-install Total.js:\nbash\n$ npm install total.js@beta. Hi.\nI will think about it. Now you can use GROUP():\njavascript\nexports.install = function() {\n    GROUP(['#middleware', 'authorize'], function() {\n        ROUTE('/api/posts/', json_posts, ['put']);\n        ROUTE('/api/commnets/', json_posts, ['post']);\n    });\n}\nhttps://docs.totaljs.com/latest/en.html#api~Framework~F.group. I thought about it and it would be useless.\nThank you!. Hi @mmautomatizacion,\nyes you're right. I have fixed it. Please try to download latest beta version of Total.js $npm install total.js@beta.\nThank you!. Great! Thanks for the report!. Can you send me your resource file? Which version of Total.js do you use?. Can you send me your resource file?. @ckpiggy you need to add space before :.\nGood:\nhtml\ntext : key\nkey:name : key\nBad:\nhtml\ntext: key\nIn some cases can your keys contains : so therefore you need to add min. one space.\n@molda thank you for solving this issue.. Hi @ivanlunardi,\nwhich content-type is used in your request? DELETE method is same like POST or PUT method and Total.js expects application/json or application/x-www-form-urlencoded.. @blaasvaer try this:\nhttps://docs.totaljs.com/latest/en.html#api~FrameworkConfiguration~default-layout. Hi @zerr0ne, this won't work ... Why don't you use F.merge()? It supports directory merging.. a) the framework doesn't reloading/recompiling/remerging files in release mode\nb) of course because you are in debug mode. Yes, it's a bit problem to implement because F.merge() loads file list when is declared and Total.js watcher doesn't watch non server-side files. So you need to restart app if you add a new file.. Yes.. Hi,\nsorry for delay. Yes Total.js View Engine markup is always processed. Why do you want to use it in comments? I have to think how to update compiler, it's a bit complicated.... @{! is used for disabling of escaping characters:\nhttps://docs.totaljs.com/latest/en.html#pages~View%20engine~(escaping)\nI'm thinking, but I don't see any good way for it. If you will have enabled HTML complication then standard HTML comments will be removed before the view engine processes the content. I think on it, but I don't know.. Here is a part of uncompiled spa.min.js:\nhttps://github.com/totaljs/jComponent\nI'm thinking... All comments will be wrapped in HTML comments symbols <!-- bla bla -\u2013> but the comments will still be removed before the view is rendered. That will be best way for handling both comments (HTML + ViewEngine).. This type of comment is not removed, so you can use it without any problem.. I have updated beta version of Total.js, so you can use it $ npm install total.js@beta.\nThank you!. Just use terminal in VSC and write node debug.js or node release .js :-). @Jusys total.js/debug is a special mode which can make some problems because it opens another thread with app. Create a new start script called e.g.:\napp.js:\njavascript\nvar options = {};\nrequire('total.js').http('debug', options);\nAnd just update your VSC meta file. This script is something similar like express.js start script but this script won't monitor changes in your app and you need to restart app manually when you perform some change.. I'll try to find a solution for this problem.. Hi,\nI didn't use | because I didn't like it. | can be a bit operation or double || means or. In Tangular engine is used | for inline helpers because I was inspired with Angular.js v1 template engine.\nI have added -> support for yesterday, so if you download jComponent from GitHub or CDN you can use -> instead of --> and of course you can use comments markup.\nPS: I'm absolutely old in Total.js, after 5 years of research I feel better than never before :-). But I understand of your flustration, you're not first and not the last one, but real learning curve is less than 3 months for handy developers. You must understand the concept and everything will be fine. Good luck and strong nerves --> it's worth it.. I'm closing this issue, it's solved with -> instead of -->.. Hi,\nyes and the only way how to hande it is to update debug.js or release.js file:\n```javascript\n// ===================================================\n// FOR DEVELOPMENT\n// Total.js - framework for Node.js platform\n// https://www.totaljs.com\n// ===================================================\nconst options = {};\n// ...\n// ...\n// ...\noptions.config = { 'directory-configs': '/config/' };\n// ...\n// ...\n// ...\nrequire('total.js/debug')(options);\n```\nConfigs files are loaded together when the framework is starting... . Please send me your project on my email, I\u2019ll check it.. Can you send me your project?. Hi @HACKHERS,\nthank you very much for this pull request. I think that this feature is useless because:\nTotal.js View Engine supports Link Prefetching via @{prefetch('URL')}, example:\nhttps://github.com/totaljs/examples/blob/master/views-head/views/index.html. Look here:\nhttps://jsfiddle.net/petersirka/r0kmhtvw/\nBTW: please use Total.js messenger for future questions: https://messenger.totaljs.com or my channel https://messenger.totaljs.com/petersirka/. I forgot to answer:\nhtml\n<button onclick=\"window.forma.Name='kuku'\">Ok</button>\n- this won't work because components don't know about your changes path\n- you need to notify change via SET(), UPDATE(), etc. methods\nhtml\n<button onclick=\"SET('forma.Name', 'kuku')\">Ok</button>. It's because of performance, but you can use jComponent CREATE() (A simple wrapper for Proxy object):\nhttps://jsfiddle.net/petersirka/r0kmhtvw/4/\nIt doesn't work in IE: https://caniuse.com/#search=proxy\n. Hi,\nI have updated JS compressor, try to download framework from GitHub and replace all files in your /node_modules/total.js/:\nhttps://github.com/totaljs/framework/tree/v3.0.0\nOr you can replace internal JS compressor:\nhttps://github.com/totaljs/examples/tree/master/external-compile-uglifyjs. Hi @ckpiggy,\nthis is good way how to handle it or:\njavascript\nON('service', function() {\n    if (F.datetime.format('dd:HH:mm') === '05:00:00') {\n         console.log('5th day');\n    }\n});. Hi @truedat101,\ntry to install latest version of Total.js $ npm install -g total.js and let me know.. Maybe I know where the problem is. Try to remove node_modules from app diretory and perform translate again and then recover node_modules. Let me know.. Try to install as a global module the latest version of Total: $ npm install total.js and perform translate again. Your project will still use 1.7.2.. Hi @gibson,\nbecause on the state from F.onAuthorize depends next processing of the request. I think that you use a global middleware, but update it in some definition file to:\njavascript\nF.use('session', '*', ['web']);\nAnd the middleware with session will be executeda after F.onAuthorize. Global middleware is executed before is the request processed.\nThat's explation \ud83d\udcaf . Aha ... Then you need to use a global middleware and you can do it like this:\njavascript\nF.use('session');\nBTW: this global middleware is for all requests, so update your middleware like that:\njavascript\nF.middleware('session', function(req, res, next) {\n    if (req.isStaticFile)\n        return next();\n    // ... your code\n    // ... your code\n    // ... your code\n    // ... your code\n});\nOr you can call session in F.onAuthorize directly:\njavascript\nF.onAuthorize = function(req, res, flags, next) {\n    YOURSESSION(req, res, function(session) {\n         // your logic for authorization\n    });\n};. Here you can read more\nhttps://docs.totaljs.com/latest/en.html#pages~Controllers~(the-routing). Yes:\njavascript\nGROUP(['authorize'], function() {\n    ROUTE(...);\n    ROUTE(...);\n    ROUTE(...);\n    ROUTE(...);\n    ROUTE(...);\n    ROUTE(...);\n    ROUTE(...);\n    ROUTE(...);\n});\nhttps://docs.totaljs.com/latest/en.html#api~Framework~F.group. Yes, I'll extend Controller section in docs by adding GROUP(). BTW: please use for next questions Total.js Messenger. It will be better and faster.\nThank you!. Hi @ckpiggy, there is not a support for it, but I'm going to look into it.. Hi @ckpiggy I have fixed it. Just download latest beta version $ npm install total.js@beta. Documentation: https://docs.totaljs.com/v3.x.x/en.html#api~WebSocketClient~client.on('close'). Thank you, I have prepared a new image, but it waits for 1st august. I agree, my english is very bad and I work on it everyday, but it's very very hard. I thank you for your points, I'll use them.\nIf you have a lot of free time I can add you an access to Total.js website and you can fix all my grammar mistakes. I'll be happy. Thank you again, I appreciate it.. Great and really I appreciate it!\nYes this is correct project. Also you can use Total.js messenger for tracking bugs/improvements, just write me https://messenger.totaljs.com/users/petersirka/, I'm still online.\nThank you! I would also like to repay.. @211217613 this is the content of my .eslintrc.js:\njson\nmodule.exports = {\n    \"env\": {\n        \"browser\": true,\n        \"commonjs\": true,\n        \"es6\": true\n    },\n    \"globals\": {\n        \"DBMS\": true,\n        \"WEBSOCKETCLIENT\": true,\n        \"ERROR\": true,\n        \"FUNCTIONS\": true,\n        \"GRAPHDB\": true,\n        \"COMPONENT_CONFIG\": true,\n        \"COMPONENT_EXTEND\": true,\n        \"clearImmediate\": true,\n        \"HASH\": true,\n        \"$INSERT\": true,\n        \"$UPDATE\": true,\n        \"$SAVE\": true,\n        \"FILESTORAGE\": true,\n        \"TESTUSER\": true,\n        \"TABLE\": true,\n        \"OK\": true,\n        \"BIND\": true,\n        \"FAIL\": true,\n        \"FREE\": true,\n        \"G\": true,\n        \"AUTH\": true,\n        \"REQUEST\": true,\n        \"MIDDLEWARE\": true,\n        \"RESET\": true,\n        \"Callback\": true,\n        \"DEF\": true,\n        \"WW\": true,\n        \"WH\": true,\n        \"NOW\": true,\n        \"COMPILE\": true,\n        \"framework_builders\": true,\n        \"framework_internal\": true,\n        \"EMPTYCONTROLLER\": true,\n        \"framework_utils\": true,\n        \"framework_image\": true,\n        \"PRINTLN\": true,\n        \"framework_nosql\": true,\n        \"MERGE\": true,\n        \"CORS\": true,\n        \"MAIL\": true,\n        \"MAP\": true,\n        \"LOGMAIL\": true,\n        \"CONVERT\": true,\n        \"LOCALIZE\": true,\n        \"FLOW\": true,\n        \"COMPONENT\": true,\n        \"DEFAULT\": true,\n        \"SCROLLBARWIDTH\": true,\n        \"DATETIME\": true,\n        \"MONTHS\": true,\n        \"DAYS\": true,\n        \"process\": true,\n        \"EMPTYOBJECT\": true,\n        \"EMPTYARRAY\": true,\n        \"TransformBuilder\": true,\n        \"Pagination\": true,\n        \"Page\": true,\n        \"REWRITE\": true,\n        \"user\": true,\n        \"PING\": true,\n        \"FILE\": true,\n        \"GROUP\": true,\n        \"URLBuilder\": true,\n        \"UrlBuilder\": true,\n        \"SchemaBuilder\": true,\n        \"Image\": true,\n        \"Builders\": true,\n        \"U\": true,\n        \"Mail\": true,\n        \"MAIN\": true,\n        \"common\": true,\n        \"WTF\": true,\n        \"SOURCE\": true,\n        \"INCLUDE\": true,\n        \"MODULE\": true,\n        \"NOSQL\": true,\n        \"NOBIN\": true,\n        \"NOCOUNTER\": true,\n        \"NOSQLMEMORY\": true,\n        \"NOMEM\": true,\n        \"DATABASE\": true,\n        \"DB\": true,\n        \"CONFIG\": true,\n        \"INSTALL\": true,\n        \"UNINSTALL\": true,\n        \"RESOURCE\": true,\n        \"TRANSLATOR\": true,\n        \"TRANSLATE\": true,\n        \"VIRTUALIZE\": true,\n        \"LOGGER\": true,\n        \"MODEL\": true,\n        \"GETSCHEMA\": true,\n        \"CREATE\": true,\n        \"UID\": true,\n        \"TRANSFORM\": true,\n        \"MAKE\": true,\n        \"SINGLETON\": true,\n        \"NEWTRANSFORM\": true,\n        \"NEWSCHEMA\": true,\n        \"EACHSCHEMA\": true,\n        \"FUNCTION\": true,\n        \"ROUTING\": true,\n        \"SCHEDULE\": true,\n        \"OBSOLETE\": true,\n        \"DEBUG\": true,\n        \"TEST\": true,\n        \"EMIT\": true,\n        \"ON\": true,\n        \"OFF\": true,\n        \"$QUERY\": true,\n        \"$GET\": true,\n        \"$CREATE\": true,\n        \"$WORKFLOW\": true,\n        \"$TRANSFORM\": true,\n        \"$OPERATION\": true,\n        \"$MAKE\": true,\n        \"setImmediate\": true,\n        \"Buffer\": true,\n        \"NOOP\": true,\n        \"RELEASE\": true,\n        \"is_client\": true,\n        \"is_server\": true,\n        \"F\": true,\n        \"framework\": true,\n        \"Controller\": true,\n        \"setTimeout2\": true,\n        \"clearTimeout2\": true,\n        \"isomorphic\": true,\n        \"COOKIES\": true,\n        \"I\": true,\n        \"UPTODATE\": true,\n        \"WEBSOCKET\": true,\n        \"WARN\": true,\n        \"LOG\": true,\n        \"NEWOPERATION\": true,\n        \"OPERATION\": true,\n        \"isMOBILE\": true,\n        \"$$$\": true,\n        \"SET\": true,\n        \"GET\": true,\n        \"EXEC\": true,\n        \"jC\": true,\n        \"NAVIGATION\": true,\n        \"NAV\": true,\n        \"ENV\": true,\n        \"$\": true,\n        \"KEYPRESS\": true,\n        \"FN\": true,\n        \"Tangular\": true,\n        \"Ta\": true,\n        \"MAN\": true,\n        \"FIND\": true,\n        \"SETTER\": true,\n        \"IMPORT\": true,\n        \"EVALUATE\": true,\n        \"NOTMODIFIED\": true,\n        \"WIDTH\": true,\n        \"d3\": true,\n        \"GUID\": true,\n        \"BLOCKED\": true,\n        \"CodeMirror\": true,\n        \"jQuery\": true,\n        \"MAKE\": true,\n        \"CACHE\": true,\n        \"UPLOAD\": true,\n        \"AJAX\": true,\n        \"AJAXCACHE\": true,\n        \"WAIT\": true,\n        \"ROUTE\": true,\n        \"CONTROLLER\": true,\n        \"SUCCESS\": true,\n        \"REDIRECT\": true,\n        \"CACHEPATH\": true,\n        \"marked\": true,\n        \"CLONE\": true,\n        \"STRINGIFY\": true,\n        \"PARSE\": true,\n        \"hljs\": true,\n        \"UPDATE\": true,\n        \"WATCH\": true,\n        \"SCRIPT\": true,\n        \"RESTBuilder\": true,\n        \"clearSchedule\": true,\n        \"TRY\": true,\n        \"CLEANUP\": true,\n        \"ErrorBuilder\": true\n    },\n    \"extends\": \"eslint:recommended\",\n    \"rules\": {\n        \"indent\": [\n            \"error\",\n            \"tab\",\n            { \"SwitchCase\": 1 }\n        ],\n        \"linebreak-style\": [\n            \"error\",\n            \"unix\"\n        ],\n        \"no-empty\": \"off\",\n        \"no-redeclare\": \"off\",\n        \"no-console\": \"off\",\n        \"no-constant-condition\": \"off\",\n        \"quotes\": [\n            \"error\",\n            \"single\"\n        ],\n        \"semi\": [\n            \"error\",\n            \"always\"\n        ]\n    }\n};\nSo you have several ways how to fix it:\n\ncreate .eslintrc.js file in your project\nupdate/create .eslintrc.js file above your all projects\n\n\n@ckpiggy thank you, this will work too.. Of course because downloading of the module costs some time.\nYou need to create a definition file for example wait.js:\njavascript\nF.wait('mongodb');\n\nthis definition will be loaded soon as the module\nand everything will work as you expected. Ohhh you use tests ... there can be a problem with F.wait()... I'll test it. It works correctly because F.wait() works as a toggle.\n\n```javascript\n// Holds the web server\nF.wait('database');\nsetTimeout(function() {\n    // Allows processing in the web server\n    F.wait('database');\n}, 1000);\n``. Web server works withF.wait()` but try to create a request in your browser and you will see something like this:\n\nI hope that you understand this feature :-D\n. I have fixed it, but you need to install $ npm install total.js@beta. This was a bug :-/. It works, test it:\nemptyproject.zip\n. Please show me your code with .output(). If you use it directly in response then you need to use error.output(true). Thank you.. Hi @ckpiggy, yes ... I'm testing something new :-D but sometimes will come something unexpected. I'm working on it..... Hi, comments are removed when the app is in release mode. Comments are for debug mode only.. Framework doesn't remove comments in minified scripts which are not minified via Total.js. You can remove the comments manually.\nBTW: it's good to keep licenses :-). Hi @exside, thank you very much.\nI don't agree because:\n- first of all, Node.js doesn't contain iframes\n- I didn't have any similar problem with checking Array type for more than 5 years\n- your solution is slower:\n\nI think that the current solution is very good.. Total.js supports a great solution for streaming text or binary data called U.streamer():\nhttps://docs.totaljs.com/latest/en.html#api~FrameworkUtils~U.streamer. Of course:\nhttps://blog.totaljs.com/blogs/tutorials/20161103-total-js-as-helper-without-web-server/#parsing-csv. - parseCSV sincerely I don't want to add something similar. Good way is to create a module or definition file with some decleration. I use CSV parser too in serveral projects and definitions with some methods were enough for my cases\n\nimageoptim I'm not sure if this will work... but try it: https://github.com/totaljs/examples/tree/master/image-middleware-pngquant. No, this is not possible with F.merge(), but it's not hard to create easily:\n\n```javascript\nrequire('total.js');\nconst Fs = require('fs');\nfunction merge(filename, files, callback) {\nvar writer = Fs.createWriteStream(filename);\n\nfiles.wait(function(item, next) {\n\n    Fs.readFile(item, function(err, body) {\n        if (err) {\n            console.log(err);\n            next();\n        } else\n            writer.write(U.minifyScript(body.toString('utf8')), 'utf8', next);\n    });\n\n}, () => writer.end());\n\ncallback && writer.on('finish', callback);\n\n}\nmerge('test.js', ['file1.js', 'file2.js', 'file3.js']);\n```. It's very easy to create a method for minifying files and I think it's sufficient for most of cases.. Hi Pedro, I have fixed it now. Download latest beta version.\nThank you!. Because data is not JSON --> String !!!! It's Object.. object is object. JSON is meant as a string (because JSON is the string) but the framework performs a simple JSON validation. Change json to object and everything will work as you expect.\n. OK, otherwise: WHAT IS JSON?. No, JSON is not OBJECT, it's String!\n\n. Hi,\nI don't have any experience with AWS, but it will be something similar config as for Express.js.. Hi,\nit's same but images can be processed ImageMagick or GraphicsMagick --> image.save().  Uploading is very easy https://github.com/totaljs/examples/tree/master/upload-multipart. Files are saved in tmp, but they are removed after you close a controller. You can use:\nhttps://docs.totaljs.com/latest/en.html#api~HttpFile~file.move\njavascript\nfunction some_upload_action() {\n    var self = this;\n    self.files[0].move(F.path.public('myfile.jpg'), function() {\n        self.json({ success: true });\n    });\n}. Hi,\nyes, you're right. I have added a new config option:\nhtml\ndefault-request-maxkeys     : 33\nBTW: you need to download latest beta version of Total.js $ npm install total.js@beta. Let me know.. Great! Maybe next week will be a new release.. Hi @fgnm,\ntry this:\njavascript\ncontroller.cookie('name', 'value');\n// or\ncontorller.cookie('name', 'value', null);. Yes, there is missing, but I have added it. I want to publish a new version of Total.js next week, so then will be updated docs.\nThank you!. Have you tested it from Chrome or Opera? Because if the sending takes some time then Chrome performs request again.... Try to simulate it from another script or from another browser..... or please create a small example.\nBTW: you can't use json with post flag because post is listening on json and urlencode automatically.. onAuthorize must be executed every request because the routing depends on it. So it doesn't matter if you have authorize, unauthorize flag or no.. Hi @sersh88, Total.js uses formidable parser... Can you send me some script for testing?. OK, and what is the real problem?\n\nIs not the file uploaded correcly?\nDoes the file contain bad data?\nDoes the framework throw some error?\n\nOr?\n. What's the size and type of file? I'll try to simulate something similar.. I'll try to simulate it today. I'll give you feedback.. I have tested uploading of 20 000 files:\n\n\n10k requests from first app\n\n10k requests from second app\nno problem\n\n\n\nDo you upload multiple files?\nAlso do you upload additional data?. Thank you. Are your data still same?\n\nContent-Disposition: form-data; name=\"file5\"; filename=\"/www/fasttube/backend/app/cache/upl....\"\n. Are you sure that your sender can't send bad data?. I need to simulate it... As I wrote I tested more than 20000 uploaded 300 kB files without any problem. Let me know.. Any news?. OK, no problem.. There can be a problem in some character. Are you sure the filename doesn't contain any : colon or \\n? Are you sure upload data are really correct?\nCan you create a small examples with upload/download? I need to capture this problem and then I'll fix it.. I understand. I'll try to upload 100K files again from multiple sources. I'll give you a feedback.. You need to use Total.js v3:\n```javascript\n// BAD\nF.route(\"/common/signature\", get, [\"*Signature\", 'range',\"image\",\"get\", \"cors\", 'head'])\n// GOOD:\nROUTE('GET /common/signature/ *Signature --> @get');\nCORS();\n```\nSchema:\njavascript\nschema.addWorkflow('get', function($) {\n    const url = 'https://www.totaljs.com/img/logo2.svg';\n    $.controller.proxy(url);\n    $.callback = null;\n});. Does the terminal log contain something? Can you create a small example which I can test on my Mac?. Hi,\nI found a problem in controller.proxy(). New version of Total.js will solve it, but here is a solution for the current version:\njavascript\nNEWSCHEMA('Proxy').make(function(schema) {\n    schema.addWorkflow('get', function($) {\n        $.callback = null;\n        $.controller.custom();\n        U.download('https://assets3.thrillist.com/v1/image/2558908/size/tmg-article_tall.jpg', ['get'], function(err, response) {\n            var headers = {};\n            headers['content-type'] = response.headers['content-type'];\n            $.controller.res.writeHead(200, headers);\n            response.pipe($.controller.res);\n        });\n    });\n});. Yes, but you need to encode it ... \n```javascript\nU.download('https://....?param=' + encodeURIComponent('yourvalue'), ['get'], function(err, response) {\n});\n```. OMG. Thank you!\nI'm going to update source-code.. Completely replaced. \nhttps://blog.totaljs.com/blogs/news/20181104-new-cdn-for-flow-dashboard-flowboard/\nThank you!. Hi,\n@customflag can be used for roles only. RegExp routing can be a part of dynamic argument only. \njavascript\nROUTE(function(url, req, flags) {\n    return (/YOUR_REG_EXP/).test(url);\n}, your_action);\nOr you can use routing group:\nhttps://docs.totaljs.com/latest/en.html#api~HttpRouteOptionsFlags~%26group_name. I understand. Then roles must work. Show me your implementation of F.onAuthorize ... There you need to add your role to flags argument:\njavascript\nF.onAuthorize = function(req, res, flags, callback) {\n    flags.push('customflag');\n    callback(true, USER_OBJ);\n};\n\n\nthen routing will work correctly. \ud83d\ude01so does it work?. Only wildcard routing with your custom logic.. Yes, it's correct.\n\n\nroutes with * wildcard have lower priority\n\nmore flags, bigger priority\n\nI meant that you create your own mechanism in some action in a route with wildcard.. Inversion is not possible. You can perform your own route in #404 action or you need to use wildcard routing with your own routing logic.. I don't see any problem if it works.... @dacrhu there was a problem in repeat mode. I have fixed it, just install latest beta version.. Yes, I know where is the problem... in UTC.\nIf you can, please download index.js file ... it contains fix:\nhttps://github.com/totaljs/framework/tree/v3.0.1\nBTW: and replace /node_modules/total.js/index.js ... It will work correctly now.. Today I'll publish new beta again. I want to publish a new release but I need to be sure with stability.\nThank you!. Hi,\ntranslation of static files is not good idea because static files are cached. I mean static files like .js and .css. HTML files can be translated easily via:\nhttps://docs.totaljs.com/latest/en.html#api~global~LOCALIZE\nCreate a definition file /app/definitions/localization.js:\njavascript\nLOCALIZE('/templates/*.html');\n// will localize all files in /app/public/templates/*.html\nAvoid localization in .js and .css files.\n. Where is $.post() located? It's part of .html file or some .js script? You can use jComponent library www.componentator.com ... and here is good example:\nhttps://github.com/totaljs/spa\n\nWith jComponent is easy to use localization because templates are part of HTML... That's the point. And here is great localization jComponent called j-Resource -- https://componentator.com/components/j-resource/ look to HTML tab. \n```html\n\n\n\n        {{ foreach m in value.table }}\n            <tr>\n                <td scope=\"row\" data-label=\"@(Amount)\">{{ m.amount }}</td>\n            </tr>\n        {{ end }}\n    \n\n\n    AJAX('POST /get_table/', {}, 'mydata');\n\n``. Thank you!. Can you create an example for me which I can test? Database can be a problem too. I need to see your code or problematical endpoints / routes.\n. I'm thinking ... how to help you. Do you have some idea?. Do you use another Node.js dependencies? Almost 100% CPU is not good result for me but in some cases is this behaviour acceptable.. If you want to read a file outside of public directory then you can use~for example~/absolute/path/`. Then it will work :-)\nPlease use Total.js Messenger for small questions.. This is a bit complicated. Try something like this:\njavascript\nfunction download_contract() {  \n    var self = this;\n    var filename = U.getName(self.req.url);\n    U.download(F.routeDownload('pdfs/' + filename + '.pdf'), ['get'], function(err, response) {\n        if (err)\n            self.throw404(err);\n        else\n            self.stream(response.headers['content-type'], response);\n    });\n}. This is not possible yet. I recommend to run the cluster on HTTP and use a reverse proxy via e.g. NGINX. I think that new update will support HTTPS in cluster.. Hi @EddiDin,\nI have added https into the cluster. Try it $ npm install total.js@beta and let me know.. @neophylon and does it work with:\njavascript\nrequire('total.js').https('debug', options);\n?. Shit, sorry --> my bad, try this:\njavascript\nrequire('total.js').cluster.https(5, 'debug', options);. Great, just create a pull request if you can to v3.2.0. Just let me know if you can't make pull request.. Mhhh, I know where is the problem. Buffer (with of key + cert) is not sent to child process. I'll fix it today.. I have fixed it. Sorry for delay. Try it $ npm install total.js@beta. Now you can use as you wrote:\n```javascript\noptions.https = {\n    key: '/etc/letsencrypt/live/domain.com/privkey.pem',\n    cert: '/etc/letsencrypt/live/domain.com/cert.pem'\n};\n// OR\noptions.https = {\n    key: 'BASE64',\n    cert: 'BASE64'\n}\n```\nThank you!. Show me your code how you run the app.. I have tested it. It works correctly.\n2019-01-18 13:39:10: Error: error:0906D06C:PEM routines:PEM_read_bio:no start line Error: error:0906D06C:PEM routines:PEM_read_bio:no start line\nThis error means that you have invalid certificate or key.. Sorry, I forgot to answer. I have updated @{options()}, you can use disabled key:\nhtml\n<select name=\"gender\" required>\n    @{options([{name : '@(Gender)', value : '-', disabled: true }, {name : '@(Male)', value : 'M'}, {name : '@(Female)', value : 'F'}, {name : '@(Other)', value : 'Other'}]\n</select>\nJust install $ npm install total.js@beta (it's stable).. Hi @germama,\nfirst of all - thank you. This is not normal behavior. Can you describe more your app?\n\nwhich dependencies have you used?\nwhat the app does do?\nhow many visitors/connections do you have?\nare you sure you don't have any infinity loop?\n\nThank you!. I use Flow in some projects and without any problem:\n\n\nLet me know if you found something....\n\nBTW: try to enable internal debug mode in /config file:\nallow_debug    : true\nFramework creates an internal snapshot to /yourapp/usage.log file. If you will have high CPU then send me this file, maybe it helps.\n. Some news?. OK, then I'm closing this issue.. I'm not sure with it. Can you create an example which can I test to some server? Because this change can affect existing projects.... I'll try to look into it this week.. I have added your fix. Just install $ npm install total.js@beta (it's stable). The fix has been added into the branch v3.2.0.. Thank you!. Why do you use only the one action?\n```javascript\nROUTE('GET,POST /api/users/', action);\nfunction action() {\n    var self = this;\n    if (self.req.method === 'POST') {\n}\n\n}\n```\nBETTER:\n```javascript\nROUTE('GET /api/users/', action_get);\nROUTE('POST /api/users/', action_post);\nfunction action_get() {\n    this.json({ success: true });\n}\nfunction action_post() {\n    this.json({ success: true });\n}\n``. In some cases I use same approach but __I recommend__ to do it on client-side via JavaScript if it's possible and my next recommendation is to send all forms viaAJAX`, always. Less code on server-side brings more benefits:\n\nless CPU and memory consuption on server-side\noutput of view can be cached\nbetter performance\nsmaller transmission data\n\n\nHere is a Flash module with same functionality as in Express.js, but I don't recommend it: https://github.com/totaljs/modules/tree/master/Miscellaneous/flash\nFor rendering some flash messages you can use controller.repository object or model or you can create some View Engine Helper. There are many ways how to do it.\n. Hi @ckpiggy,\nsorry for delay, here is the solution:\n```javascript\nAUTH(function(req, res, flags, callback) {\n    callback(false);\n});\n// And then create a system route:\nROUTE('#401', function() {\n    this.json({ error: 'unauthorized' });\n});. Hi @wprayudo,\nonly via WEBSOCKETCLIENT(): https://docs.totaljs.com/latest/en.html#api~WebSocketClient. Now Total.js doesn't support fragmentation. I didn't have any problem yet because I still work with messages with the fixed length. Fragmentation is about messages with uknown size. We can look into it but I don't have any idea how to implement it.. Hi @fgnm, this is not possible because NoSQL engine works with FileSystem only. For S3 Bucket is needed to use network connection and there won't work NoSQL engine.\nSo you have two possibilities:\n- use another DB like MongoDB or PostgreSQL\n- or use virtual private server (I use it too). I understand, but you need to know that NoSQL embedded can't be used in cluster. NoSQL is targeted for very small apps. Good luck!. I fixed it some time ago:\nhttps://github.com/totaljs/framework/blob/v3.2.0/utils.js#L619\nTry to user Total.js beta $ npm install total.js@beta.. I have released a new version of Total.js.\nJust update $ npm install total.js.. This is very strange example. I don't recommend to use mixing schemas ... you can use chaining for schema operation like this:\njavascript\nROUTE('GET /api/example        *Example --> @get @query @get-other-type (response)');\nSo the answer:\nYour example won't work. You need to know that Schema operation like setGet(), setQuery(), addWorkflow() works only with schema instance. What is the schema instance? It's an object generating according to the schema, this type of object contains a meta data about the schema.\n```javascript\nvar model = $CREATE('Example');\n// Now model is SchemaIntance\nmodel.$get(...)\nmodel.$save(...)\nmodel.$insert(...)\nmodel.$update(...)\nmodel.$workflow('....');\n```\nBack to your example:\n```javascript\nschema.setGet(async function($){\n    var model = $.model;\n    // model is Schema Instance\n// So you can perform:\n// model.$workflow('..')\n// model.$save();\n// model.$query()\n\n// But now you want to rewrite \"model\" with a new object\n// So another operation won't know about the schema because you rewrite it\n$.callback({ body: '<div></div>' });\n\n// Possible solution:\nmodel.data = { body: '<div></div>' };\n$.callback(model);\n\n});\n``. Can you send me some view? I need to test it.. BTW why quotes are duplicated? \nRead here: https://stackoverflow.com/questions/17808511/properly-escape-a-double-quote-in-csv. Yes, I will need to rewrite CSV parser... Shit.. Hi, I have addedcsvparser. Try it:$ npm install -g total.js@beta.. It's not good idea because view can be compiled inVIEW()method (outside of controller), etc.. I don't see any sense for it. Why do you need it?. Nice.. Hi, this means that SMTP server doesn't respond. Are you sure your SMTP is valid?. I need to test your SMTP server. Can you send me it on my email?. Hi, I recommend to use ourDBMS` module:\nhttps://wiki.totaljs.com/dbms/02-usage/\njavascript\nconst dbms = require('dbms');\ndbms.init('source', 'postgresql://user:pass@localhost:5432/dbname1');\ndbms.init('traders', 'postgresql://user:pass@localhost:5432/dbname1');\nUsage:\njavascript\nvar db = DBMS();\ndb.find('source/inventories.invs').take(100).set('inventories');\ndb.find('traders/public.items').take(100).set('items');\ndb.callback(console.log);\nIt's our alternative to SQL Agent.. Sorry, there is a bit confusion and I found a bug with query, but I have fixed it now. Please reinstall DBMS from NPM.\njavascript\n// a bit modified .query():\ndb.query('inventories', 'select * from invs').callback(console.log);\n// or with .conn()\ndb.query('select * from invs').conn('inventories').callback(console.log);\nRecommendation:\njavascript\ndb.find('inventories/invs').where('removed', false).fields('id', 'name').callback(console.log);\nLet me know.. Understand. Not a problem and just let me know if something won't work.\nBTW: Thank you!. ",
    "Mirodil": "Hi,\nWindows 7 and partial.js version is 1.2.2-8\n. Thanks, it works. :)\n. Thank you\n. Ok thanks.\n. after adding 'post' flag 'GET' request not works. How can i add 'GET' too? (I have had a look the URL). I need a both GET and POST. is it possible?\n. \"completeTask1\" and \"completeTask2\" async tasks calls some APIs. The framework response to request at once leaving the function but in the function has async tasks.\n. yes, for example facebook api, google api and e.c.\nIs any other way without changing time out?\n. Sorry, timeout does not help\n. I have wrote by myself for facebook graph api using \"request\" module\n. yes, I call callback but response already sent to client\n. here is simple project: [https://dl.dropboxusercontent.com/u/57201831/async-tasks.zip]\n. ",
    "Gigiz": "I have the same error. I waited for the update, but the problem persists.\n var f = require('partial.js')  OK\n f.run(http,debug,port)  Error!\n. I only tried on Windows 7 64 bit... I think I have the latest version because i downloaded a few hours ago via npm.\nWhich version of nodejs are you using? \n. As soon as possible I try your .zip test.\nThank you\n. Hi,\nafter a good cleaning and reinstalled everything (nodejs, partial), now it seems to work.\nI had messed up the nodejs folder due to some tests :P\nThanks for your patience\n. ",
    "marconucara": "I didn't solve too, and I can't got what you mean with \"How to solve a problem? ...\".\n$ cd /path/to/your/project/\n$ node index\nFor me is the same of:\n$ node /path/to/your/project/index\nand i got the same error.\n. i tryed in ubuntu 12.04 lts 32bit and windows 7 64bit, and I got the error of the first post. Last version of partial from npm (should be 1.2.3-8 as I can see on the site, but i don't know how to check it).\nthank you\n. Sorry but my project is just \"examples\" folder from github.\nMy version of nodejs is v0.10.7.\n. My version of nodejs was wrong! apt-get did install 0.6 i don't know why, now I'd upgrad and empty-project works. Thank you.\n. Ok, thank you. Ok, i got about context problem, but it seems that framework.model() is not a solution. I'll try it again, maybe some other error. \nBut, just for undestanding, the next line of code:\nframework.model('my-model-name').find(function(docs){console.log(docs)})\nshould respectively works in:\n- controlles/some-controller.js in private function?\n- controlles/some-controller.js in public (exported) function?\n- definitions/my-definitions.js, after a require?\n- release.js, after run?\nI hypothesize that the \"find\" function obviously work fine and is tested in normal framework use(mongoose ok, ecc).\nI'll check about module, do you have any example about using of module for getting data by controller/model?\nThank you, again.\nEDIT: about module, isn't it loaded before definitions? How to use a controller function in it, that use some definitions (even just a db)?\nModule looks like a function definitions. I don't think I need it. Let me explain with a totally different example:\nI've \"team\" controller, that represent a virtual football team in my webapp, it's created by user ecc. Web server call is used for create edit delete team, ecc using a controller for got control of model, respecting mvc. I've also match controller, that represent match between teams. User/client doesn't create match. It's just a random process executed every day (as hypothetical). And also the playing of a match can't depend by client call. That function have to be in controller, for mvc a and for clean, do you agree? The problem for me is, where to call that function? My specific case is a bit simpler couse I just need to call it on application startup, but it's very similar cause a function that have to be called at a specific time will be called at startup with a timer/timeout and similar staff.\nSorry for that long story :D\n. Ok, I'm not fully convinced about your architecture, but I'll try to study better your examples for understand it. \nIn the meanwhile I found the solution at my specific question about scope of model, and more specifically about db function that can't be used i none of the previously listed part of code, if you don't wrap it in:\nframework.on('load', function() {\n    // all controllers and modules is loaded (and modules and definitions I suppose)\n});\nNo bullshit, just an awesome work! Thanks again, really! And if I can do a little advice: let's stop a bit the development and clean up the docs!\n. Great! Thanks.\n. Good solution for me, thanks.\n. ",
    "eMarek": "I tried it just now and got the same error.\n. It is interesting. On Ubuntu I had to reinstall node.js and now it works like a charm.\nReinstalling node.js on Mac does not help. Here is the screenshot:\n\n. Thank you!\nI had to delete the \"partial.js\" directory in /usr/local/bin/node and reinstall partial.js modul.\nYou are my man! :)\n. Yes @petersirka, node_module folder was missing. I installed partial.js locally\nshell\nKopparberg:test marek$ sudo npm install partial.js\nand ran partial.js framework without any problems.\nThank you for the quick response.\n. Thank you for comments in code. This helps me a lot. I was not paying attention earlier that #.js file is called automatically. But I still do not understand these flags \"logged\" and \"unlogged\". So function onAuthorization is called on every request and callback sets \"logged\" or \"unlogged\" flag. Am I right?\n. I am quite familiar with partial.js framework as I was 2 months ago. I still have one question about authorization. Is it possible to check if is user logged in inside the controller function after routing?\n. Oh yeah, basicly I can check user id in controller\njs\nif (self.session.id) {\n    //...\n}\nwhile I am using you onAuthorization code from authorization example. Thank you!\n. I just updated partial.js to version 1.2.5-0 and I have a problem with self.app.encode in controller.\n```\nTypeError: Object # has no method 'encode' TypeError: Object # has no method 'encode'\n    at /..../controllers/authentication.js:82:44\n    at cb (/..../node_modules/partial.js/nosql.js:374:3)\n    at Object._onImmediate (/..../node_modules/partial.js/nosql.js:346:4)\n    at processImmediate [as _immediateCallback] (timers.js:330:15)\n\n```\n. Thank you!\nI saw this two examples about authorization and session. Isn't it a little bit too complicated? All this objects and stuff... What is with session now, by default is null or what? I do not know how to use it anymore.. :(\nBy the way what happend to cache?\nOBSOLETE cache.write() - use cache.add()\n. So if I understand it, I should use cache.add() instead of cache.write(). And for getting data out of the cache I should use same old cache.read(). Right?\nI want to ask you before about the session. How is realized, maybe with memcached? So from now on there are 2 options with this new session.js module. The first one is the same as it was, realized with in-memory cache. The new one is realized with redis which preserves data on disk. Sessions are not killed in the case of restarting the app. Am I on track? :)\nAnyway, I will wait for documentation. OOP is not my primary skill. :D\nCan I ask if session is still possible to use without session.js module?\nBy the way it is good to see that you are improving partial.js day by day. ;)\n. I am trying to use session without session.js module... Unfortunately without success. :(\nNo matter what it is always null. So I made one stupid example...\nMy #.js module file looks like this.\n``` js\nexports.onAuthorization = function(req, res, flags, callback) {\nvar self = this;\nreq.user = {\n    id: 11,\n    name: 'Marek'\n};\ncallback(true);\n\n};\n```\nMy default.js controller looks like this:\n``` js\nexports.install = function(framework) {\n    framework.route('/', view_logged, ['logged']);\n};\nfunction view_logged() {\n    var self = this;\n    console.log(self.user);\n    self.plain('you are logged in');\n}\n```\nThe fact is that console log of self.user is null. What am I doing wrong?\n. In this new version v1.2.5-1 works okay. Thank you for the update!\n. I prefer first solution. Thank you. :)\nAre you planing to make method \"Controller.prototype.html\" which will do:\njs\nself.layout('');\nself.view(...);\nWhat you think? It is sweet and clean for html responses.\n. I think I will affect all controllers. There will be many html ajax calls in my app. This is also the reason why I am asking you for native html method. Let me know if you will implement it. Anyway I am satisfied with this solution. Thank you :)\n. I did not have any time yesterday for testing on computer. I have just created #.js file and put this piece of code in it:\n``` js\n// this code affect all controllers\nframework.on('controller', function(controller, name) {\nif (!controller.xhr)\n    return;\n\nif (controller.url.indexOf('/loadPanel') !== -1)\n    return;\n\ncontroller.setLayout('');\n\n});\n```\nand now I am getting this error:\nconsole\nTypeError: Object #<Controller> has no method 'setLayout' TypeError: Object #<Controller> has no method 'setLayout'\nDo you have any idea?\nI have even tried to put the code in index.js file, but does not help.\n. Jeah, so obvious, tnx. :)\nOne another thing... I have to put this code in index.js file. If I put it in #.js file, than framework is not defined.\nconsole\nframework.on('controller', function(controller, name) {\n^\nReferenceError: framework is not defined\n. Thank you! You are the best!\n. Thank you for this explanation.\n. Oh jeah, return; was missing. Thank you.\nAbout code review.. Could you please explain how does expression function work. Documentation is only indicative. Anyway, I like it, it is cleaner than my version. :)\n. I barely understand the code. To much callbacks and all stuff. :)\nSo expression returns anonymous function which is then executed as a filter function. Filter is second parameter in arrayFindAll and arrayFindAllWithIndex functions of course. The things I do not understand are for example here:\njs\n// expression('value > myvalue && value < myvalue + 5', ['value', 'index', 'myvalue'], 3)\nfunction(value, index, myvalue) {\n    return value > myvalue && value < myvalue + 5;\n};\nWhy are here three parameters? Is myvalue automaticaly replaced with 3 in some mysterious way?\njs\n        if (filter(value, i))\n            selected.push(value);\nAs I understand filter use only first and second parameter.\nAnyway I do not want to harass you. I will use that code without expression if you think it is better.\n. I know what are closures, but I do not have so much practical experience. Actually I have gone all over again and realized that expression:\njs\nconsole.log(expression('value > myvalue && value < myvalue + 5', ['value', 'index', 'myvalue'], 3).toString());\nreturns\n``` js\nfunction () {\n    var arr = [];\nfor (var i = 0; i < arguments.length; i++)\n    arr.push(arguments[i]);\n\nfor (var i = 0; i < values.length; i++)\n    arr.push(values[i]);\n\nreturn fn.apply(this, arr);\n\n}\n```\nand not\njs\nfunction(value, index, myvalue) {\n    return value > myvalue && value < myvalue + 5;\n};\nas I was thinking before. I am stuck again at this point.\nNever mind. We are off topic and I got the answer about loading views so I am closing the issue. Thank you. :)\n. I had the same problem in this issue https://github.com/petersirka/partial.js/issues/7.\n@petersirka, maybe you should add some notification in read.me file or somewhere that partial.js module must be installed locally as well.\n. Which version of IE? I have not tested jet partial.js implementation of WebSockets, but as far I know, WebSockets will work in IE 11 and in one of IE 10 updates (already out?). Maybe you can take a look at socket.io (http://socket.io/#browser-support) which uses Flash or Ajax if browser does not have WebSockets support.\n. Hmmm, I will try. I just testing angular.js a little bit.\nSo what is the difference between self.responseFile(req, res, self.path.public(filename), filename); and self.file(name + '.html'); as you used it in the issue  https://github.com/petersirka/partial.js/issues/22#issuecomment-21933713.\n. Hard to explain. :D\nI am learning MVVM frameworks and angular.js is one of them. Let's say this way. I make two ajax calls from browser to server. With first one I am getting view. It is pure HTML file with some ng stuff without any data. With second one I am getting date (JSON). This two things (view and data) are combined by the angular.js in the browser. Why am I doing it like this? Because of so called two way data-binding. You can modify JSON and this will be reflected in the DOM tree and vice versa. The idea is sth like this:\n``` js\nexports.install = function(framework) {\n    framework.route('/', index);\n    framework.route('/products.html', productsHTML, ['+xhr']);\n    framework.route('/products.json', productsJSON, ['+xhr']);\n};\nfunction index() {\n    var self = this;\n    self.view('app');\n}\nfunction productsHTML() {\n    var self = this;\n    //returning just view\n    self.file('../views/products/index.html');\n}\nfunction productsJSON() {\n    var self = this;\n    //data from DB\n    self.json({...});\n}\n```\nThe easiest fix for my problem is to replace dots in routes with dashes.\njs\n    framework.route('/products-html', productsHTML, ['+xhr']);\n    framework.route('/products-json', productsJSON, ['+xhr']);\nAnyway, I will satisfy myself with this ugly notation, if you do not have any better solution. :D\nAbout the controller responding with self.file(...);... It is very usefull, tnx.\n. This solution looks workable but I my case is a little bit to opened. My app will be behind authentication and I do not want to have public views. After all I think I will load views with controller. I have not decided yet.\nAnyway, thank you for the help.\n. @petersirka, you should start working full time on this framework because is really good piece of software. Basically I am working with PHP on Codeigniter framework and I am just very excited about node.js and partial.js and all this JS stuff. What I wanted to say is that I found some parallels in Codeigniter and partial.js. Both frameworks are structured just right enough to guide newcomers and on the other hand give freedom to lean programmers. I think that there is potential on partial.js. I recommend it to all my friends. :)\nI learned a lot about the partial.js through the examples and yes, the documentation is a little bit poor. Stop coding, start writing better documentation. Your english is not bad, community will correct grammar errors.\n. \n. Niceeee, thank you, this solved my problem.\nCan I ask what is the difference between using json or xhr at routing?\n. Many people are using jQuery in their applications. Think about adding .map as one of default extensions.\nAnyway, config file does solve my problem. Tnx. :)\n. Thanks, it works as it should! :)\n. So why do we need configuration file than?\n. @petersirka, does exists any flag in config file that disable compiling?\nFor example:\njs\njs-compiled : false\ncss-compiled : false\n. That is great, tnx!\n. That is cool. Yeah, I see that you have been replacing modules with definitions.\nPlease make a good documentations for framework.file method. I am a little bit confused because example (https://github.com/petersirka/partial.js/blob/master/examples/download-file-counter/controllers/default.js#L11) does not match with current documentation (http://docs.partialjs.com/Framework/#framework.file).\n. I will take a look tomorrow. The problem is that I get different hashes for same string (password).\n. I have tried framework.encode('123456', 'MyPASSWORD', false); and I am getting different encoded string. Something is not okay here...\nSo I found sha1 method in utils (https://github.com/petersirka/partial.js/blob/master/utils.js). This is basically what I am looking for.\n``` js\nvar ENCODING = 'utf8';\nString.prototype.sha1 = function() {\n        var hash = crypto.createHash('sha1');\n        hash.update(this.toString(), ENCODING);\n        return hash.digest('hex');\n};\n```\nCould you please make another similar function with sha256 cryptographic hash function.\nPlease explain me what is this.toString(). As I understand it, this should be a string I would like to to encrypt.\nCould you please add SALT (config secret) to this string.\nHow can I call this util in controller, modul, defintion or view?\n. Yeah, this is what I need it. Could you please upload partial.js 1.3.1 to NPM. You are the best. :)\n. Thank you. Could you please update authorization module.\nbash\nTypeError: Object #<EventEmitter> has no method 'decode' TypeError: Object #<EventEmitter> has no method 'decode'\n. I owe you a beer. :beers: \n. I'm borrowing this conversation for a few questions about definitions and modules. @petersirka, recently you \"created\" this so called defintions and all that previously have been modules sudenly became defintions. Something like that, right?\nSo now definitions should be used for framework settings and modules are designed for using them on many different projects. So far so good, but let's face it. In yours authorization and session module you also need definition, otherwise module is useless. Is not this a little bit of failure in the concept?\nI am looking this two examples:\nhttps://github.com/petersirka/partial.js-modules/tree/master/authorization/example/definitions\nhttps://github.com/petersirka/partial.js-modules/tree/master/session/example-in-memory/definitions\nBy the way, difinition example link in docs gives me 404.\n. I need you sugestion. I have this code for timestamping.\n``` js\n    var d = new Date();\nvar year = d.getFullYear();\nvar month = d.getMonth() + 1;\nvar date = d.getDate();\nvar hours = d.getHours();\nvar minutes = d.getMinutes();\nvar seconds = d.getSeconds();\n\nvar time_stamp = [ year, month, date ].join('-') + ' ' + [ hours, minutes, seconds ].join(':');\n\n```\nShould I put this code in module or anywhere else?\n. What about custom utils or some kind of helpers?\n. Tnx. :)\n. Is it possbile to end a request before controller is executed in any of these three:\njs\nframework.on('request-begin', function(req, res) {\n    // YOUR CODE HERE\n});\nor\njs\nframework.on('controller', function(controller, name) {\n    // YOUR CODE HERE\n});\nor\njs\nframework.onAuthorization = function(req, res, flags, callback) {\n    // YOUR CODE HERE\n};\nI want to notify my user that his session has expired.\n. I am not using authorization module right now because I do not understand what is happening in that module. I do not know so much objective JS. :)\nThank you for this example. This solve my problem.\nI have one question more about this controller.cancel();. Should I use controller.cancel(); also in controllers themself if I want to cancel a request or is just return; good enough?\n. Today I was testing\njs\nframework.on('controller', function(controller, name) {\n    // YOUR CODE HERE\n});\nand I ran on a problem, because I can not make any database calls inside this. Database callback (where I put controller.cancel();) is executed after controller itself so I can not end a request on a proper way. So should I make all database calls inside\njs\nframework.onAuthorization = function(req, res, flags, callback) {\n    // YOUR CODE HERE\n};\nor is there any other solution?\n. Tnx.\n. Yeah, I see the difference between angular.js and jQuery ajax request. Thank you.\nMaybe I will use this in angular:\njs\nmyAppModule.config(['$httpProvider', function($httpProvider) {\n    $httpProvider.defaults.headers.common[\"X-Requested-With\"] = 'XMLHttpRequest';\n}]);\n. ECMAScript 6 you say. :P\nI just saw this:\n\nDear community. I had to rename framework partial.js because I'm not owner of domain name (partialjs.com) but I'm owner of the framework. Not all people are good and I made a mistake a long time ago. I hope you'll understand.\n\nNow I get it.\n. ",
    "tegeek": "It runs for me perfectly. \nAnother way to start a new app is to download the demo blog app and put new controllers, views as you want. \n. Ok, I looked at the source code of totaljs and it'll be a little tricky to have my preferred directory structure and probably will have to do some breaking changes. And doing all that just for another directory structure isn't wise at all. \nAnother thing I'm wondering once you've definitions, models and controllers, how you unit test each component and how you can inject the other as dependency during tests?\n. I created the directory structure here\n1. server -- contains all the server side code \n2. client -- contains the client side code (this code be angularjs related or any custom js code, this code can also use npm modules via browserify)\n3. node_modules are, well, the node packages. \nNow if you see the server folder it contains shared (which is shared code like Util functions, etc.) and \nmodules. (modules can also be named plugins). \nEvery module or plugin is a self-contained fully independant code from other modules/plugins. The action folders are basically controller functions. views are the views only for that module. \nI put two extra files Init.js and package.json. totaljs can load Init.js and that will define what the module will expose to the outside world. The package.json file can contains module config, and some other things. \nThis way every module can be shared with other totaljs applications by simply copying pasting and without fearing of breaking anything. This structure can be scaled to any size of application. \nWe can have wrapper around nodejs's module system to resolve modules at \"compile\" time which means when totaljs runs, it can look which modules using others and see if they are present and in case failure we can stop the loading further. \nI've actually idea and some code which can provide this but i'm not sure the scope of totaljs or others like the idea. \n. ",
    "khoaho": "Hi Peter,\nYes, I replaced 8000 port for process.env.PORT before uploading to the website. Please see the link of the sample blog: http://www.netscriptcad.com/node/examples/blog/\nThe error is generated from IIS Node but I don't know how to fix. I created logs folders (in website root, Node.js root, this application root) but nothing was seen there.\nThank you.\n. The IIS Node on the remote host server works, see the example links:\nhttp://node.netscriptcad.com/\nand\nhttp://node.netscriptcad.com/examples/hello.js\nhello.js still runs as \"in website\" in the sub folder \"examples\". But the complicated node.js projects will not work as \"in website\".\nThanks.\n. Hi Peter,\nI tried to copy the blog partial.js project to the Node.js virtual directory of the website, but it still does not work. Please check again the link: http://node.netscriptcad.com . Where can I track log files of Node.js & partial.js in the remote server?\nThank you.\n. Hi Peter, you can use the latest Microsoft WebMatrix to open the partial.js blog sample, to see it fails to run on  WebMatrix (we have to modify the generated web.config for index.js). The publish site to Windows Azure also has the same problem, please check it here: http://blognode.azurewebsites.net/ . It seems this is an issue to work on IIS Node.\n. I just sent the sample website with web.config your email address. Thank you.\n. ",
    "beinnova": "I do not know if you can download virtual chromium-browser. But i have the same problem with firefox. In this case the error is \"Firefox can not establish a connection with the server ws :/ / 127.0.0.1:8005 /.\"\n. Ok now work!!! I not understand why. :-D Thanks so much and compliment for this framework !!\nOn linux the name is Chromium because is a open source project and Google Chrome is based on this. But Google Chrome have a property freeware license.\nRegards\n. ",
    "KiPSOFT": "Hi;\nI'm using Firebird and node-firebird and my library.\nWhen the user without logout, I want to end the database connection automatically.\nI have to solve this problem, I've added a new event Recycle method. I could not find a more sensible solution programmatically.\nin partial.js;\n``` javascript\nFrameworkCache.prototype.recycle = function() {\nvar self = this;\nvar repository = self.repository;\nvar keys = Object.keys(repository);\n\nif (keys.length === 0) {\n    self.emit('service', self.count++);\n    return self;\n}\n\nvar expire = new Date();\n\nkeys.forEach(function(o) {\n    if (repository[o].expire < expire) {\n        self.emit('cache_remove', repository[o]);\n        delete repository[o];\n    }\n});\n\nself.emit('service', self.count++);\nreturn self;\n\n};\n```\nthis code login module;\n``` javascript\nexports.install = function(framework) {\n   framework.on('cache_remove', cacheRemove);\n}\nfunction cacheRemove(o) {\n    console.log(o);\n    o.value.connection.detach(\n        function(){\n            console.log('database detached');\n        }\n    );\n}\n```\n. Thanks for the update.\n. thanks for answer. yes this solve my problem but user not authorized and request public/.html files. how this block unlogged user access public/.html files ?\nthanks.\n. thanks for reply.\n. hi again;\n     this.response404(req, res);\nfunction good work, but; \nframework.route('#401', error401);\nevent not triggered.\ni'm add redirect in error401 function. how to redirect ?\ncode:\nexports.install = function(framework) {\n    framework.route('#401', error401);\n    framework.file(\"private *.html\", function(req, res) {\n        return true;\n    }, function(req, res) {\n        this.response401(req, res);\n    });\n};\n// Unauthorized\nfunction error401() {\n    var self = this;\n    self.redirect('/login/');\n}\n. yes. i solved this code framework.responseRedirect(req, res, \"login\", true); \n. yes this chat application good work but my node.js client application not connect server. i'm using this websocket module https://github.com/Worlize/WebSocket-Node\n. i solve my problem. wrong origin. thanks.\n. hi \nI solved the problem, but it was my own solution. I think you can be more compact.\n```\nfunction strencode( data ) {\n   return encodeURIComponent(JSON.stringify( data ) );\n }\nfunction strdecode( data ) {\n  return JSON.parse(decodeURIComponent(data).substr(1, decodeURIComponent(data).length-2));\n}\n```\nthanks.\n. option you want to use. If you want to insert the html file (github repository baslangic.html) to your web page. If you want to give a link to the web page. \nweb page: http://www.kip-software.org/2013/08/partial-js-kurulum/\neveryone wants to be able to update document, I keep in github.\n. Thank you. Tomorrow will complete the framework class.\n. Ok. :)\n. i'm solved my problem. :)\n. hi peter documentation complete? http://docs.partialjs.com\n. and \"node.exe --debug-brk=60157 debug.js\" this command not work. only \"------------> PID: 6336\"  write on console and holding.\n. 1.5.3 peter.\n. oh sorry :)\n. Ok. Thanks.\n. Thanks for quick response peter. How to read this change list ? because controller.framework.config return undefined. i'm changed to controller.config worked.\nWhat do you think about a websocket authorization problem ?\n. My source structure;\ndefinitions/authorization.js\n``` javascript\nframework.once('load', function() {\nvar self = this;\nvar auth = self.module('auth');\n\nauth.onAuthorization = function(id, callback) {\n\n    var user = {};\n    if (id == 1) {\n        user.id = 1;\n        user.kulAdi = \"admin\";\n        user.sifre = \"123\";            \n        callback(user);\n    }\n    else\n       callback(false);\n};\n\nauth.options.expireSession = 480;\nauth.options.expireCookie = 10;\n\n});\n```\ncontrollers/ws.js\n``` javascript\nexports.install = function (framework) {\n    framework.route('/sshvac', view_homepage);\n    framework.websocket('/', sshwebsocket, ['json'], ['ssh'], ['*']);\n}\nfunction view_homepage() {\n    var self = this;\n    self.layout(\"\");\n    self.view('sshvac');\n}\nfunction sshwebsocket() {\n}\n```\ncontrollers/default.js\n``` javascript\nexports.install = function (framework) {\n    framework.route('/', view_homepage, ['authorize']);\n    framework.route('/', loginOlmadan);\n};\nfunction view_homepage() {\n    var self = this;\n    self.view('homepage');\n}\nfunction loginOlmadan() {\n    var self = this;\n     self.layout(\"\");\n     self.view('loginolmadan');\n}\n```\nviews/sshvac.html\n``` html\n<!DOCTYPE html>\n\n\n\nDeneme\n    @{js('term.js/term.js')}\n\n\n\n\n\n    var socket = null;\n    socket = new WebSocket('ws://127.0.0.1:8029/', 'ssh');\n\n\n\n```\ni'm request \"http://127.0.0.1:8029/sshvac\"\ngetting this error;\nReferenceError: req is not defined ReferenceError: req is not defined\n    at WebSocketClient.protocol (/var/www/vw_kodlar/client/generator_web/node_modules/total.js/index.js:5:31885)\n    at WebSocketClient.prepare (/var/www/vw_kodlar/client/generator_web/node_modules/total.js/index.js:6:914)\n    at EventEmitter.Framework._upgrade_continue (/var/www/vw_kodlar/client/generator_web/node_modules/total.js/index.js:3:951)\n    at /var/www/vw_kodlar/client/generator_web/node_modules/total.js/index.js:3:809\n    at EventEmitter.Users._onAuthorization (/var/www/vw_kodlar/client/generator_web/modules/auth.js:44:9)\n    at EventEmitter.authorization [as onAuthorization] (/var/www/vw_kodlar/client/generator_web/modules/auth.js:273:15)\n    at EventEmitter.Framework._upgrade_prepare (/var/www/vw_kodlar/client/generator_web/node_modules/total.js/index.js:3:540)\n    at EventEmitter.Framework._upgrade (/var/www/vw_kodlar/client/generator_web/node_modules/total.js/index.js:2:31827)\n    at Server.<anonymous> (/var/www/vw_kodlar/client/generator_web/node_modules/total.js/index.js:2:21383)\n    at Server.EventEmitter.emit (events.js:106:17)\nThanks.\n. I downloaded new auth module and same error.\nhttps://github.com/totaljs/modules/blob/master/auth/v1.00/auth.js\n. my total.js version v1.6.1\n. Problem only websocket request.\n. I have example but so complex.\n. Thanks peter.\n. Hi peter;\nI'm download latest version from github and test again. i'm getting same error.i'm prepare simple example. Please check this example how's wrong.\nhttps://github.com/KiPSOFT/totaljswstest\nThanks.\n. Great working. Thanks peter.\n. yes. \nF.websocket('/comm', comm, {flags: ['json'], origin: ['*']});\n. oh sorry. thanks. i'm trying to now.\npeter my advice, you add version changes in docs.\n. Oh sorry peter for missing information. func is apache proxy reverse definition. any /func request to total.js server. so same url.\n. this only apply to upload request?  beacuse i have almost 200 route and working properly one year ago.\n. i'm trying.\n. this time each request 403 returns.\n. i'm test new example behind on apache and non apache working properly. i dont understand. i'm searching problem my project. sorry.\n. i found it peter. (i spent 3 hours)\nyou know i'm added this code in auth module;\n```\n self.onAuthorize(id, function(user) {\n        if (!user || !options.autoLogin) {\n            res.cookie(options.cookie, '', new Date().add('d', -1));\n            callback(false);\n            return;\n        }\n\n        user.yetkiler.forEach(function(item) {\n            flags.push('@' + item.yetki_id);\n        });\n\n```\nthis code add user permissions as role to route. my upload route without any role although return 404. i'm remove this code in auth module;\nuser.yetkiler.forEach(function(item) {\n                flags.push('@' + item.yetki_id);\n            });\nworking perfect. what do you think ? this is a bug ?\n. Sure framework.route ('/crm/dosyaYukle', ['upload'], 500000);\n. Sure framework.route ('/crm/dosyaYukle', ['upload'], 500000);\n. Sure   \nframework.route ('/crm/dosyaYukle', ['upload'], 500000);\n. i've test behind apache and not behind apache. problem reason not apache. i sent test project your e-mail. please test this steps;\n1. open url and select upload files. you see request return 200 in chrome developer tools \n2. click login button and try again upload file, you see request return 404 error.\n3. mark this code;\nflags.push('@1420');\nin definitions/default.js.\n4. try again upload file you see request return 200.\n. ",
    "goldalworming": "the second one..\nis partial.js support mysql and redis??\n. the problem is, I don't have any clue to run the example\nuser@user-UL30VT:~$ cd programming/nodejs/partial.js-master/examples/paging/\nuser@user-UL30VT:~/programming/nodejs/partial.js-master/examples/paging$ npm install partial.js\nnpm WARN install Refusing to install partial.js as a dependency of itself\nuser@user-UL30VT:~/programming/nodejs/partial.js-master/examples/paging$ sudo npm install partial.js\n[sudo] password for arief: \nnpm WARN install Refusing to install partial.js as a dependency of itself\nuser@user-UL30VT:~/programming/nodejs/partial.js-master/examples/paging$ sudo npm install -g partial.js\nnpm http GET https://registry.npmjs.org/partial.js\nnpm http 304 https://registry.npmjs.org/partial.js\n/usr/local/bin/partial.js -> /usr/local/lib/node_modules/partial.js/bin/partial\nnpm WARN package.json cookie-signature@1.0.1 No repository field.\nnpm WARN package.json fresh@0.1.0 No repository field.\nnpm WARN package.json methods@0.0.1 No repository field.\nnpm WARN package.json range-parser@0.0.4 No repository field.\nnpm WARN package.json dateformat@1.0.2-1.2.3 No repository field.\nnpm WARN package.json connect-redis@1.4.5 No repository field.\nnpm WARN package.json uglify-js@2.2.4 'repositories' (plural) Not supported.\nnpm WARN package.json Please pick one as the 'repository' field\nnpm WARN package.json bytes@0.2.0 No repository field.\nnpm WARN package.json pause@0.0.1 No repository field.\nnpm WARN package.json uid2@0.0.2 No repository field.\nnpm WARN package.json node-sassy@0.0.1 No repository field.\nnpm WARN package.json when@1.3.0 'repositories' (plural) Not supported.\nnpm WARN package.json Please pick one as the 'repository' field\nnpm WARN package.json sprintf@0.1.1 No repository field.\nnpm WARN package.json dirty@0.9.7 No repository field.\nnpm WARN package.json policyfile@0.0.4 'repositories' (plural) Not supported.\nnpm WARN package.json Please pick one as the 'repository' field\nnpm WARN package.json eyes@0.1.8 No repository field.\nnpm WARN package.json mime@1.2.2 No repository field.\nnpm WARN package.json github-url-from-git@1.1.1 No repository field.\nnpm WARN package.json assert-plus@0.1.2 No repository field.\n. fyi, I've installed partial.js globally before and run mywebsite example without problem...\nbut I don't know how to run other the examples\nthis is my version\n$partial.js -version\n1245\n. how to run it??\nnode index\nnode index.js\ngive this error\nmodule.js:340\n    throw err;\n          ^\nError: Cannot find module 'partial.js'\n    at Function.Module._resolveFilename (module.js:338:15)\n    at Function.Module._load (module.js:280:25)\n    at Module.require (module.js:364:17)\n    at require (module.js:380:17)\n    at Object. (/home/arief/programming/nodejs/partial.js-master/examples/paging/index.js:1:79)\n    at Module._compile (module.js:456:26)\n    at Object.Module._extensions..js (module.js:474:10)\n    at Module.load (module.js:356:32)\n    at Function.Module._load (module.js:312:12)\n    at Function.Module.runMain (module.js:497:10)\n/programming/nodejs/partial.js-master/examples/paging$ partial.js\npartial.js: error / directory is not empty\n. thanks a lot\n. I failed to run async examples..\n408: Request Timeout in web browser \nand \nwaiting 1 complete\nwaiting 2 complete\nin console...what is it async??\n. I think flush is partial content but sending it without waiting after all part finishing the execution..\nor can you give example partial content using 'get started examples'?.\nI think it will closer to real world app.\nbecause we often separate header query execution, body and the rest of page..\nin get started examples, it's only separate the template..not the execution..\nhttp://www.partialjs.com/get-started/\n. thank you..\n. the best framework examples I've ever seen is tornadoweb examples..\nalthough I it doesn't give file structure example...\n. sorry for OOT but do you have examples of login with google, twitter, facebook, etc..\nor it's better for me to use other library like everyauth??\n. I hope it won't take a long time..\n. thanks a lot...\n. thanks, I've updated partial.js..\nI tried everyauth, but some stackoverflow's QA direct me to passport..(http://stackoverflow.com/questions/11974947/everyauth-vs-passport-js)\nI think use passport would better for example..\n. ok,no problem..thanks..\nand do you have any explanation about #.js \nin auth examples thereis onValidation function and onAuthorization but when then function called\nif self.validate will call onValidation..so when onAuthorization called..\n. can we make own flag like 'admin' / 'notadmin' or anything else??\n. that's very neat...thank you..\n. Hi, I want to back on flushing issue..\nafter adding timeout in async example..and try some examples..\nflushing is like server-sent-event / websocket send data to client with template..but using sse / websocket will give me browser support problem..do you have any alternative??\n. I don't understand pooling between SSE/Websocket and XHR..does it mean partial.js not support XHR and Websocket in one app??\n. I thought redis would be enough as database to make communication between them..Does it wrong?\nor what kind shared communication do you mean?\ndoes socket.io library doesn't work with partial? (https://github.com/petersirka/partial.js/issues/20)\n. @Igruz : how do you write the socket.io route and the function??\n. ok I'll try it..\n. Hi, for google auth..is this library fit with partial.js??\nhttps://github.com/ciaranj/node-oauth \nor is it too old?\nI read this article use it...http://www.jonathanbroquist.com/blog/2013/10/building-a-google-calendar-booking-app-with-mongodb-expressjs-angularjs-and-node-js-part-1/\n. hello, sorry for trigger old issues\nwhat do you think about this example\nis it possible to make it in total.js\nhttp://neethack.com/2013/01/express-bigpipe-experiment/\n. it works without error any error..but when I use setInterval, the text not shown. I use setInterval as heavy works replacement\n. I've added that code before..\n. I think I should minify all library before put in partial.js..\nthanks..\n. as usual I just sudo npm install -g partial.js doesn't it automatically update to latest version??\nI mean provide the schema file..so we can import it manually using phpmyadmin..\n. ok thanks..I got two problems in mysql example..\nfirst..I don't know how to select certain database\nit usually use \nframework.database = function (name) {\n    // Create a connection to MySql Server and Database\n    return new mysql.createConnection({\n        host: 'localhost',\n        port: 3306,\n        database: name,\n        user: 'root',\n        password: 'root'\n    });\n};\nso we can put database name from controller.\nwith latest update, I don't know how to put database name to select\nvar pool  = mysql.createPool({ host: 'localhost', user: 'root', password: 'root'});\nsecond is \nI don't know how to display the value from mysql. this is my print screen\n\nI know you suggest me to read http://docs.partialjs.com/how-does-it-work/templates/\nbut it just doesn't work..I have 3 rows in my database\n. ok, that works...thanks...\nI think it's very good to give mysql & postgres example...\nthank's..\n. wow, thank you..it's great..\n. POST in angular is a bit different, it send to JSON to server..\nin PHP we use\n$arraydata = json_decode(file_get_contents('php://input'));\n    for ($i=0; $i < count($arraydata); $i++) { }\nbut I haven't tried partial.js yet..\n. ## /pipe/page errors\nError: Can't set headers after they are sent. Error: Can't set headers after they are sent.\n    at ServerResponse.OutgoingMessage.setHeader (http.js:692:11)\n    at ClientRequest. (/home/arief/programming/nodejs/showcase-v1310/showcase/node_modules/partial.js/index.js:22:31877)\n    at ClientRequest.g (events.js:175:14)\n    at ClientRequest.EventEmitter.emit (events.js:95:17)\n    at HTTPParser.parserOnIncomingClient as onIncoming\n    at HTTPParser.parserOnHeadersComplete as onHeadersComplete\n    at Socket.socketOnData as ondata\nat TCP.onread (net.js:525:27)\nError: Parse Error Error: Parse Error\n    at Socket.socketOnData (http.js:1584:20)\nat TCP.onread (net.js:525:27)\n. I tried upload image using this plugin example http://angular-file-upload.appspot.com/\nbut the server return 404 not found..\n. should I npm install graphicsmagick??\n. I used to install using apt-get..is it ok? or I have to install the latest one??\n. it works..cool\nthanks a lot..\n. ok, I'll try to put hash in cookies and access it..\n. I tried to move data outside sub folder, but accessing data failed too..\n. I've add both config file and add config but it still not working..\ndoes the framework automatically load config file??\n. it works..thanks a lot..\n. so definition override existing framework attributes/method not add new..\nwhen I need add new method I must put in modules..is that right?\n. it works great..thanks..\n. what's happen partial.js-modules not found in github..\n. # \nPID          : 4970\nnode.js      : v0.10.17\npartial.js   : v1313\nName         : partial.js\nVersion      : 1.01\nAuthor       : \nDate         : 2014-01-08 23:41:58\nMode         : debug\nit's 1.3.1..\n. still got the problem\narief@arief-UL30VT ~/programming/nodejs/partial.js-modules-master/dot/example $ sudo npm install partial.js\n[sudo] password for arief: \nnpm http GET https://registry.npmjs.org/partial.js\nnpm http 304 https://registry.npmjs.org/partial.js\npartial.js@1.3.1-3 ../../../../../node_modules/partial.js\narief@arief-UL30VT ~/programming/nodejs/partial.js-modules-master/dot/example $ node index\nPID          : 6997\nnode.js      : v0.10.17\npartial.js   : v1313\nName         : partial.js\nVersion      : 1.01\nAuthor       : \nDate         : 2014-01-09 05:36:45\nMode         : debug\nhttp://127.0.0.1:8000/\nhttp://127.0.0.1:8000/\nTypeError: Cannot read property 'contentType' of undefined TypeError: Cannot read property 'contentType' of undefined\n    at Object.Controller.view (eval at  (/home/arief/node_modules/partial.js/index.js:22:15139), :1:1204)\n    at Object.view_homepage (/home/arief/programming/nodejs/partial.js-modules-master/dot/example/controllers/default.js:7:7)\n    at Subscribe._execute (/home/arief/node_modules/partial.js/index.js:24:18952)\n    at Subscribe.execute (/home/arief/node_modules/partial.js/index.js:24:17239)\n    at Subscribe.prepare (/home/arief/node_modules/partial.js/index.js:24:18410)\n    at Subscribe._end (/home/arief/node_modules/partial.js/index.js:24:20585)\n    at IncomingMessage.EventEmitter.emit (events.js:92:17)\n    at _stream_readable.js:920:16\nat process._tickCallback (node.js:415:13)\n. I downloaded latest partial.js modules and it works..thank you..\n. shouldn't you write \nvar foo = 0,\nvar bar = 10;\n. if I use lint it will return missing semicolon\n. I've tried it..\nI use examples/views/ for base then move all views into one folder named base\nin default view, it works without problem with this code\nfunction view_homepage() {\n    var self = this;\n    self.repository.title = 'Welcome';\n    self.layout('base/_layout');\n    self.view('base/homepage');\n}\nfunction view_homepage2() {\n    var self = this;\n    self.layout('base/_layout_new');\n    self.repository.title = 'Welcome';\n    self.view('base/homepage');\n}\nbut products controller and users return error\nfunction view_products() {\n    var self = this;\n    self.repository.title = 'Products';\n// this view is loaded by the controller name: /views/products/index.html\nself.layout('base/_layout');\ncontroller.view('base/index');\n}\nError: View \"/products/basic/index\" not found. Error: View \"/products/base/index\" not found.\ncan I modified view url of controller to base/products/index?\n. return this error\nReferenceError: controller is not defined ReferenceError: controller is not defined\n    at Object.view_products (/home/arief/web/examples/views/controllers/products.js:11:2)\n    at Subscribe._execute (/home/arief/node_modules/total.js/index.js:3:19370)\n    at Subscribe.execute (/home/arief/node_modules/total.js/index.js:3:17657)\n    at Subscribe.prepare (/home/arief/node_modules/total.js/index.js:3:18828)\n    at Subscribe._end (/home/arief/node_modules/total.js/index.js:3:21003)\n    at IncomingMessage.EventEmitter.emit (events.js:92:17)\n    at _stream_readable.js:920:16\nat process._tickCallback (node.js:415:13)\n. it works, thanks..\nsorry, I don't understand ~ in self.view('~admin'); before.\nand I try to add to homepage @{template('additional', model)}\nwith templates/additional.html inside view..how to call it?\nI tried to move templates/additional.html in same level as view but it's not shown either..\n. in example \nWelcome!\npartial.html in view \u2192 @{view('partial')}\nI think the view not load {view('partial')}\n\nafter the right arrow the text 'This is partial view content!' not shown..\nmaybe that's why it doesn't work..\nmaybe I'll try using mysql template that using template works well..\n. \n. can I change base folder of templates?? \nI plan to move it inside folder view/base/\n. I just fresh download from total.js github repo..\nThe problem is the templates folder is dynamic based on users choice..\nuser can defined their own theme..so the path of view, templates,css and js would be dynamic depend on user choice..\nis it possible??\n. something like tumblr..user select or upload template for their site..\n. ok, after read configuration, I think it's possible\nso, when web requested..I must set framework.config['view'] based on database value..\nthank you,,\n. this is my solution of multiple template\nfunction view_homepage() {\n    var self = this;\n    self.repository.title = 'Welcome';\n    framework.config['directory-views']='/views/'+self.req.host;\n    self.view('homepage');\n}\n. so I should put loop inside a connection to database..\nI tried to use handler socket \n        for (var i = 400000 - 1; i >= 0; i--) {\n        con.on('connect', function() {\n            con.openIndex('test', 'Model', 'PRIMARY',\n                      ['label','description'], function(err, index) {\n```\n        if (err) {\n          console.log(err);\n          con.close();\n          return;\n        }\n        // arrObj.push(i);\n        if(i===0){\n         console.log(new Date());\n         console.log('selesai');\n        }\n     index.insert(['tes','{\"location\":\"Indonesia\",\"pptk\":\"Merry\",\"usage_for\":\"testing\"\"id\":\"196\",\"parentId\":0,\"leaf\":false}'], function(err,results) {\n        if (err) {\n          console.log(err);\n          con.close();\n          return;\n        }\n          // self.json(arrObj);\n          con.close();\n        });\n  });\n});\n};\n\n. is it node.js function or total.js??\n.\nvar con = hs.connect({port: 9999});\n```\ndefinition\nvar hs = require('node-handlersocket');\nframework.db = function() {\n    return hs\n}\nframework.eval(function() {\n    Controller.prototype.db = function() {\n        return framework.db.apply(framework, arguments);\n    };\n});\nI'm trying to use mysql library and handler socket..\n. how to put port number in function??\n. I don't understand using this definition\nbecause node handler use different port for query and insert, update, delete..\ndo you use recursive to avoid eventlimitter??\n. thinking async..should I put async self.async or self.await when calling function like querying database?\n. ok, thank's a lot :+1: \n. this is using sudo\nnpm http GET https://registry.npmjs.org/total.js\nnpm http 304 https://registry.npmjs.org/total.js\nnpm http GET https://registry.npmjs.org/total.js/-/total.js-1.2.0.tgz\nnpm http 200 https://registry.npmjs.org/total.js/-/total.js-1.2.0.tgz\nnpm ERR! Error: shasum check failed for /home/arief/tmp/npm-9532-VgEzvl5A/1392709185393-0.025321756722405553/tmp.tgz\nnpm ERR! Expected: 95cc9fcd595f35075f68545a29c4b027f92dd091\nnpm ERR! Actual:   8bbc7668623c0d59a20a3dd92f4cf7987944a9c8\nnpm ERR!     at /usr/lib/node_modules/npm/node_modules/sha/index.js:38:8\nnpm ERR!     at ReadStream. (/usr/lib/node_modules/npm/node_modules/sha/index.js:85:7)\nnpm ERR!     at ReadStream.EventEmitter.emit (events.js:117:20)\nnpm ERR!     at _stream_readable.js:920:16\nnpm ERR!     at process._tickCallback (node.js:415:13)\nnpm ERR! If you need help, you may report this log at:\nnpm ERR!     http://github.com/isaacs/npm/issues\nnpm ERR! or email it to:\nnpm ERR!     npm-@googlegroups.com\nnpm ERR! System Linux 3.8.0-19-generic\nnpm ERR! command \"/usr/bin/node\" \"/usr/bin/npm\" \"install\" \"total.js\"\nnpm ERR! cwd /home/arief/web/examples-master\nnpm ERR! node -v v0.10.17\nnpm ERR! npm -v 1.3.8\nnpm ERR! \nnpm ERR! Additional logging details can be found in:\nnpm ERR!     /home/arief/web/examples-master/npm-debug.log\nnpm ERR! not ok code 0\n. what is your npm version please??\n. I've tried upgrade my npm\nsudo npm cache clean -f\nsudo npm install -g n\nsudo n stable\nstill got problem\nnpm http GET https://registry.npmjs.org/total.js\nnpm http 200 https://registry.npmjs.org/total.js\nnpm http GET https://registry.npmjs.org/total.js/-/total.js-1.2.0.tgz\nnpm http 200 https://registry.npmjs.org/total.js/-/total.js-1.2.0.tgz\nnpm ERR! Error: shasum check failed for /home/arief/tmp/npm-5120-d_Z6gPo1/1392719871039-0.019332390278577805/tmp.tgz\nnpm ERR! Expected: 95cc9fcd595f35075f68545a29c4b027f92dd091\nnpm ERR! Actual:   8bbc7668623c0d59a20a3dd92f4cf7987944a9c8\nnpm ERR! From:     https://registry.npmjs.org/total.js/-/total.js-1.2.0.tgz\nnpm ERR!     at /usr/local/lib/node_modules/npm/node_modules/sha/index.js:38:8\nnpm ERR!     at ReadStream. (/usr/local/lib/node_modules/npm/node_modules/sha/index.js:85:7)\nnpm ERR!     at ReadStream.EventEmitter.emit (events.js:117:20)\nnpm ERR!     at stream_readable.js:920:16\nnpm ERR!     at process._tickCallback (node.js:415:13)\nnpm ERR! If you need help, you may report this _entire log,\nnpm ERR! including the npm and node versions, at:\nnpm ERR!     http://github.com/isaacs/npm/issues\nnpm ERR! System Linux 3.8.0-19-generic\nnpm ERR! command \"/usr/local/bin/node\" \"/usr/local/bin/npm\" \"install\" \"total.js\"\nnpm ERR! cwd /home/arief/web/examples-master\nnpm ERR! node -v v0.10.25\nnpm ERR! npm -v 1.3.24\nnpm ERR! \nnpm ERR! Additional logging details can be found in:\nnpm ERR!     /home/arief/web/examples-master/npm-debug.log\nnpm ERR! not ok code 0\n. it works now..thanks a lot..\n. how to config nginx so can accept from our client domain existed in database..\n. thank you..I'll try it after finish my application progress..\n. sorry I just tried\nI got 403 Forbidden in browser..\nI searched in google and it's usually about file permission..\n. should I add some config in /etc/nginx/sites-available/default ?\n. this is my working config\n```\n    # NGINX CONFIG\n    worker_processes  1;\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n\n    include       mime.types;\n    default_type  application/octet-stream;\n    sendfile        on;\n\n    keepalive_timeout  65;\n\n    server {\n        listen      80;\n        server_name www.mywebsite.com;\n        server_name subunit.mywebsite.com;\n        server_name subunit2.mywebsite.com;\n        server_name www.secondwebsite.com;\n        charset     utf-8;\n\n        location / {\n            proxy_set_header   Host             $http_host;\n            proxy_set_header   X-Forwarded-For  $remote_addr;\n            proxy_set_header   X-NginX-Proxy    true;\n            proxy_pass         http://127.0.0.1:8000;\n            proxy_redirect     off;\n            break;\n        }\n\n    }\n\n    server {\n        listen      80;\n        server_name app.mywebsite.com;\n        charset     utf-8;\n\n        location / {\n            proxy_set_header   Host             $http_host;\n            proxy_set_header   X-Forwarded-For  $remote_addr;\n            proxy_set_header   X-NginX-Proxy    true;\n            proxy_pass         http://127.0.0.1:8001;\n            proxy_redirect     off;\n            break;\n        }\n\n    }\n}\n\n```\n@proxy not working for me\n. sorry..my mistake made eval function..\nthank you\n. none of redis operation works \nTypeError: Cannot call method 'set' of undefined TypeError: Cannot call method 'set' of undefined\n. I've tried some alternative\nframework.eval(function() {\n    Controller.prototype.rds = redis;\n});\nin controller\n    client = self.rds.createClient();\n    client.on(\"error\", function (err) {\n        console.log(\"Error \" + err);\n    });\n    client.hkeys(\"localhost:8000\", function (err, replies) {\n        console.log(replies.length + \" replies:\");\n        replies.forEach(function (reply, i) {\n            console.log(\"    \" + i + \": \" + reply);\n        });\n        client.quit();\n    });\nit a bit confusing to combine total.js with another libary\ndefinition :\nglobal.redis = redis;\ncontroller :\n    client = redis.createClient();\n    client.on(\"error\", function (err) {\n        console.log(\"Error \" + err);\n    });\n    client.hkeys(\"localhost:8000\", function (err, replies) {\n        console.log(replies.length + \" replies:\");\n        replies.forEach(function (reply, i) {\n            console.log(\"    \" + i + \": \" + reply);\n        });\n        client.quit();\n    });\nthe last one works but I don't know if you agree with this approach or not..\nyou usually make better approach of library that works better for total.js..\n. does additional modules dot.js support templating like total.js template?\nI've tried it..at least nested if works well\n@{if repository.lang}\n    @{if repository.lang==='id'}\n        id\n    @{else}\n        @{if repository.lang==='en'}\n            en\n        @{else}\n            another lang\n        @{endif}\n    @{endif}\n@{else}\n    no lang\n@{endif}\n. is it possible to add case / switch in view??\n. it makes dba confusing to build query.. to much @ makes @_@ :confused: :D\nselect * from post where category='@{model.name}'\n@{if (!model.order&&!model.direction)}\n    order by id asc\n@{else}\n    order by @{model.order} @{model.direction}\n@{endif}\n@{if (model.limit)}\n    @{if (model.start)}\n        limit @{model.start},@{model.limit}\n    @{endif}\n    @{if (!model.start)}\n        limit @{model.limit}\n    @{endif}\n@{else}\n    limit 1\n@{endif}\n. yes..it works..\n. ok..\nit works..\nthank you\n. how to read cookies from localhost (another domain)? I think it's impossible..\n. sorry..I mean to use auth session for multiple domain\n. use this module to create auth cookies\n        var auth = self.module('authorization');\n    .\n    .\n    .\n    auth.login(self, user.id, user);\nhow to use itu for multiple domain / set for multiple domain)\n. I found framework.decrypt, do you provide any documentation using encrypt & decrypt in total.js controller?\nthis is decrypt & encrypt from beutify modules auth\n    var value = framework.decrypt(cookie, options.secret, false);\nframework.encrypt(value, self.options.secret)\n. is it bad idea?\nvar jugglingdb = require(\"jugglingdb\");\nglobal.jugglingdb = jugglingdb;\n. ok..I've found another solution\n```\nquery: function(ctrl,objmodel,callback) {\n    var self = ctrl, file = 'general', model=null;\n    if(objmodel){\n        model=objmodel;\n        if(model.file){file=model.file;}\n    }\n    framework.config['directory-views']='/query/';\n    var qrytxt = self.view(''+file, model, true);\nself.db(function(err, connection){\n    // Table schema = { Id: Number, Age: Number, Name: String };\n    connection.query(qrytxt, function(err, rows) {\n                            // console.log(rows);\n                                    // Close connection\n                                    connection.release();\n                                    if (callback && typeof(callback) === \"function\") {  \n                                           if (err) \n                                                callback(err,null);\n                                            else\n                                                callback(null,rows);\n                            }  \n    });\n\n});\n\n}\n```\nit works well..\nthank you..\n. thank's a lot..\n. I don't know how to put in existing project..I hope you deliver in npm soon..\n. sorry I have next problem, displaying date with date format using .format\nI have unixtime data from database, since data Date() in node.js return something like date in mysql..\nhow to fix it?\n. and model.created.format('dd-mm-yyyy') return  2014-03-21T02:05:59+07:00\n. no, my date return number of unixtime..I put from 1395575487863\nsorry I just got my internet back\n. ok..it works using helpers..\nthanks you..\nframework.helpers.date = function(data,format) {\n    if (format){\n        return new Date(data).format(format);   \n    }else{\n        return data;\n    }\n};\n. how to display month name as March or April in views?\n. or using pm2 like in this tutorial https://www.digitalocean.com/community/articles/how-to-use-pm2-to-setup-a-node-js-production-environment-on-an-ubuntu-vps??\n. no I don't set ip..\nI have found mysql problem..\nI asked about how to run index.js with error log\nshoul I use forever or pm2?\n. is it heroku services or use modules? what modules?\n. I've use pm2 to run the app..thank you\n. Hi peter, I have problem to deploy node.js application..\nif I run node index, app works well until I quit my ssh session..the application stop working\nif I user forever it return 404: Not Found..(I don't know why it's not found in main url)\n. if I run node index ... ... theoretically - OS closes all user applications. Do you have own VPS? \nyes I use own VPS\nif I user forever it return 404: Not Found ... 404 is from total.js? Do you use a proxy server? \nyes I use nginx, I don't know is it from node.js or not..\nhow to debug it?\n. \n\n. [solved]\ncd /folder/\nforever start index.js\nthanks a lot for your help\n. I've added xmlhttprequest like this issue https://github.com/totaljs/framework/issues/91\n$httpProvider.defaults.headers.common[\"X-Requested-With\"] = 'XMLHttpRequest';\n. this is request using $http.post, server cannot receive any data..\n\n. sent to your gmail..thanks a lot\n. my bad..sorry\n. I don't use nginx in remote server..maybe ngrok block request because of the header\n. this is both model, properties and prepare catch in controllers\n'updated'\n{ idauthor: 'admin',\n  kode: 'cb9f8ca4a',\n  type: 'blog',\n  lang: null,\n  created: 1396852273723,\n  updated: 1396854160957,\n  title: 'tesjfldsjfl',\n  intro: 'tesljfdljkl',\n  content: 'telsfjkldjfl',\n  status: 'post',\n  image: 'https://lh4.googleusercontent.com/-Cy0Q0XNN8po/U0Ivgjdz96I/AAAAAAAACeM/t1u7QAR6_84/w346-h260/codrops_collective_110.png',\n  images: null }\n[ 'id',\n  'idauthor',\n  'kode',\n  'type',\n  'lang',\n  'created',\n  'updated',\n  'title',\n  'intro',\n  'content',\n  'status',\n  'image',\n  'images' ]\n[Function]\n'created'\n{ idauthor: 'admin',\n  kode: '84b2ae45b',\n  type: 'blog',\n  lang: undefined,\n  created: 1396854207040,\n  updated: 1396854207040,\n  title: 'tost',\n  intro: 'tost',\n  content: 'tost',\n  status: 'post',\n  image: undefined,\n  images: undefined }\n[ 'id',\n  'idauthor',\n  'kode',\n  'type',\n  'lang',\n  'created',\n  'updated',\n  'title',\n  'intro',\n  'content',\n  'status',\n  'image',\n  'images' ]\n[Function]\n. no, I don't get it..\ndoesn't it validate model as object? I think my model is an object\nand it works fine when I validate insert \n. I've send minified version..I hope it there is no bug..\nthank you\n. my mistake when made default value, it should be\ngetData : function(post){\n                var obj2 = this.getObj();\n                for (var attrname in obj2) { \n                    if(post[attrname]){\n                        obj2[attrname] = post[attrname];                         \n                    }\n                }\n                return obj2;\n          },\n. ok..I'll looking for another way..\n. I use it as sql template and I often get query syntax problem because of compression :D \n. maybe the problem I don't put connection release before\n        self.db(function(err, connection){\n            var query = connection.query(querytext,  objDB, function(err, rows) {\n              // if (err) throw err;\n                                              connection.release();\n              if (err) {self.json({success:false,error:err});return};\n// console.log(rows.insertId);\n          self.json({success:true,data:{blog:rvm}});\n        });\n        // console.log(query.sql);\n    });\n. thank you\n. can you explain more about using worker since it's asynchronous..\nin controller code\nself.json(self.global.weather);\nit's call weather in definition or in workers?\nI think put text in xml is synchronous working, how to put it as order using workers..you usually use async or  recursive..\n. I'm on linux but .js is optional\n. maybe because my node.js version is 0.10.25\n. I've looking for ftp module, but haven't found yet..\nhow about downloading files from another hosts escpecially for templates and layout?\nsomething like curl\nthank you..\n. It is the latest total.js downloaded from github\n. I've download it and angular post still not working..\n. please try https://goldalworming.ngrok.com/ now..\nthe options works but post not\n\n. it's fake domain..\nplease use  https://goldalworming.ngrok.com/ \n. this is options works\n\nthis post flags\n\n. it works thanks a lot.. :+1: \nthis is my final code\n    exports.install = function(framework) {\n        framework.route('/test', test);\n        framework.route('/test', test2,['options']);\n        framework.route('/test', test3,['post','json']);\n    };\n```\nfunction test(){\n    var self = this;\nif (!self.cors('*', ['GET','POST'])) {\n    self.plain('Not allowed');\n    return;\n}\nconsole.log(self.get);\nconsole.log(self.post);\nself.json({success:'true'});\n\n}\nfunction test2(){\n    var self = this;\nif (!self.cors('*', ['GET','POST'])) {\n    self.plain('Not allowed');\n    return;\n}\nconsole.log(self.get);\nconsole.log(self.post);\nself.json({success:'true2'});\n\n}\nfunction test3(){\n    var self = this;\nif (!self.cors('*', ['GET','POST'])) {\n    self.plain('Not allowed');\n    return;\n}\nconsole.log(self.get);\nconsole.log(self.post);\nself.json({success:'true2'});\n\n}\n```\n. it return empty array..I don't think it has error..\nrc.zrange(['cust','0','-1'],function(err,data){\n    if (err){throw err; rc.quit();return;}\n    dl=data.length;\n    if(dl&&dl>0){\n        for (var i = 0,imax = dl; i < imax; i++) {\n            rc.hgetall('cust:'+data[i],function(err,datacust){\n                if (err){throw err; rc.quit();return;}\n                if(datacust!=null){\n                    datacust.id=data[objrows.length];\n                }\n                objrows.push(datacust);\n                showoff();\n            });                 \n        };\n    }\n});\nfunction showoff(){\n    if(objrows.length==dl){\n        rc.quit();\n        self.json(objrows);\n    }       \n}\nit works but I don't know it's good enough to handle another condition or not..\n. haha..please give me suggestion..\nI looking for example in internet but they usually use node-async.\ntotal.js has self.async but I don't know how to make it work..\n. redis client\n    var rc = redis.createClient();\nI use global redis like example in mongodb\n. TypeError: Cannot read property 'length' of undefined TypeError: Cannot read property 'length' of undefined\nwhere framework.global.rows come from?\nit seems impossible to pass i value to redis function nor fn_async..\n. it returns 408: Request Time-out\nI trace it and find out that second loop not executed\n. thank you very much..\n:100: \n. thanks, I've add the code but I don't know this code right or not framework.on('request-end', function(req, res) { \n  if(rc){rc.quit();}\n});\n. my mistake, sorry\n. this is proxy app\n            exports.install = function(framework) {\n                framework.route('/{param}', execute,['get']);\n                framework.route('/{param}', execute,['proxy']);\n            };\n```\n        function execute(param){\n                    var self = this;\n                    fs.readFile('resources/'+param,'utf8',function(err,data){\n                        if (err){                              \n                            console.log({err:'param not found',param:param});\n                            self.json({success:false,rows:null,err:'notfound'});\n                        }\n                        try {\n                                obj = JSON.parse(data);\n                                      fs.readFile('query/'+obj.queryfile+'.sql','utf8',function(err,data){\n                                                if (err){                              \n                                                    console.log({err:'file query not found',filename:obj.queryfile});\n                                                    self.json({success:false,rows:null,err:'notfound'});\n                                                }\n                                        var fn = dot.template(data);\n                                        var qrytxt = fn({get: self.post.get, post:self.post.post,helpers:framework.helpers});\n\n                                        if(obj.query){\n                                              console.log(qrytxt);\n                                              if (qrytxt!=='false'){\n                                                  self.db(function(err, connection){\n                                                        if (err){self.json({success:false});throw err;}\n                                                        connection.query(qrytxt, function(err, rows) {\n                                                              if (err){connection.release(); self.json({success:false});throw err;}\n                                                              connection.release();\n                                                              if(obj[\"typequery\"]&&obj[\"typequery\"]!='select'){\n                                                                      self.json({success:true,rows:self.post.post});\n                                                              }else{\n                                                                      self.json({success:true,rows:rows});\n                                                              }\n                                                        });\n                                                  });                                            \n                                              }\n                                              else{\n                                                    self.json({err:'notallowed',msg:'wrong parameter'});\n                                              }\n                                        }\n                                        else{                                      \n                                              self.json({success:true,rows:qrytxt});\n                                        }\n                                  });\n                    } catch (e) {\n                      // An error has occured, handle it, by e.g. logging it\n                      console.log('parse failed');\n                    }\n                });    \n    }\n\n```\nI have another app that use more than 100MB RAM now..\n. I have >100mb for only 7D\nand 69mb for angularjs app\ndoes code console.log make this problem?\n. clean code increase 0.511 mb in first hit, but not increase any memory at the next refresh..\n. in 1st - 4th hit..memory increase..but I found peak of memory usage after the 4th..\nI don't know it will gain more memory after number of access or not.\n. every single line of code increase various memory usage but I didn't found that memory usage decrease...\n. it works..I forgot upload flags..\nthank you\n. can I limit memory usage of upload handler without limit file size like in https://github.com/felixge/node-formidable?\nor use the library as file handler in total.js?\n. doesn't it limit file size upload?\n. I need to make upload file interface that could handle any size of file..\nbecause I cannot limit their file to upload..in formidable the Idea is limit the memory size to handle it, not file size.\nI read this tutorial ://code.tutsplus.com/tutorials/how-to-create-a-resumable-video-uploader-in-nodejs--net-25445..but it's for socket.io\n. I've fix it..in case code quality is not very good..total.js compress get hard to debug..\nsomething like var a = function(){} <-- this return error in browser if total.js minify it and sometimes it's hard to find because of missing ';'\n. I've added fs in definitions/requirement.js\nvar fs = require(\"fs\");\nglobal.fs = fs;\n. @petersirka does total.js 1.6.1 not supported require in definitions anymore?\n. how to handle this error?\nI tried this but it doesn't work\ntry {var pages = self.view(tplfile,result,true);} catch (e){\n            self.error(e);\n            self.content('Contact Administrator. something wrong with the template.', 'text/html');\n            return;\n        }\n. I've use itu to handle if template not found..\n            var pages = self.view(tplfile,result,true);\n            if(pages===null){\n                self.content('template is not found. Contact Administrator', 'text/html');\n                return;\n            }\nhow to distinguish template is not exist and compile template with data failed?\n. why don't you use @{section('title')} in layout \nand set it from index.html or any page\n@{section title}\n    @{resource(model.lang, 'title')}\n@{end}\n. I still get error like above\n. v0.10.31\n. ok, I've updated to version 0.12.5\nnow get new error\n======= 2015-07-01 16:26:21: TypeError: Cannot set property '$$query' of undefined TypeError: Cannot set property '$$query' of undefined\n    at /home/lmvm/umrota/controllers/default.js:35:34\n    at Pool. (/home/lmvm/node_modules/mysql/lib/Pool.js:51:14)\n    at Handshake.Sequence.end (/home/lmvm/node_modules/mysql/lib/protocol/sequences/Sequence.js:96:24)\n    at Handshake.Sequence.OkPacket (/home/lmvm/node_modules/mysql/lib/protocol/sequences/Sequence.js:105:8)\n    at Protocol._parsePacket (/home/lmvm/node_modules/mysql/lib/protocol/Protocol.js:270:23)\n    at Parser.write (/home/lmvm/node_modules/mysql/lib/protocol/Parser.js:77:12)\n    at Protocol.write (/home/lmvm/node_modules/mysql/lib/protocol/Protocol.js:39:16)\n    at Socket. (/home/lmvm/node_modules/mysql/lib/Connection.js:82:28)\n    at Socket.emit (events.js:107:17)\n    at readableAddChunk (_stream_readable.js:163:16)\nwhere should I put this code? in definition or controller?\nConnection.prototype.$$query = function(query, parameters) {\n        // this === connection\n        var self = this;\n        return function(callback) {\n            // callback must be the last argument\n            self.query(query, parameters, callback);\n        };\n    };\n. ======= 2015-07-02 12:41:22: framework.install('controller', '') ---> SyntaxError: /home/lmvm/xxxx/controllers/default.js:35\n    async(function () {\n                   ^\nUnexpected token * /home/lmvm/xxxx/controllers/default.js:35\n    async(function () {\n                   ^\nSyntaxError: Unexpected token *\n    at exports.runInThisContext (vm.js:73:16)\n    at Module._compile (module.js:443:25)\n    at Object.Module._extensions..js (module.js:478:10)\n    at Module.load (module.js:355:32)\n    at Function.Module._load (module.js:310:12)\n    at Module.require (module.js:365:17)\n    at require (module.js:384:17)\n    at EventEmitter.Framework.install (/home/lmvm/node_modules/total.js/index.js:1:30669)\n    at /home/lmvm/node_modules/total.js/index.js:1:24885\nat Array.forEach (native)\nPID          : 38367\nnode.js      : v0.12.5\ntotal.js     : v1.8.0\nstill go error\nI'll try sqlagent.\n. my bad, thanks a lot it works.\ndoes sqlagent need harmony too?\n. @petersirka, how to make sure the connection release or close in sync method?\nit tried this code\n```\nself.db(function(err, connection){\n  async(function *() {\n    connection.release();\n    obj.post = yield sync(connection.$$query(\"select * from post where ?\", {id:'1'}))();\n    obj.tes = yield sync(connection.$$query(\"select * from post where ?\", {id:'1'}))();\nself.json({rows: obj});\n\n})(self);    \n});\n```\nand it show complete result. that means connection not release before both two query or it doesn't disconnect at all\n. thanks a lot\n. ",
    "jfelipesilva": "I tested on IE 10, but I really needed on all of them.  Well, I am going to try Socket.io to see if I can get it to work on all browsers that people still use theses days.  Thanks for your support!\n. ",
    "nonameplum": "I reviewed your code deeper and I found answer to my question:\n[index.js]\n```\nframework.onCompileCSS = function (filename, content) {\n    return content;\n};\nframework.onCompileJS = function (filename, content) {\n    return content;\n}\n```\nHowever I think you could add configuration values to have quick access to disable minifier.\n. Hi @petersirka \nCould You explain what You mean in \u201eLESS\u201c OR \u201eSASS\u201c or \u201eAUTO-VENTOR-PREFIXES\u201c?\nI am looking at Your framework for about 1 day and don't know well Your framework concepts.\nI wish You share some more detailed documentation :) I don't see for example how to avoid adding \"name\" value declared in config-debug to title of site which is not home site. Generaly more explanation about @meta etc. syntax welcome :)\nCompressed CSS is not the big problem, but compressed JavaScript is, becouse of hard of debugging client side JavaScript in web browser.\nThanks\n. ",
    "capslow": "I am having a problem with the javascript compressor. The message I get is the following one: JavaScript compressor ---> ReferenceError: c is not defined ReferenceError: c is not defined.\nI don't know how to solve this, I tries everything, an even if I put the javascript code in a .min.js file I get this message. Is there any possibility to disable the javascript compressor now?\n. Hi @petersirka ,\nThank you for answering so quick. Finally I was able to solve the problem, I think that I was making a mistake in the javascript or something like that.\nSorry for the inconveniences and thanks for developing such a  great tool. \n. I have used the second method and is working perfectly. Thanks for your attention.\n. Thank you, I will try it tomorrow and I will tell you if it works.\n. Finally I am not developing that functionally. Thanks for all your support.\n. ",
    "bitcity": "@petersirka  What are the pros & cons of using JSON flag vs XHR flag?\n. ",
    "sahilsethi16": "Hii,\nCan anyone tell me how to insert image file in the request payload which is stored in local file system???\nThanks in advance. \n. I have to send some image in my ajax request to server. my question is how to insert it its request payload\nsnippet is \nvar settings = {\n  \"url\": \"https://servername.com/profiles/photo.do?key=a16895d8-2fe8-46d7-9658-8194d9b2ecc8\",\n  \"method\": \"PUT\",\n  \"headers\": {\n    \"authorization\": \"Basic c2FoaWwuc2V0aGk6V2VsY29tZUAwNw==\",\n    \"content-type\": \"image/jpeg\"\n  }\n}\nNow how to insert a image in its payload?\n. ",
    "EnhengBenben": "Hi\nwhen I send form as form data,like \"key\":\"value\".\nbut,how to send my array,like \"skills\": [[{id:1,name:\"tom\"}]]. ",
    "molda": "Hi\n there are multiple ways to send array to server. What have you tried so far? What didn't work for you? Have you tried JSON.stringify or jQuery.serialize?. Wow, that was quick. Thanks.\n. @petersirka I'm just playing with package system and on windows 10 and without the dot it doesn't create package\nNotice the success path\n\n. yes total.js@1.9.3-23\n. Sorry i haven't installed it globaly so it's ok now  i was  outside my app folder\n. node.js      : v4.2.1\ntotal.js     : v1.9.3-23\n\nHi @petersirka following code still fails to find anything in my admin folder\njavascript\nF.map('/admin/', '/admin/');\nas soon as i remove \"/\" from second argument F.map('/admin/', 'admin/'); it's working\nand this\njavascript\nF.map('/admin/', path.join(F.path.private(), 'admin'));\nwil produce\njavascript\nself.routes.mapping['/admin/D:/totaljs-beta/private/admin/app.js'] = 'D:/totaljs-beta/private/admin/app.js';\njavascript\nif (framework.isWindows) files[i] = files[i].replace(filename, '').replace(/\\\\/g, '/');\nwill not replace anything since\njavascript\nfilename == 'D:\\totaljs-beta\\private\\admin/' // notice one forward slash\nfiles[i] == 'D:\\totaljs-beta\\private\\admin\\app.js'\n\n``` javascript\nF.map('/admin/', path.join(F.path.private(), 'admin'));\nframework_utils.ls(framework.isWindows ? filename.replace(/\\//g, '\\') : filename, function(files) {\n     console.log(files); // output = [ 'D:\\totaljs-beta\\private\\admin\\app.js' ]\nself.routes.mapping[key] = plus + files[i];\nconsole.log(key + ' = ' + plus + files[i]);\n// output = /admin/D:/totaljs-beta/private/admin/app.js = D:/totaljs-beta/private/admin/app.js\n\n``\n. Cool i didn't realize i can useF.path.private('admin')instead ofpath.join(F.path.private(), 'admin')`\nI'll read docs more carefuly next time!\nHowever it still isn't possible to use\njavascript\nF.map('/admin/', F.path.root('admin'));\nsince it will create mapping to /admin/D:/totaljs-beta/admin/app.js\nand\njavscript\nF.map('/admin/', '/admin/');\ndoesn't work with the leading slash.\nonly working is\njavscript\nF.map('/admin/', 'admin');\nNotice about this in docs would be cool.\nThanks.\nEDIT\nI have following folders\n/admin\n/private/admin\nand i tried this\nconsole.log(F.path.private('admin')); //  D:/totaljs-beta/private/admin\nconsole.log(F.path.root('admin')); //  D:\\totaljs-beta\\admin\nF.path.private returns forward slashes and F.path.root returns backslashes which is inconsistent and probably causes some problems too.\n. v1.9.3-25\nF.map('/admin/', '/admin/');\ndoesn't work in windows, framework_utils.ls returns empty array \nthe leading slash is the problem, following works ok\nF.map('/admin/', 'admin/');\nalso the framework.isWindows check doesn't seem to have any effect in\nframework_utils.ls(framework.isWindows ? filename.replace(/\\//g, '\\\\') : filename...\nthis\nframework_utils.ls(filename... \nworks ok\n. Great, it seems to work s expected now\nand one more thing :)\nin map function following check\n// Checks if the directory exists\nif (!isPackage && !filename.startsWith(directory)) {\nwill not work as expected (again windows only)\nsince in my case\ndirectory = D:\\totaljs-beta  //back slash\nand \nfilename = D:/totaljs-beta/private/admin // forward slashes\nThanks a lot\n. v1.9.3-27\nCool, both variables directory and filename now have forward slashes\nThanks\n. Hi @ameykshirsagar you can change it in config file see this https://docs.totaljs.com/latest/en.html#api~FrameworkConfiguration~directory-isomorphic\n. I've noticed 2 mistakes in your code ->  link[-1] and url[-1] will always be undefined, so this \nif(link[-1] === '/')` \nwill always be false.\nAlso can you show what mapping is this suppose to produce?\nI tried your code and where you call self.map(link, files[i]); the link is /url-001imgs and files[i] is imgs which doesn't make any sense.\n. Hi @yexing could you be more specific about what's missing?\nI just checked the docs and it all works as it should and no pages missing.\n. Good to hear that :). Hi @yexing \nit works as expected but you need to create the view prior to any operations on DB.\nSo create for example some definition file, dbviews.js with bellow code\n```\n// Creates a view \"women\"\nNOSQL('users').view('women').make(function(builder) {\n    builder.where('sex', 'female');\n    builder.sort('age');\n});\n// Creates a view \"men\"\nNOSQL('users').view('men').make(function(builder) {\n    builder.where('sex', 'male');\n    builder.sort('age');\n});\n```\nthen insert some documents and it's ready\nNOSQL('users').find('women').search('name', 'Anna').callback(function(err, response) {\n    console.log('All women with name \"Anna\"', response);\n});\nYou don't need to call nosql.view('women').make(... before every use, only once you start your app. Hi @lazaridis-com the website is running on the CMS you can find here https://github.com/totaljs/cms\n. Hi @lyquocnam i would recommend to create a definition file and add the code bellow.\n./definition/firebase.js\n```javascript\nvar firebase = require('firebase-admin');\nglobal.FIREBASE = firebase;   \nvar serviceAccount = require(\"path/to/serviceAccountKey.json\");\nfirebase.initializeApp({\n  credential: firebase.credential.cert(serviceAccount),\n  databaseURL: 'https://.firebaseio.com'\n});\n```\nthen you can use it anywhere in your app\njavascript\n// https://github.com/firebase/quickstart-nodejs/blob/master/database/index.js\nFIREBASE.database().ref('/posts').on('child_added', function(postSnapshot) {\n    var postReference = postSnapshot.ref;\n    postReference.child('stars').on('value', function(dataSnapshot) {\n        //.......\n    }, function(error) {\n        //.........\n    });\n});\n. @ivanlunardi Can you be more specific? What do you want to achieve?\nschedules are processed once a minute so it's more usefull for longer times not a seconds. \nWouldn't setTimeout or setInterval be better?. Then F.schedule is not what you want. \nYou gonna need to use setInterval(function() {}, 1000 * 10).. Hi @hessel framework expects the port to be a number but in iisnode process.env.port is a named pipe.\nCan you change the options as shown bellow to see if that's the issue:\noptions.ip = '127.0.0.1';\noptions.port = 3000;\nThanks. Can you add this snippet to see the request details?\nIt seems the server is responding just fine but as you said the problem could be with routes.\nF.on('request', function(req, res){\n     console.log(req.method, req.url);\n});. @sant123 Hi, there's a module for Total.js that does almost the same as serve-index.\nCheck it out https://github.com/totaljs/modules/tree/master/Miscellaneous/directorylisting. There's a config https://docs.totaljs.com/latest/en.html#api~FrameworkConfiguration~default-request-length. Aren't you missing 'json' flag in your route?. So the json flag does not work??\nF.route('/api/auth', logout, ['delete', 'authorize', 'cors', 'json']); <-- ???. Putting the file in the modules folder would fix it as long as no module uses it.. You are missing parenthesis after self.callback\nGETSCHEMA('Product').query(self.query, self.callback());\nself.callback needs to be called because it returns a function depending on content type, so for json it will use self.json and for view self.view. Try to replace self.callback() with a function:\nGETSCHEMA('Product').query(self.query, function (err, response) {\n    console.log(err, response);\n    self.json(response);\n});\n\nDo you see the results in the console?. Can you show us your controller??. Hi @Pourya8366 have you tried to run the couchbase code separately without framework?\nDoes the cluster even connect to the server?. Hi @lyquocnam as far as i understand PWA (hope you mean Progressive Web App) there's nothing you need to do on server-side.\nI've seen a few examples and there was no server-side code required.. Hi.\nThe easiest way would be to use bellow config to make node_modules folder publicly accessible.\ndirectory-public-virtual    : '/node_modules/'\n\nNow the src for \n<app-folder>/node_modules/module_name/index.js\n\nwould be\n/module_name/index.js\n\nAnother way could be to install modules for front-end into node_modules in public directory \nso the src  for \n<app-folder>/public/node_modules/module_name/index.js\n\nwould be \n/node_modules/module_name/index.js. Hi @blaasvaer  documentation https://docs.totaljs.com/latest/en.html#api~SchemaBuilder\n\nThe main benefit of schemas is validation of incomming data. Schemas can also be sort of a middleware between front-end and database since you can define methods for CRUD operations. Workflows can be used to chain multiple calls to procces incomming data.\nOnce you understand how to use and even abuse Schemas you will realize they are most important part of any aplication that works with database.\nMake sure to check the documentation and have a look at total.js apllications on github since they all use schemas which you can find in models directory ( i know it's probably a bit misleading though )\nSchemas are usualy used in this way:\nIncomming request->route(with a flag *SchemaName)->controller(using schema methods like $get, $save, $query, $workflow etc.)->Schema(returning data to controller)->controller(responding with json or rendering a view)\nI'll be happy to answer any questions you or @TemaSM or @webdesus may have, so feel free to post comments here. \n. Hi i just tried it and it works OK for me. Can you share the link to https://designer.totaljs.com/????/ so i can have a look at your schema?. @blaasvaer i have already commneted here https://github.com/totaljs/node-sqlagent/issues/28#issuecomment-377182334\nYour mysql_connection_string is in unsupported format!!!. The simplist would be to check how you can use self.callback() by reading documentation https://docs.totaljs.com/latest/en.html#api~FrameworkController~controller.callback\nYou would find out that it takes an optional argument, a view name. So the bellow code would do exactly what you want.\nself.$get(self, self.callback('your-view-name'));\n\nand the above is shorter version of\nself.$get(self, function(err,response){\n    self.view('your-view-name', response);\n});\n\nyou also don't need to pass controller (self) to the $get function since you can access it in the schema using $.controller although only when you use the dollar sign. It's just to make it simpler although it may make it a bit confusing but it's all in the docs https://docs.totaljs.com/latest/en.html#api~SchemaBuilder~(-v2-5-0-supports-improved-declarations-of-schema-operations)\nschema.setGet(function ($) {\n    $.controller;\n});. @webdesus i'm thinking about it now and realizing you are probably right. . Can you show me the way you defined the route?  It should have the `json` flag otherwise it takes the data and turns it into a string which results into `[object Object]`\n\nThe route with a json flag\nF.websocket('/', wshandler, ['json']);\nYou can also stringify it yourself though\ncontroller.all( (c) => {\n    c.send(JSON.stringify({ m: 'test' }))\n}). @blaasvaer Since id is most useful it's actualy implemented right into schemas\njavascript\nschema.setGet(function ($) {\n    // $.controller.id contains a value of the first argument of dynamic routing\n    $.controller.id;\n...\nanother way is \njavascript\n...\nROUTE('/admin/api/pages/{id}', json_query, ['*Pages']);\n...\nfunction json_query ( id ) {\n    if ( id ) {\n                // pass id as a helper and use it in schema as $.options\n        _this.$get(id,  this.callback() ); \n    }\n}\n...\nmodel\njavascript\nschema.setGet(function ($) {\n    $.options // the id\n});\n. @blaasvaer that is a proper way. It's simple and it works.\nWhat do you think would be a more proper way?. Hi, i would just like to point out one important thing and that is the view engine and all it's methods are synchronous and F.merge is asynchronous. The main thing is you only need to merge those files once at the start of your app, you don't need to do it every time you render a view. The F.merge creates a new file in the tmp directory and serves it when requested. In a way it has nothig to do with the views. \nEven if the view engine was asynchronous You would want to avoid async stuff during the view render as much as possible due to the performance. The faster you respond the faster you can handle the next request.\nThe other methods @{import(), @{js()}, @{css() are sync since they only write a string into the view template during the render.. ",
    "mansouridonia": "Hi,\nIt's my first time to work with web service, so can anyone of you help me? I want to know how to consume a JSON web service? When I  consulted the Developer tools in Chrome, I've found this:\n\n. ",
    "gyuha": "Hi @petersirka ..\nThat's right...\nThank you...\n. ",
    "lgruz": "Socket.io works perfectly with partial.js\n. I created a module named \"websocket\":\nvar socketio = require('socket.io');\nframework.on(\"load\", function() {\n    this.ws = socketio.listen(this.server);\n});\nThen, in config file you have to set \"allow-websocket\" as false. Now, you can use framework.ws in any route, module...\n. ",
    "superpan3000": "Hi @petersirka,\nThank for your answer. It's ok but is there any different between self.repository and self.global?\nI used global before but I didn't know when to use global or repository after see your answer :)\nThanks\n. I see. Thanks :+1: \n. Ok, thanks :)\n. ",
    "greatwar": "thanks.\n. oh.its a usable solution.\nbut i am thinking a partial.js app behind a reverse proxy:\nhttp://www.somedomain.com/app1 --> http://internal ip:port/app1\nhttp://www.somedomain.com/app2 --> http://internal ip2:port2/app2\nmay be i should not think of this.\nsorry for my pool english\nthanks.\n. thanks very much\n. ",
    "zygis": "Not working, I got same error and 504 Gateway Time-out from reverse proxy.\n\n. I added:\nframework.route(\"/some/post\", function () {\n        console.log(\"some post request\");\n}, [\"post\"]);\nbut got same error, on POST /asdasdasd\n. Yes, but this function is never called until POST /some/post, so it doesn't matter what's inside\nAll I want - handle somehow 404 error on POST request. Looks like \"If you haven't defined a POST route - then framework will block all POST requests\" is not main problem...\n. For /some/post everything is ok, but how to handle POST to /some_undefined_route?\nExpected result: OK, 404, but got 504 error.\n\n. Hmm, it's quite uncomfortable define all possible routes\n'/{segment1}',\n'/{segment1}/{segment2}',\n'/{segment1}/{segment2}/{segment3}'\nI really like idea with route #error_code, but this not working with POST requests :(\nWith this version error from terminal is gone, but from reverse proxy now I got 502 Bad Gateway error\n. Defining all possible routes for post - works. But as a workaround, not a clean solution...\nhttps://mega.co.nz/#!6dh33ZwD!Cib3s0fAlgni145Di1kNYiD1pi8vCnEes-SE7uGtcZk - partial.js from npm\nhttps://mega.co.nz/#!fVxWFDrC!AEcl7SWwsbBEwt5KLnuFdjC6yEpVPL8qRNLSSmcNRp0 - partial.js from empty_project.zip\ntry to load POST /no_route_defined_for_this\nreverse proxy: HAProxy\nconfig:\n```\ndefaults\n        timeout connect 5s\n        timeout client 50s\n        timeout server 20s\n        option forwardfor\n        option http-server-close\n        retries 0\nglobal\n        daemon\n        maxconn 256\n        user haproxy\n        group haproxy\nfrontend http_in\n        bind *:80\n        mode http\n        default_backend backend_main\nbackend backend_main\n        mode http\n        server server1 127.0.0.1:3000 weight 1 maxconn 512\n.\nframework.route(\"/api\", post, {flags: [\"post\"], timeout: 10000});\n```\nrequest body:\nkey1=value1&key2=value2\nresponse\n```\nServer: nginx/1.5.7\nDate: Thu, 02 Jan 2014 09:09:34 GMT\nContent-Type: text/plain; charset=utf-8\nTransfer-Encoding: chunked\nConnection: keep-alive\nX-Powered-By: partial.js v1311\nCache-Control: private\nVary: Accept-Encoding\n400: Bad Request\n```\nflags: [\"json\"] works as expected.\n. Accept: */*\nCache-Control: no-cache\nI found, that POST is working fine with this header:\nContent-Type: application/x-www-form-urlencoded\n. But how to use \"raw\" flag?\nframework.route(\"/api\", post, [\"raw\"]);\nI got noting with http method POST\n```\nPOST http://domain.tld/api\nContent-Type: application/x-www-form-urlencoded\nkey1=value1&key2=value2\n-- response --\n0 \n```\n. Not working. Same response.\n```\nPOST http://domain.tld/api\nContent-Type: application/x-www-form-urlencoded\nkey1=value1&key2=value2\n-- response --\n0 \n```\n. Okay, now I understood. This works fine:\nfunction post () {\n    // ....\n    var postData;\n    if (_.isString(self.post)) {\n        try {\n            //noinspection JSValidateTypes\n            postData = JSON.parse(self.post);\n        } catch (ignore) {\n            try {\n                postData = queryString.parse(self.post);\n            } catch (ignore) {\n                postData = {};\n            }\n        }\n    }\n    // ....\n}\nframework.route(\"/api\", post, {flags: [\"raw\", \"post\"], timeout: 10000});\nThank you for help!\n. Response headers:\nCache-Control   no-cache\nConnection  keep-alive\nContent-Encoding    gzip\nContent-Type    application/json; charset=utf-8\nDate    Wed, 18 Dec 2013 15:08:13 GMT\nServer  nginx/1.5.7\nSet-Cookie  new-cookie-3=value-3; Expires=Sat, 21 Dec 2013 15:08:13 GMT; Path=/\nTransfer-Encoding   chunked\nVary    Accept-Encoding\nX-Powered-By    partial.js v1301\nonly last cookie is set...\n. When fix will be available from npm?\n. framework.onXSS = null;\nPerfect! Thanks!\n. A little bit \"hacky\" way, but it works. Thanks!\n. Nop,\nconsole.log(utils.combine(\"~/../data/temporary\")); // /data/temporary\nconsole.log(utils.combine(\"~/../../data/temporary\")); // /data/temporary\n~/home/user/project/data/temporary - works, but this is not true :) Other developers who will maintain my code - will kill me\n. When current directory (process.cwd()) for example is /home/user/project/src\nconsole.log(utils.combine(\"/../data/temporary\")); // should be /data/temporary\nconsole.log(utils.combine(\"./../data/temporary\")); // should be /home/user/project/data/temporary or ./../data/temporary\nconsole.log(utils.combine(\"../data/temporary\")); // should be /home/user/project/data/temporary or ./../data/temporary\nconsole.log(utils.combine(\"/home/user/project/data/temporary\")); // should be /home/user/project/data/temporary\nconsole.log(utils.combine(\"~/../data/temporary\")); // probably should be /home/user/project/data/temporary\nconsole.log(utils.combine(\"~/../../data/temporary\")); // probably should be /home/user/data/temporary\n. Yes, it's important to framework, and it's impossible set temporary upload directory somewhere outside the source code without hacks...\n. Nevermind... I will add YET ANOTHER hack to app...\nframework.config[\"directory-temp\"] = \"~\" + process.cwd() + \"/../data/temporary\";\n. ",
    "sakateka": "Route for put and json  like this:\njavascript\nframework.route(\"/api\", callback, {flags: [\"json\", \"put\"], timeout: 10000});\nput request header:      Content-Type:application/json\nand request body:   {\"key1\":\"value1\",\"key2\":\"value2\"}\ngot NULL when doing post request\n. ",
    "hockeyst": "Yes, i understand! Thanks! But i meant wildcard subdomain as route parameter, for example:\n``` JavaScript\n// ALL:\n// http://*.website.debug/\nframework.route('{wildcard}/', subdomain);\nfunction subdomain(wildcard) {\n        wildcard = wildcard || '';\n        this.plain(wildcard);\n}\n// http://website.debug/\nframework.route('/', root);\n```\n. Thanks, cool framework! I love it :). Simple & clean!\n. ",
    "jorgemejia": "is it possible to implement angular 4 intead angular 2 ?. ",
    "sabsaxo": "Why is Angular even a concern in this matter? I'd like to see Angular die a quick and painful death .... When I console.log the instance, I can see the cookies just fine, and $persistentcookies are set to true:\nRESTBuilder {\n    '$url': 'http://localhost:8000/main/api/constants/',\n    '$headers': \n    { 'user-agent': 'Total.js/v2.9.4',\n        accept: 'application/json, text/plain, text/plain, text/xml' },\n    '$method': 'get',\n    '$timeout': 10000,\n    '$type': 0,\n    '$length': 0,\n    '$transform': undefined,\n    '$files': null,\n    '$persistentcookies': true,\n    '$cookies': \n    { csrftoken: 'xunv27vWsPgl8xp7q2E7UcKYIJiESIKk',\n        sessionid: '0bhtap9p9v9esfmw55lumy2kqfi6jqdi'\n    },\n    '$flags': [ 'get', 'dnscache', 'cookies' ]\n}. Same result, no cookies set.\nOK, then I totally do not understand that part of the framework. Where would I centrally place a cookie that will update on a call that gets made everytime a csrftoken is renewed?. And how can I then avoid to create new instance everytime? The url doesn't change, so I guess the instance doesn't need to neither.. So, what is happening here? Are the cookies reset after .exec() ... or what are you saying?. I request the node server for a login form. When submitting the form I request a Django backend on another server, and I need to make cookies persist across the two servers.\nI can do that when I set the cookies from the controller and adding 'withCredentials' : true to my xhr, but I'd like to avoid to have to set them in each and every controller method across the whole application ... so, what I'm after is a 'structure' for how to make this a central thing in the request chain.. Now, even that comment I don't understand. What is object?. What do you mean by JSON --> String?. So, what you're telling me is: that I should CHANGE 'JSON' to 'OBJECT'?\nJSON --> String didn't make any sense.. According to the 'docs' JSON is defined as \"JSON\", so the 'docs' may be confusing .... An object. So why can I define something as 'JSON' when I should be using 'OBJECT'? It's confusing at best.. True, but I was expecting the data to be an object when passed to the model on the server \u2013 and behaving as such. I think I'm simly confused about what's going on 'behind the scenes (Schemes ; ) )'\nBut thanks for clearing that out .... ",
    "yyken": "browser name : chrome \nbrowser version : 31.0.1650.57\nyour OS : mac os x 10.9\nnode.js version : v0.10.22\npartial.js version : 1.2.9\n. ha i solve my problem by change url http://localhost to http://127.0.0.1 ....\nthanks :)\n. I find If I write below code at view\n<script>\n      // alert(1);\n      foo();\n</script>\nafter minified \n<script>//alert(1);foo();</script>\nfoo() will be commented...\nthanks :-)\n. ",
    "thelinuxlich": "So all the other modules will be available even on exports.install?\n. Is this correctly achieved today with\nframework.responseContent(this.req,this.res,200,buffer.toString('binary'),'image/gif'); \n?\n. Thanks!\n. var isSecure = this.req.host.indexOf(\"https\") !== -1;\n. But framework.file doesn't have the same API as framework.route. I need partials, for example\n. But I really cannot overwrite an automatic route like /script.js which would get the file on /public to do my own logic?\n. This is very bad for analytics :-1: \n. So how am I supposed to use the partials with a file route?\n. What will change? The signature of framework.file(file,function,[partial1,partial2]) ?\n. Couldn't we treat it as an exception in case someones needs to use partials with files? \"this\" would have only what is already provided as parameters to a file route(req,res,isValidation)\n. I think the best way would be to extract https://github.com/petersirka/partial.js/blob/master/index.js#L4590 into a new function, execute it here: https://github.com/petersirka/partial.js/blob/master/index.js#L4787 with the file.partials and using a \"this\" context with only req and res\nI don't think global partials would be good for this, so we could avoid it\n. okie dokie\n. Does the partial on your example has access to request, response, headers, etc?\n. Thinking about this, the second parameter of framework.run() could be a boolean if you want the traditional configuration convention(config-debug, config-release) or a string so we could set it based on other things(like an environment variable), example:\nframework.run(http,'test',port); // will load config-test\n. maybe an object as second parameter:\n{\n   debug: true,\n   config: 'test'\n}\n. Anyway, I'm having this issue because I've created modules for RabbitMQ and StatsD which loads from different servers and credentials(config-test,config-debug,config-release). If I run framework.injectConfig('config-test') right after framework.run(), it won't apply my settings adequately\n. That's why I think that an object containing debug: true|false and configuration: 'name' is better. It's not about a different environment than debug or release, just to load another configuration file\n. But a framework.on('configuration-loaded', function() {}) or something like that would solve this issue too\n. Great! So if I injectConfig at that point, it would overwrite whatever config was loaded and before loading modules and definitions? \n. Something like this:\n```\nframework.on('configure', function(config) {\n   var data = fs.readFileSync(\"config-test\");\n   framework.configure(data.split('\\n\"),true);\n});\nframework.run(...);\n```\nWould apply ?\n. Ok, I've tested and it is good, I'll close it. Just for anyone looking for this in the future, I'm using it like this:\n```\nframework.once('configure', function(config) {\n   var data = fs.readFileSync(\"config-test\",\"utf8\").split('\\n\");\n   framework.configure(data.split('\\n\"),true);\n});\nframework.run(...);\n```\n. Tested and it rocks :+1: \n. Never mind, found it:\n```\nasync.on(\"error\",function(err,message){\n}); \n```\n. I think I don't understand what is the purpose of isValidation\n. By seeing the example: https://github.com/petersirka/partial.js/blob/master/examples/static-file-handling/controllers/default.js\nLooks like the first parameter for framework.file is not the route validation per se, just whatever string for identifying it, right?\n. Nice!\n. But framework.responseFile doesn't accept a string as file, just a filename\n. Worked :)\n. But you're initiating a new connection on every framework.database call, aren't you?\n. oh nice :+1: \n. it will work via websockets?\n. Ok, so I will be using \nstream.on(\"data\",function(chunk){\n       self.send(chunk);\n});\n. It's big, but good to know the trick :)\nBy the way in your code I guess output variable should be concatenating\n. Happy New Year Peter! Let's rock on 2014! :)\n. ",
    "gw0": "In NodeJS 0.10+ it is enough to npm install -g coffee-script and than you can just use it like any JavaScript code (node index.coffee or use other tools that support it, like nodemon index.coffee). There is no need anymore to manually recompile it to JavaScript, although you still can (useful for client-side code and for npm packages).\n. For running the tests I also had to:\nnpm install memwatch\ncd test\nAll tests seem to pass through fine, because I actually didn't touch any code connected with them - only added support for processing CoffeeScript files.\n```\n$ node app.framework-debug.js\n...\n================================================\nsuccess - OK\n================================================\n$ node app.builders.js\nsuccess - OK\n$ node app.less.js\nsuccess - OK\n$ node app.javascript.js\nsuccess - OK\n$ node app.utils.js\nsuccess - OK\n```\n. ",
    "jg10": "Excellent thanks :+1: \n. ",
    "madeinjam": "This should be a good start:\n```\nLogs\nlogs\n*.log\nRuntime data\npids\n.pid\n.seed\nDirectory for instrumented libs generated by jscoverage/JSCover\nlib-cov\nCoverage directory used by tools like istanbul\ncoverage\nGrunt intermediate storage (http://gruntjs.com/creating-plugins#storing-task-files)\n.grunt\nCompiled binary addons (http://nodejs.org/api/addons.html)\nbuild/Release\nDependency directory\nDeployed apps should consider commenting this line out:\nsee https://npmjs.org/doc/faq.html#Should-I-check-my-node_modules-folder-into-git\nnode_modules\nTotal.js Framework Specific Directories\n/tmp/\n/logs/\n```\nGreetings!\n. Thanks!\n. ",
    "kevyworks": "Thanks @petersirka I appreciate it :+1: \n. @petersirka I will test it asap.\nThanks Peter.\n. Ok, after renaming this to totaljs, lol.. I am just stupid, but, anyhow; it works if: totaljs ./myproject\n. Yeah, I wish to switch to linux based system to develop this kinds of stuff, but there are just this software I use that keeps me from switching.  Please do test on Windows.\nThanks!\n. ",
    "DevAlien": "using uglify solves the issue, but still we need to solve the original one or just move to uglify.\nhttps://github.com/petersirka/partial.js/tree/master/examples/external-compile-uglifyjs\n. If you want to use the coma \",\" you write as follows:\nvar foo = 0,\nbar = 10;\nThe problem is that js does not require semi-colons (if there's a return chat \\n\\r)\nso if you write:\nvar foo = 0\nvar bar = 10\nit's correct.\n. Even with uglify there's the problem for inline javascript in the HTML;\n. @goldalworming  http://www.jshint.com/docs/options/#asi\nyou can set jslint to forget about semicolons.\n. The Uglify trick does not work for inline javascript.\nAnyway, I did not write that code, for example jStorage, as far as I know is widely used.\nanyway, nowhere is written that 100% good javascript is with semi-colons (even if I use them, so this problem doesn't touch me). I'm aware of certain projects that do not want semi-colons in their code node-xmpp for example\n. ",
    "xstable": "OK, but why does the Page of partialjs is still online ???  Or is this another new Project? http://www.partialjs.com/\nIf this the \"old\" partialjs, maybe better remove the page and place a Link to total.js to clearify this for the users?!!\n. ",
    "ememumoh": "Peter,\nI did a quick check and found the below. can you contact the owner of this domain and concludes things with him. Honestly it is misleading: \nDomain Name: partialjs.com\nRegistry Domain ID: 1775086274_DOMAIN_COM-VRSN\nRegistrar WHOIS Server: whois.srsplus.com\nRegistrar URL: http://srsplus.com\nUpdated Date: 2016-01-09T18:16:24Z\nCreation Date: 2013-01-21T14:54:59Z\nRegistrar Registration Expiration Date: 2017-01-21T14:54:59Z\nRegistrar: TLDS LLC. d/b/a SRSPlus\nRegistrar IANA ID: 320\nRegistrar Abuse Contact Email: abuse@web.com\nRegistrar Abuse Contact Phone: +1.8773812449\nReseller: \nDomain Status: clientTransferProhibited http://icann.org/epp#clientTransferProhibited\nRegistry Registrant ID:\nRegistrant Name: Anton Gajdosik\nRegistrant Organization: Web Site Design s.r.o.\nRegistrant Street: Sibirska 23 \nRegistrant City: Bratislava\nRegistrant State/Province: \nRegistrant Postal Code: 83102\nRegistrant Country: SK\nRegistrant Phone: +421.254650421\nRegistrant Phone Ext.:\nRegistrant Fax: +421.254650423\nRegistrant Fax Ext.:\nRegistrant Email: gajdosik@wsd-europe.com\nRegistry Admin ID:\nAdmin Name: Anton Gajdosik\nAdmin Organization: Web Site Design s.r.o.\nAdmin Street: Sibirska 23 \nAdmin City: Bratislava\nAdmin State/Province: \nAdmin Postal Code: 83102\nAdmin Country: SK\nAdmin Phone: +421.254650421\nAdmin Phone Ext.:\nAdmin Fax: +421.254650423\nAdmin Fax Ext.:\nAdmin Email: gajdosik@wsd-europe.com\nRegistry Tech ID:\nTech Name: Anton Gajdosik\nTech Organization: Web Site Design s.r.o.\nTech Street: Sibirska 23 \nTech City: Bratislava\nTech State/Province: \nTech Postal Code: 83102\nTech Country: SK\nTech Phone: +421.254650421\nTech Phone Ext.:\nTech Fax: +421.254650423\nTech Fax Ext.:\nTech Email: gajdosik@wsd-europe.com\nName Server: ns3.wsdnet.sk\nName Server: ns4.wsdnet.sk\nDNSSEC: Unsigned\nURL of the ICANN WHOIS Data Problem Reporting System: http://wdprs.internic.net/ \n\n\n\nLast update of WHOIS database: 2016-01-09T18:16:24Z <<<\n\n\n\nRegistrar: TLDS, LLC DBA SRSPLUS\nWhois Server: whois.srsplus.com\nCreation Date: 21-JAN-2013\nUpdated Date: 09-JAN-2016\nExpiration Date: 21-JAN-2017\nNameserver: NS3.WSDNET.SK\nNameserver: NS4.WSDNET.SK\nRegistry Status: clientTransferProhibited\n. ",
    "tj": "thanks! jade is uber-slow at compiling, but normally that would just be once in production\n. ",
    "BreakThrough-Apps": "Hello Peter,\nI'm using the following code to upload files on client side:\nvar fd = new FormData();\n          // send to server as uploadFile field\n          fd.append('uploadFile', this.files[0]);\n          // create xhr\n          var xhr = new XMLHttpRequest();\n          xhr.open(\"POST\", base_url+'files/upload/');\n          xhr.send(fd);\nWhile I'm using the following route & flag \nframework.route('/files/upload/', upload, { flags: ['upload'] });\nThank you\n. Got anothr error net::ERR_EMPTY_RESPONSE, even if I returned response.\nThese errors returned before calling controller function :(\n. Hello Peter,\nI managed to solve the problem by reinstalling total.js\nThank you for your help,\nFayez\n. Hello Peter,\nThank you, you're right the url shouldn't start with / \nso instead of /api/\nI used api/ on controller routes definition.\nThank you,\nFayez\n. ",
    "Ronto": "Thank you for your quick answer, i downloaded one of the examples to test the framework, and thank you again\n. thank you :)\n. thanks for the fast reply, and sorry for the stupid question again\n. Hello @petersirka  and thanks, and sorry for my stupid questions\n. Thanks for the reply @flienteen i tried that earlier, but i am getting call method toString of null error for some reason\n. Just tested again, sorry, it was my bad, both your solution work, i just forgot to start my db server, thank you @flienteen \n. ",
    "LeventeNagy": "this is my problem, i get no error, not even status code\nhttp://oi59.tinypic.com/2yngsxu.jpg\n. Tried that too, same thing :S\n. Ok i will tomorrow, good night if its night there :) and thanks for answering my questions :)\n. Thanks for your help, removing the xhr did work, it just did worked for me at the first time because some server problems, thanks for your help, have a nice day\n. Ah thanks guys, i will look at it\n. thank you @petersirka \nPlaced it in the modules now its okay\nAnd Happy New Year\n. Hello @petersirka \nFirst sorry for the slow reply, actually module is loaded correctly.\nAdded self.custom() new problem occured\n\n======= 2015-01-09 14:06:49: Error: passport.initialize() middleware not in use\nError: passport.initialize() middleware not in use\n    at IncomingMessage.req.login.req.logIn (C:\\server\\apache2\\htdocs\\total\\node_\nmodules\\passport\\lib\\http\\request.js:44:34)\n\nSo it can't  initialize because it has a problem: IncomingMessage.req.login.req.logIn     at IncomingMessage.req.login.req.logIn (C:\\server\\apache2\\htdocs\\total\\node_\nmodules\\passport\\lib\\http\\request.js:44:34)\nAny hint on this? Because its od, i tried a nother test by downloading the example files and get the same error. (I am using 1.7.1)\n. Thank you for your help and time\n. First would like to thank for your time and help, bust still have an error what i cannot debug\n(copied your example and updated total js)\n\n======= 2015-01-10 08:39:51: TypeError: Property 'error' of object #\nis not a function TypeError: Property 'error' of object # is not a fu\nnction\n    at Subscribe.execute (C:\\server\\apache2\\htdocs\\total\\node_modules\\total.js\\i\nndex.js:4:16707)\n    at Subscribe.prepare (C:\\server\\apache2\\htdocs\\total\\node_modules\\total.js\\i\nndex.js:4:17606)\n    at Subscribe.doEnd (C:\\server\\apache2\\htdocs\\total\\node_modules\\total.js\\ind\nex.js:4:21308)\n    at IncomingMessage. (C:\\server\\apache2\\htdocs\\total\\node_modules\\\ntotal.js\\index.js:4:15048)\n    at IncomingMessage.emit (events.js:92:17)\n    at _stream_readable.js:943:16\n    at process._tickCallback (node.js:419:13)\n\nI will try to dig in more my self\n. Okay will do\n. Thank you for your time Peter, now it works as it suposed to.\nThank you again\n. Oh im so stupid, forgot to pass it to my route.\nSorry\n. Oh, thank you again, and sorry for my stupid question.\nHope this framework stays alive long, keep up the good work, cheers, and thanks again\n. Yes sure, one second\n. This is really odd than, no matter what i try same results, passport request object only works in the login no where else, tried a fresh install same results\n. Okay, thank you, i will do that, thank you for your time\n. Just want to thank, i implemented the auth module with my logic under 10 mins, awesome. thanks again for the advice\n. Thanks for you help, promise when i will travel to Slovakia  again i will buy you a beer or coffee :) \n. Sorry for the slow reply, yes it is outside, it is in the root folder\n. Ah thanks again @petersirka works now :)\n. Sorry i was wrong. Thought it works, added directory-public-virtual        : /uploads/ still the same result\n. Okay sorry, problem was at my part, did not move the uploads folder to the public folder\n. When you download an empty project you will see the layout html.\nInside it.\n\n\n    @{meta}\n    < meta charset=\"utf-8\" / >\n    < meta http-equiv=\"X-UA-Compatible\" content=\"IE=11\" / >\n    < meta name=\"format-detection\" content=\"telephone=no\" / >\n    < meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" / >\n    < meta name=\"robots\" content=\"all,follow\" / >\n    @{css('default.css')}\n    @{favicon('favicon.ico')}\n\n\nSee the @meta? thats where your title, description keyword beeing displayed.\nIn your page view define the following.\n@{meta('Title', 'Description (optional)', 'Keywords (optional)')}\nFirst param is the title, second the description, third the keywords. if you just need the title leave the others empty\nSo it should look like this\n@{meta('Site title goes here', 'Description goes here)', 'Keywords goes here)')}\nHere is how my news feed page looks like for example\n\n@{layout('/templates/main')}\n@{meta('News feed', 'Fashiopn Pot daily news feed, read about fashion, clothing design', 'fashion, clothing, news, feed, news feed')}\n< !-- page html goes here -- >\n\nIt's not hard actually you can manipulate it as the way you want\n. Sorry for the slow reply @petersirka \nInstalled the latest beta. Still the same results\n\n[Error: Not running]\n======= 2015-08-24 13:09:55: Error: Not running Error: Not running\n    at Server.close (net.js:1233:11)\n    at EventEmitter.Framework.stop (/home/levente/node/total/node_modules/total.js/index.js:622:15)\n    at process.on.Utils.wait.framework.console (/home/levente/node/total/node_modules/total.js/index.js:13955:12)\n    at process.EventEmitter.emit (events.js:95:17)\n    at process.exit (node.js:707:17)\n    at EventEmitter.Framework.stop (/home/levente/node/total/node_modules/total.js/index.js:624:10)\n    at process.on.Utils.wait.framework.console (/home/levente/node/total/node_modules/total.js/index.js:13951:12)\n    at process.EventEmitter.emit (events.js:92:17)\n    at Signal.wrap.onsignal (node.js:757:46)\n[Error: Not running]\nlevente@levente:~/node/total$ ======= 2015-08-24 13:09:55: Error: Not running Error: Not running\n    at Server.close (net.js:1233:11)\n    at EventEmitter.Framework.stop (/home/levente/node/total/node_modules/total.js/index.js:622:15)\n    at process.on.Utils.wait.framework.console (/home/levente/node/total/node_modules/total.js/index.js:13947:12)\n    at process.EventEmitter.emit (events.js:92:17)\n    at Signal.wrap.onsignal (node.js:757:46)\n[Error: channel closed]\n======= 2015-08-24 13:09:57: Error: channel closed Error: channel closed\n    at process.target.send (child_process.js:402:26)\n    at EventEmitter.Framework.stop (/home/levente/node/total/node_modules/total.js/index.js:617:11)\n    at process.on.Utils.wait.framework.console (/home/levente/node/total/node_modules/total.js/index.js:13955:12)\n    at process.EventEmitter.emit (events.js:95:17)\n\n. One quick question before i send you the e-mail, could it be a problem that i am using linux? Just asking\n. Okay than, sending email\n. That is my problem actually, if i modify it for 30 seconds, restart the server, it still uses 5 minutes\n. Thank you\n. It still has an error.\nDefined the expire, and where flash is included i get\n\nUnhandled rejection TypeError: Cannot read property 'expire' of undefined\n\n. Oh crap, i frogot to include sorry, all okay, thank you\n. Sure, did not modify anything it's a fresh install\nview template:\n\n<!DOCTYPE html>\n\n\n\n\n\n\n\n\n    @{import('meta', 'head', default.css', 'default.js', 'favicon.ico')}\n\n\n<div class=\"container-background\">\n    <div class=\"container\">\n        <div class=\"center\"><a href=\"/\"><img src=\"/img/logo.png\" alt=\"total.js - web application framework for node.js\" border=\"0\" /></a></div>\n        <br />\n        @{body}\n    </div>\n</div>\n<footer>\n    &copy; Thank you for using <b>total.js</b>.\n</footer>\n\n\n\nThank you\n. Thank you\n. Ah great. Thank you now its fine\n. Am I doing something wrong?\nI added 1 second and no still the same\nF.route('/login', get_login, ['unauthorize', '#flash', { expire: '1 second' }]);\nStill the same\nIf iI change \nexports.expire = '1 second'; in the module still the same\nif i use\nF.use('flash')\nstill the same\n. Yes I did right after your reply :)\n. Looks like it works now\nThank you so much for solving this problem so fast\nYou are awesome\n. I am using v1.9.7 and the same  thing happens on Windows 10 and Ubuntu 14.04 based Linux distro.\nTested on both, both are the same, and currently Im using linux Ubuntu 14.04\nPS: thank you for the fast response\n. Okay thank you for the fast reply, I will test it and give you feedback in a few\n. Okay, installednpm install total.js@beta restarted the server, restarted the computer, still the same :(\n. Could you please give me an example for the command?\n. ```\nImage.load(self.files[0].path, true).make(function(image) {\n    image.save('/public/tmp/'+self.files[0].path);\n    self.json('done');\n});\nProcess runs, no errors, image not saved :( \nreturns the following path \"/home/levente/node/fitfeed2/tmp/127001-1459159255863-72450.upload\"\n```\nSecond\n```\nvar image = self.files[0].image();\nimage.blur(5);\n```\nIf i debug it it returns\nImage {\n  width: 816,\n  height: 612,\n  builder: [ { cmd: '-blur \"5\"', priority: 10 } ],\n  filename: '/home/levente/node/fitfeed2/tmp/127001-1459159436281-10883.upload',\n  currentStream: null,\n  isIM: true,\n  outputType: 'upload' }\n. Nother test\nImage.load(self.files[0].path, true).make(function(image) {\n        image.save('/public/tmp/'+self.files[0].path);\n        self.json(image);\n    });\noutputs\n{\"builder\":[{\"cmd\":\"+profile \\\"*\\\"\"}],\"filename\":\"/home/levente/node/fitfeed2/tmp/127001-1459159663703-48384.upload\",\"currentStream\":null,\"isIM\":true,\"outputType\":\"upload\"}\n. Ah thanks for the info.\nThis way it works like a charm thank you Peter for your help and fast reply, and sorry for taking your time\nThank you again it works now\n. Still the same now TypeError: F.datetime.now is not a function is gone, but the expire does not work\nI pass exports.expire = '1 seconds'; and it does not expire after 1 second. This is how I use it\nRoute\nF.route('/signup', view_signup, ['#flash']);\n    F.route('/create/user', post_signup, ['post', '#flash']);\nController\n```\nfunction view_signup() {\n    var self = this;\nself.view('signup', { errors: self.flash() });\n\n}\nfunction post_signup() {\n    var self = this;\nvar code = rmds.generate(60);\n\nUser.create({\n    name           : self.post.name,\n    email          : self.post.email,\n    password       : self.post.password,\n    activation_code: code\n}).then(function(data) {\n\n    self.redirect(\"/welcome\");\n\n}).catch(function(msg) {\n\n    msg.errors.forEach(function(item) { \n        self.flash(item.path, item.message);\n    });\n\n    self.redirect('/signup');\n});\n\n}\n```\nView\n<div class=\"mdl-textfield mdl-js-textfield\">\n    <input class=\"mdl-textfield__input\" type=\"text\" name=\"name\" id=\"name\" />\n    <label class=\"mdl-textfield__label mdl-color-text--black\" for=\"name\">Name</label>\n    @{if model.errors.name}\n        <span class=\"mdl-textfield__error\">@{model.errors.name}</span>\n    @{fi}\n</div>. I downloaded the flash.js from GITHub and placed it in my modules folder. Well I do, I set exports.expire = '1 seconds';\nand it duplicates it, it does not expire\nthis is what i get back after the form posts\nName cannot be empty,Name cannot be empty,Name cannot be empty,Name cannot be empty,Name cannot be empty,Name cannot be empty\nBut i will solve it somehow, thank you for your time. ",
    "gnetsys": "JugglingDB seems like it has a few errors in buld, I suggest waiting for a stable release before using. Try caminte instead https://github.com/biggora/caminte. It is a fork of JugglingDB.\n. @ronto what ORM are you using?\n. I observed you post on caminte tracker- @ronto have you been successful in implenmenting caminte - neo4j as I would like to contribute to this direction. \n. if the line \"self.repository.title = 'Administrator';\" is removed from the view_articles() function it breaks the view with 500 error.\nError: View: _adminlayout - TypeError: Cannot call method 'toString' of undefined Error: View: _adminlayout - TypeError: Cannot call method 'toString' of undefined \nat Object.Controller.view (......\\node_modules\\total.js\\index.js:5:6235)\nshould not the \"self.repository.title = 'Administrator';\" be defined once as a globally?\n. To add to that web components is becoming main stream, it would be nice if we can support webcomponents. Native or Module. \nhttp://webcomponents.org/\nhttp://customelements.io/\n. ",
    "flienteen": "Hi,\nYou could try:\njs\nvar modelPost = require('./post');\n//or\nvar modelPost = framework.model('post')\n. ",
    "listepo": "I think a better option than the tags, because for these tags are reserved by the developers and will have to do screening mechanism.\n. Hi, for example  tag can be used to production and is code that it will not be optimized.\n. but in order that it was possible to deduce the unoptimized code, I think the best option is to use when rendering a single view or parts that will override optimizations within view\n. or you can use that tag custom after compilation will be removed but the text it will not be optimized\n. Thank you very much.\n. ",
    "toshipon": "@petersirka \nthanks for your reviewing. \nalso it was my fault finally...  my changes of config setting didn't effect for urls of anguler js files well. so please ignore this PR.. :bow: \nthanks\n. sorry I mistook rebasing commis. so I can resend a PR if you need.. :bow:\n. sorry for delay.\nyeah I saw your example to use static- path. looks static- is basically for applying static assets path. \nmaybe if I use compressing static file feature. i would use proxy and handle path ito that. \nso I'll close this PR. thanks\n. I just added node module for testing as devDependencies with npm install memwatch --save-dev.\nit fixed indents automatically.\n. ",
    "lstep": "It's on http://www.totaljs.com/totalstack/ you wrote:\nbash\n # --> Run App\n $ node debug\nI'm on Linux, maybe on Windows the extension (.js) is optional? \n. @goldalworming I'm sorry to disagree, but to reference a file you need to give its full path. In fact, there is not really any notion of \"extension\" like in Windows. What one calls extension is part of the filename.\nBut maybe we're not talking about the same thing? when one writes \"node debug\", does that mean that it will find a debug.js file automatically?\nAnyway, on Linux, I get an error when trying to execute that command, and it works when I write with debug.js : \nbash\n$ ls\napp  config-debug  config-release  controllers  debug.js  node_modules  release.js  test.js  tmp  views\n$ node -v\nv0.10.28\n$ node debug\nUsage: node debug script.js\n$ node debug.js \n------------> PID: 24189\n====================================================\nPID          : 24191\nnode.js      : v0.10.28\ntotal.js     : v1.4.0\n====================================================\nName         : some web site\nVersion      : 1.01\nAuthor       : Your company name\nDate         : 2014-05-13 23:25:02\nMode         : debug\n====================================================\n. Hi @rdewolff,\nWhat do you mean? the config-* are just config files, a store for variables. What if I want (that's even the first exemple shown on the tutorial, on http://docs.totaljs.com/ on \"How to run framework\") HTTPs or any other module (node-SPDY for example)? From what I see, I can't do it.\nEverywhere when you do some debugging, you want the clear/easy to read/modify source, not the optimized version (which is cool, but only when you're in production, not when you're debugging).\n. @petersirka,\nSeveral reasons :\n- I'm using nodejs for a small admin GUI where I just need security, not performance, so NGINX would be so overkill... I think many use cases include small servers that don't require high availability/performance that would make a NGINX proxy required.\n- Anyway, the HTTPS stuff was just an example of many different modifications that are not really possible if you minify the debug.js file. I think I can find other things/modules that wouldn't be able to be used.\n- If you're in \"debug\" mode, you don't require any optimization (logs, logs and logs :-) so what is the goal of minifying that file?\n. ",
    "rdewolff": "Hi both\nJust started testing totaljs today and had some similar thought in the begining.\nBut afterall, that's not really needed : you can configure all your settings in config-release or config-debug file.\nJust my 2 cents. \nCheers!\n. ",
    "mateuszgachowski": "So you rather suggest adding the less.js library as total.js module for full support? Just like with SASS example?\n. Can you release a version with it? 1.6.2? We rather do not want to use commit hash as our dependency. I would much appreciate it.\n. Thank you :+1: \n. I understand stages but they are not very \"enterprise\" tbh.\nIn enterprise env you will probably have more than just separation between dev and prod. You will have some stages that can use different settings during the deploy journey.\nWhat kind of info you exactly need? Is it possible to just load configs based on \"useConfig\"?\n. Looks ok for me. The other option would be to leave the 'config-' prefix for all the configs. It will make clear how the config pattern is defined. Anyway the first option is more flexible.\nfilename in the application root - maybe it can be just a path to the config for example? If you will have multiple configs it would be great to put them in a separate directory (for example: /configs).\nWhat do you think?\nThanks,\nMateusz\n. I think that .configure() seems that you should pass an object with configuration, useConfig seems more \"file based\" for me. But that is only my opinion - both will work :)\n. Thanks!\n. ",
    "acardinale": "Perfect!\nThank you\n. ",
    "traskat": "Hi,\npeter thanks for the fast reply. your tip with the empty line was correct.\nthanks a lot :)\n. Hi @petersirka,\ncan i just add the methods like post and get as a flag to the controller routes?\nthanks\n. thanks for the fast reply and help. \n. hi peter,\napi-1.js content\nexports.name = 'api-1';\nexports.version = '0.0.1';\nexports.install = function(framework, options) {\n    framework.route('/api-1/', api());\n};\nfunction api() {\n    var self = this;\n}\nthe api-1.js is located in the /controllers/ directory.\nthanks a lot for your help.\n. yes shame on me.\nsorry i didn't saw that. :/\nthanks again\n. ",
    "kevinriver": "npm install -g total.js\nafter global install, i still has the same error.\n\n{ Error: Cannot find module 'total.js/utils'\n    at Function.Module._resolveFilename (module.js:469:15)\n    at Function.Module._load (module.js:417:25)\n    at Module.require (module.js:497:17)\n    at require (internal/module.js:20:19)\n    at app (d:\\workspace\\nodejsdevelop\\company\\debug.js:17:2764)\n    at run (d:\\workspace\\nodejsdevelop\\company\\debug.js:17:3815)\n    at Object. (d:\\workspace\\nodejsdevelop\\company\\debug.js:17:4314)\n    at Module._compile (module.js:570:32)\n    at Object.Module._extensions..js (module.js:579:10)\n    at Module.load (module.js:487:32) code: 'MODULE_NOT_FOUND' }. \n",
    "netAction": "I had still the same issue. The \u201eSafe configuration\u201c works.. ",
    "g13013": "Hi @petersirka , I am actually trying to handle HEAD requests but there is not valid response\nI tried:\njs\nF.route('/test', handler, ['head'])\nF.route('/test', ['head']);\nany idea ?\n. Thanks @petersirka, I have 1.7.2, that's why it doesn't work as expected\n. any workaround for the current version ?\n. @petersirka Yes i mean v1.7.2, I am trying the v1.7.3 and it works, when do you think it will be released ?\n. @petersirka thanks you, I've submited a merge request on the nosql project to fix a problem with the nosql.one function. \n. oh it's unfortunate, it's because sometimes other modules/utils/cli's use predefined directories\n. backward compatibility Sure , that's why I suggested raising a deprecation message on the console to let the time for developers to migrate to the new config\nI think about a structure like this:\njs\nconfigs/\n   main.json // `default` accessible with `framework.config.main.key`\n   main_debug.json // accessible with `framework.config.main.key` overrides the previous key\n   custom.json // accessible with `framework.config.custom.key`\n   custom_debug.json // accessible with `framework.config.custom.key` overrides the previous key\n    ....\nWe can use either JSON or YAML, that allow us to have support object/array configs, YAML is more expressive and readable though.\n. contact me if you need help \ud83d\udc4d \n. Awesome, thank you so much :)\n. ",
    "asessa": "@petersirka true, I've updated it with allow-custom-titles\n. This example does NOT work with current branch, works with my change, but there is still an error on example code:\nif (auth.empty) {\nReturns:\nTypeError: Cannot read property 'empty' of null\nBecause baa returns null initially, can be fixed with:\nif (!auth) {\nAlso, in you example \"This is secured area\" is never shown, example can be fixed with :\n```\n    var auth = self.baa(\"This is secured area\");\nif (!auth) {\n    return;\n}\n\n```\n. I usually work on latest (npm install totaljs/framework),\nI've changed manually the index.js with the one you have linked and authentication works ONLY using a custom realm, the examples below do NOT work:\n```\n    var auth = self.baa();\nif (auth.empty) {\n    self.baa();\n    // self.baa() sends the response automatically.\n    return;\n}\n\n```\n```\n    var auth = self.baa(\"This is secured area\");\nif (auth.empty) {\n    self.baa();\n    // self.baa() sends the response automatically.\n    return;\n}\n\n```\n. Example with my update:\n```\n    var auth = self.baa('This is secured area');\nif (!auth) {\n    return;\n}\n\n```\n. ",
    "wahono77": "My goal is I want to create website app, desktop app, mobile app from same source code. and connect all my app to 1 server (totaljs framework server). I can user node-webkit, phoegap/cordova to convert web client site to app.\nThanks\n. Thanks for your answer Peter,\nany example about this?\nThanks\n. ",
    "dpoellath": "I'm looking for a working example for auth over websockets. Is there some example I'm missing? I tried hard to figure it out with the auth module, but I only managed to get auth working for regular routes, not websockets. i would really appreciate if you could help me out.. Hi,\nI tried it simular to the classic request; installing auth module and adding flag to websocket-route\n  F.websocket('/{room}/', socket, ['json', 'authorize']);\nBut I'm sure I oversee something. Perhaps you can add a example.\nPerhaps the Auth module is just not capable and I have to write it by myself; that would alos be no problem, but I'll wanted to use the auth-module, because I just wanted to enable both ways.\n. ",
    "BlaShadow": "Can I isolate that to a specific controller?\n. Awesome. Thanks.\n. ",
    "darrudi": "Thank you. \nBy the way please consider that I serve files dynamically, i.e. they are not actually on the server (they reside on a Gluster cluster) and based on the names received I figure out how to fetch and serve them.\nHave a good flight.\n. Thanks for the heads up. I managed to rewrite my routing based on a catch-all file route. Now it works but total.js issues some errors even though the files are served correctly. \nCode:\n```\nexports.install = function(framework) {\n    framework.file('All .', reRoute);\n};\nfunction reRoute(req, res, isValid) {\n    var regex = /\\/(attachment|thumb|icon|avatar)\\/(.*)/;\n    var matches = regex.exec(req.uri.pathname);\n    getThumbnail(req, res, matches[2]);\n}\nfunction getThumbnail(req, res, filename) {\n    var path = makeAbsolutePathFromUuid(filename);\n    var stream = fs.createReadStream(path);\n    if (!stream)\n        return;\n    self.framework.responseStream(req, res, 'application/octet-stream', stream);\n}\n```\nThis works but the following error is issued:\nError: Can't render headers after they are sent to the client. Error: Can't render headers after they are sent to the client.\n    at ServerResponse.OutgoingMessage._renderHeaders (http.js:731:11)\n    at ServerResponse.writeHead (http.js:1148:20)\n    at EventEmitter.Framework.response404 (E:\\Personal\\Active Projects\\Nikoo\\nikoomail\\webmail\\node_modules\\total.js\\index.js:2:16952)\n    at EventEmitter.Framework.responseFile (E:\\Personal\\Active Projects\\Nikoo\\nikoomail\\webmail\\node_modules\\total.js\\index.js:2:5131)\n    at EventEmitter.Framework.responseStatic (E:\\Personal\\Active Projects\\Nikoo\\nikoomail\\webmail\\node_modules\\total.js\\index.js:2:2317)\n    at Subscribe.doEndfile (E:\\Personal\\Active Projects\\Nikoo\\nikoomail\\webmail\\node_modules\\total.js\\index.js:4:7249)\n    at IncomingMessage.<anonymous> (E:\\Personal\\Active Projects\\Nikoo\\nikoomail\\webmail\\node_modules\\total.js\\index.js:4:180)\n    at IncomingMessage.emit (events.js:92:17)\n    at _stream_readable.js:943:16\n    at process._tickCallback (node.js:419:13)\nCan I tell total.js not to invoke its default route after I send the response?\n. Wonderful!!!\nThanx for your help and support.\n. Thanks. It worked after some modifications. \nI ran into the following problem whenI ran total (version 1700) to generate an angular app:\n\nAfter inspecting the code I added the following to line 233 of createFilePublicAngular function in total:\nfs.mkdirSync(modules);\nThe code snippet looks like this after the above addition:\n```\nfunction createFilePublicAngular(directory) {\nvar dir = path.join(directory, 'app');\nvar modules = path.join(directory, 'modules');\nfs.mkdirSync(modules);\nvar css = path.join(dir, 'css');\nvar controllers = path.join(dir, 'controllers');\nvar buffer = [];\n\nbuffer.push('User-agent: *');\nbuffer.push('Allow: /');\nbuffer.push('');\n...\n\n```\nNow, It works.\n. My total.js version reads 1.7.0 and the mail module as 1.5.0. Anyway, I updated the mail module to the latest version on github. I tried again but the problem persists.\n. Wow! that bug fix was quick! :)\nThanx it works! :+1: \nBy the way, I have a few suggestions regarding the mail module I file as new issues.\n. OK\n. It\u2019s Ehsan Darrudi.\nThanx! :)\n. Fine :+1: \n. done\n. :+1: Thanx. It works!\nBy the way i guess it is worth mentioning in the docs that the _layout.html must be renamed to layout.html when migrating from 1.7.0 to 1.7.1 (in addition to prepending old view names with a ~)\n. OK. Thanks again.\n. Sure, Please navigate to:\nhttp://mail.nikoo.ir\nand use the following info to login (sorry, the language is in Persian):\n\nthen look for a websocket error on the Chrome's or Firefox's console.\nHowever it is quite probable that you would not encounter any problem. As I mentioned before this problem happens for some computers residing on some networks. I can't figure out what causes the problem!\nAnd thanx for your help Peter! :)\n. Thanks for the compliments! :)\nYeah, I am sure that there isn't any redirect involved in the websocket logic.\nI traced the error and found out that when that cursed error happens it is actually handled by my default http route! it is my default.js:\n```\nexports.install = function (framework) {\n    //framework.route('/', view_app);\n    framework.route('/', view_app);\n    framework.route('/home', view_home);\n    framework.route('/print', view_print);\n    framework.route('/policy', view_policy);\n};\nfunction view_app() {\n    var self = this;\n    return self.redirect('/login');\n}\n//...\n```\nWhen that 302 error shows up, the '/*' routes has been activated indeed! This route redirects the user to the login page as you saw in the redirect response.\nI guess there is nothing wrong with total.js. However the websocket upgrade request is turned into an ordinary http request somehow, somewhere!\nI will dig into the matter tomorrow and post my findings here. If I failed I'd post the code for your kind review.\nThanks again Peter,\n. Sorry Peter, I was on a trip and had no access to internet at all. \nNow after a few days I cannot reproduce the problem! I am on the same computer and the same network. It is completely sporadic in nature. It is mind boggling indeed!\nAnyway, I continue monitoring the websocket problem and let you know when it happens again. Please leave the issue open for a few more days.\nThanx\n. Hi Peter, \nI extensively investigated the problem. I logged incoming connections to total.js and noticed wesocket connections have no upgrade command in this situation. e.g:\nheaders: \n   { host: 'staging.nikoo.ir',\n     pragma: 'no-cache',\n     origin: 'http://staging.nikoo.ir',\n     'sec-websocket-version': '13',\n     'user-agent': 'Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36',\n     'accept-encoding': 'gzip, deflate, sdch',\n     'accept-language': 'en-US,en;q=0.8,fa;q=0.6',\n     cookie: '__ssid=OTc9QU4CT0wNHE1cW0NKcVlMAQocHk0GDVwbW1cPZm9kLDQ8MGtGEVQfVwcEAkltSVJGSgNOBx8eDBIYSE5ETA0OGx9KHhEjOWw4aD8oZD1ARw; ...',\n     'sec-websocket-key': '2plrNNLzVAix5Ww2MBVWkg==',\n     'sec-websocket-extensions': 'permessage-deflate; client_max_window_bits',\n     'cache-control': 'no-cache, max-age=0',\n     connection: 'keep-alive' }\nit is the expected headers (a working example):\nheaders: \n   { host: 'staging.nikoo.ir',\n     connection: 'Upgrade',\n     pragma: 'no-cache',\n     'cache-control': 'no-cache',\n     upgrade: 'websocket',\n     origin: 'http://staging.nikoo.ir',\n     'sec-websocket-version': '13',\n     'user-agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36',\n     'accept-encoding': 'gzip, deflate, sdch',\n     'accept-language': 'en-US,en;q=0.8,fa;q=0.6',\n     cookie: '__ssid=OTc9QU4CT0wNHE1cW0NKcQoaBFkZSUpXDwgbW1cPZm9kLDQ8Yz1DQlFIUFYGVkltSVJGSgNOBx8eDBIYSE5ETA0OGx9KHhEjajo9Ozp-Y2xCEw;...',\n     'sec-websocket-key': 'voIySAu7w3K4wloc288Gfg==',\n     'sec-websocket-extensions': 'permessage-deflate; client_max_window_bits' }\nSo the faulty request is the culprit and I can say for sure that it has nothing to do with total.js. \nI checked websocket connections from my computer to another tested server (http://www.websocket.org/echo.html) and found them to be broken too. I don't know if it is my ISP or a third-party application (antivirus, etc) on my computers which causes the problem. I'll check it out further and post the result here when I cornered the issue.\n. Yeah, I sent it again to petersirka@gmail.com.\nThanx again.\nOn Sun, Apr 26, 2015 at 11:04 PM, Peter \u0160irka notifications@github.com\nwrote:\n\nHi @darrudi https://github.com/darrudi,\nI don't have any e-mail from you. Can you send me again with the problem?\nI'm waiting.\nThanks.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/totaljs/framework/issues/274#issuecomment-96418594.\n. That seems logical. Ok, then. I will file a bug on the Cassandra's issue tracker and and leave a reference here.\n\nThanx for looking into the matter.\n. Here it is the issue I filed on the Cassandra driver's issue tracker (JIRA):\nhttps://datastax-oss.atlassian.net/browse/NODEJS-109\n. For reference:\nI ended up warping the whole Cassandra driver in a new module and enclosing the callback in a try catch block. Anyway, I guess this is the Cassandra driver's duty to guard itself against these kind of problems. \n```\nmyDriver.execute = function(query, params, callback) {\noriginalDriver.execute(query, params, option, function(err, result) {\n\n    if (err) {\n        // log the error, whatever\n    }\n\n    try {\n\n        callback(err, result);\n\n    } catch (err) {\n\n        logger.error('UNCAUGHT-EXCEPTION: ' + err.message);\n        logger.log(err.stack);\n    }\n});\n\n};\n```\nThat will catch any error which might happen inside the driver's response and so solves the driver's crash in that situations.\n. At present we don't use nginx or any other kind of reverse proxy as we are still in the development phase. However, I'd consider using it if there isn't any other workaround.\nThanx\n. Yeah Peter, it solves the problem. However it brings about another issue regarding Websocket connections. In this mode I received this error (in the Chrome's console) while trying to connect to the server:\nWebSocket connection to 'wss://mail.nikoo.com/' failed: Connection closed before receiving a handshake response\nThe problem is not related to the new v1.9.0 version as I am able to get the desired output using this configuration (single HTTPS server):\n``` js\nvar fs = require('fs');\nvar options = {};\noptions.https = {\n    key: fs.readFileSync('keys/server/nikoo.com.key'),\n    cert: fs.readFileSync('keys/server/nikoo.com.crt')\n};\noptions.port = 443;\nrequire('total.js').https('release', options);\n```\n. ",
    "pssupport": "$ total -v\n\n1603\n\nVersion from npm\n$ node -v\n\nv0.10.32\n\n$ mkdir bug\n$ total ./bug\n$ cd bug\n$ mkdir logs\nEdit file controllers/default.js:\njavascript\nfunction view_homepage() {\n    var self = this;\n    LOG('i am bug :)');\n    self.view('homepage');\n}\nRun node debug.js\nOpen in browser http://127.0.0.1:8000/\nLook at the console:\n\nTypeError: Object # has no method 'apply' ([object Object])\n. > Can you download the latest version from GitHub?\n\nDownload latest version from GitHub. Errors remain.\nFull error stack:\njavascript\nTypeError: Object #<EventEmitter> has no method 'apply' ([object Object]) \nTypeError: Object #<EventEmitter> has no method 'apply'\n    at global.LOG (bug\\node_modules\\total.js\\index.js:1:1972)\n    at Object.view_homepage (bug\\controllers\\default.js:7:2)\n    at Subscribe.doExecute (bug\\node_modules\\total.js\\index.js:4:4221)\n    at Subscribe.execute (bug\\node_modules\\total.js\\index.js:4:2949)\n    at Subscribe.prepare (bug\\node_modules\\total.js\\index.js:4:3911)\n    at Subscribe.doEnd (bug\\node_modules\\total.js\\index.js:4:5818)\n    at IncomingMessage.<anonymous> (bug\\node_modules\\total.js\\index.js:4:1808)\n    at IncomingMessage.emit (events.js:92:17)\n    at _stream_readable.js:943:16\n    at process._tickCallback (node.js:419:13)\n. @yanickrochon It's easy to do yourself with a definition.\nExample: definitions/customevents.js\njavascript\nframework.on('install', function(type, name) {\n    this.emit('install.' + type + '.' + name);\n});\nAnd in your code:\njavascript\nframework.on('install.module.auth', function() {\n    console.log('Module auth installed');\n});\n. For custom events we can write any code.\n. I'm try this release: https://github.com/totaljs/framework/releases/download/v1.6.3/empty-project.zip\nThis does not give effect\nI'm try git clone framework. This does not give effect.\nI'll try to find problem.\n. @petersirka All ok. Version with github works. The problem was with the npm cache.\nVersion in NPM is bad? Always need use with githab?\nTo use version 1.7.0, I configured package.json project as follows:\njavascript\n\"dependencies\": {\n     \"total.js\": \"https://github.com/totaljs/framework/tarball/master/minify/total.js\"\n   }\nHopefully now no problems ...\n. * I did this:\njavascript\nprocess.on('message', function (msg) {\n    if (msg === 'debugging') {\n        if (CONFIG('debug')) {\n            framework.on('ready', function () {\n                this.worker('watchfiles');\n            });\n        }\n    }\n});\nDo not know whether this is correct.\n. @petersirka No, it's not that. I need to know that the framework is started for the first time. To run one a worker. When you restart, I do not want to kill him. Only when stopping framework.\nIn my example above, the message \"debugging\" is sent only once - at the start of the framework. This is what me need! But in the context of the framework.\nEvent restart is also useful for other tasks.\n. @petersirka Oh, yes. This will be enough. Sorry for my English. My native language is Russian.\n. @petersirka Does not work.\n- I always get a debug-start.\n- Event debug-restart is never called.\n- Event exit is never called.\nI'm add to your code:\njavascript\n    if (first) {\n        first = false;\n        framework.emit(\"debug-start\");\n        return\n    }\n    console.log('I am restarting...'); <-- this\n    framework.emit(\"debug-restart\");\nThis message does not appear in console.\n. @petersirka Yes! Now it works! Thank you!!!\ndebug-start, debug-restart, exit - all works.\nAnother question :flushed: How to get configuration of framework from worker?\nFor example: how to know where the public (images, controllers, etc...) directory?\n. > worker.send(framework.config)\nYes, this is what I need. Thank you @petersirka .\n. @petersirka events debug-start and debug-restart not working again\n. ",
    "yanickrochon": "yeah, it's an idea. However, the code should be more like\njavascript\nframework.on('install', function(type, name) {\n    if (type === 'module') {\n        this.emit('install.module.' + name, MODULE(name));\n    } else {\n        this.emit('install.' + type + '.' + name);\n    }\n});\n. @petersirka May I suggest you provide a little bit more code? First, what is users and where are you declaring it? Second, you have a statement like SUGAR = something + SUGAR, what's SUGAR?\nI would also recommend using StackOverflow for this kind of intervention, since Github is really not the place to ask implementation-specific questions, especially on a project not directly related to a repository (in this case totaljs/framework).\n* Edit *\nIf you ask questions on SO, avoid opinion-based questions, or you'll get disappointed :)\n. ",
    "joerg-krause": "Moved to totaljs/documentation\n. Classic routing does not call the fn function:\n``` js\nexports.install = function(framework) {\n  framework.route('/api/static.txt', static);\n};\nfunction static() {\n  console.log('hello world');\n  self.json({ hello: \"world\" });\n}\n```\nNo output..\nSecond method does not work either. I am receiving no data in the event method.\nJust for clarification. I am using curl to simulate the external interface with this command:\nsh\ncurl -X POST -H \"Content-Type: text/plain; charset=UTF-8\" -d \"{\\\"hello\\\": \\\"world\\\"}\" $IP:$PORT/api/static.txt\n. I also tried using middleware for the static file routing, but unfortunatly the middleware is not called. Middleware is copied from examples/middleware.\ncontrollers/default.js:\n``` js\nexports.install = function(framework) {\n  framework.route('/api/static.txt', static, { flags: ['raw', 'post'], middleware: ['B'] } );\n};\nfunction static() {\n  console.log('hello world');\n}\n```\ndefinitions/middleware.js:\n``` js\nframework.on('load', function() {\n  framework.middleware('B', function(req, res, next, options, controller) {\n    console.log('B');\n    if (controller) {\n      controller.repository.B = 'middleware - private - B';\n        }\n    next();\n  });\n});\n```\nI get the output from the function, but not from the middleware.\n. Okay, I can get an output from the middleware now. I forget isValidation\njs\nfunction static() {\n  if (isValidation)\n    return true;\n  console.log('hello world');\n}\nand had to change the route:\njs\nexports.install = function(framework) {\n  framework.file('/api/static.txt', static, ['B'] );\n};\nBut the middleware does not have any controller.\n. I'm still not getting the request body for:\nsh\ncurl -X POST -H \"Content-Type: text/plain; charset=UTF-8\" -d \"{\\\"hello\\\": \\\"world\\\"}\" $IP:$PORT/api/static.txt\nIt logs the body if I omit the static.txt from the request, but this will not work with my external interfaces (which I cannot change).\nHow about the approach of using static file routing and middleware? Can I access the request body in the middleware? I had no success yet...\n. ",
    "fym201": "It's a very simple test code():\n``` js\nvar mongoose = require('mongoose');\nvar ObjectID = mongoose.Schema.Types.ObjectId;\nvar prefix = '/api/user';\nexports.install = function(framework) {\n    debugger;\n    framework.route( prefix + '/{userId}/', json_user_info);\n    framework.route( prefix + '/register/', json_user_register, ['xhr', 'post']);\n};\nfunction json_user_info(userId) {\nvar self = this;\nvar User = MODEL('user').schema;\nUser.findOne({_id: ObjectID(userId)}, function(err, result){\n    if (err)\n        self.throw500(err);\n\n    self.json(result);\n});\n\n}\nfunction json_user_register() {\nvar self = this;\nvar User = MODEL('user').schema;\n\nself.plain( \"api:1111\" );\n\n}\n```\n. Hi @petersirka ,\nI add the breakpoint at  total.js/index.js's  function Framework() {}, get this error:\nCannot stop on breakpoint due to internal error: TypeError: undefined is not a function \nat Function.r.doFindMirror (eval at   (d:\\node-app\\bigtree_total\\index.js:7:1),  :106:15) \nat r.S.findMirror (eval at   (d:\\node-app\\bigtree_total\\index.js:7:1),  :98:18) \nat t.getOrCreateMirror2 (eval at   (d:\\node-app\\bigtree_total\\index.js:7:1),  :231:32) \nat t.getOrCreateMirror (eval at   (d:\\node-app\\bigtree_total\\index.js:7:1),  :228:19) \nat t.describeFrame (eval at   (d:\\node-app\\bigtree_total\\index.js:7:1),  :219:65) \nat t.getFrames (eval at   (d:\\node-app\\bigtree_total\\index.js:7:1),  :120:89) \nat DebugCommandProcessor.r.processDebugJSONRequest (eval at   (d:\\node-app\\bigtree_total\\index.js:7:1),  :342:15) \nat DebugCommandProcessor.processDebugRequest (native) \nat EventEmitter.Framework (d:\\node-app\\bigtree_total\\node_modules\\total.js\\index.js:124:13) \nat Object.  (d:\\node-app\\bigtree_total\\node_modules\\total.js\\index.js:12008:37)\n. Hi @petersirka , the email has been sent\n. ",
    "tkang007": "Thanks Peter!\n. ",
    "stact": "Working  like a charm! Thank you very much for your help! :D I need to ask santacruz to give me a brain ^^\nHope i will find my happyness with totaljs :) \nThank you again!\n. Thank you!\n. ",
    "satrong": "Thanks for your reply, i have solved this problem. In the release.js, i just write: global.mongoose=require(\"mongoose\").\n. Think you, @petersirka \nThis is the self.req.headers's info:\njs\n{\n    \"x-real-ip\" : \"183.60.235.57\",\n    \"x-forwarded-for\" : \"183.60.235.57\",\n    \"host\" : \"www.xiaoboy.com\",\n    \"x-nginx-proxy\" : \"true\",\n    \"connection\" : \"upgrade\",\n    \"accept-encoding\" : \"gzip\",\n    \"x-real-forwarded-for\" : \"116.30.110.198\",\n    \"accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\",\n    \"user-agent\" : \"Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36\",\n    \"accept-language\" : \"en-US,en;q=0.8,zh-CN;q=0.6,zh;q=0.4\",\n    \"cookie\" : \"\",\n    \"x-from\" : \"FHL\"\n}\n. @petersirka , you can open this url http://www.xiaoboy.com/test\nMy IP is 116.30.110.198.\n. Yeah, I can get real IP.\nI just want get real IP whether use CDN if I use self.req.ip, because I think the CDN's IP is unuseful.\nIf I use self.req.ip can get real IP, I didn't care about if use CDN.\nThis is just my suggestion.\n(Hope you understand my thought.)\n. OK, thank you.\n. I has send to you.\n. Hi @petersirka ,\nthe gmail rejected my mail, I has uploaded the files on Github https://github.com/satrong/example\n. I am sorry to cause you trouble.\n. ",
    "antoine-pous": "Can we pass values to the controller from the view?\nI can get the fragment with a bit of client-side JavaScript.\n. I understand, i have already choose this way :+1: \nThank you for your help\n. ",
    "dacrhu": "Mea culpa, sorry :)\nOther solution:\nvar image = Image.load('filename', true);\n. After or before, all the same. The date will be helpful.\n. Will framework rotating log same like currently? Or in the future need to rotate the logs with logrotate application?\n. Sorry, my english is bad :)\nCurrently in documents page I find one function: framework.log().\nThis method make files, something like this: YYYY-MM-DD.log\nTherefore I suggested similar filenames.\nThank you for your work!\n. Ok, working fine, thx! Eventually I can init a Date object to filename. ;)\n. Yes, it is perfect!\n. Thx!\n. That's great, working fine!\nThank you Peter!\n. Hi Peter and Levente\nthe problem is in \"import\" method.\n@{import('meta', 'head', default.css', 'default.js', 'favicon.ico')}\nIf I change to\n@{meta} @{head} @{import('default.css', 'default.js', 'favicon.ico')}\nworking fine.\nBest regards,\nDavid\n. node.js      : v5.0.0\ntotal.js     : v1.9.3\n. controller-user.js:\njavascript\n...\ncodeFromCache = yield sync(SOURCE('memcached').get('activation-' + this.body.type + '-' + this.user.userName))();\n...\nsource memcached.js:\njavascript\nexports.get = function (key) {\n    var Memcached = require('memcached');\n    var memcached = new Memcached(CONFIG('memcachedIp') + ':' + CONFIG('memcachedPort'));\n    return function (callback) {\n// memcached.get(key, callback)\n        memcached.get(key, function (err, result) {\n            callback(null, result);\n        });\n    };\n};\n. Yes, your example is working fine.\nIf I call callback directly with null:\njavascript\ncallback(null, result);\nit working fine, but the memcached module response \"undefined\" instead of \"null\".\nSimilarly:\njavascript\nsetTimeout(function() {\n            callback(undefined, 'OK: ' + key);\n}, 1000);\nResult is 500 error.\nOther:\nin ES6:\njavascript\nfunction* view_index()\nin Total.js:\njavascript\nfunction *view_index()\nIs there a difference between the two?\n. Thanks :)\n. Working fine, good job :)\nThank you!\n. Sorry, copy paste error :) I edited the topic.\n. With 2.0 is same.\n```\n[dacr@dacr teszt]$ totaljs -translate\n\ntotal.js - web application framework for node.js\nversion: v2.0.0-59\n\ntotal.js: creating translation\ntotal.js: the translation was created (0 texts)\n[dacr@dacr teszt]$ cat translate.resource \n// Total.js translation file\n// Created: 2016-07-03 21:31\n```\n. Ok, PEBKAC.....\nI close this ticket.\n. Sorry for the late reply!\nWorking fine, thank you!. Ok, thank you, I modify my code.. self.req.ip. Note: If I call F.route with curl then it working fine.. Result is same with beta.\nClient side code:\n$('#menu-logout').on('click', function(event) {\n    $.ajax({\n        url: config.protocoll + '://' + config.backendURL + '/api/auth',\n        type: 'DELETE',\n        contentType: 'application/json; charset=utf-8',\n        data: JSON.stringify({\n            \"id\": id\n        }),\n       headers: {\n            'Authorization': 'Bearer ' + localStorage.getItem(config.tokenName),\n        }\n    }).done(function(data) {\n        window.location.href = config.protocoll + '://' + config.backendURL + \"/index.html\";\n    });\n});\n\nThis is working with restful2:\n     $.ajax({\n            url: config.protocoll + '://' + config.backendURL + '/api/admin/users',\n            type: 'delete',\n            contentType: 'application/json; charset=utf-8',\n            data: JSON.stringify({\n                \"id\": id\n            }),\n            headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem(config.tokenName),\n            },\n            statusCode: {\n                401: function() {\n                    $('#menu-main').hide();\n                    $('#content').load('/elements/login.html');\n                }\n            }\n        }).done(function(data) {\n            getusers(currentPage);\n            $('#userremovewarning').modal('hide');\n        });. I removed the schema because not need it.\n\nThis is the full code:\nexports.install = function() {\n    F.route('/api/auth', logout, ['delete', 'authorize', 'cors']);\n}\nfunction logout() {\n    var self = this;\n    SOURCE('redis').remove(CONFIG('redisDBSession'), self.user.id);\n    SOURCE('redis').remove(CONFIG('redisDBChangePassword'), self.user.id);\n    self.json(SUCCESS(true));\n}\nIt is very simple.\n@molda result is same with json flag.\nNode.js     : v6.11.4\nTotal.js    : v2.8.0\nOS          : linux 4.13.5-200.fc26.x86_64\nI use JQuery 3.2.1. @molda  Unfortunately not.. I found solution:\n```\nF.on('service', function () {\n    console.log('service ' + new Date());\n});\nF.schedule(new Date('02:12'), '1 day', function () {\n    console.log('schedule 02:12 - ' + new Date());\n});\n```\nPlease update the documentation.\nThank you!\nDavid. Sorry, not work yet.\n```\nF.schedule('09:29', '1 day', function() {\n    console.log('schedule 09:29 - ' + new Date());\n});\nF.on('service', function() {\n    console.log('service ' + new Date());\n});\n```\n```\n--------> DEBUG PID: 18742 (v3.1.0)\n====================================================\nPID           : 18748\nNode.js       : v8.12.0\nTotal.js      : v3.1.0\nOS            : linux 4.18.11-200.fc28.x86_64\nMemory        : 17.56 MB / 31.97 MB\n====================================================\nName          : test\nVersion       : 0.0.7\nAuthor        : dacr\nDate          : 2018-10-24 09:27:53\nMode          : debug\n====================================================\nDirectory     : /home/dacr/develop/backend\nnode_modules  : /home/dacr/develop/backend/node_modules/total.js/\n====================================================\nhttp://0.0.0.0:8000/\nservice Wed Oct 24 2018 09:28:52 GMT+0200 (CEST)\nservice Wed Oct 24 2018 09:29:52 GMT+0200 (CEST)\nservice Wed Oct 24 2018 09:30:52 GMT+0200 (CEST)\nservice Wed Oct 24 2018 09:31:52 GMT+0200 (CEST)\n```. Yes, working fine :)\nservice Wed Oct 24 2018 09:53:28 GMT+0200 (CEST)\nservice Wed Oct 24 2018 09:54:28 GMT+0200 (CEST)\nschedule 09:54 - Wed Oct 24 2018 09:54:28 GMT+0200 (CEST)\nThank you Peter!. ",
    "ludydoo": "Thank! That was fast.\nOk, so if there are nested dates in the body like  \n{\n  \"name\" : \"John Wick\",\n  \"born\" : \"\u200c1987-10-10T04:00:00.000Z\",\n  \"died\" : \"\u200c2015-01-01T04:00:00.000Z\",\n  \"films\" : [\n    {\n      \"name\" : \"Film 1\",\n      \"date\" : \"\u200c2011-01-01T04:00:00.000Z\"\n    },\n    {\n      \"name\" : \"Film 2\",\n      \"date\" : \"\u200c2012-01-01T04:00:00.000Z\"\n    },\n    {\n      \"name\" : \"Film 3\",\n      \"date\" : \"\u200c2014-01-01T04:00:00.000Z\"\n    },\n    ...\n  ]\n}\nthey have to be parsed manually?\n. That's what I was looking for. Indeed, many questions.\nAre there examples on the usage of SchemaBuilders I could consult?\n. ",
    "neonnds": "Just for those interrested. I have several total.js projects that build on top of a base project. \n-Core-Site\n--controllers\n---Core-Site\n----home.js\n--assets\n---static\n---views\n...\n-SiteA\n--controllers\n---SiteA\n----home.js\n--assets\n---static\n---views\n...\n-SiteB\n--controllers\n---SiteB\n----home.js\n--assets\n---static\n---views\n...\nThis allows me to share code easily etc, and not double up effort from project to project. \nI then have a bash script that deploys resources (controllers, views, etc) into a new site..called Live.\nSo for example: $> ./delpoy.sh SiteA\nThis would result in a new project with the following structure:\n-Live\n--controllers\n---Core-Site\n----home.js\n---SiteA\n----home.js\n--assets\n---static\n---views\nI can then just run the live site with nodejs.\nThere are problems with this approach, in that you have to deploy every time a resource changes. But if your from the J2EE world this is normal. It also means you have to be careful not to have resource collisions and url mapping issues. I solve this by putting resources in folders with the site name and I have a mapping JS file for urls.\nJust food for thought...for those with large sites and doubled up resources.\n. Ok sounds good. Its nice to know you can overwriting existing functionality, but ultimately its best to be able to say...this is the core framework...and these are auxiliary modules that are optional. Keep up the good work. \n. Good work. Love your work!\n. Your right. I should have used Controller.prototype.file()...works like a charm!\n. That did the trick. So it seems it needed an absolute path instead of relative. Love your work Peter.\n. Your right Peter. \nI opened an issue with the node.js team.\nhttps://github.com/nodejs/node/issues/11145. ",
    "admorphit": "Thanks, it works- found that can also fix by adding default-layout: app in config file.\nLooks like command\nnpm install total.js --save\nuses app.html in the folder /app/views instead of layout.html which caused the problem.\nKeep improving totaljs!\n. ",
    "fatihky": "Hi @petersirka, thanks for your response. I tried this and it is working now.\n. ",
    "evmek": "Ok. No problem.\nI was solved by CoffeeScript --watch param.\nThanks\n. Hi @petersirka \nI use Chrome 43.0.2357.124 m\nand \n```\nexports.install = function() {\n    F.route(\"/timeout/\", m.Bos, {\n      timeout: 15000\n    });   \nF.route(\"#408\", m.f408);\n\n};\nvar  m = {\n   Bos: function() {}\n   , \n   f408: function() {\n      this.json(SUCCESS(false));\n   }\n}\n```\nthis code is work good , i use  F.route \"#408\"  problem solved\n. ",
    "sarankup": "total.js is brilliant. Thanks Petersirka.\n. Hi @Petersirka,\nI am not sure on this route implementation. Here is my controller\nframework.route('/postsubmit',postsubmit,['post']);\nfunction postsubmit(){\n    var self=this;\n    var model=self.body;\n    model.by=new Date();\n    var myDate=new Date();\n    myDate.setHours(myDate.getHours()+model.expire);\n    model.expire=myDate;\n    var users=framework.database('post');\n    users.insert(model,{w:1},function(err,object){\n        if(err){console.warn(err.message);}\n        else{console.dir(object);\n        }\n    });\n    sendemail();\n    self.json({success:true});\n}\n. Hi @Petersirka,\nThank you so much. It works very well. I think, I need study the documentation.\n. Hi @petersirka,\nThank you so much. I think, I had refreshing issue in the browser. total.js rocks!\n. Here is my mongodb.js\n```\nvar MC=require('mongodb').MongoClient;\nvar DB=null;\nMC.connect('mongodb://localhost:27017/mydatabase',function(err,db){\nif(err) throw err;\nDB=db;\n});\nframework.database=function(collection){\nif(collection) return DB.collection(collection);\nreturn DB;\n};\n```\nmongodefault.js\n```\nvar stringmodel=require('string');\nvar ObjectId=require('mongodb').ObjectID;\nvar email=require('total.js/mail');\nemail.on('error',function(err){console.log(err);});\nvar nodemailer=require('nodemailer');\nvar async=new Utils.Async();\nvar gi=0;\nvar dbvalues={};\nexports.install = function(framework){\n    framework.route('/db',view_db);\n    framework.route('/newadd',new_add);\n    framework.route('/postsubmit',postsubmit,['post','xss']);\n    framework.route('/contactpagesubmit',contactpagesubmit,['post','#session']);\n};\n.\nfunction showhome(){\n    var self=this;\n    self.view('home',self.body);\n}\nfunction getposts(){\n    var self=this;\n    framework.database('pure').find().limit(10).toArray(function(err,docs){\n        if(err){self.json({success:true});}\n        else{self.json(docs);}\n    });\n}\nfunction getmyposts(){\n    var self=this;\n    framework.database('pure).find().limit(10).toArray(function(err,docs){\n        if(err){self.json({success:true});}\n        else{self.json(docs);}\n    });\n}\n```\n. Well. Does this mean it is not anything about internet connection in the computer? Is the problem occurs because my home page (first page of the my application) using database connection?\n. ",
    "hepr": "Hi Peter,\nall is good with beta version\nThanks,\nHerve\nHerve Prot\nPresident LE&CO\n2 rue des Faubourgs\nF-63960 Veyre-Monton\nTel : +33 6 76 76 17 65\nherve.prot@leandco.fr\n2015-04-02 9:45 GMT+02:00 Peter \u0160irka notifications@github.com:\n\nHi @hepr https://github.com/hepr,\ndo you have the latest beta version?\n$ npm install total.js@beta\nGive me a feedback.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/totaljs/framework/issues/264#issuecomment-88798685.\n. Hi\n\nYou can find all documentation on http://docs.totaljs.com with more than 100 examples.\nHerve\n\nLe 5 nov. 2016 \u00e0 01:02, jack0088 notifications@github.com a \u00e9crit :\nThe framework seems to be very solid as from what I've seen, but I couldn't find any proper tutorial on the web.\nIs there any step-by-step text guide on how to create a complete 'To-Do-App' or a simple 'Blog' (with database, schemas, authentication, password encryption, cookies or session,..)? I can't figure it out by the sparse docs and examples.\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub, or mute the thread.\n. Thank you for your response :-)\n\n. ",
    "ghost": "Hi Peter, \nThanks for your very quick response. Maybe I should have specified that at the end of both methods I return a json stream using self.json(...). So If I remove the json flag and keep invoking my API, I get a 400 response. \n. Great !!! Thanks for your availability and efforts !\n. Hi Peter, \nStill have the same behavior, sorry :(\n. Hi Peter, \nI must be missing something, what I did was to  create an index.js file that contains the first line of your dropbox example (require(total) etc). Then I started my node server on this JS file. I copy/pasted the whole example and here's what I get in the console : \nGET: GET undefined\nGET: POST application/json\nGET: POST application/json\nGET: POST application/json\nGET: POST application/json\nSo eventhough the self.req.method is correct when using post it is still invoking the GET action, right ? \nSorry for bothering you with that. \n. Hi Peter, \nThe version is wrong I still have the build 50 instead of 51 but I can't get to install the version 51 could you publish it please ? \n. Hi Peter, \nMy bad, when I try the 51 build, it works just fine. Thanks for everything. \n. ",
    "maxxam11": "understood. Thank you very much.\n. Hello. This is my view file.\n don't work\n@{foreach hour in model.weather.hourly.data}\n            \n@{index == 0 ?\n'\u0441\u0435\u0439\u0447\u0430\u0441' : hour.now.timeFormat}\n<tr><td class=\"wether-block-hourly__icon\"><img\nsrc=\"@{hostname}/img/weather/100/@{hour.iconN}.png\">\n@{hour.temperature}\u00b0\n<tr><td class=\"wether-block-hourly__wind\">\n                <svg id=\"svg_@{index}_@{hour.windBearing + '_' +\n(hour.wind.speed > 20 ? 20  : hour.wind.speed)}\"\n                        xmlns=\"http://www.w3.org/2000/svg\"\n                        xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                        x=\"0px\"\n                        y=\"0px\"\n                        width=\"268.832px\"\n                        height=\"268.832px\"\n                        viewBox=\"0 0 268.832 268.832\"\n                        style=\"enable-background:new 0 0 268.832 268.832;\"\n                        xml:space=\"preserve\"\n                        version=\"1.1\">\n                        ",
    "sant123": "Hi @petersirka, \u00bfthis code would have performance impacts? \njs\nF.map(\"fonts/\", \"~/node_modules/bootstrap/fonts\");\nF.map(\"fonts/\", \"~/node_modules/font-awesome/fonts\");\nI don't find other ways to expose fonts from vendors.\n\u00a1Thank you!. File lauch.json should be like this:\njson\n{\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"type\": \"node\",\n            \"request\": \"launch\",\n            \"name\": \"Launch Program\",\n            \"program\": \"${workspaceRoot}/debug.js\"\n        }\n    ]\n}\nAnd debug.js like this:\n``` js\nconst options = {};\n// options.ip = '127.0.0.1';\n// options.port = parseInt(process.argv[2]);\n// options.config = { name: 'Total.js' };\n// options.sleep = 3000;\n// options.inspector = 9229;\n// options.debugger = 40894;\n// require('total.js/debug')(options);\nrequire('total.js').http('debug', options);\n```\nEverything working :smile: \nPID         : 12619\nNode.js     : v8.2.1\nTotal.js    : v2.7.0\nOS          : linux 4.10.0-30-generic\n. Awesome. Thank you @vespaiach \ud83e\udd13. Everything working!!!!!. Thank you both for your help. :smile: . ",
    "martinambrus": "Thank you, I'm unable to test this at the moment, as I'm on a shared FS for which I cannot install totaljs via NPM (I've just used the default project). Please do test it on your projects and thanks again for the quick response :)\n. Thank you, I can confirm that this update has fixed it for my project.\n. ",
    "jhonny111s": "what's default timeout?. if i want use other meta tag for example twitter:card, what's the way.\nfunction categories(category) {\n    var self = this;\n    self.title('Categories');\n    self.description('description Categories');\n    self.keywords('keywords categories');\n //another meta tag ?\n.\n.\n}. ",
    "raisty": "@LeventeNagy  That's not me question. But maybe is the problem hard to understanding. Anyway thank you for reply.\n@petersirka Sure.\n1. I have in layout.html @{meta}\n2. I have in index.html @{meta('@(Subtitle)', '@(Desc)', 'keys')}\n3. I have in config title: My amazing website\nI want:\n1. If no @{meta...} is defined in index.html or nothing is clicked, there would be title from config \"My amazing website\".\n2. If @{meta...} in index.html is defined - \"My amazing website - Subtitle\"\nIn slovak language:\nProste chcel by som, aby titulok zo stranok v layoute bol iba pridavkom k titulku zakladnemu. Ak nejaky existuje doplni sa nejaky znak, trebars pomlcka a potom titulok v layoute. Cize priklad: \"My amazing website - login\". \nNenasiel som sposob ako by sa to dalo docielit, lebo ked pridam k @meta v layoute tag title, su tam potom dva. Ked dam @{title(config.title)} pred @meta tak ide titulok zakladny, ale musim porozmyslat ako tam pridam ten pridavok.\nDakujem\n. Thanks for advice. I work on registering form.\nI have template with view and form in route /register and i want work with the submited data (POST) on same route.\nIn this case i have there 'view page' which may made - show the template with form. But this is only example. I don't have in mind which request show the template, maybe GET.\nI think this is only me missunderstanding, but I try do the solution and then I close this issue.\n. Ok, this do the job:\njavascript\nF.route('/register', view_register, ['get','post']);\n. Try run as follows:\nrequire('total.js').cluster.http(5, 'release', options);\nThen your mention is correct. I am using require.. Thank you, problem solved.. Thank you for advice.\nI try it without ! also try put there some headers in {}.\nNo success at all.\nTry function AJAX also.\nIt surprising me that normal javascript works perfect.\nCan we elaborate my problem? I will give you full specs.. Sure Peter. I test our API as well and seems there is no problem on server.\nI will send you API test case and Javascript example, which work.. After updating jComponent to latest version, works like charm.\nThank you Peter!. Thank you for information.. ",
    "dbelca": "Many thanks for your very quick response.\nYou are right, I changed my code and added an empty dummy cookie object and the behavior change a bit.\nI generate the header Object this way:\n```\nfunction getAPIHeader(key) {\n    var base64 = require('js-base64').Base64;\nkey = key || '';\n\n// use username, leave pw empty\nauthorization = base64.encode(key + ':');\n\nreturn {\n    Authorization: authorization\n};\n\n};\n```\nSo I would expect that \nvar auth = request.authorization();\napiKey = auth.user;\nwould giv me my key back. But it contains (loged as JSON):\n{\"user\":\"\",\"password\":\"\",\"empty\":true}\nWhen I use a Client like Needle, this works perfectly. Can you please tell me where I could find a hook to debug this further?\n. Argh, sorry. I fucked up the Basic Authentication, the \"Basic \" part was simply missing.\nThanks for your Help, there is no Framework issue here.\n. ",
    "xdascx": "Hi Peter,\nPlease use the following for testing, I'll be deleting the email account as soon as you're done with it. :)\nusername: ** (removed)\npassword: **** (removed)\nSecure settings:-\nmoore.uk-noc.com\nSMTP Port: 465\nInsecure settings:-\nmail.3byte.net\nSMTP Port: 26\n. Hi Peter,\nUnfortunately the mail server is hosted by a 3rd party and I don't have access to any of the mail configurations :(\n. Brilliant!  Works like a charm! :D \n. ",
    "teckays": "Hi @petersirka,\ntotal.js -v  = 1.4.9\nI'm not quite sure what you think by serialising, the model.response is passed into the view as a JSON object already. I mean it's an elasticsearch response which is an object. Also the item is really big to paste it here. The response is well JSON formatted if that's the question.\n. @petersirka https://gist.github.com/teckays/fa0b22c95bb6bcb34fc7\n. sorry wrong paste. will edit the gist shortly\n. done https://gist.github.com/teckays/fa0b22c95bb6bcb34fc7\n. @petersirka this is the output from @{json(model.response)}. I'm iterating this object and pass each object item into the polymer custom component\nhtml\n@{foreach item in model.response}\n    <my-component item=\"@{item}\"></my-component>\n@{end}\nmodel.response is the one in gist which is an array of objects, therefore each item is an object that gets passed into <my-component>\n. @petersirka there's an error using that [object] has no method 'escape'\n. @petersirka worked, thank you.\n. ",
    "alsemany": "Thank you for your reply I will try to use harmony argument, \nhowever I think there's no support to harmony while using (forever) to run the application server \nI will check for this \nThank you so much\n. ",
    "CCharlieLi": "Hi @petersirka ,\nI'm not sure that javascript code without semicolon is a bad code, it's just another code style, have a look at No semicolons unless necessary.(although I'm more comfortable with semicolon), but as a standard JS compressor, it should check the code and insert semicolon if necessary. Just a suggestion. ; )\nCheers.\n. ",
    "zixd": "Hi, Peter!\nI had the same problem of LeventeNagy!\nI also tried with the empty project (https://github.com/totaljs/framework/releases/download/v1.8.0/empty-project.zip) but I got the same error.\nCould you tell me how did you solve this issue?\nThanks!\nHave a nice day!\nP.S.: Great framework!\n. Solved! With the latest version of node.js (v0.12.7) no more bugs!!!\nThanks again! Great help!\nBye! \n. ",
    "liaosankai": "@petersirka I had sent. Thank you for your assistance.\n. ### npm install -g total.js@beta\n\nMake package file again\nuse totalpackage create firstpackage for firstpackage.package\nuse totalpackage create firstpackage2 . for firstpackage2.package\n\nTry firstpackage.package file\nPackage load\n\nOpen http://127.0.0.1:8000/hello-world/ in brower\n\nTry firstpackage2.package file\nPackage load\n\n. Rename export.id=helloworld and try make again, it's working now. \n\n\n\nI also rename export.id=helloworld2 and use totalpackage create helloworld2 . (with '.') make package file helloworld2.package to sent for you.\n\n\n. ### version\ntotal.js -v \n1930\nTest-1\nHTML:\n<p id=\"t1\">Test</p>\ncompile:\n<p id=\"t1\">Test</p>\nTest-2\nHTML:\n<p     id=\"t2\">Test</p>\ncompile:\n<pid=\"t2\">Test</p>\nTest-3\nHTML:\n<p     \n    id=\"t3\">Test</p>\ncompile:\n<pid=\"t3\">Test</p>\nTest-4\nHTML:\n<p id=\"t4\" title=\"\">Test</p>\ncompile:\n<p id=\"t4\" title=\"\">Test</p>\nTest-5\nHTML:\n<p id=\"t5\"    title=\"\">Test</p>\ncompile:\n<p id=\"t5\"title=\"\">Test</p>\nTest-6\nHTML:\n<p id=\"t6\"    title=\"\"    data-test=\"\">Test</p>\ncompile:\n<p id=\"t6\"title=\"\"data-test=\"\">Test</p>\nTest-7\nHTML:\n<p id=\"            t7   \" title=\"\" data-test=\"\">Test</p>\ncompile:\n<p id=\"t7\" title=\"\" data-test=\"\">Test</p>\n. I try uninstall total.js and npm install total.js@beta again.\n\nIt's working well.\n\n. ## Test for Mapping directories F.map('xyz','public');\nUse git bash on Win7\n\nTest url paths:\n- /xyz/favicon.ico\n- /xyz/robots.txt\n- /xyz/css/default.css\n- /xyz/js/default.js\nResult Screenshot:\n\n\n\n\nIt's working.\nTest Mapping for packages F.map('/my-assets', '@helloworld/assets');\nI make package again after update to v1.9.3-19\n\nUse package in new total.js \n\nResult Screenshot:\n\n\n\nIt's working,too.\n. Hi, @LeventeNagy \n@see line 22 in https://github.com/totaljs/modules/blob/master/Miscellaneous/flash/v1.00/flash.js \nflash[id].expire = Date.now() + ((1000 * 60) * 5); // 5 minutes\nModify for you want :)\n. Sorry, I should to try it before ask\ncontroller:\nfunction view_index() {\n    var self = this;\n    self.view('index', {\n        \"count\": 99\n    });\n}\nviews:\n<p>@(I have @{model.count} books)</p>\nYes! It's working well.\n\n@see http://docs.totaljs.com/v1.9.x/en.html#pages~Localization\n If doc has example about this, so much the better :)\nThank you!!\n. I try \nnpm install qs\nand write delegate in file definitions/test.js\nF.onParseQuery = function(value) {\n    var Qs = require('qs');\n    return (!value) ? {} : Qs.parse(value);\n};\noutput query data in file controllers/default.js\nfunction view_index() {\n    var self = this;\n    self.json(self.query);\n}\nthen launch with http://127.0.0.1:8000/?p[x]=1&p[y]=2 to get console result:\n{\"p\":{\"x\":\"1\",\"y\":\"2\"}}\nand it's working well. thank you.\nWill F.onParseQuery delegate be publish to npm package registry for total.js@beta ?\n. Hi @petersirka \nI'm sorry, there's been a misunderstanding. I forgot switch to my account in my brother computer. so @liaotzukai is my brother account.\nI had try use branch: https://github.com/totaljs/framework/tree/v1.9.4 and it's working well.\n. It's very clear, thank you! I will try study it and return feedback if I find any issues.\n. ### Client\nI add socket.binaryType = 'arraybuffer';\nServer\nfix:\nvar builder = ProtoBuf.loadProtoFile(F.path.private('complex.json'));\nTo:\nvar builder = ProtoBuf.loadJsonFile(F.path.private('complex.json'));\nResult\n{ model: 'Rusty',\n  vendor: { name: 'Iron Inc.', address: { country: 'US' }, models: [] },\n  speed: 2 }\nYes, It's working for decode google protocol buffer.\nThank you very much!!\n. Hi, @petersirka thank you for your prompt reply and assistance.\nI try decode simple binary buffer from server in client is working. and the decode protobuf from server in client is working,too. It's quick example for protobuf encode/decode in client/server :)\nServer\nfile in controllers/default.js\n```\nexports.install = function() {\n    F.route('/', view_index);\n    F.websocket('/protobuf_lite', socket_protobuf_lite, ['binary'], [], ['*']);\n};\nfunction view_index() {\n    var self = this;\n    self.view('index');\n}\nfunction socket_protobuf_lite() {\n    var controller = this;\n    var ProtoBuf = require('protobufjs');\n    var builder = ProtoBuf.loadProto('package Zoo.Animals; message Dog {required string name = 1;}');\n    var Zoo = builder.build(\"Zoo\");\n    var Dog = Zoo.Animals.Dog;\ncontroller.on('open', function(client) {\n    console.log('Connect / Online:', controller.online);\n});\ncontroller.on('close', function(client) {\n    console.log('Disonnect / Online:', controller.online);\n});\ncontroller.on('message', function(client, arraybuffer) {\n    var msg = Dog.decode(arraybuffer);\n    console.log('--- PROTOBUF ---');\n    console.log(msg);\n    // resend to client\n    var dog = new Dog(msg);\n    var buffer = dog.encode();\n    controller.send(buffer.toArrayBuffer());\n});\n\n}\n```\nClient\nfile in views/index.html\n```\n\n    ws://127.0.0.1:8000/protobuf_lite\n\n\n\n\n\n\n$(document).ready(function() {\n\n    var socket = null;\n\n    $('#test-protobuf_lite').on('click', function() {\n        var ProtoBuf = dcodeIO.ProtoBuf;\n        var builder = ProtoBuf.loadProto('package Zoo.Animals; message Dog {required string name = 1;}');\n        var Zoo = builder.build(\"Zoo\");\n        var Dog = Zoo.Animals.Dog;\n\n        socket = new WebSocket('ws://127.0.0.1:8000/protobuf_lite');\n        socket.binaryType = 'arraybuffer';\n        socket.onopen = function() {\n            console.log(\"connecting...\");\n            if (socket.readyState === WebSocket.OPEN) {\n                console.log(\"connected\");\n                console.log('Send test message');\n                var dog = new Dog({\n                    \"name\": \"Tom\"                   \n                });\n                var buffer = dog.encode();\n                socket.send(buffer.toArrayBuffer());\n            } else {\n                console.log('disconnected');\n            }\n        };\n        socket.onmessage = function(evt) {\n            var data = Dog.decode(evt.data);\n            console.log('msg from server:', data);\n        }\n    });\n});\n\n```\nResult in client\n\nENV\n\nnode 5.1.1\nwindows10 MINGW64 shell\ntotal.js@1.9.6-19\n. It's working in client \n\nsocket.onclose = function(evt) {\n    // evt.reason = '%E4%B8%AD%E6%96%87'\n    console.log('CLOSE:', decodeURIComponent(evt.reason)); // \u4e2d\u6587\n}\n\n. \nIt's working :) \n@petersirka the new flags support for F.websocket() let's me easy to use in my project. thank you!!\n. Sorry, I forget F.log is multi-argument like console.log :( \n\nIt's good idea to rewrite prototype by module. I will try it.\nThank you :)\n. Yes, I just want the new method in views. Thank you.!!\n. @petersirka \nThank your  recommendation. I had to implement follow your hints and it's working well. \n. I updated to total.js@2.0.0-6 and get controller.cors is not a function error. I found it's move to F.cors() and F.route() has new flag cors. Should I use new method or flag ?\n. Is it also apply F.websocket() ? Like:\nF.websocket('/lobby', socket_lobby, ['binary','cors']);\n. I make a new test project\ncontrollers/default.js\n```\nexports.install = function() {\n    F.route('/', view_index);\nF.websocket('/wifi-test', socket_wifi, ['binary']);\n\n};\nfunction socket_wifi() {\n    var ctrl = this;\n    ctrl.on('open', function(client, arraybuffer){\n        console.log('Connect / Online:', ctrl.online);\n    });\n    ctrl.on('close', function(client){\n        console.log('Disconnect / Online:', ctrl.online);\n    }); \n    ctrl.on('error', function(err, client){\n        console.log('Error & Disconnect / Online:', ctrl.online);\n    }); \n}\nfunction view_index() {\n    var self = this;\n    self.repository.ip = F.ip;\n    self.repository.port = F.port;\n    self.view('index');\n}\n```\nviews/index.html\n@{title('Something awesome')}\n<hr />\n<br />\n<p class=\"center\">\n    The node.js framework for all web developers with everything what you need.\n    <br />\n    <b>Create something awesome.</b>\n</p>\n<br />\n<br />\n<div class=\"center\"><a href=\"http://docs.totaljs.com\" class=\"linkbutton\">DOCUMENTATION</a></div>\n<script>\nvar socket = null;\n$(document).ready(function() {\n    socket = new WebSocket('ws://@{repository.ip}:@{repository.port}/wifi-test');\n    socket.onopen = function() {\n        console.log('open');\n    };\n    socket.onclose = function() {\n        console.log('close');\n    };\n});\n</script>\n\nTest by brower websocket\n\n. I tried to set default-interval-websocket-ping and redo test case then wait a night , I found someone had the same question as I have, so I had check allow-performance config is true to ensure run socket.setKeepAlive, but it doesn't seem to work. \n. @petersirka \nI don't use nginx, just use node.js in Win10 without any HTTP Server. I had try code client.socket.setTimeout(0) on open, but it's still not working. I google about related topics and discover most language had the same issue. it seems a better solution is to implement heartbeat mechanism. I will try to research it. Thanks for being so thoughtful anyway.\n. Sorry, I use old usage for route after updated. I pass a array to length param.\n// function(url, funcInitialize, flags, protocols, allow, length, middleware, options) @1.9.7\nF.websocket('my-url', doSomething, ['binary'], ['http']);\n. I use supports  RFC 6455 websocket C# lib in Unity to  establish a WebSocket connection with total.js server, but the lib send request headers without origin to  server and get rejected.\n. Sweet! I updated to total.js v2.0.0-9 and both browser and mobile app are working to establish a WebSocket connection now. thank you.\n. no, I use self.query.keyword as default search value, it will get undefined if user first visit route. \n. ",
    "VarunBatraIT": "mail and onMail both should return MailMessage as per documentation signature and I am using onMail because I don't want to render anything in view it is just a string in an email (body). In fact mail calls onMail. In both function there isn't any way to specify receiver or receipt's name. Suppose I am sending email to James Bond, I need to specify his name in \"to\" field. Like \"James Bond bond007@gmail.com\" (just an example)\nThanks\n```\n/*\n * Send e-mail\n * @param {String or Array} address E-mail address.\n * @param {String} subject E-mail subject.\n * @param {String} view View name.\n * @param {Object} model Optional.\n * @param {Function(err)} callback Optional.\n * @return {MailMessage}\n /\nController.prototype.mail = function(address, subject, view, model, callback, language) {\nif (typeof(model) === TYPE_FUNCTION) {\n    callback = model;\n    model = null;\n}\n\nvar self = this;\nvar body = self.view(view, model, true);\n\nreturn framework.onMail(address, subject, body, callback, language);\n\n};\n```\n```\n/*\n * Mail delegate\n * @param {String or Array String} address\n * @param {String} subject\n * @param {String} body\n * @param {Function(err)} callback\n * @param {String} replyTo\n * @return {MailMessage}\n /\nFramework.prototype.onMail = function(address, subject, body, callback, replyTo) {\nvar tmp;\n\nif (typeof(callback) === STRING) {\n    tmp = replyTo;\n    replyTo = callback;\n    callback = tmp;\n}\n\nvar message = Mail.create(subject, body);\n\nif (address instanceof Array) {\n    var length = address.length;\n    for (var i = 0; i < length; i++)\n        message.to(address[i]);\n} else\n    message.to(address);\n\nvar self = this;\n\nmessage.from(self.config['mail.address.from'] || '', self.config.name);\ntmp = self.config['mail.address.reply'];\n\nif (replyTo)\n    message.reply(replyTo);\nelse if (tmp && tmp.isEmail())\n    message.reply(self.config['mail.address.reply']);\n\ntmp = self.config['mail.address.copy'];\n\nif (tmp && tmp.isEmail())\n    message.bcc(tmp);\n\nvar opt = self.temporary['mail-settings'];\n\nif (opt === undefined) {\n    var config = self.config['mail.smtp.options'];\n    if (config && config.isJSON())\n        opt = JSON.parse(config);\n    self.temporary['mail-settings'] = opt;\n}\n\nsetTimeout(function() {\n    message.send(self.config['mail.smtp'], opt, callback);\n}, 2);\n\nreturn message;\n\n};\n```\n. I don't know how to answer this however I am also looking for an answer :)\nIn most software one can see name coming or just an email address coming. Specially when one has to import sent email to 3rd party api like salesforce for example. Some api provider like mandrill auto saves name and email which can be used further to send marketing emails by auto saving contacts. \nhttps://github.com/eleith/emailjs supports this which I have been using so far. Don't like to add another dependency not just yet :)\nThanks for the logmail. From name it appears to be logging of an email so I could have ignored it. \n. Much appreciated. I could have helped but I am a novice coder not the brutal one :+1: \n. ",
    "evgeny-t": "@petersirka I use ubuntu 14.04. I will record a vid.\n. @petersirka I've just realized that I was not able to reproduce the issue using https://github.com/danwrong/restler, so the issue can be client related.\n. @petersirka here is the vid https://youtu.be/TTc1BmbZlyo\nit prints:\n``\nWrong file length. post is  { file_33: '\ufffdPNG\\r\\n\\u001a\\n\\u0000\\u0000\\u0000\\rIHDR\\u0000\\u0000\\u0000\ufffd\\u0000\\u0000\\u00002\\b\\u0000\\u0000\\u0000\\u0000<:\ufffd=\\u0000\\u0000\\u0003\\fIDATh\\u0005\ufffd\ufffd\ufffdq\ufffdH\\f\\u00040t\ufffdA\ufffd\ufffdcJ\ufffd\ufffd\ufffd&  ^\"^\"^\"^\"^\"^\"^\"^\"^\"^\"^\"^\"^\"^\"\ufffd\ufffd\\u0011\\u001fj\u0107\\u001a\ufffd\ufffdF|\ufffd\\u0011\\u001fj\ufffd\ufffdT\ufffdO\ufffd\ufffd*\ufffd\ufffd[\ufffd\ufffd\u016a[\ufffd\ufffd\u016a[\ufffd\ufffd\ufffd?\ufffd\ufffdG]\ufffd\ufffd\ufffd\ufffdn\ufffd\ufffd\\u0016\ufffdn\ufffd\ufffd\\u0016\ufffdn\ufffd\ufffd\\u001j\u011f\ufffd\\u0013\ufffd\ufffdY\ufffdP#\ufffd\\u001a\ufffdF\\u001c5B\ufffd8j\ufffd\\u001aq\ufffd\\b5\ufffd\ufffd\\u0011j\u0125~\u012d~\\u0004%\ufffd\u0163\\u001a1j\u0128\\u0011\ufffdF\ufffd\\u001a1j\u0128\\u0011\ufffdF\ufffd\\u001a1j\u0128\\u0011\ufffdF\ufffd\ufffd#n5\ufffd\\u001a\ufffd(\\u001e\\u0015q\\u00141\ufffd8\ufffd\\u0018E\\u001cE\ufffd\"\ufffd\"F\\u0011G\\u0011\ufffd\ufffd\ufffd\ufffd\ufffd~\u016d\ufffdQ#\\u001e\u0163\"\ufffd\"F\\u0011G\\u0011\ufffd\ufffd\ufffd\ufffdQ\ufffdQ\ufffd(\ufffd(b\\u0014q\\u0014\ufffd\ufffdQ\u0125\ufffd\\u001f5\ufffdQ<*\ufffd(b\\u0014q\\u00141\ufffd8\ufffd\\u0018E\\u001cE\ufffd\"\ufffd\"F\\u0011G\\u0011\ufffd\".E\\u001c%\ufffd\u0153\"V\\u0011\ufffdXE(b\\u0015\ufffd\ufffdU\ufffd\"V\\u0011\ufffdXE\\\\\ufffd\ufffd\ufffdP\ufffdw\ufffd\ufffd\ufffdU\ufffd\"V\\u0011\ufffdXE(b\\u0015\ufffd\ufffdU\ufffd\"V\\u0011\ufffd\"V\ufffd+\ufffd\ufffd\\'E\ufffd\"\\u0014\ufffd\ufffdP\ufffd*B\\u0011\ufffd\\bE\ufffd\"\\u0014\ufffd\ufffd\ufffd\\u0014\ufffd\ufffdC<\ufffd\\'E\ufffd\"\\u0014\ufffd\ufffdP\ufffd*B\\u0011\ufffd\\bE\ufffd\"\\u0014\ufffd\ufffd\ufffd\\u0014\ufffd\ufffd\\b\ufffd#\\u001e\u0153\"V\\u0011\ufffdXE(b\\u0015\ufffd\ufffdU\ufffd\"V\\u0011\ufffdXE\\\\\ufffdX\ufffd#F\ufffdx\\u0014O\ufffdXE(b\\u0015\ufffd\ufffdU\ufffd\"V\\u0011\ufffdXE(b\\u0015q)b\u0548\ufffd\ufffdG\ufffd\ufffd\ufffdU\ufffd\"V\\u0011\ufffdXE(b\\u0015\ufffd\ufffdU\ufffd\"V\\u0011\ufffd\"V\\u0011\ufffd\ufffd\\'\ufffd\ufffd\ufffdU\ufffd\"V\\u0011\ufffdXE(b\\u0015\ufffd\ufffdU\ufffd\"V\\u0011\ufffd\"V\\u0011\ufffd\ufffd\\'\ud960\ude23\ufffdQ\ufffdQ\ufffd(\ufffd(b\\u0014q\\u00141\ufffd8\ufffd\\u0018E\\u001cE\u070aXE\ufffd\"\ufffd\u0123\"\ufffd\"F\\u0011G\\u0011\ufffd\ufffd\ufffd\ufffdQ\ufffdQ\ufffd(\ufffd(b\\u0014q\\u0014q+b\\u0015\ufffd\ufffdx\\u0012\ufffd\ufffd8\ufffd\\u0018E\\u001cE\ufffd\"\ufffd\"F\\u0011G\\u0011\ufffd\ufffd\ufffd\ufffdQ\ufffdQ\u012d\ufffdK\\u0011G\\u0011\ufffd\ufffdQ\ufffd\\u00185b\u0508Q#F\ufffd\\u00185b\u0508Q#F\ufffd\\u00185b\u0508Q#nE\\\\j\u0128\\u0011\ufffd\ufffdY\ufffdP#\ufffd\\u001a\ufffdF\\u001c5B\ufffd8j\ufffd\\u001aq\ufffd\\b5\ufffd\ufffd\\u0011j\u011f\".\ufffd#\u050fx\\u0014_\ufffd-V\ufffdb\ufffd-V\ufffdb\ufffd-V\ufffd\ufffdR\ufffd\ufffdU\ufffd\ufffdg\ufffdE\ufffdb\ufffd-V\ufffdb\ufffd-V\ufffdb\ufffd-V\ufffd\ufffd_u\ufffd/\ufffd\ufffd\\u001a\ufffd\ufffdF|\ufffd\\u0011\\u001fj\u0107\\u001a\ufffd\ufffdF\ufffd\ufffd.\ufffd\ufffdF|\\u0017/\\u0011/\\u0011/\\u0011/\\u0011/\\u0011/\\u0011/\\u0011/\\u0011/\\u0011/\\u0011/\\u0011/\ufffd\\u001f\\n\ufffd=B<\ufffdR\ufffd\\u0000\\u0000\\u0000\\u0000IEND\ufffdB\ufffd',\n```\n. All responses are \n{\"data\":{\"frames\":[],\"message\":\"multipart form parser error.\"}}\nSure, it's timoshenko.evgeny@gmail.com.\n. 1.9.7\n. Right, everything works fine. Looks like I misinterpreted logs.\nThank you for your time!\n. ",
    "rpochet": "Add problem with WebSocket on IPAD after an upgrade from 1.9.3, and it is solved now.\nThanks a lot!\n. ",
    "adrianrey05": "I have a similar problem with @ {js ()}\nthis is the directory of public\n- js/\n- css/\n- lib/ <- bower components\nin layout 1.9.4 @{import('/lib/jquery/dist/jquery.min.js', '/lib/bootstrap/dist/js/bootstrap.min.js')}\nthis response ok http://locahost:8000/lib/jquery....\nnow in 1.9.5 response bad http://localhost:8000/js/lib/...\nthanks for you help!\n. Hi @petersirka,\nPerfect! It works!\nthanks to you to solve the problem so quickly.\nI hope you have a good end of the year!\n. Hi @petersirka \nlol :smile:  sorry for my inglish.\ni add in the config-release:\nstatic-url : /faq/\n static-url-js : /faq/js/\n static-url-css : /faq/css/\n static-url-script     : /faq/js/\n static-url-style      : /faq/css/\nand in the controllers:\njs\n/* global F */\nexports.install = function() {\n    F.route('/faq/*', 'index');\n    // or\n    // F.route('/');\n};\nBut it does not work.\nAnd also I have a folder /public/lib which is bower_components, that does not work.\n\n. yes.\n\n. this is a repo\n. the files are.\nthe folder /public/lib when I run \"install bower\" is created.\nI can not access /public/views/index.html\n\n. Ok, it works. :+1: \nBut it remains unclear ...\nI will review the code to try to help in this issue.\nThanks for your help.\n. Hi @petersirka.\nIt\u00b4s work :+1: \nyou're a genius man!\nbut when using @{import()} for some cdn, the url is {default-root}//maxcdn....\nI solved using the same link for each file\nthanks for you help.\n. ok. I could solve adding \"debugging\" in args\nThis is how it should be the configuration file\njson\n{\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"name\": \"Launch\",\n            \"type\": \"node\",\n            \"request\": \"launch\",\n            \"program\": \"debug.js\",\n            \"stopOnEntry\": false,\n            \"args\": [\n            \"debugging\"\n         ],\n            \"cwd\": \".\",\n            \"runtimeExecutable\": null,\n            \"runtimeArgs\": [\n                \"--nolazy\",\n                \"--harmony\"\n            ],\n            \"env\": {\n                \"NODE_ENV\": \"development\"\n            },\n            \"externalConsole\": true,\n            \"sourceMaps\": false,\n            \"outDir\": null\n        },\n        {\n            \"name\": \"Attach\",\n            \"type\": \"node\",\n            \"request\": \"attach\",\n            \"port\": 5858\n        }\n    ]\n}\nbut when you start creating an exception in fs.existSync(path) => (total.js line 8138)\n\ndebugging in vs.code\n\noutput console\n\n. debug tab, deactivate \"All Exceptions\" and start all good\n\n. @petersirka.\nthis is the header for static file\n\n-. now, change the etag-version to 9 and save file config\n-. restart the service.\n-. and refresh client page only with key F5.\nheader static file is equals\n\ntime after...\nbut ... now I see that with the button \"refresh\" in chrome updates the files. :stuck_out_tongue_closed_eyes:\n. > Node.js    : v4.6.0\n\nTotal.js     : v2.0.1\n\n``` js\nNEWSCHEMA('room', function(schema) {\n    // Description:\n    // Salas de Juego\n    schema.define('id', 'String');\n    schema.define('nombre', 'String(50)');\n    schema.define('estado', 'Number');\n    schema.define('jugadores', 'String');\n    schema.define('fecha_alta', 'Date');\nschema.setDefault(function(name) {\n    switch (name) {\n        case 'id':\n            return UID();\n        case 'estado':\n            return 0;\n        case 'fecha_alta':\n            return new Date();\n    }\n});\nschema.setGet(function(error, model, options, callback) {\n    // options.id\n    // options.user\n    var sql = DB(error);\n    sql.select('item', 'room').make(function(builder) {\n        builder.where('estado', 0);\n        builder.where('isremoved', false);\n        builder.first();\n    });\n    sql.validate('item', 'notfound');\n    sql.exec(callback);\n});\nschema.setSave(function(error, model, options, callback) {\n    // options.id\n    // options.user\n    var sql = DB(error);\n    sql.save('item', 'room', !options.id, function(builder, newbie) {\n        if (newbie) {\n            builder.set('datecreated', new Date());\n            return;\n        }\n        builder.where('id', options.id);\n        builder.where('isremoved', false);\n    });\n    sql.validate('item', 'notfound');\n    sql.exec(SUCCESS(callback), 'item');\n});\nschema.setRemove(function(error, options, callback) {\n    // options.id\n    // options.user\n    var sql = DB(error);\n    sql.update('item', 'room').make(function(builder) {\n        builder.set('isremoved', true);\n        builder.where('id', options.id);\n    });\n    sql.validate('item', 'notfound');\n    sql.exec(SUCCESS(callback), 'item');\n});\n\n});\n```\n. Hi @petersirka.\nIt's just what I needed, Thanks :+1: \n. @petersirka ,\nI'm using authorization.js,\nto try add \njs\nF.websocket (\"/{room}/\", socket, [\"JSON\",\"authorize\"]); //and it worked.\nIn the version 2.0.1 with not happen.\nI really do not look bad. But there is a different behavior.\nThanks! \n. yes, it works!\nthanks\n2016-11-01 17:28 GMT-03:00 Peter \u0160irka notifications@github.com:\n\nSo does it work or no?\nHow can I simulate it? Your example doesn't work.\n\u2014\nYou are receiving this because you modified the open/close state.\nReply to this email directly, view it on GitHub\nhttps://github.com/totaljs/framework/issues/444#issuecomment-257685487,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AFEYCsjiRETXhxPr-tqZFSiVppfna9IPks5q56DwgaJpZM4KlfwF\n.\n\n\nSaludos, \nAdri\u00e1n Pucheta.\n. Hi @petersirka,\nlook, when i try install total.js\n```cmd\nC:\\Users\\puchadri>npm install -g total.js\nC:\\Users\\puchadri\\AppData\\Roaming\\npm\\totaljs -> C:\\Users\\puchadri\\AppData\\Roaming\\npm\\node_modules\\total.js\\bin\\totaljs\nC:\\Users\\puchadri\\AppData\\Roaming\\npm\\total.js -> C:\\Users\\puchadri\\AppData\\Roaming\\npm\\node_modules\\total.js\\bin\\totaljs\nC:\\Users\\puchadri\\AppData\\Roaming\\npm\\totalpackage -> C:\\Users\\puchadri\\AppData\\Roaming\\npm\\node_modules\\total.js\\bin\\tpm\nC:\\Users\\puchadri\\AppData\\Roaming\\npm\\total -> C:\\Users\\puchadri\\AppData\\Roaming\\npm\\node_modules\\total.js\\bin\\totaljs\nC:\\Users\\puchadri\\AppData\\Roaming\\npm\\tpm -> C:\\Users\\puchadri\\AppData\\Roaming\\npm\\node_modules\\total.js\\bin\\tpm\nC:\\Users\\puchadri\\AppData\\Roaming\\npm\n`-- total.js@2.4.0\n. i have node -v 7.10.0\n. i resolve with Yarncmd\nyarn global add total.js\nyarn global v0.24.6\nwarning No license field\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nsuccess Installed \"total.js@2.6.2\" with binaries:\n      - total\n      - total.js\n      - totaljs\n      - tpm\n      - totalpackage\nwarning No license field\nDone in 9.90s.\n```\nthanks  @petersirka . Hi @petersirka,\nYou are awesome man! \nIt's work, but for the files static of nuxt not work.\n\n\nthis is the code \njs\nvar Nuxt = require('nuxt')\nasync function start() {\n  let config = require('./nuxt.config.js')\n  const nuxt = new Nuxt(config)\n  var result = await nuxt.build()\n  require('total.js').http('debug', {})\n  F.middleware('nuxt', nuxt.render)\n  F.use('nuxt')\n}\nstart();. you are the fucking genius man! (no offense) \nthank you very much!\nwhat was the problem?\n. in the file .tpmigore i have \nterminal\nnode_modules\nother_folder\nfoo\nthe function for read this file, tpm line 178\njs\nskip = skip.concat(Fs.readFileSync(ignore[i]).toString('utf8').split('\\n'));\nbut this return array [\"node_modules\\r\", \"other_folder\\r\", \"foo\\r\"]\ni add \\r to split, like this\njs\nskip = skip.concat(Fs.readFileSync(ignore[i]).toString('utf8').split('\\r\\n'));\nthis return a array [\"node_modules\", \"other_folder\", \"foo\"] and yes ignore the folder. Hi, \nperfect, worked! sorry did not know!\nThanks!. ",
    "deadman2000": "@petersirka \nRenaming was not necessary. Problem was in schema reference.\nI tested on my project new version works fine.\nI named reference $_schema because SchemaInstance has already function $schema in prototype. Now calling instance.$schema() throws exception: TypeError: [...].$schema is not a function\n. I recommend rename $schema back to $_schema and change in SchemaBuilderEntity.prototype.clean to this:\njavascript\n    if (model.$_schema)\n        delete model.$_schema;\n. @petersirka \nI'm sorry for that. I specially pulled this version in beta branch for testing before release.\n. I found bug with array properties. $clean change original array. Way to fix:\njavascript\n        if (value instanceof Array) {\n            var newarr = [];\n            for (var j = 0, sublength = value.length; j < sublength; j++) {\n                var item = value[j];\n                if (item instanceof SchemaInstance)\n                    newarr.push(self.clean(item, false));\n                else\n                    newarr.push(item);\n            }\n            model[key] = newarr;\n            continue;\n        }\n@petersirka please, try to use in mongo SchemaInstance without $clean().\n. @petersirka wath about mongo? Can you try it?\n. Thanks, problem with layout is resolved.\nMailMessage.send() is work, but without options is not usability, bacause local config is not used.\n. F.mail() send message immediately (after 2 ms). Is there a guarantee that the message is not sent before I call method?\nI have one idea:\njavascript\nvar message = F.createMail('marchukov.ivan@gmail.com', 'Test e-mail', '~email-registration', { name: 'MODEL NAME' });\nmessage.attachment('/path/to/file', 'attachment');\nmessage.send(callback);\n. Thanks! It would be great.\n. @petersirka \nThanks. Yes, i like this.\n. Sadly gmail not allow archive attachments. Here my small example: RoleTest.zip\nI add flag in function F.onAuthorize:\nif (user.admin)\n            flags.push('@admin');\nAnd register route whith role admin:\nF.route('/usersfiles', users_files, ['@admin']);\n. I still use 2.0.1. Maybe it's fixed in 2.0.2?\n. It's work fine with 'authorize'. Maybe add note to doc? Or make authorize not required with role flags?\n. ",
    "neoPix": "Well, that solved the issue. \nThanks @petersirka  for the reactive and quick answer.\n. ",
    "stakost": "Yes, I use reverse proxy via nginx.\n. Yes! Thanks a lot!\n. Yes, problem with browser cache. \nhttps://docs.totaljs.com/latest/en.html#pages~File%3A%20versions.\nIt's not solution, because when browser loading, he looks Etag from server by filename and etag-version from config.\nSolution for me is:\nF.on('load', x => {\n    F.config['etag-version'] = new Date().getTime();\n});\nBut every time, when I'll restart server - browser will load static files again.. Thanks a lot!. Hm.. I used cluster with 8 instances. In Chrome, FF and other browsers status is 200 :(\nTotaljs v.2.4.0\nMaybe because I used the auth-module?\nChrome:\n\nFF:\n\n. Now I tested with empty project (downloaded from https://github.com/totaljs/framework/releases), just add that file. Same problem :( Always return 200 status\nrelease-cluster.js\n```\nlet http = require('http'),\n    cluster = require('cluster'),\n    os = require('os');\nif (!cluster.isMaster) {\n    let F = require('total.js');\nF.on('message', (message) => {\n    if (message.type === 'id')\n        framework.id = message.id;\n});\n\nreturn F.http('release');\n\n}\nlet numCPUs = os.cpus().length;\nfor (var i = 0; i < numCPUs; i++) {\n    let fork = cluster.fork();\n    fork.send({ type: 'id', id: i });\n}\n```. Is it:\nempty-project.zip\n. Hm. Some times when I restarted server - work correctly. It's very strange . I'll try to catch problem and tell, why it appear . So sorry, it is problem on my side :(\nFramework works correctly!. I'll waiting you solution about this :)\nhttps://github.com/totaljs/framework/issues/469\nNow I fixed it like that:\nin config add:\ndefault-response-maxage: 0\nand definitions/etag-update.js\nF.on('load', x => {\n    F.config['etag-version'] = new Date().getTime();\n    F.cache.clear();\n});\nBut this solution did not work in Cluster mode :( \n. Cache is cleaning every time when server is restart. How can I change last-modified for flush cache? . In documentation you wrote about it \"As default are errors in ErrorBuilder serialized into the JSON like Object Array. You can rewrite this transformations via ErrorBuilder.addTransform() and ErrorBuilder.setTransform().\", but I did not find it. Yes, I saw that. How can I use 'custom' transform for some Schemes?. I tried to set error.setTransform and try schema.setError, but didn't work for me :(\nNow I use bad solution via ErrorBuilder.addTransform('custom', fn, true) (set transform by default). > you need to call setTransform manually in the schema: error.setTransform('mytransform');\nI no have access to error variable :( . Great! Thats works! Thanks!\nschema.setError((error) => {\n        error.setTransform('custom')\n    }). ",
    "dmilovanovic": "Hi @petersirka,\nNow it seems ok!\nThanks very much!\n. ",
    "gallegogt": "Good,  work fine.\nThanks\n. ",
    "vespaiach": "New version won't work @sant123. Now, all you need to add is \"debugging\" argument.\njavascript\n  {\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n      {\n        \"type\": \"node\",\n        \"request\": \"launch\",\n        \"name\": \"Launch Program\",\n        \"args\": [\"debugging\"],\n        \"program\": \"${workspaceRoot}/debug.js\"\n      }\n    ]\n  }\nNote: live reloading will be disabled. ",
    "Haajsaiko": "Thanks for your quick answer! (for the understandable thing I was speaking about my question! :p)\nNow I think I don't really get the 'model' thing... \nStill have blank mail (in fact just label...) With a console log in redirect_mail() I have : \n\"console.log(model) : object Object\" idem for 'console.log(this)'... \nI'm sure I missed something there... :(\n. okay just send you a mail ! \nbig Thanks\n. Hello, me again! \nNow with this route I can't see my index. instead I just have this {\"message\":\"\"} \nAny idea ?\n. When i tried another url like localhost:8000/news it's ok, then I tried to send a mail It gave me a 404 error but when trying to come back to the index, --> {\"message\":\"\"}\n. No problem! \n. Hello, sorry I was disconnected all the weekend. \nI already changed it but I still can't get the fields in my mail... \nWhen I use \"F.route('/mail/', redirect_mail);\" in the mail I have blank fields in the mail \nbut when I use \"F.route('/mail/', redirect_mail, ['post']);\" I don't receive mail and have a 404 error... \nIf I understand maybe it's \"@{model.name}\" in email.html who can't get the field ?\nDo you have any idea ? \nThanks\n. It works. !\nA big THANK YOU for your help ! \n. This one : \nhttps://github.com/totaljs/examples/tree/master/mongodb\nI really can't understand why it works on all pages but index... u_u'\nthx\n. Just send it \nThanks\n. Sorry, but it still displays nothing... :(\n. Thanks send you an invitation\n. Issue solved! Thank you again!!\n. ",
    "DusanDragulaGR": "Prave som to formuloval, som sa zle vyjadril :)\nDavalo to 0 pri situacii pageTo == pages == max.\n. Super, ja \u010fakujem.\n. ",
    "SleepShadowWeb": "Simple reason:\n1. query processing third-party services running on its ports + your code works on the other ports\n2. maybe division security rights\n. I understood it all.\nyou just wrote: Can you write me why do you need this?\nso I said)\nThanks for the answer!\n. ",
    "harry-stot": "Closed, i'm gonna create the pull request in 2.0 branch\n. Try with this : \nvar textToDecode = '&#60;This&#62; is a test encode benchmark. Should contain &lt;&gt;&amp;&apos; and &quot;. Good luck.'\n    console.log(textToDecode.decode());\n    console.log(textToDecode.decode2());\nYou will see the difference\n. ",
    "FKasa": "Thanks, I can confirm the method works correctly now.\nAlso there was some .ds_store in the node_modules folder in the empty project of the v1.9.8 release. You may want to not include them in next release ;)\n. ",
    "aubergine10": "Ok, will do :)\nBut first... what does the exports.usage() method do? I see it in many examples, but I don't know what's calling the method or why the method is returning what often looks like internal variables (I assume each module is sandboxed in to it's own scope?)\n. Ah, so it's a way to find out what other parts of an app are using a specific module? And with that you can tell what will be affected should the module change, etc?\n. So the exports.usage() can return anything the developer chooses (as long as it's an object?) - is it mainly a debug thing for quick summary on what's going on in a module?\n. I'm looking at the en.json file now... It really is huge!\nI was wondering if it would be better to have one .json file acting as an index, and then separate .json files for each property/method/event/etc... That would make it much easier to edit and also track changes more easily. There would be lots more files, but overall I think it might make the localisation easier to maintain.\n. It seems to be working better now; I'll be defining several more schemas today so will report back in several hours and confirm if the bug is fixed or not.\n. The problem seems mostly fixed, however there is one scenario where fields still get reset...\nSteps to reproduce:\n1. In an existing schema add a new field and fill in its details\n2. Move the field further up the list - the details are reset to default values (usually empty boxes)\nWorkaround:\n- Before moving a field, submit the schema to save all changes, then re-open and the field can be moved without losing its settings.\n. The bug is still present but I've tracked down more specifically what causes it to happen...\nAny schemas saved to server (using \"Save Schema\" button in bottom right of viewport) work OK\nHowever, schemas added after the last \"Save Schema\" will still exhibit problems when reordering fields that reference the 'unsaved' schemas.\nWorkaround:\n- Before referencing a schema as field type, \"Save Schema\" to ensure all changes are stored on the server.\n. The \"Save Schema\" button does not seem to be working. It asked for password, which I put in, then it said it had saved... reloaded and none of the changes were saved. The app is still showing v0.1.0 after clearing browser cache and reloading.\n. A reusable user account module would be good, and something you could use on all your apps and also sell in your online store.\n- Manual sign-up, login\n  - ...option to require email address verification\n- Social sign-up, login (using facebook, twitter, etc)\n  - ...also populate fields such as name, email, avatar image when signing up\n- Forgot password\n- Delete account\n- Basic \"edit profile\" page for users to change their email, name, avatar image, etc.\n- Account reporting features - users can flag a user as spammer/troll\n- Administrator features for managing user accounts\n  - Add/remove/edit user profiles\n  - Switch to user profile (become that user temporarily to see site as they would see it, and then easily switch back to admin account)\n  - Shadow banning\n. I like 'Camelize', it makes it clearer that the field data will be transformed (in this case, Camelized) - as for the parser it can still just check the start of the lower string camel to facilitate the synonyms. The docs can list the synonyms.\nSame applies to Upperize and Lowerize.\n. Actually, looking at the code for Camelize it's not actually CamelCase (which conventionally removes spaces - like some Wikis use) but \"Title Case\" (known as Capitalize in CSS) which conventionally uppercases the first letter of each word and retains spaces.\nSo I think the current Camelize/Camel/Camelcase function should be used for 3 new types Capitalize/Capital/Capitalcase, and the Camelize/Camel/Camelcase types should be routed to a new function that also removes spaces.\n. Yes, good point.\n. Agreed. :thumbsup:\n. I'm not sure what you mean... instanceof returns true or false like so...\n``` javascript\nfunction isDate( obj ) {\n  return ( obj instanceof Date );\n}\nconsole.log( isDate( {} ) ); // false\nconsole.log( isDate( { getTime: function(){} } ) ); // false\nconsole.log( isDate() ); // false\nconsole.log( isDate(12341234) ); // false\nconsole.log( isDate( \" \" ) ); // false\nconsole.log( isDate( new Date() ) ); // true\n``\n. Both my code and your code returntrue` as they are checking that it's date object and not an actual valid date in that object.\nSo code could be better written as:\njavascript\nexports.isDate = function(obj) {\n    return ( obj instanceof Date && obj.toString() !== 'Invalid Date' );\n}\nTest here: http://js.do/aubergine10/totaljs\n. Your version still doesn't determine that value of dtB is bullshit though... It's only checking for presence of a .getTime() method on the object, not that the value stored in the object is a valid date...\nIf we're not worried about the date value being invalid, then my version is slightly faster and also more accurate when it comes to identifying Date instances (rather than any object that has a .getTime() method):\n``` javascript\nfunction oldis(obj) {\n    return (obj && typeof(obj.getTime) === 'function') ? true : false;\n};\nfunction newis(obj) {\n    return ( obj instanceof Date );\n};\nvar dtA = new Date();\nvar dtB = new Date('INVALID');\nconsole.time('old');\nfor (var i = 0; i < 10000000; i++) {\n    oldis(dtA);\n    oldis(dtB);\n}\nconsole.timeEnd('old');\nconsole.time('new');\nfor (var i = 0; i < 10000000; i++) {\n    newis(dtA);\n    newis(dtB);\n}\nconsole.timeEnd('new');\n```\nold: ~39ms\nnew: ~37ms\njavascript\nconsole.log( oldis(dtB) ); // true\nconsole.log( newis(dtB) ); // true\n. :)\n. Further refinements:\n``` javascript\ncase 5:\nif ( tmp instanceof Date && !isNaN(tmp.getTime()) ) {\n    tmp = self.$onprepare(property, tmp, j, model);\n} else if (typeval === 'string') {\n    if (tmp === '') {\n        tmp = undefined;\n    } else {\n        tmp = tmp.trim().parseDate();\n        tmp = isNaN(tmp.getTime()) ? undefined : self.$onprepare(property, tmp, j, model);\n    }\n} else if (typeval === 'number') {\n    tmp = new Date(tmp);\n    tmp = isNaN(tmp.getTime()) ? undefined : self.$onprepare(property, tmp, j, model);\n} else {\n    tmp = undefined;\n}\n\nbreak;\n\n``\n. Note: I'm not sure what the most common way of passing dates is - number, string or date object? The refined code above might need re-ordering if, for example, dates are more often passed as numbers (if so the number block should be first).\n. Also, anow()` function would make code more semantic:\n``` javascript\n// utils.js\nDate.now = function() {\n  // ^ directly on Date, not Date.prototype\n  return new Date();\n}\n// somewhere else...\nvar tomorrow = Date.now().add(1DAYS);\n``\n. OMG, JS already has aDate.now()`?!! - when did that get added? hangs head in shame* No problem, just change the way the constants are used...\n``` javascript\n// if you want Date instance...\nvar tomorrow = new Date( Date.now() + 1*DAYS );\n// or if you just want timestamp...\nvar tomorrow = Date.now() + 1*DAYS;\n```\nWhat do you think to the other idea - the numerical variant to Date.add() and the DAYS, WEEKS etc constants? The existing Date.add() parameter variants would still exist for backwards compatibility.\n``` javascript\n// all have same result, just different performance...\n// fast (JS compiler will inline the calculation rather than do it each time):\ntomorrow = today.add(1*DAY);\n// quick:\ntomorrow = today.add('d', 1);\n// slow (due to string splitting, array GC, etc):\ntomorrow = today.add('1 day');\n``\n. Without theDate()` wrapped around it, it will just return timestamp so code comment should be changed:\njavascript\n/*\n    @type {String|Number}\n    @value {Number}\n    return {Date|Number}\n*/\n?\n. I think the .add() method should always return a Date object.\nYou currently have this in the utils.js #L2181:\njavascript\n    if (type.constructor === Number)\n        return self.getTime() + (type - type%1); // <-- currently returns timestamp\nIt should be changed to:\njavascript\n    if (type.constructor === Number)\n        return new Date(self.getTime() + (type - type%1)); // <-- should return date object\nThe result will be:\n``` javascript\nvar today = new Date();\ntomorrow = today.add(1*DAYS) // --> date object returned\n```\nIt depends what's more commonly required - a timestamp or a date object. I'm still fresh to the framework so I don't know what most common use case is regarding .add(). I see things like cookies need a date object, whereas TTL on objects (like sessions in auth module) generally use timestamps.\n. value != null also catches undefined (note the != instead of !==)\n. agreed\n. @petersirka I don't have company at moment, but am working on a large website that doesn't have logo design yet, will send one over later in year.\n. ",
    "docgit": "Hi Peter,\nit seems the change has not actually been merged in properly. As far as I can see, the function returns false for all valid dates that refer to a year before 1970. The reason for this is obviously the getTime() check for -1. \nRegards\nMarcel. ",
    "danielbernalo": "For now it is the only way to see the progress of the transfer, I made a backend with a progress bar to generate the file transfer and had no way of knowing how it goes but when finished.\nThanks a lot for this small change, I try to do it myself before bother you, but could not.\n. ",
    "KrzysztofWilczek": "So I can have /configs/dev01-debug and /configs/dev02-debug but how I can decide when load dev01 and not dev02? Both of them will be loaded for debug case?\n. ",
    "karolgorecki": "Hi,\nthere is an issue with the configs.\nI've tried the F.useConfig() on version 1.8.0 and lower and it works OK.\nOn higher versions (from 1.9.0) it doesn't work as expected.\nIt looks like it's taking all config files from the configs folder in an alphabetic order.\nSo when I create a file called e.g: xwhich will be the last it will override the previous configs.\n. I still have the problem with overriding the config by the files that are after the picked useConfig file.\nEven with the beta version doesn't work.\nYou have also a small typo in beta version:\ntotal.js/utils.js:1578 contentTypes[ext.toLowerCase()] = type; should be CONTENTTYPES\nWhen I use useConfig shouldn't it only get the file/s passed to this function? Currently it's taking all files in the configs folder.\n. Creating a definition & moving additional config to different folder should do the trick.\nThanks for your help!\n. ",
    "michaeljota": "Is this still your posture about it? TS makes really easy to code and its useful for maintain the application. Several projects are looking forward Typescript, or even just making Typescript developers easy. The best thing about TS is that is just Javascript with strong typing. If you don't find this useful, I know what do you call 'common sense'. \nI just think that you have never try TypeScript, even the Angular 2 example it's outdated an in an old fashion JS. . Your point? \nAt this moment, I can't tell if this can benefit with TypeScript, but it certainly is not useless. Anyhow, develop in JavaScript can be improve just with TS definitions, and I think this a great point that you are missing.  . It's ok. Some people don't believe in evolution either. . ",
    "teddis": "Without Typescript, this entire project is useless. Very sad, especially with this author's cavalier attitude. It looks so promising. . @BlueMagnificent I apologize, I misspoke. The project is not useless. It's just that strong typing is incredibly valuable to catch and prevent all sorts of bugs and enforce good programming practice. The author's flippant rejection is disheartening. It would be nice if the project at least included official typings as a courtesy to Typescript developers. This is certainly fine as a pure JavaScript project. . ",
    "BlueMagnificent": "@teddis I believe your use of the term \"useless\" is purely subjective. TypeScript is not a standard so I see no reason why a JavaScript based project is useless without it.. I'm currently battling with this right now and has been investigating it. What I've noticed so far is that:\n\n\nSetting the ip and port values directly results in an error logged as Error: listen EACCES 127.0.0.1:86 . Not setting any port or using process.env.PORT  (which is NaN) will cause total.js to use the default port of 8000. So while the screen shows that there is error, your application will actually be accessible through port 8000\n\n\nYour applications entry point is actually interceptor.js which resides in iisnode installation folder (in my system its C:\\Program Files\\iisnode) and release.js or debug.js as the case may be.\n\n\nDue to the above when total.js tries to get the applications working directory as specified here it retrieves the directory of interceptor which is iisnode's installation folder. Unfortunately, totaljs has no access to this folder. This is evident when it tries to create the \"tmp\" folder as it throws error . This issue can be resolved by setting the directory value of the options object in release.js or debug.js .\n\n\nIt all seems to be more of an iisnode configuration/setup issue than a total.js issue but I might be wrong cause I'm still trying to figure out the whole stuff.\n. Finally got it to work on my local IIS after much digging deep into express.js and node.js in general. I figured out it was much easier than expected.\n```\nconst fs = require('fs');\nconst options = {};\noptions.port = process.env.PORT;\noptions.directory = \"C:\\Path\\To\\Application\";\nvar framework = require('total.js');\nframework.http('release', options);\n``\nYesprocess.env.PORTis a named pipe in form of a string but node.js still consumes it. Notice that no value for IP was set. I still need to setoptions.directorybecause as I mentioned in an earlier post  total.js infers the applications directory by first given precedence to the directory of the applications entry point and next toprocess.cwd(). Unfortunately the application's entry point while using iisnode is usually not our actually*.jsfiles but an interceptor file as specified in the web.config (orinterceptor.jsby default). The directory of this file may or may not be accessible to the application, like in my case it was by default not accessible cause it resided inC:\\Program Files\\iisnode` .\nSetting value for the directory property of the options object helped me circumvent this issue since options.directory has higher precedence than the other two mentioned above. And better still, setting it as options.directory = process.cwd() wraps the whole stuff for me.\nUnfortunately I've not tried this on Azure but I believe it should help you out\n. @hessel you are welcomed, I'm glad it helped\n@petersirka you are welcomed too, keep up the good work with total.js. > having been a web developer for more that 20 years\n@blaasvaer, your ~~rants~~ reactions actually say otherwise.\nI'm not here to defend totaljs (or am I ?) but I don't understand how you can't find your way around this framework despite the wealth of resources available in the form of very good examples, documentation and the very fact that you can dive into the code yourself for deeper understanding. \nI've been able to go beyond the basics with totaljs just weeks after i picked it up and it was really easy to figure out what I needed and how the framework could provide them for me.\nWell... all the best. It seems you have a bit of things mixed up here. What you have in your schema.setQuery() method is actually a block of code making use of the SqlAgent library which is an ORM for node.js\n\nNow, WHAT am I supposed to do here!?\nWHAT is 'items'? I can understand that 'services' is the table I'm querying.\n\nI wouldn't really know where you got your code from, but from the description on the SqlAgent repository (and as I understand it) what your have as \"items\" is the name the query result will bear. So your execute can be like this \nsql.exec(function(err, response) {\n    console.log(response.items);\n}\n...and as you rightly said  'services' is the table you are querying\n\nHOW am I supposed to know/guess what .select is doing?\nWhere does the builder come from?\nShould I be writing my own custom query!?\nWhat all these builder properties are I don't know ... !?\n\nAll these are properly described in  SqlAgent repo. SqlAgent has a select() method as well as save(), insert(), update(),  delete(), and even query() if you want to pass custom queries. You'll also get to see SqlBuilder object which is the \"builder\" you are referring to\n. \"index\" is meant to be the name of the index view which is located at\n{blog_engine_root}/themes/default/views/index.html . This is clearly documented in the docs under the FrameworkController section. @blaasvaer, not to be offended, I believe this is not an issue. For these kind of questions there is TotalJS Chat Support where you can ask all your questions. I get your point, but I still think the Chat Support is the best way to go. @twisig  For that I'd suggest a stackoverflow page, I'm not really a party to posting call for help on github as issues. It gives the wrong impression to the state of the project. Just imagine having 500 open issues on a github repo with more than 90% of them being \"how can I do this\" kind of questions instead of actual issues.. ",
    "moravcik": "@petersirka, I guess you are missing point of TypeScript. CoffeeScript is bad example in this case, as it has its own (weird) syntax and nobody really use it nowadays. \nOn the other hand TypeScript is a superset of ES6/ES7 with added types, which makes all programming interfaces readable, auto-complete-able, self-documented, less error-prone, easy to refactor, better maintainable, better testable, etc, etc. Types are optional, so one can write pure JavaScript and it is still valid TypeScript code. It is compiled to JavaScript with nice incremental-compilation support. Lately I see many libraries and frameworks moving to TypeScript, or providing typings for TypeScript, or at least written in ES6, as it leverages much cleaner syntax and standardized module system for all JavaScript environments. \nIn my opinion I don't like using global variables (like $, or F) and var self = this in pure functions, because in JavaScript you never really know what you are going to get as this and with global-everything you can easily destroy everything. These are ones of ES5 JavaScript problems, which has been greatly reduced by ES6 syntax and purified with TypeScript types. \nIn our company we started to use TypeScript for all JavaScript code and I think I can say that everyone is satisfied with benefits of coding in TypeScript.. ",
    "gevMgevorgyan": "Hi guys can you help me to change translation language. when i write --translate i want to translate in Armenian or other language how can i do this.\nthanks in advance. ",
    "fgnm": "I have the same problem, changing etag_version does not works with chrome (both with F5 and refresh button). It's very annoying, how can I fix it? Maybe changing Cache-Control?\nThank you. Uhm so if I want to use versions I've to include each static file there, that is not much convenient if I have many static file..\nIf I want to make a custom File route how should I proceed?. I'm a bit confused on how to use versions, let's say I want to force refresh of my css file:\n/css/default.css     : auto\nWhen I include through total view engine @{'default.css'} it routes to for example /css/default-7499392.css and that's fine, however default-7499392.css does not exist and so return 404, what I'm wrong?. Thank you so much!\nJavaScript \ncontroller.cookie('name', 'value');\nWorked as expected. Anyway I'd like to suggest to add this in the docs: https://docs.totaljs.com/latest/en.html#api~FrameworkController~controller.cookie\nBecause \"expiration\" is not marked as optional, this could make confusion :). Thank you for clarification, indeed @customflag is exactly for roles purpose. Users with that role shouldn't be able to explore the whole ['authorize'] pages but only one. So I ask if there is a better solution instead of doing something like this:\n```JavaScript\nexports.install = function () {\n    ROUTE('/profile', view_personal, ['authorize']);\n    ROUTE('/profile/address', view_address, ['authorize']);\n    ROUTE('/profile/contacts', view_contacts, ['authorize']);\nROUTE('/profile', view_index, ['authorize', '@customflag']);\nROUTE('/profile/address', view_index, ['authorize', '@customflag']);\nROUTE('/profile/contacts', view_index, ['authorize', '@customflag']);\n\n}\n``\nI've many ROUTE and I don't want to duplicate each one to check@customflag`. \nBasically I'm looking for a smarter solution for write a routing rule that redirect everything to a single page, if the authenticated user ha @customflag role.\nAre groups the solution? I didn't understand well the doc, could you make me an example for what I'm trying to do?\nThank you :). onAuthorize works wall, I've already done an admin role and it works without problem..\n```JavaScript\nF.onAuthorize = function(req, res, flags, callback) {\nvar cookie = req.cookie(F.config.cookie);\nif (!cookie || cookie.length < 10) {\n    callback(false);\n    return;\n}\n\nvar obj = F.decrypt(cookie, 'user');\n\nif (!obj) {\n    callback(false);\n    return;\n}\n\nvar user = F.cache.get('user_' + obj.id);\nif (user) {\n    req.user = user;\n    if(obj.id == 0) {\n        flags.push('@administrator');\n    }\n    if(!user.sponsor_valid) {\n        flags.push('@customflag');\n    }\n    callback(true);\n    return;\n}\n\nMODEL(\"users\").getUserById(obj.id, function(err, data){\n    if(err) {\n        callback(false);\n    } else {\n        if(!MODULE(\"utils\").isEmptyObject(data)) {\n            F.cache.add('user_' + data.Item.id, data.Item, '5 minutes');\n            if(data.Item.id == 0) {\n                flags.push('@administrator');\n            }\n            if(!data.Item.sponsor_valid) {\n                flags.push('@customflag');\n            }\n            callback(true, data.Item);\n        } else {\n            callback(false);\n        }\n    }\n});\n\n};\nIt's very simple and almost equals to the example. Yes, but maybe I did not explain well, I'm looking for a method that allow to redirect EVERY page with a single line without writing this line variant for every single routeJavaScript\nROUTE('/profile/address', view_index, ['authorize', '@customflag']);\n. Okay but this one:JavaScript\nROUTE('/', view_index, ['authorize', '@customflag']);\nDoes not override already existing route. I mean that `/profile` page will always use `view_personal` instead of `view_index`. It seems that there is a sort of priority during routing that I've don't understand. /* seems to have less priority then /profile.. So maybe I can try the inverse. Is it possible to do something like: Route the page if is not present this flag, otherwise show 401?. Okay, thank you for clarifications. Okay, I understand, and it's a good reason, but I'm in trouble and I hope that you can point me in the right direction.\nI'm in this situation: through `$.post` I download a json produced by a controller, now my javascript in frontend should fill a table with info from that POST call, something like that:JavaScript\n$.post('/get_table', {}, function (res) {\n        var data = JSON.parse(res);\n        var html = \"\";\n        data.table.forEach(function (report) {\n             html += \"\";\n             html += \"\" + report.amount + \"\";\n             html += \"\";\n        });\n        $(\"#table\").html(html);\n    });\nAs you can see I need to translate @(Amount). According to you, in which way can I modify this in order to have working translations?\nMore in general, how can I fill a table asyc using ajax and preserve translations in html?\nI hope I explained myself, thank you so much for your help :). Yes, `$.post` is located in a different .js file. It's nice spa but I've some trouble with implementation, AJAX call in works but the foreach cycle is never executed. \nHowever the concept is that I've to include JavaScript code that creates the UI into HTML view itself, right?. Thank you for your answer, but I think that the problem is quite more complex then it appears. I do not want read just outside the public directory, I need to sand in response a path that is different from the local domain. Amazon s3 links are usually: `https://s3.eu-west-3.amazonaws.com/elasticbeanstalk-eu-west-3-XXXX/static/pdfs/test_file.pdf`, so the `~` isn't the solution.\nI've made this workaroundJavaScript\nexports.install = function () {\n    ROUTE('/download/file/', download_file, ['authorize']);\n}\nfunction download_contract() {\n    var self = this;\nvar filename = U.getName(self.req.url);\nself.redirect(F.routeDownload('pdfs/' + filename + \".pdf\"));\n\n}\n```\nI've switched to normal ROUTE instead of FILE, but I don't think this is the best solution anyway.. Many Many Thanks! This is exactly what I'm looking for, S3 url is finally hidden :). What a pity, unfortunately I need AWS Elastic Beanstalk, because hardware auto scaling, so I can't use a normal VPS.\nAnyway I'll go with my external DBs, but I hope that someday NoSQL engine could support something like that, because it's really easy to use it together with Total :smile: . For example:\nHTML\n<div>\n@(I love Total.js; It's a very good framework)\n</div>\nWith the command totaljs --translatecsv I got something like:\nCSV\nHash;Text;Translation\nT-14328244;\"I love Total.js; It's a very good framework\";\nThen run totaljs -csv translate.csv:\n```\n// Total.js resource file\n// Created: 2019-02-20 15:42\nT-14328244           : It's a very good framework\n``\nAnd it's wrong. So, I've edit your script to replace each;into\\;, similar to double quote escape, and modifiedline.split(';')intoline.split(/(?<!\\);/g)in yourparse_csv(content)` function.\nThere will certainly be more smart solutions :see_no_evil: . ",
    "ameykshirsagar": "@molda : Thank you \n. @petersirka : I was asking about it because window.isomorphic as a namespace exposed in window object can be too obvious to find out the isomorphic function's internals via browser's developer tools as it straight away prints out the entire isomorphic function. It could probably be good to follow the folder's name as a namespace so that the user can create its own namespace easily.\nWhat do you say??\n. @petersirka : Cool. No issues. For now I shall do the masking on the client side. \n. Thank you @petersirka for the answer. Closing this thread.\n. When using F.worker or F.worker2. Thank you so much. Closing the issue. The OPTIONS request now gets 200 in preflight. But still getting 403 on PUT\nF.cors('/location/', ['GET', 'POST', 'PUT', 'DELETE']);\nF.route('/location', create_user, ['cors', 'post', '*LocationREST']);\nF.route('/location', function() {\n    this.content(200, \"\", false, {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Origin': '*',\n        'Access-Control-Allow-Methods': 'GET,POST,PUT,DELETE', //'GET,POST,PUT,DELETE'\n    });\n}, ['options']);\nF.route('/location/{id}', get_user, ['cors', 'GET', '*LocationREST']);\nF.route('/location/{id}', update_team, ['put', '*LocationREST']);\nIf I request /location, I get 403. If I request /location/asd, I get 404.. Worked. Thanks. My bad for using cors flag and F.cors().\nClosing the thread. Cool no problem \nSent from my iPhone\n\nOn 30-Apr-2017, at 10:43 PM, Peter \u0160irka notifications@github.com wrote:\nHi @ameykshirsagar.\nYes. It's very complicated to describe it but I'll try to find a solution for it tomorrow, OK?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub, or mute the thread.\n. Awesome. Thank you.. \n",
    "metalvexis": "PS: here is the code of my app\nvar test_pack = require('total.js');\nconsole.log(test_pack);\nIt can never be any simpler than that, does it?\n. via command-line:\nnode test.js\nbtw, i explored the install path of the packages. i deleted the .cmd files that is outside the node_modules folder.\ni.e. total.cmd, total.js.cmd etc..\nthe test app works now but i dont understand why and how it worked.\n. ",
    "mnicolas80": "nope...\nThe first lines of the worker contain the following code:\njavascript\nrequire('total.js');\nF.load('debug', ['config'], '../');\nthen I get \"undefined\" executing the following:\nconsole.log(CONFIG('weather-api'));\nso, I am not sure....\nThank you @petersirka\n. @petersirka info is bellow:\nOS version: CentOS 7\nTotal.js version: 2.1.0\n``` javascript\nrequire('total.js');\nF.load('debug', ['config'], '../');\nvar Twitter = require('twitter');\nvar twitterClient = new Twitter({\n  consumer_key: CONFIG('twitter.consumer_key'),\n  consumer_secret: CONFIG('twitter.consumer_secret'),\n  access_token_key: CONFIG('twitter.access_token_key'),\n  access_token_secret: CONFIG('twitter.access_token_secret')\n});\nvar params = {screen_name: 'mnicolas80', count: 3};\ntwitterClient.get('statuses/user_timeline', params, function(error, tweets, response) {\n  if (!error) {\n    process.send(tweets);\n  } else {\n    console.log(error);\n  }\n  process.exit();\n});\n```\n. Hi @petersirka, I found the issue... the local Total.js version was 1.9.8.\nI am sorry for loosing your time due to my mistake....\nI tested both codes and work successfully! Could you please update the workers example and add some config variables?\nThank you\n. Confirmed!\nBut what about the existing comments in some assets?\ne.g.\n/*! jQuery v3.1.0 | (c) jQuery Foundation | jquery.org/license */\nCan these comments be removed too?\nThank you Peter!. Understood,\nthank you!. ",
    "binarygeotech": "@molda, that link[-1] is a typo when adding it to the framework as a prototype.\n@petersirka, I have it as a module in my project, and I thought it will be nice if it can be added to the framework.\nI thought there are some things that is good to be part of a framework, that is why I created a pull request. The method works well in handling routes with relative path and query string is not an option.\nIt might seems not useful to you, but someone out there might need such functionality.\nI will add it as part of my crafted modules though.\nThank you guys for pointing out some useful facts.\n. ",
    "randycasburn": "Makes Sense. \nMay I please recommend you change the documentation? The instructions to install it globally appear in at least five places throughout the website and documentation. From here: https://docs.totaljs.com/latest/en.html#pages~Getting%20started \"Other Ways To Install: 2.\"\n\nIf you install framework as global module you do not need to install framework to each web application. \n\nThe docs should be updated to reflect both a global install is necessary for the command line tools and a local install is required for the project to require the library. \nHere are instructions from the NPM docs that make the point clearly:\nhttps://docs.npmjs.com/files/folders\n\n\nInstall it locally if you're going to require() it.\nInstall it globally if you're going to run it on the command line.\n\n\nPlease don't take any of this as criticism, but this does make someone unfamiliar with this work wonder what else in the documentation is misleading or incorrect.\nThanks for taking the time to respond, but more importantly, for providing what looks to be a well thought out framework that I'm excited to get my hands dirty with!\n. ",
    "Athuli7": "Node.js     : v6.3.1\nTotal.js    : v2.2.0\nOS          : win32 10.0.14393\nMode        : debug\nEvent : Incorrect call of variables in view.\nIssue : While the variable being accessed is mentioned, there is no info about the parent.\nError Log :-\n500: Internal Server Error :: Error: View: blog_index - TypeError: Cannot read property 'data' of undefined\n    at Object.Controller.view (H:\\PLCCKochi\\Totaljs_v1\\node_modules\\TOTAL.JS\\index.js:12647:13)\n    at Object.view_blog_index (H:\\PLCCKochi\\Totaljs_v1\\controllers\\default.js:41:7)\n    at Subscribe.doExecute (H:\\PLCCKochi\\Totaljs_v1\\node_modules\\TOTAL.JS\\index.js:9605:23)\n    at Subscribe.execute (H:\\PLCCKochi\\Totaljs_v1\\node_modules\\TOTAL.JS\\index.js:9531:8)\n    at Subscribe.prepare (H:\\PLCCKochi\\Totaljs_v1\\node_modules\\TOTAL.JS\\index.js:9572:8)\n    at Subscribe.doEnd (H:\\PLCCKochi\\Totaljs_v1\\node_modules\\TOTAL.JS\\index.js:9684:8)\n    at IncomingMessage.self.req.on (H:\\PLCCKochi\\Totaljs_v1\\node_modules\\TOTAL.JS\\index.js:9468:32)\n    at emitNone (events.js:86:13)\n    at IncomingMessage.emit (events.js:185:7)\n    at endReadableNT (_stream_readable.js:975:12)\n. @petersirka, just make any view and add a variable that doesn't exist.\nThe error reporting is fine, the filename of the view is mentioned. But not the line number.\nIn the example below, if repository.entity resolves to something that isn't the child of advocates, then a 500 is thrown. But the error would say, could not resolve proexpContent of undefined.\nIn large views, with generic titles and large models, it becomes hard to debug.\n<div class=\"cp-experience padding-btm-60\">\n        <div class=\"container\">\n          <h3>Professional Experience</h3>\n          @{!repository.data.advocate[repository.entity].proexpContent}\n        </div>\n      </div>\nAnd if you are very particular about the seeing the whole view, it has been attached.\nadvocate_details.zip\n. Preparing data... most pages rendered have almost 5/6 interconnected datasets.\nI found it easier to dump the whole thing to the repository.\nI understand it's a lazy fix, but it's a small work with a very small static JSON dataset..\n. Thanks for the fix.\nAbout using the beta channel, wouldn't that be an issue once the version is rolled out and you start development on the new version ?\nOr is beta generally a very stable build that is named so, to avoid pile up of issues and/or version number pile up.\n. ",
    "Humsas": "Thanks for fast response :)\nFirst and third examples are working fine now, but \nimage.pipe(fs.createWriteStream(filename));\nis still throwing errors:\n\n{ Error: Uncaught, unspecified \"error\" event. (gm convert: Unable to open file (\"D:/***/tmp/vipbrzvqvelo3waaqgppeqaor-782557.upload\") [No such file or directory].\n)\n    at WriteStream.emit (events.js:163:17)\n    at WriteStream.onerror (_stream_readable.js:579:12)\n    at emitOne (events.js:96:13)\n    at WriteStream.emit (events.js:188:7)\n    at emitOne (events.js:96:13)\n    at Socket.emit (events.js:188:7)\n    at readableAddChunk (_stream_readable.js:176:18)\n    at Socket.Readable.push (_stream_readable.js:134:10)\n    at Pipe.onread (net.js:548:20). Simplified version would be:\n```\n    let file = self.files[0],\n                filename = F.path.public('picture/' + picName + '.jpg'),\n                image = file.image();\n\n        image.pipe(fs.createWriteStream(filename));\n\n```\nfile.pipe(fs.createWriteStream(filename)); works fine.. As I wrote in the first post, I do not respond at all(found that problem in other issues) for testing, and still receive this error. Received Tmp file is not deleted and file.pipe(fs.createWriteStream(filename)); proves that.. https://github.com/totaljs/framework/issues/121#issuecomment-35800566\nMaybe something from this will work with my previous controller:\n```\nfunction SaveImage()\n{\n    let file = self.files[0],\n                filename = F.path.public('picture/' + picName + '.jpg'),\n                image = file.image();\n        image.pipe(fs.createWriteStream(filename));\n\n}\n```\nActually we could close the issue, because update to beta solved image.save problem, and I do not need image.pipe, it was only to test if something works at all.\n. Thanks!. ",
    "mmautomatizacion": "Removing all listeners works correctly. Maybe not the best solution, and now is more difficult define global events by websocket. But for me and for my current project is enough.\nThanks!. Works correctly! Thanks @petersirka . ",
    "martinjirku": "Great.. Thanks for the clarification!\nNow I found this #309 and #105, so I will close this issue as well.. ",
    "yexing": "code:\n    NOSQL(\"tournaments\").find().make(function(builder) {\n        builder.first()\n        builder.where('id', model.id)\n        builder.join(\"teams\", \"tour_team\").where(\"tour_id\", \"id\")\n        builder.callback(function(err, response) {\n            self.json(response)\n        });\n    });\n\nerror:\nTypeError: Cannot read property 'field' of undefined\n    at DatabaseBuilder.$callback2 (/Users/shinno/node_modules/total.js/nosql.js:1301:16)\n    at Immediate.setImmediate (/Users/shinno/node_modules/total.js/nosql.js:1285:27)\n    at runCallback (timers.js:637:20)\n    at tryOnImmediate (timers.js:610:5)\n    at processImmediate [as _immediateCallback] (timers.js:582:5). Sorry, it's my browser's cache, the old file lead to a js error. After I clean the cache, it works.. ",
    "totaljs": "HI,\nI'll look into it today.\nThank you . Can you create a small example for me?. @gyldcs you have to use https://docs.totaljs.com/latest/en.html#api~RESTBuilder~instance.urlencoded instead of builder.post(). \ud83d\udc4d . ",
    "li0nsar3c00l": "Highly appreciated, thanks. I guess more people, who have to operate behind corporate proxies would appreciate that as well. An implementation similar to C# WebProxy would be awesome.. Feel free to share your information on what and  which method needs to be changed. So I can look into it myself and maybe even provide  a pull request. Alright, then I have to do it myself upfront. thanks for quick response, I guess, you can close this issue now.. is there any other option to search for table entries, that are of integer type or do I have to save those values as string in the nosql db?. Seems like should pay more attention to details in the docs.\nIn case you don't mind, could you post an example, how to combine multiple and/or conditions? The structure of that is not clear to me and trial&error hasn't produced the desired outcome yet.. First, sorry for bothering you so often. What I wanted to do was something like this\n<script>\nvar x = @{model.alertmessage};\n</script>\nMy current workaround is something quite similar to the second approach.. ",
    "s2dent": "Sometimes it is necessary to immediately see the changes in the templates in release mode.\nFor example:\nvar options = {};\noptions.disableViewCache = true;\nrequire('total.js').http('release', options);. It would be a Great if it is possible to carry out in release mode. \nI seems like a nice idea, and it would have added more customization to Total.js. Yes, right.. This is a suitable option for me.\nThanks!. Worked. Thanks.. ",
    "shide1989": "no problem, thank you for your responsiveness. ",
    "ivanlunardi": "ok this example work, i was thinking the error is in 'err' !. OK Thank You. hi , my needs is to run a schedule every 10 seconds.. Thanks!. i'm trying. now it works! thanks. i use $http client of angularjs , if in the same route a change delete in post , it works.\nwith delete i receive 404 ,now  i will try to force content-type\n. forcing content-type it works. \nthank you. it works.....\nThank you. ok . \ngood works. ",
    "lyquocnam": "this exactly what i need : https://github.com/totaljs/examples/tree/master/xml-sitemap\nThanks author about this awesome project !. i mean how to i can combine totaljs with pwa, i see no boilerplate for this yet. ",
    "hbakhtiyor": "hi @petersirka, thanks. ",
    "gyldcs": "damn, it's working now, sorry. ",
    "harry-wood": "I like the idea of an open source slack alternative so I wanted to help, but I don't really have time I'm afraid. Just swinging by to report the error. It's a very noticeable english error in a prominent place on the website, so I think you should fix it. . ",
    "destan": "@petersirka I don't get it. As shown below I authorize the app to have/use my email address:\n\nAccording to here the app is supposed to access the email address.\nSo why the error?. ",
    "nikhilknoldus": "Hi @petersirka Everything is really awesome, but just for the info. github still not working.\nThanks !! Keep up the great work.. ",
    "jozoraz": "to my default component - I'd like to load data from the database first, and after everything is loaded, render them on the page. thanks, it's working\nand If I'd like to load data from a different website and render them on the page, but the data is not there, because the second page is not loaded yet, how could I fix that?. ",
    "ajimix": "For this test I have two:\ncontrollers\n  test.js\n  default.js\ndefault.js is set to load index and loads the views/index.html which is correct.\ntest.js is set to load test/index so it should load the views/test/index.html but is not.\nIs happening on a clean project too.. Ok I see, the problem was that I was specifying the directory. So just doing this.view('index') inside the test.js controller made it work properly.\nMaybe you can add that little note in the docs :)\nThanks for your time, I'm closing the issue \ud83d\udc4d . ",
    "dima1034": "you are good. but that's not about socket. it is about HTTP persistent connection. anyway try to make some test for checking if server can handle stuff like keep-alive connection. ",
    "shahzeb1": "Moving issue to the messenger repo.. ",
    "subbu05": "Hi Peter, I have purchased premium version. I am seeing this issue on eshop premium.. ",
    "ChukkChukk": "I did not have my email on public, but switched it now. It had never been a problem before, so never even checked.  It does work now, that it is switched to public. Thank you, I really like your product! . ",
    "ckpiggy": "I am closing this issue since this issue is beyond the scope of total.js.. If I change my /definitions/database.js to : \n```\n'use strict'\nconst mongodb = require('mongodb')\nsetTimeout(function () {\n  const dbURL = F.config['database-mongo']\n  mongodb.connect(dbURL)\n    .then(function dbConnectHandler (db) {\n      F.database = function database(name) {\n        return name ? db.collection(name): db\n      }\n      console.log(dbURL)\n      console.log(CONFIG('database-mongo'))\n      console.log('did connect to database')\n    })\n    .catch(function dbErrorHandler(err) {\n      console.error(err)\n    })\n}, 2000)\nthe logs are good:\nmongodb://admin:@.mlab.com:xxx/site_engine_test\nmongodb://admin:@.mlab.com:xxx/site_engine_test\ndid connect to database\n. It works!! Thank you.\nexports.install = function () {\n  const reg = /^(?!\\/api)[/A-Za-z0-9_.]*$/\n  F.route((url)=>{ return reg.test(url)}, nuxt, ['#nuxt'])\n  F.file((url)=>{return reg.test(url.uri.path)}, nuxt, ['#nuxt'])\n}\nfunction nuxt () {\n  //this should not be execute\n  throw new Error('nuxt middle ware not working')\n}\n```\nActually, I was trying to use it with Nuxt.js. May I write an example about integrating Total.js with Nuxt.js ?. Oh! I mean I want to write an example for totaljs/examples, since I haven't seen any related example. Anyway, I've made a pull request: totaljs/examples/pull/60 .. Oh! That's my bad. I miss understand the document. Thank you for your response. . It works!! Thank you.\nIt will be nice to note the action functions of F.route and F.file have different context in document.. Oops! I have to change the filepath to get the solution work. \nfunction files_3d (req, res) {\n    const filename = path.basename(req.url)\n    const filepath = path.join( __dirname,'..', CONFIG('directory-public'),'3d', filename)\n    res.file(filepath)\n}. Thanks for your time, @petersirka . You are right, not all developer use node 8.x+. How about return an optional promise in install (node 6.x+) ?. Hm, you are right. Thx.. I found if I test again just after the test finished I got the same errors. \nBut if I test after the test ended about 10 secs, there are no errors.\nIt is not related to bash command.\nThe error occur when running\nnode --harmony test-framework-debug.js\nnode --harmony test-framework-release.js\nThe error message when I use bash run.sh just after previous test ended.\n```\n====================================================\nPID         : 10061\nNode.js     : v6.11.1\nTotal.js    : v2.7.0\nOS          : darwin 16.6.0\n====================================================\nName        : Total.js\nVersion     : 1.0.0\nAuthor      : \nDate        : 2017-07-25 09:30:57\nMode        : debug\n====================================================\nhttp://0.0.0.0:8001/\nError: View \"precompile.homepage\" not found.\n    at Object.Controller.$viewrender (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:11642:9)\n    at Object.view_precomile (/Users/ckpiggy/Documents/JS/totaljs_framework/test/controllers/default.js:152:7)\n    at IncomingMessage.PROTO.$total_execute2 (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13344:32)\n    at IncomingMessage.PROTO.$total_execute (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13314:9)\n    at IncomingMessage.PROTO.$total_authorize (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13432:10)\n    at /Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13599:9\n    at framework.onAuthorize (/Users/ckpiggy/Documents/JS/totaljs_framework/test/test-framework-debug.js:35:2)\n    at IncomingMessage.PROTO.$total_prepare (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13587:4)\n    at IncomingMessage.PROTO.$total_end2 (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13458:9)\n    at IncomingMessage.subscribe_end (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:8818:7) 'default' { auth: null,\n  hash: null,\n  host: '127.0.0.1:8001',\n  hostname: '127.0.0.1',\n  href: 'http://127.0.0.1:8001/precompile/',\n  path: '/precompile/',\n  pathname: '/precompile/',\n  port: '8001',\n  protocol: 'http:',\n  query: null,\n  search: null,\n  slashes: true }\nError: View \"precompile.homepage\" not found.\n    at Object.Controller.$viewrender (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:11642:9)\n    at Object.view_precomile (/Users/ckpiggy/Documents/JS/totaljs_framework/test/controllers/default.js:152:7)\n    at IncomingMessage.PROTO.$total_execute2 (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13344:32)\n    at IncomingMessage.PROTO.$total_execute (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13314:9)\n    at IncomingMessage.PROTO.$total_authorize (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13432:10)\n    at /Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13599:9\n    at framework.onAuthorize (/Users/ckpiggy/Documents/JS/totaljs_framework/test/test-framework-debug.js:35:2)\n    at IncomingMessage.PROTO.$total_prepare (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13587:4)\n    at IncomingMessage.PROTO.$total_end2 (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13458:9)\n    at IncomingMessage.subscribe_end (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:8818:7)\n{ AssertionError: framework.precompile() problem\n    at Object.callback (/Users/ckpiggy/Documents/JS/totaljs_framework/test/test-framework-debug.js:412:11)\n    at IncomingMessage. (/Users/ckpiggy/Documents/JS/totaljs_framework/utils.js:738:12)\n    at emitNone (events.js:91:20)\n    at IncomingMessage.emit (events.js:185:7)\n    at endReadableNT (_stream_readable.js:974:12)\n    at _combinedTickCallback (internal/process/next_tick.js:80:11)\n    at process._tickCallback (internal/process/next_tick.js:104:9)\n  name: 'AssertionError',\n  actual: false,\n  expected: true,\n  operator: '==',\n  message: 'framework.precompile() problem',\n  generatedMessage: false } '' null\nAssertionError: framework.precompile() problem\n    at Object.callback (/Users/ckpiggy/Documents/JS/totaljs_framework/test/test-framework-debug.js:412:11)\n    at IncomingMessage. (/Users/ckpiggy/Documents/JS/totaljs_framework/utils.js:738:12)\n    at emitNone (events.js:91:20)\n    at IncomingMessage.emit (events.js:185:7)\n    at endReadableNT (_stream_readable.js:974:12)\n    at _combinedTickCallback (internal/process/next_tick.js:80:11)\n    at process._tickCallback (internal/process/next_tick.js:104:9)\n{ Error: connect ECONNREFUSED 127.0.0.1:8001\n    at Object.exports._errnoException (util.js:1018:11)\n    at exports._exceptionWithHostPort (util.js:1041:20)\n    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1086:14)\n  code: 'ECONNREFUSED',\n  errno: 'ECONNREFUSED',\n  syscall: 'connect',\n  address: '127.0.0.1',\n  port: 8001 } '' null\nError: connect ECONNREFUSED 127.0.0.1:8001\n    at Object.exports._errnoException (util.js:1018:11)\n    at exports._exceptionWithHostPort (util.js:1041:20)\n    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1086:14)\n{ Error: socket hang up\n    at createHangUpError (_http_client.js:253:15)\n    at Socket.socketCloseListener (_http_client.js:285:23)\n    at emitOne (events.js:101:20)\n    at Socket.emit (events.js:188:7)\n    at TCP._handle.close [as _onclose] (net.js:497:12) code: 'ECONNRESET' } '' null\nError: socket hang up\n    at createHangUpError (_http_client.js:253:15)\n    at Socket.socketCloseListener (_http_client.js:285:23)\n    at emitOne (events.js:101:20)\n    at Socket.emit (events.js:188:7)\n    at TCP._handle.close [as _onclose] (net.js:497:12)\n====================================================\nPID         : 10063\nNode.js     : v6.11.1\nTotal.js    : v2.7.0\nOS          : darwin 16.6.0\n====================================================\nName        : Total.js\nVersion     : 1.0.0\nAuthor      : \nDate        : 2017-07-25 09:31:01\nMode        : release\n====================================================\nhttp://0.0.0.0:8001/\nError: View \"precompile.homepage\" not found.\n    at Object.Controller.$viewrender (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:11642:9)\n    at Object.view_precomile (/Users/ckpiggy/Documents/JS/totaljs_framework/test/controllers/default.js:152:7)\n    at IncomingMessage.PROTO.$total_execute2 (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13344:32)\n    at IncomingMessage.PROTO.$total_execute (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13314:9)\n    at IncomingMessage.PROTO.$total_authorize (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13432:10)\n    at /Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13599:9\n    at framework.onAuthorize (/Users/ckpiggy/Documents/JS/totaljs_framework/test/test-framework-release.js:35:2)\n    at IncomingMessage.PROTO.$total_prepare (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13587:4)\n    at IncomingMessage.PROTO.$total_end2 (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13458:9)\n    at IncomingMessage.subscribe_end (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:8818:7) 'default' { auth: null,\n  hash: null,\n  host: '127.0.0.1:8001',\n  hostname: '127.0.0.1',\n  href: 'http://127.0.0.1:8001/precompile/',\n  path: '/precompile/',\n  pathname: '/precompile/',\n  port: '8001',\n  protocol: 'http:',\n  query: null,\n  search: null,\n  slashes: true }\nError: View \"precompile.homepage\" not found.\n    at Object.Controller.$viewrender (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:11642:9)\n    at Object.view_precomile (/Users/ckpiggy/Documents/JS/totaljs_framework/test/controllers/default.js:152:7)\n    at IncomingMessage.PROTO.$total_execute2 (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13344:32)\n    at IncomingMessage.PROTO.$total_execute (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13314:9)\n    at IncomingMessage.PROTO.$total_authorize (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13432:10)\n    at /Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13599:9\n    at framework.onAuthorize (/Users/ckpiggy/Documents/JS/totaljs_framework/test/test-framework-release.js:35:2)\n    at IncomingMessage.PROTO.$total_prepare (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13587:4)\n    at IncomingMessage.PROTO.$total_end2 (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:13458:9)\n    at IncomingMessage.subscribe_end (/Users/ckpiggy/Documents/JS/totaljs_framework/index.js:8818:7)\n{ Error: connect ECONNREFUSED 127.0.0.1:8001\n    at Object.exports._errnoException (util.js:1018:11)\n    at exports._exceptionWithHostPort (util.js:1041:20)\n    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1086:14)\n  code: 'ECONNREFUSED',\n  errno: 'ECONNREFUSED',\n  syscall: 'connect',\n  address: '127.0.0.1',\n  port: 8001 } '' null\nError: connect ECONNREFUSED 127.0.0.1:8001\n    at Object.exports._errnoException (util.js:1018:11)\n    at exports._exceptionWithHostPort (util.js:1041:20)\n    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1086:14)\n{ Error: socket hang up\n    at createHangUpError (_http_client.js:253:15)\n    at Socket.socketCloseListener (_http_client.js:285:23)\n    at emitOne (events.js:101:20)\n    at Socket.emit (events.js:188:7)\n    at TCP._handle.close [as _onclose] (net.js:497:12) code: 'ECONNRESET' } '' null\nError: socket hang up\n    at createHangUpError (_http_client.js:253:15)\n    at Socket.socketCloseListener (_http_client.js:285:23)\n    at emitOne (events.js:101:20)\n    at Socket.emit (events.js:188:7)\n    at TCP._handle.close [as _onclose] (net.js:497:12)\n```. I just noticed the build history got a lot error logs in Travis. \nDo you have any clue or suggestion? \nI am very glad to send a PR about that.. \nI saw this error on Travis, and it is because this line in test/test-javascript.js\nassert.ok(Buffer.from(javascript.compile_javascript(fs.readFileSync('javascript.js').toString('utf8'))).toString('base64') === 'cmV0dXJuJ1xcJysyO3ZhciBhdHRyaWJ1dGVzPSJcXFsiK2ErIiooIitiKyIpKD86IitjKyIqKFsqXiR8IX5dPz0pIitkKyIqKD86JygoPzpcXFxcLnxbXlxcXFwnXSkqKSd8XCIoKD86XFxcXC58W15cXFxcXCJdKSopXCJ8KCIrZSsiKSl8KSIrZisiKlxcXSI7dmFyIGE9MjAwOw==', 'Problem 1');\nThat is because Buffer.from was introduced in node version 6.0\nTravis use node version 4.0\n{\n  \"language\": \"node_js\",\n  \"cache\": [\n    \"npm\"\n  ],\n  \"node_js\": \"4.0\",\n  \"install\": [\n    \"npm install\"\n  ],\n  \"script\": [\n    \"cd test\",\n    \"sh run.sh\"\n  ],\n  \"group\": \"stable\",\n  \"dist\": \"precise\",\n  \"os\": \"linux\"\n}\nHow about use node 6.11.1 LTS in Travis ?. no problem. Please forgive my bad English, I didn't mean the framework not working. I mean the document has conflict about this.\n\nI think the problem is the title of this issue. Sorry for the miss leading.. I use https://developers.facebook.com/tools/debug/sharing/ to test my domain https://archspace.com.tw/ \nand this is my nginx.conf\n```\nworker_processes auto;\nevents {\n  worker_connections 1024;\n}\nhttp {\n  sendfile on;\nupstream web1{\n    server chatbot:80;\n  }\nupstream web2 {\n    server index:80;\n    keepalive 20;\n  }\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 default_server ipv6only=on http2;\n    server_name archspace.com.tw;\nssl_certificate       /etc/nginx/ssl/cert_chain.crt;\nssl_certificate_key   /etc/nginx/ssl/archspace.com.tw.key;\n\nssl_protocols  TLSv1 TLSv1.1 TLSv1.2;\nssl_ciphers HIGH:!aNULL:!eNULL:!EXPORT:!CAMELLIA:!DES:!MD5:!PSK:!RC4;\nssl_prefer_server_ciphers on;\n\nlocation / {\n  proxy_set_header Host $host;\n  proxy_set_header X-Real-IP $remote_addr;\n  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n  proxy_set_header X-Forwarded-Proto $scheme;\n\n  proxy_pass http://web2;\n  proxy_read_timeout       90;\n}\n\nlocation /web1/ {\n  rewrite ^/web1/(.*)$ /$1 break;\n  proxy_set_header Host $host;\n  proxy_set_header X-Real-IP $remote_addr;\n  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n  proxy_set_header X-Forwarded-Proto $scheme;\n\n  proxy_pass http://web1;\n  proxy_read_timeout       90;\n}\n\n}\n}\n```\n. Is there any possible total.js will automatic response http 206?. What if the range is much bigger than the request file ?\nfacebook 's request header has range: 'bytes=0-524287' and my index.html only 46kB.. I remove the 'range' in fb requests header... then it works!!!\nthis.req.headers.range && delete this.req.headers.range\nI think it is because the range is larger than the response file, so we should response 200 not 206, since there wont be another request for the rest file.. ```\nexports.install = function () {\n  F.route('/', index)\n}\nfunction index () {\n  this.req.headers.range && delete this.req.headers.range\n  this.file('index.html')\n}\n. I use Postman test my site locally. I made a get request with headers\nI only add `Range` `bytes=0-` in Postman header\n{ host: 'localhost:8000',\n  connection: 'keep-alive',\n  'cache-control': 'no-cache',\n  'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36',\n  'postman-token': 'b8b23118-2df4-b693-40ac-0d706da41508',\n  accept: '/',\n  'accept-encoding': 'gzip, deflate, br',\n  'accept-language': 'en-US,en;q=0.8,zh-TW;q=0.6,zh;q=0.4,zh-CN;q=0.2',\n  range: 'bytes=0-' }\n```\nAnd I got error like this:\n\nBut as I remove the header Range bytes=0- it works fine.. I created an empty project to test the problem with Postman\ncontrollers/default.js\n```\nexports.install = function () {\n  F.route('/', test)\n}\nfunction test () {\n  console.log(this.req.headers)\n  this.file('index.html')\n}\npublic/index.html\n<!DOCTYPE html>\n\nHello\n\n/index.js\nrequire('total.js')\nF.http('debug')\n``\nI still got error the same error if I setRangebytes=0-in header.. It seems facebook use the range bytes=0-524287 to scrap all the website shared on it. \nIt works fine when I testcurl -H \"Range: bytes=0-524287\" -v https://www.totaljs.com/and curl -H \"Range: bytes=0-524287\" -v https://www.youtube.com/But when I test my localhost withcurl -H \"Range: bytes=0-524287\" http://localhost:8000the process hanging, I have to pressctrl-c` to close the process.\n. Cool! It works now, thank you!. Cool! . @luoage thx for reply. \nBut I don't want to rewrite throw404 method. \nWhat I want to address are\n1. Maybe we could add a space in front of the problem message in response body\n2. The behavior are different between controller.throw400 and controller.res.throw400, controller.res.throw400 wont send problem message with response.. Wow so fast!\n I was trying to send a PR. \nThank you @petersirka !. controllers/user.js\nexports.install = function () {\n  F.route('/api/user', save, ['post', 'json', '*User#C'])\n  F.route('/api/user', save, ['put', 'json', '*User#U'])\n}\nfunction save(){\n  this.$save()\n}\nmodels/user.js\n```\nNEWSCHEMA('User').make(function(schema) {\n  schema.define('id', Number, true, 'U')\n  schema.define('name', String, true, 'C')\n  schema.define('email', String, true, 'C')\n  schema.define('name, String, false, 'U')\n  schema.define('email', String, false, 'U')\nschema.setSave(function ($){\n    /...some code.../\n  })\n})\n. Thanks !!. I just figure out I can use F.http to start a server before all the test start and use F.listener with supertest XD\n. https://github.com/JrCs/docker-letsencrypt-nginx-proxy-companion\nThis repository is great for integrating nginx proxy and letsencrypt @lyquocnam !!. Thank you, @petersirka .. @petersirka it works!!. @petersirka I think the document should update, it looks like we could have multiple `OK` in a test.\n![2018-02-19 6 02 16](https://user-images.githubusercontent.com/6531171/36372133-11da6650-159f-11e8-827e-fbd77fb28fde.png)\n. @petersirka I think I got your point now.\nThe `OK` and `FAIL` should be called synchronized.\nMy test look like this\nTEST('get service', 'some/url',async function (builder) {\n  builder.get().exec(async (err, data, resp) => {\n    OK(resp.status === 200, 'status')\n    try {\n     const dbData = await fetchDbData()\n     OK(dbData === mockedData, 'check db')\n     }\n  })\n})\nAnd the problem happened in second `OK` check\nSo I can simply modify my test to\nTEST('get service', 'some/url',async function (builder) {\n  builder.get().exec(async (err, data, resp) => {\n    try {\n     const dbData = await fetchDbData()\n     OK(resp.status === 200, 'status')\n     OK(dbData === mockedData, 'check db')\n     }\n  })\n})\n. I use version 2.9.4. I use\nclient.send(JSON.stringify({m: 'test'}))\nIt works. A Ha!  It works!\nThank you @molda . Declare before you use global variables.\nconst CONFIG = global.CONFIG\nconst F = global.F\n. @petersirka \nI still got the problem\nhere is my `/definitions/wait.js`\nconst F = global.F\nconsole.log('waiting for mognodb', new Date().getTime())\nF.wait('mongodb')\nconsole.log('continue ~~~', new Date().getTime())\n```\nand I got the logs, it shows the tests run before the database connected\n```\nwaiting for mognodb 1533919374247\ncontinue ~~~ 1533919374250\n====================================================\nPID         : 6498\nNode.js     : v8.9.1\nTotal.js    : v2.9.2\nOS          : darwin 17.7.0\n====================================================\nName        : Total.js\nVersion     : 1.0.0\nAuthor      :\nDate        : 2018-08-11 00:42:54\nMode        : debug\n====================================================\nhttp://0.0.0.0:8000/\n===================== TESTING ======================\n[ TEST: long-run/demo.js ]\nPassed ............. long run  [0 ms]\nPassed ............. next  [0 ms]\n===================== RESULTS ======================\n\nPassed ......... 2/2\nFailed ......... 0/2\n\nconnected to database test\n. @petersirka  \nI also test the example\nrequire('total.js');\nF.route('/', function() {\n    this.plain('Welcome');\n});\nF.wait('database');\nF.wait('users');\nF.wait('system');\nsetTimeout(function() {\n    F.wait('database');\n    console.log('database');\n}, 3000);\nsetTimeout(function() {\n    F.wait('users');\n    console.log('users');\n}, 5000);\nsetTimeout(function() {\n    F.wait('system');\n    console.log('systems');\n}, 7000);\n// Run the web server\nF.http('debug');\n```\nI got the log\n```\nPID           : 6609\nNode.js       : v8.9.1\nTotal.js      : v3.0.0\nOS            : darwin 17.7.0\nMemory        : 11.18 MB / 17.96 MB\n====================================================\nName          : Total.js\nVersion       : 1.0.0\nAuthor        :\nDate          : 2018-08-11 00:56:21\nMode          : debug\n====================================================\nDirectory     : /Users/ckpiggy/Documents/JS/total_test\nnode_modules  : /Users/ckpiggy/Documents/JS/total_test/node_modules/total.js/\n====================================================\nhttp://0.0.0.0:8000/\ndatabase\nusers\nsystems\nIt seems the example is broken, too. . @petersirka  I thought the log of example should be like this:\ndatabase\nusers\nsystems\n====================================================\nPID           : 6609\nNode.js       : v8.9.1\nTotal.js      : v3.0.0\nOS            : darwin 17.7.0\nMemory        : 11.18 MB / 17.96 MB\n====================================================\nName          : Total.js\nVersion       : 1.0.0\nAuthor        :\nDate          : 2018-08-11 00:56:21\nMode          : debug\n====================================================\nDirectory     : /Users/ckpiggy/Documents/JS/total_test\nnode_modules  : /Users/ckpiggy/Documents/JS/total_test/node_modules/total.js/\n====================================================\nhttp://0.0.0.0:8000/\nDid I miss understand `F.wait` ?\nI thought the server will be hold until the `F.wait('systems')` unlock the process.. @petersirka Oh I see~~\nSo the problem is tests start before `F.wait` completed.\nIs there any workaround for this ?. I found it is because I use send error response with `$.error.output()`\nIt work if I use `$.error.json()`\nThank you @petersirka . I found it is because I call twice `next` in my `F.onAuthorize` delegate\nF.onAuthorize = async function (req, res, flags, next) {\n  let user\n  try {\n    const data = decryptToken(req)\n    user = await findUserByTokenData(data)\n    flags.push(@${user.role})\n  } catch (e) {\n    next(false)\n  } finally {\n   next(true, user)\n  }\n}\n``\nIf auth failed,nextwill called in catch block and finally block.\nBut I am also curious about \"Will the routes doesn't have authorized flag trigger the authorize delegate?\"\nIt seems every route will trigger the delegate and ignore the callback result if the route doesn't haveauthorized` flag. Thank you @petersirka . ",
    "frunjik": "Thx, amazing quick response, can't lag :)\nDone.\n\nJ\n\n2017-05-15 21:41 GMT+02:00 Peter \u0160irka notifications@github.com:\n\nClosed #507 https://github.com/totaljs/framework/pull/507.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/totaljs/framework/pull/507#event-1082913440, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AHyq9eM_rnIBwZG9rc6An8Nr-m55JSqtks5r6KpcgaJpZM4NbkWD\n.\n. Yes, but arent all three usages served by the first function definition ?\nI think the second definition overwrites the first ?\nMaybe im missing something...\nI havent tested anything - I just happened to see it ...\n\n2017-09-04 21:10 GMT+02:00 Peter \u0160irka notifications@github.com:\n\nHi @frunjik https://github.com/frunjik,\nyes, but there are 3 features:\n\nbuffer as Buffer e.g.:\n\nbuilder.file('file', 'logo.png', Fs.readFileSync('logo.png'));\n\nwithout buffer e.g.:\n\nbuilder.file('file', '/absolute/path/to/logo.png');\n\nbuffer as String e.g.:\n\nbuilder.file('file', '/absolute/path/somefile.bin', 'logo.png');\nDo you understand?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/totaljs/framework/issues/541#issuecomment-327016664,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AHyq9dEkxRfSh9W4YFTa5l9FICjlLqujks5sfEslgaJpZM4PMMEW\n.\n. wrong repo :(. \n",
    "hessel": "Hi @petersirka and @molda , unfortunately it did not work, it seems to me a problem with the routes.\n\n\n\nLOG IISNODE\n\nThanks!. Thanks @BlueMagnificent\nI'm still trying to run total.js on iisnode, my idea is to run as web application on Azure, but so far without success.\nI believe that only as a reverse proxy will work, but I'm still trying.\n@molda I could not return anything, just ignore it.\nTks. Hi @petersirka.\n\nYou will need to virtualize a Windows 10 virtual machine (Parallels);\nAttempt IIS in System Resources;\nInstall iisnode on https://github.com/tjanczuk/iisnode;\nCreate a website pointing to the project folder total.js;\n\nOr \nCreate a free web application on Azure, but you will not have access to every system to debug, but the web result will be the same.\nThanks for help!. @BlueMagnificent Thank You!!!\nThis is the perfect setup to run on IIS, I just tested it on Azure and it worked!\nThank you very much for sharing the solution, I spent many hours with it.\n```\nconst fs = require('fs');\nconst options = {};\noptions.ip = 'auto';\noptions.port = process.env.port;\noptions.directory = process.cwd();\nvar framework = require('total.js');\nframework.http('release', options);\n```\n@petersirka and @molda please share this information on the total.js website, it will help many people.\nAnd I would like to thank you for all the support, keep up the impeccable work of yours, total.js is amazing!\nThank you.\n. ",
    "camilohaze": "Hi @petersirka \nI try to make a recursive join (multiple join to the same table) for example:\n```javascript\n        var codes = NOSQL('codes').find();\n    codes.join('clients', 'lists')\n            .where('id', 'client')\n            .fields('id', 'title', 'code', 'abbreviation')\n            .first();\n\n    // The second join is the one that displays the error message.\n    codes.join('blocks', 'lists')\n            .where('id', 'block')\n            .fields('id', 'title', 'code', 'abbreviation')\n            .first();\n\n```\ncodes.nosql\njavascript\n{\"id\":1,\"code\":\"01\",\"client\": 1, \"block\": 2}\nlists.nosql\njavascript\n{\"id\":1,\"name\":\"ASDF\", \"type\": \"client\"}\n{\"id\":2,\"name\":\"#1\", \"type\": \"block\"}\nError message\n\n======= 2017-05-21 15:57:59: system ---> TypeError: Cannot read property 'where' of undefined (http://localhost:8000/api/codes/?page=1&max=14) TypeError: Cannot read property 'where' of undefined\n    at SchemaBuilderEntity.onQuery (C:\\Users\\Cristian\\Downloads\\Telemedell\u00edn\\InHouse\\Run List\\models\\codes.js:39:17)\n    at SchemaBuilderEntity.query (C:\\Users\\Cristian\\Downloads\\Telemedell\u00edn\\InHouse\\Run List\\node_modules\\total.js\\builders.js:993:9)\n    at Object.Controller.$query (C:\\Users\\Cristian\\Downloads\\Telemedell\u00edn\\InHouse\\Run List\\node_modules\\total.js\\index.js:9738:19)\n    at Object.json_query (C:\\Users\\Cristian\\Downloads\\Telemedell\u00edn\\InHouse\\Run List\\controllers\\system.js:51:10)\n    at Subscribe.doExecute (C:\\Users\\Cristian\\Downloads\\Telemedell\u00edn\\InHouse\\Run List\\node_modules\\total.js\\index.js:9252:23)\n    at Subscribe.execute (C:\\Users\\Cristian\\Downloads\\Telemedell\u00edn\\InHouse\\Run List\\node_modules\\total.js\\index.js:9168:8)\n    at Subscribe.prepare (C:\\Users\\Cristian\\Downloads\\Telemedell\u00edn\\InHouse\\Run List\\node_modules\\total.js\\index.js:9215:8)\n    at Subscribe.doEnd (C:\\Users\\Cristian\\Downloads\\Telemedell\u00edn\\InHouse\\Run List\\node_modules\\total.js\\index.js:9326:8)\n    at IncomingMessage.subscribe_end (C:\\Users\\Cristian\\Downloads\\Telemedell\u00edn\\InHouse\\Run List\\node_modules\\total.js\\index.js:9104:18)\n    at emitNone (events.js:86:13)\n\n. Thanks for your prompt response, It worked perfectly. \ud83d\udc4d . ",
    "rosbm": "Yes .send() method. Here is an example of the send code I'm using:\n`\nvar message = new mail.Message(subject, body);\nmessage.to(toMail);\nmessage.from(mail_manager, nameManager);\nmail.on('error', function (err) {\n connection.query(\n query,\n    function(error, result, fields){\n     if (error === null && result.length!=0){\n       console.log('send error! lead ID '  + toMailID + '; userID ' + mailManagerID, '; msgId ' + idMsgSubmit);\n     }\n  });\n});\nmessage.send(smtp_val, { port: smtp_port, secure: true, user: mail_manager, password: mail_pass });\n`. Yes problem with mail.on('error'). \nWhat is better to use to display error messages: Mail.on('error') or message.callback(fn)?. What mail servers did you test? Gmail?. The error is not explicitly generated by the framework, if I send it from the server:  smtp.yandex.ru (SSL port: 465).\nRather, I would say this: an error is generated, but for some reason it does not return to the console.\nAnd when I send mail from this server: smtp.mail.ru (SSL port: 465), I simultaneously receive output to the error console from both the smtp.yandex.ru server (by previous mail sending) and from the server smtp.mail.ru (SSL port: 465).\n. ",
    "mjiricka": "Hi! Yes, on my configuration this works!\nThanks for the quick reaction!. ",
    "trsh": "@petersirka tnx\nThis line options.directory = process.cwd(); did it. I will do some additional tests and then close this.. @petersirka \nin my controller I use require.main.require(\"./common/source/startup/xx.js\") so I can require lib from the root. As require.main is broken in Azure case, what would be the recommended way?. ",
    "raythree": "Thats great thank you!\n. OK I tried the above. It seems that test-begin is fired once before testing starts. However, test-end is fired for each test run (3 times in my case).  I need a callback that is fired once when all tests are complete, OR a way to associate each test-end with a specific TEST so I know which one to clean up.\n. Like this in app/test.js:\n```\nrequire('total.js').http('test', options);\nON('test-begin', () => console.log('Tests STARTING'));\nON('test-end', () => {\n  console.log('Tests ENDED, cleaning up'); \n  // ... cleanup for all tests here\n});\nTest end fires 3 times. I have 3 TESTs in 2 files in theapp/tests/*.js``` folder. OK thanks, I can see your DONE only executes once. I definitely removed the F.test. Will troubleshoot further a little later and report back. Thanks for the quick response.. OK, so I took your test and reproduced what I was seeing, where test-end is called more than once. Technically, I'm actually running integration tests, not \"unit\" tests, because I'm testing Mongoose models/schemas with a local mongo instance running. I usually do that for these type of db/model tests, rather than mocking the database. Everything works, it's just that when I do this the test-end is invoked multiple times. This is where I want to put my database cleanup (e.g. drop the test data from the collections).  If you run without a mongo instance, the tests fail and test-end is only called once. If you want to try and you have docker installed, you can run a local test DB like this:\ndocker run --name mongo-test -p 27017:27017 -v /Users/bill/databases/testdb:/data/db -d mongo\nAnd here is the code:\nassertion-testing.zip\nThank you!\nBill. Great thank you! I didn't realize TEST calls could be nested (or needed to be).  . Ah thanks. I even had the above routes in a comment in my code, but thought that I grabbed them from restful2 (either source code or docs). I started using that not noticing the different comments and thinking restful might later be deprecated by restful2. . Hi Peter, adding the \"schema\" directory in debug.js would be great. Currently it watches all the others (controllers, models, definitions...).\nThanks!. Great thanks, I'm emailing you a link to a ZIP file with a stripped down version (and some notes). This still exhibits the behavior.\nThanks!. Thank you!. Worked just fine!\n. Ah, thank you I missed that. So it seems \"secure\" is fine, not needed \"secureConection\", but the tls property is what I was missing?. ",
    "DaisyMonte": "I got it!\nIgnore that, it was stupid.\nChange to:\nImage.load(self.files[0]).make(function(image) {\n        image.save(F.path.public(self.files[0].filename), (error, isSaved) => {\n            if (!isSaved) {\n                console.log(\"Image not saved! \");\n                console.log(error);\n            }\n        });\n    });. Hi Peter!\nThis way I get the following error:\nCode:\n```\nlet file = self.files[0];\n    file.image().make(function(builder) {\n        builder.quality(90);\n        builder.minify();\n        builder.save(F.path.public(self.files[0].filename), function(err, isSaved) {\n            if (!isSaved) {\n                body.foto = newName;\n                console.log(\"Image not saved! \");\n                console.log(err);\n            } else {\n                console.log(\"Saved! \");\n            }\n        });\n    });\n```\nConsole:\n```\nHttpFile {\n  length: 70221,\n  width: 600,\n  height: 400,\n  rem: true,\n  '$data': undefined,\n  '$step': undefined,\n  '$is': undefined,\n  name: 'foto',\n  filename: 'perfil.jpg',\n  path: 'C:/ProjetoLean/produtos-ensino-node/tmp/uploadedfile-0.bin',\n  type: 'image/jpeg' }\nImage not saved!\n{ Error: Command failed: gm -convert \"C:\\ProjetoLean\\produtos-ensino-node\\tmp\\uploadedfile-0.bin\" +profile \"*\" -limit memory 450 -l\nimit map 900 -quality 90 \"C:\\ProjetoLean\\produtos-ensino-node\\public\\uploads\\docente\\04440985858-perfil.jpg\"\ngm convert: Unable to open file (C:\\ProjetoLean\\produtos-ensino-node\\tmp\\uploadedfile-0.bin) [No such file or directory].\nat ChildProcess.exithandler (child_process.js:270:12)\nat emitTwo (events.js:125:13)\nat ChildProcess.emit (events.js:213:7)\nat maybeClose (internal/child_process.js:921:16)\nat Socket.stream.socket.on (internal/child_process.js:348:11)\nat emitOne (events.js:115:13)\nat Socket.emit (events.js:210:7)\nat Pipe._handle.close [as _onclose] (net.js:549:12)\n\nkilled: false,\n  code: 1,\n  signal: null,\n  cmd: 'gm -convert \"C:\\ProjetoLean\\produtos-ensino-node\\tmp\\uploadedfile-0.bin\" +profile \"*\" -limit memory 450 -limit map 900\n-quality 90 \"C:\\ProjetoLean\\produtos-ensino-node\\public\\uploads\\docente\\04440985858-perfil.jpg\"' }\n```\nWhat am I doing wrong?\nThank you for the help!!. Is it?\nSorry, I do not know if I understood correctly.\n```\nF.route('/teachers/create/', action_create, ['upload', 'post'], 100);\nfunction action_create() {\n    let self = this;\n    let body = self.body;\n    let newName = 'uploads/' + self.files[0].filename;\nlet file = self.files[0];\nfile.image().make(function(builder) {\n    builder.quality(90);\n    builder.minify();\n    builder.save(F.path.public(newName), function(err, isSaved) {\n        if (!isSaved) {\n            console.log(\"Image not saved! \");\n            console.log(err);\n        } else {\n            console.log(\"Saved! \");\n        }\n    });\n});\n\nTeacher.save(function(err, list) {\n    if (err) {\n        self.plain(err);\n    } else {\n        if (list) {\n            self.json(list);\n        } else {\n            self.json({ err: \"Erro na cria\u00e7\u00e3o\" });\n        }\n    }\n});\n\n}\n```. It's works!\nThank you very much!\nHow do I recover the file in the 'get' request?\nShould I use file.read ()?. I would like to send the file along with a user query, for example:\n```\nF.route('/teachers/read/{id}', action_read, ['get']);\nfunction action_read(id) {\n    let self = this;\n    if (!mongoose.Types.ObjectId.isValid(id)) {\n        return res.status(400).json({ message: 'ID \u00e9 inv\u00e1lido' });\n    } else {\n        Teacher.find({ _id: id },\n            function(err, list) {\n                if (err) {\n                    self.plain(err);\n                } else {\n                    if (list) {\n                        self.json(list);\n                    } else {\n                        self.json({ err: \"N\u00e3o Encontrado\" });\n                    }\n                }\n            });\n    }\n}\n```. Sorry, I did not explain clearly.\nFor now, I only get the object in mongodb.\nI am saving the image url along with Schema.\nIn the request, I would like to return a file together.\nI do not know if it is possible to include in the same request or if it is necessary to make a separate request.\nSorry, this is all new to me. I'm still learning.\nAnd I apologize for my English too.\nTeacher Schema: \n```\nlet mongoose = require('mongoose');\nlet uniqueValidator = require('mongoose-unique-validator');\nlet Schema = mongoose.Schema;\nlet validateEmail = function(email) {\n    let re = /^\\w+([.-]?\\w+)@\\w+([.-]?\\w+)(.\\w{2,3})+$/;\n    return re.test(email)\n};\nlet teacherSchema = new Schema({\n    name: {\n        type: String,\n        required: true,\n        trim: true\n    },\n    link_lattes: {\n        type: String,\n        required: false,\n        trim: true\n    },\n    email: {\n        type: String,\n        trim: true,\n        lowercase: true,\n        index: true,\n        unique: \"O endere\u00e7o de e-mail j\u00e1 existe.\",\n        required: 'O endere\u00e7o de e-mail \u00e9 requerido.',\n        validate: [validateEmail, 'Digite um endere\u00e7o de e-mail v\u00e1lido.']\n    },\n    photo: {\n        type: String\n    },\n    gender: {\n        type: String,\n        required: false,\n        enum: ['male', 'female']\n    }\n}, {\n    timestamps: {\n        createdAt: 'created_at'\n    }\n});\nexports.schema = mongoose.model('Teacher', teacherSchema);\nexports.name = 'teacher';\n```. I understand.\nI'll try to use the recommended solution.\nThank you for responding so quickly and for all the help.\nTotal.js is great!. ",
    "luoage": "Thx, please wait a minute. @peterkc \nI have already performed the update to v2.8.1. The older merge request has already closed. Did it right ?. My real name ? OK, my real name is \u91d1\u5cad, from China. The nickname of luoage is also good.. By the way, when will the new version be released? \ud83d\ude06. I don't know how to translate it. \nThanks for your attention.. That's great!. you should use router with #404 in the first arguments\nF.route('#404', cb). And if you want to rewrite throw404 method, you should change the prototype Controller.prototype.throw404. Oh, great thx !. Thx.. I have got it using  @{meta('\u9996\u9875', model.description, model.keywords)}\n. yes, it's good. @petersirka . ",
    "DarkKnight1992": "i would love to but what do you need exactly ?\n. \n\n\nthis is one map area all the coords are converted to NaN. <map name=\"Map\" id=\"Map\" map-tool-tip>\n<area shape=\"poly\" id=\"canada\" class=\"maphilighted masterTooltip\" title=\"{{::Countries.Canada}}\" coords=\"935,343,938,360,954,361,965,357,985,346,985,347,991,349,991,350,993,350,993,351,995,351,995,352,997,352,997,353,999,353,999,354,1001,354,1002,356,1004,356,1004,357,1007,357,1009,360,1015,362,1016,364,1022,366,1022,367,1024,367,1024,368,1030,370,1030,371,1033,371,1033,372,1035,372,1035,373,1041,374,1041,375,1044,375,1044,376,1047,376,1047,377,1054,378,1054,379,1058,379,1058,380,1064,380,1064,381,1067,381,1067,382,1074,383,1074,384,1084,386,1084,387,1087,387,1087,388,1090,388,1090,389,1093,389,1093,390,1097,391,1097,392,1101,392,1103,395,1105,395,1106,397,1108,397,1108,398,1112,400,1104,425,1112,431,1130,436,1153,437,1177,438,1177,437,1183,437,1183,436,1189,435,1189,434,1191,434,1191,433,1201,432,1207,439,1208,439,1209,442,1212,444,1212,446,1215,448,1216,451,1218,451,1218,453,1221,455,1221,457,1225,460,1225,462,1230,466,1230,468,1232,469,1235,473,1237,473,1238,475,1243,475,1246,471,1247,471,1247,469,1249,468,1249,465,1250,465,1250,459,1255,431,1255,428,1265,417,1279,409,1283,411,1284,413,1286,413,1286,414,1288,414,1288,415,1290,415,1290,416,1292,416,1292,417,1294,417,1294,418,1296,418,1296,419,1302,421,1302,422,1305,422,1305,423,1307,423,1308,425,1317,427,1317,428,1320,428,1320,429,1323,429,1323,430,1326,430,1326,431,1329,431,1329,432,1337,433,1337,434,1358,435,1358,436,1376,436,1401,437,1404,433,1405,433,1405,431,1408,429,1423,414,1433,415,1434,418,1435,418,1435,420,1436,420,1437,425,1438,425,1438,431,1439,431,1440,437,1441,437,1441,439,1442,439,1442,442,1443,442,1443,445,1448,453,1455,453,1457,450,1458,450,1459,445,1460,445,1460,442,1461,442,1461,439,1462,439,1463,432,1475,421,1484,411,1489,407,1494,399,1491,376,1491,373,1490,373,1490,371,1489,371,1486,362,1485,362,1485,360,1483,359,1483,357,1481,356,1478,346,1497,345,1507,349,1507,351,1518,362,1518,364,1519,364,1519,366,1520,366,1520,368,1521,368,1521,370,1523,371,1525,377,1527,378,1528,382,1530,383,1530,385,1531,385,1531,387,1532,387,1532,390,1534,391,1536,397,1537,397,1538,400,1540,401,1541,404,1546,404,1553,396,1555,395,1555,393,1560,389,1560,387,1567,381,1567,380,1570,380,1572,381,1574,385,1576,386,1576,388,1578,389,1579,394,1580,394,1580,396,1581,396,1581,408,1593,454,1593,455,1603,453,1616,441,1618,440,1618,438,1620,437,1622,431,1623,431,1623,429,1624,429,1626,423,1627,423,1627,420,1628,420,1628,418,1629,418,1630,412,1631,412,1631,410,1632,410,1632,407,1633,407,1633,405,1634,405,1636,399,1637,399,1637,397,1638,397,1638,395,1639,395,1641,389,1642,389,1642,386,1643,386,1643,384,1644,384,1644,380,1645,380,1644,349,1654,348,1654,349,1659,349,1659,350,1661,350,1661,351,1664,351,1664,352,1667,352,1667,353,1671,354,1671,355,1673,355,1675,358,1677,358,1677,359,1679,360,1679,362,1683,365,1683,367,1685,368,1685,370,1686,370,1686,372,1687,372,1687,374,1688,374,1688,376,1689,376,1689,378,1690,378,1690,380,1692,381,1691,428,1697,452,1696,466,1693,468,1693,470,1688,474,1688,475,1686,475,1684,478,1682,478,1681,480,1675,482,1674,484,1670,485,1669,487,1665,488,1664,490,1660,491,1652,495,1644,491,1643,489,1641,489,1640,487,1627,485,1627,486,1620,486,1620,487,1615,487,1615,488,1613,488,1613,489,1610,490,1610,514,1609,514,1607,520,1606,520,1605,524,1603,525,1602,529,1601,529,1600,532,1598,533,1598,535,1596,536,1595,540,1594,540,1595,549,1593,568,1592,568,1592,571,1591,571,1590,575,1586,578,1585,580,1583,580,1582,582,1580,582,1580,583,1577,583,1577,584,1575,584,1575,585,1572,585,1572,586,1559,588,1559,589,1557,589,1556,591,1554,591,1551,595,1549,596,1549,598,1546,600,1546,601,1536,601,1536,600,1524,605,1523,605,1523,608,1525,612,1528,614,1528,616,1531,618,1533,627,1526,631,1523,631,1523,632,1517,634,1517,635,1515,635,1511,640,1509,641,1508,645,1507,645,1506,648,1504,649,1504,651,1484,669,1484,671,1481,673,1480,677,1479,677,1477,683,1476,683,1476,686,1475,686,1474,694,1473,694,1472,710,1471,710,1471,717,1470,717,1470,725,1469,725,1469,734,1468,734,1468,743,1467,743,1467,755,1466,755,1465,779,1468,781,1468,782,1470,782,1470,783,1473,783,1473,784,1479,786,1479,787,1481,787,1481,788,1485,789,1486,791,1488,791,1488,792,1491,794,1492,794,1492,796,1493,796,1493,798,1494,798,1494,802,1495,802,1495,805,1496,805,1496,808,1497,808,1497,814,1498,814,1498,817,1499,817,1499,820,1500,820,1500,823,1501,823,1501,826,1502,826,1502,828,1503,828,1503,830,1507,836,1511,837,1511,838,1527,838,1537,837,1537,838,1539,838,1540,840,1542,840,1543,842,1547,843,1547,844,1550,845,1551,847,1555,848,1557,851,1559,851,1559,852,1561,852,1561,853,1563,853,1563,854,1565,854,1565,855,1567,855,1567,856,1569,856,1569,857,1571,857,1571,858,1575,859,1576,861,1580,862,1581,864,1583,864,1583,865,1585,865,1585,866,1587,866,1587,867,1589,867,1590,869,1592,869,1593,871,1595,871,1597,874,1599,874,1600,876,1604,877,1605,879,1607,879,1608,881,1610,881,1610,882,1614,883,1614,884,1620,885,1620,886,1624,886,1624,887,1627,887,1627,888,1630,888,1630,889,1640,890,1673,901,1678,901,1678,902,1681,902,1681,903,1683,903,1685,906,1686,906,1686,943,1687,943,1688,948,1689,948,1689,951,1690,951,1690,953,1691,953,1691,956,1692,956,1692,958,1693,958,1693,960,1694,960,1694,962,1695,962,1697,968,1698,968,1698,972,1699,972,1701,978,1702,978,1704,984,1706,985,1706,987,1708,988,1708,990,1710,991,1710,993,1717,999,1739,1010,1742,1008,1746,1003,1748,1002,1748,1000,1752,997,1752,995,1755,993,1755,991,1757,990,1757,988,1759,987,1759,985,1760,985,1762,979,1763,979,1760,955,1760,951,1759,951,1759,947,1758,947,1758,944,1757,944,1757,940,1750,910,1753,906,1764,896,1764,894,1774,885,1774,883,1777,881,1777,879,1779,878,1779,876,1781,875,1782,871,1784,870,1784,868,1785,868,1785,866,1786,866,1786,863,1787,863,1787,860,1788,860,1789,850,1792,815,1786,806,1784,805,1783,801,1781,800,1781,798,1779,797,1778,793,1776,792,1775,788,1773,787,1773,785,1772,785,1771,781,1770,781,1769,774,1768,774,1768,770,1767,770,1767,764,1766,752,1767,752,1769,746,1770,746,1770,744,1771,744,1771,741,1772,741,1772,739,1773,739,1773,736,1774,736,1774,733,1775,733,1775,727,1776,727,1776,721,1775,721,1775,709,1774,709,1774,701,1773,701,1773,689,1772,689,1773,661,1774,661,1778,655,1810,658,1826,659,1826,660,1835,660,1835,661,1843,661,1843,662,1851,662,1851,663,1856,664,1878,694,1880,694,1883,698,1885,698,1886,700,1890,701,1891,703,1895,704,1896,706,1898,706,1900,709,1909,714,1909,764,1910,764,1910,766,1915,772,1917,772,1919,775,1921,775,1924,779,1926,779,1927,781,1929,781,1931,784,1933,784,1934,786,1940,791,1940,793,1950,802,1971,795,1975,794,1978,790,1980,790,1982,787,1984,787,1987,783,1988,783,1988,781,1991,779,1991,777,1992,777,1993,773,1994,773,1995,767,1996,767,1996,764,1997,764,1997,761,1998,761,1998,757,1999,757,2001,746,2006,746,2010,754,2010,756,2011,756,2011,759,2013,760,2015,766,2016,766,2016,768,2017,768,2017,772,2018,772,2020,778,2021,778,2021,781,2022,781,2022,783,2024,784,2025,788,2027,789,2027,791,2029,792,2029,794,2033,797,2033,799,2047,812,2047,814,2052,818,2055,855,2056,855,2057,859,2063,864,2064,866,2066,866,2069,870,2071,870,2073,873,2076,874,2077,876,2081,877,2083,880,2085,880,2089,885,2091,885,2092,887,2095,888,2095,889,2097,889,2098,891,2100,891,2101,893,2103,893,2105,896,2107,896,2108,898,2110,898,2112,901,2116,902,2116,903,2121,906,2122,912,2121,912,2119,919,2120,919,2127,925,2128,927,2132,928,2132,929,2135,930,2136,932,2138,932,2139,934,2141,934,2141,935,2143,935,2143,936,2145,936,2145,937,2147,937,2149,940,2150,940,2150,942,2152,943,2153,947,2154,947,2155,951,2156,951,2156,955,2157,955,2157,975,2154,977,2154,979,2151,980,2149,983,2147,983,2145,986,2143,986,2143,987,2141,987,2141,988,2139,988,2139,989,2137,989,2137,990,2135,990,2135,991,2131,992,2130,994,2126,995,2126,996,2123,997,2122,999,2120,999,2118,1002,2111,1009,2109,1009,2103,1014,2095,1023,2093,1023,2091,1026,2089,1026,2088,1028,2085,1028,2085,1029,2060,1029,2009,1029,1982,1030,1958,1030,1958,1031,1954,1032,1953,1034,1950,1035,1949,1038,1946,1040,1944,1046,1941,1048,1940,1052,1939,1052,1939,1054,1938,1054,1936,1060,1935,1060,1935,1063,1934,1063,1933,1067,1932,1067,1931,1071,1929,1072,1929,1074,1928,1074,1929,1080,1931,1080,1932,1082,1936,1082,1936,1081,1942,1080,1942,1079,1944,1079,1944,1078,1946,1078,1947,1076,1949,1076,1950,1074,1952,1074,1953,1072,1955,1072,1956,1070,1959,1070,1959,1069,2003,1069,2005,1075,1998,1081,1998,1082,1995,1083,1995,1085,1994,1085,1992,1088,1994,1099,1994,1105,1995,1105,1995,1108,1996,1108,1996,1110,1997,1110,1997,1113,1998,1113,2000,1119,2001,1119,2001,1121,2002,1121,2002,1123,2003,1123,2005,1129,2007,1130,2007,1132,2009,1133,2009,1135,2013,1138,2014,1141,2016,1141,2016,1144,1998,1147,1993,1147,1993,1148,1984,1149,1984,1150,1980,1150,1980,1151,1977,1151,1977,1152,1972,1152,1972,1153,1961,1153,1958,1149,1957,1149,1957,1147,1955,1146,1955,1144,1954,1144,1953,1138,1952,1138,1952,1136,1951,1136,1951,1133,1926,1108,1917,1114,1917,1116,1916,1116,1914,1122,1913,1122,1912,1128,1911,1128,1911,1133,1910,1133,1910,1135,1909,1135,1909,1138,1908,1138,1907,1142,1905,1142,1900,1148,1896,1153,1894,1153,1894,1154,1892,1154,1892,1155,1889,1155,1847,1163,1839,1163,1839,1164,1834,1164,1834,1165,1828,1165,1828,1166,1823,1166,1823,1167,1819,1167,1819,1168,1816,1168,1816,1169,1814,1169,1814,1170,1812,1170,1811,1172,1807,1173,1806,1175,1804,1175,1804,1176,1800,1177,1800,1178,1797,1178,1797,1179,1788,1180,1749,1191,1744,1191,1744,1192,1738,1194,1738,1195,1736,1195,1736,1196,1733,1198,1733,1199,1733,1200,1732,1200,1733,1202,1736,1206,1736,1207,1739,1208,1739,1211,1738,1212,1714,1217,1710,1217,1692,1223,1694,1217,1695,1217,1695,1215,1697,1214,1697,1212,1699,1211,1699,1209,1701,1208,1701,1206,1702,1206,1708,1175,1715,1175,1723,1177,1733,1174,1738,1162,1719,1142,1717,1142,1716,1140,1705,1136,1697,1136,1697,1135,1688,1135,1688,1134,1679,1134,1679,1133,1672,1133,1672,1132,1666,1131,1664,1129,1664,1127,1662,1126,1659,1117,1658,1117,1658,1115,1657,1115,1656,1109,1655,1109,1655,1106,1654,1106,1654,1103,1653,1103,1653,1100,1652,1100,1652,1098,1651,1098,1651,1095,1649,1094,1649,1092,1646,1090,1644,1087,1627,1087,1625,1083,1623,1082,1622,1078,1620,1077,1620,1075,1618,1074,1618,1072,1617,1072,1614,1068,1611,1068,1611,1067,1604,1066,1604,1065,1599,1065,1585,1063,1585,1064,1583,1064,1582,1066,1580,1066,1580,1067,1577,1068,1577,1070,1574,1071,1574,1072,1572,1072,1572,1073,1570,1073,1567,1077,1565,1077,1563,1080,1561,1080,1560,1082,1558,1082,1557,1084,1537,1084,1537,1083,1531,1083,1531,1082,1529,1082,1529,1081,1526,1081,1526,1080,1522,1079,1522,1078,1520,1078,1520,1077,1518,1077,1518,1076,1512,1074,1512,1073,1502,1071,1502,1070,1496,1069,1496,1068,1494,1068,1494,1067,1491,1067,1491,1066,1481,1064,1481,1063,1477,1062,1477,1061,1475,1061,1474,1059,1472,1059,1471,1057,1469,1057,1468,1055,1461,1053,1460,1056,1456,1058,1456,1059,1339,1059,1142,1059,1101,1060,1015,1060,994,1060,985,1059,980,1056,980,1055,978,1055,977,1053,976,1053,975,1051,973,1051,971,1048,969,1048,967,1045,965,1045,963,1042,961,1042,959,1039,956,1038,955,1036,953,1036,953,1035,950,1034,949,1032,947,1032,945,1029,943,1029,942,1027,939,1026,939,1025,937,1025,936,1023,934,1023,933,1021,931,1021,930,1019,927,1018,927,1017,923,1016,922,1014,920,1014,920,1013,918,1013,918,1012,915,1012,915,1011,913,1011,913,1010,904,1008,904,1007,898,1005,898,1004,894,1003,889,997,889,995,888,995,888,993,887,993,887,991,886,991,886,989,885,989,885,986,884,986,884,983,883,983,883,981,882,981,882,978,881,978,881,976,880,976,879,970,878,970,878,968,877,968,877,965,876,965,876,963,875,963,874,957,873,957,872,953,871,953,870,949,868,948,868,946,866,945,866,943,864,942,864,940,862,939,861,935,859,934,858,930,856,929,856,927,854,926,854,924,852,923,852,921,850,920,849,916,847,915,847,913,845,912,844,909,841,907,841,905,839,904,838,901,837,901,837,899,834,897,833,893,832,893,835,879,835,873,832,871,832,870,830,870,829,868,827,868,826,866,824,866,823,864,821,864,819,861,817,861,815,858,813,858,807,851,804,849,804,847,802,846,801,843,800,843,800,841,799,841,799,839,798,839,798,836,797,836,797,834,796,834,796,832,794,831,794,829,792,828,792,826,786,821,776,810,774,810,773,808,769,805,769,803,766,801,757,766,756,766,754,760,748,755,741,754,741,755,735,755,735,756,731,756,731,757,727,757,727,758,724,758,724,759,719,759,719,760,712,760,712,761,695,760,686,753,686,751,683,749,683,747,681,746,680,743,679,743,679,741,677,740,677,738,675,737,675,735,673,734,673,732,672,732,672,730,671,730,670,727,655,732,653,670,652,628,652,615,651,573,651,504,651,499,650,499,650,404,650,362,651,362,651,354,677,361,683,368,687,369,695,378,697,378,699,381,701,381,703,384,705,384,706,386,746,394,757,385,764,377,766,377,766,376,769,374,773,369,775,369,778,365,780,365,782,362,784,362,785,360,788,359,788,358,792,357,793,355,797,354,798,352,802,351,803,349,807,348,808,346,810,346,810,345,812,345,812,344,814,344,821,341,821,344,814,350,812,354,811,354,811,362,819,363,819,362,823,362,823,361,827,360,827,359,833,357,833,356,835,356,835,355,837,355,837,354,839,354,839,353,841,353,841,352,845,351,846,349,852,347,852,346,855,345,856,343,860,342,861,340,863,340,865,337,867,337,868,335,870,335,871,333,879,326,880,324,883,324,893,334,910,352,912,352,913,354,921,358,932,343\" data-href=\"canada\" data-maphilight='{\"stroke\":true,\"fillColor\":\"00CDCB\",\"fillOpacity\":10, \"strokeColor\":\"00CDCB\",\"strokeOpacity\":1, \"strokeWidth\":\"2\",\"shadow\":false,\"shadowBackground\":\"189dbb\"}'>\n</map>. hope this helps. lemme know if this is enough, or you would need something else \n. its happening maybe because we are using angular for front end instead total view engine ?. the response is correct. What do you mean the paths are bad ? . so do you mean the pubic directory has to be relative to the controller and can't be anywhere else ? But that doesn't make much sense it doesn't give the freedom to structure the application well and use babel for es6 support either. Do you mean trying to structure the backend and frontend in the different directories is a bad way to stucture the application in total js ?\n. we are migrating the site from php to node js and everything was working fine up until now . that's make a lot of sense lemme try that . well there is another problem \nour backend is in src/server/debug.js and will compile to server/release.js after transpiling with babel and providing directory-public /public is considered to be at the root of debug or release is there a way to get the server root in the config file ?\n. the problem is because to the directory structure, when i implemented the code according to totaljs structure in the image maps worked fine. in these examples again server can't be transpiled from es6 to es5 since node doesn't support all features of es6 as it is. This makes the use to es6 next to impossible then. directory structure for development \npublic\nsrc/server/controllers\nsrc/server/definitons\nsrc/server/views\ndebug.js \n`const options = {};\noptions.directory = process.cwd() + \"/src/server/\";\nrequire('total.js').http('debug', options);`\nconfig \ndirectory-public          : ../../public/\nallow-compile-css         : false\nallow-compile-html        : false\nallow-compile-js          : false\nstatic-url                : ../../public\nstatic-url-css            : ../../public\nstatic-url-download       : ../../public\nstatic-url-font           : ../../public\nstatic-url-image          : ../../public\nstatic-url-js             : ../../public\nstatic-url-video          : ../../public. total js is fine and not causing any problem it the map resize, i have fixed it now everything works great with babel and es6. Thanks for the great framework  \ud83d\udc4d. @petersirka and @molda thanks guys. wow that was stupid. Thanks a lot. the minification is disabled but a copy of the file is still created in the tmp folder ?. yes kinda since we are not using the total's template engine instead using a frontend framework like angular and react which come with their own build engines and we don't want the server to interfer with it at all \n. well no its not a problem yet but it might become a problem while updating the code on live server, we definitely don't wanna start the server every time we update code. Please correct me if i am wrong. i agree that a great implementation if you are using the total's template engine. But since we are using frontend frameworks, all the modern webpack/rollup build tools do this automatically by saving the hashing and minifyng the files. \nRestarting the app is kind of problem since we have different servers in different regions of the world and we use automatic code deployment and  its really not productive for us to restart the app on every single server everytime.\nPlus aren't we putting pressure on the server to look for all these files when ever they are called instead of using the actual file created by these build tools. Since we are already minifying and hashing their name.. yes we can work with a route from clearing the tmp directory for now.\nit will great if you can add a config property just like disabling the .js minification instead of skipping the .js creation in tmp directory only for non blocks ? \nmay be i am being a little ambitious, but is it a possibility ?\n. that's great thanks, i will test it and let you know. have also implemented F.touch(). it works perfectly thanks a lot, when is this feature coming in a stable release ?. that's great!!. thanks for the quick response.. we use nginx \n@dacrhu  will try it.. thanks for the quick response. Well here the catch i am trying to make it utc time but it not working . Yes i agree that's why we are trying to make new Date() object to always return utc time, currently its using the servers time instead of utc.. @webdesus  i have tried that didnt work for us.\nAnd if its an OS issue, how can i fix it ?. windows 10 and centos 7 behaving same. ",
    "mahdi-gh1373": "@petersirka Thank you very much\n\nallow-compile-script : false \n\nsolve my problem.\n. ```\nconst Fs = require('fs');\nNEWSCHEMA('Service').make(function(schema) {\n    schema.define('id', 'String(40)');\n    schema.define('Title', 'String(30)');\n    schema.define('TimeStamp', Date);\n    schema.define('docType', 'String(40)');      \n});\nI don't write any validation yet because I can't use schema for that response.. Actually I  my real reponse is in `value` property of each `rows` .\nNow the response is like this\n[\n    {\n        \"id\": \"Service_3a287fd1-f80a-4624-9862-28409681dae0\",\n        \"key\": [\n            \"service\"\n        ],\n        \"value\": {\n            \"id\": \"Service_3a287fd1-f80a-4624-9862-28409681dae0\",\n            \"TimeStamp\": \"2017-09-26T14:06:54.894Z\",\n            \"Title\": \"NFC\"\n        }\n    },\n    {\n        \"id\": \"Service_4c92371e-a642-4c1e-b59a-ed77f4dd7d7f\",\n        \"key\": [\n            \"service\"\n        ],\n        \"value\": {\n            \"id\": \"Service_4c92371e-a642-4c1e-b59a-ed77f4dd7d7f\",\n            \"TimeStamp\": \"2017-09-26T14:06:54.894Z\",\n            \"Title\": \"Wifi\"\n        }\n    },\n    {\n        \"id\": \"Service_5d98aea5-7065-42c6-855e-2069faa9ef93\",\n        \"key\": [\n            \"service\"\n        ],\n        \"value\": {\n            \"id\": \"Service_5d98aea5-7065-42c6-855e-2069faa9ef93\",\n            \"TimeStamp\": \"2017-09-26T14:06:54.894Z\",\n            \"Title\": \"GPS\"\n        }\n    }\n]\nBut the `value` is my real schema data,\nSo I change schema to :\n`NEWSCHEMA('ServiceValue').make(function (schema) {\n    schema.define('id', 'String(40)');\n    schema.define('Title', 'String(30)');\n    schema.define('TimeStamp', Date);\n    schema.define('docType', 'String(40)');\n});\nNEWSCHEMA('ServiceRow').make(function (schema) {\n    schema.define('value', '[ServiceValue]');\n});\nNEWSCHEMA('Service').make(function (schema) {\n    schema.define('rows', '[ServiceRow]');\n});`\n```\nand in ctrl:\nbuilder.schema('service');\n        builder.exec(function (err, response) {\n            console.log(response.rows.value);\n            // each item should be ServiceRow\n        });\nBut it doesn't work.. Sorry beacuse of this delay I'm working on my web service until I can send example.. example-schema.zip\nHi peter this is my example and I send you some information with email for you to use that.\nThank you. I sent an email to you about my problem.\n. Thank you it's working now .\nYou are the best :-)\n. I found the solution , I should add appmodule as a dependency of my template angular module and after that inject my factory anywhere that i need it.. the console is show this but I can't access to that when I use : https://0.0.0.0:8000/\n```\nC:\\toluebot\\totaljs>node index\n====================================================\nPID         : 1500\nNode.js     : v9.4.0\nTotal.js    : v2.9.2\nOS          : win32 6.3.9600\n====================================================\nName        : Total.js\nVersion     : 1.0.0\nAuthor      : You company name\nDate        : 2018-02-10 13:24:48\nMode        : release\n====================================================\nhttps://0.0.0.0:8000/\n``\nI need a simple https server .. When I open https://localhost:8000/` I see that my site isn't secure .. ",
    "bkhurram": "thanks,\nFor Localization it's possible to set multiple file of resource for language?\nfor language en use this file: [ \"en\", \"home-en\", \"contact-en\" ]\nnow for set language i use:\n```\nF.onLocale = function(req) {\n    var locale = \"it\";\n    if( /^\\/uk\\//gmi.test( req.uri.pathname ) )\n        locale = 'uk';\n    else if( /^\\/en\\//gmi.test( req.uri.pathname ) )\n        locale = 'en';\nF.log( \"LOCALE ==>>\"  + locale );\n\nF.global.locale = locale;\nreturn locale;\n\n};\nin template:\n@(#key)\n@(#keyHome)\n@(#keyContact)\nin Resource file:\nen.resource\nkeyEN : label EN work\nhome-en.resource\nkeyHome : Home Page not work\ncontact-en.resource\nkeyContact : Contact Page not work\n```. i did not understand, can you explane it better?. Thanks you very much for the answer, but that's not what i wanted.\nyou think this will be implemented in the future?. what do you think about this code?\nto read all the resources that contain the locale that start or end with the language setted in F.onLocale\n\nexample\n****-en.resource\nen-****.resource\n\n```\n/*\n * Translates text\n * @param {String} language A resource filename, optional.\n * @param {String} text\n * @return {String}\n /\nF.translate = function(language, text) {\nvar value;\nvar resources = Object.keys(F.resources);\n\nif (!text) {\n    text = language;\n    language = undefined;\n}\n\nif ( language !== undefined ) {\n    for( var i = 0; i < resources.length; i++ ) {\n\n        var resourceName = resources[i];\n        if ( resourceName.match( new RegExp(\"^\" + language + \"-.*$|^.*-\" + language + \"$|^\" + language + \"$\", \"gi\") ) !== null ) {\n            if (text[0] === '#' && text[1] !== ' ') {\n                value = F.resource(resourceName, text.substring(1));\n                if ( value ) {\n                    return value;\n                }\n            } else {\n                value = F.resource(resourceName, 'T' + text.hash());\n                if ( value ) {\n                    return value ? value : text;\n                }\n            }\n        }\n    }\n}\n\nif (text[0] === '#' && text[1] !== ' ')\n    return F.resource(language, text.substring(1));\n\nvar value = F.resource(language, 'T' + text.hash());\nreturn value ? value : text;\n\n};\n```. \n. now works!\nThanks for fix.. see this:\n```\n@{resource( \"res-file\", \"key.UpperCase\" )} WORK\n@{RESOURCE( \"res-file\", \"key.UpperCase\" )} WHY THIS NOT WORK ( empty string ) and previous line work\n@{!RESOURCE( \"res-file\", \"key.UpperCase\" )} give me an exception  \"Error: View \"/it/home/index\": !RESOURCE( \"res-file\", \"key.UpperCase\") - Line: 10 - self.RESOURCE is not a function\"\n```\nres-file\nkey.UpperCase : KEY UpperCase FOUND\n. now it's not work @{!resource( \"res-file\", \"key.UpperCase\" )} \ncase '!resource':\n            return '$STRING(self.' + command + ')';\ni think you forget to add .substring(1)\nthis code work:\ncase '!resource':\n            return '$STRING(self.' + command.substring(1) + ')';\n. It works well.. Thank you very much for the quick fix. you might consider it an implementation to be done in the future. okay then layout see a model parameter it's wrong.. ",
    "michalCapo": "const options = {};\nrequire('total.js').http('release', options);\nF.on('load', function () {\n    F.server\n});. Hmm i'm really sorry. It just happens only when i try \"watch it\" in my IDE (webstorm). Just printing it to console console.log(F.server) it works.\nRight now there is no integration code. I was just trying find out 'how it could be done'.. Yes, internally.\nI'm sorry for this issue, but at the end it works like a charm:\nFirst you need to start rethinkdb\n```\nconst options = {};\nrequire('total.js').http('release', options);\nF.on('load', function () {\n    const horizon = require('@horizon/server');\nconst options = {\n    project_name: 'myProject',\n    auto_create_collection: true,\n    auto_create_index: true,\n    auth: {\n        token_secret: 'my_super_secret_secret'\n    }\n};\nconst horizonServer = horizon(F.server, options);\n\nconsole.log('Listening on port 8181.');\n\n});\n. Hmm but debug doesn't work:\nconst options = {};\nrequire('total.js/debug')(options);\nF.on('load', function () {\n    const horizon = require('@horizon/server');\nconst options = {\n    project_name: 'myProject',\n    auto_create_collection: true,\n    auto_create_index: true,\n    auth: {\n        token_secret: 'my_super_secret_secret'\n    }\n};\nconst horizonServer = horizon(F.server, options);\n\nconsole.log('Listening on port 8181.');\n\n});\n```\nexception:\nReferenceError: F is not defined\n    at Object.<anonymous> (/home/capo/my/code/emptyproject-website-master/debug.js:18:1)\n    at Module._compile (module.js:635:30)\n    at Object.Module._extensions..js (module.js:646:10)\n    at Module.load (module.js:554:32)\n    at tryModuleLoad (module.js:497:12)\n    at Function.Module._load (module.js:489:3)\n    at Function.Module.runMain (module.js:676:10)\n    at startup (bootstrap_node.js:187:16)\n    at bootstrap_node.js:608:3\n-------------------------> DEBUG PID: 31468 (v2.8.0)\nReferenceError: F is not defined\n    at Object.<anonymous> (/home/capo/my/code/emptyproject-website-master/debug.js:18:1)\n    at Module._compile (module.js:635:30)\n    at Object.Module._extensions..js (module.js:646:10)\n    at Module.load (module.js:554:32)\n    at tryModuleLoad (module.js:497:12)\n    at Function.Module._load (module.js:489:3)\n    at Function.Module.runMain (module.js:676:10)\n    at startup (bootstrap_node.js:187:16)\n    at bootstrap_node.js:608:3. ok, thanks. BTW: impresive response time.. Yes sure. Its only js object. Thanks. Thanks. I wasn't sure about load. Man, every time you use new enhancements: $MAKE, which i haven't found in docs.\nBut really thanks.. Now i see them:\n\n. ok. Hi, did you get something like this?\n\nDebugger listening on ws://127.0.0.1:35944/1d1a0c47-47b1-434d-9d63-52aeca32fd30\nDebugger attached.\nStarting inspector on 127.0.0.1:35944 failed: address already in use\nWaiting for the debugger to disconnect...\n. Are you using win, lin or mac?. I would recommend you to use new beta yarn add total.js@beta. I'm using following code to start dev server \n\nrequire('total.js');\nF.http('debug', { port: 3070, ip: '127.0.0.1', inspector: 9229 });\n\nAnd I attached simple project for you. First install dependencies, open debug.js and hit F5\ntotal-debug.zip\n. Hmm, when I change debug.js to this:\nrequire('total.js/debug')({ port: 3070, ip: '127.0.0.1', inspector: 9229 }); it also works and it reloads server when code changes.. And how your options are defined? What kind of OS do you use? Which version of total.js are you using?. maybe it would be faster to comunicate via https://messenger.totaljs.com/. You need to use version 3.x, which is now in beta.\n'npm install total.js@beta'\nThen it will work.. ",
    "gmenih341": "@petersirka The line 1675:10 is just console.trace(), and just below it there's the GETSCHEMA line I pasted above. \nTotalJS version is 2.9.0, and I can't find jComponent being explicitly installed.. There's no exception. It just calls the endpoint handler 4 times, and I get 408 status code on my api calls because of it.. @molda ah, thanks for that info. I thought there was an error in code, so I actually removed the parenthesis. This, however, still doesn't solve my issue :/ . Yep, I see the console.log being called multiple times.. ",
    "webdesus": "it's problem with yours OS. Node.js always using Tz settings, many OS use UTC format by default.\nI think with code should work fine:\nexport TZ=utc \nnodejs server.js. Which OS you use?. I can not believe it. Do you can send me screen? This is my screen\n\n. Maybe you confused the client side with the backend side .... @petersirka i think we can might close this issue, cuz It's not problem total.js \n. @twisig  i uderstand what about you talk. But it's worse idea. I work so long time with DataBase and i used various approach with ORM and without ORM. My opinion EF  framework good while you write little  simple projects. When you wanna make somethink different, you spend a lot of time for search solution how make it in ORM. And sometime it's not working, sometime it's not implimented. If you have big team then each should know your ORM. SQL not hard for understandable and each developer should know sql. It's give more stability and flexibility. \nIf you like it this approach, better solution will be write of plugin for total.js. But this plugin\nmaybe never inside in total.js. But i think @petersirka glad make row in own readme file about your plugin.. Work on security is ongoing always. What kind of integration do you talking?. Hard question but i think it's redundancy... better using set header as string. Helmetjs has good docs about problems which might happen. But using their library I would not.\nBut if you have another oppinion. You can write something like this:\n```javascript\nconst nocache = require('nocache')();\nconst frameguard= require('frameguard')();\nF.on('request', function(req, res) { \n    nocache(req, res,()=>{\n        frameguard(req, res, ()=>{});\n    }); \n});\n```\nNot tested, but should work.. Some modules helmet so big, and execute very more logic. I would advise to examine helmetjs site and write once own definition file with your headers as strings. Then if you create new project you can copy this file.\nYou should get somethink like this:\njavascript\nF.on('request', function(req, res) { \n    res.setHeader('Surrogate-Control', 'no-store')\n    res.setHeader('Cache-Control', 'no-store, no-cache, must-revalidate, proxy-revalidate')\n    res.setHeader('Pragma', 'no-cache')\n    res.setHeader('Expires', '0')\n});. @mahdi-gh1373 if you project not working with money, i would be recommend this service. It's free ssl witch working fine in all browsers. For financial projects I would be recommend use paid services. These questions so many. I started doing small project, but i very slow move ahead, cuz documentation not always clear from the first time. And i begin found examples, read source, but it's too slow for development. I don't wanta sit in chat and ask stupid questions, cuz i know that owener busy, and he can make more job if he not will be read my stupid question.  I think about find time and begin write docs, but in right now i so busy.\nA few questions\nHow i can make CRUD with validation(insert many, update many)?\nHow i can use model inside model? (i don't remember, but i think i have problem with this)\nIt would be great if we have docs like @aubergine10  but not for only ScheameBuilder. \nOr in current docs api add opportunity see part of code for selected api. I think formed a misunderstanding. We do not demand anything (at least I'm). Simply there is a real problem of documentation, because of which many can not take the library and start using it in real projects, because it is difficult for the superiors to prove that this library is really good.\nClosing the issue means that there is no problem, although it does exist. I suggest opening the issue mark with tag \"help wanted\" and perhaps somebody who comes in the project recently will write docs. Or you can open a fund-raising to solve this problem. But at the same time I think that the @petersirka should not write documentation, because he knows his project 100% and it is difficult for him to understand the problem areas. Will do more useful if he continues to bring new features to the project.\nTo sum up: We did not want to offend the author, the project and other people, we do not demand documentation, but talk about the feasibility of an open issue with the problem of documentation.\nP.S Sorry @petersirka i I did not want to hurt you. You make good project and you are doing continues make amazing job.I sometime i don't understand how you so fast response any questions. I know how is hard .And i have was plan return in the this project docs as a reward for your works. But right now i don't have free time((( But may be, sometimes, i will do it. If somebody I will not be surpassed.. P.S.S Ordinary things are really simple, difficulties begin when you make to step to the side. And there the possibilities of total.js do not end. But unfortunately in these possibilities it is not so easy to understand. I wanna disagree. SqlBuilder very simple and have full documentation. It's just replacer wich using pattern builder. Another question whether you need it or not. Cuz if you love sql then write to sql.\nI recommend that I get acquainted this exist projects. For example. Controversial issue... How now to understand that something has gone wrong? . ",
    "sfdc8": "Thanks.. ",
    "xyz-mtl": "Sorry Peter for the delay.\nYou can generate a simple table in Total.js D\u00e9signer and you can see the parameter \u00b4Option\u2019.\nHow to use that ?. :-1: Okay i understood but what do you think about this plugin : Knex\nIt's very helpfull and nice to have more capabilities with your SqlAgent. :100: \nExample:\nknex.schema.createTable('users', function(table) {  \n    table.increments();\n    table.string('name');\n    table.string('email', 128);\n    table.string('role').defaultTo('admin');\n    table.string('password');\n    table.timestamps();\n});\nWhat do you think ? . Thank you for your comment.\nWe need to check if the connection has an issue or not. Is it possible with sqlagent ?\nExample:\nmongoose\n.connect('/path/to/your/mongo')\n.then((response) => {\n    console.log('mongo connection created')\n})\n.catch((err) => {\n    console.log(\"Error connecting to Mongo\")\n    console.log(err);\n}). This event is in the documentation ? I don\u2019t found anything . Check this link for the hosting : https://zeit.co/\nBig Big program... Good luck. Do you integrate some security enhancements for 2018?. I talk about the Helmet module : https://helmetjs.github.io/ \nDo we have the same security process with Total.js ?. Thank you very much . If you want to have more visibility for your community Github is a great platform.\nTotal Chat support is an alternative but not visible from Search engine \nEnvoy\u00e9 de mon iPhone\n\nLe 4 avr. 2018 \u00e0 03:23, Nwokoma Uchechukwu notifications@github.com a \u00e9crit :\n@blaasvaer, not to be offended, I believe this is not an issue. For these kind of questions there is TotalJS Chat Support where you can ask all your questions\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub, or mute the thread.\n. \n",
    "davidAlittle": "re. overhead/collisions: I haven't tried it yet. Right now, I have a project that's built using the Vue ecosystem (Vue, Vuex, vue-router, etc). There's a lot of redundancy between that system and TotalJS, and I don't have permission to port it away from Vue. It will probably be fine? I won't know until I try.\nI'll give it a go and find out.  Thanks!. It's a https://github.com/SimulatedGREG/electron-vue project, with everything enabled (So axios, vue-electron, vue-router, vuex, etc). So, NodeJS is the server.\nWe can discuss this in your chat app, if you'd prefer.. It's an SPA dashboard for machine control. Flow+Dashboard could be a quick way to let the end user build views that I might not have thought of, or to bring controls and indicators in from a bunch of pages into his own custom page.\nI could predefine the flows (since the user wouldn't have access to anything I didn't already have in the UI {though they might want to use some nodes to massage the data}) so they'd only need Dashboard. The nice thing about Flow, though, is you've already done some key IoT stuff, meaning we could let end users do some after market integration without having to support them or write a bunch of custom code to get their I/O into their HMI.\nThat does sound like the best solution, though I'll have to circle back around to it, as I don't know how running multiple Node instances in Electron works.\nHonestly, it would probably simpler to just spin up a second Electron app based on TotalJS and just let the user alt-tab between them than trying to shoehorn them into the same app.\nThanks.. ",
    "Pourya8366": "Problem solved!\ni just have to add the couchbase port which is 8091 in default to the cluster argument for finding it! \nJava Script\nvar cluster = new couchbase.Cluster(\"couchbase://localhost:8091/\");\nand when i check in more, i find out the insert execute after many seconds and the output will be success1 because it takes long for couch to find the cluster without port explicitly written!. I do the first solution but i get the 404 Error for loading the js file!. Oh thanks, i'd think it's the better way to have just one action, BTW thanks for your tip.\ni use it the way you told.. ",
    "blaasvaer": "Why? Three thumbs up. I can't be alone on this.. My general problem with understanding SchemaBuilder is; that first, I don't know what it is that I'm defining doing schema.define( ... ). Why do I do that, what are they used for in the the Schema.\nNext, I see things like: schema.setSave(function () { ... }). What does it actually do internally ... my guess is, that it sets a method somewhere that I can access from the controller using instance.$save ...  ... but I totally miss the binding and the logic, so I feel absolutely crippled trying to get creative with it in any way. As I'm basically working in the dark.\nThe documentation should be MUCH MORE explanatory about what is actually going on. This is more of an API documentation, not really explaining the concept and the idea behind the architecture. Therefore it's pretty hard to grasp.. I'd claim that this:\nThe SchemaBuilder is very helpful for models. You can validate and prepare data according to the schema. The SchemaBuilder supports transformations, workflows, validations and standard CRUD operations (READ, SAVE, REMOVE, QUERY).\nis more like marketing, than actual documentation.\nI still think @aubergine10 was on to something. Why don't you guys continue from where he left off? It looked promising ... and I also wonder why he abandoned the project in the first place ... hmm.. And just to let you know; I've been through all the examples ... and only ONE (1) place could I find $get and from there on guess that that was how to interact with the schema from the model ... the link between the controller and the scheme, and the schema and the DB should be explained in much more detaill \u2013 a real world scenario would be a proper solution.. @petersirka \n\nReally, is it so complicated? I don't think so. \u2026\n\nYes, it is complicated. And of course you don't think so \u2013 you wrote the framework.\nNow, I understand that you get frustrated by us \u2013 the people actually trying to use your framework (and paying for the premium products in an effort to actually support you) \u2013 because you really do work hard on the project. No one is really questioning that.\nDocumentation is for:\n\nMaking people conceptually understand how to apply the technology to the issue(s) they are trying to solve.\n\nNow, examples are fine, as long as they support an actual explanation of what you're trying to achieve. Examples alone is of little use. You may as well go: \n\nRead the damn code.\n\nAPI documentation on the other hand, is for:\n\nA more detailed technical understanding of a given specific method or the like ...\n\nWhen people try out a framework, they usually don't start by reading the documentation end to end \u2013 I for sure don't. I usually try it out on a small project (a TODO or whatever). And then learn the framework bit by bit by applying my ideas using the framework. Now, if the documentation is not written with that in mind, but simply just a dump of the methods (API), then it's really hard to get your head around how to apply certain functionality to a given situation.\nTake a look at this for instance:\n\nNow, I would claim that the extra description doesn't really add any value to the name of the property itself. It's a fine name; it describes what it would actually tell you, and being a developer the is part also tells you that it's probably a boolean value. But expecting people to understand how authorization works within the framework, let alone apply it, would be pretty bold from that bit alone (no pun intended).\nWell, this is getting a bit long ... but I hope you get my point.\nAnd basically I agree with @webdesus:\n\nBut at the same time I think that ~~the~~ @petersirka should not write documentation, because he knows his project 100% and it is difficult for him to understand the problem areas.\n\nI'd suggest you enabled wiki on the framework repository here on github, and open sourced the documentation ... so that we can all help out improving on it.. If there's one thing we've learned over the decades from software projects, it's:\n\nBad documentation will kill ANY project.. But why spread the same issue over several threads?. OK, so I finally decided to ditch this framework for the time being. I seem to be constantly revisiting the same issues over and over (RESTBuilder, NEWSCHEMA, HttpRouteOptionsFlags and what have you), without them sticking at all. The concepts of the framework are simply to 'magical' for me to actually understand what is going on. And to be sufficiently fluent in any framework, you at least have to 'understand' what is going on.\n\nI've been fiddling (or actually trying to build a few real world applications) with totaljs since august last year, and nothing but the very basics seem to make any sense to me. Now, having been a web developer for more that 20 years, this is the first time I've actually been forced to ditch any framework to the simple fact of 'simply not getting it'.\nYou can undoubtedly build stuff with it, as proven by the apps you can download. But even with access to the source code of these, it's simply to hard to adapt any of that to your own projects (unless you do simple copy/paste \u2013 but that's not a way to build anything). Again, not understanding the framework is the reason for this.\nThanks to @petersirka for actually trying to help \u2013 please, don't encourage people who don't understand the framework to write or improve the docs as you do in this thread ; ). It'll probably just make things even worse.\nNow, I've paid for a premium account until august. And I will check back in once in a while to see if things improve in any direction that I can wrap my head around. Meanwhile I'll go with Express.\nThank you for now, and all the best.. I agree that @petersirka is very helpful and maybe fixes issues very fast (I don't know, he hasn't fixed mine ; ) ). But I'd actually prefer to be able to fix any problems or issues myself. But to be able to do that, I'd have to 'understand' the framework I'm using. Otherwise I'd only be guessing; and that's basically what it's felt like for the past many months. I'm not saying that I don't get ANY of the framework, but there's just too much that is 'hidden' behind a 'concept' that I simply don't get. And that simply cripples me in being free to 'do whatever I want' \u2013 I simply find myself staring at the screen way to often, trying to figure out how to do a specific thing. And that just proves to myself, that I have no clue of these 'concepts'. And unfortunately the docs haven't been able to clear any of those out.\nYes, I've built applications with totaljs. But the time spent building those, just make it a VERY bad ROI in my case. Spending waaaaay to much time fighting (or actually trying to understand) the framework, instead of it helping me.\nNow, I've worked with a LOT of frameworks throughout the years, and have always been able to fairly quickly become comfortable enough to be able to know what to do in basically any situation \u2013 or at least find an answer in the docs. In totaljs it's unclear whether I should create a definition, a helper, use a RESTBuilder, a model ... maybe that's a good thing, freedom wise. But to me it's just plain confusing.\nWell, some frameworks are just not for all I guess.\n@BlueMagnificent this should not be seen as a rant. Maybe it'll just make another guy feel not alone if he faces the same issues.. Yeah, seems to work now. I think Peter fixed it. Wasn't working, and he was aware of it, so ... I guess he fixed it.. I spent days trying to get the SqlAgent to work ... without any luck. The only way I've managed to connect to mysql is with this:\n```\nexports.getProjects = function ( next ) {\n    F.database(function( err, connection ) {\n        if ( err != null ) {\n            return;\n        }\n    let query = \"SELECT projects.id AS project_id, projects.name AS project_name, clients.id AS client_id, clients.name AS client_name FROM projects, clients WHERE projects.client_id = clients.id\";\n\n    connection.query(query, function( err, rows ) {\n        // Close connection\n        connection.release();\n\n        if (err != null) {\n            return;\n        }\n\n        next( rows );\n    });\n});\n\n}\nexports.getProject = function ( id, next ) {\n    F.database(function ( err, connection ) {\n        if ( err != null ) {\n            return;\n        }\n    let query = \"SELECT projects.id AS project_id, projects.name AS project_name, clients.id AS client_id, clients.name AS client_name, projects.description AS description FROM projects, clients WHERE projects.id = \" + id + \" AND projects.client_id = clients.id\";\n\n    connection.query( query, function ( err, rows ) {\n        // Close connection\n        connection.release;\n\n        if ( err != null ) {\n            return;\n        }\n\n        next( rows );\n    });\n});\n\n}\n```\nAnd that is, having a definition like this:\n```\nlet mysql = require('mysql'),\n    pool = mysql.createPool({\n        host: 'localhost',\n        user: 'root',\n        password: 'root',\n        database: 'timetracker',\n        typeCast: function castField( field, useDefaultTypeCasting ) {\n            if ( ( field.type === \"BIT\" ) && ( field.length === 1 ) ) {\n            var bytes = field.buffer();\n                return( bytes[ 0 ] === 1 );\n            }\n            return( useDefaultTypeCasting() );\n        }\n    });\nF.database = function ( callback ) {\n    return pool.getConnection( callback );\n};\n```\nHere I'm manually writing all my queries ... And I haven't been able to 'convert' this into a Schema, as I simply do not know the inner workings of them. Not to mention that the DB stuff I haven't been able to convert to SqlAgent stuff.\nNow, some well commented isolated examples would be nice. Oh, here I go again on the docs ... ; ). So, here we go again \u2013 another shot at making the SqlAgent work, and hopefully in the process get just a tiny bit of understanding of what is going on:\nI have this in (definitions/mysql.js):\nlet mysql_connection_string = \"Server=localhost;Port=80;Database=timetracker;Uid=root;Pwd=root\";\nrequire('sqlagent/mysql').init( mysql_connection_string, true ); // debug is by default: false\nAnd this in (controllers/projects.js):\n```\nexports.install = function () {\n    F.route('/projects', view_projects, ['*Projects']);\n};\nfunction view_projects () {\n    let self = this;\nself.$get(self, self.callback());\n\n}\n```\nAnd yes, I know I don't return any response ... but one step at a time.\nWhat I don't get is, what is $get actually calling on the model? As I read the docs, it's executing the get delegate(!?) on the model, which \u2013 to my best understanding of it \u2013 is set using schema.setGet .... But why I'm passing in the controller I don't know, and what self.callback() is I don't know ... and on and on it goes.\nAnd this in (models/projects.js):\n```\nNEWSCHEMA('Projects').make(function ( schema ) {\n    schema.define('id', 'Number');\n    schema.define('name', 'String(50)');\n    schema.define('client_id', 'Number');\n    schema.define('description', 'String');\n    schema.define('active', 'Boolean');\nschema.setDefault(function(name) {\n    switch (name) {\n        case 'active':\n            return \"b'1'\";\n    }\n});\n\nschema.setGet(function (controller, callback) {\n    const sql = DATABASE( new ErrorBuilder() );\n\n    sql.select('projects', 'projects');\n\n    sql.exec(function ( err, response ) {\n\nconsole.log(response.projects);\n        });\n    });\n});\n```\nI'm simply trying to get SOMETHING back from the DB for a start.\nBut what I get so far is:\n500: Internal Server ErrorTypeError: Cannot read property 'split' of null\nYeah, start debugging that ... ; )\nI suspect it's because I haven't gotten any where and the like attached to the sql. But I would expect the above to return EVERYTHING from the projects table, as in 'SELECT * FROM projects'.\n@webdesus, I've been through a lot of the finished apps. They're uncommented, and NOT the way to learn a whole framework.. Oh, great to know. Sorry, totally missed that response.. And now I suddenly get:\n500: Internal Server ErrorError: Schema \"Projects\" does not exist.\nHow on earth did that suddenly remove my Schema!?!?. Well, had to scrap the tmp folder to get rid of that .... So, a bit of a break through ... with the correct connection string \u2013 which @molda gave me the answer to six days ago in another thread \u2013 I can pull data from the DB. Hooray!\nNow, how do I wrap that in the controller to send it to the view ... the self.callback() is confusing me.\nwait for this self.$get(self, self.callback()); ... then send to view.\n. But VERY hard to pick up from reading the source code from an app. And even though having read the docs I didn't make that connection ... things are to wide apart.. And you have to admit that:\nself.$query(self, self.callback('index'));\nIs NOT very self explanatory.. Yes, I know. But part of the problem is, that github is supposed to be a part of the community (see screenshot from the totaljs.com website).\nAnd when looking for answers, there really seems no where to go in terms of 'community'. It's scattered all over the place. I know that 'issues' on github is supposed to be about issues \u2013 but you could actually broadly define it as an issue, that it's pretty hard to find specific information about the framework ... guessing where to look in the API docs isn't much help.\n\nSo, therefore, I'm asking here. And not offended at all ; ).. Then please, remove the github link from your \u00bbFramework community\u00ab page. It's adding to the confusion ... and while we're at it, maybe also LinkedIn as well, as that would be covered as well by the arguments.. Thanks.. Thank you for confirming my best guess ; )\nAnd not really sure how to answer that.\nBut when something happens by default (layout in this case), then to make it not use the default, you usually have to define it somehow \u2013 that's why I figured: if you have to specify some other layout than the default one by using a string, you could point to no layout using an empty string (but when actually typing it out, I had no idea whether this would throw me an error or not).\nBut my problem really is, that I don't know whether the framework provides a special feature or not for this (like @{no_layout} or whatever), as it is not specified specifically in the docs.\nAnd that's just more reasons why it feels a lot like guessing when working with totaljs.\nComplete documentation usually covers all use cases. But I guess, that's just me.. ",
    "qoole": "I entirely agree with the points raised in this thread. The documentation and examples are pretty poor.\nNOWHERE can I find documentation as to what the arguments to 'setGet'/'setQuery'/'set*' actually are/mean.\n\nmodel? helper? controller? what actually ARE they.\n@petersirka - from the point of view of the developer it'll be 'obvious' because you know the ins and outs of the product you have written. From an outsider's point of view it really isn't clear, and the documentation does little to nothing to enlighten us.\nI am on the verge of ditching this framework because I cannot find how to do even the most basic things. \nSo many of the 'examples' have bodged in little shards that show you what the results of doing something will be, but not proper examples of how to do things.\nTake the models example for instance (https://github.com/totaljs/examples/tree/master/models) this shows NOTHING about how to use a model.... the 'model' that is included is just a shard with a function in it.\nThe workflow example (https://github.com/totaljs/examples/tree/master/workflows) it creates a load of workflows and transforms, etc. All they do is print something to the log. The example doesn't do anything meaningful to show how to actually USE workflows. \nDo workflows only return a true/false (fail/succeed)? Can they pass data on to the next workflow/operation? If so how does that happen?\nSearching the examples repo I can find 3 examples of 'setSave'. ONE of them does anything meaningful with the data and that is to just blind insert it into a NOSQL database.\nSame thing for 'setQuery', etc.\n@blaasvaer summed it up pretty succinctly..... I would suggest re-opening this issue to demonstrate your willingness to improve the documentation.. ",
    "sersh88": "Same here. I was total newbee to nodejs and finished big project with totaljs just after one month. Of course I did some mistakes and now my understanding of the framework is much deeper, but I don't see any reasons not to understand it. Also Peter is very helpful and fixes any problems with framework very fast.. Well, this is difficult, becouse this error appears not every time ( I have thousands of uploads per day)  and I don't understand what need's to be logged to catch this.. Uploads are done with php script using curl. Requests contains both files and some post fields.\nFor some files in this request the filename is wrong - its name is like form-data; name=\"file4\"; filename=\"\nBefore I used php to handle this uploads and everything worked fine.. the size is different - 5-300kb\nThe type is jpg. In php file fields are created like this:\nphp\n$data['file' . $_i] = \\curl_file_create(realpath($file));. The amount of files in one request - about 5-10. Yes, I upload multiple files with one field of additional data. I have tried also to simulate hundreds of uploads of same files - also no problem. Looks like it happens with particular files and data. I am trying to catch this error and copy these files for test, will be back later.. Well, catched this by now:\nIn internal.js in function onHeaderValue the function gets not full buffer I guess.\nI put some logging before this function:\njavascript\nlog.push(buffer.slice(start - 50, end + 100).toString(ENCODING));\nvar header = buffer.slice(start, end).toString(ENCODING);\nAnd this log showed: ---------------e278e3845310\\r\\nContent-Disposition: form-data; name=\"file5\"; filename=\"/www/fasttube/backend/app/cache/upl\nSo, after var header = buffer.slice(start, end).toString(ENCODING); header becomes:\nform-data; name=\"file5\"; filename=\"/www/fasttube/backend/app/cache/upl\nAnd after calling header = parse_multipart_header(header); :  [ 'file5', 'form-data; name=\"file5\"; filename=\"' ]\nSo, filename becomes 'form-data; name=\"file5\"; filename=\"\nWhat do you think? Why buffer could be truncated? Where to log more?\nAgain - this happens not every time. . Not sure, need to check. But I send with php curl. And this error appears only maybe for 1 of 500 uploads. Maybe network error, I don't know. Will try to find the way to check.. Give me please couple of days to debug this. Was very busy with other projects. Problem still here.. Still testing... Error happening one - two times per day, so still not understand why. Changed nginx configuration about timeouts, maybe becouse of them.. I give up. Too difficult for me to debug it. Still getting this error randomly. What I discovered, is in internal.js function parser.onHeaderValue gets cutted buffer sometimes, like this: form-data; name=\"file1\"; filename=\"/www/fasttube/backend/app/cache/uploads/2018-11-07-1541\nAnd should get buffer like this: form-data; name=\"file3\"; filename=\"/www/fasttube/backend/app/cache/uploads/2018-11-07-1541607576-5be310982beef/t_8.jpg\nThe logic of how it cuts header values is too difficult for me to examine. As I understand, it may be formidable bug.. No, filename doesn't contain any unusual chars. And I tried exactly same uploads repeated thousand times without error. I mean I catched the errored upload, copied all the files of this upload, all fields and headers and then simulated same upload thousands times - no error. So, looks like this error occures only when different uploads comes simultaniously. I also upgraded node, upgraded nginx - not helped. I will try another multipart parser.. Made a separate script for uploading task with vanilla node http server + multiparty parser. Looks like this helped, no errors so far. So, I think it's formidable or total.js issue, but I don't know how to track it.\nAnd one feature request - please, make it possible to handle route customly. I know about controller.custom(), but in this case it is too late, because total.js already parsed body and headers with 'upload' flag. Maybe add 'custom' flag which will mean don't do anything, let the script handle req and res as with vanilla http server.. ",
    "oldCoder29": "Now it works!!... ",
    "miguelavaqrod": "Thanks for your quick response Peter!\nAnd... congratulations for that amazing framework!\nLooking to be a premium member just for supporting you.... Let me indicate an example:\nImagine you want to alter default layout.html file without touching it and, maybe... you need different code based on language.\nYou create, for example, a module with this code:\n/ QUICK AND DIRTY /\n  F.modify(function(type, filename, body, controller){\n    if(type === 'view' && filename.indexOf(F.config.default_layout + '.html') > -1){\n     var sample = 'HI';\n      if(controller && controller.language === 'es') sample = 'HOLA';\n      return body.replace('',  sample + '');\n    }else{\n      return body;\n    }\n  });\nIt is a silly example... I use it to insert javascript code based on parameters like language, user login, ...\nThere is no need to touch layout.html (in this case) so you can create self-contained modules (or similar) that modifies view contents on the fly. \nYou can always use modificators as usual just ignoring controller parameter on the corresponding function.\nHope it helps!. ",
    "nabeelalis": "Nvm . ",
    "zerr0ne": "Hi, thanks for the fast reply, yeah, thought so from looking at the core code... how would I use F.merge() for the purpose outlined below (and then use it in a layout)? Cannot figure it out based on the docs @ https://docs.totaljs.com/latest/en.html#api~Framework~F.merge as the examples there just merge files (typed out filenames), I just like to pass the directory, e.g. F.merge('/js/') or if that is not possible, use a wildcard type of expression like F.merge('/js/*.js') or F.merge('*.js'), is that possible with F.merge()?\nEDIT: Damn, overlooked that:\n// Merging all files\nF.merge('/merge.js', '/js/*.js');\ncan I use something like @{merge()} in a layout file? (couldn't find anything in that direction @ https://docs.totaljs.com/latest/en.html#api~FrameworkViews\nEDIT2: guess I found how it would be done @ https://github.com/totaljs/examples/tree/master/static-file-merge\nwould be convenient to have a @{merge()} available in the view engine though =), AND/OR it could also be solved by allowing directory paths to be passed to @{import(), @{js()}, @{css() which would then implicitly trigger F.merge() from within Controller.prototype.$import and Controller.prototype.$css / Controller.prototype.$js respectively. It would also be useful if F.merge() had a way of telling it to ignore files, or would that work by prefixing them with a dot .?\nawesome work btw, keep it up!. Tried if I can come up with something, but got stuck... put this in index.js (of total.js core)\n```\n/*\n * Merge directory of files and append ",
    "Jusys": "There might be just need to temporarily disable some code in view file. Disabled code shouldn't be processed and shouldn't be sent to user. The best solution would be to add view engine's own comment system. I would suggest to use @{! to start comments and !} to end. \nFor example let's say I have such code:\n1. @{!<div data-jc=\"textbox\" data-jc-path=\"some.value1\">@{some.other.value1}</div>\n2. <div data-jc=\"textbox\" data-jc-path=\"some.value2\">@{some.other.value2}</div>!}\n3. <div data-jc=\"textbox\" data-jc-path=\"some.value3\">@{some.other.value3}</div>\nHere lines 1. and 2. are commented out for now. Maybe they will be enabled in the future.\nI think it's not hard to implement in view engine - just run some regex which deletes code between @{! and !} before compilation and that's it.. P.S. such comment system is good for leaving comments, which user should not see. it makes harder to write code - when you develop project, you disable HTML compilation, because compiled html/js/css is very hard to debug. If @{! is already used, then just use some other comment symbols like @{* and *}. I think it's no reason to 'reinvent the wheel' - almost all (or all) other view engines have their own comment symbols and do not rely on html comments.\nBTW speaking about debugging: it seems, that I cannot find uncompiled spa.js and spa.css; when I get an error in spa.min.js it's very hard to debug.. P.S. @{-- and --} would also be a good choice.. Today I've got one thought too - if you're removing all html comments, what about:\n<!--[if gte IE 8]><!--><!--<![endif]--><!--[if gte IE 9]><!--><script type=\"text/javascript\" src=\"//some-src\"></script><!--<![endif]--><!--[if lt IE 9]><script type=\"text/javascript\" src=\"//some-src\"></script><![endif]-->. I will try - but will all VS Code debug features work? Like breakpoints/variable resolving/intellisense? I'll try.. Ok I tried, and I can attach to totaljs process, but breakpoints still not work - I will try more, when I'll have time.. So after a few tries I ended with this:\nif using VisualStudio Code - and debugging release.js (just hit F5 and have proper launch.json configuration) with following code:\nrequire('total.js').http('release', options); or require('total.js').http('debug', options);\ndebugging works fine, but server does not restart automatically when there is a change in source files. \nIf I use debug.js with:\nrequire('total.js/debug')(options);\nthen when hitting F5 (having the same launch.json configuration as for release.js) - process starts, outputs -------------------------> DEBUG PID: 10072 (v2.9.4) and immediately ends.\nIf I use @michalCapo code (from total-debug.zip) then process starts and hangs while displaying -------------------------> DEBUG PID: 10072 (v2.9.4) (http://127.0.0.1 is not accessible - web server does not start).\nwhen I try to run node debug.js - server starts, but then then only way to debug is to attach VSCode debugger to process id and breakpoints don't work - they're grayed out (automatic code reloading works).\nP.S. I use following launch.json setting for @michalCapo example:\n{\n\"type\": \"node\",\n\"request\": \"launch\",\n\"name\": \"total-debug\",\n\"program\": \"${workspaceFolder}\\\\websites\\\\total-debug\\\\debug.js\"\n}\nP.P.S. I use following directory structure in my test totaljs project:\n\\test-totaljs\n\\test-totaljs\\node_modules\n\\test-totaljs\\websites\\total-debug\n\\test-totaljs\\websites\\website1\n\\test-totaljs\\websites\\cms\n\\test-totaljs\\websites\\ecommerce. I think I'll stick with restarting server manually for now, but in case you're interested here are my options you asked:\nWindows 7 32bit / Windows 10 64 bit\nTotal.js 2.9.4\nNode.js 10.0.0\nOptions (my project):\nconst options = {};\noptions.inspector = 9229;\noptions.port = 81;\nrequire('total.js/debug')(options);\nOptions (@michalCapo example):\nrequire('total.js/debug')({ port: 3070, ip: '127.0.0.1', inspector: 9229 });\nP.S. if I'll continue to learn and use total.js - I'll rise this issue once again (if it will be not solved by that time and if I fail to solve it myself).. @petersirka  Ok, I'll do that. You may close this issue.. hi, peter. I'm thinking - why you use --> or -> ? I think pipe (|) in this case fits more naturally. Pipe symbol is used for this purpose (piping commands) in most systems I've encountered. Even you use pipes in totaljs' (I've found this in tangular): {{ created | format('yyyy-MM-dd') }} or {{ count | pluralize('no users', '# user', '# users', '#users') }}..\nSo I think it's cleaner syntax this way:\n<div data-jc=\"textbox\" data-jc-path=\"forma._id | (value) => { return value + ' sfsdfsdf'}\">Kodas 2</div>\nP.S. I'm absolutely new in totaljs (after 2 weeks of research I feel, that I know totaljs even less than in beginning and I begin to lose my patience :) ), so I may not know something, what is holding you back from using pipe in this case.. D\u0117koju.. P.S. I thought that there is some automatic cycle, that checks values, like in angular... ",
    "pnmcosta": "i confirm @petersirka method works, on latest beta as @michalCapo pointed out.. \nFYI, if you add \"main\": \"debug.js\" to your package.json you can debug directly without specific VS launch config files.. Perfect, confirmed. thank you so much.. ",
    "juniarz": "Hi peter,\nI've tried to configure the folder as suggested above, the error still appears.. ",
    "HACKHERS": "Hi @petersirka,\nThanks for the feedback! I have seen Link Prefetching but the reason behind this PR enable users to add prefetching on controllers for example for posts in CMS: \nfunction view_posts_detail(linker) {\n        ...\n    self.$workflow('render', options, function(err, response) {\n        ...\n        const pictures = response.pictures;\n        for(let i = 0; i < pictures.length; i++) {\n            self.link(pictures[i], 'image', 'preload', true);\n        }\n                ...\n    });\n}\nBetter part, for me at least is HTTP/2 Push Support. I'm not suggesting it's the best way to do it (For example we can use Etag for push cache instead of Cache TTL). I'm open for suggestions..\nEdit: I'm working on automatically adding links from view link generator. But there is a problem I'm facing right now since views are cached I need to cache links with view cache somehow. Example code routeImage:\n/**\n * Create URL: IMG\n * @param {String} name\n * @return {String}\n */\nController.prototype.routeImage = function(name) {\n    var result = this._routeHelper(name, F.routeImage);\n    this.link(result, 'image', 'preload', true);\n    return this._routeHelper(name, F.routeImage);\n};\nNote: There isn't case for view_posts_detail, because controllers always run with or without cache.. Thanks thats what I have done actually with some simple modification \ud83d\udc4d \nPS: Premium CMS fails on admin views if you don't check file extension (js)\n```\nF.onCompileScript = function (filename, code) {\nif(F.isDebug) return code; // for debugging performance\n\nif(filename !== undefined && path.extname(filename) !== \".js\")\n    return code;\n\nreturn UglifyJS.minify(code).code;\n\n};\n```. ",
    "truedat101": "Unfortunately I'm stuck on a legacy version 1.7.2. I would need to port my\napp.\nOn Wed, Jul 11, 2018 at 1:43 PM Peter \u0160irka notifications@github.com\nwrote:\n\nHi @truedat101 https://github.com/truedat101,\ntry to install latest version of Total.js $ npm install -g total.js and\nlet me know.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/totaljs/framework/issues/649#issuecomment-404303017,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAD6ylE1FUUhmlYmOvc-gQXMtiVBqR7nks5uFmNcgaJpZM4VLz6I\n.\n. So if I  remove local node_modules in my app, in this case, just testing in totaljs-examples.git/views (pretty simple project), I get the same error.. Also, confirmed same error on Mac OS X with same versions.. I suspect if this was not working in the release I am testing, you have fixed this in a later release.  If I know what was the problem I can patch locally as I have done in the past.. Hmm, that would work.  I am curious what was wrong with 1.7.2.  Anyway, I've gone ahead and migrated to total.js@1.9.8 with minimal code changes so I will sit fine with this slightly newer version for now. . Feel free to close if this is a \"not going to fix\" thing.. I am your humble servant on these matters of english language.  It's an awful language with a mashup of things from Germanic, French, Latin, Spanish, etc., all mixed together, with some  rules and many exceptions.  Worse is the colloquial regional use of the language which makes it hard to determine meaning (we speak differently in SF area than people in NYC).  And throw in a lot of bad english being taught by supposed language scholars (Japan, for example, teaches english for at least 8 years of education but produces very few good english speakers after 8 years).  \n\nAnyway, since I feel a bit indebted to you for the great project and code, I will continue to look for places to improve documentation and site marketing/information.\nIs this the correct project to provide bugs/suggestions for documentation and site related items?. ",
    "gibson": "i need execute session module before F.onAuthorize . thx, its working. Thank you, too many docs per day) . I think we need in documentation section for routing. ",
    "exside": "@petersirka aware of that, but do they do line-by-line streaming, e.g. can I get an entire line of CSV (but not more or less) with those?\nAFAIK the streamer are chunk and not line based, no? (can be wrong though). @petersirka oh great, perfect! That would remove the streamerLine() method from the list. Would the parseCSV method therefore already be too specific of an implementation to be part of the framework?\nSomething else that came to my mind:\nIs there a way to overwrite the image.minify() \"processing\"? e.g. let's say I want to perform the image optimization with the imageoptim cli, could that be done (instead of using the +profile flag for ImageMagick)?\nEDIT: could the above CSV parsing example be combined with a Promise()?\nEDIT2: and can the totaljs --compress command deal with multiple files and \"pipe/concat\" them into one file? ~~And what's the difference to the totaljs --minify command (same question regarding multiple files with that)?~~ (they are aliases...)\nfrom looking at the cli tool code it doesn't look like it can deal with multiple files:\n```\n    if ($type === 5) {\n    if (!fs.existsSync(dir)) {\n        console.log('ERROR: file not found');\n        console.log('');\n        return;\n    }\n\n    var content = fs.readFileSync(dir).toString('utf8');\n    var extension = U.getExtension(dir);\n    var filename = dir.replace('.' + extension, '.min.' + extension);\n\n    switch (extension.toLowerCase()) {\n        case 'html':\n            fs.writeFileSync(filename, Utils.minifyHTML(content));\n            break;\n        case 'js':\n            fs.writeFileSync(filename, Utils.minifyScript(content));\n            break;\n        case 'css':\n            fs.writeFileSync(filename, Utils.minifyStyle(content));\n            break;\n    }\n\n    console.log('Minified: ' + filename);\n    return;\n}\n\n```\nwould that be a potential enhancement? Meaning if we could do something like\ntotaljs --minify path/to/js/*.js scripts.min.js\nPotential solution: not sure about the cli, but probably we could use F.merge() to concat the files and then push them trough Utils.minifyScript(), e.g. \nUtils.minifyScript(F.merge([...]));\n@petersirka could the cli-tool not be easily extended to check weather the input is a path or a file (or multiple files for the sake of completeness) and then act accordingly?. @petersirka is there any way to save the contents of the virtual route created by F.merge()? I'd like to concatenate some .css files and then process the result further.\nThe idea above Utils.minifyScript(F.merge([...])); can't work like that as F.merge() does not return the result, but the Framework object itself.\nMaybe important to note: I'm not running a local total.js server in that scenario but use total.js as a \"utility belt\" for a build tool (calling js methods like the above from an npm script).. @petersirka awesome, thanks for the code, beautiful example of staying close to native node, sprinkling it with the cool additions total.js brings to the table. That should be part of the examples!\nWhat do you think about making the minifyScript() (and its variations) capable of handling multiple files (which of course would also imply that we could pass file-paths instead of strings only)?. ",
    "trendchaser4u": "yeah but it save files in tmp dir :( i need to upload to public dir.. yup !! got it... thanks a lot!! you are awesome :) :+1: . ",
    "separovichabel": "Sorry for the delay.\nI'm using ROUTE() now but the $.controller.proxy(url); is timing out.\nAny reason for that? or is there any other way to furnish an image from another site?\nRoute\nROUTE('/common/signature/',      get,   ['*Signature', 'get', 'cors']);\nfunction get() {\n    var self = this;\n        var options = {};\n    options.search = self.query.search;\n    self.$workflow('get', options, self.callback());\n}\nSchema\nschema.addWorkflow('get', function($) {\n        const url = 'https://www.totaljs.com/img/logo2.svg';\n        $.controller.proxy(url);\n        $.callback = null;\n    });\nResponse\n{\n    \"statusCode\": 408,\n    \"error\": \"Request Timeout\",\n    \"message\": \"There have been some errors with api, please report the problem or difficulty to the technical team responsible\"\n}. The time out is an intern problem with my server.\nBut no image is shown with that exemple:\nproxy-test.js\nrequire('total.js/debug')({});\ncontrollers/default.js\n```\nexports.install = () => {\nROUTE('/', get, ['*Proxy', 'cors', 'proxy']);\n\nNEWSCHEMA(\"Proxy\").make(function(schema) {\n    schema.addWorkflow('get', function($) {\n        $.controller.proxy('https://assets3.thrillist.com/v1/image/2558908/size/tmg-article_tall.jpg');\n        $.callback = null;\n    });\n});\n\n}\nfunction get() {\n    var self = this;\n    var options = {\"search\": self.query.search};\n    self.$workflow('get', options, self.callback());\n}\n``. UnfortnantlyU.downloadis not helpping me. There is something wrong with url encoding.\nI want to sendblabla.com?pregui\u00e7a=\u00e9but it actualy sendsblabla.com?pregui\ufffda=\ufffd`\nDoes it accept utf-8 ? how can i fix it?. Thank you very much!\nSorry for bothering.. ",
    "kerkeniakov": "Hi Peter ,\nThanks for the reply.It is a large and complex project so it will take me a couple of days to prepare an example for you.\nThanks!. Hello , \nIt seems the issue was OS related. We were running on AWS EC2 Ubuntu Server 14.04 LTS with latest node(11).\nNow we have migrated the application to an AWS EC2 AWS Ubuntu Server 18.04 , and although during high loads we still reach 100% cpu the application no longer crashes and resources are freed shortly when traffic normalizes.\n. ",
    "EddiDin": "Thanks. I will wait for the update!. ",
    "neophylon": "Hi @pertersirka\nI have got a error message on Chrome : ERR_SSL_VERSION_OR_CIPHER_MISMATCH\nmy index.js\n// ===================================================\n// FOR DEVELOPMENT\n// Total.js - framework for Node.js platform\n// https://www.totaljs.com\n// ===================================================\nconst options = {};\noptions.ip = '0.0.0.0';\noptions.port = parseInt(process.argv[2]);\nconst fs = require('fs');\noptions.https = {\n    key: fs.readFileSync('/etc/letsencrypt/live/xxx.xxx.xxx/privkey.pem'),\n    cert: fs.readFileSync('/etc/letsencrypt/live/xxx.xxx.xxx/cert.pem')\n}\nrequire('total.js').cluster.https('auto', 'debug', options);. Sorry for late.\nif i use 'require('total.js').https('debug', options);', everything is fine.\nSo, now I have used only https not cluster https.\nBut I want to use cluster https. I installed totaljs@beta version already.\n. when I use\nrequire('total.js').cluster.https(5, 'debug', options);\nI still get the error \"ERR_SSL_VERSION_OR_CIPHER_MISMATCH\" on the Chrome browser\nSo, I try to modify my index.js and total.js/cluster.js.\nindex.js\n```\noptions.https = {\n    key: fs.readFileSync('/etc/letsencrypt/live/domain.com/privkey.pem'),\n    cert: fs.readFileSync('/etc/letsencrypt/live/domain.com/cert.pem')\n}\n==>\noptions.https = {\n    key: '/etc/letsencrypt/live/domain.com/privkey.pem',\n    cert: '/etc/letsencrypt/live/domain.com/cert.pem'\n}\nrequire('total.js').cluster.https(5, 'debug', options);\ntotal.js/cluster.js\nfunction on_init(msg){\n......................\n                        if (msg.https){\n                msg.options.https.key = Fs.readFileSync(msg.options.https.key);\n                msg.options.https.cert = Fs.readFileSync(msg.options.https.cert);\n                    F.https(msg.mode, msg.options);\n                }else{\n                        F.http(msg.mode, msg.options);\n                }\n.....................\n```\nIt works.\n. Thank you,\nBut it can't use with \"require('total.js').https('debug',options);\".\nSo, I'm just temporary using it. \n. I update total.js@beta. then try it\nI got the follow error\n2019-01-18 13:39:10: Error: error:0906D06C:PEM routines:PEM_read_bio:no start line Error: error:0906D06C:PEM routines:PEM_read_bio:no start line\n    at Object.createSecureContext (_tls_common.js:88:17)\n    at Server (_tls_wrap.js:819:25)\n    at new Server (https.js:60:14)\n    at Object.createServer (https.js:80:10)\n    at listen (/opt/cluster_test/node_modules/total.js/index.js:6799:21)\n    at /opt/cluster_test/node_modules/total.js/index.js:6826:6\n    at /opt/cluster_test/node_modules/total.js/index.js:3920:16\n    at Array.AP.async (/opt/cluster_test/node_modules/total.js/utils.js:5015:16)\n    at /opt/cluster_test/node_modules/total.js/index.js:3915:16\n    at Array.AP.async (/opt/cluster_test/node_modules/total.js/utils.js:5015:16)\n. index.js\n// ===================================================\n// FOR DEVELOPMENT\n// Total.js - framework for Node.js platform\n// https://www.totaljs.com\n// ===================================================\nconst options = {};\noptions.ip = '0.0.0.0';\noptions.port = parseInt(process.argv[2]);\noptions.https = {\n    key:'/etc/letsencrypt/live/xxx.xxx.xxx/privkey.pem',\n    cert:'/etc/letsencrypt/live/xxx.xxx.xxx/cert.pem'\n}\nrequire('total.js').cluster.https(4, 'debug', options);\n//require('total.js').https('debug', options);\n// Use a terminal for testing:\n// $ siege -b -r 10 http://127.0.0.1:8000/\ntotal.js version : \"total.js\": \"^3.2.0-6\"\n. ",
    "germama": "I recently added one more tab in Flow which contains various 3 sec timers.\nThose trigger a custom ping component which uses npm ping package for probing different hosts and npm influxdb to store those results in InfluxDB.\nThere was at least no obvious memory leak visible but I need to investigate further.. I believe Total.JS is working properly.\nFigured out that https://www.npmjs.com/package/influxdb-nodejs has some memory issues.\nConnecting to InfluxDB using this library and writing a dataset leads to excessive memory consumption over time.. ",
    "khaledkhalil94": "I would need to message you privately because I'm using a private key and I can't expose it publicly.. ",
    "wprayudo": "how I can connect websocket route to another supported websocket protocols in nanomsg/zeromq ?\nThank you,\nRegards.. ",
    "vasekd": "It seems that this is the problem of traefik websocket layer \nI have found this definition:\nAn intermediary MUST NOT change the fragmentation of a message if\n      any reserved bit values are used and the meaning of these values\n      is not known to the intermediary.\no  An intermediary MUST NOT change the fragmentation of any message\n      in the context of a connection where extensions have been\n      negotiated and the intermediary is not aware of the semantics of\n      the negotiated extensions.\nHere is a reference on close traefik bug, just for evidence: 3538\nThank you.\nI think that this can be closed.\n. ",
    "luasenvy": "thank you for reply.\nI just wanted to reuse it without separating it into a function like the DAO in the MVC framework.\nmy curiosity was resolved. so close it :)\n. ",
    "NikitaRadkov": "I think yes. When i write the command:  cat ~/test_message | mail -s 'Test email subject line' -r from_field mymail@example.com\nI get an email. \npostfix/postfix-script: the Postfix mail system is running: PID: 9611\n. ",
    "CERyanKamal": "Thank you Peter, \nYour example works perfect with db.find method but when I try db.query like this\ndb.query('select * from source/inventories.invs').callback(console.log);\nit throws an error of \nTypeError: Cannot read property 'db' of undefined\n    at DBMS.DP.next (C:\\Users\\turbo\\Desktop\\kaizen-system\\node_modules\\dbms\\index.js:223:24)\nThanks for this amazing framework. Yes, Peter \nThis works perfectly as assumed However I will do more testing with some advanced queries to find if this module is perfect enough to suit all our needs and will back to you if anything is wrong. \nThanks for the quick fix and for such an amazing effort you spent developing this piece of cake nodejs framework. . "
}