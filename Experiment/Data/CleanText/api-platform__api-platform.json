{
    "dunglas": "Thank you!\n. Hi,\nThis is a rest of the the Symfony standard edition. \nThe web folder is necessary for storing front controllers.\nWe can discuss about removing robots.txt and favicon.ico (this one must at least be replaced with the API Platform logo) but as crawlers will always request them, your logs will be full of 404 if they aren't present. It's considered best practice to always have those files.\nSolution proposed by @theofidry can be useful for prototype and small apps but the recommended way of using API Platform is having separate git repositories (and servers) for the API and the frontend app.\n. Thank you @aitboudad\n. It seems related to a PHP bug: https://bugs.php.net/bug.php?id=69679\n. Your example should work because the image association refers to ImageObject not to Thing.\n. Yes I'm aware of that warning, however it works. IMO here it's the Doctrine validator command that is faulty. Can you upload somewhere a repo with an example that doesn't work? \n. What was the problem (for future search on the same issue)?\n. Try to reset your database:\napp/console doctrine:database:drop\napp/console doctrine:database:create\napp/console doctrine:schema:create\n. Ok I got it. So you need to override the mapping for each child entity and override the generated class name.\nIMO it's not the responsibility of the generator to handle such cases but any work on this (a patch to Doctrine or a new doc entry) is welcome. \n. After further reading, it looks like a Doctrine Schema generator bug. As Mapped Superclasses are not entities, the generator should name correctly (like names you suggested) the generated tables.\nCan you open an issue on the Doctrine bug tracker?\n. So it seems to work now by overriding the table name in the child class: https://github.com/doctrine/doctrine2/commit/0a09a28ec9301b371da54babb076df84a0d2033f\n. (This component isn't mandatory, you create your model by yourself too).\nCan you post your YAML file and the error you get please?. You probably use 2.2. docker-compose exec php vendor/bin/schema. The docs was outdated, see https://github.com/api-platform/docs/pull/402. Thank you @vincentchalamon \n. Hi @dupuchba and thanks for your proposal! Any help is very welcome and there is a ton of things to do.\nOur focus is currently on ApiBundle, some architecture changes are in progress: https://github.com/dunglas/DunglasApiBundle/issues\nEdit: moved to a dedicated issue\nThe roadmap: #9\nIf you need any help or guidance, feel free to contact me.\n. In fact Doctrine is already decoupled. The remaining work should be limited to tweak composer.json: dunglas/DunglasApiBundle#177\n. I was unclear I think. The goal is to make DunglasApiBundle usable standalone, not to remove examples nor Symfony from the standard edition.\n. I think they are perfectly ok. The default edition must be a way to easily create API for a developer. The idea here is too make libraries usable standalone (without the standard edition in custom projects for advanced needs like DDD or integration in legacy projects).\n. Sorry. I'll edit the issue.\n. There is nothing built in API Platform to handle file upload but VinchUploaderBundle should work as expected. I never tried but if it doesn't work can you give more details about the error.\nFor REST API in general I usually create a special endpoint accepting from/multipart data. An alternative is to add a special field to the posted JSON document containing the file encoded in base64 (less performant but easier to handle especially when dealing with mobile apps and browsers).\nIt would be nice to have native file upload handling in API platform. Any work on this topic is welcome (doc on how to use Symfony features or code to ease \n. Did you try with a controller not handled at all by ApiBundle (a plain old Symfony controller)? You can always access to API Platform services if necessary.\n. It's not an issue IMO. You can register specific actions supporting such formats.\n. Personnaly I've created a controller dealing directly with the Symfony request to get the data from the multipart post request and using the serializer (but not the deserializer) to generate the JSON-LD response content. But base 64 works too.\n. Related Symfony PR: symfony/symfony#16164\n. No, the doc is the missing part and any help on this is very welcome. There is something like a doc for the SF feature however: https://github.com/symfony/symfony/pull/16164\n. > So if I understand well. We can't upload files through Api-platform 2 ? We still have to create our own controller or use base 64 to do that ? And Symfony 3.1 just provide new tools to handle files thanks to DataUriNormalizer ? I think I don't understand something, but I don't know what !\nYes and it will be always like that. base64 works out of the box with API Platform 2. Multipart however isn't JSON-based and require to write a custom controller.\n. @teohhanhui exactly.\n. Thank you @theofidry \n. The current RDFA file provided by Schema.org seems to be buggy.\nAdd the following in the file and it will be ok:\nyaml\nrdfa:\n  - https://raw.githubusercontent.com/schemaorg/schemaorg/sdo-gozer/data/schema.rdfa\nI'll update the doc to prevent such errors while Schema.org has problems.\n. You must use @ApiDoc annotation in your custom controller.\n. Hum sounds logical.\nWhy don't you create specific resources for phones etc? The only solution I can think about is to override the DunglasApiParser (https://github.com/nelmio/NelmioApiDocBundle/blob/master/Parser/DunglasApiParser.php) service of NelmioApiDoc and replace it with a custom one ignoring/doing special things for special operations.\n. Thank you @toofff \n. Can you paste your schema.yml file?\n. A use statement must be added when the namespace of entities is different of the namespace of enums.\n. Closing in favor of the issue in the schema generator repository: api-platform/schema-generator#24\n. Hi,\nYou should rename the generated class but keep the @Iri annotation as is.\n. These file are automatically generated by https://github.com/api-platform/schema-generator. Can you open a PR to fix the generator first then regenerate files?\n. Yes it should. What about using this file: http://schema.org/docs/schema_org_rdfa.html?\n. @sroze Why? AFAIK there is no better alternative out yet.\n. Thanks @blazarecki \n. I don't understand what is the intent of this PR. The database is not created or deleted at each scenario, only on purpose with annotations.\n. Here is an example: https://github.com/dunglas/DunglasApiBundle/blob/1.0/features/crud.feature\n. In fact HATEOAS is supported out of the box by API Platform. By default, all APIs are compliant with JSON-LD and Hydra (W3C recommandations about Linked Data/HATEOAS).\nAdding support for other HATEOAS formats such as HAL or SIREN should be really easy in the dev-master version thanks to Content Negotiation: https://github.com/api-platform/doc/blob/master/api-bundle/content-negotiation.md\nIf someone start to work on supporting such formats, I'll be pleased to merge it upstream.\n. @renan-taranto You want HAL support right? You can do it (yourself) with the dev-master version. You need to implement a Symfony Normalizer implementing HAL support like we've done for JSON-LD: https://github.com/dunglas/DunglasApiBundle/blob/master/JsonLd/Serializer/ItemNormalizer.php\n. Thanks for the report and the fix @mheki \n. It has been renamed /apidoc. The documentation must be updated.\n. Hi,\nit doesn't actually but it can. It's just a matter of implementing the DataProvider interface, an event listener to save hydrated entities and optionally a bridge with the Symfony PropertyInfo component.\nIf you are interested in working on this, you can take a look at how it's done for Doctrine: https://github.com/dunglas/DunglasApiBundle/tree/1.0/Doctrine\n. I don't understand what you're trying to do exactly. Changing line breaks in a JSON document?\n. You mean the value of a textarea encoded in a JSON document or something like that?\n. Yes, the doc of the 1.1 version is already online... It will be fixed soon by the release of this new version.\n. @3KyNoX I reply in english for international readers, tell me if you need a translation.\n- Symfony 2.8 LTS is already supported by all API Platform bundles, just change your composer.json file to 2.8 and run composer update. We'll release a new version (1.1) supporting Symfony 3 as well and we will update this standard edition to default to 2.8 soon. All the work is done, we just wait for some dev dependencies to release new versions compliant with Symfony 2.3 (especially Behat related packages).\n- There are - as you pointed out - the Restangular config. But there also are a tutorial for integrating Angular with API Platform, a working example using Yeoman and an (experimental) ng-admin integration. What would you expect? Something like a yeoman generator with the Restangular config already inside?\n- Not sure to understand well what is you problem with OAuth. You're speaking about APIDoc and FOSRest, you mean API Platform? There is nothing specific in API Platform to support OAuth, but - as it's a pure Symfony app you can easily use FOSOAuthBundle and the security component to secure your API (server-side).\nJust install and configure the bundle then add a config like the following and you're API will be secured using OAuth:\n``` yml\napp/config/security.yml\nsecurity:\n    firewalls:\n        oauth_token:\n            pattern:    ^/oauth/v2/token\n            security:   false\n    oauth_authorize:\n        pattern:    ^/oauth/v2/auth\n        # Add your favorite authentication process here\n\n    api:\n        pattern:    ^/api\n        fos_oauth:  true\n        stateless:  true\n        anonymous:  false # can be omitted as its default value\n\naccess_control:\n    - { path: ^/api, roles: [ IS_AUTHENTICATED_FULLY ] }\n\n```\nThen, it's 100% a standard OAuth. Client-side use any OAuth lib in JS such as hello.js (I don't know this one) or oauth.io (already used it and it's a good one) to authenticate against your API.\n. Basically, you do not need FOSRest when using API Platform (both solutions do the same thing using different ways). You can use API Platform (APIBundle) to expose your FOSUser users. Map you FOSUser User entity like the following and it should be OK server-side: https://api-platform.com/doc/1.0/api-bundle/fosuser-bundle#creating-a-user-entity-with-serialization-groups\nClient-side you can create the profile page like in the angular tutorial I pointed out (the User resource is just a standard resource when using API Platform). For the login screen, you need to do the view using Angular. Server-side, the Symfony Security Component will be used. Maybe can you give a try to https://github.com/sahat/satellizer to handle the login process Angular side.\n. I don't know if it fit your need but we generally recommend to use JWT instead of OAuth (see for instance my talk at SfLive San Francisco: https://dunglas.fr/slides/sf-live-sf-2015/#/)\nJWT implementation using API Platform and Angular is very easy.\n. You don't need Satellizer when using JWT. A simple login form and storing the JWT token in the browser session or local storage is enough.\n. Yes. You just need to send a  POST request with form encoded _username and _password to your Symfony security endpoint. Store the resulting JWT token and include it in all next AJAX requests and you're done.\n. Did you try to add the --force flag as suggested by the error message?\n. The posted JSON value must be a float (and not an int or a string).\nCan you check that you send a float value. If it's ok can you copy your HTTP request here to allow us to debug?\n. @cvernerie can you copy here the HTTP request you sent to the API please?\n. @cvernerie the body of the request is missing.\n. Here is the problem, totalAmount is of type \"foat\" and you send an int. Try this:\n{\"billingDate\":\"2016-08-30T09:33:22.917Z\",\"trader\":\"Restaurant\",\"totalAmount\":240.0}\n. This is indeed a problem. The JSON standard does not differentiate float and int. However JSON Schema and XML (as well as JSON-LD) do make the difference.\nA possible fix is to handle this case especially: automatically cast to float when this type is expected and is_numeric returns true.\nping @api-platform/core-team\n. @cvernerie I've just pushed a patch fixing this, can you test it please? https://github.com/api-platform/core/pull/714\n. @cvernerie can you try with the dev-master version, it should fix the problem.\n. @Shine-neko we should indeed do something for that in Symfony too. It's on my todo list.\n. Still on my todo list but PRs welcome :)\n. API Platform dev-master supports JSON-LD/Hydra as well as raw JSON, XML and any custom format: https://github.com/api-platform/doc/blob/master/api-bundle/content-negotiation.md (be careful, the 2.0 version is not finished yet).\nHydra is a format built on top of JSON-LD, by definition it cannot support other format such as HTML.\n. NelmioApiDoc is not yet compatible with dev-master. Remove NelmioApiDoc and the error it will disappear.\nFor a comparison with other solutions, take a look at my slides from Symfony Live 2015 (in french):  https://dunglas.fr/2015/04/mes-slides-du-symfony-live-2015-a-la-decouverte-de-api-platform/\n. You probably missed to create the XML responder: https://github.com/api-platform/doc/blob/master/api-bundle/content-negotiation.md#creating-a-responder\n. It's a known problem but it doesn't have any impact.\n. Thanks for the report.\nThe upcoming API Platform 1.1 will be compliant with both PHP 7 and and Symfony 3. We are just waiting for https://github.com/minkphp/Mink/issues/685 to be fixed for releasing it.\n. Works now:\ncomposer create-project api-platform/api-platform:dev-master demo\n. It should be possible relatively easily using the Symfony PropertyInfo Component: http://symfony.com/blog/new-in-symfony-2-8-propertyinfo-component\nIf you're interested in working on that, we can create a new project in this org that you can lead.\nAnother way can be to generate back the RDF definition from the YAML file of the schema generator (as it now supports custom properties).\n. To customize the output of the JSON (e.g. add new fields), you can decorate the service called api.json_ld.normalizer.item using service decoration.\nTo change the context, you can use JSON-LD context events.\nBut AFAIK, there is no @value property in JSON-LD.\n. API Platform generates JSON-LD documents in their compacted form (without @value). It should work with Markus lib without any modification server-side. Can you post the failing snippet?\n. :+1: \n. :+1: ping @sroze \n. Isn't it more developer friendly to have a working docker setup just after doing composer create-project api-platform/api-platform?\n. :+1: for the idea but I've left some comments about the implementation.\n. Do you have some time to finish this one?\n. \ud83d\udc4d \n. Fixed by #87.\n. Can we merge this one?\n. (CS should be fixed first).\n. See #59\n. MongoDB isn't supported yet but there is a PR open to add it: api-platform/core#461.\nTests and review on this PR are very welcome!\n. Nice! Can you share you're code (a gist or something like that), it may help some people.\n. Can this bug be close @teohhanhui (Travis is green right now)?\n. So can we merge it?\n. Thank you @teohhanhui \n. The GET operation for items is required because you need to be able to generate IRIs.\n. IRIs used as identifiers should be dereferencables (cool IRIs), it means that the given IRI should be retrievable issuing a GET request.\n. Is it safe for Docker? @sroze @teohhanhui \n. I agree with @teohhanhui, however you can use the firewall to prevent direct access to the address endpoint.\nYou can also try to use https://github.com/dunglas/doctrine-json-odm. It will work out of the box with API Platform v2 but you'll need a custom normalizer if you use the v1.\n. It could be added easily in core. It's a matter of implementing a JSON API serializer.\nIf you want to work on that, I can help you and I'll be pleased to merge it!\n. It is possible to customize the URL format too by creating route loader based on https://github.com/api-platform/core/blob/master/src/Bridge/Symfony/Routing/ApiLoader.php \n. It depends :) If an existing fit our needs and is maintained we can use it, but I doubt such library exists.\n. IMO it will be difficult to make such libraries working with the internal infrastructure of API Platform (metadata and so on). The easiest path is probably creating a normalizer for JSON API (and maybe a route loader).\n. @renz-ken I think JSONAPI support can now be done more easily than before. The HAL implementation is a good example of how JSONAPI can be implemented: https://github.com/api-platform/core/tree/master/src/Hal/Serializer\nI know @Simperfit (the author of the HAL support) has started to think about JSONAPI support but I don't think there is any code yet. Your contribution will be greatly appreciated!\n. Hi @karser,\nFirst of all, thanks for sharing your filter. I'm not familiar with Sphinx (I usually use ElasticSearch) but cant' you query Sphinx to retrieve data without pagination? It will looks cleaner than using 9999.\nWith v1, you can also disable API Platform pagination if you want by creating a custom data provider that return a simple PHP array instead of an instance of PaginatorInterface.\nI hope this help.\n. I removed the composer install command from the Dockerfile because it doesn't work: vendors weren't stored in the image, probably because /app is a volume.\nping @sroze @vincentchalamon \n. No but it replaces #57.\nDifferences are:\n- composer install isn't called at all (because it doesn't work, the my previous comment)\n- port mapping configuration is fixed (at least for Docker for Mac, it wasn't working previously)\n- the image is now tested with Travis\n. It doesn't fail, but it is useless because /app is a mounted volume, so vendors are NOT stored in the image anyway.\n. Immutable images are very interesting for the deployment process. Here this PR has an advantage: it works.\n. We do use a host mounted volume and I consider the Docker setup (Dockerfile + Docker Compose) as whole thing for DX.\nCurrently it doesn't work at all. Run docker-compose up then docker run something and it will crash because vendor are missing. I'm +1 for a more fine grained solution as you suggest but this must be fixed or removed for the v1 release. I'm for merging this PR then improve the docker setup if possible.\n. > This Docker approach is not the ideal one to me at all. The vendor are\n\nbuilt successfully in the Docker image, but obviously have to be installed\nlocally too if you override the image content by mounting the /app\ndirectory using your own local directory.\n\nIt slows down the installation process (vendors are resolved and downloaded 2 times) and this isn't acceptable from a DX POV.\n\nThe port mapping configuration is something installation-specific and\nshouldn't be in the Git repository to me.\n\nThis is mandatory (see @teohhanhui comment).\nMerging for now. Improvement to this are very welcome!\n. Hi @zacrasta, the content must be send as a raw JSON document in the body of the HTTP request, not as x-www-form-urlencoded data.\n. @mbckwa Hi,\n- You can use any Doctrine entity, created \"by hand\" or using the generator doesn't matter\n- If you want to use the generator and add custom fields, you can do it to: https://github.com/api-platform/doc/blob/master/getting-started/api.md#generating-the-data-model (the kevinReview field is a custom one)\n. Possible in v2 using custom operations and documented: https://github.com/api-platform/docs/blob/master/core/operations.md\n. Which version are you using?\n. See https://api-platform.com/docs/core/swagger. This is probably a bug in Doctrine (or Symfony) related to annotation autoloading. You should reopen it on the Doctrine bug tracker.\n. > I'm using Doctrine's command because the options --update-entities=true --generate-methods=true aren't available with Symfony's bin/console.\nIt's probably the problem. Doctrine command may not load properly Symfony annotations (it uses a special autoloading system).\n. Annotations use a special autoloader: http://doctrine-orm.readthedocs.io/projects/doctrine-common/en/latest/reference/annotations.html#registering-annotations\n. The doc has been updated now: https://github.com/api-platform/doc/blob/master/core/serialization-groups-and-relations.md\n. @napalm33700 can you confirm that this bug is fixed?\n. ping @theofidry \n. I was reluctant to add the fixture bundle in the standard edition but I think that it's definitely not the place to add things like custom Faker generators.\nHowever it can be added in the demo (the app illustrating the getting started guide) if anybody care.\n. Can't you use a custom denormalizer to do that?\n. I'm 100% sharing this point of view. I've not already done it because LexikJwtAuthenticationBundle requires the OpenSSL command to be available in the path, but it can be worked around by accepting to store the security key as a string (a Symfony parameter) instead of as a path to a file.\nBtw it will make LexikJwtAuthenticationBundle easier to use on PaS relying on environment variables (like Heroku). \n. For the initial setup (for the standard edition): https://github.com/lexik/LexikJWTAuthenticationBundle/blob/master/Resources/doc/index.md#installation\nThis is indeed not mandatory at runtime.\n. Thanks @Quentin80!\n. Any update about this PR?\n. Note: I exclude design considerations from the first part of this answer.\nTo port your old code to v2, I would still use a custom controller for doing this. You can read the updated doc for custom controllers here https://github.com/api-platform/docs/blob/master/core/operations.md\nIt should be easy to do, and I would appreciate feedback.\nFrom a design point a view, I mostly agree with @theohhanhui, however sometimes it is necessary to add such services endpoints to improve the performance of the entire app.\nIn API Platform v2.1, I would like to add support for a native batching system based on the OData batch processing specification: http://www.odata.org/documentation/odata-version-3-0/batch-processing/\nThis is, IMO, a smart low level solution in the spirit of REST. Basically, you can send serveral HTTP requests in one by including them as form/multipart.\nI've started working on a POC using Symfony subrequests and it looks easy to do. The main missing feature is a way to convert a raw text HTTP request (the subrequests contained in the main request) into a HttpFoundation's Request instance. Symfony uses PHP super-globals a to create Request objects and AFAIK there is no (userland) way to create super-global-like arrays from a raw request in PHP. I'm working on a HTTP request parser creating Symfony's Request  instances but I've no time to finish it yet. I hope it will be ready for inclusion in Symfony 3.2.\n. OData Batch Processing is a layer on top of REST. It's just a technical trick to improve performance while carrying 100% REST requests. It's a kind of HTTP/2 layer on top of the good all HTTP to minimize the network cost. Anyway, it will be 100% optional. \n. @OCoulonAckwa for my newer projects I simply use React/Redux with fetch.\n. Btw are you sure that Restangular is dead? The last commit is from June (no very old).\n. It uses the Doctrine Inflector library to do so: https://github.com/doctrine/inflector\n. I would be to add an option to configure the default.\nUsing paths instead of URLs have some advantages too:\n- It's easier to deal with path than full URLs client side (and especially when using not intended to deal with hypermedia APIs like Restangular or ng-admin).\n- It reduces the size of responses (performances)\n- It's easier to read for developers (especially those not used to hypermedia APIs).\nAdding a config flag can be done easily in the Configuration class.\n. Thanks!!\n. It's indeed a weird behavior, thanks for reporting it.\nWe have 2 possible fixes for this case:\n- throw an error in this specific case\n- ignore the @id key and create a new resource\nI'm in favor of the first one.\n. Thanks!\n. As recommended by the OWASP, it's now mandatory to add a Content-Type header when you send a request body. Can you confirm that the following test passes?\n```\nFeature: API Website\n  I need to be able to retrieve, create, update and delete websites trough the API.\nScenario: Create a valid website\n    When I add \"Content-Type\" header equal to \"application/ld+json\"\n    And I send a \"POST\" request to \"/api/v1/websites\" with body:\n    \"\"\"\n    {\"protocol\":\"https\",\"domain\":\"mydomain.com\",\"status\":\"1\"}\n    \"\"\"\n    Then the response status code should be 201\n    And the response should be in JSON\n    And the header \"Content-Type\" should be equal to \"application/ld+json\"\n    And the JSON should be equal to:\n    \"\"\"\n    {\n      \"@context\": \"\\/app_test.php\\/api\\/v1\\/contexts\\/Website\",\n      \"@id\": \"\\/app_test.php\\/api\\/v1\\/websites\\/1\",\n      \"@type\": \"Website\",\n      \"protocol\": \"https\",\n      \"domain\": \"mydomain.com\",\n      \"status\": \"1\",\n      \"pages\": []\n    }\n    \"\"\"\n``\n. Thanks @teohhanhui \n. @sschueller see https://github.com/api-platform/core/issues/739 (help welcome, it's an easy pick). During the meantime, if you don't want to use annotations, you can also create a custom implementation of thePropertyMetadataFactoryInterfaceto set the identifier field to true.\n. Thank you @amenophis \n. @teohhanhui I'm not sure to understand what you mean. For now we are using the first GET route registered for a given resource to generate the IRI. It means than before the patch of @amenophis, when you add a custom action, its route becomes the route used to generate the IRI. It doesn't look like a good default.\n. @teohhanhui yes. But both are not incompatible. It would be nice to have a new option to set the route to use for IRI generation. During the meantime (and even after) this patch doesn't hurt, it improves the DX easily.\n. IIRC it's the order of Symfony routes that matters. IMO It's not a bug, but the DX will definitely be improved if we have a flag to mark the main route instead.\n. No,#Airportis an anchor in the current document. It refers to the definition of theAirport` element in the same file. Can you copy the whole Hydra doc? \n. > I'm just replacing every '#' with '#:'\nWhy do you do that?\njsonld.js works well with API Platform, take a look at my admin POC for instance: https://github.com/api-platform/admin/blob/master/admin.js\n. Good catch, the range should be http://schema.org/Airport, not #Airport. I think that the problem is here: https://github.com/symfony/symfony/commit/62d28f9204870a4c258637686bb50fd9f372e3b3#diff-7a8fb8072d57f95ea6e37898b05895bc\nA test to see if an IRI is defined for this resource is missing. Do you think that you can open a PR to fix that? If it's not the case I'll do it ASAP but it (probably the next week).\n. I don't really get why blank nodes are a problem.\nOur implementation is inspired of the output of https://github.com/lanthaler/HydraBundle and works well with Hydra console (https://github.com/lanthaler/HydraConsole).\nMaybe the Hydra mailing list is a better place to discuss that?\n/cc @lanthaler\n. Good catch, thanks!\n. There already is an annotation for that: @ApiProperty(identifier=true)\n. Yes @ppounder the annotation loader has a higher priority.\nI hope you're doing well.\n. @jayesbe it doesn't imply that. We don't have to support the lower version supported by one of our dependencies. PHP 5.3 isn't officially supported anymore by the PHP maintainers (in fact, only PHP 5.6 and 7.0 are still supported: http://php.net/supported-versions.php), we never supported 5.3 and we will not do that.\nIt's time to upgrade to PHP 7. The end of life of PHP 5 is planned for December 31.\n. @jayesbe yes, patches are welcome to add support to PHP 7 to the 1.1 branch (it should not be a difficult work IMO).\n. However, using API Platform 1 for new projects is strongly discouraged.\n. It looks like a bug. @meyerbaptiste can you take a look at this one?\n. Probably this week.\n. Take a look at https://github.com/api-platform/core/blob/master/CHANGELOG.md and https://dunglas.fr/2016/05/the-first-alpha-of-api-platform-2-0-is-available/.\n. Maybe it's not clear enough in docs, but you must not use composer create-project directly if you want to use Docker. Download the zip and run docker-compose up OR use composer create-project.\n. Hi, are you using v1 or v2?\nI've no code I can share right now but the idea is the same for all versions: create a custom data provider that queries ES and returns a PHP entity (item) or an array of PHP entities (collection) that will be serialized by API Platform: https://api-platform.com/docs/core/data-providers\nUsually, I use FOSElasticaBundle in this custom data provider. It allows to reuse Doctrine entities and automatically updates index when an entity is modified.\n. You need to install the v2 for PHP7:\ncomposer create-project api-platform/api-platform=v2.0.0-rc.4 api-platform\n. Yes we're in the process of releasing the v2.0.0 stable. And thanks for your feedback!\n. There is a pending PR for MongoDB support: https://github.com/api-platform/core/pull/461\nThe implementation works but it needs review and more tests. Any help welcome! /cc @samvdb @Simperfit \n. Do you have installed and registered the bundle in the kernel? Can you try to clear the cache?\n. It should work with no entities but I'm not very sure. Can you try to map one? If it doesn't work, can you give me access to a repo with the source code (even a private one) to try to debug? It should work with no other bundle.\n. @Aerendir just add dunglas@gmail.com\n. @sroze @teohhanhui can you take a look at this one?\nAs the current Apache setup is working pretty well, I propose to wait after the release of the 2.0 to merge this PR (it will be included in API Platform 2.1).\n. Hi @jockos, @teohhanhui,\nWhat do you think about using PHP PM instead of PHP FPM in this Docker setup? It increases the performance of API Platform 10 times (according to my tests).\n. @jockos can you rebase please? It's ready to be merged?. We also need to tweak the php.ini file (http://symfony.com/doc/current/performance.html):\nini\nopcache.max_accelerated_files = 20000\nrealpath_cache_size=4096K\nrealpath_cache_ttl=600. > If we use alpine for nginx, we should use it for php-fpm too\nAlpine isn't compatible with some extensions yet including Blackfire (but a version supporting Alpine will be released soon). Maybe can we switch to Alpine anyway but add a comment to make it explicit that some extensions aren't compatible with it and some instructions to switch to Debian.. Travis is not happy @jockos . @Gormador not related but can you share the other reasons? We're interested in this kind of feedback. Thanks.. Thanks for the feedback. Indeed switching the \"server\" part to use Mongo or Firebase directly can be a good solution in some cases.. Thank you very much @jockos @teohhanhui @soyuka!. Can you try http://localhost/app_dev.php?\nIf it works, clear the cache: bin/console c:c -e=prod\n. I do not use Windows either. It would be nice if someone using Windows can confirm that our Docker setup is working out of the box.\nIf some extra steps are needed, we should add them to our docs or try to add out of the box support if possible.\n. As this is run in the Docker context, Unix tools are available. I think it's a good solution.\n. @Simperfit, can you finish this PR please. It's too late to merge #162 in 2.0. Changes are too big. The current setup is stable and tested. We'll move to nginx in 2.1.\nThanks.\n. Thank you @Simperfit \n. you shouldn't be running docker-compose as root.\n. Thanks @Simperfit \n. It's not an error related to API Platform. It's obviously a network issue on your side (a firewall is probably blocking access to debian.org's subdomain from your network).\nCan you retry from a connection without firewall or proxy?\n. @abysKri Please open a new issue if you're sure that it's a bug as it doesn't look related with this one, and paste the detailed stack trace. Also, if you're not sure that's a bug and want help, please try StackOverflow or the Slack channel first.. We marked this class as internal because its API may still change. There is no BC promise for this class for now.\nYou can either:\n\nUse it but be aware that it can change in future versions\nCopy its logic in your own listener (or create your own utility class). Do you use the YAML mapping format? Can you post the whole entity code?. No, it's not. Can you post enough code and config to reproduce the bug?. @soyuka we should join only if Doctrine knows $resourceClass (in the other case, it can be a VO or anything else). Can you provide a hotfix before the stable release?. You can inject the request_stack service in your data provider class.. You can also disable force_eager only for the entity having a lot of joins: https://api-platform.com/docs/core/performance#override-at-resource-and-operation-level. Can you try this:\n\nphp\n/**\n * @ApiResource(shortName=\"FooBar\")\n * @ORM\\Entity\n * @ORM\\Table(name=\"doesntreallymatter\")\n */\nclass Blurb\n{\n    // ...\n}. You can inject the api_platform.metadata.resource.metadata_factory service in your provider and copy take inspiration from this method: https://github.com/api-platform/core/blob/master/src/Bridge/Doctrine/Orm/Extension/PaginationExtension.php#L112-L122. Can you paste your YAML file please?. @renan-taranto indeed, everything is supported in the code but the doc must be polished. Help welcome on this topic :)\nGood catch regarding activation. However the core bundle should do it by itself: https://github.com/api-platform/core/blob/master/src/Bridge/Symfony/Bundle/DependencyInjection/ApiPlatformExtension.php#L41-L43\nCan you please try to remove this line to see if it breaks your app? In this case, it's probably a bug.. @diimpp Both Symfony and API Platform docs are open source, do you think you can open a PR about this?. Serializer mappings are also documented: https://symfony.com/doc/current/components/serializer.html#component-serializer-attributes-groups-annotations\nClick on the \"YAML\" tab.. Got it. Would you mind a Symfony docs PR? It will help a lot of people.\nLe ven. 20 juil. 2018 \u00e0 17:54, Dmitri Perunov notifications@github.com a\n\u00e9crit :\n\n@dunglas https://github.com/dunglas I think we're talking about\ndifferent things.\nFollow this url and should clear what I'm talking about. #184 (comment)\nhttps://github.com/api-platform/api-platform/issues/184#issuecomment-334961642\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/api-platform/api-platform/issues/184#issuecomment-406643506,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AADfiIRVZHJQiO8ii3JJmxmVEScADvnwks5uIf1IgaJpZM4K7t1H\n.\n\n\n-- \nK\u00e9vin Dunglas\nhttps://dunglas.fr\nTwitter: @dunglas https://twitter.com/dunglas\nPhone: +33 6 60 91 20 20\n. One solution can be to use XML or YAML mapping file instead of annotations.\nAnother solution is to decorate the api_platform.swagger.normalizer.documentation service to modify the array directly in PHP.. Closing as it should no be installed with Flex. (will be part of the demo). I never tried it but it should already work without needing to modify the bundle. A class implementing the EncoderInterface of the serializer passing the normalized array to a Twig template (by injecting the twig service in the encoder) should do the trick.. @teohhanhui I totally agree, but it's okish in a private app or in a separate community bundle.. But #162 will be only for 2.1. We need to fix the Apache for 2.0 anyway.. @teohhanhui this is not an option, we must release bug (like this one) and security fixes before the release of 2.1.. Yes we are.. I've started to add this feature in the Symfony Serializer but it's not finished yet (see comments): https://github.com/symfony/symfony/pull/18834\nAny help welcome :). By the way, it can be also be easily added by decorating the api_platform.jsonld.normalizer.item service and unsetting fields you don't want.\nYou can directly inject the request_stack service in this decorator to access the fields query parameter ; but it's not clean, I recommend to set a new key in the serialization context to do that: https://api-platform.com/docs/core/serialization-groups-and-relations#changing-the-serialization-context-dynamically.. @ad3n, @Simperfit is right, you should use custom data providers to do that. It can return an array of static data.. Thanks for fixing this @renan-taranto . ping @Simperfit . composer update is not required. Can you elaborate a bit more? Why do you need to run this command?. I think it will be ok. I just need to find some time to dive into this issue.. Closing now that api-platform/core#938 is merged, we also have a doc regarding the serializer callback: https://api-platform.com/docs/core/serialization-groups-and-relations#changing-the-serialization-context-dynamically. @krismas thanks for your contribution, can you rebase against 2.0 please as this is a bug fix (I've already changed the target branch in the PR for you).. Yes it's possible using serialization groups: https://api-platform.com/docs/core/serialization-groups-and-relations#embedding-relations. Thanks @krismas . Thanks @krismas . This problem doesn't look related to API Platform but to Symfony.\nDoes hardcoding the host fix the problem?\nyaml\nbricks_infrastructure_core_api_platform:\n  resource: '.'\n  host: 'api.platform.bricks.localhost.com'\n  type: 'api_platform'\n  prefix: '/bricks/api/rest'\nYou can also use directly use the parameter instead of relying on defaults:\nyaml\nbricks_infrastructure_core_api_platform:\n  resource: '.'\n  host: '%bricks_api_host%'\n  type: 'api_platform'\n  prefix: '/bricks/api/rest'\n. Can you review #215?\nAbout COMPOSE_CONVERT_WINDOWS_PATHS, I'm not fond of versioning a .env file (especially because Symfony will also use .env files starting to 3.3). Do you know an alternative solution? Maybe mentioning this in the documentation will be enough?. Doc PR opened: https://github.com/api-platform/docs/pull/172. We want to keep as close as possible of the Symfony Standard Edition (and we'll probably switch to Symfony Flex when it will be out) and Symfony hardcode the driver to use: https://github.com/symfony/symfony-standard/blob/master/app/config/config.yml#L45\nIf you feel that it should be changed, please open an issue on Symfony.. Take a look at this discussion to understand why database_driver isn't in parameters.yml anymore: https://github.com/symfony/symfony-standard/pull/776#discussion-diff-23593282. See also https://github.com/api-platform/docs/pull/172. What do you mean by i18n layer?\nYou can easily integrates solution like Atlantic18/DoctrineExtensions in API Platform to manage different versions of data. There is also the Symfony Translation component included to translate texts / errors and so on.. If you are registering an item operation, you need to add {id} in the route name. Then you can retrieve the current data using $request->attributes->get('data').. Because if you are working with an item (item operation), you need to tell API Platform how to retrieve the data.\nIt's not mandatory if you use collection operations.. Can you explain what you try to achieve? Why do you want to create a custom operation instead of using events?. Wouldn't be better to run the composer install with the apache user instead of doing this?. @Stoakes because we use volumes for dev, and we cannot change the owner of files mounted as a volume.. @soyuka are you using Linux or Mac? . Yes but with our trick we doesn't need to set the uid.. @soyuka it's very important for the first impression to have something working out of the box, without requiring any weird config, even for people not confortable with Docker.. @soyuka as we're in the process of merging #162 who's already using FPM, can you push commits (or comment) in this branch instead?. But there is no staging env by default (only test, dev and prod AFAIK). If an user add such env, it's its responsibility to update the script (and usually a bad idea to have a \"staging\" env, it should just use \"prod\").. Do you use PHP 7+?. It's possible by overriding services definition. To change the manager registry to use for write, use the following definition:\n```yaml\napp/config/services.yml\napi_platform.doctrine.listener.view.write:\n    class: ApiPlatform\\Core\\Bridge\\Doctrine\\EventListener\\WriteListener\n    arguments: ['@my_write_manager_registry']\n    tags:\n        - { name: kernel.event_listener, event: kernel.view, method: onKernelView, priority: 32 }\n``\n. After a second, though, not sure it can work without creating a custom implementation of theManagerRegistryinterface returning the good connection because we usegetManagerForClass. This can probably be improved.. You can decorate the default one.. I suggest to keep the currentdoctrineservice as is and create new one calleddoctrine_write` using the decorated registry.\nThen override the write listener definition like the following:\n```yaml\napp/config/services.yml\napi_platform.doctrine.listener.view.write:\n    class: ApiPlatform\\Core\\Bridge\\Doctrine\\EventListener\\WriteListener\n    arguments: ['@doctrine_write']\n    tags:\n        - { name: kernel.event_listener, event: kernel.view, method: onKernelView, priority: 32 }\n```\nCan you confirm that it works? If it's the case I'll add a page in the documentation about how to do that.. It looks like a bug in the Swagger generator. Ping @Simperfit . @jordicaballero https://github.com/api-platform/core/pull/909 does exactly that. This patch will be included in API Platform 2.1. Can you confirm it fits to your use case?. There are some minimal examples here: https://api-platform.com/docs/core/data-providers\nEnhancing this doc would be very appreciated \ud83d\ude42: https://github.com/api-platform/docs. Not sure to get what you mean.. Builtin filters are a Doctrine feature.\nHowever docs generation (including custom filters) and all other features will work as long as the PHPDoc is present.. Just remove all ORM annotations from the Foo entity, and return instances of this class form your custom data providers as explained in the doc.\nIt's now the responsibility of your providers to hydrate and return instances of Foo. API Platform will still be able to deal with them thanks to the @ApiResource annotation.. Can we close this one?. Just register a kernel listener like we do for Doctrine!\n\nThe Doctrine event (just create a new class containing your own persistence logic): https://github.com/api-platform/core/blob/master/src/Bridge/Doctrine/EventListener/WriteListener.php\nThe service definition: https://github.com/api-platform/core/blob/f21b1658d11bbca432ca0a6a8c995262064b382c/src/Bridge/Symfony/Bundle/Resources/config/doctrine_orm.xml#L100-L104. Yes, adding GraphQL support is definitely something we want to bring in API Platform. I've spent some time to study existing GraphQL libraries and it should be possible to integrate https://github.com/webonyx/graphql-php in API Platform.\n\nAny help on this topic is welcome!. Great to ear! Here are some basic hints:\n\nAPI Platform's metadata (ResourceMetadataFactory/PropertyMetadataFactory) contain almost everything needed to create GraphQL types (ObjectType). Create a bridge using https://github.com/webonyx/graphql-php to automatically generate GraphQL types using our metadata objects (enums will be a problem but I think they can be ignored in a POC).\nUse the API Platform's DataProvider interfaces in Webonyx's implementor (resolve) to hydrate GraphQL structures (maybe we'll need to also use the Symfony serializer at this point) \nCreate a specific endpoint (basically a new Symfony controller accepting GraphQL requests) and execute the Webonyx library in it\n. @fbourigault and @raoulclais are working on a POC.. I agree with @Simperfit, however we can promote this bundle on the website and in the doc (we should do it for Rollerworks Search and the rate limiting bundle too).. Can you provide the full stack trace. I don't get the exact problem (the Link HTTP header is expected).. php\npublic function assertIsLDJsonResponse(Response $response)\n{\n        $this->assertTrue(\n            $response->headers->contains('Content-Type', 'application/ld+json'),\n            $response->headers\n        );\n}\n\nThis assertion is weird. It should be something like $this->assertEquals('application/ld+json', $response->headers->get('Content-Type'));. Ok got it. You have forgotten to set the proper Accept: application/ld+json header and your testing tool set automatically this header if it isn't present to test/html, then you get the docs.\nSetting the Accept header explicitly should fix the problem. . It is. But if you (or the testing tool) send a header, it is used in priority (it's the normal behavior). The problem is: the testing tool should not set the Accept header implicitly like that.. Yes: https://api-platform.com/docs/core/content-negotiation#enabling-several-formats\nThis first format will be the default one.. Closing as won't fix.. It can still be done by implementing a custom path resolver: https://github.com/api-platform/core/blob/master/src/Bridge/Symfony/Routing/ApiLoader.php#L190. AFAIU, API Platform is not involved at all here. It's probably a FOSUser or a Symfony issue. Feel free to reopen if I misunderstand.. Are you sure about your patch? Nginx logs are in the NGINX container, not in the PHP one. However maybe can we send Symfony logs to stderr.. Requires api-platform/core#1156. Thanks @rawkode . Sorry I missed your review. We can still revert.. But your review doesn't appear.. @rawkode your contribution is really appreciated, don't worry! We'll keep your PR, we may made some changes to keep in sync with our CS.. @teohhanhui would you mind making a follow up PR with your suggested changes?. You can easily use API Platform in plain JSON. It's even enabled by default (just append .json to URLs or send application/json in the Accept header).\nRegarding plain old ids, it is possible by replacing the item normalizer but it's not supported by default.. @J4VMC see https://github.com/api-platform/core/pull/2022#issuecomment-398851861 for the current status. Help on this topic will be very welcome.. It's actually intended for simple_array (it's an array of strings: a CSV) but it should work for json_array according to https://github.com/symfony/symfony/blob/master/src/Symfony/Bridge/Doctrine/PropertyInfo/DoctrineExtractor.php#L126-L127\nCan you post the code of your entities (or publish a sample repository)?. However you can use event listeners to only return a \"No content\" response for this URI.. Thanks @teohhanhui . Thanks @teohhanhui . This is because of a GitHub bug: the link to download the latest release is broken. It downloads master instead of the latest tag. I've just updated the website to use the new link.\nYou probably have the master version instead of a 2.0.x. Sorry about that, you should downgrade to the laster v2.. Oops I used the bad link...\nCan you start from a fresh download? The error is weird.. I've just tried with the latest version and I'm not able to reproduce. Do you have a slow network? It looks like a network issue.\nWhat OS and Docker version do you use?. I've no Windows box with me... I'll not be able to help. @jockos, @api-platform/core-team any idea?. The new setup in master is not released yet, it's why the doc hasn't been updated. But glad to here that the new one works on Windows too :). Btw, you can use the new setup while just downgrading to stable api-platform/core.. Can you try if https://github.com/dunglas/doctrine-json-odm/pull/16 fix your issue please?\nAnyway, closing this issue because it's not related at all with API Platform.. Can you try to clear the cache ?. OAuth support is available tru FosOAuthServer and is being documented here: https://github.com/api-platform/docs/pull/182\nAny help on this in very welcome!. Anyway it should not impact the routing. Can you paste the error?. Can you try to remove the cache using rm -Rf var/cache/*?\nWhy do you need a custom api_platform.iri_converter service?. AFAIK, it's not something allowed by the Hydra spec. You may ask directly the Hydra Community Group (I'm also interested by the rationale behind this decision, if you get an answer, please post it here).. There is no limit. The null value is probably a sign that it's an ORM related problem (the relations are probably not fetched).. Thanks for the feedback @blaues0cke!. Because it maps the name of the property generated in /, and by convention it should be lowerCamelCased.. You can use service decoration to decorate the api_platform.hydra.normalizer.entrypoint service and change the output.\nBut I think it's better to document available resources and throw a 401/403 status code if the user must authenticate.. Those changes look interesting, but as pointed out by @teohhanhui and @soyuka, why not proposing those changes to the upstream official Docker image?. Can you post the code? I didn't get it.. Ok got it. Definitely a bug.. Here we consider that DunglasActionBundle is installed (the default when using the API Platform distribution). this part is not true anymore (the end is still accurate).. Fixed in 2.1 and in docs.. You can use a Swagger decorator: https://api-platform.com/docs/core/swagger#override-swagger-documentation. You can use the 2.1-dev version, it has built-in support for this feature: https://github.com/api-platform/core/pull/982. The doc on the website is about the current stable version (2.0). The container has been renamed php only in the dev version (the upcoming 2.1 version).. Closed in favor of #308 . Thanks @glanchow . Thanks @teohhanhui . Apache? Which version do you use? Apache isn't provided with API Platform (we use Nginx).\nAnyway your problem doesn't look related with Postgres.. It's a well known Symfony issue that will be fixed in the next Doctrine version.\nIn the meantime, you can set the server_version parameter of the DoctrineBundle to avoid this call.. It's a known issue with the online Swagger validator... But the generated Swagger file is valid.. What about #289 instead?. It will be more work ;) Can you review #289 instead, I'll add missing parts :) We need this for the upcoming beta of 2.1!. Thank you very much @teohhanhui . So you may just use the standard search filter: https://api-platform.com/docs/core/filters#search-filter. @todor-programista Does https://github.com/api-platform/docs/pull/186 help?. It's may also be related to how the format negotiation is handled: https://github.com/api-platform/core/blob/master/src/EventListener/AddFormatListener.php\nCan you provide an example reproducing the problem (an minimal repository for instance)?. It should work out of the box without config. There is something weird here. It would be nice to have a way to test and debug :). @dmeziere we can talk in the #french or #api-platform channel of the Symfony's Slack: http://symfony.com/slack-invite. And do you think you'll be able to create a MVCE without including the secret elements?. Thank you very much @teohhanhui!. Fixed \ud83d\udcaf . I'm not sure about the approach, maybe it would be better to version all files generated by Flex as well. This way it would not degrade the current developper experience while allowing to use Flex to install packages.. Yes, the spirit of Flex is to have a minimal repository (like symfony/skeleton) that the user can use without removing anything. But maybe can we start with a heavier setup as API Platform can already be installed easily with the minimal Flex :)\nWe can have 2 entrypoints:\n\nBattery-included: download http://github.com/api-platform/api-platform and type docker-compose up\nMinimal: composer create-project symfony/skeleton app && cd app && composer req api\n\nWDYT?. api is an official Flex alias of api-platform/api-pack: https://github.com/api-platform/api-pack. Closing in favor of #422.. Looks good to me (but I still don't get the point of specifying the minor version of the docker compose format). Waiting for @teohhanhui's approval before merging.. Can you rebase please @akira28? Can you also update the version field to 3.3? . After double checking, most examples on docker.com use versino: '3'. We should continue using this.. @teohhanhui I'm refactoring images for Flex. It's almost ready (https://github.com/dunglas/symfony-docker-skeleton/pull/5 if you want to take a look). I agree it has no benefit to split the project.. Do you use the Varnish cache @indapublic?. There is probably a cache layer somewhere.. You need to create custom operations (https://api-platform.com/docs/core/operations#creating-custom-operations-and-controllers).\nBut it's generally considered a bad practice to have such stateful-like URLs. You need to be extremely careful with all HTTP cache layers. It's generally preferred to build URLs like /token/<the-user-id> to have a unique URL per user.. Thanks for sharing @Sybio! It would be nice to add this snippet in the docs as its a common request (we can add a warning explaining that its not recommended).. Thanks a lot!. Use a service decorator (https://symfony.com/doc/current/service_container/service_decoration.html) to decorate the HAL item normalizer.\nWe really need to add a doc entry about that.. It's a plain old Twig template, you can override it: http://symfony.com/doc/current/templating/overriding.html. The warning (PHP Warning: Module 'apcu' already loaded in Unknown on line 0)  is due to your PHP install, not to API Platform (your probably have the same input when you type php -v). But it should not prevent the installation to work.\nThe deprecation notice is just a warning, not an error (it should not prevent to install the project). It has been fixed in API Platform 2.1 (actually in beta): composer create-project api-platform/api-platform:^2.1@beta to try it.\nBefore running php bin/console doctrine:database:create, did you changed to the newly created directory (bookshop-api in your case`)?\ncd bookshop-api\nphp bin/console d:d:c\n\nBut why don't you use Docker instead? (just download the project and type docker-compose up).\n. Can you tell me which PHP version you use btw?. It's weird to have a setter for an ID that is generated externally. I'm not sure to get what you try to achieve.. @akadlec I agree on that, but in this case you shouldn't have this line @ORM\\CustomIdGenerator(class=\"Ramsey\\Uuid\\Doctrine\\UuidGenerator\").. Done in https://github.com/api-platform/core/pull/1202.. Thanks @cve . Travis has upgraded its Ubuntu images and our test suite was broken. Removing specific versions actually fixes it. We should let Travis do its best when possible (here, its possible). I suggest to keep it as is to prevent breakages when Travis upgrade its setup.. See https://travis-ci.org/api-platform/api-platform/builds/249307547?utm_source=github_status&utm_medium=notification for instance.. You need to validate the data before passing them to the database layer (same as when you use Symfony with the Form component for instance): https://api-platform.com/docs/core/validation\nHere, you probably want to use a UniqueEntity constraint. If you add it, you'll get a 400 error and a nice error message instead.. I use this snippet:\nyaml\n    access_control:\n        - { path: (?:^/$)|(?:^/docs)|(?:^/contexts/), roles: IS_AUTHENTICATED_ANONYMOUSLY }. you need anonymous: true in the api firewall and to adapt the regex like this: (?:^/api/$)|(?:^/api/docs)|(?:^api/contexts/). It's done, it just need a documentation: https://dunglas.fr/2017/06/api-platform-2-1-feature-walkthrough-create-blazing-fast-hypermedia-apis-generate-js-apps/ (\"New Filters\" section)?. I think he talks about the schema generator.. Thanks for answering this @Tim59!. Isn't https://github.com/api-platform/api-platform/blob/master/.gitattributes#L2 supposed to prevent this?. @redecs thanks for working on this. If you're in a rush, you can hire @coopTilleuls (or a freelancer) to add this feature.. See https://api-platform.com/docs/core/swagger. Closing as documented?. Thanks!. Yes. The new version is already integrated in 2.1 beta. The stable release will be marked the next week, when I'll be back from vacation.. Thanks for answering this @devrck!. You can disable it through the config:\n```yml\napp/config/config.yml\napi_platform:\n  enable_swagger_ui: false\n```. Closed as documented. Closing as documented.. Would you mind opening a PR? If the test suite pass, we're all good to upgrade :). This has been fixed in Symfony: https://github.com/symfony/symfony/pull/23848\nUsing 3.3@dev until a new patch version of Symfony is released should do the trick. Closing for now.. Take a look to https://api-platform.com/docs/core/serialization-groups-and-relations. Probably a cache issue. Closing for now. Feel free to reopen if you have more information.. React is a soft dependency of the framework. If you don't use it, you're definitely not affected by its licence. 3 components use it:\n\nThe version of Swagger UI included in 2.1 (the one in 2.0 isn't affected). Maybe should we not ship this tool by default until the license problem is solved.\nThe SPA generator. I don't think that this generator is affected because it doesn't ship react directly (we are in the process of adding support of other frameworks such as Angular in this tool).\nThe admin component. For this one it's more complicated and honestly I don't know. We depend of Admin On Rest and AOR uses React.\nMaybe @fzaninotto has a hint? But you can use API Platform without this component.. Regarding Preact, if it works and has a better license, we should definitely switch (and let the user switch back to React if he wants to).. Preact is not a solution. preact-compat depends of facebook/prop-types. Prop-types has the same license than React.. Great :)\n\nSwagger UI also use a bunch of other deps under the same license: https://github.com/swagger-api/swagger-ui/blob/master/package.json#L55-L58\nDo you know if it's possible to replace them @developit?. @fzaninotto I agree with your last sentence, but it can be a barrier to adoption.. @mickaelandrieu it's not true: Facebook made it clear that you can license your project under the MIT license even if it has a dependency to React:\n\nAs has always been the case, source code licensed under the Facebook BSD + Patents license can be combined with source code licensed under other open source licenses like BSD, MIT, Apache 2.0, and GPL. Additionally, as has always been the case, you may distribute BSD + Patents licensed code with other popular open source licenses, such as BSD, MIT, Apache 2.0, and GPL. \n\nhttps://code.facebook.com/posts/112130496157735/explaining-react-s-license/. The issue is definitely gone: https://code.facebook.com/posts/300798627056246/relicensing-react-jest-flow-and-immutable-js/. Thanks @meyerbaptiste . @martinharder would you mind adding this to the documentation (https://github.com/api-platform/docs/edit/2.3/core/operations.md)? I'm sure it will help a lot of people!. Seriously don't use FOSUser anymore. Creating custom auth systems is so easy now (with http://symfony.com/doc/current/security/entity_provider.html and Guard) and extending FOSuser is a pain...\nWriting a doc entry explaining how to create an auth system from A to Z is on my long todo list.. See also https://github.com/api-platform/core/pull/1360. See #421 for updates.. @reminec can you paste your service definition?. Thanks for the repo. I can reproduce the problem. There is an issue with the default DI we ship.. The autoconfigure feature seems to introduce weird edge cases. Here is a quick fix:\nyaml\n    'AppBundle\\Swagger\\SwaggerDecorator':\n        decorates: 'api_platform.swagger.normalizer.documentation'\n        arguments: [ '@AppBundle\\Swagger\\SwaggerDecorator.inner' ]\n        autoconfigure: false\nI'll try to find the underlying cause.\n. @reminec I've update my workaround with a simpler implementation.. This has been fixed upstream in Symfony.. You need to install openssl in the container. For instance you can add it here: https://github.com/api-platform/api-platform/blob/master/Dockerfile#L6. It is worth mentioning it in the docs btw. A pr against the 2.1 branch of the docs would be very welcome.. Can you target 2.1 please?. Thanks @soyuka . Closing as duplicate of #421. (the problem isn't Symfony, it must be investigated). Symfony 3.3 is compatbile with PHP 5.4+. The problem is elsewhere: https://github.com/symfony/symfony/blob/3.3/composer.json#L19. (And yes, we're still committed to support 7.0 for now). Btw core 2.1 is definitely compatible with 7.0: https://travis-ci.org/api-platform/core (tests are green on 7.0).\nThe problem should be in the dependencies of the standard edition.. Good catch I totally forgot about that. There is a quick fix: allow both schema-generator 1 and 2.. Fixed by #431.. Helm chart added in 7cb72967c01853395aa3dd43b34ef88ce19436a9.. @Saphyel, I don't think so... the provided setup relies on Nginx.. Take a look to the builtin ones:\n\nhttps://github.com/api-platform/core/blob/master/src/Bridge/Doctrine/Orm/ItemDataProvider.php\nhttps://github.com/api-platform/core/blob/master/src/Bridge/Doctrine/Orm/CollectionDataProvider.php\n\nYou can start by copy/paste/edit them.. We must add new aliases, not rename the existing ones or it would be a BC break.. Thanks @jenaye.. Good catch, would you mind opening a PR?. After a second look, if you run your tests inside the app container, the varnish URL should resolve.. The standard edition is designed to use containers everywhere, including in the CI. It may worth it to mention this in the docs, but the code shouldn't be changed.. docker-compose exec app vendor/bin/phpunit. Thanks @kbariotis . Were you using the provided Docker setup?. Do you use the 2.1 version or the master version?. weird, I cannot find any occurence of this constant in the repository.\nCan you run grep -r DATABASE_HOST api please?. You can decorate the ItemNormalizer to add the new property then (there is a doc about this).. I think it's interesting, but I would not add the config directly to the main repo becaus:\n\nwe try to provide only one preferred way by default (and we'll stay with Docker for now)\nit will add unwanted files for most people\n\nDo you think that it can be a documentation entry providing a good config? It can also be an official (but different) repo. Do you plan to use Homestead or Laravel directly? Maybe can it be nice to patch homestead to support API Platform natively?. Would you mind opening a docs pull request?. Docs updated by @nWidart: api-platform/docs#378 thanks!. You can use the priority attribute of the tag to change the priority (you'll need to add the tag manually if you rely on autoconfigure).. This file is here to be edited, you don't have to extend it, you can add any code you need directly in it.. @k911 are you using API Platform? By default API Platform doesn't read from the session, so the header shouldn't be sent.. It's now done in master.. Thanks @jewome62 . The master branch is the dev version, not 2.1 (the directory structure and Docker setup has changed a lot).\n2.1 (the latest stable version) is here: https://github.com/api-platform/api-platform/tree/2.1. If you want to use the master version:\ndocker-compose exec php bin/console\n\n. Yes we occasionally merge lower branches in the higher ones.. Classes looks too broad, too generic to me. In my projects, I put all my entities (regardless if they are mapped with Doctrine or not) in an src/Entity directory (small project) or Feature/Entity (large project).. Hi,\nThanks for trying API Platform! \nI don't get exactly the problem you have. API Platform handles circular references natively thanks to its hypermedia capabilities.\nCan you copy the error you get?\nBest regards,. It's because the ProjectBookCreation is not marked with @ApiResource, so it's not handled by the API Platform (it is by the Symfony one), and as there is a circular reference, an error is thrown.\nIf ProjectBookCreation where an API resource, the circular reference would be handled automatically. If you don't want to make it a resource, you need to register a circular reference handler by yourself: https://symfony.com/doc/current/components/serializer.html#handling-circular-references. Can you paste the output of bin/console debug:router? Does clearing the cache (rm -Rf var/cache) help?. We probably need to patch Symfony's index.php directly.. This is very unlikely... Can you paste the output of composer info?\nAre you sure you use PHP 7.1. And hasn't this issue been already opened?. Can you remove the cosmetic changes please? It makes the diff harder to review (and the final result is harder to read, but that's just my opinion).. Thanks @Lctrs . We probably to add this exception there: https://github.com/api-platform/core/blob/master/src/Bridge/Symfony/Bundle/DependencyInjection/Configuration.php#L245-L248\nWould you mind opening a pull request?. @asimonf IMO it should be fixed upstream in Symfony. I think that a PR would be very welcome.\n. The problem is: if the full collection is returned (what you call \"single page collection\"), there is no point to tell the client that it's a partial collection.. 1. Be sure that you have no local http nor MySQL server running locally (shut them down if it's the case)\n2. Download the zip of the latest stable version on https://github.com/api-platform/api-platform/releases\n3. Extract the archive, and go to the newly extracted directory\n4. Run docker-compose up (you must have a recent version of Docker and Docker compose installed locally)\nIf something goes wrong, please paste the logs and the errors you get.. It looks like a bug to me.. API Platform uses Doctrine (by default, it's optional). Doctrine supports this feature. You can just map the existing database in your entities, or generate entities from the existing database: https://symfony.com/doc/current/doctrine/reverse_engineering.html. Are other pages working? Because it looks more related to Docker than to GraphQL.. No, it's just a standard HTTP endpoint. Can you try http://localhost:8080/graphql?. Authentication and authorization are already supported. I don't know exactly what you mean by \"but better way is a hide graphQL by symfony\", but the GraphQL implementation is 100% integrated with Symfony, and if you put /graphql behind a Symfony firewall, it will work.. Can you paste the stack trace you get?. Bonjour @abysKri,\nAPI Platform est un projet communautaire, open source et gratuit. Les-Tilleuls.coop en est effectivement le principal sponsor (bien que pas le seul) mais le projet n'est pas directement li\u00e9 \u00e0 la soci\u00e9t\u00e9. Certains mainteneurs du projet (et la plupart des contributeurs) ne travaillent pas pour Les-Tilleuls.coop.\nLes gens qui contribuent au framework (y compris moi) le font sur leur temps libre et ne sont pas pay\u00e9s pour. Les contributions ainsi que le support communautaire est donc effectu\u00e9 selon les disponibilit\u00e9s et les envies des d\u00e9veloppeurs b\u00e9n\u00e9voles.\nCertaines soci\u00e9t\u00e9s (parmi lesquels Les-Tilleuls.coop, mais pas que) peuvent \u00e9galement \u00eatre sollicit\u00e9es afin d'ajouter des fonctionnalit\u00e9s n\u00e9cessaire aux projets sur lesquels elles travaillent ou r\u00e9aliser des fonctionnalit\u00e9s command\u00e9es par des clients qui n'ont pas les comp\u00e9tences ou le temps pour les impl\u00e9menter eux m\u00eame. Elles fournissent \u00e9galement du support (payant) \u00e0 leurs clients, en fonction de leurs disponibilit\u00e9s et projets en cours.\nLe bug tracker sur GitHub ne sert qu'aux rapports de bugs et propositions de patchs. Les communications s'y effectuent uniquement en anglais afin de permettre \u00e0 un maximum de personnes d'y participer.\nLe support communautaire (c'est \u00e0 dire fait par des b\u00e9n\u00e9voles, gratuit, et sans aucune garantie) est disponible via StackOverflow (en anglais uniquement, la encore afin qu'un maximum de personnes puissent b\u00e9n\u00e9ficier des r\u00e9ponses apport\u00e9es) et sur Slack (\u00e9galement en anglais et en fran\u00e7ais).\nPeut-\u00eatre devriez-vous commencer par ces deux canaux.\nComme pour tous les projets \"open source\", la documentation peut bien entendu \u00eatre am\u00e9lior\u00e9e. Des bugs existent et doivent \u00eatre corrig\u00e9s. Libre \u00e0 vous et \u00e0 toutes les bonnes volont\u00e9s de le faire (ou de payer des gens pour le faire).\nConcernant votre demande de support commercial aupr\u00e8s de Les-Tilleuls.coop, vous \u00eates en contact avec l'une de nos coll\u00e8gues depuis quelques jours, elle vous a transmis une proposition chiffr\u00e9e. Les \u00e9quipes de Les-Tilleuls.coop sont actuellement tr\u00e8s charg\u00e9es, et nous vous avons communiqu\u00e9 les dates de disponibilit\u00e9s les plus proches dont nous disposons.\nVous comprendrez que nous ne pouvons pas \"d\u00e9staffer\" des d\u00e9veloppeurs de projets clients en-cours (qui ont g\u00e9n\u00e9ralement \u00e9galement attendus pour obtenir ces prestations) afin de r\u00e9pondre imm\u00e9diatement \u00e0 une demande plut\u00f4t qu'\u00e0 une autre.\nPour r\u00e9pondre \u00e0 votre question \"simple\" : \n\nla communaut\u00e9 peut vous apporter de l'aide en fonction de ses moyens, disponibilit\u00e9s et comp\u00e9tences, sans aucune garantie (sur StackOverflow et Slack)\nLes-Tilleuls.coop peuvent vous apporter de l'aide avec un niveau de prestation garantie, aux dates et montants pr\u00e9cis\u00e9s dans le devis\nd'autres soci\u00e9t\u00e9s ont \u00e9galement des comp\u00e9tences API Platform et peuvent vous aider, je vous laisse le soin de chercher lesquelles et de v\u00e9rifier leurs disponibilit\u00e9s\n\nP.S : \u00e0 chaque \"issue\" que vous cr\u00e9ez sur GitHub, les plus de 150 personnes abonn\u00e9es \u00e0 ce d\u00e9p\u00f4t re\u00e7oivent une notification... Je verrouille donc celle-ci.\nCordialement,. It looks ok to me to have support for this in core, would you mind opening a PR? (and yes, using a decorator as a workaround should do the trick). I would suggest to use Kubernetes in production: https://api-platform.com/docs/deployment/kubernetes/. I would discourage doing this, but can https://github.com/api-platform/core/pull/1365 work for you?. Again I strongly discourage using this option, but as we accepted to introduce it for other formats, OK to add it to JSON API too.. Are you sure you use the latest version?\nIf yes, it\u2019s a bug to fix!. Well, it's weird but thanks!. It looks like there is a problem with the volumes. Do you use Docker for Windows or Docker Machine?. Good to know! Thanks for the feedback. It deserves an entry in the \u00ab\u00a0troubleshooting\u00a0\u00bb guide. Would you mind opening a doc PR with a screenshot of the Kaspersky screen where this option belongs?. For the docs, you can edit directly https://github.com/api-platform/docs/blob/2.2/extra/troubleshooting.md using the GitHub UI.. The best would be to have something like this: https://loopback.io/doc/en/lb2/Where-filter.html\nA or filter on steroid!\nping @GregoireHebert. I don't have a Windows box to debug... It looks related to volumes.. Would you mind to open a doc PR with this? It will help other people having the same issue.. Thanks @mauchede . I cannot reproduce, here what I've done (on a Mac):\nwget https://github.com/api-platform/api-platform/archive/v2.2.2.zip\nunzip api-platform-2.2.2.zip\ncd api-platform-2.2.2\ndocker-compose pull\ndocker-compose up --build --force-recreate\nAnd everything work as excepted. Can you try that? What is your OS?. Regarding the permission problem, do you use Linux? Maybe can you just \"chown\" the file on the host after the installation? On Mac there is no problem because Docker handles permissions in a smarter way: https://docs.docker.com/docker-for-mac/osxfs/#ownership\nWe may need to find a workaround for Linux.\nRegarding the env file, Docker has native support for it (https://docs.docker.com/compose/env-file/), it's why we don't install symfony/dotenv by default, but if you want to use API Platform on the host directly, you can install it.\nCan you give us the step to reproduce the bug with .env.dist? Modifying this file should be ignored if it doesn't exist. It looks like a Flex bug to me.\n. @Selion05 great! Would you mind adding a documentation entry with these steps?. Thanks @teohhanhui . Thanks!. @Simperfit sorry but -1 on my side. It means more maintenance, more ops and more costs for the project. I prefer to automate this fully using managed services. . Thanks ou @teohhanhui . I think we should plan to move to Varnish's xkey fist.. Can you paste the full error please?\nexception_to_status should work if it is a route handled by API Platform (API Platform doesn't interfere with other Symfony routes). Can you add single quotes around the class names?\n(the stack trace will not be serialized in prod, but a 500 is not ok for this case). It's not a, API Platform error (the error serialization format of API Platform doesn't look to that). And according to the stack trace, the exception doesn't trigger API Platform's default handler.\nIt looks like the security listener is executed very early.. It seems that this exception doesn't come from this bundle (there is no reference to Auth0 in https://github.com/lexik/LexikJWTAuthenticationBundle/blob/master/composer.json).\nCan you upload somewhere a minimal repository to reproduce the problem so we can try to reproduce and debug?. It should be automatic, API Platform uses standard Symfony mechanisms. It's maybe a bug in the bundle (I never used it), maybe a priority problem in how their security listeners are registered.. Thanks for the kind words :)\nYes, and it's very efficient (almost costless as far as your return early when there is nothing to do). Symfony itself uses this method for its built-in listeners.\nSome handy constants are defined to ease the process: https://api-platform.com/docs/core/events/. Indeed, the doc need to be updated. Behat isn\u2019t shipped by default anymore, you need to install it manually. . Would you mind opening a PR?. Closed by #630.. Thanks @purplefish32 . It's intended, in dev mode, you probably want to not use the cache (because it's a pain to debug), in prod, you'll use a static website hosting for the client, not the Docker dev container.. The container uses Alpine Linux (as all other containers provided by API Platform). It is shipped with a package manager called apk: https://wiki.alpinelinux.org/wiki/Alpine_Linux_package_management\nHere is an example usage: https://github.com/api-platform/api-platform/blob/master/api/Dockerfile#L10-L11\nPHPIZE_DEPS is defined directly in the PHP official container: https://github.com/docker-library/php/blob/master/7.2/alpine3.7/fpm/Dockerfile#L11-L20. or a symlink. The API Platform docs will be at http://localhost/api when installing through Flex. Maybe the docs need to be updated accordingly.. @jpprade would you mind opening a doc PR? Please mention that the API is registered under /api only if you use the Flex recipe. When using the standard distribution it is registered at the root.. Thank you @fabpot!. \ud83d\ude08 I'm afraid to merge this evil PR (#666).. I can confirm it works on Mac.\nAnyone tested with Windows?. A CI check would be great, indeed.. Thanks @Simperfit . Docs updated. Thanks for reporting, and @antograssiot for fixing it!. Hi,\nThanks for reporting. Would you mind opening a PR changing the package.json?. Closing as not an issue. Support requests must be done on StackOverflow or Slack.. It allows to use quay.io instead of DockerHub to retrieve pre-built images. The env var allows to change easily the registry.. Can you explain the error you get? It's a simple environment variable. It's default value is set here: https://github.com/api-platform/api-platform/blob/master/.env\nYou can change it by setting like this: https://docs.docker.com/compose/environment-variables/. I'm not confident requiring alpha versions... Did you try if it works with the generated code?. If we don\u2019t need it, better drop it.. Closing as we're using connected router now.. You must use the guid Doctrine type if you want to use UUIDs:\npatch\n{\n    /**\n     * @var string The entity Id\n     *\n     * @ORM\\Id\n     * @ORM\\GeneratedValue(strategy=\"UUID\")\n-     * @ORM\\Column(type=\"string\")\n+     * @ORM\\Column(type=\"guid\")\n     */\n    private $id;. You also need to enable UUID support for Postgres: https://stackoverflow.com/a/22446521/1352334. @GonzaloRodriguezBlanco why not adding it as a comment (not everybody needs UUID support).\n@teohhanhui if the ID isn't provided by the client, it's better (faster and more secure because lower level) to delegate to the RDBMS right?. pgcrypto is written in C. In the cryptography field, using a low level language makes it easier to make the implementation as deterministic and side-effect free as possible. Unlike in C, it\u2019s not possible to inline ASM code in PHP, and it is very hard (almost impossible actually) to write deterministic implementations.\nCrypto or random number generation related algos are almost always faster (and better) when wrote \u201cclose to the metal\u201d (and it\u2019s even better it it\u2019s delegated to the hardware directly).\nI don\u2019t know how is implemented Ramsey\u2019s UUID. I bet it delegates sensitive computations to a C extension for this exact same reason. But in this field, the less abstractions layers the better (and pgcrypto is close to the metal).\nUsing pgcrypto also ensures that all inserted UUID are of the same quality, generated by a same algo. If you delegate to PHP (several apps or DB clients can connect to the same DB), you loose this guarantee.\nYour use case is valid, but specific. In this case ok to use something like Ramsey, but it\u2019s not a very common one in my experience. (Generating a UUID client-side, in JS or in a native webapp is more common in my experience).. > Is this already covered in API platform?\nNo.\n\nIf not, why?\nIt is handled directly by PHP: http://php.net/manual/en/ini.core.php#ini.post-max-size\n\nI'm not sure about the status code returned in case error, thought.\n\nIf that's of interest, I'd be happy working on the implementation.\n\nCould be nice to have, indeed! It should rely on as much as possible on internal PHP features.. Looks like a good idea to me! It would be even better if it's supported by default in Symfony.. Looks like it is a network or hard drive problem on your side:\n```\nWARNING: Ignoring http://dl-cdn.alpinelinux.org/alpine/v3.7/main/x86_64/APKINDEX.tar.gz: IO ERROR\nWARNING: Ignoring http://dl-cdn.alpinelinux.org/alpine/v3.7/community/x86_64/APKINDEX.tar.gz: IO ERROR\nERROR: unsatisfiable constraints:\n```. What's the problem with the ZIP?. Would be great!. +1 for export-ignore. Thanks @teohhanhui!. Your Fastly config looks faulty: Varnish transfers the request to the PHP server instead of handling it directly.\nBe sure to use https://github.com/api-platform/api-platform/blob/master/api/docker/varnish/conf/default.vcl.\nBe careful to whitelist the host that will execute BAN requests: https://github.com/api-platform/api-platform/blob/master/api/docker/varnish/conf/default.vcl#L18-L22\nWhen you'll manage to get something working, it would be awesome to add a doc entry explaining how to configure Fastly! Do you think you can do it?. Thanks Han!. Minor versions shouldn't introduce such issues, it's why there is no upgrade docs (the upgrade must be transparent). It looks like a bug here.\nCan you try to manually remove the cache (with rm -Rf)?\nA 404 is throw because at some point $data becomes null. Can you try to dump() the value of $data in this block https://github.com/api-platform/core/blob/v2.2.6/src/EventListener/ReadListener.php#L86-L96 to find where $data is set to null please?. Hi, I agree with @teohhanhui, it should be in an external bundle, not in core. However we'll be happy to merge low level changes in core that enable the possibility to create such bundles.. Support has been added in Symfony 4.1.. Hi,\nIndeed, API Platform v2 has been designed to be framework agnostic, and supporting other frameworks than Symfony such as Laravel, and PSR-7 / PSR-15 is definitely something we want.\nThings have improved since we added GraphQL support (the code base has been refactored, and all dependencies to Symfony's HttpFoundation have been removed from the Doctrine Bridge).\nAs you pointed out, the main coupling between API Platform and Symfony full-stack are the event listeners. We are in the process of removing as much logic as possible from event listeners and move them in dedicated classes (and services). It's not totally finished, but most of the work has been done.\nThe listeners and the few controllers now should just extract data from Symfony's Request or add some data to the Symfony's Response. That's all.\nTo implement PSR-7 / PSR-15, we'll have to create new PSR-15 middlewares for every existing listener/controller. Those middlewares will call the exact same services than the event listeners. It shouldn't be very hard, but it's some work. And it's definitely something we want in the main project.\nExcept middlewares, here are the other things to do to have full Expressive support:\n\nregistering the classes in Zend Service Manager (except ir Expressive can work with the Symfony DI container, I don't know Expressive enough)\nImplementing our IriConverterInterface and some related interfaces using Expressive's router (except if Expressive can work with the Symfony Router, I don't know Expressive enough)\n\nIt's some work, but I think it will not be that hard in the end. If you start working on this, we definitely will merge it in the main repository, and I'll be glad to help. In my opinion we should focus on supporting PSR-7 / PSR-15, not Expressive specifics. I mean if it's possible to use SF's DI and Router, we should go this way, it will make the initial development easier and reduce the maintenance.\nUsing the HttpFoundation <-> PSR-7 bridge (that I've created) isn't a good idea in API Platform, because it comes with an important performance penalty.. > I wonder if it's possible to support PSR-11 container or is that not expressive (\ud83d\ude0e) enough?\nWe already do (because the Symfony container implements PSR-11). The problem is: PSR-11 only describes how to retrieve services from the container, not how to register them.. > GraphQL format is still using HttpFoundation for request and responses (besides listeners).\nOnly in the controller (it's mandatory), but not in the lower level layer.\n\nIf we are going to the framework agnostic road, we should consider api-platform as a library and not a framework. And it being a library I don't think it should be using DI containers at all.\n\nIt's both a set of libraries and a framework (similar to SF components / SF full stack). We follow use a monolithic repository, but we'll create a subtree split at some point.\nLibraries need to be registered in DI containers (most libraries have related bundles for Symfony, modules for Laravel). It's why the DI plumbing is in the Bridge namespace. We can add more adapters to more frameworks/DI.\n\nWhat I would like to see is an example of using api-platform without routes, DI containers, listeners or any other concept that belongs to the framework scope. Basically take a request, read its content, configure the schema and make the library respond to what's been asked for in the format I want.\n\nI would be great to have a doc entry like this, I agree. Maybe @gorghoa do you have some hints about this?\n\nI was able to do that in GraphQL in 60 lines of code.\n\nYou mean using webonyx/graphql-php?\n\nI may be wrong, but api-platform seems to solve the same problem with an extra layer of abstraction. \n\nIndeed.\n\nSo the thing I did using GraphQL should be an achievable goal too and it would reduce the complexity to get started.\n\nI agree!\n\nMiddlewares/listeners/services would exist to automate the integration to frameworks but not a hard dependency to use the library.\n\nExactly.. Can you try with the last version of Docker (18) please?. Can you paste the output of docker-compose logs db?. Just remove the prefix: /api line in config/routes/api_platform.yaml and you're all set!. The web server is probably misconfigured. Do you use the provided Nginx config?. Thanks for the head up @omarking05. What software did you use to extract the archive? I think the problem is related to this.. Unfortunately yes, it's still necessary for GCP.. Thanks @ajardin . You can use an event listener: https://api-platform.com/docs/core/events/. They are not, events are tight to HTTP, and only work for REST. We need to find a solution to trigger events in GraphQL.\nWhat we may do is add a new kind of \"domain\" events that will be triggered by both HttpKernel listeners and GraphQL resolvers.. Yes, see api-platform/core#2329. Hi, you can use the Property Filter: https://api-platform.com/docs/core/filters/#property-filter. There is a community client generator for Angular: https://github.com/momenttech/lysis\nAnd, for the record, we'll be glad to merge an official Angular skeleton in the main client-generator project.. restItems[0]['@id'] (same as in JS).. I think it would be easier to port lysis in client-generator. It would allow shared maintenance with other generators.. If the Client class isn't an API Resource, you need to add yourself the corresponding JSON schema to the Swagger documentation.\nYou can override the Swagger documentation: https://api-platform.com/docs/core/swagger/\nAnd https://github.com/dunglas/php-to-json-schema may help to generate the JSON schema.. It would be a great addition!. Weird. What version of PHP do you use? Can you paste the output of composer info?. For several reasons:\n\nIts internal design fits more with what API Platform needs internally (chain pattern instead of visitor)\nThe Symfony Serializer benefits from the release policy, Backward Compatibility promise and time-based releases of Symfony\n2 people of the API Platform Core Team are also proud members of the Symfony Core Team (including me). It means that we're never \"blocked\", we can merge the features and fixes we need easily in the Symfony Serializer\nJMSSerializer has been unmaintained in the past (it's not the case anymore), and it would have been a huge issue for API Platform. The truck factor for the Symfony Serializer is currently better\nAnd the main historical reason: when API Platform has been started, JMS Serializer was licensed under Apache v2. This license wasn't in sync with API Platform's goals because it isn't compatible with GPLv2 (used by ezPublish, Drupal, phpBB...). The license of JMSSerializer v2 changed recently to MIT (same as Symfony), so it isn't an issue anymore\n\nAnd according to the latest benchmarks, Symfony Serializer is faster, but that's not very interesting because both are very fast anyway.\nRegarding features, the Symfony one has features not available in JMS Serializer (YAML and CSV support, type checking, smart property access - most of them have been contributed for API Platform actually) while JMS Serializer also has some features still lacking in the Symfony one (nicer annotations-based high level config).\nTo learn more about the Symfony Serializer, how it works and all its features: https://dunglas.fr/2018/05/mastering-the-symfony-serializer-php-tour-slides/. JSON-LD is a good way to describe to other services the types and operations exposed by your API Platform service. Alternatively, you can use OpenAPI (Swagger). Both formats are automatically generated and available for other services (/docs.jsonld and /docs.json).. We also support the specific flavor of OpenAPI required to use AWS API Gateway: https://api-platform.com/docs/core/swagger/#enable-swagger-doc-for-api-gateway. Because JSON is just \"raw\" serialization, without any metadata. JSON-LD is designed to handle metadata, you should always prefer JSON-LD (it's valid JSON) over \"raw\" JSON.. Thanks @teohhanhui . Shouldn't we do the same thing for Kubernetes/Helm @teohhanhui?. Just switch to the prod environment, stack traces will be hidden automatically.. It's lower level. IMO we should either fix Nelmio (I'm a maintainer, I can merge in this repo) or contribute it in Symfony.. We reference the .env file in docker-compose.yml, we cannot delete it just like this. As long as Docker Compose doesn't provide support for dist file, we'll have to remove it from .gitignore.. You can use a serialization context builder to do that: https://api-platform.com/docs/core/serialization/#changing-the-serialization-context-dynamically\nIt would be nice to have built-in support for this, PR welcome (ping @vincentchalamon).. What do you mean exactly? Relations between resources are automatically handled by API Platform. It is hypermedia native, you have nothing to do.. Got it. Do you think the new Symfony WebLink Component can be suitable for this?. You can use a decorator to add your custom relations as documented here: https://api-platform.com/docs/core/serialization/#decorating-a-serializer-and-adding-extra-data\nThe JSON-LD format explicitly allows to do that.. It definitely deserves a documentation entry however.. It would be awesome to add this to the documentation. Would you mind opening a docs PR @mikemilano?. Can you paste the error you get and the corresponding entity please? This is probably a specific problem related to how the Symfony Serializer handles datetime objects.. Are you sure that it's not this feature of the serializer? https://symfony.com/doc/current/components/serializer.html#recursive-denormalization-and-type-safety\nThen https://github.com/symfony/symfony/pull/27136 could help.. Your config should work (you can even use constants in Doctrine annotations if you want). Can you post the exact error you have?. Indeed, this should be discussed on the Doctrine side because this behavior is the one of Doctrine Paginator. Except if we can find an API Platform-specific way of improving this query in some cases.\nIIRC Doctrine implemented this query like this because it\u2019s the only working implementation for the general case.. Can you check the logs (docker-compose logs php) to investigate what's going wrong please?. In the latest version (master), the .env file is handled directly by Symfony DotEnv, Docker doesn\u2019t manage it anymore. Can you try if you have the same issue with master please?. Can you show the received headers (especially the Age one added by Varnish).. I think we should remove it. Ping @teohhanhui. You should be able to create a custom data persister that will write in all persitence systems you need. You can even delegate to the built-in Doctrine Data Persister to write in Doctrine, then write by yourself in Redis.\nData persisters are definitely the way to go: https://api-platform.com/docs/core/data-persisters/. @Ronnie-J the release I just tagged fix this behavior. See #2175. > do you mean https://github.com/api-platform/api-platform/releases/tag/v2.3.1\nYes.\n\nSo if I create a custom data provider again it should not call the default one as well?\n\nExactly.\n. Not yet. But I\u2019m working on something.. It's intended right? It's a well known behavior of Varnish and we shouldn't change this: https://varnish-cache.org/docs/3.0/tutorial/cookies.html . Yes, I fear it's the only reasonable thing to do.. You should use a data provider: https://api-platform.com/docs/core/data-providers/. But which one should we use? 8080 may also be already used. The main benefit of 80 is that it's the standard port. Maybe could we improve the documentation instead to test if the port isn't already used?. The GET route must always exist. It's a best practice for hypermedia API: the IRI should be dereferencable.\nIf you only want to create a \"namespace\" but don't want to return any data, I recommend to create a controller returning an empty response along with the 200 OK status code and use it as the controller attribute:\nphp\nclass EmptyController\n{\n    public function __invoke()\n    {\n        return new Response();\n    }\n}\nphp\n/**\n *  @ApiResource(\n *     normalizationContext={\"groups\"={\"read\"}},\n *     denormalizationContext={\"groups\"={\"write\"}},\n *     itemOperations={\n *         \"get\"={\"controller\"=\"EmptyController\"},\n *         \"put\"={\"access_control\"=\"is_granted('ROLE_ADMIN')\"},\n *         \"delete\"={\"access_control\"=\"is_granted('ROLE_ADMIN')\"},\n *     },\n *     collectionOperations={\n *         \"get\"={\"access_control\"=\"is_granted('ROLE_USER')\"}\n *     },\n *     attributes={\"access_control\"=\"is_granted('ROLE_USER')\"},\n * ). The value of the review property isn't valid. It should be /reviews/{id} (like /reviews/22). string is not a valid IRI as pointed by the error.\nSwagger UI only documents the intended type.. Yes, there is a very impressive performance improvement in the latest version: https://dunglas.fr/2018/07/api-platform-2-3-major-perf-improvement-api-evolution-deprecation-better-dev-tools-and-much-more/\nThe upgrade should be smooth, you just have to upgrade api-platform/core to 2.3 and symfony/serializer to 4.1. All other Symfony components your project currently relies on can stick to 3.4.\nYou shouldn't have to change any code.. @mmplanet you're in prod mode? Can you share a Blackfire profile?. A profile on the prod server in prod env would be more accurate, but a profile in prod env on a dev machine should be enough. You should use a copy of the prod database in case the issue is related to SQL queries.\nThe only way to see what\u2019s going on is to measure.. You'll not be able to do that (curl, or telnet will always work).\nIf you want an URL de be private, you should add an authentication layer, or use capabilities URL (but authentication is easier).\nSymfony comes with built-in support for HTTP Basic. It should be enough for such use cases.. @slipo can you add the recipe chart too please?. You can already enable and disable operations, and create \"custom\" ones: https://api-platform.com/docs/core/operations/#enabling-and-disabling-operations\nIsn't it what you want?. What do you mean by \"links relations\"? The normalizer decorator is a service, so you can inject the SecurityContext in, retrieve the role of the current user and add the link accordingly.. Thanks for sharing your investigations!\nThis is a known issue that this page is broken (since the Symfony 4 release actually...).\nI started to fix it but I had not the time to finish yet: https://github.com/api-platform/docs/pull/535\nWould you mind opening a doc PR (at first) to fix the tutorial with what you explained here? It would be a very good first step!. > Ah. Didn't realize there was already a behat.yml.dist included in the repo (and that my behat.yml was not being committed at all!).\nIt\u2019s the default setup of the Flex recipe for Behat. Your default config should go in this file, and only the local overrides should be in behat.yml. For the sake of completeness, it is broken because API Platform was shipped with Behat and Behatch when it was based on the Symfony Standard Edition, but they have been removed form the new Flex-based skeleton and now need to be installed separately.. Thanks @Fabious! Great job.. @mmeloni you're totally, right. We're in the process of upgrading the chart. The demo has already be patched some time ago, but the fix hasn't been backported yet.\nHere is it: https://github.com/api-platform/demo/blob/master/api/docker/varnish/conf/default.vcl#L22-L25. Thanks!. Thanks @teohhanhui! Good catch. You could also been interested in Mercure: https://mercure.rocks\nMercure is being integrated in API Platform, see https://github.com/api-platform/core/pull/2282. Why? It's designed exactly for this kind of use cases: https://github.com/dunglas/mercure#asynchronous-jobs. You can decorate the ContextBuilder service and tweak its output accordingly: https://symfony.com/doc/current/service_container/service_decoration.html. Do you think you can provide a patch?. You're right, this should be fixed. Would you mind opening a PR?\nThanks for reporting!. If you use Docker Compose, you need to stop and start Docker Compose.. It looks like a trusted proxies related issue: https://symfony.com/doc/current/deployment/proxies.html. Good catch, thanks!. The skeleton as been depreciated in favor of the Symfony one.\nTo install API Platform using composer, run the following command:\nbash\ncomposer create-project symfony/skeleton my-project\ncd my-project\ncomposer req api\nThis is documented here: https://api-platform.com/docs/distribution#using-symfony-flex-and-composer-advanced-users. I just marked the api-platform/api-platform package on Packagist as abandoned, and suggested to use api-platform/api-pack instead: https://packagist.org/packages/api-platform/api-platform. See also https://github.com/api-platform/api-pack/pull/17. Thanks @Lctrs. Indeed, you have disable the invalidation cache.\nYou should update the Nginx config instead: https://ma.ttias.be/nginx-proxy-upstream-sent-big-header-reading-response-header-upstream/. Indeed we should change the default value, and add a section here: https://api-platform.com/docs/extra/troubleshooting/#troubleshooting. Thanks for the feedback @sushicodeur, it would be super cool if you can add the solution on this page: \n https://github.com/api-platform/docs/blob/2.3/extra/troubleshooting.md. The initial implementation was using md5, but it has been changed to plain IRIs because hashes were hard to debug.\nAlso, to preserve the mechanism, you must add the hash of every IRIs, not the global hash (because a single response can and will be marked by several tags).. They are tags. In your code you hash all tags in one 1 tag. It cannot work. You must have a list of hashes separated by a comma (just hash the IRIs, not the whole header value or you'll never purge anything). It grows linearly. The more resources are included in the HTTP response, the more tags are added. But there is no limits for headers size in the HTTP RFC, and NGINX limits can be configured.. To expose vendor entities, you should use YAML or XML mappings instead of annotations.. It's described in the Symfony Serializer docs: https://symfony.com/doc/current/components/serializer.html#attributes-groups. It could be great to add a documentation entry about that, if you feel motivated :). Thanks @teohhanhui . Try top stop totally Docker Compose and then start again. Setting the value in the config file isn't recommended anymore: https://symfony.com/doc/current/deployment/proxies.html\nThe problem is definitely that the env var change is not taken into account.. This looks like a bug (must be investigated), but indeed, only string should be used.\n. You mean when enabling the JSON format?. You can disable this feature totally if you want: https://symfony.com/doc/current/components/serializer.html#recursive-denormalization-and-type-safety. As written in the logs, it\u2019s a network isssue on your side. Your server isn\u2019t abl\u00e9to reach Alpine Linux servers. There is nothing we can do about that.. Thanks @Lctrs . Yes, it is using the typescript generator of API Platform client generator: https://api-platform.com/docs/client-generator\nBasically, you'll run npx @api-platform/client-generator https://demo.api-platform.com src/ --resource book -g typescript\nUnfortunately, this feature isn't documented. It would be awesome to add a doc entry about this.. No I don't think so, some docs for this would be awesome!. Indeed, thanks. This script is not provided in the default archive, but maybe should we add it. In this case we should run the composer command directly in a Docker container to be sure that the user don\u2019t have to install PHP on the host.. Would you mind updating the docs please?. The Docker Compose setup is designed for the development environment (on your local computer). The dev mode requires much more resources than the prod mode.\nIn production, we recommend using the provided Kubernetes setup (https://api-platform.com/docs/deployment/kubernetes/#deploying-to-a-kubernetes-cluster), with Amazon EKS if you want to use AWS, or any other deployment method supported by Symfony:  https://symfony.com/doc/current/deployment.html. Thanks @vincentchalamon . The best approach would be to finish this PR: https://github.com/symfony/flex/pull/128\nThen we could create a meta-package such as api-platform/mongodb-pack and a corresponding recipe to update the files.\nWDYT?. It will be a pain to maintain, and will pollute the main repo... This PR is close to be finished, I would prefer to go directly this way.. I would prefer a docs entry in the meantime.. Thanks!. I would prefer a docs entry, or an example in the demo app. But we try to keep the focus on direct API Platform features in this repository.\nAlso, but it's a personal opinion, I prefer true SSR such as Next.js than this kind of hacks :). Do you have a data provider for the output class?. Can you try yo set this to  false? https://github.com/api-platform/api-platform/blob/master/api/config/packages/api_platform.yaml#L16\nMost likely you don't have a Varnish installed on your CentOS server. . I wasn\u2019t aware of this one, we could probably support both as for Swagger UI / ReDoc.. We could install Flex globally instead, as done here: https://github.com/dunglas/symfony-docker/pull/43. Thanks @Mathieudewet . You need to upgrade to 2.4 beta to have this option.. Are using Alice Fixtures or Doctrine Fixtures? https://github.com/api-platform/demo contains a proper fixtures setup (using Alice), that works pretty well in both env. Could you diff your install and demo please?. It's on purpose. FS sharing is slow on Mac, not exposing these folders allow to improve the performance a lot.. However, the permission issue after uncommenting is weird. Maybe could we find a workaround for that, for people wanting to share this directory between the host and the container.. The error message is explicit: \u201cThe constraint \"App\\Constraints\\Owner\" cannot be put on classes in\u201d. Your constraint can only be put on properties, not on a class.\nSee https://symfony.com/doc/current/validation/custom_constraint.html#class-constraint-validator if you want to be able to use this constraint on a class.. Proposal:\n\nintrofuce a new context option: use_api_platform\nset it to false by default, except for formats fully managed by API Platform (JSON-LD, JSON:API, HAL)\nswitch it to true in our SerializerContextBuilder\n\nIt will fix such issues.. For now will do it manually. Or maybe could we just add a \u02cbsedline to remove the extra constant automatically?. Thank you very much Max!. Do you use Varnish? If so, be sure to upgrade NelmioCors to the latest version, that fixes a cache pollution issue.. Thanks for the feedback! Could you edit the docs with this fix please?. It should not be necessary. The Postgres container creates the DB automatically.. Can you paste the full stack trace, andconfig/packages/api_platform.yamlplease? It's weird that theshowWebbyvariable is used, it shouldn't be the case by default.. @Belssemcomposer require api-platform/core ^2.4@beta. Can you add this block in this repo instead? https://github.com/dunglas/api-platform-doc\n. Currently the default setting of both API Platform and Symfony SE is MySQL. I personally prefer Postgres but MySQL is more used in the PHP world.\n. Is this one really stable and necessary?\n. Why those changes? I prefer to keep them synchronized with the Symfony Standard Edition. It makes it easy to merge changes.\n. IMO we should not add authors in the edition to make it clear that users must appropriate and change such files. Btw, adding a provider looks too advanced for me.\n. This file should be kept in sync with what theschema.yml` file produces. \n. I agree with @vincentchalamon solution.\n. The \"cardinality\" setting must be changed.\n. What is the difference between the two commands? Both seems to work.\n. \"data formats\"?\nHAL (without the JSON- prefix)\nYAML\nXML or CSV?\n. We don't want to use community images anymore. Please use an official image. \n. The doc for Docker is in the docs repository.\n. Why not using docker-compose.yml directly?\n. It works with default scripts. If someone add something breaking it, he an add the --no-scripts flags by itself. WDYT?\n. Not having it is a major DX issue. It makes it almost impossible to use Docker for dev.\nIt's a private IP, AFAIK it should not cause security issue and the user can still edit the file to fit his needs.\nIf Docker changes the IP aain, we will update the file. If the user change it, he must update his file himself.\n. I'll push robuster alternative implem.\n. What do you think of this one?\n. I definitely agree. Having FPM + nginx would be nice! Does anyone want to work on this?\n. Should be reverted (all API Platform's users aren't french \ud83d\ude2c).\n. Not necessary: LexikJwtAuthenticationBundle is not (yet) installed by default.\n. Shouldn't we always install deps?\n. Unused, should be removed.\n. Bad indentation, and please use the long form for clarity (--optimize-autoloader)\n. Bad indentation, long form.\n. Should be reverted (I prefer to have the image running on 80 by default).\n. Well, we're only using Apache right now. symfony-standard doesn't have Docker support at all. If we add Docker support (and we should because it improves the whole DX, like Homestead do for Laravel), we must propose a flawless default experience for the user. \nIdeally it should be as easy as \"Download and unzip api-platform.zip then run docker-compose up\" (it's something like that I'm actually writing in the new \"getting started\" guide).\nFPM + Nginx is not yet an officially supported setup (but I'm \ud83d\udc4d to move to this setup if we find solutions to preserve DX). API Platform v2 will likely be released with Apache support only. I propose merge this PR for now and find a solution dedicated to nginx when we'll move to it (probably v2.1). WDYT?\n. I agree, the standard output is the normal way to deal with logs on Docker (and many tools require that this behavior works).\n. Can't we use copy too here (to avoid installing wget)?\n. Extra blank line to remove.\n. Why not moving after adding /app?\n. Why do you expose this port? IIUC SSL isn't configured.. Why --no-autoloader? I would dump an optimized autoloader with\n--optimize-autoloader --classmap-authoritative instead.\nOf course in this case the call to composer install must be moved after copying the source code.. Why not copying the whole bin directory? The user can provide its own commands.. Should be 7.1 now.. Can you keep the actual composer.sh script please? It is optimized for PHP 7+ unlike this snippet.. Is it necessary to publicly expose this port? I prefer to let the use doing this kind security related changes by himself.. Why do you use restart: always for every containers except this one?. I don't find your previous comment. What is the problem exactly? You need to install the acl package thru APT to be able to execute the setfacl command.. Double thinking about this, I'm unsure that Docker supports ACL. Anyway, we cannot rely on hardcoding the 1000 uid, see https://github.com/api-platform/api-platform/blob/master/docker/apache/start_safe_perms#L8-L37. fixed. Done. You need to chmod +x all executable files to avoid problems on Windows.. It can be merged in one line, dans I'll move this line just after the COPY instruction for those files.. It cannot work because the apache user and group is changed after that: https://github.com/Stoakes/api-platform/blob/163969f52bb29fd72e0724c6666473ec0978694c/docker/apache/start_safe_perms#L26-L32. Maybe can we enable this optim by default because our Docker setup comes with APCu. What do you think?. config_prod.yml is only parsed in the production env.. FROM php:7.1-fpm-alpine?. We need openssl, not openssh. IMO We should keep the image minimal and let the user install extra packages only if he need them.. We still need APCu and the opcache extension.. I prefer keeping the composer install in the image. It speeds up deployments because packages are already in the Composer cacher.. Yes please\n. Not really, in test env we should install dev dependencies too for instance. IMO we should not install dev deps only in prod mode.. The driver should always be configured like this if APCu is enabled. It will improve performances thanks to the metadata cache but doesn't have any side effect because even with a configured driver, result and query cache aren't enabled by default.\nThe only downside of uncommenting them is when APCu isn't installed. But it is in our Docker setup (the recommended way to install API Platform).. I prefer Postgres myself but the standard installation must stay as close as possible as most devs already know. So I'm for keeping MySQL for now.. > Since it was decided(?) not to rename it to the shorter / more convenient \"db\"...\nSymfony uses database_* as parameters. It's better to stay consistent.. But as the official image already uses a volume, I would remove this entry entirely.. @teohhanhui can you revert this? As we use PHP 7+, we can use PHP directly for the download and remove wget from the container: https://github.com/composer/composer/pull/5860. Ok for me. Can we merge?. Can you use single quotes everywhere please?. Do you know a workaround for this?. It hurts the DX. When you change the code in dev, you want the new code to be executed even if the underlying resource has not been modified.. As a general politic, we follow upstream conventions (for Symfony, Docker, Doctrine and so on). If it can be challenged, it should be in the upstream project.. I like too, but @teohhanhui is right, we try to make default configs as short as possible to not confuse the end user.. I just tried, and at least IntelliJ handle dashes correctly.. I suggest to let it as is for now. WDYT?. For instance, when using CloudFlare, the s-max-age header should be set too. I propose to keep it as is for now too. We'll see when we'll get some feedback.. tripviss-api should probably be removed :p. This file seems to come from https://github.com/docker-library/healthcheck/blob/master/mysql/docker-healthcheck\nCan you add a comment with the original URL and copyright holder?\n```\nCopyright (c) 2014-2016 Docker, Inc.\nOrigin: https://github.com/docker-library/healthcheck/blob/master/mysql/docker-healthcheck\nLicence: MIT\n```. Can you add:\n- docker-compose run --rm app bin/console doctrine:schema:create. Should be reverted (https://github.com/symfony/symfony-standard/blob/3.3/app/config/config.yml#L44), only strings containing special chars are quoted.. Same here. Indeed, the idea was to test that the Docker setup for the DB was properly running.. I don't remove them, I keep the default location. It allows to have them both in files and in stdout/stderr thanks to a trick in the official Nginx image.. It was was I was calling a trick.. I've kept this as in symfony/symfony-standard on purpose (it prevents unwanted upgrades to the next major version when it is released). I don't get your point, we don't set this value automatically, it's up to the user. We just provide a good default when using the Varnish image.. My concern is that this custom header will not be taken into account by Cloudflare. Maybe can we set the smaxage as we currently do but remove it with Varnish before the request go outside our network?. I propose to keep it simple, the user can always rename it if he wants to.. What's the benefit of this change?. It's not necessary here?. IMO we should do both: a merging this as a workaround (because it doesn't hurt) and fill an issue at Docker.. I don't get what it fixes. 3.1 is allowed by ^3.0. Can you point to the docs instead (https://api-platform.com/docs/client-generator/)?. It deserves a comment, remove the #s to enable probe (probably not needed in a managed environment like Kubernetes though).. app_dev.php has been removed. Now both the nginx and the varnish containers are publicly exposed, type https://localhost for the non-cached version and http://localhost:81 for the proxied version.. To take advantage of Docker cache layers. This way the cache is used if dependencies have not been modified even if the source code code has been modified.. This line must be removed, good catch. Unlike Flex, I decided to follow the Create React App strategy (https://github.com/facebookincubator/create-react-app/blob/master/packages/react-scripts/template/README.md#adding-development-environment-variables-in-env), so the .env file must be versioned.\nI'm not sure if it's the best way to do anyway.. This repo is MIT, but the project created by the user may be proprietary. It's the file generated by Flex, I've not updated it. Maybe should I just remove this line.. Fixed thanks. I've done the same thing for Composer btw.. Because it appears in the shell.... Yes but it's just about a single line of the run. Putting it before makes no sense. It's why I've deleted it.. You can probably just use the one of the default VCL:\nsub vcl_hash {\n    hash_data(req.url);\n    if (req.http.host) {\n        hash_data(req.http.host);\n    } else {\n        hash_data(server.ip);\n    }\n    return (lookup);\n}. Can you add a blank line at the end please?. # Add a debug to see the number of HITS (0 means MISS). Blank line. Can you inline this file in .travis.yml to not pollute the user's skeleton with tests that will not work for him?. I'm hesitating. I agree with you, this useless for API Platform projects. On the other hand, it allows to be in standard Flex directory. . Why replacing && by;? If one command fail, the process must stop.. Can we keep with the current CS please :)?. Why removing those libs?. I changed this for consistency. I find it weird to have some .yml and some .yaml in the same repository. And .yaml is recommended in the YAML spec IIRC.. http://www.yaml.org/faq.html\n. Upstream supports both. I'm not sure :). After a second though, I think (like @sroze) we should name and indent all YAML files consistently. YAML is an open format, there is no point to use different flavors of it in the same project (ours). The benefit of using YAML over custom config formats is precisely that it's an open standard with parsers in many languages.\nThe only exception regarding the extension, is .travis.yml, because AFAIK .travis.yaml isn't supported :(. A benefit of using Quay: our org name is still available (Docker Hub doesn't allow dashes and apiplatform is not available. I registered apipltfrm but it's less nice).. Ok, let's use Quay for now.. Nice one!. git mv to not loose the history?. May I suggest to hardcode quay.io/api-platform? So one less file in the repo, and it's easier to dig into for a newcomer. WDYT?. This line can now be removed. It will fix the build.. Why not 80?. According to the Varnish docs:\n\nUntil now we've been running with Varnish on a high port which is great for testing purposes.\n\n80 looks like a better fit right, and it will be more production ready too.. Please keep 80. It makes everything more obvious, and it will allow to reuse this container with Kubernetes easily (for instance, this change will break our current Kubernetes setup).. I don't understand why we need to change that. It's a container with a single process, using the default HTTP port:\n\nlooks obvious\nmakes the .env easier to understand\nallows to not use port mapping in our Kubernetes setup\n\nAnd anyway, we cannot merge it as is because it will break this: https://github.com/api-platform/api-platform/blob/master/api/helm/api/templates/varnish-service.yaml#L13-L16. Unlike client and admin, this isn't (only) a development container: it can be used in production. The Varnish documentation I quoted explicitly states that 6081 is for testing purpose, I actually never seen this port used for Varnish in production.\nThis isn't against the conventions:\n\nHTTP communication usually takes place over TCP/IP connections. The default port is TCP 80\n\n(HTTP 1.1 RFC)\nAdding smoke tests for Kubernetes as we did for Docker Compose would be great. We'll have to install Minikube in Travis for that.. However, it would make sense to expose Varnish on the host's 6081 port (because 80 isn't free). But it would be a BC break, and would require us to update the documentation, so I suggest to keep this as is.. Having full GCP support is a nice feature of API Platform (and we at @coopTilleuls use it on some project). I think we shouldn't switch to the new feature until it is supported by at least GCP.\nWDYT @api-platform/core-team . I don't know what is the good practice regarding this. I guess it's a good idea but I'm not sure.. Unfortunately we cannot, Postgres 11 is buggy with Doctrine (especially the doctrine:schema:update command).. The rationale was to strongly encourage to use the managed RDBMS provided by the cloud platform (Google Cloud SQL, Amazon RDS, Heroku Postgres...) instead. Please keep it as is (maintaining a RDBMS in Kubernetes is very hard).. Oops \ud83e\udd23. It works then \ud83d\udc4d !. Indeed, so if it wasn't working already, then \ud83d\udc4d . CSS isn\u2019t allowed in Markdown. It\u2019s HTML 3 :). Note that align on p isn\u2019t valid either.. I would keep the ^ syntax for both package.json files. It will make the maintenance easier on our side.. yes please!. What's the benefit of this change? It will slower and consume more resources (it can matter in high availability infrastructures). Bootstrapping Symfony and warming is cache is slow... Btw having pg_client is also nice to debug.. Yes, but it does not help when you want to debug a connection problem form the PHP app (network issue for instance).. This change should be reverted because it prevents Varnish to work properly. You could use both Mongo and Postgres right?. This must be reverted. It prevents Varnish to work properly.. ",
    "theofidry": "It's still useful since the front controller is in web. Besides if you're shipping an SPA with it, you may as well put all your front-end files in web instead of having two separate repository. If you don't need it it can always delete it :)\n. @codeskull they both don't have any use for the API. As @dunglas said crawlers will always request them, and even if you can disable logging for these files, it is not done by default. That's way it is considered good practice to keep them, at least for \"distributed products\". If you have your API installed, there is nothing preventing you to remove them and disable the logging for that.\n. Even if we do consider moving away from it, in the meantime it won't hurt to used a fixed version instead of dev-master.\n. Windows \u2013> NIX:\ntr -d '\\r' < windowsfile > nixfile // delete the carriage returns\nMac \u2013> NIX: \ntr '\\r' '\\n' < macfile > nixfile // translate carriage returns into newlines\nNIX \u2013> Mac: \ntr '\\n' '\\r' < macfile > nixfile // translate newlines into carriage returns\nIf you want to do that in Git you can simply configure your git return line and do a git add -A. If you absolutely need to do that in PHP look for the carriage return character and replace it manually.\nCan't really help much more as I have no idea of what your use case is...\n. > Isn't it more developer friendly to have a working docker setup just after doing composer create-project api-platform/api-platform\nI also think so :)\n. There is https://github.com/dunglas/blog-api although still in WIP. It is planned to move it under ApiPlatform once it's usable.\n. There is several reasons for that:\n- What is your application: just a REST API or does it have a front-end as well (as, is it one application or two separate application?)\n- If you have two applications (API + Front-end), you may have one repository or decide to split them in two repositories.\n- The front-end world is very unstable and immature still, making such a full-stack project would require 1. to be highly opinionated on the technology used 2. require A LOT of time to manage it and keep it up to date 3. If you build 2 separate applications, you have already great tools to start up (ex: Yeoman)\nObviously if there was a good front-end developer willing to spend his time on it and is ready to maintain it, we would welcome it, but none of the ApiPlatform team is a front-end developer at heart with enough free-time to afford that\n. @dunglas updated\n. I'm for @teohhanhui suggestion for future versions.\n. Hi,\nThere is currently no support for MongoDB yet, there is some work being done here: https://github.com/api-platform/core/pull/461.\nFeel free to help :)\n. Thanks for the fig @n1c01a5!\n. Closing as @jderusse gave a better solution :)\n. Rogue merge as it's a revert of a PR that shouldn't have been merged in the first place.\n. > When I am posting data for the PackageElement resource with a package iri pointing to a nonexistant resource, I receive a 500 HTTP status code with the following error message:\n\nEntity of type 'Package' for IDs id(xxx) was not found\n\nThat doesn't sound right, if the form is invalid you should get a 400 not a 500.\n. > The thing is that the form is valid\nPoint is it should not. Not saying it's your fault or you did something wrong, but that's an abnormal behaviour and is the reason of your bug.\n. That's something that should be fixed and tested in https://github.com/api-platform/core; I can't work on it right now however :/\n. Closing in favour of https://github.com/api-platform/core/issues/549\n. Hi @zacrasta\n\nWhen I am trying to POST a request it's treated as GET and returns me GET response.\n\nCould you please detail what you mean by that? I.e. how do you fire the POST request, which what headers & encoding, what body and what you get as a response for example?\nIf you can also give the version you are using, that would help as well :)\nCheers\n. Hello, you can achieve that by using serialization groups.\nRegarding your second questions, it's up to you and your consumers. If your Image is a dedicated objects, this should be treated as such, if it's an embeddable, the object should be shown.\n. You have an example on how to transform:\njson\n{\n  \"@context\": \"/contexts/Offer\",\n  \"@id\": \"/offer/62\",\n  \"@type\": \"Offer\",\n  \"price\": 31.2,\n  \"product\": \"/products/59\"\n}\nto:\njson\n{\n  \"@context\": \"/contexts/Offer\",\n  \"@id\": \"/offer/62\",\n  \"@type\": \"Offer\",\n  \"price\": 31.2,\n  \"product\": {\n    \"@id\": \"/products/59\",\n    \"@type\": \"Product\",\n    \"name\": \"Lyle and Scott polo skirt\"\n  }\n}\nYou're free to have different groups and cumulate them :)\n. Glad to be of a help\n. Oh, I didn't think of though nice one \ud83d\udc4d \n. \ud83d\udc4d \n. I find it tricky: there is a common use case when you have \"simple\" roles, but you can quickly end up with much more complex roles and for which the system you are thinking of might not be good enough, because it becomes too specific to the use case.\nMy fear is that we accept to support an \"easy and common use case\", but as more user are using it, keep requesting more feature to it. Moreover, this feature would apply to the Symfony bridge only. Maybe it would be better to have this feature in a dedicated bundle instead.\n. > What remains is for PHP (or specifically for frameworks like Symfony) to catch up, by using ReactPHP or similar.\nyou mean by doing something PHP is not designed for? :P\n. Hi @rouflak!\nThe version 1.x should work on PHP 5.6 (it did come out before PHP7 after all). Otherwise 2.x bumps it to PHP7 as it was making a lot of things easier for us.\nDebian won't come with php 7 as a default installation before some time, but you can install PHP7 on a debian distrib still :)\n\nDo you plan to support symfony 3 on PHP 5.6 as most of the servers will come with this version for some time to come?\n\nWell I hope people will try to upgrade to PHP7 which should not be too hard unless you've been using PHP functions that have been deprecated for a while already.\n. > Moreover, the company I'm working for is not ready to upgrade to PHP 7 (you know how many time companies need to upgrade to a major version of PHP ;) ).\nTell them they'll get a 20-40% boost and consume much less resources (so can reduce the number of servers?) \ud83d\ude1d \nI believe we could make 1.x compatible with Symfony 3.x, it shouldn't require much work but @api-platform/core-team may prove me wrong.\n. @rouflak it's worth checking if making 1.x compatible with 3.x is not just a matter of updating the composer.json, if it's just that, we can definitely release a patch for it\n. The idea was not to put to much burden on the team regarding compatibility: PHP 5.6 stills hasn't reached EOL either, neither does Symfony 2.7 or even 2.3 for that matter.\nHowever in your case @jayesbe this may be issue on our end. The core does not require symfony/symfony, but only a few components. If you are on Symfony 2.7 or even 2.3, you may use ApiPlatform as long as you upgraded the required components (which doesn't necessarily require to upgrade the whole framework and all its deps).\nAlso as you can see here, we did lower some deps. Maybe the serializer or property info can be lowered as well.\nHowever, supporting PHP5.6 at this point is out of question for now unless we are given a very good reason to re-consider that point.\n. MongoDB is supported if you are using Doctrine ODM eventually combined with https://github.com/dunglas/doctrine-json-odm. @dunglas can you confirm?\n. As @Simperfit, this is a regular PHP application. Docker is here just to help a bit but you can do without :)\n. Closing as the issue has been answered then :). @Evertt but usually this kind of validation is business rules validation which are not trivial to define/describe, so how would you retrieve it?. Possibly, but I'm still a bit confused at how you would translate the rules. Business rules are not really just \"this and that not empty\". Also there could be security issues with providing an exhaustive list of your validation rules as then the attacker could exploit that information to look for things you forgot to validate.. But then the way to go is to have this validation on the front-end :) Having a request made after each field change to the back-end to validate the user input would be an insane thing to do as it could significantly increase the workload of your back-end provided the response time is good enough so that the server round-trip + rendering doesn't feel laggy to the user. I perfectly understand the problem and there's been a few attempts at solving it by generating an Angular form based on a json config, which could easily be dumped from the back-end for example. Or simply have those \"isomorphic\" apps where sharing this peculiar bit of code can be easier. It's just that there is no clear way to go at the moment as it depends a lot of your front-end stack and how you manage forms there. \nMy suggestion would be to experiment more in that area and if the solution is satisfying, then we could consider having it in the a core or as part of the ecosystem maintained by the core team. For example an idea would be to have a generator for Angular2 able to read the Symfony validator config and partially generate the code for the validation from it, although there's bound to have dubious edge cases and this doesn't solve the issue of maintaining a parity between the front-end/back-end. Then there's the question of how portable that would be to other JS frameworks, how many of them should be supported.... /srv/api/vendor/bin/../vendor/autoload.php should indeed be /srv/api/vendor/bin/../autoload.php\nCould you give details on your setup?. you're breaking you alignment ;)\n. Psysh? Yeah it is, but I putted here as debug and forgot to remove it. It could be included by default though, it's just a debug tool. So your call\n. Lexicographical order (sorry it's me being a maniac); will revert\n. Got it; should I use a static 'male' string for example instead?\n. ok, will do that in another PR then\n. in those cases (forcing a typehint with @var in inline code) phpdoc are unneeded, a simple comment do \n. I remember getting a warning from phpStorm, Scrutinizer or another tool\nabout that at some point which could explain why he changed that.\nBut in any case, thanks for looking into that anyway\nOn Saturday, 26 March 2016, Teoh Han Hui notifications@github.com wrote:\n\nIn web/app_dev.php\nhttps://github.com/api-platform/api-platform/pull/58#discussion_r57507428\n:\n\n@@ -18,7 +18,7 @@\n     exit('You are not allowed to access this file. Check '.basename(FILE).' for more information.');\n }\n-/**\n\nI'd rather we don't change things unnecessarily from symfony-standard.\nIn any case, this syntax is actually still wrong anyway (according to\nPSR-5 draft). See relevant discussion here:\nhttps://www.drupal.org/node/2305593\n\u2014\nYou are receiving this because you commented.\nReply to this email directly or view it on GitHub\nhttps://github.com/api-platform/api-platform/pull/58/files/e9808ff6b9c796c0f6af37c7d3f3e7d15fdc8fac#r57507428\n. @dunglas not sure how you update that in you schema.yml\n. docker-compose run web bin/console hautelook_alice:doctrine:fixtures:load\n. both works, but before AliceBundle was working with Doctrine ORM only so there was no ambiguity. However since v1 you have support for ODM so hautelook_alice:fixtures:load has been deprecated.\n. Indeed it shouldn't be change, --optimize-autoloader can be removed though as --classmap authoritative does imply --optimize-autoloader.. \n",
    "sadovnik": "@dunglas 404 logging of these files can be easily prevented by your web server:\nnginx\nlocation ~* \\/(favicon\\.ico|robots\\.txt) {\n    log_not_found off;\n    access_log off;\n}\nThey don't make a problem.\nWhat's the purpose of requesting these files in terms of an API? I haven't found any references about this topic, could you please share some?\n. ",
    "L0rD59": "Hi, thx for investigation\nwe will see\n. Hi,\nIt's good for me in 5.6.11\n. ",
    "teohhanhui": "\nMany-To-Many associations are only possible if the mapped superclass is only used in exactly one entity at the moment\n\nhttp://doctrine-orm.readthedocs.org/en/latest/reference/inheritance-mapping.html\n. Let me illustrate by using this repo (api-platform) itself. This is what I get when I run app/console doctrine:schema:validate right out of the box (after composer install, of course).\n[Mapping]  FAIL - The entity-class 'AppBundle\\Entity\\CreativeWork' mapping is invalid:\n* The referenced column name 'id' has to be a primary key column on the target entity class 'AppBundle\\Entity\\CreativeWork'.\n* The join columns of the many-to-many table 'creativework_person' have to contain to ALL identifier columns of the source entity 'AppBundle\\Entity\\CreativeWork', however '' are missing.\n. Thanks for the reassurance.\n. Please see the issue-6 branch in my fork.\nThis is what I get when running app/console doctrine:schema:update:\n[Doctrine\\DBAL\\Schema\\SchemaException]                            \n  The table with name 'api.thing_imageobject' already exists.\n. @dunglas FYI my database is empty. The issue is with Doctrine not being smart enough to generate one join table per mapped entity, i.e.:\n- book_imageobject\n- organization_imageobject\n- person_imageobject\n(Or rather, it's trying to generate one join table for each of them alright, but they end up with the same name of the entity where the association mapping is...)\n. I have doubts whether it's supposed to work in the first place:\nhttps://github.com/doctrine/doctrine2/blob/v2.5.0/tests/Doctrine/Tests/ORM/Mapping/AnnotationDriverTest.php#L137\n. From @beberlei's comment on DDC-945\n\n... unidirectional Many To Many associations work if you use the Mapped Superclass only once ...\nFor 2.1 there will be an additional feature described in DDC-964 that allows overriding certain mapped superclass details to avoid these problems.\n. More generally, how'd you handle file uploads in a REST API?\n. The way PostCollectionAction works:\n\nphp\n        return $this->serializer->deserialize(\n            $request->getContent(),\n            ...\n        );\nIt bypasses PHP / Symfony's processing of request body, instead relying on the Symfony Serializer...\nAt first I thought of implementing an encoder for multipart/form-data, but history tells us it shall not be done: symfony/symfony#10381\nSo no, multipart/form-data seems to be out of the question.\n. The overarching issue is that DunglasApiBundle does not work with application/x-www-form-urlencoded and multipart/form-data Content-Types\n. Considering DunglasApiBundle is built around the Symfony Serializer workflow (normalizers), I imagine it wouldn't be straightforward to subvert that while still making full use of the services...\nI'll just go with base64 encoded string for now...\n. I suspect the DataUriNormalizer in Symfony Serializer is only good for a tiny amount of data (I have not tried it). Going by thephpleague/uri#11, I'd expect a 1MB file to fail to upload due to pcre.backrack_limit being exceeded...\nAlso see https://github.com/symfony/symfony/pull/16164#discussion_r52104290 and https://github.com/symfony/symfony/pull/16164#discussion_r52104421, which I don't think have been addressed yet.\n. I'm not talking about source files but HTTP entity body (in JSON, for example). This question is about sanitizing user (API consumer) input.\n. Windows browsers are required by HTML spec to normalize line breaks as CRLF during form submission. Not exactly our use case here, but I hope you get my point... The API probably needs to normalize the line breaks.\n. @dunglas\n\nYou mean the value of a textarea encoded in a JSON document or something like that?\n\nYes.\n. I'm not sure, to be honest. This is an open question to hear the experiences of others and how they deal with the problem.. Have you declared all of them (User, Admin, Customer, Farmer) as resources?\nExample here:\nhttps://api-platform.com/doc/1.0/api-bundle/getting-started#registering-the-services\n. @jderusse\nDockerfile\nRUN apt-get update \\\n    && apt-get install -y --no-install-recommends \\\n        git\n        libicu-dev \\\n        zlib1g-dev \\\n    && rm -rf /var/lib/apt/lists/* \\\n    && docker-php-ext-install \\\n        intl \\\n        mbstring \\\n        zip\n. http://symfony.com/doc/current/reference/requirements.html#optional\n. @dzubchik Good idea. And we can install apcu too...\n``` Dockerfile\nRUN echo \"zend_extension=opcache.so\" >> /usr/local/etc/php/conf.d/05-opcache.ini\nRUN pecl install \\\n        apcu \\\n        apcu_bc-beta\nRUN echo \"extension=apcu.so\" >> /usr/local/etc/php/conf.d/20-apcu.ini \\\n    && echo \"extension=apc.so\" >> /usr/local/etc/php/conf.d/21-apc.ini\n```\n(not sure if apcu_bc is still necessary...)\n@aitboudad @jderusse\n. @jderusse If I remember correctly the load order needs to be apcu.so followed by apc.so, and we have no control over that when using docker-php-ext-enable.\n. Didn't know that. Cool!\n. I wonder if there could be reuse of Dockerfiles across the different distributions (Laravel edition etc. as planned)?\nWe could also look into automated builds for the Docker images (if it makes sense in our case).\n. I actually didn't notice we already have a docker-compose.yml (but it's outdated*, and only the database is in a separate container...)\n* needs to be updated to Docker Compose v2 file format\n. Yeah, more or less.... We could just do composer install --no-scripts\n. I don't see why. Ideally the Docker image should contain all dependencies so that the container can be ready in the shortest time after it's created.\n. > ### Containers should be ephemeral\n\nThe container produced by the image your Dockerfile defines should be as ephemeral as possible. By \u201cephemeral,\u201d we mean that it can be stopped and destroyed and a new one built and put in place with an absolute minimum of set-up and configuration.\n\nhttps://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/#containers-should-be-ephemeral\n. @vincentchalamon You misunderstood. It's exactly why we should do composer install during the image build, not on container start.\n\nit can be stopped and destroyed and a new one built and put in place with an absolute minimum of set-up and configuration\n\nThis is talking about the container, not the image. By doing as much work as possible during image build, we make the container start as fast (and as simple) as possible.\n. @Simperfit\n\nbut anything related to the project should be done in the project.\n\nThe image is an image of the project. It should include the project files (source code, dependencies etc.). In practice, I use a volume for my vendor dir (and composer cache) and run composer install on container start too, but that's because of the inability to use volumes during build.\n. I guess it depends on what kind of use case we're trying to target here. But we need #50 for anything serious (\"one container to rule them all\" quickly runs into many problems).\n. By adding the --no-scripts argument to the composer command, project problems should not prevent the build. :smile:\n. :+1:\n. Just came across this post by @sroze :stuck_out_tongue:\nhttp://sroze.io/2015/12/23/immutable-docker-images/\n. I'm -1 for this.  Agree with @jderusse\n. ping @api-platform/core-team\n. /cc @jderusse\n. @dunglas There are no CS problems. Those are false positives.\n. @n1c01a5 That should be fixed by #57, provided you provide your own MySQL container.\n. @sroze: I counted @vincentchalamon and @dunglas \nAssuming the CS issue is valid, it still was not introduced by this PR, thus it is irrelevant :smile:\n. Fixed.\n. ping @api-platform/core-team\n. We might want to consider maintaining stable branches for the Standard Edition going forward.\nWhat do you think @api-platform/core-team?\n. It really depends on our level of commitment. If we have branches, it'll be a lot more work to maintain and sync... Unless we can cope with it, I'd say we should just use tags.\n. I see that there is already a 1.x branch. Hmm... But is it actively being maintained?\n. Change in composer.json:\njson\n    \"require\": {\n        ...\n        \"dunglas/api-bundle\": \"~1.1@beta\",\n        ...\n    }\nand then run composer update\n. Are you sure you need such flexibility of arbitrary key-value pairs, or is it just lazy modelling? That said, if you're sticking with this, you can simply use the json_array Doctrine type.\n. In which case, yes, I think the solution would be a custom normalizer for the User class...\n. I think a string would be right. And it's not treated as a relation... What do you need to do with it?\n. @jderusse Sorry, I don't get what you mean... I've just encountered this bug, hence the fix.\n. The PEAR bug says that the PHP version dependency is not being taken into consideration when selecting the package version.\n. @dunglas You have to turn off the Travis build for this repo for now...\n. @dunglas It's only working right now. It will fail again when they release another 4.x version of apcu.\nSee the PEAR bug linked above.\n. @dunglas Yes. Updated to apcu v5.1.5\nSorry for the delay.\n. This bug should be filed under api-platform/core.\n. Yes, as you can see from the code the GET item operation is assumed to be present. If you think this shouldn't be the case, please open an issue at https://github.com/api-platform/core and let us know why...\nhttps://github.com/api-platform/core/blob/225501bc574364d62a15b8e7840bcf84fa43023e/Api/IriConverter.php\n. But it's conceivable that we can generate the IRI as long as there is any item operation, it does not necessarily have to be GET.\n. :+1:\n. We should use env_file or environment in docker-compose.yml, in conjunction with env-map in composer.json\n. http://12factor.net/config\n. Conceptually, it's not wrong to not have an IRI if you don't want to expose something as its own resource (in JSON-LD / REST terminology), but merely as part of another resource.\nPractically speaking, the @id is necessary for retrieving the existing entity when you try to update (PUT). Otherwise new entities will be created each time.\n. @bpolaszek The documentation is outdated. Please see https://github.com/api-platform/doc/pull/37\n. Long story short: add the relevant resource and property annotations to your entities.\n. See api-platform/core#482\n. @dunglas Your conclusion is wrong. Upon the creation of the volume, the contents are copied from the image. The only problem is when you use a host-mounted volume (or a tmpfs as discussed above for the immutable image, for that matter...)\n. @dunglas:\n\nbecause /app is a mounted volume, so vendors are NOT stored in the image \n\nVolumes play no part at all during Dockerfile build. They are only used during container run.\n. The fix is simple. Do not blindly mount the entire project directory from host, but have more fine-grained volumes instead (some host-mounted, some not).\n. @sroze:\n\nThe port mapping configuration is something installation-specific and\nshouldn't be in the Git repository to me.\n\nIt needs to be there, but can be overridden easily (e.g. by using a docker-compose.override.yml).\n. HTTP redirects always end up as GET requests. That's normal.\n. See api-platform/core#186\n. For v2, use Symfony Security voters.\n. Not at the moment. You could open an issue at https://github.com/api-platform/doc :)\n. @maechler:\n\nI was trying to implement a paginated collection and I did not find any other way to access the \"current page\" parameter other than using $_GET['page']. \n\nYou're supposed to inject @request_stack into the service (through the constructor).\n. Are you using v1 or v2?\n. It'd be great if you can provide a repository to reproduce the problem. Also, I'm not sure why you're using Doctrine's command directly, instead of using Symfony's bin/console?\n. > Doctrine command may not load properly Symfony annotations (it uses a special autoloading system).\nI thought it's just the Composer autoloader (PSR-4 etc.). And aren't annotations loaded using the Doctrine annotation reader? https://github.com/symfony/framework-bundle/blob/f340f7e96329c1d2b4f174318aa8e22a96bf2f71/Resources/config/annotations.xml\n. @napalm33700 This should already have been fixed in api-platform/core#552\n. It is only there for having a demo of sorts you can get up and running with...\n. We might want to add a custom faker to convert it to title case and strip off the period (.) at the end.\n. I agree. We should remove all fixtures from the standard edition.\n. What about just doing a PUT /users/{id} with \"enabled\": true (or similar) as part of the body? Of course you'd also need an authentication token.\n. PUT /users/{token} is definitely semantically wrong. The token is not an identifier for the user resource.\n. > But how to pass and check the confirmation_token ?\nPerhaps through the Authorization HTTP header. By confirmation_token I assume you're referring to the one generated by FOSUserBundle. Actually I'd suggest thinking about this in a different way: https://github.com/api-platform/core/issues/567#issuecomment-224572446\n. And how would we declare it? What do you have in mind?\n. I think we should instead look into out-of-the-box integration with Symfony Workflow (new component in 3.2), as suggested by @dunglas in https://github.com/api-platform/core/issues/583#issuecomment-228659741\nMeanwhile, just use custom denormalizers. But then again @dunglas said it's a bad idea here: https://github.com/api-platform/core/pull/584#issuecomment-228742890 :stuck_out_tongue:\n. Why would it require the openssl command in PATH?\nhttps://github.com/lexik/LexikJWTAuthenticationBundle/blob/d8e1a97a7e09280b795a66b0ffa705185795ee32/Services/OpenSSLKeyLoader.php\nIt's using openssl_pkey_get_private / openssl_pkey_get_public.\n. I don't believe that it should be auto-generated, because these keys need to remain the same across deployments (otherwise the JWT signature verification would fail).\nIf we're thinking about auto-generating the keys for a development environment, it should perhaps be done in the Docker startup script. And I think openssl is already included in the Docker image we're using :)\n. I don't see how it has anything to do with this project. Please file a Doctrine bug if relevant...\n. @kbsali:\n\nmethod which allow the client to send an array of objects of the same type, this will then of course try to persists all those objects to db\n\nIf they all belong to the same association, you can already cascade persist them. Otherwise, I don't think batch operations should be in scope for API Platform. (What do you think, @api-platform/core-team?)\n\nand then return an array of mixed object (persisted objects and errors if any)\n\nIs that a good idea? I'd think resources and errors shouldn't mix, even when doing batch operations.\n. Ugh. That OData Batch Processing is really bastardized \"REST\" (if you could even call it that...)\n. Actually, yes. It's already addressed by HTTP 2 via connection reuse (you don't even incur TLS handshake costs, which is probably one of the most expensive parts), so I doubt there are still many use cases that require batching.\nOData Batch Processing is like a poor man's HTTP 2, trying to solve it at the wrong layer.\nWhat remains is for PHP (or specifically for frameworks like Symfony) to catch up, by using ReactPHP or similar.\n. @theofidry:\n\nyou mean by doing something PHP is not designed for? :P\n\nHahaha... Yeah. Or by some other measure that can help improve concurrency. My point is, I doubt HTTP 2 is the bottleneck for most cases.\n. The right way to do it:\ncomposer create-project api-platform/api-platform api-test ^2.0.0@beta\nwhich gives:\n\nInstalling api-platform/api-platform (v2.0.0-beta.2)\n. You can still create custom controller actions if you choose to: https://github.com/api-platform/docs/blob/master/core/operations.md#creating-custom-operations-and-controllers\n. I suggest we do this instead: https://www.w3.org/TR/json-ld/#base-iri\n\nThis should also allow us to remove the path prefix (e.g. /app_dev.php or /api/app_dev.php) from the IRI. Much more cleaner and portable.\n. And the wording in the JSON-LD spec seems to suggest that absolute IRIs are undesirable. Of course, we should still allow to change that via configuration.\n. > remove the path prefix (e.g. /app_dev.php or /api/app_dev.php) from the IRI\nIn my view this is highly desirable, but I'm not sure how (cleanly) doable this is with Symfony.\n. :+1:\n. Docs for v2 can be found in https://github.com/api-platform/docs\n. You should use API Platform v2 :smile:\n. composer require api-platform/core:^2.0.0@beta\nAlso see #119\n. @martijn80 There is simply no working around the PHP 7 requirement. We use PHP 7 language features in the API Platform code. No amount of polyfill can change that. But I think you already know, because you'd have run into errors soon enough.... POST is for creating the resource, and PUT for updating it. If you can update with POST, or create with PUT, that's a bug and we should fix it.\n. Yes, I think it should result in a HTTP 400.\n. Since you're talking about \"top 5\", use a custom OrderFilter together with itemsPerPage=5 (where itemsPerPage is the page parameter name).\nFor example:\nGET /activities?order[popularity]=desc&itemsPerPage=5\n. Assuming your calculation can be done at the database level...\n. > I've already tried to make a Custom Operation, but this only works for Item Operations and not for Collection Operations unfortunately.\nPlease let us know what is the problem you are facing when trying to add a custom collection operation.\n. 1 is the way to go.\n\nIs it possible to do it with a custom EntityRepository? Will API Platform pickup for example getTotalValue() from the EntityRepository?\n\nThe way you achieve it does not matter, as long as the getter is there on the entity and it's exposed through the correct serializer groups used in the normalization context. In this case, if you have it as a function on the EntityRepository, you can use a custom normalizer to add the properties in yourself. :smile:\n. If you set the correct serializer groups for denormalization in the User entity, you can embed the user and it'll be updated.\n. See https://github.com/api-platform/docs/blob/master/core/serialization-groups-and-relations.md#embedding-relations\n. Yes, @id should be a unique IRI.\nPlease provide more info to help in troubleshooting:\n- Your custom data provider, if possible\n- Your resource configuration in YAML (that's what you're using, right?)\n. Since Person is not a Doctrine entity, you do not get the advantage of DoctrineOrmPropertyMetadataFactory.\nWhich means you have to declare the property as an identifier yourself. Currently you can only do this via annotation:\n``` php\nuse ApiPlatform\\Core\\Annotation\\ApiProperty;\nclass Person\n{\n    /*\n     * @ApiProperty(identifier=true)\n     /\n    private $id;\n```\n. Or are you using YAML mapping for Doctrine ORM?\n. I don't believe that this is the right fix. If we're using the wrong route for IRI generation, we should fix that instead.\nI'd like to see this reverted.\n. We're talking about api-platform/core#689 right?\nFrom your comment there: https://github.com/api-platform/core/issues/689#issuecomment-246192456\n\nBut there is something weird here, if you register the typical get operation first, it should always be used to generate the URL. If it's not the case, it's a bug and we must fix it.\n\nSo indeed this PR is merely a workaround of that bug, hence my objection.\n. @dunglas I thought in api-platform/core#689 we were talking about the order in which the item operations are declared in the ResourceMetadata, not the order of Symfony routes in the RouteCollection?\nThe former is not ideal but acceptable, the latter is just a bug. Perhaps I misunderstood, and in which case we should reclassify api-platform/core#689 as a bug.\n. @ppounder I do not believe slugs add any any value when used in the IRI for an API. That said, if you really want to do it, you can add your own decorator for the PropertyMetadataFactory:\n- ->withIdentifier(false) for the id property\n- ->withIdentifier(true) for the slug property\nHopefully that's all the changes necessary. (But let us know if there were more things that you needed to change to make it work.)\n. @dunglas Oops, I thought it'd be overridden by the DoctrineOrmMetadataFactory, but apparently there's a check.\n. @rouflak TL;DR: Use Docker.\n. I personally wouldn't recommend using v1.\n. Perhaps someone else who has used this kind of custom operations can help you better, but what are the exact issues that you're having?\n. Yes, it would be helpful to have the entities and other information (mapping etc.). We're using Symfony PropertyAccess to sync the collection, so unless it's a bug there...\n. @amenophis:\n\nI think the PUT api should return all child items.\n\nThe above PUT request should have deleted the other child.\nI can see now that you're probably not understanding the concept of owning side in Doctrine properly. You need to modify your adder / remover.\n. See http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/unitofwork-associations.html\n. @amenophis ~~Your setSigners method is wrong. Doctrine ORM UnitOfWork would not be able to compute the changes if you simply replace the entire ArrayCollection with your array.~~ ~~Hmm, that's fine since you're using fetch EAGER. It's only a problem when PersistentCollection is used. But still a bad practice because it'd break if you don't use fetch EAGER.~~\nAlso, you need to use orphanRemoval if you want the signers (which are no longer found in the association) to be removed. Or, if you actually intend for signers to be re-used across procedures, then it needs to be many-to-many with a join table.\n. > What i want to do, is allowing api caller to update a signer inside a procedure without sending all signers informations.\nNot possible to implement in a general way, because there is inherent ambiguity (also, the semantics seem wrong). But of course you can do it in a custom way.\n. Sounds alright to me. (But EagerLoadingExtension currently has no \"max depth\", only \"max joins\", which is not very useful except to catch infinite recursion.). @dunglas The Swagger icon is still being used on the documentation page. I think you might want to update that too.\n. Oh, already done in https://github.com/api-platform/core/commit/c4a5571521a441e29fca6366684242f17f7dd1c6\n. The custom normalization / denormalization context is per-operation. So you can specify different serializer groups to use for each custom operation.\n. See https://github.com/api-platform/docs/blob/master/core/serialization-groups-and-relations.md#using-different-serialization-groups-per-operation\n. > What do you think about using PHP PM instead of PHP FPM in this Docker setup? It increases the performance of API Platform 10 times (according to my tests).\nI'm -1 for using PHP-PM by default. It only presents more gotchas and head-scratching. If the user decides to switch to PHP-PM, he/she should be fully aware of the decision and what to look out for.. volumes_from is implicit. We should instead name our volumes (unless, of course, it's bind-mounted from host) and mount each of them explicitly.. @dunglas That was my fault. I think it should be all fixed now.. Travis failure (bin/console security:check) seems to be a problem on SensioLabs side.. @jockos Do verify that everything is working.. Using tmpfs means data is lost on container stop. I don't think that's a reasonable tradeoff for a development environment... (That is assuming it works not only on Linux. Because there is already a way that works perfectly for filesystems that supports acl - only Linux so far, until osxfs can support acl.). @Gormador @renan-taranto @Linkinou @Stoakes\nI'd love to know if this fixes #192.. You should try using Docker for Windows (new), not Docker Toolbox (old).\nFew tips for Windows compatibility:\n- Make sure you set git to not do EOL conversion - always use LF.\n- Make sure you do chmod +x ... in the container for the scripts that you want to execute.\n- (More problems that you might run into...)\n. It'd be good if someone could test on Windows and make sure it works out of the box.\n. This is probably related to the \"force_eager\" api-platform/core#845. It'd be great if we can have a visited relation tracking, similar to what's done in api-platform/core#1144. That will make eager loading usable for those of us who have a circular reference somewhere (it's actually very common, I think).. But this should be tracked in api-platform/core, maybe.... Make sure you're not doing it wrong: http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/unitofwork-associations.html#important-concepts. We'll need more information then.... API Platform is about a REST(ful) web API. Any kind of HTML forms builder (like Symfony Form) is mixing the frontend and the backend, so should never be supported here.... The user in the container which executed the commands is root, so that might be the problem... (I haven't looked into it.). This will be fixed by #162. That is why I do not recommend having a 2.0 branch... :disappointed:. > we must release bug (like this one) and security fixes before the release of 2.1\nI still disagree, but this is not the place to discuss this.. I don't think this can be implemented as a custom filter. And serializer groups seem ill-suited for this.... symfony/symfony#18834 has been merged. :tada:. You're using 2.0, right? Can you add a failing test?. It was supposed to have been fixed by api-platform/core#599. A resource should always have an IRI, unless it's an anonymous resource (with no ID whatsoever - not supported in API Platform yet anyway) in which case it cannot be updated / deleted.. @shaisachs But composer install is already in the container startup script: https://github.com/api-platform/api-platform/blob/8d7bedda15ab130a8d373dd401b1caf855492ad5/docker/php/start.sh#L10\nDid you override the cmd?. Or, more likely, I suspect you did not wait for the startup script to run to completion. We should mention this in the docs. :smile:. After docker-compose up -d, do docker-compose logs -f php to see the\nprogress. When you see a message that fpm is ready, that's the time when\nyou'll be able to continue.\nOn Thu, 9 Mar 2017, 22:21 Shai Sachs, notifications@github.com wrote:\n\nWhat do you mean by the startup script? Admittedly I may be doing the\nwrong thing, but here is my entire process:\n\nDownload\n   https://api.github.com/repos/api-platform/api-platform/zipball\n\ncd /path/to/api-platform\n\n\ndocker-compose up -d\n\ndocker-compose exec php bin/console doctrine:schema:create\n\nIt's step 4 where things go pear-shaped as described above. I've seen this\nhappen on a couple different machines. Could be I'm missing a step!\nEven so - it may be worth refactoring the docs a little bit to give a\nclearer step-by-step set of instructions for the docker install path, since\nas it is there's a bit of exposition that muddies things up a little. I'd\ncertainly be happy to give that a crack if y'all are amenable.\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/api-platform/api-platform/issues/200#issuecomment-285363664,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAhf6yNFrWzLvfiXhQMXtRo5Vbvbd8h8ks5rkArugaJpZM4LYZpE\n.\n. Sure, please help us make it better. We might want to look into the\nhealthcheck feature, but I'm not sure it will help in this case...\n\nOn Thu, 9 Mar 2017, 22:40 Shai Sachs, notifications@github.com wrote:\n\nOh! I see. I didn't realize that was a necessary step - I thought it was\njust informational. Mind if I touch up the docs to clarify?\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/api-platform/api-platform/issues/200#issuecomment-285369141,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAhf6xWlr-idP8_OOJABNRzSCr4UoJckks5rkA9lgaJpZM4LYZpE\n.\n. Can you elaborate?. Can you help us by adding a failing test case in https://github.com/api-platform/core?. There is the OrderExtension.\n\nTo use it:\nyaml\napi_platform:\n    collection:\n        order: 'ASC'\nRelevant docs: https://github.com/api-platform/docs/blob/79ff981212f9410fd04b5acdf3b0e1a8fb5cab20/core/configuration.md#L48-L49. The .env file is standard for Docker Compose. Perhaps we can include a .env.windows.dist or simply .env.dist.. Oh, I see now. You're using Docker Toolbox which is not the recommended method. I think we should only mention this in the documentation.. You are expected to pass in some serialization context. One way is to use the SerializerContextBuilder. (Not sure of your exact needs / what you're trying to achieve.). I believe @dunglas will do the merging manually, instead of it being done in a PR, right?. The same could be said about \"staging\" or other environments...\nOn Mon, 30 Jan 2017, 15:05 K\u00e9vin Dunglas, notifications@github.com wrote:\n\n@dunglas commented on this pull request.\nIn docker/start.sh https://github.com/api-platform/api-platform/pull/222\n:\n\n@@ -4,10 +4,10 @@ set -xe\n # Detect the host IP\n export DOCKER_BRIDGE_IP=$(ip ro | grep default | cut -d' ' -f 3)\n\n-if [ \"$SYMFONY_ENV\" = 'dev' ]; then\n-    composer install --prefer-dist --no-progress --no-suggest\n-else\n+if [ \"$SYMFONY_ENV\" = 'prod' ]; then\nNot really, in test env we should install dev dependencies too. IMO we\nshould not install dev deps only in prod mode.\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/api-platform/api-platform/pull/222, or mute the\nthread\nhttps://github.com/notifications/unsubscribe-auth/AAhf64oPNDkWrC_r2mq4ykbI4v6P8E5nks5rXYvCgaJpZM4Lu4um\n.\n. I'd like to see this and #162 combined.. > what about using only the composer files and letting the volume do the rest?\n\nIdeally, the image should be self-sufficient. Of course, there are exceptions like the data directory of a database, where it's not really practical to do so. But I'd expect the image of an api-platform app to include the files that actually make up the app.. See api-platform/core#78 and api-platform/core#103. You've been bitten by the Swagger documentation magic. Ouch!. > remove parameter _format from all routes\nThat's not currently possible because it's hardcoded in all routes. Unless you generate all the routes yourself... :disappointed:. See https://api-platform.com/docs/troubleshooting#using-api-platform-and-jms-serializer-in-the-same-project. The reason that option has been removed is because JMSSerializerBundle no longer registers the short alias. So there's no more opportunity for conflict.\n@karousn If you need help, please give us more details of the problem you're facing. :smile:. In case the title of this issue is confusing, it's not about how to use the JMS Serializer in API Platform. That is impossible. But you can let JMS Serializer co-exist with Symfony Serializer, which is already the case out of the box, since jms/serializer-bundle >= v2.0. http://stackoverflow.com/a/38501354/1529493\nBut I think we should log to both var/logs/*.log and stderr.. It needs to be done for each container. :smile:\nFor the Symfony logs, we can potentially do:\nsh\n...\n    && ln -sf /dev/stderr var/logs/dev.log \\\n    && ln -sf /dev/stderr var/logs/prod.log\nSee https://github.com/nginxinc/docker-nginx/blob/7b33a90d7441909664a920b0687db8d984ac314b/mainline/alpine/Dockerfile#L126-L128. You can download docker-compose yourself. :) I think that's mentioned in\nthe Travis documentation.\nOn Fri, 3 Mar 2017, 01:02 David McKay, notifications@github.com wrote:\n\nLooks like Travis only supports up to docker-compose 1.8 \ud83d\ude26\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/api-platform/api-platform/pull/244#issuecomment-283713457,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAhf60Uy3AVvekJR8oPJAnYF8FGOXhXOks5rhvYqgaJpZM4MRNwq\n.\n. Did not get to review / approve this... I'd have asked for lots of changes. :disappointed:. I thought the whole point is so that it makes it easier to access the files in a development environment.\n\nThis is why we should make use of docker-compose.override.yml to cater to different environments. We can provide docker-compose.override.yml.dev.dist and docker-compose.override.yml.prod.dist as reference.. I suggest (not full file):\n```yaml\ndocker-compose.yml\nversion: '2'\nservices:\n  app:\n    volumes:\n      - app-cache:/srv/api-platform/var/cache\n      - app-composer-home:/root/.composer\n      - app-logs:/srv/api-platform/var/logs\n      - app-sessions:/srv/api-platform/var/sessions\n      - app-var:/srv/api-platform/var\n      - app-vendor:/srv/api-platform/vendor\n      - app-web:/srv/api-platform/web\n  nginx:\n    volumes:\n      - app-web:/srv/api-platform/web\n```\n```yaml\ndocker-compose.override.yml.dev.dist\nversion: '2'\nservices:\n  app:\n    volumes:\n      - .:/srv/api-platform\n      - ./var/cache:/srv/api-platform/var/cache\n      - ./var/logs:/srv/api-platform/var/logs\n      - ./var/sessions:/srv/api-platform/var/sessions\n      - ./var:/srv/api-platform/var\n      - ./vendor:/srv/api-platform/vendor\n      - ./web:/srv/api-platform/web\n  nginx:\n    volumes:\n      - ./web:/srv/api-platform/web\n```\n\ndocker-compose.override.yml.prod.dist omitted here as there are no related volume overrides.\nService php renamed to app.. Should be addressed by #308.. It already works with plain IDs: api-platform/core#877. Can we have a test case? :)\n\nOn Thu, 9 Mar 2017, 23:14 friendsofdevs, notifications@github.com wrote:\n\n@teohhanhui https://github.com/teohhanhui does it works with plain IDS\nout of the box? Trying to send request but still getting \"detail\":\n\"Expected IRI or nested document for attribute \"contact\", \"integer\" given.\"\n(Accept and Content-Type headers are 'application/json')\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/api-platform/api-platform/issues/249#issuecomment-285379089,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAhf694FXBjTWHurdWiDHRTcMe7xTvZTks5rkBdygaJpZM4MW5Zm\n.\n. Yeah, this seems to be a bug.\n\nI can see that it's not covered by this scenario: https://github.com/api-platform/core/blob/aab50ef6741f3809ea8373a38efb8c967d049438/features/main/content_negotiation.feature#L45-L70\nCan you help us add one? :smile:. The easiest way would probably be to decorate the api_platform.iri_converter service.. @Palethorn That's not the right way. See http://symfony.com/doc/current/service_container/service_decoration.html. Doctrine json type is only available in master (v2.6; unreleased). But it's actually the same as json_array. There should be nothing stopping you from using the json_array type. If (I'm not sure about this) API Platform expects a flat array of strings, that's a wrong expectation on our end.. I think we should support a flat array of any homogeneous scalar type.. api_platform.collection.pagination.items_per_page defaults to 30.\nIf you set api_platform.collection.pagination.client_items_per_page to true, you can do for example:\nGET /api/books.json?itemsPerPage=100. I think we should stick to the official image. If it's not good enough, it can be improved.\nBut personally, I haven't really had any issue with the official PHP images.. I'd recommend against maintaining our own image. There's a reason why there are official Docker images.. Oh yeah, actually we're building our own images. Just not pre-built and pushed to a repository. :laughing:\nBut I meant our own base image, or compiling PHP ourselves. That's a no to me.. Closing this as we are not going to move away from the official PHP image.. @Simperfit Sure, we could set up automated build and push for our Docker image. That should make it much faster to start a new project.. declare(strict_types=1); is helping us catch these. Yay! But the price to pay is that things not caught by our test suite would be broken for a while. Sorry.... This is a duplicate of api-platform/core#969\nThere is an open PR at api-platform/core#984. This is not right. $PHPIZE_DEPS already includes pcre-dev: https://github.com/docker-library/php/blob/fba839b7dfbde029db36e834570a6b546189ee9e/7.1/fpm/alpine/Dockerfile#L18\nYou may be using an outdated base image.. Okay, this was only recently broken since docker-library/php#429 and fixed by docker-library/php#433, so we can indeed revert now. Sorry for my lack of investigation.... I don't really get what you mean.... I suggest we should revert first, then we can see what we can improve from there.. I've just tried it but unable to reproduce (I'm also using Linux). Can you provide more info?. You seem to have a file permissions problem. Hmm.... There is no need to run with sudo, because obviously your user is in the docker group, otherwise it wouldn't have worked...\nhttps://docs.docker.com/engine/installation/linux/linux-postinstall/\nBut also, this is probably hard for us to troubleshoot unless someone has a similar setup and can investigate.\nJust off the top of my head, perhaps you are using user namespaces? https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-user-namespace-options. Do you have SELinux enabled? That's the only similar symptom that I can find...\nSee https://stackoverflow.com/questions/24288616/permission-denied-on-accessing-host-directory-in-docker and http://www.projectatomic.io/blog/2016/03/dwalsh_selinux_containers/\nOtherwise, I'm not sure what problem you're running into. But you're on very old Linux kernel (3.19), right?. Oh, okay. It's actually a problem with the .zip archive not preserving the correct file permissions. I'd suggest you do a git clone instead (as you should). You could also use the tarball (.tar.gz).. JSON and JSON-LD are two different formats. I don't see why it's a problem if you have to decorate both normalizers separately. :smile:. If we can find a way of refactoring to extract out common functionality, I say go ahead. :smile:. I think it's a problem with git CRLF conversion.\nhttps://help.github.com/articles/dealing-with-line-endings/. @vbourdeix Can you verify if this fixes the issue for you?. Ok, we need someone to try this out on Windows. :smile:. Let's just open another PR to bump the nginx version.. Upon further consideration, I don't see the benefit of separating it into separate code repositories (and it's not really doable because we need to copy project files when building the image). But I'm still for (automated) build and push of the Docker images, for a much faster bootstrapping.. Yes, I love Flex and I'm using it. But it's still considered experimental. In the meantime, we can automate the build for this repository.. @Simperfit\n\nWithout the last slash it does not take them as volumes.\n\nI do not observe such behaviour on my end. Weird... Are you sure it's not a Docker or Docker Compose bug?. Docker for Mac bug? :D\nI can't find any documentation that suggests there should be a trailing slash... Can you point me to it?. Hmm... I hope we can have a more official source, and an explanation of what's the difference.. I've noticed this on my end as well. But I think the fix is not as simple as api-platform/core#1219 (it's a good first step).. Why?. How do we make sure that we're using the correct version of Docker and Docker Compose going forward?. Make sense.... Duplicate of #299\nShould already have been fixed by docker-library/php#433. Please make sure you're using the latest php image.. Can you help us fix the documentation?. @dunglas May I suggest we deprecate the FOSUserBundle integration? It'll prevent more people from using it by default.. You're trying to do an invalid SQL query: https://dev.mysql.com/doc/refman/5.7/en/group-by-handling.html\nPlease do not change the sql_mode to disable this check, but fix your query instead. :smile:. Use Docker for Mac, not Docker Machine. Docker Machine is old and not supported.. @abysKri Please open a new issue for your question.. For upgrading your existing project to follow the changes made in this distribution, you're on your own. The easiest thing to do is to compare, for example: https://github.com/api-platform/api-platform/compare/v2.2.8...v2.3.0\nYou'll have to go through it manually. :smile:. Assuming you're using https://github.com/api-platform/api-platform/tree/master, it exists as api/.env\nBy default, your file explorer (Mac OS / Linux) would hide files starting with .\nEven with CLI tools like ls, it'd be hidden if you don't use ls -a. > Composer could not find a composer.json file in /srv/api\n:scream: :scream_cat:. Yes, it'd seem to me like all your volumes are not working.. https://github.com/docker/compose/issues/4303. If it fixes your problem, please help us add this to the troubleshooting guide.. Make sure you are using Docker for Windows. Docker Toolbox, Docker Machine etc. are not supported.\n\nThe current version of Docker for Windows runs on 64bit Windows 10 Pro, Enterprise and Education (1607 Anniversary Update, Build 14393 or later).\n\nhttps://docs.docker.com/docker-for-windows/install/#what-to-know-before-you-install. The mysteries of life. :tipping_hand_woman::tipping_hand_woman::tipping_hand_woman: :laughing:. @msitruk Which version of api-platform/api-platform?. @msitruk I think it's because of mismatched versions of the pre-built images. You can try to do a docker-compose build.\nOops @dunglas, I should have gotten this fixed!. > Problem: I now have root-owned files in the project directory.\nI don't think that's possible to fix other than with user namespace mapping. But it's something that's done at the Docker daemon / host OS level. Personally I don't know enough to make it work lol...\nI'd also advise doing sudo chown $USER: vendor if it bothers you. It doesn't bother me, unless it's files I need to modify on the host.\n\n\nThe Flex installation also seems broken: the .env.dist file is missing so recipes cannot add lines describing the env. vars to add to the configuration\n\n\nThat is #643. > On Mac there is no problem because Docker handles permissions in a smarter way\nActually it's a horrible, horrible way. But it works. Haha.... @sushrest You also need to change the DATABASE_URL environment variable (in the api/.env file) to use the mysql:// protocol instead of pgsql://. This is a Docker Compose bug: docker/docker-py#1956. I'm definitely -1 for this. What is the problem with using git submodules?. Closing as this doesn't really make sense.. > in dev mode, you probably want to not use the cache (because it's a pain to debug)\nBut then you don't really know if your caching proxy is working as intended, especially that the invalidation logic might miss something. And then it'd come to bite you in production... :smile:. I think solution no. 2 is better because you avoid a potentially slow startup of the container when the Internetz is slowz lol...\nYou could use a docker-compose.override.yml (do not check it in to the repository) to well, override stuff in the docker-compose.yml. It is picked up automatically by docker-compose (yay!). You need to install the packages listed in the PHPIZE_DEPS environment variable.. Does the multi values not work for the IN case?\nhttps://github.com/api-platform/core/blob/v2.2.5/src/Bridge/Doctrine/Orm/Filter/SearchFilter.php#L251. @soyuka Let's not be so mean... :sweat_smile:. It's tricky, because we want to support docker-compose up out of the box. If only Docker Compose supports a .dist fallback... \ud83d\ude02\ud83d\ude02. Yeah, the easiest solution for now is to add .env.dist which is just a copy of .env.. Let's not open that can of worms... :rofl:. Did you figure something out? It'd be good to have more details. Are you using Docker for Windows?. Please provide more details to help us help you. :). Can you check what's in the public directory from inside the php container?. My guess is that it could be a permissions problem. Unfortunately you'll have to figure this one out on your own for now, since I don't think this is something we can troubleshoot easily.. You can use order=null, which disables the OrderExtension.. You're confusing api-platform/core with api-platform/api-platform. You could clone api-platform/api-platform and customize it to your needs. :smile:. Sorry, we've been having back-and-forth discussions about this. And in fact, it's only recently (in ~~#601~~ #613) been changed to follow upstream docker-compose.yml: https://docs.docker.com/compose/compose-file/. Please make sure you're using EditorConfig for your IDE / text editor. It shouldn't be a problem since we have an .editorconfig file.. I think we should have confirmation from Mac OS and Windows users that the setfacl works as expected.. @bendavies This builds 3 images, so 3 containers.. https://docs.docker.com/compose/compose-file/#target. @bendavies No worries! I think that's helpful as it might not be immediately obvious. I've added a note at the top of the Dockerfile. :smile:. @maxhelias That is correct, and it's intended because the nginx image needs to copy files from the php container anyway. :smile:. The build steps are cached so there should be no overhead.. We only mount host directories in development. It's not a feasible solution in production.\nThe earlier stages do not in any way get into the stage being built - the resultant image only contains what's in the target stage.. Tested working on Windows. :tada:. Should we add a check in Travis that .env and .env.dist have identical content? :smile:. > use jwt authentication instead of fosres\nI think you meant FOSUserBundle, but absolutely. :laughing:\nIf it's up to me, I'd put a big warning: Do not use FOSUserBundle. You might think you need it, but you actually don't. And it adds very little value.. It's not just a hello world.. I'd suggest using ramsey/uuid-doctrine instead.. @dunglas:\n\nif the ID isn't provided by the client, it's better (faster and more secure because lower level) to delegate to the RDBMS right?\n\nI disagree. There are advantages to having the ID generated by the app. If it's generated by the RDBMS, you cannot know the ID before it's committed to the database. Anyway, we don't know if that's faster (probably does not matter usually) and more secure (definitely not more secure just because it's lower level).. @GonzaloRodriguezBlanco There is no reason to execute that from the php container. You should do it in the postgres container instead: https://github.com/docker-library/docs/tree/master/postgres#how-to-extend-this-image :smile:. https://github.com/ramsey/uuid/blob/master/src/Generator/RandomBytesGenerator.php\nIt should be safe in PHP 7+. Can you show us the container log?\ndocker-compose logs cache-proxy. Uhh... Looks like that's a bug in the alpine package? A missing runtime dependency.... @youmad Your error seems to be unrelated. Please open a new issue if you think it's a bug.. Can we add a note so that nobody downloads the .zip file? Or is it possible to hide the .zip file in the release but show the .tar.gz instead?. We've seen several issues opened here before because of wrong file permissions. It doesn't always happen, but the chances of the .zip file restoring the correct metadata is lower than that of using the .tar.gz.\nhttps://superuser.com/a/173995/379322. https://github.com/api-platform/api-platform/issues/646#issuecomment-382273489\nhttps://github.com/api-platform/api-platform/issues/319#issuecomment-307185016. Moved to https://github.com/api-platform/schema-generator/issues/129. As pointed out by @theofidry at https://github.com/api-platform/schema-generator/issues/129#issuecomment-391052240, this was caused by a composer install that was not yet complete.\nAfter you do docker-compose up -d, you need to check the logs with docker-compose logs php -f to see when it's done before proceeding.. Looking at https://github.com/api-platform/schema-generator/blob/v2.1.0/bin/schema#L12:\nphp\n__DIR__ . '/../../../autoload.php'\n__DIR__ should give vendor/api-platform/schema-generator/bin\nso\nvendor/api-platform/schema-generator/bin/../../../autoload.php\nresults in\nvendor/autoload.php\nwhich is correct.\nIt is important to note that composer creates symlinks from the bin-dir: https://getcomposer.org/doc/articles/vendor-binaries.md#what-happens-when-composer-is-run-on-a-composer-json-that-has-dependencies-with-vendor-binaries-listed-. Unable to reproduce the problem.... Please read what I've mentioned above about the symlink. :smile:\nAnd __DIR__ also resolves symlinks: http://php.net/manual/en/language.constants.predefined.php\n\nName | Description\n   -- | --\n   __FILE__ | The full path and filename of the file with symlinks resolved.\n   __DIR__ | The directory of the file. ... This is equivalent to dirname(__FILE__).. vendor/bin/schema should be a symlink to vendor/api-platform/schema-generator/bin/schema. Is that not the case for you?. Are you on Windows?. It seems to be a problem with wrong line endings.. bin/console. > mkdir /host_mnt/c/code: file exists\n\nIt doesn't seem to be a problem with our project.. Maybe related: https://github.com/docker/for-win/issues/1560. @dunglas We might want to add AppVeyor to run the Docker build on Windows too?. @amalic Can you try this and let us know if it fixes your problem?. You can just do:\nshell\ngit clone -b fix/bin-console-windows-eol --single-branch https://github.com/teohhanhui/api-platform.git. https://help.github.com/articles/dealing-with-line-endings/. @dunglas We could also add\n.travis.yml export-ignore\nto exclude it from the archive.. > What about fixing it within the container during the build process?\nNo. It's something we can control, so that's unnecessary.. Anyway, the error that you encountered was during the container start. As you may have noticed, we have pre-built images on quay.io.. Don't worry. I'll help with the English. :smile:. I don't think we have that kind of flexibility yet, out of the box. But personally it's something that's been bothering me a lot... I think a lot of times having one model for every step of the process just results in too many compromises.. I think it should still be possible for you to use API Platform. You just (maybe) need to unregister some of the default listeners and use your own. No need to start from scratch!. Maybe https://github.com/api-platform/core/issues/1747#issuecomment-391241134 would be helpful too.. Uhh... There are actually some docs on using DTOs: https://api-platform.com/docs/core/dto. The user inside the php container is root. So I'm not sure it's a permissions issue in this case.. Without looking at the specifics here, minor and patch versions can fix bugs that might break your application if you were depending on the buggy behaviour. I'm not saying that's the case here.... Can you provide a minimal project based on https://github.com/api-platform/api-platform which reproduces your problem? :D. Why are they under .github directory? Is there special handling of those files by GitHub? But anyway, I don't think that's a good idea.. I think it should be in another project, as it's not a general-use format. Maybe we could list community extensions in the docs... :). The code sample you've provided is incomplete, so I can't really tell what's going on. But you need to make sure you're doing the right thing in your adder method. :smile:\n\nChanges made only to the inverse side of an association are ignored. Make sure to update both sides of a bidirectional association (or at least the owning side, from Doctrine's point of view)\nThe owning side of a bidirectional association is the side Doctrine \"looks at\" when determining the state of the association, and consequently whether there is anything to do to update the association in the database.\n\nhttps://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/unitofwork-associations.html#association-updates-owning-side-and-inverse-side. If you don't want to have methods for it, that's fine. But you'll have to update it on the owning side by yourself. That's because of how Doctrine works.. I'd recommend using adder and remover methods instead of a setter when it comes to collections.. 1. You can use event listeners.\n2. You can use event listeners and do a HTTP 301 redirect.\n3. I wouldn't recommend it. I think that's a bad idea.. Please let us know what are the pain points when using API Platform outside of the Symfony framework. I believe it's an ongoing goal for us to be framework agnostic.. You might be able to use the Symfony PSR-7 Bridge: https://symfony.com/doc/current/components/psr7.html. I wonder if it's possible to support PSR-11 container or is that not expressive (\ud83d\ude0e) enough?. Yeah, I realized that. So it means the user can choose to use the Symfony DI container, which we integrate with out of the box, or they could choose to use their own DI container but they'll have to register the services by themselves. I don't see any other way to do it for now.... It seems like you have some problem with the Varnish container? Was it running properly?\nHave you managed to resolve the issue? If not, please help us reproduce the issue.. Uhh, so it's a problem with having too many items to be purged from the Varnish cache? Perhaps https://github.com/api-platform/core/issues/1776 could help.. I think this might be a duplicate of https://github.com/api-platform/core/issues/1856?. It'd be more appropriate to have support for RDF data stores too... :laughing:. You can just use https://github.com/ivanakimov/hashids.php directly. And implement a custom id generator: https://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/basic-mapping.html#identifier-generation-strategies. The implementation could be very simple, similar to https://github.com/ramsey/uuid-doctrine/blob/1.4.3/src/UuidGenerator.php. Uhh, you just want to expose a different id in the API. Sure, that's possible. You don't need a custom id generator for Doctrine in that case.. From the documentation: https://api-platform.com/docs/core/serialization/#entity-identifier-case\n\n... the identifier must be marked explicitly using the identifier attribute of the ApiPlatform\\Core\\Annotation\\ApiProperty annotation.\n\nAnd you have a few options on how to convert between the hashid and the int id in the database. Will you be storing the hashid in the database as well?. Summoning @soyuka to help with the identifier black magic. :1st_place_medal:. There's nothing wrong with your setup. It's just that you needed to wait a little longer (about 30 seconds more according to the timestamps in the above logs).\nIf it's not clear enough in the docs, we should improve it.. You can easily override the api_platform.http_cache.purger alias with your own service definition. :smile:\nAs you can see, we don't directly use the service id of the Varnish purger, but we use the alias here: https://github.com/api-platform/core/blob/5a81357b449fc15c8c366f88943d5ffc899b3727/src/Bridge/Symfony/Bundle/Resources/config/doctrine_orm_http_cache_purger.xml#L12. @ajardin About further optimizations, I'm okay with maintaining 2 php.ini files for prod and dev separately. The alternative would be to introduce templating, or to use environment variables to set PHP configuration directives.. Did the php container die?\nPlease give us the output of\ndocker-compose logs -f php\nto help with debugging.. Uhh, I think it's a legit bug.\nWe should add this line\nshell\nchmod +x bin/console; sync\nbefore\nhttps://github.com/api-platform/api-platform/blob/ea5a3748ed202556eda1b7cb5784c87fac2f9db3/api/docker/php/docker-entrypoint.sh#L20\nCan you try that (you need to do a docker-compose build php before you try to do docker-compose up -d again) and let us know if it works for you? If yes, you may also create a PR to fix it.. Uhh, you're using version 2.2.8, so the line should be added before\nhttps://github.com/api-platform/api-platform/blob/154534a27597cb150a2c19d25934606ad1017f31/api/docker/php/docker-entrypoint.sh#L14. Hmm... It might be a problem with VirtualBox shared folders.. This might help: https://unix.stackexchange.com/questions/52667/file-permission-issues-with-shared-folders-under-virtual-box-ubuntu-guest-wind. Have you tried running it again? Could be an intermittent problem?. This means we need to update Symfony.. Prepending APP_ENV=test is the way to go.. That'd be a nice easter egg. :rofl:\nPR welcome.. api/.env is loaded in docker-compose.yml. If you want to use Symfony DotEnv, you could just composer require it and comment out APP_ENV in api/.env. If you're not using Docker, then just do composer req --dev dotenv :smile:\nYou shouldn't need to change anything else.. Perhaps we should add this to the docs, if it's not already in there.. -1\nI understand your problem but I don't think the behaviour should be changed. If you think we could improve the documentation, please open a PR there. Also (more likely) for Symfony documentation.. I think you just need to include the @id in the request body.. @rapax87 Could you try the 2.4 branch and let us know what issues you are facing?. @dunglas Yes. :). @bendavies It's been fixed here. Sorry that I wasn't careful enough about the build caching.. Duplicate of #764. I see you've moved this to https://github.com/api-platform/core/issues/2101. Yes, I think it should be included in https://github.com/api-platform/demo. Not sure, but I can only say NelmioCorsBundle is a very buggy piece of software.. @dunglas Do you think it'll be a good idea to implement our own CorsListener instead? I think it's a core feature, just like how we do our own cache tagging and invalidation instead of using FOSHttpCacheBundle.. I'm biased, of course, since I've tried a couple years ago: https://github.com/nelmio/NelmioCorsBundle/pull/54\n:laughing:. I think it shouldn't be in .gitignore.. @quentinus95:\n\nYou can reference the dist file in docker-compose\n\nUnfortunately that means it ceases to be a \"dist\" file. So it doesn't solve the problem. :smile:\nBy definition, a dist file is a fallback that should only be used when the non-dist file is not present. And that process needs to be transparent.. Closing this one. I think we'll be able to do something about this after https://github.com/symfony/symfony/pull/28533 :smile:. Now the Travis build is faster! :tada:. What is driver? :rofl:. Uhh, it's an exception from Doctrine.. You're trying to use the mysql driver somewhere when in fact you should be using the postgres driver. Or, maybe you don't have the dependencies installed for the postgres driver.. Check your config/packages/doctrine.yaml and also DATABASE_URL. Do you get the same exception when you do bin/console cache:clear?. Then it could be that you have a mismatch of the environment variables between the shell and php-fpm.. Can you try to do:\ndocker-compose build\ndocker-compose up -d\nand let us know whether that resolves the problem?. > RUN mkdir -p /usr/local/etc/varnish\nNo, that's not it. But I think it's due to the lack of versioning of our pre-built Docker images.. @dunglas Yet another case of issue with the zip archive. We really should warn against using it.. We should update the docs to say download the .tar.gz. Unfortunately, .zip files are really hit or miss when it comes to file permissions (seems like it might depend on the archiver program you use).. It was a problem with the Symfony recipe for the Validator component. It's been fixed in https://github.com/symfony/recipes/pull/445. I think this kind of stuff could be easily added in your own project. It's not something I think is important enough to have out of the box.. That doesn't seem right. Why have both setReviews and addReview? :laughing:. You should not have an endpoint like /register, it's not RESTful.. The error you're seeing comes from the Symfony Validator, but I think it's not really helpful in debugging. The problem is probably somewhere else.. I agree that this is a design problem. Ideally it should be something like:\n\nDeserialize to DTO.\nValidate DTO.\nMap from DTO to domain model.\nValidate domain model.\n\nAnd everything will be correct? But \"we want RAD\", so...\nWith a single model that's used for both purposes, what you end up with is a ton of compromises, among which is not being able to use proper type hints everywhere.. Sorry, that was a bit off topic.\nFor a RAD use case, perhaps we should look forward to https://github.com/symfony/symfony/pull/27735\nOnce we have that, we should ship with disable_type_enforcement out of the box. (How?). Duplicate of #773. Fixed in f3e5091. @mrkisch Can you also update symfony/http-foundation to 4.1.3? (to fix a security vulnerability). Merged in f3e5091. @Larzack We could add a docs entry for this. Duplicate of #782 and api-platform/docs#551. Did you verify that PHP-FPM in the php container is already listening?\ndocker-compose logs -f php. To debug, use varnishlog together with the X-Varnish response header.. It should be docker-ignored, because the directory should not be copied from your project directory. .dockerignore should have no effect on COPY --from: https://github.com/moby/moby/issues/33923. I can confirm that the files are there. How to test:\nconsole\ndocker-compose pull\ndocker-compose run --rm --no-deps api ls -la public/bundles/apiplatform. Uhh @vbourdeix, since you speak of Dockerfile.nginx, you must be using a setup that is a little old. :smile:. It was already fixed in https://github.com/api-platform/api-platform/commit/f3e50910f2c204209d7b9db3ad280a11cd8deecf (just released in v2.3.1 :tada:). Use git clone instead of the zip file.. Anyway, the log you've shared is incomplete (it doesn't show the actual error message).\nAnd I wonder why it's trying to build instead of just pulling the images when you do docker-compose up -d. It was already fixed in https://github.com/api-platform/api-platform/commit/f3e50910f2c204209d7b9db3ad280a11cd8deecf (just released in v2.3.1 :tada:). > I solved this error changing the file: php/Dockerfile line 30:\n\nfrom docker-php-ext-install -j$(nproc) \\\nto docker-php-ext-install -j \"$(getconf _NPROCESSORS_ONLN)\" \\\n\nThis is weird... nproc should be available as it's provided by busybox.. Hmm... Indeed it's tricky. I thought we could safely strip cookies since we're a stateless API, but then cookies could still be used in a stateless way (for example as a storage and transport for JWT).. Could add a mention in the docs somewhere, perhaps?. It's an issue with the upstream nginx Docker image tags.... Also -1 for changing it.. We'll not change it. Feel free to open a PR for the docs. :smile:. > Humm... I'm not sure about the filter. This means we will never get the null values.\nIf you asked to filter by a property, and it doesn't match, then the item should not be in the results.\nThe behaviour is correct.. Don't forget the changes to the Helm part too.... Thanks @slipo! :tada:. > The only thing that helped was disabling xdebug extension completely, but that is a no go for development.\nWe can't do anything about that. xdebug is known to have a major performance impact. If you really need to use it, you have to accept that performance penalty.. Not a debugger, but I just use psysh via https://github.com/theofidry/PsyshBundle. Indeed, it's how PHP processes the query parameters. There's nothing we could do about it if the original information is lost.. Just catching my own mistake. :rofl:. I'd say name them php.dev.ini and php.prod.ini. WDYT?. Uhh, okay, those files are from ~the Docker official PHP image~ PHP itself.. ~~I think we should ship our own config files instead of using those from upstream.~~ Not maintainable.. Thanks @Lctrs! :tada:. You can return HTTP 202 status code: https://tools.ietf.org/html/rfc7231#section-6.3.3\n\n6.3.3.  202 Accepted\nThe 202 (Accepted) status code indicates that the request has been\n   accepted for processing, but the processing has not been completed.\n   The request might or might not eventually be acted upon, as it might\n   be disallowed when processing actually takes place.  There is no\n   facility in HTTP for re-sending a status code from an asynchronous\n   operation.\nThe 202 response is intentionally noncommittal.  Its purpose is to\n   allow a server to accept a request for some other process (perhaps a\n   batch-oriented process that is only run once per day) without\n   requiring that the user agent's connection to the server persist\n   until the process is completed.  The representation sent with this\n   response ought to describe the request's current status and point to\n   (or embed) a status monitor that can provide the user with an\n   estimate of when the request will be fulfilled.. Isn't Mercure overkill though? :see_no_evil:. The actual error is here:\n\nERROR: Failed to create /usr/lib/libc.a: I/O error\nERROR: musl-dev-1.1.19-r10: IO ERROR\nAnyway, it seems like a problem on your machine. Did you run out of disk space?\n(It'd be better next time if you copy and paste the text in a code block, or as a GitHub Gist. Cheers.). Duplicate of #751. Pro tip: Just use our Docker Compose setup.. shell\ndocker-compose down php\ndocker-compose up php. The logs are / should be written to stderr. Is that not the case for you?. The recommended way to download this distribution is by the .tar.gz file.. Actually, I think we should remove the handling of both php and bin/console from the entrypoint script. It's counter intuitive in actual usage.. What you're looking for is fastcgi_buffer_size and friends.\nThis guide seems helpful: https://gist.github.com/magnetikonline/11312172. I think we could probably ship with a better default out of the box. :smile:. Hmm... Actually, I think the default value is fine, until your API starts to grow larger and more complex. We should add this in the docs then.. > Wouldn't that mean the header tag value could grow infinitely and that we'd still be at risk of hitting the configured header length limit at some stage?\nIt'd be another good incentive to have smaller requests. :smile:. Rebased.. I don't see the problem. You need to provide more information. :smile:. Please refer to the Doctrine documentation: https://www.doctrine-project.org/projects/doctrine-dbal/en/2.8/reference/types.html#blob\nYou'd get either a stream or null.\nBut of course the column is NOT NULL as nullable is false by default: https://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/annotations-reference.html#column\nIt seems like you have a null value in that property for some reason? (It's not supposed to be null, as mentioned above.). > should return list that contains User objects which are the representations of 'friends' of requested user and all users that have this user as a friend.\nIsn't \"friends\" a necessarily mutual relationship?. There is no easy solution to something like this. Once you create a project based on this project (think of it as a template), it's your code now. Anything could change in this project (and in your project), so there's no generic way of providing updates.. I think the cleanest way is to send 1 request each, with the relevant filter applied, but set the itemsPerPage to 0.. > Unfortunately that would result in about 25-50 requests every time the user opens the page, and then again every time they change one filter setting.\nNothing stops you from doing some aggregation on the server (not API).. Basically, a proxy that aggregates by sending multiple HTTP requests.\nI think that's the solution with the least maintenance overhead, and the performance should be acceptable, especially with caching.. Did you find a solution for this? It'd be good to comment so that others who encounter the same problem in the future can benefit. :smile:. Hmm... I've noticed that the documentation uses 2 different namespaces (bar and baz), so I think that's wrong.\nDid you use your own namespace? :). @dunglas:\n\nintrofuce a new context option: use_api_platform\n\nWhat's the actual issue here?. > the ItemNormalizer might be called even though:\n\n\nit's not a resource class (accepts anything since beta-2)\n\n\nI'm clearly not caught up on things. But, :scream_cat:\nMaybe that's not such a good idea.... Thanks @Lctrs!. The relevant exception is here:\n\nSymfony\\Component\\Routing\\Exception\\InvalidParameterException(code: 0): Parameter \\\"id\\\" for route \\\"api_plantcards_get_item\\\" must match \\\"[^/\\.]++\\\" (\\\"\\\" given) to generate a corresponding URL.\n\nI'm not sure what's going on but we can't get the id.. Duplicate of https://github.com/api-platform/core/issues/2154\nThe short answer is: No.\nIf we are going to add such a feature, we'll have to figure out how to convey the correct semantics. (How do you tell when a relation contains only matching items?). Looks like we could use curl --fail. There's not enough information provided, so I can't tell what's going on.\nIt'd be great if you could give us an example project? :smile:. Uhh... $agent_id might be the problem here. I'm not sure if the identifier handling is top-notch. @soyuka? (Also, using snake_case property names might be causing a problem with the Symfony PropertyInfo and/or PropertyAccess components.)\nPerhaps you could check the API Platform tab in the Symfony profiler to see what's going on with the metadata. :smile:. @abengtson Did you take a look in the Symfony profiler? :smile:. Please check the API Platform tab. ;). Could you show your Doctrine ORM mapping? Since I don't see it as annotations, I'm guessing you're using XML or YAML.. Then indeed you need custom data persister and data provider. There's no magic! :stuck_out_tongue_closed_eyes:. @gavinlove He's hitting a limit in Apache, not Varnish.. I think it might be this one:\nParameter | Default | Description\n-- | -- | --\nresponsefieldsize | 8192 | Adjust the size of the proxy response field buffer. The buffer size             should be at least the size of the largest expected header size from             a proxied response. Setting the value to 0 will use the system             default of 8192 bytes.         Available in Apache HTTP Server 2.4.34 and later.\nhttps://httpd.apache.org/docs/2.4/mod/mod_proxy.html\nBut I've no idea how it should be set when using SetHandler (like in the Symfony docs). This is from my Dockerfile:\nDockerfile\nRUN apt-get update \\\n    && apt-get install -y --no-install-recommends \\\n        libicu-dev \\\n        zlib1g-dev \\\n    && rm -rf /var/lib/apt/lists/* \\\n    && docker-php-ext-install \\\n        intl \\\n        mbstring \\\n        pdo_mysql \\\n        zip\nWe definitely don't need mysqli, and pdo is already included.\n. Let's do them in a single RUN command. We don't need so many layers...\n. What do we need libpng-dev for?\n. Good point. Let's leave that out.\np/s: I hope to contribute my Docker Compose setup.\n. It's not very useful if mysql is not included in this Docker setup.\n. This must be a mistake, right?\n. Why the change?\n. I'd rather we don't change things unnecessarily from symfony-standard.\nIn any case, this syntax is actually still wrong anyway (according to PSR-5 draft). See relevant discussion here: https://www.drupal.org/node/2305593\n. Uhh... The increased memory limit is meant for CLI (specifically Composer). We really should have different configuration files for the different SAPIs...\n. Should be addressed by #50, if anyone wants to work on that.\n. Yeah, I know. But that's far from ideal.\n. Just so that we can control the load order (e.g. apcu must be loaded before apc, opcache must be loaded before xdebug...)\n. That section is for PHP extensions. We wouldn't wanna throw everything in together...\n. It's no big deal, really... https://github.com/docker-library/php/blob/27a370a6b7d254dd8726955a5eabd92a7562f32d/7.0/fpm/Dockerfile\n. I agree that the ports should be in the override. But for volumes I only put those that are environment-specific in the override (e.g. mounting src in dev).\n. So I'd actually suggest having docker-compose.override.yml.prod and docker-compose.override.yml.dev\n. I hope we could switch to php:7.0-fpm, and pair it with nginx:1.9-alpine.\n. I think brief usage instructions are warranted here, with links to docs of course.\n. It should work for both dev and prod. That's the kind of setup I have and it works fine.\n. Don't we need --no-scripts here? Because trying to clear cache might fail for so many reasons. What about runtime configuration options, of course most of which are absent at build time?\nFor the same reason I'm not sure we should do cache:warmup here.\n. I'm against this change. This is the docker0 host IP for the default Docker bridge network. The user can customize it, and there is even no guarantee that it'll remain this way (apparently it has changed before - docker/docker#17744).\nMore importantly, I do not believe that the app should be made in such a way that it caters specifically to Docker (or any such environment).\n. We've always made do with local modifications of the file (commenting this check out).\nCoupled with git update-index --skip-worktree web/app_dev.php it works perfectly fine.\n. Clearing the cache is actually plenty quick. It can be done at container startup.\n. We actually do another composer install in the startup script (because of Docker volumes). It completes almost instantly.\n. Better :)\n. Taking a closer look, I see that this is still not a tenable solution, because isset($_SERVER['HTTP_X_FORWARDED_FOR']) will be true for a nginx + php-fpm setup.\nWe should ideally not try to be smart here and just let the user decide for themselves on how to overcome this. A note in the documentation is of course good.\n. In other words, we cannot cater for all the different scenarios. It's worse to have to maintain specific workarounds than just leaving it to the user, like what symfony-standard does.\n. Yes, I think this is a reasonable middle ground for now. But of course we have to be conscious of how much we want to deviate from symfony-standard.\n. I'd prefer that we do not deviate from symfony/symfony-standard unnecessarily.\n. We cannot have a duplicate scripts key. There's already an existing section above with the Symfony scripts.\n. This should be 7.0 as PHP does not follow semver.\n. docker-php-ext-install already calls docker-php-ext-enable, so this is only necessary for the extensions not listed above.\n. I don't see why the excessive indentation.\n. But I propose that we should switch Dockerfile to use tabs, to be consistent with docker-library official images.\n. Wrong indentation.\n. Not necessary as PDO is already included by default.\n. Missing indentation.\n. COPY should be used instead of ADD.\n. May I suggest /srv/app?\n. And same as above, COPY instead of ADD.\n. What is nginx configuration doing in the php-fpm container? Please enlighten me...\n. There is no need to use hardcoded container_name. DNS resolving works just fine with Docker networking.\n. This is also unnecessary.\n. We should use proper versioning. I suggest something like nginx:1.11-alpine.\n. Same here. Versioning is important so perhaps mysql:5.7.\n. expose is redundant when same port number binds to host using ports.\n. I suggest database-data (or nicer, db-data if we rename the mysql service to db).\n. There is no point in running this here, as the same line is already in the Dockerfile. If we run without --no-scripts here, then it'd be desired.\nBut still I'd like to see a more comprehensive composer command with --prefer-dist, at least.\n. I never noticed this, but this is just asking for trouble. Basic Docker fail :stuck_out_tongue:\nexec php-fpm\n. http://php.net/manual/en/pdo.installation.php\n\nPDO and the PDO_SQLITE driver is enabled by default as of PHP 5.1.0. You may need to enable the PDO driver for your database of choice; consult the documentation for database-specific PDO drivers to find out more about that.\n. As mentioned, pdo is unnecessary here.\n. It'd be good if we can avoid blindly copying the entire directory. Hmm...\n. Why is dns_search necessary?\n. It'd be good to sort the keys (services) alphabetically.\n. It'd be good to sort the keys (options) alphabetically.\n. db-data: {}\n. Perhaps:\n\napp_error.log\napp_access.log\n. I suggest removing this file.\n. Logs aggregation is a complicated topic. I think (without a proper logging setup which involves Docker logging drivers and more) logging to stdout is not very useful when it becomes interleaved with the output from all the other logs, especially the access log which can quickly go to thousands of lines.\nPersonally I just use a volume, since I haven't put in the required effort to set up logging properly.\n. I think we should copy folder by folder. .dockerignore is only useful to exclude things that we never want to be included in the build context (e.g. Dockerfile, docker-compose.yml, .git, .gitignore). We do not want to give the users surprises when they want to copy test-related files in a development environment, for example.\n. @jockos You have not addressed this comment. :smile:\n. Should be tab here.\n. Is this necessary? I have not had the need to use it in our project. But please enlighten me...\n. And this too...\n. The service name is automatically aliased in the built-in DNS for the Docker network. It has been working for me since a long time ago (I forgot when it was added), so make sure you're using a recent version of Docker and Docker Compose...\n. Please don't ignore everything... :cry:\nWe do not want surprises for the user. Let's just use a blacklist. (I don't think you need to change much from the existing .dockerignore)\n. Can we copy what we need into the container instead of having the ./docker directory copied into the image too? (Totally unnecessary...)\n. Instead of copying everything, we can be more selective:\n``` Dockerfile\nafter \"Install composer\" section\nWORKDIR /srv/app\nCOPY composer.json ./\nCOPY composer.lock ./\nRUN composer install --prefer-dist --no-dev --no-autoloader --no-scripts --no-progress --no-suggest\nCOPY app app/\nCOPY bin/console bin/\nCOPY src src/\nCOPY web web/\nCOPY docker/php/start.sh /\nCOPY docker/php/update-acl.sh /\nCMD [\"/start.sh\"]\n```\n. We don't need this section if we make sure the directories are mounted as volumes (even in production, yes - for performance reasons).\nIn any case, fixing of permissions (if necessary) should happen at container start, not in the image.\n. Contents of update-acl.sh:\n``` bash\n!/bin/bash\nset -e\nsetfacl -R -m u:www-data:rwX -m u:whoami:rwX var\nsetfacl -dR -m u:www-data:rwX -m u:whoami:rwX var\n```\n(this should be called from start.sh)\n. @api-platform/core-team We should have a docker-compose.override.yml file. But the problem is that we need to have different templates (.dist files) for different environments, which means the initial setup needs a preparatory step.\n. Please use this file as docker/php/start.sh and remove docker/php/run.sh\n. To me one of the appeals of Docker is that I can use (almost) the same setup for both development and production. But I understand that there's no one-size-fits-all solution, and for a \"Standard Edition\" like what we have here, we may want to target development only.. Yes, we can do:\nsh\ndocker-compose up -d php\ndocker-compose exec php composer install -o -n\n.... @jockos I forgot to mention that those need to be made into volumes.. @vincentchalamon:\n\nWhy not simply use apipltfrm/demo in docker-compose.yml file instead? The image should be the same, isn't it?\n\nI don't think they should be the same.. Data containers is an outdated pattern. Do not use that.\nYes, I meant adding VOLUME instructions.. @webda2l If we use the alpine variant, we might run into problems with third-party tools (e.g. blackfire - but probably they've fixed that after my report last time). Compatibility could be an issue...\nI understand the appeal though, considering the big difference in image size.. This is wrong... :joy:\nDockerfile\nCOPY composer.json ./\nCOPY composer.lock ./. Same here...\nDockerfile\nCOPY app app/\nCOPY bin/console bin/\nCOPY src src/\nCOPY web web/. And here...\nDockerfile\nCOPY docker/php/start.sh /\nCOPY docker/php/update-acl.sh /. We add the VOLUME instructions last (to preserve changes from any previous steps):\nDockerfile\nVOLUME /srv/app/var\nVOLUME /srv/app/var/cache\nVOLUME /srv/app/var/logs\nVOLUME /srv/app/var/sessions\nVOLUME /srv/app/vendor. As an alternative, we can add all these volumes in the docker-compose.yml\nI'm not sure which is the better / more correct way.. We should do a composer install here:\nDockerfile\nRUN composer install --prefer-dist --no-dev --no-autoloader --no-scripts --no-progress --no-suggest \\\n    && composer clear-cache. We should clear the composer cache at the end:\nDockerfile\nRUN ... \\\n    && ... \\\n    && composer clear-cache. This is a very wrong approach. :disappointed:. It's not Docker that does not support ACL, but the underlying filesystem. If you mean AUFS, yes, it does not support ACL. Mounting volumes works around the problem (that's what I do).\nBut of course on Mac there's an additional hurdle in the form of osxfs (the filesystem provided by Docker for Mac).. I don't think we should include restart: always. That should be something for the user to decide.. We do composer install before copying over project files in order to properly utilize caching of Docker image layers. Otherwise any single change in the project files would cause a rebuild.. Don't we have to do the same for all other .sh files?. I do not recommend running composer install after copying all project files. It completely destroys caching whenever any file is changed.. I'm still against copying everything blindly.. One per line please, and sorted alphabetically.. The standard pattern is:\nDockerfile\n    apk add --no-cache --virtual .build-deps \\\nAlso, please do a separate apk add for .run-deps.. Use tabs for Dockerfile and shell scripts, following CS of Docker official images.. This is what I'd suggest:\n```Dockerfile\nWORKDIR /srv/app\nCOPY composer.json ./\nCOPY composer.lock ./\nRUN composer install --prefer-dist --no-dev --no-autoloader --no-scripts --no-progress --no-suggest \\\n    && composer clear-cache\nCOPY app app/\nCOPY bin bin/\nCOPY src src/\nCOPY web web/\n``. Suggest alphabetical sorting.. This is wrong. An ENTRYPOINT script is different from the start / CMD script.. @dunglas We do not want cache to be included in the layers of a Docker image (it becomes bloated). So the practice is to always clear cache after use (in the same RUN).. I think the golden rule is for the image to be ready to run on container start. We need to strike the right balance, of course.. One package per line minimizes git diffs (helps to better track changes across commits)... And it's also easier to read. Well, the point is it's the CS for Docker official images, and there's no downside to it.. I think this is missingsu-exec www-data ...`?. I think \"not dev\" would be better.. Shouldn't this section remain commented out? The user needs to make a conscious decision here.. (I do not agree that this is okay to be uncommented just because that's what we have in our recommended Docker setup - as it leads to unwanted surprises - but...)\nActually, I thought our policy is to stick as close to Symfony Standard as possible?\nIf so, we should follow: https://github.com/symfony/symfony-standard/blob/v3.2.2/composer.json#L21 (symfony/symfony-standard#974)\nProbably this file should be changed in Symfony Standard as well.. I suggest we use /srv/app.. https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/#/sort-multi-line-arguments. See my reply here: https://github.com/api-platform/api-platform/pull/224#discussion_r98375924. http://refspecs.linuxfoundation.org/FHS_3.0/fhs-3.0.html#srvDataForServicesProvidedBySystem. Any reason why we're still using docker-compose run here instead of docker-compose up -d + docker-compose exec?. Please use this snippet instead:\n```Dockerfile\nRUN apk add --no-cache --virtual .run-deps \\\n        git \\\n        icu-libs \\\n        su-exec \\\n        zlib\nENV APCU_VERSION 5.1.8\nRUN set -xe \\\n    && apk add --no-cache --virtual .build-deps \\\n        $PHPIZE_DEPS \\\n        icu-dev \\\n        zlib-dev \\\n    && docker-php-ext-install \\\n        intl \\\n        mbstring \\\n        pdo_mysql \\\n        zip \\\n    && pecl install \\\n        apcu-${APCU_VERSION} \\\n    && docker-php-ext-enable --ini-name 20-apcu.ini apcu \\\n    && docker-php-ext-enable --ini-name 05-opcache.ini opcache \\\n    && apk del .build-deps\n``. @soyuka.dockerignore` is not meant to be abused like that. We should only add what we need to the image. It should be explicit. :)\n@jockos Please ignore this comment. It's a reply to a previous comment. GitHub sucks.... This is wrong. We wouldn't want to pollute the working directory. It should be changed to:\nDockerfile\nCOPY docker/composer.sh /usr/local/bin/docker-app-install-composer. Following the new convention (e.g. https://github.com/docker-library/php/blob/fe1ff7ee08861f85cd1c61b54c53550435f4b915/7.1/fpm/alpine/Dockerfile#L140), I think this should be changed to:\nDockerfile\nCOPY docker/php/start.sh /usr/local/bin/docker-app-start. This line does nothing useful and can be removed. :). @soyuka This is just giving the volume a name. :smile: The official MySQL image already uses a VOLUME instruction for the data directory.\nBut @jockos I'd match the name of the service, so \"database-data\". Since it was decided(?) not to rename it to the shorter / more convenient \"db\".... What Symfony uses does not affect / should not inform how we name Docker Compose services. :smile:. https://docs.docker.com/engine/tutorials/dockervolumes/#/creating-and-mounting-a-data-volume-container\nThe Docker documentation recommends using data volume containers, but it's outdated. Named data volumes should be used instead. See https://github.com/docker/docker/issues/20465\nI think we should keep this.. Oops... Double tabs.. Rename docker/composer.sh to docker/php/composer.sh to be consistent. :). Just combine this into the same visual block of instructions above, and sort alphabetically.. Dockerfile\nRUN chmod +x \\\n    /usr/local/bin/docker-app-install-composer \\\n    /usr/local/bin/docker-app-start. This should be /usr/local/bin/composer\nhttps://getcomposer.org/doc/00-intro.md#globally. Dockerfile\nRUN mkdir -p \\\n    var/cache \\\n    var/logs \\\n    var/sessions. There is no reason why nginx needs access to the entire project directory. I suggest we change in composer.json:\njson\n{\n    ...\n    \"extra\": {\n        ...\n        \"symfony-assets-install\": \"hard\",\n        ...\n    }\n    ...\n}\nand mount the web directory only.. Let's add back the named volume as discussed in https://github.com/api-platform/api-platform/pull/162#discussion_r100718173. We've got the best of both worlds now. :smile:. I synced this file with the latest snippet from https://getcomposer.org/doc/faqs/how-to-install-composer-programmatically.md. We don't have wget in the container. It's the wget from BusyBox. :smile:\nI don't think this is something important enough worth diverging from the official install script for.... Yes please.. We should use a custom header like X-Reverse-Proxy-TTL instead of abusing s-max-age.. I'd put services first because that's the norm. See various examples on https://docs.docker.com/compose/compose-file/. Why did you change the naming convention? Again, if you refer to https://docs.docker.com/compose/compose-file/ the dash seems to be preferred (because underscore is used for prefixing of container/volume/network names).. This is quite unnecessary because it's the default. If you have set a different default storage driver, you can always add this yourself.. Sort the keys by alphabetical order.\nAlso, it doesn't seem to be the norm to over-quote in the Docker Compose file (only use quotes when necessary).. Please base this on https://github.com/docker-library/healthcheck/blob/master/mysql/docker-healthcheck\nAlso, the command(s) shouldn't be inlined in the Docker Compose file. :smile:\nThe other options (interval, timeout, retries) should be left to their defaults. Let the user customize those as they see fit.. Actually, the single volume mount only makes sense for development. Since we don't have separate distribution files for dev and prod, I prefer that we keep it as is to serve as guidance.. This is not supported in Docker Compose v3 file format, and thus should be avoided.. volumes_from is not supported in Docker Compose v3 file format, so it should not be used.. This is not supported in Docker Compose v3 file format, and thus should be avoided.. > If you want the keys sorted that way, sure. This isn't the norm though.\nYeah, I don't think there's any norm when it comes to the ordering of keys, and in the absence of any order-sensitive items (are there any?), alphabetical order seems the most sensible. Previously the services are also sorted alphabetically by name, please follow that.. > Over-quoting is to remove confusion from newcomers to YAML who don't understand how crazy the semantics are\nI understand, but as @dunglas said we try to follow the conventions of official sources. The merits of YAML is out of scope of this discussion.. v3 has been stable for a while now. v3.2 is the latest (stable) file format. Whether we like Swarm Mode or not, that's a separate discussion that we do not need to be having here. By avoiding what's not supported in v3, we ensure forward compatibility.. It'd be great if the editors can have better support then... (That affects all YAML, right? So I'd think it's an important feature to support, considering the popularity of YAML.)\nI prefer if we stick to conventions from official sources.. > why would we use a volume before it's defined?\ndocker-compose up (or docker stack deploy) takes care of the order of creation, so we really don't need to concern ourselves with that. I think the main argument for putting services on top is because it's the \"main\" top-level key. The other top-level keys (e.g. volumes, networks) define things used by the services.. Hmm... That's weird because a similar healthcheck script utilizing environment variables has been working for me: https://github.com/docker-library/healthcheck/blob/master/postgres/docker-healthcheck\nProbably the bug you fixed only affected inline commands.. Yes, I suggest we leave a comment for the user to comment out these sub-directory volumes if they are running on Linux, where there are no such performance issues.. Oops... :smile:. We'd have to run the db service for this to work, no? Maybe we can run this with --dump-sql?. Uhh... I thought it was single-quote-everything (values) :laughing:. This is unnecessary. That's why I removed it.. > It allows to have them both in files and in stdout/stderr thanks to a trick in the official Nginx image.\nThat's not true. They are symlinked to stdout and stderr respectively.. Good catch! I should have actually tried running it!. Can't this be ^3.3?. Why this change? Doesn't it cause performance problems on Mac OS, at least?. Why this change? nginx has no business writing anything into this directory.... We must not set an incorrect s-max-age. It's 100% dangerous. If the user needs to do that for CloudFlare, they should set it themselves (or we should provide some easy way of setting it).. I use https://github.com/nigoroll/libvmod-dynamic.. Alright. I see that the default configuration doesn't set maxage and s-maxage, so we're safe. :smile:\nhttps://github.com/api-platform/core/blob/9fa028903d1df02011c2b75504b87d1e975e7b70/src/Bridge/Symfony/Bundle/DependencyInjection/Configuration.php#L123. But we provide an unsafe default in api-platform/api-platform. A good default is a safe default. :disappointed:\nhttps://github.com/api-platform/api-platform/blob/ddb4e77e78a32739ed41355f24411952cf954c98/app/config/config.yml#L89. So my suggestion is that we should use a custom header, e.g. Reverse-Proxy-TTL\nSimply because the HTTP cache mechanism is not designed with reverse caching proxies in mind, so it's not the right tool for the job.. If CloudFlare uses s-maxage, let the user change the shared_max_age option that we already provide in the bundle config. It's not a safe default, and the default setup in api-platform/api-platform uses Varnish anyway, not CloudFlare.. api_filters.yml?. I think it's clearer to the user what are API filters, as opposed to just filters (which could be Twig filters or whatever...). I know this is a shortcut, but I think naming services like this is not sensible.\nIt'd be better if we name the service properly, at least foo.search_filter would be better. (I'd prefer a more verbose and properly namespaced app.resource.foo.search_filter, but that's just me.). yaml\n    tags: [api_platform.filter]\nwould do.. I've just tried with:\nyaml\nvolumes:\n  - .:/srv/api-platform:rw\n  - /srv/api-platform/var\ndocker info:\n```\nContainers: 10\n Running: 10\n Paused: 0\n Stopped: 0\nImages: 202\nServer Version: 17.05.0-ce\nStorage Driver: overlay2\n Backing Filesystem: extfs\n Supports d_type: true\n Native Overlay Diff: true\nLogging Driver: json-file\nCgroup Driver: cgroupfs\nPlugins: \n Volume: local\n Network: bridge host macvlan null overlay\nSwarm: active\n NodeID: j0bscfxu5pwuhjs2uqa37tlze\n Is Manager: true\n ClusterID: y9d829wmrr8vg2pso3yaptb2i\n Managers: 1\n Nodes: 1\n Orchestration:\n  Task History Retention Limit: 5\n Raft:\n  Snapshot Interval: 10000\n  Number of Old Snapshots to Retain: 0\n  Heartbeat Tick: 1\n  Election Tick: 3\n Dispatcher:\n  Heartbeat Period: 5 seconds\n CA Configuration:\n  Expiry Duration: 3 months\n Node Address: 192.168.1.114\n Manager Addresses:\n  192.168.1.114:2377\nRuntimes: runc\nDefault Runtime: runc\nInit Binary: docker-init\ncontainerd version: 9048e5e50717ea4497b757314bad98ea3763c145\nrunc version: 9c2d8d184e5da67c95d601382adf14862e4f2228\ninit version: 949e6fa\nSecurity Options:\n apparmor\n seccomp\n  Profile: default\nKernel Version: 4.10.0-24-generic\nOperating System: Ubuntu 17.04\nOSType: linux\nArchitecture: x86_64\nCPUs: 4\nTotal Memory: 7.706GiB\nName: YOGA\nID: M77W:GFMI:MAJO:7JRJ:4Z7V:3ZV2:MQDT:XKEB:LBIJ:6SIU:PKCU:2354\nDocker Root Dir: /var/lib/docker\nDebug Mode (client): false\nDebug Mode (server): false\nUsername: teohhanhui\nRegistry: https://index.docker.io/v1/\nExperimental: false\nInsecure Registries:\n 127.0.0.0/8\nLive Restore Enabled: false\nWARNING: No swap limit support\n```\nAnd I can confirm that it works as expected (var directory overrides the bind-mount from host).. Yes, better to open an issue in one of the Docker repositories then (if there isn't already one).... I can confirm it doesn't do any harm. So yeah, go ahead. :+1:. Oh, but I still have my reservations about this change. Because I'd like to see documentation supporting that this is actually safe to do... (It might work fine for now, but we need a guarantee.). Keep this at the bottom for readability. No reason to have it nearer to the top.. @dunglas Please note the use of SYMFONY_SKIP_REGISTRATION. No more warnings about composer.lock being outdated. :smile:. But it will still happen when the user does the composer install. :disappointed:\nhttps://github.com/symfony/flex/issues/316. The rationale for adding this: The built image no longer has a randomly generated Symfony project ID. This prepares us to tag and push a pre-built image to a Docker registry.\nWhen the user runs any composer command, the Symfony project ID will still be generated. (Or on container startup except when APP_ENV=prod since we would run a composer install.). Using 2 spaces following official examples.. Using 2 spaces following official examples.. Use the name docker-compose.yml which is more commonly referred to in official documentation and examples. (Yes, I know it says that docker-compose.yaml also works...). If it's our own YAML file, sure. But this is for Docker Compose. We've decided to stick to upstream conventions, right?. Yes, we need to, for conditional deployment. Only on the main repository (api-platform/api-platform) and the master branch.. Well, of course we could do it either way but sticking to upstream conventions means it's easier to copy and paste from official examples. And to me consistency with other projects is always good. It means if you've worked with Docker Compose before you're already familiar with the spacing.. If we really need to switch to Docker Hub later on, it's a very easy switch anyway.. Workaround for https://github.com/moby/moby/issues/9547 :smiley:. So that we have to change it in multiple places instead of one, and it can't be overridden by an environment variable? I don't think that's a good idea.. I've just tried it. It makes no difference. Git calculates that dynamically, ~~and git log docker-compose.yml is able to connect the dots just fine in this case~~ (and GitHub fails to do the same, even if I put the rename into a separate commit). :smile:\nEDIT: Actually, no, even with the separate commit, git log docker-compose.yml also fails to link them up. But it helps git log --follow figure it out, so yeah.... This is just in case we decide to run some bin/console commands in the same RUN. :laughing:. I've adapted this from https://github.com/tripviss/docker-varnish. This means we copy installed assets too. So the nginx image is now more production ready. Yay! :smile:. Because the default is 6081. There's no need for us to change it.. No, it doesn't make any difference in a Docker context. And they only suggest using 80 because that's the standard HTTP port. It's only relevant when you're using Varnish in front.. I don't see what's the point of changing it to port 80 when the upstream default is 6081. And that's what people would be familiar with / expect it to be. It's just like port 3000 for an Express.js app. We could of course use port 80. But that'd go against the conventions.\nBut anyway, if it breaks but our build is still green, then we need to add more tests to the build? :). What do you mean? The images are built by Docker. Kubernetes has nothing to do with it?. Uhh... But I don't think we should let that stop us from using the new features.. A sensible default? Since the postgresql chart also defaults to persistence enabled.. This should make it easier to deploy since we have the built images in the repositories now.. @dunglas Is it a good idea to bump the version here?. @dunglas Is it a good idea to check this in? Why or why not?. But we already use it for composer?. No, this is the version of the Helm chart, not the version of PostgreSQL. :smile:. If we want to encourage using a managed RDBMS, then the right way is to set\nyaml\npostgresql:\n  enabled: false\ninstead of having the postgresql service being deployed by default without data persistence (really bad!). We no longer need the ALPINE_VERSION here since https://github.com/docker-library/php/pull/650 :tada:. postgres:// protocol is our best bet.\nhttps://www.doctrine-project.org/projects/doctrine-dbal/en/2.7/reference/configuration.html#connecting-using-a-url\nhttps://www.postgresql.org/docs/9.6/static/libpq-connect.html#LIBPQ-CONNSTRING\nhttps://devcenter.heroku.com/articles/heroku-postgresql. It seems using the same name as a built-in action throws an error since Varnish 6.0. Are we finally ready for setfacl? I hope we are. Testers needed for Mac OS and Windows.. https://html.spec.whatwg.org/#attr-hx-align\n\nalign on h1\u2014h6 elements\nUse CSS instead.. Uhh... \ud83d\ude48. Use the same `cache_from` for the different images built out of the same `Dockerfile`, because:\n\n\n\nThis way we'll reuse the cache regardless of the build order (of the different images, not of the stages).\n\nIt has no negative effects. It works.. Can we rename it to something like api-platform.ini?. I think we could just use a symlink?. I think this has to be done both ways, to present least surprises. Imagine if the user switches between APP_ENV=dev and APP_ENV=prod on local.. Also, I think this should be moved into the if [ \"$1\" = 'php-fpm' ] || [ \"$1\" = 'bin/console' ]; then block below.. Because naming something using the container name inside the container gives no useful information. :laughing:. Yeah... But the entrypoint scripts for the Docker official images do not do anything for \"other\" commands. Indeed, you could never be able to handle everything. So what we care about here are only:\n\n\nphp-fpm\n\nphp (should be added?)\nbin/console. Because this uses the Doctrine DBAL, it means that it works with any supported database. Also, it removes the dependency on postgresql-client.\n\n\nIt will slower and consume more resources (it can matter in high availability infrastructures)\n\nShould we do some benchmarks?. The cache should be already pre-warmed in prod environment so there is no overhead there. As for bootstrapping, I can't say for sure how much difference it makes.\npostgresql-client (psql and friends) is already available in the db container. :smile:. Hmm... Then one can easily install it, if actually necessary. It definitely should not come with it out of the box.. ",
    "csarrazi": "Yup. You should use @AssociationOverride, to specify the correct table name.\n. ",
    "suryacaprice": "@dunglas docker-compose exec app vendor/bin/schema in this command i always get the error app does not exist .\nhow to generate from yaml file ? can you post a video on youtube so that it will be a quick stat for every on on how to generate a ORM model\n. User:\n  type: entity\n  id:\n    id:\n      type: integer\n      generator:\n        strategy: AUTO\n  fields:\n    name:\n      type: string\n      length: 255\n      nullable: true\n    email:\n      type: string\n      length: 255\n      nullable: true\n    contact_number:\n      type: integer\n      length: 10\n      nullable: true\ndocker-compose exec app vendor/bin/schema\nERROR: No such service: app\n. I am using 2.2.1 .. you want me to go down to 2.2.0 . Is there any major changes in 2.2.1 thats not in 2.2.0 ?. docker-compose exec php vendor/bin/schema\nOCI runtime exec failed: exec failed: container_linux.go:348: starting container process caused \"exec: \\\"vendor/bin/schema\\\": stat vendor/bin/schema: no such file or directory\": unknown\n. Creating demo_admin_1       ... done\nCreating demo_client_1      ... done\ner-compose buildordocker-compose up --build`.\nCreating demo_php_1         ... done\nCreating demo_admin_1       ...\nCreating demo_api_1         ... done\nCreating demo_php_1         ...\nCreating demo_cache-proxy_1 ... done\nCreating demo_cache-proxy_1 ...\nCreating demo_h2-proxy_1    ... done\nAttaching to demo_client_1, demo_db_1, demo_admin_1, demo_php_1, demo_api_1, demo_cache-proxy_1, demo_h2-proxy_1\nclient_1       | yarn run v1.3.2\nclient_1       | error Couldn't find a package.json file in \"/usr/src/client\"\ndb_1           | The files belonging to this database system will be owned by user \"postgres\".\nclient_1       | info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.\ndb_1           | This user must also own the server process.\nadmin_1        | yarn run v1.3.2\ndb_1           |\ndb_1           | The database cluster will be initialized with locale \"en_US.utf8\".\nadmin_1        | error Couldn't find a package.json file in \"/usr/src/admin\"\nphp_1          | standard_init_linux.go:195: exec user process caused \"no such file or directory\"\ndb_1           | The default database encoding has accordingly been set to \"UTF8\".\napi_1          | 2018/02/22 09:10:10 [emerg] 1#1: host not found in upstream \"php\" in /etc/nginx/conf.d/default.conf:11\ndb_1           | The default text search configuration will be set to \"english\".\napi_1          | nginx: [emerg] host not found in upstream \"php\" in /etc/nginx/conf.d/default.conf:11\nadmin_1        | info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.\ndb_1           |\ndb_1           | Data page checksums are disabled.\ncache-proxy_1  | standard_init_linux.go:195: exec user process caused \"no such file or directory\"\ndb_1           |\nh2-proxy_1     | 2018/02/22 09:10:24 [emerg] 1#1: host not found in upstream \"client\" in /etc/nginx/conf.d/default.conf:9\ndb_1           | fixing permissions on existing directory /var/lib/postgresql/data ... ok\nh2-proxy_1     | nginx: [emerg] host not found in upstream \"client\" in /etc/nginx/conf.d/default.conf:9\ndb_1           | creating subdirectories ... ok\ndb_1           | selecting default max_connections ... 100\ndb_1           | selecting default shared_buffers ... 128MB\ndb_1           | selecting dynamic shared memory implementation ... posix\ndb_1           | creating configuration files ... ok\ndb_1           | running bootstrap script ... ok\ndb_1           | performing post-bootstrap initialization ... sh: locale: not found\ndemo_client_1 exited with code 1\ndb_1           | No usable system locales were found.\ndb_1           | Use the option \"--debug\" to see details.\ndemo_api_1 exited with code 1\ndemo_php_1 exited with code 1\ndemo_admin_1 exited with code 1\ndemo_cache-proxy_1 exited with code 1\ndemo_h2-proxy_1 exited with code 1\ndb_1           | ok\ndb_1           | syncing data to disk ...\ndb_1           | WARNING: enabling \"trust\" authentication for local connections\ndb_1           | You can change this by editing pg_hba.conf or using the option -A, or\ndb_1           | --auth-local and --auth-host, the next time you run initdb.\ndb_1           | ok\ndb_1           |\ndb_1           | Success. You can now start the database server using:\ndb_1           |\ndb_1           |     pg_ctl -D /var/lib/postgresql/data -l logfile start\ndb_1           |\ndb_1           | waiting for server to start....LOG:  could not bind IPv6 socket: Address not available\ndb_1           | HINT:  Is another postmaster already running on port 5432? If not, wait a few seconds and retry.\ndb_1           | LOG:  database system was shut down at 2018-02-22 09:10:09 UTC\ndb_1           | LOG:  MultiXact member wraparound protections are now enabled\ndb_1           | LOG:  database system is ready to accept connections\ndb_1           | LOG:  autovacuum launcher started\ndb_1           |  done\ndb_1           | server started\ndb_1           | CREATE DATABASE\ndb_1           |\ndb_1           | CREATE ROLE\ndb_1           |\ndb_1           |\ndb_1           | /usr/local/bin/docker-entrypoint.sh: ignoring /docker-entrypoint-initdb.d/*\ndb_1           |\ndb_1           | LOG:  received fast shutdown request\ndb_1           | LOG:  aborting any active transactions\ndb_1           | LOG:  autovacuum launcher shutting down\ndb_1           | waiting for server to shut down....LOG:  shutting down\ndb_1           | LOG:  database system is shut down\ndb_1           |  done\ndb_1           | server stopped\ndb_1           |\ndb_1           | PostgreSQL init process complete; ready for start up.\ndb_1           |\ndb_1           | LOG:  database system was shut down at 2018-02-22 09:11:21 UTC\ndb_1           | LOG:  MultiXact member wraparound protections are now enabled\n. same issue here .. i am using docker machine. ",
    "vincentchalamon": "@dunglas Docker container updated running through debian:jessie with PHP 5.6\n. Will be fixed on https://github.com/api-platform/api-platform/pull/49\n. I think a Dockerfile should create an environment and should not execute project commands (like composer or bin/console)\n. Ping @dunglas @sroze \n. > with an absolute minimum of set-up and configuration\nSo no need to execute composer commands on it, right?\n. > By doing as much work as possible during image build, we make the container start as fast (and as simple) as possible\n@teohhanhui You're right on this point. But executing a composer install won't slow down the container start? I mean, according to you (we make the container start as fast as possible), if I delete my container and start it again, it will launch a composer install and my container won't be available till composer finishes.\n. My bad, it will be executed on the image, not in the container :wink: \n. Well, in that case, I could agree with you @teohhanhui by executing a composer install -o --no-scripts, but I will remove the Symfony commands anyway (cache:warmup)\n. @dupuchba I got some exceptions in my Symfony project. As composer scripts will execute some Symfony commands (like cache:clear), I wasn't able to build my container just because of these exceptions\u2026\nAdding --no-scripts will disable composer scripts, so no Symfony commands anymore when building my container. I can finally build it whatever my project have some exceptions or not :)\n. Hi @gorghoa,\n\nMoreover, if the user public ip has overpassed the github unidentified fair use quota, the composer install will fail during the build, since the composer github auth token is not shared during the build.\n\nYou would be happy to know that GitHub dropped its rate limit some days ago :)\n. According to your comments, we keep NelmioAPIDoc as it. I'm closing this PR\n. Sorry @teohhanhui but I didn't validate this PR. IMHO there is still this pending comment (but it's just my opinion)\n. :+1: \nStyleCI should be fixed in a dedicated PR\n. Consider your url as a regular string like any textual value, not as a relation (as it's not one in your Doctrine schema).\n. @teohhanhui Can you update this PR about StyleCI please ?\n. Perfect, thank you very much @Simperfit \n. Duplicate from https://github.com/api-platform/api-platform/pull/57 ?\n. Can you detail why composer install command failed please? Maybe print an output of your error\n. But it can be interesting to use immutable Docker images as @sroze suggested, especially for testing (travis or other CI\u2026)\n. @soyuka The front shouldn't know what fields are allowed to be nullable or not in the API, it just wants to send data to the API and get a response.\nHere is a use case: I have an entity with 2 fields (foo & bar). foo cannot be null, but bar can. What can I send to the API to empty bar value and set it to null if the front cannot send null values to the API?. > If username can not be nullable I don't get what response you expect when you send {username: null}, it's invalid. I'd expect 400 status code.\nThat's also what we expect, but we receive a 500 status code. @daviddlv will paste you the stack trace tomorrow.\n\nAngular version?\n\nv4.1.2. @meyerbaptiste I agree with you about strict typehint, if we don't allow null value on property and setter, PHP cannot understand it. That's why we also tried allowing null values on class property, getter & setter: we still got the same 500 error. Adding nullable=true doctrine option on class property @ORM\\Column annotation fixed it.\n@soyuka In your example, you send undefined, but if you send null the result is different:\n```\n\nJSON.stringify({foo: null, bar: ''})\n'{\"foo\":null,\"bar\":\"\"}'\n``\nI don't know if typescript converts it properly (apparently no cause the API seems to receivenullinstead ofundefined` as property value).. > But if you've null it's that you really want to send null\n\nLike if I want to empty totally a property without sending an empty string? Yes, that should be possible IMO\nSeen with @meyerbaptiste, he explained me the DoctrineExtractor has priority to PhpDocExtractor & ReflectionExtractor. I think it should not, specially about the nullable property option. PHP class should be decorrelated from Doctrine schema.. Duplicate from #960. Done\n. This is the recommendation from StyleCI, maybe @dunglas should adapt its configuration so\n. I think there is no need to increase memory_limit for composer, you can do it like that:\nbash\nphp -d memory_limit=-1 `which composer` install\n. Why this --ini-name option?\n. Should be installed on line 12\n. :+1: \n. But you're doing 2 apt-get update & apt-get install, which can be optimized I think\n. Should be better to keep --rm option, or use exec instead of run, it will prevent useless containers\n. Why not simply use apipltfrm/demo in docker-compose.yml file instead? The image should be the same, isn't it?\n. suggestion\nARG MONGODB_ENABLED=0. suggestion\nENV MONGODB_ENABLED=$MONGODB_ENABLED. suggestion\n        ${MONGODB_ENABLED:+mongodb} \\. suggestion\n        ${MONGODB_ENABLED:+mongodb} \\. suggestion\n    if [ \"$MONGODB_ENABLED\" != 1 ]; then. As migrations don't exist for doctrine mongo (AFAIK), shouldn't we update the mongo database through the doctrine documents? i.e: bin/console odm:schema:update. Didn't you have any auth issue with the official mongo docker image? In another project, I had to switch to bitnami/mongodb:4.1.4 which handles authentication much better:\nyaml\nmongodb:\n  # In production, you may want to use a managed database service\n  image: bitnami/mongodb:4.1.4\n  environment:\n    # You should definitely change the password in production\n    MONGODB_USERNAME: foo\n    MONGODB_PASSWORD: p4ssw0rd\n    MONGODB_DATABASE: bar. This variable is never used (in this project configuration), Symfony will throw an exception cause these environment variables are never used. What is the exception stack trace?. ",
    "dupuchba": "Ok, I will find some time during my holiday next month :-). By the way, you should put this roadmap in some .md file !\n. https://github.com/dunglas/DunglasApiBundle/issues/177\n. Oh ok, so how about php-schemadev dependencies ? and nelmio ?\n. ok, so nothing to do with api-platform ^_^. I was confused by the fact that you wrote Road to 1.0 in api-platform\n. @vincentchalamon I don't understand why adding the --no-scripts. Can you explain plz ?\n. ok, got it. Thx\n. :+1: \n. why that @teohhanhui ?\n. ",
    "MLKiiwy": "Yeah, it's a good roadmap ! \nBut maybe add suggestion : \n4. Decouple from Hydra => Maybe also decouple from Doctrine ? \n. ",
    "npotier": "Hi @dunglas thank you for your amazing work. Do you thing that you could provide an example of your controller ?\n. ",
    "AlexandreHagen": "Now that Symfony 3.1 is released. Do we have some docs or explanations to upload files with Api-platform V2 alpha ?\n. Okey thanks ! I will try with that. For doc, I will see when my upload system will be finished.\n. So if I understand well. We can't upload files through Api-platform 2 ? We still have to create our own controller or use base 64 to do that ? And Symfony 3.1 just provide new tools to handle files thanks to DataUriNormalizer ?\u00a0I think I don't understand something, but I don't know what !\n. Anyone ? A short response please. \n. @dunglas Thanks a lot ! \n. Ok this is linked to hautelook/alice-bundle. So I understand now.\n. Thanks @teohhanhui ! Indeed this one solution ! But how to pass and check the  confirmation_token ? For me, I think that the best solution I will be to have a route like : PUT: /users/{token} It is possible to generate several routes for the same entity ? So have PUT: /users/{token} and PUT: /users/{id} (or POST: /users/{token} and POST: /users)  in same time ?\n. Already I will try that way. Thanks @teohhanhui for your advices.\n. ",
    "Simperfit": "I think this can be closed\n. @napalm33700 WDYM ?\n. You won't need to in the first place since it's done in Docker.\n. @renan-taranto HAL is now implemented in V2.\n. Closing this since it's outdated.\n@karser You can create an issue on api-platform/core or a PR if you want to integrate it ;).\n. @teohhanhui What could we do about this ?\n. As this don't get any feedback, i'm closing here. Maybe we could create a proposal on the core repository ?. @3kynox Since we are in the process of releasing v2, is this still relevant ?\n. Thanks you for the repport.\nBTW schema-generator is no more included by default with V2.\n. This will not be done in core or in standard edition, closing them.\n. @leroy0211 Closing this as this is old. If you want to comment on this please update this issue.\n. Hello, \nIs this issues up to date ?\nCould you please provide an entire example with what you want to do ?\n. Closing since there are no answer\n. Can we close this?. Hey @theofidry,\nWas looking into twiits today and I saw some API-base CMS (contentful / prismic).\nWhy not making one to show the power of api-platform ? Something with api-platform / ng-admin / basic angular2 webpack / with little css3 style and some default entity like Content / Pages / BlogPost to make something basic like a blog / little website.\nI could be fun to see if people would you go for that :).\n. But why not a full-stack thingy ?\nlike an composer create-project with all the dependency for all the stack ?\n. I totally agree with you about that.\nI was just looking into that cms- api based which can be awsome to show  api-platform.\n. fixed by #87\n. @teohhanhui I agree with @vincentchalamon the Dockerfile should set up the basics like nginx conf, phpini...\nYou can add a volume with the vendor if you want/need to, but you will have to do a composer install in the docker image or locally before you start to test/code.\n. @teohhanhui For me you should install composer, codeception or anything you need to be used in the image, but anything related to the project should be done in the project.\nIMO, the composer files should be in a volume.\n. @robertfausk : There is not branch for V1 / V1.1 on this repository which is the standard version, there are tags on this repository and the 1.x is in Api Platform Core.\n. @teohhanhui do we recommend using v1 ?\n. I agree, ping @api-platform/core-team WDYT ?\n. @teohhanhui on bug fixes it is. @vinset you can try now with the V2  :)\n. Errors are now better. But anyway you should be careful of the input \n. @n1c01a5 This has been updated. Could you please re-test with the current Api-Platform version\n. @samusenkoiv Did you follow's @teohhanhui comments ?\n. This is great !\nBut with the release of V2 @lekeutch did you try it out ? if so we could made an documentation exemple ?\n. @MLKiiwy Did you find the solution, did @vincentchalamon respond to your question ?\n. @vincentchalamon it's ok now :) ?\n. Thank you about that ;).\nDo you think you could do the same with angular2 and do a PR to the doc repository ?\n. Yup, I leak a little bit of time.\nI totally agree with @dunglas, It would be easy to implement JsonApi since it is relatively close to HAL. @renz-ken If you want to work on this you could start it and I will be glad to help you on this if you want to ;).\n. This is in progress in api-platform/core#785, could you test it  @renz-ken  ?\n. JSON API has been merged \ud83d\udc4d . @andreas-glaser what do you mean ?\n. Could you please past the entity ?\n. @napalm33700 If you can update this asap ;)\n. Is it still on our side ?\n. @polc does @teohhanhui answer to your question ?\n. I totally agree about that too. It can be done easily and yes, the openssl is in our docker image ;)\n. What can we secure ? do we secure the default entity for exemple ?\n. Do we still want to do something by default ?. Closing as this gets no feedback, if we want to provide security by default, please feel free to re-open or to provide a PR directly.. Hi @napalm33700, \nWhat do you want to see within the json response ?\n. I think this is not implemented, @dunglas @theofidry  any idea ?\n. @napalm33700 No problem, you are not. \nIf it is unlinked to api-platform we will tell you like @teohhanhui did ;).\n. api-platform/docs#141 help welcomed ;).\n. @cve You could made a bridge between ApiPlatform and the RateLimitBundle ;)\n. I'm using ng-admin or hm-admin (still in progress) for generated backend.\nFor the front you could use restAngular, angular 1.5 / Angular2 (Maybe wait for the stable version since it's changing alot between RC's) / React. It depends on what you want to achieve.\n. You could maybe create an Custom Filter. There is not a not equal by default\n. LGTM \ud83d\udc4d \n. @henno This is not directly related to api-platform but either to composer.\nWhat would you suggest to do ?\na Know issue part ? \n. Please create an issue on the docs repository if you want to add a know issue part\n. app_dev does not exist anymore with flex, is this still something ?. Is it still an issue ? @fxkopp \n. @fxkopp In case please open a new issue ;).\n. Website has been updated, thanks ;)\n. \ud83d\udc4d \n. @sschueller Could you please test now, api-platform/core#814 has been merged ;).\n. @dunglas is it still a bug ?\n. @cr3a7ure any update on this ?\n. Are you using api-platform v1 or v2 ?\nCould you post the whole entity ?\n. This is an unsupported feature in V1, but this is supported in V2.. @teohhanhui If you have someone in the team who can monitor docker in prod, than ok, tell the adminsys to change directly how they are working for years can be hard.\n@rouflak You should anyway try to upgrade the maximum of the servers, since php7 is faster.\nAnyway, maybe you can try to bump symfony with api-platform v1 and run the tests \ud83d\udc4d \n. @rouflak if you can, it will be better to have another server with PHP7 and use V2 since it's better.\n. @jayesbe Pull Request is welcomed.\n. @DBuit Do you still have an issue ?\n. Could you check why the test are not green :p ?\n. @andreas-glaser We deployed the docs on https://api-platform.com\n. RC4 is out, if there are no blocking bug, it will be the stable release ! \n. Is it ! ;). @ksom Did you write something that fit you're needs that can be shared ?. Thanks @ksom !\nMaybe this could be part of some docs ?. I agree with @CecileAmrl. It use alot of space, so when scrolling it should close by itself.\n. closing in favor of api-platform/website#6\n. Are the files in synchro with the VM ?\nThis error means that either there are no synchro, either it's in the wrong place ?\nDoes it have the right to be executed ?\n. @Dannebicque Did you find the solution ?\n. @Dannebicque Did you try what @teohhanhui said ?\n. @priyanka1110 Could you please post a PR on the documentation to explain what to do on windows ?. Hey, @djoos \nWe are discussing it in here api-platform/docs#67, we will be in the process of written it, if you can help ;)\nClosing in favor of the issue in the docs.\n. You have to change the signature in the Dockerfile of composer by this one aa96f26c2b67226a324c27919f1eb05f21c248b987e6195cad9690d5c1ff713d53020a02ac8c217dbf90a7eacc9d141d\n. Fixed by #168 \n. now fixed\n. @amenophis Thank you for the link, but this will not work on windows env (An alternative is to use this script which only works with unix utils\"). So we may have to found another solution.\n. @dunglas I forgot about that.\n@amenophis thanks ;)\n. Closed in favor of #162.\n. @dunglas Updated\n. Can you please show me the rights of your app ?\n. This is on the host right ? Why is it root ?\n. What environment are you using ?\nCould you please tell me if you run all :\nOn Linux\n1) Run install script\ncurl -fsSL https://get.docker.com/ | sh\n2) Add the current in user in the Docker group and restart your machine\nsudo usermod -aG docker `whoami`\nYou have to reboot\n3) Start your docker service\nsudo service docker start\n4) Run docker test\ndocker run hello-world\n. @SerkanDayicik Docker is a way of running the project, you can totally run api-platform with a local mysql server and one bin/console server:run or by using apache or nginx.\n. IIRC You now need to install the webserver by your own. @CesarCarrazana Do you mean on the URL ?\n. You can do that by overriding the operation. Hey @AndreMaz thank you for using ApiPlatform, \nFirstly why are you running docker as root ?\nSecondly can you do docker pull php:7.0-apache then docker-compose up -d ?\n. Do you have a proxy that would disable the access to the repository ? I can't reproduce this error using the same steps.\nMaybe you could try docker-compose build --no-cache\n. Can this be closed ?. I think this could be closed now @soyuka?. Is the AppBundle/Resources/config/serializer.yml loaded by the application ?. Any update on this ?. @cve If this goes on again please re-open this issue.. @videni could you please create new issue with more information ? what does not work ? there is a documentation PR, so I think you should try that too.. @piotrbrzezina Does it answer your needs ?. @cve is it ok for you ?. Could you please explain what you want to achieve ?. Is that workaround still in place ?\nBecause like @soyuka said you should not need one.. @Jarablus is it ok for you ?. Could you please post the entities ?. the /var/cache is root locally too ?\nCould you please try to remove the whole folders content give the permission to the current user ?. I think something has been executing as root at the first time. @Gormador Could you confirm please ?. This has been implemented in core !. What do you mean ?\nI think you can use customs DataProvider. @ad3n Did you find out how to use the custom data provider ?. You can change the route or disable swagger ui directly\nswagger_ui:\n    path:       /swaggerui\n    defaults:  { _controller: api_platform.swagger.action.ui }. @napalm33700 but you can disable swagger ui and don't be using a listener. This has been fixed long time ago ;). @esistgut is it ok for you ?. The documentation has been updated and the docker setup too :).. @ad3n is it ok for you ?. @xfloyd2112 Does the serialization groups respond to what you want to achieve  ?. Feel free to ping me if the issue is still accurate.. I think this is fixed with swaggerui v3. Is this something related to how you have to do it ?\n. @silverarm could you please review #215  and see if api-platform/docs#172 is ok for you ?. Did you found out what you wanted to achieve, what do you think is confusing ? . Feel free to ping me if you still have an issue.. What do you mean ? could you please post the error and the entity ?. Feel free to ping me if you still have an issue.. Since #162 has been merge, it is still relevant ?. Do you still have the bug ?. Feel free to ping me if you still have an issue.. This has been fixed in core by @meyerbaptiste. Can we close this @jordicaballero ?. @devrck @soyuka is right, you can do what you want in the custom data provider ;). @globalglug Maybe is to add a call to the decorated listener when a doctrine entity is found (you can test this with doctrine).. @globalglug And if you still have question, I think it's just better to open a new issue.. ping  @raoulclais . @raoulclais is still working on it, this is not finished. I'm closing this one since GraphQL is now part of API-Platform.. WDYT @api-platform/core-team ?\nFor me it could be in a bundle that has a bridge with api-platform and not in core directly.. @diegograssato Like @dunglas said, if you are willing to write a bridge or if it's already working, tell us, we could promote that bundle.. @lpitteloud Yes, could you please post the full error stack trace ?. @ThomAille Do you still have an issue ? if it's the case could you please provide more information ?\n(if you can write a little reproducer it could help us alot :)). Any update on this ?. Do you still have the issue ? @iCodr8 . I think this is now possible in master with the work of @soyuka . It's not the same thing, the id is supported but the relation are using IRIs. should we return numerical value (or string if uuid) when there is a relation and we are using JSON ? @api-platform/core-team . I will do it. It seems that api-platform/core#1365 has been merged, so this should be fixed.\nCould you confirm @gouxlord . Could you please implement this in a api-platform/api-platform fork ?\n. Like @amenophis said we need the GET to generate an IRI, it's mandatory.. Do you still have an issue ? if it's the case feel free to re-open this. Could you please do the following ? \n\nFork the API Platform Standard Edition\nDo the minimum modification to reproduce\nPost the link in here\n\nWe will test that and try to help you.. @mvigneron Did you write the custom filter for elastic search ? Because by default it will be linked to doctrine. \nCould you please create a new issue if you still have some question because it's not the same subject.. Does it fix this issue @soyuka ?. Hey @Newan,\nThanks for using Api-Platform,\nWe will update the doc if it's still outdated, feel free to open a PR if you need to :).. @nik-lampe is this still an issue ?. Thanks,\nIf someone has an issue with Doctrine Inheritance, please feel free to open an issue.. @VeeeneX if you still have an issue, or if you found something to fix this, please feel free to comment this issue.\nIf you have some time to help us finish the mongodb support feel free to look at it ;).. It's now possible ;).. I agree with @soyuka maybe we should add a failing behat test in order to fix it without breaking things. We should stick with the official image as a source, but we should be using a pre-build image based on the current docker configuration.. Do you have the same error (none given) ?. This seems merged, I think this can be closed ;).. Is the swagger decorator what you need ?\nI'm closing this one, feel free to reopen if you find the need to.. A doc PR is now present, please comment directly in it.. I agree with @soyuka @cookingfox why not using directly a doctrine event . @cookingfox Can we close this ?. @castroCrea Could you please add an technical exemple ?\nDo you mean embeddable resources ?. I think what you need is this, you will then do GET /products and get products, and category and country in the response. Now I understand ^^.\nI don't think it's a good idea to have a endpoint that returns you 2 resources, but what you can do is to maybe add a customDataProviders or  a custom action that will fetch everything for you and put them into two json arrays ?. Closing as we got no feedback.. @MarsArt does soyuka's answer  is ok for you ?. @MarsArt If you still have an issue please feel free to post a comment so we can reopen the issue. By default this is not possible, but what you could do to achieve that is to use a custom post / put and parse what you send.. @amaccis Is this still an issue for you ?. It seems that all the linked PRs have been merged. This can be closed.. This is not working /api/users?profile.address.postalCode=88 because this is 2 level.\n/api/users?profile.firstName=Thomas this should be working, could you please show us the hydra return ? . Do you want to create the entity based on a email entity or do you want to create the email entity ?. @sbacem \nThis my Dockerfile configuration for postgresql : \n```Dockerfile\nRUN apk add --no-cache --virtual .persistent-deps \\\n        git \\\n        icu-libs \\\n        zlib \\\n        postgresql-client\nENV APCU_VERSION 5.1.8\nRUN set -xe \\\n    && apk add --no-cache --virtual .build-deps \\\n        $PHPIZE_DEPS \\\n        icu-dev \\\n        zlib-dev \\\n        postgresql-dev \\\n        sqlite-dev \\\n        pcre-dev \\\n    && docker-php-ext-install \\\n        intl \\\n        mbstring \\\n        pdo_mysql \\\n        pdo_pgsql \\\n        pdo \\\n        pgsql \\\n        zip \\\n        pdo_sqlite \\\n    && pecl install \\\n        apcu-${APCU_VERSION} \\\n    && docker-php-ext-enable --ini-name 20-apcu.ini apcu \\\n    && docker-php-ext-enable --ini-name 05-opcache.ini opcache \\\n    && apk del .build-deps\n.... docker-php, composer etc.\n```\nThis is the docker-compose.yml part for postgres\nyaml\n  postgres:\n        image: postgres\n        volumes:\n            - /var/lib/postgresql/data\n        ports:\n            - \"5432:5432\"\n        environment:\n            POSTGRES_DB: db\n            POSTGRES_PASSWORD: password\n            POSTGRES_USER: user\n. Do you populate the $cover property within the entity ?\nYou could use the serialization groups to do that (remove both fields and accept the cover one). Does the serialization groups help you on that ? I think it's the best way to do it.. If you still have an issue please feel free to ping me.. Using the server_version does fix the problem @jhonatanTeixeira ?. LMK @jhonatanTeixeira if you still have an issue. As in the spec, we use the http://swagger.io/specification/#externalDocumentationObject.\nThe issue in with the validator.. Hello Dylan\nCould you please do the following, so we can test this ?\n\nFork the API Platform Standard Edition\nDo the minimum modification to reproduce the bug\nPost the link in here\n. Hey @stadskle, \nWhat is the output of php -v ?\nI did try on OSX with PHP 7.1.4 and I don't get any errors.. I think this is related to some of the extension, could you try to disable all the debug related stuff ?. Maybe you could post an issue in the DistributionBundle repository. I don't have any way to reproduce nor to debug it :/.. It should work since the vendor will be there, or you could use docker directly to avoid this. You don't need to check that the the mobile app if the api returns you an error when sending the email.\n\nOr what you can do is to use our filters to do that?. What you can do is to parse the hydra or the swagger documentation to do that.\nYou can see exemple of that with https://github.com/api-platform/generate-crud. @theofidry @Evertt Maybe you should be looking in what @dunglas has done in the api-platform/admin repository . @dmeziere It should be working anyway. What are the bugs do you have with you're app ?\n. With what user are you running docker ? and what are the perms on the files ?. @renan-taranto  what are the permissions on the varnish vcl ?. I guess with the entrypoint ?. I think that means that from_email is a mandatory parameters in order to use FosUserBundle. You should follow the documentation directly on the fosUserBundle github.. @blaues0cke Like @meyerbaptiste said, I think this will be good for you.. Hey @Lyrkan,\nThanks for using Api-Platform,\nThere are two different normalizer, they are not giving you the same result for a giving resource.\nWhy do you need to decorate both ? What happens if you are not doing it ?. WDYT @api-platform/core-team ?. I'm closing here, as this doesn't get anymore feedbacks, feel free to create an RFC in the core or to create directly a PR.. Hey @sebastienhouzet,\nThank you for using ApiPlatform,\nUsing PHP 5 bring you to the version 1.1 of api-platform which does not contain swagger-ui and we advice you to better use directly the version 2.0 which contains a lot improvements.\nIn order to use ApiPlatform 2.0 you should use PHP 7.. Are you using docker for windows ?\nor a VM (docker-machine) ?. @vbourdeix I think both case should be working now :). Could you please post the stack trace ?. Could you please do the following ? \n\nFork the API Platform Standard Edition\nDo the minimum modification to reproduce the bug\nPost the link in here\n\nWe will test that and confirm.. @akira28 We will be doing it, we just need to be sure that everything is ok before doing it :).. Thanks to @teohhanhui this has been merged ;). Not on docker hub, but still online.. @Sybio Implementing a custom operation don't always require the id parameter, but as @dunglas said, it's bad practice. :). We have jsonhal too :).. You are downloading the V1 of api-platform which contain app/console IIRC instead of bin/console. To use the V2 of api-platform you need PHP 7.0 or newer.. What do you mean ?\nIf you do POST /something  with\n{\n\"id\":\"value\"\n}\nAnd the setters exists (and the good groups if you use any), that should work.. Could you please paste the entity you are using ?. This is fixing the volume. Without the last slash it does not take them as volumes.. What I meant is that in macOS, the behaviour is not good without the leading slash. Not directly on the docs but on stackoverflow. ping @dunglas @sroze . Could you please look at the logs ? that could means that the php/nginx server could not start or that there is a an error in php.. $data would be map to an entity, you should get the request body and check the json validity.. Maybe this is not the right way to do it.\nWhat I think will be better is to user the symfony firewall with jwt and then add an event listener that will get and set the IP.\nHere is a working code for countryCode : \n```php\nclass UserRegistrationSubscriber implements EventSubscriberInterface\n{\n    private const POST_USER_ROUTE = 'api_users_post_collection';\nprivate $localeResolver;\n\n/**\n * @param LocaleResolver      $localeResolver\n */\npublic function __construct(LocaleResolver $localeResolver)\n{\n    $this->localeResolver = $localeResolver;\n}\n\n/**\n * {@inheritdoc}\n */\npublic static function getSubscribedEvents(): array\n{\n    return [\n        KernelEvents::VIEW => [\n            ['userSetDefaultCountryCode', EventPriorities::PRE_VALIDATE],\n        ],\n    ];\n}\n/**\n * @param GetResponseForControllerResultEvent $event\n */\npublic function userSetDefaultCountryCode(GetResponseForControllerResultEvent $event): void\n{\n    $user = $event->getControllerResult();\n\n    if (!$user instanceof User || !$event->getRequest()->isMethod(Request::METHOD_POST)) {\n        return;\n    }\n\n    if (null === $user->getCountryCode()) {\n        $user->setCountryCode($this->localeResolver->getCurrentCountry());\n    }\n}\n\n}\n``. Does @soyuka's patch fix this issue @mario-digitalstate ?. if you still have an issue please open an issue in the [schema-generator](https://github.com/api-platform/schema-generator/) repository directly. if you still have an issue please open an issue in the [schema-generator](https://github.com/api-platform/schema-generator/) repository directly. moved to the good repo. if you still have an issue please open an issue in the [schema-generator](https://github.com/api-platform/schema-generator/) repository directly. Could you please post the action configuration (@Routeannotation / services.yml information) ?\n. This seems to not be a bug, closing as the discussion seems to be finished.. Do you still havedocker/app/install-composer.sh? You need it to run the docker-app-install-composer.. @laytoneverson I can't reproduce either, if you still have an issue please ping us.. We should update the documentation, but this is notwebanymore this isapp`.. What do you want to achieve ? to alter the sql query ? or to alter the HTTP request ?\nFor both there are ways in the framework, for the first one could do a custom filter that will add filters to the query.\nFor the seconds you need to use event listeners . The $data is filled with the DataProvider like explained here. @lvillarino Do you want to try contributing it to API-Platform ?. Yes it's possible, you need to implement your own oder filter by following this. I don't know the code that you are running, I could just tell you to create that kind of custom filter and to use the code(based maybe on SQL) to update the queryBuilder like in the RegexpFilter.. You need to use embedded items for this to work, look at how we are doing that with serialization groups. If you still have an issue please feel free to ping me.\n. Do you still have an issue ?\nIf so, could please dump the symfony routes ?. I agree with @soundlake on this, it will be working.\nIf you still have an issue feel free to ping me.. The PR has been merged, So I think can be closed, if i'm misunderstanding feel free to ping me ;)!. @razbakov please create a new issue with your usecase, this seems not linked to this one. I don't think the custom getter will do the trick unless you a new field.\nWhat you could do is to use event listener to re-formatt the data before sending it.. If you still struggle creating this, feel free to ping me.. If you use :\nhost:     'api.{project_name}'\nYou should link anyway the whole IRI, if you do not specify it, it will work with relative path and with the whole IRI. You could links another api with this kind of features.\n. Could you please give us an exemple ?\nDo you mean subresources ?. @dunglas Do we add aliases on every services or on just thoses twos ?. @Atala Maybe you could provide a reproducer in the project you linked in the form of a branch so we could look at it ?. @Atala is it still an issue ?. We should update the docs and maybe link to our CI ?. @iCodr8 Do you mind opening a doc PR ?. I guess an event subscriber will do the job too and you don't need to have a custom endpoint for this.\n@carlespibernat\n. @carlespibernat Yeah that's totally my point, you let ApiPlatform do the serialization of the entity then you listen on that tranformation (object to json) to add the little parameters you need. But with the json you provided I understand what you need better, so I guess you should do that in a custom normalizer.\nWould you like me to provide an exemple on how to do it ?. ping @soyuka about eager loading ;).. Thanks @toofff. I think there is a story of a cat or a mistake :p. As @teohhanhui said, please use Docker for Mac.. Issue moved to the doc repository.. If you still have an issue, feel free to ping me.. @Aerendir is it ok for you ?. This PR has been merged.. Doc PR created : https://github.com/api-platform/docs/pull/478. Feel free to ping me if you still have an issue, thanks!. As @dunglas said, if you have something already working, out-of-the-box, we could add it in the main organisation.. This should be working now.. There were issues with the website at some point, it is now stable.. Docker for windows does not work the same way. But it should be working with api-platform too.\nClosing as this seems to be OK, feel free to open another issue if you have one with docker for windows.. This should be updated when the symfony's PR will be merged ;).. Thanks, this seems resolved!. This has been updated, thanks anyway!. Could you please give us more information ?\nWhere does the getCurrentRequest occurs ? it seems that the RequestStack is null.. If you still have an issue please feel free to ping me.. Issue moved the to server component.. Sorry for the late answer, did you achieve what you wanted to do ?. AFAIK, there is a doc issue based on elastic search.\nWe don't have any more resources about elastic search ATM, closing for now.. Issue moved to the documentation repository.. @suryacaprice please feel free to open another issue if you still have one.. Closing as the answer has been given.. The thing that could help you in this case, is maybe to have a EventSubcriber that will be listen before/when/after the object has been modified to apply this security rules. . If you still have an issue please feel free to ping me or to re-open this one.\nThanks!. @soyuka's responses seems the right thing to do, thanks!\nIf you still have an issue feel free to ping me.. @krypton-code feel free to ping me if this is still an issue.\n(When @dunglas asked for the trace, he means the trace you got when requesting the API, not really related to the profiler).. This is an english speaking repository.\n@dunglas is not the only one working on the project, we are helping people using the framework on the symfony slack in the #api-platform channel and stack overflow.\nI think in order to understand how to use, maybe is firstly to try it and read the doc.\nThanks, I'm closing this one, as the issues are for bugfix or feature request on the distribution.. If you still have a question, please feel free to ping me.. If this is still an issue please feel free to create an inssue in the admin component, as this is the best place to get a response or a fix, Thanks!. This seems resolved, thanks!. Moved to the doc repository, @byhoratiss if you have some time to create a cookbook for using api-platform with dynamicconnection that will be awsome, thank you!. Issue has been moved to the documentation repository.. You will have to define the environement on the deployment (which will run the pod, if you need to scale, then it will append the event to the newly created container).\nI suggest you to look at https://github.com/continuouspipe/continuouspipe too.. This issue has been moved to the server component.. This seems to be ok, thanks @soyuka ;).. You could please tell us what the bug is ? it's the same ?. Could you please try with the newest version ?\nIIRC this seems to be a problem with either the volumes or the network, could you check both ?\nI will be trying to install a W10 box to test this, but if @jon-ht you can test again and maybe try to find the error it could be awsome, thanks!. The errors are the same ?\n. Are you talking about the open api (swagger) documentation or the hydra one ?\nIf you are talking about swagger you can use the context to set enum (choices).. core issue created. \n. Could you please try with last version ?\nIf you still have an issue please feel free to ping me.. Do you still have an issue ?. The lastest version still contains this bug ?. Issue moved to core.. @deantomasevic are you using docker for mac or docker-machine ?. It seems working for me on two different devices.\nIf you still have an issue, please feel free to ping me!. @piotaixr if you still have an issue, please feel free to ping me. Closing as this didn't get anymore feedbacks.. You can use a decorator for swagger based on the DocumentationNormalizer, we have an exemple of this in the docs.. This issue seems to have an answer.. Closing as we got no feedback.. @TheJenne18 Could you please paste the entities, so we can have a look and maybe know why it's not working properly for you ?. Closing as we got no feedback.. @jr-cobweb it is still an issue ? if it's the case could you please create one in the core component ?. @teohhanhui @dunglas @sroze I guess we can do this just by enabling continuous-pipe on api-platform. \nSince we already have a cluster at Les-Tilleuls.coop with some part of api-platform in it, I guess we could install continuous-pipe on that cluster, enable or not a feature-branch based on the patch made in the core or juste deploy and build a version automatically when pushing to master.\nWDYT ?. It may be to specific for me to add into the distribution.\n@api-platform/core-team WDYT ?. The fact is it's a string because at the moment it came into the configuration is has not been parsed so for exemple: if we allow string nodes, it will came as something like: env_bool_ENABLE_API_DOCUMENTATION_xxxxxxxxxx.\nSo the simplest way it like @ljbergmann said, to use different value based on the directory.. Closing as this has been answered, I don't think there are something to do in API-Platform for this to work.. @carlespibernatcreus Could you please answer @gries's question so we could be able to understand what's the issue ?. @gries it's not used anymore in the standard shipping, you need to required it with composer or to add it as a global dependency.\nYou can refer to the behat installation guide.. @andreaswarnaar does @silverbackdan's answer give you some direction ?. @karser do you want to make a PR to test this ?. IMHO if it's faster, provide the same features I think we should switch to using the most efficient way of installing the dependencies. (less storage used, less cpu / memory used etc, it's always better :p). Thanks @karser for the benchmark! I'm closing here as I don't think we should inscrease the node_module folder for that amount of time. @lvillarino could you please check what @soyuka said ?. It seems that's ok for you @comxd, if you need anything else feel free to re-open or to create a new issue ;).. Could you do it ?  if not, could you please create an issue in api-platform/docs ? so we can do it ;) @comxd \nThanks. This seems resolved to me, if you still have an issue, pelase feel free to ping me.. Same for me, it should be in a custom filter.\nBut, we are maybe going to implement a where filter, if the RFC is approved. I will prepare the PR anyway ;).. AFAIR, if you want to do this, you need to use a doctrine EventSubscriber in order to update the bet with the id of the outcome.\nIn fact you need only 2 request, create the outcome, then create the bet with outcome @id or the IRI.. Closing because we got no feedback, if you still have an issue, please feel free to ping me.. Adding .env.dist will fix this bug right or should we remove completely .env too and ask users to move it manually?. To get the final query you need to debug in FilterExtension because when using multiple filters it will add the dql to the querybuilder ;).\nedit: oops missclicked the comment button!. This seems to be out of context. @teohhanhui told you how to create a basic api-platform project :).. Hello @emir thanks for using API-Platform,\nYou need to use a Custom DoctrineExtension to do this.\nI'm closing here, if you still needs anything feel free to re-open.. I'm going to test it on mac. Could you please paste both entities ?. I think this is because you are using the same groups for both entities, try to changes the groups based on the entity like for exemple team_default_input and hike_default_input instead of both get.. Could you pleas paste the entity ?. @Ronnie-J does it work for you ?. @jlayt I think we all agree that could be in a external bundle, It should not be that hard to achieve, we can add it in the documentation, do you plan on doing something like this ?\n(for exemple the Pomm project supports api-platform with a bundle).. You may don't want to use the port we set by default / the volumes. This is a exemple.\n. But we talk about starting a localhost server here with the console, without a DB it will not be working, people who want to use docker may look here.\n. The question is, is this for prod or for dev ? we could build an image based on php7 that run bin/console s:r or use fpm + nginx.\n. WDYM ?\nI moved after  adding /app to not add another ADD.\n. I really don't know what to think about this  : \n- Do we really want to support people using docker in prod, or do we made this like a bootstrap ?\n- Why don't we build an image and use it ?\n. Docker does not support ACL. missing final \\. Either re-use start_safe_perm according to nginx / or maybe something else ?. why did you remove --classmap-authoritative ?. It does not fix the issue when we are using docker-compose exec web composer update. Are we ok with mysql ? can't we use postgres?. db is fine too :p. Maybe to just add what we need to and to avoid adding .git ?. did you run the test within the alpine?. Why two runs ?. the return of  docker-compose exec may be strange sometime with travis.. Don't forget to change it when merging both. why removing the volumes ?. The cache should be a non-shared volume even on dev because of performance issue on mac os x and windows. The vendor should be a non-shared volume too IMO. why removing the logs ?. it does, this should be reverted. I think we should be keeping specify the version.. I agree it does not seem to change anything.. Why ?. Because it can break things.. same reason. I'm talking about osx, not about linux.\nDo you want to me take a screencast to show you ?. @dunglas no IMO because we are sharing the directory. Yeh @teohhanhui I totally agree, this is a workaround, coz' with large project it became nearly  too slow to be used in docker for mac. why removing the comment ?. It's because it's in the RUN, it should be before the RUN to explain why we chown in here. do we really need to use that for a single command line ?. I don't think we should use --from, because it does not work with google cloud atm :/. (so won't work with managed kubernetes and our helm). I mean if you are using Google Container Builder or you are building directly from Google it won't work.. ",
    "lsmith77": "yup .. that does the trick\n. ",
    "svatok13": "@dunglas, you mean, that i must remove method declaration from service and use just @ApiDoc annotation? Because if i use if with declared service, there are 2 identical methods, with different documentation\n. @dunglas after adding @ApiDoc annotations i have got 2 tabs in documentation, if i remove the service declaration of this method, than documentation of this method disappear\n\n. ",
    "Jarablus": "It could be a nice addition to V2, it still generate two panels even with entity annotations\n. @Simperfit it was a bug resolved now there were two documentations for custom operation if @apidoc annotation was used.\n. It was v1 i will try with v2\n. Same thing with V2 even with annotation\n. I can't before wednesday I used apiplatform at work and i'm on holiday until that time\n. * @ApiResource(\n *     attributes={\"filters\"={\"product.search\"}},\n *     collectionOperations={\n *         \"get\"={\"method\"=\"GET\", \"normalization_context\"={\"groups\"={\"product\"}}},\n *         \"search\"={\n *            \"path\"=\"/products/search\",\n *            \"method\"=\"GET\",\n *            \"normalization_context\"={\"groups\"={\"product\"}},\n *            \"controller\"=\"AppBundle:Product:search\",\n *            \"hydra_context\"={\"@type\"=\"hydra:Operation\", \"hydra:title\"=\"Recherche de produits\", \"returns\"=\"jsonld\"}\n *         }\n *     },\n *     itemOperations={\n *         \"get\"={\"method\"=\"GET\", \"normalization_context\"={\"groups\"={\"product\"}}},\n *     }\n * )\nIs it enough or do you want all entity code ?\nswagger doc\n\n. It's fixed you can close that issue. Sorry for not reporting it earlier but V2is so awesome i was busy with it :)\n. {\n  \"@context\": \"/contexts/ArticleAttribute\",\n  \"@id\": \"/article_attributes\",\n  \"@type\": \"hydra:Collection\",\n  \"hydra:member\": [\n    {\n      \"@id\": \"/article_attributes/article=000843;attribute=36017\",\n      \"@type\": \"ArticleAttribute\",\n      \"value\": \"75\",\n      \"attribute\": [\n        {\n          \"@id\": \"/attribute/1601\",\n          \"@type\": \"Attribute\",\n          \"name\": \"width\"\n        }\n      ],\n    },\n. Worked fine with group in V2. Something related to doctrine or doctrine bundle is definitely broken in beta \nsame action that worked fine before upgrading now behave like this \n\nMappingException in MappingException.php line 565:\nDuplicate definition of column 'code' on entity 'AppBundle\\Entity\\Erp\\SaleForce' in a field or discriminator column mapping.\nReflectionException in RuntimeReflectionService.php line 80:\nProperty AppBundle\\Entity\\Web\\AccountOption::$code does not exist\n\nif I clear doctrine meta-data cache => no error\nI try the same request \n\nRuntimeException in SimpleObjectHydrator.php line 40:\nCannot use SimpleObjectHydrator with a ResultSetMapping that contains more than one object result.\nContextErrorException in ClassMetadataInfo.php line 1861:\nNotice: Undefined index: wishlist\n\nAgain clear meta-data cache no error...\n. Sorry... Next time I will investigate a little longer...\nI just found out that it was related to redis... It's strange because I have no problem in alpha.\nAgain sorry for polluting your issues.\n. There is a use and i use ApiResource Annotation\nEntity Asset is not a declared  resource.\nAs I mention before everything work fine since v2 alpha. I will post the resource annotation as soon i  can. . is it mandatory now that every entity  has to be e resource ?\nIf yes since when and what is the purpose  ?  I don't want my entities to be exposed. 'all my entities' .... I will post it tomorrow morning i'm not a work now. I will try this but for demo purpose I reverted to 2.0.0-beta.3. Resolved by disabling force_eager. Thanks All :). The entity is related to 8 others \nIt's an Article related to product, brand, assets, tax etc...\nI can give you the full package if you want. Cart \"articles\"  is an ArrayCollection I want to clear it on a Cart PUT . If it is not possible you can close the issue I have made a \"dirty\" workaround.... ```\n /**\n\u00a0  @ApiResource(\n\u00a0  \u00a0  \u00a0  collectionOperations={\n\u00a0  \u00a0  \u00a0  \u00a0 \"get\"={\"method\"=\"GET\"},\n\u00a0  \u00a0  \u00a0  },\n\u00a0  \u00a0  \u00a0  itemOperations={\n\u00a0  \u00a0  \u00a0  \u00a0 \"get\"={\"method\"=\"GET\",\u00a0  \"normalization_context\"={\"groups\"={\"cart\"}},\u00a0  \"denormalization_context\"={\"groups\"={\"cart\"}}},\n\u00a0  \u00a0  \u00a0  \u00a0 \"put\"={\"method\"=\"PUT\",\u00a0  \"normalization_context\"={\"groups\"={\"cart\"}},\u00a0  \"denormalization_context\"={\"groups\"={\"cart\"}}},\n\u00a0  \u00a0  \u00a0  }\n\u00a0  \u00a0  )\n\u00a0  \u00a0  @ORM\\Entity\n\u00a0  \u00a0  @ORM\\HasLifecycleCallbacks\n\u00a0  \u00a0  @ORM\\Table(name=\"cart\")\n*/\nclass\u00a0  Cart\n/\n\u00a0 \u00a0  @ORM\\OneToMany(targetEntity=\"CartArticle\",\u00a0  mappedBy=\"cart\",\u00a0  \u00a0  cascade={\"persist\",\u00a0  \"remove\"})\n\u00a0 \u00a0  @ORM\\OrderBy({\"createdAt\"\u00a0  =\u00a0  \"DESC\"})\n\u00a0 \u00a0  @Groups({\"cart\"})\n/\nprivate\u00a0  $articles;\n```\n\nMy workaround, don't judge me :D ... Is a kernel request listener if articles is empty manualy remove all articles and flush.\nThe thing I don't understand is that in my listener articles is empty but without my ugly fix nothing is actually deleted in database.. Yes,  I will try without it and with latest apiplatform version. It's the first thing I've checked. . @Simperfit Yes After starting with a \"fresh\" api-plaform install. I think the problem was my migration from V1 to V2 (it was a little \"messy\").\n. I think its not related to swagger but to request header Accept, If it's not application/ld+json\nthere an error if swagger is disabled and redirection to swagger doc if it is enabled.. I fixed it by forcing Accept:application/ld+json in a listener, don't think it's the best id but I'm in a hurry. as I said the error is when it is disabled. And I need it in dev env. . @Simperfit I will investigate more and test something less ugly tomorrow. ",
    "Matthieu-Lescieux": "```\nrdfa:\n  - https://raw.githubusercontent.com/schemaorg/schemaorg/sdo-gozer/data/schema.rdfa\nannotationGenerators:\n  - ApiPlatform\\SchemaGenerator\\AnnotationGenerator\\PhpDocAnnotationGenerator\n  - ApiPlatform\\SchemaGenerator\\AnnotationGenerator\\DoctrineOrmAnnotationGenerator\n  - ApiPlatform\\SchemaGenerator\\AnnotationGenerator\\ConstraintAnnotationGenerator\n  - ApiPlatform\\SchemaGenerator\\AnnotationGenerator\\DunglasApiAnnotationGenerator\nnamespaces:\n  entity: AppBundle\\Entity\ntypes:\n  #Thing\n  Thing: ~\n#Thing/Intangible\n  Intangible: ~\n#Thing/Intangible/Enumeration\n  Enumeration: ~\n#Thing/Intangible/Enumeration/QualitativeValue\n  QualitativeValue: ~\n#Thing/Intangible/Enumeration/QualitativeValue/CarUsageType\n  CarUsageType: ~\n#Thing/Intangible/Enumeration/QualitativeValue/DriveWheelConfigurationValue\n  DriveWheelConfigurationValue: ~\n#Thing/Intangible/Enumeration/QualitativeValue/SteeringPositionValue\n  SteeringPositionValue: ~\n... Other types\n```\n. ",
    "lubomir-haralampiev": "OK, I'll take a look at it\n. I fixed the generator https://github.com/api-platform/schema-generator/pull/32.\nThough the url in the example schema https://raw.githubusercontent.com/schemaorg/schemaorg/sdo-gozer/data/schema.rdfa includes a wrong content-type 'text/plain' in its response and the rdfa can not be parsed.\nAfter serving the same data from my local machine using the correct content-type 'application/xhtml-xml' (according to http://www.w3.org/TR/xhtml-rdfa/) I was able to generate the files successfully.\nUnfortunately I can't provide a public url with the correct content-type.\nHow to deal with it?\nIn my opinion this should be another issue.\n. It works.\nHowever genre and publisher have each two ranges defined:\ngenre - Text and URL\npublisher - Organization and Person \nThis causes the TypesGenerator::generateField to log an error:\n[error] The property \"genre\" (type \"CreativeWork\") has several types. Using the first one.\n[error] The property \"publisher\" (type \"CreativeWork\") has several types. Using the first one.\nThough all types are generated properly.\n. ",
    "sroze": "I'm closing this PR as it's now out of date, and we should simply regenerate all the entities.\n. I would prefer to remove this dependency, and remove it from the behat.yml file.\n. Yup, that won't hurt. \n@blazarecki could you rebase on master ?\n. Hi @nicodmf. Sure! Can you let us know how isn't it compatible at the moment? :)\n. @jderusse I've added the cache warmup, good idea!\n. We definitely need that Docker Compose configuration, true!\nBut I'm not sure it really makes sense for us to have an official built Docker image.\n. Yup, so as you can imagine, I definitely agree with you @teohhanhui ;)\n. I wouldn't before we get rid of this memory_limit=1G.\n. @teohhanhui they are not. Also, let's be sure of these 2 :+1: from maintainers before merging :)\n. @n1c01a5 can you try to build (docker-compose build web) and restart it. If something is still not working, could you open a separated issue?\n. This Docker approach is not the ideal one to me at all. The vendor are\nbuilt successfully in the Docker image, but obviously have to be installed\nlocally too if you override the image content by mounting the /app\ndirectory using your own local directory.\nThe port mapping configuration is something installation-specific and\nshouldn't be in the Git repository to me.\nOn Wed, May 25, 2016 at 6:44 PM Teoh Han Hui notifications@github.com\nwrote:\n\nThe fix is simple. Do not blindly mount the entire project directory from\nhost, but have more fine-grained volumes instead (some host-mounted, some\nnot).\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly or view it on GitHub\nhttps://github.com/api-platform/api-platform/pull/87#issuecomment-221631449\n. Let me have a look tomorrow. Unfortunately, I'm using Docker for Mac as well now \ud83d\udc83 . .dockerignore is not recursive :(\n. This was merged for Docker 1.10 only, while most of the users still don't use it.\n. When doing that, you basically have to update your /etc/passwd to be able to su - www-data, Then, with the .:/app volume in the docker-compose.yml file, your existing files in vendor/ do not belong to www-data so you need to chown everything.\n\nDon't get me wrong I'm not against. Still, do you think that's worth doing it? I like the idea of warming up the cache though.\n. That means you allow any HTTP request to use up to 1G of memory. That could then be relatively easy to burn the server.\n. TBR. Oh, I didn't know we could do that \u2764\ufe0f . I'd suggest using Docker Hub instead. There are multiple reasons. The first one is that it's the default registry, therefore we can simply ask users to docker pull api-platform/api-platform if we have so. It's pretty much familiar to what they have already with PHP & composer. Also, Docker Hub images are cached at various network boundaries (for examples within Google's network) while Quay's ones are not.. I'm not fond of this one. I'd prefer keeping 4 spaces for consistency.. ",
    "yelmontaser": "I propose to add cget or collection and get or item to the array expected by initNormalizationContext.\neg:\nyml\nservices:\n    resource.person:\n        parent:     api.resource\n        tags:       [ { name: api.resource } ]\n        arguments:  [ AppBundle\\Entity\\Person ]\n        calls:\n            -\n                - initNormalizationContext\n                - [ { groups: { cget: [ list ], get: [ list, detail ] } } ]\n            # OR\n            -\n                - initNormalizationContext\n                - [ { groups: { collection: [ list ], item: [ list, detail ] } } ]\nwhat do you think?\n. Moved to the right repository https://github.com/dunglas/DunglasApiBundle/issues/316\n. ",
    "maciekpaprocki": "+1\n. ",
    "blazarecki": "@sroze Done.\n. ",
    "wysow": "I'm wondering if it's \"just\" because it's not a Thing but an Action maybe...\n. The goal is to store some bookmarks as you already have guessed I think...\n. Ok after some research I think I misunderstood some concepts here... my bad, working on a new implemetation right now, closing for now.\n. ",
    "jderusse": "Database shouldn't be re-created on each scenarii.\n. Can run a cache warmup too\n. Yep, exactly. But remove *-dev packages after install because they are only needed for compilation. Replace it by the related lib when needed.\n. Use docker-php-ext-enable instead of writing in .ini files.\napcu-bc is necessary when your application use apc_*. I didn't test recently but last versions of Symfony should be compliant.\n. You can name .ini file with commonly used zz- prefix.\nhttps://github.com/docker-library/php/blob/master/7.0/docker-php-ext-enable#L10\nHere is my code\n``` docker\nRUN pecl install \\\n        apcu \\\n        apcu_bc-beta \\\n&& docker-php-ext-enable --ini-name 0-apc.ini \\\n        apcu \\\n        apc\n```\n. Are we talking about containers for development or containers for production purpose?\n. IMHO, documentation must be exposed publicly to consumers. It's not only a dev things.\nAn API is not only an endpoint, it's a documentation and SDK too\n. Use docker-compose.override.yml for such customization per environment.\nSee https://docs.docker.com/compose/extends/#understanding-multiple-compose-files\n. Given the version of PHP is fixed by FROM php:7.0-apache, the Dockerfile is not affected by this bug.\nBy fixing the version of APCU, we'll have to follow a third party project to backport the change in this project each time a new version of APCU is released.\n. What'd about using .dockerignore \n. Should be run as www-data to avoid permissions issues with files generated by scripts.\n. Even with ** pattern ?\nI never used it, but I'm really surprised we can no ignore complete directory. :(\n. May be, just move the chown www-data after the composer install?\n. Why mysql and not sqlite nor pgsql\n. Exclude recommands from install packages\n. Remove /var/lib/apt/ files after install\n. GIven the image used is php:7-apache this parameter is not necessary\n. beware, varnish resolves the IP of the domain at boot time and keep it till the end of process.\nIf the IP of nginx changes (for instance when the container restarts) varnish won't be able to route traffic to the new container. Why? Shouldn't be an issue if the invalidator works well. \nIf it don't, you'll not going on prod.. What's about 405?. I wonder if we shouldn't remove the s-max-age header too.\nWith this new tag feature, the app sets an arbitrary value because we known we'll be able to invalidate the varnish. Which is fine.\nBUT what if an other unknown proxy is on the path? (see \"proxy cache\" in this old version of the documentation http://symfony.com/doc/2.2/book/http_cache.html#types-of-caches). Several people use a local nginx configured in proxy pass.\nVarnish point to nginx 127.0.0.1, and nginx performs the DNS resolution on the fly.\nSome other use a script in charge of reloading varnish when the I'm change.\nNone is ideal to me.\nIn dev environment, I just restart my container, in production we use a local nginx\n. ",
    "jdeniau": "Well in that case, those method should disappear ^^ (or be changed to BeforeFeature or something like that)\n. Well I think I do not understand how do your create / drop your database ?\n. Ok, thank your and sorry for this PR ;)\n. ",
    "renan-taranto": "I wonder how to add link elements (that indicates related possible actions) to the representation of a resource using api-platform. And how to dinamically add/remove these links like is shown in this example http://restcookbook.com/Basics/hateoas/.\nCould you give me some hints or maybe an example?\n. Thank you very much leroy0211.  I'm just learning, so for now I will use FOSRest, JSMSerializer and BazingaHateoas until I find a way to do that with API Platform.\n. @dunglas I am new to JSON-LD and after some researches on the web I believe that what I want is not supported by it. I will read about the Symfony Normalizer and try to implement HAL. Thanks for the great framework man.\n. I also had this problem and solved it by modifying the serializer options in the config.yml file from:\n```yaml\napp\\config\\config.yml\nserializer:      { enable_annotations: true }\ntoyaml\napp\\config\\config.yml\nserializer:\n    enabled: true\n```\nMaybe we can use just one format but I'm not sure about that.\nThe other yaml files are like this:\n```yaml\nVendor/Project/MyBundle/Resources/config/api_resources/resources.yml\nVendor\\Project\\Domain\\Entity\\Customer:\n    collectionOperations:\n        get:\n            method: 'GET'\n            normalization_context:\n                groups: ['customer_list']\n        post:\n            method: 'POST'\n```\n```yaml\nVendor/Project/MyBundle/Resources/config/serialization/Customer.yml\nVendor\\Project\\Domain\\Entity\\Customer:\n    attributes:\n        name:\n            groups: ['customer_list']\n```\nIt would be nice if we had the corresponding yaml for every annotation example provided in the Api Platform documentation, just like in the Symfony Docs.. @dunglas Removing the serializer activation from app\\config\\config.yml does not break my app.\nAnd now I noticed that:\n1- Even if the default serializer settings: serializer:      { enable_annotations: true } is set, my app wont break.\n2- Even if I use annotations AND yml mixed to define serialization groups for the same entity my app wont break.\nEverything is working as expected and I don't know what I was doing wrong, sorry.\nSo I believe that the OP is doing wrong naming the file as serializer.yml while it must be called serialization.yml according to SF docs (http://symfony.com/doc/current/serializer.html#using-serialization-groups-annotations). Can you verify that @cve?. I'm also having this problem.\n\nI didn't run docker-compose as root;\nI had to sudo chown -R $USER var/logs/ and sudo chown -R $USER var/cache/ to access the dev env.\n\nIMHO this issue should not be closed since it wasn't fixed.. I believe this is solved by #162 :)\nGreat job on the docker updates.. It turns out that I had to clear the test environment cache since its defined in behat.yml:\nextensions:\n  Behat\\Symfony2Extension:\n    kernel:\n      env: \"test\"\n      debug: \"true\"\n\n404 errors are gone, but I still cant get green tests using the feature file provided in Testing and Specifying the API since the Json Response comes with backslashes before forward slashes.\nI believe that the feature file should be updated because:\n  - Backslashes are expected;\n  - The need of clearing the test environment cache should be mentioned;\n  - The raw id property of the entities are also being serialized.\nI will create a pull request in the docs repo and I'm not sure if I should close this issue.. @teohhanhui This project reproduces the error https://github.com/renan-taranto/api_platform_issue_198.\nNote that the mentioned error happens if the \"Valid\" constraint is added to the field that represents the relation. Otherwise we get a DBAL exception. Both 500 errors.. Hy @ThomAille,\nIt may not be related to your issue but I had the same error while creating a custom operation and not returning a response (or the $data object) in the __invoke() method like suggested here https://api-platform.com/docs/core/operations#creating-custom-operations-and-controllers.\n. Sure @teohhanhui \nIm using:\n1. Linux Mint Rosa 17.3 64bit\n2. docker-compose version 1.14.0-rc1\n3. Docker version 17.04.0-ce, build 4845c56\nHere's everything I did:\n1. From the master branch I downloaded the zip api-platform-master.zip and extracted it\n2. Ran $ docker-compose up -d and the output was:  https://gist.github.com/renan-taranto/cad044c5df8ed1de1ababd6e74b595c4\n3. After building I opened Chromium and navigated to http:\\\\localhost\\app_dev.php\n4. I ran docker-compose logs -f and the output was\nhttps://gist.github.com/renan-taranto/d262a2cdf57c6137099d939ef77e4836\nLet me know if I can provide more info.. @Simperfit I'm running with the linux mint \"standard\" user account which has sudo privileges. I'm used to run dockerized apps with compose using this account so I'm not sure if the problem is my local setup. I still have errors even if I run with sudo privileges $ sudo docker-compose up -d.\nToday I downloaded the project from the master branch again and varnish breaks due to permissions:\nvarnish_1  | Error: Cannot read -f file (/etc/varnish/default.vcl): Permission denied\nThe permissions looks like this after trying to bring the containers up: https://gist.github.com/renan-taranto/3eb8632b313243884abec7689b604074. @teohhanhui I mentioned I had no success even with sudo because I was asked about the user I was using to run it and about permissions.\nI'm not using user namespaces.. @Simperfit \nrenan@taranto ~/projects/api-platform-master/docker/varnish/conf $ ls -la\ntotal 12\ndrwx------ 2 renan renan 4096 Jun  6 22:00 .\ndrwx------ 3 renan renan 4096 Jun  6 22:00 ..\n-rw-r--r-- 1 renan renan 1934 Jun  6 15:53 default.vcl. It is related to file permissions. I did the following tests:\n\n\n$ chmod a+rwx docker/varnish/conf/default.vcl \"solves\" the varnish error and gives me the FastCGI - \"Primary script unknown\" error back again;\n$ chmod a+rwx -R api-platform-master/ \"solves\" both problems and the app works.\n. Solved. Cloning instead of downloading the zip solves. Thanks.. Varnish does a health check at the root path '/' (see this) so it must be anonymously accessible.\n\nYou can change the probe url to another path (it must allow anonymous access) or add a rule in your security.yml like:\nyaml\n    access_control:\n        - { path: ^/, roles: IS_AUTHENTICATED_ANONYMOUSLY }\n        - { path: ^/api,  roles: IS_AUTHENTICATED_FULLY }. @Bwen Could you show us your access_control section and your default.vcl?. @Bwen Try adding anonymous: true to your api firewall settings. You can do that or move your main firewall settings above the api settings.. ",
    "leroy0211": "A few weeks ago I've seen a symfony bundle that can add linked data to entities by using only annotations.\nFor example to publish a blog post. The /publish or /unpublish links could be added as a Relation with specific expressions like only add the /publish link if the isPublished() method returns false. And only if the requested user has the ADMIN role.\nI've just found the related bundle:  https://github.com/willdurand/BazingaHateoasBundle\nI think this can be usefull, but might not be the best solution to integrate these links/actions.\n. Ok. Let me try that. \nBut this JSON-LD documentation states that there is an @value property. At the typed-values section.\nhttp://json-ld.org/spec/ED/json-ld-syntax/20120522/#typed-values\nI was trying to use this lib as a basic client for api-platform. As for a simple test on the people api, it failed because of the @value attribute not available.\n. ",
    "3kynox": "Hello dunglas, thanks for your answer and sorry again for french speaking; I'll try to give more details in english this time.\n- Ok for 2.8 and 3.0, good to hear.\n- Thanks for other angular resources link, I'll study it today.\n- And yes, was meaning API-Platform (instead of APIDoc), sorry for wrong name usage.\n  Oauth is already configured in my Symfony project. About this subject, and because FOSUser is the enabled provider,\nyml\noauth_authorize:\n            pattern:    ^/oauth/v2/auth\n            # Add your favorite authentication process here\n... is not needed. I passed some time to get this sorted out :)\nThanks for oauth.io link, as it is a pay solution, I'll find something free and open.\nMy biggest problem today is to remove views and security controller from symfony (used by FOSUser) and create views (login / profile / etc...) now from angular app connected to FOSUser, using OAuth. Then I have with FOSRest bundle to expose users in json. And not sure what's the good way to achieve this.\nAnyway, thanks again for informations and keep up your project !\n. I gave a try already to satellizer. Unfortunately, following satellizer documentation, it grab user informations, server have to generate a json web token and then return this token to client for further resources use. My Symfony configuration currently uses grand type client_credentials and bearer which is not exactly the same behavior. I don't think satellizer is well-designed for my problem.\nExisting issue created by my own : https://github.com/sahat/satellizer/issues/693\nI'll give out a try to API-Platform now and implements experimental ng-admin. Once done, I'll have a fresh reflexion on oauth implementation.\n. Ok, I'll give out a try to API-Platform, JSON-LD / Hydra and handle authentication with JWT (using LexikJWTAuthenticationBundle & GfreeauGetJWTBundle) and Satellizer.\nJust hope I can use forms only from angular client side (also for login form that returns JWT Token) and get rid of any controller / views from Symfony.\nIf we can keep this discussion open for any encoutered problems and sharing results for it can benefit to API-Platform.\n. login (angular) form ?\n. Let's give a try. If you got some working examples to handle this from angular?\nActually creating my local vhosts and cloning api-platform then upgrading to 2.8.\n. For information, I'm following\n\nhttps://api-platform.com/doc/1.0/getting-started/api\n\nschema command generate error with \"SocialMediaPosting\" according to your given example : \n\n$ bin/schema generate-types src/ app/config/schema.yml\n[critical] Type \"SocialMediaPosting\" cannot be found.\n\nEDIT: error corrected by removing line : \n\nrdfa:\n- https://raw.githubusercontent.com/schemaorg/schemaorg/sdo-gozer/data/schema.rdfa\n\nFurther while installing FOSUserBundle, an error is present on your documentation : \n``` yml\napp/config/services.yml\nresource.user:\n        parent:    \"api.resource\"\n        arguments: [ \"AppBundle\\Entity\\User\" ]\n        calls:\n            -      method:    \"initNormalizationContext\"\n                   arguments: [ { groups: [ \"user_read\" ] } ]\n            -      method:    \"initDenormalizationContext\"\n                   arguments: [ { groups: [ \"user_write\" ] } ]\n        tags:      [ { name: \"api.resource\" } ]\n```\nIt's needed here to put double \\ as : arguments: \nyml\n[ \"AppBundle\\\\Entity\\\\User\" ]\nSome more details on how to handle FOSUserBundle installation could be cool on your documentation, I followed 7 default installation steps but not sure if all these steps are needed. \n\nAlso, Is it possible to use doctrine yml files instead of annotations ?\n. Superb! We had a meeting with our company this morning, maybe you'll be able to add an additional company that uses api-platform soon. Display data in several formats was one of our requirements.\nIt looks like to get benefits of content-negociation features I'm forced to use api-bundle to dev-master from composer. Unfortunately I got error : \n\nContextErrorException in DunglasApiProvider.php line 48:\nCatchable Fatal Error: Argument 3 passed to > Nelmio\\ApiDocBundle\\Extractor\\AnnotationsProvider\\DunglasApiProvider::__construct() must be an instance of Dunglas\\ApiBundle\\Mapping\\ClassMetadataFactoryInterface, instance of Dunglas\\ApiBundle\\Mapping\\Factory\\ClassMetadataFactory given, called in D:\\clients\\courtier-web\\api-platform\\www\\app\\cache\\dev\\appDevDebugProjectContainer.php on line 2669 and defined\n\nI suppose it's related to 2.0 version in preparation warning you gave me just before.\nA last question please, do you have some information link that show a complete list of benefits using your framework against a classical FOSRest setup ?\nThanks again.\n. Thanks for answer dunglas. I disabled already NelmioApiDoc friday but I'm facing another problem. \nI enabled another format in config.yml (supported by Content Negociation) : \n\nsupported_formats: [ \"jsonld\", \"xml\" ]\n\nBut PostMan return this : \n\nEverything working fine with json-ld return.\nThanks for support.\n. Ok, because doc indicates : \n\nIf the format you want to use is not supported by default in the Negotiation library...\n\nI understood all parts below is not necessary. Looks like I was wrong :)\nThen, \"Registering a custom format in the Negotiation library\" & \"Registering a custom serializer\" is only for custom format not supported by Content Negociation by default, right ?\nI think documentation can involve doing mistakes.\nChecking all of this and sharing a pull request soon for doc.\nEDIT: Now working great and return xml :)\nJust made a HtmlResponder on the way as the xml one, answers : \n\n\"hydra:description\": \"Serialization for the format html is not supported\",\n. Morning`\n\nStill facing : \n\n\"hydra:title\": \"An error occurred\",\n  \"hydra:description\": \"Serialization for the format html is not supported\",\n\nsrc/MyBundle/EventListener/HtmlResponderViewListener.php countains :\n``` php\n<?php\nnamespace ContactBundle\\EventListener;\nuse Symfony\\Component\\HttpFoundation\\Request;\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\HttpKernel\\Event\\GetResponseForControllerResultEvent;\nuse Symfony\\Component\\Serializer\\SerializerInterface;\nclass HtmlResponderViewListener\n{\n    const FORMAT = 'html';\n/**\n * @var SerializerInterface\n */\nprivate $serializer;\n\npublic function __construct(SerializerInterface $serializer)\n{\n    $this->serializer = $serializer;\n}\n\npublic function onKernelView(GetResponseForControllerResultEvent $event)\n{\n    $controllerResult = $event->getControllerResult();\n\n    if ($controllerResult instanceof Response) {\n        return $controllerResult;\n    }\n\n    $request = $event->getRequest();\n\n    $format = $request->attributes->get('_api_format');\n    if (self::FORMAT !== $format) {\n        return $controllerResult;\n    }\n\n    switch ($request->getMethod()) {\n        case Request::METHOD_POST:\n            $status = 201;\n            break;\n\n        case Request::METHOD_DELETE:\n            $status = 204;\n            break;\n\n        default:\n            $status = 200;\n            break;\n    }\n\n    $resourceType = $request->attributes->get('_resource_type');\n    $response = new Response(\n        $this->serializer->serialize($controllerResult, self::FORMAT, $resourceType->getNormalizationContext()),\n        $status,\n        ['Content-Type' => 'text/html']\n    );\n\n    $event->setResponse($response);\n}\n\n}\n```\n... and html is activated ...\nyml\ndunglas_api:\n    title:       \"%api_name%\"\n    description: \"%api_description%\"\n    supported_formats: [ \"jsonld\", \"xml\", \"html\" ]\nAm I right to think Content-negociation do not allow Html output without defining Registering a custom format in the Negotiation library throw compiler pass and I have also to register  a custom serializer ?\nThanks for help.\n. Can you try removing your vendor/ dir if existing and retry ?\n. Hello there.\nI read someone accomplished running api-platform on Laravel.\nIs there any location that explain the process ?\nThanks in advance. ",
    "marcin-piela": "Sorry my bad, in Nelmio Sandbox everything is send as string\n. ",
    "cvernerie": "@dunglas I am using the latest version (2-alpha) and I have the same problem with those values :\n{\"billingDate\":\"2016-08-30T09:33:22.917Z\",\"trader\":\"Restaurant\",\"totalAmount\":240}\n\"The type of the \"totalAmount\" attribute must be \"float\", \"integer\" given.\"\n. @dunglas \nPOST /notes HTTP/1.1\nHost: api.exemple.com\nConnection: keep-alive\nContent-Length: 69\nPragma: no-cache\nCache-Control: no-cache\naccept: application/ld+json\nOrigin: http://exemple.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36\ncontent-type: application/ld+json\nReferer: http://exemple.com/\nAccept-Encoding: gzip, deflate\nAccept-Language: fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4\n. @dunglas \n{\"billingDate\":\"2016-08-30T09:33:22.917Z\",\"trader\":\"Restaurant\",\"totalAmount\":240} \n. The problem is that in Javascript you can't cast an int to a float :\nparseFloat('200')  // == 200\nparseFloat('200').toFixed(2) // == '200.00'\nparseFloat('200.00') // == 200\n. @dunglas That works fine, thanks ! :)\n. ",
    "Shine-neko": "@dunglas https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Serializer/Normalizer/AbstractObjectNormalizer.php#L275 same problem ? :trollface: \n. @dunglas ? :) \n. Quote ? . ",
    "juliendufresne": "Hello @sroze ,\nIn order for this project to be able to migrate to symfony3, we need:\n- new tag for the api-platform/schema-generator (requirement on symfony/yaml ~2.4 only solved in the master branch)\n- in behat/mink fix the dependency on symfony/css-selector ~2.1\n- in behat/mink-browserkit-driver fix the dependency on symfony/dom-crawler ~2.3\n. ",
    "keyermann": "yeah I do, and than composer install run without any problem. But post-root-package-install isn't executed as it is only executed after the root package has been installed, during the create-project command.\nSo I don't know if this script is important. But for the moment every time I try to create a new project with \ncomposer create-project api-platform/api-platform blog-api I have the warning.\nI'll try to use api-platform without it.\n. Ok, I let you the choice to close this issue then.\nThank you for your assistance @3kynox and @dunglas \nHave a nice day\n. ",
    "jdgriffith": "Still experiencing this issue.\n```\nProblem 1\n    - Installation request for behatch/contexts dev-master -> satisfiable by behatch/contexts[dev-master].\n    - behatch/contexts dev-master requires php ~5.4 -> your PHP version (7.0.2) does not satisfy that requirement.\n```\n. ",
    "luispabon": "That mink issue was fixed and a mink release done; what's the progress of 1.1? I feel dirty when requiring dev-master deps.\n. Been looking into this as I'm working on a project which reads and writes\nfrom such an API format. The serialiser and headers should be\nstraightforward enough to implement; however, json API mandates a very\nspecific url format which at this point I'm unsure it's compatible with\nwhat API platform is currently using. Need to check in a bit more detail.\nWould be a winner to have both available at the switch of an accept header!\nOn Fri, 3 Jun 2016, 00:23 Hector Hurtarte, notifications@github.com wrote:\n\nHi there, I'm quite interested in working on this.\nI've never done any open source major contribution so a little help would\nbe very much appreciated :-) On the other hand I think I know my way around\nSymfony.\nSince JSON-API has its own Content-Type I would think content negotation\nshould determine if using a possible JSON API serializer, right?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/api-platform/api-platform/issues/82#issuecomment-223451529,\nor mute the thread\nhttps://github.com/notifications/unsubscribe/AGF8Vx1qj4mSsBQusaiBx53H3cZjBV_0ks5qH2XfgaJpZM4IeIHM\n.\n\nKind regards,\nLuis Pabon\n. \ud83d\udc4d \n\nWould you be in favour of integrating a third party package to provide with serialisation, or implement our own?\n. There are options such as https://github.com/neomerx/json-api which we could piggyback on\n. \ud83d\udc4d \n. I went down the route of providing my own images on http://phpdocker.io for certain components (php and redis mostly) due to ocassional breakages happening upstream. PHP extensions would fairly often fail to build due to missing build dependencies or compilation errors. \nAlso a timesaver for users as you can offer a more integrated experience as everything's already built and requires nothing more than pulling the image.\nI would recommend doing the same, and would be happy to help setting this up if you guys would be up for it. You'd need a repo and an account on docker hub.. Also on the client generator:\nStep 1/8 : FROM node:9.4-alpine\n ---> b5f94997f35f\nStep 2/8 : RUN mkdir -p /usr/src/client\n ---> Running in 94546bf65551\nRemoving intermediate container 94546bf65551\n ---> ec55b8a46b9c\nStep 3/8 : WORKDIR /usr/src/client\nRemoving intermediate container 05e577c9c250\n ---> 6dfa2b3b9bbd\nStep 4/8 : RUN yarn global add @api-platform/client-generator\n ---> Running in 579389f840d2\nyarn global v1.3.2\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nsuccess Installed \"@api-platform/client-generator@0.1.15\" with binaries:\n      - generate-api-platform-client\nDone in 6.24s.\nRemoving intermediate container 579389f840d2\n ---> 89dc64dae689\nStep 5/8 : COPY package.json yarn.lock ./\n ---> 78a934aeba32\nStep 6/8 : RUN yarn install\n ---> Running in 1a5acf7a74fd\nyarn install v1.3.2\n[1/4] Resolving packages...\n[2/4] Fetching packages...\ninfo fsevents@1.1.2: The platform \"linux\" is incompatible with this module.\ninfo \"fsevents@1.1.2\" is an optional dependency and failed compatibility check. Excluding it from installation.\ninfo fsevents@1.1.3: The platform \"linux\" is incompatible with this module.\ninfo \"fsevents@1.1.3\" is an optional dependency and failed compatibility check. Excluding it from installation.\n[3/4] Linking dependencies...\nwarning \" > bootstrap@4.0.0\" has unmet peer dependency \"jquery@1.9.1 - 3\".\nwarning \" > bootstrap@4.0.0\" has unmet peer dependency \"popper.js@^1.12.9\".\nThis time popper and jquery.. ",
    "WitteStier": "I still have this issue. Please mention :dev-master in the get started page.\n. ",
    "akadlec": "Hi, i would like to reopen this issue.\nI have same problem. When you use table inheritance (single table in my case) the error with unknown resource occurs.\n@teohhanhui yes, this is a possible way, but what to do in cases when you do not want to have this types of resources, but only one \"User\" ?. Yes this, but this does not work, the result is: Update is not allowed for this operation.. ```\n/\n * @ApiResource(\n *     attributes={\n *         \"normalization_context\"={\n *             \"groups\"={\n *                 \"dashboard-read\"\n *             }\n *         },\n *         \"denormalization_context\"={\n *             \"groups\"={\n *                 \"dashboard-write\"\n *             }\n *         }\n *     },\n *     itemOperations={\n *         \"get\"={\n *             \"method\"=\"GET\", \"path\"=\"/v1/dashboards/{id}\"\n *         },\n *         \"put\"={\n *             \"method\"=\"PUT\", \"path\"=\"/v1/dashboards/{id}\"\n *         },\n *         \"delete\"={\n *             \"method\"=\"DELETE\", \"path\"=\"/v1/dashboards/{id}\"\n *         }\n *     },\n *     collectionOperations ={\n *         \"get\"={\n *             \"method\"=\"GET\", \"path\"=\"/v1/dashboards\"\n *         },\n *         \"post\"={\n *             \"method\"=\"POST\", \"path\"=\"/v1/dashboards\"\n *         }\n *     }\n * )\n * @ORM\\Entity\n */\nclass Dashboard implements IDashboard\n{\n    /\n     * @var Uuid\\Uuid\n     \n     * @SerializerGroups({\"dashboard-read\"})\n     * @ORM\\Id\n     * @ORM\\Column(type=\"uuid_binary\", name=\"dashboard_id\")\n     * @ORM\\CustomIdGenerator(class=\"Ramsey\\Uuid\\Doctrine\\UuidGenerator\")\n     /\n    private $id;\n/**\n * @param string $id\n *\n * @return void\n */\npublic function setId(string $id)\n{\n    $this->id = Uuid\\Uuid::fromString($id);\n}\n\n/**\n * @return Uuid\\UuidInterface\n */\npublic function getId() : Uuid\\UuidInterface\n{\n    return $this->id;\n}\n\n}\n```\nProblem is, when in POST is ID api-platform is thinking that i want to do an UPDATE action.. From me, no, i am leaving this bundle and going back to other solution. @dunglas it is normal to send ID from app. I case you have app with optimistic ui and all ID's are in UUID format, you could generate ID in you app and send it to api endpoint and you don't have to wait for positive response.. Right now i'm not 100% surre but i thing i did a test where i remove this row. Problem is not in doctrine mapping but in apiplatform. There is a method which check request and when an ID is present in request and request is in POST method, platform refuse it. I'm not pro user of Symfony. I tried to find the problem and the problem is in the generated getSerializerService. In this method is defined Symfony's ObjectNormalizer but without name converter. So mabye wrong service definition ?. ok this will fix it:\nframework:\n    serializer:\n      name_converter: app.name_converter\nbut i think there is something wrong in the api core. ",
    "aitboudad": "should I include intl too ?\n. I don't have much time to complete this pr, @teohhanhui could you take care of it ? thank's\n. fixed\n. ",
    "dzubchik": "@aitboudad , what about opcache? It gives 2 times less memory consumption and better response time\n. ",
    "gorghoa": "Hi everyone, I think @teohhanhui is right when saying it depends on the target. For a developer setup, I would rather have vendors in volumes. But for a distribution setup, I think the composer install thing should be done on build\n. Hi @vincentchalamon, @teohhanhui, \nPlease Consider this workflow : \nFirst, I create a new api platform project with composer create-project blabla, composer will automatically load the dependencies: 1st composer install\nSecond, I fire the docker-compose up command, then the docker build begins, executing composer install from the Dockerfile: 2nd composer install\nThird, my container is up and running, thanks to docker-compose, with my project directory mounted as a volume at /app, therefore annihilating the  use of  the composer install in the docker build step since the volume uses the host machine vendors directory, not the one from the freshly created image.\nConclusion, I think the developer experience when starting a new project with a docker environment could be enhanced by stripping the composer install from the build (heck, we\u2019ve already bear the php extensions compilations ;-) ).\nMaybe, we should considering one Dockerfile for production (probably in a repository of its own, in order to profit of the docker hub automated builds) and one in the api-platform repo for developer use (without apache, using bin/console  server:run 0.0.0.0.8000 as docker command).\n(Moreover, if the user public ip has overpassed the github unidentified fair use quota, the composer install will fail during the build, since the composer github auth token is not shared during the build.)\n. indeed, I am happy \\o/, thanks for the update :)\n. > I would be great to have a doc entry like this, I agree. Maybe @gorghoa do you have some hints about this?\nThanks @dunglas  for inviting me to this discussion :)\nUnfortunately, I did not took that path all the way down yet. Given the timebox I had, I simply wrote some custom data provider/persister targeting custom domain boundaries and \u00ab\u202fproxified \u00bb all the api routes  to a standard api-platform instance to handle routing/content negociation/security and the like.\nI do not regret it, since I was able to leverage some symfony niceties (especially DI and security).  I doubt that this is an option for you @guilhermeaiolfi though.. ",
    "n1c01a5": ":+1: \n. I have this error after docker-compose up : \n```\n[Doctrine\\DBAL\\Exception\\ConnectionException]                                                                                 \n  An exception occured in driver: SQLSTATE[HY000] [2002] php_network_getaddresses: getaddrinfo failed: Name or service not known  \n[Doctrine\\DBAL\\Driver\\PDOException]                                                           \n  SQLSTATE[HY000] [2002] php_network_getaddresses: getaddrinfo failed: Name or service not known  \n[PDOException]                                                                                \n  SQLSTATE[HY000] [2002] php_network_getaddresses: getaddrinfo failed: Name or service not known  \n[PDOException]                                                                             \n  PDO::__construct(): php_network_getaddresses: getaddrinfo failed: Name or service not known  \nERROR: Service 'web' failed to build: The command '/bin/sh -c ((rm -rf var/cache/ && rm -rf var/logs/ && rm -rf var/sessions/*) || true)     && composer install -o && bin/console cache:warmup -e=prod     && chown -R www-data . var/cache var/logs var/sessions' returned a non-zero code: 1\n```\n. @teohhanhui thx\n. I try to set in the parameters.yml the correct information of my database (host address, username, password, database name).\ncp app/config/parameters.yml.dist app/config/parameters.yml\n    vi app/config/parameters.yml # to set the configuration\nBut always the same error.\n. ",
    "soyuka": "As v2 will be out soon, nope. Still, we might want to consider the above for v2. Instead of branches, we can do this with tags.\n. Mhh, I don't agree to the has_role thing tough. My roles are slightly more complicated than that and can't be gathered to a simple ROLE_ADMIN/ROLE_USER. If it's embedded, it'd have to be more powerful imo. \n. > I confirm I can update with POST\nYou have http_method_override: true?\n. In your case you should use a ResultExtension. You can find some examples here (not merged yet). Interfaces are available here. \nThis allows you to do some custom operations before you return results. By settings the priority after the PaginationExtension (for example 10) you'll be able to return results before it reaches this one.\nYou may also use a custom DataProvider where you'd be able to get rid of every extensions/filters and do queries on your own. I'd advise the use of extensions if you want to preserve filters and low-level extensions.\n. As this seem to be a common request, maybe we can consider an annotation/specific metadata for this purpose?\n. What about doing this on the orders instead if you want orders? \nFor example with a filter on the user property:\n/orders?user=x\nWith correct serialization groups, you'd get what you want no?\n. Done\n. This has to be merged in combination with api-platform/core#768\n. May it has to be with the fact that  api-platform/core#768 isn't available yet?\n. We made a few last-minute breaking changes but it's really close now ;). There is one last thing to resolve though about EagerLoading max depth taking the serialization max depth into consideration to avoid recursivity issues but it can be patched after the stable release IMO, WDYT @teohhanhui?\n. yes, see here\n/**\n * @ApiResource(\n *     attributes={\"normalization_context\"={\"groups\"={\"get\"}}},\n *     itemOperations={\n *          \"get\"={\"method\"=\"GET\"},\n *          \"put\"={\"method\"=\"PUT\", \"normalization_context\"={\"groups\"={\"put\"}}}\n *     }\n * )\n */\n. Okay, I get back what I said about www-data. I experimented a lot to find the best solution for permissions and I've come with this solution: https://github.com/soyuka/api-platform-docker-test. \n@jockos wdyt?\nIn this pull request some things should be changed:\n\nThe docker-compose volume for nginx should be a volume_from referencing the php image\nCOPY is indeed better than ADD for what we need. Still, we don't need to copy the files that are used through the volume. This also reduces the number of volumes to 1.\nIMHO, we should avoid using paths like /srv, but instead use /api-platform, it's cleaner\nThe same goes for the start.sh script, docker_endpoint.sh or docker_cmd.sh is better\nIf we use alpine for nginx, we should use it for php-fpm too\ncomposer should not run as root, instead we should use gsudo (on debian) or su-exec (on alpine) (this means creating a www-data user anyway)\nWith this line, we should be able to avoid any script that tries to fix the permissions:\n\ndocker-compose run --rm php chown -R $(id -u):$(id -g) .. > Alpine isn't compatible with some extensions yet including Blackfire (but a version supporting Alpine will be released soon). Maybe can we switch to Alpine anyway but add a comment to make it explicit that some extensions aren't compatible with it and some instructions to switch to Debian.\nWe can also use Debian for nginx and Debian for php-fpm. It's just to avoid pulling to many files as docker really eats lot of space. Your call!. In v3, which hasn't been released yet (or has it?). We're setting version: '2', therefore I think we can use it safely. . > Our fpm container is running as user www-data, which is uid 33\nThis isn't correct here, but assuming this sets the correct permissions to the volume inside the container, will you be able to write in the volume from the host? For the development version, we want to be able to edit files from the host.\n. targetEntity=\"Asset\" why not the full namespace (saying this because AppBundle\\Entity\\Catalog\\\\Asset looks weird)? Is the use statement included? Is it an actual resource which is declared as @ApiResource?\nIn YAML the class property has been removed:\nBefore:\nresources:\n    product:\n       class: 'Product\\ProductBundle\\Entity\\Product'\nToday:\nresources:\n    'Product\\ProductBundle\\Entity\\Product': ~\n. This is the problem IMO:\n\nEntity Asset is not a declared resource.\n\n. > No, it's not. Can you post enough code and config to reproduce the bug?\nThough this error is caused by a ResourceClassNotFoundException right? I'd assume that it's because of a $resourceMetadata->create() that does not catch this exception. Hence the fetch=\"EAGER\" I'd (again assume) this one.\n. Ofc. Can you set the option to true and check if this still happens? Thanks.\nyaml\napi_platform:\n  eager_loading:\n    force_eager: false. I'd love to have more details on the entity that was having memory issues!. I have way more entities than this sometimes and I'm not seeing any memory issue (having trouble exceeding 10 MB). Indeed, I'd like a way to reproduce.. Nope I need to bench this but sorry not much availability lately... Also we need to introduce the maxDepth thing. Or we can transfer this issue to api-platform/core as you want ;). api-platform/core#1161. Indeed, you have a recursive relation here, where campaign is referencing itself. You may want to disable eager loading here by using @ApiResource(attributes={\"force_eager\"=false}).. We're working on this as some would want to get back a limited number of relations. The best option would be to use the serializer max depth property. \nWhile we work on this, I think that Doctrine will use lazy loading if you serialize correctly. You may also try fetch=\"EAGER\".. If you use force_eager=false the extension will  \n\napply it only on join relations having the EAGER fetch mode\n\n. And without fetch=\"EAGER\"?. https://github.com/api-platform/core/blob/master/tests/Fixtures/TestBundle/Entity/CircularReference.php\nThis does serialize an array of childrens, can be seen here.. I think that this works as I've a similar route working. What's your dirty workaroud? You should not need one. Can you show us entities?. Indeed, you can do this by using serialization groups. . It should work as expected. Maybe you need to set up some transitive persistence for Doctrine to update your ManyToMany relation.\nI don't have a real example, but you should be able to do something like:\n```\nPUT /products/2\n{'@id': '/products/2', translations: [{'@id': '/translation/2', name: 'foobar'}]\n```\nAnd doctrine will update the given item (maybe that a merge operation is required on the Doctrine side, not sure). If you add one without an @id and if cascade persist is set up, doctrine should create a new association.. So those are not associations? If you want the association to be handled by api-platform correctly it should be a Resource.. Linked discussions:\nhttps://github.com/api-platform/core/issues/395\nhttps://github.com/api-platform/core/issues/583\nhttps://github.com/api-platform/core/issues/145. +1 it's out of scope here . Not sure that this should be fixed from the start.sh file, see this file. > Wouldn't be better to run the composer install with the apache user instead of doing this?\n+1 everything should be done as one user, ie www-data.. Hmm, I don't get why this is needed.\nWhat I do in my own config:\nversion: '2'\nservices:\n  php:\n    container_name: api_platform_php\n    build: php-fpm\n    ports:\n      - \"9000:9000\"\n    volumes:\n      - ./symfony:/var/www/symfony\n  nginx:\n    container_name: api_platform_nginx\n    build: nginx\n    ports:\n      - \"8081:80\"\n    depends_on:\n      - php\n    volumes:\n      - ./symfony:/var/www/symfony\n      - ./logs/nginx/:/var/log/nginx\nWhere ./symfony is a symlink to the project:\nlrwxrwxrwx 1 abluchet abluchet   21 Aug  1 17:40 symfony -> /home/abluchet/project\nThen, everything runs as www-data, I have no hacks whatsoever. The only thing I do in both Dockerfiles is to set the same uid:\nRUN usermod -u 1000 www-data\nI could post my docker configuration if you want.. Both linux @ work and os x @ home. This works on both.\nOn windows it'd require some more work because of the symlink.. You mean using a 50 lines bash script instead of 1 line in the Dockerfile? ^^ Anyway it's different here because I just need nginx and php-fpm to run on the same user. Though I don't need anything for my volume permission.. > @soyuka it's very important for the first impression to have something working out of the box, without requiring any weird config, even for people not confortable with Docker.\n100% agreed. Okay, so I've spent a few hours playing with your docker configuration. I see a few issues but those can not be solved properly with the current  FROM php:7.0-apache.\nThe hack in start_safe_perm is not necessary (oh and btw it comes from here) if we use the envvars file that is sourced by apache2-foreground, a binary declared by https://github.com/docker-library/php. \nWe could make this work if we were not installing the composer dependencies within docker. Indeed, by doing so, if we want correct permissions, we need to issue the composer command from www-data. If it's run by root directories will have the wrong permissions. For example, as composer post install scripts are creating the cache directories, it'll fail.\nSo what about running everything as www-data as I suggested?\nBecause, the docker source image we're using is exposing the 80 port, which is restricted to root. Though, it would just work great with the 8080 port which would be forwarded to 80 by docker-compose (host has root capabilities). The thing is, it's hard coded and there are no ways to change it (check the related issues on https://github.com/docker-library/php). \nWhat now?\nA cleaner hack is to use a simple su -s /bin/bash -c \"composer command\" www-data when we need to so that the permissions are maintained.\nIMHO, it would be best to make this work by using php-fpm and nginx, because they're not using any unsafe port. Or, we just use another php image that doesn't require the 80 port (example with alpine + nginx).\nI'm adding a pull-request now.\n. Okay I'll take a look at it!. Wow, I really don't get where does the vendor directory goes. Everything goes well :\nWriting /var/www/.composer/cache/files/symfony/swiftmailer-bundle/eed9cefd9dccaf9e2407c55d0f15ad1507da4754.zip into cache from /var/www/app/vendor/symfony/swiftmailer-bundle/b1aeaaefeb5385689d093a4766210939\nBut the vendor directory just doesn't get written. Though, when doing docker-compose up -d you can access localhost and everything is fine.\nMaybe I'll try to dockerize composer seems overkill though.. apcu and opcache added!\nComposer installation is done on the build phase. It forces us to copy everything while we left the volume do its thing without it.. Differences with #162:\n\napi-platform root path /src/app instead of /api-platform (I really don't get this part)\nimplement named volumes instead of volume_from\nCOPY every sub-path of the root repository (what about using only the composer files and letting the volume do the rest?). #162. Looks like it's okay to him, don't hesitate to ping back if you want this to be opened again :). @devrck it's just a service that you inject in your data provider.. What do you mean? You can also do your filtering directly in the data provider ;).. https://github.com/api-platform/docs/blob/master/core/graphql.md \n\nThough, please note that this feature is experimental and still in development!. Doh, https://github.com/api-platform/core/pull/1633. You can disable Eager loading by using:\n* @ApiResource(attributes={\"force_eager\"=false})\nOne of the side-effects is Lazy Loading. If you remove every extension you'll lose filter and pagination extensions, I'd recommend to disable it through the configuration instead.\nRead more about this extension here. . @ZeBigDuck  Would it be possible to have a subtract of your entites and the HTTP query issued? I'd like to reproduce this to see where there might be an issue!\nThanks!. This works fine to me, just add a getter for id on your abstract class:\nphp\n    public function getId() {\n        return $this->id;\n    }\n\n. :) yeah already had this one, I'd recommend the use of yaml/xml files for serialization groups, as it offers more possibilities!. IMO yes, IRI's are part of the jsonld format. When using plain json we should return {id: 12}.. Indeed the documentation about the service definition is wrong, yours is correct. Would you mind fixing this in https://github.com/api-platform/docs/blob/master/core/extensions.md? Thanks!. https://github.com/api-platform/docs/pull/183 merged. I'm not sure what would be the proper way to do this in xml. Should we add a node for disallowing operations?\nping @dunglas @teohhanhui . This would indeed make sense, like:\nNo-op:\nxml\n<collectionOperations />\nCustom\nxml\n<collectionOperations>\n    <collectionOperation method=\"GET\" />\n</collectionOperations>\nWithout the node, everything operation is enabled.\n@sawmurai would you be able to submit a pull request for this? I'm not sure that we can find a cleaner fix without breaking current xml implementations and we have some pending pull requests that are breaking things anyway (ie new release soon? I hope :p).. Did you enable route annotations?\nDid you clear the cache?\nMay we have an output subtract of bin/console debug:router?. The match is wrong apparently. I'm not sure your route is actually registered, can you execute:\nbin/console router:debug | grep campaigns\n. debug:router then sorry. if it doesn't show up in bin/console debug:router there's a misconfiguration somewhere.. So, based on the standard edition (master, this repository):\n\nGit patch file\n\n```diff\ndiff --git a/src/AppBundle/Action/FooCustom.php b/src/AppBundle/Action/FooCustom.php\nnew file mode 100644\nindex 0000000..75cc28e\n--- /dev/null\n+++ b/src/AppBundle/Action/FooCustom.php\n@@ -0,0 +1,22 @@\n+php\n+namespace AppBundle\\Action;\n+\n+use AppBundle\\Entity\\Foo;\n+use Sensio\\Bundle\\FrameworkExtraBundle\\Configuration\\Method;\n+use Symfony\\Component\\Routing\\Annotation\\Route;\n+\n+class FooCustom\n+{\n+    /**\n+     * @Route(\n+     *   name=\"foo_custom\",\n+     *   path=\"/foos/custom\",\n+     *   defaults={\"_api_resource_class\"=Foo::class, \"_api_item_operation_name\"=\"custom\"}\n+     * )\n+     * @Method(\"GET\")\n+     */\n+    public function __invoke()\n+    {\n+\n+    }\n+}\ndiff --git a/src/AppBundle/Entity/Foo.php b/src/AppBundle/Entity/Foo.php\nindex 3d0e31d..605d1fc 100644\n--- a/src/AppBundle/Entity/Foo.php\n+++ b/src/AppBundle/Entity/Foo.php\n@@ -9,7 +9,11 @@ use Symfony\\Component\\Validator\\Constraints as Assert;\n /**\n  * This is a dummy entity. Remove it!\n  *\n- * @ApiResource\n+ * @ApiResource(collectionOperations={\n+ *   \"get\"={\"method\"=\"GET\"},\n+ *   \"post\"={\"method\"=\"POST\"},\n+ *   \"custom\"={\"route_name\"=\"foo_custom\"},\n+ * })\n  * @ORM\\Entity\n  */\n class Foo\n```\n</details\nYou can apply this patch in the main repository by: \n1. clone the repository\n2. curl https://gist.githubusercontent.com/soyuka/36c01a56404bdfb323010e013b3d11f7/raw/950bd1dc6ab90d872efef07f8cef534a802f35cf/custom.patch | patch -p1\nbin/console debug:router output (extract):\napi_foos_get_collection    GET      ANY      ANY    /foos.{_format}\n  api_foos_post_collection   POST     ANY      ANY    /foos.{_format}\n  api_foos_get_item          GET      ANY      ANY    /foos/{id}.{_format}\n  api_foos_put_item          PUT      ANY      ANY    /foos/{id}.{_format}\n  api_foos_delete_item       DELETE   ANY      ANY    /foos/{id}.{_format}\n  foo_custom                 GET      ANY      ANY    /foos/custom\nBut indeed, bin/console router:match /foos/custom matches api_foos_get_item.\n@teohhanhui is this the expected behavior in route path matching?. Yeah indeed, it's not matched because of the itemOperation regex match. I'm not sure if this is a bug or not (ping @teohhanhui). . closing as old, feel free to ping or open a new one. I don't use swagger and I do add /api to my custom operation's path for it to be correct.. You need to inject the filters in your data provider and apply them. You can also use the FilterExtension to enable every filter.\nSee here for example: https://github.com/api-platform/core/blob/428683885c3c784cb449857ff814eeed02c9a62c/src/Bridge/Doctrine/Orm/CollectionDataProvider.php#L64. https://github.com/api-platform/core/issues/1025. Closing, feel free to ping if it's not working.. We're using nginx now, this looks like you're using an old version.. Can you try master ?. Hmm, nope. @iCodr8 has implemented oauth for swagger only see \nhttps://github.com/api-platform/core/pull/982\nRef: https://github.com/api-platform/core/pull/982#issuecomment-288992744 . Closing this one in favor of https://github.com/api-platform/core/issues/1025 :).. MongoDB is not yet supported see https://github.com/api-platform/core/pull/461.. Soon \\o/ https://github.com/api-platform/core/pull/904. @blaues0cke can you try to avoid fetch=\"EAGER\" and let our EagerLoadingExtension do the work?  \n\nI double checked all the serialisation groups and they even work in the third nesting level for title and description. Is there a default nesting limit for nested properties or something like that? Or am I facing a bug? :-)\n\nI always though we need some kind of serializer debugger for groups, can be a headache. \nWould you be able to reproduce this issue on a fork of api-platform/api-platform? As @dunglas said, this probably mean that relations have not been fetched by the query, and they're serialized as null. Usually when I have such issue, it is group-related.\n@nik-lampe it seems like your issue is related to inheritance, I don't see any here.. @nik-lampe you wrote lots of different issues / comments so it's hard to track ^^. I added a comment in your pull request, but if there are 2 different problems we need to carefully test both and fix both separately! \n\nThis null issue (IMHO it's a serialization group issue, not related to how the ResourceClassResolver works (or maybe but I've a lot of embedded relations and no such issue)\nThen there is https://github.com/api-platform/core/issues/1025. This is indeed a bug where the Parent entity is not aware of the Child metadata. Therefore, it can not serialize properties it doesn't know of. This is harder to fix, because the metadata is the one from Parent::class though it should be Parent::class + Child::class. The good question there is \"how do we find every child that extends the parent?\". \nAn easy fix is might be to patch this class by retrieving the metadata for table inheritance. . @blaues0cke no, the best way to figure this out is to have a behat test case with your issue (or a fork of api-platform/api-platform with your entities + groups that reproduces the issue). The PR fix is not valid. . Maybe related to https://github.com/api-platform/core/pull/1100. @dunglas it's your call but I agree with @teohhanhui on this. We can maintain our ~~own image~~ own docker configuration based on official images and if there's an issue with it we can fix it (instead of relying on a third-party docker image). . Bad choice of word from me, I meant maintaining our own docker configuration in this repository in enough.. I'm using yaml to declare routes:\n\nyaml\nproduct_stocks_item:\n    path: /api/products/stocks/{product}\n    defaults: { _controller: product_products.action.stocks }\nController service:\nyaml\n    product_products.action.stocks:\n        class: Product\\ProductBundle\\Action\\StocksAction\n        autowire: true\nMaybe you need to declare the Action as a service to specify the autowire configuration?. SWServices:\n    class: AppBundle\\Services\\SWServices\n    arguments: [ \"@doctrine.orm.entity_manager\" , \"@service_container\" ]\nMailSpecial:\n    class: AppBundle\\Action\\MailSpecial\n    autowire: true\nOr \nSWServices:\n    class: AppBundle\\Services\\SWServices\n    autowire: true\nMailSpecial:\n    class: AppBundle\\Action\\MailSpecial\n    autowire: true\nShould work, it does to me at least :|.. Hi!\nYou need to use a dynamic serialization context. I think that @bwegrzyn is doing just what you're looking for see here.. Hi, https://github.com/api-platform/core/issues/972\nCheers.. Hmm, why are you not using a Doctrine subscriber for this? It looks like you need something like the SoftDeletable extension. . @toulemol Not really because on the API side you want to DELETE. The thing is that sometimes DELETE on the API doesn't mean DELETE data but instead \"flag this data as deleted\", especially if you need to keep relations.\nClosing as old, feel free to open a new one.. I think you should use filters instead of an extension.\nAnyway, there are two kinds of extensions:\n\nExtension, returns a QueryBuilder see QueryItemExtensionInterface and QueryCollectionExtensionInterface\nResultExtension, returns data (useful for pagination for example, or when you need to use getQuery, for QueryHints for example) see QueryCollectionExtensionInterface and QueryResultItemExtensionInterface. What do you mean by keep handing on differents methods. I think that there is a better way of doing what you want but I need more informations. . Just implement a DataProvider if you want to do custom queries. There are really a few use cases where a Controller is valid with ApiPlatform. Most of the use cases can be dealt with by implementing one of those:\nFilter (soon will also be possible without doctrine)\nDataProvider (don't need to be doctrine specific)\nQueryExtension. @insekticid we need https://github.com/api-platform/core/pull/1099 for filters to be able to work without doctrine. Then, you can check https://github.com/api-platform/core/pull/1111 which works as a filter. We'll then also work on https://github.com/api-platform/core/issues/1083 for example.. Do the filters show up in the hydra metadata? We've a test on this and AFAIR it's working to me.. @Simperfit should work with as many levels as we need:\n\n\nExtract of filters services:\n```yaml\n    product_referencing.filter.date:\n        parent: 'api_platform.doctrine.orm.date_filter'\n        arguments: [ { 'fromDate': 'include_null_after', 'thruDate': 'include_null_after' } ]\n        tags: [ {name: 'api_platform.filter', id: 'product_referencing.filter.date' }]\nproduct_referencing.filter.enabled:\n    parent: 'api_platform.doctrine.orm.boolean_filter'\n    arguments: [ { 'enabled': ~, 'product.productToPackaging.isDefault': ~, 'product.productInternalOrganization.referencingStatus.isBlocking': ~} ]\n    tags: [ {name: 'api_platform.filter', id: 'product_referencing.filter.enabled' }]\n\nproduct_referencing.filter.product:\n    parent: 'api_platform.doctrine.orm.search_filter'\n    arguments: [ { 'product': 'exact', 'product.category.id': 'exact', 'product.priceDefinitionFamily.id': 'exact', 'product.code': 'exact', 'product.productInternalOrganization.internalOrganization': 'exact' } ]\n    tags: [ {name: 'api_platform.filter', id: 'product_referencing.filter.product' }]\n\n```\n. Note that I'm on master, helps me testing new features :p.\nFor debugging:\n\nbin/console debug:container - check that your filters are okay there\nYou can check here if anything looks suspicious / confirm that filters are being used\nCheck here if some condition is the trouble you may find a direct answer. @blaues0cke could you give me your resource declaration?\n\nFilters declared on collection operations will take precedence over global resource attributes filters declarations. Both values are not merged, could be your issue.\nAlso, make sure that you have no cache or that you clear it.. I mean the resource declaration, not the filter service declaration.. Entities can't have custom constructor arguments AFAIR. Still, you should be able to use listeners/subscribers to add whatever you need to your entity.. I think that this isn't fixable as is. Still, you can do your own controller/event listener to enable such behavior (ie instantiate a new ResourceClass with your own agruments). . Sure I'll try something asap.. You should be able to use symfony validation for this. See UniqueEntity for example.. Check how things are configured here (api-platform/api-platform). Your configuration (composer.json and config) should be close to the one here to make things work by using only api-platform/core. Especially the assets part to link Swagger (should be enable if the base was the symfony package).\nRemoving the cache may also help. . Format is part of the config right?\nMy configuration:\n```\napi_platform:\n    title:                             'My api'\n    description:                       'blabla'\n    formats:\n        jsonld:                        ['application/ld+json']\n        json:                          ['application/json']\n        xml:                           ['application/xml', 'text/xml']\n        csv:                           ['text/csv']\n        html:                          ['text/html']\neager_loading:\n    fetch_partial: true\ncollection:\n    order_parameter_name:          'order'\n    order:                         'ASC'\n    pagination:\n        client_enabled:            true\n        client_items_per_page:     true\n        items_per_page:            10\nenable_swagger: true\nenable_swagger_ui: true\n\n``. IMO it's a good separation of concern. Those normalizers are handling completely different formats. I agree about the verbose argument, though keeping those separated is still better in terms of maintainability and composition. . Work in progress or working progress? :laughing: . Did you removed allmdfiles on purpose? LICENCE has been deleted too. .composer req api` would use which repository? \nOkay, I get the skeleton part now and I think it's a good idea for advanced users that want to set up an api in no time! Though, for newbies, having a repository to clone and then to issue docker-compose up would probably be ~easier~ less scarier. . may be related to https://github.com/api-platform/core/issues/1185\n\nBut If will remove filtering, pages will have different response\n\nthis would unconfirm https://github.com/api-platform/core/issues/1185 ? We may need more data, the best would be a case reproduction in a behat test on the api-platform/core repository.. Does the special route show up in ./bin/console debug:router?. Meaning? \nYou may want to use another format then jsonld, try json for example. See here for more informations on formats.. Maybe what you want is the JSON API spec, we're currently implementing this https://github.com/api-platform/core/pull/1175. You could give it a try by forking @meyerbaptiste branch :).. See reasoning in https://github.com/api-platform/core/pull/2022#issuecomment-399402142. You can always decorate the ItemNormalizer to implement your own logic.. We implemented subresources to help with this if you want to set up routes on your relations. \nIf not, you should be able to achieve this with an action or an event subscriber.\n\nSubresources are not released yet, you can try them by using api-platform/core#master. Example here.. I'd suggest to take a look at the data customization of the jwt docs to do so.. Something like foo.bar. Would it be possible to have the DQL responsible for the failure? . They're not compatible AFAIR. Are you sure that you really need FOSUserBundle?. IIRC it's not supposed to show up in swagger. We have however an OAUTH implementation in swagger.. Currently a work in progress: https://github.com/api-platform/docs/pull/182 . Hi,\nBecause you want to identify an \"Entity\" by something else then it's real database identifier, you need to build a custom data provider. . And you may need cascade: persist on the relation :).. One thing that is not supported here is to use the Class representing Doctrine inheritance. There are some issues on the subject here and we still don't want to support it because it's kinda bad practice.\nOpen issues about doctrine inheritance:\nhttps://github.com/api-platform/core/issues/1243\nhttps://github.com/api-platform/api-platform/issues/277\nhttps://github.com/api-platform/api-platform/issues/266\nThose issues are complains about the fact that calling subpick_types (which should contain Free and Event in your case) will NOT give you all the fields. Indeed, Api Platform is only aware of the AbstractClass columns in this route (not taking sub classes into consideration).\nTo make this work you'll have to do it in 2 steps:\n\nFirst create the SubpickType you want\nSave the reference in picks with the IRI from 1. (for example '/subpick_type_free/1`)\n\n\nI think you can avoid the Inheritance here and use your discriminator map in a subpickType column that will help you difference them. This way, you'd be able to do the above by specifying your subpickType column. It's not perfect because both end up in the same table, but when it comes to those kind of data representation no solution is perfect.. Whew, this will be hard to manage afterwards (the two OneToOne relations), though it's a solution like another.\nI'd not advise to use this solution it feels weird (two entities of the same \"type\" not having the same data). Also you will get dataEvent: null, dataFree: {}.\n\nIs there a way to override denormalizer and replace resource class when it's AppBundle\\Entity\\Subpick by AppBundle\\Entity\\SubpickTypeFree (and by checking the parameter \"@type\") ?\n\nThis is definitely feasible and would be a working solution to keep inheritance and allow to post relations on the subpick route.\nNote that I'm using inheritance too but I always first create the relation element alone (on it's own route). Then I POST on the abstract resource to save the relation.. > Symfony 2.7.30, 2.7.31, 2.8.23, 2.8.24, 3.2.10, 3.2.11, 3.3.3, and 3.3.4 versions of the Symfony Security component are affected by this security issue.\nDo we need to patch this in 2.0 too? . If it's not nullable how is it that you accept requests with null values? IMO it's working fine.. In your case:\n{ bar: null }\nIf username can not be nullable I don't get what response you expect when you send {username: null}, it's invalid. I'd expect 400 status code.\nThe DoctrineOrmPropertyMetadataFactory is only used to identify identifiers if I'm not mistaken. Could we have a full stack trace?. Angular version? \n\nwrote this but probably out of scope\nI need to check but I think that (with angular) you'd have something like this:\n```\ninterface User {\n    username: string\n    password: string\n}\n@Component({\n  template: <input type=\"username\" ([ngModel])=\"user.username\">\n    <input type=\"password\" ([ngModel])=\"user.password\">\n})\nclass LoginComponent {\n  user: User = {username, password}\n}\n```\nI don't see how you'd get null in the first place. undefined could be a value but I usually remove those before issuing a request. There should be an example with Restangular on the docs. I'm using rxrest handlers to transform data prior-request.\nAlso, if username should be present, don't you do client-side validation?\n\n. > Another solution is to initialize your model with an empty string in the front.\nAnother big :+1:. As I wanted to show in my above angular example, I don't get how you can send null, especially if you're working with Typescript, it should enforce you to use either an empty string or undefined (undefined will not show up in a JSON string sent to the server):\n```\n\nJSON.stringify({foo: undefined, bar: ''})\n'{\"bar\":\"\"}'\n``. Yes null is stringifyable. But if you've null it's that you really want to send null IMO ^^.. If changing decoration priority fixes your issue then :+1:. . I think this is not related to api platform https://github.com/symfony/symfony/issues/16639 . Not supported I think but could be added easily.. So whenever someone has the time to contribute :).._api_resource_class: should be set toToyon your custom operation for this to work.. This is a collection no? Therefore,$subject` will be an array no?  If it's null there is probably nothing to return. Check the query and see if you get results manually.. \ud83d\udc4d IMO the latest sentence is true, because react is licensed as BSD + patents we should follow the same rules. However, we could replace react with preact and keep everything MIT (it's plug&play).. Interesting! Anyway it seems like prop-types should be disabled in production, and therefore not included in the code according to the README? \n\nAlso https://github.com/developit/preact-compat/issues/285 . Looks like react-addons-test-utils and react-addons-perf should be dev dependencies. react-addons-shallow-compare seems to be a simple non-recursive check and there is a preact alternative here.. @mickaelandrieu I think that the MIT licence applies to the current licensed project, not it's dependencies. Indeed, you don't have restrictions with the software, you can edit and redistribute. Usually when you do so, you don't do it on the dependencies, or you'd take a look at this dependency as a new project, and therefore read the dependency license. . > I\u2019m going to lock this issue because bumping it is not very productive. We\u2019ve made our position clear many times, and if you don\u2019t plan to sue Facebook over patents, you have nothing to worry about. If you plan to engage in patent litigation then FB withdraws additional protections given by the grant (which you don\u2019t even have in the first place with open source libraries like MIT). Yes, the grant conditions are broader than Apache, but so far it works well for many companies that choose not to sue each other over software patents. This is why we don\u2019t intend to change the strategy in the near future.\nhttps://github.com/facebook/react/issues/7293 \nClosing this as resolved.\n. @mickaelandrieu hmm, we may but only on packages directly depending on react. For example, in the core we only use react because of swagger, therefore I'm not sure it's worth mentioning... Just disable swagger and there isn't any react anymore no?. Can you share the code of your custom action? I think that you need to enable our extensions by yourself (see the DataProvider).. If you want you can use our Pagination Extension on your query builder (inject + call applyToCollection and getResult). Or, you can return a doctrine Paginator and Api Platform should take up from there.. https://github.com/api-platform/docs/pull/256 could maybe help you?. You have to thanks @piotaixr :).   . Beg your pardon? Can you be bit more precise?. It does work with annotations.. Question, why do we need a container and an http server for client-generator?. @DariuszLuber yes\n@julienpillias you don't need any @ApiSubresource here, just set your groups on the itemOperation get.. Not sure I get your issue, to me you don't need any Subresource in your case.. > I don't know if it's possible without using groups on House. My hope was to have all House(s) informations(without using groups), and having department informations in the same response. Possible ?\nI don't think you can get the relations without using groups. What's bothering you by using a group on House?. Use yaml or xml to manage your groups instead of @Groups it gets easier ;). . Indeed, we did not implement the behavior you request here. You'll have to do a custom filter to obtain the expected result. . Subresource filtering does only work on a subresource returning a collection (obviously), ie to-many relation.\nThen, all you have to to is to set up a filter on the end class and use it.\nFor example a Car has many colors, @ApiSubresource on Color relation will give:\n/cars/{id}/colors\nAssuming @ApiFilter(SearchFilter::class, strategy=\"exact\") on entity Color:\n/cars/{id}/colors?name=red\nThere is no point in the example haha but this should give you want you need :).. This is again not implemented as I said above you need to implement it yourself. Indeed you're filtering on Car (Cars which color name is blue). . Create a filter that alters the DQL! You can find some great examples in the core source code: \nhttps://github.com/api-platform/core/tree/master/src/Bridge/Doctrine/Orm/Filter \nThere must be something in the docs about how to create custom filters as well!. You need to create a custom operation on the Assortment resource. Then, in the custom data provider you can do your custom DQL. \nOn a personal note, it's often sufficient to add an event listener on kernel.view to add some data to the results. . This might help: https://github.com/api-platform/core/issues/1391. Everything should be in the docs regarding data providers: https://api-platform.com/docs/core/data-providers \nAbout subresources it depends on how you want to \"create\" them. . This is how I configured it:\nhttps://gist.github.com/soyuka/d8d08ca2121b24357de1fdf38b0a8af8\nEntity/User is implementing use Symfony\\Component\\Security\\Core\\User\\UserInterface. yes http POST http://localhost/login_check username=foo password=bar (I use json login instead of form). \nThe Event listener is there to add some data to the final object:\njson\n{\n  \"token\": \"...\",\n  \"data\": { \"username\": \"foo\", \"bar\": \"foobar\" }\n}\nSee here.\n. We will avoid duplicates :) \nissue: https://github.com/api-platform/core/issues/1371\nI answered there.. Could you give the data used to POST?. I don't really get from where it could come, as long as you have adders for collections and correct denormalization groups it should work. Looks like the case here (or maybe a bug related to IDENTITY strategy?). Can you also check the symfony profiler, you should see the denormalized entity there (Request section).. > I am querying the API from JS, maybe I can dump something here ?\nYou should have the profiler url in the Response headers. \nThough nesting should use the same code (in the normalizer). If the denormalized result looks good (ie the relation does show up in the profiler) it should save it correctly IMO. I sadly don't have the time to try and reproduce this for now :|.. _api_collection_operation_name should be _api_item_operation_name. https://github.com/api-platform/core/blob/671b4466a423e982e4f4c4aceed60eb81405f4b4/tests/Fixtures/FileConfigurations/resources.yml#L26 . Why don't you prefix everything from the firewall instead of rewriting the paths manually?\nBut yes, to change the groups you've to use the correct operation name given above:  api_logs_links_get_subresource.. > Is it possible to group resources in categories?\nNot sure but it'd be a great feature. Maybe by selecting only relevant configuration when declaring the api in routing.yml:\napi:\n    resource: 'Specify a routing.yml configuration here'\n    type: 'api_platform'\n    prefix: /application\n\nYes, that's what i did, right? But it does not edit the settings of the subresource operation but creates a new collection operation instead.\n\nLooks like you declared: api_logs_links_get_subresource which resulted in api_logs_api_logs_links_get_subresource_collection maybe just use links_get_subresource? \n. https://github.com/api-platform/core/pull/1483 related ?. We implemented subresourceOperations, should cover the use case. Will be fixed in the next patch release!. Example (with yaml it's clearer):\n```yaml\nresources.yml\nAppBundle\\Entity\\Foo:\n    attributes:\n        color:\n            groups: [foo.item, foobar.item]\n        contrast:\n            groups: [foo.item]\n        bar:\n            groups: [foobar.item]\nAppBundle\\Entity\\Bar:\n    attributes:\n        color:\n            groups: [foobar.item, bar.item]\n        contrast:\n            groups: [bar.item]\n```\n```yaml\napi_resources.yml\nresources:\n    AppBundle\\Entity\\Foo:\n       collectionOperations:\n            get:\n               method: 'GET'\n               # will not serialize bar relation\n               normalization_context: {'groups': [foo.item]} \n       itemOperations:\n          get:\n               method: 'GET'\n               # will serialize bar relation only with color attribute\n               normalization_context: {'groups': [foobar.item]}\n``. This is weird I thing the last result should be the expected one with correct groups. What's the type of the relation ondrugsUnitifed?. So Doctrine to get this data has to do another query (or aJOIN`). Therefore it'll have every results available no matter what. Though, with correct groups you should be able to get the wanted result. In our test for example: https://github.com/api-platform/core/blob/6a80fb0ed71d14813a583f8324d637ab1b1aa3ee/features/main/relation.feature#L128.. What kind of inheritance is that ? Inheritance is usually a bad idea by the way and yes we have some issues with doctrine inheritance but they mostly end up in \"wontfix\".\nBtw your first message is totally unreadable to me :laughing: From what I understood then, you should use a type column instead of using inheritance, there's no point here.. Should the so called user be authenticated when issuing write requests?\nWrite support is not available yet with subresources. . Then I'd use the token or the session to do the link instead of using a simple ID with no authentication check (which could be dangerous). I mean that if you have the user (TokenStorage for example) you don't really need it in the url no?. properties[adresses][]=address. just add a getter/public property in the entity and serialize it with groups. . >     \"hydra:totalItems\": 0\nLooks like there are no items in your collection therefore nothing gets normalized.. Must be a json-ld identifier (ie: '/api/accounts/1') or an account object (check also how serialization groups work).. What do you mean by \"expose\"? Just use serialization groups to hide in in normalization but keep it indenormalization.. https://github.com/api-platform/core/pull/1478 will definitely make things easier. You'd only have to use an IdentifierNormalizer (a service tagged api_platform.identifier_normalizer).\nhttps://github.com/soyuka/core/blob/a090ddb7745027a33760f7037670a3b59aff2c57/src/Bridge/Symfony/Bundle/Resources/config/api.xml#L236-L238\nid and @id are basically the same.. Let us know if you have issues implementing this. I added a documentation https://github.com/api-platform/docs/blob/master/core/identifiers.md. May you add the full SQL available in the profiler?. It's exactly how described in the symfony documentation.. Mhh this is linked to how the mutator method is spelled as well (ie a property private dateCreated is writable when setDateCreated exists). I think that if both properties are public they will both be writable. \nI'm not sure how snake_cased mutators are spellend :p. . AFAIK there is no per-resource configuration on http_cache. . It's more complicated then this but yes the cache gets invalidated when issuing a \"WRITE\" request. . This is correct see https://github.com/api-platform/core/issues/856.. If want you want is \"Document belonging to Relation X\" you can use @ApiSubresource on the relation X inside the Document entity.\nThere's also an ability to filter on relations (or even nested properties) with most of our embed filters see here. Hi! I had the exact same issue see https://github.com/api-platform/core/pull/1534.\nTLDR: \npublic function getChildren()\n    {\n        return $this->children->getValues();\n    }. maxDepth on subresources has been added recently as a new feature but hasn't landed in the release yet.  . Yes our mistake I'm not sure how it landed in the documentation, sorry about that.. Just return the array it should work. \nWhen I have custom stuff like this, I usually end up creating a new class representing the custom dataset.\nFor example:\n/**\n * usually you would disable any operations here as well\n * @ApiResource()\n */\nclass CurrentUser {\n  /** User **/\n  public $user;\n  /** Formation **/\n  public $formations;\n}\nThen, set the route defaults to _api_resource_class: CurrentUser, _format: 'jsonld'. Your route can return a collection of this class. . If you return an instance of Response our SerializeListener will not use your data: \nhttps://github.com/api-platform/core/blob/master/src/EventListener/SerializeListener.php#L51. We have a test case with id on associations and it should work.. Check in the features, I'm also using this kind of entities myself a lot. . Can we get a bit more detailed stack trace on this error? Thanks!. It's really weird that Symfony\\Bridge\\Doctrine\\PropertyInfo\\DoctrineExtractor->getTypes('AppBundle\\\\Entity\\\\ExtraInfo', 'extraInfos', array()) doesn't find anything (then it calls new Type(null) which fails here). I'm not sure it has something to do with indexBy. Do you have getter / setter for this?. > The property is private and I have getter, getExtraInfos(), but I don't have setter. I have addExtraInfo(ExtraInfo $extraInfo) and removeExtraInfo(ExtraInfo $extraInfo) instead. Is it something to do with the setter?\nNope that's fine. ExtraInfo is also an entity?. Hi ! I got this bug recently but can't remember how I fixed it. \nCan you give me the first lines of the stacktrace (looking for api-platform/core)? It's obviously in the DateTimeNormalizer (maybe you can dump some values there). . Yes this is because by definition:\n\na collection returns an array (/offers)\nan item returns an object (/offers/1)\n\nIMHO, it's really not a good practice to return an object on a collection route and if you want an object you should use the item route. \nIf you want to do this you should create a custom action that returns your item (for example /offers/by-slug/test-article).. Inject requestStack and to $request->param->get('slug'). By default the ReadListener (the one responsible for calling the DataProvider uses $request->param->get('id').. On 2.1:\nphp\npublic function getItem(string $resourceClass, $id, string $operationName = null, array $context)\n{\n    if (Article::class !== $resourceClass) {\n        throw new ResourceClassNotSupportedException(\"$resourceClass not supported\");\n    }\n}\nOn master, implement RestrictedDataProviderInterface:\nphp\npublic function supports(string $resourceClass, string $operationName = null, array $context = []): bool\n{\n    return Article::class !== $resourceClass\n}\n  . yes but you can restrict by using the above. Just use a UserProvider https://symfony.com/doc/current/security/custom_provider.html \nI'm just using: \n- a UserRepository (extends EntityRepository, used by the default loader)\n- a JWTResponseListener\nHere's my security.yml:\n```yaml\nsecurity:\n    encoders:\n        Core\\UserBundle\\Entity\\User:\n            algorithm: bcrypt\n    providers:\n        entity_provider:\n            entity:\n                class: CoreUserBundle:User\n    firewalls:\n        main:\n            anonymous: ~\n            json_login:\n                check_path:               login_check\n                username_path: 'username'\n                password_path: 'password'\n                success_handler:          lexik_jwt_authentication.handler.authentication_success\n                failure_handler:          lexik_jwt_authentication.handler.authentication_failure\n        api:\n            pattern: ^/api\n            stateless: true\n            anonymous: true\n            provider: entity_provider\n            guard:\n                authenticators:\n                    - lexik_jwt_authentication.jwt_token_authenticator\n        default:\n            anonymous: ~\naccess_control:\n    - { path: ^/$, roles: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/login, roles: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/api,       roles: IS_AUTHENTICATED_ANONYMOUSLY }\n\n``\n. Sorry that I missed the json thingy! . Can we close this?. try:subresourceOperations={}`. > Api docs is not exhaustive about that\nYou're right! Please help us to improve it by contributing here. Thanks!. You need to set up serialization groups.\nFor example:\n```yaml\napi_resource.yaml\nresources:\n  - App\\Blog:\n    attributes:\n      denormalization_context: { groups: [blog, comment] }\n```\n```yaml\nserialization.yml\nApp\\Blog:\n  attributes:\n    title: \n      groups: [blog]\n    content: \n      groups: [blog]\n    comments: \n      groups: [blog]\nApp\\Comment:\n  attributes:\n    content: \n      groups: [comment]\n```\nRead more here. I think that what you did should work\nService declaration\n```yaml\nservices.yaml\nservices:\n    _defaults:\n        autoconfigure: true\n        autowire: true\n        public: false\nApp\\Controller\\:\n    resource: './src/App/Controller/*' # this path may be different obviously\n    tags: ['controller.service_arguments']\n\n``` \nMight need to be loaded in config/routes/annotations:\nyaml\nfoo:\n    resource: ../../src/App/Controller/\n    type: annotation\nController using the \"Action\" pattern\n```php\n<?php\ndeclare(strict_types=1);\nnamespace App\\Controller;\nuse App\\Entity\\Foo;\nuse Symfony\\Component\\HttpFoundation\\Request;\nuse Symfony\\Component\\HttpFoundation\\JsonResponse;\nuse Symfony\\Component\\Routing\\Annotation\\Route;\n/*\n * @Route(\"/api/foos/{param}\", defaults={\"_api_resource_class\"=Foo::class, \"_api_item_operation_name\"=\"foo_custom\"})\n /\nclass FooController\n{\n    public function __invoke($param, Request $request)\n    {\n        return new Foo();\n    }\n}\n```\nYes I declare my route on the class because the controller is handling only one route.\nLink to Api Platform\nIf you want the api platform listeners to handle the route:\nyaml\nresources:\n    App\\Product\\Entity\\Product:\n        itemOperations:\n            foo_custom:\n                route_name: 'app_foo__invoke' # or add name in the route annotation. FML I wrote a big answer to this yesterday... \nOh okay please don't post the same issue in two repositories...\nMy original answer:\nThe one you want :).\nIMO, standard version would be like:\nsrc/Kernel.php\nsrc/api_resources.yaml\nsrc/Entity/Product.php\nWith config/packages/api_platform.yaml:\nyaml\napi_platform:\n  mapping:\n    paths:\n      - '%kernel.project_dir%/src/api_resources.yaml'\n  resource_class_directories:\n    - '%kernel.project_dir%/src/Entity'\nI have the following:\nsrc/Kernel.php\nsrc/Product/api_resources.yaml\nsrc/Product/Entity/Product.php\nWith config/packages/api_platform.yaml:\nyaml\napi_platform:\n  mapping:\n    paths:\n      - '%kernel.project_dir%/src/Product/api_resources.yaml'\n  resource_class_directories:\n    - '%kernel.project_dir%/src/Product/Entity' annotations from those files\nhttps://github.com/api-platform/core/issues/1671#issuecomment-361908539 . Use a DateTimeNormalizer ?\nI had to because I use some custom classes for date indexes:\n```php\n<?php\ndeclare(strict_types=1);\nnamespace App\\Api\\Serializer\\Normalizer;\nuse App\\Types\\IdxDate;\nuse App\\Types\\IdxDateTime;\nuse Symfony\\Component\\Serializer\\Normalizer\\DateTimeNormalizer as DefaultDateTimeNormalizer;\nclass DateTimeNormalizer extends DefaultDateTimeNormalizer\n{\n    private static $supportedTypes = [\n        \\DateTimeInterface::class => true,\n        \\DateTimeImmutable::class => true,\n        \\DateTime::class => true,\n        IdxDateTime::class => true,\n        IdxDate::class => true,\n    ];\npublic function supportsDenormalization($data, $type, $format = null)\n{\n    return isset(self::$supportedTypes[$type]);\n}\n\n}\n``` \n```php\n<?php\ndeclare(strict_types=1);\nnamespace App\\Types;\nclass IdxDate extends \\DateTime\n{\n    const IDXDATE_FORMAT = 'd-m-Y';\n/**\n * toString.\n *\n * @return string\n */\npublic function __toString()\n{\n    return $this->format();\n}\n\npublic function format($format = 'd-m-Y')\n{\n    return parent::format(self::IDXDATE_FORMAT);\n}\n\npublic static function createFromFormat($format, $time, $object = null)\n{\n    $d = \\DateTime::createFromFormat($format, $time);\n\n    $t = new self();\n    $t->setTimestamp($d->getTimestamp());\n\n    return $t;\n}\n\n}\n```\nServices:\n```yaml\nservices.yaml\nservices:\n    App\\Api\\Serializer\\Normalizer\\DateTimeNormalizer:\n        tags: [ { name: 'serializer.normalizer'} ]\n```\nNote IIRC  __toString is used by the normalizer.. Exactly what you should do, the example given doesn't output any hours/minutes data only date, month, year. Closing but ping me if unsolved.. > @dunglas @theofidry @soyuka I need just to my understanding by yes or no.\nThanks...\nReading this post for the first time and this makes I don't really want to answer now... Just a reminder this is an open source project and everyone is there on his own free time.\n\nshould I have one and only one Collection Data Provider for each resource?\n\nYou don't have to but you can. Your implementation looks correct. If you want to use a by-slug operation on many resources you may just use the same data provider. I'd implement an interface (eg SluggedEntityInterface) and you could test is_subclass_of($request->attributes->get('_api_resource_class'), SluggedEntityInterface::class).. 1. Do you have access to the RestrictedDataProviderInterface? It's better to implement this if you can.\n2.\n\nIs it normal to get for just one API call two calls to the collection data provider? Is it a bug?\n\nIt is if the DataProvider gets called by our ReadListener and by your custom Action. \nYou can either:\n- avoid using an action\n- use receive = 0 in the resources attributes to pass this condition\n\nYou need to use the operationName as a condition for your data provider.\n. > This means, controllers have to be used. But, I will have to declare the routes of the custom operations in the same file of the routes for api_platform (which is not very clean way for declaring a big list of routes)\n\nOkay so just don't call the data provider there, take this one for example:\nhttps://github.com/api-platform/core/blob/master/src/Action/PlaceholderAction.php\nIt's the default action for every api platform route. You can check the request parameters in the data provider directly.\n\nAny example available or a link?\n\n* @Route(\"/api/user_users/{id}/reload\", defaults={\"_api_resource_class\"=User::class, \"_api_item_operation_name\"=\"reload\", \"_api_receive\"=false})\nIt's written somewhere in this part of the documentation. Hi! I think that this is the normal behavior because the ShortNameResourceMetadataFactory is only using the classname as basis: \nhttps://github.com/api-platform/core/blob/master/src/Metadata/Resource/Factory/ShortNameResourceMetadataFactory.php#L44\nMy advise is to replace the following class with your own ShortNameResourceMetadataFactory:\n```yaml\nservices:\n    _defaults:\n        autowire: true\n        public: false\nApi\\Metadata\\Resource\\Factory\\ShortNameResourceMetadataFactory:\n        decorates: 'api_platform.metadata.resource.metadata_factory'\n        arguments: \n            ['@Api\\Metadata\\Resource\\Factory\\ShortNameResourceMetadataFactory.inner']\n```\n```php\n<?php\ndeclare(strict_types=1);\nnamespace Api\\Metadata\\Resource\\Factory;\nuse ApiPlatform\\Core\\Metadata\\Resource\\Factory\\ResourceMetadataFactoryInterface;\nuse ApiPlatform\\Core\\Metadata\\Resource\\ResourceMetadata;\n/\n * Guesses the short name from the class name if not already set.\n \n * @author K\u00e9vin Dunglas dunglas@gmail.com\n/\nfinal class ShortNameResourceMetadataFactory implements ResourceMetadataFactoryInterface\n{\n    private $decorated;\npublic function __construct(ResourceMetadataFactoryInterface $decorated)\n{\n    $this->decorated = $decorated;\n}\n\n/**\n * {@inheritdoc}\n */\npublic function create(string $resourceClass): ResourceMetadata\n{\n    $resourceMetadata = $this->decorated->create($resourceClass);\n\n    $parts = explode('\\\\', $resourceClass);\n\n    if (null !== $resourceMetadata->getShortName()) {\n        return $resourceMetadata;\n    }\n\n    return $resourceMetadata->withShortName(substr($resourceClass, strrpos($resourceClass, '\\\\') + 1));\n}\n\n}\n``\n. Hi! We're always callinggetManagerForClass`, therefore if your doctrine configuration is correct it should work seamlessly! \nThe getManagerForClass tells doctrine to use the EntityManager you mapped the class to, so it's exactly what you need. I think that there's an issue in your mappings because it should already work.\nThis is what I put under mappings:\nmappings:\n                App\\Press:\n                    is_bundle: false\n                    type: annotation\n                    dir: '%kernel.project_dir%/src/Press/Entity'\n                    prefix: 'App\\Press\\Entity'\n                    alias: App\\Press\nYou can find more information on the symfony documetnation: https://symfony.com/doc/current/reference/configuration/doctrine.html#mapping-configuration. >  the same entity can be managed by multiple EntityManagers\nOkay but this looks wrong, a given entity should be mapped by one and only one entity manager or I don't see the point. Indeed, a Foo class present on 2 DBMS is weird.\nWhat you want (it seems) is to use one or another Connection according to given parameters. \nIf you want this you'd have to implement your own DataProvider and use $registry->getConnection('my_connection_name').. > Why having multiple databases with same schema is weird?\nApart from the different envirnoments (in which case I'd just configure the connection part) I don't see the use case but I'd be very interested in one! Or maybe you have different entity repositories per DBMS?. Could you try to explain your use case? \nThe core repository (here) is tested against multiple DMBS (postgres, sqlite, mariadb) and we're using only 1 entity manager. It's configuration may be a good start point. \n. related https://github.com/api-platform/api-platform/issues/512 \nNumerous issues on the subject btw!. Did you set up the JWT_PASSPHRASE correctly and regenerate certificates as explained on JWT home page?\nLooking at your authentication attempt it looks like admin / [redacted] user isn't correct.. yes I was speaking about https://github.com/lexik/LexikJWTAuthenticationBundle . I'm sorry but I don't get what's wrong. What are you trying to achieve?. Maybe with correct serialization groups, you'll get an array of every identifiers\nOr: implement your own data provider that gets a paginated relation\nThere is no available solution at the moment if you want to retrieve a portion of a relation. It's not that easy to do in a generic manner. \nWe may think about a way to configure that though, I'm going to keep track of that in https://github.com/api-platform/core/issues/1686. . Custom normalizer yes.. I just use classes with public properties you don't need getter and setters if you don't want them.\njust expose a class with properties as a ApiResource and you're done.. You're nuts :smile: (not criticizing!).\nAbout \"metadata\" (ie: what properties are available, readable, writable) ApiPlatform uses Metadata factories. I think that you should implement your own to make that magic happend without having to write all this boilerplate code.\nFactories are working with a decorator pattern, you should've no issue in adding your own! Take a look at:\n- Resource metadata: https://github.com/api-platform/core/tree/master/src/Metadata/Resource\n- Property metadata: https://github.com/api-platform/core/tree/master/src/Metadata/Property\nDon't forget to make the properties readable/writable with the PropertyMetadata class!\nThe magic get/set methods should work, and ApiPlaform internals are using the Symfony Serializer to write/read the data in the classes:\n- normalize => reads (eg: transforms the class to an array)\n- denormalize => writes (eg: transforms an array to an object that can be persisted)\nIt uses mainly the PropertyAccessor component. You may need to do something there to allow the transformations (ie override the PropertyAccessor component to use the magic methods). . Decorator is only a pattern:\n- symfony docs\n- service declaration in api-platform/core for example\nRead more about the serializer here. \nAbout the Property accessor component:\n- docs\n- I prefer the code\n-  and how it's used in api-platform/core (search for PropertyAccessor)\nGood luck with that, I learned symfony pretty fast by just reading the code.. https://api-platform.com/docs/core/serialization#the-serialization-context-groups-and-relations \nit should be removed from menu?. thanks for the report, following this in the correct repository.. use the doctrine paginator we support it. Oh if you want to use our request parameters you need to use the PaginationExtension in your data provider.\nNote that this is implementing a QueryResultCollectionExtensionInterface and you need to call getResult on it. See for example:\nhttps://github.com/api-platform/core/blob/1bd1751b9bdadc79f7873f846347277cf77a98d0/src/Bridge/Doctrine/Orm/CollectionDataProvider.php#L70\nI'm not sure that you can do this from a repository though and you'll need to set up a DataProvider.. you can't for now subresources are not writable atm :).\nAll you can do is to add a custom route like the above. Too enable it it swagger try to link the ApiResource with your custom route!. btw another example on how to add swagger parameters and declare such a resource etc: \nhttps://github.com/gries/api-platform/pull/1/files . Careful when using this (inheritance), requesting the ParentOne is not really supported/fully working. Requesting children will work perfectly fine though. . @Chrysweel see https://symfony.com/doc/current/doctrine.html#configuring-the-database. I think that you need cascade persist from first sight (also adders/removers). This error occurs when you gave an object ({\"foo\": \"bar\"}) instead of an IRI (/technologies/1).\nIf you want to give a full object, you need to setup serialization groups on the denormalization context (check the docs on the subject ;)). I think most of the team is in favor of keeping react. Anyway I'm +1 on using default provided tools like npm.. Use a collection/item operation instead. Just give it a custom path and the correct root resource.. So? Does it return an object? Then it's a custom itemOperation on user. It has nothing to do with a subresource.. > Based on the subresource documentation I'd have to add a property reset-password to the User Entity in order to mark it as a sub-resource.\nYou could try to do this after a second look. You'll probably have to add a DataProvider or something to build the DTO.\n\nIs it possible to define a subresource without having to create an actuall property on the parent object?\n\nNot really, eventhough the property doesn't need to be linked to a data source. If you want that I'd suggest a custom operation with it's own controller (and maybe validation, not sure why you couldn' re-use part of the api-platform core code).. It should work like other filters. What did you try?. > Should we add the filters property under the subresource operation too?\nYes, or just use the ApiFilter annotation is should work seemlessly.. Yes, there is an example for this:\nhttps://api-platform.com/docs/core/filters#basic-knowledge\nAlso, the filter annotation only declares the service for you, it's therefore not related to doctrine :). You got that right and yes you'd have to declare one service per filter (which is what the anootation does). Custom filters it is :) We already reasoned to this in another issue IIRC.. Really? Typo in the title, no description? No attempt at trying something? \nA quick research: https://github.com/api-platform/core/issues/1242\nGood luck.. Did you try the @ApiSubresource annotation on the property people? \nAs long as the type is correctly guessed by the PropertyInfo component it should work :)\n(they're not tied to doctrine at all).\nhttps://github.com/api-platform/core/blob/a5dc79534f19db6359d6fa9b14c1e9d07434392c/src/Metadata/Property/Factory/AnnotationSubresourceMetadataFactory.php . GET /person_lists/:personId/people/:peopleId\nshould've been generated.\nYes you are not able to do that yet but I think that it could be added easily to the core.. would you be able to push this to a repository of some kind to save me the reproduction time? Thanks! Btw feel free to ping on symfony-devs.slack.com. Oh no I'm not dockering stuff :P (I use bin/console server:run). thanks will get back to you!. Okay, so indeed subresource operations only give you the /person_lists/{id}/people.{_format} route. Indeed, your client should then be able to use items from that list to do write/read operations on unique elements. \nI'm really not sure that there is a use case that would justify adding /person_lists/{id}/people/{peopleId}.{_format} to the subresource.\n. GET /people/aaa-bbb-ccc-fff\njson\n{\"name\": \"alice\", \"id\": \"aaa-bbb-ccc-fff\", \"list\": \"aaa-bbb-ccc-ddd\"}\nShould be available no? Or maybe your relation does only work in one way? \nAnyway how would /person_lists/{id}/people/{personId} help with that issue? \nI'll add an example to make the above example work on your repository!. I think that my PR needs an entry in the docs:\nhttps://github.com/gries/api-platform/pull/1/files \nThis is the perfect way of handling your issue with swagger support and custom parameters identifiers. I mean what I did in the PR should be documented because it's working well and really easy to pull up. I just know the stuff and it may not be that easy for a newcomer xD.. I have a few solutions in mind.\nEasiest is to decorate the IRIConverter. . I'm working on this /person_lists/{id}/people/{personId} thing. It should be available through subresources soon :). . > Replace a route with custom implementation, creating-custom-operations-and-controllers doesn't fulfill my need, for no request object passed to __invoke function, I may need to check such as whether a taxon is existed in database manually.\nYou can totally do this. indeed, in the mean time you can have a look at https://github.com/api-platform/core/blob/master/src/Bridge/Doctrine/Orm/ItemDataProvider.php#L95 . Use a queryResultExtension and use it to stop the loop with a high priority. Anyway why don't you use a DataProvider instead of an extension?. I see, try this: https://api-platform.com/docs/core/default-order/. Inject the Token in your data persister or in a pre-write listener to alter the data.. That's not supported. There are some discussion open on batch endpoint though: https://github.com/api-platform/core/pull/1645. > I think we should have confirmation from Mac OS and Windows users that the setfacl works as expected.\nI'm not using any of these anymore :|.. Thanks @teohhanhui !. https://github.com/api-platform/demo/. I've never seen a relation column that could have a json_array type, is this really a thing? . Yes because this is a relation column it should be left as-is (ie the column will have the id of the relation, type is already defined by the relation id). . I didn't got that. What are you trying to do?. A OneToMany relation doesn't have a Column annotation AFAIR... You should read doctrine docs: https://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/association-mapping.html#one-to-many-bidirectional. \nNullable can be set on the JoinColumn(nullable=true) annotation. . Can you give us a code extract? From first sight it looks like the property you put @ApiSubresource on has no type.. What is uischema? Just use a typedoc on it. . In the documentation example, $answer is a doctrine relation (OneToOne). This helps knowing what class the subresource is referring to.\nIn your case, there is no indication on what the class should be. Try this:\n/**\n * @var \\My\\Related\\Class\n * @ApiSubresource\n */\npublic $uischema;. Works as well yes :). . > Why are they under .github directory? Is there special handling of those files by GitHub? But anyway, I don't think that's a good idea.\nYes they're then linking these files when you open an issue for example. Anyway according to the docs, these files can also be at the root of the project. I'd be :+1: to leave them there (ie not in .github) for visibility.\n\nAdd the CODE_OF_CONDUCT.md file to the root, docs/, or .github/ folder.\n\nhttps://help.github.com/articles/adding-a-code-of-conduct-to-your-project/ . I guess that the ruter thinks that me is an id, I think that it should go through your route though. Could you check in the symfony profiler's Router section to find out what route matched?. Oh my bad indeed. Did the request hit the controller? (die inside it for example). Maybe a cache issue? If I get that correctly you don't have any issues ? :D. https://github.com/api-platform/api-platform/issues/748 looks relevant here. For the mean time I guess that you have to override the class in your stack! \nThanks for the report @BatsaxIV, closing this as fixed I guess :p. . I think that someone already worked on using Laravel with Api Platform and it is definitely in our scope to make it work with other frameworks!. Nothing has been made AFAIK. \nFirst step would be to implement the Laravel Dependency Injection system for our classes (provider?). Then register the routes, just like we're doing with Symfony in the Bridge/Symfony/Routing namespace. \nThen the event listeners system. \nThat's a lot of work though but it's definitely feasible in a few weeks! I'd really love to do this but I've nor the time nor the money to :crying_cat_face:. \nEloquent may come later (also https://github.com/theofidry/EloquentSerializer).. Mhh my guess is that because it's the same entity it has the same alias and the SELECT clause isn't building in the subquery :|.\nThis isn't supported right now but we would likely merge a patch to get this to work!. Should be possible, we may accept a patch to the core (there is a branch for mongodb support for example).. Just tell me if I understood correctly:\n\nGET /foo/{hash_id}\ndo something with {hash_id} so that it becomes an integer\nfind the correct data in the database\nreturn the resource but replace the id with the {hash_id}\n\nIf that's the case you need two things:\n\nan IdentifierDenormalizer that transforms the {hash_id} in an integer\na custom normalizer for properties marked as identifiers (use PropertyMetadata->isIdentifier()) and do the reverse transformation (id => {hash_id}) to keep the response identifiers as hashs instead of integers.. I'm using angular, it's not much different from react. To facilitate queries I'm using rxrest but the default http service from angular will work just fine.\n\nWhat are your issues/questions regarding the use of angular with Api Platform?. 2018-07-03T11:19:44+00:00 [error] Uncaught PHP Exception Symfony\\Component\\HttpKernel\\Exception\\NotFoundHttpException: \"Not Found\" at /Users/simonackermann/Sites/courses/symfony/champeryNb/vendor/api-platform/core/src/EventListener/ReadListener.php line 103\nIt should not go through the ReadListener if you have your own controller... Either you have the metadata cache on and forgot to clear it or there's something else. May you check symfony's profiler also?\nOh, on a second though maybe that you just need the _api_receive flag to false see https://api-platform.com/docs/core/operations/#recommended-method . Not possible, ongoing discussion https://github.com/api-platform/core/pull/1645 . > The default behaviour is \"create if no id is present and update if id is present\". And changing it to \"always update the current one\" would completely solve my problem.\nCustom data persister?\nThe access_control annotation above looks legit though.. > @soyuka is this by design?\nYes but we have an ongoing discussion somewhere to change this. We def should do an RFC on the subresources.. App\\Entity\\Plan:\n    attributes:\n        normalization_context: { groups: ['plan_read']}\n        denormalization_context: { groups: ['plan_write']}\nThis works here:\nApi\\Entity\\BlogPost:\n        attributes:\n            normalization_context: {'groups': ['packaging.item', 'product.item']}\n            denormalization_context: {'groups': ['packaging.save']}. Doctrine should handle the parameter type if it is represented by a correct class (eg instance of UuidBinaryOrderedTimeType) and that the same class is registered as a doctrine Type.\nIs it possible that you need a custom identifier normalizer (the $value is not an instance of UuidBinaryOrderedTimeType? See https://github.com/api-platform/docs/blob/master/core/identifiers.md#custom-identifier-normalizer.. May you give a shot at my patch? . Will be available in the next release, thanks for the detailed bug report. . easiest solution would be to rename dictionaryId to id. You should also be able to decorate the IriConverter.. Keep us up to date please, this is a popular demand imo.. Could you try this?\nyaml\n    App\\Entity\\Book:\n        collectionOperations:\n            get:\n                method: 'GET'\n                access_control: 'is_granted(\"ROLE_ADMIN\")'\n        attributes:\n            access_control: 'is_granted(\"ROLE_USER\")'. If you don't have any otem operation it can't find the IRI for your route. \nA workaround is to decorate the IriConverter, for example: https://gist.github.com/soyuka/a7a58732792872f000a09f79741042a4 . This should do it: https://api-platform.com/docs/core/serialization/#changing-the-serialization-context-dynamically\nTLDR: use dynamic groups with a context based on access control to restrict properties. Use the partial pagination it won't do any distinct anymore :).. I must say that the serialization docs (also about yaml) can be found on symfony's docs https://symfony.com/doc/current/components/serializer.html#attributes-groups. I didn't say the opposite :) just that those are part of the symfony framework!. todo before closing: Add a behat test in api-platform/core for this particular behavior. solution is to simply disable the eager loading feature or build your own query. I'm really not sure how we could fix this otherwise...\nFor the api-platform/api-platform#799 example: \nphp\n/**\n * @ApiResource(\n *     attributes={\"normalization_context\"={\"groups\"={\"order_read\", \"customer_read\", \"address_read\"}}, \"force_eager\"=false}\n * )\n * @ORM\\Entity\n * @ORM\\Table(name=\"`order`\")\n */\nclass Order\n{\n}. Everything will work, this just skips the magic in building queries based on what you want to retrieve. Basically EagerLoading in api platform builds the sql query with JOINs where it can. By disabling it you'll keep the default doctrine behavior which, in this case, is more appropriate (lazy loading). . You can also disable it per-operation or per-resource wise see https://api-platform.com/docs/core/performance/#force-eager. Use serialization groups.. Looks correct, maybe a cache issue? Serialization groups are definitely the way to go here.. Is eager loading off for some reason?  . Hi! \nPolicy about joins in filters should be as follow IIRC:\n- association nullable\n  - LEFT\n- association not nullable\n  - if no previous joins INNER\n  - else LEFT\nIf this isn't the case it's a bug, please give me a way to reproduce with some entities in a gist :). \nPlease note that there was a recent fix on the OrderFilter that wasn't joining properly and created such bugs (see https://github.com/api-platform/core/issues/2109): https://github.com/api-platform/core/commit/34bb2ff3aea4ecc3a002f9849e8530889f6b91ee (has landed in 2.3.1).. Yes it's commented because we need to avoid BC breaks, it's value is read here.\nAbout the filter, I think that if you specify the filter, the behavior is to do an INNER JOIN because we don't want results when there is no match (eg: 'null'). Does this make sense? \nIf you want your results to include null values I think that you have to do your own filter.. Nope but I've a workaround for this which is to decorate the IriConverter: https://gist.github.com/soyuka/a7a58732792872f000a09f79741042a4. Or maybe even better in your case, decorate the ItemNormalizer. . Hi,\nI think that the easiest is to decorate the IriConverter. I made an example in this gist for one of my use cases. Obviously you'd need to change this guard and use whatever suits your needs.. Check out the following documentation:\n- https://api-platform.com/docs/core/operations#creating-custom-operations-and-controllers\n- https://api-platform.com/docs/core/data-providers/\nYou should add an operation, then add a data provider and you're done :).. Hi,\nI really don't have this issue, and my container is built only once. Because by default we use metadata_cache (https://github.com/api-platform/core/pull/1725) we only rebuild the cache manually when change resources. I'm also using experimental normalizer dumps (https://github.com/symfony/symfony/pull/22051) to improve the serialization speed but it doesn't look like it has something to do with the container...\nI'll check but I don't think that I need/use xdebug.. I think that this should be a class annotation, not a property annotation since you specified properties.\nAlso, make sure to clear your cache just in case.. Please take a look at the sql query in the profiler to make sure that the filter reaches that part. \n{{url}}/api/campaigns?product.approved=true\nDoes work here and brings back campaigns having the approved property of the product relation to true. I have a similar example in my codebase.\nYou can also check (if using Hydra) that the filters show up in the hydra:search => hydra:mapping json node.\nLast but not least your product relation should be readable (ie: have a getter) to pass this check. Nice, please close this issue when you've resolved your case. Lmk if I can be of some more assistance.. IMO you need a custom collection normalizer because DataTables doesn't seem to support hydra/jsonld.\nSee those examples:\n- hydra\n- hal\n. > We use Material Datatables with DataSources in Angular\nHi, and did you had to change something in the serialization? How did you do it?\nOn a second thought, maybe that it'd be easier to add Hydra support to the DataTables client code.. I see two solutions without using doctrine:\n\nImplement a DataPersister, trade-off is that there is one persister per entity and we can't chain them \nImplement a PRE_WRITE listener (see https://api-platform.com/docs/core/events/#the-event-system), you could use the same listener for every class implementing an interface (say BlameableInterface) :).\n\nGetting the user is as simple as injecting the Symfony\\Component\\Security\\Core\\Authentication\\Token\\Storage\\TokenStorageInterface:\n```\n    public function onKernelView(GetResponseForControllerResultEvent $event)\n    {\n        $controllerResult = $event->getControllerResult();\n    if (!($controllerResult instanceof BlameableInterface)) {\n        return;\n    }\n    $token = $this->tokenStorage->getToken();\n\n    if (!$token) {\n        throw new TokenNotFoundException();\n    }\n\n    $user = $token->getUser();\n\n    if (!($user instanceof User)) {\n        throw new AccessDeniedException();\n    }\n\n    $controllerResult->setUser($user);\n\n}\n``` \nYou're welcome to improve our docs with your solution! Thanks! . please see https://api-platform.com/docs/core/operations/#recommended-method . cool thanks @antograssiot . Hi,\ntry to use this:\n$attributes = ApiPlatform\\Core\\Util\\RequestAttributesExtractor::extractAttributes($event->getRequest());\ndump($attributes);\nYou'll see that you can use some of them to check if it's a collection, or a particular operation etc.. Does your route shows up in bin/console debug:router? It looks fine although api platform won't be able to retrieve the data automatically from this route, you need to handle this in your controller. . Can't it be a subresource actually? I think that you can deserialize the inverse of the relation and you would get what you need.. Closing this, hope that we were helpful. . I don't think we support more than 1 level indeed. Could you try tweaking the order filter to see if you can manage to hack it? . For the documentation, just add a DocumentationNormalizer on top of the normal one that disables this filter by your criterias. \nFor the \"allow this filter for admin only\", I'd do a ReadListener on the PRE_READ event. Do your checks are rewrite the query parameters inside the request should be feasible. . IMO we need this, feel free to patch and open a pull request in api-platform/core! Thanks!. Nice! We merged this as a new feature!. Yes, we don't merge contexts. The groups are taken from the operation level, then the resource level if it doesn't exists.. If it's a toOne relation it get's an item, if not it'll always be an array. There may be some other issues related to this subject on api-platform/core. I think that this isn't the first time someone asks for this feature. \nDon't hesitate to propose a patch although it may be a bit more difficult then it looks :p. . From what I see you're declaring 2 filters, can't you just use 1? Anyway, there may be some room for improvements on how filters are applied (first property level, then resource level) if it's not already the case.. IMO just set the default order on the resource, you don't need one on the property. We could add a fix in the orderfilter but merging configurations is always a new source of issues.. I definitely need to investigate, I'm sure there is an easy solution. I'll get back to you.. This error usually means that the data provider wasn't able to retrieve your output. Would you be able to give me a small reproduction case based on the api-platform/api-platform repo? Tyvm!. This is definitely a bug, we're in the process of fixing priority issues in https://github.com/api-platform/core/pull/2495 . Weird thing, are you updating the user somehow?. Usually I do one data provider where I join every sources and return my DTO. You can use composition in your data providers but I'm not sure that there is an interest.. > \"The first able to retrieve data for a given resource will be used\". No chain.\nIndeed, you'd have to do this by your own ( a data provider that chains yours). . Hi, can you give me a way to reproduce this? We have lots of functional tests that would have failed if the results were that different (I hope :p). I'm concerned by the collection here, the response matches an array of arrays?. Btw if you have a custom normalizer, please check priorities!. @JarJak the comment from @dunglas is something we need to implement so that you don't face the issue by upgrading. Sorry for the inconvenience. . Actually the issue is that now the ItemNormalizer might be called even though:\n  - it's not a resource class (accepts anything since beta-2)\n  - it's not one of the following formats: json-ld, json-api, hal\nBecause the AbstractItemNormalizer::supportsNormalization almost always return true and that ApiPlatform\\Core\\Serializer\\ItemNormalizer has no format check.. Should be moved to the api-platform/core repository. I think there is something with the github beta program, can't access it @dunglas mb you could move the issue?. We recently fixed that in https://github.com/api-platform/core/pull/1957. Can you check if the 2.4 branch works for you? (https://github.com/api-platform/core/blob/2.4/src/Serializer/AbstractItemNormalizer.php#L341). Set this in the composer file:\n\"api-platform/api-platform\": \"v2.4.0-beta.2\",. Code looks fine, I don't think you need a controller here, just use our default. \n. A Resource can't be a Response it looks wrong. \nWhat version of ApiPlatform are you using ? From where do you read the  counter data from? Is it from the collection itself (count($results)) or are you issuing a query?\nI'd declare the controller as:\n@ApiResource(\n  collectionOperations={\"get\", \"post\", \"counter\"={\"method\"=\"GET\", \"controller\"=Controller::class, \"path\"=\"/orders/counter\"}}\n)\n. Normalization is for when you return data, it looks legit.\nBy the way I invite you to check symfony's documentation about the serializer: https://symfony.com/doc/current/components/serializer.html . No problem, is your avatar the Rocket League champion rank logo?. Hi, don't declare an @ApiResource on the LanguageOutput it's wrong.\nI've reproduced your problem and am looking into it :). . I've patched this but won't be able to propose a proper patch before tomorrow, until then here's the diff https://github.com/api-platform/core/pull/2615/commits/b391c97f5f02d6e77e7e3b4e9dcf9c2642db2b38 . Sorry @phryneas I actually didn't changed the other normalizers, the patch has been updated and I added a test with your use case. Thanks for the report! . Hi,\nplease read:\nhttps://github.com/api-platform/core/issues/2521 \nAlthough we definitely do not recommend that see https://github.com/api-platform/core/pull/2022#issuecomment-398851861 . Can I ask why we don't just ADD . /app anymore?. database was fine no?. Is this necessary?. I assume this configuration was copy/pasted from somewhere? Mind mentioning from where?. I mentioned this in https://github.com/api-platform/api-platform/pull/218#issuecomment-275159435 IMO just having php-fpm run as www-data should be sufficient! This should be possible as php-fpm exposes 9000!\nThen nginx, that runs as root just forwards ports.. Can we enabled those in the production environment only? Can be tricky if you don't know that apcu cache is running and you're wondering why some things don't update.. oh... Then yes ofc.. We may, wasn't sure I'll change this.. Okay, should I remove it then?. docker-cmd it'll be called then... Yes I know the difference.. Why? Anyway I'm not for copying at all we should leave the volumes do their thing. This means that we don't composer install. Okay --no-autoloader --no-scripts was obviously missing from my attempt to run it without the sources. What about I don't copy anything but the composer.json and let the volumes add the sources?. I didn't knew about virtual packages and will add them. Thanks!. I don't know who made that rule and I surely don't understand it (except for the alphabetical part).. If this is the case, there's no need to install composer in the build phase no?. I disagree, why /srv? Also why do we need a sub path if all we need is /somedirectory?. @teohhanhui wdyt about only using the composer files instead of the whole library?. We have a .dockerignore for this.. Plain Old can be lowercase no?. Expose a hypermedia REST API in minutes. forgot to remove?. not needed anymore?. dead code?. ",
    "kmehmety": "+1\n. +1\n. ",
    "CristianSitov": "There's a missing </Directory> in the file now, which breaks Docker on start/build.\n. ",
    "samusenkoiv": "Yes, I would do it with json_array, but unfortunately I'm building API on top of existed database. \n. To be honest with you, I'm not sure how I can use groups for this purpose.\nAlso, I'm already using serialization groups, but I use them to alter the scope of available for read and write entity attributes. \n. yes you're right. Thank you !\n. ",
    "lekeutch": "Finally, for those who're interested in, I created an event listener on the event \"PRE_CREATE\" to put the necessary translations via StofDoctrineExtensionBundle. \n. Okay, but unfortunately I had to overload the ResourceController and create my own DataEvent recovering resource and a collection of any object.\n. For example: Let's assume an article  created in english :\njson data: {\n   \"title\": \"my article in english\",\n   \"description\": \"Description of my article.\"\n}\nendpoint: /en/articles/1\nI will want to translate it in French : PUT /fr/articles/1 => { \"title\": \"Mon article en fran\u00e7ais\", \"description\": \"Description de mon article\" }\nI used StofDoctrineExtensions for translation, I invite you to look at the documentation of the library DoctrineExtension\nTo do so,\n- I had to change in DataEvent to put any object\n  \n- i had to overload the controller of API Platform : ResourceController. I created a custom operation PUT in which I work with an object matching json data and the source object\n  \n- I had to create an event listener on Pre_Update. In this function, \n  \nAnd that's all. If someone finds a simpler way, I am ready to read\n. ",
    "bartlomiejmarszal": "Hi! I'm looking for example for using external resources in our api. Where can I find some hints about this problem?. ",
    "nietzscheson": "I consider that issue should to open newly. No has answered. \nI have the same problem. I do the same and give me: hydra:description: \"Unable to generate a URL for the named route \"\" as such route does not exist.\"\nWhat to do? How a route is set only?\n. ",
    "aledeg": "Thanks\n. I found out how to use the datetime normalizer:\nphp\n/**\n * @ApiResource(\n * attributes={\n *     \"normalization_context\"={\n *         \"groups\"={\"group1\"},\n *         \"datetime_format\" = \"Y-m-d\"\n *     }\n * }\n * )\n */\nclass MyEntity\n{\n...\n    /**\n     * @ORM\\Column(type=\"date\")\n     */\n    private $dateOfBirth;\n....\n    /**\n     * @ORM\\Column(type=\"datetime\")\n     */\n    private $createdAt;\n....\n}\nNow all my dates are formatted with the selected format. But that's not exactly what I need!\nHow do I format my dates with different formats?\nIn my case, I want to use the default format for createdAt and the inputed format for dateOfBirth.\n. The thing is that the form is valid since it holds a proxy of an entity. The problems comes when persisting the relation.\nHere is what I have in my log file it it's any help\n\nUncaught PHP Exception Doctrine\\ORM\\EntityNotFoundException\n. So what should we do?\nDo you need info to see what's going on?\n. \n",
    "hectorh30": "Hi there, I'm quite interested in working on this.\nI've never done any open source major contribution so a little help would be very much appreciated :-) On the other hand I think I know my way around Symfony.\nSince JSON-API has its own Content-Type I would think content negotation should determine if using a possible JSON API serializer, right?\n. I guess #1602 relates to what you're looking for. ",
    "renz-ken": "@luispabon have you had any progress on this? We're quite keen to put some work into developing jsonapi support in the next couple of weeks so if you have started we could potentially build this further\n. ",
    "bpolaszek": "Thanks, I didn't look at the correct one.\nFor each repo, Github should offer a Noobz Zone category: I hate to post in issues when the \"issue\" is between the chair and the screen :-)\nThanks,\nBen\n. Is there a changelog somewhere about what happened between v1 and v2?\n. Perfect!\n. ",
    "zacrasta": "Hi @theofidry\nI have edited issue with your requirements. Hope that will help\n. I checked with curl request and in response I am getting HTML code \n<html><head>\n<title>301 Moved Permanently</title>\n</head><body>\n<h1>Moved Permanently</h1>\n<p>The document has moved <a href=\"https://domain.com/api/v1/surveys?_format=json&amp;access_token=OTNhMDk2NmI4NTI5OTcxMGM3MGYwMTQ5ZWE0MDM1MzgyMGQ2OWEyNDYyNzU5NmNlNTZiYzYxYTljZTg1MGJlMA\">here</a>.</p>\n<hr>\n<address>Apache/2.4.7 (Ubuntu) Server at domain.com Port 80</address>\n</body></html>\nSo requesting POST should be with HTTPS in order to work , but GET request should be an HTTP request (which is weird). I think it may be a server issue. Thank you guys for help @dunglas @theofidry \n. ",
    "maechler": "Moved to https://github.com/api-platform/core/issues/767\n. @teohhanhui Thanks!\n. And how would you implement this? \nAdd a constant UrlGeneratorInterface::CONFIG = -1 and change the interface and all the method calls to default to CONFIG. And then pass the configuration to your router and set the reference type to the value in the configuration if necessary?\n. I have just created a pull request, if you had something different in mind, please let me know.\nI am also not quite sure about the naming of the configuration.\nhttps://github.com/api-platform/core/pull/751\n. ",
    "FrodeMMeling": "Is there any upgrade instructions?\n. ",
    "andreas-glaser": "Has this been implemented? And if so, is it documented?\n. It's been two weeks since the question was raised. Any news on the release date?\nAlso where can I find the beta documentation for v2?\n. Found the docs.. sorry for the hasty question ;)\nhttps://github.com/api-platform/docs/blob/master/distribution/index.md\n. ",
    "cfuerst": "sorry i did not noticed the 2.0 alpha  \ud83d\ude35 \ud83c\udf34 \n. ",
    "mbckwa": "@dunglas Ok, I'll do that.\n@teohhanhui I'm using v2.\n. I'm using Doctrine's command because the options --update-entities=true --generate-methods=true aren't available with Symfony's bin/console.\nI'll try to provide a repository soon.\n. ",
    "polc": "I need a lot of flexibility for my use case something like that using Expression Language could work maybe: @ApiProperty(readableAccessControl=\"has_role('ROLE_ADMIN') or resource.isPublic == true\")\n. Yes I didn't thought about a denormalizer before https://github.com/api-platform/core/issues/583 discussion. But It would be very nice to have this supported out of box. \nI think it's a common use case, for my project for example I have the following use case: \n- Private note on users by admins\n- Private user information viewable only by the user and the Super admin\n. It's easy to expose is_grantedwith ExpressionLanguage.\n. What core developers think about this ? Good idea to implement or not common enough use case ? \n. It can now be achieved using dynamic serialization context : https://api-platform.com/docs/core/serialization-groups-and-relations#changing-the-serialization-context-dynamically \nSymfony Workflow component integration is a good idea but not a priority I guess^^\n. ",
    "regniblod": "Any updates on this?. The Email class is just a simple Value Object that I create and pass to the User __construct, but it could be a string, int o whatever. . I'm using a DDD/Hexagonal architecture approach and I would like to decouple my Domain from the Framework, so not having a __construct and just call all the setters that I need to initialise my entity doesn't fit in my project.\nIs it technicaly possible to add this option to the framework in a PR? Maybe someone can take over and code it if enough people find it useful.. @soyuka Could you please provide an example? I tried both the event and the action for POST /<resource> without success.\nExtra points for opening a PR to the official docs \ud83d\ude1b . I tried to create a custom action to try to do what I need and I still can't do it. This is my code:\n```php\n<?php\nnamespace Inkuinen\\User\\Application\\UserBundle\\Action;\nuse Inkuinen\\User\\Domain\\Model\\User;\nuse Inkuinen\\User\\Domain\\Value\\Email;\nuse Sensio\\Bundle\\FrameworkExtraBundle\\Configuration\\Method;\nuse Sensio\\Bundle\\FrameworkExtraBundle\\Configuration\\Route;\nclass DebugAction\n{\n    /*\n     * @Method(\"POST\")\n     * @Route(\n     *     name=\"users_new\",\n     *     path=\"/users_new/{id}\",\n     *     defaults={\"_api_resource_class\"=Inkuinen\\User\\Domain\\Model\\User::class, \"_api_item_operation_name\"=\"users_new\"}\n     * )\n     /\n    public function __invoke($data)\n    {\n        return new User(new Email('test@test.com'));\n    }\n}\nyaml\nresources:\n    Inkuinen\\User\\Domain\\Model\\User:\n        class: Inkuinen\\User\\Domain\\Model\\User\n        collectionOperations:\n            getUsers:\n                method: GET\n            postUser:\n                method: POST\n            special:\n                route_name: 'users_new'\n        itemOperations:\n            getUser:\n                method: GET\n            editUser:\n                method: PUT\n            deleteUser:\n                method: DELETE\n``\nThis is the response I get in thehydra:description:Invalid identifier \\\"\\\", \\\"id\\\" has not been found.`\nIf I change the route to /users_new/{id} this is the response: Not Found\nAm I missing something?. ",
    "lemoinem": "Hi guys!\nReading on this got me thinking about the current state-of-the-art of security in REST APIs and Web Apps based on them.\nI wrote a little (ok, not quite so little) piece on that: http://blog.mlemoine.name/2017/04/22/REST-APIs-authentication-and-security.html .\nInitial feedback has been good and I thought you could be interested by it. It might help to provide some ideas regarding the \"Secure by default\" issue and make API Platform even better than it already is.\nAny feedback welcome (email or private feedback might be better than this issue, I don't want to hijack it).. I've just found https://github.com/Spomky-Labs/jose-bundle which seem to support pretty much everything you could think of in term of JWT implementation.\nThey seem to have a much bigger feature set than LexikJWTAuthenticationBundle.... Well, support of JWE and everything related to encryption. As far as I could see, Lexik only supports JWS. That's the most important feature\nI'm currently in the process of implementing the Authentication API I described in my blog posts.\nI will try and package it as a bundle and post an alpha version soon.\nIf Lexik does support JWE, I will double check my assumptions and see if the implementation is easier with Lexik (or even If I can easily support both).. ",
    "magarzon": "@lemoinem where do you see bigger feature? There is a great lack of documentation in that bundle, that I think it's as important as the features, but in a quick look, I haven't even seen anything that LexikJWTAuthenticationBundle is not doing. Here what I answered him already in Slack, so it can be use as reference and probably to close the issue:\nA solution can be to have a custom denormalizer for that class. That way he can create the instance of the class whatever he want.\nAnother solution (if the user can set/choose this kind of constructor parameter) is to have a parameter in the json in the POST body with the same name as the constructor parameter, because the default Serializer ObjectNormalizer use reflection to create the instance and if the constructor has parameters, it tries to denormalize them from the input.\n. ",
    "kbsali": "ok, thanks @teohhanhui @dunglas !\nI'll give the controller version another try then!\nand i am most definitely looking forward to seeing your batching solution ! :)\nBTW you are talking about v2.1, have you published a roadmap of v2 somewhere? When are you expecting the final v2 to be published?\nthanks again!\n. ",
    "cve": "Ok, I'm simply cloning master :)\n. thanks\n. sorry I made a mistake... yaml file should be named api_resources.yml instead of resources.yml..., now it works :) thanks.\n. AppBundle/Resource/config/api_resouces.yml\n````yaml\ncustomer\ncustomer:\n  class: 'AppBundle\\Entity\\Customer'\n  attributes:\n    filters: ['customer.search', 'customer.order', 'customer.boolean']\n  collectionOperations:\n    get:\n      method: 'GET'\n      normalization_context:\n        groups: ['customer_list']\n  itemOperations:\n    get:\n      method: 'GET'\n      normalization_context:\n        groups: ['customer_get']\n````\nAppBundle/Resources/config/serializer.yml\nyaml\nAppBundle\\Entity\\Customer:\n    attributes:\n        id:\n            groups: ['customer_list', 'customer_get']\n        taxId:\n            groups: ['customer_list', 'customer_get']\n        email:\n            groups: ['customer_list', 'customer_get']\n        fullName:\n            groups: ['customer_list', 'customer_get']\nAfter clearing cache I get empty customer json's\nIn Symfony doc there is also:\n````php\nuse Symfony\\Component\\Serializer\\Mapping\\Factory\\ClassMetadataFactory;\n// For annotations\nuse Doctrine\\Common\\Annotations\\AnnotationReader;\nuse Symfony\\Component\\Serializer\\Mapping\\Loader\\AnnotationLoader;\n// For XML\n// use Symfony\\Component\\Serializer\\Mapping\\Loader\\XmlFileLoader;\n// For YAML\n// use Symfony\\Component\\Serializer\\Mapping\\Loader\\YamlFileLoader;\n$classMetadataFactory = new ClassMetadataFactory(new AnnotationLoader(new AnnotationReader()));\n// For XML\n// $classMetadataFactory = new ClassMetadataFactory(new XmlFileLoader('/path/to/your/definition.xml'));\n// For YAML\n// $classMetadataFactory = new ClassMetadataFactory(new YamlFileLoader('/path/to/your/definition.yml'));\n````\nBut how can I do that in api-platform?. I've resolved it with custom action which accepts that filters and returns a collection in POST_WRITE event with something like that:\nphp\n$modulesIds = array_map(function (Module $module) {\n    return $module->getId();\n}, $this->collectionDataProvider->getCollection(Module::class, 'ids'));. Thanks for your reply.\nHow to \"load\" that relation after that?. with fetch=\"EAGER\" it is the same problem like without @ApiResource(attributes={\"force_eager\"=false}). ```yaml\nresources:\n  AppBundle\\Entity\\Campaign:\n    collectionOperations:\n      get:\n        method: 'GET'\n        normalization_context:\n          groups: ['campaign_list']\n    itemOperations:\n      get:\n        method: 'GET'\n        normalization_context:\n          groups: ['campaign_get']\n        force_eager: false\n````\n````php\n<?php\nnamespace AppBundle\\Entity;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Component\\Serializer\\Annotation\\Groups;\n/\n * A campaign.\n \n * @ORM\\Entity()\n /\nclass Campaign\n{\n    /\n     * @Groups({\"campaign_list\", \"campaign_get\"})\n     \n     * @ORM\\Id\n     * @ORM\\GeneratedValue\n     * @ORM\\Column(type=\"integer\")\n     /\n    private $id;\n/**\n * @Groups({\"campaign_list\", \"campaign_get\"})\n *\n * @ORM\\Column\n */\nprivate $name;\n\n/**\n * @Groups({\"campaign_get\"})\n *\n * @ORM\\ManyToMany(targetEntity=\"AppBundle\\Entity\\Campaign\", fetch=\"EAGER\")\n */\nprivate $excluded;\n\n}\n````\nand the result after GET /campaigns/1:\nThe total number of joined relations has exceeded the specified maximum. Raise the limit if necessary.. Without that, there is no exception, but the response does not contain excluded array\nyaml\n{\n  \"@context\": \"/contexts/Campaign\",\n  \"@id\": \"/campaigns/2\",\n  \"@type\": \"Campaign\",\n  \"id\": 2,\n  \"name\": \"campaign name\"\n}. Sorry for my late reaponse :-),  Yes it works now, thanks. . @clementtalleu I didn't have to change enythink, becasue @Simperfit pull request resolves my issue, which version of api platform do you have?. @alborq I suggest to use \nphp\n* @ORM\\Column(name=\"definition\", type=\"json\")\nhttp://docs.doctrine-project.org/projects/doctrine-dbal/en/latest/reference/types.html#json. I'm using DunglasActionBundle which should autowire it as doc says, and that's true case when I put exit in setCurrentUser then te object does not even persisted. Yes, for example Category:\n````php\n<?php\nnamespace AppBundle\\Entity;\nuse Doctrine\\Common\\Collections\\ArrayCollection;\nuse Doctrine\\ORM\\Mapping as ORM;\n/\n * Category\n \n * @ORM\\Table(name=\"category\")\n * @ORM\\Entity(repositoryClass=\"AppBundle\\Repository\\CategoryRepository\")\n /\nclass Category\n{\n    /\n     * @var int\n     \n     * @ORM\\Column(name=\"id\", type=\"integer\")\n     * @ORM\\Id\n     * @ORM\\GeneratedValue(strategy=\"AUTO\")\n     /\n    private $id;\n/**\n * @var string\n *\n * @ORM\\Column(name=\"name\", type=\"string\", length=255, unique=true)\n */\nprivate $name;\n\n/**\n * @var bool\n *\n * @ORM\\Column(name=\"enabled\", type=\"boolean\")\n */\nprivate $enabled;\n\n/**\n * @var ArrayCollection\n *\n * @ORM\\OneToMany(targetEntity=\"Product\", mappedBy=\"category\")\n */\nprivate $products;\n\n/**\n * @var User\n *\n * @ORM\\ManyToOne(targetEntity=\"User\", inversedBy=\"categories\")\n */\nprivate $user;\n\n/**\n * Constructor\n */\npublic function __construct()\n{\n    $this->products = new ArrayCollection();\n}\n\n/**\n * Get id\n *\n * @return int\n */\npublic function getId()\n{\n    return $this->id;\n}\n\n/**\n * Set name\n *\n * @param string $name\n *\n * @return Category\n */\npublic function setName($name)\n{\n    $this->name = $name;\n\n    return $this;\n}\n\n/**\n * Get name\n *\n * @return string\n */\npublic function getName()\n{\n    return $this->name;\n}\n\n/**\n * Set enabled\n *\n * @param boolean $enabled\n *\n * @return Category\n */\npublic function setEnabled($enabled)\n{\n    $this->enabled = $enabled;\n\n    return $this;\n}\n\n/**\n * Get enabled\n *\n * @return bool\n */\npublic function getEnabled()\n{\n    return $this->enabled;\n}\n\n/**\n * Add product\n *\n * @param Product $product\n *\n * @return Category\n */\npublic function addProduct(Product $product)\n{\n    $this->products[] = $product;\n\n    return $this;\n}\n\n/**\n * Remove product\n *\n * @param Product $product\n */\npublic function removeProduct(Product $product)\n{\n    $this->products->removeElement($product);\n}\n\n/**\n * Get products\n *\n * @return \\Doctrine\\Common\\Collections\\Collection\n */\npublic function getProducts()\n{\n    return $this->products;\n}\n\n/**\n * Set user\n *\n * @param User $user\n *\n * @return Category\n */\npublic function setUser(User $user = null)\n{\n    $this->user = $user;\n\n    return $this;\n}\n\n/**\n * Get user\n *\n * @return User\n */\npublic function getUser()\n{\n    return $this->user;\n}\n\n}\n````. It works know... I forgot to clear the cache probably, thanks for your time, and sorry . I don't, I'm using docker on linux - debian 9 - latest. Sorry, but what details am I missing? I'm downloaded latest api-platform to linux with docker, changed ports as described above and it give me \"File not found\" for localhost:8080. runing\nbash\n$ docker-compose exec php ls public\nreturns\nbash\nbundles      favicon.ico  index.php. ",
    "OCoulonAckwa": "OK thank you.\n. Solved : I dezipped the archive on my PC before to upload to linux server.\nI tried to upload zip to linux serveur then unzip it from linux server and it works.. ",
    "henno": "Referred page  https://getcomposer.org/doc/articles/troubleshooting.md#memory-limit-errors talks about getting Xdebug commented out in php.ini but in my case I did not find xdebug from php -i | grep -i xdebug\nSince my loaded php.ini had memory_limit=128MB and not 1073741824 (1G) as in the error message, it got me thinking that maybe composer uses some other php.ini. Injecting printing out used php ini path to composer yielded information that composer did not use any php ini at all. My composer is installed globally and I have an alias named php in my ~/.bash_profile, linking it to my MAMP's version of php (7.0.8). I thought maybe composer does not use this alias and uses some other version of php, so I downloaded composer.phar and ran it as blog-api henno$ php composer.phar update and got green :)\n\n. Nevertheless it would be appropriate to do something about this issue. Not every newbie would have been able to solve this issue.\n. ",
    "fxkopp": "Good too know. Thank you very much \ud83d\udc4d \n. @Simperfit don't really know - sorry had no time to test this, so maybe i will have some questions when trying :)\n. ",
    "rudidev08": "Fantastic, thank you!\n. Success! Documenting steps below in case someone else needs them.\nUsing docs at Installing API Platform Core\nI've called this after installing latest symfony (3.1.4)\ncomposer require api-platform/core\n```\nUsing version ^1.1 for api-platform/core\nProblem 1\n    - api-platform/core v1.1.0 requires phpdocumentor/reflection ^1.0.7 -> satisfiable by phpdocumentor/reflection[1.0.7].\n    - api-platform/core v1.1.1 requires phpdocumentor/reflection ^1.0.7 -> satisfiable by phpdocumentor/reflection[1.0.7].\n    - Conclusion: don't install phpdocumentor/reflection 1.0.7\n    - Installation request for api-platform/core ^1.1 -> satisfiable by api-platform/core[v1.1.0, v1.1.1].\n```\nNext i've tried to request ^2.0\ncomposer require api-platform/core ^2.0\nProblem 1\n    - The requested package api-platform/core 2.* is satisfiable by api-platform/core[2.0.x-dev, v2.0.0-alpha.1, v2.0.0-alpha.2, v2.0.0-beta.1, v2.0.0-beta.2, v2.0.0-beta.3] but these conflict with your requirements or minimum-stability.\nFinally adding this to composer.json fixed it:\n\"minimum-stability\": \"beta\"\nNote that since I'm using MAMP with OS X, i've also needed to install PHP 7 from http://php-osx.liip.ch and set default path to it in .bash_profile, otherwise composer will complain that PHP 7 is not present.\n. ",
    "martijn80": "I managed to workaround the PHP 7 requirement with\ncomposer require api-platform/core ^2.0 --ignore-platform-reqs\nAnd installing \ncomposer require symfony/polyfill-php70\n. ",
    "amenophis": "I confirm I can update with POST. But can't create with PUT\n. I use the api-platform distribution without modification, so yes !\n. Hi,\n@meyerbaptiste I use the version v2.0.0-rc.2 of api-platform/core\nEdit: I tried also with v2.0.0-rc.3\nYou can find my entities, mapping and serialization below\n``` php\n<?php\nnamespace AppBundle\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiProperty;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse AppBundle\\TimestampableInterface;\nuse Doctrine\\Common\\Collections\\ArrayCollection;\nuse Ramsey\\Uuid\\Uuid;\n/*\n * @ApiResource(\n *     shortName=\"Procedure\",\n *     attributes={\n *         \"normalization_context\"={\"groups\"={\"procedure_read\"}},\n *         \"denormalization_context\"={\"groups\"={\"procedure_write\"}}\n *     }\n * )\n /\nclass Procedure implements TimestampableInterface\n{\n    use Timestampable;\nconst STATUS_DRAFT = 'draft';\nconst STATUS_IN_PROGRESS = 'in_progress';\nconst STATUS_FINISHED = 'finished';\nconst STATUS_CANCELED = 'canceled';\nconst STATUS_EXPIRED = 'expired';\n\n/**\n * @var string\n *\n * @ApiProperty()\n */\nprotected $id;\n\n/**\n * @var string\n *\n * @ApiProperty()\n */\nprotected $name;\n\n/**\n * @var string\n *\n * @ApiProperty()\n */\nprotected $description;\n\n/**\n * @var string\n *\n * @ApiProperty()\n */\nprotected $status;\n\n/**\n * @var \\DateTime\n *\n * @ApiProperty()\n */\nprotected $expiresAt;\n\n/**\n * @var Signer[]\n *\n * @ApiProperty()\n */\nprotected $signers;\n\npublic function __construct()\n{\n    $this->id = (string) Uuid::uuid4();\n    $this->status = self::STATUS_DRAFT;\n    $this->signers = new ArrayCollection();\n}\n\n/**\n * @return string\n */\npublic function getId()\n{\n    return $this->id;\n}\n\n/**\n * @param string $id\n */\npublic function setId(string $id)\n{\n    $this->id = $id;\n}\n\n/**\n * @return string\n */\npublic function getName()\n{\n    return $this->name;\n}\n\n/**\n * @param string $name\n */\npublic function setName(string $name)\n{\n    $this->name = $name;\n}\n\n/**\n * @return string\n */\npublic function getDescription()\n{\n    return $this->description;\n}\n\n/**\n * @param string $description\n */\npublic function setDescription(string $description)\n{\n    $this->description = $description;\n}\n\n/**\n * @return string\n */\npublic function getStatus()\n{\n    return $this->status;\n}\n\n/**\n * @param string $status\n */\npublic function setStatus(string $status)\n{\n    $this->status = $status;\n}\n\n/**\n * @return \\DateTime\n */\npublic function getExpiresAt()\n{\n    return $this->expiresAt;\n}\n\n/**\n * @param \\DateTime $expiresAt\n */\npublic function setExpiresAt(\\DateTime $expiresAt)\n{\n    $this->expiresAt = $expiresAt;\n}\n\n/**\n * @return Signer[]\n */\npublic function getSigners()\n{\n    return $this->signers;\n}\n\n/**\n * @param Signer[] $signers\n */\npublic function setSigners(array $signers)\n{\n    foreach ($signers as $signer) {\n        $signer->setProcedure($this);\n    }\n\n    $this->signers = $signers;\n}\n\n}\n```\n``` xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n<entity table=\"procedures\" name=\"AppBundle\\Entity\\Procedure\">\n\n    <id name=\"id\" type=\"string\" />\n\n    <field name=\"name\" type=\"string\" />\n    <field name=\"description\" type=\"text\" nullable=\"true\" />\n    <field name=\"status\" type=\"string\" />\n    <field name=\"expiresAt\" type=\"datetime\" nullable=\"true\" />\n\n    <one-to-many target-entity=\"AppBundle\\Entity\\Signer\" mapped-by=\"procedure\" field=\"signers\" fetch=\"EAGER\">\n        <cascade>\n            <cascade-persist/>\n        </cascade>\n    </one-to-many>\n\n</entity>\n\n\n```\n``` xml\n<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n\n<class name=\"AppBundle\\Entity\\Procedure\">\n\n    <attribute name=\"name\">\n        <group>procedure_read</group>\n        <group>procedure_write</group>\n    </attribute>\n\n    <attribute name=\"description\">\n        <group>procedure_read</group>\n        <group>procedure_write</group>\n    </attribute>\n\n    <attribute name=\"createdAt\">\n        <group>procedure_read</group>\n    </attribute>\n\n    <attribute name=\"updatedAt\">\n        <group>procedure_read</group>\n    </attribute>\n\n    <attribute name=\"expiresAt\">\n        <group>procedure_read</group>\n        <group>procedure_write</group>\n    </attribute>\n\n    <attribute name=\"status\">\n        <group>procedure_read</group>\n    </attribute>\n\n    <attribute name=\"signers\">\n        <group>procedure_read</group>\n        <group>procedure_write</group>\n    </attribute>\n\n</class>\n\n\n```\n``` php\n<?php\nnamespace AppBundle\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiProperty;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse AppBundle\\TimestampableInterface;\nuse Ramsey\\Uuid\\Uuid;\n/*\n * @ApiResource(\n *     shortName=\"Signer\",\n *     attributes={\n *         \"normalization_context\"={\"groups\"={\"signer_read\"}},\n *         \"denormalization_context\"={\"groups\"={\"signer_write\"}}\n *     }\n * )\n /\nclass Signer implements TimestampableInterface\n{\n    use Timestampable;\nconst STATUS_DRAFT = 'draft';\nconst STATUS_PENDING = 'pending';\nconst STATUS_PROCESSING = 'processing';\nconst STATUS_SIGNED = 'signed';\n\n/**\n * @var string\n *\n * @ApiProperty()\n */\nprotected $id;\n\n/**\n * @var string\n *\n * @ApiProperty()\n */\nprotected $firstName;\n\n/**\n * @var string\n *\n * @ApiProperty()\n */\nprotected $lastName;\n\n/**\n * @var string\n *\n * @ApiProperty()\n */\nprotected $email;\n\n/**\n * @var string\n *\n * @ApiProperty()\n */\nprotected $phone;\n\n/**\n * @var Procedure\n *\n * @ApiProperty()\n */\nprotected $procedure;\n\npublic function __construct()\n{\n    $this->id = (string) Uuid::uuid4();\n}\n\n/**\n * @return string\n */\npublic function getId()\n{\n    return $this->id;\n}\n\n/**\n * @param string $id\n */\npublic function setId(string $id)\n{\n    $this->id = $id;\n}\n\n/**\n * @return string\n */\npublic function getFirstName()\n{\n    return $this->firstName;\n}\n\n/**\n * @param string $firstName\n */\npublic function setFirstName(string $firstName)\n{\n    $this->firstName = $firstName;\n}\n\n/**\n * @return string\n */\npublic function getLastName()\n{\n    return $this->lastName;\n}\n\n/**\n * @param string $lastName\n */\npublic function setLastName(string $lastName)\n{\n    $this->lastName = $lastName;\n}\n\n/**\n * @return string\n */\npublic function getEmail()\n{\n    return $this->email;\n}\n\n/**\n * @param string $email\n */\npublic function setEmail(string $email)\n{\n    $this->email = $email;\n}\n\n/**\n * @return string\n */\npublic function getPhone()\n{\n    return $this->phone;\n}\n\n/**\n * @param string $phone\n */\npublic function setPhone(string $phone)\n{\n    $this->phone = $phone;\n}\n\n/**\n * @return Procedure\n */\npublic function getProcedure()\n{\n    return $this->procedure;\n}\n\n/**\n * @param Procedure $procedure\n */\npublic function setProcedure(Procedure $procedure)\n{\n    $this->procedure = $procedure;\n}\n\n}\n```\n``` xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n<entity table=\"signers\" name=\"AppBundle\\Entity\\Signer\">\n\n    <id name=\"id\" type=\"string\" />\n\n    <field name=\"firstName\" type=\"string\" />\n    <field name=\"lastName\" type=\"string\" />\n    <field name=\"email\" type=\"string\" />\n    <field name=\"phone\" type=\"string\" />\n\n    <many-to-one target-entity=\"AppBundle\\Entity\\Procedure\" field=\"procedure\" inversed-by=\"signers\" />\n\n</entity>\n\n\n```\n``` xml\n<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n\n<class name=\"AppBundle\\Entity\\Signer\">\n\n    <attribute name=\"firstName\">\n        <group>signer_read</group>\n        <group>signer_write</group>\n        <group>procedure_read</group>\n        <group>procedure_write</group>\n    </attribute>\n\n    <attribute name=\"lastName\">\n        <group>signer_read</group>\n        <group>signer_write</group>\n        <group>procedure_read</group>\n        <group>procedure_write</group>\n    </attribute>\n\n    <attribute name=\"email\">\n        <group>signer_read</group>\n        <group>signer_write</group>\n        <group>procedure_read</group>\n        <group>procedure_write</group>\n    </attribute>\n\n    <attribute name=\"phone\">\n        <group>signer_read</group>\n        <group>signer_write</group>\n        <group>procedure_read</group>\n        <group>procedure_write</group>\n    </attribute>\n\n    <attribute name=\"createdAt\">\n        <group>signer_read</group>\n    </attribute>\n\n    <attribute name=\"updatedAt\">\n        <group>signer_read</group>\n    </attribute>\n\n    <attribute name=\"procedure\">\n        <group>signer_read</group>\n    </attribute>\n\n</class>\n\n\n. @teohhanhui OK understand.\nSigners could not be reused across procedure.\nWhat i want to do, is allowing api caller to update a signer inside a procedure without sending all signers informations.\n. @ppounder Can you check if this patch is applied on your side: https://github.com/api-platform/api-platform/pull/141/files ?\n. @Simperfit You need to use the other installation technique to not have to change the hash after each composer install.\nTake a look here: https://getcomposer.org/doc/faqs/how-to-install-composer-programmatically.md \n. hi @alborq ,\nYou could use https://github.com/dunglas/doctrine-json-odm made by @dunglas :). hi @alborq,\nThe error is api-platform use the GET item route to generate IRI, the `@id` field in JSON. Hi @cve,\ndid you configured your classCurrentUserSubscriberas a service with the tagkernel.event_subscriber``` ??\nAre your sure the code is called ?. OK, that's right.\nCould you share your entity which have the setUser method ?. @sbacem You need to install the php driver for postgresql in the docker image.\nOnly mysql driver is installed by default. Use a use at the top of the class, no ?\n. same as above\n. same as above\n. You can use .dockerignore file, it is like .gitignore but for docker ;)\nhttps://docs.docker.com/engine/reference/builder/#/dockerignore-file\n. Why not use docker output ? It is the normal behavior for the nginx offcial image\n. ",
    "johnkrovitch": "Ok, with a content-type set the tests are good.\nThank you !\n. ",
    "carlespibernatcreus": "Hi,\nSo the best option is to add it as a new column into database? And if, for example, its value it's taken from another api? Then it has no sense to store any value into database.\nThanks!. Hi!\nSorry, I resolved my problem adding decorates: 'api_platform.jsonld.normalizer.item' to the service definition, it was only working when using json.\nThanks!\nCarles. Isn't it working with api_platform.json.normalizer.item?. ",
    "srosato": "I was wondering too, but no, as @teohhanhui suggested, as long as you have the correct serializer groups. You can add it on an accessor. For example,\nyaml\nAppBundle\\Entity\\AnEntity:\n    collectionOperations:\n        get:\n            method: GET\n    itemOperations:\n        get:\n            method: GET\n    attributes:\n        normalization_context:\n            groups:\n                - get\nNote that we could also use the @ApiResource annotation, I just took from my own project.\nAnd the AnEntity class:\n```php\nnamespace AppBundle\\Entity\\AnEntity;\nclass AnEntity\n{\n    /\n     * @var string\n     \n     * @ORM\\Column(name=\"tag\", type=\"string\", length=3, nullable=false)\n     * @Groups({\"get\"})\n     /\n    private $tag;\npublic function getTag(): string\n{\n    return $this->tag;\n}\n\n/**\n * @Groups({\"get\"})\n */\npublic function getFoo(): string\n{\n    return $this->getTag();\n}\n\n```\nWill automatically expose \"foo\" and have the value of the getTag() function in this case.. ",
    "carlespibernat": "Thanks! Works like a charm. Thanks for your answers!\nI think I did not express myself well. I have a band entity which response is something like:\n{\n  \"@context\": \"/contexts/Band\",\n  \"@id\": \"/bands\",\n  \"@type\": \"hydra:Collection\",\n  \"hydra:member\": [\n    {\n      \"@id\": \"/bands/1\",\n      \"@type\": \"Band\",\n      \"id\": 1,\n      \"name\": \"My band\",\n      \"description\": \"This is a test band\",\n      \"styles\": [\n        {\n          \"@id\": \"/styles/1\",\n          \"@type\": \"Style\",\n          \"id\": 1,\n          \"name\": \"Test style\"\n        },\n        {\n          \"@id\": \"/styles/2\",\n          \"@type\": \"Style\",\n          \"id\": 2,\n          \"name\": \"Test style 2\"\n        }\n      ]\n    }\n  ],\n  \"hydra:totalItems\": 1\n}\nNow I want to add another property to the response with the profile photo, so the response would be like this:\n{\n  \"@context\": \"/contexts/Band\",\n  \"@id\": \"/bands\",\n  \"@type\": \"hydra:Collection\",\n  \"hydra:member\": [\n    {\n      \"@id\": \"/bands/1\",\n      \"@type\": \"Band\",\n      \"id\": 1,\n      \"name\": \"My band\",\n      \"description\": \"This is a test band\",\n      \"styles\": [\n        {\n          \"@id\": \"/styles/1\",\n          \"@type\": \"Style\",\n          \"id\": 1,\n          \"name\": \"Test style\"\n        },\n        {\n          \"@id\": \"/styles/2\",\n          \"@type\": \"Style\",\n          \"id\": 2,\n          \"name\": \"Test style 2\"\n        }\n      ],\n      \"profilePhoto\": \"https://domain.com/photos/band.png\"\n    }\n  ],\n  \"hydra:totalItems\": 1\n}\nThe profile url is given by a service, so I need to use this service to get the  url.  \nWhat I understand from @mysiar answer is to create get a new endpoint where i can retrieve the profile photo path, and what I understand from @Simperfit is to do some action to get the url after another action is done, isn't it?. Hi!\nThanks for your answers and sorry for the delay.\n@DariuszLuber, I can't see how can I get a custom service inside the doctrine event listener :(\n@Simperfit, could you provide an example? I have tried with the documentation but for some reason I can't get my custom normalizer working.\nThanks!\nCarles. ",
    "foolskill": "Thank's\n. ",
    "sschueller": "api/src/AppBundle/Resources/config/api_resources.yml\nperson:\n    class: 'AppBundle\\Entity\\Person'\n    shortName: 'Person' # optional\n    description: 'A Person' # optional\n    iri: 'http://schema.org/Person' # optional\n    attributes: # optional\n        pagination_items_per_page: 25 # optional\napi/app/config/services.yml\nservices:\n    person.collection_data_provider:\n        class: 'AppBundle\\DataProvider\\PersonsCollectionDataProvider'\n        tags:\n            -  { name: 'api_platform.collection_data_provider' }\n    person.item_data_provider:\n        class: 'AppBundle\\DataProvider\\PersonItemDataProvider'\n        tags:\n            -  { name: 'api_platform.item_data_provider' }\napi/src/AppBundle/DataProvider/PersonsCollectionDataProvider.php\n```\n<?php\nnamespace AppBundle\\DataProvider;\nuse AppBundle\\Entity\\Person;\nuse ApiPlatform\\Core\\DataProvider\\CollectionDataProviderInterface;\nuse ApiPlatform\\Core\\Exception\\ResourceClassNotSupportedException;\nfinal class PersonsCollectionDataProvider implements CollectionDataProviderInterface\n{\n    public function getCollection(string $resourceClass, string $operationName = null)\n    {\n        if (Person::class !== $resourceClass) {\n            throw new ResourceClassNotSupportedException();\n        }\n    $person1 = new Person();\n    $person1->setId(1);\n    $person1->setFamilyName('john');\n\n    $person2 = new Person();\n    $person2->setId(2);\n    $person2->setFamilyName('jane');\n\n    // Retrieve the blog post collection from somewhere\n    return [$person1, $person2];\n}\n\n}\n```\napi/src/AppBundle/Entity/Person.php\n```\n<?php\nnamespace AppBundle\\Entity;\nclass Person\n{\nprivate $id;\n\nprivate $givenName = '';\n\nprivate $familyName = '';\n\npublic function __construct()\n{\n\n}\n\n/**\n * @return mixed\n */\npublic function getId()\n{\n    return $this->id;\n}\n\n/**\n * @param mixed $id\n */\npublic function setId($id)\n{\n    $this->id = $id;\n}\n\n/**\n * @return string\n */\npublic function getGivenName(): string\n{\n    return $this->givenName;\n}\n\n/**\n * @param string $givenName\n */\npublic function setGivenName(string $givenName)\n{\n    $this->givenName = $givenName;\n}\n\n/**\n * @return string\n */\npublic function getFamilyName(): string\n{\n    return $this->familyName;\n}\n\n/**\n * @param string $familyName\n */\npublic function setFamilyName(string $familyName)\n{\n    $this->familyName = $familyName;\n}\n\n}\n```\nThanks\n. I am not using Doctrine ORM. I guess this would then be a feature request/bug to have this work via YAML?\n. ",
    "cr3a7ure": "I'm posting the edited apidoc, using v1 api-platform\nI'm just replacing every '#' with '#:' at the\n/api-platform/vendor/dunglas/api-bundle/Hydra/ApiDocumentationBuilder.php\nI'll come back later with a full description about hydra graph and rdflib.js\n{\n  \"@context\": {\n    \"@vocab\": \"http://localhost:8000/apidoc#\",\n    \"hydra\": \"http://www.w3.org/ns/hydra/core#\",\n    \"#\": \"http://localhost:8000/\",\n    \"rdf\": \"http://www.w3.org/1999/02/22-rdf-syntax-ns#\",\n    \"rdfs\": \"http://www.w3.org/2000/01/rdf-schema#\",\n    \"xmls\": \"http://www.w3.org/2001/XMLSchema#\",\n    \"owl\": \"http://www.w3.org/2002/07/owl#\",\n    \"domain\": {\n      \"@id\": \"rdfs:domain\",\n      \"@type\": \"@id\"\n    },\n    \"range\": {\n      \"@id\": \"rdfs:range\",\n      \"@type\": \"@id\"\n    },\n    \"subClassOf\": {\n      \"@id\": \"rdfs:subClassOf\",\n      \"@type\": \"@id\"\n    },\n    \"expects\": {\n      \"@id\": \"hydra:expects\",\n      \"@type\": \"@id\"\n    },\n    \"returns\": {\n      \"@id\": \"hydra:returns\",\n      \"@type\": \"@id\"\n    }\n  },\n  \"@id\": \"/apidoc\",\n  \"hydra:title\": \"api-platform\",\n  \"hydra:description\": \"The full description of your API\",\n  \"hydra:entrypoint\": \"/\",\n  \"hydra:supportedClass\": [\n    {\n      \"@id\": \"http://schema.org/Flight\",\n      \"@type\": \"hydra:Class\",\n      \"rdfs:label\": \"Flight\",\n      \"hydra:title\": \"Flight\",\n      \"hydra:description\": \"An airline flight.\",\n      \"hydra:supportedProperty\": [\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"#:Flight/id\",\n            \"@type\": \"rdf:Property\",\n            \"rdfs:label\": \"id\",\n            \"domain\": \"http://schema.org/Flight\",\n            \"range\": \"xmls:integer\"\n          },\n          \"hydra:title\": \"id\",\n          \"hydra:required\": false,\n          \"hydra:readable\": false,\n          \"hydra:writable\": true\n        },\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"https://schema.org/departureTime\",\n            \"@type\": \"rdf:Property\",\n            \"rdfs:label\": \"departureTime\",\n            \"domain\": \"http://schema.org/Flight\",\n            \"range\": \"xmls:dateTime\"\n          },\n          \"hydra:title\": \"departureTime\",\n          \"hydra:required\": false,\n          \"hydra:readable\": true,\n          \"hydra:writable\": true,\n          \"hydra:description\": \"The expected departure time.\"\n        },\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"https://schema.org/arrivalTime\",\n            \"@type\": \"rdf:Property\",\n            \"rdfs:label\": \"arrivalTime\",\n            \"domain\": \"http://schema.org/Flight\",\n            \"range\": \"xmls:dateTime\"\n          },\n          \"hydra:title\": \"arrivalTime\",\n          \"hydra:required\": false,\n          \"hydra:readable\": true,\n          \"hydra:writable\": true,\n          \"hydra:description\": \"The expected arrival time.\"\n        },\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"https://schema.org/departureAirport\",\n            \"@type\": \"hydra:Link\",\n            \"rdfs:label\": \"departureAirport\",\n            \"domain\": \"http://schema.org/Flight\",\n            \"range\": \"#:Airport\"\n          },\n          \"hydra:title\": \"departureAirport\",\n          \"hydra:required\": false,\n          \"hydra:readable\": true,\n          \"hydra:writable\": true,\n          \"hydra:description\": \"The airport where the flight originates.\"\n        },\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"https://schema.org/arrivalAirport\",\n            \"@type\": \"hydra:Link\",\n            \"rdfs:label\": \"arrivalAirport\",\n            \"domain\": \"http://schema.org/Flight\",\n            \"range\": \"#:Airport\"\n          },\n          \"hydra:title\": \"arrivalAirport\",\n          \"hydra:required\": false,\n          \"hydra:readable\": true,\n          \"hydra:writable\": true,\n          \"hydra:description\": \"The airport where the flight terminates.\"\n        },\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"#:Flight/adults\",\n            \"@type\": \"rdf:Property\",\n            \"rdfs:label\": \"adults\",\n            \"domain\": \"http://schema.org/Flight\",\n            \"range\": \"xmls:integer\"\n          },\n          \"hydra:title\": \"adults\",\n          \"hydra:required\": true,\n          \"hydra:readable\": true,\n          \"hydra:writable\": true\n        },\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"https://schema.org/name\",\n            \"@type\": \"rdf:Property\",\n            \"rdfs:label\": \"name\",\n            \"domain\": \"http://schema.org/Flight\",\n            \"range\": \"xmls:string\"\n          },\n          \"hydra:title\": \"name\",\n          \"hydra:required\": false,\n          \"hydra:readable\": true,\n          \"hydra:writable\": true,\n          \"hydra:description\": \"The name of the item.\"\n        }\n      ],\n      \"hydra:supportedOperation\": [\n        {\n          \"@type\": \"hydra:Operation\",\n          \"hydra:method\": \"GET\",\n          \"hydra:title\": \"Retrieves Flight resource.\",\n          \"rdfs:label\": \"Retrieves Flight resource.\",\n          \"returns\": \"http://schema.org/Flight\"\n        },\n        {\n          \"@type\": \"hydra:ReplaceResourceOperation\",\n          \"expects\": \"http://schema.org/Flight\",\n          \"hydra:method\": \"PUT\",\n          \"hydra:title\": \"Replaces the Flight resource.\",\n          \"rdfs:label\": \"Replaces the Flight resource.\",\n          \"returns\": \"http://schema.org/Flight\"\n        },\n        {\n          \"@type\": \"hydra:Operation\",\n          \"hydra:method\": \"DELETE\",\n          \"hydra:title\": \"Deletes the Flight resource.\",\n          \"rdfs:label\": \"Deletes the Flight resource.\",\n          \"returns\": \"owl:Nothing\"\n        }\n      ]\n    },\n    {\n      \"@id\": \"http://schema.org/Airport\",\n      \"@type\": \"hydra:Class\",\n      \"rdfs:label\": \"Airport\",\n      \"hydra:title\": \"Airport\",\n      \"hydra:description\": \"An airport.\",\n      \"hydra:supportedProperty\": [\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"#:Airport/id\",\n            \"@type\": \"rdf:Property\",\n            \"rdfs:label\": \"id\",\n            \"domain\": \"http://schema.org/Airport\",\n            \"range\": \"xmls:integer\"\n          },\n          \"hydra:title\": \"id\",\n          \"hydra:required\": false,\n          \"hydra:readable\": false,\n          \"hydra:writable\": true\n        },\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"https://schema.org/address\",\n            \"@type\": \"hydra:Link\",\n            \"rdfs:label\": \"address\",\n            \"domain\": \"http://schema.org/Airport\",\n            \"range\": \"#:PostalAddress\"\n          },\n          \"hydra:title\": \"address\",\n          \"hydra:required\": false,\n          \"hydra:readable\": true,\n          \"hydra:writable\": true,\n          \"hydra:description\": \"Physical address of the item.\"\n        },\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"https://schema.org/iataCode\",\n            \"@type\": \"rdf:Property\",\n            \"rdfs:label\": \"iataCode\",\n            \"domain\": \"http://schema.org/Airport\",\n            \"range\": \"xmls:string\"\n          },\n          \"hydra:title\": \"iataCode\",\n          \"hydra:required\": false,\n          \"hydra:readable\": true,\n          \"hydra:writable\": true,\n          \"hydra:description\": \"IATA identifier for an airline or airport.\"\n        },\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"https://schema.org/name\",\n            \"@type\": \"rdf:Property\",\n            \"rdfs:label\": \"name\",\n            \"domain\": \"http://schema.org/Airport\",\n            \"range\": \"xmls:string\"\n          },\n          \"hydra:title\": \"name\",\n          \"hydra:required\": false,\n          \"hydra:readable\": true,\n          \"hydra:writable\": true,\n          \"hydra:description\": \"The name of the item.\"\n        }\n      ],\n      \"hydra:supportedOperation\": [\n        {\n          \"@type\": \"hydra:Operation\",\n          \"hydra:method\": \"GET\",\n          \"hydra:title\": \"Retrieves Airport resource.\",\n          \"rdfs:label\": \"Retrieves Airport resource.\",\n          \"returns\": \"http://schema.org/Airport\"\n        },\n        {\n          \"@type\": \"hydra:ReplaceResourceOperation\",\n          \"expects\": \"http://schema.org/Airport\",\n          \"hydra:method\": \"PUT\",\n          \"hydra:title\": \"Replaces the Airport resource.\",\n          \"rdfs:label\": \"Replaces the Airport resource.\",\n          \"returns\": \"http://schema.org/Airport\"\n        },\n        {\n          \"@type\": \"hydra:Operation\",\n          \"hydra:method\": \"DELETE\",\n          \"hydra:title\": \"Deletes the Airport resource.\",\n          \"rdfs:label\": \"Deletes the Airport resource.\",\n          \"returns\": \"owl:Nothing\"\n        }\n      ]\n    },\n    {\n      \"@id\": \"http://schema.org/PostalAddress\",\n      \"@type\": \"hydra:Class\",\n      \"rdfs:label\": \"PostalAddress\",\n      \"hydra:title\": \"PostalAddress\",\n      \"hydra:description\": \"The mailing address.\",\n      \"hydra:supportedProperty\": [\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"#:PostalAddress/id\",\n            \"@type\": \"rdf:Property\",\n            \"rdfs:label\": \"id\",\n            \"domain\": \"http://schema.org/PostalAddress\",\n            \"range\": \"xmls:integer\"\n          },\n          \"hydra:title\": \"id\",\n          \"hydra:required\": false,\n          \"hydra:readable\": false,\n          \"hydra:writable\": true\n        },\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"https://schema.org/addressCountry\",\n            \"@type\": \"rdf:Property\",\n            \"rdfs:label\": \"addressCountry\",\n            \"domain\": \"http://schema.org/PostalAddress\",\n            \"range\": \"xmls:string\"\n          },\n          \"hydra:title\": \"addressCountry\",\n          \"hydra:required\": false,\n          \"hydra:readable\": true,\n          \"hydra:writable\": true,\n          \"hydra:description\": \"The country. For example, USA. You can also provide the two-letter ISO 3166-1 alpha-2 country code.\"\n        },\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"https://schema.org/addressLocality\",\n            \"@type\": \"rdf:Property\",\n            \"rdfs:label\": \"addressLocality\",\n            \"domain\": \"http://schema.org/PostalAddress\",\n            \"range\": \"xmls:string\"\n          },\n          \"hydra:title\": \"addressLocality\",\n          \"hydra:required\": false,\n          \"hydra:readable\": true,\n          \"hydra:writable\": true,\n          \"hydra:description\": \"The locality. For example, Mountain View.\"\n        },\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"https://schema.org/addressRegion\",\n            \"@type\": \"rdf:Property\",\n            \"rdfs:label\": \"addressRegion\",\n            \"domain\": \"http://schema.org/PostalAddress\",\n            \"range\": \"xmls:string\"\n          },\n          \"hydra:title\": \"addressRegion\",\n          \"hydra:required\": false,\n          \"hydra:readable\": true,\n          \"hydra:writable\": true,\n          \"hydra:description\": \"The region. For example, CA.\"\n        }\n      ],\n      \"hydra:supportedOperation\": [\n        {\n          \"@type\": \"hydra:Operation\",\n          \"hydra:method\": \"GET\",\n          \"hydra:title\": \"Retrieves PostalAddress resource.\",\n          \"rdfs:label\": \"Retrieves PostalAddress resource.\",\n          \"returns\": \"http://schema.org/PostalAddress\"\n        },\n        {\n          \"@type\": \"hydra:ReplaceResourceOperation\",\n          \"expects\": \"http://schema.org/PostalAddress\",\n          \"hydra:method\": \"PUT\",\n          \"hydra:title\": \"Replaces the PostalAddress resource.\",\n          \"rdfs:label\": \"Replaces the PostalAddress resource.\",\n          \"returns\": \"http://schema.org/PostalAddress\"\n        },\n        {\n          \"@type\": \"hydra:Operation\",\n          \"hydra:method\": \"DELETE\",\n          \"hydra:title\": \"Deletes the PostalAddress resource.\",\n          \"rdfs:label\": \"Deletes the PostalAddress resource.\",\n          \"returns\": \"owl:Nothing\"\n        }\n      ]\n    },\n    {\n      \"@id\": \"#:Entrypoint\",\n      \"@type\": \"hydra:Class\",\n      \"hydra:title\": \"The API entrypoint\",\n      \"hydra:supportedProperty\": [\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"#:Entrypoint/flight\",\n            \"@type\": \"hydra:Link\",\n            \"domain\": \"#:Entrypoint\",\n            \"rdfs:label\": \"The collection of Flight resources\",\n            \"range\": \"hydra:PagedCollection\",\n            \"hydra:supportedOperation\": [\n              {\n                \"@type\": \"hydra:Operation\",\n                \"hydra:method\": \"GET\",\n                \"hydra:title\": \"Retrieves the collection of Flight resources.\",\n                \"rdfs:label\": \"Retrieves the collection of Flight resources.\",\n                \"returns\": \"hydra:PagedCollection\"\n              },\n              {\n                \"@type\": \"hydra:CreateResourceOperation\",\n                \"expects\": \"http://schema.org/Flight\",\n                \"hydra:method\": \"POST\",\n                \"hydra:title\": \"Creates a Flight resource.\",\n                \"rdfs:label\": \"Creates a Flight resource.\",\n                \"returns\": \"http://schema.org/Flight\"\n              }\n            ]\n          },\n          \"hydra:title\": \"The collection of Flight resources\",\n          \"hydra:readable\": true,\n          \"hydra:writable\": false\n        },\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"#:Entrypoint/airport\",\n            \"@type\": \"hydra:Link\",\n            \"domain\": \"#:Entrypoint\",\n            \"rdfs:label\": \"The collection of Airport resources\",\n            \"range\": \"hydra:PagedCollection\",\n            \"hydra:supportedOperation\": [\n              {\n                \"@type\": \"hydra:Operation\",\n                \"hydra:method\": \"GET\",\n                \"hydra:title\": \"Retrieves the collection of Airport resources.\",\n                \"rdfs:label\": \"Retrieves the collection of Airport resources.\",\n                \"returns\": \"hydra:PagedCollection\"\n              },\n              {\n                \"@type\": \"hydra:CreateResourceOperation\",\n                \"expects\": \"http://schema.org/Airport\",\n                \"hydra:method\": \"POST\",\n                \"hydra:title\": \"Creates a Airport resource.\",\n                \"rdfs:label\": \"Creates a Airport resource.\",\n                \"returns\": \"http://schema.org/Airport\"\n              }\n            ]\n          },\n          \"hydra:title\": \"The collection of Airport resources\",\n          \"hydra:readable\": true,\n          \"hydra:writable\": false\n        },\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"#:Entrypoint/postalAddress\",\n            \"@type\": \"hydra:Link\",\n            \"domain\": \"#:Entrypoint\",\n            \"rdfs:label\": \"The collection of PostalAddress resources\",\n            \"range\": \"hydra:PagedCollection\",\n            \"hydra:supportedOperation\": [\n              {\n                \"@type\": \"hydra:Operation\",\n                \"hydra:method\": \"GET\",\n                \"hydra:title\": \"Retrieves the collection of PostalAddress resources.\",\n                \"rdfs:label\": \"Retrieves the collection of PostalAddress resources.\",\n                \"returns\": \"hydra:PagedCollection\"\n              },\n              {\n                \"@type\": \"hydra:CreateResourceOperation\",\n                \"expects\": \"http://schema.org/PostalAddress\",\n                \"hydra:method\": \"POST\",\n                \"hydra:title\": \"Creates a PostalAddress resource.\",\n                \"rdfs:label\": \"Creates a PostalAddress resource.\",\n                \"returns\": \"http://schema.org/PostalAddress\"\n              }\n            ]\n          },\n          \"hydra:title\": \"The collection of PostalAddress resources\",\n          \"hydra:readable\": true,\n          \"hydra:writable\": false\n        }\n      ],\n      \"hydra:supportedOperation\": {\n        \"@type\": \"hydra:Operation\",\n        \"hydra:method\": \"GET\",\n        \"rdfs:label\": \"The API entrypoint.\",\n        \"returns\": \"#:EntryPoint\"\n      }\n    },\n    {\n      \"@id\": \"#:ConstraintViolation\",\n      \"@type\": \"hydra:Class\",\n      \"hydra:title\": \"A constraint violation\",\n      \"hydra:supportedProperty\": [\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"#:ConstraintViolation/propertyPath\",\n            \"@type\": \"rdf:Property\",\n            \"rdfs:label\": \"propertyPath\",\n            \"domain\": \"#:ConstraintViolation\",\n            \"range\": \"xmls:string\"\n          },\n          \"hydra:title\": \"propertyPath\",\n          \"hydra:description\": \"The property path of the violation\",\n          \"hydra:readable\": true,\n          \"hydra:writable\": false\n        },\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"#:ConstraintViolation/message\",\n            \"@type\": \"rdf:Property\",\n            \"rdfs:label\": \"message\",\n            \"domain\": \"#:ConstraintViolation\",\n            \"range\": \"xmls:string\"\n          },\n          \"hydra:title\": \"message\",\n          \"hydra:description\": \"The message associated with the violation\",\n          \"hydra:readable\": true,\n          \"hydra:writable\": false\n        }\n      ]\n    },\n    {\n      \"@id\": \"#:ConstraintViolationList\",\n      \"@type\": \"hydra:Class\",\n      \"subClassOf\": \"hydra:Error\",\n      \"hydra:title\": \"A constraint violation list\",\n      \"hydra:supportedProperty\": [\n        {\n          \"@type\": \"hydra:SupportedProperty\",\n          \"hydra:property\": {\n            \"@id\": \"#:ConstraintViolationList/violation\",\n            \"@type\": \"rdf:Property\",\n            \"rdfs:label\": \"violation\",\n            \"domain\": \"#:ConstraintViolationList\",\n            \"range\": \"#:ConstraintViolation\"\n          },\n          \"hydra:title\": \"violation\",\n          \"hydra:description\": \"The violations\",\n          \"hydra:readable\": true,\n          \"hydra:writable\": false\n        }\n      ]\n    }\n  ]\n}\n. So if # is anchor inside the same document, i suppose i should find a way for rdflib.js (which uses jsonld.js) understand it. Rather than using '#:'\n. When i'm parsing apidoc to create the RDF graph, everything that starts with # is nowhere to be found and i get fewer triples. For example i was looking for #range predicates and i had only 7 for properties like\nSCHEMA(departureDate) -->#range ---> xmls:dateTime\nbut none of: SCHEMA(arrivalAirport) --->#range---> #Airport\nWhat seems to be the problem is that the class has an @id of SCHEMA(Airport),\nbut the #range field refers to #Airport or this.Airport. Those two are not the same thing, actually #Airport seems to be nowhere. So neither my \"trick\" was actually any good.\n{\n\"@id\": \"http://schema.org/Airport\",\n\"@type\": \"hydra:Class\",\n\"rdfs:label\": \"Airport\",\n\"hydra:title\": \"Airport\",\n\"hydra:description\": \"An airport.\",\n\"hydra:supportedProperty\": [\n]}\nAnother thing is that a property from a class in the graph is a BlankNode, the whole object below. It would be easier if we could create a NameNode out of it.\n{\n\"@type\": \"hydra:SupportedProperty\",\n\"hydra:property\": {\n    \"@id\": \"https://schema.org/arrivalAirport\",\n    \"@type\": \"hydra:Link\",\n    \"rdfs:label\": \"arrivalAirport\",\n    \"domain\": \"http://schema.org/Flight\",\n    \"range\": \"#:Airport\"\n},\n\"hydra:title\": \"arrivalAirport\",\n\"hydra:required\": false,\n\"hydra:readable\": true,\n\"hydra:writable\": true,\n\"hydra:description\": \"The airport where the flight terminates.\"\n},\n. Well, i think that it would take me a lot more time to fix it, but I'll give it a try tonight.\nMeanwhile there are more references of this type, not only the #range,\n\"@id\": \"http://schema.org/Flight\",\n\"@type\": \"hydra:Class\",\n\"rdfs:label\": \"Flight\",\n\"hydra:title\": \"Flight\",\n\"hydra:description\": \"An airline flight.\",\n\"hydra:supportedProperty\": [\n{\n\"@type\": \"hydra:SupportedProperty\",\n\"hydra:property\": {\n\"@id\": \"#Flight/id\",  <----------\n\"@type\": \"rdf:Property\",\n\"rdfs:label\": \"id\",\n\"domain\": \"http://schema.org/Flight\",\n\"range\": \"xmls:integer\"\n},\n\"hydra:title\": \"id\",\n\"hydra:required\": false,\n\"hydra:readable\": false,\n\"hydra:writable\": true\n},\n. Thanks, i'll came back later to it.. Well, i asked a question in the mailing list but in the meantime I have found a simple workaround I'd like to put on the test. Since search is a simple GET method with parameters, we could add the field \"*expects\": {\"@type\": \"hydra:IriTemplate\" ...}, along with a another GET method, as seen in the json-ld below.\nI am not sure if I am violating any hydra rules. I doubt, I can really tell..\nThis implementation can be easily ( but ugly ) done using \"hydra_context\"={\"foo\"=\"bar\"} operations#configuring-operations, like so\n* @ApiResource(\n *     collectionOperations={\n *     \"special\"={\"route_name\"=\"api_ref_action\", \"hydra_context\"={\"foo\"=\"bar\"}},\n *     \"get\"={\"method\"=\"GET\", \"hydra_context\"={\"expects\"=\"hydra:template\"}}\n * }\n * )\njavascript\n{\n  \"@type\": \"hydra:SupportedProperty\",\n  \"hydra:property\": {\n    \"@id\": \"#Entrypoint/postalAddress\",\n    \"@type\": \"hydra:Link\",\n    \"domain\": \"#Entrypoint\",\n    \"rdfs:label\": \"The collection of PostalAddress resources\",\n    \"range\": \"hydra:PagedCollection\",\n    \"hydra:supportedOperation\": [\n      {\n        \"@type\": \"hydra:Operation\",\n        \"hydra:method\": \"GET\",\n        \"hydra:title\": \"Retrieves the collection of PostalAddress resources.\",\n        \"rdfs:label\": \"Retrieves the collection of PostalAddress resources.\",\n        \"returns\": \"hydra:PagedCollection\"\n      },\n      {\n        \"@type\": \"hydra:Operation\",\n        \"*expects\": {\"@type\": \"hydra:IriTemplate\" ...},\n        \"hydra:method\": \"GET\",\n        \"hydra:title\": \"Retrieves the collection of PostalAddress resources.\",\n        \"rdfs:label\": \"Retrieves the collection of PostalAddress resources.\",\n        \"returns\": \"hydra:PagedCollection\"\n      },\n      {\n        \"@type\": \"hydra:CreateResourceOperation\",\n        \"expects\": \"http://schema.org/PostalAddress\",\n        \"hydra:method\": \"POST\",\n        \"hydra:title\": \"Creates a PostalAddress resource.\",\n        \"rdfs:label\": \"Creates a PostalAddress resource.\",\n        \"returns\": \"http://schema.org/PostalAddress\"\n      }\n    ]\n  }\n},\njavascript\n\"*expects\": {\n\"@type\": \"hydra:IriTemplate\",\n\"hydra:template\": \"/postal_addresses{?id,id[],addressLocality,addressLocality[]}\",\n\"hydra:variableRepresentation\": \"BasicRepresentation\",\n\"hydra:mapping\": [\n  {\n    \"@type\": \"IriTemplateMapping\",\n    \"variable\": \"id\",\n    \"property\": \"id\",\n    \"required\": false\n  },\n  {\n    \"@type\": \"IriTemplateMapping\",\n    \"variable\": \"id[]\",\n    \"property\": \"id\",\n    \"required\": false\n  },\n  {\n    \"@type\": \"IriTemplateMapping\",\n    \"variable\": \"addressLocality\",\n    \"property\": \"addressLocality\",\n    \"required\": false\n  },\n  {\n    \"@type\": \"IriTemplateMapping\",\n    \"variable\": \"addressLocality[]\",\n    \"property\": \"addressLocality\",\n    \"required\": false\n  }\n]\n},. If you are fetching from a database(Doctrine) you should have a look at this section filters#creating-custom-doctrine-orm-filters.\nI have not implement anything similar myself though.. ",
    "lanthaler": "Yeah. @cr3a7ure, why do you think the blank nodes are problematic?\n. ",
    "kelvinsinsua": "im using api-platform v1.\nthe entity\n``` php\nnamespace UserBundle\\Entity;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Vich\\UploaderBundle\\Mapping\\Annotation as Vich;\nuse Symfony\\Component\\HttpFoundation\\File\\File;\nuse \\Symfony\\Component\\HttpFoundation\\File\\UploadedFile;\nclass Client\n{\n    /\n     * @var integer\n     \n     * @ORM\\Column(name=\"id\", type=\"integer\")\n     * @ORM\\Id\n     * @ORM\\GeneratedValue(strategy=\"AUTO\")\n     /\n    private $id;\n/**\n * @var string\n *\n * @ORM\\Column(name=\"firstname\", type=\"string\", length=255, nullable=true)\n */\nprivate $firstname;\n\n/**\n * @var string\n *\n * @ORM\\Column(name=\"lastname\", type=\"string\", length=255, nullable=true)\n */\nprivate $lastname;\n\n/**\n * @var boolean\n *\n * @ORM\\Column(name=\"gender\", type=\"boolean\", nullable=true)\n */\nprivate $gender;\n\n/**\n * @var integer\n *\n * @ORM\\Column(name=\"state\", type=\"integer\", nullable=true)\n */\nprivate $state;\n\n/**\n * @var integer\n *\n * @ORM\\Column(name=\"city\", type=\"integer\", nullable=true)\n */\nprivate $city;\n\n/**\n * @var string\n *\n * @ORM\\Column(name=\"phone\", type=\"string\", length=255, nullable=true)\n */\nprivate $phone;\n\n/**\n * @ORM\\OneToOne(targetEntity=\"User\", inversedBy=\"client\")\n * @ORM\\JoinColumn(name=\"user_id\", referencedColumnName=\"id\")\n */\n\nprivate $user;\n\n/**\n * @ORM\\OneToMany(targetEntity=\"Preference\", mappedBy=\"client\")\n */\n\nprivate $preferences;\n\n/**\n * @ORM\\OneToMany(targetEntity=\"\\OrderBundle\\Entity\\Orden\", mappedBy=\"client\")\n */\n\nprivate $orders;\n\n/**\n * @ORM\\OneToOne(targetEntity=\"\\OrderBundle\\Entity\\Cart\", mappedBy=\"client\")\n */\n\nprivate $cart;\n\n/**\n * NOTE: This is not a mapped field of entity metadata, just a simple property.\n * \n * @Vich\\UploadableField(mapping=\"client_image\", fileNameProperty=\"image\")\n * \n * @var File\n */\nprivate $imageFile;\n\n/**\n * @ORM\\Column(type=\"string\", length=255)\n *\n * @var string\n */\nprivate $image;\n\n/**\n * @ORM\\Column(type=\"datetime\")\n *\n * @var \\DateTime\n */\nprivate $updatedAt;\n\n/**\n * Get id\n *\n * @return integer \n */\npublic function getId()\n{\n    return $this->id;\n}\n\n/**\n * Set firstname\n *\n * @param string $firstname\n * @return Client\n */\npublic function setFirstname($firstname)\n{\n    $this->firstname = $firstname;\n\n    return $this;\n}\n\n/**\n * Get firstname\n *\n * @return string \n */\npublic function getFirstname()\n{\n    return $this->firstname;\n}\n\n/**\n * Set lastname\n *\n * @param string $lastname\n * @return Client\n */\npublic function setLastname($lastname)\n{\n    $this->lastname = $lastname;\n\n    return $this;\n}\n\n/**\n * Get lastname\n *\n * @return string \n */\npublic function getLastname()\n{\n    return $this->lastname;\n}\n\n/**\n * Set gender\n *\n * @param boolean $gender\n * @return Client\n */\npublic function setGender($gender)\n{\n    $this->gender = $gender;\n\n    return $this;\n}\n\n/**\n * Get gender\n *\n * @return boolean \n */\npublic function getGender()\n{\n    return $this->gender;\n}\n\n/**\n * Set state\n *\n * @param integer $state\n * @return Client\n */\npublic function setState($state)\n{\n    $this->state = $state;\n\n    return $this;\n}\n\n/**\n * Get state\n *\n * @return integer \n */\npublic function getState()\n{\n    return $this->state;\n}\n\n/**\n * Set city\n *\n * @param integer $city\n * @return Client\n */\npublic function setCity($city)\n{\n    $this->city = $city;\n\n    return $this;\n}\n\n/**\n * Get city\n *\n * @return integer \n */\npublic function getCity()\n{\n    return $this->city;\n}\n\n/**\n * Set phone\n *\n * @param string $phone\n * @return Client\n */\npublic function setPhone($phone)\n{\n    $this->phone = $phone;\n\n    return $this;\n}\n\n/**\n * Get phone\n *\n * @return string \n */\npublic function getPhone()\n{\n    return $this->phone;\n}\n\n/**\n * Set user\n *\n * @param \\UserBundle\\Entity\\User $user\n * @return Client\n */\npublic function setUser(\\UserBundle\\Entity\\User $user = null)\n{\n    $this->user = $user;\n\n    return $this;\n}\n\n/**\n * Get user\n *\n * @return \\UserBundle\\Entity\\User \n */\npublic function getUser()\n{\n    return $this->user;\n}\n/**\n * Constructor\n */\npublic function __construct()\n{\n    $this->preference = new \\Doctrine\\Common\\Collections\\ArrayCollection();\n    $this->orders = new \\Doctrine\\Common\\Collections\\ArrayCollection();\n}\n\n/**\n * Add orders\n *\n * @param \\OrderBundle\\Entity\\Order $orders\n * @return Client\n */\npublic function addOrder(\\OrderBundle\\Entity\\Orden $orders)\n{\n    $this->orders[] = $orders;\n\n    return $this;\n}\n\n/**\n * Remove orders\n *\n * @param \\OrderBundle\\Entity\\Order $orders\n */\npublic function removeOrder(\\OrderBundle\\Entity\\Orden $orders)\n{\n    $this->orders->removeElement($orders);\n}\n\n/**\n * Get orders\n *\n * @return \\Doctrine\\Common\\Collections\\Collection \n */\npublic function getOrders()\n{\n    return $this->orders;\n}\n\n/**\n * Add preferences\n *\n * @param \\UserBundle\\Entity\\Preference $preferences\n * @return Client\n */\npublic function addPreference(\\UserBundle\\Entity\\Preference $preferences)\n{\n    $this->preferences[] = $preferences;\n\n    return $this;\n}\n\n/**\n * Remove preferences\n *\n * @param \\UserBundle\\Entity\\Preference $preferences\n */\npublic function removePreference(\\UserBundle\\Entity\\Preference $preferences)\n{\n    $this->preferences->removeElement($preferences);\n}\n\n/**\n * Get preferences\n *\n * @return \\Doctrine\\Common\\Collections\\Collection \n */\npublic function getPreferences()\n{\n    return $this->preferences;\n}\n\n/**\n * Set cart\n *\n * @param \\OrderBundle\\Entity\\Cart $cart\n * @return Client\n */\npublic function setCart(\\OrderBundle\\Entity\\Cart $cart = null)\n{\n    $this->cart = $cart;\n\n    return $this;\n}\n\n/**\n * Get cart\n *\n * @return \\OrderBundle\\Entity\\Cart \n */\npublic function getCart()\n{\n    return $this->cart;\n}\n\n/**\n * If manually uploading a file (i.e. not using Symfony Form) ensure an instance\n * of 'UploadedFile' is injected into this setter to trigger the  update. If this\n * bundle's configuration parameter 'inject_on_load' is set to 'true' this setter\n * must be able to accept an instance of 'File' as the bundle will inject one here\n * during Doctrine hydration.\n *\n * @param File|\\Symfony\\Component\\HttpFoundation\\File\\UploadedFile $image\n *\n * @return Product\n */\npublic function setImageFile(File $image = null)\n{\n    $this->imageFile = $image;\n\n    if ($image) {\n        // It is required that at least one field changes if you are using doctrine\n        // otherwise the event listeners won't be called and the file is lost\n        $this->updatedAt = new \\DateTime('now');\n    }\n\n    return $this;\n}\n\n/**\n * @return File|null\n */\npublic function getImageFile()\n{\n    return $this->imageFile;\n}\n\n/**\n * @param string $image\n *\n * @return Product\n */\npublic function setImage($image)\n{\n    $this->image = $image;\n\n    return $this;\n}\n\n/**\n * @return string|null\n */\npublic function getImage()\n{\n    return $this->image;\n}\n\n}\n```\n. ",
    "ppounder": "Hi @dunglas Hope you are well, I was at the Symfony London Workshop with you. \nFinal question, would I need to add @ApiProperty(identifier=false) to the $id field?\n. Ignore that final question, I added the @ApiProperty(identifier=false) to the $id field and it now works. Many thanks\n. Yes, that's fixed it.\n. Many thanks,\nIn that example though it's on a per itemOperation, so how would I distinguish a normalization context between my standard GET itemOperation and a GET custom operation that I have created in an Action? \nCan I apply \"normalization_context\"={\"groups\"={\"custom\"}} against where I set my custom operation? For example:\n\"special\"={\"route_name\"=\"book_special\", \"normalization_context\"={\"groups\"={\"custom\"}}} \n. Thanks @soyuka @teohhanhui \n. Resolved, I'd been setting an action against an _api_item_operation_name.\nI set one up against _api_collection_operation_name with a {token} in the route, and passed $token as an argument into the __invoke method. \n. ",
    "rouflak": "Hi @theofidry!\nThanks for answering. \nThe version 1.x-dev is limited to symfony/symfony:2.8.*\nMy aim is to use the api platform on different projects, each on different servers. I won't be able to install PHP 7 on each server. Moreover, the company I'm working for is not ready to upgrade to PHP 7 (you know how many time companies need to upgrade to a major version of PHP ;) ).\nI'd really like to have PHP 7 on our servers (my own computer is on it since some time as well) but I really think many companies will hesitate to upgrade to PHP 7 until Debian comes up with this version.\nHowever the API Platform is still a great library! I look forwrad to use it!\n. @Simperfit \nThx. I won't be able to upgrade the servers, I don't have permissions on them (that's the work of one my colleague).\nI hope we will be able to upgrade to PHP7 soon.\nThx for the advice.\n. Thx all for answering. I still don't have the choice of the php version. It looks like it's much more complicated to have the version of API Platform for both symfony 3 and php 5.6 than I thought.\nUsing v1 means using symfony 2.8, and we've been using symfony 3 for many monthes now, and we won't get back on symfony 2.8.\n. @dunglas I'm in the same situation and I have replaced the  ItemNormalizer.\nIt's been pretty hard to replace it. The AbstractItemNormalizer has private methods that must be overridden to get plain IDs. I've had to copy paste a large amount of line of codes to get it work well.\nI think plain IDs will be used for many years to come. As @gouxlord said it would be very nice to have it configurable or at least more easily overrideable.\nThanks!. ",
    "Aerendir": "Maybe this is the right time to update to PHP 7: this is the case for me. Just discovered this app and just today I updated my environment to PHP 7.\nIt was time to do it, also because it is not so complex and the BC are really few... Also, if you are using Symfony 3... But I understand these may be complex things when working in a team, with the \"bureaucracy\" :( \n. Ok, perfect, is also a RC, so, it is sufficient stable? I'm experimenting with the platform: I like it a lot!!\n. Ok, just installed... I'll play with it... I hope will very deep play with it!!! And from what I've seen so far, this is a really great application and it will save me a lot of time, give me a direction on the APIs and provide me with very strong guidance about standards! Many thanks to all the team!\n. @ad3n maybe a test of the PR is better before merging... if you use mongo it may be helpful your opinion about eventual bugs or issues...\n. You have to click the menu icon again to close it... I'm not sure is a useful behavior if it is closed by a scrolling o.O\n. Maybe...\n. Ah ah ah, it's an in-house game... Ok, as you like :)\n. Just done, same error happens.\nMaybe this is related with some other bundles that the platform app uses? Because I've installed also the app and it works perfectly as expected, while installing it on an existing project gives this error. So maybe there is some other setting to adjust?\n. I have to also say that at this point I have no mapped entities: I stopped at the routing configuration point and simply gone at 127.0.0.1:8001: maybe I have to map some entities first?\n. Ok, I'm going to try to map an entity...\n. Ok, I've simply added the Foo entity from the API Platform app and it doesn't work.\nI've a private bitbucket repository to which I can give you access (also if it has some other private dependencies but you can try to clone and install it). Can you send me a private message somewhere on Facebook, Twitter or other networks with the email I have to add to the repo?\n. I'm trying to create a new app because to give you access to this I'm using is too complex as it depends on a lot of private repositories and bundles you then should remove... I'm creating a new app and trying to install the core on this new one to see if the error happens again... Give me some time.\n. Mmm, really strange... On the new created app it works perfectly with the instructions provided by the tutorial... I'm going to investigate on the other app which is the problem...\n. Strange... now all works well... I cleared the cache multiple times during tests and in the end I have only the same exact modifications suggested by the tutorial... Anyway now works... Before I've also deleted the cache folder but nothing changed... Anyway it seems to be a problem related to the cache...\n. @Hounded, after all fosuserbundle doesn\u2019t do much things: implementing resetting or confirmation or whatever else is all about a controller, a form and maybe a class for specific tasks...\nI use fosuserbundle in an app without api platform, but I\u2019m seriously considering to switch to a custom solution given the current simplicity in developing one.... @hounded , I have no link because I never searched for this...\nAnyway, you are put on the wrong way by the fact you are using api platform.\nBut registration, resetting, confirmation, ecc. are not task that pertain to api platform: the purpose of ApiPlatform is to manage resources (read: the entities you define in you application).\nWhile registration, resetting, ecc. are operations you have to manage on yourself.\nAs a starting point you can read the code implemented by FOSUserBundle, and then reimplement it (in a more simple way) in your app.\nThe form part should be handled by your frontend (eg.: React).\nFor resetting the password, the flow is this:\n\nUserController::resetPassword() receive the email via POST, from the form\nIf the email has a resetting code associated, returns a response that informs the frontend to show the form to insert the new password; if no code is already present, send it via email to the given email with a link to the UserController::resetPassword() action (route).\nIf the form is the one to submit the new password, then hash it and save. Maybe you require a new login or do the login automatically\n\nThis is a really simple flow.\nOn top of it, you can implement more features, like a check on the password strenghtness, a check on the expiration of the resetting code, automatic login after password change (or automatic logout - complete removal of cookies), ecc...\nAnyway, start defining the actions you want your user to perform:\n\nRegistration\nPassword reset\nProfile show\n\nThen outline the fundamental steps and finally search for the way to implement them in Symfony.... @teohhanhui and @dunglas , maybe also explaining the reasons behind the decision.\nThe documentation says:\n\nNote: FOSUserBundle is not well suited for APIs. We strongly encourage you to use the Doctrine user provider shipped with Symfony or to create a custom user provider instead of using this bundle.\n\nMaybe explaining the \"why\" will help users to better understand the drawbacks of using it in an ApiPlatform-based project...\nAnd, maybe, also an article about how to do this should be of help!. Good morning at all!\nI have another problem following the documentation: a circular referenc eerror:\n\nCircular reference detected for service \"AppBundle\\Serializer\\ApiNormalizer\", path: \"AppBundle\\Serializer\\ApiNormalizer -> serializer -> AppBundle\\Serializer\\ApiNormalizer\".\n\nI have simply copied and pasted the code found in the docs.\nAny ideas about what's going on?. @acidline works!!! Thank you for the really fast fix! :). Ok, I'm now on point: now I'm receiving the famous error\n\nCall to a member function normalize() on null. Solved for me:\n\n```\n    AppBundle\\Serializer\\ApiNormalizer:\n        decorates: 'api_platform.jsonld.normalizer.item'\n        arguments: [ '@AppBundle\\Serializer\\ApiNormalizer.inner' ]\nAppBundle\\Serializer\\ApiNormalizer.inner:\n    tags: ['serializer.normalizer']\n\n```\nYou have to add the tag serializer.normalizer to the AppBundle\\Serializer\\ApiNormalizer.inner.\nThe original service has this tag (https://github.com/api-platform/core/blob/master/src/Bridge/Symfony/Bundle/Resources/config/jsonld.xml#L29).\nIt seems that decorating the service removes the tag and so the Serializer is not injected.. Anyway I think this is a Bug of Symfony itself, not of API Platform.\n@dunglas , what do you think about? Should an issue has to be opened in the Symfony repo?. @SalvatorePollaci I think that you should open a new issue for this question: it will help keep the issues organized.. I also think that this issue can be closed.... Account isn't set to be an api resource:\n```php\n/\n * Account.\n \n * @ORM\\Table(name=\"coo_app_accounts\")\n * @ORM\\Entity(repositoryClass=\"AppBundle\\Repository\\AccountRepository\")\n /\nclass Account\n{\n    use TimestampableEntity;\n/**\n * @var int\n *\n * @ORM\\Column(name=\"id\", type=\"integer\")\n * @ORM\\Id\n * @ORM\\GeneratedValue(strategy=\"IDENTITY\")\n * @Groups({\"get\", \"post\"})\n */\nprivate $id;\n\n/**\n * @var string\n *\n * @ORM\\Column(name=\"name\", type=\"string\", length=255)\n */\nprivate $name;\n\n...\n\n/**\n * @var Collection\n *\n * @ORM\\OneToMany(targetEntity=\"Coommercio\\Bundle\\BusinessBundle\\Entity\\Supplier\", mappedBy=\"account\")\n */\nprivate $suppliers;\n\n...\n\n```\nAlso, I'm using serialization groups to avoid circular reference errors: maybe this can cause the issue?. Ok, setting the entity Account as an ApiResource and using its IRI works:\njson\n{\n  \"account\": \"api/accounts/1\",\n  \"name\": \"A test supplier from ApiPlatform\"\n}\nBut remains the problem, I don't want Accounts to be exposed... If I have to expose it, I'll do, but if there is another solution.... @Simperfit , excuse me if didn't reply you: I missed the notification! Anyway it's ok for me, thank you!\nExcuse me.... @hariszukanovic , the best way to update is starting with a fresh installation of SF4 and then move all your business code to this new version, practically rewriting the app.\nSimply pushing the version will require more work and doesn't guarantee you will have the full functionalities of SF4, especially Flex.\nRead here for more information: https://symfony.com/doc/current/setup/flex.html#upgrade-to-flex. OFFTOPIC: in which way does Flex influences your ability to use a dev version? I have not yet used it extensively but only tried it during a process of migrating an existing app to SF4 (failed due to unavailability of some bundles for SF4, so an incomplete experience with it).. I continue to not understand.\nFlex is a Composer plugin, but all the deps are in composer.json.\nOnce installed using composer req api-platform/api-platform, why you cannot simply change the version to dev-master in your composer.json?. Ok, you can fork api-platform/api-pack, edit its composer.json file and push to your fork, then require the forked version in your app instead of the original one in the mean time.. I think you should use events, make the caller pass a token via query string (the easiest way for who calls your endpoint) that identifies the calling app, and in the event you increment a counter persisted on the DB: once the counter reaches the amount of 1000, you do your \"money things\".. More than events? What do you mean by \"plug-and-play\"? Something that handles billings?. ",
    "jayesbe": "Symfony 2.8 is an LTS. It wont lose support until 2018. Why not make API Platform V2 compatible with the current LTS ?\nI forked the core and changes two dependencies, the property-info and serializer dependencies from ^3.1 to ^2.8. I was then able to install into my LTS version.  \nNo idea if it works but will give it a shot and if any issues arise will see the best way to fix.. but I believe LTS should very much be supported unless it absolutely cannot be. \n. @theofidry Thanks I missed the point of supporting 5.6 since my projects have been upgraded to 7.0.  Though 2.8 LTS itself does support 5.3 by default, which kind of implies that you need to support PHP 5.3 if you are to support 2.8 LTS.  I guess I could make a separate 2.8 Compatibility ticket. \n. @dunglas I agree completely. If we can't support 5.6 nor am I saying we should.. can we support 2.8 LTS with 7.0?\n. Im working on a 2.8 project and I had to downgrade 2 dependencies.. will create a pull request once I believe there are no issues. Thanks\n. Hey @e1sep0 did you resolve this?  I am seeing loading of OneToOne relations when I don't need the data. It's auto fetching the relations even when I am using force_eager=false. . ",
    "meyerbaptiste": "@amenophis: What is your version of API Platform? Can you copy your entities here please?\n. @CecileAmrl You should move your issue to https://github.com/api-platform/website.\n. IMO menu should be a slideout navigation menu. But I'm not an UI expert! \ud83d\ude1b \n. The Symfony WebServerBundle which provides the server:run command since Symfony 3.3: http://symfony.com/blog/new-in-symfony-3-3-webserverbundle\ncomposer require symfony/web-server-bundle. This one: https://github.com/api-platform/core/pull/1192. @alanpoulain is working on it, he took over from @raoulclais, see https://github.com/alanpoulain/core/commits/feature/graphql. This issue can be closed now \ud83d\ude09 . I'm on it.. Can you please test this PR? https://github.com/api-platform/core/pull/1192. Can be closed @Simperfit.. You can find an example here: https://github.com/api-platform/docs/blob/ed356c95669307202e43aa5099a44fef0c0ac2a0/core/oauth2.md#oauth2-configuration\nDoc PR isn't merged yet: https://github.com/api-platform/docs/pull/182. You have to upgrade Docker Engine to v1.13 in Travis: https://gist.github.com/dylanscott/ea6cff4900c50f4e85a58c01477e9473. Use the decorator pattern instead of inheritance: https://symfony.com/doc/current/service_container/service_decoration.html. Known issue: https://github.com/api-platform/core/issues/1096. > Therefore, to add that info to the comment from @Sybio, ensure to configure the data provider inside the applications root services.yml at app/config/services.yml\n@olivermack: Or simply use the priority tag attribute. For example:\nyaml\ntags:\n  -  { name: 'api_platform.item_data_provider', priority: 5 }. _controller seems to be missing in defaults.. If you use the ADR pattern (Action class + __invoke() method), you have to define your controller (or your action here) as a service and then use the service name as controller. (i.e. _controler: app.special_action or _controller: AppBundle\\Action\\Special).\nYou can use annotations too, see https://api-platform.com/docs/core/operations#creating-custom-operations-and-controllers.. It is in the Symfony documentation: https://symfony.com/doc/current/controller/service.html#invokable-controllers \ud83d\ude1b \nFeel free to open a PR in the doc repo. \ud83d\ude09 . No, we already are in 3.2.12 in 2.0.. IMO, not really a bug but just a bit of logic here.\n\nThis error is due to the \"decorated\" property (DoctrineOrmPropertyMetadataFactory) in the \"SerializerPropertyMetadataFactory\"\n\nI don't understand why.\nIndeed, in order to do the validation we need a populated object. However, in order to obtain a populated object, we have to denormalize the received data (i.e., the JSON transformed into a PHP array). The validation is done during the kernel.view event and the denormalization during the kernel.request event.\nIf we take your example, your username attribute is a strict string type and not nullable (cf. the method signature of your setter and getter, your PHPDoc and your Column annotation) and it's these infos that the denormalizer will use to do its job:\nSymfony\\Component\\PropertyInfo\\Type {\n    -builtinType: \"string\"\n    -nullable: false\n    -class: null\n    -collection: false\n    -collectionKeyType: null\n    -collectionValueType: null\n}\nSo when you send it null and according to the previous infos, it seems logical that the denormalizer has no choice but to tell you Symfony\\Component\\Serializer\\Exception\\UnexpectedValueException. The denormalizer expects a string but you give it a null value. It's not magic, it's common sense, isn't it?\nThe HTTP status code 500 may look brutal but you can change it:\nyaml\napi_platform:\n    exception_to_status:\n        Symfony\\Component\\Serializer\\Exception\\UnexpectedValueException: !php/const:Symfony\\Component\\HttpFoundation\\Response::HTTP_BAD_REQUEST\nAnother solution is to initialize your model with an empty string in the front.. What is your version of docker and docker-compose? What is your OS? Did you try docker-compose build --no-cache?\nI don't have any issues with the master branch.. You have to use serialization groups: https://api-platform.com/docs/core/serialization-groups-and-relations. Please refer to the Swagger-UI repository for this issue: https://github.com/swagger-api/swagger-ui.\nBTW, I think it's currently not possible (see https://github.com/swagger-api/swagger-ui/blob/087ed203849b4dfc222046e71e5fa269ab44f989/src/core/plugins/spec/selectors.js#L257-L260) or maybe with some custom JS/CSS.... Why don't you use a subresource here? \nphp\n/**\n * @ApiResource\n * ...\n */\nclass ProductType\n{\n    /**\n     * @ApiSubresource\n     * ...\n     */\n    public $toys\n}. Did you set the @ApiResource() annotation on your Toy entity?. Hi @benr77, there is no solution for annotations in 2.0.10. In the latest 2.1.0-beta there is a new way to do it: https://github.com/api-platform/core/pull/1271.\nYou can find the doc here: https://github.com/api-platform/docs/pull/240.. Switch to prod environment \ud83d\ude09 . Huum, if it doesn't work with annotations it should be considered as a bug.... Can you confirm that it works with annotations @benr77? Your first message is ambiguous. \ud83d\ude1b . IMO and from a REST point of view, your custom action should be an item operation and your custom route path should be /users/{id}/reload with an access control like object.getId() === user.getId().\nBut if you want to keep your way doing things, just don't use custom operations for that: a normal Symfony controller does the trick.\nThe COUNT query is normal because of the pagination here.\n. Duplicate of api-platform/core#1389. The correct link: https://github.com/api-platform/api-platform/blob/2.1/app/config/config.yml#L85-L92. Maybe @sroze can help (if he still uses Docker Machine instead of Docker4Mac).. Hi @acidline, do you think you can create a small public project to reproduce this issue? I tested, I can't reproduce, same for @Simperfit. It's just a classic decorator service, no reason it doesn't work.. Fixed by https://github.com/algolia/docsearch-configs/commit/117f91354baafc4720844c6d4437e2adecdd99b1.. This was fixed this afternoon: https://github.com/api-platform/docs/pull/430.\nThx for the report.. Is the value of kernel.debug true in your production env?. Moved to api-platform/schema-generator#128.. Like @teohhanhui, I'm in favor of changing the name to app.. So, \"^3.0,<3.2\"?. ",
    "magnus-eriksson": "Now RC7 is out on packagist. Any more ETA on a stable release?\n. ",
    "sh4ka": "Using the latest configuration provided in the 'master' branch seems to solve this problem.\ndatabase:\n    image: mysql\n    environment:\n        MYSQL_ROOT_PASSWORD: changeme\n        MYSQL_DATABASE: api_platform\n        MYSQL_USER: api_platform\n        MYSQL_PASSWORD: api_platform\nI leave this Issue open so the problem could be tracked and solved in the distributable branch.\n. The next command describe in the docs, docker-compose run web composer install --no-interaction:\nERROR: Cannot start service web: oci runtime error: exec: \"composer\": executable file not found in $PATH\nWhere is the composer binary installed?\n. I'll try again this evening, but this certainly sounds like a big case of pebkac.\n. Pebcak.\n. Maybe this helps:\nhttp://symfony.com/doc/current/reference/configuration/doctrine.html. ",
    "ZeBigDuck": "+1\n. Thank you for tour reply and given solution, its clearly better than my tricky override of base ItemDataProvider.\nHere are some elements that you might use to reproduce :\n```php\nnamespace AppBundle\\Entity;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\n/\n * @ORM\\Entity\n * @ORM\\InheritanceType(\"JOINED\")\n * @ORM\\DiscriminatorColumn(name=\"type\", type=\"string\")\n * @ORM\\DiscriminatorMap({\n *   \"activity\" = \"Activity\"\n * })\n * @ApiResource()\n */\nabstract class Item\n{\n    /\n     * @ORM\\Id\n     * @ORM\\Column(type=\"integer\")\n     * @ORM\\GeneratedValue\n     */\n    protected $id;\n}\n```\n```php\nnamespace AppBundle\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse Doctrine\\Common\\Collections\\ArrayCollection;\nuse Doctrine\\ORM\\Mapping as ORM;\n/\n * @ORM\\Entity\n * @ApiResource()\n */\nclass Activity extends Item\n{\n    /\n     * @ORM\\ManyToMany(targetEntity=\"Activity\")\n     */\n    protected $suggestions;\npublic function __construct()\n{\n    $this->suggestions = new ArrayCollection;\n}\n\npublic function addSuggestion(Activity $suggestion)\n{\n    $this->suggestions[] = $suggestion;\n\n    return $this;\n}\n\npublic function removeSuggestion(Activity $suggestion)\n{\n    $this->suggestions->removeElement($suggestion);\n}\n\npublic function getSuggestions()\n{\n    return $this->suggestions;\n}\n\n}\n```\nAnd query would be put on activities/1 with :\njson\n{\n  \"@id\": \"/app_dev.php/activities/1\",\n  \"suggestions\": [\n    \"/app_dev.php/activities/2\"\n  ]\n}\nI think this should be enough, but don't hesitate to ask for more!\nThank you. ",
    "ksom": "Hi @dunglas,\nI'm using the v2.\n[EDIT]\nCan you tell me if in a filter apply() method is call before getDescription() method.\nAnd can you confirm me that the Filter is executed before the DataProvider ?\nThanks a lot.\n[END EDIT]\nThanks for link to data-providers doc. I use FOSElasticaBundle too. What my service returns a PagerFantaPaginator (which contains available aggregations and count of values for each aggregation.\nThat I try to do is to return the results and also the aggregations list of values and their associated count in the cget action.\nThere is a way to give a PagerFantaPaginator with its results and aggregations to be serialized as response ?\nDid you already use Elasticsearch aggregations with api platform ?\nThank you !\n. @karser Thanks for the link,  I already seen this example but it doesn't respond to my needs.\nAggregations (previously facets) in search is also used usually. See bellow:\nAggregation documentation\nI found a way to implement it but it's not really supported in Api-Platform yet (I had to override the CollectionFiltersNormalizer).\nElasticsearch give you results + aggregations in the same search result to be performant.\nIt's unthinkable for me to just send my collection (without aggregations) and after query another url to get my aggregations because I ask my application to do 2 time the same job, it result in performance issue.\nI will write something soon to explain how I use the search.\n. @Simperfit Yes I wrote something to fit my needs. I will explain it here soon (this week, maybe tonight).\nBut I think we can have a better integration with native support. \nI can't share my code actually but I will explain and share some part of code to explain how to do.\n. Hi @Simperfit,\nI have one SearcherService:\n```php\nclass SearcherService\n{\n    protected $cachedResults = [];\n    protected $cachedAggregations = [];\npublic function search($entityName, $refresh = true)  \n{\n   // Use entityName to know what index you want to query\n\n   // Used if you want to do a new search\n   if ($refresh) {\n        $this->clearCache();\n    }\n\n    // build your search\n    $result = $finder->findPaginated($query)\n        ->setMaxPerPage(isset($params['_per_page']) ? $params['_per_page'] : 10)\n        ->setCurrentPage(isset($params['_page']) ? $params['_page'] : 1);\n\n    $aggregations = $result->getAdapter()->getAggregations();\n    // Used to add a ['label']['en'] and ['label']['fr'] to provide a label to print in the front application for the filter value\n    foreach ($aggregations as &$aggregation) {\n        $this->postProcessAggregation($aggregation);\n    }\n\n\n    $currentPageResult = $result->getCurrentPageResults();\n    $this->cachedResults = $currentPageResult;\n    $this->cachedAggregations = $aggregations;\n}\n\n\npublic function clearCache()\n{\n    $this->cachedResults = [];\n    $this->cachedAggregations = [];\n}\n\npublic function hasCachedResult()\n{\n    return count($this->cachedResults) > 0;\n}\n\n\npublic function getResults()\n{\n    return count($this->cachedResults) > 0 ? $this->cachedResults : [];\n}\n\npublic function getAggregations()\n{\n    return count($this->cachedResults) > 0 ? $this->cachedAggregations : [];\n}\n\n}\n```\nI have one custom provider ElasticsearchCollectionDataProvider:\n```php\n<?php\nnamespace AppBundle\\DataProvider;\nuse ApiPlatform\\Core\\DataProvider\\CollectionDataProviderInterface;\nuse ApiPlatform\\Core\\DataProvider\\ItemDataProviderInterface;\nuse ApiPlatform\\Core\\Exception\\ResourceClassNotSupportedException;\nuse AppBundle\\Service\\SearcherService;\nuse Doctrine\\ORM\\EntityManager;\nuse Symfony\\Component\\HttpFoundation\\RequestStack;\nuse Symfony\\Component\\Security\\Core\\Authentication\\Token\\Storage\\TokenStorage;\nfinal class ElasticsearchCollectionDataProvider implements CollectionDataProviderInterface\n{\n    /*\n     * @var SearcherService\n     /\n    protected $searcher;\n/**\n * @var RequestStack\n */\nprotected $requestStack;\n\n/**\n * @param SearcherService $searcher\n * @param RequestStack $requestStack\n */\npublic function __construct(SearcherService $searcher, RequestStack $requestStack)\n{\n    $this->searcher = $searcher;\n    $this->requestStack = $requestStack;\n}\n\n\npublic function getCollection(string $resourceClass, string $operationName = null)\n{\n    // Add here all entities that's you want to query with ElasticSearch\n    if (!in_array($resourceClass, [Post::class, Agency::class, Organization::class])) {\n        throw new ResourceClassNotSupportedException();\n    }\n\n    $index = explode('\\\\', $resourceClass);\n    $index = strtolower(end($index));\n\n    $this->searcher->search($index);\n\n    return $this->searcher->getResults();\n}\n\n}\n```\nI have an ElasticsearchFilter:\n```php\n<?php\nnamespace AppBundle\\Filter;\nuse ApiPlatform\\Core\\Api\\FilterInterface;\nuse ApiPlatform\\Core\\Bridge\\Doctrine\\Orm\\Filter\\AbstractFilter;\nuse ApiPlatform\\Core\\Bridge\\Doctrine\\Orm\\Util\\QueryNameGeneratorInterface;\nuse AppBundle\\Service\\SearcherService;\nuse Doctrine\\Common\\Persistence\\ManagerRegistry;\nuse Elastica\\Multi\\Search;\nuse Symfony\\Component\\Config\\Resource\\ResourceInterface;\nuse Symfony\\Component\\HttpFoundation\\Request;\nuse Doctrine\\ORM\\QueryBuilder;\nuse Symfony\\Component\\HttpFoundation\\RequestStack;\nclass ElasticsearchFilter extends AbstractFilter\n{\n    /* @var SearcherService /\n    private $engine;\n/**\n * @param ManagerRegistry $managerRegistry\n * @param RequestStack $requestStack\n * @param SearcherService $engine\n */\n\npublic function __construct(ManagerRegistry $managerRegistry, RequestStack $requestStack, SearcherService $engine)\n{\n    parent::__construct($managerRegistry, $requestStack);\n    $this->engine = $engine;\n}\n\npublic function getDescription(string $resourceClass) : array\n{\n    // I override the description to add a buckets array key to put my aggregations\n    $description = [];\n    foreach ($this->engine->getAggregations() as $property => $aggregation) {\n        $description[$property] = [\n            \"property\" => $aggregation['property'],\n            \"required\" => false,\n            'buckets' => $aggregation['buckets'],\n        ];\n    }\n\n    return $description;\n}\n\n/**\n * Passes a property through the filter.\n *\n * @param string $property\n * @param mixed $value\n * @param QueryBuilder $queryBuilder\n * @param QueryNameGeneratorInterface $queryNameGenerator\n * @param string $resourceClass\n * @param string|null $operationName\n */\nprotected function filterProperty(string $property, $value, QueryBuilder $queryBuilder, QueryNameGeneratorInterface $queryNameGenerator, string $resourceClass, string $operationName = null)\n{}\n\n}\n```\nTo resume: I have a searcher, a custom filter and a custom provider. The searcher save results and aggregations in cached properties. I call the SearcherService#search() method in a custom Provider (because providers are called before filters) and I return the SearcherService#getResults method. In the custom Filter I override getDescription method to foreach over SearcherService#getAggregations() to add a buckets key in the description for each aggregation.\nI can't give you a complete example at this moment. I'm sorry to answer you just now but I'm really busy actually.\nIf you have any questions related to this post please let me know I will do my best to answer you quickly.\nHope this can help!\n. ",
    "karser": "@ksom Usually ElasticSearch is used as a map for your database records which you can lookup by ElasticSearch identifiers. So it might a trivial collection filter, see an example.\n. Actually, I was wanting to get your feedback first. I performed some benchmarks for client docker image.\nPrerequisites:\nI was using mhart/alpine-node:9.11.1 image because it's shipped with npm 5.8 which supports npm ci.\nI was launching cd client && time docker build --no-cache .\nVersions:\nnode v9.11.1, npm 5.8.0 yarn 1.5.1\nyarn install\n\n```\ntry1:\nDone in 15.63s.\n166.1M  ./node_modules\ntotal 42,240s\ntry2:\nDone in 15.53s.\n166.1M  ./node_modules\ntotal 40,294s\n```\nnpm install + npm ci\n\ntry1: \nadded 1339 packages in 10.664s\n220.1M  ./node_modules\ntotal 48,426s\ntry2:\nadded 1339 packages in 12.506s\n220.1M  ./node_modules\ntotal 49,153s\nyarn install + npm ci\n\nadded 1339 packages in 11.829s\n220.1M  ./node_modules\ntotal 34,639s\nConclusions:\nIt doesn't make sense to use purely npm with client docker image.\nCombination of yarn install for global packages and npm ci reduces the running time from 42 to 35 sec but the node_modules size surprisingly increased by 60 mb.\nyarn/npm performance varies from project to project, so only individual benchmarks can say which one is more suitable.\nOn my projects (angular based) npm ci demonstrated outstanding results. https://github.com/yarnpkg/yarn/issues/2088#issuecomment-376543672. ",
    "kbyjoel": "Unfortunately, it's not possible to add a \"buckets\" column in hydra mapping via a filter because the ApiPlatform\\Core\\Hydra\\Serializer\\CollectionFiltersNormalizer is restrictive (at least on api-platform version from 2.1 to 2.3) :\n```php\n    /\n     * Returns the content of the Hydra search property.\n     \n     * @param FilterInterface[] $filters\n     /\n    private function getSearch(string $resourceClass, array $parts, array $filters): array\n    {\n        $variables = [];\n        $mapping = [];\n        foreach ($filters as $filter) {\n            foreach ($filter->getDescription($resourceClass) as $variable => $data) {\n                $variables[] = $variable;\n                $mapping[] = [\n                    '@type' => 'IriTemplateMapping',\n                    'variable' => $variable,\n                    'property' => $data['property'],\n                    'required' => $data['required'],\n                ];\n            }\n        }\n    return [\n        '@type' => 'hydra:IriTemplate',\n        'hydra:template' => sprintf('%s{?%s}', $parts['path'], implode(',', $variables)),\n        'hydra:variableRepresentation' => 'BasicRepresentation',\n        'hydra:mapping' => $mapping,\n    ];\n}\n\n```\nCurrently, the only way to achieve the aggregation normalization, is to put this information in the property column of the description of your custom filter. Perhaps it would be fine to authorize the extension of hydra mapping information via CustomFilters to make work what @ksom wrote last year.\nThe method getSearch of ApiPlatform\\Core\\Hydra\\Serializer\\CollectionFiltersNormalizer could be something like this:\n```php\n    /\n     * Returns the content of the Hydra search property.\n     \n     * @param FilterInterface[] $filters\n     /\n    private function getSearch(string $resourceClass, array $parts, array $filters): array\n    {\n        $variables = [];\n        $mapping = [];\n        foreach ($filters as $filter) {\n            foreach ($filter->getDescription($resourceClass) as $variable => $data) {\n                $variables[] = $variable;\n                $propertyMapping = ['@type' => 'IriTemplateMapping', 'variable' => $variable];\n                foreach ($data as $additionnalKey => $additionnalValue) {\n                    if ($additionnalKey != '@type' && $additionnalKey != 'variable') {\n                        $propertyMapping[$additionnalKey] = $additionnalValue;\n                    }\n                }\n                $mapping[] = $propertyMapping;\n            }\n        }\n    return [\n        '@type' => 'hydra:IriTemplate',\n        'hydra:template' => sprintf('%s{?%s}', $parts['path'], implode(',', $variables)),\n        'hydra:variableRepresentation' => 'BasicRepresentation',\n        'hydra:mapping' => $mapping,\n    ];\n}\n\n```\nWhat do you think about it ?\n. ",
    "ad3n": "@dunglas : :+1: ok i will waiting to merge\n. @Simperfit : Thanks for your reply,\nI have a collection, imagine an enum with data (A, B, C), in my case, i save that enum in parameters and want to expose that use an api endpoint.\nHow to handle it using Api Platform?\nSorry for my bad english and i hope you can understand about my question :-). @dunglas n @Simperfit : :+1: thank you so much... it work properly :+1: api platform is very awesome. Thanks for you response.\n```\n<?php\nnamespace AppBundle\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse AppBundle\\Product\\HasProductInterface;\nuse AppBundle\\Product\\ProductInterface;\nuse AppBundle\\ShoppingCart\\ShoppingCartInterface;\nuse AppBundle\\ShoppingCart\\ShoppingCartItemInterface;\nuse AppBundle\\Util\\StringUtil;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Knp\\DoctrineBehaviors\\Model\\Timestampable\\Timestampable;\nuse Symfony\\Component\\Serializer\\Annotation\\Groups;\n/\n * @ORM\\Entity()\n * @ORM\\Table(name=\"shoppingcart_items\")\n \n * @ApiResource()\n \n * @author Muhammad Surya Ihsanuddin surya.kejawen@gmail.com\n */\nclass ShoppingCartItem implements ShoppingCartItemInterface, HasProductInterface\n{\n    use Timestampable;\n/**\n * @var int\n *\n * @ORM\\Id\n * @ORM\\GeneratedValue\n * @ORM\\Column(type=\"integer\")\n */\nprivate $id;\n\n/**\n * @var ShoppingCartInterface\n *\n * @ORM\\ManyToOne(targetEntity=\"AppBundle\\Entity\\ShoppingCart\")\n * @ORM\\JoinColumn(name=\"shoppingcart_id\", referencedColumnName=\"id\")\n */\nprivate $owner;\n\n/**\n * @var int\n *\n * @ORM\\Column(type=\"integer\")\n */\nprivate $productId;\n\n/**\n * @var string\n *\n * @ORM\\Column(type=\"string\")\n */\nprivate $productSource;\n\n/**\n * @var int\n *\n * @ORM\\Column(type=\"integer\")\n */\nprivate $quantity;\n\n/**\n * @var array\n *\n * @ORM\\Column(type=\"array\")\n */\nprivate $metadata;\n\n/**\n * @var ProductInterface\n */\nprivate $product;\n\n}\n```\nThat is my entity, i have $productId to store the product id and $productSource to store the product source (product class name in my case). Then when i load the entity by adding postLoad subscriber, $product is filled by the real product from $productId and $productSource and that is work fine for me.\nBut i have problem, when i use api platform to serialize the object, i get an error \"No resource found for object of type AppBundle\\Entity\\Diamond\" (example). When i open /diamonds/1 (example), my product is exist, but when i try do like that, i got error.\nCan you understand my explaination? Because my english is bad. I hope you can understand.. @teohhanhui : I read the source and i confuse how to put an entity in to the test. But, if you want to test, may you can add an property without any doctrine annotation (not managed by doctrine) but the object is related to object that managed by doctrine.\nLike OneToMany without any annotation on that. Example:\n/**\n     * @var ShoppingCartInterface\n     *\n     * @ORM\\ManyToOne(targetEntity=\"AppBundle\\Entity\\ShoppingCart\")\n     * @ORM\\JoinColumn(name=\"shoppingcart_id\", referencedColumnName=\"id\")\n     */\n    private $owner;\nYou may can add in somewhere\nprivate $items;\nwithout any annotation on it. Then you can use event subscriber especially onPostLoad to set $items objects depending on $owner property.\nThe problem is, Api Platform only handling property that have metadata (handled or managed by doctrine)\nThe error come from https://github.com/api-platform/core/blob/v2.0.1/src/Api/ResourceClassResolver.php#L57\nBut i will try to update, i see new release 3 days ago. {\n  \"@context\": \"/contexts/Error\",\n  \"@type\": \"Error\",\n  \"hydra:title\": \"An error occurred\",\n  \"hydra:description\": \"No resource class found for object of type \\\"AppBundle\\\\Entity\\\\Diamond\\\"\",\n  \"trace\": [\n    {\n      \"namespace\": \"\",\n      \"short_class\": \"\",\n      \"class\": \"\",\n      \"type\": \"\",\n      \"function\": \"\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/vendor/api-platform/core/src/Api/ResourceClassResolver.php\",\n      \"line\": 57,\n      \"args\": []\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Api\",\n      \"short_class\": \"ResourceClassResolver\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Api\\\\ResourceClassResolver\",\n      \"type\": \"->\",\n      \"function\": \"getResourceClass\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/vendor/api-platform/core/src/JsonLd/Serializer/ItemNormalizer.php\",\n      \"line\": 63,\n      \"args\": [\n        [\n          \"object\",\n          \"AppBundle\\\\Entity\\\\Diamond\"\n        ],\n        [\n          \"string\",\n          \"AppBundle\\\\Entity\\\\ShoppingCartItem\"\n        ],\n        [\n          \"boolean\",\n          true\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\JsonLd\\\\Serializer\",\n      \"short_class\": \"ItemNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\JsonLd\\\\Serializer\\\\ItemNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/vendor/symfony/symfony/src/Symfony/Component/Serializer/Serializer.php\",\n      \"line\": 142,\n      \"args\": [\n        [\n          \"object\",\n          \"AppBundle\\\\Entity\\\\Diamond\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"item_operation_name\": [\n              \"string\",\n              \"get\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"AppBundle\\\\Entity\\\\ShoppingCartItem\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/shopping_cart_items/1\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"string\",\n              \"095a5b3bd6eba7a8a839283a4b8b5110\"\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"0000000068f11d36000000002a3a346b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\",\n      \"short_class\": \"Serializer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Serializer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/vendor/api-platform/core/src/Serializer/AbstractItemNormalizer.php\",\n      \"line\": 401,\n      \"args\": [\n        [\n          \"object\",\n          \"AppBundle\\\\Entity\\\\Diamond\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"item_operation_name\": [\n              \"string\",\n              \"get\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"AppBundle\\\\Entity\\\\ShoppingCartItem\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/shopping_cart_items/1\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"string\",\n              \"095a5b3bd6eba7a8a839283a4b8b5110\"\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"0000000068f11d36000000002a3a346b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Serializer\",\n      \"short_class\": \"AbstractItemNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Serializer\\\\AbstractItemNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"getAttributeValue\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/vendor/symfony/symfony/src/Symfony/Component/Serializer/Normalizer/AbstractObjectNormalizer.php\",\n      \"line\": 78,\n      \"args\": [\n        [\n          \"object\",\n          \"AppBundle\\\\Entity\\\\ShoppingCartItem\"\n        ],\n        [\n          \"string\",\n          \"product\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"item_operation_name\": [\n              \"string\",\n              \"get\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"AppBundle\\\\Entity\\\\ShoppingCartItem\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/shopping_cart_items/1\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"string\",\n              \"095a5b3bd6eba7a8a839283a4b8b5110\"\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"0000000068f11d36000000002a3a346b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\\\\Normalizer\",\n      \"short_class\": \"AbstractObjectNormalizer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Normalizer\\\\AbstractObjectNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/vendor/api-platform/core/src/Serializer/AbstractItemNormalizer.php\",\n      \"line\": 85,\n      \"args\": [\n        [\n          \"object\",\n          \"AppBundle\\\\Entity\\\\ShoppingCartItem\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"item_operation_name\": [\n              \"string\",\n              \"get\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"AppBundle\\\\Entity\\\\ShoppingCartItem\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/shopping_cart_items/1\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"string\",\n              \"095a5b3bd6eba7a8a839283a4b8b5110\"\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"0000000068f11d36000000002a3a346b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Serializer\",\n      \"short_class\": \"AbstractItemNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Serializer\\\\AbstractItemNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/vendor/api-platform/core/src/JsonLd/Serializer/ItemNormalizer.php\",\n      \"line\": 67,\n      \"args\": [\n        [\n          \"object\",\n          \"AppBundle\\\\Entity\\\\ShoppingCartItem\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"item_operation_name\": [\n              \"string\",\n              \"get\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"AppBundle\\\\Entity\\\\ShoppingCartItem\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/shopping_cart_items/1\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\JsonLd\\\\Serializer\",\n      \"short_class\": \"ItemNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\JsonLd\\\\Serializer\\\\ItemNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/vendor/symfony/symfony/src/Symfony/Component/Serializer/Serializer.php\",\n      \"line\": 142,\n      \"args\": [\n        [\n          \"object\",\n          \"AppBundle\\\\Entity\\\\ShoppingCartItem\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"item_operation_name\": [\n              \"string\",\n              \"get\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"AppBundle\\\\Entity\\\\ShoppingCartItem\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/shopping_cart_items/1\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\",\n      \"short_class\": \"Serializer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Serializer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/vendor/symfony/symfony/src/Symfony/Component/Serializer/Serializer.php\",\n      \"line\": 115,\n      \"args\": [\n        [\n          \"object\",\n          \"AppBundle\\\\Entity\\\\ShoppingCartItem\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"item_operation_name\": [\n              \"string\",\n              \"get\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"AppBundle\\\\Entity\\\\ShoppingCartItem\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/shopping_cart_items/1\"\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\",\n      \"short_class\": \"Serializer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Serializer\",\n      \"type\": \"->\",\n      \"function\": \"serialize\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/vendor/api-platform/core/src/EventListener/SerializeListener.php\",\n      \"line\": 64,\n      \"args\": [\n        [\n          \"object\",\n          \"AppBundle\\\\Entity\\\\ShoppingCartItem\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"item_operation_name\": [\n              \"string\",\n              \"get\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"AppBundle\\\\Entity\\\\ShoppingCartItem\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/shopping_cart_items/1\"\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\EventListener\",\n      \"short_class\": \"SerializeListener\",\n      \"class\": \"ApiPlatform\\\\Core\\\\EventListener\\\\SerializeListener\",\n      \"type\": \"->\",\n      \"function\": \"onKernelView\",\n      \"file\": null,\n      \"line\": null,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"\n        ],\n        [\n          \"string\",\n          \"kernel.view\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Debug\\\\TraceableEventDispatcher\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"\",\n      \"short_class\": \"\",\n      \"class\": \"\",\n      \"type\": \"\",\n      \"function\": \"call_user_func\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/vendor/symfony/symfony/src/Symfony/Component/EventDispatcher/Debug/WrappedListener.php\",\n      \"line\": 106,\n      \"args\": [\n        [\n          \"array\",\n          [\n            [\n              \"object\",\n              \"ApiPlatform\\\\Core\\\\EventListener\\\\SerializeListener\"\n            ],\n            [\n              \"string\",\n              \"onKernelView\"\n            ]\n          ]\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"\n        ],\n        [\n          \"string\",\n          \"kernel.view\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Debug\\\\TraceableEventDispatcher\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\",\n      \"short_class\": \"WrappedListener\",\n      \"class\": \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\",\n      \"type\": \"->\",\n      \"function\": \"__invoke\",\n      \"file\": null,\n      \"line\": null,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"\n        ],\n        [\n          \"string\",\n          \"kernel.view\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\EventDispatcher\\\\ContainerAwareEventDispatcher\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"\",\n      \"short_class\": \"\",\n      \"class\": \"\",\n      \"type\": \"\",\n      \"function\": \"call_user_func\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/var/cache/dev/classes.php\",\n      \"line\": 3240,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"\n        ],\n        [\n          \"string\",\n          \"kernel.view\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\EventDispatcher\\\\ContainerAwareEventDispatcher\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\EventDispatcher\",\n      \"short_class\": \"EventDispatcher\",\n      \"class\": \"Symfony\\\\Component\\\\EventDispatcher\\\\EventDispatcher\",\n      \"type\": \"->\",\n      \"function\": \"doDispatch\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/var/cache/dev/classes.php\",\n      \"line\": 3155,\n      \"args\": [\n        [\n          \"array\",\n          [\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"array\",\n              [\n                [\n                  \"object\",\n                  \"ApiPlatform\\\\Core\\\\Bridge\\\\Symfony\\\\Validator\\\\EventListener\\\\ValidateListener\"\n                ],\n                [\n                  \"string\",\n                  \"onKernelView\"\n                ]\n              ]\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ]\n          ]\n        ],\n        [\n          \"string\",\n          \"kernel.view\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\EventDispatcher\",\n      \"short_class\": \"EventDispatcher\",\n      \"class\": \"Symfony\\\\Component\\\\EventDispatcher\\\\EventDispatcher\",\n      \"type\": \"->\",\n      \"function\": \"dispatch\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/vendor/symfony/symfony/src/Symfony/Component/EventDispatcher/Debug/TraceableEventDispatcher.php\",\n      \"line\": 136,\n      \"args\": [\n        [\n          \"string\",\n          \"kernel.view\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\",\n      \"short_class\": \"TraceableEventDispatcher\",\n      \"class\": \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\TraceableEventDispatcher\",\n      \"type\": \"->\",\n      \"function\": \"dispatch\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/var/cache/dev/classes.php\",\n      \"line\": 4903,\n      \"args\": [\n        [\n          \"string\",\n          \"kernel.view\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\HttpKernel\",\n      \"short_class\": \"HttpKernel\",\n      \"class\": \"Symfony\\\\Component\\\\HttpKernel\\\\HttpKernel\",\n      \"type\": \"->\",\n      \"function\": \"handleRaw\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/var/cache/dev/classes.php\",\n      \"line\": 4855,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpFoundation\\\\Request\"\n        ],\n        [\n          \"integer\",\n          1\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\HttpKernel\",\n      \"short_class\": \"HttpKernel\",\n      \"class\": \"Symfony\\\\Component\\\\HttpKernel\\\\HttpKernel\",\n      \"type\": \"->\",\n      \"function\": \"handle\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/vendor/symfony/symfony/src/Symfony/Component/HttpKernel/Kernel.php\",\n      \"line\": 168,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpFoundation\\\\Request\"\n        ],\n        [\n          \"integer\",\n          1\n        ],\n        [\n          \"boolean\",\n          true\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\HttpKernel\",\n      \"short_class\": \"Kernel\",\n      \"class\": \"Symfony\\\\Component\\\\HttpKernel\\\\Kernel\",\n      \"type\": \"->\",\n      \"function\": \"handle\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/web/app_dev.php\",\n      \"line\": 33,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpFoundation\\\\Request\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"\",\n      \"short_class\": \"\",\n      \"class\": \"\",\n      \"type\": \"\",\n      \"function\": \"require\",\n      \"file\": \"/home/aden/Project/Orori/ApiPlatform/vendor/symfony/symfony/src/Symfony/Bundle/FrameworkBundle/Resources/config/router_dev.php\",\n      \"line\": 40,\n      \"args\": [\n        [\n          \"string\",\n          \"/home/aden/Project/Orori/ApiPlatform/web/app_dev.php\"\n        ]\n      ]\n    }\n  ]\n}\n```\n<?php\nnamespace AppBundle\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse AppBundle\\ActionLogger\\ActionLoggable;\nuse AppBundle\\Asset\\OwnerableInterface;\nuse AppBundle\\Asset\\AssetInterface;\nuse AppBundle\\Certificate\\CertificateInterface;\nuse AppBundle\\Model\\SupplierInterface;\nuse AppBundle\\Price\\PricableInterface;\nuse AppBundle\\Price\\PriceLogInterface;\nuse AppBundle\\Product\\DiamondInterface;\nuse AppBundle\\ShoppingCart\\ItemInterface as ShoppingCartItemInterface;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Knp\\DoctrineBehaviors\\Model\\Timestampable\\Timestampable;\n/\n * @ORM\\Entity()\n * @ORM\\Table(name=\"diamonds\")\n \n * @ApiResource()\n \n * @author Muhammad Surya Ihsanuddin surya.kejawen@gmail.com\n */\nclass Diamond implements DiamondInterface, OwnerableInterface, PricableInterface, ShoppingCartItemInterface\n{\n    use Timestampable;\n    use ActionLoggable;\n/**\n * @var int\n *\n * @ORM\\Id\n * @ORM\\GeneratedValue\n * @ORM\\Column(type=\"integer\")\n */\nprivate $id;\n\n/**\n * @var SupplierInterface\n *\n * @ORM\\ManyToOne(targetEntity=\"AppBundle\\Entity\\Supplier\")\n * @ORM\\JoinColumn(name=\"supplier_id\", referencedColumnName=\"id\")\n */\nprivate $supplier;\n\n/**\n * @var string\n *\n * @ORM\\Column(type=\"string\")\n */\nprivate $supplierCode;\n\n/**\n * @var string\n *\n * @ORM\\Column(type=\"string\")\n */\nprivate $code;\n\n/**\n * @var string\n *\n * @ORM\\Column(type=\"string\")\n */\nprivate $sku;\n\n/**\n * @var string\n *\n * @ORM\\Column(type=\"string\")\n */\nprivate $name;\n\n/**\n * @var string\n *\n * @ORM\\Column(type=\"string\")\n */\nprivate $alternateName;\n\n/**\n * @var string\n *\n * @ORM\\Column(type=\"string\")\n */\nprivate $description;\n\n/**\n * @var float\n *\n * @ORM\\Column(type=\"float\")\n */\nprivate $carat;\n\n/**\n * @var float\n *\n * @ORM\\Column(type=\"float\")\n */\nprivate $depth;\n\n/**\n * @var float\n *\n * @ORM\\Column(type=\"float\")\n */\nprivate $diamondTable;\n\n/**\n * @var string\n *\n * @ORM\\Column(type=\"string\")\n */\nprivate $shape;\n\n/**\n * @var string\n *\n * @ORM\\Column(type=\"string\")\n */\nprivate $color;\n\n/**\n * @var string\n *\n * @ORM\\Column(type=\"string\")\n */\nprivate $clarity;\n\n/**\n * @var string\n *\n * @ORM\\Column(type=\"string\")\n */\nprivate $fluorescence;\n\n/**\n * @var string\n *\n * @ORM\\Column(type=\"string\")\n */\nprivate $cut;\n\n/**\n * @var string\n *\n * @ORM\\Column(type=\"string\")\n */\nprivate $polish;\n\n/**\n * @var string\n *\n * @ORM\\Column(type=\"string\")\n */\nprivate $symmetry;\n\n/**\n * @var CertificateInterface\n *\n * @ORM\\ManyToOne(targetEntity=\"AppBundle\\Entity\\Certificate\")\n * @ORM\\JoinColumn(name=\"certificate_id\", referencedColumnName=\"id\")\n */\nprivate $certificate;\n\n/**\n * @var float\n *\n * @ORM\\Column(type=\"float\")\n */\nprivate $basePrice;\n\n/**\n * @var int\n *\n * @ORM\\Column(type=\"integer\")\n */\nprivate $markupMargin;\n\n/**\n * @var float\n *\n * @ORM\\Column(type=\"float\")\n */\nprivate $markupPrice;\n\n/**\n * @var int\n *\n * @ORM\\Column(type=\"integer\")\n */\nprivate $profitMargin;\n\n/**\n * @var float\n *\n * @ORM\\Column(type=\"float\")\n */\nprivate $price;\n\n/**\n * @var float\n *\n * @ORM\\Column(type=\"float\")\n */\nprivate $tax;\n\n/**\n * @var string\n *\n * @ORM\\Column(type=\"string\")\n */\nprivate $priceServiceId;\n\n/**\n * @var int\n *\n * @ORM\\Column(type=\"integer\")\n */\nprivate $quantity;\n\n/**\n * @var bool\n *\n * @ORM\\Column(type=\"boolean\")\n */\nprivate $isShow;\n\n/**\n * @var bool\n *\n * @ORM\\Column(type=\"boolean\")\n */\nprivate $isSellable;\n\n/**\n * @var AssetInterface[]\n */\nprivate $files;\n\n/**\n * @var PriceLogInterface[]\n */\nprivate $priceLogs;\n\npublic function __construct()\n{\n    $this->isShow = true;\n    $this->isSellable = true;\n    $this->price = 0;\n    $this->tax = 0;\n    $this->markupPrice = 0;\n    $this->markupMargin = 0;\n    $this->files = [];\n    $this->priceLogs = [];\n}\n\n/**\n * @return int\n */\npublic function getId(): int\n{\n    return $this->id;\n}\n\n/**\n * @return SupplierInterface\n */\npublic function getSupplier(): SupplierInterface\n{\n    return $this->supplier;\n}\n\n/**\n * @param SupplierInterface $supplier\n */\npublic function setSupplier(SupplierInterface $supplier)\n{\n    $this->supplier = $supplier;\n}\n\n/**\n * @return string\n */\npublic function getSupplierCode(): string\n{\n    return $this->supplierCode;\n}\n\n/**\n * @param string $supplierCode\n */\npublic function setSupplierCode(string $supplierCode)\n{\n    $this->supplierCode = $supplierCode;\n}\n\n/**\n * @return string\n */\npublic function getCode(): string\n{\n    return $this->code;\n}\n\n/**\n * @param string $code\n */\npublic function setCode(string $code)\n{\n    $this->code = $code;\n}\n\n/**\n * @return string\n */\npublic function getSku(): string\n{\n    return $this->sku;\n}\n\n/**\n * @param string $sku\n */\npublic function setSku(string $sku)\n{\n    $this->sku = $sku;\n}\n\n/**\n * @return string\n */\npublic function getName(): string\n{\n    return $this->name;\n}\n\n/**\n * @param string $name\n */\npublic function setName(string $name)\n{\n    $this->name = $name;\n}\n\n/**\n * @return string\n */\npublic function getAlternateName(): string\n{\n    return $this->alternateName;\n}\n\n/**\n * @param string $alternateName\n */\npublic function setAlternateName(string $alternateName)\n{\n    $this->alternateName = $alternateName;\n}\n\n/**\n * @return string\n */\npublic function getDescription(): string\n{\n    return $this->description;\n}\n\n/**\n * @param string $description\n */\npublic function setDescription(string $description)\n{\n    $this->description = $description;\n}\n\n/**\n * @return float\n */\npublic function getCarat(): float\n{\n    return $this->carat;\n}\n\n/**\n * @param float $carat\n */\npublic function setCarat(float $carat)\n{\n    $this->carat = $carat;\n}\n\n/**\n * @return float\n */\npublic function getDepth(): float\n{\n    return $this->depth;\n}\n\n/**\n * @param float $depth\n */\npublic function setDepth(float $depth)\n{\n    $this->depth = $depth;\n}\n\n/**\n * @return float\n */\npublic function getDiamondTable(): float\n{\n    return $this->diamondTable;\n}\n\n/**\n * @param float $diamondTable\n */\npublic function setDiamondTable(float $diamondTable)\n{\n    $this->diamondTable = $diamondTable;\n}\n\n/**\n * @return string\n */\npublic function getShape(): string\n{\n    return $this->shape;\n}\n\n/**\n * @param string $shape\n */\npublic function setShape(string $shape)\n{\n    $this->shape = $shape;\n}\n\n/**\n * @return string\n */\npublic function getColor(): string\n{\n    return $this->color;\n}\n\n/**\n * @param string $color\n */\npublic function setColor(string $color)\n{\n    $this->color = $color;\n}\n\n/**\n * @return string\n */\npublic function getClarity(): string\n{\n    return $this->clarity;\n}\n\n/**\n * @param string $clarity\n */\npublic function setClarity(string $clarity)\n{\n    $this->clarity = $clarity;\n}\n\n/**\n * @return string\n */\npublic function getFluorescence(): string\n{\n    return $this->fluorescence;\n}\n\n/**\n * @param string $fluorescence\n */\npublic function setFluorescence(string $fluorescence)\n{\n    $this->fluorescence = $fluorescence;\n}\n\n/**\n * @return string\n */\npublic function getCut(): string\n{\n    return $this->cut;\n}\n\n/**\n * @param string $cut\n */\npublic function setCut(string $cut)\n{\n    $this->cut = $cut;\n}\n\n/**\n * @return string\n */\npublic function getPolish(): string\n{\n    return $this->polish;\n}\n\n/**\n * @param string $polish\n */\npublic function setPolish(string $polish)\n{\n    $this->polish = $polish;\n}\n\n/**\n * @return string\n */\npublic function getSymmetry(): string\n{\n    return $this->symmetry;\n}\n\n/**\n * @param string $symmetry\n */\npublic function setSymmetry(string $symmetry)\n{\n    $this->symmetry = $symmetry;\n}\n\n/**\n * @return CertificateInterface|null\n */\npublic function getCertificate()\n{\n    return $this->certificate;\n}\n\n/**\n * @param CertificateInterface $certificate\n */\npublic function setCertificate(CertificateInterface $certificate)\n{\n    $this->certificate = $certificate;\n}\n\n/**\n * @return int\n */\npublic function getProfitMargin(): int\n{\n    return $this->profitMargin;\n}\n\n/**\n * @param int $profitMargin\n */\npublic function setProfitMargin(int $profitMargin)\n{\n    $this->profitMargin = $profitMargin;\n}\n\n/**\n * @return float\n */\npublic function getBasePrice(): float\n{\n    return $this->basePrice;\n}\n\n/**\n * @param float $basePrice\n */\npublic function setBasePrice(float $basePrice)\n{\n    $this->basePrice = $basePrice;\n}\n\n/**\n * @return int\n */\npublic function getMarkupMargin(): int\n{\n    return $this->markupMargin;\n}\n\n/**\n * @param int $markupMargin\n */\npublic function setMarkupMargin(int $markupMargin)\n{\n    $this->markupMargin = $markupMargin;\n}\n\n/**\n * @return float\n */\npublic function getMarkupPrice(): float\n{\n    return $this->markupPrice;\n}\n\n/**\n * @param float $markupPrice\n */\npublic function setMarkupPrice(float $markupPrice)\n{\n    $this->markupPrice = $markupPrice;\n}\n\n/**\n * @return float\n */\npublic function getPrice(): float\n{\n    return $this->price;\n}\n\n/**\n * @param float $price\n */\npublic function setPrice(float $price)\n{\n    $this->price = $price;\n}\n\n/**\n * @return float\n */\npublic function getTax(): float\n{\n    return $this->tax;\n}\n\n/**\n * @param float $tax\n */\npublic function setTax(float $tax)\n{\n    $this->tax = $tax;\n}\n\n/**\n * @return string\n */\npublic function getPriceCalculatorServiceId(): string\n{\n    return $this->priceServiceId;\n}\n\n/**\n * @param string $serviceId\n */\npublic function setPriceCalculatorServiceId(string $serviceId)\n{\n    $this->priceServiceId = $serviceId;\n}\n\n/**\n * @return int\n */\npublic function getQuantity(): int\n{\n    return $this->quantity;\n}\n\n/**\n * @param int $quantity\n */\npublic function setQuantity(int $quantity)\n{\n    $this->quantity = $quantity;\n}\n\n/**\n * @return bool\n */\npublic function isShow(): bool\n{\n    return $this->isShow;\n}\n\n/**\n * @param bool $isShow\n */\npublic function setShow(bool $isShow)\n{\n    $this->isShow = $isShow;\n}\n\n/**\n * @return bool\n */\npublic function isSellable(): bool\n{\n    return $this->isSellable && $this->isShow && (0 < $this->quantity);\n}\n\n/**\n * @param bool $isSellable\n */\npublic function setSellable(bool $isSellable)\n{\n    $this->isSellable = $isSellable;\n}\n\n/**\n * @param AssetInterface $resource\n */\npublic function addFile(AssetInterface $resource)\n{\n    $this->files[] = $resource;\n}\n\n/**\n * @param AssetInterface[] $files\n */\npublic function setFiles(array $files)\n{\n    foreach ($files as $file) {\n        $this->addFile($file);\n    }\n}\n\n/**\n * @return AssetInterface[]\n */\npublic function getFiles(): array\n{\n    return $this->files ?: [];\n}\n\n/**\n * @param PriceLogInterface $priceLog\n */\npublic function addPriceHistory(PriceLogInterface $priceLog)\n{\n    $this->priceLogs[] = $priceLog;\n}\n\n/**\n * @param PriceLogInterface[] $priceLogs\n */\npublic function setPriceHistories(array $priceLogs)\n{\n    foreach ($priceLogs as $priceLog) {\n        $this->addPriceHistory($priceLog);\n    }\n}\n\n/**\n * @return PriceLogInterface[]\n */\npublic function getPriceHistories(): array\n{\n    return $this->priceLogs ?: [];\n}\n\n}\n``. That is the error and theDiamond` entity. @teohhanhui : hi, you can try \nhttps://github.com/ad3n/ApiPlatformTest\nto check\nI use \n@ApiResource(attributes={\n *     \"normalization_context\"={\"groups\"={\"read\"}}\n * }) \nto ignore that error but it is not solution that i want, because the object is already mapped by api platform.\nYou can check entity ShoppingCart, ShoppingCartItem and Transaction. @dunglas : Sorry i mentioning you. Just want to confirm, that data i provide is enough to you to tracing my error or you need more information to tracing?. @dunglas : :+1: Thank you very much. @Simperfit : The problem is coming from my connection pool... I use multiple connection through Api Platform and that is problem when use different entity manager to manage entity between read and write.... @dunglas : Do you use getManagerForClass (ManagerRegistry) in every where? It is possible to change that to EntityManager object for more flexibility?\nThen you add configurations to separate that depending on action that called. I read the @doctrine service and i am not really, that is a good choice to create my own manager registry. There is have many parameter to construct.\n```\n    public function __construct(ContainerInterface $container, array $connections, array $entityManagers, $defaultConnection, $defaultEntityManager)\n    {\n        $this->setContainer($container);\n    parent::__construct('ORM', $connections, $entityManagers, $defaultConnection, $defaultEntityManager, 'Doctrine\\ORM\\Proxy\\Proxy');\n}\n\n``. @dunglas : :+1: ok i will try. Thanks for your suggestion. @dunglas : sorry, i have more question. When i usegetManagerForClass`, i can not detect the action W/R. Do you have a clue how to determine the action?\nThanks before. @dunglas : ah sorry for my stupid stuff. You are right. Ok it work perfectly. Thank you very much. ",
    "CecileAmrl": "Yes but that's not intuitive. \n. ",
    "jockos": "ping @dunglas\n. @teohhanhui I've made some changes according to your comments.\n. @dunglas Travis failed because of a port already in use... but it works fine when I test it locally.. > The docker-compose volume for nginx should be a volume_from referencing the php image\nI don't think we should use volumes_from, it is now deprecated in docker-compose file V3.. @soyuka @teohhanhui Can you check the changes I have made ?. @teohhanhui I have made some changes according to your review, can you check again ? :). Ping @teohhanhui :). @teohhanhui LGTM, I've tested your modifications on Mac, Windows and Linux :). I have already updated the way we install composer in PR #162 :)\n. @soyuka look here for the /srv part.. Can you check the line-ending of your .sh files ? They need to be set to LF.\n. Can you tell me where ? \nBecause I can not find where it is installed, tried to run the config without that line and it is not working.\n. I agree but what do you suggest to do instead ? Copying folder by folder seems a bit redundant...\nMaybe we can only copy the application files and folder and exclude the tests & docker folders.\n. Would it be interesting to mount a volume in /var/log/nginx to get the logs from nginx ?\n. Ok thank you :)\nDo we need to add features, test and small files like README, composer.lock in the container ?\nIf it is for production it doesn't seems necessary to me if we want very light container.\n. Well, in that case it's not necessary ^^' so I removed it in my last commit :)\n. We use it in the parameter.yml for the database_host.\n. Php is used in the nginx config file line 12 (fastcgi_pass php:9000;)\n. Ok that's good to know, I wasn't aware of that, thanks. :)\n. Setfacl sends \"Operation not supported\" and I think that it is because docker uses AUFS and it doesn't support setfacl.\nBut this is working : \nusermod -u 1000 www-data\nchown -R www-data:www-data /var/www/app/cache\nchown -R www-data:www-data /var/www/app/logsr\nWhat do you think ?\n. And I need to add this :\nRUN chmod +x /start.sh\nRUN chmod +x /update-acl.sh\nOtherwise those files aren't executable when I run docker-compose up.\n. @teohhanhui what do you mean by \"made into volumes\" ?\nDo you want a volume container or just the Volume instruction in the Dockerfile ? . @teohhanhui I think I misunderstood the use of the VOLUME instruction...\nI tried to replace COPY by VOLUME but it's not working.\nWhat's the goal of doing that ?. I tried setfacl but it's not handled (as I said in a previous comment) so that's why I used this instead. \nPlease feel free to tell me if you have a better approach :). So what should we do about it ?. Yes, from Symfony official page\n. What do you mean ?. ",
    "Lctrs": "To help solving permissions hell once and for all, Have you read this blog post : https://medium.com/@rawkode/avoiding-docker-compose-entry-points-with-volume-driver-options-f2b30c051ead ?\nI used this for my dev environment and I never had a permission problem anymore (on Linux, haven't tested it on Mac or Windows).\nFor the record, here are my docker-compose.yml and my Dockerfile for a dev environment for a project that does NOT include ApiPlatform.\ndocker-compose.yml : \n```yaml\nversion: \"2\"\nvolumes:\n    cache:\n        driver: local\n        driver_opts:\n            type: tmpfs\n            device: tmpfs\n            o: uid=33\n    logs:\n        driver: local\n        driver_opts:\n            type: tmpfs\n            device: tmpfs\n            o: uid=33\n    sessions:\n        driver: local\n        driver_opts:\n            type: tmpfs\n            device: tmpfs\n            o: uid=33\nservices:\n    web:\n        build: ./docker/web\n        environment:\n            DNSDOCK_ALIAS: www.myproject.dev\n            SYMFONY_ENV: dev\n        depends_on:\n            - db\n        volumes:\n            - .:/srv/app\n            - cache:/srv/app/var/cache\n            - logs:/srv/app/var/logs\n            - sessions:/srv/app/var/sessions\ndb:\n    image: postgres:9.4\n    environment:\n        POSTGRES_PASSWORD: myproject\n        POSTGRES_USER: myproject\n        POSTGRES_DB: myproject\n\n```\nDockerfile (located in docker/web) :\n ```Dockerfile\nFROM php:7.1-apache\nPHP extensions\nENV APCU_VERSION 5.1.7\nRUN buildDeps=\" \\\n        libicu-dev \\\n        libpq-dev \\\n    \" \\\n    && apt-get update \\\n    && apt-get install -y --no-install-recommends \\\n        $buildDeps \\\n        libicu52 \\\n        libpq5 \\\n    && rm -rf /var/lib/apt/lists/* \\\n    && docker-php-ext-install -j$(nproc) \\\n        intl \\\n        pdo_pgsql \\\n    && pecl install \\\n        apcu-$APCU_VERSION \\\n    && docker-php-ext-enable --ini-name 05-opcache.ini \\\n        opcache \\\n    && docker-php-ext-enable --ini-name 20-apcu.ini \\\n        apcu \\\n    && apt-get purge -y --auto-remove $buildDeps\nApache & PHP configuration\nRUN a2enmod rewrite\nCOPY apache/vhost.conf /etc/apache2/sites-enabled/000-default.conf\nCOPY php/php.ini /usr/local/etc/php/php.ini\nWORKDIR /srv/app\n```\n(Also, there is no need to install mbstring extension since it's included in the parent image for a while now. See https://github.com/docker-library/php/blob/9abc1efe542b56aa93835e4987d5d4a88171b232/7.1/fpm/alpine/Dockerfile#L113). @dunglas Done.. Rebased.. @teohhanhui Done. And tests are green. :). I guess you also need to install php7.2-xml.. cc @teohhanhui . Failure not related.. I proposed a PR to bring this back if wanted. See https://github.com/dunglas/api-platform/pull/1.. Container size can be reduced by moving postgresql-dev to build-deps and replacing it by libpq in persistent-deps.. Why not bumping it to alpine:3.6 ?. openssl is now installed as persistent deps in parent image. So this can be removed.. They're only cosmetic, to clearly differentiate the different parts of the process.. Before, we specified both runtime and build deps manually.\nWith this method, runtime deps are detected automatically. This ensures we don't left any packages that are not necessary to runtime in the images. It's also possibly strip down a little the final container size.\nAlso, it ensures we don't screw up with runtime deps in the future, since related errors can mostly be detected at runtime, not during the container's build.. Why not php:7.2-fpm-alpine3.7 ? Actually, php:7.2-fpm-alpine point to the Alpine 3.6 based images.. > If one command fail, the process must stop.\nIt's the case.\nI just found it more readable with ;.. Because we don't need to specify them anymore. They're installed with the dev packages.\nIf I would translate the workflow of this PR to a Debian-based one, it would sound like this : \n1. Install the dev packages\n2. Compile the extensions\n3. Scan the compiled extensions to automatically detect their runtime dependencies and mark the corresponding packages as manually installed so they won't be auto removed during the next step\n4. Auto-remove all the packages that have not been marked as manually installed.\nThis PR aims to only define the build dependencies in the Dockerfile and to keep only the necessary libs in the resulting image.\nIs this explanation clear enough ? :/. Done. :). Why not sticking with the container name ?. > Also, I think this should be moved into the if [ \"$1\" = 'php-fpm' ] || [ \"$1\" = 'bin/console' ]; then block below.\nWhat if the user runs docker-compose run php bash ? It could not end up with the right php.ini in this case. But maybe it's not so important in this case. I don't have strong opinion on this.. Fair point. I'll do the changes. :). > \n\n* php (should be added?)\n\n\nMaybe in another PR ?\n. Could be : \nbash\nPHP_INI_RECOMMENDED=\"$PHP_INI_DIR/php.ini-development\"\nif [ \"$APP_ENV\" = 'prod' ]; then\n    PHP_INI_RECOMMENDED=\"$PHP_INI_DIR/php.ini-production\"\nfi\nI find it clearer this way.. ",
    "Gormador": "I'm sorry I won't be able to give you feedback on this one as I moved away from API Platform for other reasons, and am therefor not in a position to test it.\nThank you for your efforts on this project, though! :-). @dunglas Well, it appeared that using a JS framework to work with MongoDB simplified matters quite a bit... So I'm now using Express with Mongoose, which works fine (and made me learn JS, which is good!). However, I regret the native docker integration... And I'll be sure to check back on API Platform if I ever need to develop a php-based application!. Yes, sorry, didn't mention it. I'm speaking about the var/cache/dev folder in the skeleton-project directory.\nTrying out your suggestion now...\nOk, performed sudo chown -R $USER var/cache/dev after deleting its content. Refreshing the page gives me an Error 500. But applying the same to var/cache/logs/dev.log fixed it and allowed me to access the dev env.\nI have no idea why this behaved like it did though. Why did root took ownership of those files when the command I was using wasn't executed as root?\nAnyway, I can at least continue with the tutorial now.\nThanks!. As stated in #162 , I am not in a position to test this anymore... My apologies.\nDon't wait on me to close this issue :-)\nThanks again for you help.. ",
    "backbone87": "using Docker for WIndows with the master branch works\n(2.0.7 does NOT work in Docker for Windows due to complaints of apache to not start up as root)\nalso i created a modified version which uses postgres insteadof mysql,\ni could create a PR for it, but i dont know if it makes sense to provide multiple docker container configs. ",
    "Osub": "ok,it works.  thanks!!!\n. ",
    "Dannebicque": "I think yes.\nI am new with docker. I just follow the installation guide. I think it works.\nI have somes images when I execute docker images.\nBut when I try docker run intranetback_web (one of these images), I have a permission denied. But i don't understand where.\n. Hi,\nNo, impossible to use Docker.  I uninstalled. I passed by the Git Repository.\n. I cannot try the solution of teohhanhui, because the new docker does not work on windows 7, that's why I use Docker Toolbox.\n. Repository here : https://github.com/Dannebicque/intranetV3. Thanks. Someone give me a security.yml on the gitter channel and now it works.. Hello,\nMy security.yml\n`security:\n    encoders:\n        FOS\\UserBundle\\Model\\UserInterface: bcrypt\nrole_hierarchy:\n    ROLE_READER: ROLE_USER\n    ROLE_ADMIN: ROLE_READER\n\nproviders:\n    fos_userbundle:\n        id: fos_user.user_provider.username\n\nfirewalls:\n    main:\n        pattern: ^/login\n        form_login:\n            provider: fos_userbundle\n            login_path: fos_user_security_login\n            check_path: /login_check\n            always_use_default_target_path: false\n            default_target_path:            /api\n            target_path_parameter:          _target_path\n            use_referer:                    false\n            #failure_path:    /failed\n            failure_forward: false\n            failure_path_parameter: _failure_path\n            success_handler: lexik_jwt_authentication.handler.authentication_success\n            failure_handler: lexik_jwt_authentication.handler.authentication_failure\n        logout:\n            path: /logout\n            target: fos_user_security_login\n        anonymous: ~\n\naccess_control:\n    - { path: ^/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/reset, role: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/logout, role: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/admin, role: ROLE_ADMIN }\n    - { path: ^/api, roles: [ ROLE_USER, ROLE_ADMIN ] }`. I have not tested with curl and I do not know the line to write. I test with POSTMAN, and it is necessary to test with the data (username and password) in the body in \"application / x-www-form-urlencoded\". Waouh OK ! It's amazing :)\n\nI had not dared to write such a filter.\ndocuments.formation_filter:\n        parent: 'api_platform.doctrine.orm.search_filter'\n        arguments: [ { semestres.annee.diplome.formation: 'exact' } ]\n        tags: [ 'api_platform.filter' ]\nAnd it works fine. Thanks. Hello,\nThanks for your answer.\nCreate a class is a good Idea, I did not think about this idea.\nSo I create a new class\n```php\n<?php\nnamespace App\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\n/\n * @ApiResource(collectionOperations={\n *     \"getAuthenticatedUser\"={\"route_name\"=\"get_current_user\"}\n * })\n */\nclass CurrentUser\n{\n    / @var Personnel */\n    private $user;\n/** @var Formation */\nprivate $formations;\n\n//getters and setters\n```\nI modify my controller (rapidly to test)\n```php\nclass AuthController extends Controller\n{\n/**\n * @Route(\"/api/current_user\",\n *     name=\"get_current_user\",\n *     defaults={\n *          \"_api_resource_class\"=CurrentUser::class,\n *          \"_api_collection_operation_name\"=\"getAuthenticatedUser\"\n * })\n */\npublic function currentUser(): JsonResponse\n{\n    $cu = new CurrentUser();\n\n    if ($this->getUser()->getTypeuser() === 'PERM') {\n        $user = $this->getDoctrine()->getRepository('App:Personnel')->findOneBy(array('mailuniv' => $this->getUser()->getEmail()));\n        if ($user !== null) {\n            $formations = $user->getFormations();\n        }\n    } else {\n        $user = $this->getDoctrine()->getRepository('App:Etudiant')->findOneBy(array('mailuniv' => $this->getUser()->getEmail()));\n    }\n\n    $cu->setUser($user);\n    $cu->setFormations($formations[0]);\n    return new JsonResponse($cu);\n}\n\n}\n```\nAnd when I call this route, I get an empty Json array. Maybe I need to create an array but not return the object ?\nIf I Pass an array\nreturn new JsonResponse(array('user' => $cu->getUser(), 'formation' => $cu->getFormations()));\nI obtain\n{user: {}, formation: {}}\nformation\n:\n{}\nuser\n:\n{}. Yes ! Many thanks. It works just by returning an array.\nI obtain a collection with first my User, and then my Formation.\nCan I consider that the order will always be the same (I don't find my keys) ? Or is it better to test the @type?. OK. Many Thanks @jewome62 and @soyuka !. Thanks for your explanation @soyuka :). OK, thanks for you opinion @dunglas . I will just use an Entity directory :)\n. Hello,\nI think that's because country must be an IRI when sending data from the form. And then it's Symfony/ApiPlatform that translates this IRI into an entity which can be save the data with Doctrine.\n. Hello Alexandre,\nI changed, but no effects. In fact, I use Created and Updated in many other entities with no problem. I think, in this case, the problem is the third datetime dateEvaluation, but I don't understand why ... I send a well formatted datetime (I suppose).\nNevertheless, I'm going to look at Gedmo's doc to simplify my code for Updated and Created :). Me too, before, I obtain values like you describe, but now, not. I don't know what I change. I have no event listener and nothing (I think) in configuration.\nI post my composer.json\n\"require\": {\n        \"php\": \"^7.1.3\",\n        \"api-platform/api-pack\": \"^1.0\",\n        \"lexik/jwt-authentication-bundle\": \"^2.4\",\n        \"nelmio/cors-bundle\": \"^1.5@dev\",\n        \"sensio/framework-extra-bundle\": \"^5.1\",\n        \"symfony/apache-pack\": \"^1.0\",\n        \"symfony/console\": \"^4.0\",\n        \"symfony/flex\": \"^1.0\",\n        \"symfony/framework-bundle\": \"^4.0\",\n        \"symfony/lts\": \"^4@dev\",\n        \"symfony/maker-bundle\": \"^1.0\",\n        \"symfony/orm-pack\": \"^1.0\",\n        \"symfony/profiler-pack\": \"^1.0\",\n        \"symfony/security-bundle\": \"^4.0\",\n        \"symfony/serializer-pack\": \"^1.0\",\n        \"symfony/yaml\": \"^4.0\"\n    },\n    \"require-dev\": {\n        \"symfony/dotenv\": \"^4.0\",\n        \"squizlabs/php_codesniffer\": \"1.*\"\n    },\nAnd my yaml files for configuration.\napi_platform.yaml\n```\napi_platform:\n    collection:\n        pagination:\n            items_per_page: 20 # Default value\n    mapping:\n        paths: ['%kernel.project_dir%/src/Entity']\nformats:\n        jsonld:   ['application/ld+json']\n        jsonhal:  ['application/hal+json']\n        json:     ['application/json']\n        xml:      ['application/xml', 'text/xml']\n        html:     ['text/html']\n\n# The title of the API.\ntitle: 'API Intranet'\n# The description of the API.\ndescription: 'API Intranet'\n# The version of the API.\nversion: '0.1.0'\n\nnelmio_cors:\n    defaults:\n        allow_origin: ['*']\n        allow_methods: ['POST', 'PUT', 'GET', 'DELETE', 'OPTIONS']\n        allow_headers: ['content-type', 'authorization']\n        expose_headers: ['link']\n        max_age: 3600\n    paths:\n        '^/': ~\n```\nframework.yaml\n```\nframework:\n    secret: '%env(APP_SECRET)%'\n    default_locale: fr\n    csrf_protection: ~\n    http_method_override: true\n    #trusted_hosts: ~\n# uncomment this entire section to enable sessions\nsession:\n    # With this config, PHP's native session handling is used\n    handler_id: ~\n\nesi: ~\nfragments: ~\nphp_errors:\n    log: true\n\n```\nThanks for your help\nDavid. Hi @soyuka,\nThis is a stack trace, with these data \n{\n  \"coefficient\": \"1\",\n  \"typegroupe\": \"/index.php/api/type_groupes/2\",\n  \"dateEvaluation\": \"2018-01-04T18:26:11.601Z\",\n  \"commentaire\": \"string\",\n  \"created\": \"2018-01-04T18:26:11.601Z\",\n  \"updated\": \"2018-01-04T18:26:11.601Z\",\n  \"auteur\": \"string\",\n  \"annee\": 2017,\n  \"module\": \"/index.php/api/modules/1\",\n  \"visible\": true,\n  \"modifiable\": true\n}\n```\nSymfony\\Component\\Serializer\\Exception\\RuntimeException:\nCannot create an instance of DateTime from serialized data because its constructor requires parameter \"time\" to be present.\nat vendor/symfony/serializer/Normalizer/AbstractNormalizer.php:359\n  at Symfony\\Component\\Serializer\\Normalizer\\AbstractNormalizer->instantiateObject(array('2018-01-04T18:26:11.601Z'), 'DateTime', array('collection_operation_name' => 'post', 'operation_type' => 'collection', 'api_allow_update' => false, 'resource_class' => 'DateTime', 'request_uri' => '/index.php/api/evaluations', 'api_denormalize' => true, 'cache_key' => '8f4be38ee0226a232455394b07efd363'), object(ReflectionClass), false, 'jsonld')\n     (vendor/symfony/serializer/Normalizer/AbstractObjectNormalizer.php:188)\n  at Symfony\\Component\\Serializer\\Normalizer\\AbstractObjectNormalizer->denormalize('2018-01-04T18:26:11.601Z', 'DateTime', 'jsonld', array('collection_operation_name' => 'post', 'operation_type' => 'collection', 'api_allow_update' => false, 'resource_class' => 'DateTime', 'request_uri' => '/index.php/api/evaluations', 'api_denormalize' => true, 'cache_key' => '8f4be38ee0226a232455394b07efd363'))\n     (vendor/symfony/serializer/Serializer.php:172)\n  at Symfony\\Component\\Serializer\\Serializer->denormalize('2018-01-04T18:26:11.601Z', 'DateTime', 'jsonld', array('collection_operation_name' => 'post', 'operation_type' => 'collection', 'api_allow_update' => false, 'resource_class' => 'DateTime', 'request_uri' => '/index.php/api/evaluations', 'api_denormalize' => true, 'cache_key' => '8f4be38ee0226a232455394b07efd363'))\n     (vendor/api-platform/core/src/Serializer/AbstractItemNormalizer.php:298)\n  at ApiPlatform\\Core\\Serializer\\AbstractItemNormalizer->denormalizeRelation('dateEvaluation', object(PropertyMetadata), 'DateTime', '2018-01-04T18:26:11.601Z', 'jsonld', array('collection_operation_name' => 'post', 'operation_type' => 'collection', 'api_allow_update' => false, 'resource_class' => 'DateTime', 'request_uri' => '/index.php/api/evaluations', 'api_denormalize' => true, 'cache_key' => '8f4be38ee0226a232455394b07efd363'))\n     (vendor/api-platform/core/src/Serializer/AbstractItemNormalizer.php:192)\n  at ApiPlatform\\Core\\Serializer\\AbstractItemNormalizer->setAttributeValue(object(Evaluation), 'dateEvaluation', '2018-01-04T18:26:11.601Z', 'jsonld', array('collection_operation_name' => 'post', 'operation_type' => 'collection', 'api_allow_update' => false, 'resource_class' => 'App\\Entity\\Evaluation', 'request_uri' => '/index.php/api/evaluations', 'api_denormalize' => true, 'cache_key' => '8f4be38ee0226a232455394b07efd363'))\n     (vendor/symfony/serializer/Normalizer/AbstractObjectNormalizer.php:205)\n  at Symfony\\Component\\Serializer\\Normalizer\\AbstractObjectNormalizer->denormalize(array('coefficient' => '1', 'typegroupe' => '/index.php/api/type_groupes/2', 'dateEvaluation' => '2018-01-04T18:26:11.601Z', 'commentaire' => 'string', 'created' => '2018-01-04T18:26:11.601Z', 'updated' => '2018-01-04T18:26:11.601Z', 'auteur' => 'string', 'annee' => 2017, 'module' => '/index.php/api/modules/1', 'visible' => true, 'modifiable' => true), 'App\\Entity\\Evaluation', 'jsonld', array('collection_operation_name' => 'post', 'operation_type' => 'collection', 'api_allow_update' => false, 'resource_class' => 'App\\Entity\\Evaluation', 'request_uri' => '/index.php/api/evaluations', 'api_denormalize' => true, 'cache_key' => '8f4be38ee0226a232455394b07efd363'))\n     (vendor/api-platform/core/src/Serializer/AbstractItemNormalizer.php:116)\n  at ApiPlatform\\Core\\Serializer\\AbstractItemNormalizer->denormalize(array('coefficient' => '1', 'typegroupe' => '/index.php/api/type_groupes/2', 'dateEvaluation' => '2018-01-04T18:26:11.601Z', 'commentaire' => 'string', 'created' => '2018-01-04T18:26:11.601Z', 'updated' => '2018-01-04T18:26:11.601Z', 'auteur' => 'string', 'annee' => 2017, 'module' => '/index.php/api/modules/1', 'visible' => true, 'modifiable' => true), 'App\\Entity\\Evaluation', 'jsonld', array('collection_operation_name' => 'post', 'operation_type' => 'collection', 'api_allow_update' => false, 'resource_class' => 'App\\Entity\\Evaluation', 'request_uri' => '/index.php/api/evaluations', 'api_denormalize' => true))\n     (vendor/api-platform/core/src/JsonLd/Serializer/ItemNormalizer.php:108)\n  at ApiPlatform\\Core\\JsonLd\\Serializer\\ItemNormalizer->denormalize(array('coefficient' => '1', 'typegroupe' => '/index.php/api/type_groupes/2', 'dateEvaluation' => '2018-01-04T18:26:11.601Z', 'commentaire' => 'string', 'created' => '2018-01-04T18:26:11.601Z', 'updated' => '2018-01-04T18:26:11.601Z', 'auteur' => 'string', 'annee' => 2017, 'module' => '/index.php/api/modules/1', 'visible' => true, 'modifiable' => true), 'App\\Entity\\Evaluation', 'jsonld', array('collection_operation_name' => 'post', 'operation_type' => 'collection', 'api_allow_update' => false, 'resource_class' => 'App\\Entity\\Evaluation', 'request_uri' => '/index.php/api/evaluations'))\n     (vendor/symfony/serializer/Serializer.php:172)\n  at Symfony\\Component\\Serializer\\Serializer->denormalize(array('coefficient' => '1', 'typegroupe' => '/index.php/api/type_groupes/2', 'dateEvaluation' => '2018-01-04T18:26:11.601Z', 'commentaire' => 'string', 'created' => '2018-01-04T18:26:11.601Z', 'updated' => '2018-01-04T18:26:11.601Z', 'auteur' => 'string', 'annee' => 2017, 'module' => '/index.php/api/modules/1', 'visible' => true, 'modifiable' => true), 'App\\Entity\\Evaluation', 'jsonld', array('collection_operation_name' => 'post', 'operation_type' => 'collection', 'api_allow_update' => false, 'resource_class' => 'App\\Entity\\Evaluation', 'request_uri' => '/index.php/api/evaluations'))\n     (vendor/symfony/serializer/Serializer.php:123)\n  at Symfony\\Component\\Serializer\\Serializer->deserialize(array('coefficient' => '1', 'typegroupe' => '/index.php/api/type_groupes/2', 'dateEvaluation' => '2018-01-04T18:26:11.601Z', 'commentaire' => 'string', 'created' => '2018-01-04T18:26:11.601Z', 'updated' => '2018-01-04T18:26:11.601Z', 'auteur' => 'string', 'annee' => 2017, 'module' => '/index.php/api/modules/1', 'visible' => true, 'modifiable' => true), 'App\\Entity\\Evaluation', 'jsonld', array('collection_operation_name' => 'post', 'operation_type' => 'collection', 'api_allow_update' => false, 'resource_class' => 'App\\Entity\\Evaluation', 'request_uri' => '/index.php/api/evaluations'))\n     (vendor/api-platform/core/src/EventListener/DeserializeListener.php:71)\n  at ApiPlatform\\Core\\EventListener\\DeserializeListener->onKernelRequest(object(GetResponseEvent), 'kernel.request', object(TraceableEventDispatcher))\n  at call_user_func(array(object(DeserializeListener), 'onKernelRequest'), object(GetResponseEvent), 'kernel.request', object(TraceableEventDispatcher))\n     (vendor/symfony/event-dispatcher/Debug/WrappedListener.php:104)\n  at Symfony\\Component\\EventDispatcher\\Debug\\WrappedListener->__invoke(object(GetResponseEvent), 'kernel.request', object(EventDispatcher))\n     (vendor/symfony/event-dispatcher/EventDispatcher.php:212)\n  at Symfony\\Component\\EventDispatcher\\EventDispatcher->doDispatch(array(object(WrappedListener), object(WrappedListener), object(WrappedListener), object(WrappedListener), object(WrappedListener), object(WrappedListener), object(WrappedListener), object(WrappedListener), object(WrappedListener), object(WrappedListener), object(WrappedListener), object(WrappedListener), object(WrappedListener), object(WrappedListener), object(WrappedListener)), 'kernel.request', object(GetResponseEvent))\n     (vendor/symfony/event-dispatcher/EventDispatcher.php:44)\n  at Symfony\\Component\\EventDispatcher\\EventDispatcher->dispatch('kernel.request', object(GetResponseEvent))\n     (vendor/symfony/event-dispatcher/Debug/TraceableEventDispatcher.php:139)\n  at Symfony\\Component\\EventDispatcher\\Debug\\TraceableEventDispatcher->dispatch('kernel.request', object(GetResponseEvent))\n     (vendor/symfony/http-kernel/HttpKernel.php:125)\n  at Symfony\\Component\\HttpKernel\\HttpKernel->handleRaw(object(Request), 1)\n     (vendor/symfony/http-kernel/HttpKernel.php:66)\n  at Symfony\\Component\\HttpKernel\\HttpKernel->handle(object(Request), 1, true)\n     (vendor/symfony/http-kernel/Kernel.php:190)\n  at Symfony\\Component\\HttpKernel\\Kernel->handle(object(Request))\n     (public/index.php:28)\n```\nI put some dump in the DateTimeNormalizer, but How can I sen the results ? I just get the Json ou the documentation of Api-Platform.\nEdit:\nI write a dump before the exception in the AbstractNormalizer.php file, I have this  \nphp\n<script> Sfdump = window.Sfdump || (function (doc) { var refStyle = doc.createElement('style'), rxEsc = /([.*+?^${}()|\\[\\]\\/\\\\])/g, idRx = /\\bsf-dump-\\d+-ref[012]\\w+\\b/, keyHint = 0 <= navigator.platform.toUpperCase().indexOf('MAC') ? 'Cmd' : 'Ctrl', addEventListener = function (e, n, cb) { e.addEventListener(n, cb, false); }; (doc.documentElement.firstElementChild || doc.documentElement.children[0]).appendChild(refStyle); if (!doc.addEventListener) { addEventListener = function (element, eventName, callback) { element.attachEvent('on' + eventName, function (e) { e.preventDefault = function () {e.returnValue = false;}; e.target = e.srcElement; callback(e); }); }; } function toggle(a, recursive) { var s = a.nextSibling || {}, oldClass = s.className, arrow, newClass; if (/\\bsf-dump-compact\\b/.test(oldClass)) { arrow = '&#9660;'; newClass = 'sf-dump-expanded'; } else if (/\\bsf-dump-expanded\\b/.test(oldClass)) { arrow = '&#9654;'; newClass = 'sf-dump-compact'; } else { return false; } if (doc.createEvent && s.dispatchEvent) { var event = doc.createEvent('Event'); event.initEvent('sf-dump-expanded' === newClass ? 'sfbeforedumpexpand' : 'sfbeforedumpcollapse', true, false); s.dispatchEvent(event); } a.lastChild.innerHTML = arrow; s.className = s.className.replace(/\\bsf-dump-(compact|expanded)\\b/, newClass); if (recursive) { try { a = s.querySelectorAll('.'+oldClass); for (s = 0; s < a.length; ++s) { if (-1 == a[s].className.indexOf(newClass)) { a[s].className = newClass; a[s].previousSibling.lastChild.innerHTML = arrow; } } } catch (e) { } } return true; }; function collapse(a, recursive) { var s = a.nextSibling || {}, oldClass = s.className; if (/\\bsf-dump-expanded\\b/.test(oldClass)) { toggle(a, recursive); return true; } return false; }; function expand(a, recursive) { var s = a.nextSibling || {}, oldClass = s.className; if (/\\bsf-dump-compact\\b/.test(oldClass)) { toggle(a, recursive); return true; } return false; }; function collapseAll(root) { var a = root.querySelector('a.sf-dump-toggle'); if (a) { collapse(a, true); expand(a); return true; } return false; } function reveal(node) { var previous, parents = []; while ((node = node.parentNode || {}) && (previous = node.previousSibling) && 'A' === previous.tagName) { parents.push(previous); } if (0 !== parents.length) { parents.forEach(function (parent) { expand(parent); }); return true; } return false; } function highlight(root, activeNode, nodes) { resetHighlightedNodes(root); Array.from(nodes||[]).forEach(function (node) { if (!/\\bsf-dump-highlight\\b/.test(node.className)) { node.className = node.className + ' sf-dump-highlight'; } }); if (!/\\bsf-dump-highlight-active\\b/.test(activeNode.className)) { activeNode.className = activeNode.className + ' sf-dump-highlight-active'; } } function resetHighlightedNodes(root) { Array.from(root.querySelectorAll('.sf-dump-str, .sf-dump-key, .sf-dump-public, .sf-dump-protected, .sf-dump-private')).forEach(function (strNode) { strNode.className = strNode.className.replace(/\\bsf-dump-highlight\\b/, ''); strNode.className = strNode.className.replace(/\\bsf-dump-highlight-active\\b/, ''); }); } return function (root, x) { root = doc.getElementById(root); var indentRx = new RegExp('^('+(root.getAttribute('data-indent-pad') || ' ').replace(rxEsc, '\\\\$1')+')+', 'm'), options = {\"maxDepth\":1,\"maxStringLength\":160,\"fileLinkFormat\":false}, elt = root.getElementsByTagName('A'), len = elt.length, i = 0, s, h, t = []; while (i < len) t.push(elt[i++]); for (i in x) { options[i] = x[i]; } function a(e, f) { addEventListener(root, e, function (e) { if ('A' == e.target.tagName) { f(e.target, e); } else if ('A' == e.target.parentNode.tagName) { f(e.target.parentNode, e); } else if (e.target.nextElementSibling && 'A' == e.target.nextElementSibling.tagName) { f(e.target.nextElementSibling, e, true); } }); }; function isCtrlKey(e) { return e.ctrlKey || e.metaKey; } function xpathString(str) { var parts = str.match(/[^'\"]+|['\"]/g).map(function (part) { if (\"'\" == part) { return '\"\\'\"'; } if ('\"' == part) { return \"'\\\"'\"; } return \"'\" + part + \"'\"; }); return \"concat(\" + parts.join(\",\") + \", '')\"; } addEventListener(root, 'mouseover', function (e) { if ('' != refStyle.innerHTML) { refStyle.innerHTML = ''; } }); a('mouseover', function (a, e, c) { if (c) { e.target.style.cursor = \"pointer\"; } else if (a = idRx.exec(a.className)) { try { refStyle.innerHTML = 'pre.sf-dump .'+a[0]+'{background-color: #B729D9; color: #FFF !important; border-radius: 2px}'; } catch (e) { } } }); a('click', function (a, e, c) { if (/\\bsf-dump-toggle\\b/.test(a.className)) { e.preventDefault(); if (!toggle(a, isCtrlKey(e))) { var r = doc.getElementById(a.getAttribute('href').substr(1)), s = r.previousSibling, f = r.parentNode, t = a.parentNode; t.replaceChild(r, a); f.replaceChild(a, s); t.insertBefore(s, r); f = f.firstChild.nodeValue.match(indentRx); t = t.firstChild.nodeValue.match(indentRx); if (f && t && f[0] !== t[0]) { r.innerHTML = r.innerHTML.replace(new RegExp('^'+f[0].replace(rxEsc, '\\\\$1'), 'mg'), t[0]); } if (/\\bsf-dump-compact\\b/.test(r.className)) { toggle(s, isCtrlKey(e)); } } if (c) { } else if (doc.getSelection) { try { doc.getSelection().removeAllRanges(); } catch (e) { doc.getSelection().empty(); } } else { doc.selection.empty(); } } else if (/\\bsf-dump-str-toggle\\b/.test(a.className)) { e.preventDefault(); e = a.parentNode.parentNode; e.className = e.className.replace(/\\bsf-dump-str-(expand|collapse)\\b/, a.parentNode.className); } }); elt = root.getElementsByTagName('SAMP'); len = elt.length; i = 0; while (i < len) t.push(elt[i++]); len = t.length; for (i = 0; i < len; ++i) { elt = t[i]; if ('SAMP' == elt.tagName) { a = elt.previousSibling || {}; if ('A' != a.tagName) { a = doc.createElement('A'); a.className = 'sf-dump-ref'; elt.parentNode.insertBefore(a, elt); } else { a.innerHTML += ' '; } a.title = (a.title ? a.title+'\\n[' : '[')+keyHint+'+click] Expand all children'; a.innerHTML += '<span>&#9660;</span>'; a.className += ' sf-dump-toggle'; x = 1; if ('sf-dump' != elt.parentNode.className) { x += elt.parentNode.getAttribute('data-depth')/1; } elt.setAttribute('data-depth', x); var className = elt.className; elt.className = 'sf-dump-expanded'; if (className ? 'sf-dump-expanded' !== className : (x > options.maxDepth)) { toggle(a); } } else if (/\\bsf-dump-ref\\b/.test(elt.className) && (a = elt.getAttribute('href'))) { a = a.substr(1); elt.className += ' '+a; if (/[\\[{]$/.test(elt.previousSibling.nodeValue)) { a = a != elt.nextSibling.id && doc.getElementById(a); try { s = a.nextSibling; elt.appendChild(a); s.parentNode.insertBefore(a, s); if (/^[@#]/.test(elt.innerHTML)) { elt.innerHTML += ' <span>&#9654;</span>'; } else { elt.innerHTML = '<span>&#9654;</span>'; elt.className = 'sf-dump-ref'; } elt.className += ' sf-dump-toggle'; } catch (e) { if ('&' == elt.innerHTML.charAt(0)) { elt.innerHTML = '&hellip;'; elt.className = 'sf-dump-ref'; } } } } } if (doc.evaluate && Array.from && root.children.length > 1) { root.setAttribute('tabindex', 0); SearchState = function () { this.nodes = []; this.idx = 0; }; SearchState.prototype = { next: function () { if (this.isEmpty()) { return this.current(); } this.idx = this.idx < (this.nodes.length - 1) ? this.idx + 1 : 0; return this.current(); }, previous: function () { if (this.isEmpty()) { return this.current(); } this.idx = this.idx > 0 ? this.idx - 1 : (this.nodes.length - 1); return this.current(); }, isEmpty: function () { return 0 === this.count(); }, current: function () { if (this.isEmpty()) { return null; } return this.nodes[this.idx]; }, reset: function () { this.nodes = []; this.idx = 0; }, count: function () { return this.nodes.length; }, }; function showCurrent(state) { var currentNode = state.current(); if (currentNode) { reveal(currentNode); highlight(root, currentNode, state.nodes); } counter.textContent = (state.isEmpty() ? 0 : state.idx + 1) + ' of ' + state.count(); } var search = doc.createElement('div'); search.className = 'sf-dump-search-wrapper sf-dump-search-hidden'; search.innerHTML = ' <input type=\"text\" class=\"sf-dump-search-input\"> <span class=\"sf-dump-search-count\">0 of 0<\\/span> <button type=\"button\" class=\"sf-dump-search-input-previous\" tabindex=\"-1\"> <svg viewBox=\"0 0 1792 1792\" xmlns=\"http://www.w3.org/2000/svg\"> <path d=\"M1683 1331l-166 165q-19 19-45 19t-45-19l-531-531-531 531q-19 19-45 19t-45-19l-166-165q-19-19-19-45.5t19-45.5l742-741q19-19 45-19t45 19l742 741q19 19 19 45.5t-19 45.5z\"\\/> <\\/svg> <\\/button> <button type=\"button\" class=\"sf-dump-search-input-next\" tabindex=\"-1\"> <svg viewBox=\"0 0 1792 1792\" xmlns=\"http://www.w3.org/2000/svg\"> <path d=\"M1683 808l-742 741q-19 19-45 19t-45-19l-742-741q-19-19-19-45.5t19-45.5l166-165q19-19 45-19t45 19l531 531 531-531q19-19 45-19t45 19l166 165q19 19 19 45.5t-19 45.5z\"\\/> <\\/svg> <\\/button> '; root.insertBefore(search, root.firstChild); var state = new SearchState(); var searchInput = search.querySelector('.sf-dump-search-input'); var counter = search.querySelector('.sf-dump-search-count'); var searchInputTimer = 0; var previousSearchQuery = ''; addEventListener(searchInput, 'keyup', function (e) { var searchQuery = e.target.value; /* Don't perform anything if the pressed key didn't change the query */ if (searchQuery === previousSearchQuery) { return; } previousSearchQuery = searchQuery; clearTimeout(searchInputTimer); searchInputTimer = setTimeout(function () { state.reset(); collapseAll(root); resetHighlightedNodes(root); if ('' === searchQuery) { counter.textContent = '0 of 0'; return; } var xpathResult = doc.evaluate('//pre[@id=\"' + root.id + '\"]//span[@class=\"sf-dump-str\" or @class=\"sf-dump-key\" or @class=\"sf-dump-public\" or @class=\"sf-dump-protected\" or @class=\"sf-dump-private\"][contains(translate(child::text(), ' + xpathString(searchQuery.toUpperCase()) + ', ' + xpathString(searchQuery.toLowerCase()) + '), ' + xpathString(searchQuery.toLowerCase()) + ')]', document, null, XPathResult.ORDERED_NODE_ITERATOR_TYPE, null); while (node = xpathResult.iterateNext()) state.nodes.push(node); showCurrent(state); }, 400); }); Array.from(search.querySelectorAll('.sf-dump-search-input-next, .sf-dump-search-input-previous')).forEach(function (btn) { addEventListener(btn, 'click', function (e) { e.preventDefault(); -1 !== e.target.className.indexOf('next') ? state.next() : state.previous(); searchInput.focus(); collapseAll(root); showCurrent(state); }) }); addEventListener(root, 'keydown', function (e) { var isSearchActive = !/\\bsf-dump-search-hidden\\b/.test(search.className); if ((114 === e.keyCode && !isSearchActive) || (isCtrlKey(e) && 70 === e.keyCode)) { /* F3 or CMD/CTRL + F */ e.preventDefault(); search.className = search.className.replace(/\\bsf-dump-search-hidden\\b/, ''); searchInput.focus(); } else if (isSearchActive) { if (27 === e.keyCode) { /* ESC key */ search.className += ' sf-dump-search-hidden'; e.preventDefault(); resetHighlightedNodes(root); searchInput.value = ''; } else if ( (isCtrlKey(e) && 71 === e.keyCode) /* CMD/CTRL + G */ || 13 === e.keyCode /* Enter */ || 114 === e.keyCode /* F3 */ ) { e.preventDefault(); e.shiftKey ? state.previous() : state.next(); collapseAll(root); showCurrent(state); } } }); } if (0 >= options.maxStringLength) { return; } try { elt = root.querySelectorAll('.sf-dump-str'); len = elt.length; i = 0; t = []; while (i < len) t.push(elt[i++]); len = t.length; for (i = 0; i < len; ++i) { elt = t[i]; s = elt.innerText || elt.textContent; x = s.length - options.maxStringLength; if (0 < x) { h = elt.innerHTML; elt[elt.innerText ? 'innerText' : 'textContent'] = s.substring(0, options.maxStringLength); elt.className += ' sf-dump-str-collapse'; elt.innerHTML = '<span class=sf-dump-str-collapse>'+h+'<a class=\"sf-dump-ref sf-dump-str-toggle\" title=\"Collapse\"> &#9664;</a></span>'+ '<span class=sf-dump-str-expand>'+elt.innerHTML+'<a class=\"sf-dump-ref sf-dump-str-toggle\" title=\"'+x+' remaining characters\"> &#9654;</a></span>'; } } } catch (e) { } }; })(document); </script><style> pre.sf-dump { display: block; white-space: pre; padding: 5px; } pre.sf-dump:after { content: \"\"; visibility: hidden; display: block; height: 0; clear: both; } pre.sf-dump span { display: inline; } pre.sf-dump .sf-dump-compact { display: none; } pre.sf-dump abbr { text-decoration: none; border: none; cursor: help; } pre.sf-dump a { text-decoration: none; cursor: pointer; border: 0; outline: none; color: inherit; } pre.sf-dump .sf-dump-ellipsis { display: inline-block; overflow: visible; text-overflow: ellipsis; max-width: 5em; white-space: nowrap; overflow: hidden; vertical-align: top; } pre.sf-dump .sf-dump-ellipsis+.sf-dump-ellipsis { max-width: none; } pre.sf-dump code { display:inline; padding:0; background:none; } .sf-dump-str-collapse .sf-dump-str-collapse { display: none; } .sf-dump-str-expand .sf-dump-str-expand { display: none; } .sf-dump-public.sf-dump-highlight, .sf-dump-protected.sf-dump-highlight, .sf-dump-private.sf-dump-highlight, .sf-dump-str.sf-dump-highlight, .sf-dump-key.sf-dump-highlight { background: rgba(111, 172, 204, 0.3); border: 1px solid #7DA0B1; border-radius: 3px; } .sf-dump-public.sf-dump-highlight-active, .sf-dump-protected.sf-dump-highlight-active, .sf-dump-private.sf-dump-highlight-active, .sf-dump-str.sf-dump-highlight-active, .sf-dump-key.sf-dump-highlight-active { background: rgba(253, 175, 0, 0.4); border: 1px solid #ffa500; border-radius: 3px; } pre.sf-dump .sf-dump-search-hidden { display: none; } pre.sf-dump .sf-dump-search-wrapper { float: right; font-size: 0; white-space: nowrap; max-width: 100%; text-align: right; } pre.sf-dump .sf-dump-search-wrapper > * { vertical-align: top; box-sizing: border-box; height: 21px; font-weight: normal; border-radius: 0; background: #FFF; color: #757575; border: 1px solid #BBB; } pre.sf-dump .sf-dump-search-wrapper > input.sf-dump-search-input { padding: 3px; height: 21px; font-size: 12px; border-right: none; width: 140px; border-top-left-radius: 3px; border-bottom-left-radius: 3px; color: #000; } pre.sf-dump .sf-dump-search-wrapper > .sf-dump-search-input-next, pre.sf-dump .sf-dump-search-wrapper > .sf-dump-search-input-previous { background: #F2F2F2; outline: none; border-left: none; font-size: 0; line-height: 0; } pre.sf-dump .sf-dump-search-wrapper > .sf-dump-search-input-next { border-top-right-radius: 3px; border-bottom-right-radius: 3px; } pre.sf-dump .sf-dump-search-wrapper > .sf-dump-search-input-next > svg, pre.sf-dump .sf-dump-search-wrapper > .sf-dump-search-input-previous > svg { pointer-events: none; width: 12px; height: 12px; } pre.sf-dump .sf-dump-search-wrapper > .sf-dump-search-count { display: inline-block; padding: 0 5px; margin: 0; border-left: none; line-height: 21px; font-size: 12px; }pre.sf-dump, pre.sf-dump .sf-dump-default{background-color:#18171B; color:#FF8400; line-height:1.2em; font:12px Menlo, Monaco, Consolas, monospace; word-wrap: break-word; white-space: pre-wrap; position:relative; z-index:99999; word-break: break-all}pre.sf-dump .sf-dump-num{font-weight:bold; color:#1299DA}pre.sf-dump .sf-dump-const{font-weight:bold}pre.sf-dump .sf-dump-str{font-weight:bold; color:#56DB3A}pre.sf-dump .sf-dump-note{color:#1299DA}pre.sf-dump .sf-dump-ref{color:#A0A0A0}pre.sf-dump .sf-dump-public{color:#FFFFFF}pre.sf-dump .sf-dump-protected{color:#FFFFFF}pre.sf-dump .sf-dump-private{color:#FFFFFF}pre.sf-dump .sf-dump-meta{color:#B729D9}pre.sf-dump .sf-dump-key{color:#56DB3A}pre.sf-dump .sf-dump-index{color:#1299DA}pre.sf-dump .sf-dump-ellipsis{color:#FF8400}</style><pre class=sf-dump id=sf-dump-883234423 data-indent-pad=\"  \"><span class=sf-dump-note>array:1</span> [<samp>\n  <span class=sf-dump-index>0</span> => \"<span class=sf-dump-str title=\"24 characters\">2018-01-04T18:26:11.601Z</span>\"\n</samp>]\n</pre><script>Sfdump(\"sf-dump-883234423\")</script>. ",
    "jonag": "Where are located your files? By default, with Docker Toolbox, only the files under your user directory (C:\\Users....) are accessible. This may explain your issue with Docker...\n. ",
    "priyanka1110": "@dunglas I tried the steps suggested by @teohhanhui But still I am facing the same issue\nno such file or directory\\\"\\n\"\nI am using windows 10 Home, with docker toolbox.. The issue was fixed since I had the code in E:. I checked out in C: and it works. . ",
    "toinouu": "thx @Simperfit \nbut now => #169 \n. the rights of cache directory \ndrwxr-xr-x 4 root root /api-platform/var/cache\n. I think it puts the root because when I want to run a command I do this\nsudo docker-compose run web bin/console cache:clear\n. ok but when i dont use root  i have this error \n\nERROR: Couldn't connect to Docker daemon at http+docker://localunixsocket - is it running?\nIf it's at a non-standard location, specify the URL with the DOCKER_HOST environment variable.\n. I forgot to reboot my bad\n\nthx\n. ",
    "alex88": "@Simperfit latest update seems to have removed the bin/console server:run command, there is nothing under the server namespace anymore, was it intentional?. @Simperfit you mean nginx-apache etc or a component that replaces that command?. Oh sorry, haven't seen that, I've searched only through api platform changes... Thank you!. ",
    "CesarCarrazana": "@Simperfit  on the parameters in POST\nThanks\n. ",
    "AndreMaz": "Hey @Simperfit thanks for quick answer\n1. I was running as a root because I've just done a fresh installation of Docker and didn't add my account to the docker group (https://docs.docker.com/engine/installation/linux/ubuntulinux/#/create-a-docker-group)\n2.\nInput\ndocker pull php:7.0-apache\nOutput:\n7.0-apache: Pulling from library/php\nDigest: sha256:635651170bb227a1586c392d529704d74c74ba48226491850e78392b36b47f94\nStatus: Image is up to date for php:7.0-apache\nInput:\ndocker-compose up -d\nOutput:\n```\napiplatformapiplatformab17f42_database_1 is up-to-date\nBuilding web\nStep 1 : FROM php:7.0-apache\n ---> 7dea5b089190\nStep 2 : ENV APCU_VERSION 5.1.5\n ---> Using cache\n ---> e5bb56e77724\nStep 3 : RUN buildDeps=\"         libicu-dev         zlib1g-dev     \"     && apt-get update     && apt-get install -y --no-install-recommends         $buildDeps         libicu52         zlib1g     && rm -rf /var/lib/apt/lists/*     && docker-php-ext-install         intl         mbstring         pdo_mysql         zip     && apt-get purge -y --auto-remove $buildDeps\n ---> Running in 18937467dbe0\nErr http://security.debian.org jessie/updates InRelease\nErr http://security.debian.org jessie/updates Release.gpg\n  Could not resolve 'security.debian.org'\nErr http://deb.debian.org jessie InRelease\nErr http://deb.debian.org jessie-updates InRelease\nErr http://deb.debian.org jessie Release.gpg\n  Could not resolve 'deb.debian.org'\nErr http://deb.debian.org jessie-updates Release.gpg\n  Could not resolve 'deb.debian.org'\nReading package lists...\nW: Failed to fetch http://deb.debian.org/debian/dists/jessie/InRelease  \nW: Failed to fetch http://deb.debian.org/debian/dists/jessie-updates/InRelease  \nW: Failed to fetch http://security.debian.org/dists/jessie/updates/InRelease  \nW: Failed to fetch http://security.debian.org/dists/jessie/updates/Release.gpg  Could not resolve 'security.debian.org'\nW: Failed to fetch http://deb.debian.org/debian/dists/jessie/Release.gpg  Could not resolve 'deb.debian.org'\nW: Failed to fetch http://deb.debian.org/debian/dists/jessie-updates/Release.gpg  Could not resolve 'deb.debian.org'\nW: Some index files failed to download. They have been ignored, or old ones used instead.\nReading package lists...\nBuilding dependency tree...\nReading state information...\nE: Unable to locate package libicu-dev\nE: Unable to locate package zlib1g-dev\nE: Unable to locate package libicu52\nERROR: Service 'web' failed to build: The command '/bin/sh -c buildDeps=\"         libicu-dev         zlib1g-dev     \"     && apt-get update     && apt-get install -y --no-install-recommends         $buildDeps         libicu52         zlib1g     && rm -rf /var/lib/apt/lists/*     && docker-php-ext-install         intl         mbstring         pdo_mysql         zip     && apt-get purge -y --auto-remove $buildDeps' returned a non-zero code: 100\n``\n. Thanks @Simperfit and @dunglas :) you were right. For some reason my university is blocking the access todebian.org` subdomains.\nVPN solved the issue\n. ",
    "abKry": "I'm testing this code, but how to format the json uploaded file ?\nAP throw an error: Cannot validate values of type \\\"NULL\\\" automatically. Please provide a constraint.\nThanks\nIn swagger ui, the import json format:\n{\n  \"file\": \"string\"\n}\n. Change your route, because regular expression think your route is for an api_platform_item_collection and not the route of your custom action:\nyour path route:  /list\ntry to chage to : /get/all/list\nfor example.\n. Hi,\nit will be interesting for others peoples to have the answer to the question ! insn't it ?\nBecause i need this response. How to return the \"hydra:view\" array in the response ?\nThanks a lot\nHere is the code, in my Repository  Class (called from my custom Action __invoke) :\n```\n// use ApiPlatform\\Core\\Bridge\\Doctrine\\Orm\\Paginator as Paginator;\n// use Doctrine\\ORM\\Tools\\Pagination\\Paginator as DoctrinePaginator;\n    $qb = $this->createQueryBuilder('o');\n    $expression = Criteria::expr();\n    $criteria = Criteria::create()\n        ->orderBy(array('PublicationStart' => Criteria::DESC))\n        ->where($expression->eq('ContentTypes', $type))\n        ->andWhere($expression->lte('PublicationStart', new \\DateTime()))\n        ->andWhere($expression->eq('IsOnline', 1))\n        ->setFirstResult($page * $limit)\n        ->setMaxResults($limit);\n\n    $qb->addCriteria($criteria);\n\n// How to return hydra:view\n    $dp = new DoctrinePaginator($qb);\n    return $dp->getQuery()->iterate($dp->getIterator()->getArrayCopy());\n\n    $po = new Paginator($dp);\n    return $po->getIterator()->getArrayCopy();\n\n```\n. thanks, i found much easier\nin app_dev.php, set dev debug environment to false\n$kernel = new AppKernel('dev', false);. Hi\nIs there a way to do the same think with json format ?\nThanks. Sorry, thanks i found .. Thanks for the response,\nThe problem is not pagination, but i get an error when i set \"page\" parameter to zero or less than zero.\nApi platform seem to have a bug or my \"custom filter\" test is not good.\nwhat result have you, when yiu set  \"page = 0\" in the swagger ui ?\nI work on an test platform and try some poc.\nThanks\n  . I installed AP with composer install instruction the 2017-12-12.\nI'm new, and don't know the exact version:\ncomposer say : \n```\n{\n    \"name\": \"api-platform/api-platform\",\n    \"license\": \"MIT\",\n    \"type\": \"project\",\n    \"description\": \"The API Platform framework\",\n    \"homepage\": \"https://api-platform.com\",\n    \"authors\": [\n        {\n            \"name\": \"K\u00e9vin Dunglas\",\n            \"email\": \"dunglas@gmail.com\",\n            \"homepage\": \"https://dunglas.fr\"\n        }\n    ],\n    \"autoload\": {\n        \"psr-4\": { \"\": \"src/\" },\n        \"classmap\": [ \"app/AppKernel.php\", \"app/AppCache.php\" ]\n    },\n    \"autoload-dev\": {\n        \"psr-4\": { \"Tests\\\": \"tests/\" }\n    },\n    \"require\": {\n        \"php\": \">=7.0\",\n        \"api-platform/core\": \"^2.1\",\n        \"doctrine/doctrine-bundle\": \"^1.6\",\n        \"doctrine/orm\": \"^2.5\",\n        \"guzzlehttp/guzzle\": \"^6.0\",\n        \"incenteev/composer-parameter-handler\": \"^2.0\",\n        \"nelmio/cors-bundle\": \"^1.4\",\n        \"phpdocumentor/reflection-docblock\": \"^3.0\",\n        \"sensio/distribution-bundle\": \"^5.0.19\",\n        \"sensio/framework-extra-bundle\": \"^3.0.2\",\n        \"symfony/monolog-bundle\": \"^3.1.0\",\n        \"symfony/swiftmailer-bundle\": \"^2.3.10\",\n        \"symfony/symfony\": \"3.3.*\",\n        \"twig/twig\": \"^1.0 || ^2.0\"\n    },\n    \"require-dev\": {\n        \"api-platform/schema-generator\": \"^2.0\",\n        \"behat/behat\": \"^3.1\",\n        \"behat/mink\": \"^1.7\",\n        \"behat/mink-browserkit-driver\": \"^1.3.1\",\n        \"behat/mink-extension\": \"^2.2\",\n        \"behat/symfony2-extension\": \"^2.1\",\n        \"behatch/contexts\": \"^2.5\",\n        \"sensio/generator-bundle\": \"^3.0\",\n        \"symfony/phpunit-bridge\": \"^3.0\"\n    },\n    \"scripts\": {\n        \"symfony-scripts\": [\n            \"Incenteev\\ParameterHandler\\ScriptHandler::buildParameters\",\n            \"Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::clearCache\",\n            \"Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installAssets\",\n            \"Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installRequirementsFile\",\n            \"Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::prepareDeploymentTarget\"\n        ],\n        \"post-install-cmd\": [\n            \"@symfony-scripts\"\n        ],\n        \"post-update-cmd\": [\n            \"@symfony-scripts\"\n        ]\n    },\n    \"config\": {\n        \"sort-packages\": true\n    },\n    \"extra\": {\n        \"symfony-app-dir\": \"app\",\n        \"symfony-bin-dir\": \"bin\",\n        \"symfony-var-dir\": \"var\",\n        \"symfony-web-dir\": \"web\",\n        \"symfony-tests-dir\": \"tests\",\n        \"symfony-assets-install\": \"hard\",\n        \"incenteev-parameters\": {\n            \"file\": \"app/config/parameters.yml\"\n        },\n        \"branch-alias\": {\n            \"dev-master\": \"2.1-dev\"\n        }\n    }\n}\n```. This code come from the doc, https://api-platform.com/docs/core/filters#creating-custom-filters. I don't understand how to install the good 2.1.4 version,\nWhen i install a new AP test platform, the:\nhttps://github.com/api-platform/core/blob/master/src/Bridge/Doctrine/Orm/Extension/PaginationExtension.php#L106\nis not good in my installation:\ninstall log:\n```\nphp composer.phar create-project api-platform/api-platform bookshop-api\nInstalling api-platform/api-platform (v2.1.4)\n  - Installing api-platform/api-platform (v2.1.4): Downloading (100%)\nCreated project in bookshop-api\nLoading composer repositories with package information\nInstalling dependencies (including require-dev) from lock file\nPackage operations: 67 installs, 0 updates, 0 removals\n  - Installing willdurand/negotiation (v2.3.1): Loading from cache\n  - Installing symfony/polyfill-mbstring (v1.6.0): Loading from cache\n  - Installing twig/twig (v2.4.4): Downloading (100%)\n  - Installing symfony/polyfill-util (v1.6.0): Downloading (100%)\n  - Installing paragonie/random_compat (v2.0.11): Downloading (100%)\n  - Installing symfony/polyfill-php70 (v1.6.0): Downloading (100%)\n  - Installing symfony/polyfill-php56 (v1.6.0): Downloading (100%)\n  - Installing symfony/symfony (v3.3.13): Downloading (100%)\n  - Installing symfony/polyfill-intl-icu (v1.6.0): Downloading (100%)\n  - Installing symfony/polyfill-apcu (v1.6.0): Downloading (100%)\n  - Installing psr/simple-cache (1.0.0): Loading from cache\n  - Installing psr/log (1.0.2): Loading from cache\n  - Installing psr/link (1.0.0): Loading from cache\n  - Installing psr/container (1.0.0): Loading from cache\n  - Installing psr/cache (1.0.1): Loading from cache\n  - Installing fig/link-util (1.0.0): Loading from cache\n  - Installing doctrine/lexer (v1.0.1): Loading from cache\n  - Installing doctrine/inflector (v1.2.0): Loading from cache\n  - Installing doctrine/collections (v1.5.0): Loading from cache\n  - Installing doctrine/cache (v1.7.1): Loading from cache\n  - Installing doctrine/annotations (v1.5.0): Loading from cache\n  - Installing doctrine/common (v2.8.1): Loading from cache\n  - Installing api-platform/core (v2.1.4): Downloading (100%)\n  - Installing jdorn/sql-formatter (v1.2.17): Loading from cache\n  - Installing doctrine/doctrine-cache-bundle (1.3.2): Downloading (100%)\n  - Installing doctrine/dbal (v2.6.3): Loading from cache\n  - Installing doctrine/doctrine-bundle (1.8.1): Downloading (100%)\n  - Installing doctrine/instantiator (1.1.0): Loading from cache\n  - Installing doctrine/orm (v2.5.13): Downloading (100%)\n  - Installing guzzlehttp/promises (v1.3.1): Loading from cache\n  - Installing psr/http-message (1.0.1): Loading from cache\n  - Installing guzzlehttp/psr7 (1.4.2): Loading from cache\n  - Installing incenteev/composer-parameter-handler (v2.1.2): Loading from cache\n  - Installing nelmio/cors-bundle (1.5.3): Loading from cache\n  - Installing webmozart/assert (1.2.0): Loading from cache\n  - Installing phpdocumentor/reflection-common (1.0.1): Downloading (100%)\n  - Installing phpdocumentor/type-resolver (0.4.0): Loading from cache\n  - Installing phpdocumentor/reflection-docblock (3.3.2): Downloading (100%)\n  - Installing composer/ca-bundle (1.0.9): Downloading (100%)\n  - Installing sensiolabs/security-checker (v4.1.6): Downloading (100%)\n  - Installing sensio/distribution-bundle (v5.0.21): Loading from cache\n  - Installing sensio/framework-extra-bundle (v3.0.28): Downloading (100%)\n  - Installing monolog/monolog (1.23.0): Loading from cache\n  - Installing symfony/monolog-bundle (v3.1.2): Downloading (100%)\n  - Installing swiftmailer/swiftmailer (v5.4.8): Loading from cache\n  - Installing symfony/swiftmailer-bundle (v2.6.7): Downloading (100%)\n  - Installing league/html-to-markdown (4.6.0): Downloading (100%)\n  - Installing symfony/polyfill-php72 (v1.6.0): Downloading (100%)\n  - Installing php-cs-fixer/diff (v1.2.0): Downloading (100%)\n  - Installing gecko-packages/gecko-php-unit (v3.0): Downloading (100%)\n  - Installing composer/semver (1.4.2): Downloading (100%)\n  - Installing friendsofphp/php-cs-fixer (v2.8.3): Downloading (100%)\n  - Installing easyrdf/easyrdf (0.9.1): Loading from cache\n  - Installing api-platform/schema-generator (v2.0.2): Downloading (100%)\n  - Installing behat/gherkin (v4.5.1): Loading from cache\n  - Installing behat/mink (v1.7.1): Loading from cache\n  - Installing behat/mink-browserkit-driver (v1.3.2): Loading from cache\n  - Installing container-interop/container-interop (1.2.0): Loading from cache\n  - Installing behat/transliterator (v1.2.0): Loading from cache\n  - Installing behat/behat (v3.4.3): Downloading (100%)\n  - Installing behat/symfony2-extension (2.1.2): Downloading (100%)\n  - Installing justinrainbow/json-schema (5.2.6): Downloading (100%)\n  - Installing guzzlehttp/guzzle (6.3.0): Loading from cache\n  - Installing behat/mink-extension (2.3.0): Downloading (100%)\n  - Installing behatch/contexts (2.8.0): Downloading (100%)\n  - Installing sensio/generator-bundle (v3.1.6): Loading from cache\n  - Installing symfony/phpunit-bridge (v3.3.13): Downloading (100%)\nparagonie/random_compat suggests installing ext-libsodium (Provides a modern crypto API that can be used to generate random bytes.)\nsymfony/polyfill-intl-icu suggests installing ext-intl (For best performance)\ndoctrine/cache suggests installing alcaeus/mongo-php-adapter (Required to use legacy MongoDB driver)\napi-platform/core suggests installing friendsofsymfony/user-bundle (To use the FOSUserBundle bridge.)\ndoctrine/doctrine-cache-bundle suggests installing symfony/security-acl (For using this bundle to cache ACLs)\nsensio/framework-extra-bundle suggests installing symfony/psr-http-message-bridge (To use the PSR-7 converters)\nmonolog/monolog suggests installing aws/aws-sdk-php (Allow sending log messages to AWS services like DynamoDB)\nmonolog/monolog suggests installing doctrine/couchdb (Allow sending log messages to a CouchDB server)\nmonolog/monolog suggests installing ext-amqp (Allow sending log messages to an AMQP server (1.0+ required))\nmonolog/monolog suggests installing ext-mongo (Allow sending log messages to a MongoDB server)\nmonolog/monolog suggests installing graylog2/gelf-php (Allow sending log messages to a GrayLog2 server)\nmonolog/monolog suggests installing mongodb/mongodb (Allow sending log messages to a MongoDB server via PHP Driver)\nmonolog/monolog suggests installing php-amqplib/php-amqplib (Allow sending log messages to an AMQP server using php-amqplib)\nmonolog/monolog suggests installing php-console/php-console (Allow sending log messages to Google Chrome)\nmonolog/monolog suggests installing rollbar/rollbar (Allow sending log messages to Rollbar)\nmonolog/monolog suggests installing ruflin/elastica (Allow sending log messages to an Elastic Search server)\nmonolog/monolog suggests installing sentry/sentry (Allow sending log messages to a Sentry server)\ngecko-packages/gecko-php-unit suggests installing phpunit/phpunit (This is an extension for it so make sure you have it some way.)\neasyrdf/easyrdf suggests installing ml/json-ld (~1.0)\nbehat/mink suggests installing behat/mink-goutte-driver (fast headless driver for any app without JS emulation)\nbehat/mink suggests installing behat/mink-selenium2-driver (slow, but JS-enabled driver for any app (requires Selenium2))\nbehat/mink suggests installing behat/mink-zombie-driver (fast and JS-enabled headless driver for any app (requires node.js))\nbehat/behat suggests installing behat/yii-extension (for integration with Yii web framework)\nGenerating autoload files\n\nIncenteev\\ParameterHandler\\ScriptHandler::buildParameters\nCreating the \"app/config/parameters.yml\" file\nSome parameters are missing. Please provide them.\ndatabase_host (db): localhost\ndatabase_port (3306):\ndatabase_name (api_platform):\ndatabase_user (api_platform): root\ndatabase_password (api_platform):\nmailer_transport (smtp):\nmailer_host (127.0.0.1):\nmailer_user (null):\nmailer_password (null):\nsecret (ThisTokenIsNotSoSecretChangeIt): secret\ncors_allow_origin ('http://localhost'):\nvarnish_urls (['http://varnish']):\nSensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::clearCache\n\n// Clearing the cache for the dev environment with debug true\n[OK] Cache for the \"dev\" environment (debug=true) was successfully cleared.\n\nSensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installAssets\n\nInstalling assets as hard copies.\n\n   Bundle              Method / Error\n\n\nOK   ApiPlatformBundle   copy\n\n! [NOTE] Some assets were installed via copy. If you make changes to these assets you have to run this command again.\n[OK] All assets were successfully installed.\n\nSensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installRequirementsFile\nSensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::prepareDeploymentTarget\n\n```. Bonjour Dunglas,\nYes, i'm using PHP Version 7.1.13-1+ubuntu16.04.1+deb.sury.org+1, Ubuntu 16.04.3 LTS (Xenial Xerus), and i don't know if this issue already opened. I post another one in \"apiplatform-core\" section.\nThis issue already exist in my AP install. Someone tell me, when i change to production environement, this error will not be displayed.\nThanks Dunglas.\nHere is my composer.json\n```\n{\n    \"name\": \"api-platform/api-platform\",\n    \"license\": \"MIT\",\n    \"type\": \"project\",\n    \"description\": \"The API Platform framework\",\n    \"homepage\": \"https://api-platform.com\",\n    \"authors\": [\n        {\n            \"name\": \"K\u00e9vin Dunglas\",\n            \"email\": \"dunglas@gmail.com\",\n            \"homepage\": \"https://dunglas.fr\"\n        }\n    ],\n    \"autoload\": {\n        \"psr-4\": { \"\": \"src/\" },\n        \"classmap\": [ \"app/AppKernel.php\", \"app/AppCache.php\" ]\n    },\n    \"autoload-dev\": {\n        \"psr-4\": { \"Tests\\\": \"tests/\" }\n    },\n    \"require\": {\n        \"php\": \">=7.0\",\n        \"api-platform/core\": \"^2.1\",\n        \"doctrine/doctrine-bundle\": \"^1.6\",\n        \"doctrine/orm\": \"^2.5\",\n        \"guzzlehttp/guzzle\": \"^6.0\",\n        \"incenteev/composer-parameter-handler\": \"^2.0\",\n        \"nelmio/cors-bundle\": \"^1.4\",\n        \"phpdocumentor/reflection-docblock\": \"^3.0\",\n        \"sensio/distribution-bundle\": \"^5.0.19\",\n        \"sensio/framework-extra-bundle\": \"^3.0.2\",\n        \"symfony/monolog-bundle\": \"^3.1.0\",\n        \"symfony/swiftmailer-bundle\": \"^2.3.10\",\n        \"symfony/symfony\": \"3.3.*\",\n        \"twig/twig\": \"^1.0 || ^2.0\"\n    },\n    \"require-dev\": {\n        \"api-platform/schema-generator\": \"^1.0 || ^2.0\",\n        \"behat/behat\": \"^3.1\",\n        \"behat/mink\": \"^1.7\",\n        \"behat/mink-browserkit-driver\": \"^1.3.1\",\n        \"behat/mink-extension\": \"^2.2\",\n        \"behat/symfony2-extension\": \"^2.1\",\n        \"behatch/contexts\": \"^2.5\",\n        \"sensio/generator-bundle\": \"^3.0\",\n        \"symfony/phpunit-bridge\": \"^3.0\"\n    },\n    \"scripts\": {\n        \"symfony-scripts\": [\n            \"Incenteev\\ParameterHandler\\ScriptHandler::buildParameters\",\n            \"Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::clearCache\",\n            \"Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installAssets\",\n            \"Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installRequirementsFile\",\n            \"Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::prepareDeploymentTarget\"\n        ],\n        \"post-install-cmd\": [\n            \"@symfony-scripts\"\n        ],\n        \"post-update-cmd\": [\n            \"@symfony-scripts\"\n        ]\n    },\n    \"config\": {\n        \"sort-packages\": true\n    },\n    \"extra\": {\n        \"symfony-app-dir\": \"app\",\n        \"symfony-bin-dir\": \"bin\",\n        \"symfony-var-dir\": \"var\",\n        \"symfony-web-dir\": \"web\",\n        \"symfony-tests-dir\": \"tests\",\n        \"symfony-assets-install\": \"hard\",\n        \"incenteev-parameters\": {\n            \"file\": \"app/config/parameters.yml\"\n        },\n        \"branch-alias\": {\n            \"dev-master\": \"2.1-dev\"\n        }\n    }\n}\n```. This composer.json is a fresh AP 2.4 install. Hi,\nIt work fine, but this custom operation return the entity collection/item operations already filtered.\nHow to make a top ten book for example, instead of return the complete $data ,\nthanks\n. any idea ?. Sorry, it s me i wrong. I do not use the Entity name as return value. Hi \ud83d\udc4d \nIs there a way to do the same think, but with json format ?\nThanks a lot. ",
    "tsurowiec": "The same here - since RequestAttributesExtractor is marked as @internal - what is the proper way to extract the Resource from Request in our Listeners.. ",
    "piotrbrzezina": "thanks\nNow everything is clear. yes thank. Hi \nYou should use different serialization group for Foo and Bar class\n```\n<?php\nnamespace Vendor\\Bundle\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Component\\Serializer\\Annotation\\Groups;\n/\n * @ApiResource(attributes={\"normalization_context\"={\"groups\"={\"foo_get\"}}})\n * @ORM\\Entity\n * @ORM\\Table(name=\"foo\")\n */\nclass Foo\n{\n    /\n     * @ORM\\Column(type=\"guid\")\n     * @ORM\\Id\n     \n     * @Groups({\"foo_get\"})\n     /\n    protected $id;\n/**\n * @ORM\\Column(type=\"string\", length=25)\n *\n * @Groups({\"foo_get\"})\n */\nprotected $key;\n\n/**\n * @ORM\\Column(type=\"string\", length=25)\n *\n * @Groups({\"foo_get\"})\n */\nprotected $name;\n\n/**\n * @ORM\\Column(type=\"text\")\n *\n * @Groups({\"foo_get\"})\n */\nprotected $description;\n\n/**\n * @ORM\\Column(type=\"string\", length=25)\n */\nprotected $secret;\n\n/**\n * @ORM\\OneToMany(targetEntity=\"\\Vendor\\Bundle\\Entity\\Bar\", mappedBy=\"foo\")\n *\n * @Groups({\"foo_get\"})\n */\nprotected $bars;\n\n// getters and setters\n\n}\nBar\nphp\n\n<pnamespace Vendor\\Bundle\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse Doctrine\\Common\\Collections\\ArrayCollection;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Component\\Serializer\\Annotation\\Groups;\nuse Symfony\\Component\\Validator\\Constraints as Assert;\n/\n * @ApiResource(attributes={\"normalization_context\"={\"groups\"={\"bar_get\"}}})\n * @ORM\\Entity\n * @ORM\\Table(name=\"bar\")\n */\nclass Bar\n{\n    /\n     * @ORM\\Column(type=\"guid\")\n     * @ORM\\Id\n     \n     * @Groups({\"bar_get\"})\n     /\n    protected $id;\n/**\n * @ORM\\Column(type=\"string\", length=25)\n *\n * @Groups({\"bar_get\"})\n */\nprotected $key;\n\n/**\n * @ORM\\Column(type=\"string\", length=25)\n *\n * @Groups({\"bar_get\"})\n */\nprotected $name;\n\n/**\n * @ORM\\Column(type=\"text\")\n *\n * @Groups({\"bar_get\"})\n */\nprotected $description;\n\n/**\n * @ORM\\Column(type=\"text\")\n */\nprotected $hidden;\n\n/**\n * @ORM\\ManyToOne(targetEntity=\"\\Vendor\\Bundle\\Entity\\Foo\", inversedBy=\"bars\")\n * @ORM\\JoinColumn(name=\"foo_id\", referencedColumnName=\"id\")\n *\n * @Groups({\"bar_get\"})\n */\nprotected $foo;\n\n// getters and setters\n\n}\n```\n. ",
    "djoos": "Perfect - got it, thanks!. Unfortunately that throws the following exception: Couldn't find constant shortName, class Path\\\\To\\\\Entity\\\\Blurb.\nFYI: 2.0.0-rc.6\n. Sorry, scrap my previous reply... #facepalm\nUsing * @ApiResource(shortName=\"FooBar\") results in having \"fooBar\": \"/foo_bar\" when checking the entrypoint - thanks for your quick feedback!\nDavid. Perfect, works like a treat; additionally also injecting the api_platform.collection.pagination.items_per_page-parameter so to use as a default when not set on the resource.\nThanks, have a great day!\nDavid. Hi @mvigneron,\nsure! Here are some snippets to get you on the way...\nFYI: we're still on v2.0.11 of api-platform/core.\nThe custom DataProvider's getCollection method:\n```php\nuse Escape\\PaginatorBundle\\Lib\\Pagerfanta; // see below\nuse Pagerfanta\\Adapter\\DoctrineCollectionAdapter;\npublic function getCollection(string $resourceClass, string $operationName = null)\n{\n    if(!$this->supports($resourceClass)) {\n        throw new ResourceClassNotSupportedException();\n    }\n$request = $this->requestStack->getCurrentRequest();\n\n$ac = new ArrayCollection();\n\nif(!empty($this->data)) {\n    foreach($this->data as $element) {\n        $ac->add($element);\n    }\n\n    if(!empty($request->query->all()))\n    {\n        foreach ($request->query->all() as $k => $v) {\n            $ac = $this->filter($k, $v, $ac);\n        }\n    }\n}\n\n$adapter = new DoctrineCollectionAdapter($ac);\n$pagerfanta = new Pagerfanta($adapter);\n\n$resourceMetadata = $this->resourceMetadataFactory->create($resourceClass);\n\n$pagerfanta->setMaxPerPage(\n    (int) $request->get(\n        $this->itemsPerPageParameter,\n        $resourceMetadata->getCollectionOperationAttribute(\n            $operationName,\n            'pagination_items_per_page',\n            $this->globalItemsPerPage,\n            true\n        )\n    )\n);\n\n$pagerfanta->setCurrentPage((int) $request->get($this->pageParameter, 1));\n\nreturn $pagerfanta;\n\n}\n```\nSo, the actual pagination logic is handled by Pagerfanta, which we've slightly tweaked to work with the ApiPlatform's PaginatorInterface:\n```php\nnamespace Escape\\PaginatorBundle\\Lib;\nuse ApiPlatform\\Core\\DataProvider\\PaginatorInterface;\nuse Pagerfanta\\Pagerfanta as BasePagerfanta;\nclass Pagerfanta extends BasePagerfanta implements PaginatorInterface\n{\n    /\n     * Gets the current page number\n     \n     * @return float\n     /\n    public function getCurrentPage(): float {\n        return parent::getCurrentPage();\n    }\n/**\n * Gets the last page\n *\n * @return float\n */\npublic function getLastPage(): float {\n    return parent::getNbPages();\n}\n\n/**\n * Gets the number of items by page\n *\n * @return float\n */\npublic function getItemsPerPage(): float {\n    return parent::getMaxPerPage();\n}\n\n/**\n * Gets the number of items in the whole collection\n *\n * @return float\n */\npublic function getTotalItems(): float {\n    return parent::getNbResults();\n}\n\n}\n```\nAnd the pagination_items_per_page is set in config.yml as follows:\nyml\napi_platform:\n    collection:\n        pagination:\n            items_per_page: 20\nHope this helps!\nPlease do give me a shout if you have any further questions or remarks! (it's always great to have someone else read through and improve the code :-) )\nHave a great day!\nDavid. Hi Mikael,\nI'm glad it was useful for you to get going!\nHave a great day!\nDavid. Hi @Simperfit,\nsure, here is a more detailed illustration of the issue, including some dummy entities:\nFoo\n```\n<?php\nnamespace Vendor\\Bundle\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Component\\Serializer\\Annotation\\Groups;\n/\n * @ApiResource(attributes={\"normalization_context\"={\"groups\"={\"get\"}}})\n * @ORM\\Entity\n * @ORM\\Table(name=\"foo\")\n */\nclass Foo\n{\n    /\n     * @ORM\\Column(type=\"guid\")\n     * @ORM\\Id\n     \n     * @Groups({\"get\"})\n     /\n    protected $id;\n/**\n * @ORM\\Column(type=\"string\", length=25)\n *\n * @Groups({\"get\"})\n */\nprotected $key;\n\n/**\n * @ORM\\Column(type=\"string\", length=25)\n *\n * @Groups({\"get\"})\n */\nprotected $name;\n\n/**\n * @ORM\\Column(type=\"text\")\n *\n * @Groups({\"get\"})\n */\nprotected $description;\n\n/**\n * @ORM\\Column(type=\"string\", length=25)\n */\nprotected $secret;\n\n/**\n * @ORM\\OneToMany(targetEntity=\"\\Vendor\\Bundle\\Entity\\Bar\", mappedBy=\"foo\")\n *\n * @Groups({\"get\"})\n */\nprotected $bars;\n\n// getters and setters\n\n}\n```\nBar\n```\n<?php\nnamespace Vendor\\Bundle\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse Doctrine\\Common\\Collections\\ArrayCollection;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Component\\Serializer\\Annotation\\Groups;\nuse Symfony\\Component\\Validator\\Constraints as Assert;\n/\n * @ApiResource(attributes={\"normalization_context\"={\"groups\"={\"get\"}}})\n * @ORM\\Entity\n * @ORM\\Table(name=\"bar\")\n */\nclass Bar\n{\n    /\n     * @ORM\\Column(type=\"guid\")\n     * @ORM\\Id\n     \n     * @Groups({\"get\"})\n     /\n    protected $id;\n/**\n * @ORM\\Column(type=\"string\", length=25)\n *\n * @Groups({\"get\"})\n */\nprotected $key;\n\n/**\n * @ORM\\Column(type=\"string\", length=25)\n *\n * @Groups({\"get\"})\n */\nprotected $name;\n\n/**\n * @ORM\\Column(type=\"text\")\n *\n * @Groups({\"get\"})\n */\nprotected $description;\n\n/**\n * @ORM\\Column(type=\"text\")\n */\nprotected $hidden;\n\n/**\n * @ORM\\ManyToOne(targetEntity=\"\\Vendor\\Bundle\\Entity\\Foo\", inversedBy=\"bars\")\n * @ORM\\JoinColumn(name=\"foo_id\", referencedColumnName=\"id\")\n *\n * @Groups({\"get\"})\n */\nprotected $foo;\n\n// getters and setters\n\n}\n```\nWhen requesting /bars the returned collection doesn't include the \"hidden\"-attribute and when requesting /foos the returned collection doesn't include the \"secret\". That is as expected.\nHowever, when requesting '/bars' the id, key, name, description and bars of foo are included as an embedded related object:\n{\n    \"@context\": \"\\contexts\\Bar\",\n    \"@id\": \"\\bars\",\n    \"@type\": \"hydra:Collection\",\n    \"hydra:member\": [\n        {\n            \"@id\": \"\\bars\\7a06db7d-c565-48a9-acf1-33b7c96c0601\",\n            \"@type\": \"Bar\",\n            \"id\": \"7a06db7d-c565-48a9-acf1-33b7c96c0601\",\n            \"key\": \"some key\",\n            \"name\": \"some name\",\n            \"description\": \"some description\",\n            **\n            \"foo\": {\n                \"@id\": \"\\foos\\5d2eb233-5dee-4bff-b2d5-c509f75e0791\",\n                \"@type\": \"Foo\",\n                \"id\": \"5d2eb233-5dee-4bff-b2d5-c509f75e0791\",\n                \"key\": \"some key\",\n                \"name\": \"some name\",\n                \"description\": \"some description\",\n                \"bars\": [\n                    \"\\bars\\7a06db7d-c565-48a9-acf1-33b7c96c0601\"\n                ]\n            }\n            **\n        }\n    ],\n    \"hydra:totalItems\": 1,\n    \"hydra:view\": {\n        \"@id\": \"\\bars\",\n        \"@type\": \"hydra:PartialCollectionView\"\n    }\n}\n...instead of only a dereferencable IRI to foo:\n{\n    \"@context\": \"\\contexts\\Bar\",\n    \"@id\": \"\\bars\",\n    \"@type\": \"hydra:Collection\",\n    \"hydra:member\": [\n        {\n            \"@id\": \"\\bars\\7a06db7d-c565-48a9-acf1-33b7c96c0601\",\n            \"@type\": \"Bar\",\n            \"id\": \"7a06db7d-c565-48a9-acf1-33b7c96c0601\",\n            \"key\": \"some key\",\n            \"name\": \"some name\",\n            \"description\": \"some description\",\n            **\n            \"foo\": \"/foos/5d2eb233-5dee-4bff-b2d5-c509f75e0791\"\n            **\n        }\n    ],\n    \"hydra:totalItems\": 1,\n    \"hydra:view\": {\n        \"@id\": \"\\bars\",\n        \"@type\": \"hydra:PartialCollectionView\"\n    }\n}\nPlease do not hesitate to ask for further examples if needed - thanks in advance for your feedback!\nKind regards,\nDavid. Thank you @piotrbrzezina, that did the trick!\nFYI: I should have read up more on Symfony's serialization groups first though, as I hadn't used them before...\nThanks again for your help!\nDavid. Amazing - I'll dig deeper into it and consider writing up some docs & submitting a PR.\nThank you!. ",
    "mvigneron": "Hi @djoos ,\nLike you, I would like to have pagination in my custom data provider (get results from ElasticSearch) but I don't know what is the best way to do it. Do you can tell me how you did it ? if you have a code example, it would be very great ;-)\nThanks. Hi @djoos \nThanks for your help !\nMy case in a bit different of you because I want to search with elasticSearch, not with doctrine but your example had help me a lot.\ncustom Data provider : \n```\nnamespace AppBundle\\DataProvider;\nuse ApiPlatform\\Core\\DataProvider\\CollectionDataProviderInterface;\nuse ApiPlatform\\Core\\Exception\\ResourceClassNotSupportedException;\nuse ApiPlatform\\Core\\Metadata\\Resource\\Factory\\ResourceMetadataFactoryInterface;\nuse AppBundle\\Entity\\Offer;\nuse AppBundle\\Entity\\Shop;\nuse AppBundle\\Service\\SearcherService;\nuse Symfony\\Component\\HttpFoundation\\RequestStack;\nclass ElasticsearchCollectionDataProvider implements CollectionDataProviderInterface\n{\n    private $searcherService;\n    private $requestStack;\n    private $resourceMetadataFactory;\n    private $itemsPerPageParameter;\n    private $globalItemsPerPage;\n    private $pageParameter;\npublic function __construct(SearcherService $searcherService,RequestStack $requestStack,ResourceMetadataFactoryInterface $resourceMetadataFactory,int $itemsPerPage = 30,int $globalItemsPerPage = 30)\n{\n    $this->searcherService = $searcherService;\n    $this->requestStack = $requestStack;\n    $this->resourceMetadataFactory = $resourceMetadataFactory;\n    $this->itemsPerPageParameter = $itemsPerPage;\n    $this->globalItemsPerPage = $globalItemsPerPage;\n    $this->pageParameter = \"page\";\n}\n\n/**\n * Retrieves a collection.\n *\n * @param string $resourceClass\n * @param string|null $operationName\n *\n * @throws ResourceClassNotSupportedException\n *\n * @return array|\\Traversable\n */\npublic function getCollection(string $resourceClass, string $operationName = null)\n{\n    // Add here all entities that's you want to query with ElasticSearch\n    if (!in_array($resourceClass, [Shop::class,Offer::class])) {\n        throw new ResourceClassNotSupportedException();\n    }\n    $request = $this->requestStack->getCurrentRequest();\n\n    $index = explode('\\\\', $resourceClass);\n    $index = strtolower(end($index));\n\n    $filters = $request->query->all();\n\n    // Results is a PagerFanta\n    $results = $this->searcherService->search($index,$filters);\n\n    $resourceMetadata = $this->resourceMetadataFactory->create($resourceClass);\n\n    $results->setMaxPerPage(\n        (int) $request->get(\n            $this->itemsPerPageParameter,\n            $resourceMetadata->getCollectionOperationAttribute(\n                $operationName,\n                'pagination_items_per_page',\n                $this->globalItemsPerPage,\n                true\n            )\n        )\n    );\n\n    $results->setCurrentPage((int) $request->get($this->pageParameter, 1));\n\n    return $results;\n}\n\n}\n```\nSearcher Service : \n```\nnamespace AppBundle\\Service;\nuse AppBundle\\Bridge\\ElasticSearch\\PagerFanta;\nuse FOS\\ElasticaBundle\\Manager\\RepositoryManager;\nclass SearcherService\n{\n    public $respositoryManager;\npublic function __construct(RepositoryManager $repositoryManager)\n{\n    $this->respositoryManager = $repositoryManager;\n}\n\npublic function search($entityName,$filters) : PagerFanta {\n    $repository = $this->getRepository($entityName);\n\n    $results = $repository->findWithCustomQuery($filters);\n    return $results;\n}\n\n/**\n * @param $entityName\n * @return \\FOS\\ElasticaBundle\\Repository\n *\n * TODO REFACTORING\n */\nprivate function getRepository($entityName){\n    $repositoryName = \"api_\".$entityName.\"s/\".$entityName;\n    return $this->respositoryManager->getRepository($repositoryName);\n}\n\n}\n```\nExample ShopRepository : \n```\nnamespace AppBundle\\SearchRepository;\nuse ApiPlatform\\Core\\Exception\\InvalidArgumentException;\nuse Doctrine\\Common\\Collections\\ArrayCollection;\nuse Elastica\\Query;\nuse Elastica\\Query\\BoolQuery;\nuse Elastica\\Query\\GeoDistance;\nuse Elastica\\Query\\MatchAll;\nuse Elastica\\Query\\MultiMatch;\nuse Elastica\\Query\\Nested;\nuse Elastica\\Query\\Terms;\nuse Elastica\\Script\\Script;\nuse Elastica\\Script\\ScriptFields;\nuse FOS\\ElasticaBundle\\Repository;\nuse Pagerfanta\\Adapter\\DoctrineCollectionAdapter;\nclass ShopRepository extends Repository\n{\n    public function findWithCustomQuery($filters)\n    {\n    //Construct elastic query with filters\n    .....\n\n\n    $finalQuery = new Query($query);\n\n    $hybridResults = $this->findHybrid($finalQuery,100);\n    $shops = new ArrayCollection();\n\n    foreach ($hybridResults as $hybridResult) {\n        $shop = $hybridResult->getTransformed();\n        $result = $hybridResult->getResult();\n        foreach($result->getFields() as $key=>$field) {\n            $shop->$key = count($field) == 1 ? $field[0] : $field;\n        }\n        $shops->add($shop);\n    }\n    $dca = new DoctrineCollectionAdapter($shops);\n    return new \\AppBundle\\Bridge\\ElasticSearch\\PagerFanta($dca);\n}\n\n} \n```\nThanks\nHave a great Day\nMikael\n. @devrck \nI'm also interested how we can create custom filter and apply it in a custom data provider, do you have implemented that ? Do you have an code example please ?\nI would like to query with ElasticSearch my entity \"Shop\" with a custom filter (term) like that \nhttp://localhost/api/shops?term=foo\nThis request must return all shops entities where attributes \"name\" or/and\"description\" contains \"foo\"\nThanks. Hi @devrck ,\nmaybe I don't understand utility of custom Filter and custom provider because, in my case, I don't know why I must inject the filter in the data provider.\nin my case, I have a custom filter to accept a filter properties \"term\" and I have a custom data provider to search and get results in Elastic Search. In my custom data provider, I inject RequestStack to get my parameter \"term\" and call a service to get Results with this parameter.\nCan you show me your custom filter and custom data provider to understand ?\nThanks. Hi @Simperfit \nI have a custom filter that I use in my custom provider but I don't know if it's the best solution.\n```\nclass CustomShopFilter implements FilterInterface\n{\n/**\n * Gets the description of this filter for the given resource.\n *\n * Returns an array with the filter parameter names as keys and array with the following data as values:\n *   - property: the property where the filter is applied\n *   - type: the type of the filter\n *   - required: if this filter is required\n *   - strategy: the used strategy\n *   - swagger (optional): additional parameters for the path operation,\n *     e.g. 'swagger' => [\n *       'description' => 'My Description',\n *       'name' => 'My Name',\n *       'type' => 'integer',\n *     ]\n * The description can contain additional data specific to a filter.\n *\n * @see \\ApiPlatform\\Core\\Swagger\\Serializer\\DocumentationNormalizer::getFiltersParameters\n *\n * @param string $resourceClass\n *\n * @return array\n */\npublic function getDescription(string $resourceClass): array\n{\n    $description = [\n        'term' => [\n            'type' => 'string',\n            'required' => false,\n            'property' => 'term',\n            'swagger' => [\n                'description' => 'Filter to search in name,description, product name, product description',\n                'name' => 'term',\n                'type' => 'string',\n            ],\n        ],\n        'categories[]' => [\n            'type' => 'string',\n            'required' => false,\n            'property' => 'categories',\n            'swagger' => [\n                'description' => 'categories filter',\n                'name' => 'categories[]',\n                'type' => 'string',\n            ],\n        ],\n        'geoloc[]' => [\n            'type' => 'string',\n            'required' => false,\n            'property' => 'geoloc',\n            'swagger' => [\n                'description' => 'geolocalisation filter [latitude,longitude,distance]',\n                'name' => 'geoloc[]',\n                'type' => 'string',\n            ],\n        ],\n    ];\n\n    return $description;\n}\n\n}\n```\n```\nclass ElasticsearchCollectionDataProvider implements CollectionDataProviderInterface\n{\n    private $searcherService;\n    private $requestStack;\n    private $resourceMetadataFactory;\n    private $itemsPerPageParameter;\n    private $globalItemsPerPage;\n    private $pageParameter;\npublic function __construct(SearcherService $searcherService,RequestStack $requestStack,ResourceMetadataFactoryInterface $resourceMetadataFactory,int $itemsPerPage = 30,int $globalItemsPerPage = 30)\n{\n    $this->searcherService = $searcherService;\n    $this->requestStack = $requestStack;\n    $this->resourceMetadataFactory = $resourceMetadataFactory;\n    $this->itemsPerPageParameter = $itemsPerPage;\n    $this->globalItemsPerPage = $globalItemsPerPage;\n    $this->pageParameter = \"page\";\n}\n\n/**\n * Retrieves a collection.\n *\n * @param string $resourceClass\n * @param string|null $operationName\n *\n * @throws ResourceClassNotSupportedException\n *\n * @return array|\\Traversable\n */\npublic function getCollection(string $resourceClass, string $operationName = null)\n{\n    // Add here all entities that's you want to query with ElasticSearch\n    if (!in_array($resourceClass, [Shop::class,Offer::class])) {\n        throw new ResourceClassNotSupportedException();\n    }\n    $request = $this->requestStack->getCurrentRequest();\n\n    $index = explode('\\\\', $resourceClass);\n    $index = strtolower(end($index));\n\n    $filters = $request->query->all();\n\n    // Results is a PagerFanta\n\n\n    $results = $this->searcherService->search($index,$filters);\n\n    $resourceMetadata = $this->resourceMetadataFactory->create($resourceClass);\n\n    $results->setMaxPerPage(\n        (int) $request->get(\n            $this->itemsPerPageParameter,\n            $resourceMetadata->getCollectionOperationAttribute(\n                $operationName,\n                'pagination_items_per_page',\n                $this->globalItemsPerPage,\n                true\n            )\n        )\n    );\n\n    $results->setCurrentPage((int) $request->get($this->pageParameter, 1));\n\n    return $results;\n}\n\n}\n```. thanks @jewome62 \nI had already see it but this article doesn't show how implement pagination with custom data provider.\nDo you have implemented it ? Do you can show me an example of code ?\nThanks. Hello,\nDid you find a solution ? I have a same issue. \naccess_control on subressources doesn't work...\nI have configurated my entity like that : \n/**\n * @ApiResource(\n *     attributes={\n *      \"normalization_context\"={\"groups\"={\"shop_client_bookmark_output\"}},\n *      \"denormalization_context\"={\"groups\"={\"shop_client_bookmark_input\"}}\n *     },\n *     collectionOperations={\n *          \"post\"=\n *          {\n *              \"method\"=\"POST\",\n *              \"access_control\"=\"has_role('ROLE_ADMIN') or (has_role('ROLE_CLIENT') and user and object.client==user)\",\n *              \"access_control_message\"=\"You must be the owner to add this bookmark.\"\n *          },\n *          \"api_clients_shop_bookmarks_get_subresource\"=\n *          {\n *              \"method\"=\"GET\",\n *              \"access_control\"=\"has_role('ROLE_OAUTH_AUTHENTICATED')\",\n *              \"access_control_message\"=\"sub access\",\n*               \"normalization_context\"={\"groups\"={\"client_shop_bookmarks\"}}\n *          }\n *     },\n *     itemOperations={\n *      \"get\"={\"method\"=\"GET\",\"access_control\"=\"has_role('ROLE_OAUTH_AUTHENTICATED')\"},\n *      \"delete\"={\"method\"=\"DELETE\",\"access_control\"=\"has_role('ROLE_ADMIN') or (has_role('ROLE_CLIENT') and user and object.client==user)\"}\n *     }\n * )\n. Hi, yes Just after I posted my message, I found this solution\n@ApiResource(\n *     subresourceOperations={\n *          \"api_clients_shop_bookmarks_get_subresource\"= {\n *              \"method\"=\"GET\",\n *              \"access_control\"=\"has_role('ROLE_OAUTH_AUTHENTICATED')\"\n *          }\n *      }\n * )\nApi docs is not exhaustive about that\nThanks. Yes @soyuka , no problem,  when I will have a little more time, I will help you with pleasure ;-) \nFor the moment, I have to develop my startup... . Ok thanks @dunglas \nI didn't see this doc...\nI'm going to see that\nSo, we define environment variables directly in Kubernets Pod, right ? . Thanks @Simperfit . Ok, i saw the problem with symfony profiler.\nRequest /client_shop_bookmarks (GET) use the route \"api_clients_shop_bookmarks_get_subresource\" and use my access_control (acces denied ok)\nRequest /clients/1/shop_bookmarks (GET) use the route \"api_clients_shop_bookmarks_get_subresource\" but don't use my access_control\nI don't understand...\nCan you explain me please ?. ",
    "nckenn": "\nHi @mvigneron,\nsure! Here are some snippets to get you on the way...\nFYI: we're still on v2.0.11 of api-platform/core.\nThe custom DataProvider's getCollection method:\n```\nuse Escape\\PaginatorBundle\\Lib\\Pagerfanta; // see below\nuse Pagerfanta\\Adapter\\DoctrineCollectionAdapter;\npublic function getCollection(string $resourceClass, string $operationName = null)\n{\n    if(!$this->supports($resourceClass)) {\n        throw new ResourceClassNotSupportedException();\n    }\n$request = $this->requestStack->getCurrentRequest();\n\n$ac = new ArrayCollection();\n\nif(!empty($this->data)) {\n    foreach($this->data as $element) {\n        $ac->add($element);\n    }\n\n    if(!empty($request->query->all()))\n    {\n        foreach ($request->query->all() as $k => $v) {\n            $ac = $this->filter($k, $v, $ac);\n        }\n    }\n}\n\n$adapter = new DoctrineCollectionAdapter($ac);\n$pagerfanta = new Pagerfanta($adapter);\n\n$resourceMetadata = $this->resourceMetadataFactory->create($resourceClass);\n\n$pagerfanta->setMaxPerPage(\n    (int) $request->get(\n        $this->itemsPerPageParameter,\n        $resourceMetadata->getCollectionOperationAttribute(\n            $operationName,\n            'pagination_items_per_page',\n            $this->globalItemsPerPage,\n            true\n        )\n    )\n);\n\n$pagerfanta->setCurrentPage((int) $request->get($this->pageParameter, 1));\n\nreturn $pagerfanta;\n\n}\n```\nSo, the actual pagination logic is handled by Pagerfanta, which we've slightly tweaked to work with the ApiPlatform's PaginatorInterface:\n```\nnamespace Escape\\PaginatorBundle\\Lib;\nuse ApiPlatform\\Core\\DataProvider\\PaginatorInterface;\nuse Pagerfanta\\Pagerfanta as BasePagerfanta;\nclass Pagerfanta extends BasePagerfanta implements PaginatorInterface\n{\n    /\n     * Gets the current page number\n     \n     * @return float\n     /\n    public function getCurrentPage(): float {\n        return parent::getCurrentPage();\n    }\n/**\n * Gets the last page\n *\n * @return float\n */\npublic function getLastPage(): float {\n    return parent::getNbPages();\n}\n\n/**\n * Gets the number of items by page\n *\n * @return float\n */\npublic function getItemsPerPage(): float {\n    return parent::getMaxPerPage();\n}\n\n/**\n * Gets the number of items in the whole collection\n *\n * @return float\n */\npublic function getTotalItems(): float {\n    return parent::getNbResults();\n}\n\n}\n```\nAnd the pagination_items_per_page is set in config.yml as follows:\nyaml\napi_platform:\n    collection:\n        pagination:\n            items_per_page: 20\nHope this helps!\nPlease do give me a shout if you have any further questions or remarks! (it's always great to have someone else read through and improve the code :-) )\nHave a great day!\nDavid\n\nMay i see the filter function?\n`. ",
    "jaceksieja": "Hey all,\nI had the same problem in \"Symfony Flex\" project structure and I resolved them by adding in framework config option:\nyml\nframework:\n    serializer:\n        enabled: true\n        mapping:\n            paths: ['%kernel.project_dir%/config/serialization/']\nI hope that it will help someone. ",
    "videni": "@Simperfit , I try your solution , but it doesn't work.\nframework: \n    serializer:\n            enabled: true\n            mapping:\n                paths: ['%kernel.project_dir%/config/serializer/']\nfile structur\nconfig/serializer\n- User.php\n```\nApp\\Entity\\User:\n    attributes:\n        id:\n            groups: ['REWD']\n        username:\n            groups: ['REWD', 'WRITE']\n        email:\n            groups: ['REWD', 'WRITE']\n. this code looks very ugly , can api platform provider a better way?. @Sybio, hi\uff0c I try your solution , but my UserItemDataProvider never executed\napp.user.item_data_provider:\n        class: App\\Bundle\\UserBundle\\DataProvider\\UserItemDataProvider\n        public: true\n        arguments:\n            - '@App\\Bundle\\UserBundle\\Repository\\UserRepository'\n            - '@security.token_storage'\n        tags:\n            -  { name: 'api_platform.item_data_provider' }\n. also this solution will not work at v2.3.0 , the following will throw exception if no id found\n try {\n            $identifiers = $this->extractIdentifiers($request->attributes->all(), $attributes);\n        if (isset($attributes['item_operation_name'])) {\n            $data = $this->getItemData($identifiers, $attributes, $context);\n        } elseif (isset($attributes['subresource_operation_name'])) {\n            // Legacy\n            if (null === $this->subresourceDataProvider) {\n                throw new RuntimeException('No subresource data provider.');\n            }\n\n            $data = $this->getSubresourceData($identifiers, $attributes, $context);\n        }\n    }\n\n```. @teohhanhui, no problem,  I end up using symfony form without serialization. this can be closed.. @gries , I don't understand what your meaning,  how do you validate taxon is existed when  create a product using Api platform way?I can think of  writing a custom constraint. Also how do you transform taxon_id to taxon entity and add it to taxons property of product? Symfony form can solve these problems very easily .. @soyuka , thank you so much, I know how to do that now.. I thinks this is a known issue. . @meyerbaptiste , yep,  now I replace ExceptionAction service my custom one which will hide stack trace if the environment is prod. @dunglas , thanks for you very detail explanation. . currently, we still use hal+json , we are ready for json-ld, it add extra complex to our team. @dunglas , for example , when a user try to view a resource, I need to show edit link if he has edit permission. also , I may need to associate other resource links. they are completely different resources.. The weblink can't cover all my cases,it simply gives a way to add related links to header. \n1. for get method\nconfigure available operations in entity serialization \n\nfor post  method\n\nfor example , a user create a post,  a normal user may have save to draft button, but as administrator, he might has a publish button. in this situation, we need to get some metadata beforehand, what links are available for create form, what fields available for current user?\n\nfor put method\nwe can get these information when user make a request\n. I create  LinkRelationBundle that integrates  willdurand/hateoas-bundle into api-paltfom. @dunglas , seems no one has this trouble\uff0chow do you solve this please?. @Lobosque , I create a dedicated denormalizer which will unset the key of the date time attribute     if user submit an empty date time. as the example below,  currently I hard coded the key 'expires_at' for I only have one entity to deal with, if you have  several attributes you can  add configuration yourself.\n``` \nuse Symfony\\Component\\Serializer\\Normalizer\\DenormalizerInterface;\n\nclass EmptyDateTimeDenormalizer implements DenormalizerInterface\n{\n    private $decorated;\npublic function __construct(\n    ItemNormalizer $decorated\n) {\n    $this->decorated = $decorated;\n}\n\npublic function denormalize($data, $class, $format = null, array $context = [])\n{\n    $data = $this->removeEmptyDateTime($data, $class);\n\n    return $this->decorated->denormalize($data, $class, $format, $context);\n}\n\nprivate function removeEmptyDateTime($data, $type)\n{\n    if ($type == User::class && isset($data['expires_at']) && $data['expires_at'] == '') {\n        unset($data['expires_at']);\n    }\n\n    return $data;\n}\n\n}\n. never mind, I found the answer, it is the ResourceClassResolver . what item operation you want to disable? . for your case if you want to remove put item operation,  you can simply remove it.. @dunglas \uff0cplease let us to decide if  an entity should be dereferencable or not, don't fore us to do this. an entity ,when it is used for admin user, it  is  dereferencable, but when it is used for customer, it might not.  api-platform gives me lots of troubles because of this design.. @dunglas , nope, my situation is more complex.  for customer, I only want to show api_account_order_view in links relation, but for admin , I want to show api_admin_order_view, both routes are added to Order resource  item operation,  their paths are different.. @dunglas , now I am trying to disable  api-platfom links relation, use \"willdurand/hateoas\" instead.. @dunglas it would be nice if we can add relation like this, so we don't need to write extra normalizer for every entity.\nApp\\AppBundle\\View\\OrderView:\n    relations:\n        - rel: self\n          href:\n            route: api_shop_account_order_view\n            parameters:\n                code: expr(object.getId())\n          exclusion:\n            groups: [Details]\n. now I add  api link relation using this bundle  [LinkRelationBundle](https://github.com/videni/LinkRelationBundle). @dunglas , only get operation need item operation, it is best to allow us to specify it like this\nApp\\Bundle\\OrderBundle\\Entity\\Order:\n    collectionOperations:\n            get:\n                path: '/admin/orders'\n                access_control: is_granted('app_order_view')\n                force_eager: false\n                normalization_context:\n                    groups: [ \"Details\"]\n                    enable_max_depth: true\n                iri: 'api_orders_get_item'\n    itemOperations:\n            get:\n                path: '/admin/orders/{id}'\n                access_control: is_granted('app_order_view')\n```\n. ",
    "diimpp": "@Simperfit \nPlease consider adding information about serializer mappings https://github.com/api-platform/api-platform/issues/184#issuecomment-334961642 into documentation. \nSymfony documentation doesn't say anything about it and it's a sole mention on the internet on how to make symfony serializer with yaml config to work with bundless structure.. @dunglas Sure\n@GregoireHebert just re-checked, it only says about api_platform mappings, not about symfony serializer mappings.. @dunglas I think we're talking about different things. \nFollow this url and it should be clear what I'm talking about. https://github.com/api-platform/api-platform/issues/184#issuecomment-334961642. ",
    "GregoireHebert": "@diimpp it has already been done : https://api-platform.com/docs/core/getting-started\n@videni your file should be User.yaml not User.php and you are missing a level in your YAML file:\nresources:\n    App\\Entity\\User:\n        attributes:\n            id:\n                groups: ['REWD']\n            username:\n                groups: ['REWD', 'WRITE']\n            email:\n                groups: ['REWD', 'WRITE']. Pagination is enabled by default and only set a total item in your response until the number of resources exceed 30 (the default pagination value). Then you'll get the various elements you need for pagination, such as first page, last page etc. Since you need Api-Platform to handle the Response for you, just be sure you don't return a Response from your controller but the actual data you need. Other thing, regardless the way you do it (controller / dataprovider) you need to be return something countable. other it cannot set the pagination. Other way to go is to use a doctrine Paginator as mentionned by soyuka before.. Hey @bitcoinporn !\nApi platform now support filter for graphql ;)\nTake a look here ! https://github.com/api-platform/core/pull/1633 . It should work without touching at the docker-compose.yml.\nplease check that the bundle webonyx/graphql-php is correctly activated.\ncheck that the route graphql is available through docker-compose exec app bin/console debug:router\nthen check clearing your cache.\nDon't hesitate to reload you docker by doing a stop then up It might act weird sometime.\nGraphQL is still in BETA and should not be used in production for now.. Bonjour @abysKri,\nNavr\u00e9 que vous n'ayez pas trouv\u00e9 parmi les r\u00e9ponses re\u00e7ues les \u00e9l\u00e9ments qui vous permettraient d'avancer dans votre projet.\nN'h\u00e9sitez pas \u00e0 aller regarder la documentation qui je l'esp\u00e8re, saura vous d\u00e9bloquer de la plupart des situations \u00e9pineuses que vous recontrez.\nSi toutefois vous \u00eates dans des cas d'utilisations tr\u00e8s particuliers et/ou tr\u00e8s avanc\u00e9s, n'h\u00e9sitez pas \u00e0 nous contacter dans le cadre d'une intervention de coaching / formation.\nBien \u00e0 vous.. Hi @anacicconi, this is something really missing right now and yes you can indeed create a custom filter at the moment. \nThere is an issue opened in the api-platform/core#1832 to fill the gap :)\n. I would go for a custom filter. Maybe @Simperfit has a different POV on this ?. @Larzack @slipo As it is right now, API Platform does not handle subscriptions as you would expect.\nBut, as @dunglas told you, he was working on something. That something is Mercure. You can find more informations in it's repository https://github.com/dunglas/mercure . This is a solution that is already used in production, do not hesitate to give it a go. It's integrated with API Platform and Symfony, you can take a look at Kevin's slides from Lisbon SymfonyCon. API Platform is trying to map a ScenarioCard from your custom operation path. For this it need a parameter called id. You need to change  your configuration from \"path\"=\"/scenario/{scenario_id}/card/{card_id}\", to \"path\"=\"/scenario/{id}/card/{card_id}\", so it can retrieve it for you.. Still you'll need to get the card by yourself.\nI suggest you to rename the card section to cards to fit the url definition pattern. so your path would look like \"path\"=\"/scenario/{id}/cards/{card_id}\".\nCould it be a nice addition to the API Platform subresources ?\nAnyhow it feels weird to ask for a resource from another one.. I think you'll need to fetch the data by yourself with a dataProvider, and you'll need to add _api_receive at false for this operation. otherwise it'll try to get it automatically.. Please be sure to be on API-Platform 2.4 to be able to use this property :). ",
    "benbender": "That's what I was thinking about. One could also try to build dynamic forms out of the mapping definitions for post-actions. I'm surprised that nobody did some work in this direction, because, at least in my opinion, it would be a killer-feature which could possibly reduce the boilerplate-code in many projects massively. @dunglas, thanks for your awesome work and the fast response!. ",
    "Linkinou": "By default, Docker containers are executed as root.\nSo if you execute a command through a docker container, it will be executed by the root User.\nA workaround for me is a simple alias : \nproject-chown='docker-compose exec web chown -R www-data:www-data var/logs/ var/cache/'\nBut the best thing to do IMHO would be to change the User in the Dockerfile.. ",
    "Stoakes": "Hello,\nI had the same issue.\nIt comes from composer install executed as root in docker/start.sh\nTo solve that, I added after composer call in start.sh\n```\nget apache user : second word of the first line (from docker/apache/start_safe_perms)\napache_user=$(head -n 1 /etc/apache2/apache2.conf| cut -d \" \" -f 2)\nget apache group : second word of the second line\napache_group=$(head -n 2 /etc/apache2/apache2.conf| tail -1 |  cut -d \" \" -f 2)\nchown -R $apache_user:$apache_group var\n```\nAre you interested on a PR ?\n. Running everything as www-data would be easier.\nIn fact I don't know why api-platform does all those stuff around owner and group, I was just trying to fix the issue.\n As @soyuka pointed out, it would be easier (and less hacky) to manage permissions in start_safe_perms.\nSo what's next ? Do I update this PR or close it in favour of a whole docker system rewrite ?\n. My mistake,\nCopy/paste error.. Solved.. Sure.\nBut except with --user flag, I think there is no way to run a command as a non-root user.. ",
    "rogamoore": "Thanks K\u00e9vin, for the feedback. I've used dynamic serialization groups for now (not as dynamic as I wanted above) but I will try your suggestion asap. :)\nI'll also have a look if I can provide any help with the Symfony Serializer as this would be probably the cleanest solution :). I had the same issue.\nMy config was:\n```yaml\napi_platform.yaml\nswagger:\n  api_keys:\n    -\n      name: \"X-AUTH-TOKEN\"\n      type: \"header\"\n```\nTaken from this example: https://github.com/api-platform/core/pull/1351\nAfter changing it to\n```yaml\napi_platform.yaml\nswagger:\n  api_keys:\n    apiKey:\n      name: \"X-AUTH-TOKEN\"\n      type: \"header\"\n```\neverything worked fine - the Authorize button will now change to a Logout button.\nMaybe it helps.. Will do so on the weekend ;). ",
    "alborq": "It's may impleaments into DataProvider too. It's not really usefull to fetch unused data. \n@dunglas some news for symfony/symfony#18834 ? . You can look my post on  #246 . My personnal way : \nyml\n    app.documentation.normalizer:\n      class:     AppBundle\\Documentation\\DocumentationNormalizer\n      decorates: api_platform.swagger.normalizer.documentation\n      arguments: ['@app.documentation.normalizer.inner']\n      public:    false\nSome more documentation in gist : https://gist.github.com/alborq/9ec969cdbb1f697d0b11a7a0eb3734bb\n. Hi @vitoo\nIt's a service declaration. add this in your services.yml OR some other DIC config file of your project. . Hi. \nI need some other information about your code to understand your error message. Create a gist with related file, class, definition, services declaration.\n. @cve JSON type not available on MySql . hi @amenophis \nlike response to @cve, Json ODM is not available actually on Mysql \n\nCurrently only PostgreSQL is supported. MySQL (>= 5.7.8) will be supported when the Pull Request doctrine/dbal#2266 will be merged.. Ping @dunglas. We speak together on SymfonyLive about that. This may as a same bug on symfony components (duplicate code). Why array of string is excpect and not just an array. Allan . I have try to reproduce my bug, it seen to be a mistake of myself. All work with json_array,\n\ndocumentation just say 'string[]' change '@var' to \"@var bool[]\" let the same, but, this not concerne my initial problem. \nthis issue is solved. \nThanks. . ",
    "BallisticPain": "Looking forward to this.. @dunglas \nVery happy you're interested in integrating it... I'm very excited about this api-platform. I'm currently trying to use GraphQL. For now I have decided to use Graph.cool as my backend to get started more quickly. I am trying to get deeper into api-platform as well on another project so maybe it's something I can help bring about as I could see some benefit to GraphQL on that project as well.. @dunglas If you could be so kind as to provide some starting instructions, I may be able to convince my team that we can provide this functionality by way of a PR... some insight from you on where, and how to start would be helpful. Very excited to finally get my project up to the latest Symfony so I'm able to start giving it a go.. @dunglas Not sure how I missed your response until now, but glad I checked. I still haven't gotten the team on board yet, but I think it's a matter of time. Especially right now I'm going to have to hit two different end points in order to get what I'm really after.. I did go ahead and comment out JMSSerializerBundle and it's corresponding config (hopefully it doesn't break anything else), and that allowed me in.. Thanks!. @hariszukanovic I'm using master to use the SF4 stuff.. @dleute Am I correct in Docker Toolbox not being the latest Docker for Mac? I use Docker for Mac, and do not have any trouble cloning from master and booting right up and in.. It does use the hosts networking in bridged mode. If you can come up with a way that it can work for both, I'm sure the project would be happy to have both working well... otherwise I imagine they are just using what's \"easiest\" to get setup and running for most users.. @dleute \nYou could also potentially point localhost in your /etc/hosts to your container VM IP.. ",
    "gerfigna": "same problem. ",
    "esistgut": "What if there is no '/translation/2' because I don't want the translations to have their own route?. Is anyone working on this?. @raoulclais do you have a WIP branch somewhere?. ",
    "phiamo": "i have a similar problem:\nwe have events with entryfees\nentry fees vary between events and are never reused.\nso they should afaiu not be a own resource since that would not make sense, but are embedded.\nWhen using a usual doctrine relation they will need a own ApiResource annotation otherwise api-platform will complain about missing route to generate @id\nis there any best practive, or can one disable certain routes to be visible at the generated doc?\n. ",
    "alexsegura": "Not sure this is what you want to do, but you can use a custom Normalizer\nLet's say you have a MenuItem with a price property, but you want to actually serialize it into an Offer\njson\n{\n  \"@id\":\"/menu_items/1\",\n  \"@type\":\"http://schema.org/MenuItem\",\n  \"name\":\"Pizza\",\n  \"offers\":{\n    \"@type\":\"http://schema.org/Offer\",\n    \"price\":10.99,\n    \"priceCurrency\":\"EUR\"\n  }\n}\nsrc/AppBundle/Entity/MenuItem.php\n```php\n/\n * @ORM\\Entity\n * @ApiResource(iri=\"http://schema.org/MenuItem\")\n */\nclass MenuItem extends Thing\n{\n    /\n     * @ORM\\Column(type=\"integer\")\n     * @ORM\\Id\n     * @ORM\\GeneratedValue(strategy=\"IDENTITY\")\n     */\n    private $id;\n/**\n * @ORM\\Column(type=\"float\", nullable=true)\n * @Assert\\Type(type=\"float\")\n * @ApiProperty(iri=\"https://schema.org/price\")\n */\nprotected $price;\n\n/**\n * Gets id.\n *\n * @return int\n */\npublic function getId()\n{\n    return $this->id;\n}\n\npublic function setPrice($price)\n{\n    $this->price = $price;\n\n    return $this;\n}\n\npublic function getPrice()\n{\n    return $this->price;\n}\n\n}\n```\nsrc/AppBundle/Serializer/MenuItemNormalizer.php\n```php\nclass MenuItemNormalizer implements NormalizerInterface, DenormalizerInterface\n{\n    private $normalizer;\npublic function __construct(ItemNormalizer $normalizer)\n{\n    $this->normalizer = $normalizer;\n}\n\npublic function normalize($object, $format = null, array $context = array())\n{\n    $data =  $this->normalizer->normalize($object, $format, $context);\n\n    $data['offers'] = [\n        '@type' => 'http://schema.org/Offer',\n        'price' => $object->getPrice(),\n        'priceCurrency' => 'EUR',\n    ];\n\n    return $data;\n}\n\npublic function supportsNormalization($data, $format = null)\n{\n    return $this->normalizer->supportsNormalization($data, $format) && $data instanceof MenuItem;\n}\n\npublic function denormalize($data, $class, $format = null, array $context = array())\n{\n    return $this->normalizer->denormalize($data, $class, $format, $context);\n}\n\npublic function supportsDenormalization($data, $type, $format = null)\n{\n    return $this->normalizer->supportsDenormalization($data, $type, $format) && $type instanceof MenuItem;\n}\n\n}\n```\napp/config/services.yml\napp.menu_item_normalizer:\n    class: AppBundle\\Serializer\\MenuItemNormalizer\n    arguments:\n      - \"@api_platform.jsonld.normalizer.item\"\n    tags: [ { name: serializer.normalizer, priority: 128 } ]. I don't know if this is a \"better\" way, but you can play with the event system.\nThe code is borrowed from DenyAccessListener\nIn this example, I have restaurants, and orders. Orders are subresources of a restaurant. \nThe route /api/restaurants/{id}/orders is able to check if the restaurant is owned by the authenticated user. \nThis is using ItemDataProviderInterface instead of the EntityManager itself. \n```php\n<?php\nnamespace AppBundle\\Api\\EventSubscriber;\nuse AppBundle\\Entity\\Restaurant;\nuse ApiPlatform\\Core\\DataProvider\\ItemDataProviderInterface;\nuse ApiPlatform\\Core\\EventListener\\EventPriorities;\nuse ApiPlatform\\Core\\Security\\ResourceAccessCheckerInterface;\nuse Symfony\\Component\\EventDispatcher\\EventSubscriberInterface;\nuse Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent;\nuse Symfony\\Component\\HttpKernel\\KernelEvents;\nuse Symfony\\Component\\Security\\Core\\Exception\\AccessDeniedException;\nfinal class RestaurantSubscriber implements EventSubscriberInterface\n{\n    private $itemDataProvider;\n    private $resourceAccessChecker;\npublic function __construct(\n    ItemDataProviderInterface $itemDataProvider,\n    ResourceAccessCheckerInterface $resourceAccessChecker)\n{\n    $this->itemDataProvider = $itemDataProvider;\n    $this->resourceAccessChecker = $resourceAccessChecker;\n}\n\npublic static function getSubscribedEvents()\n{\n    return [\n        KernelEvents::REQUEST => ['accessControl', EventPriorities::PRE_READ],\n    ];\n}\n\npublic function accessControl(GetResponseEvent $event)\n{\n    $request = $event->getRequest();\n\n    if ('api_restaurants_orders_get_subresource' !== $request->attributes->get('_route')) {\n        return;\n    }\n\n    $id = $request->attributes->get('id');\n\n    $restaurant = $this->itemDataProvider->getItem(Restaurant::class, $id, 'get');\n\n    $extraVariables = [];\n    $extraVariables['object'] = $restaurant;\n    $extraVariables['request'] = $request;\n\n    $isGranted = \"is_granted('ROLE_RESTAURANT') and user.ownsRestaurant(object)\";\n\n    if (!$this->resourceAccessChecker->isGranted(Restaurant::class, $isGranted, $extraVariables)) {\n        throw new AccessDeniedException('Access Denied.');\n    }\n}\n\n}\n```. > I just faced the same issue and it works when adding the code in the subresouce entity not in the main one.\n@soyuka is this by design?\nIt looks weird to have to declare an operation named api_users_address_get_subresource on the Address resource. It would be more understandable to declare it on the parent resource.\nFrom what I understand, SubresourceOperationFactory doesn't take care of the access_control attribute?\nAlso, the problem is this doesn't work with subresource operations that are retrieving collections, because in this case object is a Paginator.. I had to \"decorate\" DenyAccessListener to make it work\n```php\n<?php\nnamespace AppBundle\\Api\\EventSubscriber;\nuse AppBundle\\Entity\\Restaurant;\nuse ApiPlatform\\Core\\DataProvider\\ItemDataProviderInterface;\nuse ApiPlatform\\Core\\EventListener\\EventPriorities;\nuse ApiPlatform\\Core\\Security\\EventListener\\DenyAccessListener;\nuse Symfony\\Component\\EventDispatcher\\EventSubscriberInterface;\nuse Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent;\nuse Symfony\\Component\\HttpKernel\\KernelEvents;\nfinal class RestaurantSubscriber implements EventSubscriberInterface\n{\n    private $itemDataProvider;\n    private $denyAccessListener;\npublic function __construct(\n    ItemDataProviderInterface $itemDataProvider,\n    DenyAccessListener $denyAccessListener)\n{\n    $this->itemDataProvider = $itemDataProvider;\n    $this->denyAccessListener = $denyAccessListener;\n}\n\npublic static function getSubscribedEvents()\n{\n    return [\n        KernelEvents::REQUEST => ['accessControl', EventPriorities::PRE_READ],\n    ];\n}\n\npublic function accessControl(GetResponseEvent $event)\n{\n    $request = $event->getRequest();\n\n    if ('api_restaurants_orders_get_subresource' !== $request->attributes->get('_route')) {\n        return;\n    }\n\n    $restaurant = $this->itemDataProvider->getItem(Restaurant::class, $request->attributes->get('id'), 'get');\n\n    // Trick DenyAccessListener to make subresourceOperations work on parent resource\n    $newRequest = $request->duplicate();\n    $newRequest->attributes->set('data', $restaurant);\n    $newRequest->attributes->set('_api_resource_class', Restaurant::class);\n    $newRequest->attributes->set('_api_subresource_operation_name', 'orders_get_subresource');\n\n    $newEvent = new GetResponseEvent($event->getKernel(), $newRequest, $event->getRequestType());\n\n    $this->denyAccessListener->onKernelRequest($newEvent);\n}\n\n}\n```. ",
    "randycasburn": "OK.\nFollowed composer method install instructions\nStarted server per instructions - server runs\nUI was FUBAR\nInstinct: composer update\nResult: composer update identifies 1 install and 2 version updates required by dependencies. Composer installs/updates\nRestart server: UI looks just like Swagger UI\nConclusion: My platform required an install and updates based upon your dependency list. Maybe someone else's will too. Can't explain why, because now that I've updated composer's dependencies, I cannot reproduce the problem.\nUnrelated - but continuing with Book tutorial: When I run:\ndocker-compose exec web bin/console doctrine:generate:entities AppBundle\nto generate new entities, I receive and error:\nERROR: No container found for web_1\nFeel free to close this. Didn't mean to waste your time.. disregard the prior Unrelated comment. Didn't dawn on me to replace:\ndocker-compose exec web\nwith:\nphp bin/console\nAll good - unless one tends to not use Docker.. ",
    "shaisachs": "I didn't need to do a composer update, but I definitely needed to do a composer install. I tried this:\ndocker-compose up -d\ndocker-compose exec php bin/console doctrine:schema:create\nAnd got:\nFatal error: require(): Failed opening required '/srv/api-platform/app/../vendor/autoload.php' (include_path='.:/usr/local/lib/php') in /srv/api-platform/app/autoload.php on line 7\nSo then I ran:\ndocker-compose exec php composer install\n.. and was able to run doctrine:schema:create properly after that.. What do you mean by the startup script? Admittedly I may be doing the wrong thing, but here is my entire process:\n\nDownload https://api.github.com/repos/api-platform/api-platform/zipball\ncd /path/to/api-platform\ndocker-compose up -d \ndocker-compose exec php bin/console doctrine:schema:create\n\nIt's step 4 where things go pear-shaped as described above. I've seen this happen on a couple different machines. Could be I'm missing a step!\nEven so - it may be worth refactoring the docs a little bit to give a clearer step-by-step set of instructions for the docker install path, since as it is there's a bit of exposition that muddies things up a little. I'd certainly be happy to give that a crack if y'all are amenable.. Oh! I see. I didn't realize that was a necessary step - I thought it was just informational. Mind if I touch up the docs to clarify?. ",
    "pierre-H": "For Data Transformer, it's possible to integrate serializer callback.\nFor ACL/Voter, if it's only for one/few fields (not the entity), it's possible to change the serialization context dynamically. But it's still a heavy solution, especially if you have (like me) dozens of entity.. With Api-Platform 2.1, the ACL issue will be easy see here\nBut I can't figure it out how to use serializer callback.... ",
    "krismas": "my rebase failed !. ",
    "helmuthva": "note: i am using v2 of api-platform.. @dunglas : well it does not.\nIf i use a simple host-restriction:\n```yml\n// main routing:\nbricks_infrastructure_core_api_platform:\n    resource: '.'\n    type:     'api_platform'\n    host: \"%bricks_api_host%\"\n    prefix:   '%bricks_api_rest_prefix%'\n```\nThe API ist still available on other hosts (i guess as you use a special type and don't inspect the host?).\nAnd a further problem:\nThe prefix basically works, but in a conflicting way:\n\nIt is ignored in the generated Swagger documentation but used in actual routing (fine)\nIf i however try to add a custom action the full path (including the prefix) is output in swagger, thus requests fail via the swagger UI.\n\nmy settings:\nAnnotation of custom action:\nphp\n/**\n         * @Route(\n         *     name=\"acme_demo_books_item_special\",\n         *     path=\"/acme/demo/books/{id}/special\",\n         *     defaults={\n         *          \"_api_resource_class\"=Book::class,\n         *          \"_api_item_operation_name\"=\"special\",\n         *          \"project\" = \"demo\"\n         *      }\n         * )\n         * @Method(\"PUT\")\n         */\n        public function __invoke(Book $book) \n[..]\n````\nRouting-yaml :yml\nREST\nbricks.custom.acme_demo.rest:\n    resource: '@BricksCustomAcmeDemoBundle/Action/'\n    prefix: \"%bricks_api_rest_prefix%\"\n    type:     'annotation'\n```\n=> you can reproduce by trying to use a prefix in the main routing (cp. above).\nBest Regards. After playing a little with api-platform and integrating it into our platform:\n- Basically works, almost no bugs (except stuff that is obviously missing but arises first-hand given integration into a larger project with a given URL space - cp. above)\n- Examples and documentation lack some real-world requirements/features, e.g. authentication and authorization, but rather easy to add given standard methods - we even auto-wired it ourselfes using our \"modules\" (business logic / services related 1:1 to entities thus providing the necessary voting without any further configuration of subscribers whatsoever)\n- The basic idea of api-platform seems to be to get rid of controllers / actions and be event driven fully - would be great to go the full way implementation-wise even for custom-operations (experiments show this is possible) and internally.\nbest regards and will provide some PRs later after some real-world usage.\nP.S.. Hint: would be great if the @ApiResource annotation would be somewhat mightier ,-)\n. ",
    "silverarm": "Create a .env file in same folder as docker-compose.yml\nand put in \nCOMPOSE_CONVERT_WINDOWS_PATHS=1. ",
    "nlefebvre1410": "sorry,\nBut I do not find much I use for the first time api-platform and it's a bit confusing. json\n{\n  \"@context\": \"/app_dev.php/fr/api/contexts/Error\",\n  \"@type\": \"Error\",\n  \"hydra:title\": \"An error occurred\",\n  \"hydra:description\": \"Invalid identifier \\\"\\\", \\\"id\\\" has not been found.\",\n  \"trace\": [\n    {\n      \"namespace\": \"\",\n      \"short_class\": \"\",\n      \"class\": \"\",\n      \"type\": \"\",\n      \"function\": \"\",\n      \"file\": \"/Applications/MAMP/htdocs/catella-core/vendor/api-platform/core/src/Bridge/Doctrine/Orm/ItemDataProvider.php\",\n      \"line\": 159,\n      \"args\": []\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Bridge\\\\Doctrine\\\\Orm\",\n      \"short_class\": \"ItemDataProvider\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Bridge\\\\Doctrine\\\\Orm\\\\ItemDataProvider\",\n      \"type\": \"->\",\n      \"function\": \"normalizeIdentifiers\",\n      \"file\": \"/Applications/MAMP/htdocs/catella-core/vendor/api-platform/core/src/Bridge/Doctrine/Orm/ItemDataProvider.php\",\n      \"line\": 69,\n      \"args\": [\n        [\n          \"null\",\n          null\n        ],\n        [\n          \"object\",\n          \"Doctrine\\\\ORM\\\\EntityManager\"\n        ],\n        [\n          \"string\",\n          \"AppBundle\\\\Entity\\\\Book\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Bridge\\\\Doctrine\\\\Orm\",\n      \"short_class\": \"ItemDataProvider\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Bridge\\\\Doctrine\\\\Orm\\\\ItemDataProvider\",\n      \"type\": \"->\",\n      \"function\": \"getItem\",\n      \"file\": \"/Applications/MAMP/htdocs/catella-core/vendor/api-platform/core/src/DataProvider/ChainItemDataProvider.php\",\n      \"line\": 40,\n      \"args\": [\n        [\n          \"string\",\n          \"AppBundle\\\\Entity\\\\Book\"\n        ],\n        [\n          \"null\",\n          null\n        ],\n        [\n          \"string\",\n          \"special\"\n        ],\n        [\n          \"array\",\n          []\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\DataProvider\",\n      \"short_class\": \"ChainItemDataProvider\",\n      \"class\": \"ApiPlatform\\\\Core\\\\DataProvider\\\\ChainItemDataProvider\",\n      \"type\": \"->\",\n      \"function\": \"getItem\",\n      \"file\": \"/Applications/MAMP/htdocs/catella-core/vendor/api-platform/core/src/EventListener/ReadListener.php\",\n      \"line\": 94,\n      \"args\": [\n        [\n          \"string\",\n          \"AppBundle\\\\Entity\\\\Book\"\n        ],\n        [\n          \"null\",\n          null\n        ],\n        [\n          \"string\",\n          \"special\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\EventListener\",\n      \"short_class\": \"ReadListener\",\n      \"class\": \"ApiPlatform\\\\Core\\\\EventListener\\\\ReadListener\",\n      \"type\": \"->\",\n      \"function\": \"getItemData\",\n      \"file\": \"/Applications/MAMP/htdocs/catella-core/vendor/api-platform/core/src/EventListener/ReadListener.php\",\n      \"line\": 58,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpFoundation\\\\Request\"\n        ],\n        [\n          \"array\",\n          {\n            \"resource_class\": [\n              \"string\",\n              \"AppBundle\\\\Entity\\\\Book\"\n            ],\n            \"item_operation_name\": [\n              \"string\",\n              \"special\"\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\EventListener\",\n      \"short_class\": \"ReadListener\",\n      \"class\": \"ApiPlatform\\\\Core\\\\EventListener\\\\ReadListener\",\n      \"type\": \"->\",\n      \"function\": \"onKernelRequest\",\n      \"file\": null,\n      \"line\": null,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseEvent\"\n        ],\n        [\n          \"string\",\n          \"kernel.request\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Debug\\\\TraceableEventDispatcher\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"\",\n      \"short_class\": \"\",\n      \"class\": \"\",\n      \"type\": \"\",\n      \"function\": \"call_user_func\",\n      \"file\": \"/Applications/MAMP/htdocs/catella-core/vendor/symfony/symfony/src/Symfony/Component/EventDispatcher/Debug/WrappedListener.php\",\n      \"line\": 61,\n      \"args\": [\n        [\n          \"array\",\n          [\n            [\n              \"object\",\n              \"ApiPlatform\\\\Core\\\\EventListener\\\\ReadListener\"\n            ],\n            [\n              \"string\",\n              \"onKernelRequest\"\n            ]\n          ]\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseEvent\"\n        ],\n        [\n          \"string\",\n          \"kernel.request\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Debug\\\\TraceableEventDispatcher\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\",\n      \"short_class\": \"WrappedListener\",\n      \"class\": \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\",\n      \"type\": \"->\",\n      \"function\": \"__invoke\",\n      \"file\": null,\n      \"line\": null,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseEvent\"\n        ],\n        [\n          \"string\",\n          \"kernel.request\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\EventDispatcher\\\\ContainerAwareEventDispatcher\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"\",\n      \"short_class\": \"\",\n      \"class\": \"\",\n      \"type\": \"\",\n      \"function\": \"call_user_func\",\n      \"file\": \"/Applications/MAMP/htdocs/catella-core/var/cache/dev/classes.php\",\n      \"line\": 2167,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseEvent\"\n        ],\n        [\n          \"string\",\n          \"kernel.request\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\EventDispatcher\\\\ContainerAwareEventDispatcher\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\EventDispatcher\",\n      \"short_class\": \"EventDispatcher\",\n      \"class\": \"Symfony\\\\Component\\\\EventDispatcher\\\\EventDispatcher\",\n      \"type\": \"->\",\n      \"function\": \"doDispatch\",\n      \"file\": \"/Applications/MAMP/htdocs/catella-core/var/cache/dev/classes.php\",\n      \"line\": 2082,\n      \"args\": [\n        [\n          \"array\",\n          [\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ]\n          ]\n        ],\n        [\n          \"string\",\n          \"kernel.request\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseEvent\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\EventDispatcher\",\n      \"short_class\": \"EventDispatcher\",\n      \"class\": \"Symfony\\\\Component\\\\EventDispatcher\\\\EventDispatcher\",\n      \"type\": \"->\",\n      \"function\": \"dispatch\",\n      \"file\": \"/Applications/MAMP/htdocs/catella-core/vendor/symfony/symfony/src/Symfony/Component/EventDispatcher/Debug/TraceableEventDispatcher.php\",\n      \"line\": 136,\n      \"args\": [\n        [\n          \"string\",\n          \"kernel.request\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseEvent\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\",\n      \"short_class\": \"TraceableEventDispatcher\",\n      \"class\": \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\TraceableEventDispatcher\",\n      \"type\": \"->\",\n      \"function\": \"dispatch\",\n      \"file\": \"/Applications/MAMP/htdocs/catella-core/vendor/symfony/symfony/src/Symfony/Component/HttpKernel/HttpKernel.php\",\n      \"line\": 129,\n      \"args\": [\n        [\n          \"string\",\n          \"kernel.request\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseEvent\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\HttpKernel\",\n      \"short_class\": \"HttpKernel\",\n      \"class\": \"Symfony\\\\Component\\\\HttpKernel\\\\HttpKernel\",\n      \"type\": \"->\",\n      \"function\": \"handleRaw\",\n      \"file\": \"/Applications/MAMP/htdocs/catella-core/vendor/symfony/symfony/src/Symfony/Component/HttpKernel/HttpKernel.php\",\n      \"line\": 68,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpFoundation\\\\Request\"\n        ],\n        [\n          \"string\",\n          \"1\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\HttpKernel\",\n      \"short_class\": \"HttpKernel\",\n      \"class\": \"Symfony\\\\Component\\\\HttpKernel\\\\HttpKernel\",\n      \"type\": \"->\",\n      \"function\": \"handle\",\n      \"file\": \"/Applications/MAMP/htdocs/catella-core/vendor/symfony/symfony/src/Symfony/Component/HttpKernel/Kernel.php\",\n      \"line\": 169,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpFoundation\\\\Request\"\n        ],\n        [\n          \"string\",\n          \"1\"\n        ],\n        [\n          \"boolean\",\n          true\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\HttpKernel\",\n      \"short_class\": \"Kernel\",\n      \"class\": \"Symfony\\\\Component\\\\HttpKernel\\\\Kernel\",\n      \"type\": \"->\",\n      \"function\": \"handle\",\n      \"file\": \"/Applications/MAMP/htdocs/catella-core/web/app_dev.php\",\n      \"line\": 33,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpFoundation\\\\Request\"\n        ]\n      ]\n    }\n  ]\n}. How to recover you post ?. Why add an id to a post ?\nMy but is to work on the post. Do you have an implantation of post a me mount please ?. yes\n. ",
    "Renjyy": "@nlefebvre1410 I wonder if you have succeed to translate your entity ?\nI've used knp to translate mine (with entity and entityTranslation..) \nWhen I save the entities separately, it works perfectly but when I link the translatable field to the EntityTranslation, I cant retrieve the Entity ...\nhave you encountered this issue ?. ",
    "oxnel88": "@nlefebvre1410 try changing the parameter of the route defaults key to: \"_api_collection_operation_name\"  . ",
    "ramzes13": "To fix this error you need to use annotation for identifier field, ex:\n/**\n     * @ApiProperty(identifier=true)\n     *\n     * @var int|null\n     */\n    protected $entityId;. ",
    "julestruong": "@oxnel88 THANK YOU. ",
    "helios-ag": "Its enough to return JsonResponse from controller which returns, serialized api resource prepared by symfony seriliazer with 'jsonld' param.\ni.e \nphp\nreturn new JsonResponse($serializer->serialize($apiResourceObject, 'jsonld'), 201, [], true);. ",
    "headonkeyboard": "@dunglas I've also experienced some problem with route prefixing and custom collection operation.\nHere is my routing configuration :\n```\napi_action:\n   resource: '@AppBundle/Action/'\n   type:     'annotation'\n   prefix: '/api'\napi:\n    resource: '.'\n    type:     'api_platform'\n    prefix:   '/api' # Optional\n```\nAnd my resource configuration\nresources:\n    AppBundle\\Entity\\Site:\n        collectionOperations:\n            last_updates:\n                route_name: 'api_sites_last_updates'\n            get:\n                method: 'GET'\n            post:\n                method: 'POST'\nThen, how my routing looks like :\napi_sites_last_updates                      GET      ANY      ANY    /api/sites/last_updates              \napi_sites_get_collection                    GET      ANY      ANY    /api/sites.{_format}                 \napi_sites_post_collection                   POST     ANY      ANY    /api/sites.{_format}                 \napi_sites_get_item                          GET      ANY      ANY    /api/sites/{id}.{_format}            \napi_sites_put_item                          PUT      ANY      ANY    /api/sites/{id}.{_format}            \napi_sites_delete_item                       DELETE   ANY      ANY    /api/sites/{id}.{_format}\nAnd in Swagger :\n\nAnd when I try to request the route api_sites_last_updates\n\nTo solve my problem, I had to remove all the api prefixes. Then, my custom operation last_updates  was working.. ",
    "madarco": "I had the same issue,\nin the meantime I fixed this by overriding the SwaggerUI/index.html.twig template by copying it in app/Resources/ApiPlatformBundle/views/SwaggerUI/index.html.twig.\nAnd changing the start of the javascript in the page so that I manually remove the spec.basePath from the start of my paths:\n<script>\n    $(function () {\n        var spec = {{ spec|replace({'<': '\\u003c'})|raw }};\n        if(spec.basePath) {\n            for (var path in spec.paths) {\n                if (path.indexOf(spec.basePath) == 0) {\n                    var newPath = path.substr(spec.basePath.length);\n                    spec.paths[newPath] = spec.paths[path];\n                    delete spec.paths[path];\n                }\n            }\n        }\n\n        window.swaggerUi = new SwaggerUi({\n            url: '{{ path('api_doc', {'_format': 'json'} ) }}',\n            spec: spec,\n            dom_id: 'swagger-ui-container',\n    // ... rest is the same. Try:\n\napp/Resources/ApiPlatformBundle/views/SwaggerUI/index.html.twig\n. ",
    "santiagosemhan": "+1. ",
    "lvillarino": "Hi @madarco ,\nI copy the file SwaggerUI/index.html.twig template to app/Resources/views/SwaggerUi/index.html.twig and made some modifications but the system is still using the default template.\nDo you have any suggestion to find out what happen ?\nThanks\n. Thanks @madarco . I try 'json' but the api don't return pagination values\nhydra:totalItems\nhydra:first\nhydra:last\nhydra:next\nThanks\n. Thanks. Do you have an example? . Hi:\nI try to fallow the documentation but my template don't show up, Can you verify that this the correct path  app/Resources/api-platform/views/SwaggerUi/index.html.twi\nThanks\n. Thanks @madarco \nthe correct path is app/Resources/ApiPlatformBundle/views/SwaggerUi/index.html.twig. I move the issue to the correct place https://github.com/api-platform/core/issues/1194. Thanks . @soyuka Do you have an ETA for this enhancement ?. No, Thanks . Another question, How I can remove the filter EXACT from the Swagger documentation ?. I want to change the SECTION value\n@see https://symfony.com/doc/master/bundles/NelmioApiDocBundle/the-apidoc-annotation.html\n. Try to define the getters and setters on Profile.. Solution: https://github.com/api-platform/docs/blob/master/core/swagger.md#adding-swagger-context. ",
    "jbeurel": "hi @Simperfit \nIn which PR/version ?. ",
    "taofather": "It looks ok to me. From now on, the brand new _api_receive  request param set to false will disable ValidateListener, DeserializeListener and ReadListener behaviors.\n```yaml\nrouting.yml\nget_properties:\u2028\n    path: '/properties'\n\u2028    methods:  ['GET']\n\u2028    defaults:\u2028\n        _controller: 'AppBundle:Property:get'\u2028\n        _api_resource_class: \u2018MyDomainBundle\\Model\\Property\\Property'\u2028\n        _api_collection_operation_name: 'get'\n        _api_receive: false\n```\nThanks for this great work! . ",
    "paolomainardi": "Thanks a lot @dunglas that is what exactly i was looking for, i hope to contribute back to the doc very soon.. Ok the documentation is quite clear about implementing the data provider, but not how to use it in a entity bundle.. For example, let's take the provided example entity:\n```\n<?php\nnamespace AppBundle\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Component\\Validator\\Constraints as Assert;\n/\n * This is a dummy entity. Remove it!\n \n * @ApiResource\n * @ORM\\Entity\n /\nclass Foo\n{\n    /\n     * @var int The entity Id\n     \n     * @ORM\\Id\n     * @ORM\\GeneratedValue\n     * @ORM\\Column(type=\"integer\")\n     /\n    private $id;\n/**\n * @var string Something else\n *\n * @ORM\\Column\n * @Assert\\NotBlank\n */\nprivate $bar = '';\n\npublic function getId()\n{\n    return $this->id;\n}\n\npublic function getBar() : string\n{\n    return $this->bar;\n}\n\npublic function setBar(string $bar)\n{\n    $this->bar = $bar;\n}\n\n}\n```\nHow can be used the custom data provider instead of Doctrine, keeping the same framework functionalities like docs generations, filter etc ?\n. @dunglas thanks for the quick reply!\nAnd we come back to the initial question, how the custom data provider should be used/included instaed of the standard one ? An example file like the one below would be gold :)\n. ",
    "insekticid": "There is no mention about referenced objects (Embedded relation) and how to deal with it. @globalglug it should be protected and you have to define public getter and setter. @soyuka You are developping custom Filters without doctrine? I am working on it too in my project. Could you send me more info or link about this planned feature?. my reply is here #301 . If you wont use doctrine as data mapper you need to look deep into api platform core code and deal with how to write own filters for your custom data mapper. Api Platform should have abstract CollectionDataProvider for custom data mapper, that can support API docs generating and data filtering via parameters needed for Invoker.\nI made a functional proof of concept. https://github.com/symfony/symfony/pull/25841. ",
    "devrck": "@dunglas How can you apply a custom filter to a custom data provider how are they linked together? . @soyuka I saw the previous answer but I was wondering if there is a guideline on how to do it better.. Hi,\nI'm also interested in this issue because it's not explained in the docs how you can create a custom filter and apply it to a custom data provider.\nYou have only an example where you create a custom filter but it's tied to doctrine.. Hi @mvigneron ,\nWhat I did is inject the filter in the data provider, they are both defined as services. Nothing to fancy. . @amarCosmospace  if its still relevant:\nyaml\nAppBundle\\Action\\MailSpecial:\n    class: AppBundle\\Action\\MailSpecial\n    autowire: true\nThe trick is to define the service the same way as API Platform does. Look at the link and read where it says:\n\nHere we consider that DunglasActionBundle is installed (the default when using the API Platform distribution). This action will be automatically registered as a service (the service name is the same as the class name: AppBundle\\Action\\BookSpecial).. Hi,\n\nResult_cache_driver is enabled like so:\nyaml\nentity_managers:\n     default:\n           query_cache_driver: apc\n           metadata_cache_driver: apc\n           result_cache_driver: apc\nOr if you want to implement your own cache service:\nyaml\nentity_managers:\n     default:\n           query_cache_driver:\n                  type: service\n                  id: your.service.id\nFrom I know resultCache is set on each query manually. . Does anyone have any idea what is wrong or lacking in the documentation?. @soyuka ok so you don't create your custom user provider but you create the event listener that will check the success of failure. Assuming that you don't have doctrine?\nEDIT: Ok I see the entity provider from symfony but still my question is that how do you get the token?\nDo you do a POST in /login_check -d _username=bla _password=blbalba and get the token?. I think I can close this thread I got all the answers. Thanks again. :+1: . Yes it's regarding another issue i'ved opened that @soyuka answered that it does the correct behaviour.\nTo give you the same example:\nA has a subresource B[]\nB has a subresource A\nApi Platform will generate routes like:\nA/{id}/B\nA/{id}/B/A -> this i want to eliminate \nB/{id}/A . ",
    "globalglug": "Hello! I've got the item and collection providers working (my understanding being that these are for GETs) but how do you deal with custom persisters? i.e. deal with a POST so instead of using Doctrine it knows to fire off a web service call elsewhere. I can see how you can do this with an action, but in light of the ability to have custom data providers, can you have custom data persisters? My thinking - I want to avoid having an action for every POST (unless you can advise me how you can create a generic action for all POSTS perhaps).. There is a complaint about generating the IRI:\nUnable to generate an IRI for the item of type \\\"AppBundle\\\\Entity\\\\Example\\\"\"\nThis complaint seems to occur before getting to either the built-in write listener or the new one I've created.\nI do have @ApiProperty(identifier=true) above the private $id property of the example entity.. Thanks, @insekticid but that doesn't seem to fix it - the same error response about not being able to generate the IRI occurs.. @dunglas OK I've registered my bespoke WriteListener as follows in app\\config\\services.yml:\napi_platform.doctrine.listener.view.write:\n    id: api_platform.doctrine.listener.view.write\n    class: AppBundle\\DataPersister\\EventListener\\WriteListener\n    arguments:\n        - '@?doctrine'\n    tags:\n        - { name: kernel.event_listener, event: kernel.view, method: onKernelView, priority: 32 }\n\nThis new class is handling the event. However, I noticed it replaces the default WriteListener and that I have to include the persistence logic for Doctrine entities.\nIs there no way to have your listener deal with Doctrine entities as normal, but let mine deal with the non-Doctrine entities?. ",
    "gries": "Hi,\nfor anybody else that stumbles upon this thread, the easiest solution that I found was to register a new DataPersister using a Tagged Service like so:\nCreate your own DataPersister and implement the interface\n```php\n<?php\nnamespace App\\DataPersister;\nuse ApiPlatform\\Core\\DataPersister\\DataPersisterInterface;\nclass ArrayPersister implements DataPersisterInterface\n{\n/**\n * Is the data supported by the persister?\n *\n * @param mixed $data\n *\n * @return bool\n */\npublic function supports($data): bool\n{\n    if (/* Check if you want to handle the persistence of this data*/) {\n        return true;\n    }\n\n    return false;\n}\n\n/**\n * Persists the data.\n *\n * @param mixed $data\n */\npublic function persist($data)\n{\n    // do your storage\n}\n\n/**\n * Removes the data.\n *\n * @param mixed $data\n */\npublic function remove($data)\n{\n    // remove from storage\n}\n\n}\n**Register the persister as a service**yaml\n    array_persister:\n      class: App\\DataPersister\\ArrayPersister\n      tags:\n        - { name: api_platform.data_persister }\n```\nThat's it, no need to wrap the handle doctrine entities as long as your support method indicates to ignore them.\n. This should be working, can you post your complete example?\nIs the B[] Class autoloaded?\nHave you tried adding the \"@ApiProperty()\" Annotation to $b?. Ot seems to be a very specific problem that can be solved by a User(Developer) by just changing the configuration.\nIt's a good practice to keep REST-API's stateless if one has a use-case where they need sessions the distribution can be easily changed.\nIt therefore think that session's should not be supported by default in the distribution.. That's actually a good point :+1: . Hi,\nCan you provide an example request(URI+Payload) that you are using?\nIt seems to me that $data should include both values name + photo.. ok, is it still straight forward to install? and was there a particular reason to drop it from the standard shipping?. Sorry I forgot to mention that my ResetPassword DTO has a few fields so it's not just a simple operation but actually has some fields that have to be present in the request and need to be validated.. Ok so if I Unterstand it correctly if I use an ItemOperation on User I\u2018d have to Manually validate the request payload? . Allright thanks for the insight. \ud83d\ude04. Hi try changing the URI to something else then /docs I had a similar issue.. Have you looked into: https://api-platform.com/docs/core/content-negotiation/#registering-a-custom-serializer ?. Hi yes sorry I was not clear about that I tried that the problems I had where that:\n\nThe route GET /person_lists/123/people/foo-123 was not generated\nI need to be able to create write routes for the embedded objects like:\nDELETE /person_lists/123/people/foo-123 and subresources currently do not support that.. Hi,\nI have just setup a completely new project v2.2.5 and used my example entities as described above, but added the Subresource Annotation as suggested.\n\n/**\n     * @ApiSubresource()\n     * @var Person[]\n     * @Groups({\"write\", \"read\"})\n     * @Assert\\Valid\n     */\n    public $people;\nBut still GET /person_lists/:personListId/people/:peopleId is missing.\n```\n\nName                                      Method   Scheme   Host   Path                                 \n\napi_entrypoint                            ANY      ANY      ANY    /{index}.{_format}                 \n  api_doc                                   ANY      ANY      ANY    /docs.{_format}                    \n  api_jsonld_context                        ANY      ANY      ANY    /contexts/{shortName}.{_format}    \n  api_person_lists_get_collection           GET      ANY      ANY    /person_lists.{_format}            \n  api_person_lists_post_collection          POST     ANY      ANY    /person_lists.{_format}            \n  api_person_lists_get_item                 GET      ANY      ANY    /person_lists/{id}.{_format}       \n  api_person_lists_people_get_subresource   GET      ANY      ANY    /person_lists/{id}/people.{_format}\n  api_people_get_collection                 GET      ANY      ANY    /people.{_format}                  \n  api_people_post_collection                POST     ANY      ANY    /people.{_format}                  \n  api_people_get_item                       GET      ANY      ANY    /people/{id}.{_format}             \n  api_people_delete_item                    DELETE   ANY      ANY    /people/{id}.{_format}             \n  api_people_put_item                       PUT      ANY      ANY    /people/{id}.{_format}             \n  _twig_error_test                          ANY      ANY      ANY    /_error/{code}.{_format}             \n\n```\nMaybe this is a bug.\nHow would one go about adding support for the writing operations?\nIf I could get points into the right direction I'll glady try to implement it and make pull-request :)\n. Sure there you go :)\nhttps://github.com/gries/api-platform/tree/subresource_bug\nclone + docker-compose up -d should work. in my case if you use an Embedded object I need that information in the URL.\nPersonList has an ID by which I can find the stored Document.\nPerson has an ID which lets me identify the embedded object within that document.\n// person list\n{\n  \"id\": \"aaa-bbb-ccc-ddd\",\n  \"name\": \"my list\",\n  \"people\": [\n    {\"name\": \"alice\",   \"id\": \"aaa-bbb-ccc-ggg\",},\n    {\"name\": \"bob\",   \"id\": \"aaa-bbb-ccc-fff\",}\n  ]\n}\nIf I only have an URL like: /people/aaa-bbb-ccc-fff but the \"root\" resource is stored via. aaa-bbb-ccc-ddd I can't find the root resource and therefore can't find the subresource.\nThat's why I started playing arround with custom-operations which did not work out to good as they don't handle custom parameters.. Thank you I'll be able to look further into this on monday, \nby \"an entry in the docs\" you mean documentation in the custom operations section that show how to add custom parameters? \nif so I'll gladly add that :). Hi,\nI've tried this solution but there is still a slight problem, adding this as a \"custom\" route works fine,\nbut I would have to use the /person_lists/{id}/people/{personId} as the default GET \nroute, which does not work as the IriConverter does not handle the custom property well.\nIt expects there to only be one parameter called ID and does not handle the second one.\nI tried to add identifier=true to both the id and the listId but that does work out either.\nIf you look at: https://github.com/api-platform/core/blob/c42fd6401e78144d97b01cdf2815f3ea03137fe8/src/Bridge/Symfony/Routing/IriConverter.php#L108\nThe converter handles multiple identifier parameters by just imploding them instead of directly using the identifier parameter array.. If you used the zip version instead of the tarball please try to Download it again using the .tar.gz Distribution also could you provide the logs of the php Container ?. From what I read you might be better of using plain symfony framework.\nWhat you are basically describing is non-api related features that you want available in a product called \"api-platform\"\n. Make use of the event System for that.\nIf you want to handle html-forms don\u2018t eitler use plain symfony or submit your Firma using JS and send json data.. Hi,\nHave a look at custom data providers https://api-platform.com/docs/core/data-providers/\nYou can define an entity which is not mapped via doctrine and write a DataProvider that aggregates it from the ERP System.. Hi,\nthis is currently not supported have a look at: https://github.com/api-platform/api-platform/issues/571\nBut as far as I know there is currently work being done to support this.. Hi,\nthe getItem() method is supposed to return an Entity.\nWith this error: \"Can't generate an IRI for the item of type...\"\n\nIs the Entity Managed by ApiPlatform? (@ApiResource annotation or via. yaml)\nDoes the entity have an ID and is the ID Property marked as identifier ? @ApiProperty(identifier=true)\n. Afaik you would have to define an entity and hydrate it from the array data. . That's up to you you basically have to populate the Entity with the data received from your provider so you could use a constructor or setters.. \n",
    "alex-pex": "@dunglas We are using API Platform and I was looking at GraphQL implementations, thinking it should be doable with resource metadata to autogenerate a GraphQL endpoint. I'm happy you share my feelings and are interested to add this feature.. I did a quick search but didn't find this issue, sorry for the duplicate.. ",
    "PMassoels": "Is there any news on this?. ",
    "raoulclais": "I am working on it. Basic queries are okay, I am trying to add mutation support. I will soon push a PR so anyone can help :). ",
    "mdmatthias": "Any updates on this?. ",
    "sbacem": "Any news for this ??. I tried to replace pdo_mysql by pdo_pgsql but i have \nwarning : can't find pdo_pgsql\nwhen docker-compose up -d\n any idea for this ?. Thanks @amenophis @Simperfit  . The doc of api-platform not update use app not web. @Simperfit \ni have same error  after install LexikJWTAuthenticationBundle.. Thanks for help @dunglas \nDockerfile\n```php\nRUN apk add --no-cache --virtual .persistent-deps \\\n        git \\\n        icu-libs \\\n        zlib \\\n        openssl\nENV APCU_VERSION 5.1.8\nRUN set -xe \\\n    && apk add --no-cache --virtual .build-deps \\\n        $PHPIZE_DEPS \\\n        icu-dev \\\n        zlib-dev \\\n        openssl \\\n    && docker-php-ext-install \\\n        intl \\\n        pdo_mysql \\\n        zip \\\n    && pecl install \\\n        apcu-${APCU_VERSION} \\\n    && docker-php-ext-enable --ini-name 20-apcu.ini apcu \\\n    && docker-php-ext-enable --ini-name 05-opcache.ini opcache \\\n    && apk del .build-deps\n....\n```. ",
    "jorgeluisacostaalonso": "Hello there!\nThere 's a little quick-start for grapqh and apiplatform!! Or something explaining how start!!\nhave a nice day. Someone has an idea why the QueryNameGenerator of the extensions are not the same for the filters?\nOr they're the same i have an error in my code to recover caches join alias?. Someone has an idea why the QueryNameGenerator of the extensions are not the same for the filters?\nOr they're the same i have an error in my code to recover caches join alias? . @Nightbr @soyuka Hello!! Is there any solution for this problem?. ",
    "Koc": "ping @dunglas . Can you add some docs how to start? There some irony that search by word graphql returns nothing\n\n. ",
    "Rebolon": "That's quite interesting ! have to get in mind edges/node path (don't understand the usage of cursor for instance) but really interesting. \nI need to test mutation to see how your implementation works but it's possible that REST implementation for complex operation (save multiple entity at the same time) is less useful now because the flexibility of GraphQL solve that kind of problems.\nLooking for changelog and see that it may appear in 2.2 ;-)  ?. For instance on master you cannot do mutations with embedded entities. A mutation with a single object works (Book) but a more complex mutation fail : Book with 2 Reviews\nMaybe i did it wrong.\n. sad to see it on documentation whereas it's not released... you should mark beta feature on the documentation.\nI will try with branch master even if it's risky, to test it.\nThx. argh i used flex to install api-platform, i cannot easily override the version to dev-master.\nHave to wait for a new release. in fact the recipes is just a project with a composer.json (don't know if there is also other files to manage the Kernel and the config) that list all deps. So, using this package, you cannot specify a specific version for one deps.\nMaybe the solution would be to remove the recipes package and add all deps manually with the wished version (for testing purpose i'll do this but i prefer using Flex).. When you use Flex you will not require \"api-platform/core\": \"dev-master\"\nbut\n\"api-platform/api-pack\": \"^1.0\"\nthis last one is the felx recipes, now look at its composer json \nthat way you cannot load a specific version of api-platform/core. It's more work, but i like the idea, and i don't kow why i didn't get it because i already did it, sometime i feel stupid (and tired)... :-) Thx for the tips. maxDepth should already be available on master, and even in 2.2.0-beta1. Here is one circular error when retreiving books from serie 1 : /api/series/1/books\n{\n  \"@context\": \"/api/contexts/Error\",\n  \"@type\": \"hydra:Error\",\n  \"hydra:title\": \"An error occurred\",\n  \"hydra:description\": \"A circular reference has been detected when serializing the object of class \\\"App\\\\Entity\\\\Library\\\\ProjectBookCreation\\\" (configured limit: 1)\",\n  \"trace\": [\n    {\n      \"namespace\": \"\",\n      \"short_class\": \"\",\n      \"class\": \"\",\n      \"type\": \"\",\n      \"function\": \"\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/serializer/Normalizer/AbstractNormalizer.php\",\n      \"line\": 195,\n      \"args\": []\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\\\\Normalizer\",\n      \"short_class\": \"AbstractNormalizer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Normalizer\\\\AbstractNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"handleCircularReference\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/serializer/Normalizer/AbstractObjectNormalizer.php\",\n      \"line\": 66,\n      \"args\": [\n        [\n          \"object\",\n          \"App\\\\Entity\\\\Library\\\\ProjectBookCreation\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\\\\Normalizer\",\n      \"short_class\": \"AbstractObjectNormalizer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Normalizer\\\\AbstractObjectNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/serializer/Serializer.php\",\n      \"line\": 133,\n      \"args\": [\n        [\n          \"object\",\n          \"App\\\\Entity\\\\Library\\\\ProjectBookCreation\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/authors/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab52c000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\",\n      \"short_class\": \"Serializer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Serializer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/Hydra/Serializer/CollectionNormalizer.php\",\n      \"line\": 69,\n      \"args\": [\n        [\n          \"object\",\n          \"App\\\\Entity\\\\Library\\\\ProjectBookCreation\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/authors/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab50b000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab52c000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\",\n      \"short_class\": \"CollectionNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\\\\CollectionNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/Hydra/Serializer/PartialCollectionViewNormalizer.php\",\n      \"line\": 49,\n      \"args\": [\n        [\n          \"object\",\n          \"Doctrine\\\\ORM\\\\PersistentCollection\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/authors/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab50b000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab52c000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\",\n      \"short_class\": \"PartialCollectionViewNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\\\\PartialCollectionViewNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/Hydra/Serializer/CollectionFiltersNormalizer.php\",\n      \"line\": 65,\n      \"args\": [\n        [\n          \"object\",\n          \"Doctrine\\\\ORM\\\\PersistentCollection\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/authors/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab50b000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab52c000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\",\n      \"short_class\": \"CollectionFiltersNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\\\\CollectionFiltersNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/serializer/Serializer.php\",\n      \"line\": 133,\n      \"args\": [\n        [\n          \"object\",\n          \"Doctrine\\\\ORM\\\\PersistentCollection\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/authors/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab50b000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab52c000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\",\n      \"short_class\": \"Serializer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Serializer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/Serializer/AbstractItemNormalizer.php\",\n      \"line\": 445,\n      \"args\": [\n        [\n          \"object\",\n          \"Doctrine\\\\ORM\\\\PersistentCollection\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/authors/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab50b000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab52c000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Serializer\",\n      \"short_class\": \"AbstractItemNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Serializer\\\\AbstractItemNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"getAttributeValue\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/serializer/Normalizer/AbstractObjectNormalizer.php\",\n      \"line\": 80,\n      \"args\": [\n        [\n          \"object\",\n          \"Proxies\\\\__CG__\\\\App\\\\Entity\\\\Library\\\\Author\"\n        ],\n        [\n          \"string\",\n          \"books\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/authors/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab50b000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab52c000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\\\\Normalizer\",\n      \"short_class\": \"AbstractObjectNormalizer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Normalizer\\\\AbstractObjectNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/Serializer/AbstractItemNormalizer.php\",\n      \"line\": 100,\n      \"args\": [\n        [\n          \"object\",\n          \"Proxies\\\\__CG__\\\\App\\\\Entity\\\\Library\\\\Author\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/authors/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab50b000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab52c000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"App\\\\Entity\\\\Library\\\\Author\"\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Serializer\",\n      \"short_class\": \"AbstractItemNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Serializer\\\\AbstractItemNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/JsonLd/Serializer/ItemNormalizer.php\",\n      \"line\": 73,\n      \"args\": [\n        [\n          \"object\",\n          \"Proxies\\\\__CG__\\\\App\\\\Entity\\\\Library\\\\Author\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/authors/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab50b000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"App\\\\Entity\\\\Library\\\\Author\"\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\JsonLd\\\\Serializer\",\n      \"short_class\": \"ItemNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\JsonLd\\\\Serializer\\\\ItemNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/serializer/Serializer.php\",\n      \"line\": 133,\n      \"args\": [\n        [\n          \"object\",\n          \"Proxies\\\\__CG__\\\\App\\\\Entity\\\\Library\\\\Author\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/authors/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab50b000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"App\\\\Entity\\\\Library\\\\Author\"\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\",\n      \"short_class\": \"Serializer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Serializer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/serializer/Normalizer/AbstractObjectNormalizer.php\",\n      \"line\": 98,\n      \"args\": [\n        [\n          \"object\",\n          \"Proxies\\\\__CG__\\\\App\\\\Entity\\\\Library\\\\Author\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/books/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab50b000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\\\\Normalizer\",\n      \"short_class\": \"AbstractObjectNormalizer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Normalizer\\\\AbstractObjectNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/serializer/Serializer.php\",\n      \"line\": 133,\n      \"args\": [\n        [\n          \"object\",\n          \"App\\\\Entity\\\\Library\\\\ProjectBookCreation\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/books/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ],\n                \"000000004ddab50b000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\",\n      \"short_class\": \"Serializer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Serializer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/Hydra/Serializer/CollectionNormalizer.php\",\n      \"line\": 69,\n      \"args\": [\n        [\n          \"object\",\n          \"App\\\\Entity\\\\Library\\\\ProjectBookCreation\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/books/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\",\n      \"short_class\": \"CollectionNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\\\\CollectionNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/Hydra/Serializer/PartialCollectionViewNormalizer.php\",\n      \"line\": 49,\n      \"args\": [\n        [\n          \"object\",\n          \"Doctrine\\\\ORM\\\\PersistentCollection\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/books/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\",\n      \"short_class\": \"PartialCollectionViewNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\\\\PartialCollectionViewNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/Hydra/Serializer/CollectionFiltersNormalizer.php\",\n      \"line\": 65,\n      \"args\": [\n        [\n          \"object\",\n          \"Doctrine\\\\ORM\\\\PersistentCollection\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/books/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\",\n      \"short_class\": \"CollectionFiltersNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\\\\CollectionFiltersNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/serializer/Serializer.php\",\n      \"line\": 133,\n      \"args\": [\n        [\n          \"object\",\n          \"Doctrine\\\\ORM\\\\PersistentCollection\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/books/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\",\n      \"short_class\": \"Serializer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Serializer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/Serializer/AbstractItemNormalizer.php\",\n      \"line\": 445,\n      \"args\": [\n        [\n          \"object\",\n          \"Doctrine\\\\ORM\\\\PersistentCollection\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/books/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Serializer\",\n      \"short_class\": \"AbstractItemNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Serializer\\\\AbstractItemNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"getAttributeValue\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/serializer/Normalizer/AbstractObjectNormalizer.php\",\n      \"line\": 80,\n      \"args\": [\n        [\n          \"object\",\n          \"App\\\\Entity\\\\Library\\\\Book\"\n        ],\n        [\n          \"string\",\n          \"projectBookCreation\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/books/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\\\\Normalizer\",\n      \"short_class\": \"AbstractObjectNormalizer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Normalizer\\\\AbstractObjectNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/Serializer/AbstractItemNormalizer.php\",\n      \"line\": 100,\n      \"args\": [\n        [\n          \"object\",\n          \"App\\\\Entity\\\\Library\\\\Book\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"App\\\\Entity\\\\Library\\\\Book\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/books/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ],\n            \"cache_key\": [\n              \"boolean\",\n              false\n            ],\n            \"circular_reference_limit\": [\n              \"array\",\n              {\n                \"000000004ddab532000000006996f33b\": [\n                  \"integer\",\n                  1\n                ]\n              }\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Serializer\",\n      \"short_class\": \"AbstractItemNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Serializer\\\\AbstractItemNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/JsonLd/Serializer/ItemNormalizer.php\",\n      \"line\": 73,\n      \"args\": [\n        [\n          \"object\",\n          \"App\\\\Entity\\\\Library\\\\Book\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"App\\\\Entity\\\\Library\\\\Book\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/books/1\"\n            ],\n            \"api_normalize\": [\n              \"boolean\",\n              true\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\JsonLd\\\\Serializer\",\n      \"short_class\": \"ItemNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\JsonLd\\\\Serializer\\\\ItemNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/serializer/Serializer.php\",\n      \"line\": 133,\n      \"args\": [\n        [\n          \"object\",\n          \"App\\\\Entity\\\\Library\\\\Book\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"App\\\\Entity\\\\Library\\\\Book\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ],\n            \"iri\": [\n              \"string\",\n              \"/api/books/1\"\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\",\n      \"short_class\": \"Serializer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Serializer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/Hydra/Serializer/CollectionNormalizer.php\",\n      \"line\": 89,\n      \"args\": [\n        [\n          \"object\",\n          \"App\\\\Entity\\\\Library\\\\Book\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"App\\\\Entity\\\\Library\\\\Book\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\",\n      \"short_class\": \"CollectionNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\\\\CollectionNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/Hydra/Serializer/PartialCollectionViewNormalizer.php\",\n      \"line\": 49,\n      \"args\": [\n        [\n          \"object\",\n          \"ApiPlatform\\\\Core\\\\Bridge\\\\Doctrine\\\\Orm\\\\Paginator\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"App\\\\Entity\\\\Library\\\\Book\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ],\n            \"jsonld_has_context\": [\n              \"boolean\",\n              true\n            ],\n            \"api_sub_level\": [\n              \"boolean\",\n              true\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\",\n      \"short_class\": \"PartialCollectionViewNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\\\\PartialCollectionViewNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/Hydra/Serializer/CollectionFiltersNormalizer.php\",\n      \"line\": 65,\n      \"args\": [\n        [\n          \"object\",\n          \"ApiPlatform\\\\Core\\\\Bridge\\\\Doctrine\\\\Orm\\\\Paginator\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"App\\\\Entity\\\\Library\\\\Book\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\",\n      \"short_class\": \"CollectionFiltersNormalizer\",\n      \"class\": \"ApiPlatform\\\\Core\\\\Hydra\\\\Serializer\\\\CollectionFiltersNormalizer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/serializer/Serializer.php\",\n      \"line\": 133,\n      \"args\": [\n        [\n          \"object\",\n          \"ApiPlatform\\\\Core\\\\Bridge\\\\Doctrine\\\\Orm\\\\Paginator\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"App\\\\Entity\\\\Library\\\\Book\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\",\n      \"short_class\": \"Serializer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Serializer\",\n      \"type\": \"->\",\n      \"function\": \"normalize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/serializer/Serializer.php\",\n      \"line\": 106,\n      \"args\": [\n        [\n          \"object\",\n          \"ApiPlatform\\\\Core\\\\Bridge\\\\Doctrine\\\\Orm\\\\Paginator\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"App\\\\Entity\\\\Library\\\\Book\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\Serializer\",\n      \"short_class\": \"Serializer\",\n      \"class\": \"Symfony\\\\Component\\\\Serializer\\\\Serializer\",\n      \"type\": \"->\",\n      \"function\": \"serialize\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php\",\n      \"line\": 69,\n      \"args\": [\n        [\n          \"object\",\n          \"ApiPlatform\\\\Core\\\\Bridge\\\\Doctrine\\\\Orm\\\\Paginator\"\n        ],\n        [\n          \"string\",\n          \"jsonld\"\n        ],\n        [\n          \"array\",\n          {\n            \"subresource_operation_name\": [\n              \"string\",\n              \"api_series_books_get_subresource\"\n            ],\n            \"operation_type\": [\n              \"string\",\n              \"subresource\"\n            ],\n            \"resource_class\": [\n              \"string\",\n              \"App\\\\Entity\\\\Library\\\\Book\"\n            ],\n            \"request_uri\": [\n              \"string\",\n              \"/api/series/1/books\"\n            ],\n            \"uri\": [\n              \"string\",\n              \"http://localhost/api/series/1/books\"\n            ],\n            \"subresource_identifiers\": [\n              \"array\",\n              {\n                \"id\": [\n                  \"string\",\n                  \"1\"\n                ]\n              }\n            ],\n            \"subresource_resources\": [\n              \"array\",\n              {\n                \"App\\\\Entity\\\\Library\\\\Serie\": [\n                  \"array\",\n                  {\n                    \"id\": [\n                      \"string\",\n                      \"1\"\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"resources\": [\n              \"object\",\n              \"class@anonymous\\u0000/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/api-platform/core/src/EventListener/SerializeListener.php0x7f9d12ab57d9\"\n            ]\n          }\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"ApiPlatform\\\\Core\\\\EventListener\",\n      \"short_class\": \"SerializeListener\",\n      \"class\": \"ApiPlatform\\\\Core\\\\EventListener\\\\SerializeListener\",\n      \"type\": \"->\",\n      \"function\": \"onKernelView\",\n      \"file\": null,\n      \"line\": null,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"\n        ],\n        [\n          \"string\",\n          \"kernel.view\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Debug\\\\TraceableEventDispatcher\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"\",\n      \"short_class\": \"\",\n      \"class\": \"\",\n      \"type\": \"\",\n      \"function\": \"call_user_func\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/event-dispatcher/Debug/WrappedListener.php\",\n      \"line\": 104,\n      \"args\": [\n        [\n          \"array\",\n          [\n            [\n              \"object\",\n              \"ApiPlatform\\\\Core\\\\EventListener\\\\SerializeListener\"\n            ],\n            [\n              \"string\",\n              \"onKernelView\"\n            ]\n          ]\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"\n        ],\n        [\n          \"string\",\n          \"kernel.view\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Debug\\\\TraceableEventDispatcher\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\",\n      \"short_class\": \"WrappedListener\",\n      \"class\": \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\",\n      \"type\": \"->\",\n      \"function\": \"__invoke\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/event-dispatcher/EventDispatcher.php\",\n      \"line\": 212,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"\n        ],\n        [\n          \"string\",\n          \"kernel.view\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\EventDispatcher\\\\EventDispatcher\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\EventDispatcher\",\n      \"short_class\": \"EventDispatcher\",\n      \"class\": \"Symfony\\\\Component\\\\EventDispatcher\\\\EventDispatcher\",\n      \"type\": \"->\",\n      \"function\": \"doDispatch\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/event-dispatcher/EventDispatcher.php\",\n      \"line\": 44,\n      \"args\": [\n        [\n          \"array\",\n          [\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ],\n            [\n              \"object\",\n              \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"\n            ]\n          ]\n        ],\n        [\n          \"string\",\n          \"kernel.view\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\EventDispatcher\",\n      \"short_class\": \"EventDispatcher\",\n      \"class\": \"Symfony\\\\Component\\\\EventDispatcher\\\\EventDispatcher\",\n      \"type\": \"->\",\n      \"function\": \"dispatch\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/event-dispatcher/Debug/TraceableEventDispatcher.php\",\n      \"line\": 139,\n      \"args\": [\n        [\n          \"string\",\n          \"kernel.view\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\",\n      \"short_class\": \"TraceableEventDispatcher\",\n      \"class\": \"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\TraceableEventDispatcher\",\n      \"type\": \"->\",\n      \"function\": \"dispatch\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/http-kernel/HttpKernel.php\",\n      \"line\": 156,\n      \"args\": [\n        [\n          \"string\",\n          \"kernel.view\"\n        ],\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\HttpKernel\",\n      \"short_class\": \"HttpKernel\",\n      \"class\": \"Symfony\\\\Component\\\\HttpKernel\\\\HttpKernel\",\n      \"type\": \"->\",\n      \"function\": \"handleRaw\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/http-kernel/HttpKernel.php\",\n      \"line\": 66,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpFoundation\\\\Request\"\n        ],\n        [\n          \"integer\",\n          1\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\HttpKernel\",\n      \"short_class\": \"HttpKernel\",\n      \"class\": \"Symfony\\\\Component\\\\HttpKernel\\\\HttpKernel\",\n      \"type\": \"->\",\n      \"function\": \"handle\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/vendor/symfony/http-kernel/Kernel.php\",\n      \"line\": 190,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpFoundation\\\\Request\"\n        ],\n        [\n          \"integer\",\n          1\n        ],\n        [\n          \"boolean\",\n          true\n        ]\n      ]\n    },\n    {\n      \"namespace\": \"Symfony\\\\Component\\\\HttpKernel\",\n      \"short_class\": \"Kernel\",\n      \"class\": \"Symfony\\\\Component\\\\HttpKernel\\\\Kernel\",\n      \"type\": \"->\",\n      \"function\": \"handle\",\n      \"file\": \"/mnt/d/dev/php/projects/php-sf-flex-webpack-encore-vuejs/public/index.php\",\n      \"line\": 25,\n      \"args\": [\n        [\n          \"object\",\n          \"Symfony\\\\Component\\\\HttpFoundation\\\\Request\"\n        ]\n      ]\n    }\n  ]\n}. I have just found this ! and another thing seems to write the getter for the identifier if i don't want to get Unable to generate an IRI for the item of type...\nThanks, just need now to writ specific PUT/POST route on Book entity to be able to add Editors and Authors at the same time. Clearing the cache doesn't solve the problem.\nHere is the debug:router output\n```\n\nName                                         Method   Scheme   Host   Path                                       \n\napp_apiplatformreactadmin_index              GET      ANY      ANY    /demo/api-platform-admin\n  token                                        ANY      ANY      ANY    /token\n  token_check                                  ANY      ANY      ANY    /token_check\n  app_default_index                            ANY      ANY      ANY    /\n  app_form_index                               GET      ANY      ANY    /demo/form\n  app_hello_world                              GET      ANY      ANY    /demo/hello/{name}\n  app_httpplug_call                            GET      ANY      ANY    /demo/http-plug\n  demo_secured_page                            GET      ANY      ANY    /demo/login/secured\n  demo_login_standard                          ANY      ANY      ANY    /demo/login/standard\n  demo_login_json                              ANY      ANY      ANY    /demo/login/json\n  app_quasar_index                             GET      ANY      ANY    /demo/quasar\n  app_vuejs_index                              GET      ANY      ANY    /demo/vuejs\n  api_entrypoint                               ANY      ANY      ANY    /api/{index}.{_format}\n  api_doc                                      ANY      ANY      ANY    /api/docs.{_format}\n  api_graphql_entrypoint                       ANY      ANY      ANY    /api/graphql\n  api_jsonld_context                           ANY      ANY      ANY    /api/contexts/{shortName}.{_format}\n  api_authors_get_collection                   GET      ANY      ANY    /api/authors.{_format}\n  api_authors_post_collection                  POST     ANY      ANY    /api/authors.{_format}\n  api_authors_get_item                         GET      ANY      ANY    /api/authors/{id}.{_format}\n  api_authors_delete_item                      DELETE   ANY      ANY    /api/authors/{id}.{_format}\n  api_authors_put_item                         PUT      ANY      ANY    /api/authors/{id}.{_format}\n  api_books_get_collection                     GET      ANY      ANY    /api/books.{_format}\n  api_books_post_collection                    POST     ANY      ANY    /api/books.{_format}\n  api_books_get_item                           GET      ANY      ANY    /api/books/{id}.{_format}\n  api_books_delete_item                        DELETE   ANY      ANY    /api/books/{id}.{_format}\n  api_books_put_item                           PUT      ANY      ANY    /api/books/{id}.{_format}\n  api_books_reviews_get_subresource            GET      ANY      ANY    /api/books/{id}/reviews.{_format}\n  api_editors_get_collection                   GET      ANY      ANY    /api/editors.{_format}\n  api_editors_post_collection                  POST     ANY      ANY    /api/editors.{_format}\n  api_editors_get_item                         GET      ANY      ANY    /api/editors/{id}.{_format}\n  api_editors_delete_item                      DELETE   ANY      ANY    /api/editors/{id}.{_format}\n  api_editors_put_item                         PUT      ANY      ANY    /api/editors/{id}.{_format}\n  api_jobs_get_collection                      GET      ANY      ANY    /api/jobs.{_format}\n  api_jobs_post_collection                     POST     ANY      ANY    /api/jobs.{_format}\n  api_jobs_get_item                            GET      ANY      ANY    /api/jobs/{id}.{_format}\n  api_jobs_delete_item                         DELETE   ANY      ANY    /api/jobs/{id}.{_format}\n  api_jobs_put_item                            PUT      ANY      ANY    /api/jobs/{id}.{_format}\n  api_project_book_creations_get_collection    GET      ANY      ANY    /api/project_book_creations.{_format}\n  api_project_book_creations_post_collection   POST     ANY      ANY    /api/project_book_creations.{_format}\n  api_project_book_creations_get_item          GET      ANY      ANY    /api/project_book_creations/{id}.{_format}\n  api_project_book_creations_delete_item       DELETE   ANY      ANY    /api/project_book_creations/{id}.{_format}\n  api_project_book_creations_put_item          PUT      ANY      ANY    /api/project_book_creations/{id}.{_format}\n  api_project_book_editions_get_collection     GET      ANY      ANY    /api/project_book_editions.{_format}\n  api_project_book_editions_post_collection    POST     ANY      ANY    /api/project_book_editions.{_format}\n  api_project_book_editions_get_item           GET      ANY      ANY    /api/project_book_editions/{id}.{_format}\n  api_project_book_editions_delete_item        DELETE   ANY      ANY    /api/project_book_editions/{id}.{_format}\n  api_project_book_editions_put_item           PUT      ANY      ANY    /api/project_book_editions/{id}.{_format}\n  api_reviews_get_collection                   GET      ANY      ANY    /api/reviews.{_format}\n  api_reviews_post_collection                  POST     ANY      ANY    /api/reviews.{_format}\n  api_reviews_get_item                         GET      ANY      ANY    /api/reviews/{id}.{_format}\n  api_reviews_delete_item                      DELETE   ANY      ANY    /api/reviews/{id}.{_format}\n  api_reviews_put_item                         PUT      ANY      ANY    /api/reviews/{id}.{_format}\n  api_reviews_book_get_subresource             GET      ANY      ANY    /api/reviews/{id}/book.{_format}\n  api_series_get_collection                    GET      ANY      ANY    /api/series.{_format}\n  api_series_post_collection                   POST     ANY      ANY    /api/series.{_format}\n  api_series_get_item                          GET      ANY      ANY    /api/series/{id}.{_format}\n  api_series_delete_item                       DELETE   ANY      ANY    /api/series/{id}.{_format}\n  api_series_put_item                          PUT      ANY      ANY    /api/series/{id}.{_format}\n  api_series_books_get_subresource             GET      ANY      ANY    /api/series/{id}/books.{_format}\n  easyadmin                                    ANY      ANY      ANY    /admin/\n  admin                                        ANY      ANY      ANY    /admin/\n  _twig_error_test                             ANY      ANY      ANY    /_error/{code}.{_format}\n  _wdt                                         ANY      ANY      ANY    /_wdt/{token}\n  _profiler_home                               ANY      ANY      ANY    /_profiler/\n  _profiler_search                             ANY      ANY      ANY    /_profiler/search\n  _profiler_search_bar                         ANY      ANY      ANY    /_profiler/search_bar\n  _profiler_phpinfo                            ANY      ANY      ANY    /_profiler/phpinfo\n  _profiler_search_results                     ANY      ANY      ANY    /_profiler/{token}/search/results\n  _profiler_open_file                          ANY      ANY      ANY    /_profiler/open\n  _profiler                                    ANY      ANY      ANY    /_profiler/{token}\n  _profiler_router                             ANY      ANY      ANY    /_profiler/{token}/router\n  _profiler_exception                          ANY      ANY      ANY    /_profiler/{token}/exception\n  _profiler_exception_css                      ANY      ANY      ANY    /_profiler/{token}/exception.css\n  index                                        ANY      ANY      ANY    /\n  simple                                       GET      ANY      ANY    /demo/simple\n  demo_login_standard_check                    ANY      ANY      ANY    /demo/login/authenticate\n  logout                                       ANY      ANY      ANY    /logout\n\n```. I tried with the latest version of api-platform/core: master and it still fail\n. @dunglas any option to solve that problem ? it seems that this feature works well with 2.1.4 (i downloaded this release, put my entities inside, and removed ApiSubResource annotation and it Works) but it fails on master. So : the problemd doesn't rely on master, but maybe in the way i installed ApiPlatform.\n\nif i download the official distribution (release 2.1.4), and update the api-platfom/core to dev-master with composer, then everything works well\nif i use Symfony4 with flex and add api from recipes it seems to not be enough. Here is the full require done with composer on my projet : composer req encore annotations twig api http profiler log doctrine-migrations admin\n\nHere are the steps to reproduce the problem with flex and api:\nCreate a symfony project with flex (and cd into for all other commands):\ncomposer create-project symfony/skeleton api-platform-missing-index-hydra\nEdit your composer.json and add this (it reproduce the recipes api but with api-platform/core on master branch) :\n,\n    \"minimum-stability\": \"dev\",\n    \"prefer-stable\": true,\n    \"repositories\": [\n        {\n            \"type\": \"vcs\",\n            \"url\":  \"git@github.com:Rebolon/api-pack.git\"\n        }\n    ]\nThen run those command to add required packages (for api and graphql):\ncomposer req annotations profiler log rebolon/api-pack\nAdd an entity in your src/Entity:\n```\n<?php\nnamespace App\\Entity\\Library;\nuse ApiPlatform\\Core\\Annotation\\ApiProperty;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse Doctrine\\ORM\\Mapping as ORM;\n/\n * @ApiResource(\n *     iri=\"http://schema.org/Role\"\n * )\n * @ORM\\Entity\n */\nclass Job\n{\n    /\n     * @ORM\\Id\n     * @ORM\\Column(type=\"integer\")\n     * @ORM\\GeneratedValue(strategy=\"AUTO\")\n     */\n    private $id;\n/**\n * @ApiProperty(\n *     iri=\"http://schema.org/name\"\n * )\n * @ORM\\Column(type=\"string\", length=256, nullable=false)\n */\nprivate $tanslation_key;\n\n/**\n * id can be null until flush is done\n * @return int\n */\npublic function getId(): ?int\n{\n    return $this->id;\n}\n\n/**\n * @return string\n */\npublic function getTanslationKey(): string\n{\n    return $this->tanslation_key;\n}\n\n/**\n * @param mixed $tanslation_key\n * @return Job\n */\npublic function setTanslationKey($tanslation_key): Job\n{\n    $this->tanslation_key = $tanslation_key;\n\n    return $this;\n}\n\n}\n```\nRun a server:\nphp -S localhost:8001 -t public\nWith your browser go on localhost:8002/api: You should see the swagger UI with the Job entity\nThen click on the link jsonld at the bottom right of the screen: You will have a 404 Not Found\nSo i expect something wrong with the way i install the api-platform. Am i missing something in the dependancies ?\n. It's not fixed on my side.\nI also run a php built-in server : i will try nginx to check if it solves this problem. thanks @o-rel in fact it works with nginx, but not with php built-in server\n@dunglas what features is mandatory on the server http that prevent the app to run on a php built-in server ?. I'll look at this tomorrow to try the modification and test it. I also opened an issue on symfony there is a bug with the json_login security system that can impact api-platform: https://github.com/symfony/symfony/issues/25806. thx a lot, now i understand where i were wrong. I'm used to apolloData client, i don't think there is a pagination pattern.. Do you need more informations ? \nHere is the app with the model https://github.com/Rebolon/php-sf-flex-webpack-encore-vuejs\nJust start the app and go to /api/graphql to test the mutation\n. Seems that the current solution is to call sub-mutation first and then the parents mutations with IRIS for child objects (PR 1702).\nSad coz graphCool implement this since 2016/10, more info here: https://blog.graph.cool/improving-dx-with-nested-mutations-698c508339ca. Ok i'll test it tomorrow.\nIs it in the documentation, i don't see anythong about this in https://api-platform.com/docs/core/operations ?\nIf you need i may do a PR on the docs project. . Ok i understand, it needs more reflexion on how to manage flex system and\nno-flex. Not so esy indeed\n. Cool @BonnieDoug i've tested it and it works well.\nNot sure i'm telling the truth (and i would like to know how to do this in a correct way), but maybe you could inject the the service like EntityManagerInterface \nand then in your method do the query you want and return a JsonResponse built by yourself. Maybe a better way would be to build a serializer instead of using the JsonResponse but wthat would be valuable only if you re-use this serializer.\n. I want to bring more information about the POST Operation:\nhere is the kind of request i want to do \n * HTTP POST on the book endoint (book is a Doctrine Entity and also declared as ApiResource)\n * Raw content of the post:\n{\n    \"book\": {\n        \"title\": \"test depuis special4\",\n        \"editors\": [{\n            \"publication_date\": \"1519664915\", \n            \"collection\": \"Hachette collection bis\", \n            \"isbn\": \"2-87764-257-7\", \n            \"editor\": {\n                \"name\": \"JeanPaul Edition\"\n            }\n        }, {\n            \"publication_date\": \"1519747464\", \n            \"collection\": \"Ma Tu vue\", \n            \"isbn\": \"2-87764-257-7\", \n            \"editor\": {\n                \"name\": \"JeanPaul Edition\"\n            }\n        }],\n        \"authors\": [{\n            \"role\": {\n                \"translation_key\": \"WRITER\"\n            }, \n            \"author\": {\n                \"firstname\": \"Marc\", \n                \"lastname\": \"Douche\"\n            }\n        }, {\n            \"role\": {\n                \"translation_key\": \"DRAWER\"\n            }, \n            \"author\": {\n                \"firstname\": \"Paul\", \n                \"lastname\": \"TRUC\"\n            }\n        }],\n        \"serie\": {\n            \"name\": \"ouaou ma serie\"\n        }\n    }\n}\nSo for this request i want to create all related entities: Author, Authors (which are ProjectBookCreation Entity), Editor, Editors (which are ProjectBookEdition Entity, Serie, Role (which is Job Entity), and Book.\nFor instance i didn't found the way of doing that kind of thing throuht ApiPlatform so i just added  a new itemsOperations on Book Entity and a new Action BookSpecial with the related method.\nThis method has a Route annotation to map the itemsOperations of the Eneity. It also has a ParamConverter that will transform the json content into a full Book Entity. Then the action only has to use the new Book built by the ParamConverter to persist into the DB and return a JSONResponse with the serialized book.\nIn this operation: i don't follow ApiPlatform in fact. I don't manage all format like ApiPlatform does. The Swagger API is not up to date. It references the new route but the description is wrong. And for instance i don't manage nested entity that contains IRIS (so i don't need to create them but just link them with related entity) and i don't validate the json against a Validator or JsonSchema, and i don't manage Exception from ParamConverter (how to manage them as an HTTPException to auto send the HTTP response based on the format).\nSo The original question would be: does ApiPlatform can help me on that kind of request ? and how ?\nedit: all code that represent my above explanation is available here https://github.com/Rebolon/php-sf-flex-webpack-encore-vuejs/tree/master/ in src/Action folder and the param converter has been extracted into its own repository: https://github.com/Rebolon/ApiJsonParamConverterComponent/tree/master/src. For instance i solved this with a replace but i'm not really happy with this:\n```\nconst fetchWithAuth = (url, options = {}) => {\n    if (!options.headers) options.headers = new Headers({ Accept: 'application/ld+json' });\noptions.credentials = 'same-origin'\n\n// fix https://github.com/api-platform/api-platform/issues/584\nif (apiPlatformPrefix) {\n    url = url.replace(`${apiPlatformPrefix}${apiPlatformPrefix}/`, `${apiPlatformPrefix}/`)\n}\n\nreturn fetchHydra(url, options);\n\n};\n```. @Simperfit which version should fix this ?. i will check soon. Nope i have the same results.\nHere is the root url: localhost:85/demo/my-admin-react\nHere is the stack of api call: \n * http://localhost:85/api\n * http://localhost:85/api/docs.jsonld\n * http://localhost:85/api/contexts/Entrypoint\n * http://localhost:85/api/authors?order%5Bid%5D=DESC&page=1\nAnd then all 404 http errors for next calls:\n * http://localhost:85/api/api/project_book_creations/820\n * http://localhost:85/api/api/project_book_creations/818\n * ...\nLook at the /api/api in those uris. Ok, with the great help of XDebug (as usual ;-p) here is the solution:\n * create a getter with the prefix 'get' + the property name with a ucfirst call\nSo in my case:\npublic function getId_prescripteur()\n{\n   return $this->id_prescripteur;\n}. Reading this thread (https://github.com/api-platform/core/issues/2353#issuecomment-442510341) did you try to use standard comments like this on your related nullable properties ?\n/**\n * @var string|null\n */\n protected $libelle;\nIt works for me.\nA bit sad to have to mix different kind of annotation. @ApiProperty(required=false) should do the job, but finally if it works as is for instance it's cool.\n. ",
    "Nodonisko": "What about release of this feature?. ",
    "alanpoulain": "@Rebolon This has been fixed in this PR: https://github.com/api-platform/core/pull/1702. This is the wanted behavior.\nendCursor in pageInfo corresponds to the last cursor of all your items. See http://graphql.org/learn/pagination/.\nYou should use cursor in edges to paginate through your collection.\nLike this:\n```graphql\nquery getBooksQry($first: Int, $after: String) {\n  getBooks: books(first: $first, after: $after) {\n    edges {\n      node {\n        id\n        title\n      }\n      cursor\n    }\n    pageInfo {\n      endCursor\n      hasNextPage\n    }\n  }\n}\n. See also: https://facebook.github.io/relay/graphql/connections.htm. Yes, there is indeed a problem, contrary to what I said before. There is a PR to fix this and add a new feature (backwards pagination): https://github.com/api-platform/core/pull/2142 but it's stuck at the moment. Maybe I will try to see what I can do.. There is a PR to include native support of MongoDB into API Platform: https://github.com/api-platform/core/pull/1293.\nThere is some work to do to finish it though. You can help us to complete it if you want :). Seems a BC in graphql-php interface. I'm on it.. I think the bug is around here if you want to try to fix it:\nhttps://github.com/api-platform/core/blob/b15030beb49bd841e2c788e7d7a818c388c199aa/src/GraphQl/Resolver/Factory/ItemMutationResolverFactory.php#L92-L104\nIt may be because `edges` is not a valid property for the normalizer.\nMaybe I will when I have some time.. Tested in a project, it's working as expected.. Hello Marc,\nThanks for your interest in this performance matter.\nYes, the closures are there to prevent recursive calls. I think it could be hard to do this differently but not impossible. Maybe by having multiple passes instead of one.\nI don't understand your second idea. It seems to me it's equivalent to the first one: if you generate a schema without closure, you can cache it in a file (by serializing it).\nMaybe a third way is to use the current generated schema and to \"resolve\" it after by recursively replacing closures by their result. Then you could cache it by serializing it in a file.. No :slightly_smiling_face:. For the third method, it may be possible to let the closures \"unresolved\" and to serialize the schema anyway by using this library: https://github.com/opis/closure.\nThis is the library https://github.com/botman/botman is using for serializing the callback of a question.. I think it's because it has been fixed recently. No release with the fix has been made yet.. I think the documentation should be \"released\" like the code ;). No it's not possible at the moment and it's a real issue.\nI've also noticed it when I wrote the documentation and there is some work to be done to make it work.\nI don't know which one is the best solution:\n- introducing two variables in the `query` access control: one for the collection (null when in a simple query) and one for the object (null when not in collection query).\n- introducing a new access control (`query_collection` for instance).\nWDYT?. Hello. We use Behat to test the core. The tests are here:\nhttps://github.com/api-platform/core/tree/master/features/graphql\nThe related context is here:\nhttps://github.com/api-platform/core/blob/master/features/bootstrap/GraphqlContext.php\nBut you are free to test your API like you want :slightly_smiling_face:. I think you're referring to: https://github.com/graphql/graphiql/issues/59\nAPI Platform doesn't use JWT by default. IMO, it's your responsibility to add the authentication layer you want (and not necessarily JWT). So adding it in GraphiQL by default would make no sense.\nHowever, we could make sure it's possible to override the GraphiQL template in API Platform and add a part in the documentation.\nOr maybe we can detect if JWT is used automatically (or at least the `LexikJWTAuthenticationBundle`), and add the support in the GraphiQL template in this case.. I don't understand why we should change how the `PropertyMetadata` works. The factory should be able to determine if a field is required or not based on the mapping configuration and the API Platform one.. I think we should make it work for GraphQL too, like `ApiResource` does.. There has been a first step to add a custom type: https://github.com/api-platform/core/pull/2492.\nI need to document it though and to add a way to register a \"converter\".\nSee also: https://github.com/webonyx/graphql-php/issues/228. Maybe you don't need to use a DateTime type.. @sushicodeur I know this bug. It's because Doctrine uses laziness for relations and proxifies the entities.\nThere is a helper in API Platform to solve this: https://github.com/api-platform/core/blob/master/src/Util/ClassInfoTrait.php\n`\\get_class` is used directly by the Symfony serializer, but I've done a PR to solve this:\nhttps://github.com/symfony/symfony/pull/28669\nIt's now usable in SF 4.2. Maybe it can help here with this bug.. @vincentchalamon The PR for the documentation is here: https://github.com/api-platform/docs/pull/720. Would be better than having to uncomment things and to add build arguments sure.\nBut in the meantime, I think we could stick to this approach.. It can be reverted later on, doesn't it? If we wait for the other PR, it means there is no documentation to install / use MongoDB while the new version is already out.. Closed in favor of documentation only: https://github.com/api-platform/docs/pull/720. Closed in favor of: https://github.com/api-platform/api-platform/pull/978. Not sure why but it shouldn't be the case. The issue is possibly in the `CollectionResolverFactory`.. It's a duplicate of https://github.com/api-platform/core/issues/1759 I think.. I think you are using the wrong version of MongoDB ODM. Have you followed the documentation? https://api-platform.com/docs/core/mongodb/. Already done :slightly_smiling_face: https://github.com/api-platform/core/blob/c80d4934ead61ffd4d5e08f3d86c79fa6fb75ce0/composer.json#L86. Have you installed the distribution? Where directory are you in? The docker-compose file is this one: https://github.com/api-platform/api-platform/blob/master/docker-compose.yml. You are not using the distribution, that's why you don't have the docker-compose file. To install the distribution follow the documentation here: https://api-platform.com/docs/distribution/#using-the-official-distribution-recommended\nIf you want to continue to use Flex, @antograssiot showed you the way.. There is no generated code in API Platform.. Are you using the beta version of API Platform? You need to use it if you want the MongoDB support.. @AbdelilahJbr because the variable \"showWebby\" is only available for the beta.. The concept of schema doesn't really exist in MongoDB. This command only updates indexes. I think it can be done manually.. No I didn't have any auth issue. Maybe you can try to see if you have some?. But if this is removed, you can't require the Doctrine MongoDB ODM bundle without having a cache warmup issue..suggestion\n      <<: cache\n.suggestion\n      <<: cache\n.suggestion\n      <<: *cache\n```. ",
    "lpitteloud": "Thank you for your answer.\nI'll try to explain the problem correctly : \nArticleControllerTest.php\n```\npublic function testGetSingleArticle()\n{\n        $this->client->request('GET', $this->getRouter()->generate('api_articles_get_item', array('id' => $this->fixtures->getReference('article1')->getId())));\n        $response = $this->client->getResponse();\n    $this->assertEquals(Response::HTTP_OK, $response->getStatusCode());\n    $this->assertIsItemOperationResponse($response, Article::class);\n\n}\n```\nCustomWebTestCase.php\n```\npublic function assertIsLDJsonResponse(Response $response)\n{\n        $this->assertTrue(\n            $response->headers->contains('Content-Type', 'application/ld+json'),\n            $response->headers\n        );\n}\npublic function assertIsItemOperationResponse(Response $response, $type = null)\n{\n        $this->assertIsLDJsonResponse($response);\n        $jsonData = json_decode($response->getContent(), true);\n    $this->assertArrayHasKey('@context', $jsonData);\n    $this->assertArrayHasKey('@id', $jsonData);\n    $this->assertArrayHasKey('@type', $jsonData);\n\n    if (null !== $type) {\n        $this->assertEquals($type, $jsonData['@type']);\n    }\n\n}\n```\nDo you need more details ?. I only have following lines : \n```\nvendor/bin/phpunit tests\nPHPUnit 5.7.13 by Sebastian Bergmann and contributors.\nF.                                                                  2 / 2 (100%)\nTime: 2.31 seconds, Memory: 28.00MB\nThere was 1 failure:\n1) Tests\\AppBundle\\Controller\\ArticleControllerTest::testGetSingleArticle\nCache-Control: no-cache, private\nContent-Type:  text/html; charset=UTF-8\nLink:          http://localhost/1.0/api/docs.jsonld; rel=\"http://www.w3.org/ns/hydra/core#apiDocumentation\"\nFailed asserting that false is true.\ntests/AppBundle/Controller/CustomWebTestCase.php:121\ntests/AppBundle/Controller/CustomWebTestCase.php:88\ntests/AppBundle/Controller/ArticleControllerTest.php:68\nFAILURES!\nTests: 2, Assertions: 3, Failures: 1.\n```\nI got no errors into var/logs/test.log. True. But the main problem is that I'm testing content-type header of a route I'm not trying to validate.... Additional information : \nIf I disable api documentation, I got this : Failed asserting that 500 matches expected 200.. It seems logical because this is the documentation route which is tested every time. \nNow I'm trying to find why all the routes are redirected to documentation.... Ok, it was that ! Why default format set into configuration file is not applied ?\nThank you for your time anyway :). Ok great. Thank you !. ",
    "greg0ire": "This means you can't use dots in the value for a route parameter. Thanks for the hint, I will probably need that!. @abysKri this file is from the master branch. The master branch is where development happens. It is normal to have a different version. Here is the v2.1.4 version of this file: https://github.com/api-platform/core/blob/v2.1.4/src/Bridge/Doctrine/Orm/Extension/PaginationExtension.php . Notice the v2.1.4 in the url.. > Can you paste the output of composer info?\nWell?. This looks like a tabulation. ",
    "massimo-me": "Documentation moved, see: https://api-platform.com/docs/extra/troubleshooting/#using-api-platform-and-jms-serializer-in-the-same-project\n```yml\napp/config/config.yml\njms_serializer:  \n    enable_short_alias: false\n```. ",
    "karousn": "After this change on JMSSerializerBundle schmittjoh/JMSSerializerBundle@041f09cbf4a84 , how we can resolve this problem ?. @antograssiot : nothing change :/. ",
    "antograssiot": "@karousn just remove the config key, that's the default option if I remember correctly.. What are your pagination configuration values ?\nhttps://api-platform.com/docs/core/configuration\nSeems your hitting the default configuration here..... I use extension to automaticaly filter collection results in addition to access filter based on the connected user\n https://api-platform.com/docs/core/extensions/#extensions. @BonnieDoug by tagging your service, from the doc I linked before:\n\nFinally register the custom extension:\n\n``\n    'AppBundle\\Doctrine\\ORM\\Extension\\CurrentUserExtension':\n        tags:\n            - { name: api_platform.doctrine.orm.query_extension.collection, priority: 9 }\n            - { name: api_platform.doctrine.orm.query_extension.item }. in your applyToCollection(QueryBuilder $queryBuilder, QueryNameGeneratorInterface $queryNameGenerator, string $resourceClass, string $operationName = null)` method you ca nthen just return based on the resource class and/or operation name.\nfor example I do\n```php\n/**\n * {@inheritdoc}\n */\npublic function applyToCollection(QueryBuilder $queryBuilder, QueryNameGeneratorInterface $queryNameGenerator, string $resourceClass, string $operationName = null)\n{\n    $this->addWhere($queryBuilder, $resourceClass, $operationName);\n}\n\n/**\n * @param QueryBuilder $queryBuilder\n * @param string       $resourceClass\n * @param string       $operationName\n */\nprivate function addWhere(QueryBuilder $queryBuilder, string $resourceClass, ?string $operationName)\n{\n    $user = $this->tokenStorage->getToken()->getUser();\n    if (!$user instanceof SpecificUser) {\n        return;\n    }\n\n    $rootAlias = $queryBuilder->getRootAliases()[0];\n    switch ($resourceClass) {\n        case Foo::class:\n            $queryBuilder\n                ->andWhere(...))\n                ->setParameter(...))\n            ;\n            break;\n        case Bar::class:\n        case Baz::class:\n            $queryBuilder\n                ->andWhere(...)\n                ->setParameter(...)\n            ;\n            if ($operationName === 'custom_action') {\n                 queryBuilder\n                    ->innerJoin(...)\n                    ->andWhere(...)\n            }\n            break;\n        ...\n\n}\n```\ni'm not sure if it is considered as a best practice or if this is the best way to handle such issue but it works great in my use cases.. https://github.com/csarrazi/CsaGuzzleBundle is a great candidate. @apfz To me, the main advantages of JWT over API keys are expiration mechanism and the fact that you can embed informations in the token. If you don't need it, it is up to you.\nRegarding your last question this is how I do it personaly.. I might be wrong but your overhead might be due to a bad @ApiRessouce declaration. I would have done\n@ApiResource{\n      itemOperations={\"get\", \"special\"={\"route_name\"=\"countries_special\"}},\n}. did you try bin/console debug:router ?\nI did follow those steps and the base route is /api\nsee your config/routes/api-platform.yaml . Well, the routes are defined, then it is likely due to your apache config because it works using the php build-in server...\nto be sure you might give a try to composer req server and bin/console server:run. I don't think I can help more.\n. Did you try using \"access_control\" attribute  ?\nhttps://api-platform.com/docs/core/security/#security\n. There are several possibilities.\nI think that is_granted plus a custom voter will do the trick if \"object.user == user\" doesn't\nAnother trick would be to force/override the active user id in a listener or a custom action by yourself.\nUsing denormaliaztion_group you could be sure that user can't put/post the user property,  and force the active User with custom code or a Blamable behavior from Doctrine Extensions. You can using the \"filters\" attribute. . It seems that it is in master only and not in 2.2.\nI'll update the doc.. You can already use the master branch...\nAt least just for generating your export.. @nik-lampe should you get rid of the @ApiResource annotation on Book entity ?. isn't that already what the Group Filter  does ? . That'a not api-platform related but I guess that you can use Blameable form DoctrineExtension for this.. @farazive would you mind trying https://github.com/api-platform/core/pull/2256 and giving us feedback. It should do the trick, thanks by advance. It should work indeed as it uses attributes.\nif you are in an operation I think, the correct syntax is.\nApp\\Entity\\Book:\n  collectionOperations:\n    get:\n      formats:\n        excel: ['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet']\nIf it is for every operation, then it is like in the example \nApp\\Entity\\Book:\n  attributes:\n    formats:\n      excel: ['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet']. I can't reproduce your issue. I took a fresh install with the Greeting entity.\nAfter clearing the cache, it works as expected\nI've declared the resource like this:\n```yaml\napi/config/api_platform/resources.yaml\nresources:\n    App\\Entity\\Greeting:\n        collectionOperations:\n            get:\n                formats:\n                    xml: ['text/xml'] # works also with \"text/html\"\n        attributes:\n            formats:\n               0: 'jsonld' # already existing format in the config\n               csv: 'text/csv'\n```\nMy format config looks like:\nyaml\napi_platform:\n    mapping:\n        paths: ['%kernel.project_dir%/src/Entity', '%kernel.project_dir%/config/api_platform']\n    formats:\n        jsonld:\n            mime_types: ['application/ld+json']\n        json:\n            mime_types: ['application/json']\n        html:\n            mime_types: ['text/html']\nSo the collection GET only accept text/xml, every item operation accept either application/ld+json or text/csv but not application/json nor text/html anymore.. the equivalent in XML would be :\n```xml\n\n\n\n\n\n\ntext/xml\n\n\n\n\n    <attribute name=\"formats\">\n        <attribute>jsonld</attribute>\n        <attribute name=\"csv\">\n            <attribute>text/csv</attribute>\n        </attribute>\n    </attribute>\n</resource>\n\n\n```\ni'll add those example to the doc later in the day. you can perfectly use api-platform/core 2.3 without flex, you just need to configure it.\nI have app what were developed before flex and that works without issue with latest api-platform.. this is indeed an actual limitation. \nI guess we would need to create a FormatProvider::getFormatsFromOperation(string $ressourceClass, string $operationName, string $operationType) that will use ResourceMetadata::getTypedOperationAttribute(..)under the hood and updating the Swagger/Serializer/DocumentationNormalizer::getPathOperation() (and/or updateGetOperation|updatePostOperation|updatePutOperation()) to use it instead of sharing the same mime types.\nDo you want to try and provide a PR ?\nI'll have a look in the next weeks otherwise\nEDIT: it will be needed in https://github.com/api-platform/core/pull/2302 too. @tezvi it is quite likely fixed but I would really appreciate if you could confirm by using the proposed solution.\nI finally started by this as will need to port it to the OpenAPI v3 PR as well anyway. closing as duplicate of https://github.com/api-platform/core/issues/2365 @RikudouSage \nA PR to support this would be very welcome, it is on my TODO but I lack time at the moment.. you're likely using  v2.2.x, that was added in 2.3, update api-*platform/core should do the trick. you need to use api-platform/core master branch and use the --spec-version=3 \nYou can find the doc on the master branch. indeed. not sure if it's the best option as I don't use packs in Flex, but composer require api-platform/core:dev-master should do the trick. do you use some specific tweaks in your API ?\nI've just tried ReDoc with the OpenAPI 3 spec extracted from our test-app.\nThe spec is quite large but I didn't get any warnings\nhere the spec uploaded on a gist\n. it should already be the case, I'll try to have a look soon. \nMeanwhile can you check what happen here please ?\nhttps://github.com/api-platform/core/blob/2bb6f950b4fe3568e5c87d3bbe56fbf87f1901da/src/Swagger/Serializer/DocumentationNormalizer.php#L759-L768\nit seems that the keys are correct and the generated JSO schema is validated in the CI so it seems strange. but do you use docker-compose at all in your project and do you have a php container ?\nOtherwise you just need to use composer req webonyx/graphql-php && bin/console cache:clear. We are not supporting this version anymore and moreover, regarding your initial request, GraphQL support was added in 2.2 so you should try to upgrade beforehand.. Yes I think it is the way it is supposed to work, if you want posts linked to categories to be filterered, you also need to modify the querybuilder when the Category::class === $resourceClass in your case. ",
    "20uf": "Hmm true.\nShould logs be sent with monolog?\n. I don't think it's appropriate for monolog to do that.\nThis is as part of a use with Docker, so it would actually be at the nginx container to do so.\n. ",
    "komik966": "Resolved in #246, thanks @alborq . ",
    "iCodr8": "I Don't know. I'm Not working anymore with that.. The \"client_credentials\" grant type is currently not supported by swagger ui.. Yes, in the app container it worked, but for CI testing I'm not using the docker container directly.. Is there an example anywhere, how to use that in CI?. It's a nice idea, but currently I have no time.. I have added a small PR for that at the docs.. I solved the problem with this event subscriber:\n```php\n<?php\ndeclare(strict_types=1);\nnamespace AppBundle\\EventSubscriber;\nuse ApiPlatform\\Core\\EventListener\\EventPriorities;\nuse AppBundle\\Entity\\User;\nuse Symfony\\Component\\EventDispatcher\\EventSubscriberInterface;\nuse Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent;\nuse Symfony\\Component\\HttpKernel\\KernelEvents;\nfinal class UserResourcesSubscriber implements EventSubscriberInterface\n{\n    public static function getSubscribedEvents()\n    {\n        return [\n            KernelEvents::REQUEST => ['extendResources', EventPriorities::PRE_READ],\n            KernelEvents::REQUEST => ['extendResources', EventPriorities::POST_READ]\n        ];\n    }\npublic function extendResources(GetResponseEvent $event)\n{\n    $class = $event->getRequest()->attributes->get('_api_resource_class');\n    $request = $event->getRequest();\n\n    if ($class === User::class) {\n        $resources = [\n            '/me'\n        ];\n\n        $request->attributes->set('_resources', $request->attributes->get('_resources', []) + (array)$resources);\n    }\n}\n\n}\n``. Done :). I have disabled http_cache inapp/config/config.yml` and the problem is gone:\n# Disabled because varnish cache not working correctly on production systems\n    #http_cache:\n    #    invalidation:\n    #        enabled: true\n    #        varnish_urls: '%varnish_urls%'\n    #    max_age: 0\n    #    shared_max_age: 3600\n    #    vary: ['Accept', 'Content-Type', 'Authorization']\n    #    public: true. Api Platform Version 2.3.6. ",
    "remoteclient": "Hi @anisolankure,\nDid you manage to get it working?. ",
    "rawkode": "I would have preferred that the HEALTHCHECK used the variables, ${MYSQL_USER}, etc; but I believe this is a bug in the docker daemon.\nWe can update this if/when they approve my PR: https://github.com/docker/docker/pull/31491. Looks like Travis only supports up to docker-compose 1.8 :frowning: . Updated / Resolved, @dunglas @teohhanhui \nThanks :+1: . What changes would you have asked for, @teohhanhui ?. I'll suggest you simply revert my changes. I was trying to help, I don't really want to waste time debating non-existent / undocumented standards within your project.. They were replaced by a single mount, rather than a bunch within the same directory. It is a norm in example, sure. But we should challenge this, why would we use a volume before it's defined? I think it's clearer to expose volumes up-front.. Because most editors (Vim, Atom and IntelliJ) don't highlight keys with dashes correctly. I like to be explicit, happy to change. If you want the keys sorted that way, sure. This isn't the norm though.\nOver-quoting is to remove confusion from newcomers to YAML who don't understand how crazy the semantics are and don't understand why we'd have:\nyaml\nkey: \"True\"\nkey2: This is ok though. I was refraining from adding another file, but sure.. v3 isn't stable yet. It's also for SwarmMode, and most people using this file will be using it for development. You shouldn't restrict yourself by adopting v3 at this point in time.. Single volume mount makes sense for development, which is what this file is intended for. See above for v3 remarks. See above. It's also worth pointing out, these healthchecks wouldn't actually work until my PR was merged and released, which I believe was only released yesterday. You should assume that everyone is still on an older release for a while.\nhttps://github.com/docker/docker/pull/31491. ",
    "Stnaire": "Wow ok!\nI see what I was missing.. Sorry for the post, but let me explain what happened in case someone else struggle the way I did.\nI used the same normalization context name (user-read) in both my User and MailingCampaign entities.\nI thought groups were associated to an entity where they seem to be handled globally.\nThe solution was simply to use different group names, like so: \n```\n/\n * @ORM\\Entity\n * @ORM\\Table(name=\"mailing_campaign\")\n \n * @ApiResource(attributes={\n *     \"normalization_context\"={\"groups\"={\"mailing-campaign-read\"}},\n *     \"force_eager\"=false\n * })\n /\nclass MailingCampaign extends AbstractEntity\n{\n    /\n     * @ORM\\Column(type=\"string\", length=255)\n     \n     * @Groups({\"mailing-campaign-read\"})\n     /\n    protected $name;\n/**\n * @ORM\\ManyToOne(targetEntity=\"User\")\n * @ORM\\JoinColumn(name=\"user_id\", referencedColumnName=\"id\")\n *\n * @Groups({\"mailing-campaign-read\"})\n */\nprivate $user;\n\n}\n```\nWhen I wrote user-read I had in head readable for the user, not read for the user entity.\nCase closed.. ",
    "vitoo": "@alborq where do you put this yml :     app.documentation.normalizer: ?\nThanks. Hi @alborq, i got this error, have you an idea to fix this ?\nThe definition \"serializer\" has a reference to an abstract definition \"abstract.instanceof.app.documentation.normalizer\". Abstract definitions cannot be the target of references.\n. This error happen when i use the  app.documentation.normalizer, in services.yml (i've also used the DocumentationNormalizer.php class of course)\nhttps://gist.github.com/vitoo/41872c9b76b956559d03ed2324051b89\nerror : http://image.noelshack.com/fichiers/2017/28/2/1499805835-capture-du-2017-07-11-22-43-13.png. If you want to try my project go there : https://github.com/vitoo/kheyfinder. Same problem here.. ",
    "gouxlord": "@dunglas yes my problem was related to plain ids, we finally replaced the normalizer. Thx for your support!\nBtw, using plain ids by configuration could be a very nice feature!. ",
    "egorkrestinin": "@teohhanhui does it works with plain Ids out of the box? Trying to send request but still getting \"detail\": \"Expected IRI or nested document for attribute \\\"contact\\\", \\\"integer\\\" given.\" (Accept and Content-Type headers are application/json). Sure\nCompany entity is https://gist.github.com/friendsofdevs/8588f55598639e820421730628a3eda2 and Contact entity is https://gist.github.com/friendsofdevs/4b5384aacac1fc55cfa4f214c5d212ec\nThat's all (don't have another entities\\configuration settings). API Platform v2.0.3. Moreover, even if I set Accept to application/json I get  response like \n[\n  {\n    \"id\": 1,\n    \"contactName\": \"Surname\",\n    \"contactCompany\": \"/api/v1/companies/1\"\n  }\n] \nNumerical Id has been expected instead of string.. ",
    "JarJak": "@soyuka  do you plan to make this request format working?. I don't have any custom normalizer. This is my resource config:\n/**\n * @ApiResource(\n *     normalizationContext={\"groups\"={\"get_content\"}},\n *     collectionOperations={\"get\"},\n *     itemOperations={\"get\"}\n * )\n * @ApiFilter(SearchFilter::class)\n * @ORM\\Entity(repositoryClass=\"Bolt\\Repository\\ContentRepository\")\n * @ORM\\Table(indexes={\n *     @ORM\\Index(name=\"content_type_idx\", columns={\"content_type\"}),\n *     @ORM\\Index(name=\"status_idx\", columns={\"status\"})\n * })\n * @ORM\\HasLifecycleCallbacks\n */\nYou can see how it fails here: https://travis-ci.org/bolt/four/jobs/498919190\nAnd then after conflict added in composer.json, it is green again: https://travis-ci.org/bolt/four/builds/494980649\nChanges that made it green again: https://github.com/bolt/four/compare/e5770e48d41b1401c15578611315aedf9d1b1d83...40747f1ebeb9e9c1ac04b4f079178c074e8efdac\nYou can use Bolt 4 to reproduce the bug, but I'm not sure how to isolate it.\n. > introduce a new context option: use_api_platform\nso should I just add another serialization group and attach it to same properties and methods as get_content?\n\nset it to false by default, except for formats fully managed by API Platform (JSON-LD, JSON:API, HAL)\nswitch it to true in our SerializerContextBuilder\n\nI'm not sure how to do it, is it documented somewhere?. Here you can see the resource class: https://github.com/bolt/four/blob/master/src/Entity/Content.php. ",
    "ELepolt": "Is there any documentation for this? I'm not sure if I'm missing something but adding allow_plain_identifiers: true to my config file isn't accomplishing anything.. I noticed this line https://github.com/soyuka/core/commit/808b5d3efb529e49adc68b0099c259c62ace7c19#diff-3e45e8e6ce08f8a7cbbbda1601d5ff29R308\nif (true === $this->allowPlainIdentifiers && $this->itemDataProvider)\nShould I be setting itemDataProvider somewhere also?. ",
    "gonzalovilaseca": "@ELepolt Did you find a solution? I'm having the same issue. ",
    "J4VMC": "@dunglas could you please provide some clarity about this? @ELepolt, @gonzalovilaseca and I are having the same issue, but the documentation is non-existent on the api-platform website.. > @J4VMC see api-platform/core#2022 (comment) for the current status. Help on this topic will be very welcome.\nThanks @dunglas . ",
    "Palethorn": "I managed to produce the effect I wanted using custom doctrine mapping. But I'll try your suggestion also.. Got it to work:\n```\napp/config/services.yml\nservices:\n    api_platform.iri_converter:\n        public: false\n        class: \"AppBundle\\Bridge\\Symfony\\Routing\\IriConverter\"\n        arguments: ['@api_platform.metadata.property.name_collection_factory', '@api_platform.metadata.property.metadata_factory', '@api_platform.item_data_provider', '@api_platform.route_name_resolver', '@api_platform.router', '@api_platform.property_accessor']\n        tags: [{ name: 'api_platform.iri_converter', id: 'api_platform.iri_converter' }]\nThank you.. Oh, didn't know about that. I'll try it instead.. Hello,\nI also tried decorating api_platform.metadata.property.metadata_factory, but it keeps telling me this:\nThe service \"ApiPlatform\\Core\\Metadata\\Resource\\Factory\\ResourceMetadataFactoryInterface\" has a dependency on a non-existent service \"api_platform.metadata.resource.metadata_factory\nService configuration:\n    app.metadata.resource.metadata_factory:\n      class:     AppBundle\\Metadata\\Resource\\Factory\\ExtractorResourceMetadataFactory\n      decorates: api_platform.metadata.resource.metadata_factory\n      arguments: ['@api_platform.metadata.resource.metadata_factory.inner']\n      public:    false\nMy goal is to disable some resources based on current user roles. Would that even be possible?\nEDIT:\nI was missing an alias:\n    app.metadata.resource.metadata_factory:\n      class:     AppBundle\\Metadata\\Resource\\Factory\\ExtractorResourceMetadataFactory\n      decorates: api_platform.metadata.resource.metadata_factory\n      arguments: ['@api_platform.metadata.resource.metadata_factory.inner']\n      alias: api_platform.metadata.resource.metadata_factory\n      public:    false\n. Thanks, now I see. I've managed to decorate bothapp.extractor.resource.name_collection_factoryandapp.metadata.resource.metadata_factory```\n```\n    app.extractor.resource.name_collection_factory:\n      class:     AppBundle\\Metadata\\Resource\\Factory\\ExtractorResourceNameCollectionFactory\n      decorates: api_platform.metadata.resource.name_collection_factory\n      arguments: ['@app.extractor.resource.name_collection_factory.inner']\n      public:    false\napp.metadata.resource.metadata_factory:\n  class:     AppBundle\\Metadata\\Resource\\Factory\\ExtractorResourceMetadataFactory\n  decorates: api_platform.metadata.resource.metadata_factory\n  arguments: ['@app.metadata.resource.metadata_factory.inner']\n  public:    false\n\n. Now I've tried to inject@security.token_storage. Token is null here so I can't check for roles at this point?\ndocs.jsonld is under access_control\n        - { path: ^/api/docs.jsonld, role: ROLE_USER }\n```\nEDIT\nI was accessing token in service constructor so naturally it was null. Down the line, when ExtractorResourceMetadataFactory::create() is invoked everything is fine. This will work.. ",
    "blaues0cke": "For sure, check this: https://github.com/api-platform/docs/pull/183. Alright, thank you. Will dig in this tomorrow. A fast try using fetch=\"EAGER\" on the campaign property in BrandMessage does not fix the issue. For embedded entities there is now fetch=\"EAGER\" setting, so right now I can't remember any other \"lazy loading\" logic in there (especially for embedded entities) that could cause my issue.. Thank you! I think the fastest way to figure out if my issue is related to the ones from @nik-lampe is to give the knows fixes/prs a try (https://github.com/api-platform/core/pull/1046). I will do that afap.. Can confirm that \napi_platform:\n    eager_loading:\n        enabled: false\nas explained in https://github.com/api-platform/core/issues/1071 fixes this issue/is a workaround for this.. @soyuka You are right, all embedded filter do not appear in the metadata. Its seems that all embedded relations are skipped. I tested this with another entity in my project that is called Scan. This property has also an embedded Address but also a related property called title (in Store) (so I do Scans in a Store). The following filter definition seems to work, except that the embedded property is skipped at all.\nfilter.search_scan:\n    parent:    'api_platform.doctrine.orm.search_filter'\n    arguments: [ { store.title: 'partial', status: 'exact', store.address.postalCode: 'starts' } ]\n    tags:      [ { name: 'api_platform.filter', id: 'filter.search_scan' } ]\nThe response lists store.title in hydra:search, but not store.address.postalCode:\n\"hydra:search\": {\n    \"@type\": \"hydra:IriTemplate\",\n    \"hydra:template\": \"/app_dev.php/api/scans{?creationDate[before],creationDate[after],order[creationDate],store.title,status,status[],geoOnly}\",\n    \"hydra:variableRepresentation\": \"BasicRepresentation\",\n    \"hydra:mapping\": [\n      {\n        \"@type\": \"IriTemplateMapping\",\n        \"variable\": \"creationDate[before]\",\n        \"property\": \"creationDate\",\n        \"required\": false\n      },\n      {\n        \"@type\": \"IriTemplateMapping\",\n        \"variable\": \"creationDate[after]\",\n        \"property\": \"creationDate\",\n        \"required\": false\n      },\n      {\n        \"@type\": \"IriTemplateMapping\",\n        \"variable\": \"order[creationDate]\",\n        \"property\": \"creationDate\",\n        \"required\": false\n      },\n      {\n        \"@type\": \"IriTemplateMapping\",\n        \"variable\": \"store.title\",\n        \"property\": \"store.title\",\n        \"required\": false\n      },\n      {\n        \"@type\": \"IriTemplateMapping\",\n        \"variable\": \"status\",\n        \"property\": \"status\",\n        \"required\": false\n      },\n      {\n        \"@type\": \"IriTemplateMapping\",\n        \"variable\": \"status[]\",\n        \"property\": \"status\",\n        \"required\": false\n      },\n      {\n        \"@type\": \"IriTemplateMapping\",\n        \"variable\": \"geoOnly\",\n        \"property\": \"geoOnly\",\n        \"required\": false\n      }\n    ]\n  }\n. Thanks. I cannot find any differences between the example from @soyuka and my code. Also I can remember that at least the filter on embedded entities on the first level worked. Maybe the update from 2.0.3 to 2.0.7 changed something under the hood? Will dig into this tomorrow. Any hints where I should start debugging?. @soyuka Are you sure that this relates to my issue? Since store.title and status are present (in the meta data), but store.address.postalCode not, but they are defined in the same filter definition.\nfilter.search_scan:\n    parent:    'api_platform.doctrine.orm.search_filter'\n    arguments: [ { store.title: 'partial', status: 'exact', store.address.postalCode: 'starts' } ]\n    tags:      [ { name: 'api_platform.filter', id: 'filter.search_scan' } ]. @soyuka For sure, here you go (I removed unnecessary properties):\nEntity\\Scan.php:\n```\n<?php\nnamespace AppBundle\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse Doctrine\\Common\\Collections\\ArrayCollection;\nuse Doctrine\\Common\\Collections\\Collection;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Component\\Serializer\\Annotation\\Groups;\nuse Symfony\\Component\\Validator\\Constraints as Assert;\n/\n * @ApiResource(\n *     attributes={\n *         \"denormalization_context\"={\n *             \"groups\"={\n *                 \"scan_write\"\n *             }\n *         },\n *         \"filters\"={\n *             \"filter.date_scan\",\n *             \"filter.order_scan\",\n *             \"filter.search_scan\",\n *             \"filter.geoOnly\"\n *         },\n *         \"normalization_context\"={\n *             \"groups\"={\n *                 \"scan_read\"\n *             }\n *         }\n *     },\n *     itemOperations={\n *         \"get\"={\n *             \"method\"=\"GET\"\n *         }\n *     }\n * )\n \n * @ORM\\Entity()\n * @ORM\\Table()\n /\nclass Scan\n{\n    /\n     * @var string The id of this scan.\n     \n     * @ORM\\Column(type=\"guid\")\n     * @ORM\\Id\n     * @ORM\\GeneratedValue(strategy=\"UUID\")\n     /\n    protected $id;\n/**\n * @var Store The store in that this scan was created.\n *\n * @ORM\\ManyToOne(targetEntity=\"Store\", inversedBy=\"scans\")\n *\n * @Groups({\n *     \"campaign_participation_app_admin_read\",\n *     \"scan_app_admin_read\",\n *     \"scan_self_read\",\n *     \"scan_write\"\n * })\n */\nprotected $store;\n\n/**\n * The status of this scan (e.g. \"open\")\n *\n * @var string Status\n *\n * @ORM\\Column\n *\n * @Groups({\n *     \"campaign_participation_app_admin_read\",\n *     \"scan_app_admin_read\",\n *     \"scan_self_read\",\n *     \"store_app_admin_read\"\n * })\n */\nprotected $status;\n\n```\nEntity\\Store.php:\n```\n<?php\nnamespace AppBundle\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse Doctrine\\Common\\Collections\\ArrayCollection;\nuse Doctrine\\Common\\Collections\\Collection;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Component\\Ldap\\Adapter\\ExtLdap\\Adapter;\nuse Symfony\\Component\\Serializer\\Annotation\\Groups;\nuse Symfony\\Component\\Validator\\Constraints as Assert;\n/\n * @ApiResource(\n *     attributes={\n *         \"denormalization_context\"={\n *             \"groups\"={\n \n *             }\n *         },\n *         \"filters\"={\n *             \"filter.order_store\",\n *             \"filter.search_store\",\n *             \"filter.range_store\"\n *         },\n *         \"normalization_context\"={\n *             \"groups\"={\n *                 \"store_read\"\n *             }\n *         }\n *     },\n *     collectionOperations={\n *         \"get\"={\n *             \"method\"=\"GET\"\n *         }\n *     },\n *     itemOperations={\n *         \"get\"={\n *             \"method\"=\"GET\"\n *         }\n *     }\n * )\n \n * @ORM\\Entity()\n * @ORM\\Table()\n */\nclass Store\n{\n    /\n     * @var Address Address assigned to this store.\n     \n     * @ORM\\Embedded(class=\"Address\")\n     \n     * @Groups({\n     *     \"scan_app_admin_read\",\n     *     \"scan_read\",\n     *     \"store_read\"\n     * })\n     */\n    protected $address;\n/**\n * @var string The id of this store.\n *\n * @ORM\\Column(type=\"guid\")\n * @ORM\\Id\n * @ORM\\GeneratedValue(strategy=\"UUID\")\n */\nprotected $id;\n\n/**\n * @var string The title of this store (e.g. \"EDEKA\").\n *\n * @Assert\\NotBlank\n * @ORM\\Column\n *\n * @Groups({\n *     \"scan_app_admin_read\",\n *     \"scan_read\",\n *     \"store_read\"\n * })\n */\nprotected $title;\n\n}\n```\nEntity\\Address.php:\n```\n<?php\nnamespace AppBundle\\Entity;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Component\\Serializer\\Annotation\\Groups;\nuse Symfony\\Component\\Validator\\Constraints as Assert;\n/\n * @ORM\\Embeddable\n */\nclass Address\n{\n    /\n     * @var string The postal code part of this address.\n     \n     * @ORM\\Column(nullable=true)\n     \n     * @Groups({\n     *     \"account_balance_change_app_admin_read\",\n     *     \"app_read\",\n     *     \"campaign_participation_app_admin_read\",\n     *     \"payout_request_app_admin_read\",\n     *     \"scan_app_admin_read\",\n     *     \"scan_read\",\n     *     \"store_read\",\n     *     \"user_app_admin_read\",\n     *     \"user_self_read\",\n     *     \"user_self_write\"\n     * })\n     */\n    protected $postalCode;\n}\n```\nAlso, I am in slack for the next few hours and on to figure out this issue, too.. Thanks. Can confirm that https://github.com/api-platform/core/pull/984 works like a charm. Also I accidentally used starts instead of start.. ",
    "sawmurai": "I think the proper way would be to have an optional <collectionOperations> tag (not provided -> all operations enabled) that contains 0-n <collectionOperation> tags. But that would break existing configurations. I will give it a try tonight :). There you go. I also submitted a PR to update the documentation.. Just add a custom Controller + route-configuration as you would in a non-api-platform Symfony project.. ",
    "mitalcoi": "1\n\n2\nYes, every time\n3\n\n. Unfortunately, I can't debug route this way (at symfony 3.2 router:debug deprecated):\n\nBut I steel can debug through router:match:\n\nMy ApiResource config:\n\nMy action config:\n\n. @soyuka maybe the problem is in regular expression that treats route after \"/api/campaigns/\" path as id: \nPath Regex   | #^/api/campaigns(?:\\.(?P<_format>[^/]++))?$#s. I mean that this rule overrides my route, so it doesn't shown up. Also I have provided all related configuration - rest part is taken from standard edition. I've just applied your PATCH to fresh instance of api-platform, and routes are rendered OK (only difference is that I used _api_collection_operation_name instead of _api_item_operation_name from your PATCH) until I try to send smth to this route:\n\n. problem remains :(\n@soyuka do you have any idea about it?. ",
    "mychalvlcek": "@mitalcoi yes, the route isn't matched correctly because of itemOperation regex (regex is too open - matches everything). \nquick solution: move \"app\" routing configuration before \"api_platform\" routing cfg so your custom routes will be matched before the generated (from api_platform) ones\n```\napp:\n    resource: '@AppBundle/Action/'\n    type: 'annotation'\napi:\n    resource: 'api'\n    prefix: /api\n    type: 'api_platform'\n```. ",
    "ArnaudBan": "I have the exact same problem. Did you find a solution ?. Yes the problem is only with Swagger. \nIf you prefix your route with /api it works. That's what a did for the moment.. ",
    "MarsArt": "@Simperfit \n\non custom operation identifying global routing prefix dublicates in route.  \nhttps://github.com/MarsArt/api-platform - link on project where this error occures\n. ",
    "eps90": "Any news on that? Same problem here, makes SwaggerUI completely unusable since most of my routes are mapped custom operations.. ",
    "codedmonkey": "@teohhanhui Yes this is unfortunately the case. When using the json type the model shows as [string] while it should be a key/value storage. Correct?. ",
    "klb-rodriguez": "Thanks for help, It works! :+1: .\nSorry for missing that configuration, I'm new in the framework :D.\nThanks again.. ",
    "sushrest": "On Symfony 4 TokenStorage returns user id or email due to PHP magic method. Use a custom method on User entity class to get the User Entity object like\n$this->tokenStorage->getToken()->getUser()->getUserObject()\nWhere getUserObject on User Entity class will be like\npublic function getUserObject(){\n        return $this;\n    }. My Symfony App is still pointing to default postgres port 5432, can you point me to the right config..pls. ",
    "fulopattila122": "How do you inject the filters?\nWithout the custom data provider we had this in resources.yml:\nyml\nresources:\n    EntityClass:\n        collectionOperations:\n            get:\n                filters: ['api.filter.shop', 'api.filter.language']\nAnd they got injected along with many other stuff:\nphp\n// dump($this->collectionExtensions)\nCollectionDataProvider.php on line 64:\narray:5 [\u25bc\n  0 => EagerLoadingExtension {#128827 \u25b6}\n  1 => FilterExtension {#128979 \u25b6}\n  2 => FilterEagerLoadingExtension {#128989 \u25b6}\n  3 => OrderExtension {#128990 \u25b6}\n  4 => PaginationExtension {#128991 \u25b6}\n]\nHow can I inject all these to the custom data provider?. I've found that for Symfony 3.4+ it can be added to the service definition this way:\nyml\nservices:\n    AppBundle\\DataProvider\\ShopContentLibraryItemProvider:\n        tags: [ { name: 'api_platform.collection_data_provider', priority: 3 } ]\n        autoconfigure: false\n        arguments:\n            $collectionExtensions: !tagged api_platform.doctrine.orm.query_extension.collection\nUnfortunately the project is on Symfony 3.3, so apparently I have to create a compiler pass \ud83d\ude44. ",
    "nik-lampe": "I am experiencing an similar issue, I have documented it in #266 . I came across the same Issue. When serializing an related entity which hast some kind of entity with inheritance  embedded (doesn't actually matter if it's single table or joined).\nThe properties of the parent class are serialized, and ONLY the properties of one of the child classes. But for all entites, regardless of their type. \nThis is a sample setup:\n```\n/\n * @ApiResource()\n * @ORM\\Entity\n * @ORM\\InheritanceType(value=\"JOINED\")\n */\nclass ParentClass\n{\n    /\n     * @var int The entity Id\n     \n     * @ORM\\Id\n     * @ORM\\GeneratedValue\n     * @ORM\\Column(type=\"integer\")\n     * @Groups({\"get\"})\n     /\n    protected $id;\n/**\n * @var string Something else\n *\n * @ORM\\Column\n * @Assert\\NotBlank\n * @Groups({\"get\"})\n */\nprotected $baz = '';\n\n}\n\n/\n * @ApiResource\n * @ORM\\Entity\n */\nclass BarChild extends ParentClass\n{\n    /\n     * @var int The entity Id\n     \n     * @ORM\\Id\n     * @ORM\\GeneratedValue\n     * @ORM\\Column(type=\"integer\")\n     /\n    protected $id;\n/**\n * @var string Something else\n *\n * @ORM\\Column\n * @Assert\\NotBlank\n * @Groups({\"get\"})\n */\nprivate $bar = '';\n\n}\n\n/\n * @ApiResource\n * @ORM\\Entity\n */\nclass FooChild extends ParentClass\n{\n    /\n     * @var int The entity Id\n     \n     * @ORM\\Id\n     * @ORM\\GeneratedValue\n     * @ORM\\Column(type=\"integer\")\n     /\n    protected $id;\n/**\n * @var string Something else\n *\n * @ORM\\Column\n * @Assert\\NotBlank\n * @Groups({\"get\"})\n */\nprivate $foo = '';\n\n\n/\n * @ApiResource(attributes={\"normalization_context\"={\"groups\"={\"get\"}}})\n * @ORM\\Entity()\n */\nclass RelatedEntity\n{\n    /\n     * @ORM\\Id\n     * @ORM\\GeneratedValue(strategy=\"AUTO\")\n     * @ORM\\Column(type=\"integer\")\n     * @Groups({\"get\"})\n     */\n    private $id;\n/**\n * @ORM\\Column(type=\"string\")\n * @Groups({\"get\"})\n */\nprivate $attribute;\n\n/**\n * @ORM\\OneToMany(targetEntity=\"AppBundle\\Entity\\ParentClass\", mappedBy=\"relatedEntity\")\n * @Groups({\"get\"})\n */\nprivate $relatedEntites;\n\n}\n```\nWhen retrieving a RelatedEntity which has a relation to one FooChild and one BarChild the result looks like this:\n{\n  \"@context\": \"\\/app_dev.php\\/contexts\\/RelatedEntity\",\n  \"@id\": \"\\/app_dev.php\\/related_entities\\/1\",\n  \"@type\": \"RelatedEntity\",\n  \"id\": 1,\n  \"attribute\": \"test\",\n  \"relatedEntites\": [\n    {\n      \"@id\": \"\\/app_dev.php\\/foo_children\\/1\",\n      \"@type\": \"FooChild\",\n      \"id\": 1,\n      \"baz\": \"test2\",\n      \"bar\": null\n    },\n    {\n      \"@id\": \"\\/app_dev.php\\/bar_children\\/2\",\n      \"@type\": \"BarChild\",\n      \"id\": 2,\n      \"baz\": \"testbaz\",\n      \"bar\": \"\"\n    }\n  ]\n}\nBut the FooChild Entity should not have the property bar, but foo instead. And in my testing date the value of baron the BarChild entity is actually not an empty string...\n. After Debugging a little I see that the method getAllowedAttributes of api-platform/core/src/Serializer/AbstractItemNormalizer.php returns the right attributes only for the first related entity, for the second it returns the same attributes as the first one. \nHaven't found out why so far. The CachedPropertyMetadataFactory returns the propertyMetadata from Cache instead of creating new, because it uses the parent class as part of the hash key for the cache.\nMethod create in Line 39 of CachedPropertyMetadataFactory. Changing Line 130 of AbstractItemNormalizer so that it uses get_class($classOrObject) instead of $context['resource_class']seems to fix it. But I didn't run any tests yet to see if anything else breaks. I just needed a quick fix.. Back then I have decided to move away from Doctrine Inheritance, so I don't know if this is still a problem.. It seems like the framework has a hard time dealing with entity inheritance. I have found the same issue and was about to collect my findings in a bug report in \nhttps://github.com/api-platform/core/issues/1025. Might that be the same problem as in https://github.com/api-platform/core/issues/1025 and https://github.com/api-platform/core/issues/1043 ?. @soyuka That is true for the one issue, but in https://github.com/api-platform/core/issues/1043 I'm experiencing the same issues without inheritance. So I guess maybe it's not about inheritance at all... \nWhile debugging I found out, that the attributes for the entity aren't retrieved, because the propertyNameCollectionFactory receives the wrong resource class (as far as I understand it, maybe it is right, but then the logic is flawed somewhere else) . @soyuka yes, while applying this framework (which I really love btw) in my project I stumbled across multiple problems and was not aware, that they might all have the same or similar root cause. It was totally confusing for me as well. Sorry, about that :). I still can't get it to work, just came upon this again.\nI have created some sample code here:\nhttps://github.com/nik-lampe/api-platform-serialization-group\nI have just created the example project from here: https://api-platform.com/docs/distribution\nThen I added the resources.yaml File and added it in the api_platform.yaml configuration.\nWhen I set the normalization group on the operation it works, when I set it on the whole entity it does not work in yaml.\nApp\\Entity\\Book:\n    # collectionOperations:\n    #     get:\n    #         normalization_context:\n    #             groups: ['read']\n  attributes:\n    normalization_context: {'groups': ['read']}\n    denormalization_context: {'groups': ['write']}\nI even copy pasted @soyuka's code. Am I missing something?. @antograssiot \nThat works, thanks!\nBut that is not mentioned in the docs, is it? \nIt's kind of irritating because I can mix the annotation and the yaml configuration in other aspects, like I can use the annotation to declare the normalization context and then the configuration file to specify the operations. ",
    "bschultz": "I will close this as I saw that I'm in the wrong project. Will open it in api-platform/core .... ",
    "Newan": "docker-compose exec php bin/console doctrine:schema:create. Website linked to core?\nhttps://github.com/api-platform/core/releases/tag/v2.0.6\nI think you mean?:\nhttps://github.com/api-platform/api-platform/releases/tag/v2.0.6\nBut if i try to downlaod and docker-compose up -d:\nRemoving intermediate container 833b77853e7b\nSuccessfully built e9fa41984cb7\nWARNING: Image for service web was built because it did not already exist. To rebuild this image you must use `docker-compose build` or `docker-compose up --build`.\nCreating apiplattform_database_1\nCreating apiplattform_web_1\nI become some errors:\ndocker-compose exec web bin/console doctrine:schema:create\nWarning: require(/app/app/../vendor/autoload.php): failed to open stream: No such file or directory in /app/app/autoload.php on line 7\nFatal error: require(): Failed opening required '/app/app/../vendor/autoload.php' (include_path='.:/usr/local/lib/php') in /app/app/autoload.php on line 7\n. 1. Yes fresh download \n2. docker-compose up -d\nBut in log I see that the composer failed:\nweb_1       |   - Installing symfony/symfony (v3.2.6): Loading from cache    Failed to download symfony/symfony from dist: Could not delete /app/vendor/symfony/symfony/src/Symfony/Component/Translation/Tests/fixtures/resources.ts:\nweb_1       |     Now trying to download from source\nweb_1       |   - Installing symfony/symfony (v3.2.6):\nweb_1       |\nweb_1       |   [RuntimeException]\nweb_1       |   Could not delete /app/vendor/symfony/symfony/src/Symfony/Component/Translation/Tests/fixtures/resources.ts:\nweb_1       |\nweb_1       |\nweb_1       | install [--prefer-source] [--prefer-dist] [--dry-run] [--dev] [--no-dev] [--no-custom-installers] [--no-autoloader] [--no-scripts] [--no-progress] [--no-suggest] [-v|vv|vvv|--verbose] [-o|--optimize-autoloader] [-a|--classmap-authoritative] [--apcu-autoload\ner] [--ignore-platform-reqs] [--] [<packages>]...\nweb_1       |\napiplatform206_web_1 exited with code 1. Docker Version 17.03.0-ce, build 60ccb22\nWindwos 10  Pro\nDelete all Images in Docker recreate all, same issues\nUpdate:\nOn virtuell Ubuntu it works, not under windows ?. on an fresh installed windows with nothing installed:\n\ninstall docker\nenable hyper-V and shared c:\ndownload api-Plattform\nunzip\nchange to root from api-Plattform\nrun docker-composer up -d\nrun docker-compose logs web\n\nweb_1       | /usr/local/bin/docker-php-entrypoint: 9: exec: \n/app/docker/start.sh: not found\n\nrun docker-compose PS\n\n```\nPS C:\\Users\\EDV\\Downloads\\api-platform-2.0.6> docker-compose ps\n           Name                         Command                State    \nPorts\n\napiplatform206_database_1   docker-entrypoint.sh mysqld      Up       \n3306/tcp\napiplatform206_web_1        docker-php-entrypoint /app ...   Exit 127\n```\nThe start.sh is in the container.  an Windows issues, but no idea to fix it\n. PHPStorm says LF. Update, after x install all new an try try try then:\nweb_1       |  [OK] Cache for the \"dev\" environment (debug=true) was successfully cleared.\nweb_1       |\nweb_1       | > Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installAssets\nweb_1       |\nweb_1       |  Trying to install assets as relative symbolic links.\nweb_1       |\nweb_1       |  --- ------------------- ------------------\nweb_1       |       Bundle              Method / Error\nweb_1       |  --- ------------------- ------------------\nweb_1       |   \u00d4\u00a3\u00f6   ApiPlatformBundle   relative symlink\nweb_1       |  --- ------------------- ------------------\nweb_1       |\nweb_1       |  [OK] All assets were successfully installed.\nweb_1       |\nweb_1       | > Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installRequirementsFile\nweb_1       | > Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::prepareDeploymentTarget\nweb_1       | + rm -f /var/run/apache2/apache2.pid\nweb_1       | + exec docker/apache/start_safe_perms -DFOREGROUND\nweb_1       | AH00526: Syntax error on line 1 of /etc/apache2/apache2.conf:\nweb_1       | Error:\\tApache has not been designed to serve pages while\\n\\trunning as root.  There are known race conditions that\\n\\twill allow any local user to read any file on the system.\\n\\tIf you still desire to serve pages as root then\\n\\tadd -DBIG_SECURITY_HOLE to\n the CFLAGS env variable\\n\\tand then rebuild the server.\\n\\tIt is strongly suggested that you instead modify the User\\n\\tdirective in your httpd.conf file to list a non-root\\n\\tuser.\\n\nweb_1       | Action '-DFOREGROUND' failed.\nweb_1       | The Apache error log may have more information.. I used the latest Release.  dunglas wrote it for downgrade on this issues.  I will wait for the next Release . Works, very good!\nBut first Post:\n\nSeems like manual is bit outdated.. \n",
    "garbus": "Oh in fact in the manual \"app\" is outdated, changing to the \"web\" solved the problem.\nThen it appeared \"the input device is not a TTY.  If you are using mintty, try prefixing the command with 'winpty'\", so writing winpty docker-compose exec app bin/console doctrine:schema:create made the job.\n. Hi guys.\nTried to install api platform stable (v 2.0.10 - https://github.com/api-platform/api-platform/releases/tag/v2.0.10 ) @ Docker CE ( Version 17.06.0-ce-win19 (12801) Channel: stable ) and got same error.\nTried to play with LF EOL but it does't help.\nWhat is the solution for me?\nThanks!. Hi @Simperfit,\nThanks for quick answer.\nActually I used api-platform-2.1.0-beta.3 and it started correctly.\nNow I have another problem though:\ndocker-compose exec web bin/console doctrine:schema:create\nNo such service: web\nThis will be the right issue to continue fighting with this: https://github.com/api-platform/api-platform/issues/265\nThanks once again!\n. ",
    "fizdalf": "A few seconds before you suggested it ..that's what I did ..and viola! ..maybe that should be added to the guide cause there's no mention of it.\nThanks for your assistance anyways!!. ",
    "vichanse": "The download link on https://api-platform.com/ is faulty.\nI downloaded directly from github and got a working version. ",
    "bxnxg": "Hi, I've got the same problem, I just comment\n#username_parameter: username\n#password_parameter: password\nAnd it worked for me... ",
    "ghost": "@Dannebicque, can you please post the security.yml you got from someone else here? I have the same problem.. This indeed does work when I login via http://127.0.0.1:8000/login, but when I try curl -X POST http://127.0.0.1:8000/login_check -d _username=testuser -d _password=p@ssword, I get the same \"Bad Credentials\" message again. Is this suppose to be like this? I don't completely understand. ",
    "angelzeke": "thank you for your reply.\nIs it planned to set up on client_credentials? \nParticipate in the development of this evolution?\n. I use this tutorial to implement Oauth https://causeyourestuck.io/2016/07/19/oauth2-explained-part-2-setting-up-oauth2-with-symfony2-using-fosoauthserverbundle/\nNow i can generate token_access \nIn security.yml i change \napi:\n            pattern:    ^/api/[A-Za-z0-9]\n            fos_oauth:  true\n            stateless:  true\nLike this i can access to swagger UI and method like 'http://192.168.56.2/app_dev.php/api/books' need Oauth.\nNow i would like use a method like twitter\ni test my REST API with postman and it's work.\nNow i want implement Oauth on swagger UI, like postman i want add a form.\nUser can specify Client ID and Client Secret and valid to have his token_access. For example, \nGET /books ==> host/app_dev.php/#!/Book/getBookCollection\nI want overwritte CRUD and use my own method. I think best way is using In src/AppBundle/Entity/Book.php\n@ApiResource(\n      shortName=\"Books method\",\n      collectionOperations={\n          \"get\"={\n               \"method\"=\"GET\",\n               \"controller\"=\"AppBundle:Book:get\",\n           },\n          \"post\"={\"method\"=\"POST\" },\n          \"search\"={\n             \"path\"=\"/books/search\",\n             \"method\"=\"GET\",\n             \"controller\"=\"AppBundle:Book:search\",\n             \"hydra_context\"={\n                   \"type\"=\"hydra:Operation\",\n                   \"hydra:title\"=\"Recherche de books\",\n                   \"returns\"=\"jsonld\"\n               }\n          }\n      },\n      iri=\"http://schema.org/Book\"\n )\nand associate a controller src/AppBundle/Controller/BookController.php\nnamespace AppBundle\\Controller;\nuse AppBundle\\Entity\\Book;\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\Controller;\nclass BookController extends Controller\n{\npublic function searchAction()\n{\n\n    return array();\n}\n\npublic function getAction()\n{\n    $em = $this->getDoctrine()->getManager();\n    return $em->getRepository('AppBundle:Book')->findAll();\n}\n\n}\n. someone have a idea, when i test in postman it's return null and when i put propriety on extends class it's work. After update with standart edition it's work well, i just have this error in some class\n\"A circular reference has been detected (configured limit: 1).\"\n`class Article\n{\n        /\n\n         * @ORM\\ManyToOne(targetEntity=\"Journal\")\n         * @ORM\\JoinColumn(name=\"ART\", referencedColumnName=\"ID\")\n         /\n    private $journal;\n}\nclass Journal\n{\nclass Article\n{\n      /\n     * @ORM\\OneToMany(targetEntity=\"Article\", mappedBy=\"journal\")\n     *\n     /\n    private $articles;\n}\n}\n`. ",
    "novakma2": "@angelzeke Hey, can you please write short and brief tutorial about implementation of OAuth2? Cant get this running. Thanks. ",
    "VeeeneX": "Example /products\njson\n{\n  \"@context\": \"/contexts/Product\",\n  \"@id\": \"/products\",\n  \"@type\": \"hydra:Collection\",\n  \"hydra:member\": [\n    [\n      {\n        \"@id\": \"/products/593bdea59280210007715442\",\n        \"@type\": \"http://schema.org/Product\",\n        \"name\": \"ccc\",\n        \"id\": \"593bdea59280210007715442\"\n      },\n      {\n        \"@id\": \"/products/593be02f487dae0007070e12\",\n        \"@type\": \"http://schema.org/Product\",\n        \"name\": \"ccc\",\n        \"id\": \"593be02f487dae0007070e12\"\n      }\n    ]\n  ],\n  \"hydra:totalItems\": 1\n}\nI can't delete the product because there's a html validation for integer. This doesn't work for GET, PUT, DELETE. When I try to create a product I get an error:\njson\n{\"@context\":\"\\/contexts\\/Error\",\"@type\":\"hydra:Error\",\"hydra:title\":\"An error occurred\",\"hydra:description\":\"Unable to generate an IRI for the item of type \\u0022App\\\\Document\\\\Product\\u0022\",\"trace\":[{\"namespace\":\"\",\"short_class\":\"\",\"class\":\"\",\"type\":\"\",\"function\":\"\",\"file\":\"\\/app\\/src\\/Bridge\\/Symfony\\/Routing\\/IriConverter.php\",\"line\":122,\"args\":[]},{\"namespace\":\"App\\\\Bridge\\\\Symfony\\\\Routing\",\"short_class\":\"IriConverter\",\"class\":\"App\\\\Bridge\\\\Symfony\\\\Routing\\\\IriConverter\",\"type\":\"-\\u003E\",\"function\":\"getIriFromItem\",\"file\":\"\\/app\\/vendor\\/api-platform\\/core\\/src\\/JsonLd\\/Serializer\\/ItemNormalizer.php\",\"line\":71,\"args\":[[\"object\",\"App\\\\Document\\\\Product\"]]},{\"namespace\":\"ApiPlatform\\\\Core\\\\JsonLd\\\\Serializer\",\"short_class\":\"ItemNormalizer\",\"class\":\"ApiPlatform\\\\Core\\\\JsonLd\\\\Serializer\\\\ItemNormalizer\",\"type\":\"-\\u003E\",\"function\":\"normalize\",\"file\":\"\\/app\\/vendor\\/symfony\\/serializer\\/Serializer.php\",\"line\":128,\"args\":[[\"object\",\"App\\\\Document\\\\Product\"],[\"string\",\"jsonld\"],[\"array\",{\"collection_operation_name\":[\"string\",\"post\"],\"operation_type\":[\"string\",\"collection\"],\"resource_class\":[\"string\",\"App\\\\Document\\\\Product\"],\"request_uri\":[\"string\",\"\\/products\"],\"resources\":[\"array\",[]],\"jsonld_has_context\":[\"boolean\",true]}]]},{\"namespace\":\"Symfony\\\\Component\\\\Serializer\",\"short_class\":\"Serializer\",\"class\":\"Symfony\\\\Component\\\\Serializer\\\\Serializer\",\"type\":\"-\\u003E\",\"function\":\"normalize\",\"file\":\"\\/app\\/vendor\\/symfony\\/serializer\\/Serializer.php\",\"line\":101,\"args\":[[\"object\",\"App\\\\Document\\\\Product\"],[\"string\",\"jsonld\"],[\"array\",{\"collection_operation_name\":[\"string\",\"post\"],\"operation_type\":[\"string\",\"collection\"],\"resource_class\":[\"string\",\"App\\\\Document\\\\Product\"],\"request_uri\":[\"string\",\"\\/products\"],\"resources\":[\"array\",[]]}]]},{\"namespace\":\"Symfony\\\\Component\\\\Serializer\",\"short_class\":\"Serializer\",\"class\":\"Symfony\\\\Component\\\\Serializer\\\\Serializer\",\"type\":\"-\\u003E\",\"function\":\"serialize\",\"file\":\"\\/app\\/vendor\\/api-platform\\/core\\/src\\/EventListener\\/SerializeListener.php\",\"line\":65,\"args\":[[\"object\",\"App\\\\Document\\\\Product\"],[\"string\",\"jsonld\"],[\"array\",{\"collection_operation_name\":[\"string\",\"post\"],\"operation_type\":[\"string\",\"collection\"],\"resource_class\":[\"string\",\"App\\\\Document\\\\Product\"],\"request_uri\":[\"string\",\"\\/products\"],\"resources\":[\"array\",[]]}]]},{\"namespace\":\"ApiPlatform\\\\Core\\\\EventListener\",\"short_class\":\"SerializeListener\",\"class\":\"ApiPlatform\\\\Core\\\\EventListener\\\\SerializeListener\",\"type\":\"-\\u003E\",\"function\":\"onKernelView\",\"file\":null,\"line\":null,\"args\":[[\"object\",\"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"],[\"string\",\"kernel.view\"],[\"object\",\"Symfony\\\\Component\\\\HttpKernel\\\\Debug\\\\TraceableEventDispatcher\"]]},{\"namespace\":\"\",\"short_class\":\"\",\"class\":\"\",\"type\":\"\",\"function\":\"call_user_func\",\"file\":\"\\/app\\/vendor\\/symfony\\/event-dispatcher\\/Debug\\/WrappedListener.php\",\"line\":106,\"args\":[[\"array\",[[\"object\",\"ApiPlatform\\\\Core\\\\EventListener\\\\SerializeListener\"],[\"string\",\"onKernelView\"]]],[\"object\",\"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"],[\"string\",\"kernel.view\"],[\"object\",\"Symfony\\\\Component\\\\HttpKernel\\\\Debug\\\\TraceableEventDispatcher\"]]},{\"namespace\":\"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\",\"short_class\":\"WrappedListener\",\"class\":\"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\",\"type\":\"-\\u003E\",\"function\":\"__invoke\",\"file\":null,\"line\":null,\"args\":[[\"object\",\"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"],[\"string\",\"kernel.view\"],[\"object\",\"Symfony\\\\Component\\\\EventDispatcher\\\\EventDispatcher\"]]},{\"namespace\":\"\",\"short_class\":\"\",\"class\":\"\",\"type\":\"\",\"function\":\"call_user_func\",\"file\":\"\\/app\\/vendor\\/symfony\\/event-dispatcher\\/EventDispatcher.php\",\"line\":212,\"args\":[[\"object\",\"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"],[\"object\",\"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"],[\"string\",\"kernel.view\"],[\"object\",\"Symfony\\\\Component\\\\EventDispatcher\\\\EventDispatcher\"]]},{\"namespace\":\"Symfony\\\\Component\\\\EventDispatcher\",\"short_class\":\"EventDispatcher\",\"class\":\"Symfony\\\\Component\\\\EventDispatcher\\\\EventDispatcher\",\"type\":\"-\\u003E\",\"function\":\"doDispatch\",\"file\":\"\\/app\\/vendor\\/symfony\\/event-dispatcher\\/EventDispatcher.php\",\"line\":44,\"args\":[[\"array\",[[\"object\",\"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"],[\"object\",\"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"],[\"object\",\"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"],[\"object\",\"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\WrappedListener\"]]],[\"string\",\"kernel.view\"],[\"object\",\"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"]]},{\"namespace\":\"Symfony\\\\Component\\\\EventDispatcher\",\"short_class\":\"EventDispatcher\",\"class\":\"Symfony\\\\Component\\\\EventDispatcher\\\\EventDispatcher\",\"type\":\"-\\u003E\",\"function\":\"dispatch\",\"file\":\"\\/app\\/vendor\\/symfony\\/event-dispatcher\\/Debug\\/TraceableEventDispatcher.php\",\"line\":146,\"args\":[[\"string\",\"kernel.view\"],[\"object\",\"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"]]},{\"namespace\":\"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\",\"short_class\":\"TraceableEventDispatcher\",\"class\":\"Symfony\\\\Component\\\\EventDispatcher\\\\Debug\\\\TraceableEventDispatcher\",\"type\":\"-\\u003E\",\"function\":\"dispatch\",\"file\":\"\\/app\\/vendor\\/symfony\\/http-kernel\\/HttpKernel.php\",\"line\":158,\"args\":[[\"string\",\"kernel.view\"],[\"object\",\"Symfony\\\\Component\\\\HttpKernel\\\\Event\\\\GetResponseForControllerResultEvent\"]]},{\"namespace\":\"Symfony\\\\Component\\\\HttpKernel\",\"short_class\":\"HttpKernel\",\"class\":\"Symfony\\\\Component\\\\HttpKernel\\\\HttpKernel\",\"type\":\"-\\u003E\",\"function\":\"handleRaw\",\"file\":\"\\/app\\/vendor\\/symfony\\/http-kernel\\/HttpKernel.php\",\"line\":68,\"args\":[[\"object\",\"Symfony\\\\Component\\\\HttpFoundation\\\\Request\"],[\"integer\",1]]},{\"namespace\":\"Symfony\\\\Component\\\\HttpKernel\",\"short_class\":\"HttpKernel\",\"class\":\"Symfony\\\\Component\\\\HttpKernel\\\\HttpKernel\",\"type\":\"-\\u003E\",\"function\":\"handle\",\"file\":\"\\/app\\/vendor\\/symfony\\/http-kernel\\/Kernel.php\",\"line\":171,\"args\":[[\"object\",\"Symfony\\\\Component\\\\HttpFoundation\\\\Request\"],[\"integer\",1],[\"boolean\",true]]},{\"namespace\":\"Symfony\\\\Component\\\\HttpKernel\",\"short_class\":\"Kernel\",\"class\":\"Symfony\\\\Component\\\\HttpKernel\\\\Kernel\",\"type\":\"-\\u003E\",\"function\":\"handle\",\"file\":\"\\/app\\/web\\/index.php\",\"line\":39,\"args\":[[\"object\",\"Symfony\\\\Component\\\\HttpFoundation\\\\Request\"]]}]}\nI'm using flex and this is my composer.json\n```json\n{\n    \"type\": \"project\",\n    \"license\": \"proprietary\",\n    \"require\": {\n        \"php\": \"^7.1.3\",\n        \"alcaeus/mongo-php-adapter\": \"^1.1@dev\",\n        \"api-platform/api-pack\": \"^2.1@dev\",\n        \"doctrine/mongodb-odm\": \"^1.0.5\",\n        \"doctrine/mongodb-odm-bundle\": \"^3.0\",\n        \"symfony/console\": \"^3.3\",\n        \"symfony/flex\": \"^1.0\",\n        \"symfony/framework-bundle\": \"^3.3\",\n        \"symfony/monolog-bundle\": \"^3.0@dev\",\n        \"symfony/web-server-bundle\": \"^4.0@dev\",\n        \"symfony/yaml\": \"^3.3\"\n    },\n    \"minimum-stability\": \"dev\",\n    \"require-dev\": {\n        \"symfony/dotenv\": \"^3.3\"\n    },\n    \"provide\" : {\n        \"ext-mongo\": \"\"\n    },\n    \"config\": {\n        \"preferred-install\": {\n            \"\": \"dist\"\n        },\n        \"sort-packages\": true\n    },\n    \"autoload\": {\n        \"psr-4\": {\n            \"App\\\": \"src/\"\n        }\n    },\n    \"autoload-dev\": {\n        \"psr-4\": {\n            \"App\\Tests\\\": \"tests/\"\n        }\n    },\n    \"scripts\": {\n        \"auto-scripts\": {\n            \"make cache-warmup\": \"script\",\n            \"assets:install --symlink --relative %WEB_DIR%\": \"symfony-cmd\"\n        },\n        \"post-install-cmd\": [\n            \"@auto-scripts\"\n        ],\n        \"post-update-cmd\": [\n            \"@auto-scripts\"\n        ]\n    },\n    \"conflict\": {\n        \"symfony/symfony\": \"*\",\n        \"symfony/twig-bundle\": \"<3.3\",\n        \"symfony/debug\": \"<3.3\"\n    },\n    \"extra\": {\n        \"symfony\": {\n            \"id\": \"01BJ7D0KCZK3WQP9ZRYVBSH55B\",\n            \"allow-contrib\": \"true\"\n        }\n    }\n}\nAnd my container.ymlyml\nPut parameters here that don't need to change on each machine where the app is deployed\nhttps://symfony.com/doc/current/best_practices/configuration.html#application-related-configuration\nparameters:\n    locale: 'en'\nservices:\n    api_platform.iri_converter:\n        public: false\n        class: \"App\\Bridge\\Symfony\\Routing\\IriConverter\"\n        arguments: ['@api_platform.metadata.property.name_collection_factory', '@api_platform.metadata.property.metadata_factory', '@api_platform.item_data_provider', '@api_platform.route_name_resolver', '@api_platform.router', '@api_platform.property_accessor']\n        tags: [{ name: 'api_platform.iri_converter', id: 'api_platform.iri_converter' }]\nproduct.collection_data_provider:\n    class: 'App\\DataProvider\\ProductCollectionDataProvider'\n    arguments:\n        $managerRegistry: \"@doctrine_mongodb.odm.document_manager\"\n    public: true\n    autowire: true\n    tags:\n        -  { name: 'api_platform.collection_data_provider', priority: 2 }\n\n```\nWorking DataCollection with ODM\n```php\n<?php\n/*\n * @author     veeenex veeenex@gmail.com\n * @created_at 10.6.2017 0:47\n /\nnamespace App\\DataProvider;\nuse ApiPlatform\\Core\\Bridge\\Doctrine\\Orm\\Extension\\QueryResultCollectionExtensionInterface;\nuse ApiPlatform\\Core\\Bridge\\Doctrine\\Orm\\Util\\QueryNameGenerator;\nuse ApiPlatform\\Core\\Exception\\RuntimeException;\nuse App\\Document\\Product;\nuse ApiPlatform\\Core\\Exception\\ResourceClassNotSupportedException;\nuse ApiPlatform\\Core\\DataProvider\\CollectionDataProviderInterface;\nuse Doctrine\\ODM\\MongoDB\\DocumentManager;\nfinal class ProductCollectionDataProvider implements CollectionDataProviderInterface\n{\n    private $managerRegistry;\n    private $collectionExtensions;\n/**\n * @param \\Doctrine\\ODM\\MongoDB\\DocumentManager $managerRegistry\n * @param QueryCollectionExtensionInterface[]                                     $collectionExtensions\n */\npublic function __construct(DocumentManager $managerRegistry, array $collectionExtensions = [])\n{\n    $this->managerRegistry = $managerRegistry;\n    $this->collectionExtensions = $collectionExtensions;\n}\n\npublic function getCollection(string $resourceClass, string $operationName = null)\n{\n    if (Product::class !== $resourceClass) {\n        throw new ResourceClassNotSupportedException();\n    }\n\n    $repository = $this->managerRegistry->getRepository(\"App:Product\");\n    if (!method_exists($repository, 'createQueryBuilder')) {\n        throw new RuntimeException('The repository class must have a \"createQueryBuilder\" method.');\n    }\n\n    $queryBuilder = $repository->createQueryBuilder('o');\n    $queryNameGenerator = new QueryNameGenerator();\n    foreach ($this->collectionExtensions as $extension) {\n        $extension->applyToCollection($queryBuilder, $queryNameGenerator, $resourceClass, $operationName);\n\n        if ($extension instanceof QueryResultCollectionExtensionInterface && $extension->supportsResult($resourceClass, $operationName)) {\n            return $extension->getResult($queryBuilder);\n        }\n    }\n\n    return [$repository->findAll()];\n}\n\n}\n``. I'm still getting the errorUnable to generate an IRI for the item of type App\\Document\\Product`, so I need to have custom IriConverter because I can't get identifier from ODM Product. . ",
    "antonioperic": "I am stupid :). Ok, I defined Action as Service manually and this woreked. @Simperfit cover is virtual property generated on fly. . @Simperfit yes if i adde serilization then i have it in respone, i dont want it in response just to get it for calucation. not a bug. @dleute did you resolve this and how? I am using symfony4 and cannot get this login thing to work. wrong routing config. seems that extensions work properly. @alanpoulain I am not expert in graphql, but seems that only query has some to do with collections, so maybe go with first case?\nquery:\n    collection:\n        something...\n    item:\n        something...\nIt is nice and clean.\n. ",
    "quentinus95": "Ok, thanks for the advice.\nI keep it as is, so.. You can reference the dist file in docker-compose using:\nenv_file:\n      - ./.env.dist. ",
    "jocel1": "Sure!\n```php\n<?php\nnamespace AppBundle\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Component\\Validator\\Constraints as Assert;\n/\n * This is a dummy entity. Remove it!\n \n * @ApiResource\n * @ORM\\Entity\n /\nclass Foo\n{\n    /\n     * @var int The entity Id\n     \n     * @ORM\\Id\n     * @ORM\\GeneratedValue\n     * @ORM\\Column(type=\"integer\")\n     /\n    private $id;\n/**\n * @var string Something else\n *\n * @ORM\\Column\n * @Assert\\NotBlank\n */\nprivate $bar = '';\n\npublic function getId()\n{\n    return $this->id;\n}\n\npublic function is169() : string\n{\n    return $this->bar;\n}\n\npublic function setBar(string $bar)\n{\n    $this->bar = $bar;\n}\n\n}\n```. Basically it happens because in InheritedPropertyNameCollectionFactory / ExtractorPropertyNameCollectionFactory, the propertyName is stored as a key of the array $propertyNames, which is automagically converted by PHP into an int if it's a number.. FYI, I'm currently working on a PR to fix the issue. Just pushed the PR. However, I failed to modify the tests to cover this issue (I tried playing with the Dummy entity, but it was not failing). ",
    "amarCosmospace": "Thanks for your answer. I've tried it and it's a no no i got the same issue\nSWServices:\n        class: AppBundle\\Services\\SWServices\n        arguments: [ \"@doctrine.orm.entity_manager\" , \"@service_container\" ]\n        autowire: true\n    MailSpecial:\n        class: AppBundle\\Action\\MailSpecial\n        autowire: true\nI've also tried this : \nSWServices:\n        class: AppBundle\\Services\\SWServices\n        arguments: [ \"@doctrine.orm.entity_manager\" , \"@service_container\" ]\n        autowire: true\n    MailSpecial:\n        class: AppBundle\\Action\\MailSpecial\n        arguments: [ \"@SWServices\" ]\n        autowire: true. Yes i got exactly the same error.\nI've tested the same configuration in a side controller and it works well.. @soyuka i've tried both and i got the same result... it's akward. ",
    "cookingfox": "BUMP: It would be great if someone could help me with this!. That looks promising, thanks @soyuka & @bwegrzyn ! I'll try it out later today. . BUMP: It would be great if someone could help me with this!. Sounds good, I'll try this.. ",
    "bwegrzyn": "Hi @cookingfox. Check out https://github.com/api-platform/core/issues/1062. I've added a feature request to implement something similar to this directly in api-platform/core. \nMy implementation has some short comings that would need to be addresses in order to provide a full solution, but its working for me for the moment. There is some working being done in https://github.com/symfony/symfony/pull/18834 & https://github.com/api-platform/core/pull/1036 that should help in that regard.. Thanks @soyuka. This looks like exactly what I need, looking forward to seeing this released.. ",
    "cocciagialla": "@jhonatanTeixeira I have the same problem. Did you find any solution?. Thanks @Simperfit I will follow your suggestion.. ",
    "Dragonqos": "Any solution found? . My bad, seems you right. It would be good to add this to composer suggests). ",
    "jhonatanTeixeira": "I now understand that this is due to the way apiplatform expose the relationships by using the iri converter. Therefore its a string, you cannot send an entire entity on this json. You have to customize the entire thing if you want to work with nested objects. ",
    "benfavre": "Not sure how you expect people to set the name of the Header to \"Authorization\" or how to prepend \"Bearer \" to the token string.\nHave tried everything, not sure what you mean by 2.1-dev has this \"built-in\", not sure this is possible right now, wich makes me wonder if this project is actually used by anyone ?\n\n. Well after going through the process of changing how my whole project works in order to use the Oauth server. (\"I didn't need to have\" an Oauth server, just needed to validate tokens).\nBasically for swagger to populate the token name in the \"authed requests\" the shape of the token API response, needs to respond with this shape of response : \n{\naccess_token: \"theToken\",\ntoken_type: \"Bearer\"\n....\n}\nAnyway, there's still an issue in the procedure in the linked tutorial above, unless you set the default string of \"bearer\" is set to \"Bearer\" (capital B), then it fails.\nSo you need to add a config param (/app/config/config.yml): \nfos_oauth_server:\n    service:\n        options:\n            token_type: Bearer. ",
    "younus-md": "@benfavre , Can you provide the sample project structure?. ",
    "vincent-dravert": "Need a rubber duck @antonioperic  ?  ;-)\n\n. ",
    "toulemol": "Would it not be easier to use PUT as a method since you only want to modify a property ? . ",
    "castroCrea": "Hello,\nSorry for the late answer\nThere is what i means\nFor exemple i have the entity : \n`<?php\n// src/AppBundle/Entity/Product.php\nnamespace AppBundle\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Component\\Validator\\Constraints as Assert;\n/\n * @ApiResource\n * @ORM\\Entity\n */\nclass Product // The class name will be used to name exposed resources\n{\n    /\n     * @ORM\\Column(type=\"integer\")\n     * @ORM\\Id\n     * @ORM\\GeneratedValue(strategy=\"AUTO\")\n     */\n    public $id;\n/**\n * @param string $name A name property - this description will be avaliable in the API documentation too.\n *\n * @ORM\\Column\n * @Assert\\NotBlank\n */\npublic $name;\n\n/**\n * @ORM\\ManyToOne(targetEntity=\"Category\")\n */\npublic $category;\n\n/**\n * @ORM\\ManyToOne(targetEntity=\"Country\")\n */\npublic $country;\n\n}`\nAnd i want to generate the CRUD\nFor the form i have to make a request to get all the category and one to get all the country\nDespite to do 2 request I think it will be nice to have one request to get all the dependency of the form.\nThere it's just 2 but we can imagine that it can be more, for exemple i'm working on a project right know where i have 5 dependency so 5 requests api.\nSo it will be faster to do just one.\nMaybe it can be a nice feature for the next release\nHave good day\nPaolo. I want to get all the category and the country to make a post form actually, with this i get the country and the-catgeroy of the product no?. ",
    "Metisse": "up. ",
    "BonnieDoug": "Have you tried using the assert validation functions in your entities?\nhttps://symfony.com/doc/current/validation.html\nWhen setup, these provide pretty errors in Hydra format. \n. To fix the issue you simply need to add the Action directory to the service loader:\n# config/services.yaml\nservices:\n   App\\Action\\:\n        resource: '../src/Action'\n        tags: ['controller.service_arguments']\n\nAnd then add the Action folder to your annotations loader:\n# config/routes/annotations.yaml\nactions:\n    resource: ../../src/Action/\n    type: annotation. No, I've just worked it out as I was also having the same issue. Problem with the docs is they are predominantly targeted at PRE-Flex Symfony, so not as simple as just adding the above to the docs.\n\nBy this I mean there is a lot of mention of AppBundle/ which no longer exists. . @antograssiot Thank you very much. I knew I'd read it somewhere at some point (when I first read through the entire docs I assume) I just couldn't for the life of me find it when I was looking for it \ud83d\ude11 thought I just have dreamt it \ud83d\ude05. @antograssiot, When you use an extension, how did you get the API-Platform to reference it? There's no mention in the docs of putting it in the annotations etc, but it's definitely not firing at present.. @antograssiot, I have this working now, however it now affects ALL endpoints, where I only want it to affect some, where specified. For example, my /topics endpoint doesn't have a User property, so now I get the following error:\n\n\"hydra:description\": \"[Semantical Error] line 0, col 40 near 'user = :current_user': Error: Class App\\Entity\\Topic has no field or association named user\",\n\n. Thank you, I think I found a slightly clearer solution (but again I'm unsure if its best practice).\nIn the doc's example they do a check to see if the $resourceClass == Offers, however this ties it to that class. So instead of this I've got the follow which checks if the method exists dynamically:\n$client = $this->tokenStorage->getToken()->getUser()->getClient();\nif ($client instanceof Client && method_exists(new $resourceClass, 'getClient') && !$this->authorizationChecker->isGranted('ROLE_SUPER_ADMIN')) {\n     $rootAlias = $queryBuilder->getRootAliases()[0];\n     $queryBuilder->andWhere(sprintf('%s.client = :current_client', $rootAlias));\n     $queryBuilder->setParameter('current_client', $client->getId());\n}\nI hope this helps someone else at some point, and thank you @antograssiot  for your help.\n. What happens when you call that same endpoint from within the  Api-Platform User interface?\nI'm thinking it might be because your content type is application/json where it should be application/ld+json OR you need to enable application/json in your config.. Ah, good at least that narrows it down tot he way your sending the data. I think the structure of your 'POST' is wrong.\nI'm fairly sure, you shoudln't be Stringifying your Json... try this instead:\nlet data = { data: this.cardData.brand }\naxios.post('api/products', data)\nAlso the data: should really be the name of the property you're targeting eg:\nlet product = {\n   name: 'A name',\n   description: 'The description'\n}\n. @byhoratiss Do you want multiple entity managers because you:\n\nHave multiple databases within one Mysql instance?\nHave multiple databases spread over different servers? \n\nIf it's 1 then where you  define the table, you can also specify the database eg:\n/**\n * Class WorkSectorSubQuestion\n * @ApiResource()\n * @ORM\\Entity()\n * @ORM\\Table(\"foo_database.bar_table\")\n */\n. Your jwt token seems very short. Have you tried putting it into Jwt.io to see what it actually contains.\nOff the top of my head it shoukd contain at least 2 full stops. . So if you log in using curl e.g: \ncurl -X POST \"http://localhost:8000/api/login\" -H  \"accept: application/ld+json\" -H  \"Content-Type: application/ld+json\" -d \"{  \\\"username\\\": \\\"foo\\\",  \\\"password\\\": \\\"bar\\\"}\"\nYou should get a JWT token in response. What is the result of this?. I don't think you should be POSTing to login_check, that get's called after by the framework. You log in by going to /api/login and filling in the form OR by POSTing to the endpoint. Depending on how you have it set up.. I think this is already possible. Unless I'm misunderstanding your question the following should suffice.\nSupposing you have a property as below, which is causing the not a string error:\n``` php\n    /*\n     * @var string\n     * @ORM\\Column(nullable=true)\n     /\n    private $property = null;\n/**\n * @return string\n */\npublic function getProperty (): string\n{\n    return $this->property;\n}\n\n/**\n * @param string $property\n * @return MyClass\n */\npublic function setProperty (string $property): MyClass\n{\n    $this->property = $property;\n    return $this;\n}\n\n```\nBy replacing this with ?string and string|null in the annotations you'll be able to provide a string or null:\n``` php\n    /*\n     * @var string|null\n     * @ORM\\Column(nullable=true)\n     /\n    private $property = null;\n/**\n * @return null|string\n */\npublic function getProperty (): ?string\n{\n    return $this->property;\n}\n\n/**\n * @param null|string $property\n * @return MyClass\n */\npublic function setProperty (?string $property): MyClass\n{\n    $this->property = $property;\n    return $this;\n}\n\n```\nHope this helps.. ",
    "amaccis": "@Simperfit I abandoned the idea to add the error detail, since it turned that it was not essential.\nSo the issue can be closed. Thanks.. It seems the upgrade (2.1.0) solved the problem.\nNow it's working.\nA.. @hassanjuniedi what kind of informations do you need?\nIf you are using a \"not mapped\" config file to set your filters, you need to import it in order to make it \"available\". I mean, config.yml\nimports:\n    - { resource: api_filters.yml }\nAnd after that you can just follow the excerpts I wrote above, to shape your config.. ",
    "glanchow": "I ran the same issue, please add pcre-dev in the Dockerfile line 14 like this\n$PHPIZE_DEPS \\\n        pcre-dev \\\n    icu-dev \\\nI will submit a PR in a few minutes. ",
    "bnd170": "Thanks guys! it worked.. ",
    "Saphyel": "@Simperfit if you are using different port from 80 (lets say 8080) is still trying to redirect to the port 80.. I attached a screenshot explaining better what I mean...\n\n. You need to add the public/.htaccess. ",
    "DylanFayant": "Thank you Simperfit, I found the solution by using the groups and extending the password field. . Thank you for your reply. \nUniqueEntity is used to make sure that a field is unique in the database. \nHere the thing is that I want to get an user through the API, by its email, to check in my mobile app if there is already an user in the database with the same email.\nThank you again for your time =). Thank you, filtering works perfectly. I saw this page into the doc but I thought it couldn't solve my problem, sorry for the disturbing ^^ !\nHave a nice day and thank you again.. Super ! It's working perfectly.\nThank you so much !. ",
    "stadskle": "``` $ php -v\nPHP 7.1.3 (cli) (built: Mar 19 2017 17:36:32) ( NTS )\nCopyright (c) 1997-2017 The PHP Group\nZend Engine v3.1.0, Copyright (c) 1998-2017 Zend Technologies\n    with Zend Extension Manager v9.1.0, Copyright (c) 2004-2017, by Zend Technologies\n    - with Zend Data Cache v9.1.0, Copyright (c) 2004-2017, by Zend Technologies [loaded] [licensed] [disabled]\n    - with Zend Java Bridge v9.0.0, Copyright (c) 2004-2017, by Zend Technologies [loaded] [licensed] [enabled]\n    - with Zend Job Queue v9.1.0, Copyright (c) 2004-2017, by Zend Technologies [loaded] [licensed] [enabled]\n    - with Zend Utils v9.1.0, Copyright (c) 2004-2017, by Zend Technologies [loaded] [licensed] [enabled]\n    - with Zend OPcache v7.1.3, Copyright (c) 1999-2017, by Zend Technologies [loaded] [licensed] [enabled]\n    - with Zend Code Tracing v9.1.0, Copyright (c) 2009-2017, by Zend Technologies [loaded] [licensed] [enabled]\n    - with Zend Server Z-Ray v9.1.0, Copyright (c) 2004-2017, by Zend Technologies [loaded] [licensed] [enabled]\n    - with Zend Monitor v9.1.0, Copyright (c) 1999-2017, by Zend Technologies [loaded] [licensed] [disabled]\n    - with Zend Debugger v9.1.0, Copyright (c) 1999-2017, by Zend Technologies [loaded] [licensed] [enabled]\n    - with Zend Page Cache v9.1.0, Copyright (c) 2004-2017, by Zend Technologies [loaded] [licensed] [disabled]````. I disabled all I could find, things like z-ray etc are not running in CLI. No difference in the result, still the same error.\nphp -v\nPHP 7.1.3 (cli) (built: Mar 19 2017 17:36:32) ( NTS )\nCopyright (c) 1997-2017 The PHP Group\nZend Engine v3.1.0, Copyright (c) 1998-2017 Zend Technologies\n    with Zend Extension Manager v9.1.0, Copyright (c) 2004-2017, by Zend Technologies\n    - with Zend Data Cache v9.1.0, Copyright (c) 2004-2017, by Zend Technologies [loaded] [licensed] [disabled]\n    - with Zend Java Bridge v9.0.0, Copyright (c) 2004-2017, by Zend Technologies [loaded] [licensed] [enabled]\n    - with Zend Job Queue v9.1.0, Copyright (c) 2004-2017, by Zend Technologies [loaded] [licensed] [enabled]\n    - with Zend Utils v9.1.0, Copyright (c) 2004-2017, by Zend Technologies [loaded] [licensed] [enabled]\n    - with Zend OPcache v7.1.3, Copyright (c) 1999-2017, by Zend Technologies [loaded] [licensed] [enabled]\n    - with Zend Code Tracing v9.1.0, Copyright (c) 2009-2017, by Zend Technologies [loaded] [licensed] [enabled]\n    - with Zend Server Z-Ray v9.1.0, Copyright (c) 2004-2017, by Zend Technologies [loaded] [licensed] [enabled]\n    - with Zend Monitor v9.1.0, Copyright (c) 1999-2017, by Zend Technologies [loaded] [licensed] [disabled]\n    - without debugger [not loaded]\n    - with Zend Page Cache v9.1.0, Copyright (c) 2004-2017, by Zend Technologies [loaded] [licensed] [disabled]. Ok, thanks, I will do some more testing. Does it work if I do the build on another computer and just copy the folder to my mac? I ran the process on my debian server, and except some deprecation notices it seemed to work fine.. ",
    "angelov-todor": "This is an example I use:\n```\nsrc/AppBundle/Resources/config/api_resources/resources.yml\nAppBundle\\Entity\\Dictionary\\Word:\n  collectionOperations:\n    get:\n      method: 'GET' # nothing more to add if we want to keep the default controller\n      normalization_context:\n        groups: ['list_words']\n  itemOperations:\n    get:\n      method: 'GET'\n      normalization_context:\n        groups: ['get_word']\n    rhymeform:\n      route_name: 'rhymeform'\n      swagger_context:\n        parameters:\n          -\n            name: id\n            in: path\n            required: true\n            type: string\n        responses:\n          200:\n            description: \"rhymeform of the word\"\n            schema:\n              type: \"object\"\n              required: [\"rhymeform\"]\n              properties:\n                rhymeform:\n                  type: \"string\"\n          404:\n            description: \"Resource not found\"\n        summary: \"Retrieve the rhymeform of a word\"\n        consumes: [\"application/json\", \"text/html\"]\n        produces: [\"application/json\"]\n    syllables:\n      route_name: 'syllables'\n      swagger_context:\n        parameters:\n          -\n            name: id\n            in: path\n            required: true\n            type: string\n        responses:\n          200:\n            description: \"syllables of the word separated by dash\"\n            schema:\n              type: \"object\"\n              required: [\"syllables\"]\n              properties:\n                syllables:\n                  type: \"string\"\n          404:\n            description: \"Resource not found\"\n        summary: \"Retrieve the syllables of a word\"\n        consumes: [\"application/json\", \"text/html\"]\n        produces: [\"application/json\"]\n```\nSame can be achieved with annotations.\nMore about the schema can be found in the swagger documentation.. ",
    "LTRocky": "@angelov-todor thanks. ",
    "Evertt": "@Simperfit okay that would give me the type of every field, but it wouldn't tell me all the specific validation rules that apply to every field, right? It would be nice to be able to let angular or formly already perform validation before submitting the form.. @theofidry well since it's possible to describe your validation rules in Symfony using YAML, I would say why not just converting that YAML to JSON. Then it's up to the javascript developer to write client-side code that does the same thing as the serverside validators do. Wouldn't that work?. Ah yes I didn't think about the security issue. Well in that case it might be nice to expose an api endpoint which can be used to only validate form input(s) without submitting anything yet, so that users can still be notified on their wrong inputs while they are still filling it in. . So what are you suggesting then? The whole point of my proposal is to make it possible to fully automatically let a javascript generate a form that's compliant with what the backend expects to receive. So first I suggested to be able to get all the necessary information (including validation rules) in a json from the server, but you explained that would be a security issue. So now I suggested to then let the validation be handled by the server and now you say the front-end should handle the validation, which was my first suggestion already.\nI want to prevent the situation where I have to maintain the same business rules twice, once for the front-end and once for the backend. I don't mean to sound snappy, I just think we're having a misunderstanding.. ",
    "todor-programista": "Anyone?. It actually does help. This will fit most of my cases.\nI can make validation whether the relation is empty and throw an exception.\nThanks a lot.\np.s. It would be a nice feature for such relational constraint exceptions to be handled by the framework though.. ",
    "cormack": "I ran into the same problem earlier.\n```\napp/config/config.yml\ndunglas_action:\n    directories:\n        - '../src/*Bundle/Action'\n```\nThat snippet above solved it for me. Goto https://github.com/dunglas/DunglasActionBundle for more information.. ",
    "vdumontier": "Hi\nFor Symfony > 3.3 users, note that controller or actions services must be configured public and have a tag that allows actions to type-hint services.\nAccording the 3.3 DI Container Changes : \nhttp://symfony.com/doc/master/service_container/3.3-di-changes.html#the-new-default-services-yml-file. Same issue for me with Docker/Window.\nAs complement you can execute dos2unix on the file to resolve the issue :\ndos2unix.exe docker/app/install-composer.sh\n. Just cloning a repos setup before this commit :) I suppose my comment can help someone in the same case. But no need to re-open the issue.. ",
    "dmeziere": "Ok, I will have a lot to read, now :) This was my very first steps with this bundle, so for the moment this seems like a Norvegian picture with Japanese subtitles :)\nThe doc says that no configuration is mandatory, so I thought my existing code would still work when adding the bundle. The problem is that I don't really have any problem width the API, it is working well. It's all the existing work that break when I activate the bundle. Is API-platform exclusive ? I mean can I still use my application the way it worked before adding the bundle ? Or must I make a new project from scratch using only the API ?. Soyuka: I have not added any api_platform directive in my conf for now. I just wanted to check that my existing application worked after adding api platform, for a start.. Unfortunately this is a proprietary application, top-secret marketkiller shit. I think I can give you the complete list of used bundles without getting fired, not that i wouldn't like to.\n```\n    \"require\": {\n        \"php\": \">=5.5.9\",\n        \"symfony/symfony\": \"3.2.*\",\n        \"doctrine/orm\": \"^2.5\",\n        \"doctrine/doctrine-bundle\": \"^1.6\",\n        \"doctrine/doctrine-cache-bundle\": \"^1.2\",\n        \"symfony/swiftmailer-bundle\": \"^2.3.10\",\n        \"symfony/monolog-bundle\": \"^3.0.2\",\n        \"symfony/polyfill-apcu\": \"^1.0\",\n        \"sensio/distribution-bundle\": \"^5.0\",\n        \"sensio/framework-extra-bundle\": \"^3.0.2\",\n        \"incenteev/composer-parameter-handler\": \"^2.0\",\n        \"twig/twig\": \"^1.0||^2.0\",\n        \"friendsofsymfony/user-bundle\": \"dev-master\",\n        \"api-platform/core\": \"^2.0\"\n```. I've tested with creating an api-platform project, instead of starting from an existing code that I didn't made. Everything seems to work fine. I guess there was an invisible problem in the existing code, that Api platform only raised.. ",
    "kokoulin": "Omg, thx. ",
    "summermick": "I did followed the documentation directly on the fosUserBundle github and got the error. I'm using 1.3 version, the issue fixed by using 2.0\nbut now the new models other than Foo don't show at all.. ",
    "Lyrkan": "Hi @Simperfit,\nI understand that they are two different normalizers, but even if they don't yield the same result they still have a lot of common points (hence the AbstractItemTransformer they currently share).\nLet's say you have an API that supports both JSON and JSON-LD with a resource that has to be modified the same way in both representations (as an example: adding a computed value).\n\nIf you only decorate api_platform.serializer.normalizer.item: The computed value will not be present in the response if the client requests the JSON-LD representation\nIf you only decorate api_platform.jsonld.normalizer.item : The computed value will not be present in the response if the client requests the JSON representation\n\nHaving a common ItemNormalizer injected into and used by both JSON and JSON-LD ItemNormalizer would be a way to allow people to handle that kind of case.. There is no problem per-se but it can become really verbose really fast.\nIn my previous posts I was only talking about JSON and JSON-LD with one decorator applied twice.\nNow imagine you also want to support JSON-HAL (since it also uses the normalize method of the AbstractItemNormalizer). It means that you'll have to decorate that normalizer too if you want your computed properties to be in the response object.\nThen you may want to have other decorators to handle n  other resource types. You now have n * 3 declarations in your services.yml instead of just n.. @soyuka Wouldn't it be possible to keep the normalizers separated but still having a \"base\" normalizer used by all of them ?\nThere is already a big part of the code that is shared between them (ApiPlatform\\Core\\Serializer\\AbstractItemNormalizer) so at first I was expecting something like:\n\napi_platform.serializer.normalizer.item: do the common things, basically what AbstractItemNormalizer does nowadays\napi_platform.json.normalizer.item: uses api_platform.serializer.normalizer.item (the same way it calls parent::denormalize at the end of its own denormalize method) and does specific things\napi_platform.jsonld.normalizer.item: same thing but with jsonld specific parts\napi_platform.hal.normalizer.item: same thing but with hal specific parts\n\nThat would still allow people to only decorate json/jsonld/hal normalizers if needed, or decorate the common normalizer for properties that must be added/modified in every formats.. ",
    "sebastienhouzet": "Perfect \ud83d\udc4d \nFor people use MAMP PRO, you can read this article to help you to use PHP 7.X on CLI.\nhttps://gist.github.com/irazasyed/5987693\nThx :). ",
    "vbourdeix": "I'm using Docker CE for Windows. I tried to add a .gitattributes with text eol=lf but that didn't change anything for me.\nWith the v2.1.0-beta.2, the setup is different and works like a charm. Seems like I'll stick with this version.. Thanks @webda2l for the detailed answer. I used a slightly different approach because I want to reinit my database for each behat scenario in order to keep them independent from their order.\nI put a different doctrine config for the test environment and added a hook to my FeatureContext class :\n/**\n     * @BeforeScenario\n     */\n    public function createDatabase()\n    {\n        $this->schemaTool->dropDatabase();\n        $this->schemaTool->createSchema($this->classes);\n    }\nI also had an issue with my sqlite database not being accessible when configured in the cache folder, as if it was cleared automatically after each BeforeScenario hook. As soon as I put it elsewhere (in the root project folder for simplicity), I stopped running into \"This table doesn't exists\" issue.\nAs it now works for me I will close the issue.. Don't know if that will help, but when that happens, I docker-compose stop then docker-compose up -d my different services and generally it works. I don't like the fact that I don't really understand this issue, but it allowed me to continue working on my project without wasting time on Docker related stuff.. Ok I got it, there is a public/bundles/ inside .dockerignore.\nDoes this mean I'm supposed to generate the bundles directory during the build phase ? This makes sense for the php container which can run an assets install but it feels weird for the nginx container.\nAny advice about this ?. Hello, I had the same issue, and your suggestion solved it. Thanks @you-ser .. ",
    "Bwen": "I had this problem and after changing to LF all the .sh scripts everything was fine.\nhttps://files.slack.com/files-pri/T39U3FUKV-F5RSU97RB/apiplateform1.png\nIt couldnt find the shebang because of the CRLF\nI'll test with this fix. I'm on Windows 10 Hyper-V, Docker 17.03.1-ce-win12 (12058). Confirmed, fix works :). I got the same error even after making sure the path is present.\nI'm on version v2.1.0-beta.3.. ",
    "akira28": "I've restored the apcu fixed version, and set nginx version to 1.13. \ud83d\udc4d\nAlso, I would gladly help with #334 , if you are interested. Of course \ud83d\udc4c. Doesn't change anything (at the moment), is just \"newer is better\" stuff \ud83d\udc83 . Why? Isn't it better to have the latest stable version for performance and security, instead of having to change it every time a new version is out?. Same reason, performance, security and features are available without having to change this file each time a new version is released.. ",
    "indapublic": "@dunglas Probably not, cannot find it in project (sorry, it's a legacy code). If I'm using pagination_items_per_page = 4, output is different.\nIf pagination_items_per_page = 5, outputs are same except last item\nCannot find a reason. Tried clear the cache, off course. All the same. On remote and local machines.\n\n\"symfony/symfony\": \"3.2.*\",\n\"api-platform/core\": \"^2.0\",. @soyuka Hydra data looks correct, hydra:totalItems is correct. . Removed all items with category != 7a93364b-4cc0-11e7-8ba8-f23c9160bfdb\nSo I testing now without any filter, only pagination. Result is same, I have same items for first and second page.. Tried recreate (with single entity) from scratch - all works :(. Closing now. Inspected logs and found a strange behaviour in Mysql (you can read here). So I reopened topic. I inspected sql logs, api-platform using this sql for pagination:\n\n[2017-06-22 02:47:35] doctrine.DEBUG: SELECT DISTINCT a0_.id AS id_0, a0_.created_at AS created_at_1 FROM app_item a0_ WHERE a0_.published = 1 ORDER BY a0_.created_at DESC LIMIT 5 OFFSET 5 [] []\nWant to be sure it's correct. you can download and export this dump and check:\nselect\n  *\nfrom\n  (\n    select distinct id, created_at from aaa order by created_at desc limit 5 offset 0\n  ) a,\n  (\n    select distinct id, created_at from aaa order by created_at desc limit 5 offset 5\n  ) b\nwhere a.id = b.id\nboth subqueries return duplicate records. ",
    "Sybio": "In fact this is what i've done in previous snippets.\nWhatever i want to return, a void data, a User data, or other, the action always return : \n\"hydra:description\": \"Invalid identifier \\\"\\\", \\\"id\\\" has not been found.\",\nSo you confirm that implementing a custom item operation don't always require \"id\" parameter ? I'll search if there is a route override or another problem like that.... Ok as you says here : https://github.com/api-platform/api-platform/issues/217#issuecomment-274026333\nThe id is required.\nThe only solution i see is to change the logical of my app by returning the id of the user when i request the JWT token and then to use the idto get the user data with a more convential route like /users/{id}.... @Simperfit I understand that but I added some security (requiring the bearer) on /me action to protect it.\nI'm confused because of the response i get when i request /me, which requires an \"id\" parameter even if i don't specify it :s : path=\"/me\",\nIf you have the solution, it would be great ;)\nEDIT : i'll try to create my custom provider just for this route to avoid the fact that API platform try to load a null \"id\" parameter.. Even if it doesn't respect the REST philosophy, I paste my solution for the ones who need to implement a similar action like /me:\nAction:\n```php\n<?php\nnamespace AppBundle\\Action;\nuse Sensio\\Bundle\\FrameworkExtraBundle\\Configuration\\Method;\nuse Symfony\\Component\\Config\\Definition\\Exception\\Exception;\nuse Symfony\\Component\\Routing\\Annotation\\Route;\nuse AppBundle\\Entity\\User;\nuse Doctrine\\Common\\Persistence\\ManagerRegistry;\nclass UserMe\n{\n    /*\n     * @Route(\n     *     name=\"api_users_me\",\n     *     path=\"/me\",\n     *     defaults={\"_api_resource_class\"=User::class, \"_api_item_operation_name\"=\"user_me\"}\n     * )\n     * @Method(\"GET\")\n     * @return User|null\n     /\n    public function __invoke($data)\n    {\n        // Return the User object\n        return $data;\n    }\n}\nProvider:php\n<?php\nnamespace AppBundle\\DataProvider;\nuse AppBundle\\Entity\\User;\nuse ApiPlatform\\Core\\DataProvider\\ItemDataProviderInterface;\nuse ApiPlatform\\Core\\Exception\\ResourceClassNotSupportedException;\nuse AppBundle\\Repository\\UserRepository;\nuse Symfony\\Component\\HttpFoundation\\RequestStack;\nuse Symfony\\Component\\Routing\\Router;\nuse Symfony\\Component\\Routing\\RouterInterface;\nuse Symfony\\Component\\Security\\Core\\Authentication\\Token\\Storage\\TokenStorage;\nfinal class UserItemDataProvider implements ItemDataProviderInterface\n{\n    /*\n     * @var UserRepository\n     /\n    private $repository;\n/**\n * @var TokenStorage\n */\nprivate $tokenStorage;\n\n/**\n * UserMe constructor.\n *\n * @param UserRepository $repository\n * @param TokenStorage   $tokenStorage\n */\npublic function __construct(UserRepository $repository, TokenStorage $tokenStorage)\n{\n    $this->repository   = $repository;\n    $this->tokenStorage = $tokenStorage;\n}\n\n/**\n * @param string      $resourceClass\n * @param int|string  $id\n * @param string|null $operationName\n * @param array       $context\n *\n * @return User|null\n * @throws ResourceClassNotSupportedException\n */\npublic function getItem(string $resourceClass, $id, string $operationName = null, array $context = [])\n{\n    if (User::class !== $resourceClass) {\n        throw new ResourceClassNotSupportedException();\n    }\n\n    // retrieves User from the security when hitting the route 'api_users_me' (no id needed)\n    if ('users_me' === $operationName) {\n        return $this->tokenStorage->getToken()->getUser();\n    }\n\n    return $this->repository->find($id); // Retrieves User normally for other actions\n}\n\n}\nRegister the provider:yaml\nservices:\n    user.item_data_provider:\n        class: AppBundle\\DataProvider\\UserItemDataProvider\n        public: false\n        arguments:\n            - \"@app.repository.user\"\n            - \"@security.token_storage\"\n        tags:\n            -  { name: 'api_platform.item_data_provider' }\nAnd as a bonus, don't forget to secure the `/me` route (if you are using LexikJWTAuthenticationBundle for example):yaml\nsecurity:\n    # ...\n    access_control:\n        # ...\n        - { path: ^/me, methods: [GET], roles: ROLE_USER }\n```. With pleasure @dunglas, I'll write documentation soon on https://github.com/api-platform/docs. Ok I just forgot the denormalization_context... Thanks for your help !. Thanks for your reply !\nOk this is bad news \ud83d\ude22\nIs there a way to override denormalizer and replace resource class when it's AppBundle\\Entity\\Subpick by AppBundle\\Entity\\SubpickTypeFree (and by checking the parameter \"@type\") ?\nSubpick childs contain too much differents fields to avoid inheritance...\nI think i'll do what you suggest : \nA \"type\" field on my Subpick class and no inheritance.\nAnd to avoid too much fields on this class, add OneToOne relations on Subpick to new classes SubpickDataFree and SubpickDataEvent.\n```php\n/*\n * @ApiResource(...)\n * @ORM\\Table(name=\"subpick\")\n * @ORM\\Entity(repositoryClass=\"AppBundle\\Repository\\SubpickRepository\")\n /\nclass Subpick\n{\n    // ...\n/**\n * @var SubpickDataFree\n *\n * @ORM\\OneToOne(targetEntity=\"AppBundle\\Entity\\SubpickDataFree\", inversedBy=\"subpick\")\n * @ORM\\JoinColumn(name=\"data_free_id\", referencedColumnName=\"id\", nullable=true)\n * ...\n */\nprivate $dataFree;\n\n/**\n * @var SubpickDataEvent\n *\n * @ORM\\OneToOne(targetEntity=\"AppBundle\\Entity\\SubpickDataEvent\", inversedBy=\"subpick\")\n * @ORM\\JoinColumn(name=\"data_event_id\", referencedColumnName=\"id\", nullable=true)\n * ...\n */\nprivate $dataEvent;\n\n}\n```\nAnd make a request like that : \n```json\nPOST /picks\n{\n    \"bookmaker\": \"/bookmakers/6ee03de1-711a-11e7-9be1-848f69ce56ef\",\n    ...\n    \"subpicks\": [\n        { // subpick containing data of type \"Free\"\n            \"position\": 1,\n           \"type\": \"free\",\n            \"dataFree\": {\n                \"bet\": \"My custom bet!\",\n                \"odd\": 1.5,\n            \"dateKickOff\": \"2017-07-30T20:00:00+00:00\",\n            \"category\": \"/categories/6ee84bf5-711a-11e7-9be1-848f69ce56ef\"\n            }\n        },\n        { // subpick containing data of type \"Event\"\n            \"position\": 2,\n           \"type\": \"event\",\n            \"dataEvent\": {\n            \"event\": \"/events/aaa84bf5-711a-11e7-9be1-848f69ce56ef\"\n            }\n        }\n    ]\n}\n```\nBut I have to be sure sub relations can be also created in a POST request, which is probably possible I suppose ? (a POST request should create 3 objects : Pick <-> Subpick -> SubpickDataFree)\nDoes that make sense to you @soyuka ?. Same problem here.\nThe mutation :\ngraphql\nmutation CreateVocabularyMutation {\n  createVocabulary(input: {\n    type: \"terms\",\n    clientMutationId: \"abcde\",\n    items: [\"/api/items/00006059-7b73-11e8-9dce-b06ebf1b7b06\"]\n  }) {\n    id\n    type\n    clientMutationId\n    items {\n      edges {\n        cursor\n        node {\n          id\n          lang\n        }\n      }\n    }\n  }\n}\nRendering :\ngraphql\n{\n  \"data\": {\n    \"createVocabulary\": {\n      \"id\": \"/api/vocabularies/fa07ed31-cd69-11e8-a1ba-b06ebf1b7b06\",\n      \"type\": \"terms\",\n      \"clientMutationId\": \"abcde\",\n      \"items\": {\n        \"edges\": null\n      }\n    }\n  }\n}\nThe problem is that groups are well defined, to allow displaying items data when performing a Vocabulary mutation :\nVocabulary groups :\n```php\n/*\n * @ApiResource(\n *     graphql={\n *         \"query\"={\"normalization_context\"={\"groups\"={\"vocabularies_get_item\"}}},\n *         \"create\"={\n *             \"normalization_context\"={\"groups\"={\"vocabularies_get_item\"}},\n *             \"denormalization_context\"={\"groups\"={\"vocabularies_create_mutation\"}},\n *             \"validation_groups\"={\"vocabularies_create_mutation\"}\n *         }\n *     },\n * )\n * ...\n * ...\n * ...\n /\nclass Vocabulary\n{\n    // ...\n/**\n * @var ArrayCollection\n *\n * @ORM\\OneToMany(targetEntity=\"App\\Entity\\Item\", mappedBy=\"vocabulary\", cascade={\"persist\", \"remove\"})\n * @Groups({\n *     \"vocabularies_get_collection\",\n *     \"vocabularies_get_item\",\n *     \"vocabularies_create_mutation\",\n * })\n */\nprivate $items;\n\n// ...\n\n}\n```\nItem groups (\"vocabularies_get_item\" inherited by Vocabulary mutation is defined) :\n```php\n/*\n * @ApiResource(\n *     graphql={\n *         \"query\"={\"normalization_context\"={\"groups\"={\"items_get_item\"}}},\n *         \"create\"={\n *             \"normalization_context\"={\"groups\"={\"items_get_item\"}},\n *             \"denormalization_context\"={\"groups\"={\"items_create_mutation\"}},\n *             \"validation_groups\"={\"items_create_mutation\"}\n *         }\n *     },\n * )\n * ...\n /\nclass Item\n{\n    // ...\n/**\n * @var string\n *\n * @ORM\\Id\n * @ORM\\Column(type=\"guid\")\n * @ORM\\GeneratedValue(strategy=\"UUID\")\n * @Groups({\n *     \"items_get_collection\",\n *     \"items_get_item\",\n *     \"vocabularies_get_item\",\n * })\n */\nprivate $id;\n\n// ...\n\n}\n```\nIn database, new \"vocabulary\" is well attached with the \"item\".\nAfter many tests, I think it's a bug. Someone has a solution ?. Thank you for your help @alanpoulain.\nAfter investigation, there is something weird taking place in the normalizer : https://github.com/symfony/serializer/blob/master/Normalizer/AbstractObjectNormalizer.php#L79\n$context seems to be OK when i dump it :\nphp\nAbstractObjectNormalizer.php on line 87:\narray:7 [\n  \"groups\" => array:1 [\n    0 => \"vocabularies_get_item\"\n  ]\n  \"attributes\" => array:4 [\n    \"id\" => true\n    \"type\" => true\n    \"clientMutationId\" => true\n    \"items\" => array:1 [\n      \"edges\" => array:2 [\n        \"cursor\" => true\n        \"node\" => array:2 [\n          \"id\" => true\n          \"lang\" => true\n        ]\n      ]\n    ]\n  ]\n  \"api_sub_level\" => true\n  \"resource_class\" => \"App\\Entity\\Vocabulary\"\n  \"api_normalize\" => true\n  \"cache_key\" => \"4dfe9b54a22ace9641e192b3d924c9e4\"\n  \"circular_reference_limit\" => array:1 [\n    \"000000003270d97400000000294d007e\" => 1\n  ]\n]\nThen when dumping $attributes (https://github.com/symfony/serializer/blob/master/Normalizer/AbstractObjectNormalizer.php#L91), i got :\nphp\nAbstractObjectNormalizer.php on line 89:\narray:3 [\n  0 => \"id\"\n  1 => \"type\"\n  2 => \"items\"\n]\nHere i don't now the expected behavior, but do you think this is normal to get \"items\" key without subproperties (id, lang) ?\nA dump of $data at the end give a void items array : \nphp\nAbstractObjectNormalizer.php on line 124:\narray:3 [\n  \"id\" => \"69c6b9bd-cda9-11e8-a1ba-b06ebf1b7b06\"\n  \"type\" => \"terms\"\n  \"items\" => []\n]\n$object contains the full Vocabulary entity with items.. It could be a great feature !\nSo currently there is no solution (and no GraphQL resolvers ?). So curretly I should mix GraphQL and HTTP REST when needed to create specific objects. Or get User information in frontend and submit it with validation in backend (to check it's the same var). I think i'll do that for the moment.. So here my temporary solution :\nI updated my mutation to accept a user ID (logged user id stored in frontend, like localStorage or redux on a JS app), which is validated in backend :\ngraphql\nmutation CreateNotebookMutation(\n    $title: String!,\n    $user: String!,\n    $clientMutationId: String!,\n) {\n    createNotebook(input: {\n        title: $title,\n        user: $user,\n        clientMutationId: $clientMutationId\n    }) {\n        id\n    }\n}\nA custom assert validates this is the logged user (via UserSameThanLoggedOne validor) :\n```php\n<?php\nclass Notebook\n{\n    // ...\n/**\n * @var User\n *\n * @ORM\\ManyToOne(targetEntity=\"App\\Entity\\User\", inversedBy=\"notebooks\")\n * @ORM\\JoinColumn(name=\"user_id\", referencedColumnName=\"id\")\n * @Groups({\n *     \"notebooks_get_collection\",\n *     \"notebooks_get_item\",\n *     \"notebooks_mutation\",\n * })\n * @Assert\\NotBlank(groups={\"create\"})\n * @AppAssert\\UserSameThanLoggedOne(groups={\"create\"})\n */\nprivate $user;\n\n// ...\n\n}\n?>\n```\nThe validator : \n```php\n<?php\nnamespace App\\Validator\\Constraints;\n// ...\nclass UserSameThanLoggedOneValidator extends ConstraintValidator\n{\n    /*\n     * @var TokenStorage\n     /\n    private $tokenStorage;\n/**\n * UserSameThanLoggedOneValidator constructor.\n *\n * @param TokenStorage $tokenStorage\n */\npublic function __construct(TokenStorage $tokenStorage)\n{\n    $this->tokenStorage = $tokenStorage;\n}\n\n/**\n * @param mixed      $value\n * @param Constraint $constraint\n */\npublic function validate($value, Constraint $constraint)\n{\n    if (null !== $value &&\n        $value instanceof User &&\n        ($token = $this->tokenStorage->getToken()) &&\n        ($user = $token->getUser()) &&\n        $value->getId() !== $user->getId()\n    ) {\n        $this->context->buildViolation($constraint->message)\n                      ->addViolation();\n    }\n}\n\n}\n```\nNot a long time solution, because we need to : \n- store in our frontend, all data that should be cared by the backend side.\n- validate each received data with asserts, so it adds a lot of time of coding (and complexity).\nIf I have time and capabilities (\ud83e\udd23), I could help to implement Event Subscriber for GraphQL.. ",
    "olivermack": "Just in case someone comes across this and struggles with the same issue:\nIt's pretty important in which order the data providers are registered. Thus, if you want to specify your provider inside the services-configs of a certain bundle it will be registered after the default dataproviders coming from the core. I was facing that in a similar scenario where my route did not provide any id argument and during the doctrine data provider (ApiPlatform\\Core\\Bridge\\Doctrine\\Orm\\ItemDataProvider) execution it just failed with an exception Invalid identifier \\\"\\\", \\\"id\\\" has not been found..\nTherefore, to add that info to the comment from @Sybio, ensure to configure the data provider inside the applications root services.yml at app/config/services.yml. ",
    "numediaweb": "Removing _api_item_operation_name fixed it to me:\nbefore\n...\n    /**\n     * @Route(\n...\n     *     defaults={\n     *       \"_controller\"=\"\\Example\\ApiBundle\\Controller\\ApiRequestController::patchApiRequest\",\n     *       \"_api_resource_class\"=\"AppBundle\\Entity\\ApiRequest\",\n     *       \"_api_item_operation_name\"=\"patchApiRequest\"\n     *     }\n...\nAfter\n...\n    /**\n     * @Route(\n...\n     *     defaults={\n     *       \"_controller\"=\"\\Example\\ApiBundle\\Controller\\ApiRequestController::patchApiRequest\",\n     *       \"_api_resource_class\"=\"AppBundle\\Entity\\ApiRequest\",\n     *     }\n.... I see that the error is generated in \nvendor/api-platform/core/src/Problem/Serializer/ErrorNormalizer.php:42. ",
    "Napche": "You can also just use move your action to the collection_items, since there is no required id attribute there.\nresources:\n    App\\Entity\\User:\n        attributes:\n            normalization_context:\n                groups: ['read']\n            denormalization_context:\n                groups: ['write']\n        itemOperations:\n            get: ~\n            put: ~\n        collectionOperations:\n            get: ~\n            profile:\n                path: '/profile'\n                controller: App\\Action\\UserProfileAction\n                method: 'GET'\n                normalization_context:\n                    groups: ['profile']\n                swagger_context:\n                    public: false\n                    tags: ['Authentication']\n                    summary: \"Returns the profile of the logged in user.\"\n                    parameters:\n                        -   name: 'Bearer'\n                            required: true\n                            in: 'header'\n                            description: 'Active JWT Token'\n                    responses:\n                        200:\n                            description: \"json array with personal profile\". ",
    "dialogik": "Yes it does\n...\nfoo_special          POST          ANY          ANY          /foo/special\n...\n\n. There is no Controller, thus I cannot use\ndefaults:\n    _controller: 'AppBundle:Foo:special'\n\nWhat is the notation for using an Action?. Thank you!\nI wanted to avoid using annotions as I like keeping my configuration in yml files. But since registering each action is required I think I'll stick with annotations.. Maybe this could be precised in the documentation?. ",
    "bitcoinporn": "Please if any example. I'm looking exact same solutions as well.\nCan't find it anywhere documentation . i got it. Just need to make code working now....\n. Got it Thank you. . ",
    "silverbackdan": "Docs do have this info (perhaps not when this was originally raised though) For anyone finding this thread: https://api-platform.com/docs/core/serialization/#decorating-a-serializer-and-add-extra-data. I tried it but sed the collection_data_provider tag instead of the item_data_provider which was why that hasn't worked. Thanks for such a quick response @Dunglas. Found a solution based on https://github.com/api-platform/core/blob/428683885c3c784cb449857ff814eeed02c9a62c/src/Bridge/Doctrine/Orm/CollectionDataProvider.php#L39\nInjected the manager registry instead and get the actual manager out when getting the item.. I have seen that I'll need to modify the cache tags. As I'm populating this information to the entity as it is loaded from the database, I can't see a way to do what I'd need. The request goes a little like this:\n\nForm component entity loaded from database\nOnLoad event: populate a variable of Form with a FormView class/object which contains a form view made using the class name (e.g. from Forms/ContactType.php'. Also change the variable 'lastModified' to the last modified date of the form type file 'Forms/ContactType.php'\n\nSo ideally, I'd like the cache tag to use the last modified date of the file ContactType.php - would this be possible or am I going the wrong way about this?\nAlso, I've thought about making a FormView resource with a custom dataprovider. One of the main issues with this is that I'm not sure If I'd be able to map it in properly. Basically, when I get a page from the database I also get an array of components. A form could be one of those which is a database entity, but then I'd need it to have a on-to-one relation with a FormView entity that is not mapped in the database. Is there any docs on to specify relations between ApiResources without doctrine?. I think this is one to be resolved with a custom controller returning a response with the cache tag set.. If anyone else finds this, there is also a job to purge the cache for the entity. I haven't done this yet and with the api platform, purging of the cache happens in doctrine event listeners.\nApiPlatform\\Core\\Bridge\\Doctrine\\EventListener\\PurgeHttpCacheListener\nIt'd probably be easiest to write a simple symfony command that updates a timestamp in the database using doctrine which in turn would purge the cache. It's only really an issue in development or pushing a form update (in my case) to the production server.. I suppose this isn't quite as straight forward. I've traced the functionality to test if a property is writable back to the Serializer component. For the use cases of the Serializer, I think the functionality to check for a setter or it being public is probably appropriate especially for the ObjectNormalizer. Although it does use the Property Accessor component which does support the magic __call method.\nI'm wondering whether some annotation or configuration options should be perhaps added to either API Platform, but possibly more appropriately to the Serializer component to determine whether an property can be modified with the magic __call method and therefore set the metadata for the property to writeable.\nI'd say this could possibly be delegated to the PropertyAccessor component but if the magic call method is enabled the comment in there is\nphp\n// we call the getter and hope the __call do the job\nAs this seems to be a much bigger topic and probably one for another Symfony component I'll close the issue here. Although I'm having this issue still, I'm not convinced it's related to the custom data provider. Server-side rendering works fine but when the browser tries to make a request to the api I get the problem. I've tried changing dev environment to prod on my local machine and have not replicated the issue. I'd love if anyone else has had issues similar and if I either find the root cause that is a bug or I find a solution I'll make another comment.. It must be something to do with the varnish caching layer - either way, I've bypassed varnish for now and it's working.. All related in the end to nginx proxy where the resource exceeded the maximum header length permitted. I'd be happy to write a PR for this but am unsure as to whether there's a preference of just converting the requested resources that are inserted into the cache-tags header into an md5 hash or something, or making this a configurable option.. Just reviewing some old issues I've opened that are still around - Is this an enhancement that is worthwhile or is it best just to increase the maximum header size limit?. Sounds good, I'll close this issue in favour of moving to xkey and if required, changing the nginx maximum header size. Thanks for the quick reply.. Thanks for getting there before me @purplefish32. To customise the swagger documentation I think you should be looking here:\nhttps://api-platform.com/docs/core/swagger/\nYou can play around with the array returned from the normalizer you decorate adding in your response status codes and descriptions.. ",
    "BenWaNH": "I have this path for Symfony 4 overriding : \ntemplates\\bundles\\ApiPlatformBundle\\views\\SwaggerUi\\index.html.twig\nbut it doesn't work... nothing happens\nAnyone know what is the correct path?\nThanks. Changelog to api-platform/core in vendor folder stop at 2.3.6 version... composer update do nothing, how i get 2.4 version? Thanks. ",
    "par4dise": "Sure, sorry about that oversight:\n\nPHP 5.6.17 (cli) (built: Jan  8 2016 10:51:07) \nCopyright (c) 1997-2015 The PHP Group\nZend Engine v2.6.0, Copyright (c) 1998-2015 Zend Technologies\n    with Zend OPcache v7.0.6-dev, Copyright (c) 1999-2015, by Zend Technologies\n    with Xdebug v2.2.5, Copyright (c) 2002-2014, by Derick Rethans\nComposer version 1.4.1 2017-03-10 09:29:45\n\nI'm on macOS 10.12.5.\nAnswers:\n I've never had those warnings before. But I agree they're not errors.\n Yes I was in the correct directory\n Why not docker, well.... old habits :)\n I seems that the beta requires a newer PHP than mine:\n\nCould not find package api-platform/api-platform with version ^2.1@beta in a version installable using your PHP version 5.6.17. Ok Simperfit that was that simple. Thank you.. \n",
    "GonZOO82": "Any idea?. ",
    "yoshz": "This issue still exists for me and I only get the error message \"Update is not allowed for this operation\" if actually post an id that has the property name \"id\". For other entities that have an id on the property \"code\" for example I don't get this error message. So this is pretty weird.\nShould this check not rely on that a IdGenerator is actually defined in Doctrine for that entity?. ",
    "coudenysj": "Any news on this? Or ideas how to prepare a merge request to add support for this?. ",
    "arnedesmedt": "+1. Hi @toby-griffiths Is it possible to paste here some example? I can't get a working solution where you can add the resource id into an input field in the swagger ui as a parameter and on top of that an input field where you can change the input values of the subresource.\nNow I have this:\n```\n/\n * Resource\n \n * @ORM\\Table(name=\"resource\")\n * @ORM\\Entity\n \n * @ApiResource(\n *      ...\n *      collectionOperations={\n *          ...\n *          \"createSubresource\"={\n *              \"method\"=\"POST\",\n *              \"path\"=\"/resources/{id}/subresources\",\n *              \"controller\"=SubresourceAddController::class,\n *              \"denormalization_context\"={\"groups\"={\"subresource_create\"}}, \n *              \"default\"={\"_api_receive\"=false},\n *          },\n *      },\n * )\n */\nclass Resource\n{\n    /\n     * @ORM\\Column(name=\"uuid\", type=\"string\", length=36, nullable=false)\n     * @ORM\\Id\n     * @ORM\\GeneratedValue(strategy=\"IDENTITY\")\n     \n     * @var string\n     * @Groups({\"subresource_create\"})\n     /\n    public $uuid;\n...\n/**\n * @ORM\\OneToMany(targetEntity=\"Subresource\", mappedBy=\"resourceUuid\")\n *\n * @var Subresource[]\n * @Groups({\"subresource_create\"})\n *\n * @ApiSubresource()\n */\npublic $subresources;\n\n}\n/\n * Subresource\n \n * @ORM\\Table(name=\"subresource\")\n * @ORM\\Entity\n \n * @ApiResource()\n */\nclass Subresource\n{\n    /\n     * @var string\n     \n     * @ORM\\Column(name=\"uuid\", type=\"string\", length=36, nullable=false)\n     * @ORM\\Id\n     * @ORM\\GeneratedValue(strategy=\"IDENTITY\")\n     \n     * @Groups({\"subresource_create\"})\n     */\n    public $uuid;\n/**\n * @var string\n *\n * @ORM\\ManyToOne(targetEntity=\"Resource\", inversedBy=\"subresources\")\n * @ORM\\JoinColumn(name=\"resource_uuid\", referencedColumnName=\"uuid\")\n */\npublic $resourceUuid;\n\n}\n```. ",
    "Toflar": "This issue still exists. I'm trying to fix it but I'm pretty lost and it's hard to fix it without guidance as I'm not sure why things are the way they are at several places in the code.\nFirst of all, this issue should be moved to core (not sure about the policy here though).\nThen the issue occurs here: https://github.com/api-platform/core/blob/master/src/Serializer/ItemNormalizer.php#L35\nOBJECT_TO_POPULATE is not set at this place yet, it happens only later. And api_allow_update is false because it's a POST request and this variable is only set to true if PATCH or PUT requests are sent (see https://github.com/api-platform/core/blob/master/src/Serializer/SerializerContextBuilder.php#L72).\nSo I'm not sure how to proceed here but it's perfectly valid to send a POST request with an id if you have no autogenerated strategy. . Original issue was https://github.com/api-platform/api-platform/issues/132 so cc'ing @meyerbaptiste here too.. That whole check does not make much sense to me. I mean, what if my identifier was named foobar? It would just happily ignore it \ud83d\ude04 . ",
    "br750": "hello\nThis issue still exists. if i send a json with id=0 from my apps with POST request : \nmessage \"Update is not allowed for this operation\" \nexpected that the object was created with auto id... \nis there a way to fix it ?\nthanks. ",
    "bendavies": "what is this fixing exactly?. Not in favour of this. Goes against the one process per container docker best practice philosophy. Apologies I misread the intention!. hey @teohhanhui sorry i deleted that comment, as it seemed it was actually working!. FYI, it's part of the framework bundle flex recipe. https://github.com/symfony/recipes/blob/master/symfony/framework-bundle/3.3/manifest.json#L21\nAnd then it ships a .env.dist which we do too.. what's going on here? we don't use flex >=1.2. it's not even released.. try https://github.com/api-platform/docs/issues/504. are you using a doctrine collection?\nIf so, I don't think there is anything to fix - this is how the property access component deals with ArrayCollections. there is no rekeying between adds/removals.. what does your setter look like?. related\nhttps://github.com/api-platform/core/pull/1911. ",
    "Mikael1006": "In my var/logs/ directory :\n[2017-06-27 10:37:34] request.INFO: Matched route \"api_entrypoint\". {\"route\":\"api_entrypoint\",\"route_parameters\":{\"_controller\":\"api_platform.action.entrypoint\",\"_format\":\"\",\"_api_respond\":\"1\",\"index\":\"index\",\"_route\":\"api_entrypoint\"},\"request_uri\":\"http://nginx/\",\"method\":\"GET\"} []\n[2017-06-27 10:37:34] security.INFO: Populated the TokenStorage with an anonymous Token. [] []\n[2017-06-27 10:37:34] request.CRITICAL: Uncaught PHP Exception Symfony\\Component\\Security\\Core\\Exception\\InsufficientAuthenticationException: \"Full authentication is required to access this resource.\" at /srv/api-platform/vendor/symfony/symfony/src/Symfony/Component/Security/Http/Firewall/ExceptionListener.php line 132 {\"exception\":\"[object] (Symfony\\\\Component\\\\Security\\\\Core\\\\Exception\\\\InsufficientAuthenticationException(code: 0): Full authentication is required to access this resource. at /srv/api-platform/vendor/symfony/symfony/src/Symfony/Component/Security/Http/Firewall/ExceptionListener.php:132, Symfony\\\\Component\\\\Security\\\\Core\\\\Exception\\\\AccessDeniedException(code: 403): Access Denied. at /srv/api-platform/vendor/symfony/symfony/src/Symfony/Component/Security/Http/Firewall/AccessListener.php:70)\"} []\nand when i do docker-compose logs -f\nvarnish_1  | *   << BeReq    >> 32883\nvarnish_1  | -   Begin          bereq 32882 fetch\nvarnish_1  | -   Timestamp      Start: 1498560022.409239 0.000000 0.000000\nvarnish_1  | -   BereqMethod    GET\nvarnish_1  | -   BereqURL       /\nvarnish_1  | -   BereqProtocol  HTTP/1.1\nvarnish_1  | -   BereqHeader    Host: 217.182.90.169\nvarnish_1  | -   BereqHeader    Upgrade-Insecure-Requests: 1\nvarnish_1  | -   BereqHeader    User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36\nvarnish_1  | -   BereqHeader    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nvarnish_1  | -   BereqHeader    Accept-Language: fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4\nvarnish_1  | -   BereqHeader    X-Forwarded-For: 82.127.25.186\nvarnish_1  | -   BereqHeader    Accept-Encoding: gzip\nvarnish_1  | -   BereqHeader    X-Varnish: 32883\nvarnish_1  | -   VCL_call       BACKEND_FETCH\nvarnish_1  | -   VCL_return     fetch\nvarnish_1  | -   FetchError     no backend connection\nvarnish_1  | -   Timestamp      Beresp: 1498560022.409272 0.000033 0.000033\nvarnish_1  | -   Timestamp      Error: 1498560022.409276 0.000038 0.000005\nvarnish_1  | -   BerespProtocol HTTP/1.1\nvarnish_1  | -   BerespStatus   503\nvarnish_1  | -   BerespReason   Service Unavailable\nvarnish_1  | -   BerespReason   Backend fetch failed\nvarnish_1  | -   BerespHeader   Date: Tue, 27 Jun 2017 10:40:22 GMT\nvarnish_1  | -   BerespHeader   Server: Varnish\nvarnish_1  | -   VCL_call       BACKEND_ERROR\nvarnish_1  | -   BerespHeader   Content-Type: text/html; charset=utf-8\nvarnish_1  | -   BerespHeader   Retry-After: 5\nvarnish_1  | -   VCL_return     deliver\nvarnish_1  | -   Storage        malloc Transient\nvarnish_1  | -   ObjProtocol    HTTP/1.1\nvarnish_1  | -   ObjStatus      503\nvarnish_1  | -   ObjReason      Backend fetch failed\nvarnish_1  | -   ObjHeader      Date: Tue, 27 Jun 2017 10:40:22 GMT\nvarnish_1  | -   ObjHeader      Server: Varnish\nvarnish_1  | -   ObjHeader      Content-Type: text/html; charset=utf-8\nvarnish_1  | -   ObjHeader      Retry-After: 5\nvarnish_1  | -   Length         282\nvarnish_1  | -   BereqAcct      0 0 0 0 0 0\nvarnish_1  | -   End\nvarnish_1  |\nvarnish_1  | *   << Request  >> 32882\nvarnish_1  | -   Begin          req 32881 rxreq\nvarnish_1  | -   Timestamp      Start: 1498560022.408993 0.000000 0.000000\nvarnish_1  | -   Timestamp      Req: 1498560022.408993 0.000000 0.000000\nvarnish_1  | -   ReqStart       82.127.25.186 7593\nvarnish_1  | -   ReqMethod      GET\nvarnish_1  | -   ReqURL         /\nvarnish_1  | -   ReqProtocol    HTTP/1.1\nvarnish_1  | -   ReqHeader      Host: 217.182.90.169\nvarnish_1  | -   ReqHeader      Connection: keep-alive\nvarnish_1  | -   ReqHeader      Cache-Control: max-age=0\nvarnish_1  | -   ReqHeader      Upgrade-Insecure-Requests: 1\nvarnish_1  | -   ReqHeader      User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36\nvarnish_1  | -   ReqHeader      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nvarnish_1  | -   ReqHeader      Accept-Encoding: gzip, deflate, sdch\nvarnish_1  | -   ReqHeader      Accept-Language: fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4\nvarnish_1  | -   ReqHeader      X-Forwarded-For: 82.127.25.186\nvarnish_1  | -   VCL_call       RECV\nvarnish_1  | -   VCL_return     hash\nvarnish_1  | -   ReqUnset       Accept-Encoding: gzip, deflate, sdch\nvarnish_1  | -   ReqHeader      Accept-Encoding: gzip\nvarnish_1  | -   VCL_call       HASH\nvarnish_1  | -   VCL_return     lookup\nvarnish_1  | -   VCL_call       MISS\nvarnish_1  | -   VCL_return     fetch\nvarnish_1  | -   Link           bereq 32883 fetch\nvarnish_1  | -   Timestamp      Fetch: 1498560022.409386 0.000393 0.000393\nvarnish_1  | -   RespProtocol   HTTP/1.1\nvarnish_1  | -   RespStatus     503\nvarnish_1  | -   RespReason     Backend fetch failed\nvarnish_1  | -   RespHeader     Date: Tue, 27 Jun 2017 10:40:22 GMT\nvarnish_1  | -   RespHeader     Server: Varnish\nvarnish_1  | -   RespHeader     Content-Type: text/html; charset=utf-8\nvarnish_1  | -   RespHeader     Retry-After: 5\nvarnish_1  | -   RespHeader     X-Varnish: 32882\nvarnish_1  | -   RespHeader     Age: 0\nvarnish_1  | -   RespHeader     Via: 1.1 varnish-v4\nvarnish_1  | -   VCL_call       DELIVER\nvarnish_1  | -   VCL_return     deliver\nvarnish_1  | -   Timestamp      Process: 1498560022.409451 0.000458 0.000065\nvarnish_1  | -   RespHeader     Content-Length: 282\nvarnish_1  | -   Debug          \"RES_MODE 2\"\nvarnish_1  | -   RespHeader     Connection: keep-alive\nvarnish_1  | -   Timestamp      Resp: 1498560022.409506 0.000513 0.000055\nvarnish_1  | -   ReqAcct        424 0 424 239 282 521\nvarnish_1  | -   End\nvarnish_1  |\nvarnish_1  | *   << BeReq    >> 32885\nvarnish_1  | -   Begin          bereq 32884 fetch\nvarnish_1  | -   Timestamp      Start: 1498560022.460712 0.000000 0.000000\nvarnish_1  | -   BereqMethod    GET\nvarnish_1  | -   BereqURL       /favicon.ico\nvarnish_1  | -   BereqProtocol  HTTP/1.1\nvarnish_1  | -   BereqHeader    Host: 217.182.90.169\nvarnish_1  | -   BereqHeader    Pragma: no-cache\nvarnish_1  | -   BereqHeader    User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36\nvarnish_1  | -   BereqHeader    Accept: image/webp,image/*,*/*;q=0.8\nvarnish_1  | -   BereqHeader    Referer: http://217.182.90.169/\nvarnish_1  | -   BereqHeader    Accept-Language: fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4\nvarnish_1  | -   BereqHeader    X-Forwarded-For: 82.127.25.186\nvarnish_1  | -   BereqHeader    Accept-Encoding: gzip\nvarnish_1  | -   BereqHeader    X-Varnish: 32885\nvarnish_1  | -   VCL_call       BACKEND_FETCH\nvarnish_1  | -   VCL_return     fetch\nvarnish_1  | -   FetchError     no backend connection\nvarnish_1  | -   Timestamp      Beresp: 1498560022.460742 0.000030 0.000030\nvarnish_1  | -   Timestamp      Error: 1498560022.460745 0.000033 0.000003\nvarnish_1  | -   BerespProtocol HTTP/1.1\nvarnish_1  | -   BerespStatus   503\nvarnish_1  | -   BerespReason   Service Unavailable\nvarnish_1  | -   BerespReason   Backend fetch failed\nvarnish_1  | -   BerespHeader   Date: Tue, 27 Jun 2017 10:40:22 GMT\nvarnish_1  | -   BerespHeader   Server: Varnish\nvarnish_1  | -   VCL_call       BACKEND_ERROR\nvarnish_1  | -   BerespHeader   Content-Type: text/html; charset=utf-8\nvarnish_1  | -   BerespHeader   Retry-After: 5\nvarnish_1  | -   VCL_return     deliver\nvarnish_1  | -   Storage        malloc Transient\nvarnish_1  | -   ObjProtocol    HTTP/1.1\nvarnish_1  | -   ObjStatus      503\nvarnish_1  | -   ObjReason      Backend fetch failed\nvarnish_1  | -   ObjHeader      Date: Tue, 27 Jun 2017 10:40:22 GMT\nvarnish_1  | -   ObjHeader      Server: Varnish\nvarnish_1  | -   ObjHeader      Content-Type: text/html; charset=utf-8\nvarnish_1  | -   ObjHeader      Retry-After: 5\nvarnish_1  | -   Length         282\nvarnish_1  | -   BereqAcct      0 0 0 0 0 0\nvarnish_1  | -   End\nvarnish_1  |\nvarnish_1  | *   << Request  >> 32884\nvarnish_1  | -   Begin          req 32881 rxreq\nvarnish_1  | -   Timestamp      Start: 1498560022.460528 0.000000 0.000000\nvarnish_1  | -   Timestamp      Req: 1498560022.460528 0.000000 0.000000\nvarnish_1  | -   ReqStart       82.127.25.186 7593\nvarnish_1  | -   ReqMethod      GET\nvarnish_1  | -   ReqURL         /favicon.ico\nvarnish_1  | -   ReqProtocol    HTTP/1.1\nvarnish_1  | -   ReqHeader      Host: 217.182.90.169\nvarnish_1  | -   ReqHeader      Connection: keep-alive\nvarnish_1  | -   ReqHeader      Pragma: no-cache\nvarnish_1  | -   ReqHeader      Cache-Control: no-cache\nvarnish_1  | -   ReqHeader      User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36\nvarnish_1  | -   ReqHeader      Accept: image/webp,image/*,*/*;q=0.8\nvarnish_1  | -   ReqHeader      Referer: http://217.182.90.169/\nvarnish_1  | -   ReqHeader      Accept-Encoding: gzip, deflate, sdch\nvarnish_1  | -   ReqHeader      Accept-Language: fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4\nvarnish_1  | -   ReqHeader      X-Forwarded-For: 82.127.25.186\nvarnish_1  | -   VCL_call       RECV\nvarnish_1  | -   VCL_return     hash\nvarnish_1  | -   ReqUnset       Accept-Encoding: gzip, deflate, sdch\nvarnish_1  | -   ReqHeader      Accept-Encoding: gzip\nvarnish_1  | -   VCL_call       HASH\nvarnish_1  | -   VCL_return     lookup\nvarnish_1  | -   VCL_call       MISS\nvarnish_1  | -   VCL_return     fetch\nvarnish_1  | -   Link           bereq 32885 fetch\nvarnish_1  | -   Timestamp      Fetch: 1498560022.460850 0.000321 0.000321\nvarnish_1  | -   RespProtocol   HTTP/1.1\nvarnish_1  | -   RespStatus     503\nvarnish_1  | -   RespReason     Backend fetch failed\nvarnish_1  | -   RespHeader     Date: Tue, 27 Jun 2017 10:40:22 GMT\nvarnish_1  | -   RespHeader     Server: Varnish\nvarnish_1  | -   RespHeader     Content-Type: text/html; charset=utf-8\nvarnish_1  | -   RespHeader     Retry-After: 5\nvarnish_1  | -   RespHeader     X-Varnish: 32884\nvarnish_1  | -   RespHeader     Age: 0\nvarnish_1  | -   RespHeader     Via: 1.1 varnish-v4\nvarnish_1  | -   VCL_call       DELIVER\nvarnish_1  | -   VCL_return     deliver\nvarnish_1  | -   Timestamp      Process: 1498560022.460874 0.000345 0.000024\nvarnish_1  | -   RespHeader     Content-Length: 282\nvarnish_1  | -   Debug          \"RES_MODE 2\"\nvarnish_1  | -   RespHeader     Connection: keep-alive\nvarnish_1  | -   Timestamp      Resp: 1498560022.460975 0.000447 0.000102\nvarnish_1  | -   ReqAcct        409 0 409 239 282 521\nvarnish_1  | -   End\nvarnish_1  |\n. ",
    "gphilippe": "@renan-taranto I have not changed default.vcl since I cloned version v2.1.0-beta.3... And it does not have a section access_control... Did you mean security.yml ? Have a peek: \nhttps://github.com/gphilippe/TrackTikDemoAPI/blob/master/app/config/security.yml\nIts still a WIP, trying to get FOSUserBundle working with LexikJWTAuthenticationBundle on v2.1.0-beta.3.. @renan-taranto actually I moved my dev section above both main and api (and moved main above api). Atleast now my app_dev.php loads. Still learning all this api-plateform / symfony technology. Didnt know there was an order to the firewall. \nThank you.\nEDIT: Oups, I effectively by passed all security LOL. obviously I need to read more on the topic. Sorry for the bother.. ",
    "speeeeeed2006": "I've done that just like the example but when I use $request->get('data'); nothing inside (null) . ",
    "noemi-salaun": "How to get this kind of custom controllers inside the documentation UI ?. ",
    "Gounlaf": "Maybe this: #311 ?. @ssimplix I figured how to fix it (thx to #311)\n```php\nnamespace AppBundle\\Entity;\nuse ApiPlatform\\Core\\Annotation as Api;\nuse AppBundle\\Repository\\UserRepository;\nuse Doctrine\\ORM\\Mapping as ORM;\n/\n * @Api\\ApiResource(\n *     itemOperations={\n *         \"view_myself\"={\n *             \"route_name\"=\"me_view\",\n *             \"swagger_context\"={\n *                  \"parameters\"={}\n *              }\n *         }\n *     }\n * )\n \n * @ORM\\Entity(repositoryClass=UserRepository::class)\n /\n```. Oh Ok, I thought it was built-in with the FosUser Bridge.\nSorry for the inconvenience!\nThanks,\nRegards.. Hi @Sybio,\nTL;DR Take a look at the documentation (search Person / Book)\nIf I'm right, you have to use @Groups (documented here: https://api-platform.com/docs/core/serialization-groups-and-relations#header)\n\non your Pick entity, define groups for normalization and denormalization.\non your Subpick entity, use defined groups on the properties (in @Groups, you will have groups for the Subpick entity entity itself, and for the Pick entity entity too)\n\n. @soyuka Can you confirm if I understood it correctly: now, I can have an entity with a \"regular PK\" (I mean a classic Integer sequence) for internal mapping, but exposed through API with her UUID or whatever field flagged with the annotation @ApiProperty(identifier=true)\nAm I right ?\nThanks. ",
    "neluzhin": "@Gounlaf, this one about endpoints mapped with entities, similar to @ApiResource() annotation.. ",
    "mfrankiewicz": "Great! Thanks :+1: . ",
    "sverraest": "Hi @dunglas, not sure how that would help? Just tried it but I keep getting JWT token not found on the documentation.\nThat pattern doesn't match the documentation.\nIt's just baseurl/api, baseurl/api/index.html, baseurl/index.html#!/Brand/postBrandCollection etc..\nFirewall is setup with pattern /api.\n```\nfirewalls:\n        api_login:\n            pattern:  ^/api/login\n            stateless: true\n            anonymous: true\n            provider:   fos_userbundle\n            form_login:\n                provider:   fos_userbundle\n                check_path:               /api/login_check\n                success_handler:          lexik_jwt_authentication.handler.authentication_success\n                failure_handler:          lexik_jwt_authentication.handler.authentication_failure\n                require_previous_session: false\n    api:\n        pattern:   ^/api\n        stateless: true\n        guard:\n            authenticators:\n                - lexik_jwt_authentication.jwt_token_authenticator\n    main:\n        pattern: ^/\n        form_login:\n            provider: fos_userbundle\n        logout:       true\n        anonymous:    true\n\n\naccess_control:\n    - { path: ^/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/resetting, role: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/css, role: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/js, role: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/images, role: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/img, role: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/api/login, roles: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/api,       roles: ROLE_API}\n    - { path: ^/, role: ROLE_SUPER_ADMIN }\n\n```\n. ",
    "StephenOTT": "@dunglas any ideas on this?. ",
    "marioprudhomme": "DQL:\nSELECT o \nFROM AppBundle\\Entity\\Service o \nLEFT JOIN AppBundle\\Entity\\ServiceTranslation o_t WITH o.id = o_t.translatable \nORDER BY o_t.title ASC\nSQL:\nSELECT a0_.id AS id_0, a0_.uuid AS uuid_1, a0_.owner AS owner_2, a0_.owner_uuid AS owner_uuid_3, a0_.slug AS slug_4, a0_.enabled AS enabled_5, a0_.weight AS weight_6, a0_.version AS version_7, a0_.deleted_at AS deleted_at_8, a0_.created_at AS created_at_9, a0_.updated_at AS updated_at_10 \nFROM app_service a0_ \nLEFT JOIN app_service_trans a1_ ON (a0_.id = a1_.translatable_id) \nORDER BY a1_.title ASC LIMIT 10 OFFSET 0\nThe content of $relationship variable found at https://github.com/api-platform/core/blob/master/src/Bridge/Doctrine/Orm/Util/QueryChecker.php#L144:\n\"AppBundle\\Entity\\ServiceTranslation\"\nThe error occurs when I'm adding the ORDER BY clause.. ",
    "banandam": "Yeah correct @dunglas . We have integrated FOSUserBundle & JWT by using your documentation links. But the login, register API endpoints are not displaying in Swagger UI.\nhttps://api-platform.com/docs/core/fosuser-bundle\nhttps://api-platform.com/docs/core/jwt\n. Can you please share documentation related to OAuth integration?. ",
    "megazoll": "@Simperfit why you close this issue? Should not login and register methods are exposed to swagger?. ",
    "Timherlaud": "Hello synchr0n123r,\nFor me you need to decorate the service : api_platform.jsonld.normalizer.item if you use json-ld format. Hello Ivillarino,\nIf you want to modify the swagger documentation, you need to decorate the 'api_platform.swagger.normalizer.documentation' service.\nAfter that you able to unset the documentation or parts.\ncf : https://github.com/api-platform/docs/pull/236. In swagger ? . maybe this can help you : api-platform/docs#236\nModify : $docs['info']['title']. @VictorKrasnov https://api-platform.com/docs/core/swagger. Hello, \nmaybe this can help you : https://github.com/api-platform/docs/pull/236. ",
    "RyderOne": "I'm sorry I posted to the wrong repository :/. ",
    "Zayon": "routing.yml : \nyml\napp:\n    resource: '@AppBundle/Controller/'\n    type: annotation\napi:\n    resource: '.'\n    type:     'api_platform'\nThe matched route is api_entrypoint from api-platform/core : \nxml\n<route id=\"api_entrypoint\" path=\"/{index}.{_format}\">\n        <default key=\"_controller\">api_platform.action.entrypoint</default>\n        <default key=\"_format\" />\n        <default key=\"_api_respond\">1</default>\n        <default key=\"index\">index</default>\n        <requirement key=\"index\">index</requirement>\n</route>. (miss clicked Comment button). OK, I found the problem thanks to your help on Slack.\nI was getting a RuntimeException from RequestAttributesExtractor::extractAttributes method which was called in HttpCacheTaggerSubscriber. My bad.\nThanks again to @lyrkan and @Simperfit for your help.. ",
    "mneuhaus": "just a little example snippet for someone that ends up here while searching for a solution for this: \nservices.yaml\nyaml\n    App\\Serializer\\ArticleItemNormalizer:\n        arguments: [ '@api_platform.serializer.normalizer.item' ]\n```php\n<?php\nnamespace App\\Serializer;\nuse Symfony\\Component\\Serializer\\Normalizer\\DenormalizerInterface;\nuse Symfony\\Component\\Serializer\\Normalizer\\NormalizerInterface;\nfinal class ArticleItemNormalizer implements NormalizerInterface, DenormalizerInterface\n{\n    private $normalizer;\npublic function __construct(NormalizerInterface $normalizer)\n{\n    if (!$normalizer instanceof DenormalizerInterface) {\n        throw new \\InvalidArgumentException('The normalizer must implement the DenormalizerInterface');\n    }\n\n    $this->normalizer = $normalizer;\n}\n\npublic function denormalize($data, $class, $format = null, array $context = [])\n{\n    if ($class === 'App\\Entity\\MyAbstractEntity') {\n        $class = 'App\\Entity\\\\' . ucfirst($data['type']);\n        $context['resource_class'] = $class;\n    }\n\n    return $this->normalizer->denormalize($data, $class, $format, $context);\n}\n\npublic function supportsDenormalization($data, $type, $format = null)\n{\n    return $this->normalizer->supportsDenormalization($data, $type, $format);\n}\n\npublic function normalize($object, $format = null, array $context = [])\n{\n    return $this->normalizer->normalize($object, $format, $context);\n}\n\npublic function supportsNormalization($data, $format = null)\n{\n    return $this->normalizer->supportsNormalization($data, $format);\n}\n\n}\n```. i did quite some more trial&error, but did not come close to any good solution. The Closures are quite a Headache and are not easily worked around :(. ",
    "daviddlv": "By default with Angular, if i don't fill the field, it's null.\nI would have preferred to get validation error messages @Assert\\NotBlank. Angular version is v4.3.1\nI use HttpClientModule and my request is like this :\n```\nexport class User {\n  id: string;\n  username: string;\n  password: string;\n  plainPassword: string;\n  email: string;\n  lastName: string;\n  firstName: string;\n}\nlet user: User = new User();\nlet body = JSON.stringify(this.user);\nreturn this.http.post(${environment.API_BACKEND_ORIGIN}/users, body).subscribe(\n    data => { this.user = data; }\n);\n```\nThe stack trace Symfony is :\nUncaught PHP Exception Symfony\\Component\\Serializer\\Exception\\UnexpectedValueException: \"Expected argument of type \"string\", \"NULL\" given\" at /app/vendor/symfony/symfony/src/Symfony/Component/Serializer/Normalizer/AbstractObjectNormalizer.php line 204\nHide trace\n{\u25bc\n  /app/vendor/symfony/symfony/src/Symfony/Component/Serializer/Normalizer/AbstractObjectNormalizer.php:204: {\u25b6}\n  /app/vendor/api-platform/core/src/Serializer/AbstractItemNormalizer.php:115: {\u25b6}\n  /app/vendor/api-platform/core/src/Serializer/ItemNormalizer.php:41: {\u25b6}\n  /app/vendor/symfony/symfony/src/Symfony/Component/Serializer/Serializer.php:292: {\u25b6}\n  /app/vendor/symfony/symfony/src/Symfony/Component/Serializer/Serializer.php:174: {\u25b6}\n  /app/vendor/symfony/symfony/src/Symfony/Component/Serializer/Serializer.php:132: {\u25b6}\n  /app/vendor/api-platform/core/src/EventListener/DeserializeListener.php:69: {\u25b6}\n  /app/var/cache/dev/appDevDebugProjectContainer.php:1592: {\u25b6}\n  appDevDebugProjectContainer->{closure}(): {}\n  /app/vendor/symfony/symfony/src/Symfony/Component/EventDispatcher/Debug/WrappedListener.php:112: {\u25b6}\n  Symfony\\Component\\EventDispatcher\\Debug\\WrappedListener->__invoke(): {}\n  /app/vendor/symfony/symfony/src/Symfony/Component/EventDispatcher/EventDispatcher.php:174: {\u25b6}\n  /app/vendor/symfony/symfony/src/Symfony/Component/EventDispatcher/EventDispatcher.php:43: {\u25b6}\n  /app/vendor/symfony/symfony/src/Symfony/Component/EventDispatcher/Debug/TraceableEventDispatcher.php:146: {\u25b6}\n  /app/vendor/symfony/symfony/src/Symfony/Component/HttpKernel/HttpKernel.php:129: {\u25b6}\n  /app/vendor/symfony/symfony/src/Symfony/Component/HttpKernel/HttpKernel.php:68: {\u25b6}\n  /app/vendor/symfony/symfony/src/Symfony/Component/HttpKernel/Kernel.php:171: {\u25b6}\n  /app/web/app.php:20: {\u25b6}\n}\nI tried with @Assert\\NotNull but same error. ",
    "laytoneverson": "Yes, the files is still there. I have also tried to mount the script in the\ndocker compose. I have copied it to a 'serverbin/install-composer.sh',\nmount the serverbin folder and run it from there. I have tried lowering the\nversion in docker-compose thinking maybe it's a bug in the new v3 compose\nfiles.\nI am getting this error on the current master branch. Is anyone else having\nthis problem? I'm not sure what steps to take next...\nOn Sat, Jul 29, 2017, 2:38 AM Amrouche Hamza notifications@github.com\nwrote:\n\nDo you still have docker/app/install-composer.sh ? You need it to run the\ndocker-app-install-composer.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/api-platform/api-platform/issues/376#issuecomment-318814090,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AA_2hGg5USeFxBK_NGMTGfNXiijOjFdiks5sSu9rgaJpZM4OnHSb\n.\n. \n",
    "redecs": "Had the same issue with Docker on Windows. I created my own composer installation procedure within the Dockerfile (no external scripts) only to have fail at the entry point script for the app container (exec user process caused \"no such file or directory\").\nIt turns out that problems are caused by line endings. I configured git to keep the Unix line endings and the it worked as expected.\ngit config --global core.autocrlf false\nIt seems Docker for Windows doesn't like CRLF line endings.. @dunglas I think it's something related to this: https://github.com/git/git/blob/master/Documentation/RelNotes/2.10.0.txt#L248 Will investigate further.. ",
    "raziel057": "Exact. ",
    "felixn11": "Perfect, that's working, thanks!. ",
    "PetitBateau": "I think I misunderstood the way it works.\nIn my controller, where the $data arg is filled ?\nthank's for your time. ",
    "hassanjuniedi": "@Simperfit am trying to get request object inside action class, can you help me with that ? thanks in advance.. @amaccis i see you use yaml to configure filters, can you please guide me how to add default filters using yaml (Search filter , order filter, range filter,....). thanks in advance.. ",
    "achrafsmlali": "@Simperfit can you give me more details about how to do it in my case.\nan example if it's possible apart the one in the doc. if it was based on sql as you said it would be easy but it's not the case . i have a function with two parametres the first is user address (that i got from geolocalisation) and the secend is the city adress that i get from my table city. the aim now is to get all cities order by the result of my function. \n @Simperfit . In the docs exemple they get the nested author informations with the books one. in my case i want to reverse it, to get author and his books knowing that there is no reference to the book in the author entity\n@Simperfit . ",
    "apjmartin": "Okay, i figured it out and have a workaround for it.\nWhen your entity has uses a relation as identifier, like my \"UserDevices\" entity does with \"user\", then the ID for the URI-String will be retrieved from the __toString Method of the entity (if the method exists).\nSee: https://github.com/api-platform/core/blob/751893a91ed491800e21320d469164ffdaf463f6/src/Api/IdentifiersExtractor.php#L60\nFor me that meant i had to overwrite this __toString Method and made it return the ID of the user entity. The BaseUser Entity from FOSUserBundle, which had this __toString method implemented, returned the username, which resulted in this URI Problem.\nNote: This only happens one time with the first request after clearing the cache, if cache pool is active. The following requests will work, because they use the CachedIdentifiersExtractor.. ",
    "Mpereyron": "Sorry, I did not put the getters and setters. So I changed my message.. ",
    "wachirakorn": "Downgrade springfox-swagger to 2.7.0 and config bean as follow.\n@Bean\npublic UiConfiguration uiConfig() {\n    String[] supportedSubmitMethods = new String[] { };\n    return new UiConfiguration(\"\", supportedSubmitMethods);\n}.\n",
    "Nek-": "It doesn't exists in stable version :) . But anyway the behavior is weird with or without this annotation.. Of course. :)\nFYI the issue is on this line: https://github.com/api-platform/core/blob/master/src/Api/ResourceClassResolver.php#L53 \n(if ($strict && isset($type) && 'Product' !== 'Toy')). @soyuka no I can't because I want to retrieve a Product, not a Toy. x). ",
    "soundlake": "I think you can do it by simply declaring some other group on the parent, like this,\n/**\n     * @var string \u0421\u0442\u0440\u043e\u043a\u043e\u0432\u044b\u0439 \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430\n     *\n     * @Groups({\"read.not_for_region\", \"write.not_for_region\"})\n     *\n     * @ORM\\Column(type=\"string\", unique=true)\n     */\n    protected $code;. It was false alarm. . Also, it doesn't support indexBy with association.\nIn the same example, if I set indexBy with ExtraInfo->field, then it crashes with InvalidArgumentException with \"\" is not a valid PHP type. message from vendor/symfony/symfony/src/Symfony/Component/PropertyInfo/Type.php\n```PHP\nclass User\n{\n    /*\n     * @ORM\\OneToMany(targetEntity=\"ExtraInfo\", mappedBy=\"user\", indexBy=\"field_id\")\n     /\n    private $extra_infos;\n...\n\n}\n``. @soyuka Thank you. I foundRelatedToDummyFriendin the test fixtures. I check the code and apply them and check what was the problem.. @soyuka I'vegreponcore/testsforRelatedToDummyFriend, but I got nothing. :/ Are you sure if you have the test case?. @soyuka I tested around and it gets problematic when I putindexBy`.\n```PHP\nclass User\n{\n    /*\n     * @ORM\\OneToMany(targetEntity=\"ExtraInfo\", mappedBy=\"user\", indexBy=\"field_id\")\n     /\n    private $extra_infos;\n...\n\n}\n```\nIf I remove indexBy, then Doctrine gives me an ArrayCollection with auto-incremented keys, which is a PITA because I should traverse the ArrayCollection to check if the ExtraInfo exists. If I put indexBy, then API-Platform gives me an InvalidArgumentException with \"\" is not a valid PHP type.. @soyuka Here it is.\nInvalidArgumentException\n\"\" is not a valid PHP type.\n in vendor/symfony/symfony/src/Symfony/Component/PropertyInfo/Type.php (line 72)\nat Symfony\\Component\\PropertyInfo\\Type->__construct(null) in vendor/symfony/symfony/src/Symfony/Bridge/Doctrine/PropertyInfo/DoctrineExtractor.php (line 110)\nat Symfony\\Bridge\\Doctrine\\PropertyInfo\\DoctrineExtractor->getTypes('AppBundle\\\\Entity\\\\ExtraInfo', 'extraInfos', array())\nat call_user_func_array(array(object(Symfony\\Bridge\\Doctrine\\PropertyInfo\\DoctrineExtractor), 'getTypes'), array('AppBundle\\\\Entity\\\\User', 'extraInfos', array())) in vendor/symfony/symfony/src/Symfony/Component/P\nat Symfony\\Component\\PropertyInfo\\PropertyInfoExtractor->extract(object(Symfony\\Component\\DependencyInjection\\Argument\\RewindableGenerator), 'getTypes', array('AppBundle\\\\Entity\\\\User', 'extraInfos', array())) in\nat Symfony\\Component\\PropertyInfo\\PropertyInfoExtractor->getTypes('AppBundle\\\\Entity\\\\User', 'extraInfos', array()) in vendor/api-platform/core/src/Bridge/Symfony/PropertyInfo/Metadata/Property/PropertyInfoPropert\nat ApiPlatform\\Core\\Bridge\\Symfony\\PropertyInfo\\Metadata\\Property\\PropertyInfoPropertyMetadataFactory->create('AppBundle\\\\Entity\\\\User', 'extraInfos', array()) in vendor/api-platform/core/src/Metadata/Property/Fac\nat ApiPlatform\\Core\\Metadata\\Property\\Factory\\InheritedPropertyMetadataFactory->create('AppBundle\\\\Entity\\\\User', 'extraInfos', array()) in vendor/api-platform/core/src/Metadata/Property/Factory/AnnotationProperty\nat ApiPlatform\\Core\\Metadata\\Property\\Factory\\AnnotationPropertyMetadataFactory->create('AppBundle\\\\Entity\\\\User', 'extraInfos', array()) in vendor/api-platform/core/src/Metadata/Property/Factory/ExtractorProperty\nat ApiPlatform\\Core\\Metadata\\Property\\Factory\\ExtractorPropertyMetadataFactory->create('AppBundle\\\\Entity\\\\User', 'extraInfos', array()) in vendor/api-platform/core/src/Bridge/Doctrine/Orm/Metadata/Property/Doctri\nat ApiPlatform\\Core\\Bridge\\Doctrine\\Orm\\Metadata\\Property\\DoctrineOrmPropertyMetadataFactory->create('AppBundle\\\\Entity\\\\User', 'extraInfos', array()) in vendor/api-platform/core/src/Metadata/Property/Factory/Seri\nat ApiPlatform\\Core\\Metadata\\Property\\Factory\\SerializerPropertyMetadataFactory->create('AppBundle\\\\Entity\\\\User', 'extraInfos', array()) in vendor/api-platform/core/src/Metadata/Property/Factory/AnnotationSubreso\nat ApiPlatform\\Core\\Metadata\\Property\\Factory\\AnnotationSubresourceMetadataFactory->create('AppBundle\\\\Entity\\\\User', 'extraInfos', array()) in vendor/api-platform/core/src/Bridge/Symfony/Validator/Metadata/Proper\nat ApiPlatform\\Core\\Bridge\\Symfony\\Validator\\Metadata\\Property\\ValidatorPropertyMetadataFactory->create('AppBundle\\\\Entity\\\\User', 'extraInfos', array()) in vendor/api-platform/core/src/Metadata/Property/Factory/C\nat ApiPlatform\\Core\\Metadata\\Property\\Factory\\CachedPropertyMetadataFactory->create('AppBundle\\\\Entity\\\\User', 'extraInfos') in vendor/api-platform/core/src/Operation/Factory/SubresourceOperationFactory.php (line\nat ApiPlatform\\Core\\Operation\\Factory\\SubresourceOperationFactory->computeSubresourceOperations('AppBundle\\\\Entity\\\\User', array()) in vendor/api-platform/core/src/Operation/Factory/SubresourceOperationFactory.php\nat ApiPlatform\\Core\\Operation\\Factory\\SubresourceOperationFactory->create('AppBundle\\\\Entity\\\\User') in vendor/api-platform/core/src/Operation/Factory/CachedSubresourceOperationFactory.php (line 52)\nat ApiPlatform\\Core\\Operation\\Factory\\CachedSubresourceOperationFactory->create('AppBundle\\\\Entity\\\\User') in vendor/api-platform/core/src/Bridge/Symfony/Routing/ApiLoader.php (line 102)\nat ApiPlatform\\Core\\Bridge\\Symfony\\Routing\\ApiLoader->load('.', 'api_platform') in vendor/symfony/symfony/src/Symfony/Component/Config/Loader/FileLoader.php (line 153)\nat Symfony\\Component\\Config\\Loader\\FileLoader->doImport('.', 'api_platform', false, '/opt/beip-bx/bx/config/routing.yml') in vendor/symfony/symfony/src/Symfony/Component/Config/Loader/FileLoader.php (line 90)\nat Symfony\\Component\\Config\\Loader\\FileLoader->import('.', 'api_platform', false, '/opt/beip-bx/bx/config/routing.yml') in vendor/symfony/symfony/src/Symfony/Component/Routing/Loader/YamlFileLoader.php (line 161)\nat Symfony\\Component\\Routing\\Loader\\YamlFileLoader->parseImport(object(Symfony\\Component\\Routing\\RouteCollection), array('resource' => '.', 'type' => 'api_platform', 'prefix' => '/api/0.2'), '/opt/beip-bx/bx/confi\nat Symfony\\Component\\Routing\\Loader\\YamlFileLoader->load('/opt/beip-bx/bx/config/routing.yml', null) in vendor/symfony/symfony/src/Symfony/Component/Config/Loader/FileLoader.php (line 153)\nat Symfony\\Component\\Config\\Loader\\FileLoader->doImport('/opt/beip-bx/bx/config/routing.yml', null, false, '/opt/beip-bx/bx/config/routing_dev.yml') in vendor/symfony/symfony/src/Symfony/Component/Config/Loader/Fi\nat Symfony\\Component\\Config\\Loader\\FileLoader->import('routing.yml', null, false, '/opt/beip-bx/bx/config/routing_dev.yml') in vendor/symfony/symfony/src/Symfony/Component/Routing/Loader/YamlFileLoader.php (line 1\nat Symfony\\Component\\Routing\\Loader\\YamlFileLoader->parseImport(object(Symfony\\Component\\Routing\\RouteCollection), array('resource' => 'routing.yml'), '/opt/beip-bx/bx/config/routing_dev.yml', '/opt/beip-bx/bx/con\nat Symfony\\Component\\Routing\\Loader\\YamlFileLoader->load('/opt/beip-bx/bx/config/routing_dev.yml', null) in vendor/symfony/symfony/src/Symfony/Component/Config/Loader/DelegatingLoader.php (line 40)\nat Symfony\\Component\\Config\\Loader\\DelegatingLoader->load('/opt/beip-bx/bx/config/routing_dev.yml', null) in vendor/symfony/symfony/src/Symfony/Bundle/FrameworkBundle/Routing/DelegatingLoader.php (line 70)\nat Symfony\\Bundle\\FrameworkBundle\\Routing\\DelegatingLoader->load('/opt/beip-bx/bx/config/routing_dev.yml', null) in vendor/symfony/symfony/src/Symfony/Bundle/FrameworkBundle/Routing/Router.php (line 56)\nat Symfony\\Bundle\\FrameworkBundle\\Routing\\Router->getRouteCollection() in vendor/symfony/symfony/src/Symfony/Component/Routing/Router.php (line 367)\nat Symfony\\Component\\Routing\\Router->getMatcherDumperInstance() in vendor/symfony/symfony/src/Symfony/Component/Routing/Router.php (line 289)\nat Symfony\\Component\\Routing\\Router->Symfony\\Component\\Routing\\{closure}(object(Symfony\\Component\\Config\\ResourceCheckerConfigCache))\nat call_user_func(object(Closure), object(Symfony\\Component\\Config\\ResourceCheckerConfigCache)) in vendor/symfony/symfony/src/Symfony/Component/Config/ResourceCheckerConfigCacheFactory.php (line 43)\nat Symfony\\Component\\Config\\ResourceCheckerConfigCacheFactory->cache('/opt/beip-bx/cache/sf2/bxDevDebugProjectContainerUrlMatcher.php', object(Closure)) in vendor/symfony/symfony/src/Symfony/Component/Routing/Rout\nat Symfony\\Component\\Routing\\Router->getMatcher() in vendor/symfony/symfony/src/Symfony/Component/Routing/Router.php (line 256)\nat Symfony\\Component\\Routing\\Router->matchRequest(object(Symfony\\Component\\HttpFoundation\\Request)) in vendor/symfony/symfony/src/Symfony/Component/HttpKernel/EventListener/RouterListener.php (line 109)\nat Symfony\\Component\\HttpKernel\\EventListener\\RouterListener->onKernelRequest(object(Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent), 'kernel.request', object(Symfony\\Component\\HttpKernel\\Debug\\TraceableEvent\nat call_user_func(array(object(Symfony\\Component\\HttpKernel\\EventListener\\RouterListener), 'onKernelRequest'), object(Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent), 'kernel.request', object(Symfony\\Componen\nat Symfony\\Component\\EventDispatcher\\Debug\\WrappedListener->__invoke(object(Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent), 'kernel.request', object(Symfony\\Component\\EventDispatcher\\ContainerAwareEventDispa\nat Symfony\\Component\\EventDispatcher\\EventDispatcher->doDispatch(array(object(Symfony\\Component\\EventDispatcher\\Debug\\WrappedListener), object(Symfony\\Component\\EventDispatcher\\Debug\\WrappedListener), object(Symfo\nat Symfony\\Component\\EventDispatcher\\EventDispatcher->dispatch('kernel.request', object(Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent)) in vendor/symfony/symfony/src/Symfony/Component/EventDispatcher/Debug/T\nat Symfony\\Component\\EventDispatcher\\Debug\\TraceableEventDispatcher->dispatch('kernel.request', object(Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent)) in vendor/symfony/symfony/src/Symfony/Component/HttpKern\nat Symfony\\Component\\HttpKernel\\HttpKernel->handleRaw(object(Symfony\\Component\\HttpFoundation\\Request), 1) in vendor/symfony/symfony/src/Symfony/Component/HttpKernel/HttpKernel.php (line 68)\nat Symfony\\Component\\HttpKernel\\HttpKernel->handle(object(Symfony\\Component\\HttpFoundation\\Request), 1, true) in vendor/symfony/symfony/src/Symfony/Component/HttpKernel/Kernel.php (line 202). I didn't know Github has fixed max width of a line. I tested putting the trace into Gist, but it didn't work, either. :/. Any advice? . The property is private and I have getter, getExtraInfos(), but I don't have setter. I have addExtraInfo(ExtraInfo $extraInfo) and removeExtraInfo(ExtraInfo $extraInfo) instead. Is it something to do with the setter? \nI've just tried, but I got same error message.. I totally agree that it's really weird.. Yes, it's also an entity. ExtraField which is eager to be the key, too. . ",
    "clementvp": "Thank you for the quick answer.\nIf this in the doc, i'm really blind ;)\nThank you.. ",
    "VictorKrasnov": "Yes.. ",
    "erichard": "@dunglas Tests are green . Yes but 3.2 is allowed to. symfony composer.json conflict with \n\"phpdocumentor/reflection-docblock\": \"<3.0||>=3.2.0,<3.2.2\",\nI don't know how composer choose what version to install in this case as there is multiple valid choices:\n *  symfony/symfony@3.3.4 with phpdocumentor/reflection-docblock@3.2.2 \n * symfony/symfony@3.3.6 with phpdocumentor/reflection-docblock@3.1.1\nThis is not really a bug in api-platform. I can downgrade phpdocumentor/reflection-docblock in my own project and it will also work.\nActually symfony/symfony is locked at 3.3.5 in the master branch, but if you try a composer update it will downgrade to 3.3.4. . ",
    "mab05k": "Update: Pull request\nhttps://github.com/api-platform/core/pull/1433\nI had the same issue with this today and I did a little digging. One way to do it is by overriding the Swagger documentation using the method described in the override swagger documentation which could get really tedious is you have lots of properties to update.\nMake sure your array conforms to the Swagger specification\nHowever, I also looked into why it couldn't be configured via the annotations/yml. I noticed that when the swagger documentation is being generated, it doesn't take into account anything configured in the \"attribute\" property of the PropertyMetadata (perhaps I didn't look thoroughly enough?). \nMy assumption would be that a configuration for these enums should look something like this?\nresources:\n  AppBundle\\Entity\\Order:\n    itemOperations:\n      get:\n        method: 'GET'\n      put:\n        method: 'PUT'\n      delete:\n        method: 'DELETE'\n    collectionOperations:\n      get:\n        method: 'GET'\n      post:\n        method: 'POST'\n    properties:\n      status:\n        attributes:\n          swagger_context:\n            type: string\n            enum: [ 'value1', 'value2' ]\n            example: value1\nor\n/**\n     * @ApiProperty(\n     *     attributes={\n     *          \"swagger_context\"={\n     *              \"type\"=\"string\",\n     *              \"enum\"={\"value1\", \"value2\"},\n     *              \"example\"=\"value1\"\n     *           }\n     *     }\n     * )\n     */\n     private $order;\nWhere \"attributes->swagger_context\" would define Swagger attributes for the property. I believe the right place to add something here is in the getPropertySchema() function in src/Swagger/Serializer/DocumentationSerializer.php - some kind of addition to the $valueSchema array.\n@dunglas I'm unsure of your intent for that \"attributes\" property of the PropertyMetadata. I'm happy to contribute with some more direction.. ",
    "razbakov": "Is there a way to dynamically generate values for enum fields?. @xavirp \nThat method has either wrong name (it should be called then addReviews) or implementation is wrong:\n```php\npublic function setReviews($reviews)\n{\n  foreach($reviews as $r) {\n    $this->addReview($r);\n  }\nreturn $this;\n}\n```\nThe right implementation would be:\n```php\npublic function setReviews($reviews)\n{\n  $this->reviews = new ArrayCollection($reviews);\nreturn $this;\n}\n```\nAnd it is not an issue of api-platform itself, for those kind of questions I would recommend to use StackOverflow.\nP.S. Please close it ;) . ",
    "Drachenkaetzchen": "Realized that this is the wrong repo, closing.. ",
    "hpatoio": "The link above gives 404. I think the new link is https://api-platform.com/docs/core/serialization/#changing-the-serialization-context-on-a-per-item-basis. @LukA888 would you share the relevant code ? . ",
    "vdesdoigts": "If I use /api/books?user=79 it returns string(18) \"App\\Entity\\Book\", I don't understand the difference :). Wrong get() sorry, thanks for the help!. ",
    "aibragimov4xxi": "I dont know why, but my problem was magically solved. Now types in swagger are correct.. ",
    "benr77": "I have now managed to do this using YML configuration instead of Annotations - e.g.\n```\nsrc/AppBundle/Resources/config/api_resources/resources.yml\nresources:\n    SomeOtherBundleBundle\\Entity\\Product: ~\n```\nIn my case this is actually preferable as my Entities are in a shared repository and I don't really want to have to make them dependent on ApiPlatform.\nIf anybody does have a solution to using Annotations to configure entities from another package that would be useful to document it here for future reference.. As sometimes happens I've immediately found the solution after posting the question. For future reference, this can simply be done as follows:\nApp\\Model\\MyORMLessEntity:\n    properties:\n        id:\n            identifier: true\n. Sorry for the confusion - there is NOT a bug. \nI had it working just fine with annotations. \nHowever, I wanted to decouple my model entities from the ApiPlatform bundle, so was looking for a way to replace the annotations in the entity classes with some YML config that I could store elsewhere.\nSo it's working fine with annotations and YML config.. Ok thanks. Am I correct in thinking the cache is only applied for non-modifying request methods such as GET and is automatically disabled for POST/PUT requests?. Ok thanks very much for the help.. ",
    "mickaelandrieu": "Note I don't say we/you? should remove React! As a developer really annoying with legal stuff I'm really worried about it. I've asked to my family lawyer but he was not able to answer me.\nI don't want to fear anyone or whatever, the preact alternative looks good to me.\nThanks for your answers! . @fzaninotto the fact is that Patents conflicts with MIT license: MIT license means you can use a software without any restriction. This is not about what do you mind or not, this is about using the right license. As for now, and because admin on rest have an hard dependency on React, the project can't be licensed under MIT because it doesn't respect the MIT license.... how is it possible ? MIT say \"you can use the software without any restrictions\" and a Patent is a restriction... you can't be compliant with MIT license, or I've misunderstood MIT license terms (which is possible :) ). Thanks for your answers, after a lot of reading, I'm coming to the same conclusions.\nWhen you sue Facebook for patents (lol?) you are losing the right to use patents provided with React but this doesn't affect the rights provided by the initial BSD-3 licence on React code. I'll write something about it: it's a fair situation.\nStill, I'm wondering if we should add a note for people who own patents?\n. @soyuka as you like, it's only a suggestion: I - also - consider this issue closed :)\nThank you for your time!. yes! :). ",
    "developit": "You can alias proptypes/disabled in for prop-types. It's just a bunch of empty functions.. ",
    "fzaninotto": "admin-on-rest's licence is MIT. We have a hard dependency on React, but we don't mind the BSD+Patents licence - we think it's fair.\nIMHO, if you care about it, that means you think you can sue Facebook in the future, so you're very rich, and you shouldn't use open-source in that case : spend you money to help editors! ;). ",
    "Dakhtara": "``` php\n<?php\nnamespace AppBundle\\Action;\nuse AppBundle\\Entity\\QuestionSet;\nuse AppBundle\\Entity\\User;\nuse Doctrine\\Common\\Persistence\\ObjectManager;\nuse Sensio\\Bundle\\FrameworkExtraBundle\\Configuration\\Method;\nuse Sensio\\Bundle\\FrameworkExtraBundle\\Configuration\\Route;\nuse Symfony\\Component\\HttpFoundation\\Request;\nuse Symfony\\Component\\HttpFoundation\\RequestStack;\nuse Symfony\\Component\\Security\\Core\\Authentication\\Token\\Storage\\TokenStorageInterface;\nuse Symfony\\Component\\Security\\Core\\Exception\\AccessDeniedException;\nclass QuestionSetsAction\n{\n    /*\n     * @var ObjectManager\n     /\n    private $om;\n/**\n * @var TokenStorageInterface\n */\nprivate $tokenStorage;\n\n/**\n * @var RequestStack\n */\nprivate $requestStack;\n\n/**\n * QuestionAction constructor.\n * @param ObjectManager $objectManager\n * @param TokenStorageInterface $tokenStorage\n */\npublic function __construct(ObjectManager $objectManager, TokenStorageInterface $tokenStorage,\n                            RequestStack $requestStack)\n{\n    $this->om = $objectManager;\n    $this->tokenStorage = $tokenStorage;\n    $this->requestStack = $requestStack;\n}\n\n/**\n * @Route(\n *     path = \"question_sets\",\n *     name = \"question_sets\",\n *     defaults = {\"_api_resource_class\"=QuestionSet::class, \"_api_collection_operation_name\"=\"get\"}\n * )\n * @Method({\"GET\", \"HEAD\", \"OPTIONS\"})\n */\npublic function __invoke(): array\n{\n    $request = $this->requestStack->getCurrentRequest();\n    if (in_array($request->getMethod(), [Request::METHOD_HEAD, Request::METHOD_OPTIONS], true)) {\n        return [];\n    }\n\n    $qsRep = $this->om->getRepository('AppBundle:QuestionSet');\n    $token = $this->tokenStorage->getToken();\n    /** @var User $user */\n    $user = (null !== $token ? $token->getUser() : null);\n\n    if (null === $token || null === $user) {\n        throw new AccessDeniedException();\n    }\n\n    $charterRep = $this->om->getRepository('AppBundle:Charter');\n    $poultryRep = $this->om->getRepository('AppBundle:Poultry');\n\n    $poultries = $poultryRep->findAll();\n    $charters = [];\n    foreach ($poultries as $poultry) {\n        $charters[] = $charterRep->getLatest($poultry);\n    }\n    // R\u00e9cup\u00e9ration des QuestionSets hi\u00e9rarchis\u00e9s\n    $questionSets = $qsRep->getLatest($user, $charters);\n\n    return $questionSets;\n}\n\n}\n```\nThis is the custom action. It returns the correct number of items. . Thanks for the reply. But what if i need to work on the data before. Like control if user is granted to see the data. \nIn my case I get the data, process it with some methods and return it. So this returned data can't be paginated right ?. Thanks for the reply but that's not what I'm looking for. My entity should not depend on a service like the router of symfony to generate an absolute link. Do you have any other way to do this ?. As the doc show here : https://api-platform.com/docs/core/serialization#decorating-a-serializer-and-add-extra-data\nIt looks easy, I add the example \nyaml    \nAppBundle\\Serializer\\ApiNormalizer:\n        decorates: 'api_platform.jsonld.normalizer.item'\n        arguments: [ '@AppBundle\\Serializer\\ApiNormalizer.inner' ]\n        autoconfigure: false\nI copy paste the exact same ApiNormalizer in my src/AppBundle/Serializer \n``` php\n<?php\nnamespace AppBundle\\Serializer;\nuse ApiPlatform\\Core\\Serializer\\AbstractItemNormalizer;\nuse Symfony\\Component\\Serializer\\Normalizer\\NormalizerInterface;\nfinal class ApiNormalizer extends AbstractItemNormalizer\n{\n    private $decorated;\npublic function __construct(NormalizerInterface $decorated)\n{\n    $this->decorated = $decorated;\n}\n\npublic function supportsNormalization($data, $format = null)\n{\n    return $this->decorated->supportsNormalization($data, $format);\n}\n\npublic function normalize($object, $format = null, array $context = [])\n{\n    $data = $this->decorated->normalize($object, $format, $context);\n    if (is_array($data)) {\n        $data['date'] = date(\\DateTime::RFC3339);\n    }\n    return $data;\n}\n\npublic function supportsDenormalization($data, $type, $format = null)\n{\n    return $this->decorated->supportsDenormalization($data, $type, $format);\n}\n\npublic function denormalize($data, $class, $format = null, array $context = [])\n{\n    return $this->decorated->denormalize($data, $class, $format, $context);\n}\n\n}\n```\nAnd this is my output in jsonld. \njson\n{\n    \"@context\": \"/app_dev.php/contexts/Audit\",\n    \"@id\": \"/app_dev.php/audits\",\n    \"@type\": \"hydra:Collection\",\n    \"hydra:member\": [],\n    \"hydra:totalItems\": 0\n}\nAs you can see there is no output of the date. \nMy composer json looks for api-platform/core : \"^2.1\"\nIs there any issue withe the ItemNormalizer for this version ? . Yes right, It was because of my token. But now i'm facing a new issue.\njson\n    \"@context\": \"/app_dev.php/contexts/Error\",\n    \"@type\": \"hydra:Error\",\n    \"hydra:title\": \"An error occurred\",\n    \"hydra:description\": \"Call to a member function normalize() on null\",\n    \"trace\": [\n        {\n            \"namespace\": \"\",\n            \"short_class\": \"\",\n            \"class\": \"\",\n            \"type\": \"\",\n            \"function\": \"\",\n            \"file\": \"/var/www/symfony/vendor/api-platform/core/src/Serializer/AbstractItemNormalizer.php\",\n            \"line\": 426,\n            \"args\": []\n        },\nThis is the new output. It goes well in the ApiNormalizer but it can't  call the normalize() on null.\nphp\n$data = $this->decorated->normalize($object, $format, $context);\nThis is the line of the example that trigger the error. The construct seems to not pass the NormalizerInterface. \n. ",
    "martinharder": "Hi, all the solutions I found here are not working for me. If I don't use a custom controller action I get paginated response with hydra:view. As far as I use a controller action which calls a service to get only certain objects assigned to a certain location of the current user, pagination is not working anymore.\nI tried to use a custom data provider, but with same result.\nSo what is the usual way to allow pagination on the result array as Api Platform does without custom controller action?. I found the solution.\n```\nuse Doctrine\\ORM\\Tools\\Pagination\\Paginator;\nuse ApiPlatform\\Core\\Bridge\\Doctrine\\Orm\\Paginator as ApiPlatformPaginator;\n...\n$queryBuilder = $em->createQueryBuilder();\n$queryBuilder->select('e')\n                ->from(Entity::class, 'e')\n                ->where('e.location = :location')\n                ->setParameter('location', $currentLocation->getId());\n$query = $queryBuilder->getQuery()\n    ->setFirstResult($firstResult)\n    ->setMaxResults(self::ITEMS_PER_PAGE);\n$doctrinePaginator = new Paginator($query);\n$paginator = new ApiPlatformPaginator($doctrinePaginator);\nreturn $paginator;\n```\nThis works for me and I just have to pass the page number from the controller to this service method.\nThe response contains hadra:view.. https://github.com/api-platform/docs/pull/638. ",
    "antoinemineau": "Account are not activated by default because the behaviour is that an admin has to enable it.\nYou can set a default value to the enabled property or in the constuctor to change that  : \npublic function __construct()\n{\n    $this->enabled = true;\n}\nAbout your approach I think it's the right one.\nIf you can look into this issue, it would help me a lot : https://github.com/FriendsOfSymfony/FOSUserBundle/issues/2605\nYou managed to install Api-platform with FOSUser and I didn't.... You are my god.\nLost countless of hours just for one configuration line.\nI was only missing this :\nform: { enabled: true }\nDocumentation has always been so difficult to find...\nI hope the api-platform team will add your PR fast.\nThanks a lot.\n. Thanks @piotaixr !\nI have once again hope with my api-platform project but seriously not having this in the documentation or activated by default makes no sense to me.. Good feedback @dunglas.\nI will look into those links, the right way might be to create our own authentication system and user management instead of finding a way to make FOSUser work with our requirements.\nThanks for the quick update on the api-platform FOSUserBundle Integration !. ",
    "piotaixr": "@antoinemineau Didn't thought of this solution for enabling the user by default :D\nBut I actually need a valid address for the user so i need to activate the user using an email confirmation link.\nAfter more testing it seems that the FOSUserBundle has some default behavior that cannot be customized so i will maybe need to rewrite the whole thing :s. @Warxcell Yup, that's the way I do it. Although, I configure my API using YAML.\nEx: That's the route I use for user registration (additional logic like send confirmation email, etc). I obviously want users to access it when not connected :-)\nyaml\nresources:\n    App\\Entity\\User:\n        collectionOperations:\n            register:\n                method: POST\n                route_name: user_register\n                access_control: \"is_granted('IS_AUTHENTICATED_ANONYMOUSLY')\"\n                denormalization_context:\n                    groups:\n                        - user-register. Thanks @soyuka !\nIt works (kind of).\nNow, y have a new route:\napi_logs_links_get_subresource                                   GET      ANY      ANY    /logs/{id}/links.{_format}\nThe problem here is that i have prefixed the logs resources URLs by /application:\nyaml\nresources:\n    AppBundle\\Entity\\Log:\n        properties:\n            links:\n                subresource: { collection: true, resourceClass: AppBundle\\Entity\\Log }\n        itemOperations:\n            get:\n                method: GET\n                path: /application/logs/{id}\n        collectionOperations:\n            # Subresources\n            api_logs_links_get_subresource:\n                method: GET\n                path: /application/logs/{id}/links\nThis configuration gives me two different routes:\napi_logs_api_logs_links_get_subresource_collection   GET      ANY      ANY    /application/logs/{id}/links\napi_logs_links_get_subresource                       GET      ANY      ANY    /logs/{id}/links.{_format}\nAm i using the wrong collection operation name for the subresource? How can i change the path (and then normalization groups) for the subresource operation?. > Why don't you prefix everything from the firewall instead of rewriting the paths manually?\n@soyuka You mean in routing.yml ?\nThe thing is that not all my resources are under /application so i don't want to prefix all the resources.\nIs it possible to group resources in categories? I didn't see anything like it in the docs but maybe i missed it.\n\nBut yes, to change the groups you've to use the correct operation name given above: api_logs_links_get_subresource.\n\nYes, that's what i did, right? But it does not edit the settings of the subresource operation but creates a new collection operation instead.\n. ",
    "hounded": "@dunglas I want to use a custom auth system, which I have done and used with jwt thanks to this \nhttps://emirkarsiyakali.com/implementing-jwt-authentication-to-your-api-platform-application-885f014d3358\nhowever I can not find any documentation on how to manage all the emailing password resetting that the fosuser bundle provides, any chance this was on your long list todo, and second you could bump it? . @Arendir Do you have any links on where to start regarding resetting a password via api, it would be very much appreciated. Even some sudo code with the general idea would be great . ",
    "Warxcell": "@piotaixr can I ask how u enable ANONYMOUS access to post? \nI tried with:\n@ApiResource(\n *     collectionOperations={\n *          \"post\"={\n *              \"normalization_context\"={\"groups\"={\"post\"}},\n *              \"denormalization_context\"={\"groups\"={\"post\"}},\n *              \"validation_groups\"={\"Default\", \"registration\"},\n *              \"access_control\"=\"is_granted('IS_AUTHENTICATED_ANONYMOUSLY')\"\n *          }\n *      },\nbut it does not works for me? Thanks. What about something like that:\n```\n<?php\ndeclare(strict_types=1);\nnamespace App\\EventSubscriber;\nuse ApiPlatform\\Core\\EventListener\\EventPriorities;\nuse App\\Entity\\User;\nuse Symfony\\Component\\EventDispatcher\\EventSubscriberInterface;\nuse Symfony\\Component\\HttpKernel\\Event\\GetResponseForControllerResultEvent;\nuse Symfony\\Component\\HttpKernel\\KernelEvents;\nuse Symfony\\Component\\Security\\Core\\Encoder\\UserPasswordEncoderInterface;\nfinal class UserSubscriber implements EventSubscriberInterface\n{\n    /* @var UserPasswordEncoderInterface /\n    private $passwordEncoder;\npublic function __construct(UserPasswordEncoderInterface $passwordEncoder)\n{\n    $this->passwordEncoder = $passwordEncoder;\n}\n\npublic static function getSubscribedEvents()\n{\n    return [\n        KernelEvents::VIEW => ['setPassword', EventPriorities::POST_VALIDATE],\n    ];\n}\n\npublic function setPassword(GetResponseForControllerResultEvent $event)\n{\n    $user = $event->getControllerResult();\n\n    if ($user instanceof User && $user->getPlainPassword()) {\n        $password = $this->passwordEncoder->encodePassword($user, $user->getPlainPassword());\n        $user->setPassword($password);\n    }\n}\n\n}\n```\nDidn't tested it.. ",
    "maurotdo": "It now requires php 7.1, even if composer states php 7.0 - check your php version / docker image. The fix for v2.0 would be changing the requirement for\n\"api-platform\": \"^2.0\" \nto\n\"api-platform\": \"~2.0\" \nFor v2.1 i don't know, is the software compatible with symfony 3.2 ?\nIf not, drop support for php 7.0 and change composer.json to require php 7.1+\nIf yes, change composer.json to lower the requirement on symfony/symfony to 3.2. ",
    "reminec": "yep ! \n```yaml\nLearn more about services, parameters and containers at\nhttp://symfony.com/doc/current/service_container.html\nparameters:\n    #parameter_name: value\nservices:\n    # default configuration for services in this file\n    _defaults:\n        # automatically injects dependencies in your services\n        autowire: true\n        # automatically registers your services as commands, event subscribers, etc.\n        autoconfigure: true\n        # this means you cannot fetch services directly from the container via $container->get()\n        # if you need to do this, you can override this setting on individual services\n        public: false\n# makes classes in src/AppBundle available to be used as services\n# this creates a service per class whose id is the fully-qualified class name\nAppBundle\\:\n    resource: '../../src/AppBundle/*'\n    # you can exclude directories or files\n    # but if a service is unused, it's removed anyway\n    exclude: '../../src/AppBundle/{Entity,Repository}'\n\n# controllers are imported separately to make sure they're public\n# and have a tag that allows actions to type-hint services\nAppBundle\\Action\\:\n    resource: '../../src/AppBundle/Action'\n    public: true\n    tags: ['controller.service_arguments']\n\n# add more services, or override services that need manual wiring\n# AppBundle\\Service\\ExampleService:\n#     arguments:\n#         $someArgument: 'some_value'\n\n'AppBundle\\Swagger\\SwaggerDecorator':\n    decorates: 'api_platform.swagger.normalizer.documentation'\n    arguments: [ '@AppBundle\\Swagger\\SwaggerDecorator.inner' ]\n    public: false\n\n```\nIn my project I also tried to disabled autowiring and declare the service via the old way. \nSame error.\nI had setup a repository to reproduce the bug with a fresh create-project with composer : \nhttps://github.com/reminec/api-platform-swagger-decorator-issue\n. Many thanks @dunglas I will try on Monday\n. ",
    "matrix818181": "Got the same issue !\nI've made some research within the api-platform folder and I found 1 reference with \"Bearer\" but the case is correct. It must be something else that lower the string.\nI'm currently using Postman to my RestAPI.. ",
    "COil": "Same problem, can't switch to 7.1 , it should support 7.0 IMHO.\nMoreover when using the installer we have in the composer file:\n\"php\": \">=7.0\",\n\n. The core yes may be. But it as it includes the schema generator package which requires PHP 7.1 the composer update will fail.. ",
    "DariuszLuber": "You need add normalization context in @APIResources attributes \n\"normalization_context\"={\"groups\"={\"list\"}}\nfor house entity.\nThen when getting a House endpoint data it will use group \"list\" to normalize.\nAlso do you have set eager loading in config?. I think not in @ApiSubresources, but in @ApiResource\nI have it like this:\n* @ApiResource(attributes={\n *                          \"filters\"={\"apiOrder\", \"searchFilter\", \"searchOrFilter\"},\n *                          \"pagination_items_per_page\"=50,\n *                          \"force_eager\"=true,\n *                          \"normalization_context\"={\"groups\"={\"doctor\"}}\n *                          })\nAnd this is set for Class\nIn all connected entities i add on fields:\n@Groups({\"doctor\" })\n. Subresource are not to load at once, but to call subresources in next request.\nEx. from documentation:\nwe have question with id 42, and we want get only answers connected with that, so we make a request\n/question/42/answer - this will return only answers, without data of question 42\nGroup in Subresource is to set which \"columns\" to get from subresource.\n@soyuka Am I right?. I'm back to that subject, and I've got one more question - How to filter subresources?. Hi, thanks.\nMayby I used wrong word.\nI want to make my filter from \n/cars/{id}?color.name=blue\nretuned me \n{\n  [\n    brand: 'traband',\n    color: [\n           {name: blue}\n  ]\n}\nnot\n{\n  [\n    brand: 'traband',\n    color: [\n           {name: blue},\n           {name: green}\n  ]\n}\nSo mayby not subresources (added by annotation @ApiSubresource) but data included in response by using groups. Maybe better example is in my post at the begining of issue.. :) - I undestended it in your first post - but any sugestion how to start it.\nHow are subdata loaded?\nDo I need to create custom DataProvider, or create filter and modify DQL?\nWhich option in your opinion is best?\n. Sory, no success with it.\nI resignated from using API Platform in that case, and I create my own controller for that case. @soyuka thanks for advice, but as I see I need to build my all structure on my Action based on custom data provider.\nNow I have problem, cause for Assortment I want use default provider, but for action custom provider - how to do this?\nYou also suggest use event listener - to do that I on the event I take data given, iterate them and inject my extra data? Am I right?. I created new Entity (not connected with db)  which has own repository with DQL to build my resources and connect Custom data provider for it, but I don't know how to get doctrine in Custom data provider and how enable filters, which are used for other Entities.\nAny sugestion?\n. Thanks @dunglas.\nWhere I can look for information how to register my DataProvider?\nI tried:\napp.drug_manufacturer_data_provider:\n        class: AppBundle\\DataProvider\\DrugManufacturerProvider\n        arguments: ['@doctrine']\n        autowire: true\n        tags:\n          - { name: 'api_platform.collection_data_provider', priority: 2 }\nbut it's not working.\nWhere I can  also look for information how to create subresources?. Not really everything in docs :( - it shows how to serve data, but without queryBuilder and with simple data. I'd prefer not to do big loops for one data and inject subresurces :/  and I want to use filters which are I wrote for default entities.\nI'm trying to use Collection Data Provider with constructor in which  I need to inject ManagerRegistry, and it doesn't work :/\nAbout subresources I want create them like like in my first post.\nP.S. When I figure everything out I'll write a cookbook to docs ;). I do that by  a doctrine event listener\nFrom my code + comments for you:\n```\nclass DrugListener\n{\n    public function postLoad(LifecycleEventArgs $args)\n    {\n        $entity = $args->getEntity();//here you have access to your entity\n        if ($entity instanceof Drug) {\n        $em = $args->getEntityManager();\n         //additional operations to get needed data\n         $drugDeliveryRepository = $em->getRepository(DrugDelivery::class);\n\n         $storageQuantity = $drugDeliveryRepository->getStorageQuantity( $entity ) ;\n         $entity->setStorageQuantity( ($storageQuantity)?$storageQuantity:0 );\n\n         $deliveryCost = $drugDeliveryRepository->getDeliveryCost( $entity ) ;\n         $entity->setDeliveryCost( ($deliveryCost)?$deliveryCost:0 );\n\n\n        $saleData = $em->getRepository(DrugSale::class)->getSoldData( $entity ) ;\n        //set additional data\n        $entity->setSaleQuantity( ($saleData['quantity'])?$saleData['quantity']:0 );\n        $entity->setSaleValue( ($saleData['soldValue'])?$saleData['soldValue']:0 );\n        $entity->setSaleProfit( $saleData['soldValue'] - $deliveryCost );\n\n    }\n}\n\n}\n`\nand register it\n drug_entity.event_listener:\n           class: AppBundle\\EventListener\\Entity\\DrugListener\n           tags:\n               - { name: doctrine.event_listener, event: postLoad }\n```\nMaybe not the best method, couse you can't use those fields to filter.\nOf cource I had to add additional attributes, getters and setter in entity, but not connected with ORM.\n. Hi, again.\nI'm moving configs from annotation to yaml, and I have few questions about file structure.\nI created separated yaml files for each entity:\n\nhere is sample Assortment.yml file:\n```\nAppBundle\\Entity\\Assortment:\n    attributes:\n        filters: [ 'app.apiOrder', 'app.searchFilter', 'app.searchOrFilter' ]\n        normalization_context:\n            groups: ['assortment']\n        id:\n            groups: ['assortment', 'drugs_unified', 'sale', 'drugs']\n        name:\n            groups: ['assortment', 'drugs_unified', 'sale', 'drugs']\n        drugsUnified:\n            groups: ['assortment']\n    pagination_items_per_page: 10\n    fetchEager: true\n\nitemOperations:\n    get:\n        method: 'GET'\n    put:\n        method: 'PUT'\n    delete:\n        method: 'DELETE'\n    add:\n        route_name: 'api_assortment_add_drugunified'\n        swagger_context:\n            parameters:\n                - name: 'id'\n                  in: 'path'\n                  required: 'true'\n                  type: 'string'\n\n                - name:  'ids'\n                  in:  'body'\n                  type:  'string'\n                  schema:\n                    type: 'object'\n                    properties:\n                      ids:\n                        type: 'string'\n                  style: 'simple'\n            summary:  'Add drugs_unified to assortment'\n\n    remove:\n        route_name: 'api_assortment_remove_drugunified'\n        swagger_context:\n            parameters:\n                - name:  'id'\n                  in:  'path'\n                  required:  'true'\n                  type:  'string'\n\n                - name: 'ids'\n                  in:  'body'\n                  type:  'string'\n                  schema:\n                    type: 'object'\n                    properties:\n                      ids:\n                        type: 'string'\n                  style: 'simple'\n            summary:  'Remove drugs_unified from assortment'\n\n```\nItem and collection operation works well, but settings under attributes section not.\nAlso I tried to create resources.yml in Resources/config and move there:\n```\nresources:\n  AppBundle\\Entity\\Assortment:\n      attributes:\n          filters: [ 'app.apiOrder', 'app.searchFilter', 'app.searchOrFilter' ]\n          normalization_context:\n              groups: ['assortment']\n          id:\n              groups: ['assortment', 'drugs_unified', 'sale', 'drugs']\n          name:\n              groups: ['assortment', 'drugs_unified', 'sale', 'drugs']\n          drugsUnified:\n              groups: ['assortment']\n      pagination_items_per_page: 10\n      fetchEager: true\n\nAppBundle\\Entity\\DrugUnified:\n      attributes:\n          filters: ['app.apiOrder', 'app.searchFilter', 'app.searchOrFilter','app.drug_unified_in_buffer']\n          pagination_items_per_page: 50\n          force_eager: true\n          normalization_context:\n              groups: ['drugs_unified']\n      id:\n        groups: ['drugs_unified','assortment', 'sale']\n      name:\n        groups: ['drugs_unified','assortment', 'sale']\n      originalSymbol:\n        groups: ['drugs_unified']\n      drugs:\n        groups: ['drugs_unified','assortment']\n      assortment:\n        groups:  ['drugs_unified', 'sale']\n\n```\nI tried solution from https://github.com/api-platform/api-platform/issues/184 but with serializer still not working :/\n```\n// src/AppBundle/Resources/config/serialization/Assortment.yml\nAppBundle\\Entity\\Assortment:\n    attributes:\n        filters: [ 'app.apiOrder', 'app.searchFilter', 'app.searchOrFilter' ]\n        normalization_context:\n            groups: ['assortment']\n        id:\n            groups: ['assortment', 'drugs_unified', 'sale', 'drugs']\n        name:\n            groups: ['assortment', 'drugs_unified', 'sale', 'drugs']\n        drugsUnified:\n            groups: ['assortment']\n    pagination_items_per_page: 10\n    fetchEager: true\n\n```\nCouse normalization is not working so eager loading is also not working.\nOf course  I cleared cache ;)\nWhat I'm doing wrong?\n. It's almost working.\nI set config for serialization based on http://symfony.com/doc/current/serializer.html#using-serialization-groups-annotations - so I created folder \"serialization\" and there seperate yaml files for entities.\n```\n//Resources/config/serialization/Assortment.yml\nAppBundle\\Entity\\Assortment:\n    attributes:\n        id:\n            groups: ['assortment', 'drugs_unified', 'sale', 'drugs']\n        name:\n            groups: ['assortment', 'drugs_unified', 'sale', 'drugs']\n        drugsUnified:\n            groups: ['assortment']\nNext I wanted to set default normalization_context in Resources/config/api_resources/Assortment.yml\nAppBundle\\Entity\\Assortment:\n    attributes:\n        normalization_context:\n            groups: ['assortment']\n        filters: [ 'app.apiOrder', 'app.searchFilter', 'app.searchOrFilter' ]\n        pagination_items_per_page: 10\nNone of set attribute works - where I should set it up?\nIf for each operation in Resources/config/api_resources/Assortment.yml file I set up normalization_context than it works (getting fields, but still not working eager loading)\n collectionOperations:\n        get:\n            method: 'GET'\n            normalization_context:\n                groups: ['assortment']\n``` \n@soyuka - you had right -  with yaml it's really clearer, but getting it working again takes some time ;) - do you have any sugetion which will save my time :)\n. I found, in my opinion, strange beachaviour with eager loading.\nI disabled it in config.yml and there is no annotation / config for entities to use eager loading.\neager_loading:\n        enabled: false\n        max_joins: 100\n        force_eager: false\nI was thinking, that if it is disabled than no data connected will be loaded, so I supposed to get something like that\n{\n  \"@context\": \"/api/contexts/Assortment\",\n  \"@id\": \"/api/assortments\",\n  \"@type\": \"hydra:Collection\",\n  \"hydra:member\": [\n    {\n      \"@id\": \"/api/assortments/1\",\n      \"@type\": \"Assortment\",\n      \"id\": 1,\n      \"name\": \"test\",\n      \"drugsUnified\": [\n        \"/api/drug_unifieds/estimation/2\",\n        \"/api/drug_unifieds/estimation/3\",\n        \"/api/drug_unifieds/estimation/4\",\n        \"/api/drug_unifieds/estimation/5\"\n      ]\n    }\n  ],\n  \"hydra:totalItems\": 1\n}\nbut I get full data fot each element in drugsUnified, and the reason is serialization - I set the same serialization group in drugsUnified which I set for Assortment.\nSo is eager loading needed? \nP.S. Still don't know where to setup filters for entities :/\n. Between drugsUnified and Assortment is many to many relation.. Thanks, for reply.\nI changed in Repository to:\n```\n $em = $this->getEntityManager();\n    $queryBuilder = $em->createQueryBuilder();\n\n\n    $queryBuilder -> select('ds') -> from(Drugstore::class,'ds');\n    $paginator = new Paginator($queryBuilder);\n    return $paginator;\n\n```\nand send request with params: page=1&itemsPerPage=1 - and still getting all records\nWhat I'm doing wrong?\nThere is also one problem with paginator - it works only if there is no GroupBy in queryBuilder, also I want to use subquery in from section (which is supported only in createNativeQuery - which is not supported by paginator).\nAny sugestions? \n. I have weird idea. Can I overwrite basic queryBuilder?\nI try to do something like this:\n- build filter \n```\nfinal class ReportSearchByFilter implements QueryCollectionExtensionInterface\n{\nprivate $request, $em;\n\npublic function __construct(RequestStack $requestStack, EntityManager $entityManager)\n{\n    $this -> request = $requestStack->getCurrentRequest();\n    $this -> em = $entityManager;\n}\n\npublic function applyToCollection(QueryBuilder $queryBuilder, QueryNameGeneratorInterface $queryNameGenerator, string $resourceClass, string $operationName = null)\n{\n\n\n    switch( $this -> request -> getPathInfo() ){\n\n        default:\n                $queryBuilder = $this->reportDrugStoreDrugSale();\n            break;\n    }\n\n//        Gives me good DQL and all Parameters\n//        dump($queryBuilder->getDQL());\n//        dump($queryBuilder->getParameters());\n//        exit;\n    }\n    private function reportDrugStoreDrugSale(){\n       //....\n      //return queryBuilder which I have from repository method\n    }\n}\n```\n\nand try to use basic filters and pagination from api-platform\n\nbut when I debug I see that default filters are fired before my filter :/ \nI set priority to filter to 100, but still the same result.\nIs it good way to try? What you think? . ",
    "julienpillias": "First, thank you for your help.\nI've just tried to add \nphp\n/**\n     * @var Department List of item departments where the house is available\n     *\n     * @ORM\\ManyToMany(targetEntity=\"XXX\\FrontBundle\\Entity\\Department\", inversedBy=\"houses\", fetch=\"EAGER\")\n     * @ORM\\JoinTable(name=\"house_department\",\n     *   joinColumns={\n     *     @ORM\\JoinColumn(name=\"house_id\", referencedColumnName=\"id\", onDelete=\"CASCADE\")\n     *   },\n     *   inverseJoinColumns={\n     *     @ORM\\JoinColumn(name=\"department_id\", referencedColumnName=\"id\", onDelete=\"CASCADE\")\n     *   }\n     * )\n     * @ApiSubresource(\"normalization_context\"={\"groups\"={\"list\"}})\n     */\n    private $departments;\nannotation on House side.\nand get this error (with or with out the EAGER set on the ManyToMany) : \njson\n{\n    \"@context\": \"/app_dev.php/contexts/Error\",\n    \"@type\": \"hydra:Error\",\n    \"hydra:title\": \"An error occurred\",\n    \"hydra:description\": \"[Syntax Error] Expected Doctrine\\\\Common\\\\Annotations\\\\DocLexer::T_IDENTIFIER, got 'normalization_context' at position 534 in property XXX\\\\FrontBundle\\\\Entity\\\\House::$departments.\",\n...\n}\nAre you sure we can pass option to ApiSubresource ? When opening ApiPlatform\\Core\\Annotation\\ApiSubresource.php, their is a final class ApiSubresource, with no options !\nEAGER is only optimisation ? should still works with out it ?\n. Ha yes, that works for sure, but i don't want to specify a group everywhere.\nAs describe here  https://api-platform.com/docs/core/operations#subresources : \n\nYou may want custom groups on subresources. Because a subresource is nothing more than a collection operation, you can set normalization_context or denormalization_context on that operation. To do so, you need to override collectionOperations. Based on the above operation, because we retrieve an answer, we need to alter it\u2019s configuration:\n\n```php\n<?php\n// src/AppBundle/Entity/Answer.php\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\n/*\n * @ApiResource(collectionOperations={\"api_questions_answer_get_subresource\"={\"method\"=\"GET\", \"normalization_context\"={\"groups\"={\"foobar\"}}}})\n /\nclass Answer\n{\n    // ...\n}\n```\nBut it doesn't seems to work, or i'm doing something bad ! (but have no errors). Great it works, thank you !\nHere was the solution : \nin Department Entity (and not House, this was my mistake) : \nphp\n/**\n * Department\n *\n * @ApiResource(\n *     itemOperations={\n *         \"get\"={\"method\"=\"GET\"},\n *         \"put\"={\"method\"=\"PUT\", \"access_control\"=\"is_granted('ROLE_ADMIN')\"},\n *         \"delete\"={\"method\"=\"DELETE\", \"access_control\"=\"is_granted('ROLE_ADMIN')\"},\n *         \"api_houses_departments_get_subresource\"={\"method\"=\"GET\", \"normalization_context\"={\"groups\"={\"list\"}}}\n *     },\n *     attributes={\"jsonld_embed_context\"=true}\n * )\n * @ORM\\Table(name=\"department\")\n * @ORM\\Entity(repositoryClass=\"XXX\\FrontBundle\\Repository\\DepartmentRepository\")\n */\nclass Department\n{\nImportant thing is : \n\"api_houses_departments_get_subresource\"={\"method\"=\"GET\", \"normalization_context\"={\"groups\"={\"list\"}}}\n. NB : I think i've done a mistake, and leave \nattributes={\n *          \"normalization_context\"={\"groups\"={\"list\"}}\n *     }\non House ApiResource.\nWith out this, doesn't work as except :/ I may use groups everywhere, but it was not what I was looking for.. Yes, I understood that I don't need Subresource, it's ok for this.\nBut still can't have : \njson\n{\n    \"@context\": \"/app_dev.php/contexts/House\",\n    \"@id\": \"/app_dev.php/houses/437\",\n    \"@type\": \"House\",\n    \"id\": 437,\n    \"name\": \"House name\",\n    \"departments\": [\n        {\n            \"@id\": \"/app_dev.php/departments/72\",\n            \"id\": 72,\n            \"name\": \"Department name\"\n        }, \n        ...\n    ]\n}\nwithout using : \n* attributes={\n *          \"normalization_context\"={\"groups\"={\"list\"}}\n *     }\non the House side.\nI don't know if it's possible without using groups on House. My hope was to have all House(s) informations(without using groups),  and having department informations in the same response. Possible ?. I have a quiete large project to manage, and lots of different case where I need to display or not some informations. So I already will have lots of groups. This will be one more...\nI'll deal with it :). Same problem here with a custom operation on itemOperations.\n. ",
    "toby-griffiths": "@julienpillias Did you manage to resolve this?\nIf you're still having problems with this, or for anyone else coming across this, you will need to add the serialisation group to the fields in the resource you want embedded\u2026 e.g. Add @Groups({\"list\"}) to at least 1 field in the resource to be embedded (Department) before it will embed the resource.\nIn this example, you would add @Groups({\"list\"}) to the $id and $name properties of the Department resource.. I've actually worked this out now.  For anyone else finding this, you need to add the swagger_context to your operation config\u2026\n* @ApiResource(\n *     ...\n *     itemOperations={\n *         \"me\"={\n *             \"method\"=\"GET\",\n *             \"route_name\"=\"...\",\n *             \"swagger_context\"={\"parameters\"={}}\n *         },\n *     },\n *     ...\n * ). I'm not sure what's changed, but I'm not seeing a hydra:view object in my single page responses, although if there's only 1 page it excludes the page=1 part on the URL (as might be expected), so I can work around this.. Actually, I'm not sure why this has changed, but it's now missing from my collection response again, so any advice on how to add this back would be appreciated.. I see your point @dunglas .  I'll work around this by using the request URL if the element is not included.\nThank you.. I can't use the existing DateTimeNormalizer, as this exports the data as a full date string, and I'm after exporting is as just hours & minutes, however your post has given me the thought of overriding the Doctrine 'time' (or 'time_immutable') Type and having it return a TimeImmutable object that can then be uniquely normalized/denormalized.. @soyuka Thanks for the advice.  It's much appreciated.. @soyuka thanks for the pointer.\nIf I wanted to return a apiSubResource URL for the related collection, would I do that in a custom serialize, or somewhere else?. Thank you.. Thanks for the advice @soyuka.. @z31fbras You'll need to add it as a custom item//collection route (rather than a subresource route).  That way I think that the Swagger docs are handled automatically for you.\nI think it's work mentioning, depending on the version of API Platform you're using, the use of subresource and item/collection config annotations can be a little confusing, as it appears to take some info for sub-resource GET requests from the subresource config, and some from the collection/item config when using the @ApiSubresource annotation.. @arnedesmedt / @bastien-wink,\nI had to manually define the fields using the \"swagger_context\" attribute of the endpoint definition (although that was just to display the field. I've not tested it's usable in the docs pages). See the Swagger docs for how to define the properties and the request body.. Is there an easy way to do that?. ",
    "elboletaire": "@DariuszLuber were you finally able to do this? I'm really new to api-platform and I'm really having troubles with this.\nI know how to create custom filters to filter resources, but I can't find a thing about filtering the nested ones. I've been trying things blindly, like setting the filters in the nested entity instead than in the parent one (and all the possible combinations...) with no luck, so any help in this would be much appreciated.. ",
    "Atala": "Here's the POST request : \njson\n{\n  \"restaurant\": \"/api/restaurants/1\",\n  \"orderedItem\": [\n    {\n      \"quantity\": 1,\n      \"menuItem\": \"/api/menu_items/2\",\n      \"modifiers\": [\n        {\n          \"name\": \"Clafoutis au sucre glace\",\n          \"description\": null,\n          \"modifier\": \"/api/menu_item_modifiers/1\"\n        }\n      ]\n    }\n  ],\n  \"delivery\": {\n    \"date\": null,\n    \"deliveryAddress\": \"/api/addresses/198\"\n  }\n}\nThe response is : \njson\n{\n  \"@context\": \"\\\\/api\\\\/contexts\\\\/Order\",\n  \"@id\": \"\\\\/api\\\\/orders\\\\/41\",\n  \"@type\": \"http:\\\\/\\\\/schema.org\\\\/Order\",\n  \"customer\": \"\\\\/api\\\\/api_users\\\\/1\",\n  \"restaurant\": {\n    \"@id\": \"\\\\/api\\\\/restaurants\\\\/1\",\n    \"@type\": \"http:\\\\/\\\\/schema.org\\\\/Restaurant\",\n    \"name\": \"La cagette noire rigolote\",\n    \"availabilities\": [\n    ..\n    ]\n  },\n  \"orderedItem\": [\n    {\n      \"@id\": \"\\\\/api\\\\/order_items\\\\/50\",\n      \"@type\": \"http:\\\\/\\\\/schema.org\\\\/OrderItem\",\n      \"menuItem\": \"\\\\/api\\\\/menu_items\\\\/2\",\n      \"quantity\": 1,\n      \"modifiers\": [\n        {\n          \"@id\": \"\\\\/api\\\\/order_item_modifiers\\\\/41\",\n          \"@type\": \"OrderItemModifier\",\n          \"name\": \"Clafoutis au sucre glace\",\n          \"description\": null,\n          \"modifier\": \"\\\\/api\\\\/menu_item_modifiers\\\\/1\"\n        }\n      ],\n      \"name\": \"Tomates fra\u00eeches \u00e0 l\\\\u0027huile d\\\\u0027olive\",\n      \"price\": 8.99\n    }\n  ],\n  \"status\": \"CREATED\",\n  \"delivery\": {\n    \"@id\": \"\\\\/api\\\\/deliveries\\\\/40\",\n    \"@type\": \"http:\\\\/\\\\/schema.org\\\\/ParcelDelivery\",\n    \"originAddress\": {\n      \"@id\": \"\\\\/api\\\\/addresses\\\\/51\",\n      \"@type\": \"http:\\\\/\\\\/schema.org\\\\/Place\",\n      \"geo\": {\n        \"latitude\": 48.868654,\n        \"longitude\": 2.372635\n      },\n      \"streetAddress\": \"1 Rue du Chevet, 75011 Paris, France\",\n      \"name\": null\n    },\n    \"deliveryAddress\": {\n      \"@id\": \"\\\\/api\\\\/addresses\\\\/198\",\n      \"@type\": \"http:\\\\/\\\\/schema.org\\\\/Place\",\n      \"geo\": {\n        \"latitude\": 48.8752225,\n        \"longitude\": 2.3763712\n      },\n      \"streetAddress\": \"Rue de l\\\\u0027Atlas, Paris, France\",\n      \"name\": null\n    },\n    \"courier\": null,\n    \"status\": \"WAITING\",\n    \"date\": \"2017-10-02T10:32:05+02:00\"\n  },\n  \"total\": 8.99\n}\nBut checking the DB : \n```\ncoopcycle=# select * from order_item_modifier;\n id | order_item_id | modifier_id |           name           | description\n----+---------------+-------------+--------------------------+-------------\n 41 |               |           1 | Clafoutis au sucre glace |. I am querying the API from JS, maybe I can dump something here ?\nHopefully it is not linked to IDENTITY as we are forced to use it with PostGres (ref). What puzzled me is that it is working fine with the relation between Order and OrderItem. That's why I suspect the nesting to be the root cause here. I could try to create OrderItem directly to see if nesting is in cause.\nHere's generated SQL:\n[2017-10-02 10:32:06] doctrine.DEBUG: INSERT INTO order_ (status, created_at, updated_at, customer_id, restaurant_id) VALUES (?, ?, ?, ?, ?) {\"1\":\"CREATED\",\"2\":\"2017-10-02 10:32:06\",\"3\":\"2017-10-02 10:32:06\",\"4\":1,\"5\":1} []\n[2017-10-02 10:32:06] doctrine.DEBUG: INSERT INTO order_item (quantity, name, price, menu_item_id, order_id) VALUES (?, ?, ?, ?, ?) {\"1\":1,\"2\":\"Tomates fra\u00eeches \u00e0 l'huile [...]\",\"3\":8.99,\"4\":2,\"5\":41} []\n[2017-10-02 10:32:06] doctrine.DEBUG: INSERT INTO order_item_modifier (name, description, order_item_id, modifier_id) VALUES (?, ?, ?, ?) {\"1\":\"Clafoutis au sucre glace\",\"2\":null,\"3\":null,\"4\":1} []\nCould it be caused by Doctrine Cache issues?\n. Everything looks fine in the profiler.\nI have a workaround for now, maybe let this issue opened and come back on it later on?\nThanks for helping out :). Hey @Simperfit , I think it will be easier for you if I spin up a simpler Symfony project (and so we could see if it's reproductible). I will do that and come back to you. . No I don't think so.\nSorry I didn't have time to reproduce it :/\nThanks for your work on ApiPlatform!. ",
    "edwardselby": "Did this ever get looked at?. Bump. ",
    "mysiar": "Create action to do the job instead what you described above\nCheck this out \nhttps://github.com/mysiar/api-platform-demo-app/blob/master/src/Mysiar/FileBundle/Action/ReadItem.php. ",
    "tmbdrogba": "+1. ",
    "maximecrtmc": "With _api_item_operation_name I have a Not Found error\nI bet this is because for item operation, the ID is required. But I don't have the ID here\nI tried to rename the route to /usersreload to not cause issue with /users/{id} but this is not working too. ",
    "Nightbr": "Hey, same problem here with annotation.\n```php\n/\n * Publication\n \n * @ApiResource(attributes={\n *     \"denormalization_context\"={\"groups\"={\"in\"}},\n *     \"normalization_context\"={\"groups\"={\"out\"}},\n *     \"order\"={\"createdAt\": \"DESC\"}\n * },\n * itemOperations={\n *  \"get\"={\"method\"=\"GET\", \"path\"=\"/publications/{id}\"},\n *  \"put\"={\"method\"=\"PUT\", \"path\"=\"/publications/{id}\", \"access_control\"=\"object.getAuthor() == user\"},\n *  \"delete\"={\"method\"=\"DELETE\", \"path\"=\"/publications/{id}\", \"access_control\"=\"object.getAuthor() == user\"},\n \n *  },\n *  collectionOperations={\n *      \"get\"={\"method\"=\"GET\", \"route_name\"=\"publications_get_all\", \"normalization_context\"={\"groups\"={\"publications_get_all_out\"}}},\n *      \"post\"={\"method\"=\"POST\", \"access_control\"=\"object.getAuthor() == user\"},\n *      \"api_publications_likes_get_subresource\"={\"method\"=\"GET\", \"normalization_context\"={\"groups\"={\"publications_get_likes_out\"}}}\n *  })\n * @ORM\\Table(name=\"publication\")\n * @ORM\\Entity(repositoryClass=\"PublicationBundle\\Repository\\PublicationRepository\")\n */\nclass Publication\n{\n/**\n * @var int\n *\n * @ORM\\Column(name=\"id\", type=\"integer\")\n * @ORM\\Id\n * @ORM\\GeneratedValue(strategy=\"AUTO\")\n * @Groups({\"out\", \"publications_get_all_out\"})\n */\nprivate $id;\n\n[...]\n/**\n * @var Comment[]\n *\n * @ORM\\OneToMany(targetEntity=\"PublicationBundle\\Entity\\Like\", mappedBy=\"publication\",  cascade={\"remove\"})\n * @ApiSubresource()\n */\nprivate $likes;\n\n``\nAnd in thebin/console debug:router | grep api`:\nshell\n  api_publications_post_collection                                     POST       ANY      ANY    /api/publications.{_format}                                     \n  api_publications_api_publications_likes_get_subresource_collection   GET        ANY      ANY    /api/publications.{_format}                                     \n  api_publications_get_item                                            GET        ANY      ANY    /api/publications/{id}                                          \n  api_publications_put_item                                            PUT        ANY      ANY    /api/publications/{id}                                          \n  api_publications_delete_item                                         DELETE     ANY      ANY    /api/publications/{id}                                          \n  api_publications_comments_get_subresource                            GET        ANY      ANY    /api/publications/{id}/comments.{_format}                       \n  api_publications_likes_get_subresource                               GET        ANY      ANY    /api/publications/{id}/likes.{_format}\nit's not overriding the subresources configuration but create a new route.\nDocumentation: subresources\nAny idea?. Same thing if I put the annotation in my child Entity (Like):\n```php\n/\n * Like\n \n * @ApiResource(attributes={\n *     \"denormalization_context\"={\"groups\"={\"in\"}},\n *     \"normalization_context\"={\"groups\"={\"out\"}}\n * },\n * collectionOperations={\n *      \"api_publications_likes_get_subresource\"={\"method\"=\"GET\", \"normalization_context\"={\"groups\"={\"publications_get_likes_out\"}}}\n * })\n * @ORM\\Table(name=\"like\")\n * @ORM\\Entity\n /\nclass Like\n{\n    /\n     * @var integer\n     \n     * @ORM\\Column(name=\"id\", type=\"integer\", nullable=false)\n     * @ORM\\Id\n     * @ORM\\GeneratedValue(strategy=\"IDENTITY\")\n     * @Groups({\"out\", \"publications_get_likes_out\"})\n     /\n    private $id;\n/**\n * @var Publication $publication\n *\n * @Assert\\NotNull()\n * @ORM\\ManyToOne(targetEntity=\"PublicationBundle\\Entity\\Publication\", inversedBy=\"likes\")\n * @ORM\\JoinColumn(name=\"publication\", referencedColumnName=\"id\")\n * @Groups({\"in\", \"out\"})\n */\nprivate $publication;\n\n[...]\n``\nAnd in thebin/console debug:router | grep api`:\nshell\n  api_publications_post_collection                              POST       ANY      ANY    /api/publications.{_format}                                     \n  api_publications_get_item                                     GET        ANY      ANY    /api/publications/{id}                                          \n  api_publications_put_item                                     PUT        ANY      ANY    /api/publications/{id}                                          \n  api_publications_delete_item                                  DELETE     ANY      ANY    /api/publications/{id}                                          \n  api_publications_comments_get_subresource                     GET        ANY      ANY    /api/publications/{id}/comments.{_format}                       \n  api_publications_likes_get_subresource                        GET        ANY      ANY    /api/publications/{id}/likes.{_format}                          \n  api_comments_post_collection                                  POST       ANY      ANY    /api/comments.{_format}                                         \n  api_comments_get_item                                         GET        ANY      ANY    /api/comments/{id}.{_format}                                    \n  api_comments_put_item                                         PUT        ANY      ANY    /api/comments/{id}.{_format}                                    \n  api_comments_delete_item                                      DELETE     ANY      ANY    /api/comments/{id}.{_format}                                    \n  api_likes_api_publications_likes_get_subresource_collection   GET        ANY      ANY    /api/likes.{_format}                                            \n  api_likes_get_item                                            GET        ANY      ANY    /api/likes/{id}.{_format}                                       \n  api_likes_put_item                                            PUT        ANY      ANY    /api/likes/{id}.{_format}                                       \n  api_likes_delete_item                                         DELETE     ANY      ANY    /api/likes/{id}.{_format}\n. Seems to be related to this issue: https://github.com/api-platform/api-platform/issues/423. oh yeah, I just look at the merged PR and it's awesome and will fix the issue for sure \n*  subresourceOperations={\n *      \"api_publications_likes_get_subresource\"={\"method\"=\"GET\", \"normalization_context\"={\"groups\"={\"foobar\"}}}\n *  })\nAny timeline to have this into a new release?. With my dev team, we use vagrant to create isolated devenv but provisionned by docker. With this, you can use the Api Platform docker env.\nBut if you want a Vagrant (vm) with raw php, nginx, ... I think you can create a project for this.. ",
    "Chrysweel": "Maybe you need execute in mysql:\n\nSET global sql_mode='STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION';\n\nI had this error too because \"this is incompatible with sql_mode=only_full_group_by\" I think that it actived by default from mysql 5.7.5. I think it's a good idea to include in the Api Platform documentation how to change to use mysql ! . I can do a PR to add the documentation of how to change Postgree by Mysql, but I do not manage to achieve it.\nSome help?. Thanks for to reply @soyuka .\nI have \n```\n<?php\nnamespace App\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Component\\Validator\\Constraints as Assert;\nuse Doctrine\\Common\\Collections\\ArrayCollection;\nuse Symfony\\Bridge\\Doctrine\\Validator\\Constraints\\UniqueEntity;\n/\n * @ApiResource\n * @ORM\\Entity\n * @UniqueEntity(\"name\")\n */\nclass Enterprise\n{\n    /\n     * @var int The entity Id\n     \n     * @ORM\\Id\n     * @ORM\\GeneratedValue\n     * @ORM\\Column(type=\"integer\")\n     /\n    private $id;\n/**\n * @var string\n * @ORM\\Column\n * @Assert\\NotBlank\n */\npublic $name = '';\n\n/**\n * @var string\n * @ORM\\Column(type=\"string\", nullable=true)\n * @ORM\\Column\n */\npublic $direction = '';\n\n/**\n * Many Entreprise have Many Techonologies\n * @ORM\\ManyToMany(targetEntity=\"Technology\", inversedBy=\"enterprise\")\n * @ORM\\JoinTable(name=\"enterprise_technology\")\n */\npublic $technologies;\n\npublic function __construct() {\n    $this->technologies = new ArrayCollection();\n}\n\n\npublic function getTechnologies()\n{\n    return $this->technologies;\n}\n\npublic function addTechnology(Technology $technology)\n{\n    if (!$this->getTechnologies()->contains($technology)) {\n        $this->getTechnologies()->add($technology);\n    }\n    return $this;\n}\n\n```\nFrom documentation of api I see in call POST\n{\n  \"name\": \"google\",\n  \"direction\": \"eeuu\",\n  \"technologies\": [\n    \"my-technology\"\n  ]\n}\nAnd I get the following error:\n\n\"hydra:description\": \"Expected IRI or nested document for attribute \\\"technologies\\\", \\\"string\\\" given.\",\n\nAny idea ? Do I have something wrong ?\nThanks in advance.. I have the same problem. And I have not idea. I opened a question in stack overflow without respond. \nhttps://stackoverflow.com/questions/52806092/embedding-relations-with-api-platform\nIf somebody can help us, I can to create a pull request to documentation . ",
    "Julien-Marcou": "I made a basic representation of the model to help you understand the problem :)\nWorking :\n\nNot working (i.e. StringQuestion and StringAnswer serialization and deserialization contexts are not used at all) :\n\n. Yep, should rewrite my issue \ud83d\ude16\nI'm using Single Table inheritance :\n/**\n * Answer\n *\n * @ORM\\Table(name=\"answer\")\n * @ORM\\Entity(repositoryClass=\"AppBundle\\Repository\\AnswerRepository\")\n * @ORM\\InheritanceType(\"SINGLE_TABLE\")\n * @ORM\\DiscriminatorColumn(name=\"type\", type=\"string\")\n * @ORM\\DiscriminatorMap({\"string\" = \"StringAnswer\", \"numeric\" = \"NumericAnwser\", \"string_attachment\" = \"StringWithAttachmentAnwser\"})\n */\nI agree that inheritance may be a bad idea (and I'm aware that it could involves adding new columns to the base table which could lead to big crappy table).\nIt looks like it's not the most adequate solution in my example, but it is a simplification of the real model I have.\nIn my case StringWithAttachmentAnswer define a new mandatory OneToOne relation to a Document entity (so a document must be attached to that kind of answer), this is why it's quite handy for my real model to have these kind of inheritances.. After a long headache, I finally found the solution, I simply have to use two different normalization contexts, one for StringWithAttachmentQuestion and one for StringQuestion and it solves the problem.\nHowever, I've tried that before and I thought it was not working because of API Platform not rendering the right \"Exemple Value\" nor the right \"Model\".\nSo this issue can be close, I'll open a new one (#445) with a complete Gist to explain this bug.\n. Oh, thanks, that's it !. ",
    "botjaeger": "I think I fixed it by removing the value for varnish_urls in parameters.yml. @dunglas yes\n@meyerbaptiste uhm, the link is not available, i mean the solution \nhere https://github.com/api-platform/api-platform/blob/master/app/config/config.yml#L85-L92. I fixed this by doing this.\npublic function __construct(ManagerRegistry $manager, iterable $itemExtensions = []). ",
    "leogout": "The user should be (and is) authenticated when issuing write requests.\nOkay, I'll do without it, thanks !. Yeah you are right, that was a bad idea. At least I'll know it's not possible for non critical resources as well !. ",
    "deantomasevic": "Jap, master Branch.. No result.\n````\ndean at Deans-MacBook-Pro in /api-platform on master\n$ grep -r DATABASE_HOST api\ndean at Deans-MacBook-Pro in /api-platform on master\n````\nMy Docker-Machine is running fine:\n$ docker-machine ls\nNAME           ACTIVE   DRIVER       STATE     URL                         SWARM   DOCKER        ERRORS\napi-platform   -        virtualbox   Running   tcp://192.168.99.101:2376           v17.10.0-ce\nLet's start all container's:\n````\n$ docker-compose ps\n          Name                        Command              State     Ports\n\napiplatform_admin_1         /bin/sh -c yarn start         Exit 137      \napiplatform_api_1           nginx -g daemon off;          Exit 0        \napiplatform_cache-proxy_1   docker-app-start              Exit 2        \napiplatform_client_1        /bin/sh -c yarn start         Exit 137      \napiplatform_db_1            docker-entrypoint.sh mysqld   Exit 1        \napiplatform_h2-proxy_1      nginx -g daemon off;          Exit 1        \napiplatform_php_1           docker-entrypoint php-fpm     Exit 1\n````\n````\ndean at Deans-MacBook-Pro in /api-platform on master\n$ docker-compose logs -f\nAttaching to apiplatform_h2-proxy_1, apiplatform_cache-proxy_1, apiplatform_api_1, apiplatform_php_1, apiplatform_db_1, apiplatform_client_1, apiplatform_admin_1\ncache-proxy_1  | + varnishd -a :80 -f /etc/varnish/default.vcl -s malloc,256m\ncache-proxy_1  | Error:\ncache-proxy_1  | Message from VCC-compiler:\ncache-proxy_1  | DNS lookup(php): Name does not resolve\ncache-proxy_1  | ('/etc/varnish/default.vcl' Line 21 Pos 3)\ncache-proxy_1  |   \"php\";\ncache-proxy_1  | --#####-\ncache-proxy_1  | \ncache-proxy_1  | Running VCC-compiler failed, exited with 2\ncache-proxy_1  | VCL compilation failed\nh2-proxy_1     | 2017/10/31 22:30:08 [emerg] 1#1: host not found in upstream \"cache-proxy\" in /etc/nginx/conf.d/default.conf:54\nh2-proxy_1     | nginx: [emerg] host not found in upstream \"cache-proxy\" in /etc/nginx/conf.d/default.conf:54\napiplatform_cache-proxy_1 exited with code 2\napiplatform_h2-proxy_1 exited with code 1\ndb_1           | 2017-10-31 22:18:05 0 [Note] mysqld (mysqld 10.3.2-MariaDB-10.3.2+maria~jessie) starting as process 1 ...\ndb_1           | 2017-10-31 22:18:06 0 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins\ndb_1           | 2017-10-31 22:18:06 0 [Note] InnoDB: Uses event mutexes\ndb_1           | 2017-10-31 22:18:06 0 [Note] InnoDB: Compressed tables use zlib 1.2.8\ndb_1           | 2017-10-31 22:18:06 0 [Note] InnoDB: Using Linux native AIO\ndb_1           | 2017-10-31 22:18:06 0 [Note] InnoDB: Number of pools: 1\ndb_1           | 2017-10-31 22:18:06 0 [Note] InnoDB: Using SSE2 crc32 instructions\ndb_1           | 2017-10-31 22:18:06 0 [Note] InnoDB: Initializing buffer pool, total size = 256M, instances = 1, chunk size = 128M\ndb_1           | 2017-10-31 22:18:06 0 [Note] InnoDB: Completed initialization of buffer pool\ndb_1           | 2017-10-31 22:18:06 0 [Note] InnoDB: If the mysqld execution user is authorized, page cleaner thread priority can be changed. See the man page of setpriority().\ndb_1           | 2017-10-31 22:18:06 0 [ERROR] InnoDB: Upgrade after a crash is not supported. The redo log was created with MySQL 5.7.18.\ndb_1           | 2017-10-31 22:18:06 0 [ERROR] InnoDB: Plugin initialization aborted with error Generic error\nphp_1          | Loading composer repositories with package information\ndb_1           | 2017-10-31 22:18:07 0 [Note] InnoDB: Starting shutdown...\nclient_1       | yarn run v1.2.0\nclient_1       | $ react-scripts start\nclient_1       | Starting the development server...\nclient_1       | \nclient_1       | Compiled successfully!\nclient_1       | \nclient_1       | You can now view admin in the browser.\nphp_1          | Installing dependencies (including require-dev) from lock file\nphp_1          | Warning: The lock file is not up to date with the latest changes in composer.json. You may be getting outdated dependencies. Run update to update them.\nphp_1          | Nothing to install or update\napiplatform_api_1 exited with code 0\nclient_1       | \ndb_1           | 2017-10-31 22:18:07 0 [ERROR] Plugin 'InnoDB' init function returned error.\nphp_1          | Generating autoload files\nclient_1       |   Local:            http://localhost:3000/\ndb_1           | 2017-10-31 22:18:07 0 [ERROR] Plugin 'InnoDB' registration as a STORAGE ENGINE failed.\nphp_1          | Executing script cache:clear [KO]\nadmin_1        | yarn run v1.2.0\nclient_1       |   On Your Network:  http://172.19.0.4:3000/\ndb_1           | 2017-10-31 22:18:07 0 [Note] Plugin 'FEEDBACK' is disabled.\nphp_1          |  [KO]\nadmin_1        | $ react-scripts start\nclient_1       | \ndb_1           | 2017-10-31 22:18:07 0 [ERROR] Could not open mysql.plugin table. Some plugins may be not loaded\nphp_1          | Script cache:clear returned with error code 1\nadmin_1        | Starting the development server...\nclient_1       | Note that the development build is not optimized.\ndb_1           | 2017-10-31 22:18:07 0 [ERROR] Unknown/unsupported storage engine: InnoDB\nphp_1          | !!\nadmin_1        | \nclient_1       | To create a production build, use yarn build.\ndb_1           | 2017-10-31 22:18:07 0 [ERROR] Aborting\nphp_1          | !!\nadmin_1        | Compiled successfully!\nclient_1       | \nclient_1       | yarn run v1.2.0\nclient_1       | $ react-scripts start\ndb_1           | \ndb_1           | 2017-10-31 22:29:50 0 [Note] mysqld (mysqld 10.3.2-MariaDB-10.3.2+maria~jessie) starting as process 1 ...\ndb_1           | 2017-10-31 22:29:50 0 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins\ndb_1           | 2017-10-31 22:29:50 0 [Note] InnoDB: Uses event mutexes\ndb_1           | 2017-10-31 22:29:50 0 [Note] InnoDB: Compressed tables use zlib 1.2.8\ndb_1           | 2017-10-31 22:29:50 0 [Note] InnoDB: Using Linux native AIO\ndb_1           | 2017-10-31 22:29:50 0 [Note] InnoDB: Number of pools: 1\ndb_1           | 2017-10-31 22:29:50 0 [Note] InnoDB: Using SSE2 crc32 instructions\ndb_1           | 2017-10-31 22:29:50 0 [Note] InnoDB: Initializing buffer pool, total size = 256M, instances = 1, chunk size = 128M\ndb_1           | 2017-10-31 22:29:50 0 [Note] InnoDB: Completed initialization of buffer pool\nphp_1          | !!                                                                          \nphp_1          | !!\nphp_1          | !!\nphp_1          | !!    [Symfony\\Component\\DependencyInjection\\Exception\\EnvNotFoundException]\nphp_1          | !!\nphp_1          | !!\nphp_1          | !!    Environment variable not found: \"DATABASE_HOST\".                      \nphp_1          | !!\nadmin_1        | \nclient_1       | Starting the development server...\nclient_1       | \nclient_1       | Compiled successfully!\nclient_1       | \nclient_1       | You can now view admin in the browser.\nclient_1       | \nclient_1       |   Local:            http://localhost:3000/\nclient_1       |   On Your Network:  http://172.19.0.2:3000/\nclient_1       | \nclient_1       | Note that the development build is not optimized.\nclient_1       | To create a production build, use yarn build.\nclient_1       | \ndb_1           | 2017-10-31 22:29:50 0 [Note] InnoDB: If the mysqld execution user is authorized, page cleaner thread priority can be changed. See the man page of setpriority().\ndb_1           | 2017-10-31 22:29:50 0 [ERROR] InnoDB: Upgrade after a crash is not supported. The redo log was created with MySQL 5.7.18.\ndb_1           | 2017-10-31 22:29:50 0 [ERROR] InnoDB: Plugin initialization aborted with error Generic error\ndb_1           | 2017-10-31 22:29:51 0 [Note] InnoDB: Starting shutdown...\ndb_1           | 2017-10-31 22:29:51 0 [ERROR] Plugin 'InnoDB' init function returned error.\ndb_1           | 2017-10-31 22:29:51 0 [ERROR] Plugin 'InnoDB' registration as a STORAGE ENGINE failed.\ndb_1           | 2017-10-31 22:29:51 0 [Note] Plugin 'FEEDBACK' is disabled.\ndb_1           | 2017-10-31 22:29:51 0 [ERROR] Could not open mysql.plugin table. Some plugins may be not loaded\ndb_1           | 2017-10-31 22:29:51 0 [ERROR] Unknown/unsupported storage engine: InnoDB\ndb_1           | 2017-10-31 22:29:51 0 [ERROR] Aborting\ndb_1           | \nphp_1          | !!\nphp_1          | !!                                                                          \nphp_1          | !!\nadmin_1        | You can now view admin in the browser.\nadmin_1        | \nadmin_1        |   Local:            http://localhost:3000/\nadmin_1        |   On Your Network:  http://172.19.0.6:3000/\nadmin_1        | \nadmin_1        | Note that the development build is not optimized.\nadmin_1        | To create a production build, use yarn build.\nadmin_1        | \nadmin_1        | yarn run v1.2.0\nadmin_1        | $ react-scripts start\nadmin_1        | Starting the development server...\nadmin_1        | \nadmin_1        | Compiled successfully!\nadmin_1        | \nadmin_1        | You can now view admin in the browser.\nadmin_1        | \nadmin_1        |   Local:            http://localhost:3000/\nadmin_1        |   On Your Network:  http://172.19.0.3:3000/\nadmin_1        | \nadmin_1        | Note that the development build is not optimized.\nadmin_1        | To create a production build, use yarn build.\nadmin_1        | \nphp_1          | !!\nphp_1          | !!\nphp_1          | !!\nphp_1          | !!\napiplatform_db_1 exited with code 1\napiplatform_php_1 exited with code 1\napiplatform_admin_1 exited with code 137\napiplatform_client_1 exited with code 137\ndean at Deans-MacBook-Pro in /api-platform on master\n````\nSo okay, i try:\n````\ndean at Deans-MacBook-Pro in /api-platform on master\n$ docker-compose up -d\nRecreating apiplatform_client_1 ... \nRecreating apiplatform_client_1\nRecreating apiplatform_admin_1 ... \nRecreating apiplatform_admin_1\nRecreating apiplatform_db_1 ... \nRecreating apiplatform_db_1 ... done\nRecreating apiplatform_php_1 ... \nRecreating apiplatform_php_1 ... done\nRecreating apiplatform_api_1 ... \nRecreating apiplatform_api_1 ... done\nRecreating apiplatform_cache-proxy_1 ... \nRecreating apiplatform_cache-proxy_1 ... done\nRecreating apiplatform_h2-proxy_1 ... \nRecreating apiplatform_h2-proxy_1 ... done\ndean at Deans-MacBook-Pro in /api-platform on master [!]\n$ docker-compose ps\n          Name                         Command              State                                                  Ports                                               \n\napiplatform_admin_1         /bin/sh -c yarn start           Up       0.0.0.0:81->3000/tcp                                                                            \napiplatform_api_1           nginx -g daemon off;            Up       0.0.0.0:8080->80/tcp                                                                            \napiplatform_cache-proxy_1   docker-app-start                Up       0.0.0.0:8081->80/tcp                                                                            \napiplatform_client_1        /bin/sh -c yarn start           Up       0.0.0.0:80->3000/tcp                                                                            \napiplatform_db_1            docker-entrypoint.sh postgres   Exit 1                                                                                                   \napiplatform_h2-proxy_1      nginx -g daemon off;            Up       0.0.0.0:443->443/tcp, 0.0.0.0:444->444/tcp, 80/tcp, 0.0.0.0:8443->8443/tcp, 0.0.0.0:8444->8444/tcp\napiplatform_php_1           docker-entrypoint php-fpm       Up       9000/tcp                                                                                          \ndean at Deans-MacBook-Pro in /api-platform on master [!]\n$ git s\n M api/composer.json\ndean at Deans-MacBook-Pro in /api-platform on master [!]\n$ git diff\ndiff --git a/api/composer.json b/api/composer.json\nindex f621c34..4cdd215 100644\n--- a/api/composer.json\n+++ b/api/composer.json\n@@ -46,7 +46,7 @@\n     },\n     \"extra\": {\n         \"symfony\": {\n-            \"id\": \"\",\n+            \"id\": \"01BXVQP3JW6CJMXW7KT99Z5NP3\",\n             \"allow-contrib\": false\n         }\n     }\ndean at Deans-MacBook-Pro in /api-platform on master [!]\n````\nI dont understand the git diff after i run the command docker-compose up -d.\nAnd now i can see another error:\ndean at Deans-MacBook-Pro in /api-platform on master [!]\n$ docker-compose logs -f\nAttaching to apiplatform_h2-proxy_1, apiplatform_cache-proxy_1, apiplatform_api_1, apiplatform_php_1, apiplatform_db_1, apiplatform_admin_1, apiplatform_client_1\ncache-proxy_1  | + varnishd -a :80 -f /etc/varnish/default.vcl -s malloc,256m\ncache-proxy_1  | + varnishlog\ncache-proxy_1  | Can't open log - retrying for 5 seconds\ncache-proxy_1  | Log opened\nphp_1          | Loading composer repositories with package information\nphp_1          | Installing dependencies (including require-dev) from lock file\nphp_1          | Warning: The lock file is not up to date with the latest changes in composer.json. You may be getting outdated dependencies. Run update to update them.\nphp_1          | Nothing to install or update\nphp_1          | Generating autoload files\nphp_1          | Executing script cache:clear [OK]\nphp_1          | Executing script assets:install [OK]\nphp_1          | \nphp_1          | \nphp_1          |  Installing assets as hard copies.\nphp_1          | \nphp_1          |  --- ------------------- ---------------- \nphp_1          |       Bundle              Method / Error  \nphp_1          |  --- ------------------- ---------------- \nphp_1          |   \u2714   ApiPlatformBundle   copy            \nphp_1          |  --- ------------------- ---------------- \nphp_1          | \nphp_1          |  ! [NOTE] Some assets were installed via copy. If you make changes to these     \nphp_1          |  !        assets you have to run this command again.                            \nphp_1          | \nphp_1          |  [OK] All assets were successfully installed.                                   \nphp_1          | \nphp_1          | \nphp_1          |                                                                                \nphp_1          |   [Doctrine\\DBAL\\Exception\\ConnectionException]                                \nphp_1          |   An exception occurred in driver: SQLSTATE[08006] [7] could not translate ho  \nphp_1          |   st name \"db\" to address: Name does not resolve                               \nphp_1          |                                                                                \nphp_1          | \nphp_1          |                                                                                \nphp_1          |   [Doctrine\\DBAL\\Driver\\PDOException]                                          \nphp_1          |   SQLSTATE[08006] [7] could not translate host name \"db\" to address: Name doe  \nphp_1          |   s not resolve                                                                \nphp_1          |                                                                                \ndb_1           | The files belonging to this database system will be owned by user \"postgres\".\nphp_1          | \ndb_1           | This user must also own the server process.\nphp_1          |                                                                                \ndb_1           | \nphp_1          |   [PDOException]                                                               \ndb_1           | The database cluster will be initialized with locale \"en_US.utf8\".\nphp_1          |   SQLSTATE[08006] [7] could not translate host name \"db\" to address: Name doe  \ndb_1           | The default database encoding has accordingly been set to \"UTF8\".\nphp_1          |   s not resolve                                                                \ndb_1           | The default text search configuration will be set to \"english\".\nphp_1          |                                                                                \ndb_1           | \nphp_1          | \ndb_1           | Data page checksums are disabled.\ndb_1           | \nphp_1          | doctrine:schema:update [--complete] [--dump-sql] [-f|--force] [--em [EM]] [-h|--help] [-q|--quiet] [-v|vv|vvv|--verbose] [-V|--version] [--ansi] [--no-ansi] [-n|--no-interaction] [-e|--env ENV] [--no-debug] [--] <command>\ndb_1           | initdb: directory \"/var/lib/postgresql/data\" exists but is not empty\nphp_1          | \ndb_1           | If you want to create a new database system, either remove or empty\ndb_1           | the directory \"/var/lib/postgresql/data\" or run initdb\ndb_1           | with an argument other than \"/var/lib/postgresql/data\".\nadmin_1        | yarn run v1.2.0\nclient_1       | yarn run v1.2.0\nclient_1       | $ react-scripts start\nclient_1       | Starting the development server...\nclient_1       | \nclient_1       | Compiled successfully!\nclient_1       | \nclient_1       | You can now view admin in the browser.\nclient_1       | \nclient_1       |   Local:            http://localhost:3000/\nclient_1       |   On Your Network:  http://172.19.0.3:3000/\nclient_1       | \nclient_1       | Note that the development build is not optimized.\nadmin_1        | $ react-scripts start\nclient_1       | To create a production build, use yarn build.\nadmin_1        | Starting the development server...\nclient_1       | \nadmin_1        | \nadmin_1        | Compiled successfully!\nadmin_1        | \nadmin_1        | You can now view admin in the browser.\nadmin_1        | \nadmin_1        |   Local:            http://localhost:3000/\nadmin_1        |   On Your Network:  http://172.19.0.4:3000/\nadmin_1        | \nadmin_1        | Note that the development build is not optimized.\nadmin_1        | To create a production build, use yarn build.\nadmin_1        | \napiplatform_db_1 exited with code 1\napiplatform_php_1 exited with code 1. Hey @dunglas \nmaybe i found the error.\nThe reason could be docker-machine.\n$ docker-compose up\n...\nphp_1          | \nphp_1          |                                                                                \nphp_1          |   [Doctrine\\DBAL\\Exception\\ConnectionException]                                \nphp_1          |   An exception occurred in driver: SQLSTATE[08006] [7] could not connect to s  \nphp_1          |   erver: Connection refused                                                    \nphp_1          |    Is the server running on host \"192.168.99.101\" and accepting                \nphp_1          |    TCP/IP connections on port 5432?                                            \nphp_1          |                                                                                \nphp_1          | \nphp_1          |                                                                        \nphp_1          |   [Doctrine\\DBAL\\Driver\\PDOException]                                  \nphp_1          |   SQLSTATE[08006] [7] could not connect to server: Connection refused  \nphp_1          |    Is the server running on host \"192.168.99.101\" and accepting        \nphp_1          |    TCP/IP connections on port 5432?                                    \nphp_1          |                                                                        \nphp_1          | \nphp_1          |                                                                        \nphp_1          |   [PDOException]                                                       \nphp_1          |   SQLSTATE[08006] [7] could not connect to server: Connection refused  \nphp_1          |    Is the server running on host \"192.168.99.101\" and accepting        \nphp_1          |    TCP/IP connections on port 5432?                                    \nphp_1          |                                                                        \nphp_1          | \nphp_1          | doctrine:schema:update [--complete] [--dump-sql] [-f|--force] [--em [EM]] [-h|--help] [-q|--quiet] [-v|vv|vvv|--verbose] [-V|--version] [--ansi] [--no-ansi] [-n|--no-interaction] [-e|--env ENV] [--no-debug] [--] <command>\nphp_1          | \napiplatform_php_1 exited with code 1\nAnd i found this:\nhttp://www.mozmorris.com/2011/11/15/configure-postgresql-to-accept-tcpip-connections.html\nhttps://stackoverflow.com/questions/38466190/cant-connect-to-postgresql-on-port-5432\nSo i think, this error should be thrown for all mac-user that uses docker-machine.\nWhat do you think?. Hi @mvaljento, \nno sorry :/. Hi @dunglas \n\nCan you try that? What is your OS?\n\nMac OS (10.13.3)\nHere is my testresult:\ndean \u25b6 ~ \u25b6 Arbeit \u276f \u2026 \u276f php \u276f symfony \u276f api-platform-2.2.2 \u25b6 docker-compose pull\nPulling db (postgres:9.6-alpine)...\n9.6-alpine: Pulling from library/postgres\nDigest: sha256:7e5e82e43bd49bf311927f8bd13e5982938025d8a3dda6834beb0a0e1c6527a6\nStatus: Image is up to date for postgres:9.6-alpine\n dean \u25b6 ~ \u25b6 Arbeit \u276f \u2026 \u276f php \u276f symfony \u276f api-platform-2.2.2 \u25b6 docker-compose up --build --force-recreate\nCreating network \"apiplatform222_default\" with the default driver\nCreating volume \"apiplatform222_db-data\" with default driver\nBuilding admin\nStep 1/7 : FROM node:9.4-alpine\n ---> b5f94997f35f\nStep 2/7 : RUN mkdir -p /usr/src/admin\n ---> Using cache\n ---> adaf74035e82\nStep 3/7 : WORKDIR /usr/src/admin\n ---> Using cache\n ---> 8e0ffedbdbe4\nStep 4/7 : COPY package.json yarn.lock ./\n ---> Using cache\n ---> 78c1caf1a699\nStep 5/7 : RUN yarn install\n ---> Using cache\n ---> 45f657364ad0\nStep 6/7 : COPY . ./\n ---> eb281939cfc1\nStep 7/7 : CMD yarn start\n ---> Running in e834a40528b0\nRemoving intermediate container e834a40528b0\n ---> d0186567a94f\nSuccessfully built d0186567a94f\nSuccessfully tagged apiplatform222_admin:latest\nBuilding client\nStep 1/8 : FROM node:9.4-alpine\n ---> b5f94997f35f\nStep 2/8 : RUN mkdir -p /usr/src/client\n ---> Using cache\n ---> 420812e8fb7e\nStep 3/8 : WORKDIR /usr/src/client\n ---> Using cache\n ---> e46aadffa79a\nStep 4/8 : RUN yarn global add @api-platform/client-generator\n ---> Using cache\n ---> ae527dd71aa3\nStep 5/8 : COPY package.json yarn.lock ./\n ---> Using cache\n ---> 799cc916808a\nStep 6/8 : RUN yarn install\n ---> Using cache\n ---> ee7cedeed097\nStep 7/8 : COPY . ./\n ---> 35896074cb9c\nStep 8/8 : CMD yarn start\n ---> Running in 97b21fc9e3b3\nRemoving intermediate container 97b21fc9e3b3\n ---> 430a567d898a\nSuccessfully built 430a567d898a\nSuccessfully tagged apiplatform222_client:latest\nBuilding php\nStep 1/18 : FROM composer:1.6\n ---> eec947041f4b\nStep 2/18 : FROM php:7.2-fpm-alpine3.7\n ---> 0331f7305fe0\nStep 3/18 : RUN apk add --no-cache      git\n ---> Using cache\n ---> d0505a2a7fb4\nStep 4/18 : ENV APCU_VERSION 5.1.9\n ---> Using cache\n ---> 35e177541efc\nStep 5/18 : RUN set -xe     && apk add --no-cache --virtual .build-deps         $PHPIZE_DEPS        icu-dev         postgresql-dev      zlib-dev    && docker-php-ext-install       intl        pdo_pgsql       zip     && pecl install         apcu-${APCU_VERSION}    && docker-php-ext-enable --ini-name 20-apcu.ini apcu    && docker-php-ext-enable --ini-name 05-opcache.ini opcache  && runDeps=\"$(      scanelf --needed --nobanner --format '%n#p' --recursive /usr/local/lib/php/extensions           | tr ',' '\\n'           | sort -u           | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }'     )\"  && apk add --no-cache --virtual .php-phpexts-rundeps $runDeps   && apk del .build-deps\n ---> Using cache\n ---> 80394948fabe\nStep 6/18 : COPY --from=0 /usr/bin/composer /usr/bin/composer\n ---> Using cache\n ---> a121548cea15\nStep 7/18 : COPY docker/php/php.ini /usr/local/etc/php/php.ini\n ---> Using cache\n ---> 7ec0481891aa\nStep 8/18 : COPY docker/php/docker-entrypoint.sh /usr/local/bin/docker-entrypoint\n ---> Using cache\n ---> 58d3c6533cf2\nStep 9/18 : RUN chmod +x /usr/local/bin/docker-entrypoint\n ---> Using cache\n ---> 00bc25dac9af\nStep 10/18 : WORKDIR /srv/api\n ---> Using cache\n ---> 0aee38df52a8\nStep 11/18 : ENTRYPOINT [\"docker-entrypoint\"]\n ---> Using cache\n ---> 9ae1b9b0dce7\nStep 12/18 : CMD [\"php-fpm\"]\n ---> Using cache\n ---> 3fce8f8cf901\nStep 13/18 : ENV COMPOSER_ALLOW_SUPERUSER 1\n ---> Using cache\n ---> 302a73743881\nStep 14/18 : RUN composer global require \"hirak/prestissimo:^0.3\" --prefer-dist --no-progress --no-suggest --classmap-authoritative\n ---> Using cache\n ---> 58bf26319bb1\nStep 15/18 : COPY composer.json composer.lock ./\n ---> Using cache\n ---> 0e008d418c9d\nStep 16/18 : RUN composer install --prefer-dist --no-dev --no-autoloader --no-scripts --no-progress --no-suggest    && composer clear-cache\n ---> Using cache\n ---> 7741ac054607\nStep 17/18 : COPY . ./\n ---> 4e575d61ba16\nStep 18/18 : RUN mkdir -p var/cache var/logs var/sessions   && composer dump-autoload --classmap-authoritative --no-dev     && chown -R www-data var\n ---> Running in c2e81cf06809\nGenerating optimized autoload files (authoritative)\nRemoving intermediate container c2e81cf06809\n ---> fab1188832a2\nSuccessfully built fab1188832a2\nSuccessfully tagged apiplatform222_php:latest\nBuilding api\nStep 1/3 : FROM nginx:1.13-alpine\n ---> bb00c21b4edf\nStep 2/3 : COPY docker/nginx/conf.d /etc/nginx/conf.d/\n ---> Using cache\n ---> 7c56143e0fb6\nStep 3/3 : COPY public /srv/api/public\n ---> Using cache\n ---> b83fe2cfc740\nSuccessfully built b83fe2cfc740\nSuccessfully tagged apiplatform222_api:latest\nBuilding cache-proxy\nStep 1/6 : FROM alpine:3.7\n ---> 3fd9065eaf02\nStep 2/6 : RUN apk add --no-cache varnish\n ---> Using cache\n ---> c71c5e7188b3\nStep 3/6 : COPY docker/varnish/conf /etc/varnish/\n ---> Using cache\n ---> b2f8941af105\nStep 4/6 : COPY docker/varnish/start.sh /usr/local/bin/docker-app-start\n ---> Using cache\n ---> aa95576fcedc\nStep 5/6 : RUN chmod +x /usr/local/bin/docker-app-start\n ---> Using cache\n ---> eff4c23b1f4b\nStep 6/6 : CMD [\"docker-app-start\"]\n ---> Using cache\n ---> 166fe246295a\nSuccessfully built 166fe246295a\nSuccessfully tagged apiplatform222_cache-proxy:latest\nBuilding h2-proxy\nStep 1/11 : FROM alpine:latest\n ---> 3fd9065eaf02\nStep 2/11 : RUN apk add --no-cache openssl\n ---> Using cache\n ---> f2de47825e63\nStep 3/11 : RUN openssl genrsa -des3 -passout pass:NotSecure -out cert.pass.key 2048\n ---> Using cache\n ---> f3239df248ec\nStep 4/11 : RUN openssl rsa -passin pass:NotSecure -in cert.pass.key -out cert.key\n ---> Using cache\n ---> 31a27f3eecc4\nStep 5/11 : RUN rm cert.pass.key\n ---> Using cache\n ---> ef7a2ffa2548\nStep 6/11 : RUN openssl req -new -passout pass:NotSecure -key cert.key -out cert.csr     -subj '/C=SS/ST=SS/L=Gotham City/O=API Platform Dev/CN=localhost'\n ---> Using cache\n ---> f0adf6562d87\nStep 7/11 : RUN openssl x509 -req -sha256 -days 365 -in cert.csr -signkey cert.key -out cert.crt\n ---> Using cache\n ---> 62dec05ffab9\nStep 8/11 : FROM nginx:1.13-alpine\n ---> bb00c21b4edf\nStep 9/11 : RUN mkdir -p /etc/nginx/ssl/\n ---> Using cache\n ---> c726610a678a\nStep 10/11 : COPY --from=0 cert.key cert.crt /etc/nginx/ssl/\n ---> Using cache\n ---> 7494aad86556\nStep 11/11 : COPY conf.d /etc/nginx/conf.d/\n ---> Using cache\nCreating apiplatform222_db_1          ... done\nSuccessfully built 86fc11d9f9a8\nCreating apiplatform222_admin_1       ... done\nCreating apiplatform222_php_1         ... done\nCreating apiplatform222_client_1      ... done\nCreating apiplatform222_api_1         ... done\nCreating apiplatform222_php_1         ... \nCreating apiplatform222_cache-proxy_1 ... done\nCreating apiplatform222_cache-proxy_1 ... \nCreating apiplatform222_h2-proxy_1    ... done\nAttaching to apiplatform222_db_1, apiplatform222_php_1, apiplatform222_api_1, apiplatform222_client_1, apiplatform222_cache-proxy_1, apiplatform222_admin_1, apiplatform222_h2-proxy_1\ndb_1           | The files belonging to this database system will be owned by user \"postgres\".\ndb_1           | This user must also own the server process.\ndb_1           | \ndb_1           | The database cluster will be initialized with locale \"en_US.utf8\".\ndb_1           | The default database encoding has accordingly been set to \"UTF8\".\ndb_1           | The default text search configuration will be set to \"english\".\ndb_1           | \ndb_1           | Data page checksums are disabled.\ndb_1           | \ndb_1           | fixing permissions on existing directory /var/lib/postgresql/data ... ok\ndb_1           | creating subdirectories ... ok\nphp_1          | Loading composer repositories with package information\nclient_1       | yarn run v1.3.2\ndb_1           | selecting default max_connections ... 100\ndb_1           | selecting default shared_buffers ... 128MB\ndb_1           | selecting dynamic shared memory implementation ... posix\nphp_1          | Installing dependencies (including require-dev) from lock file\ncache-proxy_1  | + varnishd -a :80 -f /etc/varnish/default.vcl -s malloc,256m\nadmin_1        | yarn run v1.3.2\nclient_1       | $ react-scripts start\ndb_1           | creating configuration files ... ok\ndb_1           | running bootstrap script ... ok\ndb_1           | performing post-bootstrap initialization ... sh: locale: not found\ndb_1           | No usable system locales were found.\ndb_1           | Use the option \"--debug\" to see details.\nphp_1          | Warning: The lock file is not up to date with the latest changes in composer.json. You may be getting outdated dependencies. Run update to update them.\ndb_1           | ok\nphp_1          |     1/68:  https://codeload.github.com/symfony/polyfill-php72/legacy.zip/8eca20c8a369e069d4f4c2ac9895144112867422\nphp_1          |     2/68:  https://codeload.github.com/composer/semver/legacy.zip/c7cb9a2095a074d131b65a8a0cd294479d785573\ndb_1           | syncing data to disk ... ok\nphp_1          |     3/68:  https://codeload.github.com/symfony/stopwatch/legacy.zip/d52321f0e2b596bd03b5d1dd6eebe71caa925704\nphp_1          |     4/68:  https://codeload.github.com/symfony/options-resolver/legacy.zip/371532a2cfe932f7a3766dd4c45364566def1dd0\ndb_1           | \ndb_1           | WARNING: enabling \"trust\" authentication for local connections\ndb_1           | You can change this by editing pg_hba.conf or using the option -A, or\ndb_1           | --auth-local and --auth-host, the next time you run initdb.\nphp_1          |     6/68:  https://codeload.github.com/symfony/process/legacy.zip/e1712002d81de6f39f854bc5bbd9e9f4bb6345b4\nphp_1          |     6/68:  https://codeload.github.com/symfony/lts/legacy.zip/396c5fca8d73d01186df37d7031321a3c0c2bf92\ndb_1           | \ndb_1           | Success. You can now start the database server using:\nphp_1          |     7/68:  https://codeload.github.com/PHP-CS-Fixer/diff/legacy.zip/78bb099e9c16361126c86ce82ec4405ebab8e756\ndb_1           | \ndb_1           |     pg_ctl -D /var/lib/postgresql/data -l logfile start\ndb_1           | \nphp_1          |     8/68:  https://codeload.github.com/thephpleague/html-to-markdown/legacy.zip/3af14d8f44838257a75822819784e83819b34e2e\ndb_1           | waiting for server to start....LOG:  could not bind IPv6 socket: Address not available\ndb_1           | HINT:  Is another postmaster already running on port 5432? If not, wait a few seconds and retry.\nphp_1          |     9/68:  https://codeload.github.com/guzzle/promises/legacy.zip/a59da6cf61d80060647ff4d3eb2c03a2bc694646\ndb_1           | LOG:  database system was shut down at 2018-02-24 19:02:48 UTC\ndb_1           | LOG:  MultiXact member wraparound protections are now enabled\ndb_1           | LOG:  database system is ready to accept connections\nphp_1          |     10/68: https://codeload.github.com/symfony/yaml/legacy.zip/ffc60bda1d4a00ec0b32eeabf39dc017bf480028\ndb_1           | LOG:  autovacuum launcher started\ndb_1           |  done\ndb_1           | server started\nphp_1          |     11/68: https://codeload.github.com/symfony/flex/legacy.zip/1f00c05d35523dc0ac52e4a457989a069be5a7a4\ndb_1           | CREATE DATABASE\ndb_1           | \ndb_1           | CREATE ROLE\nphp_1          |     12/68: https://codeload.github.com/php-fig/http-message/legacy.zip/f6561bf28d520154e4b0ec72be95418abe6d9363\ndb_1           | \nphp_1          |     13/68: https://codeload.github.com/api-platform/api-pack/legacy.zip/33ade8a1dc23868828788fe1bf3e54291ce54843\ndb_1           | \nphp_1          |     14/68: https://codeload.github.com/njh/easyrdf/legacy.zip/acd09dfe0555fbcfa254291e433c45fdd4652566\ndb_1           | /usr/local/bin/docker-entrypoint.sh: ignoring /docker-entrypoint-initdb.d/*\ndb_1           | \nphp_1          |     15/68: https://codeload.github.com/guzzle/psr7/legacy.zip/f5b8a8512e2b58b0071a7280e39f14f72e05d87c\nphp_1          |     16/68: https://codeload.github.com/guzzle/guzzle/legacy.zip/f4db5a78a5ea468d4831de7f0bf9d9415e348699\nphp_1          |     17/68: https://codeload.github.com/symfony/property-info/legacy.zip/d8c4f5ef14bee33b80336a48d2932e2161252afd\nphp_1          |     18/68: https://codeload.github.com/api-platform/schema-generator/legacy.zip/849d34cc19fd86851d3015a8cbd3d8fe00da3ef8\ndb_1           | waiting for server to shut down....LOG:  received fast shutdown request\ndb_1           | LOG:  aborting any active transactions\ndb_1           | LOG:  autovacuum launcher shutting down\ndb_1           | LOG:  shutting down\nphp_1          |     19/68: https://codeload.github.com/willdurand/Negotiation/legacy.zip/03436ededa67c6e83b9b12defac15384cb399dc9\ndb_1           | LOG:  database system is shut down\ndb_1           |  done\nphp_1          |     20/68: https://codeload.github.com/doctrine/DoctrineCacheBundle/legacy.zip/9baecbd6bfdd1123b0cf8c1b88fee0170a84ddd1\ndb_1           | server stopped\nphp_1          |     21/68: https://codeload.github.com/jdorn/sql-formatter/legacy.zip/64990d96e0959dff8e059dfcdc1af130728d92bc\nphp_1          |     22/68: https://codeload.github.com/doctrine/DoctrineBundle/legacy.zip/eb6e4fb904a459be28872765ab6e2d246aac7c87\ndb_1           | \ndb_1           | PostgreSQL init process complete; ready for start up.\ndb_1           | \nphp_1          |     23/68: https://codeload.github.com/symfony/serializer/legacy.zip/18abe8e278181fce0ad55b9cbdd04f40f4bcf553\ndb_1           | LOG:  database system was shut down at 2018-02-24 19:02:50 UTC\nphp_1          |     24/68: https://codeload.github.com/symfony/doctrine-bridge/legacy.zip/85d54596a1fe1089536ce03979a1992bf71b7e04\ndb_1           | LOG:  MultiXact member wraparound protections are now enabled\nphp_1          |     25/68: https://codeload.github.com/doctrine/annotations/legacy.zip/c7f2050c68a9ab0bdb0f98567ec08d80ea7d24d5\ndb_1           | LOG:  database system is ready to accept connections\nphp_1          |     26/68: https://codeload.github.com/FriendsOfPHP/PHP-CS-Fixer/legacy.zip/1634a2c250bf4640f1c5c963f63b413c2d966c8a\ndb_1           | LOG:  autovacuum launcher started\nphp_1          |     27/68: https://codeload.github.com/doctrine/inflector/legacy.zip/5527a48b7313d15261292c149e55e26eae771b0a\nphp_1          |     28/68: https://codeload.github.com/doctrine/lexer/legacy.zip/83893c552fd2045dd78aef794c31e694c37c0b8c\nphp_1          |     29/68: https://codeload.github.com/doctrine/collections/legacy.zip/a01ee38fcd999f34d9bfbcee59dbda5105449cbf\nphp_1          |     30/68: https://codeload.github.com/doctrine/instantiator/legacy.zip/185b8868aa9bf7159f5f953ed5afb2d7fcdc3bda\nphp_1          |     31/68: https://codeload.github.com/doctrine/common/legacy.zip/f68c297ce6455e8fd794aa8ffaf9fa458f6ade66\nphp_1          |     32/68: https://codeload.github.com/nelmio/NelmioCorsBundle/legacy.zip/548dc8ebd3984acd2f6d8787ab1dac2e9aa14254\nphp_1          |     33/68: https://codeload.github.com/doctrine/cache/legacy.zip/b3217d58609e9c8e661cd41357a54d926c4a2a1a\nphp_1          |     34/68: https://codeload.github.com/symfony/finder/legacy.zip/8b08180f2b7ccb41062366b9ad91fbc4f1af8601\nphp_1          |     35/68: https://codeload.github.com/phpDocumentor/ReflectionCommon/legacy.zip/21bdeb5f65d7ebf9f43b1b25d404f87deab5bfb6\nphp_1          |     36/68: https://codeload.github.com/phpDocumentor/TypeResolver/legacy.zip/9c977708995954784726e25d0cd1dddf4e65b0f7\nphp_1          |     37/68: https://codeload.github.com/phpDocumentor/ReflectionDocBlock/legacy.zip/94fd0001232e47129dd3504189fa1c7225010d08\nphp_1          |     38/68: https://codeload.github.com/webmozart/assert/legacy.zip/0df1908962e7a3071564e857d86874dad1ef204a\nphp_1          |     39/68: https://codeload.github.com/symfony/routing/legacy.zip/a69bd948700b672e036147762f46749bcae33796\nphp_1          |     40/68: https://codeload.github.com/symfony/asset/legacy.zip/db6063ab6e71c0d4910328a4d10eba197e1d6b40\nphp_1          |     41/68: https://codeload.github.com/symfony/console/legacy.zip/36d5b41e7d4e1ccf0370f6babe966c08ef0a1488\nphp_1          |     42/68: https://codeload.github.com/symfony/expression-language/legacy.zip/b826c255f22333eccd3365734d2c4e150c284843\nphp_1          |     43/68: https://codeload.github.com/doctrine/dbal/legacy.zip/e3eed9b1facbb0ced3a0995244843a189e7d1b13\nphp_1          |     44/68: https://codeload.github.com/symfony/cache/legacy.zip/e901ff335ef5e8ef57ee9b8e098bd54a1d39a857\nphp_1          |     45/68: https://codeload.github.com/php-fig/simple-cache/legacy.zip/753fa598e8f3b9966c886fe13f370baa45ef0e24\nphp_1          |     46/68: https://codeload.github.com/symfony/framework-bundle/legacy.zip/3766b9b88e9918f68560b58a404340b41112b861\nphp_1          |     47/68: https://codeload.github.com/php-fig/cache/legacy.zip/d11b50ad223250cf17b86e38383413f5a6764bf8\nphp_1          |     48/68: https://codeload.github.com/doctrine/doctrine2/legacy.zip/374e7ace49d864dad8cddbc55346447c8a6a2083\nphp_1          |     49/68: https://codeload.github.com/symfony/security-bundle/legacy.zip/2d65eb4f72e89cf9ee710a64be14922e81229d7b\nphp_1          |     50/68: https://codeload.github.com/php-fig/container/legacy.zip/b7ce3b176482dbbc1245ebf52b181af44c2cf55f\nphp_1          |     51/68: https://codeload.github.com/api-platform/core/legacy.zip/0eb8d7605beb32f9e91a808575ff1bfe6fc7d0bc\nphp_1          |     52/68: https://codeload.github.com/symfony/inflector/legacy.zip/da634a9968162f7c5c94f8d6949a4ede86085304\nphp_1          |     53/68: https://codeload.github.com/symfony/property-access/legacy.zip/e0fef10eb7e11cae9421d8d89024dfeae0acffb7\nphp_1          |     54/68: https://codeload.github.com/symfony/twig-bundle/legacy.zip/854b3ae1e761cf9443241119675c64e263ff21a7\nphp_1          |     55/68: https://codeload.github.com/symfony/filesystem/legacy.zip/760e47a4ee64b4c48f4b30017011e09d4c0f05ed\nphp_1          |     56/68: https://codeload.github.com/symfony/config/legacy.zip/ecd917899167922086ddb3247aa43eb1c418fcb2\nphp_1          |     57/68: https://codeload.github.com/symfony/dependency-injection/legacy.zip/f78ca49c6360c710ca8e316511e71a23b10e3bf2\nphp_1          |     58/68: https://codeload.github.com/php-fig/log/legacy.zip/4ebe3a8bf773a19edfe0a84b6585ba3d401b724d\nphp_1          |     59/68: https://codeload.github.com/symfony/debug/legacy.zip/c77bb31d0f6310a2ac11e657475d396a92e5dc54\nphp_1          |     60/68: https://codeload.github.com/symfony/http-kernel/legacy.zip/194bd224ec27952eac6d4fea6264b22990834eca\nphp_1          |     61/68: https://codeload.github.com/symfony/event-dispatcher/legacy.zip/74d33aac36208c4d6757807d9f598f0133a3a4eb\nphp_1          |     62/68: https://codeload.github.com/symfony/twig-bridge/legacy.zip/81260f5539bdd7a4b5c39c55e197dae6daecc33f\nphp_1          |     63/68: https://codeload.github.com/symfony/polyfill-mbstring/legacy.zip/78be803ce01e55d3491c1397cf1c64beb9c1b63b\nphp_1          |     64/68: https://codeload.github.com/symfony/http-foundation/legacy.zip/82a3ee2c6662d08ca1adf99e1ef2e31ab48196d4\nphp_1          |     65/68: https://codeload.github.com/twigphp/Twig/legacy.zip/eddb97148ad779f27e670e1e3f19fb323aedafeb\nphp_1          |     66/68: https://codeload.github.com/symfony/validator/legacy.zip/f1a020d3ea3ec23cfb666ee3169700b3fae14505\nphp_1          |     67/68: https://codeload.github.com/symfony/security/legacy.zip/08ab1dee6c1f9b9be78ff32d80829a3f6cd43d79\nphp_1          |     68/68: https://codeload.github.com/symfony/translation/legacy.zip/a9c4e4cc56f7eff0960c4f6c157da8f6b13211fc\nphp_1          |     Finished: success: 68, skipped: 0, failure: 0, total: 68\nphp_1          | Package operations: 68 installs, 0 updates, 0 removals\nphp_1          |   - Installing symfony/flex (v1.0.70): Loading from cache\nphp_1          |   - Installing symfony/polyfill-mbstring (v1.7.0): Loading from cache\nadmin_1        | $ react-scripts start\ncache-proxy_1  | Debug: Platform: Linux,4.9.60-linuxkit-aufs,x86_64,-junix,-smalloc,-smalloc,-hcritbit\ncache-proxy_1  | Debug: Child (18) Started\nphp_1          |   - Installing symfony/translation (v4.0.4): Loading from cache\ncache-proxy_1  | + varnishlog\nadmin_1        | /usr/src/admin/node_modules/source-list-map/lib/index.js:1\nadmin_1        | (function (exports, require, module, __filename, __dirname) { \nadmin_1        |                                                               \nadmin_1        | \nadmin_1        | SyntaxError: Invalid or unexpected token\nadmin_1        |     at new Script (vm.js:51:7)\nadmin_1        |     at createScript (vm.js:138:10)\nadmin_1        |     at Object.runInThisContext (vm.js:199:10)\nadmin_1        |     at Module._compile (module.js:624:28)\nadmin_1        |     at Object.Module._extensions..js (module.js:671:10)\nadmin_1        |     at Module.load (module.js:573:32)\nadmin_1        |     at tryModuleLoad (module.js:513:12)\nadmin_1        |     at Function.Module._load (module.js:505:3)\nadmin_1        |     at Module.require (module.js:604:17)\nadmin_1        |     at require (internal/module.js:11:18)\nadmin_1        | error Command failed with exit code 1.\nadmin_1        | info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.\nphp_1          |   - Installing symfony/validator (v4.0.4): Loading from cache\napiplatform222_admin_1 exited with code 1\nclient_1       | Starting the development server...\nclient_1       | \nphp_1          |   - Installing twig/twig (v2.4.4): Loading from cache\nphp_1          |   - Installing symfony/twig-bridge (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/http-foundation (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/event-dispatcher (v4.0.4): Loading from cache\nphp_1          |   - Installing psr/log (1.0.2): Loading from cache\nphp_1          |   - Installing symfony/debug (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/http-kernel (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/filesystem (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/config (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/twig-bundle (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/inflector (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/property-access (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/security (v4.0.4): Loading from cache\nclient_1       | Compiled successfully!\nclient_1       | \nclient_1       | You can now view client in the browser.\nclient_1       | \nclient_1       |   Local:            http://localhost:3000/\nclient_1       |   On Your Network:  http://172.20.0.6:3000/\nclient_1       | \nclient_1       | Note that the development build is not optimized.\nclient_1       | To create a production build, use yarn build.\nclient_1       | \nphp_1          |   - Installing psr/container (1.0.0): Loading from cache\nphp_1          |   - Installing symfony/dependency-injection (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/security-bundle (v4.0.4): Loading from cache\nphp_1          |   - Installing psr/simple-cache (1.0.0): Loading from cache\nphp_1          |   - Installing psr/cache (1.0.1): Loading from cache\nphp_1          |   - Installing symfony/cache (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/expression-language (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/asset (v4.0.4): Loading from cache\nphp_1          |   - Installing webmozart/assert (1.3.0): Loading from cache\nphp_1          |   - Installing phpdocumentor/reflection-common (1.0.1): Loading from cache\nphp_1          |   - Installing phpdocumentor/type-resolver (0.4.0): Loading from cache\nphp_1          |   - Installing phpdocumentor/reflection-docblock (4.3.0): Loading from cache\nphp_1          |   - Installing symfony/routing (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/finder (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/framework-bundle (v4.0.4): Loading from cache\nphp_1          |   - Installing nelmio/cors-bundle (1.5.4): Loading from cache\nphp_1          |   - Installing symfony/console (v4.0.4): Loading from cache\nphp_1          |   - Installing doctrine/instantiator (1.1.0): Loading from cache\nphp_1          |   - Installing doctrine/lexer (v1.0.1): Loading from cache\nphp_1          |   - Installing doctrine/inflector (v1.3.0): Loading from cache\nphp_1          |   - Installing doctrine/collections (v1.5.0): Loading from cache\nphp_1          |   - Installing doctrine/cache (v1.7.1): Loading from cache\nphp_1          |   - Installing doctrine/annotations (v1.6.0): Loading from cache\nphp_1          |   - Installing doctrine/common (v2.8.1): Loading from cache\nphp_1          |   - Installing doctrine/dbal (v2.6.3): Loading from cache\nphp_1          |   - Installing doctrine/orm (v2.6.0): Loading from cache\nphp_1          |   - Installing symfony/doctrine-bridge (v4.0.4): Loading from cache\nphp_1          |   - Installing jdorn/sql-formatter (v1.2.17): Loading from cache\nphp_1          |   - Installing doctrine/doctrine-cache-bundle (1.3.2): Loading from cache\nphp_1          |   - Installing doctrine/doctrine-bundle (1.8.1): Loading from cache\nphp_1          |   - Installing willdurand/negotiation (v2.3.1): Loading from cache\nphp_1          |   - Installing symfony/serializer (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/property-info (v4.0.4): Loading from cache\nphp_1          |   - Installing api-platform/core (v2.2.2): Loading from cache\nphp_1          |   - Installing api-platform/api-pack (1.1.0): Loading from cache\nphp_1          |   - Installing psr/http-message (1.0.1): Loading from cache\nphp_1          |   - Installing guzzlehttp/psr7 (1.4.2): Loading from cache\nphp_1          |   - Installing guzzlehttp/promises (v1.3.1): Loading from cache\nphp_1          |   - Installing guzzlehttp/guzzle (6.3.0): Loading from cache\nphp_1          |   - Installing symfony/yaml (v4.0.4): Loading from cache\nphp_1          |   - Installing league/html-to-markdown (4.6.2): Loading from cache\nphp_1          |   - Installing symfony/stopwatch (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/process (v4.0.4): Loading from cache\nphp_1          |   - Installing symfony/polyfill-php72 (v1.7.0): Loading from cache\nphp_1          |   - Installing symfony/options-resolver (v4.0.4): Loading from cache\nphp_1          |   - Installing php-cs-fixer/diff (v1.3.0): Loading from cache\nphp_1          |   - Installing composer/semver (1.4.2): Loading from cache\nphp_1          |   - Installing friendsofphp/php-cs-fixer (v2.10.3): Loading from cache\nphp_1          |   - Installing easyrdf/easyrdf (0.9.1): Loading from cache\nphp_1          |   - Installing api-platform/schema-generator (v2.1.0): Loading from cache\nphp_1          | Generating autoload files\nphp_1          | Executing script cache:clear [OK]\nphp_1          | Executing script assets:install [OK]\nphp_1          | \nphp_1          | \nphp_1          |  Installing assets as hard copies.\nphp_1          | \nphp_1          |  --- ------------------- ---------------- \nphp_1          |       Bundle              Method / Error  \nphp_1          |  --- ------------------- ---------------- \nphp_1          |   \u2714   ApiPlatformBundle   copy            \nphp_1          |  --- ------------------- ---------------- \nphp_1          | \nphp_1          |  ! [NOTE] Some assets were installed via copy. If you make changes to these     \nphp_1          |  !        assets you have to run this command again.                            \nphp_1          | \nphp_1          |  [OK] All assets were successfully installed.                                   \nphp_1          | \nphp_1          | \nphp_1          |  Updating database schema...\nphp_1          | \nphp_1          |      2 queries were executed\nphp_1          | \nphp_1          |  [OK] Database schema updated successfully!                                     \nphp_1          | \nphp_1          | [24-Feb-2018 19:04:24] NOTICE: fpm is running, pid 1\nphp_1          | [24-Feb-2018 19:04:24] NOTICE: ready to handle connections\nBut the Admin Interface wont work.\n```\n dean \u25b6 ~ \u25b6 Arbeit \u276f \u2026 \u276f php \u276f symfony \u276f api-platform-2.2.2 \u25b6 docker-compose ps\n            Name                          Command              State                                                  Ports                                               \n\napiplatform222_admin_1         /bin/sh -c yarn start           Exit 1                                                                                                   \napiplatform222_api_1           nginx -g daemon off;            Up       0.0.0.0:8080->80/tcp                                                                            \napiplatform222_cache-proxy_1   docker-app-start                Up       0.0.0.0:8081->80/tcp                                                                            \napiplatform222_client_1        /bin/sh -c yarn start           Up       0.0.0.0:80->3000/tcp                                                                            \napiplatform222_db_1            docker-entrypoint.sh postgres   Up       0.0.0.0:5432->5432/tcp                                                                          \napiplatform222_h2-proxy_1      nginx -g daemon off;            Up       0.0.0.0:443->443/tcp, 0.0.0.0:444->444/tcp, 80/tcp, 0.0.0.0:8443->8443/tcp, 0.0.0.0:8444->8444/tcp\napiplatform222_php_1           docker-entrypoint php-fpm       Up       9000/tcp                                                                                        \n dean \u25b6 ~ \u25b6 Arbeit \u276f \u2026 \u276f php \u276f symfony \u276f api-platform-2.2.2 \u25b6 \n dean \u25b6 ~ \u25b6 Arbeit \u276f \u2026 \u276f php \u276f symfony \u276f api-platform-2.2.2 \u25b6 docker-compose up admin\nStarting apiplatform222_admin_1 ... done\nAttaching to apiplatform222_admin_1\nadmin_1        | yarn run v1.3.2\nadmin_1        | $ react-scripts start\nadmin_1        | /usr/src/admin/node_modules/source-list-map/lib/index.js:1\nadmin_1        | (function (exports, require, module, __filename, __dirname) { \nadmin_1        |                                                             \nadmin_1        | \nadmin_1        | SyntaxError: Invalid or unexpected token\nadmin_1        |     at new Script (vm.js:51:7)\nadmin_1        |     at createScript (vm.js:138:10)\nadmin_1        |     at Object.runInThisContext (vm.js:199:10)\nadmin_1        |     at Module._compile (module.js:624:28)\nadmin_1        |     at Object.Module._extensions..js (module.js:671:10)\nadmin_1        |     at Module.load (module.js:573:32)\nadmin_1        |     at tryModuleLoad (module.js:513:12)\nadmin_1        |     at Function.Module._load (module.js:505:3)\nadmin_1        |     at Module.require (module.js:604:17)\nadmin_1        |     at require (internal/module.js:11:18)\nadmin_1        | error Command failed with exit code 1.\nadmin_1        | info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.\napiplatform222_admin_1 exited with code 1\n dean \u25b6 ~ \u25b6 Arbeit \u276f \u2026 \u276f php \u276f symfony \u276f api-platform-2.2.2 \u25b6 \n```\ndean \u25b6 ~ \u25b6 Arbeit \u276f \u2026 \u276f php \u276f symfony \u276f api-platform-2.2.2 \u25b6 docker-compose -v\ndocker-compose version 1.18.0, build 8dd22a9\n dean \u25b6 ~ \u25b6 Arbeit \u276f \u2026 \u276f php \u276f symfony \u276f api-platform-2.2.2 \u25b6 docker -v\nDocker version 17.12.0-ce, build c97c6d6\n. ",
    "mvaljento": "Hi @deantomasevic, did you find a solution to this? \nI'm trying to learn Docker with api platform and running into the same issue.. ",
    "alice001": "Same problem, did u find a solution?. ",
    "mcanepa": "thank you very much!. ",
    "mzmgh": "I'm working on it for 2 days and after I post this I understand that my problem was in PortalBundle\\Validator\\ValidatonGroupsGenerator: that is my service name.. ",
    "mamoot64": "Hi,\nI have the same problem. If I decorate the \"api_platform.jsonld.normalizer.item\" service, serializer is null in the method getAttributeValue() of AbstractItemNormalizer class.\nSame error than @Dakhtara \nSymfony : 3.3.*\nApiPlatform : 2.1. Hi,\n@Swahjak In your StockItemNormilizer, you implements a custom Normelizer.\nThe doc for your case : Writing a custom normalizer\nFor me, the problem is when I want to extend the AbstractItemNormalizer (via Decorator)\nIt seems that Serializer is never set, that's why null is return on object methods call.. Doc has been updated, Decorating a Serializer and Add Extra Data but problem is still there.\nDoc says : \n``` yaml\napp/config/services.yml\nservices:\n    'AppBundle\\Serializer\\ApiNormalizer':\n        decorates: 'api_platform.jsonld.normalizer.item'\n        arguments: [ '@AppBundle\\Serializer\\ApiNormalizer.inner' ]\n```\nThis error is throw : \n[Symfony\\Component\\DependencyInjection\\Exception\\RuntimeException]\n  The definition \"serializer\" has a reference to an abstract definition \"abstract.instanceof.AppBundle\\Serializer\\DecoratingApiNormalizer\". Abstract definitions cannot be the target of references.\nWith \"autoconfigure: true\" in service definition, no error throw but I have the fllowing error (same that previous) : \n```\nCall to a member function normalize() on null in vendor/api-platform/core/src/Serializer/AbstractItemNormalizer.php:426.\n````\nWe loose serializer instance on decorated object.\n. @Aerendir \nYou must copy / paste your service definition after \"_default\" section.. +1 @Aerendir \nIt's work for me too ! ;)\n@meyerbaptiste Do you already need my broken demo ?\n. ",
    "Swahjak": "Was having the same problem, this is my guess on what is going wrong;\nThe documentation is incorrect:\n\n\nFirst. Since the service is decorated with api_platform.jsonld.normalizer.item there is no point in extending ApiPlatform\\Core\\Serializer\\AbstractItemNormalizer because the constructor is not being called. That's where the error comes from; the extended AbstractItemNormalizer was never initialized.\n\n\nSecond. The service as displayed in the documentation should contain both methods from Symfony\\Component\\Serializer\\Normalizer\\NormalizerInterface and Symfony\\Component\\Serializer\\Normalizer\\DenormalizerInterface. So you have to copy the entire example service, not just the methods you need.\n\n\nCould be wrong, but removing the 'extends AbstractItemNormalizer' and adding all the methods seems to do the trick for me.. Ok, that worked until a cache flush. Now I'm getting Call to a member function normalize() on null in vendor/api-platform/core/src/Serializer/AbstractItemNormalizer.php:426. For some reason the serializer is not injected (or I was completely wrong to begin with). \nEdit. For reference;\n```yml\nservices:\napi.stock_item.normalizer:\n    class: Topper\\InventoryBundle\\Serializer\\StockItemNormalizer\n    decorates: 'api_platform.jsonld.normalizer.item'\n    arguments: [ '@api.stock_item.normalizer.inner' ]\n\n```\n```php\n<?php\nnamespace Topper\\InventoryBundle\\Serializer;\nuse ApiPlatform\\Core\\Serializer\\AbstractItemNormalizer;\nuse Symfony\\Component\\Serializer\\Normalizer\\DenormalizerInterface;\nuse Symfony\\Component\\Serializer\\Normalizer\\NormalizerInterface;\nfinal class StockItemNormalizer implements NormalizerInterface, DenormalizerInterface\n{\n    /*\n     * @var AbstractItemNormalizer\n     /\n    private $decorated;\n/**\n * StockItemNormalizer constructor.\n *\n * @param NormalizerInterface $decorated\n */\npublic function __construct(NormalizerInterface $decorated)\n{\n    $this->decorated = $decorated;\n}\n\n/**\n * @param mixed $data\n * @param null  $format\n *\n * @return bool\n */\npublic function supportsNormalization($data, $format = null)\n{\n    return $this->decorated->supportsNormalization($data, $format);\n}\n\n/**\n * @param object $object\n * @param null   $format\n * @param array  $context\n *\n * @return array|\\Symfony\\Component\\Serializer\\Normalizer\\scalar\n */\npublic function normalize($object, $format = null, array $context = [])\n{\n    return $this->decorated->normalize($object, $format, $context);\n}\n\n/**\n * @param mixed  $data\n * @param string $type\n * @param null   $format\n *\n * @return mixed\n */\npublic function supportsDenormalization($data, $type, $format = null)\n{\n    return $this->decorated->supportsDenormalization($data, $type, $format);\n}\n\n/**\n * @param mixed  $data\n * @param string $class\n * @param null   $format\n * @param array  $context\n *\n * @return mixed\n */\npublic function denormalize($data, $class, $format = null, array $context = [])\n{\n    return $this->decorated->denormalize($data, $class, $format, $context);\n}\n\n}\n```. ",
    "SalvatorePollaci": "Hi guys, whats the difference between:\n1)Writing a custom normalizer(https://api-platform.com/docs/core/content-negotiation/#writing-a-custom-normalizer)\n2)Decorating a serializer(https://api-platform.com/docs/core/serialization#decorating-a-serializer-and-add-extra-data)\n? Thanks!. ",
    "alexislefebvre": "I had the same error with Symfony 3.3 and the example from the documentation.\nAdding autoconfigure: false to the definition of 'AppBundle\\Serializer\\ApiNormalizer': fixed the issue.\nThanks all.. ",
    "SkYNewZ": "After more search, row is successfully created in database with POST request :\n```\nmysql> select * from foo;\n+----+--------+\n| id | bar    |\n+----+--------+\n|  1 | string |\n|  2 | string |\n|  3 | string |\n+----+--------+\n3 rows in set (0.00 sec)\nmysql> select * from foo;\n+----+----------+\n| id | bar      |\n+----+----------+\n|  1 | string   |\n|  2 | string   |\n|  3 | string   |\n|  4 | sdsdsdsd |\n+----+----------+\n4 rows in set (0.00 sec)\n```\nOnly the return is\n```\n{\n  \"@context\": \"/contexts/Error\",\n  \"@type\": \"hydra:Error\",\n  \"hydra:title\": \"An error occurred\",\n  \"hydra:description\": \"Internal Server Error\"\n}\ncache-control: no-cache, private \n connection: keep-alive \n content-type: application/ld+json; charset=utf-8 \n date: Thu, 09 Nov 2017 23:34:23 GMT \n link: http://192.168.136.130:8080/docs.jsonld; rel=\"http://www.w3.org/ns/hydra/core#apiDocumentation\" \n server: nginx/1.11.13 \n transfer-encoding: chunked \n x-content-type-options: nosniff \n x-frame-options: deny \n x-powered-by: PHP/7.1.11 \n```\nAll methods work perfectly, only the return is an error for me. Sorry I corrected my problem... Simply, apache2 is running. Probably too tired to see this detail! Have a good day!. ",
    "red-smeg": "Can you post the solution. ",
    "sundowndev": "Could you post the solution please @Aerendir ?. I'm having the same issue, could you give me a request example using IRI ? I don't understand how I should use the IRI to make persist the related entity.. @soyuka it does exist but seems deprecated. So I tried with json but it gives me this error : \n~~~\nCall to a member function isCollection() on null\n~~~\nSo I don't know what to use instead.\nedit: It does not work with any column type.. Alright, thank you. But how can I set it nullable ? or set a default value ?. For example column response define the parent response that get the user to a question. If there is not parent question I have to set it to null, right ?\nI can't use\n~~~\n@ORM\\Column(type=\"string\", nullable=true)\n~~~. Alright, thanks for replying! Closing since it's invalid.. ",
    "msitruk": "I m curious too. Is there a release note when upgrade is published ?. Got same issue on my laptop on ubuntu 16.04 :\n$ docker logs api_cache-proxy_1\nvarnishd -a :80 -f /etc/varnish/default.vcl -s malloc,256m\nError: Cannot read -f file '/etc/varnish/default.vcl' (Permission denied)\n(-? gives usage)\ndocker and docker-compose version :+1: \n$ docker -v\nDocker version 18.03.1-ce, build 9ee9f40\n$ docker-compose -v\ndocker-compose version 1.21.2, build a133471\nDon't get it when I deploy on my debian vps in the same way.. @teohhanhui 2.2.8. In my case how I did : \n1) Create a User entity implementing UserInterface and \\Serializable expoed trough @ApiResource with groups write/read for password field.\n2) Install https://packagist.org/packages/lexik/jwt-authentication-bundle ( JWT )\n3) Install https://packagist.org/packages/gesdinet/jwt-refresh-token-bundle ( Refresh )\n4) Edit security.yaml to add provider and firewall for \"login\", \"/login_check\", \"/token/refresh\" and \"/api_doc\", same for access_control part\n5) Edit routes.yaml to add swagger_ui, api_login_check and gesdinet_jwt_refresh_token\n6) Edit api_platform.yaml for swagger\nIf that can help.. ",
    "Balkeo": "I just add DoctrineFixturesBundle and a Fixtures file.\nand the full SQL in profiler is : \nSELECT o FROM AppBundle\\Entity\\D o WHERE o.d IN(SELECT cs_a1 FROM AppBundle\\Entity\\C cs_a1 WHERE cs_a1.id = :id_p1 AND cs_a1.b IN(SELECT bs_a2 FROM AppBundle\\Entity\\B bs_a2 WHERE bs_a2.id = :id_p2) AND bs_a2.a IN(SELECT id_a3 FROM AppBundle\\Entity\\A id_a3 WHERE id_a3.id = :id_p3)) ORDER BY o.id ASC. ",
    "hariszukanovic": "I think I have a similar case.\nWhen using groups, any properties of an entity do not even show up in the GET response if I use underscore in their name.. This is likely caused by the same problem that I have filed an issue for in the core project.\nhttps://github.com/api-platform/core/issues/1554. Thanx.\nI have tried to update the composer.json to begin using Symfony 4.0 but I have unresolved dependencies problem. Not sure what exactly is needed to be fixed.\nI will try to do my tests with master.\nPerhaps not updating the composer.json to use new Symfony in api-platform project was intentional after all.... I will try to setup from scratch. Thanx\nOn 8 Dec 2017 16:18, \"Adamo Crespi\" notifications@github.com wrote:\n\n@hariszukanovic https://github.com/hariszukanovic , the best way to\nupdate is starting with a fresh installation of SF4 and then move all your\nbusiness code to this new version, practically rewriting the app.\nSimply pushing the version will require more work and doesn't guarantee\nyou will have the full functionalities of SF4, especially Flex.\nRead here for more information: https://symfony.com/doc/\ncurrent/setup/flex.html#upgrade-to-flex\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/api-platform/api-platform/issues/481#issuecomment-350288514,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ABLXKIolvJckeoecOK2XmkDbc2s3wxAoks5s-VMzgaJpZM4Qz-vF\n.\n. \n",
    "JefNeus": "Thanks @soyuka for the tip, setting the propertiy public does the thing.. ",
    "byhoratiss": "Ok, thanks!. Hmm sounds confusing.\nIf you are building your API with api-platform, you want to use it right?\nHow are you planning to consume your api?\nIf you have a separated sf3 application with your own forms & others, why you want to use the \"separated\" api? . So the web-app should have his own mechanism of communicating with api.\nIf the app is a sf3, you could write a Client using Guzzle.. Seems usable. I have something like that, my own service using Guzzle to publish data in another's system API. But I prefered writing the logic, but of course, I didn't knew that bundle.\nGood luck with that!. Sorry @soyuka, it does works very well indeed, but always with one EntityManager connection.\nMy problem is that the same entity can be managed by multiple EntityManagers, but when the Registry asks for \"who is the responsible EM for this entity\", it always returns the first defined one.\nSo, even if I've an MyAwesomeBundle:Post entity, it will always be managed by foo EntityManager, and I need to work on bar EM.\nDid I explained the problem?. Why having multiple databases with same schema is weird?\nSeems a very common thing to me.\nSo the only way is decorating the existing DataProviders (Collection & Item) for overwriting the current behaviour?\n. I don't know what kind of approach to use if I've to \"switch\" the DBAL connection for an EntityManager. And it should be available for every possible request to the API, any hints?. @BonnieDoug I've multiple databases over different servers\n@soyuka I read the configuration of the tests, and it seems that only uses / defines only one connection for the entire application. So there is no problem at all with that.\nIn my case I've multiple databases over different servers so I've multiple DBAL definitions with same schema defined by Doctrine ORM associations & mapping.\nSo, I've:\n- DBAL 1 \"default\": mysql, entity_manager \"default\", common tables, settings, roles, etc.\n- DBAL 2 \"foo\": sqlserver, entity_manager \"foo\", using \"foo\" DBAL connection, data I want to expose\n- DBAL 3 \"bar\": sqlserver2, entity_manager \"bar\", using \"bar\" DBAL connection, more data, same structure than others\n- DBAL 4 \"zar\": sqlserver3, entity_manager \"zar\", using \"zar\" DBAL connection, another thingy, same.\n- EntityManagers \"foo\", \"bar\" and \"zar\" have the same Bundle mapped.\nIf I want to expose entities from my Bundle but through \"bar\" EntityManager, can't be done. It will always use the first EntityManager defined, which in my example, is \"foo\".\nThats the common behaviour of ManagerRegistry::getManagerForClass.\nI've the same problem using https://github.com/javiereguiluz/EasyAdminBundle but I could get it working by using my own controller and using the EntityManager that I specify.\nSorry about this long answer and I hope it clarifies my problem.\nThank you guys!\n. Finally I get it working as I wanted without changing anything into Api-platform.\nThis is how I did it, just to help others that maybe would face the same problem.\nFor every database connection and server I used the proper DBAL configuration and also added my own \"DynamicConnection\" that will be used for the API.\n```\ndoctrine:\n    dbal:\n        default_connection: default\n        connections:\n            default:\n                driver:   pdo_mysql\n                host:     \"%database_host%\"\n                port:     \"%database_port%\"\n                dbname:   \"%database_name%\"\n                user:     \"%database_user%\"\n                password: \"%database_password%\"\n                charset:  UTF8\n        sql.dynamic:\n            wrapper_class: MyAwesome\\Bundle\\Doctrine\\Connection\\DynamicConnection\n            charset:  UTF8\n\n        sql.bar:\n            host:     \"%db_bar_host%\"\n            dbname:   \"%db_bar_name%\"\n            user:     \"%db_bar_user%\"\n            password: \"%db_bar_password%\"\n            charset:  UTF8\n\n        sql.foo:\n            host:     \"%db_foo_host%\"\n            dbname:   \"%db_foo_name%\"\n            user:     \"%db_foo_user%\"\n            password: \"%db_foo_password%\"\n            charset:  UTF8\n\n```\nWhen I've to define my EntityManagers I gave them a name for every one and added ONE more just to be used through the API. Of course you can't change which one will be used, but in my case, when the ManagerRegistry::getManagerForClass is called, \"api\" entity manager will be used and the dynamic connection will use the right connection.\nHow? Just naming it alphabetically so in my list of EntityManagers, \"api\" is the first one that maps the same Bundles as the others.\nThe others EntityManagers are necessary to be able to use them by specifing the EM trough a console command or Controller or whatever, without the need of the bussiness logic of \"dbSwitcher\" service dependency of the wrapperClass.\n```\n    orm:\n        auto_generate_proxy_classes: \"%kernel.debug%\"\n        entity_managers:\n            default:\n                connection: default\n                mappings:\n                    AppBundle: ~\n        # Uses a Dynamic connection\n        # Naming is Important: the first that matches the Bundle will be used as EM inside ManagerRegistry\n        api:\n            connection: sql.dynamic\n            mappings:\n                MyAwesomeBundle: ~\n\n        foo:\n            connection: sql.foo\n            mappings:\n                MyAwesomeBundle: ~\n        bar:\n            connection: sql.bar\n            mappings:\n                MyAwesomeBundle: ~\n\n```\nThe database connection is configured by my custom wrapperClass, which uses the parameters of others connections. This wrapper uses a Service that holds the bussiness logic (user, roles & stuff) to know which connection has to be used.\nNot sure if this solution is the right one, but still, this is the wrapper:\n```\nnamespace MyAwesome\\Bundle\\Doctrine\\Connection;\nuse Doctrine\\DBAL\\Connection;\nuse Doctrine\\DBAL\\Driver;\nuse Doctrine\\DBAL\\Event\\ConnectionEventArgs;\nuse Doctrine\\DBAL\\Events;\nuse MyAwesome\\Bundle\\Services\\DbSwitcher;\nclass DynamicConnection extends Connection\n{\n    /* @var DbSwitcher /\n    protected $dbSwitcher;\n/**\n * @var bool\n */\nprivate $_isConnected = false;\n\n/**\n * The parameters used during creation of the Connection instance.\n *\n * @var array\n */\nprivate $_params = array();\n\n/**\n * @param DbSwitcher $dbSwitcher\n */\npublic function setDbSwitcher(DbSwitcher $dbSwitcher)\n{\n    $this->dbSwitcher = $dbSwitcher;\n}\n\n/**\n * @inheritDoc\n */\npublic function connect()\n{\n    $container = $this->dbSwitcher->getContainer();\n\n    $connection = $container->get(sprintf('doctrine.dbal.sql.%s_connection', $this->dbSwitcher->getWorkingEntityManagerName()));\n\n    $this->_params = $connection->getParams();\n\n    if ($this->_isConnected) {\n        return false;\n    }\n\n    $driverOptions = isset($this->_params['driverOptions']) ?\n        $this->_params['driverOptions'] : array();\n    $user = isset($this->_params['user']) ? $this->_params['user'] : null;\n    $password = isset($this->_params['password']) ?\n        $this->_params['password'] : null;\n\n    $this->_conn = $this->_driver->connect($this->_params, $user, $password, $driverOptions);\n    $this->_isConnected = true;\n\n    if (false === $this->isAutoCommit()) {\n        $this->beginTransaction();\n    }\n\n    if ($this->_eventManager->hasListeners(Events::postConnect)) {\n        $eventArgs = new ConnectionEventArgs($this);\n        $this->_eventManager->dispatchEvent(Events::postConnect, $eventArgs);\n    }\n\n    return true;\n}\n\n}\n```\nAnd of course the proper CompilerPass to inject my own service to the Wrapper:\n```\nnamespace MyAwesome\\Bundle\\Doctrine\\DependencyInjection\\CompilerPass;\nuse Symfony\\Component\\DependencyInjection\\Compiler\\CompilerPassInterface;\nuse Symfony\\Component\\DependencyInjection\\ContainerBuilder;\nuse Symfony\\Component\\DependencyInjection\\Reference;\nclass DynamicConnectionCompilerPass implements CompilerPassInterface\n{\n    /*\n     * @inheritDoc\n     /\n    public function process(ContainerBuilder $container)\n    {\n        $container\n            ->getDefinition('doctrine.dbal.sql.dynamic_connection')\n            ->addMethodCall('setDbSwitcher', [\n                new Reference('myawesomebundle.dbswitcher')\n            ]);\n    }\n}\n```\nSorry for the long post, but I hope it help others.\nAny ideas would be welcome and thank you again!. This is happening to me too. Can't find a way to solve this.\nI'll try your solution @videni, thank you!\n. @antograssiot Thank you! I was missing that.\nCan't find or figure out how to configure the filter in YML format instead of Annotations. I'll answer my question for other users.\nTo enable the Group Filter as defined in the docs (https://api-platform.com/docs/core/filters#group-filter) but using YML format you should first register a Service, because the @ApiFilter annotation just do that.\nSo, here is an example of the service definition:\nservices:\n    my_entity.my_filter_name:\n        parent: 'api_platform.serializer.group_filter'\n        arguments: [ 'groups', true, null ] # parameters for __construct() method\n        tags: [ 'api_platform.filter' ]\nAnd this service now can be used as a Filter, just like the docs establishes: https://api-platform.com/docs/core/filters#basic-knowledge. ",
    "dleute": "I'm having a problem related to this. I followed the docs but get this: You must configure the check path to be handled by the firewall using form_login in your security firewall configuration.\nI however only care about API login, no form at all.\nCan you share your config? Or tell me how you solved it?. I believe the example above helped. I also stopped using fos user bundle I believe. Sorry, it was a long time ago and I am not actively working on that project. . Will the distribution be updated to use the flex structure? I chose to start my own app and add core because I didn't want to move to flex later. But I realized using all the pre-built container stuff requires me to go through and change paths, update docker files, update entry point scripts... etc.\nWill there be a branch already in flex layout?\nThanks!. I missed that. IT's in the API folders and such. Awesome. switching to master.. Docker for Mac is a different implementation. I typically use toolbox because I have other requirements. (Running kubernetes, and other container things, and need VM access).\nIt may work because it uses hyperkit which is different virtualization than a VM. I will try that, and see if I can get the two to co-exist.\nI would assume hyperkit uses the hosts networking more directly and that solves the problem. (unless I need other things on the ports the containers are launching).. Yeah, this would fail on windows too (unless docker there works more like docker for mac).\nThe \"easiest\" way to fix this for all is probably to setup a local port forward service that forwards all the localhost ports to the IP of your container VM. I know things like kubectl have that so you can see the admin ui from your local system. There is probably a cli way to do it with PHP. Haven't looked into it yet.\nIt's re-building the containers for Docker for Mac. I expect this will work.. Works fine with docker for mac so far.. That would probably break a thousand other things.. Any idea on if Docker for Windows works the same way? I am about to hand this code to someone who runs on windows. I'm hoping we don't have a proxy/localhost issue there.. Essentially, I have no idea what is driving the admin ui. I also just created a many to many relationship and it is treating it like a many to one, which, of course, fails.. I found the documentation on to-many relationships. I am still unclear on what I can solve with swagger context. Can I just put required false somewhere? (I am not Assert not blank anywhere). It looks like this may have been resolved by updating the admin to 0.2.0 instead of 0.15.x that it was using. Still verifying.. False alarm. still requiring all fields to have values regardless of the ORM setting.. I resolved this by updating the admin to 0.2 and the core to dev-master which solves both the required issue and to-many fields are implemented in the admin automatically.\n. Is login_check in check_path a route setup somewhere?\nI already implemented a version of this (which works) from here: https://symfony.com/doc/current/security/entity_provider.html\nI saw the other documentation, and it's not clear to me what the advantage of doing it that way is. They are both custom providers.\nThe problem is I only have authentication. I have no functionality to create users, promote users, deactivate users, public sign up. Etc.\nI was hoping for examples of the rest of those things. (Many of the things FOSUserBundle does for you).. It looks like the one I implemented is simply a doctrine provided version built for the DB. The custom one let's you use any provider that you want to build (for example, communicate with facebook or some other external user service).\nThe doctrine one is fine for me. So, I assume I need to setup some Action-Domain-Responders to setup API endpoints for sign-up, change password, reset password, etc. Following custom controllers here:\nhttps://api-platform.com/docs/core/operations#creating-custom-operations-and-controllers\nTo re-create some of FOSUserBundle's features this seems to be how it would be done:\nActive/Inactive: Serialize AdvancedUserInterface on the doctrine provider. Manage it with a dynamic \"admin_write\" group on the user class that is only available to users with an admin role, and allows them to write to the isActive field through normalization/denormalization.\nregister: allow users to POST to the User object collection. Ideally add an extension that requires them to verify that they are human (can't just create thousands of users rapidly). Not sure how to do that. Would love some feedback here.\ne-mail verification: Hook in via event system and send a verification e-mail every time a new user is created. Write the random verification key to the DB and send link to e-mail with key. Then have an ADR that accepts that and will enable/whatever it needs to the user once they hit the api with the verification code.\nupdate profile info: use access_control to allow the user (or admin role) to access/update their own record only. Also use normalization/denormalization groups to control what they can read/write on their own. Use dynamic normalization/denormalization groups to allow admin to change more about that user (same as isActive above)\nThis doesn't tell me how to get my lexik login_check api to show up in the swagger ui as an available api. But since I am building all the other tools, the will all have paths in swagger.\nThoughts? Any examples of doing this?. I copied your config exactly changing to my entity and I still get \"Unable to find the controller for path \"/login_check\". The route is wrongly configured.\". I figured it out: The example for lexik with curl isn't accurate (which should have been obvious). To make json work I had to add -H \"Content-Type: application/json\" to the curl command and send the data in json format.\nIt would be handy if someone added the example curl command to the lexik documentation page.\nI think all versions of authentication are now working. Having learned this much, I am inclined to work toward the doctrine entity provider/custom provider.. Not a problem! Honestly it forced me to learn how much of symfony 3/4 + api platform work. The authentication needs aren't really complicated, it just requires some knowledge of the underlying systems.. Closed.. Having an issue with this: Swagger UI is refusing to see the routes all of a sudden. So, while /users/register exists (and works), it doesn't show up in the swagger ui. (and it used to).\nIs there any debugging to look at why swagger doesn't display working API Resources?. Nevermind, figured that one out. route_name was wrong.. ",
    "sylflo": "@dleute I am not using FosUser but I am using json_loing instead of form_login, that's maybe what you need\n```\nfirewalls:\n        login:\n            pattern:  ^/login\n            stateless: true\n            anonymous: true\n            provider: our_db_provider\n            json_login:\n                check_path: /login_check\n                require_previous_session: false\n                username_path: 'username'\n                password_path: 'password'\n                success_handler: lexik_jwt_authentication.handler.authentication_success\n                failure_handler: lexik_jwt_authentication.handler.authentication_failure\n        dev:\n            pattern: ^/(_(profiler|wdt)|css|images|js)/\n            security: false\n        main:\n            pattern: ^/\n            anonymous: ~\n            provider: our_db_provider\n            lexik_jwt:\n                authorization_header: # check token in Authorization Header\n                    enabled: true\n                    prefix:  Bearer\n        # activate different ways to authenticate\n\n        # http_basic: ~\n        # https://symfony.com/doc/current/security.html#a-configuring-how-your-users-will-authenticate\n\n        # form_login: ~\n        # https://symfony.com/doc/current/security/form_login_setup.html\n\n```. Hello, I have the exact same problem as you, how did you solve it ?. Thanks you very much for your quick reply\nYeah I did it works for the get but I don't understand how it can work with the put/post.\nFor the get we can do something like that \n\"access_control\"=\"object.user.getId() == user.getId()\"\nBut for the put/post how to check that when the user send that \n\"firstName\": \"string\", .... \"user\": \"/users/1\",\nThat the id 1 is the id of the current user and not the id of an another user ?. Ok thanks it works by using access_control I did not realize it was possible to do object.user == user on all the request. \nThank you very much your time and clear explanations.. Yeah it has been removed, the doc was not updated on this part, you have to install behat yourself.\nIf you had look in the issues you would have found this\nhttps://github.com/api-platform/api-platform/issues/625. That would be really awesome, I am working on a big project with API Platform and even tough the documentation is pretty good (but outdated sometimes) having a fully complete example would be pretty awesome and useful.. It's not an hello world but it's pretty basic. I plan to do a complete example (users management, access_control, annotations...) in a few weeks.. I solved this issue by creating another route. One for updating the user profile and another one to change the password of the user. I am sorry for the incomplete code it's really too heavy, that's why I did not put it.\nBut I actually did not create any methods for my relationships since my attributes are public. But yeah it actually makes sense to create methods since you need it for a OneToOne relationship thanks to this issue https://github.com/api-platform/core/issues/1772. So I suppose it's kind of a little bit the same thing to do right ?\nI am sorry to bother you for such basic things, I will try this tonight and share the code tonight if I succeed. Thank you for your time. Thanks for your help, I really appreciate it I solved my problem like this\nin the rawArticleCategory class\n```\n public function getRawArticles()\n    {\n        return $this->rawArticles;\n    }\npublic function setRawArticles($rawArticles)\n{\n    $this->rawArticles = $rawArticles;\n    foreach ($rawArticles as $rawArticle)\n    {\n        if ($rawArticle->getCategory() !== $this)\n        {\n            $rawArticle->setCategory($this);\n        }\n    }\n}\n\n```\nit was really a newbie understanding on how Doctrine works. I hope it will help other people, thank you for your time. yeah it is, I will close this issue then. That was exactly this, I actually misconfigured the nginx pod. I added the files in the \"symfony/php\" pod but not in the nginx pod.\nThank you for your help. Ok thank you for your quick answer. ",
    "pesseyjulien": "Hi, \nSorry for the delay. Here is how I ended up doing it. Hope it can help !\n```\nsecurity:\n    encoders:\n        FOS\\UserBundle\\Model\\UserInterface: bcrypt\nrole_hierarchy:\n    ROLE_USER: ROLE_USER\n    ROLE_ADMIN: ROLE_ADMIN\n\nproviders:\n    db_provider:\n       entity:\n           class: AppBundle:User\n           property: email\n    fos_userbundle:\n       id: fos_user.user_provider.username_email\n\nfirewalls:\n\n    admin:\n         pattern: ^/admin\n         anonymous: ~\n         form_login:\n             provider:               fos_userbundle\n             login_path:             /admin/login\n             check_path:             /admin/login_check\n             always_use_default_target_path : true\n             default_target_path: /admin\n         logout_on_user_change: true\n         logout:\n             path:   /logout\n             target: /\n\n\n    login:\n          pattern:  ^/login_check\n          stateless: true\n          anonymous: true\n          provider: db_provider\n          form_login:\n              check_path:               /login_check\n              username_parameter: email\n              password_parameter: password\n              success_handler:          lexik_jwt_authentication.handler.authentication_success\n              failure_handler:          lexik_jwt_authentication.handler.authentication_failure\n              require_previous_session: false\n\n    api:\n          pattern:   ^/\n          stateless: true\n          anonymous: true\n          guard:\n              authenticators:\n                  - lexik_jwt_authentication.jwt_token_authenticator\n\n```. I managed differently, thanks anyway !. Hi,\nFirst result of 'serialization' search on the website (see enclosed).\nThanks,\nJulien\n\n. ",
    "Larzack": "I made a request here for full integration : https://github.com/api-platform/api-platform/issues/764. Need too :)\n. Issue explained here : https://github.com/api-platform/api-platform/issues/764\n. @dunglas , @teohhanhui  , any feedback ?. I think many persons would like this code. This is why I asked to implement It directly is the ApiPlatform example code. It's better to understand with a working example and then remove the code than produce doc.\nOnly persons with good skills can do this and this is the beginning of an API.\n99,9% of API are not opened ? Less ? More ?\nRegards. You can use my example if you want https://github.com/api-platform/api-platform/issues/796. Same issues. Is it possible to include addXXX (or setXXX ) dependancies in the generator for N-M classes ?. I added this on my php.ini file ( doc included )\n```\nXdebug\nhttps://blog.philipphauer.de/debug-php-docker-container-idea-phpstorm/\nxdebug.remote_autostart=1\nxdebug.remote_mode=req\nxdebug.remote_handler=dbgp\nxdebug.remote_connect_back=1\nxdebug.remote_port=9000\nxdebug.remote_enable=1\nxdebug.remote_host=gateway.docker.internal\nxdebug.idekey=PHPSTORM\nxdebug.remote_log=\"/tmp/xdebug.log\"\nFor MAC/Docker\nhttps://www.lionware.solutions/2017/10/19/setting-up-xdebug-docker-phpstorm/\nhttps://serversforhackers.com/c/getting-xdebug-working\nxdebug.remote_connect_back=0\nxdebug.remote_host=docker.for.mac.localhost\nEnd For MAC/Docker\n```\nAnd I added into docker-compose.yml \n```\nservices:\n  php:\n    ......\n    environment:\n      - PHP_IDE_CONFIG=serverName=Docker\n    ......    \n```\nAnd then I configured PHPStorm using \nDebug port = 9000\nAnd i mapped the host path to the docker path\nWe can remove the remote logs for performance if needed. @dunglas , in one of your presentations ( https://speakerdeck.com/dunglas/rest-vs-graphql-illustrated-examples-with-the-api-platform-framework?slide=31 ), you wrote that subscriptions are not supported in PHP.\n- This will be supported soon or not ?\n- Will APi-Platform support it natively ? Soon ?\nI'm going to make an App with GraphQL and Api-Platform, but I need subscriptions for chat.\nI prefer writing code in PHP but i don't know if I have to start with Api-platform and wait for Subscriptions or doing the BackEnd with NodeJS ( and I have to learn NodeJS )\nRegards\n. Just saw this : https://graphql.org/code/#php and Siler ( https://siler.leocavalcante.com/graphql/  and  http://webonyx.github.io/graphql-php/ ) \nhttps://symfony.fi/entry/graphql-with-php-and-the-symfony-framework\n. ",
    "hotgeart": "Show us your JSON you tried to post.. ",
    "TangMonk": "Yes, I am using Symfony 4 now, it works great with api-platform. ",
    "jewome62": "@dleute master branch use curently the new flex structure. That work currently.\nhttps://api-platform.com/docs/core/angularjs-integration\nhttps://api-platform.com/docs/client-generator/vuejs. Hello @pesseyjulien,\nWhere do you found this link ?\nI have find this link https://api-platform.com/docs/core/serialization#the-serialization-context-groups-and-relations\nthat's what you were looking for ?. Bug was fixed. hello @Dannebicque \nCan you remove JsonResponse object and just return the object or array. The serializer serialize step by step.\nIf your array, collection or properties order is the same, the serialization will be the same.. I see this article to implement Elasticsearch with api platform\nhttps://hugo-soltys.com/blog/use-api-platform-with-elasticsearch-instead-of-doctrine-in-your-symfony-application. Hello @Gothdroid33 \nIt 's not api-platform bug.\nYou must configure your docker to work with your network.\nFor this, you can edit /etc/default/docker with your proxy config\n```\nIf you need Docker to use an HTTP proxy, it can also be specified here.\nexport http_proxy=\"http://127.0.0.1:3128/\"\n```. :+1:  I have see on the last release the time to build grow up.\nI can't wait to be merged . Hello,\nYou can copy SearchFilter with custom filter to adapt with content of DateFilter\n/vendor/api-platform/core/src/Bridge/Doctrine/Orm/Filter/SearchFilter.php\n/vendor/api-platform/core/src/Bridge/Doctrine/Orm/Filter/DateFilter.php. You can create a custom filter https://api-platform.com/docs/core/filters/#creating-custom-filters\nto apply a new where with your condition.\nInto condition, you can handle the value's filter to add a fallback language. Done.\nTest added. Why add NL here ? (and the others lines). What is the advantage to do this ? can you explain the difference ?. This is a useless file for ApiPlatform.\nThe templating dir is here because symfony\\template is need for dev version (it should be for profiler)\nMaybe replace by a .gitkeep file ?. Hello,\nI understand the explanation.\nbut git can be used for composer\n(edit : sorry i not see in the diff you have let git). ",
    "lyrixx": ":+1:  I confirm it's working.\nThanks for the tip. ",
    "nWidart": "Nice this worked for me too.\nBefore:\nyaml\n    swagger:\n         api_keys:\n             - { name: 'Authorization', type: 'header' }\nAfter:\nyaml\n    swagger:\n        api_keys:\n            apiKey:\n                name: \"Authorization\"\n                type: \"header\". ",
    "sandoche": "Do you know when \"maxDepth\" will be released, even in \"dev-master\"?. I finally managed by using MaxDepth like this:\n```\nuse Symfony\\Component\\Serializer\\Annotation\\MaxDepth;\n...\n\n@ApiResource(\nattributes={\n\"filters\"={\"user.search_filter\"},\n\"normalization_context\"={\"groups\"={\"profile\"}, \"enable_max_depth\"=\"true\"}\n},\n\n...\n/**\n * @ORM\\OneToMany(targetEntity=\"App\\Entity\\Contact\", mappedBy=\"teacher\")\n * @ORM\\JoinColumn\n * @Groups({\"contactProfile\"})\n * @MaxDepth(1)\n */\nprivate $contactsAsTeacher;\n\n```. ",
    "gelinger777": "thanks will check that. But there is no something ready plug-and-play. Right? . forget it . Thank you for your help. . ",
    "jibla": "Ah, that's absolutely right. Its not part of the apiplatform core. Thanks, will close the issue.. ",
    "k911": "I've had an similar issue, and got a headache while debugging. \nMy stack: PHP 7.2 fpm alpine, nginx, varnish 4, symfony 4\nThe problem is surprisingly caused by upgrade to symfony 3.4/4.0, exactly these lines being executed: \nhttps://github.com/symfony/symfony/commit/2c0dc745d63bfe227db07d4bb74adc47d585d950#diff-d29419a0d7043fce54a98005c26a82aa\nResulting in response containing these headers:\n...\nCache-Control: max-age=0, private, must-revalidate\nVary: Accept\nVary: Authorization\nX-Content-Type-Options: nosniff\nX-Frame-Options: deny\nCache-Control: max-age=0, public, s-maxage=3600\n...\nas you can see 'cache-control' header is duplicated here, and first entry is obviously undesirable due to 'private', which prevent caching response...\nSolution is to add this config in symfony application.\nparameters:\n   session.storage.options:\n        cache_limiter: 0\nBut I don't know if that solution apply here.. Yes, I'm using API Platform but I've used other bundles too. \nLike FOS User and Easy Admin (for development purposes, in long term should be replaced by api-platform/admin). Anyway, I use normal (session based) login on firewall with /admin path, and general firewall / is stateless, so I would expect that only /admin routes should use session, and send those headers.\nUnless of course, I've messed up security configuration: https://github.com/knit-pk/api-v1-php/blob/develop/config/packages/security.yaml\nYes, on symfony 3.3 (with flex, but probably irrelevant), it worked just right.. ",
    "timotheemoulin": "Oh, my bad. I've been wronged by the last commit on master (Merge branch '2.1')\nI'll check that and come back if needed.. ",
    "elvismdev": "@dunglas I'm having this same issue, with an Order entity that has a relationship with User entity. \nHere part of my error:\n{\n    \"@context\": \"/api/contexts/Error\",\n    \"@type\": \"hydra:Error\",\n    \"hydra:title\": \"An error occurred\",\n    \"hydra:description\": \"A circular reference has been detected when serializing the object of class \\\"App\\\\Entity\\\\User\\\" (configured limit: 1)\",\n    \"trace\": [\n        {\n            \"namespace\": \"\",\n            \"short_class\": \"\",\n            \"class\": \"\",\n            \"type\": \"\",\n            \"function\": \"\",\n            \"file\": \"/home/elvismdev/WWW/my-symfony-app/vendor/symfony/serializer/Normalizer/AbstractNormalizer.php\",\n            \"line\": 255,\n            \"args\": []\n        },\n...\nOrder entity is marked with @ApiResource but User is not. I don't need/want to make User an API resource, only Order. It seems to me that I have to register a circular reference handler by myself following the symfony docs here: https://symfony.com/doc/current/components/serializer.html#handling-circular-references\nHowever, I'm a bit lost around how or where I should put the custom callable code following the example there:\n```php\n$encoder = new JsonEncoder();\n$normalizer = new ObjectNormalizer();\n// all callback parameters are optional (you can omit the ones you don't use)\n$normalizer->setCircularReferenceHandler(function ($object, string $format = null, array $context = []) {\n    return $object->getName();\n});\n$serializer = new Serializer([$normalizer], [$encoder]);\nvar_dump($serializer->serialize($org, 'json'));\n// {\"name\":\"Les-Tilleuls.coop\",\"members\":[{\"name\":\"K\\u00e9vin\", organization: \"Les-Tilleuls.coop\"}]}\n```\nCould you provide some more context or an example where that would go?\nIf that's useful, here are my Order and User entities:\n```php\n<?php\n// src/Entity/Order.php\nnamespace App\\Entity;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Gedmo\\Mapping\\Annotation as Gedmo;\nuse Symfony\\Component\\Validator\\Constraints as Assert;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\n/\n * @ApiResource\n * @ORM\\Table(name=\"order\")\n * @ORM\\Entity(repositoryClass=\"App\\Repository\\OrderRepository\")\n */\nclass Order\n{\n    /\n     * @ORM\\Id()\n     * @ORM\\GeneratedValue()\n     * @ORM\\Column(type=\"integer\")\n     */\n    private $id;\n/**\n * @ORM\\Column(type=\"string\", length=7)\n * @Assert\\NotBlank(message=\"order_form_validation_msg.telephone\")\n * @Assert\\Type(type=\"numeric\", message=\"order_form_validation_msg.telephone_num_only\")\n * @Assert\\Length(\n *      min=7,\n *      max=7,\n *      exactMessage=\"order_form_validation_msg.only_seven_digits\"\n * )\n */\nprivate $telephone;\n\n/**\n * @Gedmo\\Timestampable(on=\"create\")\n * @ORM\\Column(type=\"datetime\")\n */\nprivate $createdAt;\n\n/**\n * @Gedmo\\Timestampable(on=\"update\")\n * @ORM\\Column(type=\"datetime\")\n */\nprivate $updatedAt;\n\n/**\n * @ORM\\ManyToOne(targetEntity=\"App\\Entity\\User\", inversedBy=\"orders\")\n * @ORM\\JoinColumn(nullable=false)\n */\nprivate $author;\n\n/**\n * @ORM\\Column(type=\"integer\")\n */\nprivate $salePrice;\n\n/**\n * @ORM\\Column(type=\"decimal\", precision=10, scale=2)\n */\nprivate $commision;\n\n/**\n * @ORM\\Column(type=\"string\", length=255)\n */\nprivate $status;\n\n/**\n * @ORM\\ManyToOne(targetEntity=\"App\\Entity\\TopUpPackage\", inversedBy=\"orders\")\n * @ORM\\JoinColumn(nullable=false)\n */\nprivate $topUpPackage;\n\n/**\n * @ORM\\Column(type=\"integer\")\n */\nprivate $reloadlyTxID;\n\n/**\n * @ORM\\Column(type=\"string\", length=255)\n */\nprivate $sentVia;\n\n\npublic function getId(): ?int\n{\n    return $this->id;\n}\n\npublic function getTelephone(): ?string\n{\n    return $this->telephone;\n}\n\npublic function setTelephone(?string $telephone): self\n{\n    $this->telephone = $telephone;\n\n    return $this;\n}\n\npublic function getCreatedAt(): ?\\DateTimeInterface\n{\n    return $this->createdAt;\n}\n\npublic function setCreatedAt(\\DateTimeInterface $createdAt): self\n{\n    $this->createdAt = $createdAt;\n\n    return $this;\n}\n\npublic function getUpdatedAt(): ?\\DateTimeInterface\n{\n    return $this->updatedAt;\n}\n\npublic function setUpdatedAt(\\DateTimeInterface $updatedAt): self\n{\n    $this->updatedAt = $updatedAt;\n\n    return $this;\n}\n\npublic function getAuthor(): ?User\n{\n    return $this->author;\n}\n\npublic function setAuthor(?User $author): self\n{\n    $this->author = $author;\n\n    return $this;\n}\n\npublic function getSalePrice(): ?int\n{\n    return $this->salePrice;\n}\n\npublic function setSalePrice(int $salePrice): self\n{\n    $this->salePrice = $salePrice;\n\n    return $this;\n}\n\npublic function getCommision()\n{\n    return $this->commision;\n}\n\npublic function setCommision($commision): self\n{\n    $this->commision = $commision;\n\n    return $this;\n}\n\npublic function getStatus(): ?string\n{\n    return $this->status;\n}\n\npublic function setStatus(string $status): self\n{\n    $this->status = $status;\n\n    return $this;\n}\n\npublic function getTopUpPackage(): ?TopUpPackage\n{\n    return $this->topUpPackage;\n}\n\npublic function setTopUpPackage(?TopUpPackage $topUpPackage): self\n{\n    $this->topUpPackage = $topUpPackage;\n\n    return $this;\n}\n\npublic function getReloadlyTxID(): ?int\n{\n    return $this->reloadlyTxID;\n}\n\npublic function setReloadlyTxID(int $reloadlyTxID): self\n{\n    $this->reloadlyTxID = $reloadlyTxID;\n\n    return $this;\n}\n\npublic function getSentVia(): ?string\n{\n    return $this->sentVia;\n}\n\npublic function setSentVia(string $sentVia): self\n{\n    $this->sentVia = $sentVia;\n\n    return $this;\n}\n\n/**\n * @return string\n */\npublic function __toString() : string\n{\n    return $this->getId() . ' - (+535)' . $this->getTelephone();\n}\n\n}\nphp\n<?php\n// src/Entity/User.php\nnamespace App\\Entity;\nuse Doctrine\\Common\\Collections\\ArrayCollection;\nuse Doctrine\\Common\\Collections\\Collection;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse FOS\\UserBundle\\Model\\User as BaseUser;\nuse Symfony\\Component\\Validator\\Constraints as Assert;\n/*\n * @ORM\\Entity\n * @ORM\\Table(name=\"user\")\n /\nclass User extends BaseUser {\n/**\n * @ORM\\Id\n * @ORM\\GeneratedValue(strategy=\"AUTO\")\n * @ORM\\Column(type=\"integer\")\n */\nprotected $id;\n\n/**\n * @ORM\\OneToMany(targetEntity=\"App\\Entity\\Order\", mappedBy=\"author\")\n */\nprivate $orders;\n\n/**\n * @ORM\\Column(type=\"integer\", nullable=true)\n */\nprivate $resellerAddedValue;\n\npublic function __construct()\n{\n    parent::__construct();\n    $this->orders = new ArrayCollection();\n}\n\n\n/**\n * @return int\n */\npublic function getId() {\n    return $this->id;\n}\n\n/**\n *  Override setEmail method from FOSUserBundle.\n * @param string $email\n * @return object\n */\npublic function setEmail($email) {\n    // We will no require usernames to users. they will login and register with email only.\n    $this->setUsername($email);\n\n    return parent::setEmail($email);\n}\n\n/**\n * @return Collection|Order[]\n */\npublic function getOrders(): Collection\n{\n    return $this->orders;\n}\n\npublic function addOrder(Order $order): self\n{\n    if (!$this->orders->contains($order)) {\n        $this->orders[] = $order;\n        $order->setAuthor($this);\n    }\n\n    return $this;\n}\n\npublic function removeOrder(Order $order): self\n{\n    if ($this->orders->contains($order)) {\n        $this->orders->removeElement($Order);\n        // set the owning side to null (unless already changed)\n        if ($order->getAuthor() === $this) {\n            $order->setAuthor(null);\n        }\n    }\n\n    return $this;\n}\n\npublic function getResellerAddedValue(): ?int\n{\n    return $this->resellerAddedValue;\n}\n\npublic function setResellerAddedValue(int $resellerAddedValue): self\n{\n    $this->resellerAddedValue = $resellerAddedValue;\n\n    return $this;\n}\n\n}\n```. ",
    "o-rel": "@Rebolon Have you find a fix ? I'm running on the same situation and even api_doc routes produce 404, which is annoying/blocking for testing with the admin app. Have you the same issue on those routes by the way ?\nThanks.\nEdit : I was using php built-in server, since I've set up a nginx server and everything seems working.. ",
    "bierdok": "Add those lines like Silex documentation suggests\npublic/index.php\n```\n<?php\n$filename = DIR.preg_replace('#(\\?.*)$#', '', $_SERVER['REQUEST_URI']);\nif (php_sapi_name() === 'cli-server' && is_file($filename)) {\n    return false;\n}\n...\n```\nRun the built-in server:\n$ php -S localhost:8000 -t public index.php\nVoila!. Another solution more simple would be to use Symfony's one: https://symfony.com/doc/master/setup/built_in_web_server.html. ",
    "luchianenco": "@Dannebicque thank you for the hint\nWhen I send like this it works and country in DB is as FK to Country table\n{\n  \"firstName\": \"Serge\",\n  \"lastName\": \"Luchianenco\",\n  \"password\": \"123\",\n  \"email\": \"e@mail.com\",\n  \"country\": \"/countries/1\",\n  \"displayedName\": \"Serge\"\n}\nthx again. @Saphyel I have thought about this too, but I do not want to make Entity dependant on UserPasswordEncoderInterface. I think Entity should be without any external dependency, it should only keep data not to create them.. ok...I came to solution to overwrite the post controller for my User entity\n\nI create new route for post action\nadded annotation for collectionOperations in User entity\ncreated new controller in symfony style and updated the created entity with encoded password there\n\nhope this is the correct way ;). @Alexandre-T I have thought about the listener, and what I don't like that your listener is subscribed for every doctrine event. In my opinion password encoding should be only when User is created and updated. That is all, and Controller as external layer is right place for some dependencies.\nOr ... there is another way, trigger in the Controller an event for PasswordEncodeListener. \n. ",
    "Alexandre-T": "I use a hash password listener implementing Event suscriber which (I think) it is a better practice. Controller, Action and Entity are not dependant of the User Password Encoder. You can use any encoder. I am using bcrypt, and I can change when I want without changing any code.\n```\n/\n * Hash Password Listener.\n \n * @author   Alexandre Tranchant alexandre.tranchant@gmail.com\n/\nclass HashPasswordListener implements EventSubscriber\n{\n    /\n     * Password encoder.\n     \n     * @var UserPasswordEncoderInterface\n     /\n    private $passwordEncoder;\n/**\n * HashPasswordListener constructor.\n *\n * @param UserPasswordEncoderInterface $passwordEncoder\n */\npublic function __construct(UserPasswordEncoderInterface $passwordEncoder)\n{\n    $this->passwordEncoder = $passwordEncoder;\n}\n\n/**\n * Subscribes to prePersist and preUpdate Events.\n *\n * @return array\n */\npublic function getSubscribedEvents()\n{\n    return ['prePersist', 'preUpdate'];\n}\n\n/**\n * On PrePersist event.\n *\n * @param LifecycleEventArgs $args\n */\npublic function prePersist(LifecycleEventArgs $args)\n{\n    $entity = $args->getEntity();\n    if (!$entity instanceof Player) {\n        return;\n    }\n\n    $this->encodePassword($entity);\n}\n\n/**\n * On PreUpdate event.\n *\n * @param LifecycleEventArgs $args\n */\npublic function preUpdate(LifecycleEventArgs $args)\n{\n    $entity = $args->getEntity();\n    if (!$entity instanceof Player) {\n        return;\n    }\n    $this->encodePassword($entity);\n    // necessary to force the update to see the change\n    $em = $args->getEntityManager();\n    $meta = $em->getClassMetadata(get_class($entity));\n    $em->getUnitOfWork()->recomputeSingleEntityChangeSet($meta, $entity);\n}\n\n/**\n * Encode password.\n *\n * @param Player $entity\n */\nprivate function encodePassword(Player $entity)\n{\n    if (!$entity->getPlainPassword()) {\n        return;\n    }\n    $encoded = $this->passwordEncoder->encodePassword(\n        $entity,\n        $entity->getPassword()\n    );\n    $entity->setPassword($encoded);\n}\n\n}\n```\nI was using a plainPassword as you can see in encodePassword method. But I encounter a bug with Assertion Constraint in the User entity when I verified that plainPassword was not Blank. Constraint exception was thrown even if I provide a plainPassword. \nHere is the declaration of my service in the service.yaml file\n```\n# Doctrine event subscribers\nApp\\Doctrine\\EventSubscriber\\:\n    resource: '../src/Doctrine/EventSubscriber'\n    autowire: true\n    tags:\n        - { name: doctrine.event_subscriber }\n\n```. I now understand what you mean. I think your solution is better than mine. Controller is the right place for some dependencies. If you want to load PasswordEncoderListener only when necessary, I see two solutions : \n You could create a controller in symfony style calling PasswordEncoderListener. This controller should only have these two actions, one for creation, one for changing password. (your solution)\n You could create two actions in api-platform and ADR Action-domain-responder style. (mainteners solution (I think))\nhttps://api-platform.com/docs/core/operations#creating-custom-operations-and-controllers. What happened if you replace new \\Datetime() by new \\DateTime() ?\nI think you should have a look on Gedmo Timestampable doctrine extension which will initialize your update and creation field without any code. . I'm very surprised by the datetime format returned by your api. Here is an example of a get id in my api : \n{\n    (.....)\n    \"created\": \"2018-01-04T11:24:14.432Z\",\n    \"validated\": \"2018-01-04T11:42:14.123Z\",\n    \"description\": \"some text\",\n    \"name\": \"string\",\n  }\nIs there an event or a DI which is modifying your datetime properties?. ",
    "ntomka": "I think the best way is @luchianenco's way. Here's how I managed it to work:\nThe entity\n```PHP\n// src/Entity/User.php\nnamespace App\\Entity;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Component\\Security\\Core\\User\\AdvancedUserInterface;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse Symfony\\Component\\Serializer\\Annotation\\Groups;\n/*\n * @ORM\\Table(name=\"hd_users\")\n * @ORM\\Entity(repositoryClass=\"App\\Repository\\User\")\n * @ApiResource(\n *  attributes={\n *      \"normalization_context\"={\"groups\"={\"user\", \"user-read\"}},\n *      \"denormalization_context\"={\"groups\"={\"user\", \"user-write\"}}\n *  }, itemOperations={\n *      \"get\",\n *      \"delete\",\n *      \"put\"={\"route_name\"=\"api_users_put\"}\n *  }, collectionOperations={\n *      \"get\",\n *      \"post\"={\"route_name\"=\"api_users_post\"}\n *  }\n * )\n /\nclass User implements AdvancedUserInterface, \\Serializable\n{\n    // ...\n}\n```\nThe controller\n```PHP\nnamespace App\\Controller;\nuse App\\Entity\\User;\nuse Symfony\\Component\\Routing\\Annotation\\Route;\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\Controller;\nuse Symfony\\Component\\Security\\Core\\Encoder\\UserPasswordEncoderInterface;\n/\n * @Route(\"/api\")\n */\nclass UserController extends Controller\n{\n    /\n     * @Route(\n     *     name=\"api_users_post\",\n     *     path=\"/users\",\n     *     methods={\"POST\"},\n     *     defaults={\n     *         \"_api_resource_class\"=User::class,\n     *         \"_api_collection_operation_name\"=\"post\"\n     *     }\n     * )\n     */\n    public function postAction(User $data, UserPasswordEncoderInterface $encoder): User\n    {\n        return $this->encodePassword($data, $encoder);\n    }\n/**\n * @Route(\n *     name=\"api_users_put\",\n *     path=\"/users/{id}\",\n *     requirements={\"id\"=\"\\d+\"},\n *     methods={\"PUT\"},\n *     defaults={\n *         \"_api_resource_class\"=User::class,\n *         \"_api_item_operation_name\"=\"put\"\n *     }\n * )\n */\npublic function putAction(User $data, UserPasswordEncoderInterface $encoder): User\n{\n    return $this->encodePassword($data, $encoder);\n}\n\nprotected function encodePassword(User $data, UserPasswordEncoderInterface $encoder): User\n{\n    $encoded = $encoder->encodePassword($data, $data->getPassword());\n    $data->setPassword($encoded);\n\n    return $data;\n}\n\n}\n```\nThis simply overrides the default behavior with password hashing.. ",
    "TrogWarZ": "@Dannebicque, hey, did you find solution? I have same problem with Enum in my Entity.\nTried to use default_constructor_arguments in my custom EnumNormalizer but with no luck.. ",
    "merizoto": "Thank you for your answer, helped me so much. \nBut something is missing in the documentation, how can i use a custom parameter like slug instead of the id?\nIn my case, i create a custom action in order to handle that specific case:\n```php\n<?php\nnamespace AppBundle\\Action;\nuse Sensio\\Bundle\\FrameworkExtraBundle\\Configuration\\Method;\nuse Symfony\\Component\\Routing\\Annotation\\Route;\nuse AppBundle\\Entity\\Offer;\n/\n * Class OfferSlug\n \n * @package AppBundle\\Action\n /\nclass OfferSlug\n{\n    /\n     * @Route(\n     *     name=\"offer_slug\",\n     *     path=\"/offer/by-slug/{slug}\",\n     *     defaults={\"_api_resource_class\"=Offer::class, \"_api_item_operation_name\"=\"slug\"}\n     * )\n     * @Method(\"GET\")\n     * @return Offer|null\n     */\n    public function __invoke($data)\n    {\n        return $data;\n    }\n}\n```\nAnd a new item provider as well in order to override api platform own logic :\n```php\n<?php\nnamespace AppBundle\\DataProvider;\nuse ApiPlatform\\Core\\DataProvider\\ItemDataProviderInterface;\nuse AppBundle\\Entity\\Offer;\nuse AppBundle\\Repository\\OfferRepository;\nuse Doctrine\\ORM\\EntityManagerInterface;\n/\n * Class OfferItemDataProvider\n \n * @package AppBundle\\DataProvider\n /\nfinal class OfferItemDataProvider implements ItemDataProviderInterface\n{\n    private $entityManager;\n/**\n * OfferItemDataProvider constructor.\n *\n * @param EntityManagerInterface $entityManager\n *\n */\npublic function __construct(EntityManagerInterface $entityManager)\n{\n    $this->entityManager   = $entityManager;\n}\n\n/**\n * Retrieves an item.\n *\n * @param string      $resourceClass\n * @param string  $slug\n * @param string|null $operationName\n * @param array       $context\n *\n * @return null|object\n */\npublic function getItem(string $resourceClass, $slug, string $operationName = null, array $context = [])\n{\n    return $this->entityManager->getRepository(Offer::class)->getOfferBySlug($slug);\n}\n\n}\n```\nI registered this operation in my entity within ApiResource annotation, my new operation is well created and my route worked very well. But the only parameter asked is id instead of slug, what did i miss? \n. Thank you so much.\nFor those who are interested in it, here is the code of the custom provider:\nFirst, i use autowiring to inject requestStack as mentionned above and anything i need in my provider\n```php\n    private $entityManager;\n    private $requestStack;\n/**\n * OfferItemDataProvider constructor.\n *\n * @param EntityManagerInterface $entityManager\n * @param RequestStack           $requestStack\n */\npublic function __construct(EntityManagerInterface $entityManager, RequestStack $requestStack)\n{\n    $this->entityManager   = $entityManager;\n    $this->requestStack = $requestStack;\n}\n\n```\nAnd for the getItem method:\n```php\n/\n     * Retrieves an offer.\n     \n     * @param string      $resourceClass\n     * @param string  $slug\n     * @param string|null $operationName\n     * @param array       $context\n     \n     * @return null|Offer\n     */\n    public function getItem(string $resourceClass, $slug, string $operationName = null, array $context = [])\n    {\n        $request = $this->requestStack->getCurrentRequest();\n        $slug = $request->attributes->get('slug');\n    return $this->entityManager->getRepository(Offer::class)->getOfferBySlug($slug);\n}\n\n``` \nI may have an another question. This allow us to declare multiple custom providers as services. Assuming that i want to retrieve a specific resource (eg article) with a custom provider, again; how can i bind that specific provider to this entity? I do not want my offer provider to be used for my article entity. According to the doc, it looks like providers are only called by a priority system \n\nThe optional attribute priority allows to define the order in which the data providers are called.\n\nQuentin\n. Ok, does it mean that atm providers can only be managed by priority?\nSupposed i have two specific itemOperations for the same resource, both requiring a custom provider\n\neg:\n/article/by-slug/{slug}\narticle/last\n\nProvider with highest priority is going to be called in both cases, am i right?\n. Ok thanks @soyuka for your help ! \ud83d\udc4d . ",
    "jon-ht": "Hi,\nWhy don't you use AP core pagination ? https://api-platform.com/docs/core/pagination. When I set page=0 I get \"LIMIT argument offset=-30 is not valid\" (AP/core v2.1.4). \nWhich version do you use ? With v2.1.4 I spotted https://github.com/api-platform/core/blob/v2.1.4/src/Bridge/Doctrine/Orm/Extension/PaginationExtension.php#L89\nBut this seems to be fixed on master branch https://github.com/api-platform/core/blob/master/src/Bridge/Doctrine/Orm/Extension/PaginationExtension.php#L106. I think this is more a bug with your filter.\nWith these lines\nphp\n$queryBuilder\n        ->andWhere(sprintf('o.%s = :%s', $property, $parameterName))\n        ->setParameter($parameterName, $value);\nyou're saying \"where issue.page = $value\". I'm not sure that's what you want. Maybe I didn't understand your problem. \nWhat's the purpose of your filter ?\nWhat do you mean by changing page parameter ? Did you change the name or the value passed through SwaggerUI ?. Hello,\nI'm working with AP 2.1.5 and my config files are under src/Resources/config/api_resources\nThen you can have a file per entity with the following structure:\n```yaml\nsrc/Resources/config/api_resources/market.yaml\nresources:\n    App\\Entity\\Market:\n        attributes:\n            pagination_items_per_page: 10\n            filters:\n                - name.search_filter\n                - all_fields.order_filter\n        properties:\n            categories:\n                subresource:\n                    resourceClass: 'App\\Entity\\MarketCategory'\n                    collection: true\n        collectionOperations: ~\n        itemOperations: ~\n```\nNotes that all entities namespaces must be under resources key. Latest Docker for Windows (atm). I have some news about this issue. It looks like my anti-virus, Kaspersky, was blocking docker connection. If I disable the protection, I'm able to up all services and access services endpoints.\nAs long as my anti-virus is suspended, I can navigate through differents UI. \nI ended up by edit my firewall rules to set docker connection as safe connection. I'll try as soon as possible. However, I never contributed to open source projects, do you have some recommandations ?. I'll take a look, thanks!. Sorry for the late answer. After a week of investigation, I'm still not able to start services. I don't know why it worked once, and then nothing... Maybe the bug isn't related to AP but Docker. Can't find any issue on it. Exactly the same as described in OP. Services start and then down with exit code 255 or 1 (and sometimes 12x, but not sure). @Simperfit I'll try this week and keep you up-to-date. Sad news, I'm still not able to start services (except for db and sometimes api doesn't exit).\nI upgraded Docker for Windows to version 18.03.0-ce, build 0520e24, but same result... I don't know where to look.\nI tried :\n- Clear Docker images\n- Update Docker for Windows tool\n- Set up Kaspersky firewall rules for virtual hosts\n- Change ports from docker-compose.yml\nAny idea ?. Exactly the same. @teohhanhui I saw that env param, it's referenced in AP doc. I didn't set this value for AP 2.2.5 but I'm sure I've tried with 2.2.4. I'll try this !. OK, really weird. I installed AP 2.2.5 on another computer running on Windows 10 too and all worked fine, without COMPOSE_CONVERT_WINDOWS_PATHS=1. Files are encoded using LF.\nUse COMPOSE_CONVERT_WINDOWS_PATHS=1 doesn't work...\nI tried to move project to different local drives (C:, P:, S:) and I always cleared all Docker images between each docker-compose up -d. I'm using Docker for Windows and I've uninstalled/installed the latest version. I don't understand what happend but I've finally succeeded to make it work with this : https://stackoverflow.com/questions/42203488/settings-to-windows-firewall-to-allow-docker-for-windows-to-share-drive/43904051#43904051\n\nIn PowerShell granted as admin\nSet-NetConnectionProfile -interfacealias \"vEthernet (DockerNAT)\" -NetworkCategory Private\n\nBut I'm not sure about that. I've rebooted my PC and it doesn't work anymore. I think this is more related to a missconfiguration of my PC (firewall/Kaspersky/wamp even if turned off, maybe) rather than AP. Maybe you need to define denormalization_context attribute. ",
    "asimonf": "@dunglas seeing as the PR didn't get anywhere and this doesn't seem to be getting anywhere on the Symfony issue, what is the proper course of action here to get it fixed mainline?. ",
    "mappedinn": "The declaration of the route of the custom operation can only be through yaml file. In fact, the use of annotation will not allow us to get the correct order of routes. The route of the custom operation must come after the declaration of the route api_platform.\napi_platform:\n    resource: .\n    type: api_platform\n    prefix: /api\n\napi_product_slug:\n    path: '/api/products/by-slug/{slug}'\n    methods:  ['GET']\n    defaults:\n        _controller: App\\Controller\\ProductController:productsGetBySlugAction\n        _api_resource_class: 'App\\Entity\\Product'\n        _api_collection_operation_name: 'product_slug'\n\n. For item operation, {id} is compulsory and it must be in the route. But for my case, I am not using it. I am using {slug}. That is why I am getting the error.. @dunglas @theofidry  @soyuka I need just to my understanding by yes or no.\nThanks.... > Reading this post for the first time and this makes I don't really want to answer now... Just a reminder this is an open source project and everyone is there on his own free time.\nThank you so much for your time. I appreciate.\n\nYou don't have to but you can. Your implementation looks correct. If you want to use a by-slug operation on many resources you may just use the same data provider. I'd implement an interface (eg SluggedEntityInterface) and you could test is_subclass_of($request->attributes->get('_api_resource_class'), SluggedEntityInterface::class).\n\nI will implement your test  & I will give my feedback.\nThanks again. I am back again with my feed back @soyuka \n\nYou don't have to but you can. Your implementation looks correct. If you want to use a by-slug operation on many resources you may just use the same data provider. I'd implement an interface (eg SluggedEntityInterface) and you could test is_subclass_of($request->attributes->get('_api_resource_class'), SluggedEntityInterface::class).\n\nThe test is_subclass_of($request->attributes->get('_api_resource_class') is same as testing Product::class !== $resourceClass\n\nTo make sure that collection data provider ProductCollectionDataProvider is only called for the operation product_slug (my custom operation), I just added a simple test $operationName === 'product_slug'\nThe code became then:\n```php\nfinal class ProductCollectionDataProvider implements CollectionDataProviderInterface {\n// ...\n    /\n     * Retrieves a collection.\n     \n     * @param string      $resourceClass\n     * @param string|null $operationName\n     \n     * @throws ResourceClassNotSupportedException\n     \n     * @return array|\\Traversable\n     /\n    public function getCollection(string $resourceClass, string $operationName = null) {\n    if (Product::class !== $resourceClass) {\n        throw new ResourceClassNotSupportedException();\n    }\n\n    $slug = $this->requestStack->getCurrentRequest()->attributes->get('slug');\n    $this->logger->info(\"*****************getCollection() is called******************\");\n    $this->logger->info(\"(*) operationName='$operationName', resourceClass='$resourceClass', slug='$slug'\");\n\n\n    if ($operationName === 'product_slug') {\n         $this->logger->info(\"(IF) operationName=$operationName\");\n        $product = $this->repository->findProductBySlug($slug);\n        if ($product === null) {\n            throw new NotFoundHttpException(sprintf('The Product resource \\'%s\\' was not found.', $slug));\n        }\n        return $product;\n    } else {\n        $this->logger->info(\"(ELSE) operationName=$operationName\");\n        return $this->repository->findAll();\n    };\n}\n\n}\n```\nThe result surprised me. For just one call to the custom operation, the method getCollection() got called twice.\nFor the first call, the parameters are correct:\n\noperationName='product_slug'\nresourceClass='App\\Entity\\Product'\nslug='iphone-x'\n\nBut, for the second call, not all the parameters are correct:\n\noperationName=''\nresourceClass='App\\Entity\\Product'\nslug='iphone-x'\n\nBelow is what the @logger showed.\n```\nINFO05:35:57 | app | **getCollection() is called**\nINFO05:35:57 | app | () operationName='product_slug', resourceClass='App\\Entity\\Product', slug='iphone-x'\nINFO05:35:57 | app | (IF) operationName=product_slug\nINFO05:35:57 | app | **getCollection() is called**\nINFO05:35:57 | app | () operationName='', resourceClass='App\\Entity\\Product', slug='iphone-x'\nINFO05:35:57 | app | (ELSE) operationName=\nCRITICAL05:18:19 | request | Uncaught PHP Exception ApiPlatform\\Core\\Exception\\InvalidArgumentException: \"Unable to generate an IRI for\u00a0\"App\\Entity\\Product\".\" at /home/amine/docker-projects/sf-flex-40/vendor/api-platform/core/src/Bridge/Symfony/Routing/IriConverter.php line 116\n-- | -- | --\n```\nThe question is: Is it normal to get for just one API call  two calls to the collection data provider? Is it a bug?\nMerci beaucoup @soyuka for your feedback\n. I just wanted to to notice that avoiding testing against the operation name $operationName === 'product_slug' will allow me to get the expected result for the custom operation product_slug .\nNevertheless, the collection data provider will be even used for the collection operation GET which is not expected.\n```php\nfinal class ProductCollectionDataProvider implements CollectionDataProviderInterface {\n   //  ....\n    public function getCollection(string $resourceClass, string $operationName = null) {\n    if (Product::class !== $resourceClass) {\n        throw new ResourceClassNotSupportedException();\n    }\n\n    $slug = $this->requestStack->getCurrentRequest()->attributes->get('slug');\n    $this->logger->info(\"*****************getCollection() is called******************\");\n    $this->logger->info(\"(*) operationName='$operationName', resourceClass='$resourceClass', slug='$slug'\");\n\n    $product = $this->repository->findProductBySlug($slug);\n    if ($product === null) {\n        throw new NotFoundHttpException(sprintf('The Product resource \\'%s\\' was not found.', $slug));\n    }\n    return $product;\n}\n\n}\n``` \nAnd as I noticed in my previous post, a single call to the custom operation will make the collection data provider called twice.\n```\nINFO07:34:02 | security | Populated the TokenStorage with an anonymous Token.\n-- | -- | --\nINFO07:34:02 | app | **getCollection() is called**\nINFO07:34:02 | app | () operationName='product_slug', resourceClass='App\\Entity\\Product', slug='iphone-x'\nINFO07:34:02 | app | **getCollection() is called**\nINFO07:34:02 | app | () operationName='', resourceClass='App\\Entity\\Product', slug='iphone-x'\n```\nEncore un grand merci.... Thank @soyuka \n\nDo you have access to the RestrictedDataProviderInterface? It's better to implement this if you can.\n\nI will make a trial\n\navoid using an action\n\nThis means, controllers have to be used. But, I will have to declare the routes of the custom operations in the same file of the routes for api_platform (which is not very clean way for declaring a big list of routes)\n\nuse receive = 0 in the resources attributes to pass this condition\n\nAny example available or a link?\n\nYou need to use the operationName as a condition for your data provider.\n\nFor sure.\n. ",
    "desmax": "I had similar problem, deleting file config/routes/annotations.yaml helped me . That endpoint is basically generated in ApiPlatform\\Core\\Hydra\\Serializer\\DocumentationNormalizer and it does not use ContextBuilder at all.\nMy problem would be solved if method getPropertyNameCollectionFactoryContext would use ContextBuilder to get serializer groups.. @dunglas I really doubt I can provide something decent, but here is an attempt https://github.com/api-platform/core/pull/2260. Currently I decided to decorate api_platform.metadata.property.metadata_factory and api_platform.metadata.resource.metadata_factory in my project to overcome this issue. @Palethorn I think its not alias, in your case argument should be '@app.metadata.resource.metadata_factory.inner'. It is based on name of service in your app.. ",
    "BlayFlorian": "Fixed by extension=curl in php.ini, . ",
    "liorchamla": "\napi_clients_shop_bookmarks_get_subresource\n\nExcuse me but I run the same problem (securing a SubResource) but I can't find why and how you used this string ?\nImagine I have a User entity with a subresource named $carts, what would be the string to securing it with subresourceOperations attribute ?. Sad that there is no aswer, i'm running on the same issue right now and cant figure out how to manage it. Instead of a constraint violation, I got an annoying ORM typing error :'(. K\u00e9vin, I sent u a DM on twitter with the description of my problem which not only on DateTime, but also on a simple \"float\" type. \nWhen sending a request containing a string instead of a float for my entity property, the violation is not the @Assert\\Type constraint, but an earlier error, coming from the @ORM\\Column(type=\"float\").\nHow would u manage that ?. Thanks so much for your time and dedication :-)\nOk so if I understand well, we have here the possibility to tell the Serializer that we want the ObjectNormalizer::DISABLE_TYPE_ENFORCEMENT option to be true while denormalizing. But how ? We can see in API Platform that we can customize context's variables like \"enable_max_depth\" and \"groups\" and also any other options, directly inside de denormalizationContext option of the ApiResource annotation.\nBut for this one : ObjectNormalizer::DISABLE_TYPE_ENFORCEMENT, I can't figure out how :'(\nAny advice ?\nEDIT : by looking at the class itself, I saw that this constant was just \"disable_type_enforcement\", so I tried this, without success :\n/**\n * @ORM\\Entity(repositoryClass=\"App\\Repository\\InvoiceRepository\")\n * @ApiResource(\n *  attributes={\"pagination_enabled\"=true, \"pagination_items_per_page\"=\"5\"},\n *  normalizationContext={\"groups\"={\"invoice_read\"}},\n *  denormalizationContext={\"disable_type_enforcement\"=true},\n *  collectionOperations={\"get\", \"post\", \"api_customers_invoices_get_subresource\"={\n *      \"normalization_context\"={\"groups\"={\"customers_invoices_read\"}}\n *  }}\n * )\n */. With the code above, here is the json error I receive : \n{\n    \"@context\": \"/api/contexts/Error\",\n    \"@type\": \"hydra:Error\",\n    \"hydra:title\": \"An error occurred\",\n    \"hydra:description\": \"The type of the \\\"amount\\\" attribute must be \\\"float\\\", \\\"string\\\" given.\",\n    \"trace\": [ very big stack trace ]\n}\nBut the code I would like to have is the classical violation format, the ConstraintViolationList code.\n. Up ? . To help us all out of this issue, there is all my entity code.\nNote that I use denormalizationContext={\"disable_type_enforcement\"=true}, to try to avoid the problem but it does not seem to be the right thing, it does not work anyway :\n```\n/\n * @ORM\\Entity(repositoryClass=\"App\\Repository\\InvoiceRepository\")\n * @ApiResource(\n *  attributes={\"pagination_enabled\"=true, \"pagination_items_per_page\"=\"5\"},\n *  normalizationContext={\"groups\"={\"invoice_read\"}},\n *  denormalizationContext={\"disable_type_enforcement\"=true},\n *  collectionOperations={\"get\", \"post\", \"api_customers_invoices_get_subresource\"={\n *      \"normalization_context\"={\"groups\"={\"customers_invoices_read\"}}\n *  }}\n * )\n */\nclass Invoice\n{\n    /\n     * @ORM\\Id()\n     * @ORM\\GeneratedValue()\n     * @ORM\\Column(type=\"integer\")\n     * @Groups({\"invoice_read\", \"customer_read\", \"customer_item_read\", \"customers_invoices_read\"})\n     */\n    private $id;\n/**\n * @ORM\\Column(type=\"float\")\n * @Groups({\"invoice_read\", \"customer_read\", \"customer_item_read\", \"customers_invoices_read\"})\n * @Assert\\NotBlank(message=\"Le montant est obligatoire\")\n * @Assert\\Type(type=\"numeric\", message=\"Le montant doit \u00eatre un nombre\")\n */\nprivate $amount;\n\n....\n\n}\n```\nNow there is my error message when sending a string for the amount field : \n{\n    \"@context\": \"/api/contexts/Error\",\n    \"@type\": \"hydra:Error\",\n    \"hydra:title\": \"An error occurred\",\n    \"hydra:description\": \"The type of the \\\"amount\\\" attribute must be \\\"float\\\", \\\"string\\\" given.\",\n    \"trace\": [\n    ....\n}\nProblem : the validation constraint does not send the error, it seems that the errors comes from the Mapping of the field itself. By the way, the  validation constraint works very well if I remove type=\"float\" from the mapping. But I lose the possibility of using migrations etc well.\nEDIT : I also tried a thing that \"worked\", in the Trace, I can see that the exception is thrown by the call to the validateType() method of the AbstractItemNormalizer (line 220) : $this->validateType($attribute, $type, $value, $format);\nCommenting this line allows the Validation Constraint to do its job. So I replaced line 220 with that :\nif (true !== $context['disable_type_enforcement']) {\n     $this->validateType($attribute, $type, $value, $format);\n}\nAnd YEAH ! It works !\n. I feel a bit silly but I can't figure out how I can install in a clean way a new version of core using composer with Symfony Flex .. Do u have an hint ? Very sorry for my disability :'(\n. Works like a charm ;-). ",
    "dgoujard": "\nThis is the wanted behavior.\nendCursor in pageInfo corresponds to the last cursor of all your items. See http://graphql.org/learn/pagination/.\nYou should use cursor in edges to paginate through your collection.\nLike this:\ngraphql\nquery getBooksQry($first: Int, $after: String) {\n  getBooks: books(first: $first, after: $after) {\n    edges {\n      node {\n        id\n        title\n      }\n      cursor\n    }\n    pageInfo {\n      endCursor\n      hasNextPage\n    }\n  }\n}\n@alanpoulain \nIn Api Plateform the endCursor is the last cursor in all collection but in the GraphQL documentation https://graphql.org/learn/pagination/#end-of-list-counts-and-connections it's seams to be the last from the fetched slice. If you use  the playground in the end of the page with this query : \n{\n  hero {\n    name\n    friendsConnection(first:2) {\n      totalCount\n      edges {\n        node {\n          name\n        }\n        cursor\n      }\n      pageInfo {\n        endCursor\n        hasNextPage\n      }\n    }\n  }\n}\nYou got : \n{\n  \"data\": {\n    \"hero\": {\n      \"name\": \"R2-D2\",\n      \"friendsConnection\": {\n        \"totalCount\": 3,\n        \"edges\": [\n          {\n            \"node\": {\n              \"name\": \"Luke Skywalker\"\n            },\n            \"cursor\": \"Y3Vyc29yMQ==\"\n          },\n          {\n            \"node\": {\n              \"name\": \"Han Solo\"\n            },\n            \"cursor\": \"Y3Vyc29yMg==\"\n          }\n        ],\n        \"pageInfo\": {\n          \"endCursor\": \"Y3Vyc29yMg==\",\n          \"hasNextPage\": true\n        }\n      }\n    }\n  }\n}\nThe endCursor in the pageInfo is the last cursor in the current slice not the last in the collection (Y3Vyc29yMw==) because you have hasNextPage set to true.. @alanpoulain Ok thank you for your reply, i didn't view this PR before.. I managed to figure out how to secure api and graphql. I removed the /api prefix, allow anonymous connexion in all path (/) and i added access_control property on each entity.\nNow i can browse documentation without restriction, but graphql and api request need user authentifications.\n\n/**\n * @ORM\\Entity(repositoryClass=\"App\\Repository\\ProjectRepository\")\n * @ORM\\HasLifecycleCallbacks()\n * @ApiResource(\n *     normalizationContext={\"groups\"={\"read\"}, \"enable_max_depth\"=true},\n *     denormalizationContext={\"groups\"={\"write\"}},\n *     attributes={\"access_control\"=\"is_granted('ROLE_USER')\"},\n * )\n */\n```\nsecurity:\n    encoders:\n        App\\Entity\\User:\n            algorithm: argon2i\n            cost: 12\nrole_hierarchy:\n    ROLE_ADMIN: ROLE_USER\n\n# https://symfony.com/doc/current/security.html#where-do-users-come-from-user-providers\nproviders:\n    # used to reload user from session & other features (e.g. switch_user)\n    app_user_provider:\n        entity:\n            class: App\\Entity\\User\n            property: email\nfirewalls:\n    login:\n        pattern:  ^/login\n        stateless: true\n        anonymous: true\n        json_login:\n            check_path: /login_check\n            username_path: email\n            password_path: password\n            success_handler: lexik_jwt_authentication.handler.authentication_success\n            failure_handler: lexik_jwt_authentication.handler.authentication_failure\n    dev:\n        pattern: ^/(_(profiler|wdt)|css|images|js)/\n        security: false\n    main:\n        pattern:   ^/\n        stateless: true\n        anonymous: true\n        guard:\n            authenticators:\n                - lexik_jwt_authentication.jwt_token_authenticator\n                - App\\Security\\ApiTokenAuthenticator\n            entry_point: lexik_jwt_authentication.jwt_token_authenticator\n\n        # activate different ways to authenticate\n\n        # http_basic: true\n        # https://symfony.com/doc/current/security.html#a-configuring-how-your-users-will-authenticate\n\n        # form_login: true\n        # https://symfony.com/doc/current/security/form_login_setup.html\n\n# Easy way to control access for large sections of your site\n# Note: Only the *first* access control that matches will be used\naccess_control:\n    - { path: ^/login, role: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/api/private, roles: [ ROLE_ADMIN ] }\n    - { path: ^/, roles: [ IS_AUTHENTICATED_ANONYMOUSLY ] }\n\n```\n. ",
    "gdharris1970": "I removed everything and started from scratch. I used the Composer install instructions instead of going the Docker route. I don't think we need the Docker stuff, although I'm not totally sure because I don't fully understand it. At any rate, the Foo example is working as expected! Thank you so much for your help!. Crud! I forgot the following line of code in the Book.php and Review.php files:\n\n@ApiResource\n\nSorry for wasting anyone's time!. I have read the instructions on the database reverse engineering page thoroughly, and I've hit a snag. It says:\n\nBefore diving into the recipe, be sure your database connection parameters are correctly setup in the .env file.\n\nI have searched my entire filesystem, and I don't have a \".env\" file anywhere. Do you know where it's supposed to go and what the format of the file is supposed to be?\nThanks!. Does anyone know where the \".env\" file is supposed to go and what it should look like?. ",
    "1dal": "Btw, in offical \"Get started\" guide is missing:\nphp\nuse ApiPlatform\\Core\\Annotation\\ApiResource;. ",
    "InfopactMLoos": "It depends on the version of Symfony you are using. Version 4.0 and up use a .env file in the root of your project, older versions however use the different environment config files in config/app (i.e. config_prod.yml).\nTo see which versions you are running you can run the following command on the command line: \nbash\ncomposer licenses | grep symfony\n. ",
    "wbelhomsi": "For anyone still lost and is looking for an answers.. this is how i generated entity files from an already existing database.. (i use Oracle 12c database in my case):\nFirst i used this command to create my project using composer: (from: api-platform docs)\n```\nCreate a new Symfony Flex project\n$ composer create-project symfony/skeleton bookshop-api\nEnter the project folder\n$ cd bookshop-api\nInstall the API Platform's server component in this skeleton\n$ composer req api\n```\nAfter that navigate to '.env' file found in the root of the project and changed: 'DATABASE_URL' to\nDATABASE_URL=driver:@//host:port/ServiceName (change the host port and service name)\nMy case was (example with oracle db):\nDATABASE_URL=oci8:@//dev01:1521/devProj\nThen navigate to 'doctrine.yaml' found in 'config/packages' and edit the following: (don't forget to edit the parameters to fit you)\n```\nparameters:\n    # Adds a fallback DATABASE_URL if the env var is not set.\n    # This allows you to run cache:warmup even if your\n    # environment variables are not available yet.\n    # You should not need to change this value.\n    env(DATABASE_URL): ''\n    database_driver: oci8\n    database_host: dev01\n    database_port: 1521\n    database_name: \n    database_user: \n    database_password: \n    database_service: true\n    database_servicename: devProj\n    database_charset: UTF8\ndoctrine:\n    dbal:\n        # configure these for your database server\n        # driver: 'pdo_mysql'\n        # server_version: '5.7'\n        # charset: utf8mb4\n        # default_table_options:\n        #     charset: utf8mb4\n        #     collate: utf8mb4_unicode_ci\n        driver: '%database_driver%'\n        host: '%database_host%'\n        port: '%database_port%'\n        dbname: '%database_name%'\n        user: '%database_user%'\n        password: '%database_password%'\n        charset: '%database_charset%'\n        service: '%database_service%'\n        servicename: '%database_servicename%' \n    url: '%env(resolve:DATABASE_URL)%'\norm:\n    auto_generate_proxy_classes: '%kernel.debug%'\n    naming_strategy: doctrine.orm.naming_strategy.underscore\n    auto_mapping: true\n    mappings:\n        App:\n            is_bundle: false\n            type: annotation\n            dir: '%kernel.project_dir%/src/Entity'\n            prefix: 'App\\Entity'\n            alias: App\n\n```\nOk now the connection is done the next step would be automatically generating the entities:\nSymfony Reverse Eng\nNote: Make sure all your tables got a primary key\nphp bin/console doctrine:mapping:import 'App\\Entity' annotation --path=src/Entity (Generates the entity files)\nphp bin/console make:entity --regenerate App (Generates getters and setters)\nIf the above command didn't work please make sure you have doctrine maker \ncomposer require doctrine maker\nAfter that go to your entity files and change: namespace 'App\\Entity'; to namespace App\\Entity; (just remove the quotes\nNow your project is ready.. but the /api doesn't show anything \nLast step would be to add the following to your Entity php files: Generate Entities\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nAnd above the the Class add: \n/**\n * ..\n * \n * @ApiResource\n */\nclass Book\n{\n    // ...\n}\nNow use the command:\nphp -S 127.0.0.1:8000 -t public and navigate to /api and it will all be there\nHope this helps . ",
    "ksn135": "@wbelhomsi Thanks!\nAlso note the bug in Doctrine when importing annotations from existing database\nhttps://github.com/doctrine/doctrine2/pull/5965/files. ",
    "davidpeoples": "Answering my own question. If I remove the \".{format}\" of the Route annotation in PutAction::__invoke, the route now matches and the action gets called as desired. New annotations for the method:\n/**\n * @param $data\n *\n * @Route(\n *     name=\"api_blog_posts_put_item\",\n *     path=\"/blog_posts/{id}\",\n *     defaults={\n *         \"_api_resource_class\"=\"App\\Entity\\BlogPost\",\n *         \"_api_item_operation_name\"=\"put\"\n *     },\n * )\n * @Method(\"PUT\")\n *\n */\npublic function __invoke($data)\n{ .... }.\n",
    "brud": "yep, all api worked as well\nI'm not familiar with docker - it seems I need to connect graphQL port from docker to my host machine?. yep, nginx handles this request to symfony. seems I need add new port in docker-compose.yml. but better way is a hide graphQL by symfony - it will give as authentication and other useful stuff. ",
    "minorbug": "This is still an issue, at least for me. \nUsing the composer route, I can create an API Platform project that exposes the /graphql route correctly. \nWhen using the docker compose setup, and after adding the graphql package, I am unable to get to the  /graphql route. It DOES show up as a route in the debug output:\napi_graphql_entrypoint              ANY      ANY      ANY    /graphql. ",
    "Gu3": "Ok, I found.. PhoneNumberBundle create a new Object PhoneNumber for each phone fields => searching Resource during normalization, doesn't find one, error. \nSorry for the issue. . ",
    "emilien-puget": "I found the issue, the service was autowired, i moved the service declaration in service.yaml instead of an imported file. ",
    "ehibes": "@soyuka I need a clarification, how do you link your entity with your custom types to make this working?. Resolved using @ORM\\MappedSuperclass on User and removing @ORM\\Entity.. ",
    "reducio": "@dunglas I can't even open the profiler.. @BonnieDoug when I call that same endpiont from within the api-platform ui - request is success.\nMaybe I'm not really giving incorrect response. All setup configuration located in api_platform.yml?\nJudging by the configuration, there is no solution: https://api-platform.com/docs/core/configuration\nTell me please, how can I send the correct Content-Type from the server from the api-platform?\nConfig api-platform, json at the first place:\n```\napi_platform:\n    mapping:\n        paths: ['%kernel.project_dir%/src/Entity']\n# The list of enabled formats. The first one will be the default.\nformats:\n    json:\n        mime_types: ['application/json']\n\n    jsonld:\n        mime_types: ['application/ld+json']\n\n    html:\n        mime_types: ['text/html']\n\n# The list of enabled error formats. The first one will be the default.\nerror_formats:\n    jsonproblem:\n        mime_types: ['application/problem+json']\n\n    jsonld:\n        mime_types: ['application/ld+json']\n\n```. Solution!\nUncomment string in axios or fetch() code:\nheaders: {\n     'Content-Type': 'application/json',\n},\n\nIf you use Symfony 4 as and am, setup nelmio/cors-bundle, run command composer req nelmio/cors-bundle. And configurate nelmio_cors.yml, namely add allow_headers.\nnelmio_cors:\ndefaults:\n    allow_credentials: false\n    allow_origin: []\n    allow_headers: ['Content-Type']\n    allow_methods: []\n    expose_headers: []\n    max_age: 0\n    hosts: []\n    origin_regex: false\n    forced_allow_origin_value: ~\npaths:\n    '^/api/':\n        allow_origin: ['*']\n        allow_headers: ['X-Custom-Auth', 'Content-Type']\n        allow_methods: ['POST', 'PUT', 'GET', 'DELETE']\n        max_age: 3600\n    '^/':\n        origin_regex: true\n        allow_origin: ['^http://localhost:[0-9]+']\n        allow_headers: ['X-Custom-Auth', 'Content-Type']\n        allow_methods: ['POST', 'PUT', 'GET', 'DELETE']\n        max_age: 3600\n        hosts: ['^api\\.']. @BonnieDoug, thank you for help! But I will do stringify if use fetch(). But if use Axios, his docs say that the process `JSON.stringify` is automated, I noticed that the data is still not transferred to the json.. @BonnieDoug jwt.io tell that token is Invalid Signature. With what it can be connected? I tried use curl with additional parametrs `curl -H \"Content-Type: application/json\" -H \"Authorization: Bearer d70414362252a41ce772dff4823d084d\" http://localhost:8080/api/categories`, but I get `{\"code\":401,\"message\":\"Invalid JWT Token\"}`. @soyuka, to be honest, I can not figure out which direction to go in, since my implementation is the same. . @BonnieDoug\n\n\n. @soyuka, I use https://github.com/lexik/LexikJWTAuthenticationBundle. I think that it not connectedly with jwt.io, I'm right? I bad understand how JWT works, it creates problems for finding errors.. @chalasr greeting, thanks for the response. Studying this repo: https://github.com/chalasr/lexik-jwt-authentication-sandbox, led me to such an error. Also I change file security.yaml:\n```\nsecurity:\nencoders:\n    App\\Entity\\User:\n        algorithm: bcrypt\n\nproviders:\n\n    our_db_provider:\n        entity:\n            class: App\\Entity\\User\n            property: username\n\nfirewalls:\n    dev:\n        pattern: ^/(_(profiler|wdt)|css|images|js)/\n        security: false\n\n    login:\n        pattern:  ^/login\n        stateless: true\n        anonymous: true\n        form_login:\n            check_path:               /login_check\n            success_handler:          lexik_jwt_authentication.handler.authentication_success\n            failure_handler:          lexik_jwt_authentication.handler.authentication_failure\n            require_previous_session: false\n\n    register:\n        pattern:  ^/register\n        stateless: true\n        anonymous: true\n\n    api:\n        pattern:   ^/api\n        stateless: true\n        anonymous: false\n        provider: our_db_provider\n        guard:\n            authenticators:\n                - lexik_jwt_authentication.jwt_token_authenticator\n\naccess_control:\n    - { path: ^/login, roles: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/register, roles: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/api, roles: IS_AUTHENTICATED_FULLY }\n\n```\n\n\n\n. Then I doing this instructions: https://techjourney.net/how-to-decrypt-an-enrypted-ssl-rsa-private-key-pem-key/ and get :\nIt's looks like success.\n@chalasr, tell me please, if the private is decrypt via command line in manual, this is normal or I need decrypt via program code?\nIf be I did not use Postman, then I would not have seen the error of Symfony, which helped me find the root of the problem. It would be nice if be Lesik LexikJWTAuthenticationBundle processed this error.\nThanks a lot for help all who helped me.\n\n. @chalasr, thanks a lot. Yes, close issue.. ",
    "apfz": "because multiple applications will be communicating with the api. One of them is a web-application, another is a mobile app. So I would like to push data from my web-application to the api. . Thanks @antograssiot  and @byhoratiss. I ended up doing something like this:\n```\n    /\n     * Create a new Dish\n     \n     * @Security(\"has_role('ROLE_MANAGE_DISHES') or has_role('ROLE_SUPER_ADMIN')\")\n     * @param Request $request\n     * @return RedirectResponse|Response\n     /\n    public function createAction(Request $request)\n    {\n        $client = $this->get('eight_points_guzzle.client.api_logistics');\n    $form = $this->createForm(DishType::class);\n    $form->handleRequest($request);\n\n    $new_url = $this->generateUrl('new_dish');\n    $redirect_url = $this->generateUrl('manage_dishes');\n\n    if ($form->isSubmitted() && $form->isValid()) {\n\n        $data = json_encode($form->getData());\n        try {\n            $client->post('/api/dishes', array('body' => $data));\n            return $this->redirect($redirect_url);\n        } catch (ClientException $e) {\n            $this->handleErrors($e,$form);\n        }\n    }\n\n    return $this->render('MyBundle:Common:basic.html.twig', array(\n        'form' => $form->createView(),\n        'page_title'=> 'Maaltijd aanmaken',\n        'action_path' => $new_url,\n        'cancel_path'=> $redirect_url,\n        'submit_button_title'  => 'Opslaan',\n    ));\n}\n\n```\nNow the next architectural question I have about this is that JWT tokens expire. Would this be practical in a case where a CRUD web-application is talking to my API endpoint? I am wondering why API Platform is suggesting to use JWT instead of API tokens. \nDifferent clients (like mobile apps and and other web applications) will talk to my API. Would all of them need to send their token in the header, receive a message its expired, refresh/get a new token, and make the call again?\n. Thanks. These have cleared my questions. Much appreciated.. @Simperfit im still unable to setup custom filters within API platform. Some time ago I have posted this question on stack overflow https://stackoverflow.com/questions/49372971/custom-filter-api-platform-not-working, unfortunately it remains unanswered. What im trying to do is to connect the search functionality of the DataTables javascript library to the api. So when I search, all columns (with pagination) has to be searched through. For this I need an OR filter.  \nSo even when trying to create a custom filter I am kinda stuck. \n. ",
    "MadisD": "Thank you for the answer!. ",
    "chalasr": "You are relying on the default values for form_login.username_parameter and form_login.password_parameter which are _username and _password, but you are passing username and password in your cURL calls. Fix the key names in your cURL commands or redefine the form_login options to username and password, not related to LexikJWTAuthenticationBundle but Symfony's form_login.. @krypton-code It seems that openssl changed its key generation process to encrypt keys by default, we need to document that on LexikJWTAuthenticationBundle (see https://github.com/lexik/LexikJWTAuthenticationBundle/pull/449), thanks for confirming.\nThis can be closed if you're done.. ",
    "n506": "Surely, but i dont want to have memebers in class, its not necessary and makes logic management harder.\nRight now i havesomething like\n```php\nclass BaseEntity {\n....\n    // Never accessed directly! Needs only for api-platform annotation to correct IRI generation\n    /*\n    * @ApiProperty(identifier=true)\n    /\n    protected $id;\n.....\n}\n/\n @ApiResource(\"myentity\")\n/\nclass MyEntity extends BaseEntity {\npublic function __construct(int $id=null) {\n    $e=new orm\\entity\\my_entity();\n    parent::__construct($e);\n    if (null!==$id) {\n        $this->entity=$this->entity->init_by_id($id);\n        if (!is_object($this->entity)) {throw new ItemNotFoundException('');};\n    }\n}\n\npublic function getId() {\n    // NPE guard in case underlying entity is null somehow\n    return parent::getId();\n}\n\npublic function getProperty() {\n    return $this->get('property_name');\n}\npublic function setProperty($data) {\n    return $this->set('property_name', $data);\n}\n\n```\nAs you can see, all the logic hidden in base \"proxy/orm accessor\" class BaseEntity. To be correct - in underlying under BaseEntity orm entity (validation, lazy read/write, some functions). \nReal orm entity is a property of base class - $this->entity. \nBaseEntity provides universal get/set method to access field (underlying orm entity provides interface with magic __set && __get).\nSo, i want to escape from coding like this many times right now and many times where entities changed somewhere in orm library in future\nphp\n    public function getProperty() {\n        return $this->get('property_name');\n    }\n    public function setProperty($data) {\n        return $this->set('property_name', $data);\n    }\nI want to generate this set/get functions in runtime. I can achieve it with \nphp\n$this->gerProperty=function () {...}\nThe problem is - api-platform does not see it and cant use . Thanks.. decorators, normalizers . looks too many things to implement for someone who uses symfony for 3 weeks only)\ni'll try it a bit later after making full-stack proof-of-concept project done.. reality and plans are not always the same, i've dumped idea to autogenerate entity's properties for now because api entity have different number of properties/getters/setters then underlying lib entity (clearly - json api should not expose all fields/getters/setters). \nbut i've used the idea to manipulate with metadata/apidocs to expose some complex funcs of underllying lib.\nthanx.. ",
    "augustinfla": "Hello,\nIn my case it was just a forgotten getter id : getId(). ",
    "pasinter": "Thanks @dunglas. I see the \"allow_plain_identifiers\" option is not implemented for the JSON API format. The JSON API spec has no opinion on whether IDs should be IRI's - in fact all their examples only have UIDs, so I think your implementation should support the \"allow_plain_identifiers\" option.\nWould you accept a PR if I implemented it?. ",
    "A-Marwan": "Using the PaginationExtension or returning a doctrine paginator does not return hydra:view for me, any idea how to handle this?. ",
    "bonfante": "I need help with this too.. Ok, thanks.. +1. ",
    "z31fbras": "@toby-griffiths Can I have an example on how you achieved this?\nI'm stuck with the same issue as you =s. Are you working behind a proxy?\nI had the same problem with my company's proxy ;). Solved by using this method! =D\nhttps://api-platform.com/docs/core/operations/#alternative-method. Thanks a lot @soyuka!\nI'll have a look at it very soon ;). Indeed, it helped me a lot!\nThank you very much for your speed and reliabilty @soyuka !. What is the exact situation: are you on your local version?\nMaybe it is a proxy issue?. What routes are available in the two cases?\nI tested on my project and the first option works fine: I have /taxes routes but not /taxes/{id} ones.\nAs precised here in the docs : https://api-platform.com/docs/core/operations/#enabling-and-disabling-operations : itemOperations and collectionOperations are arrays containing a list of operation. Each operation is defined by a key corresponding to the name of the operation that can be anything you want and an array of properties as value. If an empty list of operations is provided, all operations are disabled.. Could you post what your curl request is?. This code works:\n```\n<?php\nnamespace App\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse ApiPlatform\\Core\\Annotation\\ApiProperty;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Component\\Validator\\Constraints as Assert;\n/\n * Class Consent\n * @ApiResource\n * @ORM\\Entity\n */\nclass Consent\n{\n    /\n     * @var int\n     \n     * @ORM\\Id\n     * @ORM\\GeneratedValue\n     * @ORM\\Column(type=\"integer\")\n     /\n    private $id;\n/**\n * @return int\n */\npublic function getId(): int\n{\n    return $this->id;\n}\n\n}\n```. You cannot create an entity with an @ORM\\Entity annotation without an attribute with the @ORM\\Id annotation ;). @michaelrachlitz Works fine on my computer, I pasted your code into my project and your entity appears in my Swagger \n\n. @michaelrachlitz Maybe it has to do with your API Platform version?\nWhat is yours?. @michaelrachlitz Do you have any other entity on this project that works fine?. ",
    "bastien-wink": "Have you figured this out @arnedesmedt ? I am facing the same issue. ",
    "jr-cobweb": "If anyone has the same issue, I managed to get around this by using the explicit definition:\n/**\n * @ApiResource(\n *     attributes={\n *          \"normalization_context\"={\"groups\"={\"document_read\"}},\n *          \"denormalization_context\"={\"groups\"={\"document_write\"}}\n *     },\n *     collectionOperations={\n *          \"get\"={\"method\"=\"GET\"},\n *          \"post\"={\"method\"=\"POST\"}\n *     }\n *)\n *\n * @ORM\\Entity\n * @UniqueEntity(\n *     fields={\"id\"},\n *     message=\"This document already exists. Cannot create duplicate.\"\n * )\n */\nThe Docs do state that the first method should work however, so I'll leave this open until someone more experienced can comment.. Bump: @dunglas don't suppose you know if the docs need updating? I don't mind lending a hand if this is the case.. I thought I was, but apparently not. Updating seems to have fixed the issue. Thanks.. Also, if it helps for 404 responses, the Response instance is created at:\nExceptionAction, Line 87\nAnd because we're not passing in any Cache-Control headers, they are added as a default in:\nResponseHeaderBag, Line 126\n. @Simperfit Yep, as far as I'm aware. I found a way around it so not really checked back since I posted this. I'll add it to the core component.. I'm having a similar issue when POSTing an entity with a lot of relations. I'm currently working around it by separating the request out into batches, but I would be interested to know if there are any plans to reduce the header size.. ",
    "Hoxydev": "@jon-ht can you tell us if your files are using CRLF or LF.\nTry to open docker-compose.yaml and bin/console and tell us about your endline.\nBtw your IDE give you the info like in the bottom right.. @jon-ht \nYou use docker-toolbox right ?\nCan you give us the info about your shared folder in VirtualBox ?. Enjoy !\nhttps://github.com/ahmetb/gke-letsencrypt/blob/master/20-install-cert-manager.md. ",
    "mmeloni": "Insert a comment:\n<span property=\"rdfs:comment\">Your comment</span>\n@dunglas it's correct that comments need to be mandatory in properties?. ",
    "Benjvfr": "Hello, same problem here with latest version of API Platform and the React Admin Component.\nI have my Symfony 4.1.1 with API Platform on https://hello.local/api (entrypoint) and the react admin on localhost:3000.\nFor the entrypoint I have : \nexport default () => <HydraAdmin entrypoint=\"https://hello.local/api\"/>;\nIt works on initialisation, but when I want to edit an entity, it fetch 'https://hello.local/api/api/myentity/1\".\nDo you have a solution to fix that ?\nThanks.. ",
    "bricejulia": "For those who might be interested, an updated version of the hotfix could be:\n```\nimport React from 'react';\nimport { HydraAdmin, hydraClient, fetchHydra } from '@api-platform/admin';\nconst apiPrefix = '/your-api-prefix';\nconst customFetch = (url, options = {}) => {\n    // fix https://github.com/api-platform/api-platform/issues/584\n    url = url.replace(${apiPrefix}${apiPrefix}/, ${apiPrefix}/);\n    return fetchHydra(url, options);\n};\nexport default () => (\n     hydraClient(api, customFetch)}\n    />\n);\n```. ",
    "ahoulgrave": "Having same issue. ",
    "marinsagovac": "@antograssiot \nI've tried your solution. On your situation you add only method type.\nThis is same as (removed methods):\napi_countries_get_item:\n    path: '/countries/{id}'\n    defaults:\n        _controller: '\\AppBundle\\Controller\\CountriesSpecial::special'\n        _api_resource_class: 'AppBundle\\Entity\\Countries'\n        _api_item_operation_name: 'special'\nA defaults directive and _controller, resource and item should be defined for properly overriding method. \nThis already worked.\n. ",
    "tahirm": "Thanks for quick reply.\nFollowing is output for bin/console debug:router\n```\n$ bin/console debug:router\n\nName                 Method   Scheme   Host   Path\n\napi_entrypoint       ANY      ANY      ANY    /api/{index}.{_format}\n  api_doc              ANY      ANY      ANY    /api/docs.{_format}\n  api_jsonld_context   ANY      ANY      ANY    /api/contexts/{shortName}.{_format}\n  _twig_error_test     ANY      ANY      ANY    /_error/{code}.{_format}\n\n```\nAnd this is what I have in config/routes/api-platform.yaml:\n```\napi_platform:\n    resource: .\n    type: api_platform\n    prefix: /api\n```\nI have tried /api as well, but i get default apache 404 page\n\n. unfortunately, Im getting same error even with built-in php server\n```\n$ bin/console server:run\n[OK] Server listening on http://127.0.0.1:8000\n// Quit the server with CONTROL-C.\nPHP 7.1.9-1+ubuntu16.04.1+deb.sury.org+1 Development Server started at Mon Feb 26 21:50:22 2018\nListening on http://127.0.0.1:8000\nDocument root is /vagrant/api-platform/public\nPress Ctrl-C to quit.\n2018-02-26T21:50:44+01:00 [error] Uncaught PHP Exception Symfony\\Component\\HttpKernel\\Exception\\NotFoundHttpException: \"No route found for \"GET /\"\" at /vagrant/api-platform/vendor/symfony/http-kernel/EventListener/RouterListener.php line 144\n[Mon Feb 26 21:50:44 2018] 127.0.0.1:48156 [404]: /\n``. Turns out I was missing proper rewrite rules, which I got by installingcomposer require symfony/apache-pack` as mentioned in symfony docs:\nhttps://symfony.com/doc/current/setup/web_server_configuration.html\nAfter this, I was able to access api-platform on /api\n@antograssiot, Thank you very much for pointing me to right direction.. ",
    "marcw": "You have to change the api/config/packages/doctrine.yaml file and change pdo_pgsql by pdo_mysql as well.. ",
    "Selion05": "here's  the outpout from git diff with api-platform-2.3.1 and mysql as database\ngit-diff.txt\nin the entrypoint you have to remove the pg_isready thing as well. jep i guess i can do that :)\n. @dunglas  i have a guide now for the steps for 2.3.2 but i'm not very familiar with creating a pull request. \nthat's my fork https://github.com/Selion05/docs/blob/2.2/core/mysql.md\n. ",
    "Maels1991": "You must declare the groups on your entities properties so that the serializer is able to guess which one must be filled with the entering JSON, based on what you've defined in ApiResource(...).\nJust declaring groups is not enough.\nhttps://symfony.com/blog/new-in-symfony-2-7-serialization-groups. Do you manually normalize your entity ?. What you're looking for is the \"shortName\" property defineable on theApiResource() annotation.\n@ApiResource(shortName=\"what you want ...\"). That depends on which is the owning/inverse side.\nIf relation is \"inverted\", then you have to set reference to the other in your adder method.. Hello @nikophil ,\nI'm facing the same issue. Not found any \"good\" solution yet but to reach my goal, I retrieve the parent ID from the request and load it using Doctrine.\nEdit : is_granted('resource_action', request.attributes.get('id'))\nThen in my voter, I check if $subject is a string or an Instance of X. It it's a string, I retrieve it from the DB by using the EntityManager (injected through the controller).\nI keep you informed if I found any other better way to achieve it \ud83d\ude03 . public function setCountryOfNationality(Country $countryOfNationality): self\nbecomes ...\npublic function setCountryOfNationality(?Country $countryOfNationality): self\nand it should work.. ",
    "ThibaudLafont": "I will try to inquire groups in my entities. And yes I manually normalize them ! \nI'm sorry but I don't have time to try your solution for now, I will do it as fast as I can ! \nThank you. ",
    "miguelbemartin": "The same problem here. How to create a request using IRI?. I am trying to save a relation in the Invoice\nPOST /api/invoices\n{\n  \"date\": \"2018-10-13T00:00:00+00:00\",\n  \"description\": \"Test\",\n  \"details\": [\n    {\n      \"concept\": \"string\",\n      \"quantity\": 2,\n      \"price\": 10\n    }\n  ],\n  \"company\": \"/api/companies/1\"\n}\nSo basically, the relation with the company is working correctly, but with the details of the invoice is creating the details, but not associating to the invoice, the invoice_id is null.\nAny suggestion?. ",
    "er1z": "It seems to be working but Swagger docs produces an array of string instead of particular object. Any ideas?\nedit: found out how to add this into Swagger doc:\n\nnested object has to be configured as a resource (just disable all methods for this class),\nfield with collection of objects must have readableLink and writableLink properties set to true\n\nThen Swagger docs are being exported flawlessly. Shouldn't we clarify this in the docs, @Simperfit?. I bless someone who could have ran lysis with no issue. Everytime I try to generate SPA API, it produces an empty service and properties. Any working tutorial on this piece of software?. @zukko1 \u2014 I've done something working via generating using swagger.json. It's not first class quality generator code but seems to be working. I'll post an update to this issue with repo link.. Not so sure if understand correctly, but look: https://github.com/api-platform/api-platform/issues/606. ",
    "bobey": "Yes it seemed like a bug but I didn't find the related issue you mentioned. Anyway, it now reflects exactly the official docker-compose documentation.\nNot relevant to the current conversation but let me thank you for the awesome work you all made on this project.. ",
    "Ronnie-J": "Hi @dunglas \nThanks for responding. I have updated the question above.\nI tried with single quotes but with same result. . Okay, well.. the API Platform clearly support this bundle https://api-platform.com/docs/core/jwt so what would I need to do in order to get API Platform to handle the exceptions thrown from the bundle?. @dunglas sorry! I made a brain bobo! .. it's not Lexik - im using https://github.com/auth0/jwt-auth-bundle. So my question is how to handle exceptions from the security layer in Symfony in the API Platform - if possible. . Okay im not sure either. I've created an eventListener that catches the exceptions and use the ErrorNormalizer provided by the API Platform. Thank you for your time @dunglas . @dunglas properly is - Im heading home from work now, ill let you know tomorrow \ud83d\udc4d . I just got around to debugging and for some damn reason I cant seem to debug the vendor library. It's ignoring my changes even though im running app_dev.php and clearing cache... not sure if its a docker issue. Tried droping the container as well and building it from scratch - same. I guess for now I have to rely on 2.2.5 and do some detective work. Thanks for your time.. Looks to be something with the path. Using /me the route is registered and shows up in the debug:route. \napi_identities_get_item      GET      ANY      ANY    /identities/me\n\nBut when I access the url I get the error as mentioned. The IdentityItemDataProvider is not called. If I change the path to be /identities/{id} then the path is registered as;\napi_identities_get_item      GET      ANY      ANY    /identities/{id}\n\nand then I am able to call the endpoint with /me. Then the IdentityItemDataProvider is called first and then the controller is called which I tried to use insted of the DataProvider. If I remove the DataProvider and just try to rely on the controller it fails the same way.\nThe error is different if I access a path that is not registered at all and when I access the /me endpoint. Im guessing it's because no resource is returned because the provider is not called. \nI just fetched the new api-platform-2.2.7 and started from scratch but I seem to hit the same error. I even moved the routing to YAML insted of annotations.. @teohhanhui https://github.com/Ronnie-J/api-platform-example I hope thats sufficient. \nIt's running on the new 2.3.0 and the issue persists.\n\n\n\n\nYou can simply change path to see the result. The GreetingItemDataProvider is set to just return a dummy object. Again it looks like when using path /me the GreetingItemDataProvider is not called and therefor I get the 404 since no resource was found. . @teohhanhui do we need to assign this to anyone?. Bump. So it dosen't sound like there is a silver bullet then. I dont seem to have a complicated configuration so surely I cant be the only one having this problem? \ud83d\ude22 \nAny suggestions into debugging or fixing the issue? . Ah shit I was missing the Origin header - that apparently was needed in order to have NelmioCors to trigger.\nOPTIONS /myroute HTTP/1.1\nHost: localhost:8080\nAccess-Control-Request-Headers: authorization,content-type\nAccess-Control-Request-Method: PUT\nOrigin: localhost\nCache-Control: no-cache. I solved this by creating a default Symfony controller and registrering routes manually. I also manually use the normalizer for the JSON API format.\nIt's definitely not optimal. . Hi @dunglas \nI tried creating one and true enough I was saving the data in Redis but the default Doctrine data persister was triggered as well resulting in an immediate write to the database along side with Redis and that is not what I want.  . @dunglas do you mean https://github.com/api-platform/api-platform/releases/tag/v2.3.1 ? and fixed how? So if I create a custom data provider again it should not call the default one as well?. @dunglas perfect \ud83d\udc4dill give it a spin, thanks.. @dunglas \nLooks like it's not persisting in the database now! \ud83d\ude4c \nBut should I not be able to return a Response object? I am trying to be JSON API conform and returning a 202 Accepted since I am not creating the instance yet. If I have this code;\n/**\n    * @param Consent $data\n    * @return Response\n    */\n    public function persist($data)\n    {\n        return new Response('', Response::HTTP_ACCEPTED);\n    }\nThen I get this exception;\n{\n    \"title\": \"An error occurred\",\n    \"description\": \"The controller must return a response (Object(App\\\\Entity\\\\Consent) given).\",\n    \"trace\": [\n        {\n            \"namespace\": \"\",\n            \"short_class\": \"\",\n            \"class\": \"\",\n            \"type\": \"\",\n            \"function\": \"\",\n            \"file\": \"/srv/api/vendor/symfony/http-kernel/HttpKernel.php\",\n            \"line\": 165,\n            \"args\": []\n        },\n        {\n            \"namespace\": \"Symfony\\\\Component\\\\HttpKernel\",\n            \"short_class\": \"HttpKernel\",\n            \"class\": \"Symfony\\\\Component\\\\HttpKernel\\\\HttpKernel\",\n            \"type\": \"->\",\n            \"function\": \"handleRaw\",\n            \"file\": \"/srv/api/vendor/symfony/http-kernel/HttpKernel.php\",\n            \"line\": 66,\n            \"args\": [\n                [\n                    \"object\",\n                    \"Symfony\\\\Component\\\\HttpFoundation\\\\Request\"\n                ],\n                [\n                    \"integer\",\n                    1\n                ]\n            ]\n        },\n        {\n            \"namespace\": \"Symfony\\\\Component\\\\HttpKernel\",\n            \"short_class\": \"HttpKernel\",\n            \"class\": \"Symfony\\\\Component\\\\HttpKernel\\\\HttpKernel\",\n            \"type\": \"->\",\n            \"function\": \"handle\",\n            \"file\": \"/srv/api/vendor/symfony/http-kernel/Kernel.php\",\n            \"line\": 188,\n            \"args\": [\n                [\n                    \"object\",\n                    \"Symfony\\\\Component\\\\HttpFoundation\\\\Request\"\n                ],\n                [\n                    \"integer\",\n                    1\n                ],\n                [\n                    \"boolean\",\n                    true\n                ]\n            ]\n        },\n        {\n            \"namespace\": \"Symfony\\\\Component\\\\HttpKernel\",\n            \"short_class\": \"Kernel\",\n            \"class\": \"Symfony\\\\Component\\\\HttpKernel\\\\Kernel\",\n            \"type\": \"->\",\n            \"function\": \"handle\",\n            \"file\": \"/srv/api/public/index.php\",\n            \"line\": 37,\n            \"args\": [\n                [\n                    \"object\",\n                    \"Symfony\\\\Component\\\\HttpFoundation\\\\Request\"\n                ]\n            ]\n        }\n    ]\n}\nIf I return the object with an ID then it works.\n/**\n     * @param Consent $data\n     * @return Response\n     */\n    public function persist($data)\n    {\n        $data->setId(1);\n        return $data;\n    }\n{\n    \"data\": {\n        \"id\": \"/consent/1\",\n        \"type\": \"Consent\",\n        \"attributes\": {\n            \"created_at\": {\n                \"date\": \"2018-08-22 14:56:28.833550\",\n                \"timezone_type\": 3,\n                \"timezone\": \"UTC\"\n            },\n            \"version\": 1\n        }\n    }\n}\nAny idea why?\nAnother question just to be super sure... the POST endpoint does not try and fetch the entity from the database first right? It simply takes what is in the request body and normalize the object?. I can see in the DataPersisterInterface it states \n/**\n     * Persists the data.\n     *\n     *\n     * @return object|void Void will not be supported in API Platform 3, an object should always be returned\n     */\n    public function persist($data);\nClearly states an intent that it should return an object but if I look at the JSON API spec it states that I should return a 202 Accepted if the resource is not yet created (http://jsonapi.org/format/#crud-creating-responses-202). It doesn't seem clear to me if a response is expected but seems logical as I cannot return an id on the resource. \n\"title\": \"An error occurred\",\n    \"description\": \"Unable to generate an IRI for the item of type \\\"App\\\\Entity\\\\Consent\\\"\" . Bump. ",
    "netsuo": "It's not only about sessions but everything that would need access to /tmp, let's say writing temporary files for file uploads. ",
    "ljbergmann": "Based on my understanding of .env and the loadding process of config files the simplest way to achieve this is moving the api_platform.yaml from config/packages/to config/packages/dev or config/packages/prod and modify them as you need. . Hey @dunglas thanks for the very fast reply and the clarification.\nAs far as I'm concerned, this issue can be closed and marked as solved. \n. ",
    "AskanSimon": "the solution is to set getters und setters for an entity. please update the docs ;). Hallo gries,\nthank you very much.\nMaybe it would be helpfull for many new users, if there is an advanced showcase-project (simular to symfony-demo). The current demo is so tiny ... and reading the full manual needs a lot time ;)\nBest Regards\nSimon. @sylflo the api platform demo is a hello world example. symfony demo is pretty advanced with many techniques ;). Thank you for the fast answer. The date in the response header always shows the current time.\nbelow the logs. thanks for your help\n\n```\n   << Request  >> 65565\n-   Begin          req 65564 rxreq\n-   Timestamp      Start: 1533661344.497674 0.000000 0.000000\n-   Timestamp      Req: 1533661344.497674 0.000000 0.000000\n-   ReqStart       172.18.0.1 47732 a0\n-   ReqMethod      GET\n-   ReqURL         /books.jsonld?page=1\n-   ReqProtocol    HTTP/1.1\n-   ReqHeader      Host: localhost:8081\n-   ReqHeader      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0\n-   ReqHeader      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,/*;q=0.8\n-   ReqHeader      Accept-Language: de,en-US;q=0.7,en;q=0.3\n-   ReqHeader      Accept-Encoding: gzip, deflate\n-   ReqHeader      Connection: keep-alive\n-   ReqHeader      Upgrade-Insecure-Requests: 1\n-   ReqHeader      If-None-Match: \"1fa3bed635ce88de31fc3a561560cea6\"\n-   ReqHeader      Cache-Control: max-age=0\n-   ReqHeader      X-Forwarded-For: 172.18.0.1\n-   VCL_call       RECV\n-   VCL_return     hash\n-   ReqUnset       Accept-Encoding: gzip, deflate\n-   ReqHeader      Accept-Encoding: gzip\n-   VCL_call       HASH\n-   VCL_return     lookup\n-   HitMiss        98326 -110.648084\n-   VCL_call       MISS\n-   VCL_return     fetch\n-   Link           bereq 65566 fetch\n-   Timestamp      Fetch: 1533661347.510519 3.012845 3.012845\n-   RespProtocol   HTTP/1.1\n-   RespStatus     200\n-   RespReason     OK\n-   RespHeader     Server: nginx/1.15.2\n-   RespHeader     Content-Type: application/ld+json; charset=utf-8\n-   RespHeader     X-Powered-By: PHP/7.2.8\n-   RespHeader     Vary: Accept, Content-Type, Authorization\n-   RespHeader     X-Content-Type-Options: nosniff\n-   RespHeader     X-Frame-Options: deny\n-   RespHeader     Cache-Control: max-age=0, must-revalidate, private, s-maxage=3600\n-   RespHeader     Date: Tue, 07 Aug 2018 17:02:27 GMT\n-   RespHeader     Link: http://localhost:8081/docs.jsonld; rel=\"http://www.w3.org/ns/hydra/core#apiDocumentation\"\n-   RespHeader     ETag: \"1fa3bed635ce88de31fc3a561560cea6\"\n-   RespHeader     Cache-Tags: /books/1,/books\n-   RespHeader     X-Debug-Token: 318891\n-   RespHeader     X-Debug-Token-Link: http://localhost:8081/_profiler/318891\n-   RespHeader     url: /books.jsonld?page=1\n-   RespHeader     X-Varnish: 65565\n-   RespHeader     Age: 0\n-   RespHeader     Via: 1.1 varnish (Varnish/6.0)\n-   VCL_call       DELIVER\n-   RespUnset      url: /books.jsonld?page=1\n-   VCL_return     deliver\n-   Timestamp      Process: 1533661347.510548 3.012874 0.000029\n-   RespProtocol   HTTP/1.1\n-   RespStatus     304\n-   RespReason     Not Modified\n-   RespHeader     Connection: keep-alive\n-   Timestamp      Resp: 1533661347.510675 3.013001 0.000127\n-   ReqAcct        429 0 429 664 0 664\n-   End\n\n<< Session  >> 65564\nBegin          sess 0 HTTP/1\nSessOpen       172.18.0.1 47732 a0 172.18.0.5 80 1533661344.496463 24\nLink           req 65565 rxreq\nSessClose      RX_TIMEOUT 8.020\nEnd\n\n```. can someone help to solve this problem? its a varnish miss, but I get this miss\nevery time. maybe because of my system? (windows 10 pro) best regards\nsimon. ",
    "cduran433": "Sorry for the noise.. it was a stupid mistake. Changing competitions instead of competition and it is working.. Thank you!\nYes! I can add an entry but my English is really bad, so maybe someone has to correct my documentation.\n. Hi,\nSorry that I was really busy last month and I can't spend time in this issue. I go over them again. I realise that I need to add support to Fastly.\nCould you give some tips how to do it? I Know that I need to add a FastlyPurger in HttpCache folder but how can I add this option to the config file.\nCan I do that in the api-platform and create a pull request? or should I create the purger in my own bundle? \n. ",
    "michilehr": "Any updates on this?. ",
    "devhero-tech": "i have the same problem :/. ",
    "aokby": "Any updates on this?. ",
    "purplefish32": "I second that, /var/logs should now be /var/log. @teohhanhui could you please provide an example with working fastcgi_buffer_size, as I have tried : \n```\nserver {\n    root /srv/api/public;\nproxy_buffer_size   128k;\nproxy_buffers   4 256k;\nproxy_busy_buffers_size   256k;\n\nlocation / {\n    # try to serve file directly, fallback to index.php\n    try_files $uri /index.php$is_args$args;\n}\n\nlocation ~ ^/index\\.php(/|$) {\n\n    fastcgi_buffer_size 128k;\n    fastcgi_buffers 4 256k;\n    fastcgi_busy_buffers_size 256k;\n\n   ...\n\n```\nBut my 502s are just being changed to 503s\nI am deactivating the cache for now.\n . ",
    "do-web": "I have the same problem with this but there is nothing in the swagger doc:\n````\nnamespace App\\Entity\\Dto;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\n/\n * @ApiResource(collectionOperations={\n *     \"get\"={\"route_name\"=\"api_settings\", \"method\"=\"GET\"}\n * })\n */\nfinal class Settings\n{\n    /\n     * @var array\n     */\n    public $shippings;\n}\n````\ncan anyone help here?. ",
    "alinepure": "@lvillarino, did you manage to make it work? I try to activate the filter for a subresource too and it doesn't work.\nI have two entities: Sheet and Record. Sheet has an @ApiSubresource on Record which returns a collection.\nI've set up an exists filter on the end class (Record entity).\nThe filter is not working on GET /sheets/{id}/records?parentRecord[exists]=true, but working well on GET /records?parentRecord[exists]=true\n. @soyuka, the resourceFilters are empty for subresource. Should we add the filters property under the subresource operation too? \nUpdate:\nThe soubresource operation \"api_sheets_records_get_subresource\" isn't found under the Record entity, where filter extension is looking for it.. Weird, by setting up the filters on subresource operation doesn't work, but it works with the annotation. Thanks!. ",
    "comxd": "@gries Thanks! It's due to the vendor/api-platform/core/src/Bridge/Symfony/Bundle/Resources/config/routing/docs.xml : /docs.{_format}. Hi @Simperfit, what do you think about editing the documentation?. I understand the logic of this \"issue\" but I'm unable to explain correctly in English :/. Hi @Hoxydev! I have found this useful link some hours after published my post ^^ Big thanks for our reply.. ",
    "JeremieBAP": "If you don't want to use the cache in dev why won't you just use the 8080 port?\nBut ok for the answer, why not.\nThanks a lot for your nice and useful project :) \n(sorry i used another account to reply ... but i'm the same person). ",
    "danielclariondoor": "Tried to run these commands via docker-compose\nbut when running docker-compose exec php pecl install xdebug-2.6.0\nI get\n```\nCannot find autoconf. Please check your autoconf installation and the\n$PHP_AUTOCONF environment variable. Then, rerun this script.\nERROR: phpize' failed\n```\n. Thanks, but how do I know what they are?\nAnd how do I install them?\nThe PHP service container does not seem to have a package manager.. But I need that feature. Any idea when this will be merged?. Thanks. Hi,\nThanks for your response.\nHow do I instantiate an API platform entity using an associative array that was returned from Dynamo DB?\nThat, I guess, is my fundamental problem.. How do I \"hydrate\" it? Create a constructor?. Just need to have a unique ID and populate it.. This is happening after composer install is complete.\nThe path should be \"../autoload.php\". That is where autoload.php is.. I just cloned this repo and then ran \"docker-compose up\".. According to the docs, https://api-platform.com/docs/schema-generator/getting-started\nthe generator is run like this:docker-compose exec php vendor/bin/schemasoDIRis notvendor/api-platform/schema-generator/bin. Thanks. I did read that. What I'm trying to point out is that there is an error in the documentation.\nThe documentation says to rundocker-compose exec php vendor/bin/schemawhich for me results in the error.docker-compose exec php vendor/api-platform/schema-generator/bin/schemadoes work, but that is not in the documentation.\n. This occurs as soon as I add the annotation@ApiSubresource`. Thanks for your reply.\nThis is what I have currently:\n```<?php\nnamespace App\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse ApiPlatform\\Core\\Annotation\\ApiProperty;\nuse ApiPlatform\\Core\\Annotation\\ApiSubresource;\nuse App\\Util\\S3;\n/*\n * @ApiResource\n /\nclass Schema\n{\nuse S3;\n\n/**\n * @ApiSubresource\n */\npublic $uischema;\n\n}\n. That's another entity, the subresource.\nI don't know what you mean.\nI followed this in the documentation:\n// api/src/Entity/Question.php\nnamespace App\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiProperty;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse ApiPlatform\\Core\\Annotation\\ApiSubresource;\nuse Doctrine\\ORM\\Mapping as ORM;\n/\n * @ORM\\Entity\n * @ApiResource\n */\nclass Question\n{\n    /\n     * @ORM\\Column(type=\"integer\")\n     * @ORM\\Id\n     * @ORM\\GeneratedValue(strategy=\"AUTO\")\n     */\n    private $id;\n/**\n * @ORM\\Column\n */\npublic $content;\n\n/**\n * @ORM\\OneToOne(targetEntity=\"Answer\", inversedBy=\"question\")\n * @ORM\\JoinColumn(referencedColumnName=\"id\", unique=true)\n * @ApiSubresource\n */\npublic $answer;\n\npublic function getId(): ?int\n{\n    return $this->id;\n}\n\n}\n. We discovered that using yaml worked:\nMy\\Entity\n  properties:\n    subentity_field:\n      subresource:\n        resourceClass: 'My\\Other\\Entity'\n        collection: true\n```. ",
    "jcerri": "I saw that example but it seems i\u2019m forced to declare my filter and to inject a list of properties. \nUsing the annotation, I can set a filter and a list of properties for an entity. The FilterPass does the rest. I can apply my SearchFilter on property name of entity A and the same filter on property title of entity B. \nUsing yaml, out of the box, I have the feeling I have to declare my filter as a service twice. \nI may be missing something. \nI only got specific about Doctrine to precise everything is custom in my project (data providers, extensions and filters management) althought it will be heavily inspired. \n. ",
    "anacicconi": "Thanks for your quick reply @GregoireHebert !\nAre developers creating custom endpoints for these cases? Or custom filters are indeed the best option as we can remain restful?. I think you're talking about this one @soyuka: https://github.com/api-platform/core/issues/398\nI read you said this feature should not be on core. However, as it was from June 2017, I wasn't sure if it was up to date.\nThanks ;)\n. Can I reuse the issue to ask a question about the custom filters? I have been testing them since I got your replies. Using the Regexp from the documentation, I'm able to reach the filterProperty method when I add the filter to my resource like this:\n@ApiResource(attributes={\"filters\"={RegexpFilter::class}})\nHowever, when I try to use the ApiFilter annotation nothing happens:\n@ApiFilter(RegexpFilter::class, properties={\"website\"})\nI tried many combinations of the way I add the filter to the resource and the way I declare my service. There are only two ways I can make this work.\nFirst:\n'App\\Filter\\RegexpFilter':\n        arguments: [ '@doctrine', '@request_stack', '@?logger', { website: ~ } ]\n@ApiResource(attributes={\"filters\"={RegexpFilter::class}})\nThis way I have both the filter in the swagger interface and I reach the filterProperty method.\nSecond:\n'App\\Filter\\RegexpFilter':\n        arguments: [ '@doctrine', '@request_stack', '@?logger']\n@ApiResource(attributes={\"filters\"={RegexpFilter::class}})\nThis way I don't have the filter in the swagger interface but still if I curl the url with regexp_website as a parameter I reach the filterProperty method.\nMy service options for both cases:\n```\nInformation for Service \"App\\Filter\\RegexpFilter\"\n\nOption           Value\n\nService ID       App\\Filter\\RegexpFilter\n  Class            App\\Filter\\RegexpFilter\n  Tags             api_platform.filter\n  Public           no\n  Synthetic        no\n  Lazy             no\n  Shared           yes\n  Abstract         no\n  Autowired        yes\n  Autoconfigured   yes\n\n```\nEven if the first option works, I would prefer to use the ApiFilter annotation. This way I would be able to declare a generic custom filter that I can use in any resource without specifying the properties in the services.yml. And of course I would have the filter in the swagger interface.\nAm I missing something here?. Hi @teohhanhui, yes they work. The title of my question is not good. I was starting to deal with filters when I asked it. As you pointed out, the Search Filter checks if it is an array or a single value. If it's an array, it adds a \"IN\". However, for \"OR\" queries, I had to do a custom filter.. Hello,\nI'll start this conversation again if it's ok. I did a custom \"OR\" filter for my app which is basically a copy of the \"SearchFilter\" with some modifications for the query. It works just fine. However, I think it's a pity to have a copy of another file like that. I was wondering if I could have my custom filter to extend the \"SearchFilter\". I read in one of your issues that you don't advise people to do that. Is there a reason? Besides the fact that eventually the \"SearchFilter\" could be updated and break my custom filter.\nMoreover, would it be a good idea to change the original \"SearchFilter\" so the user could choose what kind of operator he wants? \nThanks!\n. Thanks @Simperfit. It was the right place ;). @soyuka my bad! I thought I had the nullable true but I had forgot it. When I added it, the left join appeared :) Thanks for your reply!. @soyuka sorry for the last reply. I did a mistake. Before you told me about the nullable, I was doing tests where I was forcing to pass the \"LEFT JOIN\" as a parameter to the \"addJoinsForNestedProperty\" method of the AbstractFilter. This made me think the nullable was the solution. Now I updated my vendors, everything is clear and I can see that the nullable does not change anything. \nI've been debugging it all morning and I think the problem is in the \"addJoinsForNestedProperty\" method. When the \"OrderFilter\" was fixed, the \"$joinType\" was added as a parameter. However, it is commented. Is it normal? If it wasn't we would be able to choose the join type in the filters.\nhttps://github.com/api-platform/core/blob/master/src/Bridge/Doctrine/Orm/Filter/AbstractFilter.php\nHere I have a test with two entities using a ManyToOne nullable association. I added a \"SearchFilter\" and I get only \"INNER JOINs\" in the query.\n```\n// The entities\nnamespace App\\Entity;\nuse Doctrine\\ORM\\Mapping as ORM;\n/\n * Book\n \n * @ORM\\Table(name=\"Book\")\n * @ORM\\Entity\n /\nclass Book\n{\n    /\n     * @ORM\\Id\n     * @ORM\\GeneratedValue\n     * @ORM\\Column(type=\"integer\")\n     */\n    private $id;\n/**\n * @var Author\n *\n * @ORM\\ManyToOne(targetEntity=\"Author\")\n * @ORM\\JoinColumn(name=\"author_id\", referencedColumnName=\"id\", nullable=true)\n */\nprivate $author;\n\n/**\n * @return mixed\n */\npublic function getId()\n{\n    return $this->id;\n}\n\n/**\n * @return Author\n */\npublic function getAuthor(): Author\n{\n    return $this->author;\n}\n\n/**\n * @param Author $author\n *\n * @return Book\n */\npublic function setAuthor(Author $author): Book\n{\n    $this->author = $author;\n    return $this;\n}\n\n}\nnamespace App\\Entity;\nuse Doctrine\\ORM\\Mapping as ORM;\n/\n * Author\n \n * @ORM\\Table(name=\"Author\")\n * @ORM\\Entity\n /\nclass Author\n{\n    /\n     * @ORM\\Id\n     * @ORM\\GeneratedValue\n     * @ORM\\Column(type=\"integer\")\n     */\n    private $id;\n/**\n * @var string\n *\n * @ORM\\Column(name=\"first_name\", type=\"string\", nullable=false)\n */\nprivate $firstName;\n\n/**\n * @return mixed\n */\npublic function getId()\n{\n    return $this->id;\n}\n\n/**\n * @return string\n */\npublic function getFirstName(): string\n{\n    return $this->firstName;\n}\n\n/**\n * @param string $firstName\n *\n * @return Author\n */\npublic function setFirstName(string $firstName): Author\n{\n    $this->firstName = $firstName;\n    return $this;\n}\n\n}\n// The API resources\nApp\\Entity\\Author:\n        collectionOperations:\n            get: ~\n        itemOperations:\n            get: ~\nApp\\Entity\\Book:\n        collectionOperations:\n            get:\n                filters: ['book.search_filter']\n        itemOperations:\n            get: ~\n// The filter definition\nbook.search_filter:\n        parent: 'api_platform.doctrine.orm.search_filter'\n        arguments: [ { \"author.firstName\": \"exact\" } ]\n        tags:  [ 'api_platform.filter' ]\n// The query generated by API platform\nSELECT \nb0_.id AS id_0, \nb0_.author_id AS author_id_1 \nFROM Book b0_ \nINNER JOIN Author a1_ ON b0_.author_id = a1_.id \nWHERE b0_.id IN (\n    SELECT b2_.id \n    FROM Book b2_ \n    INNER JOIN Author a3_ ON b2_.author_id = a3_.id \n    WHERE a3_.first_name = ?) \nORDER BY b0_.id ASC LIMIT 30. Yes, I just saw the func_get_arg. Thanks ;)\nHumm... I'm not sure about the filter. This means we will never get the null values. \nI did a custom filter because I needed a \"or search filter\": https://github.com/api-platform/api-platform/issues/639\nNow, I see that I can let the front decide if it wants the \"LEFT\" or the \"INNER\" join. However, I think it's a pity to have a custom search filter doing almost exactly the same thing that the original \"SearchFilter\" does and I'm not sure if this is a good strategy. Do you know how people have been dealing with this case?. ",
    "axelvnk": "In case someone is looking for an example of an OR search filter : here it is\nhttps://gist.github.com/axelvnk/edf879af5c7dbd9616a4eeb77c7181a3. ",
    "danyPatient": "@Simperfit Sorry to insist, but are you sure we have to go through a Event Subscriber to do it?. Thank you Kevin !! : ). ",
    "Mathieudewet": "Just tried on Debian stretch, working, can't reproduce.. ",
    "axelmm": "I had this and similiar issues (not all containers running, not possible 'exec php' ...) using Docker on Proxmox (Debian stretch based) as remote compiler. Sources on Samba share edited from VSCode on Win. \nI tried almost every possible scenarios ... zip, latest, master, tar.gz, git ... and figured out that it was caused by wrong Samba configuration (sources were created with 0700 permission). After fixing smb.conf all containers were created and started properly (from simplest zip).\nErrors with Docker on Windows can be permissions related - I had earlier issues with volumes - in fact it was one of many arguments to run remote compiler.. ",
    "paoloBirdOffice": "Actually where i got the probleme is with the declaration of the Service with the !tagged in Symfony4.\nI have the feeling that he doesn't see reconnize it and give me empty itemExtension. I will do that thanks alot. ",
    "mi5ha": "thanks for answering, but I am not sure I understand you :-) Are there some examples, docs of the feature you are recommending?\nI thought that extension approach will be simpler then to create custom data provider.\nExample of custom data provider given in docs doesnt have paging, filtering part. Just says its possible.. I tried that, but my DQL is complex and doesnt return entities but arrays instead. So if I give name of the array key for ordering, it complains it doesnt exist on entity.. ",
    "nikophil": "Hi, thanks for your answer\nmaybe i was not clear enough : i just want to add a comment object to the OneToMany relationship...\nI can't find the right POST url \nI saw on another issue in github that i should do like this :\nPOST /api/comments\n{\n    \"content\" : \"blah blah\",\n    \"blogPost\" : \"/api/blogpost/1\"\n}\nwith an application/ld+json header but that just doesn't work.... okay, thanks, that works. ",
    "BatsaxIV": "If you want to directly POST on comment, something like :\njson\n{\n  \"content\": \"new comment\",  \n  \"blogPost\": \"/blogPosts/$ID\"\n}\nshould work.. Hi,\nProbably a permissions issue.\nWhen I launch the same command on the demo, the permissions on the Greeting class, initially myuser:myuser, are on root:root.\nMaybe an issue with the docker config?. After a bit of searching, it seems that the problem comes from the Symfony\\Component\\PropertyInfo\\Extractor\\ReflectionExtractor, has is not part of the $defaultAccessorPrefixes.\n```php\nclass ReflectionExtractor implements PropertyListExtractorInterface, PropertyTypeExtractorInterface, PropertyAccessExtractorInterface\n{\n    /*\n     * @internal\n     /\n    public static $defaultMutatorPrefixes = array('add', 'remove', 'set');\n/**\n * @internal\n */\npublic static $defaultAccessorPrefixes = array('is', 'can', 'get');\n\n```\nIt seems a bit odd to me that this class has (:sunglasses:) a problem, is there a bug or am I missing something? (ping @dunglas). Yes, I was about to closed it :)\nFor anyone interesting, here's the commit in the property-info component : https://github.com/symfony/property-info/commit/bb50d9f132d91633e8b7c912795d9ed81a902377\nThanks for the answer @dunglas !. I just faced the same issue and it works when adding the code in the subresouce entity not in the main one.. In my app I use Alice fixtures and in the demo app to reproduce the bug doctrine fixtures.\nThe difference between the api platform demo and my demo app is the EntityListener.\nAdd a book listener to the api platform demo (here it has no purpose) : \n```php\n<?php\nnamespace App\\EntityListener;\nuse Doctrine\\ORM\\EntityManagerInterface;\nclass BookListener\n{\n    private $em;\npublic function __construct(EntityManagerInterface $em)\n{\n    $this->em = $em;\n}\n\npublic function postPersist(): void\n{\n}\n\n}\n```\nUpdate Book entity with following annotation : \nphp\n@ORM\\EntityListeners({\"App\\EntityListener\\BookListener\"})\nAnd services.yaml with : \nyml\n    App\\EntityListener\\:\n        resource: '../src/EntityListener'\n        tags:\n            - { name: doctrine.orm.entity_listener }\nThen load fixtures in dev env : OK\nIn test env : KO\nbash\ndocker-compose exec php bin/console h:f:l -n -e test\n. ",
    "LukA888": "It worked like a charm! Thanks \ud83d\ude04 . ",
    "jpprade": "Yes I had the same issue, I spend 2 hours trying to figure out why I keept seeing the symfony welcome page, it was just under /api. Yes please update the docs here : https://api-platform.com/docs/distribution. ",
    "khom-outsourcify": "@soyuka Thanks for your advice. :D . ",
    "NAYZO": "It's the case. Thanks for the clarification.. ",
    "maxhelias": "When we build the services it takes the steps from the beginning of the file.\nExample with the nginx service, it will build the steps of the service php before and not just the steps that is under the alias. Yes indeed, but the public file is already mounted in volumes in the docker-compose.yml.\nAnd does not that increase the size of the nginx image too much just for this relationship ?. You can also use a Voter like this : https://medium.com/@galopintitouan/using-symfony-security-voters-to-check-user-permissions-with-ease-9a48e2d45540. Do you have enabled autowiring for controller classes or registered as a service ?. You can define another ApiResource with ApiSubresource in your ApiResource with Doctrine relation : \nhttps://api-platform.com/docs/core/operations/#subresources\nBut without, i don't know, i never try. Maybe with the new input_class / output_class feature you can do this, i don't know if it covers your needs. It's not documented yet. You probably have a bad docker cache somewhere.\nTry this command : docker-composer build --no-cache php. Maybe, i don't know, which version do you use and which OS ?\nCan you try to erase your docker project with the following command :  docker-compose down -v --rmi all --remove-orphans and re build it with docker-compose up -d. This is only my opinion but here is how I do.\n\nI would add this repository as a second remote named \"upstream\".\nGet all \"upstream\" to rebase it on your update branch (fetch + rebase).\nUpdating all dependencies (composer & yarn).\nCheck the Symfony recipe for the API with this command : composer sync-recipes --force\nRebuild all image docker.  Before removing the docker cache from the project with this command : docker-compose down --rmi all --remove-orphans (WARNING : Not use the -v flag to keep your database locally) and docker-compose up -d.\nAnd run your unit test for check the BC\n\nI may have forgotten steps, I wrote this message from my memory\n. You can also use the update-deps.sh file \ud83d\ude09 . Fixed by #1023 . Yes, it's a good idea, I just added it but how to prevent updating the index.php file for Varnish ?\nWill not we change the recipe ? Or something else ?. Ok, I understand better now how does the command work.\nI delete the file symfony.lock which is used to check the version of the recipe and executed the command to have all the updates (like that of Mercure update).\nAnd add the new generated symfony.lock file.\nAlso the command composer sync-recipes --force don't work very well in container php because we don't have the git reference.. We don't have the update of index.php file because the symfony.lock file keep the ref and the command check if we have new version of the recipe.\nSo with the new symfony.lock file, we don't have any probleme with the new update for now. It's reverted \ud83d\ude03 . ",
    "warslett": "Thanks for responding. See below \n```\n<?php\nnamespace App\\Entity;\nuse Doctrine\\Common\\Collections\\ArrayCollection;\nuse Doctrine\\Common\\Collections\\Collection;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Bridge\\Doctrine\\Validator\\Constraints\\UniqueEntity;\nuse ApiPlatform\\Core\\Annotation as ApiPlatform;\nuse ApiPlatform\\Core\\Bridge\\Doctrine\\Orm\\Filter as ORMFilter;\nuse Symfony\\Component\\Serializer\\Annotation\\Groups;\nuse ApiPlatform\\Core\\Annotation\\ApiProperty;\n/*\n * @ORM\\Entity(repositoryClass=\"App\\Repository\\HikeRepository\")\n * @UniqueEntity(fields={\"name\", \"event\"}, message=\"Hike name must be unique for this event\")\n * @ApiPlatform\\ApiResource(\n *     collectionOperations={\"get\"},\n *     itemOperations={\"get\"},\n *     attributes={\n *         \"normalization_context\"={\"groups\"={\"api\"}}\n *     }\n * )\n * @ApiPlatform\\ApiFilter(ORMFilter\\SearchFilter::class, properties={\"event\": \"exact\"})\n /\nclass Hike\n{\n/**\n * @ORM\\Column(type=\"integer\")\n * @ORM\\Id\n * @ORM\\GeneratedValue(strategy=\"AUTO\")\n * @var int\n */\nprivate $id;\n\n/**\n * @ORM\\Column(type=\"string\", length=140)\n * @var string\n */\nprivate $name;\n\n/**\n * @var Event\n * @ORM\\ManyToOne(targetEntity=\"Event\", inversedBy=\"hikes\")\n */\nprivate $event;\n\n/**\n * @ORM\\OneToMany(targetEntity=\"Team\", mappedBy=\"hike\")\n * @var Collection\n */\nprivate $teams;\n\npublic function __construct()\n{\n    $this->teams = new ArrayCollection();\n}\n\n/**\n * @return string\n */\npublic function __toString(): string\n{\n    return $this->name . \" \u00bb \" . $this->event->__toString();\n}\n\n/**\n * @Groups({\"api\"})\n * @return null|int\n */\npublic function getId(): ?int\n{\n    return $this->id;\n}\n\n/**\n * @Groups({\"api\"})\n * @return string\n */\npublic function getName(): ?string\n{\n    return $this->name;\n}\n\n/**\n * @param string $name\n */\npublic function setName(?string $name)\n{\n    $this->name = $name;\n}\n\n/**\n * @ApiProperty()\n * @Groups({\"api\"})\n * @return Collection|Team[]\n */\npublic function getTeams(): Collection\n{\n    return $this->teams;\n}\n\n/**\n * @Groups({\"api\"})\n * @return Event|null\n */\npublic function getEvent(): ?Event\n{\n    return $this->event;\n}\n\n/**\n * @param Event $event\n */\npublic function setEvent(Event $event): void\n{\n    $this->event = $event;\n}\n\n}\n```\n```\n<?php\nnamespace App\\Entity;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Bridge\\Doctrine\\Validator\\Constraints\\UniqueEntity;\nuse ApiPlatform\\Core\\Annotation as ApiPlatform;\nuse ApiPlatform\\Core\\Bridge\\Doctrine\\Orm\\Filter as ORMFilter;\nuse Symfony\\Component\\Serializer\\Annotation\\Groups;\n/*\n * @ORM\\Entity(repositoryClass=\"App\\Repository\\TeamRepository\")\n * @UniqueEntity(fields={\"name\",\"hike\"}, message=\"Team name already taken for this hike\")\n * @ApiPlatform\\ApiResource(\n *     collectionOperations={\"get\"},\n *     itemOperations={\"get\"},\n *     attributes={\n *         \"normalization_context\"={\"groups\"={\"api\"}}\n *     }\n * )\n * @ApiPlatform\\ApiFilter(ORMFilter\\SearchFilter::class, properties={\"hike\": \"exact\"})\n /\nclass Team\n{\n/**\n * @ORM\\Column(type=\"integer\")\n * @ORM\\Id\n * @ORM\\GeneratedValue(strategy=\"AUTO\")\n */\nprivate $id;\n\n/**\n * @ORM\\Column(type=\"string\", length=100)\n * @var string\n */\nprivate $name;\n\n/**\n * @var Hike\n * @ORM\\ManyToOne(targetEntity=\"Hike\", inversedBy=\"teams\")\n */\nprivate $hike;\n\n/**\n * @var User\n * @ORM\\ManyToOne(targetEntity=\"User\", inversedBy=\"teams\")\n */\nprivate $user;\n\n/**\n * @Groups({\"api\"})\n * @return int|null\n */\npublic function getId(): ?int\n{\n    return $this->id;\n}\n\n/**\n * @param int $id\n */\npublic function setId(int $id)\n{\n    $this->id = $id;\n}\n\n/**\n * @Groups({\"api\"})\n * @return string\n */\npublic function getName(): ?string\n{\n    return $this->name;\n}\n\n/**\n * @param string $name\n */\npublic function setName(string $name)\n{\n    $this->name = $name;\n}\n\n/**\n * @Groups({\"api\"})\n * @return Hike\n */\npublic function getHike(): ?Hike\n{\n    return $this->hike;\n}\n\n/**\n * @param Hike $hike\n */\npublic function setHike(Hike $hike)\n{\n    $this->hike = $hike;\n}\n\n/**\n * @return User|null\n */\npublic function getUser(): ?User\n{\n    return $this->user;\n}\n\n/**\n * @param User $user\n */\npublic function setUser(User $user)\n{\n    $this->user = $user;\n}\n\n/**\n * @return string\n */\npublic function __toString()\n{\n    return $this->name;\n}\n\n}\n```\nso if I query teams /api/hikes/24 I want to get back something like this (note that teams are linked and user is excluded):\n{\n  \"@context\": \"\\/api\\/contexts\\/Hike\",\n  \"@id\": \"\\/api\\/hikes\\/24\",\n  \"@type\": \"Hike\",\n  \"id\": 24,\n  \"name\": \"Scout Hike\",\n  \"teams\": [\n    \"\\/api\\/teams\\/12\",\n    \"\\/api\\/teams\\/13\",\n    \"\\/api\\/teams\\/15\",\n    \"\\/api\\/teams\\/16\",\n    \"\\/api\\/teams\\/19\",\n    \"\\/api\\/teams\\/20\",\n    \"\\/api\\/teams\\/21\",\n    \"\\/api\\/teams\\/23\",\n    \"\\/api\\/teams\\/24\",\n    \"\\/api\\/teams\\/25\",\n    \"\\/api\\/teams\\/27\",\n    \"\\/api\\/teams\\/33\",\n    \"\\/api\\/teams\\/35\",\n    \"\\/api\\/teams\\/37\",\n    \"\\/api\\/teams\\/39\",\n    \"\\/api\\/teams\\/41\",\n    \"\\/api\\/teams\\/42\",\n    \"\\/api\\/teams\\/43\",\n    \"\\/api\\/teams\\/47\",\n    \"\\/api\\/teams\\/51\",\n    \"\\/api\\/teams\\/53\",\n    \"\\/api\\/teams\\/54\",\n    \"\\/api\\/teams\\/55\",\n    \"\\/api\\/teams\\/56\",\n    \"\\/api\\/teams\\/57\",\n    \"\\/api\\/teams\\/60\",\n    \"\\/api\\/teams\\/62\",\n    \"\\/api\\/teams\\/63\",\n    \"\\/api\\/teams\\/68\",\n    \"\\/api\\/teams\\/69\",\n    \"\\/api\\/teams\\/70\",\n    \"\\/api\\/teams\\/71\",\n    \"\\/api\\/teams\\/72\",\n    \"\\/api\\/teams\\/80\",\n    \"\\/api\\/teams\\/81\",\n    \"\\/api\\/teams\\/85\",\n    \"\\/api\\/teams\\/90\"\n  ],\n  \"event\": \"\\/api\\/events\\/37\"\n}\nHowever what I get is an error \"The total number of joined relations has exceeded the specified maximum. Raise the limit if necessary, or use the \\\"max_depth\\\" option of the Symfony serializer.\" I'm presuming that it is trying to render these as embedded relations but I just want it to render them as links as it would by default.. @Simperfit Thank you that solved my issue.. ",
    "jorguerra": "Sure, this is\n<?php\n  namespace App\\Entity;\n\n  use Doctrine\\Common\\Collections\\ArrayCollection;\n  use Doctrine\\Common\\Collections\\Collection;\n  use Doctrine\\ORM\\Mapping as ORM;\n  use ApiPlatform\\Core\\Annotation\\ApiResource;\n use Doctrine\\ORM\\Event\\LifecycleEventArgs;\n use  Symfony\\Component\\Validator\\Constraints as Assert;\n\n /**\n   * @ORM\\Entity(repositoryClass=\"App\\Repository\\UserRepository\")\n   * @ORM\\Table(indexes={\n   *  @ORM\\Index(name=\"fk_nationality_idx\", columns={\"nationality_id\"})\n   * }, uniqueConstraints={\n   *  @ORM\\UniqueConstraint(name=\"email\", columns={\"email\"})\n  * })\n  * @ApiResource\n  * @ORM\\HasLifecycleCallbacks()\n  */\n class User\n{\n  const ROLE_DEFAULT = 'ROLE_USER';\n  const ROLE_MANAGER = 'ROLE_MANAGER';\n  const ROLE_EMPLOYEE = 'ROLE_EMPLOYEE';\n  const ROLE_OWNER = 'ROLE_OWNER';\n  const ROLE_SUPER_ADMIN = 'ROLE_SUPER_ADMIN';\n\n/**\n * @ORM\\Id()\n * @ORM\\GeneratedValue()\n * @ORM\\Column(type=\"integer\")\n */\nprivate $id;\n\n/**\n * @ORM\\Column(type=\"string\", length=64)\n * @Assert\\Email()\n */\nprivate $email;\n\n/**\n * @ORM\\Column(type=\"string\", length=30)\n */\nprivate $name;\n\n/**\n * @ORM\\Column(type=\"string\", length=30)\n */\nprivate $lastName;\n\n/**\n * @ORM\\Column(type=\"string\", length=255)\n */\nprivate $password;\n\n/**\n * @ORM\\Column(type=\"string\", length=255)\n * @Assert\\Blank()\n */\nprivate $salt;\n\n/**\n * @ORM\\Column(type=\"string\", length=255, nullable=true)\n */\nprivate $avatar;\n\n/**\n * @ORM\\Column(type=\"date\", nullable=true)\n */\nprivate $birth;\n\n/**\n * @var array List of encryption methods that will be used to encrypt the user's password\n */\nprivate $encryptionAlgs = ['sha1','ripemd160','sha256','sha512', 'md5'];\n\n/**\n * @var string\n * @ORM\\Column(type=\"string\",length=10, name=\"encryption\", nullable=false)\n */\nprivate $encryption;\n\n/**\n * @var array\n */\nprivate $roles;\n\n/**\n * @ORM\\OneToMany(targetEntity=\"App\\Entity\\Business\", mappedBy=\"ceo\")\n */\nprivate $businesses;\n\n/**\n * @ORM\\ManyToOne(targetEntity=\"App\\Entity\\Country\")\n * @ORM\\JoinColumn(nullable=true)\n */\nprivate $nationality;\n\npublic function __construct()\n{\n    $this->businesses = new ArrayCollection();\n}\n\npublic function getId()\n{\n    return $this->id;\n}\n\npublic function getEmail(): ?string\n{\n    return $this->email;\n}\n\npublic function setEmail(string $email): self\n{\n    $this->email = $email;\n\n    return $this;\n}\n\npublic function getName(): ?string\n{\n    return $this->name;\n}\n\npublic function setName(string $name): self\n{\n    $this->name = $name;\n\n    return $this;\n}\n\npublic function getLastName(): ?string\n{\n    return $this->lastName;\n}\n\npublic function setLastName(string $lastName): self\n{\n    $this->lastName = $lastName;\n\n    return $this;\n}\n\npublic function getPassword(): ?string\n{\n    return $this->password;\n}\n\npublic function setPassword(string $password): self\n{\n    $this->password = $password;\n\n    return $this;\n}\n\npublic function getSalt(): ?string\n{\n    return $this->salt;\n}\n\npublic function setSalt(string $salt): self\n{\n    $this->salt = $salt;\n\n    return $this;\n}\n\npublic function getAvatar(): ?string\n{\n    return $this->avatar;\n}\n\npublic function setAvatar(?string $avatar): self\n{\n    $this->avatar = $avatar;\n\n    return $this;\n}\n\npublic function getBirth(): ?\\DateTimeInterface\n{\n    return $this->birth;\n}\n\npublic function setBirth(?\\DateTimeInterface $birth): self\n{\n    $this->birth = $birth;\n\n    return $this;\n}\n\n/**\n * @ORM\\PrePersist()\n * @ORM\\PreUpdate()\n */\npublic function setLogInVars(): self\n{\n    $index = array_rand($this->encryptionAlgs);\n    $this->encryption = $this->encryptionAlgs[$index];\n    $this->salt = hash($this->encryption, time());\n    $this->password = hash($this->encryption, $this->password.$this->salt);\n\n    if (empty($this->roles))\n        $this->addRole(self::ROLE_DEFAULT);\n    /**\n     * Avoid roles duplicity\n     */\n    $this->roles = array_unique($this->roles);\n\n    return $this;\n}\n\npublic function getEncryption(): string\n{\n    return $this->encryption;\n}\n\n/**\n * @param string $password\n * @return bool\n * Verify if the password is correct\n */\npublic function checkPassword(string $password): bool\n{\n    return $this->password == hash($this->encryption, $password.$this->salt);\n}\n\npublic function __toString(): string\n{\n    return ucwords(strtolower($this->name . \" \" . $this->lastName));\n}\n\npublic function setEncryption(string $encryption): self\n{\n    $this->encryption = $encryption;\n\n    return $this;\n}\n\npublic function getRoles(): ?array\n{\n    return $this->roles;\n}\n\n/**\n * @param array|string $roles\n * @return User\n */\npublic function setRoles($roles): self\n{\n    if (is_array($roles))\n        $this->roles = $roles;\n\n    if(is_string($roles) && is_array(eval($roles)))\n        $this->roles = eval($roles);\n\n    return $this;\n}\n\npublic function addRole(string $role): self\n{\n    if ($this->isValidRole($role))\n        array_push($this->roles,$role);\n\n    return $this;\n}\n\nprivate function isValidRole(string $role): bool\n{\n    $reflection = new \\ReflectionClass(__CLASS__);\n    return $reflection->getConstant($role) !== false;\n}\n\n/**\n * @return Collection|Business[]\n */\npublic function getBusinesses(): Collection\n{\n    return $this->businesses;\n}\n\npublic function addBusiness(Business $business): self\n{\n    if (!$this->businesses->contains($business)) {\n        $this->businesses[] = $business;\n        $business->setCeo($this);\n    }\n\n    return $this;\n}\n\npublic function removeBusiness(Business $business): self\n{\n    if ($this->businesses->contains($business)) {\n        $this->businesses->removeElement($business);\n        // set the owning side to null (unless already changed)\n        if ($business->getCeo() === $this) {\n            $business->setCeo(null);\n        }\n    }\n\n    return $this;\n}\n\npublic function getNationality(): ?Country\n{\n    return $this->nationality;\n}\n\npublic function setNationality(?Country $nationality): self\n{\n    $this->nationality = $nationality;\n\n    return $this;\n}\n}\n\n. ",
    "wildcard27": "I am stuck in the same boat (different field). I just keep getting: The type of the \"acceptedMeasurements\" attribute must be \"array\", \"string\" given. in the admin component. Was there any fix for this? I have just upgraded to 2.3.6 and am getting the same problem.\nEverytime I restart the container, I need to run docker-compose exec php php-fpm -D. This is getting super annoying. ```\nphp_1          | Loading composer repositories with package information\nphp_1          | Installing dependencies (including require-dev) from lock file\nphp_1          |     1/1:       https://codeload.github.com/symfony/lts/legacy.zip/c1affae45b78aee036effa1759237e7fa96d4af2\nphp_1          |     Finished: success: 1, skipped: 0, failure: 0, total: 1\nphp_1          | Package operations: 0 installs, 1 update, 0 removals\nphp_1          | Package symfony/lts is abandoned, you should avoid using it. Use symfony/flex instead.\nphp_1          | Generating autoload files\nphp_1          | ocramius/package-versions:  Generating version class...\nphp_1          | ocramius/package-versions: ...done generating version class\nphp_1          | Executing script cache:clear [OK]\nphp_1          | Executing script assets:install [OK]\nphp_1          | \nphp_1          | Waiting for Postgres to be ready...\nphp_1          | /tmp:5432 - no response\nphp_1          | /tmp:5432 - no response\nphp_1          | /tmp:5432 - no response\nphp_1          | /tmp:5432 - no response\nphp_1          | /tmp:5432 - no response\nphp_1          | /tmp:5432 - no response\nphp_1          | /tmp:5432 - no response\nphp_1          | /tmp:5432 - no response\netc, etc, etc. It seems that the problem is that the `api` container waits for PHP-FPM to be ready in `docker-entrypoint.sh` but is perhaps timing out?. @aaa2000 Have already done that. @baddlan You seem to be correct. Running `printenv` inside the php container comes up with:\nPHP_EXTRA_CONFIGURE_ARGS=--enable-fpm --with-fpm-user=www-data --with-fpm-group=www-data --disable-cgi\nHOSTNAME=978e1597bb19\nPHP_INI_DIR=/usr/local/etc/php\nSHLVL=1\nHOME=/root\nPHP_LDFLAGS=-Wl,-O1 -Wl,--hash-style=both -pie\nPHP_CFLAGS=-fstack-protector-strong -fpic -fpie -O2\nPHP_MD5=\nPHP_VERSION=7.2.10\nGPG_KEYS=1729F83938DA44E27BA0F4D3DBDB397470D12172 B1B44D8F021E4E2D6021E995DC9FF8D3EE5AF27F\nPHP_CPPFLAGS=-fstack-protector-strong -fpic -fpie -O2\nPHP_ASC_URL=https://secure.php.net/get/php-7.2.10.tar.xz.asc/from/this/mirror\nCOMPOSER_ALLOW_SUPERUSER=1\nPHP_URL=https://secure.php.net/get/php-7.2.10.tar.xz/from/this/mirror\nTERM=xterm\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/root/.composer/vendor/bin\nPHPIZE_DEPS=autoconf            dpkg-dev dpkg           file            g++             gcc             libc-dev                make            pkgconf                 re2c\nPWD=/srv/api\nPHP_SHA256=01c2154a3a8e3c0818acbdbc1a956832c828a0380ce6d1d14fea495ea21804f0\n```\nThis would mean that the .env variables are not being passed to the container.\nEdit: There is never a $DATABASE_URL environment variable set, even when the services are up and working.. @baddlan The docker-compose.yml doesn't have that param: https://github.com/api-platform/api-platform/blob/v2.3.6/docker-compose.yml. This should mark 2.3.6 as broken, then. There will be many people who will have the same issue.. Thanks @antograssiot but I was hoping there might be a way to do this without using extensions. I know that in Laravel, I can assign the user_id using Auth()->getUser in the controller. Since API Platform is steering us away from using our own controllers, I was hoping they would have a built-in way of handling this.\nAlso, how would blameable get the user from the JWT token?. Update\nI have cleared the error above by removing the @ORM\\Column part of the $owner docblock.\nThe problem now stands that when I call the GET /article/{id} endpoint, I get the following error:\nUnable to call method \"getUser\" of object \"App\\Entity\\Article\"\nI am keeping this in the current issue as it is still related to having different property/field names within an entity.. Another Update\nThis seems to be linked to the firewall. I am using JWT auth for this endpoint. If I open the endpoint up, it works.\nHow do I tell the provider to look for getOwner() instead of getUser()?. The script shared by @dunglas is a small part of the solution to this issue. However, I partially agree with @teohhanhui; any code that you write within your project becomes your own and you will be responsible for fixing bugs caused by upgrading. This will cause more issues than it will fix so the script should not be included.\nAll that said, there does need to be a way to upgrade the vendor code of the platform, if not for features, definitely for security.\nI believe the solution to this issue is not a script, but documentation.\nBy comparison, Laravel provides some fantastic documentation around upgrading, including letting you know what you may need to fix in your own code.\nThis should be fairly easily achieved with the API part of the platform since most deprecations will be symfony based. The difficult parts will be the frontend and the Docker parts. I believe that frontend should really be handled more by the developer rather than the API Platform team but this is just my opinion.\nHopefully, as a developer's project grows, they will begin splitting the codebase and infrastructure into their own entities and decoupling. This removes a lot of the problems listed above as the developer will be forced to take more ownership of the project.\nTo wrap this up: We should have better docs around upgrading the API service including depreciations and a link to Symfony upgrade docs for the correct version. Also, I would love to see documentation around upgrades in the Docker container, caching, DB, and other infrastructure changes.. ",
    "Siregacvek": "@amouhzi as far as I understand changing serialization context on-the-fly is meaningless for graphql, because you get only requested fields. Even if you change context during executing of your query, you will receive only requested data, passed in a query explicitly.. @amouhzi As you noticed ContextBuilder doesn't work for graphql. But you can register your own serializer and filter data there\nhttps://api-platform.com/docs/core/serialization#changing-the-serialization-context-on-a-per-item-basis\n. ",
    "amouhzi": "@Siregacvek What I want is to avoid giving a data to a user who is not allowed to have it just because he asked for it via the request. I want to delete it in the results before sending them.\nThe serializer will be used to filter the fields the user has requested and then execute the query. Or send to the user an error that tells him that he has requested non-existing / unauthorized fields.. @Siregacvek Thank you, I will check that and see how it works. Now we already switched to json-ld.. ",
    "samkooker": "I don't know quay.io.\nPlease how to set this variable et what is the default value ?. Excuse me. I made a bad copy of the files. The .env file was not in my directory.\nThank you for your help.. ",
    "kayneth": "I tried it and it works. But there's risks using alpha version.. \nDo you prefer to go down to react-router 3 with react-router-redux 4 and history@^3.3 ?\nFurthermore, do we really need to put react-router-redux as a dependency ? . ",
    "GonzaloRodriguezBlanco": "Hi @dunglas, thanks for your response. I have changed the Doctrine type but that does not fix the error:\nhttps://github.com/GonzaloRodriguezBlanco/api-platform/commit/7f57429b6f67bcaca38c0fdac54ff465643bcca8. @dunglas for this to work I have to connect to the database with a db client and execute\nCREATE EXTENSION IF NOT EXISTS \"uuid-ossp\";\nShouldn't we have this \"out-of-the-box\" in api-platform?\nI did a change in the docker-entrypoint.sh for this. You can check it in https://github.com/GonzaloRodriguezBlanco/api-platform/commit/965db428f4428cbe5d167c83e23a9b7fdca66ed9\nNow it works. Thanks.. @teohhanhui I agree with @dunglas about to delegate the ID creation  to the RDBMS.\n@dunglas Adding it as a comment could be a way to not \"annoy\" anybody that does not need UUID. But I think that a comment is a little hidden for those who use UUID. What do you think about a environment variable configuration to enable/disable it with a default disable value?\nIn .env.dist file:\nENABLE_UUID_POSTGRES=false\nCheck UUID explicitly enabled and Postgres as RDBMS. In docker-entrypoint.sh:\n```bash\n!/bin/sh\nset -e\nfirst arg is -f or --some-option\nif [ \"${1#-}\" != \"$1\" ]; then\n    set -- php-fpm \"$@\"\nfi\nif [ \"$1\" = 'php-fpm' ] || [ \"$1\" = 'bin/console' ]; then\n    mkdir -p var/cache var/log var/sessions\nif [ \"$APP_ENV\" != 'prod' ]; then\n    composer install --prefer-dist --no-progress --no-suggest --no-interaction\n    bin/console doctrine:schema:update --force --no-interaction\n\n            if [ \"$ENABLE_UUID_POSTGRES\" = 'true'  ] && [ -z \"${DATABASE_URL##*\"pgsql\"*}\" ]; then\n                bin/console doctrine:query:sql 'CREATE EXTENSION IF NOT EXISTS \"uuid-ossp\";'\n            fi\nfi\n\n# Permissions hack because setfacl does not work on Mac and Windows\nchown -R www-data var\n\nfi\nexec docker-php-entrypoint \"$@\"\n```\nCheck the commit: https://github.com/GonzaloRodriguezBlanco/api-platform/commit/e94868de7fee17adc1a7055694a4ffa9af719c67. @teohhanhui You are right. Following your references finally I came up with this solution:\nhttps://github.com/GonzaloRodriguezBlanco/api-platform/commit/94a6873e7950e6ddaee1df911341e6cc5dfe7941. ",
    "gquemener": "Maybe this should be/is handled directly in Symfony :thinking: . According to the php documentation:\n\nIf the size of post data is greater than post_max_size, the $_POST and $_FILES superglobals are empty\n\nIn Symfony, the only place I've found some handling of post_max_size exceeding is in the Form Component.\nWhich means that, when not using a Symfony Form, the problem will be silently ignored (unless I'm missing something?).\nMy idea of the Api Platform listener would be to check request content length against a value on all requests (no matter which http method is used) and return a 413 response when the limit has been exceeded.\nThis listener could be configured by default with the value of post_max_size, but a lower value could also be defined.\nThe whole comparison logic would be inspired on https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Form/Util/ServerParams.php#L33.\n. ",
    "peterlozano": "Docker compose doesn't seem to have started all the containers correctly:\n(MAMP7-1-8) 12:28:32 ~/Sites/api-platform/api-platform-2.2.6$ docker-compose up -d\nCreating network \"apiplatform226_default\" with the default driver\nCreating apiplatform226_admin_1       ... done\nCreating apiplatform226_client_1      ... done\nCreating apiplatform226_db_1     ... done\nCreating apiplatform226_php_1    ... done\nCreating apiplatform226_api_1    ... done\nCreating apiplatform226_cache-proxy_1 ... done\nCreating apiplatform226_h2-proxy_1    ... done\n(MAMP7-1-8) 12:28:56 ~/Sites/api-platform/api-platform-2.2.6$ docker ps\nCONTAINER ID        IMAGE                         COMMAND                  CREATED             STATUS              PORTS                    NAMES\nff9c2e2cbe62        quay.io/api-platform/nginx    \"nginx -g 'daemon of\u2026\"   22 seconds ago      Up 22 seconds       0.0.0.0:8080->80/tcp     apiplatform226_api_1\n4dea487c6f59        quay.io/api-platform/php      \"docker-entrypoint p\u2026\"   24 seconds ago      Up 23 seconds       9000/tcp                 apiplatform226_php_1\n015082ea8a19        quay.io/api-platform/client   \"/bin/sh -c 'yarn st\u2026\"   25 seconds ago      Up 12 seconds       0.0.0.0:80->3000/tcp     apiplatform226_client_1\nc3b3c23d49f1        postgres:9.6-alpine           \"docker-entrypoint.s\u2026\"   25 seconds ago      Up 25 seconds       0.0.0.0:5432->5432/tcp   apiplatform226_db_1\n304091cdc469        quay.io/api-platform/admin    \"/bin/sh -c 'yarn st\u2026\"   25 seconds ago      Up 11 seconds       0.0.0.0:81->3000/tcp     apiplatform226_admin_1. @teohhanhui Here it is:\n(MAMP7-1-8) 12:44:56 ~/Sites/api-platform/api-platform-2.2.6$ docker-compose logs cache-proxy\nAttaching to apiplatform226_cache-proxy_1\ncache-proxy_1  | + varnishd -a :80 -f /etc/varnish/default.vcl -s malloc,256m\ncache-proxy_1  | Error loading shared library libpcre.so.1: Exec format error (needed by /usr/sbin/varnishd)\ncache-proxy_1  | Error relocating /usr/sbin/varnishd: pcre_compile: symbol not found\ncache-proxy_1  | Error relocating /usr/sbin/varnishd: pcre_fullinfo: symbol not found\ncache-proxy_1  | Error relocating /usr/sbin/varnishd: pcre_exec: symbol not found\ncache-proxy_1  | Error relocating /usr/sbin/varnishd: pcre_free_study: symbol not found\ncache-proxy_1  | Error relocating /usr/sbin/varnishd: pcre_study: symbol not found\ncache-proxy_1  | Error relocating /usr/sbin/varnishd: pcre_free: symbol not found. ",
    "youmad": "I get a similar error while trying to create new entity with o2m related entities in console command.\n```\n  [Symfony\\Component\\Debug\\Exception\\FatalThrowableError]                                               \n  Type error: Return value of App\\Entity\\MyEntity::getId() must be of the type integer, null returned  \nException trace:\n App\\Entity\\MyEntity->getId() at /projectdir/vendor/symfony/property-access/PropertyAccessor.php:377\n Symfony\\Component\\PropertyAccess\\PropertyAccessor->readProperty() at /projectdir/vendor/symfony/property-access/PropertyAccessor.php:300\n Symfony\\Component\\PropertyAccess\\PropertyAccessor->readPropertiesUntil() at /projectdir/vendor/symfony/property-access/PropertyAccessor.php:90\n Symfony\\Component\\PropertyAccess\\PropertyAccessor->getValue() at /projectdir/vendor/api-platform/core/src/Api/IdentifiersExtractor.php:78\n ApiPlatform\\Core\\Api\\IdentifiersExtractor->getIdentifiersFromItem() at /projectdir/vendor/api-platform/core/src/Api/CachedIdentifiersExtractor.php:70\n ApiPlatform\\Core\\Api\\CachedIdentifiersExtractor->ApiPlatform\\Core\\Api{closure}() at /projectdir/vendor/api-platform/core/src/Api/CachedIdentifiersExtractor.php:127\n ApiPlatform\\Core\\Api\\CachedIdentifiersExtractor->getKeys() at /projectdir/vendor/api-platform/core/src/Api/CachedIdentifiersExtractor.php:71\n ApiPlatform\\Core\\Api\\CachedIdentifiersExtractor->getIdentifiersFromItem() at /projectdir/vendor/api-platform/core/src/Bridge/Symfony/Routing/IriConverter.php:92\n ApiPlatform\\Core\\Bridge\\Symfony\\Routing\\IriConverter->getIriFromItem() at /projectdir/vendor/api-platform/core/src/Bridge/Doctrine/EventListener/PurgeHttpCacheListener.php:154\n ApiPlatform\\Core\\Bridge\\Doctrine\\EventListener\\PurgeHttpCacheListener->addTagForItem() at /projectdir/vendor/api-platform/core/src/Bridge/Doctrine/EventListener/PurgeHttpCacheListener.php:137\n ApiPlatform\\Core\\Bridge\\Doctrine\\EventListener\\PurgeHttpCacheListener->addTagsFor() at /projectdir/vendor/api-platform/core/src/Bridge/Doctrine/EventListener/PurgeHttpCacheListener.php:126\n ApiPlatform\\Core\\Bridge\\Doctrine\\EventListener\\PurgeHttpCacheListener->gatherRelationTags() at /projectdir/vendor/api-platform/core/src/Bridge/Doctrine/EventListener/PurgeHttpCacheListener.php:83\n ApiPlatform\\Core\\Bridge\\Doctrine\\EventListener\\PurgeHttpCacheListener->onFlush() at /projectdir/vendor/symfony/doctrine-bridge/ContainerAwareEventManager.php:61\n Symfony\\Bridge\\Doctrine\\ContainerAwareEventManager->dispatchEvent() at /projectdir/vendor/doctrine/orm/lib/Doctrine/ORM/UnitOfWork.php:3388\n Doctrine\\ORM\\UnitOfWork->dispatchOnFlushEvent() at /projectdir/vendor/doctrine/orm/lib/Doctrine/ORM/UnitOfWork.php:370\n Doctrine\\ORM\\UnitOfWork->commit() at /projectdir/vendor/doctrine/orm/lib/Doctrine/ORM/EntityManager.php:358\n Doctrine\\ORM\\EntityManager->flush() at my command\n``\n@teohhanhui I'm using my custom image based onphp:7.2-fpm` (Debian-based, AFAIK), so don't think this issue related only to Alpine.. ",
    "tmorea05": "Any solution for this issue ? i have the same behavior :/ Everything is working on local but on preproduction environment i have this issue.\n03/12/2018 08:40:07[03-Dec-2018 07:40:07] WARNING: [pool www] child 13 said into stderr: \"2018-12-03T07:40:07+00:00 [critical] Uncaught PHP Exception GuzzleHttp\\Exception\\ConnectException: \"cURL error 6: Could not resolve host: cache-proxy (see http://curl.haxx.se/libcurl/c/libcurl-errors.html)\" at /srv/api/vendor/guzzlehttp/guzzle/src/Handler/CurlFactory.php line 185\"\n03/12/2018 08:40:07  -  03/Dec/2018:07:40:06 +0000 \"POST /index.php\" 500\n. Ok problem solved for us !  it seems that adding a prefix like 'api/v1' to our routing caused this issue and removing the prefix fixed it :). No unfortunately i had to work with app engine to make it work :) But i will try it again for sure soon.\neven if appengine is scalable i want kubernetes, got hyped lol\nThanks for asking :). ",
    "Aurelyn10": "Ok thank you \nIt was from my network setting.. ",
    "nobady90": "thanks so much, it works!\nI had not noticed this annotation in the documentation :-D\ngood day!. ",
    "amalic": "I can actually reach the client via http//localhost:80 (not 3000 as stated in the output, but i don't see the php container running. docker ps results in\nCONTAINER ID        IMAGE                          COMMAND                  CREATED             STATUS              PORTS                                                                    NAMES\n2b9e267030a4        apiplatform_h2-proxy           \"nginx -g 'daemon ...\"   39 minutes ago      Up 13 minutes       0.0.0.0:443-444->443-444/tcp, 80/tcp, 0.0.0.0:8443-8444->8443-8444/tcp   apiplatform_h2-proxy_1\n236a0a2d4d05        quay.io/api-platform/varnish   \"docker-app-start\"       39 minutes ago      Up 13 minutes       0.0.0.0:8081->80/tcp                                                     apiplatform_cache-proxy_1\n6230991d8b39        quay.io/api-platform/nginx     \"nginx -g 'daemon ...\"   39 minutes ago      Up 13 minutes       0.0.0.0:8080->80/tcp                                                     apiplatform_api_1\n9090d7b4db83        quay.io/api-platform/admin     \"/bin/sh -c 'yarn ...\"   39 minutes ago      Up 13 minutes       0.0.0.0:81->3000/tcp                                                     apiplatform_admin_1\nd162224fab71        quay.io/api-platform/client    \"/bin/sh -c 'yarn ...\"   39 minutes ago      Up 13 minutes       0.0.0.0:80->3000/tcp                                                     apiplatform_client_1\n7220ebea66b6        postgres:9.6-alpine            \"docker-entrypoint...\"   39 minutes ago      Up 13 minutes       0.0.0.0:5432->5432/tcp                                                   apiplatform_db_1\n. yes on windows. which file do you think is causing the issue?. i guess i need to switch to your branch first?. works now\ngetting this output at the end of the first startup\nphp_1          | Generating autoload files\nphp_1          | Executing script cache:clear [OK]\nphp_1          | Executing script assets:install [OK]\nphp_1          |\nphp_1          |\nphp_1          |  Updating database schema...\nphp_1          |\nphp_1          |      2 queries were executed\nphp_1          |\nphp_1          |  [OK] Database schema updated successfully!\nphp_1          |\nphp_1          | [16-May-2018 13:27:23] NOTICE: fpm is running, pid 1\nphp_1          | [16-May-2018 13:27:23] NOTICE: ready to handle connections\nplease merge into master\nCould you please explain your change?. What about fixing it within the container during the build process? Here's what I am doing in one of my projects.\nRUN sed -i -e 's/\\r$//' bin/*\nsee http://www.tech-wiki.net/index.php?title=Remove_DOS_line_endings_from_Text_files_(CR/LF). ",
    "Seb33300": "I had the same issue and replacing \\r\\n by \\n  in bin/console solved the problem.. ",
    "micheldumontier": "with docker for windows, i easily provide credentials for docker to access the shared drive. but something else is happening... i wonder if it is related to paths in docker-compose.yml. ok. it was because i had the api-platform directory in a symbolic link directory. feel free to close this!. ",
    "akorz": "Thank you for reply. Do you know any good alternatives for building REST API with Simfony?. Ok. Let me check docs. I hope I'll find something useful. Thanks. I'm checking your links right now. Btw. I found I good blog post https://stefanoalletti.wordpress.com/2018/03/07/symfony-api-platform-cqrs-part-1/. ",
    "romaricp": "Found with this way : \n```\nconfig/routes.yml\napi_platform:\n    resource: '.'\n    type:     'api_platform'\n    prefix:   '/api/v1'\n```\n\n. ",
    "Noukk": "Yes, In graphql-php version < 0.12.0 it's works\nThanks. ",
    "dvc": "Best for me workaround:\nI`ve found an example of EntityNormalizer: https://medium.com/@maartendeboer/using-the-symfony-serializer-with-doctrine-relations-69ecb17e6ebd\nMinor code changes vs article example:\nin config add custom priority (>8 and <64):\nApp\\Serializer\\Normalizer\\:\n        resource: '../src/Serializer/Normalizer'\n        tags:\n            - { name: 'serializer.normalizer', priority: 10 }\nin denormalize add iri support and disable normalization support (to avoid serialization issues): \n```\n    /*\n     * {@inheritdoc}\n     /\n    public function supportsNormalization($data, $format = null)\n    {\n        return false;\n    }\npublic function denormalize($data, $class, $format = null, array $context = [])\n{\n    // iri used only in jsonld,\n    if ($format === 'jsonld') {\n        try {\n            return $this->iriConverter->getItemFromIri($data);\n        } catch (\\InvalidArgumentException $e) {\n            // do not catch if not supported plain ids in jsonld\n        }\n    }\n\n    // use as plain id\n    try {\n        return $this->em->find($class, $data);\n    } catch (\\Exception $e) {\n        throw new ItemNotFoundException(sprintf('Item not found for \"%s\".', $data));\n    }\n}\n\n```. 3. Why? \nI want to use default functional from most external layer. Route aliases like API syntax shugar.\nIMHO, subresources - is real bad idea. Too many problems for just an route alias...\nAnyway, it`s not trivial to add more query params for filter because of https://github.com/api-platform/core/blob/master/src/Util/RequestParser.php#L88\nI can`t modify already parsed Request.query.parameters, because they not used in ReadListener.\nI will not modify server QUERY_STRING - it`s really bad idea.\n301 redirect... no. I don`t like it.\nSo, continue looking in deep of ReadListener... :(\nThank you, @teohhanhui . Well... I`ve found one fine configuration: custom entity operation + custom data provider:\n```\nconfig/api_resources/Deal.yaml\nApp\\Entity\\Exchange\\Deal:\n...\n    collectionOperations:\n        get:\n            method: 'GET'\n            path: '/exchange/deals'\n            normalization_context:\n                groups: ['deal:read:list']\n        # !!! that`s it :)\n        get_by_ad:\n            method: 'GET'\n            path: '/exchange/ads/{ad}/deals'\n            # custom operation normalization context\n            normalization_context:\n                groups: ['deal:read:sub_ad']\n            # custom swagger context  to allow set \"ad\" value\n            swagger_context:\n                parameters:\n                    - {name: 'ad', type: 'string', in: 'path', required: true}\n```\nadd filter to Deal\n```\nsrc/Entity/Exchange/Deal.php\n...\nuse ApiPlatform\\Core\\Annotation\\ApiFilter;\nuse ApiPlatform\\Core\\Bridge\\Doctrine\\Orm\\Filter\\SearchFilter;\n...\n/*\n * @ApiFilter(SearchFilter::class,properties={\n *     \"ad\":\"exact\",\n * })\n * @ORM\\Entity()\n /\nclass Deal\n{\n...\n```\n```\nconfig/services.yaml\nservices:\n    _defaults:\n        bind:\n            ApiPlatform\\Core\\DataProvider\\CollectionDataProviderInterface: '@api_platform.doctrine.orm.default.collection_data_provider'\n...\n```\nN.B.! ContextAwareCollectionDataProviderInterface implemented in data provider. We have $context!\n```\n<?php\ndeclare(strict_types=1);\nnamespace App\\DataProvider\\Exchange;\nuse ApiPlatform\\Core\\DataProvider\\CollectionDataProviderInterface;\nuse ApiPlatform\\Core\\DataProvider\\ContextAwareCollectionDataProviderInterface;\nuse ApiPlatform\\Core\\DataProvider\\RestrictedDataProviderInterface;\nuse ApiPlatform\\Core\\Exception\\ResourceClassNotSupportedException;\nuse App\\Entity\\Exchange\\Deal;\nuse Symfony\\Component\\HttpFoundation\\RequestStack;\nfinal class GetDealsByAdDataProvider implements ContextAwareCollectionDataProviderInterface, RestrictedDataProviderInterface\n{\n    /\n     * @var ContextAwareCollectionDataProviderInterface\n     */\n    private $collectionDataProvider;\n    /\n     * @var RequestStack\n     */\n    private $requestStack;\npublic function __construct(\n    CollectionDataProviderInterface $collectionDataProvider,\n    RequestStack $requestStack\n) {\n    $this->collectionDataProvider = $collectionDataProvider;\n    $this->requestStack = $requestStack;\n}\n\npublic function supports(string $resourceClass, string $operationName = null, array $context = []): bool\n{\n    return Deal::class === $resourceClass && $operationName === 'get_by_ad';\n}\n\n/**\n * Retrieves a collection.\n *\n * @throws ResourceClassNotSupportedException\n *\n * @return array|\\Traversable\n */\npublic function getCollection(string $resourceClass, string $operationName = null, array $context = [])\n{\n    $customizedContext = $context;\n    $request = $this->requestStack->getCurrentRequest();\n    $adId = $request->attributes->get('ad', '');\n    $customizedContext['filters']['ad'] = $adId;\n\n    return $this->collectionDataProvider->getCollection($resourceClass, $operationName, $customizedContext);\n}\n\n}\n```. @soyuka , thank you for answer!\nI'm not sure too. I want to avoid coupling between common and special staff of building DTO. May be something like option/interface \"continue\" or \"last/final\" for DataProvider. CurrentUserAwareProvider is \"continue\" provider. SomeEntityAwareProvider - final.  \"stopPropagation\". But now according to documentation \"The first able to retrieve data for a given resource will be used\". No chain.\nMay be easier to do common staff by 'kernel.*' event listeners. But it`s not so semantic than \"data provider\", imho.\nI can configure my own Middleware chain for every subset, but it will one more custom abstraction. Too complex for combine 2-3 handlers. . Ok. Thank you. Close. ",
    "thib92": "@soyuka I already provided a screenshot of the Profiler's Router section, and that's actually the weird part : the bottom view says it reached my route, but the top part says it actually used the Api Platform default one.\nThere is a not at the bottom of this page :\n\nNote: These matching logs are based on the current router configuration, which might differ from the configuration used when profiling this request.\n\nThis is pretty interesting, because I think it means that it's not actually showing the matching used during the profiled request, but instead the same matching as when I did bin/console router:match. Okay, so that was pretty weird :\nMy token timed out from this morning, so I created a new one from login (I am using the JWT bundle), and after puting the new one in my Authorization header, and changing the controller method to return [\"test\" => \"test\"], it worked. Then, switching back to the real code (return $this->getUser()), it worked as well, and I couldn't get it not to work anymore, to find out the source of my issue. That's pretty weird.. No, I cleared it every time I tried something new.. ",
    "JensvdHeydt": "My bad:\n\nuse ApiPlatform\\Core\\Serializer\\Filter\\PropertyFilter;\n\nsolved my issue.. ",
    "guilhermeaiolfi": "I realized I was looking for similar issues in the wrong repository. I discovered api-platform today, so I don't know how it works. But for what I've seen so far, moving away from http-foundation and embracing PSR-7 would a pretty good start. It was discussed here: https://github.com/api-platform/core/issues/474, but it was closed without any explanation. Maybe we should close this issue and reopen that one? Same thing happened here: https://github.com/api-platform/core/issues/474. That's only part of the problem. For JSONAPI for example, it uses HttpFoundation listeners.  Other than that I have no idea where to start coding. What do I need to bootstrap api-platform? It seems that all parts of the project uses symphony config system that I don't have. . GraphQL format is still using HttpFoundation for request and responses (besides listeners). \nIf we are going to the framework agnostic road, we should consider api-platform as a library and not a framework. And it being a library I don't think it should be using DI containers at all. \nWhat I would like to see is an example of using api-platform without routes, DI containers, listeners or any other concept that belongs to the framework scope. Basically take a request, read its content, configure the schema and make the library respond to what's been asked for in the format I want. I was able to do that in GraphQL in 60 lines of code. \nI may be wrong, but api-platform seems to solve the same problem with an extra layer of abstraction. So the thing I did using GraphQL should be an achievable goal too and it would reduce the complexity to get started.\nMiddlewares/listeners/services would exist to automate the integration to frameworks but not a hard dependency to use the library.. Hello again, good people,\nany work was done to make it easier to accomplished this?. ",
    "BertrandDev": "Note : disabling eager loading fixes the problem\n@ORM\\OneToMany(targetEntity=\"Color\", mappedBy=\"owner\", fetch=\"EXTRA_LAZY\"). I think the spider should run away from my mouse cursor instead of staying here in a disrespectful way, like, \"Hey, I'm not scared, I'm the boss of this API.\" Critical issue. ",
    "nickvanderzwet": "Is there any other solution for retrieving results based on multiple-value field?. ",
    "claudiunicolaa": "With the last version of Docker, everything works great. \nThanks!. ",
    "vinyvicente": "ok, @teohhanhui , but I won't change my integer ids, just I/O actions with hashids or uuid and translate to integer and persist internally. Make sense it?. @teohhanhui , exactly this. How I expose or receive to persist some entity?. @teohhanhui not. I'll read just. Receive and transform and integer, or show as hashid. Internally is integer. It's best way because uuid increase the database size significantly. Is most like masked integer, to security, in this case :). @soyuka I'll try it. Keep issue I show the result :)\nTks 4 support :+1: . Thanks @dunglas !. ",
    "siewert87": "Sure.\nbash\nchristian@clmpc ~/daten/projects/symfony/api-platform $ docker-compose logs -f db\nAttaching to apiplatform_db_1\ndb_1           | The files belonging to this database system will be owned by user \"postgres\".\ndb_1           | This user must also own the server process.\ndb_1           | \ndb_1           | The database cluster will be initialized with locale \"en_US.utf8\".\ndb_1           | The default database encoding has accordingly been set to \"UTF8\".\ndb_1           | The default text search configuration will be set to \"english\".\ndb_1           | \ndb_1           | Data page checksums are disabled.\ndb_1           | \ndb_1           | fixing permissions on existing directory /var/lib/postgresql/data ... ok\ndb_1           | creating subdirectories ... ok\ndb_1           | selecting default max_connections ... 100\ndb_1           | selecting default shared_buffers ... 128MB\ndb_1           | selecting dynamic shared memory implementation ... posix\ndb_1           | creating configuration files ... ok\ndb_1           | running bootstrap script ... ok\ndb_1           | sh: locale: not found\ndb_1           | performing post-bootstrap initialization ... No usable system locales were found.\ndb_1           | Use the option \"--debug\" to see details.\ndb_1           | ok\ndb_1           | syncing data to disk ... ok\ndb_1           | \ndb_1           | Success. You can now start the database server using:\ndb_1           | \ndb_1           |     pg_ctl -D /var/lib/postgresql/data -l logfile start\ndb_1           | \ndb_1           | \ndb_1           | WARNING: enabling \"trust\" authentication for local connections\ndb_1           | You can change this by editing pg_hba.conf or using the option -A, or\ndb_1           | --auth-local and --auth-host, the next time you run initdb.\ndb_1           | waiting for server to start....LOG:  database system was shut down at 2018-06-20 16:52:59 UTC\ndb_1           | LOG:  MultiXact member wraparound protections are now enabled\ndb_1           | LOG:  database system is ready to accept connections\ndb_1           | LOG:  autovacuum launcher started\ndb_1           |  done\ndb_1           | server started\ndb_1           | CREATE DATABASE\ndb_1           | \ndb_1           | CREATE ROLE\ndb_1           | \ndb_1           | \ndb_1           | /usr/local/bin/docker-entrypoint.sh: ignoring /docker-entrypoint-initdb.d/*\ndb_1           | \ndb_1           | LOG:  received fast shutdown request\ndb_1           | LOG:  aborting any active transactions\ndb_1           | LOG:  autovacuum launcher shutting down\ndb_1           | waiting for server to shut down...LOG:  shutting down\ndb_1           | .LOG:  database system is shut down\ndb_1           |  done\ndb_1           | server stopped\ndb_1           | \ndb_1           | PostgreSQL init process complete; ready for start up.\ndb_1           | \ndb_1           | LOG:  database system was shut down at 2018-06-20 16:53:20 UTC\ndb_1           | LOG:  MultiXact member wraparound protections are now enabled\ndb_1           | LOG:  database system is ready to accept connections\ndb_1           | LOG:  autovacuum launcher started. Ok, thanks for the hint.. Hey @jcarrier-vp,\n\nfirst of all you should try to open http://127.0.0.1/ (do not point :3000 directly) in your browser.\n\nYou are absolutely right. It's working like a charm now. Thank you!\nBest,\nChristian . From api-platform/core/src/EventListener/ReadListener.php\nphp\n            if (isset($attributes['item_operation_name'])) {\n                $data = $this->getItemData($identifiers, $attributes, $context);\n            } elseif (isset($attributes['subresource_operation_name'])) {\nFrom the docs:\n/**\n     * @Route(\n     *     name=\"book_special\",\n     *     path=\"/books/{id}/special\",\n     *     methods={\"PUT\"},\n     *     defaults={\n     *         \"_api_resource_class\"=Book::class,\n     *         \"_api_item_operation_name\"=\"special\"\n     *     }\n     * )\n     */\nWhen omitting the underscore, everything is working as expected. I'll close this issue, but you guys should improve the docs.\nBest,\nChristian. I also disabled docs on prod and it's working now:\nenable_docs: false. ",
    "MustaphaGhlissi": "I resolved it by doing this : \napi:\n    resource: '.'\n    type:     'api_platform'\n    prefix: '/' \nThanks.. ",
    "Sermanes": "Works for me really thanks. ",
    "gun1x": "What was the solution to this issue? Can you post the working nginx config?. ",
    "jcarrier-vp": "Hi @siewert87 , \nfirst of all you should try to open http://127.0.0.1/ (do not point :3000 directly) in your browser. You should get the client page (cf the screenshot) and then follow the https link in the admin section.\nThe client and the admin are running on the same port but from different containers.\n\n. ",
    "omarking05": "Hey Guys, I have run into the same issue, after installing i'm able to open the client on http://127.0.0.1 but using https://127.0.0.1 is not working nor any of the links on the client.\ndocker-compose ps\n```\n             Name                           Command               State            Ports         \n\napi-platform-233_admin_1         /bin/sh -c yarn start            Up       0.0.0.0:81->3000/tcp\napi-platform-233_api_1           nginx -g daemon off;             Up       0.0.0.0:8080->80/tcp\napi-platform-233_cache-proxy_1   docker-varnish-entrypoint  ...   Exit 2                       \napi-platform-233_client_1        /bin/sh -c yarn start            Up       0.0.0.0:80->3000/tcp\napi-platform-233_db_1            docker-entrypoint.sh postgres    Up       0.0.0.0:5432->5432/tcp\napi-platform-233_h2-proxy_1      nginx -g daemon off;             Exit 1                       \napi-platform-233_php_1           docker-entrypoint php-fpm        Up       9000/tcp \n``. Oh just realized that this was a problem inapi-platform-233_h2-proxy_1` as its state was Exit 1. I figured its related to #777 and its solved after cloning the repo. Hi @dunglas I used Ubuntu's default Archive Manager v3.16.5.. ",
    "kpn13": "Great, thank you !. Ok thanks ! \nAnd declare my Clent class as an API Resource in order to benefit of the built-in API Plateform doc but without having the generated route could be an other solution ?\n. Hi,\nFinally I just do what you suggest by using  a \"swaggerdecorator\" like that : \nphp\n<?php\n$docs['definitions']['Document-read']['properties']['client']['type'] = 'object';\n$docs['definitions']['Document-read']['properties']['client']['properties'] = ['id', 'name'];\n$docs['definitions']['Document-read']['properties']['client']['properties']['name']['type'] = 'string';\n$docs['definitions']['Document-read']['properties']['client']['properties']['name']['example'] = 'foo';\nThanks !. ",
    "nblaudez": "You use can Doctrine event : \nhttps://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/events.html#lifecycle-events\nThat works for me.\nThe ProfileSubscriber.php in app/EventSubscriber:\n```php\n<?php\nnamespace App\\EventSubscriber;\nuse Doctrine\\ORM\\Event\\LifecycleEventArgs;\nuse App\\Entity\\Product;\nuse Symfony\\Component\\DependencyInjection\\ContainerInterface as Container;\nuse App\\Entity\\Profile;\nclass ProfileSubscriber\n{\n    private $container;\npublic function __construct(Container $container) {\n    $this->container = $container;\n}\n\npublic function postLoad(LifecycleEventArgs $args)\n{\n    $profile = $args->getEntity();\n    $em = $args->getEntityManager();\n\n    if ($profile instanceof Profile) {\n        $user = $this->container->get('token_storage')->getToken();\n        if ($user->getId() != $profile->getUser()->getId()) {\n            $profileVisit = new ProfileVisit();\n            $profileVisit->setProfile($profile);\n            $profileVisit->setUser($user);\n            $em->persist($profileVisit);\n            $em->getEntityManager()->flush();\n        }\n    }\n}\n\n}\nIn your config/service.yml :yaml\n    app.datingprofile_subscriber:\n        class: App\\EventSubscriber\\ProfileSubscriber\n        arguments: ['@service_container']\n    tags:\n        - { name: doctrine.event_listener, event: postLoad }\n\n```. ",
    "SkvokeN": "Hello, is there news about events?. Thank you! . Thank you \ud83d\udc4d . ",
    "MartinSkytte": "it dies and exits. I do not know why, but did not see that before now (newbie mistake)\naccording to the logs, it gets a permission denied on bin/console\nhp_1          | Loading composer repositories with package information\nphp_1          | Installing dependencies (including require-dev) from lock file\nphp_1          | Nothing to install or update\nphp_1          | Generating autoload files\nphp_1          | Executing script cache:clear [OK]\nphp_1          | \nphp_1          | Executing script assets:install [OK]\nphp_1          | /usr/local/bin/docker-entrypoint: line 19: bin/console: Permission denied\nphp_1          | Loading composer repositories with package information\nphp_1          | Installing dependencies (including require-dev) from lock file\nphp_1          | Nothing to install or update\nphp_1          | Generating autoload files\nphp_1          | Executing script cache:clear [OK]\nphp_1          | \nphp_1          | Executing script assets:install [OK]\nphp_1          | /usr/local/bin/docker-entrypoint: line 19: bin/console: Permission denied\nphp_1          | Loading composer repositories with package information\nphp_1          | Installing dependencies (including require-dev) from lock file\nphp_1          | Nothing to install or update\nphp_1          | Generating autoload files\nphp_1          | Executing script cache:clear [OK]\nphp_1          | \nphp_1          | Executing script assets:install [OK]\nphp_1          | /usr/local/bin/docker-entrypoint: line 19: bin/console: Permission denied\nphp_1          | Loading composer repositories with package information\nphp_1          | Installing dependencies (including require-dev) from lock file\nphp_1          | Nothing to install or update\nphp_1          | Generating autoload files\nphp_1          | Executing script cache:clear [OK]\nphp_1          | \nphp_1          | Executing script assets:install [OK]\nphp_1          | /usr/local/bin/docker-entrypoint: line 19: bin/console: Permission denied\nI have totally overlooked this in my search.. Just tried it, and it did not work.\nphp_1          | Loading composer repositories with package information\nphp_1          | Installing dependencies (including require-dev) from lock file\nphp_1          | Nothing to install or update\nphp_1          | Generating autoload files\nphp_1          | Executing script cache:clear [OK]\nphp_1          | \nphp_1          | Executing script assets:install [OK]\nphp_1          | /usr/local/bin/docker-entrypoint: line 20: bin/console: Permission denied\nvagrant_php_1 exited with code 126\nStill with a permission denied\nThe change i tried:\n```shell\n!/bin/sh\nset -e\nfirst arg is -f or --some-option\nif [ \"${1#-}\" != \"$1\" ]; then\n    set -- php-fpm \"$@\"\nfi\nif [ \"$1\" = 'php-fpm' ] || [ \"$1\" = 'bin/console' ]; then\n    mkdir -p var/cache var/log var/sessions\nif [ \"$APP_ENV\" != 'prod' ]; then\n    composer install --prefer-dist --no-progress --no-suggest --no-interaction\n    chmod +x bin/console; sync\n    bin/console doctrine:schema:update --force --no-interaction\nfi\n\n# Permissions hack because setfacl does not work on Mac and Windows\nchown -R www-data var\n\nfi\nexec docker-php-entrypoint \"$@\"\n```. it could be. will check it on my windows 10 pro with hyper-v in a minute. It must be, because now it works in windows 10 pro using docker for windows by default. Thank you so much for your help.. ",
    "alpha1125": "I did... but now that I gave it an hour, it's ran past that now. and now it works... thanks.\n. ",
    "Steveb-p": "This behaves consistently with how Symfony framework does those checks. I doubt there is anything that Api platform can do in this matter.\nThis comes down to Form component first applying changes to objects (calling your setter, or acquiring access to property in any other way - check PropertyAccessor) and only after that in FormEvents::POST_SUBMIT calling ValidationListener (with a priority set for this listener as well as I recall).. ",
    "zukko1": "@soyuka my problem basically is that when I generate a typescript interface for example:\nexport interface User {\n  '@id': string;\n  '@type': string;\n  username: string;\n  salt?: any;\n  password: string;\n  roles: string[];\n  isActive: boolean;\n  groups: string[];\n}\nthe @id and @type attributes I can not access, this is my service method:\npublic GetList() {\n    return this.http.get<User[]>(this.url)\n            .pipe(map(data => data['hydra:member']))\n            .subscribe(\n                 (restItems: User[]) => this.usersSubject.next(restItems)\n      );\n  }\nwhen i try to access restItems[0].'@id'  I know that this attribute can not be accessed but it is what I am trying to do.\nand @dunglas i will to try use that library tks!\n. ",
    "webda2l": "Hello,\nI met some problems last week too about behat testing. Here is my way:\n1 - First, keep only one php-docker, with .env file configured for dev (or prod). It will be able to run your tests too\n2.A - Configure your config/packages/test/doctrine.yaml directly with your sqlite db used for tests\ndoctrine:\n    dbal:\n        driver: 'pdo_sqlite'\n        charset: 'UTF8'\n        url: 'sqlite:///%kernel.cache_dir%/db.sqlite'\n2.B - Or alternatively, configure, at a higher level, your config/packages/doctrine.yaml with default value DATABASE_URL to your sqlite db used for tests\n```\nparameters:\n    env(DATABASE_URL): 'sqlite:///%kernel.cache_dir%/db.sqlite'\ndoctrine:\n    dbal:\n        driver: 'pdo_pgsql'\n        server_version: '10.3'\n        url: '%env(resolve:DATABASE_URL)%'\n...\n```\n3 - And so, run your commands related to test env, with APP_ENV=test prerequisite, like:\nAPP_ENV=test bin/console c:c\nAPP_ENV=test bin/console d:s:d -f\nAPP_ENV=test bin/console d:s:u -f\nAPP_ENV=test behat --colors\n\nPersonally, I use composer scripts, and configure them as:\n...\n    \"scripts\": {\n         ...\n        \"prepare\": [\n            \"bin/console c:c\",\n            \"bin/console d:d:c --if-not-exists\",\n            \"bin/console d:s:d -f\",\n            \"bin/console d:s:u -f\",\n            \"APP_ENV=test bin/console c:c\"\n        ],\n        \"behat\": [\n            \"APP_ENV=test bin/console d:s:d -f\",\n            \"APP_ENV=test bin/console d:s:u -f\",\n            \"APP_ENV=test behat --colors\"\n        ],\nto ease:\ndocker-compose exec php composer run-script prepare\ndocker-compose exec php composer run-script behat. Additionally, the data-only containers could be nice maybe? http://stackoverflow.com/a/36187864/520114\n. To avoid copying data inner this docker, the data-only containers pattern use, could be nicer no? http://stackoverflow.com/a/36187864/520114\nAnd, by the way, more globally speaking about this Dockerfile, to continue with the already nginx alpine use, the php:7-fpm-alpine use instead php:7.0-fpm will be nicer.. ",
    "geerlingguy": "Formatting for the above comment:\nphp\n    /**\n     * @BeforeScenario\n     */\n    public function createDatabase()\n    {\n        $this->schemaTool->dropDatabase();\n        $this->schemaTool->createSchema($this->classes);\n    }. So next step, I grabbed the example behat.yml from the demo project: https://github.com/api-platform/demo/blob/master/api/behat.yml.dist\nI placed it in api/behat.yml, and then ran:\ndocker-compose exec php composer require --dev behatch/contexts behat/mink behat/symfony2-extension\n\nAnd then ran docker-compose exec php vendor/bin/behat, and get:\n```\nIn SymfonyFactory.php line 54:\nInstall MinkBrowserKitDriver in order to use the symfony2 driver. \n```\nSo now, docker-compose exec php composer require --dev behat/mink-browserkit-driver to grab that, and then after running Behat again:\n```\n$ docker-compose exec php vendor/bin/behat\nFeature:\n  In order to prove that the Behat Symfony extension is correctly installed\n  As a user\n  I want to have a demo scenario\nIn ConstructorArgumentOrganiser.php line 81:\nFeatureContext::__construct() does not expect argument $doctrine. \n```\nSo I set that context to just:\nyaml\n  suites:\n    default:\n      contexts:\n        - FeatureContext\nAnd now it seems to run the tests\u2014but it's running them against the pgsql database. So next step is I'll look again at #742 and see if I can get it to use the sqlite database.. So, I have a working setup, following partly along with the steps in #742:\napi/behat.yml contents:\nyaml\ndefault:\n  calls:\n    error_reporting: 16383 # E_ALL & ~E_USER_DREPRECATED\n  suites:\n    default:\n      contexts:\n        - FeatureContext\n        - Behat\\MinkExtension\\Context\\MinkContext\n        - Behatch\\Context\\RestContext\n        - Behatch\\Context\\JsonContext\n  extensions:\n    Behat\\Symfony2Extension:\n      kernel:\n        bootstrap: \"features/bootstrap/bootstrap.php\"\n        class: \"App\\\\Kernel\"\n    Behat\\MinkExtension:\n      base_url: \"http://localhost/\"\n      sessions:\n        default:\n          symfony2: ~\n    Behatch\\Extension: ~\napi/composer.json scripts entry:\njson\n        \"behat\": [\n            \"bin/console c:c --env=test\",\n            \"bin/console d:d:c --env=test\",\n            \"bin/console d:s:d -f --env=test\",\n            \"bin/console d:s:u -f --env=test\",\n            \"APP_ENV=test behat --colors\"\n        ]\nThen run:\ndocker-compose exec php composer run-script behat\n\nI can get the tests to pass locally, but not when I run in the CI environment under Travis CI. It's so strange, because the deps are locked in using Composer, and the environment is all contained within Docker, so it should be identical :-/\nOn CI I get:\n```\nIn ConstructorArgumentOrganiser.php line 81:\nFeatureContext::__construct() does not expect argument $kernel.  \n``. Ah. Didn't realize there was already abehat.yml.distincluded in the repo (and that mybehat.yml` was not being committed at all!).\nI committed my behat.yml, and now tests are passing in Travis CI.\nSo next step\u2014should this be closed as 'works as designed', or is the intent of the testing docs page to go from 'new API project' to 'tests working with Behat'? Because right now there are a number of setup steps left out of that doc which seem necessary to be able to do any testing or follow the example.. @dunglas - Perfectly understandable, thanks for the clarification!\nI'll take a crack at upgrading the docs, since it's still fresh and I'm guessing I'll have to refer to them again myself, next time I set up an API ;). ",
    "simonackermann": "Thanks for your response.\nWhen i added the _api_receive flag it went directly to the controller but then I need to set all the properties of the Entity manually.\nBefore I already recived the Entity/Object with the properties send on the json set and was able to just set one of the parameters\nwith the _api_recive flag i have to do something like this:\n```php\npublic function __invoke(Request $request): ?Event\n    {\n        $data = json_decode($request->getContent());\n        $start = $data->start;\n        // .... get the data recived by json\n    $entityManager = $this->getDoctrine()->getManager();\n\n    $event = new Event();\n    $event->setStart(new DateTime($start));\n    // set the other properties\n\n    $entityManager->persist($event);\n    $entityManager->flush();\n\n    return $event;\n}\n\n```\nbefore i could do this:\n```php\npublic function __invoke(Event $data): ?Event\n    {\n        // $data is the Event object with the properties set\n        $data->setEventType(/the event type Entity/);\n    return $data;\n}\n\n```\nI'm not sur if it is clear. I had the response i needed on stack over flow\nhttps://stackoverflow.com/questions/51153880/symfony-4-api-platform-jwt-custom-operations-and-controllers \nPost methods need to be collectionOperations not itemOperations. ",
    "cryptton2004": "Lovely, thank you \ud83d\udc4d . ",
    "justinas-kazanavicius": "Whoops, I ran composer install outside of my VM. After running it inside vagrant it works fine. . ",
    "Lobosque": "thanks @BatsaxIV, adding it to the subresource worked.. @videni I have exactly the same problem. Were you able to solve this?. @videni thank you for sharing your solution.\nEven though we can work around the problem with a custom denormalizer, I still think this it should accept empty values and leave the validator to handle if it is valid or not.. Hi @soyuka \nI forgot to mention but I tried both on the property and on the class. I was actually hoping my url syntax was not correct.\nI tried clearing the cache with the class annotation and the property annotation and I still get everything. In fact, looking at the query generated, it doesn't add anything related to the search.\n. Coincidentally I have an approved field both on Campaign and Product.\nI added the following annotation to the Campaign class:\n@ApiFilter(BooleanFilter::class, properties={\"approved\", \"product.approved\"})\n{{url}}/api/campaigns/?approved=true works as expected\nwhile {{url}}/api/campaigns/?product.approved=true brings all results without filtering.\nAre there specific conditions that the related entity needs to match in order for the filter to be taken into account?. @soyuka the problem was appending a slash and getting a 301 redirect:\n{{url}}/api/campaigns/?product.name=art ---> do not work\n{{url}}/api/campaigns?product.name=art  ----> works\nI only figured this out thanks to your tip about using the Hydra serialization. It looks like with the redirect, the dot get translated to an underscore somewhere:\n\"hydra:view\": {\n        \"@id\": \"/api/campaigns?product_name=art\",\n        \"@type\": \"hydra:PartialCollectionView\"\n    },\nWhile this is definitely a bug, this is probably not related to Api Platform.. ",
    "robinstraub": "I just realized that I was missing a \"/\" on my api firewall pattern (it should be pattern:   ^/api/). This way the nelmio page can be accessed without being authenticated, but requests to the API routes need to have authentication, which the api_platform configuration indeed enables correctly.. ",
    "cestcri": "Thanks for getting back to me @teohhanhui !\nI'm not using Docker, not sure if this is a problem/not supported by the API platform? Maybe I should go for good old Symfony instead of API platform then?. I did do this (found this on the Symfony doc) but this won't fix the problem if your APP_ENV is already set to dev, which is for whatever reason my case. The suggested change makes this more robust and avoids imho users to struggle for nothing.. Fine with me, it was just a suggestion. It's fine on the Symfony doc, that's where I found the hint (which, as described, didn't solve the problem, and which is why I made this suggestion).. ",
    "borNfreee": "IMO, this is a workaround, because:\n\nID is already in the URL: PUT /users/33\nwhen we are working with Entity, we don't need to add @id, so why do we need it with DTO?\n\n\nI found the reason of this issue:\nhttps://github.com/api-platform/core/blob/e0c6134d70e245c5cb258e5defb3bc87e6c03fca/src/EventListener/DeserializeListener.php#L87-L97\nhere, $requestContent contains the data for populating DTO ({ \"name\": \"some string\"}), while $context contains the Entity object under object_to_populate\nphp\narray(8) {\n  [\"item_operation_name\"]=>string(3) \"put\"\n  [\"operation_type\"]=>string(4) \"item\"\n  [\"api_allow_update\"]=>bool(true)\n  [\"resource_class\"]= string(15) \"App\\Dto\\UserDto\"      <--- note this UserDto, not User entity\n  [\"object_to_populate\"]=>\n  object(stdClass)#2096 (3) {\n    [\"__CLASS__\"]=>\n    string(15) \"App\\Entity\\User\"\n    [\"id:App\\Entity\\User:private\"]=>\n    int(1)\n    [\"name\"]=>\n    string(6) \"string\"\n  }\n}\nSince resource_class is DTO, but object_to_populate is an Entity, deserialize() does not work properly.\nWhy object_to_populate has Entity instead of DTO? Because DataProvider returns it:\nphp\npublic function getItem(string $resourceClass, $id, string $operationName = null, array $context = [])\n{\n    return $this->userRepository->find((int) $id);\n}\nSo, to fix this issue, we can simply return UserDto from DataProvider with this simple change:\n```diff\npublic function getItem(string $resourceClass, $id, string $operationName = null, array $context = [])\n{\n-        return $this->userRepository->find((int) $id);\n+       $userEntity = $this->userRepository->find((int) $id);\n\n$dto = new UserDto();\n$dto->name = $userEntity->getName();\n$dto->id = $userEntity->getId(); // <--------- key line return $dto;\n\n}\n```\n\n\n\nThis is not obvious from the documentation so I had to debug the whole process. Would you be interested in adding some kind of Cookbook entry to the documentation with DTO for POST/PUT operations? If so, I can create a ticket with all classes needed to achieve this.\nRelated article with similar solution (again, not official one): https://stefanoalletti.wordpress.com/2018/03/07/symfony-api-platform-cqrs-part-1/. In my test suite, when I pass '' (blank string), I got the followign 400 validation error:\nThe data is either an empty string or null, you should pass a string that can be parsed with the passed format or a valid DateTime string.\nSymfony 4.1, api-platform/core v2.3.0. Apologize, this was a typo, I meant 400 Bad Request.\nSo the response I get is the following:\n400 Bad Request (debug mode)\njson\n{\n  \"type\": \"https://tools.ietf.org/html/rfc2616#section-10\",\n  \"title\": \"An error occurred\",\n  \"detail\": \"The data is either an empty string or null, you should pass a string that can be parsed with the passed format or a valid DateTime string.\",\n  \"trace\": [\n     \" %the very big trace dump%\" <----------------\n  ]\nIn comparison, the usual validation error response is much more smaller:\njson\n{\n  \"type\": \"https://tools.ietf.org/html/rfc2616#section-10\",\n  \"title\": \"An error occurred\",\n  \"detail\": \"product: This value should not be blank.\",\n  \"violations\": [\n    {\n      \"propertyPath\": \"product\",\n      \"message\": \"This value should not be blank.\"\n    }\n  ]\n}. I agree this is so unclear from the docs.\nYou should move your annotations from 1 place (entity) to 2 files:\nThe first one is config/api_platform/resources/Org.yaml for API-platform as you mentioned above, the second one is a separate file for Serializer component, e.g. ./config/serializer/Org.yml and there you would add:\nyaml\nApp\\Entity\\Org:\n    attributes:\n       id:\n            groups: ['read']\n       name:\n            groups: ['read', 'write']\nYou should configure serializer to looks for these files:\nyaml\nframework:\n    serializer:\n        mapping:\n            paths: ['path/to/config/serializer/Org.yml']. They can, indeed. The problem is for the end user (developer) that it's not clear how to move Annotations to Yaml for api-platform without this knowledge.\nWe tried to find example in the api-platform's docs, we tried to check api-platform's tests, we tried to debug and eventually found an answer in github issues.\nAll of these can be avoided with a properly documented case for Yaml usage.\nIt will significantly improve DX.. Could you please explain it here at least (if it won't go to the official code/documentation)? . {\n  \"id\": 0,\n  \"libelle\": \"string\",\n  \"owner\": \"string\"\n}\nas I understand this is an example from Swagger API. What is the real output? What is the request, GET?. could you please point to any resource to get details? . ",
    "rapax87": "I have the same issue, is there any formal solution of this problem?\n\n\nAnswer my own question, actually I fixed it by using this in InputDataTransformer\n$resourceObject = $context[AbstractItemNormalizer::OBJECT_TO_POPULATE] ?? new $context['resource_class']();. Thanks @teohhanhui , I solved the problem with \"api-platform/core\": \"2.4.x-dev\"\nusing below line in InputDataTransformer to create an object, it works for both POST and PUT:\n$resourceObject = $context[AbstractItemNormalizer::OBJECT_TO_POPULATE] ?? new $context['resource_class']();. It is solved, this version works for me, \n\"api-platform/core\": \"2.4.x-dev\". \n\n",
    "ikerib": "\nIn my case how I did :\n\nCreate a User entity implementing UserInterface and \\Serializable expoed trough @ApiResource with groups write/read for password field.\nInstall https://packagist.org/packages/lexik/jwt-authentication-bundle ( JWT )\nInstall https://packagist.org/packages/gesdinet/jwt-refresh-token-bundle ( Refresh )\nEdit security.yaml to add provider and firewall for \"login\", \"/login_check\", \"/token/refresh\" and \"/api_doc\", same for access_control part\nEdit routes.yaml to add swagger_ui, api_login_check and gesdinet_jwt_refresh_token\nEdit api_platform.yaml for swagger\n\nIf that can help.\n\nDo you have your code in any repo where we can see?. ",
    "maaxxicarvalho": "@soyuka Thanks for your comments.\nI agree that it should be handled automatically since it has a proper type set, but that's not happening.\nIf you check the class api-platform/core/src/Bridge/Doctrine/Orm/ItemDataProvider.php you will se that there you can find the instruction to set the parameter type explicitly like so:\n```php\n/\n * Add WHERE conditions to the query for one or more identifiers (simple or composite).\n \n * @param array         $identifiers\n * @param QueryBuilder  $queryBuilder\n * @param ClassMetadata $classMetadata\n /\nprivate function addWhereForIdentifiers(array $identifiers, QueryBuilder $queryBuilder, ClassMetadata $classMetadata)\n{\n    $alias = $queryBuilder->getRootAliases()[0];\n    foreach ($identifiers as $identifier => $value) {\n        $placeholder = ':id_'.$identifier;\n        $expression = $queryBuilder->expr()->eq(\n            \"{$alias}.{$identifier}\",\n            $placeholder\n        );\n    $queryBuilder->andWhere($expression);\n\n    $queryBuilder->setParameter($placeholder, $value, $classMetadata->getTypeOfField($identifier));\n}\n\n}\n```\nAlthough this is not true for the subresource class.\nI have the column type set properly on the entities and it's working just fine for creation and retrieval of one record only, like /api/accounts/{id}.\nThe problem happens when I try to append subresources /api/accounts/{id}/properties or /api/accounts/{id}/properties/{properties}/rooms\nHere's the column definition for one of my entities, the others will follow the same logic:\nphp\n/**\n * @var \\Ramsey\\Uuid\\UuidInterface\n *\n * @ORM\\Id\n * @ORM\\Column(name=\"id\", type=\"uuid_binary_ordered_time\", unique=true)\n * @ORM\\GeneratedValue(strategy=\"CUSTOM\")\n * @CustomIdGenerator(class=\"Ramsey\\Uuid\\Doctrine\\UuidOrderedTimeGenerator\")\n *\n * @Groups({\"read\", \"write\"})\n *\n */\nprivate $id;\nAs you can see, the type is correctly set.\nI'm using the ramsey/uuid-doctrine package to deal with the UUIDs, I'm also using the InnoDB-optimised binary UUIDs option, you can find more information here\nI don't know if the explanations on the link above will clarify something for you but, what I know is that when I explicitly declare the parameter type everything works as expected, I don't see how using the identifier normaliser you proposed would help here, maybe you can help me with that.\nThanks again!. Hi @soyuka \nThat's exactly the fix I applied on my end. I'm sorry if I didn't submit an MR, I didn't understand the Unit Test stack properly.. ",
    "epourail": "Hello,\nFor information, is there any work or PR on this issue ?. Did you get any response ?. ",
    "soullivaneuh": "As asked in https://github.com/api-platform/core/issues/2118#issuecomment-409874809:\n\nWill this method have any influence on the swagger/doc generation?. Sorry wrong repository I guess: https://github.com/api-platform/core/issues/2251. \n",
    "kevinimbrechts": "I don't know \u00af_(\u30c4)_/\u00af\nI don't understand :(. Seriously ? \ud83d\ude31\nIf that's it, I'm really too tired... I'll check Monday at work.\nThanks. Hello,\nMy DATABASE_URL was properly set and bin/console doctrine:database:create works. :(. I don't have any exception with bin/console cache:clear. The exception is displayed in Firefox.\nI changed nothing. With Docker for Windows, it was working but not in my Ubuntu VM with Docker. It's very strange and I don't see any difference.. Yes, but I use the same containers from my private registry and the code is on a GitLab.. Ok, I have restarted the Docker service and now, it works.... ",
    "ghettovoice": "Another one approach I can think would be to deattach DictionaryRecord from ApiPlatform and serialize all records in the GET item operation of the Dictionary resource. And for add/remove add two custom operations to the Dictionary.. > easiest solution would be to rename dictionaryId to id\nI plan to add also item routes like GET/PUT /api/dictionaries/{dictionaryId}/records/{id}.{_format}.\n\nYou should also be able to decorate the IriConverter.\n\nOk, thank you. Seems like it would be fastest solution. Ok, thank you @soyuka . ",
    "KDederichs": "Stayed the same, it's still giving me \n```\ncache-proxy_1  | Error: Cannot read -f file '/usr/local/etc/varnish/default.vcl' (Permission denied)\ncache-proxy_1  | (-? gives usage)\ncache-proxy_1  | Error: Cannot read -f file '/usr/local/etc/varnish/default.vcl' (Permission denied)\ncache-proxy_1  | (-? gives usage)\ncache-proxy_1  | Error: Cannot read -f file '/usr/local/etc/varnish/default.vcl' (Permission denied)\ncache-proxy_1  | (-? gives usage)\napi_backend_docker_cache-proxy_1 exited with code 2\n. I added\nRUN mkdir -p /usr/local/etc/varnish\n``` \nbefore the copy directive and now it's working, not sure if that's what did it though or if something different happened cause it's been up for a while..... ",
    "afuetterer": "Hi, I get the same error when running api-platform 2.3.0 on Ubuntu 18.04.\n```bash\n$ docker-compose ps\n             Name                           Command               State            Ports         \n\napi-platform-230_admin_1         /bin/sh -c yarn start            Up       0.0.0.0:81->3000/tcp\napi-platform-230_api_1           nginx -g daemon off;             Up       0.0.0.0:8080->80/tcp\napi-platform-230_cache-proxy_1   docker-varnish-entrypoint  ...   Exit 2                       \napi-platform-230_client_1        /bin/sh -c yarn start            Up       0.0.0.0:80->3000/tcp\napi-platform-230_db_1            docker-entrypoint.sh postgres    Up       0.0.0.0:5432->5432/tcp\napi-platform-230_h2-proxy_1      nginx -g daemon off;             Exit 1                       \napi-platform-230_php_1           docker-entrypoint php-fpm        Up       9000/tcp   \n$ docker-compose logs -f cache-proxy\nAttaching to api-platform-230_cache-proxy_1\ncache-proxy_1  | Error: Cannot read -f file '/usr/local/etc/varnish/default.vcl' (Permission denied)\ncache-proxy_1  | (-? gives usage)\napi-platform-230_cache-proxy_1 exited with code 2\n$ docker-compose logs -f h2-proxy\nAttaching to api-platform-230_h2-proxy_1\nh2-proxy_1     | 2018/08/11 16:23:12 [emerg] 1#1: host not found in upstream \"cache-proxy\" in /etc/nginx/conf.d/default.conf:54\nh2-proxy_1     | nginx: [emerg] host not found in upstream \"cache-proxy\" in /etc/nginx/conf.d/default.conf:54\napi-platform-230_h2-proxy_1 exited with code 1\n```\n@KDederichs How did you fix it exactly?. Hi, I think it was related to file permissions in the zipped archive. After cloning the repository it works.. ",
    "Robilol": "thanks @afuetterer \nproblem still persist with the zip file. ",
    "javaDeveloperKid": "Same here. Had to clone repo instead of downloading zip file.. ",
    "MelvinLoos": "Err \"warn\"? Isn't it pretty much the recommended approach when following the Getting Started or did I misunderstood the docs? Anyway cloning has my preference too but the docs kind of send me the other direction.. Oh I didn't know that tar does preserve file permissions! . It is indeed very likely that the issue is with the serializer. I would suggest commenting out the properties of your Order entity one by one to find out which is giving the issue. My guess would be one of the relations you have defined to App\\Entity\\User or App\\Entity\\TopUpPackage. It is hard to tell without seeing their code. \nCircular references or related issues are very easy to make mistakes when using serialization libraries. \nYour AppObjectNormalizer class is a common solution to prevent them but I do see you are making one assumption here. You assume that $object, which can be any Entity you feed the serializer (directly or by relation), to have a getId method. And you do not enforce it by defining a interface in the anonymous function so that would prevent you from getting a clear error message.\nLet us know what you find and if necessary we can dig deeper.. ",
    "nicoesiea": "Did you solve this issue? Or maybe could you please provide us an explanation... Thank you.\nRegards,\nNicolas. By fixing the backend projet default GET endpoint. ",
    "clockworked247": "+1 I am also facing this issue.  Could you provide some insight on what you did to fix the error?. ",
    "hschaeidt": "Thanks, I've opened an issue. So we don't forget about this.. ",
    "xavirp": "Just solved. addReview has to be called in setReviews, taking on account that Reviews is an array of review. The add and set method for review in the book.php entity is as follow:\n```\npublic function addReview(Review $review)\n{\n    $review->setBook($this);\n    $this->reviews->add($review);\n    return $this;\n}\n\n/**\n * Set available reviews for this book.\n *\n * @param  Review[]  $reviews  Available reviews for this book.\n *\n * @return  self\n */ \npublic function setReviews($reviews)\n{\n    foreach($reviews as $r) {\n        $this->addReview($r);\n    }\n\n    return $this;\n}\n\n. I post the entire entiies\nBook.php\n<?php\nnamespace App\\Entity;\nuse Doctrine\\Common\\Collections\\ArrayCollection;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse ApiPlatform\\Core\\Annotation\\ApiSubresource;\nuse Symfony\\Component\\Serializer\\Annotation\\Groups;\n/\n * A book.\n * @ApiResource(\n  *      attributes={\n *          \"force_eager\"=false\n *     },\n *     collectionOperations={\n *         \"get\",\n *         \"post\"={\"method\"=\"POST\"},\n *     },\n *      itemOperations={\n *          \"get\",\n *          \"put\",\n *          \"delete\"\n *     },\n *   normalizationContext={\"groups\"={\"book\"}},\n *   denormalizationContext={\"groups\"={\"book\", \"post\"}})\n * @ORM\\Entity\n */\nclass Book\n{\n    /\n     * @var int The id of this book.\n     * @ORM\\Id\n     * @ORM\\GeneratedValue\n     * @ORM\\Column(type=\"integer\")\n     * @Groups({\"book\"})\n     */\n    private $id;\n/**\n * @var string|null The ISBN of this book (or null if doesn't have one).\n *\n * @ORM\\Column(nullable=true)\n * @Groups({\"book\", \"post\"})\n */\npublic $isbn;\n\n/**\n * @var string The title of this book.\n *\n * @ORM\\Column\n * @Groups({\"book\", \"post\"})\n */\npublic $title;\n\n/**\n * @var string The description of this book.\n *\n * @ORM\\Column(type=\"text\")\n * @Groups({\"book\", \"post\"})\n */\npublic $description;\n\n/**\n * @var string The author of this book.\n *\n * @ORM\\Column\n * @Groups({\"book\", \"post\"})\n */\npublic $author;\n\n/**\n * @var \\DateTimeInterface The publication date of this book.\n *\n * @ORM\\Column(type=\"datetime\")\n * @Groups({\"book\", \"post\"})\n */\npublic $publicationDate;\n\n/**\n * @var Review[] Available reviews for this book.\n * @Groups({\"book\", \"post\"})\n * @ORM\\OneToMany(targetEntity=\"Review\", mappedBy=\"book\", cascade={\"all\"})\n * @ORM\\JoinColumn(name=\"review\", referencedColumnName=\"id\")\n */\npublic $reviews;\n\npublic function __construct() {\n    $this->reviews = new ArrayCollection();\n}\n\npublic function getId(): ?int\n{\n    return $this->id;\n}\n\npublic function addReview(Review $review)\n{\n    $review->setBook($this);\n    $this->reviews->add($review);\n    return $this;\n}\n\n/**\n * Set available reviews for this book.\n *\n * @param  Review[]  $reviews  Available reviews for this book.\n *\n * @return  self\n */ \npublic function setReviews($reviews)\n{\n    foreach($reviews as $r) {\n        $this->addReview($r);\n    }\n\n    return $this;\n}\n\n\n\n/**\n * Get the ISBN of this book (or null if doesn't have one).\n *\n * @return  string|null\n */ \npublic function getIsbn()\n{\n    return $this->isbn;\n}\n\n/**\n * Set the ISBN of this book (or null if doesn't have one).\n *\n * @param  string|null  $isbn  The ISBN of this book (or null if doesn't have one).\n *\n * @return  self\n */ \npublic function setIsbn($isbn)\n{\n    $this->isbn = $isbn;\n\n    return $this;\n}\n\n/**\n * Get the title of this book.\n *\n * @return  string\n */ \npublic function getTitle()\n{\n    return $this->title;\n}\n\n/**\n * Set the title of this book.\n *\n * @param  string  $title  The title of this book.\n *\n * @return  self\n */ \npublic function setTitle(string $title)\n{\n    $this->title = $title;\n\n    return $this;\n}\n\n/**\n * Get the description of this book.\n *\n * @return  string\n */ \npublic function getDescription()\n{\n    return $this->description;\n}\n\n/**\n * Set the description of this book.\n *\n * @param  string  $description  The description of this book.\n *\n * @return  self\n */ \npublic function setDescription(string $description)\n{\n    $this->description = $description;\n\n    return $this;\n}\n\n/**\n * Get the author of this book.\n *\n * @return  string\n */ \npublic function getAuthor()\n{\n    return $this->author;\n}\n\n/**\n * Set the author of this book.\n *\n * @param  string  $author  The author of this book.\n *\n * @return  self\n */ \npublic function setAuthor(string $author)\n{\n    $this->author = $author;\n\n    return $this;\n}\n\n/**\n * Get the publication date of this book.\n *\n * @return  \\DateTimeInterface\n */ \npublic function getPublicationDate()\n{\n    return $this->publicationDate;\n}\n\n/**\n * Set the publication date of this book.\n *\n * @param  \\DateTimeInterface  $publicationDate  The publication date of this book.\n *\n * @return  self\n */ \npublic function setPublicationDate(\\DateTimeInterface $publicationDate)\n{\n    $this->publicationDate = $publicationDate;\n\n    return $this;\n}\n\n/**\n * Get available reviews for this book.\n *\n * @return  Review[]\n */ \npublic function getReviews()\n{\n    return $this->reviews;\n}\n\n}\nReview.php\n<?php\nnamespace App\\Entity;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse ApiPlatform\\Core\\Annotation\\ApiSubresource;\nuse Symfony\\Component\\Serializer\\Annotation\\Groups;\n/\n * A review of a book.\n * @ApiResource(\n  *      attributes={\n *          \"force_eager\"=false\n *     },\n * )\n * @ORM\\Entity\n */\nclass Review\n{\n    /\n     * @var int The id of this review.\n     * @ORM\\Id\n     * @ORM\\Column(type=\"integer\")\n     * @Groups({\"book\"})\n     */\n    private $id;\n/**\n * @var int The rating of this review (between 0 and 5).\n *\n * @ORM\\Column(type=\"smallint\")\n * @Groups({\"book\", \"post\"})\n */\npublic $rating;\n\n/**\n * @var string the body of the review.\n *\n * @ORM\\Column(type=\"text\")\n * @Groups({\"book\", \"post\"})\n */\npublic $body;\n\n/**\n * @var string The author of the review.\n *\n * @ORM\\Column\n * @Groups({\"book\", \"post\"})\n */\npublic $author;\n\n/**\n * @var \\DateTimeInterface The date of publication of this review.\n *\n * @ORM\\Column(type=\"datetime_immutable\")\n * @Groups({\"book\", \"post\"})\n */\npublic $publicationDate;\n\n/**\n * @var Book The book this review is about.\n * @ORM\\Id\n * @Groups({\"post\"})\n * @ORM\\ManyToOne(targetEntity=\"Book\", inversedBy=\"reviews\")\n * @ORM\\JoinColumn(name=\"book\", referencedColumnName=\"id\")\n */\npublic $book;\n\n/**\n * @Groups({\"book\"})\n */\npublic $id_valor;\n\npublic function getId(): ?int\n{\n    return $this->id;\n}\n\n\n/**\n * Set the book this review is about.\n *\n * @param  Book  $book  The book this review is about.\n *\n * @return  self\n */ \npublic function setBook(Book $book)\n{\n    $this->book = $book;\n\n    return $this;\n}\n\n/**\n * Set the id of this review.\n *\n * @param  int  $id  The id of this review.\n *\n * @return  self\n */ \npublic function setId(int $id)\n{\n    $this->id = $id;\n\n    return $this;\n}\n\n/**\n * Get the rating of this review (between 0 and 5).\n *\n * @return  int\n */ \npublic function getRating()\n{\n    return $this->rating;\n}\n\n/**\n * Set the rating of this review (between 0 and 5).\n *\n * @param  int  $rating  The rating of this review (between 0 and 5).\n *\n * @return  self\n */ \npublic function setRating(int $rating)\n{\n    $this->rating = $rating;\n\n    return $this;\n}\n\n/**\n * Get the body of the review.\n *\n * @return  string\n */ \npublic function getBody()\n{\n    return $this->body;\n}\n\n/**\n * Set the body of the review.\n *\n * @param  string  $body  the body of the review.\n *\n * @return  self\n */ \npublic function setBody(string $body)\n{\n    $this->body = $body;\n\n    return $this;\n}\n\n/**\n * Get the author of the review.\n *\n * @return  string\n */ \npublic function getAuthor()\n{\n    return $this->author;\n}\n\n/**\n * Set the author of the review.\n *\n * @param  string  $author  The author of the review.\n *\n * @return  self\n */ \npublic function setAuthor(string $author)\n{\n    $this->author = $author;\n\n    return $this;\n}\n\n/**\n * Get the date of publication of this review.\n *\n * @return  \\DateTimeInterface\n */ \npublic function getPublicationDate()\n{\n    return $this->publicationDate;\n}\n\n/**\n * Set the date of publication of this review.\n *\n * @param  \\DateTimeInterface  $publicationDate  The date of publication of this review.\n *\n * @return  self\n */ \npublic function setPublicationDate(\\DateTimeInterface $publicationDate)\n{\n    $this->publicationDate = $publicationDate;\n\n    return $this;\n}\n\n/**\n * Get the value of id_valor\n */ \npublic function getId_valor()\n{\n    return $this->id_valor;\n}\n\n}\n```. We use Material Datatables with DataSources in Angular. ",
    "mikemilano": "Confirmed, that works, thanks!. Agreed, will do!. PR: https://github.com/api-platform/docs/pull/552. That looks like it will do, thanks!. Confirmed, and for anyone else wondering like me, .yaml (in addition to .yml) extension works for files in the serializer directory as well.\nThanks @borNfreee, I'll get a docs PR going this weekend.. https://github.com/api-platform/docs/pull/556. ",
    "errogaht": "So the problem is about \\DateTime field on a resource. How can I return ConstrainVoilation message to client on Bad input? This is impossible in the basic setup. If field marked as \\DateTime then a client can send the only parsable string with DateTime, he cant send '' or null or 'as3'. But how React app for eg. can show validation error on date time required field? no server-side validation. most of validation is server side but datetime field need JS validation. By the way, this hack if work fine for me: https://github.com/symfony/symfony/issues/27824#issuecomment-409806881 I can't understand Symfony serializer why it designed in this way - validate object but not request.... my opinion is this is harder. 404 is not found code. @borNfreee and you get ConstraintVoilationsList object? I don't think so, I believe that the client receives in your case just serialized exception, that cannot be parsed by client, ~13 kb size. I believe that all validations constraints must be responded to the client in one format that is contract with front-end developer, in this case he can write some validation handler on his side. but serialized exceptions with 13 kb response is not a good idea to give it to front-end developer. this is example with a fine response with validations errors, when I add simply validation rules to entity's fields:\njson\n{\n    \"type\": \"https:\\/\\/tools.ietf.org\\/html\\/rfc2616#section-10\",\n    \"title\": \"An error occurred\",\n    \"detail\": \"deliveryAt: This value should not be blank.\",\n    \"violations\": [\n        {\n            \"propertyPath\": \"deliveryAt\",\n            \"message\": \"This value should not be blank.\",\n            \"code\": \"c1051bb4-d103-4f74-8988-acbcafc7fdc3\"\n        }\n    ]\n}. @borNfreee but what if one entity have many errors? In this case front-end developer gets violations list and mark all invalid fields in form with red border and show a message beside all of them. In case of invalid datetime field there is no violations lists just one message and it is impossible to recognize which field is invalid. If user provide invalid data for 3 common fields he gets 3 errors for each field, but if he forgot to type in date time field (e other common fields is still with invalid data) the user gets just one exception about datetime field without another errors and without propertyPath. Hi guys! I got the same issue, do you have an idea how we can fix it?. @soyuka, if I'll set \"force_eager\"=false is there could be some side-effects? eg. filters will not work correctly or pagination or something else? . @soyuka , thanks, I'll disable force_eager system-wide in api-platform configuration. should be fine I believe.. ",
    "dawsza": "For me it doesn't works too.\n{\n    \"@context\": \"/api/contexts/Error\",\n    \"@type\": \"hydra:Error\",\n    \"hydra:title\": \"An error occurred\",\n    \"hydra:description\": \"The type of the \\\"orderNumber\\\" attribute must be \\\"int\\\", \\\"NULL\\\" given.\",\n    \"trace\": [\n        {\n            \"namespace\": \"\",\n            \"short_class\": \"\",\n            \"class\": \"\",\n            \"type\": \"\",\n            \"function\": \"\",\n            \"file\": \"/home/vagrant/code/some-domain/vendor/api-platform/core/src/Serializer/AbstractItemNormalizer.php\",\n            \"line\": 239,\n            \"args\": []\n        },\n        {\n            \"namespace\": \"ApiPlatform\\\\Core\\\\Serializer\",\n            \"short_class\": \"AbstractItemNormalizer\",\n            \"class\": \"ApiPlatform\\\\Core\\\\Serializer\\\\AbstractItemNormalizer\",\n            \"type\": \"->\",\n            \"function\": \"validateType\",\n            \"file\": \"/home/vagrant/code/some-domain/vendor/api-platform/core/src/Serializer/AbstractItemNormalizer.php\",\n            \"line\": 220,\n            \"args\": [\n                [\n                    \"string\",\n                    \"orderNumber\"\n                ],\n                [\n                    \"object\",\n                    \"Symfony\\\\Component\\\\PropertyInfo\\\\Type\"\n                ],\n                [\n                    \"null\",\n                    null\n                ],\n                [\n                    \"string\",\n                    \"json\"\n                ]\n            ]\n        },. ",
    "michaelpetri": "Was a result of my own patch, sorry for that! \nThis issue can be deleted.. ",
    "irmantas": "Thank you @soyuka this tip solved issue for me.. ",
    "guido4000": "I experience the same issue with Docker version 18.06.0-ce, build 0ffa825.. > #795 i might have find a solution\nUsing symfony/flex v1.0.89 did not help in my case.. > Where should i add composer update symfony/flex --no-scripts in which file of api platform\nIn the api folder in the Dockerfile before line 72 add\ncomposer update symfony/flex --no-scripts; \\. > @guido4000 should a composer update command be run from inside of the Dockerfile? From my experience, composer update shouldn't be added into a docker file because it's not a stable command.\nThis was just a workaround. I suppose the dependencies will be updated in the official build soon.. ",
    "mrkisch": "Same error.\nOn Windows 10\nDocker:\nVersion 18.06.0-ce-win72 (19098)\nChannel: stable\n5513f91\n. #795 i might have find a solution. ",
    "sseidenthal": "i had the same issue, i did:\ncomposer update symfony/flex --no-scripts. ",
    "krishnathokala": "Where should i add composer update symfony/flex --no-scripts in which file of api platform. ",
    "ragboyjr": "@sseidenthal thank you very much! Had the same issue, running from inside the api dir fixed the issue.\n@guido4000 should a composer update command be run from inside of the Dockerfile? From my experience, composer update shouldn't be added into a docker file because it's not a stable command.. gotcha, no worries.. ",
    "wuestkamp": "A fast fix for this is to call docker-compose exec php php-fpm -D to start php-fpm again. I did a complete rebuild of docker-compose and still getting this error.\nAnyone got an idea why this happens? It does only so on my local and not my Gcloud Kubernetes cluster.\nThe Dockerfile should run php-fpm.\nv2.3.1\n. So I have only managed it this way:\n```\nclass MySubscriber implements EventSubscriberInterface\n{\n    public static function getSubscribedEvents()\n    {\n        return [\n            KernelEvents::REQUEST => [['event', EventPriorities::POST_DESERIALIZE]],\n        ];\n    }\npublic function event(GetResponseEvent $event)\n{\n    $myEntity = $event->getRequest()->attributes->get('data');\n\n   //  $myEntity add data to my entity\n}\n\n}\n```. Thanks, that works for me!. ",
    "aaa2000": "There was the same problem in api-platform/demo https://github.com/api-platform/demo/issues/30\nThe error /tmp:5432 - no response comes from  https://github.com/api-platform/api-platform/blob/f020cd4ff4f609dcd01c2284b9cf61450df08560/api/docker/php/docker-entrypoint.sh#L17\nbut this has been changed in version 2.3.5 https://github.com/api-platform/api-platform/blob/b7d83aa49c9e6899569cd31b703c8b32d00a7372/api/docker/php/docker-entrypoint.sh#L25, you need maybe to do docker-compose up --build\n. I don't have the bug\nIf you add the property price in Book entity of api platform demo with:\n/**\n     * @ORM\\Column(type=\"decimal\", nullable=true, precision=5, scale=2)\n     * @Groups(\"book:read\")\n     * @ApiProperty(iri=\"http://schema.org/price\")\n     */\n    public $price;\nand create a book, you see the price 90.00\ncurl -X POST \"https://localhost:8443/books\" -H  \"accept: application/ld+json\" -H  \"Content-Type: application/ld+json\" -d \"{  \\\"isbn\\\": \\\"978-2-02-130452-7\\\",  \\\"title\\\": \\\"Decimal data type is inconsistent\\\",  \\\"description\\\": \\\"a description\\\",  \\\"author\\\": \\\"foobar\\\",  \\\"publicationDate\\\": \\\"2018-12-11T19:56:37.870Z\\\",  \\\"price\\\": \\\"90.00\\\"}\"\n{\n  \"@context\": \"/contexts/Book\",\n  \"@id\": \"/books/5\",\n  \"@type\": \"http://schema.org/Book\",\n  \"isbn\": \"978-2-02-130452-7\",\n  \"title\": \"Decimal data type is inconsistent\",\n  \"description\": \"a description\",\n  \"author\": \"foobar\",\n  \"publicationDate\": \"2018-12-11T00:00:00+00:00\",\n  \"reviews\": [],\n  \"price\": \"90.00\"\n}\nand when you retrieve the book, you see 90.00\n@trsteel88 Can you show your annotation ? Did you add scale ? Without scale, it returns the string \"90\"\n{\n  \"@context\": \"/contexts/Book\",\n  \"@id\": \"/books/6\",\n  \"@type\": \"http://schema.org/Book\",\n  \"isbn\": \"978-2-02-130452-7\",\n  \"title\": \"Decimal data type is inconsistent\",\n  \"description\": \"a description\",\n  \"author\": \"foobar\",\n  \"publicationDate\": \"2018-12-11T00:00:00+00:00\",\n  \"reviews\": [],\n  \"price\": \"90\"\n}\n. In my case, it is not a float. It is the defaut behaviour of json_encode.\n```\n\n\n\njson_encode([\"price\" => 90.0]);\n=> \"{\"price\":90}\"\njson_encode([\"price\" => 90.0], JSON_PRESERVE_ZERO_FRACTION);\n=> \"{\"price\":90.0}\"\n```\n\n\n\n. Maybe, you need to do docker-php-ext-enable apcu in your dockerfile.\nYou can see the api platform demo dockerfile https://github.com/api-platform/demo/blob/47f4da92a2a978c69f5833895f4ce7289c802f78/api/Dockerfile#L39. ",
    "baddlan": "There is a good chance DATABASE_URL is not set. Try checking your env vars inside the php container.. Yes, you need $DATABASE_URL and $VARNISH_URL in the environment when the container starts.\nThis can happen when you apply Symfony's new .env conventions to Api Platform. You've probably removed those required env vars from the .env file or omitted env_file: ['./api/.env'] from docker-compose.yml.\n. I am actually on v2.3.4 which had that param before it got omitted in v2.3.5.\nhttps://github.com/api-platform/api-platform/blob/a6f5af491918f472799d52bad621d5a10af54d8b/docker-compose.yml#L15-L16\n. ",
    "natelenart": "I just downloaded a stock version of v2.3.6 (Linux, if it matters) and hit this exact issue. I'm new to API platform and I assumed this would be a quick install and then unfortunately spent an hour tracking this down. The good news is that adding the env_file directive to docker-compose.yml fixed it, as per @baddlan's suggestion.. ",
    "edwh": "Hi, also a newbie to API Platform and hit this.  Starting PHP-FPM works, but the env_file doesn't seem to help me.  In case it's relevant, I've made various changes to use MySQL.\nIn simple terms, how do I switch to using master?. Did it solve it permanently, though?  Or did that just happen to restart PHP-FPM once for you?. ",
    "piepkrak": "Updating the images solved this issue for me.\nbash\n$ docker-compose pull\n$ docker-compose up -d. @edwh It solved it permanently. Running docker-compose stop followed by docker-compose up -d will have the API running. It is giving me a gateway timeout the first few seconds after startup. Possibly waiting for another service to become available.. ",
    "mok123": "Hi there,\ni install the api due to the documentation.\nI can reach the startpage loalhost.\nBut by clicking any button on thestartpage i get 502 Bad Gateway error!\nHere is my log:\n\ndocker-compose logs -f php\nAttaching to api_php_1\nphp_1          | Loading composer repositories with package information\nphp_1          | Installing dependencies (including require-dev) from lock file\nphp_1          | \nphp_1          | Prefetching 14 packages \ud83c\udfb6 \ud83d\udca8\nphp_1          |   - Downloading (100%)\nphp_1          | \nphp_1          | Package operations: 14 installs, 0 updates, 0 removals\nphp_1          |   - Installing league/html-to-markdown (4.8.1): Loading from cache\nphp_1          |   - Installing symfony/stopwatch (v4.2.3): Loading from cache\nphp_1          |   - Installing symfony/process (v4.2.3): Loading from cache\nphp_1          |   - Installing symfony/polyfill-php72 (v1.10.0): Loading from cache\nphp_1          |   - Installing symfony/options-resolver (v4.2.3): Loading from cache\nphp_1          |   - Installing php-cs-fixer/diff (v1.3.0): Loading from cache\nphp_1          |   - Installing composer/xdebug-handler (1.3.2): Loading from cache\nphp_1          |   - Installing composer/semver (1.4.2): Loading from cache\nphp_1          |   - Installing friendsofphp/php-cs-fixer (v2.14.2): Loading from cache\nphp_1          |   - Installing easyrdf/easyrdf (0.9.1): Loading from cache\nphp_1          |   - Installing api-platform/schema-generator (v2.1.0): Loading from cache\nphp_1          |   - Installing symfony/var-dumper (v4.2.3): Loading from cache\nphp_1          |   - Installing symfony/web-profiler-bundle (v4.2.3): Loading from cache\nphp_1          |   - Installing symfony/profiler-pack (v1.0.4): Loading from cache\nphp_1          | Generating autoload files\nphp_1          | Executing script cache:clear [OK]\nphp_1          | Executing script assets:install public [OK]\nphp_1          | \nphp_1          | Waiting for db to be ready...\n\nCan anyone help?\nThx. ",
    "ilicmsreten": "@guilhemVB I open PR in api-platform/core. @soyuka I open PR. ",
    "TwiSka": "I try with serialization groups But he don't work to. ",
    "myAwesome": "Hi, @TwiSka !\nYou can look at graphql, and make queries with it.\n I don't really sure, that you can do it with classic rest api.. ",
    "maximilienGilet": "@alanpoulain I just updated my composer.json to use the dev-master version of the core bundle. It's working perfectly !\nThank you for the quick response. \nI think it should be written somewhere while the fix isn't part of a release.. ",
    "foxsdev": "OMG... in fact I can't believe that I didn't tried it...\nIt is working, but I don't know why swagger don't get it. Isn't it suppose to be correctly displayed ?\nHow can I fix swagger documentation ?. ",
    "nielsvandermolen": "Sorry wrong repository, please see https://github.com/api-platform/core/issues/2158. ",
    "lukaszgoworko": "now working with the new Version (v2.3.3).\nThis issue can be closed. ",
    "henres": "Hello,\nI have the same question.\nThanks in advance for you answer.. ",
    "GermanKrutov": "+1. ",
    "smatyas": "Hi, maybe a custom swagger decorator can help you here. \nCheck the example: https://api-platform.com/docs/core/swagger/#overriding-the-openapi-specification\nAdding something like this to all routes might work:\n$customDefinition = [\n            'name' => 'custom-header',\n            'description' => 'custom header',\n            'default' => 'default-value',\n            'in' => 'header',\n        ];. ",
    "e1sep0": "I cleared cache. But i still get much of SQL requests to DB for collecting all fields for every relation. no, eager is enabled in api_platform config\n```\neager_loading:\n        # To enable or disable eager loading.\n        enabled: true\n    # Fetch only partial data according to serialization groups.\n    # If enabled, Doctrine ORM entities will not work as expected if any of the other fields are used.\n    fetch_partial: true\n\n    # Max number of joined relations before EagerLoading throws a RuntimeException.\n    max_joins: 30\n\n    # Force join on every relation.\n    # If disabled, it will only join relations having the EAGER fetch mode.\n    force_eager: true\n\n. For One Item i get many sql requests too.\n2018-08-21T13:30:18+03:00 [info] Matched route \"api_hotels_get_item\".\n2018-08-21T13:30:18+03:00 [info] Populated the TokenStorage with an anonymous Token.\n2018-08-21T13:30:18+03:00 [info] User Deprecated: Doctrine\\Common\\ClassLoader is deprecated.\n2018-08-21T13:30:19+03:00 [debug] SELECT h0_.id AS id_0, h0_.name AS name_1, c1_.id AS id_2, c1_.nameRu AS nameru_3, c1_.nameEn AS nameen_4, h2_.id AS id_5, h2_.name AS name_6, h0_.city_id AS city_id_7, h0_.category_id AS category_id_8, h0_.chain_id AS chain_id_9, h0_.type_id AS type_id_10, h0_.replacedby_id AS replacedby_id_11, c1_.resort_id AS resort_id_12, c1_.state_region_id AS state_region_id_13, c1_.country_id AS country_id_14, c1_.regionCity_id AS regioncity_id_15 FROM dictionary.hotel h0_ LEFT JOIN dictionary.city c1_ ON h0_.city_id = c1_.id LEFT JOIN dictionary.hotel_category h2_ ON h0_.category_id = h2_.id WHERE h0_.id = ?\n2018-08-21T13:30:19+03:00 [debug] SELECT t0.hotel_id AS hotel_id_1, t0.builtin AS builtin_2, t0.type AS type_3, t0.buildingtype AS buildingtype_4, t0.numberlifts AS numberlifts_5, t0.numberfloors AS numberfloors_6, t0.numberofrooms AS numberofrooms_7, t0.conference AS conference_8, t0.voltage AS voltage_9, t0.childagefrom AS childagefrom_10, t0.childageto AS childageto_11, t0.earlestcheckintime AS earlestcheckintime_12, t0.latestcheckouttime AS latestcheckouttime_13, t0.roomservicefrom AS roomservicefrom_14, t0.roomserviceto AS roomserviceto_15, t0.indoorpool AS indoorpool_16, t0.outdoorpool AS outdoorpool_17, t0.childrenpool AS childrenpool_18, t0.roomservice24h AS roomservice24h_19, t0.porteragefrom AS porteragefrom_20, t0.porterageto AS porterageto_21, t0.porterage24h AS porterage24h_22, t0.address AS address_23, t0.phone AS phone_24, t0.fax AS fax_25, t0.email AS email_26, t0.emailbookingdepartment AS emailbookingdepartment_27, t0.www AS www_28, t0.latitude AS latitude_29, t0.longitude AS longitude_30, t0.center AS center_31, t0.distances AS distances_32, t0.description AS description_33, t0.additionalinfo AS additionalinfo_34, t0.mapurl AS mapurl_35, t0.maptype AS maptype_36, t0.accepted AS accepted_37, t0.geoaccepted AS geoaccepted_38, t0.undergroundaccepted AS undergroundaccepted_39, t0.mapaccepted AS mapaccepted_40, t0.itemsaccepted AS itemsaccepted_41, t0.extrabedsinfo AS extrabedsinfo_42, t0.childreninfo AS childreninfo_43, t0.hotel_id AS hotel_id_44, t0.classification_id AS classification_id_45, t46.id AS id_47, t46.name AS name_48, t46.trash AS trash_49 FROM dictionary.hotel_details t0 LEFT JOIN dictionary.hotel_rating t46 ON t0.classification_id = t46.id WHERE t0.hotel_id = ?\n2018-08-21T13:30:19+03:00 [debug] SELECT t0.id AS id_1, t0.geoid AS geoid_2, t0.hotelname AS hotelname_3, t0.hotelurl AS hotelurl_4, t0.ratingurl AS ratingurl_5, t0.reviewcount AS reviewcount_6, t0.averagerating AS averagerating_7, t0.hotel_id AS hotel_id_8 FROM dictionary.hotel_ta_rating t0 WHERE t0.hotel_id = ?\n2018-08-21T13:30:19+03:00 [debug] SELECT t0.hotel_id AS hotel_id_1 FROM dictionary.hotel_additional_details t0 WHERE t0.hotel_id = ?\n2018-08-21T13:30:19+03:00 [info] User Deprecated: Doctrine\\Common\\Util\\Inflector is deprecated.\n[Tue Aug 21 13:30:19 2018] 127.0.0.1:46780 [200]: /api/en/hotels/6\n```\nI need only first request. How can i disallow other? Without using custom DataProvider?. ",
    "ibonkonesa": "I solved this error changing the file: php/Dockerfile line 30:\nfrom docker-php-ext-install -j$(nproc) \\\nto  docker-php-ext-install -j \"$(getconf _NPROCESSORS_ONLN)\" \\\nAnyway, another error is launched in step 16/23\n```\nStep 16/23 : RUN set -eux;  composer install --prefer-dist --no-dev --no-autoloader --no-scripts --no-progress --no-suggest;    composer clear-cache\n ---> Running in e63df3e8676f\n+ composer install --prefer-dist --no-dev --no-autoloader --no-scripts --no-progress --no-suggest\nLoading composer repositories with package information\nInstalling dependencies from lock file\n    1/58:   https://codeload.github.com/symfony/lts/legacy.zip/6de50b244bad631a71544b3cc3c8e206c0e5f991\n    2/58:   https://codeload.github.com/api-platform/api-pack/legacy.zip/33ade8a1dc23868828788fe1bf3e54291ce54843\n    3/58:   https://codeload.github.com/guzzle/promises/legacy.zip/a59da6cf61d80060647ff4d3eb2c03a2bc694646\n    4/58:   https://codeload.github.com/php-fig/http-message/legacy.zip/f6561bf28d520154e4b0ec72be95418abe6d9363\n    5/58:   https://codeload.github.com/symfony/yaml/legacy.zip/80e4bfa9685fc4a09acc4a857ec16974a9cd944e\n    6/58:   https://codeload.github.com/symfony/property-info/legacy.zip/724cca5ae45760156029f14d2e293a281fab89e0\n    7/58:   https://codeload.github.com/symfony/flex/legacy.zip/729aee08d62b47224e85b83c97e2824ff7d1735e\n    8/58:   https://codeload.github.com/guzzle/psr7/legacy.zip/f5b8a8512e2b58b0071a7280e39f14f72e05d87c\n    9/58:   https://codeload.github.com/guzzle/guzzle/legacy.zip/407b0cb880ace85c9b63c5f9551db498cb2d50ba\n    10/58:  https://codeload.github.com/willdurand/Negotiation/legacy.zip/03436ededa67c6e83b9b12defac15384cb399dc9\n    11/58:  https://codeload.github.com/jdorn/sql-formatter/legacy.zip/64990d96e0959dff8e059dfcdc1af130728d92bc\n    12/58:  https://codeload.github.com/doctrine/DoctrineCacheBundle/legacy.zip/4c8e363f96427924e7e519c5b5119b4f54512697\n    13/58:  https://codeload.github.com/doctrine/DoctrineBundle/legacy.zip/703fad32e4c8cbe609caf45a71a1d4266c830f0f\n    14/58:  https://codeload.github.com/symfony/doctrine-bridge/legacy.zip/a7751cc8d949c16366976633678116f85662b989\n    15/58:  https://codeload.github.com/doctrine/common/legacy.zip/f68c297ce6455e8fd794aa8ffaf9fa458f6ade66\n    16/58:  https://codeload.github.com/doctrine/cache/legacy.zip/b3217d58609e9c8e661cd41357a54d926c4a2a1a\n    17/58:  https://codeload.github.com/doctrine/collections/legacy.zip/a01ee38fcd999f34d9bfbcee59dbda5105449cbf\n    18/58:  https://codeload.github.com/symfony/serializer/legacy.zip/2ddc6ec084eba809aec92bf723e007bc3a8345c0\n    19/58:  https://codeload.github.com/doctrine/inflector/legacy.zip/5527a48b7313d15261292c149e55e26eae771b0a\n    20/58:  https://codeload.github.com/doctrine/lexer/legacy.zip/83893c552fd2045dd78aef794c31e694c37c0b8c\n    21/58:  https://codeload.github.com/doctrine/annotations/legacy.zip/c7f2050c68a9ab0bdb0f98567ec08d80ea7d24d5\n    22/58:  https://codeload.github.com/doctrine/instantiator/legacy.zip/185b8868aa9bf7159f5f953ed5afb2d7fcdc3bda\n    23/58:  https://codeload.github.com/nelmio/NelmioCorsBundle/legacy.zip/548dc8ebd3984acd2f6d8787ab1dac2e9aa14254\n    24/58:  https://codeload.github.com/symfony/finder/legacy.zip/84714b8417d19e4ba02ea78a41a975b3efaafddb\n    25/58:  https://codeload.github.com/phpDocumentor/TypeResolver/legacy.zip/9c977708995954784726e25d0cd1dddf4e65b0f7\n    26/58:  https://codeload.github.com/phpDocumentor/ReflectionCommon/legacy.zip/21bdeb5f65d7ebf9f43b1b25d404f87deab5bfb6\n    27/58:  https://codeload.github.com/webmozart/assert/legacy.zip/0df1908962e7a3071564e857d86874dad1ef204a\n    28/58:  https://codeload.github.com/doctrine/dbal/legacy.zip/11037b4352c008373561dc6fc836834eed80c3b5\n    29/58:  https://codeload.github.com/symfony/routing/legacy.zip/b38b9797327b26ea2e4146a40e6e2dc9820a6932\n    30/58:  https://codeload.github.com/symfony/asset/legacy.zip/73358508628c10832e87c3ff18db527d48387afc\n    31/58:  https://codeload.github.com/symfony/expression-language/legacy.zip/81653bbb8e0feff271bebfdea492386f1c75c098\n    32/58:  https://codeload.github.com/php-fig/cache/legacy.zip/d11b50ad223250cf17b86e38383413f5a6764bf8\n    33/58:  https://codeload.github.com/phpDocumentor/ReflectionDocBlock/legacy.zip/94fd0001232e47129dd3504189fa1c7225010d08\n    34/58:  https://codeload.github.com/symfony/console/legacy.zip/70591cda56b4b47c55776ac78e157c4bb6c8b43f\n    35/58:  https://codeload.github.com/php-fig/simple-cache/legacy.zip/408d5eafb83c57f6365a3ca330ff23aa4a5fa39b\n    36/58:  https://codeload.github.com/php-fig/container/legacy.zip/b7ce3b176482dbbc1245ebf52b181af44c2cf55f\n    37/58:  https://codeload.github.com/symfony/cache/legacy.zip/be95ef3665747e6ff9d883a8adc87085769009f0\n    38/58:  https://codeload.github.com/symfony/inflector/legacy.zip/a55513ebd8aa4843300e325c84d0954a9d1f4ed8\n    39/58:  https://codeload.github.com/symfony/property-access/legacy.zip/f957d37eb476c9442a0c684b0cd0dd1fb38cb74a\n    40/58:  https://codeload.github.com/doctrine/doctrine2/legacy.zip/87ee409783a4a322b5597ebaae558661404055a7\n    41/58:  https://codeload.github.com/symfony/security-bundle/legacy.zip/58c0db1915ab9c54c013d9336cace46f9e02cbb2\n    42/58:  https://codeload.github.com/symfony/filesystem/legacy.zip/562bf7005b55fd80d26b582d28e3e10f2dd5ae9c\n    43/58:  https://codeload.github.com/symfony/twig-bundle/legacy.zip/04f9b5055ca8ea1cb2abc247149b0b4ae4bac6da\n    44/58:  https://codeload.github.com/symfony/debug/legacy.zip/dbe0fad88046a755dcf9379f2964c61a02f5ae3d\n    45/58:  https://codeload.github.com/symfony/framework-bundle/legacy.zip/a34630e9712b23fb0a20cc12fe937a9ddcaacbe8\n    46/58:  https://codeload.github.com/php-fig/log/legacy.zip/4ebe3a8bf773a19edfe0a84b6585ba3d401b724d\n    47/58:  https://codeload.github.com/symfony/config/legacy.zip/e57e7b573df9d0eaa8c0152768c708ee7ea2b8e5\n    48/58:  https://codeload.github.com/symfony/dependency-injection/legacy.zip/e761828a85d7dfc00b927f94ccbe1851ce0b6535\n    49/58:  https://codeload.github.com/symfony/event-dispatcher/legacy.zip/2391ed210a239868e7256eb6921b1bd83f3087b5\n    50/58:  https://codeload.github.com/symfony/twig-bridge/legacy.zip/4794c3cac1cd3c0104ec194ecd3ea82019d94c64\n    51/58:  https://codeload.github.com/symfony/http-foundation/legacy.zip/4f9c7cf962e635b0b26b14500ac046e07dbef7f3\n    52/58:  https://codeload.github.com/symfony/http-kernel/legacy.zip/29c094a1c4f8209b7e033f612cbbd69029e38955\n    53/58:  https://codeload.github.com/symfony/translation/legacy.zip/b6d8164085ee0b6debcd1b7a131fd6f63bb04854\n    54/58:  https://codeload.github.com/symfony/polyfill-mbstring/legacy.zip/3296adf6a6454a050679cde90f95350ad604b171\n    55/58:  https://codeload.github.com/api-platform/core/legacy.zip/5b5b4ef13a70b495dda32863935a0a0f79873da1\n    56/58:  https://codeload.github.com/symfony/validator/legacy.zip/f2523bfd8dc5ff648aca55c0f2748674ca4661bb\n    57/58:  https://codeload.github.com/twigphp/Twig/legacy.zip/7b604c89da162034bdf4bb66310f358d313dd16d\n    58/58:  https://codeload.github.com/symfony/security/legacy.zip/fa46e38ff4dea2d3949630efd33ed73e2ac0850a\n    Finished: success: 58, skipped: 0, failure: 0, total: 58\nPackage operations: 58 installs, 0 updates, 0 removals\n  - Installing symfony/flex (v1.0.80): Loading from cache\nPlugin installation failed, rolling back\n  - Removing symfony/flex (v1.0.80)\n[ErrorException]                                                                                                                                                                                                                              \n  Declaration of Symfony\\Flex\\ParallelDownloader::getRemoteContents($originUrl, $fileUrl, $context) should be compatible with Composer\\Util\\RemoteFilesystem::getRemoteContents($originUrl, $fileUrl, $context, ?array &$responseHeaders = NULL)  \ninstall [--prefer-source] [--prefer-dist] [--dry-run] [--dev] [--no-dev] [--no-custom-installers] [--no-autoloader] [--no-scripts] [--no-progress] [--no-suggest] [-v|vv|vvv|--verbose] [-o|--optimize-autoloader] [-a|--classmap-authoritative] [--apcu-autoloader] [--ignore-platform-reqs] [--] []...\nERROR: Service 'php' failed to build: The command '/bin/sh -c set -eux;     composer install --prefer-dist --no-dev --no-autoloader --no-scripts --no-progress --no-suggest;    composer clear-cache' returned a non-zero code: 1\n```\n\nAnd I wonder why it's trying to build instead of just pulling the images when you do docker-compose up -d\n\nWhat should I do instead?. ",
    "xElysioN": "It's seems to be fixed with a newer version of symfony/flex (at least 1.0.86)\nThis has been fixed here : https://github.com/symfony/flex/commit/6dd319f2b9b206e717b23ea4268181a3dd8e65e6#diff-b34514797718dcfa298b2eca60fa4d15\n. ",
    "agung-wete": "after couple lines of try apk update\ni add \n\nFROM php:${PHP_VERSION}-fpm-alpine AS api_platform_php\nupdate first\nRUN apk update;\n\nit works \ud83d\ude04 \n. ",
    "slipo": "@dunglas any update on this? Is what you're working on public? Would love to hear about where this is at and I could potentially lend a hand.. @dunglas @teohhanhui sure! take a look?. ",
    "DejanVuj": "Hi @raikenatsu, try to implement extension. Inside postman as I can see, you are getting ld+json response. If you want to get response as json, instead of using \"Content-Type:application/json\" try using \"Accept:application/json\". In case someone else have same issue, the problem is I was using \n\n\"access_control\"=\"object.getAuthor() == user\" inside collectionOperations\nThis is something you do not need if you are using extension. It is requred only for itemOperations. Somehow updating symfony project with  composer update solved it for me. \n",
    "raikenatsu": "Thanks, it works fine.. ",
    "daFish": "I fixed it by changing NGINX_VERSION to stable. That worked.. Oh, sorry. You can change that in your Dockerfile. The variable is being initialized at the beginning of the file.. ",
    "Mellgood": "Where do I have to do that change?. Thank you so much daFish, it solved my issue. ",
    "alexfinnarn": "I didn't read closely enough. The troubleshooting info is already stated https://github.com/api-platform/docs/blob/2.3/extra/troubleshooting.md#error-starting-userland-proxy. Looks like the tests would need changing so maybe not such a good idea.\nhttps://travis-ci.org/api-platform/api-platform/builds/422799723#L2168\nFeel free to close if it is a lot of work. This issue can easily be solved in documentation with a caveat about host machine ports and how to debug those not being available.. sorry, I should have closed this. For posterity, here it is in the troubleshooting docs https://github.com/api-platform/docs/blob/2.3/extra/troubleshooting.md#error-starting-userland-proxy. ",
    "roukmoute": "So we must add all informations (Book and Review) in two steps?. So I've added a review first and try this:\nCurl\ncurl -X POST \"https://localhost:8443/books\" -H  \"accept: application/ld+json\" -H  \"Content-Type: application/ld+json\" -d \"{  \\\"isbn\\\": \\\"string\\\",  \\\"title\\\": \\\"string\\\",  \\\"description\\\": \\\"string\\\",  \\\"author\\\": \\\"string\\\",  \\\"publicationDate\\\": \\\"2018-09-05T12:19:21.452Z\\\",  \\\"reviews\\\": [    \\\"/reviews/4\\\"  ]}\"\nRequest URL\nhttps://localhost:8443/books\nResponse body\n{\n  \"@context\": \"/contexts/Book\",\n  \"@id\": \"/books/5\",\n  \"@type\": \"Book\",\n  \"isbn\": \"string\",\n  \"title\": \"string\",\n  \"description\": \"string\",\n  \"author\": \"string\",\n  \"publicationDate\": \"2018-09-05T12:19:21+00:00\",\n  \"reviews\": [],\n  \"id\": 5\n}\nResponse headers\ncache-control: no-cache, private  content-type: application/ld+json; charset=utf-8  date: Wed, 05 Sep 2018 12:25:49 GMT  link: <https://localhost:8443/docs.jsonld>; rel=\"http://www.w3.org/ns/hydra/core#apiDocumentation\"  server: nginx/1.15.3  vary: Accept  x-content-type-options: nosniff  x-debug-token: bced9a  x-debug-token-link: https://localhost:8443/_profiler/bced9a  x-firefox-spdy: h2  x-frame-options: deny  x-powered-by: PHP/7.2.9\nIt creates the book, but not with the review, am I missing something?. > if you want to create both the review and the book in one time, you must allow this usage by setting the appropriate configuration groups\n\ndunglas. \n",
    "trsteel88": "Thanks @soyuka. I already have a denormalizer/normalizer so I used that:\n```php\n/\n     * @param mixed $data\n     * @param null  $format\n     \n     * @return bool\n     /\n    public function supportsNormalization($data, $format = null)\n    {\n        return $data instanceof File;\n    }\n/**\n * @param object $object\n * @param null   $format\n * @param array  $context\n *\n * @return array|\\Symfony\\Component\\Serializer\\Normalizer\\scalar\n */\npublic function normalize($object, $format = null, array $context = [])\n{\n    $data = $this->decorated->normalize($object, $format, $context);\n\n    if ($object instanceof File) {\n        $data['write_token'] = '[Firebase Custom Token Here]';\n        $data['read_url'] = '[Url to Download File]';\n\n        unset($data['id']);\n        unset($data['@id']);\n        unset($data['@type']);\n    }\n\n    return $data;\n}\n\n```. @dunglas any chance you could give some guidance on this one? Does something need to be specifically configured to expose resources in react-admin?. Here is my annotation.\nphp\n/**\n     * @var float\n     *\n     * @ORM\\Column(type=\"decimal\", precision=8, scale=2)\n     */\n    private $totalPrice = 0.00;\nThe getter returns a float\nphp\npublic function getTotalPrice(): float\n    {\n        return round($this->totalPrice, 2);\n    }\nResponse is:\njson\n{\n    \"@context\": \"/contexts/Project\",\n    \"@id\": \"/projects/91\",\n    \"@type\": \"Project\",\n    \"id\": 91,\n    \"totalPrice\": 100,\n...\n}\nI am not using a schema like you have. Is that required? Do you return a float @aaa2000 . Thanks. I'll try it out.. ",
    "zim32": "I understand. Sorry closing. ",
    "mmplanet": "Hi @dunglas, thank you.\nThe results are rather similar after doing the upgrade, if not slower than before. Anything I might be missing?\n. @dunglas In prod mode, Blackfire not installed. I can go in dev mode and share the Symfony profiler data, but I guess that's not really relevant.. @dunglas Thanks for the tips. We will install Blackfire as we wanted to do some performance assessment anyway, and will come back with the results. Meanwhile, the upgrade to API-Platform 2.3 broke a lot of our routes. We had some GET routes with custom Item Data Providers that allowed both IDs and slugs for {$id}. Those routes are no longer working with slugs as IntegerDenormalizer->denormalize() always returns 0 for the ones with them. Any way to add a StringDenormalizer or something like that?\nLE: On the same topic: https://github.com/api-platform/core/issues/2116#issuecomment-407678006. I have also described a similar problem here.. ",
    "tezvi": "Thanks for info. It seems that xdebug is most likely the bottleneck here. Developing without a debugger is another problem though.. Thanks for examples. It seems it does not work. I would expect that resource is available only for accept formats defined with formats yaml property (excel in example). However, I can still request json-ld, but HTTP 406 should be returned instead.. You can use any bundle without flex support. Flex is basically a composer plugin that installs bundles using recipes and does some extra configuration. It's definitely a powerful an handy tool though.\nWe are not using it because our development is behind a very strict corporate firewall that blocks symfony.sh. Hi antograssiot, sure I can give it a try. Did you already solve it?. @antograssiot  Sorry, I completely forgot about my feedback here. I've just tested using your PR and I can confirm that it works for my use case. The swagger UI is now rendered correctly honoring the formats attribute value. Thx for your effort!. Sure no problem, I'll provide PR.. @soyuka , it seems this has been already resolved by Yanick Witschi on master branch https://github.com/api-platform/core/pull/2289 with a slightly different approach.\nNot sure if released yet.. Hi!\nBy {offers} you refer to Offers entity identifier (primary key)?\nI suppose that might defeat the purpose of IRIs, as /products/{id}/offers returns collection of offers with a unique IRIs. You could then fetch offers directly with an IRI.\nIs there a specific reason why you need to access offers by primary key from products collection?\n. Maybe I'm missing the point. Event if it might be convenient for development it does break RESTfull principles.\nTry to look it from a different perspective. You want to retrieve an Offer resource with ID 2 with IRI /offers/{id} by using /products/1/offers/2. What use do you have from product ID=1 when you already know the exact Offer ID (2)? That would make more sense if you had ManyToMany relation with three entities where you need both URI identifiers to select an item from database (although api filters should be more convenient for this example).\n. Your arguments stand, I guess that really depends on api architect preference as it is not strictly standardized.\nI've checked the code and it seems to me the limitation is in this method:\nhttps://github.com/api-platform/core/blob/c20b86cfa6def8f1921dd7e02280d283fcd80e8a/src/Operation/Factory/SubresourceOperationFactory.php#L63\nThe method registers only a subresource collection route. It would be nice to add an items route as well with subresource identifiers.\nThe item data provider might even support the case (haven't tested it).\nhttps://github.com/api-platform/core/blob/c20b86cfa6def8f1921dd7e02280d283fcd80e8a/src/Bridge/Doctrine/Orm/SubresourceDataProvider.php#L125\nPerhaps core devs could shed some light on this matter.\n. Not sure if I understood, what do you mean with \"Doctrine Filter\". Did you mean ORM QueryBuilder instance? You can apply where conditions to query builder instance. If you need native query because of SQL specifics than you might have difficulties with ORM as ApiPlatform data provider works with ORMc query builder only.\nI've resolved that by using a custom DataProvider that uses DBAL query builder internally. However that is another story for another purpose as you have to write a lot of additional code.\nAnother possible solution is to extend DQL to support your specifics.. Yes, you are correct. Writing a custom DataProvider opens a Pandora's box :)\nPerhaps you can have fun with this https://github.com/opsway/doctrine-dbal-postgresql.\nNote DQL support for postgres JSON_AGG. You could extract jsonb data from titleText column with locale condition. Not really sure if that will work, just a theory.\nSerializer approach is also ok, just make sure not to introduce a performance hit if your API will be used excessively.. Not really sure if I understand the issue here. Why don't you just change the class property name from private $parameterid to private $changedName ?\nIf that is not an option and the serializedName annotation is not working you could try another approach by introducing a new getter method and properly configuring serialization group (if using).\npublic function getChangedName() : Parameter\n{\n    return $this->parameterid;\n}. Based on the complexity this might be very tricky or even impossible with current implementation.\nDecorating a normalizer is an option of course, but as far as I understood you could have many different filters active in one request. Is this advisable from a performance standpoint? Depending on your DB vendor this is usually much cleaner and performance friendly by using COUNT OVER PARTITION sql syntax in a single SQL statement. However, you do not have that privilege with ApiPlatform. I would got with a decorated normalizer approach or by a non-apiplatform request (plain old request). Either way you would have to duplicate some filter logic.. How would you suggest to do that?. That's a fine idea but I suppose it gives some devops overhead which might introduce other problems later, like inflexibility for maintenance and refactoring.. ",
    "vitalicwow": "I can't get this setup to work for the life of me, followed all the steps here and in #742 and I still get data showing up in the dev database after POST requests, APP_ENV=test seems to have no effect because if I instead edit packages/doctrine.yaml to use the sqllite database, behat starts throwing an error of \"Operation 'Doctrine\\DBAL\\Platforms\\AbstractPlatform::getSequenceNextValSQL' is not supported by platform\". I don't know why it's so hard to test this thing\nUpdate (fixed):\nAt some point I had configured MinkExtension to use Goutte instead of symfony2, changing it to symfony2 somehow fixed the issue.\n\n. ",
    "Cochonours": "I'm trying to create a symfony4+apiplatform project for the first time and this is driving me insane. I would like to be able to define a few tests for the api, and am completely stuck after trying to follow all the possible options given by my google search. I installed all the things @geerlingguy mentionned\nHere are the relevant parts of my composer.json\n\"autoload\": {\n        \"psr-4\": {\n            \"App\\\\\": \"src/\"\n        }\n    },\n    \"autoload-dev\": {\n        \"psr-4\": {\n            \"App\\\\Tests\\\\\": \"tests/\"\n        }\n    },\n    \"require\": {\n        \"php\": \">=7.2.0\",\n        \"api-platform/api-pack\": \"^1.1\",\n        \"doctrine/doctrine-bundle\": \"^1.6\",\n        \"doctrine/orm\": \"^2.5\",\n        \"incenteev/composer-parameter-handler\": \"^2.0\",\n        \"sensio/framework-extra-bundle\": \"^5.2\",\n        \"symfony/apache-pack\": \"^1.0\",\n        \"symfony/asset\": \"^4.1\",\n        \"symfony/console\": \"^3.3\",\n        \"symfony/dotenv\": \"^4.1\",\n        \"symfony/flex\": \"^1.1\",\n        \"symfony/form\": \"^4.1\",\n        \"symfony/monolog-bundle\": \"^3.3\",\n        \"symfony/orm-pack\": \"^1.0\",\n        \"symfony/polyfill-apcu\": \"^1.0\",\n        \"symfony/security-bundle\": \"^4.1\",\n        \"symfony/swiftmailer-bundle\": \"^3.2\",\n        \"symfony/templating\": \"^4.1\",\n        \"symfony/translation\": \"^4.1\",\n        \"symfony/twig-bundle\": \"^4.1\",\n        \"symfony/validator\": \"^4.1\"\n    },\n    \"require-dev\": {\n        \"behat/behat\": \"^3.5\",\n        \"behat/gherkin\": \"^4.5\",\n        \"behat/mink\": \"^1.7\",\n        \"behat/mink-browserkit-driver\": \"^1.3\",\n        \"behat/mink-extension\": \"^2.3\",\n        \"behat/symfony2-extension\": \"^2.1\",\n        \"behatch/contexts\": \"^3.2\",\n        \"phpunit/phpunit\": \"^7.4\",\n        \"sensiolabs/security-checker\": \"^5.0\",\n        \"symfony/debug-bundle\": \"^4.1\",\n        \"symfony/phpunit-bridge\": \"^3.0\",\n        \"symfony/web-profiler-bundle\": \"^4.1\"\n    },\nMy config/behat.yml is basically the same as @geerlingguy but I need to add some obscure paths so the \"features\" folder would appear in \"/tests\" instead of the root folder.\ndefault:\n  calls:\n    error_reporting: 16383 # E_ALL & ~E_USER_DREPRECATED\n  suites:\n    default:\n      paths:\n        features: 'tests/features'\n        bootstrap: 'tests/features/bootstrap'\n      contexts:\n        - FeatureContext\n        - Behat\\MinkExtension\\Context\\MinkContext\n        - Behatch\\Context\\RestContext\n        - Behatch\\Context\\JsonContext\n  gherkin:\n    cache: ~\n    filters:\n      tags: ~@wip\n  extensions:\n    Behat\\Symfony2Extension:\n      kernel:\n        bootstrap: \"tests/features/bootstrap/bootstrap.php\"\n        class: \"App\\\\Kernel\"\n    Behat\\MinkExtension:\n      base_url: \"http://localhost:8081/jaguar2/api\"\n      sessions:\n        default:\n          symfony2: ~\nBehatch\\Extension: ~\nMy FeatureContext:\n```\n<?php\nuse Behat\\Behat\\Context\\Context;\nuse Symfony\\Component\\HttpFoundation\\Request;\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\HttpKernel\\KernelInterface;\n/\n * This context class contains the definitions of the steps used by the demo \n * feature file. Learn how to get started with Behat and BDD on Behat's website.\n * \n * @see http://behat.org/en/latest/quick_start.html\n */\nclass FeatureContext implements Context\n{\n    /\n     * @var KernelInterface\n     */\n    private $kernel;\n/**\n * @var Response|null\n */\nprivate $response;\n\npublic function __construct(KernelInterface $kernel)\n{\n    $this->kernel = $kernel;\n}\n\n}\nAnd when I run \"vendor/bin/behat\" I get  Can not find a matching value for an argument $request of the method Behatch\\Context\\RestContext::__construct().  and have no idea what to do.. I think I may have found the problem. I do not know why (probably a \"behat --init\" while I was playing with the paths) but I saw I had a misplaced file lost in the configconfig/features/bootstrap/FeatureContext.php. I removed that and now I get the FeatureContext context class not found and can not be used.  ```\nSo... how am I supposed to tell behat to search for that file in \"/tests/features/bootstrap/FeatureContext.php\", considering the config is in \"/config/behat.yml\"? I just tried updating the different paths I have in there with \"../tests\" instead of \"tests\" but to no avail.. ... Proof reading my question, I found a discrepency between both cases as I put a short name starting with a upper case for one, and a lower case for the other. Using a upper case for the Sinistre (=> Claim) resolves this issue, so I am going to close it already, but damn is this normal for one URL to work fine and the other not? This framework seem so brittle, and the exceptions do not help a lot in finding the issue.... ",
    "saamorim": "After a few steps I think I've manage to setup behat+behatch but some errors appear.\nTo recap:\n$ docker-compose exec php composer require --dev behatch/contexts behat/mink behat/symfony2-extension behat/mink-browserkit-driver\n$ docker-compose exec php vendor/bin/behat -V\n$ docker-compose exec php vendor/bin/behat --init\nAdded the api/behat.yaml with the content:\nyaml\ndefault:\n  calls:\n    error_reporting: 16383 # E_ALL & ~E_USER_DREPRECATED\n  suites:\n    default:\n      contexts:\n        - FeatureContext: { doctrine: \"@doctrine\" }\n        - Behat\\MinkExtension\\Context\\MinkContext\n        - Behatch\\Context\\RestContext\n        - Behatch\\Context\\JsonContext\n  extensions:\n    Behat\\Symfony2Extension:\n      kernel:\n        env: 'test'\n        debug: 'true'\n        bootstrap: \"features/bootstrap/bootstrap.php\"\n        class: \"App\\\\Kernel\"\n    Behat\\MinkExtension:\n      base_url: \"http://localhost/\"\n      sessions:\n        default:\n          symfony2: ~\n    Behatch\\Extension: ~\nAdded the api/features/bootstrap/bootstrap.php with the content\n```php\n<?php\nuse Symfony\\Component\\Dotenv\\Dotenv;\n// The check is to ensure we don't use .env in production\nif (!isset($_SERVER['APP_ENV'])) {\n    if (!class_exists(Dotenv::class)) {\n        throw new \\RuntimeException('APP_ENV environment variable is not defined. You need to define environment variables for configuration or add \"symfony/dotenv\" as a Composer dependency to load variables from a .env file.');\n    }\n    (new Dotenv())->load(DIR.'/../../.env');\n}\n```\nChange the api/features/bootstrap/FeatureContext.php to be:\n```php\n<?php\nuse Behat\\Behat\\Context\\Context;\nuse Behat\\Behat\\Context\\SnippetAcceptingContext;\nuse Doctrine\\Common\\Persistence\\ManagerRegistry;\nuse Doctrine\\ORM\\Tools\\SchemaTool;\nuse Behat\\Gherkin\\Node\\PyStringNode;\nuse Behat\\Gherkin\\Node\\TableNode;\n/\n * Defines application features from the specific context.\n */\nclass FeatureContext implements Context, SnippetAcceptingContext\n{\n    /\n     * @var ManagerRegistry\n     /\n    private $doctrine;\n    /\n     * @var SchemaTool\n     */\n    private $schemaTool;\n    /\n     * @var array\n     /\n    private $classes;\n/**\n * Initializes context.\n *\n * Every scenario gets its own context instance.\n * You can also pass arbitrary arguments to the\n * context constructor through behat.yml.\n */\npublic function __construct(ManagerRegistry $doctrine)\n{\n    $this->doctrine = $doctrine;\n    $manager = $doctrine->getManager();\n    $this->schemaTool = new SchemaTool($manager);\n    $this->classes = $manager->getMetadataFactory()->getAllMetadata();\n}\n\n/**\n * @BeforeScenario @createSchema\n */\npublic function createDatabase()\n{\n    $this->schemaTool->dropSchema($this->classes);\n    $this->doctrine->getManager()->clear();\n    $this->schemaTool->createSchema($this->classes);\n}\n\n}\n```\nFinally added the content to the api/features/book.feature as stated in https://api-platform.com/docs/distribution/testing\nAfter running behat\n$ docker-compose exec php vendor/bin/behat\ngot the output:\n4 scenarios (1 passed, 3 failed)\n27 steps (24 passed, 3 failed)\n0m0.57s (30.32Mb)\nAll of the failures are due to the ordering of the id attribute. Changing the id's to the end fixed the issues\nOther solution for fixing this issue is to define the order of the parameters using the order attribute (https://api-platform.com/docs/core/default-order)\n```php\n<?php\n// api/src/Entity/Book.php\nnamespace App\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\n/*\n * @ApiResource(attributes={\"order\"={\"foo\", \"bar\"}})\n /\nclass Book\n```. Thank for the input @dannylewis-sheffield, recreate a new project followed the api-platform setup instructions, without creating the books feature, then followed my instructions with a few tweaks:\n$ docker-compose exec php composer require --dev behatch/contexts behat/mink:\"~1.7@dev\" behat/symfony2-extension behat/mink-browserkit-driver\n$ docker-compose exec php vendor/bin/behat -V\n$ docker-compose exec php vendor/bin/behat --init\nThe api/behat.yaml now has the following content:\nyaml\ndefault:\n  calls:\n    error_reporting: 16383 # E_ALL & ~E_USER_DREPRECATED\n  suites:\n    default:\n      contexts:\n        - FeatureContext: { kernel: \"@kernel\", doctrine: \"@doctrine\" }\n        - Behat\\MinkExtension\\Context\\MinkContext\n        - Behatch\\Context\\RestContext\n        - Behatch\\Context\\JsonContext\n  extensions:\n    Behat\\Symfony2Extension:\n      kernel:\n        env: 'test'\n        debug: 'true'\n        bootstrap: \"features/bootstrap/bootstrap.php\"\n        class: \"App\\\\Kernel\"\n    Behat\\MinkExtension:\n      base_url: \"http://localhost/\"\n      sessions:\n        default:\n          symfony2: ~\n    Behatch\\Extension: ~\nFeature context has the following:\n```php\n<?php\nuse Behat\\Behat\\Context\\Context;\nuse Doctrine\\Common\\Persistence\\ManagerRegistry;\nuse Doctrine\\ORM\\Tools\\SchemaTool;\nuse Symfony\\Component\\HttpFoundation\\Request;\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\HttpKernel\\KernelInterface;\nuse Behat\\Behat\\Context\\SnippetAcceptingContext;\n/\n * This context class contains the definitions of the steps used by the demo\n * feature file. Learn how to get started with Behat and BDD on Behat's website.\n \n * @see http://behat.org/en/latest/quick_start.html\n /\nclass FeatureContext implements Context, SnippetAcceptingContext\n{\n    /\n     * @var KernelInterface\n     */\n    private $kernel;\n/**\n * @var Response|null\n */\nprivate $response;\n\n/**\n * @var ManagerRegistry\n */\nprivate $doctrine;\n/**\n * @var SchemaTool\n */\nprivate $schemaTool;\n/**\n * @var array\n */\nprivate $classes;\n\npublic function __construct(KernelInterface $kernel, ManagerRegistry $doctrine)\n{\n    $this->kernel = $kernel;\n    $this->doctrine = $doctrine;\n    $manager = $doctrine->getManager();\n    $this->schemaTool = new SchemaTool($manager);\n    $this->classes = $manager->getMetadataFactory()->getAllMetadata();\n}\n\n/**\n * @BeforeScenario @createSchema\n */\npublic function createDatabase()\n{\n    $this->schemaTool->dropSchema($this->classes);\n    $this->doctrine->getManager()->clear();\n    $this->schemaTool->createSchema($this->classes);\n}\n\n/**\n * @When a demo scenario sends a request to :path\n */\npublic function aDemoScenarioSendsARequestTo(string $path)\n{\n    $this->response = $this->kernel->handle(Request::create($path, 'GET'));\n}\n\n/**\n * @Then the response should be received\n */\npublic function theResponseShouldBeReceived()\n{\n    if ($this->response === null) {\n        throw new \\RuntimeException('No response received');\n    }\n}\n\n}\n```\nafter running, got the following output\n```\n$ docker-compose exec php vendor/bin/behat\nFeature:\n  In order to prove that the Behat Symfony extension is correctly installed\n  As a user\n  I want to have a demo scenario\nScenario: It receives a response from Symfony's kernel # features/demo.feature:10\n    When a demo scenario sends a request to \"/\"          # FeatureContext::aDemoScenarioSendsARequestTo()\n    Then the response should be received                 # FeatureContext::theResponseShouldBeReceived()\n1 scenario (1 passed)\n2 steps (2 passed)\n0m0.23s (26.89Mb)\n```\n. ",
    "dannylewis-sheffield": "@saamorim guide just about worked for me but needed a few modifications.\nThe version of behat/mink needed to be \"~1.7@dev\"\nhttps://api-platform.com/docs/core/default-order also doesn't work, this was their second proposal but I think this is for ordering the data not the structure, you need to change the order in the feature file and place the id attributes last.\nFinally the createSchema and dropSchema annotation don't work, and it's using the main database and not a temporary SQLite database, as @geerlingguy says #742 might have some more answers on this.\nCould this be given a higher priority?  If I get the time I'll investigate further and submit a patch but right now I can run tests for the javascript side of projects, we are using your wonderful docker setup, but not the PHP and main API side of the project.. As a side note with regard to the ordering of the json structure and failing tests, the id placement above, I think that the upstream behatch/contexts could be improved or this project could write an additional context, I'll raise an issue with them as well.\nhttps://github.com/Behatch/contexts/blob/master/src/Context/JsonContext.php\nSee method: public function theJsonShouldBeEqualTo\nCould be amended to check if the objects are functionally the same. I've changed the feature file comparisons from:\nAnd the JSON should be equal to:\nto\nAnd the JSON should be functionally equal to:\nand updated api/features/bootstrap/FeatureContext.php to be:\n```\n<?php\nuse Doctrine\\Common\\Persistence\\ManagerRegistry;\nuse Doctrine\\ORM\\Tools\\SchemaTool;\nuse Behat\\Gherkin\\Node\\PyStringNode;\nuse Behatch\\Json\\JsonInspector;\nuse Behatch\\HttpCall\\HttpCallResultPool;\nuse Behatch\\Json\\Json;\n/\n * Defines application features from the specific context.\n */\nclass FeatureContext extends Behatch\\Context\\BaseContext\n{\n    /\n     * @var ManagerRegistry\n     /\n    private $doctrine;\n    /\n     * @var SchemaTool\n     */\n    private $schemaTool;\n    /\n     * @var array\n     /\n    private $classes;\nprotected $inspector;\nprotected $httpCallResultPool;\n\n/**\n * Initializes context.\n *\n * Every scenario gets its own context instance.\n * You can also pass arbitrary arguments to the\n * context constructor through behat.yml.\n */\npublic function __construct(ManagerRegistry $doctrine, HttpCallResultPool $httpCallResultPool, $evaluationMode = 'javascript')\n{\n    $this->doctrine = $doctrine;\n    $manager = $doctrine->getManager();\n    $this->schemaTool = new SchemaTool($manager);\n    $this->classes = $manager->getMetadataFactory()->getAllMetadata();\n\n    $this->inspector = new JsonInspector($evaluationMode);\n    $this->httpCallResultPool = $httpCallResultPool;\n}\n\n/**\n * @BeforeScenario @createSchema\n */\npublic function createDatabase()\n{\n    $this->schemaTool->createSchema($this->classes);\n}\n\n/**\n * @AfterScenario @dropSchema\n */\npublic function dropDatabase()\n{\n    $this->schemaTool->dropSchema($this->classes);\n}\n\n/**\n * @Then the JSON should be functionally equal to:\n */\npublic function theJsonShouldBeFunctionallyEqualTo(PyStringNode $content)\n{\n\n    $actual = new Json($this->httpCallResultPool->getResult()->getValue());\n\n    try {\n        $expected = new Json($content);\n    } catch (\\Exception $e) {\n        throw new \\Exception('The expected JSON is not a valid');\n    }\n\n    $actualArray = (array) $actual->getContent();\n    $expectedArray = (array) $expected->getContent();\n\n    $this->ksortTree($actualArray);\n    $this->ksortTree($expectedArray);\n\n    $this->assertSame(\n        (string) json_encode($expectedArray, JSON_UNESCAPED_SLASHES | JSON_UNESCAPED_UNICODE),\n        (string) json_encode($actualArray, JSON_UNESCAPED_SLASHES | JSON_UNESCAPED_UNICODE),\n        \"The json is equal to:\\n\". $actual->encode()\n    );\n\n}\n\n/**\n * @param array $array\n */\nprivate function ksortTree(&$array)\n{\n\n    if(is_object($array)){\n        $array = (array) $array;\n    }\n\n    if (!is_array($array)) {\n        return false;\n    }\n\n    ksort($array);\n    foreach ($array as $k=>$v) {\n        $this->ksortTree($array[$k]);\n    }\n    return true;\n}\n\n}\n```\nStill room for improvement but it's working. Up to you guys and I can see your perspective but right now I can get a get a developer to download the distribution and deliver a project with minimal intervention, well, some of the testing docs and code could do with an update since the Symfony 4 changes ;>, and I know it will be delivered with a good architecture and tech stack.  This is thanks to you guys and this wonderful project.\nBut what it is not doing is showing up on search engines without changes to the client component, and it seems a shame to bin or significantly change it on a per project basis when an optional component, just like the admin and client, could solve the issue and allow the world to easily find the great tools and sites people are building.\nAs for Next.js and others, I like them but I'd rather keep running node on the servers to a minimum, some bright spark always suggests writing the API in node as well and it'd rather not have that conversation again :)\nI'm also not sure if running a crawler to generate static HTML is a hack or just a different approach, it does have the benefit of not limiting developers to a specific stack or framework, or worse rolling their own, and it also allows them to focus on writing clean testable frontend code that interacts with clean testable APIs, ultimatly delivering business or community needs.. ",
    "t75bernd": "Hey, i found out myself what was creating this issue. When setting the rows i use $this->rows->set($row->getCustomId(), $row) where getCustomId() is not unique and so it overrides the other value with the same custom id.. ",
    "gwenl": "Just to let you know: it seems the easiest way was to reorder the JSON response on the client side, using the dataFilter setting in jQuery.ajax():\n```javascript\n$('#mytable').DataTable({\n        'serverSide': true,\n        'ajax': {\n            'url': '/api/my_api',\n            'headers': { 'Accept': \"application/ld+json\" },\n            'dataFilter' : function (data) {\n                var json = JSON.parse(data);\n                json.recordTotal = json['hydra:totalItems'];\n                json.recordsFiltered = json['hydra:totalItems'];\n                json.data = json['hydra:member'];\n            return JSON.stringify(json);\n        }\n    }\n\n);\n```\nThis means converting the JSON back to an object and then to a string again, though, but it works.. ",
    "tardioik": "For example I have this request :\n\nand I want to display it here as a GET method: \n\n. I tried to follow the documentation but I have an error again:\n\nI added the code in the entity : \n\nbut I have a new error :  \n\ndoes anyone know what can I do ?\n. ",
    "Neirda24": "@mmeloni : Did you succeed ? Because just using the networking policy does not seems to allow us to restrict the BAN to an IP or a pod.. @dunglas : Hi. Yes I have both a CollectionDataProvider and an ItemDataProvider. both also implementing RestrictedDataProviderInterface. Hi. It seems it was just a mistake I made. Sorry for the bother. The fact is I didn't understood fully ApiPlatform and when it says that you should create a custom data provider it doesn't specify that if using doctrine extensions you must provide the original resourceClass. In my case my resource is Thread and the outputClass is ThreadOutput in the support of the custom data provider I must use ThreadOutput but in the doctrine extensions I must provide Thread::class.\nI don't know if I am being clear enough. Although this seems to be resolved I have other issues. With the collection provider of the same resource. Still working on that I'll get back to you if I get stuck.. ",
    "methodeprog": "The way ?\nhttps://api-platform.com/docs/core/data-providers/. ",
    "h3llr4iser": "I have found the file docker-entrypoint.sh and I have add the flag to the doctrine migrations command.. ",
    "farazive": "Thanks @antograssiot. Works fine. ",
    "mBbkr": "I'm sorry but it does'nt work with EntityManagerInteface but works with ObjectManager. I've just lost 3h to figure out this issue due to this change...\nError log with EntityManagerInterface :\nCannot autowire service \"App\\EventListener\\UserFilterConfigurator\": argument \"$em\" of method \"__construct()\" has type \"Doctrine\\Orm\\EntityManagerInterface\" but this class was not found.. ",
    "martingtheodo": "Which implementation of ObjectManager do you use in your project ?\nWe will check on our project. ",
    "Miniplop": "\nI'm sorry but it does'nt work with EntityManagerInteface but works with ObjectManager. I've just lost 3h to figure out this issue due to this change...\nError log with EntityManagerInterface :\nCannot autowire service \"App\\EventListener\\UserFilterConfigurator\": argument \"$em\" of method \"__construct()\" has type \"Doctrine\\Orm\\EntityManagerInterface\" but this class was not found.\n\nHello @mBbkr,\nCan you give us the result of these commands ?\n\n. ",
    "ByScripts": "In fact, it seems that no properties are taken in account. When settings field with:\n@ApiPropery(readable=false, writable=false)\n\nI still can read/write the property.. ",
    "lukasluecke": "@dunglas Is this something that should be changed? I tried implementing this in a basic version in SchemaBuilder::getResourceObjectTypeFields, but noticed that it would interfere with the default behaviour of required / non-null fields (i.e. it would force you to manually specify required for every property).\nI think it would be nice being able to just override these assumptions when needed, but right now $propertyMetadata->isRequired() returns either true or false - we would need null or similar as well, to distinguish the case where the required flag was not set at all.\nI think another way would be with the new input_class you could create a class where the property was nullable? Not sure if that would work though.. @alanpoulain @dunglas I believe this should be moved to the core repository, if it's supposed to be pursued further? If you think it's a good idea, then I'd be willing to work on this.. The issue is that the @ApiProperty annotation exists, but does not affect the GraphQL schema.\nEither we could make it more explicit that it's REST-specific, or make it work with GraphQL?\nIt's also not only required, but also writable (and maybe others as well). Using input / output might solve the same problem, but then there should be clearer guidance on which solution is preferred / working.. Do you have any ideas how that could best be achieved? I proposed one possibility (at least for required flag), but if there is a better way I'm open to suggestions.. ",
    "mudahater": "@dunglas Thank you.  Seems like \"APP_DEBUG\"  is also not parsed.. @teohhanhui Yes, just making sure that is how it's supposed to be.. ",
    "acassan": "You can also remove the load of .env file in docker compose configuration and use dotenv in development\nWith this you can avoid restarting container or use env var with phpunit\n. ",
    "ozee31": "I don't know, how do I know?. In my dev env with docker. If i display docker logs I have\nphp_1          | [26-Oct-2018 09:37:11] WARNING: [pool www] child 11 said into stderr: \"2018-10-26T09:37:11+00:00 [critical] Class 'App\\Entity\\ArrayCollection' not found\"\nphp_1          | [26-Oct-2018 09:37:12] WARNING: [pool www] child 11 said into stderr: \"2018-10-26T09:37:12+00:00 [critical] Uncaught PHP Exception Symfony\\Component\\Debug\\Exception\\ClassNotFoundException: \"Attempted to load class \"ArrayCollection\" from namespace \"App\\Entity\".\"\nphp_1          | [26-Oct-2018 09:37:12] WARNING: [pool www] child 11 said into stderr: \"Did you forget a \"use\" statement for \"Doctrine\\Common\\Collections\\ArrayCollection\"?\" at /srv/api/src/Entity/AvisDeMarches.php line 141\"\nphp_1          | 172.24.0.5 -  26/Oct/2018:09:37:11 +0000 \"POST /index.php\" 500\nBut symfony logs are empty. Sorry, with monolog, in production it's work. ",
    "vasilvestre": "Closed, bad code with bad doc lead to errors (sorry). https://github.com/api-platform/docs/issues/753. ",
    "michaelrachlitz": "@teohhanhui, I noticed you've made a comment in https://github.com/api-platform/api-platform/issues/777\n\n\"Yet another case of issue with the zip archive. We really should warn against using it.\"\n\nWouldn't distributing the package with composer solve issues like permissions?. @z31fbras I do have that, however I just simplified the example too much I guess.\nCode is \n```\n<?php\nnamespace App\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\nuse ApiPlatform\\Core\\Annotation\\ApiProperty;\nuse Doctrine\\ORM\\Mapping as ORM;\nuse Symfony\\Component\\Validator\\Constraints as Assert;\n/\n * Class Consent\n * @ApiResource\n * @ORM\\Entity\n */\nclass Consent\n{\n    /\n     * @ORM\\Id\n     * @ORM\\Column(type=\"integer\")\n     * @ORM\\GeneratedValue(strategy=\"IDENTITY\")\n     */\n    private $id;\n/**\n * @param date-time $created_at A date property - containing consent creation date-time.\n *\n * @ORM\\Column(type=\"datetime\", name=\"created_at\")\n * @Assert\\NotBlank\n *\n * @ApiProperty(\n *     attributes={\n *         \"swagger_context\"={\"type\"=\"string\", \"format\"=\"date-time\"}\n *     }\n * )\n */\npublic $created_at;\n\n/**\n * Consent constructor.\n */\npublic function __construct()\n{\n    $this->setCreatedAt(new \\DateTime());\n}\n\n/**\n * Get id\n *\n * @return integer\n */\npublic function getId()\n{\n    return $this->id;\n}\n\n/**\n * Set id\n *\n * @param $id\n * @return Consent\n */\npublic function setId($id)\n{\n    $this->id = $id;\n\n    return $this;\n}\n\n/**\n * Get created at\n *\n * @return string\n */\npublic function getCreatedAt()\n{\n    return $this->created_at;\n}\n\n/**\n * Set created at\n *\n * @param $created_at\n * @return Consent\n */\npublic function setCreatedAt($created_at)\n{\n    $this->created_at = $created_at;\n\n    return $this;\n}\n\n}\n```\nAnd this effs out with the message: Make sure there is a loader supporting the \"api_platform\" type.\nIt is like the ApiResource is not injected properly. ApiProperty works fine.. @z31fbras \nI just did a composer update to update the entire project, but I get the same result.\nMy composer.lock says im at version 2.3.6:\n{\n...\n\"name\": \"api-platform/core\",\n\"version\": \"v2.3.6\"\n...\n}\nEntities work, but not with the @ApiResource. The Swagger documentation is not complete though, as I cannot add descriptions without it crashing.. @z31fbras sigh, I found the error. Was a typo in the doctrine wrapper class which caused an unwanted error. Had nothing to do with the ApiResource class. ",
    "franbenz": "I read the current documentation and the steps there assume a flex project.\nAm I missing something? . ",
    "elpoutro": "(For Symfony2/3)\n1) Use this package with composer:\ncomposer require api-platform/core\n2) Configure the bundle manually in AppKernel.php:\n$bundles = [\n// [...]\nnew ApiPlatform\\Core\\Bridge\\Symfony\\Bundle\\ApiPlatformBundle(),\n];\n3) Add this in your app/config/routing.yml\napi:\nresource: '.'\ntype:     'api_platform'\nprefix:   '/api' # Optional\n4) If needed, add your specific configuration in app/config/config.yml\napi_platform:\ntitle: 'specific name'\n(complete configuration here)\nI hope it will help.. ",
    "christoph-hautzinger": "funny... always hitting my own questions again on api platform related questions. ",
    "sushicodeur": "I commented li. 67 of AddTagsListener.php \n// $response->headers->set('Cache-Tags', implode(',', $resources));\nand no more 502 errors.\nIs there a way to have the same result by configuration ?. Ok, this config did the trick, but it looks like I'm missing some caching features ? :)\n```\n    http_cache: \n        invalidation: \n            enabled: false\ninvalidation:\nenabled: true\nvarnish_urls: ['%env(VARNISH_URL)%']\nmax_age: 0\nshared_max_age: 3600\nvary: ['Content-Type', 'Authorization']\npublic: true\n```. I'm sorry, I don't get how to change this config.\nI updated api/docker/nginx/conf.d/default.conf like so :\n```\nserver {\n    root /srv/api/public;\nlocation / {\n    proxy_buffer_size          128k;\n    proxy_buffers              4 256k;\n    proxy_busy_buffers_size    256k;\n\n    # try to serve file directly, fallback to index.php\n    try_files $uri /index.php$is_args$args;\n}\n\n...\n```\nI tried with various values (up to 512k), but still got 502 errors. I verified that this file was updated inside the container before trying.\nIt looks like this subject is beeing discussed in #614, issue has been closed but I haven't found issues dealing with xkey... is it something that will be implemented ?. I've tried to set buffers up to 2048-4096k but still got 502 errors. It looks like the nginx config is taken into account for it throws errors when I set a smaller value for proxy_busy_buffers_size than proxy_buffer_size.\nFor now I'll disable the validation cache and subscribed to a bunch of related issues :)\nThanks for your help. Of course if you got an idea on what's wrong in my case, tell me :). @purplefish32 \nThis worked for me (api/docker/nginx/conf.d/default.conf) : \n```\nserver {\n    root /srv/api/public;\nlocation / {\n    # try to serve file directly, fallback to index.php\n    try_files $uri /index.php$is_args$args;\n}\n\nlocation ~ ^/index\\.php(/|$) {\n    # Comment the next line and uncomment the next to enable dynamic resolution (incompatible with Kubernetes)\n    fastcgi_pass php:9000;\n    #resolver 127.0.0.11;\n    #set $upstream_host php;\n    #fastcgi_pass $upstream_host:9000;\n\n    fastcgi_buffer_size          128k;\n    fastcgi_buffers              4 256k;\n\n    fastcgi_split_path_info ^(.+\\.php)(/.*)$;\n    include fastcgi_params;\n    # When you are using symlinks to link the document root to the\n    # current version of your application, you should pass the real\n    # application path instead of the path to the symlink to PHP\n    # FPM.\n    # Otherwise, PHP's OPcache may not properly detect changes to\n    # your PHP files (see https://github.com/zendtech/ZendOptimizerPlus/issues/126\n    # for more information).\n    fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;\n    fastcgi_param DOCUMENT_ROOT $realpath_root;\n    # Prevents URIs that include the front controller. This will 404:\n    # http://domain.tld/index.php/some-path\n    # Remove the internal directive to allow URIs like this\n    internal;\n}\n\n# return 404 for all other php files not matching the front controller\n# this prevents access to other php files you don't want to be accessible.\nlocation ~ \\.php$ {\n  return 404;\n}\n\n}\n```\nfastcgi_busy_buffers_size does not exists for fastcgi\nBy the way, thank you all for your help !. @dunglas sure it looks like something fun to do. Is there any guidelines on doing so for the doc ? I found some for contributing to core, schema generator, admin or crud generator, but none for the docs.\nI'll try but don't be too harsh on me if I do it not the good way or my english sounds like french :). So I installed xdebug and started to step into the code to obtain the data that raise this error.\nIn vendor/symfony/serializer/Normalizer/AbstractObjectNormalizer.php, it does $attributes = $this->getAttributes($object, $format, $context); on line 87.\nThe value of $attributes for my faulty contact is limited to _id and salesforceId on line 88. Thus no value for role and the error raised by GraphQL is legit.\nIf I inspect $object I got strange things that I don't understand. \nFor working entities, I can see the properties properly named with their values (ex email: \"contact@email;com\", role: \"ROLE_1\")...\nFor the entity that raises the error I can see the values but the property names are in a strange format (ex : *App\\Entity\\Contact*email: \"contact@email;com\", *App\\Entity\\Contact*role: \"ROLE_1\")\nAny help or explanation there ? What does it means ?. Ok, I noticed that the type for the faulty object is Proxies\\__CG__\\AppEntityContact instead of App\\Entity\\Contact, I try to find out what's this thing.. @alanpoulain thank you for the feedback. I'll have a look at it.. So I solved this by creating an SQLFilter that gets the token_storage with a service. \nBut I don't like it. I had to rewrite the DQL filters from the ORM Filter in SQL, and both are called.\nReally not sure it's the best way to do this.. I did try to add the Category::class === $resourceClass but it didn't led anywhere interesting.\nI ended up creating an SQLFilter like so https://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/filters.html. This works and restricts posts even when displayed in categories. \nIs it the best way to go then ?. ",
    "janklan": "\nI commented li. 67 of AddTagsListener.php\n// $response->headers->set('Cache-Tags', implode(',', $resources));\nand no more 502 errors.\n\nWhy not use $response->headers->set('Cache-Tags', md5(implode(',', $resources))); to guarantee a maximum length? I'm using UUID for primary keys and 111 items (entity called Category) already generates 4801 bytes of the header value.\nWhile MD5 isn't good for many things, it fits here quite well? \nI added my own kernel.response event listener with priority -3 to do this for now. I'm happy to create a PR, unless somebody is already working on improving this? \n```\n<?php\nnamespace App\\EventListener;\nuse Symfony\\Component\\HttpKernel\\Event\\FilterResponseEvent;\nclass OverrideCacheTagsListener\n{\n    /*\n     * Makes sure that the Cache-Tags header doesn't grow infinitely in larger projects\n     /\n    public function onKernelResponse(FilterResponseEvent $event): void\n    {\n        $request = $event->getRequest();\n        $response = $event->getResponse();\n    if (\n        !$request->isMethodCacheable()\n        || !$response->isCacheable()\n    ) {\n        return;\n    }\n\n    if ($response->headers->has('Cache-Tags') && strlen($response->headers->get('Cache-Tags')) > 32) {\n        $response->headers->set('Cache-Tags', md5($response->headers->get('Cache-Tags')));\n    }\n}\n\n}\n```\n```\nservices:\n    App\\EventListener\\OverrideCacheTagsListener:\n        tags:\n            - { name: kernel.event_listener, event: kernel.response, priority: -3 }\n````. > Also, to preserve the mechanism, you must add the hash of every IRIs, not the global hash\nI'm not sure what do you mean by hash of every IRIs - should the hashing mechanism crawl through all related collections, make a has of each collection and then make one more hash out of all the intermediate hashes? That doesn't sound right, so I assume I misunderstood? . Got it. \nWouldn't that mean the header tag value could grow infinitely and that we'd still be at risk of hitting the configured header length limit at some stage? . ",
    "kconde2": "\n\nI commented li. 67 of AddTagsListener.php\n// $response->headers->set('Cache-Tags', implode(',', $resources));\nand no more 502 errors.\n\nWhy not use $response->headers->set('Cache-Tags', md5(implode(',', $resources))); to guarantee a maximum length? I'm using UUID for primary keys and 111 items (entity called Category) already generates 4801 bytes of the header value.\nWhile MD5 isn't good for many things, it fits here quite well?\nI added my own kernel.response event listener with priority -3 to do this for now. I'm happy to create a PR, unless somebody is already working on improving this?\n```\n<?php\nnamespace App\\EventListener;\nuse Symfony\\Component\\HttpKernel\\Event\\FilterResponseEvent;\nclass OverrideCacheTagsListener\n{\n    /*\n     * Makes sure that the Cache-Tags header doesn't grow infinitely in larger projects\n     /\n    public function onKernelResponse(FilterResponseEvent $event): void\n    {\n        $request = $event->getRequest();\n        $response = $event->getResponse();\n    if (\n        !$request->isMethodCacheable()\n        || !$response->isCacheable()\n    ) {\n        return;\n    }\n\n    if ($response->headers->has('Cache-Tags') && strlen($response->headers->get('Cache-Tags')) > 32) {\n        $response->headers->set('Cache-Tags', md5($response->headers->get('Cache-Tags')));\n    }\n}\n\n}\n\nservices:\n    App\\EventListener\\OverrideCacheTagsListener:\n        tags:\n            - { name: kernel.event_listener, event: kernel.response, priority: -3 }\n```\n\nHello, I had the same errors for many data to load from fixtures faker data like below. Nginx configuration here troubleshooting doesn't work for me. Finally my solution was to use the above EventListener. Can someone tell me, if it is a good solution ?\n`for ($i = 1; $i <= 100; $i++) {\n            $restaurant = new Restaurant();\n        $restaurant->setName($faker->sentence($nbWords = 6, $variableNbWords = true))\n            ->setDescription($faker->realText(100))\n            ->setAddress($faker->address());\n        $manager->persist($restaurant);\n\n\n        for ($j = 1; $j <= 10; $j++) {\n            $menu = new Menu();\n            $menu->setName($faker->foodName())\n                ->setDescription($faker->realText(100))\n                ->setPrice($faker->randomNumber(2))\n                ->setType($faker->randomElement([\"Petit d\u00e9jeuner\", \"D\u00e9jeuner\", \"Diner\"]))\n                ->setRestaurant($restaurant);\n\n            $manager->persist($menu);\n        }\n\n    }`.\n",
    "kl3sk": "That's indeed what i use \ud83d\ude04 \nresources:\n    Namespace\\To\\Vendor\\entity:\n        attributes:\n            normalization_context:\n                groups: [ 'log.read' ]\n        collectionOperations:\n            get:\n                method: 'GET'\n        itemOperations:\n            get:\n                method: 'GET'\nMay I forgot/miss something ?\nAnd how could I customise operation ? like I did in my entities with serialisation groups.\n. Ok, that's was a cache behavior. After clearing it it seems to work.\nBut how to create serialisation groups with yaml?. Ok thanks that works:\nFor other users.\nEnable serialiser\nconfig/packages/framework.yaml\nAdd this if it doesn't exists:\nserializer:\n        enabled: true\n        mapping:\n            paths: ['%kernel.project_dir%/path/to/your/entity_yaml_files_folder/']\nAnd the YAML entity:\nYour\\Vendor\\Entity:\n    attributes:\n        id:\n            groups: ['group1']\n        any_property:\n            groups: ['group1']\n        ...\n. ",
    "beyer-johannes": "Any help? :/ . ",
    "dhernandez": "Same here. Are there any solution to this issue?. Without Doctrine it doesn't work, I've just tried it. Thank you anyway.. I found a workaround that works in my case using swagger_context.\nLodging Entity:\n```\n<?php\nnamespace App\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiProperty;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\n/\n * Class Lodging\n * @package App\\Entity\n \n * @ApiResource()\n /\nclass Lodging\n{\n    /\n     * @var string\n     \n     * @ApiProperty(identifier=true)\n     /\n    public $id;\n/**\n * @var string[]\n *\n * @ApiProperty()\n */\npublic $channels;\n\n/**\n * @var string\n *\n * @ApiProperty()\n */\npublic $name;\n\n/**\n * @var \\App\\Entity\\Manager[]\n *\n * @ApiProperty(\n *     attributes={\n *         \"swagger_context\"={\"type\"=\"array\", \"items\"={\"$ref\"=\"#/definitions/Manager\"}}\n *     }\n * )\n */\npublic $manager;\n\n}\n```\nManager Entity:\n```\n<?php\nnamespace App\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiProperty;\nuse ApiPlatform\\Core\\Annotation\\ApiResource;\n/\n * Class Manager\n * @package App\\Entity\n \n * @ApiResource()\n /\nclass Manager\n{\n    /\n     * @var string\n     \n     * @ApiProperty(identifier=true)\n     /\n    public $id;\n/**\n * @var string\n *\n * @ApiProperty()\n */\npublic $name;\n\n/**\n * @var int\n *\n * @ApiProperty\n */\npublic $sampleInteger;\n\n} \n```\nResult:\n\n. ",
    "davidloubere": "Ok, got it. I was calling the endpoint sending FormData encoded payload. It turns out that \"API Platform only supports raw documents as request input\" (cf. https://api-platform.com/docs/core/form-data/).\nI believe that would be nice to throw a more explicit exception in this case than letting the RecursiveContextualValidator of Symfony handle the case.. ",
    "kniziol": "@dunglas Problem is not solved still.\nWhy I did:\n1. Add myproject.dev to TRUSTED_HOSTS (before: localhost,api, after: localhost,api,myproject.dev)\n2. docker-compose restart\n3. docker-compose stop && docker-compose start\n4. Quit Docker. Start Docker. docker-compose start.\nNone of above was helpful. Any other solutions?. ",
    "matias-pizarro": "Exactly. ",
    "ktherage": "OK, it seems to be related to this https://github.com/api-platform/api-platform/issues/524.\nSorry for inconvenience.. ",
    "konradja100": "Ok, so i found that items from nested collection was removed if there was \"orphanRemoval=true\" on annotation, isn't that bug? Entity was removed even if property with relation was set(\"form\": \"/api/forms/{id}\"). We need orphanRemoval option enabled as long as we not only developing API with this application, but also panel with standard symfony managment. . ",
    "ghostzali": "\nAre you working behind a proxy?\nI had the same problem with my company's proxy ;)\n\nNo, I'm not. I just using VPS with public connection.. ",
    "ntuanphuc": "What is your Dockerfile content?\nThe common issue comes when you install wrong name of dependency (library), wget for example. \n. ",
    "l-vo": "id seems to be hardcoded:\nhttps://github.com/api-platform/core/blob/76722a74b479cab0c0b262e8dfa689fad68e1d8d/src/Bridge/Symfony/Routing/IriConverter.php#L124\n. ",
    "jmolivas": "@mdix  You can have saving nested relations working by implementing serialization groups\nhttps://api-platform.com/docs/core/serialization. ",
    "gte451f": "I to am looking to save the foreign key from a related table, just as described in the JSON API spec:\nhttps://jsonapi.org/format/#crud-creating\nHere is the canonical example provided where there appears to be a M-1 relationships from photos to photographer.  Is this supported in API Platform out of the box or must we resort to the serialization process?\njson\n{\n  \"data\": {\n    \"type\": \"photos\",\n    \"attributes\": {\n      \"title\": \"Ember Hamster\",\n      \"src\": \"http://example.com/images/productivity.png\"\n    },\n    \"relationships\": {\n      \"photographer\": {\n        \"data\": { \"type\": \"people\", \"id\": \"9\" }\n      }\n    }\n  }\n}. ",
    "LewisMcFly": "@gte451f Yes, this works out of the box. You would just need to put an IRI as the photographer id.\n{\n  \"data\": {\n    \"type\": \"photos\",\n    \"attributes\": {\n      \"title\": \"Ember Hamster\",\n      \"src\": \"http://example.com/images/productivity.png\"\n    },\n    \"relationships\": {\n      \"photographer\": {\n        \"data\": { \"type\": \"people\", \"id\": \"/api/photographers/9\" }\n      }\n    }\n  }\n}\nWhat you can't do is to add a relation with a resource to create, like this :\n{\n  \"data\": {\n    \"type\": \"photos\",\n    \"attributes\": {\n      \"title\": \"Ember Hamster\",\n      \"src\": \"http://example.com/images/productivity.png\"\n    },\n    \"relationships\": {\n      \"photographer\": {\n        \"data\": { \n          \"type\": \"people\", \n          \"attributes\": {\n             \"firstname\": \"John\",\n             \"lastname\": \"Doe\"\n           }\n        }\n      }\n    }\n  }\n}\nBut this as more to do with the JSON:API specification.\nAs @jmolivas said, API Platform allows this kind of thing out-of-box using serialization groups with other formats, like JSON.. ",
    "mcbuckets": "@teohhanhui it is, but it should return friends and befriendedMe combined. Because single User can be a friend and befriended. Friend is maybe a wrong noun as i said in the question originally. . ",
    "paulbonneau": "Thanks for your answer,\nYes, sorry I didn't include this information in my last post and yes, it appear\n ```\n\nName                                                         Method   Scheme   Host   Path                                        \n\napp_shidocard_default_index                                  ANY      ANY      ANY    /                                         \n  api_entrypoint                                               ANY      ANY      ANY    /api/{index}.{_format}                    \n  api_doc                                                      ANY      ANY      ANY    /api/docs.{_format}                       \n  api_jsonld_context                                           ANY      ANY      ANY    /api/contexts/{shortName}.{_format}       \n  api_cards_get_collection                                     GET      ANY      ANY    /api/cards.{_format}                      \n  api_cards_post_collection                                    POST     ANY      ANY    /api/cards.{_format}                      \n  api_cards_get_item                                           GET      ANY      ANY    /api/cards/{id}.{_format}                 \n  api_cards_delete_item                                        DELETE   ANY      ANY    /api/cards/{id}.{_format}                 \n  api_cards_put_item                                           PUT      ANY      ANY    /api/cards/{id}.{_format}                 \n  api_scenarios_get_collection                                 GET      ANY      ANY    /api/scenarios.{_format}                  \n  api_scenarios_post_collection                                POST     ANY      ANY    /api/scenarios.{_format}                  \n  api_scenarios_get_item                                       GET      ANY      ANY    /api/scenarios/{id}.{_format}             \n  api_scenarios_delete_item                                    DELETE   ANY      ANY    /api/scenarios/{id}.{_format}             \n  api_scenarios_put_item                                       PUT      ANY      ANY    /api/scenarios/{id}.{_format}             \n  api_decks_get_collection                                     GET      ANY      ANY    /api/decks.{_format}                      \n  api_decks_post_collection                                    POST     ANY      ANY    /api/decks.{_format}                      \n  api_decks_get_item                                           GET      ANY      ANY    /api/decks/{id}.{_format}                 \n  api_decks_delete_item                                        DELETE   ANY      ANY    /api/decks/{id}.{_format}                 \n  api_decks_put_item                                           PUT      ANY      ANY    /api/decks/{id}.{_format}                 \n  api_scenario_cards_get_collection                            GET      ANY      ANY    /api/scenario_cards.{_format}             \n  api_scenario_cards_post_collection                           POST     ANY      ANY    /api/scenario_cards.{_format}             \n  api_scenario_cards_get_item                                  GET      ANY      ANY    /api/scenario_cards/{id}.{_format}        \n  api_scenario_cards_group_card_info_card_scenario_info_item   GET      ANY      ANY    /api/scenario/{scenario_id}/card/{card_id}\n  _twig_error_test                                             ANY      ANY      ANY    /_error/{code}.{_format}                    \n\n```\nFor the moment I created a Dummy Controller that is just returning the data object without altering him. Is there a particular way to handle this route detection in the controller ? (maybe I miss something in the documentation but I searched it a lot and can't find this information). I think I wasn't clear about what I want to do. I don't want to get a specific Card associated with a ScenarioCard (as if it was a subressource). I want to get the ScenarioCard Data + Card Data using a scenario_id and card_id\nTo contextualize, Card and Scenario are linked By ScenarioCard where each tuple give the next card associated with each choices of a given card for a given Scenario. I could do two api call on my client in order to fetch that information but I don't want to. . I managed to get the data I wanted to using filter. My bad, totally overlooked this part of the documentation. Don't know if it's the right way. By the way, thanks a lot for your help. ",
    "Julobel": "Final solution in our entity:\n@ApiFilter(SearchFilter::class, properties={\"scenario\": \"exact\", \"card\": \"exact\"})\nIndeed, we are not sure that this is the best way to proceed, but we have the information we wanted.\n. ",
    "awesemo": "Issue was caused by the disabled option under \"fos_oauth_server config\"\nuncomment the following;\nauthorize:  false. ",
    "gdalyy": "The issue comes from data volume, my bad :) . Sorry for not explaining well, I know that all endpoints are secured by the firewall and i'm not trying to disable operations, I'm talking about swagger documentation where only operations under /secured for example should have a padlock and not all operations.  . ",
    "christianfriedl": "Here's some additional information I gathered in the meantime:\nThe issue seems to be that in one case, the reference to the dto is missing in the entrypoint json response (i.e., GET localhost:8080/).\n\nSuccessful case:\n\nWith the following api resource configuration:\n```\n/\n * @ApiResource(\n *      collectionOperations={\n *          \"get\",\n *          \"post\"={\n *              \"method\"=\"POST\",\n *              \"route_name\"=\"api_my_fancy_dtos_post_collection\",\n *              \"path\"=\"/my_fancy_dtos\",\n *              \"defaults\"={\"_api_receive\"=false, \"_api_respond\"=true},\n *          }\n *      },\n *      itemOperations={\n *          \"get\"={\n *              \"method\"=\"GET\",\n *              \"route_name\"=\"api_my_fancy_dtos_get_item\",\n *              \"defaults\"={\"_api_receive\"=false, \"_api_respond\"=true},\n \n *          },\n *          \"put\"={\n *              \"method\"=\"PUT\",\n *              \"route_name\"=\"api_my_fancy_dtos_put_item\",\n *              \"defaults\"={\"_api_receive\"=false, \"_api_respond\"=true},\n *          },\n *     }\n * )\n /\nfinal class MyFancyDto {\n    ...\n}\n```\nThis is the result I get:\n{\"@context\":\"\\/contexts\\/Entrypoint\",\"@id\":\"\\/\",\"@type\":\"Entrypoint\",\"myFancyDtos\":\"\\/my_fancy_dtos\"}\n\nProblematic case:\n\nIf I configure the api resource the following way:\n/**\n * @ApiResource(\n *      collectionOperations={\n *          \"get\"={\n *              \"method\"=\"GET\",\n *              \"route_name\"=\"api_my_fancy_dtos_get_collection\",\n *              \"path\"=\"/my_fancy_dtos\",\n *              \"defaults\"={\"_api_receive\"=false, \"_api_respond\"=true},\n *          },\n *          \"post\"={\n *              \"method\"=\"POST\",\n *              \"route_name\"=\"api_my_fancy_dtos_post_collection\",\n *              \"path\"=\"/my_fancy_dtos\",\n *              \"defaults\"={\"_api_receive\"=false, \"_api_respond\"=true},\n *          }\n *      },\n *      itemOperations={\n *          \"get\"={\n *              \"method\"=\"GET\",\n *              \"route_name\"=\"api_my_fancy_dtos_get_item\",\n *              \"defaults\"={\"_api_receive\"=false, \"_api_respond\"=true},\n *\n *          },\n *          \"put\"={\n *              \"method\"=\"PUT\",\n *              \"route_name\"=\"api_my_fancy_dtos_put_item\",\n *              \"defaults\"={\"_api_receive\"=false, \"_api_respond\"=true},\n *          },\n *     }\n * )\n */\nfinal class MyFancyDto {\n    ...\n}\nThis is the result:\n{\"@context\":\"\\/contexts\\/Entrypoint\",\"@id\":\"\\/\",\"@type\":\"Entrypoint\"}\n. ",
    "Cliko": "Thanks for your response. \nBut this command return the same result : \nService 'php' failed to build: failed to reach build target api_platform_php in Dockerfile\nIs it possible that the problem comes from my Docker installation ?. I use the last release version (2.3.4) and i'm on Debian 9. \nI try to create a local version and I don't use a proxy.\nWhen I try docker-compose down -v --rmi all --remove-orphans :+1: \n\nRemoving network apiplatform234_default\nRemoving volume apiplatform234_db-data\nRemoving image quay.io/api-platform/admin\nRemoving image postgres:10-alpine\nRemoving image quay.io/api-platform/client\nRemoving image quay.io/api-platform/php\nERROR: Failed to remove image for service php: 404 Client Error: Not Found (\"No such image: quay.io/api-platform/php:latest\")\nRemoving image quay.io/api-platform/nginx\nERROR: Failed to remove image for service api: 404 Client Error: Not Found (\"No such image: quay.io/api-platform/nginx:latest\")\nRemoving image quay.io/api-platform/varnish\nERROR: Failed to remove image for service cache-proxy: 404 Client Error: Not Found (\"No such image: quay.io/api-platform/varnish:latest\")\nRemoving image apiplatform234_h2-proxy\nERROR: Failed to remove image for service h2-proxy: 404 Client Error: Not Found (\"No such image: apiplatform234_h2-proxy:latest\")\n\n. ",
    "Janak": "Same  case happened on Ubuntu\ndocker-compose up -d\nPulling db (postgres:10-alpine)...\n10-alpine: Pulling from library/postgres\ncd784148e348: Already exists\n67451ade031c: Pull complete\na9990a72e3ae: Pull complete\nafd7f1c75cf9: Pull complete\n708d7481af88: Pull complete\n2fa3627e06f9: Pull complete\nd1bdf7f14050: Pull complete\n314813461935: Pull complete\n88d74fac6218: Pull complete\nDigest: sha256:1bb96e26d1cb23a699951083a16be946275fd005178ca9d62f682f974d45f348\nStatus: Downloaded newer image for postgres:10-alpine\nBuilding php\nStep 1/27 : ARG PHP_VERSION=7.2\nStep 2/27 : ARG NGINX_VERSION=1.15\nStep 3/27 : ARG VARNISH_VERSION=6.0\nStep 4/27 : FROM php:${PHP_VERSION}-fpm-alpine AS api_platform_php\n7.2-fpm-alpine: Pulling from library/php\ncd784148e348: Already exists\nd207535cd57f: Already exists\n1167ab95319c: Already exists\nbff34bff7f50: Already exists\n39491f92b47e: Already exists\n7fc8b2a4aa78: Already exists\nebf34b9a7120: Already exists\nfeaf85939116: Already exists\n97922d1e5c13: Already exists\n2d80873bfa59: Already exists\nb55a0c24ee51: Already exists\nDigest: sha256:bf1752f6ea37f575cb4625d91a75931afa0fe3eaf93551ed1eb8fdd509e0c682\nStatus: Downloaded newer image for php:7.2-fpm-alpine\n ---> 262e46e3d43c\nStep 5/27 : RUN apk add --no-cache      acl         file        gettext         git     ;\n ---> Running in 9bcbed181e8f\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.8/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.8/community/x86_64/APKINDEX.tar.gz\nWARNING: Ignoring http://dl-cdn.alpinelinux.org/alpine/v3.8/main/x86_64/APKINDEX.tar.gz: temporary error (try again later)\nWARNING: Ignoring http://dl-cdn.alpinelinux.org/alpine/v3.8/community/x86_64/APKINDEX.tar.gz: temporary error (try again later)\nERROR: unsatisfiable constraints:\n  acl (missing):\n    required by: world[acl]\n  file (missing):\n    required by: world[file]\n  gettext (missing):\n    required by: world[gettext]\n  git (missing):\n    required by: world[git]\nERROR: Service 'php' failed to build: The command '/bin/sh -c apk add --no-cache        acl         file        gettext         git     ;' returned a non-zero code: 4\n. https://github.com/gliderlabs/docker-alpine/issues/386#issuecomment-437698540\nThis will solve issue. ",
    "spolischook": "I've just tested last version of api platform with brand new Ubuntu 18.04 on DigitalOcean - and it's works fine.. ",
    "luca-nardelli": "Hey, I just found this issue by chance while I was looking for other ways to get typescript interfaces than swagger to typescript.\nI might be able to help with the documentation for the typescript generator. \nIs someone already working on the documentation?. I've opened a PR with a first draft of the page, have a look!. This should probably be closed, right?. ",
    "baudev": "When you say \"are now secured\", you mean that:\n- Swagger requests a token to execute any request (the padlock in the UI is closed) ?\n- That the request answer is the following ?\nJSON\n{\n  \"code\": 401,\n  \"message\": \"JWT Token not found\"\n}\nIf it's the second point, you could modify the secured routes by two different ways:\n- Edit the access_control attribute in app/config/packages/security.yaml  (take a look here)\n- Use annotations as the following one attributes={\"access_control\"=\"is_granted('ROLE_USER')\"} (more here). Indeed, I just find out that the Postgres container should create the DB automatically (link).\nHowever it doesn't for me. I will investigate on it (probably another Docker toolbox bug...).\nI will keep you informed. Meanwhile, I close this PR.. ",
    "elevado": "Hi, \nhere's an example from one of my applications. \naccess_control:\n        - { path: ^/newsletter/optin/(.*), roles: ['IS_AUTHENTICATED_ANONYMOUSLY']}\n        - { path: ^/docs$, roles: ['IS_AUTHENTICATED_ANONYMOUSLY']}\n        - { path: ^/(.*), roles: ['ROLE_ADMIN', 'ROLE_USER']}\nRemove the item \"{ path: ^/api, roles: IS_AUTHENTICATED_FULLY }\". Then you no longer have a double link to Swagger UI. I had the same problem.\n. ",
    "yudhir": "Controller \"api_platform.swagger.action.ui\" does neither exist as service nor as class\nwhen i  chang the location.. ",
    "wimme002": "i think validation is performed on the response of a controller.\nIf you want to validate the data, you have to do it manually in your controller or in a DeserializeListener\n. ",
    "vicdelfant": "It feels kind of weird that validation is done out the output instead of the input, but now that I found https://github.com/api-platform/core/issues/1538 and more specifically https://github.com/api-platform/core/issues/1538#issuecomment-349226305, I think it's best to leave this as-is and stick with the EventListener approach instead of an action.. ",
    "you-ser": "Hi. Try to decorate api_platform.swagger.normalizer.api_gateway service instead of api_platform.swagger.normalizer.documentation.. ",
    "oschwartz": "@you-ser  Thank you . @dunglas PR sent . ",
    "jakobeissler": "That worked!. ",
    "laminois": "I made it worked !\nI had to re-add a setTypeSupport with TypeSupport as argument, so the relation can work.\nSorry to have open an issue for this ^^'. ",
    "RikudouSage": "@antograssiot Is there at least option to fetch all subresources recursively?\nI have a structure of Claim -> Activity -> Invoice (Claim is OneToMany to Activity and Activity is OneToMany to Invoice).\nI basically need to query claims (both GET /claims and GET /claims/{id}) and fetch all related info, e.g. activities and invoices. I really can't find in any documentation how to do this.. ",
    "RiseAndCry": "Also, is there a way to completely get rid of IRI ? i'd prefer the old and tried integer id. I'm not using json-ld either way. . Oh, i figured out the reason for the first one:\nI had to use @ApiFilter(NumericFilter::class, properties={\"id\"}) instead of SearchFilter.\nBut i am still interested in how to get rid of IRI, o ar least how to be able to use \ncompany(id: 1) instead of company(id: \"/api/companies/1\").. ",
    "frey1esm": "Running fine on Mac. Closing issue.. ",
    "Arvi89": "Sorry, by {offers} I mean the id of the entity Offer. I copied from swagger, it should more be like:\n/products/{id}/offers/{id}/comments\nAnd I'd like to be able to get\n/products/{id}/offers/{id} (that should return the same as /offers/{id}). I just realized you actually got it right.\nWhy I do want to retrieve an offer when the url starts with product? Because it makes sense I think, also it's really convenient while developing. Also, if you can get /products/1/offers/2/comments, then it doesn't make send that you can't get /products/1/offers/2.. It does not break restful principle, we should actually have it.\nLike here: https://restfulapi.net/rest-api-design-tutorial-with-example/\n\"Having two links is important as you can provide access to a device specific configuration in more unique manner, and you will have ability to mask some fields (if design require it) which shall not be visible in a secondary collection.\"\nWhy is it useful? So when you look at the link, you instantly know that the offer belongs to that product.. ",
    "mmarynich": "@Cethy Read it, solution is here https://github.com/symfony/symfony/issues/29836. @Cethy I completely agree with you.\n@dunglas What do you think about this ?. I have done a PR\nhttps://github.com/symfony/symfony/pull/29853. ",
    "Cethy": "@mmarynich Thx a lot for the read. :)\nI'll keep explicit configuration for now then (positive priority for custom DataProvider). \nBut I still think API-Platform should be patch to not rely on the magic default sorting mechanism (opposed to explicit priority).. @soyuka After a second inspection, the User entity implements Symfony\\Component\\Security\\Core\\User\\UserInterface and its eraseCredentials method : \nphp\n    public function eraseCredentials()\n    {\n        $this->password = '';\n    }\nSeemed a good idea at the time, but after checking the documentation, looks like I'm in the wrong.\nIt's fixed then, my bad. :). ",
    "mschmie": "Thanks for your Answer. \nI am still wondering how to query the jsonb relations with a custom filter. Because when I am extend my CustomFilter with AbstractContextAwareFilter, I've only got a Doctrine Filter. Not sure, but I think what I need is the possibility to do a native query. Do you have any idea how to do that?. You're right. I ment the ORM Querybuilder which is used by default. \nSo I had to write either a custom DataProvider using DBAL to offer a native SQL Query support or extend DQL for my Query needs? Propably with the DataProvider option I had to implement each built-in Filter (e.g. GroupsFilter, SearchFilter) by myself. Then the DQL solution may be more purposeful. Is there documentation for this? \nAs a reminder, I only want to expose the texts which match the requested language param. \nThe titleText is stored as jsonb object in the db. \nIf I get the whole object anyway, would it make sense to remove the corresponding languages e.g. in a custom serializer or controller?\n{\n \"pageId\": \"10000\",\n \"id\": 22,\n \"code\": \"Dr. Tremaine Kohler\",\n \"titleText\": {\n  \"texts\": {\n      \"de-DE\": \"Titel Text de\",\n      \"en-EN\": \"Title Text en\",\n      \"fr-FR\": \"Titre Texte fr\"\n  }\n }\n}\n. Thanks for your help. At the moment I've solved it via serializer. I'll have to see if there are performance issues on larger queries.. ",
    "mweidt": "I think it's useful to define a default order in case a API caller omits any order parameter. Therefore I defined it like this.\nphp\n/**\n * @ApiResource(\n *     attributes={\n *        \"order\"={\"isbn\": \"ASC\"}\n *     }\n * )\n * @ApiFilter(\n *     OrderFilter::class, properties={\n *        \"isbn\": \"ASC\",\n *        \"title\": \"ASC\"\n *     }\n * )\n *\n * @ORM\\Table(name=\"books\")\n * @ORM\\Entity\n */\nclass Book\n{\n    ...\n}\nRequesting /books?order[isbn]=asc will produce the duplicate order by in SQL ... ORDER BY d0_.isbn ASC, d0_.isbn ASC.\nOf course I could remove the configuration for ApiResource. Then all callers of the API have to provide a order parameter to get an ordered collection.\nBut I think in this case ApiPlatform will also add a default order on the identifier field. So the error will occure if I allow the identifier field as OrderFilter.... What would be the correct solution in your optinion? Apply the default order only if there isn't any order by criteria?\nOr should it be the job of doctrine to omit duplicate order by entries - if someone calls addOrderBy with a field more than once?. Ok - but then it's not possible to request /books?order[isbn]=desc ... \nI also think the solution by merging configurations or current values is not trivial :-(. ",
    "chadhumphrey": "Thanks, that worked! . ",
    "ThomasBerends": "@teohhanhui Unfortunately that would result in about 25-50 requests every time the user opens the page, and then again every time they change one filter setting. That is not an option.. ",
    "mnapoli": "Thanks, then the problem might be on my end. That may be related to Hydra (or JSON-LD) links to sub-entities. I'll investigate and report back here if necessary.\nFYI the routes are /taxes and /taxes/{id}.. ",
    "rubenvdlinde": "\nwould sugest that i'm nor curently on the core master branche, correct?. oke, so i'm a bit at a los how i should get my build on core-master branche trough composer. (sorry not much of coposer genius), I tried composer require api-platform/api-pack:dev-master but that failed wit the following error:\n\n. That did the trick, thanxs!. Good point, I checked that and the NelmioCors that is composed into Api Platform is the newest. According to the composer lock:\nJSON\n\"name\": \"nelmio/cors-bundle\",\n            \"version\": \"1.5.5\",\n            \"source\": {\n                \"type\": \"git\",\n                \"url\": \"https://github.com/nelmio/NelmioCorsBundle.git\",\n                \"reference\": \"adabee944e6fe52ee566caf1770a29355b1e8d83\"\n            },\nAnd the NelmioCors  release chart\nComing to thing of it, I also redid the entire helm install. so a caching issue dosn't make a lot of sence. Solved it, should have been:\ncorsAllowOrigin: ['*'] #to allow all origins instead of corsAllowOrigin: \"*\" #to allow all origins. ",
    "Gulivertx": "Ok, found something, if I removed normalizationContext={\"groups\"={\"patient\"}} and @Groups({\"patient\"}) inside my Patient entity I get a correct return with properties user, createdBy and modifiedBy\njson\n{\n    \"@context\": \"/api/contexts/Patient\",\n    \"@id\": \"/api/patients/2e75a4f4-1cb6-11e9-83ab-4ca03f5a0611\",\n    \"@type\": \"Patient\",\n    \"id\": \"2e75a4f4-1cb6-11e9-83ab-4ca03f5a0611\",\n    ...\n    \"user\": \"/api/users/2e756fde-1cb6-11e9-83ab-4ca03f5a0611\",\n    \"createdBy\": \"/api/users/2e756fde-1cb6-11e9-83ab-4ca03f5a0611\",\n    \"modifiedBy\": \"/api/users/2e756fde-1cb6-11e9-83ab-4ca03f5a0611\",\n    \"created\": \"2019-01-20T14:20:40+01:00\",\n    \"updated\": \"2019-01-20T14:20:40+01:00\",\n    \"contentChanged\": null\n}\nMy only problem is that I would like this properties returning the entity and not the link. It was why I did a group. My problem is not about in which format the response is received but about my entity relations.\nI just want to get the JSON object (LD or not) for my embedded relations and not the IRI.\nTo do that I just used serialisation groups as explain here\nThe point is, if I create my group, only the first relation is serialised as an object and the two next seems to be ignore and disappear in response (I think my problem is only because my three relations point to the same User entity). What is strange for me the example of the response in Swagger doc return the correct response as an example. But unfortunately not the real server response.\nI would like to avoid to do extra call to the API to get the properties \"user\", \"created_by\", \"modified_by\".\nI do not know if it is a bug or something I'm doing wrong, this is my first try with API-Platform.... ",
    "KonstantinCodes": "I experience the same behavior, when there is no data provider defined.. ",
    "zakjakub": "Solved it by PersonStay[] instead of Collection. It's probably better solution, so this issue is irrelevant.. I tried to upgrade to v2.4.0-beta.1 and it looks to be solved here, but I did not find the relevant PR, issue or whatever.\nIt looks that there was some problem with context when deserializing some nested relations.. ",
    "JumpIfBelow": "I see. Is there any plan to fix this behavior? It does not look like a normal way to deserialize.\nI'll post a solution later, using a normalizer (instead of writing all the getters with something I don't want). Internally, it as PersistentCollection in an update. While the ArrayCollection works correctly, this is not the case in an update with the PersistentCollection.\nI made a workaround with a listener, not sure if it really is a good idea but it actually works. It tries to reindex all array with the Collection::getValues().\nHere is how I made it, without any warranty that it will work correctly, for people wanting such a workaround:\n```php\n<?php\nnamespace App\\EventListener\\ApiPlatform;\nuse ApiPlatform\\Core\\EventListener\\EventPriorities;\nuse Doctrine\\Common\\Collections\\Collection;\nuse Symfony\\Component\\EventDispatcher\\EventSubscriberInterface;\nuse Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent;\nuse Symfony\\Component\\HttpKernel\\KernelEvents;\nuse Symfony\\Component\\PropertyAccess\\PropertyAccessorInterface;\nuse Symfony\\Component\\PropertyInfo\\PropertyInfoExtractorInterface;\n/\n * Class PostDeserializeSubscriber is here to fix an API Platform's issue with deserializing collection.\n * As it both denormalize and validate, the offset are wrong in case of an update, leading to bad property path value.\n * @package App\\EventListener\\ApiPlatform\n */\nclass PostDeserializeSubscriber implements EventSubscriberInterface\n{\n    /\n     * @var PropertyInfoExtractorInterface $propertyInfo\n     */\n    private $propertyInfo;\n/**\n * @var PropertyAccessorInterface $propertyAccessor\n */\nprivate $propertyAccessor;\n\n/**\n * @var string[] $processedValues\n */\nprivate $processedValues;\n\npublic function __construct(\n    PropertyInfoExtractorInterface $propertyInfo,\n    PropertyAccessorInterface $propertyAccessor\n) {\n    $this->propertyInfo = $propertyInfo;\n    $this->propertyAccessor = $propertyAccessor;\n    $this->processedValues = [];\n}\n\n/**\n * @inheritdoc\n */\npublic static function getSubscribedEvents()\n{\n    return [\n        KernelEvents::REQUEST => ['reindexCollection', EventPriorities::POST_DESERIALIZE],\n    ];\n}\n\npublic function reindexCollection(GetResponseEvent $event): void\n{\n    $attributes = $event\n        ->getRequest()\n        ->attributes\n    ;\n\n    $data = $attributes->get('data');\n\n    if ($data) {\n        $attributes->set(\n            'data',\n            $this->collectionValues($data)\n        );\n    }\n}\n\nprivate function collectionValues($data)\n{\n    if (is_scalar($data) || $data === null) {\n        return $data;\n    }\n\n    if (is_iterable($data)) {\n        if ($data instanceof Collection) {\n            $temp = $data->getValues();\n            $data->clear();\n\n            foreach ($temp as $key => $value) {\n                $data[$key] = $value;\n            }\n        }\n\n        foreach ($data as $key => $value) {\n            $data[$key] = $this->collectionValues($value);\n        }\n    } else if (is_object($data)) {\n        $hash = spl_object_hash($data);\n\n        if (in_array($hash, $this->processedValues)) {\n            return $data;\n        }\n\n        $this->processedValues[] = $hash;\n\n        $properties = $this\n            ->propertyInfo\n            ->getProperties($data)\n        ;\n\n        foreach ($properties as $property) {\n            if (!$this->propertyAccessor->isReadable($data, $property)\n                || !$this->propertyAccessor->isWritable($data, $property)\n            ) {\n                continue;\n            }\n\n            $propertyValue = $this\n                ->propertyAccessor\n                ->getValue($data, $property)\n            ;\n\n            if (is_iterable($propertyValue)) {\n                $this\n                    ->propertyAccessor\n                    ->setValue(\n                        $data,\n                        $property,\n                        $this->collectionValues($propertyValue)\n                    )\n                ;\n            }\n        }\n    }\n\n    return $data;\n}\n\n}\n```\n. ",
    "kreciszd": "After upgrade it works. ",
    "ismail1432": "There is the mapping\njson\n{\n    \"edenred_admin\": {\n        \"mappings\": {\n            \"_doc\": {\n                \"properties\": {\n                    \"admin\": {\n                        \"type\": \"boolean\"\n                    },\n                    \"created_at\": {\n                        \"type\": \"date\",\n                        \"format\": \"yyyy-MM-dd HH:mm:ss\"\n                    },\n                    \"enabled\": {\n                        \"type\": \"boolean\"\n                    },\n                    \"full_name\": {\n                        \"type\": \"text\",\n                        \"fielddata\": true\n                    },\n                    \"plain_password\": {\n                        \"type\": \"text\",\n                        \"fields\": {\n                            \"keyword\": {\n                                \"type\": \"keyword\",\n                                \"ignore_above\": 256\n                            }\n                        }\n                    },\n                    \"profile\": {\n                        \"type\": \"text\",\n                        \"fields\": {\n                            \"keyword\": {\n                                \"type\": \"keyword\",\n                                \"ignore_above\": 256\n                            }\n                        }\n                    },\n                    \"roles\": {\n                        \"type\": \"text\",\n                        \"fields\": {\n                            \"keyword\": {\n                                \"type\": \"keyword\",\n                                \"ignore_above\": 256\n                            }\n                        }\n                    },\n                    \"sedentary_edenred_admin\": {\n                        \"type\": \"boolean\"\n                    },\n                    \"site\": {\n                        \"type\": \"text\",\n                        \"fields\": {\n                            \"keyword\": {\n                                \"type\": \"keyword\",\n                                \"ignore_above\": 256\n                            }\n                        }\n                    },\n                    \"store\": {\n                        \"type\": \"text\",\n                        \"fields\": {\n                            \"keyword\": {\n                                \"type\": \"keyword\",\n                                \"ignore_above\": 256\n                            }\n                        }\n                    },\n                    \"username\": {\n                        \"type\": \"text\",\n                        \"fields\": {\n                            \"keyword\": {\n                                \"type\": \"keyword\",\n                                \"ignore_above\": 256\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\nAnd I PUT http://localhost:9200/edenred_admin/_doc/00000000-0000-0000-0000-000000000001\n{\n     \"full_name\": \"Lucky\",\n      \"username\": \"jdoe\",\n      \"site\": \"/sites/f45b3272-122a-4e29-a257-65c6d22829cd\",\n      \"plain_password\": \"Passw0rd!\",\n      \"admin\": false,\n      \"sedentary_edenred_admin\": false,\n      \"enabled\": true,\n      \"uuid\": \"00000000-0000-0000-0000-000000000001\",\n      \"roles\": [\"ROLE_CE_LISTE_UPDATE\", \"ROLE_ONGLET_PARAMETRES_AVANCES_UPDATE\"],\n      \"store\": \"/stores/00000000-0000-0000-0000-000000000001\",\n      \"created_at\": \"2017-03-03 03:03:03\",\n      \"id\": 1\n}\nThe error occurs when I Get on api/edenred_admin \nThanks\n. To avoid the issue I had this in service.yaml with a priority higher than api_platform.elasticsearch.normalizer.item\ndatetime_normalizer:\n        class: Symfony\\Component\\Serializer\\Normalizer\\DateTimeNormalizer\n        public: false\n        tags:\n            - { name: serializer.normalizer, priority: 9 }. Sorry I missed that.. ",
    "kiler129": "From preliminary debugging it seems like the intention was that all related paths ($location->links here) will be marked with @ApiSubresource. While doing this allows expected requests in REST (/location/some_uuid/links) leading to proper results it does nothing for GraphQL.\nThis fragment seems to be responsible:\nphp\n            if (isset($rootClass, $source[$rootProperty = $info->fieldName], $source[ItemNormalizer::ITEM_KEY])) {\n                $rootResolvedFields = $this->identifiersExtractor->getIdentifiersFromItem(unserialize($source[ItemNormalizer::ITEM_KEY]));\n                $subresource = $this->getSubresource($rootClass, $rootResolvedFields, array_keys($rootResolvedFields), $rootProperty, $resourceClass, true, $dataProviderContext);\n                $collection = $subresource ?? [];\n            } else {\n                $collection = $this->collectionDataProvider->getCollection($resourceClass, null, $dataProviderContext);\n            }\nThe second path leads to whole collection access without WHERE. Intuitively looking the first path should lead to subresource query, but it does not since the last part of isset() ($source[ItemNormalizer::ITEM_KEY] -> $source['#item']) is never there.\n@alanpoulain: Maybe you can give me some clue in debugging this?. Ok, that was a PEBKAC. This came from the normalizers priority and the fact my custom normalizer was called before GraphQL one and the custom one was composing api_platform.serializer.normalizer.item instead of api_platform.graphql.normalizer.item. ",
    "Eydamos": "I'm still on version 2.3.6 as the 2.4 is only marked as beta. So I will just have to wait for a stable version.\nThanks. ",
    "egorzot": "\nHave you installed the distribution?\n\nYes , I installed it via symfony flex (api-pack package). \nIn my composer.json:\n\"api-platform/api-pack\": \"^1.1\"\nAnd screenshot of packages installed in vendor folder.\nTried to run docker-compose from project root.. I tried to install but got an error\napi-platform/api-platform v2.1.6 requires sensio/framework-extra-bundle ^3.0.2\nHow about to update this package dependencies? Last release is 5.2.4 version.. Thanks guys!. ",
    "luigimassa": "Ops.\nThanks\nIl ven 22 feb 2019, 07:07 K\u00e9vin Dunglas notifications@github.com ha\nscritto:\n\nThe error message is explicit: \u201cThe constraint \"App\\Constraints\\Owner\"\ncannot be put on classes in\u201d. Your constraint can only be put on\nproperties, not on a class.\nSee\nhttps://symfony.com/doc/current/validation/custom_constraint.html#class-constraint-validator\nif you want to be able to use this constraint on a class.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/api-platform/api-platform/issues/1010#issuecomment-466285184,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AALYvAADWlBcAgrBoMHNsiTtBd_OhPq3ks5vP4k6gaJpZM4bIcle\n.\n\n\n--\nBWLab, lab web for business\nbwlab.it http://www.bwlab.it/\u00a0-\u00a0\ntwitter https://twitter.com/#%21/businessweblab\u00a0-\u00a0G+ \nhttps://plus.google.com/116583587937573082395/posts\n--\nI contenuti di \nquesta email appartengono alla nostra azienda.\u00a0Questi contenuti sono \nconfidenziali e riservati ai soli destinatari del\u00a0messaggio. Nessun altro \nha l'autorizzazione a copiarla o inoltrarla\u00a0in tutto o in parte in \nqualsiasi forma.\u00a0Se ricevete questa email per\u00a0errore per favore chiamate il \nnumero\u00a0(+39)\u00a0 http://goog_161445444/3338829961 \nhttp://tel+393338829961/.\n. ",
    "wizbit": "Try\nyaml\n    foobar:\n      method: 'PUT'\n      path: '/foo/{id}/bar'\n      controller: 'App\\Controller\\FooController'\n      openapi_context:\n        summary: Something\n          -\n             in: body\n             schema:\n               type: object\n               properties:\n                   user:\n                      type: object\n                      properties:\n                          firstname: {type: string, example: 'john', required: true}\n                          lastname:  {type: string, example: 'doe', required: true}\n                          country:   {type: string, example: 'FR'}\nhttps://swagger.io/docs/specification/describing-parameters/. ",
    "osamaarefm": "```\n    /\n     * Set countryOfNationality\n     \n     * @param Country $countryOfNationality\n     * @return Person\n     /\n    public function setCountryOfNationality(Country $countryOfNationality): self\n    {\n        $this->countryOfNationality = $countryOfNationality;\n    return $this;\n}\n\n```\nBut I noticed that when using PUT, the request doesn't even reach to the setter. API platform returns the error before the setter is called.. ",
    "abengtson": "I have the exact same issue when using a custom data provider.  It will only return my normalization context group and not my denormalization context group.  I feel this may be a bug.. @soyuka Ignore this, I'm for some reason was confusing PUT with GET.  Mistake on my part on thinking how it was supposed to work.  Thanks for the response though!. @teohhanhui Thanks for responding.  There isn't much more to it, then the entity itself.\n```\nnamespace App\\Entity;\nuse ApiPlatform\\Core\\Annotation\\ApiProperty;\nuse App\\Entity\\Constants\\Status;\nuse App\\Validator\\Constraints as AgentAssert;\nuse Symfony\\Component\\Serializer\\Annotation\\Groups;\nuse Symfony\\Component\\Validator\\Constraints as Assert;\n/\n * This is the ArcSync Agent Endpoint\n */\nclass Agent\n{\n    /\n     * @var string The Agent NAA Number/ID\n     * @ApiProperty(identifier=true)\n     \n     * @Assert\\NotBlank(groups={\"postValidation\"})\n     * @AgentAssert\\IsAgentId\n     /\n    public $agent_id;\n/**\n * @var ClientPolicy[]\n *\n * @Groups(\"clientInformationResults\")\n */\npublic $clientInformation;\n\n}\n```\nShould this work automatically giving the controller the Agent object just like it does for the post?  I am not entirely sure what \"Not Found\" actually means as well. I had this working when I was using a custom data provider and persister but I figured this should work by default.. I tried with camel-case just to see but not luck.  Unfortunately snake case was used when the project was created I believe for more obvious mapping to the for the 3rd parties posting to the api.. @teohhanhui sorry, I am still newer to symfony forgot about the profiler.  Here are some screen shots, I think it all looks good until it check the $data being null.  I am not sure when or where the data gets lost or doesn't get created.\n\n\n\n. \n. @teohhanhui The one thing I noticed when tracing through the code, the identifier get passed through the whole way down but it fails to get the ManagerRegistry for my Agent Entity when it calls the supports method.  Is there something more I need to set up on my Agent Entity that I am missing? \n```\nnamespace ApiPlatform\\Core\\Bridge\\Doctrine\\Orm;\nuse ApiPlatform\\Core\\Bridge\\Doctrine\\Orm\\Extension\\QueryItemExtensionInterface;\nuse ApiPlatform\\Core\\Bridge\\Doctrine\\Orm\\Extension\\QueryResultItemExtensionInterface;\nuse ApiPlatform\\Core\\Bridge\\Doctrine\\Orm\\Util\\IdentifierManagerTrait;\nuse ApiPlatform\\Core\\Bridge\\Doctrine\\Orm\\Util\\QueryNameGenerator;\nuse ApiPlatform\\Core\\DataProvider\\DenormalizedIdentifiersAwareItemDataProviderInterface;\nuse ApiPlatform\\Core\\DataProvider\\RestrictedDataProviderInterface;\nuse ApiPlatform\\Core\\Exception\\RuntimeException;\nuse ApiPlatform\\Core\\Identifier\\IdentifierConverterInterface;\nuse ApiPlatform\\Core\\Metadata\\Property\\Factory\\PropertyMetadataFactoryInterface;\nuse ApiPlatform\\Core\\Metadata\\Property\\Factory\\PropertyNameCollectionFactoryInterface;\nuse Doctrine\\Common\\Persistence\\ManagerRegistry;\nuse Doctrine\\Common\\Persistence\\Mapping\\ClassMetadata;\nuse Doctrine\\ORM\\EntityManagerInterface;\nuse Doctrine\\ORM\\QueryBuilder;\n/\n * Item data provider for the Doctrine ORM.\n \n * @author K\u00e9vin Dunglas dunglas@gmail.com\n * @author Samuel ROZE samuel.roze@gmail.com\n * @final\n /\nclass ItemDataProvider implements DenormalizedIdentifiersAwareItemDataProviderInterface, RestrictedDataProviderInterface\n{\n    use IdentifierManagerTrait;\nprivate $managerRegistry;\nprivate $itemExtensions;\n\n/**\n * @param QueryItemExtensionInterface[] $itemExtensions\n */\npublic function __construct(ManagerRegistry $managerRegistry, PropertyNameCollectionFactoryInterface $propertyNameCollectionFactory, PropertyMetadataFactoryInterface $propertyMetadataFactory, /* iterable */ $itemExtensions = [])\n{\n    $this->managerRegistry = $managerRegistry;\n    $this->propertyNameCollectionFactory = $propertyNameCollectionFactory;\n    $this->propertyMetadataFactory = $propertyMetadataFactory;\n    $this->itemExtensions = $itemExtensions;\n}\n\npublic function supports(string $resourceClass, string $operationName = null, array $context = []): bool\n{\n    return null !== $this->managerRegistry->getManagerForClass($resourceClass);\n}\n\n```. I dont have any mappings, I am running Sql queries.  This api needs to hit quite a few different places so no one entity maps to a single DB.. I am really just using the Entity for validation and the api endpoints.  Okay cool. it does explain why I had it working with the data persister and provider, but was really hoping for some magic.  Still new to symfony  and api platform.\nTHanks for the help!\n. ",
    "hubbyist": "It seems that when variable names converted to CamelCase it solves this issue. So closing this issue as a non issue. But may be snake case support for entity mapping is a necessary feature.. You can use code ```  markup. \n```\nYour code here\n```.\n",
    "Belssem": "I have the same problem did you find a solution ?? . how can i install it plz? . This is what my composer.json file looks like : \n{\n    \"type\": \"project\",\n    \"license\": \"proprietary\",\n    \"require\": {\n        \"php\": \"^7.1.3\",\n        \"ext-ctype\": \"\",\n        \"ext-iconv\": \"\",\n        \"alcaeus/mongo-php-adapter\": \"^1.1\",\n        \"api-platform/api-pack\": \"^1.2\",\n        \"doctrine/mongodb-odm-bundle\": \"^3.5\",\n        \"doesntmattr/mongodb-migrations-bundle\": \"^2.0\",\n        \"mongodb/mongodb\": \"^1.4\",\n        \"sensio/framework-extra-bundle\": \"^5.2\",\n        \"symfony/asset\": \"4.2.\",\n        \"symfony/console\": \"4.2.\",\n        \"symfony/dotenv\": \"4.2.\",\n        \"symfony/expression-language\": \"4.2.\",\n        \"symfony/flex\": \"^1.1\",\n        \"symfony/form\": \"4.2.\",\n        \"symfony/framework-bundle\": \"4.2.\",\n        \"symfony/monolog-bundle\": \"^3.1\",\n        \"symfony/orm-pack\": \"\",\n        \"symfony/process\": \"4.2.\",\n        \"symfony/security-bundle\": \"4.2.\",\n        \"symfony/serializer-pack\": \"\",\n        \"symfony/swiftmailer-bundle\": \"^3.1\",\n        \"symfony/translation\": \"4.2.\",\n        \"symfony/twig-bundle\": \"4.2.\",\n        \"symfony/validator\": \"4.2.\",\n        \"symfony/web-link\": \"4.2.\",\n        \"symfony/yaml\": \"4.2.\"\n    },\n    \"require-dev\": {\n        \"symfony/debug-pack\": \"\",\n        \"symfony/maker-bundle\": \"^1.0\",\n        \"symfony/profiler-pack\": \"\",\n        \"symfony/test-pack\": \"\",\n        \"symfony/web-server-bundle\": \"4.2.\"\n    },\n    \"config\": {\n        \"preferred-install\": {\n            \"\": \"dist\"\n        },\n        \"sort-packages\": true,\n        \"platform\": {\n            \"ext-mongo\": \"1.6.16\"\n        }\n    },\n    \"autoload\": {\n        \"psr-4\": {\n            \"App\\\": \"src/\"\n        }\n    },\n    \"autoload-dev\": {\n        \"psr-4\": {\n            \"App\\Tests\\\": \"tests/\"\n        }\n    },\n    \"replace\": {\n        \"paragonie/random_compat\": \"2.\",\n        \"symfony/polyfill-ctype\": \"\",\n        \"symfony/polyfill-iconv\": \"\",\n        \"symfony/polyfill-php71\": \"\",\n        \"symfony/polyfill-php70\": \"\",\n        \"symfony/polyfill-php56\": \"\"\n    },\n    \"scripts\": {\n        \"auto-scripts\": {\n            \"cache:clear\": \"symfony-cmd\",\n            \"assets:install %PUBLIC_DIR%\": \"symfony-cmd\"\n        },\n        \"post-install-cmd\": [\n            \"@auto-scripts\"\n        ],\n        \"post-update-cmd\": [\n            \"@auto-scripts\"\n        ]\n    },\n    \"conflict\": {\n        \"symfony/symfony\": \"\"\n    },\n    \"extra\": {\n        \"symfony\": {\n            \"allow-contrib\": false,\n            \"require\": \"4.2.\"\n        }\n    }\n}\nshould i just modify it by adding  \"api-platform/api-pack\": \"^2.4@beta\", in requires ?? and then i update the composer ? . this is the content of \"config/packages/api_platform.yaml\"\napi_platform:\n    mapping:\n        paths: ['%kernel.project_dir%/src/Entity','%kernel.project_dir%/src/Document']\nand this is again the composer.json file content : \n{\n    \"type\": \"project\",\n    \"license\": \"proprietary\",\n    \"require\": {\n        \"php\": \"^7.1.3\",\n        \"ext-ctype\": \"\",\n        \"ext-iconv\": \"\",\n        \"alcaeus/mongo-php-adapter\": \"^1.1\",\n        \"api-platform/api-pack\": \"^1.2\",\n        \"doctrine/mongodb-odm-bundle\": \"^3.5\",\n        \"lexik/jwt-authentication-bundle\": \"^2.6\",\n        \"sensio/framework-extra-bundle\": \"^5.2\",\n        \"symfony-bundles/odm-fixtures-bundle\": \"^0.5.3\",\n        \"symfony/asset\": \"4.2.\",\n        \"symfony/console\": \"4.2.\",\n        \"symfony/dotenv\": \"4.2.\",\n        \"symfony/expression-language\": \"4.2.\",\n        \"symfony/flex\": \"^1.1\",\n        \"symfony/form\": \"4.2.\",\n        \"symfony/framework-bundle\": \"4.2.\",\n        \"symfony/monolog-bundle\": \"^3.1\",\n        \"symfony/orm-pack\": \"\",\n        \"symfony/process\": \"4.2.\",\n        \"symfony/security-bundle\": \"4.2.\",\n        \"symfony/serializer-pack\": \"\",\n        \"symfony/swiftmailer-bundle\": \"^3.1\",\n        \"symfony/translation\": \"4.2.\",\n        \"symfony/twig-bundle\": \"4.2.\",\n        \"symfony/validator\": \"4.2.\",\n        \"symfony/web-link\": \"4.2.\",\n        \"symfony/yaml\": \"4.2.\"\n    },\n    \"require-dev\": {\n        \"doctrine/doctrine-fixtures-bundle\": \"^3.1\",\n        \"fzaninotto/faker\": \"^1.8\",\n        \"symfony/debug-pack\": \"\",\n        \"symfony/maker-bundle\": \"^1.0\",\n        \"symfony/profiler-pack\": \"\",\n        \"symfony/test-pack\": \"\",\n        \"symfony/web-server-bundle\": \"4.2.\"\n    },\n    \"config\": {\n        \"preferred-install\": {\n            \"\": \"dist\"\n        },\n        \"sort-packages\": true,\n        \"platform\": {\n            \"ext-mongo\": \"1.6.16\"\n        }\n    },\n    \"autoload\": {\n        \"psr-4\": {\n            \"App\\\": \"src/\"\n        }\n    },\n    \"autoload-dev\": {\n        \"psr-4\": {\n            \"App\\Tests\\\": \"tests/\"\n        }\n    },\n    \"replace\": {\n        \"paragonie/random_compat\": \"2.\",\n        \"symfony/polyfill-ctype\": \"\",\n        \"symfony/polyfill-iconv\": \"\",\n        \"symfony/polyfill-php71\": \"\",\n        \"symfony/polyfill-php70\": \"\",\n        \"symfony/polyfill-php56\": \"\"\n    },\n    \"scripts\": {\n        \"auto-scripts\": {\n            \"cache:clear\": \"symfony-cmd\",\n            \"assets:install %PUBLIC_DIR%\": \"symfony-cmd\"\n        },\n        \"post-install-cmd\": [\n            \"@auto-scripts\"\n        ],\n        \"post-update-cmd\": [\n            \"@auto-scripts\"\n        ]\n    },\n    \"conflict\": {\n        \"symfony/symfony\": \"\"\n    },\n    \"extra\": {\n        \"symfony\": {\n            \"allow-contrib\": false,\n            \"require\": \"4.2.\"\n        }\n    }\n}\n. how can i install the version 2.4 beta of the api platform ?? \n. @dunglas  i will download it now , i hope will works this time . @dunglas  Thank you it works now  :D . ",
    "worthwhileindustries": "@teohhanhui I can't do the reverse with this method but, I think this is a workaround for the desired results. I only get CatalogRecords that have matching CatalogItems. I made a new filter with...\n$associationAlias = QueryBuilderHelper::addJoinOnce($queryBuilder, $queryNameGenerator, $alias, $association, Join::INNER_JOIN);\nI have limited experience with the platform. If I think of something I'll be happy to reply back. Thanks. ",
    "Maxell92": "Seems this is same issue: https://github.com/api-platform/api-platform/issues/836. ",
    "phryneas": "PS: adding *     shortName=\"Languages\" resolves the naming problem, but makes the routes overlay each other, so that's no real solution either. Whoa, that was fast! I'll give this a test the first thing tomorrow morning! Thank you!. ",
    "gavinlove": "You can increase the max header size in varnish.\nhttps://varnish-cache.org/docs/4.1/reference/varnishd.html#http-req-hdr-len\nhttps://varnish-cache.org/docs/4.1/reference/varnishd.html#http-max-hdr\n. ",
    "AbdelilahJbr": "\nAre you using the beta version of API Platform? You need to use it if you want the MongoDB support.\n\n@alanpoulain I'm using doctrine mysql and I also got this problem Variable \"showWebby\" does not exist. ",
    "andytson-inviqa": "Looking at CORSListener, this looks difficult with it setting the response.. I'm afraid it doesn't even get to that point, instead the \"Unable to retrieve API documentation.\" error appears before react-admin is loaded. Ok I figured it out, my 403 responses weren't returning JSON, so it was more of a parse error.\nThere is certainly still the issue of resource properties not being loaded ready for HydraAdmin generated Lists so the ticket is still relevant, but I can reword it a bit, and it doesn't block me I think as I use react-admin directly rather than using the auto-generated HydraAdmin.. Ok, a different effect of this issue happens if ALL api resources are not authorized to be accessible (such as prior to login), causing the same issue I saw before, the react-admin Admin component not being rendered, and an error message instead.\nThis will at least be mitigated for me by being able to define auth resources that don't require authentication.. ",
    "bjrbhre": "@andytson-inviqa I was also looking at the same issue. Until you have a way to filter based on roles, you can at least avoid being redirected on login by removing the check on 403\n```\n// in src/authClient.js\nimport { AUTH_LOGIN, AUTH_LOGOUT, AUTH_ERROR } from 'admin-on-rest';\nexport default (type, params) => {\n    if (type === AUTH_LOGIN) {\n        // ...\n    }\n    if (type === AUTH_LOGOUT) {\n        // ...\n    }\n    if (type === AUTH_ERROR) {\n        const status  = params.message.status;\n        if (status === 401 || status === 403) {\n            localStorage.removeItem('token');\n            return Promise.reject();\n        }\n        return Promise.resolve();\n    }\n    return Promise.resolve();\n};\n```\nReplace \nif (status === 401 || status === 403) \nby\nif (status === 401)\nYou will simply be displayed an error + blank page\n\nYou might also want to have a look at a similar issue \"Dynamic context builder for /docs.jsonld endpoint #866\". You can have a look at ~https://github.com/bjrbhre/api-platform/tree/5574d53247935b26db863c68c088ab600594a9f3~ https://github.com/bjrbhre/api-platform/tree/232dacae2c625f0ee81400b67e30697b0d7c5f10 which shall be approx. at the same stage. When you inspect the network requests, can you spot which ones are failing?. ",
    "Nitneuk": "I though XML and CSV were supported, I'll fix other issues\n. ",
    "stof": "Why not doing the yarn install in /usr/src/admin directly rather than doing it in tmp and then moving it later ?. if it is a template, shouldn't it be .env.dist ?. is it actually proprietary ? This looks weird to me. you could build them in the right folder and still use the Docker cache (you would even make the cache more efficient as you will avoid the layer moving files around)\nI'm not asking you to stop install deps before adding the project code. I'm asking you to add the package.json and yarn.lock files directly in /usr/src/admin and do the install there, removing the need to move files around. ",
    "fabpot": "done. ",
    "Fabious": "Do we keep this ? it's added since create-react-app v2. "
}