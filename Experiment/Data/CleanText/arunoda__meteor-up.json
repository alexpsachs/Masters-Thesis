{
    "madushan1000": "closed by https://github.com/kadirahq/meteor-up/pull/26\n. I fixed some test script bugs. Now it should work\n. closed by https://github.com/kadirahq/meteor-up/pull/27\n. No, We currently use a default mongodb config file. PRs are welcome :)\n. It should work fine with external mongo installation. as @wizonesolutions said mup just passes the env vars in.\n. Just setup a mongodb docker container yourself with your own config. Then pass the URL to meteor app.\n. You can publish the mongo port to the localhost and pass it as the MONGO_URL from settings. If you have to link, you are going to have to modify the mup source.\n. Updated mongodb tests\n. added tests\n. @artpolikarpov's PR (https://github.com/arunoda/meteor-up/pull/788) on old mupx was very useful here.\n. updated with the test\n. Knoladge with babel won't be an issue since we are hoping to ship a compiled code in the future. It seems like this is caused by npm install -g not properly linking the binary. I'll try to find what is the exact cause. For now, try this to get it working. (do npm remove -g if you have already installed)\nbash\nnpm install\nnpm link\n. I hope this is resolved now? I'm closing this issue, feel free to reopen if not.\n. We are hoping to ship transpiled version of code in a few days.\n. We are hoping to add some mongo config options like oplog and replicaset name. That's why the config file is still there. I'll try to reporduce the other issue. \n. @timothyarmes This should be fixed by https://github.com/kadirahq/meteor-up/pull/41, Can you check?\n. closed by https://github.com/kadirahq/meteor-up/pull/41\n. Note the mup.js format is changed a bit.\n``` javascript\nmodule.exports = {\n  servers: {\n    one: {\n      host: '0.0.0.0',\n      user: 'root'\n    }\n  },\nmeteor: {\n    name: 'app',\n    path: './app',\n    servers: {\n      one: {}, two: {}, three: {}\n    },\n    env: {\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n  },\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n  setupMongo: 1,\n  deployCheckWaitTime: 20\n};\n``\n. We can check formodule.exports.mongobut what if someone needs to turn off mongo setup temporarily, but keep their mongo settings?\nI think havingdeployCheckWaitTimeundermeteoris a little confusing, that's why I moved it to the project scope. We can move it back if you think it doesn't make sense.\n. It seems like your app is properly starting but mup sends a timeout error because it takes more time to start web interface thandeployCheckWaitTime. Try increasing it. (Checkout the code from this PR https://github.com/kadirahq/meteor-up/pull/41)\nNote, themup.js` format has changed a bit.\n``` javascript\nmodule.exports = {\n  servers: {\n    one: {\n      host: '0.0.0.0',\n      user: 'root'\n    }\n  },\nmeteor: {\n    name: 'app',\n    path: './app',\n    servers: {\n      one: {}, two: {}, three: {}\n    },\n    env: {\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n    deployCheckWaitTime: 60\n  },\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n``\n. @mzygmunt Can you post your mup.js file here? Take a look at the referance again, I changed it a bit again.\n. Meteor Up currently only supports deploy to Ubuntu 14.04 LTS servers. If you have that ubuntu version on your hardware, you'll definatly be able to deploy. And this repo is the devellopment version of meteor-up (not usable yet) you should probably post your issues at  the stable repo (https://github.com/arunoda/meteor-up)\n. We use nodejspathmodule to resolve relative paths, and it doesn't support~`(~ is not a unix standard, It's just used by bash originated shells). Take a look at these two issues in nodejs https://github.com/nodejs/node-v0.x-archive/issues/2857 https://github.com/nodejs/node/issues/684. If someone can add this to mup using a third party library, pull requests are welcome.\nPS: Mup works  with relative paths like ../../yourkey fine. \n. Seems like you don't have the meteor binary in your path. Check if it is. \nIn the other case,  development version of Meteor Up supports custom docker images. It's not even in alpha release right now, use it at your own risk. \n. I'm not sure, normally (on OSX) meteor binary should be in /user/local/bin/meteor so /usr/local/bin should be in path. Depending on how you installed meteor, the binary might be somewhere else. You can try defining the meteor executable explicitly in mup.js file like this\n``` javascript\nmodules.exports = {\n...\n  meteor: {\n    ...\n    buildOptions: {\n        ...\n        executable: '',\n        ...\n      }\n    ...\n  }\n...\n}\n```\nError: spawn meteor ENOENT is normally returned by spawn when it couldn't find the binary it's supposed to run. \nAnd as you suggested mup.js file should not be in the project directory. For now move it to a hidden directory like .deploy/mup.js. We'll try to address this issue in the future.\n. Checkout the setupmongo-fix branch. It'll be merged to master after some tests. This is a duplicate of issue https://github.com/kadirahq/meteor-up/issues/37\n. closed by https://github.com/kadirahq/meteor-up/pull/41\n. This is a duplicate of issue https://github.com/kadirahq/meteor-up/issues/34, addressed by PR https://github.com/kadirahq/meteor-up/pull/41\n. Sorry I can't understand the issue, Can you be a little more clear?\n. It will be implemented in the first release. \n. create a .deploy folder at the root of your meteor project directory(meteor doesn't read from hidden folders), Or create it somewhere else outside your meteor project tree. Otherwise mup.js will create issues because meteor try to read it. This is just a temporary precaution. We will fix it eventually.\nAdditionally, a mup project only have your deploy configurations(mup.js and settings.json). Don't confuse it with meteor project (Which is your javascript/etc... code)\n. You can use a separate mongodb installation by setting MONGODB_URL (This is the recomanded way by the way)\n. This is probably related to issue https://github.com/kadirahq/meteor-up/issues/49\n. Seems like a missing SSH key/password or something. Can you post your mup.js file here?\n. can you try adding this under sshOptsions\njavascript\n{ \n  'StrictHostKeyChecking': 'no', \n  'UserKnownHostsFile': '/dev/null',\n  'ConnectTimeout': '60'\n}\nalso check if your VM has internet connection.\n. The\njson\n...\npassword: 'password'\n...\nshould be \njson\n...\npass: 'password'\n...\nThis should be fixed in the readme. I'll add a fix so it works for both pass and password. Thank you for the help\n. Do you have meteor binary in your path?\n. Do you have meteor binary in the PATH of your build machine? \n. wherever you are running mup. \n. Changed \n. yup, you're right.\n. You can assign a custom port for meteor app by adding a port field under meteor config. We are planning to add Nginx proxy suppot built in to mup but It'll take some time.\n. It should check for the correct port, Can try adding a deployCheckWaitTime field under meteor config for me? See this comment https://github.com/kadirahq/meteor-up/issues/38#issuecomment-174409669\n. @THPubs @dufia  I'll take a look at it and try to figure out what's causing it. BTW We do not advice to use MongoDB setup comes with mup. It's only intended for testing or aery small apps. For a production app, we recommend setting up a MongoDB replicaset on different hosts or somewhere like compose.io and set MONGO_URL in meteor.env.\n. I'm not recommending this in a production environment, but you can set up mongo in the first meteor deployment and remove all of the mongo config and just set the meteor.env.MONGO_URL to mongodb://localhost/yourdbname in the second app. \nCan you post the error if this setup is giving any errors?\n. Old mup should work. Actually, we are not doing anything meteor version specific inside mup. We just use meteor build command with platform specific flags. \nThe method I posted above should not work actually. We use docker link internally to link mongo container to meteord container. There are some things you can do listed here. \nBut this means you have to alter options to meteor docker container.\nSince this is not a priority for us(most users use external dbs) I'll take some time to implement. \nBut if someone can send a PR with proper testing, We can accept it.\nPS: I found the problem with failing deployment verification(I was not taking the meteor port from proper place). I'll add a fix soon. \n. @dufia Yeah, The mongo setup comes with mup is not meant to be used in production, Let alone two app sharing it(never host your web app and db in the same place, If one goes down, there is a high probability the other will too)\nTo answer your other question, You would be able to access it trough a public IP(or if you are in a private LAN, private IP) if you configure your firewall to expose the MongoDB port to outside (This is a bad idea, since mup's MongoDB installation doesn't setup any authentication at all, the whole world will be able to access it)\n. Yeah, This is because the way docker works. Unless you've linked your mongo container to meteor container, When you refer as localhost, you actually mean docker containers local address. not the docker host's one. BTW even if you want to use a mongo instance on localhost, set it up separately with a username and password and then set  MONGO_URL. mup's one is insecure.\n. Yes, The mongo installation mup setup is just a basic one. It's not meant to be used in production at all. Setup your own mongo and use MONG_URL env var instead.\n. both of the mongodb:// ones are okay.\n. That error has nothing to do with mongo. It's mup saying it can't connect to your server. I'm not sure why.\n. I'm not exactly sure why, Can you post you mup.js file here(remove any passwords and stuff)? I'll take a look.\n. This is the same thing, Just a refatored/moduler version. And this is still in development.\n. Yeah, We are planning port all of the mupx features to this version. We are mostly done. Only a few thing  left. Community help is verry well appriciated :)\n. @MasterJames You can send a PR to this repo. It's currently stable enough for anyone to develop against. No major design changes will happen (hopefully).\n@carlosbaraza Sorry for the inconvenience. We started developing this repo specifically because It was very hard to accept PR's into old repo due to the lack of integration testing. We updated the README of the old repo. Thank you.\n. No, this is the development version. For production, Use mupx. \n. The proposal looks good,\nLet's encrypt apache/Nginx modules seems to be able to do the certificate renewal without stopping/disturbing the server (I haven't tested it though). If we can use Nginx module it's better. But it's still in alpha AFAIK(again I haven't tested how well it works). \nIn the PR you mentioned, I can see that auto renewal is not yet working. If we can make this work with webroot, or the Nginx module(when it's production ready) with auto renewal It's great. \n. @tomasz-nolberczak Hi, we were waiting on nginx let's encrypt module to become stable. @carlosbaraza was using the webroot method to get the certificate as I can recall. Since the nginx module seems to be taking more time, We can start working on a lib/modules/ssl module using the webroot method for now\nWe can't use standalone method because the productions server must have to be stopped for each certificate renewal. and even getting the webroot method working would be somewhat hackish. We would have to use some kind of a virtual host (I don't know it it's the right term in the context of nginx) to inject the challenge response on our server while it's running.  @carlosbaraza any thoughts on how to do that?\n. We are currently working on this https://github.com/kadirahq/meteor-up/pull/72, As soon as it finishes this can be continued, follow the changes on @carlosbaraza pull on old mup repo, it should give some insight.\n. Work on pull https://github.com/kadirahq/meteor-up/pull/72 is over. Anyone interested can start working on this.\n. @obiwarn We haven't started working on this yet. I'd love to see some community support on this though :) \n. You can build a docker image with all the stuff you want and push it to the docker registry (Use the base image meteorhacks/meteord). And then set meteor.dockerImage to your image id (ex: meteor.dockerImage: 'meteorhacks/meteord'). Take a look at the mup.js format in the readme. (BTW this feature needs testing, I'd appreciate if people can test this for me :) )\n. create a custom docker image with meteorhacks/meteord as the base + your libraries/software, push it to the dockerhub and set meteor.dockerImage to that.\n. try removing mongo field in mup.js. If that field is present, Mup automatically installs mongodb.\n. HI, Can you add some tests to verify the functionality? take a look at lib/**/tests/*.js to get an idea. \n. Hi @JoeyAndres can you add it as a new test? Without changing any existing tests? Create a new test project directory if you need under tests/project-<x>. \nAdd a test to check if the scripts run correctly too. \n. @JoeyAndres Great, The test wouldn't change If we change anything in the future anyway. \n@mnmtanish was suggesting that we can use a single exec entry point to at each module instead of exporting each deploy related function as we do now. \nThis would enable us to run hooks without bolting the specified function. No need to override nodemiaral internals. This would require some design changes.\nWe think using async functions here would be much cleaner instead of returning promises (which is what we are doing now).\nIf you think you got the idea, You can take a stab at it. Otherwise, I'll make the changes and ping you when the core is ready to accept hooks PR so you can format the code accordingly.\n. @JoeyAndres es7 work is now done. You can start working on this.\n. If there are no further logs, The app probably deploys correctly. Just the verification script can't verify the app is running. Try increasing the deployCheckWaitTime in the mup.js. Or this can be your firewall blocking requests on port 80. Check that too.\n. Is this from the old mupx or this version? Did you change the app name between the deployments?\n. Yeah, We use app name to recognize the docker container while redeploying. This error comes up because mup can't figure out which container is bounded to your specified port.\n. It looks like this is an issue with meteor-1.3-beta-x with meteord. Take a look at this issue thread https://github.com/meteorhacks/meteord/issues/78 \n. I'm closing this since this is not an issue with mup.\n. One clarification, Old mup/mupx is still god for production use (in fact it's recommended since this version is not yet fully ready). We are just not doing any new developments/feature adding to it. \nAs for the issue, Mup does not support using Nginx as a proxy (yet). If you want to use it as a proxy, You will have to install and configure Nginx manually (here is a doc on how to do that https://github.com/arunoda/meteor-up/wiki/Using-Meteor-Up-with-NginX-vhosts). What mup uses Nginx for is to provide SSL support (Which is a separate use case). \nOther than that, I can see you have something running on your port 3000. Kill it or change to port  something other than 3000 before you deploy.\n. It could be if that setup is what's binding to the port 3000. Changing the port should work. \n. I hope this is fixed, Reopen if not.\n. you can't do this. Mup is not designed to handle different deployment stages like this. What you can do though is to create several mup.js files (maybe in .production and .staging directories) and configure them as necessary.\n. This could be problematic since we don't directly run mup.js file. \n. We already have a proposal to add hooks, https://github.com/kadirahq/meteor-up/pull/65 \nWhich seems like a more generic feature. @arunoda @mnmtanish what do you think? \n. The recommended way to add new packages to the docker image is to build one of your own using meteorhacks/meteord base image and use that in the deployment.\n. Did the app name or the meteor version changed between deployments? Have you tried increasing deployCheckWaitTime ?\n. @ericvrp Sound like a good idea, If someone can make a PR with a couple of tests, we can merge it.\n. If you change the name of the app, you have to remove all the docker containers on the server related to your app manually. \n. What nginx are you using? The one from the mup frontend server or custom one?\n. No, You can run your own Nginx server. Actually, it's recommended if you need to use Nginx as a proxy. But be sure to config websocket proxying following a guide like this. https://www.nginx.com/blog/websocket-nginx/\n. Hi @VasilySizov , We can discuss a proper API for providing docker options. We already have logs option covered. Maybe we could move them to a separate docker in mup.js. \n@mnmtanish what do you think?\n. @mnmtanish Yeah I think that way would be good. \n. yeah. rather than checking every option possible, adding a generic args array like @mnmtanish has mentioned is better I think. If the user wants to use an option, it's safe to assume he knows the correct usage.\n. Looks like your VM has SFTP disabled. See if it is. Are you logging in using a password or a ssh-key?\n. Can you post your mup.js file here?\n. You don't have to redefine servers under meter.servers. Just do something like this\njavascript\nmeteor: {\n  ...\n  servers: {\n    A: {}, B {}\n  }\n}\nI'm not sure this is still the problem though. Can you try to deploy to one server, without doing both at ones.\n. This is a issue with meteord. Not mup.\n. It shouldn't happen. When mup builds the meteor app, It uses the linux-x86_64 target (read this https://www.meteor.com/services/build). Make sure you are using either this version of mup or mupx. Old mup had bugs like this. \n. Great, If it works. You can close the issue :)\n. Since the mup config file is now a js file, You can load whatever environment variables you need using process.env.\n. Yes, This error is thrown by mup, which is running on your local machine because it can't verify meteor app is running. mup logs pulls docker logs from the server, which seems to be running fine. Increasing the deployCheckWaitTime on mup.js should work.  \nIf you'd like to help get more reliable deploy check, Check this issue https://github.com/kadirahq/meteor-up/issues/73.\n. MONGO_URL is mongodb://localhost:27017\n. Just custom setup your mongodb with authentication and point the app there using MONGO_URL. \nThe error log is not complete. I can't say anything from it.\n. We can add an option to choose if you want to do a serial or parallel deploy.\n@mnmtanish what do you think?\n. Actually the object after server name in meteor.servers is meant for server specific env vars. It's not implemented yet.\n. Yes, ~ is a bash-specific way of referring to  the home directory. path.resolve doesn't support it. So doesn't mup. \n. If you can send a PR with the logic, I'm happy to merge it :)\n. Take a look at the FAQ section in the README\n. Yeah, It was suggested before. If someone can PR with the logic, I can merge it.\n. I think this is a problem with meteord. You can check the meteord issues page.\n. Yes. ~ is not supported yet. So is it working correctly now? \nI'll try to find why an error wouldn't trigger. \n. Meteor runs in a docker container, not outside. \nIt seems like you copied your mup.js file from one of the test directories, right?\ndockerImage field is only meant to be present only if you want to use a custom docker image.\n\ndockerImage: 'madushan1000/meteord-test', //optional line pulls an old meteord image I careated just for testing.\n\nremove that line and app should work fine.\n\nIn the futuere, use mup init to create a new mup.js file.\n. yeah, remove the line and try mup setup again. It'll pull the default docker image. I'll take a look at the other issue.\n. Can you post your new mup.js file?\n. I don't see anything wrong with the config. You don't have to install node or npm on the server because meteor app runs in a container. It looks like this is a problem with https://github.com/meteorhacks/meteord, try meteord issues page.\n. You have to run npm run prepublish before you can use mup. This was missing in the readme. I'll update it.\n. I haven't used it, But I see no reason for it not to work.\n. @mnmtanish Any idea what's causing this?\n. Is meteor binary present in PATH on the machine you are trying to run meteor-up? \nError: spawn meteor ENOENT\n\nHappens when meteor is not installed.\n. I hope this issue is resolved now.\n. Try updating to npm3.\n. You don't have to setup docker yourself. Mup will automatically set it up\n. @mnmtanish It looks like we have a dependency problem in nofat.\n. No, We don't have that yet.\n. You should implement meteor.mongo section in mup.js for mongo to install.\n. This is a known issue with meteor 1.3.x. Take a look at meteorhacks/meteord issues section.\n. Refer to the FAQ\n. This looks more like an error with meteor itself than meteor-up.\n. Mup is currently only recommended to deploy to Ubuntu-14.04LTS only.\n. Are those all the logs you are getting? No errors?\n. That's strange. Can you check if there are any docker containers running on the server after this?\n. If you want features like oplog, you have to set up your own mongo and set MONGO_URL. Mup uses meteorhacks/meteord docker image, check its issue page to see if there any known behaviours like this. You can get your error logs by running mup logs after the container crashed.\n. mup/mupx both only supports deploying to ubuntu-14.04 LTS only right now. Even if you could deploy into CoreOS, I'm not sure what kind of issues there will be.\n. Mup uses some unix tools to setup the environment. There might be some issues running the commands. (They might work fine too). We haven't tested mup on CoreOS so we have no idea what could be the issue.\n. I can't reproduce this on a digitalocean 512MB droplet with ubuntu 14.04 using kadirahq/meteor-up.\n. Sorry, I didn't understand the issue properly last time. I can see a docker chain \nChain DOCKER (1 references)\ntarget     prot opt source               destination\nACCEPT     tcp  --  anywhere             172.17.0.2           tcp dpt:27017\nACCEPT     tcp  --  anywhere             172.17.0.3           tcp dpt:http\n. @mnmtanish Should we change our build options format to something like this? so the users can define their own build options easily?\nbuildOptions: [ \n    \"--server-only\",\n    \"--mobile-settings='<mobile settings>' \",\n    \"--debug\"\n]\n. I'll merge this for now. But we have to implement a more robust way of passing options to meteor binary. \n. Older meteor versions didn't have a --server-only option. Using it by default can be problematic. \n. I merged the PR for this.\n. Can you log into both the servers without a problem? and did you run mup setup before running mup deploy\n. I can't see anything wrong with your config. does this happen every time you try to deploy?\n. It worked a few commits ago, I'll try to find out what's going on.\n. It looks like there something went wrong after es7 intigration. I'll look into that. Meanwhile you can checkout a commit before es7 intigration and work with it.\n. This is a known issue with meteor 1.3 versions. Some newer version of meteor fixed this. Try searching the mup issues.\n. Oh sorry, I thought this was a fibers issue without reading the full text. It looks like your mup.js file get bundled with your app and meteor tries to load it on the server. To prevent this from happening, move your projectroot/mup.js file to projectroot/.deploy/mup.js and adjust the paths accordingly. \nThis is an issue we are going to address in the future. \n. Both mup and mupx uses meteorhacks/meteord ad the docker image. You can modify that to your need and push it to the registry and specify meteor.dockerImage section to use that.\nChanging node options from the mup/mupx side might be a lot complex than it seems. \n. closed by https://github.com/kadirahq/meteor-up/pull/120\n. These packages should be automatically resolved using .babelrc file. Are you using npm2?\n. What is the npm version? npm install properly install all the packages if you are using npm version 3.\n. Meteor up doesn't necessarily has to use meteor node/npm version. \n. Yeah, I'll update the readme to mention that meteor-up requires npm3. But It wouldn't bother the end user because we are going to publish the transpiled code at npm.\n. @marcusrognes Hi, can you add this information to the README too? \n. \ud83d\udc4d I'm merging this for now, We can find a better way to handle docker options later.\n. We have discussed a flexible method here https://github.com/kadirahq/meteor-up/issues/75 too..\n. Can you elaborate this a little more?\n. Duplicated issue, But it looks like it's closed too. I'll reopen this.\n. find the absolute path of the mup executable and run it using that. This is a problem with windows file association. \n. Can you post some logs?\n. The problem here is that mup redeploy the old version of the app even if the deploy failed (It doesn't check for error at that step) and reports that mup completed correctly. This is the expected behaviour. \nI don't think it would be that hard to remove the rollback code and accomplish your task. You can create a fork of mup for your CI tasks.\n. Looks like an interesting feature. Go ahead and implement it. Be sure to add a new module under src/modules and handle the multi-server scenarios.\n. I think these two lines are coming from the meteor build command we use under the hood to build the meteor bundle. \n[BABEL] Note: The code generator has deoptimised the styling of \"/client/scripts/lib/pdfmake.min.js\" as it exceeds the max of \"100KB\".\n[BABEL] Note: The code generator has deoptimised the styling of \"/client/scripts/lib/vfs_fonts.js\" as it exceeds the max of \"100KB\".\nError If encoding is specified then the first argument must be a string\n. Mup needs npm 3 to setup correctly.\n. No there are no plans as of now to support anything other than Ubuntu 14.04 LTS. But anyone is welcome to PR with the feature. \n. npm link requires access to your npm lib dir. Skip that and run from the source directory. \n. Do you use the mongo contained setup by mup or one of your own? \nIf you use one of your own, you're going to have to expose the mongo port using -p docker option.\n. can you post your mup.js file?\n. If you want to setup mongodb provided by mup, you have to specify mongo section in the mup.js file. Take a look at the sample config file in the README\n. You don't have to. Just specify it in the MONGO_URL. Mongo will automatically create it for you.\n. you have it right in your mup.js\n. It's not recommended (or supported) to run two meteor apps on the db setup by mup. You should set up a separate mongodb instance yourself and point both of the apps there.\n. There is an (planned) option to specify server specific env vars trough the currently empty blocks like one: { env: { SOMETHING: \"something\" } }. But it's not implemented yet.\njs\nservers: {\n      one: {}, two: {}, three: {} //list of servers to deploy, from the 'servers' list\n},\n. mup doesn't support ubuntu 15.04. It looks like you have a problem with docker. Can you try to install docker manually and run a container? \n. closed with https://github.com/kadirahq/meteor-up/pull/133\n. Use the meteor.env section of the mup.js\n. reported previously \n. Your meteor app runs in docker. So installing the library on server doesn't work. Create a docker image with your library using meteorhacks/meteord as the base image and use it as the mup docker image.\n. Build a new docker image with PhantomJS dependencies installed using the meteorhacks/meteord base image push it to the docker registry, and set it as the docker image in mup.js file\n. @mnmtanish take a look at this\n. Yeah, It looks better! \n. I refactored the code from here and merged to the master in #224 \n. Did you deploy after npm install? mup doesn't handle anything npm related.\n. No, Meteor Up doesn't support this right now. But you might be able to get something like this working using manual deployments and proxy config.\n. Yeah, this is actually in the plan. But no one is working on it right now. \nImplementing this would probably require changes inmeteorhacks/meteord, meteorhacks/mup-frontend-server and mup itself.\n. Error starting userland proxy: listen tcp 0.0.0.0:80: bind: address already in use. looks like something is already running on port 80 on your server.\n. try changing the relative pem path to an absolute one.\n. We use path.resolve to resolve the strings to actual paths, in the package ~ alias for the home directory is not supported. But I need to take a look at why is it silently failing. \n. works(ish) with mup ^1.0.1\n. Can you post the complete error log? The warning has no effect, it just says you have some problem with your clock. \n. If you need the older mup version, install it using npm install -g mup@0.x.x. It's no longer supported and the new version is not backward compatible. \n. You get \"Windows script error\" because windows script host tries to run mup.js config file instead of the actual mup binary. Use the absolute path to the mup binary.\n. run c:/appdata/roaming/npm/node_mobules/mup setup in your project folder.\n. try where mup and use that path.\n. I'm sorry but I can't test the windows version myself because I don't own a windows PC or a licence. The best I can do it speculation. As a quick solution, you can use the older mupx from npm. It didn't have this problem. You would have to change the configuration file according to mupx readme. \n. What docker features do you need? \n. I added the support to use command line parameter --config and --settings to specify config files. It's not in the npm yet. If you want to try use the cli-options branch from the repo.\n. The config file seems a bit off, can you try using a new config file. Alter the one after you get running mup init. \n. @CaptainChemist Is there any other logs other than that error? Can you post them.\n. It should work, You can also try removing the pem field and using ssh-agent instead. \n. looks like you already have mongodb running in your VM.\n. Install mup@1.0.2 from npm\n. Yeah, mount your external directories as docker volumes using the meteor.volumes option in mup.js\n. I'm not sure, can you post yout mup.js and output of the mup setup and mup deploy\n. I don't see anything wrong with the config file. Any outputs from mup setup or mup deploy?\n. At the first glance, there is a part of deploy log missing. There should be some more information after Pushing startup script. \nI'll take a stab at telescope deployment. \n. Looks like I can't deploy Telescope because some of the binary dependencies fail to build probably because of problems in the docker image. \nBut I couldn't replicate this specific problem. I always had the docker container started in the server. \n. On a second note, It worked just fine with ubuntu 14.04 on a digitalocean droplet. \n``` javascript\nmodule.exports = {\n  servers: {\n    one: {\n      host: '1.2.3.4',\n      username: 'root',\n      // pem: './mykey',\n    },\n  },\nmeteor: {\n    name: 'tele',\n    path: '../',\n    servers: {\n      one: {},\n    },\n    env: {\n      ROOT_URL: 'http://1.2.3.4',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n    dockerImage: \"kadirahq/meteord:base\"\n  },\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n``\n. It might be the case, can you try completely removing mup and installing mup@1.0.1? \n. is your mup version now 1.0.1?\n. can you try running the deploy withDEBUG=* mup deploy` and post the log? \n. I just tried deploying both Telescope and react-todo-list from do droplet to a do droplet(both running on ubuntu 14.04.5) . And both were successful. Here is the mup.js file\n``` javascript\nmodule.exports = {\n  servers: {\n    one: {\n      host: '1.2.3.4',\n      username: 'root'\n      // pem:\n      // password:\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\nmeteor: {\n    name: 'app',\n    path: '../',\n    servers: {\n      one: {}\n    },\n    env: {\n      ROOT_URL: 'http://1.2.3.4',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\ndockerImage: 'kadirahq/meteord',\ndeployCheckWaitTime: 60\n\n},\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n``\n. Hi @poltak, \nThank you for the pr.\nCould you refactor this into more general solution so that any path used in the config file has homedir expansion?\n. Yeah, that's normal behaviour, if the deployment fails, mup tries to deploy the old version.\n. IF you don't have a previous version, it's fine. But otherwise it's a problem. Do you have any logs?\n. Can you post your fullmup.jsfile?\n. According to the config, there is no clear way to deploying two instances. Maybe the old instance is still running atexample.com?\n. You might have to take a look at your nginx configuration and DNS records. I don't think the issue is mup related. \n. No, mup doesn't use nginx by default. So the problem should be with your DNS records. \n. You don't have to change the source. Install mup again from npmnpm install -g npm.\nAnd setmeteor.env.PORTto whatever port you want.\n. Use the dockerImage fromkadirahq/meteord. I'm not sure about this. we never tried to use mup that way. You can certainly try and publish the results. \n. Yeah, it should becrt. \n. Create a different docker image with configurations you want usingkadirahq/meteordas base and use it. \n. I'll look into this. thanks. \n. I'm not sure, that's a meteor related issue. But I think you could get away with setting a fake mongo url.\n. Take a look at this fork of the old mup. Looks like it's maintained. https://github.com/aadamsx/meteor-up-classic\n. mup doesn't parse the mongo url. Meteor does. mup just passes whatever env vars you specify to meteor regardless of the content.\n. BTW try url encoding your password.\n. currently the command line options are not working in the release version. Try thecli-optionsbranch on the repo.\n. It's now merged with master branch. I have to fix a few more things. I'll do a release after them.\n. Install mup@1.0.2 from npm.\n. Obsolete by #223 \n. This is fixed in the dev version (from github). I'll push to npm soon\n. This [function](https://github.com/kadirahq/meteor-up/blob/master/src/modules/meteor/index.js#L133) takes care of env vars, I can't think of a direct way to implement the feature though. PRs are welcome :) \n. I can merge it, but I can't test it at the time. So there would not be a npm release. \n. One the other hand, if someone can write some tests, I can test them using out test rig.\n. You might need to update to npm3\n. This patch requires some integration testing. If someone can write some, I can run the tests and merge. Otherwise, it'll take some more time. \n. remove the mongo section in the config file. \n. Yeah, And I don't think it would be hard to implement. \n. meteor up is intended for meteor deployments only, allowing other services to be deployed trough mup seems like out of scope and mostly redundant (take a look at tools like [ansible](https://www.ansible.com/) or [nodemiral](https://github.com/arunoda/nodemiral) )  \n. You could fork meteor up and add your required changes, Or you can write an ansible or nodemiral script wich make use of meteor up under the hood.\n. Did you runmup setup`?\n. Can someone check if this PR works with the old mup.js files? . Can you also fix the docker pull line above? \n. Not here, take a look at line 38/39\n. ",
    "mnmtanish": "Use a javascript file for mup config meteorUp.js and do not validate them globally.\n. The delay is caused by update check. This does not increase code performance significantly.\n. I didn't think of that so I deleted the branch. We can do this after porting all core features or else we'll have to run npm run prepublish often.\n. Hi @timothyarmes,\nAs far as I know, the way the meteor application is deployed shouldn't affect hot code push. Meteor uses a couple of hashes to detect version changes. For an example check the __meteor_runtime_config__ global variable on some meteor app.\n\nWhen these versions change, meteor will try to update the client or it will do a hot-code-push.\n@arunoda can you verify this?\n. When a client re-connects to a meteor server, it simply starts a new session. The DDP protocol does support resuming sessions but Meteor has not implemented it yet. source-code\n. It will try to do a hot code push without a reload (example: css only changes). If it can't do that, it will do a hot code push with a reload.\n. Hi @timothyarmes,\nThanks for reporting this (looks like a bug). I'll check it out in a few hours.\n. Can we do this without adding extra fields to mup.js? I guess we can check whether module.exports.mongo exists for that.\nAnd the deployCheckWaitTime should go under meteor right?\n. Hi @mzygmunt,\nIs the mup.js file inside your meteor app directory? If it is, that might be the problem.\nPlease move it outside or use a hidden directory. Example: .deploy/mup.js\n. Shall we use one of pass/password instead of both?\n. @arunoda can you check this out?\nChanging user/pass fields in mup.js to username/password because everyone's keep using it that way.  And, arunoda/meteor-up used username/password so I guess it'll be more familiar.\n. How about adding an exec function to each module and not exporting functions.\n`` js\nexport function exec(api, fn) {\n  // if there are any pre-hooks forfnrun them\n  // run the functionfn// if there are any post-hooks forfn` run them\n}\nfunction deploy(api) {\n  // ...\n}\n``\n. @JoeyAndres @madushan1000  Yes, that'll be a different PR. I'll comment here as soon as it's ready.\n. @madushan1000 this should work fine now\n. I also believe the second way is more appropriate. If we abstract these settings, users will have to learn docker configs, mup config and how they work together. Theenv` argument is a special case so better leave it.\n@madushan1000 \nPerhaps something like this will do. Can you check it out?\njs\nmeteor: {\n  name: 'app',\n  path: '../app',\n  servers: {\n    one: {}, two: {}\n  },\n  env: {\n    ROOT_URL: 'app.com',\n    MONGO_URL: 'mongodb://localhost/meteor'\n  },\n  docker: {\n    image: 'madushan1000/meteord-test',\n    args: [\n      '--log-driver syslog',\n      '--log-opt syslog-address=\"udp://syslogserverurl.com:1234\"',\n    ],\n  },\n},\n. @unmonk Looks like meteor-up didn't install properly. Can you try again after running npm install from where you have installed meteor-up (I assume it's /home/sweaver/meteor-up).\n. Hi @sungwoncho and @joncursi \nWhat is your npm version? nofat doesn't work with npm v2\nnpm -v\nIf possible, can you try upgrading npm to v3.\n. I think a better way to fix this issue is to simply remove this line from the .gitignore file and publish compiled code with the repo. This way we can avoid installing a significant amount of dev-only dependencies when installing mup.\n. LGTM \ud83d\udc4d \n. I guess it should be\n} else if (info.password) {\n. Hi @marcusrognes \nWith a small tweak we can keep mup compatible with older config files. Can you check whether config.dockerImage exists and use it. If we do it in the mup-api.js file here we don't have to worry about it anywhere else.\njs\n// NOTE: backward compatibility\nif (!this.config.docker && this.config.dockerImage) {\n  this.config.docker = {image: config.dockerImage};\n  delete this.config.dockerImage;\n}\nThanks\n. ",
    "arunoda": "But if we implement this, it's easy to install mup. Because user does not\nneed to download a huge chunk of babel related modules.\nOn Wed, Dec 2, 2015 at 2:55 PM Muhammed Thanish notifications@github.com\nwrote:\n\nThe delay is caused by update check. This does not increase code\nperformance significantly.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/16#issuecomment-161232908.\n. We can use NPM base for this.\nUse this: https://github.com/kadirahq/npm-base\n. Hey @afaur it's great you are looking at this. Actually, we were preparing our test setup. That's why this is taking a lot of time and so on. We wanted to test all the mup functionality inside a real server. \n\nWe are still working on that. I assume that's why you tests failed.\nI think @madushan1000 can build the test setup by end of next week. With that, we can add more features and port mupx faster with reliable manner.\nI suggest you to wait a bit until that.\n. Hey @madushan1000 I ran tests. Most of the times, they do run. But I found two errors often.\n- Once is a AUFS error\n- Other one is it's failing tests randomly\nSee sample logs: https://gist.github.com/arunoda/4b1498d60af5e90b5abc\n. Hey @afaur now we've an automated testing setup. \nThen we can accept PRs easily.\nSee more: https://github.com/kadirahq/meteor-up/blob/master/CONTRIBUTING.md\n. Let me know, what would you like to work on.\nCheck here: https://waffle.io/kadirahq/meteor-up\n. Nice.\nOn Thu, Dec 31, 2015 at 12:31 AM Adam Faur notifications@github.com wrote:\n\n@arunoda https://github.com/arunoda Great, i'll take a look and try to\nfind something.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/pull/17#issuecomment-168056430.\n. End of Feb.\n. @madushan1000 could you use expect instead of assert. \nSee: https://github.com/kadirahq/lokka/blob/master/lib/tests/index.js#L10\n. Thanks @artpolikarpov for finding the issue in the first place.\n. Hey @elmor34 could you try using our other repo to post issues. This is a currently re-factoring version.\n\nAnd thanks @MasterJames \n. This is pretty hard to solve for whatever the reason and we don't anything fancy here. Just build it using Meteor's command.\nSo, my suggestion is not to use 0.14.4.\nWith Meteor 1.3, you don't need this package.\nSee: Getting Started with Meteor 1.3 and React\n. Here's the build related code. There is nothing mup specific.\nSee: https://github.com/kadirahq/meteor-up/blob/master/lib/modules/meteor/build.js#L26\nI'm open to any reason why it's failed and happy to fix it's an issue on mup.\n. @madushan1000 could you take a look at this. I think it seems like a bug.\n. Thanks.\n. Great.\n. @madushan1000 we should try to get this or something similar to mup. \nAlso, there's a mup fork with SSL support too: https://forums.meteor.com/t/meteor-up-fork-with-free-ssl-certificates-by-lets-encrypt/27368\n. I hope we allow to change the docker image.\nmeteord is the base. But you could use any docker image with your own deps.\n@madushan1000 I think we need to document it if it's not done.\n. @madushan1000 any chance for getting these changes. May be we need to cherry-pick this.\n. @mnmtanish how about this?\n. @mnmtanish @madushan1000 can we take this?\n. Aren't we suppose to merge this?\n. @mnmtanish could you work on this.\n. @SachaG try to do this against a new server. I think this is not compatible with the older version.\n. Add then directly to the buildApp(...) rather creating a new variable.\n. Can be check for some log output. May be check some words which is common to MongoDB.\n. Here can be check whether port 27017 is running.\n. Check whether port 27017 is not running.\n. Also check for port 27017.\n. here we don't need mongo logs.\n. Do we need to start mongodb? I don't think so.\n. remove empty spaces.\n. do this in the setup area.\n. Could you write a test case which\n- configure the app to use syslog\n- then try to check syslog and see whether we are getting logs or not.\n. npm install -g is okay.\n. ",
    "afaur": "@madushan1000 \nHey there,\nI was taking a look at your work to see if I could help in some way.\nI would first like to say that I think this PR is getting kind of big.  \nTo make it easier to review I stuck a rebased version here temporarily \n(https://github.com/afaur/meteor-up/commit/a3c4f4943fc6d2f3697372efb9e399c4ced34d12).  \nWhile looking at your test errors it looks like on the error for test: module - meteor setup should setup enviranment on \"meteor\" vm: is at step (lib/modules/meteor/tests/index.js:21:191), however, since this project is being converted to ES5 behind the scenes I would imagine it might make it difficult to find out what real line of code that is.  \nI was curious if you are having any trouble with that, or if there is anything I could do to help with this PR.\n. @arunoda Understood, looks like your setting up a docker container with keys and ssh'ing into it to test the code which is great.  It always is a lot harder to test deployment type functionalities.\nAs far as the tests failure I was actually referring to the CircleCi error report from @madushan1000 's recent pushes here:\n\nBy the looks of it I had thought it might prove harder to find out exactly what line of code in his test https://github.com/afaur/meteor-up/commit/a3c4f4943fc6d2f3697372efb9e399c4ced34d12#diff-08e589ca7fff290c72ee44d3f7edff4eR28 would be the offending problem.\nAll the best, if I can be of any help please let me know.\n. @arunoda Great, i'll take a look and try to find something.\n. ",
    "timbrandin": "Are you working on this? Or do you want some help, because I need this for a client so if we had automatic oplog tailing in the mongodb docker using mup, all the deployments would be amazingly less straining on the CPU.\n. @arunoda it doesn't seem like this line is doing anything actually, have you implemented this? Or is this just a marketing scheme? ;) https://github.com/kadirahq/meteor-up/blob/master/src/modules/default/template/mup.js.sample#L24\n. alright, thx, I'll see what I can do\n. @joncursi OPLOG is not implemented yet, what I can tell\n. Does it work that way even though mongo is run within a docker container? What other steps is needed to turn on oplog in mongo?\n. I solved this by removing .meteor/local and node_modules, and re-installed npm modules using meteor npm install, I guess having multiple versions of npm on my machine caused this issue and using meteor npm makes meteor use the correct version that works with node 0.12 which meteor ships with at the moment.\n. I'm having trouble using this feature, deploying to multiple servers, gettings stuck on \"Sending Environment Variables\".\n. When trying to deploy to multiple app servers, I get this, but it works to deploy to them individually by just removing the server from the list of servers to deploy to in the configuration for meteor.\n[xxx.1] - Pushing Meteor App Bundle to The Server\n[xxx.2] - Pushing Meteor App Bundle to The Server\n[xxx.1] - Pushing Meteor App Bundle to The Server: SUCCESS\n[xxx.1] - Pushing the Startup Script\n[xxx.2] - Pushing Meteor App Bundle to The Server: SUCCESS\n[xxx.2] - Pushing the Startup Script\n[xxx.2] - Pushing the Startup Script: SUCCESS\n[xxx.1] x Pushing the Startup Script: FAILED\n    No response from server\nConfiguration for mup.json\n``` js\nmodule.exports = {\n  servers: {\n    one: {\n      host: \"xxx.1\",\n      username: \"root\"\n    },\n    two: {\n      host: \"xxx.2\",\n      username: \"root\"\n    },\n  },\nmeteor: {\n    name: \"app\",\n    path: \"../..\",\n    servers: {\n      one: {}, two: {},\n    },\n    buildOptions: {\n      serverOnly: true,\n      debug: false,\n      mobileSettings: {}\n    },\n    env: {\n      ROOT_URL: \"http://test\",\n      MONGO_URL: \"mongodb://localhost/app\",\n      MONGO_OPLOG_URL: \"mongodb://localhost/local\"\n    },\n    \"deployCheckWaitTime\": 60,\n  },\n};\n``\n. This would be wonderful, similar to how docker-compose combines logs from multiple machines.\n. I've written an article about this a while back, it is still up to date though:\nhttps://blog.studiointeract.com/mongodump-and-mongorestore-for-mongodb-in-a-docker-container-8ad0eb747c62. WOW! This is just what we need, often times one just want to re-deploy and hate waiting for the build (which is painstakingly slow). I'd also prefer to avoid manual switching the flag. How about adding a--rebuildflag when you deploy to get a fresh copy? or the other way around with--cached` to get the cached version.\n. How about starting a PR for this? It might get merged ;)\n. I love this:\n\nCheck if the container has restarted 2 or more times and rollback immediately instead of waiting the full time.\n\nAlso I think the logs are replaced by the rolled back container if it rolls back, so is there a way to get the full logs if that happens?. Somehow deploying to multiple machines was faster before, not sure what's different but I don't think prepare bundle existed before, or maybe it was done directly on the host machine.. I have the same issue.. this should def be a config option, we cannot have it so that prepare bundle takes down all instances of the app before starting them up again, especially painful to witness when having multiple machines with same slow prepare bundle step.. ",
    "joncursi": "@timbrandin @madushan1000 I am also running into this issue. Deployment fails when you specify MONGO_URL and MONGO_OPLOG_URL in the mup.json file, i.e.\n\"env\": {\n    \"ROOT_URL\": \"https://xx.xx.xxx.xx\",\n    \"MONGO_URL\": \"mongodb://staging:27017,staging:27018,staging:27019/staging?replicaSet=rs0\",\n    \"MONGO_OPLOG_URL\": \"mongodb://staging:27017,staging:27018,staging:27019/local?authSource=admin\",\n    \"MAIL_URL\": \"smtp://localhost:25\",\n    \"CLUSTER_WORKERS_COUNT\": \"auto\",\n    \"KADIRA_PROFILE_LOCALLY\": 1\n  },\nstaging is the hostname of the Linux server I am deploying to (I've tried replacing this with the server's IP address to no avail).\nThe replica set status is healthy:\n{\n    \"set\" : \"rs0\",\n    \"date\" : ISODate(\"2016-04-12T10:23:45.887Z\"),\n    \"myState\" : 1,\n    \"members\" : [\n        {\n            \"_id\" : 0,\n            \"name\" : \"staging:27017\",\n            \"health\" : 1,\n            \"state\" : 1,\n            \"stateStr\" : \"PRIMARY\",\n            \"uptime\" : 41791,\n            \"optime\" : Timestamp(1460455377, 2),\n            \"optimeDate\" : ISODate(\"2016-04-12T10:02:57Z\"),\n            \"electionTime\" : Timestamp(1460414921, 1),\n            \"electionDate\" : ISODate(\"2016-04-11T22:48:41Z\"),\n            \"configVersion\" : 1,\n            \"self\" : true\n        },\n        {\n            \"_id\" : 1,\n            \"name\" : \"staging:27018\",\n            \"health\" : 1,\n            \"state\" : 2,\n            \"stateStr\" : \"SECONDARY\",\n            \"uptime\" : 41706,\n            \"optime\" : Timestamp(1460455377, 2),\n            \"optimeDate\" : ISODate(\"2016-04-12T10:02:57Z\"),\n            \"lastHeartbeat\" : ISODate(\"2016-04-12T10:23:45.670Z\"),\n            \"lastHeartbeatRecv\" : ISODate(\"2016-04-12T10:23:43.927Z\"),\n            \"pingMs\" : 0,\n            \"syncingTo\" : \"staging:27017\",\n            \"configVersion\" : 1\n        },\n        {\n            \"_id\" : 2,\n            \"name\" : \"staging:27019\",\n            \"health\" : 1,\n            \"state\" : 2,\n            \"stateStr\" : \"SECONDARY\",\n            \"uptime\" : 41706,\n            \"optime\" : Timestamp(1460455377, 2),\n            \"optimeDate\" : ISODate(\"2016-04-12T10:02:57Z\"),\n            \"lastHeartbeat\" : ISODate(\"2016-04-12T10:23:45.344Z\"),\n            \"lastHeartbeatRecv\" : ISODate(\"2016-04-12T10:23:45.343Z\"),\n            \"pingMs\" : 0,\n            \"syncingTo\" : \"staging:27017\",\n            \"configVersion\" : 1\n        }\n    ],\n    \"ok\" : 1\n}\nError logs reported by mupx logs --tail=300:\n[45.79.139.28] => Starting meteor app on port:80\n[45.79.139.28] \n[45.79.139.28] /bundle/bundle/programs/server/node_modules/fibers/future.js:300\n[45.79.139.28]                      throw(ex);\n[45.79.139.28]                            ^\n[45.79.139.28] Error: Could not locate any valid servers in initial seed list\n[45.79.139.28]     at Object.Future.wait (/bundle/bundle/programs/server/node_modules/fibers/future.js:420:15)\n[45.79.139.28]     at new MongoConnection (packages/mongo/mongo_driver.js:213:27)\n[45.79.139.28]     at new MongoInternals.RemoteCollectionDriver (packages/mongo/remote_collection_driver.js:4:16)\n[45.79.139.28]     at Object.<anonymous> (packages/mongo/remote_collection_driver.js:38:10)\n[45.79.139.28]     at Object.defaultRemoteCollectionDriver (packages/underscore.js:784:19)\n[45.79.139.28]     at new Mongo.Collection (packages/mongo/collection.js:102:40)\n[45.79.139.28]     at AccountsServer.AccountsCommon (packages/accounts-base/accounts_common.js:23:18)\n[45.79.139.28]     at new AccountsServer (packages/accounts-base/accounts_server.js:18:5)\n[45.79.139.28]     at meteorInstall.node_modules.meteor.accounts-base.server_main.js (packages/accounts-base/server_main.js:9:12)\n[45.79.139.28]     at fileEvaluate (packages/modules-runtime.js:158:9)\n[45.79.139.28]     - - - - -\n[45.79.139.28]     at /bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb/lib/mongodb/mongo_client.js:329:26\n[45.79.139.28]     at process._tickCallback (node.js:458:13)\n[45.79.139.28] npm WARN deprecated This version of npm lacks support for important features,\n[45.79.139.28] npm WARN deprecated such as scoped packages, offered by the primary npm\n[45.79.139.28] npm WARN deprecated registry. Consider upgrading to at least npm@2, if not the\n[45.79.139.28] npm WARN deprecated latest stable version. To upgrade to npm@2, run:\n[45.79.139.28] npm WARN deprecated \n[45.79.139.28] npm WARN deprecated   npm -g install npm@latest-2\n[45.79.139.28] npm WARN deprecated \n[45.79.139.28] npm WARN deprecated To upgrade to the latest stable version, run:\n[45.79.139.28] npm WARN deprecated \n[45.79.139.28] npm WARN deprecated   npm -g install npm@latest\n[45.79.139.28] npm WARN deprecated \n[45.79.139.28] npm WARN deprecated (Depending on how Node.js was installed on your system, you\n[45.79.139.28] npm WARN deprecated may need to prefix the preceding commands with `sudo`, or if\n[45.79.139.28] npm WARN deprecated on Windows, run them from an Administrator prompt.)\n[45.79.139.28] npm WARN deprecated \n[45.79.139.28] npm WARN deprecated If you're running the version of npm bundled with\n[45.79.139.28] npm WARN deprecated Node.js 0.10 LTS, be aware that the next version of 0.10 LTS\n[45.79.139.28] npm WARN deprecated will be bundled with a version of npm@2, which has some small\n[45.79.139.28] npm WARN deprecated backwards-incompatible changes made to `npm run-script` and\n[45.79.139.28] npm WARN deprecated semver behavior.\n[45.79.139.28] npm WARN package.json meteor-dev-bundle@0.0.0 No description\n[45.79.139.28] npm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\n[45.79.139.28] npm WARN package.json meteor-dev-bundle@0.0.0 No README data\n- I am using MongoDB 3.0.7.\n- Project runs fine locally.\n- Using mupx 1.5.3.\n. Fixed for me by running\nnpm install --save-dev npm install babel-cli babel-preset-es2015 babel-preset-stage-3\nin the meteor-up directory.\n. Same issue. Deployment appears successful when accessing the freshly deployed app thru the browser, however the mup deploy command always fails on the Verifying Deployment step.\n. Not that I've been able to find. Meteor sorely needs a \"Capistrano\"-like deployment tool\n. ",
    "wizonesolutions": "Shouldn't manual passing of MONGO_OPLOG_URL work, though? I thought mup just passes through environment variables.\n. @madushan1000 anything I can do to help push this forward? I don't know where to start, but it'd be nice to get this in eventually.\n. @dkmooers how are you doing manual generation? With letsencrypt-standalone on the server itself?\n. Container went down again. Checked meteor logs, but nothing that would indicate a crash was there. What else might I check? The node is using CoreOS on Digital Ocean.\n. Hmm, but isn't Docker just Docker? Nonetheless, I'll try on Ubuntu and see\nif it's more stable.\nOn 16 May 2016 14:49, \"Madushan Nishantha\" notifications@github.com wrote:\n\nmup/mupx both only supports deploying to ubuntu-14.04 LTS only right now.\nEven if you could deploy into CoreOS, I'm not sure what kind of issues\nthere will be.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/118#issuecomment-219416834\n. Yeah, everything seems ok but then the app crashes mysteriously sometimes\nand has to be redeployed. docker ps only shows Mongo at such times.\nOn 17 May 2016 11:05, \"Madushan Nishantha\" notifications@github.com wrote:\nMup uses some unix tools to setup the environment. There might be some\nissues running the commands. (They might work fine too). We haven't tested\nmup on CoreOS so we have no idea what could be the issue.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/118#issuecomment-219660691\n. OK, I have moved to Ubuntu 14.04 LTS now. Hopefully the uptime will be better. I'll open a separate issue if not.\n. Did you mention me by accident? . \n",
    "MasterJames": "Im guessing you put your mongodb settings\nhttps://docs.mongodb.org/manual/reference/configuration-options/\nin here somehow? \nhttps://github.com/kadirahq/meteor-up/blob/master/src/modules/mongo/assets/mongodb.conf\n. First thought is if it updated to meteor 1.2 you need to set the mupx settings file to use 0.10.40 version of nodejs.\n Second thought if you used mup before and are having problems, try the development branch mupx.\n. Right I'll try to watch better which repo these are in. I thought this was the other one.\n. If you push a new file into the deployment later in some other way with a ssh cp for instance, then the server will hotcode push as expected. The deployment box is separated. Once it's up via mupx do as you will. Certainly you can code sticky Sessions or what have you as deemed necessary by the app and already suggested techniques for cluster rolling updates. You could build a no new session way of showing preference to a session centric design over release update session restarts. Meaning a cluster node could wait to redeploy after all sessions have been rerouted or timed/logged out. This tool should not be cluttered (PRs welcome?).\nIt's a deployment server you realistically don't want to hot push to that do you? \nAnyway my unofficial opinion is I'm 99% sure that's not a current or future feature for mup to address. \nWhat you want is some file watch to scp secure copy 3rd party solution, that mup could in theory add on.\n. I think it's a file lock error or most likely permissions? \n. If you're having problems with mup please try the development branch mupx here and see if that helps.\nNote: A new port at kadirahq is underway and might be usable in a couple of months.\nYou might dare to try it as a beta tester and help with feedback even!? \n. It's more like mupx then mup I would expect right? \n. I did this somewhat crazy experimental PR for MUPX that adds Mongo Restore and Dump.\nhttps://github.com/arunoda/meteor-up/pull/736\nMaybe you can try to merge some of that yourself, or let me know when it's safe to try rebuilding it into this new version. I'm basically waiting for a notice in the README redirecting people to this one when it's ready.\n. Okay thanks good to know.\nI'm thinking you could update the Arunoda development branch mupx's Readme too.\nhttps://github.com/arunoda/meteor-up/tree/mupx\n. Could you post the errors logged, please? \n. https://docs.docker.com/engine/reference/run/\nHere are the docker run options if a PR wants to check against them but that might be overkill.\nOne could check for instance if a volume to mount actually exists and provide an appropriate warning.\nHow far would you want to take this @madushan1000 ? A separate accepted arguments configuration file probably isn't needed.\n. Yes docker will provide warnings and errors, so simple is better.\n. You ran mup setup and mup deploy after some setting adjustments? \n. It is no longer json it is a js Javascript file. I've been doing something similar for sometime now too, it makes way more sense.\n. Oh its only the mup file that's js sorry I got confused by that. Could it be js too instead? \n. Mupx docker versions of mup mount a local volume during setup so redeploy it doesn't overwrite your database so I think that will help you. So no need to ponder Mup in my understanding.\n. True but that one is 404 ? !\n. Are you missing a password? \n. So there's a pem file referenced? Oh I see new feature there.\n. Maybe that's the wait time issue again try extending it.\n. Meteor will bundle TLS in the nodejs they provide in some version of 1.3 for now people use nginx I believe. I saw a thread about working on how to allow any node version with 1.3 about a week ago. I thought it was a primary requirement for releasing it.\nAnyway try using the port at kadirahq/meteor-up maybe now and in the future.\n Mupx does have an SSL support option.\n. And your version of Meteor I wondered? 1.3.2.4+?\n. I think the problem steams from incompatible binaries.\nThe new version you have seemed to fix most fiber problems for people.\nOnly other thing other threads suggested was to delete the node_modules folder or something like that.\nSome clean build is needed. Could be a dependency of a dependency? \nThe Meteor plan is to allow packages to build but to include all possible binaries in the npm modules.\nYou might have to look up how to build manually. Update everything possibly related. \nBackup first. Then maybe...\nI would start fresh with a clean target. Do a simple test with a basic meteor default, then start adding your packages and see which ones might trigger a fibers error.\nThen resolve that with the package creator by building the correct binaries for the target platform if that's what's happening.\nAnyway I hope this help you find the right solution. Report back your findings and hopefully solution.\n. Does not meteor 1.3.2.2 an official update make this go away now? \n. Others waited longer I'm sure, and so that just dropped in the week I believe. Your post will help others now too., to spread the word and the love for meteor 1.3.2.2 ! I think the deal is it rebuilds all npm packages etc. It's been part of a bigger problem for sometime and one of the major changes to 1.3 it just took a while to sort out the fiber errors once and for all, I think, hopefully.\n. What's the target machine's operating system and SSH version? Your login info works fine though right? \nI wondered how to double check that the file copied but I guess not.\nhttps://github.com/kadirahq/meteor-up/blob/master/src/modules/meteor/assets/verify-ssl-config.sh\nTargets file /opt/$APPNAME/config/bundle.crt\nFull DEBUG log should show this happening?\nhttps://github.com/arunoda/nodemiral/blob/dbc96f5083650396d4f395ecc9b8c209c07e5894/lib/session.js#L82\nProper syntax is with no space. I think?\nDEBUG=* mup deploy\n. Ironically I suspected that might happen. Something updated eventually I suspect. Just takes a little bump sometimes, either way tinkering with ideas & settings etc. helps the solution to settle out to the top. Great problem solving skills. Anyway glad it's working now.\n. Make sure you've updated meteor version 1.3.2.2 (now 1.3.2.4 I think even?) helps with npm modules aspirations of 1.3 less problems with cross platform build errors like fibers and bcrypt. Hopefully that is/was the problem for you as its a recent release and has helped others.\n. Probably a dumb question but: Who's using graceful-fs your side?  Is it updated?  What version? Otherwise must be a deeper dependency maybe? I'll have to look into what graceful-fs is.\n. isn't there a mup setup step missing?\nmup init <project name>\n. Your going to need to try stepping through the code manually or putting extra console logging etc.\nOr I guess there's tests?\nFirst point here.\nhttps://github.com/kadirahq/meteor-up/blob/d36f4edecd99b95955e337fa07fb40ee648353b7/src/modules/default/index.js#L12\nThen this should test config\nBut you could add a log of the values etc.\nhttps://github.com/kadirahq/meteor-up/blob/08f5f2ef2567494fff021e554cf761ff3f52b5ee/src/modules/meteor/index.js#L177\n. Maybe your PEM is malformed? \nhttp://stackoverflow.com/questions/991758/how-to-get-an-openssl-pem-file-from-key-and-crt-files\nYou cat them together.\n. To enable oplog I thought you could put this\nmaster=true\ninto\nhttps://github.com/kadirahq/meteor-up/blob/master/src/modules/mongo/assets/mongodb.conf\nor something? no?\n. Hi all yes I've been hopeful we switch since meteor 1.3 release to this kadirahq version officially. I think that maybe there's a need for documentation here still. Otherwise it seems people questions and PRs would go unanswered and the hope is to get everybody using or trying and reporting issues on this version so it's more robust. Simply the old versions are running into to many problems with new changes going on so it's really important to keep routing people to where the development team is available on this version.\nI may not be continuing a watch status on the old version soon so people will get fustrated without a quick reminder about this port.\nStill mupx seems to be working okay but so many great new features here can solve lots of remaining problems and the only way forward.\nLet's try to get more officially switched on here if we are not already or there's a timeline when to plan for that would be good to know, thanks.\nThis problem is related to the build server only flag in a recent issue (merged PR) where there currently isn't a way to do this but should be for another reason now.\n. https://github.com/kadirahq/meteor-up/pull/120\nYou could add a similar PR I suppose but a better solution would be appreciated.\nMaybe this is a good place as any to discuss what the solution could be.\nHow will it be best to put these in the settings file? \nHow will it be best to have a template example customizable docker container that includes them on the command line? \nI wondered maybe there is or needs to be environment variables for these node flags too and so maybe we should be asking meteor forum about adding it to meteor first? \n. Looking for main.js ? \nhttps://github.com/meteorhacks/meteord/blob/master/base/scripts/run_app.sh#L44\nYou could put something there no?\nDigging around for leads I saw this about a 'start' value in package.json ? With environment arguments getting to node but like he said it's harder then you'd think maybe the wrong direction as that would go in the meteord image or something? But the idea is you'd set the environment variable to get the options/arguments to node.\nhttp://stackoverflow.com/a/30272349/4928388\n. Yes that's accurate. \nDocker is worth digging into. Spend a few days to learn it. It's faster to load and better in other ways.\nAt first seems disconnected and hard to access look at \"docker exec\" you can execute any script or even bash to gain access from seemingly afar. Typically it's using the volume argument to mount the deployment targets local file system for persistant data.\nLearn to love it. It's a way of life for you. Lots of better places to learn \"why docker\".\n. That's weird. Make sure it's all single quotes and try a full path to see if that's the problem and then look at the file itself but the error says the path is wrong.\n. To get an npm installed version number http://stackoverflow.com/questions/10972176/find-the-version-of-an-installed-npm-package\nA quick thought might be to avoid any none English characters. Just to be sure it's not that.\n. You followed the instructions https://github.com/kadirahq/meteor-up\nMaybe you have the old mup also there's mupx on the old account this one here with kadirahq is current but I'm not sure you can npm install mup for this version as the instructions say to git it.\n. Is there a reason this has not been merged yet? \n. Ah thanks for the action and links. I remember that discussion now. It would indeed be better but volumes is pretty fundamental need so good with both maybe.\n. I'm sure that @madushan1000 would also appreciate that. He's the one to guide you I'm not sure what issues might make it complicated?  Seems pretty straight forward.\nI'm thinking a validation check of the values passed would be nice but not critical as its customizable but something like a warning your arguments may need reviewing if missing hypens or argument values etc. would be useful to help people know when somethings wrong.\nI bet if you bang out a simple PR he will review and make suggestions. Hopefully you're around if people run in to edge cases that need a tweek or warning adjustment for clarity.\n. Where is this file do you think?\nimports/orders/emails/templates/index.js:3:25: Unexpected token (3:25)\n. Seems mupx here for now still and later or maybe now (if it's working for your situation) the new one at kadirahq.\n. Well if the new version at kadirahq doesn't work for yoy maybe stick with this depreciated version mupx it's considered the stable one.\n. Your welcome. No sorry I thought it is working fine now, but feverish changes at Meteor may be complicating things not sure what's happenin lately. I think it might still lack comprehensive documentation so you'll have to ask them.\nJust use it as a study guide and template to help achieve your needs. If a PR results I'm sure they will be happy for the help.\nOh wait this is the kadirahq issues forum?! Ohps I keep getting those mixed up. Anyway I'm leaving watching these for now.\n. What happens if you try? \nMONGO_URL: 'mongodb://localhost/app-database'\n. When you run your docker container do you use the port flag?  Maybe try  --expose=27017 as well? \n. I thought you said you're running your own MongoDB container? How is that launched?\n. Does that have a separate mup file?  Maybe post that.\nYou can confirm that the first one is working as expected I suppose.\nIf you SSH into the machine and via docker exec bash gain access into the second docker container with meteor can you test connectability to the other Mongo running? If deployment fails but theres nothing to revert it should leave stuff behind or maybe it's a feature request to avoid/skip revert (mupDebug or revertOnFail false ? @madushan1000). You can hack an exit breakpoint manually in theory too, (if that's interfering with testing what went wrong)\nAnyway I'm guessing you need to look at and test the network routing firewall stuff (ingress) that must be blocking access between the different docker containers.\nAre they in the same availability zone, vpc, etc? \n. Right you said that at the beginning. This link is helpful to understand something more about it.\nhttps://linuxconfig.org/basic-example-on-how-to-link-docker-containers\nI think he is right about deploying that separately is better, but your hack is good ~ working.\nIf you decide to do your own MongoDB container deployment as recommended you might need to --expose the port and know what the IP of it is. \nI think the PR/suggestion is to be able to add links from the settings file and maybe expose etc. I'm guessing/recalling there has been a few ideas/PRs about adding custom docker and or docker run parameters through the settings file. It's up to the devs to decide how this one might be solved that way. I think one should be able to add some arguments like this. The thing is you might call your MongoDB container something else and need to put something other then mongodb:mongdb like mymongodb:mongodb etc. so putting that in as a default for everybody probably isn't best practice.\nSomething to think about. I'm glad it's working for you and that's what matters most.\n. What version of npm is running? \nnpm -v\nTry for npm 3 on Ubuntu 14\n. You could try extending \ndeployCheckWaitTime: 120\nOtherwise maybe are you not using npm 3?\nWhat does extrnded mup logs report? \n. Try mup stop or restart\nYou can SSH into the target machine and learn docker commands to delete containers etc.\n. Break it +1 easy to fix upon updating \n. What version of Node? Try putting 4. \nhttps://github.com/meteor/meteor/pull/7218\nif it's not a new instance of Ubuntu 14 for the target try via SSH to purge all docker instances.\ndocker rm $(docker ps -a -q)\ndocker rmi $(docker images -q)\nIf that doesn't help maybe try a fresh user account on your deployment system with a default meteor app (and a fresh deployment target) and then with your app.\n. Well I would add that inversely to adding bits in from a clean project (that deploys), you can try stripping things out in a copy until something gives.\nIf your saying a fresh user can't deploy a default meteor app I guess that's one way to try and isolate the issue. I would think deploying from an Ubuntu VM via VirtualBox or what have you would do the trick.\n. what happens when you do like it says and run \nmeteor npm install --save react react-dom classnames\nand then deploy again?\n. https://github.com/reactionic/reactionic-kitchensink/issues/17\n```\nThis happens because the app folder has a symbolic link to node_modules.\nThe symbolic links are working right now in windows.\nThe quickest fix would be passing the node_modules to the app folder until we fix the symbolic link problem.\n```\n. Only Ubuntu 14+ is sup ported still i believe. What are you trying to install docker on? See if you can install docker manually after logging in (via SSH if necessary) to the target machine.\nConsider upgrading your kernel or choose a different droplet/instance/image.\n. Mup \"setup\" writes Mongo files to a share folder so the data is persistant from \"deploy\" while docker run commands make the contain link/mount.\n. I was saying only that if you rerun 'mup setup' it would write the Mongo data to the target. 'mup deploy' will push the code and build for the target but not stomp on the database, because it uses docker it is told to mount the folder on the target in the docker container.\nYou'll figure it out. Take a week to learn how it works with docker etc. it's more or less opensource and diggable/viewable. (Other then when making your customizable docker image.)\n. Right what ip port are you running your custom mongodb on? \n. This file and the mongo-setup \nhttps://github.com/kadirahq/meteor-up/blob/master/src/modules/mongo/assets/mongo-start.sh\nShow /opt/mongodb or is it /var/lib/mongodb as the location where the files a preserved across docker runs via the volume mount argument. \nAlso note you can use docker exec bash to gain access to a docker container and poke around etc.\n. ",
    "menelike": "@madushan1000 is this even possible?\nI need to link my mongo container with the meteor container, but https://github.com/kadirahq/meteor-up/issues/157#issuecomment-229283264 shows that this is not possible trough pure configuration.\nDo you see a valid solution on this?\n. ",
    "poltak": "@menelike You can enable oplog after the initial mup setup and mup deploy runs, which makes sure the containers are all already set up with proper linkings.\nTo do this, after your remote server is set up with your app + mongo containers, do:\n1. Add replSet=meteor as a new line in /opt/mongodb/mongodb.conf(this is mapped to the mongodb container at /mongodb.conf and used by the mongo daemon running inside the container).\n2. docker restart mongodb\n3. docker exec -it mongodb mongo and run the following code to initialise replica set: rs.initiate({ _id: 'meteor', members: [{ _id: 0, host: '127.0.0.1:27017' }] })\n4. Now you can safely add in the meteor.env.MONGO_OPLOG_URL key in your mup.js and do mup deploy to update your app without your oplog-enabled container being altered\nWe were using this little work-around to get oplog working in mupx and still works fine. You should only need to do this once. If somehow your mongodb container gets removed, you'll need to enable replica set again on your new one.\nAlso, this only sets up a single-node replica set, which allows oplog to be used. Theoretically you could set up more mongo nodes and then point to them from this mup-created container in step 3. Haven't tried though.\nSet your meteor.env.MONGO_URL to mongodb://mongodb:27017/$APP_NAME, where APP_NAME is whatever you put in meteor.name, and meteor.env.MONGO_OPLOG_URL to mongodb://mongodb:27017/local.\n. ",
    "v3rron": "Any ideas of how to set MONGO_OPLOG_URL for compose.io configuration?\nHere's my current config, which I got from compose.io, there's only 1 line:\nmongodb://user:pass@capital.2.mongolayer.com:15123,capital.1.mongolayer.com:15123/app-production?replicaSet=set-9835234s0y34gg35j63532dc\nI'm passing it into MONGO_URL, but the OPLOG is not working. \n. @SachaG did you get a chance to figure it out? Having exact same issue with Meteor 1.4.1 and mup2. Using abernex docker image. Everything seems successful but there is no app container created. \n. Ahh I forgot to add --settings to mup deploy command.\nNow it works.\nBut thanks anyway.\n. @Alino you shouldn't push mup.js to your git repo.\nI'm not sure if MONGO_OPLOG_URL is even used in MUP, since it's not listed in Documentation and I couldn't find anything related to this variable in the source code.\n. ",
    "zodern": "This is available in Mup 1.4. You can try the beta following the instructions in #870. Docs for the oplog were added here.. It currently isn't possible to. Please create a new issue for disabling the oplog.. This works when using the reverse proxy.. Added in 1.2.9: https://github.com/zodern/meteor-up#reverse-proxy.. @erperejildo you should use password instead of pass. The PR has been merged.. https://github.com/zodern/meteor-up#autogenerate-certificates. Yes it is.\n@JoeyAndres would you be able to finish this?\n. Hooks are available in the dev branch.. @ckiely91 Thanks for working on this. Some base images use a different package manager, such as the alpine image. I would prefer a more general purpose solution where there is an array of commands in the config to run when building the docker image.. @stefanve the best way right now is to create a custom docker image with pdftk already installed.. @stefanve an easier way will be available in the next version: #362.. https://github.com/zodern/meteor-up#common-problems. Deploying to multiple servers should work.. @emanuellimeira something is using port 443. If this is the first time you ran mup setup with the reverse proxy enabled, you need to stop the app with mup stop first: http://meteor-up.com/docs#reverse-proxy. ~~@twastvedt you had set the PORT env variable to 3000. While verifying it was looking at port 80. I would like to keep this open until mup can detect the PORT env variable and display a warning.~~\n\nIt took me 2 & half months to get it to work. So don't feel bad.\n\n@Deadlyweed, would you be willing to list what was difficult to setup correctly? I currently am working on making it easier and less error-prone.. This will be available in the next update.. This will be available in 1.3.1!. This is implemented in mup 1.4. You can try the beta using the instructions in #870. Is there any additional information you would like to see? Anything it currently shows that isn't useful?. mup logs has supported tailing and following logs from multiple servers. In 1.3, it will be possible to use the --servers option to list which servers to get the logs from.. The readme now shows this in the example file.. Both options work since Mup 1.3. You can use the --config option to specify which config to use, or --servers specify which servers in the config to use.. This will be available in Mup 1.3.. @LilianaCanPor try running apt-get update && apt-get install -y sudo on the server.. @jeffreyflynt could you please post here the logs from mup deploy --verbose?. This seems to have been fixed.. Please make sure you are using the latest version of mup. A few causes for silent fails have been fixed this month.. It is on the readme in two places, but I can make it more visible.. Version 1.2.2 will display a message if it can not find the pem file.. It is documented in their wiki.. Version 1.2 will improve this:\n\nbetter message if the settings.json is not found\nuses parse-json to give better errors on invalid json\nloads and parse the file before starting the build\n\nI think that fixes all of the remaining issues mentioned here.. In 1.2.2 it will display a better message if the app path is incorrect.. This will be fixed in 1.3.3.. It is not possible.. It is. Switching to nginx-proxy will fix this.. This is fixed when using the reverse proxy for ssl.. You can set the port in the config:\nmeteor: {\n  ...\n  port: 3000\n}. I would like to add this, but it will be a while before I have time to. It wouldn't be difficult to make the changes. If anyone wants to work on a pull request, I would be willing to list what needs to be done and advise how to do it.. Work has started on this: https://github.com/zodern/mup-node. The FAQ in the readme now answers how to fix this.. It should now display an error when it is unable to parse the settings file.. This will be fixed in version 1.2.. This will be available in 1.3.. This will be available in 1.3. To avoid having multiple task lists, it registers an improved copy task with nodemiral which supports host specific variables. It is configured in meteor.servers.<server name>.env instead.\nThanks for your work on this @artpolikarpov.. This has been fixed since Mup 1.0.4.. @miranos please show your mup config and the output from running mup deploy --verbose.. For future reference: There strangely is no documentation on mobile settings in the meteor docs or guide. The only thing I have found is in their cli help where it says:\nSet optional data for the initial value of Meteor.settings\nin your mobile application. A new value for\nMeteor.settings can be set later by the server as part of\nhot code push.. If the build gets canceled during upload, start, configuring or during verify, there shouldn't be any extra files, and if there are they will get removed during the next deploy.. In the next release it will delete the old certificate and key before uploading. The validator currently warns about many problems with the SSL config.. @scheung38 have you solved this?. A lot has changed in Mup over the last couple of years. If you can reopen this issue if you still have the problem.. @xauxatz did you find the cause?. A few situations where it fails silently have been fixed.. @PolGuixe did you solve this?. @THPubs did you find a solution?. @codeHatcher did you solve this?. I have never used meteorhacks/cluster, but I think it will work after #248 is merged.. In version 1.2.4, you will be able to use the --cached-build flag to skip rebuilding.. > My app name had a space on it.\nRemoving the space and then mup setup && mup deploy fixed it.\n\nthe \"certificate\" key is now changed to \"crt\"\n\nMup 1.2 will validate the mup.js. Two of the things it checks for are spaces in the app name, and unknown properties in the config.. The validator will check for http:// or https:// in the ROOT_URL. @keyscores did you solve this?. Thanks for the update.. Duplicate of #244 . Meteor Up now has Let's Encrypt support with auto-renewal.. Thanks @sirpy. \nI made some adjustments to the readme to recommend removing mobileSettings from the config to use settings.json as the mobile settings.. In your mup.js, you can add:\n``\nvar mobileSettings = require('path/to/mobile-settings.json');\n{\n  ...\n  meteor: { \n    ...\n    buildOptions: {\n      mobileSettings: mobileSettings\n    }\n  }\n}\n```\nI don't have much experience building mobile apps with meteor. Is it more common for mobileSettings to be the same as settings.json,  or to be a separate file?. We then would have 3 different values for mobileSettings:\n\nan object\nfalse . It will use the settings.json\na string. It will load a json file from the path.. Thanks for your insight. I agree.\nDepreciate the boolean value\nAllow it to be a path\nIn the readme, change the example to a path and state in a comment that it can be an object. Thanks @mafzst. ssh2 will no longer need to be globally installed with mup@1.2.. I would accept a pull request that adds an env variable to change this behavior..  In 1.3.1, the error code will be 1 when a task list fails.. This is the correct behavior. The first root url is the default which the value in the config overrides. When you are using the built-in mongodb, it adds another MONGO_URL that has the correct database name to override the user provided one.. @sdabdoub did you find the export?. @bilinkis did you find a solution?. @trevordowdle did you find a solution?. @tyvdh did you solve this?. This will be fixed in 1.2.2. Were both apps on the same server?. @gsabran did you find a solution?. Version 1.2.4 will have a --cached-build flag to skip the build.. There is only one bug left, and fixing the tests.. meteor: {\n  ...\n  ssl: {\n    autogenerate: {\n      email: 'email.address@domain.com',\n      domains: 'website.com,www.website.com' // coma separated list of domains\n    }\n  }\n}\n\nI will update the npm package and documentation this weekend.. The npm package is updated.. Version 1.2.2 will display a message if it can not find the meteor app.. @yasinishyn could you please see if this still happens with 1.2.11?\n\nAlso, how can I see more detailed log output with info about what mup is doing in particular ?\n\nThere is now a --verbose option that shows the output from the scripts run on the server.. There now is a --verbose flag that will show the output from meteor build. This issue can be reopened if anyone encounters this problem again.. In the latest version, mup reconfig will update docker args.. @genejr Ubuntu 16 is supported.. Mup supports showing logs from multiple servers, In 1.3, you will be able to get logs from an individual server with the --servers option.\nIf you have the error again, please post it here.. The new reverse proxy available in 1.2.9 doesn't have that vulnerability. https://github.com/zodern/meteor-up#reverse-proxy. I am not able to reproduce this. If buildLocation is set, it shouldn't put anything in temp.. Customizing the docker image created during Prepare Bundle will be available in the next update. You can check the docs to see how it will work. Let me know if this will work for you.. It is available in mup 1.4.4.. It now warns when there is a space in the name.. @maryito did you fix it?. Do you still need help?. This morning I looked into the bug, and it seems to no longer exist.. @cyclops24 did you find how to completely remove the app and database?. @CaptainChemist did you find a solution?. Mup 1.4 allows customizing the nginx config.. mup --config mup-staging.js logs -f --tail 50 works for me.\n~~The config needs to be before logs.~~. > mup logs -f --tail=50 --config=mup-staging.js\n--tail=50 needs to be --tail 50\n\nSame problem also putting config before logs\n\nIs your problem flag provided but not defined: --tail or [x.x.x.x]docker: '<appname>' is not a docker command.. I have done some more testing, and it should work with --tail=50. Both errors have the same cause.. @abernix thanks for making these changes. Would you be able to fix the merge conflicts?. @abernix Thanks. I will merge it later today.\nI am thinking of changing the default port to 3000 by setting the PORT env variable on the app's container. I looked through the meteord images and the images listed here, and they all support overriding the image's default meteor port with the PORT env variable.\n. Did either of you find what was causing this?. Mup 1.3 will support setting server specific env variables, which should be the last thing preventing cluster from working.. Could you please run these commands and post the output here?\ndocker images\ndocker ps -s. Please run the commands and df -h again the next time you run low on disk space.. In the output you posted, it looks like it is only 9.3 MB.  \nCould you please run du -h --max-depth=2 /opt and df -h?. @j6k4m8 could you please run du -h --max-depth=2 /opt and df -h on the server?. @sunlee-newyork /opt/[usr]/last shouldn't be that large unless if the previous version of your app was that size. You can delete everything from that folder except bundle.tar.gz.. Mup 1.3 will support plugins, and one of the plugins is mup-disk, which shows how much is being used where, and deletes unused files. I would appreciate help testing and getting feedback on using plugins with mup.\n1.3 Beta is available. You can install it with npm i -g mup@next. To use the plugin follow these instructions.. In Meteor up 1.3, it started storing the bundle in a docker image (this happens during the Prepare Bundle task) when using a supported docker image. The /opt/<app name>/current and /opt/<app name>/last folders are no longer used. \nThe current folder is deleted during the first deploy when using Prepare Bundle. During the second deploy, a docker image is created with the old version of the code to roll back to if needed, and the last folder is then deleted.\nFor most users, Mup eventually fixes the recursive last folder. Though apps with a docker image that doesn't support Prepare Bundle or disabled it could still encounter it.. You can try mounting them as volumes. The example file in the readme shows how to do that.. This usually happens when the path to the app is incorrect. Version 1.2.2 will display a better error message.. These changes had been added in https://github.com/zodern/meteor-up/commit/b3189fc63bed793ab32d261f700bbdf972f5c871.. @kaamodt did you find a solution?. No. I am trying to identify which open issues still need to be solved.\nIt looks like your configuration was missing a step to install meteor.. Yes. It uses the meteor build command to build the app when deploying.. Two things MUP can do to improve this in the future:\n- [x] give a better error message when meteor is not installed\n- [ ] Add a section on deploying from CI and document that meteor needs to be installed.. This issue can be reopened if anyone still encounters this.. Your pem path has a ~ which wasn't supported. I just released mup 1.2.1 which included a fix for that.. Does it work if you make it an absolute path without the ~?. Where do you see this error? Can you please share the whole log?. This looks like a bug with meteor or your app and not with mup.. @saiy2k what does it show if you run mup deploy --verbose?. The problem is curl: (22) The requested URL returned error: 404 Not Found. There is an issue for it #618.. > Tag latest not found in repository docker.io/library/mongo\nThis is from docker unable to connect to docker.io. Trying again later usually works. \nThe docker error \"flag provided but not defined\" seem to be from the server having an old version of docker. If anyone gets this error, please post the version of docker on the server here. . Mup 1.3 will update docker during mup setup, which will fix the issue reported by @ShrinathGupta .. Next time this happens, could you please run docker ps on the server, and post the output here?. You can install the original mup with npm install mup@0.11.3 -g. The docs are at https://github.com/arunoda/meteor-up-legacy.\nIf you are using Meteor 1.4, https://github.com/andruschka/pm2-meteor doesn't use Docker.. This is added and will be part of 1.2.. I want to include fixes for #195 and #310. Thanks @scarbies. The root cause of the node versions being wrong is if the wrong docker image is being used for the meteor version. Please change it to address the root cause, and then I can merge it.. Yes. Thanks.. I have started working on Meteor up. On Wednesday @arunoda transfered the repository to my account and added me as an owner to the npm package. . @codeHatcher sorry for not replying sooner. I honestly don't know why port 22 didn't work. It should be using scp and the same ssh configuration as all of the other steps. Though there did seem to be a relatively high failure rate while setting up Meteor and MongoDB, so version 1.2.5 changed them to be setup in serial instead of parallel.. I added the documentation. Please let me know if there is anything not clear or missing.. > If mup setup is supposed to be run from a local dev machine\nIt is. A PR to make that clear would be appreciated.. MUP installs everything it needs on the remote server when mup setup is run, but requires Node to be on your local dev machine.. I published 1.1.1 with fixed line endings.. @erperejildo does 1.2.6 work?. This is now fixed in 1.1.2.. An explanation is at https://github.com/meteor/meteor/issues/6270. When enabled it builds everything except mobile apps.. You need to update to version 1.1.2. Try running npm update -g mup. I agree it is confusing. I plan to improve that message.. How did you fix it?. mup uses meteor build. \nWhat version of Meteor are you using? METEOR_PACKAGE_DIRS was added in 1.4.2.. Meteor 1.4.1.3 only supports PACKAGE_DIRS. To use METEOR_PACKAGE_DIRS you will need to update to 1.4.2.. SachaG it uses the env variables on the computer it is deploying from when building.. It looks like ulexus/meteor doesn't support Meteor Up. Try changing the dockerImage to abernix/meteord:base.. I'm glad you fixed it. Was it the version of Node on your local computer? What node version were you using before?. Thanks. This will be fixed in the next version.. > npm update mup -g doesn't install any new version,\nSorry, I had given you the wrong command to update. npm i -g mup should work.\nPlease run docker ps and docker logs worksheets-nginx-letsencrypt --tail 30 on the server and post the output here.. @jetlej please post the full output when running mup deploy.. On the server, try running the start.sh script:\nbash\ncd /opt/<app name>/config\nbash start.sh\nTry going to your website after 5 - 10 minutes. If it looks like the script had any errors, please post the output here.\n. Try increasing the deployCheckWaitTime to 120.. Try running docker network disconnect -f spidermonkey on the server and deploying again.. Please run docker ps on the server and post the output here.. The issue https://github.com/docker/docker/issues/20398 might be relevant.\nWhat version of docker are you using? If it is outdated, can you update it?\nWhat is your docker setup?. I'm not sure how to fix it.\nHere are some more drastic things you can try:\n- Restarting docker\n- Restart the droplet\n- If there are no files or databases on the droplet that you need, you can rebuild the droplet from the digital ocean dashboard. This will remove everything from the droplet. Then run mup setup again.\n. I'm glad you got it working. I created #462 to track supporting Ubuntu 16.\n@bryanlimy  did you change the default shell to zsh?. Yes, for now. Could you create a new issue to support zsh?. I will try to reproduce that.. @djkmiles what was the error from the validator?. Thanks. Could you also please post your mup.js?. Docker currently has a \"Full Service Disruption\" http://status.docker.com/. @jetlej it should work now.. >  DeprecationWarning: Unhandled promise rejections are deprecated. \nIn 1.2.4, you should no longer see this.. Currently there isn't a way to configure the nginx setup without creating your own image, but I want to change that.\nWhat is your SSL setup? There are two different nginx containers that mup uses depending on if you are using let's encrypt or not.. The first step would be to create an nginx config with better defaults (based on the config for mup-frontend-server), upload it to the server on deploy and add it as a volume to nginx-proxy. How large do you need the client_max_body_size to be?. For Let's Encrypt, it uses https://github.com/jwilder/nginx-proxy. Currently there is no nginx config for that so it is the default 1mb.. It works! Thanks.. > would it be possible to use the new nginx container with both ssl solutions? or no?\nI created #458 to track that.. If you have it installed locally, it should be part of the bundle. Try running meteor npm ls bcrypt locally and post the output here.. In version I.2.2 it will only need to be a string.. Technically mobileSettings can be. In the readme, I had added this:\n// Remove this property for mobileSettings to use your settings.json. (optional)\n      mobileSettings: {\n        yourMobileSetting: \"setting value\"\n      },\nI thought that was better than setting it to false to use settings.json as mobileSettings, What is your opinion?. Please post your mup.js.. If you want to build mobile apps when deploying, you can add\nmeteor {\n  buildOptions: {\n    server: '<server url>'\n  }\n}\nIf you don't want to build mobile apps, add serverOnly: true to the buildOptions.. This is available in 1.2.9: https://github.com/zodern/meteor-up#reverse-proxy. I can reproduce this and will look into the cause.. In the cloudflare dashboard, go to Crypto and try changing it to Full or Full (strict) . > Is there a way to ensure that the Let's Encrypt certificate is working?\nIf your website works when it is set to Full (strict), you know Let's Encrypt is working.\n\nAny idea why this is happening?\n\nIn the cloudflare support, there is two articles on fixing this for Wordpress and Joomla. They seem to say it is from having mixed content.. It currently is possible to add docker args to publish additional ports in your config. It wouldn't have ssl though.\nIn your mup.js file, add:\n```\nmeteor: {\n  docker: {\n    ...\n    args: [\"-p 8080:8080\"]\n  }\n}\n``. You can find it here: https://github.com/arunoda/meteor-up-legacy/.arunoda/meteor-upwas renamed toarunoda/meteor-up-legacy.. I am too with no problems. Though last week I went through all of the open issues, and there are some that  had problems with 16. . @mackbrowne it would be appreciated if you create a PR to add arecommended minimum requirementssection.. @janzheng Could you please post your app logs frommup logs --tail 100`?. @enzolutions Meteor Up has an option to force ssl. There also is a meteor package which does the same thing.. Are you able to run the app locally after seeing this error?. Try building your app and see if it works:\nmeteor build --directory ./.test-build --architecture os.linux.x86_64 --server-only. It might be a bug with meteor then.. > I've always had a lot of trouble with meteor up\nWhen you have time, would you mind sharing what troubles you've had? My goal right now is to make meteor up more reliable and less error prone.. Thank you for working on this! I should have time to look at it early next week.. Tomorrow I will try using the reverse proxy.\nHere are some thoughts:\n- We currently have a proxy module that basically does nothing. I think you should use that instead of adding the nginx module.\n- You could move the list of domains from meteor.nginx.domains to proxy.domains and nginx to proxy.sharedConfig (there probably is a better name than sharedConfig). That way all of the configuration for the reverse proxy are in one place and it is obvious when the reverse proxy is being used.\n- When would the config options meteor.nginx.name, nginx.name, and mongo.dbDir need to be changed?\n- mup setup should setup, upload the env variables, and start the shared proxy if needed.\n- ~~We have the mup reconfig for the app. I think we should reuse the naming and have mup nginx reconfig instead of mup nginx envconfig~~ Edit: mup reconfig is just an alias for mup meteor envconfig. mup nginx envconfig is fine.\nI am very excited about this feature, and you did a great job implementing it!. yes. > Do you want me to do code changes along the lines of the \"thoughts\" you mentioned above?\nIf you have time in the next couple days, that would be great!\n\nit is my understanding that we are going to prioritize this PR and then modify my PR #496 to address the changes. Is that correct?\n\nI should have given more than a one word answer. By changes are you referring to what we discussed in #496 or also to my \"thoughts\" I wrote here? If it is the former, yes.\n. Thanks @shaiamir.. The migration section in the readme applies to migrating from mupx to mup. If you are using the latest version of mup (1.2 or newer), it will warn you of most problems in your mup.js file.\nIn your mup.js, you will want to change the docker image to abernix/meteord:base. . @edemaine it is now fixed in master. One option to access Mongodb from other servers might be this: https://docs.docker.com/engine/admin/ambassador_pattern_linking/. The update message is shown because you are using an old version of mup. Run npm i -g mup to update it. Newer versions have a better message.. Could you please explain why you need this? What are you trying to do or what that is not working?. Are you able to automatically always run meteor npm install before mup deploy?. > Would it be best to outline how to add meteor up to a CI system?\nWe do need to do that.\n@WayneUong would a predeploy hook as proposed in #65 work?. Hooks will be available in Mup 1.3. I would appreciate help testing it.\nYou can install the beta with npm i -g mup@next. Then, in your config add:\n```js\n{\n  //... rest of config\nhooks: {\n    'pre.deploy': { localCommand: 'npm install' }\n  }\n}\n```. If you are not using ssl, you can start your own nginx container on the server.\nIf you are using custom ssl certificates, you can fork https://github.com/meteorhacks/mup-frontend-server and modify it's nginx config.\nEventually it will be much easier to customize the nginx config.. Yes. If you fork it and make your custom config part of the image, it should be fine.. You will need to publish it to the docker hub.\nThen, in your config add this, and change it to the name you used when publishing to the docker hub.\njs\nmeteor: {\n  ...\n  docker: {\n      // (optional) Only used if using your own ssl certificates. Default is \"meteorhacks/mup-frontend-server\"\n      imageFrontendServer: 'meteorhacks/mup-frontend-server'\n  }\n}\nI'm sorry it isn't any easier right now to customize the nginx config.. The instructions I gave you were for if you were using the mup-frontend-server. I am sorry if you went through extra work because of that. If you are using nginx-proxy, it is much simpler. You can fork meteor-up, and add your modifications here.\nRun npm install -g in the folder containing your modified version of meteor-up to use your version. Run mup deploy to update the config.. yes, or copy it from a file.. Mup 1.4 supports customizing the nginx config. You can try the beta using the instructions in #870. The docs for this feature are here.. In #448 there was a similar problem. I'm not able to reproduce this. Please post your mup.js file. Also, which image did you use for the droplet, what size is it, and did you select any of the additional options? Did you do anything on the droplet besides running mup setup and mup deploy?. I encountered this error for the first time today, and the PR fixed it.. This is a duplicate of #391.. Right now the only option is to use your own docker image.. Yes.. You should modify base/DockerFile.. Your right, it currently doesn't do anything. After I finish improving the tests, I need to go through the documentation.\nIn issue #21 there is this comment that explains how to enable it.. In 1.2.4, the default path for builds uses the app's absolute path as a seed when creating the uuid, so the build path will always be the same for the app. As long as you don't move the app there will only be one bundle remaining after builds.. Running mup restart should start the proxy again.. It is a temporary fix.  I will add auto-restart next week.. As soon as the pull request is merged.. Version 1.2.3 was just published with a fix.. There is something already running on port 80. It looks like you were using mupx. Did you stop the app before switching to mup?. It would work when running mup init. It's not perfect, but better than nothing.\n\nMaybe change mup.js to mupconfig.js?\n\nI have been considering that.\nAlso, this seems to only happen in Command Prompt. In Windows 10 Creator's update, Power Shell will become the default shell. \n.  > How can I see the content of the volumes?\nIf you ssh on to the server, you can use the command line to view the volume's content. Volumes are located at the host path you provide in the config. Is that what you are asking?\nThe data does persist.\nVolumes should be better documented in the Readme.. @Kolhor could you please share what the problem was?. @Twisterking did mup setup ever finish successfully?. Those errors during setup might have happened before mup got to starting MongoDB. \nI plan to have mup retry a task if one fails from connection problems.. Thanks for fixing these issues. \nCould you please move the docs to another pr? I want to get the nginx changes merged soon, and the docs will need some changes before merging.. Maybe something like this:\ngit branch docs\ngit reset 30b0beaddf19734a2bfd0b4a767e3aa0050cfeb1. I am testing it now. It will take a while since the internet here has been very slow the past week.. ~~\u2705 SSL Certificates works~~\nEdit: Somehow I used the wrong branch. The app container should use expose instead of publish when using uploaded certificates.. Only if using let's encrypt. It now also needs to work when using custom certificates.. yes. The app needs to have a VIRTUAL_HOST env variable for nginx-proxy to work. I've tried using wildcard domains and regular expressions, and I encountered the same problem as in https://github.com/jwilder/nginx-proxy/issues/720 for both.. It is the same as autogenerate.domains. Before we didn't need it for custom certificates, and it would be a breaking change.\nAlso, the certificates need to be named for the VIRTUAL_HOST, or we need to set the CERT_NAME env variable on the app's container.. Also, the .crt and .key files need to have the same name.. > Uploaded SSLs would be for the url located in config.meteor.env.ROOT_URL correct?\nI just did some testing with the todos app deployed with mup and no ssl:\nI have todos running at a.mydomain.com. ROOT_URL is a.mydomain.com\nI added the following dns entrees pointing to the same server\na.mydomain\nwww.a.mydomain\nb.mydomain\nAnd they all worked. So we can't use ROOT_URL to accurately know all of the domains used to access the app.\nWe need to more time to get this right. I think that for now we should merge everything else. Could you please add a commit to remove the ssl changes from this PR?. Auto-restart of the proxy was added in the last update. The other features are still needed.\nWe have three options for the using nginx-proxy for custom certificates:\n1) Wait until a new version is released that fixes using regexp or using wild cards.\n2) Require domains to be listed. If the list exists, use nginx-proxy, otherwise use the current container\n3) PR #465 adds support for using custom certificates with nginx-prox for the shared reverse proxy and makes the proxy and let's encrypt containers much more customizable. Also, there shouldn't be much of a difference between using it and the current setup when there is only one app on the server. Once it gets merged, I am thinking of eventually making it the default after it gets well used instead of duplicating all of that once or twice for let's encrypt and custom certificates. Also, when there are improvements to the ssl/nginx setup, they will only need to be implemented once.\nTo transition to using the shared proxy, meteor.ssl could be moved to proxy.ssl to enable using the shared proxy. That also has the side effect of moving parts of the config not directly related to meteor out of meteor to make it easier to support deploying Node or other types of apps in the future.\nIf we go with 3, then uploading the nginx config would still be needed.\n@shadowcodex what is your opinion on this?. Thanks for working on this @shadowcodex. With mup 1.4, option 3 is finished, and these features will be available.\n@micahalcorn, could you share more details about your nginx config? Why do you need a fully custom nginx config?. Thanks @micahalcorn. Currently the reverse proxy doesn't allow that much customization. The docs for the custom nginx config is here. Could you please create a new issue for this?. This is a great start!\nPlease move everything in your gh-pages branch to the /docs folder in the master branch.. A commit is fine. I would like to discuss some of the content first.\n\nOne thing that concerns me is is mup really the fastest way to deploy meteor apps? Compared to other options of deploying to a vps, it probably is. But I don't think it is compared to using a PaaS.\nPlease remove the x from the \"Heads up!\" box\nYou can also remove the navbar since it only has the one link.\n\n\nYou are free to deploy to anywhere over ssh. You are not tied to Galaxy.\n\nI would prefer it to be more broad, that you are not tied to a specific platform or infrastructure as a service.. > if it is live already...\nWithin 15 - 25 seconds of the app container starting, I think it checks if the app is live every second until deployCheckWaitTime runs out. I need to verify that.\n\ninstead of having the deploy tool keep track of errors \n\nTo do that it could check if the container has restarted 2 or more times and rollback immediately instead of waiting the full time.\n\nmeteor deploy doesn't have this right?\n\nAs far as I know, galaxy doesn't. If the app fails to start, it will display a 503 error to anyone who visits the app until a fixed version is deployed.\n. Most of the problems with the deployCheckWaitTime were from it having to include the time to install the app's npm dependencies. Starting in mup 1.3, with certain docker images, the app's npm dependencies are installed during Prepare Bundle before the app is installed.\n\nCheck if the container has restarted 2 or more times and rollback immediately instead of waiting the full time.\n\nThe deploy validator checks if the app is running every second. In mup 1.4, if the container is restarting during at least 10 checks, the app is roll backed immediately.. We could add a --verbose flag. The spawn process for the meteor build would have to have it's stdio set to 'inherit', and set the METEOR_HEADLESS env variable.\nI also would like the --verbose flag to show the output from scripts run on the server in real time.. Are you using mup or mupx? It looks like the server has the wrong node version.. @jyoti-openair what meteor version are you using? It looks like you are using Meteor 1.4, which mupx doesn't support. If that is the case, you will need to migrate to mup. The readme has a migration guide.. @jyoti-openair did you also have mup setup ssl? That would have been using port 80.. It's missing meteor.env.PORT, but if that was set mup shouldn't have been using port 80.. @abeaudoin2013 what dockerImage is in your config? If you are using meteor 1.4, it should be abernix/meteord:base. If you run docker logs <app-name> --tail=50 and docker logs <app-name> --tail=100 on the server, do they give the same output?. Thanks for catching that.. Run docker ps on the server and see if any of the containers have restarted.. In the log posted by @maryito it didn't have enough time to finish building bcrypt. Try adding another 60 seconds to the deployCheckWaitTime. Are you able to ssh into the server?\nHow many times did you try to deploy and got that error?\nDo you have the progress bar enabled in your config?. That should work. Remember to have it install meteor first.. Thanks. Should it also disconnect the other networks from https://github.com/zodern/meteor-up/blob/master/src/modules/meteor/assets/templates/start.sh#L115?. The problem is that whenever list.executeScript is used it runs the script in the default shell instead of bash.. It is possible to register new commands with nodemiral. We could need to create a new command that forces the script to be run in bash.. Thanks @shadowcodex . In the package.json, it says the license is MIT. I would like to add a license file to make that more obvious. I probably need to ask @arunoda who the copyright holder is. On arunoda/meteor-up, it is MeteorHacks, but for most of the kadirahq projects it was kadirahq.. I removed the wiki.. If you use custom certificates instead of let's encrypt, it will work.  . I just found that it doesn't force ssl when using let's encrypt: https://github.com/zodern/meteor-up/blob/master/src/modules/meteor/assets/templates/start.sh#L90.. Are you using custom certificates or let's encrypt? I think the nginx container used for let's encrypt does this by default.\nYou can add the force-ssl package.. Yes. Mup 1.3 will be able to redirect http to https.. @sirpy, could you please change it to delete the directory instead?. Thank you @sirpy . The spawn error usually happens when meteor is not installed, or your path to the app is incorrect.. Try deleting everything in /var/meteor/test/.meteor/local/dev_bundle. . I'm glad you got it working!\nI added a section about the spawn error to the troubleshooting guide in the readme.. Meteor requires a MongoDB to work. Mupx would set MONGO_URL for you.\nAdd the mongo config to your mup.js:\n{\n...\nmongo: { // (optional)\n    port: 27017,\n    version: '3.4.1' // (optional), default is 3.4.1\n    servers: {\n      one: {},\n    },\n  }\n}\nAnd set MONGO_URL to 'mongodb://localhost/meteor'\nAnd then run mup setup and mup deploy. > MONGO_URL=mongodb://localhost/meteor stopped working form me\nWhat do you mean by it stopped working? Is mongodb running on the server? You can find out by running docker ps on the server and checking for a container named mongo.\n\nSo I need to setup one now manually? I tough meteor does it for you.\n\nIf you add mongo to your config and run mup setup, meteor up will setup MongoDB for you. Meteor only does it during development. . nginx container for let's encrypt:\ndocker logs <appname>-nginx-proxy\nnginx container for custom ssl certificates:\ndocker logs <appname>-frontend\nRun the command on the server.. With the new reverse proxy, it is mup proxy logs, and you no longer need to ssh into the server.. If you are deploying both apps to the same server, the mongo port needs to be the same.\nPlease show more of the logs.. @ivanthemeh at what step of the deploy process does it give you an error? If you run docker ps on the server, it should show something like 0.0.0.0:3000->80/tcp under PORTS, where 3000 would be the port you set.. At what step is it hanging?. @iAssureIT I just released 1.2.4. Update mup with npm install -g mup, and try deploying with mup deploy --verbose. With the verbose flag it will show the output from meteor build. Are you able to run app#2 locally?. That's strange meteor build is exiting with an error code at that point in the build process.\nPlease try running meteor build ../mup-build --architecture os.linux.x86_64 --server-only\nIf that seems to run successfully, you can tell meteor up to use that build.\nIn your config, change meteor.buildOptions.buildLocation to ../mup-build and run mup deploy --cached-build.. It uses simple_le which only uses webroot.. Try restarting docker with service docker restart. Thanks for fixing this.\nI was looking for a fix that would prevent similar issues from happening again.\nIt is possible to register custom tasks with Nodemiral. \nWe could add a new task that runs session._applyTemplate, wraps the script with:\nshell\ncat << COMMANDEOF | bash\n<insert script>\nCOMMANDEOF\nand then calls session.execute\nAs long as the default shell supports that syntax for piping a here doc (zsh does), it will run the script in bash. I'm not 100% sure this will work though.\n@thsowers would you be willing or have the time to try?. Thank you @thsowers . A similar error was reported in https://github.com/meteor/meteor/issues/7401 when using the same package. You could try manually fixing the bin path as mentioned in https://github.com/meteor/meteor/issues/7401#issuecomment-232421798. \nAnother option might be to change the docker image to abernix/meteord:binbuild. It's fixed in npm 5.4.0, which Meteor 1.6 might use.. I created a mup plugin that fixes the bin paths: https://www.npmjs.com/package/mup-fix-bin-paths.. @stephen-mi11er did it show Fixing bin paths for sshpk?. When running mup deploy, it should show Fixing npm dependencies bin paths and list any npm packages that it fixed before it shows Building App Bundle Locally.. You are using an old version of meteor-up. Please update by running npm i -g mup. @maxlibin are you still having problems?. There are a few docker images that already have graphicsmagick installed.\nhttps://hub.docker.com/r/oleurud/meteor-graphicsmagick/\nhttps://hub.docker.com/r/qoxinc/meteor-graphicsmagick/. @maxlibin You can run these commands to see what is using the space:\ndf -h\ndu -h --max-depth=2 /opt\ndocker images\ndocker ps -s. @WayneUong The next time the logs gets too long, try running DEBUG=* mup logs. There will be a line starting with mup:utils getDockerLogs command: that will contain the exact command it runs on the server to get the logs. Please try running the command and let me know if it shows the same logs as when running mup logs. . You can add the --verbose flag to see what meteor build is doing.. If you run docker logs <appname> --tail=50 on the server, does it do this too?. Endpoint not found is normal.\nThe real problem is Error starting userland proxy: listen tcp 0.0.0.0:80: bind: address already in use. Are you deploying multiple apps to the server, or do you have something else running using port 80?. Looks like it is missing part of the error message. Do you get the whole error when running mup logs --tail=200?. Run mup docker ps, and make check that there is a running mongo container and it is exposing port 27017.. I created a room on Gitter: https://gitter.im/meteor-up/Lobby. \n\nI'm getting\nerror unknown command ps\n\nIt is a newer command. You probably need to update mup with npm i -g mup.. mup reconfig does everything mup deploy does except build and upload the app.. Thanks. Currently it doesn't. Mup 1.3 will focus on improving deploying to multiple servers, and I'm hoping to add load balancing.. Are you using custom certificates or let's encrypt?. I just setup ssl for one of my projects, and it worked perfectly.\n@bennygenel and @nloui, could you please run these commands on the server and post the output here or in a gist? Also, please post your config.\ndocker ps\ndocker exec <app name>-nginx-proxy cat /etc/nginx/conf.d/default.conf\ndocker inspect --format '{{ .NetworkSettings.IPAddress }}' <app name>\n. From what you showed me everything seems to be running correctly.\nYou can look at the nginx logs with docker logs <app name>-nginx-proxy.\nDid using the load balancer with let's encrypt work in the past?. There are two problems:\n1) Receiving the 503 nginx error page makes it think the app successfully started. The next version will include a fix.\n2) The reason it returns the 503 error usually is from let's encrypt unable to verify the domain. You can view the logs using  docker logs <app-name>-nginx-letsencrypt and docker logs <app-name>-nginx-proxy to try to locate the cause.\n. I published a 1.2.7 beta that fixed a few bugs with let's encrypt. You can install it with npm i -g mup@next.. 1.2.7 has been released for a month. If you still have problems, feel free to reopen this issue.. The second app has mup setup ssl, which uses port 80.. Where are you seeing 503 Service Temporarily Unavailable nginx/1.11.10?. Could you please share your two configs?. One problem is they are both using ssl.autogenerate. If you remove it from one of them, and then run mup reconfig for both, it should work. Currently only one app on a server can have mup setup ssl.. Not yet.. It's now possible in 1.2.9 with the new reverse proxy!. Thanks!. Did mup setup finish successfully?. If you run service docker status on the server, does it say it is active? If it is, how long was it active in relation to when you deployed?\nTo update the version of npm, you would need to use a docker image with a newer npm version.\nIf you are using a server with 512mb ram, or hosting multiple apps on the server, you could try increasing the server's ram.. Do you remember what version were you using before? Could you please share the meteor section of your config?. @nizulzaim could you please share the meteor section of your config? Is ssl also not working for you?. I just published 1.2.6 which fixed the warning appearing when it shouldn't.. An alternative would be using the child_process built-in module and running it in your server code.. @brylie the ssl property in your config is probably in the wrong location. You can look at the example config to see where it should be.. It is implemented, but missing from the validator.. There is a feature request for meteor to ignore files: https://github.com/meteor/meteor/issues/6002. @tomtom87 I want to make sure I understand your situation: ELB is handling ssl, and you want to use the force-ssl pacakge. Is that correct?\nIt should be possible. The warning about using force-ssl does not apply for you since ELB is handling ssl, so you can safely ignore it (I will remove the warning in the next version). If you remove meteor.ssl from your config, you will no longer have the 503 error.. @malikperang Do you want a different MONGO_URL for each server?\n@IDCOLL It does work if oplog is enabled for the database. The built-in Mongo does not support oplog.. Node should be back up now.\nIn the future, you can set the NODEJS_ORG_MIRROR env variable in your config.. You are using an old mup version. Update using npm i -g mup and try again. Version 1.2.5 had some changes to try to fix this.. @mroftalp the command should be npm uninstall -g mup. Could you please share your config?. @JohnAllen do you know what it was in your config?. Did the app's logs show if app crashed or any indication on why it restarted?. Are you trying to access it using port 3000? If you are, you need to add PORT: 3000 to meteor.env in your config.. Could you save it to a file using something like echo $SSH_KEY > /path/to/ssh/key/in/config?. Sorry, I should have been more clear. You can add a step before mup setup for Gitlap Pipeline to save it in a file from the env variable.\nyml\nDeploy:\n  image: node:latest\n  stage: Deploy\n  script:\n    - curl \"https://install.meteor.com/?release=1.4.2.6\" | sh\n    - chown -R $USER ~/.meteor\n    - chown -R $USER .meteor/local\n    - npm install -g mup\n    - cd .deploy\n    - echo $SSH_KEY > ./ssh_key\n    - mup setup\n    - mup deploy. meteor build ignores files and folders starting with a period, so if the ssh key is in .deploy it won't be part of the bundle, or you could put it in a file outside of your app's folder.. Someone could create a plugin to do this.. There have been several updates in the past month, but the authentication should work the same. When you logged into the droplet did you specify the key with ssh -i path/to/key/in/config root@address ?. @erperejildo when deploying from a CI, it's okay to run meteor as root. Meteor always shows that warning when it is. Without settingMETEOR_ALLOW_SUPERUSER, it would also show this warning and not build the app.. The /opt folder doesn't exist. Your app will need to create it first.. Please install the 1.2.7 beta with npm i -g mup@1.2.7-beta.0 and try again. It fixed a few bugs and problems with using let's encrypt.. @nick-preda please run mup docker restart and try deploying again.. Thanks for adding this @lawrentiy. Sorry I didn't look at your PR sooner.\nCould you please explain your use case for changing the ip and port?. Mup 1.4 allows customizing the nginx config.. Thanks for fixing this. . The problem is Error starting userland proxy: listen tcp 127.0.0.1:27017: bind: address already in use. There already is something using port 27017.. Thanks!. @WayneUong could you please give more details? Do you want to shutdown the app, or cancel while deploying the app?. abernix/meteord:base requires imagePort to be 80 for it to work. You can use https://github.com/abernix/spaceglue instead, which uses 3000.. With mup 1.2.9, it should work with almost any number for imagePort. If you want to change what port the app is accessed on, you want to change env.PORT instead.. > I had a running domain+https+meteor. Now, the has certificate expired and has not got automatically renewed.\nIt is a bug in the docker image mup uses for let's encrypt: https://github.com/JrCs/docker-letsencrypt-nginx-proxy-companion/issues/199. A work around is to delete /opt/<appName>/certs on the server, and then run mup reconfig, forcing it to regenerate the certificates.. Let's Encrypt uses port 80 to verify that you own the domain. If the bug with renewing the certificate gets fixed, it will need to use port 80 again in ~60 days.. Mup uses https://github.com/jwilder/nginx-proxy and https://github.com/JrCs/docker-letsencrypt-nginx-proxy-companion for Let's encrypt. Everything they need is part of the docker image.\nI updated the instructions for setting up let's encrypt and added a section under troubleshooting.\nSome ideas on what can be done to improve this:\n- [x] Add the command mup proxy le-logs to view the logs of the Let's Encrypt container\n- [x] Some of the problems with nginx-proxy and docker-letsencrypt-nginx-proxy-companion are caused by outdated versions of docker. mup setup should make sure docker is a specific version.\n- [ ] Add mup proxy le-status to see what certificates have been created, are in progress, or have errored.\n- [ ] Add the command mup proxy ssl-troubleshoot to check for common problems.\nAnother possible cause of let's encrypt not working is using a CDN such as cloud flare.. The problem is Error starting userland proxy: listen tcp 0.0.0.0:443: bind: address already in use.. Make sure there is nothing else running on port 443, such as another nginx instance.. It seems the app can not successfully start. Make sure you are using the correct docker image for the app's meteor version.. The settings.json file is used for your app.\nThis version of mup uses a mup.js file instead, which allows you to use everything available in Node.js.\nTwo options are:\n1) Storing in environment variables. You can use process.env.VARIABLE_NAME to access it.\n2) Have a secret.json file. At the top of your mup.js file, add var secret = require('./secret.json'), and access it with secret.propertyName.\n. Is this while building the app, or when starting it?. Sorry, I misunderstood your question in #595. Information on using settings.json is in the Meteor docs at http://docs.meteor.com/api/core.html#Meteor-settings.. I just released 1.2.8, which fixes this. . What version of Meteor are you using?. @jamezilla0 from the mup output in your first post it looks like you are using an old version of mup, which is now at https://github.com/arunoda/meteor-up-legacy. This version uses mup.js instead. You can look at the readme to see what config options are available. Then run npm update -g mup to install the latest version.\n@Sphincz that is the same issue as in #531. Meteor Up shouldn't be setting the content-security-policy header. Are you sure you are not using the browser-policy or similar package?. You can run mup setup --verbose to see what it is doing on the server.\nDoes it get stuck at that step, or does it exit?\n. Try running DEBUG=* mup setup --verbose. Could you also please share your config?. @embub did you get it to work?. It will be down while running the task list Start Meteor. I am looking into ways to reduce it.. This has been improved in 1.3, 1.4, and 1.4.5.\nIn 1.3, installing the app's npm dependencies was moved from starting the app to a new task called Prepare Bundle, which builds a new docker image containing the app's bundle and npm dependencies. One benefit is this allows the app to start much faster.\nIn 1.4, Verifying Deployment was improved to stop and revert the app early if it spends a large amount of time restarting due to the app repeatedly crashing. If the deployment failed, it is reverted about 30 seconds after starting the app instead of waiting the full time in deployCheckWaitTime + 15 seconds.\nThe app is normally stopped during Prepare Bundle to avoid running out of memory when building the docker image. 1.4.5 adds the option app.docker.stopAppDuringPrepareBundle which disables that when set to false. When disabled, the downtime is only the amount of time it takes to create the docker container and for the app to start, which is usually a few seconds.. Duplicate of #205. @PArch there currently isn't a way, but it wouldn't be difficult to add. Before adding another option to the config, I would like to know why you need to change the directory.. You can install an older version with npm i -g mup@<version>.\nI would like to know why it isn't working for you. I reinstalled a server, and then deployed an app to it with let's encrypt enabled, and it worked. \n- Can you please share your config?\n- Were you able to use let's encrypt with that app with an older version of mup?\n- Do you have the correct DNS entrees for each domain listed in meteor.ssl.autogenerate.domains?. The certificate expired on May 10th.. The best option is to use a docker image with wkhtmltopdf already installed. I will be working on making that easier, but for now you can fork the image you currently are using, add a step to install wkhtmltopdf, publish it to the docker hub, and in your config set it to use your image.\nAnother option is to have your app check if it is installed, and if not use the built-in module child_process to run the command or a script to install it. Using a docker image would be better.. Is the app also on port 3200? Are you using Let's Encrypt or the reverse proxy?. I am not able to reproduce this. Could you please try with the mup 1.4 beta: #870 ?. Since I am unable to reproduce it, I will close this issue. If anyone encounters this again, the issue can be reopened.. What package are you using to minify js?. It reuses the build from the last time you deployed without the --cached-build flag. The bundle doesn't change until you deploy without that flag. It was mainly intended to be used after the bundle failed to upload from a connection error.. The readme has a troubleshooting section for this.. I just pushed some changes to make it more clear.\n@zeekun There wasn't enough time for npm install to finish. Increase meteor.deployCheckWaitTime.\n@haibo32012 @ZubMono and @tomtom87 Make sure you have the latest version of mup (mup --version should show 1.2.9 or newer; update with npm i -g mup), and then run mup deploy --verbose. Please post the output after Started TaskList: Start Meteor . Thanks for creating this. In 1.2.9, it adds the --insecure flag instead when running curl to avoid this problem.. @AlmogRnD could you please share your config?\nAlso, it would be helpful if you and @mylsb could give me:\n- The docker version on the server\n- List of the env variable names from docker inspect <app name>. I added that to fix problems with verifying deployment for apps using Let's Encrypt. Is your app using it? If not, I can modify it to only fail when using Let's Encrypt.. @ovidyou I instead created the zodern:mup-helpers meteor package to fix this. The solution I mentioned above would have only fixed this for apps not using let's encrypt, but this package works for all apps using mup. Update mup with npm i -g mup, add the package, and redeploy.\n@tomtom87 Please add the --verbose flag and post the output here from the verify stage.. I released 1.2.10 which removes the HTTP status code requirements.. What version of mup are you using (mup --version)?. I am planning to look into it.. A PR would be greatly appreciated!\nI went through the swarm tutorial today to get an overview of what is involved and how it works.\n1) You probably will need a way to know which servers are a manager. The servers that are a manger could have manager: true in the config.  Also, meteor.servers would no longer be needed, and instead you could have a property with how many app containers to run.\n2) To setup docker swarm, you will want to modify docker-setup.sh. You can run a command on an individual server and get the output using runSSHCommand. example. info is an object from servers in the config.\n3) You are right that it would mostly involve rewritting that section of start.sh. \n4) mup installs docker the first time mup setup is run, and usually it never gets updated again on that server. What I would like to do is have docker-setup.sh check if docker is a specific version, and, if it is not, install that version. Or it could have a minimum docker version, and update docker if it is older than that version. This way we always know what docker features are available. \n\n@zodern are there any specific issues you expect to run into?\n\nSome potential edge cases.\n1) App 1 is deployed to servers 1, 2, 3, and 4, and app 2 is deployed to servers 4, 5, 6, and 7. Is it possible to have the servers from both apps create 1 swarm, or is there another option?\n2) It would need to handle the servers the manager nodes were on being reinstalled, or destroyed, or removed from the list of servers but still running as managers.\nIf you have any questions, please ask them.. I currently am planning to implement this in Mup 1.5.\n1.4 will have some of the initial work.. @adamgins The code is in the dev branch, and you can view the current status in #976 and #893. I am hoping to release it in January.. @adamgins it is still planned.. Thanks for offering to work on this. I don't think this feature is needed since future versions of Mup will have\n- zero downtime deploys. \n- Custom nginx configs\n. It is not possible to access meteor shell. What would you use it for?. @Joeblockmark do you know what fixed it?. @Joeblockmark The error is from another app, nginx proxy, or something else running on the server using port 80. \nimagePort is the port the app uses inside of the docker container. What you probably were wanting to change is meteor.env.PORT, which is the port your app is accessible at.. Make sure meteor.path in your config is correct. Right now it is relative to where you run mup instead of relative to the location of the config.. It looks like a problem with how npm installed it. Did you change the node version since installing mup?. For app2:\n- Remove mongo from the config\n- Change the env.MONGO_URL to mongodb://mongodb:27017/<app1 name>\n- Your meteor.docker object should look similar to:\njs\n    docker: {\n      // change to 'kadirahq/meteord' if your app is not using Meteor 1.4\n      image: 'abernix/meteord:base',\n      args: [\n        '--link=mongodb:mongodb'\n      ]\n    },. I added it to the documentation for Mup 1.3. Something is using port 80. You can run mup docker ps to see if a container is using it.. Ssh into the server, and run netstat -tulpn | grep :80. It will show you what is using port 80.. Are you getting the same error? Does netstat -tulpn | grep :80 still show anything?. Duplicate of #260. Thanks. This is fixed in Mup 1.3.. What meteor packages is your app using?. It looks like you are missing a package to minify js or css. The default package is https://atmospherejs.com/meteor/standard-minifiers-js. I will try to fix running on Node 4.. @mattsouth It worked for me on Node 4. If you switch back to Node 4, what does DEBUG=mup* mup setup --verbose show you? Also, could you please share your config, and the exact version of Node 4 you used? . Duplicate of #531.. I don't think this is a problem with Mup. It would be better to ask in the Meteor forums.. It might be from running mup on the same server you are setting up. Does it work if you run mup setup on a computer other than the one you will deploy the app to?. @ktquiet  Your mup.js file is getting bundled with the app. Try moving it and the settings.json to app/.deploy/mup.js and adjust the paths in the config.. @GenetixMedia it looks like you are using an old version of Docker. You can follow the docker install instructions to update https://docs.docker.com/engine/installation/linux/docker-ce/ubuntu/.. I made a couple adjustments to Mup 1.4 that might help reduce this error. You can try the beta by following the instructions in #870 .. Mup 1.3 will be able to redirect http to https.. Try increasing meteor.deployCheckWaitTime. https://github.com/zodern/meteor-up#verifying-deployment-failed. It usually doesn't need to be any higher than 120 - 300. Does your app use many native modules?. There's not really an easy way to differentiate them.\nMup doesn't show enough of the logs when verifying deployment fails (that will be fixed in the next version). If it didn't work with the deployCheckWaitTime set to 1400, the app probably crashed at least once.\nTo see the full logs, you can run mup deploy in one terminal window. Then, when it starts the Verifying Deployment task, run mup logs --follow in a second window.. Any contributions are appreciated. I am using projects for a short-term road map.. Mup 1.3 will be able to redirect http to https.. @markreid it is available: http://meteor-up.com/docs.html#redirect-http-to-https. Please run npm ls -g mup and npm ls mup and paste the output here.. Try running npm i -g mup@1.2.11. abernix/meteord is using Node 4.8.4, which has the fix.. Mup 1.3 will be able to redirect http to https.. @metus08 did you find a way to fix it?\n\nBind for 0.0.0.0:8080 failed: port is already allocated.\n\nA process is already using port 8080.. The abernix/meteord image is a fork of meteorhacks/meteord. meteorhacks/meteord had that message and it hasn't been remove yet.. You could try using the reverse proxy. You could configure it for the one app using Let's encrypt, and instead of changing the app's port, change the proxy's port. Contrary to what the docs currently say, it is only used for apps that have proxy.domains set.\n. That error is from the docker image having an older version of Node than what meteor supports. Does the app on both computers use the same Meteor version, and is the docker image the same in both configs?. What mup version are you using (mup --version)?\nThis is similar to #320 and #137.. I tried this with the 1.3 beta, and the error code is now 1 when it is unable to load or parse the settings.json.  Though it still is 0 when a task list fails, which will be fixed by #320.. You can try deploying again, which will upload a new bundle. This should be fixed in the next version of mup.. Follow the instructions in https://github.com/zodern/meteor-up/blob/ee017150591f53f7f85d0a4081a1b6018230e437/README.md#ssh-based-authentication-with-sudo. You can use the abernix/spaceglue docker image, which supports it.. Thanks for fixing this @taromero. Sorry I didn't look at it sooner.\nIn mup 1.4, meteor.ssl is depreciated in favor of the reverse proxy. The reverse proxy doesn't have this problem.\nI will merge this once the conflicts are resolved.. The name is used for the folder it's files are stored in, the name of the docker image, and, if you are using the built-in mongodb, the name of the database.\nBefore changing the name, run mup stop. Then change the name and run mup setup and mup deploy. If you are using the built-in mongo database, it will create a new database for the app.\nThe docs on changing the app name need to be improved.. @giany what command did you use to start the container?. @ntoka did you check the logs (mup logs --tail 100)?. @marcsowen sorry for not looking at your PR earlier.\nIt looks good. There is only one change that needs to be done before I merge this. It throws an error when app.ssl is undefined.. @deenoize please fix the merge conflicts, and I can then merge it.. @aliogaili mup 1.4 will support using a custom nginx config, and should have a much better default config..  > mup 1.4 will support using a custom nginx config\nThis is now implemented.\nWhen you find values that work, you can reopen this PR or create a new one.. The comment will be fixed in 1.3. https://github.com/0rpc/zerorpc-node/issues/35\nYou will need to create a docker image that uses abernix/meteord as the base and installs zerorpc dependencies.. It will only regenerate the certificates if they expire in less than a month. You need to leave the ssl object, otherwise it will stop working.. The reverse proxy has better ssl security than using meteor.ssl.. In mup 1.4, meteor.ssl is depreciated in favor of the reverse proxy. Mup will warn about any depreciated properties in the config.. It probably ran out of memory. You could increase the server's memory or create a swap file.. This will be fixed in 1.3.1. It's available now. You can update with npm i -g mup.. https://status.github.com/  raw.githubusercontent.com isn't working right now.\nI might modify it to continue if the file is already downloaded to prevent this from happening in the future.. Verifying Deployment currently doesn't work when using Let's Encrypt or the reverse proxy.\nWhat does mup docker ps -a show?. You could reinstall/recreate the server and run mup setup and mup deploy.\nYou could also look at https://stackoverflow.com/questions/30794108/docker-cannot-remove-dead-container to try to remove the container.. You can stop docker with sudo service docker stop.. If you run mup start --verbose, does it still show docker: \"network disconnect\" requires 2 arguments.?\nFor the error from downloading https://raw.githubusercontent.com/jwilder/nginx-proxy/master/nginx.tmpl, it should be working again. The reverse proxy, which will replace meteor.ssl, won't have the error.. I haven't been able to reproduce it, but it should be fixed in 1.3.2.. I am thinking of adding a new property to the config: proxy.additionalPorts which is an array of additional ports to proxy. In the initial implementation it might only allow a certain port, such as 8000. Would that be work for you?. Did you run mup setup after updating?. Starting in mup 1.4, mup will suggest running mup setup when this error happens.\n@Floriferous the bug with setting up the proxy is fixed in mup 1.4.2.. Web sockets currently don't work when using Let's Encrypt or the reverse proxy #612. \nIf the websocket is on a different port than the app, you will need to expose the port: https://github.com/zodern/meteor-up/issues/460#issuecomment-283455401.. It creates a docker image with the bundle in it, which makes deployments more reliable and easier to troubleshoot, but it doesn't use current or last anymore. You can set meteor.docker.prepareBundle to false in your config to go back to how it was.. @nikna after you change it, you need to run mup deploy. If you did that and it didn't work, could you please share your config?\n@sirpy Since mup 1.3, meteor is an alias of app, and they both do the same thing. Eventually meteor will be depreciated and removed.. @willyb321 could you please try with the 1.3.2 beta (install with npm i -g mup@next)?. It should be working correctly in 1.3.2.. You need to create a new docker image with  ffmpeg installed.. Duplicate of #710.. It ran out of memory while running npm install.\nPrepare Bundle might take more memory compared to how it used to run npm install. You could try setting meteor.docker.prepareBundle to false in your config.\nOther options are to create a swap file, or increase the server's ram.. @zhukovsp did disabling Prepare Bundle reduce the memory usage?. Could you please create a new issue for that?. It will be fixed in 1.3.2.. You need a docker image that uses phantomjs 2, such as zodern/meteor.. Since mup 1.4.4, it is possible to customize the docker image: http://meteor-up.com/docs#customize-docker-image. That can be used to install phantomjs 2.. This is fixed in mup 1.4.2.. What meteor version are you using?. Change the docker image in your config to abernix/meteord:node-8.4.0-base. It has the correct node version for Meteor 1.6.. You can ignore AppVeyor. It is missing a couple features needed to run mup's tests, so it has been disabled. \nThanks for working on this feature. I'll try to review and test it no later than next week.. Thank you @edemaine.. The next time someone has this error, what does mup docker ps show?. It's using the wrong docker image. Both configs have the docker image set in meteor.dockerImage. Try setting it in meteor.docker.image instead. I will try to fix it for the next release.. meteor.dockerImage will be fixed in 1.3.3.\n\ndocker: Error response from daemon: Conflict. The container name \"/myroutes-dummy-http-server-for-ssl-check\" is already in use by container\n\nThis will also be fixed in 1.3.3.\n. If you don't need to add cli commands, and it won't be useful for other apps, hooks would be easier.. @ken4ward I'm sorry your having so much trouble with mup.\nWhat does mup deploy --verbose show?. Using sshpk and deploying from windows will be fixed with Meteor 1.6.  Until then, you can try using this docker image: https://github.com/mrauhu/meteord\nOr you can manually fix the package.json for sshpk https://github.com/meteor/meteor/issues/7401#issuecomment-232421798\nOr you can use a ci service, such as circleci or shippable to deploy from linux.. I created a mup plugin that fixes deploying from Windows when sshpk is an npm dependency: https://www.npmjs.com/package/mup-fix-bin-paths. @ken4ward did you check mup logs?\n@merculean and @elie222 what does mup deploy --verbose show?. >  Please help me to fix the issue. is it about to fork docker container and install cmake into the docker container?\nYes\n@ken4ward When using let's encrypt, there is a bug that the deployment verifier doesn't work. The 502 gateway error is from Nginx not being able to connect to the app, either from it still starting or repeatedly crashing. What does mup docker ps show? Does mup logs --tail 100 show any errors?. @ken4ward yes.. @idanwe what is the docker version on the server?. Mup requires 1.13 or newer. Running mup docker setup should update it.. What os does your server have?. Amazon Linux AMI uses yum instead of apt-get, so mup won't be able to update docker. You will have to do it manually.. @Gigacross The Error response from daemon: No such container: error is normal. The error causing it to fail is where it says Killed at\n```> node-sass@4.5.2 install /built_app/programs/server/npm/node_modules/meteor/materialize_materialize/node_modules/node-sass\n\nnode scripts/install.js\n\nDownloading binary from https://github.com/sass/node-sass/releases/download/v4.5.2/linux-x64-46_binding.node\nKilled\n```\nnpm install ran out of ram. Please try increasing the server's ram or creating a swap file.. You can remove it from your config, and after running mup deploy or mup reconfig it will be unset.. Currently it is only tested with Ubuntu.. Thank you!. @elie222 mup uses docker run's --restart option.. > Error: No such image: mup-portal:previous\nThis is normal, and is from mup deciding which method to use to roll back the app.  I will try to make it more clear or hide it in the output.\nThe error causing the problems is npm ERR! registry error parsing json. \n\nerror from daemon in stream: Error grabbing logs: EOF\n\nWhat docker version does the server have installed? Docker 1.13 fixed one cause of it.\nHow much ram and free disk space does your server have? Is it using a proxy?. This is fixed in mup 1.4. It now bypasses nginx and loads the app directly from the docker container.. @jaredtmartin could you please explain why you want to?\nIf you want to skip building, you can use mup deploy --cached-build, as @birdage  said.\nTo skip Prepare Bundle and everything before it, you can use mup reconfig.. @jaredtmartin could you please show the output from mup deploy --verbose? No such container: meteor usually is a symptom for a different problem.\nBesides deleting the docker containers and images, another thing you can do  is delete the /opt/<app name> folder.. I am going to close this in favor of #746.. Change the docker image in your config to abernix/meteord:node-8.4.0-base. It has the correct node version of Meteor 1.6.. @wessilfie What does mup docker ps show?. Meteor Up doesn't redirect to https by default. If switch to using the reverse proxy instead of meteor.ssl, you can redirect http to https.. Sorry, it doesn't copy the code. In your computer's temp folder, there will be a folder that starts with mup-meteor- with the bundle, but the code there would have been modified by babel, and the client code would have been minified.. There are some improvements planned to improve pushing (only upload the parts that changed) and preparing (only rebuild when the app's node modules has changed).\nSome task lists used to happen in parallel. MongoDB and Meteor were both setup at the same time, but some users frequently encountered connection errors during it. Also, I think deploying to multiple servers didn't work, and changing it to serial fixed it.\n\nIt seems like that it would be much more efficient to begin preparing the bundle for one image while another one is being uploaded, etc?\n\nI like that idea. It will require creating a custom task list runner.. @SevenZark did you try running npm uninstall -g mup and reinstalling?. It is a bug with the opencollective cli: https://github.com/opencollective/opencollective-cli/issues/3\nYou can install a working version of mup with npm install -g mup@1.2.11.. You can create an ssh tunnel. Mup currently doesn't setup authentication for MongoDB, so it is only secured by preventing access outside of the server.. What version of Meteor are you using, and what is the docker image in your mup config?. @houshuang you can use the --timestamps option now when viewing logs. It is only missing from the cli help.. @gjr-qm Thanks. I added it to the list.. You can customize the log driver in meteor.log. Why do you want to clear the logs or store it in a file?. @haleo9000 could you please update mup with npm i -g mup and try again?. The docs has instructions at http://meteor-up.com/docs.html#ssh-keys-with-passphrase-or-ssh-agent-support. It doesn't.. This is one reason hooks were added to mup. You can add one in your config to run npm install. For example:\njs\nhooks: {\n    'pre.deploy': {\n      localCommand: 'meteor npm install'\n    }\n}. @chrisbutler it's now more prominent: http://meteor-up.com/docs#meteor-support. It would be possible to create a plugin that does. In the config, there is a property app.type, that when set to anything besides meteor (it defaults to meteor), the meteor plugin doesn't do anything, allowing other plugins to handle setup, deployment, etc.. What are the features you need from elastic beanstalk? Why do you want to use it? . It will be a while before mup supports that. Yes, I would be willing to create the plugin if it was sponsored.. I can create the plugin for $850. $500 would achieve setup, deploying the app, cli commands to start/restart/stop the app, auto scaling and load balancing. The remaining $350 would finish the cli commands, viewing logs, ssl, and fine tuning the configurations.. I can fit it in my schedule and get it done in 2 - 3 weeks. I can start on Friday.\nCould I please get your email? You can send it to z-modern@live.com. @theodorDiaconu Here is an overview of the plugin:\nTo use the plugin:\n1) Install mup and the plugin\n2) Create IAM user if needed\n3) Create config\n4) Run mup deploy\nThe config will probably change as I work on the plugin, but it will be similar to this:\nThe servers object will not be needed.\nApp properties will include:\n- app.type will be set to something like aws-beanstalk so the plugin knows it is supposed to handle deployment (required)\n- app.env, app.path, and app.name will still exist (required).\n- app.buildOptions will still exist, but serverOnly will be set to true by default so this object won't need to be in most configs\n- There will be an object for aws authentication (required)\n- Properties for min (required) and max (optional) instances, and region (optional)\n- app.sslDomains will be an array of domains to create certificates for (optional)\nThere will be a few additional properties to further customize it, but most apps won't need to use them.\nIt will automatically configure load balancing and auto scaling. There might be properties in the config to customize the rules for auto scaling.\nCLI Commands:\n- deploy\n- setup (will be automatically run by deploy when needed)\n- reconfig (update ssl, env, min and max instances, etc. without deploying a new version)\n- start\n- stop\n- restart\n- logs\n- status (This will be a sub-command to the plugin's command, but mup 1.4 is bringing a top-level status command that plugins can add a hook for)\nI will release mup 1.3.5 with a couple changes to better support this type of plugin:\n- Support missing servers object or when the object has no keys\n- Finish separating the default and meteor plugins so other plugins can completely take over managing the app\nDoes this sound good?\nPlease let me know if there is anything you want more information on.. settings.json will definitively be supported.\nFor SSL, the first version will use AWS Certificate Manager. It is free and automatically renews certificates. Though verifying the domain is not completely automated like it is with Let's Encrypt. From the FAQ:\n\nIn order to validate that you control the domain name or names included in the certificate you requested, an email is sent to the registered domain owner for each domain name in the certificate request. \nWhen you request a certificate, a WHOIS lookup for each domain name in the certificate request is used to retrieve contact information for the domain. Email is sent to the domain registrant, administrative contact, and technical contact listed for the domain. Email is also sent to five special email addresses, which are formed by prepending admin@, administrator@, hostmaster@, webmaster@ and postmaster@ to the domain name you\u2019re requesting.\nThe domain owner or an authorized representative (approver) can approve the certificate request by following the instructions in the email. The instructions direct the approver to navigate to the approval website and click the link in the email or paste the link from the email into a browser to navigate to the approval web site. The approver confirms the information associated with the certificate request, such as the domain name, certificate ID (ARN), and the AWS account ID initiating the request, and approves the request if the information is accurate.\n\nI would like to switch to Let's Encrypt in a later version, but it could be a challenge to implement.. @SachaG it did work. Thank you.. I've invited all of you who donated to the repository. The plugin and docs are almost finished. Deploying, load balancing, zero downtime deployments, and auto scaling are all implemented.\nThe one feature left is the ssl certificates. I am waiting for AWS to increase my account's limit of certificate requests since it seems my limit is 0.. @Discordius sorry I didn't invite you. You should have access to it now.. Sorry @paduchurikowsik. You should have access to it now.. It is now public!\nhttps://github.com/zodern/mup-aws-beanstalk\nDocs at: https://github.com/zodern/mup-aws-beanstalk/blob/master/docs/index.md\nInstall with npm i -g mup mup-aws-beanstalk\nThank you to all who donated toward this plugin!. If you are creating it in the folders in meteor.volumes, docker won't remove them.. I would like to reduce the use of sudo. The two main uses are:\n1) every docker command is prefixed with sudo since some people use mup with a non-root user that isn't part of the docker group.\n2) When creating directories in /opt. Mup then runs chown to change their owner to the user mup is using.\nFor 1), I am thinking of requiring the user to be part of the docker group in Mup 2.. With mup 1.3, depending on the docker image in the config, it might build one on the server using this dockerfile. \nOtherwise, it doesn't build a image and instead mounts the app in a volume.\nYou could create a plugin that runs the command meteor.build to build the app, and then creates a docker image.. @Rongky could you please show the output of the command that has the error?. @MartiniHenry1988 are you able to ssh into the machine you are deploying to?. Do other globally installed packages work?. @mukulhase Please post your config here (you can run mup validate --show --scrub to automatically remove most of the sensitive information). Also, please look on the server in the folders /opt/<app name>/current and /opt/<app name>/tmp and check if there is a .tar.gz file.. @evuori what does mup docker ps show? Does mup logs --tail 100 show any errors?. @ddaydd could you please create an app that reproduces this error? When you do, please also add the bundle and tar file to a .build folder in the app.. I'm haven't been able to reproduce it yet. @ddaydd the bundle and tar file created by mup deploy would help. You can get their location by running mup deploy --cached-build. I published mup@1.3.5-beta1 on npm. It uses a different package to archive the bundle (node-tar, which is used by npm and meteor). \nPlease install it with npm i -g mup@next and see if you still encounter the error.. Thanks for testing it. Mup 1.3.5 is no available with the fix.. @captainviet I'm sorry you are having problems deploying your app. It looks like the server is running out of memory while installing the npm dependencies.\nYou can try increasing the server's memory, creating a swapfile, or in your config set app.docker.prepareBundle to false (The Prepare Bundle makes npm install errors easier to debug, and some commands to run faster, but takes slightly more memory).. npm can use a lot of ram during npm install. npm 5 might have improved it, which Meteor 1.6 uses.. What meteor version are you using, and what is the docker image in your config?. Try using the abernix/meteord:node-8.4.0-base docker image.. It should support that. Mup only installs docker if it isn't already, or it is an old version that mup doesn't support.\nIf the mongodb instance was created by mup, it will use it, though it will upgrade/downgrade the mongo version to match what is in your config. If you created the mongodb instance, remove the mongo object from your config and set the MONGO_URL env variable to use it.. > Actually, the same issue apply for MONGO_URL, if you use secure password and users with special characters \nMup probably could automatically fix that. I added a card to the 1.4 project.. Did you try removing node_modules and then running meteor npm install?. Sorry for not being more specific. Please try reinstalling your meteor project's npm dependencies by deleting node_modules in your meteor project and running meteor npm install. You shouldn't need to reinstall mup.. @chackerian change the docker image in your config to abernix/meteord:node-8.4.0-base. I merged @nickich PR. I will release an update tomorrow with the fix.\nThe last update to mup changed the library used to archive the bundle to fix some of the tar files being corrupted. The new library is probably giving different permissions to the files.. I published mup 1.3.6-beta1. Please install it with npm i -g mup@next and let me know if the problem is fixed.. 1.3.6 has been published.. In the future, Meteor Up will support apps that don't use Meteor, so the meteor object was changed to app in mup 1.3. For now, both objects work the same.. Please post the output of mup deploy --verbose.. @LucNaterop you can customize the docker image to use the correct version of node, or use a different base image and install graphicsmagick: http://meteor-up.com/docs#customize-docker-image. Mup can probably detect this and warn the user. I added a card to the 1.4 project: https://github.com/zodern/meteor-up/projects/3#card-5841575. @theshook make sure the mongo object isn't in your config.. Could you please try setting the DEBUG env variable to mup* and running again? That will show if this is happening during meteor build or when creating the archive.. It is possible to do this. Try following the instructions at http://meteor-up.com/docs#reverse-proxy. Also, you can run mup validate to make sure your config is valid.\nThe proxy object should be beside instead of inside meteor. Also, you can configure ssl in the proxy object, which will use a different implementation that supports multiple apps on the server.\n. @enzolutions you need to run mup setup for both apps.. Running mup restart or mup proxy start will pull the latest version of jrcs/letsencrypt-nginx-proxy-companion which has the fix.. @fahadakhan96 could you please show your config?. There are tools such as http://jsnice.org/ that try to unuglify the code. The server code might only be minified.. @BenjaminMerlynS Are you still having this problem?\nIf you are, please share the output of mup logs --tail=40 and mup docker ps.. It would be possible to create a plugin or a hook that does. \nThe hook would be similar to:\n```js\nfunction (api) {\n  const config = api.getConfig();\nconfig.app.env.GIT_COMMIT = 'commit hash',\napi.setConfig(config);\n}\n``. That is the documentation for adding hooks in a plugin. If you want to add the hook in your mup config, the documentation is at http://meteor-up.com/docs.html#hooks. The hookpre.reconfig` would work.. I just remembered that one of my apps adds the commit in an env variable.\n```js\n// top of the config\nvar childProcess = require('child_process');\nmodule.exports = {\n  // ... rest of config\n  meteor: {\n    env: {\n      SOURCE_VERSION: childProcess.execSync('git rev-parse HEAD').toString().trim()\n    }\n  }\n}. The docs for 1.4 will have an example of that: https://github.com/zodern/meteor-up/blob/dev/docs/docs.md#hooks. @themastersoda Is there any stdout output from Prepare Bundle? \nThe Error response from daemon: No such container: myproject error is normal when the app is stopped or during the first deploy. I should probably add some output to make that more clear.. I merged your PR. Thank you.. Thank you @m-niesluchow. I plan to release an update tomorrow with this fix.. Thank you @lauff . Thank you @nickich. I am working on a fix.. I haven't been able to reproduce the bug. I published 1.3.7 beta 0 with a possible fix.\nPlease install it with npm i -g mup@next and let me know if the problem is fixed. If it isn't, please share the output of mup deploy --verbose and the output from running this command on the server:cd /opt/<app name>/tmp && ls -la. @hanimay  and @rooch84 Thank you for trying it. I do not need the verbose output. \nI will publish 1.3.7 today.. 1.3.7 is now available.. @thebarty did you find a way to install chrome driver?. I am going to close this as a duplicate of #362.. There were many improvements to Verifying Deployment in mup 1.4 and 1.4.2. If this problem still exists, this issue can be reopened or a new one created.. @mannyhenri and @AstonBraham are you still encountering this error?. Since mup 1.4.4, it is now possible to customize the docker image: http://meteor-up.com/docs#customize-docker-image. @brylie your bundle is over 352 MB large. Step 3 is coping it into the docker image. The prepare bundle step does slow down deployment, and slightly increases ram usage, but it does increase the reliability of deployments and makes failed deployments easier to debug.\nThis might make it much faster when dependencies don't change between deployments.\nThe prepare bundle script is here if anyone has any suggestions on speeding it up.. I would like to avoid stopping the container. This is the reason for the current behavior:\nWithout prepare bundle, it:\n1) removes old container\n2) Starts new container\n3) npm install is run by docker image\n4) App is started\nRunning the app and running npm install both can use a lot of ram, and only one happens at a time.\nPrepare bundle replaces step 3, but uses more ram than step 3. The app is stopped during Prepare Bundle so there will be more ram available. Even with stopping the app, some servers don't have enough.\nThe container is always started again after prepare bundle finishes, even if it failed.\nFor now, I would like to continue to support servers as small as 512mb. The script would need to decide if it should stop the container or not.\nSome ideas are (not all of them are good):\n- It could look at how much ram is available.\n- Look at how many native dependencies the app has\n- It could also store if it ran out of ram during the last time it was run.\n- If it decides to not stop the app, and it runs out of ram, it could run again with the app stopped. Version 1.4.5 is now available which adds the option app.docker.stopAppDuringPrepareBundle. When enabled the downtime is only the amount of time it takes to create the docker container and start the app, which can be as low as a few seconds.. Mup 1.5 (#976) has a number of performance improvements. Two of them are related to Prepare Bundle:\n\nWhen building the image during Prepare Bundle, it set each environment variable in a separate build instruction in the docker file, which resulted in a new layer for each environment variable. It now sets all of the environment variables in one instruction. One of mup's tests is 30 seconds faster due to this.\nThe Start Meteor task would wait 15 seconds after creating the docker container before verifying deployment. Since Prepare Bundle helps the app to start faster, the task now only waits 3 seconds when it is enabled.. Thank you @justinr1234 . What is the default shell for that user?. In the last update, mup status will now warn if the default shell isn't bash.. You can change the image and tag with app.docker.image. For example, abernix/meteord:base.. > Is it correct that the best way to do it (using MUP) is to set the swap file in the Droplet itself, and NOT in the docker-containers?\n\nYes. meteor.ssl is depreciated in favor of the reverse proxy, which has this feature.\nIf you make the two changes and fix the merge conflics, I will merge it.. This is fixed in mup 1.4. You can try the beta using the instructions in #870.. @gantrim and @xauxatz It is also using the http port, which is configured at proxy.shared.httpPort and defaults to 80.. The reverse proxy is shared between all of the apps running on the server, and some of them might use let's encrypt.\nBefore or while starting the proxy, mup could look for other apps on the server and check if they use Let's Encrypt, and only start it if needed.. @Shelagh-Lewins sorry for not responding sooner. Are you still experiencing this problem?. @traugdor make sure that the version in your node_modules is 1.0.3. Meteor copies the npm dependencies from the node_module instead of looking at the package.json.\nNext time anyone has this problem, please show the output from mup deploy --verbose.. @stefanve what is your mup config?. @jehartzog Thanks. A pr to update the docs would be appreciated.. HTTP_FORWARDED_COUNT probably could default to 1 when using the reverse proxy.. @ferdiemcdaniel make sure the default shell is bash.. mup status should check if the default shell is bash, and if it isn't show a warning.. >mup status should check if the default shell is bash, and if it isn't show a warning.\nThis will be added in the next update.. The past month I haven't had much time to work on Meteor Up, but I am planning to later this week.\nThe website is working for me right now. The docker images are documented at http://meteor-up.com/docs.html#meteor-support, though the docs do need to be reorganized and improved since it seems many users have difficulty finding the information they need.. @achirkof if you are still having these problems, please:\n- run docker inspect <app name> on the server, and paste the volumes here\n- run ls /opt/<app name>/tmp and paste the output here.. https://github.com/floatdrop/pinkie-promise/issues/4. https://status.npmjs.org/incidents/41zfb8qpvrdj. You can run mup deploy --verbose to see the full output from npm install.. Mongo in the container logs to stdout, and docker saves that by default in json files. I could add an option to customize the docker options for the mongo container, which would allow you to change how logs are stored.. Mup 1.4 will have a better message when using an old version of Node that doesn't have Buffer.alloc.. Do you want to store the MongoDB data on the mounted drive, or the docker images and containers? If it is the former, it would be possible to support.. This is a known problem with nginx-proxy. It only happens with https.. It is possible to create plugins that deploy the app, for example, mup-aws-beanstalk. It should be possible to create a plugin that pushes a docker image instead of deploying.. Thank you @Sphinxxxx . I updated the docs for the next version to better explain the debug option. Also, I set it to false in all of the example configs.. This is most likely from Meteor. Could you please run DEBUG=mup* mup deploy?. The message is not from mup. It probably is from Meteor or a Meteor package.. The app uses a different database on the server, and it doesn't have your account.. You are using old versions of npm and node. Mup requires at least Node 4.. You can change the ports using proxy.shared. The docs for it are here.. Looks good! Thank you.. Thank you @jehartzog.. What is in the meteor object?. Instead of meteor.ssl.certificate, you should use meteor.ssl.crt. The documentation is here.. I am releasing 1.4 today, which fixed some bugs with the reverse proxy and makes it easier to troubleshoot problems like this.. Could you please share the output of running mup deploy --verbose? It is a problem with https://github.com/zodern/meteor-up/commit/28d6d56a44ef71a8a96f0307d4ed92e69c996f86. Yes, thank you.\nThe problem is that during 10 - 20 seconds after the app has started, the app's container has no ip address. Usually that is due to the app continuously crashing and the container restarting, but since there are no logs from the app we don't know if that is the cause or there is a bug in 1.4. I will release an update that adds more logging to the deploy-check script.. I released mup 1.4.1 which will show the container's status and it's network settings when Verifying Deployment fails.. @movationdesign in the container status, it says:\ndriver failed programming external connectivity on endpoint gastrofi (91add44d04847cd46cf5efb8415abc4cedcea7c99f0f2051f90d00a3f6b3069d): Error starting userland proxy: listen tcp 0.0.0.0:80: bind: address already in use\nThis is working correctly. It stopped verifying deployment early since it was unlikely the app would start successfully. The task Start Meteor should have failed due to that error when creating the container. I fixed the bug causing Start Meteor to succeed despite commands failing.. @houshuang I have fixed Verifying Deployment when the container is using the host network.\nBoth fixes will be available in mup 1.4.2.. Depending on the Meteor version you are using, you might need to change the docker image.  A list of docker images is available here.. Those are interesting errors, and the normal causes seem to not be happening. Try removing node_modules and running meteor npm install before deploying again... The fix will be in the next update.. This is a duplicate of #883. Could you please run mup deploy --verbose and paste the output after Verifying Deployment in that issue?. Could you please share your mup config?. Thanks for looking into it @bogdanrn. This will be fixed in the next update. I have also fixed the docs for meteor.docker.imagePort.. It currently isn't possible, but you could create a plugin that does.. For Meteor 1.2, app.buildOptions.serverOnly has to be false. \nMup could change it automatically when using Meteor 1.2.. If you set deployCheckWaitTime to 0, it should disable it.\nShould mup provide a different way to verify the deploy succeeded, such as making sure the app doesn't crash within 20 seconds?. Please show me your mup config (you can use mup validate --scrub) and the full output after Verifying Deployment.. I just released 1.4.2 which fixed several bugs with Verifying Deployment.. Thanks @pravdomil. I think it would be easier to find if it was in the docs, and you could have a link in the roadmap to it.. Before or after this section would work.. Thanks!. I first would like to finish more of the tasks in the 1.4 project. I might also try to reduce problems with ECONNRESET. After that I will start working on 1.5.\nAnyone is welcome to start working on these changes. If you have questions you can ask on gitter or create a new issue.. That is correct.. Either option would work.. I have done some work the past couple months on this, mostly investigating the different options for using Docker swarm with the nginx-proxy container and starting work on a solution for it. I will be working part time on Mup next month.. A beta for mup 1.5 is now available. Learn more in #976.. Thanks @WayneUong. It's now #976 since I had used the wrong branch in the pull request.. I am not able to reproduce this. The correct command is mup reconfig.. Let me know if you encounter this again.\nIf it helps, mup meteor status lists all of the environment variables set in the app's docker container.. Available at zodern/mup-plugin-boilerplate. . In either the same or a seperate package there should be helpers for testing plugins.. The docs are at http://meteor-up.com/docs#ssl. They do need to be improved.\nAfter changing the config, run mup reconfig. It can take up to a couple of minutes for the certificates to be created.\nmup status and mup proxy status will show any certificates for the app, and when they expire. mup proxy logs-le shows the logs from the Let's Encrypt docker container.. > The key in all this was to set up the proxy config before doing mup setup. If the server was already setup, I wasn't able to set SSL properly even by running mup setup again; I had to wipe the instance and start over from scratch.\n@SachaG did you stop the apps before running mup setup? They both use port 80, so you have to stop the apps, run mup setup, and then run mup reconfig or mup deploy.\n\nis there a command to clean the instance from everything that mup has setup on it?\n\nThere is a feature request at #395.\n. mup setup doesn't stop the app.\n915 will make this a little simpler.\nWhen setting up the proxy fails, mup could look at the output  to see if the error is from an app using port 80 and give the user instructions.\nIn #916 I updated the Let's Encrypt docs.. Mup 1.4.4 has been released, which includes the improvements to the docs.. It would be helpful to see the meteor command mup is running. Please run:\npowershell\n$env:DEBUG = \"mup*\"\nmup deploy --verbose. Could you please show the output from the command?. Your app or one of it's dependencies is missing resolve-from. Running meteor npm install --save resolve-from should fix it.. You can use the NODE_OPTIONS env variable: https://nodejs.org/api/cli.html#cli_node_options_options. @Hereward did you set buildLocation in your config?. Could you both please show the output from running mup deploy --verbose?. Running meteor npm --save ee-first should fix it.\nMeteor should be including ee-first with the bundle. Could you please create a repository on GitHub with a simple app you can reproduce the error with?. The hooks documentation has an example of adding the git SHA to the settings.json. It would also be possible to modify the app's environment instead.. @layik could you please share the output from Verifying Deployment?. @layik it looks like the docker image you are using has an old version of node. You can find a docker image that is compatible with the meteor version you are using here.. > My webapp container is part of a docker network I specified on the host and in the docker section of the mup config I have '--network=services' in the args field.\nWhat options did you use when creating the network?\nThe cause is the docker network, but this is a regression in mup since it used to support that.. Thanks for catching that! It works correctly with mup logs --tail 40 (space instead of equal sign). This will be fixed in the next update.. Meteor 1.6 uses a version of NPM that fixed a bug causing this error. Try deleting node_modules and running meteor npm install before deploying again.. > Does mup stop && mup start essentially do the same thing when run one after the other?\nYes, except the app will be stopped on all of the servers at the same time, instead of one at a time.. This will be fixed in the next update.. Hooks run before and after commands. For example, you can run mup meteor push to only upload the bundle and prepare it. Right now, the only way to allow hooks between pushing the bundle and preparing it would be to create a new command and task list for preparing the bundle.\nI would like to allow hooks to run between the tasks in a task list, but I am not sure what it would look like yet.\n\nFirst, I noticed that my app's downtime increased about 10 seconds while deploying, from 60 seconds to 70 seconds (I have a component which displays a loading banner when connection to server drops).\n\nIn version 1.4.5, there is a new option app.docker.stopAppDuringPrepareBundle which when set to false reduces downtime to the amount of time it takes your app to start, which for many apps is only a few seconds.. I am not able to reproduce this. Make sure the script's exit code is greater than 0 when it fails.. Looks like I fixed it earlier this month: https://github.com/zodern/meteor-up/commit/4ad4a9885240a86822ac5da77e7666a489fa2fdc. Sorry, I forgot about that.\nIt will be available in the next update.. Look at this section in the docs.. > make: Entering directory '/built_app/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt/build'\n  CXX(target) Release/obj.target/bcrypt_lib/src/blowfish.o\n  CXX(target) Release/obj.target/bcrypt_lib/src/bcrypt.o\n  CXX(target) Release/obj.target/bcrypt_lib/src/bcrypt_node.o\n\ufffd[91mKilled\nKilled means it ran out of memory. Try creating a swapfile or increasing the size of your server.. The app or container keeps crashing, but the only information I see on why is \"ExitCode\":8.\nThis could be a problem with my docker image. Could you try one of the abernix/meteord images, and see if the problem still exists? http://meteor-up.com/docs#meteor-support.   Something on the server is already using port 80. Are any other apps or Nginx running on the server?. Are you able to ssh into the server?. If you have the same error as in the first comment (SyntaxError: Unexpected token {), you need to change the docker image in your config: http://meteor-up.com/docs#meteor-support.. @AdrianApan what does mup deploy --verbose show?. That is a good question. I would also like to hear what people are using.\nOne option is net data. In the future, I am planning to integrate it with Meteor Up.\nFor one of my projects, I am using Node Query. Other companies offer similar products.\nFor a Meteor APM, you can use Node Chef's Meteor APM. I am launching a similar service, which is in private beta (let me kow if you want to join).. Thanks for being willing to help test it! I can send you the information for joining in a private message on the Meteor forums. Could you please give me your username, or send me a message on the Meteor Forums?. It is now available at https://montiapm.com/.. What docker version does mup docker status show?\nDoes running mup docker restart fix deploying?. You can set app.buildOptions.buildLocation to the folder with the tarball. Then deploy using mup deploy --cached-build for it to use the existing tarball.. This is a bug in node-tar: https://github.com/npm/node-tar/pull/171.\n\nI haven't digged more about this but i wonder what's the point about running meteor build with --directory option, then doing tarball yourself instead of just asking meteor to do the tarball directly ?\n\nThe meteor.build command can be used by other plugins. For example, the mup-aws-beanstalk plugin runs it, adds files to the bundle, and then creates a zip file since aws beanstalk doesn't support tar files.. I published a beta version of mup (1.4.5-beta1) which is using a forked version of tar that has the fix for this. You can try it by running npm i -g mup@next.. This currently isn't supported. After Meteor Up 1.5, it would be possible to add this.. @pravdomil could you please explain the reason for the change?. Thanks @pravdomil.. Could you please show me the output of running cat /opt/mup-nginx-proxy/config/nginx-default.conf on the server? That file is mounted as my_proxy.conf inside the Docker container.. @NitroBAY the file is at /opt/mup-nginx-proxy/config/nginx-default.conf on the server, not in the container. It is mounted in the container as my_proxy.conf. Could you please show me the content of the file by running cat /opt/mup-nginx-proxy/config/nginx-default.conf on the server?. Thanks @NitroBAY. If you add a semicolon to the end of the in the file, it should work. I will create a permanent fix in the next update.. Meteor Up creates a docker image for the app when deploying. The image contains the app's bundle (the files that used to be in current), so the current directory isn't needed anymore to run the app.\nDid you use the current directory for something?. It is supposed to install docker if it isn't.\nIt first checks if docker is installed, and then the version of docker (it isn't, which is the reason for the first two lines). It then runs the install script, which is failing with the error:\nE: Could not get lock /var/lib/apt/lists/lock - open (11: Resource temporarily unavailable)\n    E: Unable to lock directory /var/lib/apt/lists/\n. @programthis Mup might not have waited long enough for the app to start. This is fixed by Prepare Bundle, which is only enabled by default for certain images. Setting app.docker.prepareBundle to true in your config should fix it.\n@marcoschwartz could you please show the output after Verifying Deployment  when running mup deploy --verbose?\n. @sebitoelcheater it is being maintained again. Are you encountering this problem?. @marcoschwartz could you please show the output from the command?. @kankando does mup status show any problems?. Thanks for creating the pull request.\nThis issue is a duplicate of #706.. Thanks for creating this @clesquir.\nTwo things:\n1. Since changing the docker arguments effects every app using the reverse proxy, it should be part of reconfigShared.\n2. Move the option to proxy.shared.dockerArgs.\nOnce #706 is implemented there will be an easier way to add ports, but this PR has many additional uses such as adding networks, volumes, using a custom nginx template, etc.. This is fixed in version 1.4.5.. Setting the environment variable should be optional.  Where does mup complain?. Could you please show the output of the command?\nIt currently isn't possible to disable mup from setting up the MongoDB replica set and oplog, but setting the environment variable or using the oplog in your app is optional.. What docker image did you use with Mup 1.3.7?. Prepare Bundle started being enabled by default for zodern/meteor-docker in Mup 1.4, which could have made deployments slower. There shouldn't be a large difference between 1.3.7 and 1.4.5 when using abernix/meteord.\nStarting in Mup 1.3, mup builds a docker image on the server during Prepare Bundle. It does slow down deploys, but makes them much more reliable and easier to troubleshoot. It also greatly speeds up starting the app. In mup 1.4.5, there is a new option app.docker.stopAppDuringPrepareBundle, which when set to false reduces the downtime to the amount of time it takes the app to start.\nFor Mup 1.5, I am looking into caching the app's npm dependencies, which will make deployments much faster when the dependencies haven't changed since the last deployment.. You can use a docker image that doesn't have Phantom js, such as abernix/spaceglue. The Meteor issue is from Meteor 1.7 tool using a newer version of MongoDB than the version that stored the data.\nThis doesn't affect Meteor Up  since you have full control over what version of MongoDB is used (by mongo.version in the config), and when the version changes. When changing mongo.version, make sure to follow these instructions to avoid problems.. To clarify, is the css file successfully loading but empty?\nFirst, please check that the bundle created by meteor build includes the css:\n1. Run mup meteor build --cached-build. It will show the location of the bundle.\n2. Open <path shown in step 1>/bundle/programs/web.browser and check if there is a css file, and that it contains the missing css.. Could you please show your config (mup validate --scrub --show)? . Your app needs node-pre-gyp, which the docker image you are using doesn't have. It is possible to customize the docker image with app.docker.buildInstructions:\njs\nmodule.exports {\n  app: {\n    docker: {\n      buildInstructions: [\n        'RUN npm install node-pre-gyp -g'\n      ]\n    }\n  }\n};. You can disable tlsv1 by adding SSL_POLICY: \"Mozilla-Modern\" to app.env in your config. This does break compatibility with some web browsers: https://wiki.mozilla.org/Security/Server_Side_TLS#Modern_compatibility. @rexhumus by app.env, I meant adding it to the env object in the app or meteor object in your mup config:\n```js\nmodule.exports = {\n  servers: {\n    one: {\n      host: \"XXX.XXX.XXX.XXX\",\n      \"username\": \"USERNAME\",\n      \"password\": \"PASSWORD\",\n      opts: {\n        port: 22,\n      }\n    }\n  },\nmeteor: {\n    name: 'NAME',\n    path: '../PATH',\n    servers: {\n      one: {}\n    },\nbuildOptions: {\n  serverOnly: true,\n},\n\nenv: {\n  \"ROOT_URL\": \"http://MY.APPLICATION.com\",\n  \"MONGO_URL\": \"mongodb://ENTIRE.MONGO.DB.URL\",\n  // --------- Add it here -------------\n  \"SSL_POLICY\": \"Mozilla-Modern\"\n},\n\n\"ssl\": {\n  \"crt\": \"./ssl.crt\",\n  \"key\": \"./key.pem\",\n  \"port\": 443\n},\n\ndockerImage: 'abernix/meteord:base',\ndeployCheckWaitTime: 180\n\n}\n};\n```\nAfter changing it, run mup reconfig and the container will be recreated with the new environment variables.. I created #976 with the correct branch.. The docs do need to be updated. Sudo is also used whenever a docker command is run and when creating folders in /opt.\n\nSeems like a safety concern to demand direct root access over ssh or allow a useraccount sudo access without the need for a password. Is there a way to avoid this?\n\nThere currently isn't a way to avoid it. This is related to #770. It responds to the domains in proxy.domains in your config. Also, if proxy.shared.env.DEFAULT_HOST is set to one of those domains, it will use the app for any other domain also.. Removing proxy.shared.env.DEFAULT_HOST from your config and running mup proxy reconfig-shared should make it only serve the domains from proxy.domains.\nThere is a problem in nginx-proxy that could cause it to still do the wrong behavior: #863. Mup 1.5 changed how nginx-proxy is setup, so it would now be possible to fix it.. With Mup 1.4, it uses node 4 during prepare bundle and the correct version when running the app. buildInstructions is run after the node version has been set.\nMup 1.5 (#976) will set the correct value for NODE_VERSION during Prepare Bundle. . Mup is able to customize the docker container: http://meteor-up.com/docs#customize-docker-image. You could use that to install the apt-get packages.. A process on the server is already using port 80. Do you have another app or nginx running on the server?. What version of Meteor are you using?. The config and logs looks like it should be working. The only potential cause I see is the meteor version might not be compatible with the MongoDB version.\nThe version of the mongodb driver in Meteor 1.4 doesn't officially support MongoDB 3.2 and newer according to their docs. You could try using an older version of MongoDB (3.0), or upgrade Meteor to a version that has a newer version of the mongodb driver that supports MongoDB 3.4 (Meteor 1.4.3.2 or newer).. 1) Were you able to access your app before switching to an external database?\n2) Are you able to access it now?. I am not sure what is preventing it from being accessible.\n1) The app is successfully uploaded, built, and it's container started\n2) All of the ports and url's look correct\n3) The app doesn't crash, at least in the first 75 seconds after it is started.\nUsually the app starts within a few seconds. Maybe this app needs a little longer? Could you please add this to a file on the server, and check if the logs show it when Verifying Deployment fails:\njs\nconsole.log('starting');\nMeteor.startup(() => {\n  console.log('startup');\n});\nmup status in your first post showed that the container had restarted twice. Did mup logs show a cause?. What does mup deploy --verbose show?. Thanks for looking into this.\nIn the bundle.tar.gz, the app's files are inside of a bundle folder, which results in the files being extracted to the wrong position when using ADD.\nI experimented with both approaches to compare their performance. I removed the npm install command from the docker file. Without that, building the image with COPY took 20 - 22 seconds for a 12mb bundle. With ADD it took ~9 seconds.  To remove the bundle folder, the prepare-bundle script extracted the bundle and recompressed it, which added ~ 2 seconds. The build context was 13.15MB instead of 71.17MB.\nOne problem with ADD is it didn't use cache when the bundle didn't change. With COPY, it would use a cached image and only take 5 - 8 seconds and skip running npm install.\nI plan to add caching for the app's npm dependencies, so they will only need to be installed and rebuilt when the Meteor version changes or the dependencies change. If the files needed for this are copied first with COPY, and everything else is added with ADD, then ADD not using cache wouldn't be as important.\n. This is a good start.\nMeteor's npm dependencies install fairly quickly. The slow part is rebuilding native dependencies, which is what we want to cache.\nThere are some things that need to be adjusted for compatibility:\n1) The current behavior mimics what meteor build does. Due to various reasons, some users build the bundle themselves with meteor build and then deploy with mup deploy --cached-build. I would like to continue to allow that. Maybe we could move the files one level up in the RUN command after ADD.\n2) and 3.\nYou will also need to copy from programs/server\n```\nNeeded for the rebuild script\nnpm-rebuild-args.js\nnpm-rebuilds.json\nnpm\n```\nnpm contains all of the app's and meteor package's npm dependencies, so it can be large. If copying this removes the speed benefit of ADD, we can look into only copying the dependencies that need to be rebuilt.\nMETEOR_SKIP_NPM_REBUILD=1 shouldn't be set since it only works when the app was deployed from a computer with the exact same architecture.\nThanks for being willing to work on this. I appreciate it.. In the programs/server folder, there is:\n\npackage.json this only has a few dependencies needed for the code that boots the node server. These, of course, are installed in the node_modules folder.\nnpm/node_modules These are all of the app's and meteor package's npm dependencies. They are already installed, but the native dependencies were built on the computer the app was deployed from, so they need to be rebuilt. There isn't a package.json listing these dependencies.\n\nFor now, we can find a way to use ADD without modifying the structure of bundle.tar.gz, and add caching for the npm dependencies afterwards. Another idea is to:\n\nADD the bundle to /__mup_bundle\nIn a run command, symlink /built_app to /__mup_bundle/bundle and install npm dependencies\n\nDocker might be able to cache the ADD step since the tar file isn't being modified, depending on how much metadata is kept when copying it to the server.. This has been added to Mup 1.5: https://github.com/zodern/meteor-up/blob/8b7213330e272b7241da1b1d79b5c32135de39dd/src/plugins/meteor/assets/prepare-bundle.sh#L37-L40.\nThanks @SimonSimCity for suggesting this.. Do you have the stopAppDuringPrepareBundle option set to false? I can look into uploading in parallel when it is set to false.\nAn idea I've been considering is having an option for Meteor Up setup a private Docker registry. Mup could upload the bundle to one server, build the image, and push it to the registry. All of the other servers could then pull it from the registry.. stopAppDuringPrepareBundle is explained in the example config (look in the app.docker object). It would reduce the time each server is down. If there would be any benefit from it, uploading in parallel could be enabled when stopAppDuringPrepareBundle is set to false.\n\nAlso, would deploying to 4 ports on the same server require 4 uploads? (seem to remember it did for a while back, but wondering if the state of things is still the same here).\n\nIt uploads to each server listed in app.servers\n\nAnd yes, was thinking the same thing about the private docker registry\napproach. I'd be interested in playing with that myself if you could point\nme to a good place to look in the code.\n\nIt probably would be best to create a new plugin to manage the registry. The meteor push command and prepare bundle script would need to be updated to only upload to one server and push the image to the registry.. This probably is from the server running out of ram.\nDocker has some options for setting memory limits: https://docs.docker.com/config/containers/resource_constraints/#limit-a-containers-access-to-memory. You can set them in your config at app.docker.args.. Could you please show your mup config (mup validate --scrub) and your nginx config file?. Thanks @JorgenVatle. This would be very nice. The reason we suggest using mup.cmd is because Command Prompt runs/opens the mup.js config file in the current directory instead of running Meteor Up. Do your changes fix this?. Thanks @ninjaPixel . What does mup proxy status show?. There are many bugs in beta1. I will release a second beta soon.. Thanks @rolljee.\nFixing the ROOT_URL for ssl looks good.\nFor the MAIL_URL and MONGO_URL, the problem is with special characters in the password or username, usually @. For example: mongodb://username:pass@word@host:3000/db should be mongodb://username:pass%40word@host:3000/db.\nThe href property returned by url.parse has the special characters in the username and password encoded. We could replace the MONGO_URL and MAIL_URL with it, or show the user a warning while validating.. Vulcan can instead use the SOURCE_VERSION environment variable. Try adding the code from https://github.com/zodern/meteor-up/issues/807#issuecomment-346915622 to your config.. Why is prepareBundle set to false?\nYou could add a console.log('updated') to the server and check the logs for it after deploying to confirm it isn't being updated.. Does the output of meteor npm install --save bcrypt show any errors? Is bcrypt in your package.json?. Thanks @eluck. Could you please fix the merge conflicts?. You need to remove the mongo object from your config: http://meteor-up.com/docs#external-database. When the mongo object is in your config, it overwrites env.MONGO_URL to the correct value for the built-in database.. env are variables available to the Meteor app. PORT and BIND should be moved to the docker config.\n. > If you are deploying under a proxy and need a different deployment verification port, add and environment ...\nchange the last and to an. Most apps won't need to change these, so I would prefer to not have them in the default mup.js.. > add and environment variable called BIND\nchange and to an.. I would prefer to have a nginx object in meteor to hold options for nginx.. This needs to start with <%= . It needs to mention that this currently only works when using Let's Encrypt.. EOT needs to be the first characters on the line for it to be recognized.. I think you want to add this variable for start.sh instead, which is on line 127.. Change this to overwrite the file instead of append.. nginx complains about the brackets. You can remove them.. docker was correct. Meteor still uses port 80.. This is a breaking change. It would require mup setup to be run for ssl to work again. You should be able to use the same path.. I think it would be better to use configuration or config instead of settings in the list title and mup config property.. ejs doesn't like undefined variables. Please remove $CLIENTSIZE from the top of the file.. space between -- and restart. The bundle.crt and private.key paths need to be changed back to the current upload path.. Your right. Sorry.. Typo. > simply comment out\nPlease change it to \"simply remove or comment out\"\nAlso, I'm not sure the example is needed. What is your opinion?. It links to the wrong section.. There is a warning 7 lines down, but your is in a better place. Please remove the old one.. It looks better without the shadow. \nYou can remove the shadow at  https://github.com/zodern/meteor-up/blob/f11970f9967b215b53216a81b3ffa7f2f0da7f1c/docs/css/custom.css#L156-L161\n. Please leave the hanging commas in this file. That way users won't need to remember to add commas when they uncomment or add properties.. This step could be skipped when config.ssl.autogenerate is undefined.. suggestion\nChanging directories shouldn't be needed since npm run docs  also works from the docs folder.. The || (exit 0) fixed the postinstall script sometimes causing the install to fail. Could you please readd it?. Could you please set the scriptname: https://github.com/yargs/yargs/blob/master/docs/api.md#scriptname0\nI think we need it to be empty to preserve the current help output, though maybe some people would prefer it set to mup.. Last time I tried updating yargs, a number of things stopped working, though there have been a couple major updates since then. Have you seen any problems with it?. Please move these to prepareConfig in the Meteor plugin.. The new version of yargs no longer hides commands with an empty description. Mup should still support that for now until version 2. Adding builder.hide(commandName) for commands with an empty description should work.. After npm-shrinkwrap.json changes, run npm run clean-shrinkwrap to fix it for older npm versions.. ",
    "merlinpatt": "What if I don't want to use an oplog? How do I disable it from within the settings file?. It says that MONGO_OPLOG_URL is required when I run mup setup.\nAlso, in #21, you stated that it is not possible to disable the oplog.. ",
    "aayushkapoor206": "Thanks for the update! \n. ",
    "artpolikarpov": "\u270c\ufe0f\n. This one could be a nice feature in the future. Couldn\u2019t it?\n. Meteor Galaxy updates similar.\n. In other issue I read that that feature is planed. But for me this one is absolutely critical, I already deployed servers in production and only after that I realized that you have removed that feature. Early (with mupx) it worked with no problem.\nCan you point out where to start to bring this feature on? I\u2019ll try to add it at least for myself (or will try to pr it back to you).\n. I already found this function and still have no idea how to solve the problem. Now you build env object before iterating the session, but we need some way to revert it \u2014 to build uniq env for each session. Or find place where to extend env later. \n. @madushan1000, can you help? I think it is a essential feature.\n. This one try to solve #244. It\u2019s not an ideal solution, because now we have to run as many task lists as servers we have. But it brings one important and essential feature back. Now you can have override global env with custom one:\nmodule.exports = {\n    // Server authentication info\n    \"servers\": {\n        '1': {\n            \"host\": \"104.197.203.70\",\n            \"username\": \"artpolikarpov\",\n            \"pem\": \"/Users/artpolikarpov/Projects/Chatra/DEPLOY/google_compute_engine\",\n            \"env\": {\n                // custom env!\n                \"LABEL\": \"104-197-203-70\",\n                \"CDN\": \"https://1177857738.somecdn.io\"\n            }\n        },\n  ...\n. @idanwe, no updates here. I just forked this repo and monkey-patched it.. \n. And if one of the servers fails it stops all the task. As I remember mupx was doing all tasks for one server, then for second and so on... I think it is more comfort scenario, because you can retry deploy without first succeeded servers. \n. When you deploy server after server \u2014 everything is fine always! But when try a few in parallell it fails.\n. Useful reading about cleaning after Docker: https://lebkowski.name/docker-volumes/ https://lebkowski.name/docker-volumes/. Today one of my servers was out of disk space:\n\nAfter complete removing containers still a lot of space eaten:\n\nI have no idea why is it so... Long time ago (in arunoda/meteor-up-whatever) this thing was happening because of logs, but now logs looks configured to be rotated properly...\nThis is a major blocking bug I think.. ",
    "elmor34": "Thanks all...\nI made a clean install and solved...\n. ",
    "bompi88": "Thanks @madushan1000 , that did the trick :+1: \n. @madushan1000 I expected you would use it for doing something like that. If I chown the config file before running the container, it seems to be working. Setting the owner to be the mongo user/group  999 in the mongo-start.sh:\n``` bash\nmake sure mongo can access config file\nsudo chown 999:999 /opt/mongodb/mongodb.conf\n```\n. ",
    "Ben305": "I have the same problem, it's not working with npm install -g, but is working when using install and link\n. Can be solved easily:\nvar path = require('path');\nvar os = require('os');\nvar privateKey = path.join(os.homedir(), '.ssh', 'id_rsa');\nand then later with\npem: privateKey\n. I like the MupTask class and would use it to install additional packages via apt\n. This would be very useful to install packages like graphicsmagick\n+1\n. @mzygmunt That happens when you use a docker image that doesn't contain Node 4.\n. ",
    "gamedevsam": "This saved my life:\n```\nEDIT: If I run mup inside dev folder it works as expected:\nnode ~/projects/meteor-up/index.js init\n```\n. Same here, hopefully this helps:\n```\nroot@Jenkins-512mb-nyc3-01:~/meteor-up# npm run prepublish\n\nmup@1.0.0 prepublish /root/meteor-up\nnofat make\n\n/root/meteor-up/node_modules/nofat/tasks/make/index.js:45\n        throw err;\n        ^\nError: Couldn't find preset \"es2015\" relative to directory \"/root/meteor-up/src\"\n    at /root/meteor-up/node_modules/nofat/node_modules/babel-core/lib/transforma                                                                                                             tion/file/options/option-manager.js:372:17\n    at Array.map (native)\n    at OptionManager.resolvePresets (/root/meteor-up/node_modules/nofat/node_mod                                                                                                             ules/babel-core/lib/transformation/file/options/option-manager.js:364:20)\n    at OptionManager.mergePresets (/root/meteor-up/node_modules/nofat/node_modul                                                                                                             es/babel-core/lib/transformation/file/options/option-manager.js:348:10)\n    at OptionManager.mergeOptions (/root/meteor-up/node_modules/nofat/node_modul                                                                                                             es/babel-core/lib/transformation/file/options/option-manager.js:307:14)\n    at OptionManager.init (/root/meteor-up/node_modules/nofat/node_modules/babel                                                                                                             -core/lib/transformation/file/options/option-manager.js:465:10)\n    at File.initOptions (/root/meteor-up/node_modules/nofat/node_modules/babel-c                                                                                                             ore/lib/transformation/file/index.js:194:75)\n    at new File (/root/meteor-up/node_modules/nofat/node_modules/babel-core/lib/                                                                                                             transformation/file/index.js:123:22)\n    at Pipeline.transform (/root/meteor-up/node_modules/nofat/node_modules/babel                                                                                                             -core/lib/transformation/pipeline.js:45:16)\n    at /root/meteor-up/node_modules/nofat/node_modules/babel-core/lib/api/node.j                                                                                                             s:106:18\nnpm ERR! Linux 3.13.0-77-generic\nnpm ERR! argv \"/usr/local/bin/node\" \"/usr/local/bin/npm\" \"run\" \"prepublish\"\nnpm ERR! node v5.10.1\nnpm ERR! npm  v3.8.3\nnpm ERR! code ELIFECYCLE\nnpm ERR! mup@1.0.0 prepublish: nofat make\nnpm ERR! Exit status 1\nnpm ERR!\nnpm ERR! Failed at the mup@1.0.0 prepublish script 'nofat make'.\nnpm ERR! Make sure you have the latest version of node.js and npm installed.\nnpm ERR! If you do, this is most likely a problem with the mup package,\nnpm ERR! not with npm itself.\nnpm ERR! Tell the author that this fails on your system:\nnpm ERR!     nofat make\nnpm ERR! You can get information on how to open an issue for this project with:\nnpm ERR!     npm bugs mup\nnpm ERR! Or if that isn't available, you can get their info via:\nnpm ERR!     npm owner ls mup\nnpm ERR! There is likely additional logging output above.\nnpm ERR! Please include the following file with any support request:\nnpm ERR!     /root/meteor-up/npm-debug.log\n```\nUPDATE: This fixed it: npm install babel-cli babel-preset-es2015\nSTILL FAILING:\n```\nroot@Jenkins-512mb-nyc3-01:~/meteor-up# npm run prepublish\n\nmup@1.0.0 prepublish /root/meteor-up\nnofat make\n\n/root/meteor-up/node_modules/nofat/tasks/make/index.js:45\n        throw err;\n        ^\nError: Couldn't find preset \"stage-3\" relative to directory \"/root/meteor-up/src\"\n    at /root/meteor-up/node_modules/nofat/node_modules/babel-core/lib/transformation/file/options/option-manager.js:372:17\n    at Array.map (native)\n    at OptionManager.resolvePresets (/root/meteor-up/node_modules/nofat/node_modules/babel-core/lib/transformation/file/options/option-manager.js:364:20)\n    at OptionManager.mergePresets (/root/meteor-up/node_modules/nofat/node_modules/babel-core/lib/transformation/file/options/option-manager.js:348:10)\n    at OptionManager.mergeOptions (/root/meteor-up/node_modules/nofat/node_modules/babel-core/lib/transformation/file/options/option-manager.js:307:14)\n    at OptionManager.init (/root/meteor-up/node_modules/nofat/node_modules/babel-core/lib/transformation/file/options/option-manager.js:465:10)\n    at File.initOptions (/root/meteor-up/node_modules/nofat/node_modules/babel-core/lib/transformation/file/index.js:194:75)\n    at new File (/root/meteor-up/node_modules/nofat/node_modules/babel-core/lib/transformation/file/index.js:123:22)\n    at Pipeline.transform (/root/meteor-up/node_modules/nofat/node_modules/babel-core/lib/transformation/pipeline.js:45:16)\n    at /root/meteor-up/node_modules/nofat/node_modules/babel-core/lib/api/node.js:106:18\nnpm ERR! Linux 3.13.0-77-generic\nnpm ERR! argv \"/usr/local/bin/node\" \"/usr/local/bin/npm\" \"run\" \"prepublish\"\nnpm ERR! node v5.10.1\nnpm ERR! npm  v3.8.3\nnpm ERR! code ELIFECYCLE\nnpm ERR! mup@1.0.0 prepublish: nofat make\nnpm ERR! Exit status 1\nnpm ERR!\nnpm ERR! Failed at the mup@1.0.0 prepublish script 'nofat make'.\nnpm ERR! Make sure you have the latest version of node.js and npm installed.\nnpm ERR! If you do, this is most likely a problem with the mup package,\nnpm ERR! not with npm itself.\nnpm ERR! Tell the author that this fails on your system:\nnpm ERR!     nofat make\nnpm ERR! You can get information on how to open an issue for this project with:\nnpm ERR!     npm bugs mup\nnpm ERR! Or if that isn't available, you can get their info via:\nnpm ERR!     npm owner ls mup\nnpm ERR! There is likely additional logging output above.\nnpm ERR! Please include the following file with any support request:\nnpm ERR!     /root/meteor-up/npm-debug.log\n```\n. ",
    "timothyarmes": "Surely if an entirely new container is starting up then it won't know anything about the previously connected users. When the client try to start talking to the new container how does meteor know that they were previously connected? What does it do about merge box?\n. OK. So what happens after a redeploy: does the user see a hot code push or a reload?\n. Anyone know what Galaxy does?\n. Yes, I am.\nI've also just tried to use mupx instead, and it's failing with the same error.\n. OK, I've just downgraded React and that's worked. Nevertheless I'll leave this bug report open since there's no reason it should be failing. Note that I can push to Galaxy without any issues too.\n. Well, this time it's failed with React. Next time the same issue could\naffect another package, no?\nAlso, moving away from the React package can only be done once it's\nno longer required by any 3rd party packages that we're using.\nWhat is the actual issue? Why doesn't meteor deploy suffer from it?\nOn Saturday, 23 January 2016, Arunoda Susiripala notifications@github.com\nwrote:\n\nThis is pretty hard to solve for whatever the reason and we don't anything\nfancy here. Just build it using Meteor's command.\nSo, my suggestion is not to use 0.14.4.\nWith Meteor 1.3, you don't need this package.\nSee: Getting Started with Meteor 1.3 and React\nhttps://voice.kadira.io/getting-started-with-meteor-1-3-and-react-15e071e41cd1\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/35#issuecomment-174095455.\n. I've just had the same problem because I changed the name of the app.\n\nIs there a clean way to do this?\n. For others who need to work out how to do this:\nFirst, ssh into your server:\nssh -i <pem-file-path> <username>@<ip-address>\nYou can list all docker containers like this:\ndocker ps -a\nIn most cases there'll just be one container - the one created by mup. Something like this:\nCONTAINER ID        IMAGE                      COMMAND                  CREATED             STATUS                          PORTS                NAMES\n8ca167a5a4ce        meteorhacks/meteord:base   \"/bin/sh -c 'bash $ME\"   15 hours ago        Restarting (8) 50 minutes ago   0.0.0.0:80->80/tcp   myAppName\nThe name of the container will be that of the app you'd installed using mup. Now it's easy to remove it:\ndocker stop <app-name>\ndocker rm <app-name>\nNow you can rename your app inside the mup file and redeploy.\n. Ah yes, that's fixed it.\nThis feels a bit clunky. Could it now keep trying for a couple of minutes instead?\n. ",
    "markshust": "In my experience, deploying a new instance with Docker disconnects connected users. You'll receive multiple disconnect notices. When the new instance deploys, the client will reconnect. It's not a fatal solution, but it's not ideal.\nI believe the only way to get around this is to have a load balancer within mup that has support for sticky sessions. When a new Docker instance is deployed, it is confirmed as up and the load balancer switches to that new Docker instance. After all traffic is re-routed, the old Docker container is removed. \n. I remember this error message. Are you using a newer React version (0.14.4?). \n. Yes, this was an issue in current mup, definitely should be open :) It's a bug with mup when using React 0.14.4.\n. I also fail to understand why 0.14.4 is not working with this, as everything is standard. There is something that is mup-specific causing this to fail, and this may lead to other packages not loading as well. I really think this should be solved as 0.14.4 is starting to become the standard version of React install at this point in time. \n. This can be closed out. I can confirm this is most likely an issue with Docker for Mac, related to going into standy mode and the clock getting out of sync with the host. Either syncing local time, restarting Docker, or rebooting the machine fixes the issue. There is nothing here specific to Meteor or mup itself.. ",
    "ccuilla": "I would add that it may not be limited to 0.14.4. I am running 0.14.3 and had the exact same error.\nNOTE: However I was using mupx, not this mup. I'm trying to sort out all of the different mups. It's my first time using mup, so I'm just getting starteding.\n. So this mup is the correct and current mup to be using?\n. ",
    "gsabran": "running React 0.14.7 gives the same issue. By how much should I downgrade React?\nAlso what do you mean by with Meteor 1.3 you don't need this package ? In your post you do npm i --save react react-dom right?\nThanks!\n. It might be fixed in rc.4: https://github.com/meteor/meteor/issues/6533\n. Ah nice (I'm moving from old mup)\n. yup..!\n. I see. So it's a bit confusing, both due to the stdout advice and the fact that nothing in the trace indicate anything local. But now I know. Hope that google is gonna show this issue for people looking for a clue.\nI'll increase deployCheckWaitTime and see.\nThanks a lot!\n. Another advantage of decoupling the servers deployment would be to allow for server level env variables, but that's another story\n. All right. What about using https://github.com/sindresorhus/os-homedir ?\n. Cool, will do\n. Can this be something else that deployment time?\nI'm getting \n- Pushing Meteor App Bundle to The Server\nx Pushing Meteor App Bundle to The Server: FAILED\n    No such file\nand my mups.js is \n``` js\nmodule.exports = {\n  servers: {\n    staging: {\n      host: '52.91.71.177',\n      username: 'ubuntu',\n      pem: '/home/ubuntu/.ssh/aws-east-1.pem',\n    },\n  },\nmeteor: {\n    name: 'pie',\n    path: '../',\n    servers: {\n      staging: {},\n    },\n    env: {\n      ROOT_URL: 'http://dev.pie.video',\n      NODE_ENV: 'production',\n      MONGO_URL: '...',\n    },\n    deployCheckWaitTime: 2500,\n    enableUploadProgressBar: true,\n  },\n};\n```\nssh -i /home/ubuntu/.ssh/aws-east-1.pem ubuntu@52.91.71.177 works perfectly\n. And is there a way to get better error logs?\n. I changed a number of things and at the end it worked, but I can't remember exactly what made a difference... Anyway thanks @indesignlatam !\n. I had the same issue, but had no time to do a PR: https://github.com/kadirahq/meteor-up/issues/87\n. Hi @abernix my deployment is crashing with:\n```\n=> Starting meteor app on port:80\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\n/bundle/bundle/programs/server/node_modules/fibers/future.js:313\n                        throw(ex);\n                        ^\n[object Object]\n```\nDo you know how I can get better logs? (I can't open issues in your repo so I'm putting it here)\n. I launched a new server today yes. I'll look into node versions. Thanks! @lfilho how did that looked like wrong node version ?? :) @abernix is there a npm version I should also match in my local environment?\n. I've downgraded node to 4.6.1 (I was running 6), made sure I'm on npm 3.10.8, reinstalled all node modules, started a fresh EC2 instance and this is still happening...\n. 1.4.1.1 should I get 1.4.1.2 ?\n. Thanks a lot @abernix. I moved the discussion to this issue\n. In case that's of interest to some, I've found that my issue comes from the inclusion of meteorhacks/meteorx that's an indirect dependency of my project. Since both packages are maintained by kadirahq/aronuda, I thought there might be a chance you could understand the issue better than I do @madushan1000 :)\n. Is react part of your npm modules?\n. and I guess you've checked that $ ls node_modules/react/lib/ReactComponentWithPureRenderMixin returns you something? If so I've no idea :)\n. Actually, it might be easier to use Meteor's wrapper of bcrypt with that is the npm-bcrypt atmosphere package.\n. And should not \"certificate\" be \"crt\" ? https://github.com/kadirahq/meteor-up/blob/97cc7e5a3882edbb2655bb8098e94e1900937bb7/src/modules/meteor/index.js#L47\n. cool, I've changed it\n. In case that's helpful, for this issue or other having issue with SSL: the original error I was having was that my certificate file was the bundle of the intermediate certificates with the omission of the my own certificate ! I got confused because godaddy gave me two .crt files, one that was my own certificate and one that was all the intermediate certificates. I had to bundle them all together to get mup to work.\nAs a side note, mup was deploying ok if I only used my SSL certificate without the intermediate certificates, even if the resulting authentification is not right. It was working fine in some browsers but Cloudfront that enforces a stricter policy was not working properly. I dunno what's the best behavior that mup should have in that case.\n. @lfilho my guess is that you're not setting meteor.env.ROOT_URL to https://your-website.com. Meteor 1.4.1 is working fine for me with SSL\n. Removing the package meteorhacks:kadira-profiler fixed the issue...\n. yes, I get the same output, just a bit more context that's useless for me. I've been trying to change fibers/future.js to get better logs, but I guess it's useless since it's gonna use the code from abernix's container.\n. Yes if I remember correctly. I had an issue with my db connection and the mongo node driver had an issue reporting the error: https://jira.mongodb.org/browse/NODE-838 so I was getting shitty logs. This has been fixed now: https://github.com/christkv/mongodb-core/commit/aaaa4e45f75e24a5b0cfd8b101e1851c0672a3b9 and I think Meteor included the fix by upgrading the mongo version it's using (even though I'm not 100% sure). ",
    "mzygmunt": "Still error:\n\nMBP-Mateusz:test3 mzygmunt$ mup deploy\nBulding App Bundle Locally\nStarted TaskList: Pushing Meteor\n[178.62.22.101] - Pushing Meteor App Bundle to The Server\n[178.62.22.101] - Pushing Meteor App Bundle to The Server: SUCCESS\n[178.62.22.101] - Pushing the Startup Script\n[178.62.22.101] - Pushing the Startup Script: SUCCESS\nStarted TaskList: Configuring  Meteor Environment Variables\n[178.62.22.101] - Sending Environment Variables\n[178.62.22.101] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[178.62.22.101] - Start Meteor\n[178.62.22.101] - Start Meteor: SUCCESS\n[178.62.22.101] - Verifying Deployment\n[178.62.22.101] x Verifying Deployment: FAILED\n``\n   -----------------------------------STDERR-----------------------------------\n   u're running the version of npm bundled with\n   npm WARN deprecated Node.js 0.10 LTS, be aware that the next version of 0.10 LTS\n   npm WARN deprecated will be bundled with a version of npm@2, which has some small\n   npm WARN deprecated backwards-incompatible changes made tonpm run-script` and\n   npm WARN deprecated semver behavior.\n   npm WARN package.json meteor-dev-bundle@0.0.0 No description\n   npm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\n   npm WARN package.json meteor-dev-bundle@0.0.0 No README data\n   => Starting meteor app on port:80\n/bundle/bundle/programs/server/node_modules/fibers/future.js:245\n                                                   throw(ex);\n                                                          ^\n   ReferenceError: module is not defined\n       at mup.js:1:1\n       at /bundle/bundle/programs/server/app/mup.js:39:4\n       at /bundle/bundle/programs/server/boot.js:242:10\n       at Array.forEach (native)\n       at Function..each..forEach (/bundle/bundle/programs/server/node_modules/underscore/underscore.js:79:11)\n       at /bundle/bundle/programs/server/boot.js:137:5\n   -----------------------------------STDOUT-----------------------------------\nTo see more logs type 'mup logs --tail=50'\n```\n\nat /Users/mzygmunt/Desktop/custom_npm/meteor-up/node_modules/nodemiral/lib/coreTasks.js:39:16\n   at /Users/mzygmunt/Desktop/custom_npm/meteor-up/node_modules/nodemiral/lib/session.js:146:9\n   at Channel. (/Users/mzygmunt/Desktop/custom_npm/meteor-up/node_modules/nodemiral/lib/ssh.js:125:9)\n   at emitOne (events.js:90:13)\n   at Channel.emit (events.js:182:7)\n   at SSH2Stream. (/Users/mzygmunt/Desktop/custom_npm/meteor-up/node_modules/ssh2/lib/Channel.js:124:14)\n   at SSH2Stream.g (events.js:273:16)\n   at emitNone (events.js:80:13)\n   at SSH2Stream.emit (events.js:179:7)\n   at parsePacket (/Users/mzygmunt/Desktop/custom_npm/meteor-up/node_modules/ssh2-streams/lib/ssh.js:3435:10)\n   at SSH2Stream._transform (/Users/mzygmunt/Desktop/custom_npm/meteor-up/node_modules/ssh2-streams/lib/ssh.js:552:13)\n   at SSH2Stream.Transform._read (_stream_transform.js:166:10)\n   at SSH2Stream._read (/Users/mzygmunt/Desktop/custom_npm/meteor-up/node_modules/ssh2-streams/lib/ssh.js:213:15)\n   at SSH2Stream.Transform._write (_stream_transform.js:154:12)\n   at doWrite (_stream_writable.js:292:12)\n   at writeOrBuffer (_stream_writable.js:278:5)\n\nIn addition, after command \"mup init\" meteor return error:\n\n20160125-21:55:17.017(1)? (STDERR) \nW20160125-21:55:17.018(1)? (STDERR) /Users/mzygmunt/.meteor/packages/meteor->tool/.1.1.10.1b51q9m++os.osx.x86_64+web.browser+web.cordova/mt-os.osx.x86_64/dev_bundle/server-lib/node_modules/fibers/future.js:245\nW20160125-21:55:17.018(1)? (STDERR)                        throw(ex);\nW20160125-21:55:17.018(1)? (STDERR)                              ^\nW20160125-21:55:17.023(1)? (STDERR) ReferenceError: module is not defined\nW20160125-21:55:17.023(1)? (STDERR)     at mup.js:1:1\nW20160125-21:55:17.023(1)? (STDERR)     at >/Users/mzygmunt/Desktop/meteor_apps/test3/.meteor/local/build/programs/server/app/mup.js:39:4\nW20160125-21:55:17.023(1)? (STDERR)     at >/Users/mzygmunt/Desktop/meteor_apps/test3/.meteor/local/build/programs/server/boot.js:242:10\nW20160125-21:55:17.023(1)? (STDERR)     at Array.forEach (native)\nW20160125-21:55:17.023(1)? (STDERR)     at Function..each..forEach >(/Users/mzygmunt/.meteor/packages/meteor->tool/.1.1.10.1b51q9m++os.osx.x86_64+web.browser+web.cordova/mt->os.osx.x86_64/dev_bundle/server-lib/node_modules/underscore/underscore.js:79:11)\nW20160125-21:55:17.023(1)? (STDERR)     at >/Users/mzygmunt/Desktop/meteor_apps/test3/.meteor/local/build/programs/server/boot.js:137:5\n=> Exited with code: 8\n\nMy configuration:\nDev machine:\nOSX El Capitan, Node v5.5.0, NPM v3.5.3\nProduction machine: clear Ubuntu 14.04 x64 vmlinuz-3.13.0-71-generic from DigitalOcean\n. Thank you for your answers. @mnmtanish you're right! It helped me a lot. But some errors were related with a damaged version of Node. Complete reinstallation Node definitively resolved the issue.\n. For me didn't work also.  I've got following error during verifying of deployment (Meteor 1.4):\n```\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor\n[178.62.22.101] - Pushing Meteor App Bundle to The Server\n[178.62.22.101] - Pushing Meteor App Bundle to The Server: SUCCESS\n[178.62.22.101] - Pushing the Startup Script\n[178.62.22.101] - Pushing the Startup Script: SUCCESS\nStarted TaskList: Configuring  Meteor Environment Variables\n[178.62.22.101] - Sending Environment Variables\n[178.62.22.101] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[178.62.22.101] - Start Meteor\n[178.62.22.101] - Start Meteor: SUCCESS\n[178.62.22.101] - Verifying Deployment\n[178.62.22.101] x Verifying Deployment: FAILED\n    -----------------------------------STDERR-----------------------------------\n    package.json meteor-dev-bundle@0.0.0 No description\n    npm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\n    npm WARN package.json meteor-dev-bundle@0.0.0 No README data\n    npm WARN cannot run in wd meteor-dev-bundle@0.0.0 node npm-rebuild.js (wd=/bundle/bundle/programs/server)\n    => Starting meteor app on port:80\n\n    assert.js:93\n      throw new assert.AssertionError({\n            ^\n    AssertionError: \"undefined\" === \"function\"\n        at wrapPathFunction (/bundle/bundle/programs/server/mini-files.js:77:10)\n        at Object.<anonymous> (/bundle/bundle/programs/server/mini-files.js:108:24)\n        at Module._compile (module.js:456:26)\n        at Object.Module._extensions..js (module.js:474:10)\n        at Module.load (module.js:356:32)\n        at Function.Module._load (module.js:312:12)\n        at Module.require (module.js:364:17)\n        at require (module.js:380:17)\n        at Object.<anonymous> (/bundle/bundle/programs/server/boot.js:9:13)\n        at Module._compile (module.js:456:26)\n\n    => Redeploying previous version of the app\n\n    -----------------------------------STDOUT-----------------------------------\n\n    To see more logs type 'mup logs --tail=50'\n\n    ----------------------------------------------------------------------------\n\n```\n. @madushan1000 Yes, my app has installed all the required NPM packages and locally works fine.\n. ",
    "wanglian": "@mzygmunt I came cross the same problem. Can you explain a little bit about how to reinstall Node? It seems it's not necessary to install Node by myself.\n. ",
    "mikeifomin": "I have the same. \nAdd deployCheckWaitTime: 60 helped\n. @madushan1000 thank you! \nI thought a small hook can help me\n``` javascript\n   // mup.js \n   var args = process.argv.slice(2);\n// do some with args and write to module.exports\n```\nBut this is absolutely dirty =(\n. ",
    "prawee": "working for me  deployCheckWaitTime: 120 \n. after use  this repo and then using \"mup setup\"  how to fixed.\nStarted TaskList: Start Mongo\n[188.166.x.x] - start mongo\n[188.166.x.x] x start mongo: FAILED\n-----------------------------------STDERR-----------------------------------\n    docker: Error response from daemon: driver failed programming external connectivity on endpoint mongodb (02f81063312a9d2f5bf32b89394893317a8bb3fee225bd52ac1862b1a9102177): Error starting userland proxy: listen tcp 127.0.0.1:27017: bind: address already in use.\n    -----------------------------------STDOUT-----------------------------------\n    latest: Pulling from library/mongo\n    Digest: sha256:e599c71179c2bbe0eab56a7809d4a8d42ddcb625b32a7a665dc35bf5d3b0f7c4\n    Status: Image is up to date for mongo:latest\n    mongodb\n    692072a22e81d253530311b277702a0849e121b8e03c45290337059f8afc6c4f\n    ----------------------------------------------------------------------------\n. ",
    "thearabbit": "Thanks for your reply.\nI will check.\n. I have the same problem.\n+1. @timbrandin, work fine with Backup.\nBut have problem with Restore\nMy backup file\n\n1- Upload backup file\n```\n$ scp -r /microfis root@0.0.0.0:/root/backup\n\nroot@localhost:~/backup# ls\naccAccountType.bson                    acc_exchangeNBC.bson                                     microfis_loanAcc.bson\naccAccountType.metadata.json           acc_exchangeNBC.metadata.json                            microfis_loanAcc.metadata.json\naccChartAccount.bson                   core_branch.bson                                         microfis_location.bson\naccChartAccount.metadata.json          core_branch.metadata.json                                microfis_location.metadata.json\naccChartAccountNBC.bson                core_company.bson                                        microfis_lookupValue.bson\naccChartAccountNBC.metadata.json       core_company.metadata.json\n2- Restore with dbName\ndocker run --rm --link mongodb:mongo -v /root:/backup mongo bash -c 'mongorestore --drop --db NEWDBNAME --host $MONGO_PORT_27017_TCP_ADDR /backup'\nBut get error\n2017-12-27T14:41:45.612+0000    the --db and --collection args should only be used when restoring from a BSON file. Other uses are deprecated and will not exist in the future; use --nsInclude instead\n2017-12-27T14:41:45.613+0000    building a list of collections to restore from /backup dir\n2017-12-27T14:41:45.613+0000    don't know what to do with file \"/backup/.bash_history\", skipping...\n2017-12-27T14:41:45.613+0000    don't know what to do with file \"/backup/.bashrc\", skipping...\n2017-12-27T14:41:45.613+0000    don't know what to do with subdirectory \"backup/.cache\", skipping...\n2017-12-27T14:41:45.613+0000    don't know what to do with file \"/backup/.lesshst\", skipping...\n2017-12-27T14:41:45.613+0000    don't know what to do with file \"/backup/.profile\", skipping...\n2017-12-27T14:41:45.613+0000    don't know what to do with file \"/backup/.selected_editor\", skipping...\n2017-12-27T14:41:45.613+0000    don't know what to do with file \"/backup/.viminfo\", skipping...\n2017-12-27T14:41:45.613+0000    don't know what to do with subdirectory \"backup/backup\", skipping...\n2017-12-27T14:41:45.613+0000    don't know what to do with subdirectory \"backup/dump\", skipping...\n2017-12-27T14:41:45.613+0000    done\nPlease help me. Don't work for me.\nI use `Local Ubutun PC` for Server.\n- Log into local server\nssh myname@192.168.0.1\n\npassword: 123\n- Remove password from sudoers\nsudo visudo\n\nUser privilege specification\nroot    ALL=(ALL:ALL) ALL\nMembers of the admin group may gain root privileges\n%admin ALL=(ALL) NOPASSWD:ALL\nAllow members of group sudo to execute any command\n%sudo   ALL=(ALL:ALL) ALL\nSee sudoers(5) for more information on \"#include\" directives:\nincludedir /etc/sudoers.d\n- Mup.js\nmodule.exports = {\n  servers: {\n    one: {\n      // TODO: set host address, username, and authentication method\n      host: '192.168.0.1',\n      username: 'myname',\n      // pem: './path/to/pem'\n      password: '123'\n      // or neither for authenticate from ssh-agent\n    }\n  },\napp: {\n    // TODO: change app name and path\n    name: 'localapp',\n    path: '../../meteor-app',\nservers: {\n  one: {},\n},\n\nbuildOptions: {\n  serverOnly: true,\n},\n\nenv: {\n  // TODO: Change to your app's url\n  // If you are using ssl, it needs to start with https://\n  ROOT_URL: 'http://192.168.0.1',\n  MONGO_URL: 'mongodb://localhost/localdb',\n},\n\n// ssl: { // (optional)\n//   // Enables let's encrypt (optional)\n//   autogenerate: {\n//     email: 'email.address@domain.com',\n//     // comma separated list of domains\n//     domains: 'website.com,www.website.com'\n//   }\n// },\n\ndocker: {\n  // change to 'abernix/meteord:base' if your app is using Meteor 1.4 - 1.5\n  image: 'abernix/meteord:node-8.4.0-base',\n},\n\n// Show progress bar while uploading bundle to server\n// You might need to disable it on CI servers\nenableUploadProgressBar: true\n\n},\nmongo: {\n    version: '3.4.1',\n    servers: {\n      one: {}\n    }\n  }\n};\n- Deploy\n// In my project\nmup setup\nGet error\nStarted TaskList: Setup Docker\n[192.168.0.121] - Setup Docker\n[192.168.0.121] x Setup Docker: FAILED\n-----------------------------------STDERR-----------------------------------\nsudo: no tty present and no askpass program specified\nsudo: no tty present and no askpass program specified\nsudo: no tty present and no askpass program specified\nsudo: no tty present and no askpass program specified\nsudo: no tty present and no askpass program specified\nsudo: no tty present and no askpass program specified\n-----------------------------------STDOUT-----------------------------------\n\nMajor\nMinor\n----------------------------------------------------------------------------\n\nPlease help me\n  . thanks \ud83d\udc4d . I still have problem with this.\nI stay in `Asia/Phnom_Penh`.\nPlease help me.. You solved already? Pl share\n. I backup and upload it to slack.\ndocker exec mongodb mongodump --db DATABASE_NAME --out /backup/PrefixName_$(date +%Y-%m-%d)\n........\n```\n\nBut I have problem with restore\n1- upload backup file to server\n$ scp -r ./backup root@IP:/root/backup\n2- Restore with dbName\ndocker run --rm --link mongodb:mongo -v /root:/backup mongo bash -c \u2018mongorestore --drop --db NEWDBNAME --host $MONGO_PORT_27017_TCP_ADDR /backup\u2019\nBut don't work. thanks for your reply.\nI base on Mac, I tried to put the password: '123456' but still the same problem.\nCould you help with SSH?. thanks for your reply.\nMy PC password or any? I tried to add my PC password, but still don't work\nPlease help me\n. I can't connect my PC via this\n~ ssh root@192.168.0.101\nssh: connect to host 192.168.0.101 port 22: Connection refused\nHow to solve?. thanks I will try soon\n. Now I can log into my local PC via ssh\n\u279c  ~ ssh theara@192.168.0.103\nPassword:\nLast login: Fri Jan  5 10:58:57 2018\n\u279c  ~\nAnd then I try mup setup on my project after exit of ssh access\n```js\nmodule.exports = {\n  servers: {\n    one: {\n      // TODO: set host address, username, and authentication method\n      host: '192.168.0.103',\n      username: 'theara',\n      // pem: './path/to/pem'\n      password: ' ***'\n      // or neither for authenticate from ssh-agent\n    }\n  },\napp: {\n    // TODO: change app name and path\n    name: 'localapp',\n    path: '../../meteor-app',\nservers: {\n  one: {},\n},\n\nbuildOptions: {\n  serverOnly: true,\n},\n\nenv: {\n  // TODO: Change to your app's url\n  // If you are using ssl, it needs to start with https://\n  ROOT_URL: 'http://192.168.0.103',\n  MONGO_URL: 'mongodb://localhost/localdb',\n},\n\n// ssl: { // (optional)\n//   // Enables let's encrypt (optional)\n//   autogenerate: {\n//     email: 'email.address@domain.com',\n//     // comma separated list of domains\n//     domains: 'website.com,www.website.com'\n//   }\n// },\n\ndocker: {\n  // change to 'abernix/meteord:base' if your app is using Meteor 1.4 - 1.5\n  image: 'abernix/meteord:node-8.4.0-base',\n},\n\n// Show progress bar while uploading bundle to server\n// You might need to disable it on CI servers\nenableUploadProgressBar: true\n\n},\nmongo: {\n    version: '3.4.1',\n    servers: {\n      one: {}\n    }\n  }\n};\nGet errorjs\n\u279c  .deploy git:(master) \u2717 mup setup\nStarted TaskList: Setup Docker\n[192.168.0.103] - Setup Docker\nevents.js:160\n      throw er; // Unhandled 'error' event\n      ^\nError: All configured authentication methods failed\n    at tryNextAuth (/usr/local/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2/lib/client.js:290:17)\n    at SSH2Stream.onUSERAUTH_FAILURE (/usr/local/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2/lib/client.js:469:5)\n    at emitTwo (events.js:106:13)\n    at SSH2Stream.emit (events.js:191:7)\n    at parsePacket (/usr/local/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2-streams/lib/ssh.js:3647:10)\n    at SSH2Stream._transform (/usr/local/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2-streams/lib/ssh.js:551:13)\n    at SSH2Stream.Transform._read (_stream_transform.js:167:10)\n    at SSH2Stream._read (/usr/local/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2-streams/lib/ssh.js:212:15)\n    at SSH2Stream.Transform._write (_stream_transform.js:155:12)\n    at doWrite (_stream_writable.js:333:12)\n    at writeOrBuffer (_stream_writable.js:319:5)\n    at SSH2Stream.Writable.write (_stream_writable.js:246:11)\n    at Socket.ondata (_stream_readable.js:555:20)\n    at emitOne (events.js:96:13)\n    at Socket.emit (events.js:188:7)\n    at readableAddChunk (_stream_readable.js:176:18)\nPlease help me\n  . I tried on `Ubuntu Local`\n$ mup setup\n\nStarted TaskList: Setup Docker\n[192.168.0.121] - Setup Docker\n[192.168.0.121] x Setup Docker: FAILED\n-----------------------------------STDERR-----------------------------------\nsudo: no tty present and no askpass program specified\nsudo: no tty present and no askpass program specified\nsudo: no tty present and no askpass program specified\nsudo: no tty present and no askpass program specified\nsudo: no tty present and no askpass program specified\nsudo: no tty present and no askpass program specified\n-----------------------------------STDOUT-----------------------------------\n\nMajor\nMinor\n\n. And then I modifier `sudo visudo`\nMembers of the admin group may gain root privileges\n%admin ALL=(ALL) NOPASSWD:ALL\nAllow members of group sudo to execute any command\n%sudo   ALL=(ALL:ALL) ALL\nBut still the same problem. Very thanks, I work fine \ud83d\udc4d . thanks for your reply.\nNow I tried `mup setup` and then `mup deploy`, It work fine.\n(I am not clear, bc the second IP, I used to `mup setup` before).. Now it work fine, \ud83d\udc4d . Excuse me, I still have this problem much time.js\nCONTAINER ID        IMAGE                       COMMAND                  CREATED             STATUS                     PORTS                        NAMES\n73ca3b789e76        mup-microfis-small:latest   \"/bin/sh -c 'bash $M\u2026\"   6 hours ago         Up 2 hours                 0.0.0.0:4030->80/tcp         microfis-small\nb9a0c5d71e05        mongo:3.4.1                 \"/entrypoint.sh mong\u2026\"   6 hours ago         Up 2 hours                 127.0.0.1:27017->27017/tcp   mongodb\n9cadac9be4df        mup-microfis-pos:latest     \"/bin/sh -c 'bash $M\u2026\"   17 hours ago        Exited (137) 2 hours ago                                microfis-pos\n36035d195692        mup-microfis:latest         \"/bin/sh -c 'bash $M\u2026\"   18 hours ago        Exited (137) 2 hours ago   0.0.0.0:4010->80/tcp         microfis\n52a842df3ef0        mup-pos3010:latest          \"/bin/sh -c 'bash $M\u2026\"   11 days ago         Exited (137) 2 hours ago                                pos3010\nf212f3e100a9        mup-pos:latest              \"/bin/sh -c 'bash $M\u2026\"   11 days ago         Exited (137) 2 hours ago                                pos\nroot@localhost:~# docker stop 73c\nError response from daemon: cannot stop container: 73c: Cannot kill container 73ca3b789e76f2cc6d75bb125303974e6df5be7fa8018de2cd2c2a255c59fcc2: connection error: desc = \"transport: dial unix /var/run/docker/containerd/docker-containerd.sock: connect: connection refused\": unknown\nPlease help me.\n. Thanks for your reply, after I changed `false` on serverOnly\nget error\nBuilding App Bundle Locally\nErrors prevented bundling:\nWhile minifying app code:\n/Users/theara/.meteor/packages/standard-minifiers/.1.0.2.1y9w87w++os+web.browser+web.cordova/plugin.minifyStd.os/npm/minifiers/node_modules/uglify-js/lib/parse.js:196:18:\nUnexpected token: name (fs)\nat new JS_Parse_Error\n(/Users/theara/.meteor/packages/standard-minifiers/.1.0.2.1y9w87w++os+web.browser+web.cordova/plugin.minifyStd.os/npm/minifiers/node_modules/uglify-js/lib/parse.js:196:18)\nat js_error\n(/Users/theara/.meteor/packages/standard-minifiers/.1.0.2.1y9w87w++os+web.browser+web.cordova/plugin.minifyStd.os/npm/minifiers/node_modules/uglify-js/lib/parse.js:204:11)\nat croak\n(/Users/theara/.meteor/packages/standard-minifiers/.1.0.2.1y9w87w++os+web.browser+web.cordova/plugin.minifyStd.os/npm/minifiers/node_modules/uglify-js/lib/parse.js:675:9)\nat token_error\n(/Users/theara/.meteor/packages/standard-minifiers/.1.0.2.1y9w87w++os+web.browser+web.cordova/plugin.minifyStd.os/npm/minifiers/node_modules/uglify-js/lib/parse.js:683:9)\nat unexpected\n(/Users/theara/.meteor/packages/standard-minifiers/.1.0.2.1y9w87w++os+web.browser+web.cordova/plugin.minifyStd.os/npm/minifiers/node_modules/uglify-js/lib/parse.js:689:9)\nat semicolon\n(/Users/theara/.meteor/packages/standard-minifiers/.1.0.2.1y9w87w++os+web.browser+web.cordova/plugin.minifyStd.os/npm/minifiers/node_modules/uglify-js/lib/parse.js:709:43)\nat simple_statement\n(/Users/theara/.meteor/packages/standard-minifiers/.1.0.2.1y9w87w++os+web.browser+web.cordova/plugin.minifyStd.os/npm/minifiers/node_modules/uglify-js/lib/parse.js:889:73)\nat\n/Users/theara/.meteor/packages/standard-minifiers/.1.0.2.1y9w87w++os+web.browser+web.cordova/plugin.minifyStd.os/npm/minifiers/node_modules/uglify-js/lib/parse.js:762:19\nat\n/Users/theara/.meteor/packages/standard-minifiers/.1.0.2.1y9w87w++os+web.browser+web.cordova/plugin.minifyStd.os/npm/minifiers/node_modules/uglify-js/lib/parse.js:722:24\nat block_\n(/Users/theara/.meteor/packages/standard-minifiers/.1.0.2.1y9w87w++os+web.browser+web.cordova/plugin.minifyStd.os/npm/minifiers/node_modules/uglify-js/lib/parse.js:1002:20)\n````. Thanks for your reply.\nYes I have\n\n. Excuse me, I don't understand what you mean?\nYou would like to see full IP?\n\n. OK, I try again.\n\nNow it work fine. Very thanks\nExcuse me have one problem with run meteor local to this\n// root path\nMONGO_URL=mongodb://theara:<PASSWORD>@rabbit-shard-00-00-1kplv.mongodb.net:27017,rabbit-shard-00-01-1kplv.mongodb.net:27017,rabbit-shard-00-02-1kplv.mongodb.net:27017/dbName?ssl=true&replicaSet=rabbit-shard-0&authSource=admin meteor\nGet error\nzsh: parse error near `&'\nCould help me again?\n. Now it is OK\nforum. Very thank for your reply. Very thanks, I will try soon. Work fine with use bcrypt@3.0.0. ",
    "reduxdj": "Updated node v5.5.0 and same results happen\n. I think the issue might be that meteor tries to build all js files, and the result is it's trying to read my mup.js file is in my project folder. maybe mup.js should be ignored by meteor here:\n// files to ignore when bundling. node has no globs, so use regexps\nvar ignore_files = [\n    /~$/, /^.#/, /^#.#$/,\n    /^.DS_Store$/, /^ehthumbs.db$/, /^Icon.$/, /^Thumbs.db$/,\n    /^.meteor$/, / avoids scanning N^2 files when bundling all packages /\n    /^.git$/ / often has too many files to watch */\n];\n. Ok, i am just trying to customize my docker image. I need to add openssh to the image, and nginx? But the docker image that mupx uses does not have open ssh. \nAny ideas how to get over this hurdle?\n. Really? what's the path variable for meteor suppose to look like? \n. mup deploy --config=.deploy/mup.js\nError: Cannot find module '/Users/plemiuex/parooz/mup.js'\n. mup -v could show version info of which mup version is running\n. ",
    "bcbrian": "For others having this problem it was resolved for me by installing meteor. Hahaha. Thats what I get for reinstalling my os, cloning my repo and just thinking it will all work.\n. ",
    "dufia": "Hey Madushan,\nI can't get it to work right now. I will give it another shot when you are closer to the final release. Currently I get this errors while trying to setup, maybe you find it helpful:\n```\nStarted TaskList: Setup Docker\n[1.2.3.4] - setup docker\nevents.js:72\n        throw er; // Unhandled 'error' event\n              ^\nError: Timed out while waiting for handshake\n    at [object Object]._onTimeout (/development/node/nauka/meteor/meteor-up/node_modules/nodemiral/node_modules/ssh2/lib/client.js:138:17)\n    at Timer.listOnTimeout [as ontimeout] (timers.js:121:15)\n```\nMupx sets up with no problems. Are you sure the new Meteor-up will support Mongo outside of the Docker? Thanks and have a great day!\n. Hey Madushan!\nI've just found out, that if you specify a custom port you will get some errors on 'Verifying Deployment' although the apps seems to be deployed 100% right on the specified port. Maybe its still looking for the app on 80 or something? Have a good day!\n```\nenv: {\n  PORT: 3000,\n  ROOT_URL: 'http://myapp.com',\n  MONGO_URL: 'mongodb://localhost/meteor'\n}\nStarted TaskList: Start Meteor\n[172.62.43.119] - Start Meteor\n[172.62.43.119] - Start Meteor: SUCCESS\n[172.62.43.119] - Verifying Deployment\n[172.62.43.119] x Verifying Deployment: FAILED\n-----------------------------------STDERR-----------------------------------\n  a\n\nfibers@1.0.5 install /bundle/bundle/programs/server/node_modules/fibers\nnode ./build.js\n\nlinux-x64-v8-3.14 exists; testing\n  Binary is fine; exiting\n  ansi-regex@0.2.1 node_modules/ansi-regex\nansi-styles@1.1.0 node_modules/ansi-styles\nescape-string-regexp@1.0.3 node_modules/escape-string-regexp\nchalk@0.5.1 node_modules/chalk\nhas-ansi@0.1.0 node_modules/has-ansi\nsupports-color@0.2.0 node_modules/supports-color\nstrip-ansi@0.3.0 node_modules/strip-ansi\neachline@2.3.3 node_modules/eachline\ntype-of@2.0.1 node_modules/type-of\namdefine@1.0.0 node_modules/amdefine\nasap@2.0.3 node_modules/asap\nunderscore@1.5.2 node_modules/underscore\nmeteor-promise@0.5.0 node_modules/meteor-promise\npromise@7.0.4 node_modules/promise\nsource-map-support@0.3.2 node_modules/source-map-support\nsemver@4.1.0 node_modules/semver\nsource-map@0.1.32 node_modules/source-map\nfibers@1.0.5 node_modules/fibers\n  => Starting meteor app on port:80\n  startup server\n=> Redeploying previous version of the app\n-----------------------------------STDOUT-----------------------------------\nTo see more logs type 'mup logs --tail=50'\n\nError: \n-----------------------------------STDERR-----------------------------------\na\n\nfibers@1.0.5 install /bundle/bundle/programs/server/node_modules/fibers\nnode ./build.js\n\nlinux-x64-v8-3.14 exists; testing\nBinary is fine; exiting\nansi-regex@0.2.1 node_modules/ansi-regex\nansi-styles@1.1.0 node_modules/ansi-styles\nescape-string-regexp@1.0.3 node_modules/escape-string-regexp\nchalk@0.5.1 node_modules/chalk\nhas-ansi@0.1.0 node_modules/has-ansi\nsupports-color@0.2.0 node_modules/supports-color\nstrip-ansi@0.3.0 node_modules/strip-ansi\neachline@2.3.3 node_modules/eachline\ntype-of@2.0.1 node_modules/type-of\namdefine@1.0.0 node_modules/amdefine\nasap@2.0.3 node_modules/asap\nunderscore@1.5.2 node_modules/underscore\nmeteor-promise@0.5.0 node_modules/meteor-promise\npromise@7.0.4 node_modules/promise\nsource-map-support@0.3.2 node_modules/source-map-support\nsemver@4.1.0 node_modules/semver\nsource-map@0.1.32 node_modules/source-map\nfibers@1.0.5 node_modules/fibers\n=> Starting meteor app on port:80\nstartup server\n=> Redeploying previous version of the app\n-----------------------------------STDOUT-----------------------------------\nTo see more logs type 'mup logs --tail=50'\n\nat /development/node/nauka/meteor/meteor-up/node_modules/nodemiral/lib/coreTasks.js:39:16\nat /development/node/nauka/meteor/meteor-up/node_modules/nodemiral/lib/session.js:146:9\nat Channel.<anonymous> (/development/node/nauka/meteor/meteor-up/node_modules/nodemiral/lib/ssh.js:125:9)\nat Channel.emit (events.js:107:17)\nat SSH2Stream.<anonymous> (/development/node/nauka/meteor/meteor-up/node_modules/nodemiral/node_modules/ssh2/lib/Channel.js:124:14)\nat SSH2Stream.g (events.js:199:16)\nat SSH2Stream.emit (events.js:104:17)\nat parsePacket (/development/node/nauka/meteor/meteor-up/node_modules/nodemiral/node_modules/ssh2/node_modules/ssh2-streams/lib/ssh.js:3435:10)\nat SSH2Stream._transform (/development/node/nauka/meteor/meteor-up/node_modules/nodemiral/node_modules/ssh2/node_modules/ssh2-streams/lib/ssh.js:552:13)\nat SSH2Stream.Transform._read [as __read] (_stream_transform.js:179:10)\nat SSH2Stream._read (/development/node/nauka/meteor/meteor-up/node_modules/nodemiral/node_modules/ssh2/node_modules/ssh2-streams/lib/ssh.js:213:15)\nat SSH2Stream.Transform._write (_stream_transform.js:167:12)\nat doWrite (_stream_writable.js:301:12)\nat writeOrBuffer (_stream_writable.js:288:5)\nat SSH2Stream.Writable.write (_stream_writable.js:217:11)\nat Socket.ondata (_stream_readable.js:540:20)\n\n```\n. I did it, it took a little longer but still ended up with the same errors. The newest build of the app is running fine on :3000 anyway, my mup.js:\n```\nmodule.exports = {\n  servers: {\n    one: {\n      \"host\": \"123.32.12.123\",\n      \"username\": \"root\",\n      //\"password\": \"password\"\n      // or pem file (ssh based authentication)\n      \"pem\": \"/Users/konradmoskal/.ssh/id_rsa\"\n    },\n  },\nmeteor: {\n    name: 'myapp',\n    path: '/development/node/nauka/meteor/mmameta-client/app',\n    servers: {\n      one: {},\n    },\n    env: {\n      PORT: 3000,\n      ROOT_URL: 'http://myapp.com',\n      MONGO_URL: 'mongodb://localhost/27016'\n    },\n    deployCheckWaitTime: 90,\n  },\nmongo: {\n    oplog: true,\n    port: 27016,\n    servers: {\n      one: {},\n    },\n  }\n};\n```\n. @THPubs \n\nwhen deploying two apps, is it going to use the same mongo container? \n\nHere it gets tricky, you don't really have control over MongoDB when using MUP. I have a Backbone app that uses MongoDB and I would like my Meteor app to share the same DB. Still, I would like to use MUP cause its good software.\nIts seems easy to DO, but it isn't. MUP claims to support MongoDB outside of MUP, but fails badly. I tried current MUP, current MUPX and the newest MUP (under development). Neither of them supported MongoDB outside of MUP (or Docker), errors everywhere. Try it yourself. I am waiting for the newest stable of MUP.\n. same here +1\n. @THPubs\nI tried to connect two apps to the same database (localhost:27017) with all versions of MUP: Old, MUPX, current. MUPX has the same issues like the current (under development). I think it is because it is inside Docker and you are unable to access localhost. I don't know if it is a feature or a bug, it just doesn't work. https://github.com/arunoda/meteor-up/issues/828\n@madushan1000 \nThat being said (MUP is unable to access database via localhost:27017), do you think it would work if database was accessed via servers ip address instead? Like http://128.34.32.349:27017\n. @madushan1000 @THPubs \nThanks. Now everything is clear, you can easily connect multiple apps to the same database, just not via localhost. You have to allow Mongo to be remotely accessed and use servers IP address. I know, it might be silly for back-end expert but for me it wasn't.\n. this must have been a mistake, related to error during mongo installation on the server, closed\n. ",
    "THPubs": "Sure. Here's the mup.js. I can login with those credentials :-)\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '10.0.0.151',\n      user: 'pubudu',\n      password: 'password'\n      // \"sshOptions\": {\n      //   \"port\": 5722\n      // }\n      // pem: './mykey',\n    },\n  },\nmeteor: {\n    name: 'jltfrontend',\n    path: '../jlt-frontend',\n    servers: {\n      one: {},\n    },\n    env: {\n      ROOT_URL: 'http://jlt.leafycode.com',\n      MONGO_URL: 'mongodb://localhost/jltdb'\n    },\n  },\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n```\n. I added it like this :\npassword: 'password',\n  sshOptions: {\n    'StrictHostKeyChecking': 'no',\n    'UserKnownHostsFile': '/dev/null',\n    'ConnectTimeout': '60'\n  }\nand now I see this error :-(\n```\n[188.166.243.100] - setup docker\nevents.js:154\n      throw er; // Unhandled 'error' event\n      ^\nError: All configured authentication methods failed\n    at tryNextAuth (/home/pubudu/meteor-up/node_modules/ssh2/lib/client.js:290:17)\n    at SSH2Stream.onUSERAUTH_FAILURE (/home/pubudu/meteor-up/node_modules/ssh2/lib/client.js:469:5)\n    at emitTwo (events.js:100:13)\n    at SSH2Stream.emit (events.js:185:7)\n    at parsePacket (/home/pubudu/meteor-up/node_modules/ssh2-streams/lib/ssh.js:3647:10)\n    at SSH2Stream._transform (/home/pubudu/meteor-up/node_modules/ssh2-streams/lib/ssh.js:552:13)\n    at SSH2Stream.Transform._read (_stream_transform.js:166:10)\n    at SSH2Stream._read (/home/pubudu/meteor-up/node_modules/ssh2-streams/lib/ssh.js:213:15)\n    at SSH2Stream.Transform._write (_stream_transform.js:154:12)\n    at doWrite (_stream_writable.js:292:12)\n    at writeOrBuffer (_stream_writable.js:278:5)\n    at SSH2Stream.Writable.write (_stream_writable.js:207:11)\n    at Socket.ondata (_stream_readable.js:529:20)\n    at emitOne (events.js:90:13)\n    at Socket.emit (events.js:182:7)\n    at readableAddChunk (_stream_readable.js:147:16)\n``\n. Ahaa great it was the issue! Now it's fixed... Thanks bro! :-)\n. I think the issue is now solved. Now we need to usepasswordinstead ofpass`. Im closing the issue :-)\n. @dufia @madushan1000 Thanks it worked! But even though the app is deployed and working, I get the same error dufia gets.\nAnother small question... when deploying two apps, is it going to use the same mongo container? When I deployed the second app I think it removed the existing mongo container and created a new one!\n. @madushan1000 Actually this is for a small app. It does give issues if I remove the mongo from the mup.js and just leave the url for the existing one...\nmongo: {\n  oplog: true,\n  port: 27027,\n  servers: {\n    one: {},\n  },\n},\nI was trying to connect two apps to a single db.\n. @dufia :-(\nHope we can get a solution soon. The old mup didn't work well with meteor 1.3... Tomorrow I have to launch an app. :-)\n. Thanks I tried that but then faced with a 502 bad gateway error when visit the site. Here's the mup logs :\n[188.166.243.100]/bundle/bundle/programs/server/node_modules/fibers/future.js:300\n    [188.166.243.100]                       throw(ex);\n    [188.166.243.100]                             ^\n    [188.166.243.100]Error: failed to connect to [localhost:27017]\n    [188.166.243.100]    at Object.Future.wait (/bundle/bundle/programs/server/node_modules/fibers/future.js:420:15)\n    [188.166.243.100]    at new MongoConnection (packages/mongo/mongo_driver.js:213:27)\n    [188.166.243.100]    at new MongoInternals.RemoteCollectionDriver (packages/mongo/remote_collection_driver.js:4:16)\n    [188.166.243.100]    at Object.<anonymous> (packages/mongo/remote_collection_driver.js:38:10)\n    [188.166.243.100]    at Object.defaultRemoteCollectionDriver (packages/underscore/underscore.js:750:1)\n    [188.166.243.100]    at new Mongo.Collection (packages/mongo/collection.js:102:40)\n    [188.166.243.100]    at Package (packages/cfs_tempstore/packages/cfs_tempstore.js:39:1)\n    [188.166.243.100]    at Package (packages/cfs_tempstore/packages/cfs_tempstore.js:394:1)\n    [188.166.243.100]    at packages/cfs_tempstore/packages/cfs_tempstore.js:394:1\n    [188.166.243.100]    at packages/cfs_tempstore/packages/cfs_tempstore.js:394:1\n    [188.166.243.100]    - - - - -\n    [188.166.243.100]    at [object Object].<anonymous> (/bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/connection/server.js:556:74)\n    [188.166.243.100]    at [object Object].emit (events.js:106:17)\n    [188.166.243.100]    at [object Object].<anonymous> (/bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/connection/connection_pool.js:156:15)\n    [188.166.243.100]    at [object Object].emit (events.js:98:17)\n    [188.166.243.100]    at Socket.<anonymous> (/bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/connection/connection.js:534:10)\n    [188.166.243.100]    at Socket.emit (events.js:95:17)\n    [188.166.243.100]    at net.js:441:14\n    [188.166.243.100]    at process._tickCallback (node.js:448:13)\n    [188.166.243.100]npm WARN deprecated This version of npm lacks support for important features,\n    [188.166.243.100]npm WARN deprecated such as scoped packages, offered by the primary npm\n    [188.166.243.100]npm WARN deprecated registry. Consider upgrading to at least npm@2, if not the\n    [188.166.243.100]npm WARN deprecated latest stable version. To upgrade to npm@2, run:\n    [188.166.243.100]npm WARN deprecated \n    [188.166.243.100]npm WARN deprecated   npm -g install npm@latest-2\n    [188.166.243.100]npm WARN deprecated \n    [188.166.243.100]npm WARN deprecated To upgrade to the latest stable version, run:\n    [188.166.243.100]npm WARN deprecated \n    [188.166.243.100]npm WARN deprecated   npm -g install npm@latest\n    [188.166.243.100]npm WARN deprecated \n    [188.166.243.100]npm WARN deprecated (Depending on how Node.js was installed on your system, you\n    [188.166.243.100]npm WARN deprecated may need to prefix the preceding commands with `sudo`, or if\n    [188.166.243.100]npm WARN deprecated on Windows, run them from an Administrator prompt.)\n    [188.166.243.100]npm WARN deprecated \n    [188.166.243.100]npm WARN deprecated If you're running the version of npm bundled with\n    [188.166.243.100]npm WARN deprecated Node.js 0.10 LTS, be aware that the next version of 0.10 LTS\n    [188.166.243.100]npm WARN deprecated will be bundled with a version of npm@2, which has some small\n    [188.166.243.100]npm WARN deprecated backwards-incompatible changes made to `npm run-script` and\n    [188.166.243.100]npm WARN deprecated semver behavior.\n    [188.166.243.100]npm WARN package.json meteor-dev-bundle@0.0.0 No description\n    [188.166.243.100]npm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\n    [188.166.243.100]npm WARN package.json meteor-dev-bundle@0.0.0 No README data\n    [188.166.243.100]=> Starting meteor app on port:80\n    [188.166.243.100]\n    [188.166.243.100]/bundle/bundle/programs/server/node_modules/fibers/future.js:300\n    [188.166.243.100]                       throw(ex);\n    [188.166.243.100]                             ^\n    [188.166.243.100]Error: failed to connect to [localhost:27017]\n    [188.166.243.100]    at Object.Future.wait (/bundle/bundle/programs/server/node_modules/fibers/future.js:420:15)\n    [188.166.243.100]    at new MongoConnection (packages/mongo/mongo_driver.js:213:27)\n    [188.166.243.100]    at new MongoInternals.RemoteCollectionDriver (packages/mongo/remote_collection_driver.js:4:16)\n    [188.166.243.100]    at Object.<anonymous> (packages/mongo/remote_collection_driver.js:38:10)\n    [188.166.243.100]    at Object.defaultRemoteCollectionDriver (packages/underscore/underscore.js:750:1)\n    [188.166.243.100]    at new Mongo.Collection (packages/mongo/collection.js:102:40)\n    [188.166.243.100]    at Package (packages/cfs_tempstore/packages/cfs_tempstore.js:39:1)\n    [188.166.243.100]    at Package (packages/cfs_tempstore/packages/cfs_tempstore.js:394:1)\n    [188.166.243.100]    at packages/cfs_tempstore/packages/cfs_tempstore.js:394:1\n    [188.166.243.100]    at packages/cfs_tempstore/packages/cfs_tempstore.js:394:1\n    [188.166.243.100]    - - - - -\n    [188.166.243.100]    at [object Object].<anonymous> (/bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/connection/server.js:556:74)\n    [188.166.243.100]    at [object Object].emit (events.js:106:17)\n    [188.166.243.100]    at [object Object].<anonymous> (/bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/connection/connection_pool.js:156:15)\n    [188.166.243.100]    at [object Object].emit (events.js:98:17)\n    [188.166.243.100]    at Socket.<anonymous> (/bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/connection/connection.js:534:10)\n    [188.166.243.100]    at Socket.emit (events.js:95:17)\n    [188.166.243.100]    at net.js:441:14\n    [188.166.243.100]    at process._tickCallback (node.js:448:13)\nIt looks like it's failing to connect to the mongo database. I then removed mongo from both the mups and installed mongo locally and let the apps connect to it. Still not working. The app will only connect to it's own mongo docker container (Also we can't change the port of that mongo container. It use the default one).\n. Actually I have no other choice... The old mup didn't work. Might be because im using meteor 1.3?\n. Ah thanks :-) I will give another look at the old mup :-)\n. @madushan1000 Great! I just created a custom docker image with imagemagick and deployed! So far so good.. everything's working fine :-) I will test it further and let you know if there's anything wrong!\n. I'm also facing the same issue. But my settings.json is empty.\n. Any updates on this issue? I'm still having this issue and now it's more frequent.. In the client browser console, I see this error WebSocket connection to 'wss://oursite.com/sockjs/373/2lrpal10/websocket' failed: WebSocket is closed before the connection is established.\n. It's happening all the time even for me!. @albertonaperijr How can I fix it? I have two apps which need to rely on the same database (MLab).. ",
    "jononomo": "I am having exactly the same problem.  I am using release 1.3-beta-5.\n. ",
    "gloffreda": "I'm having the same issue:\nMeteor Up: Production Quality Meteor Deployments\n\u201c Checkout Kadira!\n  It's the best way to monitor performance of your app.\n  Visit: https://kadira.io/mup \u201d\nBuilding Started: .\nevents.js:154\n      throw er; // Unhandled 'error' event\n      ^\nError: spawn meteor ENOENT\n    at exports._errnoException (util.js:890:11)\n    at Process.ChildProcess._handle.onexit (internal/child_process.js:182:32)\n    at onErrorNT (internal/child_process.js:348:16)\n    at _combinedTickCallback (internal/process/next_tick.js:74:11)\n    at process._tickCallback (internal/process/next_tick.js:98:9)\n    at Function.Module.runMain (module.js:449:11)\n    at startup (node.js:146:18)\n    at node.js:404:3\nand here is my mup.json\n```\n{\n  \"servers\": [\n    {\n      \"host\": \"host.com\",\n      \"username\": \"username\",\n      \"password\": \"password\" \n    }\n  ],\n\"setupMongo\": true,\n  \"setupNode\": true,\n  \"nodeVersion\": \"0.10.40\",\n  \"setupPhantom\": true,\n  \"enableUploadProgressBar\": true,\n\"appName\": \"flashsite\",\n  \"app\": \".\",\n\"env\": {\n    \"ROOT_URL\": \"http://host.com\",\n    \"PORT\": 3001\n  },\n\"deployCheckWaitTime\": 15\n}\n```\n. Hi Madushan\nYes I do. But something strange is in my whole system. I'm doing a fresh install and will try again. I'll update here as soon as finish the install.\nThanks\n. ",
    "Rathius": "I'm seeing this when I try to deploy to AWS\nBuilding Started: /Development/cville200\nevents.js:154\n      throw er; // Unhandled 'error' event\n      ^\nError: spawn meteor ENOENT\n    at exports._errnoException (util.js:890:11)\n    at Process.ChildProcess._handle.onexit (internal/child_process.js:182:32)\n    at onErrorNT (internal/child_process.js:348:16)\n    at _combinedTickCallback (node.js:383:13)\n    at process._tickCallback (node.js:407:11)\n    at Function.Module.runMain (module.js:449:11)\n    at startup (node.js:142:18)\n    at node.js:939:3\nHere's my mup.json file\n```\n{\n // Server authentication info\n  \"servers\": [\n    {\n      \"host\": \"the IP address\",\n      \"username\": \"ubuntu\",\n      //\"password\": \"password\",\n      // or pem file (ssh based authentication)\n     \"pem\": \"location of my .pem file\"\n    }\n  ],\n\"setupMongo\": true,\n\"setupNode\": true,\n\"nodeVersion\": \"0.10.36\",\n\"setupPhantom\": true,\n\"enableUploadProgressBar\": true,\n\"appName\": \"cville200Web\",\n\"app\": \".\",\n\"env\": {\n    \"ROOT_URL\": \"the root URL\"\n  },\n\"deployCheckWaitTime\": 15\n}\n```\n. well I assumed it was since I can run meteor create from any folder on my machine, but I'll double-check to make sure.\n. I ran \"which meteor\" from the command prompt in my home directory and this was what it returned.\n     /usr/local/bin/meteor\nSo by that I'm assuming that it is in my PATH.\nAny other suggestions?\n. oh wait, by build machine are you referring to my computer or the remote server?\n. That's what I thought but wanted to make sure. \nI'm trying to deploy to AWS. I did it once earlier this year but I can't find the mup.json file for that deployment. \n. ",
    "edu2969": "I was using public IP addres, then I replace for internal IP addres.\nSo, replacing mi public IP\n\"host\": \"172.xxx.xxx.xxx\"\nby internal IP, getting throw ifconfig like\n\"host\": \"192.168.x.xxx\"\nResolve the issue.\nIm using Meteor 1.4.3.2 in Debian 8, with Node 4.6.2 y NPM 2.15.11\nGood luck!. ",
    "erperejildo": "If I use pass instead password I get this issue:\n\n1 Validation Error:\n  - \"servers.one.pass\" is an unknown property\n. I did the same but stil having same issue. Not using ssh key\n\nEdit: working now, I was doing this change on my local machine. same error here using 1.2.3v. Using 1.2.6 I got this: endpoint myApp not found\nBut could be related with my Nginx because I was trying with pm2 and I made some changes. Thanks bud!. I'm able to login with my ssh key, but I'm trying the easier way right now to check the setup was ok.\nI tried this just once.\nShall I change to ssh?. My broadband connection is too bad. Could I do same deploy with gitlab-ci on pipelines?. Where do I need to install Meteor? mup.js, .gitlab-ci.yml, server...\nSorry but still struggling with Meteor deployment after many days and every step sounds totally different to previous one.\nWhat I'd like is push my commits to master and from this update my code and restart the app on my server (DigitalOcean). This server has everything configured (or that's what I thought because only can see Nginx now: http://178.62.79.50/).\nI wouldn't like to deploy from my terminal but as you said from Gitlab would be possible. Do you know maybe a tutorial about this?\nThank you so much!. Thanks for your answer @shadowcodex.\nSo running mup deploy I'll push my code to Gitlab? I thought it was pushed to my server.\nWhat I don't understand then is why we need a yml file on Gitlab to configure our server settings.\nAlso if I need to push my code to develop and just deploy when I push to master I should do git push origin develop and mup deploy which sounds confusing or not easy to understand at least.\nRight now when I push to master I've got some runners doing this.\nAlso I can avoid some compilations/deploys when I push to Gitlab adding some parameters on commits. Could I do the same with mup if I want to push to master?. Yes, I could but I don't want to storage my ssh key on my project. If is not possible to do this with Gitlab, ok, I'll do it like that. But if I put my ssh key on that file and I deploy my app this contains the ssh key?. If I do that I need to comment out my password/ssh key on my mup.json and I get this:\n\nerror: server one doesn't have password, ssh-agent or pem. No sorry, I mean right now. I'm deploying my app with the ssh key because it's on my project folder:\npem: '../private/recipic_mup_rsa'\nBut that's ok if I can use the Gitlab ssh key the problem is what I have commented: I need to get rid of this line on my mup.json but if I do that I get the previous error. I don't know exactly what do you mean. I don't create any file on my CI process. This file is the normal mup.js located on my .deploy folder. Can't run sudo on Gitlab CI. Would this fix the issue?. \n",
    "SachaG": "In case this helps anyone: I was getting this error but then realized my own local network tool (Little Snitch) was blocking the connection. . For some reason even with @abernix's image I'm still not able to deploy. I get:\nnpm ERR! node v4.4.7\n    npm ERR! npm  v3.10.5\n    npm ERR! code ELIFECYCLE\n    npm ERR! meteor-dev-bundle@0.0.0 install: `node npm-rebuild.js`\n    npm ERR! Exit status 1\n    npm ERR!\n    npm ERR! Failed at the meteor-dev-bundle@0.0.0 install script 'node npm-rebuild.js'.\n    npm ERR! Make sure you have the latest version of node.js and npm installed.\n    npm ERR! If you do, this is most likely a problem with the meteor-dev-bundle package,\n    npm ERR! not with npm itself.\n    npm ERR! Tell the author that this fails on your system:\n    npm ERR!     node npm-rebuild.js\n    npm ERR! You can get information on how to open an issue for this project with:\n    npm ERR!     npm bugs meteor-dev-bundle\n    npm ERR! Or if that isn't available, you can get their info via:\n    npm ERR!     npm owner ls meteor-dev-bundle\n    npm ERR! There is likely additional logging output above.\n. Is using @abernix's image still needed? Otherwise maybe the 1.4-related threads could be closed?\n. Thanks for pointing me in the right direction. I was trying to upgrade from MupX to Mup2, and I hadn't stopped the old MupX app. mupx stop didn't work though, so I just ended up spinning up a new server to start fresh. Seems to work now :)\n. Here's my mup.js: https://gist.github.com/SachaG/d6ca115dfae0eaa7d4836760816561ac\n. mup setup: \n```\nSachas-MacBook-Pro:.deploy sacha$ mup setup\nStarted TaskList: Setup Docker\n[138.68.20.174] - setup docker\n[138.68.20.174] - setup docker: SUCCESS\nStarted TaskList: Setup Meteor\n[138.68.20.174] - Setup Environment\n[138.68.20.174] - Setup Environment: SUCCESS\n```\nmup deploy: \n```\nSachas-MacBook-Pro:.deploy sacha$ mup deploy\nBuilding App Bundle Locally\nChanges to your project's package version selections:\nutilities:react-list-container  upgraded from 0.1.13 to 0.1.14\nStarted TaskList: Pushing Meteor\n[138.68.20.174] - Pushing Meteor App Bundle to The Server\n[138.68.20.174] - Pushing Meteor App Bundle to The Server: SUCCESS\n[138.68.20.174] - Pushing the Startup Script\n[138.68.20.174] - Pushing the Startup Script: SUCCESS\n```\nmup logs:\nSachas-MacBook-Pro:.deploy sacha$ mup logs\n[138.68.20.174]Error: No such container: craternova\ndocker ps:\nroot@craternova2:~# docker ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\nIf you have time, maybe you can try deploying the latest devel branch of Telescope? \nhttps://github.com/TelescopeJS/Telescope/tree/devel\n. Thanks! I'm sure it's something super simple, but since I haven't used mup2 before it's hard to know how it's supposed to behave\u2026\n. Oh, you can usually solve that binary dependency problem with meteor update meteorhacks:kadira-binary-deps (or just remove nova:kadira). \nBut if it works for you, could you give me your mup.js file so I can try again?\n. ok, that gives me hope. I'll try again later and report back then :)\n. Still doesn't work :( Using the exact same mup.js: \n```\nSachas-MacBook-Pro:.deploy sacha$ mup setup\nStarted TaskList: Setup Docker\n[159.203.185.250] - setup docker\n[159.203.185.250] - setup docker: SUCCESS\nStarted TaskList: Setup Meteor\n[159.203.185.250] - Setup Environment\nStarted TaskList: Setup Mongo\n[159.203.185.250] - setup environment\n[159.203.185.250] - setup environment: SUCCESS\n[159.203.185.250] - copying mongodb.conf\n[159.203.185.250] - Setup Environment: SUCCESS\n[159.203.185.250] - copying mongodb.conf: SUCCESS\nStarted TaskList: Start Mongo\n[159.203.185.250] - start mongo\n[159.203.185.250] - start mongo: SUCCESS\nSachas-MacBook-Pro:.deploy sacha$ mup deploy\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor\n[159.203.185.250] - Pushing Meteor App Bundle to The Server\n[159.203.185.250] - Pushing Meteor App Bundle to The Server: SUCCESS\n[159.203.185.250] - Pushing the Startup Script\n[159.203.185.250] - Pushing the Startup Script: SUCCESS\nSachas-MacBook-Pro:.deploy sacha$ mup logs -f\n[159.203.185.250]Error: No such container: tele\n``\n. I also tried with two completely different apps on a fresh Ubuntu 14.04.5 x64 droplet and got the same result. At this point I really don't know what's going on\u2026 Is it possible my own local Mup2 is corrupted or something?\n. Oh interesting, I triednpm list mup` and it gave me this:\nSachas-MacBook-Pro:~ sacha$ npm list mup\n/Users/sacha\n\u2514\u2500\u2500 mup@0.11.3\nIs it possible that I'm somehow using the old version of mup even after running npm install -g mup? I feel like it might've been a good idea to give this package a new name to avoid this kind of problem?\n. I got rid of every duplicate mup folder I could find and upgraded Node to 5.4.0. Still same problem, it stops halfway through meteor deploy. \n. Removing and reinstalling didn't change anything. \n. Well, npm list mup doesn't work anymore for some reason, but which mup does point to the right place as far as I can tell:\n```\nSachas-MacBook-Pro:~ sacha$ npm list mup\n/Users/sacha\n\u2514\u2500\u2500 (empty)\nnpm ERR! code 1\nSachas-MacBook-Pro:~ sacha$ which mup\n/Users/sacha/.nvm/versions/node/v5.4.0/bin/mup\n.\nSachas-MacBook-Pro:.deploy sacha$ DEBUG=* mup deploy\n  mup:module:default exec => mup deploy +0ms\n  mup:module:meteor exec => mup meteor deploy +1ms\n  mup:module:meteor exec => mup meteor push +1ms\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor\n[159.203.185.250] - Pushing Meteor App Bundle to The Server\n  nodemiral:sess:159.203.185.250 copy file - src: /tmp/e8bd2ef7-f788-4cc5-b458-38fbd4dadfcd/bundle.tar.gz, dest: /opt/tele/tmp/bundle.tar.gz, vars: undefined +0ms\n[159.203.185.250] - Pushing Meteor App Bundle to The Server: SUCCESS\n[159.203.185.250] - Pushing the Startup Script\n  nodemiral:sess:159.203.185.250 copy file - src: /Users/sacha/.nvm/versions/node/v5.4.0/lib/node_modules/mup/lib/modules/meteor/assets/templates/start.sh, dest: /opt/tele/config/start.sh, vars: {\"appName\":\"tele\",\"useLocalMongo\":1,\"port\":80,\"logConfig\":{\"opts\":{\"max-size\":\"100m\",\"max-file\":10}},\"image\":\"kadirahq/meteord:base\"} +31s\n[159.203.185.250] - Pushing the Startup Script: SUCCESS\n  mup:module:meteor exec => mup meteor envconfig +2m\n```\n. @MasterJames none of that seems to make a difference. Maybe I should try deploying from another machine\u2026\n. I tried again deploying the Meteor to-do list app from a DO Ubuntu instance to another DO Ubuntu instance using @madushan1000's mup.js file, same thing:\n```\nroot@craternova3:~/simple-todos-react/.deploy# mup deploy\nBuilding App Bundle Locally\nUnable to resolve some modules:\n\"react\" in /root/simple-todos-react/imports/ui/AccountsUIWrapper.jsx\n(web.browser)\n  \"react-dom\" in /root/simple-todos-react/imports/ui/AccountsUIWrapper.jsx\n(web.browser)\n  \"classnames\" in /root/simple-todos-react/imports/ui/Task.jsx (web.browser)\nIf you notice problems related to these missing modules, consider running:\nmeteor npm install --save react react-dom classnames\nStarted TaskList: Pushing Meteor\n[192.241.231.80] - Pushing Meteor App Bundle to The Server\n[192.241.231.80] - Pushing Meteor App Bundle to The Server: SUCCESS\n[192.241.231.80] - Pushing the Startup Script\n[192.241.231.80] - Pushing the Startup Script: SUCCESS\n``\n. Same thing. \n. @MasterJames I think I was only seeing that message because I hadn't runnpm install, I don't think it's related tomup2?\n. @jacquesblom404 yes, I'm experiencing it. How did you modifymupxbtw?\n. Well I'm having this issue with a freshmeteor createapp that doesn't have any settings, so in my case it must be something else\u2026\n. @thomasspiesser oh wow, I just tried with a settings file that only contained{}` and it finally worked!!! Thank you!! Haha, I must've tried this at least 20 times\u2026\nI haven't tried deploying my actual app yet but at least there's progress. I wish mup would tell you more about why it's failing though, if a settings.json file is required then showing an error message wouldn't be that hard and would save some time\u2026\n. I was finally able to deploy Telescope with an empty ({}) settings.json file. Now to try with the real one\u2026\nNote that I also had to remove the Kadira package, because the binary made the deploy process fail. \n. I'm not sure what exactly made it work in the end, but it seems like a settings.json file is required for the deployment to work. Did you try with one?\n. Just realized the same thing\u2026 I don't know if it's a good idea to have debug: true by default in the example\u2026. I'm not 100% sure, but my problem may have been due to all connected users reconnecting at the same time after a restart. I don't think mup includes a way to do stagged restarts, but Galaxy does fyi. . I just ran into the same issue. Does Mup support specifying METEOR_PACKAGE_DIRS in mup.js's env block? How do you specify the environment variables you want meteor build to run with locally vs the environment variables for the deployed app? Or are they the same?. Sorry, I wasn't clear. I can confirm it does take \"global\" environment variables into account, but what about \"local\" env variables that you can specify before meteor run? (i.e. METEOR_PACKAGE_DIRS=\"../foo\" MONGO_URL=\"....\" meteor run --port 3000). Is there a way to specify those?. Also wondering about this. I know this can be done at the DNS level but I'm curious to know how you'd do it with Nginx. . Me too!. Turns out the fix was to add a dependency on that package inside the package that makes use of it. Pretty obvious, but the fact that it worked fine locally threw me off\u2026. What's the URL for wiring funds? How much more is needed?. I tried donating $100 but then it showed up as a monthly subscription so I had to cancel it\u2026 Not sure if the initial payment went through or not. Anyway I'm happy to contribute $100 to the cause, even if I don't use AWS deployment I've gotten so much use out of Meteor Up throughout the years that it's the least I can do :). Thanks, @zodern let me know if it didn't work and I'll try that. . Maybe someone could outline the feature that will be developed and its benefits and then create a post on the Meteor forums? I'd be happy to upvote/comment/retweet :). That's weird, it seems to work for me. . I'm also running into a 502 error with Cloudflare when using https (but http works fine). I would love more details about how exactly you fixed the issue, as I'm even more clueless than you when it comes to server stuff!\nFor example I don't even have an /opt/appname/certs directory?. Actually I did see something different, the app went down and I started getting 521 errors. I'm looking into it, but I still feel like a more detailed guide would be super helpful :). Thanks for the added details! Some of the things I would like the docs to address:\n\nHow do you get letsEncryptEmail?\nIf you use custom certificates, how do you obtain them? Should you run Certbot in manual mode? Should you run it on your production machine or local development machine?\nIf you use custom certificates, how is renewal handled?\n\nI'll open a separate issue for my own specific problems and leave this as a thread about docs.. Another question - should you use the certonly flag when running Certbot?. So I think I can answer some of my own questions:\n\nYou can use any arbitrary email for letsEncryptEmail. This is simply the email Mup will use when it registers the certificate. \nTo use custom certificates, run Certbot in manual mode either on your local or production machine. Nginx mode will not work. \nI don't know about renewal. \n\nThe key in all this was to set up the proxy config before doing mup setup. If the server was already setup, I wasn't able to set SSL properly even by running mup setup again; I had to wipe the instance and start over from scratch. . No I thought mup setup would stop the app already?. A couple other data points, on a fresh server running Ubuntu 17.10 x64. \n\nI now get the Nginx landing page (\"If you see this page, the nginx web server is successfully installed etc.\")\nmup proxy status shows that NGINX and Let's Encrypt are both stopped.\nmup proxy logs-le gives No such container: mup-nginx-proxy-letsencrypt\nmup proxy start gives bash: line 6: cd: /opt/mup-nginx-proxy: No such file or directory . Oh and after trying all that this server now fails to deploy even when commenting out the proxy block:\n\n```bash\n[159.65.139.246] x Start Meteor: FAILED\n      ------------------------------------STDERR------------------------------------\n      Error: No such image: mup-zenshome:latest\nError: No such image: mup-zenshome:latest\nError: No such image: mup-zenshome:previous\nError: No such image: mup-zenshome:previous\nError: No such image: mup-zenshome:latest\nRemoving docker containers. Errors about nonexistent endpoints and containers are normal.\nError response from daemon: endpoint zenshome not found\nError: No such container: zenshome-frontend\nError response from daemon: endpoint zenshome-frontend not found\nError: No such container: zenshome-nginx-letsencrypt\nError response from daemon: endpoint zenshome-nginx-letsencrypt not found\nError: No such container: zenshome-nginx-proxy\nError response from daemon: endpoint zenshome-nginx-proxy not found\nFinished removing docker containers\ndocker: Error response from daemon: driver failed programming external connectivity on endpoint zenshome (06aa65ca390e1b79d1165412ca5764e3b2751c822e08f676e0ca987f4fb64130): Error starting userland proxy: listen tcp 0.0.0.0:80: bind: address already in use.\n\n      ------------------------------------STDOUT------------------------------------\n      Removing images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nabernix/meteord     node-8.9.1-base     34624172c26c        3 months ago        522MB\nusing bundle\nImage abernix/meteord:node-8.9.1-base\nVolume --volume=/opt/zenshome/current:/bundle\nzenshome\nnode-8.9.1-base: Pulling from abernix/meteord\nc20dc0c5afeb: Already exists\na3ed95caeb02: Already exists\na3ed95caeb02: Already exists\n2e0854d03c5a: Already exists\na3ed95caeb02: Already exists\na3ed95caeb02: Already exists\na3ed95caeb02: Already exists\nee0c44e34175: Already exists\nc8f24d298302: Already exists\ndc67008717d0: Already exists\na7d6aa508af1: Already exists\na3ed95caeb02: Already exists\na3ed95caeb02: Already exists\nDigest: sha256:9a12326012a41b5ddd2210d5e5d590bb3506bc341a7f5e1540b451e975bb559c\nStatus: Image is up to date for abernix/meteord:node-8.9.1-base\nPulled abernix/meteord:node-8.9.1-base\n01a5ae273245c0c88158208d404cb5972a925b6a4eb5726b9ecb72e11c28ce98\n\n      ------------------------------------------------------------------------------\n\n``. OK I made some progress. First of all I realized a really dumb mistake on my part, which is that you need to runmup setup*after* you add theproxyconfig (andmup reconfig` alone is not enough). Since I was trying to add SSL to an already-deployed app I didn't think about that. \nThe current situation is that at least the app works, even though I still don't have SSL enabled: https://staging.zenshome.jp/. OK, I'm not sure what I did but it's now working! https://staging.zenshome.jp/ Now I just need to figure out how to force redirect every request to the https URL\u2026. Oh I hadn't seen forceSSL: true. OK, I think I'm good to go! Now to reproduce this on the production instance\u2026 Once I figure everything out I'll contribute what I've learned to the docs. . OK so I don't know if this is the \"proper\" way, but this is what I did that worked (using the custom certificates technique): \n\nCreate a new Digital Ocean instance. \nPoint your DNS to it. \nSSH into it.\nFollow the certbot instructions but use the manual way (not nginx). So sudo certbot certonly.\nzip and scp the resulting certs directory back to your local mup folder.\nExtract the fullchain.pem and privkey.pem files, and then fill in the proxy section of mup.js.\nSet forceSSL: true in your proxy.ssl block.\nAdd https to your root URL. \nRun mup setup. \nRun mup deploy. \n\nI'm not sure if you actually need to run sudo certbot certonly on your server or if you can do it locally, but it seemed like doing it on your server saves a verification step. . And I also managed the letsEncryptEmail method! https://zenshome.jp/\nTurns out it just worked out of the box if you configure proxy before mup setup\u2026. Yes, that's all I needed. At some point I also added some TXT records for verification but I don't think that's necessary if you do things in the right order. . So it seems like I need to turn forceSSL off and then enable SSL on Cloudflare's side. You can't use Cloudflare's caching, CDN, etc. unless you also use their SSL. You can then check \"Always Use HTTPS\" in Cloudflare's dashboard. \nThis seems to work except I'm now getting a 403 error when querying my GraphQL endpoint during the SSR process. Which is unrelated to Mup, but now I'm wondering if maybe I shouldn't just give up on Cloudflare for now\u2026. Yes, what happened is that I wanted to make this work both if you're running a Mup deployment, or locally when working in dev mode. But I forgot to address the case where you're deploying but without setting the env variable\u2026 I've just pushed a Vulcan update that wraps it in a try/catch block to avoid this issue:\nexport const getSourceVersion = () => {\n  try {\n    return (\n      process.env.SOURCE_VERSION ||\n      childProcess\n        .execSync('git rev-parse HEAD')\n        .toString()\n        .trim()\n    );\n  } catch (error) {\n    return null;\n  }\n};. ",
    "nizulzaim": "Sorry, if i have two apps, should i set different port for mongo? because i want to make sure two apps are different from others. For example. first app is\nmongo: {\n        oplog: true,\n        port: 27017,\n        servers: {\n            one: {},\n        },\n    },\nand the second app is:\nmongo: {\n        oplog: true,\n        port: 27018,\n        servers: {\n            one: {},\n        },\n    },\nOr I just set it as same port but it actually work different from other app. Sorry, i dont quite understand this part. I use nginx to proxy my application. First app is in port 3000 and second app is port 3002. Although they are in same server, but i dont want it to share same mongo. From what @THPubs said before, it will overwrite the mongo if i create new container\n\nAnother small question... when deploying two apps, is it going to use the same mongo container? When I deployed the second app I think it removed the existing mongo container and created a new one!\n. Thank you.. You have simple answer but i can understand and it meant alot\n. i tried to enable remote access. Then, new mongo url should look like \n\nMONGO_URL: 'mongodb://1.2.3.4/bongkahDevsign'\nor\nMONGO_URL: 'mongodb://1.2.3.4:27017/bongkahDevsign'\nor\nMONGO_URL: 'http://1.2.3.4:27017/bongkahDevsign'\nor\nMONGO_URL: 'http://1.2.3.4/bongkahDevsign'\n? \n. But when i run DEBUG=* mup deploy, here is the output after Pushing Meteor Application Bundle : \nError write ECONNRESET.\nwhen i run `netstat -a' on server, i think it show that my mongodb have already enable remote access.\ntcp        0      0 devsign1:27017        *:*                     LISTEN\nUpdated:\nThis problem not show when i run DEBUG=* mup setup. So, the problem is actually when trying to connect to mongodb i think.\n. i dont know, But after DEBUG=* reconfig, and deployCheckWaitTime: 120, the problem solved. Thank you. Sorry for asking too many question.\n. `module.exports = {\n    servers: {\n        one: {\n            host: '1.2.3.4',\n            username: 'root',\n            pem: './.mykey',\n        },\n    },\nmeteor: {\n    name: 'bongkahDevsign',\n    path: '../',\n    servers: {\n        one: {},\n    },\n    env: {\n        PORT: 3002,\n        ROOT_URL: 'http://server.com',\n        MONGO_URL: 'mongodb://1.2.3.4:27017/bongkahDevsign'\n    },\n    deployCheckWaitTime: 120,\n},\n};` \nHere is my mup.js. \n. Clayne11, i try with rc4 and still this think dont fix. What version that you use?\n. There is no workaround to connect to server mongo without allowing public access of mongoDB? I dont think allowing public access to mongoDB is good idea. \nI tried to set this in mup.js\n`module.exports = {\n    servers: {\n        one: {\n            host: '...',\n            username: 'root',\n            pem: './.mykey',\n        },\n    },\nmeteor: {\n    name: 'bongkahDevsign',\n    path: '../',\n    servers: {\n        one: {},\n    },\n    env: {\n        PORT: 3002,\n        ROOT_URL: 'http://bongkah.foo.com',\n        MONGO_URL: 'mongodb://localhost:27017/test'\n    },\n    deployCheckWaitTime: 60,\n},\n};`\nand here is the error\n`x Verifying Deployment: FAILED\n```\n    -----------------------------------STDERR-----------------------------------\n    app/server/server.js:1:9)\n        at fileEvaluate (/bundle/bundle/programs/server/packages/modules-runtime.js:158:9)\n        at require (/bundle/bundle/programs/server/packages/modules-runtime.js:92:16)\n        at /bundle/bundle/programs/server/app/app.js:13:1\n        - - - - -\n        at [object Object]. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb/lib/mongodb/connection/server.js:556:74)\n        at [object Object].emit (events.js:106:17)\n        at [object Object]. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb/lib/mongodb/connection/connection_pool.js:156:15)\n        at [object Object].emit (events.js:98:17)\n        at Socket. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb/lib/mongodb/connection/connection.js:534:10)\n        at Socket.emit (events.js:95:17)\n        at net.js:441:14\n        at process._tickCallback (node.js:458:13)\n=> Redeploying previous version of the app\n\n-----------------------------------STDOUT-----------------------------------\n\nTo see more logs type 'mup logs --tail=50'\n\n----------------------------------------------------------------------------\n\n```\nError:\n-----------------------------------STDERR-----------------------------------\napp/server/server.js:1:9)\n    at fileEvaluate (/bundle/bundle/programs/server/packages/modules-runtime.js:158:9)\n    at require (/bundle/bundle/programs/server/packages/modules-runtime.js:92:16)\n    at /bundle/bundle/programs/server/app/app.js:13:1\n    - - - - -\n    at [object Object]. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb/lib/mongodb/connection/server.js:556:74)\n    at [object Object].emit (events.js:106:17)\n    at [object Object]. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb/lib/mongodb/connection/connection_pool.js:156:15)\n    at [object Object].emit (events.js:98:17)\n    at Socket. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb/lib/mongodb/connection/connection.js:534:10)\n    at Socket.emit (events.js:95:17)\n    at net.js:441:14\n    at process._tickCallback (node.js:458:13)\n=> Redeploying previous version of the app\n-----------------------------------STDOUT-----------------------------------\nTo see more logs type 'mup logs --tail=50'\n\nat D:\\Gitlab\\nizulzaim\\meteor-up\\node_modules\\nodemiral\\lib\\coreTasks.js:39:16\nat D:\\Gitlab\\nizulzaim\\meteor-up\\node_modules\\nodemiral\\lib\\session.js:146:9\nat Channel.<anonymous> (D:\\Gitlab\\nizulzaim\\meteor-up\\node_modules\\nodemiral\\lib\\ssh.js:125:9)\nat emitOne (events.js:77:13)\nat Channel.emit (events.js:169:7)\nat SSH2Stream.<anonymous> (D:\\Gitlab\\nizulzaim\\meteor-up\\node_modules\\ssh2\\lib\\Channel.js:124:14)\nat SSH2Stream.g (events.js:260:16)\nat emitNone (events.js:67:13)\nat SSH2Stream.emit (events.js:166:7)\nat parsePacket (D:\\Gitlab\\nizulzaim\\meteor-up\\node_modules\\ssh2-streams\\lib\\ssh.js:3435:10)\nat SSH2Stream._transform (D:\\Gitlab\\nizulzaim\\meteor-up\\node_modules\\ssh2-streams\\lib\\ssh.js:551:13)\nat SSH2Stream.Transform._read (_stream_transform.js:167:10)\nat SSH2Stream._read (D:\\Gitlab\\nizulzaim\\meteor-up\\node_modules\\ssh2-streams\\lib\\ssh.js:212:15)\nat SSH2Stream.Transform._write (_stream_transform.js:155:12)\nat doWrite (_stream_writable.js:292:12)\nat writeOrBuffer (_stream_writable.js:278:5)`\nI also try to MONGO_URL but error still there.\nMONGO_URL: 'mongodb://localhost:27017/\n. Hi, I want to know if currently i can deploy two app on server using setup ssl?. Same problem here. ",
    "cyclops24": "@madushan1000 I have a same issue. I deployed application called A and now want to deploy other application called B that use A database. Which configuration needs for do this in MUP?\nI done this with older MUP later but newest MUP can't do this.\nIs this feature added to new MUP? (I asked because you close this issue). @MasterJame, Thanks for your attention.\nSo you suggest https://github.com/arunoda/meteor-up/tree/mupx and then https://github.com/kadirahq/meteor-up ??\n. Thanks @MasterJame and do you have any idea about kadirahq version release date?\n. Hi @marquesgabriel and @ghost,\nI have a same issue. I deployed application called A and now want to deploy other application called B that use A database. Which configuration needs for do this in MUP?\nI done this with older MUP later but newest MUP can't do this.. Thanks @magp3. I want to remove app and DB that deployed with MUP. With docker rm <containerId> database also will remove?. @magp3 So it's install one mongo container for each app?\nfor example this is my docker ps -a output:\nCONTAINER ID        IMAGE                  COMMAND                  CREATED             STATUS                PORTS                        NAMES\nc4148d5e3bf4        abernix/meteord:base   \"/bin/sh -c 'bash $ME\"   7 days ago          Removal In Progress                                myApp\n3a1880d7d150        mongo                  \"/entrypoint.sh mongo\"   7 days ago          Up 4 days             127.0.0.1:27017->27017/tcp   mongodb\nIs 3a1880d7d150 contain all db or just one db for c4148d5e3bf4 and myApp container?\nIn previous version we remove db with mongo commands like db.dropDatabase(). When I try remove db container it's return below error:\nError response from daemon: You cannot remove a running container 3a1880d7d150374a9aa89276ef5cd17d0b2167c03ef6376f14916ba4ecfa3b28. Stop the container before attempting removal or use -f. Also when I stop project using mup stop it's remove from docker ps -a result. I think we need another approach.. @magp3 mup stop only stop app and remove and remove container from docker ps -a output but I want to remove app and database totaly. @arunoda later said somewhere that we should use db.dropDatabase(). I can't found it now. \ud83d\ude1e . Guys I need your help...\nI have this issue for more a week. \ud83d\ude1e . @zodern unfortunately no and I switch to other deployment approach.. @wiserweb new mup version (this repo based on docker) has a lot of bug or limitation. I suggest you to check PM2-Meteor for more stable deployment tool.. ",
    "Sphinxxxx": "For the record: Deploying multiple apps to the same server, giving each app separate databases on localhost seems to work just fine. The mup.js files need to have the same mongo configuration:\nmy-app-111:\nmodule.exports = {\n  servers: {\n    one: {\n      ...\n    }\n  },\n\n  meteor: {\n    name: 'my-app-111',\n    path: '../',\n    docker: {\n      image: 'abernix/meteord:base',\n    },\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      PORT: 8080,\n      ROOT_URL: 'http://app111.mydomain.com',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n    deployCheckWaitTime: 240\n  },\n\n  mongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n\nmy-app-222:\nmodule.exports = {\n  servers: {\n    one: {\n      ...,\n    }\n  },\n\n  meteor: {\n    name: 'my-app-222',\n    path: '../',\n    docker: {\n      image: 'abernix/meteord:base',\n    },\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      PORT: 8081,\n      ROOT_URL: 'http://app222.mydomain.com',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n    deployCheckWaitTime: 240\n  },\n\n  mongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n\nWhen I access the MongoDB shell on the server (docker exec -it mongodb mongo my-app-111), the databases lie side by side on the same mongo container(?):\n> show dbs\nadmin             0.000GB\nlocal             0.000GB\nmy-app-111        0.000GB\nmy-app-222        0.000GB\n\n. By the way, the FAQ says to increase deployCheckWaitTime in this situation, so I have set it to 240, which I hope is enough?. @949mac  - After trying (and failing) a different way to deploy (this one), mup deploy suddenly started working. The only important thing I did in the meantime that can think of: I installed Meteor and Nginx manually on the server. So maybe mup setup doesn't install Meteor properly?\nTry to install Meteor on your server before you deploy (curl https://install.meteor.com/ | sh). If that doesn't work, try to install Nginx as well, but then you'll have to deploy your app to a different port than 80 (tutorial: https://www.bersling.com/2016/05/17/deploying-multiple-meteor-apps-on-one-digitalocean-server/). Same issue here, mup 1.2.5 can't be updated or uninstalled.. ",
    "carlosbaraza": "Hi, would it be possible to update the README at arunoda/meteor-up indicating that the development is discontinued in that repo?\nI spent the past weekend working on the integration of Let's Encrypt in that repo because I did not know that this repo existed (arunoda/meteor-up#873 and meteorhacks/mup-frontend-server#10).\nThanks for the refactoring and the addition of tests.\n. Hi @madushan1000, thank you for updating the README. At least now new developers could know the actual state and place to contribute.\n. Hi @madushan1000, what do you think about this approach?\n. Yes, I was a bit in a rush when I did the PRs, so the API was not really thought through. Therefore I am kind of glad I confused the project, cause we can implement it well.\nI though about using the Nginx plugin, but I didn't want to introduce a non stable dependency. However, it is worth checking in out (I didn't) to see how stable the Nginx plugin is.\n. @madushan1000, indeed we have to add a location to the nginx config for the challenge. I already did it in the PR meteorhacks/mup-frontend-server#10.\nHere how to use the container: https://github.com/arunoda/meteor-up/pull/873/files#diff-2f09fabea34b444982cf909f840205b1R51\nUnfortunately, I will not have more time to invest on this feature in the following two months, as I am 100% booked for other things.\n. Hopefully that is helpful and can give some light about how to set that up in nginx.\n. ",
    "tomasz-nolberczak": "Hello,\nAny news about that feature? \n. ",
    "dkmooers": "Big +1 on this, would love to have it. Will do manual generation for now, and then again in 60 days, etc. This would be a killer feature! Just wish CloudFlare would enable websockets on Free/Pro plans, then this would be moot... could just CF's free SSL. Ah well! +1!\n. Yep, exactly. Followed these instructions:\nhttps://nickpolet.com/blog/using-letsencrypt-with-meteor-up/P82p2SNZSSfc4mGvT\n(which site ironically has an expired cert!)\n./letsencrypt-auto certonly --standalone\nExcept with fullchain.pem and privkey.pem instead of concatenating them to a single ssl.pem b/c I'm using mupx at the moment.\nRan this on my deployment server after pointing my DNS to it, so letsencrypt could verify ownership of the domain.\n. @vuhrmeister Ah got it, well glad you got it figured out!\n. Would still love to have support for this. I'm on manual renew at the moment and would be super convenient to have this all happen automatically!\n. ",
    "Obiwarn": "+1\n. Galaxy just added auto SSL: \nhttp://info.meteor.com/blog/automated-ssl-reserved-pricing-galaxy-europe\n@madushan1000: Following your post: Did kadira stop development on this?\n. I switched to Galaxy. \nBut isn't that mups job to create this folder on the server?\n. yes\n\n. yes.\nfrom hoard-bla-bla to hoardBlaBla.\nHowever I reinstalled my server Droplet before the change. So the second\nmup setup ran on a new droplet.\n. ",
    "vuhrmeister": "@dkmooers I followed those instructions too. But for me it doesn't work. Just running mupx deploy doesn't have any effect.\nRunning mupx setup fails with x Copying SSL certificate bundle: FAILED\nHow did you get it working?\n*edit: Never mind. First I configured wrong certificates. And mupx didn't manage to override them with the new ones. So I just rebuilt my droplet and started from scratch. That worked!\n. ",
    "thomasf1": "+1\n. ",
    "mbabauer": "+1\n. As an interim solution until the code supports it directly, couldn't we just use the -v option to point the existing docker image to the certs produced by Let's Encrypt?\n. It actually looks like it uses external files for the certs.  I haven't tested it yet, but I think maybe I'll try to simply soft-link them to the Let's Encrypt cert files.  This way I can have the certbot client running in a cron, and it should update the certs with no manual work from me.\n. So, it seems that linking from the installed folder to the lets encrypt folder works just fine.  Here are the steps I took:\n1) Installed Let's Encrypt using standard install (I am on Ubuntu 14.04).\n2) Added a cronjob to auto-renew twice a day, as recommended.  It puts the certs in /etc/letsencrypt/live/<hostname>.\n3) Moved the bundle.crt and private.key to *.orig (so I could go back if things get screwed up)\n4) Created a soft link for bundle.crt -> fullchain.pem and private.key -> privkey.pem to the path in step 2.  You can find your app certs in /opt/<app_name>/config.\n5) Restarted Meteor and tested.\nSo far this seems to work.  The certs are supposed to only last 90 days, so we will see in time if the auto cert renewal works without issues, or if I will have to somehow schedule a restart of the services when the cert is renewed.\n. Does anyone know the status of this?  It would be nice to simply have a property set in the build file to trigger Let's Encrypt support.\n. I am trying to get this to work with the letsencrypt-nginx-proxy, but not having much luck.  My fork can be found here if anyone wants help.  I think the problem is in how the Meteor docker container is being port-mapped to the nginx proxy, but I am not sure.\n. I updated the last I have working.  Most of the docker containers are starting now, all except the nginx one.  That one is throwing the following error in it's docker logs:\n2016/09/16 10:19:35 [emerg] 1#1: no servers are inside upstream in /etc/nginx/conf.d/default.conf:36\nI think the issue now is that the meteor image is exposing port 80, and it's conflicting with the nginx port 80.  I need to see if I can customize the meteor docker image to change the startup port back to 3000.\n. Latest update:\nAfter LOTS of frustration with the Let's Encrypt docker project, I finally got something working.  The latest checkin in my fork branch is running on my test Meteor server, but I would LOVE to get some others to see what I have done and make improvements.  What I have done feels very hack-ish at the moment, and I feel that it may not be \"complete\" in all the required changes.  There is definitely more work to be done, but it does work.\nThe premise on how this all works:\nAll my changes are in the start.sh script that is generated when you do the deploy for your app.  Instead of pulling down the MUP project's nginx Docker image, it checks to see if the SSL is set to auto-gen.  If it is, it pulls down the jwilder/nginx-proxy and jrcs/letsencrypt-nginx-proxy-companion Docker images instead.  The jwilder/nginx-proxy image uses the base nginx image and adds the functionality of jwilder/docker-gen, which uses a template to dynamically configure nginx based on the runtime discovery (are there certs present, what ports are exposed on the other containers, etc).  The jrcs/letsencrypt-nginx-proxy-companion image runs along side of it, checking if the certs need to be updated and updating them and restarting the nginx container if they are.\nOnce we get the code cleaned up I can submit a PR to the main project to get those changes pulled in.\n. @lfilho I would welcome your input on the branch I reference above. It is working locally for me but would love others to give some feedback. \n. @brylie Sure, I can do a PR.  Will update w/ the PR number.\n_Edit: _  PR is #337.\n. I am getting the same issue now.  Did you ever find a fix?\nOne thing I noted that seems strange was that the SSL logs appear under the Mongo setup, not the Meteor setup, whereas the code performs the tasks as part of the Meteor setup in lines 45-62 of src/modules/meteor/index.js (or, at least it appears that way).  Maybe it's just a thread timing issue or something.\n. It just started working, all of a sudden.  But, to help the cause, my target system is Ubuntu 14.04, ssh version is OpenSSH_6.6.1p1, which I believe is the latest.\n. Ok, I made sure everything was using single quotes, and even tried full path, but same issue.  I added a log to dump the stack on error, but that seemed less than helpful:\n```\nStarted TaskList: Setup Docker\n[sc1.32past8.com] - setup docker\n[sc1.32past8.com] - setup docker: SUCCESS\nStarted TaskList: Setup Meteor\n[sc1.32past8.com] - Setup Environment\nStarted TaskList: Setup Mongo\n[sc1.32past8.com] - setup environment\n[sc1.32past8.com] - setup environment: SUCCESS\n[sc1.32past8.com] - copying mongodb.conf\n[sc1.32past8.com] - Setup Environment: SUCCESS\n[sc1.32past8.com] - Copying SSL Certificate Bundle\nTypeError path must be a string\nTypeError: path must be a string\n    at TypeError (native)\n    at Object.fs.open (fs.js:575:11)\n    at fastXfer (/Users/mbauer/Documents/development/oss_projects/meteor-up/node_modules/ssh2-streams/lib/sftp.js:1008:7)\n    at SFTPStream.fastPut (/Users/mbauer/Documents/development/oss_projects/meteor-up/node_modules/ssh2-streams/lib/sftp.js:1111:3)\n    at SFTPWrapper.fastPut (/Users/mbauer/Documents/development/oss_projects/meteor-up/node_modules/ssh2/lib/SFTPWrapper.js:52:23)\n    at onSftp (/Users/mbauer/Documents/development/oss_projects/meteor-up/node_modules/nodemiral/lib/ssh.js:43:12)\n    at SFTPStream.onReady (/Users/mbauer/Documents/development/oss_projects/meteor-up/node_modules/ssh2/lib/client.js:741:9)\n    at SFTPStream.g (events.js:273:16)\n    at emitNone (events.js:80:13)\n    at SFTPStream.emit (events.js:179:7)\n    at SFTPStream._transform (/Users/mbauer/Documents/development/oss_projects/meteor-up/node_modules/ssh2-streams/lib/sftp.js:340:14)\n    at SFTPStream.Transform._read (_stream_transform.js:167:10)\n    at SFTPStream._read (/Users/mbauer/Documents/development/oss_projects/meteor-up/node_modules/ssh2-streams/lib/sftp.js:170:15)\n    at SFTPStream.Transform._write (_stream_transform.js:155:12)\n    at doWrite (_stream_writable.js:301:12)\n    at writeOrBuffer (_stream_writable.js:287:5)\n```\nOne thing I find strange is that the SSL log output is printing after the line \"Started TaskList: Setup Mongo\", but the code seems to add the step as part of the Meteor module setup (lines 45-62 of src/modules/meteor/index.js).  Not sure why, perhaps threading?\n. Ok, I found it.  The config variable is called crt now, not certificate.  However, I am not getting the same issue as #109.\n. @MasterJames, thanks for the link.  npm -v mup returns 3.6.0.\n. You are right, and those are the instructions I did follow.  I do have mupx installed still, but only because I have other projects that haven't been converted yet.\nAs far as versions go, I can say that my local repo was at commit 4156c16.  I pulled latest to 96f34d4 and went through the install steps again, but no luck. I even tried aborting the build when it got to the verify step, but again no luck, as I end up getting a 502 Bad Gateway from nginx.\nI think tomorrow I am going to just lay waste to this test server and rebuild it from scratch.  This way I can rule out something left over from when I was using mupx.\n. Ok, fresh Ubuntu 14.04 server, fresh setup w/ latest Docker, still getting the same issue:\n```\nStarted TaskList: Pushing Meteor\n[xxx.com] - Pushing Meteor App Bundle to The Server\n[xxx.com] - Pushing Meteor App Bundle to The Server: SUCCESS\n[xxx.com] - Pushing the Startup Script\n[xxx.com] - Pushing the Startup Script: SUCCESS\nStarted TaskList: Configuring  Meteor Environment Variables\n[xxx.com] - Sending Environment Variables\n[xxx.com] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[xxx.com] - Start Meteor\n[xxx.com] - Start Meteor: SUCCESS\n[xxx.com] - Verifying Deployment\n[xxx.com] x Verifying Deployment: FAILED\n-----------------------------------STDERR-----------------------------------\n0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (52) Empty reply from server\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\n0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\n    curl: (56) Recv failure: Connection reset by peer\n     Running /etc/my_init.d/00_regen_ssh_host_keys.sh...\n    No SSH host key available. Generating one...\n    Creating SSH2 RSA key; this may take some time ...\n    Creating SSH2 DSA key; this may take some time ...\n    Creating SSH2 ECDSA key; this may take some time ...\n    Creating SSH2 ED25519 key; this may take some time ...\n    invoke-rc.d: policy-rc.d denied execution of restart.\n     Running /etc/rc.local...\n     Booting runit daemon...\n     Runit started as PID 92\n    May 26 13:37:51 xxx-xxx syslog-ng[97]: syslog-ng starting up; version='3.5.3'\n    -----------------------------------STDOUT-----------------------------------\nTo see more logs type 'mup logs --tail=50'\n\n----------------------------------------------------------------------------\n\n```\nWhat is the curl lines mentioned in the STDERR trying to do?  Is that the call to validate the site?\n. Ok, I figured it out.  I was using the wrong base image for my custom Docker image.  I switched over to meteorhacks/meteord:base, and now it seems to be working just fine.  At least the app is up now.\n. @brylie The docker image I am using is here.  According to their documentation, it should auto-renew the certs.  It hasn't been 90 days since my instance was started, though, so I can't tell you with 100% certainty.\n. I am having the same issue.  I did an both sudo ss -lptn 'sport = :27017' and sudo lsof -n -i :27017 and both came back that nothing was using that port.  @maxlibin, did you ever find the cause of the error?\nEDIT: Ok, I got the Mongo step to work.  I had to reboot my server, but I am still having some issues w/ getting the deploy to work, and it looks like all the proxy containers are missing when I do docker ps.  Will have to dig further.. Sorry, that's my host I was using to test with.  I'll update the PR to remove that.\n. ",
    "nicooprat": "Hi, any news on this? :)\n. ",
    "jirikrepl": "+1\nYes, it would be super handy to have this feature. @carlosbaraza you would be my hero;)\n. ",
    "snajjar": "+1, could the fork be integrated in kadira's and arunoda's mup?\n. +1 i also need to add microservices and extra port mapping to my mup deployment. Args array seems fine.\n. @madushan1000 TY for the merge. Could you please release to npm any time soon?\n. Just had this problem.\nChanging the app name from \"myapp.com\" to \"myappcom\" fixed it for me. Seems that app name doesn't tolerate dots.\n. Hi,\nUse docker image abernix/meteord:base for deployment instead of the default one from kadirahq (i don't know why it still isn't fixed). It will install the right node version (4.4.7) in the meteord container.\n. Sorry, duplicate of https://github.com/kadirahq/meteor-up/issues/54. Don't know why i didn't find it.\n. I understand your argument, but in my case (and in many many cases), thoses services are required for my meteor application to work. It's not a nice to have in any kind, it's REQUIRED.\nWithout this, I (and every developer in my case) will code an additionnal deployment program to loop through every server in the mup.js file and deploy all thoses services before i deploy meteor, and then launch meteorup. It won't make any sense to deploy the meteor app without the services, or the services without the app. Thoses are linked.\nSometime, a Meteor application is a little bit more than webserver + mongodb, and I think opening to the docker world with mup by allowing to manage other containers seemed a great idea to me (following the direction taken with the --arg option, it will allow to add easily any kind of service to our Meteor app).\nI've built my own meteord:base image from abernix's: https://hub.docker.com/r/kunkka7/meteor-dood/~/dockerfile/\nFrom this, i'm able to use dood (docker out of docker: control sibling containers from my meteor app). It's a very little change, and it's very powerful. I recommand you check this out next time you need to do something like this.\nAnyway, assuming this won't be in the MeteorUp direction, is there some way to do this properly other than wrapping MeteorUp ? I was hoping that i could use the package.json's \"postinstall\" script or some other kind of npm features to hook my commands...\n. ",
    "stefanve": "This thing is working perfectly and I see talks about a merge, but it does not seem to happen?\nhttps://github.com/dtsepelev/meteor-up-letsencrypt/tree/meteor-1.4\n. I am currently using a manual \"post deploy\" thing to add my packages:\ndocker exec -it myapp bash\napt install pdftk\nI have been searching for ways to do it automatically using configuration options in MUP and ended up here. Is there a way to automate that process?. Not really related to the issue, but partly: Whats the deal with the object:\nservers: {\n      one: {},two: {}, ...etc\n    },\nare they supposed to be empty? Is it just an alternative to writing\nservers: [\n      \"one\", \"two\"\n    ],\n?\n. Thanks Mike. Tricky when an example file contains things that seemingly does nothing and are undocumented. \n. I did. mup logs says 'No such container: app', so it seems... it seems something goes wrong :)\n. Docker got installed properly but after I, in desperation, installed ubuntu-desktop I got the deploy through. So there is something mup expects that not in the core. Now I only have problem with the SSL, using Letsencrypt\n. This branch of mupx handles everything beautifully\nhttps://github.com/dtsepelev/meteor-up-letsencrypt/tree/meteor-1.4\n. You have ssl:'ssl/ssl.pem',\nshould it not be crt: ...\n. I am struggling with ssl too, different problems though, but on the remote machine you need to go in and stop the frontend, and probably the app as well\ndocker stop [appname]-frontend\ndocker stop [appname]\nI hope you find a way, but with letsencrypt it seem hopeless. That worked fine with mupx\n. I can, but only meteor < 1.4\n. ``{\n  \"servers\": [\n    {\n      \"host\": \"localhost\",\n      \"username\": \"aaa\",\n      \"password\": \"xxx\",\n  \"env\": {}\n}\n\n],\n  \"setupMongo\": true,\n  \"appName\": \"killer-app\",\n  \"app\": \"/home/user/source\",\n  \"ssl\": {\n\"certificate\": \"/etc/letsencrypt/live/domain.com/fullchain.pem\",\n\"key\":\"/etc/letsencrypt/live/domain.com/privkey.pem\",\n\"port\": 443\n\n},\n\"env\": {\n    \"PORT\": 80,\n    \"ROOT_URL\": \"https://domain.com\"\n  },\n  \"deployCheckWaitTime\": 60,\n  \"enableUploadProgressBar\": false\n}`\n. I could not make it run, ended up using\nhttps://github.com/dtsepelev/meteor-up-letsencrypt/tree/meteor-1.4\n. I get\nSyntaxError: Unexpected token {\n at exports.runInThisContext (vm.js:53:16)\n``\nI think it has to do with the wrong node version. Node is packed in abernix/meteord:base I guess. Try usingabernix/meteord:node-8.9.1-base`\nThat worked for me. Same here, permission denied. Downgrading to 1.3.5 helped. @fschaeffler and @elie222, there's a million things that can go wrong in a rather complex puzzle like MUP. Just make a it a routine to test directly after updating and rollback and report if it does not work. I am sure @zodern would like to have access to a huge test team and a QA group, but let's face it - we need this software and we get it for no money. Sometimes we need to put in hours though. We share our joy with the product with it's developer/s, the disappointments we carry alone.. Am I really the only one that see a problem with this?. They are slightly different, but one production is:\n`\nmodule.exports = {\n    servers: {\n        one: {\n            // TODO: set host address, username, and authentication method\n            \"host\": \"xxx.xxx.xxx.xxx\",\n            \"username\": \"xxx\"\n        }\n    },\n    hooks:{\n    'post.deploy': {\n        remoteCommand: \"/opt/pdftk-to-docker.sh\"\n    }\n},\nmeteor: {\n    name: 'XX',\n    path: '../../',\n\n    servers: {\n        one: {}\n    },\n\n    buildOptions: {\n        serverOnly: true\n    },\n\n    volumes: {\n        '/opt/gtdocs/store': '/opt/gtdocs/store',\n        '/opt/gtdocs/temp': '/opt/gtdocs/temp'\n    },\n\n    env: {\n        ROOT_URL: 'https://www.xxx.xx',\n        MONGO_URL: 'mongodb://localhost/meteor'\n    },\n\n   ssl: {\n\n       autogenerate: {\n           email: 'xx.xx@xx.com',\n\n           domains: 'xx.xx.com, ' +\n           'xx1.xx.com '\n       }\n\n   },\n\n\n   docker: {\n       // change to 'kadirahq/meteord' if your app is using Meteor 1.3 or older\n       image: 'abernix/meteord:node-8.9.1-base'\n   },\n\n   // Show progress bar while uploading bundle to server\n   // You might need to disable it on CI servers\n   enableUploadProgressBar: true\n\n},\nmongo: {\n       version: '3.4.1',\n       servers: {\n           one: {}\n       }\n   }\n};\n. I will try that, thanks. Worked perfectly, @jehartzog, thanks!. Trymeteor npm remove bcrypt`\nThen deploy again. Tried with another docker image? See:\nhttps://github.com/zodern/meteor-up/issues/808#issuecomment-346740335. And you have sufficient access rights for the second server?. I think you need to give us some more.... Same if yo do docker stop microfis-small? Maybe sudo?. I cannot see that this is a MUP problem? Tried with sudo? Was docker installed by mup or manually?. First of all - can you stop any of the Docker containers? OS? Sudo?. There's no sudo in Windows. There is a similar thing in 'runas'\nhttps://technet.microsoft.com/en-us/lib\nUsually you do not have any SSH by default either, have you tried sunning \nssh localhost\nin a terminal window?. Is there any timeline for this?. Maybe not related, but for me the new reverse proxy thing does not work when more than one domain:\nproxy: {\n    domains: 'a.a.com, b.a.com, c.a.com',\n    ssl: {\n    letsEncryptEmail: 'abc@domain.com',\n  },\n},\nabove works with single domain but fails with comma delimited. Using the old syntax  it still works:\nssl: {\n           autogenerate: {\n               email: 'abc@domain.com',\n               domains: 'a.a.com, b.a.com, c.a.com'\n           }\n       }, . Again, possibly unrelated, but when I have deploy problems I usually start with stopping and removing all the existing containers (except mongo). On one machine I have to also remove the entire /opt/myapp/ dir. \nCan be worth a try if you have not already done that.. ",
    "lfilho": "@madushan1000 @arunoda hey lovely folks, any news about this? :-)\n. @mbabauer how could I test it? I mean, I already have my app in production and I don't have any extra droplets to test it... Thanks. Appreciate your efforts and contribution towards this \ud83d\ude42 \ud83d\udc4d \n. @gsabran that looks like wrong node version. make sure you npm install and bundle your app locally with the same node & npm version running inside docker. Try that.\n. @gsabran Although I'm not sure, I remember seeing that before and fibers package is something for older versions of node IIRC and its api and compilation are not forward compatible with current node versions anymore... Roughly :-D\n. @zeroasterisk , @gsabran , @madushan1000 how can i know which certificate to use? I have the *.pem that letsencrypt generated me and right now i'm using them like so:\njavascript\n        ssl: {\n            port: 443,\n            crt: './fullchain.pem',\n            key: './privkey.pem'\n        }\nI didn't join any files. Should I do anything different? Right now my mup deploy works but when accessing it in the browser it redirectis to https://localhost for some reason\n. I'm using the last version as of this writing and still having this issue.\n. Same here. Not sure what caused it my case as I don't recall changing my config (apart that i didn't had SSL section at first).\nDeleting my app from /opt and redeploying it fixed it. Now I'm get the 502 Bad Gateway error but that is something already reported in another issue... \ud83d\ude0a  The quest for deploying with ssl continues...\n. Had the same problem. My app name had a space on it.\nRemoving the space and then mup setup && mup deploy fixed it.\n. @mattlinares I just tried this and didn't work... After doing everything I tried my live https URL in the browser but it redirected to https://localhost/ which of course is wrong.\nAny clues?\n. I think this could be closed now.\nAlso, files and folders beginning with a dot is Linux and OSX default behaviour since ever (all unix based systems, actually).\nSo I don't think we need to worry with that kind of info in a library's README...\n. Try running npm install or meteor npm install before\n. Yeah, that's why I suggested it to him, the problem seemed similar...\n. Double check that node version where the bundle was generated correspond with the node version being run in the docker image. I also run with into problems because of that but can't recall if the error messages were the same.\n. ",
    "brylie": "@carlosbaraza would you please consider opening a pull request in this repository? I do not see one referenced in the discussion.\n. @mbabauer any status update on opening a PR with your changes? Some of the improvements could be made during the PR review process. That way, we could see the changes and work in progress.\n. @mbabauer are the conflicts here difficult to resolve?\n. @madushan1000, may this please be reviewed and/or merged soon?\n. @mbabauer does this PR auto-renew the LetsEncrypt certificate(s)?\n. @mbabauer, conflicts have been resolved and the hardcoded URL was removed. Any timeline for further review of this PR?\n. @goooseman good catch. @mbabauer would this be hard to fix?. @madushan1000 please review this PR, and advise of any needed changes.. Correct me if I'm wrong, but we might need to document this feature in the README (#432).. What was the problem? I am getting the same error.. @zodern that was the case, sorry for not following up. I had ssl outside of the meteor object. The size of the config example makes it a bit hard to follow the nesting, and perhaps an unordered, nested list would more clearly document the structure.. I think the goal of this feature is so that Certbot will be automatically configured. Note also, LetsEncrypt is deprecated in favor of Certbot.. Same here. How do we install the version of mup that contains the LetsEncrypt changes?. One strange thing occurred. I manually installed certbot on the server after running mup deploy. Within about 5 minutes, my server had an active LetsEncrypt certificate. I tried to manually install the certificates once after installing certbot, so that might have had an effect.. @chrissanders I followed the Certbot Ubuntu 16.04 nginx instructions.. > I've confirmed via netstat that the server appears to be listening on port 443, but doesn't appear to be handling the request.\nI had similar errors regarding 443 being taken. I was a bit tired yesterday, so apologies for not providing more info.. We should probably re-open this issue, since the meteor-up command is not automatically installing letsencrypt or certbot. Most of the other software dependencies are handled automatically by meteor-up, so the SSL configuration would ideally be automated too.\nIt seems there is a bit of complexity here, with letsencrypt being deprecated in favor of certbot, and multiple installation options depending on the platform.. I need to access the Meteor shell to run a method on the server.. In my case, I needed to do:\nmup stop. It seems like the server is having trouble unpacking the software bundle, but I am not sure how to change the bundle type.. I might try reverting to 1.2.x and re deploying, but this is obviously not ideal.. Is there a flag to add a timer to the sub-processes, so we can see how long each step takes? That might also be helpful for debugging purposes.. Should proclaim.32past8.com be hard coded here?\n. ",
    "EmirGluhbegovic": "Hey People, I assume that Lets Encrypt is now usable with Zodern-Meteor up. Is there link anywhere how to set it up?. ",
    "rlech": "can you explain how you have installed imagemagick with docker?\n. is it possible to fix this for the old mupx ?\n. ",
    "mariobaldini": "Thank you @madushan1000, that worked. \nI'm closing the issue. Although I think that mup should use the MONGO_URL even if the mongo instance is installed, otherwise whats's the point of explicit setting that variable. \nThank you,\n. ",
    "mscherer82": "Updating nodejs helped \n. this happens because of the ms scripting host on my system. I don't know how many windows systems are affected, but I got the same issue on other machines. \nThe scripting host launches .js files so when you type mup deploy in the command line, scripting host is launching mup.js.\nAs a solution you can call mup from its absolute path but I think you should just rename mup.js to something else.\n. ",
    "JoeyAndres": "Btw, this can be a draft. Tell me what to change to make this \"acceptable\".\n. @madushan1000 Ok. I'll definitely do that.\n. Tests are now added.\n. @madushan1000 No problem. Do you want me to do @mnmtanish 's suggestion? I have thought of that, create a class that would aggregate nodemiral so that executeScript/execute can take before/after hooks.\n. @madushan1000 After reading nodemiral, I can't find a clean way of doing this. Overriding execute/executeScript means overriding TaskList.registerTask. I'll just push those separated test.\n. @madushan1000 I'll take a stab at that problem, I think my brain is cooking some idea, wrap each transaction in class, something along those lines.\nEdit: I'll just keep the test for this PR, like said above.\n. @madushan1000 This PR is now only tests.\n. ok\n. Before I go on: I have the following prototype of what I want to do:\nMy plan begins with creating a MupTask class:\n``` javascript\nclass MupTask {\n  constructor(taskName, fn) {\n    this.taskName = taskName;  // I assume that names are like \"meteor setup\", thus we can easily conver this to a hook name (spine case): \"meteor-setup\". A cleaner way can easily be made.\n    this.fn = fn;\nthis._beforeExecFns = [];\nthis._afterExecFns = [];\n\nthis.taskList = nodemiral.taskList(this.taskName);\nthis.baseHookName = this.taskName.toLowerCase().split(' ').join('-');\n\n}\nexecute(mupApi) {\n    this._beforeHook(mupApi);\n    this._beforeExecFns.forEach(fn => fn.call(this, mupApi));\n    this.fn.call(this, mupApi);\n    this._afterHook(mupApi);\n    this._afterExecFns.forEach(fn => fn.call(this, mupApi));\n  }\nonBeforeExec(hookFn) { this._beforeExecFns.push(hookFn); }\noffBeforeExec(hookFn) {\n    let index = this._beforeExecFns.indexOf(hookFn);\n    if (index !== -1) { this._beforeExecFns.splice(index, 1); }\n  }\nonAfterExec(hookFn) { this._afterExecFns.push(hookFn); }\noffAfterExec(hookFn) {\n    let index = this._afterExecFns.indexOf(hookFn);\n    if (index !== -1) { this._afterExecFns.splice(index, 1); }\n  }\n// Private.\n  _beforeHook(mupApi) {\n    let hooksConfig = mupApi.getConfig().hooks;\n    let beforeHookName = before-${this.baseHookName};\n    if (hooksConfig) { hook(this.taskList, hooksConfig[beforeHookName], Executing ${beforeHookName}.); }\n  }\n_afterHook(mupApi) {\n    let hooksConfig = mupApi.getConfig().hooks;\n    let afterHookName = after-${this.baseHookName};\n    if (hooksConfig) { hook(this.taskList, hooksConfig[afterHookName], Executing ${afterHookName}.); }\n  }\n}\n```\nThen an instance of whatever class is created via: One can imagine doing an export task in index.js of a module.\n``` javascript\nlet task = new MupTask('meteor setup', function(mupApi) {\n  log('exec => mup meteor setup');\n  const config = mupApi.getConfig();\n  const meteorConfig = config.meteor;\n  if (!meteorConfig) {\n    console.error('error: no configs found for meteor');\n    process.exit(1);\n  }\nthis.taskList.executeScript('Setup Environment', {\n    script: path.resolve(__dirname, 'assets/meteor-setup.sh'),\n    vars: {\n      name: meteorConfig.name\n    }\n  });\nif (meteorConfig.ssl) {\n    this.taskList.copy('Copying SSL Certificate Bundle', {\n      src: meteorConfig.ssl.crt,\n      dest: '/opt/' + meteorConfig.name + '/config/bundle.crt'\n    });\nthis.taskList.copy('Copying SSL Private Key', {\n  src: meteorConfig.ssl.key,\n  dest: '/opt/' + meteorConfig.name + '/config/private.key'\n});\n\nthis.taskList.executeScript('Verifying SSL Configurations', {\n  script: path.resolve(__dirname, 'assets/verify-ssl-config.sh'),\n  vars: {\n    name: meteorConfig.name\n  },\n});\n\n}\nconst sessions = mupApi.getSessions([ 'meteor' ]);\nreturn runTaskList(this.taskList, sessions);\n});\n```\nIn the lib/execute.js, do:\njavascript\n// command = 'task'\nmodule[command](api);\nI think MupTask was general enough. Are you guys fine with this solution. I think this will give us a good consistency, plus, other developers won't have to think about hooks anymore.\n. This got lost in my work. I got swamped in the last few months. I'll work on this, this long weekend.\n. ",
    "shadowcodex": "@zodern @JoeyAndres is this still a direction we want to go with mup? . You are free to reopen this issue if this problem still persists.. You are free to reopen this issue if this problem still persists.. Probably this is due to different server configs and hardware configuration. You are free to reopen this issue if this problem still persists.. You are free to reopen this issue if this problem still persists.. Is this still a vulnerability?. @zodern have you looked into this already?. You are free to reopen this issue if this problem still persists. There have been a lot of improvements made since the end of this thread.. You are free to reopen this issue if this problem still persists.. Let's Encrypt Autogenerate is now available and recommended. Base DO ubuntu server works fine for all of my deployments. You are free to reopen this issue if this problem still persists.. Let's Encrypt autogenerate is now available. You are free to reopen this issue if this problem still persists.. Clean up is on a milestone and tracked via this issue: https://github.com/zodern/meteor-up/issues/482. Check out the readme now, and this PR: https://github.com/zodern/meteor-up/pull/317. If the issue still persist please feel free to reopen this issue.. no this is good too because I forgot tou pdate my pem path when moving to my deploy server.. This shouldn't be happening because of the promise string here.. modules/meteor/index.js:226\njs\nreturn push(api).then(() => envconfig(api)).then(() => start(api));\nIf you can point me in the right direction I can fix this in my current PR.. @zodern on the nodemiral stuff is list.run async or sync?\nI wonder if this is returning resolve before it's completely finished with all the tasks... \n```js\nexport function runTaskList(list, sessions, opts) {\n  return new Promise((resolve, reject) => {\n    list.run(sessions, opts, summaryMap => {\n      for (var host in summaryMap) {\n        if (summaryMap.hasOwnProperty(host)) {\n          const summary = summaryMap[host];\n          if (summary.error) {\n            reject(summary.error);\n            return;\n          }\n        }\n      }\n  resolve();\n});\n\n});\n}\n``. awesome. To remove database just log into mongo as instructed in docs. Drop database in there. Then stop all docker instances and remove them.. @ostrowr Can you look attoporhtop` and find out what is using all the CPU? Is it really meteor?. This needs to be added as a config option in mup.js. I'm wondering this same thing too...\nWondering if I can create a symlink to the \"right location\"... Thus using a cron job to auto renew the certs, and not having to load them in every 3 months.... @FinnFrotscher for future refrence you can use fullchain.pem as the crt file and privkey.pem as the key file.\nExample:\nssl: {\n    port: 443,\n    crt: 'fullchain.pem',\n    key: 'privkey.pem',\n}\nHOWEVER: Going forward for Let's Encrypt you should be using the autogenerate feature.. @spiotr12 has this happened again? . @zodern when is 1.2 projected to be released?. This is a very true statement. I love that let's encrypt was added soon after.. I am using the let's encrypt autogenerate.. I can see where to edit this, if there is just a way to pass this info into the nginx docker container. \nAdd following line to http{..} block in nginx config:\nhttp {\n    #...\n        client_max_body_size 100m;\n    #...\n}. I was thinking for my uses 100m\nI'm not good at docker at all. So getting this to work manually, may take me some time.. looks like it is already set too client_max_body_size 10M;. However I'm trying to upload a 1.6mb file and it is failing, a file smaller than 1mb works.. Maybe this? https://github.com/zodern/meteor-up/pull/450\n. New PR https://github.com/zodern/meteor-up/pull/451. actually after looking at the code some more, I found a better way to do it \ud83d\ude04 \nI'm closing this pull request and going to submit a different one.. Alright I'll make these changes tomorrow.. @Themandunord yes, getting started now.. \n@zodern would it be possible to use the new nginx container with both ssl solutions? or no?. @zodern made those changes, can you test?. can confirm that this pull request is now working on my production environment.. @WayneUong did you try @zodern 's suggestion yet? Is this still an issue?. Perfect great to know!. @zodern do you have an idea of a timeline to make this change? I'm thinking about the Nginx settings file that we were discussing. If we do use this for both SSL options, then the instructions for the Nginx settings file will be the same for both uses.. I think I have this about done.. https://github.com/zodern/meteor-up/pull/496 pull request up.. That can be controlled a lot of different ways, but most likely you will need to forward it through the nginx docker. Depending on which ssl you are using it is different.. Please see the respons @zodern did to my issue here: \nhttps://github.com/zodern/meteor-up/issues/449\nI later created a pull request for adding the option to increase client upload size. May look into doing an array of extra ports to expose.. Would have to dynamically add port exposes to the docker creation on the app container. If running proxy would have to map the reverse proxy for those ports as well.. I'm running on 16 in AWS and it works fine.. I have just recently pushed to DO with the latest 16 image on my droplet. No issues.. What is the log of your nginx docker, not the lets-encrypt docker. \nDid you deploy using a different setup before trying autogenerate?. port 80 & 443 are open on your box right?. @shaiamir can you fix your conflicts in this?\n@zodern it is my understanding that we are going to prioritize this PR and then modify my PR https://github.com/zodern/meteor-up/pull/496 to address the changes. Is that correct?. @zodern Yes you are correct, I was talking about what we discussed in https://github.com/zodern/meteor-up/pull/496. \n@shaiamir as far as conflicts go, we may have to resolve them once we merge the PR in.\n. @MuyBien did you get this converted over?. I'm almost certain this is a docker related issue. I'll try to recreate from my end.. Would running meteor npm install in some way cause an unexpected effect against a meteor project? Like if someone removed manually a package but left it in packages.js?\nWould it be best to outline how to add meteor up to a CI system?\n. @zodern is this something we could use the inject I made to pull in a text field from the mup.js file? So people could write their own nginx config in that text field and just import it that way?. @zodern I'll look at creating a PR request for this. Look for one coming in the next week or two.. @ivanthemeh I already have this system setup on this PR https://github.com/zodern/meteor-up/pull/451\nThanks!. Gonna work on this in a few. In tandem with https://github.com/zodern/meteor-up/issues/458. Pull request up: https://github.com/zodern/meteor-up/pull/496. @zodern want to add this to current milestone?. PR Merged.. @gbhrdt I don't think we should delete the created bundle file especially if someone is deploying to another server soon. I think deleting all others except the most recent one would be appropriate.\nIt has been talked before about reusing a bundle for a redeploy.. It's setup on deploy or start.\nYou can view what docker containers you have running on the server with docker ps.\nTo view the logs on the container you can do docker logs <container>.\nIn your case, you will have two Nginx dockers running. One for the let's encrypt auto generation, and one for the regular Nginx. You can use the logs command to view what is happening on them.. Try docker ps -a\nOn Wed, Feb 22, 2017 at 4:55 PM Josh notifications@github.com wrote:\n\nWeird. My first server only shows the abernix/meteord:base image.. Just\nthat one container. Shouldn't there be at least two containers if you're\ntelling me there are separate containers for the nginx apps?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/483#issuecomment-281832527,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ABSR1fJVyLiEmQUnMVw91FZSgSm9l-67ks5rfLzvgaJpZM4MJSc8\n.\n. I would recommend manually generating and injecting the cert. . @zodern @ivanthemeh @PolGuixe this is fixed in https://github.com/zodern/meteor-up/pull/496. @PolGuixe He will as soon as we finish milestones for it.. if you haven't yet, you need to fix your dns routing to that subdomain.. if you ping that host name, is it responding with YY.YY.YY.YY?\n\nyour mup.js should be something like this. Best practice IMO is to use separate mup.js and settings.js files for each environments.\n```js\nmodule.exports = {\n  servers: {\n    one: {\n      host: 'YY.YY.YY.YY',\n      username: 'root',\n      // pem: '/home/user/.ssh/id_rsa',\n      // password: 'password',\n      // or leave blank to authenticate using ssh-agent\n      opts: {\n          port: 22,\n      },\n    }\n  },\nmeteor: {\n    name: 'app',\n    path: '../app',  \n    },\n    docker: {\n      image: 'kadirahq/meteord', // (optional) \n      imageFrontendServer: 'meteorhacks/mup-frontend-server'\n    },\n    servers: {\n      one: {}, // list of servers to deploy, from the 'servers' list\n    },\n    buildOptions: {\n      serverOnly: true, // skip building mobile apps, but still build the web.cordova architecture\n      debug: true,\n      cleanAfterBuild: true, // default\n      buildLocation: '/my/build/folder', // defaults to /tmp/\n    },\n    env: {\n      // PORT: 8000, // useful when deploying multiple instances (optional)\n      ROOT_URL: 'https://staging.example.com', // set to https to force redirect from http\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n    ssl: {\n      // Enables let's encrypt (optional)\n      autogenerate: {\n        email: 'email.address@domain.com',\n        domains: 'staging.example.com' // comma seperated list of domains\n      }\n    },\n    deployCheckWaitTime: 60, // default 10\n// Shows progress bar while uploading bundle to server (optional)\n// You might need to disable it on CI servers\nenableUploadProgressBar: true // default false.\n\n},\nmongo: { // (optional)\n    oplog: true,\n    port: 27017,\n    version: '3.4.1' // (optional), default is 3.4.1\n    servers: {\n      one: {},\n    },\n  },\n};\n```. Yes I don't have base domain in mine, just the subdomain.. @PolGuixe lemme get this current PR finished up for nginx, and then I'll come back to this issue. I'm really curious as to why it's not able to verify itself. Something isn't routing right in your DNS is my assumption.. Merged: https://github.com/zodern/meteor-up/pull/516. This can be closed as his issue was resolved.. References issues: https://github.com/zodern/meteor-up/issues/458 and https://github.com/zodern/meteor-up/issues/475. After we test and confirm it works this way, I'll update the docs as well before we merge.. Added more changes to start documenting code.. @zodern not honestly sure how to do that. I can just roll back my master to delete that commit correct?\nedit: Got it. Removed docs commit. Please test this PR now based on nginx changes.. @zodern yeah I just removed it for now. Did reset it back to the commit before the docs. It took like 3 seconds to do the docs thing, and I want to have more discussion on it anyways.\nOnce you test this, let me know and I'll make changes to the README.md to reflect this.. rgr. I believe it already does that at line 32 of start.sh or are you talking bout line 106 for the nginx container?. so basically change:\n<% if(sslConfig && typeof sslConfig.autogenerate === \"object\")  { %> \\\non line 32 to\n<% if(typeof sslConfig === \"object\")  { %> \\\ncorrect?. Expose port updated on 672df04. Would this be the same as config.meteor.env.ROOT_URL?. Or should we setup a config at config.meteor.env.VIRTUAL_HOST?. Uploaded SSLs would be for the url located in config.meteor.env.ROOT_URL correct? So we could parse the ROOT_URL and strip the trailing / and beginning http:// or https:// and then use that as the VIRTUAL_HOST and also as the actual names for the .crt and .key. Or am I completely off base with that thought?\nso https://example.com would become:\nVIRTUAL_HOST=example.com\n-v /opt/$APPNAME/config/bundle.crt:/etc/nginx/certs/example.com.crt:ro \\\n-v /opt/$APPNAME/config/private.key:/etc/nginx/certs/example.com.key:ro \\. Well stink. Ok I'll make the requested changes sometime today.. By changing uploaded SSL's back, the nginx config file upload will only work for autogenerated SSL's.. @zodern if you have an out of github communication channel where I can pm you, that would be great. You can send it to me via my email on my github profile. Discord, Email, something.. @zodern I know we talked about you going ahead with part of this for auto-restart of the let's encrypt container. How do we want to proceed with this PR?\nCurrently it would continue to add features to the let's encrypt proxy while leaving the other proxy behind.. @zodern I think option 3 sounds like the best route. We don't want to bandaid stuff now only to have headaches in the future. I'd love to get down to a single proxy setup for all options. As for long term viability I think option 3 is it.. Screen cap of site:\n\n. I'll do that after we finish and merge the current PR.. Do you want me to just push this as a commit instead of a PR?. Alright, good changes.. Pull request active: https://github.com/zodern/meteor-up/pull/517. @JohnAllen are you able to make the requested changes?. You can always look at your logs using mup logs. You can also be SSH'd into your box and look if docker has started, investigate logs on each docker instance. \nThere are a ton ways to check if deployment went well, the key is to figure out what is the best way to check. Currently it's setup to be simple and not super complex checking that works.. We could write it out to an archived log file before forcing the rollback.. I think passenger is out of scope for meteor up atm.. Before you enter them, could you check docker ps and see if all the docker containers are running correctly?\nPossibly dump out your docker <container-name> logs here for us to look at?. Glad to see you got it resolved. Maybe use mup.cmd instead on windows?\nBased off of this: https://github.com/zodern/meteor-up/issues/487\n. I don't know of any tutorial, but using gitlab CI you would need to do the following.\nAssuming your project is pushed to the CI, and you have already done mup setup on the server\n\nInstall Meteor\nInstall Mup\nRun mup deploy command. How long do you have the timeout set to?. And that is part of a package we depend on and don't have control over, right? NodeMiral if I remember correctly.. @thsowers would you like to do a PR for this new command?. done. @zodern do you have an qualms about merging this pr in?. sounds good. I recommend the force-ssl package as well. https://atmospherejs.com/meteor/force-ssl. It just does it for you, I believe. Simple, easy, clean setup.\n\nForce SSL would be something in the future that could be passed in with an Nginx config file. Which we are working on getting setup in https://github.com/zodern/meteor-up/pull/496.\n. What is the purpose of retaining the buggy build? \nIf you are just trying to clear out current, you could just rm -rf current right?. Also updated the stats on the website. Going to work on a separate pull request to make the stats dynamic.. done.. Yeah sorry about that. Google messed something up, but I have fixed it now.. done in fork. done in fork. fixed in fork. fixed in fork. fixed in fork. fixed in fork. fixed in fork. I was trying to make both setups consistent with each other. I'll modify it to be unbreaking.. seems legit. Will do.. done in https://github.com/zodern/meteor-up/pull/496/commits/eeb554fe14b120cc535449ff63ed9cb3c38579c7. done in https://github.com/zodern/meteor-up/pull/496/commits/eeb554fe14b120cc535449ff63ed9cb3c38579c7. Ah ok, forgot about that dude up there. doing it now.. done in c2a4801. hah ok, gettin it. done in a939602\n. It is. /opt/$APPNAME/config/bundle.crt is the current upload path. /etc/nginx/certs/bundle.crt is where the new nginx proxy is expecting them to be. . As seen on line 76 of that file.. Denote that MONGO_URL is under the Meteor.ENV object.. Example is not needed IMO.. Hah, didn't even notice that one :P . Oh, I totally missed that.. ",
    "clayne11": "This was fixed in a later release of Meteor 1.3\n. Looks like this is being reverted actually (https://github.com/meteor/meteor/issues/6533).\n. I have a branch where I fixed the issue by deploying in series rather than in parallel.\nhttps://github.com/clayne11/meteor-up/tree/multi-server-deployment\nThere must be a race condition somewhere. Not sure about the race condition but at least this fixes the issue.\n. I have a branch where I fixed the issue by deploying in series rather than in parallel.\nhttps://github.com/clayne11/meteor-up/tree/multi-server-deployment\nThere must be a race condition somewhere. Not sure about the race condition but at least this fixes the issue.\n. Personally, I have a separate Git repo that I only use for deployment. I include my main Meteor project as a submodule and I commit all of my sensitive deployment variables into the separate Git repo that only the dev ops / deployment teams have access to.\n. You don't have to add anything. I added {series: true} in the deployment pipeline to make deployment occur in series rather than in parallel. Look at the commit if you're interested in the locations.\n. ",
    "kayrules": "this is from this version. yes, I did changed the name. Was it caused by the name change?\n. Thanks @madushan1000. Noted on this.\n. +1. \nSame issue happened to me. Deployed another project with meteor version 1.2.1 to the same server success.\n. if you don't specify the port, it will use 27017 as default. try check if the server is listening to the port.\n$ netstat -na |grep 27017\ntcp        0      0 127.0.0.1:27017         0.0.0.0:*               LISTEN\n. ",
    "iboxgithub": "Hi, \nthanks for the information, nevertheless how would you do to deploy 2 apps on the same server in this case? My first app deployment works perfect but when I try to deploy the second I have the same kind of error\n\nError response from daemon: No such container: cryptarbot-frontend\ndocker: Error response from daemon: driver failed programming external connectivity on endpoint myapp2 (998e60614eb8cd5ccbfe91432971b80bb11dbf1913b48999205e7bb4060a20a9): Bind for 0.0.0.0:80 failed: port is already allocated.\n\nwhen I run\n\nnetstat -tulpn\n\nI have \nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name\ntcp        0      0 10.0.3.1:53             0.0.0.0:*               LISTEN      14232/dnsmasq   \ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1626/sshd       \ntcp6       0      0 :::80                   :::*                    LISTEN      17005/docker-proxy\ntcp6       0      0 :::22                   :::*                    LISTEN      1626/sshd       \nudp        0      0 10.0.3.1:53             0.0.0.0:*                           14232/dnsmasq   \nudp        0      0 0.0.0.0:67              0.0.0.0:*                           14232/dnsmasq\nI am using kadirahq/meteor-up\nThanks for your help. ",
    "chrisco23": "Thanks.  I already have the nginx proxy vhost set up.  Could that be what's\ninterfering with mupx?\nGiven that setup do you think i need to revert to mup?\nOn Thu, Mar 3, 2016, 12:01 PM Madushan Nishantha notifications@github.com\nwrote:\n\nOne clarification, Old mup/mupx is still god for production use (in fact\nit's recommended since this version is not yet fully ready). We are just\nnot doing any new developments/feature adding to it.\nAs for the issue, Mup does not support using Nginx as a proxy (yet). If\nyou want to use it as a proxy, You will have to install and configure Nginx\nmanually (here is a doc on how to do that\nhttps://github.com/arunoda/meteor-up/wiki/Using-Meteor-Up-with-NginX-vhosts).\nWhat mup uses Nginx for is to provide SSL support (Which is a separate use\ncase).\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/69#issuecomment-191938660.\n. sorry I only now saw this.  Yes I don't even remember the details but I'm no longer having the issue, thanks.\n. \n",
    "yubozhao": "Just wondering the status for the PR, any update?\n. Link the issue from old mup:  https://github.com/arunoda/meteor-up/issues/985\n. @MasterJames No one is using graceful-fs.  I think it is used @ixdi has the right explanation about it. \n. Do we have a workaround on this?  Haven't had a chance to look into it more\n. ",
    "jbg77": "Yes that I've done and many other people did, two methods:\n-by cloning repo, then upload your image on docker hub\n-by fork meteord repo, then link you github account to your docker account, and active autobuild\n. It's more an enhancement than an issue, I can run mup with:\nC\\:\"Program Files\\nodejs\\mup\nThank you anyway\n. ",
    "ericvrp": "Whenever something is not working with mup or mupx people mention increasing deployCheckWaitTime. It looks like this should not be neccessary. Why not check frequently until aborted. With showing time and number of attempt displayed and the expected/normal case in the manual we should be ready to go and move on to real issues.\n. ",
    "rwatts3": "Sure can, \nThank you.\nsh\nWebSocket connection to 'ws://www.galenagarlic.com/sockjs/336/6z1zzsed/websocket' failed: Error during WebSocket handshake: Unexpected response code: 400\n. Oh I was actually using one directly in the digital ocean account Is that not needed ?\nSo I have a digital ocean account. And I have nginx running directly within the container.\nI'm sure this is probably wrong could you refresh my memory on how to set things up or what is needed ? \n. awesome thank you\n. I wanted to share how i'm doing 0 downtime deployment right now. \nCurrently i am using a framework called mechanic from the good folks at PunkAve. \nThis is a worker that controls nginx. It handles a plethora of things such as load balancing, etc. \nI typically have two mup.js files and run two instances of the application. I have mechanic serve the two ports for each docker container to the same host. Thus implementing load balancing automagically. \nThe cool thing is while instance A is updating, mechanic automatically shifts traffic to instance B, and while instance B is updating it will shift traffic to instance A. I have a shell script that deploys basically run mup deploy for each mup.js file , then only runs the second deploy after the first deploy script finishes. \nThis is a quick and easy way for me to maintain 0 downtime for my client's and it's relatively cheap. \nhttps://github.com/punkave/mechanic\n. I would suggest, deploying with two works setup, and use an nginx service maybe mechanic from the apostrophe team to server a load balancer between the two container endpoints. Then when you deploy, one container will be brought offline and the load balancer will switch all traffic to the second container. once both are back online it will continue to serve traffic to each container. \nYou can also set  up a blue green approach , by making one container in your mup config file dependent upon the successful completion or termination of another container. \nEither way the best way to do this is with a load balancer. . hmm, i think you can disable websockets in mup.js if i'm not mistaken, can you test that and see what you get. . also when you setup mechanic , did you pass multiple addresses ? \nmechanic add --host=foo.com --backends=4000,4001. ah i see, ok check the docs on mechanic, you can set a custom conf file, in fact they have a template in the repo. now that I recall i too set a custom conf, and they recommend that you do so. \nYou'll want to also configure things such as max upload size, set it to something like 500MB. etc. ..., \nthen you can run a command to tell mechanic that that conf file is your default, then restart nginx. . @tyvdh sorry I didn't see your message until just now, thank you for sharing. . Does mup respect docker depends on setting ?\nOn Fri, Jul 28, 2017 at 5:18 AM Leon Machens notifications@github.com\nwrote:\n\nI think it would be possible to avoid a downtime with multiple servers, if\nthe task lists have a different order.\nRight now it looks like this (5 servers with load balancer):\n[image: image]\nhttps://user-images.githubusercontent.com/10058950/28716626-8e761e96-739e-11e7-981e-934341d2a56a.png\nThe problem is, that all servers are stopped first. The first server came\nback online will get all the traffic and connections through the load\nbalancer. In my app the first server has to handle around 400 sessions on\nmup restart or deploy.\nIt would be better if the servers are stopped and started one after the\nother.\n@zodern https://github.com/zodern Is this possible?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/173#issuecomment-318637332,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AFFsScAJLhido8QuvgcsQjRYuQR9VQPhks5sSdGXgaJpZM4JTZL0\n.\n-- \n\n-V/R\nRyan Watts\n. awesome . ",
    "VasilySizov": "I think we have two ways to implement this: we can either have an abstraction from docker (so, make networking just another section in mup.js, like logs) or just create a settings section called like 'docker run parameters' to allow advanced users to pass parameters as they want without restrictions.\nI would prefer the second way, because it allows a user to do what he/she wants and decouples config from concrete docker client api.\n. ",
    "WieserSoftware": "Any progress on this?\nI need to expose an additional port on the docker run command:\n -p 127.0.0.1:5555:5555 \nIs there any way to do this?\n. For now, I've just modified the start.sh template on my machine, but that only works because I have a single project.\n. ",
    "nzwade": "@VasilySizov @madushan1000 @mnmtanish \nHi guys, just wondering if this functionality will be added? I am having trouble getting my Meteor app to communicate with my RabbitMQ container as I cannot add the --net parameter to the run command.\n. @lfilho https://github.com/kadirahq/meteord/issues/7\n. ",
    "marcusrognes": "I would certainly recommend using a solution like this only if you have prior knowledge of docker and its run command.\nI am not convinced it merits to many checks and failsafes, since it is quite safe to assume that if you need to use that solution, you already know that you need to overwrite / add variables to the docker run command, and then, you probably know how they should be formatted.\nI might be mistaken tho.\n@MasterJames @madushan1000 \n. This lets you map volumes like this:\n``` js\nmodule.exports = {\n  servers: {\n    one: {\n      host: '1.2.3.4',\n      username: 'root'\n      // pem:\n      // password:\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\nmeteor: {\n    name: 'app',\n    path: '../app',\n    // THIS IS NEW\n    volumes: {\n        \"/host/path\": \"/container/path\",\n        \"/second/host/path\": \"/second/container/path\"\n    },\n    servers: {\n      one: {}, two: {}, three: {} //list of servers to deploy, from the 'servers' list\n    },\n    buildOptions: {\n      serverOnly: true,\n      debug: true,\n      mobileSettings: {\n        yourMobileSetting: \"setting value\"\n      }\n    },\n    env: {\n      ROOT_URL: 'app.com',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n    logs: { //optional\n      driver: 'syslog',\n      opts: {\n        url:'udp://syslogserverurl.com:1234'\n      }\n    }\n    dockerImage: 'madushan1000/meteord-test', //optional\n    deployCheckWaitTime: 60 //default 10\n  },\nmongo: { //optional\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n```\n. @madushan1000 There.\n. @madushan1000 I do have an implementation for setting docker run variables here\nAltho i feel my implementation is a bit of a quick fix / hack.\n. I could create a pull request out of that commit.\n@madushan1000 @MasterJames \nShould we continue the discussion on #75 ?\n. This was merged in #133 7 days ago and should work.\n@BenoitBro @msj121 \n. @madushan1000 @mnmtanish I can rework this pull request to make the syntax be like:\nmeteor: {\n  name: 'app',\n  path: '../app',\n  servers: {\n    one: {}, two: {}\n  },\n  env: {\n    ROOT_URL: 'app.com',\n    MONGO_URL: 'mongodb://localhost/meteor'\n  },\n  docker: {\n    image: 'madushan1000/meteord-test',\n    args: [\n      '--log-driver syslog',\n      '--log-opt syslog-address=\"udp://syslogserverurl.com:1234\"',\n    ],\n  },\n},\nI think it would be better to put the dockerImage parameter there to, but that could break backwards compatibility if we removed the original option.\n. @madushan1000 @mnmtanish I have updated to the new syntax now.\n. How about this?\ndocker: Object.assign({\n  image:config.dockerImage || 'meteorhacks/meteord:base',\n  args:[]\n},config.docker)\nor is there a good reason to delete the dockerImage parameter afterwords?\n@mnmtanish \n. ",
    "zeroasterisk": "I also agree that environments should be supported, somehow.\nI've made a deploy-dev and a deploy-prod folders, each with their own mup.js file --- this is a bit kludgy but works.\n. Getting the same problem today:\n```\n=> Starting meteor app on port:80\n/bundle/bundle/programs/server/node_modules/fibers/fibers.js:16\n    throw new Error(''+ modPath+ '.node is missing. Try reinstalling node-fibe\n          ^\nError:/bundle/bundle/programs/server/node_modules/fibers/bin/linux-x64-v8-3.14/fibers.nodeis missing. Try reinstallingnode-fibers`?\n    at Object. (/bundle/bundle/programs/server/node_modules/fibers/fibers.js:16:8)\n    at Module._compile (module.js:456:26)\n    at Object.Module._extensions..js (module.js:474:10)\n    at Module.load (module.js:356:32)\n    at Function.Module._load (module.js:312:12)\n    at Module.require (module.js:364:17)\n    at require (module.js:380:17)\n    at Object. (/bundle/bundle/programs/server/boot.js:1:75)\n    at Module._compile (module.js:456:26)\n    at Object.Module._extensions..js (module.js:474:10)\n```\n. This would be useful!\n. Right... fork, update the script and docker name, then tell us about it so we can put the docker image into our mup config... \nnot it \ud83d\ude04 \n. I was thinking about implementing this w/ pm2... instead of running via node directly... it supports rolling updates and it supports spawning multiple nodes... any interest in collaboration?\n. I also had similar problems, was on my end w/ wrong certs... but I had to manually kill and rm the test container\n. mup deploys working for me w/ SSL (though I'm going to recommend the ability to customize the nginx docker image - see #284 #285)\ntroubleshooting:\n1. Make sure your ROOT_URL has https and is accurate.\n2. Review your crt/pem & key files and permissions - are they copied to the server?\n3. Re-run mup setup after editing ssl config & cert files\n4. Try ssh-ing into the server and you might need to run docker commands to cleanup broken tests (bonus, you can restart the frontend without a re-deploy)\ndocker ps\ndocker kill myapp-dummy-http-server-for-ssl-check \ndocker rm myapp-dummy-http-server-for-ssl-check \ndocker restart myapp-frontend\nhere's my ssl config, FWIW\nssl: {\n      port: 443,\n      crt: 'wildcard.pem',\n      key: 'wildcard.key',\n    },\n. I thought AWS ELB would not support websocket... Are you failing over to Ajax long polling under the hood?\n. yup - same here - fixed w/:\n```\n// on remote server\nrmdir /opt/myappfolder/config/*\n// on local machine\nmup setup\n```\nideally, if cert copy fails, it cleans up after itself automatically.\n. done\n. ok - sorry about that, updated\n. ",
    "gjr-qm": "You can start with: where mup That will show you the path for mup (e.g. C:\\Users\\You\\AppData\\Roaming\\npm\\mup.cmd)\nThen you can do 2 things:\n1. Go to the directory and rename mup.cmd (for example in mupx.cmd). After that start mup in the mup directory of your project with mupx deploy. You have to remember you renamed mup the next time!\n2. Call mup in the right directory: C:\\Users\\You\\AppData\\Roaming\\npm\\mup deploy. You will have to remember the path or check it again from now on. \n. Maybe some docker cleanup will do the trick? It is possible that you have a lot of docker images downloaded that are not in use. You could try to get rid of dangling images with this command:\nsudo docker rmi $(sudo docker images -q -f dangling=true)\nOr even use a cleanup script like https://github.com/chadoe/docker-cleanup-volumes.. Just type mup.cmd deploy instead of mup deploy. When you deploy Mongo with Meteor Up it spins up a seperate MongoDB container that is not accessible from the outside.\nThe way to get around it: I use RoboMongo with an SSH tunnel to connect to Mongo (you can configure that in the connection settings). You can also setup a tunnel manually of course, but i like RoboMongo for the job.. I do have to use docker commands if i deploy with mongodb. That is because mongo is not installed on the server hosting the docker containers. So i have to use the mongo within the container.\nBut the most convenient way for me to access the database from my computer is to use RoboMongo with an SSH tunnel. The SSH tunnel makes the mongodb url available for Robomongo that uses my local mongo installation.\nFeel free to ask for more info if you need it.. Interesting @zodern, i will have a look at that too.\nFor production servers, I prefer to use a separate MongoDB replica set instead of relying on the MongoDB installation that is done with meteor-up. That way you'll have total control over security and access.. @JohnAllen correct me if I'm wrong, but wouldn't it be better to exchange data between apps with an API (or separate DDP connection since they are both Meteor apps)?. Thanx again! Maybe I have a look into it later.. I think this solution will not work because Windows tries to run mup.js (the mup config file). So the warning has to be in the mup.js file. I think that is not the most clean solution.\nMaybe change mup.js to mupconfig.js?\nSo in mup you can check if mup.js exists. If not then check mupconfig.js. Changing the name of the config file will take care of the mup command not being intercepted.. @zodern: If you like the idea I could implement it in a PR.... I think a warning is a no-go. Making the mupconfig.js optional would solve current problems for Windows users. But it's your call @zodern. If you want me to implement it (optional), just let me know.. Another option is updating the documentation for now with a warning for Windows users to use mup.cmd  instead of mup.. Text coloring would be nice to have back too. This used to work in version 1.03 and earlier. Easiest way is to use a SSH tunnel to the server (using the same credentials as you use for deploy) and then connect to 127.0.0.1:27017 (if you have a default config).. Strange, works with my servers... Only differences I see is that I use 127.0.0.1 instead of localhost and ip-address for SSH address instead of domain name.\nSince I was running with an old version of RoboMongo I just tried with the latest version and that one also works...\nWhat version of Meteor Up did you use to deploy?\n. I tried this change on my Windows 10 machine (deploying a Meteor 1.5.1 app with Meteor up 1.3.5 using abernix/meteord:base docker image and a non-root sudo user for deployment) and it's not quite working for me yet...\nFirst failure i got was bash: line 28: Dockerfile: Permission denied. This seems to be caused by the permission on the bundle and can be solved by inserting 'sudo chown ${USER} bundle -R' as line 26 of the file 'plugins/meteor/assets/prepare-bundle.sh'.\nThen the process coninues building the image, but when the resulting image starts, I get the following error:\ntar (child): *.tar.gz: Cannot open: No such file or directory\ntar (child): Error is not recoverable: exiting now\ntar: Child returned status 2\ntar: Error is not recoverable: exiting now\nStill examining, but getting a little tired after 2 days of trying to get something to work that worked flawless before I updated to Meteor 1.6 (using Meteor up 1.2.11). Downgrading to 1.2.11 gave other errors, so right now I'm stuck and can't deploy my application (lost the working version in the process).\n. Deploying it to my own Ubuntu 16.04 server. @nickich : I also tried that, but that gave me more errors. I thought that was logical, because my application is a Meteor 1.5.1 build.\nStrange thing is that it worked perfectly before I updated my computer to Meteor 1.6. Meteor is downloading (and using) version 1.5.1 when I run the project. I thought it would build a 1.5.1 bundle also, which should work with Meteor up 1.3.5 and abernix/meteord:base. Or am I wrong?\nToo bad I cannot do a clean Meteor 1.5.1. install anymore (or is there a way to do that?).... @nickich : are you deploying with root user?. With version 1.3.6 the permission problem is solved. Thanx!\nAfter that I still had the problem that the container kept rebooting. Found out that was caused by environment var 'REBUILD_NPM_MODULES=1' I set during my trial&error process based on the fact that bcrypt seemed to have something to do with it and info in the meteord repo. You should not set this environment variable! Just leaving this here in case someone else stumbles upon that error...\nMy first test container is running not, back to the real work! Thanks again @zodern!. I solved this problem creating a modified version of the meteord image (added node-pre-gyph that was missing) as described here: https://github.com/abernix/meteord/issues/27. ",
    "FrancoisDeBellescize": "This is a path problem on Windows.\nYou have to write : \"/Users/my-user/\" instead of \"~/\" \n. This is a path problem on Windows.\nYou have to write : \"/Users/my-user/\" instead of \"~/\" \n. ",
    "hoda5": "I'm using ssh-key. mup setup runs without errrors.\nI'm using a Ubuntu machine on AWS, SFTP is enabled by default.\n. ``` js\nmodule.exports = {\n    servers: {\n        A: {\n            host: '54.232.209.247',\n            username: 'root',\n            pem: '../tolentino.pem',\n        },\n        B: {\n            host: '54.94.234.103',\n            username: 'root',\n            pem: '../tolentino.pem',\n        },\n    },\nmeteor: {\n    name: 'zscan',\n    path: '/home/hoda51/zscan/meteor',\n    servers: {\n        A: {\n            host: '54.232.209.247',\n            username: 'root',\n            pem: '../tolentino.pem',\n        },\n        B: {\n            host: '54.94.234.103',\n            username: 'root',\n            pem: '../tolentino.pem',\n        },\n    },\n    env: {\n        ROOT_URL: 'http://zscan.hoda5.com',\n        MONGO_URL: 'mongodb://localhost/zscan'\n    },\n},\n\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n        one: {},\n    },\n},\n\n};\n```\n. ",
    "danwild": "I encountered the exact same issue un Ubuntu 14.04, and found this in mup logs:\nPlease login as the user \"ubuntu\" rather than the user \"root\".\nSo - changed username: 'ubuntu' and it deployed successfully.\n. ",
    "benlavalley": "Yep, saw this too from RC2->RC3. Guess we have to wait for the new Docker image :)\n. @gsabran Thanks for the heads up, that helped tonight :)\n. ",
    "gbhrdt": "You can also just use\nvar privateKey = path.join(process.env[(process.platform == 'win32') ? 'USERPROFILE' : 'HOME'], '.ssh', 'id_rsa');\n. ",
    "JWo1F": "the same here\n. @madushan1000, yeap, I can log into both servers. And I did run mup setup.\n. @madushan1000  Yes, it does. I can create two test servers and try to deploy.\nP.S: This feature works for you?\n. @madushan1000 how to progress?\n. ",
    "rdewolff": "Where is the FAQ or the referenced doc now?. Thanks for the fast answer :). ",
    "phongyewtong": "I have the same problem too.\n. i have this problem too for 2 days already. how can we fixed this?\n. ",
    "switheyw": "Not all that helpful to mark question closed when one \"thinks\" the answer lies elsewhere at some other\nsemi-specified location.\nThere are lots of other answers out there.  http://stackoverflow.com/questions/13327088/meteor-bundle-fails-because-fibers-node-is-missing\n. ",
    "rrenna": "After restarting the server, the log has losts the complaints about the timestamps at the top:\n` x Invoking deployment process: FAILED\n-----------------------------------STDERR-----------------------------------\nnpm WARN package.json meteor-dev-bundle@0.0.0 No description\nnpm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No README data\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to localhost port 80: Connection refused\n    Latest deployment failed! Reverted back to the previous version.\n    -----------------------------------STDOUT-----------------------------------\n    -3.14/fibers.node`\n    ansi-regex@0.2.1 node_modules/ansi-regex\n```\nansi-styles@1.1.0 node_modules/ansi-styles\nchalk@0.5.1 node_modules/chalk\nescape-string-regexp@1.0.5 node_modules/escape-string-regexp\nsupports-color@0.2.0 node_modules/supports-color\nstrip-ansi@0.3.0 node_modules/strip-ansi\nhas-ansi@0.1.0 node_modules/has-ansi\neachline@2.3.3 node_modules/eachline\ntype-of@2.0.1 node_modules/type-of\namdefine@1.0.0 node_modules/amdefine\nasap@2.0.3 node_modules/asap\nunderscore@1.5.2 node_modules/underscore\nmeteor-promise@0.5.1 node_modules/meteor-promise\npromise@7.0.4 node_modules/promise\nsource-map-support@0.3.2 node_modules/source-map-support\nsemver@4.1.0 node_modules/semver\nsource-map@0.1.32 node_modules/source-map\nfibers@1.0.8 node_modules/fibers\nWaiting for MongoDB to initialize. (5 minutes)\nconnected\nbpm stop/waiting\nbpm start/running, process 1418\nWaiting for 60 seconds while app is booting up\nChecking is app booted or not?\nbpm stop/waiting\nbpm start/running, process 1606\n\n```\n`\n. I realized I was using an old mup install, installed using the old instructions (through npm?). Trying to setup mup 1.0 now and will see if I get the same error.\n. ",
    "Ethaan": "Did you get this working?. Did you get this working? im having the same issue. ",
    "mattiLeBlanc": "After some digging I found that the PEM can't start with ~/.shh/pemfile but it has to be `/Users/{name}/.ssh/pemfile.\n(on osX).\nI didn't get any error message on this.\nMaybe add some error message if _fs2.default.readFileSync is not retrieving the pem file?\nThis was the file mup-api.js, function _loadSessions.\n. well I can deploy but Node is missing. I assumed it would install Node automatically. I installed version 4 now manually. \nI added a node symlink because I have installed nodejs. Hope it works  @now.\nAlso, MongoDb is in a docker container but the Meteor app is not.\nIs there a reason this is different then mupX where both would run in a docker container? Not sure if it is a bad or good thing, just noticing.\n. okay, it is not working\n```\nx Verifying Deployment: FAILED\n-----------------------------------STDERR-----------------------------------\n2435 s in the future\ntar: bundle/programs/server/npm-require.js: time stamp 2016-04-01 07:52:03 is 4.8821594 s in the future\ntar: bundle/programs/server/program.json: time stamp 2016-04-01 07:52:03 is 4.8423316 s in the future\ntar: bundle/programs/server/server-json.js: time stamp 2016-04-01 07:52:03 is 4.8422255 s in the future\ntar: bundle/programs/server/shell-server.js: time stamp 2016-04-01 07:52:03 is 4.8421069 s in the future\ntar: bundle/programs/server: time stamp 2016-04-01 07:52:03 is 4.8420645 s in the future\ntar: bundle/programs: time stamp 2016-04-01 07:52:03 is 4.8183891 s in the future\ntar: bundle/star.json: time stamp 2016-04-01 07:52:03 is 4.8182357 s in the future\nnpm WARN package.json meteor-dev-bundle@0.0.0 No description\nnpm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No README data\n=> Starting meteor app on port:80\nMeteor requires Node v0.10.41 or later.\n\n=> Redeploying previous version of the app\n\n-----------------------------------STDOUT-----------------------------------\n\nTo see more logs type 'mup logs --tail=50'\n\n```\nNot even sure what the real error is, when I do mup logs --tail=50 I only see \n```\n\nStarting meteor app on port:80\nMeteor requires Node v0.10.41 or later.\n```\n\nShit..I just see that by using the package manager It is installing Node 0.10.25. \nNo idea why I am not getting the newest version. Looking into it.\n. Okay...running out of options here. I just installed node v5.10.0 and still getting the same error message.\nI don't know what to do anymore. Maybe its time for weekend lol\n. yes, I used the example from your README.MD file. The one generated by mup\ninit added require stuff and a sourcemap that looked to be incorrect?\nRunning meteor locally was trying to interpret those requires and generated\nan error. So I reverted back to the example config in the readme.\nShould I use another dockerImage or remove the line and it gets the default?\nI guess to setup again, I have to remove the containers from docker and do\na new setup to see how it goes?\nOn 1 April 2016 at 19:39, Madushan Nishantha notifications@github.com\nwrote:\n\nMeteor runs in a docker container, not outside.\nIt seems like you copied your mup.js file from one of the test\ndirectories, right?\ndockerImage field is only meant to be present only if you want to use a\ncustom docker image.\ndockerImage: 'madushan1000/meteord-test', //optional line pulls an old\nmeteord image I careated just for testing.\nremove that line and app should work fine.\nIn the futuere, use mup init to create a new mup.js file.\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/93#issuecomment-204309654\n. Yes, no it works!\nGreat job :)\n\nOn 1 April 2016 at 21:14, Madushan Nishantha notifications@github.com\nwrote:\n\nyeah, remove the line and try mup setup again. It'll pull the default\ndocker image.\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/93#issuecomment-204339139\n. Maybe update the readme a little bit so that others people have success\nquicker\nOn 1 Apr 2016 9:36 pm, \"Mattijs Spierings\" mattijsspierings@gmail.com\nwrote:\nYes, no it works!\nGreat job :)\nOn 1 April 2016 at 21:14, Madushan Nishantha notifications@github.com\nwrote:\n\nyeah, remove the line and try mup setup again. It'll pull the default\ndocker image.\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/93#issuecomment-204339139\n. @madushan1000  Second deployment triggered an error again :(.\nI don't understand why mup, mupx, can be so unreliable. What could trigger this issue? It is always happing during deployment verification.\nIs there a workaround or way to find what really is messing up the verification?\n\n\n```\n/bundle/bundle/programs/server/node_modules/fibers/fibers.js:16\n    throw new Error(''+ modPath+ '.node is missing. Try reinstalling node-fibe\n          ^\nError:/bundle/bundle/programs/server/node_modules/fibers/bin/linux-x64-v8-3.14/fibers.nodeis missing. Try reinstallingnode-fibers`?\n    at Object. (/bundle/bundle/programs/server/node_modules/fibers/fibers.js:16:8)\n    at Module._compile (module.js:456:26)\n    at Object.Module._extensions..js (module.js:474:10)\n    at Module.load (module.js:356:32)\n    at Function.Module._load (module.js:312:12)\n    at Module.require (module.js:364:17)\n    at require (module.js:380:17)\n    at Object. (/bundle/bundle/programs/server/boot.js:1:75)\n    at Module._compile (module.js:456:26)\n    at Object.Module._extensions..js (module.js:474:10)\n.\n'use strict';\n// source of package: https://github.com/kadirahq/meteor-up\nmodule.exports = {\n  servers: {\n    one: {\n      host: '[ip]',\n      username: '[user]',\n      pem: '/Users/[user]/.ssh/prospa'\n    }\n  },\nmeteor: {\n     name: 'app',\n     path: '/Users/[user]/www/app,\n     servers: {\n       one: {} //list of servers to deploy, from the 'servers' list\n     },\n     env: {\n       ROOT_URL: [the url],\n       MONGO_URL: 'mongodb://localhost/27017'\n     },\n     deployCheckWaitTime: 60 //default 10\n   },\nmongo: { //optional\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n```\nI must say, I did.update NPM too because that was also a error message in the log, and then the deployment went okay. But I am not sure if it is resolved now for every deployment. But I will find out soon cause we are deploying to staging pretty often\n. The weird thing is , when the first deployment of the day fails, a second attempt has been successful on a couple occasions.\n. Sorry, but I am not finding and issue logged that looks like mine issue (when I search for module).\nIt can be related by still using Coffeescript for this project. I am going to port it to typescript asap and it might kill the issue too.\n(having the mup.js with module expression actually triggers and error when running the meteor project purely because it is converted to ES5 which doesn't support Module)\n. will do, thanks\n. Yes that helped. Thanks\nOn Thursday, 12 May 2016, Madushan Nishantha notifications@github.com\nwrote:\n\nOh sorry, I thought this was a fibers issue without reading the full text.\nIt looks like your mup.js file get bundled with your app and meteor tries\nto load it on the server. To prevent this from happening, move your\nprojectroot/mup.js file to projectroot/.deploy/mup.js and adjust the\npaths accordingly.\nThis is an issue we are going to address in the future.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/123#issuecomment-218716386\n. it appeared to be an issue with the settings.json. The error message wasn't really helpful this case but I figured it out.\nMaybe it's an idea if possible to give a more insight in the errors while trying to run Meteor. With a broker settings file it should have generated an error I think. I didn't see that in the log unfortunately .\n. I might have had malformed setting in my settings.json.\nI can't remember. Just check if it is not malformed. \nThe error didn't point me into that direction, I think I stumbled upon it by accident.\n\nDid you add empty object to your settings at least?\n{}\nI can image it doesn't like an empty settings??. \"meteor\": {\n    \"dockerImage\": \"abernix/meteord:base\"\n  },\nfixed it for me with Meteor 1.4.1.\nThanks!\n. ",
    "llqgit": "I got the same problem at first. But I solved then.\nThat README makes people confuse.\nfor example: \nYou have a project called meteor_test\ncd meteor_test\nthen current dir is:\n```\n\nmeteor_test\n```\n\nthen mkdir .deploy\n```\n\nmeteor_test/.deploy\n```\n\nthen cd .deploy and run mup init\n```\n\nmeteor_test/.deploy\n                                  _mup.js\n                                  _settings.json\n```\n\nat last run mup setup like this:\n```\n\nmeteor_test/.deploy > mup setup\n```\n\nYou are under the .deploy dir to run mup setup and mup deploy . This is important...\nThen there will be some things appeared....\n. ",
    "vectorselector": "I beat my head upon the wall for hours, nay, days,  upon end, never imagining that support for a home-directory tilde was something that even COULD change in an npm module.\nWHY ON EARTH IS THIS INFO NOT ON THE FRONT PAGE OF THE GITHUB REPO!!!!??????\nsilent failure is not the right way... when i commented the pem line out, i get an obvious error. this failure was not cool... especially as our entire software framework community seems to be dependent upon this particular script.  (node bundling etc being what it is...)\n. I'm happy too!\nBut i was very confused about 5 minutes ago... \nsome introductory text saying what happened would help show the way, I think. \"this is the stable mainline kadirahq mup torch being carried forward\" etc... as there's no word on the meteor forum and the READMEs don't say what happened...\nTHANK YOU! this tool is super important!. ",
    "hems": "i had this issue in a different project again, variables on my .env file were not being loaded on the server, so i end up having to copy my variables into mup.json\n. was this tested or just closed? was it my mistake ? \ni don't recall having this issue locally and i had it after pushing the project..\n. @git4t3ch / @fishdude i noticed some other project i had actually still deploy, so i'm wondering if that is something to be with an npm package or even if an specific meteor version ( although i didn't update my meteor project ).\nMy temporary solution was to copy the project to the server old school way ( rsync + ssh ) to my server and it worked okay for me, at that point my project wasn't anymore working inside a docker docker so I also had to install mongodb on my server, backup the old mongo data from inside docker and import into the new one.\nhope that helps somehow\n. ",
    "indesignlatam": "Must have being an error on my side. Now im able to re-deploy.\n. For SSH?\nI login using private key, mup is able to do the setup but not deploy\n. Before i was authenticating with ssh-agent. Now i dont get the past error, but i get this.\nStarted TaskList: Setup Docker\n[162.243.29.191] - setup docker\nError Encrypted private key detected, but no passphrase given\nI added a password field with it and no luck, then a passphrase field not lucky either.\nThen used \neval $(ssh-agent)\nssh-add ~/.ssh/id_rsa\nAnd it didnt work again\n. Without pem field the MUP SETUP works fine.\nNow the deploy is done but, is returning this error. After the error is shown on console the website appears when opening the ip address.\n```\nStarted TaskList: Pushing Meteor\n[162.243.29.191] - Pushing Meteor App Bundle to The Server\n[162.243.29.191] - Pushing Meteor App Bundle to The Server: SUCCESS\n[162.243.29.191] - Pushing the Startup Script\n[162.243.29.191] - Pushing the Startup Script: SUCCESS\nStarted TaskList: Configuring  Meteor Environment Variables\n[162.243.29.191] - Sending Environment Variables\n[162.243.29.191] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[162.243.29.191] - Start Meteor\n[162.243.29.191] - Start Meteor: SUCCESS\n[162.243.29.191] - Verifying Deployment\n[162.243.29.191] x Verifying Deployment: FAILED\n-----------------------------------STDERR-----------------------------------\ninished\n  COPY Release/fibers.node\nmake: Leaving directory `/bundle/bundle/programs/server/node_modules/fibers/build'\nInstalled in `/bundle/bundle/programs/server/node_modules/fibers/bin/linux-x64-v8-3.14/fibers.node`\nansi-regex@0.2.1 node_modules/ansi-regex\n\nansi-styles@1.1.0 node_modules/ansi-styles\n\nescape-string-regexp@1.0.5 node_modules/escape-string-regexp\n\nchalk@0.5.1 node_modules/chalk\n\nhas-ansi@0.1.0 node_modules/has-ansi\n\nstrip-ansi@0.3.0 node_modules/strip-ansi\n\nsupports-color@0.2.0 node_modules/supports-color\n\neachline@2.3.3 node_modules/eachline\n\ntype-of@2.0.1 node_modules/type-of\n\namdefine@1.0.0 node_modules/amdefine\n\nasap@2.0.3 node_modules/asap\n\nunderscore@1.5.2 node_modules/underscore\n\nmeteor-promise@0.5.1 node_modules/meteor-promise\n\npromise@7.0.4 node_modules/promise\n\nsource-map-support@0.3.2 node_modules/source-map-support\n\nsemver@4.1.0 node_modules/semver\n\nsource-map@0.1.32 node_modules/source-map\n\nfibers@1.0.8 node_modules/fibers\n=> Starting meteor app on port:80\n-----------------------------------STDOUT-----------------------------------\n\nTo see more logs type 'mup logs --tail=50'\n\n----------------------------------------------------------------------------\n\n```\n. Im going to re deploy with a 180 seconds wait time and come back again with results.\nThe past deploy full log is this.\n[162.243.29.191]npm WARN deprecated This version of npm lacks support for important features,\n[162.243.29.191]npm WARN deprecated such as scoped packages, offered by the primary npm\n[162.243.29.191]npm WARN deprecated registry. Consider upgrading to at least npm@2, if not the\n[162.243.29.191]npm WARN deprecated latest stable version. To upgrade to npm@2, run:\n[162.243.29.191]npm WARN deprecated \n[162.243.29.191]npm WARN deprecated   npm -g install npm@latest-2\n[162.243.29.191]npm WARN deprecated \n[162.243.29.191]npm WARN deprecated To upgrade to the latest stable version, run:\n[162.243.29.191]npm WARN deprecated \n[162.243.29.191]npm WARN deprecated   npm -g install npm@latest\n[162.243.29.191]npm WARN deprecated \n[162.243.29.191]npm WARN deprecated (Depending on how Node.js was installed on your system, you\n[162.243.29.191]npm WARN deprecated may need to prefix the preceding commands with `sudo`, or if\n[162.243.29.191]npm WARN deprecated on Windows, run them from an Administrator prompt.)\n[162.243.29.191]npm WARN deprecated \n[162.243.29.191]npm WARN deprecated If you're running the version of npm bundled with\n[162.243.29.191]npm WARN deprecated Node.js 0.10 LTS, be aware that the next version of 0.10 LTS\n[162.243.29.191]npm WARN deprecated will be bundled with a version of npm@2, which has some small\n[162.243.29.191]npm WARN deprecated backwards-incompatible changes made to `npm run-script` and\n[162.243.29.191]npm WARN deprecated semver behavior.\n[162.243.29.191]npm WARN package.json meteor-dev-bundle@0.0.0 No description\n[162.243.29.191]npm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\n[162.243.29.191]npm WARN package.json meteor-dev-bundle@0.0.0 No README data\n[162.243.29.191]\n[162.243.29.191]> fibers@1.0.8 install /bundle/bundle/programs/server/node_modules/fibers\n[162.243.29.191]> node build.js || nodejs build.js\n[162.243.29.191]\n[162.243.29.191]make: Entering directory `/bundle/bundle/programs/server/node_modules/fibers/build'\n[162.243.29.191]  CXX(target) Release/obj.target/fibers/src/fibers.o\n[162.243.29.191]  CXX(target) Release/obj.target/fibers/src/coroutine.o\n[162.243.29.191]  CC(target) Release/obj.target/fibers/src/libcoro/coro.o\n[162.243.29.191]  SOLINK_MODULE(target) Release/obj.target/fibers.node\n[162.243.29.191]  SOLINK_MODULE(target) Release/obj.target/fibers.node: Finished\n[162.243.29.191]  COPY Release/fibers.node\n[162.243.29.191]make: Leaving directory `/bundle/bundle/programs/server/node_modules/fibers/build'\n[162.243.29.191]Installed in `/bundle/bundle/programs/server/node_modules/fibers/bin/linux-x64-v8-3.14/fibers.node`\n[162.243.29.191]ansi-regex@0.2.1 node_modules/ansi-regex\n[162.243.29.191]\n[162.243.29.191]ansi-styles@1.1.0 node_modules/ansi-styles\n[162.243.29.191]\n[162.243.29.191]escape-string-regexp@1.0.5 node_modules/escape-string-regexp\n[162.243.29.191]\n[162.243.29.191]chalk@0.5.1 node_modules/chalk\n[162.243.29.191]\n[162.243.29.191]has-ansi@0.1.0 node_modules/has-ansi\n[162.243.29.191]\n[162.243.29.191]strip-ansi@0.3.0 node_modules/strip-ansi\n[162.243.29.191]\n[162.243.29.191]supports-color@0.2.0 node_modules/supports-color\n[162.243.29.191]\n[162.243.29.191]eachline@2.3.3 node_modules/eachline\n[162.243.29.191]\n[162.243.29.191]type-of@2.0.1 node_modules/type-of\n[162.243.29.191]\n[162.243.29.191]amdefine@1.0.0 node_modules/amdefine\n[162.243.29.191]\n[162.243.29.191]asap@2.0.3 node_modules/asap\n[162.243.29.191]\n[162.243.29.191]underscore@1.5.2 node_modules/underscore\n[162.243.29.191]\n[162.243.29.191]meteor-promise@0.5.1 node_modules/meteor-promise\n[162.243.29.191]\n[162.243.29.191]promise@7.0.4 node_modules/promise\n[162.243.29.191]\n[162.243.29.191]source-map-support@0.3.2 node_modules/source-map-support\n[162.243.29.191]\n[162.243.29.191]semver@4.1.0 node_modules/semver\n[162.243.29.191]\n[162.243.29.191]source-map@0.1.32 node_modules/source-map\n[162.243.29.191]\n[162.243.29.191]fibers@1.0.8 node_modules/fibers\n[162.243.29.191]=> Starting meteor app on port:80\n[162.243.29.191]Kadira: Successfully connected\n[162.243.29.191]Kadira: completed instrumenting the app\n. Thanks for the help @MasterJames, it was fixed with the 180 wait time.\n. @MasterJames does this version of MUP supports SSL? If it does, is setup as in MUPX?\n. @MasterJames Thanks, i already deployed with SSL using kadirahq/meteor-up, it changes slightly certificate is now cert.\nI did a wiki post here with it, ill enhance it later.\n. @gsabran Try using absolute paths in meteor.path\n. For anyone having this issue, after looking into the code i found that now the key on ssl are the next:\nssl: {\n    crt: '/fullpath/to/fullchain.pem',\n    key: '/fullpath/to/privkey.pem',\n    port: 443\n},\n. Hi @nilsi, \nTry with the fix mentioned in this issue. Is commonly caused because headers are bigger than the max size allowed by the container with nginx.\nhttps://github.com/meteorhacks/mup-frontend-server/issues/7\nIf you are able to solve the issue with this fix, please comment and close it.\n. It looks like you do have a container with nginx installed. Have you tried to deploy again in to a clean VPS? Did you setup again after removing SSL?\nUsually when i have a problem like this i deploy again to a fresh instance.\n. Try flushing your browser cache, that was something that happened to me to\nafter having issues with the server. Somtimes flushing cache fixed the\nissue.\nIl venerd\u00ec 29 aprile 2016, Nicklas Nilsson notifications@github.com ha\nscritto:\n\nYes I tried a new VPS and I had the same problem. After deployed a few\ntimes on that one it looks like this:\nsudo find / -name nginx.conf\n/var/lib/docker/aufs/diff/282bf4543daa9a584b287cba9ba0e03f1a500523d864d6a2dedd9d3ada0f0dc6/tmp/nginx/nginx-1.8.0/conf/nginx.conf\n/var/lib/docker/aufs/diff/282bf4543daa9a584b287cba9ba0e03f1a500523d864d6a2dedd9d3ada0f0dc6/opt/nginx/conf/nginx.conf\n/var/lib/docker/aufs/diff/b75779f37df4cffd4831249f53479e47842ec4e7918cba3494610822eba41450/tmp/lib/nginx.conf\n/var/lib/docker/aufs/diff/86b79c8b435e1e94bc361e6fd90ea9cfa4db8502f66c4c328c0c6d70235d44e6/opt/nginx/conf/nginx.conf\n/var/lib/docker/aufs/mnt/d835971bcc2eb31916b53db8896f54ae4663cbe16f7b9b32a4ea4c0cebe0e547/opt/nginx/conf/nginx.conf\n/var/lib/docker/aufs/mnt/d835971bcc2eb31916b53db8896f54ae4663cbe16f7b9b32a4ea4c0cebe0e547/tmp/nginx/nginx-1.8.0/conf/nginx.conf\nIt might add another nginx instance every time I run mup deploy?\nI now found out that if I open my webpage in a browser that I never opened\nit in before it works with http. But when I try in an old one it still\nredirects to https and fails. Is this cached in the browser somehow?\nIncognito does not change anything.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/115#issuecomment-215768573\n. Did you tried to do the fix i suggested using the ssl? Only users that\nopened the site when the 502 error was thrown will still get the error\nuntil the browser updates its cache.\n\nI suggest you try again with ssl, but first try it on a subdomain so you\ndont affect your users, when you have it working just update your dns\nsettings to point to the ssl server ip.\nIl venerd\u00ec 29 aprile 2016, Nicklas Nilsson notifications@github.com ha\nscritto:\n\nFinally found a way to flush this at least for chrome on desktop. Just\nwonder if my visitors have the same problem now. I use the answer here to\nflush it: http://superuser.com/a/881431\nI might give it a try to add SSL now again then. But I don't see any\nreason for it to not throw the 502 Bad Gateway error again once I do.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/115#issuecomment-215814583\n. Theres no problem. Happy to help.\n\nIl venerd\u00ec 29 aprile 2016, Nicklas Nilsson notifications@github.com ha\nscritto:\n\nThanks for all the help. No haven't tried yet but will do on a different\ndomain now. Be right back.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/115#issuecomment-215824121\n. Not posible for now, i did a pull request to fix it. But it havent being\nmerged. But its a simple fix. Just 5 minutes more of work.\n\nIl venerd\u00ec 29 aprile 2016, Nicklas Nilsson notifications@github.com ha\nscritto:\n\nWOW! it worked!! Finally!!\nDo you have any idea how I change this permanently? It seems like your\npull request is not merged yet and this will be overridden on my next mup\ndeploy I think.\nThanks again.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/115#issuecomment-215834159\n. Hi @slam310,\n\nTry with the fix mentioned in this issue. Is commonly caused because headers are bigger than the max size allowed by the container with nginx.\nmeteorhacks/mup-frontend-server#7\n. I will do it, if theres no problem with that. Maybe next weekend i can have something.\n. ",
    "unmonk": "Regular mupx also fails with: \n\n`Using buildOptions : {}\nevents.js:141\n      throw er; // Unhandled 'error' event\n      ^\nError: spawn meteor ENOENT\n    at exports._errnoException (util.js:870:11)\n    at Process.ChildProcess._handle.onexit (internal/child_process.js:178:32)\n    at onErrorNT (internal/child_process.js:344:16)\n    at nextTickCallbackWith2Args (node.js:442:9)\n    at process._tickCallback (node.js:356:17)\n    at Function.Module.runMain (module.js:443:11)\n    at startup (node.js:139:18)\n    at node.js:968:3\n`\n. I have tried that a few time on a few different VMs with no luck.   I was\nhaving an es2015 error first.   Running npm install babel-preset-es2015\n--save repaired that.      I also tried grabbing a fresh nofat, but no luck\nthere.\n\nI will create a fresh droplet tomorrow and start again.\nDo those node and npm version numbers look alright?  \nOn Apr 6, 2016 9:11 PM, \"Muhammed Thanish\" notifications@github.com wrote:\n\n@unmonk https://github.com/unmonk Looks like meteor-up didn't install\nproperly. Can you try again after running npm install from where you have\ninstalled meteor-up (I assume it's /home/sweaver/meteor-up).\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/98#issuecomment-206689729\n. \n",
    "maruns": "I had same issue and additionally  to installing babel running \nnpm install --save-dev babel-preset-stage-3 taken from https://babeljs.io/docs/plugins/preset-stage-3/ solved nofat issue.\n. ",
    "micahalcorn": "Upgrading npm seems to have solved my nofat make issue.\n. I was able to resolve the issue of architecture incompatibility by upgrading from Meteor 1.3.0 to Meteor 1.3.2 thanks to @MasterJames. I am using the new mup now instead of mupx and it seems to work with meteor add node-bcrypt, thanks.\n. Hey guys, thanks for your efforts on this. Is the idea here that we will be able to write a fully-custom nginx config? That's what I've been running with mupx for several years now and I need to upgrade my app to 1.5. I'm not concerned with whether my ssl is custom or letsencrypt, but I need full control over the location directives, server blocks, upstream ports, etc. If I understand correctly, I can't access the config file with the new mup because it is now inside the docker container.. Thanks @zodern and @shadowcodex. I use Nginx as a reverse proxy to route requests to one of either two different Meteor apps or a Wordpress app. The routing logic considers subdomain, domain, path and file type using various servers and locations. With mupx I was able to do all of this on a single server instance. Now I am using that original instance with a custom Nginx config, and then mup deploying to separate server instances for each Meteor app. It's been awhile since I messed with this, but I think that was my issue.. For what it's worth, I noticed that when I ssh'd into my target machine manually, it was showing *** System restart required ***. Once I rebooted it, everything works fine. \ud83d\ude15. ",
    "ayushchd": "This is still happening. I had to follow @maruns steps to resolve this. Any idea what's causing this issue?\n. Any luck here? I have an absolute path for my pem file but I am facing the same issue as the OP\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '{hostname}',\n      username: 'ubuntu',\n      pem: '{absolute_path_to_pem}',\n    },\n  },\nmeteor: {\n    name: 'project_name',\n    path: '/app',\n    servers: {\n      one: {},\n    },\n    env: {\n      ROOT_URL: url,\n      MONGO_OPLOG_URL: mongo_oplog_url,\n      MONGO_URL: mongo_url\n    },\n  }\n};\n```\n. Here: https://github.com/kadirahq/meteor-up/issues/98#issuecomment-224679540\n. ",
    "g41n": "I've tried to update but no success...\nMore details here #140\n. I've updated to npm3 (nodejs 6.2.1), as @madushan1000 said in #98, and npm install presents 2 warnings but works:\nnpm WARN deprecated graceful-fs@3.0.8: graceful-fs v3.0.0 and before will fail on node releases >= v7.0. Please update to graceful-fs@^4.0.0 as soon as possible. Use\n 'npm ls graceful-fs' to find it in the tree.\nnpm WARN deprecated jade@0.26.3: Jade has been renamed to pug, please install the latest version of pug instead of jade\nThan npm link not works at first but running with sudo solved it.\nEvery mup command has this line as output, hope is not a problem:\n(node:1398) fs: re-evaluating native module sources is not supported. If you are using the graceful-fs module, please update it to a more recent version.\nAnyway mup deploy fails with this output:\n(node:1996) fs: re-evaluating native module sources is not supported. If you are using the graceful-fs module, please update it to a more recent version.\nBuilding App Bundle Locally\n[BABEL] Note: The code generator has deoptimised the styling of \"/client/scripts/lib/pdfmake.min.js\" as it exceeds the max of \"100KB\".\n[BABEL] Note: The code generator has deoptimised the styling of \"/client/scripts/lib/vfs_fonts.js\" as it exceeds the max of \"100KB\".\nError If encoding is specified then the first argument must be a string\nNow I'll try with @maruns steps, as said by @ayushchd, and let you know...\n. Sadly no success, with @maruns steps the behaviour is the the same.\nI've also tried to follow @maruns steps with the LTS version of node (actually 4.4.5) and the result is the one I've pasted in the first comment...\n. Updating Meteor from 1.2.1 to 1.3.2.4 (and many of the libraries) make it works.\nThank you for the support.\nPS: I was stuck on 1.2.1 due to a library and npm compatibility, now it's time to solve that if I want to use this mup version, but that's another story.... ;)\n. I've downgraded to node 5.8 as said in #113\n. I use the mongo container setup by mup.\n. ```\nmodule.exports = {\n  servers: {\n    production: {\n      host: 'xxx.xxx.xxx.xxx',\n      username: 'root',\n      password: 'secret',\n    },\n  },\nmeteor: {\n    name: 'app-backend',\n    path: '../../',\n    servers: {\n      production: {},\n    },\n    env: {\n      ROOT_URL: 'http://app-backend.mydomain.com',\n      PORT: 3017,\n      MONGO_URL: 'mongodb://mongodb:27017/app-database'\n    },\n  },\n};\n``\n. How can I set the database name inmongosection? The sample is not the case...\n. That was my initial try, but not works because I don't have the link to connect to themongodbcontainer.\n. @MasterJames how can I add that option inmup.js? Is there a way to add custom docker options inmup.js?\n. Is launched by another meteor application deployed on the same server.\n. My firstMONGO_URL` works if I patch mup like this:\ndiff --git a/src/modules/meteor/assets/templates/start.sh b/src/modules/meteor/assets/templates/start.sh\nindex 0d3bd11..066431c 100644\n--- a/src/modules/meteor/assets/templates/start.sh\n+++ b/src/modules/meteor/assets/templates/start.sh\n@@ -24,6 +24,7 @@ docker run \\\n   --volume=$BUNDLE_PATH:/bundle \\\n   --hostname=\"$HOSTNAME-$APPNAME\" \\\n   --env-file=$ENV_FILE \\\n+  --link=mongodb:mongodb \\\n   <% if(useLocalMongo)  { %>--link=mongodb:mongodb --env=MONGO_URL=mongodb://mongodb:27017/$APPNAME <% } %>\\\n   <% if(logConfig && logConfig.driver)  { %>--log-driver=<%= logConfig.driver %> <% } %>\\\n   <% for(var option in logConfig.opts) { %>--log-opt <%= option %>=<%= logConfig.opts[option] %> <% } %>\\\nbecause to make the mongo container visible to the app container, I have to set the --link option in the app container start command. Now is not possible to set it in another way, I suppose...\nThe behaviour is the same if I want to have my own mongodb instance in a container on the same docker server of the app container.\n. Ok, I'll wait until devs decide how to add custom docker options.\nIn the meantime I'll try to understand how to test and submit PR in order to contribute a bit, if I can...\nThanks for the support :)\n. ",
    "NitroBAY": "I tried to update npm, npm install --save-dev npm install babel-cli babel-preset-es2015 babel-preset-stage-3 and install nofat from kadira but still I cannot compile locally meteor-up (I need to compile it because even tough let's encrypt PR has been merged it doesn't seems that @zodern has updated npm package). > Yeah the way Galaxy does zero downtime is by completely starting the new container before switching and shutting down the old one. It also manages directing new connections and reconnections to the right places during this process, to avoid a stampeding herd problem where every client needs to reconnect at once.\nSay a guy of the Meteor's team.\nJust leaving this here in case of.... This should be the top priority.. Great !. How do we enable let's encrypt support please ?\nEDIT : as npm package hasn't been updated I tried to compile locally the package but I failed (see https://github.com/zodern/meteor-up/issues/98). @babenzele I'm absolutely not complaining I wanted to notice that the compilation fails. Sorry if you think I was in any way aggressive I really think @zodern makes a great work ;)\n@zodern thanks a lot, really for your reactivity and all your work. same problem. @zodern when there's a problem with mup it logs at the end To see more logs type 'mup logs --tail=50' I think it explain why some try \"mup logs -f --tail=50\". +1. Feel like god is among us again.. Oh okay sorry I taught that update 1.0.4 => 1.1.2 mean that it was updated not that it has to be updated.. Hello,\nThanks for the support.\nDamn it, thanks to docker logs I now know what was wrong. It was too many certs for azure.com, I think I should just deliver a certificate for my main domaine THANKS A LOT. You're really great.. It works many many many thanks again.. I'm trying @Mklueh's solutions whatever the result is it's a pity that this haven't been fixed yet.. Alright. How do I do right now ?. Okay so deploy also reconfig thanks. I have METEOR@1.6.0.1 yet the \"/node_modules/sshpk/bin\\sshpk-conv\" part makes Prepare Bundle: FAILED why ?\nI have even rm -f all containers server side. I use >     dockerImage: 'abernix/meteord:node-8.9.3-binbuild',\nMy bad : just had to delete node_modules and npm i.. Do you @zodern have some sort of clues about what's going on ?. @stefanve thanks but using the old syntax haven't changed my problem.\nclient_max_body_size 10M for ngninx-default in the server. As I try to explained I don't know how to access the data of a forever restarting container so how can I access my_proxy.conf ?\nI've been using uncrypted server for weeks but this is very problematic as all old users are redirect to https version which is not working as I used to force ssl.. I've already shown you. On the server cat /opt/mup-nginx-proxy/config/nginx-default.conf is client_max_body_size 10M.\nWith or without https it is the same output.. This is really only that. There's nothing else than what I've reported.. I've been trying something similar but I didn't removed the opt/myapp folder I'll give a try thanks sir.. Redeploying after deleting some opt's folders have fixed my issue. Much sorry to the time I made you lost, I still don't get how this little file got \"corrupted\". I'm clueless. Thanks a lot @zodern your support was really great and quick. . Oh yeah and thank you @stefanve. Your solution was helpful.. ",
    "haleo9000": "finally had some success with this (after about 3 dozen attempts) by following the above suggestions, JSLinting my mup.js to ensure there were ABSOLUTELY no issues with my JS, renaming any files referenced by mup.js to ensure they did not include any '_', '-', or '.' characters (with the exception of the '.' before the file extension), and finally running this in the following way: mup --config mup.js --settings settings.json setup and mup --config mup.js --settings settings.json deploy.\nOnly then was I able to get this to push anything at all to the server. In theory it should be running, and I actually see the docker container when I hit docker ps on the server. My mongo server is elsewhere, so I didn't have mup deploy a mongo docker instance, so I only have a two docker instances (whose names match my appname - appname and appname-frontend). . I'm also seeing this. This is on an existing server where I was running mupx previously, but am not running into issues with the updated nodejs libraries and have moved to this meteor-up version using the abernix/meteord:base docker image.. @zodern it was a combination of things, I think. One was that my mup was out of date and I had updated it. Then, due to the project I'm working on being a legacy project, the deploy configs were mussed up. Finally, AWS (really the linux distro) does this fun thing where it fills up your application instance with old and unused kernels, filling the allocated drive space with essentially dead code.\nSorry for the confusion.. ",
    "tdesc": "If anyone still face such error, I found that it display \n\nx Pushing Meteor App Bundle to The Server: FAILED No such file\n\nwhen mup setup not done . ",
    "magevadi": "@tdesc  Thanks, that saved a few hours.. ",
    "emanuellimeira": "x Start proxy: FAILED\n          ------------------------------------STDERR------------------------------------\n          Error response from daemon: endpoint mup-nginx-proxy not found\n    Error: No such container: mup-nginx-proxy-letsencrypt\n    Error response from daemon: endpoint mup-nginx-proxy-nginx-proxy not found\n    docker: Error response from daemon: driver failed programming external connectivity on endpoint mup-nginx-proxy (d9857250efffca7d5bc51dfcd179c4d140e36c6d9389851a7b2bfffc718f6112): Error starting userland proxy: listen tcp 0.0.0.0:443: bind: address already in use.\n\n          ------------------------------------STDOUT------------------------------------\n          mup-nginx-proxy\n    Removed mup-nginx-proxy\n    Removed mup-nginx-proxy-letsencrypt\n    latest: Pulling from jrcs/letsencrypt-nginx-proxy-companion\n    Digest: sha256:ad243eef0b5e63514e18a69fadbf40fcfa94dcbd214599af6b858c7f707029c5\n    Status: Image is up to date for jrcs/letsencrypt-nginx-proxy-companion:latest\n    Using default tag: latest\n    latest: Pulling from jwilder/nginx-proxy\n    Digest: sha256:5145492f8a974d777e7ca6ee01032c476033388495f56eea06ab770e1d1e5c62\n    Status: Image is up to date for jwilder/nginx-proxy:latest\n    Pulled jwilder/nginx-proxy and jrcs/letsencrypt-nginx-proxy-companion\n    15e09f4e7582974b9c45882d70a584fd9f359ba3934a6ff3bbd3d4cf5ada0aeb\n\n          ------------------------------------------------------------------------------.\n",
    "saitodisse": "to update npm: npm i npm -g\nI was getting this error too: Error If encoding is specified then the first argument must be a string\nI've installed node 5 instead node 6 and now its working.\n. ",
    "sungwoncho": "@mnmtanish Using npm 3.8.7, the issue was resolved. This can be closed.\n. ",
    "julienrott": "Having same kind of issue. Did you find a workaround ?\n. ",
    "ipa1981": "Copy missing file manually. \n. @MasterJames Me, yes. 1.3.2.4\n. @MasterJames thanks for suggestion. Unfortunately I'm very busy now, so have not time to play with plugins to check. Maybe someone else can try and give share results.\nMy insight here is that fibers.node files path somehow remind me kernel versions. And could it be that mupx or docker (I'm not specialist here) simply picks wrong version. As my server runs on 3.13 kernel (or 3.14 branch if I understand correctly) while file for 4.6 (??) version of fibers is installed.\nCould the clue be here?\n. ",
    "twastvedt": "I finally figured out the ssl settings, and everything appears to be working, but the error still shows. Here's my mup.js:\nmodule.exports = {\n  servers: {\n    one: {\n      host: '[IP]',\n      username: '[username]',\n      pem: './id_rsa',\n    },\n  },\n  meteor: {\n    name: '[app]',\n    path: '../',\n    servers: {\n      one: {},\n    },\n    env: {\n      PORT: 3000,\n      ROOT_URL: 'https://[app-url]',\n      MONGO_URL: 'mongodb://[mongo-url]'\n    },\n    ssl: {\n      crt: './fullchain.pem',\n      key: './privkey.pem',\n      port: 443\n    },\n    deployCheckWaitTime: 60,\n    enableUploadProgressBar: true\n  }\n};\n. @Deadlyweed Thanks! Unfortunately my head is no longer in this space, and I haven't been working on this for a while now. What's best practice? Should I close this issue if I'm no longer able to champion it?\n. ",
    "vadimmelnicuk": "Experiencing exact problem. Any solution found yet? \n. ",
    "vieko": "Same here...\n. ",
    "techsavyravi": "Any solutions? I guess meteor is not the right choice now for us. Their official website tells us to come here as an option to deploy and this never works.\n. Yes, other tools are either outdated or are made to outdate in favour of Galaxy. Anyways, I tried various Linux distros on digitalocean servers and also tried gigantic Deploy Wait Times. All in vain.\n. ",
    "Deadlyweed": "@twastvedt try this mup file. it works every time for me. Using windows to digital ocean. It's for one app tho. Haven't had time to work on the other ones or for more then one app on server. It took me 2 & half months to get it to work. So don't feel bad. \nhttps://github.com/Deadlyweed/Meteor-Up-Noobs/blob/master/windowssinglemup.js\n. @babenzele @madushan1000 I'm uploading a new readme to my account. Please let me if you like it or not but i have some more test to run.\n. cd yourapp\nmeteor\nxxx.xx.xxx.xx:3000. Now if it show up that way. You miss up some where like i did but i gave up on using nginx. I had my nginx set up first tho. Hope that help you out a little.\n. @gitMonks I never got it to work right. \nThis might help you both out. The tutorials i used for nginx\nthey use the todos app in the tutorial from meteor web site\nhttps://www.digitalocean.com/community/tutorials/how-to-deploy-a-meteor-js-application-on-ubuntu-14-04-with-nginx\ndon't do this part on it tho. It screw me up big time the sec time trying it on new a droplet \nadd-apt-repository ppa:chris-lea/node.js\n. @maxko87 Can you post your mup.js for me please.\n. @geeksville Do you work on it local or a development server? Will you be running more then one app from the server?\n. @geeksville Thank you, I added that to my readme file. Trying to make one that is way easier to understand for everyone\n. Change  host: '1.2.3.4', on your mup.js to your server IP address and that should fix that problem\nWhat os are you building it on? \n. meteor create appname\ncd appname\nmeteor\nin browser put localhost:3000\nyou can see your app there\n. im using windows to linux and making a new readme file to be easy to under stand it\nhttps://github.com/Deadlyweed/meteor-up/blob/master/README_NEW.md\n. @rollin-s    host: 'xxx.xxx.xx.xx', // Your IP for test or production server. I just updated my file to show that. \n. @rollin-s  yes i will help and sorry if i confuse. you. Give me a couple and i will post a mup.js for you to copy and i will mark the spot where your info go. You work on it your own pc and want deploy it to a site like digital ocean for a single app sever. you have windows right. Do you use the command line on digital ocean or putty\n. Do you have a domain name or just using ur ip? you can use a sub domain name too\n. @rollin-s \n// thought two mark comment out this line, so it doesnt get read by meteor. \n// If you remove the // it will uncomment the line, so the line will be read by meteor and not green in\n // the mup.js file\nmodule.exports = {\n  servers: {\n    one: {\n```\n  // the ip that digital oceans give you for your droplet\n  host: '204.34.234.19', // <---goes there (Your IP for Linux test or production server)\nusername: 'root',\n  // pem: '/home/user/.ssh/id_rsa', // mup doesn't support '~' alias for home directory\n// your password for your droplet after you change it\n  password: 'demo', // <---goes there\n// or leave blank for authenticate from ssh-agent\n  // opts: { // (optional)\n  // port: 22,\n  // },\n}\n```\n},\n  meteor: {\n```\n// the name of you app goes here\nname: 'appname',  // <---goes there\npath: './', // mup for a single app (best for windows to linux)\n  // path: './home/multipleapp/', // mup for multiple app\n  // useful when deploying multiple instances (optional) //\n  // port: 000,\n  // lets you add docker volumes (optional) //\n  // volumes: { \n              // passed as '-v /host/path:/container/path' to the docker run command\n  // \"/host/path\": \"/container/path\", \n  // \"/second/host/path\": \"/second/container/path\"\n  // },\ndocker: {\n  image:'kadirahq/meteord:base', // (optional) //\n  // image: 'abernix/meteord:base', // use this image if using Meteor 1.4+ //\n// lets you add/overwrite any parameter on the docker run command (optional) //\n  // args:[\n  // \"--link=myCustomMongoDB:myCustomMongoDB\", // linking example\n  // \"--memory-reservation 200M\" // memory reservation example\n  // ]\n},\nservers: {\n  one: {}, two: {}, three: {} // list of servers to deploy, from the 'servers' list\n},\nbuildOptions: {\n  // (--server-only--) Skip building mobile apps even if mobile platforms \n  // have been added. (optional)  //\n  serverOnly: true,\n// (--architecture--) Builds the server for a different architecture than your developer\n  // machine's architecture. //\n// You want to build it for liunx because your using windows and want to deploy on linux\n  // architecture: 'os.linux.x86_64',// Builds for a single app (best for windows and mac deploy to linux)\n// (--debug--) Build in debug mode (don't minify, etc). (optional) // \n  // debug: true,\n// (--server--) Location where mobile builds connect to the Meteor server. Defaults to localhost:3000. //\n// if you have a domain name \n  server: 'http://example.com:80',// // <---goes there\n// if you don't have a domain name use your droplet ip\n  // server: 'http://204.34.234.19:80',\n// I have a web site that host my game on, so i can make a sub domain in my cpanel \n  // or you can sign up for noip and point it to you droplet ip\n  // server: 'http://sub.example.com:80',\n// default (optional) //\n  // cleanAfterBuild: true,\n// (--directory--) Output a directory (rather than a tarball) for the application server\n      // bundle. If the output location exists, it will be recursively deleted first. \n  // Defaults to /tmp/ (optional) //\n  // buildLocation: '/my/build/folder',\n// (--mobile-settings--) Set optional data for the initial value of Meteor.settings in your mobile application. A new value for Meteor.settings can be set later by the server as part of hot code push. (optional) //\n  // mobileSettings: { \n  // yourMobileSetting: \"setting value\"\n  // }\n// (--allow-incompatible-update--) Allow packages in your project to be upgraded or downgraded to versions that are potentially incompatible with the current versions, if required to satisfy all package version constraints. (optional) //\n},\nenv: {\n  //(Example 1, http://sub.example.com Example 2, http://xxx.xxx.xx.xx). \n  // You can even use NoIP for this as long you point the domain to your IP on your server. //\n// if you don't have a domain name or sub domain name use your droplet ip\n  ROOT_URL: 'http://example.com',// <---goes there\n  MONGO_URL: 'mongodb://localhost/meteor'\n},\n  // log: { // (optional)\n  // driver: 'syslog',\n  // opts: {\n  // \"syslog-address\":'udp://syslogserverurl.com:1234'\n  // }\n  // },\n  // ssl: {\n  // port: 443,\n  // crt: 'bundle.crt',\n  // key: 'private.key',\n  // },\ndeployCheckWaitTime: 60 // default 10\n```\n},\n  mongo: { // (optional)\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n. @rollin-s let me know if you dont understand anything. I started to use meteor, so i can move my game all over to JavaScript from php. Meteor Up is just to deploy your app and it doesn't work on local PC(home) but you can use meteor up to deploy it to a server. Unless your use Linux server or you have Ubuntu Server OS installed on a local PC(home). Then you could install the gnome(desktop ver) on it. So you will have the server/desktop. The best of both world. \n. @rollin-s get bitvise ssh client, it has ssh and sftp. its way better then putty or using digital ocean comment line. sftp is just like filezilla. i will walk you throw the set up on that too. thats what i use\n. @rollin-s \nhttp://prntscr.com/czluhp\nhttp://prntscr.com/czluyk\nopen sftp\nhttp://prntscr.com/czlvqp\nfind the folder opt and open it, that's the folder where your app is deploy too\nhttp://prntscr.com/czlwnj\nhttp://prntscr.com/czm34s\nyou might be able to change that in those to files. \nI'm doing a test really fast to make sure this work right tho. \nif that doesnt work, delete everything in opt and then\nmeteor mup setup\nmeteor mup deploy\nyour folder will show back up. If you use digital ocean, you can delete your droplet and create a new one.\n. @rollin-s Your weclome\n. @jsantana90 See if this will help you out. If you are still have problem? hit me back up\nhttps://github.com/kadirahq/meteor-up/issues/341#issuecomment-256642303\nand this might help out\nhttps://github.com/Deadlyweed/meteor-up/blob/master/README_NEW.md\nthat is for windows to Linux,\n. @productiveme I got that a couple times too, I don't why it started do that but do this\n mup deploy --unsafe-perm\nI even got it on creating a new app. So i don't think it has anything to do with mup\n. @paulo2nd mup.js should look like this. This is set up for one app deploy and from windows to Linux tho.  Let me know if you have any problem.\n// To comment lines out put // and to uncomment something just remove //. The lines will be green, when they are comment out and they will not be read. You uncomment them and they will be read.\nmodule.exports = {\n  servers: {\n    one: {\n      host: 'The IP for your Digital Oceans, AWS, or EC2', // Your IP for Linux test or production server IP\n      username: 'root',\n      // pem: '/home/user/.ssh/id_rsa', // mup doesn't support '~' alias for home directory\n      password: 'your password for your droplet after you change it', \n      // or leave blank for authenticate from ssh-agent\n      // opts: { // (optional)\n      // port: 22,\n      // },\n    }\n  },\n  meteor: {\n      // \n    name: 'the name of you app goes here',\n    path: './', \n      // lets you add docker volumes (optional) //\n      // volumes: {\n      // passed as '-v /host/path:/container/path' to the docker run command //\n      // \"/host/path\": \"/container/path\",\n      // \"/second/host/path\": \"/second/container/path\"\n      // },\n    docker: {\n      image:'kadirahq/meteord:base', \n      // image: 'abernix/meteord:base', // use this image if using Meteor 1.4+ (optional)\n      // lets you add/overwrite any parameter on the docker run command (optional) //\n      // args:[\n      // \"--link=myCustomMongoDB:myCustomMongoDB\", // linking example\n      // \"--memory-reservation 200M\" // memory reservation example\n      // ]\n    },\n    servers: {\n      one: {}, two: {}, three: {} // list of servers to deploy, from the 'servers' list\n    },\n    buildOptions: {\n      // (--server-only--) Skip building mobile apps even if mobile platforms have been added. (optional)  //\n      serverOnly: true,\n      // (--architecture--) Builds the server for a different architecture // \n      // than your developer machine's architecture. //\n      architecture: 'os.linux.x86_64',\n      // (--debug--) Build in debug mode (don't minify, etc). (optional) // \n      // debug: true,\n      // (--server--) Location where mobile builds connect to the Meteor server. //\n      server: 'http://example.com:80', // Use this if you using a domain name\n      // server: 'http://xxx.xx.xxx.xx:80', // Use this if you dont have a domain name or sub domain name\n      // server: 'http://sub.example.com:80', // Use this if you using a sub domain name\n      // default (optional) //\n      // cleanAfterBuild: true,\n      // (--directory--) Output a directory (rather than a tarball) for the //\n      // application server bundle. If the output location exists, it will be //\n      // recursively deleted first. Defaults to /tmp/ (optional) //\n      // buildLocation: '/my/build/folder',\n      // (--mobile-settings--) Set optional data for the initial value of //\n      // Meteor.settings in your mobile application. A new value for //\n      // Meteor.settings can be set later by the server as part of hot code push. (optional) //\n      // mobileSettings: { \n      // yourMobileSetting: \"setting value\"\n      // }\n      // (--allow-incompatible-update--) Allow packages in your project to be //\n      // upgraded or downgraded to versions that are potentially incompatible //\n      // with the current versions, if required to satisfy all package version //\n      // constraints. (optional) //\n    },\n    env: {\n      // You can even use NoIP for this as long you point the domain to your //\n      // IP on your server. //\n      // ROOT_URL: 'http://xxx.xx.xxx.xx', // use this if you dont have a domain name or sub domain\n      ROOT_URL: 'http://example.com', // Use this if you using a domain name\n      // ROOT_URL: 'http://sub.example.com', // Use this if you using a sub domain name\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n      // log: { // (optional)\n      // driver: 'syslog',\n      // opts: {\n      // \"syslog-address\":'udp://syslogserverurl.com:1234'\n      // }\n      // },\n      // ssl: {\n      // port: 443,\n      // crt: 'bundle.crt',\n      // key: 'private.key',\n      // },\n    deployCheckWaitTime: 60 // default 10\n  },\n  mongo: { // (optional)\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n. @paulo2nd If you are working on it on a the Linux server and deploy it on it. You will need to set up mup but this version of Meteor Up is powered by Docker, making deployment easy to manage and reducing a lot of server specific errors.. If your using windows and going to Linux use this to help you out. I know Ubuntu support it but I don't know about Debian tho. \nhttps://github.com/Deadlyweed/Meteor-Up-Noobs/blob/master/windowssinglemup.md\nKadirahq has more Table of Contents then I do. If you want to know more about the other stuff I have comment out then check his out. \nhttps://github.com/kadirahq/meteor-up/blob/master/README.md\n. ",
    "ChenLi0830": "@madushan1000 Thanks, after including the mongo part, it seems the app can connect to mongo now. However, I got another issue. Here is the error log\n``\n[101.200.130.199]Error:/bundle/bundle/programs/server/node_modules/fibers/bin/linux-x64-v8-3.14/fibers.nodeis missing. Try reinstallingnode-fibers?\n[101.200.130.199]    at Object.<anonymous> (/bundle/bundle/programs/server/node_modules/fibers/fibers.js:16:8)\n[101.200.130.199]    at Module._compile (module.js:456:26)\n[101.200.130.199]    at Object.Module._extensions..js (module.js:474:10)\n[101.200.130.199]    at Module.load (module.js:356:32)\n[101.200.130.199]    at Function.Module._load (module.js:312:12)\n[101.200.130.199]    at Module.require (module.js:364:17)\n[101.200.130.199]    at require (module.js:380:17)\n[101.200.130.199]    at Object.<anonymous> (/bundle/bundle/programs/server/boot.js:1:75)\n[101.200.130.199]    at Module._compile (module.js:456:26)\n[101.200.130.199]    at Object.Module._extensions..js (module.js:474:10)\n[101.200.130.199]npm WARN deprecated This version of npm lacks support for important features,\n[101.200.130.199]npm WARN deprecated such as scoped packages, offered by the primary npm\n[101.200.130.199]npm WARN deprecated registry. Consider upgrading to at least npm@2, if not the\n[101.200.130.199]npm WARN deprecated latest stable version. To upgrade to npm@2, run:\n[101.200.130.199]npm WARN deprecated \n[101.200.130.199]npm WARN deprecated   npm -g install npm@latest-2\n[101.200.130.199]npm WARN deprecated \n[101.200.130.199]npm WARN deprecated To upgrade to the latest stable version, run:\n[101.200.130.199]npm WARN deprecated \n[101.200.130.199]npm WARN deprecated   npm -g install npm@latest\n[101.200.130.199]npm WARN deprecated \n[101.200.130.199]npm WARN deprecated (Depending on how Node.js was installed on your system, you\n[101.200.130.199]npm WARN deprecated may need to prefix the preceding commands withsudo, or if\n[101.200.130.199]npm WARN deprecated on Windows, run them from an Administrator prompt.)\n[101.200.130.199]npm WARN deprecated \n[101.200.130.199]npm WARN deprecated If you're running the version of npm bundled with\n[101.200.130.199]npm WARN deprecated Node.js 0.10 LTS, be aware that the next version of 0.10 LTS\n[101.200.130.199]npm WARN deprecated will be bundled with a version of npm@2, which has some small\n[101.200.130.199]npm WARN deprecated backwards-incompatible changes made tonpm run-scriptand\n[101.200.130.199]npm WARN deprecated semver behavior.\n[101.200.130.199]npm WARN package.json meteor-dev-bundle@0.0.0 No description\n[101.200.130.199]npm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\n[101.200.130.199]npm WARN package.json meteor-dev-bundle@0.0.0 No README data\n[101.200.130.199]=> Starting meteor app on port:80\n[101.200.130.199]\n[101.200.130.199]/bundle/bundle/programs/server/node_modules/fibers/fibers.js:16\n[101.200.130.199]   throw new Error(''+ modPath+ '.nodeis missing. Try reinstallingnode-fibe\n[101.200.130.199]         ^\n[101.200.130.199]Error: /bundle/bundle/programs/server/node_modules/fibers/bin/linux-x64-v8-3.14/fibers.node is missing. Try reinstalling node-fibers?\n[101.200.130.199]    at Object. (/bundle/bundle/programs/server/node_modules/fibers/fibers.js:16:8)\n[101.200.130.199]    at Module._compile (module.js:456:26)\n[101.200.130.199]    at Object.Module._extensions..js (module.js:474:10)\n[101.200.130.199]    at Module.load (module.js:356:32)\n[101.200.130.199]    at Function.Module._load (module.js:312:12)\n[101.200.130.199]    at Module.require (module.js:364:17)\n[101.200.130.199]    at require (module.js:380:17)\n[101.200.130.199]    at Object. (/bundle/bundle/programs/server/boot.js:1:75)\n[101.200.130.199]    at Module._compile (module.js:456:26)\n[101.200.130.199]    at Object.Module._extensions..js (module.js:474:10)\n```\nHere is my current mup.js file\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '101.200.130.199',\n      username: '**',\n      password: '****',\n      // pem: './mykey',\n    },\n  },\nmeteor: {\n    name: 'Octokey',\n    path: './',\n    servers: {\n      one: {},\n    },\n    env: {\n      ROOT_URL: 'http://101.200.130.199',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n    deployCheckWaitTime: 300,\n    enableUploadProgressBar: true  \n  },\nmongo: { //optional\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n``\n. Thanks @kayrules, after setting the mongo config in the mup.js file, the server is listening to the port now.\n. @madushan1000 Thanks for the reply. I tried to search for \"fibers.node is missing\" but can't seem to find the same issue in meteord's issues...\n. @MasterJames is it? Trying it now. \n. @MasterJames Man you saved my life!\nIt's pretty confusing to me where this is mentioned though. I couldn't find it anywhere even in meteor's History file. \nAnyway, I am so glad this is solved. It bothered me for days. \ud83d\udc83 \n. ",
    "rockie": "Sorry, pull to wrong repo.\n. ",
    "nilsi": "Strange it happened for me as well but I also just reran it and it worked.\n. The issue was line ending in \n/usr/local/lib/node_modules/mup/index.js\nThere was some ^M signs at the end of each row. I fixed this by running:\n$ git config --global core.autocrlf input (Only for OSX)\nThen I removed and cloned the repo again and it works.\n. I am not sure if this is my git setup or the repo itself that has bad line endings.\n. I tried to remove SSL. I removed force-ssland the ssl section from mup.js but still getting redirected to https. I even deployed freshly to a new server but still getting redirected when I'm trying with my domain. However, if I use the IP i can reach the site just fine. Im so confused right now.\n. @wanchopeblanco thanks!\nI saw that issue before but couldn't  follow the instruction. Im not sure how I can find the right nginx.conf\nSince I removed SSL i no longer have a frontend container.\nroot@repick:~# docker ps\nCONTAINER ID        IMAGE                      COMMAND                  CREATED             STATUS              PORTS                        NAMES\n07da6f2dbd21        mongo                      \"/entrypoint.sh mongo\"   56 minutes ago      Up 56 minutes       127.0.0.1:27017->27017/tcp   mongodb\nfa9d835aa465        meteorhacks/meteord:base   \"/bin/sh -c 'bash $ME\"   About an hour ago   Up About an hour    0.0.0.0:80->80/tcp           repick\nroot@repick:~# sudo find / -name nginx.conf\n/var/lib/docker/aufs/diff/d6c0156a8c993637bbb38d72be134a6f50a7b647f4f0c563d4248057ede380b8/tmp/lib/nginx.conf\n/var/lib/docker/aufs/diff/e3bae94b0a997ad46e6e4370a9df6aacc4dac4613596027a9b2e8cb6799d0a8b/tmp/nginx/nginx-1.8.0/conf/nginx.conf\n/var/lib/docker/aufs/diff/e3bae94b0a997ad46e6e4370a9df6aacc4dac4613596027a9b2e8cb6799d0a8b/opt/nginx/conf/nginx.conf\n/var/lib/docker/aufs/diff/4170e09b624c16af2d0d4eb6ebcfb2c3a2155a06cc8d1f12180992228edd9f2c/opt/nginx/conf/nginx.conf\n/root/letsencrypt/letsencrypt-nginx/letsencrypt_nginx/tests/testdata/etc_nginx/ubuntu_nginx_1_4_6/default_vhost/nginx/nginx.conf\n/root/letsencrypt/letsencrypt-nginx/letsencrypt_nginx/tests/testdata/etc_nginx/nginx.conf\nWhat am I supposed to edit? I looked in some of them but cant find the right server block.\n. Yes I tried a new VPS and I had the same problem.  After deployed a few times on that one it looks like this:\nsudo find / -name nginx.conf\n/var/lib/docker/aufs/diff/282bf4543daa9a584b287cba9ba0e03f1a500523d864d6a2dedd9d3ada0f0dc6/tmp/nginx/nginx-1.8.0/conf/nginx.conf\n/var/lib/docker/aufs/diff/282bf4543daa9a584b287cba9ba0e03f1a500523d864d6a2dedd9d3ada0f0dc6/opt/nginx/conf/nginx.conf\n/var/lib/docker/aufs/diff/b75779f37df4cffd4831249f53479e47842ec4e7918cba3494610822eba41450/tmp/lib/nginx.conf\n/var/lib/docker/aufs/diff/86b79c8b435e1e94bc361e6fd90ea9cfa4db8502f66c4c328c0c6d70235d44e6/opt/nginx/conf/nginx.conf\n/var/lib/docker/aufs/mnt/d835971bcc2eb31916b53db8896f54ae4663cbe16f7b9b32a4ea4c0cebe0e547/opt/nginx/conf/nginx.conf\n/var/lib/docker/aufs/mnt/d835971bcc2eb31916b53db8896f54ae4663cbe16f7b9b32a4ea4c0cebe0e547/tmp/nginx/nginx-1.8.0/conf/nginx.conf\nIt might add another nginx instance every time I run mup deploy or mup setup? I also wonder what those ID's are. According to the link you had it should match docker ps IDs but they don't in my case.\nI now found out that if I open my webpage in a browser that I never opened it in before it works with http. But when I try in an old one it still redirects to https and fails. Is this cached in the browser somehow? Incognito does not change anything.\n. Finally found a way to flush this at least for chrome on desktop. Just wonder if my visitors have the same problem now. I use the answer here to flush it: http://superuser.com/a/881431\nI might give it another try to add SSL now again then. But I don't see any reason for it to not to throw the 502 Bad Gateway error again once I do. I maybe should look into increasing that max size for nginx, that could still be it.\n. Thanks for all the help. No haven't tried yet but will do on a different domain now. Be right back.\n. WOW! it worked!! Finally!!\nDo you have any idea how I change this permanently? It seems like your pull request is not merged yet and this will be overridden on my next mup deploy I think.\nThanks again.\n. Since this is almost a year ago I dont completely remember but it works fine now. I think I might changed to kadirahq/meteor-up. I remember I had to change the docker image for it to work with meteor 1.4.  Like someone is mentioning in the issue previously linked here:\nhttps://github.com/meteorhacks/mup-frontend-server/issues/7. ",
    "varffs": "+1 \nThis seems to persist but resolve without changes. I also got these inconsistent error returns:\nError Protocol error: expected packet type 32, got 90\nError protocol error: rcvd type 90\nError Protocol error: expected packet type 21, got 90\nThen after running a few more times it went thru. I wonder if the issue is related to this package: https://www.npmjs.com/package/nodemiral which seems to be doing the copy to server command\n. ",
    "jLLOSAS": "This is happening to me as well... anyone find a fix? I've been getting the different errors but it hasn't gone through yet.\n. ",
    "sproleee": "I have the same problem. After trying about 15 tries, it suddenly went through.\nAnyone know what the problem is?. I just remembered that I created new SSH keys to push things to Github and messed everything up. Trying to fix this right now. What a nightmare.. I was able to get mup to work by running C:\\Users\\user\\AppData\\Roaming\\npm\\mup.cmd init to initialize mup, C:\\Users\\user\\AppData\\Roaming\\npm\\mup.cmd setup to set up for deployment and C:\\Users\\user\\AppData\\Roaming\\npm\\mup.cmd deploy to deploy my application.\nWindows is a horror show. Not sure why I can't even set up my environmental variables anymore.. @zodern The only other global install I have is webpack and it works fine.. ",
    "vhf": "@arunoda @madushan1000 I rebased this PR.\n. ",
    "ixdi": "Ok I think it's because graceful-fs@^4.0.0 dependency is needed as version <= 3.0.0 fails for node releases >= 6.0.\nA warning appears when installing mup.\nsilent-npm-registry-client@2.0.0 dependency is needed. This step is easy.\nPackage nofat depends on mocha that depends on glob (v3.2.3) but glob@7.0.3 is the current release :( This cause graceful-fs to be outdated\n. mocha accepted my pull request to update glob, so maybe is about few time that this is resolved.\n. ",
    "wdhif": "I can also confirm this issue for mupx https://github.com/arunoda/meteor-up/tree/mupx\n. You just have to go back to node 5.11\n. ",
    "kylepierce": "Had to go back to 5.8 to deploy\n. ",
    "jacobmischka": "According to this, upgrading archiver to 1.0 fixes it. It does indeed fix it for me, but I don't have a spare ubuntu machine or vm on which to run tests, so I'm not going to submit a pull request until it's been tested. \nThanks @mkpazon!\n. Oh whoops, didn't realize it would reference all my forced commit updates.\n. #113 \n. You can do the latter, sort of. You need to put each mup.js/mup.json config file in a separate directory.\nSo you can do:\nmkdir .mup/production && cd .mup/production/ && mup init\ncd ../..\nmkdir .mup/staging && cd .mup/staging && mup init\ncd ../..\nIn package.json:\njson\n...\n   \"scripts\": {\n      \"mup-production\": \"cd .mup/production && mup deploy\",\n      \"mup-staging\": \"cd .mup/staging && mup deploy\"\n   }\n...\nYou need to make sure your meteor.path setting in each mup config file is correct, (so '../../' if you put it in .mup/production like in my example.\nI haven't tested this myself yet, but it should work.\n. Er, actually if you are still using mupx it looks like you can do the --config option you mentioned directly: https://github.com/arunoda/meteor-up/tree/mupx#custom-configuration-and-settings-files\nEdit: Oh, that's what you said, my mistake. \n. Apologies, I need to change this branch.\n. That works too!\n. ",
    "jnanendraveer": "I have getting same issue. \nI have tried to multiple thoughts. But  still waiting for right solution. \nIf you guys know please share your thought.\nThanks\n. @ivanthemeh , I have got the issue. But don't know where is problem. I have setup everything again. Now working fine last 10 days. I suggest you please reinstall again. \nThanks\n. ",
    "ivanthemeh": "@jnanendraveer were you ever able to get this resolved? It looks like Im having an issue with the ids too, when I try to run docker ps and check the ids with the ones in /var/lib/docker/aufs/mnt/ none of them are matching up so I tried to go into it and change the proxy_buffer size for all of them and it still didnt work. \n. @adrianolsk can you tell me how you fixed this? IM having an issue where if I set the port to port 80 it will connect but if I set it to anything else it refuses to connect. \n. @codeHatcher I am having a similar issue and not able to set the meteor.port at all no matter what I put it to and when I set the meteor.env.PORT to 3000 like you did my site is only available at that specific port instead of being available on port 80 and mapping the container to 3000. Any ideas? \nhttps://github.com/zodern/meteor-up/issues/471\n. @zodern @CaptainChemist did you?\nits because these settings need to be added in the docker containers nginx server block \n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header Host $host;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"upgrade\";\n    proxy_buffer_size          128k;\n    proxy_buffers              4 256k;\n    proxy_busy_buffers_size    256k;\n\n. I had to fork the github repo for jwilder/nginx-proxy then create an automated build on docker hub. Trigger the build and the go the the file at /src/modules/meteor/assets/templates/start.sh to reflect your docker hub repo. Don't forget to update your forked repo with config settings before triggering the automated build. . Does this not work on ubuntu 16? I am having the same issues as you except Im using an instance with 1gb of ram..\n. @maxmatthews SO now Im able to deploy it but my server is refusing to connect...its an aws instance and I know the ports are open but its not working...any help please!\nIts starting my app on port 80 even though Im setting it to 3001 and its showing 3001=>80 in docker ps so is that the problem?\nOK so that was it, how can I fix that? Its setting the port right in the docker container but doesnt start meteor on the right port?\n. @maxmatthews @gaillota how can I force the app to start on port 3001?\nHow come when I specify the app port to 80 it works? but when I set it to anything else it breaks it? Something is going on and I have no idea how to even track it down and help would be AWESOME please!\nI need to be able to put more than one app on a server thats why I need to get this port thing figured out.\nPlease help me figure this out, Ill be eternally grateful.\n. @gaillota are you talking about multiple apps on a single server? Im certain you can do that with the port mapping I used to do it with mupx. \n. @maxmatthews shouldnt this be backwards for it to work with port mapping ? 0.0.0.0:3001->80/tcp. @maxmatthews so you cant help? Should I make my own issue i guess?\n. @maxmatthews Im not using the autogenerate currently\n. @maxmatthews https://github.com/zodern/meteor-up/issues/471\n. @maxmatthews I can setup the nginx to do the port mapping myself I was just under the impression (and hoping) I wasnt going to have to do that.. @maxmatthews \n```module.exports = {\n  servers: {\n    one: {\n      host: '1.2.3.4',\n      username: 'ubuntu',\n      pem: '/location/to/pem'\n      // password:\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\nmeteor: {\n    name: 'site',\n    path: '/location/to/site',\n    servers: {\n      one: {},\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'http://site.com',\n      MONGO_URL: 'mongodb://localhost/meteor',\n      PORT: 3000\n    },\n// change to 'kadirahq/meteord' if your app is not using Meteor 1.4 else abernix/meteord:base\n// dockerImage: 'abernix/meteord:base',\ndocker: {\n   image: 'abernix/meteord:base', // change to 'kadirahq/meteord' if your app is not using Meteor 1.4\n},\n\n// ssl: {\n//   // Enables let's encrypt (optional)\n//   autogenerate: {\n//     email: 'me@me.com',\n//     domains: 'site.com' // comma seperated list of domains\n//   }\n// },\n\ndeployCheckWaitTime: 60,\n\n// Show progress bar while uploading bundle to server\n// You might need to disable it on CI servers\nenableUploadProgressBar: true\n\n},\nmongo: {\n    oplog: true,\n    port: 27017,\n    version: '3.4.1',\n    servers: {\n      one: {},\n    },\n  },\n};. @maxmatthews whoops didnt see that..\n. @maxmatthews you think if I do that its going to cause me to have to do the ssl manually?\n. @maxmatthews so I set up the nginx reverse proxy like I usually do and its still only connecting if I go to the site at port 3000? What the heck is going on?\n. @maxmatthews\nserver {\n    listen                80;\n    server_name           site.com;\nlocation / {\n    proxy_pass http://127.0.0.1:3000;\n\n    proxy_http_version 1.1;\n\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header Host $host;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"upgrade\";\n    proxy_buffer_size          128k;\n    proxy_buffers              4 256k;\n    proxy_busy_buffers_size    256k;\n}\n\n}\n```. @maxmatthews its like the port I set in env is the port I have to view the site at so If I set it to port 3000 the only way I can view the site is with site.com:3000 and when I set the reverse proxy up it doesnt change a thing.. @maxmatthews nope... connection refused.\n. @maxmatthews were you able to get two sites on the same server working? Im about to give up on this its driving me nuts and Ive been working on it ALL DAY..\n. @maxmatthews should I setup the proxy first?\n. @maxmatthews I just tried setting it is still only available at site.com:3000 something is going on thats not supposed to be. It should be mapping the container to port 3000 and accepting port 80 traffic but its doing it the opposite. \nANY HELP Please!\n@zodern any ideas whats going on? \n. @kandizzy @melkati I was not able to figure this issue out. If either of you do let me know please \ud83d\ude04 \nI just had to settle for deploying a single instance per server for now. . @zodern does the front end not get reset on every deploy? . @zodern Im not sure how to do that, how would I install my forked package instead of yours? Sorry Im a nub.\n. @zodern I just tested adding those settings to the nginx-proxy and it got rid of the 502 bad gateway. SO I know it works just need to get it in the fork and publish to docker which Im working on atm.\n. @zodern how can I edit the nginx-proxy that gets used? Right now its jwilder/nginx proxy but I have no Idea where to change it to a fork of mine? Please and thanks.\nI cant even figure out how to clone a github repo and make a docker hub of it that I can pull \ud83d\ude22 \nand it sucks because all I need to add is either a file to /etc/nginx inside the container or add three lines of code to the conf.d/default.conf file..\n. @zodern ok so I figured out how to make an automated build using a fork of a github repo so thats cool, now ALL I should have to do is edit the jwilder/niginx-proxy to mine right? Where would I do that at lol? I searched through some of the mup files and folders and was unable to figure out where to put it. Please and thanks!. @shadowcodex according to the jwilder/nginx-proxy adding a file at /etc/nginx/proxy.conf allows changing the config. I have no idea how to do that it it may help you. . @PolGuixe did you ever figure this out? Im having this issue as well.\n. @zodern that's fine but what if it goes down and I'm not there then my app is down. Shouldn't it restart automatically? . @iAssureIT can you show that it is changing your ports in the docker config? Im having an issue with even SETTING the PORT... Anytime I change it its does nothing to the docker containers and givers me a error on deploy with no error messages and still deploys the app..\n@zodern any ideas, Ive tried dropping the ssl and it still does absolutely nothing when I add env.PORT?. @zodern it is showing me that but its not connecting at all, even when I setup the reverse proxy its not working.. @zodern ok Ive got it working with two apps but my second app for some reason is a duplicate of the other one even though I deployed a different app... @zodern I got it working, Im guessing I have to set up the letsencrypt myself?. ",
    "slam310": "Hi,\nI just went through this issue for while and I want to share with you what was the problem for me ...\nMy context  : Meteor 1.3.3.1 / ssl cert / mupx for deploying my app on an EC2 instance \nThe issue : 502 Bad Gateaway error message ( but everything works like a charm without the ssl setup http ).\nMy solution : Taking out the Browser Policy package  !!!  I didn't investigate more for now but if someone could point me why and how I can keep this package anyway, I would be nice of you .\nHope it helps some of you !\n. ",
    "fisherman818": "@nilsi can I know what is your final working fix to the problem? thanks. thanks @madushan1000 solved the problem!. Does it work on port 3000? the default meteor port? and are you on Nginx?. I am having the same problem now. have u found a solution?. @kjp17 I solved my issue. Refer to: https://github.com/kadirahq/meteor-up/issues/249\n. ",
    "sunlee-newyork": "FYI I reduced the amount of domains in my browser-policy config (specifically BrowserPolicy.content.allowOriginForAll()) and that resolved the 502 error.. @enzolutions I have server.js that imports each serverside initialization files in its separate Meteor.startup wrapper - importing SSL package before BrowserPolicy. +1 running a DigitalOcean droplet and server is maxed out at 20GB\n$ df -h\nFilesystem      Size  Used Avail Use% Mounted on\nudev            225M     0  225M   0% /dev\ntmpfs            49M  5.8M   44M  12% /run\n/dev/vda1        20G   20G  112K 100% /\ntmpfs           245M  120K  245M   1% /dev/shm\ntmpfs           5.0M     0  5.0M   0% /run/lock\ntmpfs           245M     0  245M   0% /sys/fs/cgroup\ntmpfs            49M     0   49M   0% /run/user/1000\n$ du -h --max-depth=2 /opt\n7.5M    /opt/digitalocean/bin\n7.5M    /opt/digitalocean\n8.0K    /opt/mongodb\n8.1G    /opt/[usr]/last\n345M    /opt/[usr]/current\n32K     /opt/[usr]/certs\n117M    /opt/[usr]/tmp\n44K     /opt/[usr]/config\n8.6G    /opt/[usr]\n8.6G    /opt\nAfter reading the article @artpolikarpov provided, I ran docker images --no-trunc | grep '<none>' | awk '{ print $3 }' \\  | xargs -r docker rmi and it cleaned up ~650MB:\n$ df -h\nFilesystem      Size  Used Avail Use% Mounted on\nudev            225M     0  225M   0% /dev\ntmpfs            49M  5.8M   44M  12% /run\n/dev/vda1        20G   19G  763M  97% /\ntmpfs           245M  120K  245M   1% /dev/shm\ntmpfs           5.0M     0  5.0M   0% /run/lock\ntmpfs           245M     0  245M   0% /sys/fs/cgroup\ntmpfs            49M     0   49M   0% /run/user/1000\ndu -h --max-depth=2 /opt\n7.5M    /opt/digitalocean/bin\n7.5M    /opt/digitalocean\n8.0K    /opt/mongodb. Huh... strange. After my last comment, I have deployed a couple more times, and my usage is lower now. I haven't done anything additional except running mup deploy.\n$ df -h\nFilesystem      Size  Used Avail Use% Mounted on\nudev            225M     0  225M   0% /dev\ntmpfs            49M  6.0M   43M  13% /run\n/dev/vda1        20G   15G  4.9G  75% /\ntmpfs           245M  640K  244M   1% /dev/shm\ntmpfs           5.0M     0  5.0M   0% /run/lock\ntmpfs           245M     0  245M   0% /sys/fs/cgroup\ntmpfs            49M     0   49M   0% /run/user/1000. @zodern after a few few months, i decided to finally go in to the /opt/[user]/last dir and turns out that /last dir was recursively storing the same content! It cleared up 7GB.. @zodern @ZhuQinglei thank you so much, stopping and starting mup/nginx worked for me as well!. Not sure if my issue is related to this, but I realized the basic authentication I had set up directly in my server before SSL (proxy 3000 to 80) became obsolete after I added letsencrypt ssl autogenerate and I can't figure out a way to add basic_auth to 443.. ```\nmeteor-base@1.1.0             # Packages every Meteor app needs to have\nmobile-experience@1.0.4       # Packages for a great mobile UX\nmongo@1.1.18                   # The database Meteor supports right now\nblaze-html-templates@1.0.4    # Compile .html files into Meteor Blaze views\nreactive-var@1.0.11            # Reactive variable for tracker\njquery@1.11.10                  # Helpful client-side library\ntracker@1.1.3                 # Meteor's client-side reactive programming library\nes5-shim@4.6.15                # ECMAScript 5 compatibility for older browsers.\nkadira:flow-router\naccounts-password@1.3.6\naccounts-facebook@1.2.0\npracticalmeteor:mocha\npracticalmeteor:chai\npracticalmeteor:sinon\nreact-meteor-data\nstd:accounts-ui\nstd:accounts-material\ndburles:google-maps\nshell-server@0.2.3\ncheck@1.2.5\nmeteortoys:allthings\njcbernack:reactive-aggregate\necmascript@0.8.0\naudit-argument-checks@1.0.7\nfacebook-config-ui@1.0.0\nmatb33:collection-hooks\nemail@1.2.1\nalanning:roles\ntarang:ssl\nbrowser-policy@1.1.0\nforce-ssl@1.0.14\ndynamic-import\nfourseven:scss\nmaterialize:materialize\ntmeasday:publish-counts\naccounts-google\nservice-configuration\n```. Wow... I am definitely ashamed of myself for having missed that. Sorry for the trivial issue! Thank you very much for your time :). ",
    "enzolutions": "@sunlee-newyork so you install that package in your application and where did you setup that? thanks in advance. @louwers force-ssl is a metero npm package or some kind of mup option or settings in mup.js? Thanks in advance. Hi @ivanthemeh \nLooks like did you resolve the issue that is driving me crazy. I am wondering if you manage to publish a docker image to share with the community.\nIf not, could you tell me what image I have to fork and what files I need to change and the specific change, to try to do on my side.\nThanks in advance.. I have Meteor 1.5.2 in my local and despite the recommendation the image of docker abernix/meteord:base works perfectly. Hi folks\nActually, after thinking a little bit more the problem wasn't the env variable wasn't accessible, the problem was the value wasn't encoded causing the URL for SMTP a bad formation.\nI just set my environment variable to the encoded values and works like a charm.\nA least, the workaround would work for someone else.\nGreat work BTW.. Actually, the same issue apply for MONGO_URL, if you use secure password and users with special characters \ud83d\ude04 . Awesome. I am trying to do the same.\nI did what the documentation recommend about two create two folders with separate configurations files as you can see in the following image.\n\nHere the first configuration file\n```\nmodule.exports = {\n    servers: {\n        one: {\n            // TODO: set host address, username, and authentication method\n            host: '123.456.789.01',\n            username: 'root',\n            pem: '~/.ssh/myapp'\n            //password: '***'\n            // or neither for authenticate from ssh-agent\n        }\n    },\napp: {\n    // TODO: change app name and path\n    name: 'myapp',\n    path: '../',\n\n    servers: {\n        one: {},\n    },\n\n    buildOptions: {\n        serverOnly: true,\n    },\n\n    env: {\n        // TODO: Change to your app's url\n        // If you are using ssl, it needs to start with https://\n        ROOT_URL: 'https://myapp.example.com',\n        MONGO_URL: 'mongodb://administrator:XXXXX@SERVER.mlab.com:15563/myapp?replicaSet=rs-SERVER',\n    },\n\n    ssl: { // (optional)\n        // Enables let's encrypt (optional)\n        autogenerate: {\n            email: 'yes@example.com',\n            // comma separated list of domains\n            domains: 'myapp.example.com'\n        }\n    },\n\n    docker: {\n        image: 'abernix/meteord:node-8.4.0-base',\n    },\n\n    // Show progress bar while uploading bundle to server\n    // You might need to disable it on CI servers\n    enableUploadProgressBar: true\n},\nproxy: {\n    domains: 'myapp.example.com'\n}\n\n}\n```\nAnd my second file is almost the same\n```\nmodule.exports = {\n    servers: {\n        one: {\n            // TODO: set host address, username, and authentication method\n            host: '123.456.789.01',\n            username: 'root',\n            pem: '~/.ssh/myappdev'\n            //password: '***'\n            // or neither for authenticate from ssh-agent\n        }\n    },\napp: {\n    // TODO: change app name and path\n    name: 'myappdev',\n    path: '../',\n\n    servers: {\n        one: {},\n    },\n\n    buildOptions: {\n        serverOnly: true,\n    },\n\n    env: {\n        // TODO: Change to your app's url\n        // If you are using ssl, it needs to start with https://\n        ROOT_URL: 'https://myappdev.example.com',\n        MONGO_URL: 'mongodb://administrator:XXXXX@SERVER.mlab.com:15563/myappdev?replicaSet=rs-SERVER',\n    },\n\n    ssl: { // (optional)\n        // Enables let's encrypt (optional)\n        autogenerate: {\n            email: 'yes@example.com',\n            // comma separated list of domains\n            domains: 'myappdev.example.com'\n        }\n    },\n\n    docker: {\n        image: 'abernix/meteord:node-8.4.0-base',\n    },\n\n    // Show progress bar while uploading bundle to server\n    // You might need to disable it on CI servers\n    enableUploadProgressBar: true\n},\nproxy: {\n    domains: 'myappdev.example.com'\n}\n\n}\n```\nAs you can see I am using the proxy recommendation.\nMy application was running alone, and no problem, after change the config with proxy approach stills works.\nBut when I tried to deploy the second instance, I always got the following error, so the app is never deployed on the server.\nRetrying in 3 seconds\nFailed to copy file  { Error: No such file\n    at SFTPStream._transform (/Users/enzo/.npm-packages/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2-streams/lib/sftp.js:384:27)\n    at SFTPStream.Transform._read (_stream_transform.js:186:10)\n    at SFTPStream._read (/Users/enzo/.npm-packages/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2-streams/lib/sftp.js:170:15)\n    at SFTPStream.Transform._write (_stream_transform.js:174:12)\n    at doWrite (_stream_writable.js:387:12)\n    at writeOrBuffer (_stream_writable.js:373:5)\n    at SFTPStream.Writable.write (_stream_writable.js:290:11)\n    at Channel.ondata (_stream_readable.js:639:20)\n    at emitOne (events.js:116:13)\n    at Channel.emit (events.js:211:7)\n    at addChunk (_stream_readable.js:263:12)\n    at readableAddChunk (_stream_readable.js:250:11)\n    at Channel.Readable.push (_stream_readable.js:208:10)\n    at SSH2Stream.<anonymous> (/Users/enzo/.npm-packages/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2/lib/Channel.js:140:15)\n    at emitOne (events.js:116:13)\n    at SSH2Stream.emit (events.js:211:7) code: 2, lang: '' }\nRetrying in 3 seconds\nA lot of issues mentioned something about memory, but I get on the server and using htop  the memory consumption is not the issue.\n\nI think there is something in mup app that I am missing out \ud83d\ude03 \n. ",
    "idanwe": "Yes only those logs\nAnd I success to deploy with mup and mupx from arunoda/meteor-up\nMy Node version is v5.2.0, should I provided more information?\n. There aren't\nOn Wed, May 4, 2016 at 6:58 AM Madushan Nishantha notifications@github.com\nwrote:\n\nThat's strange. Can you check if there are any docker containers running\non the server after this?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/117#issuecomment-216735802\n. @j6k4m8 Change to absolute path fixed it, thanks alot\n. @artpolikarpov Do you have any updates on this or you were able to find other solution?. @santteegt @tomtom87 can you post here the transition to AWS and the setting of the load balancer with mup. \nI will be my next tasks this week and would really appreciate some references.. It keeps to fails also with mup@1.3.5-beta1 but with different error:\n\n```\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[IP] - Pushing Meteor App Bundle to The Server\n[IP] - Pushing Meteor App Bundle to The Server: SUCCESS\n[IP] - Prepare Bundle\n[IP] x Prepare Bundle: FAILED\n-----------------------------------STDERR-----------------------------------\nown extended header keyword `SCHILY.nlink'\ntar: Ignoring unknown extended header keyword `SCHILY.dev'\ntar: Ignoring unknown extended header keyword `SCHILY.ino'\ntar: Ignoring unknown extended header keyword `SCHILY.nlink'\ntar: Ignoring unknown extended header keyword `SCHILY.dev'\ntar: Ignoring unknown extended header keyword `SCHILY.ino'\ntar: Ignoring unknown extended header keyword `SCHILY.nlink'\ntar: Ignoring unknown extended header keyword `SCHILY.dev'\ntar: Ignoring unknown extended header keyword `SCHILY.ino'\ntar: Ignoring unknown extended header keyword `SCHILY.nlink'\ntar: Ignoring unknown extended header keyword `SCHILY.dev'\ntar: Ignoring unknown extended header keyword `SCHILY.ino'\ntar: Ignoring unknown extended header keyword `SCHILY.nlink'\ntar: Ignoring unknown extended header keyword `SCHILY.dev'\ntar: Ignoring unknown extended header keyword `SCHILY.ino'\ntar: Ignoring unknown extended header keyword `SCHILY.nlink'\ndocker: 'image' is not a docker command.\nSee 'docker --help'.\n-----------------------------------STDOUT-----------------------------------\n\nSending build context to Docker daemon 179.4 MB\n    Step 1 : FROM abernix/meteord:node-8.4.0-base\n    # Executing 1 build trigger...\n    Step 1 : ENV NODE_VERSION ${NODE_VERSION:-8.4.0}\n     ---> Using cache\n     ---> XXXXXXXXX\n    Step 2 : RUN mkdir /built_app\n     ---> Using cache\n     ---> XXXXXXXXX\n    Step 3 : COPY ./ /built_app\n     ---> Using cache\n     ---> XXXXXXXXX\n    Step 4 : ENV ROOT_URL https://XXXX.XXXX.XXX\n     ---> Using cache\n     ---> XXXXXXXXX\n    Step 5 : ENV MONGO_URL mongodb://XXXXXXXXXXXXXXXXX   ---> Using cache\n     ---> e8f5203d2904\n    Step 6 : RUN cd  /built_app/programs/server &&     npm install --unsafe-perm\n     ---> Using cache\n     ---> XXXXXXXXX\n    Successfully built XXXXXXXXX\n    app\n    ----------------------------------------------------------------------------\n```\nAnd the error I got on mup@1.3.5 was:\n```\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[IP] - Pushing Meteor App Bundle to The Server\n[IP] - Pushing Meteor App Bundle to The Server: SUCCESS\n[IP] - Prepare Bundle\n[IP] x Prepare Bundle: FAILED\n-----------------------------------STDERR-----------------------------------\ndocker: 'image' is not a docker command.\nSee 'docker --help'.\n-----------------------------------STDOUT-----------------------------------\n\nSending build context to Docker daemon 179.4 MB\n    Step 1 : FROM abernix/meteord:node-8.4.0-base\n    # Executing 1 build trigger...\n    Step 1 : ENV NODE_VERSION ${NODE_VERSION:-8.4.0}\n     ---> Using cache\n     ---> XXXXXXXXXXXX\n    Step 2 : RUN mkdir /built_app\n     ---> Using cache\n     ---> XXXXXXXXXXXX\n    Step 3 : COPY ./ /built_app\n     ---> Using cache\n     ---> XXXXXXXXXXXX\n    Step 4 : ENV ROOT_URL https://XXX.XXXXX.XXX\n     ---> Using cache\n     ---> XXXXXXXXXXXX\n    Step 5 : ENV MONGO_URL mongodb://XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n     ---> Using cache\n     ---> XXXXXXXXXXXX\n    Step 6 : RUN cd  /built_app/programs/server &&     npm install --unsafe-perm\n     ---> Using cache\n     ---> XXXXXXXXXXXX\n    Successfully built XXXXXXXXXXXX\n    app\n    ----------------------------------------------------------------------------\n```. Docker version 1.12.6, build 7392c3b/1.12.6. running mup docker setup also throughs error:\n```\nmup docker setup\nStarted TaskList: Setup Docker\n[IP1] - Setup Docker\n[IP2] - Setup Docker\n[IP1] x Setup Docker: FAILED\n-----------------------------------STDERR-----------------------------------\nrm: cannot remove \u2018/var/lib/dpkg/lock\u2019: No such file or directory\nrm: cannot remove \u2018/var/cache/apt/archives/lock\u2019: No such file or directory\nsudo: dpkg: command not found\nsudo: apt-get: command not found\n-----------------------------------STDOUT-----------------------------------\n1.12.6\nMajor 1\nMinor 12\nminor wrong\n----------------------------------------------------------------------------\n\n```. Amazon Linux AMI release 2017.03. @zodern update docker solved the problem! thank you very much!!. Also happened to me on macos 10.12.6.\nTried to deploy meteor v1.6 with mage: 'abernix/meteord:node-8.4.0-base' and it failed.\nwith the following error message:\ndocker: 'image' is not a docker command.\nThen, I tried to re-deploy the last deployed version of my app with meteor v1.5.2.2 and it failed too also more to the last mup version I used v1.3.2 and failed too :(\nwith the following error message:\ntar: Malformed extended header: missing newline\nCan I help with farther details?. ",
    "johannchen": "I only see \"Building App Bundle Locally\", What other log messages suppose to show?\n. No, I didn't miss the \"mup setup\". It seems the \"mup deploy\" does nothing.\n. Never mind, I need to stop the previous meteord container first, then start meteor: success.\n. ",
    "Igor1201": "@idanwe mine started working when I removed the pem: \"~/.ssh/id_rsa\" line\n. ",
    "j6k4m8": "@idanwe @Igor1201 Using an absolute path for your pem should fix this.\n. Try a nodeVersion of 0.10.43, and roll back your meteor version to 1.3.1: meteor update --release \"1.3.1\".\nI can't believe this is required, and I wish the developers would find a way to make this work with latest Meteor/node. But at least in my this-needs-to-be-online-immediately case, I'm satisfied.\n@madushan1000, are there fixes for this in the works?\n. I can confirm that with a fully valid PEM, we still encounter this error.\n. glad it helped!!\n. Why is this closed? Resolved in a new version..?\n. I believe this is happening because mup fails to delete old versions of the app in opt/[appname].. Unfortunately this was on a temporary development server and I have since spun it down. But I can confirm that these commands indicated (both before and after I emptied /opt) that these were indeed the culprit directories.. ",
    "mlumbroso": "@j6k4m8  I have the same problem, tried to downgrade node and Meteor as you suggested but it didn't change the fact it hangs forever on Building App Bundle Locally with no more details. Any thoughts? Were there the only steps you tried to make it work?\nThanks\nEdit : retrying finally made it work, I can confirm your steps fixed the problem :-) Thanks a lot for this\n. ",
    "jcheroske": "If you examine your iptables rules, do you see a DOCKER chain that's\nallowing all traffic to the Meteor port?\nOn Sunday, May 8, 2016, Madushan Nishantha notifications@github.com wrote:\n\nI can't reproduce this on a digitalocean 512MB droplet with ubuntu 14.04\nusing kadirahq/meteor-up.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly or view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/119#issuecomment-217777918\n. There are really two issues going on here. \n\n1) The DOCKER chain is opening up the meteor (and apparently the mongo port as well) to traffic on all interfaces. This seems to be unnecessary. Simply using the \"--iptables=\"false\" flag causes the DOCKER chain to be empty, but everything still works on my Digital Ocean VPS without it. For instance, doing a mupx deploy works fine, and the installation is able to be verified on localhost:<meteor_port>.\n2) Because the iptables rules are being altered directly, tools such as ufw are ignorant that ports have been opened and incorrectly report the state of the firewall. Although this is not a mupx problem directly, mupx can surprise fewer admins by simply not allowing docker to alter iptables.\n. ",
    "mikemeier": "This would be fixed with https://github.com/kadirahq/meteor-up/blob/master/src/modules/meteor/assets/templates/start.sh#L31\nYou can override docker parameters now. It's not really a mup problem, its a docker \"feature\": https://fralef.me/docker-and-iptables.html\n. @madushan1000 When exactly was this es7 integrated? Maybe I'll have a look for a workaround. Could be for example synchron deploying instead of parallel. The bundling takes quite a lot of time, so the deployment would still speed up if this task only has to be done once.\n. @stefanve actually not implemented but will later help to setup environmen/server vars per server.\n. @guilcorp without ssl (I use haproxy for ssl termination and loadbalancing) and deployment with mup.js is only possible server after server. Ah and I dont use mongodb by meteor, I installed on 3 nodes (1 master with haproxy and mongodb / 2 nodes with meteor and mongodb) mongodb with replicaset by my self. (Provisioning done over ansible)\n. @Sewdn Its already implemented but not yet tagged I think: https://github.com/kadirahq/meteor-up/blob/master/src/modules/meteor/assets/templates/start.sh#L31\n. @reel see here: https://github.com/kadirahq/meteor-up/blob/master/src/modules/meteor/index.js#L148\nI forked the repo and removed this line and it did work then. I'm not sure how to interpret the comment part // Changing the port is done via the start.sh script\n. Bit more info: \n```\nmup:module:default exec => mup deploy +0ms\nmup:module:meteor exec => mup meteor deploy +1ms\nmup:module:meteor exec => mup meteor push +2ms\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor\n[XXX.XX.XX..XX.XXX.XX.XX..XX] - Pushing Meteor App Bundle to The Server\nnodemiral:sess:XXX.XX.XX..XX.XXX.XX.XX..XX copy file - src: /tmp/59a683bd-25a4-438e-b1c4-a9cb9d591be4/bundle.tar.gz, dest: /opt/app-name/tmp/bundle.tar.gz, vars: undefined +0ms\n[XXX.XX.XX..XX.XXX.XX.XX..XX] - Pushing Meteor App Bundle to The Server\nnodemiral:sess:XXX.XX.XX..XX.XXX.XX.XX..XX copy file - src: /tmp/59a683bd-25a4-438e-b1c4-a9cb9d591be4/bundle.tar.gz, dest: /opt/app-name/tmp/bundle.tar.gz, vars: undefined +0ms\n[XXX.XX.XX..XX.XXX.XX.XX..XX] - Pushing Meteor App Bundle to The Server: SUCCESS\n[XXX.XX.XX..XX.XXX.XX.XX..XX] - Pushing the Startup Script\nnodemiral:sess:XXX.XX.XX..XX.XXX.XX.XX..XX copy file - src: /usr/local/lib/node_modules/mup/lib/modules/meteor/assets/templates/start.sh, dest: /opt/app-name/config/start.sh, vars: {\"appName\":\"app-name\",\"useLocalMongo\":0,\"port\":\"3005\",\"logConfig\":{\"opts\":{\"max-size\":\"100m\",\"max-file\":10}},\"docker\":{\"image\":\"abernix/meteord:base\",\"args\":[\"--net=host\"]}} +20s\n[XXX.XX.XX..XX.XXX.XX.XX..XX] - Pushing Meteor App Bundle to The Server: SUCCESS\n[XXX.XX.XX..XX.XXX.XX.XX..XX] - Pushing the Startup Script\nnodemiral:sess:XXX.XX.XX..XX.XXX.XX.XX..XX copy file - src: /usr/local/lib/node_modules/mup/lib/modules/meteor/assets/templates/start.sh, dest: /opt/app-name/config/start.sh, vars: {\"appName\":\"app-name\",\"useLocalMongo\":0,\"port\":\"3005\",\"logConfig\":{\"opts\":{\"max-size\":\"100m\",\"max-file\":10}},\"docker\":{\"image\":\"abernix/meteord:base\",\"args\":[\"--net=host\"]}} +20s\n[XXX.XX.XX..XX.XXX.XX.XX..XX] - Pushing the Startup Script: SUCCESS\n[XXX.XX.XX..XX.XXX.XX.XX..XX] x Pushing the Startup Script: FAILED\nNo response from server\n```\nThe script stops sometimes also without any error on \"Pushing the Startup Script\".\n. @reel can you close this one in favor of #122 ?\n. Override the docker image, as described here (meteor.dockerImage): https://github.com/kadirahq/meteor-up/blob/628164f4035f867bd9968842ad0ca763861082e3/README.md\nTo abernix/meteord:base\n. @wolganens In de stable 1.0.2 its dockerImage. On dev-master (ah and since 3h also on new version 1.0.3) we got the new docker object with key image. Depends on what you're using.\n. Did you try the docker image abernix/meteord:base ?\n. ",
    "MichaelJCole": "Hey, so would this be used in mup.js like this?\n```\nmodule.exports = {\n  servers: {\n    one: { /.../ }\n  },\nmeteor: {\n    name: 'app',\n    path: '../app',\n    servers: { /.../  },\n    env: { /.../  },\n    dockerImage: 'madushan1000/meteord-test', //optional\n    deployCheckWaitTime: 60, //default 10\n    buildOptions: [ \n        \"--server-only\",\n        \"--mobile-settings='' \",\n        \"--debug\"\n    ]\n  },\n};\n```\nI haven't used this version of mupx.  Is it ready or do yall feel it needs more time?\nThanks!\nMike\n. What is the use case for not including \"--server-only\" in the options?  \nThis seems like something that should always happen, or at least be the default.\n. Hey Mudashan, no, I'm using what meteor uses - 0.10.43\n. Hey Madushan, Meteor doesn't use npm 3.  It uses the version with node\n0.10.43.  That's why these packages should be included until Meteor starts\nusing a newer version of node\nOn Mon, May 30, 2016 at 11:35 PM, Madushan Nishantha \nnotifications@github.com wrote:\n\nWhat is the npm version? npm install properly install all the packages if\nyou are using npm version 3.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/kadirahq/meteor-up/pull/131#issuecomment-222590582,\nor mute the thread\nhttps://github.com/notifications/unsubscribe/ABb2FqxLXIpDO9wvsX-B_Y3RKGF8tgGnks5qG7p2gaJpZM4IpV0L\n.\n\n\nMichael Cole\nFounder and Engineer\nhttps://bigSmall.io\n. That is true, but why make it harder for the next person :-)  \nTBH, I gave up on the new mup and forked the old one because this makes it seem like few people are using the new version.\nIf you don't want to add these packages, maybe mentioning it in the readme?\n. This also happens if there and extra space at the end:\nWorks on Linux:\npem: '../../../../../../.ssh/id_rsa'\nDoesn't work:\npem: '../../../../../../.ssh/id_rsa '\n. ",
    "cmaddalozzo": "When trying to deploy to multiple servers the process hangs at the exact same spot for me. Any progress on this?\n\n. Just to add more info, my execution looks as follows:\n```\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor\n[172.31.3.154] - Pushing Meteor App Bundle to The Server\n[172.31.24.78] - Pushing Meteor App Bundle to The Server\n[172.31.24.78] - Pushing Meteor App Bundle to The Server: SUCCESS\n[172.31.24.78] - Pushing the Startup Script\n[172.31.24.78] - Pushing the Startup Script: SUCCESS\n```\nThe script never fails. It just hangs indefinitely at this stage.\n. ",
    "vtocco": "Any updates on this? I am getting similar behavior. If I do one server at a time it works fine. I get a timeout error once every few times, but mainly it just hangs at:\nDEBUG=* mup deploy\n  mup:module:default exec => mup deploy +0ms\n  mup:module:meteor exec => mup meteor deploy +2ms\n  mup:module:meteor exec => mup meteor push +4ms\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor\n[server1] - Pushing Meteor App Bundle to The Server\n  nodemiral:sess:server1 copy file - src: /tmp/30e07cdc-3da6-4d52-bf36-959e806ff736/bundle.tar.gz, dest: /opt/xxxxxxxx/tmp/bundle.tar.gz, vars: undefined +0ms\n[server2] - Pushing Meteor App Bundle to The Server\n  nodemiral:sess:server2 copy file - src: /tmp/30e07cdc-3da6-4d52-bf36-959e806ff736/bundle.tar.gz, dest: /opt/xxxxxxxx/tmp/bundle.tar.gz, vars: undefined +0ms\n[server2] - Pushing Meteor App Bundle to The Server: SUCCESS\n[server2] - Pushing the Startup Script\n  nodemiral:sess:server2 copy file - src: /usr/lib/node_modules/mup/lib/modules/meteor/assets/templates/start.sh, dest: /opt/xxxxxxxx/config/start.sh, vars: {\"appName\":\"xxxxxxxx\",\"useLocalMongo\":0,\"port\":80,\"logConfig\":{\"opts\":{\"max-size\":\"100m\",\"max-file\":10}},\"image\":\"abernix/meteord:base\"} +1s\n[server1] - Pushing Meteor App Bundle to The Server: SUCCESS\n[server1] - Pushing the Startup Script\n  nodemiral:sess:server1 copy file - src: /usr/lib/node_modules/mup/lib/modules/meteor/assets/templates/start.sh, dest: /opt/xxxxxxxx/config/start.sh, vars: {\"appName\":\"xxxxxxxx\",\"useLocalMongo\":0,\"port\":80,\"logConfig\":{\"opts\":{\"max-size\":\"100m\",\"max-file\":10}},\"image\":\"abernix/meteord:base\"} +1s\n[server1] - Pushing the Startup Script: SUCCESS\nSo server 2 never finishes.. \n. Decided to poke around:\n//BEFORE:\nfunction getDockerLogs(name, sessions, args) {\n  var command = 'sudo docker logs ' + args.join(' ') + ' ' + name;\n//FIXED:\nfunction getDockerLogs(name, sessions, args) {\n  var command = 'sudo docker ' + args.join(' ') + ' ' + name;\n//\nI removed logs from the docker command since we are joining it again from args which contains \"logs\". \n. Created a PR: #221 \n. This is the same issue as: #122 . The immediate fix is to just run it twice with one server each. \n. ",
    "madewithyou": "This is still an issue. Any update?\nParallel setup and deploy make errors and freeze. \nOn my side mainly with SSL certificates copy and SSL verification in setup.\nAnd for deployment, it's stuck on Pushing bundle on one of the server. \nIf setup & deploy one by one works like a breeze. \nIs someone got a multi servers setup acting normally?\n. Thanks Mike! I use a Cisco ip loadbalancer, routing all traffic to my servers.\nI tested to add the SSL on the load balancer, was not easy and not as update as needed for ssl-labs A+. I was using MUPX for months, worked great, it was a easy to setup and deploy on every server, including the copy of the SSL cert.\n. @elie222 How did you solve it?\nI made the update of OSX few hours ago but don't have any issue with ssh in terminal to my servers only with mup \"Error All configured authentication methods failed\". Thanks\n. @madushan1000 Could you please update the NPM package? Thanks!\n. Thanks @madushan1000 & @clayne11 working great!\n. ",
    "PauloMarceloNogueira": "Hello!\nMy config is \nservers: {\n    one: {\n      host: 'xxxxxxxx',\n      username: 'xxxxx'\n    },\n    two: {\n      host: 'xxxx',\n      username: 'xxxxx'\n    }\n  },\n  meteor: {\n    name: 'linteMup',\n    path: '../',\n    servers: {\n      one: {},two:{}\n    },\nAnd doesn't work...\nAny progress ?\n. @madushan1000 Any news?\n. Same problem...\nAny news?\n. ",
    "semikolon": "Please fix this. It blocks deploy when it hasn't been blocked before. I just upgraded an old app that was working fine, but then someone decided mup.json was ugly or something? Sorry, I really appreciate everyone working on meteor-up and putting their time into it. Just was a little bit annoyed at this seemingly unnecessary snag.\n. ",
    "jaredtmartin": "This solved part of my problem, but introduced another.  Now I'm getting: (node:28271) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: Cannot find module '.deploy/settings.json'\nI get this error whether I execute map deploy from the .deploy folder or from the root folder using mup deploy --config .deploy/mup.js\nI also tried copying the settings.json file into the .deploy folder, but that didn't help at all.. Same thing here, thanks for posting! Saved me hours of work!. I want to avoid the upload time.  It takes a long time, like 15min.\n\nOn Sep 29, 2017, at 9:34 AM, zodern notifications@github.com wrote:\n@jaredtmartin https://github.com/jaredtmartin could you please explain why you want to?\nIf you want to skip building, you can use mup deploy --cached-build, as @birdage https://github.com/birdage said.\nTo skip Prepare Bundle and everything before it, you can use mup reconfig.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub https://github.com/zodern/meteor-up/issues/745#issuecomment-333160104, or mute the thread https://github.com/notifications/unsubscribe-auth/AAYGCqxfLTNbpn1nbAmeoT_7IgUdRD0Tks5snQ4ggaJpZM4Pho03.\n\n\n. ",
    "adammoisa": "@jaredtmartin same here, did you find a fix?. Got a solution: in the .deploy folder, start from the mup init step which will create a new settings.json in that directory. It will automatically skip creating a new mup.js file though so no worries about that being overwriten. Once you've done this, mup setup and mup deploy will work fine.. I did that and still get this issue. Any ideas?. @zodern Leaving a comment here too :) Interested!. Yup found it in another thread, looks great!. ",
    "msj121": "@madushan1000 @derwaldgeist What was the end solution to doing this with kadirahq and not meteor hacks (as it states not to use it for Meteor 1.4)? Is there a way to put the command in mup.js? Or editing a mup file?\n. Originally got the idea here: https://github.com/tomitrescak/meteor-uploads/issues/235#issuecomment-228618130\nAdded issue for feature upgrade here: https://github.com/kadirahq/meteor-up/issues/160\n. I have a similar error; however, @marquesgabriel this idea didn't help me. I have also tried to update via sudo npm update mup -g and I still get the update message below... I am also running at Meteor 1.4.1.2\n```\n(node:69980) fs: re-evaluating native module sources is not supported. If you are using the graceful-fs module, please update it to a more recent version.\nupdate 1.0.0 => 1.0.4\nBuilding App Bundle Locally\n/Users/msj/.meteor/packages/meteor-tool/.1.4.1_2.fpzmec++os.osx.x86_64+web.browser+web.cordova/mt-os.osx.x86_64/dev_bundle/lib/node_modules/meteor-promise/promise_server.js:165\n      throw error;\n      ^\nError: ENOENT: no such file or directory, open '/private/tmp/mt-koh548/os.json'\n    at Error (native)\n=> Build Error. Check the logs printed above.\n(node:69980) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: build-error\n```\n. I removed mup and  re-installed, still getting this issue.\nI am running OSx and it looks like @bilinkis is running linux... I am not sure what the culprit is.\n. @bilinkis I am not too familiar with Ubuntu, what do you mean by a new workspace? On the client computer? I am just trying to find a solution, do you think it meant deleting all node_modules or something?\n. export METEOR_WAREHOUSE_URLBASE=https://d3fm2vapipm3k9.cloudfront.net\nThis helped me\n. Thanks, seems to be working now.\n. ",
    "derwaldgeist": "@msj121 I did not find a solution for this yet, as I did not want to fork mupx for this.\n. Hi, I would also love to see mup extended that it allows to force SSL automatically. Since Meteor 1.5, the force-ssl does not work with mobile apps on Android anymore, since it forces them to use SSL for their local server. Hence, I had to take out force-ssl out of my Meteor app. So it would be great if redirection could happen on nginx instead.. Awesome, that helps me a lot, thanks!. Ok, so this mup version does not allow interrupting an upload? I'm asking because this was never a problem with the old mupx. What happens if the network connection breaks down during an upload?\nPS: A re-deploy worked.. I now had the problem with the local dev server, too. So it is not related to mup. Closing this, sorry for bothering.. OK, thanks for the quick response!\nJust FYI: I tried again using the most recent mup version 1.3.0. It ran through with Verifying Deployment: SUCCESS, but the app wasn't started dispite of this. When I tried to show the logs via mup logs, I got this error message in return:\nError response from daemon: can not get logs from container which is dead or marked for removal\nWondering why mup deploy returned with Verifying Deployment: SUCCESS despite of this error?\nAnd is there a way to get rid of this \"dead or marked for removal\" problem?. Seems as if my app's container is dead, whatever that means:\nCONTAINER ID        IMAGE                                           COMMAND                  CREATED              STATUS              PORTS                                      NAMES\n128cebc490db        jrcs/letsencrypt-nginx-proxy-companion:latest   \"/bin/bash /app/en...\"   45 seconds ago       Up 44 seconds                                                  guzz-nginx-letsencrypt\n1996ba056c75        jwilder/nginx-proxy:latest                      \"/app/docker-entry...\"   About a minute ago   Up About a minute   0.0.0.0:80->80/tcp, 0.0.0.0:443->443/tcp   guzz-nginx-proxy\n2198f594acd6        66e350aaea2e                                    \"/bin/sh -c 'bash ...\"   About an hour ago    Dead                                                           guzz\n3c37c89bd61c        mongo                                           \"/entrypoint.sh mo...\"   7 months ago         Up 38 minutes       127.0.0.1:27017->27017/tcp                 mongodb. Is there a way to reset everything? I tried mup setup multiple times, but this didn't fix it. Also tried mup stop followed by mup setup and mup deploy, but the container remains in its dead state. Would be great if there was a kind of mup uninstall that cleans up everything.. Thanks. Already found a similar thread and tried to remove the image using docker rm -f. But this didn't work. I got this error message:\nError response from daemon: driver \"aufs\" failed to remove root filesystem for 2198f594acd69d2561de7236d2dd223c37bdbf632505321d98a86bd3b162ec30: error preparing atomic delete of aufs mountpoint for id: 2198f594acd69d2561de7236d2dd223c37bdbf632505321d98a86bd3b162ec30: rename /var/lib/docker/aufs/mnt/2198f594acd69d2561de7236d2dd223c37bdbf632505321d98a86bd3b162ec30 /var/lib/docker/aufs/mnt/2198f594acd69d2561de7236d2dd223c37bdbf632505321d98a86bd3b162ec30-removing: device or resource busy\nMaybe it's related to the fact that my server is using 96% of its free disk space? Will try the file system based rm -r now. Is there a way to stop docker completely before doing such stuff?. Thanks. Cleaned up all images but the MongoDB instance now. Let's see what happens on deploy.. Ok, the server is up and running again. Still wondering what caused the initial error message and broke the container, though. Shall I keep this open?. Here's the output:\n```\nusing image\nremoving last\nImage mup-guzz:latest\nVolume\nRemoving docker containers. Errors about nonexistent endpoints and containers are normal.\nError response from daemon: No such container: guzz\nError response from daemon: endpoint guzz not found\nError response from daemon: No such container: guzz-frontend\nError response from daemon: endpoint guzz-frontend not found\nError response from daemon: No such container: guzz-nginx-letsencrypt\nError response from daemon: endpoint guzz-nginx-letsencrypt not found\nError response from daemon: No such container: guzz-nginx-proxy\nError response from daemon: endpoint guzz-nginx-proxy not found\nFinished removing docker containers\n7575a28d32c816613704f80a1f322e7b10dd0f51bd726f2fa32e9e67f5be856b\nRan abernix/meteord:base\nRunning autogenerate\n--2017-08-23 17:15:14--  https://raw.githubusercontent.com/jwilder/nginx-proxy/master/nginx.tmpl\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.60.133\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.60.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 10529 (10K) [text/plain]\nSaving to: \u2018/opt/guzz/config/nginx.tmpl\u2019\n 0K ..........                                            100% 23.5M=0s\n\n2017-08-23 17:15:14 (23.5 MB/s) - \u2018/opt/guzz/config/nginx.tmpl\u2019 saved [10529/10529]\nlatest: Pulling from jrcs/letsencrypt-nginx-proxy-companion\nDigest: sha256:de2a41c7f99c6a942769d43162dce20abcd004b624c5b86b61073a5c536b313f\nStatus: Image is up to date for jrcs/letsencrypt-nginx-proxy-companion:latest\nlatest: Pulling from jwilder/nginx-proxy\nDigest: sha256:f2a37de9e65a20a1119cc7d8e98c9cf39dd4916b4a0f5f7eba9ddcb35290c83b\nStatus: Image is up to date for jwilder/nginx-proxy:latest\nPulled autogenerate images\nda84ca6f084e39669bd57135d87f121ecb4ee86f498da4642f9cae8e7c0cfe02\nRan nginx-proxy\n132bb40469a03e3756d86a9300c83a312c8089257849a06e890f52cc28572e0b\nRan jrcs/letsencrypt-nginx-proxy-companion\n```. I had to manually delete the containers. But this only worked if I restarted the server after the containers were marked for deletion. Otherwise, I got the error that they couldn't be removed from disk.\nThe steps are like this:\n\ndocker ps -a to show all containers\ndocker rm -f <container-id> for all containers you want to delete\nsudo reboot to restart the machine\ndocker system prune to cleanup the remainders of the dead containers on disk\nmup deploy\n. Sounds good! Two questions:\nwill this setup support letsencrypt?\nwill it support settings.json?\nAfter having read the original blog post and its comments, the latter seemed to be quite a challenge.. Thanks for the info. If I understand the description on the AWS site correctly, you get a SSL certificate for your site for free, like with letsencrypt, as long as you are using it in combination with AWS resources (like Elastic Beanstalk). Makes sense.. Thanks for making this public! Good to know there's a professional scaling option once we need it.. The fragment \"tsencrypt not found\" also looks as if there's a problem with letsencrypt somehow.. I deleted all containers and re-configured and re-deployed, but still I am getting this error.\n\nHere's the output of docker ps -a:\n8105ae6eaa8b        jwilder/nginx-proxy:latest               \"/app/docker-entry...\"   2 minutes ago       Created                                                                    travel-nginx-proxy\n5bf46c6f2715        mup-travel:latest                        \"/bin/sh -c 'bash ...\"   2 minutes ago       Restarting (1) 26 seconds ago                                              travel\nb183c37775ff        jrcs/letsencrypt-nginx-proxy-companion   \"/bin/bash /app/en...\"   16 minutes ago      Up 16 minutes                                                              mup-nginx-proxy-letsencrypt\n63ec5122f520        jwilder/nginx-proxy                      \"/app/docker-entry...\"   16 minutes ago      Up 16 minutes                   0.0.0.0:80->80/tcp, 0.0.0.0:443->443/tcp   mup-nginx-proxy. The app's nginx-proxy seems to be created, but is not running.. I now took out the additional meteor.ssl config, deleted all containers and redeployed. This worked. Maybe mup should throw an error if both settings are defined in parallel?. > what's the value you use as letsEncryptEmail\nI used an e-mail that is not related to the domain the server is running on.. Just ran into the same problem with a second app that had been using letsencrypt directly before. ssl is only enabled under proxy, it was a 1:1 copy of the other app where I had the problem for the first time. I also deleted all docker containers before deploying.. Changed the Docker image to zodern:meteor:root(was: abernix/meteord:node-8-base). Now it worked. Not sure if this was the problem, though.. I could solve this by changing the Docker image to abernix/meteord:node-8-base as suggested here: https://github.com/zodern/meteor-up/issues/808#issuecomment-346740335\nClosing this issue, but it would be great if this was mentioned in the docs.. Ah, I only looked at the sample configuration code: http://meteor-up.com/docs.html#everything-configured. There was no mention of the docker image there, only for 1.3 and below. And when I opened this issue, I wasn't aware this was related to Meteor 1.6. As soon as I realised, I closed it :-). +1 Is there a workaround?. ",
    "Siphion": "+1\nWhen the PR will be merged on Mupx stable? :)\n. ",
    "eskan": "+1\n. ",
    "vjrj": "+1\n. ",
    "oli77za": "+1\n. ",
    "T-Grave": "This is what Gitlab CI returns at the end of the CI execution log. As you can see mup returns an error on verifying the deployment and at the bottom gitlab returns \"build succesful\" while it should not.\nI checked the mup code and saw you do actually return exit codes on errors, do you think this is an issue with Gitlab CI rather than mup?\nMup logs:\n```\nStarted TaskList: Start Meteor\n[hostname] - Start Meteor\n[hostname] - Start Meteor: SUCCESS\n[hostname] - Verifying Deployment\n[hostname] x Verifying Deployment: FAILED\n```\n``\n-----------------------------------STDERR-----------------------------------\nges made tonpm run-script` and\nnpm WARN deprecated semver behavior.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No description\nnpm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No README data\nnpm WARN cannot run in wd meteor-dev-bundle@0.0.0 node npm-rebuild.js (wd=/bundle/bundle/programs/server)\n=> Starting meteor app on port:80\n/bundle/bundle/programs/server/boot.js:324\n}).run();\n   ^\nError: $ROOT_URL, if specified, must be an URL\n    at Error ()\n    at Meteor.absoluteUrl.options (packages/meteor/url_server.js:8:1)\n    at packages/meteor/url_server.js:19:1\n    at /bundle/bundle/programs/server/packages/meteor.js:1365:3\n    at /bundle/bundle/programs/server/boot.js:283:10\n    at Array.forEach (native)\n    at Function..each..forEach (/bundle/bundle/programs/server/node_modules/underscore/underscore.js:79:11)\n    at /bundle/bundle/programs/server/boot.js:133:5\n=> Redeploying previous version of the app\n-----------------------------------STDOUT-----------------------------------\nTo see more logs type 'mup logs --tail=50'\n\n```\nGitlab CI report:\nBuild succeeded.\n. Another instance when it fails to report the right state, well at least, that's what it seems to look like, maybe it's gitlab, not sure.\nMup logs:\n```\nBuilding App Bundle Locally\nErrors prevented bundling:\nWhile building for os.linux.x86_64:\nimports/orders/emails/templates/index.js:3:25: Unexpected token (3:25)\n=> Build Error. Check the logs printed above.\n```\nGitlab CI report:\nBuild succeeded.\n. @MasterJames My apologies if I wasn't clear enough on the subject, but this issue is not about why my apps are failing to deploy. This issue is about why GitLab CI (and possibly other CI platforms) are reporting the build went well while in reality it failed.\nWhich errors are causing mup to fail in deploying the app are irrelevant to this issue, the error you are pointing out has been put there on purpose to demonstrate mup is failing to report the correct error code to my Gitlab CI runner instance.\nThe Build succeeded. line is not printed by mup, it is printed by Gitlab CI as the \"result\" of my build.\nIt is possible this is an error with Gitlab CI, but since this did seem to work fine with MupX I thought I'd report it here.\n. ",
    "PositronicBrain": "Ok, I found out that it is a best practice to set the timezone of the server to UTC, and set local timezones on the client.\n. ",
    "hamz250": "Worked for me by \nnpm install --save-dev npm install babel-cli babel-preset-es2015 babel-preset-stage-3\n. ",
    "tomitrescak": "docker log my app gives me \"log is not a docker command\"\n. For some reason is is regenerating makefile .. that takes one minute to complete. Yet the deployment still fails even if I increase the waiting number.\n. @bearcanrun yes, that's what I'm trying to do, have multiple apps on my server. But it does not work ;(\nDocker ps gives me this:\na28efd5d9dac        abernix/meteord:base       \"/bin/sh -c 'bash $ME\"   3 minutes ago       Up 2 minutes                        0.0.0.0:3030->80/tcp   CsNew\nLast thing I see in meteor log is:\n[hugo.scem.uws.edu.au]npm WARN meteor-dev-bundle@0.0.0 No description\n[hugo.scem.uws.edu.au]npm WARN meteor-dev-bundle@0.0.0 No repository field.\n[hugo.scem.uws.edu.au]npm WARN meteor-dev-bundle@0.0.0 No license field.\n[hugo.scem.uws.edu.au]=> Starting meteor app on port:80\nIt also takes meteor about 2 minutes to rebuild following: [hugo.scem.uws.edu.au]  ACTION Regenerating Makefile\nEven with this I cannot access the meteor app with:\ntomas@hugo:~$ curl 0.0.0.0:3030\ncurl: (56) Recv failure: Connection reset by peer\nAny idea? Thanks!\n. I hate this ... out of the blue I check if my app is running .. and it is ... and this is that I had \"deployment failed\" message from mup. So I try to deploy again, and it worked ... with no changes. I have no idea. It all works now and I even get deployment ok message. I guess.. hooray! \nThanks for your kind help. Was very helpful. Made me go inside docker image and check whether everything is ok.\n. ",
    "justindra": "Will give that a go. Thanks!\n. ",
    "Sewdn": "I experienced the same issues (trying to connect to the same mup-managed mongodb from different apps (within the same project) all using the same db).\nI also edited template/start.sh to be able to override docker start configuration.\nI hope we can soon control docker run parameters from mup.js. Is there any PR or branch for this feature where we can follow (or contribute) progress? Thanks!\n. ",
    "hamzamu": "MONGO_URL: 'mongodb://172.17.0.3:27017/{database name} \nwhere is 172.17.0.3 is your docker IP \nget it thru : docker inspect mongodb ..\n. ",
    "Faberle": "I just wanted to add for future visitors (I was one too struggeling with this issue yesterday) :\nYou can simply add the docker arguments in your mup.js\n```\nmodule.exports = {\n  servers: {\n    production: {\n      host: 'xxx.xxx.xxx.xxx',\n      username: 'root',\n      password: 'secret',\n    },\n  },\nmeteor: {\n    name: 'app-backend',\n    path: '../../',\n    servers: {\n      production: {},\n    },\n    docker: {\n            image: 'abernix/meteord:base',\n            args:[ // lets you add/overwrite any parameter on the docker run command (optional)\n                \"--link=mongodb:mongodb\", // linking example\n            ]\n    },\n    env: {\n      ROOT_URL: 'http://app-backend.mydomain.com',\n      PORT: 3017,\n      MONGO_URL: 'mongodb://mongodb:27017/app-database'\n    },\n  },\n};\n```\nNo need to patch the start.sh ;)\n. After an hour of searching I now know that my path to my app was wrong... \nFeature request: More informative error when app can't be found xD\n. ",
    "awdjs": "the --link option is deprecated, check the link bellow.\nhttps://docs.docker.com/engine/userguide/networking/default_network/dockerlinks/\nhere is the solution in 2 steps :\nStep 1 : pull, setup and expose your Mongo container manually \n\n\npull the docker image \ndocker pull mongo:latest\n\n\nsetup your mongo container and expose the port\ndocker run --name mongodb -d -p 27017:27017 mongo\n\n\nStep 2 : configure the mup.js file to look like the following code snippet\n```\n/ export deployment configuration for Meteor up  /\nmodule.exports = {\n  servers: {\n    one: {\n      host: '1.1.1.1',\n      username: 'username', \n      pem: '/home/user/.ssh/id_rsa',\n      opts: {\n        port: 22\n      }\n    }\n  },\nmeteor: {\n    name: 'my-app',\n    path: '../app-folder',\nservers: {\n  one: {},\n},\n\nbuildOptions: {\n  serverOnly: true,\n},\n\nenv: {\n  ROOT_URL: 'http://1.1.1.1', \n  MONGO_URL: 'mongodb://1.1.1.1:27017/dbname', \n  PORT: 3001\n},\n\ndocker: {\n  image: 'abernix/meteord:base',\n},\n\ndeployCheckWaitTime: 250,\nenableUploadProgressBar: false\n\n},\n};\n```\n\n1.1.1.1 is the remote server's ip address.\n\nand we are done :) .. ",
    "anantonton": "Hello. Then how about encryption? Where do we put the CA file? . ",
    "rclai": "It would be nice to also be able to set other arbitrary environment variables per server so that they can be accessed via process.env.MY_VAR.. Please someone make the tests :(. Also, shouldn't those custom env variables be in the meteor.servers[<server-key>][<custom_var>] instead of the servers.env object?. Just an FYI that you may need to do a mup reconfig to get this to work.. I'm having the same problem and I have the right Docker image in place, but my error instead says:\n```\n/root/.meteor/packages/meteor-tool/.1.4.4_1.1t9hste++os.linux.x86_64+web.browser+web.cordova/mt-os.linux.x86_64/tools/cli/main.js:1487\n}).run();\n   ^\nSyntaxError: Unexpected token y\n    at Object.parse (native)\n    at /tools/cli/main.js:803:12\n=> Build Error. Check the logs printed above.\nError: build-error\n    at ChildProcess. (/root/.nvm/versions/node/v6.10.2/lib/node_modules/mup/lib/modules/meteor/build.js:46:16)\n    at emitTwo (events.js:106:13)\n    at ChildProcess.emit (events.js:191:7)\n    at maybeClose (internal/child_process.js:886:16)\n    at Socket. (internal/child_process.js:342:11)\n    at emitOne (events.js:96:13)\n    at Socket.emit (events.js:188:7)\n    at Pipe._handle.close [as _onclose] (net.js:501:12)\n```\nIf I try to build using the meteor CLI, it works fine, just not with mup unfortunately.. It worked for me.. My config follows the template in the read me. . Is that something that the abernix/meteord:base image needs to update for 1.5+ support? @abernix . Is that really a fix or a work-around?. ",
    "Themandunord": "Ok i'll try this soon. \nSi i have the choice between ubuntu 14, 15 and 16. Which one i need to choose ? \n. Ok,\nWith Ubuntu 14.04 LTS, installation works fine !\nThanks !!\n. @summerinsect I read that meteor-up only works for Ubuntu 14.04 TLS.\n. I will try this, and let you know if I succeed :+1: \nThanks.\n. Sorry, I forgot to reply to this post.\nI wanted PhantomJS to use Spiderable, but I switch to prenreder.io, so I don't need PhantomJS anymore.\nThanks for your help :+1: \n. +1 \ud83d\udc4d . This problem affect my server too. \nWith the upload of image <1Mb it's work, but not larger images.\nFor just a profil image upload I can't achieve that, so I think a PR is welcome :). Hi @shadowcodex , can you work on it ? . Yes me too !\nLe 13 f\u00e9vr. 2017 4:09 PM, \"Shannon Duncan\" notifications@github.com a\n\u00e9crit :\n\ncan confirm that this pull request is now working on my production\nenvironment.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/pull/451#issuecomment-279418441, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/ACsHVcFGQzEjC7A_H4kF3mrvFsixjtoFks5rcHIagaJpZM4L7d-c\n.\n. Thanks @zodern , you're rocks :). Before, I set it to off.\n\nNow I test it with full strict.\nI activate the proxy for the DNS.\nMy website still works.\nBut I think we need to wait for the DNS to be ready to be sure, don't it ?\nLe 12 f\u00e9vr. 2017 3:27 AM, \"zodern\" notifications@github.com a \u00e9crit :\n\nIn the cloudflare dashboard, go to Crypto and try changing it to Full or Full\n(strict)\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/459#issuecomment-279191693,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ACsHVeWpFuogNL1RtDftxfhZR6xiWWvSks5rbm4hgaJpZM4L-Xf-\n.\n. So I think it's work now :). \n",
    "summerinsect": "I have same issue with centos7\nwhich npm version i need to choose?\n. Started TaskList: Start Mongo\n[112.74.73.121] - start mongo\n[112.74.73.121] x start mongo: FAILED\n-----------------------------------STDERR-----------------------------------\nError while pulling image: Get https://index.docker.io/v1/repositories/library/mongo/images: dial tcp: lookup index.docker.io: no such host\n-----------------------------------STDOUT-----------------------------------\nTrying to pull repository docker.io/library/mongo ...\nPulling repository docker.io/library/mongo\nError while pulling image: Get https://index.docker.io/v1/repositories/library/mongo/images: dial tcp: lookup index.docker.io: no such host\n----------------------------------------------------------------------------\n. ",
    "Licanpor": "Hello! i have the a problem with mup on Windws. after running \"mup.cmd setup\" this error is shown:\n:\\Users\\liana\\Documents\\Proyectos\\Bolt\\Flirt\\Flirt.deploy>mup.cmd setup\nStarted TaskList: Setup Docker\n[kiimarketing.mx] - Setup Docker\n[kiimarketing.mx] x Setup Docker: FAILED\n    -----------------------------------STDERR-----------------------------------\n    bash: line 6: docker: command not found\n    bash: line 12: sudo: command not found\n    bash: line 13: sudo: command not found\n    bash: line 14: sudo: command not found\n    bash: line 18: sudo: command not found\n    -----------------------------------STDOUT-----------------------------------\n    ----------------------------------------------------------------------------.\n",
    "BenoitBro": "The example config file in the readme shows an entry for mounting volumes.\nvolumes: { //optional, lets you add docker volumes\n      \"/host/path\": \"/container/path\", //passed as '-v /host/path:/container/path' to the docker run command\n      \"/second/host/path\": \"/second/container/path\"\n    }\nI was hoping to use that, is it not working then?\n. ",
    "Ines-K": "hey @johannchen , how exactly did you stop the previous meteor container? \nI am currently dealing with the same issue. Any input is appreciated!. Hello @Muphet  ,\nI got the same error after running mup restart. Before running it, it had no errors although something was failing with the deployment to the server as my app's content wasn't refreshing and I thought I'd try mup restart. Apart from this app there is nothing running on port 80. \nhow did you solve this? Apart from this app there is nothing running on the port 80. \nthanks!. ",
    "jeffreyflynt": "How did you end up figuring it out? What was your solution?. ",
    "nomadanare": "Hi, I'm having the same issue. Tried with empty settings.json file on clean AWS Ubuntu 16.04. Any help would be wonderful. \nmup deploy --settings=settings.json --verbose\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[13.59.6.xxx] - Pushing Meteor App Bundle to the Server\n[13.59.6.xxx] - Pushing Meteor App Bundle to the Server: SUCCESS\n[13.59.6.xxx] - Prepare Bundle\nnode-8.4.0-base: Pulling from abernix/meteord\nDigest: xxx\nStatus: Image is up to date for abernix/meteord:node-8.4.0-base\nError response from daemon: No such container: upVote\nFinished Extracting\nCreating Dockerfile\nFinished creating Dockerfile\nBuilding image\nSending build context to Docker daemon  281.7MB\nStep 1/6 : FROM abernix/meteord:node-8.4.0-base\nExecuting 1 build trigger\n---> Using cache\n ---> d26c85c673bc\nStep 2/6 : RUN mkdir /built_app\n ---> Using cache\n ---> 4847b64e282c\nStep 3/6 : COPY ./ /built_app\n ---> Using cache\n ---> 32822e93649b\nStep 4/6 : ENV ROOT_URL=xxx\n ---> Using cache\n ---> 9bf0bb556249\nStep 5/6 : ENV MONGO_URL=mongodb://mongodb:27017/upVote\n ---> Using cache\n ---> 6f67f5b0c504\nStep 6/6 : RUN cd  /built_app/programs/server &&     npm install --unsafe-perm\n ---> Running in 7516bd144ec1\n\nfibers@2.0.0 install /built_app/programs/server/node_modules/fibers\nnode build.js || nodejs build.js\n\nlinux-x64-57 exists; testing\nBinary is fine; exiting\n\nmeteor-dev-bundle@0.0.0 install /built_app/programs/server\nnode npm-rebuild.js\nbcrypt@0.8.7 install /built_app/programs/server/npm/node_modules/bcrypt\nnode-gyp rebuild\n\nmake: Entering directory '/built_app/programs/server/npm/node_modules/bcrypt/build'\n  CXX(target) Release/obj.target/bcrypt_lib/src/blowfish.o\n  CXX(target) Release/obj.target/bcrypt_lib/src/bcrypt.o\n  CXX(target) Release/obj.target/bcrypt_lib/src/bcrypt_node.o\n  SOLINK_MODULE(target) Release/obj.target/bcrypt_lib.node\n  COPY Release/bcrypt_lib.node\nmake: Leaving directory '/built_app/programs/server/npm/node_modules/bcrypt/build'\nnpm ERR! Invalid version: \"https://registry.npmjs.org/ansi-regex/-/ansi-regex-3.0.0.tgz\"\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     /root/.npm/_logs/2017-12-31T21_01_22_679Z-debug.log\nnpm ERR! code ELIFECYCLE\nnpm ERR! errno 1\nnpm ERR! meteor-dev-bundle@0.0.0 install: node npm-rebuild.js\nnpm ERR! Exit status 1\nnpm ERR! \nnpm ERR! Failed at the meteor-dev-bundle@0.0.0 install script.\nnpm ERR! This is probably not a problem with npm. There is likely additional logging output above.\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     /root/.npm/_logs/2017-12-31T21_01_22_713Z-debug.log\nThe command '/bin/sh -c cd  /built_app/programs/server &&     npm install --unsafe-perm' returned a non-zero code: 1\nError response from daemon: No such container: upVote\nError: failed to start containers: upVote\n[13.59.6.xxx] x Prepare Bundle: FAILED\n-----------------------------------STDERR-----------------------------------\nError response from daemon: No such container: upVote\nThe command '/bin/sh -c cd  /built_app/programs/server &&     npm install --unsafe-perm' returned a non-zero code: 1\nError response from daemon: No such container: upVote\nError: failed to start containers: upVote\n-----------------------------------STDOUT-----------------------------------\n_MODULE(target) Release/obj.target/bcrypt_lib.node\n  COPY Release/bcrypt_lib.node\nmake: Leaving directory '/built_app/programs/server/npm/node_modules/bcrypt/build'\nnpm ERR! Invalid version: \"https://registry.npmjs.org/ansi-regex/-/ansi-regex-3.0.0.tgz\"\n\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     /root/.npm/_logs/2017-12-31T21_01_22_679Z-debug.log\nnpm ERR! code ELIFECYCLE\nnpm ERR! errno 1\nnpm ERR! meteor-dev-bundle@0.0.0 install: `node npm-rebuild.js`\nnpm ERR! Exit status 1\nnpm ERR! \nnpm ERR! Failed at the meteor-dev-bundle@0.0.0 install script.\nnpm ERR! This is probably not a problem with npm. There is likely additional logging output above.\n\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     /root/.npm/_logs/2017-12-31T21_01_22_713Z-debug.log\n\n----------------------------------------------------------------------------\n\n. ",
    "celloudiallo": "it worked on first deployment.. this error happen on subsequent deployment... run with debug mode i got this error\n[104.215.254.194] - Initializing start script: SUCCESS\n[104.215.254.194] - Invoking deployment process\n[104.215.254.194] x Invoking deployment process: FAILED\n-----------------------------------STDERR-----------------------------------\nError response from daemon: No such container: dipbrew-frontend\ndocker: Error response from daemon: Conflict. The name \"/dipbrew\" is already in use by container 55e9f8a5ed41bb3c8af4a6b9ed52606a013a60c626df8061564176cf17ed9a78. You have to remove (or rename) that container to be able to reuse that name..\nSee 'docker run --help'.\n-----------------------------------STDOUT-----------------------------------\ndipbrew\nbase: Pulling from meteorhacks/meteord\n4d690fa98655: Already exists\na3ed95caeb02: Already exists\n0638f01c6191: Already exists\n086f3bb36259: Already exists\nDigest: sha256:684021facd5847f6a4ee2f0095fd26b4d7f5af2b776150531914d43fd0eb889b\nStatus: Image is up to date for meteorhacks/meteord:base\n----------------------------------------------------------------------------\n. ",
    "cesarve77": "same issue here\n. +1\n. I can solved one time doing:\nmeteor npm install\nmup setup\nmup deploy\nand works\nbut later after for a other version, the same problem appears again.\n. For me has  momentjs:moment. It need's fsevents@1.0.14 packged which throw the error.\n```\n\nfsevents@1.0.14 install /bundle/bundle/programs/server/npm/node_modules/meteor/momentjs_moment/node_modules/fsevents\nnode-pre-gyp install --fallback-to-build\n\nmodule.js:327\n    throw err;\n   ^\nError: Cannot find module '../'\nat Function.Module._resolveFilename (module.js:325:15)\nat Function.Module._load (module.js:276:25)\nat Module.require (module.js:353:17)\nat require (internal/module.js:12:17)\nat Object. (/bundle/bundle/programs/server/npm/node_modules/meteor/momentjs_moment/node_modules/fsevents/node_modules/.bin/node-pre-gyp:15:20)\nat Module._compile (module.js:409:26)\nat Object.Module._extensions..js (module.js:416:10)\nat Module.load (module.js:343:32)\nat Function.Module._load (module.js:300:12)\nat Function.Module.runMain (module.js:441:10)\n```\n. ",
    "rnevius": "This was solved by removing the PORT environment variable, and simply setting the port in the ssl section of the config.\n. ",
    "janjackson": "I am not using ssl right now. What is the solution then?\n. I have the exact same error but triple checked my path, that's not it :( any help greatly appreciated. ",
    "tim-phillips": "@janjackson I had the same issue and realized that mup was timing out too early before my deploy had finished starting up, which I suppose was before the container noted in the error was mounted.\nAbout a minute or two after mup quit, my meteor deployment went live. So mup is simply checking that the deploy happened and then exiting on a timeout. If the deploy hasn't completed then mup will give some random error, presumably something to do with wherever it was when it killed itself. This is confusing though, what if there's a real error? \nSince Meteor is damn slow on startup, try increasing deployCheckWaitTime in mup.js, or just wait a couple minutes after the error message and see if you can access your app. . @NitroBAY let's give @zodern more than 16 hours before we complain about the npm package. ",
    "krishaamer": "How's it going?\n. Also had this problem. Would be great to have clean-up integrated. I know some startups have built special scripts to deal with this in Docker. But I guess the Meteor Way would be for this just to work?\n. This would be awesome!\n. OMG. ",
    "Aur0r": "Since the base image uses node v0.10.43 https://github.com/meteorhacks/meteord/blob/master/base/scripts/lib/install_node.sh this one has to be updated first or an other one has to be created.\nI know as a quick fix just updating would probably work but I wonder if this could be made in such a way that mup has a node version configuration because node 6 support is also on its way.\nAlso I think that the mongodb version has to be adjusted as well so a configuration here would maybe also make sense.\n. ",
    "abernix": "I've posted my solution here https://github.com/meteor/meteor/issues/7475#issuecomment-235229269 which uses abernix/meteord:base as an override dockerImage (configurable in your mup.js.  The image I created upgrades debian to jessie (from wheezy), uses Node 4.4.7 and (for consistency with Meteor itself) uses NPMv3.\nHowever as I mention later, I'd rather not be the official source of this so keep that in mind before you use it.  My branch is here: https://github.com/abernix/meteord/tree/abernix\n. @SachaG (and others) I made a slight change to the image after you posted this, but I don't believe it would have helped your situation.  Still, you might want to try again!  I am successfully using it with mup v2 on one 1.4 project.\nPlease note that currently I don't believe the changes to the kadirahq/meteord or meteorhacks/meteord dockerImage are sufficient for binary dependency rebuilding so you will need to specify in your mup.js, meteor section:\njs\n{\n// ...\n  meteor: {\n// ...other stuff\n    dockerImage: 'abernix/meteord:base',\n// ...other stuff?\n  },\n// ...\n}\nIf you're still having problems, please make me a (bare minimum possible) reproduction of a project that you can't deploy and I'll try it out.  (That being said, I'm going out of town for two weeks starting tomorrow, so no promises on when I can do this!)\n. @gsabran Hmm, I bumped the Node version from 4.4.7 to 4.6.1 this morning in anticipation of Meteor 1.4.2 coming out (And because of the Security Updates in 4.6.0 and 4.6.1.)\nThe tests all ran fine.  Did this just start today or has it worked before?\n. @gsabran What is the version of the Meteor project you're publishing?\n. @gsabran Hmm.  Ok.  It's a pretty strange error and I can't be certain if it has to do with my updates today, but I guess it's safe to assume.  (Although they worked for me and the test apps on CircleCI \ud83d\ude16).\nYour globally installed node/npm on your dev machine shouldn't matter as the outputted app from meteor build (which is ran by mup) should be a Node 4 application.  The image just installs the latest NPM v3 \u2013 whatever that is.  Shouldn't matter if it's paired with Meteor.\nHonestly, I wouldn't have expected this, but I don't have much time to check into it further at the moment.  Just to be safe before I head to bed, I've re-tagged the old images on with the same tags and published the new ones with the -node-4.6.1 extension (they'll be up in just a few minutes).  See all here: https://hub.docker.com/r/abernix/meteord/tags/\nSee if that fixes it for you, but do see if you can figure out the problem with the -node-4.6.1 images if you have a chance!  You'll probably need the -node-4.6.1 tags if you're trying out Meteor 1.4.2 beta (which technically has 4.6.0 right now, but I wouldn't have expected that to be a problem).\nYou can always connect directly to the docker image on a shell and play around.  docker run -i -t --entrypoint=\"/bin/bash\" meteorhacks/meteord:base should work.\nI've opened issues on my repo if you want to make one there.\n. @jamesgibson14 I'm not sure if your error is related at all, but the old builds are back now on the same tags (e.g. base, onbuild, devbuild, binbuild) so if it was working before it should be working again now.\n. @gsabran Thinking about it a bit more, sleepily, 1.4.1.1 uses Node 4.4.7 and Node 4.6.0 was a major binary update because of the OpenSSL libraries being updated.  I'm curious if you have the same experience if you update your project to Meteor 1.4.1.2 and then try again with the abernix/meteord:base-node-4.6.1 image.\n. I'm fairly sure you do not need to run mup setup, only mup deploy (In fact, I'm fairly sure you should NOT run mup setup).  And while Meteor 1.4.1.3 is intended to work with Node 4.6.1, I'm not sure if you will run into any problem using my current :base image which uses Node 4.4.7.  The Node API is definitely compatible, so I'd suggest you try, definitely on a staging server first.\nThat all being said, I did package up a abernix/meteord:base-node-4.6.1 image the other day which you're welcome to try for Meteor 1.4.1.3.\n. @vedovato I'm fairly sure that my image is still working fine for most everyone so I believe this must be something specific to your app.  Do you get an error when you run mup deploy?\n. @PolGuixe Do you have react in your devDependencies or dependencies in your package.json?  It should be noted that Meteor 1.4.2 will strip devDependencies (as you would have probably previously expected :wink:) thanks to https://github.com/meteor/meteor/pull/7668/commits/03e798abc95f4edf4e0eceea7bfe036f73b27080.  This is an intentional change to Meteor.\n. Forgive my unfamiliarity with React components, but shouldn't react-addons-pure-render-mixin be in your list of dependencies?\nAlso, if this isn't the solution this really should probably be discussed elsewhere as, unless I'm mistaken, I don't believe this is related to meteor-up or meteord in any way and this would very likely happen if you did a meteor build and ran that node bundle on your own machine.  This is broadcasting out to dozens and dozens of people who are here for a different reason. :smile:\n. This still isn't the place for this since it's not related to meteor-up, but let's try to handle it in the meteor repo where you've also opened the issue.\nSuggest to close.\n. For what it's worth, since the bug was fixed upstream in Meteor 1.4.2.1 and higher (meteor/meteor#7959), this should be working once again if you're using abernix/meteord:base.. You shouldn't have your mup.js in the root of your application.  As with ANY Meteor .js file in the root of your app, it will be executed on the client and the server.  This is why the server and client directories exist.\nAs stated above, the instructions in the very first section of the README which explains how to use MUP (under \"Creating a Meteor Up Project\") explicitly say to create a .deploy directory.\nAdditionally, the default mup.js (and the one in the README) uses ../ as the location of the app to signify going up a level to find the app.  You must have changed this when you created your app, or not followed those instructions.\nMUP could warn about this, but it can't fix it.  It's really a core concept of Meteor that you should have been aware of.. Agree! Submit a PR!  (Not my project!  Open Source!) \ud83d\ude42 . You need to change the docker image defined in the mup.js for apps using Meteor >= 1.4.  See the Example File in the README which shows the correct use of abernix/meteord:base.\nA search on existing issues before opening this would have brought you to many similar issues which answer this.. I guess I should specify what I tested myself:\n\nI ran the tests from the CONTRIBUTING.md and they ran successfully aside from a mongo failure which happened with or without this pull\nI ran this against my own Meteor 1.4 project using docker: { image: 'abernix/meteord:base' } (old image without imagePort) and it worked successfully\nI ran this against my own Meteor 1.4 project using docker: { image: 'abernix/spaceglue:node-4-builddeps' } (without imagePort) and it failed (as expected, since spaceglue is on port 3000) \nI ran this against my own Meteor 1.4 project using docker: { image: 'abernix/spaceglue:node-4-builddeps', imagePort: 3000 } (with imagePort) and it worked successfully\nThis forum post indicates that it works as well.\n\nI'd love if others could test too!. @giordanocardillo That is not a duplicate; Your PR provides entirely different functionality.  This PR is to change the internal port that the Docker image has exposed, not the published port.. @zodern Conflicts resolved!  Sorry I didn't notice this request earlier!\n(Note: I only did the conflicts in the GitHub GUI and did not test again, so you might want to look carefully!) :wink:. ",
    "andy4545": "when i run \"mup setup\"\ni get :  \"update 1.0.0 => 1.0.1\"\nno setup occurs - I am not sure what to update - i built the npm packkage from the latest git clone.\n. I am getting the same issue.  \"Building App Bundle Locally\" has been running for 2 hours now. \nI am deploying Windows 10, using Meteor 1.4.2 and kadirahq/meteor-up 1.0.4\n$ DEBUG=* mup deploy --settings ../config/development/settings.json\n  mup:module:default exec => mup deploy +0ms\n  mup:module:meteor exec => mup meteor deploy +3ms\n  mup:module:meteor exec => mup meteor push +13ms\nBuilding App Bundle Locally\n. I am getting the same issue - suddenly after installing latest zodern/meteor-up, with latest meteor today.\nmodule.exports = {\n   meteor: {\n       ssl: {\n        crt: '/home/ubuntu/projname/.deploy/mycert.crt', \n        key: '/home/ubuntu/projname/.deploy/mykey.key', \n        port: 443 \n       },\n   }\n}. meteor: {\n    name: 'projname',\n    path: '../app',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      debug: true,\n      serverOnly: true,\n    },\n    env: {\n        ROOT_URL: 'https://projecturl.org',\n        MONGO_URL: 'mongodb://ipaddressofmongoserver/meteordb'\n    },\n    docker: {\n        image: 'abernix/meteord:base',\n    },\n   ssl: {\n        crt: '/home/ubuntu/projname/.deploy/mycert.crt', \n        key: '/home/ubuntu/projname/.deploy/mykey.key', \n        port: 443 \n       },\n   deployCheckWaitTime: 60\n  },. IP] - Verifying Deployment\n[IP] x Verifying Deployment: FAILED\n    -----------------------------------STDERR-----------------------------------\n    bin/node\" \"/usr/bin/npm\" \"install\" \"--unsafe-perm\"\n    npm ERR! node v4.8.0\n    npm ERR! npm  v3.10.10\n    npm ERR! code ELIFECYCLE\n    npm ERR! meteor-dev-bundle@0.0.0 install: `node npm-rebuild.js`\n    npm ERR! Exit status 1\n    npm ERR! \n    npm ERR! Failed at the meteor-dev-bundle@0.0.0 install script 'node npm-rebuild.js'.\n    npm ERR! Make sure you have the latest version of node.js and npm installed.\n    npm ERR! If you do, this is most likely a problem with the meteor-dev-bundle package,\n    npm ERR! not with npm itself.\n    npm ERR! Tell the author that this fails on your system:\n    npm ERR!     node npm-rebuild.js\n    npm ERR! You can get information on how to open an issue for this project with:\n    npm ERR!     npm bugs meteor-dev-bundle\n    npm ERR! Or if that isn't available, you can get their info via:\n    npm ERR!     npm owner ls meteor-dev-bundle\n    npm ERR! There is likely additional logging output above.\n\n    npm ERR! Please include the following file with any support request:\n    npm ERR!     /bundle/bundle/programs/server/npm-debug.log\n    -----------------------------------STDOUT-----------------------------------\n\n    To see more logs type 'mup logs --tail=50'\n\n    ----------------------------------------------------------------------------. I solved this issue by uninstalling bcrypt\n\nmeteor npm uninstall bcrypt --save\nIt should be ok to ignore the warning in your development that asks you to install bcrypt, otherwise  you can save-dev to run it in development mode only. \n\nNote: you are using a pure-JavaScript implementation of bcrypt.\nWhile this implementation will work correctly, it is known to be\napproximately three times slower than the native implementation.\nIn order to use the native implementation instead, run\nmeteor npm install --save bcrypt\n\nRead this issue for ref: #369 . I resolved my version of this issue : \nPrognosis : After adding the ssl > autogenerate > email/domains in  .deploy/mup.js , my applcation deployed and verified correctly, and the server started, but trying to reach the site through a browser got a connection refused error. \nDiagnosis : The docker logs for the application container showed no errors, but the myapp-nginx-letsencrypt container logs showed that one of the domains could not be verified.  I had placed my production and staging domains in the domains list on  ssl > autogenerate > domains. \nResolution: Make sure you only list the domains that are resolvable to the server you are running mup on. . ",
    "vedovato": "i was able to run mup setup after updating to ver 1.0.1.\nNow i'm stuck with deployment process.\n\u279c  .deploy mup deploy\nBuilding App Bundle Locally\nErrors prevented bundling:\nWhile processing files with ecmascript (for target web.browser):\nnative: Unexpected token }\nat Object.parse (native)\nat BabelCompiler.BCp._inferFromPackageJson\n(packages/babel-compiler/babel-compiler.js:165:1)\nat BabelCompiler.BCp.inferExtraBabelOptions\n(packages/babel-compiler/babel-compiler.js:139:1)\nat BabelCompiler.BCp.processOneFileForTarget\n(packages/babel-compiler/babel-compiler.js:81:1)\nat BabelCompiler. (packages/babel-compiler/babel-compiler.js:21:1)\nat Array.forEach (native)\nat BabelCompiler.BCp.processFilesForTarget\n(packages/babel-compiler/babel-compiler.js:20:1)\nWhile processing files with ecmascript (for target os.linux.x86_64):\nnative: Unexpected token }\nat Object.parse (native)\nat BabelCompiler.BCp._inferFromPackageJson\n(packages/babel-compiler/babel-compiler.js:165:1)\nat BabelCompiler.BCp.inferExtraBabelOptions\n(packages/babel-compiler/babel-compiler.js:139:1)\nat BabelCompiler.BCp.processOneFileForTarget\n(packages/babel-compiler/babel-compiler.js:81:1)\nat BabelCompiler. (packages/babel-compiler/babel-compiler.js:21:1)\nat Array.forEach (native)\nat BabelCompiler.BCp.processFilesForTarget\n(packages/babel-compiler/babel-compiler.js:20:1)\n=> Build Error. Check the logs printed above.\ntried to update babel-polyfill to 6.9.1\n. Well @LeG3nDz chances are we gonna need some mod/patch/fix into abernix image. Tried to deploy last friday and just now as we were used to successfully but now even our mup logs isn't returning stuff...\nRunning node 4.4.7 and meteor 1.4.1_3.\nMeteor deploys are always a quest for me lol\n. Yay, thank you @abernix. Gonna try it later and post here again\n. Tried last Friday and yesterday. Both without success on both images said above by abernix\n. At the end i just reset my project based on a past commit then using your regular image i made a deploy to our staging instance and it's all ok. Not sure but seems like it was this meteor patch ... anyway now i'm able to deploy normally again. Thanks for your support, @abernix.\n. now it works\n. Hey @CaptainChemist, lemme ask you: Why do you need to mup init when u already have this mup.js? What if you type mup setup && mup deploy directly?\n. I had successfully deployed my app with bcrypt@0.8.7. Also had to remove some non-compatible node 4.x.x packages.\n. Yo tip to delete the app from /opt/ saved me from wasting more than 2 already wasted weeks! Tks\n. ",
    "mtwalsh": "The changes @abernix mentioned above worked for me also with a 1.4 project.\n. Try changing this:\necho $SSH_KEY > ./ssh_key\nTo this:\necho \"$SSH_KEY\" > ./ssh_key. ",
    "allenfuller": "Wanted to confirm -- and profusely thank -- @abernix for the docker image and terrific posts that made deployments great again.\n. Update: I tried changing the SSH key link to /User/[user]/.ssh/id_rsa per issue #189, but still get \"Unexpected identifier\". \n. LOL. Missing a comma. Happens every time... Never mind!\n. Thanks @aarlaud! -- I'd spent the better part of the afternoon trying to get a command based off of docker run -it --rm --link mongodb:mongo to work, but your docker exec script did the trick.. That worked -- thanks! I had tried mup reconfig thinking that would do it. I might suggest adding that as a step in the docs.\nDuring deployment though, I get the following error when trying to start Meteor:\n```\n    -----------------------------------STDERR-----------------------------------\n    2-nginx-proxy\n    Error response from daemon: endpoint my_app-nginx-proxy not found\n    Finished removing docker containers\n    --2017-08-26 20:48:33--  https://raw.githubusercontent.com/jwilder/nginx-proxy/master/nginx.tmpl\n    Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\n    Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\n    HTTP request sent, awaiting response... 200 OK\n    Length: 10529 (10K) [text/plain]\n    Saving to: \u2018/opt/datrminworker02/config/nginx.tmpl\u2019\n     0K ..........                                            100% 11.9M=0.001s\n\n2017-08-26 20:48:33 (11.9 MB/s) - \u2018/opt/my_app/config/nginx.tmpl\u2019 saved [10529/10529]\n\ndocker: Error response from daemon: driver failed programming external connectivity on endpoint my_app-nginx-proxy (6db6644936c461c8a25b7a70fed51605b51ce4f03a7d089ce2c81ca4a0c50bb4): Bind for 0.0.0.0:443 failed: port is already allocated.\n\n```\nI ended up just deleting the instance and building a new one. That allowed me to deploy successfully.. ",
    "stephane-r": "Hi every body,\nI've try this, but no result for me. My mup.json :\n```\n{\n  // Server authentication info\n  \"servers\": [\n    {\n      \"host\": \"xx.xxx.xxx.xxx\",\n      \"username\": \"root\",\n      \"password\": \"password\",\n      // or pem file (ssh based authentication)\n      // WARNING: Keys protected by a passphrase are not supported\n      //\"pem\": \"~/.ssh/id_rsa\"\n      // Also, for non-standard ssh port use this\n      //\"sshOptions\": { \"port\" : 49154 },\n      // server specific environment variables\n      \"env\": {}\n    }\n  ],\n// Install MongoDB on the server. Does not destroy the local MongoDB on future setups\n  \"setupMongo\": true,\n// Application name (no spaces).\n  \"appName\": \"app-name\",\n// Location of app (local directory). This can reference '~' as the users home directory.\n  // i.e., \"app\": \"~/Meteor/my-app\",\n  // This is the same as the line below.\n  \"app\": \"../app\",\n// Configure environment\n  // ROOT_URL must be set to your correct domain (https or http)\n  \"env\": {\n    \"ROOT_URL\": \"http://xx.xxx.xxx.xxx\",\n    \"METEOR_SETTINGS\": \"$(cat ../app/settings.json )\"\n  },\n// ..\n  \"meteor\": {\n    \"dockerImage\": \"abernix/meteord:base\"\n  },\n// Meteor Up checks if the app comes online just after the deployment.\n  // Before mup checks that, it will wait for the number of seconds configured below.\n  \"deployCheckWaitTime\": 15,\n// show a progress bar while uploading. \n  // Make it false when you deploy using a CI box.\n  \"enableUploadProgressBar\": true\n}\n```\nAnd error after mupx reconfig :\n```\nnpm WARN deprecated semver behavior.\n        npm WARN package.json meteor-dev-bundle@0.0.0 No description\n        npm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\n        npm WARN package.json meteor-dev-bundle@0.0.0 No README data\n        npm WARN cannot run in wd meteor-dev-bundle@0.0.0 node npm-rebuild.js (wd=/bundle/bundle/programs/server)\n        => Starting meteor app on port:80\n    assert.js:93\n      throw new assert.AssertionError({\n            ^\n    AssertionError: \"undefined\" === \"function\"\n        at wrapPathFunction (/bundle/bundle/programs/server/mini-files.js:77:10)\n        at Object.<anonymous> (/bundle/bundle/programs/server/mini-files.js:108:24)\n        at Module._compile (module.js:456:26)\n        at Object.Module._extensions..js (module.js:474:10)\n        at Module.load (module.js:356:32)\n        at Function.Module._load (module.js:312:12)\n        at Module.require (module.js:364:17)\n        at require (module.js:380:17)\n        at Object.<anonymous> (/bundle/bundle/programs/server/boot.js:9:13)\n        at Module._compile (module.js:456:26)\n\n```\n. Hi @abernix,\nI will update my Meteor APP 1.4 to 1.4.1.3. Do you think i need to change my Docker image (image:'abernix/meteord:base') and run new mup setup ? If i run new setup, my mongodb will be reset ? :/\nMaybe i need to upgrade my node version too ?\nnodeVersion: '4.4.7' to nodeVersion: '4.6.1'\nThank you !\n. Thank @abernix, i'll try.\n@vedovato, You can make a feedback when you have tried ? (If I have not done in the meantime) :)\n. Hi,\nI've same problem, i would like change default port 80 by 3000 (for use nginx).\nMy mup.js :\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: 'xx.xxx.xxxx.xxxxxx',\n      username: 'xxxx',\n      // pem:\n      password: 'xxxxx'\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\nnodeVersion: '4.4.7',\nmeteor: {\n    name: 'app',\n    path: '../app',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'http://www.stephane-richin.fr',\n      MONGO_URL: 'mongodb://localhost/meteor',\n      PORT: 3000\n    },\ndockerImage: 'abernix/meteord:base',\ndeployCheckWaitTime: 60\n\n},\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n```\nVerify Deployment failled.\nI've allready start my app with mup dploy, without PORT: 3000, mup reconfig work fine.\n@kyle-rader have you result your problem ?\n. ",
    "trymbill": "Can confirm @abernix's docker image working flawlessly on a 1.4 project. Great success!\n@LeG3nDz Your mup file looks a bit off. Pretty sure env (as an example) is supposed to be within the meteor key as well. I'd suggest you taking another look at the example mup.js file (https://github.com/kadirahq/meteor-up#example-file)\n. ",
    "eric-burel": "Hi, using abernix image and Meteor 1.4.1, I can't update my app anymore. mup deploy works fine, but my app is not uploaed. Has anyone experienced similar issues ?\n. Yep, that was due to a wrong settings.json in my app. However mup deploy was giving success messages while my app was actually crashing, I opened an issue about that #242.\n. Same issue with Meteor 1.4.1. The container must be specified, as the app uses at least two containers (one for Meteor and one for Mongo).\n. It seems to have been solved by last version 1.0.2\n. Same issue, nothing seems to happen when I set up SSL and my app is not available over HTTPS. I have created my certificate and key using the following command sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout ssl.key -out ssl.crt.\n. Actually it does work with Meteor 1.4, I had another issue (see #287), after fixing it I managed to set up SSL on my app.\n. Hi everybody,\nI am trying to write a plugin to enable daily mongo backup on AWS. You can take a look at the code: https://github.com/lbke/vulcan-mongo-backup\nThough its not very general (tied to AWS and Vulcan.js) it could be a starting point if your database is colocated with your app.\nMy current solution consists in running mongodump in a cron job initiated by my app, which means installing mongodump within the Docker container and not directly on the server.\nBut... I can't get it to work. Here is my config, for an Ubuntu server, based on those instructions:\ndocker: {\n      image: \"abernix/meteord:node-8.4.0-base\",\n      // install mongodump to allow programmatic backups\n      buildInstructions:[\n        'RUN'\n        + ' apt-get install -y apt-transport-https libwebsockets-dev libssl-dev openssl libcurl3' // allow to download the key / need for mongo install to work\n        + ' && apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 9DA31620334BD75D9DCB49F368818C72E52529D4' \n        + ' && echo \"deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/4.0 multiverse\" | tee /etc/apt/sources.list.d/mongodb-org-4.0.list'\n        + ' && apt-get update'\n        + ' && apt-get install -y mongodb-org mongodb-org-tools'\n      ]\n    },\nIt fails at finding libssl, which seems necessary for the install to work. But the idea is there.\nHope it can help soemhow and someone manages to add a db backup feature to Meteor Up.. Just to provide more context I tried this nginx.conf: \nserver {\n    listen       80;\n    listen       443 ssl;\n    server_name  awesome-vulcan.com;\n    return       301 https://www.awesome-vulcan.com$request_uri;\n}\nserver {\n    listen       80;\n    listen       443 ssl;\n    server_name  www.awesome-vulcan.com;\n}\nThis fails because the SSL certificate is not associated with my NGINX server (or at least that's how I understand it). So the browser is not happy. If I remove the conf everything works fine, I am just unable to set up the redirection.\nEdit: In case you need a fast solution, you can use this solution: https://blog.wax-o.com/2017/11/meteor-galaxy-redirect-non-www-to-www-with-ssl-and-https/\nHere is the relevant code (thanks to the original author Fabien Huet):\n```js\nWebApp.rawConnectHandlers.use(\n    (req, res, next) => {\n    /**\n     * Redirect non-www to www in production\n     */\n    if (\n        process.env.NODE_ENV != 'development' &&\n        !req.headers.host.includes('www')\n    ) {\n        res.writeHead(\n            301, {\n                'Location': 'https://www.mydomain.com' + req.originalUrl,\n            }\n        );\n        return res.end();\n    }\n\n    /**\n     * Keep going\n     * /!\\ DO NOT DELETE /!\\\n     */\n    return next();\n\n}\n\n);\n``\nTheoritically it could be slower than NGINX based solution though, since you need to process every request to check the URL and it relies on JS.\n. At the DNS level it is usually not a real redirection, only a CNAME/ALIAS. It may lead to issues with CORS because you are not really redirected. Some DNS providers seem to propose redirection but that's not DNS per se I think. So indeed the best solution is a server such as Nginx that will actually redirect you, I hope we'll manage to figure this out. Hi, the commandgit rev-parse HEADis not very robust, it does not find a.gitfolder on my machine when executed\nTagging @SachaG. It's weird. If you add adomainsprop to your config outside ofproxy, it will work (except that validation of the config will show an error, sincedomainsmust be inproxy). So somehowapi.getConfig().proxy` seems wrong.. Hi,\nIn my first understanding the Let's Encrypt email had to be linked to some preexisting Let's Encrypt account, which was wrong. So it's not totally arbitrary, as it should be an existing address indeed.\nI did not reproduce the bug though after using mup a few more times, everything works fine now.. ",
    "aido179": "Just deployed a new app with Meteor 1.4 and latest mup. using @abernix's docker image got it working for me.\nMup is throwing a Verifying Deployment:FAILED with a curl: (56) recv failure: connection reset by peer\" message, but the deployment still seems to work. \n. For me, @abernix''s image was necessary.\nOn Fri, 26 Aug, 2016 at 9:31, Sacha Greifnotifications@github.com wrote:\nIs using @abernix's image still needed? Otherwise maybe the 1.4-related threads could be closed?\n. ",
    "torayeff": "\"meteor\": {\n    \"dockerImage\": \"abernix/meteord:base\"\n  },\nstill required\n. ",
    "discdiver": "abernix's docker image was still needed for me as of 9/21/16. Thank you abernix!\n\"meteor\": {\n    \"dockerImage\": \"abernix/meteord:base\"\n  },\n. upgraded mup to 1.04 on mac os sierra. \nThen got \n\nError: Cannot find module 'ssh2'\n\nwhen tried to run mup deploy.\n\nnpm install -g ssh2\n\nfixed the issue.\n. ",
    "KyrosDigital": "Wanted to confirm @abernix solution. \nMeteor 1.4.1.2, node 4.6.0 \nMupx deploy failed, was getting this error \n`        -----------------------------------STDERR-----------------------------------\n        package.json meteor-dev-bundle@0.0.0 No description\n        npm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\n        npm WARN package.json meteor-dev-bundle@0.0.0 No README data\n        npm WARN cannot run in wd meteor-dev-bundle@0.0.0 node npm-rebuild.js (wd=/bundle/bundle/programs/server)\n        => Starting meteor app on port:80\n```\n    assert.js:93\n      throw new assert.AssertionError({\n            ^\n    AssertionError: \"undefined\" === \"function\"\n        at wrapPathFunction (/bundle/bundle/programs/server/mini-files.js:77:10)\n        at Object. (/bundle/bundle/programs/server/mini-files.js:108:24)\n        at Module._compile (module.js:456:26)\n        at Object.Module._extensions..js (module.js:474:10)\n        at Module.load (module.js:356:32)\n        at Function.Module._load (module.js:312:12)\n        at Module.require (module.js:364:17)\n        at require (module.js:380:17)\n        at Object. (/bundle/bundle/programs/server/boot.js:9:13)\n        at Module._compile (module.js:456:26)\n=> Redeploying previous version of the app\n\n-----------------------------------STDOUT-----------------------------------\n\nTo see more logs type 'mup logs --tail=50'\n\n----------------------------------------------------------------------------`\n\n```\nI changed the start.sh file by replacing \"meteorhacks/meteord:base\" with \"abernix/meteord:base\" in 3 instances in the start.sh file.\nAfter a mupx setup the deploy worked! \nI tired uninstalling node, mupx, meteor, everything. \nThis seems to be the only fix I can find after hours and hours of attempts. \nCheers, thanks community. \n. @zodern you nailed it! Thanks! . ",
    "jamesgibson14": "I am having a weird problem, it starts, and compiles and then says \"pushing the startup script: SUCCESS\"... and then it dies with no error and no docker image is on the server Here is the output \n` mup:module:default exec => mup deploy +0ms\n mup:module:meteor exec => mup meteor deploy +1ms\n mup:module:meteor exec => mup meteor push +3ms\nuilding App Bundle Locally\nurrently, it is only possible to build iOS apps on an OS X system.\ntarted TaskList: Pushing Meteor\n104.236.163.55] - Pushing Meteor App Bundle to The Server\n nodemiral:sess: copy file - src: /tmp/85a4f6d2-4f19-4dd8-93e2-9e53bfa6b446/bundle.tar.gz, dest: /opt/\nor/tmp/bundle.tar.gz, vars: undefined +0ms\n104.236.163.55] - Pushing Meteor App Bundle to The Server: SUCCESS\n104.236.163.55] - Pushing the Startup Script\n nodemiral:sess:104.236.163.55 copy file - src: /usr/lib/node_modules/mup/lib/modules/meteor/assets/templates/start.\ndest: /opt/meteor/config/start.sh, vars: {\"appName\":\"meteor\",\"useLocalMongo\":0,\"port\":80,\"sslConfig\":{\"port\":443,\"cr\nbundle.pem\",\"key\":\"private\"},\"logConfig\":{\"opts\":{\"max-size\":\"100m\",\"max-file\":10}},\"docker\":{\"dockerImage\":\"abernix\neord:base\",\"imageFrontendServer\":\"meteorhacks/mup-frontend-server\"}} +8s\n104.236.163.55] - Pushing the Startup Script: SUCCESS\n mup:module:meteor exec => mup meteor envconfig +1m`\n. @abernix, okay I will play around some more, it is the first time I am using mup2 normally I use mupx. Thanks for taking the time to build the image and respond online to questions.\n. Same problem and same solution, I had a blank settings.json file... I had to throw in a {}\n. 1+\n. #313 \n. ",
    "PolGuixe": "I just updated to 1.4.2 and I am getting this error:\nError: Can't find npm module 'react/lib/ReactComponentWithPureRenderMixin'. Did you forget to call 'Npm.depends' in package.js within the 'modules-runtime' package?\n        at Object.require (/bundle/bundle/programs/server/boot.js:200:17)\n        at options.fallback (packages/modules-runtime.js:445:18)\n        at require (packages/modules-runtime.js:112:16)\n        at meteorInstall.node_modules.react-addons-pure-render-mixin.index.js (packages/modules.js:17838:18)\n        at fileEvaluate (packages/modules-runtime.js:181:9)\n        at Module.require (packages/modules-runtime.js:106:16)\n        at Module.Mp.import (/bundle/bundle/programs/server/npm/node_modules/meteor/modules/node_modules/reify/lib/runtime.js:70:16)\n        at meteorInstall.node_modules.meteor.react-meteor-data.createContainer.jsx (/bundle/bundle/programs/server/packages/react-meteor-data.js:234:256)\n        at fileEvaluate (packages/modules-runtime.js:181:9)\n        at require (packages/modules-runtime.js:106:16)\n. @gsabran yes.\n. @gsabran the file exists.\n. I have rolled back to 1.4.1.2 and it works. Does anyone has problems with 1.4.2?\n. @abernix I have it in my dependencies. Below is how I have it: \njson\n\"dependencies\": {\n    \"bcrypt\": \"^0.8.7\",\n    \"faker\": \"^3.1.0\",\n    \"install\": \"^0.8.1\",\n    \"lodash\": \"^4.13.1\",\n    \"mantra-core\": \"^1.7.0\",\n    \"material-ui\": \"^0.16.1\",\n    \"moment\": \"^2.15.1\",\n    \"money-math\": \"^2.4.3\",\n    \"npm\": \"^3.10.6\",\n    \"react\": \"^15.3.2\",\n    \"react-dimensions\": \"^1.3.0\",\n    \"react-dom\": \"^15.3.x\",\n    \"react-helmet\": \"^3.1.0\",\n    \"react-komposer\": \"^1.13.1\",\n    \"react-komposer-plus\": \"^2.2.3\",\n    \"react-mounter\": \"^1.0.0\",\n    \"react-redux\": \"^4.4.5\",\n    \"react-simple-di\": \"^1.0.1\",\n    \"react-tap-event-plugin\": \"^1.0.0\",\n    \"redux\": \"^3.5.2\",\n    \"redux-form\": \"^6.0.1\",\n    \"redux-form-material-ui\": \"^4.0.1\"\n  },\n  \"devDependencies\": {\n    \"babel-core\": \"6.x.x\",\n    \"babel-plugin-react-require\": \"2.x.x\",\n    \"babel-polyfill\": \"6.x.x\",\n    \"babel-preset-es2015\": \"^6.9.0\",\n    \"babel-preset-react\": \"6.x.x\",\n    \"babel-preset-stage-2\": \"6.x.x\",\n    \"babel-register\": \"^6.9.0\",\n    \"babel-root-slash-import\": \"1.x.x\",\n    \"chai\": \"3.x.x\",\n    \"enzyme\": \"^2.2.0\",\n    \"eslint\": \"2.7.x\",\n    \"eslint-plugin-react\": \"4.3.x\",\n    \"jsdom\": \"^8.0.4\",\n    \"mocha\": \"2.x.x\",\n    \"react-addons-test-utils\": \"15.3.x\",\n    \"sinon\": \"1.17.x\",\n    \"@kadira/storybook\": \"^2.5.2\"\n  }\n. @zodern I don't remember how I did it. The app is runing. I guess it can be closed. . As @abernix suggested the error also occurs when when I do meteor build and I run the bundle in my machine. \n. As suggested by @abernix I am closing this issue here. Issue raised at meteor's repo: https://github.com/meteor/meteor/issues/7984\n. @doronsever it worked for me.\nI bit of a pain having to change node versions continuously\n. Any solution on this?\n. Right now I deleted docker completely from the server and reinstalled, as it was the only solution I've found to work so far. If I run those commands right now I get: \nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nabernix/meteord     base                366b38760b1e        5 weeks ago         504 MB\nand\nCONTAINER ID        IMAGE                  COMMAND                  CREATED             STATUS              PORTS                NAMES               SIZE\n3ec87cdff78b        abernix/meteord:base   \"/bin/sh -c 'bash ...\"   44 minutes ago      Up 40 minutes       0.0.0.0:80->80/tcp   LaJunglaTesting     9.3 MB (virtual 513 MB). I did run the command df -h prior to remove docker everything seemed normal except for: \n/dev/xvda1      7.8G  7.7G  60M  100% /. In my case it was also /var/lib/docker/aufs/, that was taken all the space and I just had one image.. @zodern I have also experienced the same. Any idea why this is happening? \nIs this redirect normal? . Also the SSL certificate is the one from Cloudflare and not the one from Let's Encrypt. Is there a way to ensure that the Let's Encrypt certificate is working?\n. @zodern thanks for your reply. \n\nIn the cloudflare support, there is two articles on fixing this for Wordpress and Joomla. They seem to say it is from having mixed content.\n\nCould it be due to the nginx configuration?. I know that I can modify abernix's image https://hub.docker.com/r/meteorhacks/meteord/\nOnce it's modified do I need to push that image the docker hub?. According to this: http://stackoverflow.com/questions/31901697/meteor-up-docker-and-graphicsmagick\nI need to modify the DockerFile in the image, but which DockerFile \ud83e\udd14 \n-base/DockerFile\n-binbuild/DockerFile\n-devbuild/DockerFile\n-onbuild/DockerFile\nall of them?. I've just found this image that it is doing exactly what I wanted: https://github.com/c316/meteor-graphicsmagick. @shadowcodex cool! thanks. \n@zodern will you publish the next version soon?\n. @shadowcodex what do you exactly mean? \nThis is my configuration: \n- Server 1 with IP XX.XX.XX.XX host the production app. DNS points example.com and www.example.com to XX.XX.XX.XX. Server 1 also hosts the SSL certificates for example.com and for www.example.com.\n- Server 2 with IP YY.YY.YY.YY host the staging app. DNS points staging.example.com to YY.YY.YY.YY.\n. @shadowcodex yes, if I ping the host name it replies with YY.YY.YY.YY, when it is not routed through Cloudflare. \nThis is how my configuration looks like \ud83d\ude09.\nIn the ssl, configuration, if I am missing example.com, from the domain field I am getting a base domain missing error.\nDoes this configuration works for you? . I see now. I misunderstood how volumes work. I thought the volumes where inside the container. \ud83d\ude13 . @tomtom87 this was using a t2.micro.\n@zodern I am investigating the logs. ;) . Do you think the problem is with memory? or disk space?. These are the logs I am getting: \n```\n=> Starting meteor app on port:80\n/bundle/bundle/programs/server/node_modules/fibers/future.js:278\n                        throw(ex);\n                              ^\n[object Object]\n    at Object.Future.wait (/bundle/bundle/programs/server/node_modules/fibers/future.js:398:15)\n    at new MongoConnection (packages/mongo/mongo_driver.js:213:1)\n    at new MongoInternals.RemoteCollectionDriver (packages/mongo/remote_collection_driver.js:4:1)\n    at Object. (packages/mongo/remote_collection_driver.js:38:1)\n    at Object.defaultRemoteCollectionDriver (packages/underscore/underscore.js:750:1)\n    at new Mongo.Collection (packages/mongo/collection.js:102:1)\n    at AccountsServer.AccountsCommon (accounts_common.js:23:18)\n    at new AccountsServer (accounts_server.js:16:5)\n    at Package (globals_server.js:5:12)\n    at /bundle/bundle/programs/server/packages/accounts-base.js:1814:4\nnpm WARN deprecated This version of npm lacks support for important features,\nnpm WARN deprecated such as scoped packages, offered by the primary npm\nnpm WARN deprecated registry. Consider upgrading to at least npm@2, if not the\nnpm WARN deprecated latest stable version. To upgrade to npm@2, run:\nnpm WARN deprecated\nnpm WARN deprecated   npm -g install npm@latest-2\nnpm WARN deprecated\nnpm WARN deprecated To upgrade to the latest stable version, run:\nnpm WARN deprecated\nnpm WARN deprecated   npm -g install npm@latest\nnpm WARN deprecated\nnpm WARN deprecated (Depending on how Node.js was installed on your system, you\nnpm WARN deprecated may need to prefix the preceding commands with sudo, or if\nnpm WARN deprecated on Windows, run them from an Administrator prompt.)\nnpm WARN deprecated\nnpm WARN deprecated If you're running the version of npm bundled with\nnpm WARN deprecated Node.js 0.10 LTS, be aware that the next version of 0.10 LTS\nnpm WARN deprecated will be bundled with a version of npm@2, which has some small\nnpm WARN deprecated backwards-incompatible changes made to npm run-script and\nnpm WARN deprecated semver behavior.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No description\nnpm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No README data\n=> Starting meteor app on port:80\n/bundle/bundle/programs/server/node_modules/fibers/future.js:278\n                        throw(ex);\n                              ^\n[object Object]\n    at Object.Future.wait (/bundle/bundle/programs/server/node_modules/fibers/future.js:398:15)\n    at new MongoConnection (packages/mongo/mongo_driver.js:213:1)\n    at new MongoInternals.RemoteCollectionDriver (packages/mongo/remote_collection_driver.js:4:1)\n    at Object. (packages/mongo/remote_collection_driver.js:38:1)\n    at Object.defaultRemoteCollectionDriver (packages/underscore/underscore.js:750:1)\n    at new Mongo.Collection (packages/mongo/collection.js:102:1)\n    at AccountsServer.AccountsCommon (accounts_common.js:23:18)\n    at new AccountsServer (accounts_server.js:16:5)\n    at Package (globals_server.js:5:12)\n    at /bundle/bundle/programs/server/packages/accounts-base.js:1814:4\nnpm WARN deprecated This version of npm lacks support for important features,\nnpm WARN deprecated such as scoped packages, offered by the primary npm\nnpm WARN deprecated registry. Consider upgrading to at least npm@2, if not the\nnpm WARN deprecated latest stable version. To upgrade to npm@2, run:\nnpm WARN deprecated\nnpm WARN deprecated   npm -g install npm@latest-2\nnpm WARN deprecated\nnpm WARN deprecated To upgrade to the latest stable version, run:\nnpm WARN deprecated\nnpm WARN deprecated   npm -g install npm@latest\nnpm WARN deprecated\nnpm WARN deprecated (Depending on how Node.js was installed on your system, you\nnpm WARN deprecated may need to prefix the preceding commands with sudo, or if\nnpm WARN deprecated on Windows, run them from an Administrator prompt.)\nnpm WARN deprecated\nnpm WARN deprecated If you're running the version of npm bundled with\nnpm WARN deprecated Node.js 0.10 LTS, be aware that the next version of 0.10 LTS\nnpm WARN deprecated will be bundled with a version of npm@2, which has some small\nnpm WARN deprecated backwards-incompatible changes made to npm run-script and\nnpm WARN deprecated semver behavior.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No description\nnpm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No README data\n=> Starting meteor app on port:80\n```\nIt's strange because it used to work without problems. ",
    "massimosgrelli": "With linux dev station it works perfectly. Moving to Mac (Sierra) I keep having this problem. Same version of Node and npm on both stations.\nIt looks similar to the one @SachaG had.. After hours of work I don't know what else I can try. This is the error I got:\n`` \n       x Verifying deployment: FAILED\n    -----------------------------------STDERR-----------------------------------\n    rm\"\n    npm ERR! node v4.6.2\n    npm ERR! npm  v3.10.10\n    npm ERR! code ELIFECYCLE\n    npm ERR! meteor-dev-bundle@0.0.0 install:node npm-rebuild.js`\n    npm ERR! Exit status 1\n    npm ERR! \n    npm ERR! Failed at the meteor-dev-bundle@0.0.0 install script 'node npm-rebuild.js'.\n    npm ERR! Make sure you have the latest version of node.js and npm installed.\n    npm ERR! If you do, this is most likely a problem with the meteor-dev-bundle package,\n    npm ERR! not with npm itself.\n    npm ERR! Tell the author that this fails on your system:\n    npm ERR!     node npm-rebuild.js\n    npm ERR! You can get information on how to open an issue for this project with:\n    npm ERR!     npm bugs meteor-dev-bundle\n    npm ERR! Or if that isn't available, you can get their info via:\n    npm ERR!     npm owner ls meteor-dev-bundle\n    npm ERR! There is likely additional logging output above.\nnpm ERR! Please include the following file with any support request:\nnpm ERR!     /bundle/bundle/programs/server/npm-debug.log\n\n=> Redeploying previous version of the app\n\n-----------------------------------STDOUT-----------------------------------\n\nTo see more logs type 'mup logs --tail=50'\n\n----------------------------------------------------------------------------\n\n```\nAny ideas?\nThanks,\nMax\nEDITED\nAfter another 2 hours it seems like this problem arises in a specific case: when I clone the repo of my app (developed under linux) and I make it run on a Mac, the following massage show up:\nW20161208-19:13:42.365(1)? (STDERR) Note: you are using a pure-JavaScript implementation of bcrypt.\nW20161208-19:13:43.040(1)? (STDERR) While this implementation will work correctly, it is known to be\nW20161208-19:13:43.040(1)? (STDERR) approximately three times slower than the native implementation.\nW20161208-19:13:43.041(1)? (STDERR) In order to use the native implementation instead, run\nW20161208-19:13:43.041(1)? (STDERR) \nW20161208-19:13:43.042(1)? (STDERR)   meteor npm install --save bcrypt\nW20161208-19:13:43.043(1)? (STDERR) \nW20161208-19:13:43.043(1)? (STDERR) in the root directory of your application.\nIf I run meteor npm install --save bcrypt and then deploy the app, I get the failure above. But if I avoid running this suggested command, then mupx deploy goes right.. Updated node locally on my dev environment to version 8.9.3.\nThen I updated the docker image to abernix 8.9.3 base. Now the bundle is created, but I have another problem during the verification phase \" 0curl: (7) Failed to connect to localhost port 80: Connection refused\". I will open a different issue for this case.\n. Here you are:\n```\n  mup:updates checking for updates +0ms\n  mup:module:default exec => mup deploy +0ms\n  mup:module:meteor exec => mup meteor deploy +0ms\n  mup:module:meteor exec => mup meteor push +2ms\nBuilding App Bundle Locally\n  mup:module:meteor Build Path: /Users/max/src/studio +0ms\n  mup:module:meteor Build Command:  meteor build --directory /var/folders/x1/5v7tl5zs6f1cg9dp1krwj7gc0000gn/T/mup-meteor-564e9709-8208-41e3-a08d-b5781dfecde4 --architecture os.linux.x86_64 --server-only +1ms\nNode#moveTo was deprecated. Use Container#append.\n  mup:module:meteor starting archive +45s\n  mup:module:meteor archive finished +7s\nStarted TaskList: Pushing Meteor App\n[159.89.100.61] - Pushing Meteor App Bundle to the Server\n[159.89.100.61] - Pushing Meteor App Bundle to the Server: SUCCESS\n[159.89.100.61] - Prepare Bundle\n[159.89.100.61] - Prepare Bundle: SUCCESS\n  mup:module:meteor exec => mup meteor envconfig +2m\nStarted TaskList: Configuring App\n[159.89.100.61] - Pushing the Startup Script\n[159.89.100.61] - Pushing the Startup Script: SUCCESS\n[159.89.100.61] - Sending Environment Variables\n[159.89.100.61] - Sending Environment Variables: SUCCESS\n  mup:module:meteor exec => mup meteor start +2s\nStarted TaskList: Start Meteor\n[159.89.100.61] - Start Meteor\n[159.89.100.61] - Start Meteor: SUCCESS\n[159.89.100.61] - Verifying Deployment\n[159.89.100.61] - Verifying Deployment: SUCCESS\n``. I followed your suggestions and meteor up sites (same steps) usingletsencryptmail'. My mup.js file looks like:\nproxy: {\n     domains: 'test.mydomain.com',\n     ssl: {\n       // Enable let's encrypt to create free certificates.\n       // The email is used by Let's Encrypt to notify you when the\n       // certificates are close to expiring.\n       letsEncryptEmail: 'email@mydomain-another-one.com',\n       forceSSL: true,\n     }\n   },\nI ran:\nmup stop\nmup setup\nthen I have got an error with endpoint mup-nginx-proxy not found:\n````\n[159.89.151.80] x Start proxy: FAILED\n      ------------------------------------STDERR------------------------------------\n      Error response from daemon: endpoint mup-nginx-proxy not found\nError: No such container: mup-nginx-proxy-letsencrypt\nError response from daemon: endpoint mup-nginx-proxy-nginx-proxy not found\ndocker: Error response from daemon: driver failed programming external connectivity on endpoint mup-nginx-proxy (8ffdf3b522afad18d9fa1f956483c7bd8014daa4e83752da89d160177290c25b): Error starting userland proxy: listen tcp 0.0.0.0:80: bind: address already in use.\n\n      ------------------------------------STDOUT------------------------------------\n      mup-nginx-proxy\nRemoved mup-nginx-proxy\nRemoved mup-nginx-proxy-letsencrypt\nlatest: Pulling from jrcs/letsencrypt-nginx-proxy-companion\nDigest: sha256:ad243eef0b5e63514e18a69fadbf40fcfa94dcbd214599af6b858c7f707029c5\nStatus: Image is up to date for jrcs/letsencrypt-nginx-proxy-companion:latest\nUsing default tag: latest\nlatest: Pulling from jwilder/nginx-proxy\nDigest: sha256:5145492f8a974d777e7ca6ee01032c476033388495f56eea06ab770e1d1e5c62\nStatus: Image is up to date for jwilder/nginx-proxy:latest\nPulled jwilder/nginx-proxy and jrcs/letsencrypt-nginx-proxy-companion\nda27ff4b93075ff67522c60d65475672cdd005c2544a349ce9f55add413f331e\n\n      ------------------------------------------------------------------------------\n\n````\nEDITED: My complete mup.js file is:\n{\n  \"servers\": {\n    \"one\": {\n      \"host\": \"1.2.3.4\",\n      \"username\": \"root\",\n      \"password\": \"password\"\n    }\n  },\n  \"app\": {\n    \"name\": \"my-app\",\n    \"path\": \"../.\",\n    \"servers\": {\n      \"one\": {}\n    },\n    \"buildOptions\": {\n      \"serverOnly\": true\n    },\n    \"env\": {\n      \"ROOT_URL\": \"https://subdomain.subdomain.host.com\",\n      \"MONGO_URL\": \"mongodb://mongodb:27017/my-app\",\n      \"PORT\": 32772,\n      \"VIRTUAL_HOST\": \"test.12parseclab.com\",\n      \"HTTPS_METHOD\": \"redirect\",\n      \"HTTP_FORWARDED_COUNT\": 1,\n      \"LETSENCRYPT_HOST\": \"test.12parseclab.com\",\n      \"LETSENCRYPT_EMAIL\": \"team@12parseclab.it\"\n    },\n    \"docker\": {\n      \"image\": \"abernix/meteord:node-8.9.3-base\",\n      \"args\": [\n        \"--link=mongodb:mongodb\"\n      ]\n    },\n    \"enableUploadProgressBar\": true,\n    \"deployCheckWaitTime\": 120,\n    \"type\": \"meteor\"\n  },\n  \"mongo\": {\n    \"port\": 27017,\n    \"version\": \"3.4.1\",\n    \"servers\": {\n      \"one\": {}\n    }\n  },\n  \"proxy\": {\n    \"domains\": \"test.12parseclab.com\",\n    \"ssl\": {\n      \"letsEncryptEmail\": \"team@12parseclab.it\",\n      \"forceSSL\": true\n    }\n  }\n}\nAny suggestions?. ",
    "RenSilvaAU": "And guess what?\nAs soon as I removed bcrypt from my mac, I was able to deploy the app via mupx deploy.\n. ",
    "doronsever": "I can confirm that after removing bcrypt the deployment goes smoothly.\nIs there a way bcrypt can still be installed locally?. @guillim I've change my mup.js to use your docker but when i deploy it i get\n\nError response from daemon: No such container: anatwaterworks\n    Error response from daemon: No such container: anatwaterworks-frontend\n    Tag latest not found in repository docker.io/guillim/meteord\n    Unable to find image 'guillim/meteord:latest' locally\n    Pulling repository docker.io/guillim/meteord\n    docker: Tag latest not found in repository docker.io/guillim/meteord.\n    See 'docker run --help'.\n    -----------------------------------STDOUT-----------------------------------\n    Using default tag: latest\n    Pulling repository docker.io/guillim/meteord\n\nAm i missing something?. Do i need to kill previous docker containers?\nWhen i try to deploy i get errors.\nDo i need to install Node 6.9.1 on my computer also in order for this to work?. I had the same or similar issue, also with node gyp and bcrypt.\nIf you are using abernix/meteord:base, you need that your node version that is installed on your computer is the same as abernix/meteord:base.\nI had node 5.12.0 on my computer and when i moved to node 4.7.0, which abernix/meteord:base uses, everything started to work again. . I'm trying to enable docker's volumes...\nBut for now with out any success...\nhelp to configure it out will be much appreciated. 10x for the update. I did succeed to create a volume like your suggestion, but the next problem was that Meteor it self does not support public files to be added on the fly this way... So i had to move to a 3rd party solution.. ",
    "tyvdh": "Anyone actively working on this? Seems like such a basic essential feature. Downtime especially for realtime apps or APIs is just such a no can do.. @rwatts3 This worked great for the load balancing / zero downtime but it has completely borked the Websockets.\n\nAny ideas?. @rwatts3 Yes I did and passing DISABLE_WEBSOCKETS: 1 will fix the problem but I want to use websockets. When I run my own single port with my custom .conf file the wss address works fine. Seems to be some issue with mechanic's .conf files. For reference this is the conf file I use for the single port reverse proxy.\n```conf\nserver {\n  listen 443;\n  server_name www.foo.com foo.com;\nssl_certificate           /opt/foo/config/bundle.crt;\n  ssl_certificate_key    /opt/foo/config/private.key;\nssl on;\n  ssl_session_cache  builtin:1000  shared:SSL:10m;\n  ssl_protocols  TLSv1 TLSv1.1 TLSv1.2;\n  ssl_ciphers HIGH:!aNULL:!eNULL:!EXPORT:!CAMELLIA:!DES:!MD5:!PSK:!RC4;\n  ssl_prefer_server_ciphers on;\naccess_log         /var/log/nginx/app.dev.access.log;\n  error_log             /var/log/nginx/app.dev.error.log;\nlocation / {\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"upgrade\";\nproxy_set_header X-Real-IP $remote_addr;\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\nproxy_set_header X-Forwarded-Proto $scheme;\nproxy_set_header Host $http_host;\nproxy_set_header X-NginX-Proxy true;\n\nproxy_pass http://localhost:3000/;\nproxy_redirect off;\n\n}\n}\n```\nMy guess is the proxy settings and ssl settings that mechanic doesn't have set up to handle wss addresses.. Hmm.. actually.. it would appear once both port sites are up even with DISABLE_WEBSOCKETS: 1 the site still errors out. :/. Have you tried this setup with SSLs and Websockets? Note I'm using CloudFlare.. @rwatts3 Would you be able to share your custom conf file for reference? I'm curious what your settings are to get all this to work. I'm not very familiar with nginx conf and reverse proxies.. Got it! \nFor everyone else, here's a gist of my custom conf template.\nhttps://gist.github.com/tyvdh/e360a2e67a4c207af551ded2e635947e. For those who care: https://medium.com/@tyvdh/deploying-production-meteor-in-2017-f2983277e872. Yeah all good. . Nope. 100 lines vs 50 lines. Though today it seems to be working.. /shrug\n. I'm facing this issue as well. \nNode v7.10.0. ",
    "lmachens": "@rwatts3 I deleted my message because the behaivour is different for mup deploy. My example was for mup restart (where all servers stopped first). So it seems to be fine.. Thx, but I have an extern mongo server. \nIt looks like it has something to do with Windows. \nIt works fine if I run mup on Ubuntu.\n. Same problem here. Sometimes http is not redirected to https.\nI think it has something to do with the new mup version and proxy changes.. ",
    "scarbies": "I have multiple \"app servers\" (Linodes) that I deploy too and then use CloudFlare to update DNS and failover between them. I host my DBs with mLab/Compose. Not HA but investigating CF's Load Balancing feature. Really simple to understand too. Check out: https://docs.cloudfoundry.org/devguide/deploy-apps/blue-green.html. I also had an issue with my settings file (invalid JSON).  Fixing that solved my deploy issues.. Sorry for delay... Better?. ",
    "noahsw": "I ssh'd into my Vagrant box and ran the docker commands manually. Everything ran just fine and it only took a minute or two. I then tried running mup setup again and it correctly skipped over the Docker setup because it was already installed.\n. It turns out it's not hanging... it's just taking 60 minutes for the setup process, most of which is spent installing docker. It'd be great if there was better feedback.\n. That worked! Thanks @codeHatcher !. ",
    "CaptainChemist": "That fixed the silently failing issue, thanks!\n. I am not really clear where you are getting this issue. Does npm install -g mup work without any errors?\n. So you should type \"mup setup\" after \"mup init\". Does that work? If it doesn't, can you copy your mup.js here and we can take a look.\n. I had this issue yesterday, I think. Provide the full path to the pem key- it doesn't work with relative paths.\n. do you need that ssl: {} block? Maybe try removing the mongo : {} block too.\n. I installed mup using:\nnpm install -g mup\nThen I did\nmup init\nConfigured the mup.js file then:\n```\nmup setup\nmup deploy\n```\n. I am on a Mac but I don't think it is an os thing, it is likely a\nconfiguration issue for you. You need to be more specific with the error\nyou get, \"prevents\" is not enough info.\nOn Thu, Aug 4, 2016 at 8:54 AM Timofey Butnyakob notifications@github.com\nwrote:\n\n@CaptainChemist https://github.com/CaptainChemist I did the same. But\nmy OS prevents all my tries to mup setup.\nWhat kind of OS you use?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/187#issuecomment-237559543,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AA_rOSF4uTBG3Hfk6COZjd12NpWTlerOks5qce71gaJpZM4JcroI\n.\n. Okay, that clearly seems like a different issue, we should focus on answering your question in the issue you opened. \n. It seems like dockerImage doesn't seem to be doing anything, if I remove that line, it still tries to set it up using docker. That's weird right?\nUPDATE: I tried hard-coding the docker images with abernix/meteord:base or kadirahq/meteord and that didn't seem to be the issue.\n. Thanks for the response, I still get this error even when I run mup init \n\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '138.68.27.1',\n      username: 'root',\n      pem: '/Users/user/.ssh/digitalocean'\n    }\n  },\nmeteor: {\n    name: 'Meteor',\n    path: '/Users/user/development/react-meteor',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'http://138.68.27.1',\n      MONGO_URL: 'mongodb://user:pass@.mlab.com:39685/production'\n    },\ndockerImage: 'kadirahq/meteord',\ndeployCheckWaitTime: 60\n\n},\n};\n``\n. mup init will create a blank version of this document which I then filled in. mup setup works great but mup deploy gives me the stack size exceeded error.\n. I didn't end up solving this problem with mup. I used a newer mupx that had the docker container updated. I know that it isn't the ideal solution but I still cannot get this new version of mup to work today. I canmup setupwith no issues. When Imup deploy` I initially get the error:\nAssertionError: \"undefined\" === \"function\"\nWhen I type mup logs I get the following error:\n```\n[104.131.9.10]\"docker logs\" requires exactly 1 argument(s).\nSee 'docker logs --help'.\nUsage:  docker logs [OPTIONS] CONTAINER\nFetch the logs of a container\n```\nThis is my js file:\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '104.131.9.10',\n      username: 'root',\n      pem: '/Users/user/.ssh/digitalocean'\n    }\n  },\nmeteor: {\n    name: 'meteor',\n    path: '/users/user/development/project',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: '104.131.9.10',\n      MONGO_URL: 'mongodb://user@pass@bla.mlab.com:39685/production'\n},\n\ndockerImage: 'kadirahq/meteord',\ndeployCheckWaitTime: 60\n\n},\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n``\n. Thanks for reporting a possible solution- I was able to fix this issue by removing the npm bcrypt package. I wish that I knew more about how I can roll my own docker package so that I could do this but if anyone has any good guides for how to do it I'd be happy to give it a try.\n. A little late, but if you just run that commandmeteor npm install --save bcryptand you should be all set. I used theabernix/meteord:base` docker image and as of Nov 22, 2016 it worked great.. ",
    "iamrommel": "I'm not using that pem, i'm using the plain password but still it just do nothing after type mup on my command line. is there any log files I can check to know what's really wrong?. yep, i'm using the latest version as i just downloaded it 5hours ago. I also make sure, there is no existing mupx and mup on on my node_modules global folder.\nI was on window and using \"mup.cmd\" rather than just \"mup\" do the trick. i found this on https://github.com/zodern/meteor-up/issues/185#issuecomment-281560683. I think we need to put the commont of @bennygenel  on ReadMe, first install bug, or fix this for windows client.... wow, that's great. I maybe over look it, as i have read that readme months ago and never notice that there is update on it. Thanks anyway for the info. great work @zodern for making this mup alive again. I fixed it by using installing the packages using \"meteor npm i\" and not directly using \"npm i\". The current npm version i have is 5.1.+ where as the bundled NPM from meteor is on 4.+ only, I used the one that came from the meteor bundle and my deployment just came fine.. ",
    "marcoschwartz": "Same here, I can't deploy my apps that use NPM packages, I got the same error. Anyone has a solution ?\n. @madushan1000 Would be great indeed if this could be merged soon, it would be great to be able to use an up-to-date Docker image for Meteor projects :) . Sure, here it is (with IP and app info removed):\nmodule.exports = {\n  servers: {\n    one: {\n      host: 'xx.xx.xx.xx',\n      username: 'root',\n      pem: \"/Users/xx/.ssh/id_rsa\"\n      // password:\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\nmeteor: {\n    name: 'xx',\n    port: 3000,\n    path: '../',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'https://xx.io',\n      MONGO_URL: 'mongodb://localhost/meteor',\n      PORT: 3000,\n      METEOR_SKIP_NPM_REBUILD: 1\n    },\n    docker: {\n      image: 'abernix/meteord:node-8.9.3-base',\n    },\n    deployCheckWaitTime: 60\n  },\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};. I am having the same issue here, it appeared recently but couldn't find the reason. Same here, however I am having the same error but with Ubuntu 16.04. Exact same as @systemlevel: 0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\nJust as a note, after a clean install of Ubuntu 16.04 (on digital ocean, the DB is on MongoLab), the error is gone. So probably something coming from some more recents packages installed when doing apt-get update & upgrade.. Got it, will wait for 1.5 then :). ",
    "cspecter": "Well I found a solution, but it doesn't really solve the underlying problems. I narrowed my issue down to two things. The first issue, which is shown in the error I posted above, is that one of the npm package I was using (talib) tries to download the source C++ files from another repository via subversion when installing. On my dev system (a Mac), there is no problem installing it. It downloads the source and builds fine. It also works in an Ubuntu server I set up. But in Docker, no dice, it never downloaded the source. The second issue I am having, and this affects all the binary packages i am using, is that node-gyp just doesn't work properly in Docker. Supposedly node-gyp is included with Meteor. So if you run meteor npm install it should work ok, but when deploying an app it always runs npm install so it needs node-gyp on the OS. I tried just about everything, even building my own Docker image to make sure it is being installed correctly, but node-gyp has issues running as the root. You can try my image out though, maybe it will work for you. cspecter/meteord:alt.\nTo get things working this is what I did. I removed all the binary packages from the package.json, deleted the node_modules folder and reran npm install. \nThe next part is a pain in the butt. You are going to use a package called bindings https://www.npmjs.com/package/bindings. First you need to pre-build all your binaries for all the platforms you need. First I installed the packages on my local dev machine, then grabbed the .node files that were created. Make sure you label them something like _osx so you know what platform they are for. Then I created a Debian server (since that is what my ultimate deployment platform is), installed node and node-gyp, then installed all the binary packages there. Then you need to download those compiled .node files. Make sure to label them as per their platform as well. Installing in this instance seemed to work fine and I think it was because I was running node-gyp not as a root user. \nThen you need to create a private folder in root of your Meteor app. Put all the .node files in there. Then you need to use bindings to load them, make sure you are loading the right .node for the right platform. I used a key in my settings.json to denote whether I was in dev mode or not.\nlet module;\nif (Meteor.settings.public.isDevelopment === true) {\n    module = require('bindings')('../assets/app/module_osx.node');\n} else {\n    module = require('bindings')('../assets/app/module_linux.node');\n}\nFYI, this path ../assets/app/ is important. You don't use the path /private since the bindings package is looking for a path in the deployed app. Anything you put in /private goes into the ../assets/app/ after you build the app. \nThis highly annoying process is how I am using the binary packages I need right now. Hopefully someone smarter than I am can get binary npm packages to work with MUP and Docker without all this hullaballoo.\n. This is not an issue with MUP. It's an issue with Meteor. When Meteor runs npm-rebuild.js it's not clearing out the compiled files for your dev setup (Mac in my case) and thus failing at rebuilding the npm packages. There is a workaround at the bottom of this thread. Not perfect but will do until they address this issue in future release of Meteor. https://github.com/meteor/meteor/issues/7730#issuecomment-266476495. It might be related to NPMJS.org being down today. I've been running into the same issues all afternoon.\nhttp://status.npmjs.org/\n. ",
    "lpgeiger": "+1 This seems like a big problem. I've also got modules with binaries that are failing on MUP and meteord docker implementation. What I find unusual is that when I deploy to galaxy, I have no issues. Assuming galaxy uses Docker, I'm sure there is a workaround. \n@arunoda  how have you solved this in production?\n. +1 setup fails silently\n. One issue I had was with the system paths on OSX.\npem: \"/Users/ME/.ssh/token\" will work but  \"Users/ME/.ssh/token\" will fail silently.\n. @zodern I honestly can't remember, but I don't think so. I abandoned MUP in favor of docker.  This is what I have been using: https://github.com/aedm/minimeteor. @madushan1000 can we add this pull request?. @madushan1000  are the old mup.js files the ones in your test suite?. ",
    "sscaff1": "I get the same error\n. I just upgrade from pre-docker mup to this version of mup. I didn't control the server (nor did I want to get in a thing with my client about moving servers). However, these steps worked for me:\n- Upgrade the site to the latest version of meteor\n- meteor npm i --save-dev mup@latest\n- npx mup init\n- Add these scripts to the package.json\n    {\n      ...\n      \"setup\": \"cd .deploy && mup setup\",\n      \"deploy\": \"cd .deploy && mup deploy\",\n      ...\n    }\n- npm i -g mup@0.11.3\n- In your pre-docker config, run mup stop. This avoids the above error.\n- npm run setup\n- npm run deploy\nI was successfully able to upgrade without moving servers. Hope this helps others. \n@zodern let me know if you'll accept a PR to add this to this migration section of the docs, and I'll submit it.. ",
    "guillim": "@sscaff1 i had similar issue so I created the docker that could overcome this. try it:\ndockerImage:\"guillim/meteord\"\nNow it works great !\nIt is bascially the docker created by abernix but where I updated node (from v4 to v6) and installed some npm packages i needed (including node-gyp which failed before). @wwlweihai  @vedovato i had a similar issue but i didn't want do stay on v4 packages so I created a docker that could overcome this. try it out:\ndockerImage:\"guillim/meteord\"\nNow it works great !\nIt is bascially the docker created by abernix but where I updated node (from v4 to v6) and installed some npm packages i needed. I had the same issue. I needed two things: update node to its latest v6 version, and install the  node-gyp to fix it. \nA very simple way to try that out is to use the docker image i created to fix that:\ndockerImage:\"guillim/meteord\"\nNow it works great !\nIt is bascially the docker created by abernix but where I updated node (from v4 to v6) and installed some npm packages i needed (including node-gyp)\nLet me know if it helped. @jvallarvisp i had similar issue so I created the docker that could overcome this. try it: \ndockerImage:\"guillim/meteord\"\nNow it works great !\nIt is bascially the docker created by abernix but where I updated node (from v4 to v6) and installed some npm packages i needed (including  node-gyp). I have the exact same issue. any additional feedbacks you could add to troubleshoot this ?\nmy config is almost the same: DigitalOcean in a droplet using Ubuntu 16.04 and:\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: 'xxx.xxx.xxx.xxx',\n      username: 'xxxx',\n      pem:'/Users/xxxx/.ssh/xxx,\n    }\n  },\nmeteor: {\n    name: 'todos',\n    path: '/Users/xxx/projectname',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'http://websitename.com',\n      MONGO_URL: 'mongodb://localhost/meteor',\n    },\ndockerImage: 'abernix/meteord:base',\ndeployCheckWaitTime: 120\n\n},\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n``` . Tks for your response.\nI had actually an issue on a forced redirection from https to http that an underlaying package was doing. It is commented on the issue i opened and closed afterwards. (attached to this issue BTW)\nBut I spent a lot of time at the begining modifying nginx.conf cause I thought it came from that !. if it can help, here are what my dockers look like:\nCONTAINER ID        IMAGE                  COMMAND                  CREATED             STATUS              PORTS                        NAMES\n429f2b2c3746        abernix/meteord:base   \"/bin/sh -c 'bash $ME\"   37 minutes ago      Up 37 minutes       0.0.0.0:80->80/tcp           todos\nf4e92cd0af78        mongo                  \"/entrypoint.sh mongo\"   39 minutes ago      Up 39 minutes       127.0.0.1:27017->27017/tcp   mongodb. Found out: \nI was actually testing on the todos list example from Meteor. I didn't know that it was relying on force-ssl package.\nI deleted this package from the project on my computer, and then mup deploy worked fine. I could access the project straight on \"http://mywebsitename.com\" without the https redirection !. @wiserweb is right Indeed. It takes some time and troubleshooting to make it work, but works great afterwards !. Finally found out... Stupid me: It was a simple firewall issue since I only authorized the first server to access the database.\nFor the record, if it happens to someone else:\n\nlog in to your database server\nMake sure your IP is part of the white list with this command: \nsudo ufw status\n\n. When I run:\nmup proxy nginx-config\nThis is what comes:\n```\nIf we receive X-Forwarded-Proto, pass it through; otherwise, pass along the\nscheme used to connect to this server\nmap $http_x_forwarded_proto $proxy_x_forwarded_proto {\n  default $http_x_forwarded_proto;\n  ''      $scheme;\n}\nIf we receive X-Forwarded-Port, pass it through; otherwise, pass along the\nserver port the client connected to\nmap $http_x_forwarded_port $proxy_x_forwarded_port {\n  default $http_x_forwarded_port;\n  ''      $server_port;\n}\nIf we receive Upgrade, set Connection to \"upgrade\"; otherwise, delete any\nConnection header that may have been passed to this server\nmap $http_upgrade $proxy_connection {\n  default upgrade;\n  '' close;\n}\nApply fix for very long server names\nserver_names_hash_bucket_size 128;\nDefault dhparam\nssl_dhparam /etc/nginx/dhparam/dhparam.pem;\nSet appropriate X-Forwarded-Ssl header\nmap $scheme $proxy_x_forwarded_ssl {\n  default off;\n  https on;\n}\ngzip_types text/plain text/css application/javascript application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;\nlog_format vhost '$host $remote_addr - $remote_user [$time_local] '\n                 '\"$request\" $status $body_bytes_sent '\n                 '\"$http_referer\" \"$http_user_agent\"';\naccess_log off;\nHTTP 1.1 support\nproxy_http_version 1.1;\nproxy_buffering off;\nproxy_set_header Host $http_host;\nproxy_set_header Upgrade $http_upgrade;\nproxy_set_header Connection $proxy_connection;\nproxy_set_header X-Real-IP $remote_addr;\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\nproxy_set_header X-Forwarded-Proto $proxy_x_forwarded_proto;\nproxy_set_header X-Forwarded-Ssl $proxy_x_forwarded_ssl;\nproxy_set_header X-Forwarded-Port $proxy_x_forwarded_port;\nMitigate httpoxy attack (see README for details)\nproxy_set_header Proxy \"\";\nserver {\n    server_name _; # This is just an invalid value which will never trigger on a real hostname.\n    listen 80;\n    access_log /var/log/nginx/access.log vhost;\n    return 503;\n}\napp2.com\nupstream app2.com {\n                ## Can be connected with \"bridge\" network\n            # app2\n            server IPofapp2:80;\n}\nserver {\n    server_name app2.com;\n    listen 80 ;\n    access_log /var/log/nginx/access.log vhost;\n    include /etc/nginx/vhost.d/app2.com;\n    location / {\n        proxy_pass http://app2.com;\n    }\n}\nserver-mobile.app1.com\nupstream server-mobile.app1.com {\n                ## Can be connected with \"bridge\" network\n            # app1ForMobile\n            server IPofapp1:80;\n}\nserver {\n    server_name server-mobile.app1.com;\n    listen 443 ssl http2 ;\n    access_log /var/log/nginx/access.log vhost;\n    ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;\n    ssl_ciphers 'key';\n    ssl_prefer_server_ciphers on;\n    ssl_session_timeout 5m;\n    ssl_session_cache shared:SSL:50m;\n    ssl_session_tickets off;\n    ssl_certificate /etc/nginx/certs/server-mobile.app1.com.crt;\n    ssl_certificate_key /etc/nginx/certs/server-mobile.app1.com.key;\n    ssl_dhparam /etc/nginx/certs/server-mobile.app1.com.dhparam.pem;\n    ssl_stapling on;\n    ssl_stapling_verify on;\n    ssl_trusted_certificate /etc/nginx/certs/server-mobile.app1.com.chain.pem;\n    include /etc/nginx/vhost.d/default;\n    location / {\n        proxy_pass http://server-mobile.app1.com;\n    }\n}\nserver {\n    server_name server-mobile.app1.com;\n    listen 80 ;\n    access_log /var/log/nginx/access.log vhost;\n    include /etc/nginx/vhost.d/default;\n    location / {\n        proxy_pass http://server-mobile.app1.com;\n    }\n}\nwww.app2.com\nupstream www.app2.com {\n                ## Can be connected with \"bridge\" network\n            # app2\n            server IPofapp2:80;\n}\nserver {\n    server_name www.app2.com;\n    listen 80 ;\n    access_log /var/log/nginx/access.log vhost;\n    include /etc/nginx/vhost.d/www.app2.com;\n    location / {\n        proxy_pass http://www.app2.com;\n    }\n}\n```. @znat any update ? Ob my side, I am still having this issue at the moment.. I finally manage to make it work. using this configuration:\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host:  'XX.XX.XX.XX',\n      username: 'myusername',\n      pem:'/.../.ssh/mysshkey',\n    }\n  },\n  app: {\n    name: 'appname1',\n    path: '/.../app1',\n    servers: {\n      one: {}\n    },\n    docker: {\n      image: 'zodern/meteor:root'\n    },\n    buildOptions: {\n      serverOnly: true,\n      debug: true,\n      executable: 'meteor'\n    },\n    env: {\n      ROOT_URL: 'https://app1.com',\n      MONGO_URL: 'mongodb://XX.XX.XX.XX:27017/myapp1',\n      LETSENCRYPT_HOST: \"https://app1.com\",\n      LETSENCRYPT_EMAIL: \"contact@app1.com\"\n    },\n    dockerImage: 'zodern/meteor:root',\n    deployCheckWaitTime: 100,\n    enableUploadProgressBar: true,\n    type:\"meteor\"\n  },\n  proxy: {\n    domains: 'app1.com,www.app1.com',\n    ssl: {\n      letsEncryptEmail: 'contact@app1.com'\n    },\n    \"shared\": {\n      \"envLetsEncrypt\": {\n        \"DEBUG\": true\n      }\n    }\n  },\n};\n```\nand same thing for app2.\nHowever, I have the feeling that one of the two app take the lead on the other one. I am saying so because when I open app1 in a new window (incognito window to avoid cache issues), I see the favicon of the wrong app (app2). After a couple millisecond, it switches to the expected app1 favicon. any idea @zodern ?. I have the exact same issue, except in my case, when i type \nmup proxy logs-le\nthe output is\nACME server returned an error: urn:acme:error:rateLimited :: There were too many requests of a given type :: Error creating new authz :: too many failed authorizations recently: see https://letsencrypt.org/docs/rate-limits/\nI guess it isn't possible to use the letsencrypt staging env with mup, is it ?\nOtherwise, i will wait until I can test again.... @Ziinc yes it works now !!! using this image \nimage: 'zodern/meteor:root'. Did you forget to add your key to \nservers: {\n        one: {\n            host: 'my-ip',\n            username: 'david-admin',\n            pem:'/<path_to_ssh>/.ssh/david-admin_key',\n            opts: {\n                port: 2222,\n            },\n        },\n    },\nor did you commit out this part ?. Well ...can you at least ssh your webserver through your terminal directly ? @TechStacker @MathiasKandelborg . @TechStacker Also, make sure you don't have password on your ssh key. It will ease the debugging process (Later, you can use a password with the ssh key but it is another step forward, let's try easy first). ",
    "dominicarrojado": "I have the same error. Have you fix this? @tomitrescak \n. I changed deployCheckWaitTime to 240 and redeployed and it was fixed\n. I now have a new error: \n```\n-----------------------------------STDERR-----------------------------------\n      at Function..each..forEach (/bundle/bundle/programs/server/node_modules/underscore/underscore.js:79:11)\n> meteor-dev-bundle@0.0.0 install /bundle/bundle/programs/server\n> node npm-rebuild.js\n\n{\n  \"meteor-dev-bundle\": \"0.0.0\",\n  \"npm\": \"3.10.5\",\n  \"ares\": \"1.10.1-DEV\",\n  \"http_parser\": \"2.5.2\",\n  \"icu\": \"56.1\",\n  \"modules\": \"46\",\n  \"node\": \"4.4.7\",\n  \"openssl\": \"1.0.2h\",\n  \"uv\": \"1.8.0\",\n  \"v8\": \"4.5.103.36\",\n  \"zlib\": \"1.2.8\"\n}\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\n=> Starting meteor app on port:80\nNote: you are using a pure-JavaScript implementation of bcrypt.\nWhile this implementation will work correctly, it is known to be\napproximately three times slower than the native implementation.\nIn order to use the native implementation instead, run\n\n  meteor npm install --save bcrypt\n\nin the root directory of your application.\n\n=> Redeploying previous version of the app\n\n-----------------------------------STDOUT-----------------------------------\n\nTo see more logs type 'mup logs --tail=50'\n\n----------------------------------------------------------------------------\n\n```\n. @kyle-rader Is it because there's a comment in the mup.js? I haven't tried removing the comments, I'll try again later. No, I'm not running it behind a reverse proxy\n. Fixed by removing comments in mup.js\n. But when that splash shows then I refresh it can be access again.\n. @tomyo No I didn't find out why, but it doesn't show up anymore. I need to clean up my codes too.. @tomyo I still experience it. Did you find a fix for yours?. I updated already but somehow it's still using the old version. Whenever I execute an mup command got this at the start:\n\nHow do I fix this?. @tomtom87 after I npm uninstall mup, it's still installed. @zodern This still appears\n\n. Nvm I figured out a way somehow @zodern . @zodern \n. @crstn210 I did the same as what @c316 did. It worked for me.. Fixed by reuploading npm modules. @rclai I believe it's a fix.. Same here as well.. ",
    "MattSich": "+1\n. @mroftalp @madushan1000 still getting the issue after upping the waitTime to 240\n```\n    -----------------------------------STDERR-----------------------------------\n    has modification time 291 s in the future\n      ACTION Regenerating Makefile\n    make: Warning: File '../binding.gyp' has modification time 291 s in the future\n      ACTION Regenerating Makefile\n    make: Warning: File '../binding.gyp' has modification time 291 s in the future\n      ACTION Regenerating Makefile\n    make: Warning: File '../binding.gyp' has modification time 290 s in the future\n      ACTION Regenerating Makefile\n    make: Warning: File '../binding.gyp' has modification time 290 s in the future\n      ACTION Regenerating Makefile\n    make: Warning: File '../binding.gyp' has modification time 290 s in the future\n      ACTION Regenerating Makefile\n    make: Warning: File '../binding.gyp' has modification time 290 s in the future\n      ACTION Regenerating Makefile\n    make: Warning: File '../binding.gyp' has modification time 290 s in the future\n      ACTION Regenerating Makefile\n    make: Warning: File '../binding.gyp' has modification time 289 s in the future\n      ACTION Regenerating Makefile\n=> Redeploying previous version of the app\n\n-----------------------------------STDOUT-----------------------------------\n\n```\n. +1\n. ",
    "JeremyIglehart": "I had this same problem - although I will note the code was pushed up just fine.  It would be nice to know what's causing this and how to fix it.\n. I was getting\n-----------------------------------STDERR-----------------------------------\n    ing.gyp' has modification time 14 s in the future\n      ACTION Regenerating Makefile\nmy deployCheckWaitTime was set to 60 but now I have it set to 120 and it's fine now.\nWhat do other people have their deployCheckWaitTime set to?\n. ",
    "keifuji": "Did you check the remote system clock? It might be behind your local system clock.\n. node: symbol lookup error: /built_app/programs/server/npm/node_modules/bcrypt/lib/binding/bcrypt_lib.node: undefined symbol: _ZN4node19GetCurrentEventLoopEPN2v87IsolateE\nThis seems to be the same problem as symbol lookup error undefined symbol: ... #656\nI got one and fixed it, though temporarily, by downgrading bcrypt from 3.0.2 to 3.0.0.. ",
    "Shaidar20": "This is likely your system time. I ran into the same issue using Vagrant.\n1. yum (or apt-get) install ntp\n2. sudo ntpdate pool.ntp.org\n3. Re-run your install\n. ",
    "cagrigunal": "I just had this issue because of the local time problem(Turkey stopped  changing time), it gave me the same error. After updating my local OS, the time is correct now and I can deploy my app. ",
    "lucnat": "I have one server where I cannot get rid of this issue. But it turns out that the deploy happens nevertheless, and after deploy running mup stop && mup start all works fine\n. Hi,\nJust do mup init and that creates a file mup.js that is quite similar to your familiar mup.json. The file that is being automatically generated is that simple example that you are looking for. \n. As written in the documentation, you can do \nmup logs -f to get a \"live-stream\" of the server console\nmup logs --tail=50 to get read last 50 lines from the server console\n. @ordinaryperson Do we have to do this on the server inside of the docker container? If so, how? I am using the oleurud/meteor-graphicsmagick because my app needs gm, but it doesn't work with meteor 1.6. I would love some more instructions as well in the docs. . @SachaG Would be awesome to have improved docs as I am really lost with setting up ssl with letsencrypt. Let's say I want to deploy the meteor boilerplate app on a fresh fresh DO ubuntu 16.04 droplet with Let's Encrypt. Then the things where I am lost are\n- How do I get a letsEncryptEmail?\n- Do I need to configure nginx.conf somehow? Without doing anything, my server gives an 503 Service Temporarily Unavailable error, but it might be because I messed up some other part.\n- What records need to be created for the domain?\n. @SachaG Thanks for the explanations. For clarification: I only need an A records sending the domain to the ip of the server, correct? Or do I need any other records?. @massimosgrelli I wasn't able to do it with letsEncryptEmail either but the \"custom certificates technique\" outlined by @SachaG above worked great for me. ",
    "bearcanrun": "@tomitrescak I was just going through this figuring out how to get multiple apps running on one server. I'm using nginx as a reverse proxy on a digital ocean VPS. \nWhat I found is, if you run on the server $ docker ps it'll show your container with something like 0.0.0.0:[MUP-PORT]->80/tcp under ports where docker  is automatically bridging the port to 80/443. Read more here.\nIf you run curl 0.0.0.0:MUPPORT, you should actually see your app output. Thus, you can use the server localhost:MUPPORT as an upstream and proxy pass into the desired server. \n. @tomitrescak Right, so your app is launching correctly. Inside the container meteor is running on 80, then is bridged to 0.0.0.0:MUP_PORT then to server localhost:80. This is as it should be.\nI'm pretty sure mup logs is the same as $ docker logs <container_id> but check to see that they match up and no new errors.\nCheck nginx error logs: $ sudo tail -f /var/log/nginx/error.log\nMy nginx conf is something like this (/etc/nginx/sites-available/mysite.conf):\n```\nupstream meteorapp {\n  server 0.0.0.0:;\n  keepalive 8;\n}\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name mysite.com;\n    return 301 https://$server_name$request_uri;\n}\nserver {\n listen [::]:443 ssl default_server;\n# SSL config\n ...\n# Make site accessible from localhost\n server_name mysite.com;\nproxy_set_header X-Real-IP $remote_addr;\n proxy_set_header X-Forwarded-Proto $scheme;\n proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n proxy_http_version 1.1;\n proxy_set_header Upgrade $http_upgrade;\n proxy_set_header Connection \"upgrade\";\n proxy_set_header Host $host;\n proxy_set_header X-NginX-Proxy true;\nlocation / {\n        proxy_pass https://meteorapp;\n }\n}\n```\nWhat is your app built with? Meteor 1.4? webpack? I had a whole bunch of problems in production when upgrading to 1.4. Of course, make sure you are trying to deploy with a stupid simple app first. After I finally got my app to actually make it to the browser as blank page, I had a whole other slew of errors to deal with. I ended up removing webpack (using thereactivestack:webpack) to get things deployed finally.\n. ",
    "leckylao": "@bearcanrun This is very useful. I will suggest adding the steps in README for how to set it up to work with Nginx proxy. \nHere's some extra steps I need to do to make it works:\n- Create and run a mongodb container and name it mongodb\n- Adds in the mongo config in mup js in order for the meteor to connect it to\n  mongo: { // optional\n  oplog: true,\n  port: 27017,\n  servers: {\n    one: {},\n  },\n  }\n- It is necessary to set env port 8080(other than 80) to overwrite the default container publish port:\n  env: {\n    PORT: '8080',\n    ROOT_URL: 'http://xxxxxx',\n    MONGO_URL: 'mongodb://mongodb/xxxxx'\n  }\n. ",
    "ghost": "I was having this error with  mup reconfig, used mup deploy instead and worked.\n. @martinhbramwell I am also getting the same error on Windows and Ubuntu, too. I am using Meteor 1.6\nmup.js\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '192.168.1.104',\n      username: 'gabriel',\n      password: 'gabriel',\n      opts: {\n        port: 5555\n      }\n    }\n  },\napp: {\n    // TODO: change app name and path\n    name: 'ReportApp',\n    path: '../',\nservers: {\n  one: {},\n},\n\nbuildOptions: {\n  serverOnly: true,\n},\n\nenv: {\n  ROOT_URL: 'http://reportapp.com',\n  MONGO_URL: 'mongodb://localhost/meteor',\n  MONGO_OPLOG_URL: 'mongodb://mongodb/local',\n},\n\ndocker: {\n  image: 'abernix/meteord:base',\n},\nenableUploadProgressBar: true\n\n},\nmongo: {\n    version: '3.4.1',\n    servers: {\n      one: {}\n    }\n  },\n};\n. @martinhbramwell why not? What are you using now? I am using it to learn JavaScript. Do you recommend other frameworks?. I decided to use nginx configuration file SSL support before the request reaches the (docker/nginx/meteor-app) that mup deploys. Hopefully this doesn't create adverse behavior in other areas of the app later on.\n. If the other database was already deployed with another app using mup then this is not supported. Refer to the comment from @madushan1000 commented on Jun 29 at https://github.com/kadirahq/meteor-up/issues/157 Also, there appears to be hacks around it if you keep reading the rest of that thread.\nIf this is a separate instance then point to the already deployed database by changing the MONGO_URL: 'mongodb://localhost:27017/meteor' to that of the already deployed database. I have not tested this, but I would think as long as you setup another mongodb on a different port number for the mongo instance it should work. Something like MONGO_URL: 'mongodb://localhost:27018/meteor'\nAlso, I think you would also remove the mongo lines below that are in the second app's mup.js. This is to make sure that it doesn't try to deploy a mongodb. Again I have not tested this.\nmongo: {\n  oplog: true,\n  port: 27017,\n  servers: {\n    one: {},\n  },\n},\n. Assuming you have a vps: ssh into your server and do as the STDOUT says. Type the command: mup logs --tail=50 . Read each line of the output to pinpoint the issue. My hunch is that you will find something in your mup.js is not supported.\n. Do you have nginx setup on the server to direct request, before mup setup?\n. Instead of site-enabled I use /sites-available per http://julian.io/how-do-i-host-multiple-meteor-apps-on-one-digitalocean-droplet/\nAlthough, since you are editing the file directly I would think it should still work. But I like the symlink way in case I need to take the address down for any unknown reason.\nOtherwise do some double checks:\nUse command sudo nano /etc/nginx/sites-enabled/yourappname.com.conf\nVerify :3000 port is specified in proxy_pass http://yourappname.com:3000;\nEnsure that updates were made by using command sudo services nginx reload\nIn mup.js verify 3000 port is specified under the env object PORT: 3000,\nIf this doesn't work post your mup.js and your nginx yourappname.com.conf file with personal information redacted so that I or someone else can help you troubleshoot further.\n. Try in conf file:\nproxy_pass http://127.0.0.1:3000;\nAlso, in mup.js file try changing server information to:\nservers: {\n      one: {\n        host: 'xxx.xx.xxx.xx',\n        username: 'yourusername'\n      },\n},\nAnd env information to:\nenv: {\n  PORT: 3000,\n  UPSTART_UID: 'meteoruser',\n  ROOT_URL: 'http://myapp.co.uk',\n  MONGO_URL: 'mongodb://localhost/meteor'\n},\nJust an observation not related to the issue, do you mean to have 600 deployCheckWaitTime or did you mean 60 ?\n. Yes proxy pass should point to the local host 127.0.0.1. It appears that you redacted it to xxx.xx.xxx.xx which could have meant that you were pointing it at something else. I just wanted to make sure you were pointing it at http://127.0.0.1:3000\nSelf managed hosting can definitely have it's issues and growing pains, which is why Meteor Galaxy managed hosting is a little pricey. But if you get it right yourself, you have learned something and if you continue to use meteor you have saved money over time.\nIt is alright, hopefully this forum can help someone else along the way.\n. It is nice to help solve a mystery, but I have a few issues I am combing through myself and probably wouldn't be of much further help. Thank you for the offer of a coffee though. The best advice I can give is check your logs and research the things you do not understand. Also, start over on a fresh slate if it doesn't work after a few hours.\n. Here is my example. It is successfully loading the meteor app, correctly displaying www in browser, and correctly loading the app requested (I am setting up multiple apps on Linode). Also, this setup has received an A in ssl lab test. Although I have not finished testing everything like mongodb functionality, maybe this can help you.\n/etc/nginx/sites-available/domain.com file (if you use sites available make symlink from /etc/nginx/sites-enabled/domain.com):\n```\nserver {\n        listen *:80;\n        listen [::]:80;\n        server_name www.domain.com domain.com;\n        return 301 https://www.domain.com$request_uri;\n}\nserver {\n        # SSL configuration\n        listen 443 ssl http2;\n        listen [::]:443 ssl http2;\n        # gzip on = speed, gzip off = security\n        # gzip off\n    server_name www.domain.com domain.com;\n\n    ssl_certificate /etc/nginx/ssl/domain.com/fullchain.pem;\n    ssl_certificate_key /etc/nginx/ssl/domain.com/privkey.pem;\n    ssl_dhparam /etc/nginx/ssl/domain.com/dhparam.pem;\n    ssl_session_timeout 1d;\n    ssl_session_cache shared:SSL:50m;\n    ssl_session_tickets off;\n\n    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n    ssl_ciphers 'ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS';\n    ssl_prefer_server_ciphers on;\n\n    ssl_stapling on;\n    ssl_stapling_verify on;\n\n    ssl_trusted_certificate /etc/nginx/ssl/domain.com/fullchain.pem;\n\n    # Increase max-age after setup is solid.\n    add_header Strict-Transport-Security \"max-age=86400; includeSubDomains\" always;\n\n    root /var/www/html/domain.com/public_html;\n\n    index index.html index.htm index.nginx-debian.html;\n\n    access_log /var/log/nginx/domain.com/app.dev.access.log;\n    error_log /var/log/nginx/domain.com/app.dev.error.log;\n\n    error_page 401 403 404 /404.html;\n\n    #location / {\n            #try_files $uri $uri/ =404;\n    #}\n\n    location / {\n            proxy_pass http://127.0.0.1:3000;\n            proxy_http_version 1.1;\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection 'upgrade';\n            proxy_set_header X-Forwarded-For $remote_addr;\n    }\n\n}\n```\nmup.js file:\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: 'xxx.xxx.xxx.xxx',\n      username: 'login username here',\n      pem: 'path to .rsa file here',\n    }\n  },\nmeteor: {\n    name: 'your unique app name',\n    path: 'path to app here',\n    servers: {\n      one: {\n        host: 'xxx.xxx.xxx.xxx',\n        username: 'root'\n      },\n    },\n    docker: {\n      image:'abernix/meteord:base',\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      PORT: 3000,\n      UPSTART_UID: 'meteoruser',\n      ROOT_URL: 'https://www.domain.com',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n    //If hosting multiple apps ssl will not work with mup\n    //ssl: {\n    //  crt: 'path to fullchain.pem',\n    //  key: 'path to privkey.pem',\n    //  port: 443\n    //},\n    deployCheckWaitTime: 60\n  },\n  //remove this if you have setup mongodb separately\n  mongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n```\n. Also, the \"default\" configuration file is in /etc/nginx/sites-available/ which points toward the welcome to nginx page. That is probably what is giving you issues and blocking you from seeing your app. You can remove the symlink between /etc/nginx/sites-available/ and /etc/nginx/sites-enabled or move/remove the \"default\" file from /etc/nginx/sites-available.\n. In the shell run the command:\nls /etc/nginx/sites-available/\nAnd also run:\nls /etc/nginx/sites-enabled/\nAnd reply with what is printed out to screen. If you want you can redact information printed out with fake app names...\nAlso, run: (you may not need sudo)\nsudo mv /etc/nginx/sites-available/default ~/\nsudo service nginx reload\nThen clear history in your browser or use incognito mode and then reload your app url.\n. Below are the steps I would take.\nWhether you need it now or not it is good practice to use symlinks between sites-enables and sites-available. Refer to this explanation: http://serverfault.com/questions/527630/what-is-the-different-usages-for-sites-available-vs-the-conf-d-directory-for-ngi\nThe directory /etc/nginx/sites-enabled/ should not have any files in it, just symlinks.\nFirst backup both directories to some temporary directory of your choice.\nRemove or unlink \"all\" files in /etc/nginx/sites-enabled.\nFor example:\nunlink /etc/nginx/sites-enabled/myapp.com.conf\nor\nrm /etc/nginx/sites-enabled/myapp.com.conf\nRemove all files in /etc/nginx/sites-available.\nNow create a new mydomain.co.uk.conf file in /etc/nginx/sites-available and use the following:\n```\nserver {\n    listen :80;\n    server_name .mydomain.co.uk mydomain.co.uk;\n    return 301 http://www.mydomain.co.uk$request_uri;\n}\nserver {\n    listen :80;\n    server_name .mydomain.co.uk mydomain.co.uk;\naccess_log /var/log/nginx/app.dev.access.log;\nerror_log /var/log/nginx/app.dev.error.log;\n\nroot /var/www/html/mydomain.co.uk/public_html;\n\nindex index.html index.htm index.nginx-debian.html;\n\nlocation / {\n    proxy_pass http://127.0.0.1:3000;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection 'upgrade';\n    proxy_set_header X-Forwarded-For $remote_addr;\n}\n\n}\n```\nAfter saving, make the symlink through the command:\nsudo ln -s /etc/nginx/sites-available/mydomain.co.uk.conf /etc/nginx/sites-enabled/mydomain.co.uk.conf\n. I did try to change the URL to other values including 127.0.0.1 \nBut even that didn't work.. So basically I'm using meteor to run an offline server on a local intranet. The network doesn't have internet connection. \nNow I have been running this setup for quite some time without meteor up with no issues at all. I would just manually build the code, copy it to the machine, install mongodb and node on the machine and then run the code everytime I started the machine.\nNow instead of this manual process, I'm trying meteor-up  to deploy the updates.\nThe issue is not with using meteor offline as I've already used it before in the same configuration and environment. \nI think the issue is somewhat related to docker networking.  The docker containers run fine but maybe the internal network is unreachable from the host machine.. @nadeemja what do you mean by turning off Cloudflare? Did you mean turning off SSL?. @zodern @SadekSyed I have the same problem. How did you resolve it?. I am also having the same issue with Meteor 1.6:\n```\nStarted TaskList: Setup Docker\n[192.168.1.104] - Setup Docker\nevents.js:110\n      throw er; // Unhandled 'error' event\n      ^\nError: connect ECONNREFUSED 192.168.1.104:5555\n    at Object._errnoException (util.js:1003:13)\n    at _exceptionWithHostPort (util.js:1024:20)\n    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1181:14)\n```\nmup.js \n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '192.168.1.104',\n      username: 'gabriel',\n      password: 'gabriel',\n      opts: {\n        port: 5555\n      }\n    }\n  },\napp: {\n    name: 'ReportApp',\n    path: '../',\nservers: {\n  one: {},\n},\n\nbuildOptions: {\n  serverOnly: true,\n},\n\nenv: {\n  ROOT_URL: 'http://reportapp.com',\n  MONGO_URL: 'mongodb://localhost/meteor',\n  MONGO_OPLOG_URL: 'mongodb://mongodb/local',\n},\n\ndocker: {\n  image: 'abernix/meteord:base',\n},\n\nenableUploadProgressBar: true\n\n},\nmongo: {\n    version: '3.4.1',\n    servers: {\n      one: {}\n    }\n  },\n};\n. It looks like you cannot install it through `meteor npm i --global mup`\nYou need to use only `npm` . I think it would be best if you could do something about it :). @zodern I also tried with a plain meteor app, same mup.js file and I have the same error.\nthis is what I get after running `mup deploy --verbose`\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[] - Pushing Meteor App Bundle to the Server\n[] - Pushing Meteor App Bundle to the Server: SUCCESS\n[] - Prepare Bundle\nroot: Pulling from zodern/meteor\nDigest: sha256:94388cd430fcad65bdeaeee831e409aee5ed62456cb8364c764d867a07564f77\nStatus: Image is up to date for zodern/meteor:root\nFinished Extracting\nCreating Dockerfile\nFinished creating Dockerfile\nBuilding image\nSending build context to Docker daemon  43.45MB\nStep 1/10 : FROM zodern/meteor:root\nExecuting 5 build triggers\n---> Using cache\n ---> Using cache\n ---> Using cache\n ---> Using cache\n ---> Using cache\n ---> c6ccb7e7f444\nStep 2/10 : RUN mkdir /built_app || true\n ---> Using cache\n ---> 4711056a1023\nStep 3/10 : ENV ROOT_URL=https://manecadincanepa.ro\n ---> Using cache\n ---> 49e999f5d801\nStep 4/10 : ENV MONGO_URL=mongodb://mongodb:27017/\n ---> Using cache\n ---> c1f2debd1b78\nStep 5/10 : ENV MONGO_OPLOG_URL=mongodb://mongodb/local\n ---> Using cache\n ---> c8a041f80a29\nStep 6/10 : ENV VIRTUAL_HOST=manecadincanepa.ro\n ---> Using cache\n ---> 369811ce07b1\nStep 7/10 : ENV HTTPS_METHOD=redirect\n ---> Using cache\n ---> 945222f49f6b\nStep 8/10 : ENV HTTP_FORWARDED_COUNT=1\n ---> Using cache\n ---> 5ebb5e39a141\nStep 9/10 : COPY ./ /built_app\n ---> Using cache\n ---> 6b9929052a7d\nStep 10/10 : RUN cd  /built_app/programs/server &&     npm install --unsafe-perm\n ---> Using cache\n ---> 6fc44093b6ff\nSuccessfully built 6fc44093b6ff\nSuccessfully tagged mup-:build\nDeleted Images:\ndeleted: sha256:1c6d469e17cd412cfd41ef4b9ac6742782eb712b293b290340e86956b1b9cf37\ndeleted: sha256:2b265b9ab26c751ff85ea2f62dc5ddd76510df9210566b95310030e44d3ecca3\ndeleted: sha256:1b06ad6211ed0577473607ebc21da0d5af9fa4dda4819746cc712c59cec2b2d5\ndeleted: sha256:f6e63e6da6ba2a2af0bcf74a2db9a6d7001e03169230c661753a0c0c91c1f8dc\nTotal reclaimed space: 243.9MB\n[18.196.4.125] - Prepare Bundle: SUCCESS\nStarted TaskList: Configuring App\n[18.196.4.125] - Pushing the Startup Script\n[18.196.4.125] - Pushing the Startup Script: SUCCESS\n[18.196.4.125] - Sending Environment Variables\n[18.196.4.125] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[18.196.4.125] - Start Meteor\nusing image\nremoving last\nImage mup-:latest\nVolume\nRemoving docker containers. Errors about nonexistent endpoints and containers are normal.\n\nError response from daemon: endpoint  not found\nError: No such container: -frontend\nError response from daemon: endpoint -frontend not found\nError: No such container: -nginx-letsencrypt\nError response from daemon: endpoint -nginx-letsencrypt not found\nError: No such container: -nginx-proxy\nError response from daemon: endpoint -nginx-proxy not found\nFinished removing docker containers\ndffa5af915893880016589ea00743d8b24c4692047aa50d69bb582efcef042be\nRan zodern/meteor:root\n[18.196.4.125] - Start Meteor: SUCCESS\n[18.196.4.125] - Verifying Deployment\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0<!DOCTYPE html>\n\n\n\ntest-app\n\n\n<strong>meteor_runtime_config</strong> = JSON.parse(decodeURIComponent(\"%7B%22meteorRelease%22%3A%22METEOR%401.7.0.5%22%2C%22meteorEnv%22%3A%7B%22NODE_ENV%22%3A%22production%22%2C%22TEST_METADATA%22%3A%22%7B%7D%22%7D%2C%22PUBLIC_SETTINGS%22%3A%7B%22title%22%3A%22Your%20site%20title%22%2C%22tagline%22%3A%22Your%20site%20tagline%22%2C%22logoUrl%22%3A%22http%3A%2F%2Fplacekitten.com%2F250%2F80%22%2C%22logoHeight%22%3A%2280%22%2C%22logoWidth%22%3A%22250%22%2C%22faviconUrl%22%3A%22%2Ffavicon.ico%22%2C%22language%22%3A%22en%22%2C%22locale%22%3A%22en%22%2C%22twitterAccount%22%3A%22foo%22%2C%22facebookPage%22%3A%22http%3A%2F%2Ffacebook.com%2Ffoo%22%2C%22googleAnalytics%22%3A%7B%22apiKey%22%3A%22foo123%22%7D%7D%2C%22ROOT_URL%22%3A%22https%3A%2F%2Fmanecadincanepa.ro%22%2C%22ROOT_URL_PATH_PREFIX%22%3A%22%22%2C%22appId%22%3A%22l7zr715ypn5y.gbqo0gj90zv%22%2C%22autoupdateVersion%22%3A%22fafb50ec3e75c9340c5025be64a70f4ac07bfe03%22%2C%22autoupdateVersionRefreshable%22%3A%2230cf50f4bb9c2e4fa8153a9fae9855847dbbb3aa%22%2C%22autoupdateVersionCordova%22%3A%22none%22%2C%22isModern%22%3Afalse%7D\"))\n\n\n100  1470    0  1470    0     0  48550      0 --:--:-- --:--:-- --:--:-- 52500\n[18.196.4.125] - Verifying Deployment: SUCCESS\n```. Dear website owner,\nPlease stop using CloudFlare.\nYou're doing it wrong.\nTake a look:\nProblem with CloudFlare\nGeneral problem with Cloudflare's MITM attack on the Internet\nWhy Cloudflare?. ",
    "BastianR": "hey,\nyou have to install ssh2.\nnpm install -g ssh2\n. ",
    "Tbutnyakov": "Or you can install it with global parameter.\nin console: npm install -g ssh2\n. @betharavikiran you set it to the global \"-g\" setting ?\n. Today package was updated. \nNew version of package generate a strange mup.js file, that can't run, cause it have a few errors. I created a issue about it and...still wait for answer from KadiraTeam:)\nhttps://github.com/kadirahq/meteor-up/issues/185\n. @betharavikiran ok! Hope guys from kadira will answer soon.\n. @afuggini you asking  about \"ssh2\"? Or \"meteor setup\" problem?\n. @afuggini yep, you are not alone:)\nI created a issue: https://github.com/kadirahq/meteor-up/issues/185\n. Yes, it is work fine. I can call \"mup init\", and \"mup\" will build the project. \nBut, i get error only when i try to \"mup.js\".\n. Yes, i can call \"mup setup\". It will ask me abot \"mup.js\". \nHere a code:\n\nmodule.exports = {\n  servers: {\n    one: {\n      host: 'strangehost',\n      username: 'strangename',\n      password: \"strangename\"\n    }\n  },\n  meteor: {\n    name: 'strangeapp',\n    path: '../strangeapp',\n    buildOptions: {\n      serverOnly: true,\n      debug: true\n    },\n    env: {\n      ROOT_URL: 'strangeapp.club',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n    log: {\n      driver: 'syslog',\n      opts: {\n        \"syslog-address\":'udp://syslogserverurl.com:1234'\n      }\n    },\n    dockerImage: 'kadirahq/meteord',\n    deployCheckWaitTime: 60\n  },\n  mongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {}\n    }\n  }\n};\n. @madushan1000 we will got errors on this case: \nFor example: \"c:\\Users\\Tim\\AppData\\Roaming\\npm\\node_modules\\mup setup\" command will call error. \nSomething like: \"This is a not executive programm or package file\". \n100 percent. \n\n\"Npm run\" not help too, it trying to find package.json inside project folder, not in the argument path...\n@madushan1000  can you, please, answer this question:\n\nOne more question, what about store uploaded files in static folder on server in this package? In MUPX we have serious problem: arunoda/meteor-up#1101\nIs it fixed in that package?\n. @madushan1000 the same. I use correct path. \n. @madushan1000 cant, because mupx dont support dynamic docker containers. \n. @madushan1000 here it is: https://github.com/arunoda/meteor-up/issues/1101\nIf you tell me what can i check in installed mup package, i can try to help you find a bug in new mup. \n. Im just switch OS from windows to linux. \nIn linux package works good. \n. Hi! How did you perform \"mup setup\" ?!\nMy system can't run mup.js, cause it dont know nothing about \"module\". \n. @CaptainChemist  I did the same. But my OS prevents all my tries to mup setup. \nWhat kind of OS you use?\n. I got \"Windows script error\", first time i took error about unecspected tokens like \",\" after some \"}\". \nWhen, after refactor, i took err message about \"'module' is not defined\".\n. Yes, I understand that. I'm sorry for offtopic\n. @Faberle hi! Did you get errors while \"meteor setup\"? Me, and other guys can't complete \"mup setup\", cause windows script host didn't allow \"mup\" run the script automatically \n. \n",
    "betharavikiran": "I have installed ssh2, but the problem continues. please advise.\n. Hi,\nafter installing with -g option on console, i stopped seeing the ssh2\nmodule missing error.\nBut, i realise that i am stuck between the older version of mup and the new\none. The version i was using until yesterday was generating mup.json file.\nBut what is confusing is that it was working for me until today morning and\nthen i started to see the ssh2 error.\nI will try to configure the new mup and see if i can get it to work.\nThank you for your prompt replies. will keep you posted.\nOn Thu, Aug 4, 2016 at 6:07 PM, Timofey Butnyakob notifications@github.com\nwrote:\n\n@betharavikiran https://github.com/betharavikiran you set it to the\nglobal \"-g\" setting ?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/184#issuecomment-237540157,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AKZs1RjGdM9Lehhm_r1Vb0v3AfKuT4fEks5qcd0ZgaJpZM4JcgUS\n.\n. aha, thanks. should i indicate to kadira team if their update is breaking\nolder version too, in know they already indicated that they dont support it.\n\nOn Thu, Aug 4, 2016 at 6:29 PM, Timofey Butnyakob notifications@github.com\nwrote:\n\nToday package was updated.\nNew version of package generate a strange mup.js file, that can't run,\ncause it have a few errors. I created a issue about it and...still wait for\nanswer from KadiraTeam:)\n185 https://github.com/kadirahq/meteor-up/issues/185\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/184#issuecomment-237545152,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AKZs1bGC51EOWj5RHLVStLb-a7JwaiPnks5qceJEgaJpZM4JcgUS\n.\n. i also stuck with the same issue, looks like the mup process is not doing anything becoz it cannt process module.exports\n\nlet me know if you could get past as I am also using windows\n. switch to mupx\nOn Sat, Sep 3, 2016 at 7:16 PM, Sudhansu Kumar Swain \nnotifications@github.com wrote:\n\nI have the problem, I installed ssh2 by \"npm install -g ssh2\". but still\nreceiving the same error.\n$ mup\nError: Cannot find module 'ssh2'\nat Function.Module._resolveFilename (module.js:325:15)\nat Function.Module._load (module.js:276:25)\nat Module.require (module.js:353:17)\nat require (internal/module.js:12:17)\nat Object. (/home/madushan/mup/src/utils.js:5:1)\nat Module._compile (module.js:409:26)\nat Object.Module._extensions..js (module.js:416:10)\nat Module.load (module.js:343:32)\nat Function.Module._load (module.js:300:12)\nat Module.require (module.js:353:17)\nat require (internal/module.js:12:17)\nat Object. (/home/madushan/mup/src/index.js:7:1)\nat Module._compile (module.js:409:26)\nat Object.Module._extensions..js (module.js:416:10)\nat Module.load (module.js:343:32)\nat Function.Module._load (module.js:300:12)\n$\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/184#issuecomment-244547464,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AKZs1Ypd2u3CcXhdD8SOklqrNIGH-jeSks5qmXpMgaJpZM4JcgUS\n.\n. I also installed meteor up and when I run setup and deploy, nothings happens. The commands executes silently, these are ran from windows 10 machine, so like Tbutnyakov mentioned, may be the issue is module.exports which is not being recognised.\n\n:\\project_beauty\\lookfab>mup setup\nM:\\project_beauty\\lookfab>mup deploy\nM:\\project_beauty\\lookfab>\nmodule.exports = {\n  servers: {\n    one: {\n      host: '139.59.20.aaa',\n      username: 'root',\n      pem: \"privatekey.ppk\"\n      // password:\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\nsetupNode: true,\n  nodeVersion: \"4.4.7\",\nmeteor: {\n    name: 'lookfab',\n    path: 'M:\\project_beauty\\lookfab',\n    servers: {\n      one: {\n        host: '139.59.20.aaa',\n        username: 'root',\n      }\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      \"ROOT_URL\": \"https://139.59.20.aaa\",\n      \"PORT\":8080,\n      \"MONGO_URL\":\"mongodb://devuser:devuseraaa@moloa.15.mongolayer.com:10543,moloa.16.mongolayer.com:10543/lookfab_db?replicaSet-set-4340ge85ef93e267be000688\",\n      \"MONGO_OPLOG_URL\":\"mongodb://oploguser:oploguser1234@moloa.15.mongolayer.com:10543/local?authSource=lookfab_db\",\n    },\n    ssl:{\n      crt: 'ssl.pem',\n      key: 'privatekey.pem',\n      port: 443\n    },\n//dockerImage: 'kadirahq/meteord'\ndeployCheckWaitTime: 1000\n},\n/mongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },/\n};\n. i updated the script with full paths for all files and when i run mup setup, it immediately returns back with out any activity.\nM:\\project_beauty\\lookfab>mup setup\nM:\\project_beauty\\lookfab>\nmodule.exports = {\n  servers: {\n    one: {\n      host: '139.59.20.aaa',\n      username: 'root',\n      pem: \"M:/project_beauty/lookfab/privatekey.ppk\"\n      // password:\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\nsetupNode: true,\n  nodeVersion: \"4.4.7\",\nmeteor: {\n    name: 'lookfab',\n    path: 'M:/project_beauty/lookfab',\n    servers: {\n      one: {\n        host: '139.59.20.aaa',\n        username: 'root',\n      }\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      \"ROOT_URL\": \"https://139.59.20.aaa\",\n      \"PORT\":8080,\n      \"MONGO_URL\":\"mongodb://devuser:devuseraaa@moloa.15.mongolayer.com:10543,moloa.16.mongolayer.com:10543/lookfab_db?replicaSet-set-4340ge85ef93e267be000688\",\n\"MONGO_OPLOG_URL\":\"mongodb://oploguser:oploguser1234@moloa.15.mongolayer.com:10543/local?authSource=lookfab_db\",\n    },\n    ssl:{\n      crt: 'M:/project_beauty/lookfab/ssl.pem',\n      key: 'M:/project_beauty/lookfab/privatekey.pem',\n      port: 443\n    },\ndockerImage: 'kadirahq/meteord',\ndeployCheckWaitTime: 1000\n},\n/mongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },/\n};\n. yes, i want to setup https connection for my server and hence need ssl. I tried by commenting those lines and also changing the url to http, but still same behavior. Mongo block is commented, i removed it anyway now.\nI suspect the issue is that the process is not running through the file at all as \"module.exports\" does not seem recognized by windows.\n. can you give an example on how to do it. Until now, i was not passing any param to the mup, so how should this be done now onwards ?\nlets say the mup in installed globally in c:/appdata/roaming/npm/node_mobules/mup and my project folder is c:/projects/myproject/mup.js\nfor this context, how should we call mup now onwards on windows\n. madushan1000, please advise how to go about with an example call\n. agreed with Tim.  got the error stating as below \n'C:\\Users\\betha\\AppData\\Roaming\\npm\\node_modules\\mup' is not recognized as an internal or external command, operable program or batch file.\nis there a reason why simpler things are becoming difficult to use ?\n. @madushan1000, please help as we are currently stuck in the same point for quite some time\n. hey guys any updates,  i am not able to deploy ... any one who could do successfully ?\n. ",
    "afuggini": "I'm having problems too, I even run mup alone and get nothing. Is everyone having this issue too?\n. @Tbutnyakov I used to have the ssh2 issue until I run npm install -g ssh2. However I still cannot run mup at all, it doesn't do anything.\n. ",
    "sonuterrific": "I have the problem, I installed ssh2 by \"npm install -g ssh2\". but still receiving the same error.\n$ mup\nError: Cannot find module 'ssh2'\n    at Function.Module._resolveFilename (module.js:325:15)\n    at Function.Module._load (module.js:276:25)\n    at Module.require (module.js:353:17)\n    at require (internal/module.js:12:17)\n    at Object. (/home/madushan/mup/src/utils.js:5:1)\n    at Module._compile (module.js:409:26)\n    at Object.Module._extensions..js (module.js:416:10)\n    at Module.load (module.js:343:32)\n    at Function.Module._load (module.js:300:12)\n    at Module.require (module.js:353:17)\n    at require (internal/module.js:12:17)\n    at Object. (/home/madushan/mup/src/index.js:7:1)\n    at Module._compile (module.js:409:26)\n    at Object.Module._extensions..js (module.js:416:10)\n    at Module.load (module.js:343:32)\n    at Function.Module._load (module.js:300:12)\n$\n. Well @DanielSmon  the problem is solved, I  used mupx instead of mup.\nEverything is working fine after installing mupx.\nInstall mupx by using \"npm install -g mupx\" command.\n. ",
    "thegreatredfox": "mupx doesn't work for Meteor 1.4.x \nI installed ssh2 globally and then copied the folder inside the global mup/node_modules folder.\nssh2 is a devDependency and doesn't get install with mup.\n. I installed ssh2 globally and then copied the ssh2 folder into the global mup/node_modules folder.\nIt seems ssh2 is a devDependency and doesn't install automatically.\n. @sonuterrific Are you using Meteor 1.4+ ?\n. ",
    "GuillaumeDeconinck": "Same problem here, it tries to open/execute the mup.js file instead of executing mup.\nThe solution suggested by @madushan1000 worked for me.\n. If you still haven't found a solution, check the issue https://github.com/kadirahq/meteor-up/issues/185\n. ",
    "Nlammertyn": "Just switched over from mupx and ran into the same problem, using the --config parameter with a renamed mup.js file works like a charm, thanks @madushan1000!\n. Confirmed here that settings.json is the issue and cleaning it up worked, also set the settings file as a parameter with --settings, not sure if that could have an effect\n. @kenshinman To clarify, you should rename mup.js to something else, then pass that as a parameter, an example: mup setup --config mup-config.js\n. +1\n. ",
    "issachan": "Just adding that I am on Windows and this was also the issue I had when \"mup setup\" appeared to do nothing. Thanks @madushan1000 \n. ",
    "bennygenel": "On Windows instead using\nmup setup\nusing\nmup.cmd setup\nworks for me.\n. Hi @WayneUong;\nI'm currently trying to setup a load balancer for my app. \nI tried to setup a basic Nginx load balancer but I couldn't figure out how o enable websocket myself too. I followed this documentation but still its not working for me.\n\nDoes AWS load balancer work with only AWS products or can I use it with multiple VPS from other data centres?\nYou can check if websocket connection working or not by using Chrome Developer Tools. Network tab should show websocket connection.\nI would really appreciate any suggestions \nThanks. @zodern I'm having the same issue with letsencrypt. @zodern I'm using load balancer. thats why my root url and ssl url is different.\nmy config \n```\n    servers: {\n        one: {\n            host: 'host.ip.ip.host',\n            username: 'ubuntu',\n        },\n    },\nmeteor: {\n    name: 'appname',\n    path: '../',\n    servers: {\n        one: {},\n        //two:{}\n    },\n    buildOptions: {\n        serverOnly: true,\n    },\n    env: {\n        ROOT_URL: 'https://app.appname.co',\n        MONGO_URL: 'mongodb://username:pass@url/meteor',\n        MONGO_OPLOG_URL: 'mongodb://username:pass@url/local?authSource=admin&replicaSet=repset0',\n    },\n\n    ssl: {\n        // Enables let's encrypt (optional)\n        autogenerate: {\n            email: 'email@email.com',\n            domains: 'be1.appname.co' \n        }\n    },\n    dockerImage: 'abernix/meteord:base',\n    deployCheckWaitTime: 60,\n    enableUploadProgressBar: false\n}\n\n```\n```\n$ docker ps\nCONTAINER ID        IMAGE                                    COMMAND                  CREATED              STATUS              PORTS                                      NAMES\n60a737942128        jrcs/letsencrypt-nginx-proxy-companion   \"/bin/bash /app/en...\"   24 seconds ago       Up 23 seconds                                                  appname-nginx-letsencrypt\nfc8b41033407        jwilder/nginx-proxy                      \"/app/docker-entry...\"   39 seconds ago       Up 39 seconds       0.0.0.0:80->80/tcp, 0.0.0.0:443->443/tcp   appname-nginx-proxy\n667ffeb98a0f        abernix/meteord:base                     \"/bin/sh -c 'bash ...\"   About a minute ago   Up About a minute   80/tcp                                     appname\n\n$ docker exec appname-nginx-proxy cat /etc/nginx/conf.d/default.conf\nIf we receive X-Forwarded-Proto, pass it through; otherwise, pass along the\nscheme used to connect to this server\nmap $http_x_forwarded_proto $proxy_x_forwarded_proto {\n  default $http_x_forwarded_proto;\n  ''      $scheme;\n}\nIf we receive X-Forwarded-Port, pass it through; otherwise, pass along the\nserver port the client connected to\nmap $http_x_forwarded_port $proxy_x_forwarded_port {\n  default $http_x_forwarded_port;\n  ''      $server_port;\n}\nIf we receive Upgrade, set Connection to \"upgrade\"; otherwise, delete any\nConnection header that may have been passed to this server\nmap $http_upgrade $proxy_connection {\n  default upgrade;\n  '' close;\n}\nSet appropriate X-Forwarded-Ssl header\nmap $scheme $proxy_x_forwarded_ssl {\n  default off;\n  https on;\n}\ngzip_types text/plain text/css application/javascript application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;\nlog_format vhost '$host $remote_addr - $remote_user [$time_local] '\n                 '\"$request\" $status $body_bytes_sent '\n                 '\"$http_referer\" \"$http_user_agent\"';\naccess_log off;\nHTTP 1.1 support\nproxy_http_version 1.1;\nproxy_buffering off;\nproxy_set_header Host $http_host;\nproxy_set_header Upgrade $http_upgrade;\nproxy_set_header Connection $proxy_connection;\nproxy_set_header X-Real-IP $remote_addr;\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\nproxy_set_header X-Forwarded-Proto $proxy_x_forwarded_proto;\nproxy_set_header X-Forwarded-Ssl $proxy_x_forwarded_ssl;\nproxy_set_header X-Forwarded-Port $proxy_x_forwarded_port;\nMitigate httpoxy attack (see README for details)\nproxy_set_header Proxy \"\";\nserver {\n    server_name _; # This is just an invalid value which will never trigger on a real hostname.\n    listen 80;\n    access_log /var/log/nginx/access.log vhost;\n    return 503;\n}\nbe1.appname.co\nupstream be1.appname.co {\n                ## Can be connect with \"bridge\" network\n            # appname\n            server 172.17.0.2:80;\n}\nserver {\n    server_name be1.appname.co;\n    listen 80 ;\n    access_log /var/log/nginx/access.log vhost;\n    return 301 https://$host$request_uri;\n}\nserver {\n    server_name be1.appname.co;\n    listen 443 ssl http2 ;\n    access_log /var/log/nginx/access.log vhost;\n    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n    ssl_ciphers 'ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS';\n    ssl_prefer_server_ciphers on;\n    ssl_session_timeout 5m;\n    ssl_session_cache shared:SSL:50m;\n    ssl_session_tickets off;\n    ssl_certificate /etc/nginx/certs/be1.appname.co.crt;\n    ssl_certificate_key /etc/nginx/certs/be1.appname.co.key;\n    ssl_dhparam /etc/nginx/certs/be1.appname.co.dhparam.pem;\n    add_header Strict-Transport-Security \"max-age=31536000\";\n    include /etc/nginx/vhost.d/default;\n    location / {\n        proxy_pass http://be1.appname.co;\n    }\n}\n\n$ docker inspect --format '{{ .NetworkSettings.IPAddress }}' appname\n172.17.0.2\n```. @zodern yes the configuration was fine. I just redeployed the app with the same configuration. meteor didn't give any errors but I think it was because of one of my replica set was down. I started it again and it started working. Also I downgrade to previous version of mup too but don't know if it solvled the problem or not. I'll try tomorrow with the new version again.\nThank you for your time. @tomtom87 Hi! I'm planning to move to AWS but don't know about how to use ELB. Can I contact you with email or something. I would really appreciate if you help me.\nThanks . @tomtom87 couldn't figure out how to private message. Could you please send me an email on bennygenel gmail. ",
    "metadan": "@CaptainChemist  Did you resolve this? I'm seeing the same issue at the moment.\nedit: In my instance it seems to successfully build but then fail during the bundle.tar.gz creation.\n. ",
    "WayneUong": "I'm getting \"docker logs\" requires exactly 1 argument(s). as well\n. The bundling and deploying process is done on an EC2 server to another EC2 server.\n. It works fine when I deploy from my Mac to the EC2 Ubuntu server, but bcrypt is missing, because of the difference in architecture. However, the bundling time is much longer than 1.4.1, around 10-15 minutes.\n. I tested with a VM Ubuntu, it works, but it takes 5 minutes to bundle. Still no idea why it doesn't work on EC2 Ubuntu after updating.\n. @shadowcodex I was using an old custom build of meteord. After rebasing the latest branch, it works fine now.. We have a git repo setup for continuous deployment with mup on a remote server. Any time the repo is updated, a deployment process is automatically triggered. But every time the packages.json list is updated, we have to manually ssh to the server and run meteor npm install before mup can bundle the repo successfully with all the latest npm packages.. We can, but then we will have to inject a middle-man script just for that purpose (the other parts are all outsourced). So I'm wondering if it can be done within mup.. I can't give anything right now, as we're deploying pretty often and the logs get cleared each time. But if it gets too long I have to use --tail to get to the latest logs. Also, running docker logs directly on the server shows more logs than mup logs (only when it gets too long).. I managed to setup an AWS application load balancer. Is there a test to make sure that sticky sessions and websocket work? Thanks.. Hi @bennygenel \nwebsocket seems to work fine for us:\n\nI haven't figured out how to test sticky sessions though. Our app has been functioning normally so far. The only problem I'm dealing with is syncing cron jobs between instances.\nAWS Application Load Balancer only works with EC2 instances. I don't think you can forward traffic to external servers. But deploying to EC2 is a breeze with mup. There's also the Classic Load Balancer. I haven't tried it yet but I heard that it's a pain to deal with if you need websocket + sticky sessions.. @zodern I tried the autogenerate option for ssl. Now the second add at port 8000 works. But the default app at port 80 shows: 503 Service Temporarily Unavailable nginx/1.11.10. I tried to access the app via the public ip address. @zodern \nApp 1:\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '34.208.112.188',\n      username: 'ubuntu',\n      pem: './key-files/xxx.pem',\n      opts: {\n        port: 22\n      }\n    }\n  },\nmeteor: {\n    name: 'keelaStagingMain',\n    path: '../../nfc-meteor',\n    docker: {\n      image: 'networksforchange/meteord:base'\n    },\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n      debug: true,\n      cleanAfterBuild: true,\n      mobileSettings: {}\n    },\n    env: {\n      PORT: 80,\n      ROOT_URL: 'https://staging.xxx.co',\n      MONGO_URL: 'mongodb://xxx',\n      MONGO_OPLOG_URL: 'mongodb://xxx'\n    },\n    ssl: {\n      autogenerate: {\n        email: 'xxx@xxx.org',\n        domains: 'staging.xxx.co,donatestaging.xxx.co,subscribestaging.xxx.co,builderstaging.xxx.co'\n      }\n    },\n    enableUploadProgressBar: true,\n    deployCheckWaitTime: 60\n  }\n};\nApp 2:\nmodule.exports = {\n  servers: {\n    one: {\n      host: '34.208.112.188',\n      username: 'ubuntu',\n      pem: './key-files/xxx.pem',\n      opts: {\n        port: 22\n      }\n    }\n  },\nmeteor: {\n    name: 'keelaStagingDonate',\n    path: '../../nfc-meteor',\n    docker: {\n      image: 'networksforchange/meteord:base'\n    },\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n      debug: true,\n      cleanAfterBuild: true,\n      mobileSettings: {}\n    },\n    env: {\n      PORT: 8000,\n      ROOT_URL: 'https://donatestaging.xxx.co',\n      MONGO_URL: 'mongodb://xxx',\n      MONGO_OPLOG_URL: 'mongodb://xxx'\n    },\n    ssl: {\n      autogenerate: {\n        email: 'xxx@xxx.org',\n        domains: 'staging.xxx.co,donatestaging.xxx.co,subscribestaging.xxx.co,builderstaging.xxx.co'\n      }\n    },\n    enableUploadProgressBar: true,\n    deployCheckWaitTime: 60\n  }\n};\n``. I created a new server from scratch, then domup setupandmup deploy. It works fine now.. @zodern When the app is being deployed, I want to wait till all node processes are done before the old app is shut down and replaced with the new app.. @zodern I found out that its the--cached-buildtag that causes all the subsequent builds to be minified like the first build. So which settings are carried over and which are not with--cached-build?. @zodern you meant https://github.com/zodern/meteor-up/pull/975 ?. Theabernix/meteordone. I tried yourzodern/meteor-docker` but it does feel a bit slower. . ",
    "razlupercio": "I removed the pem field and used the ssh-agent but still have problems, what could be the problem?\n. ",
    "elie222": "ssh-agent works.\n@raz-l there were some ssh issues when upgrading to OS X Sierra (these were general issues not related to mup though. All ssh to servers stopped for a lot of people).\n. Add ssh-agent: pathtopemfile\nOn 18 Oct 2016 16:50, \"Guillaume Tisse\" notifications@github.com wrote:\n\n@elie222 https://github.com/elie222 How did you solve it?\nI made the update of OSX few hours ago but don't have any issue with ssh\nin terminal to my servers only with mup \"Error All configured\nauthentication methods failed\". Thanks\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/188#issuecomment-254513256,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AC8oX3kRaLdNmY41-d5JkKDBOo6uu2Mfks5q1M6LgaJpZM4Jc1Y_\n.\n. Did you work this out @lanmower? I'm having the same issue. \n. I just found the solution:\nhttps://github.com/kadirahq/meteor-up/issues/95\n. +100\n. @madushan1000 I see PRs are being accepted, but this one hasn't been, nor does it have a comment. Can we get an update?\n. What we do is use different mup folders for different servers. Slightly\nannoying, but works fine.\n\nElie\nOn 30 May 2017 17:59, \"Idan Wender\" notifications@github.com wrote:\n\n@artpolikarpov https://github.com/artpolikarpov Any updates on this or\nother solution?\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/pull/248#issuecomment-304906074, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AC8oX_yaNeHQrpCA9SdEujz0vUmrjJHoks5r_C7dgaJpZM4JuBXd\n.\n. What set up did you use elastic beanstalk? Does it autoscale?\n\nOn 5 Jun 2017 19:59, \"Steven Hornung\" notifications@github.com wrote:\n@artpolikarpov https://github.com/artpolikarpov Yeah, I did the same.\nStill wasn't super happy with the solution given that I was trying to use\nan outdated meteor-cluster package in parallel with this package (which has\nhad its share of ups and downs). I ended up scrapping it all and moving my\ndeployment over to AWS Elastic Beanstalk and man, what a drastic\nimprovement to deployment and scalability! Will never go back :D\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/pull/248#issuecomment-306243302, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AC8oX4fGHiw9Lnx735Z2U9bJ3CXFQ1D8ks5sBDPygaJpZM4JuBXd\n.\n. where do you add servers: true?\n. The npm package hasn't yet been updated.\n. I agree. There's a PR for this here:\nhttps://github.com/kadirahq/meteor-up/pull/248\n. No, cd .deploy is intentional. You don't want to mix deployment files with your source code (that's also the point of the mkdir .deploy line.)\n. This sounds like a major problem. Is there a solution that solves this easily?. Is this an update in mup or that has to be run on the servers manually?\nOn 8 Nov 2017 16:30, \"Chris De Rouck\" notifications@github.com wrote:\n\nAfter updating to the latest docker version the problem will probably be\nsolved by calling\ndocker system prune -af\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/391#issuecomment-342834036,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AC8oX5QNtMmTLg9LwWwOgTknNKaYdykWks5s0br7gaJpZM4K-nyE\n.\n. Any progress here?. The reason to add it as a dependency is:\n```\nNote: you are using a pure-JavaScript implementation of bcrypt.\nWhile this implementation will work correctly, it is known to be\napproximately three times slower than the native implementation.\nIn order to use the native implementation instead, run\n\nmeteor npm install --save bcrypt\nin the root directory of your application.\n```. Have this same issue. How did you end up solving it?\nGot to this:\nError response from daemon: driver \"aufs\" failed to remove root filesystem for 2198f594acd69d2561de7236d2dd223c37bdbf632505321d98a86bd3b162ec30: error preparing atomic delete of aufs mountpoint for id:. Not sure what the issue here was in the end. I think it was to do with sudo users. Comes up in the docs too.. Also running into these issues on mac. Think the last update of mup is causing them. Worked fine previously. Hi,\nNot fully following. Is it possible to use bcrypt at all or not?\nOn 22 Sep 2017 20:04, \"Kehinde Adeoya\" notifications@github.com wrote:\n\n@zodern https://github.com/zodern @kishorvaghani\nhttps://github.com/kishorvaghani , what do you suggest? I'm not a linux\nperson so many of these are vague to me. All I needed to get running is\nwhat I want. Do you suggest Debian would perform better than Ubuntu? If so,\nhelp me with the guide to deploy.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/734#issuecomment-331503760,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AC8oX1qjemDX2emRV0NGn8NgANHLS5oOks5sk-hBgaJpZM4PX5_G\n.\n. Right, I had the npm package in my package.json too, but then it started\ncrashing the server and said deploy failed.\n\nOn 24 September 2017 at 07:15, kishorvaghani notifications@github.com\nwrote:\n\n@ken4ward https://github.com/ken4ward , i am not sure which would\nperform better, but meteord having debian:jessie which is debian OS.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/734#issuecomment-331686069,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AC8oX2wQg430mUp5n57204ZNFVW8ifOcks5slddYgaJpZM4PX5_G\n.\n. Yup. I think that's the typical deploy. Mac to Linux.\n\nOn 2 Oct 2017 17:58, \"Dave M\" notifications@github.com wrote:\n\nSame here. I develop on a mac and deploy to Linux, so this is an issue.\nAnd my situation is probably not that uncommon.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/736#issuecomment-333560245,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AC8oX8Xqa6GBr2tojfYemto8rNUO4Stvks5soPn7gaJpZM4PaSAZ\n.\n. Bump. Any news on this?. Thanks. This is instead of Meteor Up?. This package has a problem with sticky sessions however. Have you used it with nginx to do the load balancing?. Seems you'd do it like this:\nhttps://github.com/andruschka/pm2-meteor/issues/55. How is the auto restarting functionality working in this package? Is it inside the docker container or handled outside of it?. Thanks. This is the line, right?\nhttps://github.com/zodern/meteor-up/blob/92d370354767c9c126589339484832fcbc0a556e/src/plugins/meteor/assets/templates/start.sh#L62. This is how we're running this process now. Created this gist if anyone else would like to use it:\nhttps://gist.github.com/elie222/10d8d830db341551612ba38ac6f32cd9\n\nThe advantage is that you do one deploy and the other 15 instances are copied really quickly without having to upload 15 times to the same server.. Also, we don't use --hostname option. Is it needed?. I get the same error. On MUP 1.3.3. As for inodes I get:\nFilesystem     Inodes IUsed IFree IUse% Mounted on\ndevtmpfs         469K   444  469K    1% /dev\ntmpfs            471K     1  471K    1% /dev/shm\n/dev/xvda1       512K  439K   74K   86% /. @realyze any luck with this so far?. @yanickrochon he has prod and staging he wants to deploy. +1. I have this same error on MUP 1.3.3 and 1.3.7.\nIssue seems to be at this line:\nFailed to connect to localhost port 80: Connection refused. This may help us:\nhttps://github.com/zodern/meteor-up/issues/818\nTrying myself now.. Nope. That didn't solve it.. How do you verify this?\nOn 5 Dec 2017 17:56, \"nickich\" notifications@github.com wrote:\nCan you please verify that the file\n'/built_app/programs/server/npm/node_modules/meteor/\nepaminond_nodemailer/node_modules/nodemailer/node_\nmodules/libmime/src/libmime.js'\nexists on the container?\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/804#issuecomment-349348366,\nor mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AC8oX709jXxs_uo2VMRPUR7v1hNF_3-Gks5s9We5gaJpZM4Qh5PV\n.\n. Got it working reverting to 1.3.3. A few hours gone. Always get headaches when I update MUP these days... Bit problematic.. I have the exact same issue.\n@brylie what's 1.3.6 has blocking bug?\nAh I found the issue you were referring to:\nhttps://github.com/zodern/meteor-up/issues/816\nI may revert to 1.3.3. Think things were working fine for me then.. I'm getting this error when attempting again:\n```\nStarted TaskList: Pushing Meteor App\n[34.xx] - Pushing Meteor App Bundle to the Server\n[34.xx] - Pushing Meteor App Bundle to the Server: SUCCESS\n[34.xx] - Prepare Bundle\n[34.xx] x Prepare Bundle: FAILED\n    -----------------------------------STDERR-----------------------------------\n    pt/bin: implausibly old time stamp 1970-01-01 00:00:00\n    tar: bundle/programs/server/npm/node_modules/meteor/iron_router/node_modules/grunt/node_modules/nopt/examples: implausibly old time stamp 1970-01-01 00:00:00\n    tar: bundle/programs/server/npm/node_modules/meteor/iron_router/node_modules/grunt/node_modules/nopt/lib: implausibly old time stamp 1970-01-01 00:00:00\n    tar: bundle/programs/server/npm/node_modules/meteor/iron_router/node_modules/grunt/node_modules/nopt/node_modules: implausibly old time stamp 1970-01-01 00:00:00\n    tar: bundle/programs/server/npm/node_modules/meteor/iron_router/node_modules/grunt/node_modules/rimraf/test: implausibly old time stamp 1970-01-01 00:00:00\n    tar: bundle/programs/server/npm/node_modules/meteor/iron_router/node_modules/grunt/node_modules/underscore.string/dist: implausibly old time stamp 1970-01-01 00:00:00\n    tar: bundle/programs/server/npm/node_modules/meteor/iron_router/node_modules/grunt/node_modules/underscore.string/lib: implausibly old time stamp 197\n    -----------------------------------STDOUT-----------------------------------\n    node-8.4.0-base: Pulling from abernix/meteord\n    Digest: sha256:04f44cf999da383d11de77027ced8b70818222c9890a405ce10803af3ee5a642\n    Status: Image is up to date for abernix/meteord:node-8.4.0-base\n    draftapp\n    ----------------------------------------------------------------------------\n\n. verbose output:\ntar: bundle: implausibly old time stamp 1970-01-01 00:00:00\nbash: line 28: Dockerfile: Permission denied\n[34.xx] x Prepare Bundle: FAILED\n    -----------------------------------STDERR-----------------------------------\n    ld time stamp 1970-01-01 00:00:00\n    tar: bundle/programs/server/npm/node_modules/meteor/sacha_juice/node_modules/juice/node_modules/web-resource-inliner/node_modules/request/node_modules/bl/node_modules/readable-stream/node_modules/isarray/build: implausibly old time stamp 1970-01-01 00:00:00\n    tar: bundle/programs/server/npm/node_modules/meteor/reywood_publish-composite/node_modules/eslint/node_modules/file-entry-cache/node_modules/flat-cache/node_modules/del/node_modules/globby/node_modules/array-union/node_modules/array-uniq: implausibly old time stamp 1970-01-01 00:00:00\n    tar: bundle/programs/server/npm/node_modules/meteor/reywood_publish-composite/node_modules/eslint-config-airbnb/node_modules/eslint-plugin-import/node_modules/eslint-module-utils/node_modules/pkg-dir/node_modules/find-up/node_modules/pinkie-promise/node_modules/pinkie: implausibly old time stamp 1970-01-01 00:00:00\n    tar: bundle: implausibly old time stamp 1970-01-01 00:00:00\n    bash: line 28: Dockerfile: Permission denied\n    -----------------------------------STDOUT-----------------------------------\n    node-8.4.0-base: Pulling from abernix/meteord\n    Digest: sha256:04f44cf999da383d11de77027ced8b70818222c9890a405ce10803af3ee5a642\n    Status: Image is up to date for abernix/meteord:node-8.4.0-base\n    draftapp\n    ----------------------------------------------------------------------------\n\n```. Randomly having this issue again. On the latest version of mup. No idea what's up with it. Trying different things to get it working. Very annoying. So I think it has to do with the device running out of space.\nCheck how much space you have left:\ndf -h\nTo free up space from docker run:\ndocker system prune. Annoying. Exact same issue here. Tried a sudo reboot and mup setup and mup deploy but still no luck.. For us the issue was unrelated. Other updates had happened that were\ncrashing this server based on its settings. It was just very unclear where\nthe issue was coming from. The error logs didn't help at all.\nWe did follow all the different steps recommended here however too.\nOn 15 Dec 2017 07:36, \"Jonathan Goley\" notifications@github.com wrote:\n\n@elie222 https://github.com/elie222 Did you figure out the cause of\nthis issue? I'm experiencing it too.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/824#issuecomment-351918302,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AC8oX2Fe4IqJwIDWQXqhCBzyXS8_lk52ks5tAgV5gaJpZM4Qz6Nt\n.\n. Also interested to know about this.. This may help you:\nhttps://gist.github.com/elie222/10d8d830db341551612ba38ac6f32cd9\n\nAnd:\nhttps://github.com/zodern/meteor-up/issues/741\nWas hoping there were some updates to this item by now, but don't think there is.. I don't know about stopAppDuringPrepareBundle\nWould need to take a look. Would it help?\nAnd yes, was thinking the same thing about the private docker registry\napproach. I'd be interested in playing with that myself if you could point\nme to a good place to look in the code.\nOn Thu, 20 Sep 2018, 05:30 zodern, notifications@github.com wrote:\n\nDo you have the stopAppDuringPrepareBundle option set to false? I can\nlook into uploading in parallel when it is set to false.\nAn idea I've been considering is having an option for Meteor Up setup a\nprivate Docker registry. Mup could upload the bundle to one server, build\nthe image, and push it to the registry. All of the other servers could then\npull it from the registry.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/1010#issuecomment-423019718,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AC8oX-hBe_CQzUMho-8Zu5QMumVPuGEQks5ucv3UgaJpZM4WxLK0\n.\n. > It uploads to each server listed in app.servers\n\nSo to upload to 2 different ports on the same server it would perform 2 uploads?\nWe wrote a script to handle this ourselves in the past, but was hoping it would have been native functionality as the script has its disadvantages. For others looking:\nhttps://gist.github.com/elie222/10d8d830db341551612ba38ac6f32cd9. ",
    "twavis": "+1, been searching for this for over an hour, so glad to come across this\n. ",
    "lyquocnam": "+1\n. ",
    "GoChaToken": "Yeah. I find the process which binds the port and kill the process. The error is fixed.\nThanks for help!\n. ",
    "estebanutz": "@lyquocnam Your mup.js should be inside the .deploy folder\n. @LeG3nDz Have you tried upgrading your local version of \"npm-bcrypt\" I was experiencing the same issues and upgrading to the latest version fixed it for me. \"meteor update npm-bcrypt\" \n. @Errbel Check out your mup.js file in .deploy and make sure the \"path:\" it's pointing to the root of your project, it looks like it's trying to go to .deploy\\Usersgnogn_000DesktopmyProject instead of \"\\Usersgnogn_000DesktopmyProject\" See if that helps\n. Have you tried using a relative path instead of absolute on your \"path:\"? Other than that I'm not sure I can help you out I develop on a mac machine so I'm not familiar with windows.\n. ",
    "jacquesblom404": "@SachaG I am experiencing this same issue. I can replicate this issue with a new Meteor 1.4.0.1 project on a new Ubuntu server.\nmup.js:\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: \"SeverIP\",\n      username: \"root\",\n      pem: \"/Users/USERNAME/.ssh/id_rsa\",\n    },\n  },\nmeteor: {\n    name: \"APPNAME\",\n    path: \"../\",\n    servers: {\n      one: {},\n    },\n    env: {\n      ROOT_URL: \"https://URL\",\n      MONGO_URL: \"mongodb://mongodb:27017/APPNAME\",\n      PORT: 3000\n    },\n    dockerImage: \"jacquesbl/meteord\",\n    deployCheckWaitTime: 120\n  },\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n``\n. @SachaG I have modifiedmupxto use a docker image which works with Meteor 1.4+ and am now using that to deploy the apps which are failing withmup`.\nI am still looking into the mup issue. Are you still experiencing it?\n. @SachaG, @queso Clone the repo and look for instances of meteorhacks/meteord:base with kadirahq/meteord (in templates/linux/start.sh). Then install your cloned version of mupx. Let me know if that works for you.\n. ",
    "queso": "Is there a setting to change the mupx docker image? Or is it hard coded into the npm src somewhere @jacquesblom404?\n. ",
    "emilbryggare": "@SachaG: I think mup is not setting up you environment variables correctly.\nOn the server verify that /opt/$APPNAME/config/env.list exists and is up to date with mup.js and settings.json.\nI'm guessing the reason it worked for @madushan1000 is because he used the sample.settings.json while you used Telescopes production settings.json. Another guess of mine is that your production settings.json have trailing commas. (Or some other formatting that mup does not support)\nAfter this output from mup\n[1.1.1.1] - Pushing the Startup Script\n[1.1.1.1] - Pushing the Startup Script: SUCCESS\nthis output is expected, but never shown in your comments above.\nStarted TaskList: Configuring  Meteor Environment Variables\n[1.1.1.1] - Sending Environment Variables\n[1.1.1.1] - Sending Environment Variables: SUCCESS\nA lot of guesses from my side. But I hope it will help you pinpoint the problem. It helped me solve mine here.\n. @reel: I think the same issue is discussed here ISSUE-238.\nI had this problem and solved it as described here. \nHope it helps.\n. +1 - Same problem for me.\nTested on a fresh installation of Ubuntu 14.04.\n. It works for me now. \nThe problem for me was that I had \"trailing commas\" in my settings.json.\n{\n  \"public\": {\n   \"analyticsSettings\": {\n      \"Google Analytics\" : {\"trackingId\": \"XXXX\"},\n    }\n  }\n}\nchanged to\n{\n  \"public\": {\n   \"analyticsSettings\": {\n      \"Google Analytics\" : {\"trackingId\": \"XXXX\"}\n    }\n  }\n}\n```\n\nmup reconfig\nStarted TaskList: Configuring  Meteor Environment Variables\n[1.1.1.1] - Sending Environment Variables\n[1.1.1.1] - Sending Environment Variables: SUCCESS\n```\n\nHope it helps. \n. Hm, ok. Have you tried with a settings.json just containing {}? \n\nOn 30 Aug 2016, at 16:53, Venelin notifications@github.com wrote:\nI do not think that the issue is related with the training commas in the settings as I am not using at all the settings.json\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub, or mute the thread.\n. See end of https://github.com/kadirahq/meteor-up/issues/195 for more information regarding problems with missing settings.json. \n. See end of https://github.com/kadirahq/meteor-up/issues/195 for more information regarding problems with missing settings.json. \nOn 30 Aug 2016, at 16:53, Venelin notifications@github.com wrote:\nI do not think that the issue is related with the training commas in the settings as I am not using at all the settings.json\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub, or mute the thread.\n. \n",
    "thomasspiesser": "For me it was new-lines in settings.json that prevented mup from creating the /opt/$APPNAME/config/env.list file.\n. @SachaG did you try with a settings file that just contains {} or completely w/o one?\n. @SachaG glad it works now :) let us know how it goes with your actual app.\n. ",
    "pablovilla83": "Extra , in the public section of the settings JSON (invalid) makes the deploy fail. It appears the \"No such container\" line is written during the mup setup phase, tested on a new box. Better error handling would be appreciated :) - it would be awesome if the settings and config files are checked before the build kicks off. ",
    "codeHatcher": "@madushan1000 although I agree this is a problem with other directories, it makes sense that you go and merge this one at least. This is literally the problem raised in #291, #286, #135, #87, #245, #42, #222, #179 with the oldest one being 9 months old\n. @yasinishyn hahahaha, I'm having this same problem with another deploy!!! funny finding you here\n. If you need to keep the bcrypt package and also use Meteor 1.4 I would highly recommend using the v1.4-build tag of https://github.com/CyCoreSystems/docker-meteor from @Ulexus\n. @ivandaho which version of Meteor are you trying to deploy?. @wwlweihai your link is not active\n. @blainehansen, can you post your entire log?\n. @blainehansen definitely, for me it was trying to run make and didn't have build-essentials. That's why you really have to look at the entire logs\n@kyle-rader that seems odd, I thought most bash stuff was still compatible with zsh (i'm using zsh here)\n. Maybe it's because I'm use to the old version of mup and mupx I don't see the feedback I'm expecting. When I deploy, only the following happens when I expect to see much more\n\nmup.js for reference\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: \"198.199.79.88\",\n      username: \"root\",\n      pem: \"~/.ssh/id_rsa.pem\",\n      // pem:\n      // password:\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\nmeteor: {\n    name: 'app',\n    path: '/Users/avi/Code/dashboard/app',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: '198.199.79.88',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n//dockerImage: 'kadirahq/meteord'\ndeployCheckWaitTime: 60\n\n},\n};\n``\n. I created a new server and just did mup setup mup deploy and it seemed to work. Never truly figured it out but I appreciate the follow up . post your logs, I would also look at a swapfile issue (if your instance doesn't have enough RAM and doesn't have a swap file you won't be able to deploy)\n. This is not intuitive, I had to change mymeteor.env.PORTproperty in order to get this to work the way I wanted. It seems to be completely independent of themeteor.port` property. Is this the intended use, if so it needs to be cleared up in the README. If not then it may need to be fixed to act inline with the README\nHere is the equivalent config that works\n``` js\nmodule.exports = {\n  servers: {\n    one: {\n      host: \"107.175.239.xxx\",\n      username: \"root\",\n      pem: \"/Users/avi/.ssh/id_rsa.pem\",\n    }\n  },\nmeteor: {\n    name: 'dashboard',\n    //port: 2080,\n    path: '../../',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n      cleanAfterBuild: true,\n    },\n    env: {\n      PORT: 2080,\n      ROOT_URL: 'http://107.175.239.xxx',\n      MONGO_URL: 'mongodb://localhost:27017'\n    },\n    docker: {\n      image: 'abernix/meteord:base',\n      //image: 'kadirahq/meteord',\n      //image: 'ulexus/meteor:v1.4',\n    },\n    // dockerImage: 'abernix/meteord:base',\n    deployCheckWaitTime: 120\n  },\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n```\nwhich results in \nshell\nCONTAINER ID        IMAGE                  COMMAND                  CREATED              STATUS              PORTS                        NAMES\n98726778e737        abernix/meteord:base   \"/bin/sh -c 'bash $ME\"   About a minute ago   Up About a minute   0.0.0.0:2080->80/tcp         dashboard\ne876172cf7f3        mongo                  \"/entrypoint.sh mongo\"   4 hours ago          Up 4 hours          127.0.0.1:27017->27017/tcp   mongodb\n. Can you share your mup file?. Yes, that's what I mentioned above as well. @prafulc did that solve the problem for you?. @srimenow I'm seeing this same problem, something I didn't see even a few weeks ago. Did you find a solution?. I ended up resolving this problem myself by tweaking the security group in my AWS instance. @csellis it's been a while since I did this but I think I had to open up a couple ports in my AWS security group. You can see if that's the issue by opening ALL ports (not recommended for production) and see if you are able to deploy. @zodern if you let me know the port I can add it to the documentation. I never found out the required port. @zodern any thoughts on where I can find this, I don't mind adding it to the docs. hmmm, maybe what I was seeing was a coincidence with changing the port and then having it start working?. I'll play around with it a little bit and then come back here. I don't remember the context of all of this so I'm going to go ahead and close the issue. Just to summarize it seems my deploy to AWS didn't work until I edited the security groups to allow incoming and outgoing traffic on all ports. I don't know if that actually made a difference or if there was some other issue and it ended up being a coincidence on why it started working. I was just about to make this \"issue\". Sidenote: does anyone know zodern's name on twitter?. thanks for the reply, appreciate you taking over this repo. I'm having this issue as well, perhaps an option that is redirect-ssl: true in the meantime I'll give force-ssl a shot. force-ssl package didn't work for me, is it possible because I'm running on port 8443 instead of 443 (although I don't believe that should really matter) I have two meteor apps running on the same instance sharing a database, one that runs on 443 and one that runs on 8443 (portal). . Has anyone had luck deploying mup where the load balancer has a valid certificate but deploying to mup without a certificate. \nI want to then add a CNAME record to the load balancer to get something like beta.company.com so that when a user goes to beta.company.com it goes to the load balancer. I have everything setup AFAIK such that when I go to the load balancer address it seems to be working with the secure connection but when I go to beta.company.com it says \n\n. @PolGuixe try setting up a swap file on your instance and then trying it. I had a similar issue on DO due to insufficient memory. @zodern, nice! Going to try this out just now as I was about to ask the same question. @zodern @iAssureIT that worked for me just as a heads up. I just started to experience this today and I've done multiple deployments over the past months, @noahsw did you figure out what the problem was?. adding the following to my .ssh/config file fixed it for me, I think....\nHost *\n  UseKeychain yes\n  AddKeysToAgent yes\n  IdentityFile=~/.ssh/id_rsa\n  IdentityFile=~/.ssh/id_rsa.pem\nI'm on macOS Sierra btw. Ahhh, I'm going through something similar right now. Looking for a good way to route http to https without adding another nginx instance in front. @SharadKumar suggestion of meteorblackbelt:force-ssl worked for me. For others who stumble here, my problem was I needed to:\n1. use https://github.com/meteorblackbelt/meteor-force-ssl instead of the MDG one (I don't know why)\n2. my ROOT_URL was incorrect and needed to be my https domain, not the ip address of the server since it seems force-ssl package uses that to redirect\n@zodern what would it take to add a config to mup.js that would add redirect directives into nginx? If you give me some specific tasks to work on or would be willing to pair abit, I have some time I could direct to this since I have gotten so much use out of this repo. Oh wow, good teamwork here\nI'd still love to make it into a mupjs option if possible. Point me in the right direction and I'd love to contribute . I had this problem also, this package worked for me https://github.com/meteorblackbelt/meteor-force-ssl make sure you have your URL set correct in the mup.js and you should be good to go. I had this error recently, I don't suppose you are using the force-ssl package that is recommended by MDG?. ",
    "Sivli-Embir": "This also happened to me on MacOS, successfully setup but error on deploy. Issue was a malformed meteor path.\n. ",
    "DiesIrae": "But is it normal that it fails to redeploy it every time?\n. I have a previous version, so there's a bug somewhere. Here are some logs, when I put for example a bad mongoUrl (but the behavior is for any error):\n```\n$ mup deploy                                                                                                                         10:39:21\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor\n[engine.matcha.wine] - Pushing Meteor App Bundle to The Server\n[engine.matcha.wine] - Pushing Meteor App Bundle to The Server: SUCCESS\n[engine.matcha.wine] - Pushing the Startup Script\n[engine.matcha.wine] - Pushing the Startup Script: SUCCESS\n{}\nStarted TaskList: Configuring  Meteor Environment Variables\n[engine.matcha.wine] - Sending Environment Variables\n[engine.matcha.wine] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[engine.matcha.wine] - Start Meteor\n[engine.matcha.wine] - Start Meteor: SUCCESS\n[engine.matcha.wine] - Verifying Deployment\n[engine.matcha.wine] x Verifying Deployment: FAILED\n    -----------------------------------STDERR-----------------------------------\n    all.node_modules.meteor.accounts-base.server_main.js (packages/accounts-base/server_main.js:9:12)\n        at fileEvaluate (packages/modules-runtime/.npm/package/node_modules/install/install.js:153:1)\n        - - - - -\n        at [object Object].<anonymous> (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/topologies/server.js:295:35)\n        at emitOne (events.js:77:13)\n        at [object Object].emit (events.js:169:7)\n        at [object Object].<anonymous> (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/pool.js:251:12)\n        at [object Object].g (events.js:260:16)\n        at emitTwo (events.js:87:13)\n        at [object Object].emit (events.js:172:7)\n        at Socket.<anonymous> (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/connection.js:150:49)\n        at Socket.g (events.js:260:16)\n        at emitOne (events.js:77:13)\n\n    => Redeploying previous version of the app\n\n    -----------------------------------STDOUT-----------------------------------\n\n    To see more logs type 'mup logs --tail=50'\n\n    ----------------------------------------------------------------------------\n\n```\nI'm on node 6.3.1, mup 1.0.2, but it has always been the same, even with previous versions.\n. ",
    "asafshen": "@DiesIrae same stderr for me..\ndid you have any advice? \nthanks\n. ",
    "Endtry": "Is there a fix for this issue? I am having the exact same error on my deploy using kadirahq/meteor-up with node 4.5.0 on Amazon EC2\n. ",
    "lhz516": "@madushan1000 Here's my mup.js file.\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '0.0.0.0',\n      username: 'ubuntu',\n      pem: '../../example.pem'\n      // password:\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\nmeteor: {\n    name: 'myApp',\n    path: '../',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      // serverOnly: true\n      // debug: true,\n      // mobileSettings: {\n      //   yourMobileSetting: \"setting value\"\n      // }\n    },\n    env: {\n      ROOT_URL: 'http://subdomain.example.com',\n      MONGO_URL: 'mongodb://my_external_mongo_url'\n    },\ndockerImage: 'abernix/meteord:base',\ndeployCheckWaitTime: 30\n\n}\n};\n``\n. Hi @madushan1000 , I only saw one docker container on the server when I randocker ps`\nCONTAINER ID        IMAGE                  COMMAND                  CREATED             STATUS              PORTS                NAMES\n90ca873d65da        abernix/meteord:base   \"/bin/sh -c 'bash $ME\"   27 hours ago        Up 27 hours         0.0.0.0:80->80/tcp   myApp\nAnd when I run mup stop on my local machine. Both of the two domains were down.\nI believe that I only deployed one instance, but somehow nginx forward it to two domains.\n. @madushan1000 I didn't install nginx on the server.\nThe doc said that mup is now using nginx, but I'm not sure if mup enabled it, because I didn't config SSL in mup.js\n. @madushan1000 Fixed it. Thanks!\nClosing this issue\n. ",
    "afrantz": "Hello @madushan1000 ,\nThanks for your respsonse.\nI just tried and i get same error after mup deploy :  \n\n[myawesomeproject.com] - Pushing Meteor App Bundle to The Server\n[myawesomeproject.com] - Pushing Meteor App Bundle to The Server: SUCCESS\n[myawesomeproject.com] - Pushing the Startup Script\n[myawesomeproject.com] - Pushing the Startup Script: SUCCESS\nStarted TaskList: Configuring  Meteor Environment Variables\n[myawesomeproject.com] - Sending Environment Variables\n[myawesomeproject.com] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[myawesomeproject.com] - Start Meteor\n[myawesomeproject.com] - Start Meteor: SUCCESS\n[myawesomeproject.com] - Verifying Deployment\n[myawesomeproject.com] x Verifying Deployment: FAILED\n```\n    -----------------------------------STDERR-----------------------------------\n    package.json meteor-dev-bundle@0.0.0 No description\n    npm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No README data\nnpm WARN cannot run in wd meteor-dev-bundle@0.0.0 node npm-rebuild.js (wd=/bundle/bundle/programs/server)\n=> Starting meteor app on port:80\n\nassert.js:93\n  throw new assert.AssertionError({\n        ^\nAssertionError: \"undefined\" === \"function\"\n    at wrapPathFunction (/bundle/bundle/programs/server/mini-files.js:77:10)\n    at Object.<anonymous> (/bundle/bundle/programs/server/mini-files.js:108:24)\n    at Module._compile (module.js:456:26)\n    at Object.Module._extensions..js (module.js:474:10)\n    at Module.load (module.js:356:32)\n    at Function.Module._load (module.js:312:12)\n    at Module.require (module.js:364:17)\n    at require (module.js:380:17)\n    at Object.<anonymous> (/bundle/bundle/programs/server/boot.js:9:13)\n    at Module._compile (module.js:456:26)\n\n=> Redeploying previous version of the app\n\n-----------------------------------STDOUT-----------------------------------\n\nTo see more logs type 'mup logs --tail=50'\n\n----------------------------------------------------------------------------\n\n```\n. Hello @madushan1000,\n\nThank you for your response.\nI inform you that having set the new image, I still have the same error :/.\n. ",
    "mfeuermann": "Ok thanks\n. Resolved by using different image, that image contains required packages (cairo etc..)\nromaroma/meteord. Thanks romaroma!\n. ",
    "AhmedKanany": "Hello , \ncould you give me code example to set my own timezone please ? . ",
    "Vercryger": "Any progress/fix for this?. Any progress on this?. ",
    "vangorra": "To clarify. @allenfuller is referring to the comma after the username field in the config. Took me forever to find my missing comma.\n. ",
    "mickdekkers": "Would be nice if mup printed the line number where the unexpected identifier was encountered.\n. ",
    "asakk046": "Thanks @vangorra!\n. ",
    "MattiSG": "Yes, see https://github.com/arunoda/meteor-up/issues/1056 and https://github.com/arunoda/meteor-up/issues/963 for example, and https://github.com/meteorhacks/mup-frontend-server/issues/14 for the canonical reason. Currently, the default mupx deployment is vulnerable to CVE2016-2107.\n. ",
    "nick-preda": "oh wow!\nthanks a lot, I'll try opening an issues, to ask whether it works with meteor 1.4\n. Thanks for the reply, but still nothing to do.\ntried with both\nimage: 'kadirahq/meteord'\nand\nimage: 'abernix/meteord:base'\ncould you specify how you make it work? the real parameters from your mup.js?\n. could you please show me your exact configuration of mup.js @rclai ?. OK, managed to make it work.\nIs it possible that the mup with ssl cannot be built because of the force-ssl package?. @sethjgore i tried going multiple times with the mup deploy, and finally it gave me no errors, and it finally worked.\ni'm using docker.image\nimage: 'abernix/meteord:base',\nand docker.imageFrontendServer\nimageFrontendServer: 'meteorhacks/mup-frontend-server',\nand for the buildOptions, i've got:\nserverOnly: true,\ndebug: true,\ncleanAfterBuild: true, \nallowIncompatibleUpdates: true,\nfor the env, i've got the ROOT_URL the link starting with https, of my real domain.\ni've also have\ndeployCheckWaitTime: 120,\n    deployCheckPort: 80,\n    enableUploadProgressBar: true\nit sometimes gives me error, during the mup deploy, but relaunching the command everything works, and going to the https everything works.\n...still, have to understand how to enforce redirect, from http to https.\nhope this helps somehow\nEDIT: i'm using the beta: npm i -g mup@1.2.7-beta.0. @wizonesolutions if I add this package, mup deploy gives me a bunch of errors. tried it, and re-tried again.\nis it working for you?. oops @wizonesolutions hahaha\ni meant @ziedmahdi . adding force-ssl it always gives me the same error:\n```\n[x.x.x.x] x Start Meteor: FAILED\n-----------------------------------STDERR-----------------------------------\nError response from daemon: endpoint app not found\nError response from daemon: No such container: app-frontend\nError response from daemon: endpoint app-frontend not found\nError response from daemon: endpoint app-nginx-letsencrypt not found\nError response from daemon: endpoint app-nginx-proxy not found\n--2017-05-02 17:43:25--  https://raw.githubusercontent.com/jwilder/nginx-proxy/master/nginx.tmpl\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.128.133, 151.101.0.133, 151.101.192.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.128.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 10088 (9.9K) [text/plain]\nSaving to: \u2018/opt/app/config/nginx.tmpl\u2019\n\n     0K .........                                             100% 24.9M=0s\n\n2017-05-02 17:43:25 (24.9 MB/s) - \u2018/opt/app/config/nginx.tmpl\u2019 saved [10088/10088]\n\ndocker: Error response from daemon: grpc: the connection is unavailable.\n-----------------------------------STDOUT-----------------------------------\n\n```. finally it deployed on my server, with the basic force-ssl package, but the redirect on the https just didn't happen.\ni finally tried out another package, the meteorblackbelt:force-ssl and everything worked right away.. ",
    "cunneen": "OK thanks @madushan1000 .\n. Thanks @zodern and @stuartlangridge. We've had success with this on a t2.small ec2 instance :\nhttps://github.com/lmachens/meteor-apm-server\nIt's kadira, the same as node chef's meteor apm AFAICT.. Your config looks OK to me. In the 'security' tab of your Atlas web console, under 'IP whitelist', have you enabled access to  your app server machine's IP address ?\n. (In Atlas) Temporarily try allowing all IP's. If your meteor server can connect, then that is the issue.. No. I mean add 0.0.0.0/0 to allow all IP addresses.. ",
    "yogiben": "@madushan1000 I can't find that branch.\nCould you push or better yet merge, push and publish to npm :)\n. Thanks.\nI know this might be asking a lot, but is it possible to use the let's encrypt functionality AND solve this problem?\nIf you point me to the part of the code that sets up the HTTP -> HTTPS redirect, I could probably do a PR with a forceSSL option.. ",
    "xanatas": "Info:\nAccording to the README, this implementation is approximately 2.7 times\nslower than native: https://www.npmjs.com/package/bcryptjs\nApps that wish to continue using the native bcrypt package should run\nmeteor npm install --save bcrypt in the root application directory, and\nthe npm-bcrypt package will prefer that implementation.\n. +1 Confirmed!\n. ",
    "martinhbramwell": "This seems to be a useful clue about what might be happening . . . \nFATA[0001] Your Linux kernel version 2.6.32-042stab116.2 is not supported for running docker. Please upgrade your kernel to 3.10.0 or newer.\n. Docker requires minimum kernel of 3.10.\nVPS hosting has OpenVZ which is still at 2.6.32 and won't be upgrading any time soon.\nI have a VPS from a different provider which is KVM based and far superior.  I just got mup setup to work on it.\nYour input is appreciated.  Thanks.\n. I gave up on meteor-up a long time ago.  Hopefully someone else can help ... but 80 unresolved issues! Yikes!. Ok, I got past this problem after finding this : \n[1.4] mup: errors in production (AssertionError: \"undefined\" === \"function\")\n. It means that a secure shell connection like ...\nssh root@192.168.xxx.xxx\n... that replies to the password prompt with 'xxx', does not succeed.\nSince you are on Windows, you need to ensure that you can open a working secure shell connection, as root to that server, with Putty, I suppose.\nUID/Pwd are possible with SSH servers but very strongly discouraged.  You really should use SSH keys.\nI do not use root. I created a distinct user on the server that is enabled to do mup work -- exclusively.  I set the SSH daemon configuration to prohibit remote root logins and to prohibit password based logins.\nIf this is all new to you, trust me, your best bet is use mup from within an Ubuntu virtual machine, in your Windows machine.  I believe you will lose a lot of time trying to work through all the weirdness of Windows for this kind of work.\nAlternatively, and much wiser: deploy from a continuous integration service like CircleCI or Travis.\nIn the next few days, I'll be posting details of an example project that deploys with mup from CircleCI.  You can read about the first stage of that in Kickstarter gets Continuous Integration.  Look for an article, \"Kickstarter gets Continuous Deployment\".\n. If you want to see my experimentations and failures as they happen : \nMUP deploy entry point\nand \nCircleCI Build Attempts\n. No. Sorry, I did not.  I have given up on mup.  As you can see it has dozens and dozens of unresolved issues, and ignored PRs going back half a year.\n. @gabimoncha \nI no longer use Meteor.. ",
    "giovapanasiti": "I get the same error on my virtual box and the kernel is: 4.4.0-31-generic\n. Yes it did. I think the solution could be to use a new docker image. Do you know where I can find one?. ",
    "willygwu": "thanks for your reply... Let me try one more time. I cannot succeed, better to go with Ubuntu\n. ",
    "yrvlucero": "Were you able to solve this problem. I keep getting this error even if I am using ssh key. Can someone point me in the right direction in deploying meteor app to local host with SSL authentication?\n. ",
    "demiters": "Solved by putting absolute path in pem. Why does the old approach not work anymore?\nAlso, had to switch to abernix/meteord:base dockerImage to make this work with Meteor 1.4.\n. ",
    "henryj": "mup definitely should provide a better error message or fix this path issue.\n. ",
    "Errbel": "Yes you're wright @estebanutz, but hereafter my mup.js file : \nmodule.exports = {\n  servers: {\n    one: {\n      host: 'xx.xx.xx.xxx',\n      username: 'yyy',\n      // pem:\n      password: 'yyy'\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\nmeteor: {\n    name: 'myProject',\n    path: 'C:\\Users\\gnogn_000\\Desktop\\myProject',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      //serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'http://myProject.com',\n      MONGO_URL: 'mongodb://localhost/meteor',\n      MAIL_URL: \"smtp://xxxxx\"\n    },\n```\ndockerImage: 'abernix/meteord:base',//'kadirahq/meteord',\ndeployCheckWaitTime: 60,\n// show a progress bar while uploading. \n// Make it false when you deploy using a CI box.\n\"enableUploadProgressBar\": true\n```\n},\n/mongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },/\n};\nWhat am I doing wrong in the \"path\" definition ?\nI tried several others ways like '....\\myProject' etc... but seems that mup always try to go to .deploy\\xxxxx\nThx for your help\n. Ok, this is an issue in _path2.default.resolve(api.getBasePath(), config.path)\nin the mup\\lib\\modules\\meteor\\index.js file, in push() function.\nIt seems that it can't deal with '\\' character (backslash) and it concatenate both arguments !?!\nOne way to fix/deal with that is to set the PATH in mup.js file with 'escaping \\' : \npath: 'C:\\Users\\gnogn_000\\Desktop\\myProject',\nI'm new here, is there a way to fix this in mup source code project ?\n@estebanutz @madushan1000 @mnmtanish @vhf @arunoda\nOtherwise, mup works perfectly on windows 8.1 and macOsx :+1: \nThx for this tools :)\n. ",
    "dwarrenku": "After checking, rechecking and making numerous adjustments I changed the path in mup.js to '.' and it deployed successfully.\nthis is the meteor portion of mup.js for anyone else with this error:\nmeteor: {\n    name: 'app',\n    path: '.',\n    dockerImage: 'abernix/meteord:base',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'http://domain.com',\n      MONGO_URL: 'mongodb://localhost/meteor',\n      PORT: '3000'\n    },\n. ",
    "ericmagalhaes": "the problem was with graphicmagik package running over Node 4.4.7\n. ",
    "reel": "Is it fixed?\n. ",
    "asidiali": "So are you telling me I should leave MONGO_URL: 'mongodb://localhost/meteor' and then have \ndocker: {\n      image:'kadirahq/meteord',//optional\n      args:[ //optional, lets you add / overwrite any parameter on the docker run command\n        \"--link=myCustomMongoDB:myCustomMongoDB\", //linking example\n        \"--memory-reservation 200M\"//memory reservation example\n      ]\n    },\nwhere the customMongo bit is my remote mongo URL?\nIf not, could you explain a bit further? Thanks for the help.\n. I used mup setup several time already, unfortunately to no avail :/\nI've been going through the source already and that's why I'm curious if it's hard coded - as far as I could follow along (no knowledge of docker whatsoever), it seemed to just setup the local mongo instance.\nDo you (or anyone?) happen to have an example mup.js file that uses a remote db in production? It really does seem like it's just not even being recognized so I'd love to know if I'm the only one experiencing these issues when trying to deploy with a remote db, and maybe I just am using the wrong syntax or something. Not sure. \n. Thanks @MasterJames for your efforts, @ahmadsafar 's answer solved my problem. Makes total sense...I was setting up mongo anyways and overwriting it.\nThanks for the help! \n. ",
    "ahmadsafar": "just remove or comment these line in mup.js\nmongo: { // optional\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\nthen do\nmup setup\nmup deploy\nit fix my problem\n. ",
    "wwlweihai": "You can see my deploy process at meteor-deploy\n. I have solved most error in deploy process, and write a file about the deploy.You can see  at meteor-deploy\nnotice: it is chinese!\nHope this helps\n. ",
    "zeekun": "Hullo, I am having the same issue as @asidiali and have done what @MasterJames proposed but I keep getting this error\n\n. @albertonaperijr thank you, it has worked. ",
    "x5engine": "you need to add this in the docs because it is confusing!. still having this issue sadly :(\n. for anyone having this issue\njust do \ndocker ps\nthen get the id of the container that is running on port 80\nsudo docker stop ID\nand it will fix it. @davidrea just do it.. I have evberything setup and deployed but when I try to access the website from the https I get a warning on chrome : NET::ERR_CERT_AUTHORITY_INVALID\nwhich means the letsencrypt certificate wasn't verified but I didn't get the email too!. Doing mup proxy logs-le which gives the prox letsencrypt logs I get this error which clearly shows an issue.\nmup version 1.3.7\nContents of /app/letsencrypt_service_data did not change. Skipping notification '/app/signal_le_service'\n[35.238.236.162]2019-02-04 20:34:03,716:ERROR:simp_le:1446: CA marked some of the authorizations as invalid, which likely means it could not access http://example.com/.well-known/acme-challenge/X. Did you set correct path in -d example.com:path or --default_root? Are all your domains accessible from the internet? Please check your domains' DNS entries, your host's network/firewall setup and your webserver config. If a domain's DNS entry has both A and AAAA fields set up, some CAs such as Let's Encrypt will perform the challenge validation over IPv6. If your DNS provider does not answer correctly to CAA records request, Let's Encrypt won't issue a certificate for your domain (see https://letsencrypt.org/docs/caa/). Failing authorizations: https://acme-v01.api.letsencrypt.org/acme/authz/I2dHz2RyzeySycmtB2nkqUtMYTbfphXhADplGJq4wec\n[35.238.236.162]Challenge validation has failed, see error log.\nCan you clearly show what's the issue? and also say what steps should we take to setup ssl properly!\nDocs are not clear tbh\nThanks. very nice @zodern but my app bundle is taking so much time! like 30 to 30 minutes wtf seriously?. Your source code will be bundled and not as you wrote it, just in minified format and almost unusable since all variables and amost all functions get renamed... ",
    "LispyAriaro": "You may have to increase the deployCheckWaitTime in your mup.js config file. ",
    "lanmower": "it runs without error with the index.js directly from the path, which is currently saving ability to deploy\n. With dev copy npm run prepublish produces that path and it's contents\n. ",
    "mgarf": "you need to directly reference the mup npm file.\n. +1 having same issue\n. Node wasn't installed and set to 4.4.7 on the server\n. ",
    "zaklampert": "when running mup setup nothing happens - even when changing the filename and passing as a param as @Nlammertyn mentioned. \nEDIT: using a password instead of pem seemed to resolve it for me. \n. ",
    "franciscohanna92": "Could you provide your mup.js file?. @ntoka Have you found the solution to this problem? I'am facing it right now.. @Rachomir I solved it by leaving the env part without setting the PORT property (I suppose it defaults to PORT: 80 ). I don't know why this happened. My app is running on a DO Droplet. I'm using ufw firewall and I had opened the necesary ports (I followed this recomended Droplet initial configuration)\nMy mup.js file:\n```javascript\nmodule.exports = {\n  servers: {\n    one: {\n      host: '107.170.250.169',\n      username: 'root',\n      pem: '~/.ssh/id_rsa'\n    }\n  },\n  meteor: {\n    name: 'simple-stock',\n    path: '../',\n    docker: {\n      image: 'abernix/meteord:node-8.9.1-base'\n    },\n    servers: {\n      one: {},\n    },\n    buildOptions: {\n      serverOnly: true,\n      debug: false\n    },\n    env: {\n      ROOT_URL: 'http://107.170.250.169',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n    enableUploadProgressBar: true\n  },\n  mongo: {\n    version: '3.4.1',\n    servers: {\n      one: {}\n    },\n  }\n};\n```\nHope it helps!\n. @Shelagh-Lewins You may be using the wrong docker image for meteor. Can you post your mup.js file?. Try setting abernix/meteord:node-8.9.2-base as your docker image. ",
    "vmptk": "The mup.js file is:\nmodule.exports = {\n    servers: {\n        one: {\n            host: 'xxx',\n            username: 'xxx',\n            opts: {\n                port: 22\n            }\n        }\n    },\n```\nmeteor: {\n    name: 'app',\n    appName: 'app',\n    path: '/home/user//app',\n    servers: {\n        one: {}\n    },\n    buildOptions: {\n        debug: true\n    },\n    dockerImage: 'abernix/meteord:base',\n    env: {\n        PORT: 3000,\n        ROOT_URL: 'http://xxx',\n        HTTP_FORWARDED_COUNT: 1,\n        MONGO_URL: 'mongodb://localhost/app'\n    },\n    deployCheckWaitTime: 60\n},\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n        one: {},\n    },\n},\n```\n};\n. I do not think that the issue is related with the training commas in the settings as I am not using at all the settings.json\n. ",
    "quape": "for me it was trailing comma problem as well :( parsing error information in mup reconfig / mup deploy would have saved me much time.. Oh, found the problem. I had debug: true in buildOptions in mup.js config file!\n. ",
    "wolganens": "I have the same problem here.\n\n\n. There are two keys for the docker image, right?\ndocker: {\n      image:'abernix/meteord:base'//optional\n    },\ndockerImage: 'abernix/meteord:base'\nI will set both that way and post the result.\n. It works! thank you very much!\n. Try to run:\nnpm update mup -g\nand then, in your mup.js\nmeteor: {\n.....\n.....\ndocker: {\n      image:'abernix/meteord:base'//optional\n    },\ndockerImage: 'abernix/meteord:base',\n}\nOf course you don't need to specify docker image twice, but i don't know, what way is working. Sorry about my english, hope you can solve that.\n. I make it on a new mup project. My fault, it works, thank you.. I run meteor npm install --save prerender-node (a package I use), deploy without ssl configuration then I could open the app. After that I deploy again with the ssl config and now its all working again... ",
    "B-Stewart": "Same issue here.\n. ",
    "JanvanCasteren": "I can confirm: using abernix/meteord:base solves the problem.\nMy site is running now, my first meteor app. Thanks for the good work.\n. ",
    "softwarerero": "Thank you, I think it was docker: { image:'abernix/meteord:base' }that did the trick.\n. ",
    "fidergo-stephane-gourichon": "Bug is not actually closed as long as people continue to run into problems.\nCurrent README.md says docker: { image: ... is optional.\n  image: 'kadirahq/meteord', // (optional)\n  // image: 'abernix/meteord:base', // use this image if using Meteor 1.4+\n  args:[ // lets you add/overwrite any parameter on the docker run command (optional)\n\n. Hello. Just passing by. Can you clarify? Possibly see http://sqa.stackexchange.com/questions/1920/best-guidelines-for-bug-reporting including http://sqa.stackexchange.com/a/1943. ",
    "etyp": "+1 - @madushan1000  any chance we can get #248 merged in?\n. +1\n. Working on this now. See my comment in #336 .....open to insights/ideas here, definitely need the help.\n. @timbrandin going to start working on something similar this weekend. Let me know if you have any ideas on setup :)\n. I've added an option in the Meteor config under buildOptions:\njs\nbuildOptions: {\n  buildLocation: '/tmp/some-build-name',\n  deployCachedBuild: true,\n},\nIf deployCachedBuild is set to true and buildLocation is set to something, then it will use an existing bundle.\nSee it here\nIt works no problem as a proof of concept, but I think ideally I'd want to separate the push command into build and push (to avoid manually switching a flag in config file for new builds). Experimenting and running tests now, will provide updates here.\nOpen to any insights/ideas.\n. Haha yea you read my mind. You can pass a --rebuild flag and it will force a rebuild (latest branch on that fork). It's saved us hours already this week :) \n. @zodern let me know if you need any help with getting 1.2.4 out the door (triage, documentation, etc .). @FrancisBou you can already. See mup reconfig:\nhttps://github.com/kadirahq/meteor-up#other-utility-commands\n. @edemaine as far as I can tell, the cleanAfterBuild option is not actually implemented anywhere in the code. I think the option in the readme is there because it used to exist in older versions of mup but now does not.\n. ",
    "stevenhornung": "Any updates here? Would love to get this feature merged!. @artpolikarpov Yeah, I did the same. Still wasn't super happy with the solution given that I was trying to use an outdated meteor-cluster package in parallel with this package (which has had its share of ups and downs). I ended up scrapping it all and moving my deployment over to AWS Elastic Beanstalk and man, what a drastic improvement to deployment and scalability! Will never go back :D. ",
    "sidzan": "Has this feature been implemented yet? Cheers!. ",
    "gantrim": "I was having the same issue. I was able to get 'mup setup' to work by providing a password for the remote server instead of the keyfile:\nmodule.exports = {\n  servers: {\n    one: {\n      host: 'xxx.xxx.xxx.xxx',\n      username: 'root',\n      password:\"*********\" <-------- this works\n      //pem: '~/.ssh/id_rsa' <----- this did not work\n      //.....\nI haven't had the time to figure out why this is the case, but I'm thinking it may have something to do with the tilde in the path. I'm going to try an absolute path next and see if that fixes anything.\n. I can confirm as well. Using an absolute path has fixed this issue for me. On OSX, I changed \n//...\nservers: {\n        one: {\n           //...\n            \"pem\": \"~/.ssh/id_rsa\",\n            //...\n        }\n    },\n//...\nto:\n//...\nservers: {\n        one: {\n           //...\n           \"pem\": \"/Users/<MY_USER_NAME>/.ssh/id_rsa\",\n            //...\n        }\n    },\n//...\nand everything runs smoothly. Not ideal, but also a pretty simple fix.\n. I am experiencing a similar issue with meteor 1.6, using abernix/meteord:node-8.4.0-base Deploy goes well until verifying deployment. When I run it with --verbose the curl call fails because its trying to ping port 80 instead of 8445 which is what i have set up in my mup js file. I've been using mup and port 8445 for over a year now so I'm not sure what changed with the upgrade to 1.6. Worth noting that I'm trying to deploy to a digital ocean image.. ",
    "MarcPer": "I had this issue as well and solved it by changing ~ (tilde) in the pem path to the explicit home directory /home/my-user/.\n. ",
    "splex7": "+1, Yes gantrim's solution is finely works. \n. ",
    "erdgrau": "Solution is: \n1. docker exec -it < app name > bash\n2. cd dev/< app name >/.uploads\n. ",
    "blackslate": "npm is already at version 3\nnpm -version\n3.10.3\n. ",
    "vbelolapotkov": "@stevenhornung could you share your experience with elastic beanstalk? any guides or useful link on how set it up?. ",
    "jkdowdle": "Thank you very much for getting back to me, I appreciate it!\n. It appears that this problem was unrelated to Mup. \nI was having an issue where Meteor was trying to install meteor-tools@1.4.0-1, but would never finish the installation. Therefor when mup tried to build it locally, it never could. \nAnyway I fixed the problem by updating Git, following the advice given by NenadPavlov under this post - https://github.com/meteor/meteor/issues/7688. \n. ",
    "oychao": "@madushan1000 Thk you very much.\n. ",
    "yasinishyn": "+\n. ",
    "Fuseques": "same happens to me.\n. i deployed on scalingo for now, they support meteor and relatively cheap i think?\nhttps://scalingo.com/meteorjs-hosting\n. ",
    "derek-fong": "+1 I am having the same problem. \n. @sonuterrific \nhttps://github.com/arunoda/meteor-up/issues/1091\n. ",
    "twanc": "https://github.com/kadirahq/meteor-up/pull/292\n. Can be also related to https://github.com/kadirahq/meteor-up/pull/292\n. Probably you don't do it within .deploy folder. Try to move mup.js to .deploy according to documentation.\n. ",
    "miranos": "I have similar problem, any fix ?. ",
    "kponda": "247\n. ",
    "xjonsson": "@stefanve Recently had a similar situation, make sure you have Docker installed on your server.\nsudo apt-get update; sudo apt-get install -y -q docker-engine\n. ",
    "FinnFrotscher": "+1 for the docker problem \nand +1 for the ssl letsencrypt problem\n. I tried that. Didnt work.\nI created the .pem with cat fullchain.pem privkey.pem > ssl.pm. befor that i usedcertificate and key\nAlso the errors i get are mostly related toports beeing used already.\n. And for the docker: I killed every process that came with docker ps. still the same error.\n. @stefanve can you deploy your app with mupx and ssl? If so, could you share your mup.json?\n. Downgraded to 1.3.5.1, mupx deploy. it works\n. ```\nFinns:App Finn$ mup init\nFinns:App Finn$ mup setup\nStarted TaskList: Setup Docker\n[138.68.68.xxx] - setup docker\n[138.68.68.xxx] - setup docker: SUCCESS\nStarted TaskList: Setup Meteor\n[138.68.68.xxx] - Setup Environment\n[138.68.68.xxx] - Setup Environment: SUCCESS\n[138.68.68.xxx] - Copying SSL Certificate Bundle\n[138.68.68.xxx] - Copying SSL Certificate Bundle: SUCCESS\n[138.68.68.xxx] - Copying SSL Private Key\n[138.68.68.xxx] - Copying SSL Private Key: SUCCESS\n[138.68.68.xxx] - Verifying SSL Configurations\n[138.68.68.xxx] - Verifying SSL Configurations: SUCCESS\nFinns:App Finn$ mup deploy\nBuilding App Bundle Locally\nFinns:App Finn$\n```\nNow the process just dies quietly.\nThis is the mup.js file\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '138.68.68.xxx',\n      username: 'root'\n      // I have SSH set up globally.\n    }\n  },\nmeteor: {\n    name: 'App',\n    path: '../App',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    dockerImage: 'abernix/meteord:base',\n    deployCheckWaitTime: 60,\n    ssl: {\n      crt: 'ssl/ssl.pem', \n      key: 'ssl/ssl.pem',\n      port: 443\n    }\n  },\n};\n.\nFinns:App Finn$ DEBUG=* mup deploy\n  mup:module:default exec => mup deploy +0ms\n  mup:module:meteor exec => mup meteor deploy +1ms\n  mup:module:meteor exec => mup meteor push +2ms\nBuilding App Bundle Locally\nFinnS:App  Finn$\n```\nAnd when I try to access the mup logs:\n[46.101.198.xxx]Error: No such container: App\n. In #https://github.com/kadirahq/meteor-up/issues/189 the issue is his ssh .pem file. I dont have that. My ssh is global.\n. This is what happens when i try with mupx:\n```\nFinns:App Finn$ mupx setup\nMeteor Up: Production Quality Meteor Deployments\nConfiguration file : mup.json\nSettings file      : settings.json\n\u201c Checkout Kadira!\n  It's the best way to monitor performance of your app.\n  Visit: https://kadira.io/mup \u201d\nStarted TaskList: Setup (linux)\n[46.101.198.xxx] - Installing Docker\n[46.101.198.xxx] - Installing Docker: SUCCESS\n[46.101.198.xxx] - Setting up Environment\n[46.101.198.xxx] - Setting up Environment: SUCCESS\n[46.101.198.xxx] - Copying MongoDB configuration\n[46.101.198.xxx] - Copying MongoDB configuration: SUCCESS\n[46.101.198.xxx] - Installing MongoDB\n[46.101.198.xxx] - Installing MongoDB: SUCCESS\n[46.101.198.xxx] - Copying SSL certificate bundle\n[46.101.198.xxx] - Copying SSL certificate bundle: SUCCESS\n[46.101.198.xxx] - Copying SSL private key\n[46.101.198.xxx] - Copying SSL private key: SUCCESS\n[46.101.198.xxx] - Verifying SSL configurations\n[46.101.198.xxx] - Verifying SSL configurations: SUCCESS\nFinns-MBP-4:App Finn$ mupx deploy\nMeteor Up: Production Quality Meteor Deployments\nConfiguration file : mup.json\nSettings file      : settings.json\n\u201c Checkout Kadira!\n  It's the best way to monitor performance of your app.\n  Visit: https://kadira.io/mup \u201d\nMeteor app path    : /Users/finnfrotscher/Code/App\nUsing buildOptions : {}\nStarted TaskList: Deploy app 'App' (linux)\n[46.101.198.zzz] - Uploading bundle\n[46.101.198.zzz] - Uploading bundle: SUCCESS\n[46.101.198.zzz] - Sending environment variables\n[46.101.198.zzz] - Sending environment variables: SUCCESS\n[46.101.198.zzz] - Initializing start script\n[46.101.198.zzz] - Initializing start script: SUCCESS\n[46.101.198.zzz] - Invoking deployment process\n[46.101.198.zzz] - Invoking deployment process: SUCCESS\n[46.101.198.zzz] - Verifying deployment\n[46.101.198.zzz] x Verifying deployment: FAILED\n-----------------------------------STDERR-----------------------------------\n\nnpm WARN deprecated semver behavior.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No description\nnpm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No README data\nnpm WARN cannot run in wd meteor-dev-bundle@0.0.0 node npm-rebuild.js (wd=/bundle/bundle/programs/server)\n=> Starting meteor app on port:80\n\nassert.js:93\n  throw new assert.AssertionError({\n        ^\nAssertionError: \"undefined\" === \"function\"\n    at wrapPathFunction (/bundle/bundle/programs/server/mini-files.js:77:10)\n    at Object.<anonymous> (/bundle/bundle/programs/server/mini-files.js:108:24)\n    at Module._compile (module.js:456:26)\n    at Object.Module._extensions..js (module.js:474:10)\n    at Module.load (module.js:356:32)\n    at Function.Module._load (module.js:312:12)\n    at Module.require (module.js:364:17)\n    at require (module.js:380:17)\n    at Object.<anonymous> (/bundle/bundle/programs/server/boot.js:9:13)\n    at Module._compile (module.js:456:26)\n-----------------------------------STDOUT-----------------------------------\n\nTo see more logs type 'mup logs --tail=50'\n\n----------------------------------------------------------------------------\n\nFinns:App Finn$ mup logs --tail=50\n[46.101.198.cc]=> Starting meteor app on port:80\n[46.101.198.cc]    at wrapPathFunction (/bundle/bundle/programs/server/mini-files.js:77:10)\n    at Object. (/bundle/bundle/programs/server/mini-files.js:108:24)\n    at Module._compile (module.js:456:26)\n    at Object.Module._extensions..js (module.js:474:10)\n    at Module.load (module.js:356:32)\n    at Function.Module._load (module.js:312:12)\n    at Module.require (module.js:364:17)\n    at require (module.js:380:17)\n    at Object. (/bundle/bundle/programs/server/boot.js:9:13)\n    at Module._compile (module.js:456:26)\nnpm WARN deprecated This version of npm lacks support for important features,\nnpm WARN deprecated such as scoped packages, offered by the primary npm\nnpm WARN deprecated registry. Consider upgrading to at least npm@2, if not the\nnpm WARN deprecated latest stable version. To upgrade to npm@2, run:\nnpm WARN deprecated\nnpm WARN deprecated   npm -g install npm@latest-2\nnpm WARN deprecated\nnpm WARN deprecated To upgrade to the latest stable version, run:\nnpm WARN deprecated\nnpm WARN deprecated   npm -g install npm@latest\nnpm WARN deprecated\nnpm WARN deprecated (Depending on how Node.js was installed on your system, you\nnpm WARN deprecated may need to prefix the preceding commands with sudo, or if\nnpm WARN deprecated on Windows, run them from an Administrator prompt.)\nnpm WARN deprecated\nnpm WARN deprecated If you're running the version of npm bundled with\nnpm WARN deprecated Node.js 0.10 LTS, be aware that the next version of 0.10 LTS\nnpm WARN deprecated will be bundled with a version of npm@2, which has some small\nnpm WARN deprecated backwards-incompatible changes made to npm run-script and\nnpm WARN deprecated semver behavior.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No description\nnpm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No README data\nnpm WARN cannot run in wd meteor-dev-bundle@0.0.0 node npm-rebuild.js (wd=/bundle/bundle/programs/server)\nassert.js:93\n  throw new assert.AssertionError({\n        ^\nAssertionError: \"undefined\" === \"function\"\n    at wrapPathFunction (/bundle/bundle/programs/server/mini-files.js:77:10)\n    at Object. (/bundle/bundle/programs/server/mini-files.js:108:24)\n    at Module._compile (module.js:456:26)\n    at Object.Module._extensions..js (module.js:474:10)\n    at Module.load (module.js:356:32)\n    at Function.Module._load (module.js:312:12)\n    at Module.require (module.js:364:17)\n    at require (module.js:380:17)\n    at Object. (/bundle/bundle/programs/server/boot.js:9:13)\n    at Module._compile (module.js:456:26)\n``\n. yes\n. trying withdeployCheckWaitTime: 180,`\n. How do i get the Node logs you asked about?\n\nIt's ump logs, where is app (node.js) logs?\n. With deployCheckWaitTime: 180 on mupx:\n\n```\nx Verifying deployment: FAILED\n-----------------------------------STDERR-----------------------------------\npackage.json meteor-dev-bundle@0.0.0 No description\nnpm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No README data\nnpm WARN cannot run in wd meteor-dev-bundle@0.0.0 node npm-rebuild.js (wd=/bundle/bundle/programs/server)\n=> Starting meteor app on port:80\n\nassert.js:93\n  throw new assert.AssertionError({\n        ^\nAssertionError: \"undefined\" === \"function\"\n    at wrapPathFunction (/bundle/bundle/programs/server/mini-files.js:77:10)\n    at Object.<anonymous> (/bundle/bundle/programs/server/mini-files.js:108:24)\n    at Module._compile (module.js:456:26)\n    at Object.Module._extensions..js (module.js:474:10)\n    at Module.load (module.js:356:32)\n    at Function.Module._load (module.js:312:12)\n    at Module.require (module.js:364:17)\n    at require (module.js:380:17)\n    at Object.<anonymous> (/bundle/bundle/programs/server/boot.js:9:13)\n    at Module._compile (module.js:456:26)\n\n=> Redeploying previous version of the app\n\n``\n. andmupstill just silently dies onBuilding App Bundle Locally. the Docs say 'mup logs\n. You deploy by hand?\n. Since I had A LOT!! of problems with mup i'll probably finally start to deploy without it. \nI never did that (thats just a tiny bit out of my league...)\ndo you have some guides or tutorials i could start with?\n. ok thanks. i will do that. with both hands :D\n. I still recommend mupx-letsencrypt. \n. Works! \n. yes i am using autogenerate now and it works \n. +1 for the issue. i just ignored it and everything works fine. the alert is irritating tho. on the server:\nmongodump -d [YOUR_DB] -c [COLLECTION] -o [PATH || ./folder]\nValueable Info:\n--port \"port\"  Default: 27017\n-d \"database\"\n-c \"collection\" Specifies a collection to backup. If you do not specify a collection, this option copies all collections in the specified database or instance to the dump files.\nall info here. i am connecting to my servers with ssh. I am not sure what your problem is then. \ntry to connect to the db with the command \nmongo which logs you in. then\nshow dbs, use [db] and show collections\nand make sure the data is there.\n. docker run  --rm \\\n  --link mongodb:mongo  \\\n  -v /root:/backup  mongo  bash \\\n  -c 'mongodump --out /backup --host $MONGO_PORT_27017_TCP_ADDR'\nnow a backup will live at /root.\nworks?\n. issue could be reproduced on another server.\nis it maybe @abernix 's docker image?. its was indeed the docker image. \nif somebody has similar problems check the install_base.sh and install_node.sh where extra packages are installed.\napt-get update -y\napt-get remove -y gyp\napt-get install -y curl bzip2 build-essential g++ python git make gcc gcc-multilib node-gyp\napt-get install -y pkg-config xserver-xorg-dev libxext-dev pkg-config libxi-dev libglu1-mesa-dev libglew-dev\nnpm install prebuild-install node-pre-gyp node-gyp -g. any progress toward zero downtime deploys?. thank you. thats a really great feature!. ",
    "aarlaud": "I'm using let's encrypt certs. Works beautifully.\nI do have a crt instead of a pem though. \nSimply did the below and it works.\ncat fullchain.pem privkey.pem > bundle.crt\nThought that since it is NGINX, I'd comply with what NGINX expects.\n. Hi Greblak,\nWould you mind sharing how you do this currently? (like where is what exactly)\nthanks !\n. Thanks\n. I believe the archive is in the container (not sure where. Do docker exec -it mongodb /bin/bash to get a CLI to look for it potentially)\nI personally use these commands:\n- docker exec -it mongodb bash -c 'mongodump -d mongodbname -o dir_in_container'\nThen compress it however you want and cp the file from container to filesystem.\n- docker cp mongodb:dir_in_container/mongodbname.tgz dir_in_fs/backup_name.tgz\nI run it to create the file in the container and then get it out to my fs to ship it to S3.\nIt works for me. No clue if this is the clean/pro way to go, but I had never used docker CLI until 2 days ago....\n. I think there is something else going on actually. Still can't get a grasp of it but I'll close this as this is not likely to be a mup issue.\n. ",
    "ibrahimzahoor": "https://blog.ibrahimzahoor.me/lets-encrypt-ssl-nginx-mup-deployment-meteor-3aea28b6dbd9#.w2xoa9s6o\n. @jvallarvisp Remove bcrypt from the package.js file as a dependancy, Meteor bcrypt would work fine with the following error \n```\nNote: you are using a pure-JavaScript implementation of bcrypt.\nWhile this implementation will work correctly, it is known to be\napproximately three times slower than the native implementation.\nIn order to use the native implementation instead, run\nmeteor npm install --save bcrypt\n```\nAfter removing the bcrypt npm package your deployment would be fine\n. @Floriferous This warning only comes on Ubuntu 16, If you want to install the npm bcrypt package you can go for Ubuntu 14 instance, Ubuntu 14 is more stable for MUP deployment according to my experience.\n. @jvallarvisp You can install libpq-dev it on the Docker container by customising the container you're using. So you would modify a container and upload that on docker hub and mention its name in the dockerImage:\"username:dockerContainer\".\nor by looking at the error find: /usr/pg*: No such file or directory i think you need to install the dependency pg_config or pg for it to work. \n. ",
    "dr-dimitru": "Try this for mup.js\njs\nmodule.exports = {\n  servers: {\n    one: {\n      \"host\": \"0.0.0.0\", // Change to your address\n      \"username\": \"sshLogin\",\n      \"password\": \"sshPass\"\n    },\n  },\n  meteor: {\n    name: 'appNameCamelCase',\n    path: '../../',\n    servers: {\n      one: {},\n    },\n    buildOptions: {\n      serverOnly: true\n    },\n    dockerImage: 'abernix/meteord:base', // This image should work\n    ssl: {\n       crt: 'ssl.pem', // Change to your ssl\n       key: 'ssl.pem', // Change to your ssl\n       port: 443\n     },\n  },\n};\n. Could you check its logs?\n. May be you need to switch to mupx from mup.. \n. Also I've found https://github.com/kadirahq/meteor-up/issues/189 related to silent quit\n. It's ump logs, where is app (node.js) logs?\n. This issue is in docs:\n\nQ) I get an deploy verification error with logs like below (Similar to issue 88)\nVerifying Deployment: FAILED\nError:\n-----------------------------------STDERR-----------------------------------\n run:\nnpm WARN deprecated\nnpm WARN deprecated   npm -g install npm@latest\nnpm WARN deprecated\nA) Try increasing the value of deployCheckWaitTime field in mup.js file.\n. Not actually sure if it's related\nis ecmascript package in .meteor/packages file?\n. > How do i get the Node logs you asked about?\n\nIdk, I don't use mup :)))\n. Should be in a docs I believe\n. This issue should be fixed by image with node v4.* \nsee: https://github.com/arunoda/meteor-up/issues/1091#issuecomment-238806157\n. > the Docs say 'mup logs`\nNo idea as I said, I have little experience with mup, and I just don't like it. As it doesn't make things simpler, but opposite.\nAsk @arunoda ...\nAnd take a look on: https://github.com/kadirahq/meteor-up/issues/172\n. By two :)\nKind of by hands - simple shell script do the thing\nSome of the hosts is checking git once a day and upgrade itself\n. Simple: \nmeteor build -> rsync archive to remote -> tar -xvf .. -> rsync to app's dir\nAnd serve/start/manage with Phusion Passenger (with build-in nginx)\n. This gist should point you to the right direction\n. ",
    "Tusharsb": "After failing on mup for a few hours, i ended up using Amazon's Elastic Load Balancer to run my meteor app behind SSL reverse proxy\n. Thanks for pointing @zeroasterisk \nIndeed websocket was failing in Browser Console. Following the advice of https://www.built.io/blog/websockets-on-aws-s-elb I have now moved from http/https layer to TCP layer of AWS ELB - now websocket works successfully but I am no longer able to see the IP of visitors. \nI think I will follow advice of @FinnFrotscher at https://gist.github.com/dr-dimitru/ed7b0cc77ea627a06c9af1f791699eda#gistcomment-1864313 and try mupx-letsencrypt\n. ",
    "edemaine": "Regarding the original error, I had the same issue until I realized that stud was running from an execution of the old form of mup.  I had to remove it by deleting /usr/local/bin/stud and /etc/init/stud.conf.  Now I can successfully bind to port 443 -- or at least that message is gone.\n. Sorry, duplicate of #189 \n. Wow, what timing.  Thanks, it's working now.  (I assumed it was something mup specific because it was running fine locally, but apparently not!)\n. I just bumped into this issue.  In my opinion, the documentation should mention that the old system still has a significant SSL security flaw.  Beforehand, I didn't realize how much I should prefer the reverse-proxy, and this pushed me over the edge.. Agreed; I think the last version fixed this?. Any updates/ideas on this?  I tried updating to the new Meteor, but still can't deploy my server, which is pretty annoying.  No error messages (as Meteor is running, and is correctly redirecting http to https), but telnetting to localhost port 443 leads to immediate disconnect, while telnetting to the host at port 443 gives \"connection refused\".\nHere is the bottom of my syslog, which doesn't seem to reveal much (but I'm not very familiar with docker). Does docker have its own firewall?...\nNov 22 18:33:14 hostname kernel: [1126112.223654] docker0: port 2(veth0502b1c) entered disabled state\nNov 22 18:33:14 hostname kernel: [1126112.270872] docker0: port 2(veth0502b1c) entered disabled state\nNov 22 18:33:14 hostname kernel: [1126112.271316] device veth0502b1c left promiscuous mode\nNov 22 18:33:14 hostname kernel: [1126112.271323] docker0: port 2(veth0502b1c) entered disabled state\nNov 22 18:33:15 hostname kernel: [1126112.568493] docker0: port 3(veth17beb2f) entered disabled state\nNov 22 18:33:15 hostname kernel: [1126112.568851] device veth17beb2f left promiscuous mode\nNov 22 18:33:15 hostname kernel: [1126112.568858] docker0: port 3(veth17beb2f) entered disabled state\nNov 22 18:33:16 hostname ntpd[2439]: Deleting interface #17 veth0502b1c, fe80::84b8:61ff:fe8d:adec#123, interface stats: received=0, sent=0, dropped=0, active_time=1112619 secs\nNov 22 18:33:16 hostname ntpd[2439]: Deleting interface #16 veth17beb2f, fe80::cd2:4ff:fe8a:8f82#123, interface stats: received=0, sent=0, dropped=0, active_time=1112619 secs\nNov 22 18:33:16 hostname ntpd[2439]: peers refreshed\nNov 22 18:33:49 hostname kernel: [1126146.758827] device veth52af827 entered promiscuous mode\nNov 22 18:33:49 hostname kernel: [1126146.759117] IPv6: ADDRCONF(NETDEV_UP): veth52af827: link is not ready\nNov 22 18:33:49 hostname kernel: [1126146.935929] IPv6: ADDRCONF(NETDEV_CHANGE): veth52af827: link becomes ready\nNov 22 18:33:49 hostname kernel: [1126146.935963] docker0: port 2(veth52af827) entered forwarding state\nNov 22 18:33:49 hostname kernel: [1126146.935966] docker0: port 2(veth52af827) entered forwarding state\nNov 22 18:33:50 hostname kernel: [1126147.457174] device veth3e550ff entered promiscuous mode\nNov 22 18:33:50 hostname kernel: [1126147.457322] IPv6: ADDRCONF(NETDEV_UP): veth3e550ff: link is not ready\nNov 22 18:33:50 hostname kernel: [1126147.457326] docker0: port 3(veth3e550ff) entered forwarding state\nNov 22 18:33:50 hostname kernel: [1126147.457331] docker0: port 3(veth3e550ff) entered forwarding state\nNov 22 18:33:50 hostname kernel: [1126147.683912] IPv6: ADDRCONF(NETDEV_CHANGE): veth3e550ff: link becomes ready\nNov 22 18:33:54 hostname kernel: [1126152.034066] docker0: port 3(veth3e550ff) entered disabled state\nNov 22 18:33:54 hostname kernel: [1126152.040855] docker0: port 3(veth3e550ff) entered forwarding state\nNov 22 18:33:54 hostname kernel: [1126152.040863] docker0: port 3(veth3e550ff) entered forwarding state\nNov 22 18:33:55 hostname ntpd[2439]: Listen normally on 18 veth3e550ff fe80::dc9a:49ff:feaa:5c1d UDP 123\nNov 22 18:33:55 hostname ntpd[2439]: Listen normally on 19 veth52af827 fe80::6ce7:14ff:fe2b:3532 UDP 123\nNov 22 18:33:55 hostname ntpd[2439]: peers refreshed\nNov 22 18:33:55 hostname ntpd[2439]: new interface(s) found: waking up resolver\nNov 22 18:33:58 hostname kernel: [1126155.862066] docker0: port 3(veth3e550ff) entered disabled state\nNov 22 18:33:58 hostname kernel: [1126155.869040] docker0: port 3(veth3e550ff) entered forwarding state\nNov 22 18:33:58 hostname kernel: [1126155.869047] docker0: port 3(veth3e550ff) entered forwarding state\nNov 22 18:34:04 hostname kernel: [1126161.952015] docker0: port 2(veth52af827) entered forwarding state\nNov 22 18:34:11 hostname kernel: [1126168.852165] docker0: port 3(veth3e550ff) entered disabled state\nNov 22 18:34:11 hostname kernel: [1126168.853351] docker0: port 3(veth3e550ff) entered forwarding state\nNov 22 18:34:11 hostname kernel: [1126168.853359] docker0: port 3(veth3e550ff) entered forwarding state\nNov 22 18:34:26 hostname kernel: [1126183.904096] docker0: port 3(veth3e550ff) entered forwarding state\nNov 22 18:34:53 hostname kernel: [1126210.813757] docker0: port 3(veth3e550ff) entered disabled state\nNov 22 18:34:53 hostname kernel: [1126210.815290] docker0: port 3(veth3e550ff) entered forwarding state\nNov 22 18:34:53 hostname kernel: [1126210.815298] docker0: port 3(veth3e550ff) entered forwarding state\nNov 22 18:35:08 hostname kernel: [1126225.824038] docker0: port 3(veth3e550ff) entered forwarding state\nNov 22 18:37:27 hostname kernel: [1126364.972239] docker0: port 3(veth3e550ff) entered disabled state\nNov 22 18:37:27 hostname kernel: [1126364.973589] docker0: port 3(veth3e550ff) entered forwarding state\nNov 22 18:37:27 hostname kernel: [1126364.973600] docker0: port 3(veth3e550ff) entered forwarding state\nNov 22 18:37:42 hostname kernel: [1126380.000047] docker0: port 3(veth3e550ff) entered forwarding state. I found the issue.  Three problems:\n\n\nI didn't run mup setup after adding the SSL configuration.  Obvious, in hindsight.  Would have been helpful to have an error message, but this is definitely on the side of user error.\n\n\nFor some reason, there were existing bundle.crt and private.key directories which prevented the copy from working.  (I got good error messages saying the copy failed.)  I'm guessing these were leftovers from the old mup or from some previous poor configurations.\n\n\n$ ssh host ls -l /opt/projectname/config/\ntotal 16\ndrwxr-xr-x 2 ubuntu root   4096 Nov  9 17:36 bundle.crt\n-rw-r--r-- 1 ubuntu ubuntu  549 Nov 22 18:33 env.list\ndrwxr-xr-x 2 ubuntu root   4096 Nov  9 17:36 private.key\n-rw-r--r-- 1 ubuntu ubuntu 1167 Nov 22 18:33 start.sh\n\nI needed to specify my .pem file instead of my .crt file as my crt.  Otherwise I got the following message:\n\nnginx: [emerg] PEM_read_bio_X509_AUX(\"/bundle.crt\") failed (SSL: error:0906D06C:PEM routines:PEM_read_bio:no start line:Expecting: TRUSTED CERTIFICATE)\n        nginx: configuration file /opt/nginx/conf/nginx.conf test failed\nAnyway, now everything is working!. Alas, this seems buggy -- buildLocation is supposed to be a string, not a Boolean, right?. Great, thanks!. FWIW, I get an A+ grade on https://www.ssllabs.com/ssltest/analyze.html using the reverse proxy (and an F using meteor.ssl, as documented in #359).  So I think this issue can be closed.. mup will just take care of the server deployment.  It uses meteor build --server-only internally to do so.\nTo build a mobile app, you'll have to run meteor build separately, and do what you normally do with the resulting apps.  (mup isn't designed to upload your app to the app store.)  This is probably what you want -- the mobile app needs to update much less frequently than the server, given automatic hot code pushes.. Let me know if there's something I should do here.  I'm unable to see what error(s) AppVeyor is reporting.. ~~Am I correct in my assessment that this code is not actually in a release yet?~~ Merged now, as of Feb 3.. @jaredtmartin Do mup start / mup stop do what you want?. FWIW, I recently ran out of inodes on my server, so I appreciate @nzomedia's response!. Cool, thanks, that's a good fix.  I still feel like this could be part of the Meteor build process, to save people from themselves...  Would you object to a PR to this effect?  Or do you think there are circumstances where we shouldn't run meteor npm install before meteor build?. I found that Meteor supports a NODE_OPTIONS command-line variable which you can set to --trace-deprecation.  Could be useful to have an example of this in the mup documentation, but not necessary.. @MuyBien Just catching up on this thread, but did you check that the domain is indeed registered? NXDOMAIN means that the domain doesn't exist, so either you don't have your DNS servers set right, or the domain isn't registered at all.. @MuyBien You can check whether the subdomain is registered correctly using a DNS lookup tool, e.g., https://mxtoolbox.com/DNSLookup.aspx. @fschaeffler The trouble with this bug was that it was somehow specific to our setups (maybe Linux distro?) so @zodern didn't see it his testing and couldn't reproduce it (as written above). Automated testing can only go so far... As users, we serve a more global testing role. It's not that hard for us to report bugs we encounter and downgrade meanwhile -- downgrading is one command. This is why we have versions. . Actually, I now wonder if it's just mup proxy reconfig-shared that fixed things.  I tried using the correct configuration on another server that was using mup-frontend-server, and I got the same error during mup setup:\n```\nStarted TaskList: Setup Docker\n[coauthor.csail.mit.edu] - Setup Docker\n[coauthor.csail.mit.edu] - Setup Docker: SUCCESS\nStarted TaskList: Setup proxy\n[coauthor.csail.mit.edu] - Setup Environment\n[coauthor.csail.mit.edu] - Setup Environment: SUCCESS\n[coauthor.csail.mit.edu] - Pushing the Startup Script\n[coauthor.csail.mit.edu] - Pushing the Startup Script: SUCCESS\n[coauthor.csail.mit.edu] - Cleaning Up SSL Certificates\n[coauthor.csail.mit.edu] - Cleaning Up SSL Certificates: SUCCESS\n[coauthor.csail.mit.edu] - Copying SSL Certificate Bundle\n[coauthor.csail.mit.edu] - Copying SSL Certificate Bundle: SUCCESS\n[coauthor.csail.mit.edu] - Copying SSL Private Key\n[coauthor.csail.mit.edu] - Copying SSL Private Key: SUCCESS\n[coauthor.csail.mit.edu] - Setup SSL Certificates for Domains\n[coauthor.csail.mit.edu] - Setup SSL Certificates for Domains: SUCCESS\nStarted TaskList: Start proxy\n[coauthor.csail.mit.edu] - Start proxy\n[coauthor.csail.mit.edu] x Start proxy: FAILED\n```\n```\n$ mup proxy reconfig-shared\nThe shared settings affect all apps using this reverse proxy.\nStarted TaskList: Configuring Proxy's Shared Settings\n[coauthor.csail.mit.edu] - Sending shared variables\n[coauthor.csail.mit.edu] - Sending shared variables: SUCCESS\n[coauthor.csail.mit.edu] - Sending proxy environment variables\n[coauthor.csail.mit.edu] - Sending proxy environment variables: SUCCESS\n[coauthor.csail.mit.edu] - Sending let's encrypt environment variables\n[coauthor.csail.mit.edu] - Sending let's encrypt environment variables: SUCCESS\nStarted TaskList: Start proxy\n[coauthor.csail.mit.edu] - Start proxy\n[coauthor.csail.mit.edu] - Start proxy: SUCCESS\n```\nIt looks like mup setup didn't run TaskList: Configuring Proxy's Shared Settings.. FYI, I got the custom Bad Gateway message working as follows:\nproxy: {\n    ...\n    nginxServerConfig: 'proxy.config'\n  }\nwith this proxy.config:\nerror_page 502 /502.html;\nlocation /502.html {\n  add_header Content-Type text/html;\n  return 502 '<html>\n...arbitrary HTML, but careful not to use single quotes...\n</html>';\n}\nLet me know if you'd like this in a documentation PR. Or feel free to add it yourself.. ",
    "dpeet": "Same problem here although it seems to work..\n. ",
    "kyle-rader": "I think the verification step is defaulting to some value - not 60 seconds.  My deploys work just fine and you can keep checking mup log and see the deploy finish starting up just fine.\n(See #265 )\n. @LeG3nDz The port 3000 is the port that will end up getting bound to the docker container.  The app will run on port 80 inside the docker container.\nClosing issue:  Verify Deployment script DOES NOT WORK in ZSH shell.\n. Here is an example of the Nginx config I use for proxing to Node/Ruby/Python apps. \n```\nserver {\n    listen 80 default_server;\n    listen [::]:80 default_server;\nserver_name mydomain.com www.mydomain.com mydomain-old.com www.mydomain-old.com;\nreturn 301 https://mydomain.com$request_uri;\n\n\n# For LetsEncrypt this location block is added to the default nginx server block.\nlocation ~ /.well-known {\n    allow all;\n}\n\n\n}\nRedirect various URL's to the one URL I want to use\nserver {\n    listen 443 ssl;\n    listen [::]:443 ssl;\nserver_name www.mydomain.com mydomain-old.com www.mydomain-old.com;\n\nreturn 301 https://mydomain.com$request_uri;\n\n}\nserver {\n    listen 443 ssl http2 default_server;\n    listen [::]:443 ssl http2 default_server;\nserver_name mydomain.com;\n\nssl_certificate /etc/letsencrypt/live/mydomain.com/fullchain.pem;\nssl_certificate_key /etc/letsencrypt/live/mydomain.com/privkey.pem;\n\n# This snippet is defined below\ninclude snippets/strong-ssl.conf;\n\nlocation / {\n        proxy_pass http://localhost:3000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n        proxy_set_header Host $host;\n        proxy_cache_bypass $http_upgrade;\n}\n\n}\nServer blocks for test.mydomain.com\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name www.test.mydomain.com;\n    return 301 https://test.mydomain.com$request_uri;\n}\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\nserver_name test.mydomain.com;\n\nssl_certificate /etc/letsencrypt/live/mydomain.com/fullchain.pem;\nssl_certificate_key /etc/letsencrypt/live/mydomain.com/privkey.pem;\n\ninclude snippets/strong-ssl.conf;\n\nlocation / {\n    proxy_pass http://localhost:4000;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection 'upgrade';\n    proxy_set_header Host $host;\n    proxy_cache_bypass $http_upgrade;\n}\n\n}\n```\nThe include snippets/strong-ssl.conf; is referencing a snippet in /etc/nginx/snippets:\n```\nfrom https://cipherli.st/\nand https://raymii.org/s/tutorials/Strong_SSL_Security_On_nginx.html\nssl_protocols TLSv1 TLSv1.1 TLSv1.2;\nssl_prefer_server_ciphers on;\nssl_ciphers \"EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH\";\nssl_ecdh_curve secp384r1;\nssl_session_cache shared:SSL:10m;\nssl_session_tickets off;\nssl_stapling on;\nssl_stapling_verify on;\nresolver 8.8.8.8 8.8.4.4 valid=300s;\nresolver_timeout 5s;\nDisable preloading HSTS for now.  You can use the commented out header line that includes\nthe \"preload\" directive if you understand the implications.\nadd_header Strict-Transport-Security \"max-age=63072000; includeSubdomains; preload\";\nadd_header Strict-Transport-Security \"max-age=63072000; includeSubdomains\";\nadd_header X-Frame-Options DENY;\nadd_header X-Content-Type-Options nosniff;\nssl_dhparam /etc/ssl/certs/dhparam.pem;\n```\nSetup guide Reverse proxy\nSetup guide secure nginx with Let's Encrypt\n. This is most often because the verification is not waiting long enough for the app to finish starting up.  See my issue #265 \n. @mroftalp Are you trying to deploy your app and run it behind a reverse proxy (like Nginx)?\n. @mroftalp If the comment is proper JS then I wouldn't think that would cause an issue.\nEasy enough to test though (I'd say worth doing).\n. I discovered my verification error was because my deploy account was using\nthe zsh shell and the verification uses some bash specific commands, so it\nimmediately failed.\nOn Fri, Sep 23, 2016 at 1:45 PM Avishaan notifications@github.com wrote:\n\n@blainehansen https://github.com/blainehansen, can you post your entire\nlog?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/280#issuecomment-249298079,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AEiP3MuOzpIa7BxLREFU_uHxu8R1nAVQks5qtDpvgaJpZM4J2aCE\n.\n\nKyle W. Rader\n\nkyle@kylerader.ninja\n425.241.7977\nkylerader.ninja\n. ",
    "premcool": "Closing issue,I finally gave up on the meteor up deployment and went to the conventional way of meteor deployment i.e. doing the setup manually in the server and then ftp the tar.gz build file. I found this to be more easy and reliable, just had to to spend sometime with the manual steps of server setup and unix commands etc which I'm familiar with.\n. ",
    "s7dhansh": "You can use something like this:\n```\nupstream index {\n  server 127.0.0.1:8080;\n}\nserver {\n  listen       80;\n  server_name  domain.com;\n  charset     UTF-8;\n  location / {\n    proxy_pass              http://index;\n    proxy_redirect          off;\n    proxy_set_header        Upgrade $http_upgrade;\n    proxy_set_header        Connection \"upgrade\";\n  }\n}\n```\nYou can then use 8080 in your mup.js. Your app shall then run at host port 8080, while nginx will proxy it to domain.com.\n. @Greblak instead of forking you can use the git code directly and create a symlink for the new mup as /usr/local/bin/mupx. Thus you don't need to maintain a repo and a simple git pull updates your mupx.\n. For me it was meteorhacks:picker. So meteorhacks packages are using something that is causing problem. As of now, no idea what.\nFalse alarm on picker. For me too it was momentjs:moment 2.15.2. 2.15.1 works great. The reason is pointed out by @cesarve77 .\nI fixed it by using moment via npm. The code is more modular now.\n. Found out the issue. It seems somehow my identity was removed from the ssh-agent. Had to add it again.\nssh-add /path/to/private_rsa\n. Thank you so much!\nOn Fri, Nov 25, 2016, 7:49 AM Alberto I. Naperi Jr. \nnotifications@github.com wrote:\n\nDocker restart command:\ndocker restart \nDocker logs command:\ndocker logs -f --tail=50 \nRegards\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/385#issuecomment-262868012,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AArJtDnQr8dYFVHJF0puX0s9if3IFV0Aks5rBkXBgaJpZM4K7ukg\n.\n-- \nSudhanshu\n. Sorry, it was some problem at the code end.. Docker version 17.07.0-ce, build 8784753\nRAM: 1GB, Disk: 20GB (14 GB free)\nNo proxy.\n\nAs I mentioned this error npm ERR! registry error parsing json is not constant. I got a different error another time - error from daemon in stream: Error grabbing logs: EOF\nI will dig deeper tonight and try to give you a more comprehensive list of errors. It is a production environment, hence can't do many random deployments.\nI do not get any errors on any other testing/prod deployments.. So I have increased my waitTime to 200 and the deployment has succeeded the last 3 times. Closing it for now.. Use abernix/meteord:node-8-base. ",
    "ivandaho": "I have the same issue with bcrypt. I am also using that abernix/meteord:base image. This bcrypt thing happened after updating Meteor to either 1.4 or 1.4.1.\nI think I know the problem but I am not knowledgeable enough to solve it.\nSo I think bcrypt requires node-gyp installed in npm to compile.\nI am trying to solve it by building a docker image from the abernix:base image, and install node-gyp in it. However, I don't know enough about docker to confirm whether my image made any difference.\nDockerfile I used:\n```\nFROM abernix/meteord:base\nRUN npm install -g node-gyp\n```\nThen I ran docker build . and pushed my meteord to ivandaho/meteord\nThen I set my mup.js to use my meteord image instead of abernix's\nTried to Run mup deploy with bcrypt in my package.json, and got the same error.\nIf I took off bcrypt in my package.json the deploy would end with a warning, but the app would be deployed fine. mup logs --tail=50 had the same message Meteor's console was giving me about doing meteor npm install --save bcrypt to use the npm implementation of bcrypt.\nedit: By increasing deployCheckWaitTime from 15 to 60, mup would return SUCCESS when verifying deployment. However the app is still not using the native bcrypt. \n. @guillim \nTried it, doesn't work for me - still can't run node's bcrypt - it gives the same node-gyp error. docker ps in my droplet shows that your image is the one installed. Both my local machine and my droplet is 16.04 if it matters.. @codeHatcher 1.4.1.1. @doronsever the docker repo doesn't have a latest tag, use any of the tags at https://hub.docker.com/r/guillim/meteord/tags/ instead, for example \ndockerImage:\"guillim/meteord:node6.9.1V3\". Have the same/similar issue - see https://github.com/kadirahq/meteor-up/issues/267#issuecomment-244869835\nI think it's due to 1.4.1 adding the warning message for bcrypt? Mup verifies it fine if i have the wait time set longer. Even with a short wait time, the app deploys without problems even with failed verification\n. ",
    "rune-bk": "Change all occurences of meteorhacks/meteord:base in this file to a docker file of your choice that runs whatever node version you need.\nI currently use this for meteor 1.4: oleurud/meteor-graphicsmagick\nIt's the right node version and includes graphicsmagick.\n. ",
    "DanielSmon": "Hi @sonuterrific, I'm able to get around that by installing ssh2 globally:\nnpm install -g ssh2\nBut after that I get an error executing meteor build:\n{ [Error: spawn C:\\WINDOWS\\system32\\cmd.exe ENOENT]\n  code: 'ENOENT',\n  errno: 'ENOENT',\n  syscall: 'spawn C:\\\\WINDOWS\\\\system32\\\\cmd.exe',\n  path: 'C:\\\\WINDOWS\\\\system32\\\\cmd.exe',\n  spawnargs:\n   [ '/c',\n     'meteor',\n     'build',\n     '--directory',\n     'C:\\\\tmp\\\\eb9cc1c1-2dae-47f2-a8d7-2522e188ad3e',\n     '--architecture',\n     'os.linux.x86_64',\n     '--server',\n     'http://localhost:3000',\n     '--server-only' ] }\nSame error on Ubuntu:\n{ [Error: spawn meteor ENOENT]\n  code: 'ENOENT',\n  errno: 'ENOENT',\n  syscall: 'spawn meteor',\n  path: 'meteor',\n  spawnargs:\n   [ 'build',\n     '--directory',\n     '/tmp/f11de5b5-f46e-4b68-83d2-7cc7e2b5d9ca',\n     '--architecture',\n     'os.linux.x86_64',\n     '--server',\n     'http://localhost:3000',\n     '--server-only' ] }\nDoes it work for you after installing ssh2?\n. Ah, solved my build problem. I had the wrong path in mup.js. #225 talks about this. Because I'm in .deploy, I just used \"../\" for my meteor path and it's okay now.\nAs for the ssh2 issue, should that be a dependency on the mup package so that it automatically installs?\n. ",
    "quanterion": "thank you!\n. ",
    "marczzio": "Ok i'll try. thanks for reply\n. ",
    "neurosoup": "Hi,\nI have the same issue on windows 7. Windows Script Host take precedence over nodejs ?\nI've tried mup setup from within .deploy but with no success. Do you have a clue on what to do ?\n. ",
    "nikkiczx": "Hi, \nAnybody found a solution for this yet? I'm working on Windows 10. Thanks.\n\nUpdate:\nRunning mup.cmd setup actually works.. ",
    "Papudi": "Its strange, it used to give me this error on cmd, but when I ran the same in powershell it just worked without any changes.. ",
    "ewan-laws": "npm install -g ssh2 fixed this for me.\n. ",
    "binaryme": "I got Error: Cannot find module 'babel-polyfill'\nand the error does not get fixed executing \nnpm install -g babel-polyfill nor npm install -g ssh2\nnpm -v 5.4.2 also tried to run npm v 8.0 and 7.0 so apparently it is not related to npm version. Solved it, it did had to do with npm version, i had globally installed mup in version of node v7.10.1\nand the error occurred in node v8.0.0, check my bin paths and after switching to the version with mup installed it worked.\n\n\n. ",
    "blainehansen": "I'm having this same problem (I've documented it here on this SO post), and removing the comments didn't make any difference.\n. Check out my answer to the SO post it turned out to be the ROOT_URL option needing the http:// protocol included.\n. All the npm output about packages and versions and everything is a red herring and is throwing you off I think. Get more of the log (mup logs --tail=200 or maybe even longer) and try to find the real error message. In my case it was the Error: $ROOT_URL, if specified, must be an URL that mattered, and everything else was just happening because the server was flapping around trying unsuccessfully to restart.\n. See the answer posted in on SO\nhttp://stackoverflow.com/a/39669387/988335\n. ",
    "qhello": "Same on my side, would appreciate a fix. \n. ",
    "rogeriojs": "Thanks, very usefull!. ",
    "xauxatz": "No - I fixed the problem but I made all sorts of changes to the project, and I am not sure which of them actually got rid of this particular problem.. I am also deploying to Digital Ocean (ubuntu image). For me it fails already with mup setup.. It looks like this:\n```\n    ssl: {\n      certificate: '/home/osboxes/meteor/appname/fullchain.pem',\n      key: '/home/osboxes/meteor/appname/privkey.pem',\n//      pem: '/home/osboxes/meteor/appname/ssl.pem',\n      port: 8011\n    },\n```\nBut this used to work until I set up SSH login.\n. ",
    "IDCOLL": "I have the same issue tried all the different ideas in the forum but nothing helped. So it either fails silently or when I change certain lines on the file (remove comment dockerImage) I get a [SyntaxError: Unexpected identifier] error. Really frustrating, think I will be going back to 1.3 and mupx for now.\nmodule.exports = {\n  servers: {\n    one: {\n      host: '1xx.2xx.2xx.1xx',\n      username: 'root',\n      pem: \"C:.......ssh\\id_rsa.ppk\"\n      // password:\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\nsetupNode: true,\n  nodeVersion: \"4.4.7\",\nmeteor: {\n    name: 'app',\n    path: '../app',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'http://1xx.2xx.2xx.1xx'\n    },\n//dockerImage: 'abernix/meteord'\ndeployCheckWaitTime: 120\n},\n};\n. @malikperang I am looking into using OPLOG TAILING and want to add the \"Mongo_Oplog_Url\" to my mup.json.\nDo you know if this function actually works in MUP?. > Redeploying after deleting some opt's folders have fixed my issue. Much sorry to the time I made you lost, I still don't get how this little file got \"corrupted\". I'm clueless. Thanks a lot @zodern your support was really great and quick.\nI have had this same issue yesterday. I am using the latest MUP and I will described what I did to make the problem occur and steps taken to solve it.\n\nMy app was running Meteor 1.5xxx and using SSL and Proxy. Everything was fine.\nUpdated my settings.json file to include some information for the first time.\nDid a mup setup and mup deploy,\nApp could not be accessed through the browser, after using the \"mup docker sp\" function released the proxy was constantly restarting.\nDid a Meteor upgrade to 1.8xxx and ensured my docker image used was correct (didn`t solve the problem),\nAdd a ; to the end of the nginx-default.conf as mentioned here. (didn`t solve the problem)\nDeleted the /opt/mup-nginx-proxy folder and \"MyApp\" folder on the server\nDid a Mup setup and deploy and the problem was solved.\n\nHope this helps somebody.\n. > Im trying to figure this out as well.\n\nI have successfully used buildInstructions toapt-get install the required dependencies. However a runaway amount of Chrome processes are created. The solution recommended by Puppeteer is to add these instructions to your docker file.\nhttps://github.com/GoogleChrome/puppeteer/blob/master/docs/troubleshooting.md#running-puppeteer-in-docker\nBut I cant figure out if these commands are possible with meteor-up especially the last 4.\nCould you provide any assistance?\n\nHas anybody been able to successfully get Puppeteer working with mup?. > Hi @IDCOLL ,\n\nI have build 2 custom docker images based on meteord with 8.11.2 node version\nhttps://hub.docker.com/r/nabiltntn/meteord-node-with-chromium/tags\n8.11.2_dumb-init starts the application with dumb-init to avoid having plenty of zombies process after browser execution.\n\nThank you for the quick reply. \nDo I just reference that docker image in my MUP file i.e. or do I need to do add some instructions to the build Instructions also? \nAlso is the image compatible with Meteor 1.6+\ndocker: {\n      image: '8.11.2_dumb-init',\n       buildInstructions: [\n        'RUN apt-get update && apt-get install -y imagemagick'\n      ]\n}. Thanks @nabiltntn it worked.\nI had to make a small adjustment in my puppeteer code:\nawait puppeteer.launch({headless: true, args:['--no-sandbox']})\nThe --no-sandbox argument is critical otherwise PUPPETEER will give the following error:\n\nException while invoking method 'createXreport' Error: Failed to launch chrome!\n[82.196.3.225][0219/140956.079200:ERROR:zygote_host_impl_linux.cc(89)] Running as root without --no-sandbox is not supported. See https://crbug.com/638180.\n. \n",
    "pikausp": "Since I was really lost I did some 'log debugging' and there are 2 problems\nFirst problem was not being able to run mup from the directory mup.js is located at. I \"fixed\" this by going to project directory and passing the config path\n    mup setup --config .deploy/mup.js\nI wasn't able to locate the root of this issue.\n. I had the same issue. For me the workaround was to run mup from parent directory and provide path for mup.js & settings file via parameters\n. mup --config .deploy/mup.js --settings .deploy/settings.json deploy. I copy pasted my deploy bat... With the following structure\nProjectRoot\nProjectRoot/.deploy\nProjectRoot/.deploy/mup.js\nProjectRoot/.deploy/settings.json\nYou'd execute the the following command when you are in ProjectRoot\nmup --config .deploy/mup.js --settings .deploy/settings.json deploy. @muscaiu Your folder name is deploy, but you are using .deploy in the command. ",
    "catin-black": "+1\n. +1\n. ",
    "msio": "+1 \n. ",
    "s-devaney": "+1\n. +1\n. please. Interested too. ",
    "evlrbot": "Check your json syntax is correct; no missing commas or brackets. Also use absolute path names for all system files; relative path names fail silently. . ",
    "muscaiu": "Yes, that i know how to do on my own :smile:  \nWhat i wanted is an example with the details i gave for the mup.js file: \n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '1.2.3.4',\n      username: 'root'\n      // pem:\n      // password:\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\nmeteor: {\n    name: 'app',\n    path: '../app',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'app.com',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n//dockerImage: 'kadirahq/meteord'\ndeployCheckWaitTime: 60\n\n},\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n```\n. Anyone please? This should be easy.\nI need to try mup, because mupx is not working on a clean copy of ubuntu server locally.\n. I have tries this and it's the same thing. \nWhen i do mup setup, it opens the mup.js file in a new editor window, and i don't know why it's doing that it's so annoying!! ............\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '192.168.0.163',\n      username: 'root',\n      // pem:\n      password: 'pass'\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\n  meteor: {\n    name: 'hr',\n    path: '../hr',\n    docker: {\n      image: 'abernix/meteord:base',// !important for meteor 1.4\n    },\n    servers: {\n      one: {},\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'http://192.168.0.163',\n      MONGO_URL: 'mongodb://192.168.0.163/meteor',\n    },\n    deployCheckWaitTime: 60\n  },\nmongo: {\n    oplog: true,\n    servers: {\n      one: {},\n    },\n  },\n};\n``\n. How did you do that? Please give an example. . I tried and it it saismup.js file not found. Run 'mup init' first.`\nNote that i have a deploy folder under root and i have run mup init in it.\nI don't think it's going in the deploy folder, because if i do mup init in root folder and i do your commands it opens mup.js in a new editor window like before. \nAny ideas?. Same thing as the title of the issue sais ..for 2 months :(\nI don't know if i mentioned that i'm on Windows 10.\n\n. Yes i have that structure and i did execute all commands posted here.\n\n. @albertonaperijr same thing happens.\n@pikaupet tried without the . mup deploy --config=deploy/mup.js --settings=settings.json same thing. If i do mup banana same thing happens. So no matter what i try after mup it is useless.. @albertonaperijr i also did npm install -g mup. Same thing. It's starting to make me sick to my stomach.\n@gaillota \n- my app is in D:\\Meteor\\mydeploy\n- my deploy folder is in D:\\Meteor\\mydeploy\\deploy\nI tried also with other projects same thing always.. Oh crap, i forgot i did a mup init in the root folder and that was why it kept doing so. Now it seems to start giving error like the mup.js is not configured right, because it isn't.\nmup deploy --config=deploy/mup.js --settings=.deploy/settings.json\n```\nBuilding App Bundle Locally\n{ cwd: 'D:\\Meteor\\mydeploy\\app' }\n{ [Error: spawn C:\\WINDOWS\\system32\\cmd.exe ENOENT]\n  code: 'ENOENT',\n  errno: 'ENOENT',\n  syscall: 'spawn C:\\WINDOWS\\system32\\cmd.exe',\n  path: 'C:\\WINDOWS\\system32\\cmd.exe',\n  spawnargs:\n   [ '/c',\n     'meteor',\n     'build',\n     '--directory',\n     'D:\\tmp\\16719968-3292-4105-848e-af50736ceebd',\n     '--architecture',\n     'os.linux.x86_64',\n     '--server',\n     'http://localhost:3000',\n     '--server-only' ] }\n=> Build Error. Check the logs printed above.\n```\nSo guys 1 more thing i need to ask. \nI have an VMWare Ubuntu server running locally on 192.168.0.185, username: root pass: passwd\nNow that you know my folder structure, can you please post an example mup.js file that could work for me?. I tried with this mup.js file:\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '192.168.0.185',\n      username: 'root',\n      password: 'passwd'\n    }\n  },\nmeteor: {\n    name: 'deployapp',\n    path: '..',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'http://192.168.0.185',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n    deployCheckWaitTime: 60\n  },\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n`mup deploy --config=deploy/mup.js --settings=.deploy/settings.json`\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor\n[192.168.0.185] - Pushing Meteor App Bundle to The Server\n[192.168.0.185] x Pushing Meteor App Bundle to The Server: FAILED\n        No such file\n```. I installed a fresh copy of ubuntu server and changed ip to 192.168.0.158.\nBefore i try to deploy, do i need to install things like node, mongo, docker on the ubuntu server?\nRight now it's saying:\nmup deploy --config=deploy/mup.js --settings=deploy/settings.json\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '192.168.0.158',\n      username: 'root',\n      password: 'passwd'\n    }\n  },\nmeteor: {\n    name: 'deployapp',\n    path: '../',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      //serverOnly: true,\n    },\n    env: {\n      PORT: 80,\n      ROOT_URL: 'http://192.168.0.158',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n    docker: {\n      //image: 'kadirahq/meteord', // (optional)\n      //image: 'abernix/meteord:base', // use this image if using Meteor 1.4+\n    },\n//dockerImage: 'kadirahq/meteord'\ndeployCheckWaitTime: 60\n\n},\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor\n[192.168.0.158] - Pushing Meteor App Bundle to The Server\nError connect ECONNREFUSED 192.168.0.158:22\n. By the way my `settings.json` file is\n{\n  \"public\": {\n}\n}\nI tried `mup setup --config=deploy/mup.js --settings=.deploy/settings.json`\nStarted TaskList: Setup Docker\n[192.168.0.158] - setup docker\nError connect ECONNREFUSED 192.168.0.158:22\n```. I managed to get pass a zillion errors, and got stuck here:\n\n```\n[192.168.0.158] x start mongo: FAILED\n    -----------------------------------STDERR-----------------------------------\n    docker: Error response from daemon: driver failed programming external connectivity on endpoint mongodb (ddbe5537d4ea7423f9ea2f93a8efdad89be67fdcd3e1e73ecb546def9c6b9be7): Error starting userland proxy: listen tcp 127.0.0.1:27017: bind: address already in use.\n    -----------------------------------STDOUT-----------------------------------\n    latest: Pulling from library/mongo\n    Digest: sha256:d929ffc5d0871712198be82c475397e5e9c71f3d2a9fa4b304f623ad09ad204b\n    Status: Image is up to date for mongo:latest\n    mongodb\n    b26737b3472888334c621ae3172c140b0e769fd77c93525efd24776e71debd6c\n    ----------------------------------------------------------------------------\n\n```\nAny Ideas?. I fixed this by installing meteor on Ubuntu server.\nNext error i fixed by adding this:\ndocker: {\n      image: 'abernix/meteord:base', // use this image if using Meteor 1.4+\n    },\nALL SUCCESS! \nThank you all!. I solved it by SSHing in and running this command:\nps wuax | grep mongo\nthen doing a sudo kill XXXX for the ID of the mongodb instance that was running.\nNow everything is success. Hope deploy will be too.. ",
    "rohithb": "@muscaiu try adding \ndocker: {\n      image:'abernix/meteord:base',// !important for meteor 1.4\n    },\nto meteor section.  This image is build using node 4.4. (Source: kadirahq/meteor-up#172  )\nMy full mup.js file :  \n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '1.2.3.4',\n      username: 'root',\n      pem: \"/absolute/path/to/your/ssh/private/key\",\n    }\n  },\nmeteor: {\n    name: 'app',\n    path: '/absolute/path/to/your/app',\n    docker: {\n      image:'abernix/meteord:base',// !important for meteor 1.4\n    },\n    servers: {\n      one: {},\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'http://yourapp.com',\n      MONGO_URL: 'mongodb://localhost/meteor',\n    },\n    deployCheckWaitTime: 60 \n  },\nmongo: { \n    oplog: true,\n    servers: {\n      one: {},\n    },\n  },\n};\n```\n. Try adding \ndocker: {\n      image:'abernix/meteord:base', \n    }\nto the  meteor section.\n( Refer: kadirahq/meteor-up#172 )\nThe default image kadirahq/meteord uses Node 0.10. Meteor 1.4 require Node 4.4\n. A trailing comma in settings.json was the problem. \nI removed and reinstalled mup 1.2.4, its showed error in settings.json file.\n. ",
    "suyuti": "I have same problem.\nI installed mup and used to generate mup files properly.\nmup init works and generates 2 files in my .deploy folder.\nBut mup setup opens editor.. ",
    "albertonaperijr": "If you're on windows, try running mup.cmd setup instead of mup setup.. Try mup deploy --config=deploy/mup.js --settings=settings.json.. I think you need to remove the app in your meteor path. Change path: '../app' to path: '../'.\nE.g.\nmeteor: {\n    name: 'app',\n    path: '../', // mup doesn't support '~' alias for home directory\n    .... @muscaiu Try to do my latest comment then run mup deploy --config=.deploy/mup.js --settings=.deploy/settings.json. @muscaiu Did you try changing path: '../app' to path: '../'.\nI just noticed that your mup.js file is inside deploy folder so you have to run mup deploy --config=deploy/mup.js --settings=deploy/settings.json instead of mup deploy --config=.deploy/mup.js --settings=.deploy/settings.json. Just like @gaillota's comment, try changing path to ../ but also change .deploy to deploy.\nE.g. mup deploy --config=deploy/mup.js --settings=deploy/settings.json. @stubbegianni Thanks for the info. I just noticed it too. This is a huge problem especially when you put your server password in mup.js  file. I hope this will be fix soon.. That's exactly what I did. I think that's the fix for now.. I did the same thing. I'm just hoping that there's a way without manually accessing the server.. Docker restart command:\ndocker restart <container/appname>\nDocker logs command:\ndocker logs -f --tail=50 <container/appname>\nRegards. @s7dhansh You're welcome!. You can do that by declaring volumes with the host path and container path in your mup.js file just like the example in README.md.\nE.g.\nvolumes: { // lets you add docker volumes (optional)\n    \"/host/path\": \"/container/path\", // passed as '-v /host/path:/container/path' to the docker run command\n    \"/second/host/path\": \"/second/container/path\"\n}. E.g. you want to save files inside /var/uploads directory on your host server. You can declare it as '/var/uploads': '/var/uploads'.\nSo what if you want to save files inside /var/uploads directory on your host server but your meteor app is setup to save files inside /uploads directory. You can declare it as '/var/uploads': '/uploads'.\nNote: Based on my observation/experience in using docker volume. I always declared the same directory/path on both host path and container path just like the example above '/var/uploads': '/var/uploads'.\n. I guess the issue is with your env port declaration. I think you cannot use port 22. You can change it to port 80 or any port you want to use.\nE.g.\nenv: {\n    \"PORT\": 80,\n    \"ROOT_URL\": \"http://138.197.79.81/\"\n}. It looks like you're deploying for both client and server but you set serverOnly to true. Comment it out or just set it to false. \nbuildOptions: {\n    serverOnly: false // or just comment this line out.\n}. Where did you put your mup.js file? If it's inside .deploy folder then you need to change path: './' to path: '../'.. It's happening when your deployed meteor app/s are connected/using the same/default mongodb database.. ",
    "giordanocardillo": "I also added a VERIFICATION_PORT environment variable, because if you are publishing on 127.0.0.1 and under a port that differs from the deploy one (eg. under a proxy) you need to verify deployment under that port.  If falls back to the PORT enviroment variable, or 80, if not specified.\n. Please Merge, or tell me what's wrong! I need this in my deploy environment, and now I'm always going to edit that two files every time there is an update!\n. @bensventures Yes, it is possible, obviously mongodb and meteor have to be attached to the same network to talk each-other. Will review and test asap . @zodern tried all combinations, also with let's encrypt enabled. All tests were successfull! Can be merged!. @zodern why not merging?. Duplicate #299 . You're welcome! Thanks for keeping mup alive!. @yanickrochon I've tried your solution but it didn't work out... I wanted to setup load balancing using nginx, but simply it falls in name conflict with the containter names... it doesn't append the \"servers\" object key after container name.. Yep, I wrote reconfigure by mistake. I'll try again, but It happened to me three times. I'll keep you updated. . PORT is from the old version of mup, it refers to meteor port. I've seen you left config.env.PORT || 80 in modules/meteor/index.js line 131, is that intentional? Because from the documentation on the readme should be config.port. Corrected and moved to root variable deployCheckPort. Removed. Corrected and moved to docker.bind. Removed PORT and BIND from env.\nPORT is in meteor root object, and I corrected modules/meteor/index.js according to variable position. \nBIND is in docker  object now.. ",
    "bensventures": "If we are going to start using network configs to make containers talk to each other, maybe we could replace the old way of linking to the mongodb container and use network for that as well?. Sorry if this comes a bit late but here are some ideas. \nI think what might be happening is that the docker image you are using to run the app does not have that particular dependency you need. \nI am no Docker expert but as far as I understand, docker images are like mini operating systems, a bundle with all the things you need but nothing else. By default meteor-up uses a specific image built for Meteor and it is very likely that it does not have the MYSQL dependency.\nOne option would be for you to build your own custom image based on the one used by meteor-up, or better still, based on the one most people must use now with meteor 1.4: https://hub.docker.com/r/abernix/meteord/\nYou can then specify your own image in the config:\nmeteor : {\n...\n    docker: {\n            image: 'abernix/meteord:base'\n    },\n... \n}\nI have never built my own image so you'll have to do some research on that but I am hoping it is fairly straight forward.\nGood luck.. I've been using mupx and now this mup for the past year and a half and even if it was sometimes a bit tricky to get to work with meteor updates, it has been a great tool. \nHaving the choice between a few tools is always good. PM2-Meteor is a great project, and I hope the maintainers keep it going but I like how mup works and I'm hoping to continue using it for as long as possible.\nBut we can't ignore the fact that Kadira is phasing out its support. Has anyone forked this and is ready to take over? I don't think I can cope being the owner of the project but I would happily contribute to it as it is essential to my deploy strategy and my company.. you have to change the file I mentioned on your computer, not on the server. The file is located in the global node_modules folder. On a mac /usr/local/lib/node_modules/mup/lib/modules/mongo/assets/mongo-start.sh\nYou'll see code similar to what I pasted above, and you want to add the version of mongo to those lines:\n...\nsudo docker pull mongo\n...\nmongo mongod -f /mongodb.conf\nAfter that run mup setup and hopefully that should be it.. You shouldn't need to put a MONGO_URL in the config if you are running a local instance, mup will do that for you. Maybe try removing the line from the config.\nhere is mine for example:\nmodule.exports = {\n    servers: {\n        one: {\n            host: 'ip', //Staging\n            username: 'username',\n            password: 'password'\n        }\n    },\n    meteor: {\n        name: 'appname',\n        path: '../../../project',\n        port: 3000,\n        volumes: {\n            \"/var/www/app-uploads\": \"/app-uploads\", // put uploads outisde of docker\n            \"/etc/localtime\": \"/etc/localtime\" // Have docker container time same as server time\n        },\n        docker: {\n            image: 'abernix/meteord:base' // meteord image comaptible with 1.4.x\n        },\n        servers: {\n            one: {}\n        },\n        env: {\n            PORT: \"3000\",\n            ROOT_URL: 'https://websiteurl.com',\n            \"MAIL_URL\": \"smtp://smtpserverurl\"\n        },\n        enableUploadProgressBar: true,\n        deployCheckWaitTime: 60\n    },\n    mongo: {\n        oplog: true,\n        port: 27017,\n        servers: {\n            one: {}\n        }\n    }\n};. Mm not sure what is happening then. I suppose you've run mup setup and mup deploy after changing the config? Maybe check on the server the status of the Docker containers, if they are using the correct images, if they are stable (not restarting all the time)\nYou could also try stoping and deleting all the containers before doing the mup setup to start fresh.\nMake sure you don't have a local mongo already listening on the 27017 port, that would prevent the docket container from starting properly too.. For the output of docker ps it looks like your containers keep restarting. I can understand the meteor one restarting because of the mongo connection error but not sure what would be happening to the mongo container.\nA few ideas: \n check the docker logs (/var/log/upstart/docker.log on ubuntu)\n check what is running on port 27017 on the server, maybe something is already using the port and the mongo container cannot start properly\n* stop the containers and start them with the debug option docker -D start mongodb. great news @nosleepfilipe thanks for taking the time to update us :)\nHappy new years too.. Maybe post your config to see if anything looks out of the ordinary? I'm using meteor-up with meteor 1.3.4.2 and all is working fine. \nDo you get anything in the logs?. Sorry if this comes a bit late but I am using docker volumes for images, I think that's what you are looking for. Here is an excerpt of my mup.js config file:\n...\nmeteor: {\n        name: 'appname',\n        path: 'pathtoapp',\n        port: 3001,\n        volumes: {\n            \"/var/www/app-uploads\": \"/app-uploads\", // First path is path on server, second is path in docker container\n            \"/etc/localtime\": \"/etc/localtime\"\n        },\n        docker: {\n            image: 'abernix/meteord:base'\n        },\n...\nHope this helps. ",
    "Alino": "ok, so its recommended to not make mup.js part of the git repo.\nMONGO_OPLOG_URL is maybe not used by MUP, but it is being used by meteor,\nhere is a list of env variables that meteor can use http://meteorpedia.com/read/Environment_Variables\n. ",
    "nadeemja": "Same here. @arunoda, please advise. :) \n. Ok. The issue was having Cloudflare enabled while generating the SSL certificate. \nI'm guessing the app is going to break when it's time for renewal.\nCould you add Cloudflare support using the webroot command?\nhttps://support.cloudflare.com/hc/en-us/articles/214820528-How-to-Validate-a-Let-s-Encrypt-Certificate-on-a-Site-Already-Active-on-Cloudflare. Strange! \nOnly after I turned off Cloudflare did \"mup deploy\" work. After that I could turn it on again just fine. \nHow do we diagnose this? \nPlease let me know which tests I should run and I'll post the results here.. @gabimoncha \nI (think I) meant disabling Cloudflare for that particular domain, so that traffic would not pass through CF servers. :) \n. Hi again,\nUpgrading from 512MB to a 1024MB VPS fixed it (I saw a ran out of memory error somewhere).\nUsing 1.2.5 successfully now.. From the server side:\nnpm WARN enoent ENOENT: no such file or directory, open '/bundle/bundle/programs/server/package.json' \nAug 24 04:45:51 108.61.179.72 309ff639bb26: npm WARN server No description \nAug 24 04:45:51 108.61.179.72 309ff639bb26: npm WARN server No repository field. \nAug 24 04:45:51 108.61.179.72 309ff639bb26: npm WARN server No README data \nAug 24 04:45:51 108.61.179.72 309ff639bb26: npm WARN server No license field. \nAug 24 04:45:51 108.61.179.72 309ff639bb26: => Starting meteor app on port:80 \nAug 24 04:45:51 108.61.179.72 309ff639bb26: module.js:327 \nAug 24 04:45:51 108.61.179.72 309ff639bb26:     throw err; \nAug 24 04:45:51 108.61.179.72 309ff639bb26:     ^ \nAug 24 04:45:51 108.61.179.72 309ff639bb26: Error: Cannot find module './programs/server/boot.js' \nAug 24 04:45:51 108.61.179.72 309ff639bb26:     at Function.Module._resolveFilename (module.js:325:15) \nAug 24 04:45:51 108.61.179.72 309ff639bb26:     at Function.Module._load (module.js:276:25) \nAug 24 04:45:51 108.61.179.72 309ff639bb26:     at Module.require (module.js:353:17) \nAug 24 04:45:51 108.61.179.72 309ff639bb26:     at require (internal/module.js:12:17) \nAug 24 04:45:51 108.61.179.72 309ff639bb26:     at Object. (/bundle/bundle/main.js:9:1) \nAug 24 04:45:51 108.61.179.72 309ff639bb26:     at Module._compile (module.js:409:26) \nAug 24 04:45:51 108.61.179.72 309ff639bb26:     at Object.Module._extensions..js (module.js:416:10) \nAug 24 04:45:51 108.61.179.72 309ff639bb26:     at Module.load (module.js:343:32) \nAug 24 04:45:51 108.61.179.72 309ff639bb26:     at Function.Module._load (module.js:300:12) \nAug 24 04:45:51 108.61.179.72 309ff639bb26:     at Function.Module.runMain (module.js:441:10) \nAug 24 04:45:53 108.61.179.72 309ff639bb26: tar (child): *.tar.gz: Cannot open: No such file or directory \nAug 24 04:45:53 108.61.179.72 309ff639bb26: tar (child): Error is not recoverable: exiting now \nAug 24 04:45:53 108.61.179.72 309ff639bb26: tar: Child returned status 2 . Downgrading do 1.2.11 and re-deploying brings my site back online.. Cool! Thanks for the answer :)\nIs this something you'd be willing to work on if your efforts were sponsored?. Horizontal auto-scaling, mainly. :) . That's great, Zodern! \nWhat amounts would be needed to create the plugin?. Or, perhaps, you could indicate what different amounts, such as $500, $1000, $1500 etc.. would achieve :) \nI think a lot of different companies/developers would be interested in chipping in.. Cool! \nDo you have a preferred method of payment? \nI'm going to see if I can get others to join in on this effort :) . Btw, any estimates on when delivery could be expected? . Mail sent :) . I like it, @zodern! \nAlso, I've assumed that the features @derwaldgeist lists will be functional. Can you confirm? \n. @zodern \nI'm at a point were I'm close to wiring funds to your Open Collective account.\nBut, could you first share some thoughts on the kind of support and maintenance we could expect? \nRegards,\nNadeem. Hi everyone,\n@zodern and I have talked about the following arrangement per email:\n\n\nPayments are wired to https://opencollective.com/meteor-up\n\n\n50%, i.e. $ 425, is to be paid upfront, and the rest upon delivery. \n\n\nI have just wired $ 125 on Open Collective via my company, Sembly. \nPlease see: https://opencollective.com/meteor-up/transactions\nHopefully the remaining $ 300 on the upfront payment could be paid by those of you have indicated interest in doing so :) \nRegards,\nNadeem\n. Very nice guys! :) \n$ 150 to go before the upfront payment is funded.\nUnless this sum is contributed by other members of the community come Monday, I will cover it. Also, I'm guaranteeing the payment of the post-delivery $ 425, but hopefully the community will chip in :) . Great idea, @SachaG! I think @theodorDiaconu has experience using AWS and could speak to the benefits, while @zodern has already outlined the API in a comment. I wonder if this piece shouldn't go directly into the readme of MUP. What do you guys think? . Hi!\nIf I recall correctly from our emails, the delivery dates were between the 20th and 24th of November. I was supposed to post this, but have been busy with work. Will post an update today. :) . @came What name did you donate under? . I've been playing around with it. I didn't get around to push to production yet, but will do so very soon. First tests are very promising! :) . @zodern\nFrom my side, I'm OK in making the project public. Any reason why not? . Here you go :) \nbash-3.2$ DEBUG=mup* mup deploy \n  mup:plugin-loader loading plugin mup-aws-beanstalk +0ms\n  mup:plugin-loader plugin installed locally with mup +3ms\n  mup:updates checking for updates +0ms\n  mup:module:default exec => mup deploy +0ms\n=> Setting up\n=> Ensuring IAM Roles and Instance Profiles are setup\nBuilding App Bundle Locally\n  mup:module:meteor Build Path: /Users/Nadeem/Code/Meteor/Sembly +0ms\n  mup:module:meteor Build Command:  meteor build --directory /var/folders/66/4twr7b_5773gsqx67dxmkm000000gn/T/mup-meteor-ede9e102-e491-47fc-a371-4b5cf7d0e9d1 --architecture os.linux.x86_64 --server-only +0ms\nto: wrong arguments\ntoEnd: wrong arguments\n=> Archiving Bundle\n..... ",
    "magp3": "@obiwarn Does your directory /opt/hoardAdminProduction exist?\n. @obiwarn Did you change the app name after running mup setup? I encountered this issue when I did that..\n. @cyclops24 just do mup stop to stop the docker containers from running. If you wish to also remove the containers:\nuse docker rm to remove the containers which mup created. e.g.:\nas root:\ndocker ps -a\ndocker rm <containerId>\n. @cyclops24 By default mup installs mongo in a container. Use docker ps -a to list all containers and see\nif you have a container running mongo and use docker rm to remove that too.. Ok then I guess using mup stop is enough. Why do you need another approach?. @Fred-J Your path looks suspect. Do you really have a meteor project in ../appname? :). ",
    "masca88": "After hours of changing special characters and other things from configuration file I've discovered that in the ssl section, the \"certificate\" key is now changed to \"crt\".  Alleluja!\nI think that it's also your problem @obiwarn . +1. Same problem also putting config before logs. My problem is [x.x.x.x]docker: '' is not a docker command.. ",
    "frankFree": "first step: mup setup\nthen: muo deoloy\nperfect fix it. ",
    "martinmunk": "I've got this as well.\nDid you get it to run anyway?\nEdit: I put \"http://\" in front of my ROOT_URL and it worked.\n. ",
    "mattlinares": "I found this:\nhttps://github.com/arunoda/meteor-up/wiki/Setting-up-SSL-with-LetsEncrypt-and-MeteorUp\n. ",
    "jimmytidey": "Hey - Fancy seeing you here @mattlinares! \nThe Arundoa guide is for an old version on MUP. It's confusing. \nFor the new version, use the files you got from running letsencrypt on your server as follows (you don't need to do the combining files step any more).  \nmeteor: {\n    ssl: {\n      crt: 'fullchain.pem', // this is a bundle of certificates\n      key: 'privkey.pem', // this is the private key of the certificate\n      port: 443 // 443 is the default value and it's the standard HTTPS port\n    },\n   ....\n}\n. ",
    "mandreko": "Wouldn't this require me to re-push new certs every 3 months or so when they expire? Is there no way to automate it, so it re-runs on a cron task?. ",
    "sirpy": "this request is important, since if we want to use mup for building the mobile app itself (apk),\nwe usually need the --mobile-settings to be the same as server settings, so it's easier to also use the format of --mobile-settings settings.json.\nanother option is to simply let the user pass an array of arguments to the meteor build command\n['--mobile-settings settins.json']\n. thanks for the quick merge and release.\none small suggestion, why not simply make mobileSettings the location of the settings file relative to app root versus hardcoded /settings.json.\nso if mobileSettings is undefined it will not enter the if(mobileSettings) and if it is defined it will enter the if and then simply use it as the filename. well meteor gives you the option to specify the settings file, so that\nwould be the recommended way, and not using hardcoded\nOn Thu, Feb 9, 2017 at 2:50 PM, zodern notifications@github.com wrote:\n\nIn your mup.js, you can add:\nvar mobileSettings = require('path/to/mobile-settings.json');`\n{\n  ...\n  meteor: {\n    ...\n    buildOptions: {\n      mobileSettings: mobileSettings\n    }\n  }\n}\nI don't have much experience building mobile apps with meteor. Is it more\ncommon for mobileSettings to be the same as settings.json, or to be a\nseparate file?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/pull/317#issuecomment-278631775, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AAo9d4u5Wap6_AIl8nmKWtaYQEZY6wamks5rawufgaJpZM4KL7uO\n.\n. why is that necessary? except for maybe breaking changes.\nto me loading a file from the path seems the most logical and straight forward,\ni doubt anyone doesnt have the settings in a file already, so passing an object is redundant and requires the user to keep the settings correct in two places.\nthe  false/true can simply be replaced with the user writing \"settings.json\". i think this should be a warning and not an error.\nfor example i use a single host alias defined in /etc/hosts. I don't know. I guess you can also delete it. I think I saw that the\noriginal mup saved the buggy version so I just kept the same logic\n\nOn Mar 9, 2017 4:18 PM, \"Shannon Duncan\" notifications@github.com wrote:\n\nWhat is the purpose of retaining the buggy build?\nIf you are just trying to clear out current, you could just rm -rf current\nright?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/pull/522#issuecomment-285362776, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AAo9dzPszl7v8kxlsblw8WhyEyF0enSLks5rkAokgaJpZM4MXtSF\n.\n. non on the server it seems like it's doing indeed tail. the last line is always the same. the correct path is meteor.docker.prepareBundle, it worked for me\nin your mup settings json there's a field\nmeteor, under it a field docker and there you should set prepareBundle.\n\nOn Fri, Sep 15, 2017 at 9:09 AM, Niklas Appelmann notifications@github.com\nwrote:\n\nI'm trying to access my assets folder as well and having set\napp.docker.prepareBundle to false does not give me the current folder in\n/opt/app.\nAm I looking in the wrong place?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/710#issuecomment-329690960,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAo9d5l8Hq7TaJ93XYWtBdBU4TqSTt4cks5sihSvgaJpZM4PDtoS\n.\n. \n",
    "davedodea": "@elie222 apologies, my mistake. However, would you agree thats the docs should be edited to note the fact the .deploy folder will be hidden by default in MacOS so as to save confusion ?\n. ",
    "auro": "Production quality meteor deployments? Where?\nSeveral jenkins automated builds are failing now because of this return code mismatch.\nHelp guys, please!\n. Sadly we have abandoned MUP strategy, since it creates more problems than it can solve.. Hi @goooseman, how are you?! Fine i hope ;)\nThere's no secret at all, we generate the bundles right on Jenkins, then send, uncompress and deploy it on preconfigured nodejs.\nNo more surprises or fucked up docker images to deal with.. ",
    "goooseman": "anyway this is a dublicate. \ndev team said this is by design: https://github.com/kadirahq/meteor-up/issues/137\nbut maybe we can make a PR to make this configurable?\nI'm using bitbucket pipelines CI and really don't like the idea of it telling \"Build succeed\", when it wa actually failed.. @auro and what are you using now? (if it is not a secret, hah). @auro cool, smth simple is always the best option \ud83d\udc4d . there is a little bug.\nif there is no ssl section in deploy.js it is throwing an error:\n```\n[xxx.xxx.xxx.xxx] - Pushing the Startup Script\nTypeError ejs:34\n    32|   <% for(var volume in volumes) { %>-v <%= volume %>:<%= volumes[volume] %> <% } %>\\\n    33|   <% for(var args in docker.args) { %> <%= docker.args[args] %> <% } %>\\\n\n\n34|   <% if(typeof sslConfig.autogenerate === \"object\")  { %> \\\n    35|     -e \"VIRTUAL_HOST=$HOSTNAME\" \\\n    36|     -e \"LETSENCRYPT_HOST=<%= sslConfig.autogenerate.domains %>\" \\\n    37|     -e \"LETSENCRYPT_EMAIL=<%= sslConfig.autogenerate.email %>\" \\\n\n\nCannot read property 'autogenerate' of undefined\n. @brylie \nin start.sh change line no 34 to:\n  <% if(sslConfig && typeof sslConfig.autogenerate === \"object\")  { %> \\\n```\ntesting right now and will make a PR. https://github.com/mbabauer/meteor-up/pull/2. Found one more bug, when library was used without ssl. Fixed. \nhttps://github.com/mbabauer/meteor-up/pull/3. But with ssl autogenerate object it doesn't work for me.\nIt just show always 503. f## it. i'm leaving.\nwhat i have done at the end. i installed acmetool manually on the server. he checks for the new cert. and i have made a symlink to the /opt/projectName/config folder:\n```\n$APP_NAME=test\n$HOST=test.discours.io\nsudo add-apt-repository ppa:hlandau/rhea\nsudo apt-get update\nsudo apt-get install acmetool\nsudo acmetool quickstart\nsudo acmetool want $HOST\nmkdir -p /opt/$APP_NAME/config/\nrm /opt/$APP_NAME/config/bundle.crt /opt/$APP_NAME/config/private.key\nln -s /var/lib/acme/live/$HOST/fullchain /opt/$APP_NAME/config/bundle.crt\nln -s /var/lib/acme/live/$HOST/privkey /opt/$APP_NAME/config/private.key\n```. we can clone this repo: https://github.com/meteorhacks/mup-frontend-server\nmake changes, publish on DockerHub, and point your new frontend docker image in deploy.js. ",
    "fuatsengul": "Hope we see some updates on this, a fully CI compatible test-build-deploy stage support would be great!. I just solved this issue by creating a firewall rule to allow connection between docker and host. \nIn my case it was something like: \nufw allow in on docker0 to 172.17.0.1 port 7001. ",
    "artgo": "+1 we do need the same. ```\n$ mup --version\nerror: unknown option `--version'\n```\nBut we explicitly install 1.0.4 because we use Meteor 1.3.5.1\nAnd yes, I believe this ticket is a special case for https://github.com/zodern/meteor-up/issues/320 which might or might not be fixed by https://github.com/zodern/meteor-up/issues/320\n. ",
    "sdabdoub": "Yeah you can close this. I don't recall completely but it was hiding in plain sight. ",
    "pxwee5": "+1 Anyone got any idea why its calling the default text editor when invoked mup setup ?\nI also tried it on git bash but nothing happened. \n. ",
    "gaillota": "According to the documentation, it's more like mup deploy --config=.deploy/mup.js --settings=.deploy/settings.json. Can you please show us your project structure ?. Is your application located in the mydeploy folder ? Otherwise, it might be because the mup.js doesn't point to your app folder and mup can't find the app.... Try to add ./ in front of the path, from your mydeploy folder, like so:\nmup deploy --config ./deploy/mup.js --settings ./deploy/settings.js. Try changing the path to '../'. FYI, Meteor Up uses dockers images, one for mongo and one for meteor (containing node and stuff), and it previously check if docker is installed on your machine.\nYou don't have to do anything before deploying.. +1. The bundle is located in /opt/<you app name>/current/. You forget to add upload: false in the ssl config. Ok nevermind, reading the source code I think we can. Nice work !. +1. Ok, I managed to make it work. Here's what I did:\n1) Update Meteor with meteor update --patch (may not be relevant and just related to my version of Meteor)\n2) Specify the images to use in the docker option:\ndocker: {\n    image: 'abernix/meteord:base',\n    imageFrontendServer: 'meteorhacks/mup-frontend-server'\n}\nHope this works for you as well. The app start on port 80 inside the meteor container, but it exposes the port you decide in your configuration, in your case 3001. So no, I don't think that's the problem.. @maxmatthews sorry, I was answering @ivanthemeh.\nDid you try to add indexes to your Mongo database. \nA friend of mine was having serious CPU overload (it went up to 120% with just a few users) and it decreased down to ~10% when he added indexes on Mongo.\nIt was caused by some composite publications\nMaybe you can try that, see if that works. @ivanthemeh I don't think you can but it doesn't matter. All that matter is the port exposes by the container, which is the port mapped to the port 80 of the container.. ",
    "bilinkis": "Anyone knows how to solve this?\n. @marquesgabriel Thanks for your answer, but it didn't help me though. Already have that image in my mup file.\n. @marquesgabriel don't worry, thanks for your answer\n. @msj121 yes, i am indeed using Ubuntu 16.04. I had to use a different workspace and was able to deploy.\n. @msj121 thanks bro! that seems to solve the issue!\n. I actually use Cloud9, so I just created a new workspace. Hope that solves\nyour issue\nOn Oct 20, 2016 17:40, \"S\" notifications@github.com wrote:\n\nI am not too familiar with Ubuntu, what do you mean by a new workspace? On\nthe client computer? I am just trying to find a solution, do you think it\nmeant deleting all node_modules or something?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/333#issuecomment-255221928,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AFdpJ7wmo73TsvegRE5H-MP8kq4DARsNks5q19HbgaJpZM4KbTCr\n.\n. \n",
    "daemonslayer": "I ran the command and then tried deploying. Gives same error log.\nAlso as much as I know, meteor takes care of meteor npm install too. (atleast in v1.4)\n. I ported to a different docker image that works for me. 'abernix/meteord:base' is the one I am using now. \n. ",
    "lvnr": "I have the same problem when trying to deploy to Amazon EC2 (Meteor 1.4.1.2)\n. ",
    "ffigueroa": "Same problem. \nMeteor 1.4.1.2 from macOS to Ubuntu 15.04.\n. ",
    "cafe4it": "@daemonslayer \nWorks for me! \nthanks you.\n(Meteor 1.4.2.3). ",
    "marquesgabriel": "Hi, did you try to update node's version on AWS server?\n. Hello, did you try the command mup logs --tail=50?\n. Thanks for you help, it answered my question. I'm closing the issue. Again, Thanks very much\n. So, not recommended but I achieved this setting mongodb container IP on B's mup file. To know the container IP just run the command docker inspect mongo. The problem is when the containers change the IP and that application loses connection with the database.. Hi\nTry to add docker:{ image: 'abernix/meteord:base'}, on your mup.js file inside meteor definitions\n. I had this problem and having the image in the mup file solved the problem. Sorry for not helping as expected @bilinkis and @msj121 \n. ",
    "trevordowdle": "No I didn't, I assumed that MUP would/should take care of that for me.\nThat is something I can look into.  Thank you for the response.\nOn Wed, Oct 19, 2016 at 11:53 AM, Gabriel Marques notifications@github.com\nwrote:\n\nHi, did you try to update node's version on AWS server?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/326#issuecomment-254889972,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AEA_lcDNc67y3T9kukjfH_N1YfPdJqdGks5q1lkLgaJpZM4KVecv\n.\n. Thanks codeHatcher, below are the server logs... If you can deduct anything from them or verify if it was a swap file issue that would be appreciated.\n[    0.511205] ACPI: Enabled 2 GPEs in block 00 to 0F\n[    0.512110] xen:balloon: Initialising balloon driver\n[    0.528032] xen_balloon: Initialising balloon driver\n[    0.532110] vgaarb: setting as boot device: PCI:0000:00:02.0\n[    0.536000] vgaarb: device added: PCI:0000:00:02.0,decodes=io+mem,owns=io+mem,locks=none\n[    0.536006] vgaarb: loaded\n[    0.538807] vgaarb: bridge control possible 0000:00:02.0\n[    0.540193] SCSI subsystem initialized\n[    0.543820] init_memory_mapping: [mem 0x40000000-0x47ffffff]\n[    0.544929] ACPI: bus type USB registered\n[    0.548024] usbcore: registered new interface driver usbfs\n[    0.552011] usbcore: registered new interface driver hub\n[    0.556029] usbcore: registered new device driver usb\n[    0.560092] PCI: Using ACPI for IRQ routing\n[    0.564606] NetLabel: Initializing\n[    0.567710] NetLabel:  domain hash size = 128\n[    0.568004] NetLabel:  protocols = UNLABELED CIPSOv4\n[    0.570920] NetLabel:  unlabeled traffic allowed by default\n[    0.572065] HPET: 3 timers in total, 0 timers will be used for per-cpu timer\n[    0.575961] hpet0: at MMIO 0xfed00000, IRQs 2, 8, 0\n[    0.578238] hpet0: 3 comparators, 64-bit 62.500000 MHz counter\n[    0.584042] Switched to clocksource xen\n[    0.589645] AppArmor: AppArmor Filesystem Enabled\n[    0.592463] pnp: PnP ACPI init\n[    0.594622] ACPI: bus type PNP registered\n[    0.597255] system 00:00: [mem 0x00000000-0x0009ffff] could not be reserved\n[    0.601343] system 00:02: [io  0x08a0-0x08a3] has been reserved\n[    0.604893] system 00:02: [io  0x0cc0-0x0ccf] has been reserved\n[    0.608658] system 00:02: [io  0x04d0-0x04d1] has been reserved\n[    0.612305] system 00:0a: [io  0x10c0-0x1141] has been reserved\n[    0.615825] system 00:0a: [io  0xb044-0xb047] has been reserved\n[    0.633432] pnp: PnP ACPI: found 11 devices\n[    0.636285] ACPI: bus type PNP unregistered\n[    0.644257] NET: Registered protocol family 2\n[    0.647333] TCP established hash table entries: 8192 (order: 4, 65536 bytes)\n[    0.651654] TCP bind hash table entries: 8192 (order: 5, 131072 bytes)\n[    0.655688] TCP: Hash tables configured (established 8192 bind 8192)\n[    0.659309] TCP: reno registered\n[    0.661553] UDP hash table entries: 512 (order: 2, 16384 bytes)\n[    0.665009] UDP-Lite hash table entries: 512 (order: 2, 16384 bytes)\n[    0.669802] NET: Registered protocol family 1\n[    0.672562] pci 0000:00:00.0: Limiting direct PCI/PCI transfers\n[    0.675936] pci 0000:00:01.0: PIIX3: Enabling Passive Release\n[    0.679383] pci 0000:00:01.0: Activating ISA DMA hang workarounds\n[    0.683487] Trying to unpack rootfs image as initramfs...\n[    1.010459] Freeing initrd memory: 24236K (ffff88003509a000 - ffff880036845000)\n[    1.015193] microcode: CPU0 sig=0x306f2, pf=0x1, revision=0x2b\n[    1.018653] microcode: Microcode Update Driver: v2.00 tigran@aivazian.fsnet.co.uk, Peter Oruba\n[    1.023627] Scanning for low memory corruption every 60 seconds\n[    1.027320] Initialise system trusted keyring\n[    1.030065] audit: initializing netlink socket (disabled)\n[    1.033466] type=2000 audit(1475387191.617:1): initialized\n[    1.058367] HugeTLB registered 2 MB page size, pre-allocated 0 pages\n[    1.062743] zbud: loaded\n[    1.064726] VFS: Disk quotas dquot_6.5.2\n[    1.067229] Dquot-cache hash table entries: 512 (order 0, 4096 bytes)\n[    1.071219] fuse init (API version 7.22)\n[    1.074046] msgmni has been set to 1979\n[    1.076479] Key type big_key registered\n[    1.079083] Key type asymmetric registered\n[    1.082210] Asymmetric key parser 'x509' registered\n[    1.085265] Block layer SCSI generic (bsg) driver version 0.4 loaded (major 252)\n[    1.089993] io scheduler noop registered\n[    1.092574] io scheduler deadline registered (default)\n[    1.095815] io scheduler cfq registered\n[    1.098422] pci_hotplug: PCI Hot Plug PCI Core version: 0.5\n[    1.101675] pciehp: PCI Express Hot Plug Controller Driver version: 0.4\n[    1.105637] ipmi message handler version 39.2\n[    1.108515] input: Power Button as /devices/LNXSYSTM:00/LNXPWRBN:00/input/input0\n[    1.113005] ACPI: Power Button [PWRF]\n[    1.115462] input: Sleep Button as /devices/LNXSYSTM:00/LNXSLPBN:00/input/input1\n[    1.119966] ACPI: Sleep Button [SLPF]\n[    1.122466] GHES: HEST is not enabled!\n[    1.125314] xen:grant_table: Grant tables using version 1 layout\n[    1.128819] Grant table initialized\n[    1.131215] Cannot get hvm parameter CONSOLE_EVTCHN (18): -22!\n[    1.134742] Serial: 8250/16550 driver, 32 ports, IRQ sharing enabled\n[    1.165182] 00:09: ttyS0 at I/O 0x3f8 (irq = 4, base_baud = 115200) is a 16550A\n[    1.170983] Linux agpgart interface v0.103\n[    1.174443] brd: module loaded\n[    1.177077] loop: module loaded\n[    1.195627] scsi0 : ata_piix\n[    1.198516] scsi1 : ata_piix\n[    1.200963] ata1: PATA max MWDMA2 cmd 0x1f0 ctl 0x3f6 bmdma 0xc100 irq 14\n[    1.205293] ata2: PATA max MWDMA2 cmd 0x170 ctl 0x376 bmdma 0xc108 irq 15\n[    1.211573] libphy: Fixed MDIO Bus: probed\n[    1.214692] tun: Universal TUN/TAP device driver, 1.6\n[    1.218164] tun: (C) 1999-2004 Max Krasnyansky maxk@qualcomm.com\n[    1.222349] PPP generic driver version 2.4.2\n[    1.225529] xen_netfront: Initialising Xen virtual ethernet driver\n[    1.254897] ehci_hcd: USB 2.0 'Enhanced' Host Controller (EHCI) Driver\n[    1.259668] ehci-pci: EHCI PCI platform driver\n[    1.263082] ehci-platform: EHCI generic platform driver\n[    1.266451] ohci_hcd: USB 1.1 'Open' Host Controller (OHCI) Driver\n[    1.270366] ohci-pci: OHCI PCI platform driver\n[    1.273133] ohci-platform: OHCI generic platform driver\n[    1.276448] uhci_hcd: USB Universal Host Controller Interface driver\n[    1.282404] i8042: PNP: PS/2 Controller [PNP0303:PS2K,PNP0f13:PS2M] at 0x60,0x64 irq 1,12\n[    1.291838] serio: i8042 KBD port at 0x60,0x64 irq 1\n[    1.296225] serio: i8042 AUX port at 0x60,0x64 irq 12\n[    1.300807] mousedev: PS/2 mouse device common for all mice\n[    1.305847] input: AT Translated Set 2 keyboard as /devices/platform/i8042/serio0/input/input2\n[    1.313101] rtc_cmos 00:04: rtc core: registered rtc_cmos as rtc0\n[    1.319265] rtc_cmos 00:04: alarms up to one day, 114 bytes nvram, hpet irqs\n[    1.325268] device-mapper: uevent: version 1.0.3\n[    1.328461] device-mapper: ioctl: 4.27.0-ioctl (2013-10-30) initialised: dm-devel@redhat.com\n[    1.335749] ledtrig-cpu: registered to indicate activity on CPUs\n[    1.341293] TCP: cubic registered\n[    1.343943] NET: Registered protocol family 10\n[    1.349072] NET: Registered protocol family 17\n[    1.352624] Key type dns_resolver registered\n[    1.357737] Loading compiled-in X.509 certificates\n[    1.361794] Loaded X.509 cert 'Magrathea: Glacier signing key: 5ce91a5f5a603a312b28b6e022cb5618e5dc44ed'\n[    1.369639] registered taskstats version 1\n[    1.373443] blkfront: xvda: barrier or flush: disabled; persistent grants: disabled; indirect descriptors: enabled;\n[    1.380406] Key type trusted registered\n[    1.386031]  xvda: xvda1\n[    1.388731] Key type encrypted registered\n[    1.391433] AppArmor: AppArmor sha1 policy hashing enabled\n[    1.395042] IMA: No TPM chip found, activating TPM-bypass!\n[    1.398935] xenbus_probe_frontend: Device with no driver: device/vfb/0\n[    1.402830] regulator-dummy: disabling\n[    1.405338]   Magic number: 4:936:768\n[    1.407627] rtc_cmos 00:04: setting system clock to 2016-10-02 05:46:32 UTC (1475387192)\n[    1.412365] BIOS EDD facility v0.16 2004-Jun-25, 0 devices found\n[    1.415852] EDD information not available.\n[    1.419908] Freeing unused kernel memory: 1336K (ffffffff81d20000 - ffffffff81e6e000)\n[    1.424596] Write protecting the kernel read-only data: 12288k\n[    1.428358] Freeing unused kernel memory: 760K (ffff880001742000 - ffff880001800000)\n[    1.434237] Freeing unused kernel memory: 680K (ffff880001b56000 - ffff880001c00000)\nLoading, please wait...\n[    1.452195] systemd-udevd[126]: starting version 204\n[    1.473750] [drm] Initialized drm 1.1.0 20060810\n[    1.498273] FDC 0 is a S82078B\n[    1.536104] [TTM] Zone  kernel: Available graphics memory: 508152 kiB\n[    1.539918] [TTM] Initializing pool allocator\n[    1.545235] [TTM] Initializing DMA pool allocator\n[    1.548531] [drm] fb mappable at 0x0\n[    1.551004] [drm] vram aper at 0x0\n[    1.553247] [drm] size 0\n[    1.555202] [drm] fb depth is 24\n[    1.557432] [drm]    pitch is 3072\n[    1.559841] fbcon: cirrusdrmfb (fb0) is primary device\n[    1.604467] Console: switching to colour frame buffer device 128x48\n[    1.651540] cirrus 0000:00:02.0: fb0: cirrusdrmfb frame buffer device\n[    1.654825] cirrus 0000:00:02.0: registered panic notifier\n[    1.657292] [drm] Initialized cirrus 1.0.0 20110418 for 0000:00:02.0 on minor 0\nBegin: Loading essential drivers ... done.\nBegin: Running /scripts/init-premount ... done.\nBegin: Mounting root file system ... Begin: Running /scripts/local-top ... done.\nBegin: Running /scripts/local-premount ... done.\n[    1.811504] EXT4-fs (xvda1): mounted filesystem with ordered data mode. Opts: (null)\nBegin: Running /scripts/local-bottom ... done.\ndone.\nBegin: Running /scripts/init-bottom ... done.\n[    2.012088] tsc: Refined TSC clocksource calibration: 2399.997 MHz\n[    2.033558] random: init urandom read with 52 bits of entropy available\n- Stopping Send an event to indicate plymouth is up\u001b[74G[ OK ]\n- Starting Mount filesystems on boot\u001b[74G[ OK ]\n- Starting Populate and link to /run filesystem\u001b[74G[ OK ]\n- Stopping Populate and link to /run filesystem\u001b[74G[ OK ]\n- Starting Initialize or finalize resolvconf\u001b[74G[ OK ]\n[    2.209862] EXT4-fs (xvda1): re-mounted. Opts: discard\n- Stopping Track if upstart is running in a container\u001b[74G[ OK ]\n- Starting Signal sysvinit that the rootfs is mounted\u001b[74G[ OK ]\n- Starting mount available cgroup filesystems\u001b[74G[ OK ]\n- Starting Clean /tmp directory\u001b[74G[ OK ]\n[    2.531474] input: ImExPS/2 Generic Explorer Mouse as /devices/platform/i8042/serio1/input/input4\n- Stopping Clean /tmp directory\u001b[74G[ OK ]\nCloud-init v. 0.7.5 running 'init-local' at Sun, 02 Oct 2016 05:46:33 +0000. Up 2.88 seconds.\ncloud-init-nonet[3.12]: waiting 10 seconds for network device\n- Starting set console keymap\u001b[74G[ OK ]\n- Starting Signal sysvinit that virtual filesystems are mounted\u001b[74G[ OK ]\n- Starting Signal sysvinit that virtual filesystems are mounted\u001b[74G[ OK ]\n- Starting Bridge udev events into upstart\u001b[74G[ OK ]\n- Starting Signal sysvinit that remote filesystems are mounted\u001b[74G[ OK ]\n- Starting device node and kernel event manager\u001b[74G[ OK ]\n- Stopping set console keymap\u001b[74G[ OK ]\n- Starting cold plug devices\u001b[74G[ OK ]\n  [    3.292353] piix4_smbus 0000:00:01.3: SMBus base address uninitialized - upgrade BIOS or use force_addr=0xaddr\n- Starting log initial device creation\u001b[74G[ OK ]\n- Starting Uncomplicated firewall\u001b[74G[ OK ]\n- Starting configure network device security\u001b[74G[ OK ]\n- Starting configure network device security\u001b[74G[ OK ]\n- Starting Mount network filesystems\u001b[74G[ OK ]\n- Stopping Mount network filesystems\u001b[74G[ OK ]\n- Starting Bridge socket events into upstart\u001b[74G[ OK ]\n- Starting configure network device\u001b[74G[ OK ]\n- Starting Mount network filesystems\u001b[74G[ OK ]\n- Stopping Mount network filesystems\u001b[74G[ OK ]\ncloud-init-nonet[3.78]: static networking is now up\n- Starting configure network device\u001b[74G[ OK ]\nCloud-init v. 0.7.5 running 'init' at Sun, 02 Oct 2016 05:46:35 +0000. Up 3.95 seconds.\nci-info: ++++++++++++++++++++++++++Net device info+++++++++++++++++++++++++++\nci-info: +--------+------+--------------+---------------+-------------------+\nci-info: | Device |  Up  |   Address    |      Mask     |     Hw-Address    |\nci-info: +--------+------+--------------+---------------+-------------------+\nci-info: |   lo   | True |  127.0.0.1   |   255.0.0.0   |         .         |\nci-info: |  eth0  | True | 172.31.43.15 | 255.255.240.0 | 06:a3:9e:62:37:bb |\nci-info: +--------+------+--------------+---------------+-------------------+\nci-info: +++++++++++++++++++++++++++++++Route info++++++++++++++++++++++++++++++++\nci-info: +-------+-------------+-------------+---------------+-----------+-------+\nci-info: | Route | Destination |   Gateway   |    Genmask    | Interface | Flags |\nci-info: +-------+-------------+-------------+---------------+-----------+-------+\nci-info: |   0   |   0.0.0.0   | 172.31.32.1 |    0.0.0.0    |    eth0   |   UG  |\nci-info: |   1   | 172.31.32.0 |   0.0.0.0   | 255.255.240.0 |    eth0   |   U   |\nci-info: +-------+-------------+-------------+---------------+-----------+-------+\n- Starting Signal sysvinit that local filesystems are mounted\u001b[74G[ OK ]\n- Stopping Mount filesystems on boot\u001b[74G[ OK ]\n- Starting flush early job output to logs\u001b[74G[ OK ]\n- Stopping Failsafe Boot Delay\u001b[74G[ OK ]\n- Starting System V initialisation compatibility\u001b[74G[ OK ]\n- Stopping flush early job output to logs\u001b[74G[ OK ]\n- Starting D-Bus system message bus\u001b[74G[ OK ]\n- Starting SystemD login management service\u001b[74G[ OK ]\n- Starting system logging daemon\u001b[74G[ OK ]\n- Starting early crypto disks...       \u001b[80G \n  \u001b[74G[ OK ]\n- Starting Handle applying cloud-config\u001b[74G[ OK ]\n- Starting Bridge file events into upstart\u001b[74G[ OK ]\nSkipping profile in /etc/apparmor.d/disable: usr.sbin.rsyslogd\n- Starting AppArmor profiles       \u001b[80G \n  \u001b[74G[ OK ]\n- Stopping System V initialisation compatibility\u001b[74G[ OK ]\nopen-vm-tools: not starting as this is not a VMware VM\nlandscape-client is not configured, please run landscape-config.\n- Starting System V runlevel compatibility\u001b[74G[ OK ]\n- Starting Meteor Up - boldvue\u001b[74G[ OK ]\n- Starting ACPI daemon\u001b[74G[ OK ]\n- Starting starting stud\u001b[74G[ OK ]\n- Starting save kernel messages\u001b[74G[ OK ]\n- Starting configure network device security\u001b[74G[ OK ]\n- Starting OpenSSH server\u001b[74G[ OK ]\n- Starting regular background program processing daemon\u001b[74G[ OK ]\n- Starting deferred execution scheduler\u001b[74G[ OK ]\n- Stopping save kernel messages\u001b[74G[ OK ]\n- Stopping CPU interrupts balancing daemon\u001b[74G[ OK ]\n- Starting configure virtual network devices\u001b[74G[ OK ]\n- Starting automatic crash report generation\u001b[74G[ OK ]\n- Starting Docker daemon\u001b[74G[ OK ]\n- Restoring resolver state...       \u001b[80G \n  \u001b[74G[ OK ]\n- Stopping System V runlevel compatibility\u001b[74G[ OK ]\nCloud-init v. 0.7.5 running 'modules:config' at Sun, 02 Oct 2016 05:46:36 +0000. Up 5.30 seconds.\nCloud-init v. 0.7.5 running 'modules:final' at Sun, 02 Oct 2016 05:46:36 +0000. Up 5.90 seconds.\nCloud-init v. 0.7.5 finished at Sun, 02 Oct 2016 05:46:37 +0000. Datasource DataSourceEc2.  Up 6.07 seconds\nUbuntu 14.04.2 LTS ip-172-31-43-15 ttyS0\nip-172-31-43-15 login: [    6.495722] aufs au_opts_parse:1155:dockerd[1039]: unknown option dirperm1\nThu Oct 13 03:16:45 UTC 2016: shutting down for reboot [up 941413s].\nwait-for-state stop/waiting\n- Stopping landscape-client daemon       \u001b[80G \n  \u001b[74G[\u001b[31mfail\u001b[39;49m]\n- Stopping rsync daemon rsync       \u001b[80G \n  \u001b[74G[ OK ]\n- Stopping open-vm guest daemon vmtoolsd       \u001b[80G \n  \u001b[74G[ OK ]\n- Asking all remaining processes to terminate...       \u001b[80G \n  \u001b[74G[ OK ]\n- All processes ended within 2 seconds...       \u001b[80G \n  \u001b[74G[ OK ]\n- Deactivating swap...       \u001b[80G \n  \u001b[74G[ OK ]\n- Stopping early crypto disks...       \u001b[80G \n  \u001b[74G[ OK ]\n- Will now restart\n  [941415.850686] reboot: Restarting system\n  [    0.000000] Initializing cgroup subsys cpuset\n  [    0.000000] Initializing cgroup subsys cpu\n  [    0.000000] Initializing cgroup subsys cpuacct\n  [    0.000000] Linux version 3.13.0-96-generic (buildd@lcy01-09) (gcc version 4.8.4 (Ubuntu 4.8.4-2ubuntu1~14.04.3) ) #143-Ubuntu SMP Mon Aug 29 20:15:20 UTC 2016 (Ubuntu 3.13.0-96.143-generic 3.13.11-ckt39)\n  [    0.000000] Command line: BOOT_IMAGE=/boot/vmlinuz-3.13.0-96-generic root=UUID=c70a26ec-1dda-455c-acfd-792015b2bb6f ro console=tty1 console=ttyS0\n  [    0.000000] KERNEL supported cpus:\n  [    0.000000]   Intel GenuineIntel\n  [    0.000000]   AMD AuthenticAMD\n  [    0.000000]   Centaur CentaurHauls\n  [    0.000000] e820: BIOS-provided physical RAM map:\n  [    0.000000] BIOS-e820: [mem 0x0000000000000000-0x000000000009dfff] usable\n  [    0.000000] BIOS-e820: [mem 0x000000000009e000-0x000000000009ffff] reserved\n  [    0.000000] BIOS-e820: [mem 0x00000000000e0000-0x00000000000fffff] reserved\n  [    0.000000] BIOS-e820: [mem 0x0000000000100000-0x000000003fffffff] usable\n  [    0.000000] BIOS-e820: [mem 0x00000000fc000000-0x00000000ffffffff] reserved\n  [    0.000000] NX (Execute Disable) protection: active\n  [    0.000000] SMBIOS 2.4 present.\n  [    0.000000] Hypervisor detected: Xen HVM\n  [    0.000000] Xen version 4.2.\n  [    0.000000] Netfront and the Xen platform PCI driver have been compiled for this kernel: unplug emulated NICs.\n  [    0.000000] Blkfront and the Xen platform PCI driver have been compiled for this kernel: unplug emulated disks.\n  [    0.000000] You might have to change the root device\n  [    0.000000] from /dev/hd[a-d] to /dev/xvd[a-d]\n  [    0.000000] in your root= kernel command line option\n  [    0.000000] No AGP bridge found\n  [    0.000000] e820: last_pfn = 0x40000 max_arch_pfn = 0x400000000\n  [    0.000000] x86 PAT enabled: cpu 0, old 0x7040600070406, new 0x7010600070106\n  [    0.000000] found SMP MP-table at [mem 0x000fbe00-0x000fbe0f] mapped at [ffff8800000fbe00]\n  [    0.000000] Scanning 1 areas for low memory corruption\n  [    0.000000] init_memory_mapping: [mem 0x00000000-0x000fffff]\n  [    0.000000] init_memory_mapping: [mem 0x3fe00000-0x3fffffff]\n  [    0.000000] init_memory_mapping: [mem 0x3c000000-0x3fdfffff]\n  [    0.000000] init_memory_mapping: [mem 0x00100000-0x3bffffff]\n  [    0.000000] RAMDISK: [mem 0x3509a000-0x36844fff]\n  [    0.000000] ACPI: RSDP 00000000000ea020 000024 (v02    Xen)\n  [    0.000000] ACPI: XSDT 00000000fc00f5a0 000054 (v01    Xen      HVM 00000000 HVML 00000000)\n  [    0.000000] ACPI: FACP 00000000fc00f260 0000F4 (v04    Xen      HVM 00000000 HVML 00000000)\n  [    0.000000] ACPI: DSDT 00000000fc0035e0 00BBF6 (v02    Xen      HVM 00000000 INTL 20090123)\n  [    0.000000] ACPI: FACS 00000000fc0035a0 000040\n  [    0.000000] ACPI: APIC 00000000fc00f360 0000D8 (v02    Xen      HVM 00000000 HVML 00000000)\n  [    0.000000] ACPI: HPET 00000000fc00f4b0 000038 (v01    Xen      HVM 00000000 HVML 00000000)\n  [    0.000000] ACPI: WAET 00000000fc00f4f0 000028 (v01    Xen      HVM 00000000 HVML 00000000)\n  [    0.000000] ACPI: SSDT 00000000fc00f520 000031 (v02    Xen      HVM 00000000 INTL 20090123)\n  [    0.000000] ACPI: SSDT 00000000fc00f560 000031 (v02    Xen      HVM 00000000 INTL 20090123)\n  [    0.000000] No NUMA configuration found\n  [    0.000000] Faking a node at [mem 0x0000000000000000-0x000000003fffffff]\n  [    0.000000] Initmem setup node 0 [mem 0x00000000-0x3fffffff]\n  [    0.000000]   NODE_DATA [mem 0x3fffb000-0x3fffffff]\n  [    0.000000] Zone ranges:\n  [    0.000000]   DMA      [mem 0x00001000-0x00ffffff]\n  [    0.000000]   DMA32    [mem 0x01000000-0xffffffff]\n  [    0.000000]   Normal   empty\n  [    0.000000] Movable zone start for each node\n  [    0.000000] Early memory node ranges\n  [    0.000000]   node   0: [mem 0x00001000-0x0009dfff]\n  [    0.000000]   node   0: [mem 0x00100000-0x3fffffff]\n  [    0.000000] ACPI: PM-Timer IO Port: 0xb008\n  [    0.000000] ACPI: LAPIC (acpi_id[0x00] lapic_id[0x00] enabled)\n  [    0.000000] ACPI: LAPIC (acpi_id[0x01] lapic_id[0x00] disabled)\n  [    0.000000] ACPI: LAPIC (acpi_id[0x02] lapic_id[0x00] disabled)\n  [    0.000000] ACPI: LAPIC (acpi_id[0x03] lapic_id[0x00] disabled)\n  [    0.000000] ACPI: LAPIC (acpi_id[0x04] lapic_id[0x00] disabled)\n  [    0.000000] ACPI: LAPIC (acpi_id[0x05] lapic_id[0x00] disabled)\n  [    0.000000] ACPI: LAPIC (acpi_id[0x06] lapic_id[0x00] disabled)\n  [    0.000000] ACPI: LAPIC (acpi_id[0x07] lapic_id[0x00] disabled)\n  [    0.000000] ACPI: LAPIC (acpi_id[0x08] lapic_id[0x00] disabled)\n  [    0.000000] ACPI: LAPIC (acpi_id[0x09] lapic_id[0x00] disabled)\n  [    0.000000] ACPI: LAPIC (acpi_id[0x0a] lapic_id[0x00] disabled)\n  [    0.000000] ACPI: LAPIC (acpi_id[0x0b] lapic_id[0x00] disabled)\n  [    0.000000] ACPI: LAPIC (acpi_id[0x0c] lapic_id[0x00] disabled)\n  [    0.000000] ACPI: LAPIC (acpi_id[0x0d] lapic_id[0x00] disabled)\n  [    0.000000] ACPI: LAPIC (acpi_id[0x0e] lapic_id[0x00] disabled)\n  [    0.000000] ACPI: IOAPIC (id[0x01] address[0xfec00000] gsi_base[0])\n  [    0.000000] IOAPIC[0]: apic_id 1, version 17, address 0xfec00000, GSI 0-47\n  [    0.000000] ACPI: INT_SRC_OVR (bus 0 bus_irq 0 global_irq 2 dfl dfl)\n  [    0.000000] ACPI: INT_SRC_OVR (bus 0 bus_irq 5 global_irq 5 low level)\n  [    0.000000] ACPI: INT_SRC_OVR (bus 0 bus_irq 10 global_irq 10 low level)\n  [    0.000000] ACPI: INT_SRC_OVR (bus 0 bus_irq 11 global_irq 11 low level)\n  [    0.000000] Using ACPI (MADT) for SMP configuration information\n  [    0.000000] ACPI: HPET id: 0x8086a201 base: 0xfed00000\n  [    0.000000] smpboot: Allowing 15 CPUs, 14 hotplug CPUs\n  [    0.000000] PM: Registered nosave memory: [mem 0x0009e000-0x0009ffff]\n  [    0.000000] PM: Registered nosave memory: [mem 0x000a0000-0x000dffff]\n  [    0.000000] PM: Registered nosave memory: [mem 0x000e0000-0x000fffff]\n  [    0.000000] e820: [mem 0x40000000-0xfbffffff] available for PCI devices\n  [    0.000000] Booting paravirtualized kernel on Xen HVM\n  [    0.000000] setup_percpu: NR_CPUS:256 nr_cpumask_bits:256 nr_cpu_ids:15 nr_node_ids:1\n  [    0.000000] PERCPU: Embedded 27 pages/cpu @ffff88003fc00000 s81536 r8192 d20864 u131072\n  [    0.000000] Built 1 zonelists in Node order, mobility grouping on.  Total pages: 257928\n  [    0.000000] Policy zone: DMA32\n  [    0.000000] Kernel command line: BOOT_IMAGE=/boot/vmlinuz-3.13.0-96-generic root=UUID=c70a26ec-1dda-455c-acfd-792015b2bb6f ro console=tty1 console=ttyS0\n  [    0.000000] PID hash table entries: 4096 (order: 3, 32768 bytes)\n  [    0.000000] xsave: enabled xstate_bv 0x7, cntxt size 0x340\n  [    0.000000] Checking aperture...\n  [    0.000000] No AGP bridge found\n  [    0.000000] Memory: 989292K/1048180K available (7420K kernel code, 1146K rwdata, 3416K rodata, 1336K init, 1448K bss, 58888K reserved)\n  [    0.000000] SLUB: HWalign=64, Order=0-3, MinObjects=0, CPUs=15, Nodes=1\n  [    0.000000] Hierarchical RCU implementation.\n  [    0.000000]    RCU dyntick-idle grace-period acceleration is enabled.\n  [    0.000000]    RCU restricting CPUs from NR_CPUS=256 to nr_cpu_ids=15.\n  [    0.000000]    Offload RCU callbacks from all CPUs\n  [    0.000000]    Offload RCU callbacks from CPUs: 0-14.\n  [    0.000000] NR_IRQS:16640 nr_irqs:1208 16\n  [    0.000000] xen:events: Xen HVM callback vector for event delivery is enabled\n  [    0.000000] Console: colour VGA+ 80x25\n  [    0.000000] console [tty1] enabled\n  [    0.000000] Cannot get hvm parameter CONSOLE_EVTCHN (18): -22!\n  [    0.000000] console [ttyS0] enabled\n  [    0.000000] allocated 4194304 bytes of page_cgroup\n  [    0.000000] please try 'cgroup_disable=memory' option if you don't want memory cgroups\n  [    0.000000] tsc: Detected 2400.090 MHz processor\n  [    0.008000] Calibrating delay loop (skipped), value calculated using timer frequency.. 4800.18 BogoMIPS (lpj=9600360)\n  [    0.014725] pid_max: default: 32768 minimum: 301\n  [    0.016048] Security Framework initialized\n  [    0.020028] AppArmor: AppArmor initialized\n  [    0.024003] Yama: becoming mindful.\n  [    0.028104] Dentry cache hash table entries: 131072 (order: 8, 1048576 bytes)\n  [    0.036034] Inode-cache hash table entries: 65536 (order: 7, 524288 bytes)\n  [    0.040084] Mount-cache hash table entries: 2048 (order: 2, 16384 bytes)\n  [    0.048004] Mountpoint-cache hash table entries: 2048 (order: 2, 16384 bytes)\n  [    0.052180] Initializing cgroup subsys memory\n  [    0.056010] Initializing cgroup subsys devices\n  [    0.060006] Initializing cgroup subsys freezer\n  [    0.064003] Initializing cgroup subsys blkio\n  [    0.068002] Initializing cgroup subsys perf_event\n  [    0.072008] Initializing cgroup subsys hugetlb\n  [    0.076062] CPU: Physical Processor ID: 0\n  [    0.080754] mce: CPU supports 2 MCE banks\n  [    0.084022] Last level iTLB entries: 4KB 0, 2MB 0, 4MB 0\n  [    0.084022] Last level dTLB entries: 4KB 64, 2MB 0, 4MB 0\n  [    0.084022] tlb_flushall_shift: 6\n  [    0.112477] ACPI: Core revision 20131115\n  [    0.119056] ACPI: All ACPI Tables successfully acquired\n  [    0.124979] ftrace: allocating 28614 entries in 112 pages\n  [    0.153282] Switched APIC routing to physical flat.\n  [    0.162376] ..TIMER: vector=0x30 apic1=0 pin1=2 apic2=0 pin2=0\n  [    0.207603] smpboot: CPU0: Intel(R) Xeon(R) CPU E5-2676 v3 @ 2.40GHz (fam: 06, model: 3f, stepping: 02)\n  [    0.216016] installing Xen timer for CPU 0\n  [    0.220069] cpu 0 spinlock event irq 69\n  [    0.228271] Performance Events: unsupported p6 CPU model 63 no PMU driver, software events only.\n  [    0.237099] x86: Booted up 1 node, 1 CPUs\n  [    0.240007] smpboot: Total of 1 processors activated (4800.18 BogoMIPS)\n  [    0.244305] NMI watchdog: disabled (cpu0): hardware events not enabled\n  [    0.248217] devtmpfs: initialized\n  [    0.253473] EVM: security.selinux\n  [    0.256005] EVM: security.SMACK64\n  [    0.259177] EVM: security.ima\n  [    0.260003] EVM: security.capability\n  [    0.264132] pinctrl core: initialized pinctrl subsystem\n  [    0.268072] regulator-dummy: no parameters\n  [    0.272029] RTC time:  3:17:23, date: 10/13/16\n  [    0.276041] NET: Registered protocol family 16\n  [    0.280137] cpuidle: using governor ladder\n  [    0.284004] cpuidle: using governor menu\n  [    0.287604] ACPI: bus type PCI registered\n  [    0.288004] acpiphp: ACPI Hot Plug PCI Controller Driver version: 0.5\n  [    0.292425] PCI: Using configuration type 1 for base access\n  [    0.296601] bio: create slab  at 0\n  [    0.300158] ACPI: Added _OSI(Module Device)\n  [    0.303837] ACPI: Added _OSI(Processor Device)\n  [    0.304004] ACPI: Added _OSI(3.0 _SCP Extensions)\n  [    0.308006] ACPI: Added _OSI(Processor Aggregator Device)\n  [    0.315266] ACPI: Interpreter enabled\n  [    0.316008] ACPI Exception: AE_NOT_FOUND, While evaluating Sleep State S1\n  [    0.322276] ACPI Exception: AE_NOT_FOUND, While evaluating Sleep State S2\n  [    0.328018] ACPI: (supports S0 S3 S4 S5)\n  [    0.331665] ACPI: Using IOAPIC for interrupt routing\n  [    0.332056] PCI: Using host bridge windows from ACPI; if necessary, use \"pci=nocrs\" and report a bug\n  [    0.358617] ACPI: No dock devices found.\n  [    0.406750] ACPI: PCI Root Bridge PCI0\n  [    0.408011] acpi PNP0A03:00: _OSC: OS supports [ASPM ClockPM Segments MSI]\n  [    0.412012] acpi PNP0A03:00: _OSC failed (AE_NOT_FOUND); disabling ASPM\n  [    0.416083] acpi PNP0A03:00: fail to add MMCONFIG information, can't access extended PCI configuration space under this bridge.\n  [    0.420732] acpiphp: Slot [0] registered\n  [    0.425164] acpiphp: Slot [3] registered\n  [    0.428378] acpiphp: Slot [4] registered\n  [    0.432369] acpiphp: Slot [5] registered\n  [    0.436257] acpiphp: Slot [6] registered\n  [    0.440525] acpiphp: Slot [7] registered\n  [    0.444351] acpiphp: Slot [8] registered\n  [    0.448375] acpiphp: Slot [9] registered\n  [    0.452371] acpiphp: Slot [10] registered\n  [    0.456284] acpiphp: Slot [11] registered\n  [    0.460414] acpiphp: Slot [12] registered\n  [    0.464341] acpiphp: Slot [13] registered\n  [    0.468250] acpiphp: Slot [14] registered\n  [    0.472099] acpiphp: Slot [15] registered\n  [    0.476017] acpiphp: Slot [16] registered\n  [    0.479839] acpiphp: Slot [17] registered\n  [    0.480376] acpiphp: Slot [18] registered\n  [    0.484236] acpiphp: Slot [19] registered\n  [    0.488124] acpiphp: Slot [20] registered\n  [    0.492011] acpiphp: Slot [21] registered\n  [    0.495859] acpiphp: Slot [22] registered\n  [    0.496369] acpiphp: Slot [23] registered\n  [    0.500418] acpiphp: Slot [24] registered\n  [    0.504418] acpiphp: Slot [25] registered\n  [    0.508404] acpiphp: Slot [26] registered\n  [    0.512370] acpiphp: Slot [27] registered\n  [    0.516387] acpiphp: Slot [28] registered\n  [    0.520251] acpiphp: Slot [29] registered\n  [    0.524538] acpiphp: Slot [30] registered\n  [    0.528398] acpiphp: Slot [31] registered\n  [    0.532427] PCI host bridge to bus 0000:00\n  [    0.536006] pci_bus 0000:00: root bus resource [bus 00-ff]\n  [    0.540008] pci_bus 0000:00: root bus resource [io  0x0000-0x0cf7]\n  [    0.544008] pci_bus 0000:00: root bus resource [io  0x0d00-0xffff]\n  [    0.548006] pci_bus 0000:00: root bus resource [mem 0x000a0000-0x000bffff]\n  [    0.552008] pci_bus 0000:00: root bus resource [mem 0xf0000000-0xfbffffff]\n  [    0.564423] * Found PM-Timer Bug on the chipset. Due to workarounds for a bug,\n  [    0.564423] * this clock source is slow. Consider trying other clock sources\n  [    0.569759] pci 0000:00:01.3: quirk: [io  0xb000-0xb03f] claimed by PIIX4 ACPI\n  [    0.579958] ACPI: PCI Interrupt Link LNKA\n  [    0.584072] ACPI: PCI Interrupt Link LNKB\n  [    0.591365] ACPI: PCI Interrupt Link LNKC\n  [    0.596136] ACPI: PCI Interrupt Link LNKD\n  [    0.624817] ACPI: Enabled 2 GPEs in block 00 to 0F\n  [    0.628106] xen:balloon: Initialising balloon driver\n  [    0.640010] xen_balloon: Initialising balloon driver\n  [    0.644112] vgaarb: setting as boot device: PCI:0000:00:02.0\n  [    0.648000] vgaarb: device added: PCI:0000:00:02.0,decodes=io+mem,owns=io+mem,locks=none\n  [    0.648012] vgaarb: loaded\n  [    0.651072] vgaarb: bridge control possible 0000:00:02.0\n  [    0.652187] SCSI subsystem initialized\n  [    0.655743] init_memory_mapping: [mem 0x40000000-0x47ffffff]\n  [    0.656916] ACPI: bus type USB registered\n  [    0.660030] usbcore: registered new interface driver usbfs\n  [    0.664014] usbcore: registered new interface driver hub\n  [    0.668034] usbcore: registered new device driver usb\n  [    0.672099] PCI: Using ACPI for IRQ routing\n  [    0.676469] NetLabel: Initializing\n  [    0.679894] NetLabel:  domain hash size = 128\n  [    0.680005] NetLabel:  protocols = UNLABELED CIPSOv4\n  [    0.684018] NetLabel:  unlabeled traffic allowed by default\n  [    0.688077] HPET: 3 timers in total, 0 timers will be used for per-cpu timer\n  [    0.692015] hpet0: at MMIO 0xfed00000, IRQs 2, 8, 0\n  [    0.697687] hpet0: 3 comparators, 64-bit 62.500000 MHz counter\n  [    0.703093] Switched to clocksource xen\n  [    0.707158] AppArmor: AppArmor Filesystem Enabled\n  [    0.711451] pnp: PnP ACPI init\n  [    0.714473] ACPI: bus type PNP registered\n  [    0.718328] system 00:00: [mem 0x00000000-0x0009ffff] could not be reserved\n  [    0.724091] system 00:02: [io  0x08a0-0x08a3] has been reserved\n  [    0.729294] system 00:02: [io  0x0cc0-0x0ccf] has been reserved\n  [    0.734389] system 00:02: [io  0x04d0-0x04d1] has been reserved\n  [    0.740211] system 00:0a: [io  0x10c0-0x1141] has been reserved\n  [    0.745287] system 00:0a: [io  0xb044-0xb047] has been reserved\n  [    0.770779] pnp: PnP ACPI: found 11 devices\n  [    0.774789] ACPI: bus type PNP unregistered\n  [    0.784338] NET: Registered protocol family 2\n  [    0.788750] TCP established hash table entries: 8192 (order: 4, 65536 bytes)\n  [    0.795005] TCP bind hash table entries: 8192 (order: 5, 131072 bytes)\n  [    0.800538] TCP: Hash tables configured (established 8192 bind 8192)\n  [    0.806171] TCP: reno registered\n  [    0.809433] UDP hash table entries: 512 (order: 2, 16384 bytes)\n  [    0.814598] UDP-Lite hash table entries: 512 (order: 2, 16384 bytes)\n  [    0.820686] NET: Registered protocol family 1\n  [    0.824784] pci 0000:00:00.0: Limiting direct PCI/PCI transfers\n  [    0.834452] pci 0000:00:01.0: PIIX3: Enabling Passive Release\n  [    0.845775] pci 0000:00:01.0: Activating ISA DMA hang workarounds\n  [    0.858149] Trying to unpack rootfs image as initramfs...\n  [    1.189968] Freeing initrd memory: 24236K (ffff88003509a000 - ffff880036845000)\n  [    1.196748] microcode: CPU0 sig=0x306f2, pf=0x1, revision=0x2b\n  [    1.201763] microcode: Microcode Update Driver: v2.00 tigran@aivazian.fsnet.co.uk, Peter Oruba\n  [    1.209213] Scanning for low memory corruption every 60 seconds\n  [    1.214544] Initialise system trusted keyring\n  [    1.218795] audit: initializing netlink socket (disabled)\n  [    1.223538] type=2000 audit(1476328644.765:1): initialized\n  [    1.250005] HugeTLB registered 2 MB page size, pre-allocated 0 pages\n  [    1.256094] zbud: loaded\n  [    1.258857] VFS: Disk quotas dquot_6.5.2\n  [    1.262584] Dquot-cache hash table entries: 512 (order 0, 4096 bytes)\n  [    1.268538] fuse init (API version 7.22)\n  [    1.272455] msgmni has been set to 1979\n  [    1.276249] Key type big_key registered\n  [    1.280141] Key type asymmetric registered\n  [    1.284369] Asymmetric key parser 'x509' registered\n  [    1.288877] Block layer SCSI generic (bsg) driver version 0.4 loaded (major 252)\n  [    1.295515] io scheduler noop registered\n  [    1.299058] io scheduler deadline registered (default)\n  [    1.303535] io scheduler cfq registered\n  [    1.307189] pci_hotplug: PCI Hot Plug PCI Core version: 0.5\n  [    1.312140] pciehp: PCI Express Hot Plug Controller Driver version: 0.4\n  [    1.317743] ipmi message handler version 39.2\n  [    1.321769] input: Power Button as /devices/LNXSYSTM:00/LNXPWRBN:00/input/input0\n  [    1.328284] ACPI: Power Button [PWRF]\n  [    1.332622] input: Sleep Button as /devices/LNXSYSTM:00/LNXSLPBN:00/input/input1\n  [    1.339495] ACPI: Sleep Button [SLPF]\n  [    1.343305] GHES: HEST is not enabled!\n  [    1.347334] xen:grant_table: Grant tables using version 1 layout\n  [    1.352409] Grant table initialized\n  [    1.355759] Cannot get hvm parameter CONSOLE_EVTCHN (18): -22!\n  [    1.360671] Serial: 8250/16550 driver, 32 ports, IRQ sharing enabled\n  [    1.396708] 00:09: ttyS0 at I/O 0x3f8 (irq = 4, base_baud = 115200) is a 16550A\n  [    1.404521] Linux agpgart interface v0.103\n  [    1.408958] brd: module loaded\n  [    1.412393] loop: module loaded\n  [    1.444217] scsi0 : ata_piix\n  [    1.446627] scsi1 : ata_piix\n  [    1.449450] ata1: PATA max MWDMA2 cmd 0x1f0 ctl 0x3f6 bmdma 0xc100 irq 14\n  [    1.455453] ata2: PATA max MWDMA2 cmd 0x170 ctl 0x376 bmdma 0xc108 irq 15\n  [    1.463356] libphy: Fixed MDIO Bus: probed\n  [    1.467308] tun: Universal TUN/TAP device driver, 1.6\n  [    1.471716] tun: (C) 1999-2004 Max Krasnyansky maxk@qualcomm.com\n  [    1.477135] PPP generic driver version 2.4.2\n  [    1.481080] xen_netfront: Initialising Xen virtual ethernet driver\n  [    1.496904] ehci_hcd: USB 2.0 'Enhanced' Host Controller (EHCI) Driver\n  [    1.502546] ehci-pci: EHCI PCI platform driver\n  [    1.506784] ehci-platform: EHCI generic platform driver\n  [    1.511478] ohci_hcd: USB 1.1 'Open' Host Controller (OHCI) Driver\n  [    1.516789] ohci-pci: OHCI PCI platform driver\n  [    1.521059] ohci-platform: OHCI generic platform driver\n  [    1.525964] uhci_hcd: USB Universal Host Controller Interface driver\n  [    1.531497] i8042: PNP: PS/2 Controller [PNP0303:PS2K,PNP0f13:PS2M] at 0x60,0x64 irq 1,12\n  [    1.540735] serio: i8042 KBD port at 0x60,0x64 irq 1\n  [    1.545224] serio: i8042 AUX port at 0x60,0x64 irq 12\n  [    1.550073] mousedev: PS/2 mouse device common for all mice\n  [    1.556193] input: AT Translated Set 2 keyboard as /devices/platform/i8042/serio0/input/input2\n  [    1.563650] rtc_cmos 00:04: rtc core: registered rtc_cmos as rtc0\n  [    1.568891] rtc_cmos 00:04: alarms up to one day, 114 bytes nvram, hpet irqs\n  [    1.575759] device-mapper: uevent: version 1.0.3\n  [    1.580103] device-mapper: ioctl: 4.27.0-ioctl (2013-10-30) initialised: dm-devel@redhat.com\n  [    1.587594] ledtrig-cpu: registered to indicate activity on CPUs\n  [    1.592929] TCP: cubic registered\n  [    1.596235] NET: Registered protocol family 10\n  [    1.601773] NET: Registered protocol family 17\n  [    1.605925] Key type dns_resolver registered\n  [    1.610062] Loading compiled-in X.509 certificates\n  [    1.615081] Loaded X.509 cert 'Magrathea: Glacier signing key: 5ce91a5f5a603a312b28b6e022cb5618e5dc44ed'\n  [    1.624555] registered taskstats version 1\n  [    1.628913] blkfront: xvda: barrier or flush: disabled; persistent grants: disabled; indirect descriptors: enabled;\n  [    1.638808] Key type trusted registered\n  [    1.645014] Key type encrypted registered\n  [    1.649103]  xvda: xvda1\n  [    1.651900] AppArmor: AppArmor sha1 policy hashing enabled\n  [    1.656678] IMA: No TPM chip found, activating TPM-bypass!\n  [    1.661736] xenbus_probe_frontend: Device with no driver: device/vfb/0\n  [    1.667317] regulator-dummy: disabling\n  [    1.670705]   Magic number: 4:37:260\n  [    1.674153] rtc_cmos 00:04: setting system clock to 2016-10-13 03:17:25 UTC (1476328645)\n  [    1.681089] BIOS EDD facility v0.16 2004-Jun-25, 0 devices found\n  [    1.686261] EDD information not available.\n  [    1.691984] Freeing unused kernel memory: 1336K (ffffffff81d20000 - ffffffff81e6e000)\n  [    1.698985] Write protecting the kernel read-only data: 12288k\n  [    1.704169] Freeing unused kernel memory: 760K (ffff880001742000 - ffff880001800000)\n  [    1.712116] Freeing unused kernel memory: 680K (ffff880001b56000 - ffff880001c00000)\n  Loading, please wait...\n  [    1.732197] systemd-udevd[126]: starting version 204\n  [    1.754118] [drm] Initialized drm 1.1.0 20060810\n  [    1.786722] FDC 0 is a S82078B\n  [    1.825257] [TTM] Zone  kernel: Available graphics memory: 508152 kiB\n  [    1.830805] [TTM] Initializing pool allocator\n  [    1.834768] [TTM] Initializing DMA pool allocator\n  [    1.839339] [drm] fb mappable at 0x0\n  [    1.842699] [drm] vram aper at 0x0\n  [    1.845981] [drm] size 0\n  [    1.853293] [drm] fb depth is 24\n  [    1.856584] [drm]    pitch is 3072\n  [    1.865438] fbcon: cirrusdrmfb (fb0) is primary device\n  [    1.931372] Console: switching to colour frame buffer device 128x48\n  [    2.004746] cirrus 0000:00:02.0: fb0: cirrusdrmfb frame buffer device\n  [    2.009525] cirrus 0000:00:02.0: registered panic notifier\n  [    2.013482] [drm] Initialized cirrus 1.0.0 20110418 for 0000:00:02.0 on minor 0\n  Begin: Loading essential drivers ... done.\nBegin: Running /scripts/init-premount ... done.\nBegin: Mounting root file system ... Begin: Running /scripts/local-top ... done.\nBegin: Running /scripts/local-premount ... done.\n[    2.194368] EXT4-fs (xvda1): mounted filesystem with ordered data mode. Opts: (null)\n[    2.204421] tsc: Refined TSC clocksource calibration: 2399.998 MHz\nBegin: Running /scripts/local-bottom ... done.\ndone.\nBegin: Running /scripts/init-bottom ... done.\n[    2.362620] random: init urandom read with 54 bits of entropy available\n- Starting Mount filesystems on boot\u001b[74G[ OK ]\n- Starting Populate and link to /run filesystem\u001b[74G[ OK ]\n- Stopping Populate and link to /run filesystem\u001b[74G[ OK ]\n[    2.541672] EXT4-fs (xvda1): re-mounted. Opts: discard\n- Starting Initialize or finalize resolvconf\u001b[74G[ OK ]\n- Stopping Track if upstart is running in a container\u001b[74G[ OK ]\n- Starting Signal sysvinit that the rootfs is mounted\u001b[74G[ OK ]\n- Starting mount available cgroup filesystems\u001b[74G[ OK ]\n- Starting Clean /tmp directory\u001b[74G[ OK ]\n- Stopping Clean /tmp directory\u001b[74G[ OK ]\n[    2.842026] input: ImExPS/2 Generic Explorer Mouse as /devices/platform/i8042/serio1/input/input4\nCloud-init v. 0.7.5 running 'init-local' at Thu, 13 Oct 2016 03:17:26 +0000. Up 3.05 seconds.\ncloud-init-nonet[3.33]: waiting 10 seconds for network device\n- Starting set console keymap\u001b[74G[ OK ]\n- Starting Signal sysvinit that virtual filesystems are mounted\u001b[74G[ OK ]\n- Starting Signal sysvinit that virtual filesystems are mounted\u001b[74G[ OK ]\n  [    3.539332] piix4_smbus 0000:00:01.3: SMBus base address uninitialized - upgrade BIOS or use force_addr=0xaddr\n- Starting Bridge udev events into upstart\u001b[74G[ OK ]\n- Starting Signal sysvinit that remote filesystems are mounted\u001b[74G[ OK ]\n- Starting device node and kernel event manager\u001b[74G[ OK ]\n- Stopping set console keymap\u001b[74G[ OK ]\n- Starting cold plug devices\u001b[74G[ OK ]\n- Starting log initial device creation\u001b[74G[ OK ]\n- Starting Uncomplicated firewall\u001b[74G[ OK ]\n- Starting configure network device security\u001b[74G[ OK ]\n- Starting configure network device security\u001b[74G[ OK ]\n- Starting Mount network filesystems\u001b[74G[ OK ]\n- Stopping Mount network filesystems\u001b[74G[ OK ]\n- Starting Bridge socket events into upstart\u001b[74G[ OK ]\n- Starting configure network device\u001b[74G[ OK ]\n- Starting Mount network filesystems\u001b[74G[ OK ]\n- Stopping Mount network filesystems\u001b[74G[ OK ]\ncloud-init-nonet[4.13]: static networking is now up\n- Starting configure network device\u001b[74G[ OK ]\nCloud-init v. 0.7.5 running 'init' at Thu, 13 Oct 2016 03:17:28 +0000. Up 4.40 seconds.\nci-info: ++++++++++++++++++++++++++Net device info+++++++++++++++++++++++++++\nci-info: +--------+------+--------------+---------------+-------------------+\nci-info: | Device |  Up  |   Address    |      Mask     |     Hw-Address    |\nci-info: +--------+------+--------------+---------------+-------------------+\nci-info: |   lo   | True |  127.0.0.1   |   255.0.0.0   |         .         |\nci-info: |  eth0  | True | 172.31.43.15 | 255.255.240.0 | 06:a3:9e:62:37:bb |\nci-info: +--------+------+--------------+---------------+-------------------+\nci-info: +++++++++++++++++++++++++++++++Route info++++++++++++++++++++++++++++++++\nci-info: +-------+-------------+-------------+---------------+-----------+-------+\nci-info: | Route | Destination |   Gateway   |    Genmask    | Interface | Flags |\nci-info: +-------+-------------+-------------+---------------+-----------+-------+\nci-info: |   0   |   0.0.0.0   | 172.31.32.1 |    0.0.0.0    |    eth0   |   UG  |\nci-info: |   1   | 172.31.32.0 |   0.0.0.0   | 255.255.240.0 |    eth0   |   U   |\nci-info: +-------+-------------+-------------+---------------+-----------+-------+\n- Stopping Mount filesystems on boot\u001b[74G[ OK ]\n- Starting Signal sysvinit that local filesystems are mounted\u001b[74G[ OK ]\n- Starting flush early job output to logs\u001b[74G[ OK ]\n- Stopping Failsafe Boot Delay\u001b[74G[ OK ]\n- Starting System V initialisation compatibility\u001b[74G[ OK ]\n- Starting D-Bus system message bus\u001b[74G[ OK ]\n- Stopping flush early job output to logs\u001b[74G[ OK ]\n- Starting SystemD login management service\u001b[74G[ OK ]\n- Starting system logging daemon\u001b[74G[ OK ]\n- Starting Handle applying cloud-config\u001b[74G[ OK ]\n- Starting Bridge file events into upstart\u001b[74G[ OK ]\n- Starting early crypto disks...       \u001b[80G \n  \u001b[74G[ OK ]\nSkipping profile in /etc/apparmor.d/disable: usr.sbin.rsyslogd\n- Starting AppArmor profiles       \u001b[80G \n  \u001b[74G[ OK ]\n- Stopping System V initialisation compatibility\u001b[74G[ OK ]\nopen-vm-tools: not starting as this is not a VMware VM\nlandscape-client is not configured, please run landscape-config.\n- Starting System V runlevel compatibility\u001b[74G[ OK ]\n- Starting ACPI daemon\u001b[74G[ OK ]\n- Starting save kernel messages\u001b[74G[ OK ]\n- Starting configure network device security\u001b[74G[ OK ]\n- Starting OpenSSH server\u001b[74G[ OK ]\n- Starting regular background program processing daemon\u001b[74G[ OK ]\n- Starting deferred execution scheduler\u001b[74G[ OK ]\n- Stopping save kernel messages\u001b[74G[ OK ]\n- Stopping CPU interrupts balancing daemon\u001b[74G[ OK ]\n- Starting configure virtual network devices\u001b[74G[ OK ]\n- Starting automatic crash report generation\u001b[74G[ OK ]\n- Starting Docker daemon\u001b[74G[ OK ]\n- Restoring resolver state...       \u001b[80G \n  \u001b[74G[ OK ]\n- Stopping System V runlevel compatibility\u001b[74G[ OK ]\nCloud-init v. 0.7.5 running 'modules:final' at Thu, 13 Oct 2016 03:17:30 +0000. Up 6.72 seconds.\nCloud-init v. 0.7.5 finished at Thu, 13 Oct 2016 03:17:30 +0000. Datasource DataSourceEc2.  Up 6.94 seconds\nUbuntu 14.04.2 LTS ip-172-31-43-15 ttyS0\nip-172-31-43-15 login: Sat Oct 15 15:01:49 UTC 2016: shutting down for poweroff [up 215065s].\nwait-for-state stop/waiting\n- Stopping landscape-client daemon       \u001b[80G \n  \u001b[74G[\u001b[31mfail\u001b[39;49m]\n- Stopping rsync daemon rsync       \u001b[80G \n  \u001b[74G[ OK ]\n- Stopping open-vm guest daemon vmtoolsd       \u001b[80G \n  \u001b[74G[ OK ]\n- Asking all remaining processes to terminate...       \u001b[80G \n  \u001b[74G[ OK ]\n- All processes ended within 2 seconds...       \u001b[80G \n  \u001b[74G[ OK ]\n- Deactivating swap...       \u001b[80G \n  \u001b[74G[ OK ]\n- Stopping early crypto disks...       \u001b[80G \n  \u001b[74G[ OK ]\n- Will now halt\n  [215067.052368] reboot: Power down\n. Finally got it working... \n\nIt seems I had to install letsencrypt on the production server...  \nsudo apt install letsencrypt\nIt wasn't clear... I assumed maybe mup would do this for me during the setup process.\n. Thank you for clarifying that Meteor Up doesn't set anything related to the content-security-policy\nI'll review my packages this evening.\nAppreciate it.. I'm having a simillar issue, i'm getting an errror on the client though.\nWebSocket connection to 'wss://mydomain.com:3200/' failed: Error in connection establishment: net::ERR_CONNECTION_REFUSED\nIs this related? Granted, since I'm having trouble initiate the connection on the client end I don't even know if the web socket code on the server would work.\nAnd Is there a work around for this in the meantime?. @zodern Hey Zodern, this issue is rather urgent for me.  Could you give me any guidance for a temporary work around or a possible solution?  Maybe this is something with a little guidance that I can work on and send in a pull request.\nThank you. @zodern I just picked a random port for the WebSockets, I figured It would be good to use a different port than the app was using.\nI'm using Let's Encrypt. \nThanks \n. @zodern  any thoughts?  Should I be initiating the WebSocket connection on the same port?. @alstephan Great thank you. Thank you for clarifying.. Thank you. I enabled let's encrypt autogenerate and then the Cloudflare ssh was able to take over and load the page.  I assumed that I would want the autogenerate turned off when using Cloudflare but perhaps that is not the case...\nThat said I am still getting the \"WebSocket connection to 'wss://mydomain.com:3200/' failed: Error in connection establishment: net::ERR_CONNECTION_REFUSED\"\nCould it be that I still get the error because I have the two SSH implementations overlapping?\n. @alstephan Were you able to get the SSH on Cloudflare working without using the ssl autogenerate option in mup.js:\nssl: {\n    autogenerate: { ...\n    }\n}. Thank you @alstephan, I was using a port not supported by Cloudflare.\nIt seems I getting closer, the client and server seem to actually be communicating, but now I am getting an error during the handshake.\nWebSocket connection to 'wss://boldvue.com:2053/' failed: Error during WebSocket handshake: Unexpected response code: 525\nAny thoughts on how to diagnose/resolve the handshake issue?. @alstephan \nThank you for the advice!  I finally got it working.  I did as you said and tried to get some websocket connections working via a node server.  Unfortunately I was still getting the 525 error.\nSo then I looked into node https server settings and saw that you need to authenticate with the certificate and key files. \nhttps://nodejs.org/api/https.html#https_https\nI found those on the server at /opt/appname/certs/\nThen it worked!  I'm sure this is pretty obvious for most people but just shows how clueless I am when it comes to servers and security.  Thank you for your guidance, you gave me just enough help to get the ball rolling on a solution.\nAppreciate it!\n. ",
    "lunatolun": "You need to\n1: Configure name servers and point your domain to digital ocean (I'm assuming you are using digital ocean since you said droplet)\n2: Configure your droplet (Networking > Add domain then configure it's settings)\n3: Configure it in MUP\nenv: {\n      ROOT_URL: 'http://yourdomain.com', //this can be https also\n      PORT: 80\n}\n. @bryanlimy It is the same for me but I can't redeploy with v0.97 again after I try v0.98. I will try a fresh install soon. With v0.97 the chips and some select fields lose the design but thats not really a major issue/easy CSS copy-paste fix. Fresh install on Ubuntu 14.04.5 x64, Dogfalo/Materialize v0.97 works like a charm, including SSL.. +1. Mine is Ubuntu 14.04 x64 \ndockerImage: 'abernix/meteord:base'\ndeployCheckWaitTime: 120 (always worked fine)\nAs it was mentioned in issue #448 when I first did setup and deploy, it worked with Dogfalo/Materialize 0.97 but when I tried with 0.98 it didn't work and the next deploys also didn't work, no matter what I change. I didn't try a fresh install with 0.97 yet but I'm pretty sure it will fix the problem. I'll write an update when I try. Probably tonight or tomorrow \n. Fresh install on Ubuntu 14.04.5 x64, Dogfalo/Materialize v0.97 works like a charm, including SSL.. ",
    "birganovrus": "@tyvdh Hi! Can you please post your nginx conf? I got some annoying situation when I only have an access to my meteor app using \"mydomain.com:3000\". When I open \"mydomain.com\" I see nginx welcome page\nThanks\n. @zodern Not exactly, I need to have an access to my app without :3000 port in app's domain name. When I enter \"mydomain.com\" I see NginX splash screen, however, when I enter \"mydomain.com:3000\", I see my app.\nIf I don't add PORT setting in meteor.env, deployment gets failed, I see this \" Error starting userland proxy: listen tcp 0.0.0.0:80: bind: address already in use\". ",
    "mirstan": "+1. UGE annoyance and bug in my opinion\n. ",
    "gitMonks": "@sgatlf Thanks for your suggestion. I have updated npm package to the latest 3.10.8 but still no luck Here is the mup logs:\n\nThanking again for your time and help\n. I have managed to get rid of the error by using  a docker image  suggeste by abernix kadirahq/mup here: https://github.com/meteor/meteor/issues/7475. Even though my app is successfully deployed and verified now but it's still not live and shows nginx welcome page.\n. @sgatlf Yes I am hosting on digitalocean (Ubunut & nginx). I followed this https://gist.github.com/jamiewilson/4e1d28f9a200cb34ad59 tutorial to the word and I was running into the Verfication failure error and I solved it with the solution I mentioned in my previous comment. \n@Deadlyweed Yeah you are right it works by following the http://url.co.uk:3000. How did you fix this?\nThanks a lot to both of you for your time. I hope one day I will be able give something back to this community.\n. @sgatlf Here are the contents of myapp.com.conf & mup.js\nmyapp.com.conf\nserver {\n    listen 80;\n    server_name myapp.co.uk;\n    access_log /var/log/nginx/app.dev.access.log;\n    error_log /var/log/nginx/app.dev.error.log;\n        location / {\n            proxy_pass http://XXX.XX.XXX.XX:3000;\n            proxy_http_version 1.1;\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection 'upgrade';\n            proxy_set_header X-Forwarded-For $remote_addr;\n        }\n}\nmup.js\nmodule.exports = {\n  servers: {\n    one: {\n      host: 'XXX.XX.XXX.XX',\n      username: 'USERNAME',\n      pem: '/Users/gitMonk/.ssh/id_rsa'\n      // password:\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\nmeteor: {\n    name: 'myApp',\n    path: '/Users/gitMonk/Desktop/projects/myApp',\n    dockerImage: 'abernix/meteord:base',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'http://myapp.co.uk',\n      PORT: 3000,\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n//dockerImage: 'kadirahq/meteord'\ndeployCheckWaitTime: 600\n},\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\nI am able to reload nginx withsudo nginx -s reload doesn't recognise sudo services nginx reload.\nProblem still persists.\n. People suggested in some forums that they were able to resolve the Verification failure by increasing the deployCheckWaitTime to 80. I was so frustrated that I made it 600. Now that should give you an idea how much I am appreciating your help. :))\n. @sgatlf Sorry no luck even with these settings. By the way proxy_pass was already http://xxx.xx.xxx.xx:3000. Did you literally mean http://127.0.0.1:3000\nI opened a support ticket with digitalocean and they have come back with the following message:\n\nThank you for contacting us! You can adjust the Nginx configuration as desired. You're basically configuring a reverse proxy. This may help as a reference:\nhttps://www.digitalocean.com/community/tutorials/how-to-configure-nginx-as-a-web-server-and-reverse-proxy-for-apache-on-one-ubuntu-16-04-server\nIf you have any further questions, do feel free to ask!\n\nsgatlf if you are busy, please don't worry about it. I am conscious of taking up too much of your time. Thank you for all your help.\n. I found an article that talks about setting up proper url and removing ports. As suggested by you it asks to point at http://127.0.0.1:3000. \nhttps://johngibby.com/blog/How_to_deploy_your_meteor.js_app_on_Digital_Ocean#removing-port\nI copied paste the whole contents but still no luck. I don't know honestly what would help. It's been 3 days I am searching for a solution. But as you say on the brighter side I am learning something valuable. \n. @sgatlf  I am happy for you to access my server. Maybe you can figure out something please email me. I'll owe you a coffee, you will only have to come to London.\n. You are right, If  I try to change the settings in my /etc/nginx/sites-available/default Welcome page stops working but the app is still available on mydomain.co.uk:3000. With following configuration the welcome page is being served and the app is available on mydomain.co.uk:3000. I suspect that my server block right at the bottom of the page is not working. \n\nThanks again. Meanwhile, I am reading the nginx tutorials and configurations. :)\n. ls /etc/nginx/sites-available\ndefault myapp.com\nls /etc/nginx/sites-enabled\ndefault myApp.com.conf\ncontents of these files are\n/sites-available/default\n``````\n Default server configuration\n\nserver {\n        listen 80 default_server;\n        listen [::]:80 default_server;\n```        # SSL configuration\n        #\n        # listen 443 ssl default_server;\n        # listen [::]:443 ssl default_server;\n        #\n        # Note: You should disable gzip for SSL traffic.\n        # See: https://bugs.debian.org/773332\n        #\n        # Read up on ssl_ciphers to ensure a secure configuration.\n        # See: https://bugs.debian.org/765782\n        #\n        # Self signed certs generated by the ssl-cert package\n        # Don't use them in a production server!\n        #\n        # include snippets/snakeoil.conf;\n    root /var/www/html;\n\n    # Add index.php to the list if you are using PHP\n    index index.html index.htm index.nginx-debian.html;\n\n    #server_name *.mydomain.co.uk;\n\n    location / {\n            # First attempt to serve request as file, then\n            # as directory, then fall back to displaying a 404.\n            try_files $uri $uri/ =404;\n    }\n\n    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\n    #\n    #location ~ \\.php$ {\n    #       include snippets/fastcgi-php.conf;\n    #\n    #       # With php7.0-cgi alone:\n    #       fastcgi_pass 127.0.0.1:9000;\n    #       # With php7.0-fpm:\n    #       fastcgi_pass unix:/run/php/php7.0-fpm.sock;\n    #}\n   # deny access to .htaccess files, if Apache's document root\n    # concurs with nginx's one\n    #\n    #location ~ /\\.ht {\n    #       deny all;\n    #}\n\n}\nVirtual Host configuration for example.com\n\nYou can move that to a different file under sites-available/ and symlink that\nto sites-enabled/ to enable it.\n\nserver {\nlisten 80;\nlisten [::]:80;\n\nserver_name example.com;\n\nroot /var/www/example.com;\nindex index.html;\n\nlocation / {\ntry_files $uri $uri/ =404;\n}\n}\nserver {\n    listen 80;\n    # to redirect all subdomains use .yourdomain.com instead of www.yourdomain$\n    server_name .mydomain.co.uk;\n    return 301 $scheme://mydomain.co.uk$request_uri;\n}\n``````\n/sites-available/myapp.com\nblank\n/sites-enabled/myapp.com.conf\nserver {\n    listen 80;\n    server_name mydomain.co.uk;\n    access_log /var/log/nginx/app.dev.access.log;\n    error_log /var/log/nginx/app.dev.error.log;\n        location / {\n            proxy_pass http://127.0.0.1:3000;\n            proxy_http_version 1.1;\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection 'upgrade';\n            proxy_set_header X-Forwarded-For $remote_addr;\n        }\n}\n/sites-enabled/default\n```\nDefault server configuration\n\nserver {\n        listen 80 default_server;\n        listen [::]:80 default_server;\n    # SSL configuration\n    #\n    # listen 443 ssl default_server;\n    # listen [::]:443 ssl default_server;\n    #\n    # Note: You should disable gzip for SSL traffic.\n    # See: https://bugs.debian.org/773332\n    #\n    # Read up on ssl_ciphers to ensure a secure configuration.\n    # See: https://bugs.debian.org/765782\n    #\n    # Self signed certs generated by the ssl-cert package\n    # Don't use them in a production server!\n    #\n    # include snippets/snakeoil.conf;\n\n    root /var/www/html;\n\n    # Add index.php to the list if you are using PHP\n    index index.html index.htm index.nginx-debian.html;\n\n    #server_name *.mydomain.co.uk;\n\n    location / {\n            # First attempt to serve request as file, then\n            # as directory, then fall back to displaying a 404.\n            try_files $uri $uri/ =404;\n    }\n\n    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\n    #\n    #location ~ \\.php$ {\n    #       include snippets/fastcgi-php.conf;\n    #\n    #       # With php7.0-cgi alone:\n    #       fastcgi_pass 127.0.0.1:9000;\n    #       # With php7.0-fpm:\n    #       fastcgi_pass unix:/run/php/php7.0-fpm.sock;\n    #}\n   # deny access to .htaccess files, if Apache's document root\n    # concurs with nginx's one\n    #\n    #location ~ /\\.ht {\n    #       deny all;\n    #}\n\n}\nVirtual Host configuration for example.com\n\nYou can move that to a different file under sites-available/ and symlink that\nto sites-enabled/ to enable it.\n\nserver {\nlisten 80;\nlisten [::]:80;\n\nserver_name example.com;\n\nroot /var/www/example.com;\nindex index.html;\n\nlocation / {\ntry_files $uri $uri/ =404;\n}\n}\nserver {\n    listen 80;\n    # to redirect all subdomains use .yourdomain.com instead of www.yourdomain$\n    server_name .mydomain.co.uk;\n    return 301 $scheme://mydomain.co.uk$request_uri;\n}\n```\n. Strangest update!\nI think Gods of nginx have listened to my prayers. Couple of minutes after posting my last comment, the app started working at mydomain.co.uk without the :3000.   All my files contents somehow got deleted including the defaults.  I have just blank files now\nApp started working and my permission to leave further comments here stopped. :)) Maybe, I had posted too many comments so I couldn't inform you of this development earlier.\nI am confused, happy and terrified all at the same time. I need to deploy some updates but I am not doing it yet until I understand what the heck was going wrong. \nI'll definitely follow your advice and try these steps if I run into problems again.\nThanks a million for helping me out! \n. ",
    "33Fraise33": "This would also help us a lot, we deploy the same code to a lot of different servers with different meteor settings and different mup files. One build would help us a lot. I think I have resolved the issue. Put your mup files inside a hidden folder (e.g. .mup) change the path to ../. of your project inside your mup files and run the mup command from inside the folder. \nthat's why in the how to they mention \nmkdir .deploy. Well yes a warning wouldn't be bad. And we didn't read the readme completely as we changed from the old mup where the mup file was still a mup.json. Also in the readmy it is not specified why the mup file should be placed inside a .deploy folder. At the time it seemed more complicated to me and unnecessary. \nIt would be a good idea to update the readme that it is strongly adviced to have the mup file in a .deploy folder for security reasons.  . Jup I just had the same problem:\nmup logs --config=mup-beta.js gives the error: \n[x.x.x.x]docker: '<appname>' is not a docker command.. I am able to view the logs by logging into the webserver and typing: \ndocker logs <appname>. I managed to resolve this. What I was trying to do was keep all data traffic over the local network (VM's on azure in my case).\nApparently docker uses a specific hosts file different to the one at /etc/hosts. You can resolve this by using the --network=host argument under docker args.\nMore info about this can be found over here:\nhttps://docs.docker.com/engine/reference/run/#/network-settings\nYou could also use --add-hosts and add every host but that was suboptimal for my case.. my apologies for the bit too fast fix!. ",
    "came": "+1\n. I am also in with $100 :) MUP saved my ass for quite some time ...and EB would be just awesome.. ...oh, I donated as kiwi / carsten. ",
    "kulttuuri": "+1\n. I can't seem to get the letsencrypt SSL working. Do I need to create the nginx proxy myself or should that new ssl autogenerate parameter set it up for me? I first tried with Azure Ubuntu 14.04 LTS but that didn't work and also the apt-get install letsencrypt did not work there. So I spinned up new Azure Ubuntu 16.06 LTS VM and ran few commands on the server as suggested on this thread before starting the mup deployment:\nsudo apt-get install letsencrypt\nsudo apt-get install software-properties-common\nsudo add-apt-repository ppa:certbot/certbot\nsudo apt-get update\nsudo apt-get install python-certbot-nginx\nThose commands ran fine and now I verified that my mup configurations we're correct and my meteor settings file pointed to right place and ran these on my local computer:\nmup setup\nmup deploy --config=mup.js --settings=default_settings.json\nThey worked fine and my app is now accessible through http. However trying to access through https just instantly gives me \"This site can\u2019t be reached\". I even tried ssh:ing to the server and ran few commands to figure out if the server is listening to the port 443 and if I can access the https port locally on curl.. Nevermind, got this one sorted out! I was trying to sign azure test server address, looked up the docker logs for the nginx meteor server instance and it did not want to grant that server an certificate. Added DNS entry to my own server subdomain address and it worked nicely.\nJust heads up that with Azure's Ubuntu 14.04 server the letsencrypt did not work at all, but with 16.04 it worked out of the box. It also needs few minutes for the certificate to be signed. Good way to check for certificate signing errors is to SSH into the server computer and first run sudo docker ps, get container ID of jrcs/letsencrypt-nginx-proxy-companion:latest and run `sudo docker logs companionContainerID'. That's where I found the error at.. Fantastic, thanks! Any ETA for 1.3.1?. ",
    "lucbocahut": "I got this to work by changing line 39 to \n-e \"VIRTUAL_HOST=<%= sslConfig.autogenerate.domains %>\" \\\ninstead of \n-e \"VIRTUAL_HOST=$HOSTNAME\" . If its unclear how to get this to work:\ngit clone https://github.com/mbabauer/meteor-up.git#lets-encrypt clones the repo to your current local directory\nedit meteor-up/src/modules/meteor/templates/start.sh as indicated above by changing VIRTUAL_HOST=<%= sslConfig.autogenerate.domains %> (will only work if you set autogenerate in mup.js)\ncd meteor-up cd inside the new directory\nnpm install will create /lib and pull all the required modules\ncd .. move back out of the directory\nnpm install -g meteor-up install the app from the local directory\nyou should then be able to use mup commands as needed. ",
    "geeksville": "I just happened upon this as well.  Here's the relevant non working snippet in my mup.js:\nmeteor: {\n    name: 'persistence',\n    path: '../persistence'\n}\nHere's a snippet that works: (my mup.js is in /home/kevinh/development/persistence/.deploy, pwd is .deploy when I ran mup setup)\nmeteor: {\n    name: 'persistence',\n    path: '/home/kevinh/development/persistence'\n}\nHopefully this note helps.\n. on a development server.  I already run two other meteor apps on that server (which I'm currently working on transitioning to the new docker style mup - I previously used the old 0.x mup)\nI don't yet have my new docker based solution working though - I can update this bug after I finish (hopefully later today - now fighting with https://github.com/meteor/meteor/issues/7475 )\n. Thanks so much.  Everything is working nicely for me now.  Just so you know remaining things I had to do to get things happy: (I can file other bugs or send PRs if you prefer)\n- The fix listed above\n- I'm using meteor 1.4.x so I needed to use abernix/meteord:base per #7475 as my starting container, without that it would fail to start because the node inside the default container was too old. (Later I had to customize the container anyways to pull in various native dependencies for my app)\nThanks for the awesome tool!\n. ",
    "rollin-s": "Hrm. But if I want to deploy on a local machine, can't localhost work ?\nOr I do have to write like :\"192.168.0.1\" ? \nIf I want to deploy on my server, I should write my server ip ? or localhost ? Not sure how this works..\n. Yes, my app is already working ! \nWhat I don't understand is what I have to put inside the \"host\".. \nMy app is runnning in localhost:3000.\nEvent if I change my host to localhost:3000, I have Error connect ECONNREFUSED.\nI just don't understand how this \"host\" works\n. Oh great, thank's ! \n. Ok, I tried to do as you said, but I'm still having issues.\nThis is my \"new\" mup.js\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '192.168.0.1',\n      username: 'root'\n      // pem:                                                                                                                                                                                             \n      // password:                                                                                                                                                                                        \n      // or leave blank for authenticate from ssh-agent                                                                                                                                                   \n    }\n  },\nmeteor: {\n    name: 'myApp',\n    path: '../',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'app.com',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n//dockerImage: 'kadirahq/meteord'                                                                                                                                                                       \ndeployCheckWaitTime: 60\n\n},\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n```\nWhen I try to 'mup setup', I do have a \"EHOSTUNREACH\" error.\nWhat should I do if I want to build mup LOCALLY ?\nI don't understand at all how mup works.. Could you help me ?\n. Yes, exactly  !\nNo, I am on ubuntu 16.04 (Sorry, forgot to tell that !)\n. I want to see how this work locally before I can export it in my server ! \nSo, I'm just using localhost for testing\n. Oh. This worked perfectly.\nI just have one problem, and I think this'll be finish after.\nI can \"mup setup\".. but in my server, I already have one mongodb running, and I can't stop my running mongodb.\nWhen I run \"mup setup\",  mongo start failed because my adress (127.0.0.1:27017) is already in use one my server (yes, because I already have mongodb running.)\nI tried to change the \"MONGO_URL\", but \"mup setup\" still try to connect on the previous address.\nDo you have any idea how I can setup that ? I can't stop, or change my mongodb server ports.\n. It worked. Thank's !!! \n. ",
    "rashmimhatre100": "Hi All,\nI am also facing the same issue.\nMy mup.js file looks like,\n` module.exports = {\n         servers: {\n    one: {\n      host:'54.186.xx.xxx',\n      username: 'ubuntu',\n      pem: '~/.ssh/mypem.pem'\n    }\n  },\n  app: {\n    name: 'myapp',\n    path: '/var/www/meteor/myapp',\n    servers: {\n      one: {},\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'http://ec2-54-186-xx-xxx.us-west-2.compute.amazonaws.com',\n      MONGO_URL: 'mongodb://127.0.0.1:27017/myapp',\n      PORT: 3027,\n    },\ndocker: {\n      image: 'abernix/meteord:node-8.4.0-base',\n    },\n    deployCheckWaitTime : 60,\n    enableUploadProgressBar: true\n  },\n  mongo: {\n    port:27017,\n    version: '3.4.1',\n    servers: {\n      one: {}\n    }\n  }\n};\n`\nMeteor version is 1.6.\nThanks in advance!\n. In our case deployment is not happening it is stuck at extracting tools or sometimes at Building for web.browser.legacy. \nBut for one of our project we are using AWS ubuntu 18.04 only and were facing issue,\nContainer has no IP Address, likely from it restarting.\nTried stopping/removing mongodb conatiners, re-running it using docker.\nThen we checked the mongodb shell version it was different than configured in mup.js and observed version applied in mup.js and somehow it worked.\nTried to implement above in different project but didn't worked, mup deploy is stuck.. In our case deployment is not happening it is stuck at extracting tools or sometimes at Building for web.browser.legacy.\nBut for one of our project we are using AWS ubuntu 18.04 only and were facing issue,\nContainer has no IP Address, likely from it restarting.\nTried stopping/removing mongodb conatiners, re-running it using docker.\nThen we checked the mongodb shell version it was different than configured in mup.js and observed version applied in mup.js and somehow it worked.\nTried to implement above in different project but didn't worked, mup deploy is stuck.. ",
    "johhansantana": "Hey @Deadlyweed I think it has to do something with module.exports = { since it's saying ReferenceError: module is not defined and when I tried running it locally after doing mup init I got the same error\nedit\nafter commenting all the code it worked locally.\nI'm going to try mupx instead.\n. ",
    "jkhedani": "Update: To fix this issue, simply move your deployment files (mup.js, etc.) to a folder named .deploy/ in the root of your project directory. The above error is generated because the deployment files are being included into the app bundle when your project is being built (i.e. when meteor bundle is run) when it should not.. ",
    "productiveme": "@Deadlyweed I tried that but it seems the flag is not passed along to the meteor cli, since I get the same error.\n. ",
    "castlefields": "https://forums.meteor.com/t/need-good-old-mup/27677\nTo get back an old version of mup run: npm -g install mup@0.11.3\nThis installs the pre mup.js version\n. ",
    "digz6666": "@castlefields thanks man!. ",
    "adrianolsk": "~~Yes, I just got the same problem, had to stop nginx that was running on port 80 to be able to deploy my app, even after change port to 3000 on mup.js it still deploys using port 80~~\nnever mind I was setting meteor.port instead of meteor.env.PORT, now I got 0.0.0.0:3000->80/tcp which is exactly what I wanted to be able to use nginx and point my domain to port 3000\n. ",
    "appleparan": "Yes, it does. I finally find out why my mup reconfig & mup setup doesn't work. Thanks for inspection.. ",
    "madhan5000": "Yes Mup does set up docker. Here is the message log that you might get when you issue mup setup.\n`$ mup setup\nStarted TaskList: Setup Docker\n[10.4.35.134] - setup docker\n[10.4.35.134] - setup docker: SUCCESS\nStarted TaskList: Setup Meteor\n[10.4.35.134] - Setup Environment\nStarted TaskList: Setup Mongo\n[10.4.35.134] - setup environment\n[10.4.35.134] - setup environment: SUCCESS\n[10.4.35.134] - copying mongodb.conf\n[10.4.35.134] - Setup Environment: SUCCESS\n[10.4.35.134] - copying mongodb.conf: SUCCESS\nStarted TaskList: Start Mongo\n[10.4.35.134] - start mongo\n[10.4.35.134] - start mongo: SUCCESS\n`\n. Sorry, I am just a user like you. Please reach out to the maintainers.\nOn Fri, Nov 18, 2016, 9:31 PM Wu Tang Billingsley notifications@github.com\nwrote:\n\nMadhan, just discovered that docker needs linux kernel 3.10 or higher....\nUbuntu 14.04 comes out of the gate with 2.6.32. Can you all support Ubuntu\n15.04 or 16.04? Both have out of the box kernels > 3.10.\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/kadirahq/meteor-up/issues/349#issuecomment-261687327,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AL7zabDL1JbLGXFUnRHujA8QH4bvpu31ks5q_l-VgaJpZM4KkWPg\n.\n. @paulo2nd Mup will install docker on the target machine. \n\nhere is the log that you will get when you issue mup setup\n`$ mup setup\nStarted TaskList: Setup Docker\n[10.4.35.134] - setup docker\n[10.4.35.134] - setup docker: SUCCESS\nStarted TaskList: Setup Meteor\n[10.4.35.134] - Setup Environment\nStarted TaskList: Setup Mongo\n[10.4.35.134] - setup environment\n[10.4.35.134] - setup environment: SUCCESS\n[10.4.35.134] - copying mongodb.conf\n[10.4.35.134] - Setup Environment: SUCCESS\n[10.4.35.134] - copying mongodb.conf: SUCCESS\nStarted TaskList: Start Mongo\n[10.4.35.134] - start mongo\n[10.4.35.134] - start mongo: SUCCESS`\n. @paulo2nd You probably did this but just want to make sure you did username + password and commented out \"pem :\" entry \nAlso, from the mup.js that you have posted, I see you are referring to \npem: \"/home/webaula/.ssh/id_rsa\"\nwhich is not a pem file. you can certainly put a pem file in that folder but I believe it needs to be referenced explicitly.  for example\npem: \"/home/webaula/.ssh/id_rsa/my_secret.pem\"\nhope that helps\n. ",
    "genejr": "madhan, I have a new Ubuntu 14.04 instance and I get the following error when running mup setup. I have confirmed docker is running.\nStarted TaskList: Setup Docker\n[107.155.87.222] - setup docker\n[107.155.87.222] - setup docker: SUCCESS\nStarted TaskList: Setup Meteor\n[107.155.87.222] - Setup Environment\nStarted TaskList: Setup Mongo\n[107.155.87.222] - setup environment\n[107.155.87.222] - setup environment: SUCCESS\n[107.155.87.222] - copying mongodb.conf\n[107.155.87.222] - Setup Environment: SUCCESS\n[107.155.87.222] - copying mongodb.conf: SUCCESS\nStarted TaskList: Start Mongo\n[107.155.87.222] - start mongo\n[107.155.87.222] x start mongo: FAILED\n-----------------------------------STDERR-----------------------------------\nCannot connect to the Docker daemon. Is the docker daemon running on this host?\n-----------------------------------STDOUT-----------------------------------\nWarning: failed to get default registry endpoint from daemon (An error occurred trying to connect: Get http://%2Fvar%2Frun%2Fdocker.sock/v1.24/info: read unix @->/var/run/docker.sock: read: connection reset by peer). Using system default: https://index.docker.io/v1/\n----------------------------------------------------------------------------\n. Madhan, just discovered that docker needs linux kernel 3.10 or higher.... Ubuntu 14.04 comes out of the gate with 2.6.32. Can you all support Ubuntu 15.04 or 16.04? Both have out of the box kernels > 3.10.\n. ",
    "paulo2nd": "Thanx  Deadlyweed, This will be a Linux (Debian) test server. Do I need to install Docker or Mup will install it for me?\n. Changed my server to ubuntu 16.04.1 LTS, now my problem is:\n[10.61.1.8] - setup docker\nError All configured authentication methods failed\nI tried with password and pem (RSA without passphrase). root or user with sudo permissions, same error...\n. @madhan5000 thank you, the problem was ssh rootlogin disabled.\nnow i have:\nStarted TaskList: Setup Docker\n[10.61.1.8] - setup docker\n[10.61.1.8] - setup docker: SUCCESS\nStarted TaskList: Setup Meteor\n[10.61.1.8] - Setup Environment\nStarted TaskList: Setup Mongo\n[10.61.1.8] - setup environment\n[10.61.1.8] - setup environment: SUCCESS\n[10.61.1.8] - copying mongodb.conf\n[10.61.1.8] - Setup Environment: SUCCESS\n[10.61.1.8] - copying mongodb.conf: SUCCESS\nStarted TaskList: Start Mongo\n[10.61.1.8] - start mongo\n[10.61.1.8] - start mongo: SUCCESS\nThanks all :)\n. ",
    "yanickrochon": "Note, I have read the README, but I'm not sure what it means, or what to do (i.e. what does this mean \"Start ssh agent with eval $(ssh-agent)\" ??)\n. # Deployment\nLocal\n\nGenerate local SSH key if needed\n\n$ mkdir ~/.ssh\n  $ chmod 700 ~/.ssh\n  $ ssh-keygen -t rsa\n- Copy the SSH id over to the server (replace user by the specified user login)\n$ ssh-copy-id user@x.x.x.x\n- Test login (it should not prompt for password now) (replace user by the specified user login)\n$ ssh user@x.x.x.x\nRemote\n\nRemove password from sudoers\n\n$ sudo visudo\n- Add this line at the bottom of the file (replace user by the specified user login)\nuser ALL=(ALL) NOPASSWD: ALL\n- Install docker on all servers\n$ sudo apt install docker docker.io\n- Exit\n$ exit\nLocal (again)\n\nSetup if necessary, etc.\n\n```\n  $ cd /path/to/project\n$ npm i -g mupx\n$ mkdir .deploy\n$ cd .deploy\n$ mup setup\n$ mup deploy\n  ```\nNote: Now, I have a deployment failure, but no error. The TCP port is open, but the app can't be accessed. Moving on to other issues...\n. Thank you for those suggesting solutions, however the point isn't that it is currently impossible to restore and backup the database, but that from the two comments, it is clear that the necessary instructions are awkward compared to the way and simplicity with which mup works.\nIsn't the point of programming to make our life easier?. Same thing. I have that it may be because of how line termination may affect this. I am on Linux, by the way.. Running mup logs --tail=100 I get :\n```\n[x.x.x.51]Unable to locate server directory in ; hold on: we're likely to fail\n[x.x.x.51]Failed to locate main.js in ; cannot start application.\n[x.x.x.51]Unable to locate server directory in ; hold on: we're likely to fail\n[x.x.x.51]Failed to locate main.js in ; cannot start application.\n[x.x.x.51]Unable to locate server directory in ; hold on: we're likely to fail\n[x.x.x.51]Failed to locate main.js in ; cannot start application.\n[x.x.x.51]Unable to locate server directory in ; hold on: we're likely to fail\n[x.x.x.51]Failed to locate main.js in ; cannot start application.\nUnable to locate server directory in ; hold on: we're likely to fail\nFailed to locate main.js in ; cannot start application.\nUnable to locate server directory in ; hold on: we're likely to fail\nFailed to locate main.js in ; cannot start application.\nUnable to locate server directory in ; hold on: we're likely to fail\nFailed to locate main.js in ; cannot start application.\nUnable to locate server directory in ; hold on: we're likely to fail\nFailed to locate main.js in ; cannot start application.\n``. Yes, I tried, and the issue what that I had an incompatible version of Node. Changing to node 4.7.3 seems to make it work. (EDIT : I hadabernix/meteord:base` before, but it also failed, thus why I tried that other one.)\nIt would be nice to have this be checked before deployment. For example, mup setup could check that a compatible version of node is properly installed. Using nvm, this makes the entire process very easy to do.. It was 4.6.2. But I have 4.2.2 on my dev machine. I don't know. I guess I blame it on Murphy's Law, because I really don't understand how it would have failed, and I usually never deploy mid-day, but I had to hot-fix an issue that was critical to the operations, and the app went down instead.\nClose this for now.. This might not be this package's fault (see https://github.com/meteor/meteor/issues/8157). Since this seems to affect Meteor and not this package, I will close this.. Got the same problem with Meteor 1.6. My docker image is abernix/meteord:base.. Worked! Thanks!. If the docker image names reflected their name in the configuration, there shouldn't be a need to have multiple confugrations... For example, such configuration :\n```js\n{\n  servers: {\n    app1: {\n      host: '10.2.0.21',\n      username: 'user',\n      password: 'pass',\n    },\n    app2: {\n      host: '10.2.0.21',\n      username: 'user',\n      password: 'pass',\n    }\n  },\nmeteor: {\n    name: 'demo',\n    path: '../',\n    servers: {\n      app1: {\n        env: {\n          PORT: 4001\n        }\n      },\n      app2: {\n        env: {\n          PORT: 4002\n        }\n      }\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'http://10.2.0.21',\n      // we use our own MongoDB installation....\n      MONGO_URL: 'mongodb://user:pass@10.2.0.10:27017/demo'\n    },\ndocker: {\n  image: 'abernix/meteord:node-8.4.0-base',\n},\ndeployCheckWaitTime: 120\n\n},\n}\n```\nShould get this result from Docker (i.e. sudo docker ps) :\nCONTAINER ID    IMAGE                  COMMAND                  CREATED      STATUS      PORTS                  NAMES\n7da6bba90ce5    mup-demo-app1:latest   \"/bin/sh -c 'bash ...\"   7 days ago   Up 7 days   0.0.0.0:4001->4001/tcp   demo-app1\n540bd0809a38    mup-demo-app2:latest   \"/bin/sh -c 'bash ...\"   7 days ago   Up 7 days   0.0.0.0:4002->4002/tcp   demo-app2\nThen setup nginx as a load balancer and route to either app on demand. And a single mup deploy to update the app instances.. ",
    "dbejarano32": "You should change this line, in sudoers file (sudo visudo)\n%sudo   ALL=(ALL:ALL) ALL\nby this:\n%sudo ALL=(ALL) NOPASSWD:ALL\nand solved problem!\n. ",
    "maxmatthews": "I submitted a pull request for this issue (https://github.com/zodern/meteor-up/pull/472). I don't think the port setting does anything in the meteor: {} object unless it goes in the env section and is capitalized. That seems to make everything magically work. Removing the port key outside the env object seems to have no effect.. Take a look at this config file:\nmodule.exports = {\n    servers: {\n        one: {\n            host: 'myserver.com',\n            username: 'myusername',\n            pem: '/path/to/cert'\n        }\n    },\n    setupMongo: false,\n    meteor: {\n        name: 'myProject',\n        path: '/my/project/path',\n        servers: {\n            one: {}\n        },\n        env: {\n            PORT: 3000,\n            ROOT_URL: 'https://mysite.com',\n            MONGO_URL: 'mongodb://databaseIP:27017/databaseName'\n        },\n        dockerImage: 'abernix/meteord:base', //temp necessary for meteor 1.4\n        deployCheckWaitTime: 60\n    },\n};\nspecifically this line: MONGO_URL: 'mongodb://databaseIP:27017/databaseName'\nJust change the databaseIP, the port if necessary, then add a slash and change the database name to the one of your choosing. \nNote that with setupMongo set to false you'll have to set up the database yourself.. I just wiped my Digital Ocean Droplet and loaded it with Ubuntu 14.04. Ran mup setup, then mup deploy. Here are my nginx docker logs. This line is of particular interest: \n*24 connect() failed (111: Connection refused) while connecting to upstream, client: PERSONALIPFILTERED, server: sub.domain.com, request: \"GET / HTTP/2.0\", upstream: \"http://172.17.0.3:80/\", host: \"sub.domain.com\"\nforego     | starting nginx.1 on port 5000\nforego     | starting dockergen.1 on port 5100\ndockergen.1 | 2017/02/14 15:30:15 Generated '/etc/nginx/conf.d/default.conf' from 3 containers\ndockergen.1 | 2017/02/14 15:30:15 Running 'nginx -s reload'\ndockergen.1 | 2017/02/14 15:30:15 Watching docker events\ndockergen.1 | 2017/02/14 15:30:15 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'\ndockergen.1 | 2017/02/14 15:30:32 Received event start for container b3b8e62fa4a7\ndockergen.1 | 2017/02/14 15:30:32 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'\ndockergen.1 | 2017/02/14 15:30:32 Received event die for container 55584faf1f41\ndockergen.1 | 2017/02/14 15:30:33 Received event start for container 55584faf1f41\ndockergen.1 | 2017/02/14 15:30:33 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'\ndockergen.1 | 2017/02/14 15:30:33 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'\nnginx.1    | localhost 172.17.0.1 - - [14/Feb/2017:15:30:34 +0000] \"GET / HTTP/1.1\" 503 213 \"-\" \"curl/7.35.0\"\ndockergen.1 | 2017/02/14 15:31:12 Received event die for container 55584faf1f41\ndockergen.1 | 2017/02/14 15:31:12 Received event start for container 55584faf1f41\ndockergen.1 | 2017/02/14 15:31:12 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'\ndockergen.1 | 2017/02/14 15:31:12 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'\nnginx.1    | SERVERIPFILTERED PERSONALIPFILTERED - - [14/Feb/2017:15:31:22 +0000] \"GET / HTTP/1.1\" 503 615 \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36\"\nnginx.1    | SERVERIPFILTERED PERSONALIPFILTERED - - [14/Feb/2017:15:31:23 +0000] \"GET /favicon.ico HTTP/1.1\" 503 615 \"http://SERVERIPFILTERED/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36\"\nnginx.1    | sub.domain.com PERSONALIPFILTERED - - [14/Feb/2017:15:31:35 +0000] \"GET / HTTP/1.1\" 502 173 \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_3) AppleWebKit/602.4.8 (KHTML, like Gecko) Version/10.0.3 Safari/602.4.8\"\nnginx.1    | 2017/02/14 15:31:35 [error] 24#24: *5 connect() failed (111: Connection refused) while connecting to upstream, client: PERSONALIPFILTERED, server: sub.domain.com, request: \"GET / HTTP/1.1\", upstream: \"http://172.17.0.3:80/\", host: \"sub.domain.com\"\nnginx.1    | SERVERIPFILTERED PERSONALIPFILTERED - - [14/Feb/2017:15:31:38 +0000] \"GET / HTTP/1.1\" 503 213 \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_3) AppleWebKit/602.4.8 (KHTML, like Gecko) Version/10.0.3 Safari/602.4.8\"\ndockergen.1 | 2017/02/14 15:31:59 Received event die for container 55584faf1f41\ndockergen.1 | 2017/02/14 15:32:00 Received event start for container 55584faf1f41\ndockergen.1 | 2017/02/14 15:32:00 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'\ndockergen.1 | 2017/02/14 15:32:00 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'\nnginx.1    | 2017/02/14 15:32:05 [error] 24#24: *8 connect() failed (111: Connection refused) while connecting to upstream, client: PERSONALIPFILTERED, server: sub.domain.com, request: \"GET /sockjs/info?cb=w9oypcshfi HTTP/1.1\", upstream: \"http://172.17.0.3:80/sockjs/info?cb=w9oypcshfi\", host: \"sub.domain.com\", referrer: \"http://sub.domain.com/\"\nnginx.1    | sub.domain.com PERSONALIPFILTERED - - [14/Feb/2017:15:32:05 +0000] \"GET /sockjs/info?cb=w9oypcshfi HTTP/1.1\" 502 173 \"http://sub.domain.com/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_3) AppleWebKit/602.4.8 (KHTML, like Gecko) Version/10.0.3 Safari/602.4.8\"\nnginx.1    | sub.domain.com 172.17.0.1 - - [14/Feb/2017:15:32:12 +0000] \"GET /.well-known/acme-challenge/zN8ZRZ6hRjyZKXyYIoxt1yEAeeHv-KY0V6drR0KkqfM HTTP/1.1\" 200 87 \"-\" \"python-requests/2.8.1\"\nnginx.1    | sub.domain.com 66.133.109.36 - - [14/Feb/2017:15:32:13 +0000] \"GET /.well-known/acme-challenge/zN8ZRZ6hRjyZKXyYIoxt1yEAeeHv-KY0V6drR0KkqfM HTTP/1.1\" 200 87 \"-\" \"Mozilla/5.0 (compatible; Let's Encrypt validation server; +https://www.letsencrypt.org)\"\n(Once again, sub.domain.com is actually the value of my domain and IPs are filtered). Yes. When I deploy without any SSL settings, it works great. When I deploy with them in, it crashes both port 80 and 443 with a 502 bad gateway, but it serves that error message over a successfully secured page, so I know the cert generation is working.. Still no luck. Tried wiping the server with a clean Ubuntu 14 image, updating meteor, adding the docker section @gaillota mentioned, running mup setup then mup deploy and I still get a 502. Would love any other suggestions.. AH HA! Got it. It was a memory error, although I never saw any issues in the logs. I upgraded my DO droplet from 512 MB RAM to 1 gb and ran the deploy. All of a sudden, everything started working great. However, when I scale it back down to 512 mb, everything crashes again. Any suggestions on how I can make it work on only half a gig of RAM?. @ivanthemeh Check out https://github.com/zodern/meteor-up/issues/462. Looks like some people were having issues with Ubuntu 16.. @ivanthemeh I would recommend wiping your AWS instance and your mup file, then reinitializing it with only the fields you absolutely need (leave the docker image alone) and only add the SSL/autogenerate section. Make sure you're on 1 GB of RAM and then rerun mup setup and mup deploy. I've spent several hours on a couple different issues and the two biggest things I've found is that mup simply doesn't like .5 gb of RAM and fails all over the place unexpectedly AND it doesn't handle issues in the mup.js file well.\nI'm going to close this issue for now because most of my issues were RAM related, but if you continue to have issues after doing a clean install, let me know and I'll try to help out.. @gaillota I think it was all RAM related. As soon as I upgraded to 1 GB of RAM suddenly all my issues disappeared. I was having problems with SSL and Ubuntu 14 vs 16 and both work fine on enough RAM.. @ivanthemeh I don't think my problem was a mapping issue with docker -> meteor, I think it was meteor wasn't booting because it didn't have enough RAM.. @ivanthemeh I'm pretty sure that you can't change the port if you're using the autogenerate option. It's listed as an enhancement here: https://github.com/zodern/meteor-up/issues/458. @ivanthemeh Make your own issue and post the link here and we can jump on that thread. Will make it easier for more people to follow both our issues as I think they are separate. Happy to help you once you do that.. This is a shot in the dark, but try changing your ROOT_URL to http://127.0.0.1 and then attempt to access your app directly through the IP. Funky things can happen sometimes with localhost.. I'm not sure if I can help at all. The meteor server is not designed to be used in an offline environment. There are certain pieces of meteor that handles if the client looses connection to a server , but not if the server is offline. \nCan you tell me a little bit more about your use case? Do you need to be able to have a server recover that looses an internet connection a lot, or are you somehow trying to run a server in another offline configuration?. Can you post your mup.js file and mup logs --tail 50?. If you've found your issue, feel free to close your issue!. So I submitted a pull request (https://github.com/zodern/meteor-up/pull/472) for an update on the documentation, but I can confirm that it has to go in the env object with a key of PORT (all caps). Once you do that, it will run on the correct port. I was then able to set up nignx (and subsequently LetsEncrypt by hand/manually) and point it at the port I specified in meteor.env.PORT. \n@ivanthemeh Can you post your mup file? Also, let me know if you need assitance setting up nginx/apache. \nMy docker ps looks like this, but I can confirm that outside the docker container, it is running on port 3005:\na09fdfdc6a9b        abernix/meteord:base   \"/bin/sh -c 'bash ...\"   18 minutes ago      Up 18 minutes       0.0.0.0:3005->80/tcp         appName****. You're trying to run multiple apps on the same server, right? If you are, you will have to set up nginx.\nFrom the readme:\n\nMultiple Deployments\nMeteor Up supports multiple deployments to a single server. Meteor Up only does the deployment; if you need to configure subdomains, you need to manually set up a reverse proxy yourself.. Yea, that's how I did it. Just use certbot/letsencrypt, set up a crontab on your own, then drop the cert file paths into your nginx config. Happy to post my nginx config file if you need it. It's not ideal, but I think it's a bit out of scope of this project to have multiple deployments with SSL right now. . @ivanthemeh Can you post your nginx config file?. When you hit site.com on port 80, do you get an nginx default welcome screen? . @ivanthemeh This may be against github protocol, but I reached out to you over email. Hopefully we'll be able to work it out offline and post the solution back here. However, if you'd prefer to keep it all within Github, we totally can. LMK!. ~Not if you change the meteor ENV settings, which is what the updated documentation does. If you just put port out of env, it does nothing.~ Never mind. You are right. . \n",
    "benjamn": "This is a Meteor problem, sorry! https://github.com/meteor/meteor/issues/8032#issuecomment-259431609\n. ",
    "seandevs": "posterity: when publishing to DockerHub, you will be using automated builds (docs https://docs.docker.com/docker-hub/builds/). ",
    "aleritty": "I have the same trouble, and inside the syslog I found this:\nNo such image: meteorhacks/mup-frontend-server:latest\nthis is for sure the problem with SSL.\nIf I comment out the SSL part my app deploy correctly.\n. +1. ",
    "babak49": "Also interested in that. For example I need to install wkhtmltopdf and others. ",
    "srokatonie": "Any updates on this?. ",
    "y0-0y": "bump. ",
    "theodorDiaconu": "Ok so what I did:\nnpm uninstall -g mup\nnvm install 4.6.1\nnvm use 4.4.6\nnpm install -g mup ssh2\nWorked like a charm! No idea what was up.\n. I'm here to say that I'm interested in this. @zodern can you pls work on an API first ? Just the commands we would need to run and what it would achieve. If the API looks promising and dead-simple, I'll be contributing.. @zodern put up $50 as well :) let's rock . @zodern can you give us a delivery date ? :) Your project is already more than 50% backed. . ",
    "DanielKoehler": "+1. ",
    "tonioknuth": "+1. ",
    "mackbrowne": "+1. Hello, I'm also stuck with this on digitalocean.  Trying to use Ubuntu 14.04 x64 image\n. @maxmatthews I needed this fix today.  Thank you.  After upgrading to a 1gb digitalOcean droplet, everything worked great.  It really cut down on the random fails I'd get once in a while with the smaller droplets.  \n@zodern are the minimum requirements specified anywhere in the readme?  It seems if autogenerate is being used, a 1gb seems to be the minimum requirement for RAM.  Using ubuntu 14.04, etc.  I'd be happy to write a \"recommended minimum requirements\" section for the readme and send you a PR?  I could at least start the section for my experiences on both AWS and DigitalOcean.. I'm having this issue as well.  Uninstalling bcrypt didn't help.\nI updated from mup 1.2.4 -> 1.2.5 and started getting this error.\nUPDATE:\nI reverted back to mup 1.2.4 to fix my problem.  I wouldn't recommend upgrading mup at this time.\nUsing digitalocean's Ubuntu 14.04.5 image and the abernix/meteord:base docker image. ",
    "kodie": "Yes please!. ```javascript\nmodule.exports = {\n  servers: {\n    one: {\n      host: '123.456.78.910',\n      username: 'root',\n      // pem: '/home/user/.ssh/id_rsa',\n      // password: 'password',\n      // or leave blank to authenticate using ssh-agent\n      opts: {\n          //port: 22,\n      },\n    }\n  },\nmeteor: {\n    name: 'myapp',\n    path: '/www/apps/myapp',\n    // docker: {\n    //   image: 'abernix/meteord:base',\n    // },\n    servers: {\n      one: {}\n    },\n    env: {\n      ROOT_URL: 'http://myapp.mysite.com',\n      MONGO_URL: '[MY MONGO STUFF]'\n    },\n    deployCheckWaitTime: 120,\n    enableUploadProgressBar: true\n  },\nmongo: {\n    oplog: true,\n    port: 10369,\n    version: '3.4.1',\n    servers: {\n      one: {}\n    },\n  },\n};\n```\nDroplet:\n512 MB Memory / 20 GB Disk / NYC3 - Ubuntu 16.04.1 x64 w/ IPv6 enabled\nHaven't done anything besides mup setup and mup deploy. Even tried destroying the droplet and remaking it and got the same results.. Can confirm that like @lunatolun, a fresh install on Ubuntu 14.04.5 x64 works.. Running into the same issue with METEOR@1.4.3.2 and MUP@1.3.5 :(. This is probably related to this: https://superuser.com/questions/318809/linux-os-x-tar-incompatibility-tarballs-created-on-os-x-give-errors-when-unt\nIs everyone here that's running into the same issue using a Mac?. Okay so a couple of things that I have tried:\n1.) Switching my node version from v8.9.0 to v6.12.0 using nvm.\n2.) Downgrading Meteor from v1.6 to v1.4.3.2 by running the following:\nsudo rm /usr/local/bin/meteor\nrm -rf ~/.meteor\ncurl https://install.meteor.com/?release=1.4.3.2 | sh\n3.) Switching from bsdtar to gtar by running the following:\nbrew install gnu-tar\nsudo unlink `which tar`\nsudo ln -s `which gtar` /usr/bin/tar\nand none of those seem to have fixed the problem. HOWEVER, after I deploy my app and get the failed error message, it seems my server goes down. After that happens, I run mup restart and it comes back up again and seems that everything deployed fine. \ud83e\udd14\nI am running OS X El Capitan.. We're seeing those tar: Ignoring unknown extended header keyword 'SCHILY.dev' error messages in issue #790. Could this PR potentially fix that? \ud83e\udd14. I ended up getting past this by power cycling my droplet, re-running mup setup and then deploying again.. Experiencing the same issue with mup@v1.4.3 and meteor@1.4.3.2.\nmup stop && mup start works fine.. ",
    "ziedmahdi": "+1. any luck with this?. @chrisbutler what is the meteor version?\nYou can omit the buildOptions in the mup.js file.. @nick-preda to enforce redirect from http to https add force-sslpackage to your app.\nsh\n$ meteor add force-ssl. @nick-preda yeah it's working for me.. does changing the docker image resolve your problem?\nuse abernix/meteord:node-8.4.0-base. you need to open some ports in your firewall, usually port 25 for smtp. . @thearabbit what is the used mup version (mup --version)?\n. you need to do something like this:\nsh\n    $ export METEOR_PACKAGE_DIRS=../Packages\n    $ mup setup\n    $ mup deploy. @derwaldgeist it is mentioned in the docs.\nI think what's better is if you check the docs and previous issues before creating a new one.. @zodern I noticed that the old app container is stopped while/before the new image is prepared (by the prepare bundle script). I think if we only stop the app after the bundle is prepared it will reduce app downtime and it will make it easier to rollback to previous version if the image was not created or the container failed to run.\nWhat do you think?. so basically the only problem is with memory. Knowing how much ram is available is possible, but knowing how much of ram the prepare bundle will take that may be a problem, and also we should look into swap memory.\nI think a configuration option is not a bad solution, let the developer decides wether to run prepare bundle and keep the app running at the same time or not.\nbtw, what is the technical solution for no down time deployment? and does it have some memory/cpu requirements? . 1. make sure when u install your node modules to use meteor npm i and not just npm i, you can delete the nod_modules folder and then run meteor npm i.\n\nFor docker image use abernix/meteord:node-8.11.2-base as u r using Meteor 1.8\nI m not sure about this, but I think you don't need the docker.args part as the mongo container will be automatically linked by mup, so remove it.\n\nHope this helps.. ",
    "movationdesign": "+1 !!. Here's my output after mup deploy --verbose\nmup-deploy-verbose-output.txt\nI hope that's what you were asking for in my topic @zodern ? :). Hmm okay, that's a weird issue.  \nI'll be ready to update and test asap :-). Ok after the update I get this from regular mup deploy:\nmup-1-4-1-normal-mup-deploy.txt\nEdit: I get the exact same output when running mup deploy --verbose. Btw as a reference. I tried downgrading to version 1.3.6 and repeated the entire Droplet setup process (everything like before) this gives me this error: \nStarted TaskList: Pushing Meteor App\n[159.89.95.188] - Pushing Meteor App Bundle to the Server\n[159.89.95.188] - Pushing Meteor App Bundle to the Server: SUCCESS\n[159.89.95.188] - Prepare Bundle\n[159.89.95.188] x Prepare Bundle: FAILED\n-----------------------------------STDERR-----------------------------------\nError response from daemon: No such container: testing\nbash: line 28: Dockerfile: Permission denied\n-----------------------------------STDOUT-----------------------------------\nnode-8.4.0-base: Pulling from abernix/meteord\nDigest: sha256:04f44cf999da383d11de77027ced8b70818222c9890a405ce10803af3ee5a642\nStatus: Image is up to date for abernix/meteord:node-8.4.0-base\n----------------------------------------------------------------------------\n\nWhich is odd to me, because I'm pretty sure everything worked fine deploying to DO when I used this version before updating to 1.4 . ",
    "aureooms": "Here is a meteor database backup example using rclone.. ",
    "fgriberi": "+1. ",
    "fernandovfilho": "+1. ",
    "gsilvestri": "+1. ",
    "xpressabhi": "Backup and restore can be achieved via these steps , still having inbuild option in mup will do no harm.\nhttps://github.com/xpressabhi/mup-data-backup/\n. Image abernix/meteord:node-8.4.0-base works with meteor 1.6, hope it syncs to meteor node 8.8.1 version soon.. Try abernix/meteord:node-8-base or abernix/meteord:node-8.9.1-base , then do mup setup and mup deploy.\nAs per this page https://hub.docker.com/r/abernix/meteord/, above base docker will support Meteor 1.6+. ",
    "HazemKhaled": "It can be a plugin using @xpressabhi script. ",
    "adamthewan": "Try to change \"Universal Boats\" to \"UniversalBoats\" without the space. ",
    "prafulc": "@codeHatcher yes removing space in name worked for me.\nAlso try to keep nodejs and npm versions on server and local machine same as what your meteor is using.. ",
    "OliverColeman": "I'm having the same issue. Most of the time it works fine. Every now and then it doesn't. It's driving me crazy this time. Have tried everything I can think of. Things I've checked/tried so far:\n\nI've tried removing everything in /opt/APP_NAME/tmp/bundle.\nAfter mup deploy the new code seems to be in the /opt/APP_NAME/tmp/bundle folder (I grepped it for a newly introduced CSS class).\nI've tried stopping and starting the docker container, via mup stop and mup start, and on the server with the docker CLI.\nI've tried removing the container with docker rm from the server and restarting it via mup start\nI tried a hard reload in the browser (I know, this shouldn't be necessary, but just in case...)\n. Also tried rebooting the server, to no avail.. After several days of digging: I'd set zsh as the shell for the user on the server. Turns out this was somehow breaking the deploy. No errors were reported by the mup deploy command. It looks like the prepare-bundle.sh script was silently failing, and the previous version of the app was being restarted (hence not appearing to update even though mup deploy appeared to work). FFS.. @fhackenb I set the default shell back to bash.. \n",
    "fhackenb": "@OliverColeman so how did you fix it?. I saw on another post that you suggested setting prepareBundle to false, so I tried that and now it's failing on the Verifying Deployment stage:\nStarted TaskList: Start Meteor\n[34.231.183.239] - Start Meteor\n[34.231.183.239] - Start Meteor: SUCCESS\n[34.231.183.239] - Verifying Deployment\n[34.231.183.239] x Verifying Deployment: FAILED\n    -----------------------------------STDERR-----------------------------------\n    ted platform and node version. If you\n    would like to compile fibers on this machine please make sure you have setup your\n    build environment--\n    Windows + OS X instructions here: https://github.com/nodejs/node-gyp\n    Ubuntu users please run: `sudo apt-get install g++`\n    Alpine users please run: `sudo apk add python make g++`\n    sh: 1: nodejs: not found\n    npm WARN meteor-dev-bundle@0.0.0 No description\n    npm WARN meteor-dev-bundle@0.0.0 No repository field.\n    npm WARN meteor-dev-bundle@0.0.0 No license field.\n\n    npm ERR! file sh\n    npm ERR! code ELIFECYCLE\n    npm ERR! errno ENOENT\n    npm ERR! syscall spawn\n    npm ERR! fibers@1.0.13 install: `node build.js || nodejs build.js`\n    npm ERR! spawn ENOENT\n    npm ERR! \n    npm ERR! Failed at the fibers@1.0.13 install script.\n    npm ERR! This is probably not a problem with npm. There is likely additional logging output above.\n\n    npm ERR! A complete log of this run can be found in:\n    npm ERR!     /root/.npm/_logs/2017-12-12T21_02_14_262Z-debug.log\n\n    => Redeploying previous version of the app\n\n    -----------------------------------STDOUT-----------------------------------\n\n    To see more logs type 'mup logs --tail=100'\n\n    ----------------------------------------------------------------------------. With --verbose I'm getting:\n\nStarted TaskList: Pushing Meteor App\n[34.231.183.239] - Pushing Meteor App Bundle to the Server\n[34.231.183.239] - Pushing Meteor App Bundle to the Server: SUCCESS\n[34.231.183.239] - Prepare Bundle\nError: No such image: mup-loopleague-prod:latest\n[34.231.183.239] - Prepare Bundle: SUCCESS\nStarted TaskList: Configuring App\n[34.231.183.239] - Pushing the Startup Script\n[34.231.183.239] - Pushing the Startup Script: SUCCESS\n[34.231.183.239] - Sending Environment Variables\n[34.231.183.239] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[34.231.183.239] - Start Meteor\nError: No such image: mup-loopleague-prod:latest\nusing bundle\nError: No such image: mup-loopleague-prod:previous\nError: No such image: mup-loopleague-prod:previous\nError: No such image: mup-loopleague-prod:latest\nImage abernix/meteord:node-8.4.0-base\nVolume --volume=/opt/loopleague-prod/current:/bundle\nRemoving docker containers. Errors about nonexistent endpoints and containers are normal.\nloopleague-prod\nError response from daemon: endpoint loopleague-prod not found\nError: No such container: loopleague-prod-frontend\nError response from daemon: endpoint loopleague-prod-frontend not found\nError: No such container: loopleague-prod-nginx-letsencrypt\nError response from daemon: endpoint loopleague-prod-nginx-letsencrypt not found\nError: No such container: loopleague-prod-nginx-proxy\nError response from daemon: endpoint loopleague-prod-nginx-proxy not found\nFinished removing docker containers\nnode-8.4.0-base: Pulling from abernix/meteord\nDigest: sha256:04f44cf999da383d11de77027ced8b70818222c9890a405ce10803af3ee5a642\nStatus: Image is up to date for abernix/meteord:node-8.4.0-base\nPulled abernix/meteord:node-8.4.0-base\n83dbe2b6291ca0a9b3eccd42f6c73481d1917741b1df6196a7dcb04e09dce66b\nRan abernix/meteord:node-8.4.0-base\n[34.231.183.239] - Start Meteor: SUCCESS\n[34.231.183.239] - Verifying Deployment\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (52) Empty reply from server\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (52) Empty reply from server\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (52) Empty reply from server\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to localhost port 6666: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (52) Empty reply from server\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to localhost port 6666: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to localhost port 6666: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to localhost port 6666: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to localhost port 6666: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (52) Empty reply from server\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to localhost port 6666: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to localhost port 6666: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to localhost port 6666: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to localhost port 6666: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to localhost port 6666: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to localhost port 6666: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (56) Recv failure: Connection reset by peer\n                                  ^\n../src/fibers.cc:49:50: error: expected ',' or '...' before '<' token\n  void WeakCallbackShim(const v8::WeakCallbackData& data) {\n                                                  ^\n../src/fibers.cc: In function 'void uni::WeakCallbackShim(int)':\n../src/fibers.cc:50:5: error: 'data' was not declared in this scope\n   F(data.GetParameter());\n     ^\n../src/fibers.cc: In function 'v8::Handle uni::NewLatin1String(v8::Isolate, const char)':\n../src/fibers.cc:102:64: warning: 'static v8::Local v8::String::NewFromOneByte(v8::Isolate, const uint8_t, v8::String::NewStringType, int)' is deprecated (declared at /root/.node-gyp/8.4.0/include/node/v8.h:2624): Use maybe version [-Wdeprecated-declarations]\n   return String::NewFromOneByte(isolate, (const uint8_t)string);\n                                                                ^\n../src/fibers.cc: In function 'v8::Handle uni::NewLatin1Symbol(v8::Isolate, const char)':\n../src/fibers.cc:106:64: warning: 'static v8::Local v8::String::NewFromOneByte(v8::Isolate, const uint8_t, v8::String::NewStringType, int)' is deprecated (declared at /root/.node-gyp/8.4.0/include/node/v8.h:2624): Use maybe version [-Wdeprecated-declarations]\n   return String::NewFromOneByte(isolate, (const uint8_t)string);\n                                                                ^\n../src/fibers.cc: In static member function 'static uni::FunctionType Fiber::New(const Arguments&)':\n../src/fibers.cc:423:99: warning: 'v8::Local v8::Function::NewInstance(int, v8::Local) const' is deprecated (declared at /root/.node-gyp/8.4.0/include/node/v8.h:3787): Use maybe version [-Wdeprecated-declarations]\n     return uni::Return(uni::Deref(Isolate::GetCurrent(), tmpl)->GetFunction()->NewInstance(1, argv), args);\n                                                                                                   ^\n../src/fibers.cc: In static member function 'static void Fiber::RunFiber(void)':\n../src/fibers.cc:611:14: warning: 'v8::TryCatch::TryCatch()' is deprecated (declared at /root/.node-gyp/8.4.0/include/node/v8.h:8157): Use isolate version [-Wdeprecated-declarations]\n     TryCatch try_catch;\n              ^\n../src/fibers.cc: In static member function 'static void Fiber::SetPoolSize(v8::Local, v8::Local, const SetterCallbackInfo&)':\n../src/fibers.cc:731:43: warning: 'v8::Local v8::Value::ToNumber() const' is deprecated (declared at /root/.node-gyp/8.4.0/include/node/v8.h:9578): Use maybe version [-Wdeprecated-declarations]\n    Coroutine::pool_size = value->ToNumber()->Value();\n                                           ^\n../src/fibers.cc: In static member function 'static void Fiber::Init(v8::Handle)':\n../src/fibers.cc:785:72: warning: 'bool v8::Object::SetAccessor(v8::Local, v8::AccessorGetterCallback, v8::AccessorSetterCallback, v8::Local, v8::AccessControl, v8::PropertyAttribute)' is deprecated (declared at /root/.node-gyp/8.4.0/include/node/v8.h:3120): Use maybe version [-Wdeprecated-declarations]\n    fn->SetAccessor(uni::NewLatin1Symbol(isolate, \"current\"), GetCurrent);\n                                                                        ^\n../src/fibers.cc:786:87: warning: 'bool v8::Object::SetAccessor(v8::Local, v8::AccessorGetterCallback, v8::AccessorSetterCallback, v8::Local, v8::AccessControl, v8::PropertyAttribute)' is deprecated (declared at /root/.node-gyp/8.4.0/include/node/v8.h:3120): Use maybe version [-Wdeprecated-declarations]\n    fn->SetAccessor(uni::NewLatin1Symbol(isolate, \"poolSize\"), GetPoolSize, SetPoolSize);\n                                                                                       ^\n../src/fibers.cc:787:84: warning: 'bool v8::Object::SetAccessor(v8::Local, v8::AccessorGetterCallback, v8::AccessorSetterCallback, v8::Local, v8::AccessControl, v8::PropertyAttribute)' is deprecated (declared at /root/.node-gyp/8.4.0/include/node/v8.h:3120): Use maybe version [-Wdeprecated-declarations]\n    fn->SetAccessor(uni::NewLatin1Symbol(isolate, \"fibersCreated\"), GetFibersCreated);\n                                                                                    ^\n../src/fibers.cc: In instantiation of 'void uni::MakeWeak(v8::Isolate, v8::Persistent&, P) [with void ( F)(void) = Fiber::WeakCallback; T = v8::Object; P = void]':\n../src/fibers.cc:341:60:   required from here\n../src/fibers.cc:55:3: error: no matching function for call to 'v8::Persistent::SetWeak(void&, )'\n   handle.SetWeak(val, WeakCallbackShim);\n   ^\n../src/fibers.cc:55:3: note: candidates are:\nIn file included from /root/.node-gyp/8.4.0/include/node/node.h:63:0,\n                 from ../src/coroutine.h:1,\n                 from ../src/fibers.cc:1:\n/root/.node-gyp/8.4.0/include/node/v8.h:544:18: note: template void v8::PersistentBase::SetWeak(P, typename v8::WeakCallbackInfo::Callback, v8::WeakCallbackType) [with P = P; T = v8::Object]\n   V8_INLINE void SetWeak(P* parameter,\n                  ^\n/root/.node-gyp/8.4.0/include/node/v8.h:544:18: note:   template argument deduction/substitution failed:\n../src/fibers.cc:55:3: note:   candidate expects 3 arguments, 2 provided\n   handle.SetWeak(val, WeakCallbackShim);\n   ^\nIn file included from /root/.node-gyp/8.4.0/include/node/node.h:63:0,\n                 from ../src/coroutine.h:1,\n                 from ../src/fibers.cc:1:\n/root/.node-gyp/8.4.0/include/node/v8.h:555:18: note: void v8::PersistentBase::SetWeak() [with T = v8::Object]\n   V8_INLINE void SetWeak();\n                  ^\n/root/.node-gyp/8.4.0/include/node/v8.h:555:18: note:   candidate expects 0 arguments, 2 provided\nmake:  [Release/obj.target/fibers/src/fibers.o] Error 1\nfibers.target.mk:102: recipe for target 'Release/obj.target/fibers/src/fibers.o' failed\nmake: Leaving directory '/bundle/bundle/programs/server/node_modules/fibers/build'\ngyp ERR! build error \ngyp ERR! stack Error: make failed with exit code: 2\ngyp ERR! stack     at ChildProcess.onExit (/opt/nodejs/lib/node_modules/npm/node_modules/node-gyp/lib/build.js:258:23)\ngyp ERR! stack     at emitTwo (events.js:125:13)\ngyp ERR! stack     at ChildProcess.emit (events.js:213:7)\ngyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:200:12)\ngyp ERR! System Linux 4.4.0-1041-aws\ngyp ERR! command \"/opt/nodejs/bin/node\" \"/opt/nodejs/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js\" \"rebuild\" \"--release\"\ngyp ERR! cwd /bundle/bundle/programs/server/node_modules/fibers\ngyp ERR! node -v v8.4.0\ngyp ERR! node-gyp -v v3.6.2\ngyp ERR! not ok \nnode-gyp exited with code: 1\nPlease make sure you are using a supported platform and node version. If you\nwould like to compile fibers on this machine please make sure you have setup your\nbuild environment--\nWindows + OS X instructions here: https://github.com/nodejs/node-gyp\nUbuntu users please run: sudo apt-get install g++\nAlpine users please run: sudo apk add python make g++\nsh: 1: nodejs: not found\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\nnpm ERR! file sh\nnpm ERR! code ELIFECYCLE\nnpm ERR! errno ENOENT\nnpm ERR! syscall spawn\nnpm ERR! fibers@1.0.13 install: node build.js || nodejs build.js\nnpm ERR! spawn ENOENT\nnpm ERR! \nnpm ERR! Failed at the fibers@1.0.13 install script.\nnpm ERR! This is probably not a problem with npm. There is likely additional logging output above.\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     /root/.npm/_logs/2017-12-12T21_08_51_855Z-debug.log\nTo see more logs type 'mup logs --tail=100'\n=> Redeploying previous version of the app\n[34.231.183.239] x Verifying Deployment: FAILED\n    -----------------------------------STDERR-----------------------------------\n    ted platform and node version. If you\n    would like to compile fibers on this machine please make sure you have setup your\n    build environment--\n    Windows + OS X instructions here: https://github.com/nodejs/node-gyp\n    Ubuntu users please run: `sudo apt-get install g++`\n    Alpine users please run: `sudo apk add python make g++`\n    sh: 1: nodejs: not found\n    npm WARN meteor-dev-bundle@0.0.0 No description\n    npm WARN meteor-dev-bundle@0.0.0 No repository field.\n    npm WARN meteor-dev-bundle@0.0.0 No license field.\n\n    npm ERR! file sh\n    npm ERR! code ELIFECYCLE\n    npm ERR! errno ENOENT\n    npm ERR! syscall spawn\n    npm ERR! fibers@1.0.13 install: `node build.js || nodejs build.js`\n    npm ERR! spawn ENOENT\n    npm ERR! \n    npm ERR! Failed at the fibers@1.0.13 install script.\n    npm ERR! This is probably not a problem with npm. There is likely additional logging output above.\n\n    npm ERR! A complete log of this run can be found in:\n    npm ERR!     /root/.npm/_logs/2017-12-12T21_08_51_855Z-debug.log\n\n    => Redeploying previous version of the app\n\n    -----------------------------------STDOUT-----------------------------------\n\n    To see more logs type 'mup logs --tail=100'\n\n    ----------------------------------------------------------------------------.\n",
    "Floriferous": "Is it ok to ignore this warning? Not sure what exactly it entails ?\n. Never mind, there was a weird error 137 in the stack trace. Upgraded server RAM from 512MB to 1GB and now it's working again!. What is the canonical way to get this done? I'm curious about it and not very well versed with nginx.. I'm seeing this same error on v1.3.0 and v1.3.7. Downgrading to 1.2.11 makes it work again.\nThe error for me happens when uploading a custom SSL certificate in the proxy.ssl object (here 1.3.7):\n```\n\nmup setup\n\nStarted TaskList: Setup Docker\n[139.59.211.103] - Setup Docker\n[139.59.211.103] - Setup Docker: SUCCESS\nStarted TaskList: Setup proxy\n[139.59.211.103] - Setup Environment\n[139.59.211.103] - Setup Environment: SUCCESS\n[139.59.211.103] - Pushing the Startup Script\n[139.59.211.103] - Pushing the Startup Script: SUCCESS\n[139.59.211.103] - Cleaning Up SSL Certificates\n[139.59.211.103] - Cleaning Up SSL Certificates: SUCCESS\n[139.59.211.103] - Copying SSL Certificate Bundle\nFailed to copy file  { Error: No such file\n    at SFTPStream._transform (/usr/local/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2-streams/lib/sftp.js:384:27)\n    at SFTPStream.Transform._read (_stream_transform.js:167:10)\n    at SFTPStream._read (/usr/local/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2-streams/lib/sftp.js:170:15)\n    at SFTPStream.Transform._write (_stream_transform.js:155:12)\n    at doWrite (_stream_writable.js:334:12)\n    at writeOrBuffer (_stream_writable.js:320:5)\n    at SFTPStream.Writable.write (_stream_writable.js:247:11)\n    at Channel.ondata (_stream_readable.js:555:20)\n    at emitOne (events.js:96:13)\n    at Channel.emit (events.js:188:7)\n    at readableAddChunk (_stream_readable.js:176:18)\n    at Channel.Readable.push (_stream_readable.js:134:10)\n    at SSH2Stream. (/usr/local/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2/lib/Channel.js:140:15)\n    at emitOne (events.js:96:13)\n    at SSH2Stream.emit (events.js:188:7)\n    at parsePacket (/usr/local/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2-streams/lib/ssh.js:3163:10) code: 2, lang: '' }\nRetrying in 3 seconds\n```\nAnd my mup config (the goal being to have 2 apps on the same VPS):\n```js\nmodule.exports = {\n  servers: {\n    one: {\n      host: 'xxxxxx',\n      username: 'root',\n      pem: '~/.ssh/id_rsa',\n    },\n  },\nmeteor: {\n    name: 'my-app',\n    path: 'path/to/myApp',\nservers: {\n  one: {\n    env: {},\n  },\n},\n\nbuildOptions: {\n  serverOnly: true,\n},\n\nenv: {\n  ROOT_URL: 'https://subdomain1.my-app.com',\n  MONGO_URL: 'xxx',\n},\n\ndocker: {\n  image: 'abernix/meteord:node-8-base',\n},\n\nenableUploadProgressBar: true,\ndeployCheckWaitTime: 120,\n\n},\nproxy: {\n    domains: 'subdomain1.my-app.com',\n    ssl: {\n      crt: './bundle.crt',\n      key: './privatekey.key',\n    },\n  },\n};\n```. Getting the same issue. For now I think the best option is to configure nginx manually.\n  . This is starting to make our deployments with mup extremely painful, each deployment takes >30 minutes on our CI, and we're doing 3 of them each time in parallel costing us a lot of container time.\nPlus, the added duration during which our websites are completely down is immense given that rolling deployments isn't available yet.\nWe're really feeling the need for more \"production-quality\" improvements in terms of performance and availability :). Encountering the same issue, is there a workaround for the moment?\nDoes mup stop && mup start essentially do the same thing when run one after the other?. So it was a temporary issue?\nI ended up installing docker manually as instructed by the droplet, and then it worked again:\napt install docker.io. This is an absolutely insane release @zodern, everything is coming together, super excited! . ",
    "jvallarvisp": "@ibrahimzahoor Thanks. How about libpq? Do you have an idea on how to install it?\n```\n[35.163.139.67]> libpq@1.8.5 install /bundle/bundle/programs/server/npm/node_modules/libpq\n[35.163.139.67]> node-gyp rebuild\n[35.163.139.67]\n[35.163.139.67]find: /usr/pg*': No such file or directory\n[35.163.139.67]gyp: Call to 'which pg_config || find /usr/bin /usr/local/bin /usr/pg* /opt -executable -name pg_config -print -quit' returned exit status 1 while in binding.gyp. while trying to load binding.gyp\n[35.163.139.67]gyp ERR! configure error \n[35.163.139.67]gyp ERR! stack Error:gypfailed with exit code: 1\n[35.163.139.67]gyp ERR! stack     at ChildProcess.onCpExit (/opt/nodejs/lib/node_modules/npm/node_modules/node-gyp/lib/configure.js:305:16)\n[35.163.139.67]gyp ERR! stack     at emitTwo (events.js:87:13)\n[35.163.139.67]gyp ERR! stack     at ChildProcess.emit (events.js:172:7)\n[35.163.139.67]gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:200:12)\n[35.163.139.67]gyp ERR! System Linux 4.4.0-47-generic\n[35.163.139.67]gyp ERR! command \"/opt/nodejs/bin/node\" \"/opt/nodejs/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js\" \"rebuild\"\n[35.163.139.67]gyp ERR! cwd /bundle/bundle/programs/server/npm/node_modules/libpq\n[35.163.139.67]gyp ERR! node -v v4.4.7\n[35.163.139.67]gyp ERR! node-gyp -v v3.4.0\n[35.163.139.67]gyp ERR! not ok \n[35.163.139.67]\n[35.163.139.67]npm ERR! Linux 4.4.0-47-generic\n[35.163.139.67]npm ERR! argv \"/opt/nodejs/bin/node\" \"/opt/nodejs/bin/npm\" \"rebuild\" \"--no-bin-links\" \"--update-binary\"\n[35.163.139.67]npm ERR! node v4.4.7\n[35.163.139.67]npm ERR! npm  v3.10.8\n[35.163.139.67]npm ERR! code ELIFECYCLE\n[35.163.139.67]npm ERR! libpq@1.8.5 install:node-gyp rebuild`\n[35.163.139.67]npm ERR! Exit status 1\n[35.163.139.67]npm ERR! \n[35.163.139.67]npm ERR! Failed at the libpq@1.8.5 install script 'node-gyp rebuild'.\n[35.163.139.67]npm ERR! Make sure you have the latest version of node.js and npm installed.\n[35.163.139.67]npm ERR! If you do, this is most likely a problem with the libpq package,\n[35.163.139.67]npm ERR! not with npm itself.\n[35.163.139.67]npm ERR! Tell the author that this fails on your system:\n[35.163.139.67]npm ERR!     node-gyp rebuild\n[35.163.139.67]npm ERR! You can get information on how to open an issue for this project with:\n[35.163.139.67]npm ERR!     npm bugs libpq\n[35.163.139.67]npm ERR! Or if that isn't available, you can get their info via:\n[35.163.139.67]npm ERR!     npm owner ls libpq\n[35.163.139.67]npm ERR! There is likely additional logging output above.\n[35.163.139.67]\n[35.163.139.67]npm ERR! Please include the following file with any support request:\n[35.163.139.67]npm ERR!     /bundle/bundle/programs/server/npm/npm-debug.log\n[35.163.139.67]\n```\n. ",
    "raymondtm": "SSH based authentication with sudo\nIf your username is root or you're using AWS EC2, you don't need to follow these steps\nPlease ensure your key file (pem) is not protected by a passphrase. This setup process will require NOPASSWD access to sudo. (Since Meteor needs port 80, sudo access is required.)\nMake sure you also add your ssh key to the /YOUR_USERNAME/.ssh/authorized_keys list.\nYou can add your user to the sudo group:\nsudo adduser username  sudo\nAnd you also need to add NOPASSWD to the sudoers file:\nsudo visudo\nreplace this line\n%sudo  ALL=(ALL) ALL\nby this line\n%sudo ALL=(ALL) NOPASSWD:ALL\nWhen this process is not working you might encounter the following error:\n'sudo: no tty present and no askpass program specified'. ",
    "maryito": "yes\nthank you very much. I solved it by removing the package. ",
    "Fred-J": "OK. Got it. ../../appname fixed it. Thanks for that .. ",
    "w3jimmy": "Hi guys, I just had the same error and came here looking for help. \nMy app's path was correct, but in my case I fixed the issue by changing the value of buildOptions.executable from './meteor' to 'meteor' in the mup settings file.\nI was actually surprised, because my meteor version installed globally is exactly the same as the local meteor version (1.4.4.2).\nI hope this helps someone else!. I have exactly the same problem in AWS (Connecting through ssh)\nI also tried to connect to mongodb running in the same server.\nI always get the following error after starting Meteor\nfailed to connect to server [localhost:27017] on first connect\nor\nfailed to connect to server [ip_address:27017] on first connect\nI'm using: setupMongo: false and no mongo object\nI can connect to the mongodb using a client (robomongo). ",
    "eportico": "Resolved:\nIn mup.js\ndocker: {\n      image: 'abernix/meteord:base',\n      args: [\"-v /etc/timezone:/etc/timezone\",\"-v /etc/localtime:/etc/localtime\"]\n    },\n. ",
    "YunaiV": "@eportico hi?can you tell me which os did you used? ubuntu or centos 6 or centos7?. ",
    "Cu4rach4": "how we can solve this?, can we modified directly nginx, wish file needs to be modified?\nThnaks. can you exec free to see you swap?, jus t add a new swapfile to your linux and should be work...\nYou will see something like this:\n\nfree\n              total        used        free      shared  buff/cache   available\nMem:        1014372      149508       57048       12192      807816      804136\nSwap:       2097148       41760     2055388\n. did you install meteor?\n\ncurl https://install.meteor.com/ | sh\nwish version of node do you have installed?. i have almost the same problem, but this is my logs --tail=50\n\n[app.vita-fx.org]  \"uv\": \"1.9.1\",\n[app.vita-fx.org]  \"v8\": \"4.5.103.43\",\n[app.vita-fx.org]  \"zlib\": \"1.2.8\"\n[app.vita-fx.org]}\n[app.vita-fx.org]npm WARN meteor-dev-bundle@0.0.0 No description\n[app.vita-fx.org]npm WARN meteor-dev-bundle@0.0.0 No repository field.\n[app.vita-fx.org]npm WARN meteor-dev-bundle@0.0.0 No license field.\n[app.vita-fx.org]=> Starting meteor app on port:80\n[app.vita-fx.org]Kadira: Successfully connected\n[app.vita-fx.org]\n[app.vita-fx.org]/bundle/bundle/programs/server/node_modules/fibers/future.js:300\n[app.vita-fx.org]                     throw(ex);\n[app.vita-fx.org]                     ^\n[app.vita-fx.org][object Object]\n[app.vita-fx.org]\n[app.vita-fx.org]> meteor-dev-bundle@0.0.0 install /bundle/bundle/programs/server\n[app.vita-fx.org]> node npm-rebuild.js\n[app.vita-fx.org]\n[app.vita-fx.org]\n[app.vita-fx.org]> bcrypt@0.8.5 install /bundle/bundle/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt\n[app.vita-fx.org]> node-gyp rebuild\n[app.vita-fx.org]\n[app.vita-fx.org]make: Entering directory '/bundle/bundle/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt/build'\n[app.vita-fx.org]  CXX(target) Release/obj.target/bcrypt_lib/src/blowfish.o\n[app.vita-fx.org]  CXX(target) Release/obj.target/bcrypt_lib/src/bcrypt.o\n[app.vita-fx.org]  CXX(target) Release/obj.target/bcrypt_lib/src/bcrypt_node.o\n[app.vita-fx.org]  SOLINK_MODULE(target) Release/obj.target/bcrypt_lib.node\n[app.vita-fx.org]  COPY Release/bcrypt_lib.node\n[app.vita-fx.org]make: Leaving directory '/bundle/bundle/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt/build'\n[app.vita-fx.org]bcrypt@0.8.5 /bundle/bundle/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt\n[app.vita-fx.org]bindings@1.2.1 /bundle/bundle/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt/node_modules/bindings\n[app.vita-fx.org]nan@2.0.5 /bundle/bundle/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt/node_modules/nan\n[app.vita-fx.org]{\n[app.vita-fx.org]  \"meteor-dev-bundle\": \"0.0.0\",\n[app.vita-fx.org]  \"npm\": \"3.10.10\",\n[app.vita-fx.org]  \"ares\": \"1.10.1-DEV\",\n[app.vita-fx.org]  \"http_parser\": \"2.7.0\",\n[app.vita-fx.org]  \"icu\": \"56.1\",\n[app.vita-fx.org]  \"modules\": \"46\",\n[app.vita-fx.org]  \"node\": \"4.7.2\",\n[app.vita-fx.org]  \"openssl\": \"1.0.2j\",\n[app.vita-fx.org]  \"uv\": \"1.9.1\",\n[app.vita-fx.org]  \"v8\": \"4.5.103.43\",\n[app.vita-fx.org]  \"zlib\": \"1.2.8\"\n[app.vita-fx.org]}\n[app.vita-fx.org]npm WARN meteor-dev-bundle@0.0.0 No description\n[app.vita-fx.org]npm WARN meteor-dev-bundle@0.0.0 No repository field.\n[app.vita-fx.org]npm WARN meteor-dev-bundle@0.0.0 No license field.\n[app.vita-fx.org]=> Starting meteor app on port:80\n[app.vita-fx.org]Kadira: Successfully connected\n\nCould you send your log, to compare, i believe it's a node version problem, beacause my app was create on 0.10.44 and meteor 1.2.-. Why you want this?, if you want to uss this, maybe you need to deploy meteor app with direct docker + nginx + passenger.\n. I find a way, but i need some help.\nHow can i reach or use a real network subnet from AWS on my docker, something like a bridge interface?\nI tried to create one, but i can't setting up in docker reboot.. Change node version, use nvm to install version stable or 4.7.2.. > my global node version is and meteor version is 4.7.3\nnpm v4.3.0\nHere is mupx log\nYou are using MUPX, so you need to run with node 0.10.44.-\n. You can setting up the port to use on your mup.js.. ",
    "ifalldev": "'Fixed it'.\nI don't know why but I deployed my app again, and I stopped and started my container manually and it ran ok.\nIts as crazy as it sounds.. Hi @guillim! \nIt wasn't me who created the droplet and it was gave to me with LAMP and a little trouble which was that the DNS pointing to wrong IP.\nLAMP was not a big challenge, I just turned Apache off.\nAbout the DNS it's confusing because I always tested the connection with the URL and IP without success.\nAfter my last test I noticed that accessing IP returned ok, but the URL did not, so I found that the pointing was wrong. \nBut just before I was about to put docker to another port (3000) and use Nginx to link :80 to that, I was just trying to turn the app on anyway.\nSo while doing that I changed the container port from 80->80 to 3000->80 and then put 3000->80 to 80->80 back. I don't know why but when I returned to 80->80, it worked ok.\nI hope this can help you anyway.\n. ",
    "joadr": "any news on this?. ",
    "codingwaysarg": "Same issue here. ",
    "ostrowr": "I'm also running into this issue - also on DigitalOcean. No problem at all when running locally. I don't know if it's a mup problem or if it's somehow related to meteor itself a la https://forums.meteor.com/t/meteor-bundle-on-production-100-cpu/30837\nThis is happening on what should be a mostly idle server with only me connected, so I don't think @SachaG's explanation applies here. . @shadowcodex top says node, and docker stats has the meteor container at 10x% cpu. But I'm not able to replicate right now for some reason - I'll let you know what I can puzzle out if I run into this issue again. . ",
    "achirkof": "For somebody who may also faced same problem:\nIn my case root cause of force redirection from http to https was meteor package force-ssl. I spend a day to find a cause because in development mode it is not appear.. @elie222 same issue. before update to 1.3.7 everything works on 1.3.3. ",
    "FrancisBou": "This is a major problem for me as well, I can imagine it will get worse.\nIt seems /var/lib/docker/aufs is the source of the problem. (Almost 4GB after a month, 2 apps and one MongoDB instance).. This is a highly anticipated feature for me so i'd like to thank @zodern for his great contribution.\nI'm not used to it so pardon me is this isn't the correct place to ask but how would I go about contributing to this project, is there a roadmap somewhere, are you looking for beta testers? . Possible duplicate #692 . ",
    "JoeriSmits": "This is also a problem for me. After running docker ps -s I noticed that abernix/meteord:base is taking up 9.3GB. \nCONTAINER ID        IMAGE                                    COMMAND                  CREATED             STATUS              PORTS                                      NAMES                            SIZE\n0ead512b8c81        jrcs/letsencrypt-nginx-proxy-companion   \"/bin/bash /app/entry\"   27 minutes ago      Up 27 minutes                                                  FA-Dashboard-nginx-letsencrypt   1.261 kB (virtual 70.88 MB)\ne861519d18b2        jwilder/nginx-proxy                      \"/app/docker-entrypoi\"   28 minutes ago      Up 28 minutes       0.0.0.0:80->80/tcp, 0.0.0.0:443->443/tcp   FA-Dashboard-nginx-proxy         5.156 kB (virtual 246.8 MB)\n26d3a227dbb1        abernix/meteord:base                     \"/bin/sh -c 'bash $ME\"   28 minutes ago      Up 28 minutes       80/tcp                                     FA-Dashboard                     9.294 MB (virtual 513 MB)\n2ac5f12c479e        mongo                                    \"/entrypoint.sh mongo\"   11 weeks ago        Up 9 days           127.0.0.1:27017->27017/tcp                 mongodb                          1.932 kB (virtual 401.9 MB). @zodern When I run df -h I get around 9GB for docker/aufs/. When I run mup stop It looks like it does not clear up any space.\ndf -h\nFilesystem      Size  Used Avail Use% Mounted on\nudev            957M     0  957M   0% /dev\ntmpfs           196M   21M  175M  11% /run\n/dev/vda1       9.7G  9.0G  664M  94% /\ntmpfs           977M  412K  976M   1% /dev/shm\ntmpfs           5.0M     0  5.0M   0% /run/lock\ntmpfs           977M     0  977M   0% /sys/fs/cgroup\nshm              64M     0   64M   0% /var/lib/docker/containers/2ac5f12c479e73017fa5d2bf8a198d526097f383efc7f62ae30e657b2cd7ab13/shm\ntmpfs           196M     0  196M   0% /run/user/0\nnone            9.7G  9.0G  664M  94% /var/lib/docker/aufs/mnt/cbae5e59bfb9c2bbe50272b8fb06e1a89d56940cf5288096ed8c9ff48e5b379b\nshm              64M     0   64M   0% /var/lib/docker/containers/26d3a227dbb1fb2232955355aae4200ecdf874ae06d23f382f1826cf7ba2544d/shm\nnone            9.7G  9.0G  664M  94% /var/lib/docker/aufs/mnt/4291a7da6cc7cbf453db76462822ccd4369aa500b049a872f5c7a213543b4c19\nshm              64M     0   64M   0% /var/lib/docker/containers/e861519d18b2bd3727437f5cf303192b1727bb2203b85104abfeff609245d308/shm\nnone            9.7G  9.0G  664M  94% /var/lib/docker/aufs/mnt/09256efc9a8867a6e66bd6b875ce789de36436591f3d6febb534307e6024ee1b\nshm              64M     0   64M   0% /var/lib/docker/containers/0ead512b8c81b20ec3f08fd9a839374e74e9d6389ca16336a332fe70fea078\nWhen I run du -h --max-depth=2 /opt I get:\n20M /opt/FA-Dashboard/tmp\n64K /opt/FA-Dashboard/config\n32K /opt/FA-Dashboard/certs\n149M    /opt/FA-Dashboard/current\n149M    /opt/FA-Dashboard/last\n317M    /opt/FA-Dashboard\n8.0K    /opt/mongodb\n11M /opt/FA_Dashboard/tmp\n12K /opt/FA_Dashboard/config\n11M /opt/FA_Dashboard/current\n21M /opt/FA_Dashboard\n337M    /opt. @artpolikarpov Did this work for you? I already tried to cleanup docker with the link you send me a few hours ago, but was only able to clean about 200MB.\n@gjr-qm Earlier today I tried to deploy a new version of my meteor app to enable autogenerate ssl by letsencrypt but it failed due to not enough space on the disk and did throw the following error:\ndocker: failed to register layer: Error processing tar file(exit status 1): write /lib/x86_64-linux-gnu/libgcrypt.so.20.0.3: no space left on device.\nI'm not that familiar with docker but when I run df -h I see that /var/lib/docker/aufs/ has 9GB used what blocked the deployment I guess.\n. Ok so I completely reinstalled my server and did a mup setup and a mup deploy. /docker/aufs/ now takes up 3.8G. I will keep monitoring if size increased rapidly.. @artpolikarpov Same situation here. +1. This is the result I get when I run the two commands. I just got the following error from mup\nconfig/start.sh: line 73: cannot create temp file for here-document: No space left on device\nSee:\n\n\n. ",
    "indie-it": "hey guys,\nI have the same problem which is a lack of disk space after 2 months of deploying via mup, running on a EC2 instance with 8Go of disk. It was working fine until yesterday...\nI noticed that I have multiple last folders in /opt/[user]/current recursively. This \"pattern\" stops after a depth of 4. The last folder I have is /opt/[user]/current/last/last/last/last and it's always the same structure. It contains : \nbundle/\nbundle.tar.gz\nlast/\nAnd I don't have the lastfolder in /opt/[user]/. It's under the current directory...\nBug, right?. Hi guys,\nI installed from scratch another server (with 10GB of space) and after my first deploy, i had only 49% of free space remaining. After a few days, I did 3 or 4 deploys using the command (on windows using the mup.cmd as recommended) and I noticed that 63% were now used.\nI'm guessing that the issue comes from docker itself : the largest dir on my machine is at /var/lib/docker/aufs and keeps growing... But how can we stop it from growing???\nI executed sudo du -h --max-depth=1 /var/lib/docker/aufs/diff/ and here's the result :\n27M     /var/lib/docker/aufs/diff/77080be32bf15d729e5e1fcee5f6c7e53c3f45fd0f122f63017c54cf12f80883-removing\n28K     /var/lib/docker/aufs/diff/d340cc11c9516761c2b8906c36af2bc643f739ba5cf77444cc6fde341ca2d3fd-init-removing\n28K     /var/lib/docker/aufs/diff/772f5ecb3ae27fbf553d1d895bafcad21a823870f0bccb32ce23fd82290876b8-init-removing\n12K     /var/lib/docker/aufs/diff/d9239304e88593d0b5d500f00755a1e6f92678e60c56be10c70e0af84f067b6a-removing\n4.6M    /var/lib/docker/aufs/diff/a6c28b46c48ef2b55496997c2deec527a9bbac83f2d5bdab409df699ba2b1a16\n135M    /var/lib/docker/aufs/diff/537c08bf157367a95a3cfaa6e2eb34459961b117b5b2b26b473b629b22ca0e98\n294M    /var/lib/docker/aufs/diff/30b27cdbe864d11a0e93ad6a70878be35a19e256596473fa12e58f3b2fb5e730\n112K    /var/lib/docker/aufs/diff/bc9b485be6267f29f592ace74b908b9aee7d078df62eaef66f5334f9562d3e2e\n28K     /var/lib/docker/aufs/diff/bc9b485be6267f29f592ace74b908b9aee7d078df62eaef66f5334f9562d3e2e-init\n44K     /var/lib/docker/aufs/diff/2c0299506161ee9292bff3e65ee70bc36d9a800ef5b3fdfc1e0586faf142df91\n188K    /var/lib/docker/aufs/diff/3b9592ff3d1347aee9d912085ae1385bc739c694c23c36283c325d9651e6a3b2-removing\n240M    /var/lib/docker/aufs/diff/3866f837821a6cba9a43523f8a69bda66050ff4f0c25d64c76cec27bbf2c685e-removing\n240M    /var/lib/docker/aufs/diff/d77b341385c3ec82b76585d9d89e574feeb087773b84891df36e01475bbf9bb9-removing\n135M    /var/lib/docker/aufs/diff/10aab3161ea2bf50ff82867d107fd373a3c7dddc7876e9beb1e945335af1490d\n27M     /var/lib/docker/aufs/diff/328f3c35b665e3cfc47e506bf06e3a11131a8f4445ac53f4e3bd73b18aab6bce-removing\n52K     /var/lib/docker/aufs/diff/d0de2c1d3c19f627c35b6d9e43def8b5e22db7a9db9fc21ba44b32cab30177ad-removing\n40K     /var/lib/docker/aufs/diff/fd24223dde8a8a63b576d68ae6983e3e4b3917e47b4e6d9de86de974e159d8ab-removing\n24K     /var/lib/docker/aufs/diff/e57fdb24678b98a6ed79469efd9e27f7745857d709d7add0d07a97682e047ea5\n40K     /var/lib/docker/aufs/diff/325b269e0baf7feb2a86595cac62fb25a4b823ecbf9979ca103c4b845f3b5565-removing\n240M    /var/lib/docker/aufs/diff/0a158c8bf82760d627b07c77b113d777f44d0a02f72517c3d41bd8e747e9242d-removing\n384K    /var/lib/docker/aufs/diff/d365e242881971496db211a569b671a9b4efe97d53349736b0e50c60791a6ce5\n40K     /var/lib/docker/aufs/diff/772f5ecb3ae27fbf553d1d895bafcad21a823870f0bccb32ce23fd82290876b8-removing\n240M    /var/lib/docker/aufs/diff/052fe1259fafdab67611cbb456f6bcc1d838e124c6c8cfdd971bfb8109354404-removing\n240M    /var/lib/docker/aufs/diff/22ad50eb8de51a669ae3904dcac066203dbc59f976fd3ea410c3f4c2ab588149-removing\n36K     /var/lib/docker/aufs/diff/458295f64bdba64ac96eaae4cdaf20e4b191febdb4e7dfd0a13be24b9ac51726-removing\n137M    /var/lib/docker/aufs/diff/b67b1e8689e825aed51375bb7776bde55cda13e7719da8b381cb62caafedb677\n28K     /var/lib/docker/aufs/diff/1cfa4d06d963280ade2e91bba12210d062640dd017a704fa9ec9bad4054fc044-init-removing\n28K     /var/lib/docker/aufs/diff/d77b341385c3ec82b76585d9d89e574feeb087773b84891df36e01475bbf9bb9-init-removing\n27M     /var/lib/docker/aufs/diff/b4cbf606e29798a6d210063fa039d97c44f6e53901afb2062394ea5fe1a93a60-removing\n27M     /var/lib/docker/aufs/diff/eb348d81c41e63a53a56913370a1c70545c332002bbaeb811e3335550242bbf6-removing\n28K     /var/lib/docker/aufs/diff/d9239304e88593d0b5d500f00755a1e6f92678e60c56be10c70e0af84f067b6a-init-removing\n4.0K    /var/lib/docker/aufs/diff/ecb6cb9ef1d63d89a124299117d0fcf7a7f7be8c93c2a86e0fcc479794f21cdb\n12K     /var/lib/docker/aufs/diff/d3ca70a678bc9c3a55ffb69431e9f360dea2b3f2e0b0c6c5b961151bb689d81b-removing\n28K     /var/lib/docker/aufs/diff/2e5cccc9f3eb3480d58fdfa4d03d68d5a227f3e07fa494a44d4285454d70af1c-init-removing\n12K     /var/lib/docker/aufs/diff/799d898e5e73ca02b1690fadc8143f60d9f581d7924207d528ecca6674742baa-removing\n16K     /var/lib/docker/aufs/diff/f7a91400f51c78ce2f601fa6028a2c2545e1fb4d9b6b44593d0ddf04ce48d55c-removing\n48K     /var/lib/docker/aufs/diff/1cfa4d06d963280ade2e91bba12210d062640dd017a704fa9ec9bad4054fc044-removing\n28K     /var/lib/docker/aufs/diff/328f3c35b665e3cfc47e506bf06e3a11131a8f4445ac53f4e3bd73b18aab6bce-init-removing\n28K     /var/lib/docker/aufs/diff/458295f64bdba64ac96eaae4cdaf20e4b191febdb4e7dfd0a13be24b9ac51726-init-removing\n27M     /var/lib/docker/aufs/diff/e26a5a8c8a29bbf32d17ca2d472fae6011b954c5f0aad299ff81bcef1932d698-removing\n28K     /var/lib/docker/aufs/diff/54d8d177b105b44fb1a4dae1c2e264abf0d63fc95fe125d90cb23a49f4b4a12a-init\n12K     /var/lib/docker/aufs/diff/76fe3e78ffb0cef22e1fd3fd28cb754235721ebd0cc08b4f2dd6f075e7b62c95-removing\n28K     /var/lib/docker/aufs/diff/e8f3c58139061bde3c592f11328d3ea7f8d96203e1c342a8782d6b4b199f86c9-init-removing\n240M    /var/lib/docker/aufs/diff/ffc0d1dc280b2cbf2b037f19e36b45ee65f2f88bb77436787f87d763ae4ce828-removing\n27M     /var/lib/docker/aufs/diff/82b74fd5f4c3432fd8e38673fbc63d64d747070d1015481b9e8500c0865351a5-removing\n16K     /var/lib/docker/aufs/diff/bc843335503417813a4180815205cdf7b92584e695a03f6cee8182e2317175ac\n32K     /var/lib/docker/aufs/diff/d2d2981ef8b9220b3d207cb98caccad3a393adf9030f6a07768f9341423b5712\n28K     /var/lib/docker/aufs/diff/3866f837821a6cba9a43523f8a69bda66050ff4f0c25d64c76cec27bbf2c685e-init-removing\n8.0K    /var/lib/docker/aufs/diff/9baa0f11e216b2713df99b38dc869d9457a6c5b82f421a41209f57fe160d6e07\n4.0K    /var/lib/docker/aufs/diff/beafc314a2ddfd078539195a51d9dbbb532f037d8a9a2dbfa8ed28424374c86d\n28K     /var/lib/docker/aufs/diff/d3ca70a678bc9c3a55ffb69431e9f360dea2b3f2e0b0c6c5b961151bb689d81b-init-removing\n28K     /var/lib/docker/aufs/diff/eb348d81c41e63a53a56913370a1c70545c332002bbaeb811e3335550242bbf6-init-removing\n16K     /var/lib/docker/aufs/diff/54d8d177b105b44fb1a4dae1c2e264abf0d63fc95fe125d90cb23a49f4b4a12a\n12K     /var/lib/docker/aufs/diff/2e5cccc9f3eb3480d58fdfa4d03d68d5a227f3e07fa494a44d4285454d70af1c-removing\n28K     /var/lib/docker/aufs/diff/3b9592ff3d1347aee9d912085ae1385bc739c694c23c36283c325d9651e6a3b2-init-removing\n27M     /var/lib/docker/aufs/diff/7d33219a84a5e905dba2a807c1eb640d33317c4e7987220cf84d6285bca98bb8-removing\n28K     /var/lib/docker/aufs/diff/d0de2c1d3c19f627c35b6d9e43def8b5e22db7a9db9fc21ba44b32cab30177ad-init-removing\n28K     /var/lib/docker/aufs/diff/0a158c8bf82760d627b07c77b113d777f44d0a02f72517c3d41bd8e747e9242d-init-removing\n12K     /var/lib/docker/aufs/diff/58d31cbcd219d429b80bd2adb83615af520e9404b8c5a34024906703780c0b9e-removing\n28K     /var/lib/docker/aufs/diff/77080be32bf15d729e5e1fcee5f6c7e53c3f45fd0f122f63017c54cf12f80883-init-removing\n28K     /var/lib/docker/aufs/diff/76fe3e78ffb0cef22e1fd3fd28cb754235721ebd0cc08b4f2dd6f075e7b62c95-init-removing\n12K     /var/lib/docker/aufs/diff/665980cb877c306894b642d95aa770184fb88bfbfcc088f696f8156bdb3aa417\n8.0K    /var/lib/docker/aufs/diff/623b9b82e317a0d962e999ebab6047acc1f0bb3db28507e842d240c42d8d8216\n28K     /var/lib/docker/aufs/diff/7d33219a84a5e905dba2a807c1eb640d33317c4e7987220cf84d6285bca98bb8-init-removing\n20K     /var/lib/docker/aufs/diff/f0eb70bb717c19611235bcc6525eef70e0f0d3c0b200c5acaf754f9287e92114\n12K     /var/lib/docker/aufs/diff/28540432c75a39732e2723743a0e3543777bde242516179950b50d21642256ba\n262M    /var/lib/docker/aufs/diff/9de2c4c1549f955dcce46cff4280800a7f2394699e7acbed49cf922853c2db3d\n12K     /var/lib/docker/aufs/diff/a9cfcab34b630bf304868d9a784ba93b5f6c9639bf51fbde451ab023a3c705c4\n28K     /var/lib/docker/aufs/diff/22ad50eb8de51a669ae3904dcac066203dbc59f976fd3ea410c3f4c2ab588149-init-removing\n28K     /var/lib/docker/aufs/diff/8c5299d87c4bd6333e39a7fd50878a03e3d71f72755156be672d397e16430370-init-removing\n12K     /var/lib/docker/aufs/diff/e8f3c58139061bde3c592f11328d3ea7f8d96203e1c342a8782d6b4b199f86c9-removing\n51M     /var/lib/docker/aufs/diff/1db4b08d976e8ed605f1f38ff2f0acc28c55c0616e9718b36764d16746411911\n28K     /var/lib/docker/aufs/diff/f7a91400f51c78ce2f601fa6028a2c2545e1fb4d9b6b44593d0ddf04ce48d55c-init-removing\n4.0K    /var/lib/docker/aufs/diff/2b3312d4d204f5c296a8cf3990f91dd48f08c01d3822d4520c94697e9394262a-removing\n240M    /var/lib/docker/aufs/diff/d340cc11c9516761c2b8906c36af2bc643f739ba5cf77444cc6fde341ca2d3fd-removing\n628K    /var/lib/docker/aufs/diff/0b18029b6ea0160211896535af047f8a83ddbb70013206658be86ad25bc5677b\n28K     /var/lib/docker/aufs/diff/b401dfccc3ce1efc95fb2b9c335fb063b34299df6b418e62ad06dc748e5c7ffd-init-removing\n240M    /var/lib/docker/aufs/diff/ad08e5ad6dd99f51ba4c6c4ac0ab26d3951de8be107b391c06c53338f3cb0edf-removing\n8.0K    /var/lib/docker/aufs/diff/d19be9d3461a91b61a74616be1ac11b379af29c340d08125ea305cfaa8470dbb\n240M    /var/lib/docker/aufs/diff/1c672dc107b6b3e43d218dca8a5830d634593c11c026298e480400afd08ea212-removing\n12K     /var/lib/docker/aufs/diff/4e1f264f42b73db7dd2b63360ed0502f4984898ea7a998ddb25eac89d22c594b-removing\n28K     /var/lib/docker/aufs/diff/445cd44f56fece75d3700395609042eee8f819c5e9f987e2c6ec6e646185e6d7-init-removing\n27M     /var/lib/docker/aufs/diff/b422c58eb17307896200b8778463a92570498644f9a30ed451b55b776da60d7e-removing\n110M    /var/lib/docker/aufs/diff/7387fbe20871b6a01346a2abcf8f8a6ea8eaf23373056acd6d771cde532bba0f-removing\n28K     /var/lib/docker/aufs/diff/3853bddbaf2e6918793c51acd96e8c5e039a9e1314c79ba17d3e6fb36f572faa-init-removing\n12K     /var/lib/docker/aufs/diff/b401dfccc3ce1efc95fb2b9c335fb063b34299df6b418e62ad06dc748e5c7ffd-removing\n40K     /var/lib/docker/aufs/diff/445cd44f56fece75d3700395609042eee8f819c5e9f987e2c6ec6e646185e6d7-removing\n77M     /var/lib/docker/aufs/diff/45d489b65bfe7221bd8d60008f0a9ebcfa6de71f0f15ecb5e43fd34e6860eb01\n20K     /var/lib/docker/aufs/diff/2fe99084f816f222d098178d234377f3a6ab1f9a51a7f1360b9e17a6b046b222\n28K     /var/lib/docker/aufs/diff/325b269e0baf7feb2a86595cac62fb25a4b823ecbf9979ca103c4b845f3b5565-init-removing\n28K     /var/lib/docker/aufs/diff/28540432c75a39732e2723743a0e3543777bde242516179950b50d21642256ba-init\n40K     /var/lib/docker/aufs/diff/3853bddbaf2e6918793c51acd96e8c5e039a9e1314c79ba17d3e6fb36f572faa-removing\n240M    /var/lib/docker/aufs/diff/224ad68522c7b79a00ff8c9a3209075f7175b300517c4b4706a1996060417338\n12K     /var/lib/docker/aufs/diff/8c5299d87c4bd6333e39a7fd50878a03e3d71f72755156be672d397e16430370-removing\n28K     /var/lib/docker/aufs/diff/799d898e5e73ca02b1690fadc8143f60d9f581d7924207d528ecca6674742baa-init-removing\n27M     /var/lib/docker/aufs/diff/245e6ae2d039a25b629da66dabad219e0d714813b823c44cb136d22f3acf09eb\n28K     /var/lib/docker/aufs/diff/82b74fd5f4c3432fd8e38673fbc63d64d747070d1015481b9e8500c0865351a5-init-removing\n28K     /var/lib/docker/aufs/diff/58d31cbcd219d429b80bd2adb83615af520e9404b8c5a34024906703780c0b9e-init-removing\n77M     /var/lib/docker/aufs/diff/d584d0bf77b07aa919fdbfc69b01389644e3411d6daa424dc685f5a0f4671ebe\n32K     /var/lib/docker/aufs/diff/f742c9f96fd87a2c30c8b8f816d98af7410f6fd2521266bee4bead1e79c35daa\n27M     /var/lib/docker/aufs/diff/67eb160fd5059378a2e94722265346ec49d67baa37ef6917863f98e28522eb1f-removing\n28K     /var/lib/docker/aufs/diff/4e1f264f42b73db7dd2b63360ed0502f4984898ea7a998ddb25eac89d22c594b-init-removing\n28K     /var/lib/docker/aufs/diff/fd24223dde8a8a63b576d68ae6983e3e4b3917e47b4e6d9de86de974e159d8ab-init-removing\n3.9G    /var/lib/docker/aufs/diff/\nI tried the new version of mup (1.3) with the plugin and it's great, but it's not freeing much space... I don't know what to do because in a month I won't have any free space anymore on my machine... . After upgrading to docker 17.07.0-ce today, my disk is now used at 38%!\nDocker was still using 5+GB yesterday (all of it in /var/lib/aufs/), and now it's 'only' taking 2.7GB! Win! \\o/. ",
    "derouck": "After updating to the latest docker version the problem will probably be solved by calling\ndocker system prune -af. You will need to ssh into the server to update docker.\nhttps://askubuntu.com/questions/472412/how-do-i-upgrade-docker. I encountered the same problem. It turned out there were plenty of diff dirs under /var/lib/docker/aufs/diff\nIt was a problem in docker itself that the docker prune command did not clean enough. After updating to  docker 17.10.0-ce the problem was resolved by doing the prune command.\ndocker system prune -af. Funny, I just had the same problem. I managed to fix it by doing a server reboot. Does that help?. ",
    "chackerian": "I don't really know which of these steps solved the problem but I ran df -h, Isolated a folder with large files (not sure what they were for) deleted all of them. Ran mup docker setup and mup reconfig. Then when I deployed I didn't run into any issues. I guess the files weren't needed or mup recreated them or something.. That fixed it. Thanks.. ",
    "anshul-budhiraja": "I have already resolved my issue. Thanks for the response.. ",
    "wiserweb": "This project is not dead. It works quite well. It just needs a new maintainer.. ",
    "distalx": "Thanks @zodern for taking over,  can this be closed?. ",
    "nosleepfilipe": "Hey @bensventures i have exactly the same issue, can you explain me how can i change that?\nhow can i change that in the server? I'm using digital ocean for the hosting.. just change the file but now im getting another error.\n``\nnpm WARN deprecated This version of npm lacks support for important features,\nnpm WARN deprecated such as scoped packages, offered by the primary npm\nnpm WARN deprecated registry. Consider upgrading to at least npm@2, if not the\nnpm WARN deprecated latest stable version. To upgrade to npm@2, run:\nnpm WARN deprecated\nnpm WARN deprecated   npm -g install npm@latest-2\nnpm WARN deprecated\nnpm WARN deprecated To upgrade to the latest stable version, run:\nnpm WARN deprecated\nnpm WARN deprecated   npm -g install npm@latest\nnpm WARN deprecated\nnpm WARN deprecated (Depending on how Node.js was installed on your system, you\nnpm WARN deprecated may need to prefix the preceding commands withsudo, or if\nnpm WARN deprecated on Windows, run them from an Administrator prompt.)\nnpm WARN deprecated\nnpm WARN deprecated If you're running the version of npm bundled with\nnpm WARN deprecated Node.js 0.10 LTS, be aware that the next version of 0.10 LTS\nnpm WARN deprecated will be bundled with a version of npm@2, which has some small\nnpm WARN deprecated backwards-incompatible changes made tonpm run-script` and\nnpm WARN deprecated semver behavior.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No description\nnpm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No README data\n/bundle/bundle/programs/server/node_modules/fibers/future.js:278\n                        throw(ex);\n                              ^\nError: failed to connect to [mongodb:27017]\n    at Object.Future.wait (/bundle/bundle/programs/server/node_modules/fibers/future.js:398:15)\n    at new MongoConnection (packages/mongo/mongo_driver.js:213:1)\n    at new MongoInternals.RemoteCollectionDriver (packages/mongo/remote_collection_driver.js:4:1)\n    at Object. (packages/mongo/remote_collection_driver.js:38:1)\n    at Object.defaultRemoteCollectionDriver (packages/underscore/underscore.js:750:1)\n    at new Mongo.Collection (packages/mongo/collection.js:98:1)\n    at packages/accounts-base/accounts_common.js:141:1\n    at /bundle/bundle/programs/server/packages/accounts-base.js:243:4\n    at /bundle/bundle/programs/server/packages/accounts-base.js:1659:3\n    at /bundle/bundle/programs/server/boot.js:222:10\n    - - - - -\n    at [object Object]. (/bundle/bundle/programs/server/npm/mongo/node_modules/mongodb/lib/mongodb/connection/server.js:555:74)\n    at [object Object].emit (events.js:106:17)\n    at [object Object]. (/bundle/bundle/programs/server/npm/mongo/node_modules/mongodb/lib/mongodb/connection/connection_pool.js:156:15)\n    at [object Object].emit (events.js:98:17)\n    at Socket. (/bundle/bundle/programs/server/npm/mongo/node_modules/mongodb/lib/mongodb/connection/connection.js:534:10)\n    at Socket.emit (events.js:95:17)\n    at net.js:441:14\n    at process._tickCallback (node.js:458:13)\n```\nthis is my config\n```\n...\n meteor: {\n    name: 'elyweddingsDocker',\n    path: '/Users/nosleepfilipe/repo/com.elyweddings',\n    port:3000,\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      //serverOnly: true,\n      cleanAfterBuild: true, // default\n    },\n    env: {\n      ROOT_URL: 'http://elyweddings.com',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n//dockerImage: 'kadirahq/meteord'\ndeployCheckWaitTime: 10\n\n},\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n```\nthis is the containers on the server \nroot@elyweddings:~# docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                               PORTS                        NAMES\n7f25469aae7f        kadirahq/meteord    \"/bin/sh -c 'bash $ME\"   3 minutes ago       Restarting (8) About a minute ago    0.0.0.0:80->80/tcp           elyweddingsDocker\n3d180924c99b        mongo:3.2.11        \"/entrypoint.sh mongo\"   5 minutes ago       Restarting (14) About a minute ago   127.0.0.1:27017->27017/tcp   mongodb\nthanks for the help. still getting the same error\n[139.59.153.120]\n[139.59.153.120]/bundle/bundle/programs/server/node_modules/fibers/future.js:278\n[139.59.153.120]                        throw(ex);\n[139.59.153.120]                              ^\n[139.59.153.120]Error: failed to connect to [mongodb:27017]\n[139.59.153.120]    at Object.Future.wait (/bundle/bundle/programs/server/node_modules/fibers/future.js:398:15)\n[139.59.153.120]    at new MongoConnection (packages/mongo/mongo_driver.js:213:1)\n[139.59.153.120]    at new MongoInternals.RemoteCollectionDriver (packages/mongo/remote_collection_driver.js:4:1)\n[139.59.153.120]    at Object.<anonymous> (packages/mongo/remote_collection_driver.js:38:1)\n[139.59.153.120]    at Object.defaultRemoteCollectionDriver (packages/underscore/underscore.js:750:1)\n[139.59.153.120]    at new Mongo.Collection (packages/mongo/collection.js:98:1)\n[139.59.153.120]    at packages/accounts-base/accounts_common.js:141:1\n[139.59.153.120]    at /bundle/bundle/programs/server/packages/accounts-base.js:243:4\n[139.59.153.120]    at /bundle/bundle/programs/server/packages/accounts-base.js:1659:3\n[139.59.153.120]    at /bundle/bundle/programs/server/boot.js:222:10\n[139.59.153.120]    - - - - -\n[139.59.153.120]    at [object Object].<anonymous> (/bundle/bundle/programs/server/npm/mongo/node_modules/mongodb/lib/mongodb/connection/server.js:555:74)\n[139.59.153.120]    at [object Object].emit (events.js:106:17)\n[139.59.153.120]    at [object Object].<anonymous> (/bundle/bundle/programs/server/npm/mongo/node_modules/mongodb/lib/mongodb/connection/connection_pool.js:156:15)\n[139.59.153.120]    at [object Object].emit (events.js:98:17)\n[139.59.153.120]    at Socket.<anonymous> (/bundle/bundle/programs/server/npm/mongo/node_modules/mongodb/lib/mongodb/connection/connection.js:534:10)\n[139.59.153.120]    at Socket.emit (events.js:95:17)\n[139.59.153.120]    at net.js:441:14\n[139.59.153.120]    at process._tickCallback (node.js:458:13)\n[139.59.153.120]npm WARN deprecated This version of npm lacks support for important features,\n[139.59.153.120]npm WARN deprecated such as scoped packages, offered by the primary npm\n[139.59.153.120]npm WARN deprecated registry. Consider upgrading to at least npm@2, if not the\n[139.59.153.120]npm WARN deprecated latest stable version. To upgrade to npm@2, run:\n[139.59.153.120]npm WARN deprecated\n[139.59.153.120]npm WARN deprecated   npm -g install npm@latest-2\n[139.59.153.120]npm WARN deprecated\n[139.59.153.120]npm WARN deprecated To upgrade to the latest stable version, run:\n[139.59.153.120]npm WARN deprecated\n[139.59.153.120]npm WARN deprecated   npm -g install npm@latest\n[139.59.153.120]npm WARN deprecated\n[139.59.153.120]npm WARN deprecated (Depending on how Node.js was installed on your system, you\n[139.59.153.120]npm WARN deprecated may need to prefix the preceding commands with `sudo`, or if\n[139.59.153.120]npm WARN deprecated on Windows, run them from an Administrator prompt.)\n[139.59.153.120]npm WARN deprecated\n[139.59.153.120]npm WARN deprecated If you're running the version of npm bundled with\n[139.59.153.120]npm WARN deprecated Node.js 0.10 LTS, be aware that the next version of 0.10 LTS\n[139.59.153.120]npm WARN deprecated will be bundled with a version of npm@2, which has some small\n[139.59.153.120]npm WARN deprecated backwards-incompatible changes made to `npm run-script` and\n[139.59.153.120]npm WARN deprecated semver behavior.\n[139.59.153.120]npm WARN package.json meteor-dev-bundle@0.0.0 No description\n[139.59.153.120]npm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\n[139.59.153.120]npm WARN package.json meteor-dev-bundle@0.0.0 No README data\n[139.59.153.120]=> Starting meteor app on port:80\nthis is my config now\nmodule.exports = {\n  servers: {\n    one: {\n      host: '*******',\n      username: '*******',\n      //pem: '~/.ssh/id_rsa.pub'\n      // pem:\n      password:'*******',\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\n  meteor: {\n     name: 'elyweddingsDocker',\n     path: '/Users/nosleepfilipe/repo/com.elyweddings',\n     port: 3000,\n     docker: {\n         image: 'kadirahq/meteord' // meteord image comaptible with 1.4.x\n     },\n     servers: {\n         one: {}\n     },\n     env: {\n         PORT: \"3000\",\n         ROOT_URL: 'http://elyweddings.com',\n     },\n     enableUploadProgressBar: true,\n     deployCheckWaitTime: 60\n },\n mongo: {\n     oplog: true,\n     port: 27017,\n     servers: {\n         one: {}\n     }\n },\n};. Stoped all the containers and delete all the images and containers from the server.\nstop my local mongoDb service\nthis is my mongo-start.sh\n(nosleepfilipe in ~/.npm-packages/lib/node_modules/mup/lib/modules/mongo/assets/mongo-start.sh)\n```\n!/bin/bash\nset -e\nwe use this data directory for the backward compatibility\nolder mup uses mongodb from apt-get and they used this data directory\nsudo mkdir -p /var/lib/mongodb\nsudo docker pull mongo:3.2.11\nset +e\nsudo docker rm -f mongodb\nset -e\nsudo docker run \\\n  -d \\\n  --restart=always \\\n  --publish=127.0.0.1:27017:27017 \\\n  --volume=/var/lib/mongodb:/data/db \\\n  --volume=/opt/mongodb/mongodb.conf:/mongodb.conf \\\n  --name=mongodb \\\n  mongo:3.2.11 mongod -f /mongodb.conf\n```\ni have done the setup and deploy again.\nthis is the mup.json\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '139.59.153.120',\n      username: '*',\n      //pem: '~/.ssh/id_rsa.pub'\n      // pem:\n      password:'*',\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\n  meteor: {\n     name: 'elyweddingsDocker',\n     path: '/Users/nosleepfilipe/repo/com.elyweddings',\n     port: 3000,\n     docker: {\n         image: 'kadirahq/meteord' // meteord image comaptible with 1.4.x\n     },\n     servers: {\n         one: {}\n     },\n     env: {\n         PORT: \"3000\",\n         ROOT_URL: 'http://elyweddings.com',\n     },\n     enableUploadProgressBar: true,\n     deployCheckWaitTime: 60\n },\n mongo: {\n     oplog: true,\n     port: 27017,\n     servers: {\n         one: {}\n     }\n },\n};\n```\nthis is the containers\nroot@elyweddings:~# docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                          PORTS                        NAMES\nb643e6bece50        kadirahq/meteord    \"/bin/sh -c 'bash $ME\"   54 seconds ago      Restarting (8) 7 seconds ago    0.0.0.0:3000->80/tcp         elyweddingsDocker\n97d6ae011a11        mongo:3.2.11        \"/entrypoint.sh mongo\"   3 minutes ago       Restarting (14) 3 seconds ago   127.0.0.1:27017->27017/tcp   mongodb\nthis is the images\nroot@elyweddings:~# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nmongo               3.2.11              c5185a594064        2 weeks ago         342.7 MB\nkadirahq/meteord    latest              807754a01782        4 months ago        330.7 MB\nthis is the error\n``\nnpm WARN deprecated This version of npm lacks support for important features,\nnpm WARN deprecated such as scoped packages, offered by the primary npm\nnpm WARN deprecated registry. Consider upgrading to at least npm@2, if not the\nnpm WARN deprecated latest stable version. To upgrade to npm@2, run:\nnpm WARN deprecated\nnpm WARN deprecated   npm -g install npm@latest-2\nnpm WARN deprecated\nnpm WARN deprecated To upgrade to the latest stable version, run:\nnpm WARN deprecated\nnpm WARN deprecated   npm -g install npm@latest\nnpm WARN deprecated\nnpm WARN deprecated (Depending on how Node.js was installed on your system, you\nnpm WARN deprecated may need to prefix the preceding commands withsudo, or if\nnpm WARN deprecated on Windows, run them from an Administrator prompt.)\nnpm WARN deprecated\nnpm WARN deprecated If you're running the version of npm bundled with\nnpm WARN deprecated Node.js 0.10 LTS, be aware that the next version of 0.10 LTS\nnpm WARN deprecated will be bundled with a version of npm@2, which has some small\nnpm WARN deprecated backwards-incompatible changes made tonpm run-script` and\nnpm WARN deprecated semver behavior.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No description\nnpm WARN package.json meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN package.json meteor-dev-bundle@0.0.0 No README data\n/bundle/bundle/programs/server/node_modules/fibers/future.js:278\n                        throw(ex);\n                              ^\nError: failed to connect to [mongodb:27017]\n    at Object.Future.wait (/bundle/bundle/programs/server/node_modules/fibers/future.js:398:15)\n    at new MongoConnection (packages/mongo/mongo_driver.js:213:1)\n    at new MongoInternals.RemoteCollectionDriver (packages/mongo/remote_collection_driver.js:4:1)\n    at Object. (packages/mongo/remote_collection_driver.js:38:1)\n    at Object.defaultRemoteCollectionDriver (packages/underscore/underscore.js:750:1)\n    at new Mongo.Collection (packages/mongo/collection.js:98:1)\n    at packages/accounts-base/accounts_common.js:141:1\n    at /bundle/bundle/programs/server/packages/accounts-base.js:243:4\n    at /bundle/bundle/programs/server/packages/accounts-base.js:1659:3\n    at /bundle/bundle/programs/server/boot.js:222:10\n    - - - - -\n    at [object Object]. (/bundle/bundle/programs/server/npm/mongo/node_modules/mongodb/lib/mongodb/connection/server.js:555:74)\n    at [object Object].emit (events.js:106:17)\n    at [object Object]. (/bundle/bundle/programs/server/npm/mongo/node_modules/mongodb/lib/mongodb/connection/connection_pool.js:156:15)\n    at [object Object].emit (events.js:98:17)\n    at Socket. (/bundle/bundle/programs/server/npm/mongo/node_modules/mongodb/lib/mongodb/connection/connection.js:534:10)\n    at Socket.emit (events.js:95:17)\n    at net.js:441:14\n    at process._tickCallback (node.js:458:13)\n```\n. hey @bensventures just to let you know, i have delete the droplet and created a new one and now everything is working perfectly. thanks for your help =)\nand Happy news years . ",
    "kenshinman": "@albertonaperijr Thanks. So, how will I reference this location from within my deployed app. Thanks. Sorry for the funny questions, I'm actually new to this \ud83d\udc4d . Hi, all a kinda new issue here I have deployed the app and from the logs\n$ mup deploy --config mup-config.js\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor\n[138.197.79.81] - Pushing Meteor App Bundle to The Server\n[138.197.79.81] - Pushing Meteor App Bundle to The Server: SUCCESS\n[138.197.79.81] - Pushing the Startup Script\n[138.197.79.81] - Pushing the Startup Script: SUCCESS\nHere is my mup.-config.js file\n`module.exports = {\n    servers: {\n        one: {\n            \"host\": \"138.197.79.81\",\n            \"username\": 'root',\n            \"pem\": \"C:/Users/KenshinMan.DESKTOP-PU4PNV5/.ssh/id_rsa\",\n            opts: {\n                port: 22,\n            },\n            // password:\n            // or leave blank for authenticate from ssh-agent\n        }\n    },\nmeteor: {\n    name: 'sesewa',\n    path: 'C:/projects/meteor/sesewa',\n    volumes: { // lets you add docker volumes (optional)\n        \"/var/uploads\": \"/var/uploads\", // passed as '-v /host/path:/container/path' to the docker run command\n        //\"/second/host/path\": \"/second/container/path\"\n    },\n    docker: {\n        //image: 'kadirahq/meteord', // (optional)\n        image: 'abernix/meteord:base', // use this image if using Meteor 1.4+\n    },\n    servers: {\n        one: {}\n    },\n    buildOptions: {\n        serverOnly: true,\n    },\n    env: {\n        \"PORT\": 22,\n        \"ROOT_URL\": \"http://138.197.79.81/\"\n    },\n\n    //dockerImage: 'kadirahq/meteord'\n    deployCheckWaitTime: 60\n}\n\n};`\nit shows that deployment was successful, but when i visit the IP address, the app does not load. Just like there was no deployment. any suggestions on how to make it work?\nLike I mentioned earlier, I used mupx before now and it worked. @albertonaperijr same thing after i tried this. I guess it's because I'm using meteor 1.4.2.3,\nLet me revert to 1.3.5.1 if it will work. Thanks. Hi, @albertonaperijr . I have edited the mup file as suggested and the same issue persists. I really need a way to store images that don't get deleted after every deployment. For now I'm using mupx which is not a useful for creating volumes. here is my current mup-config.js file:\n`module.exports = {\n    servers: {\n        one: {\n            \"host\": \"159.203.91.134\",\n            \"username\": 'root',\n            \"pem\": \"C:/Users/KenshinMan.DESKTOP-PU4PNV5/.ssh/id_rsa\",\n            opts: {\n                port: 22,\n            },\n            // password:\n            // or leave blank for authenticate from ssh-agent\n        }\n    },\nmeteor: {\n    name: 'sesewa',\n    path: 'C:/projects/meteor/sesewa',\n    volumes: { // lets you add docker volumes (optional)\n        \"/data/uploads\": \"/uploads\", // passed as '-v /host/path:/container/path' to the docker run command\n        //\"/second/host/path\": \"/second/container/path\"\n    },\n    docker: {\n        image: 'kadirahq/meteord', // (optional)\n        //image: 'abernix/meteord:base', // use this image if using Meteor 1.4+\n    },\n    servers: {\n        one: {}\n    },\n    env: {\n        \"PORT\": 80,\n        \"ROOT_URL\": \"http://159.203.91.134/\"\n    },\n\n    //dockerImage: 'kadirahq/meteord'\n    deployCheckWaitTime: 60\n},\nbuildOptions: {\n  //serverOnly: false,\n  debug: true,\n  cleanAfterBuild: true\n}\n\n};`\nThis i s the upload log \n` For setup I ran..\nmup --config mup-config.js setup\nStarted TaskList: Setup Docker\n[159.203.91.134] - setup docker\n[159.203.91.134] - setup docker: SUCCESS\nStarted TaskList: Setup Meteor\n[159.203.91.134] - Setup Environment\n[159.203.91.134] - Setup Environment: SUCCESS\nand for deploy i ran \n mup --config mup-config.js deploy\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor\n[159.203.91.134] - Pushing Meteor App Bundle to The Server\n[159.203.91.134] - Pushing Meteor App Bundle to The Server: SUCCESS\n[159.203.91.134] - Pushing the Startup Script\n[159.203.91.134] - Pushing the Startup Script: SUCCESS`\nAll seems to be successful but when I check the app using the IP address, it doesn't show.\nWhen I run docker ps, there is no docker container on the server. is there something wrong with my deployment script or something else is wrong somewhere?\nThanks. Have you found a way yo solve this. Have same issue. Hi @davinderkumar , what fork of spiderable are you using.\nI have same problem. ",
    "gargighorai": "how to correct  write access. ",
    "kaamodt": "@zodern No, I did not. For now I have given up and I am still doing manual deploys from my local environment. Have you encountered a simular issue?. If I understand you correctly I need to install meteor in the pipeline (bitbucket) in order to deploy a Meteor app?. Ok. I will try that out when I am front of my computer and report back.. @zodern Installing meteor as part of the pipeline did the trick :) Thanks for your help. This is the new pipeline for Bitbucket that I have working now\n```image: kadirahq/meteord\npipelines:\n  default:\n    - step:\n        script: # Modify the commands below to build your repository.\n          - mkdir -p ~/.ssh\n          - curl https://install.meteor.com/ | sh\n          - export METEOR_ALLOW_SUPERUSER=true\n          - cd .deploy\n          - cat my_known_hosts >> ~/.ssh/known_hosts\n          - cat id_rsa.pub >> ~/.ssh/id_rsa.pub\n          - (umask 077; echo $SSH_KEY | base64 --decode > ~/.ssh/id_rsa)\n          - npm install -g mup@1.0.4\n          - npm install -g ssh2\n          - mup deploy\n```\nAs you can see I had to install meteor as well as setting the METEOR_ALLOW_SUPERUSER env var. It turns out I had thought of installing meteor earlier. A detail that I had not included in my original issue were which Docker image I based my pipeline from. It is the 'kadirahq/meteord'. It has been awhile, so I had forgotten. Where I failed was assuming that the 'meteor' command is available (by default) inside that Docker image. \nAs for your last comment. Yes, a better error message/validation of requirements would be appreciated! I am not sure if deploying with mup from a CI (or CDelivery pipeline as I would call it :)) is \"best practice\" or not. I was familiar with the tool, so I thought it easiest just to continue using it from the Bitbucket pipeline as well. I would expect there to be differences when deploying from other CD pipelines out there.\nThanks again for your help. This issue can be closed. . Thanks @SimonatoLucaManuele, but I was able to solve this earlier on :) I had not put the installment of Meteor as part of the pipeline steps and the error message was not really helping me understand that.. It has been awhile since I worked with this, but what type of credentials you need depends on the server you are trying to deploy to. Typically, this will be a SSH key pair. \nFor mup there is configuration for what type of credentials you need to accessing the target server. If you look at my script above I have three lines for making the SSH key pair available for the deploy pipeline.\n``\n- cat my_known_hosts >> ~/.ssh/known_hosts\n- cat id_rsa.pub >> ~/.ssh/id_rsa.pub\n- (umask 077; echo $SSH_KEY | base64 --decode > ~/.ssh/id_rsa)\n```` \nwhere themy_known_hostsand theid_rsa.pubis part of the code base, while the private key is stored in the Bitbucket variableSSH_KEY`. Not sure if this is the best way of doing this, but it worked for me at least (and I think it is secure?). \nRegards, \nKjetil. ",
    "SimonatoLucaManuele": "I would share with you this docker and pipelines that works for me.\nMeteor installation and mup installation are set inside Dockerfile. I'm not a pro in docker so feel free to try and modify it.\nDocker - simonatoluca/bitbucket-pipelines-mup - link\nPipelines\n````\nimage: simonatoluca/bitbucket-pipelines-mup\npipelines:\n  default:\n    - step:\n        script:\n          - rm -r node_modules\n          - meteor npm install\n          - cd .deploy\n          - export METEOR_ALLOW_SUPERUSER=true\n          - mup deploy\n````\nI hope this will help in future.. @brianlukoff I try to use pipelines ssh key but without success. I've to redeploy the previous version! I'm going to do it today!. thank you @brianlukoff! So i can try to copy them in a more accessible folder.. ~/ssh/id_rsa maybe?. ",
    "brianlukoff": "@SimonatoLucaManuele Are you using BitBucket Pipeline's stored SSH keys? When I try to do that I get the following from running mup in a BitBucket pipeline:\nerror: server worker doesn't have password, ssh-agent or pem. @kaamodt @SimonatoLucaManuele BitBucket now has a built-in feature for storing an SSH key that is automatically added to images used for pipelines. I was finally able to determine that the private key is placed at /opt/atlassian/pipelines/agent/data/id_rsa, so setting pem to that file let me get mup deployments working.. ",
    "fideo": "Thanks muscaiu. it\u00b4s work for me. Regards.. ",
    "fishdude": "Hey @hems i'm getting the same \"silent fail\" behavior, very frustrating... Did you get anywhere with this?. ",
    "goquiet": "+1\nthe same! what are possible solution guys?. ",
    "danielbressan": "Anyone find a fix for this? I too am just moving from mupx. I copied and pasted a lot of the config, but I think I got everything. I'm not able to use a clean server right now....\nubuntu@ip-172-31-11-0:~/mercury-dev/.deploy$ mup logs -f\nubuntu@ip-172-31-11-0:~/mercury-dev/.deploy$ DEBUG=* mup setup\n  mup:module:default exec => mup setup +0ms\n  mup:module:docker exec => mup docker setup +15ms\nubuntu@ip-172-31-11-0:~/mercury-dev/.deploy$ docker ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\nubuntu@ip-172-31-11-0:~/mercury-dev/.deploy$ DEBUG=* mup deploy\n  mup:module:default exec => mup deploy +0ms\n  mup:module:meteor exec => mup meteor deploy +1ms\n  mup:module:meteor exec => mup meteor push +15ms\nBuilding App Bundle Locally\nubuntu@ip-172-31-11-0:~/mercury-dev/.deploy$ docker ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\nMy mup.js looks like:\n```\nmodule.exports = {\n    servers: {\n        one: {\n            host: \"xx.x.xxx.xx\",\n            username: \"ubuntu\",\n            pem: \"~/dev.pem\"\n        }\n    },\nmeteor: {\n    name: 'mercury',\n    path: '/home/ubuntu/mercury-dev',\n    port: 80,\n    servers: {\n        one: {},\n    },\n    buildOptions: {\n        serverOnly: true,\n    },\n    env: {\n        ROOT_URL: \"https://xyz.com\",\n        MONGO_URL: \"mongodb://172.17.0.1:27017/mercury\"\n    },\n    dockerImage: 'abernix/meteord:base',\n    deployCheckWaitTime: 60,\n    enableUploadProgressBar: false,\n    ssl: {\n        crt: \"/etc/nginx/certs/chained.pem\", \n        key: \"/etc/nginx/certs/key.pem\",\n        port: 443\n    }\n}\n\n};\n```\nAny help would be awesome! Thanks!. Wow, thanks for the quick reply!\nThat was it, got me past the silent fail.. Yeah I have in my mup:\nssl: {\n            crt: \"/etc/nginx/certs/chained.pem\", \n            key: \"/etc/nginx/certs/key.pem\", \n            port: 443 \n        }\nSo is that what's creating the nginx container?. Awesome! For now, I just removed the 'ssl:' tags from mup.js and it allowed my to run my own nginx. I'll look into force-ssl though. Does it just 'do it for you' or what's it's benefit from using my own nginx frontend?. ",
    "ayhid": "@zodern thanks for the takeover & the feedback\nI have a pem path with ~ I am on mup 1.2.1 but this does not seem to work it just fails silently. ",
    "tomyo": "@mroftalp, did you find out why?\nI'm getting the same error in Galaxy, this is the closet thing I found on internet. (sorry MUP for the noise). Hi!, sadly, I don't remember, I think it went away updating meteor and every package. ",
    "kjp17": "One way to solve this is to use collectionfs and put it in aws s3. Nope. I've given up.  I am using galaxy.  Other alternative is pm2, meteor build. Thank you.   that works for me too!!!!. ",
    "949mac": "I'm having the same issue. \nDigital Ocean\n512 MB Memory / 20 GB Disk / SFO2 - Ubuntu 16.04.1 x64\n. ",
    "saiy2k": "I am getting a similar issue with fresh installation of Meteor app.\nMeteor Version:\n1.4.4.2\nMup Version:\n1.2.8\nError on mup deploy:\n\nStarted TaskList: Start Meteor\n[139.59.16.54] - Start Meteor\n[139.59.16.54] - Start Meteor: SUCCESS\n[139.59.16.54] - Verifying Deployment\n[139.59.16.54] x Verifying Deployment: FAILED\n-----------------------------------STDERR-----------------------------------\n  -- block-stream@0.0.9 \n  |-- which@1.2.14 \n  |   -- isexe@2.0.0 \n  +-- node-pre-gyp@0.6.34 \n  | +-- nopt@4.0.1 \n  | +-- rc@1.2.1 \n  | | +-- deep-extend@0.4.2 \n  | | +-- ini@1.3.4 \n  | | +-- minimist@1.2.0 \n  | |-- strip-json-comments@2.0.1 \n  | +-- semver@5.3.0 \n  | -- tar-pack@3.4.0 \n  |   +-- debug@2.6.8 \n  |   |-- ms@2.0.0 \n  |   +-- fstream-ignore@1.0.5 \n  |   +-- readable-stream@2.2.9 \n  |   | +-- buffer-shims@1.0.0 \n  |   | +-- core-util-is@1.0.2 \n  |   | +-- isarray@1.0.0 \n  |   | +-- process-nextick-args@1.0.7 \n  |   | +-- string_decoder@1.0.1 \n  |   | -- util-deprecate@1.0.2 \n  |-- uid-number@0.0.6 \n  +-- promise@7.1.1 \n  +-- semver@4.1.0 \n  +-- source-map@0.1.32 \n  +-- source-map-support@0.3.2 \n  +-- strip-ansi@0.3.0 \n  +-- supports-color@0.2.0 \n  +-- type-of@2.0.1 \n  `-- underscore@1.5.2 \nnpm WARN meteor-dev-bundle@0.0.0 No description\n  npm WARN meteor-dev-bundle@0.0.0 No repository field.\n  npm WARN meteor-dev-bundle@0.0.0 No license field.\n  => Starting meteor app on port:80\n=> Redeploying previous version of the app\n-----------------------------------STDOUT-----------------------------------\nTo see more logs type 'mup logs --tail=50'\n\n\nmup logs --tail=100 shows\n[139.59.16.54]\n[139.59.16.54]> meteor-dev-bundle@0.0.0 install /bundle/bundle/programs/server\n[139.59.16.54]> node npm-rebuild.js\n[139.59.16.54]\n[139.59.16.54]{\n[139.59.16.54]  \"meteor-dev-bundle\": \"0.0.0\",\n[139.59.16.54]  \"npm\": \"3.10.10\",\n[139.59.16.54]  \"ares\": \"1.10.1-DEV\",\n[139.59.16.54]  \"http_parser\": \"2.7.0\",\n[139.59.16.54]  \"icu\": \"56.1\",\n[139.59.16.54]  \"modules\": \"46\",\n[139.59.16.54]  \"node\": \"4.8.0\",\n[139.59.16.54]  \"openssl\": \"1.0.2k\",\n[139.59.16.54]  \"uv\": \"1.9.1\",\n[139.59.16.54]  \"v8\": \"4.5.103.45\",\n[139.59.16.54]  \"zlib\": \"1.2.8\"\n[139.59.16.54]}\n[139.59.16.54]npm WARN meteor-dev-bundle@0.0.0 No description\n[139.59.16.54]npm WARN meteor-dev-bundle@0.0.0 No repository field.\n[139.59.16.54]npm WARN meteor-dev-bundle@0.0.0 No license field.\n[139.59.16.54]=> Starting meteor app on port:80\nIncreased deployCheckWaitTime to 440.\nMy mup.js file\n\nmodule.exports = {\n  servers: {\n    one: {\n      // TODO: set host address, username, and authentication method\n      host: '[server_ip goes here]',\n      username: '[user_name goes here]',\n      // pem: './path/to/pem'\n      password: '[password goes here]'\n      // or neither for authenticate from ssh-agent\n    }\n  },\nmeteor: {\n    // TODO: change app name and path\n    name: 'test-app',\n    path: '.',\nservers: {\n  one: {},\n},\n\nbuildOptions: {\n  serverOnly: true,\n},\n\nenv: {\n  // TODO: Change to your app's url\n  // If you are using ssl, it needs to start with https://\n  ROOT_URL: 'http://139.59.16.54/test-app',\n  PORT: 443\n  //MONGO_URL: 'mongodb://localhost/meteor',\n},\n\ndocker: {\n  // change to 'kadirahq/meteord' if your app is not using Meteor 1.4\n  image: 'abernix/meteord:base',\n  // imagePort: 80, // (default: 80, some images EXPOSE different ports)\n},\n\n// This is the maximum time in seconds it will wait\n// for your app to start\n// Add 30 seconds if the server has 512mb of ram\n// And 30 more if you have binary npm dependencies.\ndeployCheckWaitTime: 440,\n\n// Show progress bar while uploading bundle to server\n// You might need to disable it on CI servers\nenableUploadProgressBar: false\n\n},\nmongo: {\n    port: 27017,\n    version: '3.4.1',\n    servers: {\n      one: {}\n    }\n  }\n};\n. Copying my console log\n\n```\n$ mup deploy --verbose\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[139.59.16.54] - Pushing Meteor App Bundle to The Server\n[139.59.16.54] - Pushing Meteor App Bundle to The Server: SUCCESS\nStarted TaskList: Configuring App\n[139.59.16.54] - Pushing the Startup Script\n[139.59.16.54] - Pushing the Startup Script: SUCCESS\n[139.59.16.54] - Sending Environment Variables\n[139.59.16.54] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[139.59.16.54] - Start Meteor\ntest-app\nError response from daemon: endpoint test-app not found\nError response from daemon: No such container: test-app-frontend\nError response from daemon: endpoint test-app-frontend not found\nRemoved test-app-frontend\nError response from daemon: No such container: test-app-nginx-letsencrypt\nError response from daemon: endpoint test-app-nginx-letsencrypt not found\nRemoved test-app-nginx-letsencrypt\nError response from daemon: No such container: test-app-nginx-proxy\nError response from daemon: endpoint test-app-nginx-proxy not found\nRemoved test-app-nginx-proxy\nbase: Pulling from abernix/meteord\nDigest: sha256:9ed85313621010dd27a08054ae9225aa1f31798647fbcfdc9cc082181c6f9c97\nStatus: Image is up to date for abernix/meteord:base\nPulled abernix/meteord:base\nc0412af916c9e32b228bc2122b7c1e2151b9e8f0f9d9c31342257a45ec76635f\nRan abernix/meteord:base\n[139.59.16.54] - Start Meteor: SUCCESS\n[139.59.16.54] - Verifying Deployment\n% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (22) The requested URL returned error: 404 Not Found //This block is repeated several time\n| | +-- mime-types@2.1.15 \n| | | -- mime-db@1.27.0 \n| | +-- oauth-sign@0.8.2 \n| | +-- performance-now@0.2.0 \n| | +-- qs@6.4.0 \n| | +-- safe-buffer@5.0.1 \n| | +-- stringstream@0.0.5 \n| | +-- tough-cookie@2.3.2 \n| | |-- punycode@1.4.1 \n| | +-- tunnel-agent@0.6.0 \n| | -- uuid@3.0.1 \n| +-- rimraf@2.6.1 \n| +-- semver@5.3.0 \n| +-- tar@2.2.1 \n| |-- block-stream@0.0.9 \n| -- which@1.2.14 \n|-- isexe@2.0.0 \n+-- node-pre-gyp@0.6.34 \n| +-- nopt@4.0.1 \n| +-- rc@1.2.1 \n| | +-- deep-extend@0.4.2 \n| | +-- ini@1.3.4 \n| | +-- minimist@1.2.0 \n| | -- strip-json-comments@2.0.1 \n| +-- semver@5.3.0 \n|-- tar-pack@3.4.0 \n|   +-- debug@2.6.8 \n|   | -- ms@2.0.0 \n|   +-- fstream-ignore@1.0.5 \n|   +-- readable-stream@2.2.9 \n|   | +-- buffer-shims@1.0.0 \n|   | +-- core-util-is@1.0.2 \n|   | +-- isarray@1.0.0 \n|   | +-- process-nextick-args@1.0.7 \n|   | +-- string_decoder@1.0.1 \n|   |-- util-deprecate@1.0.2 \n|   -- uid-number@0.0.6 \n+-- promise@7.1.1 \n+-- semver@4.1.0 \n+-- source-map@0.1.32 \n+-- source-map-support@0.3.2 \n+-- strip-ansi@0.3.0 \n+-- supports-color@0.2.0 \n+-- type-of@2.0.1-- underscore@1.5.2 \nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\n=> Starting meteor app on port:80\nTo see more logs type 'mup logs --tail=50'\n=> Redeploying previous version of the app\n[139.59.16.54] x Verifying Deployment: FAILED\n-----------------------------------STDERR-----------------------------------\n`-- block-stream@0.0.9 \n| `-- which@1.2.14 \n|   `-- isexe@2.0.0 \n+-- node-pre-gyp@0.6.34 \n| +-- nopt@4.0.1 \n| +-- rc@1.2.1 \n| | +-- deep-extend@0.4.2 \n| | +-- ini@1.3.4 \n| | +-- minimist@1.2.0 \n| | `-- strip-json-comments@2.0.1 \n| +-- semver@5.3.0 \n| `-- tar-pack@3.4.0 \n|   +-- debug@2.6.8 \n|   | `-- ms@2.0.0 \n|   +-- fstream-ignore@1.0.5 \n|   +-- readable-stream@2.2.9 \n|   | +-- buffer-shims@1.0.0 \n|   | +-- core-util-is@1.0.2 \n|   | +-- isarray@1.0.0 \n|   | +-- process-nextick-args@1.0.7 \n|   | +-- string_decoder@1.0.1 \n|   | `-- util-deprecate@1.0.2 \n|   `-- uid-number@0.0.6 \n+-- promise@7.1.1 \n+-- semver@4.1.0 \n+-- source-map@0.1.32 \n+-- source-map-support@0.3.2 \n+-- strip-ansi@0.3.0 \n+-- supports-color@0.2.0 \n+-- type-of@2.0.1 \n`-- underscore@1.5.2\n\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\n=> Starting meteor app on port:80\n\n=> Redeploying previous version of the app\n\n-----------------------------------STDOUT-----------------------------------\n\nTo see more logs type 'mup logs --tail=50'\n\n----------------------------------------------------------------------------\n\n```. ",
    "jawwadh1": "i have a same issue kindly refer to this \nhttps://github.com/RocketChat/Rocket.Chat/issues/9167\nUsing Cent-Os \nSolved \nyum install g++ build-essential\n\nnpm install -g node-gyp\n\ncd /opt/Rocket.Chat/programs/server/node_modules/fibers/\n\nnode-gyp rebuild\n\ncp build/Release/fibers.node bin/linux-x64-57/fibers.node\n\nsystemctl start rocketchat.service\n\nThis is the procedure for Upgrading rocket chat \nHope this can be applied to new instance\n. ",
    "kevinhattam": "I'm seeing this issue too. I'm wondering if setting the ROOT_URL in my mup.js to have https will resolve this. Were you able to resolve this?. ",
    "barrymichaeldoyle": "Thanks man \ud83d\udc4d. ",
    "LucasBassetti": "I have the same problem.\nI have two meteor applications sharing one separate instance of mongodb in the same server. But when I try deploy I get the following error: \nfailed to connect to server [127.0.0.1:27017] on first connect\nAnybody knows how to solve that?. ",
    "dealogikal": "anyone here who had this issue and was able to solve?\nThanks in advance!. ",
    "srimenow": "I am in your same boat as well, \n-----------------------------------STDERR-----------------------------------\n    Tag latest not found in repository docker.io/library/mongo\n    -----------------------------------STDOUT-----------------------------------\n    Pulling repository docker.io/library/mongo\n    ----------------------------------------------------------------------------\n.... this was only after trying to destroy my digital ocean droplet and start over again after the error\nmup logs\nupdate 1.0.0 => 1.0.4\n[107.170.***.***]Error: No such container:********. As I stated on another thread you should remove Mup from your system, reinstall it, and create a new digital ocean / cloud provider of choice instance to see if that fixes the issue.\nI had to do both, some people only have to reinstall mup, let us know if you did this and still have the issue.\nAlso please note don't just destroy your instance and create a new one, you need a fresh droplet with a new IP in my experience . @codeHatcher \nI have been trying to hunt down the root source of the problem, but I am going to throw in the towel and share my solution, please let me know if it helps you.\nI created a new digital ocean droplet, and after a fresh install of mup I also created a new .deploy folder .... you won't believe everything worked! \nAnother solution, if your site is just down right now and you can't get it up is to host a mongoDB instance with somebody like compose.io \nLet me  know if you need anything else. I cannot trace this issue, but feel it is more related to docker or digital ocean than MUP itself. Best of luck :). ",
    "06chaynes": "I will add that I had the same issue @srimenow was experiencing. I had to completely remove mup from my local system and re-install, after that setup and deployment worked as expected.. ",
    "SaiMun92": "Did u solve it in the end? How do you solve it? I am currently facing this issue now\n. Nice!!!!! That did the trick!!! Thanks a lot mann!!!!!!. ",
    "yawlhead91": "Hi @icecoolcat  \nI did thanks to https://github.com/abernix,\nYou have to set the docker image in the mup file to \ndockerImage: 'abernix/meteord',\nThen make sure node, meteor node and npm are the same vresions on both client and server in my case.\nMeteor node - v4.6.2\nNode - v4.6.2\nMeteor npm - 3.10.9\nnpm - 3.10.9\nI did reinstall both node and meteor first removing everything. \nHope this helps\n. @icecoolcat  No problem. ",
    "dklisiaris": "Looks like the mongo latest version is hard coded in start_mongo.sh\nSo currently it cannot be confugured.. ",
    "spk2piyu": "I am new to mup, please let me know where to do these changes. \ndocker image abernix/meteord:base\nhow to resolve wekan/issues/763 with abernix/meteord:base.. ",
    "spiotr12": "Surprisingly not yet. We can close this issue for now.. ",
    "mmahgoub": "@krishaamer Yeah! can't deploy no more. ",
    "csellis": "What did you do exactly?. This may help identify the problem\n\nSSH into your server\ntype: docker ps\n\nMine says mongodb is constantly restarting.. ",
    "JohnAllen": "If mup setup is supposed to be run from a local dev machine, let me know and I will make that clear in the docs and submit a PR.. I'm leaving this open because of the Node install issue.  Seems like mup should install Node if it's not already.. Best guess is that it doesn't build any client code even if it exists?. Either one or both of two things: \n1) At first I didn't think it was another Node versioning issue, like all of the historically similar issues I found, because both Meteor node --version and the Meteor version used by the image were both 4 something (at least that's what others have said the image version was).  And I thought that these were the only two that mattered.  But then just node --version locally was running a 5 version and I started to use 4 there, AND/OR\n2) I changed 'abernix:meteord:base' to 'abernix/meteord:base' in mup.js because it said that that wasn't a valid docker image or repo or somethin.  Perhaps this change should be made in the repo?  But then I wonder how it's working for others.  (I have been traveling and half working and sun-pounded so I really don't know what helped, all I know is I did these two things and my last mup deploy was successful with using a forward slash there.)\n. 1.4.1.3  All I know is that mup deploy wasn't finding local packages until I re-set PACKAGE_DIRS to my package dir.  . Thanks, closing.. Let's Encrypt is working fine for me at DO with 16.02. Thanks for your comments.\nIf I install mongo-client then I can access the mongo instance running inside the docker container.  I have not tried accessing it locally, but it sounds like this is possible and seems like it would be to me too.\nI am asking this because I want to be able to insert docs from another server, really another Meteor app.. I have been planning on inserting content straight into the database -- as a central data store that both apps can access.  One app is a web-crawler, essentially, that inserts data into the database that is analyzed and is later served to users.  I've just thought as the DB being the optimal way of inserting, analyzing and serving data, but I will think about other ideas some more.  The data does need to be stored permanently for future display to users.  I could perhaps restructure/refactor but would probably go a normal un-dockerized Mongo instance before I do that.. Yes sure give me 36 hours. Been traveling.\nOn Mar 8, 2017 4:25 AM, \"Shannon Duncan\" notifications@github.com wrote:\n\n@JohnAllen https://github.com/JohnAllen are you able to make the\nrequested changes?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/pull/499#issuecomment-284864071, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/ACq8AXNZimdpqarlQMfKZFsnxBts2ekcks5rjcsqgaJpZM4MPNoQ\n.\n. Are you sure bcrypt is installed properly locally before deploying?  Does your app run correctly locally?  Maybe try meteor npm install --save bcrypt if you haven't already?. Seems like it should although I guess you couldn't have tons of users\ndepending on the number of subscriptions you'll have.\n\nOn Mar 7, 2017 6:18 AM, \"Josh\" notifications@github.com wrote:\n\nI get this problem on my deploys too. Although I can deploy on a 1gb\ndroplet instance just fine. Has anyone successfully gotten this to deploy\nto DO on a 512 instance?\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/509#issuecomment-284566992,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ACq8ATkIR7TPPYXaP3nL0tCGXOW1wA8rks5rjJRWgaJpZM4MT9xK\n.\n. I've gotten that with a slow or intermittent upload speeds.  Move closer to your router or otherwise improve your signal if you can.. Your mongo is run in a separate docker container.  See the README about accessing the mongo instance. . Mongo uses quite a bit of disk space for each collection, at least it used to.  Are you sure this is a Meteor problem in the first place?. What do you mean \"debug: false is been omitted\"?  That you didn't have that there and it's still not running production mode?  How do you know it's not running in production mode?. Ok, not sure exactly where the problem was, but it was in my mup.js file.  If someone else runs into this, I suggest copying the default mup.js file and manually adding your params there one by one.  . Pretty sure I had path: '../appFolder' instead of path: '../'. Yeah I was doing this hastily as evidenced by the mistakes.. \n",
    "willyb321": "Its pretty good that this is being maintained again, as many people rely on it !. Yeah, I noticed this, since I do all the deployment myself, I just added meteor npm install to my script after git pulling. Not a big issue, but would be nice to have.. @zodern Yep - that went through perfectly! Thanks! I'll close this now!. Actually, it doesn't seem to have worked - I didn't realize I had prepareBundle: false in my config.. ",
    "Apollinaire": "For the people stumbling on this now : you can do METEOR_PACKAGE_DIRS=\"../foo\" mup deploy only for environment variables that are involved in the build process. So MONGO_URL should stay in mup.js, because mup sets it in the docker.\nI am doing this in mup version 1.4.5 and meteor version 1.8. Great! I'll wait until tomorrow then and if my problems are solved i will close the issue, if not i'll come back to you here. \nThanks for the awesome work on mup :+1: . Hi again @zodern , \nI think i figured out part of the problem, it came from forceSSL:true, and from some strange behavior between azure public ip, azure dns name and my namedomain provider; I couldn't figure out which domain to put in ROOT_URL, in proxy.domains, and if i should set my namespace redirect to the ip or the azure dns. Anyway, i'll move out of mup and will setup nginx&mongo by hand, this way i feel like i have more control than with containers. \nI'm closing the issue. >  I had to wipe the instance and start over from scratch.\n@zodern is there a command to clean the instance from everything that mup has setup on it? That would be awesome. I had issues too with ssl, and i had to wipe an instance too to make it work . No, nothing has worked so far.\n```\n$ mup proxy setup --config=mup.js --verbose\nStarted TaskList: Setup proxy\n[13.94.233.117] - Setup Environment\n[13.94.233.117] - Setup Environment: SUCCESS\n[13.94.233.117] - Pushing the Startup Script\n[13.94.233.117] - Pushing the Startup Script: SUCCESS\n[13.94.233.117] - Pushing Nginx Config\nrm: cannot remove 'chat.myurl.tech_location': No such file or directory\n[13.94.233.117] - Pushing Nginx Config: SUCCESS\n[13.94.233.117] - Cleaning Up SSL Certificates\n[13.94.233.117] - Cleaning Up SSL Certificates: SUCCESS\nStarted TaskList: Start proxy\n[13.94.233.117] - Start proxy\nmup-nginx-proxy\nError response from daemon: endpoint mup-nginx-proxy not found\nRemoved mup-nginx-proxy\nmup-nginx-proxy-letsencrypt\nError response from daemon: endpoint mup-nginx-proxy-nginx-proxy not found\nRemoved mup-nginx-proxy-letsencrypt\nlatest: Pulling from jrcs/letsencrypt-nginx-proxy-companion\nDigest: sha256:409c4da77ba683bcb1e5b60e30176ab337e158fefcd52aa1197483eb5eb3af38\nStatus: Image is up to date for jrcs/letsencrypt-nginx-proxy-companion:latest\nUsing default tag: latest\nlatest: Pulling from jwilder/nginx-proxy\nDigest: sha256:da211f3801d6f7b8057762493f2ff8aaf855330977c61d6ada06985b050a8d75\nStatus: Image is up to date for jwilder/nginx-proxy:latest\nPulled jwilder/nginx-proxy and jrcs/letsencrypt-nginx-proxy-companion\nc821376ed8d8ae45b60ad8c10bc20c63e3389dea8f0a0e0fecc13d51cf204d02\nRan nginx-proxy as mup-nginx-proxy\n5eccdffbee8b046b6bf6699f1eb493e390aa24dbe458d660fadcb02c0e3bec78\nRan jrcs/letsencrypt-nginx-proxy-companion\n[13.94.233.117] - Start proxy: SUCCESS\n```. @soyisraelortiz I saw in an issue on the rocket chat repo that you are deploying it using mup, could you tell us if you did anything special to get it to work?. ",
    "kratam": "I have the same problem. If I run mup logs -f in another screen then it seems it stop after Starting meteor app on port:80. Already tried to increase deployCheckWaitTime to 180 without any luck.. @zodern in my case it's:\n```\nStarted TaskList: Start Meteor\n[XXXXX] - Start Meteor\n[XXXXX] - Start Meteor: SUCCESS\n[XXXXX] - Verifying Deployment\n[XXXXX] x Verifying Deployment: FAILED\n-----------------------------------STDERR-----------------------------------\nblock-stream@0.0.9 \n| `-- which@1.2.12 \n|   `-- isexe@1.1.2 \n+-- node-pre-gyp@0.6.29 \n| +-- rc@1.1.6 \n| | +-- deep-extend@0.4.1 \n| | +-- ini@1.3.4 \n| | +-- minimist@1.2.0 \n| | `-- strip-json-comments@1.0.4 \n| +-- semver@5.2.0 \n| `-- tar-pack@3.1.4 \n|   +-- debug@2.2.0 \n|   | `-- ms@0.7.1 \n|   +-- fstream-ignore@1.0.5 \n|   +-- once@1.3.3 \n|   +-- readable-stream@2.1.5 \n|   | +-- buffer-shims@1.0.0 \n|   | +-- core-util-is@1.0.2 \n|   | +-- isarray@1.0.0 \n|   | +-- process-nextick-args@1.0.7 \n|   | +-- string_decoder@0.10.31 \n|   | `-- util-deprecate@1.0.2 \n|   `-- uid-number@0.0.6 \n+-- promise@7.1.1 \n+-- semver@4.1.0 \n+-- source-map@0.1.32 \n+-- source-map-support@0.3.2 \n+-- strip-ansi@0.3.0 \n+-- supports-color@0.2.0 \n+-- type-of@2.0.1 \n`-- underscore@1.5.2\n\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\n=> Starting meteor app on port:80\n\n=> Redeploying previous version of the app\n\n-----------------------------------STDOUT-----------------------------------\n\nTo see more logs type 'mup logs --tail=50'\n\n----------------------------------------------------------------------------\n\n(node:30391) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: \n-----------------------------------STDERR-----------------------------------\nblock-stream@0.0.9 \n| -- which@1.2.12 \n|-- isexe@1.1.2 \n+-- node-pre-gyp@0.6.29 \n| +-- rc@1.1.6 \n| | +-- deep-extend@0.4.1 \n| | +-- ini@1.3.4 \n| | +-- minimist@1.2.0 \n| | -- strip-json-comments@1.0.4 \n| +-- semver@5.2.0 \n|-- tar-pack@3.1.4 \n|   +-- debug@2.2.0 \n|   | -- ms@0.7.1 \n|   +-- fstream-ignore@1.0.5 \n|   +-- once@1.3.3 \n|   +-- readable-stream@2.1.5 \n|   | +-- buffer-shims@1.0.0 \n|   | +-- core-util-is@1.0.2 \n|   | +-- isarray@1.0.0 \n|   | +-- process-nextick-args@1.0.7 \n|   | +-- string_decoder@0.10.31 \n|   |-- util-deprecate@1.0.2 \n|   -- uid-number@0.0.6 \n+-- promise@7.1.1 \n+-- semver@4.1.0 \n+-- source-map@0.1.32 \n+-- source-map-support@0.3.2 \n+-- strip-ansi@0.3.0 \n+-- supports-color@0.2.0 \n+-- type-of@2.0.1-- underscore@1.5.2 \nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\n=> Starting meteor app on port:80\n=> Redeploying previous version of the app\n-----------------------------------STDOUT-----------------------------------\nTo see more logs type 'mup logs --tail=50'\n\n(node:30391) DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\n```. Sorry, it was a problem with another service. From the warning I thought it might be a problem with mup.\nThanks a lot!. ",
    "jetlej": "@zodern - Here is the full output\n```\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor\n[138.197.68.48] - Pushing Meteor App Bundle to The Server\n[138.197.68.48] - Pushing Meteor App Bundle to The Server: SUCCESS\n[138.197.68.48] - Pushing the Startup Script\n[138.197.68.48] - Pushing the Startup Script: SUCCESS\nStarted TaskList: Configuring Meteor Environment Variables\n[138.197.68.48] - Sending Environment Variables\n[138.197.68.48] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[138.197.68.48] - Start Meteor\n[138.197.68.48] - Start Meteor: SUCCESS\n[138.197.68.48] - Verifying Deployment\n[138.197.68.48] x Verifying Deployment: FAILED\n-----------------------------------STDERR-----------------------------------\n:-- --:--:-- --:--:--     0\ncurl: (52) Empty reply from server\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\n0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\n    curl: (52) Empty reply from server\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                     Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\n    curl: (52) Empty reply from server\n> fibers@1.0.15 install /bundle/bundle/programs/server/node_modules/fibers\n> node build.js || nodejs build.js\n\n`linux-x64-46` exists; testing\n/opt/meteord/run_app.sh: line 21:     8 Killed                  npm install --unsafe-perm\n-----------------------------------STDOUT-----------------------------------\n\nTo see more logs type 'mup logs --tail=50'\n\n----------------------------------------------------------------------------\n\n(node:30105) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: \n-----------------------------------STDERR-----------------------------------\n:-- --:--:-- --:--:--     0\ncurl: (52) Empty reply from server\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (52) Empty reply from server\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (52) Empty reply from server\n\nfibers@1.0.15 install /bundle/bundle/programs/server/node_modules/fibers\nnode build.js || nodejs build.js\n\nlinux-x64-46 exists; testing\n/opt/meteord/run_app.sh: line 21:     8 Killed                  npm install --unsafe-perm\n-----------------------------------STDOUT-----------------------------------\nTo see more logs type 'mup logs --tail=50'\n\n(node:30105) DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\n```. Now I get this: \n```\n[138.197.68.48] x Start Meteor: FAILED\n-----------------------------------STDERR-----------------------------------\nError response from daemon: No such container: spidermonkey-frontend\nError response from daemon: No such container: spidermonkey-nginx-letsencrypt\nError response from daemon: No such container: spidermonkey-nginx-proxy\ndocker: Error response from daemon: service endpoint with name spidermonkey already exists.\n-----------------------------------STDOUT-----------------------------------\nspidermonkey\nRemoved spidermonkey-frontend\nRemoved spidermonkey-nginx-letsencrypt\nRemoved spidermonkey-nginx-proxy\nbase: Pulling from abernix/meteord\nDigest: sha256:5b44a27c1ef8f8453f69d452345a92290e290143e4bb1a6d7819f0bc38b8fd96\nStatus: Image is up to date for abernix/meteord:base\nPulled abernix/meteord:base\n046c9ab598f876522ff30bad90be3c4fa7270f500323833ffa50689a9aa98938\n----------------------------------------------------------------------------\n\n(node:51497) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: \n-----------------------------------STDERR-----------------------------------\nError response from daemon: No such container: spidermonkey-frontend\nError response from daemon: No such container: spidermonkey-nginx-letsencrypt\nError response from daemon: No such container: spidermonkey-nginx-proxy\ndocker: Error response from daemon: service endpoint with name spidermonkey already exists.\n-----------------------------------STDOUT-----------------------------------\nspidermonkey\nRemoved spidermonkey-frontend\nRemoved spidermonkey-nginx-letsencrypt\nRemoved spidermonkey-nginx-proxy\nbase: Pulling from abernix/meteord\nDigest: sha256:5b44a27c1ef8f8453f69d452345a92290e290143e4bb1a6d7819f0bc38b8fd96\nStatus: Image is up to date for abernix/meteord:base\nPulled abernix/meteord:base\n046c9ab598f876522ff30bad90be3c4fa7270f500323833ffa50689a9aa98938\n----------------------------------------------------------------------------\n(node:51497) DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\n. No luck :/ I disconnected spidermonkey from all docker servers and then ran mup deploy again. Same error. .\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                        NAMES\naf2d11bf311c        mongo:3.4.1         \"/entrypoint.sh mo...\"   24 hours ago        Up 24 hours         127.0.0.1:27017->27017/tcp   mongodb\n``. I'm using whatever MUP installed on the server when I ranmup setup`. Prior to that, it was a blank Digital Ocean droplet running Ubuntu 16.04\nApparently thats: Docker version 1.13.0, build 49bf474. I already did reset the droplet and ran mup setup :/\nDo you have a recommended stack for Digital Ocean? Something other than Ubuntu perhaps?. Reverting to Ubuntu 14.04 got it to work!. The plot thickens.\nIt worked for my staging server that is using local Mongo, but I'm getting the same error for the live server which uses a Compose.io mongo instance. \nBasically if I include the 'mongo' field in mup.js, it works. Otherwise I get that same error. . Thank you so much for your help on this!. So I spun out ANOTHER droplet with the exact same settings and now it's working. I have no idea what's going on. . So it seems that Ubuntu 16 is the major issue. @djkmiles - Try with 14.04 if you can. I'm getting that error again when trying to setup + deploy to a new server with Ubuntu 14.04.5 x64\n```\nStarted TaskList: Start Meteor\n[159.203.87.133] - Start Meteor\n[159.203.87.133] x Start Meteor: FAILED\n-----------------------------------STDERR-----------------------------------\nError response from daemon: No such container: spidermonkey\nError response from daemon: No such container: spidermonkey-frontend\nError response from daemon: No such container: spidermonkey-nginx-letsencrypt\nError response from daemon: No such container: spidermonkey-nginx-proxy\nError response from daemon: manifest for abernix/meteord:base not found\nUnable to find image 'abernix/meteord:base' locally\ndocker: Error response from daemon: manifest for abernix/meteord:base not found.\nSee 'docker run --help'.\n-----------------------------------STDOUT-----------------------------------\nRemoved spidermonkey-frontend\nRemoved spidermonkey-nginx-letsencrypt\nRemoved spidermonkey-nginx-proxy\nPulled abernix/meteord:base\n----------------------------------------------------------------------------\n\n```. ",
    "bryanlimy": "same problem here. Reverting back to MUP 1.2.1 didn't fix the problem.. I just clean installed Ubuntu 16.04.01 on DigitalOcean, mup setup was fine, but when I do mup deploy, I got this instead\n```\nStarted TaskList: Start Meteor\n[104.131.20.212] - Start Meteor\n[104.131.20.212] - Start Meteor: SUCCESS\n[104.131.20.212] - Verifying Deployment\n[104.131.20.212] x Verifying Deployment: FAILED\n-----------------------------------STDERR-----------------------------------\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\n0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\n    curl: (56) Recv failure: Connection reset by peer\n    zsh:31: = not found\n    -----------------------------------STDOUT-----------------------------------\n    ----------------------------------------------------------------------------\n```\nand mup logs show this\n/opt/meteord/run_app.sh: line 21:     8 Killed                  npm install --unsafe-perm. @zodern yes, should I use bash instead?. @zodern ok. I will try with bash and create new issue for zsh. I revert back to one of my old commit and mup deploy is fine.\nI think my problem is with the latest version of Dogfalo/materialize\nOnce I revert back to version v0.97.7, mup deploy is completely fine. When I use v0.98.0, it breaks everything.. ",
    "djkmiles": "Same behaviour running mup setup, fresh DO 16.04.1 and node v7.5.0 however recreated also using LTS completely unaffected by settings files.\n``\n(node:71554) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): TypeError: Cannot convert undefined or null to object\n(node:71554) DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.. I tried 14.04 and got same message, then put catch/try block into lib/validate/index.js where  config.meteor value is tested and got a better message with backtrace and realised it was simply failing to validate my meteor configuration. In my case there was no problem other than error trapping allowing to pinpoint error. That was all completed with 16.04.1 and node 7.5\n```\n if (config.meteor) {\n    try {\n        results = (0, _meteor2.default)(config);\n    }\n    catch (e) {\n        console.log(e);\n    }\n    details = (0, _utils.combineErrorDetails)(details, results);\n  }. @zodern that output was simply a backtrace:\n```\nTypeError: Cannot convert undefined or null to object\n    at Function.keys ()\n    at serversExist (C:/Users/z-mod/dev/meteor-up/src/utils.js:35:21)\n    at exports.default (/usr/local/lib/node_modules/mup/lib/validate/meteor.js:18:78)\n    at validateAll (C:/Users/z-mod/dev/meteor-up/src/index.js:36:10)\n    at validate (C:/Users/z-mod/dev/meteor-up/src/index.js:48:15)\n    at MupAPI.validateConfig (C:/Users/z-mod/dev/meteor-up/src/mup-api.js:30:5)\n    at MupAPI.getConfig (C:/Users/z-mod/dev/meteor-up/src/mup-api.js:79:12)\n    at Object.setup (C:/Users/z-mod/dev/meteor-up/src/index.js:58:16)\n    at C:/Users/z-mod/dev/meteor-up/src/index.js:112:2\n    at process._tickCallback (internal/process/next_tick.js:103:7)\n. As I meant to say, the error was a key being mis-named:\nmeteor: {\n        name: 'project',\n        path: '/path/to/project,\n        server: {\nWas corrected to servers: { so in my case the error was only the result of having a key mis-match on the config file.. ",
    "ClarenceL": "Never mind my nodejs was just very old. ",
    "lachesis": "We're seeing this regression as well. Old versions of mup were perfectly happy with a hostname, but new ones give us this error.. ",
    "rajpa": "hi @zodern \nhere it is...\nmodule.exports = {\n  servers: {\n    one: {\n      \"host\": \"52.6.6.1\",\n      \"username\": \"ubuntu\",\n      \"pem\": \"/Users/home/Google Drive/mycompany/pems/myappUbuntu04Aug16.pem\"\n    }\n  },\n  meteor: {\n    name: 'myapp',\n    path: '../../ubunturepository',\n    docker: {\n      image: 'abernix/meteord:base'\n    },\n    servers: {\n      one: {}\n    },\n    ssl: {\n      port: 443,\n      crt: '/Users/home/Google Drive/mycompany/pems/pems/fullchain.pem',\n      key: '/Users/home/Google Drive/mycompany/pems/pems/privkey.pem',\n    },\n    buildOptions: {\n      cleanAfterBuild: true // default\n    },\n    env: {\n      \"ROOT_URL\": \"https://myapp.in\",\n      \"PORT\": \"80\",\n      \"MONGO_URL\" : \"mongodb://mongodb:27017/myapp\",\n      \"MONGO_OPLOG_URL\": \"mongodb://mongodb:27017/local\",\n      \"MOBILE_DDP_URL\": \"https://myapp.in:443\",\n      \"MOBILE_ROOT_URL\": \"https://myapp.in:443\",\n      \"DDP_DEFAULT_CONNECTION_URL\" : \"https://myapp.in:443\",\n      \"CLUSTER_WORKERS_COUNT\": \"auto\"    \n    },\n    deployCheckWaitTime: 60 //default 10\n  },\nmongo: { // optional\n    port: 27017,\n    servers: {\n      one: {}\n    }\n  }\n};\n. thanks @zodern ! it is working now..\ncheers/rajpa. I had a running domain+https+meteor. Now, the has certificate expired and has not got automatically renewed. Both letsencrypt and certbot are installed in the system. I deleted all the docker images and ran mup setup, but the certificate expiry problem persists. Pls help.\n-rajpa. thanks @zodern ! \nAfter I deleted /opt/myapp/certs, the certificate was still not renewed. \nAnd then I had to open port 80 (!!!) on my domain because of an error I got from /app/letsencrypt_service which said self-certification error due to port 80 not accessible.\nAnd then I ran /app/letsencrypt_service again and restarted the docker container and it is working now...\nI wonder if I have to keep 80 open for this thing to work?\ncheers\nrajpa. ",
    "mklebrasseur": "Hi @wolganens,\nTry running mup reconfigure. . The below environment variables work for my config, does yours look similar? \nenv: {\n      PORT: 8080,\n      ROOT_URL: 'http://localhost',                                         MONGO_URL: 'mongodb://localhost/myDB',\n      CLUSTER_WORKERS_COUNT: 'AUTO'\n    },. ",
    "CarlQLange": "... perhaps I mean mup branch? It's been a long-ass time. ah, fantastic, thanks a lot!. Hi,\nI actually meant to close this - I'm going to do exactly what the docs say and just spin up a new server, mongodump off the old one, mongorestore on the new one, and change over DNS. Thanks for maintaining mup everyone, you're doing a great job!!. ",
    "janzheng": "I upgraded my DigitalOcean droplet to 1gb and still having the Bad Gateway issue. Anyone encountering the issue at 1gb?. it worked about half an hour after I posted it. All I did was keep trying to re-setup and re-deploying with the autogenerator and ssl turned on and off.\nThe worst(?) part is that I can't seem to recreate the conditions for when it actually broke. Next time I redeploy and it breaks again I'll post the logs, but it seems like deploying... sometimes works and sometimes doesn't (which is never a good thing). I'll keep you posted after more testing.\nThanks for working on this @zodern  . edit: DigitalOcean droplet went haywire. Cheers. ",
    "louwers": "Deploying without SSL and after that with SSL after that worked for me.\nAlso use the force-ssl package.. ",
    "jkalodner": "Yes, running it locally works perfectly.. On the build, it throws the exact same error.. Simply deleting the supports-color file did the trick. Thanks!. ",
    "shaiamir": "@shadowcodex Can you please explain what you want me to do? On which branch (what should I clone, commit to where?)\n@zodern Do you want me to do code changes along the lines of the \"thoughts\" you mentioned above?\n . ",
    "MuyBien": "I just SSH to a mupx-letsencrypt app deployed, and the docker used is the abernix/meteord:base. The same is recommended with a Meteor >1.4 for mup. MupX and Mup use both letsencrypt-companion. So I think there are compatible.\nNow I'm just wondering if I need to reconfigure the server <ith mup or with a deploy I can switch from a mupx deployed app to a mup deployed app.... I didn't convert for the moment, but someday I will... I will post here if any problem. It's maybe due to the nodeJS in my meteor: \n$ meteor node -e 'console.log(process.version);'\nv4.8.4\nAny help, or hint?\nThanks!. I updated to Meteor 1.6 and change the docker image to abernix/meteord:node-8.4.0-base but I still have a deploy with success but no application deployed :(. Hi @mpowaga!\nIt says in the docs that PORT is 80 by default if not specified.\nAnyway I will try it. . When I set the port I have an error : \n- \"app.env\" PORT can not be set when using ssl.autogenerate\nBut I made a mup logs and I see that there is an error while starting the app:\n[54.37.xx.xx]Error: The babel-runtime npm package could not be found in your node_modules \n[54.37.xx.xx]directory. Please run the following command to install it:\n[54.37.xx.xx]\n[54.37.xx.xx]  meteor npm install --save babel-runtime\n[54.37.xx.xx]\n[54.37.xx.xx]    at babel-runtime.js (packages/babel-runtime.js:36:9)\n[54.37.xx.xx]    at fileEvaluate (packages/modules-runtime.js:333:9)\n[54.37.xx.xx]    at require (packages/modules-runtime.js:228:16)\n[54.37.xx.xx]    at packages/babel-runtime.js:155:15\n[54.37.xx.xx]    at packages/babel-runtime.js:166:3\n[54.37.xx.xx]    at infos.forEach.info (/built_app/programs/server/boot.js:414:13)\n[54.37.xx.xx]    at Array.forEach (<anonymous>)\n[54.37.xx.xx]    at /built_app/programs/server/boot.js:413:9\n[54.37.xx.xx]    at /built_app/programs/server/boot.js:463:5\n[54.37.xx.xx]    at Function.run (/built_app/programs/server/profile.js:510:12)\n[54.37.xx.xx]=> Starting meteor app on port:80\nI did the meteor npm install --save babel-runtime but apparently I have already installed...\nAny hint?. I made fresh install of the server and now the deploy is marked as success but I still can't open my app on the URL.\nNow when I make a mup logs I only have one line with \n[54.37.xx.xx]=> Starting meteor app on port:80\nI don't understand... :( I don't want to go back to mupx-letsencrypt (I manage to deploy with this one in another project) because it's a fork for letsencrypt but now mup handle it.... Nope.\nStill getting all deploy markers as success but app is not accessible and the log just says Starting meteor app on port:80\nI don't know what to look at anymore :(. Yes I checked the common problems and I didn't found anything.\nMaybe I can test whithout the Let's Encrypt configuration... I'll be back!. Did you desactive the SSL option ?. @mpowaga here is the output. Seems good.\nroot@vps477638:~# docker port quiz-des-copinoux\n80/tcp -> 0.0.0.0:80. I just tried something I did not try before... I can access the app throw the IP!!!!\nSo it's the DNS that is not working??. I added the SSL again (the SSL part in mup.js, the s to the https of the roor URL and the force-ssl package) and I cannot access the app again (event by IP). I get the error : DNS_PROBE_FINISHED_NXDOMAIN\n:thinking: I don't understand!. @domparise Even whithout the SSL part, I can't access my app with the domain name, only by IP.... Some news about this issue?\nI still cannot access my app with the app name only by the IP.. :thinking: I have the domain.com. I'm trying to deploy to a subdomain. I've already did that in another domain but with mupx-letsencrypt... Maybe it's different with mup. How can I know if the domain it's well configured?. Thanks @edemaine !\nApparently it's not registered...\n\nSorry I forgot that for my other app, I added an entry for the subdomain in my server client interface.\nI will check again to deploy with mup. Thanks @edemaine!! \ud83d\ude16 . Just for info, it's working!\nThanks!. ",
    "chenmoran": "@maxmatthews Thanks.My mup.js is wrong.. ",
    "kandizzy": "I have the exact same issue at the moment, if it's figured out will you post the solution here? Thanks!\n. @ivanthemeh i managed to get this working, however i'm not exactly sure which change I made was the one to do the trick. Here's everything I did though:\n- removed PORT from meteor.env and set meteor.port to 3000\n- added a VIRTUAL_HOST variable to meteor.env with the vhost name from my nginx conf\n- upgraded this npm module locally with the changes from this PR\n- removed meteor.dockerImage and replaced it with meteor.docker which looks like this\ndocker: {\n      image: 'abernix/spaceglue:node-4.6.2-builddeps',\n      imagePort: 3000\n    }\nNow my docker container looks like this\nabernix/spaceglue:node-4.6.2-builddeps   \"/bin/sh -c ./run_...\"   About an hour ago   Up About an hour    0.0.0.0:32770->3000/tcp\nMy nginx conf looks just like the one you pasted above and it works :)\n. ",
    "melkati": "I have this issue also.\nDo you have any solution for this?\n. ",
    "znat": "Hi @WayneUong , I was wondering if you could briefly describe how you setup CD? . Thanks, it was indeed. I upgraded RAM to 2G, but now I'm getting the following error. Downgrading to 1.2.11 triggers no such error. Any idea?\n-----------------------------------STDERR-----------------------------------\n        rm: cannot remove 'current/bundle/programs/server/npm/node_modules/meteor/babel-compiler/node_modules': Directory not empty\n        rm: cannot remove 'current/bundle/programs/server/npm/node_modules/meteor/spacebars-compiler/node_modules': Directory not empty\n        -----------------------------------STDOUT-----------------------------------\n        using image\n        ----------------------------------------------------------------------------\n. It seems to be a one time error. It works now. Thanks!. Same issue here. The second app configuration is ignored. browser says host is insecure. Looking at the nginx-config only one domain appears\nEDIT:\nAfter a while, I get something more similar you with all domains without https. In my case it's now broken, I cannot reach any app. nope @guillim . I had to run apps on separate VMs. ",
    "Twisterking": "+1 for being able to use my own nginx config file!\nWhy do I need this?\nDuring downtimes or if something just goes badly wrong I would like to show a custom 502 error page instead of the standard \"bad gateway\" to show the users that there is something wrong and that the problem is being worked on. Even better would be to trigger a redirect in the nginx proxy in case of an 502 error to a predefined url.\nWill I be able to do this with this option in the future?\nbtw: big thanks to @zodern and @shadowcodex for all the hard work your guys are putting into this project!!. +1\nSame problem here!\nFresh droplet with 512MB RAM on Ubuntu 16.04 X64.\nmup.js:\nmodule.exports = {\n  servers: {\n    test: {\n      host: '111.111.111.111',\n      username: 'root',\n      pem: '~/.ssh/id_rsa'\n    }\n  },\n  meteor: {\n    name: 'myapp',\n    path: '../../app',\n    volumes: {\n      '/opt/myapp': '/files',\n      '/usr/share/zoneinfo/Europe/Vienna': '/etc/localtime:ro',\n      '/usr/share/zoneinfo': '/usr/share/zoneinfo:ro',\n      '/etc/timezone': '/etc/timezone:ro',\n    },\n    docker: {\n      image: 'abernix/meteord:base'\n    },\n    servers: {\n      test: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n      debug: true,\n      cleanAfterBuild: true,\n    },\n    env: {\n      ROOT_URL: 'https://dev.myapp.at',\n      PORT: 80,\n      NODE_ENV: 'test'\n    },\n    ssl: {\n      crt: './fullchain_dev.pem',\n      key: './privkey_dev.pem',\n      port: 443\n    },\n    deployCheckWaitTime: 45,\n    enableUploadProgressBar: false\n  },\n  mongo: {\n    oplog: false,\n    port: 27017,\n    // version: '3.4.1',\n    servers: {\n      test: {}\n    }\n  }\n};\nWhat is your guess? Maybe trying Ubuntu 14.04 instead and see if that changes anything?!. OK ... rebuilt my droplet with 14.04 x64 and now I have some new problems! \ud83d\udc4e  https://github.com/zodern/meteor-up/issues/493. @Cu4rach4 My Swap is pretty much empty, about 3.5 GB free! ;)\n@joaolboing thanks for that input! I trust you on this and integrate this and make a PR as this seems totally resonable!\nEDIT: Just saw you already created a PR! Thanks!. @zodern well kind of ... as stated in my OP there were some random errors but eventually it did finish properly yes. I got it to work by now but I really can not tell you what I did ... all these errors indeed seemed random, sometimes they do occur, sometimes they do not.. Not sure if this is of any help to you but I ended up using pm2-meteor for my worker as I don't need docker there - using my PR.. No one had this problem? No new mac users here? I there any trick I couldn't find to generate a key with the old syntax? What I did in the end to circumvent this is create a new ssh key on an old machine and copy it to my new mac. But this is not really a nice way to do it.. @charlesdagenais If I remember correctly I tried that and it still didn't work, still had some new syntax which couldn't be parsed.\n@jankapunkt So what was the exact command you used? Does it work now or are you still getting that error?. Okay so apparently this very weird error occurs in ... I have no idea when.\nIn the end I somehow fixed it by running, but I had to do it somehow twice, no idea why.\n\ndocker system prune -a\nmup setup\nmup deploy. \n",
    "mvogttech": "\nMup 1.4 supports customizing the nginx config. You can try the beta using the instructions in #870. The docs for this feature are here.\n\nAre there any updates on how to use customized Nginx images from the docker repository?\nThe reason I want a custom image/config is to be able to bundle Nginx with Google's Pagespeed Module. Is this possible?. ",
    "c314": "After doing mup setup many times , it worked!. ",
    "joaolboing": "This seems to be a docker bug.\nWhen the container is removed, docker sometimes can't disconnect the container from the network\nI run on the server:\ndocker network disconnect bridge \"AppName\" -f\nThen I can deploy normally\nWhat can be done is to update the startup script to include the command above after the 'docker rm -f AppName'. At the moment I'm not using other networks, but makes sense to me that it will occur with the other interfaces as well\nEDIT: Doing some tests with another networks\nEDIT 2: Disconnection from all the networks is needed, otherwise docker will give the error\ndocker: Error response from daemon: driver failed programming external connectivity on endpoint: Bind for 0.0.0.0:80 failed: port is already allocated.. I made the changes to disconnect from all networks now.\nDone some tests with multiple networks and everything went ok.\n. ",
    "btbjosh": "@shadowcodex Thanks for the help! I'll take a look and see what's going on.\n. Weird. My first server only shows the abernix/meteord:base image.. Just that one container. Shouldn't there be at least two containers if you're telling me there are separate containers for the nginx apps?\n. Yeah, just that one is listed. I'm redeploying now to see if I can remedy that. I was having issues with the ssl object in the mup.js file preventing the server from operating so I commented it out. Then both servers worked flawlessly without their ssl. So I'm trying to add it back, without much luck. \nI got my staging server (separate sub domain) working perfectly with the ssl generation. Not sure why these are proving to be so tricky.. ok... so I got my error now.\n```2017-02-22 23:08:47,513:ERROR:acme.challenges:256: Unable to reach http://app.countmein.online/.well-known/acme-challenge/SO05QWT_hFOn3uhKqVceO2EeWkrxnB0WM0i7Y0LAniE: (\"bad handshake: SysCallError(-1, 'Unexpected EOF')\",)\n2017-02-22 23:08:47,514:WARNING:simp_le:1303: app.countmein.online was not successfully self-verified. CA is likely to fail as well!\n2017-02-22 23:08:47,649:INFO:simp_le:1313: Generating new certificate private key\n2017-02-22 23:08:52,441:ERROR:simp_le:1271: CA marked some of the authorizations as invalid, which likely means it could not access http://example.com/.well-known/acme-challenge/X. Did you set correct path in -d example.com:path or --default_root? Is there a warning log entry about unsuccessful self-verification? Are all your domains accessible from the internet? Failing authorizations: https://acme-v01.api.letsencrypt.org/acme/authz/gsSlh9PyWi5Z5k27XdDho3-6MZj7IG9pYTtwFTOWz2o\nChallenge validation has failed, see error log.. I think I know why it's failing but I'm not sure how to fix it. I am trying to use a Digital Ocean load balancer. The load balancer has the certificate domain a record. So it points to the load balancer ip which is not the same as the two desired backend server ips that are getting set up by mup. Anyone know how to resolve this setup? Do I need to manually generate the cert? . I get this problem on my deploys too. Although I can deploy on a 1gb droplet instance just fine. Has anyone successfully gotten this to deploy to DO on a 512 instance?. Yeah, I'm only trying to do it (on a 512) for an internally used app for our small company. Up until I upgraded to meteor 1.4.x it has worked just fine (thought that was with mupx and without all the es6 stuff). I had it set to 120 at one point, which did not help. I think it actually gets done with thebcryptstuff because it goes well past this line: make: Leaving directory '/bundle/bundle/programs/server/npm/node_modules/bcrypt/build'`\nThen I get: \nx Verifying Deployment: FAILED\n\n-----------------------------------STDERR-----------------------------------\nrver/npm/node_modules/qs\nrequest@2.79.0 /bundle/bundle/programs/server/npm/node_modules/request\nstringstream@0.0.5 /bundle/bundle/programs/server/npm/node_modules/stringstream\ntough-cookie@2.3.2 /bundle/bundle/programs/server/npm/node_modules/tough-cookie\ntunnel-agent@0.4.3 /bundle/bundle/programs/server/npm/node_modules/tunnel-agent\nuuid@3.0.1 /bundle/bundle/programs/server/npm/node_modules/uuid\nssl-root-cas@1.2.3 /bundle/bundle/programs/server/npm/node_modules/ssl-root-cas\n{\n  \"meteor-dev-bundle\": \"0.0.0\",\n  \"npm\": \"3.10.10\",\n  \"ares\": \"1.10.1-DEV\",\n  \"http_parser\": \"2.7.0\",\n  \"icu\": \"56.1\",\n  \"modules\": \"46\",\n  \"node\": \"4.7.2\",\n  \"openssl\": \"1.0.2j\",\n  \"uv\": \"1.9.1\",\n  \"v8\": \"4.5.103.43\",\n  \"zlib\": \"1.2.8\"\n}\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\n=> Starting meteor app on port:80\n\n=> Redeploying previous version of the app\n\n. Ugh. I just resolved it... after googling this error: \nmup UnhandledPromiseRejectionWarning: Unhandled promise rejection\nTurns out I had my ROOT_URL not set to https and just http.. @shadowcodex Any eta on how far out we are on #496 ? Thanks for the hard work!. ",
    "ZhuQinglei": "@zodern \nafter mup stop and niginx stop,\nand mup setup with no env.port,  then mup deploy and start Working good. \nThank you so much!. ",
    "Kolhor": "The problem was right in front of the keyboard. \nFirst I deployed without SSL (for some reason). This meant that the verification mail new users got which started with \"https://\" would not work.\nWhen I told my co-developer this (who had implemented the email system) he quickly made a \"hot fix\" which would solve the problem.\nthe url which is used as a parameter in the verification-email-step would have a line of code added;\nurl.replace(\"https\", \"http\");\nDidn't really think of it... Had a replace in it! Looked good to me.\nNow this didn't really do anything...\nSpent hours looking at mup and googling mup problems when the entire problem was the code we'd written.\nLater on I changed the line of code to;\nvar res = url.replace(\"https\", \"http\");\nLater on, I added SSL (because what respectable website doesn't have SSL?)\nActually ended up changing that bit of code once more... (not that it really matters).\nIt referred to \"https://IP-ADDRESS/VERIFICATION-TOKEN\".\nHad to use \"var res = url.replace(\"IP-ADDRESS\", \"DOMAIN NAME\"), so that the web-browser wouldn't give a \"not secure site\" warning.\nWell... anyway, that's my rookie mistake. Bad code. Pretty embarrassing and sorry for creating issue where there was none.\n. ",
    "jaisharmafps": "I reinstalled meteor, and its working.\nThanks :100: . ",
    "j-jackson": "swapping meteorhacks:fast-render for staringatlights:fast-render fixed this for me.. ",
    "jasonwcfan": "Managed to fix a similar error by simply uninstalling and reinstalling mup locally (i.e. not on the server being deployed to)\nnpm -g uninstall mup\nnpm -g install mup. ",
    "Remeus": "Hi @zodern and @shadowcodex, thanks for the awesome work you guys have done. Any update on the custom nginx certificate support? It would be a real game changer.. Isn't it related to this pull request: https://github.com/zodern/meteor-up/pull/834?. Same problem here, adding the semi-colon in /opt/mup-nginx-proxy/config/nginx-default.conf allowed the proxy to finally start.. ",
    "jyoti-openair": "I'm using mupx, I updated node to 4.7.2 but the problem persisted so I updated it to 6.10.0 still same problem.. ok. I performed migration steps. Now Im getting\nError starting userland proxy: listen tcp 0.0.0.0:80: bind: address already in use.\nI have few sites hosted via nginx in port 80. How can I fix this ? Can I change the port ? Because when I change port of my existing sites, its not pointed correctly untill its port 80, so I cannot change anything out there . I have set PORT 3000 already, I'm not sure where the issue was so I tried,\npm2-meteor, now I have deployed using it\nOn Mar 6, 2017 7:54 AM, \"Jose A. Arellano Vega\" notifications@github.com\nwrote:\n\nYou can setting up the port to use on your mup.js.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/505#issuecomment-284285874,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AK6KUzLlUKDw2gesu8eSTQXGHsk3Wf2nks5ri2r0gaJpZM4MSh15\n.\n. No there is no ssl, this is my mup setup\n\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '...*',\n      username: '*',\n      // pem:\n      // password:\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\nmeteor: {\n    name: 'appName',\n    path: '/home/jyoti/git/appName/',\n    servers: {\n      one: {},\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'http://laopen.space',\n      MONGO_URL: 'mongodb://localhost/openspace',\n    },\ndocker: {\n  // change to 'kadirahq/meteord' if your app is not using Meteor 1.4\n  image: 'abernix/meteord:base',\n},\ndeployCheckWaitTime: 600,\n\n// Show progress bar while uploading bundle to server\n// You might need to disable it on CI servers\nenableUploadProgressBar: false\n\n},\n)  mongo: {\n    oplog: true,\n    port: 27017,\n    version: '3.4.1',\n    servers: {\n      one: {},\n    },\n  },\n};\n```. Hi, thanks! @zodern that was the catch, mup and PORT environment along with I had to remove node_modules and reinstall. Had to switch back to mup from pm2 as, there were mongo error could be because of less memory. Will see how it goes with mup.. ",
    "abeaudoin2013": "Hey there. I'm using mup (not mupx) and I'm still getting errors:\n[138.197.101.26]=> Starting meteor app on port:80\n[138.197.101.26]\n[138.197.101.26]/bundle/bundle/programs/server/mini-files.js:74\n[138.197.101.26]const unicodeNormalizePath = (path) => {\n[138.197.101.26]                                     ^\n[138.197.101.26]SyntaxError: Unexpected token >\n[138.197.101.26]    at Module._compile (module.js:439:25)\n[138.197.101.26]    at Object.Module._extensions..js (module.js:474:10)\n[138.197.101.26]    at Module.load (module.js:356:32)\n[138.197.101.26]    at Function.Module._load (module.js:312:12)\n[138.197.101.26]    at Module.require (module.js:364:17)\n[138.197.101.26]    at require (module.js:380:17)\n[138.197.101.26]    at Object.<anonymous> (/bundle/bundle/programs/server/boot.js:9:13)\n[138.197.101.26]    at Module._compile (module.js:456:26)\n[138.197.101.26]    at Object.Module._extensions..js (module.js:474:10)\n[138.197.101.26]    at Module.load (module.js:356:32)\nI'm using node version 6.10.0. Meteor 1.4.3.2. Do I need a different version of Node?. Yes, changed that to abernix/meteord:base, but now I'm getting this error: \n[138.197.101.26]npm ERR! Linux 4.4.0-70-generic\n[138.197.101.26]npm ERR! argv \"/opt/nodejs/bin/node\" \"/usr/bin/npm\" \"install\" \"--unsafe-perm\"\n[138.197.101.26]npm ERR! node v4.8.0\n[138.197.101.26]npm ERR! npm  v3.10.10\n[138.197.101.26]npm ERR! code ELIFECYCLE\n[138.197.101.26]npm ERR! meteor-dev-bundle@0.0.0 install: `node npm-rebuild.js`\n[138.197.101.26]npm ERR! Exit status 1\n[138.197.101.26]npm ERR! \n[138.197.101.26]npm ERR! Failed at the meteor-dev-bundle@0.0.0 install script 'node npm-rebuild.js'.\n[138.197.101.26]npm ERR! Make sure you have the latest version of node.js and npm installed.\n[138.197.101.26]npm ERR! If you do, this is most likely a problem with the meteor-dev-bundle package,\n[138.197.101.26]npm ERR! not with npm itself.\n[138.197.101.26]npm ERR! Tell the author that this fails on your system:\n[138.197.101.26]npm ERR!     node npm-rebuild.js\n[138.197.101.26]npm ERR! You can get information on how to open an issue for this project with:\n[138.197.101.26]npm ERR!     npm bugs meteor-dev-bundle\n[138.197.101.26]npm ERR! Or if that isn't available, you can get their info via:\n[138.197.101.26]npm ERR!     npm owner ls meteor-dev-bundle\n[138.197.101.26]npm ERR! There is likely additional logging output above.\n[138.197.101.26]\n[138.197.101.26]npm ERR! Please include the following file with any support request:\n[138.197.101.26]npm ERR!     /bundle/bundle/programs/server/npm-debug.log. ",
    "juliancwirko": "Could it be related to :\nFix nginx-proxy not starting on server restart\nFrom version 1.2.3 changelog? \nBecause maybe this is the case here.. Ok, it looks like two of them which runs on abernix/meteord:base (deployed with this mup) restarted (5h ago) and others which run on meteorhacks/meteord:base are fine and not restarting for months.. Also, there isn't anything special under docker logs --since 10h <container-name> just npm logs because I've deployed the site in the meantime. But it could be wrong command, I am not very experienced docker user ;) docker <container-name> logs doesn't work for me :/ . ",
    "qrobin": "deployCheckWaitTime: 60, but it just goes forever, not 60s. Sorry, it was my app issue. I tried to add CORS header \nWebApp.rawConnectHandlers.use('/', function(req, res, next) {\n   res.setHeader(\"Access-Control-Allow-Origin\", \"*\");\n   return next();\n});\nSeems it doesn't work this way. Thanks for fast response, @shadowcodex . ",
    "muninn9": "Here's what I figured out in case anyone else has this problem:\nI simply removed the buildOptions property which took care of the error message. It was silently failing because I left out servers: { one: {} } under the mongo property (see below).\nmongo: {\n    oplog: true,\n    port: 27017,\n    version: '3.4.1',\n    servers: {\n        one: {}\n    }\n}\nAfter I did this it successfully pushed the app bundle to the server.. ",
    "xinlovedong": "hi~  I hava the same problem with you.Have  you solved?. ",
    "vurumadla": "I20171005-07:19:15.685(0)?\nW20171005-07:19:15.688(0)? (STDERR) The regenerator/runtime module is deprecated; please import regenerator-runtime/runtime instead.\nW20171005-07:19:15.689(0)? (STDERR) /home/centos/.meteor/packages/meteor-tool/.1.5.2_2.fkst7p++os.linux.x86_64+web.browser+web.cordova/mt-os.linux.x86_64/dev_bundle/server-lib/node_modules/fibers/future.js:280\nW20171005-07:19:15.689(0)? (STDERR)                                             throw(ex);\nW20171005-07:19:15.690(0)? (STDERR)                                             ^\nW20171005-07:19:15.690(0)? (STDERR)\nW20171005-07:19:15.691(0)? (STDERR) TypeError: Cannot read property 'deny' of undefined\nW20171005-07:19:15.691(0)? (STDERR)     at exports.default (/home/centos/Syndicated Lending/syndicated lending/syndicate_lending_new/.meteor/local/build/programs/server/app/app.js:91154:18)\nW20171005-07:19:15.692(0)? (STDERR)     at Object. (/home/centos/Syndicated Lending/syndicated lending/syndicate_lending_new/.meteor/local/build/programs/server/app/app.js:71141:22)\nW20171005-07:19:15.692(0)? (STDERR)     at webpack_require (/home/centos/Syndicated Lending/syndicated lending/syndicate_lending_new/.meteor/local/build/programs/server/app/app.js:62689:30)\nW20171005-07:19:15.693(0)? (STDERR)     at Object.installedModules (/home/centos/Syndicated Lending/syndicated lending/syndicate_lending_new/.meteor/local/build/programs/server/app/app.js:62721:19)\nW20171005-07:19:15.693(0)? (STDERR)     at webpack_require (/home/centos/Syndicated Lending/syndicated lending/syndicate_lending_new/.meteor/local/build/programs/server/app/app.js:62689:30)\nW20171005-07:19:15.694(0)? (STDERR)     at /home/centos/Syndicated Lending/syndicated lending/syndicate_lending_new/.meteor/local/build/programs/server/app/app.js:62709:18\nW20171005-07:19:15.695(0)? (STDERR)     at meteorInstall.meteor_core.server.server.bundle.min.js (/home/centos/Syndicated Lending/syndicated lending/syndicate_lending_new/.meteor/local/build/programs/server/app/app.js:62712:10)\nW20171005-07:19:15.696(0)? (STDERR)     at fileEvaluate (packages/modules-runtime.js:333:9)\nW20171005-07:19:15.697(0)? (STDERR)     at require (packages/modules-runtime.js:228:16)\nW20171005-07:19:15.698(0)? (STDERR)     at /home/centos/Syndicated Lending/syndicated lending/syndicate_lending_new/.meteor/local/build/programs/server/app/app.js:93000:1\n=> Exited with code: 1\n. can anyone give solution to the error. ",
    "chrisbutler": "not sure why this is closed... this seems to be a real issue\nmup deploy --verbose\nBuilding App Bundle Locally\n--server-only: unknown option.\nUsage: meteor build <output path> [--debug] [--directory]\n          [--mobile-settings settings.json] [--server http://example.com:3000]. yes, i no longer get the error if i don't include that option. but it's specified as required in the minimal config. \ni was on 1.2  but i'm trying with 1.5 now. also having this issue with a brand new aws ubuntu server and the latest mup... going to try removing options from the config or something? ugh. so i found buried in the documentation this line about using a different docker image: https://github.com/zodern/meteor-up/blame/master/docs/docs.md#L114\nwould be great if this could be called out more prominently in the documentation. thanks @zodern! 1.6 support?!?! \ud83c\udf86 . started up another instance and everything deployed fine :thinking: . ",
    "iAssureIT": "Thank you for quick reply zodern! \nI was following some tutorials over internet for meteor deploy. I did install nodejs, npm and mup. Thought that should be sufficient. But now I installed meteor & mongodb on ubuntu server like \ncurl https://install.meteor.com | /bin/sh\nsudo apt-get install mongodb\nNow I tried again mup setup and mup deploy commands. Again got different type of error on deploy command. \nWhat must be causing this error? This is standard meteor app created by meteor on my development machine. Then I uploaded it on ubuntu server. \n```\nBuilding App Bundle Locally\n/home/ubuntu/.meteor/packages/meteor-tool/.1.4.3_1.194k2uz++os.linux.x86_64+web.browser+web.cordova/mt-os.linux.x86_64/dev_bundle/lib/node_modules/meteor-promise/promise_server.js:190\n      throw error;\n      ^\nError: EISDIR: illegal operation on a directory, unlink '/var/meteor/test/.meteor/local/dev_bundle'\n    at Error (native)\n    at Object.fs.unlinkSync (fs.js:932:18)\n    at exports.makeLink (/tools/cli/dev-bundle-links.js:20:8)\n    at [object Object]..extend.ensureDevBundleLink (/tools/project-context.js:1476:7)\n    at [object Object]..extend._readFile (/tools/project-context.js:1410:10)\n    at new exports.ReleaseFile (/tools/project-context.js:1360:8)\n    at /tools/cli/main.js:898:22\n=> Build Error. Check the logs printed above.\n(node:13417) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: build-error\n(node:13417) DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\n```\n. zodern, you are simply great! \nI deleted everything that started with dev_dundle (1 directory & 3 files found) in .meteor/local. \nNow 'meteor deploy' command worked successfully. \nThank you very very much, zodern! . @zodern,\nI changed the mongo port to 27017 for both apps. \nNow my mup deploy command is hanging forever. It is not responding at all. \nI thought it must be issue with something else... So I did following\nAt project's root folder\nrm -rf node_modules\nnpm cache clear\nnpm install\nAgain tried... Nothing worked.. \nThen I reinstalled Meteor by using\ncurl https://install.meteor.com/ | sh\nAgain did meteor update at project folder. Nothing is working. \nmup deploy is still hanging.  mup setup is successful.\nHow should I resolve this hanging problem? \n. It is hanging when I try to execute command of \nmup deploy\nThen it says.. \nBuilding App Bundle Locally\nAnd then it hangs forever...   It tried it 10+ times.. but everytime it is hanging. \nIdeally, some output should come after every couple of seconds, to indicate something is happening during deploy. It would be great if some progress bar is shown while \"mup deploy\" is getting executed. \nBecause, we are working on some large scale enterprise apps in Meteor. These apps may take a while to get build and deploy. Before deploy process ends, our PuTTy SSH connection is also getting timed out. \nAgain we have to login and again we have to issue mup setup  and mup deploy commands. \nAgain we face the same hanging issue. \n. Thanks @zodern ! \nI reinstalled mup 1.2.4. Also reinstalled node & npm. \nCleaned up all other PIDs related to docker. Then tried to deploy both projects again one by one. \nmup setup  (Successful for both apps)\nmup deploy --verbose   (My App1 is working fine. But 2nd App is showing error message as follows) \nApp#2 has following error\n```\n mup deploy --verbose\nBuilding App Bundle Locally\n=> Build Error. Check the logs printed above.\n(node:6447) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: build-error\n(node:6447) DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\n```\nThis is the error I am getting from beginning. \nHere is my App#2 mup.js\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '35.164.201.159',\n      username: 'ubuntu',\n      pem: '~/.ssh/iAssureIT-Ubuntu.pem',\n      // password:\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\nmeteor: {\n    name: 'musissive',\n    path: '/var/www/meteor/musissive',\n    servers: {\n      one: {},\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'http://musissive.in',\n      MONGO_URL: 'mongodb://localhost/meteor',\n      PORT: 3003,\n    },\ndocker: {\n  // change to 'kadirahq/meteord' if your app is not using Meteor 1.4\n  image: 'abernix/meteord:base',\n},\ndeployCheckWaitTime: 60,\n\n// Show progress bar while uploading bundle to server\n// You might need to disable it on CI servers\nenableUploadProgressBar: false\n\n},\nmongo: {\n    oplog: true,\n    port: 27017,\n     version: '3.4.1',\n    servers: {\n      one: {},\n    },\n  },\n};\n```\nHow to resolve this error?  I need to run multiple apps on single ubuntu server. \n. @zodern, I stopped App#1 and now wanted to see if App#2 is working individually. \nSo I issued command mup stop to close app#1. \nin app#2 folder, I did mup setup and mup deploy --verbose\nit got stuck after showing the downloading meteor-tool as follows. \nmup deploy --verbose\nBuilding App Bundle Locally\n   Downloading meteor-tool@1.4.2_7...\nIt got stuck at this place for long time... more often, we lost the connection due to timeout in PuTTy SSH connection. \nCan mup provide a progress bar at this step?\n. Yes, App#2 is working perfectly fine on Development Ubuntu environment. \nHere are the output that I am getting for mup setup & deploy commands. \nIt is failing in mup deploy step. Not understanding what is this error and how to resolve this. \n```\nubuntu@ip-172-31-19-8:/var/www/meteor/musissive/.deploy$ mup setup\nStarted TaskList: Setup Docker\n[54.218.35.182] - setup docker\n[54.218.35.182] - setup docker: SUCCESS\nStarted TaskList: Setup Meteor\n[54.218.35.182] - Setup Environment\nStarted TaskList: Setup Mongo\n[54.218.35.182] - setup environment\n[54.218.35.182] - setup environment: SUCCESS\n[54.218.35.182] - copying mongodb.conf\n[54.218.35.182] - Setup Environment: SUCCESS\n[54.218.35.182] - copying mongodb.conf: SUCCESS\nStarted TaskList: Start Mongo\n[54.218.35.182] - start mongo\n[54.218.35.182] - start mongo: SUCCESS\nNext, you should run:\n    mup deploy\nubuntu@ip-172-31-19-8:/var/www/meteor/musissive/.deploy$ mup deploy --verbose\nBuilding App Bundle Locally\n   Minifying app code\n=> Build Error. Check the logs printed above.\nError: build-error\n    at ChildProcess. (/usr/lib/node_modules/mup/lib/modules/meteor/build.js:46:16)\n    at emitTwo (events.js:106:13)\n    at ChildProcess.emit (events.js:194:7)\n    at maybeClose (internal/child_process.js:899:16)\n    at Process.ChildProcess._handle.onexit (internal/child_process.js:226:5)\n```. @zodern, the important part to note is that when I run the app with meteor command, I can see the app working fine on my url. \nBut when mup deploy command is issued, it is failing with above error. . @zodern, GOOD NEWS!\nAll the above errors have gone, as soon as I increased the RAM size from 1GB to 4GB. \nNow MUP DEPLOY is working very fine. \nThank you... Thank you... Thank you very much for all your help!. any luck?. ",
    "trsh": "MONGO_URL=mongodb://localhost/meteor stopped working form me, when I introduced accounts-base meteor package. It requires DB. So I need to setup one now manually? I tough meteor does it for you.. OK. I'll try and report back.. No mango settings are required in latest release. @Joeblockmark the whole stack is similar to this -> https://github.com/zodern/meteor-up/issues/626 ?. @tomtom87 and other\nMy problem was, that the previous instance was deployed using old (legacy) version of MUP. So, \na) first I needed to remove it from the server (did it by this instructions https://stackoverflow.com/questions/30458200/how-do-i-remove-my-deployment-instances-created-using-meteor-up)\nb) Then mup setup & deploy went fine.\n. I guess I can close this. . ",
    "cpury": "I'm also getting 500s from nginx, but mup proxy logs doesn't help me much:\nGET / HTTP/1.1\" 500 595 \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36\"\nI checked the generated nginx config and it seems to be hard-wired to return 500s?\nserver {\n    server_name server.com;\n    listen 80 ;\n    access_log /var/log/nginx/access.log vhost;\n    include /etc/nginx/vhost.d/server.com;\n    location / {\n        proxy_pass http://server.com;\n    }\n}\nserver {\n    server_name server.com;\n    listen 443 ssl http2 ;\n    access_log /var/log/nginx/access.log vhost;\n    return 500;\n    ssl_certificate /etc/nginx/certs/default.crt;\n    ssl_certificate_key /etc/nginx/certs/default.key;\n}\nAny ideas?. Note: This only happens when I add multiple domains to proxy.domains, e.g. 'server1.com,server2.com'. It works fine with just a single one, e.g. server.com. It now also happens with only a single URL :(. For anyone trying this: I created a new .deploy directory and a new instance with exactly the same config. Now it works, and the nginx-config doesn't have those weird return 500; entries... Seems like a bug in MUP to me.. @suezzo I didn't find a fix, but have since switched to https://github.com/zodern/mup-aws-beanstalk which works great so far. ",
    "tomtom87": "Also getting this on AWS .. https://github.com/zodern/meteor-up/issues/565. I am getting a 503 on AWS, made a ticket here https://github.com/zodern/meteor-up/issues/565. seems its briked for everyone with ssl otherwise its working fine\nSent from my iPhone\n\nOn 5 Apr 2017, at 20:06, B\u00fcnyamin Benny Genel notifications@github.com wrote:\n@zodern I'm having the same issue with letsencrypt\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub, or mute the thread.\n{\"api_version\":\"1.0\",\"publisher\":{\"api_key\":\"05dde50f1d1a384dd78767c55493e4bb\",\"name\":\"GitHub\"},\"entity\":{\"external_key\":\"github/zodern/meteor-up\",\"title\":\"zodern/meteor-up\",\"subtitle\":\"GitHub repository\",\"main_image_url\":\"https://cloud.githubusercontent.com/assets/143418/17495839/a5054eac-5d88-11e6-95fc-7290892c7bb5.png\",\"avatar_image_url\":\"https://cloud.githubusercontent.com/assets/143418/15842166/7c72db34-2c0b-11e6-9aed-b52498112777.png\",\"action\":{\"name\":\"Open in GitHub\",\"url\":\"https://github.com/zodern/meteor-up\"}},\"updates\":{\"snippets\":[{\"icon\":\"PERSON\",\"message\":\"@bennygenel in #549: @zodern I'm having the same issue with letsencrypt\"}],\"action\":{\"name\":\"View Issue\",\"url\":\"https://github.com/zodern/meteor-up/issues/549#issuecomment-291855171\"}}}\n. I have the 503 error with load balancer and no SSL certificate (because its on AWS and the load balancer has the SSL on it) so I just need HTTPS to be enabled. I made a ticket about it https://github.com/zodern/meteor-up/issues/565. @zodern right, I see! Looking forward to the fix :). +1 having this issue cannot deploy new app to production now... will try mup 1.2.4 see if this fixes it. @nadeemja ahhh ok I will try this.. 1.2.4 is working fine by the way. @bennygenel yes sure thing, feel free to give me a private message about that. I hope we can get the SSL working with this soon. @bennygenel  have emailed you about AWS. > @tomtom87 I want to make sure I understand your situation: ELB is handling ssl, and you want to use the force-ssl pacakge. Is that correct?\n\n@zodern exactly :)\nI am still getting the error without the meteor.ssl part of the config though. Please let me know when you update, very thankful for this mate. @idanwe  @santteegt  Hi guys, did you manage to get it working on AWS? It's really pretty long winded.\nYou have to setup an EB load balancer then deploy to the instance, as long as your DNS is at the AWS Route 53 you can use their provided SSL. Still I am unable to get this to work with Meteor in the new version sadly. \nWorked perfect before... wish it still did. I also had similar errors when trying with a beta screening url - ended up resorting to using a nginx setup for that. Couldnt get mupx working...\n\nOn 9 Jul 2017, at 03:53, Avishaan notifications@github.com wrote:\nHas anyone had luck deploying mupx where the load balancer has a valid certificate but deploying to mup without a certificate.\nI want to then add a CNAME record to the load balancer to get something like beta.company.com so that when a user goes to beta.company.com it goes to the load balancer. I have everything setup AFAIK such that when I go to the load balancer address it seems to be working with the secure connection but when I go to beta.company.com it says\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub, or mute the thread.\n{\"api_version\":\"1.0\",\"publisher\":{\"api_key\":\"05dde50f1d1a384dd78767c55493e4bb\",\"name\":\"GitHub\"},\"entity\":{\"external_key\":\"github/zodern/meteor-up\",\"title\":\"zodern/meteor-up\",\"subtitle\":\"GitHub repository\",\"main_image_url\":\"https://cloud.githubusercontent.com/assets/143418/17495839/a5054eac-5d88-11e6-95fc-7290892c7bb5.png\",\"avatar_image_url\":\"https://cloud.githubusercontent.com/assets/143418/15842166/7c72db34-2c0b-11e6-9aed-b52498112777.png\",\"action\":{\"name\":\"Open in GitHub\",\"url\":\"https://github.com/zodern/meteor-up\"}},\"updates\":{\"snippets\":[{\"icon\":\"PERSON\",\"message\":\"@codeHatcher in #565: Has anyone had luck deploying mupx where the load balancer has a valid certificate but deploying to mup without a certificate. \\r\\n\\r\\nI want to then add a CNAME record to the load balancer to get something like beta.company.com so that when a user goes to beta.company.com it goes to the load balancer. I have everything setup AFAIK such that when I go to the load balancer address it seems to be working with the secure connection but when I go to beta.company.com it says \\r\\n\\r\\n\"}],\"action\":{\"name\":\"View Issue\",\"url\":\"https://github.com/zodern/meteor-up/issues/565#issuecomment-313880418\"}}}\n. @elie222 it's only working in the old version, the latest one is broken. Just down grade everything to back in May, you are forced to use the SSL provided by AWS and in-turn their DNS which is a dependency of using the SSL. That was the only way I could get mup working. @thirtyfoursoft try using the SSL from Route 53 mate. @malikperang what is the purpose? . Got this issues also +1\n. @mroftalp can you try npm uninstall mup then install again with npm i -g mup and check version again . @PolGuixe what size EC2 instance are you using, I had similar issues until using a medium . @PolGuixe I have to use t2.medium to get it to work. just get strange errors like yours from docker otherwise. @PolGuixe yes run the medium size and you must set a swap file . @WayneUong please can you confirm the ssh configuration is working by trying ssh -vvv user@host and ensuring you have access as that user you specified in the mup.js . @sethjgore  I am trying to get this working, thanks for your suggestion.\n\nSadly I reach the point where, although there was no error the verify deployment stage fails silently and the app is not running.\nReally a shame this project is so broken now, used to work great. Oh nice man i love it when stuff fixes itself! Lets hope i get the same luck when i try!\n\nOn 19 Sep 2017, at 08:55, enzo - Eduardo Garcia notifications@github.com wrote:\nI have Meteor 1.5.2 in my local and despite the recommendation the image of docker abernix/meteord:base works perfectly\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub, or mute the thread.\n. +1 Getting same error. Glad I am not alone. @zodern  I am getting an issue with let's encrypt. The server doesn't ever verify although all other stages pass to completion.. +1 doesnt work with force-ssl either by the way @zodern\n\nSent from my iPhone\n\nOn 4 Jun 2017, at 17:55, Ovi Indrei notifications@github.com wrote:\n@zodern thanks. Unfortunately this still doesn't work when using jabbslad:basic-auth, I get the same curl error as in first post.\nI guess for my use case and other use cases could be really helpful to be able to specify in the mup settings the HTTP status codes that should be treated as valid deployment. If you are willing to have this type of functionality implemented, I could offer my time to create a pull request. Let me know.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub, or mute the thread.\n{\"api_version\":\"1.0\",\"publisher\":{\"api_key\":\"05dde50f1d1a384dd78767c55493e4bb\",\"name\":\"GitHub\"},\"entity\":{\"external_key\":\"github/zodern/meteor-up\",\"title\":\"zodern/meteor-up\",\"subtitle\":\"GitHub repository\",\"main_image_url\":\"https://cloud.githubusercontent.com/assets/143418/17495839/a5054eac-5d88-11e6-95fc-7290892c7bb5.png\",\"avatar_image_url\":\"https://cloud.githubusercontent.com/assets/143418/15842166/7c72db34-2c0b-11e6-9aed-b52498112777.png\",\"action\":{\"name\":\"Open in GitHub\",\"url\":\"https://github.com/zodern/meteor-up\"}},\"updates\":{\"snippets\":[{\"icon\":\"PERSON\",\"message\":\"@ovidyou in #618: @zodern thanks. Unfortunately this still doesn't work when using jabbslad:basic-auth, I get the same curl error as in first post.\\r\\n\\r\\nI guess for my use case and other use cases could be really helpful to be able to specify in the mup settings the HTTP status codes that should be treated as valid deployment. If you are willing to have this type of functionality implemented, I could offer my time to create a pull request. Let me know.\"}],\"action\":{\"name\":\"View Issue\",\"url\":\"https://github.com/zodern/meteor-up/issues/618#issuecomment-306032930\"}}}\n. @trsh  have you run the mup setup and mup deploy stages first?. Use Route 53, not letsencrypt and should be working. \n",
    "fullhdpixel": "Also, any communication with the docker container doesnt pan out:\n```\nroot@ubuntu-512mb-ams2-01:~# docker stop c9d94851f0928b64bc8a379df6c531099679c350eca8ca4c92077f49c9ed8a46\nError response from daemon: Cannot stop container c9d94851f0928b64bc8a379df6c531099679c350eca8ca4c92077f49c9ed8a46: Cannot kill container \nc9d94851f0928b64bc8a379df6c531099679c350eca8ca4c92077f49c9ed8a46: rpc error: code = 14 desc = grpc: the connection is unavailable\nroot@ubuntu-512mb-ams2-01:~#\n```\n. @zodern Thank you! This worked.. thanks @FinnFrotscher, but the output directory is empty\nDatabase name is myroutes, when i do \n```\nmongodump -d myroutes\nconnected to: 127.0.0.1\n2017-04-09T14:08:03.889+0000 DATABASE: myroutes  to     dump/myroutes\n```\nFilezilla shows an empty directory in dump/myroutes. Port is default and collection is not specified, I need to backup all the data.. Im connecting to the mongo db with:\ndocker exec -it mongodb mongo myroutes\nthen \n\nshow dbs\n\nreturns the correct databases (admin, local, myroutes). I cannot back up though with the command you specified (mongodump -d myroutes). yes this works! Thanks @FinnFrotscher . @zodern I can see the container I created 3 months ago. What should I do next?\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                        NAMES\n6c233e721193        mongo:3.4.1         \"/entrypoint.sh mo...\"   3 months ago        Up 2 minutes        127.0.0.1:27017->27017/tcp   mongodb\n. Okay, i tried killing the container and then redeploying. This does not help sadly. Same error:\ndocker: Error response from daemon: driver failed programming external connectivity on endpoint myroutes (353e0cf3ad2f1c498349db93c4925e277736f08520ca9dbbad293317e3307d94): Error starting userland proxy: listen tcp 0.0.0.0:80: bind: address already in use.\n. Ok thanks, I can see nginx is running:\ntcp        0      0 0.0.0.0:80              0.0.0.0:               LISTEN      5137/nginx -g daemo\ntcp6       0      0 :::80                   :::                    LISTEN      5137/nginx -g daemo\nI used sudo fuser -k 80/tcp to stop it, but its not helping. Can you please point out what I have to do to get it working?. After redeploying an older version of the app while making sure nothing was running on port 80 it finally worked. Thanks @zodern for the help. Seems like this causes many issues on my server, because the app is not online after pushing a new update.. Figured it out\ndocker run --rm  --link mongodb:mongo    -v /root:/appname  mongo  bash   -c 'mongorestore --host $MONGO_PORT_27017_TCP_ADDR appname/dump/appname -d <APPNAME>'. I just moved to a new droplet due to Digitalocean's new droplet sizes. Which means I can do with the 5$ droplet instead of the 10$.\nHowever I want to restore my backed up data on the new droplet, but it doesn't work using version 1.3.7. Previously I used 1.2.2 if I can recall correctly.\nSo I now have a brand new server which I did mup setup and mup deploy on. Now trying to restore the backup it doesnt work.\ndocker run --rm  --link mongodb:mongo -v /root:/myroutes mongo bash -c 'mongorestore --host $MONGO_PORT_27017_TCP_ADDR myroutes -d myroutes'\nmup.js\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: '',\n      username: '',\n      password: ''\n    }\n  },\nmeteor: {\n    name: 'myroutes',\n    path: '../myroutes',\n    servers: {\n      one: {},\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'https://myroutes.io',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n    ssl: {\n      crt: './myroutes_io.crt', // this is a bundle of certificates\n      key: './private.key', // this is the private key of the certificate\n      port: 443 // 443 is the default value and it's the standard HTTPS port\n    },\n    dockerImage: 'abernix/meteord:node-8.4.0-base',\n    deployCheckWaitTime: 60,\n    enableUploadProgressBar: true\n  },\nmongo: {\n    port: 27017,\n    version: '3.4.1',\n    servers: {\n      one: {}\n    }\n  }\n};\n```. Finally fixed:\ndocker run --rm --link mongodb:mongo -v /root/myroutes:/myroutes mongo bash -c 'mongorestore --host $MONGO_PORT_27017_TCP_ADDR ./myroutes -d myroutes'. mup.js\nmodule.exports = {\n  servers: {\n    one: {\n      host: '146.185.158.94', //myroutes.io\n      username: '',\n      password: ''\n    }\n  },\n  meteor: {\n    name: 'myroutes',\n    path: '../myroutes',\n    servers: {\n      one: {},\n    },\n    buildOptions: {\n      serverOnly: true,\n    },\n    env: {\n      ROOT_URL: 'https://myroutes.io',\n      MONGO_URL: 'mongodb://localhost/meteor',\n    },\n    ssl: {\n      crt: './myroutes_io.crt', // this is a bundle of certificates\n      key: './private.key', // this is the private key of the certificate\n      port: 443 // 443 is the default value and it's the standard HTTPS port\n    },\n    dockerImage: 'abernix/meteord:base',\n    deployCheckWaitTime: 60,\n    enableUploadProgressBar: true\n  },\n  mongo: {\n    oplog: true,\n    port: 27017,\n    version: '3.4.1',\n    servers: {\n      one: {},\n    },\n  },\n};. Mup setup also returns an error:\ndocker: Error response from daemon: Conflict. The container name \"/myroutes-dummy-http-server-for-ssl-check\" is already in use by container 3cd78b081f65b945a7d2c1b69046204c721f92c9cbe3a72fa6e314dda1c7653b. You have to remove (or rename) that container to be able to reuse that name..\nSee 'docker run --help'.\ndocker: Error response from daemon: Cannot link to a non running container: /myroutes-dummy-http-server-for-ssl-check AS /cranky_poitras/backend.\ntime=\"2017-09-09T19:55:02Z\" level=error msg=\"error getting events from daemon: context canceled\"\n\n. Interested in this as well. . Yes the css is in the file, unfortunately it was not compiled correctly. There was invalid scss in the website. So it was bundled in the app , but the invalid css just didn't work. But that makes me wonder why it worked locally.\nThanks @zodern. This was the invalid generated css\n```\n.leaflet-control-attribution {\n  pointer-events: none !important a;\n  pointer-events-font-size: 11px;\n  pointer-events-pointer-events: none;\n}\n```\nthe origin (not there are no ;):\n.leaflet-control-attribution {\n  pointer-events: none !important\n  a {\n    font-size: 11px;\n    pointer-events: none\n  }\n}. ",
    "thsowers": "Sure! I'll give it a shot this week and let you know how it goes. Hey I'm sorry I let this completely get away from me, but I wasn't successful in trying to get your suggestion working. I notice a lot of the times when I pipe something to bash it's still being run in ZSH, but maybe someone with more experience could handle this.\nIn the interim, would you consider merging this PR so that mup can be used on systems with ZSH as the default shell? Of course, I understand your desire for a more \"one-size-fits-all\" solution. Have run into same error twice when deploying with an upgraded version of mup, I fixed by rebuilding the server image on Digital Ocean. I cannot say for certain if this is the cause, but I have been experiencing slower deployment times as well (Delay at \"Preparing Bundle\") since I switched to the abernix/meteord:node-8.4.0-base image. ",
    "mokaid": "Hello \n@zodern \nUnder the path  : \ncurrent/bundle/programs/server/npm/node_modules/sshpk\nI did try the image you suggested and checked the packages.json file of sshpk and by default it looks like that :\n  \"bin\": {\n    \"sshpk-conv\": \"bin/sshpk-conv\",\n    \"sshpk-sign\": \"bin/sshpk-sign\",\n    \"sshpk-verify\": \"bin/sshpk-verify\"\n  },\nbut still i am facing the same problem \nI found the same package under the following path \ncurrent/bundle/programs/server/npm/node_modules/meteor/npm-container/node_modules/sshpk\n I tried to make the slashes issue , but the weird thing is that , after i update the package.json file . it returns back to the double back slashes by itself !!!. ",
    "emik": "Am also getting this error when verifying deployment from Windows to an Ubuntu 16.04 server. Tried abernix/meteord:binbuild and no difference.. ",
    "romiohasan": "Also having this same issue - Verifying Deployment Failed.\nTried abernix/meteord:binbuild but no difference.\nUsing MUP from win10 and deploying to Ubuntu 16.04 and METEOR@1.5\nnpm ERR! enoent ENOENT: no such file or directory, chmod '/bundle/bundle/programs/server/npm/node_modules/sshpk/bin\\sshpk-conv'. I really hope someone gives a fix soon for windows.\n(as a temporary solution, I just deployed from my Ubuntu local VM running on windows). ",
    "mklueh": "I have the same issue, but while using meteor-launchpad. It came out of the sudden and only occurs in a test project I\u00b4ve created to figure everything out. Any news about that?\nEdit: I could solve it by removing the \"mobile-experience\" package. This only happens with a separate user I\u00b4ve created for my application. With my main user it works. ",
    "stephen-mi11er": "I am also having the same issue when I deploy Meteor 1.5.2 from a Windows 10 machine to Galaxy.  I even updated to Meteor beta 1.6.27 to check if they implemented a bug fix for this but I get the same issue.\nI get the following error: \nbcrypt@1.0.3 install /app/bundle/programs/server/npm/node_modules/bcrypt\nnode-pre-gyp install --fallback-to-build\n[bcrypt] Success: \"/app/bundle/programs/server/npm/node_modules/bcrypt/lib/binding/bcrypt_lib.node\" is installed via remote\nnpm ERR! path /app/bundle/programs/server/npm/node_modules/sshpk/bin\\sshpk-conv\nnpm ERR! code ENOENT\nnpm ERR! errno -2\nnpm ERR! syscall chmod\nnpm ERR! enoent ENOENT: no such file or directory, chmod '/app/bundle/programs/server/npm/node_modules/sshpk/bin\\sshpk-conv'\nnpm ERR! enoent This is most likely not a problem with npm itself\nnpm ERR! enoent and is related to npm not being able to find a file.\nERR! enoent\nThe only way I can resolve this annoying error is to remove the bcrypt reference from my project. \n@zodern the mup plugin unfortunately didn't work for me. @zodern this is the only log that I seen in the build:\nmup-fix-bin-paths@0.1.0 /app/bundle/programs/server/npm/node_modules/mup-fix-bin-paths\nMaybe I didn't implement correctly?. I'll try again and get back to you. . @zodern I can confirm that I was using mup incorrectly after re-reading the documentation. I'll get back to you in a couple days since my side project has to compete with my day job. . @zodern after reading more of the documentation from meteor and mup I've determined that there isn't a need to use mup since I am deploying to Meteor Galaxy.  From my understanding mup is better utilized for hosts where Meteor isn't directly supported. Unless I read otherwise I won't be using mup to deploy to Galaxy. At this point I'm just gonna have to wait until Meteor Galaxy fixes the bug in their deployment code or switch to another service and use mup. . ",
    "kishorvaghani": "@zodern : mup was not working with 1 GB ram of EC2 ubuntu instance, i was able to test https when i used new EC2 instance with 2 GB RAM . it requires minimum of 2 GB RAM. . This was not working with 1 GB ram in EC2 ubuntu instance, i was able to test https when i used new EC2 instance with 2 GB RAM . it requires minimum of 2 GB ram. . Hello Guys, i am having a cmake native binary dependency issue in ghost-script package. ghost-script needs cmake as dependancy . Please help me to fix the issue. is it about to fork docker container and install cmake into the docker container? \nError is \"CMake executable is not found\", here is the error log by : mup deploy --verbose\n```\n\nghostscript-js@1.1.4 postinstall /built_app/programs/server/npm/node_modules/ghostscript-js\ncmake-js compile\n\ninfo TOOL Using Unix Makefiles generator.\ninfo TOOL Using c++11 compiler standard.\ninfo DIST Downloading distribution files.\nhttp DIST       - http://nodejs.org/dist/v4.8.3/SHASUMS256.txt\nhttp DIST       - http://nodejs.org/dist/v4.8.3/node-v4.8.3-headers.tar.gz\ninfo REP Build has been failed, trying to do a full rebuild.\nERR! OMG CMake executable is not found. Please use your system's package manager to install it, or you can get installers from there: http://cmake.org.\nnpm ERR! Linux 4.4.0-1022-aws\nnpm ERR! argv \"/opt/nodejs/bin/node\" \"/opt/nodejs/bin/npm\" \"rebuild\" \"--update-binary\"\nnpm ERR! node v4.8.3\nnpm ERR! npm  v3.10.10\nnpm ERR! code ELIFECYCLE\nnpm ERR! ghostscript-js@1.1.4 postinstall: cmake-js compile\nnpm ERR! Exit status 1\nnpm ERR!\nnpm ERR! Failed at the ghostscript-js@1.1.4 postinstall script 'cmake-js compile'.\nnpm ERR! Make sure you have the latest version of node.js and npm installed.\nnpm ERR! If you do, this is most likely a problem with the ghostscript-js package,\nnpm ERR! not with npm itself.\nnpm ERR! Tell the author that this fails on your system:\nnpm ERR!     cmake-js compile\nnpm ERR! You can get information on how to open an issue for this project with:\nnpm ERR!     npm bugs ghostscript-js\nnpm ERR! Or if that isn't available, you can get their info via:\nnpm ERR!     npm owner ls ghostscript-js\nnpm ERR! There is likely additional logging output above.\nnpm ERR! Please include the following file with any support request:\nnpm ERR!     /built_app/programs/server/npm/npm-debug.log\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\nnpm ERR! Linux 4.4.0-1022-aws\nnpm ERR! argv \"/opt/nodejs/bin/node\" \"/usr/bin/npm\" \"install\" \"--unsafe-perm\"\nnpm ERR! node v4.8.3\nnpm ERR! npm  v3.10.10\nnpm ERR! code ELIFECYCLE\nnpm ERR! meteor-dev-bundle@0.0.0 install: node npm-rebuild.js\nnpm ERR! Exit status 1\nnpm ERR!\nnpm ERR! Failed at the meteor-dev-bundle@0.0.0 install script 'node npm-rebuild.js'.\nnpm ERR! Make sure you have the latest version of node.js and npm installed.\nnpm ERR! If you do, this is most likely a problem with the meteor-dev-bundle package,\nnpm ERR! not with npm itself.\nnpm ERR! Tell the author that this fails on your system:\nnpm ERR!     node npm-rebuild.js\nnpm ERR! You can get information on how to open an issue for this project with:\nnpm ERR!     npm bugs meteor-dev-bundle\nnpm ERR! Or if that isn't available, you can get their info via:\nnpm ERR!     npm owner ls meteor-dev-bundle\nnpm ERR! There is likely additional logging output above.\nnpm ERR! Please include the following file with any support request:\nnpm ERR!     /built_app/programs/server/npm-debug.log\nThe command '/bin/sh -c cd  /built_app/programs/server &&     npm install --unsafe-perm' returned a non-zero code: 1\nError response from daemon: No such container: app\nError: failed to start containers: app\n[18.220.88.220] x Prepare Bundle: FAILED\n    -----------------------------------STDERR-----------------------------------\n    Error response from daemon: No such container: app\n    The command '/bin/sh -c cd  /built_app/programs/server &&     npm install --unsafe-perm' returned a non-zero code: 1\n    Error response from daemon: No such container: app\n    Error: failed to start containers: app\n    -----------------------------------STDOUT-----------------------------------\n     \"/usr/bin/npm\" \"install\" \"--unsafe-perm\"\n    npm ERR! node v4.8.3\n    npm ERR! npm  v3.10.10\n    npm ERR! code ELIFECYCLE\n    npm ERR! meteor-dev-bundle@0.0.0 install: `node npm-rebuild.js`\n    npm ERR! Exit status 1\n    npm ERR!\n    npm ERR! Failed at the meteor-dev-bundle@0.0.0 install script 'node npm-rebuild.js'.\n    npm ERR! Make sure you have the latest version of node.js and npm installed.\n    npm ERR! If you do, this is most likely a problem with the meteor-dev-bundle package,\n    npm ERR! not with npm itself.\n    npm ERR! Tell the author that this fails on your system:\n    npm ERR!     node npm-rebuild.js\n    npm ERR! You can get information on how to open an issue for this project with:\n    npm ERR!     npm bugs meteor-dev-bundle\n    npm ERR! Or if that isn't available, you can get their info via:\n    npm ERR!     npm owner ls meteor-dev-bundle\n    npm ERR! There is likely additional logging output above.\n\n    npm ERR! Please include the following file with any support request:\n    npm ERR!     /built_app/programs/server/npm-debug.log\n\n. @zodern @ken4ward , cmake issue was having with ghostscript.js npm package, because ghostscript.js package is compiled on ubuntu. here we have a different os a its a debian, i have used native binary ghostscript installation. it is working fine. . @elie222 , yes i am using it in my project \nim my package.json \n \"bcrypt\": \"^1.0.2\",\n. @ken4ward , i am not sure which would perform better, but meteord having debian:jessie which is debian OS. . ",
    "tanutapi": "You need to dump out your database from local development and restore it into your production server.. ",
    "maxlibin": "sorry, the problem is program getting bigger and bigger so deploy failed.. host and domain using my domains not shown here.\n```module.exports = {\n  servers: {\n    one: {\n      // TODO: set host address, username, and authentication method\n      host: '...',\n      username: 'maxli',\n      pem: '/Users/max/.ssh/id_rsa',\n      // or neither for authenticate from ssh-agent\n    }\n  },\napp: {\n    // TODO: change app name and path\n    name: 'mysite',\n    path: '../',\nservers: {\n  one: {},\n},\n\nbuildOptions: {\n  serverOnly: true,\n},\n\nenv: {\n  // TODO: Change to your app's url\n  // If you are using ssl, it needs to start with https://\n  ROOT_URL: 'https://mysite.com',\n  MONGO_URL: 'mongodb://localhost/meteor',\n},\n\nssl: { // (optional)\n  // Enables let's encrypt (optional)\n  // autogenerate: {\n  //   email: 'email.address@domain.com',\n  //   // comma separated list of domains\n  //   domains: 'website.com,www.website.com'\n  // }\n  crt: './t.crt', // this is a bundle of certificates\n  key: './t.key', // this is the private key of the certificate\n  port: 443 // 443 is the default value and it's the standard HTTPS port\n},\n\ndeployCheckWaitTime: 180,\nenableUploadProgressBar: true,\n\ndocker: {\n  // change to 'kadirahq/meteord' if your app is using Meteor 1.3 or older\n  //image: 'abernix/meteord:base',\n  image: 'abernix/meteord:node-8.4.0-base'\n},\n\n// Show progress bar while uploading bundle to server\n// You might need to disable it on CI servers\nenableUploadProgressBar: true\n\n},\nmongo: {\n    version: '3.4.1',\n    servers: {\n      one: {}\n    }\n  }\n};. here's the new problem now.\n```\n-----------------------------------STDERR-----------------------------------\n    built_app/programs/server/npm/node_modules/react/react.js:3:18)\n        at Module._compile (module.js:573:30)\n        at Object.Module._extensions..js (module.js:584:10)\n        at Module.load (module.js:507:32)\n        at tryModuleLoad (module.js:470:12)\n        at Function.Module._load (module.js:462:3)\n    => Starting meteor app on port:80\n    /built_app/programs/server/node_modules/fibers/future.js:280\n                            throw(ex);\n                            ^\nError: Cannot find module './lib/React'\n    at Function.Module._resolveFilename (module.js:489:15)\n    at Function.Module._load (module.js:439:25)\n    at Module.require (module.js:517:17)\n    at require (internal/module.js:11:18)\n    at Object.<anonymous> (/built_app/programs/server/npm/node_modules/react/react.js:3:18)\n    at Module._compile (module.js:573:30)\n    at Object.Module._extensions..js (module.js:584:10)\n    at Module.load (module.js:507:32)\n    at tryModuleLoad (module.js:470:12)\n    at Function.Module._load (module.js:462:3)\n\n=> Redeploying previous version of the app\n\n-----------------------------------STDOUT-----------------------------------\n\nTo see more logs type 'mup logs --tail=100'\n\n----------------------------------------------------------------------------. ok finally works now, i have remove my node_modules and meteor npm install..\n",
    "lc3t35": "@maxlibin could you be more precise ? why is this related to meteor-up ? . @WayneUong can you please give an example of truncated log ? I didn't find any limitation in the mup logs command. @rohithb can you please give a longer extract of mup logs so we can look what is surrounding the Error ? and your mup.js ?. Same for me but only with proxy option, pass if I comment proxy (which does not setup proxy)\n````\nmup setup --settings settings-staging.json \nStarted TaskList: Setup Docker\n[@] - Setup Docker\n[@] - Setup Docker: SUCCESS\nStarted TaskList: Setup Meteor\n[@] - Setup Environment\n[@] - Setup Environment: SUCCESS\nStarted TaskList: Setup proxy\n[@] - Setup Environment\n[@] - Setup Environment: SUCCESS\n[@] - Pushing the Startup Script\n[@] - Pushing the Startup Script: SUCCESS\n[@] - Pushing Nginx Config\n[@] - Pushing Nginx Config: SUCCESS\n[@] - Cleaning Up SSL Certificates\nevents.js:163\n      throw er; // Unhandled 'error' event\n      ^\nError: connect ECONNREFUSED @:22\n    at Object.exports._errnoException (util.js:1050:11)\n    at exports._exceptionWithHostPort (util.js:1073:20)\n    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1093:14)\nIf I remove proxy option\nStarted TaskList: Setup Docker\n[@] - Setup Docker\n[@] - Setup Docker: SUCCESS\nStarted TaskList: Setup Meteor\n[@] - Setup Environment\n[@] - Setup Environment: SUCCESS\nStarted TaskList: Setup Mongo\n[@] - Setup Environment\n[@] - Setup Environment: SUCCESS\n[@] - Copying mongodb.conf\n[@] - Copying mongodb.conf: SUCCESS\nStarted TaskList: Start Mongo\n[@] - Start Mongo\n[@] - Start Mongo: SUCCESS\nNext, you should run:\n    mup deploy\nHere is proxy option in mup.js\n//  proxy: {\n//    domains: 'x.y.z',\n//    ssl: {\n//      letsEncryptEmail: 'a@b.c',\n//    }\n//  }\n. Workaround :\n1) remove proxy from config and deploy\n2) mup deploy --settings settings-staging.json\n3) add proxy in config file and setup proxy only\nmup proxy setup\nStarted TaskList: Setup proxy\n[@] - Setup Environment\n[@] - Setup Environment: SUCCESS\n[@] - Pushing the Startup Script\n[@] - Pushing the Startup Script: SUCCESS\n[@] - Pushing Nginx Config\n[@] - Pushing Nginx Config: SUCCESS\n[@] - Cleaning Up SSL Certificates\n[@] - Cleaning Up SSL Certificates: SUCCESS\nStarted TaskList: Start proxy\n[@] - Start proxy\n[@] - Start proxy: SUCCESS\n5) mup reconfig --settings settings-staging.json\nStarted TaskList: Configuring App\n[@] - Pushing the Startup Script\n[@] - Pushing the Startup Script: SUCCESS\n[@] - Sending Environment Variables\n[@] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[@] - Start Meteor\n[@] - Start Meteor: SUCCESS\n[@] - Verifying Deployment\n[@] - Verifying Deployment: SUCCESS\nFor information mup proxy status fails too\nmup status\n=> Servers\n  - @: Ubuntu 16.04\n=> Docker Status\n - @: 17.05.0-ce Running\n=> Meteor Status\n - @: running \n    Created at 2018-03-14T23:14:42.482710285Z\n    Restarted 0 times\n    ENV: \n     - ROOT_URL=https:// ....\n....\n - NODE_VERSION=8.4.0\n    Exposed Ports:\n     - 80/tcp\n    App available through reverse proxy\n     - Available in app's docker container: true\nError: connect ECONNREFUSED @:22\n    at Object.exports._errnoException (util.js:1050:11)\n    at exports._exceptionWithHostPort (util.js:1073:20)\n    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1093:14)\n. Hi, any news on that issue ?. It seems that the configuration of the server and especially ufw could be the cause of this.\nI've setup the server with this guide : https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-ubuntu-16-04\nThen stopped nginx and apply\n% mup reconfig --config ... --settings ...\nStarted TaskList: Configuring App\n[x] - Pushing the Startup Script\n[x] - Pushing the Startup Script: SUCCESS\n[x] - Sending Environment Variables\n[x6] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[x] - Start Meteor\n[x] - Start Meteor: SUCCESS\n[x] - Verifying Deployment\n[x] - Verifying Deployment: SUCCESS\n% mup proxy reconfig-shared --config ... --settings ...\nStarted TaskList: Configuring Proxy's Shared Settings\n[x] - Sending shared variables\n[x] - Sending shared variables: SUCCESS\n[x] - Sending proxy environment variables\n[x] - Sending proxy environment variables: SUCCESS\n[x] - Sending let's encrypt environment variables\n[x] - Sending let's encrypt environment variables: SUCCESS\n[x] - Sending nginx config\n[x] - Sending nginx config: SUCCESS\nStarted TaskList: Start proxy\n[x] - Start proxy\n[x] - Start proxy: SUCCESS\n% mup proxy status --config ... --settings ...\n=> Reverse Proxy Status\n - (x) :\n   - NGINX:\n     - Status: running\n     - Ports:\n       - HTTPS: 443\n       - HTTP: 80\n   - Let's Encrypt\n     - Status: running\n% mup restart --config ... --settings ...\nStarted TaskList: Restart Meteor\n[x] - Stop Meteor\n[x] - Stop Meteor: SUCCESS\n[x] - Start Meteor\n[x] - Start Meteor: SUCCESS\n[x] - Verifying Deployment\n[x] - Verifying Deployment: SUCCESS\nAll green !. I confirm that this param has no effect on mup-nginx-proxy configuration (client_max_body_size 10M), and if you change manually the file /opt/mup-nginx-proxy/config/nginx-default.conf\nDefault shared nginx config\nclient_max_body_size 200M;\n````\nthen restart the mup-nginx-proxy docker, it solved the 413 error.\nCan someone check was is missing in mup's proxy setup ?. ",
    "themastersoda": "It takes the same amount of time for me. I believe that is related to the speed of your HDD as I have noticed that deploying from SSD drive is significantly faster.. More info: this error happens when mup is trying to start the application container. Mongo container is already running, so this error makes no sense. @zodern , do you have any ideas what's happening?\nHere's the docker ps output:\nCONTAINER ID        IMAGE                                           COMMAND                  CREATED             STATUS              PORTS                                      NAMES\ned6c9bffb90a        mongo:3.4.1                                     \"/entrypoint.sh mong\u2026\"   30 minutes ago      Up About a minute   127.0.0.1:27017->27017/tcp                 mongodb\n7147fff3dd28        jrcs/letsencrypt-nginx-proxy-companion:latest   \"/bin/bash /app/entr\u2026\"   20 hours ago        Up 19 hours                                                    myproject-nginx-letsencrypt\n0f421e261f35        jwilder/nginx-proxy:latest                      \"/app/docker-entrypo\u2026\"   20 hours ago        Up 19 hours         0.0.0.0:80->80/tcp, 0.0.0.0:443->443/tcp   myproject-nginx-proxy. Sorry for multiple comments, but this seems to be an even bigger issue.\nGave up trying to revive the server, so made a database backup and created a new droplet. Deploying to this new droplet yelds same results though:\n```\nStarted TaskList: Pushing Meteor App\n[xxx.xxx.xxx.xxx] - Pushing Meteor App Bundle to The Server\n[xxx.xxx.xxx.xxx] - Pushing Meteor App Bundle to The Server: SUCCESS\n[xxx.xxx.xxx.xxx] - Prepare Bundle\n[xxx.xxx.xxx.xxx] x Prepare Bundle: FAILED\n    -----------------------------------STDERR-----------------------------------\n    Error response from daemon: No such container: myproject\n    The command '/bin/sh -c cd  /built_app/programs/server &&     npm install --unsafe-perm' returned a non-zero code: 254\n\nHere's the docker ps -a:\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                        PORTS                        NAMES\n7a2157b2acaa        22886aac8590        \"/bin/sh -c 'cd  /bu\u2026\"   10 minutes ago      Exited (254) 10 minutes ago                                heuristic_colden\n274ff089d989        mongo:3.4.1         \"/entrypoint.sh mong\u2026\"   34 minutes ago      Up 34 minutes                 127.0.0.1:27017->27017/tcp   mongodb\n```\nIt seems that something prevents mup from creating container, but it does not stop proceeding further.\n. @zodern no significant output after this error whatsoever, however, the workaround is deploying from linux or windows subsystem for linux. Deploying straight from windows 10 seems to not work, but linux works every time. There was no more useful output in the console after this error appeared, the only thing that might be related is that the errors started popping up after trying to redeploy to server when i had a constantly crashing app there. After the endless crashes it could not finish bundle publishing operation, so this might be related to it. \nSince deploying from linux seems to have fixed the issue, i haven't tried deploying from windows after that.\nAbout the error being expected when having a first deploy, how is it supposed to be normal when the deployment fails because of it? The meteor app container did not start and wasn't even created. I was not able to start it even when manually sshed into the server.. @AstonBraham in my case the fix was simply using linux for deployments.. ",
    "SadekSyed": "I had an nginx server running so I stopped it and this is the error I'm getting now:\nAt x Verifying Deployment: FAILED\n```x Verifying Deployment: FAILED\n    -----------------------------------STDERR-----------------------------------\n    t new AccountsServer (packages/accounts-base/accounts_server.js:18:5)\n        at meteorInstall.node_modules.meteor.accounts-base.server_main.js (packages/accounts-base/server_main.js:9:12)\n        at fileEvaluate (packages/modules-runtime.js:197:9)\n        at require (packages/modules-runtime.js:120:16)\n        at /bundle/bundle/programs/server/packages/accounts-base.js:2019:15\n        at /bundle/bundle/programs/server/packages/accounts-base.js:2030:3\n\n    > meteor-dev-bundle@0.0.0 install /bundle/bundle/programs/server\n    > node npm-rebuild.js\n\n    {\n      \"meteor-dev-bundle\": \"0.0.0\",\n      \"npm\": \"3.10.10\",\n      \"ares\": \"1.10.1-DEV\",\n      \"http_parser\": \"2.7.0\",\n      \"icu\": \"56.1\",\n      \"modules\": \"46\",\n      \"node\": \"4.8.0\",\n      \"openssl\": \"1.0.2k\",\n      \"uv\": \"1.9.1\",\n      \"v8\": \"4.5.103.45\",\n      \"zlib\": \"1.2.8\"\n    }\n    npm WARN meteor-dev-bundle@0.0.0 No description\n    npm WARN meteor-dev-bundle@0.0.0 No repository field.\n    npm WARN meteor-dev-bundle@0.0.0 No license field.\n    => Starting meteor app on port:80\n\n    => Redeploying previous version of the app\n\n    -----------------------------------STDOUT-----------------------------------\n\n    To see more logs type 'mup logs --tail=50'\n\n    ----------------------------------------------------------------------------```. [149.56.140.165]    at fileEvaluate (packages/modules-runtime.js:197:9)\n\n[149.56.140.165]    - - - - -\n[149.56.140.165]    at [object Object]. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/topologies/server.js:325:35)\n[149.56.140.165]    at emitOne (events.js:77:13)\n[149.56.140.165]    at [object Object].emit (events.js:169:7)\n[149.56.140.165]    at [object Object]. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/pool.js:270:12)\n[149.56.140.165]    at [object Object].g (events.js:260:16)\n[149.56.140.165]    at emitTwo (events.js:87:13)\n[149.56.140.165]    at [object Object].emit (events.js:172:7)\n[149.56.140.165]    at Socket. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/connection.js:173:49)\n[149.56.140.165]    at Socket.g (events.js:260:16)\n[149.56.140.165]    at emitOne (events.js:77:13)\n[149.56.140.165]\n[149.56.140.165]> meteor-dev-bundle@0.0.0 install /bundle/bundle/programs/server\n[149.56.140.165]> node npm-rebuild.js\n[149.56.140.165]\n[149.56.140.165]{\n[149.56.140.165]  \"meteor-dev-bundle\": \"0.0.0\",\n[149.56.140.165]  \"npm\": \"3.10.10\",\n[149.56.140.165]  \"ares\": \"1.10.1-DEV\",\n[149.56.140.165]  \"http_parser\": \"2.7.0\",\n[149.56.140.165]  \"icu\": \"56.1\",\n[149.56.140.165]  \"modules\": \"46\",\n[149.56.140.165]  \"node\": \"4.8.0\",\n[149.56.140.165]  \"openssl\": \"1.0.2k\",\n[149.56.140.165]  \"uv\": \"1.9.1\",\n[149.56.140.165]  \"v8\": \"4.5.103.45\",\n[149.56.140.165]  \"zlib\": \"1.2.8\"\n[149.56.140.165]}\n[149.56.140.165]npm WARN meteor-dev-bundle@0.0.0 No description\n[149.56.140.165]npm WARN meteor-dev-bundle@0.0.0 No repository field.\n[149.56.140.165]npm WARN meteor-dev-bundle@0.0.0 No license field.\n[149.56.140.165]=> Starting meteor app on port:80\n[149.56.140.165]\n[149.56.140.165]/bundle/bundle/programs/server/node_modules/fibers/future.js:313\n[149.56.140.165]                                                throw(ex);\n[149.56.140.165]                                                ^\n[149.56.140.165]MongoError: failed to connect to server [mongodb:27017] on first connect\n[149.56.140.165]    at Object.Future.wait (/bundle/bundle/programs/server/node_modules/fibers/future.js:449:15)\n[149.56.140.165]    at new MongoConnection (packages/mongo/mongo_driver.js:217:27)\n[149.56.140.165]    at new MongoInternals.RemoteCollectionDriver (packages/mongo/remote_collection_driver.js:4:16)\n[149.56.140.165]    at Object. (packages/mongo/remote_collection_driver.js:38:10)\n[149.56.140.165]    at Object.defaultRemoteCollectionDriver (packages/underscore.js:784:19)\n[149.56.140.165]    at new Mongo.Collection (packages/mongo/collection.js:99:40)\n[149.56.140.165]    at AccountsServer.AccountsCommon (packages/accounts-base/accounts_common.js:23:18)\n[149.56.140.165]    at new AccountsServer (packages/accounts-base/accounts_server.js:18:5)\n[149.56.140.165]    at meteorInstall.node_modules.meteor.accounts-base.server_main.js (packages/accounts-base/server_main.js:9:12)\n[149.56.140.165]    at fileEvaluate (packages/modules-runtime.js:197:9)\n[149.56.140.165]    - - - - -\n[149.56.140.165]    at [object Object]. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/topologies/server.js:325:35)\n[149.56.140.165]    at emitOne (events.js:77:13)\n[149.56.140.165]    at [object Object].emit (events.js:169:7)\n[149.56.140.165]    at [object Object]. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/pool.js:270:12)\n[149.56.140.165]    at [object Object].g (events.js:260:16)\n[149.56.140.165]    at emitTwo (events.js:87:13)\n[149.56.140.165]    at [object Object].emit (events.js:172:7)\n[149.56.140.165]    at Socket. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/connection.js:173:49)\n[149.56.140.165]    at Socket.g (events.js:260:16)\n[149.56.140.165]    at emitOne (events.js:77:13)\n[149.56.140.165]\n[149.56.140.165]> meteor-dev-bundle@0.0.0 install /bundle/bundle/programs/server\n[149.56.140.165]> node npm-rebuild.js\n[149.56.140.165]\n[149.56.140.165]{\n[149.56.140.165]  \"meteor-dev-bundle\": \"0.0.0\",\n[149.56.140.165]  \"npm\": \"3.10.10\",\n[149.56.140.165]  \"ares\": \"1.10.1-DEV\",\n[149.56.140.165]  \"http_parser\": \"2.7.0\",\n[149.56.140.165]  \"icu\": \"56.1\",\n[149.56.140.165]  \"modules\": \"46\",\n[149.56.140.165]  \"node\": \"4.8.0\",\n[149.56.140.165]  \"openssl\": \"1.0.2k\",\n[149.56.140.165]  \"uv\": \"1.9.1\",\n[149.56.140.165]  \"v8\": \"4.5.103.45\",\n[149.56.140.165]  \"zlib\": \"1.2.8\"\n[149.56.140.165]}\n[149.56.140.165]npm WARN meteor-dev-bundle@0.0.0 No description\n[149.56.140.165]npm WARN meteor-dev-bundle@0.0.0 No repository field.\n[149.56.140.165]npm WARN meteor-dev-bundle@0.0.0 No license field.\n[149.56.140.165]=> Starting meteor app on port:80\n[149.56.140.165]\n[149.56.140.165]/bundle/bundle/programs/server/node_modules/fibers/future.js:313\n[149.56.140.165]                                                throw(ex);\n[149.56.140.165]                                                ^\n[149.56.140.165]MongoError: failed to connect to server [mongodb:27017] on first connect\n[149.56.140.165]    at Object.Future.wait (/bundle/bundle/programs/server/node_modules/fibers/future.js:449:15)\n[149.56.140.165]    at new MongoConnection (packages/mongo/mongo_driver.js:217:27)\n[149.56.140.165]    at new MongoInternals.RemoteCollectionDriver (packages/mongo/remote_collection_driver.js:4:16)\n[149.56.140.165]    at Object. (packages/mongo/remote_collection_driver.js:38:10)\n[149.56.140.165]    at Object.defaultRemoteCollectionDriver (packages/underscore.js:784:19)\n[149.56.140.165]    at new Mongo.Collection (packages/mongo/collection.js:99:40)\n[149.56.140.165]    at AccountsServer.AccountsCommon (packages/accounts-base/accounts_common.js:23:18)\n[149.56.140.165]    at new AccountsServer (packages/accounts-base/accounts_server.js:18:5)\n[149.56.140.165]    at meteorInstall.node_modules.meteor.accounts-base.server_main.js (packages/accounts-base/server_main.js:9:12)\n[149.56.140.165]    at fileEvaluate (packages/modules-runtime.js:197:9)\n[149.56.140.165]    - - - - -\n[149.56.140.165]    at [object Object]. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/topologies/server.js:325:35)\n[149.56.140.165]    at emitOne (events.js:77:13)\n[149.56.140.165]    at [object Object].emit (events.js:169:7)\n[149.56.140.165]    at [object Object]. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/pool.js:270:12)\n[149.56.140.165]    at [object Object].g (events.js:260:16)\n[149.56.140.165]    at emitTwo (events.js:87:13)\n[149.56.140.165]    at [object Object].emit (events.js:172:7)\n[149.56.140.165]    at Socket. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/connection.js:173:49)\n[149.56.140.165]    at Socket.g (events.js:260:16)\n[149.56.140.165]    at emitOne (events.js:77:13)\n[149.56.140.165]\n[149.56.140.165]> meteor-dev-bundle@0.0.0 install /bundle/bundle/programs/server\n[149.56.140.165]> node npm-rebuild.js\n[149.56.140.165]\n[149.56.140.165]{\n[149.56.140.165]  \"meteor-dev-bundle\": \"0.0.0\",\n[149.56.140.165]  \"npm\": \"3.10.10\",\n[149.56.140.165]  \"ares\": \"1.10.1-DEV\",\n[149.56.140.165]  \"http_parser\": \"2.7.0\",\n[149.56.140.165]  \"icu\": \"56.1\",\n[149.56.140.165]  \"modules\": \"46\",\n[149.56.140.165]  \"node\": \"4.8.0\",\n[149.56.140.165]  \"openssl\": \"1.0.2k\",\n[149.56.140.165]  \"uv\": \"1.9.1\",\n[149.56.140.165]  \"v8\": \"4.5.103.45\",\n[149.56.140.165]  \"zlib\": \"1.2.8\"\n[149.56.140.165]}\n[149.56.140.165]npm WARN meteor-dev-bundle@0.0.0 No description\n[149.56.140.165]npm WARN meteor-dev-bundle@0.0.0 No repository field.\n[149.56.140.165]npm WARN meteor-dev-bundle@0.0.0 No license field.\n[149.56.140.165]=> Starting meteor app on port:80\n[149.56.140.165]\n[149.56.140.165]/bundle/bundle/programs/server/node_modules/fibers/future.js:313\n[149.56.140.165]                                                throw(ex);\n[149.56.140.165]                                                ^\n[149.56.140.165]MongoError: failed to connect to server [mongodb:27017] on first connect\n[149.56.140.165]    at Object.Future.wait (/bundle/bundle/programs/server/node_modules/fibers/future.js:449:15)\n[149.56.140.165]    at new MongoConnection (packages/mongo/mongo_driver.js:217:27)\n[149.56.140.165]    at new MongoInternals.RemoteCollectionDriver (packages/mongo/remote_collection_driver.js:4:16)\n[149.56.140.165]    at Object. (packages/mongo/remote_collection_driver.js:38:10)\n[149.56.140.165]    at Object.defaultRemoteCollectionDriver (packages/underscore.js:784:19)\n[149.56.140.165]    at new Mongo.Collection (packages/mongo/collection.js:99:40)\n[149.56.140.165]    at AccountsServer.AccountsCommon (packages/accounts-base/accounts_common.js:23:18)\n[149.56.140.165]    at new AccountsServer (packages/accounts-base/accounts_server.js:18:5)\n[149.56.140.165]    at meteorInstall.node_modules.meteor.accounts-base.server_main.js (packages/accounts-base/server_main.js:9:12)\n[149.56.140.165]    at fileEvaluate (packages/modules-runtime.js:197:9)\n[149.56.140.165]    - - - - -\n[149.56.140.165]    at [object Object]. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/topologies/server.js:325:35)\n[149.56.140.165]    at emitOne (events.js:77:13)\n[149.56.140.165]    at [object Object].emit (events.js:169:7)\n[149.56.140.165]    at [object Object]. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/pool.js:270:12)\n[149.56.140.165]    at [object Object].g (events.js:260:16)\n[149.56.140.165]    at emitTwo (events.js:87:13)\n[149.56.140.165]    at [object Object].emit (events.js:172:7)\n[149.56.140.165]    at Socket. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/connection.js:173:49)\n[149.56.140.165]    at Socket.g (events.js:260:16)\n[149.56.140.165]    at emitOne (events.js:77:13)\n[149.56.140.165]\n[149.56.140.165]> meteor-dev-bundle@0.0.0 install /bundle/bundle/programs/server\n[149.56.140.165]> node npm-rebuild.js\n[149.56.140.165]\n[149.56.140.165]{\n[149.56.140.165]  \"meteor-dev-bundle\": \"0.0.0\",\n[149.56.140.165]  \"npm\": \"3.10.10\",\n[149.56.140.165]  \"ares\": \"1.10.1-DEV\",\n[149.56.140.165]  \"http_parser\": \"2.7.0\",\n[149.56.140.165]  \"icu\": \"56.1\",\n[149.56.140.165]  \"modules\": \"46\",\n[149.56.140.165]  \"node\": \"4.8.0\",\n[149.56.140.165]  \"openssl\": \"1.0.2k\",\n[149.56.140.165]  \"uv\": \"1.9.1\",\n[149.56.140.165]  \"v8\": \"4.5.103.45\",\n[149.56.140.165]  \"zlib\": \"1.2.8\"\n[149.56.140.165]}\n[149.56.140.165]npm WARN meteor-dev-bundle@0.0.0 No description\n[149.56.140.165]npm WARN meteor-dev-bundle@0.0.0 No repository field.\n[149.56.140.165]npm WARN meteor-dev-bundle@0.0.0 No license field.\n[149.56.140.165]=> Starting meteor app on port:80\n[149.56.140.165]\n[149.56.140.165]/bundle/bundle/programs/server/node_modules/fibers/future.js:313\n[149.56.140.165]                                                throw(ex);\n[149.56.140.165]                                                ^\n[149.56.140.165]MongoError: failed to connect to server [mongodb:27017] on first connect\n[149.56.140.165]    at Object.Future.wait (/bundle/bundle/programs/server/node_modules/fibers/future.js:449:15)\n[149.56.140.165]    at new MongoConnection (packages/mongo/mongo_driver.js:217:27)\n[149.56.140.165]    at new MongoInternals.RemoteCollectionDriver (packages/mongo/remote_collection_driver.js:4:16)\n[149.56.140.165]    at Object. (packages/mongo/remote_collection_driver.js:38:10)\n[149.56.140.165]    at Object.defaultRemoteCollectionDriver (packages/underscore.js:784:19)\n[149.56.140.165]    at new Mongo.Collection (packages/mongo/collection.js:99:40)\n[149.56.140.165]    at AccountsServer.AccountsCommon (packages/accounts-base/accounts_common.js:23:18)\n[149.56.140.165]    at new AccountsServer (packages/accounts-base/accounts_server.js:18:5)\n[149.56.140.165]    at meteorInstall.node_modules.meteor.accounts-base.server_main.js (packages/accounts-base/server_main.js:9:12)\n[149.56.140.165]    at fileEvaluate (packages/modules-runtime.js:197:9)\n[149.56.140.165]    - - - - -\n[149.56.140.165]    at [object Object]. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/topologies/server.js:325:35)\n[149.56.140.165]    at emitOne (events.js:77:13)\n[149.56.140.165]    at [object Object].emit (events.js:169:7)\n[149.56.140.165]    at [object Object]. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/pool.js:270:12)\n[149.56.140.165]    at [object Object].g (events.js:260:16)\n[149.56.140.165]    at emitTwo (events.js:87:13)\n[149.56.140.165]    at [object Object].emit (events.js:172:7)\n[149.56.140.165]    at Socket. (/bundle/bundle/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/connection.js:173:49)\n[149.56.140.165]    at Socket.g (events.js:260:16)\n[149.56.140.165]    at emitOne (events.js:77:13)\n. Thanks for all the help so far.\nI'm getting \nerror unknown command ps\nPerhaps we can click up on discord or something that allows for quicker messaging?. I rewrote my code in express.\nI know that isn't the response you wanted to hear. Sorry /:\nOn Sat, Oct 6, 2018 at 3:52 PM Gabriel Moncea notifications@github.com\nwrote:\n\n@zodern https://github.com/zodern @SadekSyed\nhttps://github.com/SadekSyed I have the same problem. How did you\nresolve it?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/544#issuecomment-427601693,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AXVu_NlDCSgNqsgyb9mnBqOYrjFGwVXEks5uiQn6gaJpZM4MidMn\n.\n. \n",
    "markreid": "Added a PR if anybody wants to merge it. . So this didn't make it into 1.3, @Farkal's PR seems to be a reasonable solution, any chance this is on the radar for 1.4?. apologies @zodern was looking in the wrong part of the docs. thanks for your help :). ",
    "himanshuphirke": "@WayneUong \nCould you share what kind of Load balancing you have used?\nType and algorithm on balancer (Like round robin, etc). @houshuang \nAre you using an external load balancer for the five instance you are deploying?. @houshuang Thanks for prompt reply.\nAre meteor Sessions working correctly with five deployments and nginx?\nWhat is the routing method you are using in nginx, is it iphash? \nWould be very helpful if you could share nginx config details (config file if possible)\n. @houshuang \nThanks for sharing.. When I tested deployment it does sequentially and its slow depending on servers. ",
    "Garbolino": "I mean, I have tried with debug:false and removing debug line in my mup.json file, both cases stilll not in production mode. I know it is not running in production mode because files are not compressed when rendering my app.\nThank you!. I have found the problem, sorry it was not related to mup. I do not know how but standard minifiers js package disappear from my package at the same time I upgraded mup...\nThank you anyway . ",
    "cosio55": "It was a problem with the URL I was using on the MONGO_URL, it was wrong and had some extra characters.. ",
    "ssashita": "If it is possible to change the phantomjs version only by changing the mup related scripts, can you please let me know where to change. Thanks ! I am constrained to use phantomJs 2.x\nI now know that I should probably create my own docker base image. Please let me know if there is anything other than this that can be done. Thanks. Fixed this extendiing abernix/meteord:base to create my own image. ",
    "delatorremario": "My mistake :). I solve, before config https://letsencrypt.org on server\nssl: {\n      // Enables let's encrypt (optional)\n      crt: './ssl/bundle.crt', // this is a bundle of certificates\n      key: './ssl/privkey.pem', // this is the private key of the certificate\n      port: 443\n    }. ",
    "sbe88": "Sorry, it was juste a matter of RAM on DigitalOcean.\nDeploying to a Droplet with more RAM with a higher deployCheckWaitTime solved the issue.. ",
    "santteegt": "@tomtom87 can I also send you an email asking for some help on how to set up SSL on my EC2 instance using mup for meteor deployment ?. ",
    "LevanArabuli": "Still no updates? \n@tomtom87 have you been able to find a workaround?\nI'm setting up ELB with ACM issued cert, Meteor app is deployed on EC2. Want to remove ssl/proxy dependencies from mup.js completely and let ELB run it.. Resolved, classic ELB doesn't support WebSockets/DDP. Use new Application Load Balancer type instead. \nFor more details check #914.. #565 similar issue . Resolved, first and general issue was that I was using classic ELB, which doesn't support WebSockets and was preventing DDP connection. Newer Application Load Balancer which comes with WebSocket and Sticky Sessions helped. More on the diff here: https://aws.amazon.com/elasticloadbalancing/details/#details\nAnother issue more specific to my use case was having no endpoint for ELB health check, I was hiding/securing everything behind basic_auth, health check was getting 403  unauthorized failing and not registering EC2 instance in ELB. Make sure you have endpoint for health check that returns 200 OK, and also revisit your security groups - check out inbound rules and make sure ELB has access to corresponding ports to EC2 instance(80, 443 etc.).. You don't need both letsencrypt and ALB level SSL handling, just use one of them.\nScreenshot you provided only shows SSL Certificate setup. It needs to be attached to Application Load Balancer.. ",
    "thirtyfoursoft": "Hi @LevanArabuli , \nI am using the Application load balancer, but it is also prividing the SSL for https, and I am also using letsencrypt for my app now it is crashing the app. See #972. Hi @zodern ,\nThanks for replying, Here is the output of your given command.\n\nThanks. Thanks for your update.\nEarlier it was using : \ndocker: {\n      image: 'abernix/meteord:base',\n    }\nAnd now I have changed it to :\n`\n docker: {\n      image: 'abernix/meteord:base',\n      buildInstructions: [\n        'RUN npm install node-pre-gyp -g'\n      ]\n    }\nPlease let me know if it is okay?. @zodern , Thanks a lot, your solution did the great job, it is working correctly.. Meteor is using the letsencrypt to run the docker on secure connection, otherwise it will work on non https, and ALB can't handle the App to work with https.\nOtherside it is mandatory to add SSL on load balancer (in case https support.). ",
    "sontn": "\n@thirtyfoursoft try using the SSL from Route 53 mate\n\nHi Tom, can I have your email address? Thank you!. ",
    "AlmogRnD": "I'm having the same issue . This is the error that I'm getting \nnode-pre-gyp ERR! Tried to download(404): https://github.com/kelektiv/node.bcrypt.js/releases/download/v1.0.2/bcrypt_lib-v1.0.2-node-v46-linux-x64.tar.gz \n. @zodern I was just testing different versions, I don't think it's mup but as the older versions did not work. It's a bit confusing as everything was working until 2 days. Maybe you have an idea. You can see the issue here https://app-staging.mentorloop.com/ \nHosted on AWS, not using let's encrypt I remember there was some issue with it \nHere is the config file (I removed the sensitive info)\nmodule.exports = {\n  servers: {\n    one: {\n      host: 'Address removed',\n      username: 'Removed',\n      pem: '~/.ssh/cc_mentorloop_sydney.pem',\n    },\n  },\nmeteor: {\n    name: 'mentorloop-staging',\n    path: '../..',\nservers: {\n  one: {},\n},\n\nbuildOptions: {\n  serverOnly: true,\n},\n\nenv: {\n  ROOT_URL: 'https://app-staging.mentorloop.com',\n  MAIL_URL: '',\n  MONGO_URL: '',\n  MONGO_OPLOG_URL: '',\n  SEND_GRID_API_KEY: ''\n},\n\ndocker: {\n  image: 'abernix/meteord:base',\n},\n\nssl: {\n  // Enables let's encrypt (optional)\n  // This is disabled because it doesn't work and we don't yet understand why.\n  // autogenerate: {\n  //   email: 'admin@mentorloop.com',\n  //   domains: 'app-staging.mentorloop.com', // comma seperated list of domains\n  // },\n\n  // currently have to upload a cert and key manually\n  // you only need to do this when the cert expires\n  // or you're deploying to a new instance.\n  // you'll need the .pem files.\n  crt: './chain.pem',\n  key: './privkey.pem',\n  port: 443,\n  upload: false, // set to true when you actually need to use the certs\n},\n\n// This is the maximum time in seconds it will wait\n// for your app to start\n// Add 30 seconds if the server has 512mb of ram\n// And 30 more if you have binary npm dependencies.\ndeployCheckWaitTime: 60,\n\n// Show progress bar while uploading bundle to server\n// You might need to disable it on CI servers\nenableUploadProgressBar: true,\n\n},\n};\n. Thanks, I didn't see that . +1. Any news when this well be fixed, kind of a big issue. . ",
    "nickdandakis": "@erperejildo, you can set environment variables within Gitlab under your project's Settings -> CI/CD Pipelines -> Secret Variables. Then reference it and store it in a file like @zodern just laid out.. To be clear, you're not deploying your app with a file that contains the SSH key.\nYou're creating the file with\necho $SSH_KEY > ./ssh_key\nwhere $SSH_KEY is an environment variable set in your Gitlab project. You can set environment variables under Settings -> CI/CD Pipelines -> Secret Variables.. Can you not set that line to pem: './ssh_key', or whatever you call the file you create in your Gitlab pipeline job?. ",
    "hazz1925": "I tried as suggested by @zodern above but I got this error\nI tried to chmod the ssh key file but no luck\n```bash\n$ cd .deploy\n$ echo $SSH_KEY > ./ssh_key\n$ chmod 400 ./ssh_key\n$ mup setup\nStarted TaskList: Setup Docker\n[0.0.0.0] - Setup Docker\n/usr/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2/lib/client.js:156\n      throw new Error('Cannot parse privateKey: ' + privKeyInfo.message);\n      ^\nError: Cannot parse privateKey: Unsupported key format\n    at Client.connect (/usr/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2/lib/client.js:156:13)\n    at SSH.connect (/usr/lib/node_modules/mup/node_modules/nodemiral/lib/ssh.js:12:16)\n    at Session._withSshClient (/usr/lib/node_modules/mup/node_modules/nodemiral/lib/session.js:58:12)\n    at Session.execute (/usr/lib/node_modules/mup/node_modules/nodemiral/lib/session.js:140:8)\n    at /usr/lib/node_modules/mup/node_modules/nodemiral/lib/session.js:168:12\n    at /usr/lib/node_modules/mup/node_modules/nodemiral/lib/session.js:183:7\n    at tryToString (fs.js:457:3)\n    at FSReqWrap.readFileAfterClose [as oncomplete] (fs.js:444:12)\n```. I am also having the same problem.\nOS - MacOS Sierra\nmup version - 1.3.2\nMeteor version - 1.5\n. Is there any solution yet for this issue?\nWhich docker image is working?. ",
    "albach": "how did you fix it? I think I am experiencing the same issue.. ",
    "sethjgore": "@nick-preda I'm curious, what worked for you? I keep on getting 502 Bad Gateway. .  i think this is causing the 502 troubles. \nI am getting this from my server.\ndocker logs cs-nginx-proxy\n[error] 24#24: *50 connect() failed (111: Connection refused) while connecting to upstream, client: aaa.bbb.ccc.ddd, server: website.com, request: \"GET /sockjs/info?cb=bgqcxx90nc HTTP/1.1\", upstream: \"http://172.17.0.2:80/sockjs/info?cb=bgqcxx90nc\", host: \"website.com\", referrer: \"https://website.com/find\"\n. @zodern thanks for replying. You're right, the app isn't starting at all.  Tried updating meteor and switching to kadirahq/meteord from abernix but still not starting. Any ideas why? \ndocker: {\n            image: 'kadirahq/meteord',\n            // image: 'abernix/meteord:base',\n        },. Finally got it to work. Used Abernix.\nFor anybody who's struggling, make sure \"meteor.ssl.autogenerate.domains\" are ACCESSIBLE. If you put down domain.com, www.domain.com, make sure www. is actually already set up. \nAlso if you are having issues with force-ssl, uninstall that and add meteorblackbelt:force-ssl instead.. ",
    "SimonSimCity": "I was wondering about the same and found out the following:\nThe command mup stop and mup restart both execute the script https://github.com/zodern/meteor-up/blob/master/src/plugins/meteor/assets/meteor-stop.sh which (at the time writing) stop and remove all docker containers by running docker rm -f $APPNAME.\nThe documentation of docker states that docker rm -f CONTAINER sends the signal SIGKILL to the process running in this container (https://docs.docker.com/v1.11/engine/reference/commandline/rm/).\nAn article like https://www.ctl.io/developers/blog/post/gracefully-stopping-docker-containers/ explains very detailed how which of the possible versions of shutting down a container work.\nMy suggestion here is to replace the forcefully removing calls by something like the following:\n```bash\nGracefully stopping the meteor application\nsudo docker stop -t $TIMEOUT $APPNAME || :\nContinue with forcefully stopping and removing\nsudo docker rm -f $APPNAME || :\nsudo docker rm -f $APPNAME-frontend || :\nsudo docker rm -f $APPNAME-nginx-letsencrypt || :\nsudo docker rm -f $APPNAME-nginx-proxy || :\n```\nDoing this will give us the possibility to e.g. gracefully shut down the connections to the client systems and make sure the code is finished and doesn't hick up in the middle of a function.. To have a graceful shutdown here would also be nice to support this plugin: https://www.npmjs.com/package/@meteorjs/ddp-graceful-shutdown\nIt would also help me gracefully shutting down my HTTP server I have on Meteor (http://dillonbuchanan.com/programming/gracefully-shutting-down-a-nodejs-http-server/) and certainly also be necessary to detecting jobs that are stopped (https://github.com/vsivsi/meteor-job-collection/pull/263/commits/97822bfbb67f3c3e1a055d34c15770d8f4a76355#diff-04c6e90faac2675aa89e2176d2eec7d8R2034).. See pull request #964. My suggestion: Go on the server via ssh, install mongodb-clients and try to connect via the mongodb client using a command like mongo private-network-ip:27017/myspecial_db -u username -p password\nJust in case you're using some special characters in your username or password, you might have to escape them. It might seem obvious, but I also had the case where my username should contain an @ sign which blew the show because the rest of the username, including the password, suddenly became part of the domain \ud83d\ude1c \nIt would also be nice if you'd link your issues at stackoverflow and meteor-forum here .... Thanks for clarification. \nAs all of this happens on the remote server side, how often does it happen that you are deploying the exact same version to a server, so a docker-image can re-use these layers? In my case it turns out that I never want this. When calling deploy, I most of the time either have a broken build (due to network-failures during the previous build) or want to release a new version, so a caching of npm install wouldn't really help me since the bundle itself always is different.\nBut let me try to write down the following as a PR:\n\nExtracting sorely the package.json and ~package-lock.json~ npm-shrinkwrap.json from the bundle.tar.gz file and copy it into the VM using COPY.\nInstall the package dependencies (which might be the same as the previous version which then allows reusing the layers for copying and installing the npm packages).\nCopy the rest of the app using ADD.\nMove or symlink the folder node_modules into the extracted project files.\n\nI guess this comes closest to the last paragraph you wrote, right?. I now spent some time on it and I came up with this:\n\nCreate the tar containing all the data inside the bundle-folder, but not the folder itself\n\nRun the following commands on the server after receiving the bundle:\nbash\ngunzip bundle.tar.gz\ntar -xvf bundle.tar programs/server/npm-rebuild.js programs/server/npm-shrinkwrap.json programs/server/package.json\n\n\nUse this docker file as a template\n```docker\nFROM abernix/meteord:node-8-base\n\n\nCreating a temporary folder\nRUN mkdir /npm_packages || true\nUpload the npm-files. The COPY sorely checks on the file-content, not on the files metadata, as ADD does.\nCOPY ./programs/server /npm_packages\nInstall the npm dependencies and remove the folder again. Now they should be in the npm-cache.\nRUN cd  /npm_packages && \\\n    METEOR_SKIP_NPM_REBUILD=1 npm install --unsafe-perm && \\\n    cd / && rm -R /npm_packages\nNow we can use the add-command, which will invalidate the docker-cache if the file changed (even only it's meta-data, like the created-at date)\nADD bundle.tar /built_app\nGet the npm packages, which by now should be in the npm-cache.\nRUN cd /built_app/programs/server && \\\n    npm install --unsafe-perm\n```\nThis way would work, but looks quite hacky to me ...\nAnother solution, I just came across, is shown in the repository https://github.com/shaunwarman/docker-npm-cache where the user just creates a mount for /root/.npm on the host. I the downside of this is that the npm-cache will get quite big over time and I don't have an idea to clean it up.\nSince you're cleaning up the old docker-images, I'd still prefer my first option over my second one.\nhttps://github.com/zodern/meteor-up/blob/3c7120a75c12ea12fdd5688e33574c12e158fd07/src/plugins/meteor/assets/prepare-bundle.sh#L63\nWhat are your ideas on this?. But out of what you say now, my approach doesn't help much. METEOR_SKIP_NPM_REBUILD=1 was added because I wanted to skip running the content of npm-rebuild.js, of which you now say that this is the most time-consuming. But going this way, it would not even help to cache the /root/.npm folder, but I'd rather mount /built_app/programs/server/node_packages.\nWhen taking the idea of mounting the /built_app/programs/server/node_packages folder, we could add the files via ADD, then mount the folder to the correct location and run npm purge && npm install. This would skip a rebuild, remove all the unnecessary packages and fetch the updated/new ones, or is there something I forgot?\nThe question remaining to me is: How does npm handle it if the versions, required by the npm-shrinkwrap.json file are not in the cache but in the node_packages folder. If it doesn't re-download these packages, this method will work.\nAnother question popping up now is, if npm purge && npm install takes less time than what we saved on replacing COPY by ADD. At least in my case it would help a lot because I have tons of small files in my meteor-application.. https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#leverage-build-cache says:\n\n\nFor the ADD and COPY instructions, the contents of the file(s) in the image are examined and a checksum is calculated for each file. The last-modified and last-accessed times of the file(s) are not considered in these checksums. During the cache lookup, the checksum is compared against the checksum in the existing images. If anything has changed in the file(s), such as the contents and metadata, then the cache is invalidated.\nAside from the ADD and COPY commands, cache checking does not look at the files in the container to determine a cache match. For example, when processing a RUN apt-get -y update command the files updated in the container are not examined to determine if a cache hit exists. In that case just the command string itself is used to find a match.\n\n\nSo re-uploading a already built version of your meteor app will not re-create the layer. I think that is what you were referring to, right?\nIn case the data changes, a rebuild of the system-stuff is required anyways, excepted for if you could take the users app data separately from his npm packages ... In this case you'd have to change the content of the tar.gz file, which I guess is not an option since we want to allow builds outside of mup.. I think it's good to note that these changes have been reverted. See the reason in the comment on the commit: https://github.com/zodern/meteor-up/commit/3d8ea23165767e7f122294bdab46eb2d7971880c#diff-df0f0089255b343eb358fa7c27a482c1. I guess you forgot about the database and the fact that you're inside a docker-container, so this localhost is not the machine you want to refer to.\nPlease read the chapter MongoDB of the documentation to this script: http://meteor-up.com/docs.html#mongodb I think this will clear it out for you. Specially the subtopic Multiple apps use the same database should be of interest if you want to manage the database yourself. If you're not keen on that, I'd just take the build-in database.. It was not only about adding the mongo section into your configuration. The environment variable must also fit. I highly doubt that localhost is the correct server in MONGO_URL because this would require that you use a different base-image than abernix/meteord:node-8.4.0-base.\nI guess this is a test server and you just want it to work, right? Then please follow the following steps:\n\nAdd the mongo-section back to your configuration.\nCall mup setup to make sure the mongo container is installed and running.\nSet MONGO_URL in your configuration to mongodb://mongodb:27017/meteor (you can change meteor to what you want to call your app - if you want)\nI guess you also want to use the oplog instead of constantly asking the database for updates. If yes, please set MONGO_OPLOG_URL to mongodb://mongodb:27017/local in your configuration\nRun mup deploy\nIf it still fails, show the result of mup logs --tail=200 and ssh on your server and show the result of calling docker stats. Because I only have limited time on this, I can just forward you to the docs \ud83d\ude09 http://meteor-up.com/docs.html#example-configs. Read carefully through those and I guess they'll provide you with an answer.\n\nOtherwise it might also be a good idea to read yourself into docker and their networking .... Looks like you somewhere have NodeJS in some 4.x version installed - otherwise I wonder how it could be built with this version. My advise:\n\nRemove node_modules folder of your project\nRun meteor npm install --production\n\nAnd again check your node versions within meteor and on the system installed, which seems the one mup uses.. ",
    "chrissanders": "I'm having the same issue, although I'm running the very latest version of mup. Redeployment ran fine, but nothing mentioning SSL and I can't connect to the site via HTTPS. I'm not seeing anything in the logs that tells me this was successful or failed. . @brylie Can you describe the process you used to install certbot?. No luck after doing something similar here. I captured packets on the server and it sees the inbound connection on 443 but then responds with a TCP RST. I've confirmed via netstat that the server appears to be listening on port 443, but doesn't appear to be handling the request. . I was able to get this working, although I'm not sure exactly what fixed it. Things I did were:\n1. Change the ROOT_URL from http to https in mup.js\n2. Only list one subdomain in the ssl section of mup.js\n3. Run mup setup from mup/prod\n4. Call ./bin/deploy prod\nOne of those things or a combination of them got me going. . ",
    "roelvan": "I followed this guide with success: Medium Article (mup + letsencrypt). ",
    "FBosler": "@zodern \nI checked the section under troubleshooting and ran the docker logs -nginx-letsencrypt I got the following:\n2017-07-31 07:32:02,262:INFO:simp_le:1213: Generating new account key\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/simp_le.py\", line 1404, in main\n    return main_with_exceptions(cli_args)\n  File \"/usr/lib/python2.7/site-packages/simp_le.py\", line 1387, in main_with_exceptions\n    persist_new_data(args, existing_data)\n  File \"/usr/lib/python2.7/site-packages/simp_le.py\", line 1288, in persist_new_data\n    for vhost in args.vhosts\n  File \"/usr/lib/python2.7/site-packages/simp_le.py\", line 1288, in <genexpr>\n    for vhost in args.vhosts\n  File \"/usr/lib/python2.7/site-packages/acme/client.py\", line 212, in request_domain_challenges\n    typ=messages.IDENTIFIER_FQDN, value=domain), new_authzr_uri)\n  File \"/usr/lib/python2.7/site-packages/acme/client.py\", line 194, in request_challenges\n    return self._authzr_from_response(response, identifier)\n  File \"/usr/lib/python2.7/site-packages/acme/client.py\", line 175, in _authzr_from_response\n    raise errors.UnexpectedUpdate(authzr)\nUnexpectedUpdate: AuthorizationResource(body=Authorization(status=Status(pending), challenges=(ChallengeBody(chall=TLSSNI01(token='\\xa0\\xa6\\xed\\xe9\\xd9\\xfb\\xe5\\x93M\\xd1\\x0f\\xe2\\xa9\\t\\x8fm\\xc6QJP\\xd0\\xe7\\x89\\xf6-mH\\xdc\\xcf\\x87\\xe5\\x1e'), status=Status(pending), validated=None, uri=u'https://acme-v01.api.letsencrypt.org/acme/challenge/9zX5jF48XFna80Vq-fP-39_mZOs-aKqtvuH4cSZCxSY/1652328589', error=None), ChallengeBody(chall=DNS01(token='W;\\x84*\\xb7\\xd0\\xdd\\xbc\\xfcm\\xd6\\x90\\xc6\\xc85`\\x8f\\xa1\\x97\\xd9:\\xaeC9_Z\\xf6\\x04G\\x89\\xaf!'), status=Status(pending), validated=None, uri=u'https://acme-v01.api.letsencrypt.org/acme/challenge/9zX5jF48XFna80Vq-fP-39_mZOs-aKqtvuH4cSZCxSY/1652328590', error=None), ChallengeBody(chall=HTTP01(token=\"\\xcf\\x9d\\xe7\\xa0\\xe2I\\xfb\\x1f\\x1df\\xb1\\xca\\xcbk\\x8ea\\xef'\\xaf\\x9e\\r\\x07\\xa1,\\x80\\xee\\x85M\\xfb\\x8e\\x063\"), status=Status(pending), validated=None, uri=u'https://acme-v01.api.letsencrypt.org/acme/challenge/9zX5jF48XFna80Vq-fP-39_mZOs-aKqtvuH4cSZCxSY/1652328591', error=None)), identifier=Identifier(typ=IdentifierType(dns), value=u'bebuzzy.de'), expires=datetime.datetime(2017, 8, 7, 7, 32, 4, 136199, tzinfo=<UTC>), combinations=((2,), (1,), (0,))), new_cert_uri=None, uri='https://acme-v01.api.letsencrypt.org/acme/authz/9zX5jF48XFna80Vq-fP-39_mZOs-aKqtvuH4cSZCxSY')\nDo you have any idea what this is about?. @Farkal I did change the file, what do I have to do for it to take effect? Cheers\nUpdate: meteor mup restart does the trick. @BoyPersoon there was another issue somewhere here, where a bit of a hack was described.\nLog on your server go to /opt/<YourAppName>/config open start.sh and change HTTPS_METHOD=noredirect to HTTPS_METHOD=redirect\nThis did the trick for me.. Very strange, you sure you set up nginx in your mup.js? Check https://github.com/zodern/meteor-up/issues/663. ",
    "gitTerebi": "I had problem where I couldn't connect over https:\nIn domain line, I just added one entry to the subdomain that the app sat on and after that did setup-> deploy and it worked.. Actually if you turn on --verbose you can see that the error is for all files in the tar. Its just a matter of which one it fails on last depending on what packages.\nUploading to a normal ubuntu image on a vps hosted by luna node. So its not host dependent. \nIt works on Mac OSX, just not on win10.. The above works!\nIf on 14.04 you need to do \n\nservice ssh restart\n\nAdditionally, I didn't need to touch the authorized_keys file. All you need to do is enable root to login over SSH.. The question is why it works on OSX but not on Windows without having to enable root. Maybe there needs to be a sudo in sh scripts?. Agreed, it undermines the entire point of ubuntu instead of root for security reasons.. Awesome news. ",
    "MaximilianRaschle": "@chrissanders Step Number 2 fixed it for me. \nThank you for the details.\n\nMup v.1.4.3\nMeteor v1.6.1\nNode v9.8.0\n. \n",
    "ShrinathGupta": "+1. ",
    "Tim-W": "After running apt-get purge lxc && apt-get autoremove, the problem went away.. ",
    "ken4ward": "@sethjgore what do you mean by \"make sure www. is actually already set up\". Do you mean I should have bought the domain before trying to configure it? Because I do not have it ready. Just added to the config to buy the domain later.. Thanks. When I ran deploy with verbose flag I got this\n```\nC:\\Programs\\contract\\schoolapps.deploy>mup.cmd deploy --verbose\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[xxx.xxx.xxx.xxx] - Pushing Meteor App Bundle to The Server\n[xxx.xxx.xxx.xxx] - Pushing Meteor App Bundle to The Server: SUCCESS\n[xxx.xxx.xxx.xxx] - Prepare Bundle\nbase: Pulling from abernix/meteord\nDigest: sha256:680d55194f4cce47dac3373ad54d7c3ca53e28e7c8f40d29ef43f82fa460da4b\nStatus: Image is up to date for abernix/meteord:base\nError response from daemon: No such container: schoolapps\nSending build context to Docker daemon  182.6MB\nStep 1/6 : FROM abernix/meteord:base\nExecuting 1 build trigger...\nStep 1/1 : ENV NODE_VERSION ${NODE_VERSION:-4.8.3}\n ---> Using cache\n ---> 130e594b9e5b\nStep 2/6 : RUN mkdir /built_app\n ---> Using cache\n ---> f9dded94d76e\nStep 3/6 : COPY ./ /built_app\n ---> 0bd6e0c0ca4e\nStep 4/6 : ENV ROOT_URL http://christdoes.openschool.com\n ---> Running in 586e513bab3d\n ---> f9c0ac46a246\nRemoving intermediate container 586e513bab3d\nStep 5/6 : ENV MONGO_URL mongodb://mongodb:27017/schoolapps\n ---> Running in ccba09542b9c\n ---> 06f352515b0a\nRemoving intermediate container ccba09542b9c\nStep 6/6 : RUN cd  /built_app/programs/server &&     npm install --unsafe-perm\n ---> Running in 362b06178d27\n\nfibers@1.0.15 install /built_app/programs/server/node_modules/fibers\nnode build.js || nodejs build.js\n\nlinux-x64-46 exists; testing\nBinary is fine; exiting\n\nmeteor-dev-bundle@0.0.0 install /built_app/programs/server\nnode npm-rebuild.js\nbson@0.2.21 install /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/bson\n(node-gyp rebuild 2> builderror.log) || (exit 0)\n\nmake: Entering directory '/built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/bson/build'\n  CXX(target) Release/obj.target/bson/ext/bson.o\nbson.target.mk:94: recipe for target 'Release/obj.target/bson/ext/bson.o' failed\nmake: Leaving directory '/built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/bson/build'\n\nkerberos@0.0.9 install /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/kerberos\n(node-gyp rebuild 2> builderror.log) || (exit 0)\n\nmake: Entering directory '/built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/kerberos/build'\n  CXX(target) Release/obj.target/kerberos/lib/kerberos.o\nkerberos.target.mk:100: recipe for target 'Release/obj.target/kerberos/lib/kerberos.o' failed\nmake: Leaving directory '/built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/kerberos/build'\ngridfs-stream@0.5.3 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/gridfs-stream\nmongodb@1.4.35 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb\nbson@0.2.21 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/bson\nnan@1.7.0 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/bson/node_modules/nan\nkerberos@0.0.9 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/kerberos\nnan@1.6.2 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/kerberos/node_modules/nan\nreadable-stream@1.0.33 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/readable-stream\ncore-util-is@1.0.1 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/readable-stream/node_modules/core-util-is\nisarray@0.0.1 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/readable-stream/node_modules/isarray\nstring_decoder@0.10.31 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/readable-stream/node_modules/string_decoder\ninherits@2.0.1 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/readable-stream/node_modules/inherits\n\nbcrypt@1.0.2 install /built_app/programs/server/npm/node_modules/bcrypt\nnode-pre-gyp install --fallback-to-build\n\n[bcrypt] Success: \"/built_app/programs/server/npm/node_modules/bcrypt/lib/binding/bcrypt_lib.node\" is installed via remote\nnpm ERR! Linux 4.4.0-31-generic\nnpm ERR! argv \"/opt/nodejs/bin/node\" \"/opt/nodejs/bin/npm\" \"rebuild\" \"--update-binary\"\nnpm ERR! node v4.8.3\nnpm ERR! npm  v3.10.10\nnpm ERR! path /built_app/programs/server/npm/node_modules/sshpk/bin\\sshpk-conv\nnpm ERR! code ENOENT\nnpm ERR! errno -2\nnpm ERR! syscall chmod\nnpm ERR! enoent ENOENT: no such file or directory, chmod '/built_app/programs/server/npm/node_modules/sshpk/bin\\sshpk-conv'\nnpm ERR! enoent ENOENT: no such file or directory, chmod '/built_app/programs/server/npm/node_modules/sshpk/bin\\sshpk-conv'\nnpm ERR! enoent This is most likely not a problem with npm itself\nnpm ERR! enoent and is related to npm not being able to find a file.\nnpm ERR! enoent\nnpm ERR! Please include the following file with any support request:\nnpm ERR!     /built_app/programs/server/npm/npm-debug.log\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\nnpm ERR! Linux 4.4.0-31-generic\nnpm ERR! argv \"/opt/nodejs/bin/node\" \"/usr/bin/npm\" \"install\" \"--unsafe-perm\"\nnpm ERR! node v4.8.3\nnpm ERR! npm  v3.10.10\nnpm ERR! code ELIFECYCLE\nnpm ERR! meteor-dev-bundle@0.0.0 install: node npm-rebuild.js\nnpm ERR! Exit status 254\nnpm ERR!\nnpm ERR! Failed at the meteor-dev-bundle@0.0.0 install script 'node npm-rebuild.js'.\nnpm ERR! Make sure you have the latest version of node.js and npm installed.\nnpm ERR! If you do, this is most likely a problem with the meteor-dev-bundle package,\nnpm ERR! not with npm itself.\nnpm ERR! Tell the author that this fails on your system:\nnpm ERR!     node npm-rebuild.js\nnpm ERR! You can get information on how to open an issue for this project with:\nnpm ERR!     npm bugs meteor-dev-bundle\nnpm ERR! Or if that isn't available, you can get their info via:\nnpm ERR!     npm owner ls meteor-dev-bundle\nnpm ERR! There is likely additional logging output above.\nnpm ERR! Please include the following file with any support request:\nnpm ERR!     /built_app/programs/server/npm-debug.log\nThe command '/bin/sh -c cd  /built_app/programs/server &&     npm install --unsafe-perm' returned a non-zero code: 1\nError response from daemon: No such container: schoolapps\nError: failed to start containers: schoolapps\n[xxx.xxx.xxx.xxx] x Prepare Bundle: FAILED\n    -----------------------------------STDERR-----------------------------------\n    Error response from daemon: No such container: schoolapps\n    The command '/bin/sh -c cd  /built_app/programs/server &&     npm install --unsafe-perm' returned a non-zero code: 1\n    Error response from daemon: No such container: schoolapps\n    Error: failed to start containers: schoolapps\n    -----------------------------------STDOUT-----------------------------------\n    rm\"\n    npm ERR! node v4.8.3\n    npm ERR! npm  v3.10.10\n    npm ERR! code ELIFECYCLE\n    npm ERR! meteor-dev-bundle@0.0.0 install: `node npm-rebuild.js`\n    npm ERR! Exit status 254\n    npm ERR!\n    npm ERR! Failed at the meteor-dev-bundle@0.0.0 install script 'node npm-rebuild.js'.\n    npm ERR! Make sure you have the latest version of node.js and npm installed.\n    npm ERR! If you do, this is most likely a problem with the meteor-dev-bundle package,\n    npm ERR! not with npm itself.\n    npm ERR! Tell the author that this fails on your system:\n    npm ERR!     node npm-rebuild.js\n    npm ERR! You can get information on how to open an issue for this project with:\n    npm ERR!     npm bugs meteor-dev-bundle\n    npm ERR! Or if that isn't available, you can get their info via:\n    npm ERR!     npm owner ls meteor-dev-bundle\n    npm ERR! There is likely additional logging output above.\n\n    npm ERR! Please include the following file with any support request:\n    npm ERR!     /built_app/programs/server/npm-debug.log\n\n    ----------------------------------------------------------------------------\n\nC:\\Programs\\contract\\schoolapps.deploy>mup.cmd deploy --cached-build --verbose\nNot building app. Using build from previous deploy at\nC:\\Users\\Kehinde\\AppData\\Local\\Temp\\mup-meteor-58e876b4-e682-4ecf-9d41-168fa46a5b19\nStarted TaskList: Pushing Meteor App\n[xxx.xxx.xxx.xxx] - Pushing Meteor App Bundle to The Server\n. when I ran docker images it returns empty names for the supposed images I guess for schoolapps\nroot@hostname:~# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\n               06f352515b0a        41 minutes ago      659MB\n               e29de6b55976        About an hour ago   659MB\nabernix/meteord     base                7941fc48936e        2 months ago        520MB\nmongo               3.4.1               0dffc7177b06        8 months ago        402MB\nroot@christdoes:~#\n. Only mongo container was created\nroot@christdoes:~# docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                        NAMES\n2e7f21a50dfb        mongo:3.4.1         \"/entrypoint.sh mo...\"   2 hours ago         Up 2 hours          127.0.0.1:27017->27017/tcp   mongodb\n```\n. Thanks to everyone. It's a success story this time. My big thank you to you all. As suggested by great minds here I finally was able to deploy it using  https://github.com/mrauhu/meteord. My qestion now is that how do I view the site on the browser? Sorry, this may seems very childish, morever, I'm a child when it comes to development using Meteor. I used the IP in the browser and it returns 502 gateway. I made se of the root_url: https://schoolapps.com/ too and it returned a config page. How do I view the website on the browser?\nThis is the success log \n```\nC:\\Programs\\contract\\schoolapps.deploy>mup.cmd setup\nStarted TaskList: Setup Docker\n[xxx.xxx.xxx.xxx] - Setup Docker\n[xxx.xxx.xxx.xxx] - Setup Docker: SUCCESS\nStarted TaskList: Setup Meteor\n[xxx.xxx.xxx.xxx] - Setup Environment\n[xxx.xxx.xxx.xxx] - Setup Environment: SUCCESS\nStarted TaskList: Setup Mongo\n[xxx.xxx.xxx.xxx] - Setup Environment\n[xxx.xxx.xxx.xxx] - Setup Environment: SUCCESS\n[xxx.xxx.xxx.xxx] - Copying mongodb.conf\n[xxx.xxx.xxx.xxx] - Copying mongodb.conf: SUCCESS\nStarted TaskList: Start Mongo\n[xxx.xxx.xxx.xxx] - Start Mongo\n[xxx.xxx.xxx.xxx] - Start Mongo: SUCCESS\nNext, you should run:\n    mup deploy\nC:\\Programs\\contract\\schoolapps.deploy>mup.cmd deploy --cached-build --verbose\nFixing npm dependencies bin paths\nNot building app. Using build from previous deploy at\nC:\\Users\\Kehinde\\AppData\\Local\\Temp\\mup-meteor-58e876b4-e682-4ecf-9d41-168fa46a5b19\nStarted TaskList: Pushing Meteor App\n[xxx.xxx.xxx.xxx] - Pushing Meteor App Bundle to The Server\n[xxx.xxx.xxx.xxx] - Pushing Meteor App Bundle to The Server: SUCCESS\n[xxx.xxx.xxx.xxx] - Prepare Bundle\nError response from daemon: No such image: mup-schoolapps:latest\n[xxx.xxx.xxx.xxx] - Prepare Bundle: SUCCESS\nStarted TaskList: Configuring App\n[xxx.xxx.xxx.xxx] - Pushing the Startup Script\n[xxx.xxx.xxx.xxx] - Pushing the Startup Script: SUCCESS\n[xxx.xxx.xxx.xxx] - Sending Environment Variables\n[xxx.xxx.xxx.xxx] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[xxx.xxx.xxx.xxx] - Start Meteor\nError: No such image: mup-schoolapps:latest\nusing bundle\nmv: cannot stat 'current': No such file or directory\nError response from daemon: No such image: mup-schoolapps:previous\nError: No such image: mup-schoolapps:previous\nError: No such image: mup-schoolapps:latest\nImage mrauhu/meteord:node-4.8.4-base\nVolume --volume=/opt/schoolapps/current:/bundle\nRemoving docker containers. Errors about nonexistent endpoints and containers are normal.\nError response from daemon: No such container: schoolapps\nError response from daemon: endpoint schoolapps not found\nError response from daemon: No such container: schoolapps-frontend\nError response from daemon: endpoint schoolapps-frontend not found\nError response from daemon: No such container: schoolapps-nginx-letsencrypt\nError response from daemon: endpoint schoolapps-nginx-letsencrypt not found\nError response from daemon: No such container: schoolapps-nginx-proxy\nError response from daemon: endpoint schoolapps-nginx-proxy not found\nFinished removing docker containers\nnode-4.8.4-base: Pulling from mrauhu/meteord\n9f0706ba7422: Pulling fs layer\n63b9486767cb: Pulling fs layer\n81035f5a7a18: Pulling fs layer\n092fc161592f: Pulling fs layer\ne55c52ce8efa: Pulling fs layer\nc1611ec2715d: Pulling fs layer\n092fc161592f: Waiting\ne55c52ce8efa: Waiting\nc1611ec2715d: Waiting\n63b9486767cb: Download complete\n9f0706ba7422: Verifying Checksum\n9f0706ba7422: Download complete\n092fc161592f: Verifying Checksum\n092fc161592f: Download complete\n9f0706ba7422: Pull complete\n63b9486767cb: Pull complete\nc1611ec2715d: Download complete\ne55c52ce8efa: Verifying Checksum\ne55c52ce8efa: Download complete\n81035f5a7a18: Verifying Checksum\n81035f5a7a18: Download complete\n81035f5a7a18: Pull complete\n092fc161592f: Pull complete\ne55c52ce8efa: Pull complete\nc1611ec2715d: Pull complete\nDigest: sha256:6259a8fb9c9e6612eba803d1f313566a8f41eabbe74d465d0260241dbe77b5a7\nStatus: Downloaded newer image for mrauhu/meteord:node-4.8.4-base\nPulled mrauhu/meteord:node-4.8.4-base\naaec511f58ed85712d24e6e05d8c6d8d633919468c0d62ac74209bea542e4cbc\nRan mrauhu/meteord:node-4.8.4-base\nRunning autogenerate\n--2017-09-18 15:09:19--  https://raw.githubusercontent.com/jwilder/nginx-proxy/master/nginx.tmpl\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 10529 (10K) [text/plain]\nSaving to: \u2018/opt/schoolapps/config/nginx.tmpl\u2019\n 0K ..........                                            100% 38.1M=0s\n\n2017-09-18 15:09:19 (38.1 MB/s) - \u2018/opt/schoolapps/config/nginx.tmpl\u2019 saved [10529/10529]\nlatest: Pulling from jrcs/letsencrypt-nginx-proxy-companion\n224c136cf25d: Pulling fs layer\n2af7fe27fcfb: Pulling fs layer\nc06acb7003e2: Pulling fs layer\n0f9a4aa002dc: Pulling fs layer\n4bc4f7406b16: Pulling fs layer\nb4b1ab2dfb4a: Pulling fs layer\n0f9a4aa002dc: Waiting\n4bc4f7406b16: Waiting\nb4b1ab2dfb4a: Waiting\nc06acb7003e2: Verifying Checksum\nc06acb7003e2: Download complete\n2af7fe27fcfb: Verifying Checksum\n2af7fe27fcfb: Download complete\n0f9a4aa002dc: Verifying Checksum\n0f9a4aa002dc: Download complete\n224c136cf25d: Verifying Checksum\n224c136cf25d: Download complete\nb4b1ab2dfb4a: Verifying Checksum\nb4b1ab2dfb4a: Download complete\n224c136cf25d: Pull complete\n2af7fe27fcfb: Pull complete\n4bc4f7406b16: Verifying Checksum\n4bc4f7406b16: Download complete\nc06acb7003e2: Pull complete\n0f9a4aa002dc: Pull complete\n4bc4f7406b16: Pull complete\nb4b1ab2dfb4a: Pull complete\nDigest: sha256:309cf1185b945203c6a0eadca60672be19d788afeffdb24e39b213e17ad74f27\nStatus: Downloaded newer image for jrcs/letsencrypt-nginx-proxy-companion:latest\nlatest: Pulling from jwilder/nginx-proxy\nafeb2bfd31c0: Pulling fs layer\n7ff5d10493db: Pulling fs layer\nd2562f1ae1d0: Pulling fs layer\nbf9bd4b970a6: Pulling fs layer\n4bf8c5c17ee0: Pulling fs layer\n1fcd9b18e896: Pulling fs layer\n49e6cf59bf28: Pulling fs layer\nf5d927103906: Pulling fs layer\n4bc40b9537d5: Pulling fs layer\nbf9bd4b970a6: Waiting\n4bf8c5c17ee0: Waiting\n1fcd9b18e896: Waiting\n49e6cf59bf28: Waiting\nf5d927103906: Waiting\n4bc40b9537d5: Waiting\nd2562f1ae1d0: Download complete\nafeb2bfd31c0: Verifying Checksum\nafeb2bfd31c0: Download complete\nbf9bd4b970a6: Verifying Checksum\nbf9bd4b970a6: Download complete\n4bf8c5c17ee0: Verifying Checksum\n4bf8c5c17ee0: Download complete\n7ff5d10493db: Verifying Checksum\n7ff5d10493db: Download complete\n1fcd9b18e896: Verifying Checksum\n1fcd9b18e896: Download complete\n49e6cf59bf28: Verifying Checksum\n49e6cf59bf28: Download complete\n4bc40b9537d5: Download complete\nf5d927103906: Verifying Checksum\nf5d927103906: Download complete\nafeb2bfd31c0: Pull complete\n7ff5d10493db: Pull complete\nd2562f1ae1d0: Pull complete\nbf9bd4b970a6: Pull complete\n4bf8c5c17ee0: Pull complete\n1fcd9b18e896: Pull complete\n49e6cf59bf28: Pull complete\nf5d927103906: Pull complete\n4bc40b9537d5: Pull complete\nDigest: sha256:66f958b69f27645108ea81dc08977c57ba34f452b4f3688c668823ecadb28486\nStatus: Downloaded newer image for jwilder/nginx-proxy:latest\nPulled autogenerate images\n91a9b772e5a739f8ca2bb2d6b205365d3983c50c4f3d2fc297e368ff4bfc7874\nRan nginx-proxy\n9a8f39481957694e816db4cc1ca55f7b35bd8111e0f40ed07501a3fa39133bde\nRan jrcs/letsencrypt-nginx-proxy-companion\n[xxx.xxx.xxx.xxx] - Start Meteor: SUCCESS\n[xxx.xxx.xxx.xxx] - Verifying Deployment\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   173  100   173    0     0   7331      0 --:--:--:-- --:--:--     0\n502 Bad Gateway\n\n502 Bad Gateway\nnginx/1.13.5\n\n\n-- --:--:-- --:--:--  7521\n[xxx.xxx.xxx.xxx] - Verifying Deployment: SUCCESS\nC:\\Programs\\contract\\schoolapps.deploy>\nC:\\Programs\\contract\\schoolapps.deploy>\n```. Yes. It showed it has been setup successfully. I pasted everything here for professional analysis.. Do you suggest I should omit the encrypt option first before. At least to verify my deployment works. I'll be glad to do that if it is necessary. . Thanks for this wise counsel. I'll. @zodern @kishorvaghani , what do you suggest? I'm not a linux person so many of these are vague to me. All I needed to get running is what I want. Do you suggest Debian would perform better than Ubuntu? If so, help me with the guide to deploy.. @derwaldgeist what's the value you use as letsEncryptEmail:? Can I use any email or it has to be an email of the domain? Example is is my domain is my domain.com. Does the email had to be something like letsEncryptEmail:admin@mydomain.com or I can use any of the generics like letsEncryptEmail: ken4ward@yahoo.com. Do I have to have registered the email with LetsEncrypt. Please help with valid info. Thanks.. @derwaldgeist what's the value you use as letsEncryptEmail:? Can I use any email or it has to be an email of the domain? Example is my domain.com. Does the email have to be something like letsEncryptEmail:admin@mydomain.com or I can use any of the generics like letsEncryptEmail: ken4ward@yahoo.com. Do I have to have registered the email with LetsEncrypt. Please help with valid info. Thanks. Good bless.. ",
    "jLouzado": "Thank you. :)\n. ",
    "NanIsNotANum": "solved the issue by adding --allow-root to the postinstall command in package.json of \"wysiwyg-editor-node-sdk\" ... and I guess it is not reallt related to mup, hence close this issue. cheers.. OK, after trying many times,\nthe problem was solved by stopping all the containers an reboot the server.\nNot sure if it is a fix, but worked for me.. ",
    "hhertogh": "I can close this issue, it was an error linked to the building process of meteor.\nI could resolve it by following: https://github.com/meteor/meteor/issues/8020#issuecomment-265758830\nThanks.. ",
    "PedroJimenez73": "How to downgrade to 1.2.6 please?\n. ",
    "kdekooter": "@ramonbmt could you share your workaround in the meantime?. I found the flaw: the MONGO_OPLOG_URL needs the replicaSet to be set explicity. ",
    "ramonbmt": "Yes I uploaded a pullrequest under my username. . ",
    "Sphincz": "I have a similar problem. After typing 'mup.cmd logs --tail=50' it only shows this. I have the latest meteor version and i'm using abernix docker image.\nPlease help. thanks!\n```\nnpm ERR! enoent ENOENT: no such file or directory, chmod '/bundle/bundle/programs/server/npm/node_modules/sshpk/bin\\sshpk-conv'\nnpm ERR! enoent ENOENT: no such file or directory, chmod '/bundle/bundle/programs/server/npm/node_modules/sshpk/bin\\sshpk-conv'\nnpm ERR! enoent This is most likely not a problem with npm itself\nnpm ERR! enoent and is related to npm not being able to find a file.\nnpm ERR! enoent\nnpm ERR! Please include the following file with any support request:\nnpm ERR!     /bundle/bundle/programs/server/npm/npm-debug.log\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\nnpm ERR! Linux 3.10.0-514.10.2.el7.x86_64\nnpm ERR! argv \"/opt/nodejs/bin/node\" \"/usr/bin/npm\" \"install\" \"--unsafe-perm\"\nnpm ERR! node v4.8.0\nnpm ERR! npm  v3.10.10\nnpm ERR! code ELIFECYCLE\nnpm ERR! meteor-dev-bundle@0.0.0 install: node npm-rebuild.js\nnpm ERR! Exit status 254\nnpm ERR!\nnpm ERR! Failed at the meteor-dev-bundle@0.0.0 install script 'node npm-rebuild.js'.\nnpm ERR! Make sure you have the latest version of node.js and npm installed.\nnpm ERR! If you do, this is most likely a problem with the meteor-dev-bundle package,\nnpm ERR! not with npm itself.\nnpm ERR! Tell the author that this fails on your system:\nnpm ERR!     node npm-rebuild.js\nnpm ERR! You can get information on how to open an issue for this project with:\nnpm ERR!     npm bugs meteor-dev-bundle\nnpm ERR! Or if that isn't available, you can get their info via:\nnpm ERR!     npm owner ls meteor-dev-bundle\nnpm ERR! There is likely additional logging output above.\nnpm ERR! Please include the following file with any support request:\nnpm ERR!     /bundle/bundle/programs/server/npm-debug.log\n```\n. @zodern I've tried that option. It doesn't show any errors now but the deploy verify still fails. I've moved to another solution. Thanks!. ",
    "jamezilla0": "@zodern\n\n. ",
    "embub": "That command returns the exact same as above and exits.. ",
    "cry-chen": "@zodern I have the same problem; when I run the DEBUG line it says \"setup: command not found\"\nWhen I run mup setup --verbose, same thing happens as when I run mup setup, which is that it gets stuck and says \nevents.js:183\n      throw er; // Unhandled 'error' event\n      ^\nError: Timed out while waiting for handshake\n    at Timeout._onTimeout (/usr/local/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2/lib/client.js:138:17)\n    at ontimeout (timers.js:475:11)\n    at tryOnTimeout (timers.js:310:5)\n    at Timer.listOnTimeout (timers.js:270:5)\n. ",
    "Lucbug": "This error can happen if your IP address cannot SSH. Make sure your IP hasn't changed, or change your rules/IP in the security groups of the service you are using.. See https://github.com/zodern/meteor-up/issues/603#issuecomment-359283445. ",
    "PArch": "Partition disk, mongo data not in /var/...\nLe sam. 13 mai 2017 \u00e0 20:29, zodern notifications@github.com a \u00e9crit :\n\n@PArch https://github.com/parch there currently isn't a way, but it\nwouldn't be difficult to add. Before adding another option to the config, I\nwould like to know why you need to change the directory.\n. \n",
    "slinkardbrandon": "Thanks, I've got this resolved now!\nAll I did was this:\n1.) Created a repository on https://hub.docker.com and named it \"slinkardbrandon/wkmeteor\"\n2.) Took my configured docker image (with wk installed) and did a docker commit (using this command):\nsudo docker commit cc6728a075e5 slinkardbrandon/wkmeteor:base\n3.) Changed my mup.js file to reflect the new docker repository.\nAnyone looking for wkhtmltopdf pre-installed on a docker image feel free to use this in your mup file:\ndocker: {\n\u00a0\u00a0\u00a0\u00a0\u00a0image: 'slinkardbrandon/wkmeteor:base'\n},\n. ",
    "mark-alfonso": "Hi @slinkardbrandon -- I know this is just last year but for my use case I need to use the latest docker image abernix/meteord:node-8-base for meteor 1.6.1, could you share the step you did to install wkhtmltopdf?. ",
    "alstephan": "@trevordowdle a workaround for me was to simply not use let's encrypt with mup. Instead put the instance behind CloudFlare (free) and use CloudFlare SSL which auto-renews and needs no management of certs.\nCloudFlare now supports websockets very well out of the box, including the ones needed for Meteor, which is why this workaround is relatively new.. Using CloudFlare SSL now without issues. No Let's Encrypt certs configured manually.\n502 errors usually means there's something wrong with the server or application. I'd try a fresh install and make sure your server is accepting SSL connections without issues (e.g. access and error logs could help).. 525 usually means your app is not set up to accept SSL requests. I'd check the server logs, if you have nginx on there I would also check those logs. I'd also try running the app without a proxy server (nginx), so a bare node app, since your nginx cipher suites may not be compatible with Cloudflare's.\nAlso if you're using strict mode for Cloudflare SSL try removing it (use just Full mode).\nPerhaps this is obvious but also make sure you actually issued a cert with Cloudflare, since your origin server does not have a cert.\n. ",
    "haibo32012": "I got this:\n\nmup logs:\n\n. ",
    "ZubMono": "I'm getting the same error, sometimes It works after trying a lot of times.. ",
    "adrprado": "This is how I configured mine:\n```\nmeteor : {\n    ...\n    env: {\n      PORT: 5000,\n      ROOT_URL: \"https://myserver.com/\",\n      \"http_proxy\": \"http://10.0.0.1:8080\",\n      \"https_proxy\": \"http://10.0.0.1:8080\",\n      \"npm_config_proxy\": \"http://10.0.0.1:8080\",\n      \"npm_config_https_proxy\": \"http://10.0.0.1:8080\"\n    },\n``. I believe themeteor` command is not available after building you app, hence this command is not available in production.. ",
    "mylsb": "Upgrading to the latest version of docker - Docker version 17.05.0-ce, build 89658be resolved this for me.  The server was running 1.8.2 - which was a fair bit out of date \ud83d\ude13.\nThanks @zodern. ",
    "ovidyou": "No, the app is not using Let's Encrypt. That would help, thanks.. @zodern thanks. Unfortunately this still doesn't work when using jabbslad:basic-auth, I get the same curl error as in first post.\nI guess for my use case and other use cases could be really helpful to be able to specify in the mup settings the HTTP status codes that should be treated as valid deployment. If you are willing to have this type of functionality implemented, I could offer my time to create a pull request. Let me know.. @zodern I confirm mup 1.2.10 successfully deployed the app. Big thanks!. ",
    "KoenLav": "@zodern are there any specific issues you expect to run into?\nI suppose adding this functionality would revolve mainly around rewriting:\ndocker\n run \\\n  -d \\\n  --restart=always \\\n  <% if(sslConfig && typeof sslConfig.autogenerate === \"object\")  { %> \\\n  --expose=80 \\\n  <% } else { %> \\\n  --publish=$BIND:$PORT:<%= docker.imagePort %> \\\n  <% } %> \\\n  --volume=$BUNDLE_PATH:/bundle \\\n  --hostname=\"$HOSTNAME-$APPNAME\" \\\n  --env-file=$ENV_FILE \\\n  <% if(useLocalMongo)  { %>--link=mongodb:mongodb --env=MONGO_URL=mongodb://mongodb:27017/$APPNAME <% } %>\\\n  <% if(logConfig && logConfig.driver)  { %>--log-driver=<%= logConfig.driver %> <% } %>\\\n  <% for(var option in logConfig.opts) { %>--log-opt <%= option %>=<%= logConfig.opts[option] %> <% } %>\\\n  <% for(var volume in volumes) { %>-v <%= volume %>:<%= volumes[volume] %> <% } %>\\\n  <% for(var args in docker.args) { %> <%- docker.args[args] %> <% } %>\\\n  <% if(sslConfig && typeof sslConfig.autogenerate === \"object\")  { %> \\\n    -e \"VIRTUAL_HOST=<%= sslConfig.autogenerate.domains %>\" \\\n    -e \"LETSENCRYPT_HOST=<%= sslConfig.autogenerate.domains %>\" \\\n    -e \"LETSENCRYPT_EMAIL=<%= sslConfig.autogenerate.email %>\" \\\n    -e \"HTTPS_METHOD=noredirect\" \\\n  <% } %> \\\n  --name=$APPNAME \\\n  <%= docker.image %>\nRight?\nWe are currently looking into deploying our application to a Docker Swarm (and were already making use of meteor-up). We will be testing ourselves over the next few weeks, but if there are any points you could give us that would be greatly appreciated (willing to create a PR with our test results, possibly already (semi-)working code).. ",
    "adamgins": "@zodern keen to understand more about this please. We have the Swarm requirements... cloud possibly help out. Or if it's already underway, keen to know if you have rough delivery date?. @zodern happy new year... I was just checking in... is there something I could try with swarm?. @zodern just checking in, if this work is still planned?. ",
    "Joeblockmark": "It's working now. For each task it should say:\n[ip] - task\n[ip] - task: SUCCESS . The problem was something very stupid: I was running mup deploy in the wrong folder, but it would be nice if there was a clear error message. When I change the port in mup.js I still get the same error (for 0.0.0.0:80). @trsh yes that looks very similar. could it be related to this issue?. I fixed it by running service docker restart. I'm not sure why this worked but it did. I tried deploying to port 3000 but got the same error: curl: (7) Failed connect to localhost:3000; Connection refused. @zodern what is the maximum sensible time it can be set to? I have tried up to 1400s. @zodern im not sure what you mean by native modules. @zodern how do i differentiate them from other modules. @zodern I updated a few packages and its working now. ",
    "crstn210": "Thanks, my meteor.path was '.' now is '../' it seems to work now . @mroftalp  do you solved this already? . thanks @c316 \ni've did that and now i got this: \n`x Verifying Deployment: FAILED\n    -----------------------------------STDERR-----------------------------------\n    e\n    npm ERR! Or if that isn't available, you can get their info via:\n    npm ERR!     npm owner ls meteor-dev-bundle\n    npm ERR! There is likely additional logging output above.\n\n    npm ERR! Please include the following file with any support request:\n    npm ERR!     /bundle/bundle/programs/server/npm-debug.log\n\n    > meteor-dev-bundle@0.0.0 install /bundle/bundle/programs/server\n    > node npm-rebuild.js\n\n\n    > bcrypt@1.0.2 install /bundle/bundle/programs/server/npm/node_modules/bcrypt\n    > node-pre-gyp install --fallback-to-build\n\n    node-pre-gyp ERR! Tried to download(404): https://github.com/kelektiv/node.bcrypt.js/releases/download/v1.0.2/bcrypt_lib-v1.0.2-node-v46-linux-x64.tar.gz\n    node-pre-gyp ERR! Pre-built binaries not found for bcrypt@1.0.2 and node@4.8.0 (node-v46 ABI) (falling back to source compile with node-gyp)\n    make: Entering directory '/bundle/bundle/programs/server/npm/node_modules/bcrypt/build'\n      CXX(target) Release/obj.target/bcrypt_lib/src/blowfish.o\n\n    => Redeploying previous version of the app\n\n    -----------------------------------STDOUT-----------------------------------\n    localhost:80\n\n    To see more logs type 'mup logs --tail=50'\n\n    ----------------------------------------------------------------------------`\n\n. @mroftalp  i\u00b4ve tried several times, i've even delete the entire folder and cloned the clean repository from github again, and this is the error I get `x Verifying Deployment: FAILED\n    -----------------------------------STDERR-----------------------------------\n     There is likely additional logging output above.\n\n    npm ERR! Please include the following file with any support request:\n    npm ERR!     /bundle/bundle/programs/server/npm-debug.log\n\n    > meteor-dev-bundle@0.0.0 install /bundle/bundle/programs/server\n    > node npm-rebuild.js\n\n\n    > bcrypt@1.0.2 install /bundle/bundle/programs/server/npm/node_modules/bcrypt\n    > node-pre-gyp install --fallback-to-build\n\n    node-pre-gyp ERR! Tried to download(404): https://github.com/kelektiv/node.bcrypt.js/releases/download/v1.0.2/bcrypt_lib-v1.0.2-node-v46-linux-x64.tar.gz\n    node-pre-gyp ERR! Pre-built binaries not found for bcrypt@1.0.2 and node@4.8.0 (node-v46 ABI) (falling back to source compile with node-gyp)\n    make: Entering directory '/bundle/bundle/programs/server/npm/node_modules/bcrypt/build'\n      CXX(target) Release/obj.target/bcrypt_lib/src/blowfish.o\n      CXX(target) Release/obj.target/bcrypt_lib/src/bcrypt.o\n      CXX(target) Release/obj.target/bcrypt_lib/src/bcrypt_node.o\n\n    => Redeploying previous version of the app\n\n    -----------------------------------STDOUT-----------------------------------\n    localhost:80\n\n    To see more logs type 'mup logs --tail=50'\n\n    ----------------------------------------------------------------------------`. i've fixed it uninstalling bcrypt. @zodern  I'm expecting the same issue, meteor 1.6,  abernix/meteord:node-8.4.0-base\n\nmup.cmd logs --tail 100 : \n[]    at Module.load (module.js:507:32)\n[]    at tryModuleLoad (module.js:470:12)\n[]    at Function.Module._load (module.js:462:3)\n[]=> Starting meteor app on port:80\n[]/built_app/programs/server/node_modules/fibers/future.js:280\n[]                                           throw(ex);\n[]                                           ^\n[]\n[]Error: Cannot find module 'bl'\n[]    at Function.Module._resolveFilename (module.js:489:15)\n[]    at Function.Module._load (module.js:439:25)\n[]    at Module.require (module.js:517:17)\n[]    at require (internal/module.js:11:18)\n[]    at Object. (/built_app/programs/server/npm/node_modules/meteor/dfischer_prerenderio/node_modules/prerender-node/node_modules/request/request.js:9:10)\n[]    at Module._compile (module.js:573:30)\n[]    at Object.Module._extensions..js (module.js:584:10)\n[]    at Module.load (module.js:507:32)\n[]    at tryModuleLoad (module.js:470:12)\n[]    at Function.Module._load (module.js:462:3)\n[]=> Starting meteor app on port:80\n. any ideas how to solve this? . same problem here, no errors, and the page doesn't load at all it gives me 502 error  . same problem here (the same app deploys perfectly on meteor 1.5 and mup 1.3.4)\ndeploying from w10\nmeteor 1.6\nmup 1.3.6\nabernix/meteord:node-8.9.1-base\ndigital ocean droplet 1 GB Memory / 20 GB Disk - Ubuntu 16.04.3 x64\n--verbose output : \nC:\\Users\\crist\\Google Drive\\brik>mup.cmd setup\nStarted TaskList: Setup Docker\n[ip] - Setup Docker\n[ip] - Setup Docker: SUCCESS\nStarted TaskList: Setup Meteor\n[ip] - Setup Environment\n[ip] - Setup Environment: SUCCESS\nNext, you should run:\n    mup deploy\nC:\\Users\\crist\\Google Drive\\brik>mup.cmd deploy --verbose\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[ip] - Pushing Meteor App Bundle to the Server\n[ip] - Pushing Meteor App Bundle to the Server: SUCCESS\n[ip] - Prepare Bundle\nnode-8.9.1-base: Pulling from abernix/meteord\nc20dc0c5afeb: Already exists\na3ed95caeb02: Already exists\na3ed95caeb02: Already exists\n2e0854d03c5a: Already exists\na3ed95caeb02: Already exists\na3ed95caeb02: Already exists\na3ed95caeb02: Already exists\nee0c44e34175: Already exists\nc8f24d298302: Already exists\ndc67008717d0: Already exists\na7d6aa508af1: Already exists\na3ed95caeb02: Already exists\na3ed95caeb02: Already exists\nDigest: sha256:9a12326012a41b5ddd2210d5e5d590bb3506bc341a7f5e1540b451e975bb559c\nStatus: Image is up to date for abernix/meteord:node-8.9.1-base\nBrik\nSending build context to Docker daemon  92.28MB\nStep 1/6 : FROM abernix/meteord:node-8.9.1-base\nExecuting 1 build trigger\n---> Using cache\n ---> 1289dbee11b9\nStep 2/6 : RUN mkdir /built_app\n ---> Using cache\n ---> bfe2c763537e\nStep 3/6 : COPY ./ /built_app\n ---> 11ba3c90b227\nStep 4/6 : ENV ROOT_URL=https://brik.com.co\n ---> Running in a77b59dafa04\nRemoving intermediate container a77b59dafa04\n ---> 53eb930bbbef\nStep 5/6 : ENV MONGO_URL=mongodb://xxxxxxxxxxxx@xxxxxxr.com:10260,xxx.mongolayer.com:xxxx/xxxxxxx\n ---> Running in fa0e0617d328\nRemoving intermediate container fa0e0617d328\n ---> a9abe12226b8\nStep 6/6 : RUN cd  /built_app/programs/server &&     npm install --unsafe-perm\n ---> Running in 79c1ae26ed8a\n\nfibers@2.0.0 install /built_app/programs/server/node_modules/fibers\nnode build.js || nodejs build.js\n\nlinux-x64-57 exists; testing\nBinary is fine; exiting\n\nmeteor-dev-bundle@0.0.0 install /built_app/programs/server\nnode npm-rebuild.js\nbcrypt@1.0.3 install /built_app/programs/server/npm/node_modules/bcrypt\nnode-pre-gyp install --fallback-to-build\n\n[bcrypt] Success: \"/built_app/programs/server/npm/node_modules/bcrypt/lib/binding/bcrypt_lib.node\" is installed via remote\nabbrev@1.1.1 /built_app/programs/server/npm/node_modules/abbrev\najv@5.4.0 /built_app/programs/server/npm/node_modules/ajv\nco@4.6.0 /built_app/programs/server/npm/node_modules/co\nfast-deep-equal@1.0.0 /built_app/programs/server/npm/node_modules/fast-deep-equal\nfast-json-stable-stringify@2.0.0 /built_app/programs/server/npm/node_modules/fast-json-stable-stringify\njson-schema-traverse@0.3.1 /built_app/programs/server/npm/node_modules/json-schema-traverse\nangular@1.6.6 /built_app/programs/server/npm/node_modules/angular\nangular-meteor@1.3.12 /built_app/programs/server/npm/node_modules/angular-meteor\njsondiffpatch@0.1.43 /built_app/programs/server/npm/node_modules/jsondiffpatch\nchalk@0.5.1 /built_app/programs/server/npm/node_modules/chalk\nansi-styles@1.1.0 /built_app/programs/server/npm/node_modules/ansi-styles\nescape-string-regexp@1.0.5 /built_app/programs/server/npm/node_modules/escape-string-regexp\nhas-ansi@0.1.0 /built_app/programs/server/npm/node_modules/has-ansi\nansi-regex@0.2.1 /built_app/programs/server/npm/node_modules/ansi-regex\nstrip-ansi@0.3.0 /built_app/programs/server/npm/node_modules/strip-ansi\nsupports-color@0.2.0 /built_app/programs/server/npm/node_modules/supports-color\nunderscore@1.8.3 /built_app/programs/server/npm/node_modules/underscore\nangular-meteor-auth@1.1.1 /built_app/programs/server/npm/node_modules/angular-meteor-auth\nangular-socialshare@2.3.11 /built_app/programs/server/npm/node_modules/angular-socialshare\nangular-update-meta@1.9.0 /built_app/programs/server/npm/node_modules/angular-update-meta\nangularjs-slider@6.4.1 /built_app/programs/server/npm/node_modules/angularjs-slider\naproba@1.2.0 /built_app/programs/server/npm/node_modules/aproba\nare-we-there-yet@1.1.4 /built_app/programs/server/npm/node_modules/are-we-there-yet\ndelegates@1.0.0 /built_app/programs/server/npm/node_modules/delegates\nreadable-stream@2.3.3 /built_app/programs/server/npm/node_modules/readable-stream\ncore-util-is@1.0.2 /built_app/programs/server/npm/node_modules/core-util-is\ninherits@2.0.3 /built_app/programs/server/npm/node_modules/inherits\nisarray@1.0.0 /built_app/programs/server/npm/node_modules/isarray\nprocess-nextick-args@1.0.7 /built_app/programs/server/npm/node_modules/process-nextick-args\nsafe-buffer@5.1.1 /built_app/programs/server/npm/node_modules/safe-buffer\nstring_decoder@1.0.3 /built_app/programs/server/npm/node_modules/string_decoder\nutil-deprecate@1.0.2 /built_app/programs/server/npm/node_modules/util-deprecate\nasn1@0.2.3 /built_app/programs/server/npm/node_modules/asn1\nassert-plus@1.0.0 /built_app/programs/server/npm/node_modules/assert-plus\nasynckit@0.4.0 /built_app/programs/server/npm/node_modules/asynckit\naws-sign2@0.7.0 /built_app/programs/server/npm/node_modules/aws-sign2\naws4@1.6.0 /built_app/programs/server/npm/node_modules/aws4\nbabel-runtime@6.26.0 /built_app/programs/server/npm/node_modules/babel-runtime\ncore-js@2.5.1 /built_app/programs/server/npm/node_modules/core-js\nregenerator-runtime@0.11.0 /built_app/programs/server/npm/node_modules/regenerator-runtime\nbalanced-match@1.0.0 /built_app/programs/server/npm/node_modules/balanced-match\nbcrypt@1.0.3 /built_app/programs/server/npm/node_modules/bcrypt\nnan@2.6.2 /built_app/programs/server/npm/node_modules/nan\nnode-pre-gyp@0.6.36 /built_app/programs/server/npm/node_modules/node-pre-gyp\nmkdirp@0.5.1 /built_app/programs/server/npm/node_modules/mkdirp\nminimist@0.0.8 /built_app/programs/server/npm/node_modules/minimist\nnopt@4.0.1 /built_app/programs/server/npm/node_modules/nopt\nosenv@0.1.4 /built_app/programs/server/npm/node_modules/osenv\nos-homedir@1.0.2 /built_app/programs/server/npm/node_modules/os-homedir\nos-tmpdir@1.0.2 /built_app/programs/server/npm/node_modules/os-tmpdir\nnpmlog@4.1.2 /built_app/programs/server/npm/node_modules/npmlog\nconsole-control-strings@1.1.0 /built_app/programs/server/npm/node_modules/console-control-strings\ngauge@2.7.4 /built_app/programs/server/npm/node_modules/gauge\nhas-unicode@2.0.1 /built_app/programs/server/npm/node_modules/has-unicode\nobject-assign@4.1.1 /built_app/programs/server/npm/node_modules/object-assign\nsignal-exit@3.0.2 /built_app/programs/server/npm/node_modules/signal-exit\nstring-width@1.0.2 /built_app/programs/server/npm/node_modules/string-width\ncode-point-at@1.1.0 /built_app/programs/server/npm/node_modules/code-point-at\nis-fullwidth-code-point@1.0.0 /built_app/programs/server/npm/node_modules/is-fullwidth-code-point\nnumber-is-nan@1.0.1 /built_app/programs/server/npm/node_modules/number-is-nan\nstrip-ansi@3.0.1 /built_app/programs/server/npm/node_modules/string-width/node_modules/strip-ansi\nansi-regex@2.1.1 /built_app/programs/server/npm/node_modules/string-width/node_modules/ansi-regex\nstrip-ansi@3.0.1 /built_app/programs/server/npm/node_modules/gauge/node_modules/strip-ansi\nansi-regex@2.1.1 /built_app/programs/server/npm/node_modules/gauge/node_modules/ansi-regex\nwide-align@1.1.2 /built_app/programs/server/npm/node_modules/wide-align\nset-blocking@2.0.0 /built_app/programs/server/npm/node_modules/set-blocking\nrc@1.2.2 /built_app/programs/server/npm/node_modules/rc\ndeep-extend@0.4.2 /built_app/programs/server/npm/node_modules/deep-extend\nini@1.3.5 /built_app/programs/server/npm/node_modules/ini\nminimist@1.2.0 /built_app/programs/server/npm/node_modules/rc/node_modules/minimist\nstrip-json-comments@2.0.1 /built_app/programs/server/npm/node_modules/strip-json-comments\nrequest@2.83.0 /built_app/programs/server/npm/node_modules/request\ncaseless@0.12.0 /built_app/programs/server/npm/node_modules/caseless\ncombined-stream@1.0.5 /built_app/programs/server/npm/node_modules/combined-stream\ndelayed-stream@1.0.0 /built_app/programs/server/npm/node_modules/delayed-stream\nextend@3.0.1 /built_app/programs/server/npm/node_modules/extend\nforever-agent@0.6.1 /built_app/programs/server/npm/node_modules/forever-agent\nform-data@2.3.1 /built_app/programs/server/npm/node_modules/form-data\nmime-types@2.1.17 /built_app/programs/server/npm/node_modules/mime-types\nmime-db@1.30.0 /built_app/programs/server/npm/node_modules/mime-db\nhar-validator@5.0.3 /built_app/programs/server/npm/node_modules/har-validator\nhar-schema@2.0.0 /built_app/programs/server/npm/node_modules/har-schema\nhawk@6.0.2 /built_app/programs/server/npm/node_modules/hawk\nboom@4.3.1 /built_app/programs/server/npm/node_modules/boom\nhoek@4.2.0 /built_app/programs/server/npm/node_modules/hoek\ncryptiles@3.1.2 /built_app/programs/server/npm/node_modules/cryptiles\nboom@5.2.0 /built_app/programs/server/npm/node_modules/cryptiles/node_modules/boom\nsntp@2.1.0 /built_app/programs/server/npm/node_modules/sntp\nhttp-signature@1.2.0 /built_app/programs/server/npm/node_modules/http-signature\njsprim@1.4.1 /built_app/programs/server/npm/node_modules/jsprim\nextsprintf@1.3.0 /built_app/programs/server/npm/node_modules/extsprintf\njson-schema@0.2.3 /built_app/programs/server/npm/node_modules/json-schema\nverror@1.10.0 /built_app/programs/server/npm/node_modules/verror\nsshpk@1.13.1 /built_app/programs/server/npm/node_modules/sshpk\ndashdash@1.14.1 /built_app/programs/server/npm/node_modules/dashdash\ngetpass@0.1.7 /built_app/programs/server/npm/node_modules/getpass\nis-typedarray@1.0.0 /built_app/programs/server/npm/node_modules/is-typedarray\nisstream@0.1.2 /built_app/programs/server/npm/node_modules/isstream\njson-stringify-safe@5.0.1 /built_app/programs/server/npm/node_modules/json-stringify-safe\noauth-sign@0.8.2 /built_app/programs/server/npm/node_modules/oauth-sign\nperformance-now@2.1.0 /built_app/programs/server/npm/node_modules/performance-now\nqs@6.5.1 /built_app/programs/server/npm/node_modules/qs\nstringstream@0.0.5 /built_app/programs/server/npm/node_modules/stringstream\ntough-cookie@2.3.3 /built_app/programs/server/npm/node_modules/tough-cookie\npunycode@1.4.1 /built_app/programs/server/npm/node_modules/punycode\ntunnel-agent@0.6.0 /built_app/programs/server/npm/node_modules/tunnel-agent\nuuid@3.1.0 /built_app/programs/server/npm/node_modules/uuid\nrimraf@2.6.2 /built_app/programs/server/npm/node_modules/rimraf\nglob@7.1.2 /built_app/programs/server/npm/node_modules/glob\nfs.realpath@1.0.0 /built_app/programs/server/npm/node_modules/fs.realpath\ninflight@1.0.6 /built_app/programs/server/npm/node_modules/inflight\nonce@1.4.0 /built_app/programs/server/npm/node_modules/once\nwrappy@1.0.2 /built_app/programs/server/npm/node_modules/wrappy\nminimatch@3.0.4 /built_app/programs/server/npm/node_modules/minimatch\nbrace-expansion@1.1.8 /built_app/programs/server/npm/node_modules/brace-expansion\nconcat-map@0.0.1 /built_app/programs/server/npm/node_modules/concat-map\npath-is-absolute@1.0.1 /built_app/programs/server/npm/node_modules/path-is-absolute\nsemver@5.4.1 /built_app/programs/server/npm/node_modules/semver\ntar@2.2.1 /built_app/programs/server/npm/node_modules/tar\nblock-stream@0.0.9 /built_app/programs/server/npm/node_modules/block-stream\nfstream@1.0.11 /built_app/programs/server/npm/node_modules/fstream\ngraceful-fs@4.1.11 /built_app/programs/server/npm/node_modules/graceful-fs\ntar-pack@3.4.1 /built_app/programs/server/npm/node_modules/tar-pack\ndebug@2.6.9 /built_app/programs/server/npm/node_modules/debug\nms@2.0.0 /built_app/programs/server/npm/node_modules/ms\nfstream-ignore@1.0.5 /built_app/programs/server/npm/node_modules/fstream-ignore\nuid-number@0.0.6 /built_app/programs/server/npm/node_modules/uid-number\nbcrypt-pbkdf@1.0.1 /built_app/programs/server/npm/node_modules/bcrypt-pbkdf\ntweetnacl@0.14.5 /built_app/programs/server/npm/node_modules/tweetnacl\necc-jsbn@0.1.1 /built_app/programs/server/npm/node_modules/ecc-jsbn\njsbn@0.1.1 /built_app/programs/server/npm/node_modules/jsbn\njquery@3.2.1 /built_app/programs/server/npm/node_modules/jquery\nmeteor-node-stubs@0.2.11 /built_app/programs/server/npm/node_modules/meteor-node-stubs\nassert@1.4.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/assert\nutil@0.10.3 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/util\ninherits@2.0.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/inherits\nbrowserify-zlib@0.1.4 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/browserify-zlib\npako@0.2.9 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/pako\nbuffer@4.9.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/buffer\nbase64-js@1.2.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/base64-js\nieee754@1.1.8 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/ieee754\nisarray@1.0.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/isarray\nconsole-browserify@1.1.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/console-browserify\ndate-now@0.1.4 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/date-now\nconstants-browserify@1.0.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/constants-browserify\ncrypto-browserify@3.11.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/crypto-browserify\nbrowserify-cipher@1.0.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/browserify-cipher\nbrowserify-aes@1.0.6 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/browserify-aes\nbuffer-xor@1.0.3 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/buffer-xor\ncipher-base@1.0.3 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/cipher-base\ncreate-hash@1.1.2 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/create-hash\nripemd160@1.0.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/ripemd160\nsha.js@2.4.8 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/sha.js\nevp_bytestokey@1.0.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/evp_bytestokey\nbrowserify-des@1.0.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/browserify-des\ndes.js@1.0.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/des.js\nminimalistic-assert@1.0.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/minimalistic-assert\nbrowserify-sign@4.0.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/browserify-sign\nbn.js@4.11.6 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/bn.js\nbrowserify-rsa@4.0.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/browserify-rsa\nrandombytes@2.0.3 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/randombytes\ncreate-hmac@1.1.4 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/create-hmac\nelliptic@6.3.2 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/elliptic\nbrorand@1.0.6 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/brorand\nhash.js@1.0.3 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/hash.js\nparse-asn1@5.0.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/parse-asn1\nasn1.js@4.9.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/asn1.js\npbkdf2@3.0.9 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/pbkdf2\ncreate-ecdh@4.0.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/create-ecdh\ndiffie-hellman@5.0.2 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/diffie-hellman\nmiller-rabin@4.0.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/miller-rabin\npublic-encrypt@4.0.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/public-encrypt\ndomain-browser@1.1.7 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/domain-browser\nevents@1.1.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/events\nhttp-browserify@1.7.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/http-browserify\nBase64@0.2.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/Base64\nhttps-browserify@0.0.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/https-browserify\nos-browserify@0.2.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/os-browserify\npath-browserify@0.0.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/path-browserify\nprocess@0.11.9 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/process\npunycode@1.4.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/punycode\nquerystring-es3@0.2.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/querystring-es3\nreadable-stream@2.2.10 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/readable-stream\nprocess-nextick-args@1.0.7 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/process-nextick-args\nsafe-buffer@5.0.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/safe-buffer\nstring_decoder@1.0.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/string_decoder\nutil-deprecate@1.0.2 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/util-deprecate\nstream-browserify@2.0.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/stream-browserify\ntimers-browserify@1.4.2 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/timers-browserify\ntty-browserify@0.0.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/tty-browserify\nurl@0.11.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/url\npunycode@1.3.2 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/url/node_modules/punycode\nquerystring@0.2.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/querystring\nvm-browserify@0.0.4 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/vm-browserify\nindexof@0.0.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/indexof\nbalanced-match@0.4.2 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/balanced-match\nbrace-expansion@1.1.7 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/brace-expansion\nconcat-map@0.0.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/concat-map\nfs.realpath@1.0.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/fs.realpath\nglob@7.1.2 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/glob\ninflight@1.0.6 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/inflight\nonce@1.4.0 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/once\nwrappy@1.0.2 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/wrappy\nminimatch@3.0.4 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/minimatch\npath-is-absolute@1.0.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/path-is-absolute\nrimraf@2.6.1 /built_app/programs/server/npm/node_modules/meteor-node-stubs/node_modules/rimraf\nowl.carousel@2.2.0 /built_app/programs/server/npm/node_modules/owl.carousel\n{\n  \"meteor-dev-bundle\": \"0.0.0\",\n  \"npm\": \"5.5.1\",\n  \"ares\": \"1.10.1-DEV\",\n  \"cldr\": \"31.0.1\",\n  \"http_parser\": \"2.7.0\",\n  \"icu\": \"59.1\",\n  \"modules\": \"57\",\n  \"nghttp2\": \"1.25.0\",\n  \"node\": \"8.9.1\",\n  \"openssl\": \"1.0.2m\",\n  \"tz\": \"2017b\",\n  \"unicode\": \"9.0\",\n  \"uv\": \"1.15.0\",\n  \"v8\": \"6.1.534.47\",\n  \"zlib\": \"1.2.11\"\n}\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\nadded 136 packages in 6.888s\nRemoving intermediate container 79c1ae26ed8a\n ---> 4785e30bac9d\nSuccessfully built 4785e30bac9d\nSuccessfully tagged mup-brik:build\nBrik\nDeleted Images:\ndeleted: sha256:8761631899edd7f3e9db1c8868f5642e5bcdd78304e2a5dcc6538f6efe15d974\ndeleted: sha256:92c50769ef9f36b1df6e22aca49af25cd210f8c974d4ecff9c2df60b80645bed\ndeleted: sha256:17af72d026b41f4688e3aec6f832d707f52c1394317c23c760a58e5ce0ae869a\ndeleted: sha256:2adf862e0cac2942bb5e6c3ca065af7a445af443521e90e4874965eec7c4fbc3\ndeleted: sha256:8c762c820f47780b7008769762b403180acebe8fd9d145f3b65a7eaa45bf13ad\ndeleted: sha256:5b23b463243dc934eacb6dc90cd79f31243d6289a0a696e1d9cc96217a9ddfd0\ndeleted: sha256:f354c09755d59f57ebb3e9842e3c51c6b6cc18a8bc24e6622daf9ee5e9edc886\ndeleted: sha256:38ad33123b45439bea531fada29a12b2bec7d9f3ae2719546995236bd464d17c\ndeleted: sha256:64869d01f8dcd4f3c2f8f7785cfb39fe42eda7f364187f4d2036318de890f0b1\nTotal reclaimed space: 85.18MB\n[ip] - Prepare Bundle: SUCCESS\nStarted TaskList: Configuring App\n[ip] - Pushing the Startup Script\n[ip] - Pushing the Startup Script: SUCCESS\n[ip] - Sending Environment Variables\n[ip] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[ip] - Start Meteor\nusing image\nremoving last\nImage mup-brik:latest\nVolume\nRemoving docker containers. Errors about nonexistent endpoints and containers are normal.\nBrik\nError response from daemon: endpoint Brik not found\nError: No such container: Brik-frontend\nError response from daemon: endpoint Brik-frontend not found\nBrik-nginx-letsencrypt\nError response from daemon: endpoint Brik-nginx-letsencrypt not found\nBrik-nginx-proxy\nError response from daemon: endpoint Brik-nginx-proxy not found\nFinished removing docker containers\n049035d48b4a2d88c4ba8182caa66bf5999cd899bcefe23c8a8796b06a9f2517\nRan abernix/meteord:node-8.9.1-base\nRunning autogenerate\n--2017-11-28 13:50:11--  https://raw.githubusercontent.com/jwilder/nginx-proxy/master/nginx.tmpl\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.20.133\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.20.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 11745 (11K) [text/plain]\nSaving to: \u2018/opt/Brik/config/nginx.tmpl\u2019\n 0K .......... .                                          100% 21.9M=0.001s\n\n2017-11-28 13:50:11 (21.9 MB/s) - \u2018/opt/Brik/config/nginx.tmpl\u2019 saved [11745/11745]\nlatest: Pulling from jrcs/letsencrypt-nginx-proxy-companion\nDigest: sha256:614f83eb3285c7a514fc614973daa2d898062f0c2065dec2a25b1c008c509231\nStatus: Image is up to date for jrcs/letsencrypt-nginx-proxy-companion:latest\nlatest: Pulling from jwilder/nginx-proxy\nDigest: sha256:3f2db613a6cfc0eb426a9b9459aeb4091a6b0247a834ce39fabfc6bd1b2d02a1\nStatus: Image is up to date for jwilder/nginx-proxy:latest\nPulled autogenerate images\n7f271782211a52a273aa5cbfc15d2acac2e436623e9e634080bf2d3b65f6ba84\nRan nginx-proxy\nd6c6658d73e15f4734f4ec3de4f6c8cac80d76857fbd0a0d57f16d1adb6e7df3\nRan jrcs/letsencrypt-nginx-proxy-companion\n[ip] - Start Meteor: SUCCESS\n[ip] - Verifying Deployment\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   173  100   173    0     0  18212      0 --:--:-- --:--:-- --:--:-- 19222\n\n502 Bad Gateway\n\n502 Bad Gateway\nnginx/1.13.7\n\n\n[ip] - Verifying Deployment: SUCCESS\nany ideas ? \n. ",
    "vfoley": "I have this same problem but, it only goes away with a restart of docker on Windows 10. I even changed the ports of my container to try to make a difference. This had no effect. As soon as I restart the docker service everything works fine. Still now clue as to the reason.. ",
    "DarrenHaba": "@vfoley, I had the same problem on Windows 10. Restarting docker fixed it. Thanks for the advice, you gave me my sanity back.... ",
    "c316": "I was able to get my working by deleting the node_modules folder and then doing an meteor npm install then doing mup deploy again.. Another thing you might try is to make a small change to both your code and to the mup.js file. I've noticed that when I do this Mup then rebuilds something. So try this and when you make the change to mup.js do a mup reconfig and then a mup deploy. If this doesn't work then try doing a mup setup then a mup deploy. I was able to get my working by deleting the node_modules folder and then doing an meteor npm install then doing mup deploy again.. I was getting a similar error: \"Cannot find module 'graphql/language/printer'\" I needed to install meteor npm install --save graphql. ",
    "michaltakac": "Resolved it by doing this (Ubuntu 16.04 on DigitalOcean, 512 MB / 1 CPU, 20 GB SSD):\n\nssh into server (root@YOUR_SERVER_IP)\ndocker ps to show docker images, find the abernix/meteord:base one (running your app), write down CONTAINER ID\ndocker exec -it YOUR-CONTAINER-ID bash\nnpm install node-gyp -g, wait until it install finishes\nexit docker bash, exit server\nmup setup\nmup deploy\n\nVerifying Deployment: SUCCESS \ud83d\ude0e. Tried what @c316 is suggesting, also tried mup setup few times after it, tried changing stuff in app and doing mup reconfig, still the error persists.. Resolved it by doing this (Ubuntu 16.04 on DigitalOcean, 512 MB / 1 CPU, 20 GB SSD):\n\nssh into server (root@YOUR_SERVER_IP)\ndocker ps to show docker images, find the abernix/meteord:base one (running your app), write down CONTAINER ID\ndocker exec -it YOUR-CONTAINER-ID bash\nnpm install node-gyp -g\nexit docker bash, exit server\nmup setup\nmup deploy\n\nVerifying Deployment: SUCCESS \ud83d\ude0e. ",
    "Skealz": "Did you find an better way for applying smallfiles : true ?. ",
    "mattsouth": "oh man.  it works for me today for node 4.  Yesterday I replicated the issue in clean VMs before posting the issue but I guess there may have been a confounding issue - perhaps for some period the response from the target server was especially slow. Thanks for the debug tip which will surely come in handy (and I see is in the README - the shame).  Thanks for looking at this.  I feel bad for wasting your time. Please accept my sincerest apologies.  . ",
    "AurelienC": "No much time, really sorry.\nMay be it's just an network configuration error. :-). ",
    "ktquiet": "Someone suggested I look at Meteor packages. I did\n\nI removed and reinstalled accounts-password (caused trouble with Galaxy deployment too). Deployment still failed.\nI updated packages. Deployment still failed.\nI removed accounts-password . Deployment still failed but different error code. See bottom for newest error code \n\nKaties-iMac:meteorfullversion katiecue$ meteor list\naccounts-password        1.3.3 Password support for accounts\nautoupdate               1.3.12  Update the client when new client code is available\nblaze-html-templates     1.0.5 Compile HTML templates into reactive UI with Meteor Blaze\ncheck                    1.2.4 Check whether a value matches a pattern\ndbarrett:dropzonejs      3.10.3 Dropzone.js - an open source library that provides drag'n'drop file uploads with image previews\nejson                    1.0.13  Extended and Extensible JSON library\nfortawesome:fontawesome  4.7.0  Font Awesome (official): 500+ scalable vector icons, customizable via CSS, Retina friendly\njquery                   1.11.10  Manipulate the DOM using CSS selectors\nkadira:blaze-layout      2.3.0  Layout Manager for Blaze (works well with FlowRouter)\nkadira:flow-router       2.12.1  Carefully Designed Client Side Router for Meteor\nless                     2.7.8 Leaner CSS language\nlogging                  1.1.16 Logging facility.\nmeteor-base              1.0.4 Packages that every Meteor app needs\nmobile-experience        1.0.4  Packages for a great mobile user experience\nmongo                    1.1.14 Adaptor for using MongoDB and Minimongo over DDP\nrandom                   1.0.10  Random number generator and utilities\nreload                   1.1.11  Reload the page while preserving application state.\nsession                  1.1.7  Session variable\nshell-server             0.2.1 Server-side component of the meteor shell command.\nspacebars                1.0.13 Handlebars-like template language for Meteor\nstandard-minifier-css    1.3.2 Standard css minifier used with Meteor apps by default.\nstandard-minifier-js     1.2.1 Standard javascript minifiers used with Meteor apps by default.\ntracker                  1.1.1* Dependency tracker to allow reactive callbacks\ntwbs:bootstrap           3.3.6  The most popular front-end framework for developing responsive, mobile first projects on the web.\nzimme:active-route       2.3.2  Active route helpers\n\nNew versions of these packages are available! Run 'meteor update' to try to update those packages to their latest versions. If your packages cannot be updated further, try\n  typing meteor add <package>@<newVersion> to see more information.\nKaties-iMac:meteorfullversion katiecue$\n\n\nStarted TaskList: Start Meteor\n[138.68.253.99] - Start Meteor\n[138.68.253.99] - Start Meteor: SUCCESS\n[138.68.253.99] - Verifying Deployment\n[138.68.253.99] x Verifying Deployment: FAILED\n-----------------------------------STDERR-----------------------------------\nDEV\",\n  \"http_parser\": \"2.7.0\",\n  \"icu\": \"56.1\",\n  \"modules\": \"46\",\n  \"node\": \"4.8.0\",\n  \"openssl\": \"1.0.2k\",\n  \"uv\": \"1.9.1\",\n  \"v8\": \"4.5.103.45\",\n  \"zlib\": \"1.2.8\"\n}\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\n=> Starting meteor app on port:80\n/bundle/bundle/programs/server/node_modules/fibers/future.js:280\n                        throw(ex);\n                        ^\n\nReferenceError: module is not defined\n    at app/mup.js:1:-27\n    at app/mup.js:68:4\n    at /bundle/bundle/programs/server/boot.js:338:34\n    at Array.forEach (native)\n    at Function._.each._.forEach (/bundle/bundle/programs/server/node_modules/underscore/underscore.js:79:11)\n    at /bundle/bundle/programs/server/boot.js:158:5\n    at /bundle/bundle/programs/server/boot.js:387:5\n    at Function.run (/bundle/bundle/programs/server/profile.js:510:12)\n    at /bundle/bundle/programs/server/boot.js:386:11\n\n=> Redeploying previous version of the app\n\n-----------------------------------STDOUT-----------------------------------\n\nTo see more logs type 'mup logs --tail=100'\n\n----------------------------------------------------------------------------\n\n. ",
    "bkwhite": "accounts-password/bcrypt errors were flooding me. I increased the \"deployCheckWaitTime\" to a substantial amount of time (600-800s) and it produced nice results. Good luck!. ",
    "rgstephens": "I ran into this problem. Was running Docker 1.9.1, upgraded to the latest version which resolved the problem. Thanks @zodern . ",
    "fahadakhan96": "I get this error, too, but after START MONGO: SUCCESS. Pls help.. Fixed after trying from a different internet connection!. I killed nginx by running service nginx stop on server and the app deploys successfully. However, I cannot access the app. When I use the http://, I can see Welcome to nginx, but nothing with https://. I can access the deployed app through the server IP though but that too only through http://.. ",
    "LukasNavickas": "I tried installing force-ssl package and deploy my app again, but in this case, I get a Bad Gateway error, when trying to access my app.. ",
    "SharadKumar": "In issue #594 it has been advised to use meteorblackbelt:force-ssl. I am facing similar problem with force-ssl and trying this new package.. There seems to be caching issue for some users. For example, I recently started getting 502 Bad Gateway errors on deploy... and if I try www site works, then I go without www site works!. ",
    "ryanmtaylor": "It wound up being way easier than I expected, I setup mup with the defaults and set meteor.env.PORT to be 3000 and it worked with the nginx config I'd used for a previous version of the old legacy mup.. what I did was keep my docker settings mostly as-is (defaults) and then add a new nginx config for a reverse proxy on the server that binds to 127.0.0.1:3000.  In the reverse proxy I was able to easily configure nginx. ",
    "Farkal": "After hours trying to configure nginx proxy I find that there i a simple option in start.sh (on your server you can find it at /opt/YOUR_APP_NAME/config/start.sh )\nHTTPS_METHOD=noredirect so just change it to HTTPS_METHOD=redirect and http will be redirected to https\nIt should be possible to add a simple option to allow the user to define what method he want on the mup.js config file.. @zodern if you need you can check my commit adding the parameter to the config and using it in nginx template here -> https://github.com/Farkal/meteor-up/commit/40e26512a20398b4d0ee326ac9ce598c8d12072e. It's done ;)\nPlease tell me if you need other adjustments.. ",
    "layik": "Thanks @Farkal worked for me and sounds straightforward.. Seems I have a similar issue, too on an old deployment. I have not tried the mup deploy on a new VPS.. Dear @zodern apologies for this late reply. Here is the error output\n```\nStarted TaskList: Pushing Meteor App\n[x.co.uk] - Pushing Meteor App Bundle to the Server\n[x.co.uk] - Pushing Meteor App Bundle to the Server: SUCCESS\n[x.co.uk] - Prepare Bundle\n[x.co.uk] - Prepare Bundle: SUCCESS\nStarted TaskList: Configuring App\n[x.co.uk] - Pushing the Startup Script\n[x.co.uk] - Pushing the Startup Script: SUCCESS\n[x.co.uk] - Sending Environment Variables\n[x.co.uk] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[x.co.uk] - Start Meteor\n[x.co.uk] - Start Meteor: SUCCESS\n[x.co.uk] - Verifying Deployment\n[x.co.uk] x Verifying Deployment: FAILED\n      ------------------------------------STDERR------------------------------------\n      Too much time spent restarting.\n    at require (internal/module.js:12:17)\n    at Object.<anonymous> (/built_app/main.js:4:1)\n    at Module._compile (module.js:409:26)\n    at Object.Module._extensions..js (module.js:416:10)\n=> Starting meteor app on port:80\n/built_app/programs/server/boot.js:50\n    const { pause } = require(\"./debug.js\");\n          ^\n\nSyntaxError: Unexpected token {\n    at exports.runInThisContext (vm.js:53:16)\n    at Module._compile (module.js:373:25)\n    at Object.Module._extensions..js (module.js:416:10)\n    at Module.load (module.js:343:32)\n    at Function.Module._load (module.js:300:12)\n    at Module.require (module.js:353:17)\n    at require (internal/module.js:12:17)\n    at Object.<anonymous> (/built_app/main.js:4:1)\n    at Module._compile (module.js:409:26)\n    at Object.Module._extensions..js (module.js:416:10)\n=> Starting meteor app on port:80\n/built_app/programs/server/boot.js:50\n    const { pause } = require(\"./debug.js\");\n          ^\n\nSyntaxError: Unexpected token {\n    at exports.runInThisContext (vm.js:53:16)\n    at Module._compile (module.js:373:25)\n    at Object.Module._extensions..js (module.js:416:10)\n    at Module.load (module.js:343:32)\n    at Function.Module._load (module.js:300:12)\n    at Module.require (module.js:353:17)\n    at require (internal/module.js:12:17)\n    at Object.<anonymous> (/built_app/main.js:4:1)\n    at Module._compile (module.js:409:26)\n    at Object.Module._extensions..js (module.js:416:10)\n=> Starting meteor app on port:80\n/built_app/programs/server/boot.js:50\n    const { pause } = require(\"./debug.js\");\n          ^\n\nSyntaxError: Unexpected token {\n    at exports.runInThisContext (vm.js:53:16)\n    at Module._compile (module.js:373:25)\n    at Object.Module._extensions..js (module.js:416:10)\n    at Module.load (module.js:343:32)\n    at Function.Module._load (module.js:300:12)\n    at Module.require (module.js:353:17)\n    at require (internal/module.js:12:17)\n    at Object.<anonymous> (/built_app/main.js:4:1)\n    at Module._compile (module.js:409:26)\n    at Object.Module._extensions..js (module.js:416:10)\n=> Starting meteor app on port:80\n/built_app/programs/server/boot.js:50\n    const { pause } = require(\"./debug.js\");\n          ^\n\nSyntaxError: Unexpected token {\n    at exports.runInThisContext (vm.js:53:16)\n    at Module._compile (module.js:373:25)\n    at Object.Module._extensions..js (module.js:416:10)\n    at Module.load (module.js:343:32)\n    at Function.Module._load (module.js:300:12)\n    at Module.require (module.js:353:17)\n    at require (internal/module.js:12:17)\n    at Object.<anonymous> (/built_app/main.js:4:1)\n    at Module._compile (module.js:409:26)\n    at Object.Module._extensions..js (module.js:416:10)\n=> Starting meteor app on port:80\n/built_app/programs/server/boot.js:50\n    const { pause } = require(\"./debug.js\");\n          ^\n\nSyntaxError: Unexpected token {\n    at exports.runInThisContext (vm.js:53:16)\n    at Module._compile (module.js:373:25)\n    at Object.Module._extensions..js (module.js:416:10)\n    at Module.load (module.js:343:32)\n    at Function.Module._load (module.js:300:12)\n    at Module.require (module.js:353:17)\n    at require (internal/module.js:12:17)\n    at Object.<anonymous> (/built_app/main.js:4:1)\n    at Module._compile (module.js:409:26)\n    at Object.Module._extensions..js (module.js:416:10)\n=> Starting meteor app on port:80\n/built_app/programs/server/boot.js:50\n    const { pause } = require(\"./debug.js\");\n          ^\n\nSyntaxError: Unexpected token {\n    at exports.runInThisContext (vm.js:53:16)\n    at Module._compile (module.js:373:25)\n    at Object.Module._extensions..js (module.js:416:10)\n    at Module.load (module.js:343:32)\n    at Function.Module._load (module.js:300:12)\n    at Module.require (module.js:353:17)\n    at require (internal/module.js:12:17)\n    at Object.<anonymous> (/built_app/main.js:4:1)\n    at Module._compile (module.js:409:26)\n    at Object.Module._extensions..js (module.js:416:10)\n\n=> Redeploying previous version of the app\n\n\n      ------------------------------------STDOUT------------------------------------\n      Container has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\n=> Container status:\nrestarted: 9 times {\"Bridge\":\"\",\"SandboxID\":\"4997b62599351d10be0162646177cdb80e3ce4b4ddf4952164745bbe78a08e6a\",\"HairpinMode\":false,\"LinkLocalIPv6Address\":\"\",\"LinkLocalIPv6PrefixLen\":0,\"Ports\":{},\"SandboxKey\":\"/var/run/docker/netns/4997b6259935\",\"SecondaryIPAddresses\":null,\"SecondaryIPv6Addresses\":null,\"EndpointID\":\"\",\"Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"MacAddress\":\"\",\"Networks\":{\"bridge\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"5796f83f65bf929b61832a2bc3cf7fe293d88a790d3cc4d4bc9474603bd640f1\",\"EndpointID\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"\",\"DriverOpts\":null}}} {\"Status\":\"restarting\",\"Running\":true,\"Paused\":false,\"Restarting\":true,\"OOMKilled\":false,\"Dead\":false,\"Pid\":0,\"ExitCode\":1,\"Error\":\"\",\"StartedAt\":\"2018-03-24T10:49:18.116576454Z\",\"FinishedAt\":\"2018-03-24T10:49:18.418304456Z\"}\n=> Logs:\n\nTo see more logs type 'mup logs --tail=200'\n\n\n      ------------------------------------------------------------------------------\n\n```. @AkkerD and @zodern thank you, that worked for me.\nnote to self: I must contribute to MUP!. I doubt it is a MUP issue. Having it here on my iOS. Will update this thread if I get anywhere with my issue.. ",
    "abhirakshit": "+1. abhi: ~/Projects/Meteor/vibes-auth $ npm ls -g mup\n/usr/local/lib\n\u2514\u2500\u2500 mup@1.0.3 \nabhi: ~/Projects/Meteor/vibes-auth $ npm ls mup\nVibes-Auth@ /Users/abhi/Projects/Meteor/vibes-auth\n\u2514\u2500\u2500 (empty)\n. ",
    "BoyPersoon": "Hey FBosler, Ufnortunately I can't find the https_method in start.sh file. as a matter of fact I can't find any http or https method in there.  . Actually I am not configuring nginx at all in the mup.js file. I suppose it does that automatically. Would you have any idea how to docker configures the files from the root directory. how can i find the main files of my app?   . ",
    "metus08": "I am not, should I be?. here is my nginx conf:\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name url.com www.url.com;\nroot /var/www/html;\nindex index.html index.htm;\n\ninclude snippets/ssl-url.com.conf;\ninclude snippets/ssl-params.conf;\n\nadd_header Strict-Transport-Security \"max-age=31536000;\";\n\nlocation /js/ {\n    root /var/www/html;\n}\n\nlocation ~* \\.(jpg|jpeg|png|gif|ico|css|js)$ {\n    expires 365d;\n}\n\nif ($request_uri ~ /index\\.html($|\\?)) {\n    rewrite ^(/.*)\\.html(\\?.*)?$ $1$2 permanent;\n}\n\nlocation / {\n    try_files $uri.html $uri/ $uri =404;\n}\n\nlocation /Client {\n    proxy_pass https://IP:8080;\n    proxy_buffers 16 32k;\n    proxy_buffer_size 64k;\n    proxy_busy_buffers_size 128k;\n    proxy_cache_bypass $http_pragma $http_authorization;\n    proxy_connect_timeout 59s;\n    proxy_hide_header X-Powered-By;\n    proxy_http_version 1.1;\n    proxy_ignore_headers Cache-Control Expires;\n    proxy_next_upstream error timeout invalid_header http_500 http_502 http_503 http_504 http_404;\n    proxy_no_cache $http_pragma $http_authorization;\n    proxy_pass_header Set-Cookie;\n    proxy_read_timeout 600;\n    proxy_redirect off;\n    proxy_send_timeout 600;\n    proxy_set_header Accept-Encoding '';\n    proxy_set_header Cookie $http_cookie;\n    proxy_set_header Host $host;\n    proxy_set_header Referer $http_referer;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Host $host;\n    proxy_set_header X-Forwarded-Server $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-Proto $scheme;\n    proxy_temp_file_write_size 64k;\n    proxy_set_header X-Original-Request $request_uri;\n}\n\n}. ",
    "guncebektas": "I'm using \"force-ssl\" package. I was also using CFS and changed a lot of thing after this issue. \n@htmllab First of all we have to realise mup is not a magical tool. You should separate meteor and mongo (with replica sets) to different servers.\n\nI carried mongodb to mlab  (shared cluster) it's working with replica sets. The cost is 15$/month.\nImport/Export current data with Studio 3T (To export data you can use ssh tunnel)\nI'm using mup deploy to DO. The cost is 20$/month.\nI removed everything which is related with CFS. It has lots of disadvantages.\nI'm using slingshot and uploading files to s3.\nActivate cloudfront\n\nNow everything seems great.. ",
    "htmllab": "I'm facing same issue.\nUsing CFS FileSystem path: \"~/uploads\"\nAll previous uploaded data lost on mup deploy.\nOnly mongodb data are there.. @guncebektas thanks for your suggestion. \nI found the data in server /opt/appname/last/uploads directory that mup creates after re-deploy.\nAnd solved my problem by copying it to current directory.. ",
    "dandyarir": "trying to downgrade my node.js from v8.2.1 to v4.6.2 and change docker's bind  its working now\nthanks. ",
    "davinderkumar": "Spiderable works fine when I deploy build with \"debug: true\" option in mup.js file under buildOptions section. Strange! Ref: https://www.npmjs.com/package/mup#build-options\n. Tried upgrading meteor from 1.5 to 1.6, used abernix/meteord:node-8.4.0-base with mup\nbut in vain. \nGot this error:\ninternal/streams/legacy.js:59\n      throw er; // Unhandled stream error in pipe.\n      ^\nError: ENOENT: no such file or directory, open '/cfs/files/_tempstore/images-w2R7sqwopFv59LKs2-0.chunk'\n. Found issue. It was because some partially uploaded files were stored in DB. On launch of the app/docker meteor was trying to do something with those files.\nRemoved all documents from collection \ndb.getCollection('cfs._tempstore.chunks').remove({})\nand it got fixed.. ",
    "MichalW": "@davinderkumar @kenshinman \nYou can use a different docker image with newest phantomJs version:\nimageFrontendServer: 'vazco/meteord'. Consider this package:\nhttps://www.npmjs.com/package/pm2-meteor\nin this case it may be more reasonable . Yes. You only need to deploy one instance and run: pm2-meteor scale 16. ",
    "Watster69": "Just in case this helps anyone in the future...\nI was experiencing this issue as well. I tried everything I could think of and everything all other forums suggested.\nThe fix for me was my server! I have a t2.nano with AWS EC2 and I had uploaded my apps with mup.\nIt took me a long time to realise this was the cause... but if I just have 2 apps running everything works ok. I then added a third app and this is when problems occurred. I'm guessing it is down to the basic server I was running not being able to handle 3 docker containers for my apps and a fourth for mongo.\nI always had issues uploading my third app with mup as well. I'm guessing this might be part of the issue.\nSo the point is... your publications etc might all be ok but the time to get a response from the server itself rather than the app can have an affect on this too.\nI've beefed up my server a notch and it started to work with 3 apps.. ",
    "helloncanella": "+1\n. ",
    "taromero": "@zodern thanks for the reply. Closing this because I'm no longer using mup and don't have the context to fix the conflicts now, and also because it fixes a deprecated feature.. ",
    "mcsimenc": "So if I wanted to access a file in my meteor app directory from server side code using an absolute path it would start with appname? Like:\n/appname/rest/of/path/to/file\n. Hmm no /bundle exists on my server now after redeployment with v1.2.11 but it's possible that place existed when I deployed with v1.3.1.   v1.2.11 puts my app in /opt/app/current/bundle.\nSorry I was wrong about which directories the v1.3.1 deployment created, it created:\n```\n/opt/app/\n        |_certs/\n        |_config/\n        |_tmp/\nwhereas v1.2.11 created:\n/opt/app/\n        |_certs/\n        |_config/\n        |_tmp/\n        |_current/\n        |_last/\n```. ",
    "amanagarwal2189": "it will create the folder in your host on which docker will run at /opt/ and bundle your meteor application there. Inside your docker container, the bundle is copied at /bundle/bundle.. I am not sure but I read here, mongodb instance by MUP can not be accessed by outside world. . can you post the mup.js here?\nAlso, you sure you do have the port mapping sorted?. Is it the localhost where you are running this?\nthe port mapping is the mapping done with the host and  docker container. Say your application is running at port 80 in the container (by default it is 80) and you want to run it at port 8080 on the host, you mention this in ENV.PORT (which, i see you have). So it will map hosts's 8080 with docker container's exposed port 80.. isnt it in /bundle/bundle?. ",
    "gurjit03": "It was the appname that was causing me the issues. so closing the issue now. ",
    "giany": "@aldwindelgado  Did you solve this issue?. I'm on DO also, Ubuntu 16, 4.4.0-97-generic.\nDocker version 17.09.0-ce, build afdb6d4\nWhen deploying with mup it fails with the same error you had..but if I run the docker container manually it starts ok..\n. @zodern, sorry for delay.  In the end I've passed multiple parameters to docker, e.g:\ndocker run -d --restart=always --volume=/opt/v2/tmp/:/bundle --publish=0.0.0.0:80:80 --hostname=v2 --env-file=/opt/v2/config/env.list --log-opt max-size=100m --log-opt max-file=10 --link=mongodb:mongodb --link=mongodb:mongodb --name=v2 mup_v2:latest\nAnd the commit I pushed had these:\n```\n\nvolumes: {\n'/opt/volume_v2/tmp/': '/bundle'\n},\n        docker: {\nargs: [\n'--hostname=v2',\n'--env-file=/opt/v2/config/env.list',\n'--log-opt max-size=100m',\n'--log-opt max-file=10',\n'--link=mongodb:mongodb',\n'--name=thoughtlounge_v2',\n'mup-v2:latest'\n],\n```. \n",
    "aldwindelgado": "@giany Hi, we just moved to another server hosting for the meantime, I encountered that error from Google Cloud's virtual machine specifically. So we're not yet sure if it is related to just google cloud itself. Because everything is running smoothly within our digital ocean servers.. @giany Maybe it is related to mup with regards to newer versions of docker. Did you try to revert to lower docker versions?. ",
    "hamxiaoz": "I have seen the error, and it might do so because of host name too long. I didn't dive deep into it but once I renamed my app name to a shorter name, the problem solved. . I found the solution:\n\nremove TLS v1 from nginx config file\nin the same file, add default_server to one of your server block: listen 443 ssl default_server;\n\nmore: https://medium.com/@hamxiaoz/how-to-completely-disable-tls-v1-from-nginx-99f6e2862cb8. ",
    "ntoka": "`\nmodule.exports = {\n  servers: {\n    one: {\n      host: '',\n      username: 'root',\n      pem: 'mup_key.pem'\n      // password:\n      // or leave blank for authenticate from ssh-agent\n    }\n  },\nmeteor: {\n    name: 'E4D',\n    path: '../',\n    servers: {\n      one: {}\n    },\n    docker: {\n      image: 'abernix/meteord:base', // (optional)\n    },\n    buildOptions: {\n      serverOnly: false\n    },\n    env: {\n      AOT: 1,\n      ROOT_URL: '',\n      PORT: 80\n    },\n    deployCheckWaitTime: 300\n  },\nmongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n};\n`\nI can access server's terminal and everything seems to run fine. What's that all about the ports? . I am deploying to a DO droplet remotely.. Hi, @zodern , just tried deploying again to check the logs - nothing seems off there. The only npm warning is about JS bcrypt usage, which should not break anything.\n. ",
    "Rachomir": "I am having the same issue\n. @FranciscoHanna The problem was in docker image, thanks anyway for your good will. Appreciated. @Shelagh-Lewins it was related to node version and Meteor 1.6, what version of node are you using?. @Shelagh-Lewins setting abernix/meteord:node-8.9.2-base sorted my issue. ",
    "Shelagh-Lewins": "@Rachomir would you mind telling me a bit more about what your problem was and how you fixed it? I am having a similar problem, and I can't even begin to debug it because all I've done is use MUP 1.3.7 to deploy a Meteor 1.5.3 app to Ubuntu 14.04.5. MUP is a black box to me, that's why I'm using it! I previously used mup-legacy for a Meteor 1.2 app and it was perfect.. Hi! If I ssh to my server and run either 'node --version' or 'nodejs --version' in the command line, I see a messages saying \"the program 'node' can be found in the following packages:\". It appears node or nodejs is not installed. This cannot be the case because my app runs. So where is my node and how do I find the version?. Running 'which node' gives no output at all, just another command line.. Or did you mean on the local machine? Locally, running 'node -v' gives v8.9.2.. See below, thank you. I think this is the right docker image; meteor is 1.5.3.\nI don't know how to check if it is the right mongo version?\nI've replaced my IP address with xxx.xx.xx.xx\n```\nmodule.exports = {\n  servers: {\n    one: {\n      // TODO: set host address, username, and authentication method\n      host: 'xxx.xx.xx.xx',\n      username: 'root',\n      pem: \"~/.ssh/id_rsa\"\n      // password: 'server-password'\n      // or neither for authenticate from ssh-agent\n    }\n  },\napp: {\n    // TODO: change app name and path\n    name: 'myapp',\n    path: '.',\nservers: {\n  one: {},\n},\n\nbuildOptions: {\n  serverOnly: true,\n},\n\nenv: {\n  // TODO: Change to your app's url\n  // If you are using ssl, it needs to start with https://\n  ROOT_URL: 'http://xxx.xx.xx.xx',\n  MONGO_URL: 'mongodb://localhost/meteor',\n},\n\n// ssl: { // (optional)\n//   // Enables let's encrypt (optional)\n//   autogenerate: {\n//     email: 'email.address@domain.com',\n//     // comma separated list of domains\n//     domains: 'website.com,www.website.com'\n//   }\n// },\n\ndocker: {\n  // change to 'abernix/meteord:base' if your app is using Meteor 1.4 - 1.5\n  //image: 'abernix/meteord:node-8.4.0-base',\n  image: 'abernix/meteord:base'\n},\n\n// Show progress bar while uploading bundle to server\n// You might need to disable it on CI servers\nenableUploadProgressBar: true\n\n},\nmongo: {\n    version: '3.4.1',\n    servers: {\n      one: {}\n    }\n  }\n};\n``\n.abernix/meteord:node-8.9.2-base` fails with the following message, probably because my app is Meteor 1.5:\n```\nx Prepare Bundle: FAILED\n-----------------------------------STDERR-----------------------------------\nError response from daemon: manifest for abernix/meteord:node-8.9.2-base not found\nError response from daemon: No such container: twistedthreads\nmanifest for abernix/meteord:node-8.9.2-base not found\nError response from daemon: No such container: twistedthreads\nError: failed to start containers: twistedthreads\n-----------------------------------STDOUT-----------------------------------\nFinished Extracting\nCreating Dockerfile\nFinished creating Dockerfile\nBuilding image\nSending build context to Docker daemon  56.81MB\nStep 1/6 : FR\n\n```OM abernix/meteord:node-8.9.2-base\nWhat meteor version are you guys running?. I tried upgrading Meteor to v1.6, and got the same error.. Ah! It seems that abernix/meteord:node-8.9.2-base doesn't exist now, but abernix/meteord:node-8.9.3-base does. So, now with Meteor 1.6 I am kind of back to where I was before: the site runs, but it is slow, and I keep seeing messages like:\nGET http://xxxx.xx.xx.xx/sockjs/info?cb=r92ietxcxz net::ERR_CONNECTION_REFUSED\nWhen I refresh, sometimes I get the page, sometimes not. Randomly, static images are not served up. These are just files in the 'public' directory on the server.\nAny ideas what might be the problem? It's a clean Digital Ocean droplet that I just recreated from the base image. I'm very near giving up on mup altogether because my only guess is that there's something wrong with docker and there's no way I can debug it.... Here's how I connect using Studio 3T (formerly MongoChef). I use ssh to forward the mongo instance to my localhost.\nIn a terminal, enter:\nssh -L 4321:localhost:27017 -i ~/.ssh/id_rsa root@xx.xx.xx.xx\n\nwhere xx.xx.xx.xx is the IP address of your remote server. This assumes you have set up ssh to it from your local machine. Make sure you also put in the correct path to your ssh key.\nThen in Studio 3T, connect with localhost, port 4321. Don't fill in any other settings, you don't need to touch the SSH config tab.\nThis lets me connect to the remote database, and edit values. But I am having problems with importing data in Meteor 1.6, so I can't use it to back up and restore any more. Not sure if it will work with 1.3, it worked in 1.2.. Excellent :) @mi-k4 maybe you can help me a little with some information, if you don't mind? If you now import collections to your remote Meteor application, does the app continue to work OK? If it does, what version of Meteor are you running, and what OS / version is your server running?\nMaybe there is a version of mup / Meteor / Ubuntu that will work for me, if I can just find them.... Closing this because I couldn't get mup to work reliably on ubuntu 16.04.3x64. I've rebuilt my server with Ubuntu 14.04.5 x 64 and have posted a new issue describing only the remaining problem.\nSee #842 App runs slowly with frequent error messages \"net::ERR_CONNECTION_REFUSED\". Hi, I gave up on Meteor-up and switched to Phusion Passenger.. ",
    "aliogaili": "I'm using Meteor's browserpolicy package and after adding few more rules, I started getting bad gateway message. It was really hard to trace the source of the problem since no error messages were being thrown anywhere but apparently it is cased because headers are bigger than the max size allowed by the container with nginx.\nHere is the error from nginx:\nupstream sent too big header while reading response header from upstream,\nAnd here is a blog post on how someone resolved that issue. \nSo I'm hoping there will be an easier way to configure this settings in the near future.. ",
    "houshuang": "Yes. We currently do the Nginx setup ourselves, also because we often deploy multiple servers and need load-balancing. Although being able to set up a single production server with https without any other config would be great. We currently need port 3002, and it would be best if we could open this port, however we could also configure our system to use another arbitrary port - has to be different from the core Meteor port though (and in our case, nginx has to support websocket upgrading for that port too). . Yes, I use nginx, which I also use for ssl termination. I set this up\nseparately (not using mup).\nOn Sat, Apr 7, 2018 at 5:35 PM, Himanshu Phirke notifications@github.com\nwrote:\n\n@houshuang https://github.com/houshuang\nAre you using an external load balancer for the five instance you are\ndeploying?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/754#issuecomment-379478011,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AADwhz-XxyfHF7L-qP_5QQwasQbrdMbYks5tmNzLgaJpZM4Pp95m\n.\n\n\n-- \nhttp://reganmian.net/blog -- Random Stuff that Matters\n. Yes, Meteor sessions work perfectly. I will share my Nginx config, but take\ninto account that I'm no nginx expert, and it's the result of cut-and-paste\nfrom online tutorials, iterative experimentation etc. Plus the server also\nhosts other stuff... However, the key part is that it works, and now I just\nneed to change the IP numbers whenever I add or remove servers. Also note\nthat I cache static assets quite aggressively, which makes a big difference\non performance.\nhttps://gist.github.com/houshuang/464212a7cb83f3a48466a12dbe935b71\nOn Mon, Apr 9, 2018 at 5:43 AM, Himanshu Phirke notifications@github.com\nwrote:\n\n@houshuang https://github.com/houshuang Thanks for prompt reply.\nAre meteor Sessions working correctly with five deployments and nginx?\nWhat is the routing method you are using in nginx, is it iphash?\nWould be very helpful if you could share nginx config details (config file\nif possible)\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/754#issuecomment-379621229,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AADwh8MbdeIPlgvPd8rCO-tW4t6Gw10nks5tmtjLgaJpZM4Pp95m\n.\n\n\n-- \nhttp://reganmian.net/blog -- Random Stuff that Matters\n. Timestamps on logs would be really crucial for us.. Great, very useful, thanks!\nOn Thu, Oct 19, 2017 at 2:50 PM, zodern notifications@github.com wrote:\n\n@houshuang https://github.com/houshuang you can use the --timestamps\noption now when viewing logs. It is only missing from the cli help.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/762#issuecomment-337897375,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AADwh5ZYry04zqW5w4amE3ibbUHT8SPVks5st0WdgaJpZM4P2Yxr\n.\n\n\n-- \nhttp://reganmian.net/blog -- Random Stuff that Matters\n. Here is my verbose log from mup deploy 1.4.1:\n```\n log\nRemoving docker containers. Errors about nonexistent endpoints and containers are normal.\nError response from daemon: endpoint frog not found\nError: No such container: frog-frontend\nError response from daemon: endpoint frog-frontend not found\nError: No such container: frog-nginx-letsencrypt\nError response from daemon: endpoint frog-nginx-letsencrypt not found\nError: No such container: frog-nginx-proxy\nError response from daemon: endpoint frog-nginx-proxy not found\nFinished removing docker containers\nToo much time spent restarting.\n=> Starting meteor app on port:80\nNote: you are using a pure-JavaScript implementation of bcrypt.\nWhile this implementation will work correctly, it is known to be\napproximately three times slower than the native implementation.\nIn order to use the native implementation instead, run\nmeteor npm install --save bcrypt\nin the root directory of your application.\nRunning shareDB server\nMeteor login token  secret\n=> Redeploying previous version of the app\n[195.201.37.72] x Verifying Deployment: FAILED\n      ------------------------------------STDERR------------------------------------\n      Too much time spent restarting.\n=> Starting meteor app on port:80\nNote: you are using a pure-JavaScript implementation of bcrypt.\nWhile this implementation will work correctly, it is known to be\napproximately three times slower than the native implementation.\nIn order to use the native implementation instead, run\n\n  meteor npm install --save bcrypt\n\nin the root directory of your application.\nRunning shareDB server\nMeteor login token  secret\n\n=> Redeploying previous version of the app\n\n\n      ------------------------------------STDOUT------------------------------------\n      Container has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\n=> Container status:\nrestarted: 0 times {\"Bridge\":\"\",\"SandboxID\":\"58f72db7b41ca2b45a9f1b1fafd1467c7470edde0c9dee5f7023390f2a8d51a1\",\"HairpinMode\":false,\"LinkLocalIPv6Address\":\"\",\"LinkLocalIPv6PrefixLen\":0,\"Ports\":{},\"SandboxKey\":\"/var/run/docker/netns/default\",\"SecondaryIPAddresses\":null,\"SecondaryIPv6Addresses\":null,\"EndpointID\":\"\",\"Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"MacAddress\":\"\",\"Networks\":{\"host\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"6573f8de7586073ddbcdbca1cb72d768cf319a2555a41996c709d18081720f84\",\"EndpointID\":\"426ee20ca4053cca15d3adc45b78278a0ee22a7795d2af166c9ea0e256db5ca0\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"\",\"DriverOpts\":null}}} {\"Status\":\"running\",\"Running\":true,\"Paused\":false,\"Restarting\":false,\"OOMKilled\":false,\"Dead\":false,\"Pid\":24885,\"ExitCode\":0,\"Error\":\"\",\"StartedAt\":\"2018-02-21T08:01:35.824677547Z\",\"FinishedAt\":\"0001-01-01T00:00:00Z\"}\n=> Logs:\n\nTo see more logs type 'mup logs --tail=200'\n\n```\nWith the previous version (1.3.7), and the same setup, it works perfectly.. Confirm that it's fixed. Thanks a lot!\nOn Wed, Feb 21, 2018 at 11:57 PM, zodern notifications@github.com wrote:\n\n@houshuang https://github.com/houshuang I have fixed Verifying\nDeployment when the container is using the host network.\nBoth fixes will be available in mup 1.4.2.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/883#issuecomment-367506407,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AADwhyr06XGhv-axkaJxsUL5KQfjlPttks5tXJ9mgaJpZM4SLFij\n.\n\n\n-- \nhttp://reganmian.net/blog -- Random Stuff that Matters\n. ",
    "martinsteinorth": "+1 for this improvement as I am currently dealing with the same requirement. Is there already some progress?. Just found this: https://github.com/zodern/meteor-up/issues/460#issuecomment-283455401\nThat works as well.. ",
    "nikna": "I'm trying to access my assets folder as well and having set app.docker.prepareBundle to false does not give me the current folder in /opt/app.\nAm I looking in the wrong place?. @zodern Trying to reproduce my issue fixed it somehow. I suspect that it could have been caused by renaming the app (from upper case to lowercase) before changing app.docker.prepareBundle. \nThanks however!. ",
    "haojia321": "@zodern could you elaborate please? If I need to create a new docker image does that mean i cannot use MUP?. ",
    "zhukovsp": "meteor: {\n   ...\n},\nproxy:{\n  domains: 'domain_name.com',\n  ssl: {\n    crt: './bundle.crt',\n    key: './private.key',\n    forceSSL: true\n  }\n}\n. @zodern Thank you!. @zodern I think so because deploying was success.\nBut I have some issues with deploy on new server with custom ssl certificates & forceSSL. I found solution to deploy just for http without ssl settings and second step was to add https settings & ForceSSL. . @zodern Yes. I'll try to make new deploy again and open new issue with more specified info.. ",
    "benjaminsweetnam247": "yea changing the name works but probably should look at converting names to all lower case to fix on deployment. also ran into an issue with it recreating the database as It already exists but in a different case\nMongoError: db already exists with different case already have: [etaSms] trying to create [etasms]\n    at Object.Future.wait (/built_app/programs/server/node_modules/fibers/future.js:449:15)\n    at [object Object].MongoConnection._ensureIndex (packages/mongo/mongo_driver.js:832:10)\n    at [object Object].Mongo.Collection._ensureIndex (packages/mongo/collection.js:677:20)\n    at setupUsersCollection (packages/accounts-base/accounts_server.js:1493:9)\n    at new AccountsServer (packages/accounts-base/accounts_server.js:51:5)\n    at meteorInstall.node_modules.meteor.accounts-base.server_main.js (packages/accounts-base/server_main.js:9:12)\n    at fileEvaluate (packages/modules-runtime.js:197:9)\n    at require (packages/modules-runtime.js:120:16)\n    at /built_app/programs/server/packages/accounts-base.js:2031:15\n    at /built_app/programs/server/packages/accounts-base.js:2042:3\n    - - - - -\n    at Function.MongoError.create (/built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/error.js:31:11)\n    at /built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb/lib/db.js:1083:80\n    at /built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/pool.js:455:18\n    at nextTickCallbackWith0Args (node.js:489:9)\n    at process._tickCallback (node.js:418:13). ",
    "thebarty": "any progress? I got the same issues with chromedriver. @yongyi520 check out papertrail.com . You can hook it up with Winston. It has a free tier. Related but probably a different reason for the error https://github.com/zodern/meteor-up/issues/814. My project has a \"package.json.lock\". This is where \"isarray\" package is located. Maybe I should remove it? See https://codeburst.io/disabling-package-lock-json-6be662f5b97d. I have it fixed. I upgraded to the 10 $ docker-container with 1GB RAM and afterwards it worked (at least one time for now).\nAfter logging into the droplet via ssh I noted, that the docker image itself was 412 MB and thought that I'd better give the 1GB RAM a try - and it worked.. @jeroenhoebe quick tip check the other github topics on how to create a SWAP file for on the droplet. It might help. Actually I think the npm chromedriver package should automatically install everything neccessary via npm. Let me research a bit more - if you have a quick tip: very welcome!. All good - I found the \"hooks\"-part in the docs. Hi man,\nany progress? Right now I am struggeling with a similar issue: I need to have chromedriver installed and running BEFORE starting the app.\nMaybe checking out the hooks can help you. I have played with something like this (DIRTY CODE, but you'll see what I mean)\n``\nconst setupChromeCommandScript =\n  docker exec lc apt install wget -y;\n  # install chromedriver (NOT necessary)\n  # docker exec lc wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add -;\n  # docker exec lc sh -c 'echo \"deb http://dl.google.com/linux/chrome/deb/ stable main\" >>    /etc/apt/sources.list.d/google.list';\n  # docker exec lc apt-get install google-chrome-stable -y --force-yes\n  # fix chromedriver \"error while loading shared libraries\"...\n  docker exec lc apt-get install libglib2.0-dev -y --force-yes;\n  docker exec lc apt-get install libnss3-dev -y --force-yes;\n  docker exec lc apt-get install libgconf-2-4 -y --force-yes;\n  docker exec lc apt-get install netcat -y --force-yes;\n  docker exec lc apt-get update;\n  docker exec lc chromedriver &>/dev/null &  # start in background and continue to use it in terminal;\n  docker exec lc sleep 10; ps;\n  docker exec lc curl -v http://127.0.0.1:9515/wd/hub/status  # check status of chrome;\n  docker exec lc nc -zv localhost 9515  # check status of chrome;\n  # docker exec lc PATH=/built_app/programs/server/npm/node_modules/chromedriver/lib/chromedriver:$PATH\n  # docker exec lc google-chrome --version;\n`\n...\nhooks: {\n    'post.deploy': {\n      // SET UP CHROME so we can hopefully connect\n      remoteCommand: setupChromeCommandScript,\n    },\n  },\n```. OK I do NOT have a solution, BUT probably have found the reason for the chromedriver problem.\nIt probably has to do with chromedriver having problems when running within docker and needs a special handling (See https://github.com/GoogleChrome/puppeteer/blob/master/docs/troubleshooting.md). \nSo if using with MUP my guess is that we need a docker image fully supporting chromedriving.\nFor my usecase I am giving up (after having wasted much too many hours) and try to go with http-request solution.... I got one step further debugging the issue: You can find the path of the meteor-build doing a DEBUG=mup* mup deploy --verbose.\nI guess that the \"bundle.tar.gz\" is the file that gets uploaded.\nIt is 54 MB big and 30 Minutes to uploading.\nMy Internet-Connection has 5mbps upload, so it should take around 1,5 minutes to upload.\nI guess that this is NOT an MUP issue, but an issue with my DigitalOcean container.\nDoes anyone else have encountered this issue?. Found the issue. It was my infrastructure and has NOTHING to do with MUP!. ",
    "alexgzhou": "@zodern When would this be fixed since the version is now 1.3.7, and the problem is still there?. ",
    "Falieson": "@zodern METEOR@1.6-beta.24 , thanks. @zodern that didn't fix it =(\nhttps://github.com/zodern/meteor-up/issues/726. I've started an issue with meteord https://github.com/abernix/meteord/issues/21 since I've reproduced the error without MUP. ",
    "luski": "Ohh, sorry, I got it, it's a path of the field in the mup.json file... :). ",
    "m-niesluchow": "It looks like it was not even merged to master. It would be great to have this change in release.. @kodie I believe so. In my case warnings disappeared. If you look at tar.c options ([1]) portable ommits system specific metadata and according to [2] SCHILY.dev is st_dev. st_dev seems to be gnu specific ([3]). Code in node-tar showing what options portable turns off is in [4].\n[1] https://github.com/npm/node-tar#tarcoptions-filelist-callback-alias-tarcreate\n[2] https://www.systutorials.com/docs/linux/man/5-star/\n[3] https://www.gnu.org/software/libc/manual/html_node/Attribute-Meanings.html\n[4] https://github.com/npm/node-tar/blob/97e7646ca61e592bf081321665a85eceab6a2342/lib/write-entry.js#L133. ",
    "houssainy": "I have the same issue after i upgraded to mup 1.3.2, this error is keep appearing to me in Verifying Deployment step and i tried all possible solutions but it didn't work until i downgraded to 1.3.1\nSo i think this error related to mup 1.3.2 . ",
    "dphov": "@zodern \nmup.js\njs\nmodule.exports = {\n  servers: {\n    one: {\n      // Production\n      host: 'iphere',\n      username: 'root',\n      password: 'password',\n      // opts: {\n      //   port: 22\n      // }\n    }\n  },\n  meteor: {\n    name: 'app',\n    path: '..',\n    dockerImage: 'abernix/meteord:base',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      // serverOnly: true,\n      debug: true,\n      executable: 'meteor'\n    },\n    env: {\n      PORT: 3000,\n      ROOT_URL: 'https://app.com',\n      MONGO_URL: 'mongodb://localhost/meteor'\n    },\n    deployCheckWaitTime: 45,\n    enableUploadProgressBar: true,\n    ssl: {\n      autogenerate: {\n        email: 'mail@example.com',\n        domains: 'example.com,www.example.com'\n      }\n    }\n  },\n  mongo: {\n    oplog: true,\n    port: 27017,\n    servers: {\n      one: {}\n    }\n  }\n};\nmup docker ps\nCONTAINER ID | IMAGE | COMMAND | CREATED | STATUS | PORTS \n------------ | ------------ | ------------ | ------------ |------------ |------------\n|71082dc86313 | jrcs/letsencrypt-nginx-proxy-companion:latest |\"/bin/bash /app/en...\" |  57 seconds ago|Up 56 seconds |   | \n6675cfb3dc83 | jwilder/nginx-proxy:latest | \"/app/docker-entry...\" | About a minute ago  | Up About a minute | 0.0.0.0:80->80/tcp, 0.0.0.0:443->443/tcp\n9f6423882449     |   kadirahq/meteord                   |             \"/bin/sh -c 'bash ...\"  | About a minute ago |  Restarting (8) 2 seconds ago |          |                         \n56ca7ffeafda   |     mongo:3.4.1              |                       \"/entrypoint.sh mo...\" |  21 minutes ago       | Up 21 minutes        |          127.0.0.1:27017->27017/tcp       . Greetings, @zodern, do you know how to resolve issues like this?. ",
    "tekstop": "any hints on this?. ",
    "johan-insthink": "@fullhdpixel Did you by any chance to solve this? . In case anyone is having the same issue \u2014\u00a0what I ended up doing was passing these ENV-variables when running mup deploy since that is when the build process starts.\nFor example:\nMETEOR_CORDOVA_COMPAT_VERSION_IOS=IOS_HASH mup deploy \nHowever, it would be nice to be able to set env-variables in the build process using the mup.js-conf file.. ",
    "merculean": "I run into the same issue when I deploy from Linux or OS X. Tried to use mrauhu/meteord, the deployment  seems successful but the web app itself didn't have its docker created. Any ideas?. @zodern Still have the issue, with -verbose option the output of mup deploy is as follows:\nStarted TaskList: Pushing Meteor App\n[54.191.166.128] - Pushing Meteor App Bundle to The Server\n[54.191.166.128] - Pushing Meteor App Bundle to The Server: SUCCESS\n[54.191.166.128] - Prepare Bundle\nbase: Pulling from abernix/meteord\n43c265008fae: Pulling fs layer\n42d5421c3af3: Pulling fs layer\n7845dc14762a: Pulling fs layer\n0570697e1c02: Pulling fs layer\n6e5fbac1354a: Pulling fs layer\nf706200a80ab: Pulling fs layer\n0570697e1c02: Waiting\n6e5fbac1354a: Waiting\nf706200a80ab: Waiting\n42d5421c3af3: Verifying Checksum\n42d5421c3af3: Download complete\n43c265008fae: Verifying Checksum\n43c265008fae: Download complete\n43c265008fae: Pull complete\n42d5421c3af3: Pull complete\n0570697e1c02: Verifying Checksum\n0570697e1c02: Download complete\nf706200a80ab: Verifying Checksum\nf706200a80ab: Download complete\n6e5fbac1354a: Verifying Checksum\n6e5fbac1354a: Download complete\n7845dc14762a: Verifying Checksum\n7845dc14762a: Download complete\n7845dc14762a: Pull complete\n0570697e1c02: Pull complete\n6e5fbac1354a: Pull complete\nf706200a80ab: Pull complete\nDigest: sha256:680d55194f4cce47dac3373ad54d7c3ca53e28e7c8f40d29ef43f82fa460da4b\nStatus: Downloaded newer image for abernix/meteord:base\nError response from daemon: No such container: tutorchat\nSending build context to Docker daemon  192.4MB\nStep 1/4 : FROM abernix/meteord:base\nExecuting 1 build trigger...\nStep 1/1 : ENV NODE_VERSION ${NODE_VERSION:-4.8.3}\n ---> Running in 32c64e464ce7\n ---> fa06c70cdad1\nRemoving intermediate container 32c64e464ce7\nStep 2/4 : RUN mkdir /built_app\n ---> Running in 1f6a7d84e8b3\n ---> 2cbf08f9465e\nRemoving intermediate container 1f6a7d84e8b3\nStep 3/4 : COPY ./ /built_app\n ---> 4e6b0deb23c6\nStep 4/4 : RUN cd /built_app/programs/server && npm install --unsafe-perm\n ---> Running in 70389a6d26fb\n\nfibers@1.0.15 install /built_app/programs/server/node_modules/fibers\nnode build.js || nodejs build.js\n\nlinux-x64-46 exists; testing\nBinary is fine; exiting\n\nmeteor-dev-bundle@0.0.0 install /built_app/programs/server\nnode npm-rebuild.js\nbcrypt@1.0.2 install /built_app/programs/server/npm/node_modules/bcrypt\nnode-pre-gyp install --fallback-to-build\n\n[bcrypt] Success: \"/built_app/programs/server/npm/node_modules/bcrypt/lib/binding/bcrypt_lib.node\" is installed via remote\n\nbufferutil@3.0.2 install /built_app/programs/server/npm/node_modules/bufferutil\nprebuild-install || node-gyp rebuild\n\nsh: 1: prebuild-install: not found\nmake: Entering directory '/built_app/programs/server/npm/node_modules/bufferutil/build'\n  CXX(target) Release/obj.target/bufferutil/src/bufferutil.o\n  SOLINK_MODULE(target) Release/obj.target/bufferutil.node\n  COPY Release/bufferutil.node\nmake: Leaving directory '/built_app/programs/server/npm/node_modules/bufferutil/build'\n\ncanvas@1.6.7 install /built_app/programs/server/npm/node_modules/canvas\nnode-gyp rebuild\n\n./util/has_lib.sh: 31: ./util/has_lib.sh: pkg-config: not found\ngyp: Call to './util/has_lib.sh freetype' returned exit status 0 while in binding.gyp. while trying to load binding.gyp\ngyp ERR! configure error \ngyp ERR! stack Error: gyp failed with exit code: 1\ngyp ERR! stack     at ChildProcess.onCpExit (/opt/nodejs/lib/node_modules/npm/node_modules/node-gyp/lib/configure.js:305:16)\ngyp ERR! stack     at emitTwo (events.js:87:13)\ngyp ERR! stack     at ChildProcess.emit (events.js:172:7)\ngyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:211:12)\ngyp ERR! System Linux 4.4.0-1022-aws\ngyp ERR! command \"/opt/nodejs/bin/node\" \"/opt/nodejs/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js\" \"rebuild\"\ngyp ERR! cwd /built_app/programs/server/npm/node_modules/canvas\ngyp ERR! node -v v4.8.3\ngyp ERR! node-gyp -v v3.4.0\ngyp ERR! not ok \nnpm ERR! Linux 4.4.0-1022-aws\nnpm ERR! argv \"/opt/nodejs/bin/node\" \"/opt/nodejs/bin/npm\" \"rebuild\" \"--update-binary\"\nnpm ERR! node v4.8.3\nnpm ERR! npm  v3.10.10\nnpm ERR! code ELIFECYCLE\nnpm ERR! canvas@1.6.7 install: node-gyp rebuild\nnpm ERR! Exit status 1\nnpm ERR! \nnpm ERR! Failed at the canvas@1.6.7 install script 'node-gyp rebuild'.\nnpm ERR! Make sure you have the latest version of node.js and npm installed.\nnpm ERR! If you do, this is most likely a problem with the canvas package,\nnpm ERR! not with npm itself.\nnpm ERR! Tell the author that this fails on your system:\nnpm ERR!     node-gyp rebuild\nnpm ERR! You can get information on how to open an issue for this project with:\nnpm ERR!     npm bugs canvas\nnpm ERR! Or if that isn't available, you can get their info via:\nnpm ERR!     npm owner ls canvas\nnpm ERR! There is likely additional logging output above.\nnpm ERR! Please include the following file with any support request:\nnpm ERR!     /built_app/programs/server/npm/npm-debug.log\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\nnpm ERR! Linux 4.4.0-1022-aws\nnpm ERR! argv \"/opt/nodejs/bin/node\" \"/usr/bin/npm\" \"install\" \"--unsafe-perm\"\nnpm ERR! node v4.8.3\nnpm ERR! npm  v3.10.10\nnpm ERR! code ELIFECYCLE\nnpm ERR! meteor-dev-bundle@0.0.0 install: node npm-rebuild.js\nnpm ERR! Exit status 1\nnpm ERR! \nnpm ERR! Failed at the meteor-dev-bundle@0.0.0 install script 'node npm-rebuild.js'.\nnpm ERR! Make sure you have the latest version of node.js and npm installed.\nnpm ERR! If you do, this is most likely a problem with the meteor-dev-bundle package,\nnpm ERR! not with npm itself.\nnpm ERR! Tell the author that this fails on your system:\nnpm ERR!     node npm-rebuild.js\nnpm ERR! You can get information on how to open an issue for this project with:\nnpm ERR!     npm bugs meteor-dev-bundle\nnpm ERR! Or if that isn't available, you can get their info via:\nnpm ERR!     npm owner ls meteor-dev-bundle\nnpm ERR! There is likely additional logging output above.\nnpm ERR! Please include the following file with any support request:\nnpm ERR!     /built_app/programs/server/npm-debug.log\nThe command '/bin/sh -c cd /built_app/programs/server && npm install --unsafe-perm' returned a non-zero code: 1\nError response from daemon: No such container: myapp\nError: failed to start containers: myapp\n[54.191.166.128] x Prepare Bundle: FAILED\n-----------------------------------STDERR-----------------------------------\nError response from daemon: No such container: myapp\nThe command '/bin/sh -c cd /built_app/programs/server && npm install --unsafe-perm' returned a non-zero code: 1\nError response from daemon: No such container: myapp\nError: failed to start containers: myapp\n-----------------------------------STDOUT-----------------------------------\nn/npm\" \"install\" \"--unsafe-perm\"\nnpm ERR! node v4.8.3\nnpm ERR! npm  v3.10.10\nnpm ERR! code ELIFECYCLE\nnpm ERR! meteor-dev-bundle@0.0.0 install: `node npm-rebuild.js`\nnpm ERR! Exit status 1\nnpm ERR! \nnpm ERR! Failed at the meteor-dev-bundle@0.0.0 install script 'node npm-rebuild.js'.\nnpm ERR! Make sure you have the latest version of node.js and npm installed.\nnpm ERR! If you do, this is most likely a problem with the meteor-dev-bundle package,\nnpm ERR! not with npm itself.\nnpm ERR! Tell the author that this fails on your system:\nnpm ERR!     node npm-rebuild.js\nnpm ERR! You can get information on how to open an issue for this project with:\nnpm ERR!     npm bugs meteor-dev-bundle\nnpm ERR! Or if that isn't available, you can get their info via:\nnpm ERR!     npm owner ls meteor-dev-bundle\nnpm ERR! There is likely additional logging output above.\n\nnpm ERR! Please include the following file with any support request:\nnpm ERR!     /built_app/programs/server/npm-debug.log\n\n. I fixed the problem. It turns out that the abernix/meteord and mrauhu/meteord both don't have pkg-config installed, which is required by canvas. Also they miss libcairo2-dev etc required by canvas. I created a customized meteord based on abernix/meteord by installing all the missing parts and after that MUP works.. ",
    "webmagnets": "Here is my mup deploy --verbose:\n```Building App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[192.168.1.33] - Pushing Meteor App Bundle to The Server\n[192.168.1.33] - Pushing Meteor App Bundle to The Server: SUCCESS\n[192.168.1.33] - Prepare Bundle\nbase: Pulling from abernix/meteord\nDigest: sha256:680d55194f4cce47dac3373ad54d7c3ca53e28e7c8f40d29ef43f82fa460da4b\nStatus: Image is up to date for abernix/meteord:base\nError response from daemon: No such container: 3fold-ipad-menu\nSending build context to Docker daemon  627.2MB\nStep 1/6 : FROM abernix/meteord:base\nExecuting 1 build trigger\n---> Using cache\n ---> c6fb7a117090\nStep 2/6 : RUN mkdir /built_app\n ---> Using cache\n ---> 828526a5401f\nStep 3/6 : COPY ./ /built_app\n ---> Using cache\n ---> afd2ceeb1685\nStep 4/6 : ENV ROOT_URL=https://eat3fold.com\n ---> Using cache\n ---> c0b5225e6b8f\nStep 5/6 : ENV MONGO_URL=mongodb://mongodb:27017/3fold-ipad-menu\n ---> Using cache\n ---> c378ba2cf998\nStep 6/6 : RUN cd  /built_app/programs/server &&     npm install --unsafe-perm\n ---> Running in 3823492e4098\n\nfibers@2.0.0 install /built_app/programs/server/node_modules/fibers\nnode build.js || nodejs build.js\n\nmake: Entering directory '/built_app/programs/server/node_modules/fibers/build'\n  CXX(target) Release/obj.target/fibers/src/fibers.o\n  CXX(target) Release/obj.target/fibers/src/coroutine.o\n  CC(target) Release/obj.target/fibers/src/libcoro/coro.o\n  SOLINK_MODULE(target) Release/obj.target/fibers.node\n  COPY Release/fibers.node\nmake: Leaving directory '/built_app/programs/server/node_modules/fibers/build'\nInstalled in /built_app/programs/server/node_modules/fibers/bin/linux-x64-46/fibers.node\n\nmeteor-dev-bundle@0.0.0 install /built_app/programs/server\nnode npm-rebuild.js\nserialport@6.0.4 install /built_app/programs/server/npm/node_modules/serialport\nprebuild-install || node-gyp rebuild\n\nprebuild-install info begin Prebuild-install version 2.3.0\nprebuild-install info looking for local prebuild @ prebuilds/serialport-v6.0.4-node-v46-linux-x64.tar.gz\nprebuild-install info looking for cached prebuild @ /root/.npm/_prebuilds/https-github.com-EmergingTechnologyAdvisors-node-serialport-releases-download-v6.0.4-serialport-v6.0.4-node-v46-linux-x64.tar.gz\nprebuild-install http request GET https://github.com/EmergingTechnologyAdvisors/node-serialport/releases/download/v6.0.4/serialport-v6.0.4-node-v46-linux-x64.tar.gz\nprebuild-install http 200 https://github.com/EmergingTechnologyAdvisors/node-serialport/releases/download/v6.0.4/serialport-v6.0.4-node-v46-linux-x64.tar.gz\nprebuild-install info downloading to @ /root/.npm/_prebuilds/https-github.com-EmergingTechnologyAdvisors-node-serialport-releases-download-v6.0.4-serialport-v6.0.4-node-v46-linux-x64.tar.gz.137-74ff84cd.tmp\nprebuild-install info renaming to @ /root/.npm/_prebuilds/https-github.com-EmergingTechnologyAdvisors-node-serialport-releases-download-v6.0.4-serialport-v6.0.4-node-v46-linux-x64.tar.gz\nprebuild-install info unpacking @ /root/.npm/_prebuilds/https-github.com-EmergingTechnologyAdvisors-node-serialport-releases-download-v6.0.4-serialport-v6.0.4-node-v46-linux-x64.tar.gz\nprebuild-install info unpack resolved to /built_app/programs/server/npm/node_modules/serialport/build/Release/serialport.node\nprebuild-install info unpack required /built_app/programs/server/npm/node_modules/serialport/build/Release/serialport.node successfully\nprebuild-install info install Successfully installed prebuilt binary!\n\nusb@1.2.0 install /built_app/programs/server/npm/node_modules/usb\nnode-pre-gyp install --fallback-to-build\n\nnode-pre-gyp ERR! Tried to download: https://github.com/tessel/node-usb/releases/download/1.2.0/usb_bindings-v1.2.0-node-v46-linux-x64.tar.gz\nnode-pre-gyp ERR! Pre-built binaries not found for usb@1.2.0 and node@4.8.3 (node-v46 ABI) (falling back to source compile with node-gyp)\nmake: Entering directory '/built_app/programs/server/npm/node_modules/usb/build'\n  CC(target) Release/obj.target/libusb/libusb/libusb/core.o\n  CC(target) Release/obj.target/libusb/libusb/libusb/descriptor.o\n  CC(target) Release/obj.target/libusb/libusb/libusb/hotplug.o\n  CC(target) Release/obj.target/libusb/libusb/libusb/io.o\n  CC(target) Release/obj.target/libusb/libusb/libusb/strerror.o\n  CC(target) Release/obj.target/libusb/libusb/libusb/sync.o\n  CC(target) Release/obj.target/libusb/libusb/libusb/os/poll_posix.o\n  CC(target) Release/obj.target/libusb/libusb/libusb/os/threads_posix.o\n  CC(target) Release/obj.target/libusb/libusb/libusb/os/linux_usbfs.o\n  CC(target) Release/obj.target/libusb/libusb/libusb/os/linux_udev.o\n../libusb/libusb/os/linux_udev.c:40:21: fatal error: libudev.h: No such file or directory\n #include \n                     ^\ncompilation terminated.\nlibusb.target.mk:135: recipe for target 'Release/obj.target/libusb/libusb/libusb/os/linux_udev.o' failed\nmake: *** [Release/obj.target/libusb/libusb/libusb/os/linux_udev.o] Error 1\nmake: Leaving directory '/built_app/programs/server/npm/node_modules/usb/build'\ngyp ERR! build error\ngyp ERR! stack Error: make failed with exit code: 2\ngyp ERR! stack     at ChildProcess.onExit (/built_app/programs/server/node_modules/node-gyp/lib/build.js:258:23)\ngyp ERR! stack     at emitTwo (events.js:87:13)\ngyp ERR! stack     at ChildProcess.emit (events.js:172:7)\ngyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:211:12)\ngyp ERR! System Linux 4.4.0-87-generic\ngyp ERR! command \"/opt/nodejs/bin/node\" \"/built_app/programs/server/node_modules/node-gyp/bin/node-gyp.js\" \"build\" \"--fallback-to-build\" \"--module=/built_app/programs/server/npm/node_modules/usb/src/binding/usb_bindings.node\" \"--module_name=usb_bindings\" \"--module_path=/built_app/programs/server/npm/node_modules/usb/src/binding\"\ngyp ERR! cwd /built_app/programs/server/npm/node_modules/usb\ngyp ERR! node -v v4.8.3\ngyp ERR! node-gyp -v v3.6.2\ngyp ERR! not ok\nnode-pre-gyp ERR! build error\nnode-pre-gyp ERR! stack Error: Failed to execute '/opt/nodejs/bin/node /built_app/programs/server/node_modules/node-gyp/bin/node-gyp.js build --fallback-to-build--module=/built_app/programs/server/npm/node_modules/usb/src/binding/usb_bindings.node --module_name=usb_bindings --module_path=/built_app/programs/server/npm/node_modules/usb/src/binding' (1)\nnode-pre-gyp ERR! stack     at ChildProcess. (/built_app/programs/server/npm/node_modules/usb/node_modules/node-pre-gyp/lib/util/compile.js:83:29)\nnode-pre-gyp ERR! stack     at emitTwo (events.js:87:13)\nnode-pre-gyp ERR! stack     at ChildProcess.emit (events.js:172:7)\nnode-pre-gyp ERR! stack     at maybeClose (internal/child_process.js:862:16)\nnode-pre-gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:222:5)\nnode-pre-gyp ERR! System Linux 4.4.0-87-generic\nnode-pre-gyp ERR! command \"/opt/nodejs/bin/node\" \"/built_app/programs/server/npm/node_modules/usb/node_modules/.bin/node-pre-gyp\" \"install\" \"--fallback-to-build\"\nnode-pre-gyp ERR! cwd /built_app/programs/server/npm/node_modules/usb\nnode-pre-gyp ERR! node -v v4.8.3\nnode-pre-gyp ERR! node-pre-gyp -v v0.6.30\nnode-pre-gyp ERR! not ok\nFailed to execute '/opt/nodejs/bin/node /built_app/programs/server/node_modules/node-gyp/bin/node-gyp.js build --fallback-to-build --module=/built_app/programs/server/npm/node_modules/usb/src/binding/usb_bindings.node --module_name=usb_bindings --module_path=/built_app/programs/server/npm/node_modules/usb/src/binding' (1)\nnpm ERR! Linux 4.4.0-87-generic\nnpm ERR! argv \"/opt/nodejs/bin/node\" \"/opt/nodejs/bin/npm\" \"rebuild\" \"--update-binary\"\nnpm ERR! node v4.8.3\nnpm ERR! npm  v3.10.10\nnpm ERR! code ELIFECYCLE\nnpm ERR! usb@1.2.0 install: node-pre-gyp install --fallback-to-build\nnpm ERR! Exit status 1\nnpm ERR!\nnpm ERR! Failed at the usb@1.2.0 install script 'node-pre-gyp install --fallback-to-build'.\nnpm ERR! Make sure you have the latest version of node.js and npm installed.\nnpm ERR! If you do, this is most likely a problem with the usb package,\nnpm ERR! not with npm itself.\nnpm ERR! Tell the author that this fails on your system:\nnpm ERR!     node-pre-gyp install --fallback-to-build\nnpm ERR! You can get information on how to open an issue for this project with:\nnpm ERR!     npm bugs usb\nnpm ERR! Or if that isn't available, you can get their info via:\nnpm ERR!     npm owner ls usb\nnpm ERR! There is likely additional logging output above.\nnpm ERR! Please include the following file with any support request:\nnpm ERR!     /built_app/programs/server/npm/npm-debug.log\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\nnpm ERR! Linux 4.4.0-87-generic\nnpm ERR! argv \"/opt/nodejs/bin/node\" \"/usr/bin/npm\" \"install\" \"--unsafe-perm\"\nnpm ERR! node v4.8.3\nnpm ERR! npm  v3.10.10\nnpm ERR! code ELIFECYCLE\nnpm ERR! meteor-dev-bundle@0.0.0 install: node npm-rebuild.js\nnpm ERR! Exit status 1\nnpm ERR!\nnpm ERR! Failed at the meteor-dev-bundle@0.0.0 install script 'node npm-rebuild.js'.\nnpm ERR! Make sure you have the latest version of node.js and npm installed.\nnpm ERR! If you do, this is most likely a problem with the meteor-dev-bundle package,\nnpm ERR! not with npm itself.\nnpm ERR! Tell the author that this fails on your system:\nnpm ERR!     node npm-rebuild.js\nnpm ERR! You can get information on how to open an issue for this project with:\nnpm ERR!     npm bugs meteor-dev-bundle\nnpm ERR! Or if that isn't available, you can get their info via:\nnpm ERR!     npm owner ls meteor-dev-bundle\nnpm ERR! There is likely additional logging output above.\nnpm ERR! Please include the following file with any support request:\nnpm ERR!     /built_app/programs/server/npm-debug.log\nThe command '/bin/sh -c cd  /built_app/programs/server &&     npm install --unsafe-perm' returned a non-zero code: 1\nError response from daemon: No such container: 3fold-ipad-menu\nError: failed to start containers: 3fold-ipad-menu\n[192.168.1.33] x Prepare Bundle: FAILED\n    -----------------------------------STDERR-----------------------------------\n    Error response from daemon: No such container: 3fold-ipad-menu\n    The command '/bin/sh -c cd  /built_app/programs/server &&     npm install --unsafe-perm' returned a non-zero code: 1\n    Error response from daemon: No such container: 3fold-ipad-menu\n    Error: failed to start containers: 3fold-ipad-menu\n    -----------------------------------STDOUT-----------------------------------\n    ERR! code ELIFECYCLE\n    npm ERR! meteor-dev-bundle@0.0.0 install: `node npm-rebuild.js`\n    npm ERR! Exit status 1\n    npm ERR!\n    npm ERR! Failed at the meteor-dev-bundle@0.0.0 install script 'node npm-rebuild.js'.\n    npm ERR! Make sure you have the latest version of node.js and npm installed.\n    npm ERR! If you do, this is most likely a problem with the meteor-dev-bundle package,\n    npm ERR! not with npm itself.\n    npm ERR! Tell the author that this fails on your system:\n    npm ERR!     node npm-rebuild.js\n    npm ERR! You can get information on how to open an issue for this project with:\n    npm ERR!     npm bugs meteor-dev-bundle\n    npm ERR! Or if that isn't available, you can get their info via:\n    npm ERR!     npm owner ls meteor-dev-bundle\n    npm ERR! There is likely additional logging output above.\n\n    npm ERR! Please include the following file with any support request:\n    npm ERR!     /built_app/programs/server/npm-debug.log\n\n    ----------------------------------------------------------------------------\n\n```. neisen@neisen-PC:~/devel/scheduling-payroll/.deploy$ mup logs --tail=100\n[45.32.204.114]Error response from daemon: No such container: 3fold-scheduling-payroll\nneisen@neisen-PC:~/devel/scheduling-payroll/.deploy$ mup deploy --verbose\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[45.32.204.114] - Pushing Meteor App Bundle to the Server\n[45.32.204.114] - Pushing Meteor App Bundle to the Server: SUCCESS\n[45.32.204.114] - Prepare Bundle\nnode-8.4.0-base: Pulling from abernix/meteord\nDigest: sha256:04f44cf999da383d11de77027ced8b70818222c9890a405ce10803af3ee5a642\nStatus: Image is up to date for abernix/meteord:node-8.4.0-base\nError response from daemon: No such container: 3fold-scheduling-payroll\nFinished Extracting\nCreating Dockerfile\nFinished creating Dockerfile\nBuilding image\nSending build context to Docker daemon  96.13MB\nStep 1/6 : FROM abernix/meteord:node-8.4.0-base\nExecuting 1 build trigger\n---> Using cache\n ---> c321ee80fd3a\nStep 2/6 : RUN mkdir /built_app\n ---> Using cache\n ---> 2419023e1bd9\nStep 3/6 : COPY ./ /built_app\n ---> Using cache\n ---> 47b3b9ce047f\nStep 4/6 : ENV ROOT_URL=http://45.32.204.114\n ---> Using cache\n ---> 8044acdec7d3\nStep 5/6 : ENV MONGO_URL=mongodb://mongodb:27017/3fold-scheduling-payroll\n ---> Using cache\n ---> c0a91f4c9269\nStep 6/6 : RUN cd  /built_app/programs/server &&     npm install --unsafe-perm\n ---> Running in e4bcbdbb0271\n\nfibers@2.0.0 install /built_app/programs/server/node_modules/fibers\nnode build.js || nodejs build.js\n\nlinux-x64-57 exists; testing\nBinary is fine; exiting\n\nmeteor-dev-bundle@0.0.0 install /built_app/programs/server\nnode npm-rebuild.js\nbcrypt@1.0.3 install /built_app/programs/server/npm/node_modules/bcrypt\nnode-pre-gyp install --fallback-to-build\n\nmodule.js:491\n    throw err;\n    ^\nError: Cannot find module '../'\n    at Function.Module._resolveFilename (module.js:489:15)\n    at Function.Module._load (module.js:439:25)\n    at Module.require (module.js:517:17)\n    at require (internal/module.js:11:18)\n    at Object. (/built_app/programs/server/npm/node_modules/.bin/node-pre-gyp:15:20)\n    at Module._compile (module.js:573:30)\n    at Object.Module._extensions..js (module.js:584:10)\n    at Module.load (module.js:507:32)\n    at tryModuleLoad (module.js:470:12)\n    at Function.Module._load (module.js:462:3)\nnpm ERR! code ELIFECYCLE\nnpm ERR! errno 1\nnpm ERR! bcrypt@1.0.3 install: node-pre-gyp install --fallback-to-build\nnpm ERR! Exit status 1\nnpm ERR! \nnpm ERR! Failed at the bcrypt@1.0.3 install script.\nnpm ERR! This is probably not a problem with npm. There is likely additional logging output above.\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     /root/.npm/_logs/2018-01-10T20_27_05_429Z-debug.log\nnpm ERR! code ELIFECYCLE\nnpm ERR! errno 1\nnpm ERR! meteor-dev-bundle@0.0.0 install: node npm-rebuild.js\nnpm ERR! Exit status 1\nnpm ERR! \nnpm ERR! Failed at the meteor-dev-bundle@0.0.0 install script.\nnpm ERR! This is probably not a problem with npm. There is likely additional logging output above.\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     /root/.npm/_logs/2018-01-10T20_27_05_460Z-debug.log\nThe command '/bin/sh -c cd  /built_app/programs/server &&     npm install --unsafe-perm' returned a non-zero code: 1\nError response from daemon: No such container: 3fold-scheduling-payroll\nError: failed to start containers: 3fold-scheduling-payroll\n[45.32.204.114] x Prepare Bundle: FAILED\n    -----------------------------------STDERR-----------------------------------\n    Error response from daemon: No such container: 3fold-scheduling-payroll\n    The command '/bin/sh -c cd  /built_app/programs/server &&     npm install --unsafe-perm' returned a non-zero code: 1\n    Error response from daemon: No such container: 3fold-scheduling-payroll\n    Error: failed to start containers: 3fold-scheduling-payroll\n    -----------------------------------STDOUT-----------------------------------\n    above.\n\n    npm ERR! A complete log of this run can be found in:\n    npm ERR!     /root/.npm/_logs/2018-01-10T20_27_05_429Z-debug.log\n    npm ERR! code ELIFECYCLE\n    npm ERR! errno 1\n    npm ERR! meteor-dev-bundle@0.0.0 install: `node npm-rebuild.js`\n    npm ERR! Exit status 1\n    npm ERR! \n    npm ERR! Failed at the meteor-dev-bundle@0.0.0 install script.\n    npm ERR! This is probably not a problem with npm. There is likely additional logging output above.\n\n    npm ERR! A complete log of this run can be found in:\n    npm ERR!     /root/.npm/_logs/2018-01-10T20_27_05_460Z-debug.log\n\n    ----------------------------------------------------------------------------. This worked for me:\n\nI deleted the node_modules directory.\nThen, meteor npm update\nThen mup setup\nThen mup deploy. ",
    "mstrlaw": "Same issue. \nRestarting the droplet on Digital Ocean somehow fixed on first deploy, but after the 1st, all consecutive ones failed.\n[edit]\nFor what it's worth, ran mup setup again and after that the issue didn't happen anymore.. ",
    "Gigacross": "Hi all, I've been trying to deploy for days now. I hope someone can help: \nI'm running windows 10, Meteor version 1.5.3 ( Previously was 1.6 ), mup setup runs fine, but I kept hitting the same errors below: \n```\nStarted TaskList: Pushing Meteor App\n[128.199.144.114] - Pushing Meteor App Bundle to the Server\n[128.199.144.114] - Pushing Meteor App Bundle to the Server: SUCCESS\n[128.199.144.114] - Prepare Bundle\nbase: Pulling from abernix/meteord\nc20dc0c5afeb: Already exists\na3ed95caeb02: Already exists\na3ed95caeb02: Already exists\n3858f3c461ce: Already exists\na3ed95caeb02: Already exists\na3ed95caeb02: Already exists\na3ed95caeb02: Already exists\n94f04cfa6fe8: Already exists\n0eb4eea50fdc: Already exists\n2fd6c025a55b: Already exists\n32823e805333: Already exists\na3ed95caeb02: Already exists\na3ed95caeb02: Already exists\nDigest: sha256:512bea3d03802e0dc03a6172c862db67c3451d5172a04bfc53edf97e6cbf7014\nStatus: Image is up to date for abernix/meteord:base\nError response from daemon: No such container: infilerp\nSending build context to Docker daemon  175.6MB\nStep 1/7 : FROM abernix/meteord:base\nExecuting 1 build trigger\n---> Using cache\n ---> 1ee0ca1673c0\nStep 2/7 : RUN mkdir /built_app\n ---> Using cache\n ---> 14eef2b18d93\nStep 3/7 : COPY ./ /built_app\n ---> 98e1ca8e7a66\nStep 4/7 : ENV PORT=8080\n ---> Running in af45f206f79d\nRemoving intermediate container af45f206f79d\n ---> 96b7a262c674\nStep 5/7 : ENV ROOT_URL=http://erp.infil.com.my\n ---> Running in a94a849ccb50\nRemoving intermediate container a94a849ccb50\n ---> 10956a81498d\nStep 6/7 : ENV MONGO_URL=mongodb://mongodb:27017/infilerp\n ---> Running in 9fffbf251d15\nRemoving intermediate container 9fffbf251d15\n ---> 4a89cba2905d\nStep 7/7 : RUN cd  /built_app/programs/server &&     npm install --unsafe-perm\n ---> Running in b753a4dc09f2\n\nfibers@1.0.15 install /built_app/programs/server/node_modules/fibers\nnode build.js || nodejs build.js\n\nlinux-x64-46 exists; testing\nBinary is fine; exiting\n\nmeteor-dev-bundle@0.0.0 install /built_app/programs/server\nnode npm-rebuild.js\nnode-sass@4.5.2 install /built_app/programs/server/npm/node_modules/meteor/materialize_materialize/node_modules/node-sass\nnode scripts/install.js\n\nDownloading binary from https://github.com/sass/node-sass/releases/download/v4.5.2/linux-x64-46_binding.node\nKilled\nnpm ERR! code ELIFECYCLE\nnpm ERR! errno 137\nnpm ERR! node-sass@4.5.2 install: node scripts/install.js\nnpm ERR! Exit status 137\nnpm ERR!\nnpm ERR! Failed at the node-sass@4.5.2 install script.\nnpm ERR! This is probably not a problem with npm. There is likely additional logging output above.\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     /root/.npm/_logs/2017-11-26T05_52_39_941Z-debug.log\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\nnpm ERR! code ELIFECYCLE\nnpm ERR! errno 137\nnpm ERR! meteor-dev-bundle@0.0.0 install: node npm-rebuild.js\nnpm ERR! Exit status 137\nnpm ERR!\nnpm ERR! Failed at the meteor-dev-bundle@0.0.0 install script.\nnpm ERR! This is probably not a problem with npm. There is likely additional logging output above.\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     /root/.npm/_logs/2017-11-26T05_52_40_097Z-debug.log\nI20171126-13:32:03.796(8)?     at [object Object].update (packages/mongo/collection.js:588:29)\n```\nI had to kill the process with ctrl-c to get out at this point. \nI've tried the following:\n\nUsing Meteor  1.6, Node v8.9.1, npm v5.5.1, image: 'mrauhu/meteord:node-8.4.1-base'\nSame Error, No such container: ...\nUsing Meteor  1.6, Node v8.9.1, npm v5.5.1, image: 'abernix/meteord:node-8.4.0-base'\nSame Error, No such container: ...\nUsing Meteor  1.5, Node v8.9.1, npm v5.5.1 image: 'abernix/meteord:base' \nSame Error, No such container : ...\n\nEven switched to using Bash on Windows Linux terminal to do the deployment, and still running into the same issues! I hope someone can shed some light on this, and may be just tell me which version of meteor to use on which version of mup with which image to deploy ... \n. Thanks @Zodern ! The swapfile did the trick, but now I'm running into a separate issue: After adding the swapfile, I was still on meteor 1.5.4, so I ran into sshpk issue. Then I updated to meteor 1.6, but that issue persisted. So I followed your instruction above to use https://github.com/mrauhu/meteord \nBut I ran into the following issues:\n```\nC:\\Users\\xxxxxxx\\Documents\\Dev\\Proj\\infilerp.deploy>mup.cmd deploy --verbose\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[128.199.205.141] - Pushing Meteor App Bundle to the Server\n[128.199.205.141] - Pushing Meteor App Bundle to the Server: SUCCESS\n[128.199.205.141] - Prepare Bundle\nError: No such image: mup-infilerp:latest\n[128.199.205.141] - Prepare Bundle: SUCCESS\nStarted TaskList: Configuring App\n[128.199.205.141] - Pushing the Startup Script\n[128.199.205.141] - Pushing the Startup Script: SUCCESS\n[128.199.205.141] - Sending Environment Variables\n[128.199.205.141] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[128.199.205.141] - Start Meteor\nError: No such image: mup-infilerp:latest\nusing bundle\nError: No such image: mup-infilerp:previous\nError: No such image: mup-infilerp:previous\nError: No such image: mup-infilerp:latest\nImage mrauhu/meteord:node-8.4.1-base\nVolume --volume=/opt/infilerp/current:/bundle\nRemoving docker containers. Errors about nonexistent endpoints and containers are normal.\nError: No such container: infilerp\nError response from daemon: endpoint infilerp not found\nError: No such container: infilerp-frontend\nError response from daemon: endpoint infilerp-frontend not found\nError: No such container: infilerp-nginx-letsencrypt\nError response from daemon: endpoint infilerp-nginx-letsencrypt not found\nError: No such container: infilerp-nginx-proxy\nError response from daemon: endpoint infilerp-nginx-proxy not found\nFinished removing docker containers\nError response from daemon: manifest for mrauhu/meteord:node-8.4.1-base not found\nPulled mrauhu/meteord:node-8.4.1-base\nUnable to find image 'mrauhu/meteord:node-8.4.1-base' locally\ndocker: Error response from daemon: manifest for mrauhu/meteord:node-8.4.1-base not found.\nSee 'docker run --help'.\n[128.199.205.141] x Start Meteor: FAILED\n    -----------------------------------STDERR-----------------------------------\n    Error: No such image: mup-infilerp:latest\n    Error: No such image: mup-infilerp:previous\n    Error: No such image: mup-infilerp:previous\n    Error: No such image: mup-infilerp:latest\n    Removing docker containers. Errors about nonexistent endpoints and containers are normal.\n    Error: No such container: infilerp\n    Error response from daemon: endpoint infilerp not found\n    Error: No such container: infilerp-frontend\n    Error response from daemon: endpoint infilerp-frontend not found\n    Error: No such container: infilerp-nginx-letsencrypt\n    Error response from daemon: endpoint infilerp-nginx-letsencrypt not found\n    Error: No such container: infilerp-nginx-proxy\n    Error response from daemon: endpoint infilerp-nginx-proxy not found\n    Finished removing docker containers\n    Error response from daemon: manifest for mrauhu/meteord:node-8.4.1-base not found\n    Unable to find image 'mrauhu/meteord:node-8.4.1-base' locally\n    docker: Error response from daemon: manifest for mrauhu/meteord:node-8.4.1-base not found.\n    See 'docker run --help'.\n    -----------------------------------STDOUT-----------------------------------\n    using bundle\n    Image mrauhu/meteord:node-8.4.1-base\n    Volume --volume=/opt/infilerp/current:/bundle\n    Pulled mrauhu/meteord:node-8.4.1-base\n    ----------------------------------------------------------------------------\n\n```\nI believe the problem is this line Error response from daemon: manifest for mrauhu/meteord:node-8.4.1-base not found\nI've spent days on this ... please help .... Okay I finally managed to deploy after all those hurdles by following this: https://github.com/meteor/meteor/issues/7401#issuecomment-232421798 but I'm forced to use a previous version of materialize and things aren't really working yet, but at least I can deploy.. ",
    "johannel00": "I have been sleepless for about two days trying to deploy my Meteor 1.6.1 app. With many \"No such container: \" log errors I eventually got it fixed by removing the rajit:bootstrap3-datepicker package I had in my project. Seems like it didn't compile correctly because of Babel related issues. I hope this helps anyone who is still looking for answers.  Please check package compatibility!. @Yhozen - The first thing I did was to remove the spiderable package because when searching for a solution I saw that some people were having deployment issues regarding that package. The error still persisted after removing it and I think I looked at the log ( mup logs [-f --tail=100] )to try and see where the process stopped and noticed a file that can\u2019t be imported correctly. So then I did a global search for that specific file and found that it was in the rajit:bootstrap3-datepicker package. I then removed that package too and the process completed successfully. . ",
    "Yhozen": "@johannel00  How did you realise which package was the one making problems?. ",
    "SevenZark": "Same here. I develop on a mac and deploy to Linux, so this is an issue. And my situation is probably not that uncommon.. @zodern Yes, I still get the same error message when trying to install again after uninstalling.. Thanks!. ",
    "imajus": "Same here.. ",
    "one-pereyra": "+1\n. ",
    "Ziinc": "@jmwierzbicki I have not been able to connect to a mup deployment on Debian, despite mup status saying that everything is running.. Let's Encrypt works after switching docker container to zodern/meteor:root.\n@zodern is there any reason why the docs example doesn't use your docker container?. @guillim were you able to resolve the issue by using zodern's docker image?. ",
    "birdage": "is this what your after? mup deploy --cached-build. ",
    "nzomedia": "i've juste got that error about missing  container. I checked actual containers (with docker ps -a) and in fact there was no container at all (i deleted them previously). To solve i juste typed mup setup, and it recreated missing containers.. If there's enough space on disk you could check to see if there's still free inodes with  df -ih\nsource: https://unix.stackexchange.com/questions/40218/tar-no-space-left-on-device. Hello, perhaps the documentation can provide you some help: http://meteor-up.com/docs.html#migration-guide\nBut please make backups before doing anything.. ",
    "wessilfie": "@zodern this is what it shows\n```\nCONTAINER ID        IMAGE                  COMMAND                  CREATED             STATUS              PORTS                        NAMES\nbac3170ed17e        abernix/meteord:base   \"/bin/sh -c 'bash ...\"   45 seconds ago      Up 44 seconds       0.0.0.0:80->80/tcp           app-name\n7abf51081174        abernix/meteord:base   \"/bin/sh -c 'bash ...\"   3 days ago          Up 3 days           0.0.0.0:3016->80/tcp         otherapp-website\ndaf87674c310        mongo:3.4.1            \"/entrypoint.sh mo...\"   3 days ago          Up 3 days           127.0.0.1:27017->27017/tcp   mongodb\n```. Remade mup.js and then did mup setup and mup deploy and got the following:\n``` \nID        IMAGE                                           COMMAND                  CREATED              STATUS              PORTS                                      NAMES\n297cd34a3477        jrcs/letsencrypt-nginx-proxy-companion:latest   \"/bin/bash /app/en...\"   53 seconds ago       Up 52 seconds                                                  app-nginx-letsencrypt\n36fecc56d135        jwilder/nginx-proxy:latest                      \"/app/docker-entry...\"   About a minute ago   Up About a minute   0.0.0.0:80->80/tcp, 0.0.0.0:443->443/tcp   app-nginx-proxy\ne0ac63806510        abernix/meteord:base                            \"/bin/sh -c 'bash ...\"   About a minute ago   Up About a minute   80/tcp                                     app\nc372c0091dea        mongo:3.4.1                                     \"/entrypoint.sh mo...\"   3 minutes ago        Up 3 minutes        127.0.0.1:27017->27017/tcp                 mongodb\n7abf51081174        abernix/meteord:base                            \"/bin/sh -c 'bash ...\"   3 days ago           Up 3 days           0.0.0.0:3016->80/tcp                       otherapp-website\n```. ",
    "JonathanLehner": "any solutions?. ",
    "Michael-Reich": "I solved it with the reverse proxy! Perfect thank you!\nhttps://electric-news.co. ",
    "rolljee": "Any update on this ?\nWe are experiencing the same issue for files larger than 1GB. After adding the proxy property, did you ran the :\nmup proxy setup --config=mup.js or\nmup proxy reconfig-shared --config=mup.js\nto see if it configure the let's encrypt properly ?. Any help wanted ?\nI have time to contribute in December ! Feel free to pm me on gitter \ud83d\ude42. * I completly reworded the way I change the MAIL_URL & MONGO_URL\n Added a warning for docker status when version are not the same for all servers.\n. * Open collective has been changed as requested\n yargs has been updated to the lastest version\n* Some vulnerabilities have been corrected by running npm audit. Did you manage to make it work since ? still an issue ?\nif yes, could you run:\nmup proxy setup --config=mup.js --verbose\nand tell us the output of the command.\nCould you try removing the GridFS package and re-deploy to see if something is due to this warning ?. For now i've tried a lot (but not all) of the command launchable by mup, no error so far.\nI'll try a more for with the changes requested builder.hide(commandName). Done.. Done.. Done.. DIdn't know about that !\nDone.. I've given a look into yargs to see if there was any option as builder.hide is not working.\nhttps://github.com/yargs/yargs/issues/851 - This fixed the issue, we can now put the description to false and the option will be hidden. ",
    "realyze": "Sorry guys, I lost track of this. My inode count was pretty low so I guess that was it. I have updated docker to 17.11 and ran docker system prune -a and that helped massively.. ",
    "panharithleang": "Oh I put the wrong image config. Issue solved now. Thank you. ",
    "yongyi520": "Hi, is there a command or documentation somewhere to:\n1. Clear server logs\n2. Store the output of server logs to a file\n. Hi zodern\nRecently, I had a very very long server log (when i type in mup logs -f, it took me 5 minutes to let it generate all the logs from the beginning). I had to scroll for a very long time to find out where the problem was. \nI want to clear logs because I want to remove the part of the console log that are working correctly. \nI want to store it in a file to treat it as back up... in case if logs contains valuable information that I overlooked when I clear the console log. \nPerhaps the logs can be displayed via 'syslog-address' within the configuration. I am having trouble understand and learning how to use that. Is there extra resources (examples) where I can find? . ",
    "Slind14": "Thank you, does this work on windows?. Thank you, so this would be this part of the doc, unless I'm mistaken?\nhttp://meteor-up.com/docs.html#hooks-1\nWhich event would be best suited for this?. Thank you :). I totally forgot that the env var is only available on the server. Any chance that the settings can be patched the same way, so that it works with offline apps(once downloaded/updated)?. Same issue with 1.3.6. ",
    "Discordius": "I would also be interested in contributing funds to this, if additional funds are still needed. . I donated to the repository but wasn't invited. \nAlso: What's the current state of the repository? Is it basically production-ready? . ",
    "coagmano": "@SachaG try this page: https://opencollective.com/meteor-up/donate\nIt has the \"once time\" donation option. ",
    "asmakam": "This is awesome! @zodern just sent $100 for the project!. ",
    "paduchurikowsik": "i donated to the repository, when can i get access to it. \nThanks . @zodern hey i didnt get any mail for any repositories, can you please tell me what should i do. ",
    "PolybitSol": "Hey @zodern, I'm also extremely interested in the autoscaling plugin for my project. \nIs there an ETA on the public release, and if not what is the status of funding and required amount to get access to the repository? Also interested in the current functionality of the private repository. Thank you for your time!. Brilliant, I'll be trying that out tonight @zodern, great work - thank you!. ",
    "exponent42": "This is flipping good. Can't believe I didn't know about it until now. Thank you zodern. \nDonation on its way to you \nThanks . ",
    "erixtekila": "Hi @kristofvanwoensel, did you succeed in creation and make it downloadable ?\nThanks for sharing your solution.. ",
    "kristofvanwoensel": "Hi erixtekila\nIt has been a year now, so I'm not sure what actually did the trick. I guess it had to do with the lack of ownership or writing rights to this folder. I would suggest trying a chown & chmod of the folder.\nI  can verify that my mup.js file is still like the one I posted above.\n. ",
    "yorrd": "Yes. Most of all: we just don't have root permission on many deploy servers. We could ask the sysadmin to install docker for our clients but they won't ever give us full root permission.\nI'd really appreciate if we'd have the option to \n\nuse an existing docker, install an image by ourselves and then use that or\nadd the user to the docker group and only permit specific commands or\nhave an option that works locally (I deploy meteor out of a single directory, no root permission needed (except for the proxy to port 80))\n\nI'd much prefer option 3, but I realize you have committed to the docker approach. \nIn any way, I think this would be a much needed improvement for everyone using this in a real-world production scenario and not just on their own test servers or root servers. ",
    "Rongky": "Sorry for the late reply... \nI'm also deploying to mobile and desktop using meteor-desktop package by wojtkowiak so I needed to set a separate mobileSettings file, although, mup settings.json and mobileSettings have the same content/settings.\nusing inside mup.js:\nmobileSettings: require(' /home/rongky/app/.deploy/staging/settings.json')\ncommand:\nDEBUG=* mup deploy --verbose --settings /home/rongky/app/.deploy/staging/settings.json\nhere is the complete error:\n[meteor-desktop]: Preparing desktop.asar took: 1997.124ms\n/home/rongky/.meteor/packages/juliancwirko_postcss/.1.2.0.182ee2j++os+web.browser+web.cordova/plugin.minifier-postcss.os/npm/node_modules/meteor/promise/node_modules/meteor-promise/promise_server.js:190\n      throw error;\n      ^\nError: ENAMETOOLONG: name too long, open '{\"xxxx\":{\"id\":\"xxxx\"},\"public\":{\"app\":{\"name\":\"appname\",\"version\":\"0.3.7\"},\"connectionBanner\":{\"connectionLostText\":\"App is OFFLINE.\",\"tryReconnectText\":\"Retry now...\",\"reconnectBeforeCountdownText\":\"Attempting to reconnect in\",\"reconnectAfterCountdownText\":\"s\"},\"staleSessionInactivityTimeout\":180000,\"staleSessionHeartbeatInterval\":180000,\"staleSessionPurgeInterval\":60000,\"staleSessionActivityEvents\":\"mousemove click keydown\",\"cloudinary\":{\"cloud_name\":\"xxx\",\"upload_preset\":\"xxx\"}},\"private\":{}}'\n    at Object.fs.openSync (fs.js:648:18)\n    at Object.fs.readFileSync (fs.js:553:33)\n    at Object.wrapper [as readFile] (/tools/fs/files.js:1558:35)\n    at CordovaBuilder.copyWWW (/tools/cordova/builder.js:403:24)\n    at CordovaProject.prepareFromAppBundle (/tools/cordova/project.js:204:13)\n    at buildmessage.enterJob (/tools/cli/commands.js:1063:24)\n    at /tools/utils/buildmessage.js:359:18\n    at exports.EnvironmentVariable.withValue (/tools/utils/fiber-helpers.js:89:14)\n    at /tools/utils/buildmessage.js:352:34\n    at exports.EnvironmentVariable.withValue (/tools/utils/fiber-helpers.js:89:14)\n    at /tools/utils/buildmessage.js:350:23\n    at exports.EnvironmentVariable.withValue (/tools/utils/fiber-helpers.js:89:14)\n    at Object.enterJob (/tools/utils/buildmessage.js:324:26)\n    at main.captureAndExit (/tools/cli/commands.js:1052:20)\n    at /tools/utils/buildmessage.js:271:13\n    at exports.EnvironmentVariable.withValue (/tools/utils/fiber-helpers.js:89:14)\n    at /tools/utils/buildmessage.js:264:29\n    at exports.EnvironmentVariable.withValue (/tools/utils/fiber-helpers.js:89:14)\n    at /tools/utils/buildmessage.js:262:18\n    at exports.EnvironmentVariable.withValue (/tools/utils/fiber-helpers.js:89:14)\n    at /tools/utils/buildmessage.js:253:23\n    at exports.EnvironmentVariable.withValue (/tools/utils/fiber-helpers.js:89:14)\n    at Object.capture (/tools/utils/buildmessage.js:252:19)\n    at Object.main.captureAndExit (/tools/cli/main.js:274:29)\n    at buildCommand (/tools/cli/commands.js:1042:10)\n    at Command.func (/tools/cli/commands.js:876:12)\n    at /tools/cli/main.js:1522:15. ",
    "pmogollons": "Hi,\nIm having a similar issue using mup 1.3.3 and 1.3.5 (Havent tested in any more versions), where I get sometimes a EPIPE error and sometimes an ECONNRESET error\nIm able to ssh to my server and looks like mup is also connecting to it, but it fails after it.\n````\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[52.168.176.164] - Pushing Meteor App Bundle to The Server\n[======                                 ] 17% 43.6sevents.js:160\n      throw er; // Unhandled 'error' event\n      ^\nError: write EPIPE\n    at exports._errnoException (util.js:1020:11)\n    at WriteWrap.afterWrite (net.js:800:14)\n````\n````\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[52.168.176.164] - Pushing Meteor App Bundle to The Server\n[===                                    ] 11% 46.1sevents.js:160\n      throw er; // Unhandled 'error' event\n      ^\nError: read ECONNRESET\n    at exports._errnoException (util.js:1020:11)\n    at TCP.onread (net.js:568:26)\n````\n. ",
    "oliverjc": "I kept on receiving Error: connect ECONNREFUSED when it was trying to copy the certificate bundle. I checked the firewall status with sudo ufw status and saw this:\nTo                         Action      From\n--                         ------      ----\n22                         LIMIT       Anywhere\n80                         ALLOW       Anywhere\n443                        ALLOW       Anywhere\n22 (v6)                    LIMIT       Anywhere (v6)\n80 (v6)                    ALLOW       Anywhere (v6)\n443 (v6)                   ALLOW       Anywhere (v6)\nsudo ufw allow '22' allowed my port 22 connection to persist, and presumably stop limiting the data flow when it was transferring some files.\nTo                         Action      From\n--                         ------      ----\n22                         ALLOW       Anywhere\n80                         ALLOW       Anywhere\n443                        ALLOW       Anywhere\n22 (v6)                    ALLOW       Anywhere (v6)\n80 (v6)                    ALLOW       Anywhere (v6)\n443 (v6)                   ALLOW       Anywhere (v6)\nThis fixed my problem!. For me, using image: 'zodern/meteor:root' in my docker config in mup.js did the trick. ",
    "ebradbury": "Thanks @oliverjc.\nIn my case, I had to also removed a 'limit' ufw rule.\nufw delete limit 22/tcp then ufw allow 22/tcp. ",
    "mukulhase": "Here is the config:\n```\n{\n  \"servers\": {\n    \"one\": {\n      \"host\": \"1.2.3.4\",\n      \"username\": \"ubuntu\",\n      \"pem\": \"~/.ssh/pem\"\n    }\n  },\n  \"mongo\": {\n    \"port\": 27017,\n    \"version\": \"3.4.1\",\n    \"servers\": {\n      \"one\": {}\n    }\n  },\n  \"app\": {\n    \"name\": \"my-app\",\n    \"path\": \"../pebble-messenger\",\n    \"servers\": {\n      \"one\": {}\n    },\n    \"buildOptions\": {\n      \"serverOnly\": true\n    },\n    \"env\": {\n      \"ROOT_URL\": \"https://subdomain.host.com\",\n      \"MONGO_URL\": \"mongodb://mongodb:27017/my-app\",\n      \"PORT\": 8086\n    },\n    \"docker\": {\n      \"image\": \"abernix/meteord:base\",\n      \"args\": [\n        \"--link=mongodb:mongodb\",\n        \"--link=mongodb:mongodb\"\n      ]\n    },\n    \"deployCheckWaitTime\": 95,\n    \"enableUploadProgressBar\": true,\n    \"type\": \"meteor\"\n  }\n}\n``currentis empty, buttmp` has bundle.tar.gz\n. ",
    "html5-ninja": "same. same. ",
    "Elviron": "@ziedmahdi It works for me, haven't noticed any problems yet!. ",
    "evuori": "Same \"Bad Gateway 502\" error here on 80/443. \nFound few similar past issues relating ssl config but getting error with or without force-ssl package.. @zodern sorry can't reproduce since I had to roll back to 1.5.2. However,  I am setting up fresh instance at the moment so will have chance to try in few hours.... ok, hands dirty here. Found nothing special, logs pretty much same as @xpressabhi.\nOnly difference is that im getting \"Could Not Connect\" response instead. \n```\n$mup deploy\nStarted TaskList: Pushing Meteor App\n[xx.xxx.xxx.xx] - Pushing Meteor App Bundle to The Server\n[xx.xxx.xxx.xx] - Pushing Meteor App Bundle to The Server: SUCCESS\n[xx.xxx.xxx.xx] - Prepare Bundle\n[xx.xxx.xxx.xx] - Prepare Bundle: SUCCESS\nStarted TaskList: Configuring App\n[xx.xxx.xxx.xx] - Pushing the Startup Script\n[xx.xxx.xxx.xx] - Pushing the Startup Script: SUCCESS\n[xx.xxx.xxx.xx] - Sending Environment Variables\n[xx.xxx.xxx.xx] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[xx.xxx.xxx.xx] - Start Meteor\n[xx.xxx.xxx.xx] - Start Meteor: SUCCESS\n[xx.xxx.xxx.xx] - Verifying Deployment\n[xx.xxx.xxx.xx] x Verifying Deployment: FAILED\n$mup logs --tail=100\n[xx.xxx.xxx.xx]SyntaxError: Unexpected token {\n[xx.xxx.xxx.xx]    at exports.runInThisContext (vm.js:53:16)\n[xx.xxx.xxx.xx]    at Module._compile (module.js:373:25)\n[xx.xxx.xxx.xx]    at Object.Module._extensions..js (module.js:416:10)\n[xx.xxx.xxx.xx]    at Module.load (module.js:343:32)\n[xx.xxx.xxx.xx]    at Function.Module._load (module.js:300:12)\n[xx.xxx.xxx.xx]    at Module.require (module.js:353:17)\n[xx.xxx.xxx.xx]    at require (internal/module.js:12:17)\n[xx.xxx.xxx.xx]   at Object. (/built_app/main.js:4:1)\n[xx.xxx.xxx.xx]    at Module._compile (module.js:409:26)\n[xx.xxx.xxx.xx]    at Object.Module._extensions..js (module.js:416:10)\n[xx.xxx.xxx.xx]=> Starting meteor app on port:80\n[xx.xxx.xxx.xx]/built_app/programs/server/boot.js:50\n[xx.xxx.xxx.xx]    const { pause } = require(\"./debug.js\");\n```\nShould docker ps show 80/443 in container PORT?\n\nupdate: removed addressinfo. With \"abernix/meteord:node-8.4.0-base\" things working good in Meteor 1.6, no issues, confirmed.. \n",
    "tanermelikoglu": "i have the same issue, with Meteor 1.6.0.1, abernix/meteord:node-8.4.0-base, node v8.9.3, mup 1.3.7 at deploying the app on digital ocean. In my case the deployment failed at verifying stage on digital ocean. \nDocker image is pushed without any tag and version, so the container can't found the  image with given name and tag (myapp:latest) and shut down.\nI found in other forum, that not valid settings.json (in public area) causes the problem. The solution would be deploy the app with empty settings.json. ( {} ) But it does not work for me. \nI don't know the real reason of the problem. I deployed my app many times with meteor 1.4.x and node 4.x. Now i updated all the packages,  mup, node and the docker image but nothing helps.. ",
    "myktra": "UPDATE: Solved.\nMy forked Docker image myktra/meteord:base was not automatically published to Docker Hub for some reason. So the older fork I was trying to replace continued to run with Node 4.8.x, and was thus incompatible with Meteor 1.6. So keep an eye on your Docker images and make sure MUP is deploying the right base image for Meteor.\n--\nI'm running into this issue as well upgrading a Meteor 1.5.4.x/Node 4.8.x application. I maintain a fork of abernix/meteord:base for the sole purpose of passing options to Node to run in a low-memory environment. When I updated my fork with the latest improvements (Node 8.9.3, etc.), and use mup 1.3.7 I receive similar deployment errors.\nFWIW, my host machine is an Ubuntu 14.04.5 LTS.\n```\n.\n.\n.\n{\n  \"meteor-dev-bundle\": \"0.0.0\",\n  \"npm\": \"4.6.1\",\n  \"ares\": \"1.10.1-DEV\",\n  \"http_parser\": \"2.7.0\",\n  \"icu\": \"56.1\",\n  \"modules\": \"46\",\n  \"node\": \"4.8.4\",\n  \"openssl\": \"1.0.2k\",\n  \"uv\": \"1.9.1\",\n  \"v8\": \"4.5.103.47\",\n  \"zlib\": \"1.2.11\"\n}\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\n=> Starting meteor app on port:80\n/bundle/bundle/programs/server/boot.js:50\n    const { pause } = require(\"./debug.js\");\n          ^\nSyntaxError: Unexpected token {\n    at exports.runInThisContext (vm.js:53:16)\n    at Module._compile (module.js:373:25)\n.\n.\n.\n```. ",
    "takeshikriang": "I have the same problem with Postmark. Everything works on my Mac but stop working on server.. @steinitz Thanks, but it does not work for me. T_T. ",
    "steinitz-zz": "@Giantwannabe I had to add the SendGrid smtp string as the MAIL_URL in the mup environment like so:\nenv: {\n      ROOT_URL: 'http://x.y.z',\n      MONGO_URL: 'mongodb://localhost/meteor',\n      MAIL_URL: 'smtp://user:password@smtp.sendgrid.net:587',\n    },\nThen all was well.. ",
    "pyrostrex": "@zodern, this happened to me too. My app was from meteor create meteorapp. Executed meteor once and then tried to use mup to deploy and this happened. Windows 10 -> Ubuntu 17.10. Same configuration as @ddaydd . image: 'abernix/meteord:node-8.4.0-base'. Yep confirmed on my end that is a success too. Thanks!. ",
    "ddaydd": "@zodern the error is on a basic meteor application, do you need it anyway?. Deploy success !! Thanks :)\n. See my answer on SO\nhttps://stackoverflow.com/questions/47651328/meteor-up-mup-new-docker-image/47920666#47920666. hi,\nI don't know if it's the same but I had similar problems, but thanks to the command ssh \ndocker container ls\nI have seen that I have several container.\n\nreboot, mup deploy and that was good. Hi,\nhttps://github.com/zodern/meteor-up/issues/460#issuecomment-283455401. ",
    "KernelPan1k": "Hello, thank you for this answer but it does not work with me. I have the configuration by default, here is some captures, thank you very much to use.\n\n\n\n\n. Hello, I tried with the domain name and the Ip address, then with 127.0.0.1 and localhost but it is the same result.\nThe version of mup is :\nmik4@r2d2:~$ mup --version\n1.3.4\n\nThank you. Hello @Shelagh-Lewins , I have no answer to your problem, but you have solved my problem. Thank you very much and excellent end of the week.. @Shelagh-Lewins Hello, I am sorry but I cannot make this kind of test because the application is in production. I have a system of backup which is made with a crontab and I am capable of restoring the online database of order via ssh, but I had not planned to do it since robomongo. I have just tested on a server localhost and that works correctly, but it is delicate to test it on the server of production.\nThe localhost server and production work whith the same configuration. \n\nDebian Stretch\nMeteor 1.6.0.1\nExport/import in json. \n",
    "captainviet": "Thank you very much @zodern! I've upgraded the RAM of my server and now the deployment goes smooth as before. I didn't know that mup would consume 1GB worth of RAM and kill my deployment.\nAnyway, I notice the same error output about meteor-dev-bundle and node npm-rebuild.js when I tried to deploy a Meteor app to Google Cloud using their scripts, so I'm wondering what they actually do in the process of deploying Meteor app?\nI've been working with Meteor for a long time, but only until recently did I attempt to do deployment and figuring out all these problems, and I'd be grateful if you can help me explain the above concern. Thank you once again!. ",
    "SkinyMonkey": "Ah, sorry for the issue.\nThat might explain the other issues i have then.\nThanks a lot for the quick answer!. ",
    "tpmh31292": "You mean removing the node_modules folder in my meteor project? And meteor npm install mup?\nI installed mup globally.. No luck, still the same error with exit code 126. @zodern removing the meteorhacks:kadira-profiler package made it works now.\nBut now another problem happens at Verifying Deployment. I set the deployCheckWaitTime to 180 but this error still exists.\nthe Meteor version as shown in .meteor/release is METEOR@1.4.1.1\nI also tried moving the mup.js and settings.json to a location outside of the app\u2019s folder but still not working.\n```\n[xxx.xxx.xxx.xxx] x Verifying Deployment: FAILED\n    -----------------------------------STDERR-----------------------------------\n    ules/meteor/babel-compiler/node_modules/reify/node/runtime.js:16:23)\n        at Function.Module._load (module.js:300:12)\n    => Starting meteor app on port:80\n    /built_app/programs/server/node_modules/fibers/future.js:280\n                                                    throw(ex);\n                                                    ^\n\n    Error: Cannot find module 'websocket-driver'\n        at Function.Module._resolveFilename (module.js:325:15)\n        at Function.Module._load (module.js:276:25)\n        at Module.require (module.js:353:17)\n        at require (internal/module.js:12:17)\n        at Object.<anonymous> (/built_app/programs/server/npm/node_modules/meteor/ddp-server/node_modules/sockjs/node_modules/faye-websocket/lib/faye/websocket.js:8:14)\n        at Module._compile (module.js:409:26)\n        at Object.Module._extensions..js (module.js:416:10)\n        at Module.load (module.js:343:32)\n        at Module.Mp.load (/built_app/programs/server/npm/node_modules/meteor/babel-compiler/node_modules/reify/node/runtime.js:16:23)\n        at Function.Module._load (module.js:300:12)\n\n    => Redeploying previous version of the app\n\n    -----------------------------------STDOUT-----------------------------------\n\n    To see more logs type 'mup logs --tail=100'\n\n    ----------------------------------------------------------------------------\n\n```. Thanks, did that and it works now. But I don't understand why it asked for it, I didn't have and didn't use that package before.. ",
    "n8ores": "I get the same error (works on OSX but not Win10) but with basic.js instead of exclusion.js. \nAre you deploying to AWS on ubuntu by any chance?. Yes I can see that, I have configured mup.js to login using the user ubuntu (not root) I wonder if the ubuntu user needs to have user permissions added, e.g sudo chown -R /DIRECTORYHOLDING the build.\nHowever I am not sure where the directory that holds the build is located?\n . I also get the Dockerfile: Permission denied error during the mup deploy process. I am running mup deploy FROM my actual AWS server (logged in as ubuntu). \nI am using mup 1.3.6\n`[52.64.191.5] - Prepare Bundle\nnode-8.4.0-base: Pulling from abernix/meteord\nDigest: sha256:04f44cf999da383d11de77027ced8b70818222c9890a405ce10803af3ee5a642\nStatus: Image is up to date for abernix/meteord:node-8.4.0-base\n\nbash: line 28: Dockerfile: Permission denied\n[52.64.191.5] x Prepare Bundle: FAILED\n    -----------------------------------STDERR-----------------------------------\n    bash: line 28: Dockerfile: Permission denied\n    -----------------------------------STDOUT-----------------------------------\n    node-8.4.0-base: Pulling from abernix/meteord\n    Digest: sha256:04f44cf999da383d11de77027ced8b70818222c9890a405ce10803af3ee5a642\n    Status: Image is up to date for abernix/meteord:node-8.4.0-base\n    <APP_NAME>\n    ----------------------------------------------------------------------------\n\n`. ",
    "hope-11": "I get the same error . I fix it!\nThe problem is caused by the permission of user 'ubuntu', so we must set the 'username' 'root' in mup.js.\nbut first, you should allow user 'root' to be able to login the aws ec2 ubuntu server, by default it's not allowed.\nfollow these steps:\n1. login your server with user 'ubuntu'\n2. create root password\n\n$ sudo passwd root\n3. switch to root \n$ su\n4. open the file '/etc/ssh/sshd_config', and edit it\nvim /etc/ssh/sshd_config\n\nmodify these words\n\nPermitRootLogin yes\nPasswordAuthentication yes\n6. restart sshd service\nservice sshd restart\n\nopen the file '/root/.ssh/authorized_keys, and edit it\n\nvim /root/.ssh/authorized_keys\n\ndelete the words before 'ssh-rsa ...', then like this\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCPqJ2U4gidqek\n4FPQJABENkrUiLVP61LObdFAZXvs2EpCf/nBQCRg4ykMNg+8TC9lb7jC65zfIrTUcNcwongDb4\n3k6miSKu1M8fdqXDpcb8CdDRaKpM2wP8l+hTaJ2aWycXmGJ7lZKQPiwNUOhbrOLNEtDmOI9eiV\nlz7See98LVLW+6AwfzNA8Cu4riDTvEMQr/WQ9NLrS3BZE1TAAswJi9lGDfTgEvfh4Ji+eI/xT\nXrjkkwjerkjk3jrkwejrkjwe9wASXob4rbV12TXjQIcMKaRGQAGrwOHu0nM2ibfTdgqjrTAG\n03CXKzQhF09LdxKlT7GpYe0oVU2R1kjkejwQp howtoing.com\n\n\nnow, we can login the server with root, please try!. I'm glad it works!\nI'm not sure why I must modify the authorized_keys file, or it will not work.\nMaybe the reason is my vision 16.04.. ",
    "nisaus": "I get the same error as well. \nI'm on Windows 10 deploying to AWS on ubuntu. Mine is a different set of js files but as gitTerebi said they are all tar files. I tried setting up and deploying on a clean server but the same error came up. The result is the same for both meteord-base and the 8.4.0 version.. Thanks for the solution!. Did anyone figure out what happened regarding the sudden need to enable root access? It's nice that the problem is solved for now but I wouldn't really want to have to use root from here on and out. Thanks!. That's great, thank you!. ",
    "robport": "Surely, we should be able to change the permissions of the original user?  Seems odd to force everyone to use root and permit root logins?. +1\nNote - this has happened since I upgraded to Meteor 1.6.\n. Finally, resolved this for 1.6.  You need to update the docker image in mup.js.\ndocker: {\n            // change to 'kadirahq/meteord' if your app is using Meteor 1.3 or older\n            image: 'abernix/meteord:node-8.4.0-base',\n        },. ",
    "nchokoev": "Is there a solution without giving up on security?\nI'm using it to deploy on AWS, ssh with pem file. 'sudo' doesn't need a pass. Still same issue.. @gjr-qm Where you try to deploy it to? What is the server?. @gjr-qm  Just tested on AWS Ubuntu 16.04 and looks ok. Unfortunately I've no enough info to reproduce your particular case. If you give me more info so I can try to reproduce it... \nBTW, for Meteor 1.6, please try \ndocker: {\n      image: 'abernix/meteord:node-8.4.0-base',\n    },\n. @gjr-qm I'm deploying with 'ubuntu' user (which can 'sudo' without a pass).\nAs of the first part - it should. Have you tried to upgrade your app to Meteor 1.6 (meteor update --release 1.6) and use the image docker above?. @wildhart, @n8ores \nJust to be clear - did you try removing all running docker containers and all docker images on the host?. Can you please verify that the file \n'/built_app/programs/server/npm/node_modules/meteor/epaminond_nodemailer/node_modules/nodemailer/node_modules/libmime/src/libmime.js'\nexists on the container?\n. @elie222 \nTry with:\nsudo docker run -ti --entrypoint=/bin/ls <your_image> /built_app/programs/server/npm/node_modules/meteor/epaminond_nodemailer/node_modules/nodemailer/node_modules/libmime/src/\nwhere '' is your image ID. You can get it with 'sudo docker images'. \nCan you post the output of this command?\nDo you deploy from Windows?\n.  > module.exports = {\n\nservers: {\n    one: {\n      // TODO: set host address, username, and authentication method\n      host: '192.168.0.114',\n      username: 'root',\n      // pem: './path/to/pem'\n      // password: 'server-password'\n      // or neither for authenticate from ssh-agent\n    }\n\nMaybe provide password for 'root', and make sure you can SSH to it.. @thearabbit \nDo you deploy on MAC?\nProvide the passwoord for 'root'. . @thearabbit Please make sure you can SSH to the PC. Use the same credentials.. @thearabbit \nhttp://osxdaily.com/2011/09/30/remote-login-ssh-server-mac-os-x/\nhttp://osxdaily.com/2016/08/16/enable-ssh-mac-command-line/. ",
    "wildhart": "I still get a similar error with 1.3.6 and 1.3.6-beta1.  Trying a fresh AWS Ubuntu 16.04.3 LTS server.  mup setup works OK. then trying to deploy gives:\n```\n$mup deploy --verbose --cached-build\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502                                           \u2502\n   \u2502   update available 1.3.6-beta1 => 1.3.6   \u2502\n   \u2502        To update, run npm i -g mup        \u2502\n   \u2502                                           \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\nNot building app. Using build from previous deploy at\n/tmp/mup-meteor-86b8821f-c588-4137-875d-ef23740add09\nStarted TaskList: Pushing Meteor App\n[s.virtualinout.com] - Pushing Meteor App Bundle to the Server\n[s.virtualinout.com] - Pushing Meteor App Bundle to the Server: SUCCESS\n[s.virtualinout.com] - Prepare Bundle\nnode-8.9.1-base: Pulling from abernix/meteord\nc20dc0c5afeb: Already exists\n... \na3ed95caeb02: Already exists\nDigest: sha256:9a12326012a41b5ddd2210d5e5d590bb3506bc341a7f5e1540b451e975bb559c\nStatus: Image is up to date for abernix/meteord:node-8.9.1-base\nError response from daemon: No such container: virtualinout\nbash: line 28: Dockerfile: Permission denied\n[s.virtualinout.com] x Prepare Bundle: FAILED\n-----------------------------------STDERR-----------------------------------\nError response from daemon: No such container: virtualinout\nbash: line 28: Dockerfile: Permission denied\n-----------------------------------STDOUT-----------------------------------\nnode-8.9.1-base: Pulling from abernix/meteord\nc20dc0c5afeb: Already exists\n... \na3ed95caeb02: Already exists\nDigest: sha256:9a12326012a41b5ddd2210d5e5d590bb3506bc341a7f5e1540b451e975bb559c\nStatus: Image is up to date for abernix/meteord:node-8.9.1-base\n----------------------------------------------------------------------------\n\n```\nI'm installing as user ubuntu, not root.  I've also tried abernix/meteord:node-8.4.0-base\nI don't know if it's relevant, but when I install/update mup I always get npm WARN optional dep failed, continuing fsevents@1.1.3. I'm still getting this TOS mismatch.  I only installed mup yesterday so should have the latest version of everything.  I also manually pulled the latest version of jrcs/letsencrypt-nginx-proxy-companion and that didn't help.\nTOS hash mismatch. Found: cc88d8d9517f490191401e7b54e9ffd12a2b9082ec7a1d4cec6101f9f1647e7b.\nI'm using mup 1.3.5 (downgraded from 1.3.6 due to #816).  I'm using the proxy.ssl method because I couldn't get the meteor.ssl method to work at all.. I'm still having this problem, but since my original post I've got the iOS app built and HCP works fine in iOS.  HCP still not working on Android though.\nLooking at the Android logs when I open the production app on my Android phone yields the following errors:\n3820 E MeteorWebApp: Download failure\n3820 E MeteorWebApp: com.meteor.webapp.WebAppException: Error downloading asset manifest\n3820 E MeteorWebApp:    at com.meteor.webapp.AssetBundleManager$1.onFailure(AssetBundleManager.java:97)\n3820 E MeteorWebApp:    at okhttp3.RealCall$AsyncCall.execute(RealCall.java:140)\n3820 E MeteorWebApp:    at okhttp3.internal.NamedRunnable.run(NamedRunnable.java:32)\n3820 E MeteorWebApp:    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1133)\n3820 E MeteorWebApp:    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:607)\n3820 E MeteorWebApp:    at java.lang.Thread.run(Thread.java:776)\n3820 E MeteorWebApp: Caused by: java.net.ProtocolException: Expected ':status' header not present\n3820 E MeteorWebApp:    at okhttp3.internal.http.Http2xStream.readHttp2HeadersList(Http2xStream.java:266)\n3820 E MeteorWebApp:    at okhttp3.internal.http.Http2xStream.readResponseHeaders(Http2xStream.java:149)\n3820 E MeteorWebApp:    at okhttp3.internal.http.HttpEngine.readNetworkResponse(HttpEngine.java:723)\n3820 E MeteorWebApp:    at okhttp3.internal.http.HttpEngine.access$200(HttpEngine.java:81)\n3820 E MeteorWebApp:    at okhttp3.internal.http.HttpEngine$NetworkInterceptorChain.proceed(HttpEngine.java:708)\n3820 E MeteorWebApp:    at okhttp3.internal.http.HttpEngine.readResponse(HttpEngine.java:563)\n3820 E MeteorWebApp:    at okhttp3.RealCall.getResponse(RealCall.java:241)\n3820 E MeteorWebApp:    at okhttp3.RealCall$ApplicationInterceptorChain.proceed(RealCall.java:198)\n3820 E MeteorWebApp:    at okhttp3.RealCall.getResponseWithInterceptorChain(RealCall.java:160)\n3820 E MeteorWebApp:    at okhttp3.RealCall.access$100(RealCall.java:30)\n3820 E MeteorWebApp:    at okhttp3.RealCall$AsyncCall.execute(RealCall.java:127)\n3820 E MeteorWebApp:    ... 4 more\n3714 I chromium: [INFO:CONSOLE(75)] \"Error: Error downloading asset manifest\", source: http://localhost:12768/bb6d78a87664c0a708cb6e02b8b4a85f31fcefa7.js?meteor_js_resource=true (75)\nThis suggests that come kind of :status header is missing on the manifest, but this is only a problem for Android.\nGoogling those errors finds a couple of other Meteor users with the same problem, but no resolutions: here on Stackoverflow, using MUP and here on github.\nGoogling just java.net.ProtocolException: Expected ':status' header not present reveals quite a few non-Meteor references to this problem.  HTTP/1.1 on nginx comes up a couple of times.\nI've also created a post on the meteor forums.\nDoes this shed any light on the problem?. I've found the solution.  Nothing to do with MUP.  Updating cordova-plugin-meteor-webapp with:\nmeteor add cordova:cordova-plugin-meteor-webapp@1.6.0\nand then redeploying fixed the hot code push.. I've got this error on my staging server.  I did a successful deploy, made a small fix to the code and \nredeployed resulting in this error.\nI've tried again with app.docker.prepareBundle set to true, but got the same result.  I think my docker supported this by default because my original log file shows Preparing Bundle...\nI'm using Meteor 1.8, using zodern/meteor:root\nHere's the full deploy log:\n````\n$ mup deploy --verbose\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[s.virtualinout.com] - Pushing Meteor App Bundle to the Server\n[s.virtualinout.com] - Pushing Meteor App Bundle to the Server: SUCCESS\n[s.virtualinout.com] - Prepare Bundle\nroot: Pulling from zodern/meteor\nDigest: sha256:94388cd430fcad65bdeaeee831e409aee5ed62456cb8364c764d867a07564f77\nStatus: Image is up to date for zodern/meteor:root\nFinished Extracting\nCreating Dockerfile\nFinished creating Dockerfile\nBuilding image\nSending build context to Docker daemon  291.1MB\nStep 1/12 : FROM zodern/meteor:root\nExecuting 5 build triggers\n---> Using cache\n[...etc...]\nStep 12/12 : RUN cd  /built_app/programs/server &&     npm install --unsafe-perm\n ---> Running in aab07ccb4bdb\nnpm WARN deprecated boom@2.10.1: This version is no longer maintained. Please upgrade to the latest version.\nnpm WARN deprecated cryptiles@2.0.5: This version is no longer maintained. Please upgrade to the latest version.\nnpm WARN deprecated hoek@2.16.3: This version is no longer maintained. Please upgrade to the latest version.\n\nfibers@2.0.0 install /built_app/programs/server/node_modules/fibers\nnode build.js || nodejs build.js\n\nmake: Entering directory '/built_app/programs/server/node_modules/fibers/build'\n  CXX(target) Release/obj.target/fibers/src/fibers.o\n  CXX(target) Release/obj.target/fibers/src/coroutine.o\n  CC(target) Release/obj.target/fibers/src/libcoro/coro.o\n  SOLINK_MODULE(target) Release/obj.target/fibers.node\n  COPY Release/fibers.node\nmake: Leaving directory '/built_app/programs/server/node_modules/fibers/build'\nInstalled in /built_app/programs/server/node_modules/fibers/bin/linux-x64-46/fibers.node\n\nmeteor-dev-bundle@ install /built_app/programs/server\nnode npm-rebuild.js\nbcrypt@2.0.1 install /built_app/programs/server/npm/node_modules/bcrypt\nnode-pre-gyp install --fallback-to-build\n\n[bcrypt] Success: \"/built_app/programs/server/npm/node_modules/bcrypt/lib/binding/bcrypt_lib.node\" is installed via remote\n@babel/runtime@7.1.2 /built_app/programs/server/npm/node_modules/@babel/runtime\nregenerator-runtime@0.12.1 \n[... etc ...]\n+-- util-deprecate@1.0.2 \n`-- xtend@4.0.1 \nRemoving intermediate container aab07ccb4bdb\n ---> 5f3a3da51599\nSuccessfully built 5f3a3da51599\nSuccessfully tagged mup-virtualinout:build\nDeleted Images:\ndeleted: sha256:149960970ccebfc0b64b2195fcc5e0ba935fe7630d53c4b82a8efa9e8905d939\ndeleted: sha256:c97f47e6e8ce796aa56c14ad21408beed959097ad11be4f19eea035ca354ad13\ndeleted: sha256:39ec32dd0aeedd92ba3ed76be593ef151269da557df19bc7b9bd47941a622946\ndeleted: sha256:91897732be8af13ba64767cbecf1b10859c403854723b643101846f2ab7ccba4\nTotal reclaimed space: 286.9MB\n[s.virtualinout.com] - Prepare Bundle: SUCCESS\nStarted TaskList: Configuring App\n[s.virtualinout.com] - Pushing the Startup Script\n[s.virtualinout.com] - Pushing the Startup Script: SUCCESS\n[s.virtualinout.com] - Sending Environment Variables\n[s.virtualinout.com] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[s.virtualinout.com] - Start Meteor\nusing image\nremoving last\nImage mup-virtualinout:latest\nVolume\nRemoving docker containers. Errors about nonexistent endpoints and containers are normal.\nvirtualinout\nError response from daemon: endpoint virtualinout not found\nError: No such container: virtualinout-frontend\nError response from daemon: endpoint virtualinout-frontend not found\nError: No such container: virtualinout-nginx-letsencrypt\nError response from daemon: endpoint virtualinout-nginx-letsencrypt not found\nError: No such container: virtualinout-nginx-proxy\nError response from daemon: endpoint virtualinout-nginx-proxy not found\nFinished removing docker containers\na52a0c08631dc2389920f48c7dcea1b8f95ad9af0d43a9d83daef0f8d87a4f0a\nRan zodern/meteor:root\n[s.virtualinout.com] - Start Meteor: SUCCESS\n[s.virtualinout.com] - Verifying Deployment\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.5 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.5 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n[... repeated till I kill it]\nHere's the result of `$ mup docker ps`\nmup docker ps\n[s.virtualinout.com] docker ps\nCONTAINER ID        IMAGE                                    COMMAND                  CREATED             STATUS              PORTS                                      NAMES\nfcc062ecf796        mup-virtualinout:latest                  \"/bin/sh -c 'bash /h\u2026\"   11 minutes ago      Up 52 seconds       80/tcp, 3000/tcp                           virtualinout\n265a6b5c339a        jrcs/letsencrypt-nginx-proxy-companion   \"/bin/bash /app/entr\u2026\"   About an hour ago   Up About an hour                                               mup-nginx-proxy-letsencrypt\n771935e3b24b        jwilder/nginx-proxy                      \"/app/docker-entrypo\u2026\"   About an hour ago   Up About an hour    0.0.0.0:80->80/tcp, 0.0.0.0:443->443/tcp   mup-nginx-proxy\n807e557b6887        mongo:3.4.1                              \"/entrypoint.sh mong\u2026\"   3 weeks ago         Up 3 hours          127.0.0.1:27017->27017/tcp                 mongodb\nAfter ssh'ing into the server, I can't connect to mongo:\nubuntu@ip-:~$ docker exec -it mongodb mongo virtualinout\nMongoDB shell version v3.4.1\nconnecting to: mongodb://127.0.0.1:27017/virtualinout\n2018-11-20T09:51:57.886+0000 W NETWORK  [main] Failed to connect to 127.0.0.1:27017, in(checking socket for error after poll), reason: Connection refused\n2018-11-20T09:51:58.136+0000 E QUERY    [main] Error: couldn't connect to server 127.0.0.1:27017, connection attempt failed :\nconnect@src/mongo/shell/mongo.js:234:13\n@(connect):1:6\nexception: connect failed\nubuntu@ip-:~$ \n````\nI've triedmup stop,mup reconfig, mup restart, but nothing helped?\nAny ideas?. Weird, suddenly it's working again.  Not sure what I did, but since my last post I tried:\n\nRebooted the server, redeployed, same error, site down.\nTried setting stopAppDuringPrepareBundle to false, same problem.\nRan mup status, and it was around then that I noticed the server running again.. I spoke too soon.  I tried another deploy and got the same problem.\n\nSince I've recently upgraded to Meteor 1.8 I thought this could be a mongodb incompatibility issue.  My mongo version wasn't fixed (no  mongo.version in my config).  To get everything updated to the latest versions I terminated my EC2 instance and started everything from fresh.  No more deployment issues.\nThere appears to be a few similar bugs reported here though: #1019, #988, #906?, #851. I've just deployed Meteor 1.8 + zodern/meteor:root to a staging server and everything went OK.  Don't forget to run meteor npm install --save @babel/runtime@latest meteor-node-stubs@latest first.  Mongo database on the same host was intact after the upgrade.. ",
    "karlreti": "+1\n. ",
    "sundarideaterics": "Started TaskList: Pushing Meteor App\n[34.192.132.153] - Pushing Meteor App Bundle to The Server\n[34.192.132.153] - Pushing Meteor App Bundle to The Server: SUCCESS\n[34.192.132.153] - Prepare Bundle\n[34.192.132.153] x Prepare Bundle: FAILED\n    -----------------------------------STDERR-----------------------------------\n    The command '/bin/sh -c cd  /built_app/programs/server &&     npm install --unsafe-perm' returned a non-zero code: 126\n    -----------------------------------STDOUT-----------------------------------\n    6\n    npm ERR!\n    npm ERR! Failed at the bcrypt@1.0.2 install script.\n    npm ERR! This is probably not a problem with npm. There is likely additional logging output above.\n\n    npm ERR! A complete log of this run can be found in:\n    npm ERR!     /root/.npm/_logs/2017-11-11T09_44_36_855Z-debug.log\n    npm WARN meteor-dev-bundle@0.0.0 No description\n    npm WARN meteor-dev-bundle@0.0.0 No repository field.\n    npm WARN meteor-dev-bundle@0.0.0 No license field.\n    npm ERR! code ELIFECYCLE\n    npm ERR! errno 126\n    npm ERR! meteor-dev-bundle@0.0.0 install: `node npm-rebuild.js`\n    npm ERR! Exit status 126\n    npm ERR!\n    npm ERR! Failed at the meteor-dev-bundle@0.0.0 install script.\n    npm ERR! This is probably not a problem with npm. There is likely additional logging output above.\n\n    npm ERR! A complete log of this run can be found in:\n    npm ERR!     /root/.npm/_logs/2017-11-11T09_44_36_876Z-debug.log\n\nHow to fix this error..pls help me\n. i am using meteor version METEOR@1.4.3.2\nmup version : 1.3.3. ",
    "bevinhex": "Yeah similar problem here, it is because if you want to use proxy for some reason (like http->https redirects), you need to setup ssl for proxy, between proxy and meteor , ssl is not needed, besides if you enable it mup reports error while trying to setup two proxy,  and also need to change ROOT_URL to http or else meteor websocket will try to connect to https address, and somehow keep failing\nMine is working fine now, this is part of my config, just tested.\n```\n  env: {\n      ROOT_URL: 'http://test.de',\n      MONGO_URL: 'mongodb://localhost/meteor',\n    },\n// ssl: {\n  // Enables let's encrypt (optional)\n  // autogenerate: {\n    // email: 'admin@test.de',\n    // comma separated list of domains\n    // domains: 'test.de,www.test.de'\n  // },\n// },\ndocker: {\n  // change to 'abernix/meteord:base' if your app is using Meteor 1.4 - 1.5\n  image: 'abernix/meteord:node-8.4.0-base',\n},\n\n// Show progress bar while uploading bundle to server\n// You might need to disable it on CI servers\nenableUploadProgressBar: true\n\n},\nmongo: {\n    version: '3.4.1',\n    servers: {\n      linode: {}\n    }\n  },\nproxy:{\n    domains: 'test.de,www.test.de',\n    ssl:{\n        letsEncryptEmail: 'admin@test.de',\n        forceSSL:true\n    }\n},\n\n```. ",
    "antoninadert": "I tried @derwaldgeist  's suggestion to change docker image but it didn't work. I would be happy to get the final relevant code of config. \nI cross referenced the issue from here: https://github.com/zodern/meteor-up/issues/899\nMy proxy is as follow:\n```\nproxy: {\n    domains: 'test.fi',\n    ssl: {\n      crt: '/etc/letsencrypt/live/test.fi/fullchain.pem',\n      key: '/etc/letsencrypt/live/test.fi/privkey.pem',\n      forceSSL: true\n    },\n    // Settings in \"proxy.shared\" will be applied to every app\n    // deployed on the servers using the reverse proxy.\n    // Everything is optional.\n    // After changing this object, run mup proxy reconfig-shared\n    shared: {\n      // The port number to listen to for http connections. Default 80.\n      httpPort: 80,\n      // The port to listen for https connections. Default is 443.\n      httpsPort: 443,\n      // Add an nginx config that is used proxy-wide.\n      // This config can add additional upstream and server blocks if needed.\n      nginxConfig: '/etc/nginx/sites-enabled/test.fi.conf',\n      // Environment variables for nginx proxy\n      env: {\n        DEFAULT_HOST: 'www.test.fi'\n      },\n  },\n```\nI may have done a very bad mistake, so I share the ENV part as well: \nenv: {\n      // TODO: Change to your app's url\n      // If you are using ssl, it needs to start with https://\n      ROOT_URL: 'https://www.test.fi',\n      MONGO_URL: 'mongodb://mongodb/meteor',\n      MONGO_OPLOG_URL: 'mongodb://mongodb/local',\n    },. I managed to make it work. My setup was messed up.\nEnded with this:\n ```\nmodule.exports = {\n  servers: {\n    one: {\n      // TODO: set host address, username, and authentication method\n      host: 'xxx.xx.xxx.xxx',\n      username: 'myusername',\n      pem: '~/.ssh/id_rsa'\n    }\n  },\napp: {\n    // TODO: change app name and path\n    name: 'test',\n    path: '../',\nservers: {\n  one: {},\n},\n\nbuildOptions: {\n  serverOnly: true,\n},\n\nenv: {\n  // TODO: Change to your app's url\n  // If you are using ssl, it needs to start with https://\n  ROOT_URL: 'https://test.fi',\n  MONGO_URL: 'mongodb://mongodb/meteor',\n  MONGO_OPLOG_URL: 'mongodb://mongodb/local',\n},\n\ndocker: {\n  // change to 'abernix/meteord:base' if your app is using Meteor 1.4 - 1.5\n  image: 'abernix/meteord:node-8.4.0-base',\n},\n\nmongo: {\n    version: '4.0.2',\n    servers: {\n      one: {}\n    }\n  },\n    proxy: {\n        // comma-separated list of domains your website\n        // will be accessed at.\n        // You will need to configure your DNS for each one.\n        domains: 'test.fi',\n        ssl: {\n            // TODO: disable if not using SSL\n            forceSSL: true,\n            // Enable let's encrypt to create free certificates\n            letsEncryptEmail: 'admin@test.fi',\n        },\n    },\n  // (Optional)\n  // Use the proxy to setup ssl or to route requests to the correct\n  // app when there are several apps\n// proxy: {\n  //   domains: 'mywebsite.com,www.mywebsite.com',\n//   ssl: {\n  //     // Enable Let's Encrypt\n  //     letsEncryptEmail: 'email@domain.com'\n  //   }\n  // }\n};\n``. Myproxy` is as follow:\n```\nproxy: {\n    domains: 'test.fi',\n    ssl: {\n      crt: '/etc/letsencrypt/live/test.fi/fullchain.pem',\n      key: '/etc/letsencrypt/live/test.fi/privkey.pem',\n      forceSSL: true\n    },\n    // Settings in \"proxy.shared\" will be applied to every app\n    // deployed on the servers using the reverse proxy.\n    // Everything is optional.\n    // After changing this object, run mup proxy reconfig-shared\n    shared: {\n      // The port number to listen to for http connections. Default 80.\n      httpPort: 80,\n      // The port to listen for https connections. Default is 443.\n      httpsPort: 443,\n      // Add an nginx config that is used proxy-wide.\n      // This config can add additional upstream and server blocks if needed.\n      nginxConfig: '/etc/nginx/sites-enabled/test.fi.conf',\n      // Environment variables for nginx proxy\n      env: {\n        DEFAULT_HOST: 'www.test.fi'\n      },\n  },\n```\nThe only thing I couldn't do from Sascha's list is: 4. Follow the certbot instructions but use the manual way (not nginx). So sudo certbot certonly.\nI did already generate my certificate with the nginx option (I didn't know). Should I redo it and select 2: Spin up a temporary webserver (standalone) instead? this will renew my certificate.\nI may have done a very bad mistake, so I share the ENV part as well: \nenv: {\n      // TODO: Change to your app's url\n      // If you are using ssl, it needs to start with https://\n      ROOT_URL: 'https://www.test.fi',\n      MONGO_URL: 'mongodb://mongodb/meteor',\n      MONGO_OPLOG_URL: 'mongodb://mongodb/local',\n    },\nI hope you can help me. I managed to make it work. My setup was messed up.\nEnded with this:\n ```\nmodule.exports = {\n  servers: {\n    one: {\n      // TODO: set host address, username, and authentication method\n      host: 'xxx.xx.xxx.xxx',\n      username: 'myusername',\n      pem: '~/.ssh/id_rsa'\n    }\n  },\napp: {\n    // TODO: change app name and path\n    name: 'test',\n    path: '../',\nservers: {\n  one: {},\n},\n\nbuildOptions: {\n  serverOnly: true,\n},\n\nenv: {\n  // TODO: Change to your app's url\n  // If you are using ssl, it needs to start with https://\n  ROOT_URL: 'https://test.fi',\n  MONGO_URL: 'mongodb://mongodb/meteor',\n  MONGO_OPLOG_URL: 'mongodb://mongodb/local',\n},\n\ndocker: {\n  // change to 'abernix/meteord:base' if your app is using Meteor 1.4 - 1.5\n  image: 'abernix/meteord:node-8.4.0-base',\n},\n\nmongo: {\n    version: '4.0.2',\n    servers: {\n      one: {}\n    }\n  },\n    proxy: {\n        // comma-separated list of domains your website\n        // will be accessed at.\n        // You will need to configure your DNS for each one.\n        domains: 'test.fi',\n        ssl: {\n            // TODO: disable if not using SSL\n            forceSSL: true,\n            // Enable let's encrypt to create free certificates\n            letsEncryptEmail: 'admin@test.fi',\n        },\n    },\n  // (Optional)\n  // Use the proxy to setup ssl or to route requests to the correct\n  // app when there are several apps\n// proxy: {\n  //   domains: 'mywebsite.com,www.mywebsite.com',\n//   ssl: {\n  //     // Enable Let's Encrypt\n  //     letsEncryptEmail: 'email@domain.com'\n  //   }\n  // }\n};\n```. ",
    "w0ps": "Thank you so much, it's working!. ",
    "edwarddistel": "the answer from @stefanve is correct, but for those not using this Docker image you can upgrade (or downgrade) to 8.9.1 on the command line:\nsudo npm install n -g\nsudo n 8.9.1. ",
    "mpowaga": "It seems like you are missing a PORT env variable. Try this:\nenv: {\n  PORT: '80'\n}. @MuyBien See what's the output of docker port [your app name] when you ssh into the server. It's likely that you don't have any port mappings. At least it was in my case.. ",
    "rafahoro": "Did you solve this? . Did you check http://meteor-up.com/docs.html#common-problems ?\nMay be the section Let\u2019s Encrypt is not working\n\nMake sure your meteor.env.ROOT_URL starts with https://. Also, check that the DNS for all of the domains in ssl.autogenerate.domains is correctly configured to point to the server. Port 80 needs to be open on the server so it can verify that you control the domain.\nYou can view the Let\u2019s Encrypt logs by running this command on the server:\ndocker logs -nginx-letsencrypt\nReplace  with the name of the app. Im having the same issue. I don't know if related with the changes I did in mup.js, trying to get 2 different instance on the same server (reverse proxy, ssl). \nBut having same problem, even when I roll back to previous mup.js. I even started a fresh instance on AWS, but no luck.. try deleting all the docker containers on your server:\nls /opt/ make sure there are only docker containers here, before deleting *\nsudo rm -rf /opt/*\nrestart your server\nthen from your client\nmup setup; mup deploy\nit helped me . No, but I deactivated the reverse proxy. \nThis is my working config:\n\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: 'prod.example.com',\n      username: 'ubuntu',\n      pem: '/example.pem'\n    }\n  },\nmeteor: {\n    name: 'prod',\n    path: '../..', // as we run it from .deploy/xxxx, relative path to app\nservers: {\n  one: {},\n},\n\nbuildOptions: {\n  serverOnly: true,\n  server: 'https://prod.example.com'\n},\n\nenv: {\n  ROOT_URL: 'https://prod.example.com',\n  MONGO_URL: 'mongodb://USER:PASS@XYZ.com:15740/example'\n},\n\nssl: { // (optional)\n  autogenerate: {\n    email: 'support@example.com.ar',\n    domains: 'prod.example.com'\n  }\n},\n\ndocker: {\n  // change to 'kadirahq/meteord' if your app is not using Meteor 1.4\n  image: 'abernix/meteord:base',\n},\ndeployCheckWaitTime: 60,\nenableUploadProgressBar: true\n\n},\n};\n```\nBut if I use reverse proxy, it doesn't work\nUpdate, I tried this same config in a fresh-new server and is not working :(\n. I think is the nginx and/or letsencript docker container that is not working.  And I think that is related to the version. Need to check.\nBTW: I tried again the config I posted a couple of hours ago in a fresh-new server and is not working :(. ",
    "jonmc12": "We are running into this issue as well.  Using Meteor 1.6.0, abernix/meteord:node-8.4.0-base, no ssl.  Our deploy is to an Azure VM - other docker containers work as expected in this same environment.\nWhen running docker run -dti --net=host <name>  we can curl0.0.0.0:80\nWhen running docker run -dti  -p 80:80 <name> we can not curl0.0.0.0:80\nLooking at ifconfig, the IP addresses for eth0 and docker0, can ping these, but not curl.  Seems the docker0 inet address is not mapped to 0.0.0.0.. fyi, using latest release of jrcs/letsencrypt-nginx-proxy-companion, we were successfully able to re-deploy, and access ports as expected.\nWell, technically its only working when ssl is enabled.  I think there also may be some issues in the way that start.sh is generated when not using ssl, but thats likely another issue.. ",
    "domparise": "I'm having the same problem. Might be related to the recent update to letsencrypt's ToS https://github.com/zodern/meteor-up/issues/802. both issues came up on the same day the ToS was updated. ",
    "MarceloPrado": "What is the database name that you expected to appear on mLab? perfilesgs?. ",
    "beriliox": "@MarceloPrado  yes. just like that\n\n. I solved it removing this part:\nmongo: {\n    version: '3.4.1',\n    servers: {\n      one: {}\n    }\n  }. ",
    "theshook": "@beriliox it is working fine? having the same trouble, thank you!. @zodern thanks! having another issue I don't know how to add SSL certificate on my server. ",
    "carlosqueiroz": "Worked perfectly!\nThank you very much!\n. ",
    "erwzqsdsdsf": "no probelm.\nthis is beacuse chinese great fire wall block meteor pack server. I used local node npm commnad.\n. ",
    "Asgarv": "Facing this issue myself. The problem is TOS hash mismatch. Let's encrypt ToS changed today (https://letsencrypt.org/documents/2017.11.15-LE-SA-v1.2.pdf) which changed the hash.\nIt seems like we depend on simp_le which uses a hardcoded hash. The hash has now been updated and will be fetched from API in the future: https://github.com/zenhack/simp_le/commit/adec4b99366fd9a67b2650ec64197e2a13bc12b3\nStill not sure myself how to proceed from here.. ",
    "bvanderdrift": "Right, https://github.com/JrCs/docker-letsencrypt-nginx-proxy-companion/pull/282 is open and we should wait for it.\nMight you want to fix it right now, you should make some manual changes in the code that mup uploads.\nFirst: run on your own machine\nmup deploy\nthen ssh into your server, and edit the file /opt/<AppName>/config/start.sh\nReplace the line:\nsudo docker pull jrcs/letsencrypt-nginx-proxy-companion:$LETS_ENCRYPT_VERSION\nwith:\ngit clone --branch tos-fix https://github.com/buchdag/docker-letsencrypt-nginx-proxy-companion.git\nsudo cd docker-letsencrypt-nginx-proxy-companion\ndocker build -t jrcs/letsencrypt-nginx-proxy-companion:latest ..\ncd ..\nthen exit the ssh session and run\nmup start and NOT the mup deploy command. Running deploy will reset the start script.\nThanks to @buchdach for fixing the issue. Let's hope the PR gets accepted soon.. @buchdag ooh you're right. It's latest but using the var is better. In the context of the script though the image should be stored in the parent folder, since that's where the start.sh script expects it. . I found the command mup logs proxy which returned the following output:\nbash\n...\n[new.domain.com];1mnginx.1    | ;1m2018/09/10 10:03:48 [emerg] 30#30: unknown directive \"server_name:\" in /etc/nginx/conf.d/my_proxy.conf:2\n[new.domain.com];1mnginx.1    | ;1mnginx: [emerg] unknown directive \"server_name:\" in /etc/nginx/conf.d/my_proxy.conf:2\n[new.domain.com];1mforego     | starting nginx.1 on port 5200\n[new.domain.com];1mforego     | sending SIGTERM to nginx.1\n...\nThis made me realize I had put a \":\" in the new Nginx config, which made it an unknown directive.\nIf I remember correctly after starting meteor, the mup deploy command does a \"Verifying Deployment\" step, and if that fails it prints the logs of the docker container. This might be a nice idea to do as well for the reverse proxy since that would have given me the right feedback directly.. ",
    "buchdag": "@bvanderdrift I don't know if the expected value of LETS_ENCRYPT_VERSION in your script is latest or not, so you might want to do\ndocker build -t jrcs/letsencrypt-nginx-proxy-companion:$LETS_ENCRYPT_VERSION .\ninstead.\nAlso be careful, the build command should end with only one . (ie build in the current working dir), not two.. The trailing . don't tell docker where to build to but where to build from, ie where to expect a Dockerfile and where the build context root will be if no further arguments are passed.\nNeither docker build nor docker pull put images in the current working directory, they both go to the same Docker Root Dir (/var/lib/docker by default) , under the image subfolder.. ",
    "lucalanzano81": "+1. ",
    "sayantan-das-bchu": "+1. ",
    "rkstar": "i'm having this same problem with mup 1.3.7 and i ran the above to get this:\n```\n:~# sudo docker run -ti --entrypoint=/bin/ls a1b2c3d4e5f6g7 /built_app/programs/server/npm/node_modules/meteor/epaminond_nodemailer/node_modules/nodemailer/node_modules/libmime/src/\n/bin/ls: cannot access /built_app/programs/server/npm/node_modules/meteor/epaminond_nodemailer/node_modules/nodemailer/node_modules/libmime/src/: No such file or directory\n```. ",
    "LarsBuur": "@BenjaminMerlynS: I have just deployed a server with reverse proxy and letsencrypt ssl and our iOS app is still working. \nI have both ROOT_URL and HOST set in env:{ROOT_URL:'https://domain.com', HOST:'domain.com'}. ",
    "delay": "I was having this same trouble with meteor 1.6. Changing the docker image in mup.js to  abernix/meteord:node-8-base worked for me.  Thanks @xpressabhi !. ",
    "AstonBraham": "So what was the fix please ?\nI'm on linux but i'm facing that same issue. Same here.. I really wonder why.\nMy app is based on Meteor 1.6. ",
    "lauff": "I solved it by adding one line (marked with a comment) to command-handlers.js\n(the below code below exists twice (for start and restart)\njavascript\n  list.executeScript('Verifying Deployment', {\n    script: api.resolvePath(__dirname, 'assets/meteor-deploy-check.sh'),\n    vars: {\n      deployCheckWaitTime: config.deployCheckWaitTime || 60,\n      appName: config.name,\n      deployCheckPort: config.deployCheckPort || config.env.PORT || 80,\n      deployCheckPath: '',\n      host: api.getConfig().proxy ? api.getConfig().proxy.domains.split(',')[0] : null,\n      bind: api.getConfig().app.docker.bind ? api.getConfig().app.docker.bind : 'localhost' // consider bind address for deployment check\n    }\n  });\nand also changing the DEPLOY_CHECK_URL in mup\\lib\\plugins\\meteor\\assets\\meteor-deploy-check.sh to \njavascript\nDEPLOY_CHECK_URL=<%= `${bind}:${deployCheckPort}${deployCheckPath}` %>\n(files are attached)\nchanged files.zip\n. submitted pull request https://github.com/zodern/meteor-up/pull/812. ",
    "jeroenhoebe": "I also got the same problem even when I upgraded it to 1GB RAM. But then I read the log again and I noticed the problem lies with bcrypt. Uninstalled bcrypt and then it worked. So now I only get the warning from meteor saying that 'Note: you are using a pure-JavaScript implementation of bcrypt. ...'. Probably need to look furthermore in to this.. ",
    "nloui": "Fwiw - I was able to get it working by using mup 1.3.5, but hopefully there's a better forward moving fix!. ",
    "mikkelking": "Same problem, I also discovered that the trailing slash on the path is necessary, eg\nmeteor: {\n    name: 'admin',\n    path: '../../app/',\nReverting to 1.3.5 does fix it. I am working with Meteor 1.6. Spent a lot of time today messing with this. If you are not happy with the PR, I can look further into possibly porting the beta checking code into the update-notifier module, or providing a command line option to disable the check, or doing a spawn of the check like update-notifier does, or passing through the http_proxy environment variable to silent-npm-registry-client.\nPlease let me know what you think. It is probably ok now, if you are on Meteor 1.3+ as it no longer automatically loads files.\nYou should have your mup files outside your meteor structure. It's usual for your repo to have an app directory, which is where the meteor project goes. And you create a deployment folder which is where you put the mup file and the settings file\n. ",
    "bogdanrn": "same error. going back to 1.3.5 fixed it for me as well. i get the same error with: Failed to connect to 172.17.0.13 port 3009. logging in to my machine and doing curl 172.17.0.13 returns the correct output, even if the app is set to run on port 3009 (in my case), the docker network interface works on port 80 it seems. I found a fix for this problem. By default, the docker image works on port 80 (as i found here). My app was configured to run on port 3009.\nThe new verify deployment function takes the network interface directly from docker. Docker was accessible at local_ip:80. The verify function instead of checking local_ip:image_port, checks for local_ip:meteor_port. You can use this temp fix to get your builds going. Even after the patch, I don't think it will matter if you leave it like this in your config. \nmodule.exports = {\n  ....\n  \"meteor\": {\n     ....\n    \"docker\": {\n      \"imagePort\": 3009\n    },\n    \"env\": {\n      \"PORT\": \"3009\",\n       ....\n     }\n    ....\n   }\n}\nP.S. the docs are not correct, it says to use meteor.docker.port but instead, we have to use meteor.docker.imagePort \n. ",
    "fschaeffler": "@elie222 got the same feeling too :/. @stefanve I agree that there can get a million things wrong. However, this issue described here isn't some kind of edge case, but the most import use case (a deployment). That makes it a perfect candidate for an automated test case, which runs before a version deployment.. ",
    "hanimay": "@zodern version 1.3.7 beta 0 works for me. Thanks for the quick fix :smiley: . I'm not using an external database, I simply want to rename the database.\nthat's the format I have, so I wrote the database name wrongly the first time and now I'm stuck can't rename it, so I had to and rename the database inside of mongo to suit the name I wrote first in the config file.\n  app: {\n .....\n    env: {\n      ROOT_URL: 'https://aaa.com/',\n      MONGO_URL: 'mongodb://localhost/DATABASE_NAME'\n    },\n...... ",
    "rooch84": "@zodern.  I have the same issue with 1.3.6, but only on Ubuntu 16.04 server running inside Docker.  It works fine on OSX.  \nI can also confirm that 1.3.7 fixes the issue and works fine on Ubuntu.  Do you still want a verbose output?. ",
    "kai-iak": "Experiencing the same issue.\nIn my case, I ended up upgrading to the latest version of mup as I was getting a failure to 'Verify Deployment'.  I also changed the image to the latest for 1.4 in mup.js.\nNow I'm stuck.. @brylie @elie222 Can either of you explain how I can access the logs found in the error output i.e. \n```\n     npm ERR! This is probably not a problem with npm. There is likely additional logging output above.\n    npm ERR! A complete log of this run can be found in:\n    npm ERR!     /root/.npm/_logs/2017-12-06T05_53_00_036Z-debug.log\n\n```. ",
    "jared201": "anyone got a real solution to this issue?. ",
    "skoontastic": "I should add that my development server is a VirtualBox machine with one core and 2GB RAM, and doesn't use the proxy or SSL. It's running like a champ.\nMy production server is on HyperV with two cores and 2GB RAM (expandable to 5GB if necessary), and does run the proxy and SSL.. I'm closing this. It appears that I just didn't optimize one of my collections properly.. ",
    "jgoley": "@elie222 Did you figure out the cause of this issue? I'm experiencing it too.. ",
    "micktaiwan": "@thebarty unfortunately I still don't know how to create docker images based on an existing one to be reused in my apps. I guess I'll have to read more on Docker, but @ddaydd answer solved my most urgent problems, so that will be for later.... . ",
    "jasongrishkoff": "I can also confirm that the \"prepare bundle\" stage takes quite a while -- roughly 10 minutes.. ",
    "ferdiemcdaniel": "I am also experiencing this. . ",
    "archi0309": "try to change default bash for demouser in deploy server side.\n$ sudo chsh -s /bin/bash demouser. ",
    "devarthurribeiro": "+1. This bug caused by bcrypt. @fhackenb post your mup.js file. I'm with the same error!\n. ",
    "jwjordan": "I can confirm that simply running \"mup proxy reconfig-shared\" also fixed this problem for me.  Thanks for sharing!. I'm stuck on this as well, but I can tell you that using LetsEncrypt for a wildcard domain is no easy feat.  It requires a DNS-challenge based authentication of the domain, so I can't see that coming in mup anytime soon.  However, if you generate your own wildcard certs using LetsEncrypt, I would think mup could support them.  It doesn't appear that is true for wildcard domains, or at least it's only partially true.  The wildcard certs themselves do appear to work, yet mup will not let you set \"*.example.com\" as your domain name in the nginx proxy.  If it could, then I think using your own wildcard certs would \"just work\" with a mup deploy.. ",
    "john-guerra": "Just faced this same error when trying to add SSL support to an already running application. Running mup proxy reconfig-shared didn't help. I managed to fix the error by running \nmup reconfig\nLeaving this here just in case finds this same issue. ",
    "domramirez": "Thanks, @john-guerra! All the documentation I saw (especially Meteor Up SSL Docs) seemed to want me to run mup setup AND THEN mup reconfig. I guess running those in reverse order shook things loose.. ",
    "zapkto": "Do sudo visudo and replace \n%sudo   ALL=(ALL:ALL) ALL\nBy\n%sudo   ALL=(ALL:ALL) NOPASSWD:ALL\n  . ",
    "Sojourneer": "I have a problem also with mup now failing on prepare at bcrypt@1.0.3 install.\nI used \"find\" on the target system to find the log file, which was in directory\n  /var/lib/dockers/aufs/diff//root/.npm/_logs\nbut the log contained no detail info about why it failed.\n. ",
    "bouchepat": "Same problem here.. This seems to be fixed now.. ",
    "traugdor": "js\n    \"name\": \"bcrypt\",\n    \"optionalDependencies\": {},\n    \"readme\": \"ERROR: No README data found!\",\n    \"repository\": {\n      \"type\": \"git\",\n      \"url\": \"git+https://github.com/kelektiv/node.bcrypt.js.git\"\n    },\n    \"scripts\": {\n      \"install\": \"node-pre-gyp install --fallback-to-build\",\n      \"test\": \"npm install --build-from-source && nodeunit test\"\n    },\n    \"version\": \"1.0.3\"\nCopied and pasted directly from the package.json file under bcrypt. ",
    "jehartzog": "This is a Meteor configuration issue, although you do set the env variables inside the MUP config.\nSet the HTTP_FORWARDED_COUNT env variable to the number of proxies you have in front of your Meteor app. If you are using MUP with reverse proxy, this is probably 1. If you are also using CloudFlare as a CDN/Proxy, then it's probably 2.\n@zodern This would probably be a good thing to add to documentation, especially with the recent changes making the reverse proxy the default setting. I'd be happy to do a PR if you want it :D. I'm loving the work you're doing with MUP btw, keep it up!\n. ",
    "lesliedoghouse": "Hi, after remove bcrypt, I get the following error. My deployCheckWaitTime is 180. Please advice, thanks in advance.\n```\nx Verifying Deployment: FAILED\n    -----------------------------------STDERR-----------------------------------\n    js:416:10)\n        at Module.load (module.js:343:32)\n        at Function.Module._load (module.js:300:12)\n        at Module.require (module.js:353:17)\n        at require (internal/module.js:12:17)\n        at Object.<anonymous> (/built_app/main.js:4:1)\n        at Module._compile (module.js:409:26)\n        at Object.Module._extensions..js (module.js:416:10)\n    => Starting meteor app on port:80\n    /built_app/programs/server/boot.js:50\n        const { pause } = require(\"./debug.js\");\n              ^\n\n\n    SyntaxError: Unexpected token {\n        at exports.runInThisContext (vm.js:53:16)\n        at Module._compile (module.js:373:25)\n        at Object.Module._extensions..js (module.js:416:10)\n        at Module.load (module.js:343:32)\n        at Function.Module._load (module.js:300:12)\n        at Module.require (module.js:353:17)\n        at require (internal/module.js:12:17)\n        at Object.<anonymous> (/built_app/main.js:4:1)\n        at Module._compile (module.js:409:26)\n        at Object.Module._extensions..js (module.js:416:10)\n\n    => Redeploying previous version of the app\n\n```. Hi, I tried change deployCheckWaitTime to 250, the result/error is the same.. Thanks so much, my Meteor version is 1.6. I change to abernix/meteord:node-8.9.3-base\nIt deploy success now.. ",
    "MWPAWAR": "+1. ",
    "shankscoder": "So, I managed to get this resolved, but I had to move away from MUP and use PM2-Meteor (https://www.npmjs.com/package/pm2-meteor) to get this to work.\nI suspect the issue had to do with my Oplog setup (I rebuilt the user and got this working as well), but I was able to get it to work with PM2. An interesting secondary issue was that the Mongo connections started working when I moved my external DB reference from its IP to a DNS FQDN. I have no idea if that's what fixed it, but I was able to authenticate and connect to the DB the moment after I changed to a FQDN.\nI'll check again on another installer and see if the issue is with the Oplog setup or not.\nI'll close this for now, and re-open if it replicates on a fresh application as well.\n  . ",
    "Arsey": "I have the same issue. MUP just ignores MONGO_URL. When I enter a running container via docker exec -it container-name /bin/bash  end run echo $MONGO_URL, it prints mongodb://mongodb:27017/dbname. Ok, so for me the issue solved by removing mongo section from the mup.js that goes from the documentation's example:\nmodule.exports = {\n   mongo: {\n     version: '3.4.1',\n     servers: {\n       one: {}\n     }\n   }\n}. ",
    "charlot567": "Same! . ",
    "n00bvn": "Finally found the solution. It because of the plugin lookback:seo that I added. Removing it fixed the problem.. ",
    "mewhit": "I have the same issue. I restart docker , and its work but it is not long term fix.. Your right @stefanve, it probably docker problem.. ",
    "xenoterracide": "just had this, I think the problem was that the system/service didn't restart after updates on CentOS 7 using the official docker repo -ce rpm (not the centos docker rpm). note: realizing that this isn't a docker bug, and I'm not using meteor, but maybe this helps anyways, if people are auto updating.. ",
    "crenardy": "If changing the path for all default docker volumes is an option, you can change the docker config:\nFor Ubuntu/Debian: https://linuxconfig.org/how-to-move-docker-s-default-var-lib-docker-to-another-directory-on-ubuntu-debian-linux\nAnother solution might be setting up your own mongodb server (e.g. as a docker image with external volume) and specifying a mongodb in the bottom part of the config file.. ",
    "boxxa": "Sorry for the delay in getting back to you. I was thinking if you can specify what path to use for htethe docker containers on the server. If you have an app that has a larger Mongo instance, it would be helpful to put this container on a separate location than the default system drive of most VPS servers.. Been dealing with the same issue. I have Mongo installed directly on a server and using the docker instance for the Meteor deployment. The localhost in MONGO_URL is resolving to the docker container and not the host for me. I found this article and trying to troubleshoot as well.\nhttps://stackoverflow.com/questions/24319662/from-inside-of-a-docker-container-how-do-i-connect-to-the-localhost-of-the-mach\nI took a few shots at adding some custom flags and all failed with the same error.\nUsing networks options\ndocker: {\n      networks: [\n      'host'\n      ]\n    },\nUsing pre docker 18 method\ndocker: {\n    args: [\n      '--net=host'\n    ],\n  },\nUsing method for Docker 18+\ndocker: {\n    args: [\n      '--network host'\n    ],\n  },\n. ",
    "CSMR-DB": "Issue has been resolved. It turns out it had to do with adjustments I had previously made in the apollo-client config. They never resulted in any errors during development, just in production. Basically:\n```\nimport ApolloClient from 'apollo-client';\nimport { meteorClientConfig } from 'meteor/apollo';\nconst client = new ApolloClient(meteorClientConfig());\n```\nWas enough for localhost development, but not for deployment. Instead:\n```\nimport ApolloClient from 'apollo-client'\nimport { createMeteorNetworkInterface, meteorClientConfig } from 'meteor/apollo';\nconst networkInterface = createMeteorNetworkInterface({\n    batchingInterface: true,\n});\nconst client = new ApolloClient({\n    link: new HttpLink(),\n    cache: new InMemoryCache().restore({}),\n}, meteorClientConfig({ networkInterface }));\n```\nI will hereby close this issue :). ",
    "resmith": "Same issue when using MUP with Meteor 1.6.\nI used image: 'abernix/meteord:node-8-base'.\nmup setup worked perfectly.\nmup deploy fails on the following:\nStarted TaskList: Start Meteor\n[198.58.102.81] - Start Meteor\n[198.58.102.81] - Start Meteor: SUCCESS\n[198.58.102.81] - Verifying Deployment\n[198.58.102.81] x Verifying Deployment: FAILED\n-----------------------------------STDERR-----------------------------------\njs:416:10)\n    at Module.load (module.js:343:32)\n    at Function.Module._load (module.js:300:12)\n    at Module.require (module.js:353:17)\n    at require (internal/module.js:12:17)\n    at Object.<anonymous> (/built_app/main.js:4:1)\n    at Module._compile (module.js:409:26)\n    at Object.Module._extensions..js (module.js:416:10)\n=> Starting meteor app on port:80\n/built_app/programs/server/boot.js:50\n    const { pause } = require(\"./debug.js\");\n          ^\n\nSyntaxError: Unexpected token {\n    at exports.runInThisContext (vm.js:53:16)\n    at Module._compile (module.js:373:25)\n    at Object.Module._extensions..js (module.js:416:10)\n\n. ",
    "yannickneemaa": "I finally made it working.\nIf other people want to check it, here is my configuration :\n- Meteor : 1.6.0.1\n- MUP : 1.3.5\n- image: 'abernix/meteord:node-8-base'\n\nI deleted my node_modules folder and made a new npm install\nI deleted all the docker images on my server and made a new mup setup\n. \n",
    "bp12345": "See answer here https://github.com/MeteorToys/meteor-devtools/issues/106#issuecomment-361756170 .\nYou have have to change the debug settings to false. debug: false. Yes, I'd be interested in checking it out. Thanks. . Thanks for this. The problem turned out to be with my initial setup of the server. All good now. Thanks for the help. Ok, I think I've narrowed down the problem and solution. I believe this is a common problem, as I've found a similar question with no answers. It might be worth adding this to 'common problems'.\nI'm using Cloudflare and I have rules attached to my DNS to push all traffic to www.  The crypto SSL section appears to be where the problem is occurring. It was set to flexible. This appears to be causing my connection to bounce between http and https. \nThe solution that worked was to change the crypto SSL section in Cloudflare to Full. \nI also cleared the DNS Cache on my Mac but I don't think this had anything to do with the solution. \nFlush mac DNS cache.\n. ",
    "chamithkanchana": "same issue here :(. Have you fixed that issue?. ",
    "vinaynb": "In my case issue was with my VPS provider (i.e Digital Ocean). Due to some reason they had blocked traffic on SMTP port 465 and hence emails were failing. Once the block was removed it was all good. Before doubting mup or anything else i would recommend testing if you have the required ports open on your server.\nHope this helps !. ",
    "dev5-CloudNine": "Okay, I've added the httpsPort in proxy.shared and pointed it to port 3001. And when I mup reconfig proxy-shared, I get the following error:\nStarted TaskList: Configuring Proxy's Shared Settings\n[192.168.2.191] - Sending shared variables\n[192.168.2.191] - Sending shared variables: SUCCESS\n[192.168.2.191] - Sending proxy environment variables\n[192.168.2.191] - Sending proxy environment variables: SUCCESS\n[192.168.2.191] - Sending let's encrypt environment variables\n[192.168.2.191] - Sending let's encrypt environment variables: SUCCESS\nStarted TaskList: Start proxy\n[192.168.2.191] - Start proxy\n[192.168.2.191] x Start proxy: FAILED\n-----------------------------------STDERR-----------------------------------\nError response from daemon: endpoint mup-nginx-proxy not found\nError: No such container: mup-nginx-proxy-letsencrypt\nError response from daemon: endpoint mup-nginx-proxy-nginx-proxy not found\ndocker: Error response from daemon: driver failed programming external connectivity on endpoint mup-nginx-proxy (d951dd1748af2e687b4fb1e28b8b0de07832e9a24f6bfc6093a4518932373b5a): Error starting userland proxy: listen tcp 0.0.0.0:80: bind: address already in use.\n-----------------------------------STDOUT-----------------------------------\nmup-nginx-proxy\nRemoved mup-nginx-proxy\nRemoved mup-nginx-proxy-letsencrypt\nlatest: Pulling from jrcs/letsencrypt-nginx-proxy-companion\nDigest: sha256:68adf23860109597c0dc2f5302f05e7f42342bf586a1a439af0dcf632223e5a8\nStatus: Image is up to date for jrcs/letsencrypt-nginx-proxy-companion:latest\nUsing default tag: latest\nlatest: Pulling from jwilder/nginx-proxy\nDigest: sha256:41506b2095779e6e64f34e26ccba35cb3668ee56a735cd740ac8c183af583294\nStatus: Image is up to date for jwilder/nginx-proxy:latest\nPulled jwilder/nginx-proxy and jrcs/letsencrypt-nginx-proxy-companion\nb98d3e07785a8ed04d96499152dacd0e727da31e6bbc0210f4a32a6f492bb69c\n----------------------------------------------------------------------------\n\nDo I have to configure nginx to setup SSL? Point me what I'm doing wrong.. ",
    "brmk": "switched back to mup@1.3.5 and now it works :). ",
    "tsangwailam": "I also got this error in 1.4.0. Is it a bug?. ",
    "jkbaseer": "Hello @zodern  I have been trying to fix this as well for last two days.. I just updated the mup to latest version 1.4.3 to see if that helps, it doesn't seems to be. \nThis is my error:\n`Started TaskList: Start Meteor\n[159.65.10.244] - Start Meteor\n[159.65.10.244] - Start Meteor: SUCCESS\n[159.65.10.244] - Verifying Deployment\n[159.65.10.244] x Verifying Deployment: FAILED\n      ------------------------------------STDERR------------------------------------\n      pload   Total   Spent    Left  Speed\n\n0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.3 port 80: Connection refused\n    Too much time spent restarting.\n        at require (internal/module.js:12:17)\n        at Object. (/built_app/main.js:4:1)\n        at Module._compile (module.js:409:26)\n        at Object.Module._extensions..js (module.js:416:10)\n    => Starting meteor app on port:80\n    /built_app/programs/server/boot.js:49\n        const { pause } = require(\"./debug.js\");\n              ^\nSyntaxError: Unexpected token {\n    at exports.runInThisContext (vm.js:53:16)\n    at Module._compile (module.js:373:25)\n    at Object.Module._extensions..js (module.js:416:10)\n    at Module.load (module.js:343:32)\n    at Function.Module._load (module.js:300:12)\n    at Module.require (module.js:353:17)\n    at require (internal/module.js:12:17)\n    at Object.<anonymous> (/built_app/main.js:4:1)\n    at Module._compile (module.js:409:26)\n    at Object.Module._extensions..js (module.js:416:10)\n=> Starting meteor app on port:80\n/built_app/programs/server/boot.js:49\n    const { pause } = require(\"./debug.js\");\n          ^\n\nSyntaxError: Unexpected token {\n    at exports.runInThisContext (vm.js:53:16)\n    at Module._compile (module.js:373:25)\n    at Object.Module._extensions..js (module.js:416:10)\n    at Module.load (module.js:343:32)\n    at Function.Module._load (module.js:300:12)\n    at Module.require (module.js:353:17)\n    at require (internal/module.js:12:17)\n    at Object.<anonymous> (/built_app/main.js:4:1)\n    at Module._compile (module.js:409:26)\n    at Object.Module._extensions..js (module.js:416:10)\n=> Starting meteor app on port:80\n/built_app/programs/server/boot.js:49\n    const { pause } = require(\"./debug.js\");\n          ^\n\nSyntaxError: Unexpected token {\n    at exports.runInThisContext (vm.js:53:16)\n    at Module._compile (module.js:373:25)\n    at Object.Module._extensions..js (module.js:416:10)\n    at Module.load (module.js:343:32)\n    at Function.Module._load (module.js:300:12)\n    at Module.require (module.js:353:17)\n    at require (internal/module.js:12:17)\n    at Object.<anonymous> (/built_app/main.js:4:1)\n    at Module._compile (module.js:409:26)\n    at Object.Module._extensions..js (module.js:416:10)\n=> Starting meteor app on port:80\n/built_app/programs/server/boot.js:49\n    const { pause } = require(\"./debug.js\");\n          ^\n\nSyntaxError: Unexpected token {\n    at exports.runInThisContext (vm.js:53:16)\n    at Module._compile (module.js:373:25)\n    at Object.Module._extensions..js (module.js:416:10)\n    at Module.load (module.js:343:32)\n    at Function.Module._load (module.js:300:12)\n    at Module.require (module.js:353:17)\n    at require (internal/module.js:12:17)\n    at Object.<anonymous> (/built_app/main.js:4:1)\n    at Module._compile (module.js:409:26)\n    at Object.Module._extensions..js (module.js:416:10)\n=> Starting meteor app on port:80\n/built_app/programs/server/boot.js:49\n    const { pause } = require(\"./debug.js\");\n          ^\n\nSyntaxError: Unexpected token {\n    at exports.runInThisContext (vm.js:53:16)\n    at Module._compile (module.js:373:25)\n    at Object.Module._extensions..js (module.js:416:10)\n    at Module.load (module.js:343:32)\n    at Function.Module._load (module.js:300:12)\n    at Module.require (module.js:353:17)\n    at require (internal/module.js:12:17)\n    at Object.<anonymous> (/built_app/main.js:4:1)\n    at Module._compile (module.js:409:26)\n    at Object.Module._extensions..js (module.js:416:10)\n=> Starting meteor app on port:80\n/built_app/programs/server/boot.js:49\n    const { pause } = require(\"./debug.js\");\n          ^\n\nSyntaxError: Unexpected token {\n    at exports.runInThisContext (vm.js:53:16)\n    at Module._compile (module.js:373:25)\n    at Object.Module._extensions..js (module.js:416:10)\n    at Module.load (module.js:343:32)\n    at Function.Module._load (module.js:300:12)\n    at Module.require (module.js:353:17)\n    at require (internal/module.js:12:17)\n    at Object.<anonymous> (/built_app/main.js:4:1)\n    at Module._compile (module.js:409:26)\n    at Object.Module._extensions..js (module.js:416:10)\n\n=> Redeploying previous version of the app\n\n\n      ------------------------------------STDOUT------------------------------------\n      Container has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\n=> Container status:\nrestarted: 8 times {\"Bridge\":\"\",\"SandboxID\":\"4bd8e33a64cf9c24b17193dc9b5bcd0c788f544c102485b8b5dba78b12548577\",\"HairpinMode\":false,\"LinkLocalIPv6Address\":\"\",\"LinkLocalIPv6PrefixLen\":0,\"Ports\":{},\"SandboxKey\":\"/var/run/docker/netns/4bd8e33a64cf\",\"SecondaryIPAddresses\":null,\"SecondaryIPv6Addresses\":null,\"EndpointID\":\"\",\"Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"MacAddress\":\"\",\"Networks\":{\"bridge\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"54c89fcd9774e51a5a710917e97e7ce0fff6bf408ce9ead4ed51ee134871e86f\",\"EndpointID\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"\",\"DriverOpts\":null}}} {\"Status\":\"restarting\",\"Running\":true,\"Paused\":false,\"Restarting\":true,\"OOMKilled\":false,\"Dead\":false,\"Pid\":0,\"ExitCode\":1,\"Error\":\"\",\"StartedAt\":\"2018-03-12T12:28:07.851607827Z\",\"FinishedAt\":\"2018-03-12T12:28:08.120883989Z\"}\n=> Logs:\n\nTo see more logs type 'mup logs --tail=200'`\n\nmy mup config code as well, FYI: am using on digitalocean\n` module.exports = {\n  servers: {\n    one: {\n      // TODO: set host address, username, and authentication method\n      host: '1.1.1.1',\n      username: 'root',\n      // pem: './path/to/pem'\n      password: '#####'\n      // or neither for authenticate from ssh-agent\n    }\n  },\napp: {\n    // TODO: change app name and path\n    name: 'ideasforsocial',\n    path: '/ifs',\n    servers: {\n      one: {},\n    },\nbuildOptions: {\n  serverOnly: true,\n},\n\nenv: {\n  // TODO: Change to your app's url\n  // If you are using ssl, it needs to start with https://\n  ROOT_URL: 'http://1.1.1.1',\n  MONGO_URL: 'mongodb://localhost/meteor',\n  MONGO_OPLOG_URL: 'mongodb://mongodb/local',\n},\n\ndocker: {\n  // change to 'abernix/meteord:base' if your app is using Meteor 1.4 - 1.5\n  image: 'abernix/meteord:base',\n},\n\n// Show progress bar while uploading bundle to server\n// You might need to disable it on CI servers\nenableUploadProgressBar: true,\ndeployCheckWaitTime: 150\n\n},\nmongo: {\n    version: '3.4.1',\n    port: 27017,\n    servers: {\n      one: {},\n    },\n  },\n// (Optional)\n  // Use the proxy to setup ssl or to route requests to the correct\n  // app when there are several apps\n// proxy: {\n  //   domains: 'mywebsite.com,www.mywebsite.com',\n//   ssl: {\n  //     // Enable Let's Encrypt\n  //     letsEncryptEmail: 'email@domain.com'\n  //   }\n  // }\n};\n`\nAppreciate your help on this. . sorry for not getting back on this.\nI tried your suggestions\nSuggestion 1: Change the version of container\n1. I went to the link you shared and my meteor version is 1.6.1 and so my previous mup configuration was \n  docker: {\n            image: 'abernix/meteord:base',\n        },\nIt had the same issue and so i tried to change it to \ndocker: {\n            // change to 'abernix/meteord:base' if your app is using Meteor 1.4 - 1.5\n            image: 'abernix/meteord:node-8.4.0-base',\n                },\nHad the same issue ( I have put the -verboose on the end)\nI was running the test from the mongodb on the /local server instead of standalone MongoDB on atlas, which works fine. So this problem only comes when i want to direct it to an external database. \n`[159.65.137.129] x Verifying Deployment: FAILED\n      ------------------------------------STDERR------------------------------------\n      /programs/server/node_modules/fibers/future.js:313\n                        throw(ex);\n                        ^\nMongoError: connection 4 to ideasforsocial-shard-00-00-lwgwb.mongodb.net:27017 closed\n    at Function.MongoError.create (/built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/error.js:29:11)\n    at Socket.<anonymous> (/built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/connection.js:214:22)\n    at Object.onceWrapper (events.js:316:30)\n    at emitOne (events.js:115:13)\n    at Socket.emit (events.js:210:7)\n    at TCP._handle.close [as _onclose] (net.js:545:12)\n=> Starting meteor app on port:80\n\n/built_app/programs/server/node_modules/fibers/future.js:313\n                        throw(ex);\n                        ^\nMongoError: connection 4 to ideasforsocial-shard-00-02-lwgwb.mongodb.net:27017 closed\n    at Function.MongoError.create (/built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/error.js:29:11)\n    at Socket.<anonymous> (/built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/connection.js:214:22)\n    at Object.onceWrapper (events.js:316:30)\n    at emitOne (events.js:115:13)\n    at Socket.emit (events.js:210:7)\n    at TCP._handle.close [as _onclose] (net.js:545:12)\n=> Starting meteor app on port:80\n\n/built_app/programs/server/node_modules/fibers/future.js:313\n                        throw(ex);\n                        ^\nMongoError: connection 5 to ideasforsocial-shard-00-01-lwgwb.mongodb.net:27017 closed\n    at Function.MongoError.create (/built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/error.js:29:11)\n    at Socket.<anonymous> (/built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/connection.js:214:22)\n    at Object.onceWrapper (events.js:316:30)\n    at emitOne (events.js:115:13)\n    at Socket.emit (events.js:210:7)\n    at TCP._handle.close [as _onclose] (net.js:545:12)\n=> Starting meteor app on port:80\n\n/built_app/programs/server/node_modules/fibers/future.js:313\n                        throw(ex);\n                        ^\nError: read ECONNRESET\n    at _errnoException (util.js:1041:11)\n    at TCP.onread (net.js:606:25)\n=> Starting meteor app on port:80\n\n/built_app/programs/server/node_modules/fibers/future.js:313\n                        throw(ex);\n                        ^\nMongoError: connection 3 to ideasforsocial-shard-00-00-lwgwb.mongodb.net:27017 closed\n    at Function.MongoError.create (/built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/error.js:29:11)\n    at Socket.<anonymous> (/built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/connection.js:214:22)\n    at Object.onceWrapper (events.js:316:30)\n    at emitOne (events.js:115:13)\n    at Socket.emit (events.js:210:7)\n    at TCP._handle.close [as _onclose] (net.js:545:12)\n=> Starting meteor app on port:80\n\n/built_app/programs/server/node_modules/fibers/future.js:313\n                        throw(ex);\n                        ^\nMongoError: connection 4 to ideasforsocial-shard-00-02-lwgwb.mongodb.net:27017 closed\n    at Function.MongoError.create (/built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/error.js:29:11)\n    at Socket.<anonymous> (/built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/connection.js:214:22)\n    at Object.onceWrapper (events.js:316:30)\n    at emitOne (events.js:115:13)\n    at Socket.emit (events.js:210:7)\n    at TCP._handle.close [as _onclose] (net.js:545:12)\n=> Starting meteor app on port:80\n\n/built_app/programs/server/node_modules/fibers/future.js:313\n                        throw(ex);\n                        ^\nMongoError: connection 3 to ideasforsocial-shard-00-00-lwgwb.mongodb.net:27017 closed\n    at Function.MongoError.create (/built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/error.js:29:11)\n    at Socket.<anonymous> (/built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/connection.js:214:22)\n    at Object.onceWrapper (events.js:316:30)\n    at emitOne (events.js:115:13)\n    at Socket.emit (events.js:210:7)\n    at TCP._handle.close [as _onclose] (net.js:545:12)\n\n      ------------------------------------STDOUT------------------------------------\n      Container has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\n=> Container status:\nrestarted: 8 times {\"Bridge\":\"\",\"SandboxID\":\"e951a0b8c4d759f7d6afb9c5cf27afba74f5a419b40fc3cf761706c7b1fafca8\",\"HairpinMode\":false,\"LinkLocalIPv6Address\":\"\",\"LinkLocalIPv6PrefixLen\":0,\"Ports\":{},\"SandboxKey\":\"/var/run/docker/netns/e951a0b8c4d7\",\"SecondaryIPAddresses\":null,\"SecondaryIPv6Addresses\":null,\"EndpointID\":\"\",\"Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"MacAddress\":\"\",\"Networks\":{\"bridge\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"6d7a9535896ed5851bb957e8b8ecffc4a37dabe06ad5cf174bcac1dcb89c395c\",\"EndpointID\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"\",\"DriverOpts\":null}}} {\"Status\":\"restarting\",\"Running\":true,\"Paused\":false,\"Restarting\":true,\"OOMKilled\":false,\"Dead\":false,\"Pid\":0,\"ExitCode\":1,\"Error\":\"\",\"StartedAt\":\"2018-03-29T15:46:35.729395241Z\",\"FinishedAt\":\"2018-03-29T15:46:38.492490305Z\"}\n=> Logs:\n\nTo see more logs type 'mup logs --tail=200'`\n\n. Suggestion2: Increasing the RAM size\nAccording to mup troubleshooting here > http://meteor-up.com/docs#troubleshooting\n`Check if Docker Containers are Restarting\nYou can view a list of Docker containers with\nmup docker ps\nand check the STATUS column.`\nI switched off my droplet in DO and resized it. That didn't help us as well. \nTo share: my env.variable settings\n`\nROOT_URL: 'http://###.##.###.###:####',\n            MONGO_URL: 'mongodb://ideasforsocial-shard-00-00-lwgwb.mongodb.net:27017,ideasforsocial-shard-00-01-lwgwb.mongodb.net:27017,ideasforsocial-shard-00-02-lwgwb.mongodb.net:27017/ifs1?replicaSet=ideasforsocial-shard-0\" --ssl --authenticationDatabase admin --username ##### --password ########',\n            MONGO_OPLOG_URL: 'mongodb://#####:#######@ideasforsocial-shard-00-00-lwgwb.mongodb.net:27017,ideasforsocial-shard-00-01-lwgwb.mongodb.net:27017,ideasforsocial-shard-00-02-lwgwb.mongodb.net:27017/local?authoSource=admin&ssl=true&replicaSet=ideasforsocial-shard-0',\n            PORT: 3000,`\ncan you advice @zodern ?. @zodern : :) :) Solved. Thanks a lot! \nI guess i have been using wrong Mongo_URL format :( once i changed to \n\"MONGO_URL\": \"mongodb://okgrow-staging-meteor:fakePassword1234@okgrow-staging-shard-00-00-fxnj9.mongodb.net:27017,okgrow-staging-shard-00-01-fxnj9.mongodb.net:27017,okgrow-staging-shard-00-02-fxnj9.mongodb.net:27017/meteor?authSource=admin&ssl=true&replicaSet=okgrow-staging-shard-0\",\n      \"MONGO_OPLOG_URL\": \"mongodb://okgrow-staging-oplog:fakePassword5678@okgrow-staging-shard-00-00-fxnj9.mongodb.net:27017,okgrow-staging-shard-00-01-fxnj9.mongodb.net:27017,okgrow-staging-shard-00-02-fxnj9.mongodb.net:27017/local?authSource=admin&ssl=true&replicaSet=okgrow-staging-shard-0\",\nhttps://www.okgrow.com/posts/mongodb-atlas-setup < Article was helpful! . Hi Zodern,  Thanks and respecting that you took back to reply. Thankfully it solved. \nThough the help of david > https://github.com/zodern/meteor-up/issues/886. We have solved,. What i did is requested him his mup,js file and chanaged as how he did :) \nHowever as I can't do the verbose on the older problem, I am just sharing with the successful one if it can help you someway, if not we can close this ticket. \n`\nJKsMBP1chSierra:.deploy jk$ mup deploy --verbose\nBuilding App Bundle Locally\nNode#moveTo was deprecated. Use Container#append.                           \nStarted TaskList: Pushing Meteor App\n[1.1.1.1.1] - Pushing Meteor App Bundle to the Server\n[1.1.1.1.1] - Pushing Meteor App Bundle to the Server: SUCCESS\n[1.1.1.1.1] - Prepare Bundle\nnode-8.4.0-base: Pulling from abernix/meteord\nDigest: sha256:04f44cf999da383d11de77027ced8b70818222c9890a405ce10803af3ee5a642\nStatus: Image is up to date for abernix/meteord:node-8.4.0-base\nFinished Extracting\nCreating Dockerfile\nFinished creating Dockerfile\nBuilding image\nSending build context to Docker daemon    247MB\nStep 1/8 : FROM abernix/meteord:node-8.4.0-base\nExecuting 1 build trigger\n---> Using cache\n ---> e662b0efcf8e\nStep 2/8 : RUN mkdir /built_app || true\n ---> Using cache\n ---> 4d68421d72df\nStep 3/8 : COPY ./ /built_app\n ---> Using cache\n ---> c3506eb2169f\nStep 4/8 : ENV ROOT_URL=http://1.1.1.1.1:3000\n ---> Using cache\n ---> 5f392ca0f99c\nStep 5/8 : ENV MONGO_URL=mongodb://mongodb:27017/ideasforsocial\n ---> Using cache\n ---> 4f8a4fa52af0\nStep 6/8 : ENV MONGO_OPLOG_URL=mongodb://mongodb/local\n ---> Using cache\n ---> 542bbcda85e8\nStep 7/8 : ENV PORT=3000\n ---> Using cache\n ---> 3378a5e35701\nStep 8/8 : RUN cd  /built_app/programs/server &&     npm install --unsafe-perm\n ---> Using cache\n ---> 2a522103bef1\nSuccessfully built 2a522103bef1\nSuccessfully tagged mup-ideasforsocial:build\nDeleted Images:\ndeleted: sha256:ba822fc8a4aeab438b4422ddfa328398a3ebb8af20a1a9a8997d8371fbf947a7\ndeleted: sha256:19d5ed8383e1211d9ab9a38e647f7a831619f5469180cc6f6e520556e0552c47\ndeleted: sha256:600fd5eb904999416495425d79215c9af91b3b2573c7c377176b17836dcd817a\ndeleted: sha256:746de25e673fc031fab1a3cda465371b1f0bbe08631b68edd785bbf014b7b562\ndeleted: sha256:9a8018950eb1ca66cb6fa681fb8609ed7db5a100730ce7e3715ac25099ea67a8\ndeleted: sha256:d9705793c6ed81338f7f843c2c25d5a2ee858ad1f18b12f94522a30ea05c4e9f\ndeleted: sha256:3262e3a32ab00e7eca2193f9a46493a102057f002f69a199c3e7304ecb60649a\ndeleted: sha256:f77bb2d2d041d1d320664b6c8e668b03046d805a5d2df4433e29be2fc487c516\nTotal reclaimed space: 231.7MB\n[1.1.1.1.1] - Prepare Bundle: SUCCESS\nStarted TaskList: Configuring App\n[1.1.1.1.1] - Pushing the Startup Script\n[1.1.1.1.1] - Pushing the Startup Script: SUCCESS\n[1.1.1.1.1] - Sending Environment Variables\n[1.1.1.1.1] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[1.1.1.1.1] - Start Meteor\nusing image\nremoving last\nImage mup-ideasforsocial:latest\nVolume\nRemoving docker containers. Errors about nonexistent endpoints and containers are normal.\nideasforsocial\nError response from daemon: endpoint ideasforsocial not found\nError: No such container: ideasforsocial-frontend\nError response from daemon: endpoint ideasforsocial-frontend not found\nError: No such container: ideasforsocial-nginx-letsencrypt\nError response from daemon: endpoint ideasforsocial-nginx-letsencrypt not found\nError: No such container: ideasforsocial-nginx-proxy\nError response from daemon: endpoint ideasforsocial-nginx-proxy not found\nFinished removing docker containers\n06a8f733e523b251ef30074171f1520751672c21f477e4005baad3672e364707\nRan abernix/meteord:node-8.4.0-base\n[1.1.1.1.1] - Start Meteor: SUCCESS\n[1.1.1.1.1] - Verifying Deployment\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0<!DOCTYPE html>\n\n\n{\"offset\":0}\n.\n.\n.\n\n30907    0 30907    0     0  72995      0 --:--:-- --:--:-- --:--:-- 73239\n[1.1.1.1] - Verifying Deployment: SUCCESS\n` \nThanks Buddy! Have a good week!. ",
    "mattmedroso": "But before these logs I have this error log for node-sass. I don't know if this is somewhat connected:\nCannot download \"https://github.com/sass/node-sass/releases/download/v3.8.0/linux-x64-57_binding.node\": \nHTTP error 404 Not Found\nHint: If github.com is not accessible in your location\n      try setting a proxy via HTTP_PROXY, e.g. \n  export HTTP_PROXY=http://example.com:1234\n\nor configure npm proxy via\n  npm config set proxy http://example.com:8080\n\n. Hi @zodern! I didn't know what happened but my setup got fixed miraculously. All I did in the server was a simple 'sudo apt-get update'. I'll close this issue thank you.. ",
    "ipstas": "Same here. 1.4 and 1.4.1 tries to connect to 172.17.0.3 and fails\n1.3.6 works\nConfig:\n`module.exports = {\n    servers: {\n        one: {\n            \"host\": \"stg.graffitiover.com\",\n            \"username\": \"root\",\n        }\n    },\nmeteor: {\n    name: 'graffiti-stg',\n    path: '/srv/www/meteor/graffiti-meteor',\n    volumes: {\n        '/localfiles':'/localfiles'\n    },\n    servers: {\n        one: {}\n    },\n    buildOptions: {\n        server: 'https://stg.graffitiover.com:443', // your app url for mobile app access (optional)\n        serverOnly: true, // skip building mobile apps, but still build the web.cordova architecture\n        debug: true,\n        cleanAfterBuild: true, // default\n        allowIncompatibleUpdates: false //adds --allow-incompatible-updates arg to build command (optional)\n    },\n    env: {\n        PORT: '8081',\n        ROOT_URL: 'https://stg.graffitiover.com',\n        MONGO_URL: 'mongodb://mongodb/graffiti',\n        MAIL_URL: 'smtp://172.17.0.1:25',\n        //host should be set for sparkpostmail\n        METEOR_ENV: 'staging'\n    },\n    docker: {\n        //image: 'abernix/meteord:base',\n        image: 'abernix/meteord:node-8.9.1-base',\n        args: [\n            '--link=mongodb:mongodb'\n        ],\n\n    },\n\n    deployCheckWaitTime: 80,\n    enableUploadProgressBar: true\n},\n\nmongo: {\n oplog: true,\n port: 27017,\n servers: {\n    one: {}\n },\n},\n\n};\n`. ",
    "gl-lamhnguyen": "@zodern thanks for reply, so is it possible to get the Dockerfile that MUP creates? This file has to be available before MUP can run the docker build command right?. ",
    "mart-jansink": "Ah, I'll do just that. Another verification method would be nice-to-have, but I can also easily check it myself of course.. Hmm, I'm afraid that setting deployCheckWaitTime to 0 doesn't work because at https://github.com/zodern/meteor-up/blob/fff181ebe21751ea7687394e12facd368fdf5708/src/plugins/meteor/utils.js#L9 it's then set to the default of 60 seconds. Also, wouldn't https://github.com/zodern/meteor-up/blob/fff181ebe21751ea7687394e12facd368fdf5708/src/plugins/meteor/assets/meteor-deploy-check.sh#L47 cause it to immediately revert to the previous version when DEPLOY_CHECK_WAIT_TIME is 0? At least, that's what I'm seeing now.. ",
    "pravdomil": "@zodern where exactly in docs?. done. 1) if you run docker container app stop you expect that the container will not run (even after restart)\n2) and there is no easy way how to disable container autorunning after restart. ",
    "pagesrichie": "Just wanted to clarify - I was looking through the meteor up documentation and noticed there were options in the json file for multiple servers, so I automatically assumed load balancing would come with it.  So that option is there for uploading to them one by one, however load balancing is not a part of mup yet and is in the pipeline for mup 1.5, correct?. Is this a good article to resolve the load balancing issue: http://joshowens.me/building-your-own-meteor-galaxy-hosting-setup/ , or setting up load balancing droplet on Digital Ocean as well?. Thanks.  Looking forward to your solution for mup 1.5!  When do you expect\nit to be finished (load balancing part especially)?\nOn Sat, Apr 7, 2018 at 11:06 AM, zodern notifications@github.com wrote:\n\nEither options would work.\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/zodern/meteor-up/issues/893#issuecomment-379488258,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/Ab4qvM6T6MWqYkXpLsRXFrPvGFOnsbucks5tmQAbgaJpZM4SPorK\n.\n\n\n-- \nRichie Pages\nWeb developer/founder/writer\n. ",
    "CJjumper": "Hi @zodern congrats on the amazing work you have been doing, can we have an update on this list? What the things have changed since April? Would be amazing to track your progress as you go.. ",
    "davidrea": "Came across this issue while searching for how to renew LE certs... Looks like just running mup setup again will renew certs. If this is true and doesn't have other side effects, I'm happy to add with a PR.. ",
    "jinhokong": "@zodern I ran your suggestion, but I have the same problem.. @zodern \n```\nPS C:\\Users\\tpdle\\Documents\\GitHub\\TravelBoard.deploy> mup deploy --verbose\n  mup:updates checking for updates +0ms\n  mup:api Running command default.deploy +0ms\n  mup:module:default exec => mup deploy +0ms\n  mup:api Running command meteor.deploy +17ms\n  mup:module:meteor exec => mup meteor deploy +0ms\n  mup:api Running command meteor.push +3ms\n  mup:module:meteor exec => mup meteor push +3ms\n  mup:api Running command meteor.build +1ms\nBuilding App Bundle Locally\n  mup:module:meteor Build Path: C:\\Users\\tpdle\\Documents\\GitHub\\TravelBoard +0ms\n  mup:module:meteor Build Command:  C:\\WINDOWS\\system32\\cmd.exe /c meteor build --directory C:\\Users\\tpdle\\AppData\\Local\\Temp\\mup-meteor-e830570b-1564-4aa5-a7b4-19931a3ee9b7 --architecture os.linux.x86_64 --server-only +0ms\nC:\\Users\\tpdle\\AppData\\Local.meteor\\packages\\meteor-tool\\1.5.2_2\\mt-os.windows.x86_32\\dev_bundle\\lib\\node_modules\\fibers\\future.js:280\n                                                throw(ex);\n                                                ^\nError: ENOENT: no such file or directory, stat 'C:\\Users\\tpdle\\Documents\\GitHub\\semver\\bin\\semver'\n    at Error (native)\n    at Object.fs.statSync (fs.js:844:18)\n    at Object.wrapper (C:\\tools\\fs\\files.js:1594:35)\n    at Object.files.(anonymous function) [as stat] (C:\\tools\\fs\\files.js:1729:27)\n    at symlinkWithOverwrite (C:\\tools\\isobuild\\builder.js:732:17)\n    at C:\\tools\\isobuild\\builder.js:559:11\n    at Array.forEach (native)\n    at walk (C:\\tools\\isobuild\\builder.js:464:34)\n    at C:\\tools\\isobuild\\builder.js:556:11\n    at Array.forEach (native)\n    at walk (C:\\tools\\isobuild\\builder.js:464:34)\n    at Builder.copyDirectory (C:\\tools\\isobuild\\builder.js:594:5)\n    at C:\\tools\\isobuild\\bundler.js:2253:17\n    at Function..each..forEach (C:\\Users\\tpdle\\AppData\\Local.meteor\\packages\\meteor-tool\\1.5.2_2\\mt-os.windows.x86_32\\dev_bundle\\lib\\node_modules\\underscore\\underscore.js:87:22)\n    at JsImage.write (C:\\tools\\isobuild\\bundler.js:2212:7)\n    at ServerTarget.write (C:\\tools\\isobuild\\bundler.js:2481:13)\n    at C:\\tools\\isobuild\\bundler.js:2600:30\n    at C:\\tools\\isobuild\\bundler.js:2735:9\n    at Array.forEach (native)\n    at C:\\tools\\isobuild\\bundler.js:2725:26\n    at C:\\tools\\isobuild\\bundler.js:3066:22\n    at C:\\tools\\utils\\buildmessage.js:271:13\n    at [object Object]..extend.withValue (C:\\tools\\utils\\fiber-helpers.js:89:14)\n    at C:\\tools\\utils\\buildmessage.js:264:29\n    at [object Object]..extend.withValue (C:\\tools\\utils\\fiber-helpers.js:89:14)\n    at C:\\tools\\utils\\buildmessage.js:262:18\n    at [object Object]..extend.withValue (C:\\tools\\utils\\fiber-helpers.js:89:14)\n    at C:\\tools\\utils\\buildmessage.js:253:23\n    at [object Object]..extend.withValue (C:\\tools\\utils\\fiber-helpers.js:89:14)\n    at Object.capture (C:\\tools\\utils\\buildmessage.js:252:19)\n    at bundle (C:\\tools\\isobuild\\bundler.js:2899:31)\n    at C:\\tools\\isobuild\\bundler.js:2846:32\n    at Object.withCache (C:\\tools\\fs\\files.js:1694:12)\n    at Object.exports.bundle (C:\\tools\\isobuild\\bundler.js:2846:16)\n    at buildCommand (C:\\tools\\cli\\commands.js:956:30)\n    at Command.func (C:\\tools\\cli\\commands.js:831:12)\n    at C:\\tools\\cli\\main.js:1483:23\n=> Build Error. Check the logs printed above.\n```. @vladbalan \nIt was problem because of Meteor\nit was made by Meteor 1.5.2.2, but upgraded to Meteor 1.6.1 and solved the problem.\n. Thank you. The problem is resolved.. ",
    "vladbalan": "@jinhokong How did you manage to fix this?. ",
    "ninjaPixel": "Hey, @zodern! I'd love to help with this project. I've made a couple of minor pull requests to the docs (https://github.com/zodern/meteor-up/pull/1024 and https://github.com/zodern/meteor-up/pull/1025) and the automated build tests fail for both of them.\nIt's the node tests/validate-docs.js test which fails. This test passes for me, locally. \nSince I've just updated the docs, I'm assuming that I haven't actually broken anything and it is something peculiar to the continuous integration environment. Does this sound likely to you? Let me know if you need any more details.\n. @charlesdagenais I haven't personally used Meteor 1.8 + zodern/meteor:root, but it should be fine as it automagically uses the correct version of Node.js and NPM.\n. >  letsEncryptEmail is totally arbitrary\n@eric-burel That hasn't been my experience. I've received emails from Lets Encrypt when a MUP-deployed app's certificate is close to expiring. \nHowever, if everything is running as it should, your container will update the certificate and you won't get emails from Lets Encrypt (it's only happened for me on old projects that I have shut-down). ",
    "khurmcandid": "Anyone?. Sorry guys, haven't had any reply, just seeing if this is because I've written the question out in a complicated way or no one can figure it out?. ",
    "Joaojuby": "It seems to me that the docker versions are using node 8.9.4 and the bundle requires 8.9.5 as of meteor 1.6.1\nI might be wrong, but the reality is the app builds and works flawlessly in my OS (win 10) but when deployed with mup it keeps restarting due to some exception:\n```\n/built_app/programs/server/node_modules/fibers/future.js:280\n                                                        throw(ex);\n                                                        ^\nError: Cannot find module 'ee-first'\n```\nI went digging on the local build ( .meteor/local/build/) and in the README file there's this line:\n\nThis is a Meteor application bundle. It has only one external dependency:\nNode.js v8.9.4.\n\nAnd when I run \nmup meteor node --version \nI get a different version based on the docker I'm using, but the latest I could get was 8.9.3\nIs there a way to pass a command to docker (through mup or even by ssh on the machine) to install a specific node version? I'm curious if that is the actual problem on my case. I've spent a lot of time today trying to get this to work, so here's everything I've found plus the mup deploy --verbose result.\nmup deploy --verbose\n```\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[13.79.228.79] - Pushing Meteor App Bundle to the Server\n[13.79.228.79] - Pushing Meteor App Bundle to the Server: SUCCESS\n[13.79.228.79] - Prepare Bundle\nnode-8.4.0-base: Pulling from abernix/meteord\nDigest: sha256:04f44cf999da383d11de77027ced8b70818222c9890a405ce10803af3ee5a642\nStatus: Image is up to date for abernix/meteord:node-8.4.0-base\nFinished Extracting\nCreating Dockerfile\nFinished creating Dockerfile\nBuilding image\nSending build context to Docker daemon  53.18MB\nStep 1/7 : FROM abernix/meteord:node-8.4.0-base\nExecuting 1 build trigger\n---> Using cache\n ---> d99e0a46b44c\nStep 2/7 : RUN mkdir /built_app || true\n ---> Using cache\n ---> 3acb12231bbd\nStep 3/7 : COPY ./ /built_app\n ---> 8404a8e12202\nStep 4/7 : ENV ROOT_URL=http://kin-api.northeurope.cloudapp.azure.com\n ---> Running in fdc5c370c422\nRemoving intermediate container fdc5c370c422\n ---> b65cc8a18615\nStep 5/7 : ENV MONGO_URL=mongodb://mongodb:27017/kin\n ---> Running in 4c4c90705a3f\nRemoving intermediate container 4c4c90705a3f\n ---> e131f9b2b9f8\nStep 6/7 : ENV MONGO_OPLOG_URL=mongodb://mongodb/local\n ---> Running in c6daf2ce4276\nRemoving intermediate container c6daf2ce4276\n ---> b5b633b0634b\nStep 7/7 : RUN cd  /built_app/programs/server &&     npm install --unsafe-perm\n ---> Running in e2e59619df57\n\nfibers@2.0.0 install /built_app/programs/server/node_modules/fibers\nnode build.js || nodejs build.js\n\nlinux-x64-57 exists; testing\nBinary is fine; exiting\n\nmeteor-dev-bundle@ install /built_app/programs/server\nnode npm-rebuild.js\n\n{\n  \"npm\": \"5.3.0\",\n  \"ares\": \"1.10.1-DEV\",\n  \"cldr\": \"31.0.1\",\n  \"http_parser\": \"2.7.0\",\n  \"icu\": \"59.1\",\n  \"modules\": \"57\",\n  \"nghttp2\": \"1.22.0\",\n  \"node\": \"8.4.0\",\n  \"openssl\": \"1.0.2l\",\n  \"tz\": \"2017b\",\n  \"unicode\": \"9.0\",\n  \"uv\": \"1.13.1\",\n  \"v8\": \"6.0.286.52\",\n  \"zlib\": \"1.2.11\"\n}\nadded 136 packages in 8.888s\nRemoving intermediate container e2e59619df57\n ---> b0b4caeb83b4\nSuccessfully built b0b4caeb83b4\nSuccessfully tagged mup-kin:build\nDeleted Images:\ndeleted: sha256:f78e4ba2ff1cb6aaf4575cbdd9ddb4fdb51d5f72cc1170d803d28bc7bc36ba3c\ndeleted: sha256:59e810bbce25df9c103ad68dc25c4cbfcfe24501b47dec02a9eaf74c2f37d772\ndeleted: sha256:170b099e31e985416ac7f5fc509d478fbfe838e2c8353ebdb941fe653d8cd0e6\ndeleted: sha256:ec79a74fe4b53ec5921dd83252b7625643714ffb16e56886362a420af58a70cf\ndeleted: sha256:f21a48161bb1a167d543187150c8197d5325240ca5e7ebd8c8f3b4287e5a61f2\ndeleted: sha256:832cccc0c003f2adb62acca88a2eb0b48b7e8f2a9a1cb95608752d1d49dbddf6\ndeleted: sha256:47b73079990194a323f077708c1bfbbd2cefc03d75ea7f3bd6bd4e676e679037\ndeleted: sha256:55b4e17a54b5b9caf43886e6a3476b0fcc968c0ae3b55600e5121b24e2d74e1b\nTotal reclaimed space: 51.02MB\n[13.79.228.79] - Prepare Bundle: SUCCESS\nStarted TaskList: Configuring App\n[13.79.228.79] - Pushing the Startup Script\n[13.79.228.79] - Pushing the Startup Script: SUCCESS\n[13.79.228.79] - Sending Environment Variables\n[13.79.228.79] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[13.79.228.79] - Start Meteor\nusing image\nremoving last\nImage mup-kin:latest\nVolume\nRemoving docker containers. Errors about nonexistent endpoints and containers are normal.\nError: No such container: kin\nError response from daemon: endpoint kin not found\nError: No such container: kin-frontend\nError response from daemon: endpoint kin-frontend not found\nError: No such container: kin-nginx-letsencrypt\nError response from daemon: endpoint kin-nginx-letsencrypt not found\nError: No such container: kin-nginx-proxy\nError response from daemon: endpoint kin-nginx-proxy not found\nFinished removing docker containers\n5cd0238823f0b1dd0ddf6492a5fc6c40024b281a3fe5dfa7efeb29f1ac0a7a80\nRan abernix/meteord:node-8.4.0-base\n[13.79.228.79] - Start Meteor: SUCCESS\n[13.79.228.79] - Verifying Deployment\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.3\nport 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.3\nport 80: Connection refused\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.3\nport 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.3\nport 80: Connection refused\nContainer has no IP Address, likely from it restarting.\nToo much time spent restarting.\n=> Container status:\nrestarted: 8 times {\"Bridge\":\"\",\"SandboxID\":\"eb76656023359e44535637ade69ab9008ca515d34a78ab88c8d303fae7c1d795\",\"HairpinM\node\":false,\"LinkLocalIPv6Address\":\"\",\"LinkLocalIPv6PrefixLen\":0,\"Ports\":{},\"SandboxKey\":\"/var/run/docker/netns/eb7665602\n335\",\"SecondaryIPAddresses\":null,\"SecondaryIPv6Addresses\":null,\"EndpointID\":\"\",\"Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"Glob\nalIPv6PrefixLen\":0,\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"MacAddress\":\"\",\"Networks\":{\"bridge\":{\"IPAMConfig\":nu\nll,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"f25f4c80458a592636b91c57bfcff846925b98ca50b34d371fb76957aeee2257\",\"EndpointI\nD\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAd\ndress\":\"\",\"DriverOpts\":null}}} {\"Status\":\"restarting\",\"Running\":true,\"Paused\":false,\"Restarting\":true,\"OOMKilled\":false,\n\"Dead\":false,\"Pid\":0,\"ExitCode\":1,\"Error\":\"\",\"StartedAt\":\"2018-03-13T19:50:08.794895176Z\",\"FinishedAt\":\"2018-03-13T19:50\n:10.367915238Z\"}\n=> Logs:\nin the root directory of your application.\n/built_app/programs/server/node_modules/fibers/future.js:280\n                                                throw(ex);\n                                                ^\nError: Cannot find module 'ee-first'\n    at Function.Module._resolveFilename (module.js:489:15)\n    at Function.Module._load (module.js:439:25)\n    at Module.require (module.js:517:17)\n    at require (internal/module.js:11:18)\n    at Object. (/built_app/programs/server/npm/node_modules/meteor/simple_json-routes/node_modules/connect/no\nde_modules/finalhandler/node_modules/on-finished/index.js:23:13)\n    at Module._compile (module.js:573:30)\n    at Object.Module._extensions..js (module.js:584:10)\n    at Module.load (module.js:507:32)\n    at tryModuleLoad (module.js:470:12)\n    at Function.Module._load (module.js:462:3)\n    at Module.require (module.js:517:17)\n    at require (internal/module.js:11:18)\n    at Object. (/built_app/programs/server/npm/node_modules/meteor/simple_json-routes/node_modules/connect/no\nde_modules/finalhandler/index.js:17:18)\n    at Module._compile (module.js:573:30)\n    at Object.Module._extensions..js (module.js:584:10)\n    at Module.load (module.js:507:32)\n    at tryModuleLoad (module.js:470:12)\n    at Function.Module._load (module.js:462:3)\n    at Module.require (module.js:517:17)\n    at require (internal/module.js:11:18)\n    at Object. (/built_app/programs/server/npm/node_modules/meteor/simple_json-routes/node_modules/connect/li\nb/proto.js:12:20)\n    at Module._compile (module.js:573:30)\n=> Starting meteor app on port:80\nNote: you are using a pure-JavaScript implementation of bcrypt.\nWhile this implementation will work correctly, it is known to be\napproximately three times slower than the native implementation.\nIn order to use the native implementation instead, run\nmeteor npm install --save bcrypt\nin the root directory of your application.\n/built_app/programs/server/node_modules/fibers/future.js:280\n                                                throw(ex);\n                                                ^\nError: Cannot find module 'ee-first'\n    at Function.Module._resolveFilename (module.js:489:15)\n    at Function.Module._load (module.js:439:25)\n    at Module.require (module.js:517:17)\n    at require (internal/module.js:11:18)\n    at Object. (/built_app/programs/server/npm/node_modules/meteor/simple_json-routes/node_modules/connect/no\nde_modules/finalhandler/node_modules/on-finished/index.js:23:13)\n    at Module._compile (module.js:573:30)\n    at Object.Module._extensions..js (module.js:584:10)\n    at Module.load (module.js:507:32)\n    at tryModuleLoad (module.js:470:12)\n    at Function.Module._load (module.js:462:3)\n    at Module.require (module.js:517:17)\n    at require (internal/module.js:11:18)\n    at Object. (/built_app/programs/server/npm/node_modules/meteor/simple_json-routes/node_modules/connect/no\nde_modules/finalhandler/index.js:17:18)\n    at Module._compile (module.js:573:30)\n    at Object.Module._extensions..js (module.js:584:10)\n    at Module.load (module.js:507:32)\n    at tryModuleLoad (module.js:470:12)\n    at Function.Module._load (module.js:462:3)\n    at Module.require (module.js:517:17)\n    at require (internal/module.js:11:18)\n    at Object. (/built_app/programs/server/npm/node_modules/meteor/simple_json-routes/node_modules/connect/li\nb/proto.js:12:20)\n    at Module._compile (module.js:573:30)\n=> Starting meteor app on port:80\nNote: you are using a pure-JavaScript implementation of bcrypt.\nWhile this implementation will work correctly, it is known to be\napproximately three times slower than the native implementation.\nIn order to use the native implementation instead, run\nmeteor npm install --save bcrypt\nin the root directory of your application.\n/built_app/programs/server/node_modules/fibers/future.js:280\n                                                throw(ex);\n                                                ^\nError: Cannot find module 'ee-first'\n    at Function.Module._resolveFilename (module.js:489:15)\n    at Function.Module._load (module.js:439:25)\n    at Module.require (module.js:517:17)\n    at require (internal/module.js:11:18)\n    at Object. (/built_app/programs/server/npm/node_modules/meteor/simple_json-routes/node_modules/connect/no\nde_modules/finalhandler/node_modules/on-finished/index.js:23:13)\n    at Module._compile (module.js:573:30)\n    at Object.Module._extensions..js (module.js:584:10)\n    at Module.load (module.js:507:32)\n    at tryModuleLoad (module.js:470:12)\n    at Function.Module._load (module.js:462:3)\n    at Module.require (module.js:517:17)\n    at require (internal/module.js:11:18)\n    at Object. (/built_app/programs/server/npm/node_modules/meteor/simple_json-routes/node_modules/connect/no\nde_modules/finalhandler/index.js:17:18)\n    at Module._compile (module.js:573:30)\n    at Object.Module._extensions..js (module.js:584:10)\n    at Module.load (module.js:507:32)\n    at tryModuleLoad (module.js:470:12)\n    at Function.Module._load (module.js:462:3)\n    at Module.require (module.js:517:17)\n    at require (internal/module.js:11:18)\n    at Object. (/built_app/programs/server/npm/node_modules/meteor/simple_json-routes/node_modules/connect/li\nb/proto.js:12:20)\n    at Module._compile (module.js:573:30)\nTo see more logs type 'mup logs --tail=200'\n=> Redeploying previous version of the app\n[13.79.228.79] x Verifying Deployment: FAILED\n          ------------------------------------STDERR------------------------------------\n          e_modules/finalhandler/index.js:17:18)\n        at Module._compile (module.js:573:30)\n        at Object.Module._extensions..js (module.js:584:10)\n        at Module.load (module.js:507:32)\n        at tryModuleLoad (module.js:470:12)\n        at Function.Module._load (module.js:462:3)\n        at Module.require (module.js:517:17)\n        at require (internal/module.js:11:18)\n        at Object.<anonymous> (/built_app/programs/server/npm/node_modules/meteor/simple_json-routes/node_modules/co\n\nnnect/lib/proto.js:12:20)\n            at Module._compile (module.js:573:30)\n        => Starting meteor app on port:80\n        Note: you are using a pure-JavaScript implementation of bcrypt.\n        While this implementation will work correctly, it is known to be\n        approximately three times slower than the native implementation.\n        In order to use the native implementation instead, run\n      meteor npm install --save bcrypt\n\n    in the root directory of your application.\n    /built_app/programs/server/node_modules/fibers/future.js:280\n                                                    throw(ex);\n                                                    ^\n\n    Error: Cannot find module 'ee-first'\n        at Function.Module._resolveFilename (module.js:489:15)\n        at Function.Module._load (module.js:439:25)\n        at Module.require (module.js:517:17)\n        at require (internal/module.js:11:18)\n        at Object.<anonymous> (/built_app/programs/server/npm/node_modules/meteor/simple_json-routes/node_modules/co\n\nnnect/node_modules/finalhandler/node_modules/on-finished/index.js:23:13)\n            at Module._compile (module.js:573:30)\n            at Object.Module._extensions..js (module.js:584:10)\n            at Module.load (module.js:507:32)\n            at tryModuleLoad (module.js:470:12)\n            at Function.Module._load (module.js:462:3)\n            at Module.require (module.js:517:17)\n            at require (internal/module.js:11:18)\n            at Object. (/built_app/programs/server/npm/node_modules/meteor/simple_json-routes/node_modules/co\nnnect/node_modules/finalhandler/index.js:17:18)\n            at Module._compile (module.js:573:30)\n            at Object.Module._extensions..js (module.js:584:10)\n            at Module.load (module.js:507:32)\n            at tryModuleLoad (module.js:470:12)\n            at Function.Module._load (module.js:462:3)\n            at Module.require (module.js:517:17)\n            at require (internal/module.js:11:18)\n            at Object. (/built_app/programs/server/npm/node_modules/meteor/simple_json-routes/node_modules/co\nnnect/lib/proto.js:12:20)\n            at Module._compile (module.js:573:30)\n        => Starting meteor app on port:80\n        Note: you are using a pure-JavaScript implementation of bcrypt.\n        While this implementation will work correctly, it is known to be\n        approximately three times slower than the native implementation.\n        In order to use the native implementation instead, run\n      meteor npm install --save bcrypt\n\n    in the root directory of your application.\n    /built_app/programs/server/node_modules/fibers/future.js:280\n                                                    throw(ex);\n                                                    ^\n\n    Error: Cannot find module 'ee-first'\n        at Function.Module._resolveFilename (module.js:489:15)\n        at Function.Module._load (module.js:439:25)\n        at Module.require (module.js:517:17)\n        at require (internal/module.js:11:18)\n        at Object.<anonymous> (/built_app/programs/server/npm/node_modules/meteor/simple_json-routes/node_modules/co\n\nnnect/node_modules/finalhandler/node_modules/on-finished/index.js:23:13)\n            at Module._compile (module.js:573:30)\n            at Object.Module._extensions..js (module.js:584:10)\n            at Module.load (module.js:507:32)\n            at tryModuleLoad (module.js:470:12)\n            at Function.Module._load (module.js:462:3)\n            at Module.require (module.js:517:17)\n            at require (internal/module.js:11:18)\n            at Object. (/built_app/programs/server/npm/node_modules/meteor/simple_json-routes/node_modules/co\nnnect/node_modules/finalhandler/index.js:17:18)\n            at Module._compile (module.js:573:30)\n            at Object.Module._extensions..js (module.js:584:10)\n            at Module.load (module.js:507:32)\n            at tryModuleLoad (module.js:470:12)\n            at Function.Module._load (module.js:462:3)\n            at Module.require (module.js:517:17)\n            at require (internal/module.js:11:18)\n            at Object. (/built_app/programs/server/npm/node_modules/meteor/simple_json-routes/node_modules/co\nnnect/lib/proto.js:12:20)\n            at Module._compile (module.js:573:30)\n    => Redeploying previous version of the app\n\n\n          ------------------------------------STDOUT------------------------------------\n          Container has no IP Address, likely from it restarting.\n    Container has no IP Address, likely from it restarting.\n    Container has no IP Address, likely from it restarting.\n    Container has no IP Address, likely from it restarting.\n    Container has no IP Address, likely from it restarting.\n    Container has no IP Address, likely from it restarting.\n    Container has no IP Address, likely from it restarting.\n    Container has no IP Address, likely from it restarting.\n    Container has no IP Address, likely from it restarting.\n    Container has no IP Address, likely from it restarting.\n    => Container status:\n    restarted: 8 times {\"Bridge\":\"\",\"SandboxID\":\"eb76656023359e44535637ade69ab9008ca515d34a78ab88c8d303fae7c1d795\",\"\n\nHairpinMode\":false,\"LinkLocalIPv6Address\":\"\",\"LinkLocalIPv6PrefixLen\":0,\"Ports\":{},\"SandboxKey\":\"/var/run/docker/netns/e\nb7665602335\",\"SecondaryIPAddresses\":null,\"SecondaryIPv6Addresses\":null,\"EndpointID\":\"\",\"Gateway\":\"\",\"GlobalIPv6Address\":\n\"\",\"GlobalIPv6PrefixLen\":0,\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"MacAddress\":\"\",\"Networks\":{\"bridge\":{\"IPAMCo\nnfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"f25f4c80458a592636b91c57bfcff846925b98ca50b34d371fb76957aeee2257\",\"E\nndpointID\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":\n0,\"MacAddress\":\"\",\"DriverOpts\":null}}} {\"Status\":\"restarting\",\"Running\":true,\"Paused\":false,\"Restarting\":true,\"OOMKilled\n\":false,\"Dead\":false,\"Pid\":0,\"ExitCode\":1,\"Error\":\"\",\"StartedAt\":\"2018-03-13T19:50:08.794895176Z\",\"FinishedAt\":\"2018-03-\n13T19:50:10.367915238Z\"}\n        => Logs:\n    To see more logs type 'mup logs --tail=200'\n\n\n          ------------------------------------------------------------------------------\n\n```\nTo clarify, I had stopped and removed the docker instances before this attempt to give you a reproducible environment. The VM is hosted on Azure and the machine I'm using is running windows 10 (which forces me to use mup.cmd but it's extremely reliable as of late)\nThe meteor project was created with the --bare flag. If I deploy at that moment, everything is fine. The moment I add the simple:restivus package it starts to fail the verification.\nWhat I could find is that it is related with the simple-json package, but I have no problems when running locally. Tried to serve an almost empty html page hoping it would pass the verification but it wasn't the case. In fact I can't even reach the host through the dns although when I run docker ps -a we get this:\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                        NAMES\n0a88493dbeec        mup-kin:latest      \"/bin/sh -c 'bash $M\u2026\"   7 minutes ago       Up 7 minutes        0.0.0.0:80->80/tcp           kin\n20e2e542021a        mongo:3.4.1         \"/entrypoint.sh mong\u2026\"   11 minutes ago      Up 11 minutes       127.0.0.1:27017->27017/tcp   mongodb\nAll I needed was to set up a web service and wanted to leverage the mongodb integration from meteor but all high level packages depend directly on simple-json so I'm running out of ideas here. Can't exactly tell if this is a mup issue but at least when working locally there's no issues.. Thanks for the reminder, I didn't even thought that I could just add the missing module. I've hit another missing module so I'll keep iterating on installing them manually and compile a list.\nI'll gladly create the repo after this however\nEdit: forgot to say the missing module that came after is still from the same package, so I'm getting more doubts on wether this is mup related at all, if this just happens with this package or not.. @zodern Like you asked, here's a repo with exactly the same code and dependencies I was experiencing\nhttps://github.com/Joaojuby/meteor-web-api\nIt would be simple to replicate anyways, meteor create my-app --bare followed by meteor add nimble:restivus and after that you can run it, you can use it locally but I couldn't deploy it for reasons already mentioned.\nI also compiled the \"list\" of missing dependencies, in the end it was just 'ee-first' and 'range-parser', both from simple:json-routes. ",
    "andrelillvede": "Any updates on this?. @zodern do you have any input on the original issue?. @AkkerD @zodern Nope, not using Meteor 1.4 I'm on Meteor 1.6.1.1 (and I can't find any evidence that mup thinks otherwise?). \nI'm using the docker image stated in the docs and also tried with 'zodern/meteor:root' but still getting Verifying Deployment: FAILED\" and mup not deploying the newly build image.\nMy webapp container is part of a docker network I specified on the host and in the docker section of the mup config I have '--network=services' in the args field.\nCan it be that the checks in meteor-deploy-check.sh cannot handle that?\n. Well, I got it running by having\ndocker: {\n      image: 'abernix/meteord:node-8.9.4-base',\n      args: [\n        '--network=services',\n      ],\n      networks: ['services'],\n    },\nin my config file instead of\ndocker: {\n      image: 'abernix/meteord:node-8.9.4-base',\n      args: [\n        '--network=services',\n      ],\n    },\n\u00af_(\u30c4)_/\u00af\n. ",
    "akkerd": "@andrelillvede the solution that @zodern gave worked for me. It seems to be the same problem with the docker version in your configuration file.  As you are using Meteor 1.4, change your docker version to: \n\"docker\": {\n      \"image\": \"abernix/meteord:base\",\n    },\nor to automatically detects the needed node version use:\n\"docker\": {\n      \"image\": \"zodern/meteor:root\",\n    },\nThen run:\nmup reconfig\nmup deploy. ",
    "stuartlangridge": "As far as I can tell, mup does not halt the process of deployment when running a localCommand in a pre.deploy hook. The relevant code is in plugin-api.js (https://github.com/zodern/meteor-up/blob/master/src/plugin-api.js#L215):\nkey: '_runHookScript',\n    value: function _runHookScript(script) {\n      try {\n        _child_process2.default.execSync(script, {\n          cwd: this.getBasePath(),\n          stdio: 'inherit'\n        });\n      } catch (e) {\n        // do nothing\n      }\n    }\nexecSync does throw an error if the target localCommand returns with a non-zero exit code, but the function catches that error and ignores it (with a comment, \"do nothing\"). I think, as per the original poster, that a Command failed error here should print out that the pre.deploy script failed, and abort the deploy.\n. ",
    "chip": "@zodern - Thanks for your prompt reply. I upgraded my server to 3GB ram, reran mup setup which was successful and and am now getting this after running mup deploy --cached-build --verbose | tee deploy.out (here's my deploy.out):\n```\nNot building app. Using build from previous deploy at\n/var/folders/7y/7y_d1zq55gz20ztgt_p3zjkm0000gn/T/mup-meteor-fe3def38-4e07-446d-86da-e6a432341bb0\n\u001b[34m\u001b[1m\nStarted TaskList: Pushing Meteor App\u001b[22m\u001b[39m\n\u001b[36m\u001b[35m[staging.tracker-app.example.com] \u001b[39m- Pushing Meteor App Bundle to the Server\u001b[39m\n\u001b[36m\u001b[35m[staging.tracker-app.example.com] \u001b[39m\u001b[32m- Pushing Meteor App Bundle to the Server: SUCCESS\u001b[39m\u001b[39m\n\u001b[36m\u001b[35m[staging.tracker-app.example.com] \u001b[39m- Prepare Bundle\u001b[39m\nroot: Pulling from zodern/meteor\nDigest: sha256:56e6bf2192aa93a1ae442b4635d176664953c3fdb5a133754cad7b16e05eb905\nStatus: Image is up to date for zodern/meteor:root\nFinished Extracting\nCreating Dockerfile\nFinished creating Dockerfile\nBuilding image\nSending build context to Docker daemon  131.9MB\nStep 1/12 : FROM zodern/meteor:root\n\u001b[91m# Executing 5 build triggers...\n\u001b[0mStep 1/1 : USER root\n ---> Using cache\nStep 1/1 : ARG NODE_VERSION='4.8.4'\n ---> Using cache\nStep 1/1 : RUN bash ./scripts/onbuild-node.sh\n ---> Using cache\nStep 1/1 : ENV NODE_PATH /home/app/.onbuild-node/lib/node_modules\n ---> Using cache\nStep 1/1 : ENV PATH /home/app/.onbuild-node/bin:$PATH\n ---> Using cache\n ---> ee72b725f9b4\nStep 2/12 : RUN mkdir /built_app || true\n ---> Using cache\n ---> e9f0909088c2\nStep 3/12 : COPY ./ /built_app\n ---> Using cache\n ---> 2b5b570731c3\nStep 4/12 : ENV ROOT_URL https://staging.tracker-app.example.com\n ---> Using cache\n ---> be56a338aa25\nStep 5/12 : ENV MONGO_URL mongodb://mongodb:27017/staging-tracker-app-example-com\n ---> Using cache\n ---> 5f0acf885d78\nStep 6/12 : ENV NODE_ENV staging\n ---> Using cache\n ---> 572aa212a1ea\nStep 7/12 : ENV VIRTUAL_HOST tracker-app.example.com,staging.tracker-app.example.com\n ---> Using cache\n ---> af296e31feb6\nStep 8/12 : ENV HTTPS_METHOD noredirect\n ---> Using cache\n ---> 8574852ad169\nStep 9/12 : ENV HTTP_FORWARDED_COUNT 1\n ---> Using cache\n ---> 452e0b486268\nStep 10/12 : ENV LETSENCRYPT_HOST tracker-app.example.com,staging.tracker-app.example.com\n ---> Using cache\n ---> f67b447d188c\nStep 11/12 : ENV LETSENCRYPT_EMAIL chip@example.com\n ---> Using cache\n ---> 5772eeceab37\nStep 12/12 : RUN cd  /built_app/programs/server &&     npm install --unsafe-perm\n ---> Running in 5deb785d15d9\n\nfibers@1.0.13 install /built_app/programs/server/node_modules/fibers\nnode build.js || nodejs build.js\n\nlinux-x64-v8-4.5 exists; testing\nBinary is fine; exiting\n\nmeteor-dev-bundle@0.0.0 install /built_app/programs/server\nnode npm-rebuild.js\nbcrypt@0.8.6 install /built_app/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt\nnode-gyp rebuild\n\nmake: Entering directory '/built_app/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt/build'\n  CXX(target) Release/obj.target/bcrypt_lib/src/blowfish.o\n  CXX(target) Release/obj.target/bcrypt_lib/src/bcrypt.o\n  CXX(target) Release/obj.target/bcrypt_lib/src/bcrypt_node.o\n  SOLINK_MODULE(target) Release/obj.target/bcrypt_lib.node\n  COPY Release/bcrypt_lib.node\nmake: Leaving directory '/built_app/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt/build'\nbcrypt@0.8.6 /built_app/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt\nbindings@1.2.1 /built_app/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt/node_modules/bindings\nnan@2.2.1 /built_app/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt/node_modules/nan\n\nbson@0.2.21 install /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/bson\n(node-gyp rebuild 2> builderror.log) || (exit 0)\n\nmake: Entering directory '/built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/bson/build'\n  CXX(target) Release/obj.target/bson/ext/bson.o\nbson.target.mk:94: recipe for target 'Release/obj.target/bson/ext/bson.o' failed\nmake: Leaving directory '/built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/bson/build'\n\nkerberos@0.0.9 install /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/kerberos\n(node-gyp rebuild 2> builderror.log) || (exit 0)\n\nmake: Entering directory '/built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/kerberos/build'\n  CXX(target) Release/obj.target/kerberos/lib/kerberos.o\nkerberos.target.mk:100: recipe for target 'Release/obj.target/kerberos/lib/kerberos.o' failed\nmake: Leaving directory '/built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/kerberos/build'\ngridfs-stream@0.5.3 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/gridfs-stream\nmongodb@1.4.35 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb\nbson@0.2.21 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/bson\nnan@1.7.0 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/bson/node_modules/nan\nkerberos@0.0.9 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/kerberos\nnan@1.6.2 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/kerberos/node_modules/nan\nreadable-stream@1.0.33 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/readable-stream\ncore-util-is@1.0.1 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/readable-stream/node_modules/core-util-is\nisarray@0.0.1 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/readable-stream/node_modules/isarray\nstring_decoder@0.10.31 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/readable-stream/node_modules/string_decoder\ninherits@2.0.1 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/readable-stream/node_modules/inherits\n{\n  \"meteor-dev-bundle\": \"0.0.0\",\n  \"npm\": \"3.10.10\",\n  \"ares\": \"1.10.1-DEV\",\n  \"http_parser\": \"2.7.0\",\n  \"icu\": \"56.1\",\n  \"modules\": \"46\",\n  \"node\": \"4.8.4\",\n  \"openssl\": \"1.0.2k\",\n  \"uv\": \"1.9.1\",\n  \"v8\": \"4.5.103.47\",\n  \"zlib\": \"1.2.11\"\n}\nmeteor-dev-bundle@0.0.0 /built_app/programs/server\n+-- amdefine@1.0.0 \n+-- ansi-regex@0.2.1 \n+-- ansi-styles@1.1.0 \n+-- asap@2.0.4 \n+-- chalk@0.5.1 \n+-- eachline@2.3.3 \n+-- escape-string-regexp@1.0.5 \n+-- fibers@1.0.13 \n+-- has-ansi@0.1.0 \n+-- meteor-promise@0.7.2 \n+-- promise@7.1.1 \n+-- semver@4.1.0 \n+-- source-map@0.1.32 \n+-- source-map-support@0.3.2 \n+-- strip-ansi@0.3.0 \n+-- supports-color@0.2.0 \n+-- type-of@2.0.1 \n`-- underscore@1.5.2 \n\u001b[91mnpm WARN\u001b[0m\u001b[91m meteor-dev-bundle@0.0.0 No description\n\u001b[0m\u001b[91mnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\n\u001b[0m ---> 253b53132467\nRemoving intermediate container 5deb785d15d9\nSuccessfully built 253b53132467\nSuccessfully tagged mup-staging-tracker-app-example-com:build\nDeleted Images:\nuntagged: jrcs/letsencrypt-nginx-proxy-companion@sha256:01a5cdd7a41fef462833d0daf6a621d5e6143d7338284526369852d0faf4caf0\ndeleted: sha256:5176f3ad3949bb9688f1f684b131fff94d3ffcc6f24ab39845ccd713eaf7941b\ndeleted: sha256:f11f8c7470340ef08bf819a8c5d9c7f5a651d5ad85f2b05465d8f8afa4471ef6\ndeleted: sha256:aba1c66dcb34380858aec3aa9c7de61782320b6083d75694f81ef2bcf5731a55\ndeleted: sha256:25cb5dd076f0059c2208ed31ca5f0fc35a5142af3336fc4906576f910ab74c90\ndeleted: sha256:6a7f9d965ee89c4c4335e2403f077a35902d352dbfb6ac9546d0cb42fa1a1c45\ndeleted: sha256:0d2f8d665c505873e507eaa3a3efa0bfeb8e1655aaa398362963a77ec39267ed\ndeleted: sha256:819b64a505f7aa32350e725f9925e5f379da7478b96510fe0d01bf1639835763\nuntagged: jwilder/nginx-proxy@sha256:6ec0e8ba1cb6510235187eacf09122d38c434b6a611f03fe970c1f16bc35f2b5\ndeleted: sha256:56986116e7acdb7242b87496be90bb3236686161761bdf36aca732cd5628e1fe\ndeleted: sha256:a896ac972dd7b7af764ee38c6f5448fd6c13a12d1ad14c544af972dfdd22bc8f\ndeleted: sha256:c4495d9e9b473c63d5ff35a0f2c2fabbaa5dc1648b7964073b7d99231323d452\ndeleted: sha256:75f04d6156f7992fc4b37cd1be632a2719ac96c3feb8b5cca468767650522524\ndeleted: sha256:fd4e39af99bee5015de97873f061717b9cc4db60853c01ff87d3149dbb889e73\ndeleted: sha256:5f74bc6d9f19d25f527458393b511d055ebe5c142262fd86f839cfb1538cc07e\ndeleted: sha256:5273aa6bdf867fe6afd1189998bc6ce982291cff0069892144f16e0b490db0f1\ndeleted: sha256:8c9de914a431b97e5df6e45ca5032d28d90e01e56e4824edd654e1311f0b9fae\ndeleted: sha256:28f6824ebf777f77931a2e27dadc3d092a62f78b5d28851542135411981b2f99\ndeleted: sha256:8781ec54ba04ce83ebcdb5d0bf0b2bb643e1234a1c6c8bec65e8d4b20e58a90d\nTotal reclaimed space: 256.2MB\n\u001b[36m\u001b[35m[staging.tracker-app.example.com] \u001b[39m\u001b[32m- Prepare Bundle: SUCCESS\u001b[39m\u001b[39m\n\u001b[34m\u001b[1m\nStarted TaskList: Configuring App\u001b[22m\u001b[39m\n\u001b[36m\u001b[35m[staging.tracker-app.example.com] \u001b[39m- Pushing the Startup Script\u001b[39m\n\u001b[36m\u001b[35m[staging.tracker-app.example.com] \u001b[39m\u001b[32m- Pushing the Startup Script: SUCCESS\u001b[39m\u001b[39m\n\u001b[36m\u001b[35m[staging.tracker-app.example.com] \u001b[39m- Sending Environment Variables\u001b[39m\n\u001b[36m\u001b[35m[staging.tracker-app.example.com] \u001b[39m\u001b[32m- Sending Environment Variables: SUCCESS\u001b[39m\u001b[39m\n\u001b[34m\u001b[1m\nStarted TaskList: Start Meteor\u001b[22m\u001b[39m\n\u001b[36m\u001b[35m[staging.tracker-app.example.com] \u001b[39m- Start Meteor\u001b[39m\nusing image\nImage mup-staging-tracker-app-example-com:latest\nVolume\nstaging-tracker-app-example-com\nedfeb52ac269e24139f8fb7518c403340b683638b356ec21dbd65bd416a61039\nRan zodern/meteor:root\n\u001b[36m\u001b[35m[staging.tracker-app.example.com] \u001b[39m\u001b[32m- Start Meteor: SUCCESS\u001b[39m\u001b[39m\n\u001b[36m\u001b[35m[staging.tracker-app.example.com] \u001b[39m- Verifying Deployment\u001b[39m\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\n=> Container status:\nrestarted: 7 times {\"Bridge\":\"\",\"SandboxID\":\"61add0824bd2857ffa4a029228539ae5bb4d2f62ccadfea52925757de7378716\",\"HairpinMode\":false,\"LinkLocalIPv6Address\":\"\",\"LinkLocalIPv6PrefixLen\":0,\"Ports\":{},\"SandboxKey\":\"/var/run/docker/netns/61add0824bd2\",\"SecondaryIPAddresses\":null,\"SecondaryIPv6Addresses\":null,\"EndpointID\":\"\",\"Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"MacAddress\":\"\",\"Networks\":{\"bridge\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"2cab6bfea1236520bb05242becb355291c834c4c7fd74c57f8a6e9f56012b6c5\",\"EndpointID\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"\"}}} {\"Status\":\"restarting\",\"Running\":true,\"Paused\":false,\"Restarting\":true,\"OOMKilled\":false,\"Dead\":false,\"Pid\":0,\"ExitCode\":8,\"Error\":\"\",\"StartedAt\":\"2018-03-28T08:10:32.843383331Z\",\"FinishedAt\":\"2018-03-28T08:10:36.172811426Z\"}\n=> Logs:\nTo see more logs type 'mup logs --tail=200'\n```. Thank you for your prompt feedback.\nUnfortunately, I was desperate due to time constraints from my client and had to replace the server disk with a backup from last week, so I can't attempt another deployment for awhile. I was unable to try that image because I'm running 1.3.4.4, so I only tried kadirahq/meteord and zodern/meteor:root per those docs. Both crashed many times, but I didn't save the logs from each run. If my client gives me the green light, I'll try upgrading meteor so that I can try that image and will reopen this if necessary.\nI'll dig around in the source to see what \"ExitCode\":8 could be. Thanks again.\n. ",
    "anderskitson": "Yes I am. It is fixed now it had something to do with the fact when I ssh in I was using ubuntu bash on windows and when I ran mup setup in powershell it didn't have the matching rsa key, so I ran bash in powershell ssh in and then ran mup setup again and it worked.. ",
    "AdrianApan": "Any fix for this issue? Ran into the same problem.. @zodern I'm using abernix/meteord:node-8.4.0-base for the image in the mup.js file since I'm running Meteor 1.6.1.1. So I guess it's not the same issue for me.. Apparently the mongodb docker instance was spazzing out and causing this issue for me. It kept restarting itself (62 times). Anyway after a mup setup things got back to normal. Also, I'm now using abernix/meteord:node-8.9.4-base for the image in mup.js.. ",
    "Silverutm": "I would like join the private beta, I'm currently running a server that could help you test the beta. My Meteor forums user\nhttps://forums.meteor.com/u/Silverutm/. ostrio:spiderable-middleware solved the problem. ",
    "hridayeshgupta": "Thanks! it solves the problem. ",
    "Sebi55": "I can confirm that this is still a problem.\nI am unable to provide a custom mobile-settings.json file and experience the exact same cases as you did.. ",
    "mediamana": "Thank you for the quick fix, i can confirm it is working on my project.\nBest regards. ",
    "tjramage": "I also had this issue just the other day. Meteor 1.6.1.3 and Mup 1.4.5.. @zodern \u2014 thanks for coming back to me so quickly. Please can you clarify for me: so I shouldn't set proxy.shared.env.DEFAULT_HOST to one of the domains in proxy.domains to get my expected behaviour? If that's the case, what should I set DEFAULT_HOST to?. Expected behaviour:\n\nApp is served when requesting https://dev.app.my-domain.com\nApp should NOT be served when requesting https://dev-1234.app.my-domain.com\n\nHowever, in the second case above, the app is still served.. @zodern \u2014 That's weird then. I don't have proxy.shared.env.DEFAULT_HOST set in my config (I never did), yet the app is still served from ANY domain that matches my A record. \nI have one host listed in proxy.domains:\n```\n// ... other props above...\nproxy {\n  domains: 'dev.app.my-domain.com',\n  ssl: {\n     // Enable Let's Encrypt\n     letsEncryptEmail: 'admin@avion.io',\n     forceSSL: true\n  }\n}\n```\nHowever, I can still access the app on whatever-i-type-here.app.my-domain.com.. ",
    "MikeAwie": "Did you find the issue?. ",
    "programthis": "@zodern Thanks for the tip. Weirdly, this issue seemed to go away on its own (even before updating to the more recent version).. ",
    "albertkai": "@zodern thank you, solved the issue!. ",
    "sebitoelcheater": "is this repo still being maintained?. ",
    "99darwin": "+1 \nThis issue has stumped me for a day now. It is strange because I have used mup for other projects, and this is the first time I've encountered any issues. Typically I can leave the mongo env variables default and when I mup deploy the database is deployed with the rest of the bundle. Now, it seems that's not the case and I have to manually configure the database on the server before deployment. \nAt any rate, I'm also experiencing the error in the title:\n------------------------------------STDERR------------------------------------\n              ved % Xferd  Average Speed   Time    Time     Time  Current\n                                         Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n          % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                         Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n          % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                         Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n          % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                         Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n          % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                         Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n          % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                         Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n        => Starting meteor app on port:80\n        /built_app/programs/server/node_modules/fibers/future.js:313\n                                                        throw(ex);\nFollowed by:\nError: failed to connect to server [SERVER_IP:27017] on first connect [MongoNetworkError:connection 0 to 68.183.169.22:27017 timed out]\n            at Pool.<anonymous> (/built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/topologies/server.js:564:11)\n            at emitOne (events.js:115:13)\n            at Pool.emit (events.js:210:7)\n            at Connection.<anonymous> (/built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/pool.js:317:12)\n            at Object.onceWrapper (events.js:318:30)\n            at emitTwo (events.js:125:13)\n            at Connection.emit (events.js:213:7)\n            at Socket.<anonymous> (/built_app/programs/server/npm/node_modules/meteor/npm-mongo/node_modules/mongodb-core/lib/connection/connection.js:257:10)\n            at Object.onceWrapper (events.js:314:30)\n            at emitNone (events.js:105:13)\n            at Socket.emit (events.js:207:7)\n            at Socket._onTimeout (net.js:398:8)\n            at ontimeout (timers.js:469:11)\n            at tryOnTimeout (timers.js:304:5)\n            at Timer.listOnTimeout (timers.js:264:5)\n        => Starting meteor app on port:80\nMy mup.js looks like this:\n```\nmodule.exports = {\n  servers: {\n    one: {\n      // TODO: set host address, username, and authentication method\n      host: 'server_ip',\n      username: 'root',\n      pem: '~/.ssh/pem'\n      // password: 'server-password'\n      // or neither for authenticate from ssh-agent\n    }\n  },\napp: {\n    // TODO: change app name and path\n    name: 'app_name',\n    path: '../',\nservers: {\n  one: {},\n},\n\nbuildOptions: {\n  serverOnly: true,\n},\n\nenv: {\n  // TODO: Change to your app's url\n  // If you are using ssl, it needs to start with https://\n  ROOT_URL: 'http://example.com',\n  MONGO_URL: 'mongodb://username:password@server_ip:27017/meteor',\n  // MONGO_OPLOG_URL: 'mongodb://mongodb/local'\n},\n\ndocker: {\n  // change to 'abernix/meteord:base' if your app is using Meteor 1.4 - 1.5\n  image: 'abernix/meteord:node-8.4.0-base',\n  prepareBundle: true\n},\n\n// Show progress bar while uploading bundle to server\n// You might need to disable it on CI servers\nenableUploadProgressBar: true\n\n}\n};\n```\nAny feedback is appreciated.. ",
    "systemlevel": "Mup deploy does not work on 18.04 for me either.  \nWhen it deploys I get the following errors during verification:\n0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\nContainer has no IP Address, likely from it restarting.\n\nWhen I deploy on Ubuntu 16.04 everything works.  \nAnyone else experiencing these issues on ubuntu 18.04?  After searching forums and google for hours I still have not found a solution to get it to work on 18.04 bionic.\n. ",
    "kankando": "Thx @zodern for looking into. let me try to deploy it from scratch again and get the mup status. @zodern here the mup status output\n`\n=> Servers\n: Ubuntu 16.04\n=> Docker Status\n: 18.05.0-ce Running\n=> Meteor Status\n: running \n    Created at 2018-05-14T13:48:02.522641109Z\n    Restarted 0 times\n    ENV: \n     - ROOT_URL=http://xxx.yyy.com\n     - MONGO_URL=mongodb://mongodb:27017/xxx\n     - MONGO_OPLOG_URL=mongodb://mongodb/local\n     - METEOR_SETTINGS={\"public\":{\"title\":\"xxx\",\"tagline\":\"yyy\",\"logoUrl\":\"xxx\",\"logoHeight\":\"80\",\"logoWidth\":\"250\",\"faviconUrl\":\"/favicon.ico\",\"language\":\"en\",\"locale\":\"en\",\"twitterAccount\":\"xxx\",\"facebookPage\":\"http://facebook.com/yyy\",\"googleAnalytics\":{\"apiKey\":\"xxx\"}},\"defaultEmail\":\"yy@xxx.ccc\",\"mailUrl\":\"xxx/\",\"oAuth\":{\"twitter\":{\"consumerKey\":\"xxxx\",\"secret\":\"yyyyyy\"},\"facebook\":{\"appId\":\"xxxx\",\"secret\":\"yyyy\"}}}\n     - PORT=80\n     - PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n     - METEORD_DIR=/opt/meteord\n     - NODE_VERSION=8.4.0\n    Published Ports:\n     - 80/tcp => 80\n    App running at http://xxxxrrrr:80\n     - Available in app's docker container: true\n     - Available on server: true\n     - Available on local computer: true\n=> Mongo Status\n  running on server xxxxxxxxx\n  Restarted 0 times\n  Running since 2018-05-14T13:29:03.695304606Z\n  Version: 3.4.1\n  Connections: 5\n  Storage Engine: wiredTiger\n`. ",
    "clesquir": "I've created a pull request for this change: https://github.com/zodern/meteor-up/pull/948. Please let me know if there is anything else to be modified!. ",
    "msteinmn": "This seems to work fine with CentOS 7 based VMs, like from Google Compute. The only real requirement for a CentOS host is that it can properly run Docker. The rest of mup then is unaffected by the distro (so it seems anyway).\nCreating a test environment in Travis CI is more difficult. I would need a container analogous to phusion/baseimage-docker but built on CentOS. The default CentOS containers do not seem to properly support running docker-in-docker. Using DIND defeats the purpose of creating a realistic test it seems. If anyone has any ideas, let me know.. ",
    "bgadrian": "I confirm that, when using custom networks, the Veryfing deployment fails, it uses the internal IP and of course it cannot be accessed.  \nIt seems that my problem is different, it tries to ping the address Could not resolve host: 172.17.0.2172.18.0.2 . I didn't found a solution so I disabled the nginx/ssl features and used the cloudflare's free Flexible SSL to do the job. Now it works.. ",
    "naterich2": "docker exec  <app_name> /usr/bin/node --version will check node version when replaced with your app name.  I believe you can install a specific version if you choose the right docker image in your config, for example abernix/meteord:node-8.4.0-base will install node 8.4.0, but there are many others availeble here. I don't know how to fix the tests, it is only failing for node 4, passing for all of node 8, but I don't know what to change to fix that.. ",
    "mishli": "I'm also having issue setting wildcard domains in proxy object and using custom cert (includes wildcard), but when running mup setup i get error 'Pushing Nginx Config: FAILED' and then: \nrm: cannot remove 'mydomain_location': No such file or directory\n    rm: cannot remove '*.mydomain_location_location': No such file or directory\n    rm: cannot remove 'seconddomain_location': No such file or directory\n    bash: line 31: *.seconddomain: ambiguous redirect\nwhen i remove the wildcard domains from proxy -  mup setup runs with no errors.\ndns wildcard is set up on both domains.\ndoes mup or meteor even support wildcard domains?\nthis is my mup setup:\n```\nmodule.exports = {\n  servers: {\n    one: {\n      host: \"ip_address\",\n      username: \"root\",\n      pem: \"path/to/pem\"\n    }\n  },\nmeteor: {\n    name: 'my-app',\n    path: '../',\n    servers: {\n      one: {}\n    },\n    buildOptions: {\n      serverOnly: true,\n      debug: false,\n      cleanAfterBuild: true\n    },\n    env: {\n      ROOT_URL: 'https://domain.com',\n      MONGO_URL: 'mongodb://mongodb/meteor',\n      MONGO_OPLOG_URL: 'mongodb://mongodb/local'\n    },\n    docker: {\n      image: 'zodern/meteor:root',\n    },\n    deployCheckWaitTime: 120,\n    enableUploadProgressBar: true\n  },\nproxy: {\n    domains: 'domain.com, .domain.com, domain2.com, .domain2.com',\n    ssl: {\n      crt: './ssl/fullchain.pem',\n      key: './ssl/privkey.pem'\n    }\n  },\nmongo: {\n    oplog: true,\n    port: 27017,\n    version: '3.4.2',\n    servers: {\n      one: {}\n    }\n  }\n};\n```\n. UPDATE:\nI managed to solve it!\nHere the solution for anybody who run into this..\nThe trick was to define a shared proxy host under SHARED object, which will then support all of incoming hosts under the domain. \nI used the main subdomain which is the one our app is sitting on (it serves all other subdomains) and not the root domain and everything is working perfectly.\nthis is the added code that fixed it:\nproxy: {\n    domains: 'mainsubdomain.domain.com',\n    ssl: {\n        crt: './ssl/fullchain.pem',\n        key: './ssl/privkey.pem'\n    },\n    shared: {\n        env: {\n            DEFAULT_HOST: 'mainsubdomain.domain.com'\n        }\n    }\n},. ",
    "rexhumus": "Hi Zodern, \nMany thanks for getting back to me.\nMy app does not use a .env file but rather puts all its settings in the mup.js & settings.json files.\nI was under the impression that all the SSL confguration settings from the mup.js file is read and passed onto the docker container to be built with every deployment.\nBasically i just need the tlsv1 setting to be removed from the built docker container post deployment.\nCould i add some parameters to mup.js to run a bespoke script to reset the nginx config and reload, post deployment? if so how?\nWould really really appreciate your insight as this is the first time im attempting this.\nMy mup.js is as follows.\n`module.exports = {\n  servers: {\n    one: {\n      host: \"XXX.XXX.XXX.XXX\",\n      \"username\": \"USERNAME\",\n      \"password\": \"PASSWORD\",\n        opts: {\n            port: 22,\n        }\n    }\n  },\nmeteor: {\n    name: 'NAME',\n    path: '../PATH',\n    servers: {\n      one: {}\n    },\nbuildOptions: {\n  serverOnly: true,\n},\n\nenv: {\n  \"ROOT_URL\": \"http://MY.APPLICATION.com\",\n  \"MONGO_URL\": \"mongodb://ENTIRE.MONGO.DB.URL\"\n},\n\n\"ssl\": {\n  \"crt\": \"./ssl.crt\",\n  \"key\": \"./key.pem\",\n  \"port\": 443 \n},\n\ndockerImage: 'abernix/meteord:base',\ndeployCheckWaitTime: 180\n\n}\n};\n`. Hi @zodern ,\nThank you very much for your help. I have tried adding the line to the environment variable like you suggested and have tried many other parameters that have not yielded any change.\nIm still grappling with TLSv1 as attached.\n\nWould appreciate if you could give me any direction whatsover.\nMany thanks again.. ",
    "TechStacker": "@guillim yeah, I tried with pem and without, it gives me the same error :( \n. At this point I can deploy without problems if I do the following before mup setup and mup deploy:\nssh-add -K /Users/davidt/.ssh/my-app_id\nIf I don't do the above, I get this on mup setup:\n```\nStarted TaskList: Setup Docker\n[138.197.207.118] - Setup Docker\nevents.js:183\n      throw er; // Unhandled 'error' event\n      ^\nError: All configured authentication methods failed\n    at tryNextAuth (/Users/davidt/.nvm/versions/node/v8.11.3/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2/lib/client.js:290:17)\n    at SSH2Stream.onUSERAUTH_FAILURE (/Users/davidt/.nvm/versions/node/v8.11.3/lib/node_modules/mup/node_modules/nodemiral/node_modules/ssh2/lib/client.js:469:5)\n    at emitTwo (events.js:126:13)\n    at SSH2Stream.emit (events.js:214:7)\n    at parsePacket (/Users/davidt/.nvm/versions/node/v8.11.3/lib/node_modules/mup/node_modules/ssh2-streams/lib/ssh.js:3647:10)\n    at SSH2Stream._transform (/Users/davidt/.nvm/versions/node/v8.11.3/lib/node_modules/mup/node_modules/ssh2-streams/lib/ssh.js:551:13)\n    at SSH2Stream.Transform._read (_stream_transform.js:186:10)\n    at SSH2Stream._read (/Users/davidt/.nvm/versions/node/v8.11.3/lib/node_modules/mup/node_modules/ssh2-streams/lib/ssh.js:212:15)\n    at SSH2Stream.Transform._write (_stream_transform.js:174:12)\n    at doWrite (_stream_writable.js:397:12)\n    at writeOrBuffer (_stream_writable.js:383:5)\n    at SSH2Stream.Writable.write (_stream_writable.js:290:11)\n    at Socket.ondata (_stream_readable.js:639:20)\n    at emitOne (events.js:116:13)\n    at Socket.emit (events.js:211:7)\n    at addChunk (_stream_readable.js:263:12)\n```\nI have no clue why I have to do this, but if anyone has some advice, I'd appreciate it! :). ",
    "MathiasKandelborg": "I'm on the sidelines. We've also tried adding the password the key in the file. Same error again.\nIt seems like the ssh-agent does not like something. The error messages really aren't that helpful when it comes to SSH. \nThe problem started happening after an OS update. \nThis exact app has gotten deployed before and the problem didn't exist a few weeks ago.\nI use the exact same MUP setup and I can deploy without problems. The only difference is that I'm on Ubuntu 18.04. That was also my first thought. Thinking that it could have been a problem regarding the ssh-agent itself. But no, the ability to connect to the server with the ssh-agent was a-ok! So...\nIt took several hours of non-stop trying different things. Finally concluding that some permissions weren't correct regarding the node installation.\nThe reason this went sour was a wrong configuration on the computer, I'm not sure how to handle that. Perhaps some documentation should be written, which I'd also gladly do.\nOn a side note: The error handling around SSH'ing is of course extremely hard to get right. If you got a suggestion on a PR I could make - I'd happily try my best.\n. @guillim Dude, we fixed it.. ",
    "adamjgriffith": "Im trying to figure this out as well.\nI have successfully used buildInstructions toapt-get install the required dependencies. However a runaway amount of Chrome processes are created. The solution recommended by Puppeteer is to add these instructions to your docker file.\nhttps://github.com/GoogleChrome/puppeteer/blob/master/docs/troubleshooting.md#running-puppeteer-in-docker\nBut I cant figure out if these commands are possible with meteor-up especially the last 4.\nCould you provide any assistance?\n. ",
    "nabiltntn": "Hi @IDCOLL ,\nI have build 2 custom docker images based on meteord with 8.11.2 node version\nhttps://hub.docker.com/r/nabiltntn/meteord-node-with-chromium/tags\n8.11.2_dumb-init starts the application with dumb-init to avoid having plenty of zombies process after browser execution.. You need to change the image. No addtional build instructions.\nMeteor 1.6 is compatible with Node 8, so it should work fine.\n. Yes i usally use :\njs\nconst browser = await puppeteer.launch({\n      args: [\n        '--no-sandbox',\n        '--disable-setuid-sandbox',\n        '--disable-webgl',\n        '--disable-accelerated-2d-canvas',\n        '--disable-gpu'\n      ]\n    });. ",
    "Jaggar": "Solved it: you have to login to your remote server run this command \n\nsudo usermod -a -G docker $USER\n\nthen log out of the server then run the usual commands mup setup and mup deploy. ",
    "danbugs": "Did some stuff. Now the error is this:\n```\nStarted TaskList: Configuring App\n[54.214.101.98] - Pushing the Startup Script\n[54.214.101.98] - Pushing the Startup Script: SUCCESS\n[54.214.101.98] - Sending Environment Variables\n[54.214.101.98] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[54.214.101.98] - Start Meteor\n[54.214.101.98] - Start Meteor: SUCCESS\n[54.214.101.98] - Verifying Deployment\n[54.214.101.98] x Verifying Deployment: FAILED\n      ------------------------------------STDERR------------------------------------\n      5)\n    at [object Object].MongoConnection._ensureIndex (packages/mongo/mongo_driver.js:791:1)\n    at [object Object].Mongo.Collection._ensureIndex (packages/mongo/collection.js:631:1)\n    at setupUsersCollection (accounts_server.js:1413:9)\n    at new AccountsServer (accounts_server.js:49:5)\n    at Package (globals_server.js:5:12)\n    at /bundle/bundle/programs/server/packages/accounts-base.js:1813:4\n    at /bundle/bundle/programs/server/packages/accounts-base.js:1824:3\n    at /bundle/bundle/programs/server/boot.js:242:10\n    at Array.forEach (native)\n    - - - - -\n    at Object.toError (/bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/utils.js:114:11)\n    at __executeInsertCommand (/bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/db.js:1926:27)\n    at Db._executeInsertCommand (/bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/db.js:2028:5)\n    at /bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/db.js:1348:12\n    at /bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/db.js:1442:20\n    at /bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/db.js:1196:16\n    at /bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/db.js:1905:9\n    at Server.Base._callHandler (/bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/connection/base.js:453:41)\n    at /bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/connection/server.js:488:18\n    at [object Object].MongoReply.parseBody (/bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/responses/mongo_reply.js:68:5)\nFound /bundle/bundle.tar.gz\nmode of 'bundle.tar.gz' retained as 0777 (rwxrwxrwx)\n=> Extracting bundle\n=> Setting node version\nNODE_VERSION=0.10.48\nv0.10.48 is already installed.\nNow using node v0.10.48 (npm v3.10.10)\nNow using node v0.10.48 (npm v3.10.10)\n=> Installing npm dependencies\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\n=> Starting meteor app on port 80\n\n/bundle/bundle/programs/server/node_modules/fibers/future.js:278\n                        throw(ex);\n                              ^\nMongoError: driver is incompatible with this server version\n    at Object.Future.wait (/bundle/bundle/programs/server/node_modules/fibers/future.js:398:15)\n    at [object Object].MongoConnection._ensureIndex (packages/mongo/mongo_driver.js:791:1)\n    at [object Object].Mongo.Collection._ensureIndex (packages/mongo/collection.js:631:1)\n    at setupUsersCollection (accounts_server.js:1413:9)\n    at new AccountsServer (accounts_server.js:49:5)\n    at Package (globals_server.js:5:12)\n    at /bundle/bundle/programs/server/packages/accounts-base.js:1813:4\n    at /bundle/bundle/programs/server/packages/accounts-base.js:1824:3\n    at /bundle/bundle/programs/server/boot.js:242:10\n    at Array.forEach (native)\n    - - - - -\n    at Object.toError (/bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/utils.js:114:11)\n    at __executeInsertCommand (/bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/db.js:1926:27)\n    at Db._executeInsertCommand (/bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/db.js:2028:5)\n    at /bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/db.js:1348:12\n    at /bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/db.js:1442:20\n    at /bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/db.js:1196:16\n    at /bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/db.js:1905:9\n    at Server.Base._callHandler (/bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/connection/base.js:453:41)\n    at /bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/connection/server.js:488:18\n    at [object Object].MongoReply.parseBody (/bundle/bundle/programs/server/npm/npm-mongo/node_modules/mongodb/lib/mongodb/responses/mongo_reply.js:68:5)\n\n      ------------------------------------STDOUT------------------------------------\n      Container has no IP Address, likely from the app crashing.\nContainer has no IP Address, likely from the app crashing.\nContainer has no IP Address, likely from the app crashing.\nContainer has no IP Address, likely from the app crashing.\nContainer has no IP Address, likely from the app crashing.\nContainer has no IP Address, likely from the app crashing.\nContainer has no IP Address, likely from the app crashing.\nContainer has no IP Address, likely from the app crashing.\nContainer has no IP Address, likely from the app crashing.\nContainer has no IP Address, likely from the app crashing.\n=> Container status:\nrestarted: 7 times {\"Bridge\":\"\",\"SandboxID\":\"f6d43d3e2aef517bba995ebb9e93e237a49cb014343e1bc9cd71891d34245b30\",\"HairpinMode\":false,\"LinkLocalIPv6Address\":\"\",\"LinkLocalIPv6PrefixLen\":0,\"Ports\":{},\"SandboxKey\":\"/var/run/docker/netns/f6d43d3e2aef\",\"SecondaryIPAddresses\":null,\"SecondaryIPv6Addresses\":null,\"EndpointID\":\"\",\"Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"MacAddress\":\"\",\"Networks\":{\"bridge\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"e4eea6686df1ab9b26e9497cdb932525d962fb71fbeffe30109e72b48408e971\",\"EndpointID\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"\",\"DriverOpts\":null}}} {\"Status\":\"restarting\",\"Running\":true,\"Paused\":false,\"Restarting\":true,\"OOMKilled\":false,\"Dead\":false,\"Pid\":0,\"ExitCode\":8,\"Error\":\"\",\"StartedAt\":\"2018-08-01T04:17:38.85605397Z\",\"FinishedAt\":\"2018-08-01T04:17:44.776277227Z\"}\n=> Logs:\n\nTo see more logs type 'mup logs --tail=200'\n\n\n      ------------------------------------------------------------------------------\n\n```. Hey @zodern , \nI was actually just about to update this issue saying I fixed it. I believe the problem was an incompatibility between my Meteor version (1.2) and MongoDB (3.4.1). I updated Meteor to 1.4 and all ran smoothly! \nThanks a lot!. Oh, and my meteor version is 1.4. Just tested, now the same error occurs with mup setup\n```bash\nStarted TaskList: Setup Docker\n[54.214.101.98] - Setup Docker\nevents.js:183\n      throw er; // Unhandled 'error' event\n      ^\nError: connect ETIMEDOUT 54.214.101.98:22\n    at Object._errnoException (util.js:992:11)\n    at _exceptionWithHostPort (util.js:1014:20)\n    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1186:14)\n```. Figured it out! \nMy security group was missing an SSH rule for port 22! \nClosing the thread!. Hey @zodern ,\nThanks for the reply! I've now tried starting a new instance and installed MongoDB 3.2 (I've used Meteor 1.4 with MongoDB 3.2 before) and I am still getting the same error.\nNow, as the error says:\nFailed to connect to 172.17.0.2 port 80: Connection refused\nAnd, knowing that 172.17.0.2 is docker, I thought that maybe port 80 was being occupied by another process. However, if I run sudo netstat -tulnp | grep 80, I get:\ntcp6       0      0 :::80                   :::*                    LISTEN      11360/docker-proxy\nThis, makes me think that it is all ok 'cause that is the docker proxy and it is how it should be... Right?\nAgain, any help is really really appreciated.\nThanks in advance,\nchiarld.. Two remarks:\n1) If you still think the issue is that Meteor 1.4 shouldn't be compatible with MongoDB 3.2, I think we have a problem 'cause I don't think MongoDB  3.0 is even compatible with Ubuntu 16.04 because we need Ubuntu Xenial and it is not even mentioned in the documentation.\n2) I've tried killing the process with kill -9 and running mup deploy again but that didn't change anything and the docker-proxy process just restarted.\n. 1) Yes. Previously, I deployed with: \nmongo: {\n    port: 27017,\n    servers: {\n      one: {}\n    }\n  },\nSetting up the internal database and it all worked fine. \n2) Now, I am able to access it in my local machine but cannot deploy it and access by any chance. . Just so we don't have any doubts, I created a new instance of Ubuntu 14.04 and installed MongoDB 3.0.\nTried deploying again and... Same error.\n```\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[34.214.24.216] - Pushing Meteor App Bundle to the Server\n[34.214.24.216] - Pushing Meteor App Bundle to the Server: SUCCESS\n[34.214.24.216] - Prepare Bundle\nroot: Pulling from zodern/meteor\n683abbb4ea60: Pulling fs layer\n1526103d811d: Pulling fs layer\na43023c48852: Pulling fs layer\n62a6dd4e87ff: Pulling fs layer\n6f52b23cb025: Pulling fs layer\ned373a06b889: Pulling fs layer\nfeab372ed4a1: Pulling fs layer\n031353f8d8f3: Pulling fs layer\n6ce21d2ee906: Pulling fs layer\n116ab6f4eef5: Pulling fs layer\nf09d0cdb1f11: Pulling fs layer\n62a6dd4e87ff: Waiting\n6f52b23cb025: Waiting\ned373a06b889: Waiting\nfeab372ed4a1: Waiting\n031353f8d8f3: Waiting\n6ce21d2ee906: Waiting\n116ab6f4eef5: Waiting\nf09d0cdb1f11: Waiting\na43023c48852: Verifying Checksum\na43023c48852: Download complete\n62a6dd4e87ff: Verifying Checksum\n62a6dd4e87ff: Download complete\n683abbb4ea60: Verifying Checksum\n683abbb4ea60: Download complete\n1526103d811d: Verifying Checksum\n1526103d811d: Download complete\n6f52b23cb025: Verifying Checksum\n6f52b23cb025: Download complete\ned373a06b889: Verifying Checksum\ned373a06b889: Download complete\n683abbb4ea60: Pull complete\n031353f8d8f3: Verifying Checksum\n031353f8d8f3: Download complete\n6ce21d2ee906: Verifying Checksum\n6ce21d2ee906: Download complete\nfeab372ed4a1: Verifying Checksum\nfeab372ed4a1: Download complete\n1526103d811d: Pull complete\n116ab6f4eef5: Verifying Checksum\n116ab6f4eef5: Download complete\na43023c48852: Pull complete\n62a6dd4e87ff: Pull complete\n6f52b23cb025: Pull complete\ned373a06b889: Pull complete\nf09d0cdb1f11: Verifying Checksum\nf09d0cdb1f11: Download complete\nfeab372ed4a1: Pull complete\n031353f8d8f3: Pull complete\n6ce21d2ee906: Pull complete\n116ab6f4eef5: Pull complete\nf09d0cdb1f11: Pull complete\nDigest: sha256:94388cd430fcad65bdeaeee831e409aee5ed62456cb8364c764d867a07564f77\nStatus: Downloaded newer image for zodern/meteor:root\nFinished Extracting\nCreating Dockerfile\nFinished creating Dockerfile\nBuilding image\nSending build context to Docker daemon  56.79MB\nStep 1/6 : FROM zodern/meteor:root\nExecuting 5 build triggers\n---> Running in 4a6c3282477c\nRemoving intermediate container 4a6c3282477c\n ---> Running in 6dd1f246f1a5\nRemoving intermediate container 6dd1f246f1a5\n ---> Running in 15a3de89cdaf\nNODE_VERSION=4.8.4\nv4.8.4 is already installed.\nNow using node v4.8.4 (npm v3.10.10)\nNow using node v4.8.4 (npm v3.10.10)\nRemoving intermediate container 15a3de89cdaf\n ---> Running in 13eb85c886bc\nRemoving intermediate container 13eb85c886bc\n ---> Running in b4fb7f18f939\nRemoving intermediate container b4fb7f18f939\n ---> 84844e62de1b\nStep 2/6 : RUN mkdir /built_app || true\n ---> Running in 77412769dac7\nmkdir: cannot create directory '/built_app': File exists\nRemoving intermediate container 77412769dac7\n ---> e8c858f5b5b3\nStep 3/6 : ENV ROOT_URL=http://www.dani.lol\n ---> Running in ac0bed5b6c58\nRemoving intermediate container ac0bed5b6c58\n ---> 5528e8cefc89\nStep 4/6 : ENV MONGO_URL=mongodb://chiarld:lea640vd@34.214.24.216:27017/meteor\n ---> Running in d120440ef69c\nRemoving intermediate container d120440ef69c\n ---> f0cb11df9477\nStep 5/6 : COPY ./ /built_app\n ---> e22bbb09661b\nStep 6/6 : RUN cd  /built_app/programs/server &&     npm install --unsafe-perm\n ---> Running in a872197094a1\n\nfibers@1.0.13 install /built_app/programs/server/node_modules/fibers\nnode build.js || nodejs build.js\n\nlinux-x64-v8-4.5 exists; testing\nBinary is fine; exiting\n\nmeteor-dev-bundle@0.0.0 install /built_app/programs/server\nnode npm-rebuild.js\nbcrypt@0.8.7 install /built_app/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt\nnode-gyp rebuild\n\nmake: Entering directory '/built_app/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt/build'\n  CXX(target) Release/obj.target/bcrypt_lib/src/blowfish.o\n  CXX(target) Release/obj.target/bcrypt_lib/src/bcrypt.o\n  CXX(target) Release/obj.target/bcrypt_lib/src/bcrypt_node.o\n  SOLINK_MODULE(target) Release/obj.target/bcrypt_lib.node\n  COPY Release/bcrypt_lib.node\nmake: Leaving directory '/built_app/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt/build'\nbcrypt@0.8.7 /built_app/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bcrypt\nbindings@1.2.1 /built_app/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/bindings\nnan@2.3.5 /built_app/programs/server/npm/node_modules/meteor/npm-bcrypt/node_modules/nan\n\nbson@0.2.21 install /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/bson\n(node-gyp rebuild 2> builderror.log) || (exit 0)\n\nmake: Entering directory '/built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/bson/build'\n  CXX(target) Release/obj.target/bson/ext/bson.o\nbson.target.mk:94: recipe for target 'Release/obj.target/bson/ext/bson.o' failed\nmake: Leaving directory '/built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/bson/build'\n\nkerberos@0.0.9 install /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/kerberos\n(node-gyp rebuild 2> builderror.log) || (exit 0)\n\nmake: Entering directory '/built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/kerberos/build'\n  CXX(target) Release/obj.target/kerberos/lib/kerberos.o\nkerberos.target.mk:100: recipe for target 'Release/obj.target/kerberos/lib/kerberos.o' failed\nmake: Leaving directory '/built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/kerberos/build'\ngridfs-stream@0.5.3 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/gridfs-stream\nmongodb@1.4.35 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb\nbson@0.2.21 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/bson\nnan@1.7.0 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/bson/node_modules/nan\nkerberos@0.0.9 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/kerberos\nnan@1.6.2 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/kerberos/node_modules/nan\nreadable-stream@1.0.33 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/readable-stream\ncore-util-is@1.0.1 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/readable-stream/node_modules/core-util-is\nisarray@0.0.1 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/readable-stream/node_modules/isarray\nstring_decoder@0.10.31 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/readable-stream/node_modules/string_decoder\ninherits@2.0.1 /built_app/programs/server/npm/node_modules/meteor/cfs_gridfs/node_modules/mongodb/node_modules/readable-stream/node_modules/inherits\n{\n  \"meteor-dev-bundle\": \"0.0.0\",\n  \"npm\": \"3.10.10\",\n  \"ares\": \"1.10.1-DEV\",\n  \"http_parser\": \"2.7.0\",\n  \"icu\": \"56.1\",\n  \"modules\": \"46\",\n  \"node\": \"4.8.4\",\n  \"openssl\": \"1.0.2k\",\n  \"uv\": \"1.9.1\",\n  \"v8\": \"4.5.103.47\",\n  \"zlib\": \"1.2.11\"\n}\nmeteor-dev-bundle@0.0.0 /built_app/programs/server\n+-- amdefine@1.0.0 \n+-- ansi-regex@0.2.1 \n+-- ansi-styles@1.1.0 \n+-- asap@2.0.4 \n+-- chalk@0.5.1 \n+-- eachline@2.3.3 \n+-- escape-string-regexp@1.0.5 \n+-- fibers@1.0.13 \n+-- has-ansi@0.1.0 \n+-- meteor-promise@0.7.2 \n+-- promise@7.1.1 \n+-- semver@4.1.0 \n+-- source-map@0.1.32 \n+-- source-map-support@0.3.2 \n+-- strip-ansi@0.3.0 \n+-- supports-color@0.2.0 \n+-- type-of@2.0.1 \n`-- underscore@1.5.2 \nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\nRemoving intermediate container a872197094a1\n ---> 718eb6dee87b\nSuccessfully built 718eb6dee87b\nSuccessfully tagged mup-danilol:build\nError response from daemon: No such image: mup-danilol:latest\nTotal reclaimed space: 0B\n[34.214.24.216] - Prepare Bundle: SUCCESS\nStarted TaskList: Configuring App\n[34.214.24.216] - Pushing the Startup Script\n[34.214.24.216] - Pushing the Startup Script: SUCCESS\n[34.214.24.216] - Sending Environment Variables\n[34.214.24.216] - Sending Environment Variables: SUCCESS\nStarted TaskList: Start Meteor\n[34.214.24.216] - Start Meteor\nusing image\nError: No such image: mup-danilol:previous\nImage mup-danilol:latest\nVolume\nRemoving docker containers. Errors about nonexistent endpoints and containers are normal.\nError: No such container: danilol\nError response from daemon: endpoint danilol not found\nError: No such container: danilol-frontend\nError response from daemon: endpoint danilol-frontend not found\nError: No such container: danilol-nginx-letsencrypt\nError response from daemon: endpoint danilol-nginx-letsencrypt not found\nError: No such container: danilol-nginx-proxy\nError response from daemon: endpoint danilol-nginx-proxy not found\nFinished removing docker containers\n96c44ab1d896ac34b91a21edbd3a2c779a4a881eba80bf948383ddc01e58185a\nRan zodern/meteor:root\n[34.214.24.216] - Start Meteor: SUCCESS\n[34.214.24.216] - Verifying Deployment\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n=> Container status:\nrestarted: 0 times {\"Bridge\":\"\",\"SandboxID\":\"14e369aa846ef3e8164436da821e040fc00a23444dc952ba314df275bf34df93\",\"HairpinMode\":false,\"LinkLocalIPv6Address\":\"\",\"LinkLocalIPv6PrefixLen\":0,\"Ports\":{\"3000/tcp\":null,\"80/tcp\":[{\"HostIp\":\"0.0.0.0\",\"HostPort\":\"80\"}]},\"SandboxKey\":\"/var/run/docker/netns/14e369aa846e\",\"SecondaryIPAddresses\":null,\"SecondaryIPv6Addresses\":null,\"EndpointID\":\"5bf27857504a0be38735b6e21d5add367749f801ad2ca1303f24351f96a8aa93\",\"Gateway\":\"172.17.0.1\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"IPAddress\":\"172.17.0.2\",\"IPPrefixLen\":16,\"IPv6Gateway\":\"\",\"MacAddress\":\"02:42:ac:11:00:02\",\"Networks\":{\"bridge\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"a11d76669d689ec56545183b9cf289c6bc283c5c398bd57c325f8a3afd65571c\",\"EndpointID\":\"5bf27857504a0be38735b6e21d5add367749f801ad2ca1303f24351f96a8aa93\",\"Gateway\":\"172.17.0.1\",\"IPAddress\":\"172.17.0.2\",\"IPPrefixLen\":16,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"02:42:ac:11:00:02\",\"DriverOpts\":null}}} {\"Status\":\"running\",\"Running\":true,\"Paused\":false,\"Restarting\":false,\"OOMKilled\":false,\"Dead\":false,\"Pid\":8106,\"ExitCode\":0,\"Error\":\"\",\"StartedAt\":\"2018-08-02T17:23:28.487828214Z\",\"FinishedAt\":\"0001-01-01T00:00:00Z\"}\n=> Logs:\n=> Setting node version\nNODE_VERSION=4.8.4\nv4.8.4 is already installed.\nNow using node v4.8.4 (npm v3.10.10)\nNow using node v4.8.4 (npm v3.10.10)\n=> Starting meteor app on port 80\nTo see more logs type 'mup logs --tail=200'\n[34.214.24.216] x Verifying Deployment: FAILED\n      ------------------------------------STDERR------------------------------------\n       port 80: Connection refused\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\n0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                     Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                     Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                     Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                     Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                     Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                     Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                     Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                     Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                     Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                     Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                     Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                     Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (7) Failed to connect to 172.17.0.2 port 80: Connection refused\n    => Setting node version\n    NODE_VERSION=4.8.4\n    v4.8.4 is already installed.\n    Now using node v4.8.4 (npm v3.10.10)\n    Now using node v4.8.4 (npm v3.10.10)\n    => Starting meteor app on port 80\n      ------------------------------------STDOUT------------------------------------\n      => Container status:\nrestarted: 0 times {\"Bridge\":\"\",\"SandboxID\":\"14e369aa846ef3e8164436da821e040fc00a23444dc952ba314df275bf34df93\",\"HairpinMode\":false,\"LinkLocalIPv6Address\":\"\",\"LinkLocalIPv6PrefixLen\":0,\"Ports\":{\"3000/tcp\":null,\"80/tcp\":[{\"HostIp\":\"0.0.0.0\",\"HostPort\":\"80\"}]},\"SandboxKey\":\"/var/run/docker/netns/14e369aa846e\",\"SecondaryIPAddresses\":null,\"SecondaryIPv6Addresses\":null,\"EndpointID\":\"5bf27857504a0be38735b6e21d5add367749f801ad2ca1303f24351f96a8aa93\",\"Gateway\":\"172.17.0.1\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"IPAddress\":\"172.17.0.2\",\"IPPrefixLen\":16,\"IPv6Gateway\":\"\",\"MacAddress\":\"02:42:ac:11:00:02\",\"Networks\":{\"bridge\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"a11d76669d689ec56545183b9cf289c6bc283c5c398bd57c325f8a3afd65571c\",\"EndpointID\":\"5bf27857504a0be38735b6e21d5add367749f801ad2ca1303f24351f96a8aa93\",\"Gateway\":\"172.17.0.1\",\"IPAddress\":\"172.17.0.2\",\"IPPrefixLen\":16,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"02:42:ac:11:00:02\",\"DriverOpts\":null}}} {\"Status\":\"running\",\"Running\":true,\"Paused\":false,\"Restarting\":false,\"OOMKilled\":false,\"Dead\":false,\"Pid\":8106,\"ExitCode\":0,\"Error\":\"\",\"StartedAt\":\"2018-08-02T17:23:28.487828214Z\",\"FinishedAt\":\"0001-01-01T00:00:00Z\"}\n=> Logs:\n\nTo see more logs type 'mup logs --tail=200'\n\n\n      ------------------------------------------------------------------------------\n\n```. ",
    "poojabansal": "I am facing the same issue. @OptimisticLock were you able to resolve it?. @zodern  here is the output: \n```mup deploy --verbose\nBuilding App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[52.88.204.190] - Pushing Meteor App Bundle to the Server\n[52.88.204.190] - Pushing Meteor App Bundle to the Server: SUCCESS\n[52.88.204.190] - Prepare Bundle\nnode-8.4.0-base: Pulling from abernix/meteord\nDigest: sha256:04f44cf999da383d11de77027ced8b70818222c9890a405ce10803af3ee5a642\nStatus: Image is up to date for abernix/meteord:node-8.4.0-base\nFinished Extracting\nCreating Dockerfile\nFinished creating Dockerfile\nBuilding image\nSending build context to Docker daemon  37.35MB\nStep 1/6 : FROM abernix/meteord:node-8.4.0-base\nExecuting 1 build trigger\n---> Using cache\n ---> ea65e57bd001\nStep 2/6 : RUN mkdir /built_app || true\n ---> Using cache\n ---> 2a21fd573c45\nStep 3/6 : ENV ROOT_URL=http://abcd.xyz.com\n ---> Using cache\n ---> 6f9db5757535\nStep 4/6 : ENV MONGO_URL=mongodb://mongodb:27017/abcdefg\n ---> Using cache\n ---> caf0c7557b26\nStep 5/6 : COPY ./ /built_app\n ---> 2452c811ba23\nStep 6/6 : RUN cd  /built_app/programs/server &&     npm install --unsafe-perm\n ---> Running in ee240878c02c\nnpm WARN read-shrinkwrap This version of npm is compatible with lockfileVersion@1, but npm-shrinkwrap.json was generated for lockfileVersion@0. I'll try to do my best with it!\nWARN notice [SECURITY] semver has the following vulnerability: 1 moderate. Go here for more details: https://nodesecurity.io/advisories?search=semver&version=4.1.0 - Run npm i npm@latest -g to upgrade your npm version, and then npm audit to get more info.\n\nfibers@1.0.5 install /built_app/programs/server/node_modules/fibers\nnode ./build.js\n\n(node:37) [DEP0006] DeprecationWarning: child_process: options.customFds option is deprecated. Use options.stdio instead.\nmake: Entering directory '/built_app/programs/server/node_modules/fibers/build'\n  CXX(target) Release/obj.target/fibers/src/fibers.o\n../src/fibers.cc:48:34: error: 'WeakCallbackData' in namespace 'v8' does not name a template type\n  void WeakCallbackShim(const v8::WeakCallbackData& data) {\n                                  ^\n../src/fibers.cc:48:50: error: expected ',' or '...' before '<' token\n  void WeakCallbackShim(const v8::WeakCallbackData& data) {\n                                                  ^\n../src/fibers.cc: In function 'void uni::WeakCallbackShim(int)':\n../src/fibers.cc:49:5: error: 'data' was not declared in this scope\n   F(data.GetParameter());\n     ^\n../src/fibers.cc: In function 'v8::Handle uni::NewLatin1String(v8::Isolate, const char)':\n../src/fibers.cc:101:64: warning: 'static v8::Local v8::String::NewFromOneByte(v8::Isolate, const uint8_t, v8::String::NewStringType, int)' is deprecated (declared at /root/.node-gyp/8.4.0/include/node/v8.h:2624): Use maybe version [-Wdeprecated-declarations]\n   return String::NewFromOneByte(isolate, (const uint8_t)string);\n                                                                ^\n../src/fibers.cc: In function 'v8::Handle uni::NewLatin1Symbol(v8::Isolate, const char)':\n../src/fibers.cc:105:64: warning: 'static v8::Local v8::String::NewFromOneByte(v8::Isolate, const uint8_t, v8::String::NewStringType, int)' is deprecated (declared at /root/.node-gyp/8.4.0/include/node/v8.h:2624): Use maybe version [-Wdeprecated-declarations]\n   return String::NewFromOneByte(isolate, (const uint8_t)string);\n                                                                ^\n../src/fibers.cc: In function 'v8::Handle uni::NewSignature(v8::Isolate, v8::Handle, int, v8::Handle)':\n../src/fibers.cc:132:54: error: no matching function for call to 'v8::Signature::New(v8::Isolate&, v8::Handle&, int&, v8::Handle&)'\n   return Signature::New(isolate, receiver, argc, argv);\n                                                      ^\n../src/fibers.cc:132:54: note: candidate is:\nIn file included from /root/.node-gyp/8.4.0/include/node/node.h:63:0,\n                 from ../src/coroutine.h:1,\n                 from ../src/fibers.cc:1:\n/root/.node-gyp/8.4.0/include/node/v8.h:5826:27: note: static v8::Local v8::Signature::New(v8::Isolate, v8::Local)\n   static Local New(\n                           ^\n/root/.node-gyp/8.4.0/include/node/v8.h:5826:27: note:   candidate expects 2 arguments, 4 provided\n../src/fibers.cc: In function 'void uni::SetResourceConstraints(v8::Isolate, v8::ResourceConstraints)':\n../src/fibers.cc:140:3: error: 'SetResourceConstraints' is not a member of 'v8'\n   v8::SetResourceConstraints(isolate, constraints);\n   ^\n../src/fibers.cc:140:3: note: suggested alternative:\n../src/fibers.cc:139:7: note:   'uni::SetResourceConstraints'\n  void SetResourceConstraints(Isolate isolate, ResourceConstraints constraints) {\n       ^\n../src/fibers.cc: In static member function 'static uni::FunctionType Fiber::New(const Arguments&)':\n../src/fibers.cc:397:99: warning: 'v8::Local v8::Function::NewInstance(int, v8::Local) const' is deprecated (declared at /root/.node-gyp/8.4.0/include/node/v8.h:3787): Use maybe version [-Wdeprecated-declarations]\n     return uni::Return(uni::Deref(Isolate::GetCurrent(), tmpl)->GetFunction()->NewInstance(1, argv), args);\n                                                                                                   ^\n../src/fibers.cc: In static member function 'static void Fiber::RunFiber(void)':\n../src/fibers.cc:588:14: warning: 'v8::TryCatch::TryCatch()' is deprecated (declared at /root/.node-gyp/8.4.0/include/node/v8.h:8157): Use isolate version [-Wdeprecated-declarations]\n     TryCatch try_catch;\n              ^\n../src/fibers.cc: In static member function 'static void Fiber::SetPoolSize(v8::Local, v8::Local, const SetterCallbackInfo&)':\n../src/fibers.cc:707:43: warning: 'v8::Local v8::Value::ToNumber() const' is deprecated (declared at /root/.node-gyp/8.4.0/include/node/v8.h:9578): Use maybe version [-Wdeprecated-declarations]\n    Coroutine::pool_size = value->ToNumber()->Value();\n                                           ^\n../src/fibers.cc: In static member function 'static void Fiber::Init(v8::Handle)':\n../src/fibers.cc:761:72: warning: 'bool v8::Object::SetAccessor(v8::Local, v8::AccessorGetterCallback, v8::AccessorSetterCallback, v8::Local, v8::AccessControl, v8::PropertyAttribute)' is deprecated (declared at /root/.node-gyp/8.4.0/include/node/v8.h:3120): Use maybe version [-Wdeprecated-declarations]\n    fn->SetAccessor(uni::NewLatin1Symbol(isolate, \"current\"), GetCurrent);\n                                                                        ^\n../src/fibers.cc:762:87: warning: 'bool v8::Object::SetAccessor(v8::Local, v8::AccessorGetterCallback, v8::AccessorSetterCallback, v8::Local, v8::AccessControl, v8::PropertyAttribute)' is deprecated (declared at /root/.node-gyp/8.4.0/include/node/v8.h:3120): Use maybe version [-Wdeprecated-declarations]\n    fn->SetAccessor(uni::NewLatin1Symbol(isolate, \"poolSize\"), GetPoolSize, SetPoolSize);\n                                                                                       ^\n../src/fibers.cc:763:84: warning: 'bool v8::Object::SetAccessor(v8::Local, v8::AccessorGetterCallback, v8::AccessorSetterCallback, v8::Local, v8::AccessControl, v8::PropertyAttribute)' is deprecated (declared at /root/.node-gyp/8.4.0/include/node/v8.h:3120): Use maybe version [-Wdeprecated-declarations]\n    fn->SetAccessor(uni::NewLatin1Symbol(isolate, \"fibersCreated\"), GetFibersCreated);\n                                                                                    ^\n../src/fibers.cc: In instantiation of 'void uni::MakeWeak(v8::Isolate, v8::Persistent&, P) [with void ( F)(void) = Fiber::WeakCallback; T = v8::Object; P = void]':\n../src/fibers.cc:315:60:   required from here\n../src/fibers.cc:54:3: error: no matching function for call to 'v8::Persistent::SetWeak(void&, )'\n   handle.SetWeak(val, WeakCallbackShim);\n   ^\n../src/fibers.cc:54:3: note: candidates are:\nIn file included from /root/.node-gyp/8.4.0/include/node/node.h:63:0,\n                 from ../src/coroutine.h:1,\n                 from ../src/fibers.cc:1:\n/root/.node-gyp/8.4.0/include/node/v8.h:544:18: note: template void v8::PersistentBase::SetWeak(P, typename v8::WeakCallbackInfo::Callback, v8::WeakCallbackType) [with P = P; T = v8::Object]\n   V8_INLINE void SetWeak(P parameter,\n                  ^\n/root/.node-gyp/8.4.0/include/node/v8.h:544:18: note:   template argument deduction/substitution failed:\n../src/fibers.cc:54:3: note:   candidate expects 3 arguments, 2 provided\n   handle.SetWeak(val, WeakCallbackShim);\n   ^\nIn file included from /root/.node-gyp/8.4.0/include/node/node.h:63:0,\n                 from ../src/coroutine.h:1,\n                 from ../src/fibers.cc:1:\n/root/.node-gyp/8.4.0/include/node/v8.h:555:18: note: void v8::PersistentBase::SetWeak() [with T = v8::Object]\n   V8_INLINE void SetWeak();\n                  ^\n/root/.node-gyp/8.4.0/include/node/v8.h:555:18: note:   candidate expects 0 arguments, 2 provided\n../src/fibers.cc: In function 'v8::Handle uni::NewSignature(v8::Isolate, v8::Handle, int, v8::Handle*)':\n../src/fibers.cc:133:2: warning: control reaches end of non-void function [-Wreturn-type]\n  }\n  ^\nfibers.target.mk:102: recipe for target 'Release/obj.target/fibers/src/fibers.o' failed\nmake: * [Release/obj.target/fibers/src/fibers.o] Error 1\nmake: Leaving directory '/built_app/programs/server/node_modules/fibers/build'\ngyp ERR! build error \ngyp ERR! stack Error: make failed with exit code: 2\ngyp ERR! stack     at ChildProcess.onExit (/opt/nodejs/lib/node_modules/npm/node_modules/node-gyp/lib/build.js:258:23)\ngyp ERR! stack     at emitTwo (events.js:125:13)\ngyp ERR! stack     at ChildProcess.emit (events.js:213:7)\ngyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:200:12)\ngyp ERR! System Linux 3.13.0-29-generic\ngyp ERR! command \"/opt/nodejs/bin/node\" \"/opt/nodejs/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js\" \"rebuild\" \"--release\"\ngyp ERR! cwd /built_app/programs/server/node_modules/fibers\ngyp ERR! node -v v8.4.0\ngyp ERR! node-gyp -v v3.6.2\ngyp ERR! not ok \nBuild failed\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\nnpm ERR! code ELIFECYCLE\nnpm ERR! errno 1\nnpm ERR! fibers@1.0.5 install: node ./build.js\nnpm ERR! Exit status 1\nnpm ERR! \nnpm ERR! Failed at the fibers@1.0.5 install script.\nnpm ERR! This is probably not a problem with npm. There is likely additional logging output above.\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     /root/.npm/_logs/2018-08-29T21_21_20_234Z-debug.log\nThe command '/bin/sh -c cd  /built_app/programs/server &&     npm install --unsafe-perm' returned a non-zero code: 1\n[52.88.204.190] x Prepare Bundle: FAILED\n      ------------------------------------STDERR------------------------------------\n      The command '/bin/sh -c cd  /built_app/programs/server &&     npm install --unsafe-perm' returned a non-zero code: 1\n\n      ------------------------------------STDOUT------------------------------------\n      v8::Object>::SetWeak(void*&, <unresolved overloaded function type>)'\n   handle.SetWeak(val, WeakCallbackShim<F>);\n   ^\n../src/fibers.cc:54:3: note: candidates are:\nIn file included from /root/.node-gyp/8.4.0/include/node/node.h:63:0,\n                 from ../src/coroutine.h:1,\n                 from ../src/fibers.cc:1:\n/root/.node-gyp/8.4.0/include/node/v8.h:544:18: note: template<class P> void v8::PersistentBase<T>::SetWeak(P*, typename v8::WeakCallbackInfo<P>::Callback, v8::WeakCallbackType) [with P = P; T = v8::Object]\n   V8_INLINE void SetWeak(P* parameter,\n                  ^\n/root/.node-gyp/8.4.0/include/node/v8.h:544:18: note:   template argument deduction/substitution failed:\n../src/fibers.cc:54:3: note:   candidate expects 3 arguments, 2 provided\n   handle.SetWeak(val, WeakCallbackShim<F>);\n   ^\nIn file included from /root/.node-gyp/8.4.0/include/node/node.h:63:0,\n                 from ../src/coroutine.h:1,\n                 from ../src/fibers.cc:1:\n/root/.node-gyp/8.4.0/include/node/v8.h:555:18: note: void v8::PersistentBase<T>::SetWeak() [with T = v8::Object]\n   V8_INLINE void SetWeak();\n                  ^\n/root/.node-gyp/8.4.0/include/node/v8.h:555:18: note:   candidate expects 0 arguments, 2 provided\n../src/fibers.cc: In function 'v8::Handle<v8::Signature> uni::NewSignature(v8::Isolate*, v8::Handle<v8::FunctionTemplate>, int, v8::Handle<v8::FunctionTemplate>*)':\n../src/fibers.cc:133:2: warning: control reaches end of non-void function [-Wreturn-type]\n  }\n  ^\nfibers.target.mk:102: recipe for target 'Release/obj.target/fibers/src/fibers.o' failed\nmake: *** [Release/obj.target/fibers/src/fibers.o] Error 1\nmake: Leaving directory '/built_app/programs/server/node_modules/fibers/build'\ngyp ERR! build error \ngyp ERR! stack Error: `make` failed with exit code: 2\ngyp ERR! stack     at ChildProcess.onExit (/opt/nodejs/lib/node_modules/npm/node_modules/node-gyp/lib/build.js:258:23)\ngyp ERR! stack     at emitTwo (events.js:125:13)\ngyp ERR! stack     at ChildProcess.emit (events.js:213:7)\ngyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:200:12)\ngyp ERR! System Linux 3.13.0-29-generic\ngyp ERR! command \"/opt/nodejs/bin/node\" \"/opt/nodejs/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js\" \"rebuild\" \"--release\"\ngyp ERR! cwd /built_app/programs/server/node_modules/fibers\ngyp ERR! node -v v8.4.0\ngyp ERR! node-gyp -v v3.6.2\ngyp ERR! not ok \nBuild failed\nnpm WARN meteor-dev-bundle@0.0.0 No description\nnpm WARN meteor-dev-bundle@0.0.0 No repository field.\nnpm WARN meteor-dev-bundle@0.0.0 No license field.\n\nnpm ERR! code ELIFECYCLE\nnpm ERR! errno 1\nnpm ERR! fibers@1.0.5 install: `node ./build.js`\nnpm ERR! Exit status 1\nnpm ERR! \nnpm ERR! Failed at the fibers@1.0.5 install script.\nnpm ERR! This is probably not a problem with npm. There is likely additional logging output above.\n\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     /root/.npm/_logs/2018-08-29T21_21_20_234Z-debug.log\n\n      ------------------------------------------------------------------------------\n\n```. @zodern I've been able to resolve the issue at my end. It was a mismatch between meteor version and docker image.. ",
    "SrimalPriyanga": "<Error>\n<Code>AccessDenied</Code>\n<Message>Access denied.</Message>\n<Details/>\n</Error>. ",
    "martineboh": "It seems creating another EC2 instance with the same inbound rules in Security Group fixed the issue. Closing issue. ",
    "parveen-oodles": "I have tested MongoDB running well on my machine.\nI have checked via typing mongo and its work.\nAlso, check via netstat -tunlp it showing me the mongod running on port 27017. Facing this issue in  x **\n\nVerifying Deployment: FAILED\n\n**\n . Thanks for your reply but I have tried with that as well. By adding the \n  mongo: {\n    version: '3.4.1',\n    servers: {\n      one: {}\n    }\n  }\nin my config file but it not worked for me.. Could you please help with the configuration of mup file.\nI want to setup it on my Amazon ec2 instance.\nWhat should I need to install or what will be the mongo URL for that?\nBecause as on local MongoDB running on +1 port of your meteor application port.\nSo please help me with the configuration.\nThanks. ",
    "Neijin": "Hi @SimonSimCity. Thank you for your response.\nI got it working by pushing from an MacOSX dev environment. Sharp is then compiled with the right NODE_VERSION on the production server. I'm clueless on how to resolve this issue on Windows and why there is a difference. \nI checked for any forgotten installation of Node 4 pretty much anywhere I could think of (this is a great reminder by the way on how to completely remove node.js from Windows).\nI already tried to remove the node_modules folder multiple times and re-install npm modules with different options. There was also an issue with the node_modules/sharp/vendor folder keeping old compiled files from previous build so it was recommended to delete it before pushing to production.. No longer an issue after a complete reset of Windows.. ",
    "lastpeony": "looks like removing        MONGO_OPLOG_URL: 'mongodb://mongodb/local',\n solved my problem. ",
    "cristiam86": "Thanks @zodern for the quick response.\nMy mup config\n    {\n      \"servers\": {\n        \"one\": {\n          \"host\": \"1.2.3.4\",\n          \"username\": \"ubuntu\",\n          \"pem\": \"~/.ssh/pem\"\n        }\n      },\n      \"proxy\": {\n        \"domains\": \"test.myproject-example.com\",\n        \"nginxServerConfig\": \"./nginx.conf\",\n        \"nginxLocationConfig\": \"./nginx.conf\"\n      },\n      \"app\": {\n        \"name\": \"my-app\",\n        \"path\": \"/Users/home/my-project\",\n        \"servers\": {\n          \"one\": {}\n        },\n        \"buildOptions\": {\n          \"serverOnly\": true\n        },\n        \"env\": {\n          \"ROOT_URL\": \"https://subdomain.host.com\",\n          \"MONGO_URL\": \"mongodb://mongodb:27017/my-app\",\n          \"VIRTUAL_HOST\": \"test.myproject-example.com,\n          \"HTTPS_METHOD\": \"noredirect\",\n          \"HTTP_FORWARDED_COUNT\": 1\n        },\n        \"docker\": {\n          \"image\": \"abernix/meteord:node-8.4.0-base\",\n          \"stopAppDuringPrepareBundle\": true,\n          \"args\": [\n            \"--link=mongodb:mongodb\"\n          ]\n        },\n        \"enableUploadProgressBar\": true,\n        \"type\": \"meteor\"\n      },\n      \"mongo\": {\n        \"version\": \"3.4.1\",\n        \"servers\": {\n          \"one\": {}\n        }\n      }\n    }\nMy nginx config file\nserver_tokens off\nmore_set_headers 'Server: my-server';\nThanks!. Hello again @zodern, sorry for the insistence on asking again. Do you have any clue on this? Would it be possible to override the nginx config with a /etc/nginx/default.conf ? \nCheers! . ",
    "JorgenVatle": "Yes, running just mup from cmd.exe with these changes should run Meteor Up as a Node instance instead of opening the config file in the Windows-assigned default program for .js files.. Oops, my apologies. Just did some testing on another system to verify. It does not seem to resolve the issue you mentioned.. I'll go ahead and close this pull request until I have a working solution in place.\nThank you for your time @zodern \ud83d\ude04 . ",
    "dc165015": "it only appears while installing npm pkg sharp. Any other pkgs work fine.. ",
    "kPanesar": "I'm getting the exact same errors after enabling SSL. Glad to know I'm not the only one.. ",
    "charlesdagenais": "Does updating the image to abernix/meteord:node-8.11.2-base is mandatory to use Meteor 1.8 with correct node version, or keeping the zodern/meteor:root still ok ?. @Twisterking \nSee here\nTry to generate your key pair with ssh-keygen -m PEM -t rsa. ",
    "boOnii": "Thank you for responding quickly. \nHere is the answer from mup proxy status: \n\n. Any ideas ?. The issue came from AWS Certificate Manager. ",
    "racosa": "Problem found:\ntodos app was using force-ssl so http was being redirected to https and I had not configured meteor-up to use SSL certificates. I ended up removing force-ssl as this deployment is just for testing purposes and now it is working.\nCan someone close this issue please?\n. ",
    "suezzo": "@cpury  I've got the same problem. Did you find a solution? . Using AWS was not an option for me. I find out that port 80 on my machine was not opened. Letsencrypt uses it to generate SSL certificate. After getting the certificate I closed this port again. The application works properly now.. ",
    "pfmziota": "I have the same problem.\nhow to reproduce\n\nCreate deploy/staging/ at the root of your project\nEnter the directory you just created and execute mup init\nEdit the file and change the path to match your relative path to the source of your application, let's say it is ../../src.\nAdd your credentials.\nAdd the buildLocation: '../../build' property in the buildOptions.\nExecute mup setup and then mup deploy from the deploy/staging directory.\n\noutput\n=> Archiving failed:  ENOENT: no such file or directory, open <path>\nError: ENOENT: no such file or directory, open '<path>'\nwhy does it do that ?\nI expect the problem to come from the way paths are built for building and deployment.\nTo build, the path is built relative to your source folder (here ../../src).\nTo deploy, the path is built relative to your deploy config (here deploy/staging/).\nSo the script builds in one folder and then expects the files to be elsewhere.\nany idea on a quickfix ?\nTwo solutions are possible :\n\nDo not create a subfolder in deploy, just create deploy-staging and deploy-live folders so that the relative path from src and deploy-live are the same (here that would be ../build).\nAnother way can be to make a symbolic link so that those paths match.\n\nremarks\nI haven't read the source code. So these observations are purely empirical.\nThe solutions proposed here are purely suggestions.. ",
    "jankapunkt": "I have the same error on MacOS but I think it is because I have to generate my keys using ssh-ed25519 which may not be supported, yet?\n. @Twisterking mey key is generated using ed25519 algorithm, which is not supported by the ssh2 module. My cloud provider however requires me to auth via ssh using keys generated using ed25519.\nA username/password combination is denied by the server as I can only login using the key via ssh -i user@server. Is there any workaround for this? . ",
    "isoceles": "I had the same issue on Mojave but got it working after many hours of trying different things. Here's what worked for me:\n\nDelete your droplet\nCreate a new key ssh-keygen -m PEM -t rsa -b 2048 -C \"<your_email_address>\" (no pass phrase)\nCopy the public key cat ~/.ssh/id_rsa.pub\nDigital Ocean > Account > Security > Add the copied SSH Key\nCreate a new droplet and select the name of the SSH key you just created. \n(optional) SSH into your droplet to test ssh root@<ip_address>\nit will say \"The authenticity of host 'IPaddress' can't be established.\" write yes\nif access is denied I'm not sure what to do but you can remove the cached key by typing ssh-keygen -R <ip_address>\nif you get access exit SSH Ctrl + d continue to next step.\n\n\n\n\nmup setup\n\nI hope this helps. Good luck!\n. ",
    "spoonfair": "Meteor 1.8..0.1\nNode 10.13.0. `Building App Bundle Locally\nStarted TaskList: Pushing Meteor App\n[18.222.XXX.XXX] - Pushing Meteor App Bundle to the Server\nevents.js:167\n      throw er; // Unhandled 'error' event\n      ^\nError: connect ETIMEDOUT 18.222.XXX.XXX:22\n    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1113:14)\nEmitted 'error' event at:\n    at Socket. (C:\\Users\\rober\\AppData\\Roaming\\npm\\node_modules\\mup\\node_modules\\nodemiral\\node_modules\\ssh2\\\nlib\\client.js:218:10)\n    at Socket.emit (events.js:187:15)\n    at emitErrorNT (internal/streams/destroy.js:82:8)\n    at emitErrorAndCloseNT (internal/streams/destroy.js:50:3)\n    at process._tickCallback (internal/process/next_tick.js:63:19)`\nI did all of the above, but I'm still getting the same error :/. For anyone who runs into the same problem, be sure to check your server's security group settings. I feel kinda silly for not noticing this. I recently moved and couldn't upload to server because the inbound setting was for a different IP. . So, prepareBundle is set to false because I had been getting the following error and saw another thread where that was a temporary fix and hadn't run into any updating issues with prepare bundle. \n```[1.2.3.4] x Prepare Bundle: FAILED\n\n          ------------------------------------STDERR------------------------------------\n          The command '/bin/sh -c cd  /built_app/programs/server &&     npm install --unsafe-perm' returned a non-ze\n\nro code: 1\n          ------------------------------------STDOUT------------------------------------\n          ersion.\n    npm WARN deprecated hoek@2.16.3: This version is no longer maintained. Please upgrade to the latest version.\n\n    > fibers@2.0.0 install /built_app/programs/server/node_modules/fibers\n    > node build.js || nodejs build.js\n\n    make: Entering directory '/built_app/programs/server/node_modules/fibers/build'\n      CXX(target) Release/obj.target/fibers/src/fibers.o\n      CXX(target) Release/obj.target/fibers/src/coroutine.o\n      CC(target) Release/obj.target/fibers/src/libcoro/coro.o\n      SOLINK_MODULE(target) Release/obj.target/fibers.node\n      COPY Release/fibers.node\n    make: Leaving directory '/built_app/programs/server/node_modules/fibers/build'\n    Installed in `/built_app/programs/server/node_modules/fibers/bin/linux-x64-46/fibers.node`\n\n    > meteor-dev-bundle@ install /built_app/programs/server\n    > node npm-rebuild.js\n\n\n    > bcrypt@3.0.2 install /built_app/programs/server/npm/node_modules/bcrypt\n    > node-pre-gyp install --fallback-to-build\n\n    /built_app/programs/server/npm/node_modules/.bin/node: 1: /built_app/programs/server/npm/node_modules/.bin/node:\n\n/../node/bin/node: not found\n    npm ERR! Linux 4.4.0-140-generic\n    npm ERR! argv \"/home/app/.nvm/versions/node/v4.8.4/bin/node\" \"/home/app/.nvm/versions/node/v4.8.4/bin/npm\" \"rebu\n\nild\" \"--update-binary\"\n        npm ERR! node v4.8.4\n        npm ERR! npm  v3.10.10\n        npm ERR! file sh\n        npm ERR! code ELIFECYCLE\n        npm ERR! errno ENOENT\n        npm ERR! syscall spawn\n        npm ERR! bcrypt@3.0.2 install: node-pre-gyp install --fallback-to-build\n        npm ERR! spawn ENOENT\n        npm ERR!\n        npm ERR! Failed at the bcrypt@3.0.2 install script 'node-pre-gyp install --fallback-to-build'.\n        npm ERR! Make sure you have the latest version of node.js and npm installed.\n        npm ERR! If you do, this is most likely a problem with the bcrypt package,\n        npm ERR! not with npm itself.\n        npm ERR! Tell the author that this fails on your system:\n        npm ERR!     node-pre-gyp install --fallback-to-build\n        npm ERR! You can get information on how to open an issue for this project with:\n        npm ERR!     npm bugs bcrypt\n        npm ERR! Or if that isn't available, you can get their info via:\n        npm ERR!     npm owner ls bcrypt\n        npm ERR! There is likely additional logging output above.\n    npm ERR! Please include the following file with any support request:\n    npm ERR!     /built_app/programs/server/npm/npm-debug.log\n\n    npm ERR! Linux 4.4.0-140-generic\n    npm ERR! argv \"/home/app/.nvm/versions/node/v4.8.4/bin/node\" \"/home/app/.onbuild-node/bin/npm\" \"install\" \"--unsa\n\nfe-perm\"\n        npm ERR! node v4.8.4\n        npm ERR! npm  v3.10.10\n        npm ERR! code ELIFECYCLE\n        npm ERR! meteor-dev-bundle@ install: node npm-rebuild.js\n        npm ERR! Exit status 1\n        npm ERR!\n        npm ERR! Failed at the meteor-dev-bundle@ install script 'node npm-rebuild.js'.\n        npm ERR! Make sure you have the latest version of node.js and npm installed.\n        npm ERR! If you do, this is most likely a problem with the meteor-dev-bundle package,\n        npm ERR! not with npm itself.\n        npm ERR! Tell the author that this fails on your system:\n        npm ERR!     node npm-rebuild.js\n        npm ERR! You can get information on how to open an issue for this project with:\n        npm ERR!     npm bugs meteor-dev-bundle\n        npm ERR! Or if that isn't available, you can get their info via:\n        npm ERR!     npm owner ls meteor-dev-bundle\n        npm ERR! There is likely additional logging output above.\n    npm ERR! Please include the following file with any support request:\n    npm ERR!     /built_app/programs/server/npm-debug.log\n\n          ------------------------------------------------------------------------------```\n\n\nI added the console.log(\"updated\") and that shows on the local host when updates are made, but not in the logs when I deploy. Logs are all the same as posted before.. ",
    "JH7": "same error for me with Meteor 1.8.0.1 and mup 1.4.5. ",
    "salazarpardo": "@SachaG @zodern Thank you both for your help! I updated Vulcan and was able to deploy my site successfully! . ",
    "alexismoreau": "When in development meteor npm install --save bcrypt in the shell doesn't show any error.\nbcrypt is indeed in the package.json file.\nAlso I can't access to the meteor shell in production, which is normal. I tried with hooks, and with docker buildInstructions but nothing works.\n. ",
    "eluck": "@zodern Sure. @zodern Merge conflicts are resolved. Ready for review and merge. ",
    "nq2916": "Previous issue is fixed by:\nLogging into the server and removing ssl containers that were created.\nmup stop container_name\nmup rm container_name\nThen back on your local server inside of your project run\nmup stop\nThen mup setup again.\nThis time everything went through fine but it's still attempting to use the Let's incrypt SSL and not Comodo SSL\nWhen I run docker ps -a\nI get \nCONTAINER ID        IMAGE                                    COMMAND                  CREATED              STATUS              PORTS                                      NAMES\n237847sjdkfj        mup-myapp:latest                         \"/bin/sh -c 'bash $M\u2026\"   About a minute ago   Up About a minute   80/tcp                                     myapp\n2342f72d230a        mongo:3.4.1                              \"/entrypoint.sh mong\u2026\"   5 minutes ago        Up 5 minutes        127.0.0.1:27017->27017/tcp                 mongodb\n43534c01c43d        jrcs/letsencrypt-nginx-proxy-companion   \"/bin/bash /app/entr\u2026\"   5 minutes ago        Up 5 minutes                                                   mup-nginx-proxy-letsencrypt\n3453db960c9f        jwilder/nginx-proxy                      \"/app/docker-entrypo\u2026\"   5 minutes ago        Up 5 minutes        0.0.0.0:80->80/tcp, 0.0.0.0:443->443/tcp   mup-nginx-proxy\nHow do I switch to use a custom SSL?. ",
    "ramirez530": "Root\n. "
}