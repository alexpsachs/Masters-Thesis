{
    "rauchg": "agreed\n. agreed\n. ",
    "davidsalazar": "negative.\n. negative.\n. ",
    "fabiomcosta": "argh\n. Yeah i like that too. Good catches.\n. yeah you do. You cant pass an undefined variable to any non-native-function. That's why $defined is not in 1.3.\n. @kamicane yeah i thought some other native functions would accept too, but yeah looks like typeof is the ONLY function that accepts an undefined value.\n. typeof(a), function right?\n. I don't wanna include a cloneObject method inside slick and ignore the parser cache... it's one of the great features it can have for being separate from the finder!\n. maybe i should add that kamicane approved it.\n. Interesting... should be considered.\n. This is in fact a problem on the Drag plugin.\nIt first tries to get the value of the left property, if its not in pixels it tries a getCoordinates, which returns the exact position of the element relative to the offsetparent, including margin and stuff like that. The margin should then be removed from the returned value, as shown here:\nhttp://jsfiddle.net/fabiomcosta/dHCXb/4/\nThank you for the report.\n. Yeah please provide a short demo on jsfiddle.\n. Looks good to me\n. ouch! Reopened...\n. IE since 4, firefox since 8, chrome, safari5 (dunno if 4 supports) opera 11.5 (dunno about less than this). All data came from the links i've sent.\n. =D\n. It shows 1 here at IE8.\nhttp://cl.ly/302s391h1b2R0I0W233O\nTheres an error there, but it looks like a jsfiddle error.\nCan anybody confirm?\n. @arian, it's because you didn't add the HTML5 shim (or shiv) and IE prior to 9 wont handle new tags correctly.\nhttp://jsfiddle.net/fabiomcosta/6qf6D/12/\n. @ryanmitchell,\nThere we found it!\nYou got Release candidate 1, and we currently have a final version of IE8.\nThat's my version:\nhttp://cl.ly/082Q2W152P0m3v3o0z1n\nTry updating your IE and telling us if everything is fine.\nThank you.\n. No problem at all!\nThank you for your contributions!\n. It's not Slick... It's how the elements are extended on IE by Mootools and the way that expandos are threated as attributes on IE. I don't agree we should fix it there since Slick is intended to be used anywhere, by any framework, and should not have anything related to mootools-core inside it.\nAgreed?\n. If this is the solution you guys think its best, than we should just stick with the current name, since renaming would probably break other people code...\n. but it will create a new global instead of removing one\n. If it's meant to be protected then we should make it clear, like doing what python does, prefixing an underscore, _uniqueId.\nA global uniqueId variable looks like trouble to me, it's kind of a regular name for a function that someone could still have on they're projects.\n. @cpojer the problem with it is that it would make the Browser module dependent on the Element module.\n. My problem was while cloning an element that had a morph effect on it and it didn't get cloned, so I had to set them again after cloning. Would an effects option make sense?\n. I prefer removing the submodule and adding the specs directly to the -core repo.\n. Looks good to me!\n\nFbio Miranda Costa\nSolucione Sistemas\nEngenheiro de interfaces\nTwitter: fabiomiranda\nhttp://solucione.info\n2011/11/24 Olmo Maldonado <\nreply@reply.github.com\n\nCorrection. git-subtree.sh is not that it'll seem as files in the repo,\nbut they actually are files in the repo. Except that subtree helps us\nseparate the history (and push that history) to and from a separate\nrepo.\nBasically it reduces the git submodule update --init and other headaches\nfor those that don't understand (or care to understand git submodules).\nI still think, though, that we shouldn't bother picking up a new technology\nuntil we really need it. We will unlikely update the runner as often as we\nupdate the specs. Therefore, we should leave the Runner as a submodule and\nreview the submodule situation a month or two in the future.\n2011/11/24 Olmo Maldonado olmo.maldonado@gmail.com\n\nI haven't mastered git-subtree, but I think that it'll seem as if the\nfiles are just in the repo, but for those with subtree will be able to\nmaintain a separate repository for others to contribute without having to\nwork through the mootools-core repo.\nSo I propose the following.\nmootools-core-specs deprecated (README updated with such information),\nand\nnot a subtree.\nmootools-runner should be kept as a submodule for the time being, but\nnow at least it'll be a submodule of the core project and not of\ncore-specs.\n2011/11/24 Fbio M. Costa <\nreply@reply.github.com\nI prefer removing the submodule and adding the specs directly to the\n-core\n\nrepo.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2134#issuecomment-2862094\n\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2134#issuecomment-2866755\n. If its going to be like this, just use Slick.uidOf, its used here already: https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L117. \n\nhttps://github.com/mootools/slick/blob/master/Source/Slick.Finder.js#L473-475\n. wait a minute... I'm afraid it wont be possible to use Slick.uidOf on window nor document at IE. Please check if everything is working fine... $uid used to work on XML nodes, as well as at the document.\n. nevermind then... It's not documented and not meant to be public... keep it :)\n. awezome!!!!!!!!!!!!! @arian++++\n. Just to link this pull request with issue #2038\n. Some important links:\nhttp://hacks.mozilla.org/2011/11/insertadjacenthtml-enables-faster-html-snippet-injection/\nhttp://updates.html5rocks.com/2011/08/insertAdjacentHTML-Everywhere\n. :+1:\n. Agreed for more.\n. ouch... @ilanle, @ibolmo was talking about creating a http://jsfiddle.net example, so we could see it happening, edit the code and probably fix it.\nCreating a jsfiddle is really straightforward.\nThank you, by the way.\n. The example is clear, thank you!\nThat is being a tough one to debug.\nJust to clarify, the problem is not at Slick.definePseudo. It's working fine.\nThe problem happens when Slick.search is called inside the custom pseudo (when calling Element.getElements). Apparently this second call interferes in the array of found elements of the first call, making it lose it's reference, which causes weird/incorrect returns.\nI don't have a fix right now. Any help will be much appreciated.\n. So, I'm gonna adding this ticket on mootools/Slick, here https://github.com/mootools/slick/issues/69. I've just fixed it by the way.\n. clone mootools-core's repo git clone git://github.com/mootools/mootools-core.git, clone Slick's repo git clone git://github.com/mootools/slick.git, copy and paste Slick's Source/Slick.Finder.js and Source/Slick.Parser.js inside Mootools' Source/Slick folder. Now use the build script included in Mootools'.\nOr you can simply replace the following lines on your mootools file: https://github.com/mootools/slick/commit/b397b1f98c654c537cc8cad15e0cc64ec6f81388#diff-3\n. @fakedarren I'll read everything again today and fix the problem. Thanks for looking into it!\n. @wdaniels just tried it out with firefox and I got no errors.\nPlease help me out here so we can solve the problem.\nMy net console on firefox 13.0.1 (and 14.0.1, just updated it) looks like this: http://cl.ly/image/2l442G2F3z3W\nMy error console just shows me a warning, that is fine. And yes, I check every checkbox so firebug should show me every error (but chrome errors, but it doesn't matter in this case). http://cl.ly/image/3J3L0Q2F3O3l\nI'm sorry for the long time it took for me to help with this issue.\n. Nice, I'll try it out when I get back home!\n. Hi @wdaniels,\nSo, now I could replicated it.\nLooks like the fact that you are serving your javascript files as \"application/x-javascript\" is the problem. When I serve them as \"text/javascript\" the page shows no errors.\nCan you serve them as \"text/javascript\"?\nAfter that, tell us so we can close the ticket.\nBest.\n. Sorry, I meant \"application/javascript\", my bad. but both \"application/javascript\" and \"text/javascript\" don't show the error message here.\nSlick insert and removes invalid javascript to test the browser capabilities so we can fix bugs on the native selector engines of the browsers.\nDo you wanna add me on gtalk so we can find the best way to solve this problem?\n. What's your proposed fix?\n. OK, that was very frustrating because I couldn't reproduce it here but I could see that your page throws the error.\nFixed here: https://github.com/mootools/slick/commit/f9503a24e69e442fa926e34ff85d1cdb874b97bd\nThank you for your support!\n. sweet!\n. argh\n. Yeah i like that too. Good catches.\n. yeah you do. You cant pass an undefined variable to any non-native-function. That's why $defined is not in 1.3.\n. @kamicane yeah i thought some other native functions would accept too, but yeah looks like typeof is the ONLY function that accepts an undefined value.\n. typeof(a), function right?\n. I don't wanna include a cloneObject method inside slick and ignore the parser cache... it's one of the great features it can have for being separate from the finder!\n. maybe i should add that kamicane approved it.\n. Interesting... should be considered.\n. This is in fact a problem on the Drag plugin.\nIt first tries to get the value of the left property, if its not in pixels it tries a getCoordinates, which returns the exact position of the element relative to the offsetparent, including margin and stuff like that. The margin should then be removed from the returned value, as shown here:\nhttp://jsfiddle.net/fabiomcosta/dHCXb/4/\nThank you for the report.\n. Yeah please provide a short demo on jsfiddle.\n. Looks good to me\n. ouch! Reopened...\n. IE since 4, firefox since 8, chrome, safari5 (dunno if 4 supports) opera 11.5 (dunno about less than this). All data came from the links i've sent.\n. =D\n. It shows 1 here at IE8.\nhttp://cl.ly/302s391h1b2R0I0W233O\nTheres an error there, but it looks like a jsfiddle error.\nCan anybody confirm?\n. @arian, it's because you didn't add the HTML5 shim (or shiv) and IE prior to 9 wont handle new tags correctly.\nhttp://jsfiddle.net/fabiomcosta/6qf6D/12/\n. @ryanmitchell,\nThere we found it!\nYou got Release candidate 1, and we currently have a final version of IE8.\nThat's my version:\nhttp://cl.ly/082Q2W152P0m3v3o0z1n\nTry updating your IE and telling us if everything is fine.\nThank you.\n. No problem at all!\nThank you for your contributions!\n. It's not Slick... It's how the elements are extended on IE by Mootools and the way that expandos are threated as attributes on IE. I don't agree we should fix it there since Slick is intended to be used anywhere, by any framework, and should not have anything related to mootools-core inside it.\nAgreed?\n. If this is the solution you guys think its best, than we should just stick with the current name, since renaming would probably break other people code...\n. but it will create a new global instead of removing one\n. If it's meant to be protected then we should make it clear, like doing what python does, prefixing an underscore, _uniqueId.\nA global uniqueId variable looks like trouble to me, it's kind of a regular name for a function that someone could still have on they're projects.\n. @cpojer the problem with it is that it would make the Browser module dependent on the Element module.\n. My problem was while cloning an element that had a morph effect on it and it didn't get cloned, so I had to set them again after cloning. Would an effects option make sense?\n. I prefer removing the submodule and adding the specs directly to the -core repo.\n. Looks good to me!\n\nFbio Miranda Costa\nSolucione Sistemas\nEngenheiro de interfaces\nTwitter: fabiomiranda\nhttp://solucione.info\n2011/11/24 Olmo Maldonado <\nreply@reply.github.com\n\nCorrection. git-subtree.sh is not that it'll seem as files in the repo,\nbut they actually are files in the repo. Except that subtree helps us\nseparate the history (and push that history) to and from a separate\nrepo.\nBasically it reduces the git submodule update --init and other headaches\nfor those that don't understand (or care to understand git submodules).\nI still think, though, that we shouldn't bother picking up a new technology\nuntil we really need it. We will unlikely update the runner as often as we\nupdate the specs. Therefore, we should leave the Runner as a submodule and\nreview the submodule situation a month or two in the future.\n2011/11/24 Olmo Maldonado olmo.maldonado@gmail.com\n\nI haven't mastered git-subtree, but I think that it'll seem as if the\nfiles are just in the repo, but for those with subtree will be able to\nmaintain a separate repository for others to contribute without having to\nwork through the mootools-core repo.\nSo I propose the following.\nmootools-core-specs deprecated (README updated with such information),\nand\nnot a subtree.\nmootools-runner should be kept as a submodule for the time being, but\nnow at least it'll be a submodule of the core project and not of\ncore-specs.\n2011/11/24 Fbio M. Costa <\nreply@reply.github.com\nI prefer removing the submodule and adding the specs directly to the\n-core\n\nrepo.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2134#issuecomment-2862094\n\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2134#issuecomment-2866755\n. If its going to be like this, just use Slick.uidOf, its used here already: https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L117. \n\nhttps://github.com/mootools/slick/blob/master/Source/Slick.Finder.js#L473-475\n. wait a minute... I'm afraid it wont be possible to use Slick.uidOf on window nor document at IE. Please check if everything is working fine... $uid used to work on XML nodes, as well as at the document.\n. nevermind then... It's not documented and not meant to be public... keep it :)\n. awezome!!!!!!!!!!!!! @arian++++\n. Just to link this pull request with issue #2038\n. Some important links:\nhttp://hacks.mozilla.org/2011/11/insertadjacenthtml-enables-faster-html-snippet-injection/\nhttp://updates.html5rocks.com/2011/08/insertAdjacentHTML-Everywhere\n. :+1:\n. Agreed for more.\n. ouch... @ilanle, @ibolmo was talking about creating a http://jsfiddle.net example, so we could see it happening, edit the code and probably fix it.\nCreating a jsfiddle is really straightforward.\nThank you, by the way.\n. The example is clear, thank you!\nThat is being a tough one to debug.\nJust to clarify, the problem is not at Slick.definePseudo. It's working fine.\nThe problem happens when Slick.search is called inside the custom pseudo (when calling Element.getElements). Apparently this second call interferes in the array of found elements of the first call, making it lose it's reference, which causes weird/incorrect returns.\nI don't have a fix right now. Any help will be much appreciated.\n. So, I'm gonna adding this ticket on mootools/Slick, here https://github.com/mootools/slick/issues/69. I've just fixed it by the way.\n. clone mootools-core's repo git clone git://github.com/mootools/mootools-core.git, clone Slick's repo git clone git://github.com/mootools/slick.git, copy and paste Slick's Source/Slick.Finder.js and Source/Slick.Parser.js inside Mootools' Source/Slick folder. Now use the build script included in Mootools'.\nOr you can simply replace the following lines on your mootools file: https://github.com/mootools/slick/commit/b397b1f98c654c537cc8cad15e0cc64ec6f81388#diff-3\n. @fakedarren I'll read everything again today and fix the problem. Thanks for looking into it!\n. @wdaniels just tried it out with firefox and I got no errors.\nPlease help me out here so we can solve the problem.\nMy net console on firefox 13.0.1 (and 14.0.1, just updated it) looks like this: http://cl.ly/image/2l442G2F3z3W\nMy error console just shows me a warning, that is fine. And yes, I check every checkbox so firebug should show me every error (but chrome errors, but it doesn't matter in this case). http://cl.ly/image/3J3L0Q2F3O3l\nI'm sorry for the long time it took for me to help with this issue.\n. Nice, I'll try it out when I get back home!\n. Hi @wdaniels,\nSo, now I could replicated it.\nLooks like the fact that you are serving your javascript files as \"application/x-javascript\" is the problem. When I serve them as \"text/javascript\" the page shows no errors.\nCan you serve them as \"text/javascript\"?\nAfter that, tell us so we can close the ticket.\nBest.\n. Sorry, I meant \"application/javascript\", my bad. but both \"application/javascript\" and \"text/javascript\" don't show the error message here.\nSlick insert and removes invalid javascript to test the browser capabilities so we can fix bugs on the native selector engines of the browsers.\nDo you wanna add me on gtalk so we can find the best way to solve this problem?\n. What's your proposed fix?\n. OK, that was very frustrating because I couldn't reproduce it here but I could see that your page throws the error.\nFixed here: https://github.com/mootools/slick/commit/f9503a24e69e442fa926e34ff85d1cdb874b97bd\nThank you for your support!\n. sweet!\n. ",
    "kamicane": "nein!\n. closed.\n. > bq!\n. some code here, var x = 10\n. closed.\n. This solves nothing. You get the error when you try to pass an undefined variable, not when it is compared to null.\n$defined is there to check if the value of a defined variable is undefined or null.\n. yes, though I personally like to check this.varName. But that's just me.\n. fabiomcosta: you cant pass an undefined variable anywhere, native or no native.\n. You're not passing it anywhere. It's not a function call.\n. typeof is a special operator that can also be used with a function notation. It is not a function.\n. -i-like-cookies is the expected and correct output for ILikeCookies. Remember that these methods are for code, not for content.\nYou can take the vendor prefixes in css as an example of what this method is for. WebkitBoxShadow needs to evaluate to -webkit-box-shadow.\n. that is a bug in the docs :)\n. Slow or not, using try/catch in a method that gets called multiple times is not an acceptable solution under any circumstance, unless it's a very specific and weird browser bug, in which case it must be documented.\n. i approve\n. No it should not.\n. Object.keys uses hasOwnProperty (per spec) therefore it doesn't work on inherited objects.\n. incidentally, this also breaks prototyping :)\n. Firefox 12 was just released, and it fixes the issue. It's safe to assume every Firefox 11 user will update to 12, since now updates are so easy. That said, I have nothing against this fix being included (atleast for some time).\n. Whops, I assumed wrong. Seems this is not fixed in 12 yet.\n. Try to style opacity before fading using MooTools, rather than css. I believe MooTools sets a flag somewhere, because of how opacity is implemented in IE.\n. It's entirely possible.\nRemove Fx (and Element.Styles) from your build, include moofx, include the adapter, and it's done.\nThe adapter for mootools: https://gist.github.com/kamicane/2238266#file-moofx-mootools-js\n. If MooTools is to support browsers that are < ie9, it should definitely provide a patched Object.forEach / each. Reason: constructor, toString, valueOf, and other properties set as non-iterable.\nExamples:\nhttps://github.com/mout/mout/blob/v0.1.0/src/object/forIn.js#L6\nhttps://github.com/lodash/lodash/blob/2.4.1/dist/lodash.compat.js#L85\nhttps://github.com/kamicane/prime/blob/master/index.js#L21\n. nein!\n. closed.\n. > bq!\n. some code here, var x = 10\n. closed.\n. This solves nothing. You get the error when you try to pass an undefined variable, not when it is compared to null.\n$defined is there to check if the value of a defined variable is undefined or null.\n. yes, though I personally like to check this.varName. But that's just me.\n. fabiomcosta: you cant pass an undefined variable anywhere, native or no native.\n. You're not passing it anywhere. It's not a function call.\n. typeof is a special operator that can also be used with a function notation. It is not a function.\n. -i-like-cookies is the expected and correct output for ILikeCookies. Remember that these methods are for code, not for content.\nYou can take the vendor prefixes in css as an example of what this method is for. WebkitBoxShadow needs to evaluate to -webkit-box-shadow.\n. that is a bug in the docs :)\n. Slow or not, using try/catch in a method that gets called multiple times is not an acceptable solution under any circumstance, unless it's a very specific and weird browser bug, in which case it must be documented.\n. i approve\n. No it should not.\n. Object.keys uses hasOwnProperty (per spec) therefore it doesn't work on inherited objects.\n. incidentally, this also breaks prototyping :)\n. Firefox 12 was just released, and it fixes the issue. It's safe to assume every Firefox 11 user will update to 12, since now updates are so easy. That said, I have nothing against this fix being included (atleast for some time).\n. Whops, I assumed wrong. Seems this is not fixed in 12 yet.\n. Try to style opacity before fading using MooTools, rather than css. I believe MooTools sets a flag somewhere, because of how opacity is implemented in IE.\n. It's entirely possible.\nRemove Fx (and Element.Styles) from your build, include moofx, include the adapter, and it's done.\nThe adapter for mootools: https://gist.github.com/kamicane/2238266#file-moofx-mootools-js\n. If MooTools is to support browsers that are < ie9, it should definitely provide a patched Object.forEach / each. Reason: constructor, toString, valueOf, and other properties set as non-iterable.\nExamples:\nhttps://github.com/mout/mout/blob/v0.1.0/src/object/forIn.js#L6\nhttps://github.com/lodash/lodash/blob/2.4.1/dist/lodash.compat.js#L85\nhttps://github.com/kamicane/prime/blob/master/index.js#L21\n. ",
    "kassens": "minor doc error fixed (closed by 6883e6890cc765d3187a3f3460051ef254ac04dd)\n. I like this commit. (not tested)\n. It's actually Element.Prototype in 1.2.5\nhttp://github.com/mootools/mootools-core/blob/3e7459c/Source/Element/Element.js#L46\n. The thing is that ES5 defines a second argument, we can't shim. I'm not sure it's a good idea to add a not fully functional Object.create?\n. Throwing an error when the second argument is passed would be ok for me.\n. I personally like what javelin does. It just defines if(__DEV__) { } blocks which are removed from the production version. This could be extended for more variables and static expressions like if(__IE__ < 8) {}. I'll probably try to implement that at some point. It's way cleaner than these blocks.\nExample: https://github.com/epriestley/javelin/blob/master/src/core/util.js#L190-196\n. LGTM\n. Can you create a test case on http://jsfiddle.net/ ? I couldn't reproduce your issue.\n. minor doc error fixed (closed by 6883e6890cc765d3187a3f3460051ef254ac04dd)\n. I like this commit. (not tested)\n. It's actually Element.Prototype in 1.2.5\nhttp://github.com/mootools/mootools-core/blob/3e7459c/Source/Element/Element.js#L46\n. The thing is that ES5 defines a second argument, we can't shim. I'm not sure it's a good idea to add a not fully functional Object.create?\n. Throwing an error when the second argument is passed would be ok for me.\n. I personally like what javelin does. It just defines if(__DEV__) { } blocks which are removed from the production version. This could be extended for more variables and static expressions like if(__IE__ < 8) {}. I'll probably try to implement that at some point. It's way cleaner than these blocks.\nExample: https://github.com/epriestley/javelin/blob/master/src/core/util.js#L190-196\n. LGTM\n. Can you create a test case on http://jsfiddle.net/ ? I couldn't reproduce your issue.\n. ",
    "ghost": "The correct way to do this is the following...\nel.readOnly = true;\nNote; that readOnly is case sensitive, so readonly = true will fail.\n. In 1.4.5,  this.options.onXyz ends up undefined.\nIf I change the option name, or just lowercase the third letter, I get back the passed-in callback function normally.\nI agree it doesn't make sense when reading the code in Class.Extras.js !?\n. So the question became why was 'addEvent' defined while Events was not implemented in the class...\n...until I discovered it was implemented from outside the class definition, much further down the code.\nThanks Arian & sorry for this non-issue.\n. It was just my intention to state that the reference of this could also be passed as an argument into the closure. It was not about how to name the argument. window was just an obvious guess. I agree that global would make more sense since there is a server build as well.\n. Hi,\nmy browser is IE9 on Windows7Pro, no problem on chrome. I think is because IE doesn't support email type, but IMO neither IE should throw an error, should it? Can i post here the example? it's one line:\n[code]\nnew Element('input', {type: 'email'});\n[/code]\n. Hmm..it's very strange! I have modified my mootools js like in my commit, and it works fine:\nhttp://jsfiddle.net/PAn3S/3/\nRunning the fiddle with IE11 it shows the correct values! You can see the source (minified) here: http://dev.powersport.it/js/mootools-core-1.4.5.js\n. The correct way to do this is the following...\nel.readOnly = true;\nNote; that readOnly is case sensitive, so readonly = true will fail.\n. In 1.4.5,  this.options.onXyz ends up undefined.\nIf I change the option name, or just lowercase the third letter, I get back the passed-in callback function normally.\nI agree it doesn't make sense when reading the code in Class.Extras.js !?\n. So the question became why was 'addEvent' defined while Events was not implemented in the class...\n...until I discovered it was implemented from outside the class definition, much further down the code.\nThanks Arian & sorry for this non-issue.\n. It was just my intention to state that the reference of this could also be passed as an argument into the closure. It was not about how to name the argument. window was just an obvious guess. I agree that global would make more sense since there is a server build as well.\n. Hi,\nmy browser is IE9 on Windows7Pro, no problem on chrome. I think is because IE doesn't support email type, but IMO neither IE should throw an error, should it? Can i post here the example? it's one line:\n[code]\nnew Element('input', {type: 'email'});\n[/code]\n. Hmm..it's very strange! I have modified my mootools js like in my commit, and it works fine:\nhttp://jsfiddle.net/PAn3S/3/\nRunning the fiddle with IE11 it shows the correct values! You can see the source (minified) here: http://dev.powersport.it/js/mootools-core-1.4.5.js\n. ",
    "fakedarren": "This needs to be logged in Lighthouse if not already addressed.\nhttps://mootools.lighthouseapp.com/dashboard\n. Fixed in latest commit.\n. I agree, this is bad API, if we were ever to add such a feature it would be a new method called removeClasses().\n. n00b\n. I did test, yes. It fires when you choose 'work offline' / 'work online' from the menu (which is the expected behaviour). It's not actually going online / offline (which was what I thought it was).\n. This has been fixed as part of https://github.com/mootools/mootools-core/pull/2151\n. ++, reality and acceptance of standards (regardless of how stupid the method names are) FTW\n. I approve, should we not add a note in the docs too?\n. Looking forward to a documentation contribution from your good self!\n. Closing as per https://github.com/mootools/mootools-core/issues/2129\n. Adding this to Core would be a bad idea. If, in your specific use case, you need to detect a specific device like this, you can easily add it in your own code.\n. @csuwldcat - as said before, I like this, but we can't pull this with 'unknown' in the commit history. I'm closing this pull request, but if you resubmit it with named commits then it will definitely be pulled.\nTa\nDarren\n. Closing due to wontfix status and age and new stuff (prime/elements)\n. getComputedStyle should always return a px value, we can't change this or we would affect backwards compatibility.\n. We've already marked this as wontfix, and I can't condone UA sniffing. So closing.\n. Closing as it's wontfix\n. We can't change this in case this is expected behaviour.\nIf there's a pull request to go with it then we can re-open this.\n. None, see https://github.com/mootools/mootools-core/pull/2343 +1 would like\n. YES\n. iirc it is a shim to allow native HTML5 canvas fish in < IE9 using some kind of mad plugin. Could be wrong though - about 4 years since I last used it\n. @arian YES! Also a Silverlight helper. Please make this a priority and include it in Core over other less useful features like event delegation or hardware accelerated animations.\n. With Java duh\nAnyway back on topic - Swiff out of Core, yes please +1 would vote again\nOn 16 Feb 2012, at 21:56, Arian Stolwijk wrote:\n\nHW accelerated animations with the Silverlight I assume?\nOn Thu, Feb 16, 2012 at 10:54 PM, Darren Waddell <\nreply@reply.github.com\n\nwrote:\n@arian YES! Also a Silverlight helper. Please make this a priority and\ninclude it in Core over other less useful features like event delegation or\nhardware accelerated animations.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4010330\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4010361\n. @kentaromiura pull request pls :)\n. Yeah, by design, we can't change this, it would break too many older scripts\n. There was a change in functionality in 1.4.0 which has since been reverted.\n. Need an example of this happening before we can fix\n. See https://github.com/kamicane/moofx\n. I can't pull this since docs have changed since then, but would still want to attribute you to this change. Can you resubmit with latest docs?\n\nClosing for now\n. Closed as per https://github.com/mootools/mootools-core/pull/2386\n. Hoping this would have been fixed by Chrome. It's an IE check (the code mentioned) so we kinda need it.\n. @fabiomcosta - can we check for IE<9 by looking at XMLHttpRequest or something?\n. Unfortunately we can't remove this - a lot of scripts (for example, mine!) rely on this header to check if the call has been made with Ajax or not.\nYou would need to modify the headers yourself using the headers option if you are having issues, I understand the problem but as I said we can't break this behaviour, it would cause too many problems for people upgrading.\n. This is expected behaviour, you always have to use fireEvent() (or a method that calls it for you) to trigger functionality added with addEvent etc.\n. wontfix\n. You're welcome to if you'd like; however, at this point we're happy with just being available (officially) via NPM.\n. It's only ever supported simple stuff so in this case, no.\n. There isn't, no.\n. HI @eighttrackmind; first thing is, you shouldn't use browser detection. We'd deprecate / remove it entirely, if we didn't owe it to legacy users to keep it.\nIf you need to detect iOS homescreen installs, use the proprietary window.navigator.standalone property.\n. Tying code to a DOM structure that deeply should be avoided, so if you need to write a chain like that, it's probably a sign you need to refactor your code slightly to something less brittle.\nNote that we also support something called 'reverse combinators' in Slick's selector engine which allows you to 'reverse' CSS selectors, docs are here.\nInstead of a long chain you could then instead use a more elegant getElement() with a pseudo-CSS selector.\nTo reiterate though, heavy dependency to a DOM structure in the way you describe should be considered a code smell.\n. Option 1 gets my vote\nOn 7 Mar 2014, at 11:53, Tim Wienk notifications@github.com wrote:\n\nLet's just focus on the issue at hand, I'll update this in the Pull Request description as well:\nCurrent state (1.4.5):\nIE11 detection broken\nDesired state (1.5):\nOption 1:\nFor all builds: Differentiate between IE>=10 (Browser.ie) and IE<=11 (Browser.modernie). This is to protect people from \"just\" using Browser.ie and treating them equally bad.\nOption 2:\nFor normal build: Fix IE11 detection (i.e. all IE is once again Browser.ie). This is semantically correct.\nFor compat build: Differentiate between IE>=10 (Browser.ie) and IE<=11 (Browser.modernie). This is to make sure we don't break existing projects that (implicitly or explicitly) rely on Browser.ie being falsy for IE11.\nOption 3:\nFor all builds: Fix IE11 detection (i.e. all IE is once again Browser.ie). Breaking change, so this is not feasible, the compat build should remain compatible.\nSo: either Option 1 or Option 2.\n\u2014\nReply to this email directly or view it on GitHub.\n. I like it. Gzipped the code will be next to nothing, and promises are pretty much required nowadays.\n+1 from me. It makes a good blog post!\n. This needs to be logged in Lighthouse if not already addressed.\n\nhttps://mootools.lighthouseapp.com/dashboard\n. Fixed in latest commit.\n. I agree, this is bad API, if we were ever to add such a feature it would be a new method called removeClasses().\n. n00b\n. I did test, yes. It fires when you choose 'work offline' / 'work online' from the menu (which is the expected behaviour). It's not actually going online / offline (which was what I thought it was).\n. This has been fixed as part of https://github.com/mootools/mootools-core/pull/2151\n. ++, reality and acceptance of standards (regardless of how stupid the method names are) FTW\n. I approve, should we not add a note in the docs too?\n. Looking forward to a documentation contribution from your good self!\n. Closing as per https://github.com/mootools/mootools-core/issues/2129\n. Adding this to Core would be a bad idea. If, in your specific use case, you need to detect a specific device like this, you can easily add it in your own code.\n. @csuwldcat - as said before, I like this, but we can't pull this with 'unknown' in the commit history. I'm closing this pull request, but if you resubmit it with named commits then it will definitely be pulled.\nTa\nDarren\n. Closing due to wontfix status and age and new stuff (prime/elements)\n. getComputedStyle should always return a px value, we can't change this or we would affect backwards compatibility.\n. We've already marked this as wontfix, and I can't condone UA sniffing. So closing.\n. Closing as it's wontfix\n. We can't change this in case this is expected behaviour.\nIf there's a pull request to go with it then we can re-open this.\n. None, see https://github.com/mootools/mootools-core/pull/2343 +1 would like\n. YES\n. iirc it is a shim to allow native HTML5 canvas fish in < IE9 using some kind of mad plugin. Could be wrong though - about 4 years since I last used it\n. @arian YES! Also a Silverlight helper. Please make this a priority and include it in Core over other less useful features like event delegation or hardware accelerated animations.\n. With Java duh\nAnyway back on topic - Swiff out of Core, yes please +1 would vote again\nOn 16 Feb 2012, at 21:56, Arian Stolwijk wrote:\n\nHW accelerated animations with the Silverlight I assume?\nOn Thu, Feb 16, 2012 at 10:54 PM, Darren Waddell <\nreply@reply.github.com\n\nwrote:\n@arian YES! Also a Silverlight helper. Please make this a priority and\ninclude it in Core over other less useful features like event delegation or\nhardware accelerated animations.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4010330\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4010361\n. @kentaromiura pull request pls :)\n. Yeah, by design, we can't change this, it would break too many older scripts\n. There was a change in functionality in 1.4.0 which has since been reverted.\n. Need an example of this happening before we can fix\n. See https://github.com/kamicane/moofx\n. I can't pull this since docs have changed since then, but would still want to attribute you to this change. Can you resubmit with latest docs?\n\nClosing for now\n. Closed as per https://github.com/mootools/mootools-core/pull/2386\n. Hoping this would have been fixed by Chrome. It's an IE check (the code mentioned) so we kinda need it.\n. @fabiomcosta - can we check for IE<9 by looking at XMLHttpRequest or something?\n. Unfortunately we can't remove this - a lot of scripts (for example, mine!) rely on this header to check if the call has been made with Ajax or not.\nYou would need to modify the headers yourself using the headers option if you are having issues, I understand the problem but as I said we can't break this behaviour, it would cause too many problems for people upgrading.\n. This is expected behaviour, you always have to use fireEvent() (or a method that calls it for you) to trigger functionality added with addEvent etc.\n. wontfix\n. You're welcome to if you'd like; however, at this point we're happy with just being available (officially) via NPM.\n. It's only ever supported simple stuff so in this case, no.\n. There isn't, no.\n. HI @eighttrackmind; first thing is, you shouldn't use browser detection. We'd deprecate / remove it entirely, if we didn't owe it to legacy users to keep it.\nIf you need to detect iOS homescreen installs, use the proprietary window.navigator.standalone property.\n. Tying code to a DOM structure that deeply should be avoided, so if you need to write a chain like that, it's probably a sign you need to refactor your code slightly to something less brittle.\nNote that we also support something called 'reverse combinators' in Slick's selector engine which allows you to 'reverse' CSS selectors, docs are here.\nInstead of a long chain you could then instead use a more elegant getElement() with a pseudo-CSS selector.\nTo reiterate though, heavy dependency to a DOM structure in the way you describe should be considered a code smell.\n. Option 1 gets my vote\nOn 7 Mar 2014, at 11:53, Tim Wienk notifications@github.com wrote:\n\nLet's just focus on the issue at hand, I'll update this in the Pull Request description as well:\nCurrent state (1.4.5):\nIE11 detection broken\nDesired state (1.5):\nOption 1:\nFor all builds: Differentiate between IE>=10 (Browser.ie) and IE<=11 (Browser.modernie). This is to protect people from \"just\" using Browser.ie and treating them equally bad.\nOption 2:\nFor normal build: Fix IE11 detection (i.e. all IE is once again Browser.ie). This is semantically correct.\nFor compat build: Differentiate between IE>=10 (Browser.ie) and IE<=11 (Browser.modernie). This is to make sure we don't break existing projects that (implicitly or explicitly) rely on Browser.ie being falsy for IE11.\nOption 3:\nFor all builds: Fix IE11 detection (i.e. all IE is once again Browser.ie). Breaking change, so this is not feasible, the compat build should remain compatible.\nSo: either Option 1 or Option 2.\n\u2014\nReply to this email directly or view it on GitHub.\n. I like it. Gzipped the code will be next to nothing, and promises are pretty much required nowadays.\n+1 from me. It makes a good blog post!\n. \n",
    "cpojer": "Hello.\nPlease use our official bug tracker on lighthouse to report bugs ( https://mootools.lighthouseapp.com/projects/2706-mootools/overview ). If you do not mind, please also add a testcase where this is failing (see http://jsfiddle.net ) - Ideally using MooTools 1.3 nightly.\nThank you.\n. Please use our official ticket tracker on lighthouse: https://mootools.lighthouseapp.com/projects/2706-mootools/overview\n. We are not going to use this for 1.3. 2.0 won't have this problem.\n. Awesome.\n. I love IE.\n. Oops. Maybe I got distracted when I wanted to pull. I have it on my branch now, will be pushed to moo core very soon\n. We have removed toJSON in 1.2.5 and 1.3\n. @appden Olmo did benchmarks a year ago which showed that using the loop in newElement is actually a massive slowdown. We did actually iterate three times on every element creation in 1.2 in IE, even if no name/type/checked attribute where specified. And the each loop is not even native!\n. Awesomeness.\n. Thank you for still finding the time to work on MooTools!\n. Done.\n. Awesome!\n. Thanks!\n. This does not actually provide any noticeable performance improvement.\n. I am likely to pull this for 1.3.1 as it is not a bug fix but a code change. Have you tested this in every browser we support?\n. - Is it tested in every browser?\n- Does every bug have a spec that fails in previous versions?\n. How can you test it if there are no specs proving that they fix something?\n. Partially applied for 1.3 final: http://github.com/mootools/mootools-core/commit/1ae2b02e94d54763766295584ee10041af660ad5\n. I applied your changes for 1.3.1. Thank you!\n. Thank you!\n. Not going in\n. Valerio included them in the past few commits\n. Thank you!\n. Including this would slow down all animations heavily.\n. 1.3 uses a single timer\n. I think this is bad API. The name of the methods are called addClass and removeClass for a reason. If you want to add or remove multiple classes, separate them and call add/remove multiple times. Both methods do not imply that they are able to handle multiple classnames at once.\n. Well, you should only use a single class per call. You cannot count on future compatibility. The method name implies it adds a single, and only a single class. The documentation says it adds a single class. Anything else might change in the future.\n. Exactly, it is easy for you to provide extensions and put it on the forge. We will then see how useful it is to other users. In any case,\n['a', 'b'].each(function(className){\n    element.addClass(className);\n});\nisn't too much to ask.\n. Yeah, let's ignore this one\n. Still not sure if a slick object that is being returned by Slick.parse should not be modifiable. I believe, in terms of API, getting an object from one function (Slick.parse), modifying it and automatically and unintentionally changing the behavior of another (Slick.find) method should be strictly verboten (Solely talking Slick, not MooTools).\n. I'm waiting for input from others. I understand the issue regarding the Slick separation, however mutating function results like that should not be possible.\n. done.\n. Thank you!\n. Thank you. Have you properly tested your changes in all browsers?\n. Pulled all but the getElementById change for now. If you fix it, please open another pull req and I will push!\n. I have removed any information regarding the elements. MooTools always returns extended elements, these were not extended in earlier versions of MooTools for performance reasons.\nMooTools implies that all elements returned by MooTool functionality are extended.\nCommit: https://github.com/cpojer/mootools-core/commit/d8fc9b76934c43d9dba3678851325db13b65eda9\n. I also like the idea but @keeto's statement stands, we need to embrace all browsers, as hard as it might be. I am open for any suggestions on how to achieve this via a third-party plugin.\n. \"Guys, no offence, but I think that it's bug [...]\"\nMaybe yes, but the point is that we don't want third party plugins using this kind of code because it would break in IE. If people started to adopt setter/getters from ES5 and release their plugins on the forge they would not work in IE and as a result it would reflect bad on the community or on MooTools. This is not something we want to aspire. Code written with MooTools should work in any environment.\nI do understand your points and modifying Core for your own app is perfectly fine, you seem to be aware of all the details - so go for it!\n. We implemented this already for 1.3.1.\n. duplicate of pull request 39\n. where are the tests for this?\n. I very much dislike the browser sniffs on this. Also, I think this event is not stable, ie. DOMSubtreeModified will fire for changes on the item's contents. In this case I think a more sophisticated and better cross-browser way for this will fit into MooTools More but not into MooTools Core.\n. duplicate of pull request 39\n. Thank you for your pull request. I updated the Browser.name docs to be more useful: 145fb29af30f608b9348c3b632f3e8e9fd17b723\n. Thank you! Do you also have a test for the mootools-core-specs repository to back this up?\n. that would be awesome, can you send a pull req on mootools-core-specs please? =) thank you!\n. Closing this one in favor of pull request #46\n. how do you deal with different keyboard layouts and the differences in keydown and keypress? I don't want to have code in Core that doesn't behave the same in all environments and on different locales.\n. Any news on this one?\n. thanks!\n. Awesome.\n. Thanks! Lovely stuff!\n. way ahead of ya'\n. (and: thanks)\n. See https://mootools.lighthouseapp.com/projects/2706-mootools/tickets/1107-wrong-render-with-sethtml-for-a-select-dom-obj#ticket-1107-5\n. Given that this seems to violate the DOM spec I wonder if we should make this an optional MooTools More plugin for 2.0.\n. Maybe for 2.0 we should have Browser.IE.js that collects all the IE specific issues with appropriate packager  etc. tags. I think that would make a lot of sense, especially for a mobile specific build.\n. Yes, it only partially applies to this pull request. However, I would much more like to see this fix in 2.0, where we have a new event system and will have proper hooks to make this fix even prettier.\n. I'll close this for now, we have a ticket for this on lighthouse: https://mootools.lighthouseapp.com/projects/2706-mootools/tickets/1139-change-event-is-fired-after-blur-in-ie-and-we-are-not-normalizing-it-this-is-redonkulous-unexpected-behavior#ticket-1139-5\nI hope we can fix it for 2.0, please attach your patch to the lighthouse ticket.\n. we will have another look at this for 2.0\n. nice.\n. sweet\n. This might be included in 2.0 but would require a separate pull request.\n. even better.\n. Yeah its pretty cool, I'd definitely use it but it is not ready to give this to our users. I don't want MooTools to fail in edge cases because of possible browser issues. We should definitely add this at a later time!\n. => 2.0\n. took a while. Sorry for that. It's going into 1.4\n. Thank you!\n. Is this properly tested in all versions of IE?\n. Great work Thomas!\n. Hello,\nthank you for your pull request. Unfortunately the API you have created does not follow the MooTools style of having dedicated setter/getter methods. In addition, what you describe is already available via\njavascript\nelement.get('data-doesItWork') == 'yes';\nWe might include a more general wrapper in MooTools Core 2.0. Until then feel free to release your plugin on the MooTools Forge: http://mootools.net/forge\n. I guess I should also provide a preset for core-specs so this can be tested.\n. Suggestions by @arian and @timwienk while we discussed on IRC:\n<DOML2>, <ES5> etc. instead of <!mobile>.\nI like that a lot.\n. the advantage would be that we could run the specs for different builds without requiring a server side build process. I would however like to have a solution that works with packager right now and consider inline JS like you proposed for 2.0.\n. Continued here: https://github.com/mootools/mootools-core/pull/71\nI put the code into a branch.\n. Nice! Thanks!\n. https://github.com/mootools/mootools-core/commit/399554fc83fd460b41a53063093b82d6c464788f\nSorry arian, but when I see too many braces and too much indentation I can't sleep at nights.\n. super.\n. Thank you!\n. I dislike this API. None of our methods works like this\n. Merged. Thanks.\n. Merged\n. Hello,\nwe have fixed this issue in MooTools 1.2.5 and 1.3. Please update your code to either of these versions.\n. Fixed in 2.0\n. Yeah please provide a short demo on jsfiddle.\n. Thanks Darren, this is outstanding work and I'm looking forward to having this for 1.4. Please address some of the issues I commented inline and I'll pull asap.\n. @fakedarren you going to make any adjustments or not?\n. Thanks.\n. Have you tested this? The jsfiddle example suggests you have not because it would break when you run it (if online/offline would fire on document.body, which it does not).\nI cannot find the proper specification (if it is at all specified yet) but online/offline events have a timeStamp property which seems like the only useful event information that can be extracted. So either we set the events to 1 in Element.NativeEvents and pass no event info at all or we make a special case in Event.js for them to copy over time stamp data. Either way is fine for me even though I think I'd prefer the latter.\n. I tried it in Chrome and Firefox and neither browser fire the event on document.body. According to the specification they should fire on window, which they do.\n. Interesting enough, Firefox does fire online/offline on document.body but Chrome does not. Both fire on window.\n. Given that these events are only useful on window and we don't have any event data that we normalize I think its best just to use native functionality.\nMaybe someone wants to make a small plugin for the forge that abstracts online/offline state or whatever.\n. Thank you!\n. - There are no tests\n- This is not the implementation we are going to go with here\nWith my commit 784cf7291 all your code can be done via an external plugin. I took the liberty to rewrite your fix in a clean fashion: https://gist.github.com/1103139 (untested of course)\nWe should add this to the forge or maybe to More. If other people agree I can add this to Core 1.4, I don't feel strongly about not having it. The one thing I would require is some actual tests (in html format, for the Specs repository)\n. Ok, if you can provide proper tests, properly formatted for the core-specs repository I'll look into it and add it for 1.4.\n. As said we'll include this in Core 1.4.\nYou are right about the indexOf check, as this is in the condition it might be a perf problem. I'll fix it.\nPlease provide a test case like we have for Delegation: https://github.com/mootools/mootools-core-specs/blob/master/1.4client/Element/Element.Delegation.html\nIf you create one I'll add it to Specs and add this fix to 1.4 ASAP.\n. Updated gist: https://gist.github.com/1103139\n. I want an actual test that proves the functioning of this code like I said a few times now, I cannot add it to MooTools otherwise.\n. Yet he fails to provide me with a pull request and a proper spec. :)\n. I know, right.\n. So we can pull this specific fix and revisit for more fixes later?\n. Why is this a problem exactly?\n. Note that there are three different cases:\n1.3 without native bind: fix this one\n1.3 with native bind: \u221a\n1.2compat: ignore this\n. I'm cool with this. We should only fix 1.3 (1.2compat is non-standard anyway) and only few browsers don't have bind natively, so we should be fine :) Pull Request !\n. Oh man, Safari still doesn't have bind :o\n. Also, we can probably use\n(this && this != window)\nas an adequate check.\n@jdalton - what do you think?\n. You are right. The docs should say that this is actually an object.\nYou can do if (Browser.Plugins.Flash){ doSomething(); }\nPlease fix it and send us a pull request :)\n. Thanks ;P that was quick.\n. Way ahead of you.\n. Oh yeah, you are right. Flash is dead tho :P\n. I strongly feel that this should be internal to Element.Styles and not expose any public object. I'd agree to pulling this for 1.4 although you'd have to check with Valerio for future compatibility.\nAlso, where are all the specs? I won't pull without extensive coverage :)\n. Please next time think about these kinda things before opening a ticket in the wrong place:\n\"I can't provide a real test-case for this. But as I see it, in version 12, the animation was smooth from 0% to 100%, but in version 13 [\u2026] it simply has these random slowdowns.\"\nI don't see how you could blame a JS library for this by having such a description and no test case at all.\n. I understand that and thank you for you report. Given this is obviously a temporary browser bug it is unlikely that we are considering to fix this. Please use the ticket system on github strictly for actual things we can fix and post other stuff on the mailing list.\n@ibolmo is there a way to encourage users to only open a ticket if they have reproducible tests? I don't want us to waste time on might-be bugs.\n. What @arian said!\n. Do we have a test for this?\n. Thank you!\n. Thank you! Fixed in 983a8c792\nWe changed the behavior to only allow one single string.\n. No!\nThere is no way we can provide proper Object.create because we can't support the second argument. I really don't want Object.create in MooTools because it can't done properly. Maybe a method that uses native Object.create if available and falls back to our implementation just for the first argument\n. I think we should not worry about this. Function.prototype.create == Object.create if you include 1.2compat. It was a bad decision in the past. If you build something fresh you can drop the 1.2compat and ignore this.\n. That brings up the question whether we should make compatibility with previous versions opt-in instead of opt-out starting from 1.4. I'm voting YES!\n. This is a crazy amount of code. It used to be 10 lines.\n. LGTM.\n. Hello,\nthank you for your report. We are not likely going to implement this into MooTools Core.\nThere are a couple of implementations of this somewhere on the web, see http://mootools.net/forge/p/mootools_zencoding\nIf you need help with your own script, feel free to ask on the Mailing List: https://groups.google.com/forum/#!forum/mootools\n. Awesomeness.\n. Do not merge yet. I have not tested this in anything else but Chrome so far. I want to get your feedback, I feel this is very important and a slightly breaking change that we can all live with for 1.4.\nThe change is that set('opacity'), setOpacity, get('opacity'), getOpacity are deprecated in favor of setStyle('opacity', value) and getStyle('opacity').\nBreaking change: does not set zoom or visibility in browsers that support native opacity. Sets zoom and filter in IE. Sets visibility in browsers without opacity or filter.\nNote: Might require minor changes to More.\nWhat do you say, go!\n. Updated the diff with the changes requested by Olmo.\nI've looked into not using ternaries but given that these are multiline assignments they become quite ugly. I think ternaries are fine in this case.\nAlso added support for getOpacity if there is no filter or opacity.\nSpecs changes: https://github.com/mootools/mootools-core-specs/commit/8e9d33ca2c85c58a750dd1056e587f4e14a3bacb\nAs far as I can see we don't have any docs on setOpacity or set('opacity') or similar so we should be fine :)\n. @ibolmo @arian does this now work in all browsers that we support? :D\n. Also, let's not pull this because I updated the Specs repo on this commit to a branch. I'll happily push this once we agreed on it.\n. Someone should probably do that, I agree.\nI pushed this to mootools.\n. Thank you, this makes sense. We plan to overhaul all of the Request classes to be much better in the near future :)\n. Awesome. Thanks for the hard work. I have made a couple more changes to make the docs easier to understand (hopefully :o )\n. Sweet!\n. Hey,\nthank you for your report. This totally makes sense but we are not likely to extend String.substitute in MooTools Core. The version in MooTools Core is intended for minor use cases only.\nIf you can think of a proper Template Class or similar and want to build it, we are more than happy to add it to MooTools More :)\n. Either here: https://github.com/mootools/mootools-more\nor on the Mailing List: https://groups.google.com/forum/#!forum/mootools-users\nI think it would be better to show it with demos etc. on the mailing list so we can discuss it. Note that what I have in mind is supposed to be a fully featured template engine and not just simple text-replace.\n. If you care to do some.\n. Well I personally think we need neither >>> 0 or the TypeError. I looked at it a couple of years ago and thought it isn't worth the bytes. Those two things are really really minor edge cases which we never gave a shit about and our users never noticed.\nSo I would argue to pull the specs and the changes for 2.0 and leave it as is for 1.4 - arian do you agree? (sorry for changing my mind on this)\n. Pulling nowww.\n. Thank You!\n. I like this. What is the browser support?\n. This is really cool.\n. I've tested it in Chrome and everything is still very green.\n. @arian do you approve?\n. Does this cause any problems to keep it? If its in the standard we should keep it in (and maybe fix the spec to do feature detection for properties).\n. Don't remove it from the specs. Do feature detection and only check for it if it exists.\n. video.loop != null == supported? Does this check work?\n. ehh, 'loop' in video should be the way to detect this then I guess.\n. Done: https://github.com/mootools/mootools-core-specs/commit/f9720e2fd4525b06a5063c9b37af53024408e596\nIt doesn't hurt to keep the loop in the bools list. It'll just affect browsers that support it.\n. Yes, this is a breaking change but the move from 1.3 More to 1.4 Core is the only time we can actually do this.\nI am not against changing this to something different, here are the points to consider:\n- Consistency: In our event model, this always refers to the element that has the events attached\n- Duplication: we pass the matched element as second argument to the event listener. There is no point in having this == arguments[1]. None, at all.\n- event.target is not a valid substitute for the observer element. If anything event.target should be set to the target matched by delegation. But I don't want us to mess with event.target because other info might get lost (an element within the one matched by delegation)\nThis change does not remove anything (the second argument is still available) but it adds something.\nI'm open to suggestions.\n. I wonder why we didn't have this in the first place. I'll need to check that out.\nIn any case, this needs documentation too!\n. I don't want to pull this for now even though I think it is a valid use case and I want to have this in a later release.\nAdding this to Request would require changes to Request.JSON and Request.HTML because the option would just not do anything in those classes by default. Additionally, just having this option available in Request subclasses usually doesn't make any sense.\nI think the proper way to do this for now is to make a class like:\n```\nRequest.Raw = new Class({\n  Extends: Request,\nsuccess: function(text, xml){\n    this.onSuccess(text, xml);\n  }\n});\n```\nThis would be explicit and wouldn't touch Request!\n. You are missing the  blocks.\n. Given that you posted this on the Mailing List we can discuss it there and reopen this issue later if it turns out to be a bug.\nhttps://groups.google.com/forum/#!topic/mootools-users/5SVyCS5mHPw\n. This seems legit. I need to bring Function.from(base) back tho.\n. I'll test this in the next few days and add Function.from(base) back and then merge it so we can dance in circles!\n. Pulled here: https://github.com/mootools/mootools-core/commit/4522d61f831f278a37208a3b494d78edc6c2c312\nI squashed the commits and made a reasonable commit message.\nThank you Daniel. Great work!\n. LOL\n. Related (extremely minor) changes to More: https://github.com/cpojer/mootools-more/commit/b770231ea0eb19f56b043a61a5caa99cc87fb938\n- I think it is safe to rename the Event module name to DOMEvent and don't worry about compatibility on this one. No one is likely to explicitly require Event. People use Element.Event and implicitly require DOMEvent.\n. It is not. We prevent the default action for the event. We prevent the event. It's fine and it is shorter.\n. I'm cool with this API change even if it hurts your feelings.\nThere is no ambiguity in an object that is unlikely to ever get more complex that has three entirely differently named methods.\n. reverted :( can someone \u221a ?\n. (I'm assuming your comment approves my changes?)\n. I would much rather see this on the forge or in More so we get some time to see how it works out. If it is good, I'm not opposed to integrating part of this functionality to Core at a later time.\n. Also, thank you for your work in this area. We would just like to keep Core clean and lean. Part of the reason we haven't added CSS3 stuff to Core yet is because we want to see how it develops.\n. Also, thank you for your work in this area. We would just like to keep Core clean and lean. Part of the reason we haven't added CSS3 stuff to Core yet is because we want to see how it develops.\n. sweet.\n. fix it arian :P\n. This is the best bug report ever. Thank you very much for this very detailed guide on how to debug these problems.\nWe have fixed the first issue and we'll fix the second one soon and release 1.4.1.\nKeep it up!\n. This was an intentional change in MooTools Core 1.3. We will not change this anytime soon.\n. \u221a\n. you are the boss.\n. We will not change this for 1.4 because we are not following the standard implementation with JSON.encode and JSON.decode.\nWe will however provide an AMD compliant module for Milk (next version) that (hopefully) provides JSON.parse and JSON.stringify with single-argument implementations only. That way we don't conflict with native standards and you'll be able to use the native JSON object if you don't need our implementation.\nWe'll take care of it.\n. \u221a\n. This was an intentional breaking change in 1.4. I am sorry that our backwards compatible release didn't bring a fix for this. We'll investigate this for 1.4.1 and 1.4.2. The change was necessary because it was conflicting with people who were using css-transforms and setting visibility is also not necessary any more as most browsers support opacity natively.\nIn the future we will not implicitly set style properties if you change opacity any more so it would be best to change your application to use the new standard (use the onComplete event for animations to toggle visibility).\n. What about this change in removeProperty?\n. Oh wait, I thought setProperty uses removeAttribute too. Nevermind.\n. I am just wondering why we used to have the if else block in removeProperty.\nAlso, setProperty calls removeProperty if value == null and removeProperty calls setProperty with false. Can we do something about that?\n. ++\n. I think this is ok.\nI don't want a second argument for this. Fade should just always set visibility.\n. do we gain anything from storing method names in strings other than increasing code complexity? gzip compression should still be about the same.\n. merged ! thanks.\n. You'll need to use Element.destroy(instance.toElement);\nWe can't extend object elements in IE so there is no way to fix this.\n. This is really nice.\n. We have simplified $$ in 1.3. $$ behaves differently depending on whether you are including compatibility to 1.2 or not.\nselect elements are quite special, in IE they are a node and a collection at the same time.\nI think what you want is $(select) which returns the select element. $$ is used for selecting multiple elements.\n. Yeah we should do this.\n. element.addEvent('click:relay(a)');\nelement.fireEvent('click:relay(a)', [event, a]);\nif this inside of the relayed element refers to element and not the a tag, then this is a bug.\n. You need to know both elements and the exact string you used to attach the listener. There is no other way to do this currently and I agree there must be a way in the future. I don't think we'll get around to do this with the current event model before the next major version of the MooTools.\n. I think we got this covered for Milk.\nThere are some interesting issues though that I was not aware of, let's keep this open until we fix them for 1.4.x\n. Using fireEvent('click') breaks: http://jsfiddle.net/MnhQj/\nUsing fireEvent('click:relay(a)', [null, a]) does not work: http://jsfiddle.net/MnhQj/1/\n@arian ^\n. also, element.fireEvent('click') should not necessarily fire click:relay(a)\n. This was an oversight. Oops.\nYes, this is a permanent change.\n. Thank you! This is already fixed for 1.4.1 which should be released in the next few days.\n. Oh wow this was lame! Thanks, fixed in 6f9d4ae1bed4f0d481f8c11f69d70421b7df648a for MooTools Core 1.4.1 (out soon!)\n. Hello,\nplease ask questions on our Mailing list: https://groups.google.com/forum/#!forum/mootools-users\n. Does it work like this now?\nelement.addEvent('click:relay(a)', fire).fireEvent('click'); // fire is not executed\n. Our event model doesn't support these kinda awesome things yet. :(\n. Please show us a test case where this worked. I am confident we never had functionality like this.\nAs arian said, use on* in options and use events: {} in the Element constructor.\n. This is funny.\n. I like Element.$uid without a compromise of keeping $uid.\n. I don't see a problem here.\nStart the counter at 3 in Element.js and hardcode 1 and 2 in Browser.js, only a limited amount of duplication (inlining $uid twice in Browser.js for setting the property).\n. It doesn't make any sense to clone the contents because we store instances of classes in Element.Storage.\nIf you want to copy meta data associated with your element, use data-attributes directly on your element. In fact, at this point I consider Element.Storage to be internal to MooTools to be able to store framework-only meta-data and hide it from the user. Milk won't have Element.Storage either because it is unnecessary.\nI do like to have an options object for clone. Feel free to reopen this issue for the DOM repository.\n. No, because we store a billion different class instances. It is best to handle this yourself, or - as said - store meta-data associated with your element as data-attribute, and then you can use that for the new Morph.\n. This is how mobile safari works. It has a 300ms delay for clicks.\nCheck out http://cpojer.net/PowerTools - mootools-mobile\n. Nope, there is no reason not to have all of this be a separate Plugin. Just load mootools-mobile and it does exactly what you described.\n. well, there is a shiny builder on http://cpojer.net/PowerTools and it is integrated nicely with Packager. All the repositories can be found, forked and contributed to on GitHub.\nIf the people you are working with don't know about it and you want them to know, tell them. Spread the word. If you find that it sucks, make it better :)\n. You can either get the next or the previous using getNext and getPrevious. getSiblings is obviously plural only because it goes both ways.\n. getSiblings()[0] then\n. packager blocks? :O\n. fiiix the docs. :)\n. Yeah we can do this.\n. I like.\n. wow thank you!\n. wheeere are the speeecs?\n. Why is this still on Core and not on More?\n. Daniel, would you mind pointing me to where we agreed to add this to Core? The consensus was to add this functionality to MooTools More. Also the specs are incomplete and use the old format. Please use Jasmine Syntax and properly test the behavior of the two methods.\n. Wait, what. I never agreed to add this to Core. @arian @kamicane what do you say?\n. Please write proper tests, add a proper commit author and reopen this pull request in MooTools More. Thank You.\n. Guys, we did not shoot this down. We are actively encouraging the people involved in this change to add this piece of code to MooTools More where we want this to live for now. If it turns out that many users need and use this functionality, we will move it into MooTools Core.\nWe don't want to add code to MooTools Core that isn't used within the library or isn't absolutely essential so we don't bloat the library for everyone. Note that modularity is essential for us and we need to draw the line somewhere ;)\nIf someone sends a pull request for this functionality for MooTools More complete with documentation, proper tests and everything I'll pull it instantly.\n. @chrispitt This specific pull request was discussed months ago and the consensus was to add this to MooTools More and I don't like to reiterate on this every other week because @csuwldcat doesn't want to listen :)\nNote that String.substitute is a simple method that just does simple substitution. We never meant for it to be a templating engine and the method should not even be part of Core really. I'd like it not to change at all to be honest. For anything complex, use Handlebars, Closure Templates or whatever suits you.\nAlso, the man is just trying to serve. Valar Morghulis.\n. @fakedarren did not know about the prior discussion we had about this pull request and @arian and @kamicane have agreed to put this into More.\n. @motiontoday since you created the pull request for MooTools More, would you mind taking care of this for More? Effectively deprecating Object.getFromPath and adding Object.get/Object.set and maybe an overwrite for String.substitute. We can add a notice to the Core docs that extended behavior is available in More.\n. You have some solid reality distortion going on here.\n. @motiontoday yes, that sounds like a plan :) Once we have that, we can also add a note to String.substitute in Core that advanced behavior is available in MooTools More.\n@csuwldcat I'm a potato and I find this offensive.\n. @csuwldcat well, you can also take this and move it to More, I don't care who does it. However, you did not express interest in moving this to More.\n. Unfortunately this is a JavaScript error and there is nothing we can do about this. If you are using Web Inspector you can get much more useful error messages, open Web Inspector (Chrome or Safari) in this example: http://jsfiddle.net/M6efP/ and you will see detailed error text.\nYou should consider integrating dependency management so your files will always be included in the proper order. See http://requirejs.org/ or our own http://github.com/kamicane/packager\n. @ibolmo I don't understand how has.js would solve the issue of referencing undefined variables unless we switch to string based class names and a general class namespace.\n. Are we playing this game now? http://jsfiddle.net/M6efP/2/\n. nope.\n. @giddie the issue is that when you reference a variable that is not defined, execution of the file or function halts. If you do new Class({ Extends: SomeUndefinedVariable }), the \"new Class\" constructor does not get called at all because your JS engine fails to resolve SomeUndefinedVariable. Also see this example: http://jsfiddle.net/M6efP/2/ which will throw an error in your console.\nIf this happens, we cannot intercept this error and we are unable to throw a useful custom error message.\nAs I said in my first response, use Web Inspector and you'll get a very useful error message with file and line that helps you more than we ever could in a custom error. If your preferred debugger does not give you good output, file a bug with them describing how web inspector has better error texts. Thank you.\n. do this for 1.5? Nice.\n. I really don't see the value in this. Can we finally stop this madness?\n. If this goes in for production use it must include an error routing mechanism otherwise it is useless.\n. as @timwienk noted in #mootools-dev, this breaks extending/implementing other (constructor) functions and therefore removes a useful feature.\n. This is for More.\n. Can someone set this.Window and this.Document to null, make sure it doesn't throw in IE and send a pull-request? Seems simple.\n. this is intentional. We found that not a lot of users were using bind because of the existing pass method, so we made this change for 1.3. Bind behaves differently depending on whether you include 1.2 compatibility or not.\nYou have two options:\n- Drop compatibility to 1.2\n- Use pass instead\n. We are doing this for onAdd, onRemove and the condition. See https://github.com/mootools/mootools-core/commit/5d1eff87c01721b8fdbb125b490180a0d7e7930a If you need more fancy sugar use https://github.com/cpojer/mootools-custom-event\n. iirc the problem was that the file-scope this isn't always the global context.\n. @arian weren't there lots of crashes involved with this in IE7? Just checkin'\n. Can we please keep add/remove/toggle/hasClass methods to work on only one class name at a time?\n. Well, for one because the method names are singular and not plural. Another reason would be that support for HTML5 classList cannot be implemented as easily.\n. What is the problem with doing addClass(a).addClass(b) ?\n. You can easily add this functionality to a plugin and add it to the forge. I personally don't think the ability to add multiple classes in a single call warrants all the bloat you added to the core library. Also, your assumption is wrong in dropping these methods because they do provide useful functionality such as preventing to add a class twice.\n. I would like to stay aligned with the classList API which accepts one class name per method call. Also, the documentation you linked highlights that all APIs are more or less inconsistent in that they allow one/many classes for add/remove but only work with a single class name for has and sometimes for toggle.\n. I was more thinking about using the classList API within the MooTools class methods in browsers where it is available. For example like this: https://gist.github.com/98e4b186a7cda56b72c5 This change has a huge performance impact as can be seen here: http://hacks.mozilla.org/2010/01/classlist-in-firefox-3-6/\nI'll open a pull request for it, give me a couple of minutes :)\n. https://github.com/mootools/mootools-core/pull/2390\n. Google 'html5 classlist performance' and you'll find multiple pages hinting at performance improvements.\n. I totally did not test this in all browsers but the specs we have should cover this. Also, in modern browsers addClass, removeClass and toggleClass should throw now if the class name does not conform (ie. if it contains spaces).\nAlso note I didn't touch toggleClass because we have the 'force' option and the method uses add/remove anyway.\n. Google 'html5 classlist performance'\n. n00b, fixed.\n. So we are all happy with using a single class name per method call now, are we?\n. Haha, happy that perf backs me up then. I really didn't want the change to happen ;)\n. thank you!\n. thank you!\n. I like this a lot. @leegee would you mind amending your commit with proper MooTools coding standards? (There are too many spaces in the documentation code example and an else block belongs on the same line with the closing parenthesis of the previous block and the opening parenthesis of the else block).\nAlso, it seems to my like you could shorten the code block around defining the response. If you don't know what to do feel free to join #mootools on IRC and ping me :)\n. No, you should check this yourself in your app code.\n. I'm not entirely sure if you are trolling or not but the purpose, as the function name suggests, is to attempt executing the function and in case of an error to discard and ignore it. You either get a result or you don't. If you do want the error to show up, do not use this method. Easy.\n. sure, whynot, merge it.\n. fwiw this is possible in ES6: http://google.github.io/traceur-compiler/demo/repl.html#class%20A%20%7B%0A%20%20constructor()%20%7B%0A%20%20%20%20this.prop%20%3D%20123%3B%20%0A%20%20%7D%0A%20%20method(a)%20%7B%0A%20%20%20%20console.log(a%2C%20this.prop)%3B%20%0A%20%20%7D%0A%7D%0A%0Aclass%20B%20extends%20A%20%7B%0A%20%0A%20%20methodB()%20%7B%0A%20%20%20%20this.callMethod(super.method)%3B%0A%20%20%7D%0A%20%20%0A%20%20callMethod(fn)%20%7B%0A%20%20%09fn.call(this%2C%20'Hi!')%3B%0A%20%20%7D%0A%20%20%0A%7D%0A%0A(new%20B).methodB()%3B\nPersonally I think this pattern isn't awesome and I consider all of Core to be in complete feature-freeze so I'd advise against introducing new API. Also, getParent is a bad name and might conflict with user-code.\n. I'm not sure if we should pull this. I like the strictness about the classList API. If we allow this to fall through you'll just run into hard-to-debug issues. Also, with your change addClass(' myClass ') will still throw an error so it is kinda useless.\nI like the explicitness, however if @arian disagrees feel free to make the change.\n. Example of your code: addClass(' IamWrong ') will do the following:\nif (' IamWrong '.trim()) this.classList.add(' IamWrong'); // boom, add does not approve of whitespace.\nIt does throw because you need to do\nclassName = (className || '').trim()\n  if (className) this.classList.add(className);\nIf we are deciding not to throw, then please add || '' too, so null won't throw either. Let's just never throw at all:\nSince you are so inclined to fix this issue I would like to propose a number of other changes, for example checking for any invalid CSS class character (see: http://www.w3.org/TR/CSS21/syndata.html#characters ) - if you wanna fix something not to throw, then you gotta ensure that it doesn't throw ever. I won't accept a pull request that fixes one common case but will still throw in others (what about removeClass('ab cd') ?).\nThe change was originally made because the added performance gain of using classList vs. className far outweighs any minor differences in the exceptional case of shitty code passing shitty values.\n. ahm, wait, do we actually want to support multi classes in these methods?\n- We never actively supported it (the fact that the code supports it is a bug).\n- The documentation says it only works with a single class name.\n- The method names are singular: addClass, not addClasses\n- This is noticeably slower for the 99 % case where you only want to add a single class\nBefore this change this is what's happening:\n   => addClass('a b'); // ends up with \"a a b\"\n   => removeClass('a b') // works but removeClass('b a') doesn't\nI don't think we want to make assumptions about the order of class names of an attribute of an HTMLElement.\nI think it is far more reasonable to either:\na) add checks for the non-classList behavior that throws when calling the method with null, an empty string or an invalid class name\nb) only handle the old behavior if you are using the 1.4compat version (in this case it could just do hasClassList = false)\n. I'm very opposed to adding an API that takes a list of space separated classes. An addClasses API must take an array.\n. @SergioCrisostomo that makes me pretty proud.\n. #impact\n. I think this crashed some version of IE or something.\n. Hello.\nPlease use our official bug tracker on lighthouse to report bugs ( https://mootools.lighthouseapp.com/projects/2706-mootools/overview ). If you do not mind, please also add a testcase where this is failing (see http://jsfiddle.net ) - Ideally using MooTools 1.3 nightly.\nThank you.\n. Please use our official ticket tracker on lighthouse: https://mootools.lighthouseapp.com/projects/2706-mootools/overview\n. We are not going to use this for 1.3. 2.0 won't have this problem.\n. Awesome.\n. I love IE.\n. Oops. Maybe I got distracted when I wanted to pull. I have it on my branch now, will be pushed to moo core very soon\n. We have removed toJSON in 1.2.5 and 1.3\n. @appden Olmo did benchmarks a year ago which showed that using the loop in newElement is actually a massive slowdown. We did actually iterate three times on every element creation in 1.2 in IE, even if no name/type/checked attribute where specified. And the each loop is not even native!\n. Awesomeness.\n. Thank you for still finding the time to work on MooTools!\n. Done.\n. Awesome!\n. Thanks!\n. This does not actually provide any noticeable performance improvement.\n. I am likely to pull this for 1.3.1 as it is not a bug fix but a code change. Have you tested this in every browser we support?\n. - Is it tested in every browser?\n- Does every bug have a spec that fails in previous versions?\n. How can you test it if there are no specs proving that they fix something?\n. Partially applied for 1.3 final: http://github.com/mootools/mootools-core/commit/1ae2b02e94d54763766295584ee10041af660ad5\n. I applied your changes for 1.3.1. Thank you!\n. Thank you!\n. Not going in\n. Valerio included them in the past few commits\n. Thank you!\n. Including this would slow down all animations heavily.\n. 1.3 uses a single timer\n. I think this is bad API. The name of the methods are called addClass and removeClass for a reason. If you want to add or remove multiple classes, separate them and call add/remove multiple times. Both methods do not imply that they are able to handle multiple classnames at once.\n. Well, you should only use a single class per call. You cannot count on future compatibility. The method name implies it adds a single, and only a single class. The documentation says it adds a single class. Anything else might change in the future.\n. Exactly, it is easy for you to provide extensions and put it on the forge. We will then see how useful it is to other users. In any case,\n['a', 'b'].each(function(className){\n    element.addClass(className);\n});\nisn't too much to ask.\n. Yeah, let's ignore this one\n. Still not sure if a slick object that is being returned by Slick.parse should not be modifiable. I believe, in terms of API, getting an object from one function (Slick.parse), modifying it and automatically and unintentionally changing the behavior of another (Slick.find) method should be strictly verboten (Solely talking Slick, not MooTools).\n. I'm waiting for input from others. I understand the issue regarding the Slick separation, however mutating function results like that should not be possible.\n. done.\n. Thank you!\n. Thank you. Have you properly tested your changes in all browsers?\n. Pulled all but the getElementById change for now. If you fix it, please open another pull req and I will push!\n. I have removed any information regarding the elements. MooTools always returns extended elements, these were not extended in earlier versions of MooTools for performance reasons.\nMooTools implies that all elements returned by MooTool functionality are extended.\nCommit: https://github.com/cpojer/mootools-core/commit/d8fc9b76934c43d9dba3678851325db13b65eda9\n. I also like the idea but @keeto's statement stands, we need to embrace all browsers, as hard as it might be. I am open for any suggestions on how to achieve this via a third-party plugin.\n. \"Guys, no offence, but I think that it's bug [...]\"\nMaybe yes, but the point is that we don't want third party plugins using this kind of code because it would break in IE. If people started to adopt setter/getters from ES5 and release their plugins on the forge they would not work in IE and as a result it would reflect bad on the community or on MooTools. This is not something we want to aspire. Code written with MooTools should work in any environment.\nI do understand your points and modifying Core for your own app is perfectly fine, you seem to be aware of all the details - so go for it!\n. We implemented this already for 1.3.1.\n. duplicate of pull request 39\n. where are the tests for this?\n. I very much dislike the browser sniffs on this. Also, I think this event is not stable, ie. DOMSubtreeModified will fire for changes on the item's contents. In this case I think a more sophisticated and better cross-browser way for this will fit into MooTools More but not into MooTools Core.\n. duplicate of pull request 39\n. Thank you for your pull request. I updated the Browser.name docs to be more useful: 145fb29af30f608b9348c3b632f3e8e9fd17b723\n. Thank you! Do you also have a test for the mootools-core-specs repository to back this up?\n. that would be awesome, can you send a pull req on mootools-core-specs please? =) thank you!\n. Closing this one in favor of pull request #46\n. how do you deal with different keyboard layouts and the differences in keydown and keypress? I don't want to have code in Core that doesn't behave the same in all environments and on different locales.\n. Any news on this one?\n. thanks!\n. Awesome.\n. Thanks! Lovely stuff!\n. way ahead of ya'\n. (and: thanks)\n. See https://mootools.lighthouseapp.com/projects/2706-mootools/tickets/1107-wrong-render-with-sethtml-for-a-select-dom-obj#ticket-1107-5\n. Given that this seems to violate the DOM spec I wonder if we should make this an optional MooTools More plugin for 2.0.\n. Maybe for 2.0 we should have Browser.IE.js that collects all the IE specific issues with appropriate packager  etc. tags. I think that would make a lot of sense, especially for a mobile specific build.\n. Yes, it only partially applies to this pull request. However, I would much more like to see this fix in 2.0, where we have a new event system and will have proper hooks to make this fix even prettier.\n. I'll close this for now, we have a ticket for this on lighthouse: https://mootools.lighthouseapp.com/projects/2706-mootools/tickets/1139-change-event-is-fired-after-blur-in-ie-and-we-are-not-normalizing-it-this-is-redonkulous-unexpected-behavior#ticket-1139-5\nI hope we can fix it for 2.0, please attach your patch to the lighthouse ticket.\n. we will have another look at this for 2.0\n. nice.\n. sweet\n. This might be included in 2.0 but would require a separate pull request.\n. even better.\n. Yeah its pretty cool, I'd definitely use it but it is not ready to give this to our users. I don't want MooTools to fail in edge cases because of possible browser issues. We should definitely add this at a later time!\n. => 2.0\n. took a while. Sorry for that. It's going into 1.4\n. Thank you!\n. Is this properly tested in all versions of IE?\n. Great work Thomas!\n. Hello,\nthank you for your pull request. Unfortunately the API you have created does not follow the MooTools style of having dedicated setter/getter methods. In addition, what you describe is already available via\njavascript\nelement.get('data-doesItWork') == 'yes';\nWe might include a more general wrapper in MooTools Core 2.0. Until then feel free to release your plugin on the MooTools Forge: http://mootools.net/forge\n. I guess I should also provide a preset for core-specs so this can be tested.\n. Suggestions by @arian and @timwienk while we discussed on IRC:\n<DOML2>, <ES5> etc. instead of <!mobile>.\nI like that a lot.\n. the advantage would be that we could run the specs for different builds without requiring a server side build process. I would however like to have a solution that works with packager right now and consider inline JS like you proposed for 2.0.\n. Continued here: https://github.com/mootools/mootools-core/pull/71\nI put the code into a branch.\n. Nice! Thanks!\n. https://github.com/mootools/mootools-core/commit/399554fc83fd460b41a53063093b82d6c464788f\nSorry arian, but when I see too many braces and too much indentation I can't sleep at nights.\n. super.\n. Thank you!\n. I dislike this API. None of our methods works like this\n. Merged. Thanks.\n. Merged\n. Hello,\nwe have fixed this issue in MooTools 1.2.5 and 1.3. Please update your code to either of these versions.\n. Fixed in 2.0\n. Yeah please provide a short demo on jsfiddle.\n. Thanks Darren, this is outstanding work and I'm looking forward to having this for 1.4. Please address some of the issues I commented inline and I'll pull asap.\n. @fakedarren you going to make any adjustments or not?\n. Thanks.\n. Have you tested this? The jsfiddle example suggests you have not because it would break when you run it (if online/offline would fire on document.body, which it does not).\nI cannot find the proper specification (if it is at all specified yet) but online/offline events have a timeStamp property which seems like the only useful event information that can be extracted. So either we set the events to 1 in Element.NativeEvents and pass no event info at all or we make a special case in Event.js for them to copy over time stamp data. Either way is fine for me even though I think I'd prefer the latter.\n. I tried it in Chrome and Firefox and neither browser fire the event on document.body. According to the specification they should fire on window, which they do.\n. Interesting enough, Firefox does fire online/offline on document.body but Chrome does not. Both fire on window.\n. Given that these events are only useful on window and we don't have any event data that we normalize I think its best just to use native functionality.\nMaybe someone wants to make a small plugin for the forge that abstracts online/offline state or whatever.\n. Thank you!\n. - There are no tests\n- This is not the implementation we are going to go with here\nWith my commit 784cf7291 all your code can be done via an external plugin. I took the liberty to rewrite your fix in a clean fashion: https://gist.github.com/1103139 (untested of course)\nWe should add this to the forge or maybe to More. If other people agree I can add this to Core 1.4, I don't feel strongly about not having it. The one thing I would require is some actual tests (in html format, for the Specs repository)\n. Ok, if you can provide proper tests, properly formatted for the core-specs repository I'll look into it and add it for 1.4.\n. As said we'll include this in Core 1.4.\nYou are right about the indexOf check, as this is in the condition it might be a perf problem. I'll fix it.\nPlease provide a test case like we have for Delegation: https://github.com/mootools/mootools-core-specs/blob/master/1.4client/Element/Element.Delegation.html\nIf you create one I'll add it to Specs and add this fix to 1.4 ASAP.\n. Updated gist: https://gist.github.com/1103139\n. I want an actual test that proves the functioning of this code like I said a few times now, I cannot add it to MooTools otherwise.\n. Yet he fails to provide me with a pull request and a proper spec. :)\n. I know, right.\n. So we can pull this specific fix and revisit for more fixes later?\n. Why is this a problem exactly?\n. Note that there are three different cases:\n1.3 without native bind: fix this one\n1.3 with native bind: \u221a\n1.2compat: ignore this\n. I'm cool with this. We should only fix 1.3 (1.2compat is non-standard anyway) and only few browsers don't have bind natively, so we should be fine :) Pull Request !\n. Oh man, Safari still doesn't have bind :o\n. Also, we can probably use\n(this && this != window)\nas an adequate check.\n@jdalton - what do you think?\n. You are right. The docs should say that this is actually an object.\nYou can do if (Browser.Plugins.Flash){ doSomething(); }\nPlease fix it and send us a pull request :)\n. Thanks ;P that was quick.\n. Way ahead of you.\n. Oh yeah, you are right. Flash is dead tho :P\n. I strongly feel that this should be internal to Element.Styles and not expose any public object. I'd agree to pulling this for 1.4 although you'd have to check with Valerio for future compatibility.\nAlso, where are all the specs? I won't pull without extensive coverage :)\n. Please next time think about these kinda things before opening a ticket in the wrong place:\n\"I can't provide a real test-case for this. But as I see it, in version 12, the animation was smooth from 0% to 100%, but in version 13 [\u2026] it simply has these random slowdowns.\"\nI don't see how you could blame a JS library for this by having such a description and no test case at all.\n. I understand that and thank you for you report. Given this is obviously a temporary browser bug it is unlikely that we are considering to fix this. Please use the ticket system on github strictly for actual things we can fix and post other stuff on the mailing list.\n@ibolmo is there a way to encourage users to only open a ticket if they have reproducible tests? I don't want us to waste time on might-be bugs.\n. What @arian said!\n. Do we have a test for this?\n. Thank you!\n. Thank you! Fixed in 983a8c792\nWe changed the behavior to only allow one single string.\n. No!\nThere is no way we can provide proper Object.create because we can't support the second argument. I really don't want Object.create in MooTools because it can't done properly. Maybe a method that uses native Object.create if available and falls back to our implementation just for the first argument\n. I think we should not worry about this. Function.prototype.create == Object.create if you include 1.2compat. It was a bad decision in the past. If you build something fresh you can drop the 1.2compat and ignore this.\n. That brings up the question whether we should make compatibility with previous versions opt-in instead of opt-out starting from 1.4. I'm voting YES!\n. This is a crazy amount of code. It used to be 10 lines.\n. LGTM.\n. Hello,\nthank you for your report. We are not likely going to implement this into MooTools Core.\nThere are a couple of implementations of this somewhere on the web, see http://mootools.net/forge/p/mootools_zencoding\nIf you need help with your own script, feel free to ask on the Mailing List: https://groups.google.com/forum/#!forum/mootools\n. Awesomeness.\n. Do not merge yet. I have not tested this in anything else but Chrome so far. I want to get your feedback, I feel this is very important and a slightly breaking change that we can all live with for 1.4.\nThe change is that set('opacity'), setOpacity, get('opacity'), getOpacity are deprecated in favor of setStyle('opacity', value) and getStyle('opacity').\nBreaking change: does not set zoom or visibility in browsers that support native opacity. Sets zoom and filter in IE. Sets visibility in browsers without opacity or filter.\nNote: Might require minor changes to More.\nWhat do you say, go!\n. Updated the diff with the changes requested by Olmo.\nI've looked into not using ternaries but given that these are multiline assignments they become quite ugly. I think ternaries are fine in this case.\nAlso added support for getOpacity if there is no filter or opacity.\nSpecs changes: https://github.com/mootools/mootools-core-specs/commit/8e9d33ca2c85c58a750dd1056e587f4e14a3bacb\nAs far as I can see we don't have any docs on setOpacity or set('opacity') or similar so we should be fine :)\n. @ibolmo @arian does this now work in all browsers that we support? :D\n. Also, let's not pull this because I updated the Specs repo on this commit to a branch. I'll happily push this once we agreed on it.\n. Someone should probably do that, I agree.\nI pushed this to mootools.\n. Thank you, this makes sense. We plan to overhaul all of the Request classes to be much better in the near future :)\n. Awesome. Thanks for the hard work. I have made a couple more changes to make the docs easier to understand (hopefully :o )\n. Sweet!\n. Hey,\nthank you for your report. This totally makes sense but we are not likely to extend String.substitute in MooTools Core. The version in MooTools Core is intended for minor use cases only.\nIf you can think of a proper Template Class or similar and want to build it, we are more than happy to add it to MooTools More :)\n. Either here: https://github.com/mootools/mootools-more\nor on the Mailing List: https://groups.google.com/forum/#!forum/mootools-users\nI think it would be better to show it with demos etc. on the mailing list so we can discuss it. Note that what I have in mind is supposed to be a fully featured template engine and not just simple text-replace.\n. If you care to do some.\n. Well I personally think we need neither >>> 0 or the TypeError. I looked at it a couple of years ago and thought it isn't worth the bytes. Those two things are really really minor edge cases which we never gave a shit about and our users never noticed.\nSo I would argue to pull the specs and the changes for 2.0 and leave it as is for 1.4 - arian do you agree? (sorry for changing my mind on this)\n. Pulling nowww.\n. Thank You!\n. I like this. What is the browser support?\n. This is really cool.\n. I've tested it in Chrome and everything is still very green.\n. @arian do you approve?\n. Does this cause any problems to keep it? If its in the standard we should keep it in (and maybe fix the spec to do feature detection for properties).\n. Don't remove it from the specs. Do feature detection and only check for it if it exists.\n. video.loop != null == supported? Does this check work?\n. ehh, 'loop' in video should be the way to detect this then I guess.\n. Done: https://github.com/mootools/mootools-core-specs/commit/f9720e2fd4525b06a5063c9b37af53024408e596\nIt doesn't hurt to keep the loop in the bools list. It'll just affect browsers that support it.\n. Yes, this is a breaking change but the move from 1.3 More to 1.4 Core is the only time we can actually do this.\nI am not against changing this to something different, here are the points to consider:\n- Consistency: In our event model, this always refers to the element that has the events attached\n- Duplication: we pass the matched element as second argument to the event listener. There is no point in having this == arguments[1]. None, at all.\n- event.target is not a valid substitute for the observer element. If anything event.target should be set to the target matched by delegation. But I don't want us to mess with event.target because other info might get lost (an element within the one matched by delegation)\nThis change does not remove anything (the second argument is still available) but it adds something.\nI'm open to suggestions.\n. I wonder why we didn't have this in the first place. I'll need to check that out.\nIn any case, this needs documentation too!\n. I don't want to pull this for now even though I think it is a valid use case and I want to have this in a later release.\nAdding this to Request would require changes to Request.JSON and Request.HTML because the option would just not do anything in those classes by default. Additionally, just having this option available in Request subclasses usually doesn't make any sense.\nI think the proper way to do this for now is to make a class like:\n```\nRequest.Raw = new Class({\n  Extends: Request,\nsuccess: function(text, xml){\n    this.onSuccess(text, xml);\n  }\n});\n```\nThis would be explicit and wouldn't touch Request!\n. You are missing the  blocks.\n. Given that you posted this on the Mailing List we can discuss it there and reopen this issue later if it turns out to be a bug.\nhttps://groups.google.com/forum/#!topic/mootools-users/5SVyCS5mHPw\n. This seems legit. I need to bring Function.from(base) back tho.\n. I'll test this in the next few days and add Function.from(base) back and then merge it so we can dance in circles!\n. Pulled here: https://github.com/mootools/mootools-core/commit/4522d61f831f278a37208a3b494d78edc6c2c312\nI squashed the commits and made a reasonable commit message.\nThank you Daniel. Great work!\n. LOL\n. Related (extremely minor) changes to More: https://github.com/cpojer/mootools-more/commit/b770231ea0eb19f56b043a61a5caa99cc87fb938\n- I think it is safe to rename the Event module name to DOMEvent and don't worry about compatibility on this one. No one is likely to explicitly require Event. People use Element.Event and implicitly require DOMEvent.\n. It is not. We prevent the default action for the event. We prevent the event. It's fine and it is shorter.\n. I'm cool with this API change even if it hurts your feelings.\nThere is no ambiguity in an object that is unlikely to ever get more complex that has three entirely differently named methods.\n. reverted :( can someone \u221a ?\n. (I'm assuming your comment approves my changes?)\n. I would much rather see this on the forge or in More so we get some time to see how it works out. If it is good, I'm not opposed to integrating part of this functionality to Core at a later time.\n. Also, thank you for your work in this area. We would just like to keep Core clean and lean. Part of the reason we haven't added CSS3 stuff to Core yet is because we want to see how it develops.\n. Also, thank you for your work in this area. We would just like to keep Core clean and lean. Part of the reason we haven't added CSS3 stuff to Core yet is because we want to see how it develops.\n. sweet.\n. fix it arian :P\n. This is the best bug report ever. Thank you very much for this very detailed guide on how to debug these problems.\nWe have fixed the first issue and we'll fix the second one soon and release 1.4.1.\nKeep it up!\n. This was an intentional change in MooTools Core 1.3. We will not change this anytime soon.\n. \u221a\n. you are the boss.\n. We will not change this for 1.4 because we are not following the standard implementation with JSON.encode and JSON.decode.\nWe will however provide an AMD compliant module for Milk (next version) that (hopefully) provides JSON.parse and JSON.stringify with single-argument implementations only. That way we don't conflict with native standards and you'll be able to use the native JSON object if you don't need our implementation.\nWe'll take care of it.\n. \u221a\n. This was an intentional breaking change in 1.4. I am sorry that our backwards compatible release didn't bring a fix for this. We'll investigate this for 1.4.1 and 1.4.2. The change was necessary because it was conflicting with people who were using css-transforms and setting visibility is also not necessary any more as most browsers support opacity natively.\nIn the future we will not implicitly set style properties if you change opacity any more so it would be best to change your application to use the new standard (use the onComplete event for animations to toggle visibility).\n. What about this change in removeProperty?\n. Oh wait, I thought setProperty uses removeAttribute too. Nevermind.\n. I am just wondering why we used to have the if else block in removeProperty.\nAlso, setProperty calls removeProperty if value == null and removeProperty calls setProperty with false. Can we do something about that?\n. ++\n. I think this is ok.\nI don't want a second argument for this. Fade should just always set visibility.\n. do we gain anything from storing method names in strings other than increasing code complexity? gzip compression should still be about the same.\n. merged ! thanks.\n. You'll need to use Element.destroy(instance.toElement);\nWe can't extend object elements in IE so there is no way to fix this.\n. This is really nice.\n. We have simplified $$ in 1.3. $$ behaves differently depending on whether you are including compatibility to 1.2 or not.\nselect elements are quite special, in IE they are a node and a collection at the same time.\nI think what you want is $(select) which returns the select element. $$ is used for selecting multiple elements.\n. Yeah we should do this.\n. element.addEvent('click:relay(a)');\nelement.fireEvent('click:relay(a)', [event, a]);\nif this inside of the relayed element refers to element and not the a tag, then this is a bug.\n. You need to know both elements and the exact string you used to attach the listener. There is no other way to do this currently and I agree there must be a way in the future. I don't think we'll get around to do this with the current event model before the next major version of the MooTools.\n. I think we got this covered for Milk.\nThere are some interesting issues though that I was not aware of, let's keep this open until we fix them for 1.4.x\n. Using fireEvent('click') breaks: http://jsfiddle.net/MnhQj/\nUsing fireEvent('click:relay(a)', [null, a]) does not work: http://jsfiddle.net/MnhQj/1/\n@arian ^\n. also, element.fireEvent('click') should not necessarily fire click:relay(a)\n. This was an oversight. Oops.\nYes, this is a permanent change.\n. Thank you! This is already fixed for 1.4.1 which should be released in the next few days.\n. Oh wow this was lame! Thanks, fixed in 6f9d4ae1bed4f0d481f8c11f69d70421b7df648a for MooTools Core 1.4.1 (out soon!)\n. Hello,\nplease ask questions on our Mailing list: https://groups.google.com/forum/#!forum/mootools-users\n. Does it work like this now?\nelement.addEvent('click:relay(a)', fire).fireEvent('click'); // fire is not executed\n. Our event model doesn't support these kinda awesome things yet. :(\n. Please show us a test case where this worked. I am confident we never had functionality like this.\nAs arian said, use on* in options and use events: {} in the Element constructor.\n. This is funny.\n. I like Element.$uid without a compromise of keeping $uid.\n. I don't see a problem here.\nStart the counter at 3 in Element.js and hardcode 1 and 2 in Browser.js, only a limited amount of duplication (inlining $uid twice in Browser.js for setting the property).\n. It doesn't make any sense to clone the contents because we store instances of classes in Element.Storage.\nIf you want to copy meta data associated with your element, use data-attributes directly on your element. In fact, at this point I consider Element.Storage to be internal to MooTools to be able to store framework-only meta-data and hide it from the user. Milk won't have Element.Storage either because it is unnecessary.\nI do like to have an options object for clone. Feel free to reopen this issue for the DOM repository.\n. No, because we store a billion different class instances. It is best to handle this yourself, or - as said - store meta-data associated with your element as data-attribute, and then you can use that for the new Morph.\n. This is how mobile safari works. It has a 300ms delay for clicks.\nCheck out http://cpojer.net/PowerTools - mootools-mobile\n. Nope, there is no reason not to have all of this be a separate Plugin. Just load mootools-mobile and it does exactly what you described.\n. well, there is a shiny builder on http://cpojer.net/PowerTools and it is integrated nicely with Packager. All the repositories can be found, forked and contributed to on GitHub.\nIf the people you are working with don't know about it and you want them to know, tell them. Spread the word. If you find that it sucks, make it better :)\n. You can either get the next or the previous using getNext and getPrevious. getSiblings is obviously plural only because it goes both ways.\n. getSiblings()[0] then\n. packager blocks? :O\n. fiiix the docs. :)\n. Yeah we can do this.\n. I like.\n. wow thank you!\n. wheeere are the speeecs?\n. Why is this still on Core and not on More?\n. Daniel, would you mind pointing me to where we agreed to add this to Core? The consensus was to add this functionality to MooTools More. Also the specs are incomplete and use the old format. Please use Jasmine Syntax and properly test the behavior of the two methods.\n. Wait, what. I never agreed to add this to Core. @arian @kamicane what do you say?\n. Please write proper tests, add a proper commit author and reopen this pull request in MooTools More. Thank You.\n. Guys, we did not shoot this down. We are actively encouraging the people involved in this change to add this piece of code to MooTools More where we want this to live for now. If it turns out that many users need and use this functionality, we will move it into MooTools Core.\nWe don't want to add code to MooTools Core that isn't used within the library or isn't absolutely essential so we don't bloat the library for everyone. Note that modularity is essential for us and we need to draw the line somewhere ;)\nIf someone sends a pull request for this functionality for MooTools More complete with documentation, proper tests and everything I'll pull it instantly.\n. @chrispitt This specific pull request was discussed months ago and the consensus was to add this to MooTools More and I don't like to reiterate on this every other week because @csuwldcat doesn't want to listen :)\nNote that String.substitute is a simple method that just does simple substitution. We never meant for it to be a templating engine and the method should not even be part of Core really. I'd like it not to change at all to be honest. For anything complex, use Handlebars, Closure Templates or whatever suits you.\nAlso, the man is just trying to serve. Valar Morghulis.\n. @fakedarren did not know about the prior discussion we had about this pull request and @arian and @kamicane have agreed to put this into More.\n. @motiontoday since you created the pull request for MooTools More, would you mind taking care of this for More? Effectively deprecating Object.getFromPath and adding Object.get/Object.set and maybe an overwrite for String.substitute. We can add a notice to the Core docs that extended behavior is available in More.\n. You have some solid reality distortion going on here.\n. @motiontoday yes, that sounds like a plan :) Once we have that, we can also add a note to String.substitute in Core that advanced behavior is available in MooTools More.\n@csuwldcat I'm a potato and I find this offensive.\n. @csuwldcat well, you can also take this and move it to More, I don't care who does it. However, you did not express interest in moving this to More.\n. Unfortunately this is a JavaScript error and there is nothing we can do about this. If you are using Web Inspector you can get much more useful error messages, open Web Inspector (Chrome or Safari) in this example: http://jsfiddle.net/M6efP/ and you will see detailed error text.\nYou should consider integrating dependency management so your files will always be included in the proper order. See http://requirejs.org/ or our own http://github.com/kamicane/packager\n. @ibolmo I don't understand how has.js would solve the issue of referencing undefined variables unless we switch to string based class names and a general class namespace.\n. Are we playing this game now? http://jsfiddle.net/M6efP/2/\n. nope.\n. @giddie the issue is that when you reference a variable that is not defined, execution of the file or function halts. If you do new Class({ Extends: SomeUndefinedVariable }), the \"new Class\" constructor does not get called at all because your JS engine fails to resolve SomeUndefinedVariable. Also see this example: http://jsfiddle.net/M6efP/2/ which will throw an error in your console.\nIf this happens, we cannot intercept this error and we are unable to throw a useful custom error message.\nAs I said in my first response, use Web Inspector and you'll get a very useful error message with file and line that helps you more than we ever could in a custom error. If your preferred debugger does not give you good output, file a bug with them describing how web inspector has better error texts. Thank you.\n. do this for 1.5? Nice.\n. I really don't see the value in this. Can we finally stop this madness?\n. If this goes in for production use it must include an error routing mechanism otherwise it is useless.\n. as @timwienk noted in #mootools-dev, this breaks extending/implementing other (constructor) functions and therefore removes a useful feature.\n. This is for More.\n. Can someone set this.Window and this.Document to null, make sure it doesn't throw in IE and send a pull-request? Seems simple.\n. this is intentional. We found that not a lot of users were using bind because of the existing pass method, so we made this change for 1.3. Bind behaves differently depending on whether you include 1.2 compatibility or not.\nYou have two options:\n- Drop compatibility to 1.2\n- Use pass instead\n. We are doing this for onAdd, onRemove and the condition. See https://github.com/mootools/mootools-core/commit/5d1eff87c01721b8fdbb125b490180a0d7e7930a If you need more fancy sugar use https://github.com/cpojer/mootools-custom-event\n. iirc the problem was that the file-scope this isn't always the global context.\n. @arian weren't there lots of crashes involved with this in IE7? Just checkin'\n. Can we please keep add/remove/toggle/hasClass methods to work on only one class name at a time?\n. Well, for one because the method names are singular and not plural. Another reason would be that support for HTML5 classList cannot be implemented as easily.\n. What is the problem with doing addClass(a).addClass(b) ?\n. You can easily add this functionality to a plugin and add it to the forge. I personally don't think the ability to add multiple classes in a single call warrants all the bloat you added to the core library. Also, your assumption is wrong in dropping these methods because they do provide useful functionality such as preventing to add a class twice.\n. I would like to stay aligned with the classList API which accepts one class name per method call. Also, the documentation you linked highlights that all APIs are more or less inconsistent in that they allow one/many classes for add/remove but only work with a single class name for has and sometimes for toggle.\n. I was more thinking about using the classList API within the MooTools class methods in browsers where it is available. For example like this: https://gist.github.com/98e4b186a7cda56b72c5 This change has a huge performance impact as can be seen here: http://hacks.mozilla.org/2010/01/classlist-in-firefox-3-6/\nI'll open a pull request for it, give me a couple of minutes :)\n. https://github.com/mootools/mootools-core/pull/2390\n. Google 'html5 classlist performance' and you'll find multiple pages hinting at performance improvements.\n. I totally did not test this in all browsers but the specs we have should cover this. Also, in modern browsers addClass, removeClass and toggleClass should throw now if the class name does not conform (ie. if it contains spaces).\nAlso note I didn't touch toggleClass because we have the 'force' option and the method uses add/remove anyway.\n. Google 'html5 classlist performance'\n. n00b, fixed.\n. So we are all happy with using a single class name per method call now, are we?\n. Haha, happy that perf backs me up then. I really didn't want the change to happen ;)\n. thank you!\n. thank you!\n. I like this a lot. @leegee would you mind amending your commit with proper MooTools coding standards? (There are too many spaces in the documentation code example and an else block belongs on the same line with the closing parenthesis of the previous block and the opening parenthesis of the else block).\nAlso, it seems to my like you could shorten the code block around defining the response. If you don't know what to do feel free to join #mootools on IRC and ping me :)\n. No, you should check this yourself in your app code.\n. I'm not entirely sure if you are trolling or not but the purpose, as the function name suggests, is to attempt executing the function and in case of an error to discard and ignore it. You either get a result or you don't. If you do want the error to show up, do not use this method. Easy.\n. sure, whynot, merge it.\n. fwiw this is possible in ES6: http://google.github.io/traceur-compiler/demo/repl.html#class%20A%20%7B%0A%20%20constructor()%20%7B%0A%20%20%20%20this.prop%20%3D%20123%3B%20%0A%20%20%7D%0A%20%20method(a)%20%7B%0A%20%20%20%20console.log(a%2C%20this.prop)%3B%20%0A%20%20%7D%0A%7D%0A%0Aclass%20B%20extends%20A%20%7B%0A%20%0A%20%20methodB()%20%7B%0A%20%20%20%20this.callMethod(super.method)%3B%0A%20%20%7D%0A%20%20%0A%20%20callMethod(fn)%20%7B%0A%20%20%09fn.call(this%2C%20'Hi!')%3B%0A%20%20%7D%0A%20%20%0A%7D%0A%0A(new%20B).methodB()%3B\nPersonally I think this pattern isn't awesome and I consider all of Core to be in complete feature-freeze so I'd advise against introducing new API. Also, getParent is a bad name and might conflict with user-code.\n. I'm not sure if we should pull this. I like the strictness about the classList API. If we allow this to fall through you'll just run into hard-to-debug issues. Also, with your change addClass(' myClass ') will still throw an error so it is kinda useless.\nI like the explicitness, however if @arian disagrees feel free to make the change.\n. Example of your code: addClass(' IamWrong ') will do the following:\nif (' IamWrong '.trim()) this.classList.add(' IamWrong'); // boom, add does not approve of whitespace.\nIt does throw because you need to do\nclassName = (className || '').trim()\n  if (className) this.classList.add(className);\nIf we are deciding not to throw, then please add || '' too, so null won't throw either. Let's just never throw at all:\nSince you are so inclined to fix this issue I would like to propose a number of other changes, for example checking for any invalid CSS class character (see: http://www.w3.org/TR/CSS21/syndata.html#characters ) - if you wanna fix something not to throw, then you gotta ensure that it doesn't throw ever. I won't accept a pull request that fixes one common case but will still throw in others (what about removeClass('ab cd') ?).\nThe change was originally made because the added performance gain of using classList vs. className far outweighs any minor differences in the exceptional case of shitty code passing shitty values.\n. ahm, wait, do we actually want to support multi classes in these methods?\n- We never actively supported it (the fact that the code supports it is a bug).\n- The documentation says it only works with a single class name.\n- The method names are singular: addClass, not addClasses\n- This is noticeably slower for the 99 % case where you only want to add a single class\nBefore this change this is what's happening:\n   => addClass('a b'); // ends up with \"a a b\"\n   => removeClass('a b') // works but removeClass('b a') doesn't\nI don't think we want to make assumptions about the order of class names of an attribute of an HTMLElement.\nI think it is far more reasonable to either:\na) add checks for the non-classList behavior that throws when calling the method with null, an empty string or an invalid class name\nb) only handle the old behavior if you are using the 1.4compat version (in this case it could just do hasClassList = false)\n. I'm very opposed to adding an API that takes a list of space separated classes. An addClasses API must take an array.\n. @SergioCrisostomo that makes me pretty proud.\n. #impact\n. I think this crashed some version of IE or something.\n. ",
    "arian": "Why do we need the try catch for window.frameElement?\n. I approve\n. oki\n. It turns out that the id variable was already used in the initialize method, so when creating more instances of Swiff the id variable became NaN and stopped working, see ticket #1040\nhttps://mootools.lighthouseapp.com/projects/2706/tickets/1040\nSince String.generateUID has been changed in just String.uniqueID() I recommitted this: \nhttp://github.com/arian/mootools-core/commit/4c4aabdfe6f6178b2d7789516cbdbb966296fdf3\n. See line: http://github.com/mootools/mootools-core/blob/master/Source/Utilities/Swiff.js#L53\nWe can rename the variable to sid or something, but just using String.uniqueID is just as easy and it doesn't come with extra dependencies since String.uniqueID is in Core.js\n. I just did two commits for Fx.Transitions, which are improvements in my opinion, but don't belong to the documentation improvements.\n. wow, very nice! Good work!\n. Infinity makes probably more sense indeed. I updated it a little.\n. You don't need this if Timer gets into 2.0\n. seems to make sense...\n. looking at http://jsfiddle.net/arian/wgGYu/9/ it makes sense.\n. @kamicane I forward ported your frames  stuff and got rid of the this.prevTime. Made a more subtle this.elapsed property and calculated the dt that way (which is used in the onStep method of Fx)\n. The braces was @timwienk his idea :P\nBut this obviously looks better!\nOn Thu, Apr 21, 2011 at 5:21 PM, cpojer \nreply@reply.github.comwrote:\n\nhttps://github.com/mootools/mootools-core/commit/399554fc83fd460b41a53063093b82d6c464788f\nSorry arian, but when I see too many braces and too much indentation I\ncan't sleep at nights.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/70#issuecomment-1039657\n. +1\n. git fetch mootools\ngit reset --hard mootools/master\ngit cherry-pick 56f4a56\ngit push origin master --force\n\nadditionally you might create and checkout in a new branch with git checkout -b selector-inject after the git reset\n. Started to write some specs here: https://github.com/arian/mootools-core-specs/tree/2.0wip-DOM\n. I noticed 2.0 has Array.prototype.last instead of getLast in 1.x. However in Element.js it still has the getNext, getLast, etc. methods. Not really consistent is it?\n. @Inviz: yea, good point... now we've just last, 'getLastandgetFirst(nofirst, just use array[0] i guess). \n. I also noticed that in IE6-7 DOM.Element.get can return\"\"instead ofnull` for some attributes. We could add\nreturn (...) || null;\nto each getter...\n. You don't want to use .flatten indeed. It recursively flattens the array (slower). And what if you want to pass an array. \n. Is there a mootools-more ticket for this?\n. Could you create a quick jsfiddle which reproduces this issue. Just a few lines of code should be enough. This code you copy-pasted should fix Array.from etc. for nodelists (Array.from(element.childNodes))\n. I think you can use the nocash argument in $ or document.id: https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L267\nEdit: No I think not :P\n. Check out the recent blogposts: http://mootools.net/blog/ and https://github.com/kamicane/mootools-core/tree/define-2\n. For delegation we already do something like that: https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Delegation.js#L76-86 so we add a real event instead of guessing.\nThis pull request is to unify the behavior of oldIE for this event. @csuwldcat is very passionate about it ;)\n. wow, that was difficult: https://github.com/arian/mootools-core-specs/compare/master#diff-1\n. @subtleGradient how?\n``` javascript\nform.setAttribute('action', ''); // \u2192 \n// or maybe?\nvar attr = document.createAttribute('action');\nattr.nodeValue = '';\nform.setAttributeNode(attr); // \u2192 \n```\nSo how did you want to fix this?\n. @Inviz seems to work fine: http://jsfiddle.net/YBcUs/1/\n. This seems to pass the @jdalton test: http://jsfiddle.net/QF9ZA/2/\n. This should fix 1.3 without compat or native bind: https://github.com/arian/mootools-core/commit/5c1df58c0d0\n. In new browsers this changes slows down bind significantly. In IE8 (about 10%) and 7 the difference is less, but still slower (of course) http://jsperf.com/function-proto-bind\n. What about https://github.com/arian/mootools-core/commit/b38e69f886\n. @jdalton: that should already work: http://jsfiddle.net/arian/QF9ZA/6/\njavascript\nvar other = function(){\n    console.log(this.foo, arguments);\n};\nother.bind({foo: 'bar'})(); // \u2192 bar\nother.bind({foo: 'bar'}, 'first').call({foo: 'yeah!'}, 'yooo'); // \u2192 bar, ['first', 'yeah!']\n. So am I missing something? https://gist.github.com/1124879\n. By fix it's: press fork button on github, find the right markdown file (Docs/Browser/Browser.md) on github, click \"edit file\" and fix it on github, press the pull request button on github.\nDid i mention github is pretty nice?\n. Hmm, don't see anything weird in 13.0.782.107 (Developer Build 94237 Linux) Ubuntu 11.04\n. We already added 'paste' and 'input': https://github.com/mootools/mootools-core/commit/24a0a8086d6.\nWe don't care about that old Firefox version. For opera it's a bit annoying. oninput can't just be used as a replacement, because it fires at every input (so also when you type). Maybe @csuwldcat wants to look at this to make this x-browser.\n. Probably only need to fix this one: https://github.com/arian/mootools-core/commit/5c1df58c#commitcomment-518763\n. I've some specs for this already: https://github.com/arian/mootools-core-specs/tree/function-bind\n. I think what @cpojer means if we implement it, we implement it completely according ES5. However @kamicane didn't do that in 2.0 either..\n. See #58\n. can't we put this in -more? It seems to fix edge cases and brings more bytes. I don't care about those slightly differences. If I would care it would be easy to pull that extra code in and done.\n. This will be fixed/re-added in the next update: https://github.com/mootools/mootools-core/blob/master/Docs/Slick/Slick.md\n. Seems like .sort is broken anyway? - http://jsfiddle.net/MVWb2/3/ (alerts 3,1,2)\n. as far as I tested (just typing some stuff in the consoles of IE8/chrome) it seems to work. If this stuff is enough covered by the specs (not really for setStyle/getStyle as far as I see) they also pass in IE6, IE8, IE9, Firefox 6, Safari, Chrome and Opera.\n. note to self:\n<cpojer> arian: can you also add Element.Delegation to Intro.md?\n<cpojer> arian: one suggestion for Intro.md\n<cpojer> put Class on top\n<cpojer> Element as second\n<cpojer> Element.Event and then Element.Delegation\n. Okay, updated some stuff. Feel free to improve it a bit more ;)\n. Guess those should be fine? https://github.com/mootools/mootools-core-specs/pull/19\n. When will this be null or undefined? When it's called with [].indexOf.call(null) this inside indexOf will be the global object, I believe that changed in ES5, but those browsers who need this don't have ES5. See the note at http://es5.github.com/#x15.3.4.4. I guess that makes it a bit harder to throw that TypeError...\n. +1\n. How would we use this? .appendHTML(html, where), like appendText? Also for oldIE we still need the fixes of Element.Properties.html.set.\n. @cpojer yes, I do.\n. Proposed fix: https://gist.github.com/1175698\n. Fix: https://github.com/arian/mootools-core/compare/element-properties-value\nSpecs: https://github.com/arian/mootools-core-specs/compare/element-properties-value\n. Ok, just tested it in IE6, still seems to be something wrong.\nedit: it works now\n. i'd say leave it here, but remove it from the specs. That way it'll work in Chrome etc.\n. Does firefox support loop? And if it does not, I guess it doesn't loop, so false would be correct right? Anyway I suppose this will resolve automatically once browsers fix their stuff.\n. I believe this firefox bug is related: https://bugzilla.mozilla.org/show_bug.cgi?id=449157 and this testcase is linked: http://w3c-test.org/html/tests/submission/Microsoft/video/video_005.htm where firefox indeed fails. So I guess if firefox or any browser does not support this, it should return false... Only thing I could see if you want to use a loop attribute on a non-video element. But that's maybe something for inherited element wrappers in 2.0 :).\n. +1\n. +1\n. I hope you're aware this is for a jQuery plugin and not for MooTools Core?\n. I would agree that prevent is a bit nicer, but for now I don't see the the urge to change it yet, preventDefault is standard w3c and other libraries use it as well so it's easy to remember. I'd say have this for 2.0 or something, but not yet for 1.4.\n. Don't forget to revert/update the specs and MooTools More\n. +1 for @oskarkrawczyk \n. Pulled, thanks a lot!\n. @fabiomcosta seems to be right: http://i.imgur.com/8KGNQ.png\nHowever looking at http://jsfiddle.net/6qf6D/8/ (http://i.imgur.com/Wi7dT.png) it alerts null\n. Yes, that seems to work indeed: http://i.imgur.com/qUZXf.png\n. Interesting. How does (and did) it behave before in IE?\n. for some reason the feature test was changed (probably I broke it :s):\n1.3.2:\n'text': (function(){\n    var temp = document.createElement('div');\n    return (temp.textContent == null) ? 'innerText' : 'textContent';\n})()\n1.4.0:\n'text': (function(){\n    var temp = document.createElement('div');\n    return (temp.innerText == null) ? 'textContent' : 'innerText';\n})()\nShould be easy to fix for 1.4.1\n. seems this is only for elements in the DOM.\n. Only in Firefox right?\n. Specs: https://github.com/arian/mootools-core-specs/commit/87b7ae3b\n. that's a square root sign, it should be \u2713\nOn Tue, Sep 13, 2011 at 9:27 PM, Christoph Pojer \nreply@reply.github.comwrote:\n\n\u221a\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2068#issuecomment-2085500\n. fixed this now.\n\n@w00fz: we need a docs.yml for MooTools core now too for Slick.\n. Where do you see it should return a boolean? returning 'null' (as a string) is correct for null, NaN orundefined\n. Thanks for pointing out, should be fixed on the website soon!\n. Already fixed: #2066\n. Could you provide a small http://jsfiddle.net demonstrating the exact problem.\n. See #2081\n. Thanks everyone for pointing this out and for the suggestions. 1.4.1 should be released soon with this fix, and .fade() sets the visibility, while setStyle('opacity') and tween('opacity') only changes the opacity!\n. already fixed, we'll release a fix shortly: https://github.com/mootools/mootools-core/issues/2066\n. Already fixed: https://github.com/mootools/mootools-core/pull/2068\nThanks for reporting though!\n. Already fixed #2067\nThanks for reporting though! We will release a 1.4.1 very soon.\n. Pull request #2080\n. I think this is a good compromise. .setStyle() and .tween('opacity') only touches the actual property: opacity, however the higher level method, fade, will set the visibility.\nAs shown in the examples in #2074 this is important for overlays, fade-through effects and lots more.\nI also added a visibility argument if which you can set to false if you really don't want to set visibility\n. @fakedarren, yes probably with some explanations indeed.\n. Specs: https://github.com/arian/mootools-core-specs/commit/a4aba9b\n. I believe this is by design, adding all the methods to  elements had some weird stuff, I'm not exactly sure why and how though.\n. I believe this might crash IE7\n. @ibolmo: https://mootools.lighthouseapp.com/projects/2706/tickets/1196\n. wow, nice!\n. It's the same in 1.3: http://jsfiddle.net/2KPtK/2/\n. Yes, you're right...\n. You're correct, however we already fixed it ;) https://github.com/mootools/mootools-core/pull/2067\n. You forgot to extend the Parent class: http://jsfiddle.net/2eATR/2/\n. You have to use $(document.body) at least once to add all the methods to the element in oldIE\n. Where exactly do we use getAttributeNodeNS()? I can't find it in the 1.4.0 source..\n. Right, could you create a jsfiddle, tell which browsers are affected, and report a new issue at https://github.com/mootools/slick/issues. Once you've done that we can close this one.\n. wow, I'm a noob..\n. It used to set the visibility property. We've fixed this already (see #2074) for the next version (1.4.1) which should be releases shortly.\n. yes. However if you pass a event object, or a second argument, it might be fired (whether the selector is matched).\n. Because then you would have to find all added delegates for each parent element  of ul.nav and check if it matches... that's possible, but a bit difficult for now, right?\n. No. Elements have Array AND Element methods. Array methods have a higher precedence than Element methods, which has always been the case.\n. :+1:\n@anutron: yes. For example with require.js you can use the paths configuration.\n. Then why not just use the dependencies argument, it's more readable and shorter.\n. So for now just use what works (standard AMD :D)\n. Little update, see https://github.com/arian/mootools-core/tree/1.5amd / https://github.com/arian/mootools-core/compare/1.5wip...1.5amd\nTodo: test it more, use the requirejs optimizer, with !amd compat block (extending stuff into the global object), etc.\n. Yes, within a few weeks I'll try to finish https://github.com/arian/mootools-core/tree/1.5cjs. The possible build options will be:\n- it can be built by https://github.com/kamicane/wrapup\n- it can be used in Node.js\n- other cjs modules compatible tools can use it.\n- convert it to AMD\n  - It's also possible to convert cjs modules to AMD modules, with r.js -convert\n  - or a simple script like https://github.com/mootools/prime/blob/master/bin/convert-amd.sh\n- it can still be built with https://github.com/kamicane/packager\n. Yes, use only the events object for Elements, use only onEvent for Classes.\nThe .addEvent() method works for both in a more consistent way.\nWe're aware of this inconsistency, but this probably will not get fixed for the 1.x series.\n. check http://jsfiddle.net/NA4V2/1/\nYou can see the selector becomes #billing:country_id. Maybe you'll have to do double escaping :o\n. @ibolmo's right :)\n. We can't fix this for 1.x. The trick is to use a hasOwnProperty check: http://jsfiddle.net/28rak/1/\n. awesome!\n. I don't know, it's unwanted behaviour to me. If it's indeed Slick.getAttribute then it should be fixed there, I wouldn't know how though..\n. But shouldn't it work with other frameworks that do similar things with\nelement methods in IE?\nOn Dec 10, 2011 5:30 PM, \"Fbio M. Costa\" \nreply@reply.github.com\nwrote:\n\nIt's not Slick... It's how the elements are extended on IE by Mootools and\nthe way that expandos are threated as attributes on IE. I don't agree we\nshould fix it there since Slick is intended to be used anywhere, by any\nframework, and should not have anything related to mootools-core inside it.\nAgreed?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2109#issuecomment-3091596\n. This is indeed intended. If you think about it, what would setStyle('opacity', 0) do? Indeed, change the opacity, not the visibility. After the release of 1.4.0 (where we introduced this change), there were many issues with fading elements out, which made us decided to bring this behavior, of setting the visibility, for the .fade method only.\n\nIn the 1.4.0 and 1.4.1 release blogposts we mentioned these changes.\n. doh, thanks.\n. Hmm, so you're saying .set should use .setAttribute for type on button elements...\n. Looks like you're right. The format option seems to be in there for some a pretty long time: https://github.com/mootools/mootools-core/commit/edb8e199\n. We probably need to have Node.js and UglifyJS installed..\nIt should be possible (right @w00fz and @fakedarren), question is if there is a major benefit. I believe UglifyJS doesn't compress a lot more than YUI compressor. It might also be confusing to have two almost identical compressors.\nWe could also just replace YUI compressor by UglifyJS.\n. Indeed, In MooTools 2.0/Milk we'll use Closure or Uglify anyway because we'll need dead-code-branch removal. \n. Yes, I don't really mind, things on Object are usually for normal objects, and this is for window/document/element only.. It could be moved to Element.$uid, but it's also used for window/document which are not really elements.. So the question would be if there would be a better owner object.. \nI don't think we should rename it to another global variable like uniqueId, because $uid has the $ and thus is some private thing..\n. It's just for unique ids used by .store and some other things, like Slick.uid, not to be confused with String.uniqueID(), so it's private, so deprecating something private because of simple a name change would be funny..\n. Slick doesn't use it, it has it's own version: Slick.uid(element).\nHow would this be useful to be public? I'm ok with moving it, but I don't think Object is semantically the right parent object..\nSimply renaming from window.$uid to window._uniqueID doesn't make sense.\n. This is indeed a good suggestion and it has been discussed several times. The biggest concern was the wrapping of the method, which could slow down things, but in real applications this never has been the bottleneck though.\nBecause there is a perf improvement, but not significant enough, other factors like functionality and API design are more important. We feel that just calling this.parent() is the most simple and intuitive way in almost each case. In practice calling this.parent('method') where method would refer to the method method of the parent class usually don't happen, and when it does it is often too confusing.\nIn case it is really necessary it is always possible to use ParentClass.prototype.method.call(this), which is indeed not so pretty, though I never really had to use this.\n. See pull #2126\n. Sounds interesting (and fun, memory leaks in IE7)... \n. I'll try if I can reproduce this..\n. I can't really reproduce this with a small testpage. It seems to use more memory after each refresh indeed, however not a lot more than an simple page with only window.addEvent('domready', function(){ ... }); or window.onload.\nNow i'm not memory IE leak expert, so maybe I'm doing something different then you? I found this little program called 'Drip' (via http://blogs.msdn.com/b/ie/archive/2007/11/29/tools-for-detecting-memory-leaks.aspx) for viewing the memory usage. I don't know if there are other tools for analyzing memory leaks and where they come from..\n. doc note is fine.\n. I vote for a doc note. I have to say that I didn't really tested this, but I have this feeling this might open the door for even more bugs and edge cases. As I understand with a documentation note it's not too hard to work around this, as a user.\n. yes, for 2.0 Base there is this ticket https://github.com/mootools/Base/issues/16 already.\n. It wouldn't be too difficult to use and it's probably a good idea.\nFor this we would need a 1.5, because it would break the comment blocks for those who are using it and it wouldn't be backward compatible.\n. It works without compat. With 1.2compat Element.Constructors is a Hash, which has a map method. In the Element constructor a simple and fast object lookup is done, which happens to get the Hash map method. If you don't use 1.2 compat it will work fine.\nWe won't fix it, see https://mootools.lighthouseapp.com/projects/2706/tickets/1126-new-elementmap-error\n. Yes, they are almost the same, except the one is for special cases of get/setProperty and the other is public API for set/get.\nThe divide probably should be that get/setPropery normalises attributes and properties, while Element.Properties is a public API to hook some custom getters/setters...\nThinking about it like this, class and value should be normalised for get/setProperty, and html/tag can be in Element.Properties \n. isn't this related to #2129?\n. +1 for using Slick.uidOf\n. it's intentional indeed. They used to be the same indeed. If you think about it what you'd expect what setStyle('opacity') would do, indeed, just change the opacity, hence the change. \nWithout compatibility set('opacity') and setOpacity() won't work anymore (yes, there were three ways to set the opacity). With compatibility those two work as they worked before, so they still set the visibility.\n. Pull request: #2159\n. awesome, iLike\n. it just needs some docs. @keeto would you like to make 'em, otherwise I could make some docs too.\n. Thanks, fixed it in 205df1b2fc3\n. We have Browser.Platform.webos already right?\nThough it looks like that won't be true with this UA string.. (we test for webos and this UA string contains wOS)..\n. I'm not familiar with webOS, and how much it changed with the acquisition, but I'd like to keep it webos, rather than adding touchpad, because that's very device specific.\n. :+1:\n. :+1:\n. Once it has specs, i'm ok with it. @thatmarvin, let me know if you need any help, otherwise let me know and I can have a look as well.\n. As we discussed on IRC the units are pretty inconsistent across browsers. Element.measure in MooTools More does a similar trick (although the other way around) with the display: block. \nSo the problem is in setStyle, which probably should return the value in '%' instead. The hack with the display:none doesn't sound as a very good idea to do that every time when you want to get a CSS property that has a length value..\n. Probably better solution in #2282\n. lets wait for 2012 to fix it :)\n. This is how Array.from works, what we use since 1.3.0 in fireEvent. Forms and select elements can work as a NodeList/array-like object (for example try document.forms[0][0] on this page and you'll see it works. A simple workaround for your case is to use .fireEvent('foo', [form]).\n. I can confirm reloading this page http://www.apixelife.com/github/2163/mootools-core-1.4.2.html and http://iamincendium.com/github-2163/mootools-1.4.2.htm both crashes my IE7 in VirtualBox.\n. So that would be this commit: https://github.com/mootools/mootools-core/commit/79c4efe80\n. Why not use Element.implement, like any other method...\njs\n(function(fireEvent){\n    Element.implement('_fireEvent', function(type, event){\n        fireEvent.call(this, type, event);\n    });\n})(Element.prototype.fireEvent);\n. We just pushed that fix. Now we can use happily IE7 again!\n. :+1: i can push this any time you want ;)\n. I think it has to do with 4522d61f83\nping @csuwldcat\n. This is the same as #2172 right?\n. nice, I'll wait for others to comment (@ibolmo, @csuwldcat, @cpojer), but it looks good to me!\n. Did you try this test: https://github.com/mootools/mootools-core/blob/master/Specs/1.4client/Element/Element.Event.change.html\n. You don't need that, just open the html file I linked to, it's in the -core repo now, and that file doesn't require the spec-runner.\n. Thanks! I cherry-picked your single commit that fixed this.\n. :+1:\n. This has to do with IE, if you first set the value, and then set the type, for example:\njs\nnew Element('input', {value: \"hi\", type: \"submit\"})\ndoesn't work either.\nIf you use the selector syntax, the parsed properties are appended to the other properties, so the value is first set, then the type.\nA fix for this would be to set the type first, and after that the value. Not sure if we should do this in MooTools, or that this should be done in your code...\n. I think this is alright :+1:\nOnly thing is if you wouldn't expect this?\njs\nvar a  = $$('div');\nvar b = a.destroy();\na == b == []; // true\n. What Sebastian said.\nkeypress events should pass a charCode value, which is a char that can be transformed with String.fromCharCode to a string representation.\nAlso see http://www.quirksmode.org/js/keys.html\n. hm, yeah, documentation could be a bit more clear about this.\n. interesting.. o_0\nHow could we try to reproduce this? \n. In that modernizr issue, the HTML is this:\nhtml\n <video id=\"video\" />\n <script type=\"text/javascript\">\n    var v = document.getElementById(\"video\");\n    var ans = v.canPlayType('video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"')\n </script>\nSorry for the maybe obvious question (it's still early here ;)), but how does this relate to the bools stuff in Element.js?\n. This is normal.\nThis is a useful class to help you with this stuff: https://github.com/cpojer/mootools-class-extras/blob/master/Source/Class.Binds.js\n. The first test failed in ltIE9 too, wich was fixed by this fix. The second test only failed in IE9 iirc.\n. updated.\n. updated.\n. you can still use $(...) right?\n. I wouldn't mind much\u2026 code looks good.\n. And docs!\nOn Jan 3, 2012 10:36 PM, \"Daniel Buchner\" \nreply@reply.github.com\nwrote:\n\nI'll have em done by this evening. You and your specs, total buzzkill!  ;)\nOn Jan 3, 2012 1:00 PM, \"Christoph Pojer\" \nreply@reply.github.com\nwrote:\n\nwheeere are the speeecs?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2191#issuecomment-3346038\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2191#issuecomment-3346608\n. The more pull request already exists: https://github.com/mootools/mootools-more/pull/1129\n. @chrispitt meet @csuwldcat and @cpojer. Secretly they're lovers, but nobody may know.\n. Awesome.\n. merged.\n. It should: https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Event.js#L140\n. cool :)\n. It should be possible yes, this is my UA string:\n\nMozilla/5.0 Linux U Android 2.3.4 en-us SonyEricssonMT15i Build/4.0.2.A.0.42 AppleWebKit/533.1 KHTML, like Gecko Version/4.0 Mobile Safari/533.1\n. You should be able to feature test the 'position: fixed', like\njs\nfunction () {\n  var container = document.body;\n  if (document.createElement &&\n      container && container.appendChild && container.removeChild) {\n      var el = document.createElement(\"div\");\n      if (!el.getBoundingClientRect) {\n          return null;\n      }\n      el.innerHTML = \"x\";\n      el.style.cssText = \"position:fixed;top:100px;\";\n      container.appendChild(el);\n      var originalHeight = container.style.height, originalScrollTop = container.scrollTop;\n      container.style.height = \"3000px\";\n      container.scrollTop = 500;\n      var elementTop = el.getBoundingClientRect().top;\n      container.style.height = originalHeight;\n      var isSupported = elementTop === 100;\n      container.removeChild(el);\n      container.scrollTop = originalScrollTop;\n      return isSupported;\n  }\n  return null;\n}\nsource: http://kangax.github.com/cft/\n. Can't you just set the emulation option to false?\n. I think this is not really a MooTools bug, because the plugin is really terrible. It just overwrites many functions, even prompt() and alert()!\nOn the other hand window.scrollTo is not part of any specification, but browsers have this feature since like forever..\n. And by overwriting it sets all those functions to null, not even to an empty function, or another function to let the user know something has been blocked.\n. I made a start https://gist.github.com/1629934.\nThe mootools specs don't pass yet for some cases, and .getParent() and other methods that use reversed combinators will be a bit harder too.\n. Fixed in 9609878 by moving it into 1.4compat\n. I believe it's very difficult/impossible to access that stuff cross-domain.\n. new Element creates an element in the current document. You can't simply move that to another document (See notes of appendChild: https://developer.mozilla.org/en-US/docs/DOM/Node.appendChild?redirectlocale=en-US&redirectslug=DOM%2Felement.appendChild#Notes)\n. It was marked as wontfix: https://mootools.lighthouseapp.com/projects/2706/tickets/642#ticket-642-10\n. As browser-prefixes are continuously changing, and blink is phasing them out, I don't think we should add something like this.\n. don't we use the 'native' mouseenter / mouseleave now, if available, which IE supports since IE 5.5.\n. Also see this screencast with more links and info: http://allyoucanleet.com/2011/02/16/exploring-the-removechild-single-page-memory-leak/\n. Also see this blogpost about this problem: http://dean.edwards.name/weblog/2009/03/callbacks-vs-events/\n. As @kentaromiura making events async by default will break things. Adding an extra method might work, but that complicates the API, and as nobody has commented on this issue in two years, I doubt about the actual necessity. \n. I think this would be something for when we switch to an AMD builder.\n. Probably overwrite the send method in the subclasses, save the passed options object, so it can be accessed in the success method.\n/cc @garrick\n. err.. @GCheung55\n. agreed with @DimitarChristoff \n. Last time I checked not..\n. This is something for a new AMD builder for 1.5.\n. See https://github.com/mootools/slick/pull/64\n. This was already fixed in https://github.com/mootools/mootools-core/commit/3fc253eb43\n. This is a mootools-more issue.\n. You're right, also see http://jsfiddle.net/nbQEk/1/embedded/result/\n@ibolmo any ideas what has changed there that could've caused this?\n. This is a Slick issue.\nI've looked into this. The problem is that it checks if document.documentElement exists and is the native contains method.\nIE however does not have document.contains. So MooTools will set it with a Slick.contains wrapper. Now when you call document.contains it will result in an infinite recursion.\nProbably an extra check should be added if document.contains is a native method.\n. Fix: https://github.com/mootools/slick/pull/67\n. This is fixed in Slick now.\n. What if we'd have a proper hasAttribute method?\nAs you probably know these are the results in oldIE:\n``` js\nvar div = makeElement('hello');\ndiv.somerandomproperty = 1;\n// the comments are the actual outcome.\nvar attr = div.getAttributeNode('data-custom');\nexpect(attr.specified).toEqual(true); // true\nexpect(attr.expando).toEqual(undefined); // true\ndiv.randomproperty = 1;\nattr = div.getAttributeNode('somerandomproperty');\nexpect(attr).toEqual(undefined); // DOMNode\nexpect(attr && attr.specified).toEqual(undefined); // true\nexpect(attr && attr.expando).toEqual(undefined); // true\n```\nAfter some research the only solution I found is using outerHTML indeed.\n. ``` js\ndiv = new Element('div', {html: ''}).getFirst();\nexpect(div.get('data-custom')).toEqual('other');\n```\nfails.\n. I assume it are those lines: https://github.com/mootools/mootools-core/blob/master/Source/Core/Core.js#L248-249\nIt looks like this is done to iterate over the prototype properties. For example \nfor (var m in Number.prototype) { console.log(m) }\nOn a non-mootools page, will not log anything, while on a mootools page it will log all the number methods. This is because the methods on the prototype of these types are non-enumerable Number.prototype.toFixed.propertyIsEnumerable() // false. It looks like MooTools resets those properties so they are enumerable. This is used so it can iterate over the methods to implement the generic functions (object.implement(prototype);), and to copy the Array methods into Elements (Elements.implement(Array.prototype);).\nLooking at the chromium ticket, you have these test results:\nWith mootools 8111ms\nWithout mootools 2012ms\nThis looks pretty substantial so we might want to change this so chrome can optimize this code a lot more.\n/cc @cpojer @ibolmo \n. I made a fix in https://github.com/arian/mootools-core/commit/9293d612\n/cc @kamicane \n. @satazor Can you test it with this fix? How do you actually test this, can you provide the tests?\n. Right, that's the correct behavior indeed. However you're saying the documentation could be a bit clearer?\nIf you want you could go to https://github.com/mootools/mootools-core/blob/master/Docs/Element/Element.md and click the 'Fork and edit file' button, and fix it yourself, and send a pull request. Otherwise we'll try to fix this later.\n. In that case you can just use Request. Request.JSON is to retrieve a JSON response.\n. Why is this really necessary. data-* is a DOM attribute. .store() and .retrieve() is an internal javascript object storage mechanism. I think they serve different purposes and don't really have to be mixed up.\nWith .get('data-foo') you know exactly where it comes from and what it does, the same with .retrieve(), simple as that. When you mix this up, it's becoming less clear and more complicated imo.\n. @thomasd is correct.\n. This is actually something that should be fixed in the https://github.com/mootools/slick repository. @subtleGradient  / @fabiomcosta / @ibolmo any good places to put the tests?\n. @calyptus fix was merged, so it's fixed in Slick now. Just need to update Slick for mootools 1.4.4 and we're done :)\n. This seems to work :D\n. would\njs\nvar div = new Element('div');\nconsole.log(instanceOf(div, Element));\nstill work?\n. Element is probably covered by $constructor from Type.\n. so should window and document\u2026\n. ah, ignore that, if they're not true, it will continue with the native instanceof indeed.\n. though maybe if you put the if (!item.hasOwnProperty) return false check after the while loop, it might work.\n. I made this fix https://github.com/arian/mootools-core/compare/fix-2265-style-text\nOne issue still remains, using IE8:\njs\nvar style = new Element('style', {type: 'text/css'});\nconsole.log(style.styleSheet); // undefined\nWhile using\njs\nvar style = document.createElement('style');\nstyle.type = 'text/css';\nconsole.log(style.styleSheet); // object\n. @ibolmo any ideas?\n. or @cpojer \n. this test fails: https://github.com/arian/mootools-core/commit/b3e80ee15b955e0ff4d9977fbedc9adca2afec0b#L1R44\nThe idea is: create an element where CSS is applied by a CSS class. So getStyle('opacity') should return 0.5 if the filter has alpha(opacity=50).\nHowever when you set the opacity to 1, and then set it to null, it should return 0.5 again, but it doesn't.\nAs far as I can see, if element.style.filter was set once, it isn't removed, but is set to filter: ; zoom: 1, so it doesn't fall back to the defined CSS.\n. ah, we should be using element.style.removeAttribute('filter'); when the filter property is empty.\n. Hi Christian,\nWe're aware of this and in the latest unreleased version this is already\nfixed. We'll release 1.4.4 soon. Until then you can use 1.4.2.\nAlternatively you could (temporarily) use the native\nel.getAttribute('data-foo');\nOn Thu, Feb 2, 2012 at 9:50 AM, ChristianEhlscheid <\nreply@reply.github.com\n\nwrote:\nHi there,\nfirst of all, great framework!\nI'm using a Mootools heavily in my projects.\nWhile testing some stuff in IE7 lately I discoverted that\n\"element.get('data-foo')\" returns \"null\", even though the\nelement had this data attribute set.\nThe cause of this behaviour is a recent patch:\nif (!attr | attr.expando) return null;\nIn IE7 all data-attributes have the expando property set to true.\nThis patch breaks alot of code, Mootools More Form.Validator for example\nwhen used with the data-validators attribute.\nAnd there are probably more classes out there that just do\nelement.get('data-XXX').\nI don't know why this change was made, but I think there were proper\nreasons to implement it ...\nSo probably the whole codebase has to be checked against\n\"element.get('data-XXX') calls and patched to\nelement.getAttribute('data-XXX').\nChristian\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2269\n. done\n. Fixes #2280.\n\nTested: IE6, IE8, IE9, Firefox, Chrome.\n. Doesn't work in Opera yet..\n. Fixed opera issues and Fx for margins.\n. Ok, I was able to reproduce this in the tests, and found that #2282 would fix this.\n. @kguelzau try MooTools edge in jsfiddle. I think #2459 has the same problem but it should be fixed in master.\n. Yeah, usually the full screen result under share works ok in IE8/7.\nOn Fri, Feb 22, 2013 at 12:52 PM, kguelzau notifications@github.com wrote:\n\njsfiddle seems to be broken for IE8/7 right now. So I can't test it.\nBut the new code seems to be OK since \"element.getComputedStyle('filter')\"\nis used to check for filters in non inline styles.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2286#issuecomment-13939901.\n. awesome!\n\nOn Fri, Feb 22, 2013 at 5:09 PM, kguelzau notifications@github.com wrote:\n\nhttp://jsfiddle.net/kguelzau/Cdrdh/4/\nworks with mootools edge in IE7/8\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2286#issuecomment-13951116.\n. Or we can solve this as it's done here by @kamicane https://github.com/kamicane/mootools-core/blob/2.0/Source/Core/Core.js#L57-59\n. Tested: Chrome + IE8\n. Fixed in 1f73ef0\n. I don't even know/care what it does.\n. But it should by relevance.\n\nOn Thu, Feb 16, 2012 at 10:36 PM, Olmo Maldonado <\nreply@reply.github.com\n\nwrote:\nI still think that MooTools Core should be the very low level\nimplementation of things. It shouldn't be categorized by usage.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4009943\n. Why do you need to work with Flash?\n\nOn Thu, Feb 16, 2012 at 10:47 PM, Olmo Maldonado <\nreply@reply.github.com\n\nwrote:\nMy definition of relevance is defined by association.\nI'm associating Core code as essential.. must have. If I ever need to work\nwith Flash I would/need to associate I would/should assume it's in Core..\nnot in More.\nOn Thu, Feb 16, 2012 at 3:37 PM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nBut it should by relevance.\nOn Thu, Feb 16, 2012 at 10:36 PM, Olmo Maldonado <\nreply@reply.github.com\n\nwrote:\nI still think that MooTools Core should be the very low level\nimplementation of things. It shouldn't be categorized by usage.\n\nReply to this email directly or view it on GitHub:\n\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4009943\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4009973\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4010185\n. Do we need a Java Applet helper?\n\nOn Thu, Feb 16, 2012 at 10:49 PM, Arian Stolwijk arian@aryweb.nl wrote:\n\nWhy do you need to work with Flash?\nOn Thu, Feb 16, 2012 at 10:47 PM, Olmo Maldonado <\nreply@reply.github.com\n\nwrote:\nMy definition of relevance is defined by association.\nI'm associating Core code as essential.. must have. If I ever need to work\nwith Flash I would/need to associate I would/should assume it's in Core..\nnot in More.\nOn Thu, Feb 16, 2012 at 3:37 PM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nBut it should by relevance.\nOn Thu, Feb 16, 2012 at 10:36 PM, Olmo Maldonado <\nreply@reply.github.com\n\nwrote:\nI still think that MooTools Core should be the very low level\nimplementation of things. It shouldn't be categorized by usage.\n\nReply to this email directly or view it on GitHub:\n\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4009943\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4009973\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4010185\n. HW accelerated animations with the Silverlight I assume?\n\n\nOn Thu, Feb 16, 2012 at 10:54 PM, Darren Waddell <\nreply@reply.github.com\n\nwrote:\n@arian YES! Also a Silverlight helper. Please make this a priority and\ninclude it in Core over other less useful features like event delegation or\nhardware accelerated animations.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4010330\n. done.\n. it's always ltIE9 here. cause IE9 has opacity. You'r doing Math.min(opacity, 1) for readability, instead of >= 0.95?\n. js\nif (opacity == null || opacity == 1) opacity = '';\nelse opacity = 'alpha(opacity=' + Math.max(0, opacity * 100).round() + ')';\n\nthat would work for me. If you would do .setStyle('opacity', 2) it would set it to 200, but that's fine, nothing will happen (as far as I know), and .getStyle('opacity') would return 2, like in other browsers.\nOnly exceptions are 1 to remove the ugly black border, and values < 0 because that would break the regex.\n. Also check out https://github.com/arian/mootools-core/commit/4cdf46d / https://github.com/arian/mootools-core/compare/bug-2310\n@kentaromiura your specs seem to pass with my fix too...\n. Tested this in IE6/IE8.. need to test this in IE7 for those crashes we had...\n. Ok, doesn't work in IE7... changing clone.removeAttribute (https://github.com/arian/mootools-core/blob/4cdf46d/Source/Element/Element.js#L848) to Element.erase fixes the failing test, but creates some new failures\n. It's because the properties of classObject, contrary to the ones of intiObject, are not own properties, but are on the prototype. Object.getLength uses Object.keys which only returns own properties (per spec).\nAlso see #2057.\nMaybe we could explain this better in the docs\u2026\n. This has been fixed in 1.4.5\n. hmm, yes, can you give us a small snipped of code on http://jsfiddle.net or http://tinker.io that causes this.\nProbably the fix would be ('' + from).slice\n. For now you can fix this by removing the 'px' unit option: https://tinker.io/3d395/1. I'm looking into it though.\n. Can't really change this in 1.x, see https://mootools.lighthouseapp.com/projects/2706/tickets/1045-asp-net-bug\n. Fixed with #2401\n. Use MooTools edge in jsfiddle: http://jsfiddle.net/uaCJd/15/\n. https://github.com/mootools/mootools-core/blob/160cdb3/Source/Element/Element.Dimensions.js#L219\nshould probably be\njs\n    return parseInt(styleString(element, style) || 0, 10);\n. @kguelzau care to test it with a build without the flash detection?\nFor example remove those lines: https://github.com/mootools/mootools-core/blob/master/Source/Browser/Browser.js#L87-96\nI don't know if you know how to build it, but it's described here: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master\n. Maybe we can just remove those stupid checks in 1.5?\n. For some reason the <svg> tag isn't a instance of Element anymore... \nFor example try\njs\n$('svg2') instanceof Element\nin firefox or chrome, firefox returns false and chrome returns true.\nThough you'd think the <svg> element in a HTML document would be an Element, which would have Element.prototype so all the MooTools methods.\n. However\njs\ndocument.createElement(\"svg\") instanceof HTMLElement\nreturns true in Firefox 12.\n. but it does look like mootools does something somewhere:\nWith MooTools: http://jsfiddle.net/f36kT/1/\nNo framework: http://jsfiddle.net/f36kT/2/\n. Ok, so the problem is this, MooTools does something like:\njs\nBrowser.Element = window.Element;\nvar Element = function(tag, properties){\n    // do stuff\n};\nElement.prototype = Browser.Element.prototype;\nThat way the prototypes are shared.\nFor some unknown reason however, the new methods in Browser.Element.prototype don't show up in the prototype chain of SVGSVGElement.\nIn plain js:\n``` js\nvar OldElement = window.Element;\nvar svg = document.getElementsByTagName('svg')[0];\nconsole.log(svg);\n// svg is an instance of OldElement\nconsole.assert(svg instanceof OldElement);\n// implement new property in OldElement\nOldElement.prototype.test = 'test';\n// Now because svg is an instance of OldElement, it should have this property\n// but it has not\nconsole.assert(svg.test == 'test', 'svg.test should come from SVGSVGElement.prototype');\n// while a normal element has\nconsole.assert(document.body.test == 'test', 'document.body.test should come from HTMLElement.prototype');\n```\nhere the svg.test == 'test' assertion fails in firefox.\nSo as far as I could see this is a Firefox bug. \n/cc @sebmarkbage, @jdalton, @kamicane.\n. Actually this already fails (in plain js):\njs\nElement.prototype.test = 'test';\nvar svg = document.getElementsByTagName('svg')[0];\nconsole.assert(svg.test == 'test');\n. reported to firefox: https://bugzilla.mozilla.org/show_bug.cgi?id=740811\n. @w8r, you can probably do the same for 1.3, 1.4.\n. The Firefox bug was resolved/fixed some days ago: https://bugzilla.mozilla.org/show_bug.cgi?id=740811\nSo hopefully that fix will land in Firefox soon.\n. This bug should land in Firefox 13 (It should be in Aurora soon according bugzilla). So in 6 weeks most users will update to Firefox 13, in the mean time I propose people can use this fix by @w8r, it doesn't have to be within mootools itself. I don't think we need to release a separate version with this temporary fix.\n. This seems to be fixed in firefox 13.\n. http://mootools.net/demos/?demo=MouseWheel works for me in Firefox 12 for ubuntu.\n. It's just oldIE being oldIE.\nIt can't handle filter: alpha(opacity=xx) with alpha transparent pngs. Perhaps there are other solutions somewhere on the internet, but it's not something we can't fix easily in MooTools.\n. Do you have jsfiddle.\nhttps://github.com/mootools/mootools-core/blob/160cdb362/Source/Fx/Fx.Tween.js#L90 is in Element.implement, so this in the method is the element.\nThe line below that: https://github.com/mootools/mootools-core/blob/160cdb362/Source/Fx/Fx.Tween.js#L92 is in the chain method where the this is the Fx instance, so the element is this.element. \nSo it should work correctly..\n. Seem related to #2274\n. Well, if the first argument is not set, it should use getStyle('top') which returns auto which should become 0px I think..\n. Can you please provide a jsfiddle with an example?\n. Are you using with or without 1.2 compatibility?\nOn Tue, Mar 27, 2012 at 11:42 AM, axiomer <\nreply@reply.github.com\n\nwrote:\nVersion: 1.4.5. with compatibility\nTestcase:\n     function boundFunction(a, b) {\n       console.log(a + \",\" + b);\n     }\n     var callback = boundFunction.bind(this, 1);\n     callback.apply(this, [2]);\nShould print:\n     \"1,2\"\nDoes print:\n     \"1,undefined\"\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2339\n. See #2331.\n. Basically duplicated of #2353 \n. So that is this line: https://github.com/mootools/mootools-core/blob/master/Source/Fx/Fx.CSS.js#L106\nCould we narrow it down when exactly those are null?\n. checkout the code standards: https://github.com/mootools/mootools-core/wiki/Syntax-and-Coding-Style-Conventions\nBasically:\n\n``` js\nif (x){\n}\nvar obj = {a: 1, b: 2};\n```\n. @kentaromiura what's the status on this? Perhaps a few tests?\n. Use http://jsfiddle.net/bq4YY/5/ or http://jsfiddle.net/bq4YY/4/\nWhat changed is that you need to return a truthy value in the chained function, because of https://github.com/mootools/mootools-core/blob/master/Source/Fx/Fx.js#L106\ncallChain will return the value of the next function, or false if the chain is empty (http://mootools.net/docs/core/Class/Class.Extras#Chain:callChain), so that's why it does that check this way.\n. True, but in DOMEvent relatedTarget should probably still be set\nhttps://github.com/mootools/mootools-core/blob/master/Source/Types/DOMEvent.js#L59\n. @zenlunatics what about mouseenter?\n. That line: https://github.com/mootools/mootools-core/blob/3e9875e6d/Source/Types/DOMEvent.js#L67\n. That's the fix: http://jsfiddle.net/b67n43em/1/\n. js\nfunction fix(e) {\n    var event = e.event;\n    if (event.type == 'mouseenter') {\n        e.relatedTarget = event.fromElement;\n    }\n    if (event.type == 'mouseleave') {\n        e.relatedTarget = event.toElement;\n    }\n}\n. @cpojer opinion did you ever need this? I think I would add it to the DOMEvent object instead of an argument... however sometimes that one isn't passed.. but in that case you can't pass the type either as second argument... \n. Why not:\njs\nvar t = 'textchange';\n\u200b$('text').addEvent(t, function(e){\n// e.type = keyup\n// t = textchange\n})\u200b\n. Also here is another problem described, when you change input.checked in the change event: http://allbtechebooks.blogspot.com/2012/04/mootools-event-causes-infinite-loop-in.html\n/cc @csuwldcat \n. Ah, I found it via twitter..\n. @csuwldcat this is your thing i guess..\n. @oelmekki true, subclassing Request isn't very nice, however that's more difficult than it looks... without a complete rewrite.. pull request are always welcome though ;)\n@chrispitt @DimitarChristoff any news on this.. I think setting properties of the method, url and data isn't a bad idea.\n. #2344 has the same problem, but for the url instead of method.\n. Probably this is because IE, Firefox and Opera have a native mouseenter event, but Webkit doesn't.\nSee https://github.com/mootools/mootools-core/blob/6e16f69db9/Source/Element/Element.Event.js#L149-168\nI'm not sure we should/can fix this.\n. what do others do? \nfor example nodejs simply does this: querystring.stringify({a: 1, b: {c: 2}}); => 'a=1&b=', so it's probably a bit server specific.. are there any other good examples?\nAlso isn't e4e637a66 / https://mootools.lighthouseapp.com/projects/2706/tickets/762 related?\n. Fixed by pull request #2371. If fixes #2359 is will be closed automatically by github.\n. Not handled properly how?\nOnly if the class has an addEvent method, it will do something with onXyz options: https://github.com/mootools/mootools-core/blob/master/Source/Class/Class.Extras.js#L111\n. Yes, that's because of the delete options[option], it will not change though.\n. changed this to wontfix.\n. I think this is fixed in 1fcdafd79\n. I remember something like that indeed. The fiddle shows NaNpx though.. Can't we just remove the Browser.opera check for width.. maybe they fixed stuff that used to be broken at that time...\n. Fixed with #2401\n. @DimitarChristoff is correct: https://github.com/mootools/mootools-core/blob/dcfebc502/Source/Element/Element.js#L268\n. Probably you can use Element.get(objElement, 'tag') or something similar.\n. @shaundunne what's the OSX Lion UA string? (navigator.userAgent in your JS console)\n. Perhaps it's because Firefox has native mouseenter and mouseleave since 1.4.2. Delegation is in core since 1.4.0.\n. @DimitarChristoff probably that's it indeed..\n. See #2470 \n. This is on purpose. .set here calls setOptions which just uses addEvent only for events.\n. Same as #2368, and @DimitarChristoff is correct.\n. In Google Chrome, on Ubuntu, I get the correct results (4 and 1)...\n. Closing this.. let me know if you still have problems with this.\n. Instead of doing String(value) in the loop, you could do it once before the loop.\n. It looks like it's this line you're referring to:\nhttps://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Event.js#L92\nI'm wondering why there are invalid objects in there in the first place..\n. Any idea how we can reproduce this?\n. Maybe you could setup an isolated jsfiddle or test?\n. I see, however in our isolated tests, for example https://github.com/mootools/mootools-core/blob/master/Specs/1.4client/Element/Element.Event.change.html I don't get any troubles in IE8.\nCould you recreate such an isolated tests (with just some codes that reproduce the problem), and are you sure there is no code or plugin messing with the events storage (element.store('events'))?\n. Especially because on your page, there is a lot going on which is difficult to debug, unfortunately.\n. In case you're passing elements, and especially forms, you should use an array: .pass([element]). If it's not an array, it tries to make it an array, and with some elements the browser can return unexpected elements. For example with select elements it can return all opion elements, instead of [select]. This is also the case with form elements.\nThis solves it: http://jsfiddle.net/VrfNy/4/\nIf you want the form element in function, you can also just use this, or because obj is defined in a higher scope, you can just use that as well:\nhttp://jsfiddle.net/VrfNy/5/\n. Makes sense I guess. @cpojer?\n. Added pull request.\n. Wich memory leak? Also oldIE empties all those objects when the user leaves the page.\nstorage and collected are not global variables either (they're in the surrounding function). I don't know exactly why MooTools does it this way, because it works like this for at least 4 years, but I guess it gets around many browser bugs and is probably faster.\nSo maybe before changing stuff, lets first understand the problem better. Maybe you could create a simple html page which reproduces the memory leak and describe the steps how you observed the leaks.\n. Maybe an idea is to look more into event delegation, so you don't have many elements with attached events. \n. but why don't use destroy instead of dispose to remove elements?\n. Don't use strict mode with MooTools.\n. It was like this before, but it was also reverted: https://github.com/GCheung55/mootools-core/commit/8521f484f\nI think that Cajon (https://github.com/requirejs/cajon) shouldn't just throw out \"use strict\"s outside some function scope, which it does if I understand you correctly.\n. What about\njs\nvar Thing = new Class({ Extends: Events });\nClasses created by Class are not really made for extending with the classic JS way.\n. It's why the reset function exists in Class.js btw.\n. It isn't very clever yet that it actually matches the @media rules, however search isn't very clever or bullet proof either, so I think that'll be ok for now. If you fix that one little code style thing i'll merge this.\n. @tristanlins thanks! Do you know anything about #2345? It seems in that case rule.rules || rule.cssRules results in null...\n. Is it only for input elements.. otherwise you should also check for child elements..\n``` js\nvar elements = [this].append(Array.from(this.getElementsByName('*'));\nvar ids = elements.map(function(element){\n    var id = element.getAttribute('id');\n    element.removeAttribute('id');\n    return id;\n});\n// later\nfor (var i = 0; i < elements.length; i++) elements[i].setAttribute('id', ids[i]);\n``\n. Yes. This is why testing is very important here.\n. maybe this will help: https://github.com/xdissent/ievms/\n. references: #2083, #2163, https://github.com/mootools/mootools-core-specs/pull/22\n. what about usingelement.erase/get/set('id')added in #2083\n. Maybe the feature test in #2083 is enough too.\n. Yeah, I'd like to have this feature. And we do accept pull requests, so I don't know what's going wrong...\n. I was more thinking about something like https://github.com/arian/mootools-core/compare/fix-2389-multiple-classes\n. I don't liketoggleClass.. man, multiple toggleClass :fearful:.. but you're probably right..\n. Awesome @gonchuki, so basically.getStyle('border-left')returns the properties in a different order than other browsers, which returns inNaN`s eventually... so that'd be good to fix.\n. This is not a bug.\nSee this jsfiddle: http://jsfiddle.net/24HJD/1/\nWhat .getChildren() does is return an collection, an instance of Elements. Elements has also all Element methods, including getFirst(). However Array also has a getLast method, no getFirst() method because that's always array[0]. What happens is that Elements has Element.getFirst() but Array.getLast().\nSo the line with getFirst() it gets the first element of each element in the collection. getLast returns the last item of the collection. A collection doesn't have a id property of course, while the last element does have one.\nHope this clears it up a bit. It is a bit inconsistent in this specific case, but on the whole it is better that array methods take precedence over Element methods. \n. :+1:\n. I think it should return what's passed in xhr.open.\n. but looking at the code that happens.. (except with GET data stuff)\n. Chrome on iOS is basically safari in a webview... \n. For statistics you should save the raw data. \nUsually Browser.stuff is used to show certain features or not. Like hide an input[type=\"file\"] on iOS because it won't do anything, but will in Android.\nI think changing the UA string to CriOS is done on purpose so it doesn't match chrome, because it's not actual Chrome, but safari, so maybe that should return safari.\nFor the stock android browser safari makes sense as well, because it's webkit and Browser.platform.Android is true for Android. Browser.Platform.ios for iOS.\nAnyway, I don't think we should change too much, using Browser isn't usually a good idea anyway.\n. 1.4client would be fine. Now we have this fix, we can pull it in 1.4.6. (both #2325 and #2364 have the 1.4.6 milestone.. :))\n. Basically copy those two jsfiddles in the specs.. update it a bit.. check if it fails without the fix.. and verify it passes with the fix.\n. Looks awesome\n\nmerging...\n. pulled\nOn Fri, Aug 10, 2012 at 4:43 PM, gonchuki notifications@github.com wrote:\n\nIf you don't mind to merge again/cherry-pick (or manually edit), I\nacidentally left a trailing comma on the spec\nhttps://github.com/gonchuki/mootools-core/commit/7f59171b1a578fd6fb05ef7f1e93835057cfe79a\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2401#issuecomment-7646494.\n. Only MooTools 1.2 breaks. MooTools >= 1.3 overwrites .contains because it's not in this list: https://github.com/mootools/mootools-core/blob/c7a161d85/Source/Core/Core.js#L266-268\n\nThat said, we probably should prepare for those new methods and make our API compatible in 1.4.6 and 1.5.\n@gutworth what's the current status? As far as I know it's only a proposal, but now it's implemented it probably won't change a lot, will it?\nAlso, what other new methods can we expect, I saw the string extras, Array.from/Array.of, and some number methods right?\n. That's great to hear. I do think we should change String.prototype.contains to match the signature with ES6 though in 1.5.\n. Needs a fix for MooTools 1.2.6, as it probably breaks some selectors ($$) too: https://groups.google.com/forum/#!topic/mootools-users/W7MHwTFHYQ4\n. Okay, this problem is solved for 1.2 now too, and released, so we can close this! http://mootools.net/blog/2013/02/19/mootools-1-2-6-released/\n. I think you can rebase / squash this stuff too. iirc GitHub has become smarter with this stuff.\n. yep, much better. I'll pull this if everybody agrees :+1:\n. Great work!\nA way to clean it up would be to create an object with style getters, that's probably already a bit cleaner than all the inlined checks in the method.\n. yeah, looks good, maybe just those stylistic changes:\n``` diff\ndiff --git a/Source/Element/Element.Style.js b/Source/Element/Element.Style.js\nindex 7ae578d..adfdc30 100644\n--- a/Source/Element/Element.Style.js\n+++ b/Source/Element/Element.Style.js\n@@ -123,7 +123,9 @@ Element.implement({\n            result = this.getComputedStyle(property);\n        }\n        if (hasBackgroundPositionXY && /^backgroundPosition[XY]?$/.test(property)){\n-           return result.replace(/(top|right|bottom|left)/g, function(position){ return namedPositions[position]; }) || '0px';\n+           return result.replace(/(top|right|bottom|left)/g, function(position){\n+               return namedPositions[position];\n+           }) || '0px';\n        }\n        if (!result && property == 'backgroundPosition') return '0px 0px';\n        if (result){\n@@ -231,4 +233,5 @@ Element.ShortStyles = {margin: {}, padding: {}, border: {}, borderWidth: {}, bor\n });\nif (hasBackgroundPositionXY) Element.ShortStyles.backgroundPosition = {backgroundPositionX: '@', backgroundPositionY: '@'};\n+\n })();\n```\nI can commit this and merge it.. or maybe if you fix it, maybe rebase it, we can just press the nice green merge button ;)\n. The problem is that transparent pngs are ugly with the filter. That's why it's removed when it's 1.\n. Yes :+1:, let me know when I can merge.\nOn Wed, Aug 22, 2012 at 3:07 PM, gonchuki notifications@github.com wrote:\n\nlet me know if this gets green light so I can rebase to get it ready for a\nmerge.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2411#issuecomment-7933337.\n. great work again! Maybe next time rebase on mootools/master, that's even cleaner :)\n. Also, gzip. It's not that big of a deal iiuc.\n. Also why not just keep https://github.com/mootools/mootools-core/blob/cb327bf3/Source/Element/Element.Style.js#L216-232 which is a bit shorter.\n. Nice work, good start! :+1:\n. Use [\"Chris\", \"Kate\", \"Steve\"].each(function(item, key){ ... }) or for (var i = 0; i < array.length; i++){ ... } loops. Not for-in loops for arrays.\n. Duplicate of #2265\n. It has already been changed: https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Style.js#L169\n\nI'll merge the test.\n. Scratch that... \n. It's already there: https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Event.js#L141\nSo that should be fixed in 1.4.6!\n. Hi @magicalhobo, sounds useful, can you create a new issue for that so it's easier to track?\n. Looks good.\n. So basically it's missing\njs\nElement.Styles.backgroundSize = '@px';\n. I think this would be good, so it still removes the unload which is used for gc:\n``` diff\ndiff --git a/Source/Element/Element.js b/Source/Element/Element.js\nindex db38211..0197a1c 100644\n--- a/Source/Element/Element.js\n+++ b/Source/Element/Element.js\n@@ -898,13 +898,7 @@ Element.implement({\n [Element, Window, Document].invoke('implement', {\naddListener: function(type, fn){\n\n\nif (type == 'unload'){\nvar old = fn, self = this;\nfn = function(){\nself.removeListener('unload', fn);\nold();\n};\n} else if (window.attachEvent && !window.addEventListener){\nif (window.attachEvent && !window.addEventListener){\n            collected[Slick.uidOf(this)] = this;\n        }\n        if (this.addEventListener) this.addEventListener(type, fn, !!arguments[2]);\n@@ -939,10 +933,14 @@ Element.implement({\n });\n\n//\n-if (window.attachEvent && !window.addEventListener) window.addListener('unload', function(){\n-   Object.each(collected, clean);\n-   if (window.CollectGarbage) CollectGarbage();\n-});\n+if (window.attachEvent && !window.addEventListener){\n+   var gc = function(){\n+       Object.each(collected, clean);\n+       if (window.CollectGarbage) CollectGarbage();\n+       window.removeListener('unload', gc);\n+   }\n+   window.addListener('unload', gc);\n+}\n //\nElement.Properties = {};\n```\nThis way unload will be collected too, which is good probably.\n. Closing in favor of d54312c577\n. .set('send', ...) uses .setOptions, which only adds new event listeners through .addEvent, so it doesn't replace them. So you should just set the options once, so it only adds the events once. Then use .send() multiple times.\n. This wouldn't be an easy fix, because IE (< IE9) can't handle script with innerHTML, so without https://github.com/mootools/mootools-core/blob/d54312c5/Source/Request/Request.HTML.js#L34-36 it wouldn't execute any JS at all. In other browsers I've tested (IE9, Chrome) it doesn't execute the JS either, but at least it creates the script element. According to this it can create the script tag if there are some other DOM nodes before the script tag, but haven't tried that myself.\nI see you made a commit but this probably doesn't work cross browser, which is why we can't simply pull that.\nAnyway, this would require some cross browser testing.\nBesides that, we can't break backward compatibility. So unless we can do this in a very elegant and simple way we could add it as option, but otherwise I don't think it's really worth it. \nCorrect me if I'm wrong, but it looks like you're sending a while DOM tree, and only pick some specific parts out of it? Can't you do this more efficient, with only requesting the correct parts, preferable as a JSON data structure...\nGenerally I think loading the JS through XHR is a bit ugly too, I would try to avoid it.\n. Looking at https://twitter.com/cpojer/status/249088689207144448 @cpojer approves?\n. Do you have an example on jsfiddle? \n. iirc, there were some issues indeed about one year ago which were fixed in Highcharts.\nBut if this has been fixed and it's working now for you too, we can close this I issue I think.\n. Try to move the the onComplete 'option' outside the submit event. Each time you submit, it gets added again.\nSee http://jsfiddle.net/tMPDk/\n. As far as I know, the purpose of Request.JSON is to decode your JSON response, which means:\n- sucess if it has a successful/parsable JSON response\n- failure in all other cases.\nSimple as that.\nSince no response isn't parsable, it failes, which seems correct to me. For me Request.{JSON,HTML} are just some little convenient subclasses to parse your data. If you have special requirements, build your own with Request.\nThat the isSuccess method isn't aligned with the fired events might be a small inconsistency issue though.\nLinking to agent isn't really relevant to the current MooTools Request, because it takes a whole other approach.\n. :+1: would be good to bring more XHR 2 features in.\n. I added some comments, sorry for the nitpicking, but if you fix that we can pull it :smile: \n. You're right, it should simply round the value... Can you send a pull request?\n. Yes, you could try to run the tests: https://github.com/mootools/mootools-core/tree/master/Specs#running-the-tests-in-a-browser. I'm not really sure if there are (good) tests for this specific method.\n. As far as I can see it works in Opera 12. Opera 11.11 is old...\n. Why would you for-in a number? In most cases something else is going wrong.\n. Yes, but this doesn't really matter. .fireEvent still only fires the correct ones. This is done so removing events during a fireEvent still works correctly.\n. this is a mootools-more issue.\n. can you post an example on http://jsfiddle.net?\n. Also, which browser, which MooTools version...\n. I think we could add something like:\n```\nvar input = document.createElement('input');\nvar support = false;\ntry {\n    input.type = 'x';\n    support = input.type == 'x';\n} catch (e){}\nif (!support) propertySetter.type = function(value){\n    try {\n        this.type = value;\n    } catch (e){\n        this.type = 'text';\n    }\n}\n```\n. You can use the Request object:\njs\nvar request = form.get('send');\nrequest.send({url: \"new\"});\nor I think this works too:\njs\nform.set('send', {url: \"new\"});\nform.send()\n. it is actually typeOf: http://jsfiddle.net/FEcXE/1/\n. it doesn't entirely: http://jsfiddle.net/FEcXE/8/\nOn Fri, Nov 23, 2012 at 9:54 AM, Cristian Carlesso <notifications@github.com\n\nwrote:\nthis will solve the problem:\nhttp://jsfiddle.net/kentaromiura/FEcXE/7/\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2447#issuecomment-10653285.\n. It outputs object, object, object in chrome...\n\nOn Fri, Nov 23, 2012 at 10:12 AM, Cristian Carlesso \nnotifications@github.com wrote:\n\nin IE it outputs\nobject, object, arguments.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2447#issuecomment-10653665.\n. So this: https://gist.github.com/4163041/2c2cd1e59e107b01fdb89bb26b439e6f10e79053\nor just remove the if (item.callee) return 'arguments'; line!\n. The event models are different between <= IE8 and other browsers. Usually events can come in any order. If you want to sort the actions after some events, you should write something yourself. However often there is a better way.\n. It'd be nice if we would have a little test for this. Maybe you could update your pull request with an extra test in https://github.com/mootools/mootools-core/blob/master/Specs/1.4client/Element/Element.Delegation.html\n. pulled.\n. Submit is a native method. Generally you shouldn't use input names that are also methods on Element. For example the native <input name=\"submit\" type=\"submit\"> will break form.submit() (even without MooTools).\n. Basically the idea behind emulation is that it adds _method and just uses post, so it works cross-browser/platform. If you don't want that, and want to use your own _method value, just set emulation to false.\n\nOr do you expect that Request filters duplicates? I'm not sure if that's really worth the effort (if you pass a string as data, we'd have to parse it correctly, and check for duplicates...).\n. Well, then set emulation to false. Also Django accepts foo=bar&foo=yo, so it's probably valid, or at least not uncommon. For reasons mentioned in my first comments, we've decided to don't fix it.\n. Why would property not be a string?\n. I think this is actually fixed in master.\nOn Tue, Jan 8, 2013 at 5:58 PM, Valerio Proietti\nnotifications@github.comwrote:\n\nTry to style opacity before fading using MooTools, rather than css. I\nbelieve MooTools sets a flag somewhere, because of how opacity is\nimplemented in IE.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2459#issuecomment-12005895.\n. Both new Color('#ccc') and #ccc'.hexToRgb() work fine for me. Which MooTools version are you using?\n. Should work: http://jsfiddle.net/vzF7q/\n\nGoogle has the same MooTools Core version. Color however is in MooTools More. If you use More 1.4 it should just work.\n. Tested the specs in IE6, IE8, IE9, Firefox 18, Chrome 24 and Opera 12.\n. I added the try-catch because it's the same in Function.js. I guess when browsers define it with the {writable: false} definition or something\u2026, @cpojer ?\n. In the next version the flash detection will be removed by default (it's only in the 1.4 compat).\n. Hey, thanks for your research and fix. I opened a new pull request with a slightly other fix #2470\n. This is expected, because .pass uses Array.from now, which converts all array-like objects into arrays. Previously 1.2 only did a simple 'is-array' check. So yeah, you should use the extra [] here in this case.\n. Fixes #2443 \n. Not that I know of.\n. This is only when you have 1.2 compatibility enabled (not default in 1.4.5).\n. @dvdplm, the outputs are the same for me... which is correct because you use the nocompat version.\n. Cool, didn't know about this one yet. Do you have a link to the w3c spec?\n. Looks good. Is there a simple way to verify this actually solves the problem?\n. It is not that it's legacy code, but I cannot remove it because would break backward compatibility and many applications.\nBut can't you just use Browser.Platform.ios?\n. I don't think we want to fix this in MooTools. Especially because it's not really a common issue, not clearly specified in any specification and with different implementations (for example Chrome doesn't prevent ctrl+w while it does prevent other combinations). \nI don't particularly like preferring attachEvent to the standard addEventListener. \nPerhaps it's a cleaner solution to have a separate module/function that you can can call once to fix this. e.g.:\n``` js\npreventDefaultKeys(element);\nfunction preventDefaultKeys(element){\n    if (element.attachEvent) element.attachEvent('keydown', function(e){\n        (e || window.event).keyCode = 0;\n    });\n}\n```\n. Can you re-create this issue on https://github.com/mootools/mootools-more/issues ?\n. you're right though ;)\n. @cpojer I think you're the expert here...\n. No.\nWant to contribute, read http://mootools.net/blog/2013/03/18/contributing-to-mootools/\nCurrently we're working on prime, elements + co, see the mootools organization here on GitHub.\nWe still want to release new releases for mootools-core / more though, but could use some extra time. \nA lot of developers are busy with work, life and other things and can't really work on mootools every day / week.\n. For mootools-core and more a great way to contribute is test pull requests, comment on things, provide fixes for issues, or comment that issues are not reproducible or incorrect.\n. Also note that moobile isn't developed by MooTools Core developers.\n. It is in the docs, isn't it: https://github.com/mootools/mootools-core/commit/27c958b142060af8d2e8b83be06ce3f7b8eab512\n(Although it might not be live yet.)\n. Ah, good catch.\n. Thanks for the comments @gonchuki @swhiteman. Looks like we can close this.\n. Why would you put objects that contain functions into Object.toQueryString?\n. I added your commit and rebased this pull request.\n. Yes, they're in the 'Specs' folder.\nThat folder also contains a README that should explain how to run them.\n. @milesj is correct.\n``` js\nvar c = new AClass($('aLink'));\n$('bLink').addEvent('click', c.bFunction.bind(c));\n// or\n$('bLink').addEvent('click', function(){\n    c.bFunction()\n});\n``\n. You forgot the parentheses atthis.cow.feed. \n. How is this related to MooTools?\n. Not sure if I understand it entirely, but maybe the first time the domready event is added, it should execute thecheckfunction so it's sure everything is ready. Then theloadedvariable is set to true so the event is fired immediately for the added and future listeners.\n. What would also help is a jsfiddle or something so we can reproduce it.\n. Which MooTools version and which user agent strings (lognavigator.userAgent)?\n. The UA strings you provided give me the correct versions of IE 8 and 7. I believe we should only check on the UA string, and not make it more complicated than necessary with thedocument.documentMode`. If necessary you can check that for yourself.\nI think I don't have to say anymore you shouldn't rely on user agent strings etc. for fixing specific things in your site. You should use Feature Detection for that.\n. Hmm, you're right. See 601c6dd6 and https://mootools.lighthouseapp.com/projects/2706/tickets/1029\n. I don't think it's really justified to add extra exceptions by some new feature (Browser.computedVersion) though. I see the current behavior is documented.\n. Indeed, browsers lie about there age version, so don't trust that. Better to do some specific detection for the thing you want to use (which you're doing now it seems).\n. Hi @sarvaje \nThanks a lot for the pull request, but #2481 was closed, so I'll also close this one.\nJust a tip for the next time: try to make sure you use the correct code style (tabs etc.), that way we can directly merge your pull requests the next time without extra work :smile: \n. But I don't think there is any way to keep it backward compatible.\n. Related to #2408\n. If Flash isn't there, then navigator.plugins['Shockwave Flash'] is null, so navigator.plugins['Shockwave Flash'].description throws an error. This doesn't matter, however, because it is caught in the Function.attempt.\n. What if we always use gBCR instead of offsetWidth/offsetHeight?\n. .getBoundingClientRect seems consistent: http://jsfiddle.net/msg3y/2 in chrome/firefox...\n. No, you're right :)\n. Thanks for the insights @gonchuki!\n. Firefox is working on it: https://bugzilla.mozilla.org/show_bug.cgi?id=687787\n. It's in MooTools More.\n. Thanks, what @TheShrike and @swhiteman said.\n. This says the same: http://www.w3.org/TR/html5/forms.html#dom-input-value-default-on\nWhat about radio boxes? If you search this document for default/on you'll find a table which types should have value default to on. So checkboxes and radio buttons.\nThis property was optional until html5, in html4 it was optional for all input types except checkbox or radio, which is probably why IE is different: http://www.w3.org/TR/html401/interact/forms.html#adef-value-INPUT\n. It should match the rv part...\nMaybe something with:\njs\nua.match(/(opera|ie|trident|firefox|chrome|version)[\\s\\/:]([\\w\\d\\.]+)?.*?((safari|rv[\\s?]|version[\\s\\/:])([\\w\\d\\.]+)|$)/)\n. Looking good :+1: \n. A little. Browser doesn't have a public API which accepts any UA string. Would be good for testing. I don't really feel much for rewriting it so it's better testable, but it would be a good thing IMO: \n``` js\nBrowser.parse('....')\n\n{name: 'IE', version: '11'}\n```\n. We already deprecated flash version detection, we could just deprecate it Browser.name / Browser.version etc. I don't have problems with that. AFAIK we don't really use it ourselves anymore.\n. I think the behavior should at least be consistent across browsers, so if the old case works fine with an empty string/whitespace, so should the new method.\n\nMaybe\njs\nclassName = className.trim();\nif (className) this.classList.add(className);\nbecause addClass(' asdfd ') would still throw an error with this fix.\n. I think the big difference is because, I guess, with classList browsers can wait with redrawing once it's necessary. If you call that function 3000 times, but at the end it's only changed once, it's only actually changed once, instead of 3000 times in the old case. So the test isn't very realistic, unless your script is crappy and actually changes the class that many times...\n. I think we agree that there is a bug in 1.4.5 when using multiple classes. There are two options:\n1. either addClass/removeClass should accept multiple classes (independent of order) etc. This is what this pull request does. Drawback is the inconsistent API (addClass vs. addClasses).\n2. it should strictly accept one className (check with simple regex).\n. I :+1: \n. This is because $$ returns a collection of elements. getFirst map over that collection and will execute getFirst for each item of the collection. This means it will return [$$('.lastItem')[0].getFirst()] in this case. The li doesn't have any children, so the result is [null]. Then you try to call get on this array, and that method doesn't exist, because it isn't a Elements collection anymore.\nThe reason why getLast works, is because on an elements collection, methods of Array get the precedence over methods coming from Element. So in this case getLast will return the last item or the collection, which is the single div.lastItem element. And that object does have the .get method, so alerts the text.\n. I'm pretty sure this isn't the right way. Also IIRC there is a UserAgent fix that fixes this for IE11.\n. See #2539 \nBut why is there code (of mootools/mootools-more#1218 / mootools/mootools-more#1220 depending on this anyway. Also I'm wondering if this isn't automatically fixed with the changes in Element.Style.js in master, which doesn't depend on Browser anymore.\n. Related #2409 \n. And this should fix #2456 \n. Thanks!\n. Since it's all specs related, I think the code is ok.\nFor the IE11 fix I would suggest timwienk@9ef90cdb.\nIn the README it sometimes refers to ibolmo in links, this should change to mootools.\n. Like I said somewhere before:\nUse npm test, add that to the package.json\n\"scripts\": {\n    \"test\": \"grunt travis:default\"\n  }\nAnd remove those script and before_script lines.\nSee https://www.npmjs.org/doc/misc/npm-scripts.html#path\n. I don't really get why though. If you look at the travis log, it pulls from github.com/mootools/mootools-core, and uses all that, so it's not really testing from another fork...\n. I don't think we should remove all of Browser. Browser detection can be useful, statistics, helping users. Of course it should not be used for sniffing.\n:-1: \n. Very nice.\n. Because the events are not stored at $events, and is internal anyway.\n. Why do you want to see the list of event handlers? Usually this means you're doing it wrong. For example some other code can also add/remove events to that element that doesn't concern your part of the code.\n. the $events are actually the events of the mForm object. So that are events attached to the class instance, not the element.\n. Actually, I think default should be nocompat...\n. I concur with @DimitarChristoff and @ibolmo \n. What @timwienk said. setStyle('opacity', x) doesn't set the visibility anymore, which is a good thing. This have some problems in this fade method, which is why .fade should set the visibility. This makes sense because otherwise links are still clickable and such.\nSo instead of refactoring the entire method, it should do exactly the same as it does now, but slightly different so it sets the visibility at the right moment (which was the original issue).\n. Probably related: c5fa832c1 \n/cc @kentaromiura \n. And probably the wheel property of the DOMEvent object: https://github.com/mootools/mootools-core/blob/master/Source/Types/DOMEvent.js#L55-L57\n. @SergioCrisostomo, can you also put the new spec in a commit, then it's easier to see the diffs. Of course I trust they'll pass in the relevant browsers, unless you explicitly say so... :+1: \n. I think the spec should be in this pr.\nThe test doesn't test the properties though. Can you test if the DOMEvent wheel property is set correctly?\n. Thanks @SergioCrisostomo for the spreadsheet overview.\nI think this fix looks really good now. :+1: \nFor testing we could have one that just checks that its non-zero, positive or negative and not undefined.\n. Just add this in one pull request, it fixes the same thing: making the addEvent('mousewheel') work:\n1. Add Element.NativeEvents.wheel = 2\n2. Fix event.wheel property because of step 1 it is using the native wheel event.\n3. Add test\n. See 601c6dd6 and https://github.com/mootools/mootools-core/issues/2501#issuecomment-18307221\n. Actually, it's (implicitly) documented here: http://mootools.net/docs/core/Core/Core#Type:implement\n. Yes.\n. LGTM.\n. This should not matter. AFAIK clearTimeout works fine when the timer is undefined.\n. What are you using that gives ReferenceErrors?\n. Also setTimeout / setInterval returns an ID, which is just an integer, so it doesn't really matter if that property still holds that value.\n. It doesn't emit errors in any browser afaik, which is why I'm curious where you get those errors?\n. Good catch indeed.\nIdeally changes should be made in https://github.com/mootools/slick, because then the tests can be executed. However iirc there have been slick fixes in this repo, so we need to check that.\n. This is done to prevent problems while removing events while firing events:\nx.addEvent('bar', function(){ x.removeEvent('bar') });\nx.fireEvent('bar');\nundefined isn't that big, so I can't really imagine this would give actual problems.\n. I'm pretty sure this does not fit in MooTools Core.\n. Your pull request looks really good!\nAlso there is no doubt this function can be useful. The question is whether this should be in -core, or somewhere else.\nLet's hear what others have to say...\n. String#splice should obviously work the same as Array#splice. Too bad Array.prototype.splice.call('abc', 1, 0) doesn't work on strings in JS.\n. One difference, looking at Array#splice, is that it returns an array of the removed items.\nI think for here this should be very unintuitive, and not really possible.\n. @ibolmo what if you just want to remove a part of the string, and don't want to insert something new, then rather than passing an empty string/value (null/undefined), the replacement string should be the last argument, like it is in Array.splice... Then it's really optional.\n. Isn't there a way Request, Fx etc. can work with the Promises interface, without actually re-implementing promises in MooTools?\n. We could automatically detect if the native Promise (ES6) is available, or use some dependency injection where any compatible promise constructor can be passed into.\n. The user could add a shim of own choosing, and pass the constructor in the\nconcerning object.\nFor example:\nnew Request({\n  url: 'foo.html'\n})\n  .withPromise(Promise())\n  .then(function(){ ... });\nOr something similar (I'm not very familiar with the exact promise API).\nOn Fri, Oct 31, 2014 at 10:17 PM, Olmo Maldonado notifications@github.com\nwrote:\n\nOnly issue is adopting the ES6 promise would leave a gap for non ES6\nbrowsers. Thus we'd need to create the shim anyway.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2643#issuecomment-61333031\n.\n. Another approach would be something like this: \n\nhttp://jsfiddle.net/y4nf0783/\nThe pro is that it's really simple and short.\nThe cons are\n- The constructor should work like new Promise(function(fulfill, reject) { ... }) (The ES6 promise in Chrome seems to work like that)\n- API is a bit more cluttered.\nIt's basically what when.js node.lift is doing for callbacks, or something like Q.nfcall.\n. Elaborate...\nCould you explain why this change is what we want?\nI've never used the script, so don't really know what it's about. :)\n. I guess @SergioCrisostomo's idea was to run this script do everything to tag a release... Including building files in dist for bower and whatnot...\n. Don't know why Travis is failing, but this seems good to me!\n. The Travis failure seems to be https://github.com/karma-runner/karma/pull/1182\n. @mattcoz, how did this break your site specifically? As far as I can see, Array.prototype.contains is the same for MooTools and Firefox, except in the case of NaN...\n. ES7 changed it to Array#includes, so we can keep it as is: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes\n. https://github.com/tc39/Array.prototype.includes\n. I would accept a pull request.\nIt's basically just adding \njs\nif (this.options.HttpOnly) value += '; HttpOnly';\nOnly question is whether it should be HttpOnly or httpOnly...\n. Travis is actually testing the old Opera 12. Maybe with a:\njs\nif (Browser.name != 'opera') it('should set HttpCookie flag correctly', function(){ ... })\nand a comment to this issue it can be enough.\n. Nice, absolutely!\n. I think we should do this.\n. It's really depends what this method is meant for. Afaik this is mostly meant for regular simple programming problems, and not for internalization. If you start doing that, then there are at least 101 other cases we would need to cover, and the question is where we should draw the line.\n. No, they are newer HTML5 events that are not in MooTools.\nIf you want to use them with addEvent, you can add them with:\nElement.NativeEvents.pageshow = 2;\nElement.NativeEvents.pagehide = 2;\n. @odysseuscm, what's the user agent string? \n. dispose should not remove the ID attribute.\nhttp://jsfiddle.net/4cm2h8rb/ shows that this indeed does not happen.\nIn which situation is the attribute removed for you?\n. didn't intend to do this :fearful: \n. I think that'd be better indeed.\nWe have to move Object.keys to Core.js from Types/Object.js. After that we could rewrite all for in occurrences to use Object.keys.\n. Is there a way to test this?\n. :laughing: \n. What, how did this pass my npm test?\n. Ah, yes of course! Well, CI ftw!\n. Seems :+1: \n. now https://travis-ci.org/mootools/mootools-more is passing again too :ok_hand: \n. Thanks!\n. You can run karma with grunt. Using grunt karma:dev, you can open the test runner in any browser by opening the karma link.\n. MooTools added Function.prototype.bind in like 2006, before it existed in ES5. Unfortunately that version is incompatible with ES5 .bind.\nHowever we fixed that in version 1.3 a few years ago. The old behavior is only there to provide compatibility with old MooTools scripts.\nIn the default download on mootools.net, this compat layer is disabled by default.\nSo if you use the right (default) build, it will work fine, as it should.\n. See #2716 \n. @SergioCrisostomo you can't even normalize these events, because older browsers don't have video/audio support at all. Besides not all events that are currently in NativeEvents are supported by all browsers (input/paste), but it's still useful that MooTools directly redirects it to the native/browser events.\n. Very nice!\nA few things:\n- Some tests are disabled with using xdescribe, for example https://github.com/timwienk/mootools-core/compare/spec-update-part-3...spec-update-part-4#diff-d7242700ac47efe4e538390355c32968R50\nIs that still valid, or was it disabled at some point and never enabled again?\n- chai uses expect(..).to.be.true, where true is a keyword. iirc that doesn't work in IE8, and should be to.be['true']. Is that relevant? (https://github.com/chaijs/chai/issues/124#issuecomment-11639702)\n. > That's a good point. I kind of assumed they made it work. The best workaround is probably to use replace to.be.true with to.equal(true). The same thing should be the case for to.be.false and to.be.null. Will look into that.\nThis is one of the reasons I initially used https://github.com/Automattic/expect.js (and kept using it since, I think chai wasn't really a thing then, the other choice was 'should.js'). \n. :+1: \n. 1. Because of the effort of porting it. But you already did this.\n2. Two PRs would be a nice separation I think.\n. It's still true that request.send() === request?\nIsn't it usually that some action, in the case of request .send() returns a new promise object, which can be seen as a 'placeholder' until the promise is fulfilled or rejected?\n. :ship: it\n. That's because it uses Object.keys now, which internally uses ToObject(o) (for newer browsers at least), which throws for null and undefined. \nFor MooTools, the behavior of other types of values is not documented, so we don't guarantee the result of Object.values(null).\nLooking at the ES2016 proposal for Object.values, it will use ToObject(o) as well, thus throws, so is more or less consisted with MooTools 1.5.2 Object.values\n. I don't think we should do the .addEvent('pointerdown', fn) polyfill for older browsers or browsers that don't support it yet, see https://github.com/jquery/PEP\nWhat could be added is something like https://github.com/mootools/mootools-core/blob/master/Source/Types/DOMEvent.js#L73-L84 for pointer events, so all the interesting properties are available on the MooTools DOMEvent object too.\n. Yes. Same for touchevents, those are not documented at all yet http://mootools.net/core/docs/1.5.2/Types/DOMEvent\n. I'm not sure why you'd want this.\nAlso, you can easily add a RequestFactory that creates request instances with two subscribed events: request and complete, that updates some count, something along the lines of:\njs\nvar count = 0;\nfunction createRequest(options) {\n  return new Request(options).addEvents({\n    request: function() { count++; },\n    complete: function() { count--; }\n  });\n}\n. Should we add the Array.from? I think just changing Array.from to Array.convert should do the trick. Historically $splat or Array.from is used internally, because it's useful for other things, but also to be used outside. Inside MooTools there isn't really a use case for the new Array.from.\nAdditionally I suspect people that want to use the new Array.from either assume a modern environment, or use babel/polyfill or similar.\n. Maybe you should do a search-replace through the entire docs, as Array.from is mentioned here too: http://mootools.net/core/docs/1.5.2/Core/Core#Deprecated-Functions:splat\n. If we decide to add the polyfill, we also need to test it ;)\n. @anutron of course we should maintain backwards compat (with the compat layer stuff), so Array.from = Array.convert.\nWhat I'm not sure of is whether we should add the new ES6 version as polyfill.\n. Looking at this pull request, @SergioCrisostomo just copied the one from MDN, which is likely pretty complete. However I don't think it's a good idea to just include it, as there are many other polyfills (or modern browsers) that developers can easily add themselves if needed.\nOf course, as I said earlier, if MooTools itself would make heavy use of this functionality, such as other ES5 methods like bind/forEach/map, then it would make more sense.\n. One major concern, however, is the API consistency with String.from / Number.from / Function.from.\nI suppose all of those need to change too, otherwise it would be inconsistent and weird.\n. +1 to convert to .convert for those too, like you said.\n. :+1: \n. :+1: \n. I don't think we've ever tested/tried to use MooTools in SVG documents in this way.\nThe error comes from a feature detection test, that expects a HTML page. Apparently el = document.createElement('div'); creates a SVG kind of element that does not have the style property like HTML kind elements have.\nI'm sure we can fix most errors, but I'm not sure how much work it will to make everything work nicely.\n. Why do we need the try catch for window.frameElement?\n. I approve\n. oki\n. It turns out that the id variable was already used in the initialize method, so when creating more instances of Swiff the id variable became NaN and stopped working, see ticket #1040\nhttps://mootools.lighthouseapp.com/projects/2706/tickets/1040\nSince String.generateUID has been changed in just String.uniqueID() I recommitted this: \nhttp://github.com/arian/mootools-core/commit/4c4aabdfe6f6178b2d7789516cbdbb966296fdf3\n. See line: http://github.com/mootools/mootools-core/blob/master/Source/Utilities/Swiff.js#L53\nWe can rename the variable to sid or something, but just using String.uniqueID is just as easy and it doesn't come with extra dependencies since String.uniqueID is in Core.js\n. I just did two commits for Fx.Transitions, which are improvements in my opinion, but don't belong to the documentation improvements.\n. wow, very nice! Good work!\n. Infinity makes probably more sense indeed. I updated it a little.\n. You don't need this if Timer gets into 2.0\n. seems to make sense...\n. looking at http://jsfiddle.net/arian/wgGYu/9/ it makes sense.\n. @kamicane I forward ported your frames  stuff and got rid of the this.prevTime. Made a more subtle this.elapsed property and calculated the dt that way (which is used in the onStep method of Fx)\n. The braces was @timwienk his idea :P\nBut this obviously looks better!\nOn Thu, Apr 21, 2011 at 5:21 PM, cpojer \nreply@reply.github.comwrote:\n\nhttps://github.com/mootools/mootools-core/commit/399554fc83fd460b41a53063093b82d6c464788f\nSorry arian, but when I see too many braces and too much indentation I\ncan't sleep at nights.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/70#issuecomment-1039657\n. +1\n. git fetch mootools\ngit reset --hard mootools/master\ngit cherry-pick 56f4a56\ngit push origin master --force\n\nadditionally you might create and checkout in a new branch with git checkout -b selector-inject after the git reset\n. Started to write some specs here: https://github.com/arian/mootools-core-specs/tree/2.0wip-DOM\n. I noticed 2.0 has Array.prototype.last instead of getLast in 1.x. However in Element.js it still has the getNext, getLast, etc. methods. Not really consistent is it?\n. @Inviz: yea, good point... now we've just last, 'getLastandgetFirst(nofirst, just use array[0] i guess). \n. I also noticed that in IE6-7 DOM.Element.get can return\"\"instead ofnull` for some attributes. We could add\nreturn (...) || null;\nto each getter...\n. You don't want to use .flatten indeed. It recursively flattens the array (slower). And what if you want to pass an array. \n. Is there a mootools-more ticket for this?\n. Could you create a quick jsfiddle which reproduces this issue. Just a few lines of code should be enough. This code you copy-pasted should fix Array.from etc. for nodelists (Array.from(element.childNodes))\n. I think you can use the nocash argument in $ or document.id: https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L267\nEdit: No I think not :P\n. Check out the recent blogposts: http://mootools.net/blog/ and https://github.com/kamicane/mootools-core/tree/define-2\n. For delegation we already do something like that: https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Delegation.js#L76-86 so we add a real event instead of guessing.\nThis pull request is to unify the behavior of oldIE for this event. @csuwldcat is very passionate about it ;)\n. wow, that was difficult: https://github.com/arian/mootools-core-specs/compare/master#diff-1\n. @subtleGradient how?\n``` javascript\nform.setAttribute('action', ''); // \u2192 \n// or maybe?\nvar attr = document.createAttribute('action');\nattr.nodeValue = '';\nform.setAttributeNode(attr); // \u2192 \n```\nSo how did you want to fix this?\n. @Inviz seems to work fine: http://jsfiddle.net/YBcUs/1/\n. This seems to pass the @jdalton test: http://jsfiddle.net/QF9ZA/2/\n. This should fix 1.3 without compat or native bind: https://github.com/arian/mootools-core/commit/5c1df58c0d0\n. In new browsers this changes slows down bind significantly. In IE8 (about 10%) and 7 the difference is less, but still slower (of course) http://jsperf.com/function-proto-bind\n. What about https://github.com/arian/mootools-core/commit/b38e69f886\n. @jdalton: that should already work: http://jsfiddle.net/arian/QF9ZA/6/\njavascript\nvar other = function(){\n    console.log(this.foo, arguments);\n};\nother.bind({foo: 'bar'})(); // \u2192 bar\nother.bind({foo: 'bar'}, 'first').call({foo: 'yeah!'}, 'yooo'); // \u2192 bar, ['first', 'yeah!']\n. So am I missing something? https://gist.github.com/1124879\n. By fix it's: press fork button on github, find the right markdown file (Docs/Browser/Browser.md) on github, click \"edit file\" and fix it on github, press the pull request button on github.\nDid i mention github is pretty nice?\n. Hmm, don't see anything weird in 13.0.782.107 (Developer Build 94237 Linux) Ubuntu 11.04\n. We already added 'paste' and 'input': https://github.com/mootools/mootools-core/commit/24a0a8086d6.\nWe don't care about that old Firefox version. For opera it's a bit annoying. oninput can't just be used as a replacement, because it fires at every input (so also when you type). Maybe @csuwldcat wants to look at this to make this x-browser.\n. Probably only need to fix this one: https://github.com/arian/mootools-core/commit/5c1df58c#commitcomment-518763\n. I've some specs for this already: https://github.com/arian/mootools-core-specs/tree/function-bind\n. I think what @cpojer means if we implement it, we implement it completely according ES5. However @kamicane didn't do that in 2.0 either..\n. See #58\n. can't we put this in -more? It seems to fix edge cases and brings more bytes. I don't care about those slightly differences. If I would care it would be easy to pull that extra code in and done.\n. This will be fixed/re-added in the next update: https://github.com/mootools/mootools-core/blob/master/Docs/Slick/Slick.md\n. Seems like .sort is broken anyway? - http://jsfiddle.net/MVWb2/3/ (alerts 3,1,2)\n. as far as I tested (just typing some stuff in the consoles of IE8/chrome) it seems to work. If this stuff is enough covered by the specs (not really for setStyle/getStyle as far as I see) they also pass in IE6, IE8, IE9, Firefox 6, Safari, Chrome and Opera.\n. note to self:\n<cpojer> arian: can you also add Element.Delegation to Intro.md?\n<cpojer> arian: one suggestion for Intro.md\n<cpojer> put Class on top\n<cpojer> Element as second\n<cpojer> Element.Event and then Element.Delegation\n. Okay, updated some stuff. Feel free to improve it a bit more ;)\n. Guess those should be fine? https://github.com/mootools/mootools-core-specs/pull/19\n. When will this be null or undefined? When it's called with [].indexOf.call(null) this inside indexOf will be the global object, I believe that changed in ES5, but those browsers who need this don't have ES5. See the note at http://es5.github.com/#x15.3.4.4. I guess that makes it a bit harder to throw that TypeError...\n. +1\n. How would we use this? .appendHTML(html, where), like appendText? Also for oldIE we still need the fixes of Element.Properties.html.set.\n. @cpojer yes, I do.\n. Proposed fix: https://gist.github.com/1175698\n. Fix: https://github.com/arian/mootools-core/compare/element-properties-value\nSpecs: https://github.com/arian/mootools-core-specs/compare/element-properties-value\n. Ok, just tested it in IE6, still seems to be something wrong.\nedit: it works now\n. i'd say leave it here, but remove it from the specs. That way it'll work in Chrome etc.\n. Does firefox support loop? And if it does not, I guess it doesn't loop, so false would be correct right? Anyway I suppose this will resolve automatically once browsers fix their stuff.\n. I believe this firefox bug is related: https://bugzilla.mozilla.org/show_bug.cgi?id=449157 and this testcase is linked: http://w3c-test.org/html/tests/submission/Microsoft/video/video_005.htm where firefox indeed fails. So I guess if firefox or any browser does not support this, it should return false... Only thing I could see if you want to use a loop attribute on a non-video element. But that's maybe something for inherited element wrappers in 2.0 :).\n. +1\n. +1\n. I hope you're aware this is for a jQuery plugin and not for MooTools Core?\n. I would agree that prevent is a bit nicer, but for now I don't see the the urge to change it yet, preventDefault is standard w3c and other libraries use it as well so it's easy to remember. I'd say have this for 2.0 or something, but not yet for 1.4.\n. Don't forget to revert/update the specs and MooTools More\n. +1 for @oskarkrawczyk \n. Pulled, thanks a lot!\n. @fabiomcosta seems to be right: http://i.imgur.com/8KGNQ.png\nHowever looking at http://jsfiddle.net/6qf6D/8/ (http://i.imgur.com/Wi7dT.png) it alerts null\n. Yes, that seems to work indeed: http://i.imgur.com/qUZXf.png\n. Interesting. How does (and did) it behave before in IE?\n. for some reason the feature test was changed (probably I broke it :s):\n1.3.2:\n'text': (function(){\n    var temp = document.createElement('div');\n    return (temp.textContent == null) ? 'innerText' : 'textContent';\n})()\n1.4.0:\n'text': (function(){\n    var temp = document.createElement('div');\n    return (temp.innerText == null) ? 'textContent' : 'innerText';\n})()\nShould be easy to fix for 1.4.1\n. seems this is only for elements in the DOM.\n. Only in Firefox right?\n. Specs: https://github.com/arian/mootools-core-specs/commit/87b7ae3b\n. that's a square root sign, it should be \u2713\nOn Tue, Sep 13, 2011 at 9:27 PM, Christoph Pojer \nreply@reply.github.comwrote:\n\n\u221a\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2068#issuecomment-2085500\n. fixed this now.\n\n@w00fz: we need a docs.yml for MooTools core now too for Slick.\n. Where do you see it should return a boolean? returning 'null' (as a string) is correct for null, NaN orundefined\n. Thanks for pointing out, should be fixed on the website soon!\n. Already fixed: #2066\n. Could you provide a small http://jsfiddle.net demonstrating the exact problem.\n. See #2081\n. Thanks everyone for pointing this out and for the suggestions. 1.4.1 should be released soon with this fix, and .fade() sets the visibility, while setStyle('opacity') and tween('opacity') only changes the opacity!\n. already fixed, we'll release a fix shortly: https://github.com/mootools/mootools-core/issues/2066\n. Already fixed: https://github.com/mootools/mootools-core/pull/2068\nThanks for reporting though!\n. Already fixed #2067\nThanks for reporting though! We will release a 1.4.1 very soon.\n. Pull request #2080\n. I think this is a good compromise. .setStyle() and .tween('opacity') only touches the actual property: opacity, however the higher level method, fade, will set the visibility.\nAs shown in the examples in #2074 this is important for overlays, fade-through effects and lots more.\nI also added a visibility argument if which you can set to false if you really don't want to set visibility\n. @fakedarren, yes probably with some explanations indeed.\n. Specs: https://github.com/arian/mootools-core-specs/commit/a4aba9b\n. I believe this is by design, adding all the methods to  elements had some weird stuff, I'm not exactly sure why and how though.\n. I believe this might crash IE7\n. @ibolmo: https://mootools.lighthouseapp.com/projects/2706/tickets/1196\n. wow, nice!\n. It's the same in 1.3: http://jsfiddle.net/2KPtK/2/\n. Yes, you're right...\n. You're correct, however we already fixed it ;) https://github.com/mootools/mootools-core/pull/2067\n. You forgot to extend the Parent class: http://jsfiddle.net/2eATR/2/\n. You have to use $(document.body) at least once to add all the methods to the element in oldIE\n. Where exactly do we use getAttributeNodeNS()? I can't find it in the 1.4.0 source..\n. Right, could you create a jsfiddle, tell which browsers are affected, and report a new issue at https://github.com/mootools/slick/issues. Once you've done that we can close this one.\n. wow, I'm a noob..\n. It used to set the visibility property. We've fixed this already (see #2074) for the next version (1.4.1) which should be releases shortly.\n. yes. However if you pass a event object, or a second argument, it might be fired (whether the selector is matched).\n. Because then you would have to find all added delegates for each parent element  of ul.nav and check if it matches... that's possible, but a bit difficult for now, right?\n. No. Elements have Array AND Element methods. Array methods have a higher precedence than Element methods, which has always been the case.\n. :+1:\n@anutron: yes. For example with require.js you can use the paths configuration.\n. Then why not just use the dependencies argument, it's more readable and shorter.\n. So for now just use what works (standard AMD :D)\n. Little update, see https://github.com/arian/mootools-core/tree/1.5amd / https://github.com/arian/mootools-core/compare/1.5wip...1.5amd\nTodo: test it more, use the requirejs optimizer, with !amd compat block (extending stuff into the global object), etc.\n. Yes, within a few weeks I'll try to finish https://github.com/arian/mootools-core/tree/1.5cjs. The possible build options will be:\n- it can be built by https://github.com/kamicane/wrapup\n- it can be used in Node.js\n- other cjs modules compatible tools can use it.\n- convert it to AMD\n  - It's also possible to convert cjs modules to AMD modules, with r.js -convert\n  - or a simple script like https://github.com/mootools/prime/blob/master/bin/convert-amd.sh\n- it can still be built with https://github.com/kamicane/packager\n. Yes, use only the events object for Elements, use only onEvent for Classes.\nThe .addEvent() method works for both in a more consistent way.\nWe're aware of this inconsistency, but this probably will not get fixed for the 1.x series.\n. check http://jsfiddle.net/NA4V2/1/\nYou can see the selector becomes #billing:country_id. Maybe you'll have to do double escaping :o\n. @ibolmo's right :)\n. We can't fix this for 1.x. The trick is to use a hasOwnProperty check: http://jsfiddle.net/28rak/1/\n. awesome!\n. I don't know, it's unwanted behaviour to me. If it's indeed Slick.getAttribute then it should be fixed there, I wouldn't know how though..\n. But shouldn't it work with other frameworks that do similar things with\nelement methods in IE?\nOn Dec 10, 2011 5:30 PM, \"Fbio M. Costa\" \nreply@reply.github.com\nwrote:\n\nIt's not Slick... It's how the elements are extended on IE by Mootools and\nthe way that expandos are threated as attributes on IE. I don't agree we\nshould fix it there since Slick is intended to be used anywhere, by any\nframework, and should not have anything related to mootools-core inside it.\nAgreed?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2109#issuecomment-3091596\n. This is indeed intended. If you think about it, what would setStyle('opacity', 0) do? Indeed, change the opacity, not the visibility. After the release of 1.4.0 (where we introduced this change), there were many issues with fading elements out, which made us decided to bring this behavior, of setting the visibility, for the .fade method only.\n\nIn the 1.4.0 and 1.4.1 release blogposts we mentioned these changes.\n. doh, thanks.\n. Hmm, so you're saying .set should use .setAttribute for type on button elements...\n. Looks like you're right. The format option seems to be in there for some a pretty long time: https://github.com/mootools/mootools-core/commit/edb8e199\n. We probably need to have Node.js and UglifyJS installed..\nIt should be possible (right @w00fz and @fakedarren), question is if there is a major benefit. I believe UglifyJS doesn't compress a lot more than YUI compressor. It might also be confusing to have two almost identical compressors.\nWe could also just replace YUI compressor by UglifyJS.\n. Indeed, In MooTools 2.0/Milk we'll use Closure or Uglify anyway because we'll need dead-code-branch removal. \n. Yes, I don't really mind, things on Object are usually for normal objects, and this is for window/document/element only.. It could be moved to Element.$uid, but it's also used for window/document which are not really elements.. So the question would be if there would be a better owner object.. \nI don't think we should rename it to another global variable like uniqueId, because $uid has the $ and thus is some private thing..\n. It's just for unique ids used by .store and some other things, like Slick.uid, not to be confused with String.uniqueID(), so it's private, so deprecating something private because of simple a name change would be funny..\n. Slick doesn't use it, it has it's own version: Slick.uid(element).\nHow would this be useful to be public? I'm ok with moving it, but I don't think Object is semantically the right parent object..\nSimply renaming from window.$uid to window._uniqueID doesn't make sense.\n. This is indeed a good suggestion and it has been discussed several times. The biggest concern was the wrapping of the method, which could slow down things, but in real applications this never has been the bottleneck though.\nBecause there is a perf improvement, but not significant enough, other factors like functionality and API design are more important. We feel that just calling this.parent() is the most simple and intuitive way in almost each case. In practice calling this.parent('method') where method would refer to the method method of the parent class usually don't happen, and when it does it is often too confusing.\nIn case it is really necessary it is always possible to use ParentClass.prototype.method.call(this), which is indeed not so pretty, though I never really had to use this.\n. See pull #2126\n. Sounds interesting (and fun, memory leaks in IE7)... \n. I'll try if I can reproduce this..\n. I can't really reproduce this with a small testpage. It seems to use more memory after each refresh indeed, however not a lot more than an simple page with only window.addEvent('domready', function(){ ... }); or window.onload.\nNow i'm not memory IE leak expert, so maybe I'm doing something different then you? I found this little program called 'Drip' (via http://blogs.msdn.com/b/ie/archive/2007/11/29/tools-for-detecting-memory-leaks.aspx) for viewing the memory usage. I don't know if there are other tools for analyzing memory leaks and where they come from..\n. doc note is fine.\n. I vote for a doc note. I have to say that I didn't really tested this, but I have this feeling this might open the door for even more bugs and edge cases. As I understand with a documentation note it's not too hard to work around this, as a user.\n. yes, for 2.0 Base there is this ticket https://github.com/mootools/Base/issues/16 already.\n. It wouldn't be too difficult to use and it's probably a good idea.\nFor this we would need a 1.5, because it would break the comment blocks for those who are using it and it wouldn't be backward compatible.\n. It works without compat. With 1.2compat Element.Constructors is a Hash, which has a map method. In the Element constructor a simple and fast object lookup is done, which happens to get the Hash map method. If you don't use 1.2 compat it will work fine.\nWe won't fix it, see https://mootools.lighthouseapp.com/projects/2706/tickets/1126-new-elementmap-error\n. Yes, they are almost the same, except the one is for special cases of get/setProperty and the other is public API for set/get.\nThe divide probably should be that get/setPropery normalises attributes and properties, while Element.Properties is a public API to hook some custom getters/setters...\nThinking about it like this, class and value should be normalised for get/setProperty, and html/tag can be in Element.Properties \n. isn't this related to #2129?\n. +1 for using Slick.uidOf\n. it's intentional indeed. They used to be the same indeed. If you think about it what you'd expect what setStyle('opacity') would do, indeed, just change the opacity, hence the change. \nWithout compatibility set('opacity') and setOpacity() won't work anymore (yes, there were three ways to set the opacity). With compatibility those two work as they worked before, so they still set the visibility.\n. Pull request: #2159\n. awesome, iLike\n. it just needs some docs. @keeto would you like to make 'em, otherwise I could make some docs too.\n. Thanks, fixed it in 205df1b2fc3\n. We have Browser.Platform.webos already right?\nThough it looks like that won't be true with this UA string.. (we test for webos and this UA string contains wOS)..\n. I'm not familiar with webOS, and how much it changed with the acquisition, but I'd like to keep it webos, rather than adding touchpad, because that's very device specific.\n. :+1:\n. :+1:\n. Once it has specs, i'm ok with it. @thatmarvin, let me know if you need any help, otherwise let me know and I can have a look as well.\n. As we discussed on IRC the units are pretty inconsistent across browsers. Element.measure in MooTools More does a similar trick (although the other way around) with the display: block. \nSo the problem is in setStyle, which probably should return the value in '%' instead. The hack with the display:none doesn't sound as a very good idea to do that every time when you want to get a CSS property that has a length value..\n. Probably better solution in #2282\n. lets wait for 2012 to fix it :)\n. This is how Array.from works, what we use since 1.3.0 in fireEvent. Forms and select elements can work as a NodeList/array-like object (for example try document.forms[0][0] on this page and you'll see it works. A simple workaround for your case is to use .fireEvent('foo', [form]).\n. I can confirm reloading this page http://www.apixelife.com/github/2163/mootools-core-1.4.2.html and http://iamincendium.com/github-2163/mootools-1.4.2.htm both crashes my IE7 in VirtualBox.\n. So that would be this commit: https://github.com/mootools/mootools-core/commit/79c4efe80\n. Why not use Element.implement, like any other method...\njs\n(function(fireEvent){\n    Element.implement('_fireEvent', function(type, event){\n        fireEvent.call(this, type, event);\n    });\n})(Element.prototype.fireEvent);\n. We just pushed that fix. Now we can use happily IE7 again!\n. :+1: i can push this any time you want ;)\n. I think it has to do with 4522d61f83\nping @csuwldcat\n. This is the same as #2172 right?\n. nice, I'll wait for others to comment (@ibolmo, @csuwldcat, @cpojer), but it looks good to me!\n. Did you try this test: https://github.com/mootools/mootools-core/blob/master/Specs/1.4client/Element/Element.Event.change.html\n. You don't need that, just open the html file I linked to, it's in the -core repo now, and that file doesn't require the spec-runner.\n. Thanks! I cherry-picked your single commit that fixed this.\n. :+1:\n. This has to do with IE, if you first set the value, and then set the type, for example:\njs\nnew Element('input', {value: \"hi\", type: \"submit\"})\ndoesn't work either.\nIf you use the selector syntax, the parsed properties are appended to the other properties, so the value is first set, then the type.\nA fix for this would be to set the type first, and after that the value. Not sure if we should do this in MooTools, or that this should be done in your code...\n. I think this is alright :+1:\nOnly thing is if you wouldn't expect this?\njs\nvar a  = $$('div');\nvar b = a.destroy();\na == b == []; // true\n. What Sebastian said.\nkeypress events should pass a charCode value, which is a char that can be transformed with String.fromCharCode to a string representation.\nAlso see http://www.quirksmode.org/js/keys.html\n. hm, yeah, documentation could be a bit more clear about this.\n. interesting.. o_0\nHow could we try to reproduce this? \n. In that modernizr issue, the HTML is this:\nhtml\n <video id=\"video\" />\n <script type=\"text/javascript\">\n    var v = document.getElementById(\"video\");\n    var ans = v.canPlayType('video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"')\n </script>\nSorry for the maybe obvious question (it's still early here ;)), but how does this relate to the bools stuff in Element.js?\n. This is normal.\nThis is a useful class to help you with this stuff: https://github.com/cpojer/mootools-class-extras/blob/master/Source/Class.Binds.js\n. The first test failed in ltIE9 too, wich was fixed by this fix. The second test only failed in IE9 iirc.\n. updated.\n. updated.\n. you can still use $(...) right?\n. I wouldn't mind much\u2026 code looks good.\n. And docs!\nOn Jan 3, 2012 10:36 PM, \"Daniel Buchner\" \nreply@reply.github.com\nwrote:\n\nI'll have em done by this evening. You and your specs, total buzzkill!  ;)\nOn Jan 3, 2012 1:00 PM, \"Christoph Pojer\" \nreply@reply.github.com\nwrote:\n\nwheeere are the speeecs?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2191#issuecomment-3346038\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2191#issuecomment-3346608\n. The more pull request already exists: https://github.com/mootools/mootools-more/pull/1129\n. @chrispitt meet @csuwldcat and @cpojer. Secretly they're lovers, but nobody may know.\n. Awesome.\n. merged.\n. It should: https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Event.js#L140\n. cool :)\n. It should be possible yes, this is my UA string:\n\nMozilla/5.0 Linux U Android 2.3.4 en-us SonyEricssonMT15i Build/4.0.2.A.0.42 AppleWebKit/533.1 KHTML, like Gecko Version/4.0 Mobile Safari/533.1\n. You should be able to feature test the 'position: fixed', like\njs\nfunction () {\n  var container = document.body;\n  if (document.createElement &&\n      container && container.appendChild && container.removeChild) {\n      var el = document.createElement(\"div\");\n      if (!el.getBoundingClientRect) {\n          return null;\n      }\n      el.innerHTML = \"x\";\n      el.style.cssText = \"position:fixed;top:100px;\";\n      container.appendChild(el);\n      var originalHeight = container.style.height, originalScrollTop = container.scrollTop;\n      container.style.height = \"3000px\";\n      container.scrollTop = 500;\n      var elementTop = el.getBoundingClientRect().top;\n      container.style.height = originalHeight;\n      var isSupported = elementTop === 100;\n      container.removeChild(el);\n      container.scrollTop = originalScrollTop;\n      return isSupported;\n  }\n  return null;\n}\nsource: http://kangax.github.com/cft/\n. Can't you just set the emulation option to false?\n. I think this is not really a MooTools bug, because the plugin is really terrible. It just overwrites many functions, even prompt() and alert()!\nOn the other hand window.scrollTo is not part of any specification, but browsers have this feature since like forever..\n. And by overwriting it sets all those functions to null, not even to an empty function, or another function to let the user know something has been blocked.\n. I made a start https://gist.github.com/1629934.\nThe mootools specs don't pass yet for some cases, and .getParent() and other methods that use reversed combinators will be a bit harder too.\n. Fixed in 9609878 by moving it into 1.4compat\n. I believe it's very difficult/impossible to access that stuff cross-domain.\n. new Element creates an element in the current document. You can't simply move that to another document (See notes of appendChild: https://developer.mozilla.org/en-US/docs/DOM/Node.appendChild?redirectlocale=en-US&redirectslug=DOM%2Felement.appendChild#Notes)\n. It was marked as wontfix: https://mootools.lighthouseapp.com/projects/2706/tickets/642#ticket-642-10\n. As browser-prefixes are continuously changing, and blink is phasing them out, I don't think we should add something like this.\n. don't we use the 'native' mouseenter / mouseleave now, if available, which IE supports since IE 5.5.\n. Also see this screencast with more links and info: http://allyoucanleet.com/2011/02/16/exploring-the-removechild-single-page-memory-leak/\n. Also see this blogpost about this problem: http://dean.edwards.name/weblog/2009/03/callbacks-vs-events/\n. As @kentaromiura making events async by default will break things. Adding an extra method might work, but that complicates the API, and as nobody has commented on this issue in two years, I doubt about the actual necessity. \n. I think this would be something for when we switch to an AMD builder.\n. Probably overwrite the send method in the subclasses, save the passed options object, so it can be accessed in the success method.\n/cc @garrick\n. err.. @GCheung55\n. agreed with @DimitarChristoff \n. Last time I checked not..\n. This is something for a new AMD builder for 1.5.\n. See https://github.com/mootools/slick/pull/64\n. This was already fixed in https://github.com/mootools/mootools-core/commit/3fc253eb43\n. This is a mootools-more issue.\n. You're right, also see http://jsfiddle.net/nbQEk/1/embedded/result/\n@ibolmo any ideas what has changed there that could've caused this?\n. This is a Slick issue.\nI've looked into this. The problem is that it checks if document.documentElement exists and is the native contains method.\nIE however does not have document.contains. So MooTools will set it with a Slick.contains wrapper. Now when you call document.contains it will result in an infinite recursion.\nProbably an extra check should be added if document.contains is a native method.\n. Fix: https://github.com/mootools/slick/pull/67\n. This is fixed in Slick now.\n. What if we'd have a proper hasAttribute method?\nAs you probably know these are the results in oldIE:\n``` js\nvar div = makeElement('hello');\ndiv.somerandomproperty = 1;\n// the comments are the actual outcome.\nvar attr = div.getAttributeNode('data-custom');\nexpect(attr.specified).toEqual(true); // true\nexpect(attr.expando).toEqual(undefined); // true\ndiv.randomproperty = 1;\nattr = div.getAttributeNode('somerandomproperty');\nexpect(attr).toEqual(undefined); // DOMNode\nexpect(attr && attr.specified).toEqual(undefined); // true\nexpect(attr && attr.expando).toEqual(undefined); // true\n```\nAfter some research the only solution I found is using outerHTML indeed.\n. ``` js\ndiv = new Element('div', {html: ''}).getFirst();\nexpect(div.get('data-custom')).toEqual('other');\n```\nfails.\n. I assume it are those lines: https://github.com/mootools/mootools-core/blob/master/Source/Core/Core.js#L248-249\nIt looks like this is done to iterate over the prototype properties. For example \nfor (var m in Number.prototype) { console.log(m) }\nOn a non-mootools page, will not log anything, while on a mootools page it will log all the number methods. This is because the methods on the prototype of these types are non-enumerable Number.prototype.toFixed.propertyIsEnumerable() // false. It looks like MooTools resets those properties so they are enumerable. This is used so it can iterate over the methods to implement the generic functions (object.implement(prototype);), and to copy the Array methods into Elements (Elements.implement(Array.prototype);).\nLooking at the chromium ticket, you have these test results:\nWith mootools 8111ms\nWithout mootools 2012ms\nThis looks pretty substantial so we might want to change this so chrome can optimize this code a lot more.\n/cc @cpojer @ibolmo \n. I made a fix in https://github.com/arian/mootools-core/commit/9293d612\n/cc @kamicane \n. @satazor Can you test it with this fix? How do you actually test this, can you provide the tests?\n. Right, that's the correct behavior indeed. However you're saying the documentation could be a bit clearer?\nIf you want you could go to https://github.com/mootools/mootools-core/blob/master/Docs/Element/Element.md and click the 'Fork and edit file' button, and fix it yourself, and send a pull request. Otherwise we'll try to fix this later.\n. In that case you can just use Request. Request.JSON is to retrieve a JSON response.\n. Why is this really necessary. data-* is a DOM attribute. .store() and .retrieve() is an internal javascript object storage mechanism. I think they serve different purposes and don't really have to be mixed up.\nWith .get('data-foo') you know exactly where it comes from and what it does, the same with .retrieve(), simple as that. When you mix this up, it's becoming less clear and more complicated imo.\n. @thomasd is correct.\n. This is actually something that should be fixed in the https://github.com/mootools/slick repository. @subtleGradient  / @fabiomcosta / @ibolmo any good places to put the tests?\n. @calyptus fix was merged, so it's fixed in Slick now. Just need to update Slick for mootools 1.4.4 and we're done :)\n. This seems to work :D\n. would\njs\nvar div = new Element('div');\nconsole.log(instanceOf(div, Element));\nstill work?\n. Element is probably covered by $constructor from Type.\n. so should window and document\u2026\n. ah, ignore that, if they're not true, it will continue with the native instanceof indeed.\n. though maybe if you put the if (!item.hasOwnProperty) return false check after the while loop, it might work.\n. I made this fix https://github.com/arian/mootools-core/compare/fix-2265-style-text\nOne issue still remains, using IE8:\njs\nvar style = new Element('style', {type: 'text/css'});\nconsole.log(style.styleSheet); // undefined\nWhile using\njs\nvar style = document.createElement('style');\nstyle.type = 'text/css';\nconsole.log(style.styleSheet); // object\n. @ibolmo any ideas?\n. or @cpojer \n. this test fails: https://github.com/arian/mootools-core/commit/b3e80ee15b955e0ff4d9977fbedc9adca2afec0b#L1R44\nThe idea is: create an element where CSS is applied by a CSS class. So getStyle('opacity') should return 0.5 if the filter has alpha(opacity=50).\nHowever when you set the opacity to 1, and then set it to null, it should return 0.5 again, but it doesn't.\nAs far as I can see, if element.style.filter was set once, it isn't removed, but is set to filter: ; zoom: 1, so it doesn't fall back to the defined CSS.\n. ah, we should be using element.style.removeAttribute('filter'); when the filter property is empty.\n. Hi Christian,\nWe're aware of this and in the latest unreleased version this is already\nfixed. We'll release 1.4.4 soon. Until then you can use 1.4.2.\nAlternatively you could (temporarily) use the native\nel.getAttribute('data-foo');\nOn Thu, Feb 2, 2012 at 9:50 AM, ChristianEhlscheid <\nreply@reply.github.com\n\nwrote:\nHi there,\nfirst of all, great framework!\nI'm using a Mootools heavily in my projects.\nWhile testing some stuff in IE7 lately I discoverted that\n\"element.get('data-foo')\" returns \"null\", even though the\nelement had this data attribute set.\nThe cause of this behaviour is a recent patch:\nif (!attr | attr.expando) return null;\nIn IE7 all data-attributes have the expando property set to true.\nThis patch breaks alot of code, Mootools More Form.Validator for example\nwhen used with the data-validators attribute.\nAnd there are probably more classes out there that just do\nelement.get('data-XXX').\nI don't know why this change was made, but I think there were proper\nreasons to implement it ...\nSo probably the whole codebase has to be checked against\n\"element.get('data-XXX') calls and patched to\nelement.getAttribute('data-XXX').\nChristian\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2269\n. done\n. Fixes #2280.\n\nTested: IE6, IE8, IE9, Firefox, Chrome.\n. Doesn't work in Opera yet..\n. Fixed opera issues and Fx for margins.\n. Ok, I was able to reproduce this in the tests, and found that #2282 would fix this.\n. @kguelzau try MooTools edge in jsfiddle. I think #2459 has the same problem but it should be fixed in master.\n. Yeah, usually the full screen result under share works ok in IE8/7.\nOn Fri, Feb 22, 2013 at 12:52 PM, kguelzau notifications@github.com wrote:\n\njsfiddle seems to be broken for IE8/7 right now. So I can't test it.\nBut the new code seems to be OK since \"element.getComputedStyle('filter')\"\nis used to check for filters in non inline styles.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2286#issuecomment-13939901.\n. awesome!\n\nOn Fri, Feb 22, 2013 at 5:09 PM, kguelzau notifications@github.com wrote:\n\nhttp://jsfiddle.net/kguelzau/Cdrdh/4/\nworks with mootools edge in IE7/8\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2286#issuecomment-13951116.\n. Or we can solve this as it's done here by @kamicane https://github.com/kamicane/mootools-core/blob/2.0/Source/Core/Core.js#L57-59\n. Tested: Chrome + IE8\n. Fixed in 1f73ef0\n. I don't even know/care what it does.\n. But it should by relevance.\n\nOn Thu, Feb 16, 2012 at 10:36 PM, Olmo Maldonado <\nreply@reply.github.com\n\nwrote:\nI still think that MooTools Core should be the very low level\nimplementation of things. It shouldn't be categorized by usage.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4009943\n. Why do you need to work with Flash?\n\nOn Thu, Feb 16, 2012 at 10:47 PM, Olmo Maldonado <\nreply@reply.github.com\n\nwrote:\nMy definition of relevance is defined by association.\nI'm associating Core code as essential.. must have. If I ever need to work\nwith Flash I would/need to associate I would/should assume it's in Core..\nnot in More.\nOn Thu, Feb 16, 2012 at 3:37 PM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nBut it should by relevance.\nOn Thu, Feb 16, 2012 at 10:36 PM, Olmo Maldonado <\nreply@reply.github.com\n\nwrote:\nI still think that MooTools Core should be the very low level\nimplementation of things. It shouldn't be categorized by usage.\n\nReply to this email directly or view it on GitHub:\n\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4009943\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4009973\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4010185\n. Do we need a Java Applet helper?\n\nOn Thu, Feb 16, 2012 at 10:49 PM, Arian Stolwijk arian@aryweb.nl wrote:\n\nWhy do you need to work with Flash?\nOn Thu, Feb 16, 2012 at 10:47 PM, Olmo Maldonado <\nreply@reply.github.com\n\nwrote:\nMy definition of relevance is defined by association.\nI'm associating Core code as essential.. must have. If I ever need to work\nwith Flash I would/need to associate I would/should assume it's in Core..\nnot in More.\nOn Thu, Feb 16, 2012 at 3:37 PM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nBut it should by relevance.\nOn Thu, Feb 16, 2012 at 10:36 PM, Olmo Maldonado <\nreply@reply.github.com\n\nwrote:\nI still think that MooTools Core should be the very low level\nimplementation of things. It shouldn't be categorized by usage.\n\nReply to this email directly or view it on GitHub:\n\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4009943\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4009973\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4010185\n. HW accelerated animations with the Silverlight I assume?\n\n\nOn Thu, Feb 16, 2012 at 10:54 PM, Darren Waddell <\nreply@reply.github.com\n\nwrote:\n@arian YES! Also a Silverlight helper. Please make this a priority and\ninclude it in Core over other less useful features like event delegation or\nhardware accelerated animations.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4010330\n. done.\n. it's always ltIE9 here. cause IE9 has opacity. You'r doing Math.min(opacity, 1) for readability, instead of >= 0.95?\n. js\nif (opacity == null || opacity == 1) opacity = '';\nelse opacity = 'alpha(opacity=' + Math.max(0, opacity * 100).round() + ')';\n\nthat would work for me. If you would do .setStyle('opacity', 2) it would set it to 200, but that's fine, nothing will happen (as far as I know), and .getStyle('opacity') would return 2, like in other browsers.\nOnly exceptions are 1 to remove the ugly black border, and values < 0 because that would break the regex.\n. Also check out https://github.com/arian/mootools-core/commit/4cdf46d / https://github.com/arian/mootools-core/compare/bug-2310\n@kentaromiura your specs seem to pass with my fix too...\n. Tested this in IE6/IE8.. need to test this in IE7 for those crashes we had...\n. Ok, doesn't work in IE7... changing clone.removeAttribute (https://github.com/arian/mootools-core/blob/4cdf46d/Source/Element/Element.js#L848) to Element.erase fixes the failing test, but creates some new failures\n. It's because the properties of classObject, contrary to the ones of intiObject, are not own properties, but are on the prototype. Object.getLength uses Object.keys which only returns own properties (per spec).\nAlso see #2057.\nMaybe we could explain this better in the docs\u2026\n. This has been fixed in 1.4.5\n. hmm, yes, can you give us a small snipped of code on http://jsfiddle.net or http://tinker.io that causes this.\nProbably the fix would be ('' + from).slice\n. For now you can fix this by removing the 'px' unit option: https://tinker.io/3d395/1. I'm looking into it though.\n. Can't really change this in 1.x, see https://mootools.lighthouseapp.com/projects/2706/tickets/1045-asp-net-bug\n. Fixed with #2401\n. Use MooTools edge in jsfiddle: http://jsfiddle.net/uaCJd/15/\n. https://github.com/mootools/mootools-core/blob/160cdb3/Source/Element/Element.Dimensions.js#L219\nshould probably be\njs\n    return parseInt(styleString(element, style) || 0, 10);\n. @kguelzau care to test it with a build without the flash detection?\nFor example remove those lines: https://github.com/mootools/mootools-core/blob/master/Source/Browser/Browser.js#L87-96\nI don't know if you know how to build it, but it's described here: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master\n. Maybe we can just remove those stupid checks in 1.5?\n. For some reason the <svg> tag isn't a instance of Element anymore... \nFor example try\njs\n$('svg2') instanceof Element\nin firefox or chrome, firefox returns false and chrome returns true.\nThough you'd think the <svg> element in a HTML document would be an Element, which would have Element.prototype so all the MooTools methods.\n. However\njs\ndocument.createElement(\"svg\") instanceof HTMLElement\nreturns true in Firefox 12.\n. but it does look like mootools does something somewhere:\nWith MooTools: http://jsfiddle.net/f36kT/1/\nNo framework: http://jsfiddle.net/f36kT/2/\n. Ok, so the problem is this, MooTools does something like:\njs\nBrowser.Element = window.Element;\nvar Element = function(tag, properties){\n    // do stuff\n};\nElement.prototype = Browser.Element.prototype;\nThat way the prototypes are shared.\nFor some unknown reason however, the new methods in Browser.Element.prototype don't show up in the prototype chain of SVGSVGElement.\nIn plain js:\n``` js\nvar OldElement = window.Element;\nvar svg = document.getElementsByTagName('svg')[0];\nconsole.log(svg);\n// svg is an instance of OldElement\nconsole.assert(svg instanceof OldElement);\n// implement new property in OldElement\nOldElement.prototype.test = 'test';\n// Now because svg is an instance of OldElement, it should have this property\n// but it has not\nconsole.assert(svg.test == 'test', 'svg.test should come from SVGSVGElement.prototype');\n// while a normal element has\nconsole.assert(document.body.test == 'test', 'document.body.test should come from HTMLElement.prototype');\n```\nhere the svg.test == 'test' assertion fails in firefox.\nSo as far as I could see this is a Firefox bug. \n/cc @sebmarkbage, @jdalton, @kamicane.\n. Actually this already fails (in plain js):\njs\nElement.prototype.test = 'test';\nvar svg = document.getElementsByTagName('svg')[0];\nconsole.assert(svg.test == 'test');\n. reported to firefox: https://bugzilla.mozilla.org/show_bug.cgi?id=740811\n. @w8r, you can probably do the same for 1.3, 1.4.\n. The Firefox bug was resolved/fixed some days ago: https://bugzilla.mozilla.org/show_bug.cgi?id=740811\nSo hopefully that fix will land in Firefox soon.\n. This bug should land in Firefox 13 (It should be in Aurora soon according bugzilla). So in 6 weeks most users will update to Firefox 13, in the mean time I propose people can use this fix by @w8r, it doesn't have to be within mootools itself. I don't think we need to release a separate version with this temporary fix.\n. This seems to be fixed in firefox 13.\n. http://mootools.net/demos/?demo=MouseWheel works for me in Firefox 12 for ubuntu.\n. It's just oldIE being oldIE.\nIt can't handle filter: alpha(opacity=xx) with alpha transparent pngs. Perhaps there are other solutions somewhere on the internet, but it's not something we can't fix easily in MooTools.\n. Do you have jsfiddle.\nhttps://github.com/mootools/mootools-core/blob/160cdb362/Source/Fx/Fx.Tween.js#L90 is in Element.implement, so this in the method is the element.\nThe line below that: https://github.com/mootools/mootools-core/blob/160cdb362/Source/Fx/Fx.Tween.js#L92 is in the chain method where the this is the Fx instance, so the element is this.element. \nSo it should work correctly..\n. Seem related to #2274\n. Well, if the first argument is not set, it should use getStyle('top') which returns auto which should become 0px I think..\n. Can you please provide a jsfiddle with an example?\n. Are you using with or without 1.2 compatibility?\nOn Tue, Mar 27, 2012 at 11:42 AM, axiomer <\nreply@reply.github.com\n\nwrote:\nVersion: 1.4.5. with compatibility\nTestcase:\n     function boundFunction(a, b) {\n       console.log(a + \",\" + b);\n     }\n     var callback = boundFunction.bind(this, 1);\n     callback.apply(this, [2]);\nShould print:\n     \"1,2\"\nDoes print:\n     \"1,undefined\"\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2339\n. See #2331.\n. Basically duplicated of #2353 \n. So that is this line: https://github.com/mootools/mootools-core/blob/master/Source/Fx/Fx.CSS.js#L106\nCould we narrow it down when exactly those are null?\n. checkout the code standards: https://github.com/mootools/mootools-core/wiki/Syntax-and-Coding-Style-Conventions\nBasically:\n\n``` js\nif (x){\n}\nvar obj = {a: 1, b: 2};\n```\n. @kentaromiura what's the status on this? Perhaps a few tests?\n. Use http://jsfiddle.net/bq4YY/5/ or http://jsfiddle.net/bq4YY/4/\nWhat changed is that you need to return a truthy value in the chained function, because of https://github.com/mootools/mootools-core/blob/master/Source/Fx/Fx.js#L106\ncallChain will return the value of the next function, or false if the chain is empty (http://mootools.net/docs/core/Class/Class.Extras#Chain:callChain), so that's why it does that check this way.\n. True, but in DOMEvent relatedTarget should probably still be set\nhttps://github.com/mootools/mootools-core/blob/master/Source/Types/DOMEvent.js#L59\n. @zenlunatics what about mouseenter?\n. That line: https://github.com/mootools/mootools-core/blob/3e9875e6d/Source/Types/DOMEvent.js#L67\n. That's the fix: http://jsfiddle.net/b67n43em/1/\n. js\nfunction fix(e) {\n    var event = e.event;\n    if (event.type == 'mouseenter') {\n        e.relatedTarget = event.fromElement;\n    }\n    if (event.type == 'mouseleave') {\n        e.relatedTarget = event.toElement;\n    }\n}\n. @cpojer opinion did you ever need this? I think I would add it to the DOMEvent object instead of an argument... however sometimes that one isn't passed.. but in that case you can't pass the type either as second argument... \n. Why not:\njs\nvar t = 'textchange';\n\u200b$('text').addEvent(t, function(e){\n// e.type = keyup\n// t = textchange\n})\u200b\n. Also here is another problem described, when you change input.checked in the change event: http://allbtechebooks.blogspot.com/2012/04/mootools-event-causes-infinite-loop-in.html\n/cc @csuwldcat \n. Ah, I found it via twitter..\n. @csuwldcat this is your thing i guess..\n. @oelmekki true, subclassing Request isn't very nice, however that's more difficult than it looks... without a complete rewrite.. pull request are always welcome though ;)\n@chrispitt @DimitarChristoff any news on this.. I think setting properties of the method, url and data isn't a bad idea.\n. #2344 has the same problem, but for the url instead of method.\n. Probably this is because IE, Firefox and Opera have a native mouseenter event, but Webkit doesn't.\nSee https://github.com/mootools/mootools-core/blob/6e16f69db9/Source/Element/Element.Event.js#L149-168\nI'm not sure we should/can fix this.\n. what do others do? \nfor example nodejs simply does this: querystring.stringify({a: 1, b: {c: 2}}); => 'a=1&b=', so it's probably a bit server specific.. are there any other good examples?\nAlso isn't e4e637a66 / https://mootools.lighthouseapp.com/projects/2706/tickets/762 related?\n. Fixed by pull request #2371. If fixes #2359 is will be closed automatically by github.\n. Not handled properly how?\nOnly if the class has an addEvent method, it will do something with onXyz options: https://github.com/mootools/mootools-core/blob/master/Source/Class/Class.Extras.js#L111\n. Yes, that's because of the delete options[option], it will not change though.\n. changed this to wontfix.\n. I think this is fixed in 1fcdafd79\n. I remember something like that indeed. The fiddle shows NaNpx though.. Can't we just remove the Browser.opera check for width.. maybe they fixed stuff that used to be broken at that time...\n. Fixed with #2401\n. @DimitarChristoff is correct: https://github.com/mootools/mootools-core/blob/dcfebc502/Source/Element/Element.js#L268\n. Probably you can use Element.get(objElement, 'tag') or something similar.\n. @shaundunne what's the OSX Lion UA string? (navigator.userAgent in your JS console)\n. Perhaps it's because Firefox has native mouseenter and mouseleave since 1.4.2. Delegation is in core since 1.4.0.\n. @DimitarChristoff probably that's it indeed..\n. See #2470 \n. This is on purpose. .set here calls setOptions which just uses addEvent only for events.\n. Same as #2368, and @DimitarChristoff is correct.\n. In Google Chrome, on Ubuntu, I get the correct results (4 and 1)...\n. Closing this.. let me know if you still have problems with this.\n. Instead of doing String(value) in the loop, you could do it once before the loop.\n. It looks like it's this line you're referring to:\nhttps://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Event.js#L92\nI'm wondering why there are invalid objects in there in the first place..\n. Any idea how we can reproduce this?\n. Maybe you could setup an isolated jsfiddle or test?\n. I see, however in our isolated tests, for example https://github.com/mootools/mootools-core/blob/master/Specs/1.4client/Element/Element.Event.change.html I don't get any troubles in IE8.\nCould you recreate such an isolated tests (with just some codes that reproduce the problem), and are you sure there is no code or plugin messing with the events storage (element.store('events'))?\n. Especially because on your page, there is a lot going on which is difficult to debug, unfortunately.\n. In case you're passing elements, and especially forms, you should use an array: .pass([element]). If it's not an array, it tries to make it an array, and with some elements the browser can return unexpected elements. For example with select elements it can return all opion elements, instead of [select]. This is also the case with form elements.\nThis solves it: http://jsfiddle.net/VrfNy/4/\nIf you want the form element in function, you can also just use this, or because obj is defined in a higher scope, you can just use that as well:\nhttp://jsfiddle.net/VrfNy/5/\n. Makes sense I guess. @cpojer?\n. Added pull request.\n. Wich memory leak? Also oldIE empties all those objects when the user leaves the page.\nstorage and collected are not global variables either (they're in the surrounding function). I don't know exactly why MooTools does it this way, because it works like this for at least 4 years, but I guess it gets around many browser bugs and is probably faster.\nSo maybe before changing stuff, lets first understand the problem better. Maybe you could create a simple html page which reproduces the memory leak and describe the steps how you observed the leaks.\n. Maybe an idea is to look more into event delegation, so you don't have many elements with attached events. \n. but why don't use destroy instead of dispose to remove elements?\n. Don't use strict mode with MooTools.\n. It was like this before, but it was also reverted: https://github.com/GCheung55/mootools-core/commit/8521f484f\nI think that Cajon (https://github.com/requirejs/cajon) shouldn't just throw out \"use strict\"s outside some function scope, which it does if I understand you correctly.\n. What about\njs\nvar Thing = new Class({ Extends: Events });\nClasses created by Class are not really made for extending with the classic JS way.\n. It's why the reset function exists in Class.js btw.\n. It isn't very clever yet that it actually matches the @media rules, however search isn't very clever or bullet proof either, so I think that'll be ok for now. If you fix that one little code style thing i'll merge this.\n. @tristanlins thanks! Do you know anything about #2345? It seems in that case rule.rules || rule.cssRules results in null...\n. Is it only for input elements.. otherwise you should also check for child elements..\n``` js\nvar elements = [this].append(Array.from(this.getElementsByName('*'));\nvar ids = elements.map(function(element){\n    var id = element.getAttribute('id');\n    element.removeAttribute('id');\n    return id;\n});\n// later\nfor (var i = 0; i < elements.length; i++) elements[i].setAttribute('id', ids[i]);\n``\n. Yes. This is why testing is very important here.\n. maybe this will help: https://github.com/xdissent/ievms/\n. references: #2083, #2163, https://github.com/mootools/mootools-core-specs/pull/22\n. what about usingelement.erase/get/set('id')added in #2083\n. Maybe the feature test in #2083 is enough too.\n. Yeah, I'd like to have this feature. And we do accept pull requests, so I don't know what's going wrong...\n. I was more thinking about something like https://github.com/arian/mootools-core/compare/fix-2389-multiple-classes\n. I don't liketoggleClass.. man, multiple toggleClass :fearful:.. but you're probably right..\n. Awesome @gonchuki, so basically.getStyle('border-left')returns the properties in a different order than other browsers, which returns inNaN`s eventually... so that'd be good to fix.\n. This is not a bug.\nSee this jsfiddle: http://jsfiddle.net/24HJD/1/\nWhat .getChildren() does is return an collection, an instance of Elements. Elements has also all Element methods, including getFirst(). However Array also has a getLast method, no getFirst() method because that's always array[0]. What happens is that Elements has Element.getFirst() but Array.getLast().\nSo the line with getFirst() it gets the first element of each element in the collection. getLast returns the last item of the collection. A collection doesn't have a id property of course, while the last element does have one.\nHope this clears it up a bit. It is a bit inconsistent in this specific case, but on the whole it is better that array methods take precedence over Element methods. \n. :+1:\n. I think it should return what's passed in xhr.open.\n. but looking at the code that happens.. (except with GET data stuff)\n. Chrome on iOS is basically safari in a webview... \n. For statistics you should save the raw data. \nUsually Browser.stuff is used to show certain features or not. Like hide an input[type=\"file\"] on iOS because it won't do anything, but will in Android.\nI think changing the UA string to CriOS is done on purpose so it doesn't match chrome, because it's not actual Chrome, but safari, so maybe that should return safari.\nFor the stock android browser safari makes sense as well, because it's webkit and Browser.platform.Android is true for Android. Browser.Platform.ios for iOS.\nAnyway, I don't think we should change too much, using Browser isn't usually a good idea anyway.\n. 1.4client would be fine. Now we have this fix, we can pull it in 1.4.6. (both #2325 and #2364 have the 1.4.6 milestone.. :))\n. Basically copy those two jsfiddles in the specs.. update it a bit.. check if it fails without the fix.. and verify it passes with the fix.\n. Looks awesome\n\nmerging...\n. pulled\nOn Fri, Aug 10, 2012 at 4:43 PM, gonchuki notifications@github.com wrote:\n\nIf you don't mind to merge again/cherry-pick (or manually edit), I\nacidentally left a trailing comma on the spec\nhttps://github.com/gonchuki/mootools-core/commit/7f59171b1a578fd6fb05ef7f1e93835057cfe79a\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2401#issuecomment-7646494.\n. Only MooTools 1.2 breaks. MooTools >= 1.3 overwrites .contains because it's not in this list: https://github.com/mootools/mootools-core/blob/c7a161d85/Source/Core/Core.js#L266-268\n\nThat said, we probably should prepare for those new methods and make our API compatible in 1.4.6 and 1.5.\n@gutworth what's the current status? As far as I know it's only a proposal, but now it's implemented it probably won't change a lot, will it?\nAlso, what other new methods can we expect, I saw the string extras, Array.from/Array.of, and some number methods right?\n. That's great to hear. I do think we should change String.prototype.contains to match the signature with ES6 though in 1.5.\n. Needs a fix for MooTools 1.2.6, as it probably breaks some selectors ($$) too: https://groups.google.com/forum/#!topic/mootools-users/W7MHwTFHYQ4\n. Okay, this problem is solved for 1.2 now too, and released, so we can close this! http://mootools.net/blog/2013/02/19/mootools-1-2-6-released/\n. I think you can rebase / squash this stuff too. iirc GitHub has become smarter with this stuff.\n. yep, much better. I'll pull this if everybody agrees :+1:\n. Great work!\nA way to clean it up would be to create an object with style getters, that's probably already a bit cleaner than all the inlined checks in the method.\n. yeah, looks good, maybe just those stylistic changes:\n``` diff\ndiff --git a/Source/Element/Element.Style.js b/Source/Element/Element.Style.js\nindex 7ae578d..adfdc30 100644\n--- a/Source/Element/Element.Style.js\n+++ b/Source/Element/Element.Style.js\n@@ -123,7 +123,9 @@ Element.implement({\n            result = this.getComputedStyle(property);\n        }\n        if (hasBackgroundPositionXY && /^backgroundPosition[XY]?$/.test(property)){\n-           return result.replace(/(top|right|bottom|left)/g, function(position){ return namedPositions[position]; }) || '0px';\n+           return result.replace(/(top|right|bottom|left)/g, function(position){\n+               return namedPositions[position];\n+           }) || '0px';\n        }\n        if (!result && property == 'backgroundPosition') return '0px 0px';\n        if (result){\n@@ -231,4 +233,5 @@ Element.ShortStyles = {margin: {}, padding: {}, border: {}, borderWidth: {}, bor\n });\nif (hasBackgroundPositionXY) Element.ShortStyles.backgroundPosition = {backgroundPositionX: '@', backgroundPositionY: '@'};\n+\n })();\n```\nI can commit this and merge it.. or maybe if you fix it, maybe rebase it, we can just press the nice green merge button ;)\n. The problem is that transparent pngs are ugly with the filter. That's why it's removed when it's 1.\n. Yes :+1:, let me know when I can merge.\nOn Wed, Aug 22, 2012 at 3:07 PM, gonchuki notifications@github.com wrote:\n\nlet me know if this gets green light so I can rebase to get it ready for a\nmerge.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2411#issuecomment-7933337.\n. great work again! Maybe next time rebase on mootools/master, that's even cleaner :)\n. Also, gzip. It's not that big of a deal iiuc.\n. Also why not just keep https://github.com/mootools/mootools-core/blob/cb327bf3/Source/Element/Element.Style.js#L216-232 which is a bit shorter.\n. Nice work, good start! :+1:\n. Use [\"Chris\", \"Kate\", \"Steve\"].each(function(item, key){ ... }) or for (var i = 0; i < array.length; i++){ ... } loops. Not for-in loops for arrays.\n. Duplicate of #2265\n. It has already been changed: https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Style.js#L169\n\nI'll merge the test.\n. Scratch that... \n. It's already there: https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Event.js#L141\nSo that should be fixed in 1.4.6!\n. Hi @magicalhobo, sounds useful, can you create a new issue for that so it's easier to track?\n. Looks good.\n. So basically it's missing\njs\nElement.Styles.backgroundSize = '@px';\n. I think this would be good, so it still removes the unload which is used for gc:\n``` diff\ndiff --git a/Source/Element/Element.js b/Source/Element/Element.js\nindex db38211..0197a1c 100644\n--- a/Source/Element/Element.js\n+++ b/Source/Element/Element.js\n@@ -898,13 +898,7 @@ Element.implement({\n [Element, Window, Document].invoke('implement', {\naddListener: function(type, fn){\n\n\nif (type == 'unload'){\nvar old = fn, self = this;\nfn = function(){\nself.removeListener('unload', fn);\nold();\n};\n} else if (window.attachEvent && !window.addEventListener){\nif (window.attachEvent && !window.addEventListener){\n            collected[Slick.uidOf(this)] = this;\n        }\n        if (this.addEventListener) this.addEventListener(type, fn, !!arguments[2]);\n@@ -939,10 +933,14 @@ Element.implement({\n });\n\n//\n-if (window.attachEvent && !window.addEventListener) window.addListener('unload', function(){\n-   Object.each(collected, clean);\n-   if (window.CollectGarbage) CollectGarbage();\n-});\n+if (window.attachEvent && !window.addEventListener){\n+   var gc = function(){\n+       Object.each(collected, clean);\n+       if (window.CollectGarbage) CollectGarbage();\n+       window.removeListener('unload', gc);\n+   }\n+   window.addListener('unload', gc);\n+}\n //\nElement.Properties = {};\n```\nThis way unload will be collected too, which is good probably.\n. Closing in favor of d54312c577\n. .set('send', ...) uses .setOptions, which only adds new event listeners through .addEvent, so it doesn't replace them. So you should just set the options once, so it only adds the events once. Then use .send() multiple times.\n. This wouldn't be an easy fix, because IE (< IE9) can't handle script with innerHTML, so without https://github.com/mootools/mootools-core/blob/d54312c5/Source/Request/Request.HTML.js#L34-36 it wouldn't execute any JS at all. In other browsers I've tested (IE9, Chrome) it doesn't execute the JS either, but at least it creates the script element. According to this it can create the script tag if there are some other DOM nodes before the script tag, but haven't tried that myself.\nI see you made a commit but this probably doesn't work cross browser, which is why we can't simply pull that.\nAnyway, this would require some cross browser testing.\nBesides that, we can't break backward compatibility. So unless we can do this in a very elegant and simple way we could add it as option, but otherwise I don't think it's really worth it. \nCorrect me if I'm wrong, but it looks like you're sending a while DOM tree, and only pick some specific parts out of it? Can't you do this more efficient, with only requesting the correct parts, preferable as a JSON data structure...\nGenerally I think loading the JS through XHR is a bit ugly too, I would try to avoid it.\n. Looking at https://twitter.com/cpojer/status/249088689207144448 @cpojer approves?\n. Do you have an example on jsfiddle? \n. iirc, there were some issues indeed about one year ago which were fixed in Highcharts.\nBut if this has been fixed and it's working now for you too, we can close this I issue I think.\n. Try to move the the onComplete 'option' outside the submit event. Each time you submit, it gets added again.\nSee http://jsfiddle.net/tMPDk/\n. As far as I know, the purpose of Request.JSON is to decode your JSON response, which means:\n- sucess if it has a successful/parsable JSON response\n- failure in all other cases.\nSimple as that.\nSince no response isn't parsable, it failes, which seems correct to me. For me Request.{JSON,HTML} are just some little convenient subclasses to parse your data. If you have special requirements, build your own with Request.\nThat the isSuccess method isn't aligned with the fired events might be a small inconsistency issue though.\nLinking to agent isn't really relevant to the current MooTools Request, because it takes a whole other approach.\n. :+1: would be good to bring more XHR 2 features in.\n. I added some comments, sorry for the nitpicking, but if you fix that we can pull it :smile: \n. You're right, it should simply round the value... Can you send a pull request?\n. Yes, you could try to run the tests: https://github.com/mootools/mootools-core/tree/master/Specs#running-the-tests-in-a-browser. I'm not really sure if there are (good) tests for this specific method.\n. As far as I can see it works in Opera 12. Opera 11.11 is old...\n. Why would you for-in a number? In most cases something else is going wrong.\n. Yes, but this doesn't really matter. .fireEvent still only fires the correct ones. This is done so removing events during a fireEvent still works correctly.\n. this is a mootools-more issue.\n. can you post an example on http://jsfiddle.net?\n. Also, which browser, which MooTools version...\n. I think we could add something like:\n```\nvar input = document.createElement('input');\nvar support = false;\ntry {\n    input.type = 'x';\n    support = input.type == 'x';\n} catch (e){}\nif (!support) propertySetter.type = function(value){\n    try {\n        this.type = value;\n    } catch (e){\n        this.type = 'text';\n    }\n}\n```\n. You can use the Request object:\njs\nvar request = form.get('send');\nrequest.send({url: \"new\"});\nor I think this works too:\njs\nform.set('send', {url: \"new\"});\nform.send()\n. it is actually typeOf: http://jsfiddle.net/FEcXE/1/\n. it doesn't entirely: http://jsfiddle.net/FEcXE/8/\nOn Fri, Nov 23, 2012 at 9:54 AM, Cristian Carlesso <notifications@github.com\n\nwrote:\nthis will solve the problem:\nhttp://jsfiddle.net/kentaromiura/FEcXE/7/\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2447#issuecomment-10653285.\n. It outputs object, object, object in chrome...\n\nOn Fri, Nov 23, 2012 at 10:12 AM, Cristian Carlesso \nnotifications@github.com wrote:\n\nin IE it outputs\nobject, object, arguments.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2447#issuecomment-10653665.\n. So this: https://gist.github.com/4163041/2c2cd1e59e107b01fdb89bb26b439e6f10e79053\nor just remove the if (item.callee) return 'arguments'; line!\n. The event models are different between <= IE8 and other browsers. Usually events can come in any order. If you want to sort the actions after some events, you should write something yourself. However often there is a better way.\n. It'd be nice if we would have a little test for this. Maybe you could update your pull request with an extra test in https://github.com/mootools/mootools-core/blob/master/Specs/1.4client/Element/Element.Delegation.html\n. pulled.\n. Submit is a native method. Generally you shouldn't use input names that are also methods on Element. For example the native <input name=\"submit\" type=\"submit\"> will break form.submit() (even without MooTools).\n. Basically the idea behind emulation is that it adds _method and just uses post, so it works cross-browser/platform. If you don't want that, and want to use your own _method value, just set emulation to false.\n\nOr do you expect that Request filters duplicates? I'm not sure if that's really worth the effort (if you pass a string as data, we'd have to parse it correctly, and check for duplicates...).\n. Well, then set emulation to false. Also Django accepts foo=bar&foo=yo, so it's probably valid, or at least not uncommon. For reasons mentioned in my first comments, we've decided to don't fix it.\n. Why would property not be a string?\n. I think this is actually fixed in master.\nOn Tue, Jan 8, 2013 at 5:58 PM, Valerio Proietti\nnotifications@github.comwrote:\n\nTry to style opacity before fading using MooTools, rather than css. I\nbelieve MooTools sets a flag somewhere, because of how opacity is\nimplemented in IE.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2459#issuecomment-12005895.\n. Both new Color('#ccc') and #ccc'.hexToRgb() work fine for me. Which MooTools version are you using?\n. Should work: http://jsfiddle.net/vzF7q/\n\nGoogle has the same MooTools Core version. Color however is in MooTools More. If you use More 1.4 it should just work.\n. Tested the specs in IE6, IE8, IE9, Firefox 18, Chrome 24 and Opera 12.\n. I added the try-catch because it's the same in Function.js. I guess when browsers define it with the {writable: false} definition or something\u2026, @cpojer ?\n. In the next version the flash detection will be removed by default (it's only in the 1.4 compat).\n. Hey, thanks for your research and fix. I opened a new pull request with a slightly other fix #2470\n. This is expected, because .pass uses Array.from now, which converts all array-like objects into arrays. Previously 1.2 only did a simple 'is-array' check. So yeah, you should use the extra [] here in this case.\n. Fixes #2443 \n. Not that I know of.\n. This is only when you have 1.2 compatibility enabled (not default in 1.4.5).\n. @dvdplm, the outputs are the same for me... which is correct because you use the nocompat version.\n. Cool, didn't know about this one yet. Do you have a link to the w3c spec?\n. Looks good. Is there a simple way to verify this actually solves the problem?\n. It is not that it's legacy code, but I cannot remove it because would break backward compatibility and many applications.\nBut can't you just use Browser.Platform.ios?\n. I don't think we want to fix this in MooTools. Especially because it's not really a common issue, not clearly specified in any specification and with different implementations (for example Chrome doesn't prevent ctrl+w while it does prevent other combinations). \nI don't particularly like preferring attachEvent to the standard addEventListener. \nPerhaps it's a cleaner solution to have a separate module/function that you can can call once to fix this. e.g.:\n``` js\npreventDefaultKeys(element);\nfunction preventDefaultKeys(element){\n    if (element.attachEvent) element.attachEvent('keydown', function(e){\n        (e || window.event).keyCode = 0;\n    });\n}\n```\n. Can you re-create this issue on https://github.com/mootools/mootools-more/issues ?\n. you're right though ;)\n. @cpojer I think you're the expert here...\n. No.\nWant to contribute, read http://mootools.net/blog/2013/03/18/contributing-to-mootools/\nCurrently we're working on prime, elements + co, see the mootools organization here on GitHub.\nWe still want to release new releases for mootools-core / more though, but could use some extra time. \nA lot of developers are busy with work, life and other things and can't really work on mootools every day / week.\n. For mootools-core and more a great way to contribute is test pull requests, comment on things, provide fixes for issues, or comment that issues are not reproducible or incorrect.\n. Also note that moobile isn't developed by MooTools Core developers.\n. It is in the docs, isn't it: https://github.com/mootools/mootools-core/commit/27c958b142060af8d2e8b83be06ce3f7b8eab512\n(Although it might not be live yet.)\n. Ah, good catch.\n. Thanks for the comments @gonchuki @swhiteman. Looks like we can close this.\n. Why would you put objects that contain functions into Object.toQueryString?\n. I added your commit and rebased this pull request.\n. Yes, they're in the 'Specs' folder.\nThat folder also contains a README that should explain how to run them.\n. @milesj is correct.\n``` js\nvar c = new AClass($('aLink'));\n$('bLink').addEvent('click', c.bFunction.bind(c));\n// or\n$('bLink').addEvent('click', function(){\n    c.bFunction()\n});\n``\n. You forgot the parentheses atthis.cow.feed. \n. How is this related to MooTools?\n. Not sure if I understand it entirely, but maybe the first time the domready event is added, it should execute thecheckfunction so it's sure everything is ready. Then theloadedvariable is set to true so the event is fired immediately for the added and future listeners.\n. What would also help is a jsfiddle or something so we can reproduce it.\n. Which MooTools version and which user agent strings (lognavigator.userAgent)?\n. The UA strings you provided give me the correct versions of IE 8 and 7. I believe we should only check on the UA string, and not make it more complicated than necessary with thedocument.documentMode`. If necessary you can check that for yourself.\nI think I don't have to say anymore you shouldn't rely on user agent strings etc. for fixing specific things in your site. You should use Feature Detection for that.\n. Hmm, you're right. See 601c6dd6 and https://mootools.lighthouseapp.com/projects/2706/tickets/1029\n. I don't think it's really justified to add extra exceptions by some new feature (Browser.computedVersion) though. I see the current behavior is documented.\n. Indeed, browsers lie about there age version, so don't trust that. Better to do some specific detection for the thing you want to use (which you're doing now it seems).\n. Hi @sarvaje \nThanks a lot for the pull request, but #2481 was closed, so I'll also close this one.\nJust a tip for the next time: try to make sure you use the correct code style (tabs etc.), that way we can directly merge your pull requests the next time without extra work :smile: \n. But I don't think there is any way to keep it backward compatible.\n. Related to #2408\n. If Flash isn't there, then navigator.plugins['Shockwave Flash'] is null, so navigator.plugins['Shockwave Flash'].description throws an error. This doesn't matter, however, because it is caught in the Function.attempt.\n. What if we always use gBCR instead of offsetWidth/offsetHeight?\n. .getBoundingClientRect seems consistent: http://jsfiddle.net/msg3y/2 in chrome/firefox...\n. No, you're right :)\n. Thanks for the insights @gonchuki!\n. Firefox is working on it: https://bugzilla.mozilla.org/show_bug.cgi?id=687787\n. It's in MooTools More.\n. Thanks, what @TheShrike and @swhiteman said.\n. This says the same: http://www.w3.org/TR/html5/forms.html#dom-input-value-default-on\nWhat about radio boxes? If you search this document for default/on you'll find a table which types should have value default to on. So checkboxes and radio buttons.\nThis property was optional until html5, in html4 it was optional for all input types except checkbox or radio, which is probably why IE is different: http://www.w3.org/TR/html401/interact/forms.html#adef-value-INPUT\n. It should match the rv part...\nMaybe something with:\njs\nua.match(/(opera|ie|trident|firefox|chrome|version)[\\s\\/:]([\\w\\d\\.]+)?.*?((safari|rv[\\s?]|version[\\s\\/:])([\\w\\d\\.]+)|$)/)\n. Looking good :+1: \n. A little. Browser doesn't have a public API which accepts any UA string. Would be good for testing. I don't really feel much for rewriting it so it's better testable, but it would be a good thing IMO: \n``` js\nBrowser.parse('....')\n\n{name: 'IE', version: '11'}\n```\n. We already deprecated flash version detection, we could just deprecate it Browser.name / Browser.version etc. I don't have problems with that. AFAIK we don't really use it ourselves anymore.\n. I think the behavior should at least be consistent across browsers, so if the old case works fine with an empty string/whitespace, so should the new method.\n\nMaybe\njs\nclassName = className.trim();\nif (className) this.classList.add(className);\nbecause addClass(' asdfd ') would still throw an error with this fix.\n. I think the big difference is because, I guess, with classList browsers can wait with redrawing once it's necessary. If you call that function 3000 times, but at the end it's only changed once, it's only actually changed once, instead of 3000 times in the old case. So the test isn't very realistic, unless your script is crappy and actually changes the class that many times...\n. I think we agree that there is a bug in 1.4.5 when using multiple classes. There are two options:\n1. either addClass/removeClass should accept multiple classes (independent of order) etc. This is what this pull request does. Drawback is the inconsistent API (addClass vs. addClasses).\n2. it should strictly accept one className (check with simple regex).\n. I :+1: \n. This is because $$ returns a collection of elements. getFirst map over that collection and will execute getFirst for each item of the collection. This means it will return [$$('.lastItem')[0].getFirst()] in this case. The li doesn't have any children, so the result is [null]. Then you try to call get on this array, and that method doesn't exist, because it isn't a Elements collection anymore.\nThe reason why getLast works, is because on an elements collection, methods of Array get the precedence over methods coming from Element. So in this case getLast will return the last item or the collection, which is the single div.lastItem element. And that object does have the .get method, so alerts the text.\n. I'm pretty sure this isn't the right way. Also IIRC there is a UserAgent fix that fixes this for IE11.\n. See #2539 \nBut why is there code (of mootools/mootools-more#1218 / mootools/mootools-more#1220 depending on this anyway. Also I'm wondering if this isn't automatically fixed with the changes in Element.Style.js in master, which doesn't depend on Browser anymore.\n. Related #2409 \n. And this should fix #2456 \n. Thanks!\n. Since it's all specs related, I think the code is ok.\nFor the IE11 fix I would suggest timwienk@9ef90cdb.\nIn the README it sometimes refers to ibolmo in links, this should change to mootools.\n. Like I said somewhere before:\nUse npm test, add that to the package.json\n\"scripts\": {\n    \"test\": \"grunt travis:default\"\n  }\nAnd remove those script and before_script lines.\nSee https://www.npmjs.org/doc/misc/npm-scripts.html#path\n. I don't really get why though. If you look at the travis log, it pulls from github.com/mootools/mootools-core, and uses all that, so it's not really testing from another fork...\n. I don't think we should remove all of Browser. Browser detection can be useful, statistics, helping users. Of course it should not be used for sniffing.\n:-1: \n. Very nice.\n. Because the events are not stored at $events, and is internal anyway.\n. Why do you want to see the list of event handlers? Usually this means you're doing it wrong. For example some other code can also add/remove events to that element that doesn't concern your part of the code.\n. the $events are actually the events of the mForm object. So that are events attached to the class instance, not the element.\n. Actually, I think default should be nocompat...\n. I concur with @DimitarChristoff and @ibolmo \n. What @timwienk said. setStyle('opacity', x) doesn't set the visibility anymore, which is a good thing. This have some problems in this fade method, which is why .fade should set the visibility. This makes sense because otherwise links are still clickable and such.\nSo instead of refactoring the entire method, it should do exactly the same as it does now, but slightly different so it sets the visibility at the right moment (which was the original issue).\n. Probably related: c5fa832c1 \n/cc @kentaromiura \n. And probably the wheel property of the DOMEvent object: https://github.com/mootools/mootools-core/blob/master/Source/Types/DOMEvent.js#L55-L57\n. @SergioCrisostomo, can you also put the new spec in a commit, then it's easier to see the diffs. Of course I trust they'll pass in the relevant browsers, unless you explicitly say so... :+1: \n. I think the spec should be in this pr.\nThe test doesn't test the properties though. Can you test if the DOMEvent wheel property is set correctly?\n. Thanks @SergioCrisostomo for the spreadsheet overview.\nI think this fix looks really good now. :+1: \nFor testing we could have one that just checks that its non-zero, positive or negative and not undefined.\n. Just add this in one pull request, it fixes the same thing: making the addEvent('mousewheel') work:\n1. Add Element.NativeEvents.wheel = 2\n2. Fix event.wheel property because of step 1 it is using the native wheel event.\n3. Add test\n. See 601c6dd6 and https://github.com/mootools/mootools-core/issues/2501#issuecomment-18307221\n. Actually, it's (implicitly) documented here: http://mootools.net/docs/core/Core/Core#Type:implement\n. Yes.\n. LGTM.\n. This should not matter. AFAIK clearTimeout works fine when the timer is undefined.\n. What are you using that gives ReferenceErrors?\n. Also setTimeout / setInterval returns an ID, which is just an integer, so it doesn't really matter if that property still holds that value.\n. It doesn't emit errors in any browser afaik, which is why I'm curious where you get those errors?\n. Good catch indeed.\nIdeally changes should be made in https://github.com/mootools/slick, because then the tests can be executed. However iirc there have been slick fixes in this repo, so we need to check that.\n. This is done to prevent problems while removing events while firing events:\nx.addEvent('bar', function(){ x.removeEvent('bar') });\nx.fireEvent('bar');\nundefined isn't that big, so I can't really imagine this would give actual problems.\n. I'm pretty sure this does not fit in MooTools Core.\n. Your pull request looks really good!\nAlso there is no doubt this function can be useful. The question is whether this should be in -core, or somewhere else.\nLet's hear what others have to say...\n. String#splice should obviously work the same as Array#splice. Too bad Array.prototype.splice.call('abc', 1, 0) doesn't work on strings in JS.\n. One difference, looking at Array#splice, is that it returns an array of the removed items.\nI think for here this should be very unintuitive, and not really possible.\n. @ibolmo what if you just want to remove a part of the string, and don't want to insert something new, then rather than passing an empty string/value (null/undefined), the replacement string should be the last argument, like it is in Array.splice... Then it's really optional.\n. Isn't there a way Request, Fx etc. can work with the Promises interface, without actually re-implementing promises in MooTools?\n. We could automatically detect if the native Promise (ES6) is available, or use some dependency injection where any compatible promise constructor can be passed into.\n. The user could add a shim of own choosing, and pass the constructor in the\nconcerning object.\nFor example:\nnew Request({\n  url: 'foo.html'\n})\n  .withPromise(Promise())\n  .then(function(){ ... });\nOr something similar (I'm not very familiar with the exact promise API).\nOn Fri, Oct 31, 2014 at 10:17 PM, Olmo Maldonado notifications@github.com\nwrote:\n\nOnly issue is adopting the ES6 promise would leave a gap for non ES6\nbrowsers. Thus we'd need to create the shim anyway.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2643#issuecomment-61333031\n.\n. Another approach would be something like this: \n\nhttp://jsfiddle.net/y4nf0783/\nThe pro is that it's really simple and short.\nThe cons are\n- The constructor should work like new Promise(function(fulfill, reject) { ... }) (The ES6 promise in Chrome seems to work like that)\n- API is a bit more cluttered.\nIt's basically what when.js node.lift is doing for callbacks, or something like Q.nfcall.\n. Elaborate...\nCould you explain why this change is what we want?\nI've never used the script, so don't really know what it's about. :)\n. I guess @SergioCrisostomo's idea was to run this script do everything to tag a release... Including building files in dist for bower and whatnot...\n. Don't know why Travis is failing, but this seems good to me!\n. The Travis failure seems to be https://github.com/karma-runner/karma/pull/1182\n. @mattcoz, how did this break your site specifically? As far as I can see, Array.prototype.contains is the same for MooTools and Firefox, except in the case of NaN...\n. ES7 changed it to Array#includes, so we can keep it as is: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes\n. https://github.com/tc39/Array.prototype.includes\n. I would accept a pull request.\nIt's basically just adding \njs\nif (this.options.HttpOnly) value += '; HttpOnly';\nOnly question is whether it should be HttpOnly or httpOnly...\n. Travis is actually testing the old Opera 12. Maybe with a:\njs\nif (Browser.name != 'opera') it('should set HttpCookie flag correctly', function(){ ... })\nand a comment to this issue it can be enough.\n. Nice, absolutely!\n. I think we should do this.\n. It's really depends what this method is meant for. Afaik this is mostly meant for regular simple programming problems, and not for internalization. If you start doing that, then there are at least 101 other cases we would need to cover, and the question is where we should draw the line.\n. No, they are newer HTML5 events that are not in MooTools.\nIf you want to use them with addEvent, you can add them with:\nElement.NativeEvents.pageshow = 2;\nElement.NativeEvents.pagehide = 2;\n. @odysseuscm, what's the user agent string? \n. dispose should not remove the ID attribute.\nhttp://jsfiddle.net/4cm2h8rb/ shows that this indeed does not happen.\nIn which situation is the attribute removed for you?\n. didn't intend to do this :fearful: \n. I think that'd be better indeed.\nWe have to move Object.keys to Core.js from Types/Object.js. After that we could rewrite all for in occurrences to use Object.keys.\n. Is there a way to test this?\n. :laughing: \n. What, how did this pass my npm test?\n. Ah, yes of course! Well, CI ftw!\n. Seems :+1: \n. now https://travis-ci.org/mootools/mootools-more is passing again too :ok_hand: \n. Thanks!\n. You can run karma with grunt. Using grunt karma:dev, you can open the test runner in any browser by opening the karma link.\n. MooTools added Function.prototype.bind in like 2006, before it existed in ES5. Unfortunately that version is incompatible with ES5 .bind.\nHowever we fixed that in version 1.3 a few years ago. The old behavior is only there to provide compatibility with old MooTools scripts.\nIn the default download on mootools.net, this compat layer is disabled by default.\nSo if you use the right (default) build, it will work fine, as it should.\n. See #2716 \n. @SergioCrisostomo you can't even normalize these events, because older browsers don't have video/audio support at all. Besides not all events that are currently in NativeEvents are supported by all browsers (input/paste), but it's still useful that MooTools directly redirects it to the native/browser events.\n. Very nice!\nA few things:\n- Some tests are disabled with using xdescribe, for example https://github.com/timwienk/mootools-core/compare/spec-update-part-3...spec-update-part-4#diff-d7242700ac47efe4e538390355c32968R50\nIs that still valid, or was it disabled at some point and never enabled again?\n- chai uses expect(..).to.be.true, where true is a keyword. iirc that doesn't work in IE8, and should be to.be['true']. Is that relevant? (https://github.com/chaijs/chai/issues/124#issuecomment-11639702)\n. > That's a good point. I kind of assumed they made it work. The best workaround is probably to use replace to.be.true with to.equal(true). The same thing should be the case for to.be.false and to.be.null. Will look into that.\nThis is one of the reasons I initially used https://github.com/Automattic/expect.js (and kept using it since, I think chai wasn't really a thing then, the other choice was 'should.js'). \n. :+1: \n. 1. Because of the effort of porting it. But you already did this.\n2. Two PRs would be a nice separation I think.\n. It's still true that request.send() === request?\nIsn't it usually that some action, in the case of request .send() returns a new promise object, which can be seen as a 'placeholder' until the promise is fulfilled or rejected?\n. :ship: it\n. That's because it uses Object.keys now, which internally uses ToObject(o) (for newer browsers at least), which throws for null and undefined. \nFor MooTools, the behavior of other types of values is not documented, so we don't guarantee the result of Object.values(null).\nLooking at the ES2016 proposal for Object.values, it will use ToObject(o) as well, thus throws, so is more or less consisted with MooTools 1.5.2 Object.values\n. I don't think we should do the .addEvent('pointerdown', fn) polyfill for older browsers or browsers that don't support it yet, see https://github.com/jquery/PEP\nWhat could be added is something like https://github.com/mootools/mootools-core/blob/master/Source/Types/DOMEvent.js#L73-L84 for pointer events, so all the interesting properties are available on the MooTools DOMEvent object too.\n. Yes. Same for touchevents, those are not documented at all yet http://mootools.net/core/docs/1.5.2/Types/DOMEvent\n. I'm not sure why you'd want this.\nAlso, you can easily add a RequestFactory that creates request instances with two subscribed events: request and complete, that updates some count, something along the lines of:\njs\nvar count = 0;\nfunction createRequest(options) {\n  return new Request(options).addEvents({\n    request: function() { count++; },\n    complete: function() { count--; }\n  });\n}\n. Should we add the Array.from? I think just changing Array.from to Array.convert should do the trick. Historically $splat or Array.from is used internally, because it's useful for other things, but also to be used outside. Inside MooTools there isn't really a use case for the new Array.from.\nAdditionally I suspect people that want to use the new Array.from either assume a modern environment, or use babel/polyfill or similar.\n. Maybe you should do a search-replace through the entire docs, as Array.from is mentioned here too: http://mootools.net/core/docs/1.5.2/Core/Core#Deprecated-Functions:splat\n. If we decide to add the polyfill, we also need to test it ;)\n. @anutron of course we should maintain backwards compat (with the compat layer stuff), so Array.from = Array.convert.\nWhat I'm not sure of is whether we should add the new ES6 version as polyfill.\n. Looking at this pull request, @SergioCrisostomo just copied the one from MDN, which is likely pretty complete. However I don't think it's a good idea to just include it, as there are many other polyfills (or modern browsers) that developers can easily add themselves if needed.\nOf course, as I said earlier, if MooTools itself would make heavy use of this functionality, such as other ES5 methods like bind/forEach/map, then it would make more sense.\n. One major concern, however, is the API consistency with String.from / Number.from / Function.from.\nI suppose all of those need to change too, otherwise it would be inconsistent and weird.\n. +1 to convert to .convert for those too, like you said.\n. :+1: \n. :+1: \n. I don't think we've ever tested/tried to use MooTools in SVG documents in this way.\nThe error comes from a feature detection test, that expects a HTML page. Apparently el = document.createElement('div'); creates a SVG kind of element that does not have the style property like HTML kind elements have.\nI'm sure we can fix most errors, but I'm not sure how much work it will to make everything work nicely.\n. ",
    "subtleGradient": "Because it can throw a security error if the domains don't match. \n. Was this code pulled into master yet?\n. Sail it\n. I'm attempting to merge this in nao\n. pulled into 1.2x\n. Perhaps we should revisit this due to https://mootools.lighthouseapp.com/projects/2706-mootools/tickets/1040\n. Iirc we did this for perf in IE since it needs all the help it can get. \n. Oops. Thought this was slick. Dang my slackeryness.\n. VETO'd Aylott\nPartially implementing a standard interface and then failing silently some of the time is absolutely unacceptable.\nIf you do use something like this code in your own projects, I highly recommend adding a line like:\nif (arguments[1] != null) throw new Error('lol, ES5 shim')\nOr just use a different method name like Object.createSimple.\nI recommend using one of the dedicated es5-shim.js projects.\nThere's a guy who works on Narwhal.js that has one that is very good.\n. FuseJS uses object inference for the native JSON object, which is kindof lame.\nCf. https://github.com/jdalton/fusejs/blob/master/src/dom/event/dom-loaded.js#L282-286\n. Hmm\u2026 ScriptEngineMajorVersion() + ScriptEngineMinorVersion()/10 === 5.8 in IE8 as IE7\n. What about HTML conditional comments?\nhasOperationAborted = (div=document.createElement('div'), div.innerHTML='<!--[if lt IE 8]>1<![endif]-->0', !!+div.innerText);\n. @jdalton @cpojer Please let me know what you think of the IE check here. It should be as robust as you can get.\n. I haven't actually tested this fix yet, but it should work.\nlol #hypocrisy\n. Cf. https://github.com/subtleGradient/mootools-core/blob/d750a679faa78ed9978b12d964ad9a9bbe897bd4/Source/Utilities/DOMReady.js#L52-66\nThe trick I found with my DOMReady.php test is that doScroll on an element never throws when in an iframe!\ndoScroll on the body in an iframe throws, but only until document.body exists.\nSo the FT for doScroll is to just try it on an element. If it throws then it's safe to use it, if not then it's not. Easy.\nNo need to do any brittle browser detection or potentially slow or dangerous frame detection.\n@jdalton check out my doScroll feature test!\n. Yes, I have now tested it in all browsers. Success, I haz it\n. The switch to AMD should fix this\n. Yup. Definitely an issue. Should be a pretty easy fix I would assume\n. I agree with @JDalton.\nIf it was hard at all, it might be another story, but this is 1 line. Rediculous not to do it right if it's this easy. \n. 'prevent' is stupid. Keep 'preventDefault'\n. http://jsfiddle.net/LwPRF/4/\nI don't understand what the issue is.\nMaybe the bug got fixed?\n. Good stuff. Someone just needs to do a quick syntax/whitespace cleanup and it's :+1:\n. :+1:\n. Use AMD by default. Disabled by default in the online builder.\n. We should also include curl.js or RequireJS in the build when AMD is enabled on the online builder. Maybe allow building in both or neither separately from AMD support.\n. Exactly, yes. It should be relatively trivial to implement.\nThe tricky part would be when a single file provides multiple things.\nFor that you'd have to include the optional ID string in your define and then have multiple define statements.\nThen you'd either have to use an AMD path config to map them all to the actual file, or else duplicate the file for each path. That would be stupid, but it'd work since requiring any one of them would provide the other and then you'd never actually load both, but that's silly.\nI guess the best option would be for the script to add the define statements and generate the AMD config object for you with all the mappings.\n. The important thing is that we aggressively stop anyone from bike shedding on the unimportant details.\nJust add a comment that the specific paths used in your requires are definitely going to change in 2.0.\nUntil then it doesn't matter what exactly the require paths are. They can always be remapped with an AMD config later.\n. Without an AMD config that remaps stuff, the require strings map directly to the filesystem.\nA typical project would simply git clone each repo into their script folder. e.g. ...\n- /\n  - index.html\n  - scripts/\n    - require.js\n    - main.js\n    - mootools-core/\n    - mootools-more/\n    - mootools-plugin-foo/\n    - mootools-plugin-bar/\nSo, with this structure and no AMD config, the absolute require path 'mootools-core/Source/Class/Class' would map to Class.js from anywhere. However, from inside mootools-core itself, we would use relative require paths. So, Class.Extras.js could use the relative require path ./Class instead.\nIMHO, we should NOT change the folder/filename structure of the repos before implementing the script and require paths. Sure, the require paths will be ugly until 2.0, but nobody should really care, it's just not a big deal.\n. Also, since mootools-more is in a separate repo, it'll be in a separate folder and will need to use all absolute require paths to get to the stuff in mootools-core.\n. ### Multiple provides in a single file\nCore.js provides Core, MooTools, Type, typeOf, instanceOf, Native.\nThe simplest thing to do would be to split Core.js into separate files that only provide a single thing, and then make Core.js simply require them each and then provide them all for you. That way you can require each one individually or get them all by requiring Core itself.\nAlternatively we could add multiple define statements with an ID inside Core.js itself asif they had been separate files that be built into a single file using the RequireJS optimizer.\ne.g.\njavascript\ndefine('mootools-core/Source/Core/Type', [...], ...)\ndefine('mootools-core/Source/Core/typeOf', [...], ...)\ndefine('mootools-core/Source/Core/instanceOf', [...], ...)\n...\n. @seanmonstar agreed. These would all be options in the builder...\n- Enable/disable the AMD packager removable blocks\n- Include curl.js\n- Include RequireJS\n- Include simple mini require/define\nIdeally we should automatically include one of the AMD implementations in the UI when you manually enable AMD. That should keep people from accidentally downloading a build that won't work and then being annoyed. You'd still be able to manually disable the default or choose a different one.\n. > CJS+AMD is so much more beautiful\n\n-- @cpojer\n\nI generally agree that CJS+AMD is probably the way to go. However, that should not block supporting AMD asap. My goals are...\n1. Implement AMD asap\n2. Minimal changes necessary (code & repo structure)\n3. Allow AMD to be disabled (by default) in the online builder / Packager\nWe should not do anything else that would distract from, or delay, those goals\nSo, let's make it work first and make it pretty later. All energy on making things ideal should be focused on Milk and the MooTools.Next.\n. CJS+AMD allows for littering require statements throughout the body of the module code, making it much much harder to disable with Packager removables.\n. If we want to use exports, that's easily doable with something like this...\n``` javascript\n//define(['exports', 'foo', 'bar'], function(exports, foo, bar){(function(){//\nthis.LOL = \"yay!\" // existing code uses this to apply itself to the global object\n//}).call(exports)}})//\n```\n. Also, we need to be sure we're running all our tests against the AMD version of the code and with all the AMD stuff stripped out.\n. @seanmonstar @arian @cpojer It doesn't matter exactly what the boilerplate is, it only matters how much time and how many code changes are required to make it actually function.\nWe can debate the details in the thread of a pull request once we have one to talk about.\n. woah, looking nice!\nI'm very excited to see this moving forward\n. Go nuts.\nIt'd be nice to convert to CommonJS instead. There are already a million things that can convert that to AMD afterward.\n. Checkout the git-subtree.sh git plugin. It makes working with sub-projects like this really easy without having to use submodules.\n\u2014 Thomas Aylott - SubtleGradient - MooTools - Sencha (from iPhone)\nOn Nov 23, 2011, at 4:14 PM, Olmo Maldonadoreply@reply.github.com wrote:\n\nI think we should go ahead and remove the submodule and add the files directly. Optionally include tree (history) of information from the specs repo.\nWe could keep the runner as its own submodule, but we should also consider removing it as well.\nWhat say you?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2134\n. Because it can throw a security error if the domains don't match. \n. Was this code pulled into master yet?\n. Sail it\n. I'm attempting to merge this in nao\n. pulled into 1.2x\n. Perhaps we should revisit this due to https://mootools.lighthouseapp.com/projects/2706-mootools/tickets/1040\n. Iirc we did this for perf in IE since it needs all the help it can get. \n. Oops. Thought this was slick. Dang my slackeryness.\n. VETO'd Aylott\n\nPartially implementing a standard interface and then failing silently some of the time is absolutely unacceptable.\nIf you do use something like this code in your own projects, I highly recommend adding a line like:\nif (arguments[1] != null) throw new Error('lol, ES5 shim')\nOr just use a different method name like Object.createSimple.\nI recommend using one of the dedicated es5-shim.js projects.\nThere's a guy who works on Narwhal.js that has one that is very good.\n. FuseJS uses object inference for the native JSON object, which is kindof lame.\nCf. https://github.com/jdalton/fusejs/blob/master/src/dom/event/dom-loaded.js#L282-286\n. Hmm\u2026 ScriptEngineMajorVersion() + ScriptEngineMinorVersion()/10 === 5.8 in IE8 as IE7\n. What about HTML conditional comments?\nhasOperationAborted = (div=document.createElement('div'), div.innerHTML='<!--[if lt IE 8]>1<![endif]-->0', !!+div.innerText);\n. @jdalton @cpojer Please let me know what you think of the IE check here. It should be as robust as you can get.\n. I haven't actually tested this fix yet, but it should work.\nlol #hypocrisy\n. Cf. https://github.com/subtleGradient/mootools-core/blob/d750a679faa78ed9978b12d964ad9a9bbe897bd4/Source/Utilities/DOMReady.js#L52-66\nThe trick I found with my DOMReady.php test is that doScroll on an element never throws when in an iframe!\ndoScroll on the body in an iframe throws, but only until document.body exists.\nSo the FT for doScroll is to just try it on an element. If it throws then it's safe to use it, if not then it's not. Easy.\nNo need to do any brittle browser detection or potentially slow or dangerous frame detection.\n@jdalton check out my doScroll feature test!\n. Yes, I have now tested it in all browsers. Success, I haz it\n. The switch to AMD should fix this\n. Yup. Definitely an issue. Should be a pretty easy fix I would assume\n. I agree with @JDalton.\nIf it was hard at all, it might be another story, but this is 1 line. Rediculous not to do it right if it's this easy. \n. 'prevent' is stupid. Keep 'preventDefault'\n. http://jsfiddle.net/LwPRF/4/\nI don't understand what the issue is.\nMaybe the bug got fixed?\n. Good stuff. Someone just needs to do a quick syntax/whitespace cleanup and it's :+1:\n. :+1:\n. Use AMD by default. Disabled by default in the online builder.\n. We should also include curl.js or RequireJS in the build when AMD is enabled on the online builder. Maybe allow building in both or neither separately from AMD support.\n. Exactly, yes. It should be relatively trivial to implement.\nThe tricky part would be when a single file provides multiple things.\nFor that you'd have to include the optional ID string in your define and then have multiple define statements.\nThen you'd either have to use an AMD path config to map them all to the actual file, or else duplicate the file for each path. That would be stupid, but it'd work since requiring any one of them would provide the other and then you'd never actually load both, but that's silly.\nI guess the best option would be for the script to add the define statements and generate the AMD config object for you with all the mappings.\n. The important thing is that we aggressively stop anyone from bike shedding on the unimportant details.\nJust add a comment that the specific paths used in your requires are definitely going to change in 2.0.\nUntil then it doesn't matter what exactly the require paths are. They can always be remapped with an AMD config later.\n. Without an AMD config that remaps stuff, the require strings map directly to the filesystem.\nA typical project would simply git clone each repo into their script folder. e.g. ...\n- /\n  - index.html\n  - scripts/\n    - require.js\n    - main.js\n    - mootools-core/\n    - mootools-more/\n    - mootools-plugin-foo/\n    - mootools-plugin-bar/\nSo, with this structure and no AMD config, the absolute require path 'mootools-core/Source/Class/Class' would map to Class.js from anywhere. However, from inside mootools-core itself, we would use relative require paths. So, Class.Extras.js could use the relative require path ./Class instead.\nIMHO, we should NOT change the folder/filename structure of the repos before implementing the script and require paths. Sure, the require paths will be ugly until 2.0, but nobody should really care, it's just not a big deal.\n. Also, since mootools-more is in a separate repo, it'll be in a separate folder and will need to use all absolute require paths to get to the stuff in mootools-core.\n. ### Multiple provides in a single file\nCore.js provides Core, MooTools, Type, typeOf, instanceOf, Native.\nThe simplest thing to do would be to split Core.js into separate files that only provide a single thing, and then make Core.js simply require them each and then provide them all for you. That way you can require each one individually or get them all by requiring Core itself.\nAlternatively we could add multiple define statements with an ID inside Core.js itself asif they had been separate files that be built into a single file using the RequireJS optimizer.\ne.g.\njavascript\ndefine('mootools-core/Source/Core/Type', [...], ...)\ndefine('mootools-core/Source/Core/typeOf', [...], ...)\ndefine('mootools-core/Source/Core/instanceOf', [...], ...)\n...\n. @seanmonstar agreed. These would all be options in the builder...\n- Enable/disable the AMD packager removable blocks\n- Include curl.js\n- Include RequireJS\n- Include simple mini require/define\nIdeally we should automatically include one of the AMD implementations in the UI when you manually enable AMD. That should keep people from accidentally downloading a build that won't work and then being annoyed. You'd still be able to manually disable the default or choose a different one.\n. > CJS+AMD is so much more beautiful\n\n-- @cpojer\n\nI generally agree that CJS+AMD is probably the way to go. However, that should not block supporting AMD asap. My goals are...\n1. Implement AMD asap\n2. Minimal changes necessary (code & repo structure)\n3. Allow AMD to be disabled (by default) in the online builder / Packager\nWe should not do anything else that would distract from, or delay, those goals\nSo, let's make it work first and make it pretty later. All energy on making things ideal should be focused on Milk and the MooTools.Next.\n. CJS+AMD allows for littering require statements throughout the body of the module code, making it much much harder to disable with Packager removables.\n. If we want to use exports, that's easily doable with something like this...\n``` javascript\n//define(['exports', 'foo', 'bar'], function(exports, foo, bar){(function(){//\nthis.LOL = \"yay!\" // existing code uses this to apply itself to the global object\n//}).call(exports)}})//\n```\n. Also, we need to be sure we're running all our tests against the AMD version of the code and with all the AMD stuff stripped out.\n. @seanmonstar @arian @cpojer It doesn't matter exactly what the boilerplate is, it only matters how much time and how many code changes are required to make it actually function.\nWe can debate the details in the thread of a pull request once we have one to talk about.\n. woah, looking nice!\nI'm very excited to see this moving forward\n. Go nuts.\nIt'd be nice to convert to CommonJS instead. There are already a million things that can convert that to AMD afterward.\n. Checkout the git-subtree.sh git plugin. It makes working with sub-projects like this really easy without having to use submodules.\n\u2014 Thomas Aylott - SubtleGradient - MooTools - Sencha (from iPhone)\nOn Nov 23, 2011, at 4:14 PM, Olmo Maldonadoreply@reply.github.com wrote:\n\nI think we should go ahead and remove the submodule and add the files directly. Optionally include tree (history) of information from the specs repo.\nWe could keep the runner as its own submodule, but we should also consider removing it as well.\nWhat say you?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2134\n. \n",
    "ibolmo": "Could you add a spec to check why this is necessary. I'm not following why this commit is necessary. Thanks for the contribution.\n. To make it a little faster you could cache or scope out prior to invocation: http://jsperf.com/regep-in-or-out/3\n. I know its considered private property, but do you think there should be a compat section?\nElement.ProtoType = Element.Prototype;\n. Oh. lgtm then.\n. Thanks @kamicane and @fabiomcosta. Have another go.\n. This is invalid since looping through each key and object may seem as if it follows the order that you defined the object, but it's not part of the EcmaScript standard. \nSee: http://stackoverflow.com/questions/648139/is-the-order-of-fields-in-a-javascript-object-predicatble-when-looping-through-th\nThere's plenty of ways get an ordered list (linked list, array of keys and array of values, and so on) and depending on your design/requirements you'll want to choose the best one that fits. \n. Not necessary but this is great work. Thanks Arian. :+1:\n. This is fixed in MooTools More Drag.\n. You could upgrade to 1.4.5, see if this fixes your issue. 1.4 is 1.3\ncompatible.\nOn Tue, Feb 28, 2012 at 11:21 AM, Piers Karsenbarg <\nreply@reply.github.com\n\nwrote:\nJust come across this. What the OP was saying was that if you just run\nmootools 1.3 (and in fact only this file) in IE 7 or 8, you get the error\nthat he stated above.\nTherefore you can't run anything in JSFiddle as it's not anything that's\nbeen built on mootools 1.3, it's mootools itself.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/86#issuecomment-4220631\n. Hrm. My predicament is that while I tested the jsfiddle against 1.3.2 compat I noticed that the following keys did not show up in the key correctly:\n\n-=[]\\;',./`\nctrl\nalt\nwin\nshift+nums\nYour changes, though, did fix the num key pad. So I think I will merge, but our solution seems to miss a lot of keys.\n. I've checked. They're just a layer on top. They're looking at the key as you\nhave. It's a small parser to check if each key is pressed. What they do with\nthe modifiers is not see if it's pressed (as in the key value) but if the\nevent[modifer] is set.\nWhich could be simplified if key did return the right key (e.g. alt, ctrl,\netc.).\nOn Thu, Aug 11, 2011 at 2:48 PM, GCheung55 \nreply@reply.github.comwrote:\n\nIt's possible to add the additional keys to Event.Keys. I haven't checked\nwith MooTools-More Keyboard.JS has done so though..\nSent from my iPhone\nOn Aug 11, 2011, at 7:19 AM, ibolmoreply@reply.github.com wrote:\n\nHrm. My predicament is that while I tested the jsfiddle against 1.3.2\ncompat I noticed that the following keys did not show up in the key\ncorrectly:\n-=[]\\;',./`\nctrl\nalt\nwin\nshift+nums\nYour changes, though, did fix the num key pad. So I think I will merge,\nbut our solution seems to miss a lot of keys.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2002#issuecomment-1782158\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2002#issuecomment-1785294\n. :+1:\n. Updated the fiddle and looks like the attribute does have an empty string: http://jsfiddle.net/ubLw5/2/ for all browsers I've tested (FFx, IE, Safari, Chrome, ...)\n\nSo.. worksforme. You're probably seeing the attribute as <div attribute> because of the developer tools vs Firebug it'll show the empty string.\nRe-open the issue, if you can provide a better test case.\n. Agreed, and thanks to Arian's clarification 1.3 runs native if present and for 1.2 with compat runs a much slower version :(. Nevertheless, I guess the bench should compare against non native bind. Finally, agreed that there's only too much one can do to speed this up.\n. Working on it.\nOn Aug 4, 2011 1:23 PM, \"cpojer\" \nreply@reply.github.com\nwrote:\n\nI strongly feel that this should be internal to Element.Styles and not\nexpose any public object. I'd agree to pulling this for 1.4 although you'd\nhave to check with Valerio for future compatibility.\nAlso, where are all the specs? I won't pull without extensive coverage :)\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2007#issuecomment-1729396\n. Separate dependency is for reducing footprint on Browser.js (and on Element.Styles.js -- I may not need this augmentation). That's a separate matter from public/private.\n\nI don't mind it being on Browser.Features.Styles if we can see ourselves using it as a boolean check. @csuwldcat did you get a chance to write some docs? That'll make it easier to understand if it should be public, semi-private, or private.\n. Dropping this for now. Since Daniel has some changes that I haven't incorporated. He should be the one pull requesting. ;)\n. Also on Chrome 14.0.835.18 dev Mac OS X 10.7 no issues. Looks like a Chrome 13 issue. Perhaps we should notify people as a known issue, but we'll leave it as wont fix since it'll fix itself in matter of weeks (when Chrome 14 goes stable).\n. Yeah that wasn't nice @cpojer. Any report is better than no report. \n. I'm willing to spend 2 minutes on a bad ticket another 2 to explain (nicely)  how to make a (proper) ticket. So that someone else spends 25 minutes trying to figure out a problem and 5 minutes to write a ticket. :D\n. Isn't that what this does? Object.extend should look for the native Object::create, if not found then adds this workaround. \nThe other suggestion was to protect Object::create from being munged by Function.create. Advice.\n. Looks pretty good. Now you're missing the .html spec (which I don't see a spec commit update included) and fixes to the style. \n. Did you:\nsh\ncd Specs\ngit commit -am \"changes\";\ngit push origin master;\ncd ../\ngit add Specs # now it's available to be included in the Core repo.\ngit commit -am \"Updated specs.\"\ngit push origin master\nThe gotcha (and I can already hear you complaining about git... :D) is that the spec submodule must be committed (without dirty bit set) so that it can be included in you commit. Go ahead do the above, and your pull request should update it  self.\nMake sure to update any remote or branch aliases.\n. He included unnecessary stuff. He's fixing the pull request soon.\nOn Wed, Aug 10, 2011 at 2:27 PM, cpojer \nreply@reply.github.comwrote:\n\nThis is a crazy amount of code. It used to be 10 lines.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2018#issuecomment-1775847\n. Worth noting that the spec doesn't define a value attribute in select element (see: spec) but using a fiddle we can see that all modern browsers returns the value for select of the first selected option.\n. Correction. There was a spec: http://www.w3.org/TR/html5/the-button-element.html#dom-select-value\n. Someone care to make a quick .html ala Delegation.html ?\n\nI'd say, do a comparison between a 50% applied via browser and 50% applied\nin photoshopz.\nAnd one with effect from 100-0 (get from demo?) iframez?\nOn Wed, Aug 17, 2011 at 2:20 PM, arian \nreply@reply.github.comwrote:\n\nas far as I tested (just typing some stuff in the consoles of IE8/chrome)\nit seems to work. If this stuff is enough covered by the specs (not really\nfor setStyle/getStyle as far as I see) they also pass in IE6, Firefox 6 and\nOpera.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2027#issuecomment-1829612\n. I tweaked it and optimized it a bit: https://gist.github.com/1147965\n\nSince it's going in Element.Event.js now, we'll just need to do some last minute fixes to the pull request. Sorry @csuwldcat :D. Great job!\n. I'm going to do the fixes, so we can push this. Hang on tight :D\n. Closing since I didn't use a topic branch.\n. @Xunnamius figured out your bug :D.\nGlad to say it wasn't MooTools this time.\nIn your ACJ.js file \n``` javascript\n(function(){\n    for (var i = 0; i < arguments.length; i++)\n        APE.Config.scripts.push(APE.Config.baseUrl + '/Source/' + arguments[i] + '.js');\n})(/ --> / 'mootools-core' / <-- /, 'Core/APE', 'Core/Events', 'Core/Core', 'Pipe/Pipe', \n```\nTo:\njavascript\n(function(){\n    APE.Config.scripts.push(APE.Config.baseUrl + 'mootools-core-1.4.0.js');\n    for (var i = 0; i < arguments.length; i++)\n        APE.Config.scripts.push(APE.Config.baseUrl + '/Source/' + arguments[i] + '.js');\n})('Core/APE', 'Core/Events', 'Core/Core', 'Pipe/Pipe', 'Pipe/PipeProxy', 'Pipe/PipeMulti', 'Pipe/PipeSingle', 'Request/Request','Request/Request.Stack', 'Request/Request.CycledStack', 'Transport/Transport.longPolling','Transport/Transport.SSE', 'Transport/Transport.XHRStreaming', 'Transport/Transport.JSONP', 'Transport/Transport.WebSocket', 'Core/Utility', 'Core/JSON');\nEffectively. You were including 1.3.2 in the iframe that APE creates. Since the mootools loaded in the iframe affects the MooTools in the parent frame, you or APE should include the 1.4 version.\n. If they build from github master, they shouldn't have problems. We're\nreleasing 1.4.1 this week.\nOn Tue, Sep 20, 2011 at 8:27 PM, Tre Giles \nreply@reply.github.comwrote:\n\nAh, I thought the iframe would have isolated the two Moo implementations\nfrom one another. Mistaken I was!\nWell, my little hackfix is working at the moment (I'm a little scared to\ntake it out), but I'll forward this to the APE guys. Maybe they'll look at\nit and finally upgrade their Moo!\nThanks.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2062#issuecomment-2151740\n. Take a look at: http://ariya.ofilabs.com/2011/08/hall-of-api-shame-boolean-trap.html\n\nRemoving the first argument would hinder the readability of API. Second, .toggle doesn't mean anything to me. First thought is: \"toggle what?\".\n. Ahh sorry, then. You submitted the issue in mootools-core. You should try to create the issue here: http://github.com/mootools/mootools-more.\nMy personal opinion, though, is to deprecate the toggle method. \n. worksforme.\nHere's the deal. If you set async to false then the method Request.send is blocked by line 199 because you asked that it should (remember the async false?).\nSince send is blocked and eventually fires the events (e.g. onSuccess) and then sets up the delay, but by then send is all done and the request has already finished.\nRe-open if you have another problem.\n. Ah I see what you mean, but I think the options are mutually exclusive. You either do async: false or you do timeout: 1000.\nIf you do async: false the XHR transport will rely on server timeout or browser set timeout (internal to the transport, or perhaps a blocking protection which will prompt user to kill the javascript that is blocking) to return execution to the script. \nI've reopened this issue as a documentation issue. Do you agree?\n. @arian @cpojer, we could still reduce headaches if we do as @kguelzau mentioned. To add an else if. If you guys agree with my last comment, I don't see a problem of adding that else if on this line.\n. ?\n. :+1:\n. Worksforme in IE7. \n. Chrome latest, Safari latest, Opera, Firefox 3-5.\nThe fix in Element.js is to overload the setter, getter, and erase to\nforcibly update the id attribute (on the object) and with the attribute\nnode. It's unfortunate, but IE has trouble removing attributes of\ncloned nodes.\nWe should be vigilant of other troublesome attribute nodes that might be\nproblematic.\nPlease review and merge.\n. Fixed in https://github.com/mootools/mootools-core-specs/pull/22\n. Started working on the fix, but I'm getting stuck on reproducing. Do you mind providing a jsfiddle? \n. Hi @reaktivo, I'm going to have to move this to 1.4.4 (closes in 3 weeks). I'm afraid that if we don't get an example by then I'll have to close this issue until we get your help. No pressure, haha. \n. Wait why wouldn't: element.addEvent('click:relay(a)', cb).fireEvent('click'); // not fire click?\nhtml\n<body>\n  <ul class=\"nav\">\n    <li><a href=\"javascript:void\">First</li>\n    <li><a href=\"javascript:void\">Second</li>\n    <li><a href=\"javascript:void\">Third</li>\n  </ul>\n</body>\n``` javascript\n$(document).addEvent('click:relay(ul)', function(){});\n$$('ul.nav').getFirst().addEvent('click:relay(a)', function(){}).fireEvent('click');\n```\nIn the above, shouldn't the delegator on document fire when click event is fired in the .nav? \n. So I guess we agree that it should fire. Hrm.. o well. Only more of a reason to rush 2.0 out the door.\n. Likely not going to happen anytime soon\u2122.\n. Actually just don't escape it: http://jsfiddle.net/NA4V2/3/\nI'm closing for now. Please reply if escaping is your only option.\n. doh.. http://jsfiddle.net/J59PD/9/\ncick to click :D\n. Fixed with #2140.\n. Yeah.. this is also for IE6. Here's a fiddle: http://jsfiddle.net/tQ4QN/\n. Here we go: http://jsfiddle.net/tQ4QN/4/\n@fabiomcosta @SubtleGradient, this is a tough one ... should Slick.getAttribute fix this?\n. Actually, this might be mootools related. @arian @cpojer help :D\n. Still waiting on input from @fabiomcosta, @subtleGradient, @arian, @cpojer. Looking for opinions/direction or 2c. Thanks!\n. The problem is that\nel.anything will be considered an attribute by IE. This means that el.getAttribute('anything') will give the value of it. \nOne solution is to whitelist using setProperty any attributes and check against the property in getProperty if someone wants el.something they should use el.something. Again, this reinforces that el.you = 'set the value' is very bad.\n. Yeah this is a webkit bug: https://bugs.webkit.org/show_bug.cgi?id=14439\nI can write a fix, though so that Element.set fixes this in the mean time. Stay tuned.\n. I've experienced this myself and the issue here is that the website is not ready to support this kind of change. I leave it to @w00fz to decide if we should wait for 2.0 or have this out for 1.5 or 1.6.\n. @arian @cpojer \nI wouldn't mind if this was global. Perhaps renamed to uniqueId, or as @fabiomcosta mentioned Object.uid.\n. Sure, the suggestion for uniqueId is that there's not appropriate parent object. Since it's useful and quite standard in other languages, I figured it should just be a simple rename.\n. nah we can just deprecate\n$uid = uniqueId\n. hehe wasn't private if it was accessible globally. perhaps \"protected\". At any rate, I prefer the deprecation, and then remove it in 1.5 or 2.0. \nBetter safe than sorry\u2122\n. Yeah that was my opinion that all browsers should have a uniqueId, but if\nwe don't agree than we should just keep it some where else and not\npollutant.\nI guess you're in the camp of not polluting?\n@arian would you be against Object.uid?\nOh and regarding protected, or private. Since Slick uses it, I think it's a\ncandidate to say it should be public. We should document it.\n2011/11/24 F\u00e1bio M. Costa <\nreply@reply.github.com\n\nIf it's meant to be protected then we should make it clear, like doing\nwhat python does, prefixing an underscore, _uniqueId.\nA global uniqueId variable looks like trouble to me, it's kind of a\nregular name for a function that someone could still have on they're\nprojects.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2118#issuecomment-2862390\n. Ok I think I understand how this got all jumbled up. \n\nHere's when we had the default: fade.start(o, arguments); 1;\nHere's when we had the visibility problems with fade 2.\nFinally we're trying to get this going because default case is no longer present.\nI think this function would be simplified if we dealt with the visibility problems separately.\nHere's an untested and probably not done work, but I think it's clear of the direction I'd like for us to go: https://gist.github.com/1389476\n. @arian the only thing missing is just a spec that covers this special case. perhaps in a compat test.\n. See: https://github.com/mootools/mootools-core/commit/45cd384e5487bc4751c5b688167ba7f1678d765d\n. I'm having trouble reproducing this as well. I've gone as far as identifying a few leaks in Element.js that I've cleaned up and will create a PR for, and will continue to try to find the other leaks, but it'd be best if @gd0t provided us with a procedure on how to reproduce.\n. Thanks @gd0t. I'll add another issue to test for instanceOf leaks. In the mean time, you should reconsider using Process Explorer and opt to use sIEve. A couple of reason why:\n- Process Explorer looks at a whole process. Not very granular (e.g. you don't know which nodes are leaked).\n- There are fake leaks that stay in memory until the browser is closed. We should minimize these, but not much we can do. \nOtherwise, I think it's fine to use Process Explorer; but I think you'll find sIEve much more detailed tool.\n. Do you have a blog post or screencast in your leak finding process? I'd be\na good article.\nOn Mon, Jan 9, 2012 at 2:14 PM, John-David Dalton <\nreply@reply.github.com\n\nwrote:\nTools like sIEve give false positives and can cause devs to waste time. I\nfind it's best to use use Process Explorer and a\nsimplified test case to locate leaks. I am aware of the instanceof leak\nand try to avoid it in places like Benchmark.js.\nThat said not even dummy element created has to be nulled.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2127#issuecomment-3419432\n. Nice screencast. I guess process explorer is really handy to just notice if\nthere's a leak. I liked that sIEve gave some nodes to help me find the\nleak. How did you narrow the leak to replaceChild?\n\nOn Mon, Jan 9, 2012 at 2:35 PM, John-David Dalton <\nreply@reply.github.com\n\nwrote:\nHere is a blog post I did over a nice single page memory leak in IE\nassociated with removeChild.\nhttp://allyoucanleet.com/2011/02/16/exploring-the-removechild-single-page-memory-leak/\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2127#issuecomment-3419781\n. Yeah the UA sniff was a quick solution, I didn't invest on thinking on the best feature detection. \n\nI'm not against removing the width and height prior to setting the src. \nGood call on checking against img tag. Not going to be a problem with 2.0, hehe. \nI'll wait for your 2k5/2k6 research, and create the PR afterwards.\n. Hrm.. I couldn't find what the spec mentions about width/height attribute\nvs CSS with the definition of width and height, but perhaps we can take\ntheir decision to drop cellpadding cellspacing in favor of margin and\npadding in table.\nAnd since they're using Element.set('src') rather than just element.src,\nperhaps with documentation it might suffice to explain the convention on IE\nonly.\nOn Sun, Nov 20, 2011 at 3:30 PM, John-David Dalton <\nreply@reply.github.com\n\nwrote:\nOk so I did some research and it seems the reason IE isn't changing the\nimage size is that it is automatically assigning it a height/width\nattribute. The other browsers resize the image because there is no\nexplicitly set dimensions.\nBecause IE auto adds these attributes it may be tricky to detect if they\nwere explicitly assigned or auto so simply clearing them is not a good idea\nbecause they may be added on purpose.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2129#issuecomment-2808620\n. @jdalton, @cpojer, and @arian. What'd you think of my last comment. \n. Ok I may have an actual boss solution. Since it's so late, I'll document it and either one of you guys get around to it before I do (or refute it) just follow-up here.\n\nTake a look at: http://jsfiddle.net/XS6Kw/\nDOM 2 (or whatever) added a specified attribute to an Attr node. Since IE6 it's been supported. The idea is that there is a way to know if an attribute had been previously been specified by the user. Either by html or programmatically (el.width =).  This is by using the specified attribute in the attribute node.\nThis assumes that Element.set('src') is being used, otherwise burden falls to the developer. Element.set('src', ...) remove attribute nodes width and height (not necessarily mutually) if they haven't been specified. If specified, the question falls to what the other browsers do (TODO). If the user specifies a width attribute and changes the src to a different sized element, I assume that the browser will honor the specified attribute and not look at the new image sizes. Therefore, in IE we'd just let those attributes stick.\nThat's it for now. It's a good move forward, imo.\n. Going for the doc.\n. https://github.com/mootools/mootools-core/pull/2131\n. Thanks @jdalton. Took a look and it seems that the only thing missing is: iterables and skip check. Since we don't support iterables (ringojs) we can postpone that for later. The skip check, though, might be appropriate. We've had overload since 1.3, so we haven't seen any problems (perhaps obvious problems). \n. haha sorry to have closed this from a git push. I'm going to use milk's issues to track this. For now we can keep this closed and trickle down the fix later.\n. What browser? I can't seem to reproduce in Chrome.\n. I'm closing this for now, please open up with browser, OS, and ideally a jsfiddle showing the unexpected result.\nCheers,\n. Well, we'd have to keep the comment blocks as I mentioned in the issue description to keep 'em. This way we could release it in 1.4.2, instead of waiting for 1.5.\n. As a note, this also implies work on the website.\n. Ah nice find!\nSo you support flattening the folders for ease of development?\nOn Wed, Nov 23, 2011 at 7:14 PM, Thomas Aylott <\nreply@reply.github.com\n\nwrote:\nCheckout the git-subtree.sh git plugin. It makes working with sub-projects\nlike this really easy without having to use submodules.\n\u2014 Thomas Aylott - SubtleGradient - MooTools - Sencha (from iPhone)\nOn Nov 23, 2011, at 4:14 PM, Olmo Maldonadoreply@reply.github.com wrote:\n\nI think we should go ahead and remove the submodule and add the files\ndirectly. Optionally include tree (history) of information from the specs\nrepo.\nWe could keep the runner as its own submodule, but we should also\nconsider removing it as well.\nWhat say you?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2134\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2134#issuecomment-2857157\n. I haven't mastered git-subtree, but I think that it'll seem as if the files\nare just in the repo, but for those with subtree will be able to maintain a\nseparate repository for others to contribute without having to work through\nthe mootools-core repo.\n\nSo I propose the following.\nmootools-core-specs deprecated (README updated with such information), and\nnot a subtree.\nmootools-runner should be kept as a submodule for the time being, but\nnow at least it'll be a submodule of the core project and not of core-specs.\n2011/11/24 F\u00e1bio M. Costa <\nreply@reply.github.com\n\nI prefer removing the submodule and adding the specs directly to the -core\nrepo.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2134#issuecomment-2862094\n. Correction. git-subtree.sh is not that it'll seem as files in the repo,\nbut they actually are files in the repo. Except that subtree helps us\nseparate the history (and push that history) to and from a separate\nrepo.\n\nBasically it reduces the git submodule update --init and other headaches\nfor those that don't understand (or care to understand git submodules).\nI still think, though, that we shouldn't bother picking up a new technology\nuntil we really need it. We will unlikely update the runner as often as we\nupdate the specs. Therefore, we should leave the Runner as a submodule and\nreview the submodule situation a month or two in the future.\n2011/11/24 Olmo Maldonado olmo.maldonado@gmail.com\n\nI haven't mastered git-subtree, but I think that it'll seem as if the\nfiles are just in the repo, but for those with subtree will be able to\nmaintain a separate repository for others to contribute without having to\nwork through the mootools-core repo.\nSo I propose the following.\nmootools-core-specs deprecated (README updated with such information), and\nnot a subtree.\nmootools-runner should be kept as a submodule for the time being, but\nnow at least it'll be a submodule of the core project and not of core-specs.\n2011/11/24 F\u00e1bio M. Costa <\nreply@reply.github.com\nI prefer removing the submodule and adding the specs directly to the -core\n\nrepo.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2134#issuecomment-2862094\n. Fixes #2073.\n. Fixes #2085\n. Well since this just adds a _fireEvent, unless you're looking for it this shouldn't cause anyone any problems.\n. Fixes #2089.\n. Done https://github.com/mootools/mootools-core/commit/74644b1b4c26e2ad188966c517ab1bc77ab07517.\n. Fixes #2100.\n. See the new specs: https://github.com/ibolmo/mootools-core-specs/commit/1bca15d25d0fca190aeb4e7b12e261d135b6b311\n. Naice. Looks like this fixes #2108 as well\n. Agreed, we should refer people to this conclusion when encounter similar confusion.\n. Fixes: #2113.\n\n\nHere's the new spec: https://github.com/mootools/mootools-core-specs/pull/25\n. Fixes #2118.\nHere's the specs: https://github.com/mootools/mootools-core-specs/pull/26\nPASSED: IE6-9, FFx 3-5, 8, 10, Opera 11, Chrome latest, Safari 5\n. Yeah I agree. @cpojer, do you concur?\n. @fabiomcosta I ran the specs against IE6-9, Safari 5, Chrome latest, Opera 11, FFx 3-5, 8, 10. All PASS.\nOnly scenario is that we didn't have a spec that would fail. Do you have a XML node test we should use?\n. You rock :D @arian++\n. Actually, contains should accept an id string. Must be a backwards compat problem.\n. Well issue with the docs is that they are showing the latest code. For a long time I've wanted version dependent docs. So no, right now the docs should show how to write the code for 1.4.1.\nI just did some research and looks like we've never had a contains method. Just a hasChild, and that has proper BC.\nThe contains you're seeing is a cross-browser fix so that it's available everywhere. The API is such that it complies with: http://msdn.microsoft.com/en-us/library/ms536377(v=vs.85).aspx.\n. Can you include a fix to the arguments list?\n``` markdown\nArguments:\nel - (element) The element to search for.\n```\n. TY! Keep 'em coming\n. Thanks for the inquiry. Actually prior to 1.4.0 mootools was inconsistent.\nElement.set is used to set Element properties.\nElement.setStyle is used to set CSS properties.\nTherefore, it's appropriate for setStyle to only modify the opacity CSS property while the Element.set('opacity' is used to set opacity and anything else (like visibility).\n. Nice!\nYou're missing docs and specs, and I'll get around to picking at your code this weekend. Cheers.\n. Fixed. No ref needed. Work done in the backend.\n. Thanks, could you provide us with a copy of the UA string? I'd like to study it before merging in this PR.\n. @arian could be as a result of hp acquiring webOS?\n. @cpojer @arian I've been thinking about this. Technically empty in Array.js doesn't do anything to the objects inside, it just removes them from the array. Which is what's currently done in 1.4.2. Perhaps just a special note in the docs will suffice to express a best practice:\nNote:\nElements.empty does not destroy the elements inside. As best practice, always destroy your elements if they're no longer in use. For example:\n$$('div').destroy().empty();\n. You can view the file in github: https://github.com/thatmarvin/mootools-core/blob/d034134d95853e6443841c3e8dd67b97f2382c77/Docs/Fx/Fx.md\nThe only rendering missing is the links, but we'll help you with that -- or it's an easy fix.\nThanks for contributing.\n. I don't suppose you'd like to write a spec case for this? :D\nAlso, I'll merge this to 1.5.0 branch soon. @cpojer or @arian do you concur on putting this in 1.5.0 or should this go in 1.4.3.\n. Yeah it's just a little hidden since it was made for a prior version: https://github.com/mootools/mootools-core/blob/master/Specs/1.3base/Fx/Fx.js\n. Shouldn't be a problem. You can commit it to your master branch and I can pull your request locally. I can run the specs and find out what the problem is. \n. @arian perhaps this is best solved in Fx.CSS reasoning stands that getStyle should fix this, but if it does it will be impractical unless there's a way to know what kind of unit you're expecting (perhaps an additional argument to getStyle?). Which is where Fx.CSS has the advantage. We can edge case check for '%' and use a feature detect to fix the behavior.\nAlthough I'm not excited to display: none then display: block e.g. will cause a refresh glitch. Se la vi. \nTL;DR:\n1. feature detect for bad behavior\n2. Fx.CSS.prepare, if bad behavior and %, display none, getStyle, and display: block\n3. add Note in getStyle about FFx and Opera bug.\n   Optional:\n4. Add a github issue for adding a unit argument to getStyle for conversions.\n. @DimitarChristoff, @stecb please give us a hand and test the master branch with your code. \nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master\n. @jbgithub Undoubtedly we have released versions that introduced new bugs as a result of fixing old bugs. Even though we did thoroughly test each version prior to commit, I think you can appreciate the difficulty it is to have thorough and effective tests.\nAs soon as someone submits a new issue we usually fix the behavior only after we've created specs/tests that confirm the problem. This ensures that future commits cover those cases. We are not, however, predisposed to knowing if a fix will cause another bug if our specs/tests never covered the created edge case. As you're probably aware.\nI also, hope, you're not suggesting that 1.4.1 and previous versions were bug free. \nI think your suggestion that we should have a freeze period prior to public release, is acceptable and something we've already considered and put into action. As you'll notice we've asked @stecb and @DimitarChristoff to test in their builds and sites. Likewise, you're welcome to test master branch against your code base. \nI also recommend that you separate your environments to include a staging area. That is not public, but also not behind a firewall, so you can invite private beta testers. This may include us. \nOverall, it's a difficult issue since we cannot be stalled with the fear of introducing new bugs. We are going to adjust to have a buffer prior to release so as to reduce the chance that a release will have critical bugs. Finally: we can never guarantee a bug free release. With your help, and our community's help, we will find the bugs faster. Create coverage. Fix the bugs. Release a new version; and repeat.\n. Thanks for your understanding, and I'm excited to have you on board for the freezing period. At some point, we'll open it up for more volunteers but we'll use issue contributors to ping for testing.\nFor now please check the stability of 1.4.5dev and if any of your tests fail, please let us know. We should start trickling specs/tests from user space to dev. We'd like to release 1.4.5 some time this week. \nRegarding the fireEvent, could you please report it in another issue? I'd like for others to review it.\n. Thank you @DimitarChristoff .. @arian looking go so far. Let us know when QA gives you the seal of approval, we'll tag it and ship it then -- I believe.\n. @jbgithub here ya go http://mootools.net/nightly/build/mootools-core.js\n. Thanks for your submission. We'll try to reproduce the crash ourselves, but\nit'd be best if you provided a jsfiddle.net with code that would reproduce\nthe problem.\nOn Wed, Dec 7, 2011 at 6:37 PM, isfalse <\nreply@reply.github.com\n\nwrote:\nPlatform : Windows XP SP2, IE Version 7.0.5730.11\nTested with Mootools 1.4.2 Full Core Version without compatibility,\ncompressed\nBackward issue on IE7 with Mootools Core 1.4.2, addEvents or clones (i\ndon\u2019t know) cause IE7 crash when \u201cBackward Page Button\u201d is pressed or\n\u201cRefresh Page Button\u201d is pressed.\nI have a lots of Class and functions in my scripts and it works fine with\nMootools Core 1.4.1. I've search before in my scripts if some errors was\nin, but that issue appears when \"addEvent/addEvents/cone\" are called and if\ni use Mootools Core 1.4.2.\nThanks\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2163\n. I'm having trouble reproducing. I have the same setup as you do. The only thing I can attribute to the crash is that jsfiddle has an unload problem and that you're using console.log :D. \n\nYou should enable script debugging in IE and confirm that's the reason that it crashes. I might also suggest to host the file yourself and link us.\nFor the moment, worksforme. I'll close and feel free to reopen.\n. Just tried all three links, and I still can't reproduce it. I'm at my wits end. I'll leave it open and ask one of the other developers to try to reproduce. Sorry for the inconvenience. \nIn parallel, we're releasing 1.4.3 with a fix that -- as an educated guess -- might be related to this: https://github.com/mootools/mootools-core/pull/2176/files\nIf you would please try to apply that diff to your copies of 1.4.2 and see if the problem is solved or still present.\n. Thank you for the detailed instructions. I've followed your steps, but my IE7 doesn't crash :(. \nI'm glad the patch fixed it, though. I'll reference it in the PR. It's troubling, though, that I couldn't reproduce it. I wonder what's wrong with my IE. Perhaps I have a patched version.\n. @isfalse just modify .uid to .uniqueNumber and 'uid' to 'uniqueNumber'. You can use the diff link I provided as guidance.\n@incendium hehe always. keep sending us the bugs that you find. trying to make it a habit to release maintenance releases every 2-3 weeks.\n. I'm closing this since #2176 fixes this.\n. If you guys are using a VM, and you're comfortable with the idea, could you\nhost your VM and link me to your VM? I can run it in VirtualBox as well.\nYou can message me (via github) directly if you do not want to disclose it.\nI still can't repro it :(\nOn Wed, Dec 21, 2011 at 9:51 AM, Matthew Gast <\nreply@reply.github.com\n\nwrote:\n@ibolmo It looks like using @isfalse's test page crashes my IE\ninstallation as well. Here are the steps I took to reproduce it:\n1) Close all running instances of IE7\n2) Open IE7 and disable all addons\n3) Close all running instances of IE7\n4) Open http://www.apixelife.com/github/2163/mootools-core-1.4.2.html\n5) Refresh page using Ctrl+R\n6) IE7 crashes\nI peeked at his mootools.js file and it looks like he patched it OK.\nPerhaps there is some attribute that IE doesn't like and crashes when it\ntries to clear it?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2163#issuecomment-3235346\n. nice find. i will give it a shot when i get in the office in about an\nhour. ty for the hard work\n. Well here's the dealio. Line #261 will only execute for <IE8 since there is\nno native Element. This would mean that Browser.Element is null or\nfalse-y.\n\nTherefore your suggested fix means that the crash no longer occurs because\nel._fireEvent = el.fireEvent; is never executed.\nI can conclude, then that IE7 is having difficulty setting the attribute to\na function. I think the solution is then to store the fireEvent method in\nElement storage. I'm going to try this in a bit. I promise that 1.4.3\nwill not roll out without a fix to this.\nThanks for everyone's patience.\nOn Sun, Jan 8, 2012 at 11:48 AM, jbgithub <\nreply@reply.github.com\n\nwrote:\n@arian Yes, line #261.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2163#issuecomment-3403301\n. I'll try. TY\n\nOn Sun, Jan 8, 2012 at 5:32 PM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nWhy not use Element.implement, like any other method...\njs\n(function(fireEvent){\n   Element.implement('_fireEvent', function(type, event){\n       fireEvent.call(this, type, event);\n   });\n})(Element.prototype.fireEvent);\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2163#issuecomment-3405632\n. Alright folks.\n\nFollow these instructions if you'd like to try this fix:\n``` sh\ngit clone git://github.com/ibolmo/mootools-core.git ibolmo/mootools-core\ncd ibolmo/mootools-core\ngit fetch origin\ngit checkout fix-2163-regression-ie7-crash\ngit submodule update --init --recursive\n./build > mootools-1.4.3.js\n```\nPlease update your test pages @jbgithub @kguelzau @incendium @dmethvin @isfalse \n. TY @jbgithub anyone else?\n. Yey. Thanks everyone for your reports and support. Stay tuned for 1.4.3.\nOn Mon, Jan 9, 2012 at 10:08 AM, Matthew Gast <\nreply@reply.github.com\n\nwrote:\nLooks like it's working on my end. Tried it using both test cases that\nwere failing for me and they both work now. Awesome job!\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2163#issuecomment-3413834\n. @SunboX did you try: https://github.com/mootools/mootools-core/issues/2163#issuecomment-3407851\n. Sure. It was a bug introduced in 1.4.2. If you get the chance, have a go at\nmaster (soon to be 1.4.3).\n\nOn Wed, Jan 11, 2012 at 1:02 PM, Andr\u00e9 Fiedler <\nreply@reply.github.com\n\nwrote:\nNo, I didn\u00b4t try it. Had to fix it quickly and haven\u00b4t access to our\nclients machines now. :/ Can\u00b4t reproduce this bug on my development\nmachine. But it works now, with 1.4.1.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2163#issuecomment-3451651\n. Nice find. I'll spec this and get this committed 1.4.3 due out in less than\na week.\n\nOn Fri, Dec 9, 2011 at 10:55 AM, rhuynh <\nreply@reply.github.com\n\nwrote:\nIn mootools 1.4.2., you can no longer set a form field's value to 0, eg,\nmyTextBox.set('value', 0).  It always result in an empty string.  This used\nto work in mootools 1.2.5.\nI believe the error is in the property setter for 'value'.  Instead of:\nObject.append(propertySetters, {\n       'class': function(node, value){\n               ('className' in node) ? node.className = (value || '') :\nnode.setAttribute('class', value);\n       },\n  ....\n       'value': function(node, value){\n               node.value = value || '';\n       }\n});\nit should be:\nObject.append(propertySetters, {\n       'class': function(node, value){\n               ('className' in node) ? node.className = (value || '') :\nnode.setAttribute('class', value);\n       },\n  ....\n       'value': function(node, value){\n               node.value = [value, ''].pick();\n       }\n});\nTested On: Firefox, Safari, and IE9\njsFiddler:\nhttp://jsfiddle.net/uYWgf/2/\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2164\n. Fixes #2127.\n. Fixes #2109.\n. Thanks! Done :D\n\nOn Sat, Jan 7, 2012 at 6:56 PM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\n:+1: i can push this any time you want ;)\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2167#issuecomment-3399489\n. Fixes #2129.\n. Opting for doc. \n. I'll try to include this in 1.4.3, otherwise will be included in 1.4.4 (two week sprint) or 1.5 (depends on feature set)\n. Fixes #2159.\n. Fixes #2169\n. TY\n\nOn Mon, Dec 19, 2011 at 11:52 AM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\n:+1:\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2177#issuecomment-3206702\n. Not sure if we'd ever check for == [] after we destroy. Also, there's already a discrepancy between Array and Elements, and some problems with Element methods. Not sure if we should also add destroy as a special case. At least, I don't see it too beneficial.\n. Unfortunately 1.2 is no longer supported (over a year old), but we encourage you to try 1.4 with compatibility layer. The compatibility layer is backwards compatible up to 1.2. All 1.2 code should (theoretically :D) work with 1.2 if you have the compat layer enabled in the build process: http://mootools.net/core.\n. Thanks. I can reproduce it on a Mac keyboard US. What's your setup?\n1. Keyboard Layout: US, EU\n2. OS?\n. Perhaps a documentation update?\n\nOn Sat, Jan 7, 2012 at 8:00 PM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nWhat Sebastian said.\nkeypress events should pass a charCode value, which is a char that can\nbe transformed with String.fromCharCode to a string representation.\nAlso see http://www.quirksmode.org/js/keys.html\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2183#issuecomment-3399759\n. Fixed: https://github.com/mootools/mootools-core/commit/bf1d54cc4309de9edbc47353b5d9e70da7ab0b0a\n. please send us a fiddle or code that crashes ie9. well use them as\npart of the specs\n. Looks like this fix would be too narrow, I believe the solution is to lookup the specific methods and properties that you're interested in and for those properties wrap 'em in try statements.\n\nSomething like:\n``` js\nvar dangerousBools = ['autoplay', ...];\nArray.forEach(dangerousBools, function(bool){\n    var lower = bool.toLowerCase();\n    booleans[lower] = bool;\n    propertySetters[lower] = function(node, value){\n        try {\n            node[bool] = !!value;\n        } catch(e){}\n    };\n    propertyGetters[lower] = function(node){\n        try {\n            return !!node[bool];\n        } catch(e){\n            return false;\n        }\n    };\n});\n```\nYou'll still be responsible for being careful with your own methods, though. You're right that any access to methods or properties will throw an exception. That means that canPlayType will still throw the exception.\nFor now, could you help us with a little research on the properties you'd like for us to watch out for?\n. :+1: I'll manually update the check.\n. Also, did you check if IE9 behaved incorrectly? <IE> is too broad\n. :+1: then\nOn Sat, Jan 7, 2012 at 8:04 PM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nThe first test failed in ltIE9 too, wich was fixed by this fix. The second\ntest only failed in IE9 iirc.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2188#issuecomment-3399779\n. Cool. I just had a thought: \"we should add documentation note\". :D Under.. Element.set?\n. Without additional information (code) it's hard to discern who's at fault. Perhaps a simple jsFiddle is needed. \n\nAlso, you may want to try loading Sencha Touch first then MooTools.\n@subtleGradient are you familiar with this problem?\n. @chrispitt agreed. @liviathan if you get around to providing a jsfiddle of the problem, we can investigate further. for now it'll be moved to 2.0.\n. Closing for lack of progress.\n. We've talked about it before, but we haven't come up with many reasons to do this. Moreover, it's a matter of protection as well since the storage is deleted on garbage collection. If there are additional references to the storage object, then that's a memory leak in IE < 9\n. Not necessarily, when you destroy an element you also destroy its storage.\nOn Sun, Jan 8, 2012 at 5:11 AM, Andr\u00e9 Cruz <\nreply@reply.github.com\n\nwrote:\nI'm using mootools as the base library for a single page app, on top of a\nprivate MVCS framework.\nCorrect me if i'm wrong, but the garbage collection is only made on page\nunload right?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2193#issuecomment-3401520\n. Frankly, it's a few lines. I'm of the opinion (and favor) of everything being public. \n\nIf it's comforting, in 2.0 this point is moot since the Element can be subclassed and you can modify storage to your heart's content. (At least in theory, hehe.)\n. @cpojer @arian \nWhat do you guys think? A getter and setter method for storage? This way users/devs can add cloneStorage without modifying Moo.\n. Not necessarily. You could try using getComputedStyle, however.\n. I wouldn't mind it if there were helpers for the unit conversion that'd be\ninteresting. Expecting, however, that getStyle would return px values all\nthe time.. I'm not in favor.\nI am in favor, though, of a cross-browser return of the same value. Say I\ndefined the property as 3pt then I expect getStyle to return 3pt across\nall browsers. Is this the problem you're seeing?\nOn Mon, Jan 30, 2012 at 4:07 AM, pr3fect <\nreply@reply.github.com\n\nwrote:\nGood example @MrPrime but would you always want a \"px\" suffix on the\nreturned value? That could make further calculations a bit bloated as you\nalways need to run it through parseInt to get an integer value.\nFor example think of that you want to sum up margin-top and margin-bottom:\njavascript\n$('demo').css('margin-top') + $('demo').css('margin-bottom') // '13px0px'\nparseInt($('demo').css('margin-top'), 10) +\nparseInt($('demo').css('margin-bottom'), 10) // 13\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2196#issuecomment-3717099\n. Ok I'll reopen under the assumption that we'll have to add test coverage verify that oldIE is returning odd values.\n. Right this is by design. If you'd like to see 'example' you can use the second argument the custom type:\n\n``` js\nElement.Events.example = {base: 'keyup'};\n$('el').addEvent('example', function(event, type){\n// event.type == 'keyup'\n  // type == 'example'\n});\n```\nThis is used in delegation, I believe.\n. No, you don't have to live with it, but we could definitely use your help\nin creating a spec/coverage for this.\nDo you have a jsfiddle that causes the exception?\nP.S. It'd be cool if you shared (blog, etc.) how you're doing the remote\nerror logging. Perhaps a guest post on mootools.net.\nOn Tue, Jan 17, 2012 at 9:44 AM, RiZKiT <\nreply@reply.github.com\n\nwrote:\nWe are remotly logging javascript errors. One error which appears more\noften is:\n\nUncaught TypeError: Property 'scrollTo' of object [object DOMWindow] is\nnot a function\n\nand in the following code:\njavascript\nscrollTo: function(x, y){\n if (isBody(this)){\n   this.getWindow().scrollTo(x, y);\n } else {\n   this.scrollLeft = x;\n   this.scrollTop = y;\n }\n return this;\n},\nAfter investigating the problem I found out it is a result of a popup\nblocker for Chrome, which seems to overwrite scrollTo().\nDo you have any clever solution how to prevent that error, for example by\nchecking in core if typeof window.scrollTo() == \"function\", or set\nscrollTo() = function(){} when not defined? Or something else. Best\nsolution would be to check it only once, maybe at Window.implement?\nI can prevent the error from logging, but the error still occurs at the\nuser. Chrome cannot be ignored any more and popup blocker aren't that\nunusual these days. So I hope you don't say \"You have to live with it.\".\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2202\n. Thanks. I'll give this a go, when we come around to it. Thanks for the\nreference.\n\nOn Tue, Jan 17, 2012 at 11:10 AM, RiZKiT <\nreply@reply.github.com\n\nwrote:\nExecute the following in Google Chrome, with a popup blocker enabled /\ndisabled and watch the script console:\nhttp://jsfiddle.net/YgYL5/\nI used the first blocker in the chrome app store that i've found, named\n\"Better Pop Up Blocker\". I don't know which popup blocker our users have\ninstalled regularely, but that one seems to be quite common.\nI'm a bit lazy to write whole articles, but I already mentioned my\nsolution in a Google+ thread  with other JavaScript debugging tips here:\nhttps://plus.google.com/104431949275766772757/posts/N1qwzwuAZd1\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2202#issuecomment-3531406\n. doh! guess we'll get this fixed for 1.4.4, haha.\n. Rather let cancel means stop and reset, and for pause to be .. well pause. \n\nBtw, http://silkandspinach.net/2004/07/15/avoid-boolean-parameters/\n. IE6-7 some properties are readonly, such as width. Closing.\n. Could be. Just noticed the links are dead. When we get around to it, we\nshould decide to close or to investigate.\nOn Thu, Jan 19, 2012 at 6:09 AM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nI believe it's very difficult/impossible to access that stuff cross-domain.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2209#issuecomment-3561759\n. Did a quick search why Fx.CSS prevents the use of external stylesheets and it looks to be a fix for a previous bug:\n\nhttps://github.com/mootools/mootools-core/commit/20d4c46b2c8973bc349795efa2963d255c2413b0\nClosing as wontfix.\n. Yeah the Fx.CSS.Parser.Color is lacking parsing of rgba values. Moving this to 1.5 for considerations.\nWe could use Color.js (currently at More) to manage (parsing and encoding) of the color. That should support hsl, hsb, rgb, rgba etc.\n. Closing due to lack of update/interest.\n. Closing since low priority (IE6)\n. Take a note of: http://mootools.net/docs/core/Fx/Fx.Morph. It's known that you cannot use complex selectors\n. Yep, I saw the history and I want to revive it.\nI think that I'm with scott to run the mutators first.\nOn Thu, Jan 19, 2012 at 5:57 AM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nIt was marked as wontfix:\nhttps://mootools.lighthouseapp.com/projects/2706/tickets/642#ticket-642-10\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2216#issuecomment-3561609\n. If someone writes the PR and specs, it'll help us consider adding it. \n. See also: https://mootools.lighthouseapp.com/projects/2706/tickets/1226-response-cant-leave-script-tags-in-place\nHello,\nI tried to use Request for some ajax content insertion (Request.HTML did no better). When the answer contained a javascript captcha it was removed when I inserted the html (via innerHTML = ...).\nI had the choice between evalRequest and evalScripts to change this behaviour. evalRequest did what I want in Firefox and Safari:\nIt left the script tags in place so that I could do some magic to get them working again (innerHtml assignments don't really work with scripts).\nHowever - this evaluated the whole response which failed in Chrome because the response did contain html and not javascript. What I really wanted was something like evalScripts=false which leaves the script tags in place.\n\njavascript\nRequest.implement({\n    processScripts: function(text){\n        return text;\n    }\n});\n\nDid the trick for me but I think there should be another flag or something.\nBye,\n- CH\n. right, we need to verify the issue\n. Closing due to pending deprecation of really oldIE \n. @fabiomcosta do you remember how to reproduce the random crashes with toElement() ?\n. @arian is this something with should bother with? or let the devs deal with the exception handling. I'm leaning on the latter. \n. I agree with Tim's options. Here are my comments though on each (reference in order):\n- this will not be performant. Especially on mousemove. We can be specific to different type of events but we wouldn't be changing the paradigm. \n- We can accomplish a non-bc by wrapping new set time out (async) with compat block. Therefore this would be a 1.6.0 pr\n- I'd be OK with this as well. I've personally dealt with such cases in a per case basis. We could document the practice in the docs for 1.5.2\n\nIf docs on the best practice is enough let's do that for 1.5.2. If this is a huge burden on developers let's add async with compat block. I propose the former and keep an eye out for more requests. \n. Moved to MooTools More: https://github.com/mootools/mootools-more/issues/1099\n. Closing and moving to the PR.\n. Doesn't seem to be an issue anymore: http://jsfiddle.net/L7Tsc/1/\n. Moving to 1.5 since we can decide to throw an error during a dev environment or do as others and just ignore the call.\n. Confirmed. I'm guessing this is a Fx.CSS.Parser problem. Need to investigate further.\n. Yeah but the issue is narrowed to license docs. As long as the build process keeps the Core header then we are golden.\nIf someone builds, they should try to maintain the license as well.\nAnother option is to put the license information in the MooTools object like:\njs\nMooTools['license'] = 'MIT License';\nPlus any copyright information.\n. As @GCheung55 mentioned, you're still required to call callChain in order for the wait to execute. \n. I hope no one gets mad, but I've just merged it. Now to update the slick files locally.\n. Fixed: https://github.com/mootools/mootools-core/commit/a9c73cea2782eec366848328d303411d81769c6b\n. I believe the ticket said that Request was fine, but Request.HTML was leaking. I haven't verified the ticket, though.\n. Moved: https://github.com/mootools/mootools-more/issues/1097\n. (from a comment)\nAdditionally, elements within a div using CSS3 multi columns are also affected.\n. http://jsfiddle.net/q63535z8/1/\n. https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L629-632\nI believe that IE is considering any non-normative attribute (data-*) as an\nexpando. Those lines were added to prevent custom methods from being\nreturned. Looks like my spec coverage was too simple.\nFor now you can workaround this with:\njavascript\nElement.Properties['data-role'] = {get: function(){\n  return this.getAttribute('data-role');\n}};\n(I know) Not a great solution, since you'll need to repeat the above for\neach custom property that you've set. But it's temporary for 1.4.4.\nOn Mon, Jan 23, 2012 at 11:54 AM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nYou're right, also see http://jsfiddle.net/nbQEk/1/embedded/result/\n@ibolmo any ideas what has changed there that could've caused this?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2247#issuecomment-3618392\n. I'm going to get around to this one first thing tomorrow morning. I believe that adding a attr.specified check will alleviate the problem, but need to (thoroughly) test now.\n. Committed: https://github.com/mootools/mootools-core/commit/a9c73cea2782eec366848328d303411d81769c6b\n. Let's hold off on this. Let's rebase after we refactor .send see #2228\n. Fixes #2247.\n\n@arian this seems to be performant. At least a single hit, then cached for any further lookups. \n. @arian have another go pls :D\n. That's a great idea @arian and I'll add a github issue for enhancing the MooTools API for 1.5.\nI tried to augment the Slick.hasAttribute but there's a couple of problems. \n1. Slick doesn't need this fix. It's very -- very -- unlikely that anyone would check attribute with value of a function (the original problem). \n2. We don't use setProperty or removeProperty from Slick. Therefore it's very hard to whitelist dynamic properties.\nSo my initial idea of adding this code to Slick is out of the question. I think we'll have to wait for 1.5 to use a cleaner hasAttribute lookup and then return the property if we should\n. @arian when you're ready give me the :+1: or :-1:\n. @satazor we just merged this in master. If you have time, please investigate the 400ms gap (since 150ms or more is noticeable in the human eye).\nAlso please provide/advice us with the tests that you used.\n. :+1: looks good. thanks for the contribution, keep 'em coming :D\n. Well.. your isSuccess is being called and the success method of Request.JSON is being called. So I think the 204 related arguments are working as expected.\nWhether the success method should treat null as an error I think the behavior is as expected. Keep in mind Request.JSON is used to request: JSON hehe. Returning null in any kind of API is a bad API. Most RESTful APIs return an object with:\njavascript\n{},\n// or\n{\n \"data\": {},\n},\n// or\n{\n  \"error\": '...',\n  \"code\": 400\n}\n. :+1:\n. @arian @seanmonstar yep Element.get and Element.set do a good job.. I guess it's just a small enhancement:\n``` js\n$('id').set('data-role', 'value');\n$('id').get('data-role');\n$('id').set('data-' + prop, 'value');\n$('id').get('data-' + prop, 'value');\n// vs\n$('id').setData('role', 'value');\n$('id').getData('role');\n$('id').setData(prop, 'value');\n$('id').getData(prop);\n$('id').getData() // not possible atm\n``\n. Yeah JavaScript engines have never done a great job for helping the developer, but that's the derivative of having a runtime language. Worst that JS is so easy to manipulate e.g. (undefined =`).\nYour suggestion is valid, but not solvable in the near future. Perhaps in 1.5 or 1.6. I'll slate this for 1.5 and we can move it to 1.6. The solution is to use:\njavascript\nif (has('dev')) throw new Error('Cannot extend child class with an undefined parent class.');\nThis requires has support, which #2258 addresses (copied from Milk issues repo).\n. ``` javascript\nvar method = function(child, parent){\n  if (has('dev') && (parent == null)) throw new Exception('Cannot extend if\n parent class does not exist.');\n  // ...\n};\nmethod(new Class(), this['doh']);\n```\nget it yet?\n. I see @cpojer's and @timwienk's point. In the Extends: Case the JS parser will throw exception for RefereceErrors. \nMy example (updated) is about initializing options or arguments with undefined variables that are required for initialization of the class. \nI'm closing the issue. :D\n. ++\nExactly. Looking forward to has.js support in Core.\nOn Wed, Jan 25, 2012 at 12:11 PM, Sean McArthur <\nreply@reply.github.com\n\nwrote:\nTrue, in his example, it would throw a reference error, but here's an\nexample that wouldn't:\n``` js\nNamespace.B = new Class({\nExtends: Namespace.A\n});\n```\nAnd MooTools does this a lot (Fx, Drag, Request, etc).\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2257#issuecomment-3655680\n. I'm all for throwing errors in production, but I think the rest of the team\nmight disapprove.\n\nPerhaps in the cases you'd like this handled, we could implement a Logger\nthat could do remote notifications.\nOn Wed, Jan 25, 2012 at 12:19 PM, Sean McArthur <\nreply@reply.github.com\n\nwrote:\nForget has. Why should it only throw a decent error in development, and\nthrow an obscure error in production?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2257#issuecomment-3655843\n. This is an unintended consequence, but this is actually quite normal. \n\nAt the moment, however, 1.4.3 has a bug (#2247) caused by fix #2109. Closing for now, since this behavior is normal but circumvented with #2109 and #2247.\nJust be sure to use Element.get and Element.set, instead of el.attr = 'custom';\n. What do you mean by \"inspect\"? I'm using DebugBar and I'm not seeing extra\nattributes on the element.\nOn Thu, Jan 26, 2012 at 9:27 AM, Qballinternet <\nreply@reply.github.com\n\nwrote:\nSo it is normal that the body tag got the complete mootools source code in\nan $family attribute? and it seems that this is the issue with every\nelement on the page.\nI got such a weird problem on the project i am currently working on. It\nseems that an entire table refuses to paint/render itself on the page. No\nerrors though. I can set all the styles i want on the inserted table but\nnoting works. When i inspect with ie9 in ie7 modus the table is there, the\nstyles are set, but it does not render to the screen.\nthe reason i think it got something to do with this attribute thing is\nbecause i cant find any other weird things happen on the page.\nAnd something tells me that having the complete mootools source code put\nas an attribute on every element on the page does not make a page render\nbetter.\nany help would be greatly appreciated.\nIf this does not belong here; i just filed a request for joining the\ngoogle group, and am currently waiting for acceptance.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2259#issuecomment-3670532\n. Moving this to 1.5, and if necessary we'll move this to 1.6. This is dependent on #2133 getting done.\n. This (partially) fixes #2257, btw.\n. I've never been for failing silently in production, but 1.y.z has been released with that assumption. I think that without has.js we'd have to wait for 2.y.z to see MooTools throwing errors in live production.\n. http://jsfiddle.net/Qd7fb/20/\n\nOn Fri, Jan 27, 2012 at 3:29 AM, Miscellaneous <\nreply@reply.github.com\n\nwrote:\nhttp://jsfiddle.net/Qd7fb/17/\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2261\n. That's fine can you check that this works:\n\njs\nreturn (this.className && this.className.baseVal) || this.getAttribute('class');\nThis takes advantage of && properties. \nSee:\njs\nconsole.log((true && 1) || 'default');\nconsole.log((false && 1) || 'default');\nconsole.log((false && 0) || 'default');\nconsole.log((true && 0) || 'default');\n. Committed: https://github.com/mootools/mootools-core/commit/a9c73cea2782eec366848328d303411d81769c6b\n. Fixes #2175\n. I see your point, let me try to work on something for Element. The other problems are window and document.\n. Right, which is why I should not follow what Ajaxian said blankly and verify if we are :D haha. \n. Yep that should work. I'll try it out tonight\n. @arian any luck on this? \n. Ideas of? \n. Thank you. This is a known, and fixed issue in 1.4.4. We're releasing 1.4.4 early next week. For now you may regress to 1.4.2 or build from master. Oh, and use getAttribute as you've noted.\nSee #2247.\n. :+1:\n. Fixes #2236\n. Yes this has been fixed on master, and will go out today or tomorrow. Here's this for reference: https://github.com/mootools/mootools-core/issues/2247\n. Could you please provide us with the version of mootools and a jsfiddle (or\ncode) that reproduces the crash?\nOn Mon, Feb 6, 2012 at 10:46 PM, ilanle <\nreply@reply.github.com\n\nwrote:\nSCRIPT16389: Unspecified error.\nmootools-core.js, line 397 character 129\non this token:  var r=this.getBoundingClientRect(\nThis happens intermittently when dragging objects (script based on one of\nthe demos on this website).\nIt happens during drag (not on drop, not on enter, not on leave and not on\ncancel, but during the drag itself)\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2278\n. :+1:\n. Fixed: https://github.com/mootools/mootools-core/commit/e65e04b328ad8d6e70eb69eb7054ea8dfd68163a\n. @RiZKiT please give us a hand and test the master branch with your code. \n\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master\n. @jbgithub take a look at: #2301. That should solve your edge case. Please confirm.\n. It's a http://github.com/kamicane/packager comment block. You can strip them and the enclosed code out during the build.\n. Thanks @aaronmw, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2282.\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master\n. Thanks @karolis-k, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2282.\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master\n. @karolis-k you can use this one: http://mootools.net/nightly/build/mootools-core.js\n. Thanks @gimmel, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2282.\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master or use this nightly build: http://mootools.net/nightly/build/mootools-core.js\n. Thanks @mientjan, but this may be a known issue and recently resolved in the master branch. Please give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master or use this nightly build: http://mootools.net/nightly/build/mootools-core.js\n. Ok thank you, we'll take a look.\n. duplicate of #2297\n. nooo... bad\n. What'd Swiff ever do to you :(\n. I still think that MooTools Core should be the very low level implementation of things. It shouldn't be categorized by usage.\n. ```\nPlugins\n\nMore\nCore\nor\nPlugins\nUI | Futures | ART\nEssentials\n```\n. My definition of relevance is defined by association.\nI'm associating Core code as essential.. must have. If I ever need to work\nwith Flash I would/need to associate I would/should assume it's in Core..\nnot in More.\nOn Thu, Feb 16, 2012 at 3:37 PM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nBut it should by relevance.\nOn Thu, Feb 16, 2012 at 10:36 PM, Olmo Maldonado <\nreply@reply.github.com\n\nwrote:\nI still think that MooTools Core should be the very low level\nimplementation of things. It shouldn't be categorized by usage.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4009943\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4009973\n. I'd love Silverlight helper. Thanks for suggesting it. If anyone gets\naround to it we should have it.\n\nFYI:\nFile uploads, x-browser canvas or svg (see SVGWeb), Camera API...\nOn Thu, Feb 16, 2012 at 3:54 PM, Darren Waddell <\nreply@reply.github.com\n\nwrote:\n@arian YES! Also a Silverlight helper. Please make this a priority and\ninclude it in Core over other less useful features like event delegation or\nhardware accelerated animations.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4010330\n. What bytes are we saving?\n\nIf the issue is bytes, then the bigger issue is lack of\ninformation/education on how to build your own MooTools. A fundamental\nconcept since day one.\nOn Thu, Feb 16, 2012 at 4:02 PM, Rouven We\u00dfling <\nreply@reply.github.com\n\nwrote:\n:+1:\nLet's save some bytes. Those who actually use flash can get it from More.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4010489\n. Moving this to 2.0 milestone.\n\nAfter discussing the practicality of moving Swiff to More, we've realized we'd seriously break backwards compatibility with 1.x. \n1. Packaging, right now some users require Core/Swiff and we'd have an upgrade script to replace with More/Swiff. Other option is to create an empty file with requires More/Swiff but this would cause a cyclical dependency on Core. Talked with @arian and it's too risky that packagers will know the right thing to do.\n2. The download page would need to be reworked -- again for including More things in Core for people that need the BC.\nA lot of headache for short gain in 1.x. For 2.x, however, we can discuss and fudge the locations as much as we'd like.\n. Try master. 1.4.2-1.4.4 fixed some leaks.\nHere are the instructions on how to build mootools:\nhttps://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master\nor\nuse the nightly: http://mootools.net/nightly/build/mootools-core.js\nOn Fri, Feb 17, 2012 at 1:48 AM, BooYaKaSha <\nreply@reply.github.com\n\nwrote:\nUnless there's something wonky about my setup, there seems to be a pretty\nserious memory leak when I do anything with the 1.4.x branch in IE7.\nI'm running IE7 on XP SP3 with the latest patches in VirtualBox. The\nproblem occurs even when running in \"Safe Mode\".\nWhen I include an older version of the library, i.e.\n\nAnd create a new HTML file and simply put something like this in the body:\n\nnew Element('div');\n\nWhen I open IE7 and keep the task manager visible, I can refresh over and\nover again and nothing happens -- on my setup memory use hovers around\n35-36MB after several dozen refreshes.\nHowever when I replace the library with anything from the 1.4.x branch\n(I've tried all of them including the nightly build), i.e.\n\nWhen I do the same thing -- go the page in IE7 with task manager open --\nwith each refresh the memory usage climbs. It doesn't take long before it\ntops 100MB. Eventually I need to kill IE via the task manager because it\nstops responding.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2300\n. Nightly is latest from master, but built at midnight (or so). If you're still seeing a leak, we'll have to investigate. \n. As much as I'd like to have this done prior to 1.5, I'd like for someone smarter than me to come up with a automated memory leak testing -- or someone brave to weather through this storm. \n. Closing due to inactivity. Send us a PR, if you have the chance. \n. The 0.05 diff will not be discernible? \n. If you pass a regexp, it'll use the regexp. If you pass a string it'll use the second argument to create the regexp: http://jsfiddle.net/vdp9D/2/\n\nworksforme.\n. hehe no worries. it could have been a real bug. you could try sending an email to the mailing list if you're unsure of, though:  https://groups.google.com/forum/?fromgroups#!forum/mootools\n. Thanks @Xirt, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2282.\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master or use this nightly build: http://mootools.net/nightly/build/mootools-core.js\n. Thanks @bootle, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2282.\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master or use this nightly build: http://mootools.net/nightly/build/mootools-core.js\n. Thanks @rsouthgate, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2282.\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master or use this nightly build: http://mootools.net/nightly/build/mootools-core.js\n. Thanks @Draghmar, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2282.\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master or use this nightly build: http://mootools.net/nightly/build/mootools-core.js\n. Thanks @laohan, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2286.\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master or use this nightly build: http://mootools.net/nightly/build/mootools-core.js\n. from your example you're not removing the original element. therefore\nyou're finding the original element. pls fix\nOn Thu, Feb 23, 2012 at 3:52 AM, karolis-k <\nreply@reply.github.com\n\nwrote:\nI clone element without keeping id, but it still can be found with\nselector using id in IE6 and IE7.\nPlease find an example here:\nhttp://jsfiddle.net/rmgVM/\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2310\n. Thanks, will take a look\n\nOn Thu, Feb 23, 2012 at 8:29 AM, karolis-k <\nreply@reply.github.com\n\nwrote:\nin IE6/7 it was capturing original element AND the clone (alert = '2').\nBut I updated it as you wish now and alert is '0' vs '1' in normal browser\nvs IE6/7\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2310#issuecomment-4137187\n. Moving discussion to the PR.\n. Thanks @matthiasstock, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2282.\n\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master or use this nightly build: http://mootools.net/nightly/build/mootools-core.js\n. Just tested. Looks good! Thank you @arian \n. @fakedarren did you intend to move it?\n. Well I think that 'auto' should transform/normalize to a pixel value. Which API to use getStyle vs getComputedStyle? No idea. \nMight be worthwhile to introduce a getCSS to return the value in the stylesheet (or getStyleSheet)\n... \nor getStyleCSS\n. this.attributes also includes expando attributes such as this.inject. oldIE sucks :(\nBesides it's a one time hit\n. Need to check IE6, but I'm fairly certain that was the case. Otherwise, seems like a cleaner solution the way you propose.\n. The only special case is map right?\nmap: possible to return non-elements\nslice: all elements\nsplice: all elements\nclone: all elements\nflatten: all elements\nThen we can reduce the problem to:\n``` js\n['slice', 'splice', 'clone', 'flatten'].forEach(function(method){\n    var fn = Array.prototype[method];\n    Elements.implement(method, function(){\n        return new Elements(fn.apply(this, arguments));\n    });\n});\nElements.implement('map', function(fn, bind){\n    var result = Array.map(this, fn, bind);\n    return result.every(Type.isElement)) ? new Elements(result) : result;\n});\n```\nAnd add a note in Element.md about map.\n. Agreed, but then it'd be another special case to override after map.\n. @kentaromiura when you get the chance. can you rebase your commit, and I can review this again\n. @kentaromiura it's been a while, but could you rebase this. I'd also be interested in the Spec. I wonder how we could incorporate memory usage (leak) with our test processes. \n. pinging @csuwildcat once more\n. Assuming fixed. Reopen if still an issue.\n. Can you add a short description of the ie fix inlined in the code.\nAlso add space after if, and add an if statement instead of &&.\nI would have preferred as well if this was bug detected (like feature\ndetected ) instead of client sniffing.\nOn Jul 30, 2012 2:04 PM, \"Cristian Carlesso\" \nreply@reply.github.com\nwrote:\n\nIE7 clone node\n(http://msdn.microsoft.com/en-us/library/ie/ms536365(v=vs.85).aspx)\nhave problem when cloning element with id attribute stetted.\nYou can merge this Pull Request by running:\ngit pull https://github.com/kentaromiura/mootools-core bug-2310\nOr you can view, comment on it, or merge it online at:\nhttps://github.com/mootools/mootools-core/pull/2387\n-- Commit Summary --\n- fix bug #2310\n-- File Changes --\nM Source/Element/Element.js (9)\n-- Patch Links --\nhttps://github.com/mootools/mootools-core/pull/2387.patch\n  https://github.com/mootools/mootools-core/pull/2387.diff\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2387\n. Fixed?\n. Is this still an issue? Can you give us the specs on the Windows Phone?\n. Actually closing this since it's been merged.\n. Could you help us and run the latest specs against windows phone?\n. @brianedgerton once again, can you help us run the latest specs against your windows phone? \n. Thanks. I'm giving a week deadline on this and closing if ages further. Don't have WP access either. \n. Sorry I just thought of a little UX problem:\n\njs\nvar request = new Request({ url: '#' });\nrequest.getURL(); // null <-- oops!\n. Was there a failing spec? If not, we should have one that failed prior to the fix.\n. Right, and just try to run the specs against most browsers. I'm sure the rest of the team can cover any missing browsers before release.\nThanks @gonchuki .\n. It's always good. We might catch other typos in the process.\n. Great work. I'll review carefully soon, but with a quick look I'm concerned with getStyle it's starting to become a monster. \nI'd like for us invest some time to figure out a better (mutation? e.g. hooks) pattern for us to use.\n. Agreed on the comprehensive specs. A must have. I'll check the above when I can.\n. I got confused with https://github.com/mootools/mootools-core/pull/2409#issuecomment-7830010.\nAre the specs passing? What was your question? :D\n. If everything is green, then we can merge. @arian do you concur ;D\n. Done! Thanks @gonchuki and @arian \n. You should use CORS or use document.domain = 'www.' + document.domain to normalize the domains. \nSee the following: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Same_origin_policy_for_JavaScript\nBest practice, however, is to have CORS or to stick to one domain. \n. Well if the work has been done than go ahead.\nOn Sunday, July 6, 2014, Arian Stolwijk notifications@github.com wrote:\n\nClosed #2413 https://github.com/mootools/mootools-core/issues/2413.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2413#event-138550460.\n. Oh and this is definitely untested.. :D ala 1.0.x style (a \"kami commit\")\n. The reason I unrolled the https://github.com/mootools/mootoolscore/blob/cb327bf3/Source/Element/Element.Style.js#L216-232 is simply that it wasn't easy to read. \n\nMy logic is that we're no longer in 2000 when JS compilers were non-existant and that most people didn't bother to gzip .. CDNs are prolific now. \nLastly, I'm not done with Element.ShortStyle and Element.Styles. I think there's a lot of room to explore. To explore, I thought let's see all properties unrolled. \nI have some ideas with increased effort:\n1. Instead of defaulting to '@' we could default to '@px' in line: https://github.com/mootools/mootools-core/pull/2414/files#L0R86. That'll save a lot of bytes. I'm not sure, however, of the consequences. Need more test coverage.\n2. I was thinking we could do a BoxModel class that we can use to say contain this stuff. Especially rules about accepted input and marginTop-like (, borderTopWidth...) definitions that would be implicit to the model. Again, this is very vapor but I thought it might be interesting to see if it'll simplify development.\n3. Finally, if we decide that we don't need developers to understand the code we can save a lot of bytes by having a script that scrapes the w3 css definition and comes up with a literally mapping of the accepted input and the expected output. Notice that sometimes we map some outputs to px or convert rgba to rgb. That's really bad. or how we round floats ow.\n. Closing due to no longer relevant. If at any point we'll refactor this, we'll do so then.\n. Right, but this issue is what was brought up in: https://github.com/mootools/mootools-core/issues/2337#issuecomment-7941466\nTo reiterate.. should getStyle return the css definition? \nHere's a thought:\n``` js\nvar CSSStyle = function(element, value){\n  this.element = element;\n  this.value = value;\n};\nCSSStyle.prototype.toString = CSSStyle.prototype.valueOf = function(){\n  return this.value;\n};\nCSSStyle.prototype.toInt = function(){\n  // if not in px form, then some how compute the value\n};\n```\nTrying to keep compat with this toValue and toString magic, but I'm sure it's not 100%.\n. Moving to the PR.\n. See #2477\n. Closing this so we can discuss in the PR.\n. The owner should never do for in for an array. \n. Right, what I had meant to say is that the code is too brittle. At some point you should check for NaN and ensure it's not added to the dictionary. Regardless, it's not MooTools problem. You should only use for in with Objects.\n. Are you using sub pixels when setting the left and top?\n. Update the PR to use String.toFloat instead. \n. This is going to be on hold, until we get a spec to check for this. You're welcome to add one yourself, or wait about a week to get a hold of the pending PR that reduces the complexity to test MooTools.\n. Moving to the PR.\n. Closing since it's duplicated to #2551\n. No recall, no merge. Provide a jsfiddle that shows this is a problem.\n. Related #2236, #2531 \n. Sorry, but this is becoming less of a problem IE9+ and likely we'll never refactor Storage until 2.0. So.. not any time soon. If it's really important, I invite you to go ahead and make a PR and we can review your changes. \n. Without any code you're grasping at straws.\n. If you can find the 'hacked' version, I'm curious to see what it is.\nOn Thu, Feb 14, 2013 at 2:34 PM, swhiteman notifications@github.com wrote:\n\nThen the infection (if there was one) was either in the YooMotion template\nitself or in the version of MooTools they were distributing with the\ntemplate. Because Moo's license allows it to be freely distributed, authors\ntend to include a copy their whatever template/library instead of telling\nyou to download it yourself. Just like you can create your own fork on\nGitHub called \"MooBetter\" that is totally malicious (until people figure it\nout).\nAnyway, nothing stops a hacked site from serving up a hacked version of\nMoo and/or hacked version of their template, and you won't be any the\nwiser. I always download from MooTools.net myself and delete links to any\nother versions in libraries I use, but this is unenforceable on a wide\nscale because it means templates aren't \"plug and play.\"\nI still would doubt that a person who pwned a site would attack the\nbundled MooTools library and not the template unless there was some reason\nthat the vulnerability only allowed them to upload new files or something.\nThough igetting a hacked Moo in the wild might mean a better payoff down\nthe line.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2472#issuecomment-13576960.\n. Closing due to inactivity.\n. I'm going to defer this for 1.6. This may resolve itself with #2503.\n. This is related to conflicting Array methods in the elements. Use $$(...slice(-1)).getElements...\n. 1. Should we allow the typeOf check for an array and help them by join('') I'd argue we should use toString.\n2. Should we check for stylesheet? Shouldn't the developer know what they're suppose to set. In that case, I'd expect to help them in set('text') case. ~~Is this a known issue for IE8 for set('text')?~~\n\nRe: 2. Should we ask them to use set('text') or set('html') I think the former. Regardless, we'll need a PR with the suggested fix after reviewing 1 and 2.\n. If we use set('text'), then we can enable a more complicated polyfill for\nthe future?\nOn Mon, Mar 3, 2014 at 9:31 PM, swhiteman notifications@github.com wrote:\n\nShould we ask them to use set('text') or set('html') I think the former\nEither should be acceptable. Remember the W3C says STYLE elements may\nhave child elementshttp://www.w3.org/html/wg/drafts/html/master/document-metadata.html#the-style-element,\nleaving room for an XML-based styling language (imagine putting XSL inside\nSTYLE). Plus, even with text/css you can legitimately have multiple text\nand comment nodes inside STYLE -- it doesn't have to be \"flat.\" IMO, if the\n'html' happens to be flat, it should definitely work, and even if it,\ndeliberately or accidentally, has tags, 'html' should still work.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2479#issuecomment-36588852\n.\n. Yep. Update, add the docs, add the specs. and We'll ship it soon \u2122\n\nOn Mon, Mar 3, 2014 at 9:45 PM, swhiteman notifications@github.com wrote:\n\nYeah, I guess that'll do. More now, the better!\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2479#issuecomment-36589470\n.\n. MT means free as in beer. Although we do our best to provide the best code,\nand experience. Your mileage will aways vary.\n\nOn Tue, Mar 19, 2013 at 11:23 PM, Boris Cherny notifications@github.comwrote:\n\n@fakedarren https://github.com/fakedarren thanks for the quick\nresponse! If you're not maintaining the code anymore, maybe move it to a\n\"legacy\" module, or add a message to the build page that it's no longer\nbeing patched? When I use something like MT, my expectation is that it's\nbulletproof; if not, it would be nice to have some sort of indicator as a\ncourtesy :)\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2480#issuecomment-15157729\n.\n. If you provide a PR with the addition, we can review the changes. Closing for now due to inactivity. \n. After reading https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest#open()\n\nLooks like we should deprecate the if (this.options.user and just have a withCredentials option. Could you modify your PR so that it reads:\n``` js\n if ((/<1.4compat>/this.options.user || /1.4compat/this.options.withCredentials) && 'withCredentials' in xhr) xhr.withCredentials = true;\n```\nWe'll also need a spec to ensure that:\n1. withCredentials is set for 1.4 compliance for this.options.user usage\n2. withCredentials is not set for 1.5 for this.options.user usage\n3. withCredentials is set for this.options.withCredentials is true\n. Awesome. Just waiting on Travis CI, but afterwards will merge.\n. Ahh, and just nit picking but could you add a note in the Request.md documentation?\n. I'd like to say that if we could we would support 1.2.x, but we we're not in that capacity at the moment. I hope that you would use the compat layer, changes, and other blog posts to move your code to at least 1.3.x. \n. May this shine some light in the situation.\n. Yes filter with hasOwnProperty\n. Browser feature detection has been deprecated\n. We should use Syn.js to simulate the typing, and make sure we're getting out the right values. This would minimize future changes like this. \n. Just missing the spec based on http://jsfiddle.net/2zsNV/5/\n. I'm trying to conceive of another addEvent('...') that fires immediately if the condition has already occurred. E.g. 'click'. Since it never happen, I'd have to agree that the onus is on the developer to understand their environment. If their environment implies that the DOM would already be ready, then the check should be against document.readyState else fall back to window.addEvent('domready', ...). And this is outside the scope of Core. Closing for now, but if you have a better case for it we can revisit.\n. Why not just clear the headers prior to sending? \n. We should default to using getBoundingClientRect\nOn Tue, Mar 4, 2014 at 2:39 AM, Aicke Schulz notifications@github.comwrote:\n\nHow about that solution? http://jsfiddle.net/RiZKiT/NAa92/\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2506#issuecomment-36602564\n.\n. The example you provided is contrived. ... I don't understand the application of what you're adding. \n. Hey folks. Any updates on this?\n. If you could supply a jsfiddle, it'll help us create a test case to check against.\n. If the object is enumerable, shouldn't that be the expected behavior? Array.from(Enumerable) == Enumerable Similar to Array.from(arguments) == arguments\n. I've never liked the casting to array for arguments. I just noticed this is for mootools-core. I would hope for 2.0 we wouldn't allow this kind of behavior. (ping @arian)\n\nIn this case, I'd have to side with you just because 1.x we liked to do as you described. \nHowever, in the future we should ask that arguments be defined in array format. Which would also reduce an unnecessary function call.\nIn other words:\n``` js\n// now\nelement.fireEvent('click', fuzzyVariableWhichMayMeanArgumentOrArrayOfArguments);\n// to a cleaner interface:\nelement.fireEvent('click', [obviouslyThisIsTheFirstArgument]);\n``\n. Double negative! :dancers: \n. Let's assume fireEvent should be passed an array. Onus of the dev.\n. Could you provide a jsfiddle showing the error? It's not very clear what is causing this.\n. Closing due to inactivity. \n. Usename=\"myfield\"instead ofname=\"myfield[]\"`\n. I'm a little confused on what you'd like for us to do. Could you do a PR on what you'd like the Docs to read as?\n. No, thank you ;)\nOn Wed, Mar 5, 2014 at 7:24 AM, JSchortz notifications@github.com wrote:\n\nThanks Olmo!\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2515#issuecomment-36741210\n.\n. Sorry but we don't play with others. I'm setting as willnotfix for now, but if you provide instructions on MicrosoftAjax we may consider helping in resolving this. \n. ~~FF 28 & 29? People still use those browsers? :)~~\n\nNevermind. Looking at:\nhttp://clicky.com/marketshare/global/web-browsers/firefox/\nFF 29 is still viable. For some reason I thought we were already in the 30s\nfor FFx.\nOn Wed, May 21, 2014 at 7:44 AM, Arian Stolwijk notifications@github.comwrote:\n\nNo, you're right :)\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2517#issuecomment-43748961\n.\n. Though, it's concerning that this PR is green via Travis CI. \n. :)\n\nOn Wed, May 21, 2014 at 8:18 AM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@ibolmo https://github.com/ibolmo Travis is green because there is no\nspecs checking for this, and Travis is only checking PRs with PhantomJS.\nAbout the specs missing, it wont be for long!\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2517#issuecomment-43752513\n.\n. Provide a JSFiddle showing this issue please.\n. Closing to move discussion to the PR.\n. Missing specs which check for fill support.\n. You'll add the specs here: https://github.com/mootools/mootools-core/blob/master/Specs/Element/Element.Style.js\n\nShould be much easier to contribute specs after the massive re-do to our testing platform. Let me know (us) if you still need some guidance.\nTY!\n. No you're falling back to the attributes: width and height. This is not using getBoundingClientRect.\n. Thank you for your fix, but could you provide a jsfiddle showing that the focus does not work. \n. Apparently there's this workaround: https://gist.github.com/nuxodin/9250e56a3ce6c0446efa\n. I'll keep it open, since we need spec coverage for this. We may expect to fail, but at least someone a lot of smarter than us could potentially figure out a solution. \n. I'd still like it spec'ed and documented.\nOn Sat, Feb 22, 2014 at 7:58 AM, Hristo Chakarov\nnotifications@github.comwrote:\n\nI'm not sure MooTools should provide a solution. It's a core browser\nissue. Technically speaking, for the browser a element is enumerable. It's\nan array-like object, just like NodeList, Arguments, etc.\nArray.prototype.push.call( $('select'), new Element('option', { text : 4\n}) ); // works like a charm - new element is injected to the\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2525#issuecomment-35803154\n.\n. setOptions clones objects to dereference them. Provide a jsFiddle showing a problem.\n. I'm closing this since there's no immediate plan to support this. If we do adopt moofx3, you'll automagically get this.\n. I disagree. I prefer API with semantics. getParent(2) means what? Get 2\nprevious parents? get parent with the 'tag' 2? what if your code had an\nerror, like:\n\njs\nelements.each(function(i, el){\n  root.getParent(i).doSomething();\n});\nIf we accepted the convention of using numerical to access number of\nprevious parents, we'd allow bad code to run.\nMoreover, just use getParent('#id') if you want a specific parent.\nOn Wed, Oct 2, 2013 at 7:13 AM, Tin LE GALL notifications@github.comwrote:\n\nMight be useful & faster, don't you think ?\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2530\n.\n. Closing since #2503 would fix this.\n. JSFiddle or it didn't happen.\n\nI'm not entirely sure what you're trying to do. One easier solution would be to require you to turn the Date into an integer, and back. For now I'm closing since the latter is easier, and your case is too specific.\n. Fixed in #2563 \n. Dup of #2210\n. This belongs in Slick :-\\\n. I'm closing this since timwienk is providing a shorter/cleaner version. You'll get credit, though, for starting the effort.\n. @arian if you'd update the PR to the latest master, this would prob. go in 1.5\n. I'm sure I'm just running by this too quick, but I totally don't know what you'd like to happen :). Could you provide me with a table or even better a couple of failing specs showing what to expect?\n. Lol so leave open or close?\n. Alright thanks folks.\nOn Mon, Mar 3, 2014 at 5:23 PM, Cristian Carlesso\nnotifications@github.comwrote:\n\n@ibolmo https://github.com/ibolmo despite the fact that the guy closed\nthe issue, I'll investigate it a bit further, not now though 'cause I'm\ngoing to sleep, keep it close for now, I'll reserve to re-open it later if\nit's a problem.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2544#issuecomment-36574027\n.\n. Haven't validated if this will be useful, but perhaps if you add examples to the docs, and specs to test for the new option it'll be clearer.\n. You're missing docs and specs for this addition.\n. Should be fixed now. Reopen if still an issue.\n. I'm moving this to 1.5.1 since we've never done something as kind as to go back to previous versions. I would like to start trickling down major fixes, however. \n. 1.5 it is. ;)\n. I apologize to @gonchuki for this great work. I believe going forward 1.2 is now implicitly deprecated/EOL. \n. This would break BC. I suppose the sensible option is to put secure on, and allow them to turn it off when they trust the source. You'll need to supply, though, an entry in the 1.4compat layer, and spec coverage that checks:\n- secure is the default option\n- secure is working (e.g. JSON.decode('alert(...)') returns null)\n- secure and setting it to false would still decode\n. 1.5base, and I don't know but just looking at the code we default for JSON.secure\n. Right I meant the following:\n\n| secure | JSON.secure | expected result |\n| --- | --- | --- |\n| null | -- | secure |\n| null | false | not secured |\n| null | true | secure |\n| false | -- | not secured |\n| false | false | not secured |\n| false | true | not secured |\n| true | -- | secured |\n| true | false | secured |\n| true | true | secured |\nBut since we'll add a JSON.secure = true;\n| secure | JSON.secure | expected result |\n| --- | --- | --- |\n| null | true | secure |\n| null | false | not secured |\n| null | true | secure |\n| false | true | not secured |\n| false | false | not secured |\n| false | true | not secured |\n| true | true | secured |\n| true | false | secured |\n| true | true | secured |\n. If you do if (secure == null) secure = JSON.secure; would be enough to\nmeet all requirements.\nOn Fri, Feb 21, 2014 at 4:18 PM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@ibolmo https://github.com/ibolmo the JSON.secure is a bit weird. It\nwas added in c04d545https://github.com/mootools/mootools-core/commit/c04d545939d4c1c1287a448d947a142ed05b7f80and I find no other reference to it in all Core & More files.\nIt is not documented in the docs either afaik.\nSo if we add JSON.secure = true; it has to be added to the docs and\ndevelopers wanting to use \"the eval way\" would have to make a double true.\nOn the function parameters and a JSON.secure = false;\nI'm ok with both adding it and leaving it out (i.e not adding JSON.secure\n= true;).\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2562#issuecomment-35779794\n.\n. 1. You would need to edit if (secure || JSON.secure){ to: if (secure){\n   and you're done.\n\nEven if it's undocumented, we've had people use undocumented interfaces and\nwhen we changed them they came back to us upset. It's small work to make\nsure that folks get consistency between minor versions.\nOn Sat, Feb 22, 2014 at 1:19 AM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@ibolmo https://github.com/ibolmo , thanks for your time checking this!\nI'm still not sure I follow you. I see 3 scenario:\n1- Adding both JSON.secure = true; and if (secure == null) secure =\nJSON.secure;\nThis means default behavior is secure. And to make it un-secure user has\nto use JSON.secure = false; which is not documented.\nIf user uses JSON.secode(string, false); as documented, that alone would\nturn to true anyway because of JSON.secure = true;.\n2- Adding just JSON.secure = true; (and keeping if (secure == null)\nsecure = true;)\nThis means default behavior is secure. But to override it and go un-secure\nuser needs to use double false:\nJSON.secode(string, false);\nJSON.secure = false;\n3- Using as it is now, in the PR. ( and the right one in my logic)\nThis means default behavior is secure. To override user would use, as\ndocumented already, just JSON.secode(string, false);\nJSON.secure seems to be kind of a backdoor/alternative, not documented.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2562#issuecomment-35796783\n.\n. Do a git rebase -i ibolmo/master\n\nOn Tue, Feb 25, 2014 at 1:42 AM, Sergio Crisostomo <notifications@github.com\n\nwrote:\nThis PR has to be refactored after Olmo's new Specs PR is merged.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2562#issuecomment-35982505\n.\n. Yeah you have the right idea.\n\nOn Tue, Feb 25, 2014 at 8:59 AM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@ibolmo https://github.com/ibolmo will do that.\nDo I still need the package.yml and Configuration.JS files?\nI see also a new directory structure without /1.5base/ so I suppose the\nmootools-packager script goes forEach directory inside the Specs and the compat\nlayerhttps://github.com/ibolmo/mootools-core/blob/master/Specs/Element/Element.js#L239-L243info goes inside under the respective specs\n.js file, with compat comment tags when needed.\nI run the specs adding my new JSON.js specs to the one on JSON.js specs\nfile from your repo and they worked good with grunt.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2562#issuecomment-36015625\n.\n. One little gotcha, but yep it's :+1: \n. FYI this is just the start. I'm doing a PR so that we can all start working on fixing the specs. \n. Slick related issues should go to: https://github.com/mootools/slick/issues\n. Rather than using English (because it's late). Here's what I'd expect:\n\n``` js\n//<1.4compat>\nBrowser.ie = true;\n//1.4compat\nBrowser.modernie = true;\n```\nCompat build:  Browser.ie is as you'd expect in 1.4, 1.3, and so on.\nNoncompat build: Browser.ie is null for IE11, but they can use modernie if\nthey wanted.\nOn Fri, Mar 7, 2014 at 1:49 AM, Tim Wienk notifications@github.com wrote:\n\nNo it doesn't, as we discussed yesterday, the IE fix was added the way it\ncurrently is (always using Browser.modernie for IE>10), because Browser\nSniffing is to be phased out / deprecated. Adding another layer of\ndifferent functionality would only make for more confusion.\nDocs need to be changed though. :-)\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2567#issuecomment-36974770\n.\n. - Option 4 (basically same of Option 2 without the need for modernie):\n  - For compat build (default build) Browser.ie is null. \n  - For noncompat build (for us ninja folks) Browser.ie is true.  (No need for Browser.modernie). \n. My reason for Option 4 is simple:\n\nFor 99.9% of the folks nothing will have changed with the compat build (the default build). For the 100% of the developers like me that want to know if my user is on an Internet Explorer browser all I want to do is:\njs\n if (Browser.ie) alert(\"I'm a Google Chrome fanboi, why don't you switch.\");\nInstead of:\njs\nif (Browser.ie || Browser.modernie) alert(\"... sucks that I have to try other flags :-\\\");\nIn other terms: our Browser.<name> API just says what browser we're on. Folks that are using it (even we're at fault at some point) for feature detection are using it for the wrong purposes.  Yes let's advocate for not using Browser.<name> for feature detection but let's not cripple our API for the rest of us that know what we're doing. \nAgain, for folks that are not up to date with the best practices and maintain their code can just use the compat version which Browser.ie returns null. No difference from 1.4.5 and 1.5. Now I'm just arguing that we don't need to add unnecessary flags or logic. Just fix Browser.ie as it should be, and put the responsibility of using the right code/practices to the developer -- as it should be. \n. > So the question is: do we have any legitimate reasons for why somebody  would want to put IE11 in the same bag as old IE?\nTo me it's about semantics and consistent API. If we welcome the idea of crippling our APIs we might as well start doing $('#this-kind-of-crap').\n\nIf not, then what's wrong about making it more difficult for fanboys and bad coders alike?\n\nAlso, I'd hate to think we are designing our code so that we avoid fanboys and bad coders. From day one MooTools has been for the power user. Yes we picked up a few bad coders, but they don't justify to bend to their (bad) will. \n. Here's an idea of a legitimate use case. Alex Russell has talked about caching feature detection by using user sniffing (http://infrequently.org/2011/01/cutting-the-interrogation-short/). If we cripple Browser.ie someone (in the future) would have to look for Browser.ie and Browser.modernie and to be future proof will likely check for:\n- Browser.modernchrome\n- Browser.modernfirefox\n- Browser.randomPrefixOpera\nAgain... consistency folks. \n. I have no idea wtf you just said. Then again I'm already in 2 wine bottles.\n-- ftw.\nOn Fri, Mar 7, 2014 at 11:49 PM, Aaron Newton notifications@github.comwrote:\n\nHistorically I've been Mr. No Breaking Changes and a strong advocate for\nnot changing our api with every release (I hate typeOf instead of $type -\nthat shit's arbitrary breakage). But in this case our main goal should be\nto avoid breaking bunches of stuff (so people don't upgrade because of a\n\"bad\" release) even if it means making an inconsistent API for the short\nterm. We're already agreed on deprecating all the browser stuff so\ninvesting in api consistency makes little sense. The only reason that\nBrowser.ie is being worked on is to provide compatibility in 1.5.1 and\nbeyond. We need to fix it, yes, but fixing it here isn't making a stronger\nAPI; it's NOT breaking code out there in the wild.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2569#issuecomment-37090140\n.\n. psst. you mean minor :P\n\nOn Mon, Mar 17, 2014 at 5:33 PM, Cristian Carlesso <notifications@github.com\n\nwrote:\nno, this is a breaking change, so it must be in a major version.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2582#issuecomment-37879467\n.\n. normal build is compat build. e.g. 1.X capable.\n\nfor us wizards we can do no-compat. e.g. 1.5.0 only build which should drop\nthese blocks.\nSo as long as we don't BC (by adding the packager blocks) then we can add\nthis to 1.5.x\nOn Mon, Mar 17, 2014 at 5:57 PM, Cristian Carlesso <notifications@github.com\n\nwrote:\nwe are removing Browser sniffing from the normal build, that is breaking\nenough\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2582#issuecomment-37881461\n.\n. I agree with Arian. UA sniffing has some legitimate uses, and seems\noverkill to remove it entirely. See jquery.ismobile discussion. People have\nto resort to a 3rd party plugin when it's simple to UA sniff.\n\nOn Thu, Mar 27, 2014 at 3:24 PM, Arian Stolwijk notifications@github.comwrote:\n\nI don't think we should remove all of Browser. Browser detection can be\nuseful, statistics, helping users. Of course it should not be used for\nsniffing.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2582#issuecomment-38856024\n.\n. It's right as compat. The idea being that the regular joe schmoe\ncould/would use the grunt task without RTFM. For us ninja joes we can\nprobably julienne our builds.\n\nSorry with the puns. ;)\nOn Tue, Apr 8, 2014 at 6:26 PM, Arian Stolwijk notifications@github.comwrote:\n\nActually, I think default should be nocompat...\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2591#issuecomment-39913726\n.\n. Moving those lines I think you'll get some odd edge cases. The reason\nmoving that line works is that callChain calls the opacity forcably. If you\nfollow the path on the second call the this.check is returning (true) on\nthe inherited Fx.Style but (I believe) false in the root Fx class. We need\nto investigate if Fx.CSS prepare is returning the expected values.\n\nOn Thu, May 22, 2014 at 2:55 AM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@arian https://github.com/arian @kentaromiurahttps://github.com/kentaromiura\n@ibolmo https://github.com/ibolmo @timwienkhttps://github.com/timwienkdo you see any down-side of changing these\ntwo lineshttps://github.com/SergioCrisostomo/mootools-core/commit/4f9ff334f29fd09d9df2b3353124a45803ecac6e?\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2593#issuecomment-43858454\n.\n. Is this not resolved?\n. 3 line change gives the same result, without the need for a lot of logic in core.\n\n``` js\nvar Criteria = new Class({\n    Implements: [ Events ],\n    change: function(){\n        if (!this.disabled) this.fireEvent('change', this.getValue())\n    },\n    reset: function(){\n        this.disabled = true;\n        Object.each(this.criteria, function(criterion){\n            criterion.reset();\n        });\n        this.disabled = false;\n        this.change()\n    }\n});\n``\n. Include an update to Gruntfile.js to create thedist/*.js` files.\nOn Tue, May 20, 2014 at 5:27 PM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@DimitarChristoff https://github.com/DimitarChristoff +1!\nCould you send a PR for that and with it close #2548https://github.com/mootools/mootools-core/issues/2548? would be very nice...\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2596#issuecomment-43691508\n.\n. Well nothing against his shell script, but ideally there should be one tool\nfor building. That's what grunt is all about. I don't care either way,\nthough. I was just suggesting that we already build temporary files we\nmight as well put them in dist/*.js\n\nOn Sat, May 31, 2014 at 11:15 AM, Sergio Crisostomo \nnotifications@github.com wrote:\n\nWe could build those 4 files from the automagical\nhttps://github.com/mootools/mootools-core/blob/master/tag-release shell\nscript that @timwienk https://github.com/timwienk just made? Otherwise\nmaybe a release hook\nhttps://developer.github.com/v3/activity/events/types/#releaseevent\nrunning a new task in the gruntfile.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2596#issuecomment-44752282\n.\n. Note your change would be ... tween.start('opacity', method) right?\n\nQuestion 1: Nope. if else is more expensive than a simple conditional. \nQuestion 2: I'd say we drop it, but add a compatibility block just to be sure. \nQuestion 3: I'm not looking at the source, but I would expect that setOpacity should be called by Fx.Tween. If not we have an issue there. If setOpacity is being called then Element.Style already checks for the need to set visibility. \n. I'm confused. Why isn't this working already. Looking at Fx.CSS.js and\nrender:\njs\nrender: function(element, property, value, unit){\n element.setStyle(property, this.serve(value, unit));\n},\nTherefore visibility should be taken care of because of:\n``` js\nsetStyle: function(property, value){\nif (property == 'opacity'){\n if (value != null) value = parseFloat(value);\nsetOpacity(this, value);\nreturn this;\n }\n```\nand\njs\nvar setOpacity = (hasOpacity ? function(element, opacity){\n element.style.opacity = opacity;\n} : (hasFilter ? function(element, opacity){\nif (!element.currentStyle || !element.currentStyle.hasLayout)\nelement.style.zoom = 1;\n if (opacity == null || opacity == 1){\nsetFilter(element, reAlpha, '');\nif (opacity == 1 && getOpacity(element) != 1) setFilter(element, reAlpha,\n'alpha(opacity=100)');\n } else {\nsetFilter(element, reAlpha, 'alpha(opacity=' + (opacity * 100).limit(0,\n100).round() + ')');\n }\n} : setVisibility));\nOn Mon, May 26, 2014 at 5:45 PM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@ibolmo https://github.com/ibolmo, you were right about the \"note\", i\nedited/corrected above.\nAbout visibility, it's tricky I think.\nOne option is to add this line under, inside the stop: method of FX.js,\njust before the complete events starts to fire (herehttps://github.com/mootools/mootools-core/blob/master/Source/Fx/Fx.js#L104\n):\nif (this.to && this.to.opacity) this.element.setStyle('visibility', this.to.opacity[0].value == 0 ? 'hidden' : 'visible');\nThis will also be applied in other tween of opacity, not just fade.\nAnother option would be based on the one above, but adding a flag on\nthe storage, and retrieve and reset inside the stop: as above. This would\navoid visibility been set when !fade\nOtherwise I see only the \"chain option\" as is in the PR, based on what\n@arian https://github.com/arian added to solve past problems; i.e. that\nthe setStyle('visibility') is passed into the chain to be ran at the end,\nthought after the complete event is called which is not so good.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2597#issuecomment-44222119\n.\n. Let's wait on @arian but I'd say drop the visibility. If we dropped it in\nElement.setStyle then we should drop it here too.\n\nOn Tue, May 27, 2014 at 6:42 AM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@ibolmo https://github.com/ibolmo setOpacity does not currently set\nvisibility in browsers with hasOpacity or hasFilter. The fade is\ncurrently the one to do this by adding a setStyle('visibility') in the\ntween.chain. This was added herehttps://github.com/mootools/mootools-core/commit/11b4257f12a51454bd513ab1ac32cd5239d66098\n.\nIf we change this behaviour, so that when setStyle('opacity') is called\nvisibility is also set, then these aditionshttps://gist.github.com/SergioCrisostomo/fccda619ca4cbd23a218(marqued with\n+) would do the job (specs looks green) and could be used use the new\nre-factored code posted above. This idea to always set visibility was\nabandoned beforehttps://github.com/mootools/mootools-core/issues/2074#issuecomment-2114173.\nSo setStyle should only change the actual prop passed.\nIf we set visibility only when fired from a fade, here is my suggestion\n(http://jsfiddle.net/ZzZEF/), based on Olmo's refactor and @arianhttps://github.com/arian's chain idea:\nfade: function(method){\n    var tween = this.get('tween');\n    if (!method || method == 'toggle') method = this.getStyle('opacity') ? 'out' : 'in';\n```\n//<1.3compat>\nif (arguments.length == 2) {\n    tween.set('opacity', arguments[0]);\n    tween.start('opacity', arguments[1]);\nreturn this;\n\n}\n//1.3compat\nif (method == 'in') tween.start('opacity', 1);\nif (method == 'out') tween.start('opacity', 0);\nif (method == 'show') tween.set('opacity', 1);\nif (method == 'hide') tween.set('opacity', 0);\nif (typeof method == 'number') tween.start('opacity', method);\nvar to = tween.to[0].value, visible = this.getStyle('visibility') == 'visible';\nfunction changeVisibility(value, $tween){\n    if ($tween.$chain.length){\n        $tween.chain(function (){\n            this.element.setStyle('visibility', value);\n            this.callChain();\n        });\n    } else {\n        this.setStyle('visibility', value);\n    }\n};\nif (to && !visible) changeVisibility.call(this, 'visible', tween);\nif (to == 0 && visible) changeVisibility.call(this, 'hidden', tween);\nreturn this;},\n```\nWould be nice to have @arian https://github.com/arian looking at this\nrefactor since he was the one to fix the opacity only setting visibilityif fired from a\nfade\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2597#issuecomment-44264753\n.\n. Based on that I would say we should add:\n\nWarning pseudo\njs\ntween.addEvent('complete', function(){\n  (opacity == 0) ? hide : visibile;\n});\nOn Tue, May 27, 2014 at 8:12 AM, Tim Wienk notifications@github.com wrote:\n\nIf I recall correctly, we made the \"stop setting visibility in setStyle\"\nchange for 1.4.0, which was a logical change. But then we had to very\nquickly release 1.4.1 to fix fade, because our implementation of that\nalways set visibility to hidden after fading opacity to 0 (arguably makes\nsense to do that anyway, fade is more than just a \"change style\"\noperation).\nI wouldn't be in favour of \"just\" dropping the setting of visibility in\nfade, expecting problems if we do. We should first investigate if we want\nto do such a breaking change. #2074https://github.com/mootools/mootools-core/issues/2074and\n2081 https://github.com/mootools/mootools-core/pull/2081 provide more\ncontext.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2597#issuecomment-44273686\n.\n. After the space is cleaned, this LGTM. I think we can invest more time in this, but it's something that I think we can revisit when we refactor for 1.6.\n. Yeah this is missing a spec to cover this. Preferably if we could cover other events too, but I'd accept one to cover just this one.\n. @kentaromiura or @SergioCrisostomo if you can update PR (or submit new one to replace this one) to the 'latest' I can review tomorrow. It's a little difficult to follow with references. \n. FYI,\n\nThis is a temporary solution. The real solution is to drop the php packager\nand only use the grunt-mootools-packager. Then we can regress this. Since\npackage.yml should be deprecated as well.\nOn Sun, Jun 1, 2014 at 4:37 PM, Cristian Carlesso notifications@github.com\nwrote:\n\nlike @SergioCrisostomo https://github.com/SergioCrisostomo says before\nthis change the grunt build took files using the glob resolution order\nSource/*/.js,\nsince the website continues to use the php packager, we had different\nfiles orders from the website and the grunt build, which makes the diff to\nthose files impossible.\nIdeally the output should be the same anyway, to avoid forgetting to add a\nnew source file in the package.yml.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/pull/2603#issuecomment-44790154\n.\n. Yes. The issue is that the docs are not OO. ;)\n\nOn Mon, Jun 2, 2014 at 2:49 PM, Arian Stolwijk notifications@github.com\nwrote:\n\nActually, it's (implicitly) documented here:\nhttp://mootools.net/docs/core/Core/Core#Type:implement\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2606#issuecomment-44882461\n.\n. I'd say well need a PR to review and have CI test against.\n\nOn Thursday, July 3, 2014, Cristian Carlesso notifications@github.com\nwrote:\n\n@ibolmo https://github.com/ibolmo I'm not sure this should be closed tbh\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2607#issuecomment-47879497\n.\n. I'm not familiar with jQuery, but does it automatically do the emulation?\nIf so, is your backend checking for this added header.\n\nAlso, what is your backend telling you? Comes in as POST, DELETE, or GET?\netc?\nOn Tue, Jun 3, 2014 at 9:49 AM, PanzerKunst notifications@github.com\nwrote:\n\nHi,\nWhen doing the following DELETE request on my iPhone (iOS 7.1.1), the\nonFailure callback is executed:\nnew Request({\n    urlEncoded: false,\n    emulation: false, // Otherwise PUT and DELETE requests are sent as POST\n    url: \"/api/reports/\" + reportId,\n    onSuccess: function (responseText, responseXML) {\n        location.replace(successUrl);\n    },\n    onFailure: function (xhr) {\n        this.$confirmDeleteBtn.button('reset');\n        alert(\"AJAX fail :(\");\n    }.bind(this)\n}).delete();\nBut when I do the equivalent in jQuery, it works:\njQuery.ajax({\n    url: \"/api/reports/\" + reportId,\n    type: \"DELETE\",\n    success: function(data, textStatus, jqXHR) {\n        location.replace(successUrl);\n    },\n    error: function(jqXHR, textStatus, errorThrown) {\n        this.$confirmDeleteBtn.button('reset');\n        alert(\"AJAX fail :(\");\n    }.bind(this)\n});\nI think it's a bug in Mootools. I'm having this issue in both 1.4.5 and\n1.5.0.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2608.\n. No I understand, but Safari mobile is particularly funny.\n\nIs there a way you can find out for us the headers that were sent to the\nbrowser? Ideally to compare MooTools vs jQuery headers.\nOn Tue, Jun 3, 2014 at 11:30 AM, PanzerKunst notifications@github.com\nwrote:\n\nI can't really test the server-side right now, but since iOS has amazing\ndebugging tools when you have a Mac, this is what I could extract from xhr\nargument of onFailure:\nconstructor: XMLHttpRequestConstructor\nonabort: null\nonerror: null\nonload: null\nonloadend: null\nonloadstart: function () {}\nonprogress: function () {}\nonreadystatechange: function () {}\nontimeout: null\nreadyState: 4\nresponse: \"\u21b5\u21b5<!DOCTYPE html>\u21b5\u21b5    \u21b5       Bad request\u21b5       \u21b5     \u21b5          html, body, pre {\u21b5                margin: 0;\u21b5               padding: 0;\u21b5              font-family: Monaco, 'Lucida Console', monospace;\u21b5                background: #ECECEC;\u21b5         }\u21b5            h1 {\u21b5             margin: 0;\u21b5               background: #AD632A;\u21b5             padding: 20px 45px;\u21b5              color: #fff;\u21b5             text-shadow: 1px 1px 1px rgba(0,0,0,.3);\u21b5             border-bottom: 1px solid #9F5805;\u21b5                font-size: 28px;\u21b5         }\u21b5            p#detail {\u21b5               margin: 0;\u21b5               padding: 15px 45px;\u21b5              background: #F6A960;\u21b5             border-top: 4px solid #D29052;\u21b5               color: #733512;\u21b5              text-shadow: 1px 1px 1px rgba(255,255,255,.3);\u21b5               font-size: 14px;\u21b5             border-bottom: 1px solid #BA7F5B;\u21b5            }\u21b5        \u21b5 \u21b5  \u21b5       Bad request\u21b5\u21b5      \u21b5          For request 'DELETE /api/reports/21' [Invalid XML]\u21b5       \u21b5\u21b5  \u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\"\nresponseText: \"\u21b5\u21b5<!DOCTYPE html>\u21b5\u21b5    \u21b5       Bad request\u21b5       \u21b5     \u21b5          html, body, pre {\u21b5                margin: 0;\u21b5               padding: 0;\u21b5              font-family: Monaco, 'Lucida Console', monospace;\u21b5                background: #ECECEC;\u21b5         }\u21b5            h1 {\u21b5             margin: 0;\u21b5               background: #AD632A;\u21b5             padding: 20px 45px;\u21b5              color: #fff;\u21b5             text-shadow: 1px 1px 1px rgba(0,0,0,.3);\u21b5             border-bottom: 1px solid #9F5805;\u21b5                font-size: 28px;\u21b5         }\u21b5            p#detail {\u21b5               margin: 0;\u21b5               padding: 15px 45px;\u21b5              background: #F6A960;\u21b5             border-top: 4px solid #D29052;\u21b5               color: #733512;\u21b5              text-shadow: 1px 1px 1px rgba(255,255,255,.3);\u21b5               font-size: 14px;\u21b5             border-bottom: 1px solid #BA7F5B;\u21b5            }\u21b5        \u21b5 \u21b5  \u21b5       Bad request\u21b5\u21b5      \u21b5          For request 'DELETE /api/reports/21' [Invalid XML]\u21b5       \u21b5\u21b5  \u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\"\nresponseType: \"\"\nresponseXML: null\nstatus: 400\nstatusText: \"Bad Request\"\ntimeout: 0\nupload: XMLHttpRequestUpload\nwithCredentials: false\nproto: XMLHttpRequestPrototype\nAnd so it seams to me that the server rejects the request.\nJust to make sure it's clear: this DELETE request works fine on most\nbrowsers. I just noticed the failure on iOS Safari.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2608#issuecomment-44987954\n.\n. Well.. after reading the RFC there is a use case of Content-Type, and that is when the OPTIONS field includes a entity-body. Regardless, the Content-Type is used to help find the right mechanism for the response. This 500 error seems to be that the server doesn't like that it has to give a response in that format. \n\nInterestingly, I don't see how the Content-Type is set. Line 177 is the only one that touches the Content-Type, and that's not executed by your example.\nThe only possible way this is set is by XmlHttpRequest -- by default. Which I suppose jQuery cleans up? \nAnyway, I don't think that Content-Type should have any consequence in the code. It's suppose to be handled by the server in which ever way the server deems it so. I'll let someone else comment, though, on the handling of this request.\n. I'm closing this since you could clean up the headers prior to sending the request. Normally, we would want to fix this but I believe that your server is very picky in the Accept and Content-Type -- e.g. it's not spec specific. Go ahead and re-open, if you have additional info. \n. Go ahead, and I'll compare the example against my server.\n. Send us a PR. \n. We just started a discussion about dropping IE support for some versions. I'll refer to @SergioCrisostomo  so he keeps track :)\n. Sorry for the spam @SergioCrisostomo see: https://github.com/mootools/mootools-core/pull/2611#discussion_r14367398\nfor final implementation.\n. Well Class.Extras.js#L112 skips constructor because it's lacking the 'on' prefix in the name. \n. And constructor in IE is reserved/special field in an object). Nothing we can do about that. \n. I'm still unsure why you'd like to use constructor. Why not use init or start?\n. We've tried to replicate the issue, but we were unsuccessful. Please provide more detail. \n. Sorry, we can't introduce this BC. Reading the manual would also resolve everyone's problems. \n. This is outside the scope of Core, and potentially an issue with performance.\n. If this is useful for anyone else, then we can go ahead and pull into Core. I'm arguing the readability, but it's a moot argument if others pick up the idea.\n. ~~Also, this is missing specs. I would assume that the specs would need to conform to Array.splice's specs (or at least generally).~~ totally skipped the last file. gj!\n. Re: the stick to Array.splice mimicry vs. venture into splice-like\nI would start with the Specs, and define the questions and answers. I'd personally prefer to write something like:\n``` js\n'Some string'.splice('my other string', 5);    // 'Some my other string'\n'abc'.splice(' ', 1);                          // 'a c'\n'abc'.splice(' ', 1, 2);                       // 'a  c'\nmyString.splice(withAnother, optStartPosition, optLength);\n'abc'.splice('def');                          // 'abcdef'\n```\n. I'm personally not a huge fan of Promises, but I understand the need for\nthem.\nI would expect something like Promises implementation/interface that when\nImplements would allow others to use the interface.\nFFT.\nOn Mon, Aug 18, 2014 at 3:52 PM, Graeme Yeates notifications@github.com\nwrote:\n\nFor 2.0, whenever that happens, I would love to see a promise\nimplementation thats used in Requests, Fx and other suitable places.\nDoing so would kill the need of Request.Queue and certainly other\nextensions and enable use that has been made intuitive by other libraries.\nI've been monkey patching this behaviour for requests for a while now\n(using the es6-promise polyfill)\nClass.refactor(Request, {\n    initialize: function(options) {\n        var self = this;\n        this.previous(options);\n        this.promise = new Promise(function (fulfill, reject) {\n            self.addEvents({\n                success: fulfill,\n                failure: reject\n            });\n        });\n    }}).implement({\n    \"then\": function(success, error) {\n        return this.promise.then(success, error);\n    },\n    \"catch\": function(error) {\n        return this.promise\"catch\";\n    }});\nSome example usage:\nvar readyPromises = [\n    new Promise(function(fulfill) {\n        document.addEvent(\"domready\", fulfill);\n    }),\n    new Request.JSON({\n        url: \"/lang\",\n        method: \"get\"\n    })\n    .load()\n    .then(function() {\n        // setup localization\n    })];\n.ready = Promise.all(readyPromises);\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2643.\n. Only issue in adopting the ES6 promise would leave a gap for non ES6 browsers. Thus we'd need to create the shim anyway. \n. Yeah I'd be some kind of decorator.\n\nOn Fri, Oct 31, 2014 at 6:28 PM, Arian Stolwijk notifications@github.com\nwrote:\n\nThe user could add a shim of own choosing, and pass the constructor in the\nconcerning object.\nFor example:\nnew Request({\nurl: 'foo.html'\n})\n.withPromise(Promise())\n.then(function(){ ... });\nOr something similar (I'm not very familiar with the exact promise API).\nOn Fri, Oct 31, 2014 at 10:17 PM, Olmo Maldonado notifications@github.com\nwrote:\n\nOnly issue is adopting the ES6 promise would leave a gap for non ES6\nbrowsers. Thus we'd need to create the shim anyway.\n\u2014\nReply to this email directly or view it on GitHub\n<\nhttps://github.com/mootools/mootools-core/issues/2643#issuecomment-61333031>\n.\n\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2643#issuecomment-61344381\n.\n. This is Slick related. Please report to: https://github.com/mootools/slick\n. And confirm that the fix is working. Please.\n\nOn Mon, Sep 15, 2014 at 2:51 PM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@odysseuscm https://github.com/odysseuscm thank you for pointing this\nout.\nIt has been fixed and added for the 1.5.2 release.\nDo use the fix applied there meanwhile.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2652#issuecomment-55648024\n.\n. Let's pull and find out ;)\n. I'll add a comment to the refactor trello card.\n\nOn Thu, Sep 25, 2014 at 5:03 PM, Sergio Crisostomo <notifications@github.com\n\nwrote:\nShould we open a issue about removing Safari 5 code and close when we have\ndone it?\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/pull/2657#issuecomment-56891035\n.\n. I tend to use a selector rather than a simple getParent() call. I'm also finding myself not using getParent as much. Since, the trend nowadays is to encapsulate logic into functional models. Meaning: ComputerCase(Motherboard(Processor(), Memory()), HardDrive()). Each of the elements would include the specific DOM element via selectors, or you have one parent container and you select down the tree. So I'm already biased against getParent.\n\nWhether this has merit to be included I think it falls on the repetitiveness. I think most people will expect to go up once or twice a level, and I think this is an optimization when you have a very deep node structure. \nFinally, the selector option in the getParent should suffice the majority of the time. You can lookup against a data- attribute, or class to match for the specific parent you're looking for. \nUnless we get more user interest, or more examples of why this would improve on best practices. I'd say this enhancement could be shelved. \n. Yeah and we're glad you did. Keep 'em coming. \nMy rebutt to your example would be.. why do a simple selector like span it's faster/cheaper to just do span.look-for-something  or unless you're saying there's hundreds of span.look-for-something. Also, couldn't you do: .specific-parent span.look-for-something \nAgain, it's unusual nowadays to not be very semantic with your your tags and descriptive. Not just for the benefit of the SEO, but because it's more readable/maintainable. \n. Two issues. \ntypeOf checking $family on a secure object. We don't know of a way to test an object if it's secure or from another domain. Let us know, if you find a way to do this. Just trying 'setTimeout' in window.parent in jsFiddle for example, throws an error. \nsetOptions in Class. We never intended to pass elements, and other massive objects to setOptions. We encourage you to instead pass them to the constructor, or as keys to lookup. E.g. IDs. \nAs it is, we'll have to close this, but open to suggestions on the secure objects. \n. Out of the properties that you are checking, location top and opener seem least generic, but I could still imagine someone passing {location: 'Hollywood'} and instead of object being returned, they'll get window. \nIs there other unique properties we could check for?\n. Untested, but maybe... if (item.top && !Object.hasOwnProperty(item, 'top')) return 'window';\n. We're also having issues reproducing this. IF you could provide the file(s) via Dropbox, etc. It'll help. Closing for now, since it seem worksforme. \n. Sure\nOn Wed, Oct 22, 2014 at 1:06 AM, Hristo Chakarov notifications@github.com\nwrote:\n\nThis is a bug in Firefox's core:\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=1084196\nHowever, I'm not sure that they're going to fix this soon. But as the idea\nof the JS frameworks/libs is to standardize browsers and to fix\ncross-browser issues, I think we need to patch this in MooTools.\nI have already patched this locally. Let me know if you give me green\nlight to make a pull request.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2662.\n. Can you provide the patch in this issue or a PR?\n. We've decided that this is too much burden for MooTools, and although you provided a patch, the patch is a fragile due to the calculations.\n. or HTTPOnly\n\nOn Fri, Oct 31, 2014 at 9:40 AM, Arian Stolwijk notifications@github.com\nwrote:\n\nI would accept a pull request.\nIt's basically just adding\nif (this.options.HttpOnly) value += '; HttpOnly';\nOnly question is whether it should be HttpOnly or httpOnly...\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2664#issuecomment-61269814\n.\n. Any updates?\n. Remove IE6, IE7, and Safari old, Firefox old, Opera old\n. The concept is to reduce the burden on two separate projects and code. Move things that are outside the scope of \"MooTools\" (whatever that may be for 2.0) into plugins (own repo) and merge the rest into Core. Hopefully refactored, optimized, and full spec coverage.\n. Indeed, but I was wondering if we could do something like [^\\d\\D] (this\nwas obviously rushed) but the idea is to separate by non-alpha(unicode)\n\nOn Thu, Nov 27, 2014 at 2:05 PM, Arian Stolwijk notifications@github.com\nwrote:\n\nIt's really depends what this method is meant for. Afaik this is mostly\nmeant for regular simple programming problems, and not for internalization.\nIf you start doing that, then there are at least 101 other cases we would\nneed to cover, and the question is where we should draw the line.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2680#issuecomment-64826848\n.\n. I believe it's been discussed before, and the consensus was that it wasn't Core-able.\n. Ahh likely not there either. I just remember back in the day.. I mean.. 2005?? @kassens had done a debounce and throttle Function extensions that were pretty rad. I'll tell you what. I'll reopen, and based on other feedback we may consider for 1.6. Cheers.\n. LGTM\n. Could you add a spec to check why this is necessary. I'm not following why this commit is necessary. Thanks for the contribution.\n. To make it a little faster you could cache or scope out prior to invocation: http://jsperf.com/regep-in-or-out/3\n. I know its considered private property, but do you think there should be a compat section?\n\nElement.ProtoType = Element.Prototype;\n. Oh. lgtm then.\n. Thanks @kamicane and @fabiomcosta. Have another go.\n. This is invalid since looping through each key and object may seem as if it follows the order that you defined the object, but it's not part of the EcmaScript standard. \nSee: http://stackoverflow.com/questions/648139/is-the-order-of-fields-in-a-javascript-object-predicatble-when-looping-through-th\nThere's plenty of ways get an ordered list (linked list, array of keys and array of values, and so on) and depending on your design/requirements you'll want to choose the best one that fits. \n. Not necessary but this is great work. Thanks Arian. :+1:\n. This is fixed in MooTools More Drag.\n. You could upgrade to 1.4.5, see if this fixes your issue. 1.4 is 1.3\ncompatible.\nOn Tue, Feb 28, 2012 at 11:21 AM, Piers Karsenbarg <\nreply@reply.github.com\n\nwrote:\nJust come across this. What the OP was saying was that if you just run\nmootools 1.3 (and in fact only this file) in IE 7 or 8, you get the error\nthat he stated above.\nTherefore you can't run anything in JSFiddle as it's not anything that's\nbeen built on mootools 1.3, it's mootools itself.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/86#issuecomment-4220631\n. Hrm. My predicament is that while I tested the jsfiddle against 1.3.2 compat I noticed that the following keys did not show up in the key correctly:\n\n-=[]\\;',./`\nctrl\nalt\nwin\nshift+nums\nYour changes, though, did fix the num key pad. So I think I will merge, but our solution seems to miss a lot of keys.\n. I've checked. They're just a layer on top. They're looking at the key as you\nhave. It's a small parser to check if each key is pressed. What they do with\nthe modifiers is not see if it's pressed (as in the key value) but if the\nevent[modifer] is set.\nWhich could be simplified if key did return the right key (e.g. alt, ctrl,\netc.).\nOn Thu, Aug 11, 2011 at 2:48 PM, GCheung55 \nreply@reply.github.comwrote:\n\nIt's possible to add the additional keys to Event.Keys. I haven't checked\nwith MooTools-More Keyboard.JS has done so though..\nSent from my iPhone\nOn Aug 11, 2011, at 7:19 AM, ibolmoreply@reply.github.com wrote:\n\nHrm. My predicament is that while I tested the jsfiddle against 1.3.2\ncompat I noticed that the following keys did not show up in the key\ncorrectly:\n-=[]\\;',./`\nctrl\nalt\nwin\nshift+nums\nYour changes, though, did fix the num key pad. So I think I will merge,\nbut our solution seems to miss a lot of keys.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2002#issuecomment-1782158\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2002#issuecomment-1785294\n. :+1:\n. Updated the fiddle and looks like the attribute does have an empty string: http://jsfiddle.net/ubLw5/2/ for all browsers I've tested (FFx, IE, Safari, Chrome, ...)\n\nSo.. worksforme. You're probably seeing the attribute as <div attribute> because of the developer tools vs Firebug it'll show the empty string.\nRe-open the issue, if you can provide a better test case.\n. Agreed, and thanks to Arian's clarification 1.3 runs native if present and for 1.2 with compat runs a much slower version :(. Nevertheless, I guess the bench should compare against non native bind. Finally, agreed that there's only too much one can do to speed this up.\n. Working on it.\nOn Aug 4, 2011 1:23 PM, \"cpojer\" \nreply@reply.github.com\nwrote:\n\nI strongly feel that this should be internal to Element.Styles and not\nexpose any public object. I'd agree to pulling this for 1.4 although you'd\nhave to check with Valerio for future compatibility.\nAlso, where are all the specs? I won't pull without extensive coverage :)\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2007#issuecomment-1729396\n. Separate dependency is for reducing footprint on Browser.js (and on Element.Styles.js -- I may not need this augmentation). That's a separate matter from public/private.\n\nI don't mind it being on Browser.Features.Styles if we can see ourselves using it as a boolean check. @csuwldcat did you get a chance to write some docs? That'll make it easier to understand if it should be public, semi-private, or private.\n. Dropping this for now. Since Daniel has some changes that I haven't incorporated. He should be the one pull requesting. ;)\n. Also on Chrome 14.0.835.18 dev Mac OS X 10.7 no issues. Looks like a Chrome 13 issue. Perhaps we should notify people as a known issue, but we'll leave it as wont fix since it'll fix itself in matter of weeks (when Chrome 14 goes stable).\n. Yeah that wasn't nice @cpojer. Any report is better than no report. \n. I'm willing to spend 2 minutes on a bad ticket another 2 to explain (nicely)  how to make a (proper) ticket. So that someone else spends 25 minutes trying to figure out a problem and 5 minutes to write a ticket. :D\n. Isn't that what this does? Object.extend should look for the native Object::create, if not found then adds this workaround. \nThe other suggestion was to protect Object::create from being munged by Function.create. Advice.\n. Looks pretty good. Now you're missing the .html spec (which I don't see a spec commit update included) and fixes to the style. \n. Did you:\nsh\ncd Specs\ngit commit -am \"changes\";\ngit push origin master;\ncd ../\ngit add Specs # now it's available to be included in the Core repo.\ngit commit -am \"Updated specs.\"\ngit push origin master\nThe gotcha (and I can already hear you complaining about git... :D) is that the spec submodule must be committed (without dirty bit set) so that it can be included in you commit. Go ahead do the above, and your pull request should update it  self.\nMake sure to update any remote or branch aliases.\n. He included unnecessary stuff. He's fixing the pull request soon.\nOn Wed, Aug 10, 2011 at 2:27 PM, cpojer \nreply@reply.github.comwrote:\n\nThis is a crazy amount of code. It used to be 10 lines.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2018#issuecomment-1775847\n. Worth noting that the spec doesn't define a value attribute in select element (see: spec) but using a fiddle we can see that all modern browsers returns the value for select of the first selected option.\n. Correction. There was a spec: http://www.w3.org/TR/html5/the-button-element.html#dom-select-value\n. Someone care to make a quick .html ala Delegation.html ?\n\nI'd say, do a comparison between a 50% applied via browser and 50% applied\nin photoshopz.\nAnd one with effect from 100-0 (get from demo?) iframez?\nOn Wed, Aug 17, 2011 at 2:20 PM, arian \nreply@reply.github.comwrote:\n\nas far as I tested (just typing some stuff in the consoles of IE8/chrome)\nit seems to work. If this stuff is enough covered by the specs (not really\nfor setStyle/getStyle as far as I see) they also pass in IE6, Firefox 6 and\nOpera.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2027#issuecomment-1829612\n. I tweaked it and optimized it a bit: https://gist.github.com/1147965\n\nSince it's going in Element.Event.js now, we'll just need to do some last minute fixes to the pull request. Sorry @csuwldcat :D. Great job!\n. I'm going to do the fixes, so we can push this. Hang on tight :D\n. Closing since I didn't use a topic branch.\n. @Xunnamius figured out your bug :D.\nGlad to say it wasn't MooTools this time.\nIn your ACJ.js file \n``` javascript\n(function(){\n    for (var i = 0; i < arguments.length; i++)\n        APE.Config.scripts.push(APE.Config.baseUrl + '/Source/' + arguments[i] + '.js');\n})(/ --> / 'mootools-core' / <-- /, 'Core/APE', 'Core/Events', 'Core/Core', 'Pipe/Pipe', \n```\nTo:\njavascript\n(function(){\n    APE.Config.scripts.push(APE.Config.baseUrl + 'mootools-core-1.4.0.js');\n    for (var i = 0; i < arguments.length; i++)\n        APE.Config.scripts.push(APE.Config.baseUrl + '/Source/' + arguments[i] + '.js');\n})('Core/APE', 'Core/Events', 'Core/Core', 'Pipe/Pipe', 'Pipe/PipeProxy', 'Pipe/PipeMulti', 'Pipe/PipeSingle', 'Request/Request','Request/Request.Stack', 'Request/Request.CycledStack', 'Transport/Transport.longPolling','Transport/Transport.SSE', 'Transport/Transport.XHRStreaming', 'Transport/Transport.JSONP', 'Transport/Transport.WebSocket', 'Core/Utility', 'Core/JSON');\nEffectively. You were including 1.3.2 in the iframe that APE creates. Since the mootools loaded in the iframe affects the MooTools in the parent frame, you or APE should include the 1.4 version.\n. If they build from github master, they shouldn't have problems. We're\nreleasing 1.4.1 this week.\nOn Tue, Sep 20, 2011 at 8:27 PM, Tre Giles \nreply@reply.github.comwrote:\n\nAh, I thought the iframe would have isolated the two Moo implementations\nfrom one another. Mistaken I was!\nWell, my little hackfix is working at the moment (I'm a little scared to\ntake it out), but I'll forward this to the APE guys. Maybe they'll look at\nit and finally upgrade their Moo!\nThanks.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2062#issuecomment-2151740\n. Take a look at: http://ariya.ofilabs.com/2011/08/hall-of-api-shame-boolean-trap.html\n\nRemoving the first argument would hinder the readability of API. Second, .toggle doesn't mean anything to me. First thought is: \"toggle what?\".\n. Ahh sorry, then. You submitted the issue in mootools-core. You should try to create the issue here: http://github.com/mootools/mootools-more.\nMy personal opinion, though, is to deprecate the toggle method. \n. worksforme.\nHere's the deal. If you set async to false then the method Request.send is blocked by line 199 because you asked that it should (remember the async false?).\nSince send is blocked and eventually fires the events (e.g. onSuccess) and then sets up the delay, but by then send is all done and the request has already finished.\nRe-open if you have another problem.\n. Ah I see what you mean, but I think the options are mutually exclusive. You either do async: false or you do timeout: 1000.\nIf you do async: false the XHR transport will rely on server timeout or browser set timeout (internal to the transport, or perhaps a blocking protection which will prompt user to kill the javascript that is blocking) to return execution to the script. \nI've reopened this issue as a documentation issue. Do you agree?\n. @arian @cpojer, we could still reduce headaches if we do as @kguelzau mentioned. To add an else if. If you guys agree with my last comment, I don't see a problem of adding that else if on this line.\n. ?\n. :+1:\n. Worksforme in IE7. \n. Chrome latest, Safari latest, Opera, Firefox 3-5.\nThe fix in Element.js is to overload the setter, getter, and erase to\nforcibly update the id attribute (on the object) and with the attribute\nnode. It's unfortunate, but IE has trouble removing attributes of\ncloned nodes.\nWe should be vigilant of other troublesome attribute nodes that might be\nproblematic.\nPlease review and merge.\n. Fixed in https://github.com/mootools/mootools-core-specs/pull/22\n. Started working on the fix, but I'm getting stuck on reproducing. Do you mind providing a jsfiddle? \n. Hi @reaktivo, I'm going to have to move this to 1.4.4 (closes in 3 weeks). I'm afraid that if we don't get an example by then I'll have to close this issue until we get your help. No pressure, haha. \n. Wait why wouldn't: element.addEvent('click:relay(a)', cb).fireEvent('click'); // not fire click?\nhtml\n<body>\n  <ul class=\"nav\">\n    <li><a href=\"javascript:void\">First</li>\n    <li><a href=\"javascript:void\">Second</li>\n    <li><a href=\"javascript:void\">Third</li>\n  </ul>\n</body>\n``` javascript\n$(document).addEvent('click:relay(ul)', function(){});\n$$('ul.nav').getFirst().addEvent('click:relay(a)', function(){}).fireEvent('click');\n```\nIn the above, shouldn't the delegator on document fire when click event is fired in the .nav? \n. So I guess we agree that it should fire. Hrm.. o well. Only more of a reason to rush 2.0 out the door.\n. Likely not going to happen anytime soon\u2122.\n. Actually just don't escape it: http://jsfiddle.net/NA4V2/3/\nI'm closing for now. Please reply if escaping is your only option.\n. doh.. http://jsfiddle.net/J59PD/9/\ncick to click :D\n. Fixed with #2140.\n. Yeah.. this is also for IE6. Here's a fiddle: http://jsfiddle.net/tQ4QN/\n. Here we go: http://jsfiddle.net/tQ4QN/4/\n@fabiomcosta @SubtleGradient, this is a tough one ... should Slick.getAttribute fix this?\n. Actually, this might be mootools related. @arian @cpojer help :D\n. Still waiting on input from @fabiomcosta, @subtleGradient, @arian, @cpojer. Looking for opinions/direction or 2c. Thanks!\n. The problem is that\nel.anything will be considered an attribute by IE. This means that el.getAttribute('anything') will give the value of it. \nOne solution is to whitelist using setProperty any attributes and check against the property in getProperty if someone wants el.something they should use el.something. Again, this reinforces that el.you = 'set the value' is very bad.\n. Yeah this is a webkit bug: https://bugs.webkit.org/show_bug.cgi?id=14439\nI can write a fix, though so that Element.set fixes this in the mean time. Stay tuned.\n. I've experienced this myself and the issue here is that the website is not ready to support this kind of change. I leave it to @w00fz to decide if we should wait for 2.0 or have this out for 1.5 or 1.6.\n. @arian @cpojer \nI wouldn't mind if this was global. Perhaps renamed to uniqueId, or as @fabiomcosta mentioned Object.uid.\n. Sure, the suggestion for uniqueId is that there's not appropriate parent object. Since it's useful and quite standard in other languages, I figured it should just be a simple rename.\n. nah we can just deprecate\n$uid = uniqueId\n. hehe wasn't private if it was accessible globally. perhaps \"protected\". At any rate, I prefer the deprecation, and then remove it in 1.5 or 2.0. \nBetter safe than sorry\u2122\n. Yeah that was my opinion that all browsers should have a uniqueId, but if\nwe don't agree than we should just keep it some where else and not\npollutant.\nI guess you're in the camp of not polluting?\n@arian would you be against Object.uid?\nOh and regarding protected, or private. Since Slick uses it, I think it's a\ncandidate to say it should be public. We should document it.\n2011/11/24 F\u00e1bio M. Costa <\nreply@reply.github.com\n\nIf it's meant to be protected then we should make it clear, like doing\nwhat python does, prefixing an underscore, _uniqueId.\nA global uniqueId variable looks like trouble to me, it's kind of a\nregular name for a function that someone could still have on they're\nprojects.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2118#issuecomment-2862390\n. Ok I think I understand how this got all jumbled up. \n\nHere's when we had the default: fade.start(o, arguments); 1;\nHere's when we had the visibility problems with fade 2.\nFinally we're trying to get this going because default case is no longer present.\nI think this function would be simplified if we dealt with the visibility problems separately.\nHere's an untested and probably not done work, but I think it's clear of the direction I'd like for us to go: https://gist.github.com/1389476\n. @arian the only thing missing is just a spec that covers this special case. perhaps in a compat test.\n. See: https://github.com/mootools/mootools-core/commit/45cd384e5487bc4751c5b688167ba7f1678d765d\n. I'm having trouble reproducing this as well. I've gone as far as identifying a few leaks in Element.js that I've cleaned up and will create a PR for, and will continue to try to find the other leaks, but it'd be best if @gd0t provided us with a procedure on how to reproduce.\n. Thanks @gd0t. I'll add another issue to test for instanceOf leaks. In the mean time, you should reconsider using Process Explorer and opt to use sIEve. A couple of reason why:\n- Process Explorer looks at a whole process. Not very granular (e.g. you don't know which nodes are leaked).\n- There are fake leaks that stay in memory until the browser is closed. We should minimize these, but not much we can do. \nOtherwise, I think it's fine to use Process Explorer; but I think you'll find sIEve much more detailed tool.\n. Do you have a blog post or screencast in your leak finding process? I'd be\na good article.\nOn Mon, Jan 9, 2012 at 2:14 PM, John-David Dalton <\nreply@reply.github.com\n\nwrote:\nTools like sIEve give false positives and can cause devs to waste time. I\nfind it's best to use use Process Explorer and a\nsimplified test case to locate leaks. I am aware of the instanceof leak\nand try to avoid it in places like Benchmark.js.\nThat said not even dummy element created has to be nulled.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2127#issuecomment-3419432\n. Nice screencast. I guess process explorer is really handy to just notice if\nthere's a leak. I liked that sIEve gave some nodes to help me find the\nleak. How did you narrow the leak to replaceChild?\n\nOn Mon, Jan 9, 2012 at 2:35 PM, John-David Dalton <\nreply@reply.github.com\n\nwrote:\nHere is a blog post I did over a nice single page memory leak in IE\nassociated with removeChild.\nhttp://allyoucanleet.com/2011/02/16/exploring-the-removechild-single-page-memory-leak/\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2127#issuecomment-3419781\n. Yeah the UA sniff was a quick solution, I didn't invest on thinking on the best feature detection. \n\nI'm not against removing the width and height prior to setting the src. \nGood call on checking against img tag. Not going to be a problem with 2.0, hehe. \nI'll wait for your 2k5/2k6 research, and create the PR afterwards.\n. Hrm.. I couldn't find what the spec mentions about width/height attribute\nvs CSS with the definition of width and height, but perhaps we can take\ntheir decision to drop cellpadding cellspacing in favor of margin and\npadding in table.\nAnd since they're using Element.set('src') rather than just element.src,\nperhaps with documentation it might suffice to explain the convention on IE\nonly.\nOn Sun, Nov 20, 2011 at 3:30 PM, John-David Dalton <\nreply@reply.github.com\n\nwrote:\nOk so I did some research and it seems the reason IE isn't changing the\nimage size is that it is automatically assigning it a height/width\nattribute. The other browsers resize the image because there is no\nexplicitly set dimensions.\nBecause IE auto adds these attributes it may be tricky to detect if they\nwere explicitly assigned or auto so simply clearing them is not a good idea\nbecause they may be added on purpose.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2129#issuecomment-2808620\n. @jdalton, @cpojer, and @arian. What'd you think of my last comment. \n. Ok I may have an actual boss solution. Since it's so late, I'll document it and either one of you guys get around to it before I do (or refute it) just follow-up here.\n\nTake a look at: http://jsfiddle.net/XS6Kw/\nDOM 2 (or whatever) added a specified attribute to an Attr node. Since IE6 it's been supported. The idea is that there is a way to know if an attribute had been previously been specified by the user. Either by html or programmatically (el.width =).  This is by using the specified attribute in the attribute node.\nThis assumes that Element.set('src') is being used, otherwise burden falls to the developer. Element.set('src', ...) remove attribute nodes width and height (not necessarily mutually) if they haven't been specified. If specified, the question falls to what the other browsers do (TODO). If the user specifies a width attribute and changes the src to a different sized element, I assume that the browser will honor the specified attribute and not look at the new image sizes. Therefore, in IE we'd just let those attributes stick.\nThat's it for now. It's a good move forward, imo.\n. Going for the doc.\n. https://github.com/mootools/mootools-core/pull/2131\n. Thanks @jdalton. Took a look and it seems that the only thing missing is: iterables and skip check. Since we don't support iterables (ringojs) we can postpone that for later. The skip check, though, might be appropriate. We've had overload since 1.3, so we haven't seen any problems (perhaps obvious problems). \n. haha sorry to have closed this from a git push. I'm going to use milk's issues to track this. For now we can keep this closed and trickle down the fix later.\n. What browser? I can't seem to reproduce in Chrome.\n. I'm closing this for now, please open up with browser, OS, and ideally a jsfiddle showing the unexpected result.\nCheers,\n. Well, we'd have to keep the comment blocks as I mentioned in the issue description to keep 'em. This way we could release it in 1.4.2, instead of waiting for 1.5.\n. As a note, this also implies work on the website.\n. Ah nice find!\nSo you support flattening the folders for ease of development?\nOn Wed, Nov 23, 2011 at 7:14 PM, Thomas Aylott <\nreply@reply.github.com\n\nwrote:\nCheckout the git-subtree.sh git plugin. It makes working with sub-projects\nlike this really easy without having to use submodules.\n\u2014 Thomas Aylott - SubtleGradient - MooTools - Sencha (from iPhone)\nOn Nov 23, 2011, at 4:14 PM, Olmo Maldonadoreply@reply.github.com wrote:\n\nI think we should go ahead and remove the submodule and add the files\ndirectly. Optionally include tree (history) of information from the specs\nrepo.\nWe could keep the runner as its own submodule, but we should also\nconsider removing it as well.\nWhat say you?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2134\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2134#issuecomment-2857157\n. I haven't mastered git-subtree, but I think that it'll seem as if the files\nare just in the repo, but for those with subtree will be able to maintain a\nseparate repository for others to contribute without having to work through\nthe mootools-core repo.\n\nSo I propose the following.\nmootools-core-specs deprecated (README updated with such information), and\nnot a subtree.\nmootools-runner should be kept as a submodule for the time being, but\nnow at least it'll be a submodule of the core project and not of core-specs.\n2011/11/24 F\u00e1bio M. Costa <\nreply@reply.github.com\n\nI prefer removing the submodule and adding the specs directly to the -core\nrepo.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2134#issuecomment-2862094\n. Correction. git-subtree.sh is not that it'll seem as files in the repo,\nbut they actually are files in the repo. Except that subtree helps us\nseparate the history (and push that history) to and from a separate\nrepo.\n\nBasically it reduces the git submodule update --init and other headaches\nfor those that don't understand (or care to understand git submodules).\nI still think, though, that we shouldn't bother picking up a new technology\nuntil we really need it. We will unlikely update the runner as often as we\nupdate the specs. Therefore, we should leave the Runner as a submodule and\nreview the submodule situation a month or two in the future.\n2011/11/24 Olmo Maldonado olmo.maldonado@gmail.com\n\nI haven't mastered git-subtree, but I think that it'll seem as if the\nfiles are just in the repo, but for those with subtree will be able to\nmaintain a separate repository for others to contribute without having to\nwork through the mootools-core repo.\nSo I propose the following.\nmootools-core-specs deprecated (README updated with such information), and\nnot a subtree.\nmootools-runner should be kept as a submodule for the time being, but\nnow at least it'll be a submodule of the core project and not of core-specs.\n2011/11/24 F\u00e1bio M. Costa <\nreply@reply.github.com\nI prefer removing the submodule and adding the specs directly to the -core\n\nrepo.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2134#issuecomment-2862094\n. Fixes #2073.\n. Fixes #2085\n. Well since this just adds a _fireEvent, unless you're looking for it this shouldn't cause anyone any problems.\n. Fixes #2089.\n. Done https://github.com/mootools/mootools-core/commit/74644b1b4c26e2ad188966c517ab1bc77ab07517.\n. Fixes #2100.\n. See the new specs: https://github.com/ibolmo/mootools-core-specs/commit/1bca15d25d0fca190aeb4e7b12e261d135b6b311\n. Naice. Looks like this fixes #2108 as well\n. Agreed, we should refer people to this conclusion when encounter similar confusion.\n. Fixes: #2113.\n\n\nHere's the new spec: https://github.com/mootools/mootools-core-specs/pull/25\n. Fixes #2118.\nHere's the specs: https://github.com/mootools/mootools-core-specs/pull/26\nPASSED: IE6-9, FFx 3-5, 8, 10, Opera 11, Chrome latest, Safari 5\n. Yeah I agree. @cpojer, do you concur?\n. @fabiomcosta I ran the specs against IE6-9, Safari 5, Chrome latest, Opera 11, FFx 3-5, 8, 10. All PASS.\nOnly scenario is that we didn't have a spec that would fail. Do you have a XML node test we should use?\n. You rock :D @arian++\n. Actually, contains should accept an id string. Must be a backwards compat problem.\n. Well issue with the docs is that they are showing the latest code. For a long time I've wanted version dependent docs. So no, right now the docs should show how to write the code for 1.4.1.\nI just did some research and looks like we've never had a contains method. Just a hasChild, and that has proper BC.\nThe contains you're seeing is a cross-browser fix so that it's available everywhere. The API is such that it complies with: http://msdn.microsoft.com/en-us/library/ms536377(v=vs.85).aspx.\n. Can you include a fix to the arguments list?\n``` markdown\nArguments:\nel - (element) The element to search for.\n```\n. TY! Keep 'em coming\n. Thanks for the inquiry. Actually prior to 1.4.0 mootools was inconsistent.\nElement.set is used to set Element properties.\nElement.setStyle is used to set CSS properties.\nTherefore, it's appropriate for setStyle to only modify the opacity CSS property while the Element.set('opacity' is used to set opacity and anything else (like visibility).\n. Nice!\nYou're missing docs and specs, and I'll get around to picking at your code this weekend. Cheers.\n. Fixed. No ref needed. Work done in the backend.\n. Thanks, could you provide us with a copy of the UA string? I'd like to study it before merging in this PR.\n. @arian could be as a result of hp acquiring webOS?\n. @cpojer @arian I've been thinking about this. Technically empty in Array.js doesn't do anything to the objects inside, it just removes them from the array. Which is what's currently done in 1.4.2. Perhaps just a special note in the docs will suffice to express a best practice:\nNote:\nElements.empty does not destroy the elements inside. As best practice, always destroy your elements if they're no longer in use. For example:\n$$('div').destroy().empty();\n. You can view the file in github: https://github.com/thatmarvin/mootools-core/blob/d034134d95853e6443841c3e8dd67b97f2382c77/Docs/Fx/Fx.md\nThe only rendering missing is the links, but we'll help you with that -- or it's an easy fix.\nThanks for contributing.\n. I don't suppose you'd like to write a spec case for this? :D\nAlso, I'll merge this to 1.5.0 branch soon. @cpojer or @arian do you concur on putting this in 1.5.0 or should this go in 1.4.3.\n. Yeah it's just a little hidden since it was made for a prior version: https://github.com/mootools/mootools-core/blob/master/Specs/1.3base/Fx/Fx.js\n. Shouldn't be a problem. You can commit it to your master branch and I can pull your request locally. I can run the specs and find out what the problem is. \n. @arian perhaps this is best solved in Fx.CSS reasoning stands that getStyle should fix this, but if it does it will be impractical unless there's a way to know what kind of unit you're expecting (perhaps an additional argument to getStyle?). Which is where Fx.CSS has the advantage. We can edge case check for '%' and use a feature detect to fix the behavior.\nAlthough I'm not excited to display: none then display: block e.g. will cause a refresh glitch. Se la vi. \nTL;DR:\n1. feature detect for bad behavior\n2. Fx.CSS.prepare, if bad behavior and %, display none, getStyle, and display: block\n3. add Note in getStyle about FFx and Opera bug.\n   Optional:\n4. Add a github issue for adding a unit argument to getStyle for conversions.\n. @DimitarChristoff, @stecb please give us a hand and test the master branch with your code. \nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master\n. @jbgithub Undoubtedly we have released versions that introduced new bugs as a result of fixing old bugs. Even though we did thoroughly test each version prior to commit, I think you can appreciate the difficulty it is to have thorough and effective tests.\nAs soon as someone submits a new issue we usually fix the behavior only after we've created specs/tests that confirm the problem. This ensures that future commits cover those cases. We are not, however, predisposed to knowing if a fix will cause another bug if our specs/tests never covered the created edge case. As you're probably aware.\nI also, hope, you're not suggesting that 1.4.1 and previous versions were bug free. \nI think your suggestion that we should have a freeze period prior to public release, is acceptable and something we've already considered and put into action. As you'll notice we've asked @stecb and @DimitarChristoff to test in their builds and sites. Likewise, you're welcome to test master branch against your code base. \nI also recommend that you separate your environments to include a staging area. That is not public, but also not behind a firewall, so you can invite private beta testers. This may include us. \nOverall, it's a difficult issue since we cannot be stalled with the fear of introducing new bugs. We are going to adjust to have a buffer prior to release so as to reduce the chance that a release will have critical bugs. Finally: we can never guarantee a bug free release. With your help, and our community's help, we will find the bugs faster. Create coverage. Fix the bugs. Release a new version; and repeat.\n. Thanks for your understanding, and I'm excited to have you on board for the freezing period. At some point, we'll open it up for more volunteers but we'll use issue contributors to ping for testing.\nFor now please check the stability of 1.4.5dev and if any of your tests fail, please let us know. We should start trickling specs/tests from user space to dev. We'd like to release 1.4.5 some time this week. \nRegarding the fireEvent, could you please report it in another issue? I'd like for others to review it.\n. Thank you @DimitarChristoff .. @arian looking go so far. Let us know when QA gives you the seal of approval, we'll tag it and ship it then -- I believe.\n. @jbgithub here ya go http://mootools.net/nightly/build/mootools-core.js\n. Thanks for your submission. We'll try to reproduce the crash ourselves, but\nit'd be best if you provided a jsfiddle.net with code that would reproduce\nthe problem.\nOn Wed, Dec 7, 2011 at 6:37 PM, isfalse <\nreply@reply.github.com\n\nwrote:\nPlatform : Windows XP SP2, IE Version 7.0.5730.11\nTested with Mootools 1.4.2 Full Core Version without compatibility,\ncompressed\nBackward issue on IE7 with Mootools Core 1.4.2, addEvents or clones (i\ndon\u2019t know) cause IE7 crash when \u201cBackward Page Button\u201d is pressed or\n\u201cRefresh Page Button\u201d is pressed.\nI have a lots of Class and functions in my scripts and it works fine with\nMootools Core 1.4.1. I've search before in my scripts if some errors was\nin, but that issue appears when \"addEvent/addEvents/cone\" are called and if\ni use Mootools Core 1.4.2.\nThanks\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2163\n. I'm having trouble reproducing. I have the same setup as you do. The only thing I can attribute to the crash is that jsfiddle has an unload problem and that you're using console.log :D. \n\nYou should enable script debugging in IE and confirm that's the reason that it crashes. I might also suggest to host the file yourself and link us.\nFor the moment, worksforme. I'll close and feel free to reopen.\n. Just tried all three links, and I still can't reproduce it. I'm at my wits end. I'll leave it open and ask one of the other developers to try to reproduce. Sorry for the inconvenience. \nIn parallel, we're releasing 1.4.3 with a fix that -- as an educated guess -- might be related to this: https://github.com/mootools/mootools-core/pull/2176/files\nIf you would please try to apply that diff to your copies of 1.4.2 and see if the problem is solved or still present.\n. Thank you for the detailed instructions. I've followed your steps, but my IE7 doesn't crash :(. \nI'm glad the patch fixed it, though. I'll reference it in the PR. It's troubling, though, that I couldn't reproduce it. I wonder what's wrong with my IE. Perhaps I have a patched version.\n. @isfalse just modify .uid to .uniqueNumber and 'uid' to 'uniqueNumber'. You can use the diff link I provided as guidance.\n@incendium hehe always. keep sending us the bugs that you find. trying to make it a habit to release maintenance releases every 2-3 weeks.\n. I'm closing this since #2176 fixes this.\n. If you guys are using a VM, and you're comfortable with the idea, could you\nhost your VM and link me to your VM? I can run it in VirtualBox as well.\nYou can message me (via github) directly if you do not want to disclose it.\nI still can't repro it :(\nOn Wed, Dec 21, 2011 at 9:51 AM, Matthew Gast <\nreply@reply.github.com\n\nwrote:\n@ibolmo It looks like using @isfalse's test page crashes my IE\ninstallation as well. Here are the steps I took to reproduce it:\n1) Close all running instances of IE7\n2) Open IE7 and disable all addons\n3) Close all running instances of IE7\n4) Open http://www.apixelife.com/github/2163/mootools-core-1.4.2.html\n5) Refresh page using Ctrl+R\n6) IE7 crashes\nI peeked at his mootools.js file and it looks like he patched it OK.\nPerhaps there is some attribute that IE doesn't like and crashes when it\ntries to clear it?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2163#issuecomment-3235346\n. nice find. i will give it a shot when i get in the office in about an\nhour. ty for the hard work\n. Well here's the dealio. Line #261 will only execute for <IE8 since there is\nno native Element. This would mean that Browser.Element is null or\nfalse-y.\n\nTherefore your suggested fix means that the crash no longer occurs because\nel._fireEvent = el.fireEvent; is never executed.\nI can conclude, then that IE7 is having difficulty setting the attribute to\na function. I think the solution is then to store the fireEvent method in\nElement storage. I'm going to try this in a bit. I promise that 1.4.3\nwill not roll out without a fix to this.\nThanks for everyone's patience.\nOn Sun, Jan 8, 2012 at 11:48 AM, jbgithub <\nreply@reply.github.com\n\nwrote:\n@arian Yes, line #261.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2163#issuecomment-3403301\n. I'll try. TY\n\nOn Sun, Jan 8, 2012 at 5:32 PM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nWhy not use Element.implement, like any other method...\njs\n(function(fireEvent){\n   Element.implement('_fireEvent', function(type, event){\n       fireEvent.call(this, type, event);\n   });\n})(Element.prototype.fireEvent);\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2163#issuecomment-3405632\n. Alright folks.\n\nFollow these instructions if you'd like to try this fix:\n``` sh\ngit clone git://github.com/ibolmo/mootools-core.git ibolmo/mootools-core\ncd ibolmo/mootools-core\ngit fetch origin\ngit checkout fix-2163-regression-ie7-crash\ngit submodule update --init --recursive\n./build > mootools-1.4.3.js\n```\nPlease update your test pages @jbgithub @kguelzau @incendium @dmethvin @isfalse \n. TY @jbgithub anyone else?\n. Yey. Thanks everyone for your reports and support. Stay tuned for 1.4.3.\nOn Mon, Jan 9, 2012 at 10:08 AM, Matthew Gast <\nreply@reply.github.com\n\nwrote:\nLooks like it's working on my end. Tried it using both test cases that\nwere failing for me and they both work now. Awesome job!\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2163#issuecomment-3413834\n. @SunboX did you try: https://github.com/mootools/mootools-core/issues/2163#issuecomment-3407851\n. Sure. It was a bug introduced in 1.4.2. If you get the chance, have a go at\nmaster (soon to be 1.4.3).\n\nOn Wed, Jan 11, 2012 at 1:02 PM, Andr\u00e9 Fiedler <\nreply@reply.github.com\n\nwrote:\nNo, I didn\u00b4t try it. Had to fix it quickly and haven\u00b4t access to our\nclients machines now. :/ Can\u00b4t reproduce this bug on my development\nmachine. But it works now, with 1.4.1.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2163#issuecomment-3451651\n. Nice find. I'll spec this and get this committed 1.4.3 due out in less than\na week.\n\nOn Fri, Dec 9, 2011 at 10:55 AM, rhuynh <\nreply@reply.github.com\n\nwrote:\nIn mootools 1.4.2., you can no longer set a form field's value to 0, eg,\nmyTextBox.set('value', 0).  It always result in an empty string.  This used\nto work in mootools 1.2.5.\nI believe the error is in the property setter for 'value'.  Instead of:\nObject.append(propertySetters, {\n       'class': function(node, value){\n               ('className' in node) ? node.className = (value || '') :\nnode.setAttribute('class', value);\n       },\n  ....\n       'value': function(node, value){\n               node.value = value || '';\n       }\n});\nit should be:\nObject.append(propertySetters, {\n       'class': function(node, value){\n               ('className' in node) ? node.className = (value || '') :\nnode.setAttribute('class', value);\n       },\n  ....\n       'value': function(node, value){\n               node.value = [value, ''].pick();\n       }\n});\nTested On: Firefox, Safari, and IE9\njsFiddler:\nhttp://jsfiddle.net/uYWgf/2/\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2164\n. Fixes #2127.\n. Fixes #2109.\n. Thanks! Done :D\n\nOn Sat, Jan 7, 2012 at 6:56 PM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\n:+1: i can push this any time you want ;)\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2167#issuecomment-3399489\n. Fixes #2129.\n. Opting for doc. \n. I'll try to include this in 1.4.3, otherwise will be included in 1.4.4 (two week sprint) or 1.5 (depends on feature set)\n. Fixes #2159.\n. Fixes #2169\n. TY\n\nOn Mon, Dec 19, 2011 at 11:52 AM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\n:+1:\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2177#issuecomment-3206702\n. Not sure if we'd ever check for == [] after we destroy. Also, there's already a discrepancy between Array and Elements, and some problems with Element methods. Not sure if we should also add destroy as a special case. At least, I don't see it too beneficial.\n. Unfortunately 1.2 is no longer supported (over a year old), but we encourage you to try 1.4 with compatibility layer. The compatibility layer is backwards compatible up to 1.2. All 1.2 code should (theoretically :D) work with 1.2 if you have the compat layer enabled in the build process: http://mootools.net/core.\n. Thanks. I can reproduce it on a Mac keyboard US. What's your setup?\n1. Keyboard Layout: US, EU\n2. OS?\n. Perhaps a documentation update?\n\nOn Sat, Jan 7, 2012 at 8:00 PM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nWhat Sebastian said.\nkeypress events should pass a charCode value, which is a char that can\nbe transformed with String.fromCharCode to a string representation.\nAlso see http://www.quirksmode.org/js/keys.html\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2183#issuecomment-3399759\n. Fixed: https://github.com/mootools/mootools-core/commit/bf1d54cc4309de9edbc47353b5d9e70da7ab0b0a\n. please send us a fiddle or code that crashes ie9. well use them as\npart of the specs\n. Looks like this fix would be too narrow, I believe the solution is to lookup the specific methods and properties that you're interested in and for those properties wrap 'em in try statements.\n\nSomething like:\n``` js\nvar dangerousBools = ['autoplay', ...];\nArray.forEach(dangerousBools, function(bool){\n    var lower = bool.toLowerCase();\n    booleans[lower] = bool;\n    propertySetters[lower] = function(node, value){\n        try {\n            node[bool] = !!value;\n        } catch(e){}\n    };\n    propertyGetters[lower] = function(node){\n        try {\n            return !!node[bool];\n        } catch(e){\n            return false;\n        }\n    };\n});\n```\nYou'll still be responsible for being careful with your own methods, though. You're right that any access to methods or properties will throw an exception. That means that canPlayType will still throw the exception.\nFor now, could you help us with a little research on the properties you'd like for us to watch out for?\n. :+1: I'll manually update the check.\n. Also, did you check if IE9 behaved incorrectly? <IE> is too broad\n. :+1: then\nOn Sat, Jan 7, 2012 at 8:04 PM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nThe first test failed in ltIE9 too, wich was fixed by this fix. The second\ntest only failed in IE9 iirc.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2188#issuecomment-3399779\n. Cool. I just had a thought: \"we should add documentation note\". :D Under.. Element.set?\n. Without additional information (code) it's hard to discern who's at fault. Perhaps a simple jsFiddle is needed. \n\nAlso, you may want to try loading Sencha Touch first then MooTools.\n@subtleGradient are you familiar with this problem?\n. @chrispitt agreed. @liviathan if you get around to providing a jsfiddle of the problem, we can investigate further. for now it'll be moved to 2.0.\n. Closing for lack of progress.\n. We've talked about it before, but we haven't come up with many reasons to do this. Moreover, it's a matter of protection as well since the storage is deleted on garbage collection. If there are additional references to the storage object, then that's a memory leak in IE < 9\n. Not necessarily, when you destroy an element you also destroy its storage.\nOn Sun, Jan 8, 2012 at 5:11 AM, Andr\u00e9 Cruz <\nreply@reply.github.com\n\nwrote:\nI'm using mootools as the base library for a single page app, on top of a\nprivate MVCS framework.\nCorrect me if i'm wrong, but the garbage collection is only made on page\nunload right?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2193#issuecomment-3401520\n. Frankly, it's a few lines. I'm of the opinion (and favor) of everything being public. \n\nIf it's comforting, in 2.0 this point is moot since the Element can be subclassed and you can modify storage to your heart's content. (At least in theory, hehe.)\n. @cpojer @arian \nWhat do you guys think? A getter and setter method for storage? This way users/devs can add cloneStorage without modifying Moo.\n. Not necessarily. You could try using getComputedStyle, however.\n. I wouldn't mind it if there were helpers for the unit conversion that'd be\ninteresting. Expecting, however, that getStyle would return px values all\nthe time.. I'm not in favor.\nI am in favor, though, of a cross-browser return of the same value. Say I\ndefined the property as 3pt then I expect getStyle to return 3pt across\nall browsers. Is this the problem you're seeing?\nOn Mon, Jan 30, 2012 at 4:07 AM, pr3fect <\nreply@reply.github.com\n\nwrote:\nGood example @MrPrime but would you always want a \"px\" suffix on the\nreturned value? That could make further calculations a bit bloated as you\nalways need to run it through parseInt to get an integer value.\nFor example think of that you want to sum up margin-top and margin-bottom:\njavascript\n$('demo').css('margin-top') + $('demo').css('margin-bottom') // '13px0px'\nparseInt($('demo').css('margin-top'), 10) +\nparseInt($('demo').css('margin-bottom'), 10) // 13\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2196#issuecomment-3717099\n. Ok I'll reopen under the assumption that we'll have to add test coverage verify that oldIE is returning odd values.\n. Right this is by design. If you'd like to see 'example' you can use the second argument the custom type:\n\n``` js\nElement.Events.example = {base: 'keyup'};\n$('el').addEvent('example', function(event, type){\n// event.type == 'keyup'\n  // type == 'example'\n});\n```\nThis is used in delegation, I believe.\n. No, you don't have to live with it, but we could definitely use your help\nin creating a spec/coverage for this.\nDo you have a jsfiddle that causes the exception?\nP.S. It'd be cool if you shared (blog, etc.) how you're doing the remote\nerror logging. Perhaps a guest post on mootools.net.\nOn Tue, Jan 17, 2012 at 9:44 AM, RiZKiT <\nreply@reply.github.com\n\nwrote:\nWe are remotly logging javascript errors. One error which appears more\noften is:\n\nUncaught TypeError: Property 'scrollTo' of object [object DOMWindow] is\nnot a function\n\nand in the following code:\njavascript\nscrollTo: function(x, y){\n if (isBody(this)){\n   this.getWindow().scrollTo(x, y);\n } else {\n   this.scrollLeft = x;\n   this.scrollTop = y;\n }\n return this;\n},\nAfter investigating the problem I found out it is a result of a popup\nblocker for Chrome, which seems to overwrite scrollTo().\nDo you have any clever solution how to prevent that error, for example by\nchecking in core if typeof window.scrollTo() == \"function\", or set\nscrollTo() = function(){} when not defined? Or something else. Best\nsolution would be to check it only once, maybe at Window.implement?\nI can prevent the error from logging, but the error still occurs at the\nuser. Chrome cannot be ignored any more and popup blocker aren't that\nunusual these days. So I hope you don't say \"You have to live with it.\".\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2202\n. Thanks. I'll give this a go, when we come around to it. Thanks for the\nreference.\n\nOn Tue, Jan 17, 2012 at 11:10 AM, RiZKiT <\nreply@reply.github.com\n\nwrote:\nExecute the following in Google Chrome, with a popup blocker enabled /\ndisabled and watch the script console:\nhttp://jsfiddle.net/YgYL5/\nI used the first blocker in the chrome app store that i've found, named\n\"Better Pop Up Blocker\". I don't know which popup blocker our users have\ninstalled regularely, but that one seems to be quite common.\nI'm a bit lazy to write whole articles, but I already mentioned my\nsolution in a Google+ thread  with other JavaScript debugging tips here:\nhttps://plus.google.com/104431949275766772757/posts/N1qwzwuAZd1\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2202#issuecomment-3531406\n. doh! guess we'll get this fixed for 1.4.4, haha.\n. Rather let cancel means stop and reset, and for pause to be .. well pause. \n\nBtw, http://silkandspinach.net/2004/07/15/avoid-boolean-parameters/\n. IE6-7 some properties are readonly, such as width. Closing.\n. Could be. Just noticed the links are dead. When we get around to it, we\nshould decide to close or to investigate.\nOn Thu, Jan 19, 2012 at 6:09 AM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nI believe it's very difficult/impossible to access that stuff cross-domain.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2209#issuecomment-3561759\n. Did a quick search why Fx.CSS prevents the use of external stylesheets and it looks to be a fix for a previous bug:\n\nhttps://github.com/mootools/mootools-core/commit/20d4c46b2c8973bc349795efa2963d255c2413b0\nClosing as wontfix.\n. Yeah the Fx.CSS.Parser.Color is lacking parsing of rgba values. Moving this to 1.5 for considerations.\nWe could use Color.js (currently at More) to manage (parsing and encoding) of the color. That should support hsl, hsb, rgb, rgba etc.\n. Closing due to lack of update/interest.\n. Closing since low priority (IE6)\n. Take a note of: http://mootools.net/docs/core/Fx/Fx.Morph. It's known that you cannot use complex selectors\n. Yep, I saw the history and I want to revive it.\nI think that I'm with scott to run the mutators first.\nOn Thu, Jan 19, 2012 at 5:57 AM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nIt was marked as wontfix:\nhttps://mootools.lighthouseapp.com/projects/2706/tickets/642#ticket-642-10\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2216#issuecomment-3561609\n. If someone writes the PR and specs, it'll help us consider adding it. \n. See also: https://mootools.lighthouseapp.com/projects/2706/tickets/1226-response-cant-leave-script-tags-in-place\nHello,\nI tried to use Request for some ajax content insertion (Request.HTML did no better). When the answer contained a javascript captcha it was removed when I inserted the html (via innerHTML = ...).\nI had the choice between evalRequest and evalScripts to change this behaviour. evalRequest did what I want in Firefox and Safari:\nIt left the script tags in place so that I could do some magic to get them working again (innerHtml assignments don't really work with scripts).\nHowever - this evaluated the whole response which failed in Chrome because the response did contain html and not javascript. What I really wanted was something like evalScripts=false which leaves the script tags in place.\n\njavascript\nRequest.implement({\n    processScripts: function(text){\n        return text;\n    }\n});\n\nDid the trick for me but I think there should be another flag or something.\nBye,\n- CH\n. right, we need to verify the issue\n. Closing due to pending deprecation of really oldIE \n. @fabiomcosta do you remember how to reproduce the random crashes with toElement() ?\n. @arian is this something with should bother with? or let the devs deal with the exception handling. I'm leaning on the latter. \n. I agree with Tim's options. Here are my comments though on each (reference in order):\n- this will not be performant. Especially on mousemove. We can be specific to different type of events but we wouldn't be changing the paradigm. \n- We can accomplish a non-bc by wrapping new set time out (async) with compat block. Therefore this would be a 1.6.0 pr\n- I'd be OK with this as well. I've personally dealt with such cases in a per case basis. We could document the practice in the docs for 1.5.2\n\nIf docs on the best practice is enough let's do that for 1.5.2. If this is a huge burden on developers let's add async with compat block. I propose the former and keep an eye out for more requests. \n. Moved to MooTools More: https://github.com/mootools/mootools-more/issues/1099\n. Closing and moving to the PR.\n. Doesn't seem to be an issue anymore: http://jsfiddle.net/L7Tsc/1/\n. Moving to 1.5 since we can decide to throw an error during a dev environment or do as others and just ignore the call.\n. Confirmed. I'm guessing this is a Fx.CSS.Parser problem. Need to investigate further.\n. Yeah but the issue is narrowed to license docs. As long as the build process keeps the Core header then we are golden.\nIf someone builds, they should try to maintain the license as well.\nAnother option is to put the license information in the MooTools object like:\njs\nMooTools['license'] = 'MIT License';\nPlus any copyright information.\n. As @GCheung55 mentioned, you're still required to call callChain in order for the wait to execute. \n. I hope no one gets mad, but I've just merged it. Now to update the slick files locally.\n. Fixed: https://github.com/mootools/mootools-core/commit/a9c73cea2782eec366848328d303411d81769c6b\n. I believe the ticket said that Request was fine, but Request.HTML was leaking. I haven't verified the ticket, though.\n. Moved: https://github.com/mootools/mootools-more/issues/1097\n. (from a comment)\nAdditionally, elements within a div using CSS3 multi columns are also affected.\n. http://jsfiddle.net/q63535z8/1/\n. https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L629-632\nI believe that IE is considering any non-normative attribute (data-*) as an\nexpando. Those lines were added to prevent custom methods from being\nreturned. Looks like my spec coverage was too simple.\nFor now you can workaround this with:\njavascript\nElement.Properties['data-role'] = {get: function(){\n  return this.getAttribute('data-role');\n}};\n(I know) Not a great solution, since you'll need to repeat the above for\neach custom property that you've set. But it's temporary for 1.4.4.\nOn Mon, Jan 23, 2012 at 11:54 AM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nYou're right, also see http://jsfiddle.net/nbQEk/1/embedded/result/\n@ibolmo any ideas what has changed there that could've caused this?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2247#issuecomment-3618392\n. I'm going to get around to this one first thing tomorrow morning. I believe that adding a attr.specified check will alleviate the problem, but need to (thoroughly) test now.\n. Committed: https://github.com/mootools/mootools-core/commit/a9c73cea2782eec366848328d303411d81769c6b\n. Let's hold off on this. Let's rebase after we refactor .send see #2228\n. Fixes #2247.\n\n@arian this seems to be performant. At least a single hit, then cached for any further lookups. \n. @arian have another go pls :D\n. That's a great idea @arian and I'll add a github issue for enhancing the MooTools API for 1.5.\nI tried to augment the Slick.hasAttribute but there's a couple of problems. \n1. Slick doesn't need this fix. It's very -- very -- unlikely that anyone would check attribute with value of a function (the original problem). \n2. We don't use setProperty or removeProperty from Slick. Therefore it's very hard to whitelist dynamic properties.\nSo my initial idea of adding this code to Slick is out of the question. I think we'll have to wait for 1.5 to use a cleaner hasAttribute lookup and then return the property if we should\n. @arian when you're ready give me the :+1: or :-1:\n. @satazor we just merged this in master. If you have time, please investigate the 400ms gap (since 150ms or more is noticeable in the human eye).\nAlso please provide/advice us with the tests that you used.\n. :+1: looks good. thanks for the contribution, keep 'em coming :D\n. Well.. your isSuccess is being called and the success method of Request.JSON is being called. So I think the 204 related arguments are working as expected.\nWhether the success method should treat null as an error I think the behavior is as expected. Keep in mind Request.JSON is used to request: JSON hehe. Returning null in any kind of API is a bad API. Most RESTful APIs return an object with:\njavascript\n{},\n// or\n{\n \"data\": {},\n},\n// or\n{\n  \"error\": '...',\n  \"code\": 400\n}\n. :+1:\n. @arian @seanmonstar yep Element.get and Element.set do a good job.. I guess it's just a small enhancement:\n``` js\n$('id').set('data-role', 'value');\n$('id').get('data-role');\n$('id').set('data-' + prop, 'value');\n$('id').get('data-' + prop, 'value');\n// vs\n$('id').setData('role', 'value');\n$('id').getData('role');\n$('id').setData(prop, 'value');\n$('id').getData(prop);\n$('id').getData() // not possible atm\n``\n. Yeah JavaScript engines have never done a great job for helping the developer, but that's the derivative of having a runtime language. Worst that JS is so easy to manipulate e.g. (undefined =`).\nYour suggestion is valid, but not solvable in the near future. Perhaps in 1.5 or 1.6. I'll slate this for 1.5 and we can move it to 1.6. The solution is to use:\njavascript\nif (has('dev')) throw new Error('Cannot extend child class with an undefined parent class.');\nThis requires has support, which #2258 addresses (copied from Milk issues repo).\n. ``` javascript\nvar method = function(child, parent){\n  if (has('dev') && (parent == null)) throw new Exception('Cannot extend if\n parent class does not exist.');\n  // ...\n};\nmethod(new Class(), this['doh']);\n```\nget it yet?\n. I see @cpojer's and @timwienk's point. In the Extends: Case the JS parser will throw exception for RefereceErrors. \nMy example (updated) is about initializing options or arguments with undefined variables that are required for initialization of the class. \nI'm closing the issue. :D\n. ++\nExactly. Looking forward to has.js support in Core.\nOn Wed, Jan 25, 2012 at 12:11 PM, Sean McArthur <\nreply@reply.github.com\n\nwrote:\nTrue, in his example, it would throw a reference error, but here's an\nexample that wouldn't:\n``` js\nNamespace.B = new Class({\nExtends: Namespace.A\n});\n```\nAnd MooTools does this a lot (Fx, Drag, Request, etc).\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2257#issuecomment-3655680\n. I'm all for throwing errors in production, but I think the rest of the team\nmight disapprove.\n\nPerhaps in the cases you'd like this handled, we could implement a Logger\nthat could do remote notifications.\nOn Wed, Jan 25, 2012 at 12:19 PM, Sean McArthur <\nreply@reply.github.com\n\nwrote:\nForget has. Why should it only throw a decent error in development, and\nthrow an obscure error in production?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2257#issuecomment-3655843\n. This is an unintended consequence, but this is actually quite normal. \n\nAt the moment, however, 1.4.3 has a bug (#2247) caused by fix #2109. Closing for now, since this behavior is normal but circumvented with #2109 and #2247.\nJust be sure to use Element.get and Element.set, instead of el.attr = 'custom';\n. What do you mean by \"inspect\"? I'm using DebugBar and I'm not seeing extra\nattributes on the element.\nOn Thu, Jan 26, 2012 at 9:27 AM, Qballinternet <\nreply@reply.github.com\n\nwrote:\nSo it is normal that the body tag got the complete mootools source code in\nan $family attribute? and it seems that this is the issue with every\nelement on the page.\nI got such a weird problem on the project i am currently working on. It\nseems that an entire table refuses to paint/render itself on the page. No\nerrors though. I can set all the styles i want on the inserted table but\nnoting works. When i inspect with ie9 in ie7 modus the table is there, the\nstyles are set, but it does not render to the screen.\nthe reason i think it got something to do with this attribute thing is\nbecause i cant find any other weird things happen on the page.\nAnd something tells me that having the complete mootools source code put\nas an attribute on every element on the page does not make a page render\nbetter.\nany help would be greatly appreciated.\nIf this does not belong here; i just filed a request for joining the\ngoogle group, and am currently waiting for acceptance.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2259#issuecomment-3670532\n. Moving this to 1.5, and if necessary we'll move this to 1.6. This is dependent on #2133 getting done.\n. This (partially) fixes #2257, btw.\n. I've never been for failing silently in production, but 1.y.z has been released with that assumption. I think that without has.js we'd have to wait for 2.y.z to see MooTools throwing errors in live production.\n. http://jsfiddle.net/Qd7fb/20/\n\nOn Fri, Jan 27, 2012 at 3:29 AM, Miscellaneous <\nreply@reply.github.com\n\nwrote:\nhttp://jsfiddle.net/Qd7fb/17/\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2261\n. That's fine can you check that this works:\n\njs\nreturn (this.className && this.className.baseVal) || this.getAttribute('class');\nThis takes advantage of && properties. \nSee:\njs\nconsole.log((true && 1) || 'default');\nconsole.log((false && 1) || 'default');\nconsole.log((false && 0) || 'default');\nconsole.log((true && 0) || 'default');\n. Committed: https://github.com/mootools/mootools-core/commit/a9c73cea2782eec366848328d303411d81769c6b\n. Fixes #2175\n. I see your point, let me try to work on something for Element. The other problems are window and document.\n. Right, which is why I should not follow what Ajaxian said blankly and verify if we are :D haha. \n. Yep that should work. I'll try it out tonight\n. @arian any luck on this? \n. Ideas of? \n. Thank you. This is a known, and fixed issue in 1.4.4. We're releasing 1.4.4 early next week. For now you may regress to 1.4.2 or build from master. Oh, and use getAttribute as you've noted.\nSee #2247.\n. :+1:\n. Fixes #2236\n. Yes this has been fixed on master, and will go out today or tomorrow. Here's this for reference: https://github.com/mootools/mootools-core/issues/2247\n. Could you please provide us with the version of mootools and a jsfiddle (or\ncode) that reproduces the crash?\nOn Mon, Feb 6, 2012 at 10:46 PM, ilanle <\nreply@reply.github.com\n\nwrote:\nSCRIPT16389: Unspecified error.\nmootools-core.js, line 397 character 129\non this token:  var r=this.getBoundingClientRect(\nThis happens intermittently when dragging objects (script based on one of\nthe demos on this website).\nIt happens during drag (not on drop, not on enter, not on leave and not on\ncancel, but during the drag itself)\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2278\n. :+1:\n. Fixed: https://github.com/mootools/mootools-core/commit/e65e04b328ad8d6e70eb69eb7054ea8dfd68163a\n. @RiZKiT please give us a hand and test the master branch with your code. \n\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master\n. @jbgithub take a look at: #2301. That should solve your edge case. Please confirm.\n. It's a http://github.com/kamicane/packager comment block. You can strip them and the enclosed code out during the build.\n. Thanks @aaronmw, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2282.\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master\n. Thanks @karolis-k, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2282.\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master\n. @karolis-k you can use this one: http://mootools.net/nightly/build/mootools-core.js\n. Thanks @gimmel, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2282.\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master or use this nightly build: http://mootools.net/nightly/build/mootools-core.js\n. Thanks @mientjan, but this may be a known issue and recently resolved in the master branch. Please give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master or use this nightly build: http://mootools.net/nightly/build/mootools-core.js\n. Ok thank you, we'll take a look.\n. duplicate of #2297\n. nooo... bad\n. What'd Swiff ever do to you :(\n. I still think that MooTools Core should be the very low level implementation of things. It shouldn't be categorized by usage.\n. ```\nPlugins\n\nMore\nCore\nor\nPlugins\nUI | Futures | ART\nEssentials\n```\n. My definition of relevance is defined by association.\nI'm associating Core code as essential.. must have. If I ever need to work\nwith Flash I would/need to associate I would/should assume it's in Core..\nnot in More.\nOn Thu, Feb 16, 2012 at 3:37 PM, Arian Stolwijk <\nreply@reply.github.com\n\nwrote:\nBut it should by relevance.\nOn Thu, Feb 16, 2012 at 10:36 PM, Olmo Maldonado <\nreply@reply.github.com\n\nwrote:\nI still think that MooTools Core should be the very low level\nimplementation of things. It shouldn't be categorized by usage.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4009943\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4009973\n. I'd love Silverlight helper. Thanks for suggesting it. If anyone gets\naround to it we should have it.\n\nFYI:\nFile uploads, x-browser canvas or svg (see SVGWeb), Camera API...\nOn Thu, Feb 16, 2012 at 3:54 PM, Darren Waddell <\nreply@reply.github.com\n\nwrote:\n@arian YES! Also a Silverlight helper. Please make this a priority and\ninclude it in Core over other less useful features like event delegation or\nhardware accelerated animations.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4010330\n. What bytes are we saving?\n\nIf the issue is bytes, then the bigger issue is lack of\ninformation/education on how to build your own MooTools. A fundamental\nconcept since day one.\nOn Thu, Feb 16, 2012 at 4:02 PM, Rouven We\u00dfling <\nreply@reply.github.com\n\nwrote:\n:+1:\nLet's save some bytes. Those who actually use flash can get it from More.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2299#issuecomment-4010489\n. Moving this to 2.0 milestone.\n\nAfter discussing the practicality of moving Swiff to More, we've realized we'd seriously break backwards compatibility with 1.x. \n1. Packaging, right now some users require Core/Swiff and we'd have an upgrade script to replace with More/Swiff. Other option is to create an empty file with requires More/Swiff but this would cause a cyclical dependency on Core. Talked with @arian and it's too risky that packagers will know the right thing to do.\n2. The download page would need to be reworked -- again for including More things in Core for people that need the BC.\nA lot of headache for short gain in 1.x. For 2.x, however, we can discuss and fudge the locations as much as we'd like.\n. Try master. 1.4.2-1.4.4 fixed some leaks.\nHere are the instructions on how to build mootools:\nhttps://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master\nor\nuse the nightly: http://mootools.net/nightly/build/mootools-core.js\nOn Fri, Feb 17, 2012 at 1:48 AM, BooYaKaSha <\nreply@reply.github.com\n\nwrote:\nUnless there's something wonky about my setup, there seems to be a pretty\nserious memory leak when I do anything with the 1.4.x branch in IE7.\nI'm running IE7 on XP SP3 with the latest patches in VirtualBox. The\nproblem occurs even when running in \"Safe Mode\".\nWhen I include an older version of the library, i.e.\n\nAnd create a new HTML file and simply put something like this in the body:\n\nnew Element('div');\n\nWhen I open IE7 and keep the task manager visible, I can refresh over and\nover again and nothing happens -- on my setup memory use hovers around\n35-36MB after several dozen refreshes.\nHowever when I replace the library with anything from the 1.4.x branch\n(I've tried all of them including the nightly build), i.e.\n\nWhen I do the same thing -- go the page in IE7 with task manager open --\nwith each refresh the memory usage climbs. It doesn't take long before it\ntops 100MB. Eventually I need to kill IE via the task manager because it\nstops responding.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2300\n. Nightly is latest from master, but built at midnight (or so). If you're still seeing a leak, we'll have to investigate. \n. As much as I'd like to have this done prior to 1.5, I'd like for someone smarter than me to come up with a automated memory leak testing -- or someone brave to weather through this storm. \n. Closing due to inactivity. Send us a PR, if you have the chance. \n. The 0.05 diff will not be discernible? \n. If you pass a regexp, it'll use the regexp. If you pass a string it'll use the second argument to create the regexp: http://jsfiddle.net/vdp9D/2/\n\nworksforme.\n. hehe no worries. it could have been a real bug. you could try sending an email to the mailing list if you're unsure of, though:  https://groups.google.com/forum/?fromgroups#!forum/mootools\n. Thanks @Xirt, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2282.\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master or use this nightly build: http://mootools.net/nightly/build/mootools-core.js\n. Thanks @bootle, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2282.\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master or use this nightly build: http://mootools.net/nightly/build/mootools-core.js\n. Thanks @rsouthgate, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2282.\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master or use this nightly build: http://mootools.net/nightly/build/mootools-core.js\n. Thanks @Draghmar, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2282.\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master or use this nightly build: http://mootools.net/nightly/build/mootools-core.js\n. Thanks @laohan, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2286.\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master or use this nightly build: http://mootools.net/nightly/build/mootools-core.js\n. from your example you're not removing the original element. therefore\nyou're finding the original element. pls fix\nOn Thu, Feb 23, 2012 at 3:52 AM, karolis-k <\nreply@reply.github.com\n\nwrote:\nI clone element without keeping id, but it still can be found with\nselector using id in IE6 and IE7.\nPlease find an example here:\nhttp://jsfiddle.net/rmgVM/\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2310\n. Thanks, will take a look\n\nOn Thu, Feb 23, 2012 at 8:29 AM, karolis-k <\nreply@reply.github.com\n\nwrote:\nin IE6/7 it was capturing original element AND the clone (alert = '2').\nBut I updated it as you wish now and alert is '0' vs '1' in normal browser\nvs IE6/7\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2310#issuecomment-4137187\n. Moving discussion to the PR.\n. Thanks @matthiasstock, but this is a known issue and recently resolved in the master branch. Take a look at: https://github.com/mootools/mootools-core/pull/2282.\n\nPlease give us a hand and test the master branch with your code.\nHere are the instructions on how to build mootools: https://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master or use this nightly build: http://mootools.net/nightly/build/mootools-core.js\n. Just tested. Looks good! Thank you @arian \n. @fakedarren did you intend to move it?\n. Well I think that 'auto' should transform/normalize to a pixel value. Which API to use getStyle vs getComputedStyle? No idea. \nMight be worthwhile to introduce a getCSS to return the value in the stylesheet (or getStyleSheet)\n... \nor getStyleCSS\n. this.attributes also includes expando attributes such as this.inject. oldIE sucks :(\nBesides it's a one time hit\n. Need to check IE6, but I'm fairly certain that was the case. Otherwise, seems like a cleaner solution the way you propose.\n. The only special case is map right?\nmap: possible to return non-elements\nslice: all elements\nsplice: all elements\nclone: all elements\nflatten: all elements\nThen we can reduce the problem to:\n``` js\n['slice', 'splice', 'clone', 'flatten'].forEach(function(method){\n    var fn = Array.prototype[method];\n    Elements.implement(method, function(){\n        return new Elements(fn.apply(this, arguments));\n    });\n});\nElements.implement('map', function(fn, bind){\n    var result = Array.map(this, fn, bind);\n    return result.every(Type.isElement)) ? new Elements(result) : result;\n});\n```\nAnd add a note in Element.md about map.\n. Agreed, but then it'd be another special case to override after map.\n. @kentaromiura when you get the chance. can you rebase your commit, and I can review this again\n. @kentaromiura it's been a while, but could you rebase this. I'd also be interested in the Spec. I wonder how we could incorporate memory usage (leak) with our test processes. \n. pinging @csuwildcat once more\n. Assuming fixed. Reopen if still an issue.\n. Can you add a short description of the ie fix inlined in the code.\nAlso add space after if, and add an if statement instead of &&.\nI would have preferred as well if this was bug detected (like feature\ndetected ) instead of client sniffing.\nOn Jul 30, 2012 2:04 PM, \"Cristian Carlesso\" \nreply@reply.github.com\nwrote:\n\nIE7 clone node\n(http://msdn.microsoft.com/en-us/library/ie/ms536365(v=vs.85).aspx)\nhave problem when cloning element with id attribute stetted.\nYou can merge this Pull Request by running:\ngit pull https://github.com/kentaromiura/mootools-core bug-2310\nOr you can view, comment on it, or merge it online at:\nhttps://github.com/mootools/mootools-core/pull/2387\n-- Commit Summary --\n- fix bug #2310\n-- File Changes --\nM Source/Element/Element.js (9)\n-- Patch Links --\nhttps://github.com/mootools/mootools-core/pull/2387.patch\n  https://github.com/mootools/mootools-core/pull/2387.diff\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2387\n. Fixed?\n. Is this still an issue? Can you give us the specs on the Windows Phone?\n. Actually closing this since it's been merged.\n. Could you help us and run the latest specs against windows phone?\n. @brianedgerton once again, can you help us run the latest specs against your windows phone? \n. Thanks. I'm giving a week deadline on this and closing if ages further. Don't have WP access either. \n. Sorry I just thought of a little UX problem:\n\njs\nvar request = new Request({ url: '#' });\nrequest.getURL(); // null <-- oops!\n. Was there a failing spec? If not, we should have one that failed prior to the fix.\n. Right, and just try to run the specs against most browsers. I'm sure the rest of the team can cover any missing browsers before release.\nThanks @gonchuki .\n. It's always good. We might catch other typos in the process.\n. Great work. I'll review carefully soon, but with a quick look I'm concerned with getStyle it's starting to become a monster. \nI'd like for us invest some time to figure out a better (mutation? e.g. hooks) pattern for us to use.\n. Agreed on the comprehensive specs. A must have. I'll check the above when I can.\n. I got confused with https://github.com/mootools/mootools-core/pull/2409#issuecomment-7830010.\nAre the specs passing? What was your question? :D\n. If everything is green, then we can merge. @arian do you concur ;D\n. Done! Thanks @gonchuki and @arian \n. You should use CORS or use document.domain = 'www.' + document.domain to normalize the domains. \nSee the following: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Same_origin_policy_for_JavaScript\nBest practice, however, is to have CORS or to stick to one domain. \n. Well if the work has been done than go ahead.\nOn Sunday, July 6, 2014, Arian Stolwijk notifications@github.com wrote:\n\nClosed #2413 https://github.com/mootools/mootools-core/issues/2413.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2413#event-138550460.\n. Oh and this is definitely untested.. :D ala 1.0.x style (a \"kami commit\")\n. The reason I unrolled the https://github.com/mootools/mootoolscore/blob/cb327bf3/Source/Element/Element.Style.js#L216-232 is simply that it wasn't easy to read. \n\nMy logic is that we're no longer in 2000 when JS compilers were non-existant and that most people didn't bother to gzip .. CDNs are prolific now. \nLastly, I'm not done with Element.ShortStyle and Element.Styles. I think there's a lot of room to explore. To explore, I thought let's see all properties unrolled. \nI have some ideas with increased effort:\n1. Instead of defaulting to '@' we could default to '@px' in line: https://github.com/mootools/mootools-core/pull/2414/files#L0R86. That'll save a lot of bytes. I'm not sure, however, of the consequences. Need more test coverage.\n2. I was thinking we could do a BoxModel class that we can use to say contain this stuff. Especially rules about accepted input and marginTop-like (, borderTopWidth...) definitions that would be implicit to the model. Again, this is very vapor but I thought it might be interesting to see if it'll simplify development.\n3. Finally, if we decide that we don't need developers to understand the code we can save a lot of bytes by having a script that scrapes the w3 css definition and comes up with a literally mapping of the accepted input and the expected output. Notice that sometimes we map some outputs to px or convert rgba to rgb. That's really bad. or how we round floats ow.\n. Closing due to no longer relevant. If at any point we'll refactor this, we'll do so then.\n. Right, but this issue is what was brought up in: https://github.com/mootools/mootools-core/issues/2337#issuecomment-7941466\nTo reiterate.. should getStyle return the css definition? \nHere's a thought:\n``` js\nvar CSSStyle = function(element, value){\n  this.element = element;\n  this.value = value;\n};\nCSSStyle.prototype.toString = CSSStyle.prototype.valueOf = function(){\n  return this.value;\n};\nCSSStyle.prototype.toInt = function(){\n  // if not in px form, then some how compute the value\n};\n```\nTrying to keep compat with this toValue and toString magic, but I'm sure it's not 100%.\n. Moving to the PR.\n. See #2477\n. Closing this so we can discuss in the PR.\n. The owner should never do for in for an array. \n. Right, what I had meant to say is that the code is too brittle. At some point you should check for NaN and ensure it's not added to the dictionary. Regardless, it's not MooTools problem. You should only use for in with Objects.\n. Are you using sub pixels when setting the left and top?\n. Update the PR to use String.toFloat instead. \n. This is going to be on hold, until we get a spec to check for this. You're welcome to add one yourself, or wait about a week to get a hold of the pending PR that reduces the complexity to test MooTools.\n. Moving to the PR.\n. Closing since it's duplicated to #2551\n. No recall, no merge. Provide a jsfiddle that shows this is a problem.\n. Related #2236, #2531 \n. Sorry, but this is becoming less of a problem IE9+ and likely we'll never refactor Storage until 2.0. So.. not any time soon. If it's really important, I invite you to go ahead and make a PR and we can review your changes. \n. Without any code you're grasping at straws.\n. If you can find the 'hacked' version, I'm curious to see what it is.\nOn Thu, Feb 14, 2013 at 2:34 PM, swhiteman notifications@github.com wrote:\n\nThen the infection (if there was one) was either in the YooMotion template\nitself or in the version of MooTools they were distributing with the\ntemplate. Because Moo's license allows it to be freely distributed, authors\ntend to include a copy their whatever template/library instead of telling\nyou to download it yourself. Just like you can create your own fork on\nGitHub called \"MooBetter\" that is totally malicious (until people figure it\nout).\nAnyway, nothing stops a hacked site from serving up a hacked version of\nMoo and/or hacked version of their template, and you won't be any the\nwiser. I always download from MooTools.net myself and delete links to any\nother versions in libraries I use, but this is unenforceable on a wide\nscale because it means templates aren't \"plug and play.\"\nI still would doubt that a person who pwned a site would attack the\nbundled MooTools library and not the template unless there was some reason\nthat the vulnerability only allowed them to upload new files or something.\nThough igetting a hacked Moo in the wild might mean a better payoff down\nthe line.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2472#issuecomment-13576960.\n. Closing due to inactivity.\n. I'm going to defer this for 1.6. This may resolve itself with #2503.\n. This is related to conflicting Array methods in the elements. Use $$(...slice(-1)).getElements...\n. 1. Should we allow the typeOf check for an array and help them by join('') I'd argue we should use toString.\n2. Should we check for stylesheet? Shouldn't the developer know what they're suppose to set. In that case, I'd expect to help them in set('text') case. ~~Is this a known issue for IE8 for set('text')?~~\n\nRe: 2. Should we ask them to use set('text') or set('html') I think the former. Regardless, we'll need a PR with the suggested fix after reviewing 1 and 2.\n. If we use set('text'), then we can enable a more complicated polyfill for\nthe future?\nOn Mon, Mar 3, 2014 at 9:31 PM, swhiteman notifications@github.com wrote:\n\nShould we ask them to use set('text') or set('html') I think the former\nEither should be acceptable. Remember the W3C says STYLE elements may\nhave child elementshttp://www.w3.org/html/wg/drafts/html/master/document-metadata.html#the-style-element,\nleaving room for an XML-based styling language (imagine putting XSL inside\nSTYLE). Plus, even with text/css you can legitimately have multiple text\nand comment nodes inside STYLE -- it doesn't have to be \"flat.\" IMO, if the\n'html' happens to be flat, it should definitely work, and even if it,\ndeliberately or accidentally, has tags, 'html' should still work.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2479#issuecomment-36588852\n.\n. Yep. Update, add the docs, add the specs. and We'll ship it soon \u2122\n\nOn Mon, Mar 3, 2014 at 9:45 PM, swhiteman notifications@github.com wrote:\n\nYeah, I guess that'll do. More now, the better!\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2479#issuecomment-36589470\n.\n. MT means free as in beer. Although we do our best to provide the best code,\nand experience. Your mileage will aways vary.\n\nOn Tue, Mar 19, 2013 at 11:23 PM, Boris Cherny notifications@github.comwrote:\n\n@fakedarren https://github.com/fakedarren thanks for the quick\nresponse! If you're not maintaining the code anymore, maybe move it to a\n\"legacy\" module, or add a message to the build page that it's no longer\nbeing patched? When I use something like MT, my expectation is that it's\nbulletproof; if not, it would be nice to have some sort of indicator as a\ncourtesy :)\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2480#issuecomment-15157729\n.\n. If you provide a PR with the addition, we can review the changes. Closing for now due to inactivity. \n. After reading https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest#open()\n\nLooks like we should deprecate the if (this.options.user and just have a withCredentials option. Could you modify your PR so that it reads:\n``` js\n if ((/<1.4compat>/this.options.user || /1.4compat/this.options.withCredentials) && 'withCredentials' in xhr) xhr.withCredentials = true;\n```\nWe'll also need a spec to ensure that:\n1. withCredentials is set for 1.4 compliance for this.options.user usage\n2. withCredentials is not set for 1.5 for this.options.user usage\n3. withCredentials is set for this.options.withCredentials is true\n. Awesome. Just waiting on Travis CI, but afterwards will merge.\n. Ahh, and just nit picking but could you add a note in the Request.md documentation?\n. I'd like to say that if we could we would support 1.2.x, but we we're not in that capacity at the moment. I hope that you would use the compat layer, changes, and other blog posts to move your code to at least 1.3.x. \n. May this shine some light in the situation.\n. Yes filter with hasOwnProperty\n. Browser feature detection has been deprecated\n. We should use Syn.js to simulate the typing, and make sure we're getting out the right values. This would minimize future changes like this. \n. Just missing the spec based on http://jsfiddle.net/2zsNV/5/\n. I'm trying to conceive of another addEvent('...') that fires immediately if the condition has already occurred. E.g. 'click'. Since it never happen, I'd have to agree that the onus is on the developer to understand their environment. If their environment implies that the DOM would already be ready, then the check should be against document.readyState else fall back to window.addEvent('domready', ...). And this is outside the scope of Core. Closing for now, but if you have a better case for it we can revisit.\n. Why not just clear the headers prior to sending? \n. We should default to using getBoundingClientRect\nOn Tue, Mar 4, 2014 at 2:39 AM, Aicke Schulz notifications@github.comwrote:\n\nHow about that solution? http://jsfiddle.net/RiZKiT/NAa92/\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2506#issuecomment-36602564\n.\n. The example you provided is contrived. ... I don't understand the application of what you're adding. \n. Hey folks. Any updates on this?\n. If you could supply a jsfiddle, it'll help us create a test case to check against.\n. If the object is enumerable, shouldn't that be the expected behavior? Array.from(Enumerable) == Enumerable Similar to Array.from(arguments) == arguments\n. I've never liked the casting to array for arguments. I just noticed this is for mootools-core. I would hope for 2.0 we wouldn't allow this kind of behavior. (ping @arian)\n\nIn this case, I'd have to side with you just because 1.x we liked to do as you described. \nHowever, in the future we should ask that arguments be defined in array format. Which would also reduce an unnecessary function call.\nIn other words:\n``` js\n// now\nelement.fireEvent('click', fuzzyVariableWhichMayMeanArgumentOrArrayOfArguments);\n// to a cleaner interface:\nelement.fireEvent('click', [obviouslyThisIsTheFirstArgument]);\n``\n. Double negative! :dancers: \n. Let's assume fireEvent should be passed an array. Onus of the dev.\n. Could you provide a jsfiddle showing the error? It's not very clear what is causing this.\n. Closing due to inactivity. \n. Usename=\"myfield\"instead ofname=\"myfield[]\"`\n. I'm a little confused on what you'd like for us to do. Could you do a PR on what you'd like the Docs to read as?\n. No, thank you ;)\nOn Wed, Mar 5, 2014 at 7:24 AM, JSchortz notifications@github.com wrote:\n\nThanks Olmo!\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2515#issuecomment-36741210\n.\n. Sorry but we don't play with others. I'm setting as willnotfix for now, but if you provide instructions on MicrosoftAjax we may consider helping in resolving this. \n. ~~FF 28 & 29? People still use those browsers? :)~~\n\nNevermind. Looking at:\nhttp://clicky.com/marketshare/global/web-browsers/firefox/\nFF 29 is still viable. For some reason I thought we were already in the 30s\nfor FFx.\nOn Wed, May 21, 2014 at 7:44 AM, Arian Stolwijk notifications@github.comwrote:\n\nNo, you're right :)\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2517#issuecomment-43748961\n.\n. Though, it's concerning that this PR is green via Travis CI. \n. :)\n\nOn Wed, May 21, 2014 at 8:18 AM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@ibolmo https://github.com/ibolmo Travis is green because there is no\nspecs checking for this, and Travis is only checking PRs with PhantomJS.\nAbout the specs missing, it wont be for long!\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2517#issuecomment-43752513\n.\n. Provide a JSFiddle showing this issue please.\n. Closing to move discussion to the PR.\n. Missing specs which check for fill support.\n. You'll add the specs here: https://github.com/mootools/mootools-core/blob/master/Specs/Element/Element.Style.js\n\nShould be much easier to contribute specs after the massive re-do to our testing platform. Let me know (us) if you still need some guidance.\nTY!\n. No you're falling back to the attributes: width and height. This is not using getBoundingClientRect.\n. Thank you for your fix, but could you provide a jsfiddle showing that the focus does not work. \n. Apparently there's this workaround: https://gist.github.com/nuxodin/9250e56a3ce6c0446efa\n. I'll keep it open, since we need spec coverage for this. We may expect to fail, but at least someone a lot of smarter than us could potentially figure out a solution. \n. I'd still like it spec'ed and documented.\nOn Sat, Feb 22, 2014 at 7:58 AM, Hristo Chakarov\nnotifications@github.comwrote:\n\nI'm not sure MooTools should provide a solution. It's a core browser\nissue. Technically speaking, for the browser a element is enumerable. It's\nan array-like object, just like NodeList, Arguments, etc.\nArray.prototype.push.call( $('select'), new Element('option', { text : 4\n}) ); // works like a charm - new element is injected to the\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2525#issuecomment-35803154\n.\n. setOptions clones objects to dereference them. Provide a jsFiddle showing a problem.\n. I'm closing this since there's no immediate plan to support this. If we do adopt moofx3, you'll automagically get this.\n. I disagree. I prefer API with semantics. getParent(2) means what? Get 2\nprevious parents? get parent with the 'tag' 2? what if your code had an\nerror, like:\n\njs\nelements.each(function(i, el){\n  root.getParent(i).doSomething();\n});\nIf we accepted the convention of using numerical to access number of\nprevious parents, we'd allow bad code to run.\nMoreover, just use getParent('#id') if you want a specific parent.\nOn Wed, Oct 2, 2013 at 7:13 AM, Tin LE GALL notifications@github.comwrote:\n\nMight be useful & faster, don't you think ?\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2530\n.\n. Closing since #2503 would fix this.\n. JSFiddle or it didn't happen.\n\nI'm not entirely sure what you're trying to do. One easier solution would be to require you to turn the Date into an integer, and back. For now I'm closing since the latter is easier, and your case is too specific.\n. Fixed in #2563 \n. Dup of #2210\n. This belongs in Slick :-\\\n. I'm closing this since timwienk is providing a shorter/cleaner version. You'll get credit, though, for starting the effort.\n. @arian if you'd update the PR to the latest master, this would prob. go in 1.5\n. I'm sure I'm just running by this too quick, but I totally don't know what you'd like to happen :). Could you provide me with a table or even better a couple of failing specs showing what to expect?\n. Lol so leave open or close?\n. Alright thanks folks.\nOn Mon, Mar 3, 2014 at 5:23 PM, Cristian Carlesso\nnotifications@github.comwrote:\n\n@ibolmo https://github.com/ibolmo despite the fact that the guy closed\nthe issue, I'll investigate it a bit further, not now though 'cause I'm\ngoing to sleep, keep it close for now, I'll reserve to re-open it later if\nit's a problem.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2544#issuecomment-36574027\n.\n. Haven't validated if this will be useful, but perhaps if you add examples to the docs, and specs to test for the new option it'll be clearer.\n. You're missing docs and specs for this addition.\n. Should be fixed now. Reopen if still an issue.\n. I'm moving this to 1.5.1 since we've never done something as kind as to go back to previous versions. I would like to start trickling down major fixes, however. \n. 1.5 it is. ;)\n. I apologize to @gonchuki for this great work. I believe going forward 1.2 is now implicitly deprecated/EOL. \n. This would break BC. I suppose the sensible option is to put secure on, and allow them to turn it off when they trust the source. You'll need to supply, though, an entry in the 1.4compat layer, and spec coverage that checks:\n- secure is the default option\n- secure is working (e.g. JSON.decode('alert(...)') returns null)\n- secure and setting it to false would still decode\n. 1.5base, and I don't know but just looking at the code we default for JSON.secure\n. Right I meant the following:\n\n| secure | JSON.secure | expected result |\n| --- | --- | --- |\n| null | -- | secure |\n| null | false | not secured |\n| null | true | secure |\n| false | -- | not secured |\n| false | false | not secured |\n| false | true | not secured |\n| true | -- | secured |\n| true | false | secured |\n| true | true | secured |\nBut since we'll add a JSON.secure = true;\n| secure | JSON.secure | expected result |\n| --- | --- | --- |\n| null | true | secure |\n| null | false | not secured |\n| null | true | secure |\n| false | true | not secured |\n| false | false | not secured |\n| false | true | not secured |\n| true | true | secured |\n| true | false | secured |\n| true | true | secured |\n. If you do if (secure == null) secure = JSON.secure; would be enough to\nmeet all requirements.\nOn Fri, Feb 21, 2014 at 4:18 PM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@ibolmo https://github.com/ibolmo the JSON.secure is a bit weird. It\nwas added in c04d545https://github.com/mootools/mootools-core/commit/c04d545939d4c1c1287a448d947a142ed05b7f80and I find no other reference to it in all Core & More files.\nIt is not documented in the docs either afaik.\nSo if we add JSON.secure = true; it has to be added to the docs and\ndevelopers wanting to use \"the eval way\" would have to make a double true.\nOn the function parameters and a JSON.secure = false;\nI'm ok with both adding it and leaving it out (i.e not adding JSON.secure\n= true;).\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2562#issuecomment-35779794\n.\n. 1. You would need to edit if (secure || JSON.secure){ to: if (secure){\n   and you're done.\n\nEven if it's undocumented, we've had people use undocumented interfaces and\nwhen we changed them they came back to us upset. It's small work to make\nsure that folks get consistency between minor versions.\nOn Sat, Feb 22, 2014 at 1:19 AM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@ibolmo https://github.com/ibolmo , thanks for your time checking this!\nI'm still not sure I follow you. I see 3 scenario:\n1- Adding both JSON.secure = true; and if (secure == null) secure =\nJSON.secure;\nThis means default behavior is secure. And to make it un-secure user has\nto use JSON.secure = false; which is not documented.\nIf user uses JSON.secode(string, false); as documented, that alone would\nturn to true anyway because of JSON.secure = true;.\n2- Adding just JSON.secure = true; (and keeping if (secure == null)\nsecure = true;)\nThis means default behavior is secure. But to override it and go un-secure\nuser needs to use double false:\nJSON.secode(string, false);\nJSON.secure = false;\n3- Using as it is now, in the PR. ( and the right one in my logic)\nThis means default behavior is secure. To override user would use, as\ndocumented already, just JSON.secode(string, false);\nJSON.secure seems to be kind of a backdoor/alternative, not documented.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2562#issuecomment-35796783\n.\n. Do a git rebase -i ibolmo/master\n\nOn Tue, Feb 25, 2014 at 1:42 AM, Sergio Crisostomo <notifications@github.com\n\nwrote:\nThis PR has to be refactored after Olmo's new Specs PR is merged.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2562#issuecomment-35982505\n.\n. Yeah you have the right idea.\n\nOn Tue, Feb 25, 2014 at 8:59 AM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@ibolmo https://github.com/ibolmo will do that.\nDo I still need the package.yml and Configuration.JS files?\nI see also a new directory structure without /1.5base/ so I suppose the\nmootools-packager script goes forEach directory inside the Specs and the compat\nlayerhttps://github.com/ibolmo/mootools-core/blob/master/Specs/Element/Element.js#L239-L243info goes inside under the respective specs\n.js file, with compat comment tags when needed.\nI run the specs adding my new JSON.js specs to the one on JSON.js specs\nfile from your repo and they worked good with grunt.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2562#issuecomment-36015625\n.\n. One little gotcha, but yep it's :+1: \n. FYI this is just the start. I'm doing a PR so that we can all start working on fixing the specs. \n. Slick related issues should go to: https://github.com/mootools/slick/issues\n. Rather than using English (because it's late). Here's what I'd expect:\n\n``` js\n//<1.4compat>\nBrowser.ie = true;\n//1.4compat\nBrowser.modernie = true;\n```\nCompat build:  Browser.ie is as you'd expect in 1.4, 1.3, and so on.\nNoncompat build: Browser.ie is null for IE11, but they can use modernie if\nthey wanted.\nOn Fri, Mar 7, 2014 at 1:49 AM, Tim Wienk notifications@github.com wrote:\n\nNo it doesn't, as we discussed yesterday, the IE fix was added the way it\ncurrently is (always using Browser.modernie for IE>10), because Browser\nSniffing is to be phased out / deprecated. Adding another layer of\ndifferent functionality would only make for more confusion.\nDocs need to be changed though. :-)\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2567#issuecomment-36974770\n.\n. - Option 4 (basically same of Option 2 without the need for modernie):\n  - For compat build (default build) Browser.ie is null. \n  - For noncompat build (for us ninja folks) Browser.ie is true.  (No need for Browser.modernie). \n. My reason for Option 4 is simple:\n\nFor 99.9% of the folks nothing will have changed with the compat build (the default build). For the 100% of the developers like me that want to know if my user is on an Internet Explorer browser all I want to do is:\njs\n if (Browser.ie) alert(\"I'm a Google Chrome fanboi, why don't you switch.\");\nInstead of:\njs\nif (Browser.ie || Browser.modernie) alert(\"... sucks that I have to try other flags :-\\\");\nIn other terms: our Browser.<name> API just says what browser we're on. Folks that are using it (even we're at fault at some point) for feature detection are using it for the wrong purposes.  Yes let's advocate for not using Browser.<name> for feature detection but let's not cripple our API for the rest of us that know what we're doing. \nAgain, for folks that are not up to date with the best practices and maintain their code can just use the compat version which Browser.ie returns null. No difference from 1.4.5 and 1.5. Now I'm just arguing that we don't need to add unnecessary flags or logic. Just fix Browser.ie as it should be, and put the responsibility of using the right code/practices to the developer -- as it should be. \n. > So the question is: do we have any legitimate reasons for why somebody  would want to put IE11 in the same bag as old IE?\nTo me it's about semantics and consistent API. If we welcome the idea of crippling our APIs we might as well start doing $('#this-kind-of-crap').\n\nIf not, then what's wrong about making it more difficult for fanboys and bad coders alike?\n\nAlso, I'd hate to think we are designing our code so that we avoid fanboys and bad coders. From day one MooTools has been for the power user. Yes we picked up a few bad coders, but they don't justify to bend to their (bad) will. \n. Here's an idea of a legitimate use case. Alex Russell has talked about caching feature detection by using user sniffing (http://infrequently.org/2011/01/cutting-the-interrogation-short/). If we cripple Browser.ie someone (in the future) would have to look for Browser.ie and Browser.modernie and to be future proof will likely check for:\n- Browser.modernchrome\n- Browser.modernfirefox\n- Browser.randomPrefixOpera\nAgain... consistency folks. \n. I have no idea wtf you just said. Then again I'm already in 2 wine bottles.\n-- ftw.\nOn Fri, Mar 7, 2014 at 11:49 PM, Aaron Newton notifications@github.comwrote:\n\nHistorically I've been Mr. No Breaking Changes and a strong advocate for\nnot changing our api with every release (I hate typeOf instead of $type -\nthat shit's arbitrary breakage). But in this case our main goal should be\nto avoid breaking bunches of stuff (so people don't upgrade because of a\n\"bad\" release) even if it means making an inconsistent API for the short\nterm. We're already agreed on deprecating all the browser stuff so\ninvesting in api consistency makes little sense. The only reason that\nBrowser.ie is being worked on is to provide compatibility in 1.5.1 and\nbeyond. We need to fix it, yes, but fixing it here isn't making a stronger\nAPI; it's NOT breaking code out there in the wild.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2569#issuecomment-37090140\n.\n. psst. you mean minor :P\n\nOn Mon, Mar 17, 2014 at 5:33 PM, Cristian Carlesso <notifications@github.com\n\nwrote:\nno, this is a breaking change, so it must be in a major version.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2582#issuecomment-37879467\n.\n. normal build is compat build. e.g. 1.X capable.\n\nfor us wizards we can do no-compat. e.g. 1.5.0 only build which should drop\nthese blocks.\nSo as long as we don't BC (by adding the packager blocks) then we can add\nthis to 1.5.x\nOn Mon, Mar 17, 2014 at 5:57 PM, Cristian Carlesso <notifications@github.com\n\nwrote:\nwe are removing Browser sniffing from the normal build, that is breaking\nenough\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2582#issuecomment-37881461\n.\n. I agree with Arian. UA sniffing has some legitimate uses, and seems\noverkill to remove it entirely. See jquery.ismobile discussion. People have\nto resort to a 3rd party plugin when it's simple to UA sniff.\n\nOn Thu, Mar 27, 2014 at 3:24 PM, Arian Stolwijk notifications@github.comwrote:\n\nI don't think we should remove all of Browser. Browser detection can be\nuseful, statistics, helping users. Of course it should not be used for\nsniffing.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2582#issuecomment-38856024\n.\n. It's right as compat. The idea being that the regular joe schmoe\ncould/would use the grunt task without RTFM. For us ninja joes we can\nprobably julienne our builds.\n\nSorry with the puns. ;)\nOn Tue, Apr 8, 2014 at 6:26 PM, Arian Stolwijk notifications@github.comwrote:\n\nActually, I think default should be nocompat...\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2591#issuecomment-39913726\n.\n. Moving those lines I think you'll get some odd edge cases. The reason\nmoving that line works is that callChain calls the opacity forcably. If you\nfollow the path on the second call the this.check is returning (true) on\nthe inherited Fx.Style but (I believe) false in the root Fx class. We need\nto investigate if Fx.CSS prepare is returning the expected values.\n\nOn Thu, May 22, 2014 at 2:55 AM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@arian https://github.com/arian @kentaromiurahttps://github.com/kentaromiura\n@ibolmo https://github.com/ibolmo @timwienkhttps://github.com/timwienkdo you see any down-side of changing these\ntwo lineshttps://github.com/SergioCrisostomo/mootools-core/commit/4f9ff334f29fd09d9df2b3353124a45803ecac6e?\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2593#issuecomment-43858454\n.\n. Is this not resolved?\n. 3 line change gives the same result, without the need for a lot of logic in core.\n\n``` js\nvar Criteria = new Class({\n    Implements: [ Events ],\n    change: function(){\n        if (!this.disabled) this.fireEvent('change', this.getValue())\n    },\n    reset: function(){\n        this.disabled = true;\n        Object.each(this.criteria, function(criterion){\n            criterion.reset();\n        });\n        this.disabled = false;\n        this.change()\n    }\n});\n``\n. Include an update to Gruntfile.js to create thedist/*.js` files.\nOn Tue, May 20, 2014 at 5:27 PM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@DimitarChristoff https://github.com/DimitarChristoff +1!\nCould you send a PR for that and with it close #2548https://github.com/mootools/mootools-core/issues/2548? would be very nice...\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2596#issuecomment-43691508\n.\n. Well nothing against his shell script, but ideally there should be one tool\nfor building. That's what grunt is all about. I don't care either way,\nthough. I was just suggesting that we already build temporary files we\nmight as well put them in dist/*.js\n\nOn Sat, May 31, 2014 at 11:15 AM, Sergio Crisostomo \nnotifications@github.com wrote:\n\nWe could build those 4 files from the automagical\nhttps://github.com/mootools/mootools-core/blob/master/tag-release shell\nscript that @timwienk https://github.com/timwienk just made? Otherwise\nmaybe a release hook\nhttps://developer.github.com/v3/activity/events/types/#releaseevent\nrunning a new task in the gruntfile.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2596#issuecomment-44752282\n.\n. Note your change would be ... tween.start('opacity', method) right?\n\nQuestion 1: Nope. if else is more expensive than a simple conditional. \nQuestion 2: I'd say we drop it, but add a compatibility block just to be sure. \nQuestion 3: I'm not looking at the source, but I would expect that setOpacity should be called by Fx.Tween. If not we have an issue there. If setOpacity is being called then Element.Style already checks for the need to set visibility. \n. I'm confused. Why isn't this working already. Looking at Fx.CSS.js and\nrender:\njs\nrender: function(element, property, value, unit){\n element.setStyle(property, this.serve(value, unit));\n},\nTherefore visibility should be taken care of because of:\n``` js\nsetStyle: function(property, value){\nif (property == 'opacity'){\n if (value != null) value = parseFloat(value);\nsetOpacity(this, value);\nreturn this;\n }\n```\nand\njs\nvar setOpacity = (hasOpacity ? function(element, opacity){\n element.style.opacity = opacity;\n} : (hasFilter ? function(element, opacity){\nif (!element.currentStyle || !element.currentStyle.hasLayout)\nelement.style.zoom = 1;\n if (opacity == null || opacity == 1){\nsetFilter(element, reAlpha, '');\nif (opacity == 1 && getOpacity(element) != 1) setFilter(element, reAlpha,\n'alpha(opacity=100)');\n } else {\nsetFilter(element, reAlpha, 'alpha(opacity=' + (opacity * 100).limit(0,\n100).round() + ')');\n }\n} : setVisibility));\nOn Mon, May 26, 2014 at 5:45 PM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@ibolmo https://github.com/ibolmo, you were right about the \"note\", i\nedited/corrected above.\nAbout visibility, it's tricky I think.\nOne option is to add this line under, inside the stop: method of FX.js,\njust before the complete events starts to fire (herehttps://github.com/mootools/mootools-core/blob/master/Source/Fx/Fx.js#L104\n):\nif (this.to && this.to.opacity) this.element.setStyle('visibility', this.to.opacity[0].value == 0 ? 'hidden' : 'visible');\nThis will also be applied in other tween of opacity, not just fade.\nAnother option would be based on the one above, but adding a flag on\nthe storage, and retrieve and reset inside the stop: as above. This would\navoid visibility been set when !fade\nOtherwise I see only the \"chain option\" as is in the PR, based on what\n@arian https://github.com/arian added to solve past problems; i.e. that\nthe setStyle('visibility') is passed into the chain to be ran at the end,\nthought after the complete event is called which is not so good.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2597#issuecomment-44222119\n.\n. Let's wait on @arian but I'd say drop the visibility. If we dropped it in\nElement.setStyle then we should drop it here too.\n\nOn Tue, May 27, 2014 at 6:42 AM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@ibolmo https://github.com/ibolmo setOpacity does not currently set\nvisibility in browsers with hasOpacity or hasFilter. The fade is\ncurrently the one to do this by adding a setStyle('visibility') in the\ntween.chain. This was added herehttps://github.com/mootools/mootools-core/commit/11b4257f12a51454bd513ab1ac32cd5239d66098\n.\nIf we change this behaviour, so that when setStyle('opacity') is called\nvisibility is also set, then these aditionshttps://gist.github.com/SergioCrisostomo/fccda619ca4cbd23a218(marqued with\n+) would do the job (specs looks green) and could be used use the new\nre-factored code posted above. This idea to always set visibility was\nabandoned beforehttps://github.com/mootools/mootools-core/issues/2074#issuecomment-2114173.\nSo setStyle should only change the actual prop passed.\nIf we set visibility only when fired from a fade, here is my suggestion\n(http://jsfiddle.net/ZzZEF/), based on Olmo's refactor and @arianhttps://github.com/arian's chain idea:\nfade: function(method){\n    var tween = this.get('tween');\n    if (!method || method == 'toggle') method = this.getStyle('opacity') ? 'out' : 'in';\n```\n//<1.3compat>\nif (arguments.length == 2) {\n    tween.set('opacity', arguments[0]);\n    tween.start('opacity', arguments[1]);\nreturn this;\n\n}\n//1.3compat\nif (method == 'in') tween.start('opacity', 1);\nif (method == 'out') tween.start('opacity', 0);\nif (method == 'show') tween.set('opacity', 1);\nif (method == 'hide') tween.set('opacity', 0);\nif (typeof method == 'number') tween.start('opacity', method);\nvar to = tween.to[0].value, visible = this.getStyle('visibility') == 'visible';\nfunction changeVisibility(value, $tween){\n    if ($tween.$chain.length){\n        $tween.chain(function (){\n            this.element.setStyle('visibility', value);\n            this.callChain();\n        });\n    } else {\n        this.setStyle('visibility', value);\n    }\n};\nif (to && !visible) changeVisibility.call(this, 'visible', tween);\nif (to == 0 && visible) changeVisibility.call(this, 'hidden', tween);\nreturn this;},\n```\nWould be nice to have @arian https://github.com/arian looking at this\nrefactor since he was the one to fix the opacity only setting visibilityif fired from a\nfade\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2597#issuecomment-44264753\n.\n. Based on that I would say we should add:\n\nWarning pseudo\njs\ntween.addEvent('complete', function(){\n  (opacity == 0) ? hide : visibile;\n});\nOn Tue, May 27, 2014 at 8:12 AM, Tim Wienk notifications@github.com wrote:\n\nIf I recall correctly, we made the \"stop setting visibility in setStyle\"\nchange for 1.4.0, which was a logical change. But then we had to very\nquickly release 1.4.1 to fix fade, because our implementation of that\nalways set visibility to hidden after fading opacity to 0 (arguably makes\nsense to do that anyway, fade is more than just a \"change style\"\noperation).\nI wouldn't be in favour of \"just\" dropping the setting of visibility in\nfade, expecting problems if we do. We should first investigate if we want\nto do such a breaking change. #2074https://github.com/mootools/mootools-core/issues/2074and\n2081 https://github.com/mootools/mootools-core/pull/2081 provide more\ncontext.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2597#issuecomment-44273686\n.\n. After the space is cleaned, this LGTM. I think we can invest more time in this, but it's something that I think we can revisit when we refactor for 1.6.\n. Yeah this is missing a spec to cover this. Preferably if we could cover other events too, but I'd accept one to cover just this one.\n. @kentaromiura or @SergioCrisostomo if you can update PR (or submit new one to replace this one) to the 'latest' I can review tomorrow. It's a little difficult to follow with references. \n. FYI,\n\nThis is a temporary solution. The real solution is to drop the php packager\nand only use the grunt-mootools-packager. Then we can regress this. Since\npackage.yml should be deprecated as well.\nOn Sun, Jun 1, 2014 at 4:37 PM, Cristian Carlesso notifications@github.com\nwrote:\n\nlike @SergioCrisostomo https://github.com/SergioCrisostomo says before\nthis change the grunt build took files using the glob resolution order\nSource/*/.js,\nsince the website continues to use the php packager, we had different\nfiles orders from the website and the grunt build, which makes the diff to\nthose files impossible.\nIdeally the output should be the same anyway, to avoid forgetting to add a\nnew source file in the package.yml.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/pull/2603#issuecomment-44790154\n.\n. Yes. The issue is that the docs are not OO. ;)\n\nOn Mon, Jun 2, 2014 at 2:49 PM, Arian Stolwijk notifications@github.com\nwrote:\n\nActually, it's (implicitly) documented here:\nhttp://mootools.net/docs/core/Core/Core#Type:implement\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2606#issuecomment-44882461\n.\n. I'd say well need a PR to review and have CI test against.\n\nOn Thursday, July 3, 2014, Cristian Carlesso notifications@github.com\nwrote:\n\n@ibolmo https://github.com/ibolmo I'm not sure this should be closed tbh\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2607#issuecomment-47879497\n.\n. I'm not familiar with jQuery, but does it automatically do the emulation?\nIf so, is your backend checking for this added header.\n\nAlso, what is your backend telling you? Comes in as POST, DELETE, or GET?\netc?\nOn Tue, Jun 3, 2014 at 9:49 AM, PanzerKunst notifications@github.com\nwrote:\n\nHi,\nWhen doing the following DELETE request on my iPhone (iOS 7.1.1), the\nonFailure callback is executed:\nnew Request({\n    urlEncoded: false,\n    emulation: false, // Otherwise PUT and DELETE requests are sent as POST\n    url: \"/api/reports/\" + reportId,\n    onSuccess: function (responseText, responseXML) {\n        location.replace(successUrl);\n    },\n    onFailure: function (xhr) {\n        this.$confirmDeleteBtn.button('reset');\n        alert(\"AJAX fail :(\");\n    }.bind(this)\n}).delete();\nBut when I do the equivalent in jQuery, it works:\njQuery.ajax({\n    url: \"/api/reports/\" + reportId,\n    type: \"DELETE\",\n    success: function(data, textStatus, jqXHR) {\n        location.replace(successUrl);\n    },\n    error: function(jqXHR, textStatus, errorThrown) {\n        this.$confirmDeleteBtn.button('reset');\n        alert(\"AJAX fail :(\");\n    }.bind(this)\n});\nI think it's a bug in Mootools. I'm having this issue in both 1.4.5 and\n1.5.0.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2608.\n. No I understand, but Safari mobile is particularly funny.\n\nIs there a way you can find out for us the headers that were sent to the\nbrowser? Ideally to compare MooTools vs jQuery headers.\nOn Tue, Jun 3, 2014 at 11:30 AM, PanzerKunst notifications@github.com\nwrote:\n\nI can't really test the server-side right now, but since iOS has amazing\ndebugging tools when you have a Mac, this is what I could extract from xhr\nargument of onFailure:\nconstructor: XMLHttpRequestConstructor\nonabort: null\nonerror: null\nonload: null\nonloadend: null\nonloadstart: function () {}\nonprogress: function () {}\nonreadystatechange: function () {}\nontimeout: null\nreadyState: 4\nresponse: \"\u21b5\u21b5<!DOCTYPE html>\u21b5\u21b5    \u21b5       Bad request\u21b5       \u21b5     \u21b5          html, body, pre {\u21b5                margin: 0;\u21b5               padding: 0;\u21b5              font-family: Monaco, 'Lucida Console', monospace;\u21b5                background: #ECECEC;\u21b5         }\u21b5            h1 {\u21b5             margin: 0;\u21b5               background: #AD632A;\u21b5             padding: 20px 45px;\u21b5              color: #fff;\u21b5             text-shadow: 1px 1px 1px rgba(0,0,0,.3);\u21b5             border-bottom: 1px solid #9F5805;\u21b5                font-size: 28px;\u21b5         }\u21b5            p#detail {\u21b5               margin: 0;\u21b5               padding: 15px 45px;\u21b5              background: #F6A960;\u21b5             border-top: 4px solid #D29052;\u21b5               color: #733512;\u21b5              text-shadow: 1px 1px 1px rgba(255,255,255,.3);\u21b5               font-size: 14px;\u21b5             border-bottom: 1px solid #BA7F5B;\u21b5            }\u21b5        \u21b5 \u21b5  \u21b5       Bad request\u21b5\u21b5      \u21b5          For request 'DELETE /api/reports/21' [Invalid XML]\u21b5       \u21b5\u21b5  \u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\"\nresponseText: \"\u21b5\u21b5<!DOCTYPE html>\u21b5\u21b5    \u21b5       Bad request\u21b5       \u21b5     \u21b5          html, body, pre {\u21b5                margin: 0;\u21b5               padding: 0;\u21b5              font-family: Monaco, 'Lucida Console', monospace;\u21b5                background: #ECECEC;\u21b5         }\u21b5            h1 {\u21b5             margin: 0;\u21b5               background: #AD632A;\u21b5             padding: 20px 45px;\u21b5              color: #fff;\u21b5             text-shadow: 1px 1px 1px rgba(0,0,0,.3);\u21b5             border-bottom: 1px solid #9F5805;\u21b5                font-size: 28px;\u21b5         }\u21b5            p#detail {\u21b5               margin: 0;\u21b5               padding: 15px 45px;\u21b5              background: #F6A960;\u21b5             border-top: 4px solid #D29052;\u21b5               color: #733512;\u21b5              text-shadow: 1px 1px 1px rgba(255,255,255,.3);\u21b5               font-size: 14px;\u21b5             border-bottom: 1px solid #BA7F5B;\u21b5            }\u21b5        \u21b5 \u21b5  \u21b5       Bad request\u21b5\u21b5      \u21b5          For request 'DELETE /api/reports/21' [Invalid XML]\u21b5       \u21b5\u21b5  \u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\"\nresponseType: \"\"\nresponseXML: null\nstatus: 400\nstatusText: \"Bad Request\"\ntimeout: 0\nupload: XMLHttpRequestUpload\nwithCredentials: false\nproto: XMLHttpRequestPrototype\nAnd so it seams to me that the server rejects the request.\nJust to make sure it's clear: this DELETE request works fine on most\nbrowsers. I just noticed the failure on iOS Safari.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2608#issuecomment-44987954\n.\n. Well.. after reading the RFC there is a use case of Content-Type, and that is when the OPTIONS field includes a entity-body. Regardless, the Content-Type is used to help find the right mechanism for the response. This 500 error seems to be that the server doesn't like that it has to give a response in that format. \n\nInterestingly, I don't see how the Content-Type is set. Line 177 is the only one that touches the Content-Type, and that's not executed by your example.\nThe only possible way this is set is by XmlHttpRequest -- by default. Which I suppose jQuery cleans up? \nAnyway, I don't think that Content-Type should have any consequence in the code. It's suppose to be handled by the server in which ever way the server deems it so. I'll let someone else comment, though, on the handling of this request.\n. I'm closing this since you could clean up the headers prior to sending the request. Normally, we would want to fix this but I believe that your server is very picky in the Accept and Content-Type -- e.g. it's not spec specific. Go ahead and re-open, if you have additional info. \n. Go ahead, and I'll compare the example against my server.\n. Send us a PR. \n. We just started a discussion about dropping IE support for some versions. I'll refer to @SergioCrisostomo  so he keeps track :)\n. Sorry for the spam @SergioCrisostomo see: https://github.com/mootools/mootools-core/pull/2611#discussion_r14367398\nfor final implementation.\n. Well Class.Extras.js#L112 skips constructor because it's lacking the 'on' prefix in the name. \n. And constructor in IE is reserved/special field in an object). Nothing we can do about that. \n. I'm still unsure why you'd like to use constructor. Why not use init or start?\n. We've tried to replicate the issue, but we were unsuccessful. Please provide more detail. \n. Sorry, we can't introduce this BC. Reading the manual would also resolve everyone's problems. \n. This is outside the scope of Core, and potentially an issue with performance.\n. If this is useful for anyone else, then we can go ahead and pull into Core. I'm arguing the readability, but it's a moot argument if others pick up the idea.\n. ~~Also, this is missing specs. I would assume that the specs would need to conform to Array.splice's specs (or at least generally).~~ totally skipped the last file. gj!\n. Re: the stick to Array.splice mimicry vs. venture into splice-like\nI would start with the Specs, and define the questions and answers. I'd personally prefer to write something like:\n``` js\n'Some string'.splice('my other string', 5);    // 'Some my other string'\n'abc'.splice(' ', 1);                          // 'a c'\n'abc'.splice(' ', 1, 2);                       // 'a  c'\nmyString.splice(withAnother, optStartPosition, optLength);\n'abc'.splice('def');                          // 'abcdef'\n```\n. I'm personally not a huge fan of Promises, but I understand the need for\nthem.\nI would expect something like Promises implementation/interface that when\nImplements would allow others to use the interface.\nFFT.\nOn Mon, Aug 18, 2014 at 3:52 PM, Graeme Yeates notifications@github.com\nwrote:\n\nFor 2.0, whenever that happens, I would love to see a promise\nimplementation thats used in Requests, Fx and other suitable places.\nDoing so would kill the need of Request.Queue and certainly other\nextensions and enable use that has been made intuitive by other libraries.\nI've been monkey patching this behaviour for requests for a while now\n(using the es6-promise polyfill)\nClass.refactor(Request, {\n    initialize: function(options) {\n        var self = this;\n        this.previous(options);\n        this.promise = new Promise(function (fulfill, reject) {\n            self.addEvents({\n                success: fulfill,\n                failure: reject\n            });\n        });\n    }}).implement({\n    \"then\": function(success, error) {\n        return this.promise.then(success, error);\n    },\n    \"catch\": function(error) {\n        return this.promise\"catch\";\n    }});\nSome example usage:\nvar readyPromises = [\n    new Promise(function(fulfill) {\n        document.addEvent(\"domready\", fulfill);\n    }),\n    new Request.JSON({\n        url: \"/lang\",\n        method: \"get\"\n    })\n    .load()\n    .then(function() {\n        // setup localization\n    })];\n.ready = Promise.all(readyPromises);\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2643.\n. Only issue in adopting the ES6 promise would leave a gap for non ES6 browsers. Thus we'd need to create the shim anyway. \n. Yeah I'd be some kind of decorator.\n\nOn Fri, Oct 31, 2014 at 6:28 PM, Arian Stolwijk notifications@github.com\nwrote:\n\nThe user could add a shim of own choosing, and pass the constructor in the\nconcerning object.\nFor example:\nnew Request({\nurl: 'foo.html'\n})\n.withPromise(Promise())\n.then(function(){ ... });\nOr something similar (I'm not very familiar with the exact promise API).\nOn Fri, Oct 31, 2014 at 10:17 PM, Olmo Maldonado notifications@github.com\nwrote:\n\nOnly issue is adopting the ES6 promise would leave a gap for non ES6\nbrowsers. Thus we'd need to create the shim anyway.\n\u2014\nReply to this email directly or view it on GitHub\n<\nhttps://github.com/mootools/mootools-core/issues/2643#issuecomment-61333031>\n.\n\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2643#issuecomment-61344381\n.\n. This is Slick related. Please report to: https://github.com/mootools/slick\n. And confirm that the fix is working. Please.\n\nOn Mon, Sep 15, 2014 at 2:51 PM, Sergio Crisostomo <notifications@github.com\n\nwrote:\n@odysseuscm https://github.com/odysseuscm thank you for pointing this\nout.\nIt has been fixed and added for the 1.5.2 release.\nDo use the fix applied there meanwhile.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2652#issuecomment-55648024\n.\n. Let's pull and find out ;)\n. I'll add a comment to the refactor trello card.\n\nOn Thu, Sep 25, 2014 at 5:03 PM, Sergio Crisostomo <notifications@github.com\n\nwrote:\nShould we open a issue about removing Safari 5 code and close when we have\ndone it?\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/pull/2657#issuecomment-56891035\n.\n. I tend to use a selector rather than a simple getParent() call. I'm also finding myself not using getParent as much. Since, the trend nowadays is to encapsulate logic into functional models. Meaning: ComputerCase(Motherboard(Processor(), Memory()), HardDrive()). Each of the elements would include the specific DOM element via selectors, or you have one parent container and you select down the tree. So I'm already biased against getParent.\n\nWhether this has merit to be included I think it falls on the repetitiveness. I think most people will expect to go up once or twice a level, and I think this is an optimization when you have a very deep node structure. \nFinally, the selector option in the getParent should suffice the majority of the time. You can lookup against a data- attribute, or class to match for the specific parent you're looking for. \nUnless we get more user interest, or more examples of why this would improve on best practices. I'd say this enhancement could be shelved. \n. Yeah and we're glad you did. Keep 'em coming. \nMy rebutt to your example would be.. why do a simple selector like span it's faster/cheaper to just do span.look-for-something  or unless you're saying there's hundreds of span.look-for-something. Also, couldn't you do: .specific-parent span.look-for-something \nAgain, it's unusual nowadays to not be very semantic with your your tags and descriptive. Not just for the benefit of the SEO, but because it's more readable/maintainable. \n. Two issues. \ntypeOf checking $family on a secure object. We don't know of a way to test an object if it's secure or from another domain. Let us know, if you find a way to do this. Just trying 'setTimeout' in window.parent in jsFiddle for example, throws an error. \nsetOptions in Class. We never intended to pass elements, and other massive objects to setOptions. We encourage you to instead pass them to the constructor, or as keys to lookup. E.g. IDs. \nAs it is, we'll have to close this, but open to suggestions on the secure objects. \n. Out of the properties that you are checking, location top and opener seem least generic, but I could still imagine someone passing {location: 'Hollywood'} and instead of object being returned, they'll get window. \nIs there other unique properties we could check for?\n. Untested, but maybe... if (item.top && !Object.hasOwnProperty(item, 'top')) return 'window';\n. We're also having issues reproducing this. IF you could provide the file(s) via Dropbox, etc. It'll help. Closing for now, since it seem worksforme. \n. Sure\nOn Wed, Oct 22, 2014 at 1:06 AM, Hristo Chakarov notifications@github.com\nwrote:\n\nThis is a bug in Firefox's core:\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=1084196\nHowever, I'm not sure that they're going to fix this soon. But as the idea\nof the JS frameworks/libs is to standardize browsers and to fix\ncross-browser issues, I think we need to patch this in MooTools.\nI have already patched this locally. Let me know if you give me green\nlight to make a pull request.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2662.\n. Can you provide the patch in this issue or a PR?\n. We've decided that this is too much burden for MooTools, and although you provided a patch, the patch is a fragile due to the calculations.\n. or HTTPOnly\n\nOn Fri, Oct 31, 2014 at 9:40 AM, Arian Stolwijk notifications@github.com\nwrote:\n\nI would accept a pull request.\nIt's basically just adding\nif (this.options.HttpOnly) value += '; HttpOnly';\nOnly question is whether it should be HttpOnly or httpOnly...\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2664#issuecomment-61269814\n.\n. Any updates?\n. Remove IE6, IE7, and Safari old, Firefox old, Opera old\n. The concept is to reduce the burden on two separate projects and code. Move things that are outside the scope of \"MooTools\" (whatever that may be for 2.0) into plugins (own repo) and merge the rest into Core. Hopefully refactored, optimized, and full spec coverage.\n. Indeed, but I was wondering if we could do something like [^\\d\\D] (this\nwas obviously rushed) but the idea is to separate by non-alpha(unicode)\n\nOn Thu, Nov 27, 2014 at 2:05 PM, Arian Stolwijk notifications@github.com\nwrote:\n\nIt's really depends what this method is meant for. Afaik this is mostly\nmeant for regular simple programming problems, and not for internalization.\nIf you start doing that, then there are at least 101 other cases we would\nneed to cover, and the question is where we should draw the line.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2680#issuecomment-64826848\n.\n. I believe it's been discussed before, and the consensus was that it wasn't Core-able.\n. Ahh likely not there either. I just remember back in the day.. I mean.. 2005?? @kassens had done a debounce and throttle Function extensions that were pretty rad. I'll tell you what. I'll reopen, and based on other feedback we may consider for 1.6. Cheers.\n. LGTM\n. \n",
    "jdalton": "I think this is an issue of not understanding how toJSON() works as spec intends. MooTools should no longer support their non-ES5 compliant toJSON() methods.\n. In fact @finnr is working from an older code base as MooTools 1.3rc1 no longer adds toJSON() methods to the natives or other objects. http://github.com/mootools/mootools-core/blob/master/Source/Utilities/JSON.js\n. Just a quick reality check. http://jsperf.com/multiply-vs-divide2 each of the variations execute around or above a million executions a second which means they are all functionally equivalent and will have no real impact on anything performance wise.\n. FuseJS checks for the existence of doScroll before use so it doesn't need conditional comments. We only use doScroll for IE 6/7 because it won't work in iframes (only errors if the primary document dom isn't ready, not framed documents) and requires a less than ideal onreadystatechange hook which fires juuuust before window.onload. IE greater than 6/7 (reason for the weak inference for native JSON) no longer has the operation aborted error so we just brute force dom insertion/removal (though it's probably too aggressive).\nNotes: The thanks to Rich Dougherty was because he reported a jQuery ticket which found that checking window.top could cause a several second IE hang in framed documents.\n. Instead of checking for native JSON to assume above IE 6/7 we could instead check ScriptEngineMajorVersion() and ScriptEngineMinorVersion() to see if it's at least version JScript 5.8 (the version in IE8).\n. That's to be expected. When in compat modes API and behavioral changes occur.\n. I'm a fan of that too.\n. I can dig it. Maybe a type check on the doScroll instead of a truthy check, but other than that I dig.\n. Ok so this looks a lot like the rabbit hole jQuery once went down and it's full of gotchas.\nMy comments on this are here.\n(in the audio I say capture phase -> for IE interpret that as onbeforeactivate)\n. @arian Ah ok, thanks for clearing that up for me.\n@csuwldcat Can you give more detail on what the IE bug is (what's broken about it)?\n. @csuwldcat I seem to remember smth like this for select elements too (not as an IE only issue). Won't the change event eventually fire when the control is blurred to submit the form though and how does this prevent multiple triggers of change event handlers in IE (when the control is eventually blurred)?\n. @csuwldcat \n\nSelect elements do suffer from the same issues,\n\nBut you limit it to an IE-ish browser w/ this\nif (!window.addEventListener) {\nand I believe the select element issue extends to others.\nAlso I had a second question in my comment\n\nand how does this prevent multiple triggers of change event handlers\n. @csuwldcat\nThe event is not fired multiple times\n\nAh ok.\n\nHmm, I wasn't aware of improper select element behavior in other browsers, do you know which ones or versions I can look at?\n\nIn Firefox select the dropdown and then use your keyboard up/down arrows to navigate (compare w/ other browsers behavior).\nhttp://dl.dropbox.com/u/513327/select_onchange.html\n. In my own projects I chose to punt on this issue because the fixes seemed over-the-top for smth that still eventually gets triggered.\n. nice find!\n. I think there is probably room to tweak a bit, but the speed diff doesn't concern me much. Doing things right could come at a cost and it makes sense now that native is faster than the updated fallback.\n. @cpojer this could be none-window a lot of the time so that wouldn't do:\nFor example:\njs\nfoo.bar = baz.bar.bind(baz, 'x', 'y');\nAlso ya'll could take it up a notch and implement a custom call/apply method too (I'll update my list to include that). By spec bound.call(thisArg, 'z') should ignore thisArg and curry args as if called like bound('z').\n. @arian except if you call/apply with an instance of the bound function as the thisArg. It shouldn't be treated as new bound.\n. @arian add a test for .apply() too\n. For this to be extra awesomely right you need:\njs\nif (this == null) {\n  throw new TypeError;\n}\nbefore the other stuff.\n. @cpojer it's pretty minor to comply with spec, and strict mode. I mean you guys are the ones walking on native prototypes, so this kind of stuff comes with the territory.\n. >  I believe that changed in ES5, but those browsers who need this don't have ES5. See the note at http://es5.github.com/#x15.3.4.4. I guess that makes it a bit harder to throw that TypeError...\nWhile it's true that most implementations with strict mode support may already have Array additions, we can't predict with 100% certainty that will always  be the case. In a related example you might assume because Array#indexOf exists that all other Array additions exist, but that would cause problems in Safari 4 on iPhone iOS 3.1.3 which doesn't have Array#reduce.\nYou never know how MooTools will be used. For example an implementation may have a buggy native Array#filter, so a dev simply paves it like Array.prototype.filter = null; before including MooTools. If MooTools followed spec then it would have the correct behavior (even in enviros that have strict mode support).\n. As I've recently pointed out, most other es5 shims don't follow spec. So if MooTools is included after one of those many shims it might end up using their buggy implementations. If MooTools switched it's checks to something like:\njs\n  /**\n   * Uses implementation dependent `Function#toString` behavior in an attempt\n   * to detect native functions by comparing the `toString` signature of a native\n   * function against that of the given function. Note: This function is not\n   * foolproof and will return `false` in environments that return empty string\n   * values or unmatchable signatures.\n   * @private\n   * @param {Object} object The object that the function is accessible from.\n   * @param {String} method The property name of the function.\n   * @returns {Boolean} Returns true if the signatures match, else false.\n   * @see https://github.com/dperini/nwmatcher/blob/master/src/nwmatcher.js#L183-190\n   */\n  isNative = (function() {\n    // resolve the native function `toString` signature\n    // e.g. `function (){ [native code] }`, `[function]` or `[ecmascript code]`\n    var signature = !!(signature = document.appendChild + '') && signature.replace(/appendChild/g, '');\n    return function(object, method) {\n      var fn = object && object[method];\n      return signature !== false && !!fn && typeof fn != 'string' &&\n        signature == (fn + '').replace(RegExp(method, 'g'), '');\n    };\n  }());\nthen you all could actually correct the buggy shims by providing your own that work correctly.\n. Tools like sIEve give false positives and can cause devs to waste time. I find it's best to use use Process Explorer and a simplified test case to locate leaks. I am aware of the instanceof leak and try to avoid it in places like Benchmark.js. That said not every dummy element created has to be nulled.\n. No blog post at the moment, but for some tricky IE6 memory leaks it may require early versions of XP pre SP2, which can be a pain to get a hold of.\nI was able to reproduce leaks without having to scrounge up an old IE6 Win 2K/XP install by using Multiple-IE, but those browsers are really unstable so try to get the real deal if possible.\n. Here is a blog post I did over a nice single page memory leak in IE associated with removeChild.\nhttp://allyoucanleet.com/2011/02/16/exploring-the-removechild-single-page-memory-leak/\n. > How did you narrow the leak to replaceChild?\nThe removeChild leak was known at the time. I remember reading about it in an excerpt here or some place similar.\n\n. When doing research into IE's event handler leaks I had to whittle the code down to a small snippet, which took some time (I used Process Explorer here again).\nThe result can be seen in @bryanforbes post over the Internet Explorer event handler leak  under the \"Fixing It By Global Reference\" section.\n. Umm srsly a UA sniff?\n. Would feel better if the width/height attributes were removed before the src was set (I know it may be async but it just feels right)\n. Also I think a quick review of elements w/ src attributes would be good to see if it makes sense to remove width/height on all of them.\n. I remember running into issues similar to this in 2005/2006 and having to come up with a way to find an images natural height/width... will dig a bit later to see what I can come up with.\n. Ok so I did some research and it seems the reason IE isn't changing the image size is that it is automatically assigning it a height/width attribute. The other browsers resize the image because there is no explicitly set dimensions.\nBecause IE auto adds these attributes it may be tricky to detect if they were explicitly assigned or auto so simply clearing them is not a good idea because they may be added on purpose.\n(Maybe adding a dev note somewhere would help)\n. +1 for doc note\n. Copying a bit of code from Function#overloadSetter:\njs\nObject.extend('forEach', function(object, fn, bind){\n    for (var key in object){\n        if (hasOwnProperty.call(object, key)) fn.call(bind, object[key], key, object);\n    }\n    if (enumerables) for (var i = enumerables.length; i--;){\n        key = enumerables[i];\n        if (hasOwnProperty.call(object, key)) fn.call(bind, object[key], key, object);\n    }\n});\n. Also y'all should check out how YUI and spotlight.js do it.\nSpotlight has lots of extra stuff because it's a blind object crawler but the code comments have gems.\n. To solve the concerns of own vs inherited properties you could split the functionality forOwn() and forIn().\n. ``` js\n['a','b','c'].filter(function(value, index, array) {\n  if (value == 'b') {\n    array[index] = 'c';\n    return true;\n  }\n});\n// native: [\"b\"]\n// moo: [\"c\"]\n``\n. I'd prefer if MooTools followed jQuery's lead here and deprecate the browser sniffing code. You can only get$.browserthrough their migration plugin and it's stopped supporting newer browsers. So it avoids IE11 falling into old IE traps (which was the point of their UA change).\n. I think this is an issue of not understanding how toJSON() works as spec intends. MooTools should no longer support their non-ES5 compliant toJSON() methods.\n. In fact @finnr is working from an older code base as MooTools 1.3rc1 no longer adds toJSON() methods to the natives or other objects. http://github.com/mootools/mootools-core/blob/master/Source/Utilities/JSON.js\n. Just a quick reality check. http://jsperf.com/multiply-vs-divide2 each of the variations execute around or above a million executions a second which means they are all functionally equivalent and will have no real impact on anything performance wise.\n. FuseJS checks for the existence ofdoScrollbefore use so it doesn't need conditional comments. We only usedoScrollfor IE 6/7 because it won't work in iframes _(only errors if the primary document dom isn't ready, not framed documents)_ and requires a less than idealonreadystatechangehook which fires juuuust beforewindow.onload. IE greater than 6/7 _(reason for the weak inference for native JSON)_ no longer has theoperation aborted` error so we just brute force dom insertion/removal (though it's probably too aggressive).\nNotes: The thanks to Rich Dougherty was because he reported a jQuery ticket which found that checking window.top could cause a several second IE hang in framed documents.\n. Instead of checking for native JSON to assume above IE 6/7 we could instead check ScriptEngineMajorVersion() and ScriptEngineMinorVersion() to see if it's at least version JScript 5.8 (the version in IE8).\n. That's to be expected. When in compat modes API and behavioral changes occur.\n. I'm a fan of that too.\n. I can dig it. Maybe a type check on the doScroll instead of a truthy check, but other than that I dig.\n. Ok so this looks a lot like the rabbit hole jQuery once went down and it's full of gotchas.\nMy comments on this are here.\n(in the audio I say capture phase -> for IE interpret that as onbeforeactivate)\n. @arian Ah ok, thanks for clearing that up for me.\n@csuwldcat Can you give more detail on what the IE bug is (what's broken about it)?\n. @csuwldcat I seem to remember smth like this for select elements too (not as an IE only issue). Won't the change event eventually fire when the control is blurred to submit the form though and how does this prevent multiple triggers of change event handlers in IE (when the control is eventually blurred)?\n. @csuwldcat \n\nSelect elements do suffer from the same issues,\n\nBut you limit it to an IE-ish browser w/ this\nif (!window.addEventListener) {\nand I believe the select element issue extends to others.\nAlso I had a second question in my comment\n\nand how does this prevent multiple triggers of change event handlers\n. @csuwldcat\nThe event is not fired multiple times\n\nAh ok.\n\nHmm, I wasn't aware of improper select element behavior in other browsers, do you know which ones or versions I can look at?\n\nIn Firefox select the dropdown and then use your keyboard up/down arrows to navigate (compare w/ other browsers behavior).\nhttp://dl.dropbox.com/u/513327/select_onchange.html\n. In my own projects I chose to punt on this issue because the fixes seemed over-the-top for smth that still eventually gets triggered.\n. nice find!\n. I think there is probably room to tweak a bit, but the speed diff doesn't concern me much. Doing things right could come at a cost and it makes sense now that native is faster than the updated fallback.\n. @cpojer this could be none-window a lot of the time so that wouldn't do:\nFor example:\njs\nfoo.bar = baz.bar.bind(baz, 'x', 'y');\nAlso ya'll could take it up a notch and implement a custom call/apply method too (I'll update my list to include that). By spec bound.call(thisArg, 'z') should ignore thisArg and curry args as if called like bound('z').\n. @arian except if you call/apply with an instance of the bound function as the thisArg. It shouldn't be treated as new bound.\n. @arian add a test for .apply() too\n. For this to be extra awesomely right you need:\njs\nif (this == null) {\n  throw new TypeError;\n}\nbefore the other stuff.\n. @cpojer it's pretty minor to comply with spec, and strict mode. I mean you guys are the ones walking on native prototypes, so this kind of stuff comes with the territory.\n. >  I believe that changed in ES5, but those browsers who need this don't have ES5. See the note at http://es5.github.com/#x15.3.4.4. I guess that makes it a bit harder to throw that TypeError...\nWhile it's true that most implementations with strict mode support may already have Array additions, we can't predict with 100% certainty that will always  be the case. In a related example you might assume because Array#indexOf exists that all other Array additions exist, but that would cause problems in Safari 4 on iPhone iOS 3.1.3 which doesn't have Array#reduce.\nYou never know how MooTools will be used. For example an implementation may have a buggy native Array#filter, so a dev simply paves it like Array.prototype.filter = null; before including MooTools. If MooTools followed spec then it would have the correct behavior (even in enviros that have strict mode support).\n. As I've recently pointed out, most other es5 shims don't follow spec. So if MooTools is included after one of those many shims it might end up using their buggy implementations. If MooTools switched it's checks to something like:\njs\n  /**\n   * Uses implementation dependent `Function#toString` behavior in an attempt\n   * to detect native functions by comparing the `toString` signature of a native\n   * function against that of the given function. Note: This function is not\n   * foolproof and will return `false` in environments that return empty string\n   * values or unmatchable signatures.\n   * @private\n   * @param {Object} object The object that the function is accessible from.\n   * @param {String} method The property name of the function.\n   * @returns {Boolean} Returns true if the signatures match, else false.\n   * @see https://github.com/dperini/nwmatcher/blob/master/src/nwmatcher.js#L183-190\n   */\n  isNative = (function() {\n    // resolve the native function `toString` signature\n    // e.g. `function (){ [native code] }`, `[function]` or `[ecmascript code]`\n    var signature = !!(signature = document.appendChild + '') && signature.replace(/appendChild/g, '');\n    return function(object, method) {\n      var fn = object && object[method];\n      return signature !== false && !!fn && typeof fn != 'string' &&\n        signature == (fn + '').replace(RegExp(method, 'g'), '');\n    };\n  }());\nthen you all could actually correct the buggy shims by providing your own that work correctly.\n. Tools like sIEve give false positives and can cause devs to waste time. I find it's best to use use Process Explorer and a simplified test case to locate leaks. I am aware of the instanceof leak and try to avoid it in places like Benchmark.js. That said not every dummy element created has to be nulled.\n. No blog post at the moment, but for some tricky IE6 memory leaks it may require early versions of XP pre SP2, which can be a pain to get a hold of.\nI was able to reproduce leaks without having to scrounge up an old IE6 Win 2K/XP install by using Multiple-IE, but those browsers are really unstable so try to get the real deal if possible.\n. Here is a blog post I did over a nice single page memory leak in IE associated with removeChild.\nhttp://allyoucanleet.com/2011/02/16/exploring-the-removechild-single-page-memory-leak/\n. > How did you narrow the leak to replaceChild?\nThe removeChild leak was known at the time. I remember reading about it in an excerpt here or some place similar.\n\n. When doing research into IE's event handler leaks I had to whittle the code down to a small snippet, which took some time (I used Process Explorer here again).\nThe result can be seen in @bryanforbes post over the Internet Explorer event handler leak  under the \"Fixing It By Global Reference\" section.\n. Umm srsly a UA sniff?\n. Would feel better if the width/height attributes were removed before the src was set (I know it may be async but it just feels right)\n. Also I think a quick review of elements w/ src attributes would be good to see if it makes sense to remove width/height on all of them.\n. I remember running into issues similar to this in 2005/2006 and having to come up with a way to find an images natural height/width... will dig a bit later to see what I can come up with.\n. Ok so I did some research and it seems the reason IE isn't changing the image size is that it is automatically assigning it a height/width attribute. The other browsers resize the image because there is no explicitly set dimensions.\nBecause IE auto adds these attributes it may be tricky to detect if they were explicitly assigned or auto so simply clearing them is not a good idea because they may be added on purpose.\n(Maybe adding a dev note somewhere would help)\n. +1 for doc note\n. Copying a bit of code from Function#overloadSetter:\njs\nObject.extend('forEach', function(object, fn, bind){\n    for (var key in object){\n        if (hasOwnProperty.call(object, key)) fn.call(bind, object[key], key, object);\n    }\n    if (enumerables) for (var i = enumerables.length; i--;){\n        key = enumerables[i];\n        if (hasOwnProperty.call(object, key)) fn.call(bind, object[key], key, object);\n    }\n});\n. Also y'all should check out how YUI and spotlight.js do it.\nSpotlight has lots of extra stuff because it's a blind object crawler but the code comments have gems.\n. To solve the concerns of own vs inherited properties you could split the functionality forOwn() and forIn().\n. ``` js\n['a','b','c'].filter(function(value, index, array) {\n  if (value == 'b') {\n    array[index] = 'c';\n    return true;\n  }\n});\n// native: [\"b\"]\n// moo: [\"c\"]\n``\n. I'd prefer if MooTools followed jQuery's lead here and deprecate the browser sniffing code. You can only get$.browser` through their migration plugin and it's stopped supporting newer browsers. So it avoids IE11 falling into old IE traps (which was the point of their UA change).\n. ",
    "gonchuki": "I will retract this pull request for a bit, I just found #637 and looks like the bug is indeed in getScrolls and not in getPosition.\n. Tests from this patch are all red on Firefox for me, I'm getting undefined in 16 of them. Can anyone else confirm? using Firefox 14 and 15 beta here by the way.\n. .get of an attribute that has no value but exists should definitely be returning an empty string, that's what the browser returns if you do:\nvar a = document.createElement('div');\nvar b = document.createAttribute('data-test');\na.setAttributeNode(b);\ndoing a.getAttribute('data-test') returns an empty string, while a.get('data-test') returns null\n. fiddle showing this issue: http://jsfiddle.net/gonchuki/EG9c9/\nI don't see any error on the IE console, but it still fails to apply the styles. Reproducible in all versions available at jsfiddle.\n. I would say that the issue is a little deeper in getComputedStyle as the margin-left of the detached element with no text is returning null, and once you set some text it returns 0px.\nCurious thing is that if you append this element into another one (even if it's also detached) and then you detach the element again you start getting the valid 0px value. Probably an internal IE bug where the detached element gets no layout or even no style attributes at all until you interact with it.\n. edit: what was here was a dumb idea. \ngetting some specs and a proper pull request soon.\n. maybe just normalize this value in prepare? auto is a valid return value from getStyle('top'), for example when the user explicitly sets top: auto it will also fail on Firefox.\n. The problem is, how do you get the real top? if you set position:absolute; bottom: 0; for example, the auto returned from getStyle('top')can't be translated to 0 (see this example: http://jsfiddle.net/xGQkX/5/, works on Firefox, breaks on Chrome).\nDoing this on Element.Style will be actually having logic that naturally belongs to Element.Dimensions (or the Element.Position we don't have). To me the question is: move logic from Dimensions into Style so we never return auto on a getStyle call or add Dimensions as a dependency on Fx.CSS and normalize in there as needed?\n. isn't this fixed by this commit by @arian? \nhttps://github.com/mootools/mootools-core/commit/3927a8a7f7f4ef7d4faa9a3d27ec4d975bc8db5e\n(if that's not the one, there are a couple previous commits that touch that same block of code and relate to Opera)\nAs I see it the previously shipped code had a Browser.opera check inside a Browser.ie condition which rendered that line of code unreachable by Opera (confirmed on a freshly downloaded 1.4.5)\n. according to #2325 this regression was introduced between 1.4.4 and 1.4.5\nalso, the edge build on jsfiddle still exposes this issue.\nHere's a compare view between 1.4.4 and 1.4.5\nalso, someone with powers should mark this or #2325 as a duplicate, it's the same bug.\n. Sorry for the spammy review, hope you don't mind :)\n. I think there are a few issues with your code @arian, for example toggleClass will not do a toggle on each of the passed space-separated classes, and even worse it will go the removeClass route on most cases (element having class A, you call toggleClass(\"A B\"), hasClass(\"A B\") returns false, so you just get a call to removeClass(\"A B\")\nI also like the idea that these functions can accept an array or a function, adds a lot of flexibility.\n. FWIW, the rest of the world seems to be fine by having addClass accept a list of space separated values or an array:\nhttp://api.jquery.com/addClass/\nhttp://dojotoolkit.org/reference-guide/1.7/dojo/addClass.html\nhttp://docs.sencha.com/ext-js/4-1/#!/api/Ext.dom.AbstractElement-method-addCls\nI for one would like more flexibility if we want to keep being relevant. This is core functionality, it shouldn't have to reside on the forge just because you don't like a small chunk of code that needs refactoring anyways.\n. since there's no native Element.prototype.addClass I see no point in replicating the classList API. The only methods that MooTools abides strictly to the specs are the ones that actually work as a shim. Maybe I'm becoming old and someone subreptitiously added a :relay pseudo selector to the addEventListener API while I was away?\nThe point of custom/extended methods in libraries is to be useful where the spec is lacking. There's a lot of potential in allowing multiple classes in these methods, I don't get why you don't see it like that.\n. if these perf numbers are still true for newer Firefox and other browsers alike then I'm all for having this and a plugin on the forge (or -more) for the multiple classes. Else there's no real win other than using native API to manipulate classes.\nIt would be ideal if you can get a jsperf running with this patch.\n. http://jsperf.com/jquery-toggleclass-vs-html5-classlist-toggle\nhttp://jsperf.com/jquery-addclass-vs-html5-classlist-add\nI'm sold.\n. sure, doesn't take away the fact that you could say/exemplify this big performance advantage before closing the other pull request.\nif you check how the thread went it simply looks like you simply didn't want the change to happen and nothing else. Nice fact is that either giving more performance or more flexibility are good things to talk about for next release :)\n. Interesting finding answering to \"what's wrong with addClass('a').addClass('b')\" http://jsperf.com/jquery-addclass-vs-html5-classlist-add/2\nFor some reason MooTools is getting hammered on these browsers I could test on. Good thing this will be a thing of the past for everything but IE9 and lower.\n. Some info on this one: \n- Happens on both IE7 and IE8\n- It's not a regression, I could also reproduce on the fiddle using 1.3.2 and 1.2.5\n- the most I could find out is that this is failing after the first morph, where IE begins returning the style for borderLeft in the wrong order (returning color width style instead of width style color)\nI will keep looking at this, will be back with a pull request if I can find the source of this issue.\n. so the source is simply a bug on IE7/8, where assigning the 3 components of a border side (either via the shorthand or using the 3 individual styles), a later retrieval of that value comes with the aforementioned incorrect order. Note that it also returns the incorrect order when using the border shorthand (that is, setting/getting all 4 borders at once)\nThe only thing I can think of is setting a feature detect for this bug, and in such case get an additional step on getStyle to reorder the components.\nAny voice against this suggestion? else I will get working onto the pull request :)\n. just out of curiosity, does this happen on WP7 pre-Mango or on the current Mango/Tango release?\n. No failing spec but I can make one. Just not sure if this should go in 1.4client folder or create a 1.5 one.\n. I ended up creating my own specs as I wanted to test for all three failing properties (border.*Width was the culprit but it bubbled up to width/height to produce the NaNpx error)\nfor reference, this is the result of the failing specs:\n```\nshould inherit the height from the child\nExpected 'NaNpx' to equal '100px'.\nshould get a pixel based width\nExpected 'NaNpx' to match /\\d+px/.\nshould have a 0px border left\nExpected 'medium' to equal '0px'.\n```\nmy IE is not working right with the test suite so I couldn't run it, but unless these specs uncover new bugs the changed code was already IE-only so there's nothing new there.\n. If you don't mind to merge again/cherry-pick (or manually edit), I acidentally left a trailing comma on the spec\nhttps://github.com/gonchuki/mootools-core/commit/7f59171b1a578fd6fb05ef7f1e93835057cfe79a\n. I can create a new pull request with a rebased version of this if you want to keep a cleaner story on the main repo :)\n. interesting feature @arian, I remember in the past it just used to lose the entire pull request and comment history when you rebased a set of already pull-requested commits :)\n. yeah I noticed it's getting big. There's one small change/optimization I didn't do as part of this patch, the if statement on line 116 could be reduced to this:\nif (!result || property == 'zIndex'){\n    if (Element.ShortStyles.hasOwnProperty(property)){\n        result = [];\n        for (var s in Element.ShortStyles[property]) result.push(this.getStyle(s));\n        return result.join(' ');\n    }\n    result = this.getComputedStyle(property);\n}\nI really have no idea why there's an iteration with a continue statement there. I know it's not much of an improvement but it's a first step on to the right direction. Let me know if you want me to get another pull request on that after we are done with this one.\nAs for doing a whole revamp, I'm afraid we would first need to get a more comprehensive set of specs to avoid getting into regressions or missing the chance to fix other bugs. All my latest patches shown that Element.Styles.js was heavily under-specced.\n. for the record, I installed Win8 Preview on a virtual machine and IE10 exposes the same IE7 and IE8 issue where it returns an empty string for a getStyle('backgroundPosition') on an element that has that style set on the stylesheet. The X/Y decomposition works, and it doesn't seem to return keywords for the components.\nedit: I listed another issue here, that was not true (so confused with 5 different open browser windows plus 2 virtual machines)\n. specs pass, no question. On the original comment on the PR I stated I didn't test on IE10, so the exercise was to confirm if the fixes here also covered any inconsistency that could be still present in IE10. The interesting thing is that in this case IE10 behaves more like IE8 than IE9.\n. sure, slow week(s) at work :)\n. totally right, then I think the next step would be to find out the default on the stylesheet and only null it if it isn't defined or equals 1, not sure if there's any flicker for setting the opacity twice in the same repaint, it shouldn't be but don't know how IE's filters behave in this case.\nI already have an idea for this, let's leave the PR open till I get this coded.\n. I think this is a good compromise, we let the \"old\" code do it's stuff but if the user requested an opacity of 1 we check if the element has a filter set in the CSS that gives it a different value.\nWe can only check this after we already removed the filter, so that's why I left it at the end of the block.\n. blergh, I rebased against master and got a commit that shouldn't be here, let me fix this in a sec...\n. To explain a bit the changes in 1.3 specs, the reason behind that is that setting opacity only affects the filters on oldIE, and since CSS3 has a working draft spec for allowing SVG filters to act on HTML elements which uses the same filter keyword we don't want to run those tests on browsers that support filter but are not using it to set the opacity.\n. let me know if this gets green light so I can rebase to get it ready for a merge.\n. yeah I just squashed my own commits since my rebase on master did ugly stuff a few commits above (the PR included 2 commits that weren't from this branch but were already merged into master). Maybe it's my lack of git-fu \n. I actually like the improved readability with explicitly stating what this points to, and as @kentaromiura says it should be using global to keep it generic.\n. The CSS definition as in what the CSS stylesheet has instead of the manually set style attribute? If that's the question, the answer is a plain no, as we need to return what is currently applied to the element, and you can't always query the CSS stylesheet to check a definition (stylesheets loaded cross-domain can't be read by js for example).\nThat being said, if you inspect this patch it is to actually do less mangling on IE as we were doing too much. The code in that block normalizes cases where IE returns the value on the stylesheet on a getComputedStyle call whereas other browsers return the applied pixel value.\n. careful there, there's no pull request for this bug, that message above is just that this bug was referenced on a fork.\n. ah good, seems I even commented over there a while back. For some reason github didn\u00b4t add the reference here.\nsorry for jumping the gun.\n. I don't understand much what's going on here, could you add some tests to the pull request showing what used to fail before this patch?\n. Indeed, seems to be working with MooTools edge as per this fiddle: http://jsfiddle.net/ZpK8W/1/show/\n. Can you provide more context on this? I tried with 1.2.6, 1.3.2 and 1.4.5 and it seems to be working just fine.\nhttp://jsfiddle.net/atPGJ/2/\n. We can't test if you don't provide what your DOM looks like, as @swhiteman says this seems to be something in your code, and by the looks of it there might be something broken in your DOM that the IE6/7 parser is interpreting differently than other browsers.\nPlease create a fiddle or equivalent (I know jsfiddle.net is broken for IE < 9) where this issue can be reproduced.\n. I like it.\nCould you add some tests for this fix?\n. The problem is in your implementation. You are first detaching two elements with IDs from the DOM, then injecting a copy of them via their HTML representation. Your DOM now has one attached and one detached set of nodes, which are duplicating their IDs. \nTo me, the behavior is correct: IDs are unique, and the DOM might be giving precedence to the attached element, honoring its ID, thus ignoring that your detached element is exposing that same ID. \nOn the other side, the attribute selector is also working correctly: the ID is an attribute just like any other, so when you try using the attribute as an attribute instead of an ID, the selector works.\n. Since MooTools uses getComputedStyle to gather the applied styles, I see no reason for this workaround. If getComputedStyle is returning auto then there's a good reason for it and we should trust what the browser returned in this case because that's what the browser is using internally when rendering the different layers.\n. no, it's returning auto because the browser hasn't applied your z-index (due to the element lacking a non-static position), so there's nothing to fix here.\nThe idea of getStyle is to fix inconsistencies across browsers, but it should not return values that the browser is not applying to an element.\n. I might be getting lost here, but the thing is: is Chrome applying the z-index on a static element? If the answer is \"no\", then auto is a correct value for getStyle.\nWhat I'm trying to highlight here is that if what the browser is rendering matches with what getComputedStyle returns, then there's nothing to fix.\n. I think the only browser sniffing we had remaining was on Element.Style and\nI killed those when \u2013among others\u2013 I fixed IE11 before IE11 was a thing.\n On Nov 26, 2013 8:28 AM, \"Arian Stolwijk\" notifications@github.com wrote:\n\nWe already deprecated flash version detection, we could just deprecate it\nBrowser.name / Browser.version etc. I don't have problems with that. AFAIK\nwe don't really use it ourselves anymore.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2539#issuecomment-29281569\n.\n. @curry684 can you test an edge build of MooTools with your code and tell us if you still need those patches you made?\nI'm interested in knowing if your issue was with the older browser-sniffing code or it's a separate problem that should be fixed by us.\n. in short yeah, the fixes on Element.Style should be what fixed\nElement.Measure (in particular this commit:\nhttps://github.com/mootools/mootools-core/commit/e30d1a019b04261edf06e13e3943ee96b5be1985 should\nbe responsible for that)\n\nOn Mon, Jan 27, 2014 at 5:34 PM, Arian Stolwijk notifications@github.comwrote:\n\nSee #2539 https://github.com/mootools/mootools-core/pull/2539\nBut why is there code (of mootools/mootools-more#1218https://github.com/mootools/mootools-more/issues/1218/\nmootools/mootools-more#1220https://github.com/mootools/mootools-more/pull/1220depending on this anyway. Also I'm wondering if this isn't automatically\nfixed with the changes in Element.Style.js in master, which doesn't depend\non Browser anymore.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2553#issuecomment-33411838\n.\n. aside from the comment on the code, I think we might need to be more lax with the test and not more strict with our code. Firefox returning 0% 0% is actually the same as 0px 0px, and from the various fixes I did around getStyle on 2012 my goal was to stop mangling the units so much and trust what the browser wants to return to us. \n. so I ran the tests and this patch definitely causes regressions.\nin Firefox, IE11 and Chrome:\n\nshould not return a keyword-based background-position shorthand\nExpected '0px 0px' to equal '0% 100%'.\nThis is because as I said above, the modified code short-circuits too early and it's not reading the styles properly.\n. I see @arian already fixed the parentheses, I will rebase against master to make a clean patch. Hold on just a bit.\n. all right, should be safe for merge now.\n. btw, from that suite there are 2 failing cases but seems it's always been like that, I have another backported fix on a different branch that could fix it, but it might also mean \"regressions\" for people that are already accounting for that bug so it might not be a good idea to fix it.\n. 1.5.1 is a bad milestone for this, the patch has nothing to do with 1.5.1\nAlso remember that 1.2.6 was released due to another major issue with specific browsers [1], so I don't see why we shouldn't fix the 1.2.x branch once again with a fix that allows it to keep working correctly on IE >= 10\n. Basically getStyle can return incorrect values for many properties\nbecause it's using the incorrect code paths, and I also extended the fix to\nopacity and floats which also depended on browser sniffing.\nThe original report actually came 1 year after we landed the patch in\nmaster and it was in relation to getStyle('height') returning auto\ninstead of the actual computed value. I quickly identified this as\nsomething that we had actually fixed, the only issue was the same as today:\nwe need to release.\nAs per this 1.2x patch the idea was that many people could still be stuck\non this branch and locked out of IE11, so this would act as a compatibility\nfix to let them stay on 1.2x until they are ready to jump to 1.5\n. This is a mootools-more issue and already reported at mootools/mootools-more#1223\n. Please check the comment I left on @timwienk's repo. We need to convert the IE11 stuff into its own pull request.\n. Option 1 is the only one that makes sense.\nMicrosoft doesn't want IE11+ to get clumped together with the older IE's,\nso why should we do it?\nOn Fri, Mar 7, 2014 at 2:55 PM, Aaron Newton notifications@github.comwrote:\n\n++ for Option 1.\n\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2569#issuecomment-37043247\n.\n. Olmo, you are not showing a legitimate reason there... I mean, that example\nyou gave is the only thing I can think of.\n\nSo the question is: do we have any legitimate reasons for why somebody\nwould want to put IE11 in the same bag as old IE?\nIf not, then what's wrong about making it more difficult for fanboys and\nbad coders alike?\nOn Fri, Mar 7, 2014 at 7:08 PM, Olmo Maldonado notifications@github.comwrote:\n\nMy reason for Option 4 is simple:\nFor 99.9% of the folks nothing will have changed with the compat build\n(the default build). For the 100% of the developers like me that want to\nknow if my user is on an Internet Explorer browser all I want to do is:\nif (Browser.ie) alert(\"I'm a Google Chrome fanboi, why don't you switch.\");\nInstead of:\nif (Browser.ie || Browser.modernie) alert(\"... sucks that I have to try other flags :-\\\");\nIn other terms: our Browser. API just says what browser we're on.\nFolks that are using it (even we're at fault at some point) for feature\ndetection are using it for the wrong purposes. Yes let's advocate for\nnot using Browser. for feature detection but let's not cripple\nour API for all of us.\nAgain, for folks are are not up to date with the best practices and\nmaintain their code up, they can just use the compat version which\nBrowser.ie returns null. No difference from 1.4.5 and 1.5. Now I'm just\narguing that we don't need to add unnecessary flags or logic. Just fix\nBrowser.ie as it should be, and put the responsibility of using the right\ncode/practices to the developer -- as it should be.\n\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2569#issuecomment-37067774\n.\n. Nah, in the future we would be deprecating browser sniffing. We are not\ndoing that right now because we want to ship 1.5 before 2015\nOn Mar 7, 2014 8:18 PM, \"Olmo Maldonado\" notifications@github.com wrote:\nHere's an idea of a legitimate use case. Alex Russell has talked about\ncaching feature detection by using user sniffing (\nhttp://infrequently.org/2011/01/cutting-the-interrogation-short/). If we\ncripple Browser.ie someone (in the future) would have to look for\nBrowser.ie and Browser.modernie and to be future proof will likely check\nfor:\n- Browser.modernchrome\n- Browser.modernfirefox\n- Browser.randomPrefixOpera\nAgain... consistency folks.\n\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2569#issuecomment-37074072\n.\n. @marcj the thing is that if we \"fix\" browser detection, then 1.5 will break backwards compatibility because it will behave different than 1.4.5 and earlier versions. Splitting this into compat/no-compat builds multiplies the problem by 2 as plugin creators wouldn't even know if they should use Browser.modernie or not because they don't know against which MooTools build they are working (actaully, let's hope no one uses the new flag)\n\nThe fact is nobody should use browser sniffing. There are no legitimate reasons to do that and for the last ~10 releases of jQuery browser sniffing has been gone and I don't see a horde of developers in arms because they lost their precious sniffing abilities. We just need to put up a big sign for whoever that didn't get the memo 2-3 years ago when the collective of developers decided to stop the browser sniffing shenanigans and started using feature detection.\nSo back to square 1: if we go with the \"consistent\" API then we break MooTools for every bad plugin that exists even when it currently works with IE11 because it fails to detect it as such. I don't want to release code that will somehow break code that exists in the wild.\nOur current compat build is not an option, it does a lot more than just set up browser sniffing. \nSo for Olmo's option 4 this could be the case:\n- a dev is using 1.4.5 no-compat and a bunch of third party plugins, everything works fine.\n- some of those plugins are doing crappy browser sniffing, but they do work with IE11 because it's not detecting it.\n- the dev wants to switch to 1.5 to take advantage of all the fixes we did in these last 2 years but if he goes with the compat build a lot of stuff might break (because compat does some things differently and even defines a bunch of globals), and if he goes with no-compat his plugins will break because it will begin detecting IE11 as regular IE.\nRemember we already surveyed the Forge some time ago and there were a lot of plugins in there that are checking Browser.ie without checking for a version, so even before we are out of the gate we know it's going to cause issues with code that has been in the wild for years.\nWe need to give a sane upgrade path to 1.5 that won't cause regressions or issues like the one I described above, and as we all agreed before, kill browser sniffing on the next major release so this will become a non-issue (this includes warning users that this is deprecated in the release blog post).\nIf we fail to give this easy upgrade path then adoption of the new version will be low and we will have failed in our mission.\nTL;DR: wall of text, I know. But please let's settle this so we can :ship:\n. Actually,  because they are sniffs by themselves,  .ie and .firefox\nonly mean that the user agent string looks like one from those browsers.\nNow,  here's some food for thought: why are we still identifying blink as\nwebkit?\n. seems to me that Content-Type should not be set when performing a DELETE request, as there's no content being sent to the server.\nThe RFC doesn't say anything about this, but my common sense says this is a MooTools bug.\n. The problem with allowing the user to bring their own promise\nimplementation is that they are not all directly interoperable.\nFor example jQuery promises have to be casted to an ES6 promise before they\ncan be used with Promise.all\nWe will still end up either adding some shim code or not supporting certain\npromise implementations.\nOn Oct 31, 2014 9:29 PM, \"Arian Stolwijk\" notifications@github.com wrote:\n\nThe user could add a shim of own choosing, and pass the constructor in the\nconcerning object.\nFor example:\nnew Request({\nurl: 'foo.html'\n})\n.withPromise(Promise())\n.then(function(){ ... });\nOr something similar (I'm not very familiar with the exact promise API).\nOn Fri, Oct 31, 2014 at 10:17 PM, Olmo Maldonado notifications@github.com\nwrote:\n\nOnly issue is adopting the ES6 promise would leave a gap for non ES6\nbrowsers. Thus we'd need to create the shim anyway.\n\u2014\nReply to this email directly or view it on GitHub\n<\nhttps://github.com/mootools/mootools-core/issues/2643#issuecomment-61333031>\n.\n\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2643#issuecomment-61344381\n.\n. I will retract this pull request for a bit, I just found #637 and looks like the bug is indeed in getScrolls and not in getPosition.\n. Tests from this patch are all red on Firefox for me, I'm getting undefined in 16 of them. Can anyone else confirm? using Firefox 14 and 15 beta here by the way.\n. .get of an attribute that has no value but exists should definitely be returning an empty string, that's what the browser returns if you do:\n\nvar a = document.createElement('div');\nvar b = document.createAttribute('data-test');\na.setAttributeNode(b);\ndoing a.getAttribute('data-test') returns an empty string, while a.get('data-test') returns null\n. fiddle showing this issue: http://jsfiddle.net/gonchuki/EG9c9/\nI don't see any error on the IE console, but it still fails to apply the styles. Reproducible in all versions available at jsfiddle.\n. I would say that the issue is a little deeper in getComputedStyle as the margin-left of the detached element with no text is returning null, and once you set some text it returns 0px.\nCurious thing is that if you append this element into another one (even if it's also detached) and then you detach the element again you start getting the valid 0px value. Probably an internal IE bug where the detached element gets no layout or even no style attributes at all until you interact with it.\n. edit: what was here was a dumb idea. \ngetting some specs and a proper pull request soon.\n. maybe just normalize this value in prepare? auto is a valid return value from getStyle('top'), for example when the user explicitly sets top: auto it will also fail on Firefox.\n. The problem is, how do you get the real top? if you set position:absolute; bottom: 0; for example, the auto returned from getStyle('top')can't be translated to 0 (see this example: http://jsfiddle.net/xGQkX/5/, works on Firefox, breaks on Chrome).\nDoing this on Element.Style will be actually having logic that naturally belongs to Element.Dimensions (or the Element.Position we don't have). To me the question is: move logic from Dimensions into Style so we never return auto on a getStyle call or add Dimensions as a dependency on Fx.CSS and normalize in there as needed?\n. isn't this fixed by this commit by @arian? \nhttps://github.com/mootools/mootools-core/commit/3927a8a7f7f4ef7d4faa9a3d27ec4d975bc8db5e\n(if that's not the one, there are a couple previous commits that touch that same block of code and relate to Opera)\nAs I see it the previously shipped code had a Browser.opera check inside a Browser.ie condition which rendered that line of code unreachable by Opera (confirmed on a freshly downloaded 1.4.5)\n. according to #2325 this regression was introduced between 1.4.4 and 1.4.5\nalso, the edge build on jsfiddle still exposes this issue.\nHere's a compare view between 1.4.4 and 1.4.5\nalso, someone with powers should mark this or #2325 as a duplicate, it's the same bug.\n. Sorry for the spammy review, hope you don't mind :)\n. I think there are a few issues with your code @arian, for example toggleClass will not do a toggle on each of the passed space-separated classes, and even worse it will go the removeClass route on most cases (element having class A, you call toggleClass(\"A B\"), hasClass(\"A B\") returns false, so you just get a call to removeClass(\"A B\")\nI also like the idea that these functions can accept an array or a function, adds a lot of flexibility.\n. FWIW, the rest of the world seems to be fine by having addClass accept a list of space separated values or an array:\nhttp://api.jquery.com/addClass/\nhttp://dojotoolkit.org/reference-guide/1.7/dojo/addClass.html\nhttp://docs.sencha.com/ext-js/4-1/#!/api/Ext.dom.AbstractElement-method-addCls\nI for one would like more flexibility if we want to keep being relevant. This is core functionality, it shouldn't have to reside on the forge just because you don't like a small chunk of code that needs refactoring anyways.\n. since there's no native Element.prototype.addClass I see no point in replicating the classList API. The only methods that MooTools abides strictly to the specs are the ones that actually work as a shim. Maybe I'm becoming old and someone subreptitiously added a :relay pseudo selector to the addEventListener API while I was away?\nThe point of custom/extended methods in libraries is to be useful where the spec is lacking. There's a lot of potential in allowing multiple classes in these methods, I don't get why you don't see it like that.\n. if these perf numbers are still true for newer Firefox and other browsers alike then I'm all for having this and a plugin on the forge (or -more) for the multiple classes. Else there's no real win other than using native API to manipulate classes.\nIt would be ideal if you can get a jsperf running with this patch.\n. http://jsperf.com/jquery-toggleclass-vs-html5-classlist-toggle\nhttp://jsperf.com/jquery-addclass-vs-html5-classlist-add\nI'm sold.\n. sure, doesn't take away the fact that you could say/exemplify this big performance advantage before closing the other pull request.\nif you check how the thread went it simply looks like you simply didn't want the change to happen and nothing else. Nice fact is that either giving more performance or more flexibility are good things to talk about for next release :)\n. Interesting finding answering to \"what's wrong with addClass('a').addClass('b')\" http://jsperf.com/jquery-addclass-vs-html5-classlist-add/2\nFor some reason MooTools is getting hammered on these browsers I could test on. Good thing this will be a thing of the past for everything but IE9 and lower.\n. Some info on this one: \n- Happens on both IE7 and IE8\n- It's not a regression, I could also reproduce on the fiddle using 1.3.2 and 1.2.5\n- the most I could find out is that this is failing after the first morph, where IE begins returning the style for borderLeft in the wrong order (returning color width style instead of width style color)\nI will keep looking at this, will be back with a pull request if I can find the source of this issue.\n. so the source is simply a bug on IE7/8, where assigning the 3 components of a border side (either via the shorthand or using the 3 individual styles), a later retrieval of that value comes with the aforementioned incorrect order. Note that it also returns the incorrect order when using the border shorthand (that is, setting/getting all 4 borders at once)\nThe only thing I can think of is setting a feature detect for this bug, and in such case get an additional step on getStyle to reorder the components.\nAny voice against this suggestion? else I will get working onto the pull request :)\n. just out of curiosity, does this happen on WP7 pre-Mango or on the current Mango/Tango release?\n. No failing spec but I can make one. Just not sure if this should go in 1.4client folder or create a 1.5 one.\n. I ended up creating my own specs as I wanted to test for all three failing properties (border.*Width was the culprit but it bubbled up to width/height to produce the NaNpx error)\nfor reference, this is the result of the failing specs:\n```\nshould inherit the height from the child\nExpected 'NaNpx' to equal '100px'.\nshould get a pixel based width\nExpected 'NaNpx' to match /\\d+px/.\nshould have a 0px border left\nExpected 'medium' to equal '0px'.\n```\nmy IE is not working right with the test suite so I couldn't run it, but unless these specs uncover new bugs the changed code was already IE-only so there's nothing new there.\n. If you don't mind to merge again/cherry-pick (or manually edit), I acidentally left a trailing comma on the spec\nhttps://github.com/gonchuki/mootools-core/commit/7f59171b1a578fd6fb05ef7f1e93835057cfe79a\n. I can create a new pull request with a rebased version of this if you want to keep a cleaner story on the main repo :)\n. interesting feature @arian, I remember in the past it just used to lose the entire pull request and comment history when you rebased a set of already pull-requested commits :)\n. yeah I noticed it's getting big. There's one small change/optimization I didn't do as part of this patch, the if statement on line 116 could be reduced to this:\nif (!result || property == 'zIndex'){\n    if (Element.ShortStyles.hasOwnProperty(property)){\n        result = [];\n        for (var s in Element.ShortStyles[property]) result.push(this.getStyle(s));\n        return result.join(' ');\n    }\n    result = this.getComputedStyle(property);\n}\nI really have no idea why there's an iteration with a continue statement there. I know it's not much of an improvement but it's a first step on to the right direction. Let me know if you want me to get another pull request on that after we are done with this one.\nAs for doing a whole revamp, I'm afraid we would first need to get a more comprehensive set of specs to avoid getting into regressions or missing the chance to fix other bugs. All my latest patches shown that Element.Styles.js was heavily under-specced.\n. for the record, I installed Win8 Preview on a virtual machine and IE10 exposes the same IE7 and IE8 issue where it returns an empty string for a getStyle('backgroundPosition') on an element that has that style set on the stylesheet. The X/Y decomposition works, and it doesn't seem to return keywords for the components.\nedit: I listed another issue here, that was not true (so confused with 5 different open browser windows plus 2 virtual machines)\n. specs pass, no question. On the original comment on the PR I stated I didn't test on IE10, so the exercise was to confirm if the fixes here also covered any inconsistency that could be still present in IE10. The interesting thing is that in this case IE10 behaves more like IE8 than IE9.\n. sure, slow week(s) at work :)\n. totally right, then I think the next step would be to find out the default on the stylesheet and only null it if it isn't defined or equals 1, not sure if there's any flicker for setting the opacity twice in the same repaint, it shouldn't be but don't know how IE's filters behave in this case.\nI already have an idea for this, let's leave the PR open till I get this coded.\n. I think this is a good compromise, we let the \"old\" code do it's stuff but if the user requested an opacity of 1 we check if the element has a filter set in the CSS that gives it a different value.\nWe can only check this after we already removed the filter, so that's why I left it at the end of the block.\n. blergh, I rebased against master and got a commit that shouldn't be here, let me fix this in a sec...\n. To explain a bit the changes in 1.3 specs, the reason behind that is that setting opacity only affects the filters on oldIE, and since CSS3 has a working draft spec for allowing SVG filters to act on HTML elements which uses the same filter keyword we don't want to run those tests on browsers that support filter but are not using it to set the opacity.\n. let me know if this gets green light so I can rebase to get it ready for a merge.\n. yeah I just squashed my own commits since my rebase on master did ugly stuff a few commits above (the PR included 2 commits that weren't from this branch but were already merged into master). Maybe it's my lack of git-fu \n. I actually like the improved readability with explicitly stating what this points to, and as @kentaromiura says it should be using global to keep it generic.\n. The CSS definition as in what the CSS stylesheet has instead of the manually set style attribute? If that's the question, the answer is a plain no, as we need to return what is currently applied to the element, and you can't always query the CSS stylesheet to check a definition (stylesheets loaded cross-domain can't be read by js for example).\nThat being said, if you inspect this patch it is to actually do less mangling on IE as we were doing too much. The code in that block normalizes cases where IE returns the value on the stylesheet on a getComputedStyle call whereas other browsers return the applied pixel value.\n. careful there, there's no pull request for this bug, that message above is just that this bug was referenced on a fork.\n. ah good, seems I even commented over there a while back. For some reason github didn\u00b4t add the reference here.\nsorry for jumping the gun.\n. I don't understand much what's going on here, could you add some tests to the pull request showing what used to fail before this patch?\n. Indeed, seems to be working with MooTools edge as per this fiddle: http://jsfiddle.net/ZpK8W/1/show/\n. Can you provide more context on this? I tried with 1.2.6, 1.3.2 and 1.4.5 and it seems to be working just fine.\nhttp://jsfiddle.net/atPGJ/2/\n. We can't test if you don't provide what your DOM looks like, as @swhiteman says this seems to be something in your code, and by the looks of it there might be something broken in your DOM that the IE6/7 parser is interpreting differently than other browsers.\nPlease create a fiddle or equivalent (I know jsfiddle.net is broken for IE < 9) where this issue can be reproduced.\n. I like it.\nCould you add some tests for this fix?\n. The problem is in your implementation. You are first detaching two elements with IDs from the DOM, then injecting a copy of them via their HTML representation. Your DOM now has one attached and one detached set of nodes, which are duplicating their IDs. \nTo me, the behavior is correct: IDs are unique, and the DOM might be giving precedence to the attached element, honoring its ID, thus ignoring that your detached element is exposing that same ID. \nOn the other side, the attribute selector is also working correctly: the ID is an attribute just like any other, so when you try using the attribute as an attribute instead of an ID, the selector works.\n. Since MooTools uses getComputedStyle to gather the applied styles, I see no reason for this workaround. If getComputedStyle is returning auto then there's a good reason for it and we should trust what the browser returned in this case because that's what the browser is using internally when rendering the different layers.\n. no, it's returning auto because the browser hasn't applied your z-index (due to the element lacking a non-static position), so there's nothing to fix here.\nThe idea of getStyle is to fix inconsistencies across browsers, but it should not return values that the browser is not applying to an element.\n. I might be getting lost here, but the thing is: is Chrome applying the z-index on a static element? If the answer is \"no\", then auto is a correct value for getStyle.\nWhat I'm trying to highlight here is that if what the browser is rendering matches with what getComputedStyle returns, then there's nothing to fix.\n. I think the only browser sniffing we had remaining was on Element.Style and\nI killed those when \u2013among others\u2013 I fixed IE11 before IE11 was a thing.\n On Nov 26, 2013 8:28 AM, \"Arian Stolwijk\" notifications@github.com wrote:\n\nWe already deprecated flash version detection, we could just deprecate it\nBrowser.name / Browser.version etc. I don't have problems with that. AFAIK\nwe don't really use it ourselves anymore.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2539#issuecomment-29281569\n.\n. @curry684 can you test an edge build of MooTools with your code and tell us if you still need those patches you made?\nI'm interested in knowing if your issue was with the older browser-sniffing code or it's a separate problem that should be fixed by us.\n. in short yeah, the fixes on Element.Style should be what fixed\nElement.Measure (in particular this commit:\nhttps://github.com/mootools/mootools-core/commit/e30d1a019b04261edf06e13e3943ee96b5be1985 should\nbe responsible for that)\n\nOn Mon, Jan 27, 2014 at 5:34 PM, Arian Stolwijk notifications@github.comwrote:\n\nSee #2539 https://github.com/mootools/mootools-core/pull/2539\nBut why is there code (of mootools/mootools-more#1218https://github.com/mootools/mootools-more/issues/1218/\nmootools/mootools-more#1220https://github.com/mootools/mootools-more/pull/1220depending on this anyway. Also I'm wondering if this isn't automatically\nfixed with the changes in Element.Style.js in master, which doesn't depend\non Browser anymore.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2553#issuecomment-33411838\n.\n. aside from the comment on the code, I think we might need to be more lax with the test and not more strict with our code. Firefox returning 0% 0% is actually the same as 0px 0px, and from the various fixes I did around getStyle on 2012 my goal was to stop mangling the units so much and trust what the browser wants to return to us. \n. so I ran the tests and this patch definitely causes regressions.\nin Firefox, IE11 and Chrome:\n\nshould not return a keyword-based background-position shorthand\nExpected '0px 0px' to equal '0% 100%'.\nThis is because as I said above, the modified code short-circuits too early and it's not reading the styles properly.\n. I see @arian already fixed the parentheses, I will rebase against master to make a clean patch. Hold on just a bit.\n. all right, should be safe for merge now.\n. btw, from that suite there are 2 failing cases but seems it's always been like that, I have another backported fix on a different branch that could fix it, but it might also mean \"regressions\" for people that are already accounting for that bug so it might not be a good idea to fix it.\n. 1.5.1 is a bad milestone for this, the patch has nothing to do with 1.5.1\nAlso remember that 1.2.6 was released due to another major issue with specific browsers [1], so I don't see why we shouldn't fix the 1.2.x branch once again with a fix that allows it to keep working correctly on IE >= 10\n. Basically getStyle can return incorrect values for many properties\nbecause it's using the incorrect code paths, and I also extended the fix to\nopacity and floats which also depended on browser sniffing.\nThe original report actually came 1 year after we landed the patch in\nmaster and it was in relation to getStyle('height') returning auto\ninstead of the actual computed value. I quickly identified this as\nsomething that we had actually fixed, the only issue was the same as today:\nwe need to release.\nAs per this 1.2x patch the idea was that many people could still be stuck\non this branch and locked out of IE11, so this would act as a compatibility\nfix to let them stay on 1.2x until they are ready to jump to 1.5\n. This is a mootools-more issue and already reported at mootools/mootools-more#1223\n. Please check the comment I left on @timwienk's repo. We need to convert the IE11 stuff into its own pull request.\n. Option 1 is the only one that makes sense.\nMicrosoft doesn't want IE11+ to get clumped together with the older IE's,\nso why should we do it?\nOn Fri, Mar 7, 2014 at 2:55 PM, Aaron Newton notifications@github.comwrote:\n\n++ for Option 1.\n\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2569#issuecomment-37043247\n.\n. Olmo, you are not showing a legitimate reason there... I mean, that example\nyou gave is the only thing I can think of.\n\nSo the question is: do we have any legitimate reasons for why somebody\nwould want to put IE11 in the same bag as old IE?\nIf not, then what's wrong about making it more difficult for fanboys and\nbad coders alike?\nOn Fri, Mar 7, 2014 at 7:08 PM, Olmo Maldonado notifications@github.comwrote:\n\nMy reason for Option 4 is simple:\nFor 99.9% of the folks nothing will have changed with the compat build\n(the default build). For the 100% of the developers like me that want to\nknow if my user is on an Internet Explorer browser all I want to do is:\nif (Browser.ie) alert(\"I'm a Google Chrome fanboi, why don't you switch.\");\nInstead of:\nif (Browser.ie || Browser.modernie) alert(\"... sucks that I have to try other flags :-\\\");\nIn other terms: our Browser. API just says what browser we're on.\nFolks that are using it (even we're at fault at some point) for feature\ndetection are using it for the wrong purposes. Yes let's advocate for\nnot using Browser. for feature detection but let's not cripple\nour API for all of us.\nAgain, for folks are are not up to date with the best practices and\nmaintain their code up, they can just use the compat version which\nBrowser.ie returns null. No difference from 1.4.5 and 1.5. Now I'm just\narguing that we don't need to add unnecessary flags or logic. Just fix\nBrowser.ie as it should be, and put the responsibility of using the right\ncode/practices to the developer -- as it should be.\n\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2569#issuecomment-37067774\n.\n. Nah, in the future we would be deprecating browser sniffing. We are not\ndoing that right now because we want to ship 1.5 before 2015\nOn Mar 7, 2014 8:18 PM, \"Olmo Maldonado\" notifications@github.com wrote:\nHere's an idea of a legitimate use case. Alex Russell has talked about\ncaching feature detection by using user sniffing (\nhttp://infrequently.org/2011/01/cutting-the-interrogation-short/). If we\ncripple Browser.ie someone (in the future) would have to look for\nBrowser.ie and Browser.modernie and to be future proof will likely check\nfor:\n- Browser.modernchrome\n- Browser.modernfirefox\n- Browser.randomPrefixOpera\nAgain... consistency folks.\n\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2569#issuecomment-37074072\n.\n. @marcj the thing is that if we \"fix\" browser detection, then 1.5 will break backwards compatibility because it will behave different than 1.4.5 and earlier versions. Splitting this into compat/no-compat builds multiplies the problem by 2 as plugin creators wouldn't even know if they should use Browser.modernie or not because they don't know against which MooTools build they are working (actaully, let's hope no one uses the new flag)\n\nThe fact is nobody should use browser sniffing. There are no legitimate reasons to do that and for the last ~10 releases of jQuery browser sniffing has been gone and I don't see a horde of developers in arms because they lost their precious sniffing abilities. We just need to put up a big sign for whoever that didn't get the memo 2-3 years ago when the collective of developers decided to stop the browser sniffing shenanigans and started using feature detection.\nSo back to square 1: if we go with the \"consistent\" API then we break MooTools for every bad plugin that exists even when it currently works with IE11 because it fails to detect it as such. I don't want to release code that will somehow break code that exists in the wild.\nOur current compat build is not an option, it does a lot more than just set up browser sniffing. \nSo for Olmo's option 4 this could be the case:\n- a dev is using 1.4.5 no-compat and a bunch of third party plugins, everything works fine.\n- some of those plugins are doing crappy browser sniffing, but they do work with IE11 because it's not detecting it.\n- the dev wants to switch to 1.5 to take advantage of all the fixes we did in these last 2 years but if he goes with the compat build a lot of stuff might break (because compat does some things differently and even defines a bunch of globals), and if he goes with no-compat his plugins will break because it will begin detecting IE11 as regular IE.\nRemember we already surveyed the Forge some time ago and there were a lot of plugins in there that are checking Browser.ie without checking for a version, so even before we are out of the gate we know it's going to cause issues with code that has been in the wild for years.\nWe need to give a sane upgrade path to 1.5 that won't cause regressions or issues like the one I described above, and as we all agreed before, kill browser sniffing on the next major release so this will become a non-issue (this includes warning users that this is deprecated in the release blog post).\nIf we fail to give this easy upgrade path then adoption of the new version will be low and we will have failed in our mission.\nTL;DR: wall of text, I know. But please let's settle this so we can :ship:\n. Actually,  because they are sniffs by themselves,  .ie and .firefox\nonly mean that the user agent string looks like one from those browsers.\nNow,  here's some food for thought: why are we still identifying blink as\nwebkit?\n. seems to me that Content-Type should not be set when performing a DELETE request, as there's no content being sent to the server.\nThe RFC doesn't say anything about this, but my common sense says this is a MooTools bug.\n. The problem with allowing the user to bring their own promise\nimplementation is that they are not all directly interoperable.\nFor example jQuery promises have to be casted to an ES6 promise before they\ncan be used with Promise.all\nWe will still end up either adding some shim code or not supporting certain\npromise implementations.\nOn Oct 31, 2014 9:29 PM, \"Arian Stolwijk\" notifications@github.com wrote:\n\nThe user could add a shim of own choosing, and pass the constructor in the\nconcerning object.\nFor example:\nnew Request({\nurl: 'foo.html'\n})\n.withPromise(Promise())\n.then(function(){ ... });\nOr something similar (I'm not very familiar with the exact promise API).\nOn Fri, Oct 31, 2014 at 10:17 PM, Olmo Maldonado notifications@github.com\nwrote:\n\nOnly issue is adopting the ES6 promise would leave a gap for non ES6\nbrowsers. Thus we'd need to create the shim anyway.\n\u2014\nReply to this email directly or view it on GitHub\n<\nhttps://github.com/mootools/mootools-core/issues/2643#issuecomment-61333031>\n.\n\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2643#issuecomment-61344381\n.\n. \n",
    "kilianc": "thanks i'll run some speed test about number and digits, i think extra precision is not needed \n. rollout Math.PI * 0.5 it is a constant.\n. i'm just figuring this out. i'm using Fx.Transition to do some tween on object properties i'll post my example soon :)\n. ## Tests done with firebug profiler (@ibolmo)\nvar how = 1000000;\nvar i;\nfunction f1() { for(i = 0; i < how; ++i) 50 * 0.001; }\nfunction f2() { for(i = 0; i < how; ++i) 50 * 1e-3; }\n\n\nFunctionCalls%Overall TimeAverage TimeMin TimeMax Time\n\n\nf11050.54%4157.706ms415.771ms414.545ms417.134ms\n\n\nf21049.73%4117.285ms411.729ms409.465ms413.082ms\n\n\n. all fix done; speedup scouting can go on. i'll use all my as3 experience.\n. This was my first thought, but the problem' still here. we can't sync animations 'cose every Fx instance has its own timer.\nWe need a solution.\n. thanks i'll run some speed test about number and digits, i think extra precision is not needed \n. rollout Math.PI * 0.5 it is a constant.\n. i'm just figuring this out. i'm using Fx.Transition to do some tween on object properties i'll post my example soon :)\n. ## Tests done with firebug profiler (@ibolmo)\nvar how = 1000000;\nvar i;\nfunction f1() { for(i = 0; i < how; ++i) 50 * 0.001; }\nfunction f2() { for(i = 0; i < how; ++i) 50 * 1e-3; }\n\n\nFunctionCalls%Overall TimeAverage TimeMin TimeMax Time\n\n\nf11050.54%4157.706ms415.771ms414.545ms417.134ms\n\n\nf21049.73%4117.285ms411.729ms409.465ms413.082ms\n\n\n. all fix done; speedup scouting can go on. i'll use all my as3 experience.\n. This was my first thought, but the problem' still here. we can't sync animations 'cose every Fx instance has its own timer.\nWe need a solution.\n. ",
    "sebmarkbage": "Nice work. As an incentive, I offer $50 to anyone that can provide a real world use case where this fix provides a noticeable difference to an end-user.\nNote: I'm not trying to be a smart ass. I'm seriously curious.\n. Ordered enumeration may well be standardized later on but it's unclear how that process will look. Until then, this is invalid.\nOne alternative is this map implementation that preserves enumeration order and allows Object keys. https://github.com/kamicane/mootools-table/blob/master/Source/Table.js\n. There are plenty parts of the second argument that we can implement to useful purpose, although not fully.\nhttps://github.com/calyptus/coretools/blob/master/Source/Core.ES5/Object.Properties.js\nI respect the veto but I'd like to make sure we're thinking this through. Let's go through the reasoning one more time. Why is it wrong the implement a subset of the API if only a subset is promised?\nWell, you can't do feature detection. E.g. if (Object.create) ... However, you can't do that anyway because browsers WILL implement a subset of the API. So, that's not a good argument.\nThe other argument would be expectation based on a standard. Well, that standard isn't implemented properly anywhere so the expectation should be that it's a subset.\nAdditionally, none of our other shims strictly corresponds to the ECMA standard anyway. Some of the more esoteric uses are excluded for convenience. Does this mean that we should double our code base to strictly comply with our other shims?\n. IMO, the duration value shouldn't be 0 as this is a useful value on it's own. It's also a breaking change. For continuous animation the duration should be the numeric value Infinity and the duration name should be \"infinite\".\n. You should not check for hasOwnProperty on the enumerated object since that excludes any inherited properties from a prototype.\nAnother way is to check equality to the original Object value. https://github.com/calyptus/coretools/blob/master/Source/Core/Core.js#L15\nThat causes problems if you later specify another property that has the exact same value as the original Object prototype. But that's a much more esoteric use case than enumerating inherited properties.\nTake this for example:\n``` javascript\nvar MyClass = new Class({\n  options: { toString: true },\n  initialize: function(){\n    Object.forEach(this.options, function(value, key){ console.log(key); });\n  }\n});\n```\n. I think it makes sense to have a special case for the type property since this is a very unique case. AFAIK It's the only attribute that changes the behavior of a DOM element.\nIt may also be difficult to control the order in which properties are defined. For example if you're merging two property objects (options) and either one can have type or value. E.g:\nnew Element('input', Object.append({ type: 'defaultType', value: 'defaultValue' }, options));\nI think the solution is not to enforce a certain order, because that makes chained set calls inconsistent. Instead, \"type\" should have a propertySetter that reads the current values and re-sets them after the type has changed. But that is a slight performance hit for all input element creation. Although minimal.\n. Where it works, it works. Where it can't, it won't. :)\nIt rarely makes sense to dynamically change the type of an input element. This fix only applies where it does make sense. Initialization in particular.\n. This patch isn't to allow changing type attribute once set. It's to allow the type and value properties to be initialized out-of-order.\n. The event.key property is only valid during keydown and keyup events.\n. There may be a much simpler solution to it. Simply remove the attributeGetter all together.\nI opened a pull request on the slick repository to continue the discussion about whether that's safe or not.\nhttps://github.com/mootools/slick/pull/66\n. I don't know of any protocol where a DELETE body is valid. Not in WebDav, S3, Azure... I think this should be safe to implement.\n. Note that Request.JSON is designed to parse a JSON response, not send a JSON request. It was often used to POST form-encoded data to things like plain PHP pages.\nSince then, RPC-like calls have been more popular. The default content-type shouldn't be changed. There could be an option flag. However there are better, completely different, API suggestions that is more likely to replace Request.JSON.\n. @shaundunne The UA string can be changed from the Develop -> User Agent menu in Safari. Please make sure you have it set to Safari or Automatic. Not one of Safari iOS versions.\n. @juliohp The problem is with http://www8.hp.com/us/en/scripts/hf-core-hpe.js\nYou're passing the option hideEvent:'' in several places which causes the custom class to listen for the \"\" event. The fix you proposed would solve the symptom but not the problem.\nIt would probably be nice if we checked for == null instead of ! though. Just to make sure \"\" events are supported.\nBut that's a weird edge case. You should probably fix your CHKCustomPopUp class to ignore '' events.\n. This code is there for a reason. Old IE has a memory leak (before IE 9). If you attach properties or event listeners to IE elements, the attached objects can't be garbage collected if they reference the element itself. I.e. the garbage collector can't traverse through the element to resolve circular references. Since almost all event listeners and attached methods have indirect access to the element, it's almost impossible to avoid those memory leaks.\nYou have to manually remove all expando properties and listeners from the element to allow the element to be freed. You should use the destroy() feature to manually free up those memory leaks. If you forget, MooTools will keep track of your references for you, and then destroy them as the user leaves the page. However, yes, they will hang around until the user leaves the page (unload event).\nSince there are no weak references in old IE, there's no other way to work around this issue without possibly carefully crafting all your code to specifically avoid that IE bug.\nRemoving it completely will cause a leak in IE that persists even after the user has left the page.\n. There is some chance there might be Object.extend and more as well.\n. We did end up changing method signature for bind and had a tutorial for upgrading: https://github.com/mootools/mootools-core/wiki/Update-from-1.2-to-1.3\nWe already had a suitable alternative.\nThere was some projects that couldn't update to 1.3 for a long time, for various reasons (most notably Joomla). So there was also a minor revision update 1.2.5. For whatever reason that version only fixed bind specifically. Not the real issue. It wasn't until 1.3 all native methods were overridden. Maybe there needs to be a 1.2.6 release to allow for a quick fix.\n. Nice work. As an incentive, I offer $50 to anyone that can provide a real world use case where this fix provides a noticeable difference to an end-user.\nNote: I'm not trying to be a smart ass. I'm seriously curious.\n. Ordered enumeration may well be standardized later on but it's unclear how that process will look. Until then, this is invalid.\nOne alternative is this map implementation that preserves enumeration order and allows Object keys. https://github.com/kamicane/mootools-table/blob/master/Source/Table.js\n. There are plenty parts of the second argument that we can implement to useful purpose, although not fully.\nhttps://github.com/calyptus/coretools/blob/master/Source/Core.ES5/Object.Properties.js\nI respect the veto but I'd like to make sure we're thinking this through. Let's go through the reasoning one more time. Why is it wrong the implement a subset of the API if only a subset is promised?\nWell, you can't do feature detection. E.g. if (Object.create) ... However, you can't do that anyway because browsers WILL implement a subset of the API. So, that's not a good argument.\nThe other argument would be expectation based on a standard. Well, that standard isn't implemented properly anywhere so the expectation should be that it's a subset.\nAdditionally, none of our other shims strictly corresponds to the ECMA standard anyway. Some of the more esoteric uses are excluded for convenience. Does this mean that we should double our code base to strictly comply with our other shims?\n. IMO, the duration value shouldn't be 0 as this is a useful value on it's own. It's also a breaking change. For continuous animation the duration should be the numeric value Infinity and the duration name should be \"infinite\".\n. You should not check for hasOwnProperty on the enumerated object since that excludes any inherited properties from a prototype.\nAnother way is to check equality to the original Object value. https://github.com/calyptus/coretools/blob/master/Source/Core/Core.js#L15\nThat causes problems if you later specify another property that has the exact same value as the original Object prototype. But that's a much more esoteric use case than enumerating inherited properties.\nTake this for example:\n``` javascript\nvar MyClass = new Class({\n  options: { toString: true },\n  initialize: function(){\n    Object.forEach(this.options, function(value, key){ console.log(key); });\n  }\n});\n```\n. I think it makes sense to have a special case for the type property since this is a very unique case. AFAIK It's the only attribute that changes the behavior of a DOM element.\nIt may also be difficult to control the order in which properties are defined. For example if you're merging two property objects (options) and either one can have type or value. E.g:\nnew Element('input', Object.append({ type: 'defaultType', value: 'defaultValue' }, options));\nI think the solution is not to enforce a certain order, because that makes chained set calls inconsistent. Instead, \"type\" should have a propertySetter that reads the current values and re-sets them after the type has changed. But that is a slight performance hit for all input element creation. Although minimal.\n. Where it works, it works. Where it can't, it won't. :)\nIt rarely makes sense to dynamically change the type of an input element. This fix only applies where it does make sense. Initialization in particular.\n. This patch isn't to allow changing type attribute once set. It's to allow the type and value properties to be initialized out-of-order.\n. The event.key property is only valid during keydown and keyup events.\n. There may be a much simpler solution to it. Simply remove the attributeGetter all together.\nI opened a pull request on the slick repository to continue the discussion about whether that's safe or not.\nhttps://github.com/mootools/slick/pull/66\n. I don't know of any protocol where a DELETE body is valid. Not in WebDav, S3, Azure... I think this should be safe to implement.\n. Note that Request.JSON is designed to parse a JSON response, not send a JSON request. It was often used to POST form-encoded data to things like plain PHP pages.\nSince then, RPC-like calls have been more popular. The default content-type shouldn't be changed. There could be an option flag. However there are better, completely different, API suggestions that is more likely to replace Request.JSON.\n. @shaundunne The UA string can be changed from the Develop -> User Agent menu in Safari. Please make sure you have it set to Safari or Automatic. Not one of Safari iOS versions.\n. @juliohp The problem is with http://www8.hp.com/us/en/scripts/hf-core-hpe.js\nYou're passing the option hideEvent:'' in several places which causes the custom class to listen for the \"\" event. The fix you proposed would solve the symptom but not the problem.\nIt would probably be nice if we checked for == null instead of ! though. Just to make sure \"\" events are supported.\nBut that's a weird edge case. You should probably fix your CHKCustomPopUp class to ignore '' events.\n. This code is there for a reason. Old IE has a memory leak (before IE 9). If you attach properties or event listeners to IE elements, the attached objects can't be garbage collected if they reference the element itself. I.e. the garbage collector can't traverse through the element to resolve circular references. Since almost all event listeners and attached methods have indirect access to the element, it's almost impossible to avoid those memory leaks.\nYou have to manually remove all expando properties and listeners from the element to allow the element to be freed. You should use the destroy() feature to manually free up those memory leaks. If you forget, MooTools will keep track of your references for you, and then destroy them as the user leaves the page. However, yes, they will hang around until the user leaves the page (unload event).\nSince there are no weak references in old IE, there's no other way to work around this issue without possibly carefully crafting all your code to specifically avoid that IE bug.\nRemoving it completely will cause a leak in IE that persists even after the user has left the page.\n. There is some chance there might be Object.extend and more as well.\n. We did end up changing method signature for bind and had a tutorial for upgrading: https://github.com/mootools/mootools-core/wiki/Update-from-1.2-to-1.3\nWe already had a suitable alternative.\nThere was some projects that couldn't update to 1.3 for a long time, for various reasons (most notably Joomla). So there was also a minor revision update 1.2.5. For whatever reason that version only fixed bind specifically. Not the real issue. It wasn't until 1.3 all native methods were overridden. Maybe there needs to be a 1.2.6 release to allow for a quick fix.\n. ",
    "Savageman": "I'm suggesting adding a comment next to 1.570796, so we know it's PI / 2.\n. I'm suggesting adding a comment next to 1.570796, so we know it's PI / 2.\n. ",
    "digitarald": "I'd say it fixes bugs, since the regular expressions in some places are simply wrong because they match more than they should.\n. - Tested in IE7/8, Safari, Chrome and FF 3.6.\n- No. They are not severe, just unclean coding styles and too lax expressions.\n. Tested against the current specs, nothing added. As the description states, the objective of this commit is not a bug-fix but better practices and performance.\n. Interesting thread, I am still waiting for the happy ending. There is maybe no need to use project management buzzwords, just encourage and track communication better. Why not just create a ticket for a feature first, get the issue signed off, code and create pull request with reference to the ticket.\nOne rule: No pull request without ticket..\nSteps:\n1. Create ticket and discuss issue\n2. Code on feature branch (bug-XYZ)\n3. Create pull request and discuss code\n4. PROFIT\nIt requires sticking to the flow but generates a nice paper trail and documentation. This flow does not need a benevolent dictator, sign off can be driven by the core team.\nToo simple? Too hard? Too good to be true?\n. I'd say it fixes bugs, since the regular expressions in some places are simply wrong because they match more than they should.\n. - Tested in IE7/8, Safari, Chrome and FF 3.6.\n- No. They are not severe, just unclean coding styles and too lax expressions.\n. Tested against the current specs, nothing added. As the description states, the objective of this commit is not a bug-fix but better practices and performance.\n. Interesting thread, I am still waiting for the happy ending. There is maybe no need to use project management buzzwords, just encourage and track communication better. Why not just create a ticket for a feature first, get the issue signed off, code and create pull request with reference to the ticket.\nOne rule: No pull request without ticket..\nSteps:\n1. Create ticket and discuss issue\n2. Code on feature branch (bug-XYZ)\n3. Create pull request and discuss code\n4. PROFIT\nIt requires sticking to the flow but generates a nice paper trail and documentation. This flow does not need a benevolent dictator, sign off can be driven by the core team.\nToo simple? Too hard? Too good to be true?\n. ",
    "vitotafuni": "sorry... so what's the right way to verify if a variable is undefined?\ni have to use 'type of' directly in my code?\n. ok thank you both\nkamicane: typeof is native and accept undefined vars ;-p\n. sorry... so what's the right way to verify if a variable is undefined?\ni have to use 'type of' directly in my code?\n. ok thank you both\nkamicane: typeof is native and accept undefined vars ;-p\n. ",
    "FabianBeiner": "Okey, I agree. I've just seen some scripts what actually handle it like I do (addClass with multiple classes), so I thought it would be neat to allow it on the remove part also. \n. Yes, which is another reason I would love to see addClasses and removeClasses (or generally handle it as e.g. jQuery  does it - \"Remove a single class, multiple classes, or all classes\"). And since the code for this is already given, I don't see the reason to not add it. But otherwise I can add those functions to my scripts myself. As said, I just thought it would be nice to have such a functionality some way.\n. Closing since nobody cares.\n. Since you already put F13 in there, don't you want to add F14-F19 (Apple extended keyboard) too?\n. Oh, didn't see that. ;) Yes, there are Apple keyboards with F13-F19. No idea how often they're used nowadays.\n. Thanks. :) I did some smaller changes on the commit of last night (I was really tired...) and went on with Core.md.\nAs said, it's just a try, no idea if it works for you. :)\n. Works for me too. Firefox 11 and Windows 7. \n. Okey, I agree. I've just seen some scripts what actually handle it like I do (addClass with multiple classes), so I thought it would be neat to allow it on the remove part also. \n. Yes, which is another reason I would love to see addClasses and removeClasses (or generally handle it as e.g. jQuery  does it - \"Remove a single class, multiple classes, or all classes\"). And since the code for this is already given, I don't see the reason to not add it. But otherwise I can add those functions to my scripts myself. As said, I just thought it would be nice to have such a functionality some way.\n. Closing since nobody cares.\n. Since you already put F13 in there, don't you want to add F14-F19 (Apple extended keyboard) too?\n. Oh, didn't see that. ;) Yes, there are Apple keyboards with F13-F19. No idea how often they're used nowadays.\n. Thanks. :) I did some smaller changes on the commit of last night (I was really tired...) and went on with Core.md.\nAs said, it's just a try, no idea if it works for you. :)\n. Works for me too. Firefox 11 and Windows 7. \n. ",
    "theshock": "According to http://mootools.net/docs/core/Types/String#String:hyphenate the correct result is 'I-like-cookies'.\nSo, I think, the code, or the docs should be fixed)\n. ok) hope, it will be fixed)\n. Should i reopen it?\nMutator is nice idea, but what with Implements? This will not work\n    var Bar = new Class({\n        Implements : [ Foo ]\n    });\nAnd\n    var Foo = new Class({\n        get test() {\n            console.log('Getter Foo.test');\n            return this._test + '!!!';\n        },\n        set test(val) {\n            console.log('Setter Foo.test');\n            this._test = val * 10;\n        }\n    });\nis much better, than\n    var Foo = new Class({\n        Properties : {\n            get test() {\n                console.log('Getter Foo.test');\n                return this._test + '!!!';\n            },\n            set test(val) {\n                console.log('Setter Foo.test');\n                this._test = val * 10;\n            }\n        }\n    });\n. Can it be undocumented? Usually I don't need IE (creating apps with canvas, server-side) - the MooTools is ideal for it. That will not impact other projects. We are not loosing IE support because of this patch.\n. Guys, no offence, but I think that it's bug and I'll try to explain you my position.\nThere are a lot of things in Html5, JavaScript and MooTools, that IE6 doesn't support. \nE.g. I can try run $$('canvas').getContext('2d') via MooTools \u0430nd IE will throw Exception, but other browsers will work normally.\nWhen I write such code\n    new Class({\n        set prop : function (val) {},\n        get prop : function () {}\n    });\nI am expecting such consequence:\nIE will cause exception, because it can't even parse this code, and MooTools doesn't have any relation to this\nIn other browsers I expect, that MooTools creates setters, but not just copies values!\nMooTools is often used to create server applications and canvas applications (http://libcanvas.com/ framework use it as platform). And all abilities of browsers are important here.\nIf I have to support IE - I just don't use setters and getters - no parse errors and MooTools doesn't change its behavior.\nI think that using getters and setters is like using canvas, video or audio tag - we shouldn't ban this feature for developers because IE doesn't support it, as we don't ban calling $$('canvas'), $$('audio') or $$('video') tag. \nIt doesn't affect developers, who create their apps for IE in any way.\nBut it's great ability for developers who create their apps based on node.js or using canvas.\nI think that users of MooTools have a right to choose\n. According to http://mootools.net/docs/core/Types/String#String:hyphenate the correct result is 'I-like-cookies'.\nSo, I think, the code, or the docs should be fixed)\n. ok) hope, it will be fixed)\n. Should i reopen it?\nMutator is nice idea, but what with Implements? This will not work\n    var Bar = new Class({\n        Implements : [ Foo ]\n    });\nAnd\n    var Foo = new Class({\n        get test() {\n            console.log('Getter Foo.test');\n            return this._test + '!!!';\n        },\n        set test(val) {\n            console.log('Setter Foo.test');\n            this._test = val * 10;\n        }\n    });\nis much better, than\n    var Foo = new Class({\n        Properties : {\n            get test() {\n                console.log('Getter Foo.test');\n                return this._test + '!!!';\n            },\n            set test(val) {\n                console.log('Setter Foo.test');\n                this._test = val * 10;\n            }\n        }\n    });\n. Can it be undocumented? Usually I don't need IE (creating apps with canvas, server-side) - the MooTools is ideal for it. That will not impact other projects. We are not loosing IE support because of this patch.\n. Guys, no offence, but I think that it's bug and I'll try to explain you my position.\nThere are a lot of things in Html5, JavaScript and MooTools, that IE6 doesn't support. \nE.g. I can try run $$('canvas').getContext('2d') via MooTools \u0430nd IE will throw Exception, but other browsers will work normally.\nWhen I write such code\n    new Class({\n        set prop : function (val) {},\n        get prop : function () {}\n    });\nI am expecting such consequence:\nIE will cause exception, because it can't even parse this code, and MooTools doesn't have any relation to this\nIn other browsers I expect, that MooTools creates setters, but not just copies values!\nMooTools is often used to create server applications and canvas applications (http://libcanvas.com/ framework use it as platform). And all abilities of browsers are important here.\nIf I have to support IE - I just don't use setters and getters - no parse errors and MooTools doesn't change its behavior.\nI think that using getters and setters is like using canvas, video or audio tag - we shouldn't ban this feature for developers because IE doesn't support it, as we don't ban calling $$('canvas'), $$('audio') or $$('video') tag. \nIt doesn't affect developers, who create their apps for IE in any way.\nBut it's great ability for developers who create their apps based on node.js or using canvas.\nI think that users of MooTools have a right to choose\n. ",
    "appden": "Why was this closed without any comment?  This functionality can be partially achieved using this Class mutator: https://gist.github.com/702912\n. I agree that I would like this functionality in Class, but putting it into -core wouldn't fit with its philosophy of having features work across browsers.  This should, however, be added in -more as an extension.  It's tricky, and may require a little adjustment in -core to make it work, but I think that's the best approach so that the majority of our users don't have to download extra unwanted bits.  How does that sound?\n. I adjusted your commit and they put it into -core, so I hope you use this to create awesome delegation support in -more!\nhttps://github.com/appden/mootools-core/commit/46c4b67ff1be8e132c7d5697def4a914834ba72a\n. Why was this closed without any comment?  This functionality can be partially achieved using this Class mutator: https://gist.github.com/702912\n. I agree that I would like this functionality in Class, but putting it into -core wouldn't fit with its philosophy of having features work across browsers.  This should, however, be added in -more as an extension.  It's tricky, and may require a little adjustment in -core to make it work, but I think that's the best approach so that the majority of our users don't have to download extra unwanted bits.  How does that sound?\n. I adjusted your commit and they put it into -core, so I hope you use this to create awesome delegation support in -more!\nhttps://github.com/appden/mootools-core/commit/46c4b67ff1be8e132c7d5697def4a914834ba72a\n. ",
    "keeto": "The issue is with browser compatibility. While the idea is interesting, the fact that the same behaviour cannot be reproduced in all supported browsers makes it impossible to include the functionality into core.\nThe base functionality of core is expected to be the same in all browsers, not just a subset. We can add this once the last supported browser without a accessor/mutator support (IE7) becomes phased-out.\n. @theshock: Documented or not, it needs to work on all browsers in order to be included into core. We have dozens of undocumented features in core, but all of them work regardless of which browser is hosting the environment.\nAs @cpojer said, this would be great if it could be used via a third party plugin. It's a pity that the key-based mutator functionality in 2.0 wasn't included into 1.3, as that would allow us to implement this without having to hack Class itself.\n. @theshock: I understand that you want this feature into Class, and most of us here agree with you that it is indeed interesting to have this\u2014but it can't go into Core because it's not possible to emulate the behavior IE. That's the bottom line.\nYour example, $$('canvas').getContext('2d'), doesn't apply here because it doesn't even work\u2014in any browser. We don't export all native element methods in Elements.\nIt will work, however, if you do $$('canvas')[0].getContext('2d') or $$('canvas').map(functionn(el){ return el.getContext('2d'); });--but the fact that this won't work in IE has less to do with MooTools not supporting IE and more of IE not supporting the canvas object. In other words, the MooTools specific part of the expression ($$, and map) will still work, but the non-MooTools API item (getContext), will error out because the browser itself doesn't support it.\nThere lies the difference. All Core functions, classes and native extensions are written so that they'll be able to run regardless of the host environment. There isn't a Core API that will work in only a subset.\nBut as @cpojer, @appden and I have said, we'd like to see this functionality too--although as an extension rather than as part of Core itself. As I've mentioned, one way to go about this would be to implement the key-based mutator feature from 2.0. I'm willing to help out in porting that into the current Class implementation (I need it too for some things I'm working on).\n. The issue is with browser compatibility. While the idea is interesting, the fact that the same behaviour cannot be reproduced in all supported browsers makes it impossible to include the functionality into core.\nThe base functionality of core is expected to be the same in all browsers, not just a subset. We can add this once the last supported browser without a accessor/mutator support (IE7) becomes phased-out.\n. @theshock: Documented or not, it needs to work on all browsers in order to be included into core. We have dozens of undocumented features in core, but all of them work regardless of which browser is hosting the environment.\nAs @cpojer said, this would be great if it could be used via a third party plugin. It's a pity that the key-based mutator functionality in 2.0 wasn't included into 1.3, as that would allow us to implement this without having to hack Class itself.\n. @theshock: I understand that you want this feature into Class, and most of us here agree with you that it is indeed interesting to have this\u2014but it can't go into Core because it's not possible to emulate the behavior IE. That's the bottom line.\nYour example, $$('canvas').getContext('2d'), doesn't apply here because it doesn't even work\u2014in any browser. We don't export all native element methods in Elements.\nIt will work, however, if you do $$('canvas')[0].getContext('2d') or $$('canvas').map(functionn(el){ return el.getContext('2d'); });--but the fact that this won't work in IE has less to do with MooTools not supporting IE and more of IE not supporting the canvas object. In other words, the MooTools specific part of the expression ($$, and map) will still work, but the non-MooTools API item (getContext), will error out because the browser itself doesn't support it.\nThere lies the difference. All Core functions, classes and native extensions are written so that they'll be able to run regardless of the host environment. There isn't a Core API that will work in only a subset.\nBut as @cpojer, @appden and I have said, we'd like to see this functionality too--although as an extension rather than as part of Core itself. As I've mentioned, one way to go about this would be to implement the key-based mutator feature from 2.0. I'm willing to help out in porting that into the current Class implementation (I need it too for some things I'm working on).\n. ",
    "nbaksalyar": "Nice idea, I think that it'll be rather useful.\n. Nice idea, I think that it'll be rather useful.\n. ",
    "csuwildcat": "Good point, just ice it until I can write some tomorrow :)\n. Test page: http://people.mozilla.com/~dbuchner/demos/web/Event.Delegation/\n. Commented version of the source: http://paste.mootools.net/f7e6e9201\nIf for any reason you see a line that doesn't seem to matter, please let me know and I will explain it as soon as I can.\n. I have read the spec, and I must admit, it seems to indicate that IE is doing this correctly. This flow works for textareas and text inputs because you don't want change to fire on every keypress. However, on all other browsers since I can remember, the sane implementation for inputs such as radios and checkboxes is to have the change event fire when the change occurs. The current IE behavior is not inline with other browsers and is basically useless for these inputs. If I'm the developer and I user clicks a checkbox 5000 to change it from checked to unchecked, I want to know when that change occurs, not on the 5001st click 20 minutes later when it is irrelevant.\n. Well it is the standard in ALL browsers other than IE, and I have it on good authority that no one is going to deviate from it. In fact, IE will be changing to follow. The take-away: We need to fix this shit ASAP.\n. Sorry for the other changes in there, just grab the last one.\n. I am, indeed, a perennial git n00b, but I write code just fine, so now what? Still WINNING!\n. opening fresh pull with w00fz changes and none of the unrelated commits from my repo.\n. Closing this out while I ponder a more compatible solution...\n. shit, ignore that commit regarding the inject stuff (hash: 2fdefb1) it is unrelated, fucking git.\n. I am pulling this request, even after reworking it to be more performant, it was still 10x slower than the original that doesn't allow the passing of subsequent variables.\n. A) You can tweak it however you like, it's still is doing the same job. I would say that snapping the base function out to a separate var is a bit unnecessary and pedantic. Also, in the keychange custom event, the condition's inline instantiation of an array and the subsequent indexOf look-up are MUCH slower than a case statement (jsperf if if you are interested).\nB) I am stunned that you think this should be a plugin or in More. The idea that we should leave a pretty common native event broken in our library is ridiculous and arbitrary. Why not randomly throw out other basic cross browser stuff? How about we toss addEvent and make people do both for attaching events, asinine, obviously.\nCheck, mate.\n. Oh and here is the test: add a regular change event in IE to a checkbox and set of radios, then click one, proceed to watch it actually fire instead of waiting until the users randomly does something else and blurs it. The way IE does it now is totally pointless; shit, it could basically never fire even if a change has occurred, terrible, terrible, terrible.\n. Soooo, I tested that test page you sent and it already shows the IE fix in action and working. I added this to test the \"native\" change event side of it:\njavascript\n$$('input.someClass,select,input[type=\"checkbox\"],input[type=\"radio\"]').addEvent('change', function(){\n    log('native change', true);\n});\nI couldn't add that to the 1.4 specs, I can't seem to find that branch in anything by the Github GUI and it won't let me touch it...can you just put that little code snipped in for me?\n. In IE (LTE 8), native change does not fire until after the input control is blurred. This is counter to the behavior of every other browser, which all fire at the time the change occurs. For example, in IE if you click a checkbox, even though it changes state right before your eyes, you could sit there for hours, strike that, until the Mayans come back with aliens in 2012, and that shit won't fire.\nThis patch fixes all that ugliness that the native IE change event suffers from, and provides delegation support in-kind. Shockingly, IE actually sounds like it behaves closer to the W3 spec on this, but I'm glad all the other browser vendors called a bullshit and implemented the event in a sane manner.\n. @jdalton Sure, it will fire when the user clicks something else on the page, like a form submission button, but there are several other use-cases that need immediate feedback (think fancy form plugins, etc). Select elements do suffer from the same issues, but this patch covers them as well, see the condition fn of the Element.Events.change object ;) \n. Hmm, I wasn't aware of improper select element behavior in other browsers, do you know which ones or versions I can look at?\nThe event is not fired multiple times because for IE we are using a combination of two events (neither of which are actually change) that are never fired for the same action. The keychange handles key inputs and the mouseup handles mouse interaction - additionally, their respective conditions block any instances where duplication could occur.\n. I see, we may need to expose this to all browsers as a fix if that is the case. I'll test select in Fx out a bit today to make sure we have all our bases covered.\n. Well I figure if IE needs the fix on all the elements, and it solves valid use-cases, then it can't hurt. All we'd have to do after I sort out Fx selects to see what their impact is, would be to remove the check for event listener support. I will post back here today with findings.\n. @jdalton - I tested Fx and Chrome, my patch allows for change to be realized on the actual change of the select elements as well, versus the blur (which is OK sometimes, but much less helpful depending on what you want to do).\nI would like to have this fix apply to all browsers, I suggest we remove the event listener check.\n. I believe that this table should be public, but I have and still do question the necessity of it being in a separate dependency. There is no reason to hide a resource like this in a closure arbitrarily.\n. This needs to be in Browser.Styles, makes it easier for testing and is a valid resource that people may want to review and utilize in code. I removed the String.prefix method, it is now unneeded in the new slimmed down version of Browser.Styles.\n. I did do a spec commit, on the Specs repo...\n. No, I didn't have a chance to type in all those ninja commands, probably because I have no idea that I had to or what they even do ;)\n. Is there a way to incorporate any of these style fixes/optimizations into this code inline with some GUI?\n. It used to be 30 lines (nice try there) and in testing the old one had two issues:\n1) It was firing change before the browser recognized the change on the element, so if you tried this.checked in your function on a checkbox for instance, it would return the opposite value\n2) The old version did not support all the change-producing events for checkboxes, now it does.\nThis is not some weird mutator event we're talking about fixing here, this is change, it is basic, and it should not be borked for 50% of people viewing a MooTools-base site. If it helps you feel better, the jQuery code that does this in their library is over 2x the size and doesn't support select elements as noted in #2 above.\nAnd that's the Word.\n. No, this makes reasonable instances of changes to forms very difficult:\n- Wanna make a fancy form element script to make this pretty, well don't you'll be in pain.\n- Want delegation of change so you can handle it all on the form? Nope, maybe next time.\nThis is a pretty basic event and it should just work. To be honest, this change is less of an enhancement then mouseenter or leave, those custom events are actually introducing new events, this just makes a low-level DOM event not blow balls in IE.\n. F! I accidentally closed, reopened, sorry :)\n. This is the commit to pull in: 563435a7ff4e14f8c080\n. Closing this pull to open clean pull that includes all feedback, code in a separate Element.Event.Change file, and an MD file for documentation.\n. Borked\n. As we are unwilling to provide a consistent behavior across change-affected elements, we should forgo the addition of a 80% solution until such time that we agree on a consistent event behavior for all affected elements.\n. Closing to open clean pull\n. Are we good to go on this now?\n. Wow, I can't believe I didn't check to make sure the attribute that changed was \"checked\". Haven't tested the patch, but I will tomorrow. Thanks for catching this. \n. Being that I haven't tested this yet, I hate to ask the seemingly obvious question: Why can't you just add a condition that ensures the changed attributed is \"checked\" to the part of the existing conditions that affect only radios and checkboxes?\n. Did you run the tests in all the various browsers yet? Other than that, the logic seems to make sense.\n. This fix prevents change from firing when unchecking a checked checkbox in IE7 and IE8, probably 6 too, but I don't have access to it right now. I will revisit the issue this week.\nSource of error: http://fragged.org/dev/mootools-core/Specs/1.4client/Element/Element.Event.change.html\n. Someone pull this please\n. I'll have em done by this evening. You and your specs, total buzzkill!  ;)\nOn Jan 3, 2012 1:00 PM, \"Christoph Pojer\" \nreply@reply.github.com\nwrote:\n\nwheeere are the speeecs?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2191#issuecomment-3346038\n. And docs! Wow, you guys are really laying it on thick...fine fineeeee! :)\n. @kevinwestern - I changed it so that if a key/value being looked up via Object.get is undefined that it returns undefined, as it should. \n. @jiggliemon that would be expected behavior, you just set the value of name to a string, which blows away the previous value, thus trying to retrieve the 'last' node from a string of 'Whoops!' would be undefined...get me?\n. @jiggliemon this is basically what you did:\n\nvar foo = { name: 'Chase' };\nfoo.name = { last: 'Wilson' };\nfoo.name = 'Whoops!';\nconsole.log(foo.name.last);\nYou just overwrote the object containing 'last' with the string of 'Whoops!' before doing the get call, thus the return of 'Whoops!'.last is undefined.\n. @fakedarren if you reopen this I will redo the commits so they come from my user name.\n. @fakedarren don't be a darren-hole, lol :)\n. @jiggliemon actually your first example would not error any earlier: if foo.bar = 'Whoops!', then \"Whoops!\".last would be undefined and would not throw an error or have any different effect, they are 1 to 1 --> http://jsfiddle.net/JEsJW/1/ (this uses your exact example)\n. @jiggliemon the method works as it should on objects as it does if you set them long hand with variables - I'm not sure what you're going after here buddy :/\n. Folks, this is not complicated, and the current implementation mirrors reality; namely, if you set something, it gets set, if you don't, it doesn't. Period. When's the last time you blamed JavaScript for this:\nvar foo = { a: { b: 'bar' } };\nfoo.a = \"I'm a goldfish\";\nconsole.log(foo.a.b); // Wait! undefined! Wut? How can this be? Curse you JavaScript, you did exactly what you were told!\n. We agreed long ago this was going in Core. Let me take a moment to express my frustration with people bringing up asinine API complaints that a method does exactly what you tell it to do and another member questioning the very repo we all agreed it was to be committed to a full 8 months after this was solid and landed here. Stop the bitching and moaning, stop the pedantic bullshit, and quit preventing people from advancing the code base. \nTo work on something and have it reduced to this ridiculous, after-the-fact, 11th hour banter is frustrating to say the least. \n. Thank you Adrian, that about sums it up. Question: are people also mad when they remove an array member and the length changes to match? \"Damn you JavaScript, sure my code is in the wrong order and you're just parsing what you're given, but can't you just know I don't really want you to do what I've just explicitly told you to do.\"\n. I'm going to update the patch to include a Windows UAC prompt that asks \"Are you sure you want to set the property you've just asked to?\" Solved. \n. @GCheung55 This is a native method that acts on an object provided, not a data storage system; as you briefly noted, adding a \"locking\" mechanism here would run completely contrary to the established behavior of native methods.\n. @fakedarren open the pull dude, I'll recommit with my username and we'll be done with it. This was approved for landing many months ago and I've added shit tons of stuff to the commit to get it ready. Not pulling this in is exactly the sort of thing that we do to kill off contribution, and I for one will be less inclined to spend my time if this is the way things go down.\n. @cpojer we talked about this at least twice on IRC, and one of the main use-cases for the framework is making String.substitute capable of deep setting replacements. String.substitute is in Core...I'm not sure how exactly you expect substitute to rely upon something that isn't present in Core...maybe you have some magical dependency fairy you've been keeping all to yourself?\nPS - I should note, one of the commits included in this pull adds the deep set ability to String.substitute, this has been in plain sight for months folks --> https://github.com/csuwldcat/mootools-core/commit/2bdbd434e272def2085df7988958e315d329cb02\n. @cpojer ROFLcopter, are you mental? Look at the dependency chain Christoph! Are we speaking Klingon here? Am I on crazy pills?\n*** csuwldcat screams into pillow\n. @cpojer can you please explain to the valued community members that have been waiting for Object.get/set and the augmentation of String.substitute, just how we plan on providing the deep set version of substitute if this is moved to More?\n\n. @cpojer that was not the consensus. @fakedarren had agreed to pull it into Core if I just fixed the unknown commits, it is the last comment he closed this with above, and I quote:\n\"@csuwldcat - as said before, I like this, but we can't pull this with 'unknown' in the commit history. I'm closing this pull request, but if you resubmit it with named commits then it will definitely be pulled.\"\n. @cpojer that is not accurate, you simply said \"I won't pull it, you'll have to get someone else\", to which I did, and talked to Darren, he agreed. Nice try bro, swing and a miss.\n. A final recap of what has transpired here for the benefit of all the community members on this thread who will not see the additions they wanted and contributed feedback on:\n- went on IRC to socialize the code idea I derived from observed community feedback\n- got development approval from a Core repo manager\n- developed and enhanced the code, which included integrating the feedback of many other community members\n- fulfilled every requests Core members made for docs, tests, and More updates\n- After 7 months of working with various Core members to craft the perfect commit (and in the process attracting positive feedback from many community members) one guy steps in to torpedo the entire 7 month, approved effort, offering lack-luster excuses for every cogent and relevant question that has been presented.\nOh boy! I sure feel like a valued contributor, thanks for the experience!\n. @cpojer no, that is exactly what happened, here's how it went down:\n- had a Twitter discussion with a few MooTools devs trying to do deep sets with subsitute\n- developed Object.get/set and substitute augmentations for personal uses\n- after using these enhancements personally, and finding them applicable to most of my apps, I went to IRC to see about adding them to Core\n- you, @cpojer, said on Core, and I quote: \"I wouldn't pull that into Core, you'll have to find someone else\"\n- found another Core dev, Darren, who agreed to pull it\n- went through an arduous process of back and forth honing of the commit\n- you step in at the 11th hour, overrule Darren, and take a bazooka to the whole 7 month process and intent\nWhere exactly is the reality distortion you mentioned? Are you calling me a liar in a passive-aggressive, emo way? If so, just go right ahead and put it in print.\n. @motiontoday @cpojer I'd appreciate you not hijacking my code and committing it in some end-around maneuver, I find it offensive.\n. @motiontoday @cpojer so you are going to take my code, disrespect my contribution after 7 months of back and forth, then have some one else commit it? Is that what I'm hearing? You stay classy San Diego.\n. @motiontoday after discussion with @cpojer offline, I will direct this toward More and the pull will be accepted there. The hope I still have is for Core inclusion at some future point, but that is doubtful at this time.\n. Good point, just ice it until I can write some tomorrow :)\n. Test page: http://people.mozilla.com/~dbuchner/demos/web/Event.Delegation/\n. Commented version of the source: http://paste.mootools.net/f7e6e9201\nIf for any reason you see a line that doesn't seem to matter, please let me know and I will explain it as soon as I can.\n. I have read the spec, and I must admit, it seems to indicate that IE is doing this correctly. This flow works for textareas and text inputs because you don't want change to fire on every keypress. However, on all other browsers since I can remember, the sane implementation for inputs such as radios and checkboxes is to have the change event fire when the change occurs. The current IE behavior is not inline with other browsers and is basically useless for these inputs. If I'm the developer and I user clicks a checkbox 5000 to change it from checked to unchecked, I want to know when that change occurs, not on the 5001st click 20 minutes later when it is irrelevant.\n. Well it is the standard in ALL browsers other than IE, and I have it on good authority that no one is going to deviate from it. In fact, IE will be changing to follow. The take-away: We need to fix this shit ASAP.\n. Sorry for the other changes in there, just grab the last one.\n. I am, indeed, a perennial git n00b, but I write code just fine, so now what? Still WINNING!\n. opening fresh pull with w00fz changes and none of the unrelated commits from my repo.\n. Closing this out while I ponder a more compatible solution...\n. shit, ignore that commit regarding the inject stuff (hash: 2fdefb1) it is unrelated, fucking git.\n. I am pulling this request, even after reworking it to be more performant, it was still 10x slower than the original that doesn't allow the passing of subsequent variables.\n. A) You can tweak it however you like, it's still is doing the same job. I would say that snapping the base function out to a separate var is a bit unnecessary and pedantic. Also, in the keychange custom event, the condition's inline instantiation of an array and the subsequent indexOf look-up are MUCH slower than a case statement (jsperf if if you are interested).\nB) I am stunned that you think this should be a plugin or in More. The idea that we should leave a pretty common native event broken in our library is ridiculous and arbitrary. Why not randomly throw out other basic cross browser stuff? How about we toss addEvent and make people do both for attaching events, asinine, obviously.\nCheck, mate.\n. Oh and here is the test: add a regular change event in IE to a checkbox and set of radios, then click one, proceed to watch it actually fire instead of waiting until the users randomly does something else and blurs it. The way IE does it now is totally pointless; shit, it could basically never fire even if a change has occurred, terrible, terrible, terrible.\n. Soooo, I tested that test page you sent and it already shows the IE fix in action and working. I added this to test the \"native\" change event side of it:\njavascript\n$$('input.someClass,select,input[type=\"checkbox\"],input[type=\"radio\"]').addEvent('change', function(){\n    log('native change', true);\n});\nI couldn't add that to the 1.4 specs, I can't seem to find that branch in anything by the Github GUI and it won't let me touch it...can you just put that little code snipped in for me?\n. In IE (LTE 8), native change does not fire until after the input control is blurred. This is counter to the behavior of every other browser, which all fire at the time the change occurs. For example, in IE if you click a checkbox, even though it changes state right before your eyes, you could sit there for hours, strike that, until the Mayans come back with aliens in 2012, and that shit won't fire.\nThis patch fixes all that ugliness that the native IE change event suffers from, and provides delegation support in-kind. Shockingly, IE actually sounds like it behaves closer to the W3 spec on this, but I'm glad all the other browser vendors called a bullshit and implemented the event in a sane manner.\n. @jdalton Sure, it will fire when the user clicks something else on the page, like a form submission button, but there are several other use-cases that need immediate feedback (think fancy form plugins, etc). Select elements do suffer from the same issues, but this patch covers them as well, see the condition fn of the Element.Events.change object ;) \n. Hmm, I wasn't aware of improper select element behavior in other browsers, do you know which ones or versions I can look at?\nThe event is not fired multiple times because for IE we are using a combination of two events (neither of which are actually change) that are never fired for the same action. The keychange handles key inputs and the mouseup handles mouse interaction - additionally, their respective conditions block any instances where duplication could occur.\n. I see, we may need to expose this to all browsers as a fix if that is the case. I'll test select in Fx out a bit today to make sure we have all our bases covered.\n. Well I figure if IE needs the fix on all the elements, and it solves valid use-cases, then it can't hurt. All we'd have to do after I sort out Fx selects to see what their impact is, would be to remove the check for event listener support. I will post back here today with findings.\n. @jdalton - I tested Fx and Chrome, my patch allows for change to be realized on the actual change of the select elements as well, versus the blur (which is OK sometimes, but much less helpful depending on what you want to do).\nI would like to have this fix apply to all browsers, I suggest we remove the event listener check.\n. I believe that this table should be public, but I have and still do question the necessity of it being in a separate dependency. There is no reason to hide a resource like this in a closure arbitrarily.\n. This needs to be in Browser.Styles, makes it easier for testing and is a valid resource that people may want to review and utilize in code. I removed the String.prefix method, it is now unneeded in the new slimmed down version of Browser.Styles.\n. I did do a spec commit, on the Specs repo...\n. No, I didn't have a chance to type in all those ninja commands, probably because I have no idea that I had to or what they even do ;)\n. Is there a way to incorporate any of these style fixes/optimizations into this code inline with some GUI?\n. It used to be 30 lines (nice try there) and in testing the old one had two issues:\n1) It was firing change before the browser recognized the change on the element, so if you tried this.checked in your function on a checkbox for instance, it would return the opposite value\n2) The old version did not support all the change-producing events for checkboxes, now it does.\nThis is not some weird mutator event we're talking about fixing here, this is change, it is basic, and it should not be borked for 50% of people viewing a MooTools-base site. If it helps you feel better, the jQuery code that does this in their library is over 2x the size and doesn't support select elements as noted in #2 above.\nAnd that's the Word.\n. No, this makes reasonable instances of changes to forms very difficult:\n- Wanna make a fancy form element script to make this pretty, well don't you'll be in pain.\n- Want delegation of change so you can handle it all on the form? Nope, maybe next time.\nThis is a pretty basic event and it should just work. To be honest, this change is less of an enhancement then mouseenter or leave, those custom events are actually introducing new events, this just makes a low-level DOM event not blow balls in IE.\n. F! I accidentally closed, reopened, sorry :)\n. This is the commit to pull in: 563435a7ff4e14f8c080\n. Closing this pull to open clean pull that includes all feedback, code in a separate Element.Event.Change file, and an MD file for documentation.\n. Borked\n. As we are unwilling to provide a consistent behavior across change-affected elements, we should forgo the addition of a 80% solution until such time that we agree on a consistent event behavior for all affected elements.\n. Closing to open clean pull\n. Are we good to go on this now?\n. Wow, I can't believe I didn't check to make sure the attribute that changed was \"checked\". Haven't tested the patch, but I will tomorrow. Thanks for catching this. \n. Being that I haven't tested this yet, I hate to ask the seemingly obvious question: Why can't you just add a condition that ensures the changed attributed is \"checked\" to the part of the existing conditions that affect only radios and checkboxes?\n. Did you run the tests in all the various browsers yet? Other than that, the logic seems to make sense.\n. This fix prevents change from firing when unchecking a checked checkbox in IE7 and IE8, probably 6 too, but I don't have access to it right now. I will revisit the issue this week.\nSource of error: http://fragged.org/dev/mootools-core/Specs/1.4client/Element/Element.Event.change.html\n. Someone pull this please\n. I'll have em done by this evening. You and your specs, total buzzkill!  ;)\nOn Jan 3, 2012 1:00 PM, \"Christoph Pojer\" \nreply@reply.github.com\nwrote:\n\nwheeere are the speeecs?\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2191#issuecomment-3346038\n. And docs! Wow, you guys are really laying it on thick...fine fineeeee! :)\n. @kevinwestern - I changed it so that if a key/value being looked up via Object.get is undefined that it returns undefined, as it should. \n. @jiggliemon that would be expected behavior, you just set the value of name to a string, which blows away the previous value, thus trying to retrieve the 'last' node from a string of 'Whoops!' would be undefined...get me?\n. @jiggliemon this is basically what you did:\n\nvar foo = { name: 'Chase' };\nfoo.name = { last: 'Wilson' };\nfoo.name = 'Whoops!';\nconsole.log(foo.name.last);\nYou just overwrote the object containing 'last' with the string of 'Whoops!' before doing the get call, thus the return of 'Whoops!'.last is undefined.\n. @fakedarren if you reopen this I will redo the commits so they come from my user name.\n. @fakedarren don't be a darren-hole, lol :)\n. @jiggliemon actually your first example would not error any earlier: if foo.bar = 'Whoops!', then \"Whoops!\".last would be undefined and would not throw an error or have any different effect, they are 1 to 1 --> http://jsfiddle.net/JEsJW/1/ (this uses your exact example)\n. @jiggliemon the method works as it should on objects as it does if you set them long hand with variables - I'm not sure what you're going after here buddy :/\n. Folks, this is not complicated, and the current implementation mirrors reality; namely, if you set something, it gets set, if you don't, it doesn't. Period. When's the last time you blamed JavaScript for this:\nvar foo = { a: { b: 'bar' } };\nfoo.a = \"I'm a goldfish\";\nconsole.log(foo.a.b); // Wait! undefined! Wut? How can this be? Curse you JavaScript, you did exactly what you were told!\n. We agreed long ago this was going in Core. Let me take a moment to express my frustration with people bringing up asinine API complaints that a method does exactly what you tell it to do and another member questioning the very repo we all agreed it was to be committed to a full 8 months after this was solid and landed here. Stop the bitching and moaning, stop the pedantic bullshit, and quit preventing people from advancing the code base. \nTo work on something and have it reduced to this ridiculous, after-the-fact, 11th hour banter is frustrating to say the least. \n. Thank you Adrian, that about sums it up. Question: are people also mad when they remove an array member and the length changes to match? \"Damn you JavaScript, sure my code is in the wrong order and you're just parsing what you're given, but can't you just know I don't really want you to do what I've just explicitly told you to do.\"\n. I'm going to update the patch to include a Windows UAC prompt that asks \"Are you sure you want to set the property you've just asked to?\" Solved. \n. @GCheung55 This is a native method that acts on an object provided, not a data storage system; as you briefly noted, adding a \"locking\" mechanism here would run completely contrary to the established behavior of native methods.\n. @fakedarren open the pull dude, I'll recommit with my username and we'll be done with it. This was approved for landing many months ago and I've added shit tons of stuff to the commit to get it ready. Not pulling this in is exactly the sort of thing that we do to kill off contribution, and I for one will be less inclined to spend my time if this is the way things go down.\n. @cpojer we talked about this at least twice on IRC, and one of the main use-cases for the framework is making String.substitute capable of deep setting replacements. String.substitute is in Core...I'm not sure how exactly you expect substitute to rely upon something that isn't present in Core...maybe you have some magical dependency fairy you've been keeping all to yourself?\nPS - I should note, one of the commits included in this pull adds the deep set ability to String.substitute, this has been in plain sight for months folks --> https://github.com/csuwldcat/mootools-core/commit/2bdbd434e272def2085df7988958e315d329cb02\n. @cpojer ROFLcopter, are you mental? Look at the dependency chain Christoph! Are we speaking Klingon here? Am I on crazy pills?\n*** csuwldcat screams into pillow\n. @cpojer can you please explain to the valued community members that have been waiting for Object.get/set and the augmentation of String.substitute, just how we plan on providing the deep set version of substitute if this is moved to More?\n\n. @cpojer that was not the consensus. @fakedarren had agreed to pull it into Core if I just fixed the unknown commits, it is the last comment he closed this with above, and I quote:\n\"@csuwldcat - as said before, I like this, but we can't pull this with 'unknown' in the commit history. I'm closing this pull request, but if you resubmit it with named commits then it will definitely be pulled.\"\n. @cpojer that is not accurate, you simply said \"I won't pull it, you'll have to get someone else\", to which I did, and talked to Darren, he agreed. Nice try bro, swing and a miss.\n. A final recap of what has transpired here for the benefit of all the community members on this thread who will not see the additions they wanted and contributed feedback on:\n- went on IRC to socialize the code idea I derived from observed community feedback\n- got development approval from a Core repo manager\n- developed and enhanced the code, which included integrating the feedback of many other community members\n- fulfilled every requests Core members made for docs, tests, and More updates\n- After 7 months of working with various Core members to craft the perfect commit (and in the process attracting positive feedback from many community members) one guy steps in to torpedo the entire 7 month, approved effort, offering lack-luster excuses for every cogent and relevant question that has been presented.\nOh boy! I sure feel like a valued contributor, thanks for the experience!\n. @cpojer no, that is exactly what happened, here's how it went down:\n- had a Twitter discussion with a few MooTools devs trying to do deep sets with subsitute\n- developed Object.get/set and substitute augmentations for personal uses\n- after using these enhancements personally, and finding them applicable to most of my apps, I went to IRC to see about adding them to Core\n- you, @cpojer, said on Core, and I quote: \"I wouldn't pull that into Core, you'll have to find someone else\"\n- found another Core dev, Darren, who agreed to pull it\n- went through an arduous process of back and forth honing of the commit\n- you step in at the 11th hour, overrule Darren, and take a bazooka to the whole 7 month process and intent\nWhere exactly is the reality distortion you mentioned? Are you calling me a liar in a passive-aggressive, emo way? If so, just go right ahead and put it in print.\n. @motiontoday @cpojer I'd appreciate you not hijacking my code and committing it in some end-around maneuver, I find it offensive.\n. @motiontoday @cpojer so you are going to take my code, disrespect my contribution after 7 months of back and forth, then have some one else commit it? Is that what I'm hearing? You stay classy San Diego.\n. @motiontoday after discussion with @cpojer offline, I will direct this toward More and the pull will be accepted there. The hope I still have is for Core inclusion at some future point, but that is doubtful at this time.\n. ",
    "seanmonstar": "oh balls.\n. i didnt see one even testing \"checked\", so i didnt bother. i can write one up real quick tho\n. so performance is better than it working correctly? (never.)\nplus, this check is done in a self-executing function. is it monumentally slow to check a non-existent property in IE once?\n. If the goal was to stick to the spec, then I would think we should supress the change events in all browsers doing it wrong and make them all behave like IE.\nSince that's a terrible idea, then the next best thing is to normalize the behavior across browsers.\n. @cpojer Thats a separate topic. when a couple of us met for dinner, we were saying how it would be great if we could have one build for standard compliant browsers, and another for support IE. The main one could still include IE, but at least there would be a simple way of grabbing just the MooTools you need to target webkit/gecko.\n. a check for this != window means it breaks in a headless environment.\n. @arian: too many steps. simply navigate to the file on the mootools repo, click the button \"Fork and edit this file.\"\n. Though, the delegated target is passed as an argument. Does it need to be an argument, and this?\n. preventDefault is descriptive. prevent is ambiguous.\n. It is not fine.\n. Well, $$ always returns an array-like object of Elements. If you're sure there is only one with that classname, you could do one of these as well:\njs\n$$('.myel')[0].clone().inject()\n//or\ndocument..body.getElement('.myel').clone().inect()\n. I'd rather if it didn't come bundled with RequireJS or curl.js, or at least give an option to leave it out. I would only ever want a simple mini require/define which basically just inserts and retrieves from a modules object.\n. Only slightly. Ideally all requires should be at the head of the file, just\nlike you should do in every other language.\n. Yea, don't have 2 different compressed versions. Just have the best (which in my experience is uglify).\n. That's the reason I've gone with uglifyjs: since I minify with every\ncommit, I want it to be fast as well.\n. I don't commit compiled js. Each commit triggers an automatic deploy. :-)\n. Indeed, just as Request.HTML is when you want to retrieve HTML, not when you plan to send it.\n. I agree. They're just attributes. .get and .set work great!\n. True, in his example, it would throw a reference error, but here's an example that wouldn't:\n``` js\nNamespace.B = new Class({\nExtends: Namespace.A\n\n});\n```\nAnd MooTools does this a lot (Fx, Drag, Request, etc).\n. Forget has. Why should it only throw a decent error in development, and\nthrow an obscure error in production?\n. I'm just saying that it would throw an Error either way. So it can either\nsay \"Extends only works with a Class\", or it can say \"TypeError, c is\nundefined\" (since it will be minified).\n. Good call. Obscurity ftw.\n. No.\n. Why is it dependent on has.js? This doesn't use has.\n. I get that, but introducing this doesn't throw any more errors than it used to. The only difference is whether the error is understandable.\n. oh balls.\n. i didnt see one even testing \"checked\", so i didnt bother. i can write one up real quick tho\n. so performance is better than it working correctly? (never.)\nplus, this check is done in a self-executing function. is it monumentally slow to check a non-existent property in IE once?\n. If the goal was to stick to the spec, then I would think we should supress the change events in all browsers doing it wrong and make them all behave like IE.\nSince that's a terrible idea, then the next best thing is to normalize the behavior across browsers.\n. @cpojer Thats a separate topic. when a couple of us met for dinner, we were saying how it would be great if we could have one build for standard compliant browsers, and another for support IE. The main one could still include IE, but at least there would be a simple way of grabbing just the MooTools you need to target webkit/gecko.\n. a check for this != window means it breaks in a headless environment.\n. @arian: too many steps. simply navigate to the file on the mootools repo, click the button \"Fork and edit this file.\"\n. Though, the delegated target is passed as an argument. Does it need to be an argument, and this?\n. preventDefault is descriptive. prevent is ambiguous.\n. It is not fine.\n. Well, $$ always returns an array-like object of Elements. If you're sure there is only one with that classname, you could do one of these as well:\njs\n$$('.myel')[0].clone().inject()\n//or\ndocument..body.getElement('.myel').clone().inect()\n. I'd rather if it didn't come bundled with RequireJS or curl.js, or at least give an option to leave it out. I would only ever want a simple mini require/define which basically just inserts and retrieves from a modules object.\n. Only slightly. Ideally all requires should be at the head of the file, just\nlike you should do in every other language.\n. Yea, don't have 2 different compressed versions. Just have the best (which in my experience is uglify).\n. That's the reason I've gone with uglifyjs: since I minify with every\ncommit, I want it to be fast as well.\n. I don't commit compiled js. Each commit triggers an automatic deploy. :-)\n. Indeed, just as Request.HTML is when you want to retrieve HTML, not when you plan to send it.\n. I agree. They're just attributes. .get and .set work great!\n. True, in his example, it would throw a reference error, but here's an example that wouldn't:\n``` js\nNamespace.B = new Class({\nExtends: Namespace.A\n\n});\n```\nAnd MooTools does this a lot (Fx, Drag, Request, etc).\n. Forget has. Why should it only throw a decent error in development, and\nthrow an obscure error in production?\n. I'm just saying that it would throw an Error either way. So it can either\nsay \"Extends only works with a Class\", or it can say \"TypeError, c is\nundefined\" (since it will be minified).\n. Good call. Obscurity ftw.\n. No.\n. Why is it dependent on has.js? This doesn't use has.\n. I get that, but introducing this doesn't throw any more errors than it used to. The only difference is whether the error is understandable.\n. ",
    "arieh": "obviously a typo (skipped f11) \ndidn't even know f13 existed\n. I might be missing something about how I'm supposed to do pull request. There seem to be 3 open ones instead of one updated. which should I close - the first 2 or the last 2?\n. I've just checked - yes, it does (checked on hebrew keyboard, but since event.key is never changed this will be consistent). \nI've also noticed that for letters, the fromCharCode algorithm will always generate English characters. But I'm not sure this is fixable. Maybe this should be documented\n. Well, I don't know what you mean by non-normative keyboards. But I only added very generic punctuation keys - such as /.,[]-=, which are very common and very standard. I've tested this on a few keyboards, all gave me the same codes.\nThese also are not affected at all by locale (I've tried on hebrew arabic and english).\nAs for keydown/press - I'll check to see if I can find differences (I didn't know I should).\nI'll update when I'm done\n. I've checked on this demo page:\nhttp://jsfiddle.net/9TZUF/\nthe only problematic key (changes betweeen keydown/press) is ' (single quote). All the rest (including f1-12) worked perfectly for both, on all 3 locales \n. http://groups.google.com/group/mootools-users/msg/fb4aa9ac7209f918\nWhat I noticed was that most of the problems occurred when people shift+keyed something. The only real problem risen when someone used the keypad. IMO, at the very least the docs are unclear (currently they will only return english a-z, not matter what locale). But I believe the non-num-pad punctuation keys are safe (if I read the responses alright). \n. obviously a typo (skipped f11) \ndidn't even know f13 existed\n. I might be missing something about how I'm supposed to do pull request. There seem to be 3 open ones instead of one updated. which should I close - the first 2 or the last 2?\n. I've just checked - yes, it does (checked on hebrew keyboard, but since event.key is never changed this will be consistent). \nI've also noticed that for letters, the fromCharCode algorithm will always generate English characters. But I'm not sure this is fixable. Maybe this should be documented\n. Well, I don't know what you mean by non-normative keyboards. But I only added very generic punctuation keys - such as /.,[]-=, which are very common and very standard. I've tested this on a few keyboards, all gave me the same codes.\nThese also are not affected at all by locale (I've tried on hebrew arabic and english).\nAs for keydown/press - I'll check to see if I can find differences (I didn't know I should).\nI'll update when I'm done\n. I've checked on this demo page:\nhttp://jsfiddle.net/9TZUF/\nthe only problematic key (changes betweeen keydown/press) is ' (single quote). All the rest (including f1-12) worked perfectly for both, on all 3 locales \n. http://groups.google.com/group/mootools-users/msg/fb4aa9ac7209f918\nWhat I noticed was that most of the problems occurred when people shift+keyed something. The only real problem risen when someone used the keypad. IMO, at the very least the docs are unclear (currently they will only return english a-z, not matter what locale). But I believe the non-num-pad punctuation keys are safe (if I read the responses alright). \n. ",
    "milesj": "Does this support multiple locales? I have a mapping for the US keyboard as well as DE, FR, KR.\n. Have to agree, what an awesome bug report.\nI also lost it at \"unmolested\", kudos, haha.\n. Good to hear. I'll start dedicating some of my time and try and verify some of these issues/requests.\n. Your code doesn't really make sense. How is the bFunction going to be called if the instance isn't passed?\nvar c = new AClass($('aLink'));\n$('bLink').addEvent('click', c.bFunction);\n. Does this support multiple locales? I have a mapping for the US keyboard as well as DE, FR, KR.\n. Have to agree, what an awesome bug report.\nI also lost it at \"unmolested\", kudos, haha.\n. Good to hear. I'll start dedicating some of my time and try and verify some of these issues/requests.\n. Your code doesn't really make sense. How is the bFunction going to be called if the instance isn't passed?\nvar c = new AClass($('aLink'));\n$('bLink').addEvent('click', c.bFunction);\n. ",
    "ryanflorence": "While I generally prefer this altered behavior, IE follows the DOM spec \"The change event occurs when a control loses the input focus and its value has been modified since gaining focus.\"  So do you follow the spec or break it?\n. Specs pull request: https://github.com/mootools/mootools-core-specs/pull/5\n. 1. Everybody who uses Object.create has a shim nearly identical to this.\n2. Nobody really uses the second argument ...\n3. ... unless they are in an environment which supports it, and they still can since Object.extend prevents overwriting\n4. The documentation notes this fact\n. What if:\n- It throws an error if two arguments are provided\n- Or we named it something else\n?\n. > So, why didn't mootools solve this as the jQuery way\nMooTools 2.0 will be wrapping elements rather than 1) augmenting Element.prototype or 2) falling back direct property injection for IE6-7.  Everybody has learned their lessons regarding augmenting host objects.\nUnfortunately, that doesn't help you right now :(\nA workaround would be to Object.append(el, Element.prototype) to any elements you need after you implement new element methods.\n. Nope:\n``` javascript\nit('should make new prototype methods available to previously selected elements', function (){\n    var element = new Element('div#foo').inject(document.body);\n    var found = document.id('foo');\n// extend Element after element has been selected once\nElement.implement('methodFoo', function (){});\n// send along nocache param\nvar recache = document.id('foo', true);\nexpect(typeof found.methodFoo).toBe('function');\n\n});\n```\nFails in IE6-7\n. While I generally prefer this altered behavior, IE follows the DOM spec \"The change event occurs when a control loses the input focus and its value has been modified since gaining focus.\"  So do you follow the spec or break it?\n. Specs pull request: https://github.com/mootools/mootools-core-specs/pull/5\n. 1. Everybody who uses Object.create has a shim nearly identical to this.\n2. Nobody really uses the second argument ...\n3. ... unless they are in an environment which supports it, and they still can since Object.extend prevents overwriting\n4. The documentation notes this fact\n. What if:\n- It throws an error if two arguments are provided\n- Or we named it something else\n?\n. > So, why didn't mootools solve this as the jQuery way\nMooTools 2.0 will be wrapping elements rather than 1) augmenting Element.prototype or 2) falling back direct property injection for IE6-7.  Everybody has learned their lessons regarding augmenting host objects.\nUnfortunately, that doesn't help you right now :(\nA workaround would be to Object.append(el, Element.prototype) to any elements you need after you implement new element methods.\n. Nope:\n``` javascript\nit('should make new prototype methods available to previously selected elements', function (){\n    var element = new Element('div#foo').inject(document.body);\n    var found = document.id('foo');\n// extend Element after element has been selected once\nElement.implement('methodFoo', function (){});\n// send along nocache param\nvar recache = document.id('foo', true);\nexpect(typeof found.methodFoo).toBe('function');\n\n});\n```\nFails in IE6-7\n. ",
    "trentrichardson": "Thanks for the response.  I was previously unaware of this.  It seems most browsers respect this, but indeed it is not standard, and it is clear the issue with Chrome according to the response in this post:\nhttp://stackoverflow.com/questions/280713/elements-order-for-in-loop-in-javascript\nI believe I personally will continue using it as the gray area does not effect my scenario, but I you are right and so it may not belong in core.\n. Thanks for the response.  I was previously unaware of this.  It seems most browsers respect this, but indeed it is not standard, and it is clear the issue with Chrome according to the response in this post:\nhttp://stackoverflow.com/questions/280713/elements-order-for-in-loop-in-javascript\nI believe I personally will continue using it as the gray area does not effect my scenario, but I you are right and so it may not belong in core.\n. ",
    "mattsacks": "pinging this, would very much like to have requestAnimationFrame supported in the Fx package\n. pinging this, would very much like to have requestAnimationFrame supported in the Fx package\n. ",
    "timwienk": "LGTM.\njavascript\nnew Element('input[type=checkbox][checked]');\nworks with this as well, tested by @arian.\n. Like cpojer said, thanks for the great report. Very detailed, very nice. We didn't even have to debug to fix it. ++\nAnyway, the first problem you described is an encoding problem. In some weird way, a 0xC2A0 (no-break space in UTF-8) made its way into the code, rather than a 0x20 (a normal space). When serving the file UTF-8 encoded, there is no problem, a no-break space is treated as just a whitespace character. When serving the file as ISO-8859, 0xC2 is an \u00c2, while 0xA0 is a no-break space.\nThis explains why the error wasn't caught (it's no excuse though), as we probably(/apparently) all work and test in UTF-8 environments. (MooTools-More's Locale files, for example, are UTF-8 by design, but obviously for just Core it shouldn't matter.) Like cpojer said, 1.4.1 will be out the door soon enough, fixing this nasty issue!\nThe second issue you raised is because $family changed from an object to a function in 1.3. It's only used by $type/typeOf. The fact that it throws an error about an object with $family.name == 'array' is rather awkward, should be something in the APE test itself (I hope)? In any case, technically $family is private (which is why there currently is no compatibility), but the issue will be discussed, and decided whether there should be compatibility in the $type function for it.\nThanks again!\n. I just realized you said it does work with 1.3+1.2compat, there was no compatibility for this either in 1.3. So that issue will need some more investigation.\n. :+1:\n. Indeed. The docs should mention the conditions for failure are different for Request.JSON.\n. It's the standard behaviour. You can take a look at the MDN reference for more information.\nThe idea is that fn.bind() returns a new function, doing the same as the original one, but with a different value for this. So every time you call bind you get another new function. Saving a reference to remove the function is not a \"workaround\", it's the actual right way of going about things.\nThe Class arian linked does it the saving of references for you. The first time you call this.bound('functionName') you get a new reference to a bound version of that function. Any time after the first, when you call this.bound('functionName') the same reference is returned, rather than creating another new one.\n. I agree about its perceived necessity, however: untrusted user code should be executed with a clean stack to avoid these kinds of problems, plus the fact that acting upon events is quite obviously an asynchronous process. This is a design oversight on our part that's been there for a long time. I'm unsure what the best course of action is, since @kentaromiura's comment regarding breakage is probably true as well. I see the following options:\n- A try-catch around every execution to keep things synchronous. (Maybe manually re-throw the caught errors after all events were executed? (with a clean stack?)) (1.6?),\n- Asynchronous execution of each handler (only way to execute with a clean stack, as far as I know) (1.6?),\n- Keep current behaviour (and optionally add the new method @kentaromiura suggested, though I feel that's quite weird, since Class X would basically have to be aware of which way Class Y uses to fire its events) (could optionally be 1.5.x).\n. Regarding your comment on the first point: this is about theEventsClass mixin, notElement.Events. A possible performance issue regarding mousemove doesn't affect theEventsclass mixin as far as I'm aware. (Also,Element.Events` uses native events, it should already be asynchronous.)\nExample regarding wrapping in a try-catch:\nhttp://jsfiddle.net/358jjnsf/\njavascript\nfireEvent: function(type, args, delay){\n    type = removeOn(type);\n    var events = this.$events[type];\n    if (!events) return this;\n    args = Array.from(args);\n    events.each(function(fn){\n        if (delay){\n            fn.delay(delay, this, args);\n        } else {\n            try {\n                fn.apply(this, args);\n            } catch (error){\n                (function(){ throw error; }).delay(0);\n            }\n        }\n    }, this);\n    return this;\n});\nObvious problem with the above is, if people actually depend on fireEvent throwing an exception if a handler messes up, it won't anymore. The Error object should still have the original call stack stored, but it would be thrown asynchronously (to not disrupt normal event handling).\n. CustomEvent relies on a DOM implementation, doesn't it? And thus makes the Events Class mixin depend on a browser or a non-native DOM implementation.\n. What the pojer said: http://jsfiddle.net/M6efP/1/\n. A p-element cannot contain block-level elements (including another p). Therefore <p><p> will be interpreted as <p></p><p></p> and <p><div> as <p></p><div></div>.\nExample:\n- http://jsfiddle.net/vBDKa/\nReference:\n- http://www.w3.org/TR/html4/struct/text#h-9.3.1\n. The second argument to toggleClass is a boolean. If you pass it an undefined value, it's not going to assume you meant false, as you passed it something undefined, so it'll still use the default behaviour (that is: removing the class if it's present, adding the class if it's not present).\n. No problem. Note there are also addClass and removeClass methods on Element.\n. Object.forEach and Object.each only iterate own properties (see: hasOwnProperty). By creating the logic object in the Class definition, upon instantiation you get an instance of a new object using your logic object as prototype, rather than the logic object itself. The reason for this is inheritance: 1. Changing the object's properties in an instance won't have effect on the actual class definition (it would if the object itself was used in the instance (either assigned or through the Class' prototype)). 2. Changing the object in the class definition will properly reflect in instances of that class (it wouldn't if the object was cloned in the instance).\nIf you want an object with its own properties, and therefore be able to use Object.each to iterate its values, you'd have to create it in the instance itself (like in the initialize method). Another option is to use a way of looping that does not care about own properties (for...in?). In general the first option would be appropriate.\n. Request.JSON is meant to return JSON (you are Requesting JSON...), when it fails to do so it will fire fire the 'failure' event. When you don't expect JSON to be returned, you should use Request instead (you can always do JSON parsing in the success event handler, if JSON has to be decoded occasionally).\nAlso, things work a bit different than you're trying to explain: isSuccess is used. isSuccess is the first function executed after the XHR's readyState changes to DONE (or 4), on returning false the failure event is fired right away, on returning true the success function is executed, trying to parse the JSON and firing the success or failure depending on the parsing result.\nI understand this may seem a bit illogical, due to the function's name, but that's mostly because Request.JSON extends Request, and therefore inherited its naming. Bottom line is though, Requesting JSON and not getting JSON back means Request.JSON failed to do what it is meant to do, which means failure. For your case Request should be the way to go.\n. It's a backward incompatible shift of logic, and it's a backward incompatible shift of logic I don't agree with. Request.JSON is there to return JSON, when it fails to do so, it fires failure. Using the right tool(/class) for the job can't really be considered a \"work around\". I have never run into any kind of \"scaling issues\", \"rogue requests\" or \"race conditions\" you're describing, you should be fine just using Request.\n. I think you just confirmed yourself that you should use Request instead. As you can see from the code you just linked to, it's Request, not Request.JSON. So yes, it has a different approach.\nAnd no, the success event in case of Request.JSON means: \"We requested JSON successfully, here's your decoded object.\"\nIf any of the other devs feel like applying this change, feel free to do so, I still think it doesn't make sense. If you expect anything other than JSON (like requesting a status code), don't request JSON. It has nothing to do with thinking/assuming what kind of response you get, that's something you shouldn't do anyway. You should know what you get, if you don't, something else is wrong.\n. I would like to see that RFC. As far as I know, there is no specification about duplicate keys in a query string, and the behaviour is an implementation detail on the receiving side.\nMore importantly, though, not allowing duplicate keys in MooTools' query string implementation would render it incompatible with a lot of other implementations.\nWell known is PHP's implementation, where multiple key[]-style keys form an array of values, and multiple key-style keys just take the last defined value.\nA very flexible implementation is Django's QueryDict, through which you can retrieve all scalar values of a query string (which would return the last defined ones in the query string), or lists to retrieve lists of all values defined for the keys.\nSo, yea, like Arian said: you should probably turn off emulation. If you pass your own _method value, you don't seem to use the _method-emulation convention anyway, so I doubt you need it.\n. Thank you!\nhttps://github.com/mootools/mootools-more/issues/1189\n. Also fixed \"locally\" for the current live version of the docs.\n. To quickly try to explain why:\nthis in a function refers to the object of which it is a method. Say we have:\njavascript\nvar a = {\n    fn: function(){\n        return this;\n    }\n}\nthen a.fn() will return a.\nIf we then do:\njavascript\nvar b = {};\nb.fn = a.fn;\ncalling b.fn() will return b, since when the function is called, it's a method of the b object.\nWhen using event listeners, a similar thing happens. Your function may be initially created as a.fn, but when called as listener for an event of element bLink, it is called as a method of bLink.\nThere are two simple ways to get around this (no pun intended), both of which @arian mentioned in his examples.\n\njavascript\n$('bLink').addEvent('click', c.bFunction.bind(c));\n\nThis uses a function's bind method, which basically returns a new identical version of c.bFunction, but with this forced to c. Important to note: it is a new function (it is very similar to the original, but it's a new function), which may be relevant if you want to remove the listener later.\n\njavascript\n$('bLink').addEvent('click', function(){\n    c.bFunction()\n});\n\nThis has the same effect as using bind, with a few minor differences. The listener is called (with this === $('bLink')), after which it calls bFunction as method of c, therefore inside bFunction: this === c. A functional difference is that the listener looks up c, then finds its bFunction property to then call it, the listener is not directly referenced in the function, meaning that if the c object were to change and the bFunction property were to disappear or change, something else will happen for the click event as well.\n. Indeed, like @swhiteman said.\nMooTools 1.2-compatibility forces 1.2's bind behaviour to be used,\nsince MooTools 1.2 predates ES5, and if it didn't do that, MooTools 1.2\nplugins would break.\nMooTools 1.3 and newer use the ES5 behaviour, therefore turning off\n1.2-compatibility will give you the ES5 behaviour.\nNote that there are really only 2 differences:\n1. arguments passed are no longer an array, but instead are separate arguments,\n2. arguments passed to the returned function are concatenated with the\n   arguments passed to bind.\nFortunately the 1.2 bind implementation is very similar what ES5 would\ngo and specify later, unfortunately it is not identical. If you are\ntrying to upgrade from 1.2 to a newer version, there is a list of\nfunction calls that would have to be replaced in the wiki, for the\nspecific case of bind, there is a shell script that we used back\nthen to migrate part of More.\n. TIL: Github doesn't parse the comment as markdown when it's sent through email, instead of their web form.\n. Eventually merged into master by 86d9aeb5.\n. (Finally) merged into master by 86d9aeb. Thanks again, @dez87.\n. So the situation is: we currently have a broken and not optimal implementation, changing this makes it less broken and more optimal, without advertising new features or new API. Since this seems to pass tests and not break things (verification would be nice), I am inclined to pull this in, and we can have a new issue for next-major-release to review the API regarding the adding and removing of single and multiple classes.\nI just rebased the commits on top of master in timwienk/mootools-core/tree/use-classlist to have a more \"current\" version of this PR.\nAny opinions?\n. @arian and @kentaromiura were happy with this approach. So, issue for next major: #2594.\n. In MooTools it would look like something like this:\njavascript\ndocument.addEvent('click:relay(a)', function(event){\n    console.log('Link clicked: ', this);\n});\nhttp://mootools.net/docs/core/Element/Element.Delegation#Element:addEvent\n. I don't see how it is confusing, it'd be nice if you could elaborate on that.\nEvent pseudos have been a part of the framework for a long time, they're a flexible way to modify the behaviour of the specified event. A better solution, in my opinion, than adding an optional parameter in the middle of a function signature, making behaviour depend on the number of arguments / type of second argument.\nRegarding the propagation suggestions, there's another issue for that, so I'd prefer discussion about that subject to stay there, rather than split in multiple places.\n. IE11:\nhttps://github.com/timwienk/mootools-core/commit/86d9aeb5\nSpecs:\nhttps://github.com/timwienk/mootools-core/commit/5da678f7 (caution: big)\n. I'm willing to make it two separate things, but if no further changes are required anymore (see my response to your comment, @gonchuki), I'd personally like to get it over with.  :-D\n. Closed by commits 86d9aeb5 and 5da678f7.\n. No it doesn't, as we discussed yesterday, the IE fix was added the way it currently is (always using Browser.modernie for IE>10), because Browser Sniffing is to be phased out / deprecated. Adding another layer of different functionality would only make for more confusion.\nDocs need to be changed though. :-)\n. This is getting completely ridiculous (excuse my annoyance, but we discussed this at length the past days already).\nThe problem is that Browser.ie is currently NOT true in 1.4, IE11 detection is broken in 1.4. If it were not broken, this whole problem/discussion would not have come up.\nWhat we want to avoid is that we suddenly \"fix\" it in 1.5, and accidentally activate legacy code for IE11 where people expect it to not be active.\nSo, @SergioCrisostomo, your suggestion does the exact opposite of what this whole discussion is about.\n. @kentaromiura I'm very much hoping you/we can get that done. And if you/we do, we can change the docs to immediately say it's moved to the compat-build (rather than saying it'll be moved there in the future).\nSo yes, please investigate! :+1:\n. Let's just focus on the issue at hand, I'll update this in the Pull Request description as well:\n- Current state (1.4.5):\n  - IE11 detection broken\n- Desired state (1.5):\n  - Option 1:\n    - For all builds: Differentiate between IE>=10 (Browser.ie) and IE<=11 (Browser.modernie). This is to protect people from \"just\" using Browser.ie and treating them equally bad.\n  - Option 2:\n    - For normal build: Fix IE11 detection (i.e. all IE is once again Browser.ie). This is semantically correct.\n    - For compat build: Differentiate between IE>=10 (Browser.ie) and IE<=11 (Browser.modernie). This is to make sure we don't break existing projects that (implicitly or explicitly) rely on Browser.ie being falsy for IE11.\n  - Option 3:\n    - For all builds: Fix IE11 detection (i.e. all IE is once again Browser.ie). Breaking change, so this is not feasible, the compat build should remain compatible.\nSo: either Option 1 or Option 2.\n. Ok. This should now be ready to be pulled, in the most simple way (i.e. Olmo's option 4).\nA lot of voices in here are in favour of option 1. The reason I changed the PR to just do this approach is to at least have IE11 consistently fixed with the least required changes (compared to 1.4). I would like to see a decision reached regarding the modernie matter, but I didn't want this PR to wait for the decision since it seems to go back and forth.\n. Because our versioning scheme is totally amazing!\nLook at my versioning, my versioning is amazing, give it a lick, hmm, it tastes just like raisins!\n. Alright, once More doesn't require Browser[Browser.name] anymore, this can be pulled. :-)\nFrom what I gathered a while back, that's:\n- Interface/HtmlTable.Sort.js  --> Proposed PR \n- Drag/Drag.js  --> Proposed PR\n- Drag/Drag.Move.js  --> Proposed PR\n- Element/Element.Event.Pseudos.Keys.js  --> Proposed PR\n- Fx/Fx.Scroll.js  --> Proposed PR\n- Fx/Fx.Reveal.js  --> Proposed PR\n- Utilities/Swiff.js  --> Proposed PR\n- Utilities/IframeShim.js  --> Proposed PR\n. Just to add my two cents. You commented last Saturday:\n\none might want to disable/enable an event, but you might not be alone wanting that.\n\nThat is the exact reason why preventing an event from firing is not very logical and possibly/probably problematic. From a design perspective, if something fires an event when a certain state changes or action is taken, it should not depend on another component's desire for its event to fire. How the event is handled (which includes whether it is ignored or not) is up to the listener, not to the emitter.\nIf you have multiple components wanting to ignore the same event under the same circumstances (i.e. change multiple components' behaviour based on one state), maybe you could consider having a separate \"mediator\" component that handles just that. @DimitarChristoff's BetterEvent example would almost be ready to use as such a mediator, just add something to \"group\" events, so you can \"toggle\" between groups.\nA similar approach, though perhaps not the best example, is used in More's Keyboard class, where you can activate/deactive a set of key-listeners based on some state. You then listen to events on this Keyboard \"mediator\", rather than directly to the input.\n. That shell script is to tag and commit a release, not to build any files.\n. If I recall correctly, we made the \"stop setting visibility in setStyle\" change for 1.4.0, which was a logical change. But then we had to very quickly release 1.4.1 to fix fade, because our implementation of that always set visibility to hidden after fading opacity to 0 (arguably makes sense to do that anyway, fade is more than just a \"change style\" operation).\nI wouldn't be in favour of \"just\" dropping the setting of visibility in fade, expecting problems if we do. We should first investigate if we want to do such a breaking change. #2074 and #2081 provide more context.\n. That's a good catch. Browser.ie is only set in compat mode. It should either check Browser.name or just detect whether document.documentMode is set, before settings Browser.version to its value.\n. Thanks for creating the issue. We'll discuss this (un)documentation issue for the next release. :-)\nRegarding your aside, the function is executed as a method of the element, therefore this inside your function is a reference to the element. The arguments are actually the arguments you pass to the function at call time.\nhtml\n<div class=\"thing\"></div>\n``` javascript\nElement.implement('test', function(e){\n    console.log(this, e);\n});\n$$('.thing').test('argument');\n```\nhttp://jsfiddle.net/B5JY3/1/\n. A big thing to be Promises/A+ compliant is to not let exceptions ruin your day (which in turn often actually ruins your day), even in the \"executor function\" (the function passed to new Promise). I think for now our focus should be to make a Request instance \"thenable\", and not so much care about full compliance (yet?). A big benefit is that we don't have to care about what Promise implementation is present.\nA thing to keep in mind for a \"thenable\" Request is that our Request instances can be sent/executed multiple times, while a \"thenable\" should not change state after it's resolved. To make it work at all, I expect we'll have to keep a pending/success/failed state and a stack of \"reactions\". To make the \"thenable\" not act erratically when a Request gets re-sent/re-executed, we'll probably have to call the reject handlers of the added reactions (assuming the previous sending/execution hasn't completed, since there should be no reactions left if it is) and reset the state to start \"clean\". When a Request instance is only used once, this problem doesn't exist.\nNote: a \"reaction\" here is a combination of arguments to the then function, e.g. requestInstance.then(onFulfilled, onRejected) -> reaction = {fulfillHandler: onFulfilled, rejectHandler: onRejected}. Since any reaction can only be executed once, it can be removed from the stack after one of its handlers is executed.\nTo use this, people would use stuff like requestInstance.send().then(onFulfill, onReject).\nIf people want to wrap things in an actual Promise (and thus have full compliance), it's simple enough to do so:\n``` javascript\nnew Promise(function(resolve, reject){\n    var request = new Request({\n        onSuccess: resolve,\n        onFailure: reject,\n        onTimeout: reject,\n        onCancel: reject,\n        onError: reject,\n        onException: reject\n    });\nrequest.send();\n\n});\n```\nTo make things easier for ourselves, we could decide to add new fulfill and reject events, which we can use internally to set the state to make then work, and other people could use to easier wrap things in an actual Promise should they wish to do so.\n. I just realised that adding fulfill and reject events to wrap thing in an actual Promise are a bit stupid since, if we implement a \"thenable\" interface, you could just use the Request instance's then method to achieve the same:\njavascript\nvar promise = new Promise(function(resolve, reject){\n    var request = new Request();\n    request.send().then(resolve, reject);\n});\n. Created a Class.Thenable mixin, which implements a subset of the actual Promise functionality. It's added as mixin to the Request class.\nA Class implementing Class.Thenable should be Promises/A+ compatible, that is to say its instances' then methods act accordingly. On top of that Class.Thenable implements value resolving compatible with ES6 draft Promises, which means then calls can be chained as they would be with Promises.\nDifferences from Promises include that this is (obviously) a Class mixin, the resolve and reject functions are Class methods, and the state is reset-able (which does first reject to avoid unexpected results).\n. Important to emphasize is that this is not a Promise implementation, it lacks one of the important characteristics of a Promise: the fact that a Promise cannot change its value after being resolved once. To keep a Class instance usable, this state used for the \"thenable\" behaviour can be reset.\nFor the way the mixin would be used, this should not be a problem (and actually make it easier/better to use). In other ways this could be implemented, it would have to rely on an actual Promise implementation, and store a Promise instance to have a then function work. This Promise instance would then have to be replaced if a new value is resolved (i.e. a Request is sent for a second time), making for a similar \"reset\" situation.\nAn actual Promise could be easily implemented using this, though. An example is in the Docs/Class/Class.Thenable.md part of the changes.\n. WTF is this?\n. It's a very simple POSIX Shell script that changes a version and build number in a few files, and tags.\nThis commit makes it and invalid Shell script (it'll error right away, probably be along the lines of Line 3: Syntax error: Unexpected \"(\"), makes it a huge mess and adds stuff that has nothing to do with the tagging (even requires a grunt script to be run first, or it'll complain).\nI also have no clue why this suddenly comes up, after the IRC channel being dead for days. Very confusing.\nEither way, this is not what we want. :-)\n. It seems Opera doesn't pass your added test.\n. The problem here is really only Internet Explorer, in which the first letter of the prefix should not uppercased, while other vendors stuck with the default replacing of '-[a-z]' with '[A-Z]' for the DOM API (granted, for Webkit browsers, both uppercase and lowercase first letters of the prefix work).\nEasiest way we can probably fix this, is to replace /^-ms-/ to 'ms-' before camelCasing.\nRemoving the camelCasing is not an option. It is there to make setting of both hyphened and camelCased style properties possible.\n\nRegarding your comment, using Element.prototype.set('style', ...) is not a very good idea, since it'll just set the style attribute of the Element, removing any other styles you may have set before. Your setStylesPrefixed function will leave you with only the last style it encounters actually set.\nIf you need a workaround right now, it's probably best to use what I mentioned above, or alternatively setting 'ms-transform' or 'msTransform' instead of '-ms-transform'.\n. Slight issue with your setStylePrefixed function, you do want the '-' before all other prefixes, other than ms.\nSo, taking your function as example, you'll probably want something like this:\njavascript\nsetStylePrefixed: function(property, value){\n    var prefixes = ['-webkit-', '-moz-', '-o-', 'ms-'];\n    for (var i = 0, l = prefixes.length; i < l; ++i){\n        this.setStyle(prefixes[i] + property, value);\n    }\n    return this.setStyle(property, value);\n}\n\nClosing issue as requested.\n. Actually, the problem itself isn't resolved, reopening:\n\nThe problem here is really only Internet Explorer, in which the first letter of the prefix should not uppercased, while other vendors stuck with the default replacing of '-[a-z]' with '[A-Z]' for the DOM API (granted, for Webkit browsers, both uppercase and lowercase first letters of the prefix work).\nEasiest way we can probably fix this, is to replace /^-ms-/ to 'ms-' before camelCasing.\n. That'll be because document.id(arg) uses arg.$family() (a MooTools internal API) to determine the type when it's available, which returns \"string\" for strings, and since you're extending String, that's inherited.\n\nI'm not sure if fixing this would cause any side effects, we should probably figure that out. To fix it, we'd probably have to set this.$family = null in the Class \"factory\".\nIf you need to get it working right now, I don't think there's a way around using the internal API yourself right now, which is obviously a workaround that can't be guaranteed to work indefinitely. Fortunately, it's rather simple, you'd have to just set add $family: null to your Class definition.\nAlternatively, you could test the actual fix I have in mind for this (again, untested and unverified):\ndiff\n--- a/Source/Class/Class.js\n+++ b/Source/Class/Class.js\n@@ -23,6 +23,7 @@ var Class = this.Class = new Type('Class', function(params){\n        reset(this);\n        if (newClass.$prototyping) return this;\n        this.$caller = null;\n+       this.$family = null;\n        var value = (this.initialize) ? this.initialize.apply(this, arguments) : this;\n        this.$caller = this.caller = null;\n        return value;\n. Much appreciated, glad it works. I'll ask other devs to have an opinion on the matter, in case it breaks something I haven't realised.\n. Very nice, thanks a lot for that!\nHowever, would it be possible to follow the code style as it is in the rest of the code and tests? That is mostly: indented with tabs, a different way of using whitespace around braces and parentheses, and as little abbreviations as necessary (for example just element instead of el).\nA quick overview is in the wiki:\nhttps://github.com/mootools/mootools-core/wiki/Syntax-and-Coding-Style-Conventions\n. Firstly, we already have this in More for events, called \"throttle\", which is the main use of this, I'd guess:\nhttps://github.com/mootools/mootools-more/blob/master/Source/Class/Events.Pseudos.js#L125\nRegarding the API, I don't think an object as argument is a good idea. I agree with Dimitar, all it'd need is a \"delay\". I don't quite understand what the \"early\" or \"once\" things should do.\n. Firstly, thanks for wanting to participate and trying to improve MooTools.\nHowever, you make it sound as if you think these things have never been discussed, considered or tried within MooTools or for MooTools Core specifically. The fact is, though, that MooTools Core has been a modular framework since before there was any (de-facto or otherwise) standard for modularisation in JavaScript. And later on, work was just never completed to actually support a standard that had arised since then. (See #2102).\nAfter that, you establish that extending natives is \"not a good pattern\", while you call it \"the nature of MooTools\", that is quite a conflict. It is indeed the nature of MooTools Core 1.x, and because it is its nature, it would be very awkward to change. It's fully understandable (and, I guess true) that the approach is not suitable for your projects designed according to currently accepted/popular principles, but that just means that MooTools Core 1.x is not suitable for these projects, which isn't weird for a project library developed in 2006. MooTools Core 1.x is a library of which the structure and design were developed in a time when the Javascript and browser landscapes were entirely different.\nAs has been said before, for a possible MooTools Core 2.x, this design would obviously be reconsidered (likely it would be an optional feature, for those who control their environment and would like these things globally present), and obviously one of the current standards for modularisation would be used. On top of that, a very big part of MooTools Core 1.x is no longer relevant (and hasn't been for a while), because of how JavaScript itself and the engines/browsers have developed.\nAll-in-all, in my opinion, if there is to be a MooTools Core 2.x, for it to be credible and reliable (or even relevant), it would have to be a complete revisit/rewrite. For MooTools Core 1.x, only the commonjs-style modularisation part could be relevant, but changing how natives are handled should not be part of that.\n. > Some tests are disabled with using xdescribe, for example https://github.com/timwienk/mootools-core/compare/spec-update-part-3...spec-update-part-4#diff-d7242700ac47efe4e538390355c32968R50\n\nIs that still valid, or was it disabled at some point and never enabled again?\n\nThe specs where there's now xdescribe, there used to be a xit, so yea, they were disabled and never re-enabled. I believe they're tests from our old spec engine with PHP stuff. [intended]\nI did just realise that if they were enabled, they'd fail now, because Mocha uses arguments to done as reasons a spec failed, while Jasmine has done.fail for that. [fixed]\n\nchai uses expect(..).to.be.true, where true is a keyword. iirc that doesn't work in IE8, and should be to.be['true']. Is that relevant? (https://github.com/chaijs/chai/issues/124#issuecomment-11639702)\n\nThat's a good point. I kind of assumed they made it work. The best workaround is probably to use replace to.be.true with to.equal(true). The same thing should be the case for to.be.false and to.be.null. Will look into that. [fixed]\nIt should be fine for to.be.undefined, however, for the sake of consistency, maybe we should replace those as well. [fixed]\n. > This is one of the reasons I initially used https://github.com/Automattic/expect.js (and kept using it since, I think chai wasn't really a thing then, the other choice was 'should.js').\nChai seems a very complete solution, including assert style assertions as well, which could benefit us in the future. However, if things don't work in IE older than 9, we should probably switch. Although I prefer some specific things Chai did with the expect syntax, the syntax of all expect style things are very similar anyway. [fixed]\n. After looking at things, they clearly state they don't support IE<9, so Chai is not an option. I replaced it with the library Arian suggested, expect.js. [fixed]\n. New issues encountered:\n- Specs fail in IE7, because Karma v0.13 does not work in IE7. [fixed]\n  - Reason: Karma v0.13 uses a newer version of socket.io that causes problems in IE7. Supposedly this is fixable by passing transports: ['polling'], forceJSONP: true to socket.io, but Karma doesn't allow for the forceJSONP option to be passed right now.\n  - Solution: downgrade back to v0.12.\n- Specs fail in IE>10, because Sinon v1.17 does not work in IE>10. [fixed]\n  - Reason: Things break in a very weird way when doing the IE-compat stuff from within a conditional on IE11 (and Edge).\n  - Solution: downgrade to v1.14, until sinonjs/sinon#848 is fixed.\n  - Alternative solution (in case it doesn't get fixed): we could change our environment to only load sinon-ie for old IE, this would be annoying when testing locally(/manually), since you need different karma-plugins for different envs.\n- Specs fail in IE9 and IE10, because no current version of syn works in IE9 and IE10. [fixed]\n  - Reason: The feature test for <a href=\"javascript:something()\" /> in IE9 and IE10 causes a page reload of which Karma doesn't approve.\n  - Solution: use a local version that does work (hopefully temporarily). I've described the issue in bitovi/syn#105.\nLatest test results:\nhttps://travis-ci.org/timwienk/mootools-core/builds/82323286\n. > @arian:\n\nAdd node_js 4 here as well?\nNever mind, it's already included in the other matrix.\n\nYes, what I changed in .travis.yml is: instead of adding the multiple node_js versions when building the matrix, only one is used for that, and the non-current versions are \"manually\" included after the matrix is built for only server testing. That way we don't have 75 runs of which 48 actually do nothing.\n\n@arian:\nHowever if you use version 4, will it automatically use the latest 4.x version? As they are using proper semver now, all 4.x versions should automatically work.\n\nThat's a good point, I'll change that and hopefully they indeed don't break within the major version. :-D [fixed]\nhttps://travis-ci.org/timwienk/mootools-core/builds/82406894\n. Okay, so everything seems to work. Now for the last two questions:\n1. Do we agree on switching to Mocha? What are the reasons not to?\n2. When we go and merge, shall I PR this:\n   - with everything in one PR,\n   - as 6 separate PRs; one per part,\n   - or two PRs; one for the first 5 parts, one for the mocha stuff?\n. There is no reason to explain how regular expressions work in general, I'm sure that anyone who wants to work or read regular expressions either knows what things like \\d mean or can find this information elsewhere, it's super basic information.\nHowever, more content related comments regarding regular expressions are very useful. What we've done in the past is add a comment explaining how to build the specific regular expression just above the \"compiled\" version of it, so it's easier to recreate and/or update and enhance.\nExample:\nhttps://github.com/mootools/mootools-more/blob/1.5.2/Source/Forms/Form.Validator.js#L473-L486\n`` javascript\n/*\nvar chars = \"[a-z0-9!#$%&'*+/=?^_{|}~-]\",\n    local = '(?:' + chars + '\\.?){0,63}' + chars,\nlabel = '[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?',\nhostname = '(?:' + label + '\\\\.)*' + label;\n\noctet = '(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)',\nipv4 = '\\\\[(?:' + octet + '\\\\.){3}' + octet + '\\\\]',\n\ndomain = '(?:' + hostname + '|' + ipv4 + ')';\n\nvar regex = new RegExp('^' + local + '@' + domain + '$', 'i');\n/\nvar regex = /^(?:[a-z0-9!#$%&'+\\/=?^_{|}~-]\\.?){0,63}[a-z0-9!#$%&'*+\\/=?^_{|}~-]@(?:(?:a-z0-9?.)*a-z0-9?|[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)])$/i;\n```\nI would not like to add \"<devComment>\" around it, there is no reason to. They're comments in the source code, so they're \"dev comments\" by default. Minified versions will strip them out anyway.\n. Thanks for the feedback and questions. Quite happy to see practical responses.\n@anutron, I agree with the question you put forward, I guess it's quite obvious I agree with @fakedarren's answer, otherwise I wouldn't have written the code, but it's a good thing to bring up. I think this implementation offers something new and very useful by not attempting to add \"yet another Promise implementation\", but instead offering a way to work with Promise implementations in a compliant manner and still working fine stand-alone.\nTo answer @arian I'll need a bit more text, because it gets a bit detailed, so brace yourselves (and blame @arian, he asked!):\n[TL;DR] I'm generally available on IRC if anyone prefers to discuss/ask there in case this text isn't clear or is too long to parse.\nYes, request.send() still returns itself. Classes and their instances work as they always have, nothing changed in that respect, and everything works as we expect the Classes to. What this code does is not actually implement Promises itself, it implements a mixin to make any instance of the Class itself Promises/A+ compliant (or to actually implement Promises if you want to, see the example in the description of the PR).\nThere is no rule (or reason for) saying that an arbitrary object cannot act the same way as a Promise, because its goal is to (quite literally) promise that a value will be resolved at some point. You can basically interpret new Request as the instantiation of very specific kind of Promise that goes to resolve its value by calling send. Another way to look at it is that a new Request keeps a Promise internally which you interact with, but the former seems more accurate.\nIf you do want an actual Promise to work with, you could do Promise.resolve(request) (or Promise.resolve(request.send()) if you feel that's nicer), which works because of part 2.3.3.3 of the spec: the Promise calls request.then and uses that to resolve itself (it basically adopts the request's state).\nThe usual (and even mandatory) thing is that calling then does not return itself and returns a new object that gets resolved with the value returned by the argument(s) you pass to then, which is indeed what it does.\nI do want to point out that referring to Class.Thenable as a Promise implementation is not technically correct, because of the exception I mentioned in the description of this PR, which is related but not the same as what you mention, @arian. As I mentioned, the case is not that send() should return a new Promise(-like) object, but it is the case that a Promise can only be used/resolved once. Because Class instances are often used more than once (e.g. multiple request.send or fx.start calls), this implementation makes the state resettable. Using the \"internal Promise\" analogue I used earlier: think of it as ditching the old Promise (rejecting it if it's not yet resolved) and taking on a new one. This way nothing is left unresolved, and it's similar to either doing a new send after things are done, or canceling the old send.\nThe only thing that does get interesting is using Class.Thenable style interaction together with Chain style interaction, these are two different ways of chaining actions. I noted this in the docs. (Probably a minor issue anyway, because of defaults and the unlikelihood of people using chain if they can use then. We could even consider adapting Chain to use Class.Thenable, but let's not get into that right now.)\n. What are the reasons we don't want to polyfill pointer events for older browsers, at least its basic behaviour (I realise things like width, pressure and tilt are probably not doable, but I'd guess pointer events in general could work when fired through mouse and touch events)?\nOne of MooTools Core's main goals has been to abstract differences between browsers. I realise MooTools development is mostly maintenance and keeping it working with recent standards now, but if the features we add can be supported in all browsers we support, I think they should be (we would have in the past, in such a case).\nOther than that, the work that is done looks good (so definitely :+1: and :smiley: for that). But to merge into master (and thus be releasable), I'd like to either be convinced we indeed shouldn't polyfill basic pointers for older supported browsers, or otherwise see an effort towards basic support.\nAnother request, could you rebase your branch on top of the latest mootools/master? We've added a few things to the automated tests since your fork.\n. I'm not fussed about squashing, in most cases I actually don't like it, since you destroy history that might actually useful to be able to understand why/how a decision (or error) was made. I personally do amend stupid/syntax things onto the commit they fix up, but again, not really fussed. I believe the reason people like to squash is to have a shorter/cleaner history, for which one could just as well use git log --merges (in fact, if every change set is squashed after rebasing, why have merge commits at all).\n. Merged in 7300b1c.\nWith typo in commit message: I apparently missed the \"1\" key once while typing \"10.10\".\n. Having the presence of something specific depend on the whether an unspecified request is pending is quite weird from a technical design point of view. Instead, you should probably just listen for the right events to be emitted.\nIn case you do still want this kind of functionality, you can use the events emitted by the Request instances to create such a state variable.\nConsider the following:\njavascript\nvar Application = {\n    running: 0,\n    request: new Request({\n        onRequest: function(){\n            Application.running += 1;\n        },\n        onComplete: function(){\n            Application.running -= 1;\n        }\n    })\n};\n. It seems we agree, @arian.\nCombine the two answers and you get an application with a request factory:\njavascript\nvar Application = {\n    runningRequests: 0,\n    createRequest: function(options){\n        return new Request(options).addEvents({\n            request: function(){\n                Application.runningRequests += 1;\n            },\n            complete: function(){\n                Application.runningRequests -= 1;\n            }\n        });\n    })\n};\n. In your JSFiddle you the following error is thrown: TypeError: $(...).fireEvents is not a function.\nThe problem is indeed what Sandy just mentioned, you should use fireEvent, not \"fireEvent_s_\".\nI will close this issue. If you would like any other support, please ask on the mailing list:\nhttps://groups.google.com/forum/#!forum/mootools-users\n. That was a mistake, and it's fixed now.\nSomething went wrong with tagging the release, so we ended up creating the tag later. Apparently we didn't re-fetch the repository on the web server for it to know about the tag, and it got stuck on master, rather than retrying.\nThe commit master referred to was 1.6.0 + 1, so there is no actual functional difference, the only difference is the version number in the file: https://github.com/mootools/mootools-core/commit/2f0aee54c40525e4261b556bc6ed2a12a619db73\n. Thanks for reporting! :+1:\n. I'm not. The ESLint settings are for our source files, and we require all our source files to only have linefeeds as newline characters.\nWhat Grunt task are you getting errors from about CRLF newline characters? I don't remember the built files being ESLinted at all (and I don't really see why we would, if we do).\nWhat we could do, however, is set grunt.util.linefeed = '\\n'; in the Gruntfile.js. That should make Grunt use only linefeeds when building.\n. The steps you mentioned should indeed not be necessary, but I think I understand the issue now, so thanks for explaining.\nI assumed that you got the errors because the built file was ESLinted, which seemed awkward to me (since, like I mentioned, the built file should not be ESLinted at all). However, you just confirmed that the errors occur during the built itself.\nI'm fairly certain the problem is not with Grunt or ESLint, but with the way Git handles text files by default. Git's default setting of core.eol = native makes it so upon checkout text files are converted to use CRLF line endings in windows working directories, even if they use LF line endings in the repository. I'm sure this avoids a lot of problems when editing files, but it creates problems like these when enforcing consistency within files.\nSo, instead of changing the ESLint settings, we should change the way Git handles these files. There is a local way of doing this, using your local config, but instead I think we should add .gitattributes file to make sure it's done correctly everywhere.\nAdditionally, I think we should still add the grunt.util.linefeed = '\\n', so the built file won't have a mix of LF and CRLF line endings afte this change.\nI've just pushed ~~https://github.com/timwienk/mootools-core/commit/cba3825~~ https://github.com/timwienk/mootools-core/commit/70afaa8 to my own repository. Is it possible for you to test whether that fixes your issues?\nIf you're pulling the change to an existing clone of the repository, you will have to re-checkout the files after pulling the commit so the line ending change takes effect. From inside the repository, this should work:\n$ rm .git/index\n$ git reset --hard\nOr, in a normal Windows prompt:\n```\n\ndel .git\\index\ngit reset --hard\n```\n. > when you install msysgit it asks you specifically about line endings\n\nI see. I guess that question will set core.autocrlf accordingly.\nIn my commit I also set * text=auto in the .gitattributes file. That will make it so that (independent of the core.aotocrlf value) all files are checked out with CRLF line endings when core.crlf = crlf (or core.crlf = native on Windows). From your comment, Dimitar, that seems to not be a good idea.\nI've replaced my commit with https://github.com/timwienk/mootools-core/commit/70afaa8. That way it only changes behaviour for JavaScript files: they will always be checked out with LF line endings.\n. Since the changes I made aren't in actual functional code, I'm going to go ahead and push them to the master branch.\n@esr360, if you have time, it'd be great if you can let us know whether this solved your problems. If not, we can try and look further.\nDo remember that, when pulling to an existing clone of the repository in an environment that converts to CRLF, you will have to re-checkout the files after pulling the commit so the line ending change takes effect. From inside the repository, this should work:\n$ rm .git/index\n$ git reset --hard\nOr, in a normal Windows prompt:\n```\n\ndel .git\\index\ngit reset --hard\n```\n. Great, thanks for letting us know!\n. Indeed. Many problems like these are caused by using MooTools Core with compatibility additions while it is not necessary. You have to choose between compatibility with old MooTools or compliance with newer standards.\n\nSince this issue is rather old, I assume it has been solved by now, but just to be clear:\nDo not use MooTools libraries in compatibility mode when you do not need compatibility with old MooTools versions. Doing so is basically depriving yourself of newer JavaScript features.. > v1.5.2\nI think there is a mixup somewhere, Class.Thenable was introduced in 1.6.0. So if you're using 1.5.2, the Request.JSON classes won't inherit from the Class.Thenable mixin since it doesn't exist yet.\nCould you check again? Could it be that multiple versions are loaded and a race condition makes for the inconsistent behaviour?\nIn case it helps:\n- 1.6.0 docs\n- 1.5.2 docs\n. PhantomJS is at the top because it doesn't require an actual browser, which means for those tests it doesn't need to connect to Sauce Labs and it's faster to execute.\nThe order of the actual browsers is mostly just \"taste\" I guess, in the order from the one we hate the least to the one we hate the most, and versions from new to old.\nHowever, you could argue that it's in the order of least expected errors: if something errors in Chrome, Firefox or Edge, there's probably something seriously wrong and we'd see it quicker in this order, whereas the other browsers - especially old IE - sometimes fail for no reason (or even because launching or connecting to the browser fails), so we'd re-run those tests before agreeing that there's an actual error.. This is most likely caused by the fact that you're using MooTools Core with compatibility additions for older versions, you have to choose between compatibility with old MooTools or compliance with newer standards.\nBack when MooTools 1.3 was released, there was no native Event object, and MooTools defined its own. In 1.4 MooTools Core's Event object was renamed to DOMEvent.\nThe Native Event object is overwritten by the compatibility functionality, to make sure MooTools Core is compatible with version 1.3 in this case.\nIf you do not need compatibility with old MooTools versions, you should not use the \"compat\" version. You only need the \"compat\" version if your code is old and/or relies on old code.. Probably easier, you can download it on https://mootools.net/core, or you can build your own version with only what you need on https://mootools.net/core/builder.\nAdditionally, the CDN you used in your example also distributes the no-compat version:\n- https://cdnjs.cloudflare.com/ajax/libs/mootools/1.6.0/mootools-core.js\n- https://cdnjs.cloudflare.com/ajax/libs/mootools/1.6.0/mootools-core.min.js\nAnd so does Google:\n- https://ajax.googleapis.com/ajax/libs/mootools/1.6.0/mootools-nocompat.js\n- https://ajax.googleapis.com/ajax/libs/mootools/1.6.0/mootools-nocompat.min.js. There is no file/directory structure without compatibility additions. The compatibility additions are stripped in the packaging/building process.\nIf you want all source files separately with compatibility stripped, you'll have to do it yourself. You can do that manually, reconfigure (or even adapt) the packager to your needs, or you can try and see if it's doable with the currently available tools.\nPerhaps the Advanced Building and Testing part of the README can help.\nIt's not actually supported, though, and you'll probably be doing a bunch of manual things to get this done.\nAdvanced Building and Testing: https://github.com/mootools/mootools-core/blob/master/README.md#advanced-building-and-testing. LGTM.\njavascript\nnew Element('input[type=checkbox][checked]');\nworks with this as well, tested by @arian.\n. Like cpojer said, thanks for the great report. Very detailed, very nice. We didn't even have to debug to fix it. ++\nAnyway, the first problem you described is an encoding problem. In some weird way, a 0xC2A0 (no-break space in UTF-8) made its way into the code, rather than a 0x20 (a normal space). When serving the file UTF-8 encoded, there is no problem, a no-break space is treated as just a whitespace character. When serving the file as ISO-8859, 0xC2 is an \u00c2, while 0xA0 is a no-break space.\nThis explains why the error wasn't caught (it's no excuse though), as we probably(/apparently) all work and test in UTF-8 environments. (MooTools-More's Locale files, for example, are UTF-8 by design, but obviously for just Core it shouldn't matter.) Like cpojer said, 1.4.1 will be out the door soon enough, fixing this nasty issue!\nThe second issue you raised is because $family changed from an object to a function in 1.3. It's only used by $type/typeOf. The fact that it throws an error about an object with $family.name == 'array' is rather awkward, should be something in the APE test itself (I hope)? In any case, technically $family is private (which is why there currently is no compatibility), but the issue will be discussed, and decided whether there should be compatibility in the $type function for it.\nThanks again!\n. I just realized you said it does work with 1.3+1.2compat, there was no compatibility for this either in 1.3. So that issue will need some more investigation.\n. :+1:\n. Indeed. The docs should mention the conditions for failure are different for Request.JSON.\n. It's the standard behaviour. You can take a look at the MDN reference for more information.\nThe idea is that fn.bind() returns a new function, doing the same as the original one, but with a different value for this. So every time you call bind you get another new function. Saving a reference to remove the function is not a \"workaround\", it's the actual right way of going about things.\nThe Class arian linked does it the saving of references for you. The first time you call this.bound('functionName') you get a new reference to a bound version of that function. Any time after the first, when you call this.bound('functionName') the same reference is returned, rather than creating another new one.\n. I agree about its perceived necessity, however: untrusted user code should be executed with a clean stack to avoid these kinds of problems, plus the fact that acting upon events is quite obviously an asynchronous process. This is a design oversight on our part that's been there for a long time. I'm unsure what the best course of action is, since @kentaromiura's comment regarding breakage is probably true as well. I see the following options:\n- A try-catch around every execution to keep things synchronous. (Maybe manually re-throw the caught errors after all events were executed? (with a clean stack?)) (1.6?),\n- Asynchronous execution of each handler (only way to execute with a clean stack, as far as I know) (1.6?),\n- Keep current behaviour (and optionally add the new method @kentaromiura suggested, though I feel that's quite weird, since Class X would basically have to be aware of which way Class Y uses to fire its events) (could optionally be 1.5.x).\n. Regarding your comment on the first point: this is about theEventsClass mixin, notElement.Events. A possible performance issue regarding mousemove doesn't affect theEventsclass mixin as far as I'm aware. (Also,Element.Events` uses native events, it should already be asynchronous.)\nExample regarding wrapping in a try-catch:\nhttp://jsfiddle.net/358jjnsf/\njavascript\nfireEvent: function(type, args, delay){\n    type = removeOn(type);\n    var events = this.$events[type];\n    if (!events) return this;\n    args = Array.from(args);\n    events.each(function(fn){\n        if (delay){\n            fn.delay(delay, this, args);\n        } else {\n            try {\n                fn.apply(this, args);\n            } catch (error){\n                (function(){ throw error; }).delay(0);\n            }\n        }\n    }, this);\n    return this;\n});\nObvious problem with the above is, if people actually depend on fireEvent throwing an exception if a handler messes up, it won't anymore. The Error object should still have the original call stack stored, but it would be thrown asynchronously (to not disrupt normal event handling).\n. CustomEvent relies on a DOM implementation, doesn't it? And thus makes the Events Class mixin depend on a browser or a non-native DOM implementation.\n. What the pojer said: http://jsfiddle.net/M6efP/1/\n. A p-element cannot contain block-level elements (including another p). Therefore <p><p> will be interpreted as <p></p><p></p> and <p><div> as <p></p><div></div>.\nExample:\n- http://jsfiddle.net/vBDKa/\nReference:\n- http://www.w3.org/TR/html4/struct/text#h-9.3.1\n. The second argument to toggleClass is a boolean. If you pass it an undefined value, it's not going to assume you meant false, as you passed it something undefined, so it'll still use the default behaviour (that is: removing the class if it's present, adding the class if it's not present).\n. No problem. Note there are also addClass and removeClass methods on Element.\n. Object.forEach and Object.each only iterate own properties (see: hasOwnProperty). By creating the logic object in the Class definition, upon instantiation you get an instance of a new object using your logic object as prototype, rather than the logic object itself. The reason for this is inheritance: 1. Changing the object's properties in an instance won't have effect on the actual class definition (it would if the object itself was used in the instance (either assigned or through the Class' prototype)). 2. Changing the object in the class definition will properly reflect in instances of that class (it wouldn't if the object was cloned in the instance).\nIf you want an object with its own properties, and therefore be able to use Object.each to iterate its values, you'd have to create it in the instance itself (like in the initialize method). Another option is to use a way of looping that does not care about own properties (for...in?). In general the first option would be appropriate.\n. Request.JSON is meant to return JSON (you are Requesting JSON...), when it fails to do so it will fire fire the 'failure' event. When you don't expect JSON to be returned, you should use Request instead (you can always do JSON parsing in the success event handler, if JSON has to be decoded occasionally).\nAlso, things work a bit different than you're trying to explain: isSuccess is used. isSuccess is the first function executed after the XHR's readyState changes to DONE (or 4), on returning false the failure event is fired right away, on returning true the success function is executed, trying to parse the JSON and firing the success or failure depending on the parsing result.\nI understand this may seem a bit illogical, due to the function's name, but that's mostly because Request.JSON extends Request, and therefore inherited its naming. Bottom line is though, Requesting JSON and not getting JSON back means Request.JSON failed to do what it is meant to do, which means failure. For your case Request should be the way to go.\n. It's a backward incompatible shift of logic, and it's a backward incompatible shift of logic I don't agree with. Request.JSON is there to return JSON, when it fails to do so, it fires failure. Using the right tool(/class) for the job can't really be considered a \"work around\". I have never run into any kind of \"scaling issues\", \"rogue requests\" or \"race conditions\" you're describing, you should be fine just using Request.\n. I think you just confirmed yourself that you should use Request instead. As you can see from the code you just linked to, it's Request, not Request.JSON. So yes, it has a different approach.\nAnd no, the success event in case of Request.JSON means: \"We requested JSON successfully, here's your decoded object.\"\nIf any of the other devs feel like applying this change, feel free to do so, I still think it doesn't make sense. If you expect anything other than JSON (like requesting a status code), don't request JSON. It has nothing to do with thinking/assuming what kind of response you get, that's something you shouldn't do anyway. You should know what you get, if you don't, something else is wrong.\n. I would like to see that RFC. As far as I know, there is no specification about duplicate keys in a query string, and the behaviour is an implementation detail on the receiving side.\nMore importantly, though, not allowing duplicate keys in MooTools' query string implementation would render it incompatible with a lot of other implementations.\nWell known is PHP's implementation, where multiple key[]-style keys form an array of values, and multiple key-style keys just take the last defined value.\nA very flexible implementation is Django's QueryDict, through which you can retrieve all scalar values of a query string (which would return the last defined ones in the query string), or lists to retrieve lists of all values defined for the keys.\nSo, yea, like Arian said: you should probably turn off emulation. If you pass your own _method value, you don't seem to use the _method-emulation convention anyway, so I doubt you need it.\n. Thank you!\nhttps://github.com/mootools/mootools-more/issues/1189\n. Also fixed \"locally\" for the current live version of the docs.\n. To quickly try to explain why:\nthis in a function refers to the object of which it is a method. Say we have:\njavascript\nvar a = {\n    fn: function(){\n        return this;\n    }\n}\nthen a.fn() will return a.\nIf we then do:\njavascript\nvar b = {};\nb.fn = a.fn;\ncalling b.fn() will return b, since when the function is called, it's a method of the b object.\nWhen using event listeners, a similar thing happens. Your function may be initially created as a.fn, but when called as listener for an event of element bLink, it is called as a method of bLink.\nThere are two simple ways to get around this (no pun intended), both of which @arian mentioned in his examples.\n\njavascript\n$('bLink').addEvent('click', c.bFunction.bind(c));\n\nThis uses a function's bind method, which basically returns a new identical version of c.bFunction, but with this forced to c. Important to note: it is a new function (it is very similar to the original, but it's a new function), which may be relevant if you want to remove the listener later.\n\njavascript\n$('bLink').addEvent('click', function(){\n    c.bFunction()\n});\n\nThis has the same effect as using bind, with a few minor differences. The listener is called (with this === $('bLink')), after which it calls bFunction as method of c, therefore inside bFunction: this === c. A functional difference is that the listener looks up c, then finds its bFunction property to then call it, the listener is not directly referenced in the function, meaning that if the c object were to change and the bFunction property were to disappear or change, something else will happen for the click event as well.\n. Indeed, like @swhiteman said.\nMooTools 1.2-compatibility forces 1.2's bind behaviour to be used,\nsince MooTools 1.2 predates ES5, and if it didn't do that, MooTools 1.2\nplugins would break.\nMooTools 1.3 and newer use the ES5 behaviour, therefore turning off\n1.2-compatibility will give you the ES5 behaviour.\nNote that there are really only 2 differences:\n1. arguments passed are no longer an array, but instead are separate arguments,\n2. arguments passed to the returned function are concatenated with the\n   arguments passed to bind.\nFortunately the 1.2 bind implementation is very similar what ES5 would\ngo and specify later, unfortunately it is not identical. If you are\ntrying to upgrade from 1.2 to a newer version, there is a list of\nfunction calls that would have to be replaced in the wiki, for the\nspecific case of bind, there is a shell script that we used back\nthen to migrate part of More.\n. TIL: Github doesn't parse the comment as markdown when it's sent through email, instead of their web form.\n. Eventually merged into master by 86d9aeb5.\n. (Finally) merged into master by 86d9aeb. Thanks again, @dez87.\n. So the situation is: we currently have a broken and not optimal implementation, changing this makes it less broken and more optimal, without advertising new features or new API. Since this seems to pass tests and not break things (verification would be nice), I am inclined to pull this in, and we can have a new issue for next-major-release to review the API regarding the adding and removing of single and multiple classes.\nI just rebased the commits on top of master in timwienk/mootools-core/tree/use-classlist to have a more \"current\" version of this PR.\nAny opinions?\n. @arian and @kentaromiura were happy with this approach. So, issue for next major: #2594.\n. In MooTools it would look like something like this:\njavascript\ndocument.addEvent('click:relay(a)', function(event){\n    console.log('Link clicked: ', this);\n});\nhttp://mootools.net/docs/core/Element/Element.Delegation#Element:addEvent\n. I don't see how it is confusing, it'd be nice if you could elaborate on that.\nEvent pseudos have been a part of the framework for a long time, they're a flexible way to modify the behaviour of the specified event. A better solution, in my opinion, than adding an optional parameter in the middle of a function signature, making behaviour depend on the number of arguments / type of second argument.\nRegarding the propagation suggestions, there's another issue for that, so I'd prefer discussion about that subject to stay there, rather than split in multiple places.\n. IE11:\nhttps://github.com/timwienk/mootools-core/commit/86d9aeb5\nSpecs:\nhttps://github.com/timwienk/mootools-core/commit/5da678f7 (caution: big)\n. I'm willing to make it two separate things, but if no further changes are required anymore (see my response to your comment, @gonchuki), I'd personally like to get it over with.  :-D\n. Closed by commits 86d9aeb5 and 5da678f7.\n. No it doesn't, as we discussed yesterday, the IE fix was added the way it currently is (always using Browser.modernie for IE>10), because Browser Sniffing is to be phased out / deprecated. Adding another layer of different functionality would only make for more confusion.\nDocs need to be changed though. :-)\n. This is getting completely ridiculous (excuse my annoyance, but we discussed this at length the past days already).\nThe problem is that Browser.ie is currently NOT true in 1.4, IE11 detection is broken in 1.4. If it were not broken, this whole problem/discussion would not have come up.\nWhat we want to avoid is that we suddenly \"fix\" it in 1.5, and accidentally activate legacy code for IE11 where people expect it to not be active.\nSo, @SergioCrisostomo, your suggestion does the exact opposite of what this whole discussion is about.\n. @kentaromiura I'm very much hoping you/we can get that done. And if you/we do, we can change the docs to immediately say it's moved to the compat-build (rather than saying it'll be moved there in the future).\nSo yes, please investigate! :+1:\n. Let's just focus on the issue at hand, I'll update this in the Pull Request description as well:\n- Current state (1.4.5):\n  - IE11 detection broken\n- Desired state (1.5):\n  - Option 1:\n    - For all builds: Differentiate between IE>=10 (Browser.ie) and IE<=11 (Browser.modernie). This is to protect people from \"just\" using Browser.ie and treating them equally bad.\n  - Option 2:\n    - For normal build: Fix IE11 detection (i.e. all IE is once again Browser.ie). This is semantically correct.\n    - For compat build: Differentiate between IE>=10 (Browser.ie) and IE<=11 (Browser.modernie). This is to make sure we don't break existing projects that (implicitly or explicitly) rely on Browser.ie being falsy for IE11.\n  - Option 3:\n    - For all builds: Fix IE11 detection (i.e. all IE is once again Browser.ie). Breaking change, so this is not feasible, the compat build should remain compatible.\nSo: either Option 1 or Option 2.\n. Ok. This should now be ready to be pulled, in the most simple way (i.e. Olmo's option 4).\nA lot of voices in here are in favour of option 1. The reason I changed the PR to just do this approach is to at least have IE11 consistently fixed with the least required changes (compared to 1.4). I would like to see a decision reached regarding the modernie matter, but I didn't want this PR to wait for the decision since it seems to go back and forth.\n. Because our versioning scheme is totally amazing!\nLook at my versioning, my versioning is amazing, give it a lick, hmm, it tastes just like raisins!\n. Alright, once More doesn't require Browser[Browser.name] anymore, this can be pulled. :-)\nFrom what I gathered a while back, that's:\n- Interface/HtmlTable.Sort.js  --> Proposed PR \n- Drag/Drag.js  --> Proposed PR\n- Drag/Drag.Move.js  --> Proposed PR\n- Element/Element.Event.Pseudos.Keys.js  --> Proposed PR\n- Fx/Fx.Scroll.js  --> Proposed PR\n- Fx/Fx.Reveal.js  --> Proposed PR\n- Utilities/Swiff.js  --> Proposed PR\n- Utilities/IframeShim.js  --> Proposed PR\n. Just to add my two cents. You commented last Saturday:\n\none might want to disable/enable an event, but you might not be alone wanting that.\n\nThat is the exact reason why preventing an event from firing is not very logical and possibly/probably problematic. From a design perspective, if something fires an event when a certain state changes or action is taken, it should not depend on another component's desire for its event to fire. How the event is handled (which includes whether it is ignored or not) is up to the listener, not to the emitter.\nIf you have multiple components wanting to ignore the same event under the same circumstances (i.e. change multiple components' behaviour based on one state), maybe you could consider having a separate \"mediator\" component that handles just that. @DimitarChristoff's BetterEvent example would almost be ready to use as such a mediator, just add something to \"group\" events, so you can \"toggle\" between groups.\nA similar approach, though perhaps not the best example, is used in More's Keyboard class, where you can activate/deactive a set of key-listeners based on some state. You then listen to events on this Keyboard \"mediator\", rather than directly to the input.\n. That shell script is to tag and commit a release, not to build any files.\n. If I recall correctly, we made the \"stop setting visibility in setStyle\" change for 1.4.0, which was a logical change. But then we had to very quickly release 1.4.1 to fix fade, because our implementation of that always set visibility to hidden after fading opacity to 0 (arguably makes sense to do that anyway, fade is more than just a \"change style\" operation).\nI wouldn't be in favour of \"just\" dropping the setting of visibility in fade, expecting problems if we do. We should first investigate if we want to do such a breaking change. #2074 and #2081 provide more context.\n. That's a good catch. Browser.ie is only set in compat mode. It should either check Browser.name or just detect whether document.documentMode is set, before settings Browser.version to its value.\n. Thanks for creating the issue. We'll discuss this (un)documentation issue for the next release. :-)\nRegarding your aside, the function is executed as a method of the element, therefore this inside your function is a reference to the element. The arguments are actually the arguments you pass to the function at call time.\nhtml\n<div class=\"thing\"></div>\n``` javascript\nElement.implement('test', function(e){\n    console.log(this, e);\n});\n$$('.thing').test('argument');\n```\nhttp://jsfiddle.net/B5JY3/1/\n. A big thing to be Promises/A+ compliant is to not let exceptions ruin your day (which in turn often actually ruins your day), even in the \"executor function\" (the function passed to new Promise). I think for now our focus should be to make a Request instance \"thenable\", and not so much care about full compliance (yet?). A big benefit is that we don't have to care about what Promise implementation is present.\nA thing to keep in mind for a \"thenable\" Request is that our Request instances can be sent/executed multiple times, while a \"thenable\" should not change state after it's resolved. To make it work at all, I expect we'll have to keep a pending/success/failed state and a stack of \"reactions\". To make the \"thenable\" not act erratically when a Request gets re-sent/re-executed, we'll probably have to call the reject handlers of the added reactions (assuming the previous sending/execution hasn't completed, since there should be no reactions left if it is) and reset the state to start \"clean\". When a Request instance is only used once, this problem doesn't exist.\nNote: a \"reaction\" here is a combination of arguments to the then function, e.g. requestInstance.then(onFulfilled, onRejected) -> reaction = {fulfillHandler: onFulfilled, rejectHandler: onRejected}. Since any reaction can only be executed once, it can be removed from the stack after one of its handlers is executed.\nTo use this, people would use stuff like requestInstance.send().then(onFulfill, onReject).\nIf people want to wrap things in an actual Promise (and thus have full compliance), it's simple enough to do so:\n``` javascript\nnew Promise(function(resolve, reject){\n    var request = new Request({\n        onSuccess: resolve,\n        onFailure: reject,\n        onTimeout: reject,\n        onCancel: reject,\n        onError: reject,\n        onException: reject\n    });\nrequest.send();\n\n});\n```\nTo make things easier for ourselves, we could decide to add new fulfill and reject events, which we can use internally to set the state to make then work, and other people could use to easier wrap things in an actual Promise should they wish to do so.\n. I just realised that adding fulfill and reject events to wrap thing in an actual Promise are a bit stupid since, if we implement a \"thenable\" interface, you could just use the Request instance's then method to achieve the same:\njavascript\nvar promise = new Promise(function(resolve, reject){\n    var request = new Request();\n    request.send().then(resolve, reject);\n});\n. Created a Class.Thenable mixin, which implements a subset of the actual Promise functionality. It's added as mixin to the Request class.\nA Class implementing Class.Thenable should be Promises/A+ compatible, that is to say its instances' then methods act accordingly. On top of that Class.Thenable implements value resolving compatible with ES6 draft Promises, which means then calls can be chained as they would be with Promises.\nDifferences from Promises include that this is (obviously) a Class mixin, the resolve and reject functions are Class methods, and the state is reset-able (which does first reject to avoid unexpected results).\n. Important to emphasize is that this is not a Promise implementation, it lacks one of the important characteristics of a Promise: the fact that a Promise cannot change its value after being resolved once. To keep a Class instance usable, this state used for the \"thenable\" behaviour can be reset.\nFor the way the mixin would be used, this should not be a problem (and actually make it easier/better to use). In other ways this could be implemented, it would have to rely on an actual Promise implementation, and store a Promise instance to have a then function work. This Promise instance would then have to be replaced if a new value is resolved (i.e. a Request is sent for a second time), making for a similar \"reset\" situation.\nAn actual Promise could be easily implemented using this, though. An example is in the Docs/Class/Class.Thenable.md part of the changes.\n. WTF is this?\n. It's a very simple POSIX Shell script that changes a version and build number in a few files, and tags.\nThis commit makes it and invalid Shell script (it'll error right away, probably be along the lines of Line 3: Syntax error: Unexpected \"(\"), makes it a huge mess and adds stuff that has nothing to do with the tagging (even requires a grunt script to be run first, or it'll complain).\nI also have no clue why this suddenly comes up, after the IRC channel being dead for days. Very confusing.\nEither way, this is not what we want. :-)\n. It seems Opera doesn't pass your added test.\n. The problem here is really only Internet Explorer, in which the first letter of the prefix should not uppercased, while other vendors stuck with the default replacing of '-[a-z]' with '[A-Z]' for the DOM API (granted, for Webkit browsers, both uppercase and lowercase first letters of the prefix work).\nEasiest way we can probably fix this, is to replace /^-ms-/ to 'ms-' before camelCasing.\nRemoving the camelCasing is not an option. It is there to make setting of both hyphened and camelCased style properties possible.\n\nRegarding your comment, using Element.prototype.set('style', ...) is not a very good idea, since it'll just set the style attribute of the Element, removing any other styles you may have set before. Your setStylesPrefixed function will leave you with only the last style it encounters actually set.\nIf you need a workaround right now, it's probably best to use what I mentioned above, or alternatively setting 'ms-transform' or 'msTransform' instead of '-ms-transform'.\n. Slight issue with your setStylePrefixed function, you do want the '-' before all other prefixes, other than ms.\nSo, taking your function as example, you'll probably want something like this:\njavascript\nsetStylePrefixed: function(property, value){\n    var prefixes = ['-webkit-', '-moz-', '-o-', 'ms-'];\n    for (var i = 0, l = prefixes.length; i < l; ++i){\n        this.setStyle(prefixes[i] + property, value);\n    }\n    return this.setStyle(property, value);\n}\n\nClosing issue as requested.\n. Actually, the problem itself isn't resolved, reopening:\n\nThe problem here is really only Internet Explorer, in which the first letter of the prefix should not uppercased, while other vendors stuck with the default replacing of '-[a-z]' with '[A-Z]' for the DOM API (granted, for Webkit browsers, both uppercase and lowercase first letters of the prefix work).\nEasiest way we can probably fix this, is to replace /^-ms-/ to 'ms-' before camelCasing.\n. That'll be because document.id(arg) uses arg.$family() (a MooTools internal API) to determine the type when it's available, which returns \"string\" for strings, and since you're extending String, that's inherited.\n\nI'm not sure if fixing this would cause any side effects, we should probably figure that out. To fix it, we'd probably have to set this.$family = null in the Class \"factory\".\nIf you need to get it working right now, I don't think there's a way around using the internal API yourself right now, which is obviously a workaround that can't be guaranteed to work indefinitely. Fortunately, it's rather simple, you'd have to just set add $family: null to your Class definition.\nAlternatively, you could test the actual fix I have in mind for this (again, untested and unverified):\ndiff\n--- a/Source/Class/Class.js\n+++ b/Source/Class/Class.js\n@@ -23,6 +23,7 @@ var Class = this.Class = new Type('Class', function(params){\n        reset(this);\n        if (newClass.$prototyping) return this;\n        this.$caller = null;\n+       this.$family = null;\n        var value = (this.initialize) ? this.initialize.apply(this, arguments) : this;\n        this.$caller = this.caller = null;\n        return value;\n. Much appreciated, glad it works. I'll ask other devs to have an opinion on the matter, in case it breaks something I haven't realised.\n. Very nice, thanks a lot for that!\nHowever, would it be possible to follow the code style as it is in the rest of the code and tests? That is mostly: indented with tabs, a different way of using whitespace around braces and parentheses, and as little abbreviations as necessary (for example just element instead of el).\nA quick overview is in the wiki:\nhttps://github.com/mootools/mootools-core/wiki/Syntax-and-Coding-Style-Conventions\n. Firstly, we already have this in More for events, called \"throttle\", which is the main use of this, I'd guess:\nhttps://github.com/mootools/mootools-more/blob/master/Source/Class/Events.Pseudos.js#L125\nRegarding the API, I don't think an object as argument is a good idea. I agree with Dimitar, all it'd need is a \"delay\". I don't quite understand what the \"early\" or \"once\" things should do.\n. Firstly, thanks for wanting to participate and trying to improve MooTools.\nHowever, you make it sound as if you think these things have never been discussed, considered or tried within MooTools or for MooTools Core specifically. The fact is, though, that MooTools Core has been a modular framework since before there was any (de-facto or otherwise) standard for modularisation in JavaScript. And later on, work was just never completed to actually support a standard that had arised since then. (See #2102).\nAfter that, you establish that extending natives is \"not a good pattern\", while you call it \"the nature of MooTools\", that is quite a conflict. It is indeed the nature of MooTools Core 1.x, and because it is its nature, it would be very awkward to change. It's fully understandable (and, I guess true) that the approach is not suitable for your projects designed according to currently accepted/popular principles, but that just means that MooTools Core 1.x is not suitable for these projects, which isn't weird for a project library developed in 2006. MooTools Core 1.x is a library of which the structure and design were developed in a time when the Javascript and browser landscapes were entirely different.\nAs has been said before, for a possible MooTools Core 2.x, this design would obviously be reconsidered (likely it would be an optional feature, for those who control their environment and would like these things globally present), and obviously one of the current standards for modularisation would be used. On top of that, a very big part of MooTools Core 1.x is no longer relevant (and hasn't been for a while), because of how JavaScript itself and the engines/browsers have developed.\nAll-in-all, in my opinion, if there is to be a MooTools Core 2.x, for it to be credible and reliable (or even relevant), it would have to be a complete revisit/rewrite. For MooTools Core 1.x, only the commonjs-style modularisation part could be relevant, but changing how natives are handled should not be part of that.\n. > Some tests are disabled with using xdescribe, for example https://github.com/timwienk/mootools-core/compare/spec-update-part-3...spec-update-part-4#diff-d7242700ac47efe4e538390355c32968R50\n\nIs that still valid, or was it disabled at some point and never enabled again?\n\nThe specs where there's now xdescribe, there used to be a xit, so yea, they were disabled and never re-enabled. I believe they're tests from our old spec engine with PHP stuff. [intended]\nI did just realise that if they were enabled, they'd fail now, because Mocha uses arguments to done as reasons a spec failed, while Jasmine has done.fail for that. [fixed]\n\nchai uses expect(..).to.be.true, where true is a keyword. iirc that doesn't work in IE8, and should be to.be['true']. Is that relevant? (https://github.com/chaijs/chai/issues/124#issuecomment-11639702)\n\nThat's a good point. I kind of assumed they made it work. The best workaround is probably to use replace to.be.true with to.equal(true). The same thing should be the case for to.be.false and to.be.null. Will look into that. [fixed]\nIt should be fine for to.be.undefined, however, for the sake of consistency, maybe we should replace those as well. [fixed]\n. > This is one of the reasons I initially used https://github.com/Automattic/expect.js (and kept using it since, I think chai wasn't really a thing then, the other choice was 'should.js').\nChai seems a very complete solution, including assert style assertions as well, which could benefit us in the future. However, if things don't work in IE older than 9, we should probably switch. Although I prefer some specific things Chai did with the expect syntax, the syntax of all expect style things are very similar anyway. [fixed]\n. After looking at things, they clearly state they don't support IE<9, so Chai is not an option. I replaced it with the library Arian suggested, expect.js. [fixed]\n. New issues encountered:\n- Specs fail in IE7, because Karma v0.13 does not work in IE7. [fixed]\n  - Reason: Karma v0.13 uses a newer version of socket.io that causes problems in IE7. Supposedly this is fixable by passing transports: ['polling'], forceJSONP: true to socket.io, but Karma doesn't allow for the forceJSONP option to be passed right now.\n  - Solution: downgrade back to v0.12.\n- Specs fail in IE>10, because Sinon v1.17 does not work in IE>10. [fixed]\n  - Reason: Things break in a very weird way when doing the IE-compat stuff from within a conditional on IE11 (and Edge).\n  - Solution: downgrade to v1.14, until sinonjs/sinon#848 is fixed.\n  - Alternative solution (in case it doesn't get fixed): we could change our environment to only load sinon-ie for old IE, this would be annoying when testing locally(/manually), since you need different karma-plugins for different envs.\n- Specs fail in IE9 and IE10, because no current version of syn works in IE9 and IE10. [fixed]\n  - Reason: The feature test for <a href=\"javascript:something()\" /> in IE9 and IE10 causes a page reload of which Karma doesn't approve.\n  - Solution: use a local version that does work (hopefully temporarily). I've described the issue in bitovi/syn#105.\nLatest test results:\nhttps://travis-ci.org/timwienk/mootools-core/builds/82323286\n. > @arian:\n\nAdd node_js 4 here as well?\nNever mind, it's already included in the other matrix.\n\nYes, what I changed in .travis.yml is: instead of adding the multiple node_js versions when building the matrix, only one is used for that, and the non-current versions are \"manually\" included after the matrix is built for only server testing. That way we don't have 75 runs of which 48 actually do nothing.\n\n@arian:\nHowever if you use version 4, will it automatically use the latest 4.x version? As they are using proper semver now, all 4.x versions should automatically work.\n\nThat's a good point, I'll change that and hopefully they indeed don't break within the major version. :-D [fixed]\nhttps://travis-ci.org/timwienk/mootools-core/builds/82406894\n. Okay, so everything seems to work. Now for the last two questions:\n1. Do we agree on switching to Mocha? What are the reasons not to?\n2. When we go and merge, shall I PR this:\n   - with everything in one PR,\n   - as 6 separate PRs; one per part,\n   - or two PRs; one for the first 5 parts, one for the mocha stuff?\n. There is no reason to explain how regular expressions work in general, I'm sure that anyone who wants to work or read regular expressions either knows what things like \\d mean or can find this information elsewhere, it's super basic information.\nHowever, more content related comments regarding regular expressions are very useful. What we've done in the past is add a comment explaining how to build the specific regular expression just above the \"compiled\" version of it, so it's easier to recreate and/or update and enhance.\nExample:\nhttps://github.com/mootools/mootools-more/blob/1.5.2/Source/Forms/Form.Validator.js#L473-L486\n`` javascript\n/*\nvar chars = \"[a-z0-9!#$%&'*+/=?^_{|}~-]\",\n    local = '(?:' + chars + '\\.?){0,63}' + chars,\nlabel = '[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?',\nhostname = '(?:' + label + '\\\\.)*' + label;\n\noctet = '(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)',\nipv4 = '\\\\[(?:' + octet + '\\\\.){3}' + octet + '\\\\]',\n\ndomain = '(?:' + hostname + '|' + ipv4 + ')';\n\nvar regex = new RegExp('^' + local + '@' + domain + '$', 'i');\n/\nvar regex = /^(?:[a-z0-9!#$%&'+\\/=?^_{|}~-]\\.?){0,63}[a-z0-9!#$%&'*+\\/=?^_{|}~-]@(?:(?:a-z0-9?.)*a-z0-9?|[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)])$/i;\n```\nI would not like to add \"<devComment>\" around it, there is no reason to. They're comments in the source code, so they're \"dev comments\" by default. Minified versions will strip them out anyway.\n. Thanks for the feedback and questions. Quite happy to see practical responses.\n@anutron, I agree with the question you put forward, I guess it's quite obvious I agree with @fakedarren's answer, otherwise I wouldn't have written the code, but it's a good thing to bring up. I think this implementation offers something new and very useful by not attempting to add \"yet another Promise implementation\", but instead offering a way to work with Promise implementations in a compliant manner and still working fine stand-alone.\nTo answer @arian I'll need a bit more text, because it gets a bit detailed, so brace yourselves (and blame @arian, he asked!):\n[TL;DR] I'm generally available on IRC if anyone prefers to discuss/ask there in case this text isn't clear or is too long to parse.\nYes, request.send() still returns itself. Classes and their instances work as they always have, nothing changed in that respect, and everything works as we expect the Classes to. What this code does is not actually implement Promises itself, it implements a mixin to make any instance of the Class itself Promises/A+ compliant (or to actually implement Promises if you want to, see the example in the description of the PR).\nThere is no rule (or reason for) saying that an arbitrary object cannot act the same way as a Promise, because its goal is to (quite literally) promise that a value will be resolved at some point. You can basically interpret new Request as the instantiation of very specific kind of Promise that goes to resolve its value by calling send. Another way to look at it is that a new Request keeps a Promise internally which you interact with, but the former seems more accurate.\nIf you do want an actual Promise to work with, you could do Promise.resolve(request) (or Promise.resolve(request.send()) if you feel that's nicer), which works because of part 2.3.3.3 of the spec: the Promise calls request.then and uses that to resolve itself (it basically adopts the request's state).\nThe usual (and even mandatory) thing is that calling then does not return itself and returns a new object that gets resolved with the value returned by the argument(s) you pass to then, which is indeed what it does.\nI do want to point out that referring to Class.Thenable as a Promise implementation is not technically correct, because of the exception I mentioned in the description of this PR, which is related but not the same as what you mention, @arian. As I mentioned, the case is not that send() should return a new Promise(-like) object, but it is the case that a Promise can only be used/resolved once. Because Class instances are often used more than once (e.g. multiple request.send or fx.start calls), this implementation makes the state resettable. Using the \"internal Promise\" analogue I used earlier: think of it as ditching the old Promise (rejecting it if it's not yet resolved) and taking on a new one. This way nothing is left unresolved, and it's similar to either doing a new send after things are done, or canceling the old send.\nThe only thing that does get interesting is using Class.Thenable style interaction together with Chain style interaction, these are two different ways of chaining actions. I noted this in the docs. (Probably a minor issue anyway, because of defaults and the unlikelihood of people using chain if they can use then. We could even consider adapting Chain to use Class.Thenable, but let's not get into that right now.)\n. What are the reasons we don't want to polyfill pointer events for older browsers, at least its basic behaviour (I realise things like width, pressure and tilt are probably not doable, but I'd guess pointer events in general could work when fired through mouse and touch events)?\nOne of MooTools Core's main goals has been to abstract differences between browsers. I realise MooTools development is mostly maintenance and keeping it working with recent standards now, but if the features we add can be supported in all browsers we support, I think they should be (we would have in the past, in such a case).\nOther than that, the work that is done looks good (so definitely :+1: and :smiley: for that). But to merge into master (and thus be releasable), I'd like to either be convinced we indeed shouldn't polyfill basic pointers for older supported browsers, or otherwise see an effort towards basic support.\nAnother request, could you rebase your branch on top of the latest mootools/master? We've added a few things to the automated tests since your fork.\n. I'm not fussed about squashing, in most cases I actually don't like it, since you destroy history that might actually useful to be able to understand why/how a decision (or error) was made. I personally do amend stupid/syntax things onto the commit they fix up, but again, not really fussed. I believe the reason people like to squash is to have a shorter/cleaner history, for which one could just as well use git log --merges (in fact, if every change set is squashed after rebasing, why have merge commits at all).\n. Merged in 7300b1c.\nWith typo in commit message: I apparently missed the \"1\" key once while typing \"10.10\".\n. Having the presence of something specific depend on the whether an unspecified request is pending is quite weird from a technical design point of view. Instead, you should probably just listen for the right events to be emitted.\nIn case you do still want this kind of functionality, you can use the events emitted by the Request instances to create such a state variable.\nConsider the following:\njavascript\nvar Application = {\n    running: 0,\n    request: new Request({\n        onRequest: function(){\n            Application.running += 1;\n        },\n        onComplete: function(){\n            Application.running -= 1;\n        }\n    })\n};\n. It seems we agree, @arian.\nCombine the two answers and you get an application with a request factory:\njavascript\nvar Application = {\n    runningRequests: 0,\n    createRequest: function(options){\n        return new Request(options).addEvents({\n            request: function(){\n                Application.runningRequests += 1;\n            },\n            complete: function(){\n                Application.runningRequests -= 1;\n            }\n        });\n    })\n};\n. In your JSFiddle you the following error is thrown: TypeError: $(...).fireEvents is not a function.\nThe problem is indeed what Sandy just mentioned, you should use fireEvent, not \"fireEvent_s_\".\nI will close this issue. If you would like any other support, please ask on the mailing list:\nhttps://groups.google.com/forum/#!forum/mootools-users\n. That was a mistake, and it's fixed now.\nSomething went wrong with tagging the release, so we ended up creating the tag later. Apparently we didn't re-fetch the repository on the web server for it to know about the tag, and it got stuck on master, rather than retrying.\nThe commit master referred to was 1.6.0 + 1, so there is no actual functional difference, the only difference is the version number in the file: https://github.com/mootools/mootools-core/commit/2f0aee54c40525e4261b556bc6ed2a12a619db73\n. Thanks for reporting! :+1:\n. I'm not. The ESLint settings are for our source files, and we require all our source files to only have linefeeds as newline characters.\nWhat Grunt task are you getting errors from about CRLF newline characters? I don't remember the built files being ESLinted at all (and I don't really see why we would, if we do).\nWhat we could do, however, is set grunt.util.linefeed = '\\n'; in the Gruntfile.js. That should make Grunt use only linefeeds when building.\n. The steps you mentioned should indeed not be necessary, but I think I understand the issue now, so thanks for explaining.\nI assumed that you got the errors because the built file was ESLinted, which seemed awkward to me (since, like I mentioned, the built file should not be ESLinted at all). However, you just confirmed that the errors occur during the built itself.\nI'm fairly certain the problem is not with Grunt or ESLint, but with the way Git handles text files by default. Git's default setting of core.eol = native makes it so upon checkout text files are converted to use CRLF line endings in windows working directories, even if they use LF line endings in the repository. I'm sure this avoids a lot of problems when editing files, but it creates problems like these when enforcing consistency within files.\nSo, instead of changing the ESLint settings, we should change the way Git handles these files. There is a local way of doing this, using your local config, but instead I think we should add .gitattributes file to make sure it's done correctly everywhere.\nAdditionally, I think we should still add the grunt.util.linefeed = '\\n', so the built file won't have a mix of LF and CRLF line endings afte this change.\nI've just pushed ~~https://github.com/timwienk/mootools-core/commit/cba3825~~ https://github.com/timwienk/mootools-core/commit/70afaa8 to my own repository. Is it possible for you to test whether that fixes your issues?\nIf you're pulling the change to an existing clone of the repository, you will have to re-checkout the files after pulling the commit so the line ending change takes effect. From inside the repository, this should work:\n$ rm .git/index\n$ git reset --hard\nOr, in a normal Windows prompt:\n```\n\ndel .git\\index\ngit reset --hard\n```\n. > when you install msysgit it asks you specifically about line endings\n\nI see. I guess that question will set core.autocrlf accordingly.\nIn my commit I also set * text=auto in the .gitattributes file. That will make it so that (independent of the core.aotocrlf value) all files are checked out with CRLF line endings when core.crlf = crlf (or core.crlf = native on Windows). From your comment, Dimitar, that seems to not be a good idea.\nI've replaced my commit with https://github.com/timwienk/mootools-core/commit/70afaa8. That way it only changes behaviour for JavaScript files: they will always be checked out with LF line endings.\n. Since the changes I made aren't in actual functional code, I'm going to go ahead and push them to the master branch.\n@esr360, if you have time, it'd be great if you can let us know whether this solved your problems. If not, we can try and look further.\nDo remember that, when pulling to an existing clone of the repository in an environment that converts to CRLF, you will have to re-checkout the files after pulling the commit so the line ending change takes effect. From inside the repository, this should work:\n$ rm .git/index\n$ git reset --hard\nOr, in a normal Windows prompt:\n```\n\ndel .git\\index\ngit reset --hard\n```\n. Great, thanks for letting us know!\n. Indeed. Many problems like these are caused by using MooTools Core with compatibility additions while it is not necessary. You have to choose between compatibility with old MooTools or compliance with newer standards.\n\nSince this issue is rather old, I assume it has been solved by now, but just to be clear:\nDo not use MooTools libraries in compatibility mode when you do not need compatibility with old MooTools versions. Doing so is basically depriving yourself of newer JavaScript features.. > v1.5.2\nI think there is a mixup somewhere, Class.Thenable was introduced in 1.6.0. So if you're using 1.5.2, the Request.JSON classes won't inherit from the Class.Thenable mixin since it doesn't exist yet.\nCould you check again? Could it be that multiple versions are loaded and a race condition makes for the inconsistent behaviour?\nIn case it helps:\n- 1.6.0 docs\n- 1.5.2 docs\n. PhantomJS is at the top because it doesn't require an actual browser, which means for those tests it doesn't need to connect to Sauce Labs and it's faster to execute.\nThe order of the actual browsers is mostly just \"taste\" I guess, in the order from the one we hate the least to the one we hate the most, and versions from new to old.\nHowever, you could argue that it's in the order of least expected errors: if something errors in Chrome, Firefox or Edge, there's probably something seriously wrong and we'd see it quicker in this order, whereas the other browsers - especially old IE - sometimes fail for no reason (or even because launching or connecting to the browser fails), so we'd re-run those tests before agreeing that there's an actual error.. This is most likely caused by the fact that you're using MooTools Core with compatibility additions for older versions, you have to choose between compatibility with old MooTools or compliance with newer standards.\nBack when MooTools 1.3 was released, there was no native Event object, and MooTools defined its own. In 1.4 MooTools Core's Event object was renamed to DOMEvent.\nThe Native Event object is overwritten by the compatibility functionality, to make sure MooTools Core is compatible with version 1.3 in this case.\nIf you do not need compatibility with old MooTools versions, you should not use the \"compat\" version. You only need the \"compat\" version if your code is old and/or relies on old code.. Probably easier, you can download it on https://mootools.net/core, or you can build your own version with only what you need on https://mootools.net/core/builder.\nAdditionally, the CDN you used in your example also distributes the no-compat version:\n- https://cdnjs.cloudflare.com/ajax/libs/mootools/1.6.0/mootools-core.js\n- https://cdnjs.cloudflare.com/ajax/libs/mootools/1.6.0/mootools-core.min.js\nAnd so does Google:\n- https://ajax.googleapis.com/ajax/libs/mootools/1.6.0/mootools-nocompat.js\n- https://ajax.googleapis.com/ajax/libs/mootools/1.6.0/mootools-nocompat.min.js. There is no file/directory structure without compatibility additions. The compatibility additions are stripped in the packaging/building process.\nIf you want all source files separately with compatibility stripped, you'll have to do it yourself. You can do that manually, reconfigure (or even adapt) the packager to your needs, or you can try and see if it's doable with the currently available tools.\nPerhaps the Advanced Building and Testing part of the README can help.\nIt's not actually supported, though, and you'll probably be doing a bunch of manual things to get this done.",
    "anutron": "Specs coming in a pull on core-specs repo.\n. ++\nSeems like we could write a little script that does this for you. No?\n. I'm still not clear if this definition prescribes directory locations or if mootools-core is an alias that maps to some configured location. For exampe, in the code block above you reference mootools-core/Source/Class/Class - can I configure AMD to go look in /lib/core/Source/Class/Class for that file?\n. @cpojer @ibolmo @arian you guys might want to take a look at this and chime in.\n. He wants to be able to pass a pointer to the parent version of a function to as an argument to another method. Agreed, it's contrived. I'm inclined to say that it's ill-advised, but thought you guys might want to see it first.\n. I'm generally in agreement here. Closing pull.\n. The general contract with fireEvent is that you pass one thing and it's the argument to the function unless you pass an array, in which case the array's items are the arguments. If you had a class that took an element as an argument and at some point fired an event and passed that element as the argument to that event, you wouldn't expect a different behavior for that class if you happened to use it on a form.\n. I don't disagree - always using an array would be ideal. For the current implementation, this behavior with forms is counter indicated.\n. That's a fine assumption, but this is still a non-intuitive result. I'll drop it though.\n. This doesn't throw an error in your example. It just means that any classname passed to it has white space trimmed for it to check that it's not ONLY whitespace. addClass(' myClass ') just removes the whitespace and evaluates 'myClass' but it still passes the argument as given to the native method.\nI don't disagree that a stricter API would be more elegant, but see my response here (https://github.com/mootools/mootools-core/commit/bd6ac113600fa508017c29237cf03c36171e9603#commitcomment-4646961) on why that isn't really achievable here without both inconsistency AND a breaking change (that really isn't justified).\n. do what you want.\n. :rocket: \n. I would also be ok if this was in the compat layer for 1.4, but I still think a method to add multiple classes would be of use. addClasses etc. \nAlso, this code that Arian has here could be skipped if the passed string doesn't contain a space, which would speed things up considerably for single-class usage. It would basically add no penalty to do a string check before calling the method.\n. I wouldn\u2019t object to that.\nOn Wed, Nov 20, 2013 at 4:35 PM, Christoph Pojer\nnotifications@github.comwrote:\n\nI'm very opposed to adding an API that takes a list of space separated\nclasses. An addClasses API must take an array.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2543#issuecomment-28947779\n.\n. @arian @timwienk Thoughts on this?\n. I just ran specs for IE11 against current masters of core & more and the Element.Measure specs passed. I'm not sure if the specs covers the error state but it appears to. @amitdar and @YonmaN can you confirm that the current master of each solves the issues you're seeing?\n. ++ for Option 1.\n. Historically I've been Mr. No Breaking Changes and a strong advocate for not changing our api with every release (I hate typeOf instead of $type - that shit's arbitrary breakage). But in this case our main goal should be to avoid breaking bunches of stuff (so people don't upgrade because of a \"bad\" release) even if it means making an inconsistent API for the short term. We're already agreed on deprecating all the browser stuff so investing in api consistency makes little sense. The only reason that Browser.ie is being worked on is to provide compatibility in 1.5.1 and beyond. We need to fix it, yes, but fixing it here isn't making a stronger API; it's NOT breaking code out there in the wild.\n. I feel like this is a change for 1.5.1. We'll need to update -more to work without compatibility for this change to get released.\n. I don't know if this is our definition of a breaking change. If it's backwards compatible except for browsers we don't support, it's not breaking. It's just a bug fix.\n. Agreed.\n\nOn Fri, May 16, 2014 at 2:17 PM, Dimitar Christoff <notifications@github.com\n\nwrote:\nit's not up to me but this should not be in core. implementing this is\ntrivial to do via extending existing Events class and this is not something\nthat needs to be in core imo.\nhttp://jsfiddle.net/dimitar/Qfd3f/ for example, simple mute/unmute that\nrenames the event key and then moves it back. simple but it does the same\neffect w/o adding 2 more methods to every class's prototypes. if you extend\nEvents, EVERY single mootools user that has a class that implements it\nwill get disableEvent, enableEvent and $disabledEvents plus the extra\ntime to check if an event is disabled each time something fires. as such,\nit's not something that I would like to see in mootools, but it's not up to\nme.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2595#issuecomment-43380572\n.\n. Wait. Now package.yml has to know dependency order? The whole point of the YAML headers was to declare what depended on what.\n. :rocket: \n\nBTW, I think it's ok to push small doc fixes like this without a pull request.\n. :ship: \n. You might also check out the URI class in Mootools More. It provides a ton of functionality for managing stuff like this.\n. The URI class is just more overhead than Request needs. Including it just to use Request isn't necessary.\n. :ship: \n. I think I'm with @ibolmo here. It's not that your use case isn't valid, but it's somewhat extreme and I think the feature would have little use. But this is where MooTools shines; it's a framework that's extensible. There's nothing stopping you from solving this problem in your own way (and sharing it). I hope our lack of interest isn't a turn off to future suggestions from you. Clearly you're pushing the edges of the framework and that's a good place to look for ideas.\n. I want to re-iterate how much we do appreciate a pull request. Really. But part of evaluating a pull request is understanding the weight it adds to the framework. MooTools has been through a lot of iterations and one thing we've learned is to keep the API as clean as possible and the features as generic as possible. It makes it way easier to maintain the library version after version. Edge cases don't find their way into the library that easily unless they have some critical impact that affects a lot of users. It's very hard to predict how adding an argument to a method will limit us down the road when we need to provide backwards compatibility and whatnot.\nBut don't confuse this with a lack of appreciation. I've totally worked in environments where I don't have strict control over the DOM. But I'll re-iterate that there's clear ways for you to override the framework to add your own methods or even monkey-patch your own methods on top of MooTools'. I'm not unsympathetic and genuinely hop you'll send us more pull requests.\nOne way to save yourself a little time is to file a ticket with a proposed solution. If the team seems to like the idea, then write the code and send a pull. Do that a few times and we'll be begging you to join the dev team.\n. what's this? can you add a description?\n. I guess my only real comment here is if we want this integrated into core. That is to say whether or not this feature needs to be a requirement for Fx, Request, etc. I get it; you can't drop it in on its own (at least, not without something hacky like Class.Refactor), so if you want it in Fx/Request you have to put it here, but in some ways this adds bytes to the core library for functionality that maybe isn't primarily useful for most developers.\nI'll let others sound off on whether that's the case or not. The code itself looks fine to me. Just a matter of whether we want to add the bytes for this feature.\n. I think your description here Tim belongs in the blog post. Yes, it's\nfairly technical, but so is our audience (what's left of it).\nOn Fri, Oct 9, 2015 at 4:22 AM, Tim Wienk notifications@github.com wrote:\n\nThanks for the feedback and questions. Quite happy to see practical\nresponses.\n@anutron https://github.com/anutron, I agree with the question you put\nforward, I guess it's quite obvious I agree with @fakedarren\nhttps://github.com/fakedarren's answer, otherwise I wouldn't have\nwritten the code, but it's a good thing to bring up. I think this\nimplementation offers something new and very useful by not attempting to\nadd \"yet another Promise implementation\", but instead offering a way to\nwork with Promise implementations in a compliant manner and still\nworking fine stand-alone.\nTo answer @arian https://github.com/arian I'll need a bit more text,\nbecause it gets a bit detailed, so brace yourselves (and blame @arian\nhttps://github.com/arian, he asked!):\n[TL;DR] I'm generally available on IRC if anyone prefers to discuss/ask\nthere in case this text isn't clear or is too long to parse.\nYes, request.send() still returns itself. Classes and their instances\nwork as they always have, nothing changed in that respect, and everything\nworks as we expect the Classes to. What this code does is not actually\nimplement Promises itself, it implements a mixin to make any class\nPromises/A+ compliant (or to actually implement Promises if you want to,\nsee the example in the description of the PR).\nThere is no rule (or reason for) saying that an arbitrary object cannot\nact the same way as a Promise, because its goal is to (quite literally)\npromise that a value will be resolved at some point. You can basically\ninterpret new Request as the instantiation of very specific kind of\nPromise that goes to resolve its value by calling send. Another way to\nlook at it is that a new Request keeps a Promise internally which you\ninteract with, but the former seems more accurate.\nIf you do want an actual Promise to work with, you could do\nPromise.resolve(request) (or Promise.resolve(request.send()) if you feel\nthat's nicer), which works because of part 2.3.3.3 of the spec\nhttps://promisesaplus.com/#point-56: the Promise calls request.then and\nuses that to resolve itself (it basically adopts the request's state).\nThe usual (and even mandatory) thing is that calling then does not\nreturn itself and returns a new object that gets resolved with the value\nreturned by the argument(s) you pass to then, which is indeed what it\ndoes.\nI do want to point out that referring to Class.Thenable as a Promise\nimplementation is not technically correct, because of the exception I\nmentioned in the description of this PR, which is related but not the same\nas what you mention, @arian https://github.com/arian. As I mentioned,\nthe case is not that send() should return a new Promise(-like) object,\nbut it is the case that a Promise can only be used/resolved once.\nBecause Class instances are often used more than once (e.g. multiple\nrequest.send or fx.start calls), this implementation makes the state\nresettable. Using the \"internal Promise\" analogue I used earlier: think of\nit as ditching the old Promise (rejecting it if it's not yet resolved) and\ntaking on a new one. This way nothing is left unresolved, and it's similar\nto either doing a new send after things are done, or canceling the old\nsend.\nThe only thing that does get interesting is using Class.Thenable style\ninteraction together with Chain style interaction, these are two\ndifferent ways of chaining actions. I noted this in the docs. (Probably a\nminor issue anyway, because of defaults and the unlikelihood of people\nusing chain if they can use then. We could even consider adapting Chain\nto use Class.Thenable, but let's not get into that right now.)\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/pull/2743#issuecomment-146838222\n.\n. I still think we should alias all the other .from static methods on the other natives to use .convert and make .from deprecated (but still present) for everything but Array.\n\n/my 2 cents\nCode LGTM.\n. @arian  I think we should maintain backwards compat for users who need it whenever possible. I.e. if the user downloads the compat version Array.from is there. I'm not sure if that's what you're suggesting when you ask if we should add it. Looking at my own work, there are 11 instances in all my Behavior stuff. I can search and replace it to upgrade, that's fine, but my point is that it's not only used in Core.\n. Ah. I gotcha.\nHow complete is our ES6 polyfill currently? Is Array.from like, the only thing missing? Do we even profess to offer an ES6 shim? Those are easily found in stand alone projects, right? I think I'd vote no, unless this is the only thing we don't fill in.\n. LGTM. Ship it.\n. Sergio, why don't you go ahead and ship this to master? I don't think you need someone else to do it after the review is done...\n. I made that comment earlier. Don't disagree. I would only remove Array.from though; you could leave the old ones there and alias it to both .from and .convert, then just update the docs to refer to .convert.\n. Perfect. I'd do one last grep against the codebase for .from and, if there are no errant missed ones (I.e. I can't see that in the pull request) then just go ahead and push this to master, too. Good stuff.\n. Specs coming in a pull on core-specs repo.\n. ++\nSeems like we could write a little script that does this for you. No?\n. I'm still not clear if this definition prescribes directory locations or if mootools-core is an alias that maps to some configured location. For exampe, in the code block above you reference mootools-core/Source/Class/Class - can I configure AMD to go look in /lib/core/Source/Class/Class for that file?\n. @cpojer @ibolmo @arian you guys might want to take a look at this and chime in.\n. He wants to be able to pass a pointer to the parent version of a function to as an argument to another method. Agreed, it's contrived. I'm inclined to say that it's ill-advised, but thought you guys might want to see it first.\n. I'm generally in agreement here. Closing pull.\n. The general contract with fireEvent is that you pass one thing and it's the argument to the function unless you pass an array, in which case the array's items are the arguments. If you had a class that took an element as an argument and at some point fired an event and passed that element as the argument to that event, you wouldn't expect a different behavior for that class if you happened to use it on a form.\n. I don't disagree - always using an array would be ideal. For the current implementation, this behavior with forms is counter indicated.\n. That's a fine assumption, but this is still a non-intuitive result. I'll drop it though.\n. This doesn't throw an error in your example. It just means that any classname passed to it has white space trimmed for it to check that it's not ONLY whitespace. addClass(' myClass ') just removes the whitespace and evaluates 'myClass' but it still passes the argument as given to the native method.\nI don't disagree that a stricter API would be more elegant, but see my response here (https://github.com/mootools/mootools-core/commit/bd6ac113600fa508017c29237cf03c36171e9603#commitcomment-4646961) on why that isn't really achievable here without both inconsistency AND a breaking change (that really isn't justified).\n. do what you want.\n. :rocket: \n. I would also be ok if this was in the compat layer for 1.4, but I still think a method to add multiple classes would be of use. addClasses etc. \nAlso, this code that Arian has here could be skipped if the passed string doesn't contain a space, which would speed things up considerably for single-class usage. It would basically add no penalty to do a string check before calling the method.\n. I wouldn\u2019t object to that.\nOn Wed, Nov 20, 2013 at 4:35 PM, Christoph Pojer\nnotifications@github.comwrote:\n\nI'm very opposed to adding an API that takes a list of space separated\nclasses. An addClasses API must take an array.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2543#issuecomment-28947779\n.\n. @arian @timwienk Thoughts on this?\n. I just ran specs for IE11 against current masters of core & more and the Element.Measure specs passed. I'm not sure if the specs covers the error state but it appears to. @amitdar and @YonmaN can you confirm that the current master of each solves the issues you're seeing?\n. ++ for Option 1.\n. Historically I've been Mr. No Breaking Changes and a strong advocate for not changing our api with every release (I hate typeOf instead of $type - that shit's arbitrary breakage). But in this case our main goal should be to avoid breaking bunches of stuff (so people don't upgrade because of a \"bad\" release) even if it means making an inconsistent API for the short term. We're already agreed on deprecating all the browser stuff so investing in api consistency makes little sense. The only reason that Browser.ie is being worked on is to provide compatibility in 1.5.1 and beyond. We need to fix it, yes, but fixing it here isn't making a stronger API; it's NOT breaking code out there in the wild.\n. I feel like this is a change for 1.5.1. We'll need to update -more to work without compatibility for this change to get released.\n. I don't know if this is our definition of a breaking change. If it's backwards compatible except for browsers we don't support, it's not breaking. It's just a bug fix.\n. Agreed.\n\nOn Fri, May 16, 2014 at 2:17 PM, Dimitar Christoff <notifications@github.com\n\nwrote:\nit's not up to me but this should not be in core. implementing this is\ntrivial to do via extending existing Events class and this is not something\nthat needs to be in core imo.\nhttp://jsfiddle.net/dimitar/Qfd3f/ for example, simple mute/unmute that\nrenames the event key and then moves it back. simple but it does the same\neffect w/o adding 2 more methods to every class's prototypes. if you extend\nEvents, EVERY single mootools user that has a class that implements it\nwill get disableEvent, enableEvent and $disabledEvents plus the extra\ntime to check if an event is disabled each time something fires. as such,\nit's not something that I would like to see in mootools, but it's not up to\nme.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2595#issuecomment-43380572\n.\n. Wait. Now package.yml has to know dependency order? The whole point of the YAML headers was to declare what depended on what.\n. :rocket: \n\nBTW, I think it's ok to push small doc fixes like this without a pull request.\n. :ship: \n. You might also check out the URI class in Mootools More. It provides a ton of functionality for managing stuff like this.\n. The URI class is just more overhead than Request needs. Including it just to use Request isn't necessary.\n. :ship: \n. I think I'm with @ibolmo here. It's not that your use case isn't valid, but it's somewhat extreme and I think the feature would have little use. But this is where MooTools shines; it's a framework that's extensible. There's nothing stopping you from solving this problem in your own way (and sharing it). I hope our lack of interest isn't a turn off to future suggestions from you. Clearly you're pushing the edges of the framework and that's a good place to look for ideas.\n. I want to re-iterate how much we do appreciate a pull request. Really. But part of evaluating a pull request is understanding the weight it adds to the framework. MooTools has been through a lot of iterations and one thing we've learned is to keep the API as clean as possible and the features as generic as possible. It makes it way easier to maintain the library version after version. Edge cases don't find their way into the library that easily unless they have some critical impact that affects a lot of users. It's very hard to predict how adding an argument to a method will limit us down the road when we need to provide backwards compatibility and whatnot.\nBut don't confuse this with a lack of appreciation. I've totally worked in environments where I don't have strict control over the DOM. But I'll re-iterate that there's clear ways for you to override the framework to add your own methods or even monkey-patch your own methods on top of MooTools'. I'm not unsympathetic and genuinely hop you'll send us more pull requests.\nOne way to save yourself a little time is to file a ticket with a proposed solution. If the team seems to like the idea, then write the code and send a pull. Do that a few times and we'll be begging you to join the dev team.\n. what's this? can you add a description?\n. I guess my only real comment here is if we want this integrated into core. That is to say whether or not this feature needs to be a requirement for Fx, Request, etc. I get it; you can't drop it in on its own (at least, not without something hacky like Class.Refactor), so if you want it in Fx/Request you have to put it here, but in some ways this adds bytes to the core library for functionality that maybe isn't primarily useful for most developers.\nI'll let others sound off on whether that's the case or not. The code itself looks fine to me. Just a matter of whether we want to add the bytes for this feature.\n. I think your description here Tim belongs in the blog post. Yes, it's\nfairly technical, but so is our audience (what's left of it).\nOn Fri, Oct 9, 2015 at 4:22 AM, Tim Wienk notifications@github.com wrote:\n\nThanks for the feedback and questions. Quite happy to see practical\nresponses.\n@anutron https://github.com/anutron, I agree with the question you put\nforward, I guess it's quite obvious I agree with @fakedarren\nhttps://github.com/fakedarren's answer, otherwise I wouldn't have\nwritten the code, but it's a good thing to bring up. I think this\nimplementation offers something new and very useful by not attempting to\nadd \"yet another Promise implementation\", but instead offering a way to\nwork with Promise implementations in a compliant manner and still\nworking fine stand-alone.\nTo answer @arian https://github.com/arian I'll need a bit more text,\nbecause it gets a bit detailed, so brace yourselves (and blame @arian\nhttps://github.com/arian, he asked!):\n[TL;DR] I'm generally available on IRC if anyone prefers to discuss/ask\nthere in case this text isn't clear or is too long to parse.\nYes, request.send() still returns itself. Classes and their instances\nwork as they always have, nothing changed in that respect, and everything\nworks as we expect the Classes to. What this code does is not actually\nimplement Promises itself, it implements a mixin to make any class\nPromises/A+ compliant (or to actually implement Promises if you want to,\nsee the example in the description of the PR).\nThere is no rule (or reason for) saying that an arbitrary object cannot\nact the same way as a Promise, because its goal is to (quite literally)\npromise that a value will be resolved at some point. You can basically\ninterpret new Request as the instantiation of very specific kind of\nPromise that goes to resolve its value by calling send. Another way to\nlook at it is that a new Request keeps a Promise internally which you\ninteract with, but the former seems more accurate.\nIf you do want an actual Promise to work with, you could do\nPromise.resolve(request) (or Promise.resolve(request.send()) if you feel\nthat's nicer), which works because of part 2.3.3.3 of the spec\nhttps://promisesaplus.com/#point-56: the Promise calls request.then and\nuses that to resolve itself (it basically adopts the request's state).\nThe usual (and even mandatory) thing is that calling then does not\nreturn itself and returns a new object that gets resolved with the value\nreturned by the argument(s) you pass to then, which is indeed what it\ndoes.\nI do want to point out that referring to Class.Thenable as a Promise\nimplementation is not technically correct, because of the exception I\nmentioned in the description of this PR, which is related but not the same\nas what you mention, @arian https://github.com/arian. As I mentioned,\nthe case is not that send() should return a new Promise(-like) object,\nbut it is the case that a Promise can only be used/resolved once.\nBecause Class instances are often used more than once (e.g. multiple\nrequest.send or fx.start calls), this implementation makes the state\nresettable. Using the \"internal Promise\" analogue I used earlier: think of\nit as ditching the old Promise (rejecting it if it's not yet resolved) and\ntaking on a new one. This way nothing is left unresolved, and it's similar\nto either doing a new send after things are done, or canceling the old\nsend.\nThe only thing that does get interesting is using Class.Thenable style\ninteraction together with Chain style interaction, these are two\ndifferent ways of chaining actions. I noted this in the docs. (Probably a\nminor issue anyway, because of defaults and the unlikelihood of people\nusing chain if they can use then. We could even consider adapting Chain\nto use Class.Thenable, but let's not get into that right now.)\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/pull/2743#issuecomment-146838222\n.\n. I still think we should alias all the other .from static methods on the other natives to use .convert and make .from deprecated (but still present) for everything but Array.\n\n/my 2 cents\nCode LGTM.\n. @arian  I think we should maintain backwards compat for users who need it whenever possible. I.e. if the user downloads the compat version Array.from is there. I'm not sure if that's what you're suggesting when you ask if we should add it. Looking at my own work, there are 11 instances in all my Behavior stuff. I can search and replace it to upgrade, that's fine, but my point is that it's not only used in Core.\n. Ah. I gotcha.\nHow complete is our ES6 polyfill currently? Is Array.from like, the only thing missing? Do we even profess to offer an ES6 shim? Those are easily found in stand alone projects, right? I think I'd vote no, unless this is the only thing we don't fill in.\n. LGTM. Ship it.\n. Sergio, why don't you go ahead and ship this to master? I don't think you need someone else to do it after the review is done...\n. I made that comment earlier. Don't disagree. I would only remove Array.from though; you could leave the old ones there and alias it to both .from and .convert, then just update the docs to refer to .convert.\n. Perfect. I'd do one last grep against the codebase for .from and, if there are no errant missed ones (I.e. I can't see that in the pull request) then just go ahead and push this to master, too. Good stuff.\n. ",
    "Inviz": "the getLast/getFirst was broken on element collections, because getLast would return last element in collection and getFirst would return collection of the first nodes. Maybe changing the name will resolve this.\n. While we're there, does Slick.match(new Element('input[disabled]'), 'input[disabled]') still return false? Boolean (empty) attributes did not call setAttribute, and Slick doesnt read the property\n. @arian Even if your example does not create element with mootools, i checked it myself now, and it works with the edge mootools. I guess, i just need to update. Thanks anyways!\n. /me likes\n. I like the stuff, but keep in mind, it's unsafe to change \"Accept\" headers, as there are plenty of web resources (e.g. everything built on rails) that use content type negotiation and the change would make it recieve a json response to plain request by default.\nPersonally, i prefer the same stuff, json over html. But the application has to be tuned to do it. Putting this kind of incompatability in defaults is dangerous and will create problems\n. And yeah, those code comments were better on github, not in source code. but that's just my opinion.\n. I thought IE < 8 never allowed changing of type attribute once it was once set. So you have to create a new element.\n. the getLast/getFirst was broken on element collections, because getLast would return last element in collection and getFirst would return collection of the first nodes. Maybe changing the name will resolve this.\n. While we're there, does Slick.match(new Element('input[disabled]'), 'input[disabled]') still return false? Boolean (empty) attributes did not call setAttribute, and Slick doesnt read the property\n. @arian Even if your example does not create element with mootools, i checked it myself now, and it works with the edge mootools. I guess, i just need to update. Thanks anyways!\n. /me likes\n. I like the stuff, but keep in mind, it's unsafe to change \"Accept\" headers, as there are plenty of web resources (e.g. everything built on rails) that use content type negotiation and the change would make it recieve a json response to plain request by default.\nPersonally, i prefer the same stuff, json over html. But the application has to be tuned to do it. Putting this kind of incompatability in defaults is dangerous and will create problems\n. And yeah, those code comments were better on github, not in source code. but that's just my opinion.\n. I thought IE < 8 never allowed changing of type attribute once it was once set. So you have to create a new element.\n. ",
    "restlessdesign": "Yep! We have a large 1.3 upgrade underway, but in the meantime, we had several thousands of users who needed this fix :)\n. Confirmed!\n. Yep! We have a large 1.3 upgrade underway, but in the meantime, we had several thousands of users who needed this fix :)\n. Confirmed!\n. ",
    "ADarkDividedGem": "Sorry this shouldn't have been a pull request as the code changes I am suggesting will break code else where.\n. Sorry this shouldn't have been a pull request as the code changes I am suggesting will break code else where.\n. ",
    "pierskarsenbarg": "Just come across this. What the OP was saying was that if you just run mootools 1.3 (and in fact only this file) in IE 7 or 8, you get the error that he stated above. \nTherefore you can't run anything in JSFiddle as it's not anything that's been built on mootools 1.3, it's mootools itself.\n. Just come across this. What the OP was saying was that if you just run mootools 1.3 (and in fact only this file) in IE 7 or 8, you get the error that he stated above. \nTherefore you can't run anything in JSFiddle as it's not anything that's been built on mootools 1.3, it's mootools itself.\n. ",
    "kaelzhang": "@arian: Thanks for your reply. I thought your PS got what i exactly wanna say :p .  It takes a bit to use nocash argument, you know, which may cause frequent execution of Object.append.\nAnd the most important thing, the usage of document.id is unpredictable. I don't know if I will implement a new method later, and a single page may have many people cooperated in.\n@rpflorence: Mootools 2.0, emmm, sounds nice! \nIn my project, I make some encapsulation on $, just as the $ of jQuery and the DOM of YUI do. It's worth mentioning that it is really awesome of Type, working it out with only a few lines of code.\nIs the dev of mootools 2.0 already started? Any previews available?\n. @arian: Thanks for your reply. I thought your PS got what i exactly wanna say :p .  It takes a bit to use nocash argument, you know, which may cause frequent execution of Object.append.\nAnd the most important thing, the usage of document.id is unpredictable. I don't know if I will implement a new method later, and a single page may have many people cooperated in.\n@rpflorence: Mootools 2.0, emmm, sounds nice! \nIn my project, I make some encapsulation on $, just as the $ of jQuery and the DOM of YUI do. It's worth mentioning that it is really awesome of Type, working it out with only a few lines of code.\nIs the dev of mootools 2.0 already started? Any previews available?\n. ",
    "GCheung55": "Test: http://jsfiddle.net/garrickcheung/88fEB/2/\n. Reference of keycodes: http://unixpapa.com/js/key.html\n. It's possible to add the additional keys to Event.Keys. I haven't checked with MooTools-More Keyboard.JS has done so though..\nSent from my iPhone\nOn Aug 11, 2011, at 7:19 AM, ibolmoreply@reply.github.com wrote:\n\nHrm. My predicament is that while I tested the jsfiddle against 1.3.2 compat I noticed that the following keys did not show up in the key correctly:\n-=[]\\;',./`\nctrl\nalt\nwin\nshift+nums\nYour changes, though, did fix the num key pad. So I think I will merge, but our solution seems to miss a lot of keys.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2002#issuecomment-1782158\n. Modified specs for spacing issues and wrapping everything in a describe('Elements'): https://github.com/GCheung55/mootools-core-specs/commit/b35e84f347d6796111bcc8c7c8f29cb328d2d5d5\n. The problem is that the other browsers will return false even if the attribute is there. Since MooTools supports cross-browser, then this is an issue.\n. @Xunnamius: I'm going to attempt to replicate the $family issue.\n\nCould you tell me about your current setup?\n. The developer should be made aware of any issues behind Object.set.\nWhat if its possible to.. \"lock\" what can be set? For example, Object.set(something, 'name.last', 'Wilson'); locks name in as an object and it can only be replaced as such? Out of scope?\n. I think this has been fixed.\nHere's a fiddle with the same setup: http://jsfiddle.net/Beaf6/\nI copied the Function.bind from MooTools 1.4.5 Source.\n. I was hunting this one down. I've only narrowed it down to the Fx.CSS.Parsers.\nhttps://github.com/mootools/mootools-core/blob/master/Source/Fx/Fx.CSS.js#L111\n. I tested the issue in IE9 and got the following error: \"DOM Exception: HIERARCHY_REQUEST_ERR (3)\"\nIt's more of an issue when creating a new element with new Element than it is the inject method.\nThe jsfiddle was from someone else who had the same problem. Seems that IE doesn't allow injecting elements created in another window. Which means the element has to be created in window.opener's scope.\nAnyways, I had issue when doing new window.opener.Element('div') because IE gave me the following error: \"Invalid procedure call or argument\". I haven't dug into what could be producing this error yet.\nI tested this by having two windows, one parent, one child, on the same domain: http://fiddle.jshell.net/QUM5g/7/show/\nThe jsfiddle will open a child window where you can open developer tools to plugin the following code, which seems to work:\n``` javascript\nvar win = window.opener;\nvar p = win.$(win.document.createElement('p'));\np.set('text', 'hello');\np.inject($(win.document.body),'top')\n```\n. The reason is because they are synchronous, right? Should we consider making them asynchronous?\n\nOn Nov 10, 2014, at 9:39 PM, Olmo Maldonado notifications@github.com wrote:\n@arian is this something with should bother with? or let the devs deal with the exception handling. I'm leaning on the latter.\n\u2014\nReply to this email directly or view it on GitHub.\n. Just thinking ahead, would that also preserve when compressed with Uglifyjs and Closure?\n. I believe this is invalid.\n\nhttp://jsfiddle.net/garrickcheung/jJDpK/3/\nThe chained function after the first animation doesn't call this.callChain() in order to execute the wait method.\n. Data attributes are expandos in an elements dataset attribute for HTML5, so we don't need to check the HTML for it in newer browsers.\nI wrote something for mootools-htmlx that should be compliant with older browsers:\nhttps://github.com/GCheung55/mootools-htmlx/blob/master/Source/Elements/Elements.Dataset.js\n. Lets test this.\nMooTools 1.4.5:\nThe fiddle: http://jsfiddle.net/garrickcheung/fxmUk/2/\nThe page: http://fiddle.jshell.net/garrickcheung/fxmUk/2/show/\nMooTools Edge\nThe fiddle: http://jsfiddle.net/garrickcheung/HsvBW/\nThe page: http://fiddle.jshell.net/garrickcheung/HsvBW/show/\nMooTools Edge - Empty document.body first\nThe fiddle: http://jsfiddle.net/garrickcheung/HsvBW/1/\nThe page: http://fiddle.jshell.net/garrickcheung/HsvBW/1/show/\n. As far as I can tell, the IE5-7 opacity filter is overriding inline style.\n. Ok. Found a solution. It's a combination of using the right CSS rules for opacity and seems that the filter style needs to be re-set doing box.setStyle('filter', ';');\nI tested http://jsfiddle.net/7d3KZ/6/ in IE 7 and 8 standalone.\n. With Chrome, adding position:relative to td alleviates the issue.\n. @arian Right. I think it shouldn't be aggressively enforcing 'use strict' either. But there will be cases like this, where a concat'd file has 'use strict' somewhere at the top.. and issues will occur.\nThe more interesting thing is that 'use strict' is inside cajon's function block scope. It shouldn't affect eval's scope.. should it?\n@cpojer Could you comment why adding .call(this) was reverted? What would be a better fix?\n. @kentaromiura 10 days is a long time to download the IE6 VM.. XD\n. @kentaromiura I use Unarchiver to extract the exe from Microsoft. \n. Your example shows that you have two show event handlers attached div elements and document.body element.\nIn order to trigger the show delegated event on the document.body you must fire the event on the object, and pass it the correct arguments. Here's the example working with delegated events: http://jsfiddle.net/z2LqR/2/\nAs you can see, the event object from anchors click event (not delegated) and the div element is passed as arguments to fireEvent method of the document.body. I hope this helps.\nIf this works, please close the ticket.\n. Do we have a test/specs for this? Or do we need one, @arian?\n. @dez87 Can you update your repo to include uncommenting the IE11v2 test?\nhttps://github.com/mootools/mootools-core/blob/master/Specs/1.5client/Browser/Browser.js#L62-L70\nRun the tests with preset=core-1.5 to confirm it works. :)\n. So the plan is to run tests on one browser at a time? I don't know if it's a valid concern, but I'm concerned with how fast things would run. I understand that the matrix allows things to be run in parallel.\nAlso note, we're SauceLabs allowed 10 concurrent browsers. So how many parallel Travis envs run at a time? If it's past 10, then that's definitely not good because those tests on that Travis env could fail.\n. Right. Constructor is not excluded in the loop: https://github.com/mootools/mootools-core/blob/master/Source/Class/Class.Extras.js#L112\n. According to https://github.com/mootools/mootools-core/blob/master/Source/Utilities/Cookie.js#L25 and the Cookie Docs, the path can already be optionally set to whatever you want.\n. In order to properly investigate this issue, the assumed bug needs to be reproducible. \nIs there a gist or a page you can create that would reproduce this issue?\nWere there any JS errors?\n. It's not actually broken. Try printing out:\njavascript\nconsole.log(this.config.paris);\nThis is happening because Class copies each property into a brand new prototype and inherits from it. That's why this.config.hasOwnProperty('paris') would return false, and yet looking up the property will return the value.\n@SergioCrisostomo has pointed me to reference https://github.com/mootools/mootools-core/blob/master/Source/Class/Class.js#L53-L55 as the culprit.\nIt's more about a difference in implementation of console.log.\n. @nbish11 Thank you for the contribution! Could you also add some tests as well? It will help the code base be more reliable with your changes.\nHere is an example for writing tests. Please check out the Spec folder as well.\n. Test: http://jsfiddle.net/garrickcheung/88fEB/2/\n. Reference of keycodes: http://unixpapa.com/js/key.html\n. It's possible to add the additional keys to Event.Keys. I haven't checked with MooTools-More Keyboard.JS has done so though..\nSent from my iPhone\nOn Aug 11, 2011, at 7:19 AM, ibolmoreply@reply.github.com wrote:\n\nHrm. My predicament is that while I tested the jsfiddle against 1.3.2 compat I noticed that the following keys did not show up in the key correctly:\n-=[]\\;',./`\nctrl\nalt\nwin\nshift+nums\nYour changes, though, did fix the num key pad. So I think I will merge, but our solution seems to miss a lot of keys.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/pull/2002#issuecomment-1782158\n. Modified specs for spacing issues and wrapping everything in a describe('Elements'): https://github.com/GCheung55/mootools-core-specs/commit/b35e84f347d6796111bcc8c7c8f29cb328d2d5d5\n. The problem is that the other browsers will return false even if the attribute is there. Since MooTools supports cross-browser, then this is an issue.\n. @Xunnamius: I'm going to attempt to replicate the $family issue.\n\nCould you tell me about your current setup?\n. The developer should be made aware of any issues behind Object.set.\nWhat if its possible to.. \"lock\" what can be set? For example, Object.set(something, 'name.last', 'Wilson'); locks name in as an object and it can only be replaced as such? Out of scope?\n. I think this has been fixed.\nHere's a fiddle with the same setup: http://jsfiddle.net/Beaf6/\nI copied the Function.bind from MooTools 1.4.5 Source.\n. I was hunting this one down. I've only narrowed it down to the Fx.CSS.Parsers.\nhttps://github.com/mootools/mootools-core/blob/master/Source/Fx/Fx.CSS.js#L111\n. I tested the issue in IE9 and got the following error: \"DOM Exception: HIERARCHY_REQUEST_ERR (3)\"\nIt's more of an issue when creating a new element with new Element than it is the inject method.\nThe jsfiddle was from someone else who had the same problem. Seems that IE doesn't allow injecting elements created in another window. Which means the element has to be created in window.opener's scope.\nAnyways, I had issue when doing new window.opener.Element('div') because IE gave me the following error: \"Invalid procedure call or argument\". I haven't dug into what could be producing this error yet.\nI tested this by having two windows, one parent, one child, on the same domain: http://fiddle.jshell.net/QUM5g/7/show/\nThe jsfiddle will open a child window where you can open developer tools to plugin the following code, which seems to work:\n``` javascript\nvar win = window.opener;\nvar p = win.$(win.document.createElement('p'));\np.set('text', 'hello');\np.inject($(win.document.body),'top')\n```\n. The reason is because they are synchronous, right? Should we consider making them asynchronous?\n\nOn Nov 10, 2014, at 9:39 PM, Olmo Maldonado notifications@github.com wrote:\n@arian is this something with should bother with? or let the devs deal with the exception handling. I'm leaning on the latter.\n\u2014\nReply to this email directly or view it on GitHub.\n. Just thinking ahead, would that also preserve when compressed with Uglifyjs and Closure?\n. I believe this is invalid.\n\nhttp://jsfiddle.net/garrickcheung/jJDpK/3/\nThe chained function after the first animation doesn't call this.callChain() in order to execute the wait method.\n. Data attributes are expandos in an elements dataset attribute for HTML5, so we don't need to check the HTML for it in newer browsers.\nI wrote something for mootools-htmlx that should be compliant with older browsers:\nhttps://github.com/GCheung55/mootools-htmlx/blob/master/Source/Elements/Elements.Dataset.js\n. Lets test this.\nMooTools 1.4.5:\nThe fiddle: http://jsfiddle.net/garrickcheung/fxmUk/2/\nThe page: http://fiddle.jshell.net/garrickcheung/fxmUk/2/show/\nMooTools Edge\nThe fiddle: http://jsfiddle.net/garrickcheung/HsvBW/\nThe page: http://fiddle.jshell.net/garrickcheung/HsvBW/show/\nMooTools Edge - Empty document.body first\nThe fiddle: http://jsfiddle.net/garrickcheung/HsvBW/1/\nThe page: http://fiddle.jshell.net/garrickcheung/HsvBW/1/show/\n. As far as I can tell, the IE5-7 opacity filter is overriding inline style.\n. Ok. Found a solution. It's a combination of using the right CSS rules for opacity and seems that the filter style needs to be re-set doing box.setStyle('filter', ';');\nI tested http://jsfiddle.net/7d3KZ/6/ in IE 7 and 8 standalone.\n. With Chrome, adding position:relative to td alleviates the issue.\n. @arian Right. I think it shouldn't be aggressively enforcing 'use strict' either. But there will be cases like this, where a concat'd file has 'use strict' somewhere at the top.. and issues will occur.\nThe more interesting thing is that 'use strict' is inside cajon's function block scope. It shouldn't affect eval's scope.. should it?\n@cpojer Could you comment why adding .call(this) was reverted? What would be a better fix?\n. @kentaromiura 10 days is a long time to download the IE6 VM.. XD\n. @kentaromiura I use Unarchiver to extract the exe from Microsoft. \n. Your example shows that you have two show event handlers attached div elements and document.body element.\nIn order to trigger the show delegated event on the document.body you must fire the event on the object, and pass it the correct arguments. Here's the example working with delegated events: http://jsfiddle.net/z2LqR/2/\nAs you can see, the event object from anchors click event (not delegated) and the div element is passed as arguments to fireEvent method of the document.body. I hope this helps.\nIf this works, please close the ticket.\n. Do we have a test/specs for this? Or do we need one, @arian?\n. @dez87 Can you update your repo to include uncommenting the IE11v2 test?\nhttps://github.com/mootools/mootools-core/blob/master/Specs/1.5client/Browser/Browser.js#L62-L70\nRun the tests with preset=core-1.5 to confirm it works. :)\n. So the plan is to run tests on one browser at a time? I don't know if it's a valid concern, but I'm concerned with how fast things would run. I understand that the matrix allows things to be run in parallel.\nAlso note, we're SauceLabs allowed 10 concurrent browsers. So how many parallel Travis envs run at a time? If it's past 10, then that's definitely not good because those tests on that Travis env could fail.\n. Right. Constructor is not excluded in the loop: https://github.com/mootools/mootools-core/blob/master/Source/Class/Class.Extras.js#L112\n. According to https://github.com/mootools/mootools-core/blob/master/Source/Utilities/Cookie.js#L25 and the Cookie Docs, the path can already be optionally set to whatever you want.\n. In order to properly investigate this issue, the assumed bug needs to be reproducible. \nIs there a gist or a page you can create that would reproduce this issue?\nWere there any JS errors?\n. It's not actually broken. Try printing out:\njavascript\nconsole.log(this.config.paris);\nThis is happening because Class copies each property into a brand new prototype and inherits from it. That's why this.config.hasOwnProperty('paris') would return false, and yet looking up the property will return the value.\n@SergioCrisostomo has pointed me to reference https://github.com/mootools/mootools-core/blob/master/Source/Class/Class.js#L53-L55 as the culprit.\nIt's more about a difference in implementation of console.log.\n. @nbish11 Thank you for the contribution! Could you also add some tests as well? It will help the code base be more reliable with your changes.\nHere is an example for writing tests. Please check out the Spec folder as well.\n. ",
    "simonklb": "For example <form action></form> sends you to http://domain.com/null while <form action=\"\"></form> sends you to the same page.\n. For example <form action></form> sends you to http://domain.com/null while <form action=\"\"></form> sends you to the same page.\n. ",
    "adamnbowen": "okay, I'll make the modification to the documentation tomorrow.\n. By \"tomorrow\", I apparently meant \"15 minutes from now\".  I've made the documentation change.\n@cpojer --just as a note, the code you wrote is incorrect --an iPad will still see Browser.Plugins.Flash as truthy, so you must do\nif (Browser.Plugins.Flash.version !== 0) {\n    alert('Flash is installed');\n}\n. alas, the client still needed SlideShowPro (and therefore Flash)... Should probably just use its xml file from now on and serve that business with javascript.\n. okay, I'll make the modification to the documentation tomorrow.\n. By \"tomorrow\", I apparently meant \"15 minutes from now\".  I've made the documentation change.\n@cpojer --just as a note, the code you wrote is incorrect --an iPad will still see Browser.Plugins.Flash as truthy, so you must do\nif (Browser.Plugins.Flash.version !== 0) {\n    alert('Flash is installed');\n}\n. alas, the client still needed SlideShowPro (and therefore Flash)... Should probably just use its xml file from now on and serve that business with javascript.\n. ",
    "oskarkrawczyk": "You can actually notice these slowdowns in the accordion one the left - http://jsfiddle.net\n. We're noticing this on Chrome 13.0.782.107 (stable), OS X (10.6)\nPretty crappy if this is an OS specific issue.\n. Not really using box-shadow anywhere in JsFiddle, yet the animation is awfully jumpy.\nActually, this release of Chrome is full of bugs, specifically with css animations/transforms.\nI guess this issue can be closed since it's not a MooTools bug... Then again, if they don't fix this until the next release, perhaps it's a good moment to start thinking about a workaround, or the next phase of Fx (I assume that would be this little thing called CSS Animations).\n. Christoph, instead of being all you towards my person (yes, I'm aware you're not very fond of me), please read my last comment.\nI'm not blaming the library, I'm pointing out that there's AN issue - you (core developers) should be aware of those. It doesn't matter if I post it here or on the dev list, as long as it's noticed by you guys.\n. As far as I'm all for embracing CSS Transitions, if anything, this should be an integrated part of the Fx class, so no *.CSS3.\nPerhaps, try pushing it into -more, rather than -core. If people are happy with it, perhaps it could make its way into 2.0-core\n. @fabiomcosta, in fact, there is a bug in JsFiddle (under IE8) after the latest update. We'll fix it soon.\n. Element.tween('opacity', 1) should not set any additional properties \u2013 this was an intentional change.\nElement.fade(1) on the other hand, should.\n. @jlind, @olvlvl, Again, as already stated in the comments above, setStyle/tween should only alter a single property, that is opacity, and it makes perfect sense (if a user is unable to click something, because there's a invisible element on top, it's because you've coded it wrong).\nThat said, shortcuts like fade, should additionally set the visibility property.\n. I think I wasn't clear enough. Say we have this el.addEvent('click:relay(a)', fn);, now when I'd like to fire the click event for a single a, I'd do the following a[0].fireEvent('click');. Obviously this wouldn't work since there's no click attached.\nPerhaps, I should have asked on the mailing list, but is there even a way of \"back triggering\" a single relay from the container, in our case el?\n. Thanks for the clarification.\nShould I re-add this ticket under Milk, or is it still too soon?\n. Docs are wrong, it should be: $('Darth_Vader').contains($('Luke'));\nhttp://jsfiddle.net/z4HBx/\n. Shouldn't the docs provide examples for the non-compat version?\n. Done.\n. Finally ...\n. Come on, the only reason to use builder for Core was to exclude Swiff - this is what I've been doing for the past years.\n. Anyone from the core team care to share a patch before it hits the official release?\nThis is really messing with my zen...\n. @timwienk @arian any chance you guys could pull this in? This warning has been bugging me and many JSFiddle users for way too long :-)\n. @SergioCrisostomo You're right, I was on 1.5.1 and incorrectly assumed the issue is still there in 1.5.2.\nLet's close this.\n. You can actually notice these slowdowns in the accordion one the left - http://jsfiddle.net\n. We're noticing this on Chrome 13.0.782.107 (stable), OS X (10.6)\nPretty crappy if this is an OS specific issue.\n. Not really using box-shadow anywhere in JsFiddle, yet the animation is awfully jumpy.\nActually, this release of Chrome is full of bugs, specifically with css animations/transforms.\nI guess this issue can be closed since it's not a MooTools bug... Then again, if they don't fix this until the next release, perhaps it's a good moment to start thinking about a workaround, or the next phase of Fx (I assume that would be this little thing called CSS Animations).\n. Christoph, instead of being all you towards my person (yes, I'm aware you're not very fond of me), please read my last comment.\nI'm not blaming the library, I'm pointing out that there's AN issue - you (core developers) should be aware of those. It doesn't matter if I post it here or on the dev list, as long as it's noticed by you guys.\n. As far as I'm all for embracing CSS Transitions, if anything, this should be an integrated part of the Fx class, so no *.CSS3.\nPerhaps, try pushing it into -more, rather than -core. If people are happy with it, perhaps it could make its way into 2.0-core\n. @fabiomcosta, in fact, there is a bug in JsFiddle (under IE8) after the latest update. We'll fix it soon.\n. Element.tween('opacity', 1) should not set any additional properties \u2013 this was an intentional change.\nElement.fade(1) on the other hand, should.\n. @jlind, @olvlvl, Again, as already stated in the comments above, setStyle/tween should only alter a single property, that is opacity, and it makes perfect sense (if a user is unable to click something, because there's a invisible element on top, it's because you've coded it wrong).\nThat said, shortcuts like fade, should additionally set the visibility property.\n. I think I wasn't clear enough. Say we have this el.addEvent('click:relay(a)', fn);, now when I'd like to fire the click event for a single a, I'd do the following a[0].fireEvent('click');. Obviously this wouldn't work since there's no click attached.\nPerhaps, I should have asked on the mailing list, but is there even a way of \"back triggering\" a single relay from the container, in our case el?\n. Thanks for the clarification.\nShould I re-add this ticket under Milk, or is it still too soon?\n. Docs are wrong, it should be: $('Darth_Vader').contains($('Luke'));\nhttp://jsfiddle.net/z4HBx/\n. Shouldn't the docs provide examples for the non-compat version?\n. Done.\n. Finally ...\n. Come on, the only reason to use builder for Core was to exclude Swiff - this is what I've been doing for the past years.\n. Anyone from the core team care to share a patch before it hits the official release?\nThis is really messing with my zen...\n. @timwienk @arian any chance you guys could pull this in? This warning has been bugging me and many JSFiddle users for way too long :-)\n. @SergioCrisostomo You're right, I was on 1.5.1 and incorrectly assumed the issue is still there in 1.5.2.\nLet's close this.\n. ",
    "jonnsl": "it is not an OS specific issue, is a webkit issue https://bugs.webkit.org/show_bug.cgi?id=22102 ,the bug tracker says that this bug is related to Macintosh Mac OS X 10.5 but it is also reallys slow on ubuntu and on windows\n. it is not an OS specific issue, is a webkit issue https://bugs.webkit.org/show_bug.cgi?id=22102 ,the bug tracker says that this bug is related to Macintosh Mac OS X 10.5 but it is also reallys slow on ubuntu and on windows\n. ",
    "allochi": "Hi again,\nI built one, how do I share with Mootools team to see if it can be accepted in More?\n. Thanks, I will organize my code and examples and post them for discussions.\nWhat I have is more than extending substitute, I have a class that extract HTML from the page or take an element constructed with new Element(), and use it as a template, fill it using an object or array, and insert the result back as many times as needed, it's also smart enough to know if the object used as a data source is an array and insert multiple one for each element say to fill a list.\nI also added an in-element template, something that looks for an expression/word in side an element and surround it with a template, to be used for example as highlighter.\nI hope it will be good enough to be added to More as a thank you Mootools contribution.\n. Hay, Have a look at this, I will post it in Mootools More too!\nhttp://allochi.wordpress.com/2011/08/19/mootools-html-templates/\n. Hi again,\nI built one, how do I share with Mootools team to see if it can be accepted in More?\n. Thanks, I will organize my code and examples and post them for discussions.\nWhat I have is more than extending substitute, I have a class that extract HTML from the page or take an element constructed with new Element(), and use it as a template, fill it using an object or array, and insert the result back as many times as needed, it's also smart enough to know if the object used as a data source is an array and insert multiple one for each element say to fill a list.\nI also added an in-element template, something that looks for an expression/word in side an element and surround it with a template, to be used for example as highlighter.\nI hope it will be good enough to be added to More as a thank you Mootools contribution.\n. Hay, Have a look at this, I will post it in Mootools More too!\nhttp://allochi.wordpress.com/2011/08/19/mootools-html-templates/\n. ",
    "alpha123": "Seems to work in Safari 4.0.5 (Windows version anyway).\n. I did a little research and it's been supported in Opera since 9.62 or earlier.\n. http://w3fools.com/\n. Confirmed, but this seems to already be fixed in master.\n. I'm not sure, but I think master is going to become 1.5. The fix will almost certainly be present in 1.4.4 though.\n. +1 to move Swiff to More. It seems much more like a plugin than like core functionality.\n. @JStiller see that's the thing, semantically I think it should be in More. It's not really Core functionality for a web toolkit, certainly not like Class or Element.\n. Well, then what isn't core functionality?\nSwiff is infrequently used, but more importantly, it fits in the \"plugin\" section of a library, not the \"framework\" section. Core contains \"framework\" stuff like Type, Class, DOM manipulation, etc. More contains add-ons to that.\nBy this logic, Cookie should also be in More, which seems reasonable.\n. Seems to work in Safari 4.0.5 (Windows version anyway).\n. I did a little research and it's been supported in Opera since 9.62 or earlier.\n. http://w3fools.com/\n. Confirmed, but this seems to already be fixed in master.\n. I'm not sure, but I think master is going to become 1.5. The fix will almost certainly be present in 1.4.4 though.\n. +1 to move Swiff to More. It seems much more like a plugin than like core functionality.\n. @JStiller see that's the thing, semantically I think it should be in More. It's not really Core functionality for a web toolkit, certainly not like Class or Element.\n. Well, then what isn't core functionality?\nSwiff is infrequently used, but more importantly, it fits in the \"plugin\" section of a library, not the \"framework\" section. Core contains \"framework\" stuff like Type, Class, DOM manipulation, etc. More contains add-ons to that.\nBy this logic, Cookie should also be in More, which seems reasonable.\n. ",
    "alexksso": "here's the patch :\n```\nFrom ffb66ba5f7732805d2f8017b9404f3874ae27c53 Mon Sep 17 00:00:00 2001\nFrom: Alexander Casassovici alex@ksso.net\nDate: Tue, 30 Aug 2011 14:48:56 +0200\nSubject: [PATCH] Support for custom tokenValue\nsimply initialize with tokenValue:\"myid\" and it will store the myid attribute in the list instead of the standard \"id\" attribute\nsrc/jquery.tokeninput.js |    9 +++++----\n 1 files changed, 5 insertions(+), 4 deletions(-)\ndiff --git a/src/jquery.tokeninput.js b/src/jquery.tokeninput.js\nindex 3e9c364..185dc26 100644\n--- a/src/jquery.tokeninput.js\n+++ b/src/jquery.tokeninput.js\n@@ -186,7 +186,7 @@ $.TokenList = function (input, url_or_data, settings) {\n         .css({\n             outline: \"none\"\n         })\n-        .attr(\"id\", settings.idPrefix + input.id)\n+        .attr(\"id\", settings.idPrefix + input[settings.tokenValue])\n         .focus(function () {\n             if (settings.tokenLimit === null || settings.tokenLimit !== token_count) {\n                 show_dropdown_hint();\n@@ -460,7 +460,8 @@ $.TokenList = function (input, url_or_data, settings) {\n             });\n     // Store data on the token\n\n\nvar token_data = {\"id\": item.id};\nvar token_data = {};\ntoken_data[settings.tokenValue] = item[settings.tokenValue];\n         token_data[settings.propertyToSearch] = item[settings.propertyToSearch];\n         $.data(this_token.get(0), \"tokeninput\", item);\n\n@@ -492,7 +493,7 @@ $.TokenList = function (input, url_or_data, settings) {\n             token_list.children().each(function () {\n                 var existing_token = $(this);\n                 var existing_data = $.data(existing_token.get(0), \"tokeninput\");\n-                if(existing_data && existing_data.id === item.id) {\n+                if(existing_data && existing_data[settings.tokenValue] === item[settings.tokenValue]) {\n                     found_existing_token = existing_token;\n                     return false;\n                 }\n@@ -854,4 +855,4 @@ $.TokenList.Cache = function (options) {\n         return data[query];\n     };\n };\n-}(jQuery));\n+}(jQuery));\n\\ No newline at end of file\n-- \n1.7.5.4\n```\n. here's the patch :\n```\nFrom ffb66ba5f7732805d2f8017b9404f3874ae27c53 Mon Sep 17 00:00:00 2001\nFrom: Alexander Casassovici alex@ksso.net\nDate: Tue, 30 Aug 2011 14:48:56 +0200\nSubject: [PATCH] Support for custom tokenValue\nsimply initialize with tokenValue:\"myid\" and it will store the myid attribute in the list instead of the standard \"id\" attribute\nsrc/jquery.tokeninput.js |    9 +++++----\n 1 files changed, 5 insertions(+), 4 deletions(-)\ndiff --git a/src/jquery.tokeninput.js b/src/jquery.tokeninput.js\nindex 3e9c364..185dc26 100644\n--- a/src/jquery.tokeninput.js\n+++ b/src/jquery.tokeninput.js\n@@ -186,7 +186,7 @@ $.TokenList = function (input, url_or_data, settings) {\n         .css({\n             outline: \"none\"\n         })\n-        .attr(\"id\", settings.idPrefix + input.id)\n+        .attr(\"id\", settings.idPrefix + input[settings.tokenValue])\n         .focus(function () {\n             if (settings.tokenLimit === null || settings.tokenLimit !== token_count) {\n                 show_dropdown_hint();\n@@ -460,7 +460,8 @@ $.TokenList = function (input, url_or_data, settings) {\n             });\n     // Store data on the token\n\n\nvar token_data = {\"id\": item.id};\nvar token_data = {};\ntoken_data[settings.tokenValue] = item[settings.tokenValue];\n         token_data[settings.propertyToSearch] = item[settings.propertyToSearch];\n         $.data(this_token.get(0), \"tokeninput\", item);\n\n@@ -492,7 +493,7 @@ $.TokenList = function (input, url_or_data, settings) {\n             token_list.children().each(function () {\n                 var existing_token = $(this);\n                 var existing_data = $.data(existing_token.get(0), \"tokeninput\");\n-                if(existing_data && existing_data.id === item.id) {\n+                if(existing_data && existing_data[settings.tokenValue] === item[settings.tokenValue]) {\n                     found_existing_token = existing_token;\n                     return false;\n                 }\n@@ -854,4 +855,4 @@ $.TokenList.Cache = function (options) {\n         return data[query];\n     };\n };\n-}(jQuery));\n+}(jQuery));\n\\ No newline at end of file\n-- \n1.7.5.4\n```\n. ",
    "fbender": "The Doc is broken for Event. Manually entering DOMEvent in the URL shows the \"new\" Doc. \n. BTW, Mozilla switched from YUI to UglifyJS as well: http://blog.mozilla.com/webdev/2011/10/25/go-speed-racer/\n. The Doc is broken for Event. Manually entering DOMEvent in the URL shows the \"new\" Doc. \n. BTW, Mozilla switched from YUI to UglifyJS as well: http://blog.mozilla.com/webdev/2011/10/25/go-speed-racer/\n. ",
    "w00fz": "It's fixed now\n. It's fixed now\n. ",
    "realityking": "The big problem I'm seeing with this is that different properties can be transitioned based on the browser. For example I can transition the border-radius property just fine in Webkit and Firefox but I can't in Opera, this has to be taken into account somehow.\n. :+1:\nLet's save some bytes. Those who actually use flash can get it from More.\n. I'm well aware of how to build a custom MooTools, but I'm primarily working with Joomla. The complete core is loaded almost all the time, more far less often. So anything not or rarely used by Joomla that moves from core to more saves some bytes for me ;)\n. The big problem I'm seeing with this is that different properties can be transitioned based on the browser. For example I can transition the border-radius property just fine in Webkit and Firefox but I can't in Opera, this has to be taken into account somehow.\n. :+1:\nLet's save some bytes. Those who actually use flash can get it from More.\n. I'm well aware of how to build a custom MooTools, but I'm primarily working with Joomla. The complete core is loaded almost all the time, more far less often. So anything not or rarely used by Joomla that moves from core to more saves some bytes for me ;)\n. ",
    "mcfedr": "now posted here https://github.com/mootools/mootools-more/pull/1021\n. I have created a fiddle that shows the bug, http://jsfiddle.net/mcfedr/RVuFW/\nAs you can see the suggestion by arian will still cause a problem.\nI have found it takes quite a specific selector to get the bug, maybe I am not always triggering Slick. Also it seems only to be for className, not any other attributes.\n. that will return the wrong value for a normal element with a normal string className\njavascript\nvar ts = [{className: \"hi\"},\n{className: \"\"},\n{className: {baseVal: \"hi\"}},\n{className: {baseVal: \"\"}}];\nfor(t in ts) {\n    console.log((ts[t].className && ts[t].className.baseVal) || 'default'); \n}\nprints\ndefault\ndefault\nhi\ndefault\nwe need the first case to be hi as well\n. now posted here https://github.com/mootools/mootools-more/pull/1021\n. I have created a fiddle that shows the bug, http://jsfiddle.net/mcfedr/RVuFW/\nAs you can see the suggestion by arian will still cause a problem.\nI have found it takes quite a specific selector to get the bug, maybe I am not always triggering Slick. Also it seems only to be for className, not any other attributes.\n. that will return the wrong value for a normal element with a normal string className\njavascript\nvar ts = [{className: \"hi\"},\n{className: \"\"},\n{className: {baseVal: \"hi\"}},\n{className: {baseVal: \"\"}}];\nfor(t in ts) {\n    console.log((ts[t].className && ts[t].className.baseVal) || 'default'); \n}\nprints\ndefault\ndefault\nhi\ndefault\nwe need the first case to be hi as well\n. ",
    "NKjoep": "and of course there's a mistake. This is for mootools-more. Sorry.\n. and of course there's a mistake. This is for mootools-more. Sorry.\n. ",
    "darkwing": "Thanks for the report Ryan!  Could you do me a favor and create a really basic JSFiddle (http://jsfiddle.net) for this issue?  It will be a big help in tracking down the exact issue.\n. Thanks for the report Ryan!  Could you do me a favor and create a really basic JSFiddle (http://jsfiddle.net) for this issue?  It will be a big help in tracking down the exact issue.\n. ",
    "ryanmitchell": "Yep no problem - you can find it here:\nhttp://jsfiddle.net/6qf6D/6/\nShows an alert in all browsers I've tested apart from IE8, where it gives \"Object doesn't support this property or method\"\n. @fabiomcosta could it be a difference in IE8 versions? I get a very different error.\nSee:\nhttp://cl.ly/3O2t3i3c1y1X0b260F2j\nhttp://cl.ly/432O2P140B3u0K162e0j\n. That worked - so so sorry for wasting your time.\nCan't believe I never noticed that!\n. Yep no problem - you can find it here:\nhttp://jsfiddle.net/6qf6D/6/\nShows an alert in all browsers I've tested apart from IE8, where it gives \"Object doesn't support this property or method\"\n. @fabiomcosta could it be a difference in IE8 versions? I get a very different error.\nSee:\nhttp://cl.ly/3O2t3i3c1y1X0b260F2j\nhttp://cl.ly/432O2P140B3u0K162e0j\n. That worked - so so sorry for wasting your time.\nCan't believe I never noticed that!\n. ",
    "DimitarChristoff": "it worked fine iirc no issues. btw doing a document.createElement to pick property on the getter every time, should we not store the property prematurely? I can build a jsperf test case for the new getter if you like. will test IE when I get to office\n. @arian ++ go go go!\n. thanks so much! awesome. \n. excellent. thank you so much :)\n. this has broken Fx.Morph - https://github.com/mootools/mootools-core/blob/bd9275e325add7b7fa5e77f8d91c7a9918dc03ef/Source/Fx/Fx.CSS.js#L29 does not check if this.options.unit is != false first. result: cannot morph when values being morphed is defined as a string with unit like so: 100px. \nhttp://alpha.jsfiddle.net/YFrwa/1/\n. Sure, will add to our experimental backoffice dev branch tomorrow morning.\nMaybe in a fork of main app if i can get some sellenium ci time outside of\nmaster.\nOn Feb 9, 2012 7:52 PM, \"Olmo Maldonado\" \nreply@reply.github.com\nwrote:\n\n@DimitarChristoff, @stecb please give us a hand and test the master\nbranch with your code.\nHere are the instructions on how to build mootools:\nhttps://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2160#issuecomment-3894299\n. On 12/02/2012 23:59, Olmo Maldonado wrote:\nThanks for your understanding, and I'm excited to have you on board for the freezing period. At some point, we'll open it up for more volunteers but we'll use issue contributors to ping for testing.\nFor now please check the stability of 1.4.5dev and if any of your tests fail, please let us know. We should start trickling specs/tests from user space to dev. We'd like to release 1.4.5 some time this week.\nRegarding the fireEvent, could you please report it in another issue? I'd like for others to review it.\n\nHe does make a fair point, last 3 releases have had some unfortunate \nregressions that have totally taken upgrading out of the menu for us as \nwell as done little to instill confidence in mootools. Some fairly \ndisgruntled people here that I have to swing/win over again (but wish \ndidn't have to...)\nIs there scope for working with something like buster.js / sinon + \njstestdriver and doing some tests that we can go through, checking for \nregressions? I would be happy to help with this as much as possible - in \neither writing or in running them, probably even as a part of my day job \nas more stability in mootools will definitely help us...\nAnyway, on testing mootools-edge - I managed to talk our QA team into \nrunning through the apps on Friday in full and some CI / selenium time \nas well - not before then and before our weekly sprint/commitment is \nover, I am afraid. What is the release schedule / plan for 1.4.5? If \nit's not too late by then, let me know and I will make the spiked branch \nnow.\nI can - in the meanwhile - get it running on other sites - but they lack \nproper testing coverage so it will be reliant on me manually testing the \napps.\n. The jury on 1.4.5 nightly build is back.\n```\nUI acceptance test\n\nResult:     Tests passed: 349 \n```\nLooking good thus far but it's only on the front-end, will try backoffice as well. Tomorrow QA will spend an hour on it or so. \n. QA have also finished testing for 3 hours, no application regressions were found in: IE7, IE9, FF (latest stable), Chrome (latest stable). \nThis does not by any means guarantee 1.4.5 is going to be bug free, particularly when you consider we referenced a mootools-more from 1.4.1 - though it's stable enough that we'd consider moving to it within a week or so after general release. I am saying it so it's not on us if things are wrong again - the business is puzzled by the need to contribute back into mootools as it is - though they have come to accept the clear benefits of a stable release we can use.\nthanks to @agillborn and @obray for their hard work.\n. oh, very cool. \njavascript\n/*<ltIE9>*/\ndelete Element.NativeEvents.propertychange;\ndelete Element.Events.change;\n/*</ltIE9>*/\ndoes not fix my issue, in fact, it makes intended change events really unpredictable. is the bug to do with the fact that radios and checkboxes don't really fire a change but a propertychange instead? hence, the bug is in the condition which fires a change on any propertychange event, as long as the this.checked is true. \n. yep. anything you d that does a propertychange fires the change event. http://jsfiddle.net/5CvBb/7/ with a .set(\"data-attrib\") does it too. \n. erm. fixed though I am not sure how 'safe' it is. \njavascript\n return !!((this.type != 'radio' || this.checked) && event.event.propertyName == 'checked');\n. @ibolmo please consider https://github.com/DimitarChristoff/mootools-core/commit/6abff54d7586d691454d915fe49e60204cc844d2 instead as it was the only safe-ish option that did not break normal input[type=text] change, read https://github.com/mootools/mootools-core/pull/2172#issuecomment-3123570\n. no, I am actually checking this atm for breakages on other input types which will likely fail.\n. actually. this causes errors. \nreturn !!(event.type === 'change' || event.type === 'propertychange' && event.event.propertyName == 'checked') \nworks for all elements and change is fine. http://jsfiddle.net/5CvBb/23/ - however, it fires a change event on a radio group sharing the same name to all elements that experience propertychange of checked. not sure if this is the accepted dom model. \ncommit / sha:\nhttps://github.com/DimitarChristoff/mootools-core/commit/6abff54d7586d691454d915fe49e60204cc844d2\nlet me know if i should make a new pull request.\n. because it broke change for input[type=text], i can dig out the jsfiddle that did this but it's been a lot... \n. this fixes it so it only fires the change once per radio group:\nreturn !!(event.type === 'change' || this.checked && event.type === 'propertychange' && event.event.propertyName == 'checked')\nhttps://github.com/DimitarChristoff/mootools-core/commit/53b0dc59224de3743c1c529f9856f6898c7023c7\nit also does one less property lookup due to base which already has read the type and set the event accordingly. \n. i haven't got the test/spec runner or repo at home (windows), will do tomorrow morning at work - just tested IE7 and IE8 so far, don't even have an IE6 VM\n. @arian that spec file is out of date, it references Type/Event.js not DOMEvent.js. fixed here: https://github.com/DimitarChristoff/mootools-core/commit/6c8f004eae265d0c2ac885e3c4d5af62094e9db6\ntests pass, btw - at least on IE9 in IE7 and IE8 doc mode (forced). if you want to try it's here http://fragged.org/dev/mootools-core/Specs/1.4client/Element/Element.Event.change.html\n. to be fair, there are certain implications with this in general, browsers deal with type changing differently. eg, input[type=password][value=foo].set(\"type\", \"text\") - should it really keep the value? not to mention this will actually fire an exception in Ie6/7/8. consider input[type=text][value=c:\\autoexec.bat].set(\"type\", \"file\")\n. @jiggliemon nah, on that last fiddle, remove mootools and watch output -> no difference. \n. I don't at all like the idea that an error in props values is being swallowed. It is useful to get exceptions. Eg case:\nelement.setStyle('overflow-x', 'none'); // throws in IE\nIf the above just swallows it, it won't account for behaviour of element failing to change. \nThe obvious case here is undesired elastic transition loops through negative values which older versions of IE do not accept, for instance, height cannot be negative\nWorkaround can simply be try/catch block around your animation, not the setter\ni'd label this bug as won't fix and close it for now. \n. this is still not quite right. http://jsfiddle.net/dimitar/357Lt/ -> a data-propertyId is arguably wrong as HTML5 validation prefers all data- properties to be lowercase (W3C spec does not say anything in particular about their casing). \nBrowsers seem to adjust the element and fix attributes to lowercase but IE6/7/8 do not. \nanyway: in IE7/8, .get('data-propertyid') - which is correct from a getter stand point as it SHOULD be lowercase - returns null though .getAttribute('data-propertyid') returns the value, despite of the element markup having data-propertyId. \nbasically, i guess I am saying: expect .get(\"data-Something\") to return .getAttribute(\"data-Something\"); in IE6/7/8 - or any camel cased / uppercased attribute, data or otherwise. \nsomething that will probably fix it is:\nhttps://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L652 to convert to lowercase to match the whitelisted prop above at https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L648 and where it is being allowed https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L658\n. the reason I created it was to mimic something that is available in jquery already (since 1.4.3): http://api.jquery.com/data/#data-html5 - whereas I don't use jquery - ever - I thought this could be useful and at least for mootools-more Element.Extras it should be fine... \n. https://github.com/mootools/mootools-core/issues/2160 - see comment below.\n. oups looks like a duplicate. \n. no it returns the property value as it should\n. Element.properties - i thought of it then how would you really know if what you read was intended or not? it's also broken in jquery. http://jsfiddle.net/cd2Am/9/ - i don't think it can be fixed easily, though go ahead :) \np.s. this is closed, i submitted it w/o meaning to before it was ready so it saved it twice, see the one ibolmo has referenced\n. this looks like a Slick issue rather than anything else. \nalert(document.getElements('input#Q1').length); -> 0\ninput[id=Q1] -> 1\nhttp://jsfiddle.net/rmgVM/7/ - tested on native ie7 - testing this in IE9 in IE7 mode does not produce the bug. \nping @fabiomcosta\nhttp://jsfiddle.net/dimitar/rmgVM/11/ - it looks like the id is correctly removed there. and it's not caused by the invalid markup in the original jsfiddle either. \n@karolis-k a few things.\n```\nvar q1 = $('Q1');\nq1.clone().replaces(q1);\n// use the correct selector for id:\nalert($$('input#Q1').length); // 0\n``\n. sorry it is not Slick. Sizzle also finds 1 element withinput[id=Q1]` after mootools clones. http://jsfiddle.net/rmgVM/16/\nBeen looking at it with @kentaromiura and he reckons it looks like it is specific to id and does not fail if you remove the id attr of the copied element. something that has yet to work for me. \n. this does not fix it even though the request fires before the xhr.open, the function does not actually update the DOM until the response arrives. \n. can you build a jsfiddle with this? http://jsfiddle.net/pywWb/ works fine (IE9 in IE7 mode, though). what doctype do you have? do you have valid markup that validates?\n. really? I tested this a fair bit and it does NOT seem to contain expando attributes. http://jsfiddle.net/wXCSx/2/show/ in IE9 in IE7/8 mode and IE7 native, the only attributes it has are the ones I expected to see. will you be kind enough to show me a case where this happens (for my own learning purposes, forget about fixing/changing it).\n. http://www.quirksmode.org/dom/w3c_core.html#attributes warnings there are primarily against the use of the indexed array but the NamedNodeMap one should be safe-ish to use. jquery use that a fair bit and their .data api is entirely reliant upon it. did they drop support for ie6?\n. Doesn't Firefox support this natively now? And it's kind of broken? Mootools will only abstract and base this on mouseover/out if 'onmouseenter' in document.documentElement is false\n. They ripped off SO - orig here:\nhttp://stackoverflow.com/questions/10182381/mootools-event-causes-infinite-loop-in-ie7-ie8-\nits what prmpted me to raise the bug.\nOn Apr 19, 2012 7:33 PM, \"Arian Stolwijk\" \nreply@reply.github.com\nwrote:\n\nAlso here is another problem described, when you change input.checked in\nthe change event:\nhttp://allbtechebooks.blogspot.com/2012/04/mootools-event-causes-infinite-loop-in.html\n/cc @csuwldcat\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2352#issuecomment-5228734\n. wouldn't that only matter if you don't use .send() and go .get / .post etc anyway? otherwise, this.options.method will be true. you can just rubberstamp it here by re-implementing these methods: https://github.com/mootools/mootools-core/blob/master/Source/Request/Request.js#L234-243. why is it important to know the method AFTER the response? anyway, it's so trivial - http://jsfiddle.net/dimitar/yVbYQ/3025/\n. then refactor .send to leave a reference to the last local options.method - to be honest, I don't think this will be a bad change, although I can't see many uses besides RESTful model updates with a common event handler (for example).\n\ni would definitely prefer the options object passed to send not to be overriding the default options options permanently by merging into  this.options - if you want to do this, just .setOptions(newobj).send()\n. what is your use case? prototypejs don't encode keys either - https://github.com/sstephenson/prototype/blob/master/src/prototype/lang/hash.js#L289 \n. you can fix that - it's because \"\" is falsy and 0 is not a string. \nhere's the case: http://jsfiddle.net/wbPh9/3/\nfix is: https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L1027\nbecomes: if (optionValue === String(value)) return option.selected = true;\nas a quick workaround for @angelsk, do $('hour').set('value', '0'); which is fine. \n. will do a pull request and add a test case here https://github.com/mootools/mootools-core/blob/master/Specs/1.4client/Element/Element.js#L58\n. Close pls\n. IE 6 and 7 don't actually support that, I thought? http://caniuse.com/#search=object \nAnd as for IE8, support is dodgy as far as I know. http://blogs.msdn.com/b/ie/archive/2008/04/10/html-and-dom-standards-compliance-in-ie8-beta-1.aspx - scroll down to known issues re parsing of the object tag\n. also works for me. \n. it's not an issue with the native mouseenter/leave implementation. http://jsfiddle.net/dimitar/KemYP/6/ - when attached directly to the tr, it's all good. I'd say that's a bug, though it may be implementation specific. 1.4.1 moved delegation over to -core but i can't remember at what point mouseenter/leave were fixed to work with delegation\n. thats the point though. the native event by firefox, assigned to the TR directly, does not fire mouseleave as you'd expect. only happens on the delegated one. @arian what of this map? https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Delegation.js#L30-36\n. this is not a bug. you can have unlimited multiple event callbacks for the same event.\n```\ninstance.addEvent('test',  function() {\n    console.log('1');\n});\ninstance.addEvent('test',  function() {\n    console.log('2');\n});\ninstance.addEvent('test',  function() {\n    console.log('3');\n});\ninstance.fireEvent('test'); // 1... 2... 3...\ninstance.removeEvents('test');\ninstance.addEvent('test',  function() {\n    console.log('4');\n});\ninstance.fireEvent('test'); // 4\n```\nsame thing applies to events with elements. setOptions is just an interface that calls the addEvent for you. \n. yeah when I tried it at the top of the function, it failed another test. put it right before the loop now and it passes all specs. \n. this is not a bug but is due to the way objects as properties get referenced\nhere is an example to show you the connection between objects passed to constructor, what goes on the prototype and what goes to instance.\n```\nvar o = {\n    left: \"blue\"\n};\nvar foo = new Class({\n    eyes: o,\n    getLeft: function() {\n        console.log(this.eyes.left);\n    }\n});\nvar instance = new foo();\ninstance.getLeft(); // blue; \n// change the original object\no.left = \"brown\";\ninstance.getLeft(); // still blue\n// change it in the constructor \nfoo.prototype.eyes.left = \"brown\";\ninstance.getLeft(); // brown now.\n```\nhttp://jsfiddle.net/n8DPw/\na perfect example would be if you did console.log(Object.keys(this.eyes)); - which should produce nothing due to hasOwnProperty check. Doing Object.clone() will derefrence the link and make it all work. \na pattern to go around that is to do in your initialize:\nthis.eyes = {\n           leftHead: 4,\n           rightHead: 4,\n           topHead: 2\n        };\nthis will make it a local object to the instance and all your tests will pass. or do this.eyes = Object.clone(this.eyes); to dereference it \n. in all fairness, yes, http://mootools.net/docs/core/Element/Element#Element:empty is probably a bit vague. as a whole, it would be awesome if methods could be linked to a line on github where the source can be seen. in the meanwhile, if you feel that you can improve on the current documentation, here is the file: https://github.com/mootools/mootools-core/blob/master/Docs/Element/Element.md#element-method-empty-elementempty - fork, clone, make a branch quoting this issue, edit/update, test, push, send pull request.\n. i like it. \n. 953f6c4c9581fd7755d656b1ece4ab2578262aab\n. here's a simple test case:\nhttps://tinker.io/d3524/2\nand yes, Request.JSON adds X-Request: 'JSON' so it won't work for that either, unless you delete that header as well.\n. seems related to focus. for example, this works on keypress -> http://jsfiddle.net/qSCvc/5/ so it may be down to event types... \n. in my chrome on osx, it fails to remove the focus:relay event - though I originally discovered it on Firefox nightly (Aurora). \n. Yeah, I know I can work around that in principle. And I have. \nisSuccess is being used and promptly ignored in the .send, which it probably shouldn't be. Using 2 instances - one for getting stuff when you expect data, one for when you don't - is not scalable. especially if you reuse the same request instance to avoid rogue requests and race conditions.\nI still think this particular use case needs to be handled separately. \nhave a look at an implementation that is not very different from mootools'\nhttps://github.com/ded/reqwest/blob/master/src/reqwest.js#L159-205\nin particular:\nvar r = resp.responseText\n      if (r) {\n...\nand yes, then if there IS a responseText that can't make an object when content type is json, fire error. It's a very small shift in logic... \n. if you re-use the same instance eg. this.r = new Request.JSON({link:'chain'}); you can't be swapping it when you think you may get a no-content response. reusing in order to avoid event-driven updates to run out of sequence by creating their own request instances and resulting in state of client being out of sync due to latency. anyway, that's besides the point.\ncloser to home. @kamicane agent. https://github.com/kamicane/agent/blob/master/lib/agent.js#L255-258 - it does not try to guess if the decoder has done its job. it does not try to fire an onSuccess/onFailure for you. it lets you decide for yourself in the callback fn by giving you the right data. \nall i am proposing is that this be considered:\njavascript\n            if (text && (json == null && this.status != 204)) this.onFailure();\n            else this.onSuccess(json, text);\nthink about it. onSuccess should mean the request was successful and not 'the request was done and so was the creation of an object from whatever response got sent our way'. \nthis is an edgecase that will only affect no content and empty responses, which is also annoying when no response is warranted. \n. I guess the shift in philosophy across the board in all XHR implementations out there is that there is no need to subclass in the first place as you react to the content-type instead and deal with whatever is being returned. you cannot say that the convenience this affords vs. the implicit expectation of something to arrive in a particular way is not a better idea. My woes here are not because I don't know what I will get, \nit's because I rely on Request to handle Epitome model sync and as a framework, it needs to be as flexible as possible, given that you cannot guarantee what will come down the wire.\n. seems cool. i like it. :+1:  still, you can easily create your own Request subclass with this func in. it seems like too much of an edgecase \n. this is - to the best of my knowledge - not only related to memory leaks created by circular references in IE - but it is to speed up access of any stored values so it works from memory as opposed to DOM access. \nalso, mootools uses storage internally - eg. all element events callbacks get added into storage etc. - you wouldn't want to store potentially huge event callback stacks or validators or Fx instances or any other data onto the actual element w/o a closure, potentially opening all that up to anyone that can access the DOM and making them enumerable. \nsee https://github.com/jquery/jquery/blob/1.9-stable/src/data.js - jQuery storage also uses jQuery.cache and not actual element objects.\nit's fair enough that you may want to GC a container by destroying all child nodes so that all storage etc is cleaned up - but this is really implementation-specific in my opinion and does not outweigh the needs of most people. \n. does not really matter, I don't care what the output is or why primitive\nvalues do not come back as keys. just posted the bug as per the SO question\nafter talking to @kentaromiura on IRC. close it.\nOn Monday, March 3, 2014, Olmo Maldonado notifications@github.com wrote:\n\nI'm sure I'm just running by this too quick, but I totally don't know what\nyou'd like to happen :). Could you provide me with a table or even better a\ncouple of failing specs showing what to expect?\n\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2544#issuecomment-36572239\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. no we spoke about this 3 months ago. today was nothing to do with mootools\nand not a new issue or an issue as such anyway.\nOn Monday, March 3, 2014, Cristian Carlesso notifications@github.com\nwrote:\n\nmmm wait, this is not what we talked about today, the issue you found\ntoday was that var key in object is not sequential, and that's by spec.\nthis is a different thing imho\n\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2544#issuecomment-36573509\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. the guy :+1: \n. it's not up to me but my opinion also is that this should not be in core. implementing is trivial to do via extending existing Events class and this is not something that needs to be in core imo. \nhttp://jsfiddle.net/dimitar/Qfd3f/ for example, simple mute/unmute that renames the event key and then moves it back. simple but it does the same effect w/o adding 2 more methods to every class's prototypes. if you extend Events, EVERY single mootools user that has a class that implements it will get disableEvent, enableEvent and $disabledEvents plus the extra time to check if an event is disabled each time something fires. as such, it's not something that I would like to see in mootools, but like I said, it's not up to me :) \nthis can lead to some anti-patterns with encapsulation. eg.\n- class A fires change, works as model\n- class B listens for A:change and renders\n- class C listens for A:change and renders\n- class B does a.disableEvent because it does not want to render temporarily\n- class A fires change but class C also does not get it\nthe disabling probably needs to be per bound callback for it to be safe, otherwise, you are better off unsubscribing and resubscribing. you can also debounce the callbacks or use event pseudos like :once. many alternatives... \nthis could go in the mootools-community edition thing that is (maybe) happening. \nother than that, interesting pull request. I have modded my events class to be more like backbone's - with listenTo and stopListening, but suspending events temporarily may be a useful feature. one thing - it's probably more likely to land if there are tests for it :)\n. I'd personally favour not changing the event class prototype itself but subclassing it.\njavascript\nvar BetterEvent = new Class({\n    Extend: Events,\n    $disabled: {},\n    fireEvent: function(type){\n        if (something) return this;\n        return this.parent(arguments);\n    }\n});\netc etc. this way you mixin the better events class when needed and normal events when not. \nas for performance, It normally is not a problem - until you start building things like currency pairs etc that update 3-4 times a second and rely on events to fire. only noticed perf issues then - my class looked like this: https://github.com/epitome-mvc/Epitome/blob/master/src/epitome-events.js - which is arguably much worse but the aim was mostly func. \n. erm. maybe make a event:debounce(ms) pseudo. there are\nstandard/expected patterns for this sort of thing--maybe set the debounce\nms as a variable you can change, 0 being default to not wait normally.\nOn Monday, May 19, 2014, Olivier Laviale notifications@github.com wrote:\n\nI understand that. The way I use it is to suppress 20 change events\u2014while\ncriteria are reseted\u2014to fire a single change event, after the reset is\ncomplete. In a sense, the change events are not lost, but rather\naggregated. My proposal was a simple solution, but it looks like simple\nsolutions are not always good solutions :)\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2595#issuecomment-43479272\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. looks like a win. :) :+1: \n. cool and meh. close and mark as 'wont fix' for future reference. \n. I will scrape something together and add test and document it in the md.\nOn Friday, October 31, 2014, Olmo Maldonado notifications@github.com\nwrote:\n\nor HTTPOnly\nOn Fri, Oct 31, 2014 at 9:40 AM, Arian Stolwijk notifications@github.com\n\u0002amp\u0003#106;\u0002amp\u0003#97;\u0002amp\u0003#118;\u0002amp\u0003#97;\u0002amp\u0003#115;\u0002amp\u0003#99;\u0002amp\u0003#114;\u0002amp\u0003#105;\u0002amp\u0003#112;\u0002amp\u0003#116;\u0002amp\u0003#58;\u0002amp\u0003#95;\u0002amp\u0003#101;\u0002amp\u0003#40;\u0002amp\u0003#37;\u0002amp\u0003#55;\u0002amp\u0003#66;\u0002amp\u0003#37;\u0002amp\u0003#55;\u0002amp\u0003#68;\u0002amp\u0003#44;\u0002amp\u0003#39;\u0002amp\u0003#99;\u0002amp\u0003#118;\u0002amp\u0003#109;\u0002amp\u0003#108;\u0002amp\u0003#39;\u0002amp\u0003#44;\u0002amp\u0003#39;\u0002amp\u0003#110;\u0002amp\u0003#111;\u0002amp\u0003#116;\u0002amp\u0003#105;\u0002amp\u0003#102;\u0002amp\u0003#105;\u0002amp\u0003#99;\u0002amp\u0003#97;\u0002amp\u0003#116;\u0002amp\u0003#105;\u0002amp\u0003#111;\u0002amp\u0003#110;\u0002amp\u0003#115;\u0002amp\u0003#64;\u0002amp\u0003#103;\u0002amp\u0003#105;\u0002amp\u0003#116;\u0002amp\u0003#104;\u0002amp\u0003#117;\u0002amp\u0003#98;\u0002amp\u0003#46;\u0002amp\u0003#99;\u0002amp\u0003#111;\u0002amp\u0003#109;\u0002amp\u0003#39;\u0002amp\u0003#41;\u0002amp\u0003#59;\nwrote:\n\nI would accept a pull request.\nIt's basically just adding\nif (this.options.HttpOnly) value += '; HttpOnly';\nOnly question is whether it should be HttpOnly or httpOnly...\n\u2014\nReply to this email directly or view it on GitHub\n<\nhttps://github.com/mootools/mootools-core/issues/2664#issuecomment-61269814>\n.\n\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2664#issuecomment-61272225\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. is build error badge my doing? grunt tests passed\nOn Tuesday, November 11, 2014, Arian Stolwijk notifications@github.com\nwrote:\n\nClosed #2664 https://github.com/mootools/mootools-core/issues/2664 via\n2676 https://github.com/mootools/mootools-core/pull/2676.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2664#event-191317083.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. seems as if it's failing in opera as it lacks support. according to search\nit's been supported since opera 9.50 but that predates their move to\nWebKit.\nOn Tuesday, November 11, 2014, Dimitar Christoff christoff@gmail.com\nwrote:\n\nis build error badge my doing? grunt tests passed\nOn Tuesday, November 11, 2014, Arian Stolwijk notifications@github.com\n\u0002amp\u0003#106;\u0002amp\u0003#97;\u0002amp\u0003#118;\u0002amp\u0003#97;\u0002amp\u0003#115;\u0002amp\u0003#99;\u0002amp\u0003#114;\u0002amp\u0003#105;\u0002amp\u0003#112;\u0002amp\u0003#116;\u0002amp\u0003#58;\u0002amp\u0003#95;\u0002amp\u0003#101;\u0002amp\u0003#40;\u0002amp\u0003#37;\u0002amp\u0003#55;\u0002amp\u0003#66;\u0002amp\u0003#37;\u0002amp\u0003#55;\u0002amp\u0003#68;\u0002amp\u0003#44;\u0002amp\u0003#39;\u0002amp\u0003#99;\u0002amp\u0003#118;\u0002amp\u0003#109;\u0002amp\u0003#108;\u0002amp\u0003#39;\u0002amp\u0003#44;\u0002amp\u0003#39;\u0002amp\u0003#110;\u0002amp\u0003#111;\u0002amp\u0003#116;\u0002amp\u0003#105;\u0002amp\u0003#102;\u0002amp\u0003#105;\u0002amp\u0003#99;\u0002amp\u0003#97;\u0002amp\u0003#116;\u0002amp\u0003#105;\u0002amp\u0003#111;\u0002amp\u0003#110;\u0002amp\u0003#115;\u0002amp\u0003#64;\u0002amp\u0003#103;\u0002amp\u0003#105;\u0002amp\u0003#116;\u0002amp\u0003#104;\u0002amp\u0003#117;\u0002amp\u0003#98;\u0002amp\u0003#46;\u0002amp\u0003#99;\u0002amp\u0003#111;\u0002amp\u0003#109;\u0002amp\u0003#39;\u0002amp\u0003#41;\u0002amp\u0003#59; wrote:\n\nClosed #2664 https://github.com/mootools/mootools-core/issues/2664 via\n2676 https://github.com/mootools/mootools-core/pull/2676.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2664#event-191317083.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. I've asked Bruce Lawson to clarify.\nOn Tuesday, November 11, 2014, Tim Wienk notifications@github.com wrote:\n\nIt seems Opera doesn't pass your added test.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2664#issuecomment-62529745\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. Could change https://github.com/mootools/mootools-core/blob/master/Specs/Utilities/Cookie.js#L36 to:\nvar val = Cookie.read('http-key'),\n    assertion = (Browser.name === 'opera'  && vers...) ? 'toEqual' : 'toBeNull';\nexpect(val)[assertion]('value');\nthis is not ideal / future proof as they may fix it... and have historically supported it in the past. - https://www.owasp.org/index.php/HTTPOnly\n. nah better way\n```\nvar obj = {\n    cookie: ''\n};\nCookie.write('foo', 'bar', { httpOnly: true, document: obj });\nexpect(obj.cookie.indexOf('HttpOnly')).not.toBe(-1);\n``\n. had to go to constructor direct becausesetOptionsderefrences the document object passed and value cannot be compared directly,Cookie.writedoes not return the instance either. \n. i did do this on my fork some time ago, it's not exactly hard. :+1: \n. not for -core, imo. there are plenty of classes around that abstract storage and can be used as standalone API, namespacers etc -- or as mixins.\n.new Element('foo')constructor handles custom elements fine, what do you mean? passes todoc.newElementwhich does not discriminate and goes todoc.createElement. - removing thecamelCaseis breaking, :-1: - code in the wild references properties in the stupidest way possible, mix of scripting, CSS styles, prefixes etc. although I agree this is going to help, it will break people's apps. perhaps can be protected by compat mode.\n- rounding :+1: - for https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L125 - though sub pixel rendering is fine, this code path only gets hit if you fail to specify your own unit so it needs to revert to the map - or you are passing an array of multiple values. you can get more performance avoiding the lookup and rounding by just adding the units yourself. the other usecase https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L128 is actually hit when you pass in your own string that's just a number, egString(300.5)would turn to 301, not sure why is is being done--somebody would know. arguably again, if you pass300.5px, you will hit the fastest code path where it does not have to do anything once it determines it's a string that does not coerce to number and will just set the style property. \n-Element.Stylescould use arrays indeed, and that will help - but it's going to break stuff again due to a lot of code that adds to the styles collection for custom property parsing, animating transitions and CSS3 props mootools does not 'know about'. Right now you can add custom parsers by simply doingElement.Styles.textShadow = '@px @px @px @'; document.getElement('.foo').setStyle('text-shadow', [2, 2, 2, 'red']);- in the new syntax, this would be more like['@px', '@px', '@px', '@']which is slightly awkward -Array.from(value)` is a little defensive and can probably go. caching and pre-emptive split is not an option that will work very well due to late adding of element styles. your gain will be lost by looking to see if the cache is populated or splitting afresh after... \nto be honest you don't need to maintain your own version of mootools for this - just add Element.prototype.css = function(key, value) { .. your faster one } and use it like jQuery. If you change styles all the time you are probably animating - and if performance is your concern, look at velocity.js as it is cleaner and perf-centric style changes / tweens\n. @arian probably el.clone().dispose() - though that's kind of pointless given that clone does not add a parentNode anyway. \nhttps://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L959\nsuggest close.\n. :+1: for debounce. \n. base of click won't work with <label>, I don't think. \n. technically, it's not a polyfill as MooTools' bind pre-dates the standardisation of Fn.proto.bind \nbecause of that, it differs. it's now a protected method but for compat's sake, it can also remain broken :)\nplease see https://github.com/mootools/mootools-core/issues/2473 - just stop using the compatibility build version of mootools. \nhttps://jsfiddle.net/dimitar/z1f12s6p/1/ - your fiddle with the right version of mootools (https://ajax.googleapis.com/ajax/libs/mootools/1.5.1/mootools-nocompat-yui-compressed.js) \n. this won't scale as you can override scrollbar widths on a per-element basis based upon cascading styles.\neg. \n```\n::-webkit-scrollbar {\n    width: 7px;\n    height: 7px;\n}\n.dark ::-webkit-scrollbar {\n    width: 12px;\n    height: 12px;\n}\n```\n... which means you can only truly measure scrollbar width on an element by injecting exactly where the element is (hopefully not in conflict with n-th child selectors)... I'd write this as a plugin or possibly mootools-more - extending http://mootools.net/more/docs/1.5.1/Element/Element.Measure \n. it's a bad practice to store non primitives in the prototype as they are not immutable and can introduce nasty side effects by reference if instances modify them. \n. ... the notable exception being options which is handled correctly via the setOptions mixin.\n``` javascript\n\nrequire('mootools');\n{}\nvar C = new Class({ options: { bar: 1 }, Implements: [Options], initialize: function(options){ this.setOptions(options); console.log(this.options); }});\nundefined\nnew C\n{ bar: 1 }\n{ options: { bar: 1 },\n  '$caller': null,\n  caller: null }\n```\n\nhaving said that, it's not ideal that it differs in node to browser behaviour.\n``` javascript\nvar C = function(){ console.log(this.foo); };\nundefined\n\nC.prototype.foo = { bar: 1 };\n{ bar: 1 }\nnew C\n{ bar: 1 }\n```\n\nHad similar issues with primish - but it's working ok but it's dangerous:\n``` javascript\n[:/Users/coda/projects/test] $ npm i primish\nprimish@0.3.9 node_modules/primish\n[:/Users/coda/projects/test] $ node\n\nvar p = require('primish');\nundefined\nvar C = p({ foo: { bar: 1 }, constructor: function(){ console.log(this.foo); }});\nundefined\nnew C\n{ bar: 1 }\n```\n. you can use document.write in jsfiddle, don't tell zalun.\n\n```\nvar w = 'write', d = document;\ndw;\n```\njust set the script block to in body.\nOn 22 April 2015 at 21:40, j3zusla notifications@github.com wrote:\n\nI am loading mootools via document.write:\ndocument.write(\"\");\nSorry, I am not able to simulate the error with jsfiddle: \"document.write\nis disallowed in JSFiddle envioriment and might break your fiddle.\" (the\nspelling error for environemnt is from the site itself ;) )\nI could give you the live site if you are not able to reproduce the issue,\nbut I prefer to keep it private to community for now. Thank you for your\nunderstanding and help,\nCordially,\nJFSG\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2712#issuecomment-95328259\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. are you animating/revealing on load?\nyou've tried the obvious here (cache)?\nhttp://stackoverflow.com/questions/19275088/in-google-maps-getboundingclientrect-gives-unspecified-error-in-ie\nthis can normally happen if you measure dimensions (getSize() etc) of an\nelement that's not in the DOM and has no layout, or you've morphed\nsomething like height or width to a negative value.\nOn 22 April 2015 at 22:30, j3zusla notifications@github.com wrote:\n\nSoz, I have no luck duplicating the issue on fiddle. I have tried to\ninclude the lib via Fiddle external function and it is all fine on I.E. It\nmust be a code conflict between libs. I have no choice but to give you the\nlive url. Can I send it in private somehow?\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2712#issuecomment-95343739\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. yeah here's how to reproduce it easily in IE:\nhttp://jsfiddle.net/q5mxu4y2/\nall it takes is: new Element('div').getPosition();\npretty sure we discussed this a while ago and a try / catch block around it\nthat returns { top: this.offsetTop, left: this.offsetLeft } instead.\nOn 22 April 2015 at 22:38, Dimitar Christoff christoff@gmail.com wrote:\n\nare you animating/revealing on load?\nyou've tried the obvious here (cache)?\nhttp://stackoverflow.com/questions/19275088/in-google-maps-getboundingclientrect-gives-unspecified-error-in-ie\nthis can normally happen if you measure dimensions (getSize() etc) of an\nelement that's not in the DOM and has no layout, or you've morphed\nsomething like height or width to a negative value.\nOn 22 April 2015 at 22:30, j3zusla notifications@github.com wrote:\n\nSoz, I have no luck duplicating the issue on fiddle. I have tried to\ninclude the lib via Fiddle external function and it is all fine on I.E. It\nmust be a code conflict between libs. I have no choice but to give you the\nlive url. Can I send it in private somehow?\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2712#issuecomment-95343739\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. so stop trying to measure layout before injecting into the dom then or put\nthe try/catch around where you do it. we could fix getPosition to do it,\njquery have done--but it's kind of a nasty fix for an edgcase where it's\nuser error.\nOn Wednesday, April 22, 2015, j3zusla notifications@github.com wrote:\n\nYes DimitarChristoff, this is the issue I am getting!\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2712#issuecomment-95349894\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. one use case that you may have is like. new\nElement(\"foo\").makeDraggable() from more uses .getPosition() - if so, just\nnew Element('div').inject(someEl).makeDraggable()\nin general, set some breakpoints and step through your code to find the\noffending bit/plugin\nOn Wednesday, April 22, 2015, j3zusla notifications@github.com wrote:\n\nok, I will back track and see where it gets called. I made sure to call\nwhat is needed on domready. It will give me the chance do a cleanup then!\nHey DimitarChristoff plz, don't use jq word anymore, it gives me the\ncreeps everytime ;)\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2712#issuecomment-95352372\n.\n. you are calling it on a HTMLElement collection which is an array which is an object with array like properties like length. \n\nalso this is handled by the browser natively in modern browsers. please ask questions on the mailing list instead, this is not an issue. \n. this is useful but I don't think the api is consistent.\nI'd go for args of fn, delay, context= to be more like .delay - don't like\na config object.\nlodash keeps it simple by just first two\nOn Friday, June 5, 2015, Sergio Crisostomo notifications@github.com wrote:\n\nNew feature suggestion: Function.debounce.\n(related: #2694 https://github.com/mootools/mootools-core/issues/2694)\nThis method will return a new function that will be called only once per\ngroup of close calls. After a defined delay it will be abble to be called\nagain.\nSyntax:\nvar debounceFn = myFn.debounce({delay: 100});\nArguments:\n1. obj - (mixed) If this argument is a number it will use it as the\n   delay timeout of the debounce. If this argument is a object it will\n   allow more specific configuration. Leaving the argument empty will fall to\n   default values.\nReturns:\n- (function) A debounce function that will be called only once per\n  group of close function calls.\nOptions:\n- delay - The delay after which the debounce function is called.\n  Defaults to 250ms.\n- early - If true will call the function in the beggining of each\n  groups of calls. Defaults to false.\n- once - If true will call the function only once per event\n  handler. Defaults to false.\nSpecs fiddle: http://jsfiddle.net/tcuzgeb1/\nhttp://jsfiddle.net/tcuzgeb1/\nSimple demo: http://jsfiddle.net/m3v56e7u/\nhttp://jsfiddle.net/m3v56e7u/\nComments are welcome.\nIf you think this is not suitable for Core let me know too.\nYou can view, comment on, or merge this pull request online at:\nhttps://github.com/mootools/mootools-core/pull/2720\nCommit Summary\n- add Function.debounce\nFile Changes\n- M Docs/Types/Function.md\n  https://github.com/mootools/mootools-core/pull/2720/files#diff-0\n  (50)\n- M Source/Types/Function.js\n  https://github.com/mootools/mootools-core/pull/2720/files#diff-1\n  (25)\n- M Specs/Types/Function.js\n  https://github.com/mootools/mootools-core/pull/2720/files#diff-2\n  (231)\nPatch Links:\n- https://github.com/mootools/mootools-core/pull/2720.patch\n- https://github.com/mootools/mootools-core/pull/2720.diff\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/pull/2720.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. you could use modernizr or has.js.\nOn Saturday, June 27, 2015, Sebastiaan notifications@github.com wrote:\n\nI would very much like to see Browser.Features.input implemented as an\narray of supported inputs.\nReturns:\n['text','button','checkbox','number','color','date','datetime','time',..]\nFor an easy way to check if the browser supports advanced html5 input\ntypes like:\n- color\n- date\n- datetime\n- datetime-local\n- email\n- month\n- number\n- range\n- search\n- tel\n- time\n- url\n- week\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2725.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. these are internal handlers\nhttps://github.com/mootools/mootools-core/blob/master/Source/Request/Request.js#L106-L116\nI would probably prefer to have the this.fireEvent('complete')\nindependent, preceding this line:\nhttps://github.com/mootools/mootools-core/blob/master/Source/Request/Request.js#L82\nOn 25 August 2015 at 22:08, Tin LE GALL notifications@github.com wrote:\n\nHi there\nI develop a mobile app with a\ncontroller > view architecture combined with asynchronous AJAX requests.\nIn order to avoid memory leaks, in destroy current controller and view\n(DOM) when the user switch back to a previous view ([back] button ...)\nMy onSuccess method uses to update the view depending on data retrieved\nfrom the AJAX call and that's why I don't want it to be executed if the\nuser left this view cause it's not surprisingly generating javascript\nerrors ...\ntests I have to do are always the same and that's why i didn't want to put\nthem in each of my onSuccess methods (many) since I have an onComplete\nmethod which is common to all my requests.\nThen here is what I do:\nonComplete: function(e)\n{\n         if(my tests are not OK) {\n                this.removeEvents().setOptions({timeout:0}).cancel();\n                return;\n         }\n         ...\n         few other things if tests are OK\n         ...\n}\nThis is working correctly (onSuccess method is not executed) if the user\nswitch back fast enough on the previous view ([back] button) but not if he\nwaits to long (like 0.5 or 1s more).\nHere is what is see in mootools-core source code.\nonSuccess: function(){\n        this.fireEvent('complete', arguments).fireEvent('success', arguments).callChain();\n    },\nI thought that onSuccess method were executed only when onComplete method\nhas finished. Isn't it the case ?\nDo you have an idea of how I should do ?\nBest\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2730.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. you'd change a framework so you can write teardowns in your tests easier?\nyou can subclass request or modify the prototype in your beforeAll or\nwhatever.\nanyway, should move this discussion to support mail list, not GH issues.\nOn Thursday, 29 October 2015, vveliev notifications@github.com wrote:\n\nI have no experience with JavaScript or mootools, I'm approaching from\ntest automation side.\nSo from testing point. I have no knowledge about requests and I cannot\ncome up with the case when I have or need to know actual request.\nIn single page application, sometimes content of the page changes. And to\ndetermine that changes have been rendered. I know 2 solutions:\n1.Look for particular element by /id/name/class/text (very specific test's)\n- Also this does not work for dynamic sections (ex. pagination\n  section, usually elements have same class identification)\n2.Have a general check for open connections, and wait for the completion\nbefore proceeding.\n- From my point this is best solution, for dynamic page sections when\n  element on the page have same identity (class is same) but values are\n  dynamically updated by some trigger.\nIf this functionality will be useful for development purpose, I will say\nmaybe (as I have no experience in UI development I cannot come up with\nexample. Maybe somebody can back me up on this one.)\nBut it does exist in: Prototype and JQuery, so there should be a reason\nfor it.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2750#issuecomment-152210768\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. we all write tests but in all my years of doing js, I've never had to keep\ncount of the number of requests sent by my tests. if you need to know that,\nstub xhr and set spies that you can assert have been called or\ncalledWith(...args). most of us write unit tests that are decoupled from\nthe responses a server will produce so actual requests out are not\ndesirable.\nOn Thursday, 29 October 2015, vveliev notifications@github.com wrote:\n\n@DimitarChristoff https://github.com/DimitarChristoff\nIf everyone who does testing need to add some additional methods around\nframework. In order to have reliable tests that can be automated. Then you\nmay aswell add this functionality into the framework.\nI'm making assumption that there are people who does make test automation.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2750#issuecomment-152304487\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. so i answered this like 5 yrs ago. http://stackoverflow.com/questions/2689010/mootools-programmatically-fired-events-not-working-with-event-delegation - looks like mootools does not normalise and bubble native change events just yet. \n. please use the mail list. this is not a bug. your selector has returned null\n. it does support svg. you are calling methods on invalid element objects.\nmake sure your selector can return elements correctly before applying style\nchanges\nOn Saturday, 26 December 2015, Rustam Abdullaev notifications@github.com\nwrote:\n\nIf this is not a bug, what is it, then?\nMootools does not support SVG documents?\nThen this is a feature request.\nPlease reopen.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2761#issuecomment-167353228\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. +1 for slack*\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n\nOn 20 Jan 2016, at 18:47, Sergio Crisostomo notifications@github.com wrote:\nI'm fine with \"switching\" or at least \"adding\" https://gitter.im/mootools/mootools-core as a official communication channel.\n\u2014\nReply to this email directly or view it on GitHub.\n. lol, GH spam accounts? that's new... \n. that's a bit moot, though. when you install msysgit it asks you\nspecifically about line endings and picking \"leave as is\" seems like the\nonly solution that works cross platform as most Windows devs normally have\na Linux based CI\n\nOn Tuesday, 16 August 2016, Tim Wienk notifications@github.com wrote:\n\nThe steps you mentioned should indeed not be necessary, but I think I\nunderstand the issue now, so thanks for explaining.\nI assumed that you got the errors because the built file was ESLinted,\nwhich seemed awkward to me (since, like I mentioned, the built file should\nnot be ESLinted at all). However, you just confirmed that the errors occur\nduring the built itself.\nI'm fairly certain the problem is not with Grunt or ESLint, but with the\nway Git handles text files by default. Git's default setting of core.eol\n= native makes it so upon checkout text files are converted to use CRLF\nline endings in windows working directories, even if they use LF line\nendings in the repository. I'm sure this avoids a lot of problems when\nediting files, but it creates problems like these when enforcing\nconsistency within files.\nSo, instead of changing the ESLint settings, we should change the way Git\nhandles these files. There is a local way of doing this, using your local\nconfig, but instead I think we should add .gitattributes file to make\nsure it's done correctly everywhere.\nAdditionally, I think we should still add the grunt.util.linefeed = '\\n',\nso the built file won't have a mix of LF and CRLF line endings afte this\nchange.\nI've just pushed timwienk@cba3825\nhttps://github.com/timwienk/mootools-core/commit/cba3825 to my own\nrepository. Is it possible for you to test whether that fixes your issues?\nIf you're pulling the change to an existing clone of the repository, you\nwill have to re-checkout the files after pulling the commit so the line\nending change takes effect. From inside the repository, this should work:\ngit rm --cached -r *.js Grunt Source Specs\ngit reset --hard\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/mootools/mootools-core/pull/2770#issuecomment-240077750,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAHSzBAtWJ89V8xNoyaBubPKJeyWhyVeks5qgaF_gaJpZM4JjvL_\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. :+1:\nOn Tuesday, 16 August 2016, Tim Wienk notifications@github.com wrote:\n\nwhen you install msysgit it asks you specifically about line endings\nI see. I guess that question will set core.autocrlf accordingly.\nIn my commit I also set * text=auto in the .gitattributes file. That will\nmake it so that (independent of the core.aotocrlf value) all files are\nchecked out with CRLF line endings when core.crlf = crlf (or core.crlf =\nnative on Windows). From your comment, Dimitar, that seems to not be a\ngood idea.\nI've replaced my commit with timwienk@70afaa8\nhttps://github.com/timwienk/mootools-core/commit/70afaa8. That way it\nonly changes behaviour for JavaScript files: they will always be checked\nout with LF line endings.\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/mootools/mootools-core/pull/2770#issuecomment-240235748,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAHSzCcnYZd1kel9TiThx7551cmFrTceks5qgiPKgaJpZM4JjvL_\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. they are normalised events. see http://mootools.net/core/docs/1.6.0/Types/DOMEvent\n. lgtm :shipit:\nOn Thursday, 22 September 2016, Sergio Crisostomo notifications@github.com\nwrote:\n\nrelated #2771 https://github.com/mootools/mootools-core/issues/2771\nYou can view, comment on, or merge this pull request online at:\nhttps://github.com/mootools/mootools-core/pull/2772\nCommit Summary\n- correct link name from Event to DOMEvent\nFile Changes\n- M Docs/Element/Element.Event.md\n  https://github.com/mootools/mootools-core/pull/2772/files#diff-0 (2)\nPatch Links:\n- https://github.com/mootools/mootools-core/pull/2772.patch\n- https://github.com/mootools/mootools-core/pull/2772.diff\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/mootools/mootools-core/pull/2772, or mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAHSzJDn4KdzOb1sk654bhADDQoJCsEDks5qsuDMgaJpZM4KET2q\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. This related to: http://stackoverflow.com/questions/40186332/mootools-click-event-not-working-in-iphone-6 ?\nhttps://jsfiddle.net/1oymyddf/\nI am on iphone7 and using mootools 1.6, it fires correctly. \nhtml\n<!DOCTYPE html>\n<html>\n<head>\n  <script type=\"text/javascript\" src=\"//cdnjs.cloudflare.com/ajax/libs/mootools/1.6.0/mootools-core.js\"></script>\n</head>\n<body>\n  <script>\nwindow.addEvent('domready', () => {\n    alert('Done')\n});\n  </script>\n</body>\n</html>\nso, which version of MooTools do you use?\n. since support is not universal (IE10+) and some older versions need vendor prefixes, we probably cannot standardise the event universally enough for it to be part of mootools-core. As such, I think your code is fine as is (just put it in a closure) - or use something like this:\nhttps://github.com/ai/visibilityjs - which does several things, like fallback to blur / focus and hides the events name in case they need prefixing. \nunrelated. are you the solidsnek from QL? :D . I am not sure how this matters, you wouldn't cause recursion unless your class somehow extends itself...\nhttps://jsfiddle.net/f7qr6zfh/1/\nthis checks all subclassing examples under mootools and ES6 classes and works correctly. . Can you modify this - https://jsfiddle.net/opc0q95o/ - to show how you use the new Event constructor and how it affects mootools?. no, just compatibility with old MooTools API.\n-- \nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. the problem is if the event type gets converted to 2 (native) we'd have to support all the event namespace variants there are, as well as reasonably polyfill for older ones. . it worked fine iirc no issues. btw doing a document.createElement to pick property on the getter every time, should we not store the property prematurely? I can build a jsperf test case for the new getter if you like. will test IE when I get to office\n. @arian ++ go go go!\n. thanks so much! awesome. \n. excellent. thank you so much :)\n. this has broken Fx.Morph - https://github.com/mootools/mootools-core/blob/bd9275e325add7b7fa5e77f8d91c7a9918dc03ef/Source/Fx/Fx.CSS.js#L29 does not check if this.options.unit is != false first. result: cannot morph when values being morphed is defined as a string with unit like so: 100px. \nhttp://alpha.jsfiddle.net/YFrwa/1/\n. Sure, will add to our experimental backoffice dev branch tomorrow morning.\nMaybe in a fork of main app if i can get some sellenium ci time outside of\nmaster.\nOn Feb 9, 2012 7:52 PM, \"Olmo Maldonado\" \nreply@reply.github.com\nwrote:\n\n@DimitarChristoff, @stecb please give us a hand and test the master\nbranch with your code.\nHere are the instructions on how to build mootools:\nhttps://github.com/mootools/mootools-core/wiki/Build-MooTools-from-git-master\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2160#issuecomment-3894299\n. On 12/02/2012 23:59, Olmo Maldonado wrote:\nThanks for your understanding, and I'm excited to have you on board for the freezing period. At some point, we'll open it up for more volunteers but we'll use issue contributors to ping for testing.\nFor now please check the stability of 1.4.5dev and if any of your tests fail, please let us know. We should start trickling specs/tests from user space to dev. We'd like to release 1.4.5 some time this week.\nRegarding the fireEvent, could you please report it in another issue? I'd like for others to review it.\n\nHe does make a fair point, last 3 releases have had some unfortunate \nregressions that have totally taken upgrading out of the menu for us as \nwell as done little to instill confidence in mootools. Some fairly \ndisgruntled people here that I have to swing/win over again (but wish \ndidn't have to...)\nIs there scope for working with something like buster.js / sinon + \njstestdriver and doing some tests that we can go through, checking for \nregressions? I would be happy to help with this as much as possible - in \neither writing or in running them, probably even as a part of my day job \nas more stability in mootools will definitely help us...\nAnyway, on testing mootools-edge - I managed to talk our QA team into \nrunning through the apps on Friday in full and some CI / selenium time \nas well - not before then and before our weekly sprint/commitment is \nover, I am afraid. What is the release schedule / plan for 1.4.5? If \nit's not too late by then, let me know and I will make the spiked branch \nnow.\nI can - in the meanwhile - get it running on other sites - but they lack \nproper testing coverage so it will be reliant on me manually testing the \napps.\n. The jury on 1.4.5 nightly build is back.\n```\nUI acceptance test\n\nResult:     Tests passed: 349 \n```\nLooking good thus far but it's only on the front-end, will try backoffice as well. Tomorrow QA will spend an hour on it or so. \n. QA have also finished testing for 3 hours, no application regressions were found in: IE7, IE9, FF (latest stable), Chrome (latest stable). \nThis does not by any means guarantee 1.4.5 is going to be bug free, particularly when you consider we referenced a mootools-more from 1.4.1 - though it's stable enough that we'd consider moving to it within a week or so after general release. I am saying it so it's not on us if things are wrong again - the business is puzzled by the need to contribute back into mootools as it is - though they have come to accept the clear benefits of a stable release we can use.\nthanks to @agillborn and @obray for their hard work.\n. oh, very cool. \njavascript\n/*<ltIE9>*/\ndelete Element.NativeEvents.propertychange;\ndelete Element.Events.change;\n/*</ltIE9>*/\ndoes not fix my issue, in fact, it makes intended change events really unpredictable. is the bug to do with the fact that radios and checkboxes don't really fire a change but a propertychange instead? hence, the bug is in the condition which fires a change on any propertychange event, as long as the this.checked is true. \n. yep. anything you d that does a propertychange fires the change event. http://jsfiddle.net/5CvBb/7/ with a .set(\"data-attrib\") does it too. \n. erm. fixed though I am not sure how 'safe' it is. \njavascript\n return !!((this.type != 'radio' || this.checked) && event.event.propertyName == 'checked');\n. @ibolmo please consider https://github.com/DimitarChristoff/mootools-core/commit/6abff54d7586d691454d915fe49e60204cc844d2 instead as it was the only safe-ish option that did not break normal input[type=text] change, read https://github.com/mootools/mootools-core/pull/2172#issuecomment-3123570\n. no, I am actually checking this atm for breakages on other input types which will likely fail.\n. actually. this causes errors. \nreturn !!(event.type === 'change' || event.type === 'propertychange' && event.event.propertyName == 'checked') \nworks for all elements and change is fine. http://jsfiddle.net/5CvBb/23/ - however, it fires a change event on a radio group sharing the same name to all elements that experience propertychange of checked. not sure if this is the accepted dom model. \ncommit / sha:\nhttps://github.com/DimitarChristoff/mootools-core/commit/6abff54d7586d691454d915fe49e60204cc844d2\nlet me know if i should make a new pull request.\n. because it broke change for input[type=text], i can dig out the jsfiddle that did this but it's been a lot... \n. this fixes it so it only fires the change once per radio group:\nreturn !!(event.type === 'change' || this.checked && event.type === 'propertychange' && event.event.propertyName == 'checked')\nhttps://github.com/DimitarChristoff/mootools-core/commit/53b0dc59224de3743c1c529f9856f6898c7023c7\nit also does one less property lookup due to base which already has read the type and set the event accordingly. \n. i haven't got the test/spec runner or repo at home (windows), will do tomorrow morning at work - just tested IE7 and IE8 so far, don't even have an IE6 VM\n. @arian that spec file is out of date, it references Type/Event.js not DOMEvent.js. fixed here: https://github.com/DimitarChristoff/mootools-core/commit/6c8f004eae265d0c2ac885e3c4d5af62094e9db6\ntests pass, btw - at least on IE9 in IE7 and IE8 doc mode (forced). if you want to try it's here http://fragged.org/dev/mootools-core/Specs/1.4client/Element/Element.Event.change.html\n. to be fair, there are certain implications with this in general, browsers deal with type changing differently. eg, input[type=password][value=foo].set(\"type\", \"text\") - should it really keep the value? not to mention this will actually fire an exception in Ie6/7/8. consider input[type=text][value=c:\\autoexec.bat].set(\"type\", \"file\")\n. @jiggliemon nah, on that last fiddle, remove mootools and watch output -> no difference. \n. I don't at all like the idea that an error in props values is being swallowed. It is useful to get exceptions. Eg case:\nelement.setStyle('overflow-x', 'none'); // throws in IE\nIf the above just swallows it, it won't account for behaviour of element failing to change. \nThe obvious case here is undesired elastic transition loops through negative values which older versions of IE do not accept, for instance, height cannot be negative\nWorkaround can simply be try/catch block around your animation, not the setter\ni'd label this bug as won't fix and close it for now. \n. this is still not quite right. http://jsfiddle.net/dimitar/357Lt/ -> a data-propertyId is arguably wrong as HTML5 validation prefers all data- properties to be lowercase (W3C spec does not say anything in particular about their casing). \nBrowsers seem to adjust the element and fix attributes to lowercase but IE6/7/8 do not. \nanyway: in IE7/8, .get('data-propertyid') - which is correct from a getter stand point as it SHOULD be lowercase - returns null though .getAttribute('data-propertyid') returns the value, despite of the element markup having data-propertyId. \nbasically, i guess I am saying: expect .get(\"data-Something\") to return .getAttribute(\"data-Something\"); in IE6/7/8 - or any camel cased / uppercased attribute, data or otherwise. \nsomething that will probably fix it is:\nhttps://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L652 to convert to lowercase to match the whitelisted prop above at https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L648 and where it is being allowed https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L658\n. the reason I created it was to mimic something that is available in jquery already (since 1.4.3): http://api.jquery.com/data/#data-html5 - whereas I don't use jquery - ever - I thought this could be useful and at least for mootools-more Element.Extras it should be fine... \n. https://github.com/mootools/mootools-core/issues/2160 - see comment below.\n. oups looks like a duplicate. \n. no it returns the property value as it should\n. Element.properties - i thought of it then how would you really know if what you read was intended or not? it's also broken in jquery. http://jsfiddle.net/cd2Am/9/ - i don't think it can be fixed easily, though go ahead :) \np.s. this is closed, i submitted it w/o meaning to before it was ready so it saved it twice, see the one ibolmo has referenced\n. this looks like a Slick issue rather than anything else. \nalert(document.getElements('input#Q1').length); -> 0\ninput[id=Q1] -> 1\nhttp://jsfiddle.net/rmgVM/7/ - tested on native ie7 - testing this in IE9 in IE7 mode does not produce the bug. \nping @fabiomcosta\nhttp://jsfiddle.net/dimitar/rmgVM/11/ - it looks like the id is correctly removed there. and it's not caused by the invalid markup in the original jsfiddle either. \n@karolis-k a few things.\n```\nvar q1 = $('Q1');\nq1.clone().replaces(q1);\n// use the correct selector for id:\nalert($$('input#Q1').length); // 0\n``\n. sorry it is not Slick. Sizzle also finds 1 element withinput[id=Q1]` after mootools clones. http://jsfiddle.net/rmgVM/16/\nBeen looking at it with @kentaromiura and he reckons it looks like it is specific to id and does not fail if you remove the id attr of the copied element. something that has yet to work for me. \n. this does not fix it even though the request fires before the xhr.open, the function does not actually update the DOM until the response arrives. \n. can you build a jsfiddle with this? http://jsfiddle.net/pywWb/ works fine (IE9 in IE7 mode, though). what doctype do you have? do you have valid markup that validates?\n. really? I tested this a fair bit and it does NOT seem to contain expando attributes. http://jsfiddle.net/wXCSx/2/show/ in IE9 in IE7/8 mode and IE7 native, the only attributes it has are the ones I expected to see. will you be kind enough to show me a case where this happens (for my own learning purposes, forget about fixing/changing it).\n. http://www.quirksmode.org/dom/w3c_core.html#attributes warnings there are primarily against the use of the indexed array but the NamedNodeMap one should be safe-ish to use. jquery use that a fair bit and their .data api is entirely reliant upon it. did they drop support for ie6?\n. Doesn't Firefox support this natively now? And it's kind of broken? Mootools will only abstract and base this on mouseover/out if 'onmouseenter' in document.documentElement is false\n. They ripped off SO - orig here:\nhttp://stackoverflow.com/questions/10182381/mootools-event-causes-infinite-loop-in-ie7-ie8-\nits what prmpted me to raise the bug.\nOn Apr 19, 2012 7:33 PM, \"Arian Stolwijk\" \nreply@reply.github.com\nwrote:\n\nAlso here is another problem described, when you change input.checked in\nthe change event:\nhttp://allbtechebooks.blogspot.com/2012/04/mootools-event-causes-infinite-loop-in.html\n/cc @csuwldcat\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2352#issuecomment-5228734\n. wouldn't that only matter if you don't use .send() and go .get / .post etc anyway? otherwise, this.options.method will be true. you can just rubberstamp it here by re-implementing these methods: https://github.com/mootools/mootools-core/blob/master/Source/Request/Request.js#L234-243. why is it important to know the method AFTER the response? anyway, it's so trivial - http://jsfiddle.net/dimitar/yVbYQ/3025/\n. then refactor .send to leave a reference to the last local options.method - to be honest, I don't think this will be a bad change, although I can't see many uses besides RESTful model updates with a common event handler (for example).\n\ni would definitely prefer the options object passed to send not to be overriding the default options options permanently by merging into  this.options - if you want to do this, just .setOptions(newobj).send()\n. what is your use case? prototypejs don't encode keys either - https://github.com/sstephenson/prototype/blob/master/src/prototype/lang/hash.js#L289 \n. you can fix that - it's because \"\" is falsy and 0 is not a string. \nhere's the case: http://jsfiddle.net/wbPh9/3/\nfix is: https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L1027\nbecomes: if (optionValue === String(value)) return option.selected = true;\nas a quick workaround for @angelsk, do $('hour').set('value', '0'); which is fine. \n. will do a pull request and add a test case here https://github.com/mootools/mootools-core/blob/master/Specs/1.4client/Element/Element.js#L58\n. Close pls\n. IE 6 and 7 don't actually support that, I thought? http://caniuse.com/#search=object \nAnd as for IE8, support is dodgy as far as I know. http://blogs.msdn.com/b/ie/archive/2008/04/10/html-and-dom-standards-compliance-in-ie8-beta-1.aspx - scroll down to known issues re parsing of the object tag\n. also works for me. \n. it's not an issue with the native mouseenter/leave implementation. http://jsfiddle.net/dimitar/KemYP/6/ - when attached directly to the tr, it's all good. I'd say that's a bug, though it may be implementation specific. 1.4.1 moved delegation over to -core but i can't remember at what point mouseenter/leave were fixed to work with delegation\n. thats the point though. the native event by firefox, assigned to the TR directly, does not fire mouseleave as you'd expect. only happens on the delegated one. @arian what of this map? https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Delegation.js#L30-36\n. this is not a bug. you can have unlimited multiple event callbacks for the same event.\n```\ninstance.addEvent('test',  function() {\n    console.log('1');\n});\ninstance.addEvent('test',  function() {\n    console.log('2');\n});\ninstance.addEvent('test',  function() {\n    console.log('3');\n});\ninstance.fireEvent('test'); // 1... 2... 3...\ninstance.removeEvents('test');\ninstance.addEvent('test',  function() {\n    console.log('4');\n});\ninstance.fireEvent('test'); // 4\n```\nsame thing applies to events with elements. setOptions is just an interface that calls the addEvent for you. \n. yeah when I tried it at the top of the function, it failed another test. put it right before the loop now and it passes all specs. \n. this is not a bug but is due to the way objects as properties get referenced\nhere is an example to show you the connection between objects passed to constructor, what goes on the prototype and what goes to instance.\n```\nvar o = {\n    left: \"blue\"\n};\nvar foo = new Class({\n    eyes: o,\n    getLeft: function() {\n        console.log(this.eyes.left);\n    }\n});\nvar instance = new foo();\ninstance.getLeft(); // blue; \n// change the original object\no.left = \"brown\";\ninstance.getLeft(); // still blue\n// change it in the constructor \nfoo.prototype.eyes.left = \"brown\";\ninstance.getLeft(); // brown now.\n```\nhttp://jsfiddle.net/n8DPw/\na perfect example would be if you did console.log(Object.keys(this.eyes)); - which should produce nothing due to hasOwnProperty check. Doing Object.clone() will derefrence the link and make it all work. \na pattern to go around that is to do in your initialize:\nthis.eyes = {\n           leftHead: 4,\n           rightHead: 4,\n           topHead: 2\n        };\nthis will make it a local object to the instance and all your tests will pass. or do this.eyes = Object.clone(this.eyes); to dereference it \n. in all fairness, yes, http://mootools.net/docs/core/Element/Element#Element:empty is probably a bit vague. as a whole, it would be awesome if methods could be linked to a line on github where the source can be seen. in the meanwhile, if you feel that you can improve on the current documentation, here is the file: https://github.com/mootools/mootools-core/blob/master/Docs/Element/Element.md#element-method-empty-elementempty - fork, clone, make a branch quoting this issue, edit/update, test, push, send pull request.\n. i like it. \n. 953f6c4c9581fd7755d656b1ece4ab2578262aab\n. here's a simple test case:\nhttps://tinker.io/d3524/2\nand yes, Request.JSON adds X-Request: 'JSON' so it won't work for that either, unless you delete that header as well.\n. seems related to focus. for example, this works on keypress -> http://jsfiddle.net/qSCvc/5/ so it may be down to event types... \n. in my chrome on osx, it fails to remove the focus:relay event - though I originally discovered it on Firefox nightly (Aurora). \n. Yeah, I know I can work around that in principle. And I have. \nisSuccess is being used and promptly ignored in the .send, which it probably shouldn't be. Using 2 instances - one for getting stuff when you expect data, one for when you don't - is not scalable. especially if you reuse the same request instance to avoid rogue requests and race conditions.\nI still think this particular use case needs to be handled separately. \nhave a look at an implementation that is not very different from mootools'\nhttps://github.com/ded/reqwest/blob/master/src/reqwest.js#L159-205\nin particular:\nvar r = resp.responseText\n      if (r) {\n...\nand yes, then if there IS a responseText that can't make an object when content type is json, fire error. It's a very small shift in logic... \n. if you re-use the same instance eg. this.r = new Request.JSON({link:'chain'}); you can't be swapping it when you think you may get a no-content response. reusing in order to avoid event-driven updates to run out of sequence by creating their own request instances and resulting in state of client being out of sync due to latency. anyway, that's besides the point.\ncloser to home. @kamicane agent. https://github.com/kamicane/agent/blob/master/lib/agent.js#L255-258 - it does not try to guess if the decoder has done its job. it does not try to fire an onSuccess/onFailure for you. it lets you decide for yourself in the callback fn by giving you the right data. \nall i am proposing is that this be considered:\njavascript\n            if (text && (json == null && this.status != 204)) this.onFailure();\n            else this.onSuccess(json, text);\nthink about it. onSuccess should mean the request was successful and not 'the request was done and so was the creation of an object from whatever response got sent our way'. \nthis is an edgecase that will only affect no content and empty responses, which is also annoying when no response is warranted. \n. I guess the shift in philosophy across the board in all XHR implementations out there is that there is no need to subclass in the first place as you react to the content-type instead and deal with whatever is being returned. you cannot say that the convenience this affords vs. the implicit expectation of something to arrive in a particular way is not a better idea. My woes here are not because I don't know what I will get, \nit's because I rely on Request to handle Epitome model sync and as a framework, it needs to be as flexible as possible, given that you cannot guarantee what will come down the wire.\n. seems cool. i like it. :+1:  still, you can easily create your own Request subclass with this func in. it seems like too much of an edgecase \n. this is - to the best of my knowledge - not only related to memory leaks created by circular references in IE - but it is to speed up access of any stored values so it works from memory as opposed to DOM access. \nalso, mootools uses storage internally - eg. all element events callbacks get added into storage etc. - you wouldn't want to store potentially huge event callback stacks or validators or Fx instances or any other data onto the actual element w/o a closure, potentially opening all that up to anyone that can access the DOM and making them enumerable. \nsee https://github.com/jquery/jquery/blob/1.9-stable/src/data.js - jQuery storage also uses jQuery.cache and not actual element objects.\nit's fair enough that you may want to GC a container by destroying all child nodes so that all storage etc is cleaned up - but this is really implementation-specific in my opinion and does not outweigh the needs of most people. \n. does not really matter, I don't care what the output is or why primitive\nvalues do not come back as keys. just posted the bug as per the SO question\nafter talking to @kentaromiura on IRC. close it.\nOn Monday, March 3, 2014, Olmo Maldonado notifications@github.com wrote:\n\nI'm sure I'm just running by this too quick, but I totally don't know what\nyou'd like to happen :). Could you provide me with a table or even better a\ncouple of failing specs showing what to expect?\n\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2544#issuecomment-36572239\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. no we spoke about this 3 months ago. today was nothing to do with mootools\nand not a new issue or an issue as such anyway.\nOn Monday, March 3, 2014, Cristian Carlesso notifications@github.com\nwrote:\n\nmmm wait, this is not what we talked about today, the issue you found\ntoday was that var key in object is not sequential, and that's by spec.\nthis is a different thing imho\n\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2544#issuecomment-36573509\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. the guy :+1: \n. it's not up to me but my opinion also is that this should not be in core. implementing is trivial to do via extending existing Events class and this is not something that needs to be in core imo. \nhttp://jsfiddle.net/dimitar/Qfd3f/ for example, simple mute/unmute that renames the event key and then moves it back. simple but it does the same effect w/o adding 2 more methods to every class's prototypes. if you extend Events, EVERY single mootools user that has a class that implements it will get disableEvent, enableEvent and $disabledEvents plus the extra time to check if an event is disabled each time something fires. as such, it's not something that I would like to see in mootools, but like I said, it's not up to me :) \nthis can lead to some anti-patterns with encapsulation. eg.\n- class A fires change, works as model\n- class B listens for A:change and renders\n- class C listens for A:change and renders\n- class B does a.disableEvent because it does not want to render temporarily\n- class A fires change but class C also does not get it\nthe disabling probably needs to be per bound callback for it to be safe, otherwise, you are better off unsubscribing and resubscribing. you can also debounce the callbacks or use event pseudos like :once. many alternatives... \nthis could go in the mootools-community edition thing that is (maybe) happening. \nother than that, interesting pull request. I have modded my events class to be more like backbone's - with listenTo and stopListening, but suspending events temporarily may be a useful feature. one thing - it's probably more likely to land if there are tests for it :)\n. I'd personally favour not changing the event class prototype itself but subclassing it.\njavascript\nvar BetterEvent = new Class({\n    Extend: Events,\n    $disabled: {},\n    fireEvent: function(type){\n        if (something) return this;\n        return this.parent(arguments);\n    }\n});\netc etc. this way you mixin the better events class when needed and normal events when not. \nas for performance, It normally is not a problem - until you start building things like currency pairs etc that update 3-4 times a second and rely on events to fire. only noticed perf issues then - my class looked like this: https://github.com/epitome-mvc/Epitome/blob/master/src/epitome-events.js - which is arguably much worse but the aim was mostly func. \n. erm. maybe make a event:debounce(ms) pseudo. there are\nstandard/expected patterns for this sort of thing--maybe set the debounce\nms as a variable you can change, 0 being default to not wait normally.\nOn Monday, May 19, 2014, Olivier Laviale notifications@github.com wrote:\n\nI understand that. The way I use it is to suppress 20 change events\u2014while\ncriteria are reseted\u2014to fire a single change event, after the reset is\ncomplete. In a sense, the change events are not lost, but rather\naggregated. My proposal was a simple solution, but it looks like simple\nsolutions are not always good solutions :)\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2595#issuecomment-43479272\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. looks like a win. :) :+1: \n. cool and meh. close and mark as 'wont fix' for future reference. \n. I will scrape something together and add test and document it in the md.\nOn Friday, October 31, 2014, Olmo Maldonado notifications@github.com\nwrote:\n\nor HTTPOnly\nOn Fri, Oct 31, 2014 at 9:40 AM, Arian Stolwijk notifications@github.com\n\u0002amp\u0003#106;\u0002amp\u0003#97;\u0002amp\u0003#118;\u0002amp\u0003#97;\u0002amp\u0003#115;\u0002amp\u0003#99;\u0002amp\u0003#114;\u0002amp\u0003#105;\u0002amp\u0003#112;\u0002amp\u0003#116;\u0002amp\u0003#58;\u0002amp\u0003#95;\u0002amp\u0003#101;\u0002amp\u0003#40;\u0002amp\u0003#37;\u0002amp\u0003#55;\u0002amp\u0003#66;\u0002amp\u0003#37;\u0002amp\u0003#55;\u0002amp\u0003#68;\u0002amp\u0003#44;\u0002amp\u0003#39;\u0002amp\u0003#99;\u0002amp\u0003#118;\u0002amp\u0003#109;\u0002amp\u0003#108;\u0002amp\u0003#39;\u0002amp\u0003#44;\u0002amp\u0003#39;\u0002amp\u0003#110;\u0002amp\u0003#111;\u0002amp\u0003#116;\u0002amp\u0003#105;\u0002amp\u0003#102;\u0002amp\u0003#105;\u0002amp\u0003#99;\u0002amp\u0003#97;\u0002amp\u0003#116;\u0002amp\u0003#105;\u0002amp\u0003#111;\u0002amp\u0003#110;\u0002amp\u0003#115;\u0002amp\u0003#64;\u0002amp\u0003#103;\u0002amp\u0003#105;\u0002amp\u0003#116;\u0002amp\u0003#104;\u0002amp\u0003#117;\u0002amp\u0003#98;\u0002amp\u0003#46;\u0002amp\u0003#99;\u0002amp\u0003#111;\u0002amp\u0003#109;\u0002amp\u0003#39;\u0002amp\u0003#41;\u0002amp\u0003#59;\nwrote:\n\nI would accept a pull request.\nIt's basically just adding\nif (this.options.HttpOnly) value += '; HttpOnly';\nOnly question is whether it should be HttpOnly or httpOnly...\n\u2014\nReply to this email directly or view it on GitHub\n<\nhttps://github.com/mootools/mootools-core/issues/2664#issuecomment-61269814>\n.\n\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2664#issuecomment-61272225\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. is build error badge my doing? grunt tests passed\nOn Tuesday, November 11, 2014, Arian Stolwijk notifications@github.com\nwrote:\n\nClosed #2664 https://github.com/mootools/mootools-core/issues/2664 via\n2676 https://github.com/mootools/mootools-core/pull/2676.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2664#event-191317083.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. seems as if it's failing in opera as it lacks support. according to search\nit's been supported since opera 9.50 but that predates their move to\nWebKit.\nOn Tuesday, November 11, 2014, Dimitar Christoff christoff@gmail.com\nwrote:\n\nis build error badge my doing? grunt tests passed\nOn Tuesday, November 11, 2014, Arian Stolwijk notifications@github.com\n\u0002amp\u0003#106;\u0002amp\u0003#97;\u0002amp\u0003#118;\u0002amp\u0003#97;\u0002amp\u0003#115;\u0002amp\u0003#99;\u0002amp\u0003#114;\u0002amp\u0003#105;\u0002amp\u0003#112;\u0002amp\u0003#116;\u0002amp\u0003#58;\u0002amp\u0003#95;\u0002amp\u0003#101;\u0002amp\u0003#40;\u0002amp\u0003#37;\u0002amp\u0003#55;\u0002amp\u0003#66;\u0002amp\u0003#37;\u0002amp\u0003#55;\u0002amp\u0003#68;\u0002amp\u0003#44;\u0002amp\u0003#39;\u0002amp\u0003#99;\u0002amp\u0003#118;\u0002amp\u0003#109;\u0002amp\u0003#108;\u0002amp\u0003#39;\u0002amp\u0003#44;\u0002amp\u0003#39;\u0002amp\u0003#110;\u0002amp\u0003#111;\u0002amp\u0003#116;\u0002amp\u0003#105;\u0002amp\u0003#102;\u0002amp\u0003#105;\u0002amp\u0003#99;\u0002amp\u0003#97;\u0002amp\u0003#116;\u0002amp\u0003#105;\u0002amp\u0003#111;\u0002amp\u0003#110;\u0002amp\u0003#115;\u0002amp\u0003#64;\u0002amp\u0003#103;\u0002amp\u0003#105;\u0002amp\u0003#116;\u0002amp\u0003#104;\u0002amp\u0003#117;\u0002amp\u0003#98;\u0002amp\u0003#46;\u0002amp\u0003#99;\u0002amp\u0003#111;\u0002amp\u0003#109;\u0002amp\u0003#39;\u0002amp\u0003#41;\u0002amp\u0003#59; wrote:\n\nClosed #2664 https://github.com/mootools/mootools-core/issues/2664 via\n2676 https://github.com/mootools/mootools-core/pull/2676.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2664#event-191317083.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. I've asked Bruce Lawson to clarify.\nOn Tuesday, November 11, 2014, Tim Wienk notifications@github.com wrote:\n\nIt seems Opera doesn't pass your added test.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2664#issuecomment-62529745\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. Could change https://github.com/mootools/mootools-core/blob/master/Specs/Utilities/Cookie.js#L36 to:\nvar val = Cookie.read('http-key'),\n    assertion = (Browser.name === 'opera'  && vers...) ? 'toEqual' : 'toBeNull';\nexpect(val)[assertion]('value');\nthis is not ideal / future proof as they may fix it... and have historically supported it in the past. - https://www.owasp.org/index.php/HTTPOnly\n. nah better way\n```\nvar obj = {\n    cookie: ''\n};\nCookie.write('foo', 'bar', { httpOnly: true, document: obj });\nexpect(obj.cookie.indexOf('HttpOnly')).not.toBe(-1);\n``\n. had to go to constructor direct becausesetOptionsderefrences the document object passed and value cannot be compared directly,Cookie.writedoes not return the instance either. \n. i did do this on my fork some time ago, it's not exactly hard. :+1: \n. not for -core, imo. there are plenty of classes around that abstract storage and can be used as standalone API, namespacers etc -- or as mixins.\n.new Element('foo')constructor handles custom elements fine, what do you mean? passes todoc.newElementwhich does not discriminate and goes todoc.createElement. - removing thecamelCaseis breaking, :-1: - code in the wild references properties in the stupidest way possible, mix of scripting, CSS styles, prefixes etc. although I agree this is going to help, it will break people's apps. perhaps can be protected by compat mode.\n- rounding :+1: - for https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L125 - though sub pixel rendering is fine, this code path only gets hit if you fail to specify your own unit so it needs to revert to the map - or you are passing an array of multiple values. you can get more performance avoiding the lookup and rounding by just adding the units yourself. the other usecase https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L128 is actually hit when you pass in your own string that's just a number, egString(300.5)would turn to 301, not sure why is is being done--somebody would know. arguably again, if you pass300.5px, you will hit the fastest code path where it does not have to do anything once it determines it's a string that does not coerce to number and will just set the style property. \n-Element.Stylescould use arrays indeed, and that will help - but it's going to break stuff again due to a lot of code that adds to the styles collection for custom property parsing, animating transitions and CSS3 props mootools does not 'know about'. Right now you can add custom parsers by simply doingElement.Styles.textShadow = '@px @px @px @'; document.getElement('.foo').setStyle('text-shadow', [2, 2, 2, 'red']);- in the new syntax, this would be more like['@px', '@px', '@px', '@']which is slightly awkward -Array.from(value)` is a little defensive and can probably go. caching and pre-emptive split is not an option that will work very well due to late adding of element styles. your gain will be lost by looking to see if the cache is populated or splitting afresh after... \nto be honest you don't need to maintain your own version of mootools for this - just add Element.prototype.css = function(key, value) { .. your faster one } and use it like jQuery. If you change styles all the time you are probably animating - and if performance is your concern, look at velocity.js as it is cleaner and perf-centric style changes / tweens\n. @arian probably el.clone().dispose() - though that's kind of pointless given that clone does not add a parentNode anyway. \nhttps://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L959\nsuggest close.\n. :+1: for debounce. \n. base of click won't work with <label>, I don't think. \n. technically, it's not a polyfill as MooTools' bind pre-dates the standardisation of Fn.proto.bind \nbecause of that, it differs. it's now a protected method but for compat's sake, it can also remain broken :)\nplease see https://github.com/mootools/mootools-core/issues/2473 - just stop using the compatibility build version of mootools. \nhttps://jsfiddle.net/dimitar/z1f12s6p/1/ - your fiddle with the right version of mootools (https://ajax.googleapis.com/ajax/libs/mootools/1.5.1/mootools-nocompat-yui-compressed.js) \n. this won't scale as you can override scrollbar widths on a per-element basis based upon cascading styles.\neg. \n```\n::-webkit-scrollbar {\n    width: 7px;\n    height: 7px;\n}\n.dark ::-webkit-scrollbar {\n    width: 12px;\n    height: 12px;\n}\n```\n... which means you can only truly measure scrollbar width on an element by injecting exactly where the element is (hopefully not in conflict with n-th child selectors)... I'd write this as a plugin or possibly mootools-more - extending http://mootools.net/more/docs/1.5.1/Element/Element.Measure \n. it's a bad practice to store non primitives in the prototype as they are not immutable and can introduce nasty side effects by reference if instances modify them. \n. ... the notable exception being options which is handled correctly via the setOptions mixin.\n``` javascript\n\nrequire('mootools');\n{}\nvar C = new Class({ options: { bar: 1 }, Implements: [Options], initialize: function(options){ this.setOptions(options); console.log(this.options); }});\nundefined\nnew C\n{ bar: 1 }\n{ options: { bar: 1 },\n  '$caller': null,\n  caller: null }\n```\n\nhaving said that, it's not ideal that it differs in node to browser behaviour.\n``` javascript\nvar C = function(){ console.log(this.foo); };\nundefined\n\nC.prototype.foo = { bar: 1 };\n{ bar: 1 }\nnew C\n{ bar: 1 }\n```\n\nHad similar issues with primish - but it's working ok but it's dangerous:\n``` javascript\n[:/Users/coda/projects/test] $ npm i primish\nprimish@0.3.9 node_modules/primish\n[:/Users/coda/projects/test] $ node\n\nvar p = require('primish');\nundefined\nvar C = p({ foo: { bar: 1 }, constructor: function(){ console.log(this.foo); }});\nundefined\nnew C\n{ bar: 1 }\n```\n. you can use document.write in jsfiddle, don't tell zalun.\n\n```\nvar w = 'write', d = document;\ndw;\n```\njust set the script block to in body.\nOn 22 April 2015 at 21:40, j3zusla notifications@github.com wrote:\n\nI am loading mootools via document.write:\ndocument.write(\"\");\nSorry, I am not able to simulate the error with jsfiddle: \"document.write\nis disallowed in JSFiddle envioriment and might break your fiddle.\" (the\nspelling error for environemnt is from the site itself ;) )\nI could give you the live site if you are not able to reproduce the issue,\nbut I prefer to keep it private to community for now. Thank you for your\nunderstanding and help,\nCordially,\nJFSG\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2712#issuecomment-95328259\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. are you animating/revealing on load?\nyou've tried the obvious here (cache)?\nhttp://stackoverflow.com/questions/19275088/in-google-maps-getboundingclientrect-gives-unspecified-error-in-ie\nthis can normally happen if you measure dimensions (getSize() etc) of an\nelement that's not in the DOM and has no layout, or you've morphed\nsomething like height or width to a negative value.\nOn 22 April 2015 at 22:30, j3zusla notifications@github.com wrote:\n\nSoz, I have no luck duplicating the issue on fiddle. I have tried to\ninclude the lib via Fiddle external function and it is all fine on I.E. It\nmust be a code conflict between libs. I have no choice but to give you the\nlive url. Can I send it in private somehow?\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2712#issuecomment-95343739\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. yeah here's how to reproduce it easily in IE:\nhttp://jsfiddle.net/q5mxu4y2/\nall it takes is: new Element('div').getPosition();\npretty sure we discussed this a while ago and a try / catch block around it\nthat returns { top: this.offsetTop, left: this.offsetLeft } instead.\nOn 22 April 2015 at 22:38, Dimitar Christoff christoff@gmail.com wrote:\n\nare you animating/revealing on load?\nyou've tried the obvious here (cache)?\nhttp://stackoverflow.com/questions/19275088/in-google-maps-getboundingclientrect-gives-unspecified-error-in-ie\nthis can normally happen if you measure dimensions (getSize() etc) of an\nelement that's not in the DOM and has no layout, or you've morphed\nsomething like height or width to a negative value.\nOn 22 April 2015 at 22:30, j3zusla notifications@github.com wrote:\n\nSoz, I have no luck duplicating the issue on fiddle. I have tried to\ninclude the lib via Fiddle external function and it is all fine on I.E. It\nmust be a code conflict between libs. I have no choice but to give you the\nlive url. Can I send it in private somehow?\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2712#issuecomment-95343739\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. so stop trying to measure layout before injecting into the dom then or put\nthe try/catch around where you do it. we could fix getPosition to do it,\njquery have done--but it's kind of a nasty fix for an edgcase where it's\nuser error.\nOn Wednesday, April 22, 2015, j3zusla notifications@github.com wrote:\n\nYes DimitarChristoff, this is the issue I am getting!\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2712#issuecomment-95349894\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. one use case that you may have is like. new\nElement(\"foo\").makeDraggable() from more uses .getPosition() - if so, just\nnew Element('div').inject(someEl).makeDraggable()\nin general, set some breakpoints and step through your code to find the\noffending bit/plugin\nOn Wednesday, April 22, 2015, j3zusla notifications@github.com wrote:\n\nok, I will back track and see where it gets called. I made sure to call\nwhat is needed on domready. It will give me the chance do a cleanup then!\nHey DimitarChristoff plz, don't use jq word anymore, it gives me the\ncreeps everytime ;)\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2712#issuecomment-95352372\n.\n. you are calling it on a HTMLElement collection which is an array which is an object with array like properties like length. \n\nalso this is handled by the browser natively in modern browsers. please ask questions on the mailing list instead, this is not an issue. \n. this is useful but I don't think the api is consistent.\nI'd go for args of fn, delay, context= to be more like .delay - don't like\na config object.\nlodash keeps it simple by just first two\nOn Friday, June 5, 2015, Sergio Crisostomo notifications@github.com wrote:\n\nNew feature suggestion: Function.debounce.\n(related: #2694 https://github.com/mootools/mootools-core/issues/2694)\nThis method will return a new function that will be called only once per\ngroup of close calls. After a defined delay it will be abble to be called\nagain.\nSyntax:\nvar debounceFn = myFn.debounce({delay: 100});\nArguments:\n1. obj - (mixed) If this argument is a number it will use it as the\n   delay timeout of the debounce. If this argument is a object it will\n   allow more specific configuration. Leaving the argument empty will fall to\n   default values.\nReturns:\n- (function) A debounce function that will be called only once per\n  group of close function calls.\nOptions:\n- delay - The delay after which the debounce function is called.\n  Defaults to 250ms.\n- early - If true will call the function in the beggining of each\n  groups of calls. Defaults to false.\n- once - If true will call the function only once per event\n  handler. Defaults to false.\nSpecs fiddle: http://jsfiddle.net/tcuzgeb1/\nhttp://jsfiddle.net/tcuzgeb1/\nSimple demo: http://jsfiddle.net/m3v56e7u/\nhttp://jsfiddle.net/m3v56e7u/\nComments are welcome.\nIf you think this is not suitable for Core let me know too.\nYou can view, comment on, or merge this pull request online at:\nhttps://github.com/mootools/mootools-core/pull/2720\nCommit Summary\n- add Function.debounce\nFile Changes\n- M Docs/Types/Function.md\n  https://github.com/mootools/mootools-core/pull/2720/files#diff-0\n  (50)\n- M Source/Types/Function.js\n  https://github.com/mootools/mootools-core/pull/2720/files#diff-1\n  (25)\n- M Specs/Types/Function.js\n  https://github.com/mootools/mootools-core/pull/2720/files#diff-2\n  (231)\nPatch Links:\n- https://github.com/mootools/mootools-core/pull/2720.patch\n- https://github.com/mootools/mootools-core/pull/2720.diff\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/pull/2720.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. you could use modernizr or has.js.\nOn Saturday, June 27, 2015, Sebastiaan notifications@github.com wrote:\n\nI would very much like to see Browser.Features.input implemented as an\narray of supported inputs.\nReturns:\n['text','button','checkbox','number','color','date','datetime','time',..]\nFor an easy way to check if the browser supports advanced html5 input\ntypes like:\n- color\n- date\n- datetime\n- datetime-local\n- email\n- month\n- number\n- range\n- search\n- tel\n- time\n- url\n- week\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2725.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. these are internal handlers\nhttps://github.com/mootools/mootools-core/blob/master/Source/Request/Request.js#L106-L116\nI would probably prefer to have the this.fireEvent('complete')\nindependent, preceding this line:\nhttps://github.com/mootools/mootools-core/blob/master/Source/Request/Request.js#L82\nOn 25 August 2015 at 22:08, Tin LE GALL notifications@github.com wrote:\n\nHi there\nI develop a mobile app with a\ncontroller > view architecture combined with asynchronous AJAX requests.\nIn order to avoid memory leaks, in destroy current controller and view\n(DOM) when the user switch back to a previous view ([back] button ...)\nMy onSuccess method uses to update the view depending on data retrieved\nfrom the AJAX call and that's why I don't want it to be executed if the\nuser left this view cause it's not surprisingly generating javascript\nerrors ...\ntests I have to do are always the same and that's why i didn't want to put\nthem in each of my onSuccess methods (many) since I have an onComplete\nmethod which is common to all my requests.\nThen here is what I do:\nonComplete: function(e)\n{\n         if(my tests are not OK) {\n                this.removeEvents().setOptions({timeout:0}).cancel();\n                return;\n         }\n         ...\n         few other things if tests are OK\n         ...\n}\nThis is working correctly (onSuccess method is not executed) if the user\nswitch back fast enough on the previous view ([back] button) but not if he\nwaits to long (like 0.5 or 1s more).\nHere is what is see in mootools-core source code.\nonSuccess: function(){\n        this.fireEvent('complete', arguments).fireEvent('success', arguments).callChain();\n    },\nI thought that onSuccess method were executed only when onComplete method\nhas finished. Isn't it the case ?\nDo you have an idea of how I should do ?\nBest\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2730.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. you'd change a framework so you can write teardowns in your tests easier?\nyou can subclass request or modify the prototype in your beforeAll or\nwhatever.\nanyway, should move this discussion to support mail list, not GH issues.\nOn Thursday, 29 October 2015, vveliev notifications@github.com wrote:\n\nI have no experience with JavaScript or mootools, I'm approaching from\ntest automation side.\nSo from testing point. I have no knowledge about requests and I cannot\ncome up with the case when I have or need to know actual request.\nIn single page application, sometimes content of the page changes. And to\ndetermine that changes have been rendered. I know 2 solutions:\n1.Look for particular element by /id/name/class/text (very specific test's)\n- Also this does not work for dynamic sections (ex. pagination\n  section, usually elements have same class identification)\n2.Have a general check for open connections, and wait for the completion\nbefore proceeding.\n- From my point this is best solution, for dynamic page sections when\n  element on the page have same identity (class is same) but values are\n  dynamically updated by some trigger.\nIf this functionality will be useful for development purpose, I will say\nmaybe (as I have no experience in UI development I cannot come up with\nexample. Maybe somebody can back me up on this one.)\nBut it does exist in: Prototype and JQuery, so there should be a reason\nfor it.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2750#issuecomment-152210768\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. we all write tests but in all my years of doing js, I've never had to keep\ncount of the number of requests sent by my tests. if you need to know that,\nstub xhr and set spies that you can assert have been called or\ncalledWith(...args). most of us write unit tests that are decoupled from\nthe responses a server will produce so actual requests out are not\ndesirable.\nOn Thursday, 29 October 2015, vveliev notifications@github.com wrote:\n\n@DimitarChristoff https://github.com/DimitarChristoff\nIf everyone who does testing need to add some additional methods around\nframework. In order to have reliable tests that can be automated. Then you\nmay aswell add this functionality into the framework.\nI'm making assumption that there are people who does make test automation.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2750#issuecomment-152304487\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. so i answered this like 5 yrs ago. http://stackoverflow.com/questions/2689010/mootools-programmatically-fired-events-not-working-with-event-delegation - looks like mootools does not normalise and bubble native change events just yet. \n. please use the mail list. this is not a bug. your selector has returned null\n. it does support svg. you are calling methods on invalid element objects.\nmake sure your selector can return elements correctly before applying style\nchanges\nOn Saturday, 26 December 2015, Rustam Abdullaev notifications@github.com\nwrote:\n\nIf this is not a bug, what is it, then?\nMootools does not support SVG documents?\nThen this is a feature request.\nPlease reopen.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2761#issuecomment-167353228\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. +1 for slack*\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n\nOn 20 Jan 2016, at 18:47, Sergio Crisostomo notifications@github.com wrote:\nI'm fine with \"switching\" or at least \"adding\" https://gitter.im/mootools/mootools-core as a official communication channel.\n\u2014\nReply to this email directly or view it on GitHub.\n. lol, GH spam accounts? that's new... \n. that's a bit moot, though. when you install msysgit it asks you\nspecifically about line endings and picking \"leave as is\" seems like the\nonly solution that works cross platform as most Windows devs normally have\na Linux based CI\n\nOn Tuesday, 16 August 2016, Tim Wienk notifications@github.com wrote:\n\nThe steps you mentioned should indeed not be necessary, but I think I\nunderstand the issue now, so thanks for explaining.\nI assumed that you got the errors because the built file was ESLinted,\nwhich seemed awkward to me (since, like I mentioned, the built file should\nnot be ESLinted at all). However, you just confirmed that the errors occur\nduring the built itself.\nI'm fairly certain the problem is not with Grunt or ESLint, but with the\nway Git handles text files by default. Git's default setting of core.eol\n= native makes it so upon checkout text files are converted to use CRLF\nline endings in windows working directories, even if they use LF line\nendings in the repository. I'm sure this avoids a lot of problems when\nediting files, but it creates problems like these when enforcing\nconsistency within files.\nSo, instead of changing the ESLint settings, we should change the way Git\nhandles these files. There is a local way of doing this, using your local\nconfig, but instead I think we should add .gitattributes file to make\nsure it's done correctly everywhere.\nAdditionally, I think we should still add the grunt.util.linefeed = '\\n',\nso the built file won't have a mix of LF and CRLF line endings afte this\nchange.\nI've just pushed timwienk@cba3825\nhttps://github.com/timwienk/mootools-core/commit/cba3825 to my own\nrepository. Is it possible for you to test whether that fixes your issues?\nIf you're pulling the change to an existing clone of the repository, you\nwill have to re-checkout the files after pulling the commit so the line\nending change takes effect. From inside the repository, this should work:\ngit rm --cached -r *.js Grunt Source Specs\ngit reset --hard\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/mootools/mootools-core/pull/2770#issuecomment-240077750,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAHSzBAtWJ89V8xNoyaBubPKJeyWhyVeks5qgaF_gaJpZM4JjvL_\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. :+1:\nOn Tuesday, 16 August 2016, Tim Wienk notifications@github.com wrote:\n\nwhen you install msysgit it asks you specifically about line endings\nI see. I guess that question will set core.autocrlf accordingly.\nIn my commit I also set * text=auto in the .gitattributes file. That will\nmake it so that (independent of the core.aotocrlf value) all files are\nchecked out with CRLF line endings when core.crlf = crlf (or core.crlf =\nnative on Windows). From your comment, Dimitar, that seems to not be a\ngood idea.\nI've replaced my commit with timwienk@70afaa8\nhttps://github.com/timwienk/mootools-core/commit/70afaa8. That way it\nonly changes behaviour for JavaScript files: they will always be checked\nout with LF line endings.\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/mootools/mootools-core/pull/2770#issuecomment-240235748,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAHSzCcnYZd1kel9TiThx7551cmFrTceks5qgiPKgaJpZM4JjvL_\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. they are normalised events. see http://mootools.net/core/docs/1.6.0/Types/DOMEvent\n. lgtm :shipit:\nOn Thursday, 22 September 2016, Sergio Crisostomo notifications@github.com\nwrote:\n\nrelated #2771 https://github.com/mootools/mootools-core/issues/2771\nYou can view, comment on, or merge this pull request online at:\nhttps://github.com/mootools/mootools-core/pull/2772\nCommit Summary\n- correct link name from Event to DOMEvent\nFile Changes\n- M Docs/Element/Element.Event.md\n  https://github.com/mootools/mootools-core/pull/2772/files#diff-0 (2)\nPatch Links:\n- https://github.com/mootools/mootools-core/pull/2772.patch\n- https://github.com/mootools/mootools-core/pull/2772.diff\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/mootools/mootools-core/pull/2772, or mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAHSzJDn4KdzOb1sk654bhADDQoJCsEDks5qsuDMgaJpZM4KET2q\n.\n\n\nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. This related to: http://stackoverflow.com/questions/40186332/mootools-click-event-not-working-in-iphone-6 ?\nhttps://jsfiddle.net/1oymyddf/\nI am on iphone7 and using mootools 1.6, it fires correctly. \nhtml\n<!DOCTYPE html>\n<html>\n<head>\n  <script type=\"text/javascript\" src=\"//cdnjs.cloudflare.com/ajax/libs/mootools/1.6.0/mootools-core.js\"></script>\n</head>\n<body>\n  <script>\nwindow.addEvent('domready', () => {\n    alert('Done')\n});\n  </script>\n</body>\n</html>\nso, which version of MooTools do you use?\n. since support is not universal (IE10+) and some older versions need vendor prefixes, we probably cannot standardise the event universally enough for it to be part of mootools-core. As such, I think your code is fine as is (just put it in a closure) - or use something like this:\nhttps://github.com/ai/visibilityjs - which does several things, like fallback to blur / focus and hides the events name in case they need prefixing. \nunrelated. are you the solidsnek from QL? :D . I am not sure how this matters, you wouldn't cause recursion unless your class somehow extends itself...\nhttps://jsfiddle.net/f7qr6zfh/1/\nthis checks all subclassing examples under mootools and ES6 classes and works correctly. . Can you modify this - https://jsfiddle.net/opc0q95o/ - to show how you use the new Event constructor and how it affects mootools?. no, just compatibility with old MooTools API.\n-- \nDimitar Christoff\n\"JavaScript is to JAVA what hamster is to ham\"\n@D_mitar - https://github.com/DimitarChristoff\n. the problem is if the event type gets converted to 2 (native) we'd have to support all the event namespace variants there are, as well as reasonably polyfill for older ones. . ",
    "dchristoff": "IE7 is fine in 1.4: http://jsfiddle.net/dimitar/uwdh7/9/ - now using the native mootools 1.4 in firebug.\n. IE7 is fine in 1.4: http://jsfiddle.net/dimitar/uwdh7/9/ - now using the native mootools 1.4 in firebug.\n. ",
    "Xunnamius": "Anything to help!\nEven with an infinitesimally small encoding issue, MooTools is still the best JS framework I've ever used =)\nNow for that $family.name == 'array' debacle, the only test code (javascript) was what was shown in the pictures. Still, the problem is definitely APE's fault for still clinging to 1.2. I may just rewrite the whole dang engine one weekend (if I ever get that annoyed).\nAs always, thanks for the quick fix!\n. @timwienk I am (or was) constantly playing around with the Moo 1.3 source (although nothing so deep as to mess with the $family variable directly), so I guess it wasn't so fair of me to include that statement in my post.\n@GCheung55 what would you like to know specifically?\n- I'm running my server on Ubuntu 11, Zend Server 5.5 + LAMP stack, APE Server version 1.0 is reported at the CLI\n- Chrome (13.0.7820) as my debugging browser\n- MooTools 1.4 w/ compat as my framework\n- APE-JSF apeClientMoo.js (based on Moo 1.2) as my intercessor to the APE core.js\n- Using xHTML 1.1 in standards compliant (non-quirks) mode\n- Running tests on a Windows computer\n- No other frameworks are used (jquery, dojo, etc.)\n. Ah, I thought the iframe would have isolated the two Moo implementations from one another. Mistaken I was!\nWell, my little hackfix is working at the moment (I'm a little scared to take it out), but I'll forward this to the APE guys. Maybe they'll look at it and finally upgrade their Moo!\nThanks.\n. Anything to help!\nEven with an infinitesimally small encoding issue, MooTools is still the best JS framework I've ever used =)\nNow for that $family.name == 'array' debacle, the only test code (javascript) was what was shown in the pictures. Still, the problem is definitely APE's fault for still clinging to 1.2. I may just rewrite the whole dang engine one weekend (if I ever get that annoyed).\nAs always, thanks for the quick fix!\n. @timwienk I am (or was) constantly playing around with the Moo 1.3 source (although nothing so deep as to mess with the $family variable directly), so I guess it wasn't so fair of me to include that statement in my post.\n@GCheung55 what would you like to know specifically?\n- I'm running my server on Ubuntu 11, Zend Server 5.5 + LAMP stack, APE Server version 1.0 is reported at the CLI\n- Chrome (13.0.7820) as my debugging browser\n- MooTools 1.4 w/ compat as my framework\n- APE-JSF apeClientMoo.js (based on Moo 1.2) as my intercessor to the APE core.js\n- Using xHTML 1.1 in standards compliant (non-quirks) mode\n- Running tests on a Windows computer\n- No other frameworks are used (jquery, dojo, etc.)\n. Ah, I thought the iframe would have isolated the two Moo implementations from one another. Mistaken I was!\nWell, my little hackfix is working at the moment (I'm a little scared to take it out), but I'll forward this to the APE guys. Maybe they'll look at it and finally upgrade their Moo!\nThanks.\n. ",
    "kallelat": "I kind of fixed or bypassed the problem with the following change to Mootools Core: (copied from MooTools 1.2)\nStill I would like to know is this intentional or have I misinterpret documentation...\n```\nClass.Mutators = {\n    Extends: function(parent){\n        this.parent = parent;\n        this.prototype = getInstance(parent);\n    },\nImplements: function(items){\n\n// MY ADDITION STARTS\n        Array.from(items).each(function(item){\n            if (item instanceof Function) item = getInstance(item);\n            this.implement(item);\n        }, this);\n// MY ADDITION ENDS\n/      Array.from(items).each(function(item){\n            var instance = new item;\n            for (var key in instance) implement.call(this, key, instance[key], true);\n        }, this);/\n    }\n};\n```\n. Actually, belong to mootools-more, sorry about that...\n. I kind of fixed or bypassed the problem with the following change to Mootools Core: (copied from MooTools 1.2)\nStill I would like to know is this intentional or have I misinterpret documentation...\n```\nClass.Mutators = {\n    Extends: function(parent){\n        this.parent = parent;\n        this.prototype = getInstance(parent);\n    },\nImplements: function(items){\n\n// MY ADDITION STARTS\n        Array.from(items).each(function(item){\n            if (item instanceof Function) item = getInstance(item);\n            this.implement(item);\n        }, this);\n// MY ADDITION ENDS\n/      Array.from(items).each(function(item){\n            var instance = new item;\n            for (var key in instance) implement.call(this, key, instance[key], true);\n        }, this);/\n    }\n};\n```\n. Actually, belong to mootools-more, sorry about that...\n. ",
    "jonathan-beebe": "@kallelat, thanks for bringing this up. I encountered the same odd behavior. It was very unexpected, but changing my Implements to Extends fixed the issue for my classes. I guess I'll need to get better about specifically designing classes for Implementing vs Extending so I don't rely on a constructor call within the implementable class.\n. @kallelat, thanks for bringing this up. I encountered the same odd behavior. It was very unexpected, but changing my Implements to Extends fixed the issue for my classes. I guess I'll need to get better about specifically designing classes for Implementing vs Extending so I don't rely on a constructor call within the implementable class.\n. ",
    "AndrewRayCode": "Oh, toggle is in More, not in Core. http://mootools.net/docs/more/Element/Element.Shortcuts#Element:toggle\n. Oh, toggle is in More, not in Core. http://mootools.net/docs/more/Element/Element.Shortcuts#Element:toggle\n. ",
    "littlebigcoder": "Wow, that was quick! Thanks, now it works!\nUnfixed code works in chrome, so it was a firefox only problem.\n. Wow, that was quick! Thanks, now it works!\nUnfixed code works in chrome, so it was a firefox only problem.\n. ",
    "leoe": "I have an issue with the mousewheel Event, it doesn't enter on the code that manages the event on Firefox because the type is DOMMouseScroll and type.indexOf('mouse') == 0 validation is false.\nline 1167:\n} else if (type == 'click' || type == 'dblclick' || type == 'contextmenu' || type.indexOf('mouse') == 0){\nmust be something like:\n} else if (type == 'click' || type == 'dblclick' || type == 'contextmenu' || type.indexOf('mouse') == 0 || type.indexOf('DOMMouse') == 0){\nweb build:\n- http://mootools.net/core/76bf47062d6c1983d66ce47ad66aa0e0\n. I have an issue with the mousewheel Event, it doesn't enter on the code that manages the event on Firefox because the type is DOMMouseScroll and type.indexOf('mouse') == 0 validation is false.\nline 1167:\n} else if (type == 'click' || type == 'dblclick' || type == 'contextmenu' || type.indexOf('mouse') == 0){\nmust be something like:\n} else if (type == 'click' || type == 'dblclick' || type == 'contextmenu' || type.indexOf('mouse') == 0 || type.indexOf('DOMMouse') == 0){\nweb build:\n- http://mootools.net/core/76bf47062d6c1983d66ce47ad66aa0e0\n. ",
    "svengt": "It says boolean between the brackets, 'null' - (boolean).\n. It says boolean between the brackets, 'null' - (boolean).\n. ",
    "bobjpg": "thanks.\n. thanks.\n. ",
    "kguelzau": "I don't have the permission to reopen.\nIt's OK that Request.send is blocking with async=false.\nBut it doesn't make any sense to me to trigger the timeout delay if i already know that the request definitely has already been finished.\nSo one option is to remove timeout handling completely (what i suggested) or to start the delay right before send.\n. We have the same issue in our webapplication while doing a location.href='...' on a MooTools 1.4.2 page.\nhttp://www.apixelife.com/github/2163/mootools-core-1.4.2.html crashes and\nhttp://iamincendium.com/github-2163/mootools-1.4.2.htm works for me.\n. @ibolmo 6c8ddafda689eb2d25948046ab68590677e7b00e works for us. Thanks!\n. see #2328\ngetComputedStyle and getStyle do not always return px.\n. why closed? related to #2328\n. Sorry guys but this changes behavior between IE < 9 and all other browsers.\nWhe i have set opacity in my CSS opacity: 0 and filter: alpha(opacity=0)\nand do a Fx.Tween('element').start('opacity', 0, 1) my \"element\" disappears in IE < 9 !\nThere should be no additional \"delete this style\" logic for common opacity values.\nSee: http://jsfiddle.net/kguelzau/Cdrdh/3/\n. jsfiddle seems to be broken for IE8/7 right now. So I can't test it.\nBut the new code seems to be OK since \"element.getComputedStyle('filter')\" is used to check for filters in non inline styles.\n. http://jsfiddle.net/kguelzau/Cdrdh/4/\nworks with mootools edge in IE7/8\n. Does the 1.3 branch include the Browser Module?\nPerhaps its the Flash detection via ActiveXObject? see #2327\n. This is reproduceable on my (VMWare) machine:\nOS: Windows XP (SP2)\nBrowser: IE 7.0.5730.13\nMoo: 1.4.5 / trunk\nHere is another way to trigger the leak:\nhtml\n<!DOCTYPE HTML>\n<html>\n  <head>\n    <script src=\"mootools.js\" type=\"text/javascript\"></script>\n    <script type=\"text/javascript\">\n    function delBody() {\n        var o = document.id('content');\n        document.id(document.body).set('html', '');\n    }\n    setTimeout(delBody, 100);\n    </script>\n  </head>\n  <body>\n    <div id=\"content\">myContent</div>\n  </body>\n</html>\nThe leak is gone when commenting out the IE7 _fireEvent wrapper:\nhttps://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L270-273\nor resetting _fireEvent manually via el._fireEvent = null;\nSo the leak seems to exist since 1.4.2.\n. Another project with the same Isssue:\nhttp://code.google.com/p/swfobject/issues/detail?id=619\n+1 for \"on demand\" in 1.x\n+1 for separate module or move to more in 2.x (nobody needs flash anyway ;-)\n. That's what i did to track it down to \"new ActiveXObject...\".\nCurrently i'am using mootools with \"on demand\" flash detection (#2206).\nSince i am not using flash, memory is not leaking anymore.\n. Why was this closed without comment? Did i miss a commit?\n. No comment or commit? Just closed?\n. Just an Update on this Issue.\nI modified the iframe.html (ugly onload):\nhtml\n<!DOCTYPE HTML>\n<html>\n  <head>\n    <script src=\"mootools.js\" type=\"text/javascript\"></script>\n    <script type=\"text/javascript\">\n     function init() { \n       //nothing\n     }\n  </script>\n  </head>\n  <body onload=\"init()\">\n    iframe\n  </body>\n</html>\nAnd expanded the cleanup in the unload event (Core.Browser):\njavascript\nvar unloadEvent = function(){\n  this.detachEvent('onunload', unloadEvent);\n  document.head = document.html = document.window;\n  // cleanup scope vars\n  window = this.Window = document = null;\n};\nAND modified domready() in DOMReady\njavascript\nvar domready = function(){\n  clearTimeout(timer);\n  if (!ready) {\n    Browser.loaded = ready = true;\n    document.removeListener('DOMContentLoaded', domready).removeListener('readystatechange', check);\n    document.fireEvent('domready');\n    window.fireEvent('domready');\n  }\n  // cleanup scope vars\n  document = window = testElement = null;\n};\nThis fixes this issue for me. again... ;-)\n. +1 for doing less -> see #2328\n. Please have a look at my last comment in #2329.\nResetting the scope vars window and document in Core.Browser and DOMReady fixes this issue.\n. Browser detection is bad. I agree.\nBut sometimes there is no quick or obvious solution to detect strange browser behavior.\nFor example: http://jsfiddle.net/kguelzau/VhwmL/\nIf I want to JSON.stringify arrays of other windows, IE always encodes them as objects (perhaps because of \"(win.myArray instanceof Array) === false)\".\nIn this \"feature\" detection I currently have to use eval which is always a bad idea.\nSo here browser detection is a quick (and dirty) way to finish your task without implementing a good crossbrowser feature detection.\nSo I too think Core.Browser should be updated or moved to More or something similar.\n. To also use Ctrl + O/P in IE9/10 you have to use \"attachEvent\" enstead of \"addEventListener\".\nSee: http://stackoverflow.com/questions/13443742/preventing-default-keystroke-actions-in-internet-explorer\nSo for now I have to patch the mootools code (Core or More.Keyboard) to be able to use those Shortcuts in IE 9/10 :-\\\njavascript\n[Element, Window, Document].invoke('implement', {\n  addListener: function(type, fn){\n    ...\n    // inverted calls for keydown\n    if (type == 'keydown') {\n      if (this.attachEvent) this.attachEvent('on' + type, fn);\n      else this.addEventListener(type, fn, !!arguments[2]);\n    } else {\n      if (this.addEventListener) this.addEventListener(type, fn, !!arguments[2]);\n      else this.attachEvent('on' + type, fn);\n    }\n  return this;\n},\n. It's ok to not fix this special ie stuff in core.\nFor me it was easier to patch core instead of create additional code everywhere i use shortcuts.\nPerhaps this issue/thread will be useful for someone searching for https://www.google.de/search?q=mootools+ctrl%2Bo+ie ;-)\n. I don't have the permission to reopen.\nIt's OK that Request.send is blocking with async=false.\nBut it doesn't make any sense to me to trigger the timeout delay if i already know that the request definitely has already been finished.\nSo one option is to remove timeout handling completely (what i suggested) or to start the delay right before send.\n. We have the same issue in our webapplication while doing a location.href='...' on a MooTools 1.4.2 page.\nhttp://www.apixelife.com/github/2163/mootools-core-1.4.2.html crashes and\nhttp://iamincendium.com/github-2163/mootools-1.4.2.htm works for me.\n. @ibolmo 6c8ddafda689eb2d25948046ab68590677e7b00e works for us. Thanks!\n. see #2328\ngetComputedStyle and getStyle do not always return px.\n. why closed? related to #2328\n. Sorry guys but this changes behavior between IE < 9 and all other browsers.\nWhe i have set opacity in my CSS opacity: 0 and filter: alpha(opacity=0)\nand do a Fx.Tween('element').start('opacity', 0, 1) my \"element\" disappears in IE < 9 !\nThere should be no additional \"delete this style\" logic for common opacity values.\nSee: http://jsfiddle.net/kguelzau/Cdrdh/3/\n. jsfiddle seems to be broken for IE8/7 right now. So I can't test it.\nBut the new code seems to be OK since \"element.getComputedStyle('filter')\" is used to check for filters in non inline styles.\n. http://jsfiddle.net/kguelzau/Cdrdh/4/\nworks with mootools edge in IE7/8\n. Does the 1.3 branch include the Browser Module?\nPerhaps its the Flash detection via ActiveXObject? see #2327\n. This is reproduceable on my (VMWare) machine:\nOS: Windows XP (SP2)\nBrowser: IE 7.0.5730.13\nMoo: 1.4.5 / trunk\nHere is another way to trigger the leak:\nhtml\n<!DOCTYPE HTML>\n<html>\n  <head>\n    <script src=\"mootools.js\" type=\"text/javascript\"></script>\n    <script type=\"text/javascript\">\n    function delBody() {\n        var o = document.id('content');\n        document.id(document.body).set('html', '');\n    }\n    setTimeout(delBody, 100);\n    </script>\n  </head>\n  <body>\n    <div id=\"content\">myContent</div>\n  </body>\n</html>\nThe leak is gone when commenting out the IE7 _fireEvent wrapper:\nhttps://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L270-273\nor resetting _fireEvent manually via el._fireEvent = null;\nSo the leak seems to exist since 1.4.2.\n. Another project with the same Isssue:\nhttp://code.google.com/p/swfobject/issues/detail?id=619\n+1 for \"on demand\" in 1.x\n+1 for separate module or move to more in 2.x (nobody needs flash anyway ;-)\n. That's what i did to track it down to \"new ActiveXObject...\".\nCurrently i'am using mootools with \"on demand\" flash detection (#2206).\nSince i am not using flash, memory is not leaking anymore.\n. Why was this closed without comment? Did i miss a commit?\n. No comment or commit? Just closed?\n. Just an Update on this Issue.\nI modified the iframe.html (ugly onload):\nhtml\n<!DOCTYPE HTML>\n<html>\n  <head>\n    <script src=\"mootools.js\" type=\"text/javascript\"></script>\n    <script type=\"text/javascript\">\n     function init() { \n       //nothing\n     }\n  </script>\n  </head>\n  <body onload=\"init()\">\n    iframe\n  </body>\n</html>\nAnd expanded the cleanup in the unload event (Core.Browser):\njavascript\nvar unloadEvent = function(){\n  this.detachEvent('onunload', unloadEvent);\n  document.head = document.html = document.window;\n  // cleanup scope vars\n  window = this.Window = document = null;\n};\nAND modified domready() in DOMReady\njavascript\nvar domready = function(){\n  clearTimeout(timer);\n  if (!ready) {\n    Browser.loaded = ready = true;\n    document.removeListener('DOMContentLoaded', domready).removeListener('readystatechange', check);\n    document.fireEvent('domready');\n    window.fireEvent('domready');\n  }\n  // cleanup scope vars\n  document = window = testElement = null;\n};\nThis fixes this issue for me. again... ;-)\n. +1 for doing less -> see #2328\n. Please have a look at my last comment in #2329.\nResetting the scope vars window and document in Core.Browser and DOMReady fixes this issue.\n. Browser detection is bad. I agree.\nBut sometimes there is no quick or obvious solution to detect strange browser behavior.\nFor example: http://jsfiddle.net/kguelzau/VhwmL/\nIf I want to JSON.stringify arrays of other windows, IE always encodes them as objects (perhaps because of \"(win.myArray instanceof Array) === false)\".\nIn this \"feature\" detection I currently have to use eval which is always a bad idea.\nSo here browser detection is a quick (and dirty) way to finish your task without implementing a good crossbrowser feature detection.\nSo I too think Core.Browser should be updated or moved to More or something similar.\n. To also use Ctrl + O/P in IE9/10 you have to use \"attachEvent\" enstead of \"addEventListener\".\nSee: http://stackoverflow.com/questions/13443742/preventing-default-keystroke-actions-in-internet-explorer\nSo for now I have to patch the mootools code (Core or More.Keyboard) to be able to use those Shortcuts in IE 9/10 :-\\\njavascript\n[Element, Window, Document].invoke('implement', {\n  addListener: function(type, fn){\n    ...\n    // inverted calls for keydown\n    if (type == 'keydown') {\n      if (this.attachEvent) this.attachEvent('on' + type, fn);\n      else this.addEventListener(type, fn, !!arguments[2]);\n    } else {\n      if (this.addEventListener) this.addEventListener(type, fn, !!arguments[2]);\n      else this.attachEvent('on' + type, fn);\n    }\n  return this;\n},\n. It's ok to not fix this special ie stuff in core.\nFor me it was easier to patch core instead of create additional code everywhere i use shortcuts.\nPerhaps this issue/thread will be useful for someone searching for https://www.google.de/search?q=mootools+ctrl%2Bo+ie ;-)\n. ",
    "jbanety": "I have the same problem with Fx.Tween.\nElement.tween('opacity', 1) doesn't set visibility to visible anymore.\n. Here is the example on jsfiddle : http://jsfiddle.net/rjEmx/\n. I'm ok with that. But this is an important change for many javascript components based on Mootools. A bit of information about this should be appreciate by developers. \n. That was the lazy way ;-)\nThanks.\n. I have the same problem with Fx.Tween.\nElement.tween('opacity', 1) doesn't set visibility to visible anymore.\n. Here is the example on jsfiddle : http://jsfiddle.net/rjEmx/\n. I'm ok with that. But this is an important change for many javascript components based on Mootools. A bit of information about this should be appreciate by developers. \n. That was the lazy way ;-)\nThanks.\n. ",
    "CrypticSwarm": "Core 1.3.2\nhttp://jsfiddle.net/jVQCm/\nCore 1.4.0\nhttp://jsfiddle.net/jVQCm/1/\nSame user code, but different results.  1.3.2 you can click \"Click Me\".\n1.4.0 you can't because the mask is over the \"Click Me\" you just can't see it.\n. I think that fade should still set the visibility.  Since fade is a higher level construct it should still work the same as it did before.\n. Core 1.3.2\nhttp://jsfiddle.net/jVQCm/\nCore 1.4.0\nhttp://jsfiddle.net/jVQCm/1/\nSame user code, but different results.  1.3.2 you can click \"Click Me\".\n1.4.0 you can't because the mask is over the \"Click Me\" you just can't see it.\n. I think that fade should still set the visibility.  Since fade is a higher level construct it should still work the same as it did before.\n. ",
    "jlind": "I always liked the way MooTools fade worked because the items actually disappeared when they were faded all the way out.  Oh well, just gives me more work.\n. I always liked the way MooTools fade worked because the items actually disappeared when they were faded all the way out.  Oh well, just gives me more work.\n. ",
    "olvlvl": "I think this change is a bad idea disguised as a good one. I understand that setStyle() should only alter the property it is supposed to alter, but now if we fade our controls out they are still \"active\", so a user can click by mistake on an invisible \"delete\" button, or a menu can pop out of nowhere from an invisible \"select\", so we have to manually set the visibility before and after to fade, and I think that's really annoying.\n. Hoo, that's nice !\n. Too bad I didn't had time to reply before the PR was closed. Here are some elements though.\nKeeping a nesting counter on disable/enable frees the developer from caring about whether the event was already disabled and whether or not the event should be enabled again. This is a very common pattern in the UI framework I worked on, because one might want to disable/enable an event, but you might not be alone wanting that. The nesting counter helps dealing with that.\n@DimitarChristoff Your example is similar to what I would like\u2013except that there's not nesting\u2013but it also adds two more methods and is much more complicated, and it will cause unwanted side effect if an event is added while its type is renamed. About performance, I don't thing a lookup for a key in an array is that expensive, unless maybe for IE6, but I might be wrong.\n@ibolmo Your code is similar to what I did first, but I figured it might be interesting to have this feature more globally available e.g. in Events. The other example is from the Slider class change, and is not very pretty.\nIf I want to extend Events, is the following code correct:\n``` js\n!function() {\nvar originalFireEvent = Events.fireEvent\n\nEvents.implement({\n\n    $disabledEvents: {},\n\n    fireEvent: function(type, args, delay){\n        if (this.$disabledEvents[type]) return this\n        return originalFireEvent.apply(this, arguments)\n    },\n\n    disableEvent: function(type){\n        this.$disabledEvents[type] = (this.$disabledEvents[type] || 0) + 1\n        return this\n    },\n\n    enableEvent: function(type){\n        this.$disabledEvents[type] = (this.$disabledEvents[type] || 0) - 1\n        return this\n    }\n})\n\n} ()\n```\nThanks for your comments.\n. I understand that. The way I use it is to suppress 20 change events\u2014while criteria are reseted\u2014to fire a single change event, after the reset is complete. In a sense, the change events are not lost, but rather aggregated. My proposal was a simple solution, but it looks like simple solutions are not always good solutions :)\n. For anyone interested, this is the code for a DisableableEvents class:\njs\nvar DisableableEvents = new Class({\n    Extends: Events,\n    $disabledEvents: {},\n    fireEvent: function(type, args, delay){\n        if (this.$disabledEvents[type]) return this\n        return this.parent.apply(this, arguments)\n    },\n    disableEvent: function(type){\n        this.$disabledEvents[type] = (this.$disabledEvents[type] || 0) + 1\n        return this\n    },\n    enableEvent: function(type){\n        this.$disabledEvents[type] = (this.$disabledEvents[type] || 0) - 1\n        return this\n    }\n})\n. Actually, the HEAD method is sent as a POST with _method=HEAD, when it should be a GET :(\nAccording to this Wikipedia page about XMLHttpRequest most methods are directly supported by IE7 and up. Maybe it is time we drop HTTP method emulation.\n. @SergioCrisostomo You can count on me ! If we could use the FormData API that would be great !\nIs this discussion public ? Where can I follow it ?\n. I'm trying to remove all those ReferenceErrors. Also the timer property holds a deprecated value once clearTimeout has been called.\n. I prefer a code that do not emit errors, but you're the owner, do what you want.\n. With Firefox and Firebug, in the \"Console\" panel activate \"Display JavaScript warning\"  (or something like this, my UI is in French). I always develop with warnings \"on\" and I grew tired of all the errors that were emitted by MooTools, most of them are very easy to fix, that's why I submitted the last PRs. It would be nice if only my faulty code were emitting errors, not my favorite framework.\nNote: The errors are also visible with Firefox's own console, you just need to activate warnings.\n. Done: https://github.com/mootools/slick/pull/75\n. I don't think this is necessary. It seams to me that the problem is with the logic of your application.\n. @antpaw If you don't define the url parameter, the request is sent to the current pathname with the parameters you provide. Your new location should then be created from the current pathname and the params, just like a regular URL would be used to access your resource. Also, I advise you to use your params as stateObj, so that you can easily retrieve the previous state:\n``` js\nvar params = { param: 1 }\nnew Request.HTML({\n    onSuccess: function(){\n        window.history.pushState(params, '', window.location.pathname + \"?\" + params.toQueryString())\n    }\n}).get(params)\n```\nWhat do you think ?\n. window.location.search provides you with the current parameters. If you want to preserve those parameters you need to extract them and merge them with your new parameters:\njs\nvar params = Object.merge(window.location.search.substring(1).parseQueryString(), { param: 1 })\n\u2026 or a similar code.\n. I share the opinion of @nfroidure. Consider the following code:\n``` js\nString.implement({\nsplice: function() {\n\n    arguments[0] += (arguments[0] < 0 ? this.length + 1 : 0);\n    var return_both = (typeof arguments[arguments.length - 1] === 'boolean' ? arguments[--arguments.length] : false),\n    t = this.split(\"\"),\n    change = t.splice.apply(t, arguments).join(\"\"),\n    out = t.join(\"\");\n    return (return_both ? [out, change] : out);\n}\n\n})\nvar str = \"Madonna\"\n, arr = [ 1, 2, 3, 4 ]\nstr.splice(2, 1)\narr.splice(2, 1)\nconsole.log(str)\nconsole.log(arr)\n```\nstr is still \"Madonna\" when it should be \"Maonna\", but arr is [ 1, 2, 4 ] as expected.\nThe function should be renamed as slice, although that function already exists:\nhttps://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/slice\n. I think this change is a bad idea disguised as a good one. I understand that setStyle() should only alter the property it is supposed to alter, but now if we fade our controls out they are still \"active\", so a user can click by mistake on an invisible \"delete\" button, or a menu can pop out of nowhere from an invisible \"select\", so we have to manually set the visibility before and after to fade, and I think that's really annoying.\n. Hoo, that's nice !\n. Too bad I didn't had time to reply before the PR was closed. Here are some elements though.\nKeeping a nesting counter on disable/enable frees the developer from caring about whether the event was already disabled and whether or not the event should be enabled again. This is a very common pattern in the UI framework I worked on, because one might want to disable/enable an event, but you might not be alone wanting that. The nesting counter helps dealing with that.\n@DimitarChristoff Your example is similar to what I would like\u2013except that there's not nesting\u2013but it also adds two more methods and is much more complicated, and it will cause unwanted side effect if an event is added while its type is renamed. About performance, I don't thing a lookup for a key in an array is that expensive, unless maybe for IE6, but I might be wrong.\n@ibolmo Your code is similar to what I did first, but I figured it might be interesting to have this feature more globally available e.g. in Events. The other example is from the Slider class change, and is not very pretty.\nIf I want to extend Events, is the following code correct:\n``` js\n!function() {\nvar originalFireEvent = Events.fireEvent\n\nEvents.implement({\n\n    $disabledEvents: {},\n\n    fireEvent: function(type, args, delay){\n        if (this.$disabledEvents[type]) return this\n        return originalFireEvent.apply(this, arguments)\n    },\n\n    disableEvent: function(type){\n        this.$disabledEvents[type] = (this.$disabledEvents[type] || 0) + 1\n        return this\n    },\n\n    enableEvent: function(type){\n        this.$disabledEvents[type] = (this.$disabledEvents[type] || 0) - 1\n        return this\n    }\n})\n\n} ()\n```\nThanks for your comments.\n. I understand that. The way I use it is to suppress 20 change events\u2014while criteria are reseted\u2014to fire a single change event, after the reset is complete. In a sense, the change events are not lost, but rather aggregated. My proposal was a simple solution, but it looks like simple solutions are not always good solutions :)\n. For anyone interested, this is the code for a DisableableEvents class:\njs\nvar DisableableEvents = new Class({\n    Extends: Events,\n    $disabledEvents: {},\n    fireEvent: function(type, args, delay){\n        if (this.$disabledEvents[type]) return this\n        return this.parent.apply(this, arguments)\n    },\n    disableEvent: function(type){\n        this.$disabledEvents[type] = (this.$disabledEvents[type] || 0) + 1\n        return this\n    },\n    enableEvent: function(type){\n        this.$disabledEvents[type] = (this.$disabledEvents[type] || 0) - 1\n        return this\n    }\n})\n. Actually, the HEAD method is sent as a POST with _method=HEAD, when it should be a GET :(\nAccording to this Wikipedia page about XMLHttpRequest most methods are directly supported by IE7 and up. Maybe it is time we drop HTTP method emulation.\n. @SergioCrisostomo You can count on me ! If we could use the FormData API that would be great !\nIs this discussion public ? Where can I follow it ?\n. I'm trying to remove all those ReferenceErrors. Also the timer property holds a deprecated value once clearTimeout has been called.\n. I prefer a code that do not emit errors, but you're the owner, do what you want.\n. With Firefox and Firebug, in the \"Console\" panel activate \"Display JavaScript warning\"  (or something like this, my UI is in French). I always develop with warnings \"on\" and I grew tired of all the errors that were emitted by MooTools, most of them are very easy to fix, that's why I submitted the last PRs. It would be nice if only my faulty code were emitting errors, not my favorite framework.\nNote: The errors are also visible with Firefox's own console, you just need to activate warnings.\n. Done: https://github.com/mootools/slick/pull/75\n. I don't think this is necessary. It seams to me that the problem is with the logic of your application.\n. @antpaw If you don't define the url parameter, the request is sent to the current pathname with the parameters you provide. Your new location should then be created from the current pathname and the params, just like a regular URL would be used to access your resource. Also, I advise you to use your params as stateObj, so that you can easily retrieve the previous state:\n``` js\nvar params = { param: 1 }\nnew Request.HTML({\n    onSuccess: function(){\n        window.history.pushState(params, '', window.location.pathname + \"?\" + params.toQueryString())\n    }\n}).get(params)\n```\nWhat do you think ?\n. window.location.search provides you with the current parameters. If you want to preserve those parameters you need to extract them and merge them with your new parameters:\njs\nvar params = Object.merge(window.location.search.substring(1).parseQueryString(), { param: 1 })\n\u2026 or a similar code.\n. I share the opinion of @nfroidure. Consider the following code:\n``` js\nString.implement({\nsplice: function() {\n\n    arguments[0] += (arguments[0] < 0 ? this.length + 1 : 0);\n    var return_both = (typeof arguments[arguments.length - 1] === 'boolean' ? arguments[--arguments.length] : false),\n    t = this.split(\"\"),\n    change = t.splice.apply(t, arguments).join(\"\"),\n    out = t.join(\"\");\n    return (return_both ? [out, change] : out);\n}\n\n})\nvar str = \"Madonna\"\n, arr = [ 1, 2, 3, 4 ]\nstr.splice(2, 1)\narr.splice(2, 1)\nconsole.log(str)\nconsole.log(arr)\n```\nstr is still \"Madonna\" when it should be \"Maonna\", but arr is [ 1, 2, 4 ] as expected.\nThe function should be renamed as slice, although that function already exists:\nhttps://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/slice\n. ",
    "gehan": "Very quick very nice!\n. Sorry should return null, not ''. Correct behaviour in ie8, not sure about ie6.\n. It was on Firefox 8.0.1 OSX but I've just tried it again and it seems to work fine now. I'm on a different computer but I'll check again later, very odd.\n. Ah interesting, I know it was technically incorrect but didn't know that it was the browser actually parsing it as such. Thanks for the example!\n. Very quick very nice!\n. Sorry should return null, not ''. Correct behaviour in ie8, not sure about ie6.\n. It was on Firefox 8.0.1 OSX but I've just tried it again and it seems to work fine now. I'm on a different computer but I'll check again later, very odd.\n. Ah interesting, I know it was technically incorrect but didn't know that it was the browser actually parsing it as such. Thanks for the example!\n. ",
    "SunboX": "Maybe this working snipped is helpful:\n```\nfunction onDocumentMouseWheel( event ) {\n        // WebKit\n\n        if ( event.wheelDeltaY ) {\n\n            fov -= event.wheelDeltaY * 0.05;\n\n        // Opera / Explorer 9\n\n        } else if ( event.wheelDelta ) {\n\n            fov -= event.wheelDelta * 0.05;\n\n        // Firefox\n\n        } else if ( event.detail ) {\n\n            fov += event.detail * 1.0;\n\n        }\n\n        camera.projectionMatrix = THREE.Matrix4.makePerspective( fov, window.innerWidth / window.innerHeight, 1, 1100 );\n        render();\n\n    }\n\n```\n. I can confirm, this happens with some Windows XP + IE7 Versions. Mootools 1.4.2 crashed several IE7s of one of our clients. Reproducable on many mashines. But it worked on my virtual XP + IE7 like a charm. Switching back to Mootools 1.4.1 fixed it. IE7 didn\u00b4t crash any more.\nAbout the crashes:\nSeems like the IE7 crashed on leaving the page. Calling any page after a new IE start worked great. Going into the adress bar and typing ENTER or clicking any link on the page crashed the IE. Windows SysLog only said: iexplorer.exe crashed.\n. No, I didn\u00b4t try it. Had to fix it quickly and haven\u00b4t access to our clients machines now. :/ Can\u00b4t reproduce this bug on my development machine. But it works now, with 1.4.1.\n. Maybe this working snipped is helpful:\n```\nfunction onDocumentMouseWheel( event ) {\n        // WebKit\n\n        if ( event.wheelDeltaY ) {\n\n            fov -= event.wheelDeltaY * 0.05;\n\n        // Opera / Explorer 9\n\n        } else if ( event.wheelDelta ) {\n\n            fov -= event.wheelDelta * 0.05;\n\n        // Firefox\n\n        } else if ( event.detail ) {\n\n            fov += event.detail * 1.0;\n\n        }\n\n        camera.projectionMatrix = THREE.Matrix4.makePerspective( fov, window.innerWidth / window.innerHeight, 1, 1100 );\n        render();\n\n    }\n\n```\n. I can confirm, this happens with some Windows XP + IE7 Versions. Mootools 1.4.2 crashed several IE7s of one of our clients. Reproducable on many mashines. But it worked on my virtual XP + IE7 like a charm. Switching back to Mootools 1.4.1 fixed it. IE7 didn\u00b4t crash any more.\nAbout the crashes:\nSeems like the IE7 crashed on leaving the page. Calling any page after a new IE start worked great. Going into the adress bar and typing ENTER or clicking any link on the page crashed the IE. Windows SysLog only said: iexplorer.exe crashed.\n. No, I didn\u00b4t try it. Had to fix it quickly and haven\u00b4t access to our clients machines now. :/ Can\u00b4t reproduce this bug on my development machine. But it works now, with 1.4.1.\n. ",
    "oscar810429": "haha\n. haha\n. ",
    "RemkoNolten": "Strange, apparently in 1.3 it did not break our code...\n. Ah, we might have mistakenly included the compatibility code then. \nIn my case it is a function to which you can add a CSS selector string or a <select> element or an array of <select> elements depending on the situation (so $(select) would not really suffice).\nAlthough it is a uncommon situation, it might be a good idea to add it to the documentation (but I would suggest it is better the make sure $$() behaves uniformly no matter what you kind of element you put in it).\n. Strange, apparently in 1.3 it did not break our code...\n. Ah, we might have mistakenly included the compatibility code then. \nIn my case it is a function to which you can add a CSS selector string or a <select> element or an array of <select> elements depending on the situation (so $(select) would not really suffice).\nAlthough it is a uncommon situation, it might be a good idea to add it to the documentation (but I would suggest it is better the make sure $$() behaves uniformly no matter what you kind of element you put in it).\n. ",
    "reaktivo": "Cool, this was fixed with 1.4.1 right?\n. I don't have a IE7 machine to test a jsfiddle with right now, but I'll look into it.\n. I'm going to close it right now, I don't have a machine with IE 7 anymore near me to create a JSFiddle.\n. Cool, this was fixed with 1.4.1 right?\n. I don't have a IE7 machine to test a jsfiddle with right now, but I'll look into it.\n. I'm going to close it right now, I don't have a machine with IE 7 anymore near me to create a JSFiddle.\n. ",
    "Myke79": "ok thanks\n. ok thanks\n. ",
    "schnix": "havent found it either, but i debugged it a little bit.\nit seems to be a problem with .getElements function.\ni created a strict html page, with mootools core 1.4. and some links - then call document.getElements( \"a[href]\" )...\nit throws the warning above, but only once.\nsame for the slick function that is returned by getElements: reload that page and fire: Slick.search(document, \"a[href]\", new Elements);\nalways the getAttributeNodeNS warning. \ni guess it is somewhere built in the slick framework...\nthe other option is, that getAttributeNode internally runs getAttributeNodeNS... because the getAttributeNode is also deprecated (Attr.getAttribute is the standard now), but frequently used... that can be found in the code...\nschnix\n. done:\nhttps://github.com/mootools/slick/issues/61\n. havent found it either, but i debugged it a little bit.\nit seems to be a problem with .getElements function.\ni created a strict html page, with mootools core 1.4. and some links - then call document.getElements( \"a[href]\" )...\nit throws the warning above, but only once.\nsame for the slick function that is returned by getElements: reload that page and fire: Slick.search(document, \"a[href]\", new Elements);\nalways the getAttributeNodeNS warning. \ni guess it is somewhere built in the slick framework...\nthe other option is, that getAttributeNode internally runs getAttributeNodeNS... because the getAttributeNode is also deprecated (Attr.getAttribute is the standard now), but frequently used... that can be found in the code...\nschnix\n. done:\nhttps://github.com/mootools/slick/issues/61\n. ",
    "lordfpx": "Ok, thank you I will wait before updating\n. Ok, thank you I will wait before updating\n. ",
    "paffers": "Okay, so I was the problem...\nSince 1.4, when working with Elements by class $$('.myclass') one have to use the each method even if you are absolutely sure that there is only one element in the DOM matching the selector.\nSolution\njavascript\n$$('.myel').clone().each( function (e)  {\ne.inject(el, 'after'); \n} ) ;\n. absolutely, thanks for the clarification\n. Okay, so I was the problem...\nSince 1.4, when working with Elements by class $$('.myclass') one have to use the each method even if you are absolutely sure that there is only one element in the DOM matching the selector.\nSolution\njavascript\n$$('.myel').clone().each( function (e)  {\ne.inject(el, 'after'); \n} ) ;\n. absolutely, thanks for the clarification\n. ",
    "boppy": "paffers: I think you're absolutely correct with this (and of course you are not the problem! ;-)). Came across the same problem right now on 1.5!\n``` javascript\nvar set1 = $$('span');\nvar set2 = set1.clone();\n// works:\nset1.inject($('target'));\n// won't work\nset2.inject($('target'));\n```\nBut as $$ returns - as seanmonstar pointed out - an array-like object \"knowing\" the functions from Array and from Element it should to work.\nI corrected the clone-function:\njavascript\nElements.implement('clone2elements', function(cont, keep){\n    var ret = new Elements();\n    this.each(function(el){\n        ret.push(el.clone(cont,keep));\n    })\n    return ret;\n});\nAs liddle fiddle\nAnyone with me??\n. @RichardChaumont: Your way works, but in fact the docs say that an Elements-Array should behave like a native Element - so the result of a clone-Process should not be a native Array but an Elements-Array.\nThe process has to have some kind of type-safety in any way... Don't you agree?\n. paffers: I think you're absolutely correct with this (and of course you are not the problem! ;-)). Came across the same problem right now on 1.5!\n``` javascript\nvar set1 = $$('span');\nvar set2 = set1.clone();\n// works:\nset1.inject($('target'));\n// won't work\nset2.inject($('target'));\n```\nBut as $$ returns - as seanmonstar pointed out - an array-like object \"knowing\" the functions from Array and from Element it should to work.\nI corrected the clone-function:\njavascript\nElements.implement('clone2elements', function(cont, keep){\n    var ret = new Elements();\n    this.each(function(el){\n        ret.push(el.clone(cont,keep));\n    })\n    return ret;\n});\nAs liddle fiddle\nAnyone with me??\n. @RichardChaumont: Your way works, but in fact the docs say that an Elements-Array should behave like a native Element - so the result of a clone-Process should not be a native Array but an Elements-Array.\nThe process has to have some kind of type-safety in any way... Don't you agree?\n. ",
    "RichardChaumont": "@boppy you should do:\n```\n$$(set2).inject($('target'));\nor\nset2.each(function(span){\n    span.inject($('target'));\n});\n```\n. @boppy you should do:\n```\n$$(set2).inject($('target'));\nor\nset2.each(function(span){\n    span.inject($('target'));\n});\n```\n. ",
    "kentaromiura": "@arian @sergiocristosomo I think Elements::clone should return an instance of Elements and not of Array \n. Ah damn I misspelled @SergioCrisoStomo handle,  sorry Sergio :-(\n. @arian \nToday I updated my test fork here:\nhttps://github.com/kentaromiura/mootools-core/tree/feature-appendHTML-2151\nthat basically is this pull request in which I added Spec, and keeto wrote some docs, \ncan you please double check this, thanks.\n. see #2185\n. tested with 1.4.5 and:\n\nThe animation should be cancelled almost immediately, but in fact it continues and finishes.\n\nthe animation is cancelled immediatly.\nhttp://jsfiddle.net/kentaromiura/UeRNE/\n. The example code here is not a working one, also passing an array to an Fx instance will just animate through the first and second argument, I don't know what the original guy wants to do, but since is not possible to reproduce the bug, I will close it as invalid.\n. IE7 is using the native version, and the native version fires as soon you hit the border of the select box, it needs further testing so moving this to 1.6\n. that's because removeChild doesn't eliminate the node but just remove the child from the element and return it, if you want to really get rid of it just call .destroy() on the result of removeChild.\ntested using the same setup used on https://github.com/mootools/mootools-core/pull/2351 and \nwhile sIEve tells me that using removeChild() will leak about 1000 elements\nusing removeChild().destroy() will drop the leaks from 1000 to 0.\n. No! if there's something people really rely on is the sync'ity of fireEvent, making it async will break tons of code, we can implement fireEventAsync though (with a better name) \n. If we want to break b/c I'd rather implement proper CustomEvents instead,\nsee @WebReflection https://github.com/WebReflection/dom4/blob/master/src/dom4.js#L230-L282 as an example of what I mean.\nBesides, in the link @arian provided Dean Edwards show how to make that work in oldIE as well, so if we have to keep IE8 compatibility we can do a workaround like that onpropertychange (with all the restriction property change has in ie8)\nto keep B/C we can't really use try catch as any code using try catch to get (for example) any possible  window.external exception will not work if we defer the re-throw of the exception.\n. @michaelcm, take a look at this: https://github.com/mootools/mootools-core/pull/2351\n. I found the culprit in the IE7 cloneNode implementation, I put down a quick fix (http://jsfiddle.net/rmgVM/17/), I need to check if it will pass the tests, clean it up a bit, make it trigger only if ie<8 things like that.\n. I should add @ibolmo to the discussion, since he was the one opening the ticket #2230\nhttps://github.com/mootools/mootools-core/issues/2230\n. I just noticed that by using splice you can break the elements collection, passing something else: \nhttp://jsfiddle.net/kentaromiura/YzRkk/\nthis is obviously a wrong use of Elements.splice, but probably should be taken into consideration.\n. tested on IE6, it works but it fails on the\nexpect(typeOf($$('div').splice(1, 2))).toEqual('elements');\ntest, which returns 'array' instead.\nSo it needs more works.\n. This has to be redone properly in a branch, I was a git n00b back then and I used master which has been later pulled and pushed improperly (as I didn't knew git pushes on all branches if you don't specify the correct one).\nShould be as simple as to reset to 961d459cb3f9af05e0fbd239d2515c4c9a09dc4f but I have to check When I have a chance. :-/ \n. Just like @arian highlighted this one seems a rather simple problem to circumvent using a closure.\nalso by using your fix, you're not acting coherent with the other event calling, this means that you'll need to change all these other event calling:\nhttps://github.com/bastianschilbe/mootools-core/blob/4cd206e0281dbc3309102771956cbf0b8d43ce0d/Source/Element/Element.Event.js#L42\nhttps://github.com/bastianschilbe/mootools-core/blob/4cd206e0281dbc3309102771956cbf0b8d43ce0d/Source/Element/Element.Event.js#L45\nhttps://github.com/bastianschilbe/mootools-core/blob/4cd206e0281dbc3309102771956cbf0b8d43ce0d/Source/Element/Element.Event.js#L52\nso in current form it couldn't be accepted.\nalso I think it shouldn't be an extra parameter too, but if it should be passed, it needs to be by decorating the event parameter, like real event does.\n. due to an error on the commit I had to close this pull request, please refer to this instead:\nhttps://github.com/mootools/mootools-core/pull/2351\n. @arian please add details\n:trollface:\n. @ibolmo yeah, I would prefer too, but I can't use tailored feature detect on this bug, since before triggering the bug there's no clue and after is too late. It should be ok, because is IE6/7 related and on IE8 is fixed.\n. I tested with nested elements, and seems like my patch will work as it is now, I just need to check on IE6.\ndownloading the VM right now.\n. It's not when you're on a mac and the vm image is in a ... exe format!\n. @arian, I used that, but since it downloads an exe files it doesn't work for me. \nI will trying later to uncompress the exe in another (sigh) vm.\n. Tested on IE6, it has the bug, and the fix works, but it break the Element.clone specs, \nby looking at the specs, I found a couple of logic errors,\nand I think that setAttribute('id', ...) doesn't work at all in IE6, using this.id = ... instead.\nfixing these stuff.\nEDIT: also removeAttribute doesn't return the attribute, but true/false in IE.\nI should write a couple more tests.\n. @arian as you can see by running the new test, Element.erase will not pass :(\nseems that the fugly outerHTML hack pass tough.\n. I don't like the idea of using window since it's the global object only in browsers, since we provide a server build it will be weird, we should use global instead.\n. One more advantage of using global is that is a step forward cjs, since by exporting to global it will work as a cjs pseudo module in https://github.com/mootools/wrapup for example.\n. sorry.\n. LGTM but travis failed\n. using constructor like you said seems to work, tested on ie8, i8/7 standard mode & quirk(6)\nhttp://jsfiddle.net/kentaromiura/FEcXE/2/\n. Actually after thinking about it, the arguments.constructor is Object, so alert(typeOf({length:3})); will fail :(\n:-1:\nI can only suggest to check for checking the Object.prototype.toString, that in all the new browsers return [object Arguments] apart for... guess which browser :P\n. this will solve the problem:\nhttp://jsfiddle.net/kentaromiura/FEcXE/7/\n. in IE it outputs \nobject, object, arguments.\n. I vote for removal.\nbut we can simplify that @WebReflection snippet a bit, since we already have our pre-checks.\n. http://www.css3.info/preview/background-size/\n'20px auto' and '20px' is the same thing, since the latter implicit set the height to auto.\nwhile this test can be fixed by using indexOf I guess it will be better to change \nElement.Styles.backgroundSize='@px @px';\nso we can set it like\nfoo.setStyle('background-size', [20,30])\nand expect 20px 30px,\n[20, 20] returns 20px in chrome while 20px 20px in ff.\n. @SergioCrisostomo \nI think as I suggested in my previous comment that \nElement.Styles.backgroundSize='@px @px'; \nshould fix that without changing anything else and it's more accurate spec-wise. \nNot sure if it will break anything else though since I didn't test (well actually I might have done that when I commented but it was an year ago so I don't really remember)\n@arian suggestions?\n. Assuming the link I posted nearly a year ago has the correct specification for background-size:\nbackground-size:  [ ,  ]*\n = [  |  | auto ]{1,2} | cover | contain\nthat means that background-size can be either 1 or more values and value can be any length, percentage, auto or cover or contain.\nthe code you proposed:\nif (property == 'backgroundSize' && result){\n            if(result.split(' ').length == 1) return result + ' auto';\n}\nwill not be ok in case of cover and contain, in that case background-size shouldn't be amended.\nThe fact FF and chrome returns different results is a non influential one as both results have the same meaning, \nanother discussion should be if MooTools should have a consistent result between browser, iirc for oldIE this is and has never been true, but for now I believe that setting Element.Styles.backgroundSize='@px @px'; (right now it's '@px') and change the test so it'll load two different values and will check against them will be the best solution. \nbut that's just my opinion.\n. I concur with @gonchuki, if the browser computes the value as 'auto' it means it uses that value, and MooTools should return 'auto' so any developer can apply his own logic and choose what to do basing on real value and not made up values.\nBesides since the element.style.zIndex returns '' if the value has been set via css there's no way of fixing this (without reading the css through document.styleSheets and implementing a css parser to know which rules applies to the element)\n. @arian we want this in 1.5, the thing is we could accept as it is, and optimised it later for a single class case using indexOf or a regex (which is a bit of a contraddiction since it's the most used case and the method has always been intended to be used for a single class, that it wasn't never documented nor tested and that is indeed a bug as @cpojer says) as long as we don't document this api misuse.\nto be totally honest I'll prefer that since this is 1.5 and we are introducing breaking changes we get rid of the bug forever, enabling the old current buggy api to work only in compat by setting hasClassList to false (basically what @cpojer suggested) and that we de-facto deprecated by adding an add/removeClasses which is specifically for multiple classes.\n. @arian since we're in proximity of a release date do we want to keep this legacy bug ahead or are you working on splitting this into addClass + addClasses?\n. :+1: \n. mmm wait, this is not what we talked about today, the issue you found today was that var key in object is not sequential, and that's by spec. this is a different thing imho\nEDIT: in fact you opened this 3 months ago.\n. @ibolmo despite the fact that the guy closed the issue, I'll investigate it a bit further, not now though 'cause I'm going to sleep, keep it close for now, I'll reserve to re-open it later if it's a problem.\n. @gonchuki iiuc those are fixes for the 1.2.x branch, right? \nwhat's the current situation 1.2.x doesn't run at all on ie11 or what?\n. @timwienk do you mind let me investigate how much work is to remove all the sniffing from core first ?\n(we can move it temporally in more if it break too much stuff there)\n. while I'm working on removing all the sniffs, I give my twoppence here\n.ie means that the browser is IE, this is the only meaning of that. same as .firefox means that is firefox, is not that Nightly is different from FF.\nI'm really contrary to introduce a modernIE that has no meaning other than a practical one to differentiate from oldIE and the current version of IE, so the only options here is solution 2, with or without the compat thing (using sniffing is wrong but if someone use IE to choose between oldIE and current IE is doing that wrong^2, maybe here the correct thing to do is breaking things, since compat is for behavioural things and not for bug, you still have the choice to not upgrade). \n. step 2/3 for #2570\n. :+1: \n. I confirm that we can make a bat file with\nstart iexplore\nin order to make it work with all IE since win95+.\nSeems that karma passes some parameter, with the url and some id, I'll try to understand exactly how it works since the browser final url should be like http://localhost:9876/?id=6060742 so it seems to me that the bat file should be\nstart iexplore %2=%3, maybe it needs some pause command also, didn't finished checking.\nthen adding the bat file to the browser array.\n. I think null is the correct value to return here since the function has not a boolean prefix like has or is I'll not expect it to return a Boolean, I think it will be ok to just amend the documentation to state that it returns null.\n. tested on Sergio sauce setup here: https://travis-ci.org/SergioCrisostomo/mootools-core/builds/20883686\n. please don't merge as I need to amend 1.5 to 1.4 :P \n. no, this is a breaking change, so it must be in a major version.\n. no, MooTools is 1.Major.Minor :P as per @timwienk's explaination.\n. we are removing Browser sniffing from the normal build, that is breaking enough\n. ok, let's keep Browser.* for this version then.\n. :+1: \n. :+1:\n. this also fixes #2570 \n. :+1: \n. @arian probably I forgot to add \nElement.NativeEvents.wheel=2;\nhere: https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Event.js#L131\nEDIT: http://jsfiddle.net/kentaromiura/8uMgZ/2/\n. @arian @SergioCrisostomo we probably should add a phantomjs test and compare our results to the one of the https://developer.mozilla.org/en-US/docs/Web/Reference/Events/wheel addWheelListener pseudo-polyfill method.\n. This PR is to fix a specific issue that I introduced in 1.5.0, this will now pass the event correctly, also it will allow the new code to set our legacy wheel property.\nIf we want to implement the other properties normalised as described in the MDN page it will be better to do that as an enhancement in another PR targeting https://github.com/mootools/mootools-core/issues/2620, as for the spec I believe we shouldn't sniff in the spec as it's not future proof.\nThe goal of this commit is to ensure that the event is correctly triggerred \nand that the property wheel will be set accordingly, I suggested to listen and then fire all the events and if at least one fires then the spec will pass.\nAs for testing the wheel property I have no idea why it's calculated like that and what it should represent but since it's a legacy property I didn't amend it, also it could probably have different values depending of browsers/os combination, so as long as it's there it should be ok.\nMy suggestion is keeping it there as it is, removing through compat in 1.6 as it will be superseed by the wheel deltaX, deltaY, deltaZ properties. \nAlso bear in mind that those property are already available through the original event.\n. I said that the XYZ properties are a different topic (which are currently passed in the event object anyway iirc) not the .wheel which has to be fixed as @arian just said\n. like @SergioCrisostomo says before this change the grunt build took files using the glob resolution order Source/*/.js,\nsince the website continues to use the php packager, we had different files orders from the website and the grunt build, which makes the diff to those files impossible.\nIdeally the output should be the same anyway, to avoid forgetting to add a new source file in the package.yml.\n. This behaviour is known and It's documented here: http://mootools.net/docs/core/Element/Element.Event#Element-NativeEvents\n\nThe reason to differentiate between 1 and 2 is that 1 is usually used for events that don't have \ninteresting data like: onload, onscroll, and onresize, or it's more performant. The latter two, for \nexample, are fired frequently.\n\nso basically it's like that because scroll is fired as per pixel base (well technically as per unit of scroll which may vary), maybe we could change events type 1 like\nhttps://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Event.js#L45 to \nreturn fn.apply(self, arguments); (well that requires fixing event for oldIE, so it not as simple as passing back arguments).\n. Well, apparenly @cpojer implemented scroll as a type 2 once, https://github.com/mootools/mootools-core/commit/a661859eb9d3d51ea8e4cfb16897f7c8289cbe2a and then had to revert https://github.com/mootools/mootools-core/commit/2f5a4326f438faf4caa8c2336f85f5e9a4265082 while there's no comment to speculate while that revert was done, it was probably causing errors, as I told you we could fix this by passing whatever arguments we have in that function wrapper back to the listener, but some fixes are needed for attachEvent so I'm not sure is a wontfix, + @arian \n. @ibolmo I'm not sure this should be closed tbh\n. this requires adding the message event on the Element.NativeEvents map \nexample: http://jsfiddle.net/kentaromiura/C4TTe/\n. - @GCheung55 \n. \n. So, just to be a bit more argumentative, we think this is definitely an issue, as buttons are used for UX instead of using anchors.\nI can see some problems with your PR, namely:\n- You used Browser sniffing, which we have de-facto deprecated, so instead of doing Browser.name == 'firefox' you should create a bug detection instead, I think a viable solution would be to try to create a button with anything in it, and to use a synthetic event to see if it propagates, as I understand from the bugzilla page this bug isn't just on hover but for any kind of mouse events.\n- the limit thing is weird, you can do a getParent('button') and check if it returns a button instance\n- you also probably don't need to store anything but just to pass the event to the button children, or even better to the this of the addEvent, if anything the actual callback should be stored on the this element as to use the same hack with removeEvent later if necessary\n. Lgtm\n. @ibolmo since it's a pretty simple change for us and it will let devs to have a big security improvement   against simple XSS attacks (*) I've set the milestone for this to 1.5.2\n(*) http://blog.codinghorror.com/protecting-your-cookies-httponly/\n. lgtm\n. :+1: \n. LGTM, there are some more configuration in the grunt folder that we can remove as well, unless we want that to stick around to test locally.. @arian @sergiocristosomo I think Elements::clone should return an instance of Elements and not of Array \n. Ah damn I misspelled @SergioCrisoStomo handle,  sorry Sergio :-(\n. @arian \nToday I updated my test fork here:\nhttps://github.com/kentaromiura/mootools-core/tree/feature-appendHTML-2151\nthat basically is this pull request in which I added Spec, and keeto wrote some docs, \ncan you please double check this, thanks.\n. see #2185\n. tested with 1.4.5 and:\n\nThe animation should be cancelled almost immediately, but in fact it continues and finishes.\n\nthe animation is cancelled immediatly.\nhttp://jsfiddle.net/kentaromiura/UeRNE/\n. The example code here is not a working one, also passing an array to an Fx instance will just animate through the first and second argument, I don't know what the original guy wants to do, but since is not possible to reproduce the bug, I will close it as invalid.\n. IE7 is using the native version, and the native version fires as soon you hit the border of the select box, it needs further testing so moving this to 1.6\n. that's because removeChild doesn't eliminate the node but just remove the child from the element and return it, if you want to really get rid of it just call .destroy() on the result of removeChild.\ntested using the same setup used on https://github.com/mootools/mootools-core/pull/2351 and \nwhile sIEve tells me that using removeChild() will leak about 1000 elements\nusing removeChild().destroy() will drop the leaks from 1000 to 0.\n. No! if there's something people really rely on is the sync'ity of fireEvent, making it async will break tons of code, we can implement fireEventAsync though (with a better name) \n. If we want to break b/c I'd rather implement proper CustomEvents instead,\nsee @WebReflection https://github.com/WebReflection/dom4/blob/master/src/dom4.js#L230-L282 as an example of what I mean.\nBesides, in the link @arian provided Dean Edwards show how to make that work in oldIE as well, so if we have to keep IE8 compatibility we can do a workaround like that onpropertychange (with all the restriction property change has in ie8)\nto keep B/C we can't really use try catch as any code using try catch to get (for example) any possible  window.external exception will not work if we defer the re-throw of the exception.\n. @michaelcm, take a look at this: https://github.com/mootools/mootools-core/pull/2351\n. I found the culprit in the IE7 cloneNode implementation, I put down a quick fix (http://jsfiddle.net/rmgVM/17/), I need to check if it will pass the tests, clean it up a bit, make it trigger only if ie<8 things like that.\n. I should add @ibolmo to the discussion, since he was the one opening the ticket #2230\nhttps://github.com/mootools/mootools-core/issues/2230\n. I just noticed that by using splice you can break the elements collection, passing something else: \nhttp://jsfiddle.net/kentaromiura/YzRkk/\nthis is obviously a wrong use of Elements.splice, but probably should be taken into consideration.\n. tested on IE6, it works but it fails on the\nexpect(typeOf($$('div').splice(1, 2))).toEqual('elements');\ntest, which returns 'array' instead.\nSo it needs more works.\n. This has to be redone properly in a branch, I was a git n00b back then and I used master which has been later pulled and pushed improperly (as I didn't knew git pushes on all branches if you don't specify the correct one).\nShould be as simple as to reset to 961d459cb3f9af05e0fbd239d2515c4c9a09dc4f but I have to check When I have a chance. :-/ \n. Just like @arian highlighted this one seems a rather simple problem to circumvent using a closure.\nalso by using your fix, you're not acting coherent with the other event calling, this means that you'll need to change all these other event calling:\nhttps://github.com/bastianschilbe/mootools-core/blob/4cd206e0281dbc3309102771956cbf0b8d43ce0d/Source/Element/Element.Event.js#L42\nhttps://github.com/bastianschilbe/mootools-core/blob/4cd206e0281dbc3309102771956cbf0b8d43ce0d/Source/Element/Element.Event.js#L45\nhttps://github.com/bastianschilbe/mootools-core/blob/4cd206e0281dbc3309102771956cbf0b8d43ce0d/Source/Element/Element.Event.js#L52\nso in current form it couldn't be accepted.\nalso I think it shouldn't be an extra parameter too, but if it should be passed, it needs to be by decorating the event parameter, like real event does.\n. due to an error on the commit I had to close this pull request, please refer to this instead:\nhttps://github.com/mootools/mootools-core/pull/2351\n. @arian please add details\n:trollface:\n. @ibolmo yeah, I would prefer too, but I can't use tailored feature detect on this bug, since before triggering the bug there's no clue and after is too late. It should be ok, because is IE6/7 related and on IE8 is fixed.\n. I tested with nested elements, and seems like my patch will work as it is now, I just need to check on IE6.\ndownloading the VM right now.\n. It's not when you're on a mac and the vm image is in a ... exe format!\n. @arian, I used that, but since it downloads an exe files it doesn't work for me. \nI will trying later to uncompress the exe in another (sigh) vm.\n. Tested on IE6, it has the bug, and the fix works, but it break the Element.clone specs, \nby looking at the specs, I found a couple of logic errors,\nand I think that setAttribute('id', ...) doesn't work at all in IE6, using this.id = ... instead.\nfixing these stuff.\nEDIT: also removeAttribute doesn't return the attribute, but true/false in IE.\nI should write a couple more tests.\n. @arian as you can see by running the new test, Element.erase will not pass :(\nseems that the fugly outerHTML hack pass tough.\n. I don't like the idea of using window since it's the global object only in browsers, since we provide a server build it will be weird, we should use global instead.\n. One more advantage of using global is that is a step forward cjs, since by exporting to global it will work as a cjs pseudo module in https://github.com/mootools/wrapup for example.\n. sorry.\n. LGTM but travis failed\n. using constructor like you said seems to work, tested on ie8, i8/7 standard mode & quirk(6)\nhttp://jsfiddle.net/kentaromiura/FEcXE/2/\n. Actually after thinking about it, the arguments.constructor is Object, so alert(typeOf({length:3})); will fail :(\n:-1:\nI can only suggest to check for checking the Object.prototype.toString, that in all the new browsers return [object Arguments] apart for... guess which browser :P\n. this will solve the problem:\nhttp://jsfiddle.net/kentaromiura/FEcXE/7/\n. in IE it outputs \nobject, object, arguments.\n. I vote for removal.\nbut we can simplify that @WebReflection snippet a bit, since we already have our pre-checks.\n. http://www.css3.info/preview/background-size/\n'20px auto' and '20px' is the same thing, since the latter implicit set the height to auto.\nwhile this test can be fixed by using indexOf I guess it will be better to change \nElement.Styles.backgroundSize='@px @px';\nso we can set it like\nfoo.setStyle('background-size', [20,30])\nand expect 20px 30px,\n[20, 20] returns 20px in chrome while 20px 20px in ff.\n. @SergioCrisostomo \nI think as I suggested in my previous comment that \nElement.Styles.backgroundSize='@px @px'; \nshould fix that without changing anything else and it's more accurate spec-wise. \nNot sure if it will break anything else though since I didn't test (well actually I might have done that when I commented but it was an year ago so I don't really remember)\n@arian suggestions?\n. Assuming the link I posted nearly a year ago has the correct specification for background-size:\nbackground-size:  [ ,  ]*\n = [  |  | auto ]{1,2} | cover | contain\nthat means that background-size can be either 1 or more values and value can be any length, percentage, auto or cover or contain.\nthe code you proposed:\nif (property == 'backgroundSize' && result){\n            if(result.split(' ').length == 1) return result + ' auto';\n}\nwill not be ok in case of cover and contain, in that case background-size shouldn't be amended.\nThe fact FF and chrome returns different results is a non influential one as both results have the same meaning, \nanother discussion should be if MooTools should have a consistent result between browser, iirc for oldIE this is and has never been true, but for now I believe that setting Element.Styles.backgroundSize='@px @px'; (right now it's '@px') and change the test so it'll load two different values and will check against them will be the best solution. \nbut that's just my opinion.\n. I concur with @gonchuki, if the browser computes the value as 'auto' it means it uses that value, and MooTools should return 'auto' so any developer can apply his own logic and choose what to do basing on real value and not made up values.\nBesides since the element.style.zIndex returns '' if the value has been set via css there's no way of fixing this (without reading the css through document.styleSheets and implementing a css parser to know which rules applies to the element)\n. @arian we want this in 1.5, the thing is we could accept as it is, and optimised it later for a single class case using indexOf or a regex (which is a bit of a contraddiction since it's the most used case and the method has always been intended to be used for a single class, that it wasn't never documented nor tested and that is indeed a bug as @cpojer says) as long as we don't document this api misuse.\nto be totally honest I'll prefer that since this is 1.5 and we are introducing breaking changes we get rid of the bug forever, enabling the old current buggy api to work only in compat by setting hasClassList to false (basically what @cpojer suggested) and that we de-facto deprecated by adding an add/removeClasses which is specifically for multiple classes.\n. @arian since we're in proximity of a release date do we want to keep this legacy bug ahead or are you working on splitting this into addClass + addClasses?\n. :+1: \n. mmm wait, this is not what we talked about today, the issue you found today was that var key in object is not sequential, and that's by spec. this is a different thing imho\nEDIT: in fact you opened this 3 months ago.\n. @ibolmo despite the fact that the guy closed the issue, I'll investigate it a bit further, not now though 'cause I'm going to sleep, keep it close for now, I'll reserve to re-open it later if it's a problem.\n. @gonchuki iiuc those are fixes for the 1.2.x branch, right? \nwhat's the current situation 1.2.x doesn't run at all on ie11 or what?\n. @timwienk do you mind let me investigate how much work is to remove all the sniffing from core first ?\n(we can move it temporally in more if it break too much stuff there)\n. while I'm working on removing all the sniffs, I give my twoppence here\n.ie means that the browser is IE, this is the only meaning of that. same as .firefox means that is firefox, is not that Nightly is different from FF.\nI'm really contrary to introduce a modernIE that has no meaning other than a practical one to differentiate from oldIE and the current version of IE, so the only options here is solution 2, with or without the compat thing (using sniffing is wrong but if someone use IE to choose between oldIE and current IE is doing that wrong^2, maybe here the correct thing to do is breaking things, since compat is for behavioural things and not for bug, you still have the choice to not upgrade). \n. step 2/3 for #2570\n. :+1: \n. I confirm that we can make a bat file with\nstart iexplore\nin order to make it work with all IE since win95+.\nSeems that karma passes some parameter, with the url and some id, I'll try to understand exactly how it works since the browser final url should be like http://localhost:9876/?id=6060742 so it seems to me that the bat file should be\nstart iexplore %2=%3, maybe it needs some pause command also, didn't finished checking.\nthen adding the bat file to the browser array.\n. I think null is the correct value to return here since the function has not a boolean prefix like has or is I'll not expect it to return a Boolean, I think it will be ok to just amend the documentation to state that it returns null.\n. tested on Sergio sauce setup here: https://travis-ci.org/SergioCrisostomo/mootools-core/builds/20883686\n. please don't merge as I need to amend 1.5 to 1.4 :P \n. no, this is a breaking change, so it must be in a major version.\n. no, MooTools is 1.Major.Minor :P as per @timwienk's explaination.\n. we are removing Browser sniffing from the normal build, that is breaking enough\n. ok, let's keep Browser.* for this version then.\n. :+1: \n. :+1:\n. this also fixes #2570 \n. :+1: \n. @arian probably I forgot to add \nElement.NativeEvents.wheel=2;\nhere: https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Event.js#L131\nEDIT: http://jsfiddle.net/kentaromiura/8uMgZ/2/\n. @arian @SergioCrisostomo we probably should add a phantomjs test and compare our results to the one of the https://developer.mozilla.org/en-US/docs/Web/Reference/Events/wheel addWheelListener pseudo-polyfill method.\n. This PR is to fix a specific issue that I introduced in 1.5.0, this will now pass the event correctly, also it will allow the new code to set our legacy wheel property.\nIf we want to implement the other properties normalised as described in the MDN page it will be better to do that as an enhancement in another PR targeting https://github.com/mootools/mootools-core/issues/2620, as for the spec I believe we shouldn't sniff in the spec as it's not future proof.\nThe goal of this commit is to ensure that the event is correctly triggerred \nand that the property wheel will be set accordingly, I suggested to listen and then fire all the events and if at least one fires then the spec will pass.\nAs for testing the wheel property I have no idea why it's calculated like that and what it should represent but since it's a legacy property I didn't amend it, also it could probably have different values depending of browsers/os combination, so as long as it's there it should be ok.\nMy suggestion is keeping it there as it is, removing through compat in 1.6 as it will be superseed by the wheel deltaX, deltaY, deltaZ properties. \nAlso bear in mind that those property are already available through the original event.\n. I said that the XYZ properties are a different topic (which are currently passed in the event object anyway iirc) not the .wheel which has to be fixed as @arian just said\n. like @SergioCrisostomo says before this change the grunt build took files using the glob resolution order Source/*/.js,\nsince the website continues to use the php packager, we had different files orders from the website and the grunt build, which makes the diff to those files impossible.\nIdeally the output should be the same anyway, to avoid forgetting to add a new source file in the package.yml.\n. This behaviour is known and It's documented here: http://mootools.net/docs/core/Element/Element.Event#Element-NativeEvents\n\nThe reason to differentiate between 1 and 2 is that 1 is usually used for events that don't have \ninteresting data like: onload, onscroll, and onresize, or it's more performant. The latter two, for \nexample, are fired frequently.\n\nso basically it's like that because scroll is fired as per pixel base (well technically as per unit of scroll which may vary), maybe we could change events type 1 like\nhttps://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Event.js#L45 to \nreturn fn.apply(self, arguments); (well that requires fixing event for oldIE, so it not as simple as passing back arguments).\n. Well, apparenly @cpojer implemented scroll as a type 2 once, https://github.com/mootools/mootools-core/commit/a661859eb9d3d51ea8e4cfb16897f7c8289cbe2a and then had to revert https://github.com/mootools/mootools-core/commit/2f5a4326f438faf4caa8c2336f85f5e9a4265082 while there's no comment to speculate while that revert was done, it was probably causing errors, as I told you we could fix this by passing whatever arguments we have in that function wrapper back to the listener, but some fixes are needed for attachEvent so I'm not sure is a wontfix, + @arian \n. @ibolmo I'm not sure this should be closed tbh\n. this requires adding the message event on the Element.NativeEvents map \nexample: http://jsfiddle.net/kentaromiura/C4TTe/\n. - @GCheung55 \n. \n. So, just to be a bit more argumentative, we think this is definitely an issue, as buttons are used for UX instead of using anchors.\nI can see some problems with your PR, namely:\n- You used Browser sniffing, which we have de-facto deprecated, so instead of doing Browser.name == 'firefox' you should create a bug detection instead, I think a viable solution would be to try to create a button with anything in it, and to use a synthetic event to see if it propagates, as I understand from the bugzilla page this bug isn't just on hover but for any kind of mouse events.\n- the limit thing is weird, you can do a getParent('button') and check if it returns a button instance\n- you also probably don't need to store anything but just to pass the event to the button children, or even better to the this of the addEvent, if anything the actual callback should be stored on the this element as to use the same hack with removeEvent later if necessary\n. Lgtm\n. @ibolmo since it's a pretty simple change for us and it will let devs to have a big security improvement   against simple XSS attacks (*) I've set the milestone for this to 1.5.2\n(*) http://blog.codinghorror.com/protecting-your-cookies-httponly/\n. lgtm\n. :+1: \n. LGTM, there are some more configuration in the grunt folder that we can remove as well, unless we want that to stick around to test locally.. ",
    "SergioCrisostomo": "I am ok with that. @ibolmo @arian ?\n@kentaromiura np, I'm not so good at my name either :-) \n. I supose https://github.com/mootools/mootools-core/pull/2604 fixes this issue, when/if it gets merged.\n. Related: https://github.com/mootools/mootools-core/pull/2520\n. I just checked this on Opera, Chrome, Firefox and IE11 and IE8 and all browsers return now anchortag. \nLooks like all major browsers support mouseenter now.\nThank you @dawolf for bringing this up!\n. @gonchuki could you check the PR Arian  linked (& related issue in it), if you have some time? I'm proposing a change of order in your code and you might want to have some input about it... Thanks!\n. Tested this idea on a branch in my repo and then minified it with grunt-uglify. \nThe resulting code passed the specs and looks like\n!function(a){a.MooTools={version:\"1.5.1-dev\",build:\"%build%\"};var b=a.typeOf=function(a){if(null==a)return\"null\"; etc.....\nThe original minified file (before this change) was 83Kb, after the change was also 83Kb, just some bytes difference. \nI don't say this is a bad idea but got the idea that code source is already well written and that the occurrences of the this word is low in our code.\nShould I send a PR with this changes or should we close this issue?\n. Travis fails on PhantomJS tests. We could add a bypass to phantom.js in the specs for this.\n. Related: https://github.com/mootools/mootools-core/issues/2551\n. @kentaromiura @arian can this be added directly after this line\nif (property == 'backgroundSize' && result){\n            if(result.split(' ').length == 1) return result + ' auto';\n        }\nThat would make it consistent when the value returned is just one parameter, it would add auto as referred here\n\nIf only one value is given the second is assumed to be \u2018auto\u2019.\n\nHere is a fiddle with my PR code for fixing background-position issue, plus this code suggestion I posted here for the background-size. (In this case the tests would need to be changed to expect \"20px auto\" in case either \"20px auto\" is given or just \"20px\")\nEdit: Tested the fiddle on VM (IE6/7/8/), FF, Chrome ad Safari and it worked.\n. @kentaromiura I'm curious about your suggestion, and to learn from it. How could changing to '@px @px' correct this? I don't see where getStyle checks if Element.Styles.backgroundSize has 2 parameters?\nHere is a fiddle with the Element.Styles.backgroundSize='@px @px';, and no extra if() for background-size. \nI get different results still in FF & Chrome.\n. @arian  @kentaromiura Can we close this?\n. :+1:  \nJust merged this on my master and tested on Travis. Got green.\n. @okolvik good that you commented, i did not noticed you update.\nI just had time to run your code on our test suite and all looks good. \nThis fix is in the list for 1.5.1. Thank you!\n. Example of the broken behaviour: http://jsfiddle.net/Ss8k2/2/\nThis PR is a good step to fix this but fixes only partially the problem: http://jsfiddle.net/Ss8k2/\n. @swhiteman +1\ncan you find some time to fix a PR for this?\n. LGTM.\n@arian @ibolmo Can I merge this with a docs update on the options with:\nwithCredentials - (boolean: defaults to false) allows you to set xhr.withCredentials without sending http authentication.\n. @ccampbell awesome work indeed. \nWish we would have such complete PRs more often.\nThank you! \n. This is a interesting issue since @arian 's jsFiddle behaves different if More is included or not, respective pageup / !. I just tested More with all the Core specs inside it and got no extra failing Spec. That is good. But would like also to be able to Spec this one and see that different behavior reflected there.\nI didn't manage to use Syn with SHIFT, but asked them for help on that.\n. @ibolmo @arian could this be a good spec for this: https://github.com/SergioCrisostomo/mootools-core/commit/d293e9893d4dc5455c59c3d9983170244844df6d ? \n. :+1:\n. Hi @JustOff ! \n1.4.5 compat version does provide the set method for opacity. Not sure if it will be kept in the future, but in 1.4.5 compat it does. Check here: http://jsfiddle.net/EUrFZ/\nI close this now. Please reopen or comment if you feel this does not answer your question.\n. @manojnelluri why to include jQuery?? Because of $('#result').html() ? \nThen you can use $('result') for selecting that element by ID \nand .get('html') for \"getting\" the html.\nBut I'm not sure you are talking about same thing as this issue is about...\n. As this is IE8 specific and documented I would say this is a wont-fix and should be closed. The solution often used in IE is to create a new element with the new type and replace the existing one. But that seems a bit ugly. Fortunately IE9+ don't have this problem anymore. \nThank you @DissidentRage  for pointing out a valid problem and you others for extra input.\nAs always do comment again if you feel this should not be closed.\n. @BjoernKW i know some time has passed, but could you create a jsFiddle to reproduce this?\ncheers\n. Actually .getBoundingClientRect is not consistent here. Since IE8 doesn't support svg anyway we could use .getComputedStyle instead. Eventually just for svg elements?\nCheck this specs and how .getBoundingClientRect gives different results in FF & Chrome: http://jsfiddle.net/msg3y/\n. @arian if I open that fiddle on FF 28 & 29 I get two broken specs.\nDon't you? or am I missing the point here?\n. @ibolmo Travis is green because there is no specs checking for this, and Travis is only checking PRs with PhantomJS.\nAbout the specs missing, it wont be for long... \n. So,\n- FF returns undefined for  offsetHeight and offsetWidth in svg elements. This means the current code is useless for svg elements\n- FF is inconsistent with .getBoundingClientRect for svg elements and fails in the specs for IE9> which seems to return undefined for elements with visibility: hidden\n- getComputedStyle seems to be consistent cross browsers and could be used for svg elements only\nWhat to do?\nSolution 1:\nUse getBoundingClientRect for svg elements and wait for FF devs to fix it. MooTools will deliver a inconsistent value cross-browsers for svg elements\nSolution 2:\nUse getComputedStyle for svg and consider the border and padding as the docs describe in getSize(). In that case we would end up with many lines just for this fix... Something like this:\nvar gCS = window.getComputedStyle(el);\n    var gCScomponents = [gCS.height, \n                         gCS.paddingTop, \n                         gCS.paddingBottom, \n                         gCS.borderTopWidth, \n                         gCS.borderBottomWidth].map(function (v, i) {\n        return parseFloat(v.match(/([0-9]{1,})/));\n    });\n    var gCSheight = 0;\n    gCScomponents.each(function(value){\n        gCSheight+=value;\n    });\n    // and do same for width\nSolution 3:\nA smarter guy than me will tell me soon...\n\nP.S.: @Bilge how do you suggest to use getBBox()? does that return the size? I found this issue that might be related to this also. Fiddle (bug on FF): http://jsfiddle.net/kWWDK/53/\n. This problem happens when the CSS position is not defined. This is not MooTools related but maybe  MooTools could provide a fix for this(?).\nI made a  a fiddle with the problem, adapted from @sitorush 's link. \nOne idea could be something like this:\nfunction zIndexGetter(ele) {\n        var inlinePosition = ele.style.position;\n    ele.style.position = 'relative';\n    var parents = ele.getStyle('z-index') != 'auto' ? [ele] : ele.getParents();\n    ele.style.position = inlinePosition;\n            var toReset = [],\n        definedParent;\n    for (var i = 0; i < parents.length; i++) {\n        var el = parents[i];\n        if (el.getStyle('z-index') == 'auto') {\n            var inlinePosition = el.style.position;\n            el.style.position = 'relative';\n            if (el.getStyle('z-index') != 'auto') {\n                definedParent = el;\n                break;\n            }\n            if (i > 0) parents[i - 1].style.zIndex = 'inherit';\n            toReset[i] = {\n                index: i,\n                positionToRestore: inlinePosition\n            };\n        } else {\n            definedParent = el;\n            break;\n        }\n    }\n    toReset.each(function () {\n        parents[this.index] = this.positionToRestore;\n    });\n    return definedParent.getStyle('z-index');\n}\njsFiddle example here. This works on IE8+, Chrome, FF and Safari 7.\nIf more people think this is worth a try I can sleep on it and make a better version.\n. @gonchuki, yes, sure. We either close this issue or find a fix for it. Since it was still open I just made a suggestion. Still if a element has defined z-index and getter returns auto something is wrong.\n. @gonchuki , yeah, nice to have your insight here!\nHave one more doubt, in this case should getStyle return 100 for A1 or is auto the correct value (although z-index for A1's parent is > B)\n. @gonchuki, found my answer, so I am also settled with this issue now. \nThank you again for input in this!\nFrom W3C:\n\nCSS value: auto\nThe stack level of the generated box in the current stacking context is 0. The box does not establish a new stacking context unless it is the root element.\n. I follow this discussion with no opinion, just sure that I will learn from it!\n\nI posted above a fiddle with the Mootools version of the link @sitorush posted. This gives:\n```\n// Chrome\nExample 1 z-index = 'auto', expected = 4\nExample 2 z-index = 'auto', expected = 4\n// IE & FF\nExample 1 z-index = '4', expected = 4\nExample 2 z-index = 'auto', expected = 4\n``\n. This is related to MooTools More and has already it's own [issue](https://github.com/mootools/mootools-more/issues/1088). Closing it here,\nThanks @cosmobile for bringing it up.\n. @jmarikle44i could you adapt this fiddle (http://jsfiddle.net/9V7zd/) to show the problem/solution better? then we can bild a specs from this.\n. I confirm FF is broken on this: http://jsfiddle.net/he5UU/13/\n. This is fixed in Firefox 52. Closing.. @ickata, maybe a bit late but can you make a fiddle with this issue to make it more clear? thanks!\n. @ickata I see your problem... in the specific case of the` element, this has to do with it's properties. \nselect elements always have length, the length is the number of <option> children, but even when empty the length is defined and is 0\nSo maybe Array.from() is doing the correct behavior here, for the specific case of  <select> element, checking the length is defied and checking its children. \nBtw, just FYI, found out that this has been discussed in the past.\n. This should be possible if this gets done. In the docs: https://github.com/kamicane/moofx/blob/e032c2d9639425501fd0756b275db2870e9b8988/README.md\n. @Bilge you could use a combination of a class with CSS transitions instead: http://jsfiddle.net/6FJSj/\n. @longwolf could you make a fiddle recreating this issue?\n. @longwolf no problem. Thanks for reporting it.\n. @arian nice input. Ok, so radio type also. Would this be a ok solution?\nA fiddle with this idea would be like this.\n. @cpojer imho arian's solution is a good one: :+1: \njQuery adds also multiple classes, space separated, with addClass method (singular). \nThis would add the desired classList and would transform the current \"bug\" that allows to add multiple classes into a upgraded version of addClass. One more nice feature for 1.5\n. Made a simple test about this. Without this change and with this change and the difference was around 1000% faster in a modern browser with the new code. There might be better ways of testing but this is clearly a enhancement.\nI made a branch with this and rebased against master. Then tested this on SauceLabs went green.\n. @RiZKiT do you have time to propose a PR for this?\n. @RiZKiT great, thank you!\nBy PR I meant Pull Request. If you have time for it would be great...\nOtherwise I will try to dig into it next week.\n. Could one of you (@ghost, @WernerWenz or @orthecreedence ) add some working example for this? if possible a jsFiddle with specs example?\nP.s: Andrew your comment on reddit made find about this PR :)\n. @MannyDev could you make some specs for this? if you need help on that let me know.\n. @cocapiznut , not clear what you mean. Could you check this fiddle: http://jsfiddle.net/eKn4u/ ?\nCan you reproduce your problem in a fiddle and post back?\n. @gonchuki thanks for input! \nI had not managed to test yet as you suggested. Will close this and think over about a fix for this. Thanks\n. :+1: \n. @platjen thank you for your feedback! Can you make a jsFiddle with the problem and post back?\nThanks!\n. Very nice input! Thanks, will fix.\n@ibolmo: about JSON.secure, you are right. \nBtw, where/why is it used? Do not find it anywhere else in Mootools?\nWill make some specs for this also following your suggestions. \nShould I add it in the 1.5base or 1.5client?\n. @ibolmo the JSON.secure is a bit weird. It was added in the 2.0 branch https://github.com/mootools/mootools-core/commit/c04d545939d4c1c1287a448d947a142ed05b7f80 and I find no other reference to it in all  Core & More files. \nIt is not documented in the docs either afaik.\nSo if we add JSON.secure = true; it has to be added to the docs and developers wanting to use \"the eval way\" would have to make a double false. On the function parameters and a JSON.secure = false;\nI'm ok with adding it. Also ok with leaving it out (i.e not adding JSON.secure = true;).\n. @ibolmo , thanks for your time checking this!\nI'm still not sure I follow you. I see 3 scenario:\n1- Adding both JSON.secure = true; and if (secure == null) secure = JSON.secure;\nThis means default behavior is secure. And to make it un-secure user has to use JSON.secure = false; which is not documented. \nIf user uses JSON.secode(string, false); as documented, that alone would turn to true anyway because of JSON.secure = true;.\n2- Adding just JSON.secure = true; (and keeping  if (secure == null) secure = true;)\nThis means default behavior is secure. But to override it and go un-secure user needs to use double false:\nJSON.secode(string, false);\nJSON.secure = false;\n3- Using as it is now, in the PR. ( and the right one in my logic)\nThis means default behavior is secure. To override user would use, as documented already, just JSON.secode(string, false);\n\nJSON.secure seems to be kind of a backdoor/alternative, not documented.\n. @ibolmo I think I figured it out now with the compat layer. \nI added a compat layer, and with that I also removed future reference to JSON.secure without the compat.\nLet me know if it looks ok.\n. @ibolmo I was misunderstanding the compat layer's behaviour. I updated the PR code and docs now.\n. This PR has to be refactored after Olmo's new Specs PR is merged.\n. @ibolmo will do that. \nI supose I don't need the package.yml and Configuration.JS files anymore? \nI see also a new directory structure without /1.5base/ so I suppose the mootools-packager script goes forEach directory inside the Specs and the compat layer info goes inside the respective specs .js file, with compat comment tags when needed.\nI run the specs adding my new JSON.js specs to the one on JSON.js specs file from your repo and they worked good with grunt.\n. @ibolmo updated the PR with new master.\n. @ibolmo could you merge or give your :+1:  on this? would be nice to get this into 1.5 also to avoid eval unnecessarily.\n. modernie needs to go in a compat block, will update later if no one has sent the right PR yet\n. @ibolmo : There is a pending PR for this that @timwienk prepared.\n. I have no decision here, go for what is more correct/decided.\nMy thoughts:\n1.4 code (and 1.5 compat) should see IE11 as Browser.ie to not break BC\n1.5 code  (ie 1.5 no compat) would have a \"back door\" using Browser.modernie\nIn this case maybe:\njs\nif (Browser.name == 'ie'){\n    if (Browser.version >= '11') {\n        Browser.modernie = true;\n    } else {\n        Browser.ie = true;\n    }\n    //<1.4compat>\n    Browser.ie = true;\n    //</1.4compat>\n} else {\n    Browser[Browser.name] = true;\n}\n. @timwienk  I trust you better than me on this, I was just commenting.\nIf the decided was that go for it! I have nothing to opose.\nWill be nice to see this done.\n:+1: \n. :+1: \n. Pong! Just tested this with our Specs and result is green. \n:+1: from me.\n\nNot related to this PR: tested also restoring the root.msMatchesSelector in that same line, but Specs falied in IE9. \nConclusion: @cpojer was right and can see into the future!\n. Updating with some ideas and tests discussed on #IRC today:\n- Travis & Sauce block the connection for testing PRs from external source, to protect from PRs with malicious code like console.log(SAUCE_ACCESS_KEY)\n- If the Sauce username & password are not encrypted then Travis/Sauce will work and run the full task on the PR. \nSince our SAUCE_ACCESS_KEY are encrypted, this PR is to allow gruntfile to distinguish when the test is for a PR and just run it with PhantomJS. ANd if it's not a PR (ie a merge) the whole test will be done. \n. Updated after nice ideas from @arian  on #IRC. \nWith this PR both defaultand nocompat will run in separated tasks for IE6-11, FF, Chrome and Safari 5-7.\nOne thing I wonder and wanted: avoiding running extra tests in PhantomJS in case of PR. I would like that a Pull Request would only trigger 1 build with 1 test, and not this. But that seems not to be possible from what i have asked and read.  I don't see it as a problem either.\n. @GCheung55 nice to have you checking this also. My tests on my master ran 4 (sometimes 5) tests parallel, and no failure because of too many builds. When one of them is done, the next fires. Maybe since we have 10VM's it will run even faster, more simultaneous.\nThe advantage here is that it will be more clear what is failing and what is passing, since the other tests make a too long log. These are also checking both compat and nocompat.\nWe could merge this and checkit. To be honest I will learn by seing it happen since I only tested with my own repo, ie not much experience with Travis from before.\n. I wonder if it's worth the extra work just for IE6. Apparently just 0.1% uses IE6, assuming this is not the stats error margin it might be like @kentaromiura commented one day: Those are all the developers still testing IE6. Stop it!\n:)\n. @jdmichal, can you make a PR for this and a specs for this?\nSeems the specs are already looking for the right thing, consistent with the code.\n. @jdmichal or @swhiteman  could you make a PR to correct this? otherwise let us know and we fix it.\n. :+1:  - tested this on SauceLabs and got green\n. :+1: \n. :+1: \n. Ping...\n. Great work! Very nice!\n. :+1: \n. @SCHOLAR-Graeme, interesting issue, thanks for bringing it up.\nI noticed that changing the order of these two lines fixes this problem. Does anyone see a possible backside to this change? (tested the specs with this idea and all is green)\nhttp://jsfiddle.net/cgXe4/1/ (fixed version)\n. @arian @kentaromiura @ibolmo @timwienk  do you see any down-side of changing these two lines? \n. @olvlvl I'm not sure this should be a Core feature in MooTools. \nLets wait to hear from the other Devs.\nBut its a good idea, and a very well done PR!\nMaybe this is suitable for More? and with that more optional for users instead of a Core feature...\n@anutron, your thoughts about eventually having this in More?\n. @DimitarChristoff ++\nCould you send a PR for that and with it close #2548 ? would be very nice...\n. Maybe we could build those 4 files from the automagical shell script that @timwienk just made? Otherwise maybe a release hook running a new task in the gruntfile.\n. I wasn't sure if the shell script could build, but now I know more :)\nI will check the git-release-hook and see if we can use that to build files via Gruntfile.\n. (sorry it took me some time to answer on this)\nSo,\nI would like us to follow @ibolmo 's suggestion  and simplify this method. \nThe docs say:    \n\nElement shortcut method for tween with opacity. Useful for fading an Element in and out or to a certain opacity level.\n\nThe code needed to support what the Docs say .fade() should do is:\nfade: function(method){\n    var tween = this.get('tween');\n    if (!method || method == 'toggle') method = this.getStyle('opacity') ? 'out' : 'in';\n    if (method == 'in') tween.start('opacity', 1);\n    if (method == 'out') tween.start('opacity', 0);\n    if (method == 'show') tween.set('opacity', 1);\n    if (method == 'hide') tween.set('opacity', 0);\n    if (typeof method == 'number') tween.start('opacity', method); // corrected after Olmo's sharp eye\n    return this;\n},\nQuestion #1:\nwould it be more performative with else if instead of many if?\nQuestion #2:\nThe specs refer to a \"old\" method that allows to do .fade(from, to). I did not find this in the docs. Looked from 1.2 to 1.5. Unless I am wrong I vote for removing that spec.\nIf this is needed we could add something like:\nif (arguments.length == 2) {\n    tween.set('opacity', arguments[0]);\n    tween.start('opacity', arguments[1]);\n    return this;\n}\nbut still remove these specs\nQuestion #3:\nShould fade set visibility? There is no problem with opacity as I could see in IE6, or IE8 (ping @kentaromiura ). This fiddle works good in those old IE's making the element \"disapear\". So the visibility could be set in the onComplete event of the tween instead. \nIf we decide to keep this behavior that fade sets visibility both on fade-in and fade-out, then we need to use something like this.\n. @ibolmo, you were right about the \"note\", i edited/corrected above.\n(and thanks for nice feedback!)\nAbout visibility, it's tricky I think.\nOne option is to add this line under, inside the stop: method of FX.js, just before the complete events starts to fire (here):\nif (this.to && this.to.opacity) this.element.setStyle('visibility', this.to.opacity[0].value == 0 ? 'hidden' : 'visible');\nThis will also be applied in other tween of opacity, not just fade.\nAnother option, based on the one above, is adding a flag on the storage, and retrieve/reset inside the stop:. This would avoid visibility been set when !fade\nOtherwise I see only the \"chain option\" as is in the PR, based on what @arian added to solve past problems; i.e. that the setStyle('visibility') is passed into the chain to be ran at the end, thought after the complete event is called which is not so good.\n. @ibolmo setOpacity does not currently set visibility in browsers with hasOpacity or hasFilter. The fade is currently the one to do this by adding a setStyle('visibility') in the tween.chain. This was added here.\nIf we change this behaviour, so that when setStyle('opacity') is called visibility is also set, then these aditions (marqued with +) would do the job (specs looks green) and could be used use the new re-factored code posted above. This idea to always set visibility was abandoned before. So setStyle should only change the actual prop passed.\nIf we set visibility only when fired from a fade, here is my suggestion (http://jsfiddle.net/ZzZEF/), based on Olmo's refactor and @arian 's chain idea:\n``` js\nfade: function(method){\n    var tween = this.get('tween');\n    if (!method || method == 'toggle') method = this.getStyle('opacity') ? 'out' : 'in';\n    //<1.3compat>\n    if (arguments.length == 2) {\n        tween.set('opacity', arguments[0]);\n        tween.start('opacity', arguments[1]);\n        return this;\n    }\n    //1.3compat\n    if (method == 'in') tween.start('opacity', 1);\n    if (method == 'out') tween.start('opacity', 0);\n    if (method == 'show') tween.set('opacity', 1);\n    if (method == 'hide') tween.set('opacity', 0);\n    if (typeof method == 'number') tween.start('opacity', method);\n    var to = tween.to[0].value, visible = this.getStyle('visibility') == 'visible';\nfunction changeVisibility(value, $tween){       \n    if ($tween.$chain.length){\n        $tween.chain(function (){\n            this.element.setStyle('visibility', value);\n            this.callChain();\n        });\n    } else {\n        this.setStyle('visibility', value);\n    }\n};\n\nif (to && !visible) changeVisibility.call(this, 'visible', tween);\nif (to == 0 && visible) changeVisibility.call(this, 'hidden', tween);\nreturn this;\n\n},\n```\nWould be nice to have @arian looking at this refactor since he was the one to fix the  opacity only setting visibility if fired from a fade\n. @arian could you give your opinion here? \n. Really nice feedback from you guys!\nI made now a new approach and cleaned the PR.\nAdded a Spec that reproduces the problem described at #2593 and got green specs.\nWould this be a ok approach?\n. @lastwebdesigner thank you for reporting this. We will take a look at it asap.\nUpdated fiddle: http://jsfiddle.net/8uMgZ/1/\n. @szegheo we had some more fixes planned for the 1.5.1 release, but I supose we could release this fix together with some pull requests already in the queue, and the other ones in 1.5.2.\nLets wait for more feedback from the team. \n. :+1: \n. @arian made a spec for this: https://github.com/SergioCrisostomo/mootools-core/commit/2bdebf1f3be0108aa60d2c3513f1d10c46a2855f\nTested specs with this PR's changes and got green. \nWithout this PR fails on Chrome and FF (http://jsfiddle.net/tDqF5/).\n@kentaromiura if you want you could add this spec to your PR, or someone else merge both.\n. Can we merge this PR + the spec I made and discuss the deltaY in the new created issue #2620 ?\nThis fix is reason enought for 1.5.1 imho\n@ibolmo ? @arian ?\n. @arian I think I missed your point first, sorry. \nI tried now the wheel property and in fact it doesn't behave same, when Firefox listens do wheel (instead of DOMMouseScroll) then event.detail == undefined. This makes us add one more check point.\nI made one more commit to fix that (1cd56d7e3fc4df43449b194c3ae8eb02b23d514d).\nTested in IE7~11, latest FF and Chrome (windows & mac), Opera (win), Safari 7\n. @kentaromiura ping\n. Here is a spec for this issue that me and @kentaromiura think is ok (https://github.com/SergioCrisostomo/mootools-core/commit/9814075e0132c0d09e6f559ab9eed4d784900bb5). \n@kentaromiura suggest the broken e.wheel to be in a separate pull request and I say yes to that. If someone else also gives OK on this spec it can be merged and I will send another pull request with a fix suggestion I have for the broken e.wheel.\n. @gonchuki thank you for nice feedback! \nI addressed all your suggestions. \nChanged !document.addEventListener with !hasGetComputedStyle.\n. @ibolmo Updated and re-tested.\nThank you for feedback here too!\n. @ibolmo updated! Fixed your suggestions and re-tested.\n. The dependency order is not broken. The packager still uses YAML headers.\nSome files like Morph and Tween have same dependency Fx.CSS and they would be compiled in different order in alphabetic or by the array returned by the package.yml.\nThis change was discussed and requested at IRC to be able to check the diff between php packager and grunt-packager more easy, so the file structure would be the same.\n. Refactored this PR to remove changes in tag-release, added dist files, and added @satazor 's bower.json. Tested also..\nWelcome to re-check/review!\n@ibolmo added a 'quick' PhatomJS task for each dist/'.js (maybe overkill) to be on the safe side.\n@satazor obrigado!\n. @olvlvl thank you for this fix. \nWe are just discussing which browsers we will stop supporting for next versions. Would be great to have your help on that future \"clean up\" work.\nSalut!\n. Merged by 2c72ef2f0f9fdb54e94da825dae2b6bb42da6b5e\n@olvlvl we are making a road make to the next release. I will be happy to share it with you.\nNice!\n. @gonchuki : @anutron : => thank you for feedback!\nAdded one more commit which addresses your remarks.\n. @ibolmo Updated and re-tested.\nI am really happy for the feedback. I do not see it as spam.\nThank you!\n. @arian this PR fixes the set('thml', issue. \nThere is another related issue (#2265) about set('text', where you already did most of the work. \nI continued your idea and reached this commit which fixes set('text', and also the code/error you posted in the comment in #2265. \n(http://jsfiddle.net/H42T2/)\nQuestion: Should I add that commit to this PR and close both issues? \n(if you guys think this PR is a ok solution, of course).\n. @ibolmo Updated and re-tested.\nThank you!\n. :+1: \nGreen specs\n. Good catch! \n++\n. @arian I think just one commit went to Core\\Slick and is not synced: f0fa94b6be677a522e384d00e2d4505109e1632c\n. Merged by 8a3d56285df5c6e7f56028db93adec75974fdb1b\nNice that you also made a PR for this on Slick. Thanks.\n. @ibolmo updated!\n. Good point @anutron, my bad.\n. @arian great feedback, thank you. \nUpdated, re-tested, re-based also.\n. @kentaromiura: nice! \nCan someone check this so we moo on to 1.5.1 ?\n. If i understand the problem right, seems like same behavior in vanilla JS\nhttp://jsfiddle.net/4FFFn/2/\n. @ickata: Anyway, and although not MooTools related, it is a weird behavior.\n. Thank you @barriteau \n. @diegoflorez we added this to the 1.6 issue review list. \nIf you can make a pull request with the new code and a spec for it would be great!\nYou can find a spec example here.\n. @mzabriskie I think the problem here is that the tag 1.5.0 did not yet had a bower.json file and dist/ folder.. \nSo only 1.5.1 will have bower.json and dist/ in a release tag. If you do \nbower install https://github.com/mootools/mootoolscore.git#be3d04548a6d8947375a37b147cc0027854b9012\n(which is the latest commit) the dist/ folder will get added.\nI think this will be auto-fixed when we tag 1.5.1 in the next days.\n. I close this issue now as I believe this will be fixed by the new tag 1.5.1 itself.\nDo re-open if I missed something.\nCheers!\n. @mzabriskie we just released 1.5.1 so this is now up-and-running.\n```\n$ bower install mootools\nor\n$ bower install https://github.com/mootools/mootools-core.git\n```\n. @AmatanHead really nice PR! \n@ibolmo, @arian anything you would like to comment, discuss or add here?\n. The script @timwienk made is perfect for tagging new releases and change version and build in Source/Core.js and package.json.\nWe now need a way to tag also the bower.json and dist folder files (4 files). \nMy pull request is a attempt to solve that. When I do bash tag-release 1.5.1 from Mavericks command line it works for me. It does what the original script did plus it tags bower.json and the dist files and deletes the dist folder after tagging, as discussed in #IRC.\nIf this pull request is bad, there are different options. One is that someones makes a better one that solves the problem (@timwienk is the most qualified i supose), other option is that someone points me errors on it so I make it better and learn something, other option is we just do the tagging by hand.\n. @jpdery ping\n. @AnitaAtyi thank you for the feedback.\n@jpdery please reopen if you think this is a problem in Core .\n. @odysseuscm thank you for pointing this out. \nIt has been fixed and added for the 1.5.2 release. \nPlease use the fix applied there meanwhile.\n. @arian that makes much more sense.\nYou are right, we had already the value from before and were writing-over with a undefined.\nUpdated the pull request.\n. Should we open a issue about removing Safari 5 code and close when we have done it?\n. :+1: \n. @Addviso could you provide a jsFiddle with an example of the problem?\n. Closing this as discussed in #2662. If new ideas comes up would be nice to fix this indeed.\n. nice name, nice work :) would be nice to see tests with the modernized version of Slick also\n. @odysseuscm I don't have Windows Phone 8.1, could you post back what you get in this jsFiddle: http://jsfiddle.net/90k49fms/show/\n. @odysseuscm i supose no one had time to review/test the pull request. \nI tagged it to 1.5.3 and in the meantime you could use the fix in the pull request.\ncheers,\ns\u00e9rgio\n. @odysseuscm I made a fix suggestion, now we need a dev to give :+1:  and/or merge, or provide a better suggestion.\n. @oallouch nice input! \nWe will be dropping some old browsers soon and that will make possible some nice refactoring. If you want to take part on that would be great. I can ping you here.\n. @andreynering I feel your pain! My name would actually fail  that method. \nThe question is should the Core method work for all languages? just latin-germanic languages? or just valid letters from CSS class names?\nA solution for  latin-germanic languages could be:\ncapitalize: function(){\n    return String(this).replace(/([^A-z\u00c0-\u00fa]?)([A-z\u00c0-\u00fa]+)/g, function(match, separator, word){\n        return separator + word.charAt(0).toUpperCase() + word.slice(1);\n    });\n},\nand a spec:\nexpect('a m\u00fasica \u00e9 universal'.capitalize()).toEqual('A M\u00fasica \u00c9 Universal');\ntried this ^ on Travis and works good.\n@andreynering: I started a thread on Portuguese Stackoverflow with this fix.  welcome to join there :smile: \n. We decided yesterday we will leave this method as it is since we cannot include all cases in a simple solution that is not expensive for performance. Also this method is used mostly for internal purposes and works perfect for such.\n@andreynering happy my idea was usable! Cheers\n. :+1: \n. @diegoflorez I made a simple page myself to check this and it works as It should, no bug. \nYou can check it here.\nIf you can put a page online with this assumed bug so we can see/test it would be the best.\nCheers!\n. @diegoflorez thank you creating the example showing the problem!\n@ricardograca nice input! (obrigado!)\nCould we fix this by adding if (!ready) check(); in this line? (last line of DOMReady.js, just before the function closure)\n. @diegoflorez could you share a jsFiddle reproducing that error and add some Browser info? what line does it point to? \nI don't see how window can be  null.\n. I see now, nice with a demo page. So RequireJS is not providing the window object so MooTools cannot be loaded. I am not so at home with RequireJS but will take look at this again.\nMaybe someone else more used to RequireJS will have some feedback soonish...\n. Using RequireJS's own domready seems the logical way, and best practise, since its RequireJS the one to load dependencies (MooTools). That said this issue can be closed IMO. I will close it in some days if no one else has input on it.\nAs a side note I still think the fix is usefull, but that we can discuss in the pull request itself.\nThank you @diegoflorez for nice input and demos to analyse this problem.\n. @jacobp100 thanks for your input. Point registered.\nI close this issue since its generic about extending prototypes.\nCheers!\n. :+1: \n. Rebased pr and updated specs.\n. @kije please comment back if you can make a jsFiddle reproducing the problem you pointed out.\n. Updated using @kentaromiura's Specs suggestion.\n4 specs suggested now.\n. any comments on this?... :ear: \n. @arian updated so the server is now inside a Grunt task.\n. @megawac this was the best I came up with. Input is really welcome, to make it even better :)\nIn this case since its a IE8- fix i think Object.keys is not a option since IE8 doesn't support it. \n(do correct me if I understood you wrong)\n. @megawac oh, I see. Actually  Object.keys is also depending on a for var in. Maybe it should use a patched Object.each instead... \n. @arian updated again.\n. added commit and just rebased.\n. I tried  to use Syn.js to reproduce this but didn't seem to work. \nSo I made a jsFiddle that works fine in FF with this patch, but has to be a human testing.\n. @arian updated with Spec and rebased\n. Can we merge this?\n. :smile_cat: same with me,\nI supose browsers with Object.keys didn't use that specific code.\n. :+1: \n. @DimitarChristoff (or someone else) any thoughts on this?\n. @DimitarChristoff had forgoten this sorry. \nChecked it again and your fiddle works good in my IE8 vm: http://jsfiddle.net/0fpd8n7c/\n. @newbie78 thank you for the suggestion!\nPersonally I don't think this should be part of Core. Adding a div to the DOM should be avoided, even if its a valid way to retrieve the scroll-bar width. Reminds me of this other way in Stackoverfow.\nMaybe this would fit More, or a separate plugin better than Core.\nI will close this soon if no one has a different opinion.\n. I made a example in jsFiddle that makes Browser console behave more like NodeJS's console, not giving it the chance to change the object along the way.\nhttp://jsfiddle.net/drqkzw6d/\nThis was a interesting issue and you guys left really nice feedback.\nI close this now. Please comment more if you feel I did wrong.\n. I would say this is difficult to fix since Browsers implementation of the select \"window\" is unreliable. Other frameworks have been pointed out to have the same \"bug\".\nI don't see a way to fix this in a consistent way. Even using event.fromElement which is null for that mouseleave event would be a partial solution (https://jsfiddle.net/2t8ctdoe/1/) since you can get away from the element unnoticed if exiting by the select options \"window\" when opened. \n. Related: https://code.google.com/p/chromium/issues/detail?id=475832\n. @chemix: Nice! \n@restlessdesign could you confirm this and close this issue if when you also confirm the problem is corrected?\nThank you\n. @j3zusla could you recreate the problem in a jsFiddle? what environment are you using? how are you loading MooTools?\n. @inf1 / @j3zusla  happy you got it working!\nI close this now. Cheers.\n. @Enyby was looking at this issue and cannot reproduce it. In IE8 I get test test in the end as expected. Could you check it again and let us know OS and browser version?\nThanks!\n. @Enyby closing this for inactivity. \nPlease write back if you can reproduce this error, and/or with more info.\nCheers,\nS\u00e9rgio\n. @dreadcast yes, it will be 1.5.2. Will check in the devgroup if we can tag it soonish.\n. @dreadcast 1.5.2 is out now.\nCheers.\n. > Side effects in initialization of unused variable instanceOf\nThis is because we use var instanceOf = this.instanceOf = function(item, object){ in Core.js and Uglify probably reacts to the first assignment of this \"double assign\", since this.instanceOf is not defined before that line. \nUsing\nvar instanceOf;\ninstanceOf = this.instanceOf = function(item, object){\nwill not generate the warning, which made me reach the conclusion above.\n\nDropping unused function borderBox\n\nborderBox is a private function used in Element.Dimentions in the compat layer. We could add a comment block around this code so it would not be present in the no-compat build.\n\nHaving this said, I think its safe to ignore those warnings.\n. nice input @DimitarChristoff  and @timwienk !\nNote that the configuration object idea is optional, not passing it would fall back to default (fire late & 250ms delay).\n@timwienk the debounce idea is different than throttle. The idea is to not fire during a serie of close event calls. Throttle will fire \"periodically\" during the series of events, debounce can fire just once per series of close event calls.\n~~The ++ side of this implementation is that it allows to have both the function being called at start and end of each series of events. It also allow to be fired once (ie. once and never more).~~\n~~If that is unnecessary I could just import/adapt (with due permission) the implementation lodash or underscore is using. No configuration object. Basically keeping down to early / late (it could also be called after, or trailing).~~\n^ striked-out text referred to stuff not in the PR anymore\n. @DimitarChristoff made it more simple now. Thoughts?\n. @IvanGuardado I am really happy you took the time to share your ideas. Nice that @timwienk pointed to a important related thread so ideas from the past can be used and be a source of inspiration.\n. Nice! \nRelated: https://github.com/mootools/mootools-core/pull/2520\n. I would also like to see this being included, but looking deeper into this I suggest delaying this.\nThe problematic is that old browsers don't support this. So this would have to be included in a future MooTools version that has dropped old Browsers. \nThe spec could be something like this maybe, using native event dispatcher API, but I think some events like progress might have to be normalized inside MooTools because they work different in different browsers.\n. @arian thanks for reviewing. \nUpdated removing unused requirejs dependency that was there since old days and fixed other things that @arian pointed out.\n. @arian (or anyone else) can we merge this?\n. @rizwanhussain-vteams the resizing works good with <1.3. This problem is actually related with the new website and the fact that jsFiddle is pointing its 1.2.6 version to a url that is inactive.\nSo your fiddle workds good (http://jsfiddle.net/2vkw52bk/1/), and there is already a fix suggested for this just not merged yet. I was not aware myself jsFiddle was using this functionality. One more reason for us to get that link back working.\nI close this now, please reopen if your issue is not solved by my jsFiddle.\n. @rizwanhussain-vteams  your new fiddle (http://jsfiddle.net/b4beaoda/) works for me in Chrome. Can you explain what should the behavior be and what is broken?\n. @rizwanhussain-vteams I'm not so familiar with that generation MooTools. I noticed that there appears to be a conflict in window.Element. Please check this version: http://jsfiddle.net/7kz4dnxu/ \nThis patch might ofcourse break other MooTools code but might point you in the right direction. Maybe someone else can give more feedback or patch for this old version of MooTools.\n. :+1: \n. I read thru the changes and found nothing strange/wrong. \nSent it to Travis also. Got green all over.\nI'm easy about changing to Mocha or staying with Jasmine.\nNice job! Thank you for the time you put into this!\n:+1: \n. Nice work!\nI am ok with merging these to master branch.\n. I say same as @arian.\n. :+1:  nice work!\n. I am ok with the \"devComment\" idea, in cases where complexity of code might need some explanation. Can be positive and pedagogic. These possible addictions to the repository would still be analysed one by one in pull requests.\nI suppose the syntax the packager needs should be:\n/*<devComment>*/ - to indicate start of block\n/* ... */ - for the comment itself, before the line it refers to\n/*</devComment>*/ - after the block of comment, before the actual code line\n. Closing this now. If I can resume the ideas here:\n- comments in complex code are welcome\n- no need to use <devComment> pattern, we can use just a normal comment sintaxe\n@boppy thank you for opening this and raising the question.\nCheers\n. :+1: \n. ++ also for a blog post!\n. @jarkt thank you for the fix suggestion!\nThere are specs failing with this code suggestion. Which means a BC (breaking change).\nWhich issue is this fixing? Is this related with URI issues in More?\n. Interesting. Have you tried to implement it already? Not sure how we can make cross-browser properties like tilt and pressure be consistent.\n. I think its a good idea to add pointer events. \nMaybe we should add some abstraction when (!window.PointerEvent || (window.MSPointerEvent && !('onpointerdown' in window))). Listen for mouse and touch events setting the pointer events e.pointerType to resp. mouse or touch. \nSo we can do .addEvent('pointerdown', fn); in older browsers.\nOtherwise adding this functionality just in some browsers might be misleading.\n. @arian good point. \nIn that case there should be a short info about that in Docs that this is only supported for modern browsers.\n. @si13b do you have possibility to add that ^ ? that would be really nice.\n. @si13b nice addition! \n@arian can it be something like:\n[Touch](http://www.w3.org/TR/touch-events/#list-of-touchevent-types) and [Pointer Events](http://www.w3.org/TR/pointerevents/#pointerevent-interface) are only available in modern browsers that support it.\nbeing added to docs, (maybe here)?\n. @si13b yes, please add documentation so ir goes together with the code.\nThank you\n. :+1: lgtm\n. I think you can remove the old IE tests (IE8, 9 and 10). Otherwise I'm ok to merge this.\nAgain, nice work!\n. You can check each instance's .isRunning(); like this http://jsfiddle.net/45wfgtnd/1\nIf you can give a example of what your code looks like also.\n. @vveliev This is the good place to ask such questions. \nIf you have possibility please make a fix suggestion, in a pull request with a update in the docs and some spec. \nCheers\n. I thought this was fixed in 1.5.2, here: https://github.com/mootools/mootools-core/pull/2705\n@oskarkrawczyk do you still have that problem with 1.5.2?\n. btw, not a blocking question the one above, I'm ok with merging this PR.\n:+1: \n. Ok, nice its working now.\nClosing this.\nCheers\n. I agree with renaming, deprecating it and keep it only in the compat layer. I think that is what @arian also meant. \nIf so I can update it, and take into account the things @arian pointed out in review.\n. Updated the pull request as sugested in discussion and fixing the things arian pointed out.\n@arian @anutron I agree that polyfill is very easy to find if needed, so I removed the polyfill from the PR.\n. bump... :)\nmerge anyone? \n. @arian, @anutron: I am ok with removing/renaming them also. \nCan I do that in a separate PR?\n. Closing after good discussion in Array.from. No need to add simple polyfills.\n. @rustyx MooTools works with SVG.\nPlease check this jsFiddle: https://jsfiddle.net/rmjwrt59/\nIf you still have problems, please make a jsFiddle and post in the mailing list, #irc or Stackoverflow.\n. You are using $$('a') before the xml is loaded. Put that code in the end\nof the page instead.\nOn Sat, Dec 26, 2015 at 9:47 PM, Rustam Abdullaev notifications@github.com\nwrote:\n\njsfiddle is limited to HTML documents, I'm talking about native SVG, not\nSVG inlined in HTML.\nHere's an example in which I'm trying to capture some events with MooTools:\nhttp://rustyx.org/temp/moosvg.svg\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2761#issuecomment-167362003\n.\n. @odysseuscm works for me... \n\nI get\nthis.MooTools = {\n    version: '1.6.0',\n    build: '529422872adfff401b901b8b6c7ca5114ee95e2b'\n};\ncan you provide more info (browser, os)?\n. Thanks for fixing @timwienk, the wrong release tagging was one me. Sorry for that.\n. I'm fine with \"switching\" or at least \"adding\" gitter or Slack as a official communication channel.\n. Maybe onerror could call onFailure.\nIf we keep it like it is it should at least be documented.\n. I'm ok with #1 and #2:) lets wait for what others say.\n. nice! :+1: \n. @Continuities  thanks for reporting this.\nIf you could provide a jsFiddle or example that reproduces the problem would be great.\nCheers\n. Nice! Lgtm. \n. I'm ok with this ESLint change.\n. Nice fix and input here @timwienk.\n\ud83d\udc4d \n. @NaridaL as @DimitarChristoff pointed out MooTools creates its own Event object, the purpose is to provide a object with normalized values so you get the same values out of it in all browsers.\nYou can still access the original event, you can access it in the .event property. The MooTools own event object stores the event the browser issues in that property. There you can find .shiftKey and other event properties not normalized, which means you can have different values in different browsers.\n. @NaridaL good point! Sent a pull request to fix that broken link. Thanks!\n. I don't think window should have one more global property.\nMethods for DOM elements should belong to document.\n. @olgierd23 could you provide a jsFiddle reproducing this?. @stefanklokgieters since ES6 landed, much of what MooTools brought to JavaScript is now Native. Afaik  MooTools 1.6.x is stable. If we find important bugs we should fix them. By \"we\" I mean devs and community :)\nDiscussing this is off-topic here, we had a thread in the Google mailinglist about this.\nFeel free to contact me, check the Gitter channel, #IRC or write in the mailing list if you have more questions. \n. @FEDuser can you provide a jsFiddle reproducing the problem?\n. @FEDuser together with the release tag there is a /dist/ folder. \nYou can find it here: https://github.com/mootools/mootools-core/tree/1.6.0/dist\nYou can also visit the website and download from there: https://mootools.net/core. @bamyasi can you make a jsFiddle that reproduces this problem?\n. lgtm \ud83d\udc4d \n. lgtm \ud83d\udc4d . @kentaromiura good point. I updated also the browsers list and replaced my original commit.. @CNSKnight can you make a jsFiddle that reproduces this problem?\n. I am ok with that. @ibolmo @arian ?\n@kentaromiura np, I'm not so good at my name either :-) \n. I supose https://github.com/mootools/mootools-core/pull/2604 fixes this issue, when/if it gets merged.\n. Related: https://github.com/mootools/mootools-core/pull/2520\n. I just checked this on Opera, Chrome, Firefox and IE11 and IE8 and all browsers return now anchortag. \nLooks like all major browsers support mouseenter now.\nThank you @dawolf for bringing this up!\n. @gonchuki could you check the PR Arian  linked (& related issue in it), if you have some time? I'm proposing a change of order in your code and you might want to have some input about it... Thanks!\n. Tested this idea on a branch in my repo and then minified it with grunt-uglify. \nThe resulting code passed the specs and looks like\n!function(a){a.MooTools={version:\"1.5.1-dev\",build:\"%build%\"};var b=a.typeOf=function(a){if(null==a)return\"null\"; etc.....\nThe original minified file (before this change) was 83Kb, after the change was also 83Kb, just some bytes difference. \nI don't say this is a bad idea but got the idea that code source is already well written and that the occurrences of the this word is low in our code.\nShould I send a PR with this changes or should we close this issue?\n. Travis fails on PhantomJS tests. We could add a bypass to phantom.js in the specs for this.\n. Related: https://github.com/mootools/mootools-core/issues/2551\n. @kentaromiura @arian can this be added directly after this line\nif (property == 'backgroundSize' && result){\n            if(result.split(' ').length == 1) return result + ' auto';\n        }\nThat would make it consistent when the value returned is just one parameter, it would add auto as referred here\n\nIf only one value is given the second is assumed to be \u2018auto\u2019.\n\nHere is a fiddle with my PR code for fixing background-position issue, plus this code suggestion I posted here for the background-size. (In this case the tests would need to be changed to expect \"20px auto\" in case either \"20px auto\" is given or just \"20px\")\nEdit: Tested the fiddle on VM (IE6/7/8/), FF, Chrome ad Safari and it worked.\n. @kentaromiura I'm curious about your suggestion, and to learn from it. How could changing to '@px @px' correct this? I don't see where getStyle checks if Element.Styles.backgroundSize has 2 parameters?\nHere is a fiddle with the Element.Styles.backgroundSize='@px @px';, and no extra if() for background-size. \nI get different results still in FF & Chrome.\n. @arian  @kentaromiura Can we close this?\n. :+1:  \nJust merged this on my master and tested on Travis. Got green.\n. @okolvik good that you commented, i did not noticed you update.\nI just had time to run your code on our test suite and all looks good. \nThis fix is in the list for 1.5.1. Thank you!\n. Example of the broken behaviour: http://jsfiddle.net/Ss8k2/2/\nThis PR is a good step to fix this but fixes only partially the problem: http://jsfiddle.net/Ss8k2/\n. @swhiteman +1\ncan you find some time to fix a PR for this?\n. LGTM.\n@arian @ibolmo Can I merge this with a docs update on the options with:\nwithCredentials - (boolean: defaults to false) allows you to set xhr.withCredentials without sending http authentication.\n. @ccampbell awesome work indeed. \nWish we would have such complete PRs more often.\nThank you! \n. This is a interesting issue since @arian 's jsFiddle behaves different if More is included or not, respective pageup / !. I just tested More with all the Core specs inside it and got no extra failing Spec. That is good. But would like also to be able to Spec this one and see that different behavior reflected there.\nI didn't manage to use Syn with SHIFT, but asked them for help on that.\n. @ibolmo @arian could this be a good spec for this: https://github.com/SergioCrisostomo/mootools-core/commit/d293e9893d4dc5455c59c3d9983170244844df6d ? \n. :+1:\n. Hi @JustOff ! \n1.4.5 compat version does provide the set method for opacity. Not sure if it will be kept in the future, but in 1.4.5 compat it does. Check here: http://jsfiddle.net/EUrFZ/\nI close this now. Please reopen or comment if you feel this does not answer your question.\n. @manojnelluri why to include jQuery?? Because of $('#result').html() ? \nThen you can use $('result') for selecting that element by ID \nand .get('html') for \"getting\" the html.\nBut I'm not sure you are talking about same thing as this issue is about...\n. As this is IE8 specific and documented I would say this is a wont-fix and should be closed. The solution often used in IE is to create a new element with the new type and replace the existing one. But that seems a bit ugly. Fortunately IE9+ don't have this problem anymore. \nThank you @DissidentRage  for pointing out a valid problem and you others for extra input.\nAs always do comment again if you feel this should not be closed.\n. @BjoernKW i know some time has passed, but could you create a jsFiddle to reproduce this?\ncheers\n. Actually .getBoundingClientRect is not consistent here. Since IE8 doesn't support svg anyway we could use .getComputedStyle instead. Eventually just for svg elements?\nCheck this specs and how .getBoundingClientRect gives different results in FF & Chrome: http://jsfiddle.net/msg3y/\n. @arian if I open that fiddle on FF 28 & 29 I get two broken specs.\nDon't you? or am I missing the point here?\n. @ibolmo Travis is green because there is no specs checking for this, and Travis is only checking PRs with PhantomJS.\nAbout the specs missing, it wont be for long... \n. So,\n- FF returns undefined for  offsetHeight and offsetWidth in svg elements. This means the current code is useless for svg elements\n- FF is inconsistent with .getBoundingClientRect for svg elements and fails in the specs for IE9> which seems to return undefined for elements with visibility: hidden\n- getComputedStyle seems to be consistent cross browsers and could be used for svg elements only\nWhat to do?\nSolution 1:\nUse getBoundingClientRect for svg elements and wait for FF devs to fix it. MooTools will deliver a inconsistent value cross-browsers for svg elements\nSolution 2:\nUse getComputedStyle for svg and consider the border and padding as the docs describe in getSize(). In that case we would end up with many lines just for this fix... Something like this:\nvar gCS = window.getComputedStyle(el);\n    var gCScomponents = [gCS.height, \n                         gCS.paddingTop, \n                         gCS.paddingBottom, \n                         gCS.borderTopWidth, \n                         gCS.borderBottomWidth].map(function (v, i) {\n        return parseFloat(v.match(/([0-9]{1,})/));\n    });\n    var gCSheight = 0;\n    gCScomponents.each(function(value){\n        gCSheight+=value;\n    });\n    // and do same for width\nSolution 3:\nA smarter guy than me will tell me soon...\n\nP.S.: @Bilge how do you suggest to use getBBox()? does that return the size? I found this issue that might be related to this also. Fiddle (bug on FF): http://jsfiddle.net/kWWDK/53/\n. This problem happens when the CSS position is not defined. This is not MooTools related but maybe  MooTools could provide a fix for this(?).\nI made a  a fiddle with the problem, adapted from @sitorush 's link. \nOne idea could be something like this:\nfunction zIndexGetter(ele) {\n        var inlinePosition = ele.style.position;\n    ele.style.position = 'relative';\n    var parents = ele.getStyle('z-index') != 'auto' ? [ele] : ele.getParents();\n    ele.style.position = inlinePosition;\n            var toReset = [],\n        definedParent;\n    for (var i = 0; i < parents.length; i++) {\n        var el = parents[i];\n        if (el.getStyle('z-index') == 'auto') {\n            var inlinePosition = el.style.position;\n            el.style.position = 'relative';\n            if (el.getStyle('z-index') != 'auto') {\n                definedParent = el;\n                break;\n            }\n            if (i > 0) parents[i - 1].style.zIndex = 'inherit';\n            toReset[i] = {\n                index: i,\n                positionToRestore: inlinePosition\n            };\n        } else {\n            definedParent = el;\n            break;\n        }\n    }\n    toReset.each(function () {\n        parents[this.index] = this.positionToRestore;\n    });\n    return definedParent.getStyle('z-index');\n}\njsFiddle example here. This works on IE8+, Chrome, FF and Safari 7.\nIf more people think this is worth a try I can sleep on it and make a better version.\n. @gonchuki, yes, sure. We either close this issue or find a fix for it. Since it was still open I just made a suggestion. Still if a element has defined z-index and getter returns auto something is wrong.\n. @gonchuki , yeah, nice to have your insight here!\nHave one more doubt, in this case should getStyle return 100 for A1 or is auto the correct value (although z-index for A1's parent is > B)\n. @gonchuki, found my answer, so I am also settled with this issue now. \nThank you again for input in this!\nFrom W3C:\n\nCSS value: auto\nThe stack level of the generated box in the current stacking context is 0. The box does not establish a new stacking context unless it is the root element.\n. I follow this discussion with no opinion, just sure that I will learn from it!\n\nI posted above a fiddle with the Mootools version of the link @sitorush posted. This gives:\n```\n// Chrome\nExample 1 z-index = 'auto', expected = 4\nExample 2 z-index = 'auto', expected = 4\n// IE & FF\nExample 1 z-index = '4', expected = 4\nExample 2 z-index = 'auto', expected = 4\n``\n. This is related to MooTools More and has already it's own [issue](https://github.com/mootools/mootools-more/issues/1088). Closing it here,\nThanks @cosmobile for bringing it up.\n. @jmarikle44i could you adapt this fiddle (http://jsfiddle.net/9V7zd/) to show the problem/solution better? then we can bild a specs from this.\n. I confirm FF is broken on this: http://jsfiddle.net/he5UU/13/\n. This is fixed in Firefox 52. Closing.. @ickata, maybe a bit late but can you make a fiddle with this issue to make it more clear? thanks!\n. @ickata I see your problem... in the specific case of the` element, this has to do with it's properties. \nselect elements always have length, the length is the number of <option> children, but even when empty the length is defined and is 0\nSo maybe Array.from() is doing the correct behavior here, for the specific case of  <select> element, checking the length is defied and checking its children. \nBtw, just FYI, found out that this has been discussed in the past.\n. This should be possible if this gets done. In the docs: https://github.com/kamicane/moofx/blob/e032c2d9639425501fd0756b275db2870e9b8988/README.md\n. @Bilge you could use a combination of a class with CSS transitions instead: http://jsfiddle.net/6FJSj/\n. @longwolf could you make a fiddle recreating this issue?\n. @longwolf no problem. Thanks for reporting it.\n. @arian nice input. Ok, so radio type also. Would this be a ok solution?\nA fiddle with this idea would be like this.\n. @cpojer imho arian's solution is a good one: :+1: \njQuery adds also multiple classes, space separated, with addClass method (singular). \nThis would add the desired classList and would transform the current \"bug\" that allows to add multiple classes into a upgraded version of addClass. One more nice feature for 1.5\n. Made a simple test about this. Without this change and with this change and the difference was around 1000% faster in a modern browser with the new code. There might be better ways of testing but this is clearly a enhancement.\nI made a branch with this and rebased against master. Then tested this on SauceLabs went green.\n. @RiZKiT do you have time to propose a PR for this?\n. @RiZKiT great, thank you!\nBy PR I meant Pull Request. If you have time for it would be great...\nOtherwise I will try to dig into it next week.\n. Could one of you (@ghost, @WernerWenz or @orthecreedence ) add some working example for this? if possible a jsFiddle with specs example?\nP.s: Andrew your comment on reddit made find about this PR :)\n. @MannyDev could you make some specs for this? if you need help on that let me know.\n. @cocapiznut , not clear what you mean. Could you check this fiddle: http://jsfiddle.net/eKn4u/ ?\nCan you reproduce your problem in a fiddle and post back?\n. @gonchuki thanks for input! \nI had not managed to test yet as you suggested. Will close this and think over about a fix for this. Thanks\n. :+1: \n. @platjen thank you for your feedback! Can you make a jsFiddle with the problem and post back?\nThanks!\n. Very nice input! Thanks, will fix.\n@ibolmo: about JSON.secure, you are right. \nBtw, where/why is it used? Do not find it anywhere else in Mootools?\nWill make some specs for this also following your suggestions. \nShould I add it in the 1.5base or 1.5client?\n. @ibolmo the JSON.secure is a bit weird. It was added in the 2.0 branch https://github.com/mootools/mootools-core/commit/c04d545939d4c1c1287a448d947a142ed05b7f80 and I find no other reference to it in all  Core & More files. \nIt is not documented in the docs either afaik.\nSo if we add JSON.secure = true; it has to be added to the docs and developers wanting to use \"the eval way\" would have to make a double false. On the function parameters and a JSON.secure = false;\nI'm ok with adding it. Also ok with leaving it out (i.e not adding JSON.secure = true;).\n. @ibolmo , thanks for your time checking this!\nI'm still not sure I follow you. I see 3 scenario:\n1- Adding both JSON.secure = true; and if (secure == null) secure = JSON.secure;\nThis means default behavior is secure. And to make it un-secure user has to use JSON.secure = false; which is not documented. \nIf user uses JSON.secode(string, false); as documented, that alone would turn to true anyway because of JSON.secure = true;.\n2- Adding just JSON.secure = true; (and keeping  if (secure == null) secure = true;)\nThis means default behavior is secure. But to override it and go un-secure user needs to use double false:\nJSON.secode(string, false);\nJSON.secure = false;\n3- Using as it is now, in the PR. ( and the right one in my logic)\nThis means default behavior is secure. To override user would use, as documented already, just JSON.secode(string, false);\n\nJSON.secure seems to be kind of a backdoor/alternative, not documented.\n. @ibolmo I think I figured it out now with the compat layer. \nI added a compat layer, and with that I also removed future reference to JSON.secure without the compat.\nLet me know if it looks ok.\n. @ibolmo I was misunderstanding the compat layer's behaviour. I updated the PR code and docs now.\n. This PR has to be refactored after Olmo's new Specs PR is merged.\n. @ibolmo will do that. \nI supose I don't need the package.yml and Configuration.JS files anymore? \nI see also a new directory structure without /1.5base/ so I suppose the mootools-packager script goes forEach directory inside the Specs and the compat layer info goes inside the respective specs .js file, with compat comment tags when needed.\nI run the specs adding my new JSON.js specs to the one on JSON.js specs file from your repo and they worked good with grunt.\n. @ibolmo updated the PR with new master.\n. @ibolmo could you merge or give your :+1:  on this? would be nice to get this into 1.5 also to avoid eval unnecessarily.\n. modernie needs to go in a compat block, will update later if no one has sent the right PR yet\n. @ibolmo : There is a pending PR for this that @timwienk prepared.\n. I have no decision here, go for what is more correct/decided.\nMy thoughts:\n1.4 code (and 1.5 compat) should see IE11 as Browser.ie to not break BC\n1.5 code  (ie 1.5 no compat) would have a \"back door\" using Browser.modernie\nIn this case maybe:\njs\nif (Browser.name == 'ie'){\n    if (Browser.version >= '11') {\n        Browser.modernie = true;\n    } else {\n        Browser.ie = true;\n    }\n    //<1.4compat>\n    Browser.ie = true;\n    //</1.4compat>\n} else {\n    Browser[Browser.name] = true;\n}\n. @timwienk  I trust you better than me on this, I was just commenting.\nIf the decided was that go for it! I have nothing to opose.\nWill be nice to see this done.\n:+1: \n. :+1: \n. Pong! Just tested this with our Specs and result is green. \n:+1: from me.\n\nNot related to this PR: tested also restoring the root.msMatchesSelector in that same line, but Specs falied in IE9. \nConclusion: @cpojer was right and can see into the future!\n. Updating with some ideas and tests discussed on #IRC today:\n- Travis & Sauce block the connection for testing PRs from external source, to protect from PRs with malicious code like console.log(SAUCE_ACCESS_KEY)\n- If the Sauce username & password are not encrypted then Travis/Sauce will work and run the full task on the PR. \nSince our SAUCE_ACCESS_KEY are encrypted, this PR is to allow gruntfile to distinguish when the test is for a PR and just run it with PhantomJS. ANd if it's not a PR (ie a merge) the whole test will be done. \n. Updated after nice ideas from @arian  on #IRC. \nWith this PR both defaultand nocompat will run in separated tasks for IE6-11, FF, Chrome and Safari 5-7.\nOne thing I wonder and wanted: avoiding running extra tests in PhantomJS in case of PR. I would like that a Pull Request would only trigger 1 build with 1 test, and not this. But that seems not to be possible from what i have asked and read.  I don't see it as a problem either.\n. @GCheung55 nice to have you checking this also. My tests on my master ran 4 (sometimes 5) tests parallel, and no failure because of too many builds. When one of them is done, the next fires. Maybe since we have 10VM's it will run even faster, more simultaneous.\nThe advantage here is that it will be more clear what is failing and what is passing, since the other tests make a too long log. These are also checking both compat and nocompat.\nWe could merge this and checkit. To be honest I will learn by seing it happen since I only tested with my own repo, ie not much experience with Travis from before.\n. I wonder if it's worth the extra work just for IE6. Apparently just 0.1% uses IE6, assuming this is not the stats error margin it might be like @kentaromiura commented one day: Those are all the developers still testing IE6. Stop it!\n:)\n. @jdmichal, can you make a PR for this and a specs for this?\nSeems the specs are already looking for the right thing, consistent with the code.\n. @jdmichal or @swhiteman  could you make a PR to correct this? otherwise let us know and we fix it.\n. :+1:  - tested this on SauceLabs and got green\n. :+1: \n. :+1: \n. Ping...\n. Great work! Very nice!\n. :+1: \n. @SCHOLAR-Graeme, interesting issue, thanks for bringing it up.\nI noticed that changing the order of these two lines fixes this problem. Does anyone see a possible backside to this change? (tested the specs with this idea and all is green)\nhttp://jsfiddle.net/cgXe4/1/ (fixed version)\n. @arian @kentaromiura @ibolmo @timwienk  do you see any down-side of changing these two lines? \n. @olvlvl I'm not sure this should be a Core feature in MooTools. \nLets wait to hear from the other Devs.\nBut its a good idea, and a very well done PR!\nMaybe this is suitable for More? and with that more optional for users instead of a Core feature...\n@anutron, your thoughts about eventually having this in More?\n. @DimitarChristoff ++\nCould you send a PR for that and with it close #2548 ? would be very nice...\n. Maybe we could build those 4 files from the automagical shell script that @timwienk just made? Otherwise maybe a release hook running a new task in the gruntfile.\n. I wasn't sure if the shell script could build, but now I know more :)\nI will check the git-release-hook and see if we can use that to build files via Gruntfile.\n. (sorry it took me some time to answer on this)\nSo,\nI would like us to follow @ibolmo 's suggestion  and simplify this method. \nThe docs say:    \n\nElement shortcut method for tween with opacity. Useful for fading an Element in and out or to a certain opacity level.\n\nThe code needed to support what the Docs say .fade() should do is:\nfade: function(method){\n    var tween = this.get('tween');\n    if (!method || method == 'toggle') method = this.getStyle('opacity') ? 'out' : 'in';\n    if (method == 'in') tween.start('opacity', 1);\n    if (method == 'out') tween.start('opacity', 0);\n    if (method == 'show') tween.set('opacity', 1);\n    if (method == 'hide') tween.set('opacity', 0);\n    if (typeof method == 'number') tween.start('opacity', method); // corrected after Olmo's sharp eye\n    return this;\n},\nQuestion #1:\nwould it be more performative with else if instead of many if?\nQuestion #2:\nThe specs refer to a \"old\" method that allows to do .fade(from, to). I did not find this in the docs. Looked from 1.2 to 1.5. Unless I am wrong I vote for removing that spec.\nIf this is needed we could add something like:\nif (arguments.length == 2) {\n    tween.set('opacity', arguments[0]);\n    tween.start('opacity', arguments[1]);\n    return this;\n}\nbut still remove these specs\nQuestion #3:\nShould fade set visibility? There is no problem with opacity as I could see in IE6, or IE8 (ping @kentaromiura ). This fiddle works good in those old IE's making the element \"disapear\". So the visibility could be set in the onComplete event of the tween instead. \nIf we decide to keep this behavior that fade sets visibility both on fade-in and fade-out, then we need to use something like this.\n. @ibolmo, you were right about the \"note\", i edited/corrected above.\n(and thanks for nice feedback!)\nAbout visibility, it's tricky I think.\nOne option is to add this line under, inside the stop: method of FX.js, just before the complete events starts to fire (here):\nif (this.to && this.to.opacity) this.element.setStyle('visibility', this.to.opacity[0].value == 0 ? 'hidden' : 'visible');\nThis will also be applied in other tween of opacity, not just fade.\nAnother option, based on the one above, is adding a flag on the storage, and retrieve/reset inside the stop:. This would avoid visibility been set when !fade\nOtherwise I see only the \"chain option\" as is in the PR, based on what @arian added to solve past problems; i.e. that the setStyle('visibility') is passed into the chain to be ran at the end, thought after the complete event is called which is not so good.\n. @ibolmo setOpacity does not currently set visibility in browsers with hasOpacity or hasFilter. The fade is currently the one to do this by adding a setStyle('visibility') in the tween.chain. This was added here.\nIf we change this behaviour, so that when setStyle('opacity') is called visibility is also set, then these aditions (marqued with +) would do the job (specs looks green) and could be used use the new re-factored code posted above. This idea to always set visibility was abandoned before. So setStyle should only change the actual prop passed.\nIf we set visibility only when fired from a fade, here is my suggestion (http://jsfiddle.net/ZzZEF/), based on Olmo's refactor and @arian 's chain idea:\n``` js\nfade: function(method){\n    var tween = this.get('tween');\n    if (!method || method == 'toggle') method = this.getStyle('opacity') ? 'out' : 'in';\n    //<1.3compat>\n    if (arguments.length == 2) {\n        tween.set('opacity', arguments[0]);\n        tween.start('opacity', arguments[1]);\n        return this;\n    }\n    //1.3compat\n    if (method == 'in') tween.start('opacity', 1);\n    if (method == 'out') tween.start('opacity', 0);\n    if (method == 'show') tween.set('opacity', 1);\n    if (method == 'hide') tween.set('opacity', 0);\n    if (typeof method == 'number') tween.start('opacity', method);\n    var to = tween.to[0].value, visible = this.getStyle('visibility') == 'visible';\nfunction changeVisibility(value, $tween){       \n    if ($tween.$chain.length){\n        $tween.chain(function (){\n            this.element.setStyle('visibility', value);\n            this.callChain();\n        });\n    } else {\n        this.setStyle('visibility', value);\n    }\n};\n\nif (to && !visible) changeVisibility.call(this, 'visible', tween);\nif (to == 0 && visible) changeVisibility.call(this, 'hidden', tween);\nreturn this;\n\n},\n```\nWould be nice to have @arian looking at this refactor since he was the one to fix the  opacity only setting visibility if fired from a fade\n. @arian could you give your opinion here? \n. Really nice feedback from you guys!\nI made now a new approach and cleaned the PR.\nAdded a Spec that reproduces the problem described at #2593 and got green specs.\nWould this be a ok approach?\n. @lastwebdesigner thank you for reporting this. We will take a look at it asap.\nUpdated fiddle: http://jsfiddle.net/8uMgZ/1/\n. @szegheo we had some more fixes planned for the 1.5.1 release, but I supose we could release this fix together with some pull requests already in the queue, and the other ones in 1.5.2.\nLets wait for more feedback from the team. \n. :+1: \n. @arian made a spec for this: https://github.com/SergioCrisostomo/mootools-core/commit/2bdebf1f3be0108aa60d2c3513f1d10c46a2855f\nTested specs with this PR's changes and got green. \nWithout this PR fails on Chrome and FF (http://jsfiddle.net/tDqF5/).\n@kentaromiura if you want you could add this spec to your PR, or someone else merge both.\n. Can we merge this PR + the spec I made and discuss the deltaY in the new created issue #2620 ?\nThis fix is reason enought for 1.5.1 imho\n@ibolmo ? @arian ?\n. @arian I think I missed your point first, sorry. \nI tried now the wheel property and in fact it doesn't behave same, when Firefox listens do wheel (instead of DOMMouseScroll) then event.detail == undefined. This makes us add one more check point.\nI made one more commit to fix that (1cd56d7e3fc4df43449b194c3ae8eb02b23d514d).\nTested in IE7~11, latest FF and Chrome (windows & mac), Opera (win), Safari 7\n. @kentaromiura ping\n. Here is a spec for this issue that me and @kentaromiura think is ok (https://github.com/SergioCrisostomo/mootools-core/commit/9814075e0132c0d09e6f559ab9eed4d784900bb5). \n@kentaromiura suggest the broken e.wheel to be in a separate pull request and I say yes to that. If someone else also gives OK on this spec it can be merged and I will send another pull request with a fix suggestion I have for the broken e.wheel.\n. @gonchuki thank you for nice feedback! \nI addressed all your suggestions. \nChanged !document.addEventListener with !hasGetComputedStyle.\n. @ibolmo Updated and re-tested.\nThank you for feedback here too!\n. @ibolmo updated! Fixed your suggestions and re-tested.\n. The dependency order is not broken. The packager still uses YAML headers.\nSome files like Morph and Tween have same dependency Fx.CSS and they would be compiled in different order in alphabetic or by the array returned by the package.yml.\nThis change was discussed and requested at IRC to be able to check the diff between php packager and grunt-packager more easy, so the file structure would be the same.\n. Refactored this PR to remove changes in tag-release, added dist files, and added @satazor 's bower.json. Tested also..\nWelcome to re-check/review!\n@ibolmo added a 'quick' PhatomJS task for each dist/'.js (maybe overkill) to be on the safe side.\n@satazor obrigado!\n. @olvlvl thank you for this fix. \nWe are just discussing which browsers we will stop supporting for next versions. Would be great to have your help on that future \"clean up\" work.\nSalut!\n. Merged by 2c72ef2f0f9fdb54e94da825dae2b6bb42da6b5e\n@olvlvl we are making a road make to the next release. I will be happy to share it with you.\nNice!\n. @gonchuki : @anutron : => thank you for feedback!\nAdded one more commit which addresses your remarks.\n. @ibolmo Updated and re-tested.\nI am really happy for the feedback. I do not see it as spam.\nThank you!\n. @arian this PR fixes the set('thml', issue. \nThere is another related issue (#2265) about set('text', where you already did most of the work. \nI continued your idea and reached this commit which fixes set('text', and also the code/error you posted in the comment in #2265. \n(http://jsfiddle.net/H42T2/)\nQuestion: Should I add that commit to this PR and close both issues? \n(if you guys think this PR is a ok solution, of course).\n. @ibolmo Updated and re-tested.\nThank you!\n. :+1: \nGreen specs\n. Good catch! \n++\n. @arian I think just one commit went to Core\\Slick and is not synced: f0fa94b6be677a522e384d00e2d4505109e1632c\n. Merged by 8a3d56285df5c6e7f56028db93adec75974fdb1b\nNice that you also made a PR for this on Slick. Thanks.\n. @ibolmo updated!\n. Good point @anutron, my bad.\n. @arian great feedback, thank you. \nUpdated, re-tested, re-based also.\n. @kentaromiura: nice! \nCan someone check this so we moo on to 1.5.1 ?\n. If i understand the problem right, seems like same behavior in vanilla JS\nhttp://jsfiddle.net/4FFFn/2/\n. @ickata: Anyway, and although not MooTools related, it is a weird behavior.\n. Thank you @barriteau \n. @diegoflorez we added this to the 1.6 issue review list. \nIf you can make a pull request with the new code and a spec for it would be great!\nYou can find a spec example here.\n. @mzabriskie I think the problem here is that the tag 1.5.0 did not yet had a bower.json file and dist/ folder.. \nSo only 1.5.1 will have bower.json and dist/ in a release tag. If you do \nbower install https://github.com/mootools/mootoolscore.git#be3d04548a6d8947375a37b147cc0027854b9012\n(which is the latest commit) the dist/ folder will get added.\nI think this will be auto-fixed when we tag 1.5.1 in the next days.\n. I close this issue now as I believe this will be fixed by the new tag 1.5.1 itself.\nDo re-open if I missed something.\nCheers!\n. @mzabriskie we just released 1.5.1 so this is now up-and-running.\n```\n$ bower install mootools\nor\n$ bower install https://github.com/mootools/mootools-core.git\n```\n. @AmatanHead really nice PR! \n@ibolmo, @arian anything you would like to comment, discuss or add here?\n. The script @timwienk made is perfect for tagging new releases and change version and build in Source/Core.js and package.json.\nWe now need a way to tag also the bower.json and dist folder files (4 files). \nMy pull request is a attempt to solve that. When I do bash tag-release 1.5.1 from Mavericks command line it works for me. It does what the original script did plus it tags bower.json and the dist files and deletes the dist folder after tagging, as discussed in #IRC.\nIf this pull request is bad, there are different options. One is that someones makes a better one that solves the problem (@timwienk is the most qualified i supose), other option is that someone points me errors on it so I make it better and learn something, other option is we just do the tagging by hand.\n. @jpdery ping\n. @AnitaAtyi thank you for the feedback.\n@jpdery please reopen if you think this is a problem in Core .\n. @odysseuscm thank you for pointing this out. \nIt has been fixed and added for the 1.5.2 release. \nPlease use the fix applied there meanwhile.\n. @arian that makes much more sense.\nYou are right, we had already the value from before and were writing-over with a undefined.\nUpdated the pull request.\n. Should we open a issue about removing Safari 5 code and close when we have done it?\n. :+1: \n. @Addviso could you provide a jsFiddle with an example of the problem?\n. Closing this as discussed in #2662. If new ideas comes up would be nice to fix this indeed.\n. nice name, nice work :) would be nice to see tests with the modernized version of Slick also\n. @odysseuscm I don't have Windows Phone 8.1, could you post back what you get in this jsFiddle: http://jsfiddle.net/90k49fms/show/\n. @odysseuscm i supose no one had time to review/test the pull request. \nI tagged it to 1.5.3 and in the meantime you could use the fix in the pull request.\ncheers,\ns\u00e9rgio\n. @odysseuscm I made a fix suggestion, now we need a dev to give :+1:  and/or merge, or provide a better suggestion.\n. @oallouch nice input! \nWe will be dropping some old browsers soon and that will make possible some nice refactoring. If you want to take part on that would be great. I can ping you here.\n. @andreynering I feel your pain! My name would actually fail  that method. \nThe question is should the Core method work for all languages? just latin-germanic languages? or just valid letters from CSS class names?\nA solution for  latin-germanic languages could be:\ncapitalize: function(){\n    return String(this).replace(/([^A-z\u00c0-\u00fa]?)([A-z\u00c0-\u00fa]+)/g, function(match, separator, word){\n        return separator + word.charAt(0).toUpperCase() + word.slice(1);\n    });\n},\nand a spec:\nexpect('a m\u00fasica \u00e9 universal'.capitalize()).toEqual('A M\u00fasica \u00c9 Universal');\ntried this ^ on Travis and works good.\n@andreynering: I started a thread on Portuguese Stackoverflow with this fix.  welcome to join there :smile: \n. We decided yesterday we will leave this method as it is since we cannot include all cases in a simple solution that is not expensive for performance. Also this method is used mostly for internal purposes and works perfect for such.\n@andreynering happy my idea was usable! Cheers\n. :+1: \n. @diegoflorez I made a simple page myself to check this and it works as It should, no bug. \nYou can check it here.\nIf you can put a page online with this assumed bug so we can see/test it would be the best.\nCheers!\n. @diegoflorez thank you creating the example showing the problem!\n@ricardograca nice input! (obrigado!)\nCould we fix this by adding if (!ready) check(); in this line? (last line of DOMReady.js, just before the function closure)\n. @diegoflorez could you share a jsFiddle reproducing that error and add some Browser info? what line does it point to? \nI don't see how window can be  null.\n. I see now, nice with a demo page. So RequireJS is not providing the window object so MooTools cannot be loaded. I am not so at home with RequireJS but will take look at this again.\nMaybe someone else more used to RequireJS will have some feedback soonish...\n. Using RequireJS's own domready seems the logical way, and best practise, since its RequireJS the one to load dependencies (MooTools). That said this issue can be closed IMO. I will close it in some days if no one else has input on it.\nAs a side note I still think the fix is usefull, but that we can discuss in the pull request itself.\nThank you @diegoflorez for nice input and demos to analyse this problem.\n. @jacobp100 thanks for your input. Point registered.\nI close this issue since its generic about extending prototypes.\nCheers!\n. :+1: \n. Rebased pr and updated specs.\n. @kije please comment back if you can make a jsFiddle reproducing the problem you pointed out.\n. Updated using @kentaromiura's Specs suggestion.\n4 specs suggested now.\n. any comments on this?... :ear: \n. @arian updated so the server is now inside a Grunt task.\n. @megawac this was the best I came up with. Input is really welcome, to make it even better :)\nIn this case since its a IE8- fix i think Object.keys is not a option since IE8 doesn't support it. \n(do correct me if I understood you wrong)\n. @megawac oh, I see. Actually  Object.keys is also depending on a for var in. Maybe it should use a patched Object.each instead... \n. @arian updated again.\n. added commit and just rebased.\n. I tried  to use Syn.js to reproduce this but didn't seem to work. \nSo I made a jsFiddle that works fine in FF with this patch, but has to be a human testing.\n. @arian updated with Spec and rebased\n. Can we merge this?\n. :smile_cat: same with me,\nI supose browsers with Object.keys didn't use that specific code.\n. :+1: \n. @DimitarChristoff (or someone else) any thoughts on this?\n. @DimitarChristoff had forgoten this sorry. \nChecked it again and your fiddle works good in my IE8 vm: http://jsfiddle.net/0fpd8n7c/\n. @newbie78 thank you for the suggestion!\nPersonally I don't think this should be part of Core. Adding a div to the DOM should be avoided, even if its a valid way to retrieve the scroll-bar width. Reminds me of this other way in Stackoverfow.\nMaybe this would fit More, or a separate plugin better than Core.\nI will close this soon if no one has a different opinion.\n. I made a example in jsFiddle that makes Browser console behave more like NodeJS's console, not giving it the chance to change the object along the way.\nhttp://jsfiddle.net/drqkzw6d/\nThis was a interesting issue and you guys left really nice feedback.\nI close this now. Please comment more if you feel I did wrong.\n. I would say this is difficult to fix since Browsers implementation of the select \"window\" is unreliable. Other frameworks have been pointed out to have the same \"bug\".\nI don't see a way to fix this in a consistent way. Even using event.fromElement which is null for that mouseleave event would be a partial solution (https://jsfiddle.net/2t8ctdoe/1/) since you can get away from the element unnoticed if exiting by the select options \"window\" when opened. \n. Related: https://code.google.com/p/chromium/issues/detail?id=475832\n. @chemix: Nice! \n@restlessdesign could you confirm this and close this issue if when you also confirm the problem is corrected?\nThank you\n. @j3zusla could you recreate the problem in a jsFiddle? what environment are you using? how are you loading MooTools?\n. @inf1 / @j3zusla  happy you got it working!\nI close this now. Cheers.\n. @Enyby was looking at this issue and cannot reproduce it. In IE8 I get test test in the end as expected. Could you check it again and let us know OS and browser version?\nThanks!\n. @Enyby closing this for inactivity. \nPlease write back if you can reproduce this error, and/or with more info.\nCheers,\nS\u00e9rgio\n. @dreadcast yes, it will be 1.5.2. Will check in the devgroup if we can tag it soonish.\n. @dreadcast 1.5.2 is out now.\nCheers.\n. > Side effects in initialization of unused variable instanceOf\nThis is because we use var instanceOf = this.instanceOf = function(item, object){ in Core.js and Uglify probably reacts to the first assignment of this \"double assign\", since this.instanceOf is not defined before that line. \nUsing\nvar instanceOf;\ninstanceOf = this.instanceOf = function(item, object){\nwill not generate the warning, which made me reach the conclusion above.\n\nDropping unused function borderBox\n\nborderBox is a private function used in Element.Dimentions in the compat layer. We could add a comment block around this code so it would not be present in the no-compat build.\n\nHaving this said, I think its safe to ignore those warnings.\n. nice input @DimitarChristoff  and @timwienk !\nNote that the configuration object idea is optional, not passing it would fall back to default (fire late & 250ms delay).\n@timwienk the debounce idea is different than throttle. The idea is to not fire during a serie of close event calls. Throttle will fire \"periodically\" during the series of events, debounce can fire just once per series of close event calls.\n~~The ++ side of this implementation is that it allows to have both the function being called at start and end of each series of events. It also allow to be fired once (ie. once and never more).~~\n~~If that is unnecessary I could just import/adapt (with due permission) the implementation lodash or underscore is using. No configuration object. Basically keeping down to early / late (it could also be called after, or trailing).~~\n^ striked-out text referred to stuff not in the PR anymore\n. @DimitarChristoff made it more simple now. Thoughts?\n. @IvanGuardado I am really happy you took the time to share your ideas. Nice that @timwienk pointed to a important related thread so ideas from the past can be used and be a source of inspiration.\n. Nice! \nRelated: https://github.com/mootools/mootools-core/pull/2520\n. I would also like to see this being included, but looking deeper into this I suggest delaying this.\nThe problematic is that old browsers don't support this. So this would have to be included in a future MooTools version that has dropped old Browsers. \nThe spec could be something like this maybe, using native event dispatcher API, but I think some events like progress might have to be normalized inside MooTools because they work different in different browsers.\n. @arian thanks for reviewing. \nUpdated removing unused requirejs dependency that was there since old days and fixed other things that @arian pointed out.\n. @arian (or anyone else) can we merge this?\n. @rizwanhussain-vteams the resizing works good with <1.3. This problem is actually related with the new website and the fact that jsFiddle is pointing its 1.2.6 version to a url that is inactive.\nSo your fiddle workds good (http://jsfiddle.net/2vkw52bk/1/), and there is already a fix suggested for this just not merged yet. I was not aware myself jsFiddle was using this functionality. One more reason for us to get that link back working.\nI close this now, please reopen if your issue is not solved by my jsFiddle.\n. @rizwanhussain-vteams  your new fiddle (http://jsfiddle.net/b4beaoda/) works for me in Chrome. Can you explain what should the behavior be and what is broken?\n. @rizwanhussain-vteams I'm not so familiar with that generation MooTools. I noticed that there appears to be a conflict in window.Element. Please check this version: http://jsfiddle.net/7kz4dnxu/ \nThis patch might ofcourse break other MooTools code but might point you in the right direction. Maybe someone else can give more feedback or patch for this old version of MooTools.\n. :+1: \n. I read thru the changes and found nothing strange/wrong. \nSent it to Travis also. Got green all over.\nI'm easy about changing to Mocha or staying with Jasmine.\nNice job! Thank you for the time you put into this!\n:+1: \n. Nice work!\nI am ok with merging these to master branch.\n. I say same as @arian.\n. :+1:  nice work!\n. I am ok with the \"devComment\" idea, in cases where complexity of code might need some explanation. Can be positive and pedagogic. These possible addictions to the repository would still be analysed one by one in pull requests.\nI suppose the syntax the packager needs should be:\n/*<devComment>*/ - to indicate start of block\n/* ... */ - for the comment itself, before the line it refers to\n/*</devComment>*/ - after the block of comment, before the actual code line\n. Closing this now. If I can resume the ideas here:\n- comments in complex code are welcome\n- no need to use <devComment> pattern, we can use just a normal comment sintaxe\n@boppy thank you for opening this and raising the question.\nCheers\n. :+1: \n. ++ also for a blog post!\n. @jarkt thank you for the fix suggestion!\nThere are specs failing with this code suggestion. Which means a BC (breaking change).\nWhich issue is this fixing? Is this related with URI issues in More?\n. Interesting. Have you tried to implement it already? Not sure how we can make cross-browser properties like tilt and pressure be consistent.\n. I think its a good idea to add pointer events. \nMaybe we should add some abstraction when (!window.PointerEvent || (window.MSPointerEvent && !('onpointerdown' in window))). Listen for mouse and touch events setting the pointer events e.pointerType to resp. mouse or touch. \nSo we can do .addEvent('pointerdown', fn); in older browsers.\nOtherwise adding this functionality just in some browsers might be misleading.\n. @arian good point. \nIn that case there should be a short info about that in Docs that this is only supported for modern browsers.\n. @si13b do you have possibility to add that ^ ? that would be really nice.\n. @si13b nice addition! \n@arian can it be something like:\n[Touch](http://www.w3.org/TR/touch-events/#list-of-touchevent-types) and [Pointer Events](http://www.w3.org/TR/pointerevents/#pointerevent-interface) are only available in modern browsers that support it.\nbeing added to docs, (maybe here)?\n. @si13b yes, please add documentation so ir goes together with the code.\nThank you\n. :+1: lgtm\n. I think you can remove the old IE tests (IE8, 9 and 10). Otherwise I'm ok to merge this.\nAgain, nice work!\n. You can check each instance's .isRunning(); like this http://jsfiddle.net/45wfgtnd/1\nIf you can give a example of what your code looks like also.\n. @vveliev This is the good place to ask such questions. \nIf you have possibility please make a fix suggestion, in a pull request with a update in the docs and some spec. \nCheers\n. I thought this was fixed in 1.5.2, here: https://github.com/mootools/mootools-core/pull/2705\n@oskarkrawczyk do you still have that problem with 1.5.2?\n. btw, not a blocking question the one above, I'm ok with merging this PR.\n:+1: \n. Ok, nice its working now.\nClosing this.\nCheers\n. I agree with renaming, deprecating it and keep it only in the compat layer. I think that is what @arian also meant. \nIf so I can update it, and take into account the things @arian pointed out in review.\n. Updated the pull request as sugested in discussion and fixing the things arian pointed out.\n@arian @anutron I agree that polyfill is very easy to find if needed, so I removed the polyfill from the PR.\n. bump... :)\nmerge anyone? \n. @arian, @anutron: I am ok with removing/renaming them also. \nCan I do that in a separate PR?\n. Closing after good discussion in Array.from. No need to add simple polyfills.\n. @rustyx MooTools works with SVG.\nPlease check this jsFiddle: https://jsfiddle.net/rmjwrt59/\nIf you still have problems, please make a jsFiddle and post in the mailing list, #irc or Stackoverflow.\n. You are using $$('a') before the xml is loaded. Put that code in the end\nof the page instead.\nOn Sat, Dec 26, 2015 at 9:47 PM, Rustam Abdullaev notifications@github.com\nwrote:\n\njsfiddle is limited to HTML documents, I'm talking about native SVG, not\nSVG inlined in HTML.\nHere's an example in which I'm trying to capture some events with MooTools:\nhttp://rustyx.org/temp/moosvg.svg\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2761#issuecomment-167362003\n.\n. @odysseuscm works for me... \n\nI get\nthis.MooTools = {\n    version: '1.6.0',\n    build: '529422872adfff401b901b8b6c7ca5114ee95e2b'\n};\ncan you provide more info (browser, os)?\n. Thanks for fixing @timwienk, the wrong release tagging was one me. Sorry for that.\n. I'm fine with \"switching\" or at least \"adding\" gitter or Slack as a official communication channel.\n. Maybe onerror could call onFailure.\nIf we keep it like it is it should at least be documented.\n. I'm ok with #1 and #2:) lets wait for what others say.\n. nice! :+1: \n. @Continuities  thanks for reporting this.\nIf you could provide a jsFiddle or example that reproduces the problem would be great.\nCheers\n. Nice! Lgtm. \n. I'm ok with this ESLint change.\n. Nice fix and input here @timwienk.\n\ud83d\udc4d \n. @NaridaL as @DimitarChristoff pointed out MooTools creates its own Event object, the purpose is to provide a object with normalized values so you get the same values out of it in all browsers.\nYou can still access the original event, you can access it in the .event property. The MooTools own event object stores the event the browser issues in that property. There you can find .shiftKey and other event properties not normalized, which means you can have different values in different browsers.\n. @NaridaL good point! Sent a pull request to fix that broken link. Thanks!\n. I don't think window should have one more global property.\nMethods for DOM elements should belong to document.\n. @olgierd23 could you provide a jsFiddle reproducing this?. @stefanklokgieters since ES6 landed, much of what MooTools brought to JavaScript is now Native. Afaik  MooTools 1.6.x is stable. If we find important bugs we should fix them. By \"we\" I mean devs and community :)\nDiscussing this is off-topic here, we had a thread in the Google mailinglist about this.\nFeel free to contact me, check the Gitter channel, #IRC or write in the mailing list if you have more questions. \n. @FEDuser can you provide a jsFiddle reproducing the problem?\n. @FEDuser together with the release tag there is a /dist/ folder. \nYou can find it here: https://github.com/mootools/mootools-core/tree/1.6.0/dist\nYou can also visit the website and download from there: https://mootools.net/core. @bamyasi can you make a jsFiddle that reproduces this problem?\n. lgtm \ud83d\udc4d \n. lgtm \ud83d\udc4d . @kentaromiura good point. I updated also the browsers list and replaced my original commit.. @CNSKnight can you make a jsFiddle that reproduces this problem?\n. ",
    "Olical": "Good job I searched for this first rather than going straight ahead with it. I was planning on writing a YAML to AMD converter mainly built for MooTools. It would recurse over a directory reading all files and parsing their provides and requires. Then it would map the requires to the files that provide them and finally write them back.\nThe result would either be an identical directory structure or a completely flat one. The new copy would have every source file wrapped in the correct define call. It would be a separate project to MooTools so people could convert any version they want into AMD.\nI just wondered what your thoughts were on this? Because I would love to write it.\n. Just thought I would do a little comparison. Here are the two minified files. and here are the statistics.\n- YUI Compressor 86834 bytes\n- UglifyJS 82024 bytes\nSo UglifyJS removes 4810 bytes more than YUI Compressor. Not too huge in the great scheme of things but at least it is an improvement.\nThis is with the comment headers removed and without compatibility.\n. Heres the comparison again in order including closure. All measured in bytes.\nIt's close but Closure does win. I guess you then have to weigh up running a jar file or running a node module. And does compile time come into it, because UglifyJS should always be a lot faster.\n- Closure 81027 bytes\n- UglifyJS 82024 bytes\n- YUI Compressor 86834 bytes\n. Does it return the location + hash before the AJAX too? Or only after? Because I would love to have a go at fixing this.\n. Okay. I will run a few tests to determine if it only happens when using Request.HTML or whether el.set('html', '...') does it too. I will come back with what I think is the solution. If you agree with it then I will write it up and open a pull request.\n. The bug is also present in IE6, but not 8. Phew.\nThe problem also occurs when not using Request.HTML. So it happens while using el.set('html', '...') It is just something IE does when el.innerHTML is set.\nIf you set the html and then get it with el.get('html') then the href is still location + hash. So it is not just when getting the individual href property. It is almost edited on write.\nSo I think the solution lies in changingElement.Properties.html.set in Element.js. This will check for differences between the passed strings href and the href returned by the DOM. If there is a difference it will correct it.\nI am not 100% sure how I will accomplish this yet. It is difficult because you have to compare between string and DOM.\nI have never contributed to MooTools before and I have not looked at the source too much. But I have read enough tonight to understand the workings of it. I hope this seems like a \"sane\" solution to you.\n. I think the only way around this is to do a search for basically href=\"#hash\" and maybe even href=\"./relative-path\". You then loop over all anchor tags found in the rendered HTML. If one of the anchors href is equal to the loction + the relative path then you replace it with the relative version.\nHow does that sound to you?\n. Sorry, did not see your last comment. I think the one that was referenced is the closed one? This one seems to be open.\nYep, after a bit of Googling I saw it was broken in jQuery too. I think I can fix it. I want to give it a go anyway.\n. Well I reached revision 25 in my experimentation fiddle. But you are right, you can not tell if it was intended. Fixing it would probably cause more problems for more modern browsers. I guess this can be closed, or maybe kept open for reference.\nI guess the only way would be to write a html string to DOM converter. But that seems a little overkill for this.\n. Good job I searched for this first rather than going straight ahead with it. I was planning on writing a YAML to AMD converter mainly built for MooTools. It would recurse over a directory reading all files and parsing their provides and requires. Then it would map the requires to the files that provide them and finally write them back.\nThe result would either be an identical directory structure or a completely flat one. The new copy would have every source file wrapped in the correct define call. It would be a separate project to MooTools so people could convert any version they want into AMD.\nI just wondered what your thoughts were on this? Because I would love to write it.\n. Just thought I would do a little comparison. Here are the two minified files. and here are the statistics.\n- YUI Compressor 86834 bytes\n- UglifyJS 82024 bytes\nSo UglifyJS removes 4810 bytes more than YUI Compressor. Not too huge in the great scheme of things but at least it is an improvement.\nThis is with the comment headers removed and without compatibility.\n. Heres the comparison again in order including closure. All measured in bytes.\nIt's close but Closure does win. I guess you then have to weigh up running a jar file or running a node module. And does compile time come into it, because UglifyJS should always be a lot faster.\n- Closure 81027 bytes\n- UglifyJS 82024 bytes\n- YUI Compressor 86834 bytes\n. Does it return the location + hash before the AJAX too? Or only after? Because I would love to have a go at fixing this.\n. Okay. I will run a few tests to determine if it only happens when using Request.HTML or whether el.set('html', '...') does it too. I will come back with what I think is the solution. If you agree with it then I will write it up and open a pull request.\n. The bug is also present in IE6, but not 8. Phew.\nThe problem also occurs when not using Request.HTML. So it happens while using el.set('html', '...') It is just something IE does when el.innerHTML is set.\nIf you set the html and then get it with el.get('html') then the href is still location + hash. So it is not just when getting the individual href property. It is almost edited on write.\nSo I think the solution lies in changingElement.Properties.html.set in Element.js. This will check for differences between the passed strings href and the href returned by the DOM. If there is a difference it will correct it.\nI am not 100% sure how I will accomplish this yet. It is difficult because you have to compare between string and DOM.\nI have never contributed to MooTools before and I have not looked at the source too much. But I have read enough tonight to understand the workings of it. I hope this seems like a \"sane\" solution to you.\n. I think the only way around this is to do a search for basically href=\"#hash\" and maybe even href=\"./relative-path\". You then loop over all anchor tags found in the rendered HTML. If one of the anchors href is equal to the loction + the relative path then you replace it with the relative version.\nHow does that sound to you?\n. Sorry, did not see your last comment. I think the one that was referenced is the closed one? This one seems to be open.\nYep, after a bit of Googling I saw it was broken in jQuery too. I think I can fix it. I want to give it a go anyway.\n. Well I reached revision 25 in my experimentation fiddle. But you are right, you can not tell if it was intended. Fixing it would probably cause more problems for more modern browsers. I guess this can be closed, or maybe kept open for reference.\nI guess the only way would be to write a html string to DOM converter. But that seems a little overkill for this.\n. ",
    "simonsmith": "Are there still plans to make 1.x AMD compat?\n. Are there still plans to make 1.x AMD compat?\n. ",
    "storeman": "I've used the described methods for years, but since the 1.4 (or maybe 1.3) series it doesn't work anymore. Why is this removed/deprecated. I just read some articles about 1.3 and 1.4 and cannot find anything about this, while I think this functionality is used very often.\n. I really think I messed it up in my head :P. I cannot find I've ever done it before. For me it just seems so logical that I really thought it should be this way. My bad.\n. I've used the described methods for years, but since the 1.4 (or maybe 1.3) series it doesn't work anymore. Why is this removed/deprecated. I just read some articles about 1.3 and 1.4 and cannot find anything about this, while I think this functionality is used very often.\n. I really think I messed it up in my head :P. I cannot find I've ever done it before. For me it just seems so logical that I really thought it should be this way. My bad.\n. ",
    "maorcc": "In the latest release of HighCharts library from yesterday (v2.1.7) they have fixed their code to better support MooTools.  it works fine now.\nThanks!\n. In the latest release of HighCharts library from yesterday (v2.1.7) they have fixed their code to better support MooTools.  it works fine now.\nThanks!\n. ",
    "gajdusek": "Thanks for promptly reply!\nYes, it makes sense to me, just didn't notice this in blogpost - I do \nnot see that even now :(\nI see statement about deprecating Element.setOpacity() and \nElement.set('opacity'), but nothing about removing visibility updating.\nThis changes behavior of many older scripts, i.e. those using tween for \nfading and I would welcome more expressive note about this.\nBut I am comfortable with this new behavior, thanks for mootools!\n\nS pozdravem,\nPetr Gajd\u016f\u0161ek\n. Thanks for promptly reply!\nYes, it makes sense to me, just didn't notice this in blogpost - I do \nnot see that even now :(\nI see statement about deprecating Element.setOpacity() and \nElement.set('opacity'), but nothing about removing visibility updating.\nThis changes behavior of many older scripts, i.e. those using tween for \nfading and I would welcome more expressive note about this.\nBut I am comfortable with this new behavior, thanks for mootools!\n\nS pozdravem,\nPetr Gajd\u016f\u0161ek\n. ",
    "tvanreenen": "I should have mentioned that I'm using Safari 5.1.1. I didn't make an effort to test any other browsers. I'll post back if and when I get to that.\n. Yeah, immediately thats about the only solution that comes to mind.\n. I should have mentioned that I'm using Safari 5.1.1. I didn't make an effort to test any other browsers. I'll post back if and when I get to that.\n. Yeah, immediately thats about the only solution that comes to mind.\n. ",
    "jabis": "Just fyi: setting the actual Attributes using setProperty on any form/input elements has been long known to cause issues on different browsers ( IE for certain )\n. In IE 7/8 This issue arose again on 1.4.5 ( build http://mootools.net/core/76bf47062d6c1983d66ce47ad66aa0e0)\n. Just fyi: setting the actual Attributes using setProperty on any form/input elements has been long known to cause issues on different browsers ( IE for certain )\n. In IE 7/8 This issue arose again on 1.4.5 ( build http://mootools.net/core/76bf47062d6c1983d66ce47ad66aa0e0)\n. ",
    "dmcass": "The blog article below may be helpful (posted almost a year ago, though).\nA Comparison of JavaScript Compressors\n. The blog article below may be helpful (posted almost a year ago, though).\nA Comparison of JavaScript Compressors\n. ",
    "jakobholmelund": "Have you tried closure seanmonstar ? And could it maybe be possible to make mootools compatible with advanced optimization in the closure compiler, that would be so awesome ! ?\n. And her is googles closure compiler..\nOriginal Size:  135.31KB (36.65KB gzipped)\nCompiled Size:  79.13KB (25.45KB gzipped)\nEven better..\nit can be used online here \nhttp://closure-compiler.appspot.com/\nand can be downloaded here..\nhttp://code.google.com/closure/compiler/\n. But closure also has a linter, maybe that's why its slow ? Either way..\nThis isn't too important to me, since I don't commit compiled js which I\nwould consider bad practice.. It should only compile at deploy.\nOn Nov 30, 2011 5:18 PM, \"Sean McArthur\" \nreply@reply.github.com\nwrote:\n\nThat's the reason I've gone with uglifyjs: since I minify with every\ncommit, I want it to be fast as well.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2115#issuecomment-2961872\n. But.. This whoule thread was about including a new compiler in the builder, and as you can use the closure-compiler via an api it is perfectly plugable in the builder..\n. Have you tried closure seanmonstar ? And could it maybe be possible to make mootools compatible with advanced optimization in the closure compiler, that would be so awesome ! ?\n. And her is googles closure compiler..\n\nOriginal Size:  135.31KB (36.65KB gzipped)\nCompiled Size:  79.13KB (25.45KB gzipped)\nEven better..\nit can be used online here \nhttp://closure-compiler.appspot.com/\nand can be downloaded here..\nhttp://code.google.com/closure/compiler/\n. But closure also has a linter, maybe that's why its slow ? Either way..\nThis isn't too important to me, since I don't commit compiled js which I\nwould consider bad practice.. It should only compile at deploy.\nOn Nov 30, 2011 5:18 PM, \"Sean McArthur\" \nreply@reply.github.com\nwrote:\n\nThat's the reason I've gone with uglifyjs: since I minify with every\ncommit, I want it to be fast as well.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2115#issuecomment-2961872\n. But.. This whoule thread was about including a new compiler in the builder, and as you can use the closure-compiler via an api it is perfectly plugable in the builder..\n. \n",
    "barryvan": "There's also the potential for confusion between Elements.from and Array.from.\n. Here you go: http://jsfiddle.net/barryvan/Xf2mh/\nIE's UA string is: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C)\nThis is Windows 7 Ultimate N (running in VirtualBox).\n. I can't really think of a way to reproduce this. It's maybe easiest on a stock 2008 Server installation -- by default, 2008 doesn't include the requisite codecs. You really need a TechNet subscription to be able to do this sort of testing! Fortunately, I have one. :)\nFrom what I can tell, the problem is with any HTML5 media. Basically, if the codecs aren't available, IE9 just throws an exception when you try to do, well, anything with them. Now, that may not be 100% true (I haven't done exhaustive testing!), but wrapping the function bodies in try/catch blocks certainly solves the problem on my VMs.\nIf you like, I can do some more testing of this tomorrow morning [1], or early next year. I have two VMs that reproduce the issue: one Win 7, one Server 2008.\n[1] I'm WST, GMT+8.\n. As I commented on the original bug (#2184), here's a fiddle that can be used to reproduce this: http://jsfiddle.net/barryvan/Xf2mh/\nThe VM I'm running is Windows 7 Ultimate N, and IE's UA string is Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C)\n. Hmm, it looks as though it may be autoplay and loop that are particularly problematic. What about a more defensive solution that removes the problematic items? Something like\n``` js\nvar bools = [\n    'compact', 'nowrap', 'ismap', 'declare', 'noshade', 'checked',\n    'disabled', 'readOnly', 'multiple', 'selected', 'noresize',\n    'defer', 'defaultChecked', 'autofocus', 'controls', 'autoplay',\n    'loop'\n];\nvar booleans = {};\nArray.forEach(bools, function(bool, boolIndex){\n    var lower = bool.toLowerCase();\n    booleans[lower] = bool;\n    propertySetters[lower] = function(node, value){\n        try {\n            node[bool] = !!value;\n        } catch (ex) {\n            bools.splice(boolIndex, 1);\n            dbug.warn('Removed', bool, 'at index', boolIndex);\n        }\n    };\n    propertyGetters[lower] = function(node){\n        try {\n            return !!node[bool];\n        } catch (ex) {\n            bools.splice(boolIndex, 1);\n            dbug.warn('Removed', bool, 'at index', boolIndex);\n            return false;\n        }\n    };\n});\n```\nOf course, the big problem is the performance penalty of the try/catch block, so perhaps your approach of only wrapping properties that have been found to be \"dangerous\" in a try/catch block is better.\nPerhaps I'm mis-reading the code, but it looks as though this code is run only once, when MooTools is initialising, so the try/catch penalty is probably barely noticeable, and the splicing solution above is redundant, extraneous, and unnecessary. If that is, in fact, the case, I would advocate wrapping everything in a try/catch, as it's more likely to catch problems that may happen down the track.\n. There's also the potential for confusion between Elements.from and Array.from.\n. Here you go: http://jsfiddle.net/barryvan/Xf2mh/\nIE's UA string is: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C)\nThis is Windows 7 Ultimate N (running in VirtualBox).\n. I can't really think of a way to reproduce this. It's maybe easiest on a stock 2008 Server installation -- by default, 2008 doesn't include the requisite codecs. You really need a TechNet subscription to be able to do this sort of testing! Fortunately, I have one. :)\nFrom what I can tell, the problem is with any HTML5 media. Basically, if the codecs aren't available, IE9 just throws an exception when you try to do, well, anything with them. Now, that may not be 100% true (I haven't done exhaustive testing!), but wrapping the function bodies in try/catch blocks certainly solves the problem on my VMs.\nIf you like, I can do some more testing of this tomorrow morning [1], or early next year. I have two VMs that reproduce the issue: one Win 7, one Server 2008.\n[1] I'm WST, GMT+8.\n. As I commented on the original bug (#2184), here's a fiddle that can be used to reproduce this: http://jsfiddle.net/barryvan/Xf2mh/\nThe VM I'm running is Windows 7 Ultimate N, and IE's UA string is Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C)\n. Hmm, it looks as though it may be autoplay and loop that are particularly problematic. What about a more defensive solution that removes the problematic items? Something like\n``` js\nvar bools = [\n    'compact', 'nowrap', 'ismap', 'declare', 'noshade', 'checked',\n    'disabled', 'readOnly', 'multiple', 'selected', 'noresize',\n    'defer', 'defaultChecked', 'autofocus', 'controls', 'autoplay',\n    'loop'\n];\nvar booleans = {};\nArray.forEach(bools, function(bool, boolIndex){\n    var lower = bool.toLowerCase();\n    booleans[lower] = bool;\n    propertySetters[lower] = function(node, value){\n        try {\n            node[bool] = !!value;\n        } catch (ex) {\n            bools.splice(boolIndex, 1);\n            dbug.warn('Removed', bool, 'at index', boolIndex);\n        }\n    };\n    propertyGetters[lower] = function(node){\n        try {\n            return !!node[bool];\n        } catch (ex) {\n            bools.splice(boolIndex, 1);\n            dbug.warn('Removed', bool, 'at index', boolIndex);\n            return false;\n        }\n    };\n});\n```\nOf course, the big problem is the performance penalty of the try/catch block, so perhaps your approach of only wrapping properties that have been found to be \"dangerous\" in a try/catch block is better.\nPerhaps I'm mis-reading the code, but it looks as though this code is run only once, when MooTools is initialising, so the try/catch penalty is probably barely noticeable, and the splicing solution above is redundant, extraneous, and unnecessary. If that is, in fact, the case, I would advocate wrapping everything in a try/catch, as it's more likely to catch problems that may happen down the track.\n. ",
    "satazor": "I can't access the Element.Storag.. console.log(Element.Storage) -> undefined.\nIn v1.4.1 we actually override some of mootools methods in order to get the storage cloned, but now it doesn't work because the $uid was removed:\n(function() {\n```\n//TODO: Solve this / send a ticket to mootools\nvar get = function(uid){\n        return (storage[uid] || (storage[uid] = {}));\n};\nvar storage = {};\nElement.implement({\nretrieve: function(property, dflt){\n    var storage = get($uid(this)), prop = storage[property];\n    if (dflt != null && prop == null) prop = storage[property] = dflt;\n    return prop != null ? prop : null;\n},\n\nstore: function(property, value){\n    var storage = get($uid(this));\n    storage[property] = value;\n    return this;\n},\n\neliminate: function(property){\n    var storage = get($uid(this));\n    delete storage[property];\n    return this;\n},\n\ncloneStorage: function(from) { \n    var fromStorage = get($uid(from));\n    storage[$uid(this)] = Object.clone(fromStorage);\n}\n\n});\n```\n})();\nAt the moment we got to stick with 1.4.1 until we find a way to clone the storage.\n. @fakedarren don't you seem legit to fix the hpwOS to be parsed in the core?\nI expect that Browser.webos would be true if someone is running a HP Touchpad that runs the new webOS 3.0\n. We still can apply the hook by doing using Slick.uidOf(this).\nStill, don't you guys think that the Element's storage could be exposed so we can manually do this without overriding mootools methods?\n. I'm using mootools as the base library for a single page app, on top of a private MVCS framework.\nCorrect me if i'm wrong, but the garbage collection is only made on page unload right?\n. Allright, I will keep this hook until a solution appears..\n. That would be awesome.\n. Is this a problem with Request.HTML or also with Request?\n. Yes it's fixed. This is the results on chrome canary on a 20 MB file:\nTotal time: 2479ms (with moo)\nTotal time: 2023 (without moo)\nThere is still a ~400ms gap but I don't know what is causing it. This gap doesn't exist in Firefox.\nAlso the whole issue only happens with some recent optimizations in v8 that are committed in Chrome 17+.\nIn Chrome 16, the results where around the 4000ms but the ~400ms gap already existed.\n. Allright i will take a look on it as soon as I get some time.\n. Will this be addressed soon?\n. This is very weird.. if the table row has display block its fine: http://jsfiddle.net/KemYP/11/\n@DimitarChristoff @arian\n. Bump!\n. After taking a look at the Browser code, as a fallback if Safari is contained in the string then mootools assumes it is safari.\nIs this intended?\n. @arian if one uses the Browser to make some browser usage statistics it will report the wrong browser. Thats just one example.\n. Ups, closed and reopened by mistake.\n. I think that if one is targeting the engine, its wrong to check for safari, they should check for webkit instead. Thats why other libraries such as YUI and Dojo offers .webkit, .gecko checks, etc..\nI just opened this issue because for me, the Browser name is different than the Browser engine and mootools offers only Browser name checks, and is currently failing (maybe on purpose) to deliver the correct browser name to the final developer.\n. @SergioCrisostomo just add the correct bower.json file: https://github.com/satazor/mootools-core/commit/e10cd89cd4b1c1bae86cd4a66881368973440166\nFeel free to pull from my fork @ master so that this PR contains my changes as well.\nPlease modify the \"authors\" field accordingly.\nAlso confirm the \"dist\" folder with the file output from the build.\n. I can't access the Element.Storag.. console.log(Element.Storage) -> undefined.\nIn v1.4.1 we actually override some of mootools methods in order to get the storage cloned, but now it doesn't work because the $uid was removed:\n(function() {\n```\n//TODO: Solve this / send a ticket to mootools\nvar get = function(uid){\n        return (storage[uid] || (storage[uid] = {}));\n};\nvar storage = {};\nElement.implement({\nretrieve: function(property, dflt){\n    var storage = get($uid(this)), prop = storage[property];\n    if (dflt != null && prop == null) prop = storage[property] = dflt;\n    return prop != null ? prop : null;\n},\n\nstore: function(property, value){\n    var storage = get($uid(this));\n    storage[property] = value;\n    return this;\n},\n\neliminate: function(property){\n    var storage = get($uid(this));\n    delete storage[property];\n    return this;\n},\n\ncloneStorage: function(from) { \n    var fromStorage = get($uid(from));\n    storage[$uid(this)] = Object.clone(fromStorage);\n}\n\n});\n```\n})();\nAt the moment we got to stick with 1.4.1 until we find a way to clone the storage.\n. @fakedarren don't you seem legit to fix the hpwOS to be parsed in the core?\nI expect that Browser.webos would be true if someone is running a HP Touchpad that runs the new webOS 3.0\n. We still can apply the hook by doing using Slick.uidOf(this).\nStill, don't you guys think that the Element's storage could be exposed so we can manually do this without overriding mootools methods?\n. I'm using mootools as the base library for a single page app, on top of a private MVCS framework.\nCorrect me if i'm wrong, but the garbage collection is only made on page unload right?\n. Allright, I will keep this hook until a solution appears..\n. That would be awesome.\n. Is this a problem with Request.HTML or also with Request?\n. Yes it's fixed. This is the results on chrome canary on a 20 MB file:\nTotal time: 2479ms (with moo)\nTotal time: 2023 (without moo)\nThere is still a ~400ms gap but I don't know what is causing it. This gap doesn't exist in Firefox.\nAlso the whole issue only happens with some recent optimizations in v8 that are committed in Chrome 17+.\nIn Chrome 16, the results where around the 4000ms but the ~400ms gap already existed.\n. Allright i will take a look on it as soon as I get some time.\n. Will this be addressed soon?\n. This is very weird.. if the table row has display block its fine: http://jsfiddle.net/KemYP/11/\n@DimitarChristoff @arian\n. Bump!\n. After taking a look at the Browser code, as a fallback if Safari is contained in the string then mootools assumes it is safari.\nIs this intended?\n. @arian if one uses the Browser to make some browser usage statistics it will report the wrong browser. Thats just one example.\n. Ups, closed and reopened by mistake.\n. I think that if one is targeting the engine, its wrong to check for safari, they should check for webkit instead. Thats why other libraries such as YUI and Dojo offers .webkit, .gecko checks, etc..\nI just opened this issue because for me, the Browser name is different than the Browser engine and mootools offers only Browser name checks, and is currently failing (maybe on purpose) to deliver the correct browser name to the final developer.\n. @SergioCrisostomo just add the correct bower.json file: https://github.com/satazor/mootools-core/commit/e10cd89cd4b1c1bae86cd4a66881368973440166\nFeel free to pull from my fork @ master so that this PR contains my changes as well.\nPlease modify the \"authors\" field accordingly.\nAlso confirm the \"dist\" folder with the file output from the build.\n. ",
    "ahmadnassri": "I hear your point about the Accept header, though my core belief is to stick to the standard, and since there is none for default Accept header, its really up to the implementer to decide, in this case, whoever is writing the javascript functions should overwrite to match his use-case...\nthat said, I realize that there are many \"novice\" devs out there who don't even understand any of this and just assume it will work ... I have a chrome extension project REST Console built with MooTools and people keep complaining that POST requests don't work, after much investigation turns out they were not setting the Content-Type header to application/x-www-form-urlencoded ... nobody even knew what it is!\nso yeah, you probably want to change those headers back ...\n. I hear your point about the Accept header, though my core belief is to stick to the standard, and since there is none for default Accept header, its really up to the implementer to decide, in this case, whoever is writing the javascript functions should overwrite to match his use-case...\nthat said, I realize that there are many \"novice\" devs out there who don't even understand any of this and just assume it will work ... I have a chrome extension project REST Console built with MooTools and people keep complaining that POST requests don't work, after much investigation turns out they were not setting the Content-Type header to application/x-www-form-urlencoded ... nobody even knew what it is!\nso yeah, you probably want to change those headers back ...\n. ",
    "dmail": "Thanks for your answer.\nI thought it was to much work compared to the benefit but as you say it's really friendly to be able to write this.parent();\nIn any case mootools is the best thing that ever happened in my .js life :)\n. Object.getPrototypeOf could be a solution but not supported enough for mootools browser target, I suppose.\nIf compatibility wasn't an issue, a simplified shorthand could be:\nClass.implement('applyProto', function(method, args){\n     return Object.getPrototypeOf(this)[method].apply(this, args);\n});\nvar instance = new Class();\ninstance.applyProto('methodname', [arg1, arg2]);\n. Yeah, why?\n. Thanks for your answer.\nI thought it was to much work compared to the benefit but as you say it's really friendly to be able to write this.parent();\nIn any case mootools is the best thing that ever happened in my .js life :)\n. Object.getPrototypeOf could be a solution but not supported enough for mootools browser target, I suppose.\nIf compatibility wasn't an issue, a simplified shorthand could be:\nClass.implement('applyProto', function(method, args){\n     return Object.getPrototypeOf(this)[method].apply(this, args);\n});\nvar instance = new Class();\ninstance.applyProto('methodname', [arg1, arg2]);\n. Yeah, why?\n. ",
    "danielbeardsley": "Though this does address a shortfall of the Mootools class system; There seems to be no way to access the Base class's implementation of an overridden method without hard-linking it (BaseClass.prototype.method.call())\n. I was working with a legacy codebase that used javascript constructors and prototypical inheritance (i.e. standard javascript): \nfunction Thing() {}\nThing.prototype = new Events();\nThe Events class had been used naively and worked except that every instance shared the same $events property, which is obviously bad. Anyway, this is how we solved the problem, a tiny change to Mootools to make it behave in a more predictable way. It would have been better if the above usage just didn't work at all.. but instead it worked but was broken in a subtle way.\n. Though this does address a shortfall of the Mootools class system; There seems to be no way to access the Base class's implementation of an overridden method without hard-linking it (BaseClass.prototype.method.call())\n. I was working with a legacy codebase that used javascript constructors and prototypical inheritance (i.e. standard javascript): \nfunction Thing() {}\nThing.prototype = new Events();\nThe Events class had been used naively and worked except that every instance shared the same $events property, which is obviously bad. Anyway, this is how we solved the problem, a tiny change to Mootools to make it behave in a more predictable way. It would have been better if the above usage just didn't work at all.. but instead it worked but was broken in a subtle way.\n. ",
    "pr3fect": "did you consider taking this into the core?\n. Well your mootools-mobile repo is actually pretty useful. I didnt't know it before and I guess most of the people im working with also dont know it. Wouldn't it be nice to bring this into 'more' or make it somehow available through the building system? People would get to know about this. Actually I also wonder, if there could be a case where you dont want a click to be as responsive as a tap on a touch device? (I saw that you made this optional in your repo)\n. I'll take the chance and spread the word! ;)\nThanks for your comments\n. I guess that might break tons of scripts where ppl use Element.getStyle('width') or similar instead of Element.Dimensions\n. Good example @MrPrime but would you always want a \"px\" suffix on the returned value? That could make further calculations a bit bloated as you always need to run it through parseInt to get an integer value.\nFor example think of that you want to sum up margin-top and margin-bottom:\njavascript\n$('demo').css('margin-top') + $('demo').css('margin-bottom') // '13px0px'\nparseInt($('demo').css('margin-top'), 10) + parseInt($('demo').css('margin-bottom'), 10) // 13\n. did you consider taking this into the core?\n. Well your mootools-mobile repo is actually pretty useful. I didnt't know it before and I guess most of the people im working with also dont know it. Wouldn't it be nice to bring this into 'more' or make it somehow available through the building system? People would get to know about this. Actually I also wonder, if there could be a case where you dont want a click to be as responsive as a tap on a touch device? (I saw that you made this optional in your repo)\n. I'll take the chance and spread the word! ;)\nThanks for your comments\n. I guess that might break tons of scripts where ppl use Element.getStyle('width') or similar instead of Element.Dimensions\n. Good example @MrPrime but would you always want a \"px\" suffix on the returned value? That could make further calculations a bit bloated as you always need to run it through parseInt to get an integer value.\nFor example think of that you want to sum up margin-top and margin-bottom:\njavascript\n$('demo').css('margin-top') + $('demo').css('margin-bottom') // '13px0px'\nparseInt($('demo').css('margin-top'), 10) + parseInt($('demo').css('margin-bottom'), 10) // 13\n. ",
    "pronouncedJerry": "After further investigation, if I change the following in adopt:\nfrom:\nelements = Array.flatten(arguments)\nto:\nelements = arguments\nThe leak disappears.\n. My colleague followed up on my findings and stated the following:\nAfter digging a little deeper into the code, I found the culprit: instanceof. Apparently if you call instanceof on a \u201cnon-object\u201d in IE, memory gets leaked (http://ajaxian.com/archives/working-aroung-the-instanceof-memory-leak). So, this isn\u2019t a mootools bug, it\u2019s a bug in IE itself.\n. Thank you!\nI was simply using Process Explorer to track the usage. http://technet.microsoft.com/en-us/sysinternals/bb896653\nIt appears that the calling of instanceof on 'non-objects' (mootools.js flatten()) causes the memory leaks in IE. http://ajaxian.com/archives/working-aroung-the-instanceof-memory-leak\nWe ended up implementing the following:\njs\nif(Browser.ie) {\n        instanceOf = this.instanceOf = function(item, object) {\n            if (item == null) return false;\n            // Avoid calling instanceof on certain \"non-objects\" to prevent memory leaks in IE\n            if (!item.hasOwnProperty) return false;\n            var constructor = item.$constructor || item.constructor;\n            while (constructor){\n                if (constructor === object) return true;\n                constructor = constructor.parent;\n            }\n            return item instanceof object;\n        };\n    }\n. Big thanks to all of you!\n. Is there a temporary workaround until 1.4.5 gets rolled out?\n. After further investigation, if I change the following in adopt:\nfrom:\nelements = Array.flatten(arguments)\nto:\nelements = arguments\nThe leak disappears.\n. My colleague followed up on my findings and stated the following:\nAfter digging a little deeper into the code, I found the culprit: instanceof. Apparently if you call instanceof on a \u201cnon-object\u201d in IE, memory gets leaked (http://ajaxian.com/archives/working-aroung-the-instanceof-memory-leak). So, this isn\u2019t a mootools bug, it\u2019s a bug in IE itself.\n. Thank you!\nI was simply using Process Explorer to track the usage. http://technet.microsoft.com/en-us/sysinternals/bb896653\nIt appears that the calling of instanceof on 'non-objects' (mootools.js flatten()) causes the memory leaks in IE. http://ajaxian.com/archives/working-aroung-the-instanceof-memory-leak\nWe ended up implementing the following:\njs\nif(Browser.ie) {\n        instanceOf = this.instanceOf = function(item, object) {\n            if (item == null) return false;\n            // Avoid calling instanceof on certain \"non-objects\" to prevent memory leaks in IE\n            if (!item.hasOwnProperty) return false;\n            var constructor = item.$constructor || item.constructor;\n            while (constructor){\n                if (constructor === object) return true;\n                constructor = constructor.parent;\n            }\n            return item instanceof object;\n        };\n    }\n. Big thanks to all of you!\n. Is there a temporary workaround until 1.4.5 gets rolled out?\n. ",
    "chrisdrackett": "but I don't know if what I'm looking for is before or after the element in question. I just know its a sibling.\n. right, I was just curious because other methods have both singular and plural, like getParent getParents and getElement getElements\n. but I don't know if what I'm looking for is before or after the element in question. I just know its a sibling.\n. right, I was just curious because other methods have both singular and plural, like getParent getParents and getElement getElements\n. ",
    "jjok": "The error is in Object.extend.map.\n. The error is in Object.extend.map.\n. ",
    "abimelex": "great, that's working!\n. great, that's working!\n. ",
    "rhuynh": "make sense.  thanks\n. make sense.  thanks\n. ",
    "assertchris": "Bump\n. Competing prototype alterations sound like a wontfix/2.0 to me.\n. It is disappointing seeing what is clearly a lot of work being moth-balled so rudely.\n. @cpojer Problem is it forces the string.substitute deep substitution to be in more as well. I am not against the idea of deciding something is a better fit in more or as a forge plugin - that is the purpose of collaboration after all. What embarrasses me the tone with which this was expressed. The man is just trying to contribute. :)\n. Do you want me to make this change or can the issue be closed?\n. What about try/catching exceptions from within Events? Bad for traditional debugging but ok for keeping the events going...\n. bump\n. I have one Request instance which I am reusing for 6 different method/URL combinations:\nGET/add.html, POST/add.html\nGET/edit.html, POST/edit.html\nGET/delete.html, POST/delete.html\nThe problem is that the success callback needs to differentiate between GET and POST calls and it cannot currently do that without the extra header I added. Interestingly enough, I have changed all calls to .get/.post to be .send calls but the options are still not updated when I supply them to the .send method.\nTL;DR: this.options isn't updated for .get/.post calls or .send parameters.\n. I'm not sure changing the base options is the right approach either. The issue is just that there is no way to tell what request method was used in the current success context. Almost all of my success callback's functionality remains the same for any of the URL's and request methods, so it doesn't really make sense for me to duplicate this functionality 6 times...\n. The docs clearly state that those methods return data from the last request, not from option state.\n. Bump\n. Competing prototype alterations sound like a wontfix/2.0 to me.\n. It is disappointing seeing what is clearly a lot of work being moth-balled so rudely.\n. @cpojer Problem is it forces the string.substitute deep substitution to be in more as well. I am not against the idea of deciding something is a better fit in more or as a forge plugin - that is the purpose of collaboration after all. What embarrasses me the tone with which this was expressed. The man is just trying to contribute. :)\n. Do you want me to make this change or can the issue be closed?\n. What about try/catching exceptions from within Events? Bad for traditional debugging but ok for keeping the events going...\n. bump\n. I have one Request instance which I am reusing for 6 different method/URL combinations:\nGET/add.html, POST/add.html\nGET/edit.html, POST/edit.html\nGET/delete.html, POST/delete.html\nThe problem is that the success callback needs to differentiate between GET and POST calls and it cannot currently do that without the extra header I added. Interestingly enough, I have changed all calls to .get/.post to be .send calls but the options are still not updated when I supply them to the .send method.\nTL;DR: this.options isn't updated for .get/.post calls or .send parameters.\n. I'm not sure changing the base options is the right approach either. The issue is just that there is no way to tell what request method was used in the current success context. Almost all of my success callback's functionality remains the same for any of the URL's and request methods, so it doesn't really make sense for me to duplicate this functionality 6 times...\n. The docs clearly state that those methods return data from the last request, not from option state.\n. ",
    "dehenne": "The complete UA String is:\nMozilla/5.0 (hp-tablet; Linux; hpwOS/3.0.4; U; de-DE) AppleWebKit/534.6 (KHTML, like Gecko) wOSBrowser/234.76 Safari/534.6 TouchPad/1.0\nI hope this helps :-)\n. Sorry for the long response, I think webos is better, too, \nHmm, I have another idea, what you think about:\nPlatform: {\n    name: ua.match(/ip(?:ad|od|hone)/) ? 'ios' : (ua.match(/(?:hpwos)/) ? 'webos' : (ua.match(/(?:webos|android)/) || platform.match(/mac|win|linux/) || ['other'])[0])\n},\nAnd in the UA match line we add 'hpwos' for the Version:\n. Hey Guys,\nsorry for double post. Maybe i have an easier way for it.\nWe can do:\nAnd i think i have a bug in the version parameter. I implement the new chrome android version and saw \nThe versions of chrome (android) and touchpad browser like  . \nparseFloat() convert x.x.x to x\nIf you want I can make a new pull request with all fixes and we can close this request.\nThe fix include the new chrome android. On my nexus the UA string is:\nhttps://github.com/dehenne/mootools-core/commit/1d25758f1b4627fe8f3f80081fde082c2aa89710\nWhats your opinion, is the replace a bad idea?\n. The complete UA String is:\nMozilla/5.0 (hp-tablet; Linux; hpwOS/3.0.4; U; de-DE) AppleWebKit/534.6 (KHTML, like Gecko) wOSBrowser/234.76 Safari/534.6 TouchPad/1.0\nI hope this helps :-)\n. Sorry for the long response, I think webos is better, too, \nHmm, I have another idea, what you think about:\nPlatform: {\n    name: ua.match(/ip(?:ad|od|hone)/) ? 'ios' : (ua.match(/(?:hpwos)/) ? 'webos' : (ua.match(/(?:webos|android)/) || platform.match(/mac|win|linux/) || ['other'])[0])\n},\nAnd in the UA match line we add 'hpwos' for the Version:\n. Hey Guys,\nsorry for double post. Maybe i have an easier way for it.\nWe can do:\nAnd i think i have a bug in the version parameter. I implement the new chrome android version and saw \nThe versions of chrome (android) and touchpad browser like  . \nparseFloat() convert x.x.x to x\nIf you want I can make a new pull request with all fixes and we can close this request.\nThe fix include the new chrome android. On my nexus the UA string is:\nhttps://github.com/dehenne/mootools-core/commit/1d25758f1b4627fe8f3f80081fde082c2aa89710\nWhats your opinion, is the replace a bad idea?\n. ",
    "thatmarvin": "Is there an existing spec file for the base Fx class? I can't seem to find it.\n. Ok cool I'll give it a shot.\n. First attempt:\n``` javascript\nit('should return the paused state', function(){\n    var fx = new Fx({\n        duration: 50\n    })\n    fx.start(); // Why does this break other specs?\nexpect(fx.isPaused()).toEqual(false);\n\nthis.clock.tick(30);\nfx.pause();\n\nexpect(fx.isPaused()).toEqual(true);\n\nfx.resume();\nthis.clock.tick(60);\nexpect(fx.isPaused()).toEqual(false);\n\n});\n```\nFor some reason, other Fx specs started failing when fx.start() is called even though they seem completely separated. What am I doing wrong here?\n. I agree with @davidfoley. The Content-type of the request should not influence the semantics of the HTTP verbs.\nHere's what W3C says about DELETE (my use case): \n\nA successful response SHOULD be 200 (OK) if the response includes an entity describing the status, 202 (Accepted) if the action has not yet been enacted, or 204 (No Content) if the action has been enacted but the response does not include an entity. \n\nBesides, it's simply unexpected behavior for a 2xx class response code to invoke onFailure.\n. Is there an existing spec file for the base Fx class? I can't seem to find it.\n. Ok cool I'll give it a shot.\n. First attempt:\n``` javascript\nit('should return the paused state', function(){\n    var fx = new Fx({\n        duration: 50\n    })\n    fx.start(); // Why does this break other specs?\nexpect(fx.isPaused()).toEqual(false);\n\nthis.clock.tick(30);\nfx.pause();\n\nexpect(fx.isPaused()).toEqual(true);\n\nfx.resume();\nthis.clock.tick(60);\nexpect(fx.isPaused()).toEqual(false);\n\n});\n```\nFor some reason, other Fx specs started failing when fx.start() is called even though they seem completely separated. What am I doing wrong here?\n. I agree with @davidfoley. The Content-type of the request should not influence the semantics of the HTTP verbs.\nHere's what W3C says about DELETE (my use case): \n\nA successful response SHOULD be 200 (OK) if the response includes an entity describing the status, 202 (Accepted) if the action has not yet been enacted, or 204 (No Content) if the action has been enacted but the response does not include an entity. \n\nBesides, it's simply unexpected behavior for a 2xx class response code to invoke onFailure.\n. ",
    "stecb": "Oh yes, will do it asap!\n. Oh yes, will do it asap!\n. ",
    "jbgithub": "I appreciate everyone\u2019s work to make Mootools better but for the last three releases, major errors have been introduced. v1.4.2 crashed IE7, v1.4.3 prevented get() from retrieving custom attributes in IE8 or less, and now v1.4.4 causes NaN errors in the FX Class which is caused by the change in this thread.\nYour home page states: \u201cMootools is compatible and fully tested with Safari, Internet Explorer 6+, Firefox, Opera, and Chrome.\u201d As of late \u201cfully tested\u201d is falling short, especially for IE.\nHaving the public test your releases is not the way to keep your current user base or to increase it.\n. I definitely appreciate the difficulty in developing and testing for the various platforms, browsers and browser versions. I have my own test environment (an array of virtual machines and MACs) in which I test. When I tested v1.4.2 I informed you of the line # that crashes IE7 in issue #2163. When I tested v1.4.3 I changed my code to use getAttribute() instead of get() or getProperty() since I didn't know if this was a bug or a permanent change. Yesterday I commented out the changes to prepare() to get v1.4.4 to work.\nNever said the previous versions didn't have bugs but some bugs are more severe than others; v1.4.2 is unusable for IE7 and v1.4.4 is unusable for code reliant on the FX class.\nMy development and test areas are behind a firewall and my corporate clients have their own staging areas; so I unable to make these areas available.\nI'd be happy to help and test a build during a freeze period, is there a way to get notified one is available?\nOn a side note I was happy that you brought back IE's fireEvent() in v1.4.2(3), I don't have to rename Mootool's fireEvent() anymore. This was a major issue to overcome in deciding to adopt Mootools in my development. One of the issues with Mootools fireEvent() is it does not create an event object to be passed to the event handler as dispatchEvent() and IE's fireEvent do. This prevents sharing one event handler with more than one element since you cannot determine the triggering element (event.target).\n. @ibolmo How do I get access to the nightly build? I am new to GitHub, am I to pull all the files and build it myself or is readily available?\n. I ran thru my sites using 1.4.5dev and didn't encounter anything that would prevent me from implementing it when it is released. Thanks.\n. @ibolmo v1.4.2 is crashing IE7 for my web app too but v1.4.1 is not, so I compared the two.\nI found that line #2944 (el._fireEvent = el.fireEvent;) is cause of the problem.\nI changed the code to:\nif (Browser.Element){\n    el._fireEvent = el.fireEvent;\n}\nThis fixes IE7 crashing for me.\nBrowser.Element is used on line #2732 to determine if fireEvent should be added to Element.prototype for IE8 & IE9.\n. @arian Yes, line #261.\n. @ibolmo I tried the fix and it works for me. Thanks.\n. Perfect! It's great that only the older browsers have to execute the code via what I assume are conditional comments \"/<ltIE9>_/\". \nI am aware of MS conditional compilation for JavaScript i.e. /@cc_on @/, where is the type you are using defined?\n. Thanks. I always wondered about those comments in mootools.\n. I entered a test case in jsfiddle but I am unfamilar with how you get to see it.\nThis is the URL for the test case: http://jsfiddle.net/24HJD/\n. After I posted the test case I realized what was wrong; I shouldn\u2019t have used getChildren().\nI didn\u2019t see it earlier because I was adding getFirst() code to old code that incorrectly used getLast() with getChildren(). Since getLast() worked I thought getFirst() would work the same way too.\nThis is the corrected code:\nvar oTBody1 = $(\"tbBody1\");\nvar oFirstRow   = oTBody1.getFirst();\nvar oLastRow    = oTBody1.getLast();\nThanks for the explanation why getLast() worked and getFirst() did not.\n. I appreciate everyone\u2019s work to make Mootools better but for the last three releases, major errors have been introduced. v1.4.2 crashed IE7, v1.4.3 prevented get() from retrieving custom attributes in IE8 or less, and now v1.4.4 causes NaN errors in the FX Class which is caused by the change in this thread.\nYour home page states: \u201cMootools is compatible and fully tested with Safari, Internet Explorer 6+, Firefox, Opera, and Chrome.\u201d As of late \u201cfully tested\u201d is falling short, especially for IE.\nHaving the public test your releases is not the way to keep your current user base or to increase it.\n. I definitely appreciate the difficulty in developing and testing for the various platforms, browsers and browser versions. I have my own test environment (an array of virtual machines and MACs) in which I test. When I tested v1.4.2 I informed you of the line # that crashes IE7 in issue #2163. When I tested v1.4.3 I changed my code to use getAttribute() instead of get() or getProperty() since I didn't know if this was a bug or a permanent change. Yesterday I commented out the changes to prepare() to get v1.4.4 to work.\nNever said the previous versions didn't have bugs but some bugs are more severe than others; v1.4.2 is unusable for IE7 and v1.4.4 is unusable for code reliant on the FX class.\nMy development and test areas are behind a firewall and my corporate clients have their own staging areas; so I unable to make these areas available.\nI'd be happy to help and test a build during a freeze period, is there a way to get notified one is available?\nOn a side note I was happy that you brought back IE's fireEvent() in v1.4.2(3), I don't have to rename Mootool's fireEvent() anymore. This was a major issue to overcome in deciding to adopt Mootools in my development. One of the issues with Mootools fireEvent() is it does not create an event object to be passed to the event handler as dispatchEvent() and IE's fireEvent do. This prevents sharing one event handler with more than one element since you cannot determine the triggering element (event.target).\n. @ibolmo How do I get access to the nightly build? I am new to GitHub, am I to pull all the files and build it myself or is readily available?\n. I ran thru my sites using 1.4.5dev and didn't encounter anything that would prevent me from implementing it when it is released. Thanks.\n. @ibolmo v1.4.2 is crashing IE7 for my web app too but v1.4.1 is not, so I compared the two.\nI found that line #2944 (el._fireEvent = el.fireEvent;) is cause of the problem.\nI changed the code to:\nif (Browser.Element){\n    el._fireEvent = el.fireEvent;\n}\nThis fixes IE7 crashing for me.\nBrowser.Element is used on line #2732 to determine if fireEvent should be added to Element.prototype for IE8 & IE9.\n. @arian Yes, line #261.\n. @ibolmo I tried the fix and it works for me. Thanks.\n. Perfect! It's great that only the older browsers have to execute the code via what I assume are conditional comments \"/<ltIE9>_/\". \nI am aware of MS conditional compilation for JavaScript i.e. /@cc_on @/, where is the type you are using defined?\n. Thanks. I always wondered about those comments in mootools.\n. I entered a test case in jsfiddle but I am unfamilar with how you get to see it.\nThis is the URL for the test case: http://jsfiddle.net/24HJD/\n. After I posted the test case I realized what was wrong; I shouldn\u2019t have used getChildren().\nI didn\u2019t see it earlier because I was adding getFirst() code to old code that incorrectly used getLast() with getChildren(). Since getLast() worked I thought getFirst() would work the same way too.\nThis is the corrected code:\nvar oTBody1 = $(\"tbBody1\");\nvar oFirstRow   = oTBody1.getFirst();\nvar oLastRow    = oTBody1.getLast();\nThanks for the explanation why getLast() worked and getFirst() did not.\n. ",
    "saxinte": "Yes, try to open this url in IE7 and refresh the page. My IE7 crash.\nhttp://jsfiddle.net/sebastienaxinte/SU349/\n. Hi,\nI've try your example (incendium) and it works both on my config, weird...\nSo i also posted and example who crashed on my config. (without console.log())\nThis works :\nhttp://www.apixelife.com/github/2163/mootools-core-1.4.1.html\nThis one doesn't :\nhttp://www.apixelife.com/github/2163/mootools-core-1.4.2.html\nThanks\n. @ibolmo I'm sorry but i'm new with github and i've tried to add the Element.js after calling mootools-core-1.4.2.js you mentioned above but it makes JS errors... i think i don't understand what you want me to test..maybe i can try with the mootools 1.4.3 ? but i don't know where can i download this full packed version...\n@incendium Just tried your test but still works for me.\n. @incendium my 'crash version' ( http://www.apixelife.com/github/2163/mootools-core-1.4.2.html ) crash on your IE7 ?\n. @ibolmo Just changed the diff in http://www.apixelife.com/github/2163/mootools-core-1.4.2.html but still crash :(\nI use VirtualBox VM running XP SP2 Version 7.0.5730.11\n. @dmethvin just tried to disables my add-ons on IE7 still crashes :x\nHere a screenshot of my add-ons : http://gyazo.com/b691c1d74914d19fe120f2dab5a51336\n. Yes, try to open this url in IE7 and refresh the page. My IE7 crash.\nhttp://jsfiddle.net/sebastienaxinte/SU349/\n. Hi,\nI've try your example (incendium) and it works both on my config, weird...\nSo i also posted and example who crashed on my config. (without console.log())\nThis works :\nhttp://www.apixelife.com/github/2163/mootools-core-1.4.1.html\nThis one doesn't :\nhttp://www.apixelife.com/github/2163/mootools-core-1.4.2.html\nThanks\n. @ibolmo I'm sorry but i'm new with github and i've tried to add the Element.js after calling mootools-core-1.4.2.js you mentioned above but it makes JS errors... i think i don't understand what you want me to test..maybe i can try with the mootools 1.4.3 ? but i don't know where can i download this full packed version...\n@incendium Just tried your test but still works for me.\n. @incendium my 'crash version' ( http://www.apixelife.com/github/2163/mootools-core-1.4.2.html ) crash on your IE7 ?\n. @ibolmo Just changed the diff in http://www.apixelife.com/github/2163/mootools-core-1.4.2.html but still crash :(\nI use VirtualBox VM running XP SP2 Version 7.0.5730.11\n. @dmethvin just tried to disables my add-ons on IE7 still crashes :x\nHere a screenshot of my add-ons : http://gyazo.com/b691c1d74914d19fe120f2dab5a51336\n. ",
    "incendium": "I put together a quick test case which I can reliably reproduce the issue on. I've hosted it on my personal site to take out jsfiddle as the culprit.\nhttp://iamincendium.com/github-2163/mootools-1.4.1.htm\nhttp://iamincendium.com/github-2163/mootools-1.4.2.htm\nRefresh the page and nothing happens. Click the button (which has an event handler assigned to it) and then reload and IE 7 will crash on the 1.4.2 page, but not 1.4.1.\n. Also wanted to add that commenting out line 742 in Element.js seems to stop IE from crashing.\nhttp://iamincendium.com/github-2163/mootools-1.4.2-working.htm\n. Here is exactly how I was able to reproduce the crash:\n1) Close all running instances of IE7\n2) Open IE7 and pull up http://iamincendium.com/github-2163/mootools-1.4.2.htm immediately (I think if you pull up a page with a working version of MooTools first this will cause the issue not to happen)\n3) Hit Ctrl+R to reload page\n4) Click button (hello should change to world)\n5) Hit Ctrl+R again\n6) IE7 crashes\nApplying the patch you mentioned seems to have fixed the issue (IE7 no longer crashes using the steps above on http://iamincendium.com/github-2163/mootools-1.4.2.htm).\n. @ibolmo Thanks for the fix, glad to see I can keep MooTools up-to-date. IE seems to be pretty spotty about whether or not it likes to be buggy. I'll look forward to the day when the only version of IE I have to support is 9 and up. I can only hope I don't run into any customer issues that involve selectively installed Windows updates.\nFWIW, I was able to reproduce this in a relatively fresh VirtualBox VM running a fully patched XP SP3 Pro, with IE fully patched (as of the 12/13 patch Tuesday) and all of the optional .NET updates. \n@isfalse Yep, it does.\n. @ibolmo It looks like using @isfalse's test page crashes my IE installation as well. Here are the steps I took to reproduce it:\n1) Close all running instances of IE7\n2) Open IE7 and disable all addons\n3) Close all running instances of IE7\n4) Open http://www.apixelife.com/github/2163/mootools-core-1.4.2.html\n5) Refresh page using Ctrl+R\n6) IE7 crashes\nI peeked at his mootools.js file and it looks like he patched it OK. Perhaps there is some attribute that IE doesn't like and crashes when it tries to clear it?\n. I unfortunately can't share my current VM, but once I get home tonight, I'll see if I can get it to reproduce on the official IE7 Virtual PC test image.\n. Interestingly enough, the issue didn't pop up in the official XP IE6/7 VM until after I installed one of the .NET framework updates. Without .NET, IE7 ran great with no crashes on any of the pages that caused issues on my development setup.\n@ibolmo Before I try to upload a ~4GB hard disk image to my server, could you try fully patching your Windows VM (with all of the .NET frameworks and patches) and see if you are able to reproduce the issue after the fact?\n. Looks like it's working on my end. Tried it using both test cases that were failing for me and they both work now. Awesome job!\n. Also able to reproduce this in the Firefox (9.0) beta channel build. A lot (but not all) of the symbol keys seem to be incorrect.\n1. US Keyboard\n2. Windows 7 Professional SP1\n. Working great now. Thanks for the quick turnaround.\n. I put together a quick test case which I can reliably reproduce the issue on. I've hosted it on my personal site to take out jsfiddle as the culprit.\nhttp://iamincendium.com/github-2163/mootools-1.4.1.htm\nhttp://iamincendium.com/github-2163/mootools-1.4.2.htm\nRefresh the page and nothing happens. Click the button (which has an event handler assigned to it) and then reload and IE 7 will crash on the 1.4.2 page, but not 1.4.1.\n. Also wanted to add that commenting out line 742 in Element.js seems to stop IE from crashing.\nhttp://iamincendium.com/github-2163/mootools-1.4.2-working.htm\n. Here is exactly how I was able to reproduce the crash:\n1) Close all running instances of IE7\n2) Open IE7 and pull up http://iamincendium.com/github-2163/mootools-1.4.2.htm immediately (I think if you pull up a page with a working version of MooTools first this will cause the issue not to happen)\n3) Hit Ctrl+R to reload page\n4) Click button (hello should change to world)\n5) Hit Ctrl+R again\n6) IE7 crashes\nApplying the patch you mentioned seems to have fixed the issue (IE7 no longer crashes using the steps above on http://iamincendium.com/github-2163/mootools-1.4.2.htm).\n. @ibolmo Thanks for the fix, glad to see I can keep MooTools up-to-date. IE seems to be pretty spotty about whether or not it likes to be buggy. I'll look forward to the day when the only version of IE I have to support is 9 and up. I can only hope I don't run into any customer issues that involve selectively installed Windows updates.\nFWIW, I was able to reproduce this in a relatively fresh VirtualBox VM running a fully patched XP SP3 Pro, with IE fully patched (as of the 12/13 patch Tuesday) and all of the optional .NET updates. \n@isfalse Yep, it does.\n. @ibolmo It looks like using @isfalse's test page crashes my IE installation as well. Here are the steps I took to reproduce it:\n1) Close all running instances of IE7\n2) Open IE7 and disable all addons\n3) Close all running instances of IE7\n4) Open http://www.apixelife.com/github/2163/mootools-core-1.4.2.html\n5) Refresh page using Ctrl+R\n6) IE7 crashes\nI peeked at his mootools.js file and it looks like he patched it OK. Perhaps there is some attribute that IE doesn't like and crashes when it tries to clear it?\n. I unfortunately can't share my current VM, but once I get home tonight, I'll see if I can get it to reproduce on the official IE7 Virtual PC test image.\n. Interestingly enough, the issue didn't pop up in the official XP IE6/7 VM until after I installed one of the .NET framework updates. Without .NET, IE7 ran great with no crashes on any of the pages that caused issues on my development setup.\n@ibolmo Before I try to upload a ~4GB hard disk image to my server, could you try fully patching your Windows VM (with all of the .NET frameworks and patches) and see if you are able to reproduce the issue after the fact?\n. Looks like it's working on my end. Tried it using both test cases that were failing for me and they both work now. Awesome job!\n. Also able to reproduce this in the Firefox (9.0) beta channel build. A lot (but not all) of the symbol keys seem to be incorrect.\n1. US Keyboard\n2. Windows 7 Professional SP1\n. Working great now. Thanks for the quick turnaround.\n. ",
    "dmethvin": "@isfalse, open IE and go to your crashing test page, then select Tools, Manage Add-Ons, Enable or Disable Add-Ons. Make sure \"Add-ons currently loaded in Internet Explorer\" is selected. What do you have there? This is my list: http://gyazo.com/5ef81e147f0f0cd5f8b24b5c9c281476\nIf you have other plugins there they may be causing the crash. Try disabling them one at a time.\n. @isfalse, open IE and go to your crashing test page, then select Tools, Manage Add-Ons, Enable or Disable Add-Ons. Make sure \"Add-ons currently loaded in Internet Explorer\" is selected. What do you have there? This is my list: http://gyazo.com/5ef81e147f0f0cd5f8b24b5c9c281476\nIf you have other plugins there they may be causing the crash. Try disabling them one at a time.\n. ",
    "partheseas": "Good catch. +1\n. Good catch. +1\n. ",
    "fanxiaolong": "\u4f60\u4eec\u4f1a\u4e2d\u6587\u5417\uff1f\n. \u4f60\u4eec\u4f1a\u4e2d\u6587\u5417\uff1f\n. ",
    "tom-field": "\u6211\u4f1a. \u6211\u4f1a. ",
    "gpbmike": "\nUS keyboard\nOS X 10.7.2\n. 1. US keyboard\nOS X 10.7.2\n. \n",
    "marcj": "Ok, thank you very much guys.\n. Thanks for this detailed answer.\n. Ok, I didn't know this bug in IE, but I've read now many blog posts and from official microsoft resources about this terrible memory leak.\nSummary of this is now, that there is a memory leak* (not cross-page) in all browser through the current implementation of the IE memory leak workaround.\nShouldn't we call the code for this workaround only in IE 6+7? Because storage and collected is only for IE, other brothers does not need this temporary storage. Quite contrary since this workaround deactivates the whole GC for elements with events attached through mootools's addEvent. I'm working on a heavy GUI interface based on mootools and there are a lot of elements with events (which can't be killed beside a explicit destroycall which isn't always possible).\n*memory leak example: http://jsfiddle.net/tACJ9/\nMemory usage: http://masrv.com/mootools-memory-leak.png\nIf we implement the workaround only for IE, there should not be any bad side effects, beside the (very positiv) fact, that the GC would work again for browsers without this bug.\n. I believe it makes no sense to work around a selfmade resolvable bug, don't you think?\n. Well, because all well working javascript engines can do it. It makes the undocumented need of calling destroy and therefore the explicit saving of all references unnecessary.\nI'm a bit confused why this fix (not the pull request, but my suggestion in the comment) should be a problem. The normal behavior (in of course engines beside IE 6-7) is that the GC removes the element correctly when it has been removed from DOM as well as all references to it - also after adding events with circular references.\nCurrent mootools implementation is of course a bugfix for the IE memory leak, since it is possible to remove the leak by calling destroy, but it brings another memory leak for all browsers instead with it if you don't fire destroy (which of course is often the case, simply because its not the default behavior and not noted in the documentation at addEvent).\nSo, what speaks against the suggestion, that the fix for IE memory leak should only be for IE? You can add in the documentation at addEvent In Internet Explorer you have to calldestroyto prevent memory leaks or thinks like that. I believe it makes no sense to force all devs now to use destroy in all engines only because the dying Internet Explorer 6-7 has the bug. (idk whether ie8 has it too)\nIf you really wanna do this this way, you really should write in the documentation at addEvent that one has to call destroy or  removeEvent explicit to prevent heavy memory leaks. I didn't know it, since I believed it's not necessary as it is in well working engines. Therefore I haven't used the destroy() very often. And now? Other peoples still don't know, that they have to use destroy explicit to really remove it from the memory, against the standard.\n. Great. Can we do this for Element.store as well?\n. @Delapouite +1\n. > So the question is: do we have any legitimate reasons for why somebody\n\nwould want to put IE11 in the same bag as old IE?\n\nThat is the wrong question. The question is: why on earth should IE11 get a new option? Only because they changed their user agent? Nah.\nIE made always a progress, from IE6 to 7, 7 to 8 etc where it got new features/where it became more and more html standard compatible. Only because they made a bigger step in IE11 shouldn't mean they are not a IE anymore. What is in 6 years when IE12, IE13 is there? Is IE11 then still .modernie? That doesn't make sense.\nThe purpose of Browser.ie is to detect if the user uses Internet Explorer. Not more. If they use it for feature detection then its their fault. They should knew better, that maybe sometimes a IE is released with more features.\nI also don't see why Option 3 is breaking change? From IE6 to IE 7 mootools hasn't introduced a .modernie, same with version 8, although IE got new features. Why should IE11 now get a new option? Makes no sense to me.\nI would change absolutely nothing. Just make Browser.ie=true for all IE and all are happy.\n. Ok, thank you very much guys.\n. Thanks for this detailed answer.\n. Ok, I didn't know this bug in IE, but I've read now many blog posts and from official microsoft resources about this terrible memory leak.\nSummary of this is now, that there is a memory leak* (not cross-page) in all browser through the current implementation of the IE memory leak workaround.\nShouldn't we call the code for this workaround only in IE 6+7? Because storage and collected is only for IE, other brothers does not need this temporary storage. Quite contrary since this workaround deactivates the whole GC for elements with events attached through mootools's addEvent. I'm working on a heavy GUI interface based on mootools and there are a lot of elements with events (which can't be killed beside a explicit destroycall which isn't always possible).\n*memory leak example: http://jsfiddle.net/tACJ9/\nMemory usage: http://masrv.com/mootools-memory-leak.png\nIf we implement the workaround only for IE, there should not be any bad side effects, beside the (very positiv) fact, that the GC would work again for browsers without this bug.\n. I believe it makes no sense to work around a selfmade resolvable bug, don't you think?\n. Well, because all well working javascript engines can do it. It makes the undocumented need of calling destroy and therefore the explicit saving of all references unnecessary.\nI'm a bit confused why this fix (not the pull request, but my suggestion in the comment) should be a problem. The normal behavior (in of course engines beside IE 6-7) is that the GC removes the element correctly when it has been removed from DOM as well as all references to it - also after adding events with circular references.\nCurrent mootools implementation is of course a bugfix for the IE memory leak, since it is possible to remove the leak by calling destroy, but it brings another memory leak for all browsers instead with it if you don't fire destroy (which of course is often the case, simply because its not the default behavior and not noted in the documentation at addEvent).\nSo, what speaks against the suggestion, that the fix for IE memory leak should only be for IE? You can add in the documentation at addEvent In Internet Explorer you have to calldestroyto prevent memory leaks or thinks like that. I believe it makes no sense to force all devs now to use destroy in all engines only because the dying Internet Explorer 6-7 has the bug. (idk whether ie8 has it too)\nIf you really wanna do this this way, you really should write in the documentation at addEvent that one has to call destroy or  removeEvent explicit to prevent heavy memory leaks. I didn't know it, since I believed it's not necessary as it is in well working engines. Therefore I haven't used the destroy() very often. And now? Other peoples still don't know, that they have to use destroy explicit to really remove it from the memory, against the standard.\n. Great. Can we do this for Element.store as well?\n. @Delapouite +1\n. > So the question is: do we have any legitimate reasons for why somebody\n\nwould want to put IE11 in the same bag as old IE?\n\nThat is the wrong question. The question is: why on earth should IE11 get a new option? Only because they changed their user agent? Nah.\nIE made always a progress, from IE6 to 7, 7 to 8 etc where it got new features/where it became more and more html standard compatible. Only because they made a bigger step in IE11 shouldn't mean they are not a IE anymore. What is in 6 years when IE12, IE13 is there? Is IE11 then still .modernie? That doesn't make sense.\nThe purpose of Browser.ie is to detect if the user uses Internet Explorer. Not more. If they use it for feature detection then its their fault. They should knew better, that maybe sometimes a IE is released with more features.\nI also don't see why Option 3 is breaking change? From IE6 to IE 7 mootools hasn't introduced a .modernie, same with version 8, although IE got new features. Why should IE11 now get a new option? Makes no sense to me.\nI would change absolutely nothing. Just make Browser.ie=true for all IE and all are happy.\n. ",
    "liviathan": "May be this function can be renamed !\n. Sorry, I forgot to mention that the error is not in my code, because I do not use this feature. Mootools is using it several times in his code, and that is where the errors come\n. @ibolmo I will try to reproduce the problem but it is long since I work more on this project\n. May be this function can be renamed !\n. Sorry, I forgot to mention that the error is not in my code, because I do not use this feature. Mootools is using it several times in his code, and that is where the errors come\n. @ibolmo I will try to reproduce the problem but it is long since I work more on this project\n. ",
    "afoeder": "Absolutely +1 from me. Will this go into master?\n. Just to bring in another opinion: I'm totally giving +2 to this behavior. It's nothing special, it's a very helpfpul method to allow deep setting properties. The fact that setting some super property will erase its former descendants is nothing than just what is to be expected and the developer using this deep setting just has to be aware of this.\nIf the developer has to be in doubt because of loading order etc., he has to check whether the intended chain is present or not.\nYou could argue whether to allow only setting properties that used to be undefined at the very last end; but that is totally over the top IMHO. We're still talking about a programming language and not a tool-that-magically-has-to-care-about-every-imaginable-usecase-on-its-own.\n. at least as the very initial comments looked that promising...\n. hehe yaye @digitarald that extinguished the discussion ;-)\nBut I agree fully on what you say: create a Feature issue, then \"solve\" this issue with code work. So one can additionally say: \"Each commit has a corresponding Issue\", and vice versa.\nSince github with its forking paradigm has not such a nice review system compared to Gerrit for example, I also like the idea to code on a feature branch named after the issue.\nAnd again; at the end there should be only one single commit; if necessary, grewn up with --amend commits. This single commit could be merged (pulled) then into the master.\n. can confirm in Chrome (17.0.963.56 m); @ IR9 even worser with staying the first alert() while the three seconds.\n. Absolutely +1 from me. Will this go into master?\n. Just to bring in another opinion: I'm totally giving +2 to this behavior. It's nothing special, it's a very helpfpul method to allow deep setting properties. The fact that setting some super property will erase its former descendants is nothing than just what is to be expected and the developer using this deep setting just has to be aware of this.\nIf the developer has to be in doubt because of loading order etc., he has to check whether the intended chain is present or not.\nYou could argue whether to allow only setting properties that used to be undefined at the very last end; but that is totally over the top IMHO. We're still talking about a programming language and not a tool-that-magically-has-to-care-about-every-imaginable-usecase-on-its-own.\n. at least as the very initial comments looked that promising...\n. hehe yaye @digitarald that extinguished the discussion ;-)\nBut I agree fully on what you say: create a Feature issue, then \"solve\" this issue with code work. So one can additionally say: \"Each commit has a corresponding Issue\", and vice versa.\nSince github with its forking paradigm has not such a nice review system compared to Gerrit for example, I also like the idea to code on a feature branch named after the issue.\nAnd again; at the end there should be only one single commit; if necessary, grewn up with --amend commits. This single commit could be merged (pulled) then into the master.\n. can confirm in Chrome (17.0.963.56 m); @ IR9 even worser with staying the first alert() while the three seconds.\n. ",
    "upsolution": "Will this nice thing be implemented ever? :)\n. Guys, I really love MooTools! And I actually know that the power of open source is in cohesion of team.\nSo let's think and talk in a constructive way, about the solution, not about guilt and not about past problems.\n. @cpojer, sure!\nSo let me specify, what actually we need in MooTools More?\n1. Move Object.getFromPath to Object.get (with docs)\n2. Add Object.set (based upon my past commit)\n3. Add docs for Object.set\n4. Overload String.substitude to provide deep substitution, like this (with docs)\njavascript\n'{a.b.c}'.substitute({a: {b: {c: 1}}});\nEverything is correct? :)\n. @cpojer, @csuwldcat How about implementing Lean Production in MooTools? :)\nReally!\nWe can define interaction processes, we can implement canban board (for example trello.com), we can make the whole process more clear and easy. Actually I agree that current commit approval process is quite tiresome.\nActually, I can do the most if everyone agrees this is a good idea.\nSo what do you think?\n. @csuwldcat I'm not going to take your code. If you have the solution, I will be glad if you commit it yourself. As I said before, our power is in our unity.\n@cpojer However, think about implementing Lean Production tools into MooTools development process. We can make it more powerful, more effective and transparent. If interested, let me know.\n. +1\nSimply\nreturn this[this.hasClass(className) ? 'removeClass' : 'addClass'](className);\n. Connected issues:\nhttps://github.com/mootools/mootools-more/issues/1125\nhttps://github.com/mootools/mootools-core/issues/2364\n. Connected issues:\nhttps://github.com/mootools/mootools-more/issues/1125\nhttps://github.com/mootools/mootools-core/issues/2325\n. Will this nice thing be implemented ever? :)\n. Guys, I really love MooTools! And I actually know that the power of open source is in cohesion of team.\nSo let's think and talk in a constructive way, about the solution, not about guilt and not about past problems.\n. @cpojer, sure!\nSo let me specify, what actually we need in MooTools More?\n1. Move Object.getFromPath to Object.get (with docs)\n2. Add Object.set (based upon my past commit)\n3. Add docs for Object.set\n4. Overload String.substitude to provide deep substitution, like this (with docs)\njavascript\n'{a.b.c}'.substitute({a: {b: {c: 1}}});\nEverything is correct? :)\n. @cpojer, @csuwldcat How about implementing Lean Production in MooTools? :)\nReally!\nWe can define interaction processes, we can implement canban board (for example trello.com), we can make the whole process more clear and easy. Actually I agree that current commit approval process is quite tiresome.\nActually, I can do the most if everyone agrees this is a good idea.\nSo what do you think?\n. @csuwldcat I'm not going to take your code. If you have the solution, I will be glad if you commit it yourself. As I said before, our power is in our unity.\n@cpojer However, think about implementing Lean Production tools into MooTools development process. We can make it more powerful, more effective and transparent. If interested, let me know.\n. +1\nSimply\nreturn this[this.hasClass(className) ? 'removeClass' : 'addClass'](className);\n. Connected issues:\nhttps://github.com/mootools/mootools-more/issues/1125\nhttps://github.com/mootools/mootools-core/issues/2364\n. Connected issues:\nhttps://github.com/mootools/mootools-more/issues/1125\nhttps://github.com/mootools/mootools-core/issues/2325\n. ",
    "jiggliemon": "js\nvar something = {\n  name: 'Chase'\n}\nObject.set(something,'name.last','Wilson')\nObject.set(something,'name','Whoops!')\nconsole.log(Object.get(something,'name.last')) // undefined\n. I understand that it's expected and explicit.  \nHowever in the dev environment those two lines won't be together, and you could easily blow out siblings and children depending the order in which you assigned the properties. (possibly in separate files or a latent callback)\nA fastidious developer inside a tight ship wouldn't have to big of an issue keeping things straight.\nI've not been on one of those ships, and I'm not that fastidious. \n. Also your example would more realistically look like this:\njs\nvar foo = { bar: 'Chase' };\nfoo.bar.last: 'Wilson';\nfoo.bar = 'Whoops!';\nconsole.log(foo.bar.last);\nWhich would produce an error early, and at the explicit location.\n\nIm not saying I have a solution for this pattern either.  Just pointing out some problems I've run into in the past when I implemented something similar on an internal library.\nI defaulted to a flat structure:\n``` js\nvar foo = {}\nfoo['bar'] = 'Chase'\nfoo['bar.last'] = 'Wilson'\nfoo['bar'] = 'Whoops!'\nconsole.log(foo['bar']) // Whoops!\nconsole.log(foo['bar.last']) // Wilson\n```\nSince I was using it as a simple k/v data store I wasn't looking to retain the data as a native object.  And I justified it to myself as a better solution as I could easily export a native object if I needed, based on the keys (which I haven't needed yet).\n. \n. Confirmed.\nI did a similar example && It did as @jdalton describes\nhttp://jsfiddle.net/Beaf6/1/\n. @DimitarChristoff Woops! Well it works just the same:\nhttp://jsfiddle.net/Beaf6/2/ && http://jsfiddle.net/Beaf6/3/\n. +1\n. js\nvar something = {\n  name: 'Chase'\n}\nObject.set(something,'name.last','Wilson')\nObject.set(something,'name','Whoops!')\nconsole.log(Object.get(something,'name.last')) // undefined\n. I understand that it's expected and explicit.  \nHowever in the dev environment those two lines won't be together, and you could easily blow out siblings and children depending the order in which you assigned the properties. (possibly in separate files or a latent callback)\nA fastidious developer inside a tight ship wouldn't have to big of an issue keeping things straight.\nI've not been on one of those ships, and I'm not that fastidious. \n. Also your example would more realistically look like this:\njs\nvar foo = { bar: 'Chase' };\nfoo.bar.last: 'Wilson';\nfoo.bar = 'Whoops!';\nconsole.log(foo.bar.last);\nWhich would produce an error early, and at the explicit location.\n\nIm not saying I have a solution for this pattern either.  Just pointing out some problems I've run into in the past when I implemented something similar on an internal library.\nI defaulted to a flat structure:\n``` js\nvar foo = {}\nfoo['bar'] = 'Chase'\nfoo['bar.last'] = 'Wilson'\nfoo['bar'] = 'Whoops!'\nconsole.log(foo['bar']) // Whoops!\nconsole.log(foo['bar.last']) // Wilson\n```\nSince I was using it as a simple k/v data store I wasn't looking to retain the data as a native object.  And I justified it to myself as a better solution as I could easily export a native object if I needed, based on the keys (which I haven't needed yet).\n. \n. Confirmed.\nI did a similar example && It did as @jdalton describes\nhttp://jsfiddle.net/Beaf6/1/\n. @DimitarChristoff Woops! Well it works just the same:\nhttp://jsfiddle.net/Beaf6/2/ && http://jsfiddle.net/Beaf6/3/\n. +1\n. ",
    "eerne": "Please check how other frameworks have implemented this\nhttp://dojotoolkit.org/reference-guide/1.7/dojo/setObject.html\nhttp://dojotoolkit.org/reference-guide/1.7/dojo/getObject.html\nhttp://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/_base/object.js\n. Please check how other frameworks have implemented this\nhttp://dojotoolkit.org/reference-guide/1.7/dojo/setObject.html\nhttp://dojotoolkit.org/reference-guide/1.7/dojo/getObject.html\nhttp://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/_base/object.js\n. ",
    "MrPrime": "css\n    #demo {\n            width: 8em;\n            height: 7em;\n            margin: 1em 0 0 2em;\n            border: 0.1em solid #dcdcdc;\n            background: #acacac;\n        }\nhtml\n    <div id=\"demo\">\n    </div>\n``` javascript\nfunction getStyle(el, prop) {\n            var rt = null;\n            if(window.getComputedStyle) {\n                rt = window.getComputedStyle(el, null).getPropertyValue(prop);\n            } else {\n                var camelProp = prop.replace(/-\\D/g, function(match){\n                    return match.charAt(1).toUpperCase();\n                });\n                rt = el.currentStyle[camelProp];\n            }\n            return rt;\n        }\n    // use pure javascript\n    // in IE6,7,8 it return 1em, in IE9 and other standard browsers return 13px;\n    console.log(getStyle($('#demo')[0], 'margin-top'));\n\n    // use mootools getStyle mothed\n    // in IE6,7,8 it return 1em, in IE9 and other standard browsers return 13px;\n    console.log($('demo').getStyle('margin-top'));\n\n    // use jquery css method\n    // jquery do the unit conversion in all browsers under the hook\n    console.log($('#demo').css('margin-top'));  // 13px\n\n```\nso, I think the demo can make the issue clear\n. I hope mootools can help developer do the conversion, that will be quite useful for calculating element's dimension\n. actually, what I want is to make old IE versions(6, 7, 8) return the same value just as other standard browsers do\n. personally, I agree with the idea, Fx.cancel() should clear the following animation steps. in jquery, it provides a method called \"stop\" which take two arguments for stopping animation. but we can do something as follows, I guess:\njavascript\n// if jumpToEnd is true, then just let the element jump to the end of its animation.\n// if jumpToEnd is not provided or false, do nothing but stop the animation.\nFx.cancel(/*jumpToEnd type:boolean*/);\nwhat do you say, guys?\n. great news, It's better to provide has method for Element. Then I just went through the source code of  getProperty method, I did a little change as follows.\n``` javascript\ngetProperty: function(name){\n    var getter = propertyGetters[name.toLowerCase()];\n    if (getter) return getter(this);\nreturn Slick.hasAttribute(this, name) ? \n        Slick.getAttribute(this, name) : null;\n\n/* var result = Slick.getAttribute(this, name);\nreturn (!result && !Slick.hasAttribute(this, name)) ? null : result; */\n\n}\n```\napparently, if result is an empty string, !result will be converted to true, it will always return null, and another thing is that why we try to get the value of attribute first, then check whether it exists ?So I did that small change. developer can use === or !== to check whether the attribute exists or not. \nhtml:\nhtml\n<div id=\"demo\" data-test>\njavascript:\njavascript\nif( $('demo').get('data-test') !== null) {\n  // then do something...\n}\nbut it seems not elegant, so providing has methed is much better.\n. css\n    #demo {\n            width: 8em;\n            height: 7em;\n            margin: 1em 0 0 2em;\n            border: 0.1em solid #dcdcdc;\n            background: #acacac;\n        }\nhtml\n    <div id=\"demo\">\n    </div>\n``` javascript\nfunction getStyle(el, prop) {\n            var rt = null;\n            if(window.getComputedStyle) {\n                rt = window.getComputedStyle(el, null).getPropertyValue(prop);\n            } else {\n                var camelProp = prop.replace(/-\\D/g, function(match){\n                    return match.charAt(1).toUpperCase();\n                });\n                rt = el.currentStyle[camelProp];\n            }\n            return rt;\n        }\n    // use pure javascript\n    // in IE6,7,8 it return 1em, in IE9 and other standard browsers return 13px;\n    console.log(getStyle($('#demo')[0], 'margin-top'));\n\n    // use mootools getStyle mothed\n    // in IE6,7,8 it return 1em, in IE9 and other standard browsers return 13px;\n    console.log($('demo').getStyle('margin-top'));\n\n    // use jquery css method\n    // jquery do the unit conversion in all browsers under the hook\n    console.log($('#demo').css('margin-top'));  // 13px\n\n```\nso, I think the demo can make the issue clear\n. I hope mootools can help developer do the conversion, that will be quite useful for calculating element's dimension\n. actually, what I want is to make old IE versions(6, 7, 8) return the same value just as other standard browsers do\n. personally, I agree with the idea, Fx.cancel() should clear the following animation steps. in jquery, it provides a method called \"stop\" which take two arguments for stopping animation. but we can do something as follows, I guess:\njavascript\n// if jumpToEnd is true, then just let the element jump to the end of its animation.\n// if jumpToEnd is not provided or false, do nothing but stop the animation.\nFx.cancel(/*jumpToEnd type:boolean*/);\nwhat do you say, guys?\n. great news, It's better to provide has method for Element. Then I just went through the source code of  getProperty method, I did a little change as follows.\n``` javascript\ngetProperty: function(name){\n    var getter = propertyGetters[name.toLowerCase()];\n    if (getter) return getter(this);\nreturn Slick.hasAttribute(this, name) ? \n        Slick.getAttribute(this, name) : null;\n\n/* var result = Slick.getAttribute(this, name);\nreturn (!result && !Slick.hasAttribute(this, name)) ? null : result; */\n\n}\n```\napparently, if result is an empty string, !result will be converted to true, it will always return null, and another thing is that why we try to get the value of attribute first, then check whether it exists ?So I did that small change. developer can use === or !== to check whether the attribute exists or not. \nhtml:\nhtml\n<div id=\"demo\" data-test>\njavascript:\njavascript\nif( $('demo').get('data-test') !== null) {\n  // then do something...\n}\nbut it seems not elegant, so providing has methed is much better.\n. ",
    "yohanleafheart": "Currently getStyle() also does not return the right values for font-size in Opera, IE9 or lower if you set it to be relative. I made a jsfiddle as an example http://jsfiddle.net/DBcVx/6/. I agree with @MrPrime that we might want to use the jQuery approach in here, which I added to that jsfiddle as getPixelSize. I think we should add a check  at the end of getStyle that if the browser is Opera and the property font-size, or IE and the return value is not a pixel, it gets converted to a pixel. I think all of the major browsers convert to a px unless it is an inline style\n. Currently getStyle() also does not return the right values for font-size in Opera, IE9 or lower if you set it to be relative. I made a jsfiddle as an example http://jsfiddle.net/DBcVx/6/. I agree with @MrPrime that we might want to use the jQuery approach in here, which I added to that jsfiddle as getPixelSize. I think we should add a check  at the end of getStyle that if the browser is Opera and the property font-size, or IE and the return value is not a pixel, it gets converted to a pixel. I think all of the major browsers convert to a px unless it is an inline style\n. ",
    "robjb": "Using mootools-core-1.4.5-full-nocompat, I'm seeing percentage results from $('someElementId').getComputedStyle('width') in IE9. Behavior is as expected (px only) in Chrome.\n. Using mootools-core-1.4.5-full-nocompat, I'm seeing percentage results from $('someElementId').getComputedStyle('width') in IE9. Behavior is as expected (px only) in Chrome.\n. ",
    "magicalhobo": "D'oh, you're right, it works perfectly.\n. It would be nice if the state were attached to the Event object, so we could use event.state instead of event.event.state.\n. Done :)\nhttps://github.com/mootools/mootools-core/issues/2485\n. D'oh, you're right, it works perfectly.\n. It would be nice if the state were attached to the Event object, so we could use event.state instead of event.event.state.\n. Done :)\nhttps://github.com/mootools/mootools-core/issues/2485\n. ",
    "megawac": "I'm still having this issue with window.addEvent(\"beforeunload\", /*  */);. As far as I can tell the event is not even being called as event.preventDefault() has no effect.\nSee http://jsfiddle.net/995m8/3/\n. I was thinking about this and would it not be better to only call Array.from on arguments otherwise wrap args in an array. This way listeners will always be called with what an event is fired with.\ni.e.:\n```\nEvents.fireEvent = function (type, args, delay) {\n    type = removeOn(type);\n    var events = this.$events[type];\n    if (!events) return this;\nargs = Type.isArguments(args) ? args : [args];\n\nevents.each(function (fn) {\n    if (delay) fn.delay(delay, this, args);\n    else fn.apply(this, args);\n}, this);\nreturn this;\n\n}\n. Is this really necessary? I don't know if it's possible with whatever your using to run your tests but I know that `phantomjs` will allow you to set the user agent using `settings.userAgent`. Seems like a oddity to add a function just for testing to the repo.\n.\nvar my_string = '0232';\nvar my_regexp = new RegExp('^(0|([1-9]0-9?|0(.[0-9]|,[0-9]))[0-9])$', 'i');\nmy_string.match(my_regexp) // => [\"0232\", \"0232\", \"023\", undefined, \"23\"]\nmy_string.test(my_regexp)    // => true\nmy_regexp.test(my_string)    // => true\nmy_regexp.exec(my_string)  // => [\"0232\", \"0232\", \"023\", undefined, \"23\"]\n```\nAs expected.\n. You can also just delegate to splice?\njs\nvar t = this.split(\"\");\nt.splice(pos, rem, ins);\nreturn t.join(\"\");\n. :+1: but why can't you guys implement all these methods by way of Object.keys which will also be faster in browsers that support keys natively\n. I mean Mootools polyfills Object.keys ~~that also has this fix no~~?\nLooks like this fix isn't being applied to keys: https://github.com/mootools/mootools-core/blob/master/Source/Types/Object.js#L63-69\n. @SergioCrisostomo I would say it should be the other way around (thats how most other frameworks otu there are doing it). Having keys be the root fix for the non enumerable bug in ie also lets other browsers benefit from a faster implementation of all the object methods as native keys is faster than for .. in.\nI would argue all the object methods (each, map, filter, etc) that iterate own properties should be using keys, and the enumerable fix where keys doesn';t\n. I'm still having this issue with window.addEvent(\"beforeunload\", /*  */);. As far as I can tell the event is not even being called as event.preventDefault() has no effect.\nSee http://jsfiddle.net/995m8/3/\n. I was thinking about this and would it not be better to only call Array.from on arguments otherwise wrap args in an array. This way listeners will always be called with what an event is fired with.\ni.e.:\n```\nEvents.fireEvent = function (type, args, delay) {\n    type = removeOn(type);\n    var events = this.$events[type];\n    if (!events) return this;\nargs = Type.isArguments(args) ? args : [args];\n\nevents.each(function (fn) {\n    if (delay) fn.delay(delay, this, args);\n    else fn.apply(this, args);\n}, this);\nreturn this;\n\n}\n. Is this really necessary? I don't know if it's possible with whatever your using to run your tests but I know that `phantomjs` will allow you to set the user agent using `settings.userAgent`. Seems like a oddity to add a function just for testing to the repo.\n.\nvar my_string = '0232';\nvar my_regexp = new RegExp('^(0|([1-9]0-9?|0(.[0-9]|,[0-9]))[0-9])$', 'i');\nmy_string.match(my_regexp) // => [\"0232\", \"0232\", \"023\", undefined, \"23\"]\nmy_string.test(my_regexp)    // => true\nmy_regexp.test(my_string)    // => true\nmy_regexp.exec(my_string)  // => [\"0232\", \"0232\", \"023\", undefined, \"23\"]\n```\nAs expected.\n. You can also just delegate to splice?\njs\nvar t = this.split(\"\");\nt.splice(pos, rem, ins);\nreturn t.join(\"\");\n. :+1: but why can't you guys implement all these methods by way of Object.keys which will also be faster in browsers that support keys natively\n. I mean Mootools polyfills Object.keys ~~that also has this fix no~~?\nLooks like this fix isn't being applied to keys: https://github.com/mootools/mootools-core/blob/master/Source/Types/Object.js#L63-69\n. @SergioCrisostomo I would say it should be the other way around (thats how most other frameworks otu there are doing it). Having keys be the root fix for the non enumerable bug in ie also lets other browsers benefit from a faster implementation of all the object methods as native keys is faster than for .. in.\nI would argue all the object methods (each, map, filter, etc) that iterate own properties should be using keys, and the enumerable fix where keys doesn';t\n. ",
    "RiZKiT": "Yes, and a friend send me his user agent string from his Galaxy Nexus, both result in Browser.version == 4.\nMozilla/5.0 (Linux; U; Android 4.0.2; de-de; Galaxy Nexus/ICL53F) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30\nMy problem is, I want to know if i have an Android > 2 browser, because these support position:fixed. For now I check the navigator.userAgent for \"Android 2\". Maybe i have to deal with it until there is a bulletproof solution to check for position:fixed ... in Modernizr.\n. Execute the following in Google Chrome, with a popup blocker enabled / disabled and watch the script console: \nhttp://jsfiddle.net/YgYL5/\nI used the first blocker in the chrome app store that i've found, named \"Better Pop Up Blocker\". I don't know which popup blocker our users have installed regularely, but that one seems to be quite common.\nI'm a bit lazy to write whole articles, but I already mentioned my logging solution in a Google+ thread  with other JavaScript debugging tips here: https://plus.google.com/104431949275766772757/posts/N1qwzwuAZd1\n. Alright, I looked at the source of the plugin and I agree with you, the plugin behaviour is too agressive. So i've send the developer an email.\n\nDear Eric Wong,\nby remote logging the script errors of our users, we found an error which is related to your popup blocker. Your plugin overwrites several functions (onScroll, prompt, alert and so on) with \"null\", resulting in an script error when these function get called.\nMy suggestion is, that you replace them with empty functions or throw an generic error like \"blocked by better popup blocker\". I'm kindly awaiting your reply.\nBest Regards,\nAicke Schulz \n\nWe can close that issue now or waiting until the reply.\n. Duplicate of 2284\n. This fixes \"from.slice is not a function\" for me. \nProblem occured when using ReMooz.close(), where a morph modifies coordinates and opacity.\n. I think that will not be implemented, but you can use a different approach, fire the event on a wrapper element (e.g. document.body) and set/submit the related element in the second parameter of fireEvent:\njavascript\n$(document.body).fireEvent('myEvent', element);\nThis way you can handle all myEvent's with one event handler:\njavascript\n$(document.body).addEvent('myEvent', function(element){\n  console.log(element);\n});\n. Maybe http://mootools.net/docs/core/Element/Element.Delegation will help you. I suggest you try to use this, a treeview seems to be a perfect example for that.\n. When you try my first suggestion again, no element/class have to know each other, because you send events to a parent container and attached to the events are parameters, even a function callback should be possible. \nI used that once to send events from tab content to tab handler and back. so the tabs and the tab handler  fired/captured events events to/from the container/parent element.\nim not sure if this helps:\nhttp://mootools.net/docs/core/Class/Class.Extras#Events\notherwise this should help, its heavy but mighty\n- http://code.keetology.com/company/\n- http://keetology.com/blog/2011/03/15/sondheim-meets-mootools\n- http://keetology.com/blog/2010/10/01/modules-and-callbacks-going-hollywood-with-mootools\n. I'm not sure but maybe you only have problems in IE with that?\n. Just made a fiddle for that, its reproducible: http://jsfiddle.net/a4HFD/\nBtw. fade('out') works as expected.\n. How about that solution? http://jsfiddle.net/RiZKiT/NAa92/1/\nEdit: Oh I see its already fixed in another pull request above, but still open?\n. Sorry, my bug ticket has so less information that i did'nt knew what the problem was, too. Today I was unable to find a problem, setting the border radius worked as expected.\nBut then I tried to read the border radius and that's the problem.\nI don't know what PR means, but i did a fiddle for that, see: http://jsfiddle.net/N8vM3/4/\nAnd it seems to be a firefox problem, only. Maybe it's a browser bug!?\n. $$('.mydiv').fireEvent('click:relay(.myelement)');\nWas introduced here: https://github.com/mootools/mootools-core/issues/2092\n. Yes, and a friend send me his user agent string from his Galaxy Nexus, both result in Browser.version == 4.\nMozilla/5.0 (Linux; U; Android 4.0.2; de-de; Galaxy Nexus/ICL53F) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30\nMy problem is, I want to know if i have an Android > 2 browser, because these support position:fixed. For now I check the navigator.userAgent for \"Android 2\". Maybe i have to deal with it until there is a bulletproof solution to check for position:fixed ... in Modernizr.\n. Execute the following in Google Chrome, with a popup blocker enabled / disabled and watch the script console: \nhttp://jsfiddle.net/YgYL5/\nI used the first blocker in the chrome app store that i've found, named \"Better Pop Up Blocker\". I don't know which popup blocker our users have installed regularely, but that one seems to be quite common.\nI'm a bit lazy to write whole articles, but I already mentioned my logging solution in a Google+ thread  with other JavaScript debugging tips here: https://plus.google.com/104431949275766772757/posts/N1qwzwuAZd1\n. Alright, I looked at the source of the plugin and I agree with you, the plugin behaviour is too agressive. So i've send the developer an email.\n\nDear Eric Wong,\nby remote logging the script errors of our users, we found an error which is related to your popup blocker. Your plugin overwrites several functions (onScroll, prompt, alert and so on) with \"null\", resulting in an script error when these function get called.\nMy suggestion is, that you replace them with empty functions or throw an generic error like \"blocked by better popup blocker\". I'm kindly awaiting your reply.\nBest Regards,\nAicke Schulz \n\nWe can close that issue now or waiting until the reply.\n. Duplicate of 2284\n. This fixes \"from.slice is not a function\" for me. \nProblem occured when using ReMooz.close(), where a morph modifies coordinates and opacity.\n. I think that will not be implemented, but you can use a different approach, fire the event on a wrapper element (e.g. document.body) and set/submit the related element in the second parameter of fireEvent:\njavascript\n$(document.body).fireEvent('myEvent', element);\nThis way you can handle all myEvent's with one event handler:\njavascript\n$(document.body).addEvent('myEvent', function(element){\n  console.log(element);\n});\n. Maybe http://mootools.net/docs/core/Element/Element.Delegation will help you. I suggest you try to use this, a treeview seems to be a perfect example for that.\n. When you try my first suggestion again, no element/class have to know each other, because you send events to a parent container and attached to the events are parameters, even a function callback should be possible. \nI used that once to send events from tab content to tab handler and back. so the tabs and the tab handler  fired/captured events events to/from the container/parent element.\nim not sure if this helps:\nhttp://mootools.net/docs/core/Class/Class.Extras#Events\notherwise this should help, its heavy but mighty\n- http://code.keetology.com/company/\n- http://keetology.com/blog/2011/03/15/sondheim-meets-mootools\n- http://keetology.com/blog/2010/10/01/modules-and-callbacks-going-hollywood-with-mootools\n. I'm not sure but maybe you only have problems in IE with that?\n. Just made a fiddle for that, its reproducible: http://jsfiddle.net/a4HFD/\nBtw. fade('out') works as expected.\n. How about that solution? http://jsfiddle.net/RiZKiT/NAa92/1/\nEdit: Oh I see its already fixed in another pull request above, but still open?\n. Sorry, my bug ticket has so less information that i did'nt knew what the problem was, too. Today I was unable to find a problem, setting the border radius worked as expected.\nBut then I tried to read the border radius and that's the problem.\nI don't know what PR means, but i did a fiddle for that, see: http://jsfiddle.net/N8vM3/4/\nAnd it seems to be a firefox problem, only. Maybe it's a browser bug!?\n. $$('.mydiv').fireEvent('click:relay(.myelement)');\nWas introduced here: https://github.com/mootools/mootools-core/issues/2092\n. ",
    "complynx": "Oh, it's my fault\n. Oh, it's my fault\n. ",
    "manuelflara": "As a side note, I use ExceptionHub.com to log JS errors and I'm quite happy with the service. If you wanted to do something similar you can just check their JS code and then create your own backend.\n. As a side note, I use ExceptionHub.com to log JS errors and I'm quite happy with the service. If you wanted to do something similar you can just check their JS code and then create your own backend.\n. ",
    "gik000": "this was right for me...\npop-up blocker \"block\" the page\n. this was right for me...\npop-up blocker \"block\" the page\n. ",
    "blessedone": "just wanted to mention that \"better popup blocker\" actually has a option to disable everything it does for this problem just go tot he settings and scroll down to \"Blocked Functions\"  then \nunckeck \"Automatically moving & resizing windows\"\nand ding fries are done!\nyou can unblock any of the blocked functions as its fully configurable ... dont hate on something you dont understand\ni <3 / love  Better popup blocker its meant to be as aggressive as you need it to be\nwhich is what i need most of the time\ni hope this helps everyone\n. just wanted to mention that \"better popup blocker\" actually has a option to disable everything it does for this problem just go tot he settings and scroll down to \"Blocked Functions\"  then \nunckeck \"Automatically moving & resizing windows\"\nand ding fries are done!\nyou can unblock any of the blocked functions as its fully configurable ... dont hate on something you dont understand\ni <3 / love  Better popup blocker its meant to be as aggressive as you need it to be\nwhich is what i need most of the time\ni hope this helps everyone\n. ",
    "theprawn": "Just ran into this issue myself\n. Just ran into this issue myself\n. ",
    "piotr-cz": "Besides normal prefix, there is DOM prerix and CSS prefix. I don't remeber the differences now :) but I came up with this:\n```\n(function(win, doc, und){\n    var prefixes = {\n        \"chrome\"        : 'Webkit',\n        \"safari\"        : 'Webkit',\n        \"konqueror\"     : 'Khtml',\n        \"firefox\"       : 'Moz',\n        \"ie\"            : 'ms',\n        \"opera\"         : 'O'\n    };\nvar domprefix       = (prefixes[win.Browser.name] || und);\nvar prefix          = (domprefix.toLowerCase() || und);\nvar cssprefix       = ('-' + prefix + '-' || und);\n\nBrowser.extend({\n    'prefix'        : prefix,\n    'domprefix'     : domprefix,\n    'cssprefix'     : cssprefix\n});\n\nreturn;\n\n})(window, document, undefined);\n```\n. @DimitarChristoff:\nThe thing is that one function does encode keys, while another doesn't. Check jsFiddle output:\nelement => queryString\n```\n$form.toQueryString()\n\nparams%5Blanguage%5D=en-GB&params%5Btimezone%5D=1\n```\n\nelement => object => queryString\n```\nObject.toQueryString( $form.toQueryString().parseQueryString() )\n\nparams[language]=en-GB&params[timezone]=1\n```\n. Besides normal prefix, there is DOM prerix and CSS prefix. I don't remeber the differences now :) but I came up with this:\n\n```\n(function(win, doc, und){\n    var prefixes = {\n        \"chrome\"        : 'Webkit',\n        \"safari\"        : 'Webkit',\n        \"konqueror\"     : 'Khtml',\n        \"firefox\"       : 'Moz',\n        \"ie\"            : 'ms',\n        \"opera\"         : 'O'\n    };\nvar domprefix       = (prefixes[win.Browser.name] || und);\nvar prefix          = (domprefix.toLowerCase() || und);\nvar cssprefix       = ('-' + prefix + '-' || und);\n\nBrowser.extend({\n    'prefix'        : prefix,\n    'domprefix'     : domprefix,\n    'cssprefix'     : cssprefix\n});\n\nreturn;\n\n})(window, document, undefined);\n```\n. @DimitarChristoff:\nThe thing is that one function does encode keys, while another doesn't. Check jsFiddle output:\nelement => queryString\n```\n$form.toQueryString()\n\nparams%5Blanguage%5D=en-GB&params%5Btimezone%5D=1\n```\n\nelement => object => queryString\n```\nObject.toQueryString( $form.toQueryString().parseQueryString() )\n\nparams[language]=en-GB&params[timezone]=1\n```\n. \n",
    "asteig": "I can tackle this one.\n. I'm going straight alphabetical on this one. Any objections?\n. I can tackle this one.\n. I'm going straight alphabetical on this one. Any objections?\n. ",
    "varyen": "This problem also exists in desktop webkits. When I use -webkit-transform with matrix for rotation, element.getPosition() returns different values in firefox and in chrome & safari.\n. This problem also exists in desktop webkits. When I use -webkit-transform with matrix for rotation, element.getPosition() returns different values in firefox and in chrome & safari.\n. ",
    "jeffchan": "Nevermind. https://github.com/mootools/mootools-core/issues/2057\n. Nevermind. https://github.com/mootools/mootools-core/issues/2057\n. ",
    "umphy": "Yep I'm saying it could be a bit clearer. This may apply to other\nsimilar methods that return collections; I haven't checked.\nI've never tried that on GitHub. May try later.\n. Yep I'm saying it could be a bit clearer. This may apply to other\nsimilar methods that return collections; I haven't checked.\nI've never tried that on GitHub. May try later.\n. ",
    "davidfoley": "Well.... I'm not so sure... \nWhat if I do a PUT, sending a JSON resource to a REST API- an appropriate response after that can actually be a 204 No Content, which by definition, must have no body, therefore there would be no JSON response. The code as it stands does not support that and similar (valid REST) scenarios, so I still think its an issue.\n. Hey guys, I get your perspectives on this. But I disagree. \nA JSON Request should not be limited strictly to the retrieval of JSON data, as in a GET and in some cases, from a  POST response. \nThe convenience of Request.JSON is also the encoding of objects for sending to the server and having the Content-Type set up for you. It is actually valid to have a JSON Request that sends JSON data, but does not expect JSON as the response. In terms of RPC, instead of REST, yes you would, but even then, the Request implementation deciding that a null JSON response is an error is to take too much ownership of the business logic- thats the servers job, or the client application's job, right? Request should be agnostic to business logic as its a generic library class. The Request should not carry the interpretation that a null JSON response is an error, when in fact, this is not always the case. \nHope you change your mind on this, even if it is a narrow point.\n. Well.... I'm not so sure... \nWhat if I do a PUT, sending a JSON resource to a REST API- an appropriate response after that can actually be a 204 No Content, which by definition, must have no body, therefore there would be no JSON response. The code as it stands does not support that and similar (valid REST) scenarios, so I still think its an issue.\n. Hey guys, I get your perspectives on this. But I disagree. \nA JSON Request should not be limited strictly to the retrieval of JSON data, as in a GET and in some cases, from a  POST response. \nThe convenience of Request.JSON is also the encoding of objects for sending to the server and having the Content-Type set up for you. It is actually valid to have a JSON Request that sends JSON data, but does not expect JSON as the response. In terms of RPC, instead of REST, yes you would, but even then, the Request implementation deciding that a null JSON response is an error is to take too much ownership of the business logic- thats the servers job, or the client application's job, right? Request should be agnostic to business logic as its a generic library class. The Request should not carry the interpretation that a null JSON response is an error, when in fact, this is not always the case. \nHope you change your mind on this, even if it is a narrow point.\n. ",
    "kpobococ": "So, I took GCheung55's code and added some more stuff to it. It is now a plugin on forge: http://mootools.net/forge/p/dataset\n. I am aware of the current way. I'm just saying that it is confusing and I honestly don't see why it has to be.\nAlso, please comment on the event propagation question.\n. So, I took GCheung55's code and added some more stuff to it. It is now a plugin on forge: http://mootools.net/forge/p/dataset\n. I am aware of the current way. I'm just saying that it is confusing and I honestly don't see why it has to be.\nAlso, please comment on the event propagation question.\n. ",
    "giddie": "I don't get what the problem is with this suggestion.  It seems to me that a meaningful error message that clarifies the high-level issue is pretty much by definition better than an obscure reference error further down the stack that takes hours in a debugger picking apart Mootools to discover is actually just a stupid load-order issue.\nSurely the point of Mootools is to make Javascript awesomer, and I can't think of any way awesome could be defined as breakage in an anonymous function when the developer tries to extend with an undefined class.  Surely this same thing will be an issue if the developer just mistypes a class name in the Extends property?\n. @cpojer I don't think you understand my problem.  In the situation I described, neither Ffx not Chrome picked up on my symbol being undefined, and I ended up with an obscure \"klass is undefined\" much further down the stack.  As @seanmonstar demonstrated, it was probably actually because the class was being assigned to an object property, instead of directly to a new object.  I didn't think to check for a distinction when I wrote my first post.\n@seanmonstar Those changes look like exactly what I was hoping for; nice one :)\n. I don't get what the problem is with this suggestion.  It seems to me that a meaningful error message that clarifies the high-level issue is pretty much by definition better than an obscure reference error further down the stack that takes hours in a debugger picking apart Mootools to discover is actually just a stupid load-order issue.\nSurely the point of Mootools is to make Javascript awesomer, and I can't think of any way awesome could be defined as breakage in an anonymous function when the developer tries to extend with an undefined class.  Surely this same thing will be an issue if the developer just mistypes a class name in the Extends property?\n. @cpojer I don't think you understand my problem.  In the situation I described, neither Ffx not Chrome picked up on my symbol being undefined, and I ended up with an obscure \"klass is undefined\" much further down the stack.  As @seanmonstar demonstrated, it was probably actually because the class was being assigned to an object property, instead of directly to a new object.  I didn't think to check for a distinction when I wrote my first post.\n@seanmonstar Those changes look like exactly what I was hoping for; nice one :)\n. ",
    "Qballinternet": "So it is normal that the body tag got the complete mootools source code in an $family attribute? and it seems that this is the issue with every element on the page.\nI got such a weird problem on the project i am currently working on. It seems that an entire table refuses to paint/render itself on the page. No errors though. I can set all the styles i want on the inserted table but noting works. When i inspect with ie9 in ie7 modus the table is there, the styles are set, but it does not render to the screen.\nthe reason i think it got something to do with this attribute thing is because i cant find any other weird things happen on the page. \nAnd something tells me that having the complete mootools source code put as an attribute on every element on the page does not make a page render better.\nany help would be greatly appreciated.\nIf this does not belong here; i just filed a request for joining the google group, and am currently waiting for acceptance.\n. When u use ie8 or ie9 and press F12 you open the console/script-panel from there you can 'inspect' the html. On the first tab you can also press a button to view the rendered html. at the moment i can't be more exact since i dont have a windows pc at hand.\nEDIT: Solved (dirty dirty) the ie7 bug by replacing a table with divs. The table was edited by mootools and refused to render to screen.\n. So it is normal that the body tag got the complete mootools source code in an $family attribute? and it seems that this is the issue with every element on the page.\nI got such a weird problem on the project i am currently working on. It seems that an entire table refuses to paint/render itself on the page. No errors though. I can set all the styles i want on the inserted table but noting works. When i inspect with ie9 in ie7 modus the table is there, the styles are set, but it does not render to the screen.\nthe reason i think it got something to do with this attribute thing is because i cant find any other weird things happen on the page. \nAnd something tells me that having the complete mootools source code put as an attribute on every element on the page does not make a page render better.\nany help would be greatly appreciated.\nIf this does not belong here; i just filed a request for joining the google group, and am currently waiting for acceptance.\n. When u use ie8 or ie9 and press F12 you open the console/script-panel from there you can 'inspect' the html. On the first tab you can also press a button to view the rendered html. at the moment i can't be more exact since i dont have a windows pc at hand.\nEDIT: Solved (dirty dirty) the ie7 bug by replacing a table with divs. The table was edited by mootools and refused to render to screen.\n. ",
    "thomasd": "This cannot work, as event delegation only looks for elements inside of elements where you call addEvent.\nExample:\nhttp://jsfiddle.net/Qd7fb/19/\nThis is desired behaviour. If you want to have side-wide delegation use\n    document.addEvent(\"click:relay(div.click)\", function(){});\nI hope this is understandable?!\n. This cannot work, as event delegation only looks for elements inside of elements where you call addEvent.\nExample:\nhttp://jsfiddle.net/Qd7fb/19/\nThis is desired behaviour. If you want to have side-wide delegation use\n    document.addEvent(\"click:relay(div.click)\", function(){});\nI hope this is understandable?!\n. ",
    "Miscellaneous": "Thanks, now its crystal clear\n. Thanks, now its crystal clear\n. ",
    "skuwamoto": "I just realized that this should be in the mootools-more bugbase and not the mootools-core bugbase. Closing it out.\n. I just realized that this should be in the mootools-more bugbase and not the mootools-core bugbase. Closing it out.\n. ",
    "Sartan4455": "Is master 1.4.4(sorry git noob).\nIs there a note of it being fixed, or just got fixed without a specific bug?\nIt really caught us pretty off guard.\n. Is master 1.4.4(sorry git noob).\nIs there a note of it being fixed, or just got fixed without a specific bug?\nIt really caught us pretty off guard.\n. ",
    "ilanle": "Source code for page to reproduce:\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"\nhttp://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n\n\n\n\n\n\n\nMake your own scavenger hunt\n\n\n\n\n\n\n\n\n\n\n\n body a {color:#A0C34B;}\nbody a, #rt-main-surround .rt-article-title, #rt-main-surround .title,</p>\n<h1>rt-showcase .title, #rt-showcase .showcase-title span, #rt-top .title,</h1>\n<h1>rt-header .title, #rt-feature .title {color:#A0C34B;}</h1>\n<p>div#maximenuck ul.maximenuck li.maximenuck &gt; a span.titreck {color:#FF412B\n!important;} div#maximenuck ul.maximenuck li.maximenuck &gt; span.separator\nspan.titreck {color:#FF412B !important;}div#maximenuck ul.maximenuck\nli.maximenuck &gt; a span.descck {color:#A399FF !important;} div#maximenuck\nul.maximenuck li.maximenuck &gt; span.separator span.descck {color:#A399FF\n!important;}div#maximenuck ul.maximenuck li.maximenuck &gt; a:hover\nspan.titreck {color:#FFF566 !important;} div#maximenuck ul.maximenuck\nli.maximenuck &gt; span.separator:hover span.titreck {color:#FFF566\n!important;}div#maximenuck ul.maximenuck li.maximenuck &gt; a:hover\nspan.descck {color:#FF7A95 !important;} div#maximenuck ul.maximenuck\nli.maximenuck &gt; span.separator:hover span.descck {color:#FF7A95 !important;}\n  \n\n\n\n\n\n\n\n\n\n\nwindow.addEvent('load', function() {\n                new JCaption('img.caption');\n            });\n            window.addEvent('domready', function() {\n                var modules = ['rt-block'];\n                var header = ['h3','h2','h1'];\n                GantryBuildSpans(modules, header);\n            });</p>\n<p>InputsExclusion.push('.content_vote')\nwindow.addEvent('domready', function() {\n});\nwindow.addEvent('load', function() {\n});</p>\n<p>window.addEvent('domready', function() {new\nDropdownMaxiMenu(document.getElement('div#maximenuck'),{mooTransition :\n'Quad',mooEase : 'easeOut',useOpacity : '1',dureeOut : 500,menuID :\n'maximenuck',testoverflow : '1',orientation : '0',style :\n'moomenu',opentype : 'slide',direction : 'normal',directionoffset1 :\n'30',directionoffset2 : '30',mooDuree : 500});});\nwindow.addEvent('domready', function() {new\nSlideList(document.getElement('div#maximenuck ul'),{fancyTransition :\n'Quad',fancyEase : 'easeOut',fancyDuree : 500});});\n  \nvar jfbcLogoutFacebook = false;\nvar jfbcBase = 'http://www.scavengerhunt.org/';\nvar jfbcReturnUrl = 'L2ZyZWUtc2NhdmVuZ2VyLWh1bnQtbGlzdC5odG1s';\nvar jfbcRequiredPermissions =\n'email,user_likes,user_interests,friends_likes,friends_interests';\n\n\n\n\n\n\n\n\n\n\n\nwindow.fbAsyncInit = function() {\nFB.init({appId: '262433700495575', status: true, cookie: true, xfbml: true,\noauth: true, channelUrl: '\nhttp://www.scavengerhunt.org/components/com_jfbconnect/assets/jfbcchannel.php'}\n);\n};\n(function(d){\n     var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}\n     js = d.createElement('script'); js.id = id; js.async = true;\n     js.src = \"//connect.facebook.net/en_GB/all.js\";\n     d.getElementsByTagName('head')[0].appendChild(js);\n   }(document));\n\n<div id=\"rt-header\">\n        <div class=\"rt-container\">\n            <div id=\"rt-header2\">\n                <div id=\"rt-header3\">\n                    <div id=\"rt-header4\">\n                        <div class=\"rt-grid-12 rt-alpha rt-omega\">\n            <div class=\"rt-block\">\n            <a href=\"/\" id=\"rt-logo\"></a>\n        </div>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n debut Maximenu CK, par cedric keiflin sur\nhttp://www.joomlack.fr \n\n\n\n\nScavenger hunt\nlists\n\nMake your own scavenger hunt\n\n\n\n\n\n\n fin maximenuCK \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nno data\nyet\n\n\n\n\n\n\n                                                                </div>\n                            <div class=\"rt-grid-5 \">\n            <div id=\"rt-sidebar-c\">\n                                    <div class=\"rt-block\">\n            <div class=\"module-surround\">\n                                                        <div\n\nclass=\"module-content\">\n                        \n\n\n\nwindow.addEvent('domready', function(){\n    $('search').addEvent('click', function(e) {\n        e = new Event(e).stop();\n        var myitems= document.getElementById('myitems');\n        myitems.innerHTML=\"<span style='font-size:20px'><br/><br/>Search\nstarted.<br/><br/>Waiting for results...</span>\";\n        new Request({\n            url: 'http://www.scavengerhunt.org/scripts/index.php',\n            //url: 'http://www.scavengerhunt.org/scripts/search-results.php\n',\n            onSuccess: function(data) {\n                    var myitems= document.getElementById('myitems');\n                    myitems.innerHTML=data;\n                    add_drag_events();\n            }</p>\n<p>}).post('qs='+document.getElementById('qs').value+'&amp;tmpl=component&amp;func=search-results');\n    });\n});</p>\n<p>\n\n\n\n\n\n\n\n\n\n\n\n \n\n\n```\n            \n\n            <div class=\"clear\"></div>\n        </div>\n    </div>\n                        </div>\n<div class=\"clear\"></div>\n                                            </body>\n\n```\n\nsource of my javascript file:\nfunction save_page_to_file()\n{\nvar page = document.getElementById('sh-background');\n            var save_data=\nescape(document.getElementById('game-page').innerHTML);\n            var session_id=document.getElementById('session_id').value;\n            new Request({\n            url: 'http://www.scavengerhunt.org/scripts/index.php',\n            onSuccess: function(data) {\n            var data2= unescape(data);\n                var response_div= document.getElementById('save-result');\n                response_div.innerHTML=data2;\n            }\n}).post('tmpl=component&func=save-page&data='+save_data+'&session_id='+session_id);\n}\nfunction get_page_from_file()\n{            var session_id=document.getElementById('session_id').value;\n            if (document.getElementById('game-page').innerHTML!='')\n            {\n            return;\n            }\n            new Request({\n            url: 'http://www.scavengerhunt.org/scripts/index.php',\n            onSuccess: function(data) {\n            var data2= unescape(data);\n                var game_div= document.getElementById('game-page');\n                game_div.innerHTML=data2;\n            }\n        }).post('tmpl=component&func=get-page&session_id='+session_id);\nvar page = document.getElementById('sh-background');\n            var save_data=\nescape(document.getElementById('game-page').innerHTML);\n            var session_id=document.getElementById('session_id').value;\n}\nfunction add_drag_events()\n{\n    var clipart_width = 45;\n    var clipart_height = 45;\n    $$('.item').addEvent('mousedown', function(event){\n        event.stop();\n        // this refers to the element with the .item class\n        var shirt = this;\n        var clone =\nshirt.clone().setStyles(shirt.getCoordinates()).setStyles({\n            opacity: 0.4,\n            position: 'absolute',\n        }).inject(document.body);\n```\n    var drag = new Drag.Move(clone, {\n        droppables: $$('.carti'),\n    onDrop: function(dragging, cart){\n\n        dragging.destroy();\n\n        if (cart !== null){\n           if ( cart.hasChildNodes() )\n            {\n                while ( cart.childNodes.length >= 1 )\n                {\n                    cart.removeChild( cart.firstChild );\n                }\n            }\n            cart.style.backgroundImage =\n\n```\n\"url('../images/general/frame3.png')\";\n                    var oImg=document.createElement(\"img\");\n                    oImg.setAttribute('src',\nshirt.children[0].getAttribute('src'));\n                    oImg.setAttribute('class','itemi');\nif(shirt.children[0].getAttribute('width')>\nshirt.children[0].getAttribute('height')){\n                    //alert('width\n'+shirt.children[0].getAttribute('width')+'  '+\nshirt.children[0].getAttribute('height'));\n                        oImg.setAttribute('width',clipart_width+'px');\n                        oImg.setAttribute('height',clipart_height+'px');\n                    } else {\n                    //alert('height\n'+shirt.children[0].getAttribute('width')+'  '+\nshirt.children[0].getAttribute('height'));\n                        oImg.setAttribute('height',clipart_width+'px');\n                        oImg.setAttribute('width',clipart_height+'px');\n                    }\ntry{\n                cart.appendChild(oImg);\n                }catch(n){};\n                try{\n                save_page_to_file();\n                }catch(n){};\n            }\n        },\n        onEnter: function(dragging, cart){\n            cart.style.backgroundImage =\n\"url('../images/general/frame3r.png')\";\n            },\n            onLeave: function(dragging, cart){\n                cart.style.backgroundImage =\n\"url('../images/general/frame3.png')\";\n            },\n            onCancel: function(dragging){\n                dragging.destroy();\n            }\n        });\n        drag.start(event);\n    });\n}\nwindow.addEvent('domready', function(){\n    if (document.images) {//this is for preloading the red frame image\n    img1 = new Image();//this is for preloading the red frame image\n    img1.src = \"../images/general/frame3r.png\";//this is for preloading the\nred frame image\n    }//this is for preloading the red frame image\nif (document.getElementById('game-page').innerHTML=='')\n{\nget_page_from_file();\n}\n});\nhope this helps\nilan\nOn Tue, Feb 7, 2012 at 6:49 AM, Olmo Maldonado <\nreply@reply.github.com\n\nwrote:\nCould you please provide us with the version of mootools and a jsfiddle (or\ncode) that reproduces the crash?\nOn Mon, Feb 6, 2012 at 10:46 PM, ilanle <\nreply@reply.github.com\n\nwrote:\nSCRIPT16389: Unspecified error.\nmootools-core.js, line 397 character 129\non this token:  var r=this.getBoundingClientRect(\nThis happens intermittently when dragging objects (script based on one of\nthe demos on this website).\nIt happens during drag (not on drop, not on enter, not on leave and not\non\ncancel, but during the drag itself)\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2278\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2278#issuecomment-3842561\n. BTW, happens in IE, does not happen in firefox and chrome\n\nOn Tue, Feb 7, 2012 at 10:02 AM, ilan lewin ilan.lewin@gmail.com wrote:\n\nSource code for page to reproduce:\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"\nhttp://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n\n\n\n\n\n\n\nMake your own scavenger hunt\n\n\n\n\n\n\n\n\n\n\n\n body a {color:#A0C34B;}\nbody a, #rt-main-surround .rt-article-title, #rt-main-surround .title,</p>\n<h1>rt-showcase .title, #rt-showcase .showcase-title span, #rt-top .title,</h1>\n<h1>rt-header .title, #rt-feature .title {color:#A0C34B;}</h1>\n<p>div#maximenuck ul.maximenuck li.maximenuck &gt; a span.titreck {color:#FF412B\n!important;} div#maximenuck ul.maximenuck li.maximenuck &gt; span.separator\nspan.titreck {color:#FF412B !important;}div#maximenuck ul.maximenuck\nli.maximenuck &gt; a span.descck {color:#A399FF !important;} div#maximenuck\nul.maximenuck li.maximenuck &gt; span.separator span.descck {color:#A399FF\n!important;}div#maximenuck ul.maximenuck li.maximenuck &gt; a:hover\nspan.titreck {color:#FFF566 !important;} div#maximenuck ul.maximenuck\nli.maximenuck &gt; span.separator:hover span.titreck {color:#FFF566\n!important;}div#maximenuck ul.maximenuck li.maximenuck &gt; a:hover\nspan.descck {color:#FF7A95 !important;} div#maximenuck ul.maximenuck\nli.maximenuck &gt; span.separator:hover span.descck {color:#FF7A95 !important;}\n  \n\n\n\n\n\n\n\n\n\n\nwindow.addEvent('load', function() {\n                new JCaption('img.caption');\n            });\n            window.addEvent('domready', function() {\n                var modules = ['rt-block'];\n                var header = ['h3','h2','h1'];\n                GantryBuildSpans(modules, header);\n            });</p>\n<p>InputsExclusion.push('.content_vote')\nwindow.addEvent('domready', function() {\n});\nwindow.addEvent('load', function() {\n});</p>\n<p>window.addEvent('domready', function() {new\nDropdownMaxiMenu(document.getElement('div#maximenuck'),{mooTransition :\n'Quad',mooEase : 'easeOut',useOpacity : '1',dureeOut : 500,menuID :\n'maximenuck',testoverflow : '1',orientation : '0',style :\n'moomenu',opentype : 'slide',direction : 'normal',directionoffset1 :\n'30',directionoffset2 : '30',mooDuree : 500});});\nwindow.addEvent('domready', function() {new\nSlideList(document.getElement('div#maximenuck ul'),{fancyTransition :\n'Quad',fancyEase : 'easeOut',fancyDuree : 500});});\n  \nvar jfbcLogoutFacebook = false;\nvar jfbcBase = 'http://www.scavengerhunt.org/';\nvar jfbcReturnUrl = 'L2ZyZWUtc2NhdmVuZ2VyLWh1bnQtbGlzdC5odG1s';\nvar jfbcRequiredPermissions =\n'email,user_likes,user_interests,friends_likes,friends_interests';\n\n\n\n\n\n\n\n\n\n\n\n<p>window.fbAsyncInit = function() {\nFB.init({appId: '262433700495575', status: true, cookie: true, xfbml:\ntrue, oauth: true, channelUrl: '\nhttp://www.scavengerhunt.org/components/com_jfbconnect/assets/jfbcchannel.php'}\n);\n};\n(function(d){\n     var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}\n     js = d.createElement('script'); js.id = id; js.async = true;\n     js.src = \"//connect.facebook.net/en_GB/all.js\";\n     d.getElementsByTagName('head')[0].appendChild(js);\n   }(document));\n\n<div id=\"rt-header\">\n        <div class=\"rt-container\">\n            <div id=\"rt-header2\">\n                <div id=\"rt-header3\">\n                    <div id=\"rt-header4\">\n                        <div class=\"rt-grid-12 rt-alpha rt-omega\">\n            <div class=\"rt-block\">\n            <a href=\"/\" id=\"rt-logo\"></a>\n        </div>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n debut Maximenu CK, par cedric keiflin sur\nhttp://www.joomlack.fr \n\n\n\n\nScavenger hunt\nlists\n\nMake your own\nscavenger hunt \n\n\n\n\n\n fin maximenuCK \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n                <p>\n\n\n\n\nno data\nyet\n\n        </div>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwindow.addEvent('domready', function(){\n    $('search').addEvent('click', function(e) {\n        e = new Event(e).stop();\n        var myitems= document.getElementById('myitems');\n        myitems.innerHTML=\"<span style='font-size:20px'><br/><br/>Search\nstarted.<br/><br/>Waiting for results...</span>\";\n        new Request({\n            url: 'http://www.scavengerhunt.org/scripts/index.php',\n            //url: '\nhttp://www.scavengerhunt.org/scripts/search-results.php',\n            onSuccess: function(data) {\n                    var myitems= document.getElementById('myitems');\n                    myitems.innerHTML=data;\n                    add_drag_events();\n            }</p>\n<p>}).post('qs='+document.getElementById('qs').value+'&amp;tmpl=component&amp;func=search-results');\n    });\n});</p>\n<p>\n\n\n\n\n\n\n\n\n\n\n\n \n\n\n```\n            \n\n            <div class=\"clear\"></div>\n        </div>\n    </div>\n                        </div>\n<div class=\"clear\"></div>\n                                            </body>\n\n```\n\nsource of my javascript file:\nfunction save_page_to_file()\n{\nvar page = document.getElementById('sh-background');\n            var save_data=\nescape(document.getElementById('game-page').innerHTML);\n            var session_id=document.getElementById('session_id').value;\n            new Request({\n            url: 'http://www.scavengerhunt.org/scripts/index.php',\n            onSuccess: function(data) {\n            var data2= unescape(data);\n                var response_div= document.getElementById('save-result');\n                response_div.innerHTML=data2;\n            }\n}).post('tmpl=component&func=save-page&data='+save_data+'&session_id='+session_id);\n}\nfunction get_page_from_file()\n{            var session_id=document.getElementById('session_id').value;\n            if (document.getElementById('game-page').innerHTML!='')\n            {\n            return;\n            }\n            new Request({\n            url: 'http://www.scavengerhunt.org/scripts/index.php',\n            onSuccess: function(data) {\n            var data2= unescape(data);\n                var game_div= document.getElementById('game-page');\n                game_div.innerHTML=data2;\n            }\n        }).post('tmpl=component&func=get-page&session_id='+session_id);\nvar page = document.getElementById('sh-background');\n            var save_data=\nescape(document.getElementById('game-page').innerHTML);\n            var session_id=document.getElementById('session_id').value;\n}\nfunction add_drag_events()\n{\n    var clipart_width = 45;\n    var clipart_height = 45;\n    $$('.item').addEvent('mousedown', function(event){\n        event.stop();\n        // this refers to the element with the .item class\n        var shirt = this;\n        var clone =\nshirt.clone().setStyles(shirt.getCoordinates()).setStyles({\n            opacity: 0.4,\n            position: 'absolute',\n        }).inject(document.body);\n```\n    var drag = new Drag.Move(clone, {\n        droppables: $$('.carti'),\n    onDrop: function(dragging, cart){\n\n        dragging.destroy();\n\n        if (cart !== null){\n           if ( cart.hasChildNodes() )\n            {\n                while ( cart.childNodes.length >= 1 )\n                {\n                    cart.removeChild( cart.firstChild );\n                }\n            }\n            cart.style.backgroundImage =\n\n```\n\"url('../images/general/frame3.png')\";\n                    var oImg=document.createElement(\"img\");\n                    oImg.setAttribute('src',\nshirt.children[0].getAttribute('src'));\n                    oImg.setAttribute('class','itemi');\nif(shirt.children[0].getAttribute('width')>\nshirt.children[0].getAttribute('height')){\n                    //alert('width\n'+shirt.children[0].getAttribute('width')+'  '+\nshirt.children[0].getAttribute('height'));\n                        oImg.setAttribute('width',clipart_width+'px');\n                        oImg.setAttribute('height',clipart_height+'px');\n                    } else {\n                    //alert('height\n'+shirt.children[0].getAttribute('width')+'  '+\nshirt.children[0].getAttribute('height'));\n                        oImg.setAttribute('height',clipart_width+'px');\n                        oImg.setAttribute('width',clipart_height+'px');\n                    }\ntry{\n                cart.appendChild(oImg);\n                }catch(n){};\n                try{\n                save_page_to_file();\n                }catch(n){};\n            }\n        },\n        onEnter: function(dragging, cart){\n            cart.style.backgroundImage =\n\"url('../images/general/frame3r.png')\";\n            },\n            onLeave: function(dragging, cart){\n                cart.style.backgroundImage =\n\"url('../images/general/frame3.png')\";\n            },\n            onCancel: function(dragging){\n                dragging.destroy();\n            }\n        });\n        drag.start(event);\n    });\n}\nwindow.addEvent('domready', function(){\n    if (document.images) {//this is for preloading the red frame image\n    img1 = new Image();//this is for preloading the red frame image\n    img1.src = \"../images/general/frame3r.png\";//this is for preloading\nthe red frame image\n    }//this is for preloading the red frame image\nif (document.getElementById('game-page').innerHTML=='')\n{\nget_page_from_file();\n}\n});\nhope this helps\nilan\nOn Tue, Feb 7, 2012 at 6:49 AM, Olmo Maldonado <\nreply@reply.github.com\n\nwrote:\nCould you please provide us with the version of mootools and a jsfiddle\n(or\ncode) that reproduces the crash?\nOn Mon, Feb 6, 2012 at 10:46 PM, ilanle <\nreply@reply.github.com\n\nwrote:\nSCRIPT16389: Unspecified error.\nmootools-core.js, line 397 character 129\non this token:  var r=this.getBoundingClientRect(\nThis happens intermittently when dragging objects (script based on one\nof\nthe demos on this website).\nIt happens during drag (not on drop, not on enter, not on leave and not\non\ncancel, but during the drag itself)\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2278\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2278#issuecomment-3842561\n. Source code for page to reproduce:\n\n\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"\nhttp://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n\n\n\n\n\n\n\nMake your own scavenger hunt\n\n\n\n\n\n\n\n\n\n\n\n body a {color:#A0C34B;}\nbody a, #rt-main-surround .rt-article-title, #rt-main-surround .title,</p>\n<h1>rt-showcase .title, #rt-showcase .showcase-title span, #rt-top .title,</h1>\n<h1>rt-header .title, #rt-feature .title {color:#A0C34B;}</h1>\n<p>div#maximenuck ul.maximenuck li.maximenuck &gt; a span.titreck {color:#FF412B\n!important;} div#maximenuck ul.maximenuck li.maximenuck &gt; span.separator\nspan.titreck {color:#FF412B !important;}div#maximenuck ul.maximenuck\nli.maximenuck &gt; a span.descck {color:#A399FF !important;} div#maximenuck\nul.maximenuck li.maximenuck &gt; span.separator span.descck {color:#A399FF\n!important;}div#maximenuck ul.maximenuck li.maximenuck &gt; a:hover\nspan.titreck {color:#FFF566 !important;} div#maximenuck ul.maximenuck\nli.maximenuck &gt; span.separator:hover span.titreck {color:#FFF566\n!important;}div#maximenuck ul.maximenuck li.maximenuck &gt; a:hover\nspan.descck {color:#FF7A95 !important;} div#maximenuck ul.maximenuck\nli.maximenuck &gt; span.separator:hover span.descck {color:#FF7A95 !important;}\n  \n\n\n\n\n\n\n\n\n\n\nwindow.addEvent('load', function() {\n                new JCaption('img.caption');\n            });\n            window.addEvent('domready', function() {\n                var modules = ['rt-block'];\n                var header = ['h3','h2','h1'];\n                GantryBuildSpans(modules, header);\n            });</p>\n<p>InputsExclusion.push('.content_vote')\nwindow.addEvent('domready', function() {\n});\nwindow.addEvent('load', function() {\n});</p>\n<p>window.addEvent('domready', function() {new\nDropdownMaxiMenu(document.getElement('div#maximenuck'),{mooTransition :\n'Quad',mooEase : 'easeOut',useOpacity : '1',dureeOut : 500,menuID :\n'maximenuck',testoverflow : '1',orientation : '0',style :\n'moomenu',opentype : 'slide',direction : 'normal',directionoffset1 :\n'30',directionoffset2 : '30',mooDuree : 500});});\nwindow.addEvent('domready', function() {new\nSlideList(document.getElement('div#maximenuck ul'),{fancyTransition :\n'Quad',fancyEase : 'easeOut',fancyDuree : 500});});\n  \nvar jfbcLogoutFacebook = false;\nvar jfbcBase = 'http://www.scavengerhunt.org/';\nvar jfbcReturnUrl = 'L2ZyZWUtc2NhdmVuZ2VyLWh1bnQtbGlzdC5odG1s';\nvar jfbcRequiredPermissions =\n'email,user_likes,user_interests,friends_likes,friends_interests';\n\n\n\n\n\n\n\n\n\n\n\nwindow.fbAsyncInit = function() {\nFB.init({appId: '262433700495575', status: true, cookie: true, xfbml: true,\noauth: true, channelUrl: '\nhttp://www.scavengerhunt.org/components/com_jfbconnect/assets/jfbcchannel.php'}\n);\n};\n(function(d){\n     var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}\n     js = d.createElement('script'); js.id = id; js.async = true;\n     js.src = \"//connect.facebook.net/en_GB/all.js\";\n     d.getElementsByTagName('head')[0].appendChild(js);\n   }(document));\n\n<div id=\"rt-header\">\n        <div class=\"rt-container\">\n            <div id=\"rt-header2\">\n                <div id=\"rt-header3\">\n                    <div id=\"rt-header4\">\n                        <div class=\"rt-grid-12 rt-alpha rt-omega\">\n            <div class=\"rt-block\">\n            <a href=\"/\" id=\"rt-logo\"></a>\n        </div>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n debut Maximenu CK, par cedric keiflin sur\nhttp://www.joomlack.fr \n\n\n\n\nScavenger hunt\nlists\n\nMake your own scavenger hunt\n\n\n\n\n\n\n fin maximenuCK \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nno data\nyet\n\n\n\n\n\n\n                                                                </div>\n                            <div class=\"rt-grid-5 \">\n            <div id=\"rt-sidebar-c\">\n                                    <div class=\"rt-block\">\n            <div class=\"module-surround\">\n                                                        <div\n\nclass=\"module-content\">\n                        \n\n\n\nwindow.addEvent('domready', function(){\n    $('search').addEvent('click', function(e) {\n        e = new Event(e).stop();\n        var myitems= document.getElementById('myitems');\n        myitems.innerHTML=\"<span style='font-size:20px'><br/><br/>Search\nstarted.<br/><br/>Waiting for results...</span>\";\n        new Request({\n            url: 'http://www.scavengerhunt.org/scripts/index.php',\n            //url: 'http://www.scavengerhunt.org/scripts/search-results.php\n',\n            onSuccess: function(data) {\n                    var myitems= document.getElementById('myitems');\n                    myitems.innerHTML=data;\n                    add_drag_events();\n            }</p>\n<p>}).post('qs='+document.getElementById('qs').value+'&amp;tmpl=component&amp;func=search-results');\n    });\n});</p>\n<p>\n\n\n\n\n\n\n\n\n\n\n\n \n\n\n```\n            \n\n            <div class=\"clear\"></div>\n        </div>\n    </div>\n                        </div>\n<div class=\"clear\"></div>\n                                            </body>\n\n```\n\nsource of my javascript file:\nfunction save_page_to_file()\n{\nvar page = document.getElementById('sh-background');\n            var save_data=\nescape(document.getElementById('game-page').innerHTML);\n            var session_id=document.getElementById('session_id').value;\n            new Request({\n            url: 'http://www.scavengerhunt.org/scripts/index.php',\n            onSuccess: function(data) {\n            var data2= unescape(data);\n                var response_div= document.getElementById('save-result');\n                response_div.innerHTML=data2;\n            }\n}).post('tmpl=component&func=save-page&data='+save_data+'&session_id='+session_id);\n}\nfunction get_page_from_file()\n{            var session_id=document.getElementById('session_id').value;\n            if (document.getElementById('game-page').innerHTML!='')\n            {\n            return;\n            }\n            new Request({\n            url: 'http://www.scavengerhunt.org/scripts/index.php',\n            onSuccess: function(data) {\n            var data2= unescape(data);\n                var game_div= document.getElementById('game-page');\n                game_div.innerHTML=data2;\n            }\n        }).post('tmpl=component&func=get-page&session_id='+session_id);\nvar page = document.getElementById('sh-background');\n            var save_data=\nescape(document.getElementById('game-page').innerHTML);\n            var session_id=document.getElementById('session_id').value;\n}\nfunction add_drag_events()\n{\n    var clipart_width = 45;\n    var clipart_height = 45;\n    $$('.item').addEvent('mousedown', function(event){\n        event.stop();\n        // this refers to the element with the .item class\n        var shirt = this;\n        var clone =\nshirt.clone().setStyles(shirt.getCoordinates()).setStyles({\n            opacity: 0.4,\n            position: 'absolute',\n        }).inject(document.body);\n```\n    var drag = new Drag.Move(clone, {\n        droppables: $$('.carti'),\n    onDrop: function(dragging, cart){\n\n        dragging.destroy();\n\n        if (cart !== null){\n           if ( cart.hasChildNodes() )\n            {\n                while ( cart.childNodes.length >= 1 )\n                {\n                    cart.removeChild( cart.firstChild );\n                }\n            }\n            cart.style.backgroundImage =\n\n```\n\"url('../images/general/frame3.png')\";\n                    var oImg=document.createElement(\"img\");\n                    oImg.setAttribute('src',\nshirt.children[0].getAttribute('src'));\n                    oImg.setAttribute('class','itemi');\nif(shirt.children[0].getAttribute('width')>\nshirt.children[0].getAttribute('height')){\n                    //alert('width\n'+shirt.children[0].getAttribute('width')+'  '+\nshirt.children[0].getAttribute('height'));\n                        oImg.setAttribute('width',clipart_width+'px');\n                        oImg.setAttribute('height',clipart_height+'px');\n                    } else {\n                    //alert('height\n'+shirt.children[0].getAttribute('width')+'  '+\nshirt.children[0].getAttribute('height'));\n                        oImg.setAttribute('height',clipart_width+'px');\n                        oImg.setAttribute('width',clipart_height+'px');\n                    }\ntry{\n                cart.appendChild(oImg);\n                }catch(n){};\n                try{\n                save_page_to_file();\n                }catch(n){};\n            }\n        },\n        onEnter: function(dragging, cart){\n            cart.style.backgroundImage =\n\"url('../images/general/frame3r.png')\";\n            },\n            onLeave: function(dragging, cart){\n                cart.style.backgroundImage =\n\"url('../images/general/frame3.png')\";\n            },\n            onCancel: function(dragging){\n                dragging.destroy();\n            }\n        });\n        drag.start(event);\n    });\n}\nwindow.addEvent('domready', function(){\n    if (document.images) {//this is for preloading the red frame image\n    img1 = new Image();//this is for preloading the red frame image\n    img1.src = \"../images/general/frame3r.png\";//this is for preloading the\nred frame image\n    }//this is for preloading the red frame image\nif (document.getElementById('game-page').innerHTML=='')\n{\nget_page_from_file();\n}\n});\nhope this helps\nilan\nOn Tue, Feb 7, 2012 at 6:49 AM, Olmo Maldonado <\nreply@reply.github.com\n\nwrote:\nCould you please provide us with the version of mootools and a jsfiddle (or\ncode) that reproduces the crash?\nOn Mon, Feb 6, 2012 at 10:46 PM, ilanle <\nreply@reply.github.com\n\nwrote:\nSCRIPT16389: Unspecified error.\nmootools-core.js, line 397 character 129\non this token:  var r=this.getBoundingClientRect(\nThis happens intermittently when dragging objects (script based on one of\nthe demos on this website).\nIt happens during drag (not on drop, not on enter, not on leave and not\non\ncancel, but during the drag itself)\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2278\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2278#issuecomment-3842561\n. BTW, happens in IE, does not happen in firefox and chrome\n\nOn Tue, Feb 7, 2012 at 10:02 AM, ilan lewin ilan.lewin@gmail.com wrote:\n\nSource code for page to reproduce:\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"\nhttp://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n\n\n\n\n\n\n\nMake your own scavenger hunt\n\n\n\n\n\n\n\n\n\n\n\n body a {color:#A0C34B;}\nbody a, #rt-main-surround .rt-article-title, #rt-main-surround .title,</p>\n<h1>rt-showcase .title, #rt-showcase .showcase-title span, #rt-top .title,</h1>\n<h1>rt-header .title, #rt-feature .title {color:#A0C34B;}</h1>\n<p>div#maximenuck ul.maximenuck li.maximenuck &gt; a span.titreck {color:#FF412B\n!important;} div#maximenuck ul.maximenuck li.maximenuck &gt; span.separator\nspan.titreck {color:#FF412B !important;}div#maximenuck ul.maximenuck\nli.maximenuck &gt; a span.descck {color:#A399FF !important;} div#maximenuck\nul.maximenuck li.maximenuck &gt; span.separator span.descck {color:#A399FF\n!important;}div#maximenuck ul.maximenuck li.maximenuck &gt; a:hover\nspan.titreck {color:#FFF566 !important;} div#maximenuck ul.maximenuck\nli.maximenuck &gt; span.separator:hover span.titreck {color:#FFF566\n!important;}div#maximenuck ul.maximenuck li.maximenuck &gt; a:hover\nspan.descck {color:#FF7A95 !important;} div#maximenuck ul.maximenuck\nli.maximenuck &gt; span.separator:hover span.descck {color:#FF7A95 !important;}\n  \n\n\n\n\n\n\n\n\n\n\nwindow.addEvent('load', function() {\n                new JCaption('img.caption');\n            });\n            window.addEvent('domready', function() {\n                var modules = ['rt-block'];\n                var header = ['h3','h2','h1'];\n                GantryBuildSpans(modules, header);\n            });</p>\n<p>InputsExclusion.push('.content_vote')\nwindow.addEvent('domready', function() {\n});\nwindow.addEvent('load', function() {\n});</p>\n<p>window.addEvent('domready', function() {new\nDropdownMaxiMenu(document.getElement('div#maximenuck'),{mooTransition :\n'Quad',mooEase : 'easeOut',useOpacity : '1',dureeOut : 500,menuID :\n'maximenuck',testoverflow : '1',orientation : '0',style :\n'moomenu',opentype : 'slide',direction : 'normal',directionoffset1 :\n'30',directionoffset2 : '30',mooDuree : 500});});\nwindow.addEvent('domready', function() {new\nSlideList(document.getElement('div#maximenuck ul'),{fancyTransition :\n'Quad',fancyEase : 'easeOut',fancyDuree : 500});});\n  \nvar jfbcLogoutFacebook = false;\nvar jfbcBase = 'http://www.scavengerhunt.org/';\nvar jfbcReturnUrl = 'L2ZyZWUtc2NhdmVuZ2VyLWh1bnQtbGlzdC5odG1s';\nvar jfbcRequiredPermissions =\n'email,user_likes,user_interests,friends_likes,friends_interests';\n\n\n\n\n\n\n\n\n\n\n\n<p>window.fbAsyncInit = function() {\nFB.init({appId: '262433700495575', status: true, cookie: true, xfbml:\ntrue, oauth: true, channelUrl: '\nhttp://www.scavengerhunt.org/components/com_jfbconnect/assets/jfbcchannel.php'}\n);\n};\n(function(d){\n     var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}\n     js = d.createElement('script'); js.id = id; js.async = true;\n     js.src = \"//connect.facebook.net/en_GB/all.js\";\n     d.getElementsByTagName('head')[0].appendChild(js);\n   }(document));\n\n<div id=\"rt-header\">\n        <div class=\"rt-container\">\n            <div id=\"rt-header2\">\n                <div id=\"rt-header3\">\n                    <div id=\"rt-header4\">\n                        <div class=\"rt-grid-12 rt-alpha rt-omega\">\n            <div class=\"rt-block\">\n            <a href=\"/\" id=\"rt-logo\"></a>\n        </div>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n debut Maximenu CK, par cedric keiflin sur\nhttp://www.joomlack.fr \n\n\n\n\nScavenger hunt\nlists\n\nMake your own\nscavenger hunt \n\n\n\n\n\n fin maximenuCK \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n                <p>\n\n\n\n\nno data\nyet\n\n        </div>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwindow.addEvent('domready', function(){\n    $('search').addEvent('click', function(e) {\n        e = new Event(e).stop();\n        var myitems= document.getElementById('myitems');\n        myitems.innerHTML=\"<span style='font-size:20px'><br/><br/>Search\nstarted.<br/><br/>Waiting for results...</span>\";\n        new Request({\n            url: 'http://www.scavengerhunt.org/scripts/index.php',\n            //url: '\nhttp://www.scavengerhunt.org/scripts/search-results.php',\n            onSuccess: function(data) {\n                    var myitems= document.getElementById('myitems');\n                    myitems.innerHTML=data;\n                    add_drag_events();\n            }</p>\n<p>}).post('qs='+document.getElementById('qs').value+'&amp;tmpl=component&amp;func=search-results');\n    });\n});</p>\n<p>\n\n\n\n\n\n\n\n\n\n\n\n \n\n\n```\n            \n\n            <div class=\"clear\"></div>\n        </div>\n    </div>\n                        </div>\n<div class=\"clear\"></div>\n                                            </body>\n\n```\n\nsource of my javascript file:\nfunction save_page_to_file()\n{\nvar page = document.getElementById('sh-background');\n            var save_data=\nescape(document.getElementById('game-page').innerHTML);\n            var session_id=document.getElementById('session_id').value;\n            new Request({\n            url: 'http://www.scavengerhunt.org/scripts/index.php',\n            onSuccess: function(data) {\n            var data2= unescape(data);\n                var response_div= document.getElementById('save-result');\n                response_div.innerHTML=data2;\n            }\n}).post('tmpl=component&func=save-page&data='+save_data+'&session_id='+session_id);\n}\nfunction get_page_from_file()\n{            var session_id=document.getElementById('session_id').value;\n            if (document.getElementById('game-page').innerHTML!='')\n            {\n            return;\n            }\n            new Request({\n            url: 'http://www.scavengerhunt.org/scripts/index.php',\n            onSuccess: function(data) {\n            var data2= unescape(data);\n                var game_div= document.getElementById('game-page');\n                game_div.innerHTML=data2;\n            }\n        }).post('tmpl=component&func=get-page&session_id='+session_id);\nvar page = document.getElementById('sh-background');\n            var save_data=\nescape(document.getElementById('game-page').innerHTML);\n            var session_id=document.getElementById('session_id').value;\n}\nfunction add_drag_events()\n{\n    var clipart_width = 45;\n    var clipart_height = 45;\n    $$('.item').addEvent('mousedown', function(event){\n        event.stop();\n        // this refers to the element with the .item class\n        var shirt = this;\n        var clone =\nshirt.clone().setStyles(shirt.getCoordinates()).setStyles({\n            opacity: 0.4,\n            position: 'absolute',\n        }).inject(document.body);\n```\n    var drag = new Drag.Move(clone, {\n        droppables: $$('.carti'),\n    onDrop: function(dragging, cart){\n\n        dragging.destroy();\n\n        if (cart !== null){\n           if ( cart.hasChildNodes() )\n            {\n                while ( cart.childNodes.length >= 1 )\n                {\n                    cart.removeChild( cart.firstChild );\n                }\n            }\n            cart.style.backgroundImage =\n\n```\n\"url('../images/general/frame3.png')\";\n                    var oImg=document.createElement(\"img\");\n                    oImg.setAttribute('src',\nshirt.children[0].getAttribute('src'));\n                    oImg.setAttribute('class','itemi');\nif(shirt.children[0].getAttribute('width')>\nshirt.children[0].getAttribute('height')){\n                    //alert('width\n'+shirt.children[0].getAttribute('width')+'  '+\nshirt.children[0].getAttribute('height'));\n                        oImg.setAttribute('width',clipart_width+'px');\n                        oImg.setAttribute('height',clipart_height+'px');\n                    } else {\n                    //alert('height\n'+shirt.children[0].getAttribute('width')+'  '+\nshirt.children[0].getAttribute('height'));\n                        oImg.setAttribute('height',clipart_width+'px');\n                        oImg.setAttribute('width',clipart_height+'px');\n                    }\ntry{\n                cart.appendChild(oImg);\n                }catch(n){};\n                try{\n                save_page_to_file();\n                }catch(n){};\n            }\n        },\n        onEnter: function(dragging, cart){\n            cart.style.backgroundImage =\n\"url('../images/general/frame3r.png')\";\n            },\n            onLeave: function(dragging, cart){\n                cart.style.backgroundImage =\n\"url('../images/general/frame3.png')\";\n            },\n            onCancel: function(dragging){\n                dragging.destroy();\n            }\n        });\n        drag.start(event);\n    });\n}\nwindow.addEvent('domready', function(){\n    if (document.images) {//this is for preloading the red frame image\n    img1 = new Image();//this is for preloading the red frame image\n    img1.src = \"../images/general/frame3r.png\";//this is for preloading\nthe red frame image\n    }//this is for preloading the red frame image\nif (document.getElementById('game-page').innerHTML=='')\n{\nget_page_from_file();\n}\n});\nhope this helps\nilan\nOn Tue, Feb 7, 2012 at 6:49 AM, Olmo Maldonado <\nreply@reply.github.com\n\nwrote:\nCould you please provide us with the version of mootools and a jsfiddle\n(or\ncode) that reproduces the crash?\nOn Mon, Feb 6, 2012 at 10:46 PM, ilanle <\nreply@reply.github.com\n\nwrote:\nSCRIPT16389: Unspecified error.\nmootools-core.js, line 397 character 129\non this token:  var r=this.getBoundingClientRect(\nThis happens intermittently when dragging objects (script based on one\nof\nthe demos on this website).\nIt happens during drag (not on drop, not on enter, not on leave and not\non\ncancel, but during the drag itself)\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2278\n\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2278#issuecomment-3842561\n. \n\n",
    "tysonmote": "Digging deeper, this looks like purely a Safari bug: http://jsfiddle.net/PLtjN/ (Ticket filed at https://bugs.webkit.org/show_bug.cgi?id=78206)\nUnless there's a way to smooth over the bug with MooTools, looks like I'm stuck with workaround hacks. ;_;\n. Digging deeper, this looks like purely a Safari bug: http://jsfiddle.net/PLtjN/ (Ticket filed at https://bugs.webkit.org/show_bug.cgi?id=78206)\nUnless there's a way to smooth over the bug with MooTools, looks like I'm stuck with workaround hacks. ;_;\n. ",
    "aaronmw": "Ah, this seems to be working now. Thank you :)\n. Ah, right on. So isn't me, then. Haha.\nI'm afraid I'm not going to be much use debugging it :(\n. Awesome. Thanks!\n. Sorry, how would I get a version of MooTools with this patch applied? (I'm pretty new to Git / GitHub...)\n. Ah, this seems to be working now. Thank you :)\n. Ah, right on. So isn't me, then. Haha.\nI'm afraid I'm not going to be much use debugging it :(\n. Awesome. Thanks!\n. Sorry, how would I get a version of MooTools with this patch applied? (I'm pretty new to Git / GitHub...)\n. ",
    "karolis-k": "oh, ok thanks.\nI'd like to test, but './build' is not working on my computer.\nwhen is new version with this fix is going to be released?\n. It's working fine with this one.\n. Just to let you know, I solved my problem by cloning an element this way (because I don't need to keep events or storage in this case):\njavascript\nfunction softClone(elem) {\n    return new Element('div').set('html', elem.clone().outerHTML).getFirst()\n}\nsoftClone($('Q1')).inject($('Q1'), 'before')\nalert($$('input[id=Q1]').length)\nhttp://jsfiddle.net/Vq5b9/2/\nEDIT: it doesn't work in FF...\n. in IE6/7 it was capturing original element AND the clone (alert = '2'). \nBut I updated it as you wish now and alert is '0' vs '1' in normal browser vs IE6/7\n. oh, ok thanks.\nI'd like to test, but './build' is not working on my computer.\nwhen is new version with this fix is going to be released?\n. It's working fine with this one.\n. Just to let you know, I solved my problem by cloning an element this way (because I don't need to keep events or storage in this case):\njavascript\nfunction softClone(elem) {\n    return new Element('div').set('html', elem.clone().outerHTML).getFirst()\n}\nsoftClone($('Q1')).inject($('Q1'), 'before')\nalert($$('input[id=Q1]').length)\nhttp://jsfiddle.net/Vq5b9/2/\nEDIT: it doesn't work in FF...\n. in IE6/7 it was capturing original element AND the clone (alert = '2'). \nBut I updated it as you wish now and alert is '0' vs '1' in normal browser vs IE6/7\n. ",
    "mientjan": "thx for the instructions. Made a mootools-core build with no-compat and uncompressed. \nDid the same tests and these are the results.\n- chrome 14.0.835.202 m works\n- firefox 10.0.1 works\n- IE6 (6.0.2900.5512.xpsp.080413-2111) no error thrown, but style is not set/animated. background-position-x and background-position-y are also not working\n- IE7 no error thrown, but style is not set/animated. background-position-x and background-position-y are also not working\n- IE8  no error thrown, but style is not set/animated. background-position-x and background-position-y work as expected.\n. thx for the instructions. Made a mootools-core build with no-compat and uncompressed. \nDid the same tests and these are the results.\n- chrome 14.0.835.202 m works\n- firefox 10.0.1 works\n- IE6 (6.0.2900.5512.xpsp.080413-2111) no error thrown, but style is not set/animated. background-position-x and background-position-y are also not working\n- IE7 no error thrown, but style is not set/animated. background-position-x and background-position-y are also not working\n- IE8  no error thrown, but style is not set/animated. background-position-x and background-position-y work as expected.\n. ",
    "JStiller": "I think it depends on the point of view. Semanticly it's a part of core. Otherwise it is perhaps rearly used wich allow us to think about moving it to more. But is'nt anyone able to download core without swiff with the Corebuilder? Isnt it one of the main reasons of beeing authority there for the Corebuilder?\n. @alpha123 But why u think it is not really Core functionality? Not a Core functionality for  the Framework it self or not a Core functionality for web. I mean you often gonna find projects with flash. And swiff is the only part in Mootools which can deal with it nor am i wrong?\n. I think it depends on the point of view. Semanticly it's a part of core. Otherwise it is perhaps rearly used wich allow us to think about moving it to more. But is'nt anyone able to download core without swiff with the Corebuilder? Isnt it one of the main reasons of beeing authority there for the Corebuilder?\n. @alpha123 But why u think it is not really Core functionality? Not a Core functionality for  the Framework it self or not a Core functionality for web. I mean you often gonna find projects with flash. And swiff is the only part in Mootools which can deal with it nor am i wrong?\n. ",
    "BooYaKaSha": "I have tried them, as a matter of fact.\nI first noticed the issue on 1.4.4. I've previously tried 1.4.2, the Google-hosted 1.4.1, and the nightly build 1.4.5dev.\nI'm a bit of a noob in this regard -- if I were to build from master, would that differ from the above versions (including nightly)?\n. As of right now I'm definitely still seeing the leak on my end using the latest nightly.\nI'm testing with a document that's pretty much empty -- just a doctype, head/body/title elements, the core script include, and then in my body I have the single line of code I included from above.\nThe XP install I'm using is pretty much out of the box -- I haven't installed any other apps or add-ons -- I actually just set it up about 2 weeks ago. And I'm also testing this in IE7's safe mode as well. I have installed all of the Windows Updates (except IE8 obviously, and WMP11).\nWith the above configuration, each refresh ups IE's memory usage by about 2-3MB.\nBut once I replace the script include with something from the 1.3 branch, the memory stops rising and holds steady. Then when I revert back to the nightly and start refreshing again it resumes.\nThe only thing I'm wondering is if this could be somehow specific to VM's -- VirtualBox in particular. Because I've read other bug reports for the 1.4 branch from people using VirtualBox, and in some cases you guys weren't able to reproduce it. Unfortunately I don't have access to a native install though. But I don't really know how/why that would be related.\n. I have tried them, as a matter of fact.\nI first noticed the issue on 1.4.4. I've previously tried 1.4.2, the Google-hosted 1.4.1, and the nightly build 1.4.5dev.\nI'm a bit of a noob in this regard -- if I were to build from master, would that differ from the above versions (including nightly)?\n. As of right now I'm definitely still seeing the leak on my end using the latest nightly.\nI'm testing with a document that's pretty much empty -- just a doctype, head/body/title elements, the core script include, and then in my body I have the single line of code I included from above.\nThe XP install I'm using is pretty much out of the box -- I haven't installed any other apps or add-ons -- I actually just set it up about 2 weeks ago. And I'm also testing this in IE7's safe mode as well. I have installed all of the Windows Updates (except IE8 obviously, and WMP11).\nWith the above configuration, each refresh ups IE's memory usage by about 2-3MB.\nBut once I replace the script include with something from the 1.3 branch, the memory stops rising and holds steady. Then when I revert back to the nightly and start refreshing again it resumes.\nThe only thing I'm wondering is if this could be somehow specific to VM's -- VirtualBox in particular. Because I've read other bug reports for the 1.4 branch from people using VirtualBox, and in some cases you guys weren't able to reproduce it. Unfortunately I don't have access to a native install though. But I don't really know how/why that would be related.\n. ",
    "michaelcm": "Does anyone know if the fix for this made it into 1.4.5 as that is the milestone it seems to be attached to?\n. Does anyone know if the fix for this made it into 1.4.5 as that is the milestone it seems to be attached to?\n. ",
    "xtophersd": "I just grabbed the regular download for 1.4.5 from mootools/net/download.\nOS XP, SP3, IE 7 (7.0.5730.13).\nI recreated the example page the original poster described:\nhttp://dev.specialtyproduce.com/fmb/foo.php\nIf you open up task manager, fire up IE7 and load the the page.  On every reload memory increased.\nOn some of my more complicated pages and after cruising my dev site, IE 7 just closed outright.\nIt is still a problem.\n. I just grabbed the regular download for 1.4.5 from mootools/net/download.\nOS XP, SP3, IE 7 (7.0.5730.13).\nI recreated the example page the original poster described:\nhttp://dev.specialtyproduce.com/fmb/foo.php\nIf you open up task manager, fire up IE7 and load the the page.  On every reload memory increased.\nOn some of my more complicated pages and after cruising my dev site, IE 7 just closed outright.\nIt is still a problem.\n. ",
    "Ciul": "You are right ibolmo.\nSorry for opening this issue when not needed.\n. You are right ibolmo.\nSorry for opening this issue when not needed.\n. ",
    "Xirt": "My search on 'fade' didn't pop that one up ;-). Just tested with nightly build: confirmed fixed.\n. My bad, it was with the newest MooTools (1.4.5), while 1.4.4 AND 1.4.3 show no problems. Fiddle is not yet updated with 1.4.5 though thus below my testcase (stripped version of the actual script, but still produces the error):\n``` javascript\nfunction test() {\nvar item = new Element('div', {'id' : 'tester'});\nitem.set('morph', {\n      unit: 'px',\n      link: 'cancel',\n      transition: Fx.Transitions.Back.easeOut\n   });\nitem.inject(document.body).morph({opacity: 1, top : 100});\n}\nwindow.addEvent('domready', function() {\n   $('button').addEvent('click', test);\n});\n```\nhtml\n<button type='button' id='button'>Test</button>\n. My search on 'fade' didn't pop that one up ;-). Just tested with nightly build: confirmed fixed.\n. My bad, it was with the newest MooTools (1.4.5), while 1.4.4 AND 1.4.3 show no problems. Fiddle is not yet updated with 1.4.5 though thus below my testcase (stripped version of the actual script, but still produces the error):\n``` javascript\nfunction test() {\nvar item = new Element('div', {'id' : 'tester'});\nitem.set('morph', {\n      unit: 'px',\n      link: 'cancel',\n      transition: Fx.Transitions.Back.easeOut\n   });\nitem.inject(document.body).morph({opacity: 1, top : 100});\n}\nwindow.addEvent('domready', function() {\n   $('button').addEvent('click', test);\n});\n```\nhtml\n<button type='button' id='button'>Test</button>\n. ",
    "bootle": "Ok, couldn't find the original issue. Sorry for doubling\n. Ok, couldn't find the original issue. Sorry for doubling\n. ",
    "raider5": "Got some advice from coda on IRC and this might not be a bug. The wording in the docs to me reads:\n\"If this collection of elements has element(s) that match the css selector return them\"\nI can see now that it might mean if \"the element itself matches a css selector\", however, it's still strange that the behaviour is only different in IE. \n. Got some advice from coda on IRC and this might not be a bug. The wording in the docs to me reads:\n\"If this collection of elements has element(s) that match the css selector return them\"\nI can see now that it might mean if \"the element itself matches a css selector\", however, it's still strange that the behaviour is only different in IE. \n. ",
    "bisrael": "This also has a side effect like so:\njavascript\nfor(var i = 0; i < 10000; ++i) {\n  var x = new Element(\"div\");\n  // right now the storage for this element is empty.\n  x.removeEvents();\n  // now there's stuff in it, even though it's empty.\n}\nJust calling .removeEvents causes the storage to slowly leak, even when that should have no side effect, if there were no events ever added.\n. This also has a side effect like so:\njavascript\nfor(var i = 0; i < 10000; ++i) {\n  var x = new Element(\"div\");\n  // right now the storage for this element is empty.\n  x.removeEvents();\n  // now there's stuff in it, even though it's empty.\n}\nJust calling .removeEvents causes the storage to slowly leak, even when that should have no side effect, if there were no events ever added.\n. ",
    "madrussa": "I understand. It would be helpful to indicate that on the docs. \nAlso for anyone that wants to use these methods on class objects you can use Object.clone to convert the class object to a standard object to get correct counts and or keys.\njavascript\nvar testClass = new Class({\n    classObject: {\n        'key1' : 'class value1',\n        'key2' : 'class value2',\n        'key3' : 'class value3'\n    },\n    initialize: function()\n    {\n        alert('classObject has ' + Object.getLength(Object.clone(this.classObject)) + ' values'); // Expected 3\n    }\n});\nnew testClass();\n. It does seem that I was fixing the issue in the wrong place. Sorry I was using it to parse out the values and then back into an object to be posted. Apply my fix did sort out the issue so I assumed it was the cause.\nTry this on the same fiddle:\njavascript\nvar data = document.id('myForm').toQueryString().parseQueryString(), \n    req = new Request.JSON({url:'/test'});\nconsole.log(data);\nreq.post(data);\nPerhaps the problem is decoding that data back into an object?\nBTW: Look at the headers sent.\n. I understand. It would be helpful to indicate that on the docs. \nAlso for anyone that wants to use these methods on class objects you can use Object.clone to convert the class object to a standard object to get correct counts and or keys.\njavascript\nvar testClass = new Class({\n    classObject: {\n        'key1' : 'class value1',\n        'key2' : 'class value2',\n        'key3' : 'class value3'\n    },\n    initialize: function()\n    {\n        alert('classObject has ' + Object.getLength(Object.clone(this.classObject)) + ' values'); // Expected 3\n    }\n});\nnew testClass();\n. It does seem that I was fixing the issue in the wrong place. Sorry I was using it to parse out the values and then back into an object to be posted. Apply my fix did sort out the issue so I assumed it was the cause.\nTry this on the same fiddle:\njavascript\nvar data = document.id('myForm').toQueryString().parseQueryString(), \n    req = new Request.JSON({url:'/test'});\nconsole.log(data);\nreq.post(data);\nPerhaps the problem is decoding that data back into an object?\nBTW: Look at the headers sent.\n. ",
    "nfroidure": "Why not just return the parent method to use it as a callback ? https://github.com/mootools/mootools-core/pull/2508\n. i ran test successfully btw\n. any news for this commit ?\n. ping\n. splice is a modificative function for arrays. having splice on strings would assume it either is. But strings cannot be modified in JavaScript, you still get a new string.\nIf you really need this method,  IMO, it should be slice, not splice.\n. Why not just return the parent method to use it as a callback ? https://github.com/mootools/mootools-core/pull/2508\n. i ran test successfully btw\n. any news for this commit ?\n. ping\n. splice is a modificative function for arrays. having splice on strings would assume it either is. But strings cannot be modified in JavaScript, you still get a new string.\nIf you really need this method,  IMO, it should be slice, not splice.\n. ",
    "davepilbeam": "http://jsfiddle.net/uaCJd/\n..this fiddle returns 'NaN' and 'medium' for border-width of element without defined border-width when viewed in my Opera Version:12.02\n..everything else is as expected - '0' and '0px' etc\n(1.4.5 / 1.4.0.1)\n(Opera Build:1578 Platform:Win32 System:Windows 7)\n. http://jsfiddle.net/uaCJd/\n..this fiddle returns 'NaN' and 'medium' for border-width of element without defined border-width when viewed in my Opera Version:12.02\n..everything else is as expected - '0' and '0px' etc\n(1.4.5 / 1.4.0.1)\n(Opera Build:1578 Platform:Win32 System:Windows 7)\n. ",
    "javierarias": "Even more, it doesn't fail if you set the inner text of an element to null:\n// this is also OK\nnew Element('p', {text: null}).setPosition({x: 10, y: 20});\n. Even more, it doesn't fail if you set the inner text of an element to null:\n// this is also OK\nnew Element('p', {text: null}).setPosition({x: 10, y: 20});\n. ",
    "brushek": "adding var before test solves issue, sory for bothering.\n. adding var before test solves issue, sory for bothering.\n. ",
    "sumankar": "adding var before test solves issue.\n. adding var before test solves issue.\n. ",
    "blaher": "I should probably mention, if I comment that line out (which is really no longer needed), I then get \"Error: element[name] is undefined\nSource File: http://www.allenkeith.com/inc/script/mootools/new.js\nLine: 3072\".\nI have also updated to 1.4.5 on the newer version, but get the same error, except the second error reads \"Error: f[a] is undefined\nSource File: ...\nLine: 234\".\n. Has anyone been able to make a work around for this, for the time being? With Arian's findings, I thought about inserting a new SVG element, and injecting all the contents and attributes of the other SVG element in to the new one, and then delete the old one (just for FF11). However, without any MooTool's functions being attached to the old element, my memory has been proving difficult to do it the old school JS way. Plus,I'm not sure if this will entirely work, but theoretically it should.\n. I should probably mention, if I comment that line out (which is really no longer needed), I then get \"Error: element[name] is undefined\nSource File: http://www.allenkeith.com/inc/script/mootools/new.js\nLine: 3072\".\nI have also updated to 1.4.5 on the newer version, but get the same error, except the second error reads \"Error: f[a] is undefined\nSource File: ...\nLine: 234\".\n. Has anyone been able to make a work around for this, for the time being? With Arian's findings, I thought about inserting a new SVG element, and injecting all the contents and attributes of the other SVG element in to the new one, and then delete the old one (just for FF11). However, without any MooTool's functions being attached to the old element, my memory has been proving difficult to do it the old school JS way. Plus,I'm not sure if this will entirely work, but theoretically it should.\n. ",
    "egiguet": "I met the same problem on my maps. Should I wait or shoud I go ?!\n. I met the same problem on my maps. Should I wait or shoud I go ?!\n. ",
    "w8r": "And on my maps, too. It breaks the whole thing hopelessly because of the events.\n. However, it works with 1.2.5 http://jsfiddle.net/ctqyR/.\n. It won't. It won't even render, in my opinion. I used downgrading to 1.2.5 as a workaround. Since I have a project of many thousands of lines of code, which I had already painfully upgraded to 1.3 several moths ago, I couldn't do it gracefully, so I just built my own version of compatibility layer and included it into .more. \nNow I'm waiting until either FF or Mootools would fix this bug. I put my hope rather in Mootools team.\n. @arian, is there a way to fix it temporarily in 1.3-1.4 through Element.Constructors, extending svg elements in constructor? I've managed to do that on 1.2.5, but I'm facing the perspective of downgrading the whole project to it for a yet unknown timespan, which would be mess, really. Whether or not Firefox will be releasing the fix in the next version, a temporary solution is needed. Any suggestions highly appreciated\nMy approach in 1.2.5: http://jsfiddle.net/w8r/zuN6q/\n. The problem is, I'm not getting anything in Element.Prototype in FF11, and cannot use Element.prototype for it\nhttp://jsfiddle.net/w8r/Kp4wy/\n. I'm speaking about 1.3-1.4 now\n. I think I've found the solution for 1.3 and 1.4. You can look at the test here http://jsfiddle.net/w8r/u6G5p/\n``` javascript\n(function(svgtags) {\n    var ns = 'http://www.w3.org/2000/svg',\n        methods = (function(proto, cls) {\n            var hash = {};\n            for (var f in proto) {\n                if (cls.hasOwnProperty(f)) {\n                    hash[f] = proto[f];\n                }\n            }\n            return hash;\n        })(Element.prototype, Element);\nsvgtags.each(function(tag) {\n    Element.Constructors[tag] = function(props) {\n        return (Object.append(document.createElementNS(ns, tag), methods).set(props));\n    };\n});\n\n})(['svg', 'path', 'circle']);\n```\n. If the fix will land only in the next major release, it's no relief, for FF11 will stay around for a while. I propose a detection like this for a while\njavascript\nvar svgNeedsPatching = !(document.createElementNS(ns, 'svg') instanceof Element);\n...\nElement.Constructors[tag] =\n                            svgNeedsPatching ? function(props) {\n                                return Object.append(\n                                        document.createElementNS(..., tag),\n                                        methods).set(props);\n                            } : function(props) {\n                                return document.createElementNS(..., tag)\n                                        .set(props);\n                            };\n. My thoughts exactly, in addition it's better to customize the patch with the SVG tags for individual projects.\n@arian, @kamicane, if you have any guidelines the fix should follow, please tell me, I'll arrange it accordingly.\n. And on my maps, too. It breaks the whole thing hopelessly because of the events.\n. However, it works with 1.2.5 http://jsfiddle.net/ctqyR/.\n. It won't. It won't even render, in my opinion. I used downgrading to 1.2.5 as a workaround. Since I have a project of many thousands of lines of code, which I had already painfully upgraded to 1.3 several moths ago, I couldn't do it gracefully, so I just built my own version of compatibility layer and included it into .more. \nNow I'm waiting until either FF or Mootools would fix this bug. I put my hope rather in Mootools team.\n. @arian, is there a way to fix it temporarily in 1.3-1.4 through Element.Constructors, extending svg elements in constructor? I've managed to do that on 1.2.5, but I'm facing the perspective of downgrading the whole project to it for a yet unknown timespan, which would be mess, really. Whether or not Firefox will be releasing the fix in the next version, a temporary solution is needed. Any suggestions highly appreciated\nMy approach in 1.2.5: http://jsfiddle.net/w8r/zuN6q/\n. The problem is, I'm not getting anything in Element.Prototype in FF11, and cannot use Element.prototype for it\nhttp://jsfiddle.net/w8r/Kp4wy/\n. I'm speaking about 1.3-1.4 now\n. I think I've found the solution for 1.3 and 1.4. You can look at the test here http://jsfiddle.net/w8r/u6G5p/\n``` javascript\n(function(svgtags) {\n    var ns = 'http://www.w3.org/2000/svg',\n        methods = (function(proto, cls) {\n            var hash = {};\n            for (var f in proto) {\n                if (cls.hasOwnProperty(f)) {\n                    hash[f] = proto[f];\n                }\n            }\n            return hash;\n        })(Element.prototype, Element);\nsvgtags.each(function(tag) {\n    Element.Constructors[tag] = function(props) {\n        return (Object.append(document.createElementNS(ns, tag), methods).set(props));\n    };\n});\n\n})(['svg', 'path', 'circle']);\n```\n. If the fix will land only in the next major release, it's no relief, for FF11 will stay around for a while. I propose a detection like this for a while\njavascript\nvar svgNeedsPatching = !(document.createElementNS(ns, 'svg') instanceof Element);\n...\nElement.Constructors[tag] =\n                            svgNeedsPatching ? function(props) {\n                                return Object.append(\n                                        document.createElementNS(..., tag),\n                                        methods).set(props);\n                            } : function(props) {\n                                return document.createElementNS(..., tag)\n                                        .set(props);\n                            };\n. My thoughts exactly, in addition it's better to customize the patch with the SVG tags for individual projects.\n@arian, @kamicane, if you have any guidelines the fix should follow, please tell me, I'll arrange it accordingly.\n. ",
    "pveiga": "I'm facing the same issue too. Any idea how to hack it ?\n. I'm facing the same issue too. Any idea how to hack it ?\n. ",
    "bytehead": "w8r, thanks for the workaround! it works fine!\n. w8r, thanks for the workaround! it works fine!\n. ",
    "hartum": "Something wrong with my browser then :-(\nEl 19/03/2012 23:28, \"Fabian Beiner\" \nreply@reply.github.com\nescribi\u00f3:\n\nWorks for me too. Firefox 11 and Windows 7.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2332#issuecomment-4585204\n. I have to apologize for opening this ticket, finally it seems that the problem is only mine\n. Something wrong with my browser then :-(\n\nEl 19/03/2012 23:28, \"Fabian Beiner\" \nreply@reply.github.com\nescribi\u00f3:\n\nWorks for me too. Firefox 11 and Windows 7.\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/mootools/mootools-core/issues/2332#issuecomment-4585204\n. I have to apologize for opening this ticket, finally it seems that the problem is only mine\n. \n",
    "tarraq": "Works for me too. Win 7, FF11.0\n. Don't apologize for that. :) Before you opened this ticket, you couldn't know that it's only your machine. It's weird nevertheless.\n. Works for me too. Win 7, FF11.0\n. Don't apologize for that. :) Before you opened this ticket, you couldn't know that it's only your machine. It's weird nevertheless.\n. ",
    "laohan": "elm.setOpacity(0.5); //IE7,8 at the beginning have a black background\n. THANKS~  Changed to GIF\n. elm.setOpacity(0.5); //IE7,8 at the beginning have a black background\n. THANKS~  Changed to GIF\n. ",
    "zorot": "I don't think you should use px.  It works with :- myFx.start(0,200).\n. I don't think you should use px.  It works with :- myFx.start(0,200).\n. ",
    "idleog": "ok, thanks!\n. ok, thanks!\n. ",
    "toddpi314": "This error will occur if you attempt to extend a class that isn't well defined (or in existence).\nExample:\nvar myWickedAwesomeClazz = new Class({\n    Extends : nonExistingClassDefinition\n});\nJust look through all of your extends definitions and make sure you have them pointing to legit classes.\n. This error will occur if you attempt to extend a class that isn't well defined (or in existence).\nExample:\nvar myWickedAwesomeClazz = new Class({\n    Extends : nonExistingClassDefinition\n});\nJust look through all of your extends definitions and make sure you have them pointing to legit classes.\n. ",
    "SethArchambault": "Cool to see people respond to this stuff! Sadly I have since forgotten what exactly my issue was.. next time I'll post a jfiddle. Thanks Todd and Arian!\n. Cool to see people respond to this stuff! Sadly I have since forgotten what exactly my issue was.. next time I'll post a jfiddle. Thanks Todd and Arian!\n. ",
    "inta": "Thanks for the hint, looks great.\nWhat about MooTools Fx? Will it be further improved or is the official way to use moofx instead for CSS animation?\nDon't get me wrong, but i was not even aware of the new moofx version.\n. Thanks for clarification, maybe that should be better described in the documentation. I found your explanation in the docs for the chain class, but if you look for Fx events you can not figure that out.\n. Thanks for the hint, looks great.\nWhat about MooTools Fx? Will it be further improved or is the official way to use moofx instead for CSS animation?\nDon't get me wrong, but i was not even aware of the new moofx version.\n. Thanks for clarification, maybe that should be better described in the documentation. I found your explanation in the docs for the chain class, but if you look for Fx events you can not figure that out.\n. ",
    "oelmekki": "\nTL;DR: this.options isn't updated for .get/.post calls or .send parameters.\n\nNot sure it should, i mean : it's a default for the request. You can then specify an other method, but it shouldn't change the default.\nMy take on this is that, if you need two different callbacks, you probably should have two different requests objects, here.\n. I thought of sub classing too, but Request.send is a way too big method (in LOC) to simply override. It should at least be split into several methods to be easily overridable.\n. > TL;DR: this.options isn't updated for .get/.post calls or .send parameters.\nNot sure it should, i mean : it's a default for the request. You can then specify an other method, but it shouldn't change the default.\nMy take on this is that, if you need two different callbacks, you probably should have two different requests objects, here.\n. I thought of sub classing too, but Request.send is a way too big method (in LOC) to simply override. It should at least be split into several methods to be easily overridable.\n. ",
    "prebenbo": "I commented out the function: \ngetOffsetParent: brokenOffsetParent ? function()\n- and the stuff above and the code works fine in Chrome now...\n. I commented out the function: \ngetOffsetParent: brokenOffsetParent ? function()\n- and the stuff above and the code works fine in Chrome now...\n. ",
    "SmokeyXL": "The suggested change in combination with urlEncoded set to false should send a proper Content-type for JSON-RPC;\nProblem with JSON-RPC for PHP remains as some browsers (tested on firefox) add charset=UTF8 to Content-type by default.\nBut this would atleast make mootools do the right thing by replacing the default Content-type which is set to text/plain\n. The suggested change in combination with urlEncoded set to false should send a proper Content-type for JSON-RPC;\nProblem with JSON-RPC for PHP remains as some browsers (tested on firefox) add charset=UTF8 to Content-type by default.\nBut this would atleast make mootools do the right thing by replacing the default Content-type which is set to text/plain\n. ",
    "ricardograca": "@sebmarkbage Can you elaborate on those \"better, completely different, API suggestions that is more likely to replace Request.JSON\"?\nI can only think of the standard Request, but that seems to defeat the point of Request.JSON.\n. I think this is an issue with RequireJS interacting in a strange way with Mootools and causing some kind of race condition. Check this out if you need to run scripts after the dom is ready and you're using RequireJS: https://github.com/requirejs/domReady\n. @sebmarkbage Can you elaborate on those \"better, completely different, API suggestions that is more likely to replace Request.JSON\"?\nI can only think of the standard Request, but that seems to defeat the point of Request.JSON.\n. I think this is an issue with RequireJS interacting in a strange way with Mootools and causing some kind of race condition. Check this out if you need to run scripts after the dom is ready and you're using RequireJS: https://github.com/requirejs/domReady\n. ",
    "wdaniels": "PS: This issue has been hanging around since Feb 2011:\nhttps://groups.google.com/d/topic/mootools-users/SpkiSZfbNng/discussion\n. OK, let's take the following test page:\nhttp://willdaniels.co.uk/files/xhtml-test.php\nPHP Source:\n``` php\n<?php\nheader(\"Content-Type: application/xhtml+xml; charset=utf-8\");\necho \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\\n\";\necho \"<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML+RDFa 1.1//EN\\\" \\\"http://www.w3.org/MarkUp/DTD/xhtml-rdfa-2.dtd\\\">\\n\";\n?>\n\n<head>\n    <title>Test Page for Mootools XHTML Error</title>\n    <script src=\"/media/system/js/mootools-core-compressed.js\" type=\"text/javascript\" />\n    <script src=\"/media/system/js/mootools-more.js\" type=\"text/javascript\" />\n</head>\n\n<body>\n    <h1 property=\"dc:title\">Know Thyself</h1>\n    <h2 rel=\"dc:author\">by\n        <a about=\"[_:AlexanderPope]\" rel=\"foaf:isPrimaryTopicOf\" href=\"http://en.wikipedia.org/wiki/Alexander_Pope\">\n            Alexander Pope\n        </a>\n    </h2>\n    <p>\n        Know then thyself, presume not God to scan;<br />\n        The proper study of mankind is Man.<br />\n        Placed on this isthmus of a middle state,<br />\n        A being darkly wise and rudely great:<br />\n        With too much knowledge for the Sceptic side,<br />\n        With too much weakness for the Stoic's pride,<br />\n        He hangs between; in doubt to act or rest,<br />\n        In doubt to deem himself a God or Beast,<br />\n        In doubt his mind or body to prefer;<br />\n        Born but to die, and reasoning but to err;<br />\n        Alike in ignorance, his reason such<br />\n        Whether he thinks too little or too much:<br />\n        Chaos of thought and passion, all confused;<br />\n        Still by himself abused, or disabused;<br />\n        Created half to rise and half to fall;<br />\n        Great lord of all things, yet a prey to all;<br />\n        Sole judge of truth, in endless error hurled:<br />\n        The glory, jest, and riddle of the world!\n    </p>\n</body>\n\n\n```\nThe standard FireFox error console window shows an error:\n\nFull error as copied to clipboard from FF:\nTimestamp: 30/07/12 21:58:30\nError: mismatched tag. Expected: </div>.\nSource File: \nLine: 1, Column: 189\nSource Code:\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"><div xmlns=\"http://www.w3.org/1999/xhtml\">foo</foo></\n. Hi @fabiomcosta \nNo, the cause of the problem is already explained here and in the referenced thread. I do not follow your logic about the javascript Content-Type (can you explain your reasoning?) but I changed the javascript MIME type on my server to \"text/javascript\" and it does not make any difference:\n\nNB: \"text/javascript\" is obsolete (ref. http://tools.ietf.org/html/rfc4329#section-7.1) although \"application/x-javascript\" should probably be updated to \"application/javascript\" now that it has been standardised. In the type attribute for scripts people always use \"text/javascript\" for legacy compatibility (the usual culprit... older IEs don't understand the proper MIME type).\nRegardless, the same issue remains. It has only to do with injecting invalid markup into the DOM from the Slick module.\n. It does not change anything using \"application/javascript\" for me, and I cannot see any reason why it should. Yes, Slick removes the invalid markup, it does not remain in the DOM, the problem is that it is not allowed to be added to the DOM ever for XHTML, hence the errors. So it is not a functional issue, it is one of code quality.\n. I have not proposed a fix because the matter is outside of my area of knowledge. I work only with documented web standards, so thankfully I do not need to worry about the idiosyncrasies of Internet Explorer. The last time I checked (which was some years ago) IE did not understand the XHTML Content-Type anyway, so unless that has changed it may suffice to first test for an IE user agent before injecting invalid markup into the DOM.\n. PS: This issue has been hanging around since Feb 2011:\nhttps://groups.google.com/d/topic/mootools-users/SpkiSZfbNng/discussion\n. OK, let's take the following test page:\nhttp://willdaniels.co.uk/files/xhtml-test.php\nPHP Source:\n``` php\n<?php\nheader(\"Content-Type: application/xhtml+xml; charset=utf-8\");\necho \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\\n\";\necho \"<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML+RDFa 1.1//EN\\\" \\\"http://www.w3.org/MarkUp/DTD/xhtml-rdfa-2.dtd\\\">\\n\";\n?>\n\n<head>\n    <title>Test Page for Mootools XHTML Error</title>\n    <script src=\"/media/system/js/mootools-core-compressed.js\" type=\"text/javascript\" />\n    <script src=\"/media/system/js/mootools-more.js\" type=\"text/javascript\" />\n</head>\n\n<body>\n    <h1 property=\"dc:title\">Know Thyself</h1>\n    <h2 rel=\"dc:author\">by\n        <a about=\"[_:AlexanderPope]\" rel=\"foaf:isPrimaryTopicOf\" href=\"http://en.wikipedia.org/wiki/Alexander_Pope\">\n            Alexander Pope\n        </a>\n    </h2>\n    <p>\n        Know then thyself, presume not God to scan;<br />\n        The proper study of mankind is Man.<br />\n        Placed on this isthmus of a middle state,<br />\n        A being darkly wise and rudely great:<br />\n        With too much knowledge for the Sceptic side,<br />\n        With too much weakness for the Stoic's pride,<br />\n        He hangs between; in doubt to act or rest,<br />\n        In doubt to deem himself a God or Beast,<br />\n        In doubt his mind or body to prefer;<br />\n        Born but to die, and reasoning but to err;<br />\n        Alike in ignorance, his reason such<br />\n        Whether he thinks too little or too much:<br />\n        Chaos of thought and passion, all confused;<br />\n        Still by himself abused, or disabused;<br />\n        Created half to rise and half to fall;<br />\n        Great lord of all things, yet a prey to all;<br />\n        Sole judge of truth, in endless error hurled:<br />\n        The glory, jest, and riddle of the world!\n    </p>\n</body>\n\n\n```\nThe standard FireFox error console window shows an error:\n\nFull error as copied to clipboard from FF:\nTimestamp: 30/07/12 21:58:30\nError: mismatched tag. Expected: </div>.\nSource File: \nLine: 1, Column: 189\nSource Code:\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"><div xmlns=\"http://www.w3.org/1999/xhtml\">foo</foo></\n. Hi @fabiomcosta \nNo, the cause of the problem is already explained here and in the referenced thread. I do not follow your logic about the javascript Content-Type (can you explain your reasoning?) but I changed the javascript MIME type on my server to \"text/javascript\" and it does not make any difference:\n\nNB: \"text/javascript\" is obsolete (ref. http://tools.ietf.org/html/rfc4329#section-7.1) although \"application/x-javascript\" should probably be updated to \"application/javascript\" now that it has been standardised. In the type attribute for scripts people always use \"text/javascript\" for legacy compatibility (the usual culprit... older IEs don't understand the proper MIME type).\nRegardless, the same issue remains. It has only to do with injecting invalid markup into the DOM from the Slick module.\n. It does not change anything using \"application/javascript\" for me, and I cannot see any reason why it should. Yes, Slick removes the invalid markup, it does not remain in the DOM, the problem is that it is not allowed to be added to the DOM ever for XHTML, hence the errors. So it is not a functional issue, it is one of code quality.\n. I have not proposed a fix because the matter is outside of my area of knowledge. I work only with documented web standards, so thankfully I do not need to worry about the idiosyncrasies of Internet Explorer. The last time I checked (which was some years ago) IE did not understand the XHTML Content-Type anyway, so unless that has changed it may suffice to first test for an IE user agent before injecting invalid markup into the DOM.\n. ",
    "emehrkay": "Okay this seems to be JS issue. It seems that element.style does not pull down css values that are percent-based \nI put together a quick hack that will write the style attribute of an element in Fx.Morph's constructor (it's kinda sloppy, doesn't do enough defensive checking and the Array.combine method doesn't give all possible permutations, but worth looking at). This allows for element.getStyle() to pull back the correct defined style so that the to var is using the one defined in the style sheet definition (again, it should probably check the inline style before writing etc.). \nhttp://jsfiddle.net/ARs7E/3/\nAnd this doesn't seem to work in Chrome at all. I think the limitation is in Fx.CSS.select, it doesn't seem to load the external stylesheet styles.\n- edit, the Chrome issue seems to be one of reading local css file imports. I was running these tests via an index.html file in a directory with no server. I added an nginx entry and ran it from there an Chrome read the files just fine.\n. Nice\n. Okay this seems to be JS issue. It seems that element.style does not pull down css values that are percent-based \nI put together a quick hack that will write the style attribute of an element in Fx.Morph's constructor (it's kinda sloppy, doesn't do enough defensive checking and the Array.combine method doesn't give all possible permutations, but worth looking at). This allows for element.getStyle() to pull back the correct defined style so that the to var is using the one defined in the style sheet definition (again, it should probably check the inline style before writing etc.). \nhttp://jsfiddle.net/ARs7E/3/\nAnd this doesn't seem to work in Chrome at all. I think the limitation is in Fx.CSS.select, it doesn't seem to load the external stylesheet styles.\n- edit, the Chrome issue seems to be one of reading local css file imports. I was running these tests via an index.html file in a directory with no server. I added an nginx entry and ran it from there an Chrome read the files just fine.\n. Nice\n. ",
    "shaun1x": "Sorry, this was my bad. Was using Chrome and forgot I had the UA overridden. Closed.\n. Sorry, this was my bad. Was using Chrome and forgot I had the UA overridden. Closed.\n. ",
    "juliohp": "Correct, that's where the issue is happening. In FF this function is not being called it only happens in IE8 and below. The extra validation wouldn't break that logic.\n. http://www8.hp.com/us/en/home.html?wafdebug=true  you only would need to replace the mootools.js reference with both core and more (1.4.5-core, 1.4.0 more, getting all elements from more). \n. We've not upgraded our mootools because of this problem\n. Thanks arian, it is hard to debug indeed, I'll keep trying to look what is causing that, certainly that scenario is happening in our site.\n. Thanks Sebastian, that solved the problem, if we change the hideEvent  ' ' for  null solves the problem. \n. So the issue is a weird edge case where mootools can't take empty  ' ' as event and if infinitely loops there.\n. Thanks Sebastian, it worked. So Don't you support ' ' events?.. good to know.\n. Correct, that's where the issue is happening. In FF this function is not being called it only happens in IE8 and below. The extra validation wouldn't break that logic.\n. http://www8.hp.com/us/en/home.html?wafdebug=true  you only would need to replace the mootools.js reference with both core and more (1.4.5-core, 1.4.0 more, getting all elements from more). \n. We've not upgraded our mootools because of this problem\n. Thanks arian, it is hard to debug indeed, I'll keep trying to look what is causing that, certainly that scenario is happening in our site.\n. Thanks Sebastian, that solved the problem, if we change the hideEvent  ' ' for  null solves the problem. \n. So the issue is a weird edge case where mootools can't take empty  ' ' as event and if infinitely loops there.\n. Thanks Sebastian, it worked. So Don't you support ' ' events?.. good to know.\n. ",
    "djafferian": "Yes, I know that this bug was closed a year ago, but the problem still exists, and no possible solutions have been discussed other than the most obvious, which would indeed cause breakage.  I fear that a lot of web developers using MooTools like myself may spend as many days trying to figure out why their cross domain Ajax implementations are not improving page load performance because CORS isn't working as it should.  There are other ways to indicate that a request is Ajax, but the criteria for avoiding a CORS preflight request is quite restrictive.  Alas I offer no solution, but only a workaround for those of us who have no use for the convention of the custom header and its default status :\n\nClass.refactor(Request, {\n    initialize: function (options) {\n        this.previous(options);\n        if (!('headers' in options && 'X-Requested-With' in options.headers)) {\n            delete this.headers['X-Requested-With'];\n        }\n    }\n});\n\n. Yes, I know that this bug was closed a year ago, but the problem still exists, and no possible solutions have been discussed other than the most obvious, which would indeed cause breakage.  I fear that a lot of web developers using MooTools like myself may spend as many days trying to figure out why their cross domain Ajax implementations are not improving page load performance because CORS isn't working as it should.  There are other ways to indicate that a request is Ajax, but the criteria for avoiding a CORS preflight request is quite restrictive.  Alas I offer no solution, but only a workaround for those of us who have no use for the convention of the custom header and its default status :\n\nClass.refactor(Request, {\n    initialize: function (options) {\n        this.previous(options);\n        if (!('headers' in options && 'X-Requested-With' in options.headers)) {\n            delete this.headers['X-Requested-With'];\n        }\n    }\n});\n\n. ",
    "antpaw": "oh yes forgot about that, sorry!\n. $('elem')[undefined ? 'addClass' : 'removeClass']('red');\ni know :)\n. Yes it's a logic problem, i could solve it by:\n1. implementing the logic you are doing in send() myself (appending '&' or '?' to url ect. ect. very annoying stuff). This leads to duplicated code (same code in framework and my app) and very low level code which i'm trying to escape by using mootools.\n2. you could refactor the GET url string build part of send() into a public function and i'm going to use it.\n3. as suggested in the first post, making the url string available in the as a public attribute.\nThanks\n. Thanks for helping me!\nI need the hole url that already exists, I already have some GET params which I don't want to lose.\nIf I use the hole url I need to find out whether i need '?' or '&'. \nI need to write low level code, that mootool already has. Can you extract this code in to a helper or provide the url variable as a public attribute?\nIt will also look nicer, now send() is doing some nasty string appending and data encoding, which you wouldn't expect in a send function.\n. okay i see, i'm going to use m-more for this, but shouldn't the basic functions of URI go into m-core because send() and maybe something else is using it anyways?\n. oh yes forgot about that, sorry!\n. $('elem')[undefined ? 'addClass' : 'removeClass']('red');\ni know :)\n. Yes it's a logic problem, i could solve it by:\n1. implementing the logic you are doing in send() myself (appending '&' or '?' to url ect. ect. very annoying stuff). This leads to duplicated code (same code in framework and my app) and very low level code which i'm trying to escape by using mootools.\n2. you could refactor the GET url string build part of send() into a public function and i'm going to use it.\n3. as suggested in the first post, making the url string available in the as a public attribute.\nThanks\n. Thanks for helping me!\nI need the hole url that already exists, I already have some GET params which I don't want to lose.\nIf I use the hole url I need to find out whether i need '?' or '&'. \nI need to write low level code, that mootool already has. Can you extract this code in to a helper or provide the url variable as a public attribute?\nIt will also look nicer, now send() is doing some nasty string appending and data encoding, which you wouldn't expect in a send function.\n. okay i see, i'm going to use m-more for this, but shouldn't the basic functions of URI go into m-core because send() and maybe something else is using it anyways?\n. ",
    "fepa": "I played around a bit and found out that using document.id(\"form1\").send(); instead of ...).submit(); triggers the form submission.\nIs this intended? I see no references to this in the documentation.\n. I played around a bit and found out that using document.id(\"form1\").send(); instead of ...).submit(); triggers the form submission.\nIs this intended? I see no references to this in the documentation.\n. ",
    "kunambi": "Interesting find, indeed.\nHowever, after I poked around a little I noticed that the element delegation still doesn't trigger - even if we're using .send()\n. I can't answer for wether it's expected or not, but it's not consistent with how relay:click works. Please see this jsfiddle: http://jsfiddle.net/SsyAJ/1/\nI suggest that the behaviour of Form.submit() is brought inline with how Element.click() works and that this ticket be reopened.\nBest,\nkunambi\n. Interesting find, indeed.\nHowever, after I poked around a little I noticed that the element delegation still doesn't trigger - even if we're using .send()\n. I can't answer for wether it's expected or not, but it's not consistent with how relay:click works. Please see this jsfiddle: http://jsfiddle.net/SsyAJ/1/\nI suggest that the behaviour of Form.submit() is brought inline with how Element.click() works and that this ticket be reopened.\nBest,\nkunambi\n. ",
    "tristanlins": "I fixed the code style.\nMaybe for the future, a genericfunction for searching styles by selector is the best way.\n. I did not know anythink about the problem described in #2345. I think I never reached this myself.\n. I fixed the code style.\nMaybe for the future, a genericfunction for searching styles by selector is the best way.\n. I did not know anythink about the problem described in #2345. I think I never reached this myself.\n. ",
    "cakesifu": "Indeed you do. I didn't see the magic button on your repo page and thought they might be disabled. :)\nDid a pull request: https://github.com/mootools/mootools-core/pull/2389\nClosing this one.\n. @cpojer could you please elaborate on the reasons behind that? \n. @gonchuki, great points. Thanks a lot for the feedback, much appreciated!\nI agree that singlular method names are counter intuitive so if you prefer to have another 4 methods that with plural names that's fine too. This is a matter of prefference and the mootools team should choose however they wish, however the posibility of working with multiple classes in a single method call should exist nonetheless.\nRegarding the suport for HTML5 classList, in 606c435 I did just that.\n. Following this logic why don't we drop addClass/removeClass alltogheter and use className directly instead? I often find myself having to parse an array or a string to add/remove  classes to an element. It's a common task and it  would be been nice to have the framework do this.\n. Suit yourself. Feel free to close this then.\n. Indeed you do. I didn't see the magic button on your repo page and thought they might be disabled. :)\nDid a pull request: https://github.com/mootools/mootools-core/pull/2389\nClosing this one.\n. @cpojer could you please elaborate on the reasons behind that? \n. @gonchuki, great points. Thanks a lot for the feedback, much appreciated!\nI agree that singlular method names are counter intuitive so if you prefer to have another 4 methods that with plural names that's fine too. This is a matter of prefference and the mootools team should choose however they wish, however the posibility of working with multiple classes in a single method call should exist nonetheless.\nRegarding the suport for HTML5 classList, in 606c435 I did just that.\n. Following this logic why don't we drop addClass/removeClass alltogheter and use className directly instead? I often find myself having to parse an array or a string to add/remove  classes to an element. It's a common task and it  would be been nice to have the framework do this.\n. Suit yourself. Feel free to close this then.\n. ",
    "brianedgerton": "I should add, with this check in place, Windows Phone 7 passes all core-1.4 Specs.\n. Happens on the current WP7 release.\n. Sorry, I'm not not working on WP any more and do not have the environment set up.\n. I should add, with this check in place, Windows Phone 7 passes all core-1.4 Specs.\n. Happens on the current WP7 release.\n. Sorry, I'm not not working on WP any more and do not have the environment set up.\n. ",
    "benjaminp": "There are more methods on the Number constructor: Number.isFinite(), Number.isInteger(), Number.isNaN(), Number.toInteger().\nTechnically, everything is subject to change until the spec is finalized. However, the new methods in Firefox are based on the harmony proposals page, which is supposed to mean the committee has reached consensus even if it's not formally speced yet.\n. There are more methods on the Number constructor: Number.isFinite(), Number.isInteger(), Number.isNaN(), Number.toInteger().\nTechnically, everything is subject to change until the spec is finalized. However, the new methods in Firefox are based on the harmony proposals page, which is supposed to mean the committee has reached consensus even if it's not formally speced yet.\n. ",
    "BenoitZugmeyer": "Note for completeness: Mozilla care about this issue and apparently will do some evangelism in order to prevent websites using MooTools 1.2 to break when Firefox 17 will be released.\nSee comment https://bugzilla.mozilla.org/show_bug.cgi?id=784280#c10\n. Note for completeness: Mozilla care about this issue and apparently will do some evangelism in order to prevent websites using MooTools 1.2 to break when Firefox 17 will be released.\nSee comment https://bugzilla.mozilla.org/show_bug.cgi?id=784280#c10\n. ",
    "DavidBruant": "I've added a section on MDN to describe this issue. Please tell me if I've made a mistake.\nI agree it would make sense for MooTools to match ES6 signature. However, the feature isn't exactly the same, namely on the second parameter. \nSo, one thing that would ease the transition from MooTools 1.2 to 1.5 would be to provide an alias for the current String.prototype.contains (maybe to String.prototype.legacyContains or String.prototype.oldContains). This way, people using the old version will just have to rename their calls and not the logic around it.\n. I've added a section on MDN to describe this issue. Please tell me if I've made a mistake.\nI agree it would make sense for MooTools to match ES6 signature. However, the feature isn't exactly the same, namely on the second parameter. \nSo, one thing that would ease the transition from MooTools 1.2 to 1.5 would be to provide an alias for the current String.prototype.contains (maybe to String.prototype.legacyContains or String.prototype.oldContains). This way, people using the old version will just have to rename their calls and not the logic around it.\n. ",
    "Enyby": "Quick fix: You need add \"String.prototype.contains = undefined;\" before init mootools core. Or add this row as first row in your core file.\nNote: You need check other js code for using String.prototype.contains in default way. But this function implement only in firefox, than its usage unlikely.\n. Quick fix: You need add \"String.prototype.contains = undefined;\" before init mootools core. Or add this row as first row in your core file.\nNote: You need check other js code for using String.prototype.contains in default way. But this function implement only in firefox, than its usage unlikely.\n. ",
    "hnuecke": "Danke! Die Zeile in mootools core einzuf\u00fcgen war auch f\u00fcr mich (2.9.5) die L\u00f6sung\n. Danke! Die Zeile in mootools core einzuf\u00fcgen war auch f\u00fcr mich (2.9.5) die L\u00f6sung\n. ",
    "dalevink": "It seems to be a browser specific issue.  \nI'm getting the same (unexpected) result in Windows IE9 \u2013\u00a0but works as expected on IE8 and Chrome on the Mac.\n. Sorry you're right \u2013\u00a0it's an issue on Chrome etc for me too\u2026 and yes, it seems to be isolated to focus:relay.\n. It seems to be a browser specific issue.  \nI'm getting the same (unexpected) result in Windows IE9 \u2013\u00a0but works as expected on IE8 and Chrome on the Mac.\n. Sorry you're right \u2013\u00a0it's an issue on Chrome etc for me too\u2026 and yes, it seems to be isolated to focus:relay.\n. ",
    "simon-at-fugu": "They have forgot to add the capture mod. \nChange in mootools Element.Delegation.js on line 178\njs\nreturn removeEvent.call(this, type, delegator);\nto\njs\nreturn removeEvent.call(this, type, delegator, _map.capture);\nit seems, it's  new in the browser that they handle the capture mods different....\n. They have forgot to add the capture mod. \nChange in mootools Element.Delegation.js on line 178\njs\nreturn removeEvent.call(this, type, delegator);\nto\njs\nreturn removeEvent.call(this, type, delegator, _map.capture);\nit seems, it's  new in the browser that they handle the capture mods different....\n. ",
    "newbie78": "im create logc object in class constructor and it's working\nthanks for the response\n. Hi man!\nim use this hack for ie8 etc browsers\nbecause mootools not correct for that browsers\n``` javascript\nfunction hasClass(ele,cls) {\n    return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));\n}\nfunction addClass(ele,cls) {\n    if (!hasClass(ele,cls)) ele.className += \" \"+cls;\n}\nfunction removeClass(ele,cls) {\n    if (hasClass(ele,cls)) {\n        var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');\n        ele.className=ele.className.replace(reg,' ');\n    }\n}\n```\nthanx! :*)\nsorry for my bad english\n. where i can see list of event handlers for needed object?\nplease explain me\ntnx\n. all my forms are checked before sending by means of mform tools\nI wrote the class for additional check of some values (del checkboxes with warning before sending)\nthey work independent and fired by submit button.\nand if my handler show the warning, then mform submit handler is submit the form because all fields checked right.\nsee setSubmit methods in this file:\nhttps://github.com/StephanWagner/mForm/blob/master/Source/mForm.Submit.js\njavascript\nif (this.$events.submit) {\n  this.$events.submit.each(function(fn) {\n    if (fn.apply(this) == false) {\n....\nthis code not stopped the submit event (this.$events.submit is empty)\nand it pull data to the server\nbut i'm registered my handler by addEvent method too\nwhy my handler is not present in this.$events.submit?\nsorry my bad inglish.\n. thanks a lot for clarification!\nit would be quite good to make property at an element \nwith the list of the event handlers bound to it\nbut how then removeEvents a method works?\nit remove all element binds and use this.$events property : )\n. ~~For prefixed styles I use these methods:~~\njavascript\nElement.implement({\n    setStylePrefixed: function(property, value){\n        var style = '';\n        ['webkit', 'moz', 'o', 'ms'].each(function(prefix){\n            style += '-' + prefix + '-' + property + ':' + value + ';';\n        });\n        style += property + ':' + value + ';';\n        this.set('style',style);\n        return this;\n    },\n    setStylesPrefixed: function(styles){\n        for (var style in styles) this.setStylePrefixed(style, styles[style]);\n        return this;\n    }\n});\nNew version:\njavascript\nElement.implement({\n    setStylePrefixed: function(property, value){\n        var self = this;\n        ['webkit', 'moz', 'o', 'ms'].each(function(prefix){\n            self.style['-' + prefix + '-' + property] = value;\n        });\n        this.style[property] = value;\n        return this;\n    },\n    setStylesPrefixed: function(styles){\n        for (var style in styles) this.setStylePrefixed(style, styles[style]);\n        return this;\n    }\n});\n. > Regarding your comment, using Element.prototype.set('style', ...) is not a very good idea, since it'll just set the style attribute of the Element, removing any other styles you may have set before. Your setStylesPrefixed function will leave you with only the last style it encounters actually set.\nYes, you are right. I've fixed my setStylesPrefixed method stated above.\nIf I set the 'ms-transform' property setStyle works correctly. Thanks very much.\nNow my methods for prefixed styles look like this:\njavascript\nElement.implement({\n    setStylePrefixed: function(property, value){\n        var self = this;\n        ['webkit', 'moz', 'o', 'ms'].each(function(prefix){\n            self.setStyle(prefix + '-' + property, value);\n        });\n        return this.setStyle(property, value);\n    },\n    setStylesPrefixed: function(styles){\n        for (var style in styles) this.setStylePrefixed(style, styles[style]);\n        return this;\n    }\n});\nWe can close this issue.\n. yes. this is my mistake.\nokay - thats work.\nbut why firing not work in this fiddle?\nhttp://jsfiddle.net/96s4kq8m/4/\nthanks again\n. please answ my q. in google mailing list forum no one answ me.\n. Dimitar, thanks for answer\nhttp://jsfiddle.net/96s4kq8m/5/\nHow could i get the changed 'field' (see fiddle) by means of usual addEvent('change') (see this http://jsfiddle.net/96s4kq8m/6/)?\n. maybe will we need to reopen the issues?\n. http://jsfiddle.net/96s4kq8m/7/\nfireEvent worked but event is undefined. why?\nps\ni check this in chrome & ff latest versions\n. im create logc object in class constructor and it's working\nthanks for the response\n. Hi man!\nim use this hack for ie8 etc browsers\nbecause mootools not correct for that browsers\n``` javascript\nfunction hasClass(ele,cls) {\n    return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));\n}\nfunction addClass(ele,cls) {\n    if (!hasClass(ele,cls)) ele.className += \" \"+cls;\n}\nfunction removeClass(ele,cls) {\n    if (hasClass(ele,cls)) {\n        var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');\n        ele.className=ele.className.replace(reg,' ');\n    }\n}\n```\nthanx! :*)\nsorry for my bad english\n. where i can see list of event handlers for needed object?\nplease explain me\ntnx\n. all my forms are checked before sending by means of mform tools\nI wrote the class for additional check of some values (del checkboxes with warning before sending)\nthey work independent and fired by submit button.\nand if my handler show the warning, then mform submit handler is submit the form because all fields checked right.\nsee setSubmit methods in this file:\nhttps://github.com/StephanWagner/mForm/blob/master/Source/mForm.Submit.js\njavascript\nif (this.$events.submit) {\n  this.$events.submit.each(function(fn) {\n    if (fn.apply(this) == false) {\n....\nthis code not stopped the submit event (this.$events.submit is empty)\nand it pull data to the server\nbut i'm registered my handler by addEvent method too\nwhy my handler is not present in this.$events.submit?\nsorry my bad inglish.\n. thanks a lot for clarification!\nit would be quite good to make property at an element \nwith the list of the event handlers bound to it\nbut how then removeEvents a method works?\nit remove all element binds and use this.$events property : )\n. ~~For prefixed styles I use these methods:~~\njavascript\nElement.implement({\n    setStylePrefixed: function(property, value){\n        var style = '';\n        ['webkit', 'moz', 'o', 'ms'].each(function(prefix){\n            style += '-' + prefix + '-' + property + ':' + value + ';';\n        });\n        style += property + ':' + value + ';';\n        this.set('style',style);\n        return this;\n    },\n    setStylesPrefixed: function(styles){\n        for (var style in styles) this.setStylePrefixed(style, styles[style]);\n        return this;\n    }\n});\nNew version:\njavascript\nElement.implement({\n    setStylePrefixed: function(property, value){\n        var self = this;\n        ['webkit', 'moz', 'o', 'ms'].each(function(prefix){\n            self.style['-' + prefix + '-' + property] = value;\n        });\n        this.style[property] = value;\n        return this;\n    },\n    setStylesPrefixed: function(styles){\n        for (var style in styles) this.setStylePrefixed(style, styles[style]);\n        return this;\n    }\n});\n. > Regarding your comment, using Element.prototype.set('style', ...) is not a very good idea, since it'll just set the style attribute of the Element, removing any other styles you may have set before. Your setStylesPrefixed function will leave you with only the last style it encounters actually set.\nYes, you are right. I've fixed my setStylesPrefixed method stated above.\nIf I set the 'ms-transform' property setStyle works correctly. Thanks very much.\nNow my methods for prefixed styles look like this:\njavascript\nElement.implement({\n    setStylePrefixed: function(property, value){\n        var self = this;\n        ['webkit', 'moz', 'o', 'ms'].each(function(prefix){\n            self.setStyle(prefix + '-' + property, value);\n        });\n        return this.setStyle(property, value);\n    },\n    setStylesPrefixed: function(styles){\n        for (var style in styles) this.setStylePrefixed(style, styles[style]);\n        return this;\n    }\n});\nWe can close this issue.\n. yes. this is my mistake.\nokay - thats work.\nbut why firing not work in this fiddle?\nhttp://jsfiddle.net/96s4kq8m/4/\nthanks again\n. please answ my q. in google mailing list forum no one answ me.\n. Dimitar, thanks for answer\nhttp://jsfiddle.net/96s4kq8m/5/\nHow could i get the changed 'field' (see fiddle) by means of usual addEvent('change') (see this http://jsfiddle.net/96s4kq8m/6/)?\n. maybe will we need to reopen the issues?\n. http://jsfiddle.net/96s4kq8m/7/\nfireEvent worked but event is undefined. why?\nps\ni check this in chrome & ff latest versions\n. ",
    "Doidel": "Ok I'll add it manually. Thanks for including it in the next build :)\n. Ok I'll add it manually. Thanks for including it in the next build :)\n. ",
    "Kadmillos": "the sense of a .set() should be that i need to SET some options, not stack them. even if it occurs only with events or even if i can take as many workaround as i need.\nin MooTools 1.2(.x) it works as espected, or was it a bug? O.o'\n. the sense of a .set() should be that i need to SET some options, not stack them. even if it occurs only with events or even if i can take as many workaround as i need.\nin MooTools 1.2(.x) it works as espected, or was it a bug? O.o'\n. ",
    "swhiteman": "Then how could you ever run a script against a filtered result?  That sounds like removing existing functionality and there's already a solution (evalScripts).\n. I didn't say there wasn't a use case, I said that disabling scripts just because they weren't inside an element that remains after filtering is a BC break.  The current behavior isn't a bug, so what you want is a new feature.\n. Are you not escaping the TEXTAREA's content?\n. This is the String.prototype.contains bug that is fixed in 1.2.6 but that version is not GA/not available on jsFiddle yet.\nSee https://github.com/mootools/mootools-core/pull/2462 and also #2402.\n. \"Widespread infection\" of the client-side component?  Do you mean people distributing unauthorized forks of MooTools that did nasty things?  I for one have heard nothing and for sure the standard packages are clean.  What Olmo means is that you aren't giving an example of how the library is \"infected.\" \nSounds a lot more like Joomla had a vulnerable plugin which maybe didn't validate or sanitize properly.  The fact that Moo was used on the client is likely immaterial unless you can point to a contract made by the library that was broken (like client-side escaping).\n. Then the infection (if there was one) was either in the YooMotion template itself or in the version of MooTools they were distributing with the template.  Because Moo's license allows it to be freely distributed, authors tend to include a copy their whatever template/library instead of telling you to download it yourself.  Just like you can create your own fork on GitHub called \"MooBetter\" that is totally malicious (until people figure it out).\nAnyway, nothing stops a hacked site from serving up a hacked version of Moo and/or hacked version of their template, and you won't be any the wiser. I always download from MooTools.net myself and delete links to any other versions in libraries I use, but this is unenforceable on a wide scale because it means templates aren't \"plug and play.\"\nI still would doubt that a person who pwned a site would attack the bundled MooTools library and not the template unless there was some reason that the vulnerability only allowed them to upload new files or something.  Though igetting a hacked Moo in the wild might mean a better payoff down the line.\n. I don't know anything about Joomla! so couldn't tell ya.  But isn't that the author's site you pointed to?  Nothing better than that.\n. Happy to help... in the future, post Moo questions first to the mailing list (Google Group), as you are more likely to need user support than to find an \"issue\" as in bug/defect.\n. There's a lot of other code there in your custom class that could potentially confound troubleshooting.  So what you should do is diff your class with basic tests like this, which like Gonchuki's works as far back as 1.2.6:\nhttp://jsfiddle.broadleafsystems.com/aCuWM/3/\nPretty sure you'll find something else is catching you up!\n. > Should we ask them to use set('text') or set('html') I think the former\nEither should be acceptable.  Remember the W3C says STYLE elements may have child elements, leaving room for an XML-based styling language (imagine putting XSL inside STYLE).  Plus, even with text/css you can legitimately have multiple text and comment nodes inside STYLE -- it doesn't have to be \"flat.\"  IMO, if the 'html' happens to be flat, it should definitely work, and even if it, deliberately or accidentally, has tags, 'html' should still work.\n. Yeah, I guess that'll do.  More now, the better!\n. Not a bug.  You set the body's innerHTML to the outerHTML of the Element (outerHTML is just a string) -- and that is not the same as injecting the original element into the DOM. \nSo templateEl is still not in the DOM, and since it isn't in the DOM, it doesn't have a doctype that defines the the id attribute as an DOM attribute of type ID (just being named id isn't enough).  Thus you can use certain DOM methods such as getElementsByTagName, byClassName, etc. but not byId.\n. Text body of the message.\n. Consider the diff between\nthis.cow.feed\nand\nthis.cow.feed()\nI really think this should be redirected to the Google Group as it will help more people there and isn't a MT bug.\n-- Sandy\n. You could make the argument that the IE Mode is perhaps equally important when it differs from the binary version.\nThink of it this way: the page author ultimately controls the Mode either by breaking/fixing markup or via an HTTP header/META tag that forces downlevel emulation.  And they may be fully intending to have their code switch paths as if they've changed the version.\nOK, I am essentially making a bug into a feature.  And as we well know, IE Mode doesn't mean full emulation.  But I think there's wiggle room as far as which is \"right\" given that you've discovered you were testing with a broken page which actually might fit IE 5-level DOM expectations, etc., as long as you're going to keep them on the page.  On the other hand, if you consult the version to totally kick out the user if they are < 7 or < 8, yeah, that's going to be problematic.  \nMaybe we need to bring back Browser.Engine.version alongside Browser.version, or Browser.computedVersion or something like that.\n. But what @philipzae is saying is that document.documentMode is being used.  I can repro this.\n. Pls provide a test case.\nBy counterexample, \nhttp://jsfiddle.broadleafsystems.com/MUY5p/\nworks in FF 15, 20, 21.\n(On a side note, using HTML tag names as class names seems like a sure way to make your code hard to understand.)\n. I see the need. Yet I don't like the idea of Request resolving conflicting arguments without an error. When the desire for 'simple' conflicts with custom 'header' options added over time there isn't a universal answer as to which should win. In my usage I might not care if the automatic x-requested-with is silently discarded, but I would definitely care if my custom header is discarded. So my business rule might be\nif ( simple &&  no_user_custom_x_headers ) { send simple-compatible headers only } else { send all custom headers }\nMaybe just changing the option name to something with a clear precedence ( options.forcesimple or options.attemptsimple ) would be better.\n. See https://github.com/mootools/mootools-core/issues/2473\n. The problem with \"fixing\" this is it's a BC break.\nTwo form fields with the same name is not an \"array\" from the client side; it's just a convention that happens to honored by some (not all) server preprocs which will merge multiple such fields into an array.  Some servers overwrite and only keep the last value, with the [] intact; a server may do anything it wants with the data.\nUp to now, the function has been creating actionable data, that is, myfield[][0]=cheese&myfield[][1]=toast can be parsed, which means it has been parsed in the wild for a long time and you'd be breaking people's stuff.  They might have been happier with it working the way you want, but we have to presume they've worked around it.  \nYears ago (pre-github issues, so I can't find it) I proposed having an option serverFormsCompatibility where you could specify the behavior for cases like this.  I think that is much better than changing the default behavior.\n. Looking at this again, I can't actually repro what you're saying.\nhttp://jsfiddle.net/7fzYd/2/\n(FF 15, Chrome 23)\n. Have you reported this to Microsoft as well?   Why set Type to the already global Function?  At least Moo is creating a global utility object that doesn't already exist by another name.\n. Fx.Tween is coupled to setStyle, and HTML4/5 attributes are not styles (we've never been able to Tween any HTML attributes, including width/height/tabindex/etc.).\nMaybe a better way of looking at this is that there should be Fx.Attributes which can operate on attributes using Fx.Transitions.\n(It would not be difficult for you to hack -- but would be very difficult to maintain -- an exception in FX.CSS, like setOpacity,  which uses set() under the hood instead of setStyle().)\n. Killin' me with this one, dude.  :)\nI've always had a dislike for Slick's \"CSS-and-more\" selectors vs. W3C CSS selectors because Slick lures you into thinking you can style elements in the same way you can select them.  Slick, for example, allows a list of selectors :not(a,b) while CSS only allows a simple selector in a :not pseudo.  (At least that one actually works in all browsers!)  :not(a b) is clearly invalid in CSS and shouldn't be supported in Moo, IMO, and I wish it didn't appear to work in non-IE browsers because now we have a seeming bug in Moo.\nI think the central problem here is that Slick uses a polyfill for matchesSelector when the browser doesn't support it, and the polyfill is stricter than the native function, or, more accurately, the way the native function is partially used along with userland Slick code results in a  looser result when native support is available, while IE ends up enforcing CSS selector rules.\n. (Which is why it isn't a bug.)\n. When you use an intermediate string, the escaping that you intended to be used by the RegExp engine is removed.\nThus '.' ends up being '.', then the string with '.' is cast to a RegExp object.\nUsing a RegExp literal is recommended whenever possible.  Otherwise use \\ to preserve your escaping.  \nNot a bug, and not related to MooTools, anyway!\n. Confirmed, reproduced at http://jsfiddle.net/sanford/gLMmp/\n. $('test').fireEvent('change');\nThis isn't a GitHub issue, so pls remove it. It should be on the mailing list mootools-users@googlegroups.com\n. Then how could you ever run a script against a filtered result?  That sounds like removing existing functionality and there's already a solution (evalScripts).\n. I didn't say there wasn't a use case, I said that disabling scripts just because they weren't inside an element that remains after filtering is a BC break.  The current behavior isn't a bug, so what you want is a new feature.\n. Are you not escaping the TEXTAREA's content?\n. This is the String.prototype.contains bug that is fixed in 1.2.6 but that version is not GA/not available on jsFiddle yet.\nSee https://github.com/mootools/mootools-core/pull/2462 and also #2402.\n. \"Widespread infection\" of the client-side component?  Do you mean people distributing unauthorized forks of MooTools that did nasty things?  I for one have heard nothing and for sure the standard packages are clean.  What Olmo means is that you aren't giving an example of how the library is \"infected.\" \nSounds a lot more like Joomla had a vulnerable plugin which maybe didn't validate or sanitize properly.  The fact that Moo was used on the client is likely immaterial unless you can point to a contract made by the library that was broken (like client-side escaping).\n. Then the infection (if there was one) was either in the YooMotion template itself or in the version of MooTools they were distributing with the template.  Because Moo's license allows it to be freely distributed, authors tend to include a copy their whatever template/library instead of telling you to download it yourself.  Just like you can create your own fork on GitHub called \"MooBetter\" that is totally malicious (until people figure it out).\nAnyway, nothing stops a hacked site from serving up a hacked version of Moo and/or hacked version of their template, and you won't be any the wiser. I always download from MooTools.net myself and delete links to any other versions in libraries I use, but this is unenforceable on a wide scale because it means templates aren't \"plug and play.\"\nI still would doubt that a person who pwned a site would attack the bundled MooTools library and not the template unless there was some reason that the vulnerability only allowed them to upload new files or something.  Though igetting a hacked Moo in the wild might mean a better payoff down the line.\n. I don't know anything about Joomla! so couldn't tell ya.  But isn't that the author's site you pointed to?  Nothing better than that.\n. Happy to help... in the future, post Moo questions first to the mailing list (Google Group), as you are more likely to need user support than to find an \"issue\" as in bug/defect.\n. There's a lot of other code there in your custom class that could potentially confound troubleshooting.  So what you should do is diff your class with basic tests like this, which like Gonchuki's works as far back as 1.2.6:\nhttp://jsfiddle.broadleafsystems.com/aCuWM/3/\nPretty sure you'll find something else is catching you up!\n. > Should we ask them to use set('text') or set('html') I think the former\nEither should be acceptable.  Remember the W3C says STYLE elements may have child elements, leaving room for an XML-based styling language (imagine putting XSL inside STYLE).  Plus, even with text/css you can legitimately have multiple text and comment nodes inside STYLE -- it doesn't have to be \"flat.\"  IMO, if the 'html' happens to be flat, it should definitely work, and even if it, deliberately or accidentally, has tags, 'html' should still work.\n. Yeah, I guess that'll do.  More now, the better!\n. Not a bug.  You set the body's innerHTML to the outerHTML of the Element (outerHTML is just a string) -- and that is not the same as injecting the original element into the DOM. \nSo templateEl is still not in the DOM, and since it isn't in the DOM, it doesn't have a doctype that defines the the id attribute as an DOM attribute of type ID (just being named id isn't enough).  Thus you can use certain DOM methods such as getElementsByTagName, byClassName, etc. but not byId.\n. Text body of the message.\n. Consider the diff between\nthis.cow.feed\nand\nthis.cow.feed()\nI really think this should be redirected to the Google Group as it will help more people there and isn't a MT bug.\n-- Sandy\n. You could make the argument that the IE Mode is perhaps equally important when it differs from the binary version.\nThink of it this way: the page author ultimately controls the Mode either by breaking/fixing markup or via an HTTP header/META tag that forces downlevel emulation.  And they may be fully intending to have their code switch paths as if they've changed the version.\nOK, I am essentially making a bug into a feature.  And as we well know, IE Mode doesn't mean full emulation.  But I think there's wiggle room as far as which is \"right\" given that you've discovered you were testing with a broken page which actually might fit IE 5-level DOM expectations, etc., as long as you're going to keep them on the page.  On the other hand, if you consult the version to totally kick out the user if they are < 7 or < 8, yeah, that's going to be problematic.  \nMaybe we need to bring back Browser.Engine.version alongside Browser.version, or Browser.computedVersion or something like that.\n. But what @philipzae is saying is that document.documentMode is being used.  I can repro this.\n. Pls provide a test case.\nBy counterexample, \nhttp://jsfiddle.broadleafsystems.com/MUY5p/\nworks in FF 15, 20, 21.\n(On a side note, using HTML tag names as class names seems like a sure way to make your code hard to understand.)\n. I see the need. Yet I don't like the idea of Request resolving conflicting arguments without an error. When the desire for 'simple' conflicts with custom 'header' options added over time there isn't a universal answer as to which should win. In my usage I might not care if the automatic x-requested-with is silently discarded, but I would definitely care if my custom header is discarded. So my business rule might be\nif ( simple &&  no_user_custom_x_headers ) { send simple-compatible headers only } else { send all custom headers }\nMaybe just changing the option name to something with a clear precedence ( options.forcesimple or options.attemptsimple ) would be better.\n. See https://github.com/mootools/mootools-core/issues/2473\n. The problem with \"fixing\" this is it's a BC break.\nTwo form fields with the same name is not an \"array\" from the client side; it's just a convention that happens to honored by some (not all) server preprocs which will merge multiple such fields into an array.  Some servers overwrite and only keep the last value, with the [] intact; a server may do anything it wants with the data.\nUp to now, the function has been creating actionable data, that is, myfield[][0]=cheese&myfield[][1]=toast can be parsed, which means it has been parsed in the wild for a long time and you'd be breaking people's stuff.  They might have been happier with it working the way you want, but we have to presume they've worked around it.  \nYears ago (pre-github issues, so I can't find it) I proposed having an option serverFormsCompatibility where you could specify the behavior for cases like this.  I think that is much better than changing the default behavior.\n. Looking at this again, I can't actually repro what you're saying.\nhttp://jsfiddle.net/7fzYd/2/\n(FF 15, Chrome 23)\n. Have you reported this to Microsoft as well?   Why set Type to the already global Function?  At least Moo is creating a global utility object that doesn't already exist by another name.\n. Fx.Tween is coupled to setStyle, and HTML4/5 attributes are not styles (we've never been able to Tween any HTML attributes, including width/height/tabindex/etc.).\nMaybe a better way of looking at this is that there should be Fx.Attributes which can operate on attributes using Fx.Transitions.\n(It would not be difficult for you to hack -- but would be very difficult to maintain -- an exception in FX.CSS, like setOpacity,  which uses set() under the hood instead of setStyle().)\n. Killin' me with this one, dude.  :)\nI've always had a dislike for Slick's \"CSS-and-more\" selectors vs. W3C CSS selectors because Slick lures you into thinking you can style elements in the same way you can select them.  Slick, for example, allows a list of selectors :not(a,b) while CSS only allows a simple selector in a :not pseudo.  (At least that one actually works in all browsers!)  :not(a b) is clearly invalid in CSS and shouldn't be supported in Moo, IMO, and I wish it didn't appear to work in non-IE browsers because now we have a seeming bug in Moo.\nI think the central problem here is that Slick uses a polyfill for matchesSelector when the browser doesn't support it, and the polyfill is stricter than the native function, or, more accurately, the way the native function is partially used along with userland Slick code results in a  looser result when native support is available, while IE ends up enforcing CSS selector rules.\n. (Which is why it isn't a bug.)\n. When you use an intermediate string, the escaping that you intended to be used by the RegExp engine is removed.\nThus '.' ends up being '.', then the string with '.' is cast to a RegExp object.\nUsing a RegExp literal is recommended whenever possible.  Otherwise use \\ to preserve your escaping.  \nNot a bug, and not related to MooTools, anyway!\n. Confirmed, reproduced at http://jsfiddle.net/sanford/gLMmp/\n. $('test').fireEvent('change');\nThis isn't a GitHub issue, so pls remove it. It should be on the mailing list mootools-users@googlegroups.com\n. ",
    "jbgutierrez": "Say you have built your app so that every page you serve is made up of little cached fragments.\nYou may have provided tiny block scripts within each fragment to provide everyone of them with dynamic behaviour, whatever it may be.\nThen you might want to refresh a whole container, but not the full page upon a user interaction. Just like pjax does.\nIn this scenario, you only need to reevaluate the script tags along the content you want to refresh.\nDoes it make sense?\n. Sure is not a bug! I really meant a feature! Thanks.\n. I might be wrong but, I think Request.HTML doesn't rely on tag scripts being inserted through innerHTML. That's why it parses any script tags in the response and uses Browse.exec which ends up calling createElement to inject a single script tag into the DOM. This approach works crossbrowser.\nHonestly, I didn't run the revised unit test through IE anyway :-(\nYou're right, I'm not fully satisfied with this pull request neither. This commit definitely breaks backwards compatibility because it might be evaluating less tag scripts due to the filtering criteria. I guess, I just wanted to make a call for a revision on this confusing method option. \nI'm with you, I don't see a good practice in loading JS through XHR, but that's something Request.HTML offers and it cames handy when you want to lower the number of full page reloads in an existing site without too much effort.\n. Say you have built your app so that every page you serve is made up of little cached fragments.\nYou may have provided tiny block scripts within each fragment to provide everyone of them with dynamic behaviour, whatever it may be.\nThen you might want to refresh a whole container, but not the full page upon a user interaction. Just like pjax does.\nIn this scenario, you only need to reevaluate the script tags along the content you want to refresh.\nDoes it make sense?\n. Sure is not a bug! I really meant a feature! Thanks.\n. I might be wrong but, I think Request.HTML doesn't rely on tag scripts being inserted through innerHTML. That's why it parses any script tags in the response and uses Browse.exec which ends up calling createElement to inject a single script tag into the DOM. This approach works crossbrowser.\nHonestly, I didn't run the revised unit test through IE anyway :-(\nYou're right, I'm not fully satisfied with this pull request neither. This commit definitely breaks backwards compatibility because it might be evaluating less tag scripts due to the filtering criteria. I guess, I just wanted to make a call for a revision on this confusing method option. \nI'm with you, I don't see a good practice in loading JS through XHR, but that's something Request.HTML offers and it cames handy when you want to lower the number of full page reloads in an existing site without too much effort.\n. ",
    "erubio": "I think is a good idea, and could be very useful in some cases,  +1 from my side\n. I think is a good idea, and could be very useful in some cases,  +1 from my side\n. ",
    "dlhawley": "I am able to replicate in jsfiddle: take a look at\nhttp://jsfiddle.net/dlhawley/9HLHJ/\nI'll look at a more recent version of Highcharts, but it had an issue with\n1.4.1 and I had to start somewhere.\nThanks\nOn Mon, Sep 24, 2012 at 12:01 AM, Arian Stolwijk\nnotifications@github.comwrote:\n\nDo you have an example on jsfiddle?\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2430#issuecomment-8808855.\n. Maybe we should put this on the back burner. This particular issue seems so\nbe solved withe the current version (2.3.2) of Highcharts. There are other\nissues coming up, but I'd rather proceed with newer versions....\n\nDave\nOn Mon, Sep 24, 2012 at 7:44 PM, David Hawley hawley.dl@gmail.com wrote:\n\nI am able to replicate in jsfiddle: take a look at\nhttp://jsfiddle.net/dlhawley/9HLHJ/\nI'll look at a more recent version of Highcharts, but it had an issue with\n1.4.1 and I had to start somewhere.\nThanks\nOn Mon, Sep 24, 2012 at 12:01 AM, Arian Stolwijk <notifications@github.com\n\nwrote:\nDo you have an example on jsfiddle?\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2430#issuecomment-8808855.\n. I am able to replicate in jsfiddle: take a look at\nhttp://jsfiddle.net/dlhawley/9HLHJ/\n\n\nI'll look at a more recent version of Highcharts, but it had an issue with\n1.4.1 and I had to start somewhere.\nThanks\nOn Mon, Sep 24, 2012 at 12:01 AM, Arian Stolwijk\nnotifications@github.comwrote:\n\nDo you have an example on jsfiddle?\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2430#issuecomment-8808855.\n. Maybe we should put this on the back burner. This particular issue seems so\nbe solved withe the current version (2.3.2) of Highcharts. There are other\nissues coming up, but I'd rather proceed with newer versions....\n\nDave\nOn Mon, Sep 24, 2012 at 7:44 PM, David Hawley hawley.dl@gmail.com wrote:\n\nI am able to replicate in jsfiddle: take a look at\nhttp://jsfiddle.net/dlhawley/9HLHJ/\nI'll look at a more recent version of Highcharts, but it had an issue with\n1.4.1 and I had to start somewhere.\nThanks\nOn Mon, Sep 24, 2012 at 12:01 AM, Arian Stolwijk <notifications@github.com\n\nwrote:\nDo you have an example on jsfiddle?\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2430#issuecomment-8808855.\n. \n\n",
    "neoacevedo": "just i've changed the code according to suggested but the problem still \npersists. you can check this in \nhttp://nogardtools.com/nestorftp/joomla25/index.php?option=com_content&view=article&id=10&Itemid=266\nfilling the data, and after accesing to\nnogardtools.com/nestrftp/joomla25/administrator\nwith user: test and pwd: 123, in Comente component menu, you will find \nthe message repeated.\nEl 24/09/2012 06:16 p.m., Arian Stolwijk escribi\u00f3:\n\nTry to move the the onComplete 'option' outside the submit event. Each \ntime you submit, it gets added again.\nSee http://jsfiddle.net/tMPDk/\n\u2014\nReply to this email directly or view it on GitHub \nhttps://github.com/mootools/mootools-core/issues/2431#issuecomment-8838551. \n. just i've changed the code according to suggested but the problem still \npersists. you can check this in \nhttp://nogardtools.com/nestorftp/joomla25/index.php?option=com_content&view=article&id=10&Itemid=266\n\nfilling the data, and after accesing to\nnogardtools.com/nestrftp/joomla25/administrator\nwith user: test and pwd: 123, in Comente component menu, you will find \nthe message repeated.\nEl 24/09/2012 06:16 p.m., Arian Stolwijk escribi\u00f3:\n\nTry to move the the onComplete 'option' outside the submit event. Each \ntime you submit, it gets added again.\nSee http://jsfiddle.net/tMPDk/\n\u2014\nReply to this email directly or view it on GitHub \nhttps://github.com/mootools/mootools-core/issues/2431#issuecomment-8838551. \n. \n",
    "leegee": "Dimitar, \nThing is that MT is falling behind in the world of XHR, and if I start creating my own custom Request sub-classes, I lose the benefit of using a globally-distributed library. I already have four projects with my own custom Request sub-class, and I'm not happy explaining to people why that is necessary.\nThis patch may not be good enough, but XHR Level 2 must be supported in MooTools if the library is survive in the world of HTML5, and unless Request is to be rewritten, I thought the approach I took did the least harm.\n. Will do, thank you.\n. Fair points, thanks for making them.\nOn 18/01/2013 12:53, Arian Stolwijk wrote:\n\nI added some comments, sorry for the nitpicking, but if you fix that \nwe can pull it :smile:\n\u2014\nReply to this email directly or view it on GitHub \nhttps://github.com/mootools/mootools-core/pull/2433#issuecomment-12418834. \n. Dimitar, \n\nThing is that MT is falling behind in the world of XHR, and if I start creating my own custom Request sub-classes, I lose the benefit of using a globally-distributed library. I already have four projects with my own custom Request sub-class, and I'm not happy explaining to people why that is necessary.\nThis patch may not be good enough, but XHR Level 2 must be supported in MooTools if the library is survive in the world of HTML5, and unless Request is to be rewritten, I thought the approach I took did the least harm.\n. Will do, thank you.\n. Fair points, thanks for making them.\nOn 18/01/2013 12:53, Arian Stolwijk wrote:\n\nI added some comments, sorry for the nitpicking, but if you fix that \nwe can pull it :smile:\n\u2014\nReply to this email directly or view it on GitHub \nhttps://github.com/mootools/mootools-core/pull/2433#issuecomment-12418834. \n. \n",
    "rrelmy": "Pull request sent.\nAre there any tests to verify that I did not break something else in mootools?\n. Does something block this commit to be merged?\n. The problem mostly occurs on slideshows if you use an element centered with auto margins within an element of odd width or using percents in width/padding.\nThe pull request has been updated.\n. I have rebased the previous commit and written a test spec.\nPhantomJS version 1.9.8 used by the karma runner is based on a webkit version released around 2011 before subpixel alignment was added to webkit.\nEDIT: I broke the builds again, tested locally against phantomjs v2 \u2026\nIs a test spec needed for this change? If the browser itself does not support subpixel alignment it is just fine, but I can't think of a way to test this usefully without breaking the PhantomJS build \u2026\nIf something is missing please let me know.\n. The test case has been modified to compare the result of getPosition with the output of getBoundingClientRect.\nAll tests pass now without testing for PhantomJS\n. Pull request sent.\nAre there any tests to verify that I did not break something else in mootools?\n. Does something block this commit to be merged?\n. The problem mostly occurs on slideshows if you use an element centered with auto margins within an element of odd width or using percents in width/padding.\nThe pull request has been updated.\n. I have rebased the previous commit and written a test spec.\nPhantomJS version 1.9.8 used by the karma runner is based on a webkit version released around 2011 before subpixel alignment was added to webkit.\nEDIT: I broke the builds again, tested locally against phantomjs v2 \u2026\nIs a test spec needed for this change? If the browser itself does not support subpixel alignment it is just fine, but I can't think of a way to test this usefully without breaking the PhantomJS build \u2026\nIf something is missing please let me know.\n. The test case has been modified to compare the result of getPosition with the output of getBoundingClientRect.\nAll tests pass now without testing for PhantomJS\n. ",
    "dskfh": "Which array are you talking about ?\nWhen debugging the code, that variable \"b\" is not even an array, it is NaN.\nThe problem is that MooTools adds \"$family\" to NaN / Number.prototype, making it an object traversable by \"for (key in NaN)\" as opposed to where NaN is really NaN.\n. Which array are you talking about ?\nWhen debugging the code, that variable \"b\" is not even an array, it is NaN.\nThe problem is that MooTools adds \"$family\" to NaN / Number.prototype, making it an object traversable by \"for (key in NaN)\" as opposed to where NaN is really NaN.\n. ",
    "MarcosFernandes": "Thanks Arian. I believe the plugin I was porting was not properly designed because it was 'looping' inside $events array without checking if members were defined - it wasn't needed in previous 1.2.5. \nI guess having \"undefined\" array members in applications that remove events frequently would cause unnecessary looping on \"fireEvent\" methods, this small issue is by far compensated with the feature you just described.\n. Thanks Arian. I believe the plugin I was porting was not properly designed because it was 'looping' inside $events array without checking if members were defined - it wasn't needed in previous 1.2.5. \nI guess having \"undefined\" array members in applications that remove events frequently would cause unnecessary looping on \"fireEvent\" methods, this small issue is by far compensated with the feature you just described.\n. ",
    "swamyv": "test case on jsfiddle.net\nhttp://jsfiddle.net/CvGcb/3/\n. This should be an mootool-more issue. So closing here.. \n. test case on jsfiddle.net\nhttp://jsfiddle.net/CvGcb/3/\n. This should be an mootool-more issue. So closing here.. \n. ",
    "zenlunatics": "ah, yes, you're right. sorry, please disregard.\n. ah, yes, you're right. sorry, please disregard.\n. ",
    "WebReflection": "here the gist for isArguments that works with use strict too, if this is what kenta meant: https://gist.github.com/4163041\n. here the gist for isArguments that works with use strict too, if this is what kenta meant: https://gist.github.com/4163041\n. ",
    "Bilge": "The form has its own _method field for graceful degradation purposes (no JavaScript). No QueryString module should permit duplicate keys because, I believe, it's an RFC violation and/or may exhibit undefined behaviour.\n. @arian :+1: \n. In my tests I have had issues with getBoundingClientRect() in some browsers but getBBox() works consistently.\n. The form has its own _method field for graceful degradation purposes (no JavaScript). No QueryString module should permit duplicate keys because, I believe, it's an RFC violation and/or may exhibit undefined behaviour.\n. @arian :+1: \n. In my tests I have had issues with getBoundingClientRect() in some browsers but getBBox() works consistently.\n. ",
    "mkhahani": "Thanks for reply, Aicke.\nYour solution works but not for two class instances. Indeed in this way, inside the callback function, we don't know which instance is firing the event.\nLet me clear my issue. Consider we have two classes Tree and Tree.Node. I want to create and fire the event (e.g., nodeclick) on Node class but the callback function must be member of the Tree class (doing some actions on tree). The problem is that the Tree is unreachable for Tree.Node (encapsulation) so I can not fire the event directly on tree.element and when I do on node.element, that doesn't work on MooTools.\nTree.Node class:\njavascript\nnode.element.addEvent('click', function() {\n    node.element.fireEvent('nodeclick', params);\n});\nTree class:\njavascript\ntree.element.addEvent('nodeclick', callBackFn);\nThis works on Prototype because although the event is fired on node.element but it bubbles up to reach tree.element.\n. mm.. yeah, Delegation is nice in some cases. You mean I create a single event listener for tree which fires on every node click. But how to pass Node properties to the event handler? We need to create events for each node individually to be able to pass properties.\nFinally, I think I have to break the rules and create events in Tree class.\nThank you anyway for your care.\n. This is not a deadlock and absolutely there are some tricks to resolve the issue. For example I can simply pass Tree object or event handler to Node class every time I create a node and then fire my event on it. But I was looking for a clean way. \nThe main benefit of event bubbling on fireEvent() is that you can call event handler from Node class while this is implemented in Tree class and without need to pass extra stuff to Node class such as Tree object or the event handler.\n. Thanks for reply, Aicke.\nYour solution works but not for two class instances. Indeed in this way, inside the callback function, we don't know which instance is firing the event.\nLet me clear my issue. Consider we have two classes Tree and Tree.Node. I want to create and fire the event (e.g., nodeclick) on Node class but the callback function must be member of the Tree class (doing some actions on tree). The problem is that the Tree is unreachable for Tree.Node (encapsulation) so I can not fire the event directly on tree.element and when I do on node.element, that doesn't work on MooTools.\nTree.Node class:\njavascript\nnode.element.addEvent('click', function() {\n    node.element.fireEvent('nodeclick', params);\n});\nTree class:\njavascript\ntree.element.addEvent('nodeclick', callBackFn);\nThis works on Prototype because although the event is fired on node.element but it bubbles up to reach tree.element.\n. mm.. yeah, Delegation is nice in some cases. You mean I create a single event listener for tree which fires on every node click. But how to pass Node properties to the event handler? We need to create events for each node individually to be able to pass properties.\nFinally, I think I have to break the rules and create events in Tree class.\nThank you anyway for your care.\n. This is not a deadlock and absolutely there are some tricks to resolve the issue. For example I can simply pass Tree object or event handler to Node class every time I create a node and then fire my event on it. But I was looking for a clean way. \nThe main benefit of event bubbling on fireEvent() is that you can call event handler from Node class while this is implemented in Tree class and without need to pass extra stuff to Node class such as Tree object or the event handler.\n. ",
    "Nek-": "Nop. It was on all browser (windows/chrome/firefox/IE). If my memory is good :') .\nI agree this is special.\n. I don't know, the call is inside mootools ;-) . Sorry I don't remember where is the fail.\nBut one thing is pretty sure : if you let it like that, some functions will make the framework bug, and it's bad.\n. Oh yeah I have one !\nThis script work on all browsers except IE7 (& IE6 I guess) : https://gist.github.com/Nek-/5015092/bfea1ed0d69951e1ab2304d3347c3f176e7b7193#file-customcheckbox-js-L216\n. So what, I take an element. Everything work on all browsers including IE8-9, the problem comes from me ?\nIn my code the getPrevious method return just null. I don't think it's only me... \n(The test was made with mootools 1.4.5)\n. Nop. It was on all browser (windows/chrome/firefox/IE). If my memory is good :') .\nI agree this is special.\n. I don't know, the call is inside mootools ;-) . Sorry I don't remember where is the fail.\nBut one thing is pretty sure : if you let it like that, some functions will make the framework bug, and it's bad.\n. Oh yeah I have one !\nThis script work on all browsers except IE7 (& IE6 I guess) : https://gist.github.com/Nek-/5015092/bfea1ed0d69951e1ab2304d3347c3f176e7b7193#file-customcheckbox-js-L216\n. So what, I take an element. Everything work on all browsers including IE8-9, the problem comes from me ?\nIn my code the getPrevious method return just null. I don't think it's only me... \n(The test was made with mootools 1.4.5)\n. ",
    "KorbinianMoser": "I can't believe that I am the only one with that problem... seems like very basic mistake in the color translation to me. \n. Hi Arian, thanks for your reply! It's https://ajax.googleapis.com/ajax/libs/mootools/1.4/mootools.js. \nconsole.log( new Color('#ccc')); still outputs [NaN,NaN,NaN]. \nMaybe Google needs an update to the current version? Or doesn't my link get the current version from there?\n. Oh! Seems like one of my scripts crashed it! \nThanks for your help! \nBy the way: in Mootools.More Class.Refactor there should be a {} behind for (offset = 0; offset < baseDir.length && offset < relDir.length && baseDir[offset] == relDir[offset]; offset++), Google Closure Compiler always complains that. \n. Got it. I messed around with String.toInt, that caused the problem. \n. I can't believe that I am the only one with that problem... seems like very basic mistake in the color translation to me. \n. Hi Arian, thanks for your reply! It's https://ajax.googleapis.com/ajax/libs/mootools/1.4/mootools.js. \nconsole.log( new Color('#ccc')); still outputs [NaN,NaN,NaN]. \nMaybe Google needs an update to the current version? Or doesn't my link get the current version from there?\n. Oh! Seems like one of my scripts crashed it! \nThanks for your help! \nBy the way: in Mootools.More Class.Refactor there should be a {} behind for (offset = 0; offset < baseDir.length && offset < relDir.length && baseDir[offset] == relDir[offset]; offset++), Google Closure Compiler always complains that. \n. Got it. I messed around with String.toInt, that caused the problem. \n. ",
    "tracer99": "So this bug is not what it seems. The error only shows up if another bug exists in the code. ie. inserting null element into DOM using grab. \n. I absolutely was getting errors thrown, hence why I created this patch. We have it running in production. I'll try to get the test done next week. Still dealing with a major launch we had last week.\n. So this bug is not what it seems. The error only shows up if another bug exists in the code. ie. inserting null element into DOM using grab. \n. I absolutely was getting errors thrown, hence why I created this patch. We have it running in production. I'll try to get the test done next week. Still dealing with a major launch we had last week.\n. ",
    "FireFly9": "I don't understand your comment.  I just need to know if there was any\nknown widespread infection issues with the mootools in the last month or so.\nThanks\nOn Thu, Feb 14, 2013 at 1:42 PM, Olmo Maldonado notifications@github.comwrote:\n\nWithout any code you're grasping at straws.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2472#issuecomment-13574337.\n\n\nglen@fireflywebs.ca - www.fireflywebs.ca\nglen@pavelichfarmbnb.com - www.pavelichfarmbnb.com\n. Thanks for your reply.\nOn Thu, Feb 14, 2013 at 2:02 PM, Arian Stolwijk notifications@github.comwrote:\n\nNot that I know of.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2472#issuecomment-13575301.\n\n\nglen@fireflywebs.ca - www.fireflywebs.ca\nglen@pavelichfarmbnb.com - www.pavelichfarmbnb.com\n. Thank you for your reply.\nThe tech that did the work stated the following about the plug in that was\ninfected.\nIt was called Mootoolshttp://forum.joomla.org/viewtopic.php?f=472&t=337397&sid=7d61a2f52396af65cb4ac50e9b952973\nThis is where it should be downloaded from http://mootools.net/download\nSo I went to that site to find a contact to inquire if there had been a\nknown issue before I reinstall the mootools plugin.\nThe main reason I was suspicious was because the very same time that our\nsite was infected and off line (being redirected to some other strange\nplace), the main YooMotion template site (\nhttp://www.conexcelsa.net/yoo_motion/index.php?option=com_content&view=article&id=47&Itemid=56)\nseemed to be experiencing the same problem.  This was in January I believe.\nThanks\nOn Thu, Feb 14, 2013 at 2:03 PM, swhiteman notifications@github.com wrote:\n\n\"Widespread infection\" of the client-side component? Do you mean people\ndistributing unauthorized forks of MooTools that did nasty things? I for\none have heard nothing and for sure the standard packages are clean. What\nOlmo means is that you aren't giving an example of how the library is\n\"infected.\"\nSounds a lot more like Joomla had a vulnerable plugin which maybe didn't\nvalidate or sanitize properly. The fact that Moo was used on the client is\nlikely immaterial unless you can point to a contract made by the library\nthat was broken (like client-side escaping).\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2472#issuecomment-13575355.\n\n\nglen@fireflywebs.ca - www.fireflywebs.ca\nglen@pavelichfarmbnb.com - www.pavelichfarmbnb.com\n. Thank you.\nCan you also recommend a reputable site offering this template (Yoo\nMotion).\nI see that Mootools is loaded by default in Joomla! 2.5.x.\nOn Thu, Feb 14, 2013 at 2:34 PM, swhiteman notifications@github.com wrote:\n\nThen the infection (if there was one) was either in the YooMotion template\nitself or in the version of MooTools they were distributing with the\ntemplate. Because Moo's license allows it to be freely distributed, authors\ntend to include a copy their whatever template/library instead of telling\nyou to download it yourself. Just like you can create your own fork on\nGitHub called \"MooBetter\" that is totally malicious (until people figure it\nout).\nAnyway, nothing stops a hacked site from serving up a hacked version of\nMoo and/or hacked version of their template, and you won't be any the\nwiser. I always download from MooTools.net myself and delete links to any\nother versions in libraries I use, but this is unenforceable on a wide\nscale because it means templates aren't \"plug and play.\"\nI still would doubt that a person who pwned a site would attack the\nbundled MooTools library and not the template unless there was some reason\nthat the vulnerability only allowed them to upload new files or something.\nThough igetting a hacked Moo in the wild might mean a better payoff down\nthe line.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2472#issuecomment-13576960.\n\n\nglen@fireflywebs.ca - www.fireflywebs.ca\nglen@pavelichfarmbnb.com - www.pavelichfarmbnb.com\n. Thank you for your reply.  Ha!  I'm getting communication via 3rd party so\nam slowly getting all the facts.\nThe tech has now sent this information and is clarifying that mootools is\nnot the problem.\nWhat I did was a website scan for malware and virus infections and it\nreturned back all the files that were infected.\nI went manually through all the ones it listed and removed the code. Any\nplugins it listed I had to quarantine manually...\nI saved these on your website in a quarintine folder (with execute\npermissions removed), He needs to access your website and have a look or\njust delete it.\nFig 1. is one of the original scans I did_(sent in a previous email_)...\nIt then shows as few that were left ... Fig 2 below is what it shows now\nafter I removed all the malware infected code.\nPrior it listed over 30 web pages and plugins...\nmootools developer had nothing to do with it... someone who had access to\nchange the website prior to me fixing, could have had a virus and it\ntransferred over when they logged into Joomla or the security on the\nwebsite was incorrectly set up and it was infected by something scanning\nwebsites and injecting code.\nYour new webmaster will have to download and reinstall the mootools.\nYour biggest threat is you Joomla is old and he should upgrade it to 2.5 or\nhigher...\nMy recommendation is for him to back up the website and reinstall\neverything from scratch. Upgrade Joomla and make sure all plugins etc. are\nJoomla 2.5 or higher compatible.\nSo I'm a wee bit wiser now.  I'm far from a developer or techie so I\nappreciate your responses, and I'm happy to have his confirmation that we\njust start from scratch.\nThanks\nOn Thu, Feb 14, 2013 at 2:52 PM, Olmo Maldonado notifications@github.comwrote:\n\nIf you can find the 'hacked' version, I'm curious to see what it is.\nOn Thu, Feb 14, 2013 at 2:34 PM, swhiteman notifications@github.com\nwrote:\n\nThen the infection (if there was one) was either in the YooMotion\ntemplate\nitself or in the version of MooTools they were distributing with the\ntemplate. Because Moo's license allows it to be freely distributed,\nauthors\ntend to include a copy their whatever template/library instead of\ntelling\nyou to download it yourself. Just like you can create your own fork on\nGitHub called \"MooBetter\" that is totally malicious (until people figure\nit\nout).\nAnyway, nothing stops a hacked site from serving up a hacked version of\nMoo and/or hacked version of their template, and you won't be any the\nwiser. I always download from MooTools.net myself and delete links to\nany\nother versions in libraries I use, but this is unenforceable on a wide\nscale because it means templates aren't \"plug and play.\"\nI still would doubt that a person who pwned a site would attack the\nbundled MooTools library and not the template unless there was some\nreason\nthat the vulnerability only allowed them to upload new files or\nsomething.\nThough igetting a hacked Moo in the wild might mean a better payoff down\nthe line.\n\u2014\nReply to this email directly or view it on GitHub<\nhttps://github.com/mootools/mootools-core/issues/2472#issuecomment-13576960>.\n\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2472#issuecomment-13577871.\n\n\nglen@fireflywebs.ca - www.fireflywebs.ca\nglen@pavelichfarmbnb.com - www.pavelichfarmbnb.com\n. OK - that's what I thought, and sorry I was confused about your association\nwith Joomla.\nThanks\nOn Thu, Feb 14, 2013 at 2:58 PM, swhiteman notifications@github.com wrote:\n\nI don't know anything about Joomla! so couldn't tell ya. But isn't that\nthe author's site you pointed to? Nothing better than that.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2472#issuecomment-13578162.\n\n\nglen@fireflywebs.ca - www.fireflywebs.ca\nglen@pavelichfarmbnb.com - www.pavelichfarmbnb.com\n. I don't understand your comment.  I just need to know if there was any\nknown widespread infection issues with the mootools in the last month or so.\nThanks\nOn Thu, Feb 14, 2013 at 1:42 PM, Olmo Maldonado notifications@github.comwrote:\n\nWithout any code you're grasping at straws.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2472#issuecomment-13574337.\n\n\nglen@fireflywebs.ca - www.fireflywebs.ca\nglen@pavelichfarmbnb.com - www.pavelichfarmbnb.com\n. Thanks for your reply.\nOn Thu, Feb 14, 2013 at 2:02 PM, Arian Stolwijk notifications@github.comwrote:\n\nNot that I know of.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2472#issuecomment-13575301.\n\n\nglen@fireflywebs.ca - www.fireflywebs.ca\nglen@pavelichfarmbnb.com - www.pavelichfarmbnb.com\n. Thank you for your reply.\nThe tech that did the work stated the following about the plug in that was\ninfected.\nIt was called Mootoolshttp://forum.joomla.org/viewtopic.php?f=472&t=337397&sid=7d61a2f52396af65cb4ac50e9b952973\nThis is where it should be downloaded from http://mootools.net/download\nSo I went to that site to find a contact to inquire if there had been a\nknown issue before I reinstall the mootools plugin.\nThe main reason I was suspicious was because the very same time that our\nsite was infected and off line (being redirected to some other strange\nplace), the main YooMotion template site (\nhttp://www.conexcelsa.net/yoo_motion/index.php?option=com_content&view=article&id=47&Itemid=56)\nseemed to be experiencing the same problem.  This was in January I believe.\nThanks\nOn Thu, Feb 14, 2013 at 2:03 PM, swhiteman notifications@github.com wrote:\n\n\"Widespread infection\" of the client-side component? Do you mean people\ndistributing unauthorized forks of MooTools that did nasty things? I for\none have heard nothing and for sure the standard packages are clean. What\nOlmo means is that you aren't giving an example of how the library is\n\"infected.\"\nSounds a lot more like Joomla had a vulnerable plugin which maybe didn't\nvalidate or sanitize properly. The fact that Moo was used on the client is\nlikely immaterial unless you can point to a contract made by the library\nthat was broken (like client-side escaping).\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2472#issuecomment-13575355.\n\n\nglen@fireflywebs.ca - www.fireflywebs.ca\nglen@pavelichfarmbnb.com - www.pavelichfarmbnb.com\n. Thank you.\nCan you also recommend a reputable site offering this template (Yoo\nMotion).\nI see that Mootools is loaded by default in Joomla! 2.5.x.\nOn Thu, Feb 14, 2013 at 2:34 PM, swhiteman notifications@github.com wrote:\n\nThen the infection (if there was one) was either in the YooMotion template\nitself or in the version of MooTools they were distributing with the\ntemplate. Because Moo's license allows it to be freely distributed, authors\ntend to include a copy their whatever template/library instead of telling\nyou to download it yourself. Just like you can create your own fork on\nGitHub called \"MooBetter\" that is totally malicious (until people figure it\nout).\nAnyway, nothing stops a hacked site from serving up a hacked version of\nMoo and/or hacked version of their template, and you won't be any the\nwiser. I always download from MooTools.net myself and delete links to any\nother versions in libraries I use, but this is unenforceable on a wide\nscale because it means templates aren't \"plug and play.\"\nI still would doubt that a person who pwned a site would attack the\nbundled MooTools library and not the template unless there was some reason\nthat the vulnerability only allowed them to upload new files or something.\nThough igetting a hacked Moo in the wild might mean a better payoff down\nthe line.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2472#issuecomment-13576960.\n\n\nglen@fireflywebs.ca - www.fireflywebs.ca\nglen@pavelichfarmbnb.com - www.pavelichfarmbnb.com\n. Thank you for your reply.  Ha!  I'm getting communication via 3rd party so\nam slowly getting all the facts.\nThe tech has now sent this information and is clarifying that mootools is\nnot the problem.\nWhat I did was a website scan for malware and virus infections and it\nreturned back all the files that were infected.\nI went manually through all the ones it listed and removed the code. Any\nplugins it listed I had to quarantine manually...\nI saved these on your website in a quarintine folder (with execute\npermissions removed), He needs to access your website and have a look or\njust delete it.\nFig 1. is one of the original scans I did_(sent in a previous email_)...\nIt then shows as few that were left ... Fig 2 below is what it shows now\nafter I removed all the malware infected code.\nPrior it listed over 30 web pages and plugins...\nmootools developer had nothing to do with it... someone who had access to\nchange the website prior to me fixing, could have had a virus and it\ntransferred over when they logged into Joomla or the security on the\nwebsite was incorrectly set up and it was infected by something scanning\nwebsites and injecting code.\nYour new webmaster will have to download and reinstall the mootools.\nYour biggest threat is you Joomla is old and he should upgrade it to 2.5 or\nhigher...\nMy recommendation is for him to back up the website and reinstall\neverything from scratch. Upgrade Joomla and make sure all plugins etc. are\nJoomla 2.5 or higher compatible.\nSo I'm a wee bit wiser now.  I'm far from a developer or techie so I\nappreciate your responses, and I'm happy to have his confirmation that we\njust start from scratch.\nThanks\nOn Thu, Feb 14, 2013 at 2:52 PM, Olmo Maldonado notifications@github.comwrote:\n\nIf you can find the 'hacked' version, I'm curious to see what it is.\nOn Thu, Feb 14, 2013 at 2:34 PM, swhiteman notifications@github.com\nwrote:\n\nThen the infection (if there was one) was either in the YooMotion\ntemplate\nitself or in the version of MooTools they were distributing with the\ntemplate. Because Moo's license allows it to be freely distributed,\nauthors\ntend to include a copy their whatever template/library instead of\ntelling\nyou to download it yourself. Just like you can create your own fork on\nGitHub called \"MooBetter\" that is totally malicious (until people figure\nit\nout).\nAnyway, nothing stops a hacked site from serving up a hacked version of\nMoo and/or hacked version of their template, and you won't be any the\nwiser. I always download from MooTools.net myself and delete links to\nany\nother versions in libraries I use, but this is unenforceable on a wide\nscale because it means templates aren't \"plug and play.\"\nI still would doubt that a person who pwned a site would attack the\nbundled MooTools library and not the template unless there was some\nreason\nthat the vulnerability only allowed them to upload new files or\nsomething.\nThough igetting a hacked Moo in the wild might mean a better payoff down\nthe line.\n\u2014\nReply to this email directly or view it on GitHub<\nhttps://github.com/mootools/mootools-core/issues/2472#issuecomment-13576960>.\n\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2472#issuecomment-13577871.\n\n\nglen@fireflywebs.ca - www.fireflywebs.ca\nglen@pavelichfarmbnb.com - www.pavelichfarmbnb.com\n. OK - that's what I thought, and sorry I was confused about your association\nwith Joomla.\nThanks\nOn Thu, Feb 14, 2013 at 2:58 PM, swhiteman notifications@github.com wrote:\n\nI don't know anything about Joomla! so couldn't tell ya. But isn't that\nthe author's site you pointed to? Nothing better than that.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/issues/2472#issuecomment-13578162.\n\n\nglen@fireflywebs.ca - www.fireflywebs.ca\nglen@pavelichfarmbnb.com - www.pavelichfarmbnb.com\n. ",
    "aviynw": "as a workaround I'm storing the original bind function in a variable called \"oldBind\" before mootools loads and then I call my functions that need to use bind with restoreBindFor(myFunction)\nfunction restoreBindFor(theFunction){\n        var currentBind=Function.prototype.bind;\n        Function.prototype.bind=oldBind;\n        theFunction();\n        Function.prototype.bind=currentBind;\n    }\n. Oh I see, before I tested this I tried using it with the \"compatibility\" version.  I thought \"compatibility\" meant its more compatible with arbitrary scripts, not more compatible with scripts relying on older APIs.  I now tried using it with the non-compatible version and see that my problem dissapears.\nAn extra line on the downloads page explaining the difference between the two version would be nice, thanks!\n. as a workaround I'm storing the original bind function in a variable called \"oldBind\" before mootools loads and then I call my functions that need to use bind with restoreBindFor(myFunction)\nfunction restoreBindFor(theFunction){\n        var currentBind=Function.prototype.bind;\n        Function.prototype.bind=oldBind;\n        theFunction();\n        Function.prototype.bind=currentBind;\n    }\n. Oh I see, before I tested this I tried using it with the \"compatibility\" version.  I thought \"compatibility\" meant its more compatible with arbitrary scripts, not more compatible with scripts relying on older APIs.  I now tried using it with the non-compatible version and see that my problem dissapears.\nAn extra line on the downloads page explaining the difference between the two version would be nice, thanks!\n. ",
    "dvdplm": "AFAICT this is still an issue.\nJSBin with mootools and @aviynw's snippet: http://jsbin.com/qamewuheni/2/edit\nJSBin without mootools and @aviynw's snippet: http://jsbin.com/waxecizeya/1/edit\nI'm in the same situation where I can't easily fix the hosting page and mootools' presence in the page ruins the party for my code.\n. @arian yes, you are right. I was (wrongly) under the impression that post v1.2 you'd have to opt-in to the broken stuff rather than the other way around.\n. AFAICT this is still an issue.\nJSBin with mootools and @aviynw's snippet: http://jsbin.com/qamewuheni/2/edit\nJSBin without mootools and @aviynw's snippet: http://jsbin.com/waxecizeya/1/edit\nI'm in the same situation where I can't easily fix the hosting page and mootools' presence in the page ruins the party for my code.\n. @arian yes, you are right. I was (wrongly) under the impression that post v1.2 you'd have to opt-in to the broken stuff rather than the other way around.\n. ",
    "mooyah": "I don't know if it is part of the official spec yet. This event is the only way to accurately track changes to a search field in webkit based browsers (because of the darn \"x\" icon they put in input[type=search]).\nThis is the only reference I could find:\nhttp://help.dottoro.com/ljdvxmhr.php\nFrom: Arian Stolwijk [mailto:notifications@github.com]\nSent: Tuesday, February 26, 2013 12:40 PM\nTo: mootools/mootools-core\nCc: Joel Dubien\nSubject: Re: [mootools-core] Support search form events. (#2474)\nCool, didn't know about this one yet. Do you have a link to the w3c spec?\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2474#issuecomment-14135085.\n. Here is another:\nhttp://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/Attributes.html#//apple_ref/html/attribute/onsearch\nFrom: Arian Stolwijk [mailto:notifications@github.com]\nSent: Tuesday, February 26, 2013 12:40 PM\nTo: mootools/mootools-core\nCc: Joel Dubien\nSubject: Re: [mootools-core] Support search form events. (#2474)\nCool, didn't know about this one yet. Do you have a link to the w3c spec?\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2474#issuecomment-14135085.\n. I don't know if it is part of the official spec yet. This event is the only way to accurately track changes to a search field in webkit based browsers (because of the darn \"x\" icon they put in input[type=search]).\nThis is the only reference I could find:\nhttp://help.dottoro.com/ljdvxmhr.php\nFrom: Arian Stolwijk [mailto:notifications@github.com]\nSent: Tuesday, February 26, 2013 12:40 PM\nTo: mootools/mootools-core\nCc: Joel Dubien\nSubject: Re: [mootools-core] Support search form events. (#2474)\nCool, didn't know about this one yet. Do you have a link to the w3c spec?\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2474#issuecomment-14135085.\n. Here is another:\nhttp://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/Attributes.html#//apple_ref/html/attribute/onsearch\nFrom: Arian Stolwijk [mailto:notifications@github.com]\nSent: Tuesday, February 26, 2013 12:40 PM\nTo: mootools/mootools-core\nCc: Joel Dubien\nSubject: Re: [mootools-core] Support search form events. (#2474)\nCool, didn't know about this one yet. Do you have a link to the w3c spec?\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/mootools/mootools-core/pull/2474#issuecomment-14135085.\n. ",
    "okolvik": "I've made a small demo here: http://prod1.tibe.no/ole/projects/mootools/\nEven without content, the no leak version should use about 1MB less than the current master.\nIt's even worse when there are a lot of other scripts running.\n. The testElement used in DOMReady shows up in Chromes Heap Profiler as a\ndetatched dom tree entry. This probably cases a leak.\n. I'm not sure if you get a notification when I add a new commit, so commenting just in case.\n. I've made a small demo here: http://prod1.tibe.no/ole/projects/mootools/\nEven without content, the no leak version should use about 1MB less than the current master.\nIt's even worse when there are a lot of other scripts running.\n. The testElement used in DOMReady shows up in Chromes Heap Profiler as a\ndetatched dom tree entry. This probably cases a leak.\n. I'm not sure if you get a notification when I add a new commit, so commenting just in case.\n. ",
    "bcherny": "@fakedarren thanks for the quick response! If you're not maintaining the code anymore, maybe move it to a \"legacy\"  module, or add a message to the build page that it's no longer being patched? When I use something like MT, my expectation is that it's bulletproof; if not, it would be nice to have some sort of indicator as a courtesy :)\n. @ibolmo sorry, bad choice of acronym on my part - I meant MooTools. When I use any big library (jQuery, MooTools, Closure) my assumption is that all code is well tested, and hopefully well documented. That (in my mind) is the big advantage of large libs over micro frameworks that do the same thing in a lot less code. If an officially supported feature is broken, it seems to me that it should either be fixed or deprecated, not left hanging; if left in this grey area, faulty code distributed through official channels has the potential to break many users' code without their knowledge. With almost 10% market share, MooTools has a lot of users. As a public service, the very least we could do is let users know about the potential issue.\n. @arian In my case I needed the version string as well as the browser and device.\n. @fakedarren thanks for the quick response! If you're not maintaining the code anymore, maybe move it to a \"legacy\"  module, or add a message to the build page that it's no longer being patched? When I use something like MT, my expectation is that it's bulletproof; if not, it would be nice to have some sort of indicator as a courtesy :)\n. @ibolmo sorry, bad choice of acronym on my part - I meant MooTools. When I use any big library (jQuery, MooTools, Closure) my assumption is that all code is well tested, and hopefully well documented. That (in my mind) is the big advantage of large libs over micro frameworks that do the same thing in a lot less code. If an officially supported feature is broken, it seems to me that it should either be fixed or deprecated, not left hanging; if left in this grey area, faulty code distributed through official channels has the potential to break many users' code without their knowledge. With almost 10% market share, MooTools has a lot of users. As a public service, the very least we could do is let users know about the potential issue.\n. @arian In my case I needed the version string as well as the browser and device.\n. ",
    "dmartensson": "Sure.\n. Sure.\n. ",
    "inkstak": "Hi,\nThanks for your answer (I just saw it today, with 2 months late).\nYou're solution is right. that means the issue can be closed.\nHowever, I suggest to update the docs on http://mootools.net/docs/core/Element/Element.Delegation about how linking delegation and FireEvent.\n. Hi,\nThanks for your answer (I just saw it today, with 2 months late).\nYou're solution is right. that means the issue can be closed.\nHowever, I suggest to update the docs on http://mootools.net/docs/core/Element/Element.Delegation about how linking delegation and FireEvent.\n. ",
    "web20opensource": ":+1: \n. :+1: \n. ",
    "dwbuiten": "Ping. It's been three months without so much as a reply.\n. Ping. It's been three months without so much as a reply.\n. ",
    "reednj": "Its sad this hasn't been merged in. Such a small changed :/\nIf you need to support CORS and don't want to change the source, you can easily create a new class that supports withCredentials like so:\n```\nRequest.CORS = new Class({\n    Extends: Request.JSON,\ninitialize: function(options) {\n    this.parent(options);\n\n    if(options && options.withCredentials === true && this.xhr && 'withCredentials' in this.xhr) {\n        this.xhr.withCredentials = true;\n    }\n}\n\n});\n```\n. Its sad this hasn't been merged in. Such a small changed :/\nIf you need to support CORS and don't want to change the source, you can easily create a new class that supports withCredentials like so:\n```\nRequest.CORS = new Class({\n    Extends: Request.JSON,\ninitialize: function(options) {\n    this.parent(options);\n\n    if(options && options.withCredentials === true && this.xhr && 'withCredentials' in this.xhr) {\n        this.xhr.withCredentials = true;\n    }\n}\n\n});\n```\n. ",
    "ccampbell": "@ibolmo should be good to go\n. Okay all good!\n. @ibolmo should be good to go\n. Okay all good!\n. ",
    "Delapouite": "Thanks for the precisions arian.\nI reckon the Mootools community would benefit of a small presentation (in an official blog post for example) of where the overall project is heading this year, how Prime, elements and the current framework will evolve together, the Pros and Cons of the new approach in the OO design etc...\n. Thanks for the precisions arian.\nI reckon the Mootools community would benefit of a small presentation (in an official blog post for example) of where the overall project is heading this year, how Prime, elements and the current framework will evolve together, the Pros and Cons of the new approach in the OO design etc...\n. ",
    "ppowalowski": "@Delapouite +1; \n@arian & @mootools  What do you say? How's things going?\n. @Delapouite +1; \n@arian & @mootools  What do you say? How's things going?\n. ",
    "rbpasker": "no, its STILL WRONG\n. it not calling onFailure, its calling onError\n+#### failure\n+\n+Fired when the request failed (error status code), or when JSON string could not be parsed.\n+\n. no, its STILL WRONG\n. it not calling onFailure, its calling onError\n+#### failure\n+\n+Fired when the request failed (error status code), or when JSON string could not be parsed.\n+\n. ",
    "psi-4ward": "I cant always prevent that some Objects contain functions. Should i copy and preprocess every Object before i pass it to Object.toQueryString() ?\n. I cant always prevent that some Objects contain functions. Should i copy and preprocess every Object before i pass it to Object.toQueryString() ?\n. ",
    "devmanny": "Is Elements\nvar MyElement = new Class({\n    Extends: Elements\n});\n. feedLink.addEvent('click', this.cow.feed.bind(this));\n. Is Elements\nvar MyElement = new Class({\n    Extends: Elements\n});\n. feedLink.addEvent('click', this.cow.feed.bind(this));\n. ",
    "tuckerconnelly": "Tim! Thank you for explaining that! I think there's still an issue, though.\nMy code above was awful, haha, so I wrote a more robust example here that you can copy/paste into a .xhtml. I used the function() {} idea that you expressed in your last code example and still no dice.\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.1//EN\"\n    \"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\">\n\n\nMootools Test\n<script src=\"mootools-core-1.4.5-full-nocompat.js\"></script>\n<script>\n\n    var Cow = new Class({\n        satisfied: null,\n        initialize: function() {\n            this.satisfied = 'Nooo.';\n        },\n\n        feed: function() {\n            this.satisfied = 'Yes! Moo!';\n        },\n\n        areYouSatisfied: function() {\n            console.log(this.satisfied);\n        },\n    });\n\n    var CowFeeder = new Class({\n        cow: null,\n        initialize: function(cow, feedLink, askLink) {\n            this.cow = cow;\n\n            feedLink.addEvent('click', function() {\n                this.cow.feed();\n            }.bind(this));\n\n            askLink.addEvent('click', function() {\n                this.cow.areYouSatisfied();\n            }.bind(this));\n        }\n    });\n\n    window.addEvent('domready', function() {\n        var cow = new Cow();\n        new CowFeeder(cow, $('feedTheCow'), $('askTheCow'));\n    });\n\n</script>\n\n\n\n<a href=\"javascript:void(0);\" id=\"feedTheCow\">Feed The Cow</a>\n<br />\n<a href=\"javascript:void(0);\" id=\"askTheCow\">Ask The Cow</a>\n\n\n\n```\nSo if you click \"Feed The Cow\", and the \"Ask The Cow,\" he will still say he's not satisfied, when he should say he is, right?\n. Ahhh, yeah works fine, thank you. And thank you all for replying so fast and for coding MooTools! I love this thing to pieces.\n. Tim! Thank you for explaining that! I think there's still an issue, though.\nMy code above was awful, haha, so I wrote a more robust example here that you can copy/paste into a .xhtml. I used the function() {} idea that you expressed in your last code example and still no dice.\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.1//EN\"\n    \"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\">\n\n\nMootools Test\n<script src=\"mootools-core-1.4.5-full-nocompat.js\"></script>\n<script>\n\n    var Cow = new Class({\n        satisfied: null,\n        initialize: function() {\n            this.satisfied = 'Nooo.';\n        },\n\n        feed: function() {\n            this.satisfied = 'Yes! Moo!';\n        },\n\n        areYouSatisfied: function() {\n            console.log(this.satisfied);\n        },\n    });\n\n    var CowFeeder = new Class({\n        cow: null,\n        initialize: function(cow, feedLink, askLink) {\n            this.cow = cow;\n\n            feedLink.addEvent('click', function() {\n                this.cow.feed();\n            }.bind(this));\n\n            askLink.addEvent('click', function() {\n                this.cow.areYouSatisfied();\n            }.bind(this));\n        }\n    });\n\n    window.addEvent('domready', function() {\n        var cow = new Cow();\n        new CowFeeder(cow, $('feedTheCow'), $('askTheCow'));\n    });\n\n</script>\n\n\n\n<a href=\"javascript:void(0);\" id=\"feedTheCow\">Feed The Cow</a>\n<br />\n<a href=\"javascript:void(0);\" id=\"askTheCow\">Ask The Cow</a>\n\n\n\n```\nSo if you click \"Feed The Cow\", and the \"Ask The Cow,\" he will still say he's not satisfied, when he should say he is, right?\n. Ahhh, yeah works fine, thank you. And thank you all for replying so fast and for coding MooTools! I love this thing to pieces.\n. ",
    "SalimBensiali": "Hi @arian, thanks for the quick feedback. I am not sure about calling the check function when the first domready event is added. Even thought this would work, I would rather see something like the following instead of L69:\njavascript\nvar isStateComplete = function(){\n    var state = document.readyState;\n    return (state == 'loaded' || state == 'complete');\n};\nif (document.readyState){\n    if (isStateComplete()) domready();\n    else checks.push(isStateComplete);\n}\nWhich is in the same flavour as the way doScrollWorks is handled L54.\nThe advantage of this approach is that the ready state of the document  (variable ready) is known straight after the IIFE finished executing, whereas in your suggestion, this state will be known only after the domready event listener is set up.\n. And here is a jsfiddle that reproduces the bug: http://jsfiddle.net/salimbensiali/q4Qa5.\n. Any updates on this?\n. Hi @arian, thanks for the quick feedback. I am not sure about calling the check function when the first domready event is added. Even thought this would work, I would rather see something like the following instead of L69:\njavascript\nvar isStateComplete = function(){\n    var state = document.readyState;\n    return (state == 'loaded' || state == 'complete');\n};\nif (document.readyState){\n    if (isStateComplete()) domready();\n    else checks.push(isStateComplete);\n}\nWhich is in the same flavour as the way doScrollWorks is handled L54.\nThe advantage of this approach is that the ready state of the document  (variable ready) is known straight after the IIFE finished executing, whereas in your suggestion, this state will be known only after the domready event listener is set up.\n. And here is a jsfiddle that reproduces the bug: http://jsfiddle.net/salimbensiali/q4Qa5.\n. Any updates on this?\n. ",
    "phoenixsnake": "I think this wasn't a bug\n\"domready\" stage should be fire when \"all DOM is ready for manipulation\"\nbut you inject mootools after document loaded. i think this beyond domready responsibility.\n\nif (document.readyState){\n    if (isStateComplete()) domready();\n    else checks.push(isStateComplete);\n}\n\nthis code can fire domready event once.\nwhat if we dynamic inject the mootools plugins that have it's own window.addEvent( \"domready\", function(){} ); again and again.\nthat event will never be fired too.\nthis use of domready event is special case.\nso i think it user responsibility to remove window.addEvent( \"domready\", function(){} ); manually\n( because inject the code after document is loaded. That's mean the DOM is already ready for manipulation. no need for checking for \"domready\" again )\nBest practise is to add static script tag one by one , so they have no problem.\nadvanced people do dynamic add script tag. advanced people do an special thing.\ni think that include the ability to manually initialize some custom special event too. \nOr consider  use mootools as base framework. load the others script via Asset.javascript, implement onload event\nbut if this feature really should be implement in core.\ni think we could do something with native DOMNodeInserted event.\n( I have tested on IE9, firefox, chrome DOMNodeInserted  work fine )\nheadtag.addEventListener( \"DOMNodeInserted\", function(){\n    //do something\n} );\n\n.\n. I think this wasn't a bug\n\"domready\" stage should be fire when \"all DOM is ready for manipulation\"\nbut you inject mootools after document loaded. i think this beyond domready responsibility.\n\nif (document.readyState){\n    if (isStateComplete()) domready();\n    else checks.push(isStateComplete);\n}\n\nthis code can fire domready event once.\nwhat if we dynamic inject the mootools plugins that have it's own window.addEvent( \"domready\", function(){} ); again and again.\nthat event will never be fired too.\nthis use of domready event is special case.\nso i think it user responsibility to remove window.addEvent( \"domready\", function(){} ); manually\n( because inject the code after document is loaded. That's mean the DOM is already ready for manipulation. no need for checking for \"domready\" again )\nBest practise is to add static script tag one by one , so they have no problem.\nadvanced people do dynamic add script tag. advanced people do an special thing.\ni think that include the ability to manually initialize some custom special event too. \nOr consider  use mootools as base framework. load the others script via Asset.javascript, implement onload event\nbut if this feature really should be implement in core.\ni think we could do something with native DOMNodeInserted event.\n( I have tested on IE9, firefox, chrome DOMNodeInserted  work fine )\nheadtag.addEventListener( \"DOMNodeInserted\", function(){\n    //do something\n} );\n\n.\n. ",
    "diegoflorez": "En firefox 34.0.5 when it reloads the page, the code inside\njavascript\nwindow.addEvent('domready',function(){\n   //code inside\n})\nis never called again, until you close the window/tab and reopen the page. \nIt's imposible to make a jsfiddle to show this behaviour.\nI thinks this is a bug. Because you are trying to reload the page, so the DOM is for a new instance, ready.\nPlease re-open this one.\n. A little improvement to the original addCSSRule function: Basically, it does not add additional cssRules to the same selector, instead it appends the rules to the existing one, and it returns the resulting cssRule.\njavascript\nvar addCSSRule = function(sheet, selector, rules){\n    //Backward searching of the selector matching cssRules\n    var index=sheet.cssRules.length-1;\n    for(var i=index; i>0; i--){\n      var current_style = sheet.cssRules[i];\n      if(current_style.selectorText === selector){\n        //Append the new rules to the current content of the cssRule;\n        rules=current_style.style.cssText + rules;\n        sheet.deleteRule(i);\n        index=i;\n      }\n    }\n    if(sheet.insertRule){\n      sheet.insertRule(selector + \"{\" + rules + \"}\", index);\n    }\n    else{\n      sheet.addRule(selector, rules, index);\n    }\n    return sheet.cssRules[index].cssText;\n  }\n. @GCheung55 You're right!, It is what I should do, so that you could fully understand what I was trying to explain.\n@SergioCrisostomo Following your example, I made a page that reproduces the error. I forgot above, mentioning that the error occurs when MooTools is charged through RequireJS.\nMootools DomReady RequireJS Test\nThank you both! for your replies.\n. Hey Guys, thanks for all your work.\nIt works Perfect! for the domready problem.\nBut now It throws this error: \"TypeError: window is null\".\n. @SergioCrisostomo I have just made the change that you have suggested in fix-2682 to the mootools-core-5.1 no compat. Remove the line 6033 and Add from 6034 to 6038.\nThe line 6065 throws this error message: \"TypeError: window is null\" in Firefox 37; and this one: \"Uncaught TypeError: Cannot read property 'addEvent' of null\" in Chromium 41. \nYou can see that behaviour here: http://diegoflorez.com/workspace/mootools.test/dom.ready.test.html\nThe same version of mootools-core-5.1 without the fix, doesn't throw any error message.\nThanks for your work and effort.\n. [Opening Again]\nI have run 2 extra tests to this fix:\nI have replaced the Mootools domReady and I have used the requireJS domReady, \n1. when using mootools.core.1.5.1.js it works perfect, \n(as you can see here: http://diegoflorez.com/workspace/mootools.test/dom.ready.test.html)\n2. but when using mootools.core.1.5.1.fix-2682.js throws the error message \"TypeError: window is null\"\n(as you can see here: http://diegoflorez.com/workspace/mootools.test/dom.ready.fix-2682.test.html)\n. En firefox 34.0.5 when it reloads the page, the code inside\njavascript\nwindow.addEvent('domready',function(){\n   //code inside\n})\nis never called again, until you close the window/tab and reopen the page. \nIt's imposible to make a jsfiddle to show this behaviour.\nI thinks this is a bug. Because you are trying to reload the page, so the DOM is for a new instance, ready.\nPlease re-open this one.\n. A little improvement to the original addCSSRule function: Basically, it does not add additional cssRules to the same selector, instead it appends the rules to the existing one, and it returns the resulting cssRule.\njavascript\nvar addCSSRule = function(sheet, selector, rules){\n    //Backward searching of the selector matching cssRules\n    var index=sheet.cssRules.length-1;\n    for(var i=index; i>0; i--){\n      var current_style = sheet.cssRules[i];\n      if(current_style.selectorText === selector){\n        //Append the new rules to the current content of the cssRule;\n        rules=current_style.style.cssText + rules;\n        sheet.deleteRule(i);\n        index=i;\n      }\n    }\n    if(sheet.insertRule){\n      sheet.insertRule(selector + \"{\" + rules + \"}\", index);\n    }\n    else{\n      sheet.addRule(selector, rules, index);\n    }\n    return sheet.cssRules[index].cssText;\n  }\n. @GCheung55 You're right!, It is what I should do, so that you could fully understand what I was trying to explain.\n@SergioCrisostomo Following your example, I made a page that reproduces the error. I forgot above, mentioning that the error occurs when MooTools is charged through RequireJS.\nMootools DomReady RequireJS Test\nThank you both! for your replies.\n. Hey Guys, thanks for all your work.\nIt works Perfect! for the domready problem.\nBut now It throws this error: \"TypeError: window is null\".\n. @SergioCrisostomo I have just made the change that you have suggested in fix-2682 to the mootools-core-5.1 no compat. Remove the line 6033 and Add from 6034 to 6038.\nThe line 6065 throws this error message: \"TypeError: window is null\" in Firefox 37; and this one: \"Uncaught TypeError: Cannot read property 'addEvent' of null\" in Chromium 41. \nYou can see that behaviour here: http://diegoflorez.com/workspace/mootools.test/dom.ready.test.html\nThe same version of mootools-core-5.1 without the fix, doesn't throw any error message.\nThanks for your work and effort.\n. [Opening Again]\nI have run 2 extra tests to this fix:\nI have replaced the Mootools domReady and I have used the requireJS domReady, \n1. when using mootools.core.1.5.1.js it works perfect, \n(as you can see here: http://diegoflorez.com/workspace/mootools.test/dom.ready.test.html)\n2. but when using mootools.core.1.5.1.fix-2682.js throws the error message \"TypeError: window is null\"\n(as you can see here: http://diegoflorez.com/workspace/mootools.test/dom.ready.fix-2682.test.html)\n. ",
    "philipzae": "Mootools 1.4.5\nuser agent IE  8 - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) ; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET4.0C; .NET4.0E)\nuser agent IE 7 - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) ; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET4.0C; .NET4.0E)\n. after stumbling across < http://www.javascriptkit.com/javatutors/objdetect3.shtml >, i believe mootools must be using document.documentMode to determine the browser version, when the property should be used to determine what IE mode the page is being rendered in. I was always getting 5 likely because the only thing on the page i was testing this on, only contains a < script > tag.\n. well it wont be the first time a browser lies to us about what it is or the last. :) in my case i am writing a browser sniffer where whats important to me is the browser version and not what mode the page is rendered in.\nWell i did some more reading up on it and this page < http://www.pinlady.net/PluginDetect/IE/ > explains it all.\nwell i pulled this code from < http://stackoverflow.com/questions/10278161/probe-clientcaps-with-javascript >, just incase this issue is ever looked over again.\nvar b = document.getElementsByTagName(\"body\")[0];\nvar s = document.createElement(\"div\");\ns.innerHTML=\"<div style='behavior:url(#default#clientCaps)' ID='oClientCaps' ></div>\";\nb.appendChild(s);\nif ( typeof(oClientCaps) != \"undefined\" && typeof(oClientCaps.id) != \"undefined\" && typeof(oClientCaps.getComponentVersion) != \"undefined\" ) {\n   var ie_version = parseFloat( oClientCaps.getComponentVersion(\"{89820200-ECBD-11CF-8B85-00AA005B4383}\",\"ComponentID\").replace( \",\", \".\" ) );\n}\n. Mootools 1.4.5\nuser agent IE  8 - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) ; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET4.0C; .NET4.0E)\nuser agent IE 7 - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) ; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET4.0C; .NET4.0E)\n. after stumbling across < http://www.javascriptkit.com/javatutors/objdetect3.shtml >, i believe mootools must be using document.documentMode to determine the browser version, when the property should be used to determine what IE mode the page is being rendered in. I was always getting 5 likely because the only thing on the page i was testing this on, only contains a < script > tag.\n. well it wont be the first time a browser lies to us about what it is or the last. :) in my case i am writing a browser sniffer where whats important to me is the browser version and not what mode the page is rendered in.\nWell i did some more reading up on it and this page < http://www.pinlady.net/PluginDetect/IE/ > explains it all.\nwell i pulled this code from < http://stackoverflow.com/questions/10278161/probe-clientcaps-with-javascript >, just incase this issue is ever looked over again.\nvar b = document.getElementsByTagName(\"body\")[0];\nvar s = document.createElement(\"div\");\ns.innerHTML=\"<div style='behavior:url(#default#clientCaps)' ID='oClientCaps' ></div>\";\nb.appendChild(s);\nif ( typeof(oClientCaps) != \"undefined\" && typeof(oClientCaps.id) != \"undefined\" && typeof(oClientCaps.getComponentVersion) != \"undefined\" ) {\n   var ie_version = parseFloat( oClientCaps.getComponentVersion(\"{89820200-ECBD-11CF-8B85-00AA005B4383}\",\"ComponentID\").replace( \",\", \".\" ) );\n}\n. ",
    "stefanKuijers": "As I do not seem to be able to reproduce what I was so sure of yesterday, consider this issue closed. Next time I will first work out a test case.\n(I do agree about class names)\nHappy coding!\n. As I do not seem to be able to reproduce what I was so sure of yesterday, consider this issue closed. Next time I will first work out a test case.\n(I do agree about class names)\nHappy coding!\n. ",
    "lerous": "Seems the clientWidth and clientHeight both equal 0 on firefox, and the method don't check the value before return it.\nI read the method getWidthOrHeight from jquery 1.7.2 and 1.8.3, the value \"fall back to computed css if necessary\" when it is equal zero or null.\nAlso found another bug from buzilla:\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=491668\nWe need more determination in Element.Dimensions, deal with the unreliable values and that's not only the getSize method.\n. Seems the clientWidth and clientHeight both equal 0 on firefox, and the method don't check the value before return it.\nI read the method getWidthOrHeight from jquery 1.7.2 and 1.8.3, the value \"fall back to computed css if necessary\" when it is equal zero or null.\nAlso found another bug from buzilla:\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=491668\nWe need more determination in Element.Dimensions, deal with the unreliable values and that's not only the getSize method.\n. ",
    "donatj": "I added a $35 bounty on Bountysource if anyones interested. I'd really like this to work as I need it.\n. @RiZKiT my testing of the numbers weren't accurate.  I haven't looked into yours yet.\n. I added a $35 bounty on Bountysource if anyones interested. I'd really like this to work as I need it.\n. @RiZKiT my testing of the numbers weren't accurate.  I haven't looked into yours yet.\n. ",
    "MaksJS": "@donatj here's the fix, see the links in the description\n. jquery fallbacks to computed styles so I did\n. @donatj here's the fix, see the links in the description\n. jquery fallbacks to computed styles so I did\n. ",
    "manojnelluri": "Hi @donatj,\nI have did this another way around, not sure if this helps you kindly let me know your feedback.\nconsole.log(getSvgSize($$('svg')[0]));\nand\nfunction getSvgSize(svg)\n{\n     return ($('#result').html().substring($('#result').html().indexOf('width')+7,99)+\",\"+$('#result').html().substring($('#result').html().indexOf('height')+8,114)).split(',');\n}\nNote : Include JQuery library as well.\n\n. Hi @donatj,\nI have did this another way around, not sure if this helps you kindly let me know your feedback.\nconsole.log(getSvgSize($$('svg')[0]));\nand\nfunction getSvgSize(svg)\n{\n     return ($('#result').html().substring($('#result').html().indexOf('width')+7,99)+\",\"+$('#result').html().substring($('#result').html().indexOf('height')+8,114)).split(',');\n}\nNote : Include JQuery library as well.\n\n. ",
    "dbemowsk": "I know this is an old post, but for anyone that stumbles on this, here is the solution.\nchange the following line:\nwindow.addEvent('domready', function(){\nto:\nwindow.addEvent('load', function(){\nThe reason this happens is that the page is not fully loaded and evaluated on \"domready\".  Only when the page fully \"load\"s does the getSize data become available.\n. I know this is an old post, but for anyone that stumbles on this, here is the solution.\nchange the following line:\nwindow.addEvent('domready', function(){\nto:\nwindow.addEvent('load', function(){\nThe reason this happens is that the page is not fully loaded and evaluated on \"domready\".  Only when the page fully \"load\"s does the getSize data become available.\n. ",
    "fselhorst": "This worked for me :\nif (input.value != 't') propertySetters.type = function(node, type){\n    var value = node.value;\n    node.setAttribute(type, value)\n};\n. This worked for me :\nif (input.value != 't') propertySetters.type = function(node, type){\n    var value = node.value;\n    node.setAttribute(type, value)\n};\n. ",
    "WernerWenz": "I've set up a pretty simple test case here:\nhttp://jsfiddle.net/FRLKV/\nThis blows IE8 at\nhttps://github.com/mootools/mootools-core/blob/14a2aaaee57670fe558b40b306e2489adf57cd39/Source/Element/Element.js#L601\nAccording to http://api.jquery.com/attr/ it's default behavior of IE that\ntype attributes for Input Elements become read-only, once the element is in the document.\nAs consequence they disallowed type changes via jQuery on any Browser (see notes).\nIf required, a workaround would most likeley - as initially stated - boil down to reinsert a modified copy of the immutable input.\n. Actually you've already Documented it yourself in your own Docs, that its's an invalid action on IE8 or lower:\nhttp://mootools.net/docs/core/Element/Element#Element:set\nSaying this, I would rather classify this issue as a feature request for the issue rather than a bug.\n. I'm also in need of this sort of functionality.\nKey point is, that it's currently required to replicate the whole Request logic as seen here: \nhttps://github.com/arian/mootools-form-upload/blob/master/Source/Request.File.js\nA solution to this Problem could either be adding a flag as it was suggested,\nor having an automagic variant, that checks the data option for \"instanceof FormData\".\nHaving such a functionality would ultimalty allow us writing such code:\n<form id=\"myform\" action=\"new/data\"><fields for form data here></form>\nvar form=$('myform');\n(new Request.HTML({url: form.getProperty('action'), urlEncoded: false}).send(new FormData(form));\n. Sure no Problem:\nThis is based on @orthecreedence's pull request:\nhttp://jsfiddle.net/LYyLC/3/\nRemoving the new introduced processData will fail the test.\nSo will removing urlEncoded.\nFor convenience of use, I further suggest automagically inferring things as the action url and the method for example from the FormData, in case a FormData is supplied.\nYou might want to open a new ticket for this Sergio?\nEdit: The console.log line was obviously not intended in the fiddle.\n. I've set up a pretty simple test case here:\nhttp://jsfiddle.net/FRLKV/\nThis blows IE8 at\nhttps://github.com/mootools/mootools-core/blob/14a2aaaee57670fe558b40b306e2489adf57cd39/Source/Element/Element.js#L601\nAccording to http://api.jquery.com/attr/ it's default behavior of IE that\ntype attributes for Input Elements become read-only, once the element is in the document.\nAs consequence they disallowed type changes via jQuery on any Browser (see notes).\nIf required, a workaround would most likeley - as initially stated - boil down to reinsert a modified copy of the immutable input.\n. Actually you've already Documented it yourself in your own Docs, that its's an invalid action on IE8 or lower:\nhttp://mootools.net/docs/core/Element/Element#Element:set\nSaying this, I would rather classify this issue as a feature request for the issue rather than a bug.\n. I'm also in need of this sort of functionality.\nKey point is, that it's currently required to replicate the whole Request logic as seen here: \nhttps://github.com/arian/mootools-form-upload/blob/master/Source/Request.File.js\nA solution to this Problem could either be adding a flag as it was suggested,\nor having an automagic variant, that checks the data option for \"instanceof FormData\".\nHaving such a functionality would ultimalty allow us writing such code:\n<form id=\"myform\" action=\"new/data\"><fields for form data here></form>\nvar form=$('myform');\n(new Request.HTML({url: form.getProperty('action'), urlEncoded: false}).send(new FormData(form));\n. Sure no Problem:\nThis is based on @orthecreedence's pull request:\nhttp://jsfiddle.net/LYyLC/3/\nRemoving the new introduced processData will fail the test.\nSo will removing urlEncoded.\nFor convenience of use, I further suggest automagically inferring things as the action url and the method for example from the FormData, in case a FormData is supplied.\nYou might want to open a new ticket for this Sergio?\nEdit: The console.log line was obviously not intended in the fiddle.\n. ",
    "JSchortz": "\nOn the http://mootools.net/docs/core/Request/Request page, change the highlighted sentence to read, \"If you set async to false\".\n. Thanks Olmo!\n. \nOn the http://mootools.net/docs/core/Request/Request page, change the highlighted sentence to read, \"If you set async to false\".\n. Thanks Olmo!\n. ",
    "htaningcojr": "I too need a workaround for this. \nWas there ever a workaround solution done for this?\nI will attempt to replace all Mootools' Type to mooType for my own implementation and see if this should resolve it for the mean time. I don't have the luxury of waiting on fixes from either Microsoft or Mootools.\nI will write back with progress (or otherwise) later.\n. I too need a workaround for this. \nWas there ever a workaround solution done for this?\nI will attempt to replace all Mootools' Type to mooType for my own implementation and see if this should resolve it for the mean time. I don't have the luxury of waiting on fixes from either Microsoft or Mootools.\nI will write back with progress (or otherwise) later.\n. ",
    "kileras": "Hi,\nSorry for the delayed answer but i fixed the (. The issue were in bountysource as you can see https://www.bountysource.com/issues/408721-svg-element-getsize-fails-in-firefox but has been a while and now that you say it it may be better to use get getBoundingClientRect and thats it, ill do it and make some specs as soon as I can.\n. Hi,\nSorry for the delayed answer but i fixed the (. The issue were in bountysource as you can see https://www.bountysource.com/issues/408721-svg-element-getsize-fails-in-firefox but has been a while and now that you say it it may be better to use get getBoundingClientRect and thats it, ill do it and make some specs as soon as I can.\n. ",
    "sitorush": "This is vendor bug. Try add css position (other than static) to the element. http://yagudaev.com/posts/getting-reliable-z-index-cross-browser/\n. This is vendor bug. Try add css position (other than static) to the element. http://yagudaev.com/posts/getting-reliable-z-index-cross-browser/\n. ",
    "holodyn": "@gonchuki This was reported because in Chrome MooTools was returning a different value.  While \"auto\" is a valid value, the zIndex in this case was not \"auto\" in all browsers.  If getStyle is intended to fix inconsistencies as you suggest, then this would be a case where the fix is not taking place  While I appreciate the argument that an incorrectly defined \"position\" may affect output, the MooTools getStyle function should be resolving this conflict.  I believe @sitorush hit the nail on the head.\n. @gonchuki Unfortunately I do not have the original code for testing but I think we're on the same page, just disagree on the conclusion.  In the example from sitorush you can test the conflict in Chrome vs FF or IE.  As you indicate, the position is implicitly \"static\" and Chrome is reporting \"auto\" to the Mootools properly request.  I would argue that regardless the case, getStyle should return the same value in all browsers.  Since FF and IE allow the value to persist, so should Mootools sanitize the value for Chrome.\n. The real crime here is the browsers caching the value differently.  I've created a fiddle that overlays a simple switch on the getStyle function, forcing an \"auto\" result whenever the position is static (inherited or not).\n\nElement.implement('getStyleCore', Element.prototype.getStyle);\nElement.implement('getStyle',function(name){\n    if( String(name).match(/^(z|z-)index/i) \n       && this.getStyleCore('position')=='static' ) \n        return 'auto';\n    return this.getStyleCore(name);\n});\n\n. @gonchuki This was reported because in Chrome MooTools was returning a different value.  While \"auto\" is a valid value, the zIndex in this case was not \"auto\" in all browsers.  If getStyle is intended to fix inconsistencies as you suggest, then this would be a case where the fix is not taking place  While I appreciate the argument that an incorrectly defined \"position\" may affect output, the MooTools getStyle function should be resolving this conflict.  I believe @sitorush hit the nail on the head.\n. @gonchuki Unfortunately I do not have the original code for testing but I think we're on the same page, just disagree on the conclusion.  In the example from sitorush you can test the conflict in Chrome vs FF or IE.  As you indicate, the position is implicitly \"static\" and Chrome is reporting \"auto\" to the Mootools properly request.  I would argue that regardless the case, getStyle should return the same value in all browsers.  Since FF and IE allow the value to persist, so should Mootools sanitize the value for Chrome.\n. The real crime here is the browsers caching the value differently.  I've created a fiddle that overlays a simple switch on the getStyle function, forcing an \"auto\" result whenever the position is static (inherited or not).\n\nElement.implement('getStyleCore', Element.prototype.getStyle);\nElement.implement('getStyle',function(name){\n    if( String(name).match(/^(z|z-)index/i) \n       && this.getStyleCore('position')=='static' ) \n        return 'auto';\n    return this.getStyleCore(name);\n});\n\n. ",
    "Shoplifter": ":+1: according to docs \n\nThe reason to differentiate between 1 and 2 is that 1 is usually used for events that don't have interesting data like: onload, onscroll, and onresize, or it's more performant. The latter two, for example, are fired frequently.\n\nfor timeupdate type 1 should be sufficient, also it is fired frequently\n. thank you for digging into this and providing comprehensive answer.\n. :+1: according to docs \n\nThe reason to differentiate between 1 and 2 is that 1 is usually used for events that don't have interesting data like: onload, onscroll, and onresize, or it's more performant. The latter two, for example, are fired frequently.\n\nfor timeupdate type 1 should be sufficient, also it is fired frequently\n. thank you for digging into this and providing comprehensive answer.\n. ",
    "jmarikle": "@ibolmo I apologize, but I don't know where those specs would be added.  I See that some values are checked throughout this file but I don't see a consolidated location or standard method for such checks.  I looked at a few of the surrounding files too but found nothing.  Could you possibly point me to where a fill support check should be added?\n. @ibolmo I apologize, but I don't know where those specs would be added.  I See that some values are checked throughout this file but I don't see a consolidated location or standard method for such checks.  I looked at a few of the surrounding files too but found nothing.  Could you possibly point me to where a fill support check should be added?\n. ",
    "ickata": "http://jsfiddle.net/p9QcY/\nThe reason I did not resolve this problem myself and make a pull request is that I'm not sure how exactly this problem should be resolved, and if it needs resolution anyway.\nThe problem is that MooTools thinks the <select> element is enum. The framework checks for a length property, and indeed all  elements have this property. It's value depends on how many  elements the  owns. So MooTools threats the <select> as Array, and surprisingly, if you execute Array.prototype.slice.call( select_element ) you will get an array with all <option> elements.\n. Yes, this is exactly what I meant in my reply above. \nI think we should close this one with \"wontfix\" resolution.\n. I'm not sure MooTools should provide a solution. It's a core browser issue. Technically speaking, for the browser a select element is enumerable. It's an array-like object, just like NodeList, Arguments, etc.\nArray.prototype.push.call( $('select'), new Element('option', { text : 4 }) ); // works like a charm - new option element is injected to the select\n. OK, but isn't Browser.ie deprecated?\n. Since when modern browsers have native mouseenter/mouseleave? Looks like I missed that. My bad.\n. I agree, but I don't think MooTools should fix Webkit bugs. Even though one of it's purposes is to provide standardized browser API - browser bugs must be fixed within the browser. \nI will shoot a bug report in Webkit bug tracker. However - from all bugs I've submitted there within the recent years, noone was fixed...\n. AmatanHead: Yes, the idea was that limit param to be infinite by default.\nibolmo: I get your point, and in theory you are 100% right. The problem is that sometimes you can't stick 100% to OOP principles. Sometimes there are cases where going beyond the borders of encapsulation gives you more performance and even more elegant solution. I agree that nested objects \"understanding\" from the parent environment is a bad practice - but as I said - there are cases where this approach much simplifies business logic and provides elegant solution. I'm giving you a simple example - event delegation. I delegate click handler to the <body>, looking for specific anchor tags as targets. But what about cases where there are nested <span> elements in the anchor? They will be the event target then, and how do I get my anchor element? Of course with a getParent(). But wait - what if I don't have anchor up the tree? getParent continues to traverse up to the document. What if the user clicks like there's no tomorrow? I get performance penalty. \nanutron: Definitely this feature will be used very rarely. But since this was the 4th or 5th time I require this functionality (in environment which is big hundred thousands lines of JS), I thought that it would be nice to have it in the framework. After all, it would have been OPTIONAL, infinite by default, and all methods would continue to work as before. The change in the source code also seemed to be very tiny and wouldn't affect filesize or overcomplicated the source. \nAnyway - I understand your point guys. You have the right to accept or reject a proposal. I just had to bring my arguments on the table, so you don't think that \"someone just proposed us a pointless improvement\". Yes - we're definitely pushing the framework to the edge, and yes - I will continue to make suggestions, fix bugs, and contribute to the framework with anything I can :)\n. What would your answer be if I told you, that you don't have full control over the markup? There are cases where this markup may be generated inside WYSIWYG editor, where the advanced user can even put custom snippets of HTML...\nAlso, I didn't get your remark. How do you see delegating click event in your example?\n. Guys, let me know if you think this one is worth fixing, so I can make a pull request.\n. I agree with your note about setOptions, but believe me - this is something that I cannot avoid.\nYou don't have any way to access any object from another domain except window and some of its properties. That's why my proposal for fix is the following - add a new line right after line 33: https://github.com/mootools/mootools-core/blob/master/Source/Core/Core.js#L33\nif (item.location && item.parent && item.self && item.top && (item.opener === null || item.opener)) return 'window';\n. I think it is more safe to check for all properties that the cross-domain restriction allows us. These are \"location\", \"parent\", \"self\", \"top\" and \"opener\". The more properties we check for, the better chance we have not to detect some regular object as window.\n. Um, .. the pull-request is here: https://github.com/mootools/mootools-core/pull/2663\nSorry but I don't get this...\n. 1. Agree with the bug detection approach, but this will be more heavy & will slow-down the framework bootstrap.\n2. Limit thing is not weird at all - consider having a DOM-heavy environment with thousands of nested elements - in case getParent does not match anything it will traverse up to document, which will be very slow.\n3. I can think in that direction, however, the guys decided that this won't be fixed, so it is not worth spending any more time on this. I have a local patch of this issue on my system - well, it would be better if the framework was dealing with this issue instead of me ugly patching it...\n. http://jsfiddle.net/p9QcY/\nThe reason I did not resolve this problem myself and make a pull request is that I'm not sure how exactly this problem should be resolved, and if it needs resolution anyway.\nThe problem is that MooTools thinks the <select> element is enum. The framework checks for a length property, and indeed all  elements have this property. It's value depends on how many  elements the  owns. So MooTools threats the <select> as Array, and surprisingly, if you execute Array.prototype.slice.call( select_element ) you will get an array with all <option> elements.\n. Yes, this is exactly what I meant in my reply above. \nI think we should close this one with \"wontfix\" resolution.\n. I'm not sure MooTools should provide a solution. It's a core browser issue. Technically speaking, for the browser a select element is enumerable. It's an array-like object, just like NodeList, Arguments, etc.\nArray.prototype.push.call( $('select'), new Element('option', { text : 4 }) ); // works like a charm - new option element is injected to the select\n. OK, but isn't Browser.ie deprecated?\n. Since when modern browsers have native mouseenter/mouseleave? Looks like I missed that. My bad.\n. I agree, but I don't think MooTools should fix Webkit bugs. Even though one of it's purposes is to provide standardized browser API - browser bugs must be fixed within the browser. \nI will shoot a bug report in Webkit bug tracker. However - from all bugs I've submitted there within the recent years, noone was fixed...\n. AmatanHead: Yes, the idea was that limit param to be infinite by default.\nibolmo: I get your point, and in theory you are 100% right. The problem is that sometimes you can't stick 100% to OOP principles. Sometimes there are cases where going beyond the borders of encapsulation gives you more performance and even more elegant solution. I agree that nested objects \"understanding\" from the parent environment is a bad practice - but as I said - there are cases where this approach much simplifies business logic and provides elegant solution. I'm giving you a simple example - event delegation. I delegate click handler to the <body>, looking for specific anchor tags as targets. But what about cases where there are nested <span> elements in the anchor? They will be the event target then, and how do I get my anchor element? Of course with a getParent(). But wait - what if I don't have anchor up the tree? getParent continues to traverse up to the document. What if the user clicks like there's no tomorrow? I get performance penalty. \nanutron: Definitely this feature will be used very rarely. But since this was the 4th or 5th time I require this functionality (in environment which is big hundred thousands lines of JS), I thought that it would be nice to have it in the framework. After all, it would have been OPTIONAL, infinite by default, and all methods would continue to work as before. The change in the source code also seemed to be very tiny and wouldn't affect filesize or overcomplicated the source. \nAnyway - I understand your point guys. You have the right to accept or reject a proposal. I just had to bring my arguments on the table, so you don't think that \"someone just proposed us a pointless improvement\". Yes - we're definitely pushing the framework to the edge, and yes - I will continue to make suggestions, fix bugs, and contribute to the framework with anything I can :)\n. What would your answer be if I told you, that you don't have full control over the markup? There are cases where this markup may be generated inside WYSIWYG editor, where the advanced user can even put custom snippets of HTML...\nAlso, I didn't get your remark. How do you see delegating click event in your example?\n. Guys, let me know if you think this one is worth fixing, so I can make a pull request.\n. I agree with your note about setOptions, but believe me - this is something that I cannot avoid.\nYou don't have any way to access any object from another domain except window and some of its properties. That's why my proposal for fix is the following - add a new line right after line 33: https://github.com/mootools/mootools-core/blob/master/Source/Core/Core.js#L33\nif (item.location && item.parent && item.self && item.top && (item.opener === null || item.opener)) return 'window';\n. I think it is more safe to check for all properties that the cross-domain restriction allows us. These are \"location\", \"parent\", \"self\", \"top\" and \"opener\". The more properties we check for, the better chance we have not to detect some regular object as window.\n. Um, .. the pull-request is here: https://github.com/mootools/mootools-core/pull/2663\nSorry but I don't get this...\n. 1. Agree with the bug detection approach, but this will be more heavy & will slow-down the framework bootstrap.\n2. Limit thing is not weird at all - consider having a DOM-heavy environment with thousands of nested elements - in case getParent does not match anything it will traverse up to document, which will be very slow.\n3. I can think in that direction, however, the guys decided that this won't be fixed, so it is not worth spending any more time on this. I have a local patch of this issue on my system - well, it would be better if the framework was dealing with this issue instead of me ugly patching it...\n. ",
    "imbibinebe": "It was just a suggestion. Anyway, having to write things like getParent().getParent().getPrevious().getPrevious().getPrevious() is typical of a bad conception to my opinion\n. Thanks for your detailed answer ! I agree\n. Except that this regexp should not match this string and that you forgot * char in the regexp. If you test on the website i gave you should see that this string should not be matched.\nAnyway, i made a jsfiddle with your example and the good regexp and it seems to match this string as well. I don't understand why :(\n. http://jsfiddle.net/imbibinebe/48vyk/4/\n. uhmmm i understand now ... sorry for my mistake and @megawac, sorry as well, i forgot to use the code markup and all my special chars disapeared ...\nThis means that i should use\nmy_string.test('^(0|([1-9][0-9](\\\\.[0-9]|,[0-9])?|0(\\\\.[0-9]|,[0-9]))[0-9]*)$', 'i')\nor\nmy_string.test(/^(0|([1-9][0-9](\\.[0-9]|,[0-9])?|0(\\.[0-9]|,[0-9]))[0-9]*)$/i)\ninstead of \nmy_string.test('^(0|([1-9][0-9](\\.[0-9]|,[0-9])?|0(\\.[0-9]|,[0-9]))[0-9]*)$', 'i')\nin order to have the same match than\nmy_string.match(/^(0|([1-9][0-9]*(\\.[0-9]|,[0-9])?|0(\\.[0-9]|,[0-9]))[0-9]*)$/i)\nThanks for your help !\n. Thank you Yannick ! It's now working perfectly !\n. It was just a suggestion. Anyway, having to write things like getParent().getParent().getPrevious().getPrevious().getPrevious() is typical of a bad conception to my opinion\n. Thanks for your detailed answer ! I agree\n. Except that this regexp should not match this string and that you forgot * char in the regexp. If you test on the website i gave you should see that this string should not be matched.\nAnyway, i made a jsfiddle with your example and the good regexp and it seems to match this string as well. I don't understand why :(\n. http://jsfiddle.net/imbibinebe/48vyk/4/\n. uhmmm i understand now ... sorry for my mistake and @megawac, sorry as well, i forgot to use the code markup and all my special chars disapeared ...\nThis means that i should use\nmy_string.test('^(0|([1-9][0-9](\\\\.[0-9]|,[0-9])?|0(\\\\.[0-9]|,[0-9]))[0-9]*)$', 'i')\nor\nmy_string.test(/^(0|([1-9][0-9](\\.[0-9]|,[0-9])?|0(\\.[0-9]|,[0-9]))[0-9]*)$/i)\ninstead of \nmy_string.test('^(0|([1-9][0-9](\\.[0-9]|,[0-9])?|0(\\.[0-9]|,[0-9]))[0-9]*)$', 'i')\nin order to have the same match than\nmy_string.match(/^(0|([1-9][0-9]*(\\.[0-9]|,[0-9])?|0(\\.[0-9]|,[0-9]))[0-9]*)$/i)\nThanks for your help !\n. Thank you Yannick ! It's now working perfectly !\n. ",
    "longwolf": "Hello Sergio,\nnope, I was completely serious. Sorry for not watching it further. But \nour client seems to have found a way to work around it meanwhile.\nAm 10.01.2014 13:16, schrieb Sergio Crisostomo:\n\n@longwolf https://github.com/longwolf could you make a fiddle \nrecreating this issue?\n\u2014\nReply to this email directly or view it on GitHub \nhttps://github.com/mootools/mootools-core/issues/2533#issuecomment-32022930.\n. Hello Sergio,\n\nnope, I was completely serious. Sorry for not watching it further. But \nour client seems to have found a way to work around it meanwhile.\nAm 10.01.2014 13:16, schrieb Sergio Crisostomo:\n\n@longwolf https://github.com/longwolf could you make a fiddle \nrecreating this issue?\n\u2014\nReply to this email directly or view it on GitHub \nhttps://github.com/mootools/mootools-core/issues/2533#issuecomment-32022930.\n. \n",
    "fowlerj": "Could we detect navigator.appName of 'netscape' and 'trident' in the navigator.userAgent and assume Browser.version 11 and Browser.ie true? \n. Could we detect navigator.appName of 'netscape' and 'trident' in the navigator.userAgent and assume Browser.version 11 and Browser.ie true? \n. ",
    "TheShrike": "A live example:\nhttp://jsbin.com/iPObOxa/1/\nThe problem is document.body, if you try to use $(document.body) it works fine:\nhttp://jsbin.com/iPObOxa/2/\n. Same problem in IE 9.\nIE set the checkbox value=\"\" if not specified; if you set value: 'on' all works in IE too:\nhttp://jsfiddle.net/mcwrv/3/\n. A live example:\nhttp://jsbin.com/iPObOxa/1/\nThe problem is document.body, if you try to use $(document.body) it works fine:\nhttp://jsbin.com/iPObOxa/2/\n. Same problem in IE 9.\nIE set the checkbox value=\"\" if not specified; if you set value: 'on' all works in IE too:\nhttp://jsfiddle.net/mcwrv/3/\n. ",
    "mrpapercut": "That is indeed a workaround for IE, but not a fix. Especially when the inconsistency shows between created elements via the Element constructor and their predefined HTML equivalents.\nThe default value of a checkbox should be 'on' if not overwritten (http://www.whatwg.org/specs/web-apps/current-work/#dom-input-value-default-on), and IE is not following the specification on this one on element creation. Mootools should catch it though, or add 'on' as default value when creating a new checkbox.\n. That is indeed a workaround for IE, but not a fix. Especially when the inconsistency shows between created elements via the Element constructor and their predefined HTML equivalents.\nThe default value of a checkbox should be 'on' if not overwritten (http://www.whatwg.org/specs/web-apps/current-work/#dom-input-value-default-on), and IE is not following the specification on this one on element creation. Mootools should catch it though, or add 'on' as default value when creating a new checkbox.\n. ",
    "curry684": "It is important that this fix is implemented in a new release soon - the missing IE11 detection makes some of the Measure codes fall back into quirks mode, thus reporting wrong values for size (including padding where it shouldn't). We've had to put some weird as hell patches for this into our local JS to fix bugs that were only popping up in IE11.\n. I can confirm the bug is squashed in current nightlies. I have set up the test case here: http://test.omines.net/mootools-ie11/\nIn all browsers except IE11 the columns size up correctly in both frames. In IE11 the one based on currently stable Core+More is off by the padding of the elements - they are equally sized in nightly.\nAs said, I'd recommend making a new stable release with this fix soon - it's not like IE11 has only been released last week  :)\n. It is important that this fix is implemented in a new release soon - the missing IE11 detection makes some of the Measure codes fall back into quirks mode, thus reporting wrong values for size (including padding where it shouldn't). We've had to put some weird as hell patches for this into our local JS to fix bugs that were only popping up in IE11.\n. I can confirm the bug is squashed in current nightlies. I have set up the test case here: http://test.omines.net/mootools-ie11/\nIn all browsers except IE11 the columns size up correctly in both frames. In IE11 the one based on currently stable Core+More is off by the padding of the elements - they are equally sized in nightly.\nAs said, I'd recommend making a new stable release with this fix soon - it's not like IE11 has only been released last week  :)\n. ",
    "cocapiznut": "Thanks for your quick reply! \nI modifed this fiddle:\nhttp://jsfiddle.net/eKn4u/2/ \nIf you try with getLast(), you will\nreceive the alert... with getFirst you will not receive; \nI thick\nbecause there is only one element inside the last \"li\". \nkind regards,\nAmilcare. \nIl 19.01.2014 15:43 Sergio Crisostomo ha scritto: \n\n@cocapiznut [1] , not clear what you mean. Could you check this fiddle:\nhttp://jsfiddle.net/eKn4u/ [2] ? \nCan you reproduce your problem in\na fiddle and post back? \n\nReply to this email directly or view\nit on GitHub [3].\n\nScopri istella, il nuovo motore per il web italiano.\nIstella garantisce risultati di qualit\u00e0 e la possibilit\u00e0 di condividere,\nin modo semplice e veloce, documenti, immagini, audio e video.\n Usa\nistella, vai su http://www.istella.it?wtk=amc138614816829636\n[4]\nLinks:\n[1] https://github.com/cocapiznut\n[2]\nhttp://jsfiddle.net/eKn4u/\n[3]\nhttps://github.com/mootools/mootools-core/issues/2552#issuecomment-32709779\n[4]\nhttp://www.istella.it?wtk=amc138614816829636\nScopri istella, il nuovo motore per il web italiano.\nIstella garantisce risultati di qualit\u00e0 e la possibilit\u00e0 di condividere, in modo semplice e veloce, documenti, immagini, audio e video.\nUsa istella, vai su http://www.istella.it?wtk=amc138614816829636\n. COOL!! :) \nThanks for the reply... very detailed. \nCongratulation\nfor the service support. \nBest regards, \nAmilcare. \nIl 20.01.2014\n13:10 Arian Stolwijk ha scritto: \n\nThis is because $$ returns a\ncollection of elements. getFirst map over that collection and will\nexecute getFirst for each item of the collection. This means it will\nreturn [$$('.lastItem')[0].getFirst()] in this case. The li doesn't have\nany children, so the result is [null]. Then you try to call get on this\narray, and that method doesn't exist, because it isn't a Elements\ncollection anymore. \nThe reason why getLast works, is because on an\nelements collection, methods of Array get the precedence over methods\ncoming from Element. So in this case getLast will return the last item\nor the collection, which is the single div.lastItem element. And that\nobject does have the .get method, so alerts the text. \n\nReply\nto this email directly or view it on GitHub [1].\n\nScopri istella, il\nnuovo motore per il web italiano.\n Istella garantisce risultati di\nqualit\u00e0 e la possibilit\u00e0 di condividere, in modo semplice e veloce,\ndocumenti, immagini, audio e video.\n Usa istella, vai su\nhttp://www.istella.it?wtk=amc138614816829636 [2]\nLinks:\n[1]\nhttps://github.com/mootools/mootools-core/issues/2552#issuecomment-32754513\n[2]\nhttp://www.istella.it?wtk=amc138614816829636\nScopri istella, il nuovo motore per il web italiano.\nIstella garantisce risultati di qualit\u00e0 e la possibilit\u00e0 di condividere, in modo semplice e veloce, documenti, immagini, audio e video.\nUsa istella, vai su http://www.istella.it?wtk=amc138614816829636\n. Thanks for your quick reply! \nI modifed this fiddle:\nhttp://jsfiddle.net/eKn4u/2/ \nIf you try with getLast(), you will\nreceive the alert... with getFirst you will not receive; \nI thick\nbecause there is only one element inside the last \"li\". \nkind regards,\nAmilcare. \nIl 19.01.2014 15:43 Sergio Crisostomo ha scritto: \n\n@cocapiznut [1] , not clear what you mean. Could you check this fiddle:\nhttp://jsfiddle.net/eKn4u/ [2] ? \nCan you reproduce your problem in\na fiddle and post back? \n\nReply to this email directly or view\nit on GitHub [3].\n\nScopri istella, il nuovo motore per il web italiano.\nIstella garantisce risultati di qualit\u00e0 e la possibilit\u00e0 di condividere,\nin modo semplice e veloce, documenti, immagini, audio e video.\n Usa\nistella, vai su http://www.istella.it?wtk=amc138614816829636\n[4]\nLinks:\n[1] https://github.com/cocapiznut\n[2]\nhttp://jsfiddle.net/eKn4u/\n[3]\nhttps://github.com/mootools/mootools-core/issues/2552#issuecomment-32709779\n[4]\nhttp://www.istella.it?wtk=amc138614816829636\nScopri istella, il nuovo motore per il web italiano.\nIstella garantisce risultati di qualit\u00e0 e la possibilit\u00e0 di condividere, in modo semplice e veloce, documenti, immagini, audio e video.\nUsa istella, vai su http://www.istella.it?wtk=amc138614816829636\n. COOL!! :) \nThanks for the reply... very detailed. \nCongratulation\nfor the service support. \nBest regards, \nAmilcare. \nIl 20.01.2014\n13:10 Arian Stolwijk ha scritto: \n\nThis is because $$ returns a\ncollection of elements. getFirst map over that collection and will\nexecute getFirst for each item of the collection. This means it will\nreturn [$$('.lastItem')[0].getFirst()] in this case. The li doesn't have\nany children, so the result is [null]. Then you try to call get on this\narray, and that method doesn't exist, because it isn't a Elements\ncollection anymore. \nThe reason why getLast works, is because on an\nelements collection, methods of Array get the precedence over methods\ncoming from Element. So in this case getLast will return the last item\nor the collection, which is the single div.lastItem element. And that\nobject does have the .get method, so alerts the text. \n\nReply\nto this email directly or view it on GitHub [1].\n\nScopri istella, il\nnuovo motore per il web italiano.\n Istella garantisce risultati di\nqualit\u00e0 e la possibilit\u00e0 di condividere, in modo semplice e veloce,\ndocumenti, immagini, audio e video.\n Usa istella, vai su\nhttp://www.istella.it?wtk=amc138614816829636 [2]\nLinks:\n[1]\nhttps://github.com/mootools/mootools-core/issues/2552#issuecomment-32754513\n[2]\nhttp://www.istella.it?wtk=amc138614816829636\nScopri istella, il nuovo motore per il web italiano.\nIstella garantisce risultati di qualit\u00e0 e la possibilit\u00e0 di condividere, in modo semplice e veloce, documenti, immagini, audio e video.\nUsa istella, vai su http://www.istella.it?wtk=amc138614816829636\n. ",
    "platjen": "jsFiddle:\nhttp://jsfiddle.net/platjen/xSv4A/6/\n. jsFiddle:\nhttp://jsfiddle.net/platjen/xSv4A/6/\n. ",
    "foolip": "The discussion in a similar pull request for Sizzle may be of interest: https://github.com/jquery/sizzle/pull/251\n. Ping?\n. Awesome, thanks!\n. The discussion in a similar pull request for Sizzle may be of interest: https://github.com/jquery/sizzle/pull/251\n. Ping?\n. Awesome, thanks!\n. ",
    "szegheo": "When should we expect 1.5.1 to be released with this fix?\n. When should we expect 1.5.1 to be released with this fix?\n. ",
    "ezmiller": "Got it! And thank you for the clarification. \n. Got it! And thank you for the clarification. \n. ",
    "giann": "So how can we distinct scroll from scroll down ?\n. So how can we distinct scroll from scroll down ?\n. ",
    "PanzerKunst": "I can't really test the server-side right now, but since iOS has amazing debugging tools when you have a Mac, this is what I could extract from xhr argument of onFailure:\nconstructor: XMLHttpRequestConstructor\nonabort: null\nonerror: null\nonload: null\nonloadend: null\nonloadstart: function () {}\nonprogress: function () {}\nonreadystatechange: function () {}\nontimeout: null\nreadyState: 4\nresponse: \"\u21b5\u21b5<!DOCTYPE html>\u21b5<html>\u21b5    <head>\u21b5       <title>Bad request</title>\u21b5       <link rel=\"shortcut icon\" href=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAlFJREFUeNqUU8tOFEEUPVVdNV3dPe8xYRBnjGhmBgKjKzCIiQvBoIaNbly5Z+PSv3Aj7DSiP2B0rwkLGVdGgxITSCRIJGSMEQWZR3eVt5sEFBgTb/dN1yvnnHtPNTPG4PqdHgCMXnPRSZrpSuH8vUJu4DE4rYHDGAZDX62BZttHqTiIayM3gGiXQsgYLEvATaqxU+dy1U13YXapXptpNHY8iwn8KyIAzm1KBdtRZWErpI5lEWTXp5Z/vHpZ3/wyKKwYGGOdAYwR0EZwoezTYApBEIObyELl/aE1/83cp40Pt5mxqCKrE4Ck+mVWKKcI5tA8BLEhRBKJLjez6a7MLq7XZtp+yyOawwCBtkiBVZDKzRk4NN7NQBMYPHiZDFhXY+p9ff7F961vVcnl4R5I2ykJ5XFN7Ab7Gc61VoipNBKF+PDyztu5lfrSLT/wIwCxq0CAGtXHZTzqR2jtwQiXONma6hHpj9sLT7YaPxfTXuZdBGA02Wi7FS48YiTfj+i2NhqtdhP5RC8mh2/Op7y0v6eAcWVLFT8D7kWX5S9mepp+C450MV6aWL1cGnvkxbwHtLW2B9AOkLeUd9KEDuh9fl/7CEj7YH5g+3r/lWfF9In7tPz6T4IIwBJOr1SJyIGQMZQbsh5P9uBq5VJtqHh2mo49pdw5WFoEwKWqWHacaWOjQXWGcifKo6vj5RGS6zykI587XeUIQDqJSmAp+lE4qt19W5P9o8+Lma5DcjsC8JiT607lMVkdqQ0Vyh3lHhmh52tfNy78ajXv0rgYzv8nfwswANuk+7sD/Q0aAAAAAElFTkSuQmCC\">\u21b5     <style>\u21b5          html, body, pre {\u21b5                margin: 0;\u21b5               padding: 0;\u21b5              font-family: Monaco, 'Lucida Console', monospace;\u21b5                background: #ECECEC;\u21b5         }\u21b5            h1 {\u21b5             margin: 0;\u21b5               background: #AD632A;\u21b5             padding: 20px 45px;\u21b5              color: #fff;\u21b5             text-shadow: 1px 1px 1px rgba(0,0,0,.3);\u21b5             border-bottom: 1px solid #9F5805;\u21b5                font-size: 28px;\u21b5         }\u21b5            p#detail {\u21b5               margin: 0;\u21b5               padding: 15px 45px;\u21b5              background: #F6A960;\u21b5             border-top: 4px solid #D29052;\u21b5               color: #733512;\u21b5              text-shadow: 1px 1px 1px rgba(255,255,255,.3);\u21b5               font-size: 14px;\u21b5             border-bottom: 1px solid #BA7F5B;\u21b5            }\u21b5        </style>\u21b5 </head>\u21b5  <body>\u21b5       <h1>Bad request</h1>\u21b5\u21b5      <p id=\"detail\">\u21b5          For request 'DELETE /api/reports/21' [Invalid XML]\u21b5       </p>\u21b5\u21b5  </body>\u21b5</html>\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\"\nresponseText: \"\u21b5\u21b5<!DOCTYPE html>\u21b5<html>\u21b5    <head>\u21b5       <title>Bad request</title>\u21b5       <link rel=\"shortcut icon\" href=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAlFJREFUeNqUU8tOFEEUPVVdNV3dPe8xYRBnjGhmBgKjKzCIiQvBoIaNbly5Z+PSv3Aj7DSiP2B0rwkLGVdGgxITSCRIJGSMEQWZR3eVt5sEFBgTb/dN1yvnnHtPNTPG4PqdHgCMXnPRSZrpSuH8vUJu4DE4rYHDGAZDX62BZttHqTiIayM3gGiXQsgYLEvATaqxU+dy1U13YXapXptpNHY8iwn8KyIAzm1KBdtRZWErpI5lEWTXp5Z/vHpZ3/wyKKwYGGOdAYwR0EZwoezTYApBEIObyELl/aE1/83cp40Pt5mxqCKrE4Ck+mVWKKcI5tA8BLEhRBKJLjez6a7MLq7XZtp+yyOawwCBtkiBVZDKzRk4NN7NQBMYPHiZDFhXY+p9ff7F961vVcnl4R5I2ykJ5XFN7Ab7Gc61VoipNBKF+PDyztu5lfrSLT/wIwCxq0CAGtXHZTzqR2jtwQiXONma6hHpj9sLT7YaPxfTXuZdBGA02Wi7FS48YiTfj+i2NhqtdhP5RC8mh2/Op7y0v6eAcWVLFT8D7kWX5S9mepp+C450MV6aWL1cGnvkxbwHtLW2B9AOkLeUd9KEDuh9fl/7CEj7YH5g+3r/lWfF9In7tPz6T4IIwBJOr1SJyIGQMZQbsh5P9uBq5VJtqHh2mo49pdw5WFoEwKWqWHacaWOjQXWGcifKo6vj5RGS6zykI587XeUIQDqJSmAp+lE4qt19W5P9o8+Lma5DcjsC8JiT607lMVkdqQ0Vyh3lHhmh52tfNy78ajXv0rgYzv8nfwswANuk+7sD/Q0aAAAAAElFTkSuQmCC\">\u21b5     <style>\u21b5          html, body, pre {\u21b5                margin: 0;\u21b5               padding: 0;\u21b5              font-family: Monaco, 'Lucida Console', monospace;\u21b5                background: #ECECEC;\u21b5         }\u21b5            h1 {\u21b5             margin: 0;\u21b5               background: #AD632A;\u21b5             padding: 20px 45px;\u21b5              color: #fff;\u21b5             text-shadow: 1px 1px 1px rgba(0,0,0,.3);\u21b5             border-bottom: 1px solid #9F5805;\u21b5                font-size: 28px;\u21b5         }\u21b5            p#detail {\u21b5               margin: 0;\u21b5               padding: 15px 45px;\u21b5              background: #F6A960;\u21b5             border-top: 4px solid #D29052;\u21b5               color: #733512;\u21b5              text-shadow: 1px 1px 1px rgba(255,255,255,.3);\u21b5               font-size: 14px;\u21b5             border-bottom: 1px solid #BA7F5B;\u21b5            }\u21b5        </style>\u21b5 </head>\u21b5  <body>\u21b5       <h1>Bad request</h1>\u21b5\u21b5      <p id=\"detail\">\u21b5          For request 'DELETE /api/reports/21' [Invalid XML]\u21b5       </p>\u21b5\u21b5  </body>\u21b5</html>\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\"\nresponseType: \"\"\nresponseXML: null\nstatus: 400\nstatusText: \"Bad Request\"\ntimeout: 0\nupload: XMLHttpRequestUpload\nwithCredentials: false\n__proto__: XMLHttpRequestPrototype\nAnd so it seems to me that the server rejects the request.\nJust to make sure it's clear: this DELETE request works fine on most browsers, where it's received by the server as a DELETE. I just noticed the failure on iOS Safari.\n. Good catch. I compared the request headers of the Mootools XHR and the jQuery one.\nMootools:\nAccept  text/javascript, text/html, application/xml, text/xml, */*\nContent-Type    application/xml\njQuery:\nAccept  */*\n(The Content-Type header is not sent when doing a DELETE XHR via jQuery)\nSeems to me that Safari doesn't like Content-Type application/xml for a DELETE request. I added headers: {\"Content-Type\": null} as a new parameter of the Mootools Request, and it's now accepted by the server. But is there a better work-around?\nI still think it's a bug. The headers that jQuery sends when doing a DELETE request seem more logical to me.\n. Closing the issue is dodging the problem. This is a Mootools bug.\nTo sum up: on DELETE requests, Mootools shouldn't set the Content-Type header. Simple.\n. If you don't re-open the issue, I'll create a new very simple one, explaining the problem like in the above comment.\n. https://github.com/mootools/mootools-core/issues/2625\n. I can't really test the server-side right now, but since iOS has amazing debugging tools when you have a Mac, this is what I could extract from xhr argument of onFailure:\nconstructor: XMLHttpRequestConstructor\nonabort: null\nonerror: null\nonload: null\nonloadend: null\nonloadstart: function () {}\nonprogress: function () {}\nonreadystatechange: function () {}\nontimeout: null\nreadyState: 4\nresponse: \"\u21b5\u21b5<!DOCTYPE html>\u21b5<html>\u21b5    <head>\u21b5       <title>Bad request</title>\u21b5       <link rel=\"shortcut icon\" href=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAlFJREFUeNqUU8tOFEEUPVVdNV3dPe8xYRBnjGhmBgKjKzCIiQvBoIaNbly5Z+PSv3Aj7DSiP2B0rwkLGVdGgxITSCRIJGSMEQWZR3eVt5sEFBgTb/dN1yvnnHtPNTPG4PqdHgCMXnPRSZrpSuH8vUJu4DE4rYHDGAZDX62BZttHqTiIayM3gGiXQsgYLEvATaqxU+dy1U13YXapXptpNHY8iwn8KyIAzm1KBdtRZWErpI5lEWTXp5Z/vHpZ3/wyKKwYGGOdAYwR0EZwoezTYApBEIObyELl/aE1/83cp40Pt5mxqCKrE4Ck+mVWKKcI5tA8BLEhRBKJLjez6a7MLq7XZtp+yyOawwCBtkiBVZDKzRk4NN7NQBMYPHiZDFhXY+p9ff7F961vVcnl4R5I2ykJ5XFN7Ab7Gc61VoipNBKF+PDyztu5lfrSLT/wIwCxq0CAGtXHZTzqR2jtwQiXONma6hHpj9sLT7YaPxfTXuZdBGA02Wi7FS48YiTfj+i2NhqtdhP5RC8mh2/Op7y0v6eAcWVLFT8D7kWX5S9mepp+C450MV6aWL1cGnvkxbwHtLW2B9AOkLeUd9KEDuh9fl/7CEj7YH5g+3r/lWfF9In7tPz6T4IIwBJOr1SJyIGQMZQbsh5P9uBq5VJtqHh2mo49pdw5WFoEwKWqWHacaWOjQXWGcifKo6vj5RGS6zykI587XeUIQDqJSmAp+lE4qt19W5P9o8+Lma5DcjsC8JiT607lMVkdqQ0Vyh3lHhmh52tfNy78ajXv0rgYzv8nfwswANuk+7sD/Q0aAAAAAElFTkSuQmCC\">\u21b5     <style>\u21b5          html, body, pre {\u21b5                margin: 0;\u21b5               padding: 0;\u21b5              font-family: Monaco, 'Lucida Console', monospace;\u21b5                background: #ECECEC;\u21b5         }\u21b5            h1 {\u21b5             margin: 0;\u21b5               background: #AD632A;\u21b5             padding: 20px 45px;\u21b5              color: #fff;\u21b5             text-shadow: 1px 1px 1px rgba(0,0,0,.3);\u21b5             border-bottom: 1px solid #9F5805;\u21b5                font-size: 28px;\u21b5         }\u21b5            p#detail {\u21b5               margin: 0;\u21b5               padding: 15px 45px;\u21b5              background: #F6A960;\u21b5             border-top: 4px solid #D29052;\u21b5               color: #733512;\u21b5              text-shadow: 1px 1px 1px rgba(255,255,255,.3);\u21b5               font-size: 14px;\u21b5             border-bottom: 1px solid #BA7F5B;\u21b5            }\u21b5        </style>\u21b5 </head>\u21b5  <body>\u21b5       <h1>Bad request</h1>\u21b5\u21b5      <p id=\"detail\">\u21b5          For request 'DELETE /api/reports/21' [Invalid XML]\u21b5       </p>\u21b5\u21b5  </body>\u21b5</html>\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\"\nresponseText: \"\u21b5\u21b5<!DOCTYPE html>\u21b5<html>\u21b5    <head>\u21b5       <title>Bad request</title>\u21b5       <link rel=\"shortcut icon\" href=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAlFJREFUeNqUU8tOFEEUPVVdNV3dPe8xYRBnjGhmBgKjKzCIiQvBoIaNbly5Z+PSv3Aj7DSiP2B0rwkLGVdGgxITSCRIJGSMEQWZR3eVt5sEFBgTb/dN1yvnnHtPNTPG4PqdHgCMXnPRSZrpSuH8vUJu4DE4rYHDGAZDX62BZttHqTiIayM3gGiXQsgYLEvATaqxU+dy1U13YXapXptpNHY8iwn8KyIAzm1KBdtRZWErpI5lEWTXp5Z/vHpZ3/wyKKwYGGOdAYwR0EZwoezTYApBEIObyELl/aE1/83cp40Pt5mxqCKrE4Ck+mVWKKcI5tA8BLEhRBKJLjez6a7MLq7XZtp+yyOawwCBtkiBVZDKzRk4NN7NQBMYPHiZDFhXY+p9ff7F961vVcnl4R5I2ykJ5XFN7Ab7Gc61VoipNBKF+PDyztu5lfrSLT/wIwCxq0CAGtXHZTzqR2jtwQiXONma6hHpj9sLT7YaPxfTXuZdBGA02Wi7FS48YiTfj+i2NhqtdhP5RC8mh2/Op7y0v6eAcWVLFT8D7kWX5S9mepp+C450MV6aWL1cGnvkxbwHtLW2B9AOkLeUd9KEDuh9fl/7CEj7YH5g+3r/lWfF9In7tPz6T4IIwBJOr1SJyIGQMZQbsh5P9uBq5VJtqHh2mo49pdw5WFoEwKWqWHacaWOjQXWGcifKo6vj5RGS6zykI587XeUIQDqJSmAp+lE4qt19W5P9o8+Lma5DcjsC8JiT607lMVkdqQ0Vyh3lHhmh52tfNy78ajXv0rgYzv8nfwswANuk+7sD/Q0aAAAAAElFTkSuQmCC\">\u21b5     <style>\u21b5          html, body, pre {\u21b5                margin: 0;\u21b5               padding: 0;\u21b5              font-family: Monaco, 'Lucida Console', monospace;\u21b5                background: #ECECEC;\u21b5         }\u21b5            h1 {\u21b5             margin: 0;\u21b5               background: #AD632A;\u21b5             padding: 20px 45px;\u21b5              color: #fff;\u21b5             text-shadow: 1px 1px 1px rgba(0,0,0,.3);\u21b5             border-bottom: 1px solid #9F5805;\u21b5                font-size: 28px;\u21b5         }\u21b5            p#detail {\u21b5               margin: 0;\u21b5               padding: 15px 45px;\u21b5              background: #F6A960;\u21b5             border-top: 4px solid #D29052;\u21b5               color: #733512;\u21b5              text-shadow: 1px 1px 1px rgba(255,255,255,.3);\u21b5               font-size: 14px;\u21b5             border-bottom: 1px solid #BA7F5B;\u21b5            }\u21b5        </style>\u21b5 </head>\u21b5  <body>\u21b5       <h1>Bad request</h1>\u21b5\u21b5      <p id=\"detail\">\u21b5          For request 'DELETE /api/reports/21' [Invalid XML]\u21b5       </p>\u21b5\u21b5  </body>\u21b5</html>\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\u21b5\"\nresponseType: \"\"\nresponseXML: null\nstatus: 400\nstatusText: \"Bad Request\"\ntimeout: 0\nupload: XMLHttpRequestUpload\nwithCredentials: false\n__proto__: XMLHttpRequestPrototype\nAnd so it seems to me that the server rejects the request.\nJust to make sure it's clear: this DELETE request works fine on most browsers, where it's received by the server as a DELETE. I just noticed the failure on iOS Safari.\n. Good catch. I compared the request headers of the Mootools XHR and the jQuery one.\nMootools:\nAccept  text/javascript, text/html, application/xml, text/xml, */*\nContent-Type    application/xml\njQuery:\nAccept  */*\n(The Content-Type header is not sent when doing a DELETE XHR via jQuery)\nSeems to me that Safari doesn't like Content-Type application/xml for a DELETE request. I added headers: {\"Content-Type\": null} as a new parameter of the Mootools Request, and it's now accepted by the server. But is there a better work-around?\nI still think it's a bug. The headers that jQuery sends when doing a DELETE request seem more logical to me.\n. Closing the issue is dodging the problem. This is a Mootools bug.\nTo sum up: on DELETE requests, Mootools shouldn't set the Content-Type header. Simple.\n. If you don't re-open the issue, I'll create a new very simple one, explaining the problem like in the above comment.\n. https://github.com/mootools/mootools-core/issues/2625\n. ",
    "NemoAlex": "@kentaromiura Exactly!\nShould this be considered in a future version?\n. @kentaromiura Exactly!\nShould this be considered in a future version?\n. ",
    "qbolec": "I've already filed https://github.com/GCheung55/Neuro/issues/34\n. I am surprised that you've attempted this problem from the angle of setOptions, while the problem is much easier solved by patching Object.each function.\nI would suggest to try to change lines around https://github.com/mootools/mootools-core/blob/master/Source/Core/Core.js#L308 to something like\nObject.extend('forEach', function(object, fn, bind){\n        var remember_about_constructor = 'constructor' in object;\n        for (var key in object){\n                if(key === 'constructor') remember_about_constructor = false;\n                if (hasOwnProperty.call(object, key)) fn.call(bind, object[key], key, object);\n        }\n        if(remember_about_constructor){\n                key = 'constructor';\n                if (hasOwnProperty.call(object, key)) fn.call(bind, object[key], key, object);\n        }\n});\nor something similar. \n. I've already filed https://github.com/GCheung55/Neuro/issues/34\n. I am surprised that you've attempted this problem from the angle of setOptions, while the problem is much easier solved by patching Object.each function.\nI would suggest to try to change lines around https://github.com/mootools/mootools-core/blob/master/Source/Core/Core.js#L308 to something like\nObject.extend('forEach', function(object, fn, bind){\n        var remember_about_constructor = 'constructor' in object;\n        for (var key in object){\n                if(key === 'constructor') remember_about_constructor = false;\n                if (hasOwnProperty.call(object, key)) fn.call(bind, object[key], key, object);\n        }\n        if(remember_about_constructor){\n                key = 'constructor';\n                if (hasOwnProperty.call(object, key)) fn.call(bind, object[key], key, object);\n        }\n});\nor something similar. \n. ",
    "konovalovk": "duplicate of https://github.com/mootools/mootools-core/pull/2599\n. duplicate of https://github.com/mootools/mootools-core/pull/2599\n. ",
    "pavelxkrejci": "Yes optionally, but the problem is a lot of developers are ignoring it, which they probably should. Partly because default paths for php or plain javascript cookies are directory-specific. Default path for document.cookie property is only the current page.\nHardcoded \"/\" default cookie path in mootools does not seem to be in line with general coding style in php or js.\n. Yes optionally, but the problem is a lot of developers are ignoring it, which they probably should. Partly because default paths for php or plain javascript cookies are directory-specific. Default path for document.cookie property is only the current page.\nHardcoded \"/\" default cookie path in mootools does not seem to be in line with general coding style in php or js.\n. ",
    "mzabriskie": "@SergioCrisostomo Sounds good, thanks!\n. @SergioCrisostomo thank you for the update!\n. I wrote a library called Sickle that allows me to have better query selector performance. Maybe a point of reference for this issue.\n. @SergioCrisostomo Sounds good, thanks!\n. @SergioCrisostomo thank you for the update!\n. I wrote a library called Sickle that allows me to have better query selector performance. Maybe a point of reference for this issue.\n. ",
    "AmatanHead": "I see two ways to fix this: first is to try to fully mimic array.splice, second is to brake intuitive similarity and invite something new.\n. If so, I would prefer to split this operation into paste(what, optPosition), insert(what, optPosition) and delete(length, optPosition).\n'abc'.paste('q') // 'qabc'\n'abc'.paste('q', 1) // 'aqbc'\n'abc'.insert('q') // qbc\n'abc'.insert('q', 1) // aqc\n'abc'.remove(1) // 'bc'\n'abc'.remove(1, 1) // 'ac'\n[bad idea]\n. ... or, as suggests @megawac, just delegate it. May even better:\nsplice: function() {\n    var t = this.split(\"\");\n    console.log(t.splice.apply(t, arguments));\n    return t.join(\"\");\n}\nor return two arguments:\n```\nsplice: function() {\n    var t = this.split(\"\"),\n        change = t.splice.apply(t, arguments).join(\"\"),\n        out = t.join(\"\");\n    return [out, change];\n}\n\"12345\".splice(1, 2, 'Q', 'W', 'ERTY') // [\"1QWERTY45\", \"23\"]\n``\n. So here's a new implementation. Now it's really close to array.splice because it's based on array.splice.\n- The syntax is very similar to array.splice\n- Negative positions are explicitly controlled.\n- It's available to get removed string.\n. Is something wrong to this PR? Why so silent here?\n.limit` is probably should be infinite by default. This won't affect existing code and help to avoid situation when you want to walk through the entire DOM tree but you don't know how deep it is.\nAlso if this feature will be implemented in getParent than maybe it's good to implement the same in getParents.\n. I see two ways to fix this: first is to try to fully mimic array.splice, second is to brake intuitive similarity and invite something new.\n. If so, I would prefer to split this operation into paste(what, optPosition), insert(what, optPosition) and delete(length, optPosition).\n'abc'.paste('q') // 'qabc'\n'abc'.paste('q', 1) // 'aqbc'\n'abc'.insert('q') // qbc\n'abc'.insert('q', 1) // aqc\n'abc'.remove(1) // 'bc'\n'abc'.remove(1, 1) // 'ac'\n[bad idea]\n. ... or, as suggests @megawac, just delegate it. May even better:\nsplice: function() {\n    var t = this.split(\"\");\n    console.log(t.splice.apply(t, arguments));\n    return t.join(\"\");\n}\nor return two arguments:\n```\nsplice: function() {\n    var t = this.split(\"\"),\n        change = t.splice.apply(t, arguments).join(\"\"),\n        out = t.join(\"\");\n    return [out, change];\n}\n\"12345\".splice(1, 2, 'Q', 'W', 'ERTY') // [\"1QWERTY45\", \"23\"]\n``\n. So here's a new implementation. Now it's really close to array.splice because it's based on array.splice.\n- The syntax is very similar to array.splice\n- Negative positions are explicitly controlled.\n- It's available to get removed string.\n. Is something wrong to this PR? Why so silent here?\n.limit` is probably should be infinite by default. This won't affect existing code and help to avoid situation when you want to walk through the entire DOM tree but you don't know how deep it is.\nAlso if this feature will be implemented in getParent than maybe it's good to implement the same in getParents.\n. ",
    "jpdery": "Which iOS8 beta version are you using ? I did a quick test on a website that used the tap event and it worked. Could you create a JS Fiddle or something to help me reproduce the issue ?\nThanks!\n. @AnitaAtyi Thanks. I'll take a look as soon as possible and I'll get back to you.\n. Which iOS8 beta version are you using ? I did a quick test on a website that used the tap event and it worked. Could you create a JS Fiddle or something to help me reproduce the issue ?\nThanks!\n. @AnitaAtyi Thanks. I'll take a look as soon as possible and I'll get back to you.\n. ",
    "AnitaAtyi": "We are using iOS 8 GM. \nYou can download our test Cordova project here: http://design.h2online.hu/iostestproject.zip\nWe also tested it in xCode 6 and on device with iOS 8 GM. The event listener (called testListener) what we added to tap event doesn't work. But if we use jquery click event (commented in source) it works.\nIf we run this project in xCode 5.1 or on device with iOS 7, it perfectly works, testListener is fired after tapping on the button.\nThanks a lot!\n. We have fixed it.\nThis code caused the problem:\nClass.refactor(Moobile.ScrollView, {\n   options: {\n      scroller: 'IScroll'\n   }\n});\n(It fixes Android scrolling issue.)\nWe wrapped it with a condition for platform, and now tap event listener is correctly working.\nThanks!\n. @jpdery\nWe think that the bug is in iScroll. We replaced it with iScroll 5, but scrolling isn't working and tap event listener still doesn't fire. \nWith native scrolling everything works on iOS 8.\n. Thanks!\nWe have found a new bug. Slider component doesn't work on iOS 8. \n. We are using iOS 8 GM. \nYou can download our test Cordova project here: http://design.h2online.hu/iostestproject.zip\nWe also tested it in xCode 6 and on device with iOS 8 GM. The event listener (called testListener) what we added to tap event doesn't work. But if we use jquery click event (commented in source) it works.\nIf we run this project in xCode 5.1 or on device with iOS 7, it perfectly works, testListener is fired after tapping on the button.\nThanks a lot!\n. We have fixed it.\nThis code caused the problem:\nClass.refactor(Moobile.ScrollView, {\n   options: {\n      scroller: 'IScroll'\n   }\n});\n(It fixes Android scrolling issue.)\nWe wrapped it with a condition for platform, and now tap event listener is correctly working.\nThanks!\n. @jpdery\nWe think that the bug is in iScroll. We replaced it with iScroll 5, but scrolling isn't working and tap event listener still doesn't fire. \nWith native scrolling everything works on iOS 8.\n. Thanks!\nWe have found a new bug. Slider component doesn't work on iOS 8. \n. ",
    "YannickGagnon": "The issue comes from a third party lib and was fixed here:\nhttps://github.com/cpojer/mootools-mobile/commit/3a43531bfb0dea8d24e9b9d8b24417b6f66af2a4\nUntil Moobile boilerplate gets updated, you can patch your version using the linked fix.\n. The issue comes from a third party lib and was fixed here:\nhttps://github.com/cpojer/mootools-mobile/commit/3a43531bfb0dea8d24e9b9d8b24417b6f66af2a4\nUntil Moobile boilerplate gets updated, you can patch your version using the linked fix.\n. ",
    "odysseuscm": "Thanks for fixing this so fast! I can confirm that the fix is working.\n. Sure\nUser Agent: Mozilla/5.0 (Mobile; Windows Phone 8.1; Android 4.0; ARM; Trident/7.0; Touch; rv:11.0; IEMobile/11.0; SAMSUNG; GT-I8750) like iPhone OS 7_0_3 Mac OS X AppleWebKit/537 (KHTML, like Gecko) Mobile Safari/537\nPlatform: ARM\nGetting closer ;-)\n. Hi, I'm curious why the fix hasn't been merged into 1.5.2 before release?\n. mootools 1.6.0 (and 1.6.1dev) still report \"ios\" for Windows Phone.\n. mootools 1.6.0 (and 1.6.1dev) still report \"ios\" for Windows Phone.\n. Please take a look here: https://github.com/mootools/mootools-core/issues/2678\n. I see, thanks!\n. Thanks for fixing this so fast! I can confirm that the fix is working.\n. Sure\nUser Agent: Mozilla/5.0 (Mobile; Windows Phone 8.1; Android 4.0; ARM; Trident/7.0; Touch; rv:11.0; IEMobile/11.0; SAMSUNG; GT-I8750) like iPhone OS 7_0_3 Mac OS X AppleWebKit/537 (KHTML, like Gecko) Mobile Safari/537\nPlatform: ARM\nGetting closer ;-)\n. Hi, I'm curious why the fix hasn't been merged into 1.5.2 before release?\n. mootools 1.6.0 (and 1.6.1dev) still report \"ios\" for Windows Phone.\n. mootools 1.6.0 (and 1.6.1dev) still report \"ios\" for Windows Phone.\n. Please take a look here: https://github.com/mootools/mootools-core/issues/2678\n. I see, thanks!\n. ",
    "mattcoz": "The problem isn't with the method itself, it's that when implement(Array.prototype) is called, the contains method isn't implemented. Then when my site calls contains(or include, which calls contains) on an Elements object, an error is throws saying that the contains method doesn't exist.\n. The problem isn't with the method itself, it's that when implement(Array.prototype) is called, the contains method isn't implemented. Then when my site calls contains(or include, which calls contains) on an Elements object, an error is throws saying that the contains method doesn't exist.\n. ",
    "Addviso": "Hello,\nSorry, but I can\u2019t reproduce the problem under jsfiddle. It seems working.\nA test can be simple :\nJust copy in a simple html page javascript & html of this simple gmap example :\nhttps://developers.google.com/maps/documentation/javascript/examples/map-simple?hl=FR\nInsert a remote link to mootools 1.5.1 with compat in the head after the call to gmap api, and wrap the script initialize in a dom ready.\nIn firebug, I\u2019ve got the error \u201ce is not a function\u201d\nI\u2019ve been able to avoid this error with remodeling my scripts under mootools without compat.\nThanks.\nScott.\nDe : Sergio Crisostomo [mailto:notifications@github.com] \nEnvoy\u00e9 : mardi 21 octobre 2014 22:57\n\u00c0 : mootools/mootools-core\nCc : Addviso\nObjet : Re: [mootools-core] Core with compatibility conflicts with google maps (#2661)\n@Addviso https://github.com/Addviso  could you make a jsFiddle with an example of the problem?\n\u2014\nReply to this email directly or view it on GitHub https://github.com/mootools/mootools-core/issues/2661#issuecomment-59997484 .Image supprim\u00e9e par l'exp\u00e9diteur.\n. Hello,\nSorry, but I can\u2019t reproduce the problem under jsfiddle. It seems working.\nA test can be simple :\nJust copy in a simple html page javascript & html of this simple gmap example :\nhttps://developers.google.com/maps/documentation/javascript/examples/map-simple?hl=FR\nInsert a remote link to mootools 1.5.1 with compat in the head after the call to gmap api, and wrap the script initialize in a dom ready.\nIn firebug, I\u2019ve got the error \u201ce is not a function\u201d\nI\u2019ve been able to avoid this error with remodeling my scripts under mootools without compat.\nThanks.\nScott.\nDe : Sergio Crisostomo [mailto:notifications@github.com] \nEnvoy\u00e9 : mardi 21 octobre 2014 22:57\n\u00c0 : mootools/mootools-core\nCc : Addviso\nObjet : Re: [mootools-core] Core with compatibility conflicts with google maps (#2661)\n@Addviso https://github.com/Addviso  could you make a jsFiddle with an example of the problem?\n\u2014\nReply to this email directly or view it on GitHub https://github.com/mootools/mootools-core/issues/2661#issuecomment-59997484 .Image supprim\u00e9e par l'exp\u00e9diteur.\n. ",
    "paulschwarz": "I'm not sure if this is the same issue, but I've finally managed to squash an old sporadic bug by understanding that google maps checks if a .bind method has been implemented. See here https://code.google.com/p/gmaps-api-issues/issues/detail?id=7203#c9\nI fixed my issue by making sure that Mootools was loaded before the Google Maps library. \nWhen using jsFiddle this would naturally be the case which might be the reason why you aren't able to reproduce the bug there. \n. I'm not sure if this is the same issue, but I've finally managed to squash an old sporadic bug by understanding that google maps checks if a .bind method has been implemented. See here https://code.google.com/p/gmaps-api-issues/issues/detail?id=7203#c9\nI fixed my issue by making sure that Mootools was loaded before the Google Maps library. \nWhen using jsFiddle this would naturally be the case which might be the reason why you aren't able to reproduce the bug there. \n. ",
    "stfnkrstv": "In advocacy of merging could also be said that MooTools' builder offers users to download customized versions with modules they need.\n. In advocacy of merging could also be said that MooTools' builder offers users to download customized versions with modules they need.\n. ",
    "oallouch": "I don't have plenty of time (3 parallel projects), but always for mootools !\n. It's the camelCase that hurts most, but, you're right, it comes from an age when we didn't have css animations.\nThx for the velocity tip. Looks great.\n. I don't have plenty of time (3 parallel projects), but always for mootools !\n. It's the camelCase that hurts most, but, you're right, it comes from an age when we didn't have css animations.\nThx for the velocity tip. Looks great.\n. ",
    "andreynering": "Actually, capitalize() already correctly capitalize words with dashes: http://jsfiddle.net/h1g0g261/\n@SergioCrisostomo Thank you! I'm using your solution. =)\n. Thank you for the feedback.\n\nAndrey Nering\nEm 15/01/2015 11:29, \"Sergio Crisostomo\" notifications@github.com\nescreveu:\n\nWe decided yesterday we will leave this method as it is since we cannot\ninclude all cases in a simple solution that is not expensive for\nperformance. Also this method is used mostly for internal purposes.\n@andreynering https://github.com/andreynering happy my idea was usable!\nCheers\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2680#issuecomment-70085142\n.\n. Actually, capitalize() already correctly capitalize words with dashes: http://jsfiddle.net/h1g0g261/\n\n@SergioCrisostomo Thank you! I'm using your solution. =)\n. Thank you for the feedback.\n\nAndrey Nering\nEm 15/01/2015 11:29, \"Sergio Crisostomo\" notifications@github.com\nescreveu:\n\nWe decided yesterday we will leave this method as it is since we cannot\ninclude all cases in a simple solution that is not expensive for\nperformance. Also this method is used mostly for internal purposes.\n@andreynering https://github.com/andreynering happy my idea was usable!\nCheers\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mootools/mootools-core/issues/2680#issuecomment-70085142\n.\n. \n",
    "deadmann": "i'm not sure if it help or not,\nbut also i receive error on webstorm intelisense for this part:\nline: 5848\n// Make sure that domready fires before load\nElement.Events.load = {\n    base: 'load',\n    onAdd: function(fn){\n        if (loaded && this == window) fn.call(this);\n    },\n    condition: function(){\n        if (this == window){\n            domready(); ------Error is on this line -> invalid call target------\n            delete Element.Events.load;\n        }\n        return true;\n    }\n};\nmy version is 1.4.5 (get from nuget)\nI don't see this error on minified version\n. put new issue instead of comment,...sry\n. i'm not sure if it help or not,\nbut also i receive error on webstorm intelisense for this part:\nline: 5848\n// Make sure that domready fires before load\nElement.Events.load = {\n    base: 'load',\n    onAdd: function(fn){\n        if (loaded && this == window) fn.call(this);\n    },\n    condition: function(){\n        if (this == window){\n            domready(); ------Error is on this line -> invalid call target------\n            delete Element.Events.load;\n        }\n        return true;\n    }\n};\nmy version is 1.4.5 (get from nuget)\nI don't see this error on minified version\n. put new issue instead of comment,...sry\n. ",
    "sgserg": "event.persisted is missing when using your workaround\n. event.persisted is missing when using your workaround\n. ",
    "nbish11": "I'll give it a go then.\n. Works perfectly. I've created a pull request with this change and some tests to save you some time.\n. Sure, I'll do an update tomorrow.\n. Okay, thanks. I did do a search but couldn't find any mention of it. Might've been in \"Closed Issues\"...\n. @GCheung55 I'm not very good at writing tests, but if you can link the original tests for the events already there (or a more specialized example of writing tests for events), I'll be happy to write some.\n. I'll give it a go then.\n. Works perfectly. I've created a pull request with this change and some tests to save you some time.\n. Sure, I'll do an update tomorrow.\n. Okay, thanks. I did do a search but couldn't find any mention of it. Might've been in \"Closed Issues\"...\n. @GCheung55 I'm not very good at writing tests, but if you can link the original tests for the events already there (or a more specialized example of writing tests for events), I'll be happy to write some.\n. ",
    "jdm": "Thanks, that seems to do the trick.\n. Thanks, that seems to do the trick.\n. ",
    "131": "I will not blame console.log on this one\nconsole.log(Object.keys(this.config).length); => 0\nconsole.log(Object.keys(Object.clone(this.config))) => 2\nconsole.log(Object.keys(Object.merge({}, this.config))) => 2;\nEven though, as you said, this.config.paris is set \nThis is still a major issue.\nAs for me, I'll use Object.clone to avoid this.\n. I will not blame console.log on this one\nconsole.log(Object.keys(this.config).length); => 0\nconsole.log(Object.keys(Object.clone(this.config))) => 2\nconsole.log(Object.keys(Object.merge({}, this.config))) => 2;\nEven though, as you said, this.config.paris is set \nThis is still a major issue.\nAs for me, I'll use Object.clone to avoid this.\n. ",
    "22c-proxima": "Thank you, Sergio. I'll try that solution. Good luck to you\n. Thank you, Sergio. I'll try that solution. Good luck to you\n. ",
    "aSapien": "Thanks, @SergioCrisostomo!\n. @chemix - this comment wasn't added by a Google representative. This is a regression bug in Chrome and it was assigned to a developer. Note the status change slightly above this comment:\n\nStatus: Assigned \nLabels: -Type-Bug -Needs-Feedback Type-Bug-Regression \n. Thanks, @SergioCrisostomo!\n. @chemix - this comment wasn't added by a Google representative. This is a regression bug in Chrome and it was assigned to a developer. Note the status change slightly above this comment:\nStatus: Assigned \nLabels: -Type-Bug -Needs-Feedback Type-Bug-Regression \n. \n",
    "chemix": "from code.goole\n\"\nJSBin http://jsbin.com/dumupilogu/1/edit\nProblem is related to a change in the V8 - \"ES6: Number and Boolean prototype should be ordinary objects.\"\nBut this is normal behavior for ES6, need fix the problem in Mootools\n\"\n. ok, I hove someone will fix it :) \n. today's night build works :) \n. from code.goole\n\"\nJSBin http://jsbin.com/dumupilogu/1/edit\nProblem is related to a change in the V8 - \"ES6: Number and Boolean prototype should be ordinary objects.\"\nBut this is normal behavior for ES6, need fix the problem in Mootools\n\"\n. ok, I hove someone will fix it :) \n. today's night build works :) \n. ",
    "j3zusla": "I am loading mootools via document.write:\ndocument.write(\"\");\nSorry, I am not able to simulate the error with jsfiddle: \"document.write is disallowed in JSFiddle envioriment and might break your fiddle.\" (the spelling error for environment is from the site itself ;) )\nI could give you the live site if you are not able to reproduce the issue, but I prefer to keep it private to the community for now. Thank you for your understanding and help,\nThe environment on the server side is apache and on the client side I use Windows8 via I.E. 11.\nCordially,\nJFSG\n. cool I'll try that...\n. Soz, I have no luck duplicating the issue on fiddle. I have tried to include the lib via Fiddle external function and it is all fine on I.E. It must be a code conflict between libs. I have no choice but to give you the live url. Can I send it in private somehow?\nPS: I have also tried to call the lib directly in the page header by removing the document.write call and the problem is the same :(\n. Yes DimitarChristoff, this is the issue I am getting!\nI have also tried the hack proposed with no luck to fix the issue. I will try what you've suggested.\n. ok, I will back track and see where it gets called. I made sure to call what is needed on domready. It will give me the chance do a cleanup then! \nHey DimitarChristoff plz, don't use jq word anymore, it gives me the creeps everytime  ;)\n. Great, the I.E. 11 problem is now fixed . . .\nThe problem came from an old plugin (4-5 years old) called Fitimage.\nThe following line of code contains the issue:\nthis.image = new Element('img', {\n        'src': image,\n        'id': 'fitimage',\n        'class': this.options['class']\n }).addEvent('load', this.inject);\nto make a quick fix, it got changed to:\nthis.image = new Element('img', {\n     'src': image,\n      'id': 'fitimage',\n      'class': this.options['class']\n}).inject(document.body);\nThank you everyone for all your help on that one and for that robust and performant moooooo library!\nMuch love to all, you deserve it,\nJ3zusla\n. I am loading mootools via document.write:\ndocument.write(\"\");\nSorry, I am not able to simulate the error with jsfiddle: \"document.write is disallowed in JSFiddle envioriment and might break your fiddle.\" (the spelling error for environment is from the site itself ;) )\nI could give you the live site if you are not able to reproduce the issue, but I prefer to keep it private to the community for now. Thank you for your understanding and help,\nThe environment on the server side is apache and on the client side I use Windows8 via I.E. 11.\nCordially,\nJFSG\n. cool I'll try that...\n. Soz, I have no luck duplicating the issue on fiddle. I have tried to include the lib via Fiddle external function and it is all fine on I.E. It must be a code conflict between libs. I have no choice but to give you the live url. Can I send it in private somehow?\nPS: I have also tried to call the lib directly in the page header by removing the document.write call and the problem is the same :(\n. Yes DimitarChristoff, this is the issue I am getting!\nI have also tried the hack proposed with no luck to fix the issue. I will try what you've suggested.\n. ok, I will back track and see where it gets called. I made sure to call what is needed on domready. It will give me the chance do a cleanup then! \nHey DimitarChristoff plz, don't use jq word anymore, it gives me the creeps everytime  ;)\n. Great, the I.E. 11 problem is now fixed . . .\nThe problem came from an old plugin (4-5 years old) called Fitimage.\nThe following line of code contains the issue:\nthis.image = new Element('img', {\n        'src': image,\n        'id': 'fitimage',\n        'class': this.options['class']\n }).addEvent('load', this.inject);\nto make a quick fix, it got changed to:\nthis.image = new Element('img', {\n     'src': image,\n      'id': 'fitimage',\n      'class': this.options['class']\n}).inject(document.body);\nThank you everyone for all your help on that one and for that robust and performant moooooo library!\nMuch love to all, you deserve it,\nJ3zusla\n. ",
    "inf1": "Hello,\nFYI: I can now release the website http://multivers3D.fr. \nIt is using mootools at its core foundation and not the other libs;)\nCordially,\nJ3zusla\n. Hello,\nFYI: I can now release the website http://multivers3D.fr. \nIt is using mootools at its core foundation and not the other libs;)\nCordially,\nJ3zusla\n. ",
    "dreadcast": "Hi there,\nIs there a new tag including this merged PR coming up ?\n. Great !\n. (y)\n. Hi there,\nIs there a new tag including this merged PR coming up ?\n. Great !\n. (y)\n. ",
    "stefanklokgieters": "What is the exact fix here? :). I fully get that... :)\nCan you perhaps try to help me a bit further anyway? What changes exactly needed to be made? I am familiar with the ModuleJS conventions but I am not sure what you exactly mean with the proper definition. All the help is very welcome, thanks in advance!. How actively it MooTools still being maintained/ developed?. What is the exact fix here? :). I fully get that... :)\nCan you perhaps try to help me a bit further anyway? What changes exactly needed to be made? I am familiar with the ModuleJS conventions but I am not sure what you exactly mean with the proper definition. All the help is very welcome, thanks in advance!. How actively it MooTools still being maintained/ developed?. ",
    "IvanGuardado": "@stefanklokgieters two years after I don't remember so well but the module should be defined following the CommonJS convention like the others.. It was only my thought about improving the current way to use modules in the library. It makes sense for me to separate the modules that extend native prototypes from which don't do it.\nI've never talked about changing the MooTools nature at all but about the way of loading the library. I know the problems of changing the libraries API, but I think (IMHO) there is chance to do it better :)\n. @stefanklokgieters two years after I don't remember so well but the module should be defined following the CommonJS convention like the others.. It was only my thought about improving the current way to use modules in the library. It makes sense for me to separate the modules that extend native prototypes from which don't do it.\nI've never talked about changing the MooTools nature at all but about the way of loading the library. I know the problems of changing the libraries API, but I think (IMHO) there is chance to do it better :)\n. ",
    "Manaus": "Ok I was reading the wrong page... \n. Ok I was reading the wrong page... \n. ",
    "rizwanhussain-vteams": "@SergioCrisostomo I was having this problem in Joomla 1.x which uses Mootools 1.12 and in there the mootools script was added in the head tag which is why i tried to replicate the same scenario in the fiddle as well. Also, 1.2.x was the lowest version available in jsfiddle. \nAnyways, i have created another fiddle demonstrating the issue in a better way : http://jsfiddle.net/b4beaoda/\nI have added the mootools script inline as you did and as you can see the script is the same version as well i.e. 1.12 which is causing problem on actual website.\nI hope this information helps :) \n. @SergioCrisostomo Let's re-open this thread. I have already posted at interactjs and they say its a mootools issue.\n. @SergioCrisostomo Sorry mate. Wrong link : Here you go http://jsfiddle.net/b4beaoda/1/\n. @SergioCrisostomo I was having this problem in Joomla 1.x which uses Mootools 1.12 and in there the mootools script was added in the head tag which is why i tried to replicate the same scenario in the fiddle as well. Also, 1.2.x was the lowest version available in jsfiddle. \nAnyways, i have created another fiddle demonstrating the issue in a better way : http://jsfiddle.net/b4beaoda/\nI have added the mootools script inline as you did and as you can see the script is the same version as well i.e. 1.12 which is causing problem on actual website.\nI hope this information helps :) \n. @SergioCrisostomo Let's re-open this thread. I have already posted at interactjs and they say its a mootools issue.\n. @SergioCrisostomo Sorry mate. Wrong link : Here you go http://jsfiddle.net/b4beaoda/1/\n. ",
    "jarkt": "Yes exactly. The function shouldn\u2019t automatically number parameters with the same name. I think the specs are wrong.\nObject.toQueryString(\"a[]=1&a[]=2\".parseQueryString())\nThis should return only the input string, but instead mootools adds one more dimension and returns \"a[][0]=1&a[][1]=2\".\nparseQueryString and toQueryString actually don\u2019t work fine together.\n. Yes exactly. The function shouldn\u2019t automatically number parameters with the same name. I think the specs are wrong.\nObject.toQueryString(\"a[]=1&a[]=2\".parseQueryString())\nThis should return only the input string, but instead mootools adds one more dimension and returns \"a[][0]=1&a[][1]=2\".\nparseQueryString and toQueryString actually don\u2019t work fine together.\n. ",
    "si13b": "So far I've just made sure that it's recognised as a native event in Element.Event.js and ensured that the page/client objects are passed through in DOMEvent.js. Is there anything else that I should be considering?\n. I noticed that DOMEvent acts as some kind of meta-event or decorator. Should I be setting tilt/pressure etc as properties directly, or can people simply access it via the native event i.e. the DOMEvent.event property?\n. That makes sense and it's probably the preferred behaviour, especially if it's consistent with the (potentially) native implementation. I'm not sure if it's worth flagging this somewhere in the docs or not so users know there's a potentially breaking change when upgrading from 1.5.1?\nFeel free to close this one.\n. Yes, should be able to.\n. @SergioCrisostomo thanks! Do you want me to add another commit to update the docs, or should we do that in a separate PR?\n. Cool :+1:, can we merge? :-)\n. @arian suggested we not polyfill and my understanding of the reasons was basically that there are already other quality options out there (i.e. https://github.com/jquery/PEP). Also, it gives users the choice if they want to polyfill or not.\nI am not personally adverse to polyfill, and it does seem to be inline with the project goals.\nI raised this issue primarily to simply recognize pointer events (at present, you cannot even el.addEvent('pointerdown', handler);), so you could look at it as the first step towards more advanced support.\nSure thing, I'll do the rebase. Should I also squash the commits down, or not fussed?\n. I've completed the rebase, did we make a decision about polyfilling or not?\n. So far I've just made sure that it's recognised as a native event in Element.Event.js and ensured that the page/client objects are passed through in DOMEvent.js. Is there anything else that I should be considering?\n. I noticed that DOMEvent acts as some kind of meta-event or decorator. Should I be setting tilt/pressure etc as properties directly, or can people simply access it via the native event i.e. the DOMEvent.event property?\n. That makes sense and it's probably the preferred behaviour, especially if it's consistent with the (potentially) native implementation. I'm not sure if it's worth flagging this somewhere in the docs or not so users know there's a potentially breaking change when upgrading from 1.5.1?\nFeel free to close this one.\n. Yes, should be able to.\n. @SergioCrisostomo thanks! Do you want me to add another commit to update the docs, or should we do that in a separate PR?\n. Cool :+1:, can we merge? :-)\n. @arian suggested we not polyfill and my understanding of the reasons was basically that there are already other quality options out there (i.e. https://github.com/jquery/PEP). Also, it gives users the choice if they want to polyfill or not.\nI am not personally adverse to polyfill, and it does seem to be inline with the project goals.\nI raised this issue primarily to simply recognize pointer events (at present, you cannot even el.addEvent('pointerdown', handler);), so you could look at it as the first step towards more advanced support.\nSure thing, I'll do the rebase. Should I also squash the commits down, or not fussed?\n. I've completed the rebase, did we make a decision about polyfilling or not?\n. ",
    "vveliev": "@SergioCrisostomo  , I'am not actually interested in any particular instance .... as from testing stand point, it's not important. What important for a test is to find out if there are any action on the page , pending on request , such that some data may not be present. \nPrototype had : Ajax.activeRequestCount\nJQuery: jQuery.active\nsomething similar, it may be boolean or number of connections \n. Should I ask this type of question somewhere else ?! or this is not good reason to add this type of functionality !? \n. I have no experience with JavaScript or mootools, I'm approaching from test automation side. \nSo from testing point.  I have no knowledge about requests and I cannot come up with the case when I have or need to know actual request.\nIn single page application, sometimes content of the page changes. And to determine that changes have been rendered. I know 2 solutions:\n1.Look for particular element by /id/name/class/text (very specific test's)\n- Also this does not work for dynamic sections (ex. pagination section, usually elements have same class identification)\n2.Have a general check for open connections, and wait for the completion before proceeding. \n- From my point this is best solution, for dynamic page sections when element on the page have same identity (class is same) but values are dynamically updated by some trigger.\nIf this functionality will be useful for development purpose, I will say maybe (as I have no experience in UI development I cannot come up with example. Maybe somebody can back me up on this one.) \nBut it does exist in: Prototype and JQuery, so there should be a reason for it. \n. Thanks to everyone for help!\n. @DimitarChristoff \n  If everyone who does testing need to add some additional methods around framework. In order to have reliable tests that can be automated.  Then you may aswell add this functionality into the framework. \nI'm making assumption that there are people who does make test automation. \n. @SergioCrisostomo  , I'am not actually interested in any particular instance .... as from testing stand point, it's not important. What important for a test is to find out if there are any action on the page , pending on request , such that some data may not be present. \nPrototype had : Ajax.activeRequestCount\nJQuery: jQuery.active\nsomething similar, it may be boolean or number of connections \n. Should I ask this type of question somewhere else ?! or this is not good reason to add this type of functionality !? \n. I have no experience with JavaScript or mootools, I'm approaching from test automation side. \nSo from testing point.  I have no knowledge about requests and I cannot come up with the case when I have or need to know actual request.\nIn single page application, sometimes content of the page changes. And to determine that changes have been rendered. I know 2 solutions:\n1.Look for particular element by /id/name/class/text (very specific test's)\n- Also this does not work for dynamic sections (ex. pagination section, usually elements have same class identification)\n2.Have a general check for open connections, and wait for the completion before proceeding. \n- From my point this is best solution, for dynamic page sections when element on the page have same identity (class is same) but values are dynamically updated by some trigger.\nIf this functionality will be useful for development purpose, I will say maybe (as I have no experience in UI development I cannot come up with example. Maybe somebody can back me up on this one.) \nBut it does exist in: Prototype and JQuery, so there should be a reason for it. \n. Thanks to everyone for help!\n. @DimitarChristoff \n  If everyone who does testing need to add some additional methods around framework. In order to have reliable tests that can be automated.  Then you may aswell add this functionality into the framework. \nI'm making assumption that there are people who does make test automation. \n. ",
    "rustyx": "If this is not a bug, what is it, then?\nMootools does not support SVG documents?\nThen this is a feature request.\nPlease reopen.\n. jsfiddle is limited to HTML documents, I'm talking about native SVG, not SVG inlined in HTML.\nHere's an example in which I'm trying to capture some events with MooTools:\nhttp://rustyx.org/temp/moosvg.svg\n. Moving the code does not help.\nAlso doesn't wrapping it in onload and on-DOMReady as in the examples below...\nhttp://rustyx.org/temp/moosvg.svg\nhttp://rustyx.org/temp/moosvg2.svg  (onload - no luck)\nhttp://rustyx.org/temp/moosvg3.svg  (DOMReady never fires)\nAnd for completeness, defining SVG onload doesn't work either.\nhttp://rustyx.org/temp/moosvg4.svg  (using <svg onload=...>)\n. If this is not a bug, what is it, then?\nMootools does not support SVG documents?\nThen this is a feature request.\nPlease reopen.\n. jsfiddle is limited to HTML documents, I'm talking about native SVG, not SVG inlined in HTML.\nHere's an example in which I'm trying to capture some events with MooTools:\nhttp://rustyx.org/temp/moosvg.svg\n. Moving the code does not help.\nAlso doesn't wrapping it in onload and on-DOMReady as in the examples below...\nhttp://rustyx.org/temp/moosvg.svg\nhttp://rustyx.org/temp/moosvg2.svg  (onload - no luck)\nhttp://rustyx.org/temp/moosvg3.svg  (DOMReady never fires)\nAnd for completeness, defining SVG onload doesn't work either.\nhttp://rustyx.org/temp/moosvg4.svg  (using <svg onload=...>)\n. ",
    "nyov": "Unless slack.com has gotten much better in regards to open collaboration (non-team member joining chats), I feel IRC is still superior as an open medium. Lot's of clients, easy to join in, while slack and gitter are pretty much browser-only or require some smartphone 'app' to partake.\nSlack may be good for companies/teams that have a need to lock down their communications, but it doesn't mesh so well with free software dev communication requirements IMHO.\n. Unless slack.com has gotten much better in regards to open collaboration (non-team member joining chats), I feel IRC is still superior as an open medium. Lot's of clients, easy to join in, while slack and gitter are pretty much browser-only or require some smartphone 'app' to partake.\nSlack may be good for companies/teams that have a need to lock down their communications, but it doesn't mesh so well with free software dev communication requirements IMHO.\n. ",
    "lorenzos": "Not sure about firing 'failure', docs says it is for when the request failed (error status code), here we aren't dealing with a failed request, but more likely with an unexpected response (i.e. not JSON). \nIMHO the three possible options are, in order of my preference:\n1. Modify Request.JSON line 39 with this.fireEvent('complete').fireEvent('error', [text, error]);.\n2. Fix documentation, specifying 'complete' is not fired in case of successful request but parsing error. \n3. Do nothing. \n. (sorry, I accidentally clicked the wrong button)\n. Not sure about firing 'failure', docs says it is for when the request failed (error status code), here we aren't dealing with a failed request, but more likely with an unexpected response (i.e. not JSON). \nIMHO the three possible options are, in order of my preference:\n1. Modify Request.JSON line 39 with this.fireEvent('complete').fireEvent('error', [text, error]);.\n2. Fix documentation, specifying 'complete' is not fired in case of successful request but parsing error. \n3. Do nothing. \n. (sorry, I accidentally clicked the wrong button)\n. ",
    "Continuities": "https://jsfiddle.net/Continuities/bo1zm146/3/\n1. Run fiddle in Chrome on desktop and scroll the view. Note that the number (getPosition().y of the target element) goes up, representing a position relative to the document.\n2. Spoof an iOS useragent (don't actually load jsFiddle on an iPhone. The layout doesn't work properly), and reload. Scroll the view. Note that the number stays 0,  representing a position relative to the viewport.\n. It's expected that getPosition should behave differently between iOS and desktop Chrome?\n. Not the behaviour I'm seeing. Wrapping the entire thing in an unstyled div does nothing to change the inconsistency between desktop and iOS. I know exactly where the bug is, and reported it in the original issue description.\n. Chrome dev tools with an iOS user-agent. I don't really care which behaviour you choose (either document-, or viewport-relative), I just want it to be consistent between platforms. It should not be necessary to implement workarounds (like getOffsetParent) to achieve consistency.\n. Are you reloading between switching devices? The user-agent is only actually updated if you refresh. It's not a Chrome issue, it's caused by the two different code-paths in getOffsets behaving differently:\nThe first block (inside the if (hasGetBoundingClientRect) conditional) only checks the current element for position:fixed. This is the block that desktop uses. The second block walks up the DOM and adds offsets all the way up. This is the block that iOS uses.\nI can fix the issue myself, if necessary. I just don't want to bother cloning the project and making a pull request.\n. > the scroll hand moves in the opposite direction from cursor\nThat just sounds like it's switched to touch-based scrolling. There is a jsFiddle error thrown, but it doesn't appear to cause any problems.\n\nIf you change the library, please do not change desktop Chrome behaviour.\n\nSee, that's the issue. I think iOS is behaving correctly in this instance, and not desktop Chrome. Behaviour could be consolidated to be \"wrong\" everywhere, but that doesn't feel like the right answer. I'll leave it up to the MooTools dev community.\n. It's an external dependency. None of the code would work without MooTools.\n. While trying to write a spec to capture this behaviour, I discovered another interesting quirk: The bug disappears if the scrolling element is any element other than the window (ie, the fixed malarky is inside a div with overflow:scroll instead of directly inside the window). Looks like element scrolls are subtracted out, while html scrolls are not.\n. That code still exhibits the inconsistent behaviour that I described. I don't think you're properly emulating iOS user-agents.\n. It's alright =)\n. https://jsfiddle.net/Continuities/bo1zm146/3/\n1. Run fiddle in Chrome on desktop and scroll the view. Note that the number (getPosition().y of the target element) goes up, representing a position relative to the document.\n2. Spoof an iOS useragent (don't actually load jsFiddle on an iPhone. The layout doesn't work properly), and reload. Scroll the view. Note that the number stays 0,  representing a position relative to the viewport.\n. It's expected that getPosition should behave differently between iOS and desktop Chrome?\n. Not the behaviour I'm seeing. Wrapping the entire thing in an unstyled div does nothing to change the inconsistency between desktop and iOS. I know exactly where the bug is, and reported it in the original issue description.\n. Chrome dev tools with an iOS user-agent. I don't really care which behaviour you choose (either document-, or viewport-relative), I just want it to be consistent between platforms. It should not be necessary to implement workarounds (like getOffsetParent) to achieve consistency.\n. Are you reloading between switching devices? The user-agent is only actually updated if you refresh. It's not a Chrome issue, it's caused by the two different code-paths in getOffsets behaving differently:\nThe first block (inside the if (hasGetBoundingClientRect) conditional) only checks the current element for position:fixed. This is the block that desktop uses. The second block walks up the DOM and adds offsets all the way up. This is the block that iOS uses.\nI can fix the issue myself, if necessary. I just don't want to bother cloning the project and making a pull request.\n. > the scroll hand moves in the opposite direction from cursor\nThat just sounds like it's switched to touch-based scrolling. There is a jsFiddle error thrown, but it doesn't appear to cause any problems.\n\nIf you change the library, please do not change desktop Chrome behaviour.\n\nSee, that's the issue. I think iOS is behaving correctly in this instance, and not desktop Chrome. Behaviour could be consolidated to be \"wrong\" everywhere, but that doesn't feel like the right answer. I'll leave it up to the MooTools dev community.\n. It's an external dependency. None of the code would work without MooTools.\n. While trying to write a spec to capture this behaviour, I discovered another interesting quirk: The bug disappears if the scrolling element is any element other than the window (ie, the fixed malarky is inside a div with overflow:scroll instead of directly inside the window). Looks like element scrolls are subtracted out, while html scrolls are not.\n. That code still exhibits the inconsistent behaviour that I described. I don't think you're properly emulating iOS user-agents.\n. It's alright =)\n. ",
    "ciez": "afaik this is expected behaviour. getPosition is calculated re: relative positioned parent.\nCSS behaves smilarly: offset is specified re: relative positioned parent.\n. top div is rarely set position:fixed. This may be allowed however this may be causing the issue.\nI just tried to wrap entire html in another generic <div> (position:inherited/not set), spoofed IPad and IPhone 6. \nbehaviour is similar to desk Chrome: the number is updated.\njust remember that position get / set works relative to nearest non-fixed parent. This is aligned with CSS.\n. how do you spoof iOS?\nwhat if you getOffsetParent and pass the parent to getPosition? does it work as you need it?\nif position is calculated relative to any parent regardless of their fixed / relative attribute, this would lead to different behaviour from CSS and from how it works now.\n. I use toggle device toolbar. Is this the same thing?\nactually, even without adding generic div, behaviour is similar.\nthere may be differences in Chrome versions. Do you use Linux too?\nalso (just checking) did you disable cache in dev-tools?\n. I tried to reload. \njs fiddle code (not your snippet, jsfiddle editor js file) throws an error. Scrolling behaviour after this error is very odd: the scroll hand moves in the opposite direction from cursor. I suppose it may be caused by jsfiddle's error.\nAs a side note: I am not Mootools library dev - a user like yourself. I remembered I was surprised to find out how position fixed and relative are different. Thought I could help.\nTo check your code, I need to load your example outside of jsFiddle. Let me do this in the next few days.\nIf you change the library, please do not change desktop Chrome behaviour.\n. just noticed that https://jsfiddle.net/Continuities/bo1zm146/3/  does not use MooTools. Javascript is set to No-library (pure Js)\nis this intended? Are we testing MooTools then?\n. do not iOS capture other event, not scroll?\nI modified your code to this\niOS (drag?) behaves similar to desktop scroll\nupd: I had forgot to reload. iOS shows 0.\n. I overlooked that sticky has position fixed and thought about absolute vs relative / not set attributes.\nI am not sure what getPosition should return for fixed elements and their children. I'd never tried it.\nSorry about the confusion. I can't help.\n. afaik this is expected behaviour. getPosition is calculated re: relative positioned parent.\nCSS behaves smilarly: offset is specified re: relative positioned parent.\n. top div is rarely set position:fixed. This may be allowed however this may be causing the issue.\nI just tried to wrap entire html in another generic <div> (position:inherited/not set), spoofed IPad and IPhone 6. \nbehaviour is similar to desk Chrome: the number is updated.\njust remember that position get / set works relative to nearest non-fixed parent. This is aligned with CSS.\n. how do you spoof iOS?\nwhat if you getOffsetParent and pass the parent to getPosition? does it work as you need it?\nif position is calculated relative to any parent regardless of their fixed / relative attribute, this would lead to different behaviour from CSS and from how it works now.\n. I use toggle device toolbar. Is this the same thing?\nactually, even without adding generic div, behaviour is similar.\nthere may be differences in Chrome versions. Do you use Linux too?\nalso (just checking) did you disable cache in dev-tools?\n. I tried to reload. \njs fiddle code (not your snippet, jsfiddle editor js file) throws an error. Scrolling behaviour after this error is very odd: the scroll hand moves in the opposite direction from cursor. I suppose it may be caused by jsfiddle's error.\nAs a side note: I am not Mootools library dev - a user like yourself. I remembered I was surprised to find out how position fixed and relative are different. Thought I could help.\nTo check your code, I need to load your example outside of jsFiddle. Let me do this in the next few days.\nIf you change the library, please do not change desktop Chrome behaviour.\n. just noticed that https://jsfiddle.net/Continuities/bo1zm146/3/  does not use MooTools. Javascript is set to No-library (pure Js)\nis this intended? Are we testing MooTools then?\n. do not iOS capture other event, not scroll?\nI modified your code to this\niOS (drag?) behaves similar to desktop scroll\nupd: I had forgot to reload. iOS shows 0.\n. I overlooked that sticky has position fixed and thought about absolute vs relative / not set attributes.\nI am not sure what getPosition should return for fixed elements and their children. I'd never tried it.\nSorry about the confusion. I can't help.\n. ",
    "esr360": "I am using the nocompat task. I require an unminified copy of the compiled file ideally for my project, otherwise you are correct I could use the regular compat task which may not use the eslint task.\nCurrently I have these tasks to handle this issue for me:\njs\n            mooTools_windows: {\n                src: 'assets/vendor/MooTools-Core/.eslintrc',\n                overwrite: true, \n                replacements: [{\n                    from: 'linebreak-style: [2, unix]',\n                    to:   'linebreak-style: [2, windows]'\n                }]\n            },\n            mooTools_reset: {\n                src: 'assets/vendor/MooTools-Core/.eslintrc',\n                overwrite: true, \n                replacements: [{\n                    from: 'linebreak-style: [2, windows]',\n                    to:   'linebreak-style: [2, unix]'\n                }]\n            }\nThen further down I have something like:\njs\n        if (process.platform === 'win32') {\n             assetTasks.push('replace:mooTools_windows');\n        };\nWhich seems crazy but in order to fit within my workflow it is a neccessery step currently if I wish to use MooTools Core on Windows.\n. @timwienk Thank you very much, your change seems to have solved the issue for me :)\n. I am using the nocompat task. I require an unminified copy of the compiled file ideally for my project, otherwise you are correct I could use the regular compat task which may not use the eslint task.\nCurrently I have these tasks to handle this issue for me:\njs\n            mooTools_windows: {\n                src: 'assets/vendor/MooTools-Core/.eslintrc',\n                overwrite: true, \n                replacements: [{\n                    from: 'linebreak-style: [2, unix]',\n                    to:   'linebreak-style: [2, windows]'\n                }]\n            },\n            mooTools_reset: {\n                src: 'assets/vendor/MooTools-Core/.eslintrc',\n                overwrite: true, \n                replacements: [{\n                    from: 'linebreak-style: [2, windows]',\n                    to:   'linebreak-style: [2, unix]'\n                }]\n            }\nThen further down I have something like:\njs\n        if (process.platform === 'win32') {\n             assetTasks.push('replace:mooTools_windows');\n        };\nWhich seems crazy but in order to fit within my workflow it is a neccessery step currently if I wish to use MooTools Core on Windows.\n. @timwienk Thank you very much, your change seems to have solved the issue for me :)\n. ",
    "NaridaL": "@SergioCrisostomo Thanks for the info, I had missed something, as I thought. However it seems the underlying issue of the broken links and the doc not being very informative is still open...?\n. @SergioCrisostomo Thanks for the info, I had missed something, as I thought. However it seems the underlying issue of the broken links and the doc not being very informative is still open...?\n. ",
    "dizel3d": "Seems, the reason is that in compatibility mode MooTools replaces Function.prototype.bind (that used by React) with non-standard implementation. #2511\nI guess it won't be fixed.. Seems, the reason is that in compatibility mode MooTools replaces Function.prototype.bind (that used by React) with non-standard implementation. #2511\nI guess it won't be fixed.. ",
    "Adidi": "iphone7 works fine for me. when I used with IOS6 (or iphone 6 - I am not really a fanboy to know this difference - i use android) i had this bug - had to switch to native DOMContentLoaded for it to work again \nOh - and I use latest mootools 1.6\n. iphone7 works fine for me. when I used with IOS6 (or iphone 6 - I am not really a fanboy to know this difference - i use android) i had this bug - had to switch to native DOMContentLoaded for it to work again \nOh - and I use latest mootools 1.6\n. ",
    "junghyun87": "@timwienk Thanks for your kind explanation. . @timwienk Thanks for your kind explanation. . ",
    "leonardfischer": "Hi, thats too bad, but I understand your point.\nI'll take a look at visibilityjs, thanks! I guess this ticket can be closed then?\nAnd nope, just chose this nick many years ago because I'm a huge fan of \"Metal Gear Solid\". Hi, thats too bad, but I understand your point.\nI'll take a look at visibilityjs, thanks! I guess this ticket can be closed then?\nAnd nope, just chose this nick many years ago because I'm a huge fan of \"Metal Gear Solid\". ",
    "olgierd23": "Unfortunately, I am afraid I could not. It have happened in my system (which is quite big and complicated) some time ago, and I found this issue during debbuging. I fixed it in the above mentiond way and did not make any notes concerning the situation. So now I only know that there was the issue, but can not recover that situation again. :-(. Unfortunately, I am afraid I could not. It have happened in my system (which is quite big and complicated) some time ago, and I found this issue during debbuging. I fixed it in the above mentiond way and did not make any notes concerning the situation. So now I only know that there was the issue, but can not recover that situation again. :-(. ",
    "ArmanGrewal": "Here is the scenario - https://jsbin.com/pahibazamu/edit?html,output\nThird party js is using new Event(\"something\") and It is creating issue in mootools library.\n\n. Thank you. It makes sense.\nHow Can I download nocompat version from https://github.com/mootools/mootools-core/tree/master/Source?. I want to download a whole folder structure rather than one js file/ cdn js file.\nIs there any way to download folder structure nocompact version?\nsomething like - https://github.com/mootools/mootools-core/tree/master/Source. Hi timwienk,\nI have one quick question for you. If we use to no compat version, then are we loosing any old browser support(eg: IE8, old safari browsers..)?\nThanks,\nArmandeep. Here is the scenario - https://jsbin.com/pahibazamu/edit?html,output\nThird party js is using new Event(\"something\") and It is creating issue in mootools library.\n\n. Thank you. It makes sense.\nHow Can I download nocompat version from https://github.com/mootools/mootools-core/tree/master/Source?. I want to download a whole folder structure rather than one js file/ cdn js file.\nIs there any way to download folder structure nocompact version?\nsomething like - https://github.com/mootools/mootools-core/tree/master/Source. Hi timwienk,\nI have one quick question for you. If we use to no compat version, then are we loosing any old browser support(eg: IE8, old safari browsers..)?\nThanks,\nArmandeep. ",
    "bamyasi": "Unfortunately, no. jsFiddle now requires a mandatory use of https for resources URIs and I do not have https configured on our servers. So it does not work.. Ok, I was able to create a jsFiddle test snippet by loading JS libraries from external https hosts: https://jsfiddle.net/oz6n3cba/8/\nLooks like this simple jsFiddle test works fine. It toggles on/off the display of placeholder string if you click on (invisible, sorry) button located to the left of \"3D Visualization\" string. This does not depend on the order in which external JS libraries are loaded.\nHowever, this still does not work with my pages. I tried removing temporarily other JS libraries loading, rearranging loading order, etc. Nothing helps, it's always -- TypeError: document.id(...) is null.\nTry clicking on any of the \"+\" buttons to trigger the error here: http://genetics.bwh.harvard.edu/ggi/pph2/54a41688da654151eb4cc1a20a584349692aef0e/4399616.html\nOn contrast, try properly working toggle block display buttons with the old version of the page here (no JSmol applet): http://genetics.bwh.harvard.edu/ggi/pph2/54a41688da654151eb4cc1a20a584349692aef0e/4399616-orig.html. After some more testing, it turns out that removing the actual JSmol embedded Javascript from the page body (while still loading JSmol library in the head section) makes toggle buttons work again.. I fixed my code eventually by getting rid of the document.id() calls and reverting to using document.getElementById() instead. Ugly but works. I was unable to find out how exactly JSmol applet initialization screwed up the page, breaking mootools.. Unfortunately, no. jsFiddle now requires a mandatory use of https for resources URIs and I do not have https configured on our servers. So it does not work.. Ok, I was able to create a jsFiddle test snippet by loading JS libraries from external https hosts: https://jsfiddle.net/oz6n3cba/8/\nLooks like this simple jsFiddle test works fine. It toggles on/off the display of placeholder string if you click on (invisible, sorry) button located to the left of \"3D Visualization\" string. This does not depend on the order in which external JS libraries are loaded.\nHowever, this still does not work with my pages. I tried removing temporarily other JS libraries loading, rearranging loading order, etc. Nothing helps, it's always -- TypeError: document.id(...) is null.\nTry clicking on any of the \"+\" buttons to trigger the error here: http://genetics.bwh.harvard.edu/ggi/pph2/54a41688da654151eb4cc1a20a584349692aef0e/4399616.html\nOn contrast, try properly working toggle block display buttons with the old version of the page here (no JSmol applet): http://genetics.bwh.harvard.edu/ggi/pph2/54a41688da654151eb4cc1a20a584349692aef0e/4399616-orig.html. After some more testing, it turns out that removing the actual JSmol embedded Javascript from the page body (while still loading JSmol library in the head section) makes toggle buttons work again.. I fixed my code eventually by getting rid of the document.id() calls and reverting to using document.getElementById() instead. Ugly but works. I was unable to find out how exactly JSmol applet initialization screwed up the page, breaking mootools.. ",
    "Oliv": "I think this reproduces the behaviour : https://jsfiddle.net/68jghwo6/1. I think this reproduces the behaviour : https://jsfiddle.net/68jghwo6/1. "
}