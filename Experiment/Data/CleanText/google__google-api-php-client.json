{
    "ianbarber": "Good question! Its basically usage - we are still seeing ~50% of usage on 5.2. Hopefully that will shift over the next few months and we can move to at least 5.3 support, we would love to be able to move to namespaces in particular.  Kind of the same with autoloading - at lot of the existing usecases are pretty simple, and so we've held off, but again it would be great to move to a fully autoloaded setup. That would also require a change to template generation for the API classes (Google_Service_* basically). \nThe aim of 1.0.0 is primarily to get us a decent base that could be built on, and hopefully bring in those kind of changes after. \n. Thanks, still thinking about the best way to do the service scoping, but will pick up the typo in another commit. \n. Thanks!\n. This was actually somewhat intentional, as the scopes are somewhat inconsistently documented - we considered not doing any automatic scope retrieval because it regularly doesn't deliver what is expected. What was being done in 0.6 was guessing at the scope based on service name, which didn't aways work either. \nFor example, the userinfo APIs do document those four scopes, but there is both redundancy and over-scoping in there. Requesting all possible scopes would definitely make the calls work, but would also lead to consent dialogs with more scopes than are really required. \nMy inclination is to go back to removing automatic scope selection entirely, as, for this API in particular, there is no decent single scope choice. You probably want userinfo.email and userinfo.profile, but not the plus scopes, for example. For most of the other APIs I suspect selecting the shortest scope will give a sane default, but that would give plus.me in this case, which would only return the user ID. \n. Hmm, I'm not sure we should be automatically selecting scopes at all. The simplest solution from a library point of view would be to remove the defaulting of any scopes, and require that they are manually set. This is how several of the other client libraries work. That would also remove the need to do addService.\nThe previous version of the client library basically guessed, by setting a scope based on the name of the service. This worked in some cases, not in others, and caused too much access in others.\nThe current strategy of selecting just the first scope clearly has issues (e.g. the most generic YouTube scope is in the middle of the bunch), but requesting all scopes wouldn't fit either. @alvarolb regarding your suggestion, if the user is going to the trouble to request setRequestedScopes, then they may as well do that on the client directly. How about: \n1. No scopes are requested automatically\n2. We add a new addScope method to the client which will add the scope and automatically supress duplicates\nTo make life easier we could look at adding friendly constant names for scopes (e.g. Google_Service_YouTube::SCOPE_YOUTUBE_READONLY) though writing it out now it doesn't look much shorter! We could also check that there are services connected which provide the scopes, to try and avoid typo'd scopes. \nWe could also make this a configurable behaviour. Overall though, I think requiring the scope to be specified is the only really sustainable choice.\n. Closing this one for now - there's a bit of tidy up pending the next batch of template changes, but the move to manually specifying scopes is in. As for the next template change we'll have some friendlier constant names that can be references for the scopes as well (though they're attached to our current long class names, so the benefit is cognitive rather than finger mileage!). \n. Closing this one as we have ditched most of this process in favour of manual scopes after the discussion in the issue. Thanks!\n. This library doesn't (and wont) support the older GData APIs - though @silvolu correct me if there's a more modern equivalent of this one. \n. Looks like a bug in the automatic service generation. I think in those parameters we should be using the wire name rather than the PHP variable friendly name. \n. So the object that comes back implements arrayaccess, so you should be able to treat it like an array. What were you looking to do?\n. There is actually a broadly similar method in the library now. On the objects that get returned you can call toSimpleObject. This returns it as an object rather than an array, but it might be easier to translate that than the main method.\nI like the idea of making a way of just getting the raw JSON though, which would be helpful for debugging if nothing else. \n. I'm going to track the raw JSON idea separately, so closing this one. \n. Good plan on the docfix, thanks man. @fillup, as @silvolu says we're not ready to go to requiring 5.3 yet unfortunately, but you're right that is an eventual goal. WRT separating files - the problem with that is that you pay a stat overhead because of the fan out of files if you're not using autoloading, though I haven't benchmarked it to be honest. I think we'll shift to that model when we move to the namespaced code though - I am hoping we'll see a big enough shift in 2014 of installed PHP version, though I did expect to see in 2013 as well :)\n. Good suggestion! That actually makes a lot more sense as a default, thanks. Brief bit of lawyercatting before merging the PR: Have you previously signed the Google CLA at all? If not, could you fill in the form at the bottom of https://developers.google.com/open-source/cla/individual?csw=1 ?\n. Great, thanks!\n. Good call, agree with you on the bug and best fix. There is definitely work that can be done to improve that caching class, but for now have just moved to using fwrite in https://github.com/google/google-api-php-client/pull/24\n. #24 merged.\n. Unfortunately the contacts API is one of the older GData ones, while this library is for the newer APIs. You can use the OAuth part of the library to request the scope (https://www.googleapis.com/auth/contacts.readonly), and use the token to make the request, but you'll have to parse the data manually. Zend Framework does have the Zend_Gdata classes that might make reading the results a bit easier!\n. Which APIs were you looking at that needed this, or was this for use with non-Google APIs?\n. This makes sense, we should just need to supply the header and run the response through the compress.zlib stream handler. \n. Hmm, could you provide a test case that demonstrates this? Returning the exceptions in the responses should be the default behaviour (see https://github.com/google/google-api-php-client/blob/master/src/Google/Http/Batch.php#L127) but there may be bugs (looking at that code, my first thought is that other types of exception are thrown)!\n. Seems reasonable! Would you mind signing the Google CLA, then we can get this merged:  (see https://developers.google.com/api-client-library/php/contribute for more). The individual CLA is at: http://code.google.com/legal/individual-cla-v1.0.html (you can submit in the form at the bottom). \n. Thanks, those are all my bads, must have just completely failed to run that one! Would you mind signing the Google CLA, then we can get this merged: (see https://developers.google.com/api-client-library/php/contribute for more). The individual CLA is at: http://code.google.com/legal/individual-cla-v1.0.html (you can submit in the form at the bottom).\nIf too much of a pain, no worries, I'll pick up those mistakes on my next pull.\n. Had to make these changes (well the broken bits) to test #34, so we'll merge it with those - i picked up the comment fix as well, thanks!\n. (moving this comment to the PR instead of the commit!) Good suggestion. I think we are going to run into some trouble around this in general, as I'm not entirely convinced on how the conversion back and forth is taking these properties into account - there has been a recent change to the template generator which is having some effect.\nWould you mind signing the Google CLA, then we can get this merged: (see https://developers.google.com/api-client-library/php/contribute for more). The individual CLA is at: http://code.google.com/legal/individual-cla-v1.0.html (you can submit in the form at the bottom).\n. Ah yes, thanks!\n. Dupe of #30 \nYour analysis is correct, #34 should resolve the issue. \n. Yep, this is #30 - will fix\n. Reasonable point. We actually had a separate IO implementation for cURL, but I prefer your idea of auto selecting - I might tweak how the calls are abstracted (to make it a bit easier to test), but patch looks decent. \nWould you mind signing the Google CLA, then we can get this merged: (see https://developers.google.com/api-client-library/php/contribute for more). The individual CLA is at: http://code.google.com/legal/individual-cla-v1.0.html (you can submit in the form at the bottom).\n. We can't accept any contributions without a signed CLA unfortunately, but regardless cURL seems like the right approach - its a worthwhile addition even if we have to do it in a separate PR.\n. This needs a bit of a rebase, but don't worry as I'm going to chop it up slightly differently and submit a separate PR for it based on this one - will update when done. \n. Changed now rolled in to #93 \n. There should be a getDataTable function on the model or collection object - check that you're using the version from master here, just in case there have been changes since 1.0.0-alpha. \n. Had a check, and I am not seeing any problem with the etag. Do you have a small example of a call that breaks without your change? And any more details on which platform you are running on (OS, version of PHP etc.)\n. I'll close this for now - but feel free to reopen if you can reproduce the error or have any more details! Thanks for raising the issue!\n. Interesting,  we are only asking for responses in gzip so this odd. I'll do some benchmarking to make sure this isn't a general problem, and take a look at upload in particular - we may want to disable gzip by default in that case. The config update is the right option in the mean time though \n. Sounds like it isn't an issue with the client as you say, but no clue whether there are extra restrictions on YouTube uploads unfortunately. I'd be surprised if it was keepalive as well, the file_get_contents should be closing that connection at the end. \n. Closing this one in favour of #59 \n. plus.login can never be at the start of a scope string (it needs https://www.google etc.) so the line is correct. \nThe partner API is generated by the YouTube team and is not part of the main library. Please ask a question on SO (or update the previous one) for that type of support. \n. Daniel - I've pinged someone on YouTube, but unfortunately that API is not part of the public discovery doc: https://developers.google.com/discovery/v1/reference/apis - so it will never automatically generate into this library, you're always going to have to get it from YouTube. Sorry for the inconvenience, but we don't deal directly with the individual APIs, just the generic structure around them!\n. Thanks I appreciate this is frustrating, thought please also remember that the documentation you linked to is for a partner only programme, not generally available: https://developers.google.com/youtube/partner/. I believe the best place to go for the code is to ask a question on stack overflow: http://stackoverflow.com/questions/ask?tags=youtube-api\n. Ibrahim: but the sample works for you with master or beta right? If not and\nthere is another null stripping bug raise an issue and I'll have a look.\nOn 27 Jan 2014 18:36, \"Ibrahim Ulukaya\" notifications@github.com wrote:\n\nHi Ian,\nCode was working earlier and it still works for me with the version cuts I\nhave. I believe \"not stripping nulls\" bug repeated later again with recent\nchanges.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/google/google-api-php-client/issues/52#issuecomment-33405691\n.\n. Additionally: I don't think I can call the partner API as it's non-public,\nso if you can repro would it be OK to try and generate a similar error\nagainst the public api? I can use that for a test for future versions then.\nOn 27 Jan 2014 20:29, \"Ian Barber\" ian.barber@gmail.com wrote:\nIbrahim: but the sample works for you with master or beta right? If not\nand there is another null stripping bug raise an issue and I'll have a\nlook.\nOn 27 Jan 2014 18:36, \"Ibrahim Ulukaya\" notifications@github.com wrote:\n\nHi Ian,\nCode was working earlier and it still works for me with the version cuts\nI have. I believe \"not stripping nulls\" bug repeated later again with\nrecent changes.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/google/google-api-php-client/issues/52#issuecomment-33405691\n.\n. Think I see the issue! Have added tests and a fix in #71\n. self-merging so I can look at MOE.\n. Hmm, docs state that it should return a 200. https://developers.google.com/accounts/docs/OAuth2WebServer#tokenrevoke\n\n\n\"If the revocation is successfully processed, then the status code of the response is 200. For error conditions, a status code 400 is returned along with an error code.\"\nWhen I tested, I was also seeing the code come back properly. Are you sure the token hadn't previously expired? If you can repro, re-open the issue with a code sample and we can fix, but I'm pretty sure its correct as-is.\n. Very odd, I can see the same thing when uploading to drive. Disabling the gzip seems to bring it back to normal, which is rather confusing. I'll poke around a little more, but we may just need to automatically disable gzip for file upload, which is straightforward. \nWorkaround is to disable it manually using: $client->setClassConfig(\"Google_Http_Request\", \"disable_gzip\", true);\n. So what I can see is compress.zlib doing an absolute tonne of writes on the upload, which is not very helpful. Unfortunately, I can't find a wonderful work around that lets us deal with the stream filter in a decent way, so I think disabling on uploads will be the best bet. \n. Patched in #65 \n. Yep, its good for that. Feature request noted: we would also like to move to namespaces once we feel comfortable dropping 5.2 support.\n. Yep, if you can post the code that would help - that's in the reflection part, but even then that's a rather large amount of memory to be using!\n. I'll close this for now, but if you can post the code, or anyone stumbles over it while searching and has hit the same issue - happy to attempt to investigate if we can repro. \n. Nope, just a regular typo. Will fix in next PR.\n. Hi, we don't do individual API examples in the client library repo (just generic ones that demonstrate library usage). Try pinging the blogger team to see if they have any examples. https://groups.google.com/forum/#!forum/bloggerdev\n. Thanks! Would you mind signing the Google CLA, then we can get this merged: (see https://developers.google.com/api-client-library/php/contribute for more). The individual CLA is at: http://code.google.com/legal/individual-cla-v1.0.html (you can submit in the form at the bottom).\n. Ah yep, I see it, sorry must have missed it before!\n. There's no specific retrying in the library, but it would be pretty trivial to implement a helper that can offer exponential backoff to save people have to do it themselves. I'll take a look at it when I get a chance. \n. Thanks, will update.\n. Hmm, we do try and unlink on expiry, but that wouldn't help too much if there are lots of requests which never get used again. I'll do some checking to see if our rules for cachability are off - we could be doing a lot more than needed. We could also build something in to do a purge every now and again - or at least a note for the documentation. \n. Can you confirm that this works in other API clients or via the API explorer - e.g. that it is an issue with the library rather than with the API (we can't help on the API itself unfortunately!)\n. I'm going to close this as I've not got enough experience with fusion tables to recreate the issue. If someone can reproduce it and has a minimal code sample, we can look into it further though. \n. Added code in #126 \n. I presume you have configured with OAuth in this case? Can you post the code you're using? \n. Thanks for updating! For the synching question, could you ask on the google-drive-sdk StackOverflow tag? There are Drive specialists that monitor that tag who will know what the best approach here is!\nhttps://developers.google.com/drive/support\n. That is odd. http_build_query uses arg_separator.output, which I guess is set to &amp for some people now! Most of our test versions are 5.4, but of course depends where you get your ini file. Your fix looks good to me - I can do that next week, or @silvolu might still be doing PHP stuff today.\n. Thanks, I was unaware of the issue with the headers not being passed, both suggestions sound good. \n. Sent a PR for both issues, #79 \n. Sounds reasonable, will drop this in next time I'm working on the lib or feel free to send a PR (modulo CLA in https://developers.google.com/api-client-library/php/contribute). Thanks!\n. If you mean the nulls in the object - the properties are defined on the object, and will be null if not data is supplied - the fields value is correctly not requesting them, so they are not present. \n. Thanks! Fixed in #93 \n. Yeah, that makes a lot of sense - we can make that a value in the config class I'd say.  Feel free to send a PR (see https://developers.google.com/api-client-library/php/contribute), or we will try and get to it in a future update!\n. There's composer autoloader support included. All classes map e.g. Google_Foo_Bar is in Google/Foo/Bar.php. If not using composer just ensure your include_path includes the src/ folder - all includes are relative to that - e.g.require_once Google/Foo/Bar.php\nIn the original issue, the easiest fix is adding the src folder to the include path.\n. If it fails through the apis explorer as well its likely an issue with the API itself - try asking the question on the StackOverflow tag which is monitored by people from the cloud team.  http://stackoverflow.com/questions/tagged/google-app-engine\n. Uploads were playing very badly with compress.zlib - we were seeing poor batching on the upload (resulting in more network traffic in the end, and slower uploads). That could be isolated though - could you try removing the hardcoded disableGzip and see whether you get performance benefits? \n. Think there might be a bug on this - I'll create a test case to replicate.\n. Ah darn no, thats the short array syntax in PHP 5.4+ - it didn't occur to me to strip it out when merging in. Will replace with regular array initialisation. \n. Fixed in #97 \n. Fixed in #97\n. Thanks I was about to make this change. have you signed the CLA: https://developers.google.com/api-client-library/php/contribute (see links there)?\n. Same change was needed in Stream.php, so I ended up picking this up in #97  - thanks for the patch though, and please do sign the CLA, then any future PRs we can merge in right away\n. Merging just so other don't hit the 5.4 issue. \n. The DFP API is based in SOAP, and has its own client library as it happens: https://developers.google.com/doubleclick-publishers/docs/clients\n. Thanks!\n. Sorry, slight confusion on the reference there!\n. Thanks for the clear bug report - I am guessing there is an issue with request not being available in some case, but will look into it further!\n. That serialised blob really has gone wrong hasn't it. I am wondering if we are having contention on the cache file, which implies the locking is not working well. Agree that a reasonable approach in the short term is reject invalidate cached objects, and longer term will have a look to see whether we can  resolving the creation of the bad objects. \n. Can you try the latest master and let me see if you see similar issues - hopefully this one will resolve it. \n. So you shouldn't need to do both sign and authenticatedRequest - the latter does the former. Looking at the code it shouldn't cause an error though. Which scopes are you authenticating with, out of interest?\n. Do you get the same errors if making the calls without using the client library (e.g. cURL, or the API explorer)? I am wondering if there might be an error with the API itself, which we'd need to report upstream to that team. \n. Can you try disabling gzip and see if that makes any difference? I wonder if there is something odd happening there? $client->setClassConfig('Google_Http_Request', 'disable_gzip', true)\n. 1. You seem to be passing a service account email address as a key. This field is for a simple API access key (which is a random string of letters). Try removing that and see if it helps.\n2. I am guessing because of that your access token was generated by a service account exchange, so make you have delegated permission to the access the user's data to that service account, else it wont work. \nI must admit I don't know whether Drive supports service accounts, or which features are supported. http://stackoverflow.com/questions/tagged/google-drive-sdk will be a much better venue for people who are familiar with the service!\nI'll close this now, but feel free to reopen if you find a bug with the client library implementation specifically. \n. Guessing this is a request for a specific API? You might do better going through the support channel for that particular service - I'm not sure which one importRows is part of, but this issue tracker is only for general bugs in the PHP client library itself. What I might recommend is seeing if you can find a sample in one of the other languages, and try translating that to PHP. Sorry!\n. I actually pulled in prompt as part of some changes the other day. However, I didn't include your nice work only using approval_prompt or prompt - I'll file a separate issue for that, though feel free to resubmit that bit as a PR if you have had chance to sign the CLA!\n. Thanks!\n. This class is generated, so any change would get overriden unfortunately!\n. Yeah, that change should be safe. I'll try it and run the tests. \n. Thanks, fixed in #126\n. As mentioned in the other PR, this class is generated. However, I the fact they're using a different name for the collection type is annoying. We wont merge this, but I'll leave it open for a bit to track the issue in case I or anyone else come up with a good workaround/way of working this into the generator. AFAIK, the discovery doc doesn't indicate the collection type, but we might be able to infer it based on the array typed data if items is not present. \n. We have a fix for the collection key issue, but requires a new generator push - hopefully soon!\n. Nope, once it gets pushed that should start feeding though automatically.\n. These collections should be in better shape now, closing. \n. @silvolu - am i going nuts, or did you do some work around this?\n. Yes please, do sign in the CLA and we can merge a PR! Thanks!\n. Thanks, we went with 3.7 in #126\n. Yep, that's a regression unfortunately - can you signed the CLA linked from https://developers.google.com/api-client-library/php/contribute ? I'll also look at adding a unit test for this case so we catch this in the future. \n. Picked up #126 along with a test, but thanks anyway, and feel free to sign in the CLA for future PRs!\n. Thanks!\n. Good spot, thanks\n. Thanks! Unfortunately the Google_Service files are mostly generated from the discovery documents (https://developers.google.com/discovery/) so merging this would get overwritten :( Is the MQL read available via the API explorer? It should appear in the auto generated if its been added. The fact that reconcile has been picked up but search hasn't looks like a bug - I'll have to check the generator over.\n. Found the bug in the generator on this - going to try and get it merged in then hopefully we should start generating the search call properly. The mqlread function simply isn't in the discovery doc though, so we wont have that - that will need to be taken up with the freebase team. \n. https://bugs.freebase.com/browse/API would be your best bet!\nOn 27 October 2014 07:38, Ferry Kobus notifications@github.com wrote:\n\nHi Ian,\nThanks for fixing the call method. Can you send me in the right direction\nto add the mqlread function? Where can I ask the freebase team to add that\nsupport?\nThanks in advance.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/123#issuecomment-60558254\n.\n. Yeah, that is a PR that got merged in the other day, didn't spot that. Part of the issue is that we don't have any CI running against 5.2, so it's relatively easy to miss this stuff. Should be a simple fix to use Google_IO_Abstract instead of static: there as a workaround in the short term, I'll patch that next time I'm working on the lib.\n. This issue tracker is just for bugs in the PHP library - I think your best best for support on the Admin SDK would be the Stack Overflow tag linked from: https://developers.google.com/admin-sdk/support\n. Thanks, fixed in #126\n. There's no helper in the library to spool a file - load it in chunks with fopen and (I presume, though I don't know the API) use MediaFileUpload to upload in chunks. \n. Thanks - looks like the team changed the name of the API case wise, and the generator pulled it in automatically. \n. Its working on the include_path having the src/ directory in it - all requires are relative to src/. Should happen automatically if using composer, otherwise just add the src/ to the include path. \n. @silvolu FYI \\o/\n. Hi! Where did you find this parameter documented? Its not one I'm familiar with to be honest, which makes me think it may not be a supported bit of functionality - in which case we'd probably leave it as is (undocumented parameters tend to change without warning). If it is though, definitely something we can add!\n. We couldn't track this one down, so I'll close it - if you find it documented though please let us know or send a pull request!\n. Thanks Mat! Any chance you could split that line to keep it under 100 chars?\n. Thanks!\n. Chunked download feels like the right way, as it allows easier retrying. That said, might still be nice to have a helper for working with this. There was a request for something that could handle exponential backoff for uploads - the same kind of logic would be nice for downloads as well. It's a nice feature idea, and I'll leave this open for a bit to see if anyone has time or inclination to work on it!\n. Closing due to inactivity - there has been some discussion of a helper class in other issues though. \n. Hmm, you should be able to call nextChunk on the request again to resume if an error is returned - does that not do as you need? I'm not happy with the lack of testing on this class though - I'm making a note to exercise it more fully. \n. Ah right, interesting point. I think wrapping that all up in a friendly resume token would be a sensible idea. \n. No movement on this, so i'll close for now, but I've made a not in case I get chance to work on this in the future. \n. Thanks David! Have you signed the CLA - details on the contribute page: https://developers.google.com/api-client-library/php/contribute - if not, please do and ping the PR and we'll merge!\n. Thanks!\n. Hmm, fair point! Warnings were causing some people a problem when there were occasional connection failures, but I totally agree that during dev/debugging its a lot easier to see what the error actually is. Ideally, we would be able to get that error and put into the exception, but I'm not sure if there's a good way to do that - certainly don't want to be registering error handlers at the library level, but potentially could set_error_handler just above and restore_error_handler below - then the warning becomes a bit more tractable. \n. Pushed a fix for this in #198 - hopefully that should give us the best of both worlds!\n. I think this may have been fixed in a recent PR, can you retry with the latest master and reopen with sample code if you're still getting the problem?\n. What is the actual bug with the client library here? The answer on SO implies you should wrap the table in a TableSchema as well, so it seems like the error is as expected?\n. Thanks!\n. Hmm, that constant is only in 5.4 from a quick search. We'll need to define it if not present, but otherwise sounds like a good fix. \n. This tracker is only for bugs with the client library itself. Your best bet for an answer is the CSE stack overflow tag: http://stackoverflow.com/questions/tagged/google-custom-search\n. The Contacts API is based on the GData format - this library is only for the newer discovery based services. \n. Sounds reasonable. \n. Thanks! I'll remove this one, but for future reference: https://developers.google.com/api-client-library/php/contribute - you'll need to sign the CLA, but after that just send pull requests and we'll merge!\n. Fixed #158 \n. Does sound like a problem decoding, which feels like openssl version oddness. Have you tried passing the certificate as a string with the certificate, rather than as a file location? \n. Closing due to inactivity.\n. Odd. Can you step through the validate function to see which part it is failing on?\n. Could you see where in the verify function it is hitting an issue? There are multiple checks in there, and might clarify things to see what it is failing on. \n. Can you check the date and time on the machine is right? I'm wondering if there is a bad cached cert or similar.\n. Just delete it - it should be in your system temp file directory. \n. Hmm, just to check you are using an up to date id token for your testing? The Google certificates are rotated every few hours, so an old id token wont be valid any more. \n. Hmm, the token really should not look (exactly) the same week to week - there is a timestamp in there for one. How are you retrieving the id token?\n. Only thing I can guess is that its an incompatibility with the versions of openssl on the machine. Do you know which version of libopenssl or similar you have?\n. I am guessing that is the issue. Not totally sure what might be incompatible, but I think moving to a newer openssl should solve it. \n. Fair enough! Haven't spotted that one so I guess it must be a specific version. Can't see the harm in changing though (adding that comment for posterity in case this triggers some weird bug somewhere else :))\n. Thanks!\n. You can use the library to get the oauth token needed, but sending and retrieving mail in gmail are currently on supported over SMTP and IMAP - this library only covers the Discovery based APIs. Take a look at https://developers.google.com/gmail/oauth_overview for me. \n. Sounds like the issue isn't with the client library but the API itself. This tracker is only for bugs with the PHP client library directly. Perhaps try asking on StackOverflow - see the links in the admin SDK support page: https://developers.google.com/admin-sdk/support\n. Don't believe this is an issue with the client library itself. Re your question, replied with a suggestion on SO. \n. Hmm, I wonder if there are other cases of json_encode escaping overly aggressively that might trigger this. Your fix seems reasonable given the situation - I am thinking it's probably worth adding a test as well with that claimset and output to avoid any future regression. \n. Ack, looks like a straightforward bug. Odd we didn't see that in the tests, I'll make a note to add a case and fix (though feel free to send a PR - there's a CLA hoop to jump through, but otherwise straightforward https://developers.google.com/api-client-library/php/contribute)! \n. Thanks! Did you sign the CLA (http://code.google.com/legal/individual-cla-v1.0.html at the bottom) - I'll merge this then. \n. Thanks!\n. That seems odd, perhaps a bug in Google_Collection? Can you see whether the __get in Google_Model is being called? I am wondering whether one of the recent changes around allowing for null types has caused an error here, and caused the data not to be processed.\n. This is an issue with the collections key being picked up, same as #116  - what we need to do here is fix the class generator for the services. The most straightforward way would likely be not to treat them as collections if the 'items' object isn't present, but if we can I'd like to detect the alternate array name. I will take a look at updating the templates when I have a chance!\n. We have a fix pending for this, needs new template generator to be deployed, which we'll track in 116.\n. Odd, guessing there's just not id token there. Are you using the example as-is, or have you modified it (beyond putting in client ID etc.)?\n. I think this should be OK in the latest version (in that I tested it just now and it looks OK), but if you can repro with the latest reopen and we can look further!\n. Could you open a new issue, ideally with a minimal code sample that shows the problem? It'll get lost as updates to this closed issue I think. \n. Guessing this is a case of #117 \n. This should be fixed with the changes above.\n. Hmm, the Service_ classes are generated, so something odd may have happened there. Is this happening in a specific lib version, or github master?\n. Yep, going to track this in 123.\n. Doesn't look like this method is exposed through the Freebase discovery document, which this library used: https://developers.google.com/apis-explorer/#p/freebase/v1/ - maybe try raising an issue in their issue tracker? http://bugs.freebase.com/browse/API\n. We are limited to only what is in the discovery document, and if the API team aren't looking at those features you best bet is to make the call manually. You can still use the library to do so, but just handle the JSON yourself. \n\nGoogle/Service/Resource:call has the kind of code you want. It'll be something like this (this is off the top of my head so may not be exaclty right!). \nphp\n   $url = Google_Http_REST::createRequestUri(\n        'freebase/v1,\n        'topic/m/03lty,\n       array()\n     );\n     $httpRequest = new Google_Http_Request(\n        $url,\n        'GET',\n        null,\n        null\n     );\n     $httpRequest->setBaseComponent($this->client->getBasePath());\n     $httpRequest = $this->client->getAuth()->sign($httpRequest);\n     $result = $this->client->execute($httpRequest)\n. This tracker is only for issues with the PHP client specifically. Maybe try asking the on Stackoverflow whether this is a general API limitation? https://developers.google.com/drive/support\n. Hmm, we might need to either modify the OAuth class to account for the simpler format of the access token bundle in appengine, or create a separate auth class entirely. The fact that it could go and fetch a fresh token from the appidentity service implies that it would make sense to wrap that whole thing in an alternate auth class, and just select it in configuration. My main concern is how we avoid breaking 5.2 compatibility with the namespace usage. \n. Yeah, I'm thinking it would be OK as long as it didn't get interpreted by 5.2, it's just the risk of it getting included somewhere it shouldn't.\n. I've checked in a simple client to give it a go in #201 - take a look at examples/appengineauth.php and see if that approach would work for you. I'm sure there's practical improvements that can be made, but it should address the immediate issue!\n. I'm wondering if this is because the created value is missing. I think what might be happening is that you're not updating the access token in the $_SESSION after refreshing, so when you go back to the page, it loads the old access token and refreshes again. Try saving it back into the session after you call refresh. You shouldn't need to create an authUrl in that case either (unless the refresh fails).\n. don't do $client::getIo, in PHP its $client->getIo() to access in an object context, :: means static context.\n. If you call it outside of an object context, it will give that error. That is not a bug in the library. \n$tokenInfo = json_decode($client::getIo()->authenticatedRequest($request)->getResponseBody());\n<-- that code is wrong. If you have changed it, then please put in some updated code - without further context there is no issue here - just a clear bug in the code. \n. Thanks!\n. That's the old YouTube API which used the GData API - this library supports the v3 variant. https://developers.google.com/youtube/v3/guides/uploading_a_video\n. Odd. How are you authenticating - could you include a snippet of how you're using the library?\n. I am presuming you are calling verifyIdToken somewhere, but the token is not present. I'll close this for now, but if you have test code that reproduces the issue let us know! I suspect it's probably a case of calling verifyIdtoken when users aren't signed in though.\n. @bonty233 - could you add some sample code that demonstrates the problem and reopen? thanks!\n. Yeah, that code looks wrong. googleLoginCallback looks like its trying to get the code, which implies the code hasn't been exchanged yet. Make sure that before you call the getPayload function there you have either exchanged a code, or loaded the accessToken from the session or similar. \n. We don't include API specific examples within this repo, but if you do create a general refresh token example, please do send a pull request! \n. I'm not aware of any fields that do the equivalent to setting the requestor ID as you describe it. That said, I'm not sure about the specifics of the calendar API: you might do better asking the question in the Calendar forums https://groups.google.com/forum/embed/?place=forum/google-calendar-api&showsearch=true#!forum/google-calendar-api\nI'll close this one as there isn't an issue specific to the PHP client library, but if you do find a supported method that isn't possible in the library, feel free to reopen or raise a new ticket (or send a PR!).\n. Thanks! Have you signed the CLA at http://code.google.com/legal/individual-cla-v1.0.html (form at the bottom) before? We need that for all contributions, otherwise this change looks good to me.\n. Thanks!\n. You'll likely do better asking on the Drive stackoverflow tag than here, as this is for bugs with the PHP library directly. That said, I think your issue is in the ID you're using the parent reference - that doesn't look right to me (it looks like a folder name or similar, when it needs to be the Drive ID of that folder). You'll need to search for the folder (listFiles with the q parameter) and get the ID out of there, then use that for the parent reference.\n. Thanks for asking on SO, that's definitely the right place - this tracker is only for bugs with the lib itself, so I'll close \n. Thanks!\n. Thanks for digging in to this Gordon, looks good to me. \n. I suspect that's not the issue here, else every request using OAuth headers would fail. I suspect something else is the issue here - possibly that the project for the key is not the same as the project for the access token you're using? \n. You don't need the access token at all for those calls, that API is public (so just the API key is fine), so that does make sense. Try going to tokeninfo with one of the access tokens https://www.googleapis.com/oauth2/v1/tokeninfo?access_token= and make sure the setup is as you expect.\n. Tokeninfo in this case returns information about the token itself, not the user - I just wanted to give an option for checking the key and token correspond on the project. I just ran through the tests against OAuth and all passed, so I'm pretty sure its an issue elsewhere. Try making the call with curl on the command line or similar using the access token and key to check. If there is an issue within the library though and you can narrow it down, definitely reopen!\n. What's your use case? IIRC it was removed as a more general JWT verification function was added which allows setting each parameter, verifySignedJwt. \n. Hmm, are you setting the client ID on the client elsewhere? The default audience should be picked up from the auth client id - try $client->setClientId() before calling auth.\n. Can you see if the call works if you make it manually, with cURL etc or in the browser, by visiting: \nhttps://www.googleapis.com/books/v1/volumes?q=Henry David Thoreau&filter=free-ebooks&key=\nOne thing I discovered fairly recently is there are some countries that aren't allowed to call the books API, so I'm wondering if its something along those lines?\n. Ah OK, sounds like the key is the problem if it works without then: can you check that the Books API is enabled in the developer console for the project associated with that key?\n. Yeah, sorry, I wasn't questioning the key, but whether the API was enabled in the APIs section of the project. If you go to the developer console, in the same menu as credentials there should be an APIs menu - can you check Books is enabled in that list? Being that you have the same issue when making the call directly, I suspect the apache issues are unrelated. \n. Thanks stillers!\n. Fixed in #337 337\n. Hmm, I am wondering if we have insufficient scopes in that example. Can you change \"email\" in the scopes string to \"profile\" and see if that helps (and revert your id token -> access token change).\n. Hmm, that is very odd. It may have the token stored in session from before, so can you make sure you've cleared that (just in case you hadn't). \nIf that doesn't help, did you change anything other than adding the client id/clientsecret/redirect URI? Is your account a regular gmail type account or a google apps for domains one? \n. Which API were you using syncToken with? In general that list should only be for generic parameters, of which that may be one, but it must have come from a different list that the on that array is built from. \n. I can see that that's quite an old version of the library you're using - does this issue persist if you use the version on master?\n. The range header is used with the chunked encoding uploads, but I don't think we have any support for downloads in the library beyond just setting the headers on the request directly. They're a general feature I think, so would probably be either a subclass or a helper lib. There is definitely scope for an upload/download helper class that could implement exponential backoff and resume partial uploads and downloads, but its not something anyone is working on AFAIK. \n. Will close this for now, but have made a note in case I have some time to work on this in the future. \n. No, looks like that API is a GData one - this library is only for the newer JSON based ones. I believe there was a Zend_Gdata project that might help there, but I've not used it. \n. If the image makes it up to drive, I'm guessing the issue isn't with the library, and this tracker is for bugs with the library itself. Your best bet is to ask on the Stack Overflow tag: http://stackoverflow.com/questions/tagged/google-drive-sdk - if it does turn out to be a bug in the library, then feel free to reopen an issue here!\n. That is really odd! I think we'll need more information, so you may have to add some logging through the stack. The candidates I would check: \n1. Is the $_GET['code'] value correct looking (is anything weird happening with the request variables)\n2. Is the call succeeding properly (I'm guessing this is using cURL, so maybe adding some logging in Google/IO/Curl.php)\n3. Is anything happening with the caching - it could be using the default file cache (perhaps try swapping to the Null cache to eliminate that as a factor). \nI am guessing its something environmental rather than 5.5 specifically, but not sure. \n. That looks right. Google_Client is a container, so basically you  pass it to the constructor in case it needs and config, and you pass the cache to the client to say \"now use this cache\". So you could construct 2 caches and use them at different points for example. \nDid that make any difference using null?\n. No, that's not required, its just for development usage when working on the lib itself. \nThe only thing I can suggest is try to narrow down exactly which line is triggering the bug. Try adding logging to OAuth2.php, just after $response = $this->client->getIo()->makeRequest($request); , and perhaps before and after $response = curl_exec($curl); in Curl.php - that might help narrow down which PHP command is causing the invalid instructions. \n. The null cache will work OK for testing. That said, your code looks correct - the issue is that something is sending invalid instructions though, which is unlikely to be an issue with the PHP code - it'll probably be an extension or PHP itself being built against the wrong architecture or similar - my guess would be curl or json extensions.\nIn fact, it might be worth trying running a quick json decode in a test script, just to make sure those functions otherwise work properly. \n. You could try switching to streams, see if that helps. $client->setIo(new Google_IO_Stream($client)) or update in the config. \n. Closing due to inactivity.\n. I am not against this, but I am not loving all the dirname calls on includes. I think the better way would be to start moving to autoloading - on the command line you could resolve this by adding a call to set_include_path(\"src/\" . PATH_SEPARATOR . get_include_path()); in the script you're running. \nMy currently inclination is to leave things as-is and look towards moving to autoloading in another patch (which would likely require we split the generated services into individual model classes). @silvolu - do you have strong opinions one way or another?\n. @ltrebing - yep, that should be it. The main complication is identifying that Google_Service_Something_ is in the same file as Google_Service_Something - I think the issue @silvolu and I have had is that we would ideally like to fix that, but due to the way the libraries are generated its an harder change than you'd expect. However - I am inclined to agree that just doing as you say would be worth it - if you have time to put together a PR that would be great!\n. Closing as Lars has done the autoloading work - feel free to open more issues if you find problems with that, I think it is quite possible some odd cases will break!\n. A +VanityName should work as an id, can you paste the code you're having a problem with to establish whether the issue is with the library or not (this tracker is for bugs with the library itself, not the API per se, but it is possible the + is not being encoded). \n. Closing due to inactivity.\n. Yeah, that's fixed in master. We should tag a new version though - I've got another change I'm hoping to get in this week, then I'll tag. I'll leave this issue open as a reminder. \n. Tagged 1.0.5.\n. It is not possible.\n. ID token doesn't contain an access token, just some verifiable user information. It sounds like the id token just needs to be assigned as part of the refresh process - I can take a look at this after IO, but happy to review PRs in the meantime if someone gets to it first. \n. Do you have batch or deferred mode enabled? In that case you'll need to execute the request with the Google_Client in order to actually send it.\n. Additionally, you shouldn't recreate the $service each time in the loop, though not sure if that will cause any problem. If you are still having issues, please reopen this with a code snippet demonstrating the issue and we'll take a look!\n. Paste bin seems to no longer be valid. In general, try to get the details for the error response (e.g. return code and so on) and reopen if still an issue. \n. As mentioned in PR, this seems to be the generator not respecting the name of the method - I believe we'll have to look at addressing it in the generating code itself. \n. No ETA right now - it needs a change to the code generators for the templates, and there is a pending changed backed up in that process at the moment. Once we get that change unstuck, we can take a look at this one, but it could be a while to be honest.\n. Fixed in #335\n. That file is a actually a generated one (from the discovery document), so we will need to make this fix to the generator - thanks for the PR though!\n. Can you capture the result from the insert call and see if there is an error? Also check you have enabled the Drive API for your project.\n. Sorry, I meant result from your script - the $result2 object.\n. When you accept on the consent screen, which code path does it go down? Is the access token being stored properly in the session?\n. Looks like your redirect URI is wrong - you should be pointing back to the script you are coming from (fileupload.php), not the root examples index page. \n. Add the root of the lib dir to your include path and it should fine that file properly. Or if you're using composer, add this lib as a dependency from there and it should generate an autoload map. \n. Yep, either use composer (the preferred method) or set the include path to include the root directory, see https://developers.google.com/api-client-library/php/start/installation\n. This seems like an issue with the Drive API rather than the client library directly - try asking the Drive team who may have a better idea of what the issue might be! https://developers.google.com/drive/support\n. It looks like that code sample is out of date -there should be a button to leave feedback on the developers.google.com page. The request class is Google_Http_Request. \n. Thanks, this tracker is only for issues with the PHP client itself. You are right though, the documentation on the + developers site does look out of date - there should be a send feedback button on the developers site that can be used to alert the doc authors about the bug. Thanks!\n. Does this work via the API explorer? https://developers.google.com/apis-explorer/#p/ - it may be an issue with the API rather than the client library.\n. I'm going to close this for now, as I'm not sure there is an issue with the library itself. Maybe try asking on the CSE help forum: http://www.google.com/support/forum/p/customsearch and if there is a bug with the PHP lib directly, reopen or raise a new issue here.\n. It sounds like this is an issue with the YouTube API rather than the PHP library specifically, this tracker is only for bugs with the PHP client itself. Try the YouTube support options on their developer page (Get Help on the left): https://developers.google.com/youtube/\n. Sounds like this is an issue with the Drive API rather than the client library directly - this tracker is only for bugs with the PHP library itself. Try the Drive support options: https://developers.google.com/drive/support\n. I am guessing its failing to connect in some way - test that you can get to the Google services properly from the machine, and that nothing is disabling PHP calls. If you're using 1.0.4, try using master and switching to cURL (which is the default IO now). \n. Are you using the master version of the library, or a tagged release? I think this may be related to an issue in the last tag released which should be resolved in master. \n. Cool - should be fixed on master then. \n. Not sure to be honest! This tracker is only for bugs with the library itself, for help with analytics try StackOverflow.\n. There is a Freebase service class, but your best bet for help would be to ask on StackOverflow - this tracker is only for bugs with the library itself, sorry!\n. You're not actually authenticating there - just configuring for OAuth. Try setting a developer key, that should have teh requests use your project (if that's valid for fusion tables, I'm not familiar with the API), or use createAuthUrl/authenticate to generate an auth URL and exchange the resulting code. \nSee\nhttps://developers.google.com/api-client-library/php/guide/aaa_apikeys\nhttps://developers.google.com/api-client-library/php/auth/web-app\n. That's awesome Vince, definitely look forward to seeing your repo - what we can (and should!) do is start linking to some sources of examples in the README, as there are already a couple of places where you can find API specific snippets (e.g. the youtube repo). If its OK, could you raise an issue with the link to your repo once its there, and we can link? \n. Looks like the service account name you have there is the client id - the name is formatted as an email address like 123456789-abcdebsbjf@developer.gserviceaccount.com, try swapping the value for the one in the console and see how you go!\n. That's a bit more specific to fusion tables/drive - I don't know how those two interact, but you might want to try asking on the support groups: https://developers.google.com/drive/support - https://developers.google.com/fusiontables/groups/fusionTablesApiGroup\n. This tracker is only for issues specific to the library itself, maybe try the adwords forum or other options  - they're much more likely to know the answer there! https://developers.google.com/adwords/api/community/\n. Should just be able to append any extra parameters to the end of the URL, there isn't any special function in the library for that as far as I know. There is an open feature request for adding an openid.realm handler, #199 \n. Is it possible this is returning some alternative response type? That kind of thing you'd have to ping the support group for the API - this tracker is just for bugs with the client library itself - but there may well be a bug with not handling an indicator that the response is not JSON in the lib here. \n. Thanks, that's a great suggestion! Just to quote from your response: \n$group_opts = array(\n     'alt' => \"json\",\n);\nI'll add a note to the README on non-JSON responses. \n. We have a pending change on this - unfortunately these classes are generated from the Discovery service, so we need to get the change done there (then this should be resolved). Tracking in #116 \n. Good point, we should include that. PRs welcome, or I will take a look at this next time I'm doing some work on the lib, should be fairly straightforward. \n. Just sent #320 with the change to include error description.\n. The naming scheme was changed last year, and I am guessing you have dependencies on both. I think the best bet is to ask the author of the older plugin to update to the latest client library version. Beyond that, not sure how to help, sorry!\n. Yeah, that is odd. I can sort of see why that code is in there, but what we really want is to see if there is basically no timezone set, and set one if so. I don't know of a way off the top of my head either (PRs welcome if you think of one though!), but I'll have a dig at some point and see if we can tidy this up. \n. Ack. I think the right call might be to remove in this case then. \n. Thanks Volkan, good comments! Can you fill in the CLA (at the bottom of http://code.google.com/legal/individual-cla-v1.0.html) and we can merge this!\n. Thanks!\n. You can download them via the Drive APIs, or if you want to manipulate there is the old GData API. https://developers.google.com/google-apps/spreadsheets/\n. Looks great, thanks!\n. The composer file comes with a autoloader map - should work fine with composer. Appreciate the requires are not ideal - we'd like to get rid of them, but it needs to come with a version bump.  \nWhy 5.2 support: Its in the README. I think we are getting towards the point we can remove that though!\n. See the section on setting the include path: https://developers.google.com/api-client-library/php/start/installation\n. Good idea!\n. The _Service files are generated, so unfortunately we can't merge this (it would get wiped). Thanks though! I think the best way to do this would be to use deferred mode to get the request, and set the header on that directly. \n. I think this is a mapping issue - we need to look at this to see whether we need to keep a full wire -> local name map, or whether it can be represented another way. I am tempted to say we should keep a map, and actually proxy the public properties entirely - we could possibly use the magic getter and setters to maintain quick property access (we already do something similar for arrayaccess support). \n. Fixed in #335 \n. Where are you seeing duplicate class names? There shouldn't be any. \n. Yeah, the intention is to move to namespaces, but that means dropping 5.2 support - usage is dropping, but for the time being we still have it supported (see the README for more on that). The plan is to move to 5.3 support, namespaces, and autoload rather than requires, but there's not particular timescale for that at the moment.\n. Are you calling $client->setAccessType(\"offline\"); before you generate the auth url? That parameter needs to be passed at that point, not when exchanging. \n. Could you put together a minimal code sample that demonstrates the problem? I can't reproduce it here at the moment. \n. Ah, that explains it! Pugsley: you don't need force every time, only when you don't have a refresh token stored on the server. \nBasically, with Auto it will only show the consent dialog when the user has not previously given there consent. You will only get a refresh token if the consent dialog is shown. Therefore, when you get a refresh token it should be put into permenant storage like a database - you can look up the user using an api call from the access token or via ID token data. So, force causes the dialog to be shown every time, which means a refresh token every time, but that means you are churning refresh tokens, and you are giving the user a worse experience. Take a look at http://www.riskcompletefailure.com/2013/12/are-you-using-approvalpromptforce.html for a bit more on that.\nClearly this is not very obvious, so what I'll do is add a note to the documentation highlighting this!\nnavneetccna: to test this, try revoking your access, then signing in again. You can revoke through your account settings, or by getting an access token after you sign in and calling this URL: \nhttps://accounts.google.com/o/oauth2/revoke?token=\n. To confirm, did you see the consent screen once you changed it to force?\n. Possibly it wasn't set before generating the auth URL then. Could you try revoking a (valid, not expired) access token, and then try again? \n.  Both tokens come back at the same time - you'll get an access token for use immediately, and a refresh token for use in the future. Just request offline access and be aware that you only get a refresh token the first time (effectively, whenever the user sees a consent screen) - so you should store the refresh part against the user, and in future sign ins look it up. \n. That message is due to incremental auth. Take a look at http://www.riskcompletefailure.com/2013/12/are-you-using-approvalpromptforce.html for more on that. \nRe getting the token - nope, you're doing it the right way. It might be nice to have an accessor method on Google_Client though, feel free to send a PR or open an issue for that. \n. PR merged!\n. Hmm, odd. A hang is really strange. We've had a couple of odd id token reports though - I am wondering if the scopes in that example are wrong. Will retest. \n. Just tried it on a fresh account and email scope worked OK - there was a bug around the API a while back, so this may have been an instance of that. \n. Take a look at the media file upload class, and the upload example in the examples dir. It should be the same mechanism for GCS. \n. Yeah, looks like that section in the config is outdated, and should be removed from the class. Looking at your examples I'm guessing you're trying to override base path - there is a higher level entry for that in the config which you can use.\n. Yeah, that sounds good - I've just sent #320 with the config changed to protected and the services removed.\n. I need to push through a change to the template generation that will affect some classes (changing superclass type). Hopefully in the next couple of weeks. \n. Sorry, that feature is 5.3 and above only because of the crypto libs involved. I'll add a note to the documentation.\n. Added note to readme. \n. Looks good, thanks!\n. These service classes are generated from the Discovery service unfortunately, so your change would get overwritten. This may be something we can fix in the template generation, if we can determine from the discovery doc that they are required - normally required arguments turn up as named parameters though, so it may be that there's something not quite right in the discovery doc itself.\n. Seems that we're stuck with that formatting unfortunately. Thanks for the contribution though!\n. Seems like an issue with the YouTube Api rather than the PHP client library itself - this tracker is only for issues with the lib directly. Try asking on the YT api stack overflow tag: https://stackoverflow.com/questions/ask?tags=youtube-api\n. Sorry, this tracker is only for issues with the library code itself - can you raise that with the analytics team? Thanks!\n. We don't generally include API specific examples - maybe put this in a gist, or submit to a YouTube sample repo? Thanks though!\n. I think this is due to this api one of the first to use the map/variant type in the discovery service (https://www.googleapis.com/discovery/v1/apis/mapsengine/exp2/rest). It'll need an update to the template generation for the service classes to handle this new type and generate some kind of object.\nFor the short term, I suspect the best way will be to just expose these sort of fields as untyped, so you can set whatever you want on them. \n. OK, we now have types extending the variant type so this should work - I have a skipped unit test for this which I will reenable. \n. Thanks! Could you sign the CLA (there is a online form you can use, see: https://developers.google.com/api-client-library/php/contribute) and I can merge this. \n. Just looked again - this should be this way round, we want to warn if the api key hasn't been changed from \n. Maybe a proxy issue. Can you try with the master branch of the library, and see if you get it still?\n. Odd. Could you create a minimal code sample, so we can try and reproduce the error elsewhere? And include the details of the version of PHP you're using?\n. Please reopen if you have a small code sample that reproduces, and we can investigate further\n. This is a bug with how the generated Service classes are generated. There is a fix pending for that I really need to push through - will try and get this unstuck tomorrow. \n. Should be fixed now.\n. The request visible actions parameter is space separated, not comma separated, so that may be causing some problems. It may also vary on how you create it. For this type of question, its best to ask in the Google+ stack overflow tag (and include a code sample that demonstrates the problem) - this tracker is for issues with the library itself. \nhttp://stackoverflow.com/questions/tagged/google-plus\n. Unfortunately the service classes are generated from the Discovery service, so this would be overwritten :(\n. Agreed, that would be nice - https://github.com/google/google-api-php-client/blob/master/src/Google/Http/MediaFileUpload.php#L290 just returns a string, and it could return response information or some useful part thereof. Pull requests welcome if anyone gets a chance!\n. Yeah, sounds reasonable. Could you raise an issue with that comment? \n. Hmm, this looks liek another case of the template generating wrong. I think this is a dupe of #217 - it looks like the same issue of the auto downcasing of the initial letter causing a problem. \n. A server key is not sufficient for Drive access I believe - you'll need to put users through an oauth flow in order to get an access token. I'm not super familiar with the user service on appengine though - so might be worth asking on the Drive stack overflow tag, or the appengine one. \n. Best to check that with the calendar team - this tracker is only for issues with the library directly. Try the calendar forum: https://groups.google.com/forum/embed/?place=forum/google-calendar-api&showsearch=true\n. Thanks!\n. Thanks! Could you sign the CLA (there is a online form you can use, see: https://developers.google.com/api-client-library/php/contribute) and I can merge this. \n. Thanks!\n. It assumes the src dir is in the include path, see the install instructions: https://developers.google.com/api-client-library/php/start/installation\n. A lot of people use composer, which handles that for you. Ideally there wouldn't be any requires at all and the lib would autoload (which of course also requires the path being updated appropriately) - thats certainly my preferred outcome, but that's a potential BC break for people as we'd need to require an autoloading mechanism - so its not happened yet.\n. Its the same issue as #280 - there is a change pending which we will track there. \n. Not familiar with the shopping API - this tracker is really for issues with the library itself. Try asking the shopping team in their forum: https://developers.google.com/shopping-content/forum/index\n. Thanks!\n. Does setting the acl work via the API explorer? I am wondering whether the issue is with the JSON generated by the library, or with the API endpoint. If the endpoint, its best handled by the cloud storage team. \n. Just had a look at the discovery doc - try setting $acl as an array (so ['public-read']) rather than the bare string. \n. Fair point, we should allow numeric 0 for the port. PR welcome!\n. If this is an issue with a specific API, please file it with that APIs support method - I'm not even sure which one this is for! This tracker is only for bugs with the library itself - so if it is a non-API specific issue feel free to reopen with a minimal test case.\n. You are using a rather old version of the library. Try taking the latest version from master here. \n. Agree that having a pluggable token store would be a nice general feature - for more than just multithread usage, but automatically having some sort of default store for refresh tokens and so on with some persistence.\n. Use chunked encoding, see https://github.com/google/google-api-php-client/blob/master/examples/fileupload.php\n. Not sure on specifics of the YouTube API, try asking on the YouTube stack overflow tag. http://stackoverflow.com/questions/ask?tags=youtube-api\n. This is happening in your exception throw right? You're trying to do . $result in the message.\n. Thanks! Could you sign the CLA (there is a online form you can use, see: https://developers.google.com/api-client-library/php/contribute) and I can merge this. \n. Thanks!\n. Thanks! Could you sign the CLA (there is a online form you can use, see: https://developers.google.com/api-client-library/php/contribute) and let me know who you are, and I can merge this. \n. Just looked at this again - it should be this way round, it issues the warning if the key hasn't been changed. \n. Thanks! Could you sign the CLA (there is a online form you can use, see: https://developers.google.com/api-client-library/php/contribute) and I can merge this. \n. Thanks!\n. Not entirely sure - I'm not familiar with the analytics API, so you may want to ask on their support forums. In general, the media upload stuff is supported (you're using the quick version of it here) - take a look at the file_upload.php example in examples. \nThe analytics community links are here: https://developers.google.com/analytics/community/?home\n. I think the verification may be 5.3.0 and above only, as AFAIK sha256 wasn't available at all before that. There is another bug open to make that clearer in the docs - however, if you have found a constant that works for the fourth parameter, it would be very nice to add it!\n. I have had no joy finding a way to support this for older versions, but if you do, please reopen!\n. This tracker is only for issues with the PHP client library itself. Maybe try raising an issue on the analytics tracker: https://developers.google.com/analytics/community/?home\n. I'm not familiar with the analytics APIs unfortunately - the client libraries talk to a standard API layer with classes generated for each service, so we don't necessarily have a lot of familiarity with the individual APIs. The teams rarely comment on upcoming releases, so the best thing is to keep reminding the teams of the demand and encourage people to star the issues. \n. As with other issue - this tracker is just for bugs with the client library itself. 503 does look like something is broken with the API itself though. \n. Seems like a bug with the API. This tracker is only for issues with the library itself - I must admit I'm not sure where the support forum for that API is, perhaps part of webmaster tools?\n. I had a look and couldn't see any reports of anything related that might help (though do make the usual checks that you have delegated the right scopes to the service account). Perhaps try asking on StackOverflow on the webmaster tools tag: http://stackoverflow.com/questions/tagged/google-webmaster-tools\n. Agreed, a logger interface which gave raw requests and responses would be great. PRs welcome!\n. Using an existing project seems like the best option. Ideally it would be an optional dependency - in that case it could be an up to date monolog. If it was disabled by default and enabled with a flag, we could have a check for it as well, to avoid confusion when people are debugging. \n. No specific plans, but it is certainly something it would be good to support, either via generator or via some more dynamic mechanism. \n. Its the same project as that one - but one running on an internal service here. I will ask whether anyone can update the open source version. \n. Yep, its a global CLA. \n. Tony just let me know he pushed the update, so the latest templates should now be in that repo. \n. Thanks! String fix looks good, though also using the unix protocol check makes sense. Could you sign the CLA (there is a online form you can use, see: https://developers.google.com/api-client-library/php/contribute) and I can merge this. \n. Thanks!\n. Those are from old versions of the code, it's Google_Service_Analytics in Google/Service/Analytics.php and Google/Client.php for Google_Client. The example you are using is a bit out of date by the looks of it!\n. Thanks - unfortunately the service classes are generated from Discovery docs, so you change would be overwritten. It might be worth filing an issue about the specific bug for the next time people are working on the templates. \n. As a work around I guess you can call it on the OAuth2 object directly, but would happily merge a pull request on this (modulo CLA https://github.com/google/google-api-php-client/blob/master/CONTRIBUTING.md)\n. Fixed in #337 \n. Thanks! Could you sign in the CLA (there's a form via https://developers.google.com/api-client-library/php/contribute) and I can merge this.\n. I picked up the change in #335 \n. You're not using the built in service class for the app, which is fine, but you need to then manually pass through the access token - you can pass it as a header in your call on on the query string as an access_token parameter: https://developers.google.com/accounts/docs/OAuth2WebServer#callinganapi\nI would try using Google_Service_AndroidPublisher - I've not tried it, but it should wrap the call more easily. \n. I guess there is no start date coming back for that event, and because its a object rather than a primitive, its making a lookup to the data array, which doesn't contain the value. \nI guess we should test for whether the item is defined and return null, rather than trigger the undefined index warning. \n. Fixed in #335\n. Have you got a minimal code sample, so we can try and reproduce the error. I'm honestly not sure whether batch uploading is supported in general - do you know of examples of it working with other upload APIs (drive, youtube or similar?)\n. I think you'll need to use the multipart upload option. Try setting $args['uploadType'] = 'multipart'; and see if that gets you any further. \nRe DL: AFAIR you get a download URL back, so any of the normal methods of chunked reads would work. It would be nice to have a little helper class though that could wrap chunked downloads, retry with exponential backoff and that sort of thing.\n. Yeah, I think it should work - the batching and mediaupload code presumably doesn't play well together in the library.\n. Ah right! Well its good to know at least, thanks for following up with cloud support. Re multithreading, I would just run multiple copies of PHP. Sensible approach would probably be to use something like gearman to send uploads to multiple worker scripts. \n. Thanks! Custom Search is supported: https://github.com/google/google-api-php-client/blob/master/src/Google/Service/Customsearch.php - in general, all of the services are generated from the Discovery service - so if its in there, we will support, if not, we wont. https://developers.google.com/discovery/v1/reference/apis/list\n. How are you storing the access token? If you're putting the whole token in a DB or similar, then you may be checking the old one each time. \n. Can you look at the values of the token object - are the created and expires_in values set to something sensible?\nThe other question is - is your system time correct? If it is more than an hour out from the serve time, it will always appear to have expired. \n. That'll do it! Thanks for updating the issue\n. Fixed in #337\n. I think you must be using an old version - nothing in Config.php in the master branch has /tmp in it. \nhttps://github.com/google/google-api-php-client/blob/master/src/Google/Config.php\n. Fixed in #353\n. This library supports APIs which are made available through the Discovery service: https://developers.google.com/discovery/ - same as can be found via the API explorer: https://developers.google.com/apis-explorer/#p/. If its not a library that uses that (and distance matrix doesn't seem to be), it wont be supported here.\n. This is looking good I think - I need to make sure the install docs are updated on developers.google.com, but will close after that. \n. @TheLonelyGhost why's that? (spl_autoload_register looks like its 5.1.2 and above to me - http://php.net/manual/en/function.spl-autoload-register.php)\n. I think this issue has got a little bit off track (my fault entirely) - we merged in the PR for the autoloading support, which seems to be working fine, but I left it open to track a doc change. I'm going to file an issue to track the documentation change - please file issues for any aspects you'd like to see changed. \nJeff: only the service classes are generated, so I'm not sure its particularly trivial to build a classmap at that point. However, perhaps its something we could put in the README for people who wanted to build a classmap for themselves? Feel free to open and issue on that and we can discuss there. \n. Thanks! Looks great. That case independent versions don't worry me too much - that is definitely more historical accident than intentional feature IMO. This definitely warrants a bump in the version, so we'll probably tag as 1.1.0. \n. I'll merge and run the full test suite (some requires auth which we haven't configured Travis to do), but looks good to me!\n. Not specifically - make sure that you have authorised the service account email address for access to your analytics account via the analytics UI though! Any questions on analytics and service accounts is best directed down the analytics support channels though, as the're the experts. \n. Thanks! I know it seems silly for such a small change, but have you signed the CLA? https://github.com/google/google-api-php-client/blob/master/CONTRIBUTING.md <- once you have let me know the name and I'll merge.\n. Thanks!\n. Thanks!\n. We don't keep API specific examples in the main repo (as they proved to get out of date quickly without support from the specific API teams) any more - if you have updated the analytics example, best to create a gist to help other people searching find it.\n. Yes please! And please sign the CLA so we can merge right away - good spot! https://github.com/google/google-api-php-client/blob/master/CONTRIBUTING.md\n. Thanks!\n. PR sounds good!\n. Thanks!\n. Hmm, not sure how that could work - how are you granting the service account permission to access that user if its a gmail one? I'm not familiar with the gmail API, so there may be a place where you delegate permission to the service account email address. Service accounts by default don't represent any specific user, just themselves - so you can delegate authority to them for an Apps account, but not usually with a regular gmail (unless you can grant access though a specific mechanism, - e.g. the Analytics console allows you do add a service account email address as an authorised user). \nYou might have better luck using the interactive oauth flow for a specific user and storing a refresh token rather than using a service account. \nI don't think this is a specific bug in the library either, so you might want to consider looking at the gmail teams support options (probably stack overflow!)\n. Please don't assign people to the pull requests, we will look at them when we get a chance. The class referenced is part of the Google App Engine PHP library, so you need to have that in order to use it. \n. Thanks!\n. Thanks!\n. Thanks! Is 1 == CURL_SSLVERSION_TLSv1_0 ? I know that constant isn't in older versions of PHP, but I presume that cURL will handle it anyway. Might be worth a comment to indicate that though. \nCan you sign the CLA, then I shall merge this. https://github.com/google/google-api-php-client/blob/master/CONTRIBUTING.md\n. Thanks!\n. Thanks! Could you give me a little more background to your changes? The test includes one was testing that the generated service files don't collide and are valid PHP (which should be true, but hence the test) so I'm a little hesitant to remove that without a replacement. \nCould you sign the CLA as well? https://github.com/google/google-api-php-client/blob/master/CONTRIBUTING.md\n. Took another look at this - overall I like it, but I dont want to drop test includes. I think that needs to be modified so it just instantiates each class. We can still glob, but we then need to construct a new object of each base service class. This is important as those classes are generated, so its convenient to see when something has gone wrong via Travis (as it has at the moment actually!)\n. I think most of this should have been picked up in Jeff's PR #407 so I'll close it, but please do send another if there are further fixes needed.\n. Thanks!\n. Nice idea. Will happily merge a PR on this one - will leave it open for a bit in case anyone feels like picking it up. \n. That is because those tests require a credential - if you would like add the encrypted credential support in travis to the tests it would be awesome!\n. Arguably you should have that set globally.  - however, we could definitely hard code the timezone setting in the tests on the basis that they're tests - BaseTest could do a timezone set.\n. Hmm, something feels a little off about just catching and rethrowing the error from makeRequest. I guess we could wrap it in an Auth_Exception - not sure if that's much more valuable. \nHop by hop must have got lost somewhere - I don't recall what it was trying to do, so I guess it will need a bit of detective work back through the commits.\n. I'm guessing this wasn't an intentional PR!\n. All those files are generated from the Discovery service unfortunately, so your change would get overwritten by the generator when the API was updated. Unfortunately, I can't think of a clear way of setting the default based on the discovery document :/\n. Seems like that is an error with the analytics API. The tracker is for bugs with the library itself (and we don't have any particular expertise with this API unfortunately!). Maybe try one of the options on the analytics support page: https://developers.google.com/analytics/help/\n. Looks like there was a problem with the service, but that is resolved now. Thanks!\n. Not at all familiar with the double click API, so you may be best to go to their support for more details. However, most of the time with service accounts its because the account has not been granted access to the data - the service account is not your user, and doesn't have any special access to your data. For example, you might have to authorise the service account email address in the admin API of the service. \n. Yeah, that's a bit awkward - the current template generation system selects the last array I believe. It would be good to prefer 'items' if there is one, but that may be a bit trickier. You should be able to iterate over $result->items though. \n. Though this has made me realise we're not using the correct template variable for this - looks like there was a merge issue and we ended up with a slightly suboptimal setup!\n. Looks OK to me (assuming that gmail supports sending from service accounts) - one thing I am aware of is that you may need to use the URLsafe base 64 encode: https://github.com/google/google-api-php-client/blob/master/src/Google/Utils.php#L26 rather than regular base64_encode. \nThis tracker is for issues with the library itself though - your best bet for gmail specific questions is the Stack Overflow tag: https://stackoverflow.com/questions/tagged/gmail-api\n. Can you get the token you get from the app identity call and see what it returns in tokeninfo? https://www.googleapis.com/oauth2/v1/tokeninfo?access_token= \nThis may be a question that has to go to the cloud team rather than being a library issue, but it would be interesting to see if the token appears valid. \n. That's a good idea, could put that into the appidentity class itself. Pull request welcome if you want! \n. Thanks! Could you sign the CLA (see https://github.com/google/google-api-php-client/blob/master/CONTRIBUTING.md) and we can merge this!\n. Great, thanks!\n. Thanks!\n. You shouldn't really be passing back an access token from JS to your server - you should get a 1 time code as well as the access token in JS, you can pass that back to server to exchange for an access token of its own. \n. I think the answer to this is the logging option proposed in #315 - we should track discussion in there. \n. Sounds useful - could you give an example of the type of thing you'd like to see in the documentation? \n. That does not look pleasant! It seems very bigquery specific though - the class for returning the errors is part of the BigQuery service. We don't generally keep documentation for specific services in the library docs, but it might be worth feeding back to the big query team!\n. Thanks!\n. The travis failure is legit - there is a clash between a generated name in the Genomics API and the library structure - its just that it requires a change to the generators which is an unfortunately slow process. We've got the fix in, but it needs to be pushed out to the gen servers, which might take a little while longer unfortunately :/\n. Thanks!\n. Thanks!\n. It does not - that's an old GData api, and this library only supports the Discovery based APIs. \n. Thanks! I will take a proper look, but looks good on a quick scan through the code. \n. OK, I like the look of this so I think the best thing is to merge and if we need any refinements do them from that point! I've merged your PRs out of order though - would you mind rebasing, then I'll push the button. \n. Thanks! Documentation wise, a brief note on logging for the README would probably be good. I'll make a note to add a page to the developers.google.com documentation as well, but many people just see the README. \n. Fair point on documenting its required for calls. You can use the Curl IO handler without allow_url_fopen if you don't want to enable it. I disagree that the flag is per se bad though, since 5.2 and allow_url_include was split off. \n. Could definitely add this to the standard parameters, but why did you want pretty print for the library? For debugging?\n. Can't repro that either. Is it possible some caching is at play here, or perhaps in your full code you have two instances of client?\n. It seems like that part is currently used for improving performance, but is not critical for the authentication. However, the auth format changes from time to time, so I wouldn't rely on that! \n. I'm not sold on the idea of automatically exposing all private members - if we do so we have to consider all of that part of the public API, and so take into account BC checks. Do you have specific cases where you want overriding, and if so could you reduce the scope of your PR to those - we need to make sure we're exposing the right interfaces to subclasses.\n. If possible, could you give me a rough idea of what you were trying to do with those subclasses? And by the way - thank you for sending the changes regardless! Always good when issues come with code :)\n. Agree with Jeff - that looks like the best solution. Thanks!\n. Sounds pretty reasonable to me! \n. Stuart filed another issue and sent a PR, so it should be fixed in master now!\n. Yeah, sounds like it could be an encoding issue. Have you got a small script that creates then updates a file in cloud storage we could use to repro and debug?\n. Looks great, thanks! /cc @silvolu - shouldn't cause issues with internal tests, but FYI.\n. Not as far as I know - I'll leave this open for a few in case anyone wants to add it or has similar requests. \n. @silvolu - you mentioned you might get a chance to look at this? Maybe close if not, else ping if you get a chance.\n. @Skysplit thats a separate issue - tracked in #443\n. That does sound like the answer! Those methods are generated automatically, and I believe we can't tell whether or not fields are writeable from the discovery document the services are generated from unfortunately. \n. Ah, awkward! What does the JSON actually look like in terms of the null value - is it not present or is it set to a Javascript null value? I'm not totally sure what the best answer is here - the null checking is important because we can't have non-presence: the generated objects have the fields in most cases, so we would pass them with null values. I suspect the larger fix would be to not have any on-model properties but have everything handled via the magic get and set - that is large enough I don't think its likely to happen though. \nPotentially we could have a different semantic for patch calls, or track that a field that was set had been nulled. Neither seems great though. \n. Because the template generated files have properties and getter/setters I couldn't see a sensible way to automatically tracked uninitialised variables, so as a workaround I've added a Google_Model::NULL_VALUE const. If you set a value to that, it will be preserved as null in the JSON. If anyone has better/other ideas would love to see a PR on it though!\n. App activities never appear in the stream. If you're managing an apps domain, you could try the google+ domains API, which has other posting options.\n. Not a clue sorry, we only deal with general client library issues here. Try the Google Calendar API team - you could raise an issue on their tracker with a brief sample code that demonstrates your issues: https://code.google.com/a/google.com/p/apps-api-issues/issues/list?q=label:API-Calendar\nI would also see whether you get the same thing via the google API explorer, so ensure it isn't just coming in a form you didn't expect or similar. \n. Looks good, thanks!\n. Believe it does - just checked with a passing apps guy who said the marketplace is split into licensing and billing APIs, so I suspect https://github.com/google/google-api-php-client/blob/master/src/Google/Service/Licensing.php is what you're looking for.\n. Amazing patch Jeff! This is really great stuff, thanks!\n. Thanks! Really great work, much appreciated jeff!\n. Thanks!\n. Thanks! can you sign the Google CLA (see https://github.com/google/google-api-php-client/blob/master/CONTRIBUTING.md) and then we can merge. \n. Thanks!\n. The $video object there is the one you created - when you execute the insert request you should get a new video object back which will have an ID. \n. Good spot, thanks Jeff!\n. Don't know to be honest - this tracker is for issues with the client library itself. The individual service are automatically generated from the discovery doc for each API thats available. \nI would try one of the Admin SDK support options - https://developers.google.com/admin-sdk/support\n. Thanks Josh!\n. Yep, as Jeff says. \n. :thumbsup:\n. Can you post the code you're having a problem with?\n. Thanks Adam! This looks great. Have you signed the CLA (see https://github.com/google/google-api-php-client/blob/master/CONTRIBUTING.md) - I checked but couldn't see you in there? If not, please do and I'll merge this. I'll bump the version number for the next tag as well. \n. Thanks, that's appreciated, but as far as I know we need the CLA for anything we want to merge - it basically says that any contributions are your work, and that you're allowed to license them, so I don't think the license itself is the sticking point. Not sure I'm going to get much of a response back to a question in short time either unfortunately! On the off chance I had a check, but didn't get a hit on owncloud on the corp signers list. \n. Sounds good!\n. Any joy on the CLA? \n. Thanks!\n. Thanks!\n. All those classes are generated unfortunately, so it needs a change to the templates rather than to the classes in the repo. Its a good idea though, and should be fairly straightforward. \n. The scope is email, from the G+ profile service (should work for all types of users): https://developers.google.com/+/web/people/#retrieve_an_authenticated_users_email_address\n. I'm not against a move to 5.3 only at this point - the requirement change is just a doc change, but moving to namespaced code is the bigger (but more beneficial) part. \nThe tricky thing for PSR2 is sorting out the template files - at the moment the generator puts them into one big file per service, and it is non-trivial to sort that out. It was a bit blocked when we didn't have autoloading, but since that's in, worth revisiting I'd say. \n. oh, my bad, off by one error\n. The contacts API is a gdata service, and this library only handles the newer discovery based services. There is an older library that might help: https://developers.google.com/gdata/articles/php_client_lib\n. Thanks! I'm not sure that renaming the function is super worthwhile though - perhaps its easier to add a note to the README with your recommendation? \n. Added a note to the README, thanks!\n. Can't help with API specific questions on this tracker - best to ask your question (ideally with code) on StackOverflow: http://stackoverflow.com/questions/tagged/youtube-api. In general though, see if it works properly via the API explorer: https://developers.google.com/apis-explorer/#p/ - if it doesn't, then the issue is with the API. If it does, please file a bug with the specific differences you're seeing in the requests and we can try and resolve any issue in the library. \n. This tracker is not a good place for Calendar specific support, but it possibly could be a bug with the client library.  Can you see if your query works properly using the API explorer: https://developers.google.com/apis-explorer/#p/\n. Did you get any further with this? Sounds like the library was generating the right output, but something was still off?\n. Is it possible you were using a different account on the API explorer and in the client code? Perhaps the defaults were different?\n. Might be worth checking with the webmasters API team - this tracker is for general issues with the client library. Also could have been a temporary issues - in general try and see if it works via the API explorer: https://developers.google.com/apis-explorer/#p/ - if it does, but not with the client library there may be a bug in the library, otherwise its likely an issue with the service. \n. I'm not familiar with the webmasters tools, but have you granted access to your service account email address (as you would have with analytics)? Service accounts are there own user, effectively, so they can't see your data without being specifically granted access. \n. Might be worth checking with the webmaster tools team - its not an API i've used directly. \n. Thanks @eRadical - we don't generally include service specific examples with the library, but if you put up your own repo of examples that would be great. If you have an example that demonstrate some generic functionality which is not otherwise covered, then do feel free to contribute that though!\n. Lets track namespaces/PSR naming of the service classes in #445 - both issues are largely about that.\n. It is quite possibly different - I believe the console used to give you a separate private key file, but it sounds like the key is now included in the JSON, so I am guessing the console team made a change. If so, the client parsing code will need updating.\n. This is definitely a new JSON format. The current parsing is still correct for the regular types, but not for service accounts. However, they're not quite analogous in their usage, so I think we'll need a new function - something builder that takes a JSON location and some scopes and returns an assertion credential. \n. Yeah, that's not great. Part of the problem here is that Google is large, so the team that manages the developer console doesn't necessarily interact that much with the team running a client library or a given API. Something like this new JSON is a convenience - all the old methods work - but it can cause confusion when there is inconsistent support. \nI certainly would love to see us sync everything across the board, but at the same time I would rather teams had the opportunity to try out new stuff without having to wrangle n different projects. Appreciate that's not a lot of help in your situation, so sorry about that, and thank you for doing the right thing and filing an issue - so at least we can see the situation!\n. Added Google_Client:loadServiceAccountJson as a helper to generate an AssertionCredential - https://github.com/google/google-api-php-client/blob/master/src/Google/Client.php#L139\n. That error is related to the id token, so your call to $token_data = $client->verifyIdToken()->getAttributes() is what's triggering the error. \nYou're not requesting any profile scopes, so I am guessing you're not going to get an id token. Try adding 'profile' to your list of scopes.\n. So similar to https://github.com/google/google-api-php-client/blob/master/src/Google/Auth/AppIdentity.php for GCE? A patch would be great! https://github.com/google/google-api-php-client/blob/master/CONTRIBUTING.md\n. Thanks! I would do a separate test, and make sure to skip it if not running on compute engine I guess. \n. Looks good to me, thanks Jon!\n. Media should work fine for the zip files - I'm not sure what this patch is trying to do?\n. Thanks! Have you had a chance to sign the CLA? See https://github.com/google/google-api-php-client/blob/master/CONTRIBUTING.md\n. Thanks!\n. That's good work! Technically this client library is only for the newer Discovery based APIs, and contacts is an old gdata one, but you're quite right that you can use the auth part and query the API directly.\n. Not sure to be honest - I would definitely ask on Stack Overflow where there may be some people with familiarity. Unfortunately I've no experience with the old gdata APIs whatsoever. \n. Yeah, this looks odd. Do you have a small script we could use to repro?\n. Pretty sure it is authentication. You seem to be using a service account, which is its own user - it isn't the \"you\", or the same user you'd get if you signed in to the API explorer. \n. I'm going to close this, but feel free to reopen if there are more questions!\n. Yeah, that's the main idea. For a little background, older versions of the lib (back when it was on subversion!) had lots of examples, which were mostly out of date - they gave a false sense of security. We (silvolu & I mainly) figured we weren't going to have time to keep all of them up to date, and we didn't have familiarity with every library, so we tried to create examples which show library features. From that point, it should be possible to figure out how to use a given service in PHP based on its general documentation and the API explorer. If you have seen a library feature which is missing an example do file a FR though - we want to make sure there is coverage for the types of task, if not the specific APIs.\n. Yep, this lib pretty much only supports stuff in discovery, which cloud print isn't unfortunately!\n. Sorry, part of the Google Discovery Service - the json schema based service descriptions: https://developers.google.com/discovery/\n. took a quick look at this today, added a note for discuss in #473 \n. I'll close this one for now and we can chat on the discuss thread. I suspect that the change would be substantial enough Guzzle will end up being a separate repo, but will see how we go!\n. Not familiar with the Freebase API, so you may do better on SO or similar. That said, if posting data is the issue, are you using the media upload options? I am wondering if it needs to be used in that manner (see the media upload example in examples/) in order to transfer the data correctly.\n. Sorry, just a typo re Freebase. Though no experience with fusion tables either. However, it sounds like the issue is with the generated template files though, if some methods are setup correctly and others aren't. Probablly the best thing to do is take a look at the API explorer/other client libraries and see how those requests are handled - it may be that you're not supposed to use them quite the same way, or it could be that the generator needs updating.\n. Best to ask the compute engine team for that specifically! We don't generally include a lot of API specific examples, just examples of generic library behaviour. \n. Haven't seen it, but it sounds like a corrupted cache file of some kind. Would you be able to put together a minimal sample that reproduces the issue? \n. An example with a POST. Object creation is harder as we don't have prexisting class files to look at - in this case its not so bad, but we will try a more complex nested object next to see how it feels. Currently we're passing auth in line, but that would be a subscriber in a realised version.\n$shortener = Service::buildGuzzleClient('urlshortener', 'v1');\n$url = [\n  \"longUrl\" => \"http://riskcompletefailure.com\"\n];\n $short = $shortener->insertUrl(\n    [\n      'resource' => $url,\n      'access_token' => \"ya29.DwHfdfdfdfdfdfdfdfdf\"\n    ]\n  );\nvar_dump($short)\n. Thanks for the feedback! The access token is just temporary - we don't have an auth subscriber written yet. \nRe the classes - that's a fair point. Having a class as you suggest would require that we generate classes based on the discovery doc, which is something that has caused up problems with the fact they can't take pull requests and so on. So the options are:\n1) Use a generic interface (as in first comments)\n2) Generate classes in some open process (so at least template bugfixes would be easier to contribute)\n3) Generate classes locally, so they don't exist at all in repo. \n. We just released a standalone auth library: https://github.com/google/google-auth-library-php\nThis includes guzzle auth subscribers\nNext element would be to use this and start processing the discovery doc. I don't have a clear feeling for how to do class generation (with the obvious options being some kind of script, or roll them by hand and accept they will lag available APIs some). \n. Thanks guys - we did not get to a clear solution on how to handle the write case without a code generation case. I am no longer working on this unfortunately, but if anyone does make any progress on a guzzle client please open an new issue, so the proper people can take a look!\n. Thanks! We don't generally include service specific examples, just ones that demonstrate generic features of the client library. I'd recommend posting this as a gist , and note of the version of the library it was built against. \n. Looks good, thanks!\n. Have you asked the webmaster api team? They may know of any changes. If not, best thing to do is test whether your query works as expected in the API explorer: https://developers.google.com/apis-explorer/#, and see if there is a difference in the call the client library generates, then we can look for any bugs in the library implementation. \n. Urgh. That is presumable the generator mangling two names together into the same PHP name. \n. Yeah, though that would result in the public versions being invisibly out of date, which isn't much better. Maybe we could have the script open a GH issue automatically or similar. Taking a quick look at the discovery doc, it looks like operation error is only defined once, so I'm not totally sure why we're generating both a model and a collection. \n. So, this is a painful one. The issue is that there is an anonymous collection object in Operation called error, and there is a schema called OperationError. Unfortunately, the top level code generator gives them the same name - OperationError. I'm going to see if there is a workaround, but because its part of the generic rather than language specific infrastructure the solutions may not be fast. \n. Fixed! Travis ran the last 2 commits out of order so it still looks failing, but the build should now be passing - the generation OperationError collection has been renamed OperationErrors.\n. From a quick look it looks like it could be using alt=media as a parameter: https://cloud.google.com/storage/docs/json_api/v1/objects/get . You may run into trouble with the lib trying to parse the response as JSON though, so do give it a go (maybe will need executing the request manually). If that's not it maybe try asking the cloud support team how the API is supposed to be used? https://cloud.google.com/storage/docs/resources-support#community \nAlt media download might be a useful example though, so if they give an answer please consider updating this ticket! \n. I'm not sure about the $this->id property check - I can see the check on modelData, but I'm not sure this is addressing the general case? I may be misunderstanding the code though, so please let me know your thoughts.\n. Can you drop the change to the Storage class - that's generated from a Discovery service description so it wont be persisted unfortunately. Otherwise, looks great! Just to check - have you signed the CLA: https://github.com/google/google-api-php-client/blob/master/CONTRIBUTING.md\n. Thanks!\n. The this ->id check seems odd - was that suppose to be looking for a named property in specific, or in general?\n. I wanted a more generalised fix, so I've added a Google_Model::NULL_VALUE const you can use to pass which will be preserved as null. I'll close this one, but if you have an idea for tracking uninitialised variables that works within the current service class structure, would love to see it. Thanks!\n. Thanks! This looks good to me. Can you sign the CLA, then we can merge: https://github.com/google/google-api-php-client/blob/master/CONTRIBUTING.md\n. That looks good, thanks. \n. You would implement it in your loop there. Basically, keep another counter for retrieves and when you get the exception instead of clearing your pageToken, increment the retry counter, and sleep for some multiple of that time. When you get a succesful retrieve clear the counter. You should also have a check inside the catch block that the counter is not greater than some limit (say 4) - if it is you should log that its a persistent failure, and fail the fetch. \n. Looking at your code, it seems like it should always catch the exception, but the output you pasted in indicates that you the exception was uncaught. Are you sure you're running your modified code?\n. There's no reason you can't catch the exception, so I suspect there is a problem in your code yeah. Simplify your script down to the minimal possible code and see whether you can catch the exception.\n. It looks like there is a Google_Client created in https://github.com/thujohn/analytics-l4/blob/master/src/Thujohn/Analytics/AnalyticsServiceProvider.php - is that the one you are modifying to set the cache file location? Otherwise perhaps thats the one thats causing the error to throw?\n. Nothing looks wrong there. I'm guessing the request is hanging on the call to the Google auth servers to get the new token. I'm not sure what to suggest beyond checking when it happens that you server can reach Google and isn't having any other network trouble. \n. The one other potential thing might be if something is going odd with the caching - perhaps something odd with the filesystem. It may be worth attaching a debugger when you get a run of the slowness and see what call it actually hangs on. \n. I think the easiest fix is to change the documented return type on the abstract executeRequest. makeRequest is the right method for most cases. \n. Thanks!\n. And for this one!\n. A basic composer install seems to work OK here with dev master. I'm not quite familiar enough with symfony to know where to look for problems unfortunately. Could you repro with a minimal composer file (and just a simple script that instantiates Google_Client or similar?)\n. No problem! Certainly the autoloading has changed, but it should be possible to add the path for the API to any existing autoloader. Hope you can track down the issue!\n. Maybe ask on the tracker for that package - I'm sure we have a specific opinion on how their stuff works. \n. Do you get the wrong product type back if you use the API explorer for the same query? If so, the problem might be with the shopping API itself rather than the API. If not, just seeing what comes back might give a clue as to what the problem is: https://developers.google.com/apis-explorer/\n. Looks like it!\n. FWIW though, I would probably use Google_Cache_Memcache on AppEngine. The library should do that switch automatically, but you can of course be overriding it. \n. Looks like you have \".listFloodlightActivityGroups\" rather than \"->floodLightActivityGroups\" which could be it. \nFor samples - we don't generally keep service specific examples in the general client library, so the best point of call would the doubleclick team themselves. I would raise a ticket on their issue tracker for the samples repo if there is a problem: https://github.com/googleads/googleads-dfa-reporting-samples/tree/master/php\n. Check your system clock is correct - this sort of thing is usually due to the Google servers and your server disagree. \n. There are a number of examples using the different flavours of OAuth in the examples directory. For a starter, try: https://github.com/google/google-api-php-client/blob/master/examples/user-example.php - or https://developers.google.com/api-client-library/php/auth/web-app\n. Looks like there was a bit of an incident server side. Should all be resolved now AFAICS.\n. Sounds like the autoloader is not firing, how have you got it set up?\n. How have you installed the library? That might give a clue\n. \"There is a per-IP or per-Referer restriction configured on your API key and the request does not match these restrictions. Please use the Google Developers Console to update your API key configuration if request from this IP or referer should be allowed.\"\nThat is the error - you have restricted your developer key in http://console.developers.google.com to a certain IP or IP range, and you're calling it from somewhere else. \n. You can check what range you have restricted the key to on the developer console at http://console.developers.google.com\n. The classes for each API are (and have always been) all in the same file: https://github.com/google/google-api-php-client/blob/master/src/Google/Service/ShoppingContent.php\nNot sure how you ended up with that include!\n. Thanks! I'm a bit concerned about the naming - let me check there aren't any routes where you get files with the old format still. May be that we need to support both. \n. Ended up merging #524 which handled both versions, so this functionality should be in. Sorry  for the delay, thanks though!\n. Whats the exception? There was a question about alt=media downloads the other day - we may need to extend the same raw response handling to alt=cvs. \n. Yeah, enabledExpectedRaw and getExpectedRaw are the right way - but I think we might need to add the check on that from alt=\"media\" or alt = \"media\" or \"csv\"\n. This is a good idea, but the Drive class is generated so your change would get overwritten unfortunately :(. Could you open an issue with how you are doing the upload at the moment, there may be a fix we can do elsewhere in the library to resolve this more generally. \n. Hmm, what operation were you trying to perform? Does look like there is some mismatch, but I'm not sure if the issue is with the client library or elsewhere. \n. I'm wondering if its tied to PHP version as well. @ircmaxell - do you have much familiarity with the SSL options, know if theres any thing we could do here around SANs?\n. That'll do it! Thanks. So - for others on the thread, you should be able to use the cURL IO variant: Google_IO_Curl\n$config = new Google_Config();\n$config->setIoClass('Google_IO_Curl');\n$client = new Google_Client($config);\nor \n$client->setIo(new Google_IO_Curl($client));\nBit of a pain this came out of the blue though. \n. Sounds like a new issue - maybe raise that one with some code to reproduce and we can try it in other environs. \n. The classes are generated from the Discovery service - in this case https://www.googleapis.com/discovery/v1/apis/content/v2/rest. I couldn't see promotion_id in there, so it may not be properly exposed through the API. I would raise that as an issue with the shopping team - they look like they have a forum https://developers.google.com/shopping-content/forum/index\n. Thanks for following up Sam!\n. What is the error that you get when the insert fails? \n. You'll need to enable it on the Google developers console, and use a service account. I'd recommend taking a look at the gitkit quickstart: https://developers.google.com/identity-toolkit/quickstart/php#step_1_configure_the_google_identity_toolkit_api\n. Thanks! That's a really great sample, but we don't host API specific samples unless they're demonstrating a core library feature. This is largely because they get out of date as APIs change and we don't have the familiarity with every API to keep them following every specific best practice. We've recommended that teams create their own samples repo in the past, so perhaps creating your own repo and pulling in the library via composer dependency. If you do that, we can add a link to your examples repo from the README here. \n. Thanks!\n. Ah yeah, that's a bit confusing. The idea was to check if it hasn't been changed from the literal string \"\", but you've done the fairly natural thing which is to change both instances for that string. \n. Yeah, I think that's worth fixing - what I think is the right choice is to make it check for a client ID shaped thing rather than for the specific string.\n. This tracker is for issues with the library itself - for help with specific APIs its best to contact the teams that manage those APIs. For shopping, try the forum: https://developers.google.com/shopping-content/forum/index\nTaking a quick look at the resource though (https://developers.google.com/shopping-content/v2/reference/v2/products#resource) I notice there are different size systems, so perhaps the specific is dependent on using the size system you expect.\n. You set the logo https://console.developer.google.com - go the APIs & Auth section then Consent screen, and you can enter and image URL there. \n. Hmm, that looks OK to me. Can you check the log or add a bit of debug to see what the request URL looks like, whether it has the metadataHeaders query parameter repeated properly?\n. Sounds like the file cache can't access a file - i would just delete that file or give permissions to it. Might be worth a check first to see why the process doesn't have permission (my guess would be it was touched by a version of the client running as a different user). \n. Thanks! Unfortunately this service is generated, so you change would get overwritten :( The fix we need to do is to change the generator - it looks like there is a \"feature\" - \"dataWrapper\" flag in their to indicate the API is using that approach, and we need to have code to handle that case. Judging by previous experience that is likely to take a while, so I might be open to adding a specific check for Translate API calls in the REST.php decode response, and doing the data unwrapping there. Its ugly, but AFAIK this is the only API with this feature. \n. Looks great, thanks!\n. Thanks!\n. Good spot!\n. Thanks!\n. Must admit, not sure if this was a mistake or an attempt to support either version capitalisation wise. I'm relatively happy with removing it for now, but we might see some BC issues for people that were supplying it formatted differently. \n. Looks good.\n. Are you sure you're not overriding your $_SESSION object somewhere? Could you paste in a working, complete code example we can use to verify?\n. Shouldn't need to be a revoke, but it could well be because the user was signed in without a consent screen - for 2nd and future sign ins the consent screen may be skipped and the refresh token not returned. You can trigger a consent screen with the prompt parameter, which should result in a refresh token. \n. Agree, this is a network problem with your machine, not specific to the client library. Maybe try contacting the support for your web host?\n. I think it would be worth making the first case here work - its not exactly a crazy use of the library, so I'll mark this one a FR.\n. Can you try it through the Api explorer: https://developers.google.com/apis-explorer/#p/ - make the same calls, then we can compare the output and see if the client library is doing something wrong (in which case this is the right place for a bug) or the API has a problem (it which case filing an issue with the cloud pub/sub team is best).\n. Service accounts are are a different user from your user, so while your user is enabled, the service account is not. I wrote a little post on this a while back: http://www.riskcompletefailure.com/2015/03/understanding-service-accounts.html\nYou'll need to grant access to your service account email address, if that is possible - probably best to ask on the YouTube stack overflow tag about that though! \n. It may just not be possible to use it with a service account - I would check for somewhere in the web UI where you can grant access to an email address, and try the service accounts email address. If it isn't, you could go through a web sign in flow and store the refresh token, then use that to grant access offline rather than the service account.\n. We only support the APIs available via the discovery service, which is basically the ones in the API explorer (https://developers.google.com/apis-explorer/#p/) - wallet objects seems to be a private API, so you'll need to contact the wallet team/whoever enabled your account for access for the service class.\n. Only thing I can think is that you're using a slightly different openid realm on the openid parameter - that openID 2 ids are realm specific. You might be better off asking this one on the google-openid tag on StackOverflow - I don't think the issue is client library specific. \n. While this is happening in the library, I doubt the library is using 2GB of model. Check whether you have a loop or something that is making the call many times, or using up a lot of memory in another way. \n. There are definitely potentially breaking changes between 1.0.* and 1.1.* (I think we moved to autoloading then, so it depends how you're using the library). \n. Interesting, thanks! Please do send a pull request if you have an improved version of the chunking. \n. No specific plans, but sounds worth releasing another tag. Agreed that doc page is out of date - I think we'll just point people towards packagist to see the available versions. \n. Just tested, and tagged 1.1.3\n. Any chance you could sign in the CLA - link in the bot comment? Understand if not, but we need it for any changes. \n. Thanks!\n. Thanks!\n. Any profile scope should allow retrieving an id token, so profile or email should work. Note that ID tokens are not used for authorization - e.g. they're not used to allow you to query Google APIs.\n. Not sure - sounds like it might be an issue with bigquery itself rather than the client library though. Have you contacted the bigquery team?\n. Service accounts are just a key pair - one part stays with Google and one part you get, so it'll work fine with the key you got from a service account. \n. Make sure you have setup the include path properly (https://developers.google.com/api-client-library/php/start/installation) and included the autoloader. Should be handled for you if using composer. \n. Sounds like you need more than just the simple API access key. Take a look at a sign in example to see how to get an access token to authenticate your request: https://github.com/google/google-api-php-client/blob/master/examples/user-example.php\n. I think you're just missing the actual upload triggering - try calling $client->execute($insertRequest) just before you set defer to false. \n. Could you edit your original issue with the updated code that fires the execute?\n. Can you see if you can get anywhere with the Drive file upload example: in https://github.com/google/google-api-php-client/blob/master/examples/fileupload.php - should be relatively straightforward to adapt it to a video object instead? \n. Aha! I am not familiar with the specifics of  the youtube API, but it a quick check of the API docs: https://developers.google.com/youtube/v3/docs/videos#resource\n\"The video's description. The property value has a maximum length of 5000 bytes and may contain all valid UTF-8 characters except < and >.\"\n. Thats an odd error. Were you able to fetch a single message, or make other successful API calls?\n. I think the place to fix this is in the generated code. The default is specified in the alt parameter description, so we could specify json if atom is the default. Probably a reasonable work around to alwasys specify json as a default in the request object though. \n. Mostly - we can handle raw media download requests as well, so any patch needs to make sure it doesn't clobber the alt handling for that stuff. There is also a standing bug to handle CSV default format responses which would likely be fixed by respecting the default download type (there are some API calls which respond in CSV by default). \nThe point I was making was mainly that this information is in the discovery doc - a lot of the problems we have had have been coding stuff in statically instead of responding to information in the doc, so I would certainly prefer a dynamic solution here.\n. Does the same thing happen via the API explorer on the page you linked? Wondering whether the issue is the API or the library.\n. Reasonable approach, thanks!\n. For future people: anthony is a Googler, ignore clabot. \n. Also: Test seems to be failing. \n. Thanks!\n. SSL is required. \n. Unfortunately, cloud print isn't in discovery, and all the Service classes are generated from discovery documents (https://developers.google.com/discovery/). \n. Are you sure $_SESSION['guid'] is working properly? Maybe you're getting collisions between the two instances, and its messing up the refresh token storage on one?\n. hmm, few things off the top of my head:\n- Is there a refresh token actually in there? You don't always get a refresh token (basically, you do if you request offline AND the user saw the consent screen - so if you reconsent someone the resulting token JSON wont necessary contain a refresh token). This could happen if you sign in on one, then sign in on the other, but they're the same google developers console project?\n- Are you using the right redirect URL in the second instance? That has to match up with what is expected on the developer console for that client ID, or the exchange will fail (maybe its the same redirect URL across both?)\n- Are the times right? Sometimes having a bit of drift will fail token verification. That said, I'd expect that to hit both as they're on the same box. \n. Is that path being generated automatically, or have you set it in the config?\n. Yeah, I think we could probably be defensive here and check for a trailing slash before adding. \n. Sounds like your service account doesn't have authorization. Have you delegated authority to it on your domain? \n. Sounds like you've set it up correctly to me - only other thing I can think to check is that you've enabled the API properly in the developer console (https://console.developers.google.com) for that project?\nYou might get a better response on the SO tag: http://stackoverflow.com/questions/tagged/google-admin-sdk - there should be people on there who are more familiar with this specific API. \n@rudythesnowman :heart: you too!\n. Do you get any more detail on the error? YouTube has a pretty good list of error details that can point in the right direction: https://developers.google.com/youtube/v3/docs/errors\n. Maybe try enabling the logging and see if that gives you anything: https://github.com/google/google-api-php-client/blob/master/src/Google/Client.php#L254 there is a FileLogger that might help. I'm guessing something is failing to parse properly on the recording details, but it'd be easier to inspect in a log. Maybe try hard coding some known good values as well. \n. Sounds like an issue with Drive rather than the client library itself. Though, the extra / in the URL there looks odd. Can you try it via the API explorer and see if it still has the issue there (in which case its definitely an API side issue): https://developers.google.com/apis-explorer/#p/\n. This does not feel like a fully intentional PR! If it is - please rebase and let us know what you're trying to change!\n. If its unable to connect, could you try catching and retrying? There isn't any automatic retry in the library unfortunately.\n. Which version of the client library are you using? That is a fairly fundamental method its missing.\n. Thanks!\n. I would definitely ask this on Stack Overflow or similar (presumably this is about the Drive API?). This tracker is for bugs with the client library directly. \n. Is the issue with the classes or the editor? Have you reached out to the phpstorm folks? \n. I very much like having the cs automatically fixable! The service classes are generated though, I would suggest excluding those and raising an issue for changes needed to the template. Given that the template changes are likely to be a while though, i would minimise the differences to the existing. The biggest one I can see is 4 space indent rather than 2 - could you alter to use a 2 space indent?\n. The service generator got stuck - it should be updated now.\n. I think the moments API is deprecated: https://developers.google.com/+/web/api/rest/latest/moments - guessing its returning some warning. \n. Unfortunately sheets is a gdata API - you can use this lib to get the access token, but it only supports the newer Discovery service based APIs.\n. /* \n- \n  /\nphp doc format comments above functions please.\n. Could you fix indent on these two lines to 2 spaces?\n. I don't think you need the () round the isset call\n. tabbing is off here, and can we have a space before the opening { Thanks!\n. Fix tab. \n. line length - can we keep to 100 width. \n. I think we'll need to bump to 1.2 if we're being semver-ish, as this is potentially a BC break - in the past we would also use the configured basepath if one, but now we will override a configured base path with the one out of the service. Realistically I'm not sure this is really going to hit anyone though - WDYT? We should bump the version number in Client.php regardless to something. \n. Nice test!\n. ",
    "mandersondesign": "Hey Ian,\nJust wanted to chime in here and mention that I would definitely really appreciate this being done. It would be super helpful for my Laravel 4 project.\nThanks for maintaining this project in general!!\nMichael\n. ",
    "mabouza": "On commit 3fbd152 I added a sample to refresh the token in case you'd like to add it to the sample. \n. ",
    "nyaaao": "I see the same behaviour and so far narrowed it down to the Oauth service's scopes not being properly registered with Google_Client. This should be done by the Google_Client::prepareScopes() which is called from Google_Client::createAuthUrl().\nIn the old library there was a Google_Client::prepareService, which was called from Google_Client::createAuthUrl() as well as Google_Client::authenticate().\nI'm still digging this, but there's a workaround to this:\nyou can call Google_Client->setScopes('') before a call to createAuthUrl() to explicitly set the scopes.\nThis way you will be able to get the info.\n. @alvarolb , you beat me to it ^_^; I was about to send exactly the same pull request myself...\n. If we're removing the Google_Client->addService(), can we do something about the service initialization, i.e. the restriction when initializing with an authenticated Google_Client? Currently we may obtain the access token from  somewhere else, skip the Google_Client->authenticate() part and use Google_Client->setAccessToken() right away, effectively bypassing the restriction and getting a 401: Unauthorized Request in the face if the token did not grant the access to the API. If the developer would be responsible for getting the right token and there is nothing else in the library that depends on this, we may safely remove this check altogether.\n. I see some oddities with this source:\n1) There's no session_start call while the authentication flow is relying on $_SESSION variable;\n2) You call $client->setScopes() twice. While that's ok, it leaves you only with the scope from the last call, i.e. it overwrites whatever scopes were there with the value supplied. You can either pass the array of scopes or a space-delimited string of scopes;\n3) Currently you need to instantiate all the services before calling $client->authenticate()\n4) You may want to user the $service only when the authentication is done. \nif ($client->getAccessToken()) {\n     $service->tasklists->listTasklists();\n}\nNote that this is necessary only for the calls that REQUIRE and authentication, otherwise you can just set the developer key in the client and make a call (like in simple-query.php example)\nPS:  I expect you to have the developer key, client ID and a client secret needed to properly initialize the Google_Client. If you don't, refer to this page https://developers.google.com/api-client-library/php/start/get_started\n. ",
    "alvarolb": "Ok, I have set the following scopes declared by default in OAuth2 before creating the createAuthUrl an now its working fine:\n$client->setScopes(array(\n    \"https://www.googleapis.com/auth/plus.login\",\n    \"https://www.googleapis.com/auth/userinfo.email\",\n    \"https://www.googleapis.com/auth/userinfo.profile\",\n    \"https://www.googleapis.com/auth/plus.me\"\n));\nSo there is a bug by automatically setting the scopes in client when adding an OAuth2 service to client. By default this request requires more user information like plus circles and other google plus information, what does not happen with previous OAuth2 version.\n. I found the problem, I have proposed a pull request in:\nhttps://github.com/google/google-api-php-client/pull/7\nIt was a little bug when adding serviceScopes to requestedScopes...\n. @nyaaao I fix that thanks to your help =) \nI dont know how this bug is present in this version... there are 51 calls to addService with availableScopes! Some of them contains only one scope, so there is no problem, but many of them contains more than one or 0! A little bug that affects all services...\n. I now understand the problem. In this case I would propose a simple approach:\nIn order to keep the code as is I would add a method in Google_Service called 'setRequestedScopes' with an array of strings. This method can check that the given requested scopes are within initialized available scopes to avoid user submitting invalid scopes for the given service. Also, as the client is yet initialized in Google_Service by its child class, automatically call a method on Google_Client called setServiceScopes filing the $requestedScopes similar to addService, maybe with the same parameters. Then, in prepareScopes iterate over requestedScopes instead of available availableScopes, so in this case are only filled the requested scopes. In this case I do not see necessary the addService method (and availableScopes) in Google_Client as it would contain redundant information and only is used, apparently, in prepareScopes.\nSo in this way each service will contain it set of availableScopes and the client a set of requestedScopes for each added service as the user requirements. This would require documentation about scopes for each service...\n. I also agree, there should be some way of selecting desired scopes, so no default scopes are selected by default. \n. ",
    "silvolu": "I agree with Ian, requiring the scope to be specified is the only really sustainable choice.\n. Fixed starting from this commit.\n. Hi Guillermo,\nCan you try to perform the same operation using  the Google API Explorer? \n. Check @ianbarber reply to #1 for both the issue and the side note, basically autoloading is not currently supported and given that almost half of the users of the library are still on PHP 5.2, we have to wait for more usage shift to newer versions of PHP :/\nBut we should at least document the workaround needed to use the autoloader, I'll do it ASAP.\n. Closing because there has been no action on it, if you want to send a pull request we will consider it.\n. Hi,\nplease don't use this issue tracker unless you are reporting bugs or a feature request. Check this doc to find out the suggested ways of getting support.\nThanks.\n. Hi,\nplease don't use this issue tracker unless you are reporting bugs or a feature request. Check this doc to find out the suggested ways of getting support.\nThanks.\n. Hi,\nplease don't use this issue tracker unless you are reporting bugs or a feature request. Check this doc to find out the suggested ways of getting support.\nThanks.\n. Hi,\nplease don't use this issue tracker unless you are reporting bugs or a feature request. Check this doc to find out the suggested ways of getting support.\nThanks.\n. Hi,\nthat is not a bug in the client library, but a bug in an example of YouTube usage, that we didn't write and cannot fix.\nThe 'Get Help' section of the YouTube API documentation says that you can ask questions here.\nThanks\n. Hi,\nI sent an email to the author of the example reporting your problem. I'll update this thread when I get a reply.\nThanks!\n. Looks like this has been fixed on Stack Overflow, closing.\n. Hi,\nplease don't use this issue tracker unless you are reporting a bug or a feature request. Check this doc to find out the suggested ways of getting support.\nThanks.\n. Fixed in #54 \n. @hukuta thanks for contributing this, it's has been tidied up and merged in #54.\n. Hey @kroikie, could you add some basic tests for this?\n. Closing because there hasn't been any actions on it.\n. @413xl I don't understand what your question is here.\n. Sorry but we can't help you, that's an API specific problem.\nPlease check this doc to see if it can help you, or contact the support as described here.\n. @shina I cannot reproduce your issue. The following code works fine for me:\nphp\n// your code to get tokens here\n$token_data = $client->verifyIdToken()->getAttributes();\n$token = json_decode($client->getAccessToken());\n$client->refreshToken($token->refresh_token);\n$token_data2 = $client->verifyIdToken()->getAttributes();\n. Closing for now, please reopen if needed.\n. @mak-ru could you please report your issue in the Analytics issue tracker?\n. Thanks for contributing this @PabloVallejo, but even for small changes like this one we need you to sign the Google Individual Contributor License Agreement before we can merge it.\n. Thanks, this has been picked up and fixed in #65, but signing the CLA will be useful for future contributions.\n. @cartland I tested revokeToken and it's working for me, it returns true after revoking a token.\n. Fixed in #65 \n. @jsor this looks like a bug in the YouTube API, I sent an email to one of my colleagues working on the API to make them aware of it.\n. Closing because there hasn't been any activity on this issue. \n. Thanks for the feedback @AdamWill, I've just published an update to the migration doc:\nhttps://developers.google.com/api-client-library/php/guide/migration\n. @mateisilviu if you try the same query on the Google API Explorer, does it work? \n. @mateisilviu could you send me a gist containing a complete example that I can run to test your issue?\n. @lucassimmons Stream.php is now throwing an exception containing the error code when a request fails. Would you mind sending a pull request to fix the nextChunk bit? If you can do that, please sign the CLA as explained here if you haven't already.\n. @lucassimmons you shouldn't need to change the value of the ZLIB constant, disabling gzip in the config should be enough.\nThe 403 issue doesn't look like a client library bug, but a problem with your tokens instead. Can you please move the discussion to Stack Overflow using the google-api-php-client tag?\n. Merged #79\n. Thanks @lucassimmons, I overlooked it when merging. Fixed in 6aac166\n. @lucassimmons unfortunately we won't support the Spreadsheet API, because it's based on the Google Data Protocol, and this library supports only APIs based on the Google APIs Discovery Service.\n. Thanks @andrewryno, for this and for the pointer on using composer autoloading in the tests.\nBefore we can merge this PR, we need you to sign the Google CLA as described here.\n. @andrewryno found it, I was looking for the email address of your GitHub user!\nWe're good to merge then.\n. @AdamWill sorry for not picking up the comment in the closed issue, but yes, the default changed to 'online' after we added it as config parameter. I'll update the docs right now.\nRegarding the general discussion: access token expires after 1 hour. With 'offline' access type your app receive a refresh token, that enables your app to get a new valid access token for a user even if the user is not actively using your app (hence 'offline'). You get the refresh token only once though, and that is after the user has been shown the consent dialog and has approved your app. If for any reasons you lose the refresh token, setting approval prompt to force will show the consent dialog to the user again, so that you can get another refresh token. Ian has written about it here.\n. @AdamWill Mmm, that's strange, the code to update the values after the refresh is here. To be sure I made a test forcing OAuth2::isAccessTokenExpired to return true, and I can see the difference in the token stored in the client library after the refresh.\n. Change to the docs published. Please open another issue if you still have problems with updates to the tokens.\n. I cannot reproduce with the dev version of the client. I created a Spreadsheet from the Google Drive web interface, noted down the id of the sheet, executed the following code:\nphp\n$id = '<id_of_the_spreadsheet>';\n$file = $service->files->get($id);\n$exportLinks = $file->getExportLinks();\n$downloadUrl = $exportLinks['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'];\n$request = new Google_Http_Request($downloadUrl);\n$httpRequest = $client->getAuth()->authenticatedRequest($request);\nAnd I get a 200 and the content of the file in the ResponseBody. I tried using both Google_IO_Curl and Google_IO_Stream. Othen config params that might be relevant:\nphp\nconst GZIP_DISABLED = true;\nconst GZIP_ENABLED = false;\nconst GZIP_UPLOADS_ENABLED = true;\nconst GZIP_UPLOADS_DISABLED = false;\n. Thanks for your contribution, could you rebase so that this should merge cleanly? Did you sign our CLA? If not, could you please do it following the instructions that you can find here ?\n. Sorry, I don't understand what your problem is. Could you tell me which method of the Fusion Tables API you are trying to use and what's the name of the parameters that is missing, or include a successful request/response made with cURL?\n. Closing for lack of activity.\n. https://developers.google.com/open-source/cla/corporate is ok. Could you also please rebase so that it should merge cleanly?\n. Thanks for raising this issue @mishan, I've just sent #119 to fix the issues with the certs used by Google.\n. Sorry, this issue tracker is not for support issue, but only to report bugs for the Client Library.\nPlease check this doc to check support options.\n. in #133 I fixed a test and Stream.php, but I think this should have been fixed by #109.\n. @stephanvierkant the Google Apps Email Audit API is based on the Google Data Protocol, and as such is not supported by this Client Library.\n. The Google Cloud Print API is documented here, but it's not supported by this client library.\n. @mishan we have a script that should automatically remove duplicates, but it's obviously not working :D I'm running a couple of tests, then I'll merge this PR. \n. @divyabatra please use this issue tracker only to file bugs on the client library. You can find more info on how to get support here.\n. Fixed in #138 \n. @DavidAnderson684 I cannot reproduce your issue, the example is working for me.\nBy any chance have you changed or removed line 82?\nSetting defer to true on the client defers the return of the resource, so that a raw request is returned instead.\nThis is explained in the comments of the code snippet contained in the Resumable File Upload section of the Media Upload docs.\n. @mishan now the script is really fixed and picked this up in ed8b8325d8b938e47352c440e71848bd80b76393 , thanks!\n. @dd32 thanks for your contribution. I couldn't find your name or the email address associated to your github account in the list of signers of our Contributor License Agreement, could you please sign it following this instructions?\n. @Dundee thanks for your contribution. The API-specific classes that you can find in the Service  folder (such as Analytics.php) are generated by a script, and if I merge your pull request, the change will be overwritten tonight. So, I'll fix the script :D\n. @citaliano you should report your problem to the Google Apps technical support using the Admin Console for the domain.\n. Looks like you get best effort support:\nhttps://support.google.com/a/answer/3156070?hl=en-IN&ref_topic=29816\n. @alexanis sorry about that, I've just fixed the instructions, should be correct now.\n. Thanks @LindaLawton!\n. Thanks @firecentaur, but all the service classes are automatically generated by a script that runs against the Google API Discovery Service, so all your changes would be overwritten on the next API update.\n. Thanks for your contribution @onema. I couldn't find you in the list of signers of our Contributor License Agreement, and we need you to be in it to merge your change.\nCould you please follow the instructions to sign and update this issue after doing it?\n. Thanks!\n. I'm for doing more work later to move to autoloading.\n. @Vinceg and others, providing a limited set of examples is actually a choice we made, mostly for historical reasons.\nIn previous versions of the client library, we included several examples of usage for different APIs contributed by others, but most of those examples became stale over time.\n@ianbarber and I have the expertise to implement a PHP library based on the Google APIs Discovery Service and other features needed to use the APIs (e.g. OAuth 2.0 authentication, media upload etc), but we don't have expertise/time to maintain samples for the 50+ Google APIs that support the Discovery Service.\nSo our choice has been to provide samples and docs for the main features of the library, given that most of the time the delta to adapt the sample to a different APIs should be minimal (e.g. different scopes for auth).\nI'd like to keep the main repo as it is; that said, if you want to start a separate repo to offer a broader set of examples, I'd be very happy to add a section in the README to link to it.\n@ianbarber any thoughts on this?\nRegarding the CLA: there is no reply, it's a one way communication where you tell us that you agree to our contributor license and we record your signature. Sorry about the confusion.\n. This library supports only APIs based on the Google APIs Discovery Service, and unfortunately email-settings is not one of those.\n. Are you installing the dev version (require \"google/apiclient\": \"1.0.*@dev\"?)?\nWe'll soon cut a 1.0.5-beta release that will include the gmail service, but we're waiting to complete some other changes in the way we write the services before doing that.\n. Cool, sorry about the issue!\n. @tomshaw it's not a .p12 file. To get the .p12 file, open the Google Developers Console, select the project, in the left nav click on APIS & AUTH and then Credentials, click on Generate new P12 key under the service account you want to use.\n. I cannot reproduce. If I try to run exactly your code (well, adding autoloading bits and required values), I get a 'Google_Auth_Exception' with message 'Error fetching OAuth2 access token, message: 'invalid_grant: Code was already redeemed.'\n. If I try a random string, I get:\nUncaught exception 'Google_Auth_Exception' with message 'Error fetching OAuth2 access token, message: 'invalid_grant''\n. I'll try to get some time next week.\n. Which version are you on? It was updated in april 2014 :)\n. @samsamm777 yeah we've been thinking about it. @ianbarber and I have been trying for a while to find some time to start looking at things like:\n- how to convert from the Google discovery service to guzzle service descriptions\n- write an OAuth2 subscriber (or use an existing one, do you know any?)\n- figure out if we need something for the media uploads bits to work\nThe good news is that it's happening tomorrow :) We'll probably push something to a new branch (given the 5.4 requirement), and then look for volunteers to help completing the work ;-)\n. ",
    "appadmindelhi": "I can print the user information if i put the below code on my localhost(Using Xampp Server)\n$oAuth = new Google_Service_Oauth2($client);\n$userData=$oAuth->userinfo_v2_me->get();\necho \"<pre>\";\nprint_r($userData);\necho \"</pre>\";\nBut can not print the user details when i have moved my code from local to live server.\nI don't know what is the issue.\n. ",
    "bichitra12": "i am not getting name for some user please help. ",
    "mikehudak": "@nyaaao Excelent tips. My main problem was 3rd tip where I call $service = new Google_Service_Tasks($client); BEFORE $client->authenticate()\nAppreciate your help :) \nThank you\n. This library is missing huge lack of documentation ...\n. ",
    "dustindoiron": "Noticed the contribution from an earlier submission resolves this issue.\n. ",
    "tamurayoshiya": "Same issue here, and not only \"start-date\" and \"end-date\" but also \"max-results\".\n. ",
    "spacesuitdiver": "Ah nevermind, had a second request somewhere in my code. :)\n. I did notice it implemented ArrayAccess afterward. The CMS I am building a module for requires an array and it'd be ideal if I didn't have to map the data in the object myself.\nI tried type casting and that provided the first key but then the rest got cut off. Strangely passing $service['data']['items'] seems to work if I just want to pass in the items only, not the events collection metadata.\nget_object_vars() works but doesn't return the multidimensional data (such as items). \nIt'd be nice to be able to get the response somehow and be done with it.\nThanks for your response btw.\n. This iterative function runs through all the \"getter\" methods and crams the results into a multidimensional array. I'm sure this is like making fire with twig and twine but it seems to work:\nfunction cl_object_to_array($object) \n{\n    $result = array();\n    foreach(get_class_methods($object) as $method)\n    {\n        if (strpos($method, \"get\") === 0) {\n            $data = $object->$method();\n            if (is_object($data))\n            {\n                $result[lcfirst(substr($method, 3))] = cl_object_to_array($data);\n            } \n            elseif (is_array($data)) \n            {\n                foreach ($data as $key => $value) \n                {\n                    $result[lcfirst(substr($method, 3))][$key] = cl_object_to_array($value);\n                }\n            } \n            else \n            {\n                $result[lcfirst(substr($method, 3))] = $data;\n            }\n        }\n    }\n    return $result;\n}\n. ",
    "cdavidyoung": "This seems to do the trick:\nset_include_path(get_include_path() . PATH_SEPARATOR . 'includes/google-api-php-client/src');\n. ",
    "guillefd": "I can confirm that the bucket exist, as I get a 200 response with full object info when running GET_BUCKET:\nobject(Google_Service_Storage_Bucket)[182]\n  {.......}\n  protected 'defaultObjectAclType' => string 'Google_Service_Storage_ObjectAccessControl' (length=42)\n  protected 'defaultObjectAclDataType' => string 'array' (length=5)\n  public 'etag' => string 'CAI=' (length=4)\n  public 'id' => string '{here-goes-my-existing-bucket-name}' (length=42)\n  {.......}\n  public 'name' => string '{here-goes-my-existing-bucket-name}' (length=42)\n  protected 'ownerType' => string 'Google_Service_Storage_BucketOwner' (length=34)\n  protected 'ownerDataType' => string '' (length=0)\n  public 'selfLink' => string 'https://www.googleapis.com/storage/v1beta2/b/{here-goes-my-existing-bucket-name}' (length=87)\n  {.......}\nCould this be an issue of the API?\n. Hi Silvolu, thanks for your reply.\nThis was an issue concerned with the service, not with the php client. The service is running again so all is working fine, thanks!\n. ",
    "fillup": "@silvolu, @ianbarber, Thanks for the response. In that case, there is actually a better way to do the autoloading that should work even under the conditions of having multiple classes defined in a single file. I'll test out my idea and submit a pull request if it works.\n. Yep, did that just before submitting pull request. Thanks.\nOn Dec 23, 2013 9:18 AM, \"Ian Barber\" notifications@github.com wrote:\n\nGood suggestion! That actually makes a lot more sense as a default,\nthanks. Brief bit of lawyercatting before merging the PR: Have you\npreviously signed the Google CLA at all? If not, could you fill in the form\nat the bottom of\nhttps://developers.google.com/open-source/cla/individual?csw=1 ?\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/google/google-api-php-client/pull/21#issuecomment-31121156\n.\n. \n",
    "kyogaraj": "Is there any contacts service  to get google contacts from gmail and export back to gmail working in google-api-php-client? I could\nI don't see any google contact service still, should we gohead and use zend framework? \nI'm creating a new entry in a very very weird way as shown below. I alsoi want to do batch creation, or batch update/. I don't know how to work around that. Any help would be appreciated. \nfunction createNewEntry($accesstoken){\n```\n$_POST[] = array();\n$_POST['fname'] ='the_first_name';\n$_POST['lname'] = 'the_last_name'\n$_POST['email_id'] = '@.edu';\n$_POST['phone'] = '888-888-8888';\n$_POST['postal'] = '9*42';\n$_POST['country'] = 'USA';\n$_POST['address'] = '123 st, apt 123, 123city';\n// create new entry\n$doc = new DOMDocument();\n$doc->formatOutput = true;\n$entry = $doc->createElement('atom:entry');\n$entry->setAttributeNS('http://www.w3.org/2000/xmlns/', 'xmlns:atom', 'http://www.w3.org/2005/Atom');\n$entry->setAttributeNS('http://www.w3.org/2000/xmlns/', 'xmlns:gd', 'http://schemas.google.com/g/2005');\n$doc->appendChild($entry);\n$cat = $doc->createElement('atom:category');\n$cat->setAttribute('scheme', 'http://schemas.google.com/g/2005#kind');\n$cat->setAttribute('term', 'http://schemas.google.com/\n        /2008#contact');\n$entry->appendChild($cat);\n// add name element\n$name = $doc->createElement('gd:name');\n$entry->appendChild($name);\n$givenName = $doc->createElement('gd:givenName', $_POST['fname']);\n$familyName = $doc->createElement('gd:familyName', $_POST['lname']);\n$fullName = $doc->createElement('gd:fullName', $_POST['fname'] . $_POST['lname']);\n$name->appendChild($givenName);\n$name->appendChild($familyName);\n$name->appendChild($fullName);\n$content = $doc->createElement('atom:content', 'Notes');\n$content->setAttribute('type', 'text');\n$entry->appendChild($content);\n// add email element\n$email = $doc->createElement('gd:email');\n$entry->appendChild($email);\n$email->setAttribute('address', $_POST['email_id']);\n$email->setAttribute('displayName', $_POST['fname']);\n$email->setAttribute('primary', 'true');\n$email->setAttribute('rel', 'http://schemas.google.com/g/2005#work');\n// add im element\n$im = $doc->createElement('gd:im');\n$entry->appendChild($im);\n$im->setAttribute('address', $_POST['email_id']);\n$im->setAttribute('protocol', 'http://schemas.google.com/g/2005#GOOGLE_TALK');\n$im->setAttribute('primary', 'true');\n$im->setAttribute('rel', 'http://schemas.google.com/g/2005#home');\n// add phone element\n$ph = $doc->createElement('gd:phoneNumber', $_POST['phone']);\n$entry->appendChild($ph);\n$ph->setAttribute('rel', 'http://schemas.google.com/g/2005#home');\n//insert Address\n$address = $doc->createElement('gd:structuredPostalAddress');\n$address->setAttribute('primary', 'true');\n$address->setAttribute('rel', 'http://schemas.google.com/g/2005#work');\n$entry->appendChild($address);\n$postal = $doc->createElement('gd:postcode', $_POST['postal']);\n$country = $doc->createElement('gd:country', $_POST['country']);\n$fulladd = $doc->createElement('gd:formattedAddress', $_POST['address']);\n$address->appendChild($postal);\n$address->appendChild($country);\n$address->appendChild($fulladd);\n$contact_detail = $doc->saveXML();\n$url = 'https://www.google.com/m8/feeds/contacts/default/full?&v=3.0&oauth_token='. $accesstoken;\n$curl = curl_init();\nprint_r(\"auth url is $url\");\ncurl_setopt($curl, CURLOPT_URL, $url);\ncurl_setopt($curl, CURLOPT_POST, 5);\ncurl_setopt($curl, CURLOPT_POSTFIELDS, $contact_detail);\ncurl_setopt($curl, CURLOPT_RETURNTRANSFER, TRUE);\ncurl_setopt($curl, CURLOPT_SSL_VERIFYPEER, FALSE);\n$curlheader[0] = \"Content-Type: application/atom+xml\";\n$curlheader[2] = \"Content-length:\" . strlen($contact_detail);\n$curlheader[1] = \"Content-Transfer-Encoding: binary\";\ncurl_setopt($curl, CURLOPT_HTTPHEADER, $curlheader);\n$xmlresponse = curl_exec($curl);\necho '';\nprint \"added liz@gmail.com\";\nvar_dump($xmlresponse);\necho '';\n```\n}\n. ",
    "bendiy": "It's a non-Google API. I can always extend the classes, but was interested in seeing if this could be a core feature.\n. ",
    "molecularbear": "My mistake, I was using v1.0.0-alpha instead of master. Feel free to close this issue - sorry about that!\n. ",
    "danielbeardsley": "A Corporate CLA covering all of iFixit's github users has been sent to cla-submissions AT google.com. This contribution and #36 are now covered by that CLA.\n. A Corporate CLA covering all of iFixit's github users has been sent to cla-submissions AT google.com. This contribution and #28 are now covered by that CLA.\n. ",
    "yopen": "Can someone please fix this issue?\n. ",
    "chadladensack": "Bah, my bad - I should have reviewed the contributing.md notes that clearly identify this.  I'll get one filled out just in case.  Thanks for pulling this in, Ian.  I really do appreciate it.\n. ",
    "adamwathan": "Hey Ian, signed the CLA and also wanted to confirm you noticed in the second commit I actually fixed what you had commented on in the initial submission, for mostly the same reason, so hopefully it looks good to pull!\n. ",
    "Draven714": "I removed the $client->setDefer(TRUE); and $client->setDefer(FALSE); code and I get a little further. \nFatal error: Uncaught exception 'Google_Service_Exception' with message 'Error calling POST https://www.googleapis.com/youtube/v3/videos?part=status%2Csnippet&key=BLAH_BLAH: (400) Bad Request' in Google/Http/REST.php:79\nStack trace:\n0 Google/Http/REST.php(49): Google_Http_REST::decodeHttpResponse(Object(Google_Http_Request))\n1 Google/Client.php(492): Google_Http_REST::execute(Object(Google_Client), Object(Google_Http_Request))\n2 Google/Service/Resource.php(194): Google_Client->execute(Object(Google_Http_Request))\n3 Google/Service/YouTube.php(2516): Google_Service_Resource->call('insert', Array, 'Google_Service_...')\n4 Google/Http/REST.php on line 79\nOnly thing I can tell wrong is that it's missing \"upload/\" from the URL.\n. ",
    "trnila": "I have a same issue but with Drive API file insert.\nIt seems that method transformToUploadUrl from class Google_Http_MediaFileUpload is appending \"/upload\" to the request's baseComponent(which is NULL and should be https://www.googleapis.com), because of this /upload set, absolute path to the https://www.googleapis.com couldn't be set because condition fails in method execute in class  Google_Http_REST\nphp\npublic static function execute(Google_Client $client, Google_Http_Request $req)\n{\n   if (!$req->getBaseComponent()) {\n     $req->setBaseComponent($client->getBasePath());\n...\nAs a quick'n'dirty fix I hardcoded baseComponent in method transformToUploadUrl like this\nphp\n  private function transformToUploadUrl()\n  {\n    // $base = $this->request->getBaseComponent(); // - there is NULL, because method execute is called afterwards\n    $base = 'https://www.googleapis.com';\n    $this->request->setBaseComponent($base . '/upload');\n  }\n. ",
    "lucassimmons": "So will cURL not be enabled until this is signed by @marczych ?\n. Great!  Looking forward to it.\n. I am getting the same thing as @andrewryno \n. Any ETA on getting this merged?\n. A similar issue exists in /src/Google/IO/Stream.php - if the request fails it would be helpful to know at least the error code of the failure... This code \nif (false === $response_data) {\n  throw new Google_IO_Exception(\"HTTP Error: Unable to connect\");\n}\ncould be updated to\nif (false === $response_data) {\n  throw new Google_IO_Exception(\"HTTP Error: \" . $this->getHttpResponseCode($http_response_header) . \" Unable to connect\");\n}\n. I am using the old version of the API (switched to using Google_HttpStreamIO) and am getting the same message, but randomly.  It will work sometimes and others not.  This code was working two days ago fine, and all of the sudden it is now returning this error intermittently.\n. @ianbarber I switched my code to use the new API client.  Everything worked fine on my localhost.  I uploaded all of my code to my Compute Engine dev server and I started getting these 400 errors.  For Cloud Storage, if I changed the   const ZLIB = \"compress.zlib://\"; to   const ZLIB = \"\"; it worked fine\nFor Drive, though I cannot connect - I get a 403 forbidden message.  Which I know my credentials are good, because I can successfully create a cloud storage bucket and my localhost uses the same API credentials as my dev server.\nHere is my test code:\n  include_once 'gapi_php_client_1/src/Google/Client.php';\ninclude_once 'gapi_php_client_1/src/Google/Service/Drive.php';\n$client = new Google_Client();\n$client->setApplicationName('Google+ PHP Starter Application');\n//// Visit https://code.google.com/apis/console?api=plus to generate your\n//// client id, client secret, and to register your redirect uri.\n$client->setClientId($client_id);\n$client->setClientSecret($client_secret);\n$client->setRedirectUri('postmessage');\n$client->setAccessToken($session_access_token);\n$client->refreshToken($session_refresh_token);\n$client->setScopes(\"https://www.googleapis.com/auth/plus.login https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.readonly https://www.googleapis.com/auth/sqlservice.admin https://www.googleapis.com/auth/cloud-platform https://www.googleapis.com/auth/devstorage.full_control\");\n$drive = new Google_Service_Drive($client);\n$file = $drive->files->get(\"file-id\");\n[Sat Feb 01 19:34:52 2014] [error] [client 76.168.177.7] PHP Warning:  file_get_contents(): HTTP request failed! HTTP/1.0 403 Forbidden\\r\\n in /var/www/html/gapi_php_client_1/src/Google/IO/Stream.php on line 117\n[Sat Feb 01 19:34:52 2014] [error] [client 76.168.177.7] PHP Warning:  file_get_contents(compress.zlib://https://www.googleapis.com/drive/v2/files/FILE_ID_HERE): failed to open stream: operation failed in /var/www/html/gapi_php_client_1/src/Google/IO/Stream.php on line 117\n. @silvolu Thanks!  Now that I disabled gzip in the config, it seems to work better - do you know if this is this a server issue or a client api issue?  I still get random connection timeouts though... \nfile_get_contents(https://www.googleapis.com/drive/v2/files//children?q=title+%3D+%27LICENSE.txt%27+and+trashed+%3D+false): failed to open stream: Connection timed out in /var/www/html/gapi_php_client_1/src/Google/IO/Stream.php on line 115\nThe 403 issue would happen randomly though... and now that I have disabled gzip everything works fine.  I did not change my tokens.\n. @ianbarber Great!  Are you referring to adding a note in the docs and also updating the code?  Should I do a pull request for that or will you be updating it?\nAlso, did you see the part about lcfirst?  I didn't have a solution for that... \n. FYI I switched my localhost back to 5.2.17 after this update and I tested it using Google Drive to upload files and I would get (0) Invalid json in service response: \u001f\u2039\b - but the code worked fine in newer versions of PHP\n. @ianbarber In Client.php - shouldn't it be <= and not >=?\nif (version_compare(phpversion(), \"5.3.4\", \"<=\") || $this->isAppEngine()) {\n    // Automatically disable compress.zlib, as currently unsupported.\n    $config->setClassConfig('Google_Http_Request', 'disable_gzip', true);\n  }\n. Google is aware of this issue (assuming you are on app engine)\nWe are investigating an issue with authentication on Google App Engine\nbeginning at Thursday, 2015-03-05 07:32 (all times are in US/Pacific).\nAffected applications are responding with a HTTP 302 on user login, or with\na 403 error connecting to Google APIs.\nWe will provide more information by 09:00 US/Pacific time.\nOn Thu, Mar 5, 2015 at 8:33 AM, Steve Edson notifications@github.com\nwrote:\n\nI've started getting the following error when calling\n$client->refreshToken($refreshToken);\n[05-Mar-2015 16:10:37 UTC] PHP Fatal error:  Uncaught exception 'Google_Auth_Exception' with message 'Error refreshing the OAuth2 token, message: '\n302 Moved\n302 Moved\nThe document has moved\nhere.\n\n'' in \\htdocs\\vendor\\google\\apiclient\\src\\Google\\Auth\\OAuth2.php:327\nStack trace:\n0 \\htdocs\\vendor\\google\\apiclient\\src\\Google\\Auth\\OAuth2.php(255): Google_Auth_OAuth2->refreshTokenRequest(Array)\n1 \\htdocs\\vendor\\google\\apiclient\\src\\Google\\Client.php(352): Google_Auth_OAuth2->refreshToken('1/c5OOGvovbzYEK...')\n2 \\htdocs\\apps\\analytics\\index.php(94): Google_Client->refreshToken('1/c5OOGvovbzYEK...')\n3 {main}\nthrown in \\htdocs\\vendor\\google\\apiclient\\src\\Google\\Auth\\OAuth2.php on line 327\nObviously I should be catching the exception, however I'm not sure why it\nis being thrown in the first place, especially when it is from internal\nmethods. It is currently using 1.0.3-beta.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/501.\n\n\nThanks -\nLucas Simmons\n. The problem with authentication on Google App Engine and the Google APIs\nwas resolved as of Thursday, 2015-03-05 08:27 (all times are in\nUS/Pacific). We apologize to our customers for the inconvenience, and we\nthank you for your patience and continued support.\nWe will provide a more detailed analysis of this incident once we have\ncompleted our internal investigation.\nOn Thu, Mar 5, 2015 at 9:05 AM, Ian Barber notifications@github.com wrote:\n\nLooks like there was a bit of an incident server side. Should all be\nresolved now AFAICS.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/501#issuecomment-77404319\n.\n\n\nThanks -\nLucas Simmons\n. ",
    "marczych": "Sorry about the delay on that CLA! I'm waiting on @danielbeardsley to sign the corporate CLA which will also cover #28.\n. ",
    "andrewryno": "Hoping this can get merged soon. We just started having a bunch of problems with file_get_contents returning Failed to enable crypto when contacting a few of the Google APIs since they apparently use SSL v3.\n. I'd love to submit a PR but I can't seem to run the tests. set_include_path() isn't working apparently (which is kind of a janky way of doing it anyway). It would be nice if the tests just used the composer autoloader.\nNotice the include path is the default:\n```\nandrewryno:google-api-php-client/ (master\u2717) $ phpunit tests\nPHP Warning:  require_once(Google/Client.php): failed to open stream: No such file or directory in /Users/andrewryno/Sites/google-api-php-client/tests/BaseTest.php on line 18\nWarning: require_once(Google/Client.php): failed to open stream: No such file or directory in /Users/andrewryno/Sites/google-api-php-client/tests/BaseTest.php on line 18\nPHP Fatal error:  require_once(): Failed opening required 'Google/Client.php' (include_path='.:/usr/local/Cellar/php54/5.4.24/lib/php') in /Users/andrewryno/Sites/google-api-php-client/tests/BaseTest.php on line 18\nFatal error: require_once(): Failed opening required 'Google/Client.php' (include_path='.:/usr/local/Cellar/php54/5.4.24/lib/php') in /Users/andrewryno/Sites/google-api-php-client/tests/BaseTest.php on line 18\n``\n. I moved all tests to use autoloading (see: https://github.com/andrewryno/google-api-php-client/tree/autoload-tests) so it works for me now. Added tests and submitted PR #82. Closing this issue in favor of the PR.\n. @silvolu I filled it out yesterday. Let me know if you can't find my submission.\n. Marko's suggestions are great, especially using the param. Most OAuth implementations use thestateparameter which will be passed back to your app. So when you redirect the user to Google you would append&state=googleto the redirect URI and then when it comes back it will be?code=XXX&state=google` and you could detect that.\nWhat I would recommend is using a library that will handle OAuth for many different providers. Personally, I use https://github.com/Lusitanian/PHPoAuthLib but there is also https://github.com/thephpleague/oauth2-client/.\n. I removed it temporarily and saw marginal performance improvements (5 jobs per 10 seconds instead of 3-4 per 10 seconds, which could be coincidence). No concrete benchmarks though. I'll do some more testing tonight and see if I can get some actual numbers.\n. ",
    "chrisSowerby": "did you figure it out?\nis there a code example available to use google analytics?\n. ",
    "JavierGonzalez": "This is actually a bug, because is about a file in your API example that doesn't exist.\nPHP\n// Call set_include_path() as needed to point to your client library.\nrequire_once 'Google/Client.php';\nrequire_once 'Google/Service/YouTube.php';\nrequire_once 'Google/Service/YouTubePartner.php'; // <--- This file doesn't exist!\nsession_start();\nSource: https://developers.google.com/youtube/partner/code_samples/php#uploading_a_new_reference__so_youtube_can_automatically_generate_claims_for_newly_uploaded_videos_on_behalf_of_the_asset_s_owner\n. Ok, but we actually need the file YouTubePartner.php.\nDo this file exist? Where could we download it?\n. Thank you very much. This is really very appreciated.\n. Sorry for bump again, but there still are some not solved errors:\n- There's a new YouTubePartner.php file ( https://developers.google.com/youtube/partner/clientlib/Google-youtubePartner-v1-20140110-php-1.0.0-alpha.zip ) but it isn't on this GitHub repository yet.\n- The code on https://developers.google.com/youtube/partner/code_samples/php#uploading_a_new_reference__so_youtube_can_automatically_generate_claims_for_newly_uploaded_videos_on_behalf_of_the_asset_s_owner still doesn't work.\nCould you please help us on this?\nThanks in advance for your time.\n. Ok, perfect.\nYes, we're waiting for an answer to continue our development, because there's a real mistake and nobody says anything for five days...\nCould you please tell anybody to help us and correct the error on that example on developer's web?\nThank you very much for your time and concern.\n. It works! Thank you for clean us up the way. We already are moving forward full throttle on connection developing.\nTHANKS! :+1: \n. ",
    "danieldou": "Could anybody solve this BIG problem? Does anybody notice that a code on Google Developers site actually doesn't work at all?\nAny of the solutions we got aren't working:\n- This code isn't working (release from 1 month ago, suggested before): https://github.com/google/google-api-php-client/commit/a23485a2b42cef7f9e4ebd62a1ee6466ef070515\n- Neither this (actual beta release): https://github.com/google/google-api-php-client/tree/v1.0.1-beta\n- Nor actual master release\nIn ALL of them, the file YouTubePartner.php is missing.\nWe're really trying hard to make that code working, but we only get not working patches!!\nPlease, anybody could fix this code once and forever?\n. Could anybody solve this BIG problem? Does anybody notice that a code on Google Developers site actually doesn't work at all?\nAny of the solutions we got aren't working:\n- This code isn't working (release from 1 month ago, suggested before): https://github.com/google/google-api-php-client/commit/a23485a2b42cef7f9e4ebd62a1ee6466ef070515\n- Neither this (actual beta release): https://github.com/google/google-api-php-client/tree/v1.0.1-beta\n- Nor actual master release\nIn ALL of them, the file YouTubePartner.php is missing.\nWe're really trying hard to make that code working, but we only get not working patches!!\nPlease, anybody could fix this code once and forever?\n. Ok, I really hope that someone put the right code wherever it has to be.\nSo, where's the place to get the right code? Could you point us to there?\nThanks for your time!\n. @iulukaya Ibrahim, could you please read upper and figure out that YOU are the author of those codes and they're NOT WORKING?\n@ianbarber Ian, we ask there twice ( http://stackoverflow.com/questions/21278909/example-code-not-working-on-php-developers-site/21329792#21329792 and http://stackoverflow.com/questions/21024694/youtubepartner-php-not-found?rq=1 ) and we only get patches and 'solutions'  from Ibrahim that aren't working. We told him, but he never answer back with a real working solution.\nWe also ask here twice with no solution.\nI would be a little worried if I'd see my code not working on a official Google site... Is there anybody responsible for that?\nIs there anybody able to fix it?\n. We're happy to see that you're now trying to work it out. Please, tell us if and how could we help you.\nThanks for your time.\n. We'll test it and tell you. If that's true, it would also fix #39 and answer questions on stackoverflow http://stackoverflow.com/questions/21024694/youtubepartner-php-not-found and http://stackoverflow.com/questions/21278909/example-code-not-working-on-php-developers-site \n. IT WORKS!!! FINALLY!\nThanks a lot for your time. It's really amazing see that all the work is really coming to a good end.\nWorks with server authentication (refresh token), but with a previous manual user login. When do you plan that server authentication works alone without manual login be released?\nBTW, the example rules ok, as well.\nThank you!!\n. ",
    "alexandria757": "YouTubePartner.php is part of the Content ID API Client Libraries.\nhttps://developers.google.com/youtube/partner/client_libraries\nIt's not currently included in the Google API PHP Client Libraries. \nThere is a also a composer ready version of it created by another developer on github and packagist.org.. ",
    "hackzilla": "You need to create a service auth.\nThis how I do it in symfony:\n```\n        $client = new \\Google_Client();\n        $client->setApplicationName(\"Google Analytics PHP Starter Application\");\n    $loginDetails = $this->getContainer()->getParameter('medusa.login_details');\n    $googleLoginDetails = $loginDetails['google'];\n\n    $client_id = $googleLoginDetails['username'] . '.apps.googleusercontent.com';\n    $service_account_name = $googleLoginDetails['username'] . '@developer.gserviceaccount.com';\n    $keyfile = $this->getContainer()->get('kernel')->getRootDir() . '/config/google-api-privatekey.p12';\n    $client_secret = $googleLoginDetails['password'];\n\n    $client->setClientSecret($client_secret);\n\n    $client->setAssertionCredentials(\n            new \\Google_Auth_AssertionCredentials(\n            $service_account_name, array('https://www.googleapis.com/auth/analytics'), \\file_get_contents($keyfile)\n            )\n    );\n\n    // Get this from the Google Console, API Access page\n    $client->setClientId($client_id);\n    $client->setAccessType('offline_access');\n\n```\n. :+1: \n. ",
    "jshado1": "It works until I try to do something with the service, like $service->calendarList->listCalendarList(), and then I get\n\nUncaught exception 'Google_Auth_Exception' with message 'Error refreshing the OAuth2 token, message: '{ \"error\" : \"invalid_grant\" }''\n\nI added\n``` php\n// \u2026\n// redirectUri = 'http://localhost/api/index.php/calendar'\n$client->setAssertionCredentials(\n    new \\Google_Auth_AssertionCredentials(\n          '\u2026@developer.gserviceaccount.com'\n        , array('https://www.googleapis.com/auth/calendar')\n        , \\file_get_contents('key.p12',FILE_USE_INCLUDE_PATH)\n    )\n);\n$client->setScopes('calendar');\n// \u2026\n```\nI see on this SO response:\n\n[\u2026] You'd also have to add this user to the google analytics account that you're planning to access.\n\nI'm not sure what that means.\n. ",
    "ixpack": "Hi Ian.\nMy machine: Windows 8.1, Apache 2.4.7, PHP 5.5.8, ZF2, UTF8... Chrome 32.0.1700.76\nI found out that the first call works ok. Problem might exist with cache?\nHere is a part from the cached file: \n;s:18:\" * responseHeaders\";a:12:{s:7:\"expires\";s:29:\"Tue, 28 Jan 2014 09:20:52 GMT\";s:4:\"date\";s:29:\"Tue, 28 Jan 2014 09:20:52 GMT\";s:13:\"cache-control\";s:49:\"private, max-age=0, must-revalidate, no-transform\";s:4:\"etag\";s:57:\"\"RVZ_f1bhF-19rh4H4M0uhzoFng/nmUOWOzvANDLJSSk2MKxauuapmU\"\";s:12:\"content-type\";s:31:\"application/json; charset=UTF-8\";s:16:\"content-encoding\";s:4:\"gzip\";s:22:\"x-content-type-options\";s:7:\"nosniff\";s:15:\"x-frame-options\";s:10:\"SAMEORIGIN\";s:16:\"x-xss-protection\";s:13:\"1; mode=block\";s:14:\"content-length\";s:4:\"1598\";s:6:\"server\";s:3:\"GSE\";s:18:\"alternate-protocol\";s:8:\"443:quic\";}s:15:\" * responseBody\";\nI'm not sure but should \"\"RVZ_f1bhF-19rh4H4M0uhzoFng/nmUOWOzvANDLJSSk2MKxauuapmU\"\" look more like \"\\\"RVZ_f1bhF-19rh4H4M0uhzoFng/nmUOWOzvANDLJSSk2MKxauuapmU\\\"\" ?\netags per each item is ok.\nCheers,\nDarius.\n. ",
    "413xl": "My question is, how to get the reseller service to work with the sandbox environment Google provides. It works fine in the production environment, but with the sandbox I get a http 500 code for every request I make (see top of my last post).\n. ",
    "neilcrookes": "Using \n$client->setClassConfig('Google_Http_Request', 'disable_gzip', true);\nBefore the upload brings the upload time for an 11Mb file down to about 30 seconds for me, so it's clearly something to do with gzip. Perhaps just on my setup?\n. Now, even though I'm using \n$client->setClassConfig('Google_Http_Request', 'disable_gzip', true);\nIt's taking ages to complete the upload. An 11mb file has been uploading for 40 minutes from my local machine so far, and it still hasn't finished. The script is in the file_get_contents() call at line 111 in IO/Stream.php again.\nThe app this is getting used in is supposed to be going live in less than 2 hours, so any advice on things to try to speed this up would be very gratefully received.\n. @ithinkihaveacat I've googled whether YouTube uploads could be throttled and not found anything about that. However, I have just signed in youtube using the account I am trying to upload to through the API and tried to upload through a browser as you suggested and it's taking a very long time. Is this YouTube not liking this account or something? I have been doing quite a few tests I suppose.\n. I've also signed in through youtube.com using a different account and tried to upload a video through there, and again, it's taking ages. I wonder if YouTube throttles frequent uploads from the same IP address. Googling doesn't throw anything up. I guess the upshot of this is that it's unlikely an issue with the library. The only thing that could be an issue that I thought of, was, from reading around about \"file_get_contents upload slow\" as @ithinkihaveacat suggested, a lot of people mentioned that slowness could be caused by the http keep-alive / connection close setting that can be set in the options for the stream passed to file_get_contents? Since I've been doing quite a few tests, could it be that Youtube's upload servers are keeping connections open to my machine longer than necessary because the requests coming from my machine, made using the php client library, are not telling Youtube's upload servers to close them? And since they think there are still several connections open to my IP address, they throttle the incoming bandwidth on new connections? What do you think @ianbarber? \n. ",
    "ithinkihaveacat": "I wonder if this is actually due to the script itself, or something else. Could YouTube uploads be throttled, for example? (Can you try uploading directly from a browser, using the same IP address? Or just try running the script from somewhere else.) Can you inspect the upload process itself, so see if anything looks odd? (CPU/memory usage might suggest something, but IO wait and others might also be useful if you can get it.)\nGoogling for file_get_contents upload slow and similar produces some voodoo solutions that might also help.\n. @Nyholm Are you working on better hhvm support? Unless I'm reading it incorrectly, hhvm builds seem to fail pretty much immediately at the moment (example). (Glad to have 5.6 support added though.)\n. Wonderful, thanks!\n. For what it's worth, Symfony doesn't try to evade that \"timezone not set\" warning\u2014the installer checks that the timezone is legit, but it doesn't try to distinguish a default UTC from an explicit UTC. Drupal doesn't seem to worry about it either.\n(Also, whatever reason there was for adding those lines in the first place, removing them doesn't break any tests.)\n. ",
    "acpadhi": "Check this out.\nThe reason for slowness can be precisely this : \nhttps://github.com/google/google-api-php-client/issues/59\n. google-api-php-client-1.0.0-alpha  does not have this problem. Upload Traffic Size is almost equal to file size.\nSo some issue cropped up after the gzip stuff was added\n. ",
    "mak-ru": "ok\n. ",
    "ulukaya": "If you go to the developer page, you'll see the content Id library binding. https://developers.google.com/youtube/partner/client_libraries\nYouTubePArtner.php in https://developers.google.com/youtube/partner/clientlib/Google-youtubePartner-v1-20140110-php-1.0.0-alpha.zip\n. Hi Ian,\nCode was working earlier and it still works for me with the version cuts I have. I believe \"not stripping nulls\" bug repeated later again with recent changes.\n. Reproduced the error, it's the same as previous bug.\nI'll try to create it on a public API for tests\n. Yes, verified that Ian's fix solves the problem.\nIf you need the fix immediately, you can use his branch.\nhttps://github.com/ianbarber/google-api-php-client\n. ",
    "PabloVallejo": "Thanks @silvolu, I signed the Google Individual Contributor License Agreement yesterday. I hope to get a response soon.\n. The CLA will certainly be useful for me, Thank @silvolu\n. ",
    "cartland": "Yes, I think it should return 200. In practice, this code fails.\n$app->get('/disconnect', function (Request $request) use ($app) {\n  $token = $request->get('token');\n  $success = $app['client']->revokeToken($token);\n  if (!$success) {\n    return $app->json('Could not revoke token.', 500);\n  }\n  return $app->json('Successfully disconnected.', 200);\n});\n$app[client'] is the Google_Client object. The tokeninfo response shows that I start with a valid token, and then it becomes invalid after executing revokeToken($token).\nGET https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=ya29.1.AADtN_V473gqkjknPurxjQhOxs1LtwmFPUqNW7q-scEK5UBB0U6uQRsWD5opOdCi\n{\n  issued_to: \"MY_CLIENT_ID.apps.googleusercontent.com\",\n  audience: \"MY_CLIENT_ID.apps.googleusercontent.com\",\n  user_id: \"111661289724043424828\",\n  scope: \"https://www.googleapis.com/auth/plus.login https://www.googleapis.com/auth/plus.moments.write https://www.googleapis.com/auth/plus.me https://www.googleapis.com/auth/plus.profile.agerange.read https://www.googleapis.com/auth/plus.profile.language.read https://www.googleapis.com/auth/plus.circles.members.read\",\n  expires_in: 3581,\n  access_type: \"offline\"\n}\nGET /disconnect?token=ya29.1.AADtN_V473gqkjknPurxjQhOxs1LtwmFPUqNW7q-scEK5UBB0U6uQRsWD5opOdCiya29.1.AADtN_V473gqkjknPurxjQhOxs1LtwmFPUqNW7q-scEK5UBB0U6uQRsWD5opOdCi\n\"Could not revoke token.\"\nGET https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=ya29.1.AADtN_V473gqkjknPurxjQhOxs1LtwmFPUqNW7q-scEK5UBB0U6uQRsWD5opOdCi\n{\n  error: \"invalid_token\"\n}\nDigging deeper:\nhttps://github.com/google/google-api-php-client/blob/master/src/Google/IO/Stream.php#L121\n$respHttpCode = $this->getHttpResponseCode($http_response_header);\n$respHttpCode is 'UNKNOWN' because $http_response_header is NULL.\n. ",
    "AdamWill": "I'm seeing something very like this with ownCloud's Google Drive support (which I'm still working to get ported to 1.x). It's using extremely simple upload code, ripped straight from the examples:\npublic function writeBack($tmpFile) {\n    if (isset(self::$tempFiles[$tmpFile])) {\n        $path = self::$tempFiles[$tmpFile];\n        $parentFolder = $this->getDriveFile(dirname($path));\n        if ($parentFolder) {\n            // TODO Research resumable upload\n            $mimetype = \\OC_Helper::getMimeType($tmpFile);\n            $data = file_get_contents($tmpFile);\n            $params = array(\n                'data' => $data,\n                'mimeType' => $mimetype,\n                'uploadType' => 'media'\n            );\n            $result = false;\n            if ($this->file_exists($path)) {\n                $file = $this->getDriveFile($path);\n                $result = $this->service->files->update($file->getId(), $file, $params);\n            } else {\n                $file = new \\Google_Service_Drive_DriveFile();\n                $file->setTitle(basename($path));\n                $file->setMimeType($mimetype);\n                $parent = new \\Google_Service_Drive_ParentReference();\n                $parent->setId($parentFolder->getId());\n                $file->setParents(array($parent));\n                $result = $this->service->files->insert($file, $params);\n            }\n            if ($result) {\n                $this->setDriveFile($path, $result);\n            }\n        }\n        unlink($tmpFile);\n    }\n}\nand I'm currently testing with version 1.0.6 of the library. But I seem to be seeing just the same issue as the OP here - uploading a simple ~4MB file results in over 100MB of traffic. Any ideas?\n. Ah. I think the fix for this may have only fixed it for use of the Google_Http_MediaFileUpload class, not the simple files->insert method. Let me see if my theory holds up.\n. Hum. Actually, I think I was using a packaged copy of 1.0.3 I had lying around and somehow with 1.0.6 the problem doesn't happen any more, though I can't clearly see why it would affect 1.0.3 but not 1.0.6. But hey, so long as it works...hey ho.\nAha! So I think I'm not hitting it in 1.0.6 because it's using Curl instead of Stream and bypassing the whole thing. If I force use of Stream instead of Curl, I can cause it to happen again.\nIn MediaFileUpload.php , the bit where it conditionally disables gzip for uploads is only in nextChunk(), which is only used for resumable uploads. I've tried copying it into process() (with the obvious change to $this->request instead of  $httpRequest), and the code gets hit (I put a debug log in to check), but it doesn't seem to do the job - the amount of data transferred is still huge. But if I disable gzip with the big hammer - $client->setClassConfig(\"Google_Http_Request\", \"disable_gzip\", true); - that does solve the problem. Not quite sure why just trying to disable it in process() doesn't work.\n. Did the default access type also change? 0.6 explicitly states the default is offline, but 1.0 doesn't say either way. When I logged back into my test OwnCloud instance that's migrated to 1.x, I was getting the \"The OAuth 2.0 access token has expired, and a refresh token is not available. Refresh tokens are not returned for responses that were auto-approved.\" error, which I think may be caused by the access type being online. I'm testing with it explicitly set to offline ATM.\n. It is indeed odd, in fact odder than you think. I'm finding it very difficult to track down exactly where the behaviour comes from.\nI can't find any kind of patch to Fedora's PHP package, or change to the default php.ini, which would cause this. php.ini has a setting for the separator value - arg_separator.output - but that does not get set in upstream's default php.ini (it has a commented-out example of setting it, note) or Fedora's, either Fedora's stock config or my active config.\nIf I do phpinfo() on my server, the value of that setting is shown as &, but of course it's hard to trust that, since I'm looking at it in a web browser, and this whole thing is about HTML entities =)\nI've found several other cases of people referencing this problem:\nhttps://github.com/ppetermann/pheal/issues/28\nhttp://ca3.php.net/manual/en/function.http-build-query.php#96692\nhttp://ca3.php.net/manual/en/function.http-build-query.php#102324\nhttps://github.com/glamorous/TMDb-PHP-API/issues/9\nand more, so it's definitely not just me, and I've seen a comment that Windows PHP installs set the value to escaped & by default (though of course I don't know whether that commenter is correct). But it does seem rather difficult to pin down - I'm not sure whether it's as simple as 'all recent PHP installations will output strings with escaped & as the separator', but it does at least seem clear that some - and not just mine :) - do.\n. Aha, got it! It's OwnCloud's fault after all:\n/usr/share/owncloud/lib/base.php:               ini_set('arg_separator.output', '&amp;');\nstill, probably a good idea for this function to explicitly set the separator, since it's kind of a 'closed loop': I don't think I can see a case where you'd actually want a function explicitly designed to return an auth URL for Google's OAuth server to respect the configuration setting for the separator.\n. Thanks! I guess we can close this then.\n. There may be multiple factors, but it certainly seems like doing setAccessType('offline') is enough to make it 'behave' here. I definitely get a token with refresh_token by doing that.\nInterestingly, it seems like the access token never actually expires when you set the offline access type, or at least it certainly doesn't expire in an hour like the expires_in value suggests it should. I stuffed a couple of debug logs into my instance to just print out the access token, the expires_in value and the created value, and expires_in never seems to change from 3600, the access token itself never seems to change, and the created time never seems to change. Even when I logged out of my OC server, went to bed, woke up the next morning and logged back in, I have the same access token and same 'issued' timestamp.\nBut it certainly works, whereas if I have the token issued in 'online' mode, I reliably hit the \"The OAuth 2.0 access token has expired, and a refresh token is not available. Refresh tokens are not returned for responses that were auto-approved.\" error one hour after the token is initially issued.\n. Huh, funny. Does your expires_in value change? Mine never seems to. I'm happy that it's working, but it irks me that I don't know what's going on with the expiry thing, heh.\n. ah, so it's just a value, not a counter. makes sense.\nthe php lib actually goes and refreshes the access_token for you if it's expired and you have a refresh token, you don't have to do anything. See the sign() function in OAuth2.php - I just wanted to see the mechanism working. I guess the 'issued' could be the date the whole token was initially issued, but it doesn't explain why the access_token value never seems to change for me. Oh, well. :)\n. @silvolu I understand the mechanism in theory, what confuses me a little is that if I watch all the values in the $token array (by having some debug code print them out every time I access the Drive), they never seem to change. It all works, so it's not critical, it's just that I'd expect the access_token value to change every hour as it gets 'transparently' refreshed, but it doesn't seem to.\n. also, given that the lib is basically PSR-0 compliant except for (for some weird reason) classes with a classpath depth of more than 3, wouldn't it be easier to just fix those and declare the lib PSR-0 in composer.json ? is there some reason they can't be changed?\n. @whatthejeff classmap is no use for distributions / systemwide installation. it generates a hardcoded map at the time the lib is pulled into a project which is only ever valid in relation to that project's tree.\nif the lib was made fully PSR-0 compliant distributions could ship it in /usr/share/php/Google and it would autoload automatically for anything. we can work fine with the autoloader, it just seems like unnecessary effort for upstream, but a classmap is no use at all. (I work on Fedora; I package ownCloud, which depends on the Google lib. my basic interest in this is to have Fedora's ownCloud package use Fedora's systemwide php-google-apiclient rather than its own bundled copy).\n. @whatthejeff \"old\"? The autoloader was only added in 1.1. I'll take a look at the examples tomorrow, I actually just ran a sed on the whole tree but maybe I did it from src/ instead of toplevel.\n. er, I'm a bit confused. how do you mean it 'ships two autoloaders'? The only autoloader I see in the source tree is this one. Are you maybe talking about this bit in composer.json:\n\"autoload\": {\n    \"classmap\": [\n        \"src/\"\n? that's a configuration for composer's autoloader, when the library is pulled into a project by composer. The composer autoloader isn't included in the Google lib's tree. If you mean 'maybe this lib should give up shipping an autoloader and just rely on composer's autoloader with the classmap declaration', sure, I see where you're coming from, though it kind of stinks for distributions (basically for a distribution the only thing we can possibly do with libs which rely on Composer classmaps is symlink the systemwide copy into each project's tree, which is just icky, or do horrible things to the composer autoloader in the project packages, which is probably worse).\n. @whatthejeff Also note this bit from the README:\n\"Why do you still support 5.2?\nWhen we started working on the 1.0.0 branch we knew there were several fundamental issues to fix with the 0.6 releases of the library. At that time we looked at the usage of the library, and other related projects, and determined that there was still a large and active base of PHP 5.2 installs. You can see this in statistics such as the PHP versions chart in the WordPress stats: http://wordpress.org/about/stats/. We will keep looking at the types of usage we see, and try to take advantage of newer PHP features where possible.\"\n. Maybe I'm just being dumb, but I'm not clear on what you're calling \"the former autoloader\" and \"the new autoloader\". I only see one autoloader in the library source, the one that was added in 1.1. Where's the other one?\n. ooooh, I see. I was being dumb. I wasn't grokking that what you were saying was predicated on my change. gotcha. =) sure, that works for me. i'll revise it tomorrow. thanks for the idea.\n. OK, how's that? Wasn't quite sure about the wording of the error (and the specific version numbers), I figure this should be about right, though. I fixed the paths in examples/ (thanks for spotting that) and squashed all the changes into one commit.\n. Thanks again, just tweaked that so it should throw an E_USER_WARNING instead if E_USER_DEPRECATED isn't available - untested as I don't have a PHP 5.2 system handy, but it should be right!\n. I don't know if it'd be OK for me to sign that, or if my employer has a corporate agreement, and I doubt I can get a reply from my employer very quick as everyone's on holiday break.\nCan you use it if I place it under a sufficiently permissive license? ownCloud requires people to either sign their CLA or place the code under MIT license, for instance. I am happy to stick it under as permissive a license as you'd need for your purposes, up to and including the WTFPL...I'm doing this on my own time, so it's my code.\n. \"On the off chance I had a check, but didn't get a hit on owncloud on the corp signers list. \"\nI don't work for ownCloud, I work for Red Hat (I package ownCloud for Fedora as a side project). I'm trying to find out if RH legal has an opinion on the individual CLA and/or we have any corporate agreement ATM.\n. @glensc AIUI, the require_once are there for backwards compatibility, to make existing projects (which directly require the files they need, as was previously the only option) keep working with the new version.\n. Sorry, still didn't hear back from the right person - I'm gonna give it a day or two then just go ahead and sign the personla version.\n. I signed the individual CLA today, sorry for the delay!\n. fwiw the composer 'files' thing is kind of a PITA for distributions too - again, the way it's implemented is basically hardcoded and takes no account of systemwide installation. it writes a file (vendordir/composer/autoload_files.php) with an array of files whose paths are relative to the location of that file, and then requires every file in the array on every call to the composer autoloader.\nso once again all a distribution can do if it wants to provide a system-wide copy of a lib that uses the 'files' mechanism and then package things that pull that lib in via composer is symlink all the listed 'files' into the trees of all the packages (or patch the package's copy of the composer autoloader, probably by changing the locations in autoload_files.php). but it seems the PHP world is not really interested in distributions and systemwide libraries these days :/\n. I think it's OK to not list an autoload mechanism at all, isn't it? I mean, I'm not necessarily arguing for it, just saying I think it's a permitted option.\n. @whatthejeff that happens to be exactly owncloud's situation, in fact - it uses composer for the 'core' top-level 3rdparty/ directory, but the google lib is included by an 'application' and not managed by composer.\n. good point, thanks.\n. ",
    "velosipedist": "Composer can autoload through classmap https://getcomposer.org/doc/04-schema.md#classmap\n. +1\n. ",
    "Nyholm": "Sweet. I didn't know composer added each class in the autoload_classmap.php when you used the classmap property. \n. Im not ATM. But you are correct. The Travis tests fails immediately. I'll try to make sure we can run the tests.\nJust created #244 \n. @ithinkihaveacat @silvolu I've updated the tests and .travis.yml. The tests are now passing on HHVM\n. AccessToken: Fair enough. \nGuzzle. Please take a moment and reconsider. I understand from your answer that you have not looked into PHP-HTTP. \nFirst of, the solution suggested in #720 is wrong. Don't do that. It is insane that every package should make adapters for Guzzle5, Guzzle6, Buzz, Sockets etc etc. \nI'm telling you to make this library independent from all of these HTTP adapters. Yes, it might be a BC break but that's okey since it is a new major version. \nI am happy to help implementing PHP-HTTP if you want to. \n. Sorry for the terminology missmatch. \n720 suggest to do what AWS has done. They have created adapters (GuzzleHandler) for Guzzle5 and Guzzle6. It is a good pattern to do so. The problem is when you take this to a larger scale. AWS has two adapters, we have two adapters, package Foo has some adapters, package Bar has some more adapters.. Eventually there are a lot of different adapters, right?\nPHP-HTTP is a set of packages that gathers all of these adapters. They are actually the next version of Ivory Http Adaper. \nImplementing PHP-HTTP, then we don't have to implement our own Guzzle5Handler or Guzzle6Handler. Every user of Google API client may choose for which transport library he/she want to use. \nThe benefit of PHP-HTTP is that we do not have to bother with the transport anymore. We will not see issues like #720 when they ask us to implement a future Guzzle8 etc. We can also support users that can't install Guzzle5 because Guzzle6 is already installed. \n. Thank you for considering this. \nPHP-HTTP is under development and pieces are soon falling together for a stable release. I said the library is the next version of Ivory Http Adaper. It is pretty much Ivory but with PSR-7 (which we want to support). Here is the PSR-7 repo.\nYou can find the documentation for PHP-HTTP here: http://php-http.readthedocs.org/en/latest/\n(They just did a major update on the docs today)\n. Just let me know if you want any help implementing PHP-HTTP. I'm happy to contribute. \n. FYI, here is a implementation with PHP-HTTP for the LinkedIn library. The google library is far more complex but it just to give an example.\nhttps://github.com/Happyr/LinkedIn-API-client/blob/psr7/src/LinkedIn.php#L165\n``` composer.json\nrequire\": {\n        \"php\": \">=5.4\",\n        \"php-http/httplug\": \"@dev\",\n        \"php-http/client-implementation\": \"@dev\",\n        \"php-http/discovery\": \"@dev\"\n    },\n    \"require-dev\": {\n        \"php-http/guzzle6-adapter\": \"@dev\",\n    },\n```\n. @bshaffer and @dwsupplee Im currently active in an other open source project where the following argument came up: \n\nI used [Guzzle] 5.2 since google/apiclient requires it.\n\nPeople are adapting after you and using old version of Guzzle just to be compatible to you. That open source project could not update to Guzzle 6 because of a dependency to google/apiclient. This is the reason why you should not be dependent to any implementation. Please consider PHP-HTTP as a third option. \n. > First, I agree in order for this library to be useful and stay current with the PHP community, we will need to adopt PSR-7\nGreat\n\nSecond, v1.x is the currently supported version, and does not require guzzle as a dependency, so if anyone has major conflicts with this library, they should be using that version.\n\nThat's good. But let's focus on version 2 for now. \n\nLast, please understand PSR-7 had not been released at the time this library and its dependencies were under development. In addition, PSR-7 asks quite a bit out of libraries in order to adopt it. Decisions were made in PSR-7 to prioritize certain ideals over driving adoption in the community. Some popular PHP libraries have no plans to adopt PSR-7 in their core (I am referring primarily to Symfony and Symfony components). If it was easy to refactor this library for PSR-7, we would have done it by now, but it will require quite a bit of active development to do so. I do not think using PHP-HTTP is an exception to this.\n\nYou are actually wrong. Symfony has support for PSR-7 by a bridge. They (or we) take BC really seriously and it was too late to deprecate the HttpFoundation by the time PSR-7 was voted yes. I have not heard any discussions about not supporting PSR7 in sf4. Yes, sf3 is just about to be released and it is a long time until sf4.0. Anyhow, that is off topic for the discussion...\nThe fact is that PSR-7 is the standard way of doing HTTP messaging in PHP and PHP-HTTP is soon the library that help you to become independent of any transport library like Buzz, Guzzle, Goutte, socket, cURL etc etc. \nThe question is: Does this widely used library created by very skilled developer form Google be among the first to adopt the standards and show the community how thing should be done properly? Or do you want to build more legacy code and push that problem into the future?\nLike I've said before: I'm more than happy to help implementing PSR-7 and PHP-HTTP if you want to. \n. Great. \nPSR-7 is only interfaces. You need an implementation of that interface. One could use Guzzle's implementation of http://docs.guzzlephp.org/en/latest/psr7.html\nOnce we have a PSR-7 Request object we could send it with \nHttpClientDiscovery::find()->sendRequest($request);\nI'll look in to the branch you linked. \n. I've sent you a PR to https://github.com/google/google-auth-library-php. There are some TODO's left but al lot of the work is done... \nAnd of course to make sure the tests runs =)\n. I have a PR om mailgun/mailgun-php to remove the dependency on Guzzle. It is just waiting on php-http/httplug to become stable. \n. This does not support Windows systems. They use '\\' instead of '/'. \nI suggest to change to something like: \n``` php\nprivate function getCacheDir($file, $forWrite)\n{\n  // use the first 2 characters of the hash as a directory prefix\n  // this should prevent slowdowns due to huge directory listings\n  // and thus give some basic amount of scalability\n  $storageDir = rtrim($this->path, DIRECTORY_SEPARATOR) . DIRECTORY_SEPARATOR . substr(md5($file), 0, 2);\n// ...\n```\n. Okey. Thank you for the link. I did not know that. \n\nOn 20 Nov 2015, at 18:13, Brent Shaffer notifications@github.com wrote:\nWindows has accepted the forward slash since Windowns NT. But I do like your solution better.\n\u2014\nReply to this email directly or view it on GitHub.\n. :+1: \n. Okey. I see. Thank you for quick feedback. \n. \n",
    "Hukuta": "Did you restart the server after editing php.ini?\nWhat API do you using? \n. ",
    "eresende": "Hello Ian\nMy pleasure to help out.\nI signed the individual CLA electronically on the same day I made the pull\nrequest.\nDidn't get any email so far. How can I confirm this?\nThanks.\nEusebio Resende\n(eresende2k@gmail.com)\n2014-01-29 Ian Barber notifications@github.com\n\nThanks! Would you mind signing the Google CLA, then we can get this\nmerged: (see\nhttps://developers.google.com/api-client-library/php/contribute for\nmore). The individual CLA is at:\nhttp://code.google.com/legal/individual-cla-v1.0.html (you can submit in\nthe form at the bottom).\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/google/google-api-php-client/pull/64#issuecomment-33598647\n.\n. \n",
    "jsor": "I found this issue which looks like the same problem: https://code.google.com/p/gdata-issues/issues/detail?id=4861\n. ",
    "samisalow": "I have the same problem, could you tell me if the problem is resolved?\n. help me please\n. ",
    "dmyers": ":+1:\nThis would be very helpful.\n. What is the purpose of having the package refresh the token? Can we currently detect the change and store it?\n. ",
    "pgrosu": "Here is something from the Java implementation taken from ExponentialBackOff.java, in case it might help:\n```\n/\n * Implementation of {@link BackOff} that increases the back off period for each retry attempt using\n * a randomization function that grows exponentially.\n \n * \n * {@link #nextBackOffMillis()} is calculated using the following formula:\n * \n\n * \n   randomized_interval =\n       retry_interval * (random value in range [1 - randomization_factor, 1 + randomization_factor])\n * \n\n * \n * In other words {@link #nextBackOffMillis()} will range between the randomization factor\n * percentage below and above the retry interval. For example, using 2 seconds as the base retry\n * interval and 0.5 as the randomization factor, the actual back off period used in the next retry\n * attempt will be between 1 and 3 seconds.\n * \n\n * \n * Note: max_interval caps the retry_interval and not the randomized_interval.\n * \n\n * \n * If the time elapsed since an {@link ExponentialBackOff} instance is created goes past the\n * max_elapsed_time then the method {@link #nextBackOffMillis()} starts returning\n * {@link BackOff#STOP}. The elapsed time can be reset by calling {@link #reset()}.\n * \n\n * \n * Example: The default retry_interval is .5 seconds, default randomization_factor is 0.5, default\n * multiplier is 1.5 and the default max_interval is 1 minute. For 10 tries the sequence will be\n * (values in seconds) and assuming we go over the max_elapsed_time on the 10th try:\n * \n *\n * \n   request#     retry_interval     randomized_interval\n1             0.5                [0.25,   0.75]\n   2             0.75               [0.375,  1.125]\n   3             1.125              [0.562,  1.687]\n   4             1.687              [0.8435, 2.53]\n   5             2.53               [1.265,  3.795]\n   6             3.795              [1.897,  5.692]\n   7             5.692              [2.846,  8.538]\n   8             8.538              [4.269, 12.807]\n   9            12.807              [6.403, 19.210]\n   10           19.210              {@link BackOffPolicy#STOP}\n * \n\n * \n * Implementation is not thread-safe.\n * \n\n * @since 1.15\n * @author Ravi Mistry\n */\n```\nHope it helps,\nPaul\n. ",
    "glen-84": "Please re-open this issue.\n. Okay, thanks.\n. ",
    "bshaffer": "@glen-84 the latest version of this library uses Guzzle5, and may work well with this plugin\n. @kbond glad to hear you were able to get this resolved.\n. @NeoCsatornaja This repository is for PHP, so it is not relevant to your SO question.\n. Thank you for your comment. Yes, approval_prompt=force is not encouraged. But it is no longer necessary to do the check you have above.\nThe authorize method checks if the refresh token exists. The developer just needs to make sure when they pass in an access token, it includes the refresh token.\nThe sample you are linking to is referring to v1 of this library, and will be updated very soon. It would be great to get your feedback on it!\n. please see #905\n. Yep! This is available via Google_Client::setTokenCallback.\n. Closing this. Google_Client has a setTokenCallback method that can be used to handle this situation. Also, the Cache class can be customized by anything implementing the PSR-6 standard.. it should be \nphp\nif (isset($_GET['code'])) {\n    $client->authenticate($_GET['code']);\n. @tmatsuo People are finding it and voting on it here, so I'm ok with leaving it.. @viralpandya have you tried using the Google_Model::NULL_VALUE constant instead of PHP NULL? \nWhich version of this library are you using? (btw if you're using C#, as you seem to be indicating, this is not the right library. This is for PHP)\n. Sorry, we cannot help you with a C# problem here\n. FYI @SurferJeffAtGoogle @remi \n. This library is now PHP5.4  (whoopee!)\nOnce the master branch is stable enough to tag v2.0.0, We can look at upgrading to a namespaced version. Because of the sheer number of users, I wanted to do this in phases. But it is definitely on the roadmap, as I too cringe every time I type an underscore in the class name.\nThanks for your feedback and please continue to +1\n. Closing, as we've moved to PHP 5.4 (see composer.json)\n. @Kak3n if you are using v2, you would set them through the guzzle library. See this page for more info.\n. v2  is the current version, but the docs on developer.google.com have not been updated for them yet. If you are just starting your project, use v2\n. @tmatsuo google-api-php-client-services has been generated since this issue, so that is not the problem. I will look into it.. The issue seems to be that the API returns everything wrapped in a data property that isn't represented (as far as I can tell) in the Discovery Doc. In the meantime, I suggest using the google/cloud library for the Translate API:\n```php\nuse Google\\Cloud\\Translate\\TranslateClient;\n$translate = new TranslateClient();\n$result = $translate->translate($text, ['source' => 'es', 'target' => 'en']);\n``. @avinashseth you probably need to runcomposer installand then addrequire 'vendor/autoload.php';tosignin.php. Have you tried following the instructions in the [README](https://github.com/google/google-api-php-client#composer)?\n. Yes, this is now called via [Google_Client::revokeToken](https://github.com/google/google-api-php-client/blob/master/src/Google/Client.php#L676), which accepts either way above.. We have merged in a fix for this, andmasteris now usingpubsub:v1`\nPlease update the library and confirm this fixes your problem. Thank you!\n. I do not have the ability to tag this repo, unfortunately. @tbetbetbe are you the one to do this?\n. @hashtag-framework Yes, try with v2.0.0-RC2, but keep in mind there are some differences between the libraries that might require you to refactor your code.\n. this was fixed in #631\n. this is strange, I would expect the permissions to be set by the web server.\nIf you're executing a script, just specify a cache directory with proper permissions (i.e. an an existing directory with a group permission that includes both users).\n. I'm not sure it's in the manual. But yeah you can do this:\nphp\n$client = new Google_Client();\n$client->setCache(new Google_Cache_File('/path/to/shared/cache'));\n. @betollaque what version of the library are you using? I imagine this is a permissions issue, and the web server does not have permissions to write to the temp directory. Try fixing the permissions or setting the cache to something else:\nphp\n$client->setCache(new Google_Cache_Memcache);\n. Glad to hear it!\n. This is no longer valid as v1-master is no longer maintained.. I would love to move the non-generated parts of the library onto PSR-1 and 2 code standards. However, we are merging v2-dev into master for the 2.0 release, and changing this now would be only make the merge process difficult and the diffs harder to read.\nWe will now track this task in #692 \n. This was added to google-cloud-php! Check out the documentation here:\n```php\nrequire 'vendor/autoload.php';\nuse Google\\Cloud\\Storage\\StorageClient;\n$storage = new StorageClient([\n    'projectId' => 'my_project'\n]);\n$storage->registerStreamWrapper();\n$contents = file_get_contents('gs://my_bucket/file_backup.txt');\n``\n. because of the larger changes for2.0, this task is now tracked in #692\n. It's possibly because you are still setting \"curl.cafile\" in your php.ini.\n. The Contacts API is unfortunately not a part of this library. To access it, see the [contacts API documentation](https://developers.google.com/google-apps/contacts/v3/). The examples do not currently support PHP. Sorry for the inconvenience.. Thanks for pointing these out! These have been fixed.. LGTM\n. This has been added for [Subscriptions](https://github.com/google/google-api-php-client-services/blob/master/src/Google/Service/Pubsub/Resource/ProjectsSubscriptions.php#L215) and [Topics](https://github.com/google/google-api-php-client-services/blob/master/src/Google/Service/Pubsub/Resource/ProjectsTopics.php#L142), but please see the official [Google Cloud PHP Pubsub](https://github.com/GoogleCloudPlatform/google-cloud-php-pubsub) client for calling the PubSub API!. This seems easily avoidable by setting the headers on the$requestobject rather than in theGoogle_Config` class.\nAlso, your PR should be rebased to a single commit.\nClosing this for now.\n. What do you mean exactly by \"code igniter fails\"? How does it fail?\nThis line of code, while silly, shouldn't cause any errors. As you said, it will always return true and so include the autoloader. I would expect it to be innocuous. \n. This file has been moved to examples/url-shortener.php and the conditional removed.. added in 7c191da\n. Yes! Check out examples/service-account.php. For saving/reusing, check out the Caching section of the README.. Yes! In the latest version this is now the default. See Authenticating with OAuth in the README:\nphp\n$client = new Google_Client();\n$client->setAuthConfig('/path/to/client_credentials.json');. fixed in a07f4584d92c47d9af52b35d4bb1a43c5e0ca51b\n. I would be interested to know if this happens with the newer version of the library, if anybody has time to test it.\n. Great news @mf01!\nI updated the master branch to use HTTP Streams instead of cURL on App Engine (see #715). I believe this has done the trick. @Abbe98 can you also confirm?\n. @Abbe98 composer is required in the new version, or you can download the release here and the vendor directory is included.\n. aha, this would be because the check $client->isAppEngine() does not return true for the dev appserver :anguished: \nYou can set the stream handler manually in the meantime.\n. This file has been removed in favor of composer autoloading, so this issue is no longer relevant.. This code ensured that TLSv1 is used, which is a good thing because SSLv3 is broken. \nSo I don't think the justification is there for this change. \n. These are good points. If you can rebase this PR to a single commit, I'll go ahead and merge it.\n. Whatever you did, you just added 3 more commits to this...\n. fixed in a07f4584d92c47d9af52b35d4bb1a43c5e0ca51b\n. Honestly, this is not a real issue that isn't worth fixing, as we have a major refactor coming in v2\n. These classes have been refactored in favor of google/auth. Please use v2 and see if your issue is resolved.. We believe this issue has now been fixed. Please open a new issue if this is not the case.. @jerjou\n. This is no longer relevant, as the IO classes were removed in v2.. added in https://github.com/google/google-api-php-client/pull/666\n. The PR of the Beast\n. The fix for this has been merged and tagged in 1.1.5\n. Fixed in #675. This is no longer relevant, as the Curl.php class has been removed in favor of guzzlehttp/guzzle. closing, didn't see #648\n. @ekr3peeK the method verifyIdToken does not appear to have any caching. Although you could add your own caching by saving the certificates to a local file and then pointing to them in the client config:\nphp\n$client->setClassConfig('Google_Auth_OAuth2', 'federated_signon_certs_url', '/path/to/certs.json');\nA better method would be to use the new google/auth library, and call the verifyIdToken method there without any arguments like this:\nphp\n$oauth = new Google\\Auth\\OAuth2(['id_token' => $idToken]);\n$payload = $oauth->verifyIdToken();\nWe are in the process of adding this functionality to the current library, but until then you'll have to use it separately.\n. @ekr3peeK what did you do to fix the problem? Also please close the issue if there is no work left to be done\n. This pull request violates our code standards for control structures. You need to add curly braces so the change looks like this:\nphp\nif ($postBody === false && $parameters['postBody'] !== false) {\n  throw new Google_Exception(\"JSON encoding failed. Ensure all strings in the request are UTF-8 encoded.\");\n}\n. added in 4b25c1504bbe0ebf5f61fb2a04dbf686cabf2712\n. @thatisuday this is following the PHP code standard PSR-0 (see the section \"Underscores in Namespaces and Class Names\")\nUse composer or just include the library's autoloader to your front controller or autoload script:\nphp\nrequire_once '/path/to/google-api-php-client/autoload.php';\n. This is an innocuous change, but also it's not going to really fix anything either (If someone included Client.php manually then this change would prevent a fatal error, but we don't want to encourage that behavior anyway)\n. @dmitrydymarchuk have you noticed you can specify chunk size in the constructor?\n. What is the use-case behind having to set a different chunkSize for each step?\n. Have you tested and verified that setting the chunk size in this way effectively alters the HTTP request to allow for the functionality you're describing?\n. Thank you for this PR! Please trim the whitespace and rebase to a single commit, and we should be good to go here.\n. @tillz you can close this PR. You should never submit PRs from your master branch anyway, but instead should create a feature branch and work off that.\nThe following should accomplish this:\n$ git remote add google git@github.com:google/google-api-php-client.git\n$ git checkout -b patch-1 google/master\n$ git cherry-pick f09b3d7\n$ git push origin patch-1\nThen you just need to submit a new PR from tillz/patch-1 to google/master\n. @tbetbetbe good call. Updated. Would you like me to update the commit message as well?\n. done\n. LGTM\n. I downloaded the file, cloned the repo, and the Google_Cache_File class was picked up by the autoloader just fine.\nIs it possible you've accidentally renamed that file or the class inside it?\n. How smart of it to do that :P\nOn Thu, Sep 17, 2015 at 5:04 AM T. Almroth notifications@github.com wrote:\n\nClosed #676 https://github.com/google/google-api-php-client/issues/676.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/676#event-412018187\n.\n. Can you post some of your code here so we can help you debug the issue? We have more than one API that uses getDownloadUrl\n. Something went wrong with the generator script here, I will look into it\n. as these have already been merged into master, we are good to go here on the authors. \n. @maury91 the method was previously private, so it's not possible for the change to break subclasses.\n. @tbetbetbe @surferjeffatgoogle @tmatsuo @silvolu \n. A fix for the broken tests can be found here\n. Closing, as the IO classes have been removed in favor of guzzlehttp/guzzle in v2. . What is the justification for this change? Can you explain why you'd like us to bump the PHPUnit version?\n. I agree that we would be better off on PHPUnit 4 (PHPUnit 5 requires php 5.5, so we can't hop on that quite yet).\n\nWe will integrate this change into v2-dev since that will be merged into master soon. Thanks for this!\n. Also incorporate PSR-4 by flattening the directory structure \n. @vsubramani\n. Thanks for tracking this down, submitting the PR, and providing all the documentation! It looks good.\nI've added some fixes. We also need to add tests. I can do both these things, but it's probably best if you do it since it's your PR.\n. added in 043fab574f4921e8693b60bb49d74e65de8e6b6b\n. see #697\n. see the simple-file-upload example for how to grant user-level permission and upload to your drive account.\nYou'll need to grant your app access to your user account using an OAuth2 authorization flow. Once you've done this, the application will be granted an access token and refresh token, and will be able to maintain access to your account using these.\n. Unfortunately, as this code is generated, your PR will just get overwritten the next time we update it.\nThanks for your contribution anyway! Hopefully this will bother you less, now that you've done all you can to fix it :)\n. see #704 and #705 - these are now updated for Compute API v1\nNote that master has changed significantly since #695, so you may want to update your library from v1-master instead. \n. You can authenticate using the google/auth library directly and call the APIs directly with HTTP. This library can only support one version of the APIs at a time, so we support the most recent stable version. \n. As of this morning, master represents v2 of this library, and Google_Auth_AssertionCredentials has been removed (see UPGRADING.md for more info).\nAre you following a blog/tutorial somewhere that we can update for the new version?\n. Can you link to your stack overflow post?\nIt's almost certainly because of this commit. Try rolling back to v1.1.5 and see if that fixes it\n. Have you verified your server can access the googleapis.com domain? You could be experiencing DNS issues or some network connectivity issue. From your server's shell, try running:\n1. nslookup googleapis.com\n2. ping googleapis.com\n3. telnet www.googleapis.com 443\n. The v2.0 version of this library uses guzzle under the hood, which may help resolve this.\n. start with just the script, as there are BC-breaking changes and so unless you have time to test, it won't be worth upgrading.\n. Unfortunately, since Guzzle 6 breaks all BC with Guzzle 5, this is not possible. \nI agree this is very restrictive... we can probably make the library compatible with ~5.0 but Guzzle 6 is a whole separate undertaking.\nIf you are unable to resolve this problem, update your composer to use Google API Client v1.1.6 or dev-v1-master\n. great fix! Thank you!\n. The 7th parameter to Google_Auth_AssertionCredentials is $useCache. This defaults to true. Try setting it to false, and the library will stop writing to a file.\nI imagine this is because you're running in a shared hosting environment, and the php.ini setting open_basedir is set, and the cache file is attempting to write outside the allowed path.  If you have access, you could also just disable open_basedir in your php.ini so that it is not in effect.\n. advantages: does not require curl.so, runs on appengine\ndisadvantages: ??\n. @tmatsuo yes, AppEngine supports cURL, but I was unable to get this library to work even so. I agree it would be better to fix the issue, but this is a good solution in the interim. \n. @LindaLawton yes, v2 (at the time of this writing) is at v2.0.0-RC1, so unless you specifically want to upgrade, I'd recommend using v1.1.6 of this library. The docs you've mentioned will be updated once v2 is stable (v2.0.0). \nAlso, I recommend using composer even for v1, so that your code does not update unexpectedly:\n\"google/apiclient\": \"~v1.1.6\"\n. @LindaLawton Composer will allow the code in your repository to represent only the \"pure code\" of your application, as I can only assume you're committing your dependent libraries directly into your repository. \nYou can instruct users to install your application using composer create-project rather than git clone so there are no extra steps. The community is very familiar with composer, so I doubt many would consider it overkill.\nEither way, Good luck!\n. The library is complaining that you need to provide a signing_key config\nparameter, have you tried this?\nMore instructions:\nhttps://developers.google.com/api-client-library/php/auth/service-accounts\nOn Wed, Oct 28, 2015 at 2:28 AM rahul9878 notifications@github.com wrote:\n\n$client->refreshTokenWithAssertion() is giving error.\nit gives following error\nPHP Fatal error: Uncaught exception 'LogicException' with message 'config\nparameter \"signing_key\" must be set to refresh a token with assertion' in\n/Users/CFADMIN/Work/googleanalytics/google-api-php-client/src/Google/Client.php:201\nStack trace:\n0\n/Users/CFADMIN/Work/googleanalytics/google-api-php-client/src/Google/Client.php(190):\nGoogle_Client->fetchAccessTokenWithAssertion()\n1 https://github.com/google/google-api-php-client/issues/1\n/Users/CFADMIN/Work/googleanalytics/HelloAnalytics.php(27):\nGoogle_Client->refreshTokenWithAssertion()\n2 https://github.com/google/google-api-php-client/pull/2\n/Users/CFADMIN/Work/googleanalytics/HelloAnalytics.php(101): getService()\n3 https://github.com/google/google-api-php-client/pull/3 {main}\ncan you please tell me why is giving error. and how to resolve this.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/717.\n. The other version has not been deprecated, v2 is not considered stable so the documentation has not been changed.  I suggest checking out the v1.1.6 tag of this library.\n\nIf you'd like to get this to work, try setting your signing key using:\nphp\n$client->setConfig('signing_key', $signingKey);\ntruthfully, this should be set automatically when $client->setAuthConfig is called. I'll look into making this change.\nThanks for bringing this to our attention!\n. Hello! Is there a chance you updated the library before getting the error? Try checking your code out to the v1-master branch and see if that fixes it. \n. Nevermind, I see you are using classes that only exist in the previous version, so that cannot be the cause. \n. Can you confirm this error is no longer occurring? \n. It sounds like this was an intermittent issue. \n. @Nyholm I understand the desire for an AccessToken object, but arrays are simpler, which is why that decision was made. As for Guzzle, it would be great to have this library be compatible with Guzzle6. Unfortunately, because Guzzle6 breaks BC in almost every way with 5, and we are dependent on libraries which use 5, this is not a trivial change. We will track this in #720\n. Thanks for your feedback!\n. Why do you think #720 requires adapters for other projects? It only would make this repo compatible with Guzzle 5 or Guzzle 6, and the user can decide which.\n. I agree that Guzzle has created quite the pickle for all us dependent libraries. I'm not stoked about having to implement these adaptors. But the repo you linked has a single interface with a single method in it. Perhaps you could point me to some better documentation on how it works? \nFor us to make this library dependent on yet another library (which I've never heard of until now) will require some (serious) vetting. Also, keep in mind our auth library will need to follow suit. \n. FWIW we don't need to be compatible with every http library out there. We just need this library to work really well with at least one http client. The problem I'm most concerned with is libraries depending on Guzzle6 will get an unresolvable conflict when they include us.\nFortunately, if we implement #720, we should become PSR7-compatible in the process.\nThanks for your feedback and info. I'll continue to monitor the progress of PHP-HTTP.\n. Yes, let's!\nThe way I've envisioned it starts with google/auth. It can follow the psr7 middleware spec (accept request and optional response, return a response). Then we can use a bridge for guzzle5 to implement psr-7. \nOnce the auth library implements we can make this library (google/apiclient) do the same. \nThis will be a lot of work. \nThe other option is to stick with guzzle 5, fork the project, change all the namespaces to prevent conflicts, commit it directly to our projects, and become parias of the community. \n. Thank you for your feedback @Nyholm. Here are my thoughts on the topic:\nFirst, I agree in order for this library to be useful and stay current with the PHP community, we will need to adopt PSR-7\nSecond,  v1.x is the currently supported version, and does not require guzzle as a dependency, so if anyone has major conflicts with this library, they should be using that version.\nLast, please understand PSR-7 had not been released at the time this library and its dependencies were under development. In addition, PSR-7 asks quite a bit out of libraries in order to adopt it. Decisions were made in PSR-7 to prioritize certain ideals over driving adoption in the community. Some popular PHP libraries have no plans to adopt PSR-7 in their core (I am referring primarily to Symfony and Symfony components). If it was easy to refactor this library for PSR-7, we would have done it by now, but it will require quite a bit of active development to do so. I do not think using PHP-HTTP is an exception to this.\nPlease continue to +1 this issue, so we can prioritize getting this feature done.\n. Symfony core has no plans to refactor core components for PSR-7 due to, as you say, BC breaks. This is what I am referring to. \nWe are very happy to accept any and all contributions from the community regarding enhancements to this library. There is already an effort here to do so for Guzzle 6. Realistically, we will need the community to assist here in order to get this done. I was hoping to articulate as much in my previous comment, but apparently I just ruffled some feathers, which was not my intention.\nIn regards to HTTP-Plug, is it correct that if we adopt PSR-7, HTTP-Plug will be satisfied? \n. @cnelissen thank you for your feedback. What libraries are you using which have this dependency?\n. PR #768 represents a branch where guzzle5 and guzzle6 are supported. This is now available for installation via packagist for anyone feeling brave and/or desperate. \n. @uxweb no there isn't, but I've fixed that issue here: 91591b4cddb97d7dd19ab9700cdc964c358b61f2\nAnd you providing feedback like this is incredibly helpful, so please keep it up and we will have an RC soon!\n. This has now been merged into master here and tagged as v2.0.0-RC4\nYou can check it out by running composer require \"google/apiclient:~2.0@RC\"\n. I believe this issue would be fixed by setting google/auth to version ~v0.3, and then you could manually include google/auth: dev-master in your project's composer.json\nIs composer throwing an error? If so paste it here. \n. Yes, that would certainly work. See this post for a quick way to do this.\nI'll be tagging a v0.4 version and updating this library's composer.json shortly to fix this.\n. This should now be fixed by #733. Can you verify by updating to google/apiclient: dev-master? \n. Thank you for bringing these to our attention! We will update the documentation to point to the stable v1-master version of this library.\n. in the meantime, if you run the following instead, you'll be set:\ngit checkout -b v1-master https://github.com/google/google-api-php-client.git\n. the docs have been updated to point to v1-master. Hopefully this will help avoid confusion in the future!\nOnce v2 is stable, we will switch the documentation back. \n. The latest version must have dependencies installed via composer. See Upgrading for more information.\nAlternatively, check out the previous version of this library, which does not have this requirement:\ngit clone -b v1-master https://github.com/google/google-api-php-client.git\n. I believe someone must have added that requirement to your code, as the line you've mention does not appear in any of the current versions of this library.\n. see here and here\n. Ahh yes, you must have been pointing to v1.0.6-beta or another earlier version.\nThis is also strange since URITemplate.php is properly named in those versions. Whatever the case, I'm glad you could get the issue resolved.\n. The file is named correctly in your release here.  I imagine this has to do with OSX's case-insensitive filesystem, the fact it was renamed to UriTemplate.php in master, and the way you're deploying from there to a linux machine.\n. When using double quotes for string values, array keys are referenced without the quotes.\n. @tmatsuo yes, I just updated the description to indicate this (see #717)\n. Thank you for this! Question - shouldn't these types of API calls not even set an expected class? Is there somewhere in our documentation we can point for this use-case?\n. merged in #732 \n. @tmatsuo PTAL\n. You are right, we missed that one. Thanks!\n. I see... this is probably an indication this library needs to be updated for the next version of the storage APIs.\n. This should now be fixed with the regeneration of the service classes. If you continue to experience this issue, please considering using the Google Cloud PHP Storage library.. @sqrrrl @tmatsuo @surferjeffatgoogle PTAL\n. the Script API is the recommended way to interact with Google Spreadsheets. Also the Drive API can be used to pull down and upload the files themselves.\n. What you want should be easy to achieve with AppScript. But also you could\ndownload the csv, add the rows, and upload the new csv with the Drive API.\nOn Sat, Nov 7, 2015 at 1:45 AM wstoettinger notifications@github.com\nwrote:\n\nThanks for the quick response! Am I assuming correctly, that this requires\nto set up an Apps Script project first? Maybe I'm getting it wrong, but\nthis looks a bit too complicated to setup for such very basic needs.\nI'd basically just like to add rows to an existing spreadsheet or update\nthem (with data from a registration form in this case, so much similar to\nwhat google forms does). This shouldn't be more complicated than selecting\nthe spreadsheet/worksheet via name or id and sending an array for insert or\nupdate (of course the authentication has to happen before).\nBefore Google shut down the username/password authentication, I used this\nneat library (it requires ZEND 1) which shows quite nicely how easily it\ncould be done:\nhttp://www.farinspace.com/saving-form-data-to-google-spreadsheets/.\nUnfortunately it neither works with service accounts, nor on the GAE.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/734#issuecomment-154680718\n.\n. Who needs that POST body anyway? Okay well I guess it is kind of important. \n\nGood catch. Can you update your code to #737 and see if this fixes it?\n. We do not recommend disabling SSL. Instead you should find where the Root\nCA of the machine and add it to Guzzle, or if SSL isn't needed, make\nrequests on port 80.\nIf your project WAS working with SSL enabled, and now it isn't, I would\ndefinitely suggest investigating that root cause first.\nThat being said, it is possible to disable SSL verification in guzzle with\nthe following command:\n$client->getHttpClient()->setDefaultOption('verify', false);\nAs this command COMPLETELY NULLIFIES THE SECURITY USEFULNESS OF SSL and\nHTTPS, please use wisely (and preferably not at all)\nOn Sat, Nov 7, 2015 at 2:15 AM verbruggenalex notifications@github.com\nwrote:\n\nPreviously I was working on localhost without SSL without any problems.\nBut lately when trying to authenticate I get the following error:\nGuzzleHttp\\Exception\\RequestException: cURL error 60: SSL certificate\nproblem: unable to get local issuer certificate in\nGuzzleHttp\\Exception\\RequestException::wrapException() (line 51 of\nC:\\wamp\\www\\development.xxx\\sites\\all\\libraries\\google-api-php-client\\vendor\\guzzlehttp\\guzzle\\src\\Exception\\RequestException.php).\nOn my webserver with SSL everything worked just fine. So I tried using SSL\nlocally to no avail. I also tried using $client->setDefaultOption('verify',\nfalse); to which I get following error:\nFatal error: Call to undefined method Google_Client::setDefaultOption()\nIs there still a possibility to authenticate without SSL. Just for the\nsake of allowing people to test out stuff locally without the use of SSL?\nPs: I apologize in advance if this is a non-issue that belongs on\nstackoverflow. But I really don't know what caused this change in behaviour.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/742.\n. Well, if you're making an HTTPS request on your local machine, you'll need a self-signed certificate and you'll want to add your certificate authority in guzzle. The path to the self-signed certificate can be passed to the verify option instead of a boolean in order to do this.\n\nThere's extra overhead to get this working, but it's more secure and reliable in the long run.\n. @csengineer13 apparently our tag is broken on packagist because we're including a v in the version for the google/auth library. Once it's updated, 2@RC will work.\n. Okay, everything is updated. Please test with the @RC tag \nhttps://packagist.org/packages/google/apiclient#v2.0.0-RC2\n. closing in favor of #746 (due to missing CLA)\n. You are correct that the docs are not up to date with v2, but the docs state to clone the v1-master branch of this library. How could we make this more clear?\nWe could put a banner in the README: \"If you arrived here from developers.google.com, you should be using the v1-branch of this repo\"\n. Thank you for y our feedback @buley!\n. Hmm, it's probably because we updated the tag of ^2.0.0@RC to point to a new SHA (notice the URL you provided does not exist). Try running:\nsh\n$ composer clear-cache\n. This is as expected. The section for impersonating a user is supposed to be under the removal of AssertionCredentials.\nAre you proposing this fix because you found the current way confusing?\n. Windows has accepted the forward slash since Windowns NT. But I do like your solution better.\n. How did you solve this issue?\n. What is your OS / PHP version? \n. Check out the v1-master branch for Php 5.3 compatibility\nOn Sat, Nov 21, 2015 at 3:39 PM Philip Kahn notifications@github.com\nwrote:\n\nAhh, PHP 5.4 whereas my client's server is 5.3. Closing.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/757#issuecomment-158684045\n.\n. Hi @iftikhardirv \nMost likely you just need to add $client->setApprovalPrompt('force');\n\nA confusing aspect of the Offline Access parameter is it only returns a refresh token the first time it's authorized. After that, it won't request offline access any more unless you set approval_prompt to force\n. Yes, if you add approval_prompt=force, you'll receive a refresh token. The refresh token will allow you to request additional access tokens without the need for client authorization.\nHave you tried using refresh tokens?\n. You would handle this in your oauth2callback.php script.  When you receive the access token in that script, do a var_dump on the response, and you'll see a refresh_token property. This should convince you the refresh token is being handled.\nIf the refresh token is indeed coming back with the response, then using $client->setAccessToken will automatically store the refresh token and use it to get a new access token, as long as $client->setAuthConfigFile is being called and client_secrets.json includes valid client credentials.\nYour code looks great. But as I said in my first comment, you may want to add $client->setApprovalPrompt('force);, because if you've already authorized the client, it won't send the refresh token again without this. \n. Yes... do avar_dumpwhere you have$client->getAccessToken(), do you see arefresh_tokenproperty? If not, then add$client->setApprovalPrompt('force);in your first file undersetAccessType`.\nAlso, get rid of the $client->createAuthUrl() line. This creates two different places where your authorization URL is generated, which makes it harder to know which one's being used.\n. Change this:\nphp\n// Handle authorization flow from the server.\nif (! isset($_GET['code'])) {\n  $auth_url = $client->createAuthUrl();\n  header('Location: ' . filter_var($auth_url, FILTER_SANITIZE_URL));\n} else {\n  $client->authenticate($_GET['code']);\n  $_SESSION['access_token'] = $client->getAccessToken();\n  $redirect_uri = 'http://' . $_SERVER['HTTP_HOST'] . '/google-api';\n  header('Location: ' . filter_var($redirect_uri, FILTER_SANITIZE_URL));\n}\nto this:\nphp\n// Handle authorization flow from the server.\n$client->authenticate($_GET['code']);\n$_SESSION['access_token'] = $client->getAccessToken();\n$redirect_uri = 'http://' . $_SERVER['HTTP_HOST'] . '/google-api';\nheader('Location: ' . filter_var($redirect_uri, FILTER_SANITIZE_URL));\nThe reason is you do not want your callback endpoint functioning as an authorize endpoint. Rather, it should throw an error (\"code\" not found) if a code is not supplied in the querystring.\nI am curious, where did you find this implementation code? I would like to fix it so this doesn't happen to other users.\n. Yes, it should send you back to the URL from before, this time with an access token. This is the expected behavior. If you access the page directly, the authenticate method should throw an error.\nThese instructions should work with both the old and new versions of this library.\nWere you able to obtain a refresh token?\n. If you don't want to authorize a third party, you shouldn't be requesting the authorization URL. The code you've supplied is the code to use login page authentication\nFor Server-to-Server authentication, follow the instructions in these docs. \nYou can find information on the Google Play API here\n. Your composer.json does not need the repositories entry. The problem is when you add the repository manually, composer can't resolve the library's dependent packages.  As a result, the dependent library google/auth is not being pulled in.\nSo remove the entire repositories entry and you'll be good to go.\n. You have an interesting problem going on. You're using the 1.0 tags, and that version does not use Google\\Auth\\OAuth2.  The class in your error isn't included in this library until 2.x.\nSo there is definitely something different between the library you have in composer.json above, and the library that is actually being autoloaded.\n. this file is auto-generated, so this change would be overwritten when we update next.\n. These files are auto generated so this change would just be overwritten on the next update\n. Can you explain why you require this change? Are you trying to subclass the getter function?\n. I see. I agree with the change, but as this is auto-generated, the work for this change may not be worth the investment. However, the code to generate these classes can be found here if you're interested in implementing a more permanent fix.\n. agreed, let's go with @quantumpacket's solution.\n. closing, this will be refactored out soon\n. Good call! Will merge once tests pass.\n. ... comeon travis, you can do it!!\n. anybody who was using this composer branch can now run composer require \"google/apiclient:~2.0@RC\"\n. I won't shoot you, but this is not the proper place to be asking this question. I would ask this question on the youtube help forums or file a bug. \n. We need to remove the parameter from calls that are still passing it in.\n. LGTM!\n. thank you @caleblloyd! This is now fixed in 20e6a625a0dbf0f41815baa565549d9af39c5586\n. this is an environmental problem. See some ways to solve it here\n. It's possible your project ID is not the same as in client_secrets.json. Check the \"project_id\" property in the json file to make sure they're the same. \nIt's also possible the user who downloaded the client_secrets.json file does not have access to cloud storage, and the credentials need to be downloaded by someone with full access to the project.\n. Try including this file and you should be good to go.\n. Try pulling down the latest version (RC4) and this problem will be fixed.\n. where is the broken link happening? Can you provide a link to the page where you found it?\n. This is probably the content you are looking for: https://developers.google.com/api-client-library/php/auth/web-app\n. Aha, yes this is because v2.0.0-RC2 checks out to ~v0.4, which will update (unfortunately) to v0.5 automatically, which is not backwards compatible.\nI will try to update the tag to fix this\n. fixed in bc2f60271ef1042aaef8c8d3ca238613478fe4e9 and v2.0.0-RC3 has now been created. Please update your dependencies and this will be fixed.\n. this pull request accomplishes nothing... the \"v\" is not taken into account by composer. What are you trying to accomplish?\n. I see now, from your comment on #768. Thank you.\n. reverted - the CLA was not signed\n. fixed in 305fd9c43ccc7921ab71cd848b0420c3e8f620fd\n. CLA \n. closed in favor of 305fd9c43ccc7921ab71cd848b0420c3e8f620fd\n. Hmm... Can you paste the code for the call you're making? I believe that error happens when a sub is being requested that the service account does not have access to.\n. This is great! If you can sign the CLA and comment for @googlebot, I'll go ahead and merge this.\n. @DavidPrevot can you sign the CLA (and now also this requires a rebase) so that we can get this merged?\nthanks!\n. This needs a rebase, otherwise it cannot be merged.  Please do the following:\ngit remote add google git@github.com:google/google-api-php-client.git\ngit checkout tests\ngit rebase google/master\nResolve the merge conflicts and force-push back to this branch.\n. after further review, none of these tests actually require the check being suggested. \n. @Sharma-Ravin the error you are receiving is not the same one mentioned in this issue.\nYour question is answered here. Hi @caleblloyd,\nTry linking again to the line in question. The master branch was updated yesterday and the line number you pointed to above is no longer relevant.\nAre you using any particular sample code for the GCS file upload? Can you post your code so I can help debug it?\n. I see. Good catch! I will make the change and write a test for it\n. @caleblloyd after reviewing #860 and #327, fixing the URL should not have allowed you to do batch uploads. Were you ever able to perform batch uploads with the above code?\n. Ahh, I see. Yes, that's a completely different thing. Guzzle's \"batch\" executes the requests in parallel using promises.  Thank you for your response!\n@temuri416 you can use the code found in the Guzzle docs. For example:\n``` php\nuse GuzzleHttp\\Pool;\n// Guzzle 5\n$client = new Google_Client();\n$service = new Google_Service_Drive($client);\n$file1 = new Google_Service_Drive_DriveFile([\n        'name' => '1.jpg',\n        'mimeType' => 'image/jpeg',\n        'parents' => [$newFolderId],\n]);\n$file2 = new Google_Service_Drive_DriveFile([\n        'name' => '2.jpg',\n        'mimeType' => 'image/jpeg',\n        'parents' => [$newFolderId],\n]);\n$req1 = $service->files->create($file1, [\n        'data' => file_get_contents('img/1.jpg'),\n        'mimeType' => 'image/jpeg',\n        'uploadType' => 'media',\n        'fields' => 'id',\n]);\n$req2 = $service->files->create($file2, [\n        'data' => file_get_contents('img/2.jpg'),\n        'mimeType' => 'image/jpeg',\n        'uploadType' => 'media',\n        'fields' => 'id',\n]);\n$requests = [$req1, $req2];\n// Results is a GuzzleHttp\\BatchResults object.\n$results = Pool::batch($client->getHttpClient(), $requests);\n// Can be accessed by index.\necho $results[0]->getStatusCode();\n// Can be accessed by request.\necho $results->getResult($requests[0])->getStatusCode();\n```\nI imagine this is possible with Guzzle6 as well.\n. @temuri416 A pretty critical rule of thumb is never tweak a vendored library. Please implement your changes in your application cod.\n. @temuri416 OK! Ha glad to hear it. You never know.  As to your other question, this is not something I want added to Resource.php. Throwing an exception would be the better way to go.\nThe changes to the url being referred to are made here\n. Try this:\nphp\n$client->getHttpClient()->setDefaultOption('verify', 'C:/Windows/curl-ca-bundle.crt');\n. The class is GuzzleHttp\\Client. Also, ensure you're including vendor/autoload.php.\nI am closing this issue because it's outdated. Please open a new issue if you run into any problems, and post the full version of your code.\n. As this is a big change for very small noticeable gain, this will be merged in after the tagged stable release of v2.0.0\n. I cannot find this API in the APIs Explorer, but I have found reference to the scope and the api endpoint mentioned in the documentation above.\nAs explained in #855 and #820, if you have the URL of the API, you can use the authorize method for authentication, and use the resulting HTTP Client to call the API:\n``` php\n$client = new Google_Client();\n// set your auth\nif ($youAreUsingServiceAccount) {\n    $client->useApplicationDefaultCredentials();\n} elseif($youAreUsingThreeLeggedOAuth) {\n    $client->setAccessToken($accessToken);\n}\n// get the authorized HTTP Client object\n$http = $client->authorize();\n// make the call!\n$userEmail = 'your@email.com';\n$url = \"https://www.google.com/m8/feeds/contacts/$userEmail/full\"\n  . '?updated-min=2007-03-16T00:00:00';\n$result = $http->get($url);\n```\n. Thank you for reporting this. Please include the error and stack trace.\n. Fixed in #796\n. It sounds like you've managed to install guzzle 6 on Php 5.4, which is not\ncompatible. Use guzzle 5 instead and you'll be good to go.\nOn Sat, Jan 2, 2016 at 8:31 AM Andrew Jackson notifications@github.com\nwrote:\n\nJust looking to implement this for verifying In App and Subscriptions, on\ntrying to connect for auth I get the following error:\nmod_fcgid: stderr: PHP Fatal error: Call to undefined function\nGuzzleHttp\\Handler\\curl_reset() in /mypath/vendor/guzzlehttp/guzzle/src/Handler/CurlFactoryphp\non line 78\nLooking in the PHP docs (http://phpnet/manual/en/functioncurl-resetphp)\nthe function curl_reset is not available below PHP 550, but the library\nstates PHP 54, I have 5445\nThe only place I can find it is in the file CurlFactoryphp on lines 71\n(comment) and 78 (function call)\nWondering what it will be, change to 55 or greater or find another way to\nreset the curl\nRegards,\nJacko\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/793.\n. You're right. You'll need to use composer to install it instead, for PHP\n5.4. Have you tried this? Just download composer (https://getcomposer.org/)\nand in your project root run \"composer require google/apiclient:~2.0@RC\"\nand then add \"require 'vendor/autoload.php';\" in your project.\nOn Sat, Jan 2, 2016 at 11:16 AM Andrew Jackson notifications@github.com\nwrote:\nBrent,\nDidn't install with composer but downloaded the 2.0.0RC4 zip file and it\nseems guzzle 6 is the library that is included in that.\nCouldn't see anywhere the option to use an older guzzle using the download\nmethod.\nJacko\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/793#issuecomment-168413587\n.\n. Can you paste your code so we can see what you might be doing wrong? From the information you've provided, there really isn't any way we can help.\n. @sivabalan02 I am not sure where the problem is... however, this flow has been deprecated in favor of the v2.0 version of this library, which you can learn more about here.\n\nI suggest trying to pull down the latest version and using the new method of assertion credentials. Note you'll need to use a json credentials file instead of the p12 you're currently using.\n. @daftspunk Interesting. What is the error you are receiving, and does it seem to be an issue with the PHP Library or with the Google APIs?\n. Ahh, interesting. I know the p12 method is deprecated, so it is very likely those specific APIs have been intentionally phased out for all but legacy credentials.\n. Yes you could use this library to accomplish this - just download Service Account Credentials and set the file path with $client->setAuthConfig. \nHowever, Wouldn't you be better off using the Drive desktop client for that?\n. What results are you getting? It's probably because you need to set the subject. Try doing the following:\nphp\n$client->setSubject('yourdriveemail@gmail.com');\nI am surprised the API isn't just throwing an error. Is the response coming back with an empty array for files?\n. I'm not sure why you're seeing different files - I was under the impression it was impossible to upload to drive without a user context.\nWe are doing something here that might be useful. We set accessType to offline, and once the user authorizes, it comes back with a refresh token that gets automatically refreshed each time.\n``` php\n// create an authorized client\n$client = new Google_Client();\n$client->setClientId($clientId);\n$client->setClientSecret($clientSecret);\n// create file cache for storing the access token and refresh token\n$cache = new Google_Cache_File(sys_get_temp_dir().'/google-api-php-client-tests');\n// make sure we have a token\nif (!$token = $cache->get('access_token')) {\n  $client->setRedirectUri(\"urn:ietf:wg:oauth:2.0:oob\");\n  $client->setConfig('access_type', 'offline');\n  $authUrl = $client->createAuthUrl();\necho \"\\nPlease enter the auth code:\\n\";\n  ob_flush();\n  open '$authUrl';\n  $authCode = trim(fgets(STDIN));\n$token = $client->fetchAccessTokenWithAuthCode($authCode);\n  if (!isset($token['access_token'])) {\n    exit('failed!');\n  }\n  $cache->set('access_token', $token);\n}\n$client->setAccessToken($token);\n```\n. The second link there is referring to version 1 of this library, and has changed according to the Upgrading document in version 2. I suggest you stick with the first example.\nWe'll be moving the docs to version 2 very soon.\n. I have already provided several code samples that will accomplish this task. In addition, there is this example that exists as part of the repository which accomplishes what you are trying to do.\n. You have two options:\n1. Create an \"installed application\" and use a refresh token\nThis is what I outlined in my code sample above. This does not use a service account, but instead uses an Oauth \"installed app\" which fetches the access token with a refresh token indefinitely\n2. Create a \"service account\" and from your USER account, authorize the client so it shows up here\nthis is trickier, as you will need to create an OAuth Client just to authorize your user\ngo to API Manager > Credentials > New Credentials > OAuth Client ID and then select other as the client type.\n\nNow download those credentials (below, client_secret_xxx.json) and use them like this: \nphp\n$client->setAuthConfig('/path/to/client_secret_xxx.json');\n$client->addScope(\"https://www.googleapis.com/auth/drive\");\n$client->setRedirectUri(\"urn:ietf:wg:oauth:2.0:oob\"); // this is so you can grab the code in the browser\nheader('Location: '. $client->createAuthUrl());exit;\nnow you can copy the code and exchange it for an access token like this:\nphp\n$client->fetchAccessTokenWithAuthCode($code);\n\nIt is not enough for you to authorize the client in the browser, you must also have the client request an access token to complete the authorization.\n\nAfter all this, you will see the client show up under your authorized clients:\n\nNEXT, you can switch back to your service account credentials and set the subject as the user who has authorized the app:\n``` php\n$client->setAuthConfig('/path/to/service-account-credentials.json');\n$client->addScope(\"https://www.googleapis.com/auth/drive\");\n$client->setSubject('youremail@gmail.com');\n// continue to upload with Drive forever and ever...\n``\n. @AndreyNazarchuk does the authorized application show up in your [authorized applications](https://security.google.com/settings/security/permissions)? If not, I assume the access token was not fetched as expected.\n. If the line$client->fetchAccessTokenWithAuthCode($code);returned an access token.\n. @abhay1003 Please open a [new issue](https://github.com/google/google-api-php-client/issues/new) with your question, as this issue has been closed.. Do you have a stack trace for the error?\n. Looking at [the difference between the tags](https://github.com/google/google-api-php-client/compare/v2.0.0-RC2...v2.0.0-RC4) there were some [refactorings](https://github.com/google/google-api-php-client/compare/v2.0.0-RC2...v2.0.0-RC4#diff-e912e39fbc1c619500bee6c1bab1600eL76) forGoogle\\Cache\\File. However, none of these seem like they would cause the issue above. Can you switch to RC3 and verify this fixes the issue? \n. fixed in #839\n. @colinfrei This is great! Thanks for catching and fixing this.\n. This may be more complicated than for python, due to the lack of multithreading in PHP.\n. Closing as we do not really need this.. Yeah I don't think we need this..'postmessage'does not follow the OAuth2 spec for a valid redirect URI. If anything, it should follow the formaturn:postmessage`. \nI suppose the solution would be to add an explicit check for postmessage in this function. I would love to have whoever made the decision to support postmessage defend this reasoning, however!\n. fixed in https://github.com/google/google-auth-library-php/pull/92\nNo, urn:... will validate just fine, since it follows a standard URI format.\n. This is great, but \"objet\" should be \"object\"\n. merged in c872f606236631bf4da16daa9ff7501d036fed60\n. These files are auto-generated, so this change will not take.\n. It means it'll be updated when the script is manually run to update all the APIs. It's not a great solution, but it's all we have right now.\nFor those who need it sooner can implement the changes in this pull request.\n. these have been updated for v1-master (see #834), and the PR for master is here: #835 \nI won't be merging these changes into master because they break BC. I will need to tag a stable release (2.0.0) first, and then I can merge them in. This will probably be in a week or two. So if you need this, just pull down my personal fork and use that.\n. this has now been merged into the master branch\n. You need to include the src/Google/autoload.php file in your application.\n. This looks great! Thank you for the work and discussion on this. I have fixed the tests and will merge and tag once they pass.\n. @Gemmu  tagged in 1.1.7. Go forth and Packagist.\n. Thank you for locating the source of the issue. Your hypothesis sounds pretty believable. \nI am not a huge fan of using umask in this way, as I do not believe it's the standard usage. What if we defaulted Google\\Cache\\File::getCacheDir to generate a different hash depending on the user? This way we maintain security by default, but avoid permissions errors for multiple users.\n. @huebs if you are willing to make the change, I am all for the symfony approach (777 for directories, 0666 ~ umask() for files). I am not worried about BC, since we haven't tagged a main version yet (being in RC mode allows us to sneak this in)\n. closing in favor of #839\n. wow, right on @mTorres! thanks for the help.\n. this will be resolved in #842 - I am removing the default file cache implementation\n. This is now fixed in RC5. Please update to this version and reopen this issue if the problem continues.\nThank you!\n. Hmm, I do not know if those APIs are supported. See the APIs explorer for the current list\n. Both of these APIs are deprecated (Video Search API, News API)\nHowever, as explained in #855, if you have the URL of the API, you can use this library to handle authentication, and use the HTTP Client to call the API directly using the authorize method:\n``` php\n$client = new Google_Client();\n// set your auth\nif ($youAreUsingServiceAccount) {\n    $client->useApplicationDefaultCredentials();\n} elseif($youAreUsingThreeLeggedOAuth) {\n    $client->setAccessToken($accessToken);\n}\n// get the authorized HTTP Client object\n$http = $client->authorize();\n// make the call!\n$url = 'https://maps.googleapis.com/maps/api/place/nearbysearch/json'\n  . '?location=-33.8670522,151.1957362'\n  . '&radius=500'\n  . '&types=food'\n  . '&name=harbour'\n$result = $http->get($url);\n``\n. The problem is the underlyinggoogle/auth` library's caching implementation is broken. The cache keys which get generated are not unique.\nI've removed the caching entirely for now in #842\n. This is now fixed in RC5. Please update to this version and reopen this issue if the problem continues.\nThank you!\n. > it doesn't return any response\nI assume you mean it returns false? If so, most likely your ID Token payload has an audience (aud) property, and it isn't matching with the configured client_id.\nIf this is the case, you can use something other than your Client ID by calling the verifier directly:\nphp\n$accessToken = $client->getAccessToken();\n$verifier = new Google_AccessToken_Verify();\n$verifier->verifyIdToken($accessToken['id_token'], 'some-custom-audience');\n. Closing due to inactivity. Please reopen if you have additional problems or questions.\n. Feel free to use v2. It is the recommended version. however, the documentation on developers.google.com has not been updated (at the time of this comment), and so the docs will need tweaking to get it to work.\n. This class gets autogenerated. You could add this method to Google\\Model, which is the subclass where the property comes from. \nCan you explain why you need to access the model data here?\n. Do you have an API Key set?\nphp\n$client->setDeveloperKey($myApiKey);\n. Yeah that sounds right. I'm glad you figured it out\n. fixed in #828\n. @Kak3n v2.0.0-RC5 and on have had this change.\n. @jslewis90 I imagine this is an issue with your server's date/time configuration.\n. @martinfree You're right, this is not an optimal solution because it pollutes global scope. I'll submit a fix that ensures the adjustment is localized. It would be great if the Firebase\\JWT class made leeway configurable per instance as well as statically.. Hmm, my guess is that you are behind a firewall, or some other strangeness is happening with your network connection.  Have you tried pinging the APIs or curling the API endpoints directly from the command line?\n. This is expected behavior. You need to include autoload.php.\n. if you are using JSON keys in v1, use Google_Client::loadServiceAccountJson\nIf you are using JSON keys in v2, use Google_Client::setAuthConfig\nBackporting is not necessary, as v1 is deprecated.\n. I'm not a fan of development on deprecated products. However, I'm definitely open to PRs which backport this behavior. In the meantime, I've added this to UPGRADING.md (#841), so hopefully this will help.\n. This question is quite confusing to me. You can handle multiple users by maintaining multiple sessions (like any other app), and if you wanted to restrict different folders/paths in your application, you'd have to implement your own ACL or use a framework ACL for that.\nCan you provide a little bit more on what you're trying to accomplish?\n. Glad to hear it!\n. \n. try running composer install in the root directory.  First, you'll need to install composer\nThe alternative is to download a zip file from the Releases section.\n. I have seen these same errors in our testing environment. They are very intermittent, and the best thing to do is to retry the request. I will look into building retries into the library.\n. I have seen this issue before. You are trying to exchange an Authorization Code for an Access Token and you have not set your redirect_uri in the google client:\n``` php\n$client = new Google_Client();\n$client->setClientId($yourClientId);\n$client->setClientSecret($yourClientSecret);\n// you must set your redirect URI to exchange an access token:\n$redirectUri = 'http://www.example.com/oauth2callback';\n$client->setRedirectUri($redirectUri);\n// now this should work\n$client->fetchAccessTokenWithAuthCode($code);\n``\n. In future bug reports it is bad form to post only a stack trace with no code samples or further explanation of context.\n. @huebs please comment here to make the CLA bot happy :D\n. @tmatsuo PTAL\n. @huebs thoughts on this final iteration?\n. Hmm, at a glance this seems like an underlying curl problem, or even an underlying Guzzle problem, and not an issue with this library.\n. This [stack overflow](http://stackoverflow.com/questions/29822686/curl-error-60-ssl-certificate-unable-to-get-local-issuer-certificate) provides several ways to work around this problem.\n. * Save the following tocacert.pem`: https://curl.haxx.se/ca/cacert.pem\n\n\nput it here:\n\nC:\\xampp\\php\\extras\\ssl\\cacert.pem\n\n\n\nin your php.ini put this line in this section:\n    ```\n    ;;;;;;;;;;;;;;;;;;;;\n    ; php.ini Options  ;\n    ;;;;;;;;;;;;;;;;;;;;\ncurl.cainfo = \"C:\\xampp\\php\\extras\\ssl\\cacert.pem\"\n``\n* restart your webserver/apache. @sarasad it's possible you added it to the wrongphp.inior did not properly restart your web server. Add a file such as this and ensure thecurl.cainfo` value is as expected:\n\n\n```html+php\n<?php\n// somefile.php\nphpinfo();\n```\nIf that doesn't work, try seeing the guzzle documentation on how to provide your own cert file directly (https://github.com/guzzle/guzzle/issues/394). For this library, it will look something like this:\nphp\n$http = new GuzzleHttp\\Client([\n    'verify' => '/path/to/cert.pem'\n];\n$google = new Google_Client;\n$google->setHttpClient($http);. No, the error is referring to this class. The problem is you need to run composer to install the dependencies for the library. Alternatively, you can download the zip by clicking google-api-php-client-2.0.0-RC5.zip, and all the dependencies will be pre-installed.\n. Hmm, can you open a new issue describing your problem please? This issue's been closed. Also include the exact error message you're receiving. Thank you!. Hmm... throwing an exception is worse than the problems this is trying to solve. If the functions return nothing, we can md5 the empty string.\nDid you run a script with sudo and later couldn't access the files as a web user?\n. great! thank you for that. If you remove the exception, I will merge this.\n. Hi @am63. Thank you for reporting this.\nThe issues we experienced with the caching in place (users receiving data from other users' access tokens) was too big an issue to not remove caching for the time being until we could solve the problem.\nYou can almost certainly solve this by implementing caching manually on your end like this:\nphp\n$cacheDir = '/your/cache/dir';\n$cache = new Google_Cache_File($cacheDir);\n$client = new Google_Client();\n$client->setCache($cache);\nif ($accessToken = $cache->get('access_token')) {\n    $client->setAccessToken($accessToken);\n}\n// go on and do your thing\nWith this approach, you'll have to be sure to store your access token in cache when you first receive it:\nphp\n// *** In your authorization callback ***\n$client = new Google_Client();\n// retrieving access token from authorization code\n$accessToken = $client->fetchAccessTokenWithAuthCode($_GET['code']);\n// now store it in the cache!\n$cacheDir = '/your/cache/dir';\n$cache = new Google_Cache_File($cacheDir);\n$cache->set('access_token', $accessToken);\nIf nothing else, you could subclass $client to behave like it used to:\nphp\nclass CachedGoogleClient extends Google_Client\n{\n    protected function getAuthHandler()\n    { \n        return Google_AuthHandler_AuthHandlerFactory::build($this->getCache());\n    }\n}\nNow if you set the cache (you still have to do that manually), the access tokens will be cached as before\n. Hmm, this is interesting.  This  really shouldn't be necessary.\nIn the authorize function, this same logic is already implemented, making the above code redundant. Have you tried letting the library handle this logic instead?\n. @am63 check out #867 - this should fix your issue.\n. @tristanbailey this issue is not relevant to the v1-master branch.  Whatever issue you are experiencing has to do with something else.\n. This will be added in #835\n. this has now been merged into the master branch\n. This will be added in #835 \n. this has now been merged into the master branch\n. this is a good find, but we don't want exit in our tests. I have fixed this as part of #835\n. this has now been merged into the master branch\n. @Mevrael The Places API is not currently exposed in the Discovery Service, which is what this library uses to generate the service classes.\nFor this reason, I suggest making the calls using the HTTP client, which you can do using the authorize method:\n``` php\n$client = new Google_Client();\n// set your API Key\n$client->setDeveloperKey($myKey);\n// get the authorized HTTP Client object\n$http = $client->authorize();\n// make the call!\n$url = 'https://maps.googleapis.com/maps/api/place/nearbysearch/json'\n  . '?location=-33.8670522,151.1957362'\n  . '&radius=500'\n  . '&types=food'\n  . '&name=harbour'\n$result = $http->get($url);\n```\n. This message is not about the quota, it's about the IP address you are making the request from.\nTry whitelisting your requesting IP by editing your API Key where it says Accept requests from these server IP addresses :\n\nThe reason you can comment out the key is the Book API is public. However, you have a limited quota when accessing it this way, and will eventually receive a quota error without a key.\n. Yes, Google \"what is my IP\" and use that one.\nOn Wed, Feb 17, 2016 at 1:11 AM Sazzad Hossain Khan \nnotifications@github.com wrote:\n\nI see. I was using browser key instead of server key.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/856#issuecomment-185107592\n.\n. ... Assuming your application is running on your local machine. \n. looks good! Thank you\n. indeed! thanks again!\n. For starters, your line for adding the parent ID is not correct. In the docs, the parent should be linked like this:\n\njson\n{\n  \"title\" : \"cat.jpg\",\n  \"mimeType\" : \"image/jpeg\",\n  \"parents\": [{\n    \"kind\": \"drive#fileLink\",\n    \"id\": \"0Bz0bd074\"\n  }]\n}\nSo in your code, it should be changed to look like this:\nphp\n$file = new Google_Service_Drive_DriveFile([\n    'name' => $i . '.jpg',\n    'mimeType' => 'image/jpeg',\n    'parents' => [\n        [ 'id' => $newFolderId, 'kind' => 'drive#fileLink' ]\n    ],\n]);\nTry this and let me know if it works.\n. @temuri416 so I believe the short answer here is it isn't supported.\nThat goes for batching uploads across any APIs, not just Drive v3.\n. As stated in #786, this can be implemented using Guzzle and Promises. It's different than the API's batch implementation, because this actually makes separate HTTP requests, but does so in parallel.\nHere is an example using Guzzle 5 Batch Requests:\n``` php\n// Guzzle 5\nuse GuzzleHttp\\Pool;\n$client = new Google_Client();\n$service = new Google_Service_Drive($client);\n$file1 = new Google_Service_Drive_DriveFile([\n        'name' => '1.jpg',\n        'mimeType' => 'image/jpeg',\n        'parents' => [$newFolderId],\n]);\n$file2 = new Google_Service_Drive_DriveFile([\n        'name' => '2.jpg',\n        'mimeType' => 'image/jpeg',\n        'parents' => [$newFolderId],\n]);\n$req1 = $service->files->create($file1, [\n        'data' => file_get_contents('img/1.jpg'),\n        'mimeType' => 'image/jpeg',\n        'uploadType' => 'media',\n        'fields' => 'id',\n]);\n$req2 = $service->files->create($file2, [\n        'data' => file_get_contents('img/2.jpg'),\n        'mimeType' => 'image/jpeg',\n        'uploadType' => 'media',\n        'fields' => 'id',\n]);\n$requests = [$req1, $req2];\n// Results is a GuzzleHttp\\BatchResults object.\n$results = Pool::batch($client->getHttpClient(), $requests);\n// Can be accessed by index.\necho $results[0]->getStatusCode();\n// Can be accessed by request.\necho $results->getResult($requests[0])->getStatusCode();\n```\nI imagine Guzzle6 supports this as well\n. init\n. Please provide more information in the problem you're having and what you're trying to accomplish.\nWe have $exception->getErrors() which can be used for this purpose.\n. Creating an exception class for every possible error is not really something we want to implement. However, having a method for getReason that returns the first error's reason might be a convenient way to handle this.\n. apparently #808 was submitted with a stubbed method, and buildPsr7Response doesn't actually exist...\nThanks for finding this.\n. fixed in aa458c5757868cd97f46c8b2c04a8e4b27b93ad1\n. @flaveris see #880\n. We upgraded all the services to their latest version. Drive is now using\nDrive Api v3, which is not backwards compatible with the previous version.\nOn Wed, Feb 24, 2016 at 9:27 AM Tom Witkowski notifications@github.com\nwrote:\n\nAfter upgrading fromj v2.0.0-RC4 to v2.*-dev I get the following Exception\n- if I rollback everything is fine.\nresponse\nexception 'Google_Service_Exception' with message '{\n \"error\": {\n  \"errors\": [\n   {\n    \"domain\": \"global\",\n    \"reason\": \"invalid\",\n    \"message\": \"Invalid Value\",\n    \"locationType\": \"parameter\",\n    \"location\": \"q\"\n   }\n  ],\n  \"code\": 400,\n  \"message\": \"Invalid Value\"\n }\n}\n' in /var/www/de.gummibeer.a3l/vendor/google/apiclient/src/Google/Http/REST.php:129\ncode\nprotected function getDirectoryId($name, $parentId = null)\n    {\n        if (is_null($parentId) && $this->baseFolderId !== null) {\n            $parentId = $this->baseFolderId;\n        }\n```\n    $q = 'mimeType=\"application/vnd.google-apps.folder\" and title = \"' . $name . '\" and trashed = false';\nif (!is_null($parentId)) {\n    $q .= sprintf(' and \"%s\" in parents', $parentId);\n}\n\n$folders = $this->service->files->listFiles(array(\n    'q' => $q,\n))->getItems();\n\nif (count($folders) == 0) {\n    return null;\n} else {\n    return $folders[0]->id;\n}\n\n}\n```\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/869.\n. @Fneufneu Good catch the current implementation will not work.  However, we can make this more robust/accurate:\n\nphp\n$isJson = true;\nif ($request && $qs = $request->getUri()->getQuery()) {\n    parse_str($qs, $query);\n    if (isset($query['alt']) && $query['alt'] == 'media') {\n        $isJson = false;\n    }\n}\n. closing in favor of #876 \n. Thank you for finding this issue!\n. closing in favor of #876 \n. Sorry to hear you have been having issues. As you may know, the p12 is deprecated in favor of JSON credentials. Good luck.\n. This changes the behavior of the function. If expires_in isn't set, the function returns false (NOT expired), when previously this would return true (expired), as expires_in would be evaluated as zero.\nAre you intentionally trying to change the behavior, or are you just trying to remove the undefined index warning? If you are doing the latter, this would be better:\n``` php\n$expiresIn = isset($token['expires_in']) ? $token['expires_in'] : 0;\n$expired = ($created\n    + ($this->token['expires_in'] - 30)) < time();\nreturn $expired;\n```\n. See this comment about the ways you can handle this. Access tokens expire in an hour (3600 seconds), so yes I imagine that's what is happening.\n. Hmm, the first will definitely not work, and is WAD, because you're directly calling the v5.x Guzzle Client with the Psr7 request.\nAs for the second, this should definitely work. Can you paste the full version of your code? No authentication is attached if you do not provide anything, so this could be the problem.\n. We have tests that cover this:\n- Developer Key\n- Access Token\n- Application Default Credentials\nSo the problem is most likely in your implementation.\n. @swordbeta thank you for updating this! That is definitely a tricky bug. But yes that makes sense, if you want to manipulate the GuzzleHttp\\Message\\Request object directly, you'll want to call Guzzle_Client::createRequest, and then the emitters will be attached.\n. @am63 The download is here. I think it was accidentally in draft mode.\n. Hello! \nThe dateTime property will always be an RFC3339 timestamp, according to the docs. You can use PHP's DateTime object from there:\n``` php\n$d = new DateTime($event->dateTime);\nvar_dump($event->dateTime);\n// string(25) \"2016-03-07T12:00:00-07:00\"\nvar_dump($d->format('Y-m-d'));\n// string(10) \"2016-03-07\"\nvar_dump($d->format('U'));\n// int(1457377200)\n```\n. The services here should be the same as in the apis explorer for Drive v3. \nYou can see the parents with the current API, and I'm not sure the children property exists, but if you can point to it in the API reference I can investigate.\n. bump!\n\nThis issue will be closed if there is no response.\n. Using the API Explorer, you need to specify the fields you'd like to receive back:\n```\nGET https://www.googleapis.com/drive/v3/files/{YOUR_FILE_ID}?fields=md5Checksum%2Csize%2Cname&key={YOUR_API_KEY}\n{\n \"name\": \"FILE_NAME\",\n \"md5Checksum\": \"acbdefdb4ccacbdef4fccc4aacbdef\",\n \"size\": \"3\"\n}\n```\nWithout actually testing it, this call should look something like this:\nphp\n$drive = new Google_Service_Drive($client);\n$result = $drive->files->get($fileId, [\n    'fields' => 'name,md5Checksum,size'\n]);\n. Hi there!\nFirst you will need to authorize a user. You can copy from the url shortener example to get this going, or see this example for using service accounts.  You will need to request the following scopes:\nhttps://www.googleapis.com/auth/plus.me\nhttps://www.googleapis.com/auth/plus.stream.write\nNext, use the activities API to post for users. This isn't supported in the API classes, so you'll have to make HTTP calls instead. It will look something like this:\n``` php\n// see the example above on how to set this up\n$http = $client->authorize();\n// the userID to post for, which has already been authorized by your oauth client\n$userId = '123456'; \n// create the URL for this user ID\n$url = sprintf('https://www.googleapis.com/plusDomains/v1/people/%s/activities', $userId);\n// create your HTTP request object\n$headers = ['content-type' => 'application/json'];\n$body = [\n  \"object\" => [\n    \"originalContent\" => \"We\\'re putting new coversheets on all the TPS reports before they go out now.\"\n  ],\n  \"access\" => [\n    \"items\" => [\n        [\"type\" => \"domain\"]\n    ],\n    \"domainRestricted\" => true\n  ]\n];\n$request = new \\GuzzleHttp\\Psr7\\Request('POST', $url, $headers, json_encode($body));\n// make the HTTP request\n$response = $http->send($request);\n// did it work??\nvar_dump($response);\n```\nGood luck!\n. That is because \"me\" in this context is the service account for the\ncredentials you downloaded, and not YOU as in your personal Google account.\nOn Tue, Jul 12, 2016 at 3:24 AM chaegumi notifications@github.com wrote:\n\nHi @bshaffer https://github.com/bshaffer ,\nPHP7\nand\nMy composer.json file:\n{    \"require\": {        \"slim/slim\": \"^3.4\",        \"monolog/monolog\": \"^1.20\",        \"slim/php-view\": \"^2.1\",        \"facebook/php-sdk-v4\": \"^5.2\",        \"google/apiclient\": \"^2.0\"    }}\nI do like below:\n$client = new Google_Client();    // $client->setAssertionCredentials($credentials);    $scopes = [Google_Service_Plus::PLUS_ME, Google_Service_PlusDomains::PLUS_STREAM_WRITE];    $client->setAuthConfig('../My Project-d2d94d5f2479.json');    $client->setApplicationName('My Project');    $client->setScopes($scopes);    // if($client->getAuth()->isAccessTokenExpired()){        // $client->getAuth()->refreshTokenWithAssertion();    // }    // $client->useDefaultApplicationCredentials();    $plus = new Google_Service_Plus($client);    // $plusdomains = new Google_Service_PlusDomains($client);    // var_dump($plusdomains);    // $result = $plusdomains->activities->insert('me', array(        // 'object' => array(            // 'originalContent' => 'Happy Monday!'        // ),        // 'access' => array(            // 'items' => array(                // array('type' => 'domain')            // ),            // 'domainRestricted' => TRUE        // )    // ));    $result = $plus->people->get('me');    $response->getBody()->write(var_export($result, true));    return $response;\nBut It don't return expected value\nGoogle_Service_Plus_Person::__set_state(array(   'collection_key' => 'urls',   'aboutMe' => NULL,   'ageRangeType' => 'Google_Service_Plus_PersonAgeRange',   'ageRangeDataType' => '',   'birthday' => NULL,   'braggingRights' => NULL,   'circledByCount' => 0,   'coverType' => 'Google_Service_Plus_PersonCover',   'coverDataType' => '',   'currentLocation' => NULL,   'displayName' => '',   'domain' => NULL,   'emailsType' => 'Google_Service_Plus_PersonEmails',   'emailsDataType' => 'array',   'etag' => '\"xw0en60W6-NurXn4VBU-CMjSPEw/0uxhj8-IvPqkPEvO9g0YNortZTk\"',   'gender' => NULL,   'id' => '101422423155895591717',   'imageType' => 'Google_Service_Plus_PersonImage',   'imageDataType' => '',   'isPlusUser' => false,   'kind' => 'plus#person',   'language' => NULL,   'nameType' => 'Google_Service_Plus_PersonName',   'nameDataType' => '',   'nickname' => NULL,   'objectType' => 'person',   'occupation' => NULL,   'organizationsType' => 'Google_Service_Plus_PersonOrganizations',   'organizationsDataType' => 'array',   'placesLivedType' => 'Google_Service_Plus_PersonPlacesLived',   'placesLivedDataType' => 'array',   'plusOneCount' => NULL,   'relationshipStatus' => NULL,   'skills' => NULL,   'tagline' => NULL,   'url' => NULL,   'urlsType' => 'Google_Service_Plus_PersonUrls',   'urlsDataType' => 'array',   'verified' => false,   'internal_gapi_mappings' =>   array (  ),   'modelData' =>   array (    'name' =>     array (      'familyName' => '',      'givenName' => '',    ),    'image' =>     array (      'url' => 'https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=50',      'isDefault' => true,    ),  ),   'processed' =>   array (  ),))\nThanks.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/889#issuecomment-231999772,\nor mute the thread\nhttps://github.com/notifications/unsubscribe/AAGWBVfx7VnyRUdr8KbjmylG61H_YarUks5qU2tngaJpZM4HrsUo\n.\n. The APIs exposed in this library mirror those available in the apis explorer, so if the APIs you are looking for exist there, this library supports them. A cursory search shows no WebMasters API, however some of the other APIs may perform these services.\n. @k0nG you don't need persistent disk - setAuthConfig supports an array argument. This allows flexibility with environment variables, or wherever you would like to store your credentials:\n\n``` php\n$auth = [\n  \"type\" => \"service_account\",\n  \"project_id\" => getenv('GOOGLE_PROJECT_ID'),\n  \"private_key\" => getenv('GOOGLE_API_PRIVATE_KEY'),\n  \"client_email\" => getenv('GOOGLE_API_CLIENT_EMAIL'),\n  \"client_id\" => getenv('GOOGLE_API_CLIENT_ID'),\n  \"auth_uri\" => \"https://accounts.google.com/o/oauth2/auth\",\n  \"token_uri\" => \"https://accounts.google.com/o/oauth2/token\",\n  \"auth_provider_x509_cert_url\" => \"https://www.googleapis.com/oauth2/v1/certs\",\n  \"client_x509_cert_url\" => getenv('GOOGLE_API_CLIENT_CERT_URL')\n];\n$client->setAuthConfig($auth);\n``\n. Good catch, we can pass this in by default.\n. This has been added to the README! See [Making HTTP Requests Directly](https://github.com/google/google-api-php-client#making-http-requests-directly)\n. Have you tried reauthorizing the user you are impersonating?\n. @jqr108 I wrote about a few ways you can do this [here](https://github.com/google/google-api-php-client/issues/801#issuecomment-171417538)\n. Yes, you're right. We should change this to accept aMemcache` class as the first argument, or an array of configuration parameters (host, port, etc).\n. Closing, as all Cache classes have been removed in favor of PSR-6\n. Hey Paddy! Yes, there is a 5.4-compatible version (see the travis builds passing here). However, you will need to install your dependencies manually with composer rather than downloading the release, because it requires the use of Guzzle5 rather than Guzzle6, which is the default.\nTry installing composer and running this in the root of your project:\ncomposer require guzzlehttp/guzzle:~5.2\ncomposer require google/apiclient:~2.0@RC\n. As long as the refresh_token key is set in the array passed to Google_Client::setAccessToken, the access token should be refreshed automatically.\nIf you're looking to save the access token somewhere, this is tricky, as it's not currently being saved back to the Google_Client. But it is stored in cache, so you could retrieve it using $client->getCache().\n. Haha, no problem! No, you're not the only one to have this issue. In the downstream auth library, we just added the method getLastReceivedToken to the credentials classes.  We have yet to expose this in Google_Client, but it would be nice to add a getLastReceivedToken to the client as well.  This would be done by saving the $credentials object that was created, and then calling the method on that.\nThe access token is retrieved when GuzzleHttp issues an http request (so when Google_Task_Runner run() is executed). So something like this:\n``` php\n$service = new Google_Service_Drive($client);\n$files = $service->files->list();\n$token = $client->getCache()->get(sprintf('%s:%s', $clientId, implode(':', $scopes)));\n```\nIt's not super elegant, but it should work.\n. something like this might work:\n``` php\nclass Google_Client\n{\n    // ...\n    public function authorize(...)\n    {\n        // ...\n        $this->setLastCredentials($credentials);\n    }\npublic function getLastReceivedToken()\n{\n    if ($credentials = $this->getLastCredentials()) {\n        return $credentials->getLastReceivedToken();\n    }\n}\n\n}\n```\nIt's the easiest way to solve this problem, but it's not very elegant. A callback would work, or a better Cache API that allows you to chain caches (i.e. storages) so that access tokens can be persisted elsewhere)\n. @jonnywilliamson PTAL at #905\n@aaronlague it is not possible to modify the expiration of an access token. You can request additional tokens using refresh tokens or service accounts.\n. @gsi-delmo I believe the issue is upon refreshing the token, the refresh token itself is not being persisted (see https://github.com/google/google-api-php-client/pull/1121). I was previously generating services for \"stable only\" apis (i.e. excluding alpha and beta releases).\nI'll run the generator again for the remaining APIs\n. fixed in https://github.com/google/google-api-php-client-services/commit/7e193165bf66445ae0a6dd2e760311b1f595317b (see Logging)\n. You'll want to use 1.1.* to use the YouTubeReporting service:\n\"google/apiclient\" : \"1.1.*\"\n. @tmatsuo PTAL\n. @tmatsuo yes, but that is the current behavior. I'm not quite sure what you mean by the last point, though.\n. @tmatsuo the code never allows for $credentials to be set at that point. The only other place it's set is at line e47.\n. Here are two options which may provide a better solution to this problem:\n1. The Google_Client class could provide a callback function to AuthHandlerFactory, which would be called when a brand new access token is fetched. We would need to add support to set a callback function in the AuthTokenSubscriber and AuthTokenMiddleware classes.\n2. A CacheInterface class called CallbackCache could be added. The callback cache essentially takes a callback function and an optional CacheInterface class as constructor arguments, and calls both of them when a new value is set. The auth library would not require modification for this.\n. Does anyone on this thread think implementing PSR-6 (#943), and in doing so supporting stash, is sufficient to solve this use-case? I can add something like setTokenCallback as a catch-all for any usecase (similar to #925), but this seems hackish and I am wondering if exposing this using a cache interface isn't the better way to handle it.  \nAll thoughts are welcome!\n. Check out this repo for a bunch of sample code. The resumable upload sample specifically should have what you're looking for. Note these samples use an earlier version of the client library (v1-master), but should still work.\n. This looks to be an environmental issue with your SSL setup. This SO article may help. Additionally you can try using the v2 version of this library, which supports Guzzle under the hood and so has better HTTP/SSL support.\n. It looks like you've included the code to this library directly into your module. You should use composer to pull the library in, as what you are doing is definitely not recommended:\ncomposer require google/apiclient:^1.1\nFollow the zf2 setup instructions for more information. Most likely, at some point you'll be adding require \"vendor/autoload.php\"; to your front controller (web/index.php)\nSo, just to be clear, there should be no \"module to integrate google api v3\" necessary. Just use composer. \nAlso, you've included your credentials in your repo (here and here). You will want to delete these credentials from the Cloud Console and make new ones, as they are now insecure.\n. Hi @JBerkvens, can you include the code you're using? \n. There are samples for using Google+ here for the v1-master branch. We'll try to get them updated soon, but it's a good place to start.\n. I do not think this API is included as one of this library's API Services. However, if the Google Play Billing API supports HTTP, you can use this library by Making HTTP Requests Directly.\n. You are running a version of PHP not supported by this library. PHP 5.4 and higher are required for this library.\n. @waprin  @tmatsuo  PTAL\n. Unfortunately this is not that simple. as this library supports v2.0 of firebase as well, which does not use the namespace\n. It would be best to do the following:\n``` php\nuse Firebase\\JWT\\ExpiredException as ExpiredExceptionV3;\n//and then below\ntry {\n    //...\n} catch (ExpiredException $e) {\n    //...\n} catch (ExpiredExceptionV3 $e) {\n    //...\n}\n```\n. added in bb90330039782d1dbcfd8a560740efd032ee4283\nThanks!\n. What was your solution?\n. It's almost certainly because you are using a case-insensitive OSX filesystem, so the only way it can update the file is if you blow the directory away and run composer install again. Good ol' OSX \ud83d\ude04 \n. Sorry, I am not exactly sure what you are trying to do or what the issue is here.\n. I'm not exactly sure what you're referring to. The calendar patch is supported (see here and here). We don't have specific documentation for every single call, but the API is formulaic. You should be able to call it like this:\nphp\n$client = new Google_Client;\n$client->useApplicationDefaultCredentials();\n$event = new Google_Service_Calendar_Event; \n$event->setEtag('foo'); // presumably make some change to patch\n$calendar = new Google_Service_Calendar($client);\n$response = $calendar->events->patch($calendarId, $eventId, $event);\nAlso, if you want to just make an authenticated HTTP request to the API directly (without using the generated classes) this is always possible as well:\nphp\n$client = new Google_Client;\n$client->useApplicationDefaultCredentials();\n$http = $client->authorize();\n$url = sprintf('https://www.googleapis.com/calendar/v3/calendars/%s/events/%s', $calendarId, $eventId);\n$patchBody = [\n   'etag' => 'foo'\n];\n$response = $http->patch($url, ['body' => $patchBody]);\n. closing as duplicate of #923\n. Use guzzle5 instead:\nbash\ncomposer require guzzlehttp\\guzzle:~5.2\nGuzzle 6 is not compatible with php 5.4\n. Google/apiclient 2.0@RC pulls in apiclient-services. It is redundant to\ninclude it in your composer.json\nOn Fri, Apr 15, 2016 at 2:19 AM Hannes Kirsman notifications@github.com\nwrote:\n\nOk, it's available in apiclient-services so instead of (in composer.json):\n{\n    \"require\": {\n        \"google/apiclient\": \"^2.0.0@RC\"\n    }\n}\nI do this:\n{\n    \"require\": {\n        \"google/apiclient\": \"2.0.0-RC7\",\n        \"google/apiclient-services\": \"@dev\"\n    }\n}\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/927#issuecomment-210377675\n. This was added in RC7, so it is possible you were previously on RC6 or\nbelow and had not run \"composer update\" since RC7 was added.\nOn Fri, Apr 15, 2016 at 9:49 AM Hannes Kirsman notifications@github.com\nwrote:\nPretty sure it didn't. But I'll recheck.\n\u2014\nYou are receiving this because you commented.\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/927#issuecomment-210543300\n. You're right, composer was skipping RC7 in favor of RC6 unless the minimum stability flag was explicitly set to dev.\n\nI fixed this by tagging the v0.1 release in client services. Try to update and see if that fixed it.\n. Hi @cyphix333! Sorry you're having trouble. Can you explain what commands you used to download the library that didn't work?\nYou can install via composer (as recommended by the documentation above) or download from the releases page. Either method should include the YouTube.php file.\n. @cyphix333 if you click on google-api-php-client-2.0.0-RC7.zip on the release page, you will download a package with all the dependencies. The YouTube.php class is at vendor/google/apiclient-services/Google/Service/YouTube.php:\n\n. No, just the ones for the service you're using, i.e. 'YouTube.php' and everything in the YouTube/ directory.\n. Please provide a sample of your code so that we can reproduce the issue.\n. Have you tried passing this in to the $config array in the Guzzle Client's constructor (GuzzleHttp\\Client::__construct($config))? These options are merged with the request options in prepareDefaults. Try this instead:\nphp\n$http = new GuzzleHttp\\Client(/* pass options here */);\n$client->setHttpClient($http);\n// make your request...\n. @Sharma-Ravin You have probably downloaded the wrong kind of credentials. Try downloading a new set of client credentials.. Download them from https://console.cloud.google.com/apis/credentials. This same change will be added in #943\n. @matanc244 The problem is you are not using the recommended way for autoloading your classes. Replace everything before $project_id with this:\nphp\nrequire_once '/PATH/TO/google-api-php-client/vendor/autload.php';\nAlso make sure you've followed the Install instructions in the README\n. You are right, for the v1 version of this library these options are not available. You can see in the current version they are supported as part of the CdnSettings object.\n. Once #952 is merged, you will be able to get the latest services using composer:\ncomposer require google/apiclient-services\nThen, as long as you include composer's autoloader, you'll use the updated services instead of the services included directly in google/apiclient:v1\n. This is now fixed, and the latest service classes can be used in v1-master. See the README \n. You need to install composer and run composer install \"google/apiclient:^2.0@RC\" in the root of your project.\n. I am leaning towards the following implementation:\n- Implement PSR6\n- Remove CacheInterface from google/auth\n- Remove all files in src/Google/Cache except for the file cache\n- Use File Cache as the default for storing certs\n- That's it!\nPros:\n- Easy\n- Simplified\n- A default cache is provided\n- We aren't depending on any 3rd party caching library\n  Cons:\n- There is still no per-session caching of tokens \n- It's still not straightforward when a token has been received. We will need to document this.\n. Added in #108\n. What you are doing looks correct. It does seem like refreshTokenWithAssertion is not successfully fetching the token.\nI would debug what is being returned first, and see if that sheds any light on the issue.  If a JSON error is the response from the HTTP server, then that error will be returned from refreshTokenWithAssertion:\nphp\nif ($client->isAccessTokenExpired()) {\n    $result = $client->refreshTokenWithAssertion();\n    if (!isset($result['access_token'])) {\n        throw new \\Exception('unexpected response: ' . json_encode($result));\n    }\n    $oauth2Token = $result['access_token'];\n}\nIf that doesn't work, you should be able to use a web proxy like Charles to debug the HTTP request going across the wire:\nphp\n$client = new Google_Client;\n$http = new GuzzleHttp\\Client([\n    'proxy' => 'localhost:8888', // this is where charles is running\n    'verify' => false,\n]);\n$client->setHttpClient($http);\n. This issue has been closed due a lack of response. Please reopen with more information if the problem is still occurring. \n. @tmatsuo @SurferJeffAtGoogle PTAL\n. @tmatsuo - yes that's correct. A user needs to install a psr-6 compatible caching library like Stash. Additionally they can supply an anonymous function as a \"token callback\" which will get called whenever a new token is fetched. \nI will add all this to the README. \n. @tmatsuo PTAL!\n. @tmatsuo you can guess the cache key, but there's no easy way to expose this. Also, being able to query the cache and see if a token has changed isn't as clean as providing a callback.\nI agree the callback isn't strictly necessary, but i do think it's a very nice feature for some use cases (see #901)\n. Service accounts have their own user id for Drive, so you can access those files via the service account, but (AFAIK) you can't log in and see them in the UI anywhere.\n. What is the error you are receiving? Please provide all relevant code and output so we can help identify the issue.\n. @mgodinez98 @khurramar\nThis sample is out-of-date. I've submitted a PR to fix it. In the meantime, commentThreads and comments are definitely a part of YouTube.php.\nTry using the composer autoloader:\n``` php\nif installing via composer\nrequire_once '/path/to/my-project/vendor/autoload.php';\nIf installing via downloaded release\nrequire_once '/path/to/google-api-php-client/vendor/autoload.php';\n```\nEverything else should be the same. Let me know if you have any other questions.\n. I do not have any experience with the FusionTables API, but the classes here are up to date. Are you sure your version of this library is up to date?\nIf so, try your changes in the API Explorer. My guess is the inputs you are using to the API itself are wrong, and it is not a problem with this library.\n. This issue tracker is meant only for problems with the library itself, as it would be too difficult for the maintainers of this library to support all the APIs. Please post your question regarding the APIs to Stack Overflow with the tag google-api. If it turns out to be a problem with this library, you're welcome to open another issue.\n. Hmm, so your first example is the correct way to do it (although the URL encoding will happen in the client library, so you can omit it). I think you are just not using the Google_Services_Plus_Person object correctly:\nphp\n$me = $plus->people->get('me', ['fields' => 'id,gender,name,image,placesLived']);\nvar_dump(\n      $person->getId(),\n      $person->getGender(),\n      $person->getName(),\n      $person->getImage(),\n      $person->getPlacesLived()\n);\nI received all expected fields this way, and the following output:\nstring(21) \"123456\"\nstring(4) \"male\"\nobject(Google_Service_Plus_PersonName)#42 (9) {\n  [\"familyName\"]=>\n  string(7) \"Shaffer\"\n  [\"formatted\"]=>\n  NULL\n  [\"givenName\"]=>\n  string(5) \"Brent\"\n  [\"honorificPrefix\"]=>\n  NULL\n  [\"honorificSuffix\"]=>\n  NULL\n  [\"middleName\"]=>\n  NULL\n  [\"internal_gapi_mappings\":protected]=>\n  array(0) {\n  }\n  [\"modelData\":protected]=>\n  array(0) {\n  }\n  [\"processed\":protected]=>\n  array(0) {\n  }\n}\nobject(Google_Service_Plus_PersonImage)#43 (5) {\n  [\"isDefault\"]=>\n  bool(false)\n  [\"url\"]=>\n  string(98) \"https://lh6.googleusercontent.com/-lnY_UaDfCIs/AAAAAAAAAAI/AAAAAAAABDQ/iXVuceKN6Pc/photo.jpg?sz=50\"\n  [\"internal_gapi_mappings\":protected]=>\n  array(0) {\n  }\n  [\"modelData\":protected]=>\n  array(0) {\n  }\n  [\"processed\":protected]=>\n  array(0) {\n  }\n}\narray(7) {\n  [0]=>\n  object(Google_Service_Plus_PersonPlacesLived)#48 (5) {\n    [\"primary\"]=>\n    bool(true)\n    [\"value\"]=>\n    string(17) \"San Francisco, CA\"\n    [\"internal_gapi_mappings\":protected]=>\n    array(0) {\n    }\n    [\"modelData\":protected]=>\n    array(0) {\n    }\n    [\"processed\":protected]=>\n    array(0) {\n    }\n  }\n  // ...\n}\nPlease note I'm using the master branch of this library, so some things may not be identical, but in general this should be no different.\n. Looks great! Thanks.\n. Have you configured the above scope for domain-wide delegation? Follow these steps if not.\n. Closing - I'm assuming the issue was the need to grant domain-wide delegation to the scopes being used.  Please comment here if that is incorrect.\n. \"Build 1337\" has passed. It's going to be a good day.\n. This also allows anyone using v1-master to use the latest google services simply by requiring the composer package:\nphp\ncomposer install google/apiclient-services\nAnd the autoloader will load these services before executing the custom autoloader! woohoo.\n. I am closing this as it's an issue with your environment and not this library. I imagine it is an issue with certain versions of PHP on windows.\n. This is being added to the underlying auth library in https://github.com/google/google-auth-library-php/pull/126\n. Added in #1019 \n. You may need to set the attendee's id in order to add them to an event.\nphp\n$attendee->setId($attendeeId);\n. This sounds like an API problem and not a problem with this library. Please post your question to Stack Overflow with the tag google-api. If it turns out to be a problem with this library, you're welcome to open another issue.\n. @sergicurtu thanks for the heads up! These models have been created here. \nIf you want the latest version, just request the master branch of google/apiclient-services:\njson\n{\n    \"require\": {\n        \"google/apiclient\": \"^2.0.0@RC\",\n        \"google/apiclient-services\": \"dev-master\"\n    }\n}\n. These files are autogenerated, so this change would get overwritten. \nIf you're wanting to use this updated models in v1, follow the instructions here and let me know if you have any problems.\n. How are you managing autoloading? Are you including vendor/autoload.php at the top of your PHP file?\n. Ahh, I think I know the issue. Try using the version dev-v1-master:\ncomposer require google/apiclient:dev-v1-master\nor in composer.json:\njson\n{\n    \"require\": {\n        \"google/apiclient\": \"dev-v1-master\"\n    }\n}\n. \ud83d\udc4d great!\n. For the record, you can install with composer using the flag --ignore-platform-reqs, and you'll be able to get around the PHP version issue. Also, I can update google/apiclient-services to run on PHP 5.3, as I don't think 5.4 is actually required.\n. I don't know. Have you tried using the APIs explorer to verify your outbound request? Most likely this is an issue with the parameters/methods used to call the API, and not an issue with this library.\n. This sounds like an API problem and not a problem with this library. Please post your question to Stack Overflow with the tag google-api. If it turns out to be a problem with this library, you're welcome to open another issue.\n. @notredamstra the sheets class (if you follow the tutorial) is available here. Make sure you include the -b v1-master in your git clone command, so that you pull down the right branch. Also be sure you're including vendor/autoload.php at the top of your php file.\n. Thanks for reporting this! You're right, the command was not pulling in the Sheets.php file because it had not been tagged with a stable release.\nI've tagged version 1.1.8 so this is now good to go. Try running the composer command again:\nsh\ncomposer clear-cache\ncomposer require google/apiclient:1.*\n. See The Storage FAQ for an answer to this question:\n\nHow can I get a summary of daily space usage?\nYou can use the gsutil du command to display the total space used by all objects for a specified bucket. For example, to get the total space used by all objects in the bucket \"bucketname\", use the command:\ngsutil du -sh gs://bucketname\nSee the du command help for more options you can use, including how to return the size of all objects underneath a prefix. \nYou can also set up bucket logging where the total size of a bucket is automatically reported once a day. For more information, see Access Logs & Storage Data. If the number of objects in your bucket is large (e.g., hundreds of thousands or millions), this is a much more efficient way to track space usage. The gsutil du command calculates space usage by making bucket listing requests, which can take a long time for large buckets.\n. Please note that this issue tracker is only for this client library. We do not maintain the APIs that this client library talks to. If you have an issue or questions with how to use a particular API, you are better off posting on Stackoverflow under the google-api tag.\n\nThat being said, you could try using the JSON API to pull down the access logs and derive your usage from there.\n. This is an interesting error. You can see here that Stash\\Pool::save does exist. Is it possible you're using a different, older version of Stash?\n. @bencromwell I have opened a PR to fix this, but please tell me why it's so important to use guzzlehttp/psr7:1.3.0?\n. @bencromwell try adding \"google/apiclient\": \"^2.0\" directly to composer.json and running composer update and you'll have a better time.\nComposer won't update your existing deps unless you run composer update, so it behaves differently when you simply use composer require, and in this case, throws an error.\n. addresses #969\n. @manojmilani123 have you tried adding this dependency directly to your composer file and running composer update? i.e.:\njson\n{\n  \"require\": {\n    \"some-depencdency\": \"...\",\n    \"google/apiclient\": \"^2.0\",\n  }\n}\nAnd now run composer update. This should install the library successfully.\n. see this duplicate issue\n. Try adding \"google/apiclient\": \"^2.0\" directly to composer.json and running composer update and you'll have a better time.\nComposer won't update your existing deps unless you run composer update, so it behaves differently when you simply use composer require, and in this case, throws an error.. @AwesomeBobX64 this is not the correct way to handle this problem. composer.lock is not supposed to be committed to utility libraries such as these, and only to deployed applications.\nWhat you need to do is declare a composer.json in your own application, which will generate its own composer.lock that you can then commit. Because this library locks google/apiclient-services to @dev, it's actually allowing you to define v0.2 OR v0.3 in your own project. So if you want to lock to a specific version of google/apiclient-services in your project, use a composer.lock file, or tag the services package in composer.json to a specific version like this:\njson\n{\n    \"require\": {\n        \"google/apiclient\": \"^2.0\",\n        \"google/apiclient-services\": \"v0.2\"\n    }\n}\n. @AlecHFerguson If this library included a composer.lock file, it would not have any affect in your project. Instead, your library should include a composer.lock file to lock these dependencies.\nThe downstream google/apiclient-services repository has 100+ APIs which are often updated. They do not follow semantic versioning, which makes it impossible to provide both the flexibility to update to the latest version and the guarantee that updating won't break your code. \nThe current implementation allows you to lock the downstream google/apiclient-services dependency to a version if you need to, or get the latest APIs when desired.\n. @AwesomeBobX64 \nYour PR does two things:\n1. Includes a composer.lock - this will have no effect for projects pulling this library in as a dependency. The linked-to article refers to committing the lock file for applications, but this repository is not an application, it is a dependency, and therefore does not need a lock file. \n2. Sets the dependency for google/apiclient-services to v0.2. This is too strict of a requirement, as the APIs are constantly updating. \n. I have explained the rationality behind these decisions, as well as how composer lock files work. There is nothing more to consider.\n. You should be able to make a patch request and change the name in the request body. \nIf not, you can definitely copy it.\n. This question was answered on Stack Overflow here. Try following the same steps, and if that does not work, try checking out these other resources on datastore errors and error handling:\n- https://cloud.google.com/appengine/articles/handling_datastore_errors\n- https://cloud.google.com/appengine/articles/deadlineexceedederrors\n- https://cloud.google.com/datastore/docs/concepts/errors\n. You solved this on Stack Overflow already, but to answer your question this was fixed in the v1-master branch in #644\n. phpseclib in this library is v2.0. In laravel 4.2 they require 0.3.*\n. Try installing laravel 5.2 or use v1-master of this library to get around the issue. We could also consider moving phpseclib to an optional dependency, if this continues to be a problem\n. Yes, you're using Client Credentials, which are used to retrieve an OAuth2 access token from a third party. Try downloading the Service Account Credentials for your project instead.\n. Have you tried using an empty string instead of null values? \n. @madebyrogal can you inspect what your JSON payload looks like and add it here? \n. @madebyrogal have you tried using Google_Model::NULL_VALUE?\n. Looks like you are not providing any authentication (hence the 401 Unauthorized status code)\n. Make sure the environment variable GOOGLE_APPLICATION_CREDENTIALS is set, and is a valid path to the service account credentials on your machine.\nphp\nputenv('GOOGLE_APPLICATION_CREDENTIALS=/path/to/my-project-credentials.json');\n. Why is 5 days too long? Also cache invalidation should not handled by this library, but by the PSR-6 compatible caching libraries.\n. Hmm, I cannot replicate this issue. What PHP version are you using? Can you provide a test for this which fails without it?\n. My Code:\nphp\n$unicode='{\n    \"name\": \"From\",\n     \"value\": \"\\\"OneTwoTrip!\\\" \\u003cnewsletter@onetwotrip.com\\u003e\"\n}';\nvar_dump(json_decode($unicode, true));\n// array(2) {\n//   'name' =>\n//   string(4) \"From\"\n//   'value' =>\n//   string(41) \"\"OneTwoTrip!\" <newsletter@onetwotrip.com>\"\n// }\nvar_dump(json_decode(preg_replace('/\\\\\\u([0-9a-z]{4})/', '&#x$1;', $unicode), true));\n// array(2) {\n//   'name' =>\n//   string(4) \"From\"\n//   'value' =>\n//   string(55) \"\"OneTwoTrip!\" &#x003c;newsletter@onetwotrip.com&#x003e;\"\n// }\n. This is because the $accessToken variable being supplied to Google_Client::setAccessToken is not in the proper format. The error is thrown when the array key access_token does not exist. \nThis is because your call to Google_Client::authenticate is returning an error response. The error is JSON when it comes back from the API, so it's returned as an array.  Try var_dump($accessToken); to see what the error is.\n. @vishnupratap82 This is because the package available for downloads contains the installed dependencies for the platform it was installed on. To update the dependencies for your own platform, run the composer command locally:\nsh\ncd /path/to/google-api-php-client-2.0.1\ncomposer install\nSince this may be a common problem, I've made a PHP 5.4 specific release available for download.\n. This is definitely a bug - submitting the token string should definitely supported. I've fixed it in the linked PR. Thanks for finding this!\n. @orvice What proxy application are you using? It looks like your proxy is listening on a different port. Try changing my example code to:\nphp\n$httpClient = new GuzzleHttp\\Client([\n    'proxy' => '127.0.0.1:10245', // since this is what yours is running on\n    'verify' => false, // otherwise HTTPS requests will fail.\n]);\n. What proxy software are you using? And what are you using the proxy for?\n. Using privoxy, I was able to do the following and get this to work:\nphp\n$httpClient = new GuzzleHttp\\Client([\n    'proxy' => '127.0.0.1:8118', // this is the default privoxy port\n    'verify' => false, // otherwise HTTPS requests will fail (THIS IS FOR DEBUGGING ONLY)\n]);\n. Verify your setAuthConfig file exists. You should always supply the absolute path to your credentials file, i.e:\nphp\n$credentialsFile = '/full/path/to/myfile.json';\n$client->setAuthConfig($credentialsFile);\n. The error states the use of the file src/Google/autoload.php is deprecated, and instead you need to use vendor/autoload.php. If you follow what the error states, and update all includes to the new file location, the error will be resolved. i.e:\nphp\n// what you have now:\nrequire_once '/path/to/google-api-php-client/src/Google/autoload.php';\n// what you should update it to:\nrequire_once '/path/to/google-api-php-client/vendor/autoload.php';\n. @nmartin4321 You need to either download the package and dependencies found in the releases section, or install via composer\n. Make sure your call to setAuthConfig is an absolute path and that you've renamed the file you download from the Developer Console to client_secrets.json. :\nphp\n$client->setAuthConfig('/path/to/client_secrets.json');\nYou do not need to use json_decode, and the deprecated error is being thrown as a result of an error in your local development setup, and not because of this library.\n. One of the reasons you're having a hard time is you're using the v3 samples, which are older and outdated. Try using the Analytics v4 quickstart instead.\n. closing in favor of https://github.com/google/google-api-php-client-services/pull/25\n. @AwesomeBobX64 We appreciate your feedback on how tying google/apiclient-services to @dev has been inconvenient for you.  I've added https://github.com/google/google-api-php-client-services/issues/23 to track a feature that will help remove @dev while still allowing users to keep their APIs up-to-date.\nAs stated, composer.lock would have no affect on projects that depend on this package, so I am closing this issue.\n. The error states the use of the file src/Google/autoload.php is deprecated, and instead you need to use vendor/autoload.php. If you follow what the error states, and update all includes to the new file location, the error will be resolved. i.e:\nphp\n// what you have now:\nrequire_once '/path/to/google-api-php-client/src/Google/autoload.php';\n// what you should update it to:\nrequire_once '/path/to/google-api-php-client/vendor/autoload.php';\n. This sounds like an API problem and not a problem with this library. Please post your question to Stack Overflow with the tag google-api. If it turns out to be a problem with this library, you're welcome to open another issue.\n. @thegregthomp can you include some node sample code so we can test this?\n. Probably because it's not at all official or supported \ud83d\ude04 \nI'm glad it was helpful though. I will see about getting it published.\n. No, I'm talking about the flow itself. I suggest opening a Stack Overflow ticket with your code and posting the link here, and I'll try to help you figure it out. Sounds like you're struggling with the Auth and not the API, yes?\n. thanks!\n. The \"auto-approval\" happens when a user has already accepted the authorization prompt, and so is not prompted again. A refresh token is not returned in this case. You can read more about this here.\nI assume when you generate the auth URL (using $client->createAuthUrl), you are not setting approval_prompt=force. You can check this by inspecting the URL's query parameters directly. Setting $client->setApprovalPrompt() in the code above will have no effect, this only has effect if added before the authorization URL is created.\n. @shubaivan it sounds like you figured it out, but if you continue to have issues, I suggest filing an issue with HWIOBundle.\n. The variable is only used when running our test suite, but the latest release will be affected due to it having the wrong guzzle version. We will update this.\n. fixed in 2.0.2\n. Yes, see the class files here and here. Please note the name of this API may change to CloudNaturalLanguage (dropping the API) in the future, since the current name is not consistent with the other API class names.\n. v2 is stable, and is the correct version to use. \nAll versions of this library are technically in \"BETA\", even stable ones. This label does not mean beta in the semantic-versioning sense, but in the \"there is no SLA or dedicated team working on it\" sense.\n. Thanks for this, @mike42 \n@twenttwo Yes, try using the v1-master branch instead:\nsh\ngit clone -b v1-master git@github.com:google/google-api-php-client.git\n. This should now be fixed. Which release are you looking at?  Try downloading the release again and comment here if you still see the files.\n. This sounds like an API problem and not a problem with this library. Please post your question to Stack Overflow with the tag google-api. If it turns out to be a problem with this library, you're welcome to open another issue.\n. This may be a bug in the way the API is documented. This client library is generated from the API discovery doc, and the Storage API Explorer shows the same behavior of having \"contentType\", but not \"mimeType\".\n. There are various solutions mentioned in https://github.com/google/google-api-php-client/issues/788 that may help. To summarize, the options are this:\n1. Download the cacert.pem file\n2. Do one of the following\n   -  set curl.cainfo = \"PATH_TO/cacert.pem\" in php.ini\n   - pass the file in the verify option to your Guzzle client, i.e.:\n ``` php\n $client->setHttpClient(new \\GuzzleHttp\\Client(array(\n     'verify' => 'C:\\Windows\\curl-ca-bundle.crt',\n )));\n ```\n\n. This sounds like an API problem and not a problem with this library. Please post your question to Stack Overflow with the tag google-api. If it turns out to be a problem with this library, you're welcome to open another issue.\n. Thank you for finding this! This is now fixed in the latest release (google-api-php-client-2.0.2), and we'll be sure to fix this going forward as well.\n. I have since updated the zip file. Will you check and verify the permissions are now correct?\n. The Knowledge Graph API accepts an API key, so there is no access token scope. Try this instead:\n``` php\nclass KGSearchTest extends \\PHPUnit_Framework_TestCase\n{\n    public function testKGSearchCall()\n    {\n        $client = new \\Google_Client;\n        $client->setDeveloperKey($yourApiKey);\n    $result = (new \\Google_Service_Kgsearch($client))->entities->search(['ids' => '/m/012_05dm']);\n\n}\n```\nThis API is not (yet) able to be accessed via access token.\n. This sounds like an API problem and not a problem with this library. Please post your question to Stack Overflow with the tag google-api. If it turns out to be a problem with this library, you're welcome to open another issue.\n. You need to use Guzzle 5 for PHP 5.4:\nbash\ncomposer require guzzlehttp/guzzle:~5.2\nOr download the PHP54-specific release on the Releases page.\n. You have opened up a pull request. Please open an issue if you have a question regarding this library.\n. If you use the classes included in this library, you will be using Analytics Reporting v4. You can tell by viewing the \"version\" property of Google_Service_AnalyticsReporting here.  So if you instantiate the client like so, you'll be off to the races:\n``` php\n// install this library by running \"composer install google/apiclient\"\ninclude DIR . '/vendor/autoload.php';\n// now create your client, etc and go to town!\n$client = new Google_Client();\n$client->useApplicationDefaultCredentials();\n$analytics = new Google_Service_AnalyticsReporting();\n```\nNow, following the rest of the example in the doc you supplied, you'd end up with something like this:\n``` php\n// Replace with your view ID, for example XXXX.\n$VIEW_ID = \"\";\n// Create the DateRange object.\n$dateRange = new Google_Service_AnalyticsReporting_DateRange();\n$dateRange->setStartDate(\"7daysAgo\");\n$dateRange->setEndDate(\"today\");\n// Create the Metrics object.\n$sessions = new Google_Service_AnalyticsReporting_Metric();\n$sessions->setExpression(\"ga:sessions\");\n$sessions->setAlias(\"sessions\");\n// Create the ReportRequest object.\n$request = new Google_Service_AnalyticsReporting_ReportRequest();\n$request->setViewId($VIEW_ID);\n$request->setDateRanges($dateRange);\n$request->setMetrics(array($sessions));\n$body = new Google_Service_AnalyticsReporting_GetReportsRequest();\n$body->setReportRequests( array( $request) );\n$response = $analytics->reports->batchGet( $body );\n```\nGood luck! Please reopen an issue if you have another problem.\n. v1.1.7 is on Drive v2 see here\nv1.1.8 is on Drive v3 see here\nThe versioning of this library does not reflect major version changes in the API, unfortunately (see https://github.com/google/google-api-php-client-services/issues/23), so this is WAD. Sorry for the inconvenience.\n. Try this:\nphp\n$client = new Google_Client;\n$logger = new Monolog\\Logger('google-api-php-client');\n$logger->pushHandler(new Monolog\\Handler\\SyslogHandler('app'));\n$client->setLogger($logger);\nThe way to mitigate this would be to call $this->isAppEngine() in Google_Client::createDefaultLogger. If you want to submit a PR with tests for this, I'd be happy to merge it!\n. I submitted #1025 to address this in the library. If you want to pull down my branch and let me know if it works for you, that would be greatly appreciated\ncomposer require google/apiclient:dev-fix-default-logger-for-appengine\n. can you confirm this is now fixed in master?\n. The getErrors function is for errors that return from the APIs in this format:\njson\n{\n    \"error\": {\n        \"errors\": [\n            { \"code\": 400, \"message\": \"error message\" }\n        ]\n    }\n}\nYeah this isn't great in the scenario you described, but that's an auth error, and has a different error format than the API errors. So unfortunately this particular issue is probably WAD.\n. Working as Designed\n. We could check for the auth error format also.\n. good catch, thank you!\n. looks good, thanks for finding this!\n. @cmcfadden This is interesting, I take it you've installed the tedivm/stash dependency to use the File cache?\n. I agree this would be great! Unfortunately, these libraries are auto-generated, and at this time we do not plan to support DateTime objects, as we do not have a way to automatically distinguish a \"date time\" parameter from a \"string\" parameter in the API. \n. You have to use composer to install the dependencies of the library. See the README for more information\n. You're right, these should be linking to v1-master\n. FYI Short Array Syntax was added in PHP 5.4.\n. Wow, I'm pretty shocked it's allowed to change the default behavior here. This would break many implementations, not just ours. Any idea what the use case is?  I assume this was added for sites using PHP as a glorified templating language.\n. I agree this is a better solution than calling ini_set. ini parameters should never be set by a 3rd party.\n. I'm a little confused as to what effect this has, since we provide a single parameter, and so will not require a separator. i.e. this will always output the following, regardless of what the default separator is set to:\nstring() \"token=TOKENSTRING\"\nIt would be great to have a test to cover this, so we can be sure it'll fix the issue.\n. It would be great to have test coverage for this.\n. I'd rather do this:\nphp\n// tests/Google/AccessToken/VerifyTest.php\n//...\npublic function testHttpBuildQuery()\n{\n    $argSeparatorOutput = ini_get('arg_separator.output');\n    ini_set('arg_separator.output', '&amp;');\n    // do test \n    ini_set('arg_separator.output', $argSeparatorOutput);\n}\n//...\n. @chriscct7 alternatively, you can give me collaboration access to your fork and I'll make the change.\n. Sorry for the delay as well! Merged, thank you.. This was added in https://github.com/google/google-api-php-client/pull/1082. I updated your code snippet and removed your credentials, but you must change them immediately since you posted them publicly.\n. Run composer update and make sure you have the latest version. It's possible you updated just the code for this library and not the corresponding updates to the vendored libraries.\n. This is fixed and has been tagged in v2.1.0. Running composer update should update you to the latest version as long as your version is google/apiclient: ^2.0\n. @developerside @globe194 This exception is being thrown because the path supplied to setAuthConfig does not exist. See the code here for reference.\nWhatever path you've defined as CLIENT_SECRET_PATH is either not the correct path to your credentials file, or the file is unreadable (i.e. the web server does not have permissions to open the file).  Here's what you can do to fix this:\n\n\nVerify the path to your file is what you think it is:\n    php\n    var_dump(CLIENT_SECRET_PATH);\n    // this will output your file path before the exception is thrown\n\n\nVerify the file exists\n    sh\n    $ cat /path/to/yourfile.json\n\n\nVerify the file is readable\n    sh\n    $ chmod a+r /path/to/yourfile.json\n\n\n. Sounds like you have it figured out. Yes, tedvim/stash is an optional dependency. I have never seen the behavior where class_exists throws a warning, that is quite unfortunate.\n. @Nimeshka which version of this library are you using? The most recent tag of the client-services repo has support for the q parameter.\n. Please upgrade to v2 to resolve this issue:\ncompose require google/apiclient:^2. This file is auto-generated, and so cannot be modified with a pull request. I'll run the code generator and see if this addresses your issue.\nAlso please upgrade to the master branch, as v1-master is deprecated.\n. Is there a specific reason you need Firebase 4.0?\n. This change will not have an affect as long as google/auth requires ~3.0. This change should fix that: https://github.com/google/google-auth-library-php/pull/137. I will merge this as soon as this is tagged and updated\n. This was merged into master in #1082\n. @LetterboxDelivery is right - the refresh token is only delivered the first time an application is authorized. \nWe could add the refresh token back to the in-memory access token, but this is not a guaranteed fix, as the access token can be cached at the auth level. I do think it would be an improvement, however.\n. Everyone please take a look at #1121. You can accomplish this using batch requests:\nphp\n    $client = $this->getClient();\n    $batch = new Google_Http_Batch($client);\n    $plus = new Google_Service_Storage($client);\n    $client->setUseBatch(true);\n    foreach ($files as $i => $file) {\n        $batch->add($storage->objects->delete($bucket, $file), $i);\n    }\n    $result = $batch->execute();\n. Thanks!\n. Are you using Guzzle 5.3 on PHP 7.1? As you can see from composer.json, this library supports the current version of guzzle. Guzzle 5.3 is only available for backwards compatibility. \nHow is it that Guzzle 5.3 came to be installed instead of Guzzle 6? It could be another package requires guzzle 5.3. Try adding guzzle 6 explicitly to your composer.json:\nsh\ncomposer require \"guzzlehttp/guzzle:^6.0\". For others encountering this issue, @SerafimArts and @acrolink can you provide more information on how you installed this library and if the above command fixes the issue?. It's also possible your project contains a composer.lock file set to the previous version. In this case, run the following command to update all dependencies to the latest versions:\nsh\ncomposer update. This has been fixed by bumping the minimum required version of Guzzle to 5.3.1.. @willemstuursma thank you!. Can you verify the token going across HTTP is the expected access token? Can you see what class is coming back with $client->getCache()? \n. I am looking into this. Can you provide a stack trace for the Invalid Credentials error?\nI believe the problem may be the refresh token is not being persisted in the in-memory cache.\n. Changing the scopes uses a different cache key. This is almost certainly why that fixes the issue. But if you're using in-memory cache, I would think the tokens wouldn't persist enough for it to matter.\n. Thanks for the update @omnicodagithub ! Ahh how the plot thickens.\nCould you do two things for me please? \n1. Comment here with a stack trace. \n2. Use Charles Proxy to obtain the HTTP request of the call, and ensure that the requests going to www.googleapis.com/auth (to retrieve access tokens) and the requests going to www.googleapis.com/API_NAME (to make the api call) match what you'd expect, i.e. the client credentials, access token from the database, etc.\nSet up the proxy by adding this when you create your client:\nphp\n$options = [\n    'proxy' => 'localhost:8888', // the default for charles\n    'verify' => false,\n];\n$httpClient = new GuzzleHttp\\Client($options);\n$client->setHttpClient($httpClient);\n. @omnicodagithub  hmm, if you've told the Google_Client object to use application default credentials, it will use those instead of the access token.  In your code above you call useApplicationDefaultCredentials. Are you calling $client->setAccessToken in the same call?\nDigging deeper into this, it appears that the explicitly-set Access Token bypasses the cache, and so shouldn't be affected.\nIs it possible you're using two different service accounts? Have you tried rolling back to v2.0.2 as suggested above?\n. You shouldn't need to manually clear the cache. This implies the cache is not invalidated properly. Looking in the code, a token being received should expire after 1500 seconds. \nCan you call var_dump(get_class($client->getCache())); and tell me what you get?\n. To fix this in the auth library, I've added https://github.com/google/google-auth-library-php/pull/138, which is not ideal (the call should be unnecessary) but will get the job done.\nAnother option would be to stop using tedivm/stash by default, which is what we should have done to start, but it would break B.C.\n. @BVMiko while i agree with this fix because of the quote from PSR-6, it looks like stash ensures the isHit property is false before returning anything with get, so that either way the function returns null (see here). So at least with the Stash implementation, I do not see how this will fix the issues described.. Looks like I added that 8 months ago... . Okay, I just figured out what's going on. Two weeks before your PR, a new version of Stash was finally tagged with the fix I added 8 months ago. So this is now fixed with v0.14.2.\nSince the PSR-6 spec says the calling library SHOULD verify the cache hit, the changes in #150 are valid, even though the spec ALSO says get should return NULL if there is no hit (making the call to isHit unnecessary).\nEither way this issue is fixed!. The comment above the code block essentially says \"Subtract the proxy header size for cURL >=7.30.0\". needsQuirk returns true when the cURL version is <7.30.0. \nphp\n        // Subtract the proxy header size unless the cURL bug prior to 7.30.0\n        // is present which prevented the proxy header size from being taken into\n        // account.\n        if (!$this->needsQuirk()) {\n            $headerSize -= strlen($established_header);\n        }\nSo the current code is accurate.\n. To be safe, I changed ~0.11 to ^0.11\n. Which version of tedvim/stash do you have installed?\n. You need to install Stash via composer:\nsh\ncomposer require \"tedivm/stash: ^0.14.1\"\nAnd then include the composer autoloader:\nphp\nrequire_once '/path/to/vendor/autoload.php';\n. Yet another way to solve #1075 \nThis is my preferred method. That way, users can handle tedivm/stash at their own risk.  However this leaves us w/o a recommended way to implement file caching.\n. Would you mind filing an issue for this and we will get the readme updated?. This should now be fixed by https://github.com/google/google-api-php-client/pull/1113. Can anyone here pull down the latest master branch and verify?. The function is Google_Service_Translate_Resource_Translations::listTranslations, not list. See here\n. Yes, I believe the provided $http object is the $authHttp object. Good catch.. Good catch! Thank you.. As I have not heard back, closing this PR.. @domrachev-insegment have you tried downloading from the releases section? Make sure you download the zip file google-api-php-client-2.0.3.zip\n. The correct way to do this is by calling Google_Client::createAuthUrl and can be seen in simple-file-upload.php:\nphp\n$authUrl = $client->createAuthUrl();\nand then in the HTML:\nhtml+php\n<?php if (isset($authUrl)): ?>\n  <div class=\"request\">\n    <a class='login' href='<?= $authUrl ?>'>Connect Me!</a>\n  </div>\n. @josh1600 PTAL at #1121, this should fix the issue.  . Closing as a duplicate of #1064 . @tomaspinho sorry! You're right, this is a great fix, but it needs tests as well.. @tomaspinho @rolanyang Please take a look at #1121 . Try downloading your sheet using the Drive API. It would look something like this:\nphp\n$spreadsheetMimeType = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet';\n$fileId = '1ZdR3L3qP4Bkq8noWLJHSr_iBau0DNT4Kli4SxNc2YEo';\n$content = $driveService->files->export($fileId, $mimeType, array(\n  'alt' => 'media' ));\nTo get your file ID, use the listFiles method:\nphp\n  $response = $driveService->files->listFiles(array(\n    'q' => \"name='Name of your Spreadsheet' and mimeType contains 'sheet'\",\n    'spaces' => 'drive',\n    'fields' => 'files(id, name)',\n  ));\n  if (count($response->files) > 0) {\n      $fileId = $response->files[0]->id;\n  } else {\n      throw new Exception('File not found!');\n  }. Thanks @net-tools !. Thank you for providing this very helpful info!. Our builds pass on PHP 5.4, and have for some time. Which version of Guzzle are you using? Only Guzzle 5.2 is compatible with PHP 5.4.. Were you able to fix this issue? . You have to register your client's redirect uris in the cloud console. This is in API Manager > Credentials. Select (or create) a set of Web Credentials and you should see a section marked Authorized redirect URIs. Put the domain and path in there, and this should fix the issue.. What is the URL you are redirecting to? My best guess is there is a typo in your registered URL, you registered a different protocol (i.e. https vs http), or something along these lines.. Make sure the redirect URL matches EXACTLY with what you've registered. It's possible you're using http in one and https in the other.. thank you for logging the issue! I'll try to make the phpseclib dependency more flexible. Please pull down the master branch, and you should be good to go. You can reply to this issue or open a new one if you encounter additional problems.. Please follow the instructions in the readme and install this library and\ndependencies using composer.\nOn Mon, Dec 26, 2016, 2:54 AM qvivi88 notifications@github.com wrote:\n\nMissing Auth folder (I downloaded the whole sample from git)\nAs per title, there's a line of code retrieving OAuth2, but there's no\nsuch \"Auth\" folder in git.\nIs there any other complete documentation I can refer to? Thanks.\nThank you!\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/1117, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AAGWBd_Dsb-Q7JwJjXtIrNIWx69IfTdVks5rL466gaJpZM4LVsTD\n.\n. Either of the options under Installation should do the trick: https://github.com/google/google-api-php-client#installation. Done! Thanks for pointing this out.. @mikejichaow I have been waiting for confirmation that this fix worked before tagging a new release.. @mikejichaow Install composer and do the following:\n\ncd /path/to/my-project\ncomposer require google/apiclient:dev-master\nThen in your project you can include the autoloader:\n```php\n/path/to/my-project/index.php\nrequire_once DIR . '/vendor/autoload.php';\n``. Try setting the version as^2.0`: \nsh\ncomposer require google/apiclient:^2.0. @mikejichaow you can also now download the release manually here\n. @mikejichaow there is no way to change the access token expiration, as it comes from the Google oauth server. You could try hacking the cache file and manually changing the expire time, but I'd say just wait 3600 seconds :=P. @Micle86 \u042f \u0441\u0447\u0438\u0442\u0430\u044e, \u0447\u0442\u043e \u044d\u0442\u043e \u0434\u0435\u043b\u0430\u0435\u0442 !. addresses concerns in https://github.com/google/google-api-php-client/pull/828#issuecomment-270470977 regarding JWT::$leeway's global scope. cc @martinfree. @calebdelnay thank you for catching this!. fixed in 8e3ac1a. Sorry, we are going to keep support for php 5.4 and php 5.5 for the time being, as there are (unfortunately) still a lot of users of these versions of php, and there isn't a really good reason to drop support.. Thank you for submitting this PR!. Hello Matt!\nYou have two options here:\nCall not chunked\nYou can use the Guzzle client to call the API directly, and stream the response to a file without pulling the entire response into memory:\nphp\n$http = $client->authorize();\n$url = sprintf('/drive/v3/files/%s', $fileId),\n$response = $http->request('GET', $url, [\n    'query' => ['alt' => 'media'],\n]);\nThe downside is there is no chunked size specified, so you're still synchronously waiting for the download the entire time.\nCall in chunks\nThe Drive API requires the Range header to be set in order to download chunks from the API, so passing this option in allows you to download in chunks:\n```php\n// Download in 1 MB chunks\n$chunkSizeBytes = 1 * 1024 * 1024;\n$chunkStart = 0;\n// get the authorized Guzzle HTTP Client from Google_Client\n$http = $client->authorize();\n// get the file ID and file size\n$files = $service->files->listFiles([\n    'q' => \"name='YOUR FILE NAME'\",\n    'fields' => 'files(id,size)'\n]);\n$fileId = $files[0]->id;\n$fileSize = intval($files[0]->size);\n// make a call for each chunk and write it to a file\ndo {\n    $chunkEnd = $chunkStart + $chunkSizeBytes;\n    $response = $http->request(\n        'GET',\n        sprintf('/drive/v3/files/%s', $fileId),\n        [\n            'query' => ['alt' => 'media'],\n            'headers' => [\n                'Range' => sprintf('bytes=%s-%s', $chunkStart, $chunkEnd)\n            ]\n        ]\n    );\n    $chunkStart = $chunkEnd + 1;\n    fwrite($fileHandle, $response->getBody()->getContents());\n} while ($response->getHeaderLine('Content-Length') > 0);\n// close the file handle\nfclose($fileHandle);\n```\nI'm going to add an example for this.. Here is a full sample: #1127. @daemon-byte Try installing 2.1.1 and see if the problem persists.. This is not a problem with this library, but with your curl configuration. There may be additional steps you have to take even if you compile curl using --with-ssl. See the curl documentation for more information.. This will work if you've done this somewhere else in your code:\nphp\n$client->setAccessToken([\n    'access_token' => 'xyz',\n    'refresh_token' => 'pdq',\n    'expires' => 123456789,\n    //...\n]);\nOtherwise, you'll want to load your refresh token from a database or something similar:\nphp\n$refreshToken = $myDatabase->fetchRefreshToken();\n$client->fetchAccessTokenWithRefreshToken($refreshToken);\n. Thanks!. Hello.\nYou are making two calls to the API and writing both to $result, which is confusing. Do any calls to the API return as expected? If not, then I'd guess your access token is invalid. \nCan you verify that the $token being passed to the client is a valid access token? . Try the google plus example shown here and see if you have any luck. Closing this issue due to inactivity. Please let me know if you were able to get this working.. Thank you!. @titanproger use the method setValueInputOption:\nphp\n$update_value_request->setValueInputOption('RAW');\n$this->m_service->spreadsheets_values->batchUpdate(\n    $this->m_spreadsheet_id,\n    $update_value_request\n);. @mandeep3012 Use the google-cloud-php instead of this one to access datastore:\nsh\ncomposer require google/cloud\nThis library is handwritten to be much more usable, and the documentation is way better:\n\nAPI Documentation\nOfficial Documentation\nCode Snippets\n\nUsing the google-cloud-php library, setting an ancestor would look something like this:\n```php\n// create the datastore client\n$datastore = new Google\\Cloud\\Datastore\\DatastoreClient([\n    'projectId' => $projectId, // your project ID\n]);\n// create a key for your entity\n$key = $datastore->key('Person', 'Bob');\n// set the ancestor(s)\n$key->ancestor('Parents', 'Joe');\n$key->ancestor('Grandparents', 'Barb');\n// upsert the entity\n$entity = $datastore->entity($key);\n$datastore->upsert($entity);\n``. Hello @dinihou !\nCan you tell me what version of cURL / PHP you are running? Post the result ofphpinfo();here.. @stevenscg createBatch was working for any APIs with the batch path/batch. However, there are a handful of APIs that have a distinct \"batchPath\" declared in their discovery JSON. For those APIs, this change is required. To verify if the API was affected, check the discovery JSON, and if the propertybatchPathexists and is set to something other than/batch, you will need this version.. We have some examples of how to migrate the previous functionality of the P12 credentials to the new JSON credentials. See [UPGRADING.md](https://github.com/google/google-api-php-client/blob/master/UPGRADING.md#google_auth_assertioncredentials-has-been-removed). I'm not sure why the original author of this code wanted to retry400-level errors. I cannot think of a scenario where this would be appropriate.. I think this is unintended behavior. We do want to throw an exception for400-level errors, so the fix above is not quite what we're looking for.. This would be more exponential backoff than retry though, and is a special case.. Please elaborate on your issue. What is causing a namespace conflict? It's possible you have this library accidentally included twice and are therefore getting aClass already definederror.. I believe you are on thev1-masterbranch. Check out the latest version ([2.1.2](https://github.com/google/google-api-php-client/releases/tag/v2.1.2)), which has [DFA Reporting 2.7](https://github.com/google/google-api-php-client-services/blob/master/src/Google/Service/Dfareporting.php#L19), or follow the instructions to [Use the latest API Services in V1](https://github.com/google/google-api-php-client-services#usage-in-v1).. Another possiblity is there's something else in your dependency tree that is forcing a lower version of thegoogle/apiclient-serviceslibrary. As you can see,v2.1.2supports [google/apiclient-services:v0.9`](https://github.com/google/google-api-php-client/blob/v2.1.2/composer.json#L11), which in turn supports DFA 2.7. \nYou could try explicitly requiring the dependency like this:\ncomposer require google/apiclient-services:v0.9\nAnd see what error is thrown. This will help you determine why you're not getting the correct version.. Version 2.1.2 does support php 5.4, so closing this issue.. The instance variable $token will be null, either way, so there's no reason to check. Please reopen if there's something else meant to be conveyed here.. No justification is included for this PR, so closing. . Hey @MiguelQueiroz ! This library is used for multiple APIs, so you'll have to be more specific. Which API are you asking about?. @MiguelQueiroz Correct! . Looking at the discovery doc, batchPath is set to \"/batch\", which is the default. So there is nothing obvious to me as to what would cause this error.. Good catch! This is probably a carry-over from when setAccessToken did more than just set a class variable.. Yes, this is WAI. I do not see a big win in accepting a json-encoded string. It's either the string path to a file or a PHP array representing the credentials. Thanks guys!. @anuragprasad95 try adding \"google/apiclient\": \"^2.0\" directly to your composer.json file under \"required\", and then running composer update:\n{\n    \"required\": {\n        // other dependencies of yours\n        \"google/apiclient\": \"^2.0\"\n    }\n    // other stuff in your composer.json file\n}. Try adding the google/apiclient requirement directly to composer.json and then running composer update:\njson\n{\n    \"require\": {\n        \"minishlink/web-push\": \"^1.4\",\n        \"phpmailer/phpmailer\": \"^5.2\",\n    \"google/apiclient\":\"^2.0\"\n    }\n}\nI followed these instructions and was able to install the library no problem. It installed 2.1.2. . I have submitted a PR #1455 to fix this effectively. There has been the ability to pass in your own JWT service so that this leeway is not modified:\nphp\n// Create the Google client object\n$client = new Google_Client();\n// Create the JWT service and set Leeway (if you want)\n$jwt = new Firebase\\Jwt\\Jwt;\n$jwt::$leeway = 1.5;\n// pass the JWT service into the Verify class and verify the ID token\n$verify = new Google_AccessToken_Verify($client->getHttpClient(), null, $jwt);\n$payload = $verify->verifyIdToken($token['id_token'], $data->aud);\nGlobal Firebase\\Jwt\\Jwt::$leeway is never changed.. If you're getting backend errors, you should try to retry the service. If you're getting a certificate error, try the following:\n\n\nSave the following to cacert.pem: https://curl.haxx.se/ca/cacert.pem\n\n\nput it here:\n\nC:\\xampp\\php\\extras\\ssl\\cacert.pem\n\n\n\nin your php.ini put this line in this section:\n    ```\n    ;;;;;;;;;;;;;;;;;;;;\n    ; php.ini Options  ;\n    ;;;;;;;;;;;;;;;;;;;;\ncurl.cainfo = \"C:\\xampp\\php\\extras\\ssl\\cacert.pem\"\n```\n* restart your webserver/apache. If the SSL certificates are not properly installed in your system, you may get this error:\ncURL error 60: SSL certificate problem: unable to get local issuer certificate.\nYou can solve this issue as follows:\n\n\nDownload a file with the updated list of certificates from https://curl.haxx.se/ca/cacert.pem\n\n\nMove the downloaded cacert.pem file to some safe location in your system\n\n\nUpdate your php.ini file and configure the path to that file:\n    ```\n    ; Linux and macOS systems\n    curl.cainfo = \"/path/to/cacert.pem\"\n; Windows systems\ncurl.cainfo = \"C:\\path\\to\\cacert.pem\"\n```\n\n\nAlternatively, add the cacert.pem file to your application and then set the Guzzle Client to use it:\nphp\n$client = new Google_Client();\n$client->setHttpClient(new GuzzleHttp\\Client([\n    'verify' => '/path/to/cacert.pem',\n]);\n(borrowed from symfony.com). The way to install without composer is to go to the releases page and click google-api-php-client-2.1.1.zip. You then unzip the resulting package, place it wherever you'd like in your code, and include the file vendor/autoload.php anywhere:\n```php\n<?php\nrequire_once '/path/to/google-api-php-client-2.1.1/vendor/autoload.php';\n// All the classes are now autoloaded!\n$client = new Google_Client();\n```\n. @rasiciliano This is because you're most likely running a version of PHP lower than PHP 5.4, which is not supported.. merged!. Hey no problem! I assume you found your answer in the Making HTTP Requests Directly section?. This is the Google API client library. You'll want to look into using the facebook SDK or the twitter auth api.. In this context, the tilde (~) and caret (^) mean the same thing. They only diverge with versions < 1.0 (see docs)\nIf you install and inspect the composer.lock file, you'll see the following:\n\"name\": \"guzzlehttp/guzzle\",\n \"version\": \"6.2.3\",\nSo the current version supports Guzzle 6.2.. In this context, the tilde (~) and caret (^) mean the same thing. They only diverge with versions < 1.0 (see docs)\nIf you install and inspect the composer.lock file, you'll see the following:\n\"name\": \"guzzlehttp/guzzle\",\n \"version\": \"6.2.3\",\nSo the current version supports Guzzle 6.2.. I would suggest upgrading to ^2.0 of this library, as we no longer support v1.. Indeed it does :(\nIf you're running a lower version of PHP, and you find a fix, I'd be happy to merge it.. Closing this for lack of information.. Hello @himmerman!\nThe issue here is incorrect usage of the guzzle client. I used the code above and sent my request through Charles Proxy, and found the $body was not being included at all.  This was easily rectifiable by changing your request line to the following:\nphp\n$resp = $http_client->post('https://www.googleapis.com/doubleclicksearch/v2/conversion', ['body' => $body]);. Done! Thanks for the bump.\nhttps://github.com/google/google-api-php-client/releases/tag/v2.1.3. @ir3nicus It is most likely the userId you are using does not have access to the Plus Domains API.. No justification given. The bot seems to think you did not sign the CLA. Also, these examples are not really vulnerable to XSS, they are only run locally. Also I am unsure how using htmlspecialchars around PHP_SELF has anything to do with XSS. . Follow the error message and verify the redirect URI registered in your console (https://www.my.net/index.php) matches the one used in your application code. I.e.:\n```php\n$redirectUri = 'https://www.my.net/index.php';\n$client = new Google_Client();\n$client->setAuthConfig('/path/to/client_credentials.json');\n$client->setRedirectUri($redirectUri);\n// .. if an access token doesn't exist\n$authUrl = $client->createAuthUrl();\nheader('Location: ' . $authUrl);\n```\nSee this example for more information.. I agree that namespaces are great and we eventually want to use them. \nThis is not something we have any near plans of doing, as @net-tools mentions this is not really practical and creates no real problems for our users.\nAdding to v3 milestone, however, so we don't forget about it.. Hey! Yes, this is the method to use for service accounts. Nice work!\nHave you inspected the json file to see if the \"type\" field exists? I think the issue here is you downloaded Client Credentials from the Developer console instead of downloading Service Account Credentials, which include a type field (like this):\n```json\n{\n  \"type\": \"service_account\",\n  \"project_id\": \"XXX\",\n  \"private_key_id\": \"XXX\",\n  \"private_key\": \"-----BEGIN PRIVATE KEY-----\\nXXX\\n-----END PRIVATE KEY-----\\n\",\n\"client_email\": \"XXX@XXX.iam.gserviceaccount.com\",\n  \"client_id\": null,\n  \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\n  \"token_uri\": \"https://accounts.google.com/o/oauth2/token\",\n  \"revoke_uri\": \"https://accounts.google.com/o/oauth2/revoke\",\n  \"auth_provider_x509_cert_url\": \"https://www.googleapis.com/oauth2/v1/certs\",\n  \"client_x509_cert_url\": \"https://www.googleapis.com/robot/v1/metadata/x509/XXX%40XXX.iam.gserviceaccount.com\"\n}\n```. Follow the instructions under Download the Release and you will have a package with all the dependencies.\nYou probably downloaded the zip file titled Source Code. Instead, download the zip file called google-api-php-client-2.1.3.zip.. This change actually makes the library requirements more strict and not less, so this would not resolve a version conflict.. You are probably using v1.x instead of v2.x. Please verify you've required the correct version of this library. That method is only available in the v2.x version.. It looks like you're using the google/cloud package. This repository is for google/apiclient. google/cloud supports PHP 5.5+ only.\nIf you absolutely must use PHP 5.4, try downloading the PHP-5.4 specific release of google/apiclient (this repository) from the releases page here. Then you can call the pubsub APIs using the pubsub classes included in this package. However, it is highly recommended to use google/cloud and upgrade to PHP 5.5+ instead.. Downloading without composer IS supported! See this section of the README. Just download the release (w/ bundled vendors) from the releases page.. Hey @taqiofficial ! \nUnfortunately version v1.x of this library is no longer supported. Please upgrade to v2.x. \nAs for the error, I do not know what the issue is, but it could have to do with using .p12 files, which are not recommended and should only be used for backwards compatibility.\nSome extra help: the error above occurs when the email address sent in with the access token is not found. See here.\n. You're going to have to be more specific. Analytics Reporting is an entire API. What are you trying to accomplish?. Hey there @Aadriya ! Check out the examples by following the instructions in the README. But it would look something like this:\nphp\nputenv('GOOGLE_APPLICATION_CREDENTIALS=/path/to/service_account_credentials.json');\n$client = new Google_Client();\n$client->useApplicationDefaultCredentials();\n$client->setScopes([\"https://www.googleapis.com/auth/plus.me\"]);\n$plus = new Google_Service_Plus($this->getClient());\n// get a person\n$person = $plus->people->get(\"118051310819094153327\");\nSubstitute the last line with whatever API call you need.\nAs far as posting for a specific person, you will need to grant the service account Domain Wide Delegation, or use a specific access token for that user by implementing a 3-legged auth flow (see this example)\nI do not have any specific insight into Code Igniter integration. Good luck!. This code sample is outdated, and is using the v1-master branch. \nI'm not sure where you received this sample code, but if you follow the current youtube sample, you'll have better luck.. closing in favor of #1240 . Hey @simonericci \nCan you do an ls -la in your root directory? It's possible you're in the wrong directory, and so pulling in a different vendor/autoload.php than the one required in this library. Also, perform an ls -la src/Google to verify the Client.php file exists where it should be.. You should definitely not need to add an autoload directive to your composer.json. If you install via composer, including vendor/autoload.php will suffice. If you downloaded the library zip, you'll need to require the vendor/autoload.php file which exists inside that package.. @tusharzore1 I do not know why in your specific case the class Google_Client isn't found, but I can tell you with certainty the class mapping should not need to be added to the classmap array.. Hey @swapnilbarhate \nI believe the API you're attempting to call requires an Access Token via a 3-legged oauth flow. Check out the example here: https://github.com/google/google-api-php-client/blob/master/examples/simple-file-upload.php. This repository should be more questions about the library and not the API calls themselves. Have you tried posting to Stack Overflow? \nMy best guess is the credentials you are using have not been granted insert access.. I am not sure, this is not the place for questions like this. Try asking on Stack Overflow. \nThe developer key is not tied to a user, but to a project, so it's possible the URL will only show in the dashboard if you authorize as a user. See the simple file upload example for an example of user authentication.. It looks like you're missing a required parameter in your request. Make sure the name property of your resource schema field is set!. @chandumisti\nYou need to enable the Google Analytics API. You can do so by visiting the following url:\nhttps://console.developers.google.com/apis/api/analytics.googleapis.com/overview?project=254734002464. addresses changes requested in #1212. I am not entirely certain what is happening here. Can you provide a repeatable test case?. A better solution would be to check if $paramSpec['value'] is an array before adding it to $queryVars, and if so, iterating over all of them and running rawurlencode. Or better yet, implement something like this:\nphp\nif (is_array($paramSpec['values'])) {\n    $queryVars[] = array_map(\n        'rawurlencode',\n        array_map(\n            'rawurldecode',\n            $paramSpec['values']\n        )\n    );\n}. Nevermind, I think the best thing to do here is just remove the repeated check from the conditional. . We are purposefully ignoring directories such as test, examples, and style in order to make the distributed package as slim as possible. See .gitattributes. Hey @ismailbaskin! Sorry for the delay, we will be having a new version coming this week, and are just waiting on a few new changes.\nIn the meantime, you can add this library to composer.json like this:\njson\n{\n    \"require\": {\n        \"google/apiclient\": \"dev-master as v2.1.3\"\n    }\n}. This is now resolved! You can update to v2.2.0. resolved in #1258. I'm not sure what decomposer is doing here, but my guess is it's not pulling in the right packages. Try using standard composer and this conflict should be resolved.\nThe SubscriberInterface is part of Guzzle 5.3. This library supports both Guzzle 5 and Guzzle 6, but Guzzle 6 is recommended. Try installing either Guzzle 5 or Guzzle 6.. resolved in 9bef2490ed545c9deac78b12efa38ec01527d5f3. If you do not want the $leeway = 1 behavior, you can instantiate your own Jwt instance and pass it into the client constructor: \nphp\n$client = new Google_Client(null, null, new Firebase\\JWT\\JWT());. Yes but passing in your own instance bypasses calling the getJwtService function.. Yes!! That's it. Thanks for the correction.\nOn Wed, Sep 13, 2017, 12:29 PM danielhiga notifications@github.com wrote:\n\nthis work:\nJWT:$leeway = LEEWWAY; //some value\n$client = new Google_Client(['jwt' => new Firebase\\JWT\\JWT()]);\nthank you\n\u2014\nYou are receiving this because you modified the open/close state.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/1266#issuecomment-329272023,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAGWBa8JBibe4lzkjNqOz5XEUG7RqbrNks5siC0RgaJpZM4OYvTZ\n.\n. Yes, follow the README instructions. Try upgrading to v2.2.0 of this library, which will use Guzzle HTTP instead of the class above. This will resolve your issue:\n\ncomposer require \"google/apiclient:^2\". php\n    $client->setScopes([\n        \"https://www.googleapis.com/auth/plus.me\",\n        \"https://www.googleapis.com/auth/plus.login\",\n    ]);. It could have to do with the / in the URL. Try adding the following as an authorized URL:\nhttps://www.villagem.com/index.php?route=module%2Fautoprint_oauth_redirect\nIf that doesn't work, try using your front controller so you have a normal URL, i.e. https://www.villagem.com/oauth_redirect.. Which version of the google/apiclient-services library are you using? Make sure you are on the current version (v0.15):\nsh\n$ composer show | grep google\ngoogle/apiclient-services         v0.15   Client library for Google APIs\ngoogle/auth                       v1.0    Google Auth Library for PHP. Added in 2.2.1! \nOpen a new issue if you continue to experience problems. Thank you!. Added in 2.2.1! \nOpen a new issue if you continue to experience problems. Thank you!. Please file an issue with details for your question! This one does not have enough info. How about a test for this?. This logic operates under the assumption offline access returns non-expiring access tokens, which isn't the case. It should return a refresh token which can fetch additional access tokens.. Is it possibly in a different property?\nOn Wed, Sep 13, 2017, 12:11 PM Andrey Helldar notifications@github.com\nwrote:\n\nThe problem is that using an offline token, nothing is returned.\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/1299#issuecomment-329267731,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAGWBRmNLGV9mJ1z7c_FnawSc3QQxeW-ks5siCj2gaJpZM4PM8bw\n.\n. Yes, this is a problem. I'm not sure always returning \"false\" is the right way to fix it, however. . I'm not sure. More investigation is required as to what the real issue is. The claim is that if access_type=offline is set in the token request, no expires comes back. This would be strange if true, as the only difference I'm aware of with offline access is a refresh_token comes back with the access token, which is a separate thing entirely.\n\nWe could try setting the expires parameter if it isn't set when we receive a token (I believe google's default is 1 hour but again, we need to look into it). \nReally I don't have a firm grip on the real problem here.. There are definitely ways to mock these calls out.  Here is one way that should work:\n```php\nclass Google_CacheTest extends PHPUnit_Framework_TestCase\n{\n  public function testInMemoryCache()\n  {\n    // mock the Google client object\n    $mockClient = $this->getMock('Google_Client');\n    // mock the logger\n    $mockLogger = $this->getMock('Psr\\Log\\LoggerInterface');\n    $mockClient->expects($this->any())\n      ->method('getLogger')\n      ->will($this->returnValue($mockLogger));\n// Create the PSR7 Response object you want to receive\n// This can also be a mock object, if you'd like.\n$response = new GuzzleHttp\\Psr7\\Response(\n  200,\n  [],\n  '{\"calendar\":\"fake\"}'\n);\n\n// Ensure our $mockClient returns this response\n$mockClient->expects($this->once())\n  ->method('execute')\n  ->will($this->returnValue($response));\n\n// Create the calendar service using our $mockClient\n$calendar = new Google_Service_Calendar($mockClient);\n\n// Make the \"api call\"\n$response = $calendar->calendars->get('fake-calendar-id');\n\n// Decode the response! It will contain the body we specified in the response above.\n$mockReponse = json_decode((string)$response->getBody(), true);\n$this->assertEquals(\"fake\", $mockReponse['calendar']);\n\n}\n}\n``. Yes there is! See the method [Google_Client::setAuthConfig`](https://github.com/google/google-api-php-client/blob/master/src/Google/Client.php#L845), which accepts an array matching that contained in the auth config file, e.g.:\n```php\n$authConfig = [\n    'client_id' => getenv('GOOGLE_CLIENT_ID'),\n    'client_secret' => getenv('GOOGLE_CLIENT_SECRET'),\n    'redirect_uris' => ['https://www.yourwebsite.com/oauth/callback'],\n];\n$client = new Google_Client();\n$client->setAuthConfig($authConfig);\n``. Hmm interesting, it could be an issue with the Discovery API. @saicheems. Also, I am unsure what you mean by v2.8, as you can see in your comment we are dealing with v2.2 and v0.27.. Makes sense! Thank you.. I found the issue. The problem isdurationTypeis an actual API field, whereas the library looks for the prepending ofType` to any complex variable (see the discovery API).\nI've submitted PR #1310 to fix this. Please run your application with the fix and let me know if it works. You can do that by changing your composer.json via the composer command:\ncomposer require \"google/apiclient:dev-issue-1308 as v2.2.0\". The reason is when you pass null in, you are replacing the default parameter. The default parameter is array(), as you can see here.\nIt would be better to use typehints, so listFiles would throw a type exception instead.. Yes, the parameters are optional. Sending an empty array is equivalent to calling the method with no parameters:\nphp\n$response = $service->files->ListFiles();\n// is equivalent to\n$parameters = [];\n$response = $service->files->ListFiles($parameters);. Thank you @Phobetor !. This looks great, thank you!. @masayuki14 the command composer require google/apiclient:^2.0 will in fact install version 2.2, according to semantic versioning rules:\nsh\ncomposer require google/apiclient:^2.0\n./composer.json has been created\nLoading composer repositories with package information\nUpdating dependencies (including require-dev)\nPackage operations: 12 installs, 0 updates, 0 removals\n  - Installing psr/http-message (1.0.1): Loading from cache\n  - Installing guzzlehttp/psr7 (1.4.2): Loading from cache\n  - Installing guzzlehttp/promises (v1.3.1): Loading from cache\n  - Installing guzzlehttp/guzzle (6.3.0): Loading from cache\n  - Installing phpseclib/phpseclib (2.0.7): Loading from cache\n  - Installing psr/log (1.0.2): Loading from cache\n  - Installing monolog/monolog (1.23.0): Loading from cache\n  - Installing firebase/php-jwt (v5.0.0): Loading from cache\n  - Installing google/apiclient-services (v0.32): Loading from cache\n  - Installing psr/cache (1.0.1): Loading from cache\n  - Installing google/auth (v1.1.0): Loading from cache\n  - Installing google/apiclient (v2.2.0): Loading from cache\n. Thank you for your Pull Request! Unfortunately, even though PHP 5.4 and PHP 5.5 are no longer supported, we still have users on those versions. So unless there is a good reason to update it (a better reason than upgrading our PHPUnit version), we are going to continue supporting these versions of PHP.. Wow, so sorry for missing this everyone. The proper zip file with all dependencies has been added to v2.2.1. \nThank you all for this feedback, it's really good to know so many of you are using the non-composer install option. \n@mattwhisenhunt FYI I've been using this script to create the release packages.. Note that the Youtube Data API does not accept service account credentials (see here). I'm not sure if the liveBroadcasts endpoint falls in this category but you could try using Client Credentials instead.. Hello @dracoirs , I am not seeing this change in the phpseclib code. Can you provide a reproduction case?. Thank you! Good stuff.. This is a great idea, although if we do this we should list all the unsupported APIs. These are great! Thank you @carusogabriel !. This is very interesting, and I'm not sure why this would happen. Can you paste your composer.lock on gist.github.com and link to it here?\nadditionally try running composer require psr/cache . Hey @umerpervaiz12  ! Please provide us with a little more context. There should be a stack trace, and also you can paste us your code.\nThank you.. Hello @Saqibm128 !\nI am looking at the phpseclib code and I'm still seeing the function loadKey. Also, your test is failing because it cannot find the function load.\nCould you paste your code or a gist to a repro case?. You just need to include vendor/autoload.php at the top of your front controller (e.g. index.php) or which ever file is served up first:\nphp\nrequire '/path/to/vendor/autoload.php';. @n00dl3 Thank you for the heads up! As a work around, try using the v1-master branch of this repo, which will definitely run on 5.4. I do not believe this is accurate. Our travis tests are passing on PHP 5.4\nThere are a lot of customers who still need support for previous PHP versions. Even though they are not supported by the core team, there are many applications still running on it.\nI can pull up API stats for how many calls we receive from these libraries on previous PHP versions. They are non-trivial. So unless there's a good reason, we should keep the previous PHP version compatibility.. Here is the state of PHP 5 usage overall. I can pull up internal numbers as well and send them to you personally. \nhttps://w3techs.com/technologies/details/pl-php/5/all. Hello!\nWe require ^1.2, which actually includes 1.4.1 (the required version for php-aws). The caret in front of 1.2 indicates we support anything >=1.2 and <2.0. \nTry adding this library to composer.json and then running composer update. This will successfully update to the appropriate versions. Do not follow @mattwhisenhunt's instructions of downloading all the dependencies, as this could result in some unintended issues. \nThe following also worked for me:\ncomposer require google/apiclient\ncomposer require aws/aws-sdk-php\nThis resulted in the following composer.json:\njson\n{\n    \"require\": {\n        \"google/apiclient\": \"^2.2\",\n        \"aws/aws-sdk-php\": \"^3.54\"\n    }\n}. The question (I believe) is how to run the code on a backend server, e.g. in a production environment. The instructions on how to run this are in the README under \"Installation\". Let us know if you run into any problems!. closing as a duplicate of #1172 . I don't agree with this change. We should just add if ($jwtClass::$leeway < 1), as the spirit of this change was to make sure there was at least a little leeway given. . As mentioned in this comment, <?= is ok and we are keeping them.\nI have never heard that a submit button without the value attribute is bad practice. Can you please point me to some resources saying so?\nAdding the required tag is okay, but these samples are meant to be kept as simple as possible, so I am not really a fan. However, if you remove all the other stuff we can merge that.. Closing so that we can roll these changes into #1456. Hello, I am sorry you are not happy with the samples. But it is not necessary to remove short tags. They are 100% okay. You may be confusing them with these tags: <?, which were removed entirely in PHP 7.0. Yes, <? conflicts with XML and should always be disabled, but <?= do not, and can be used safely since PHP 5.4 (they've always been able to be used safely, but before PHP 5.4, they were bundled with <? in the same INI configuration so both had to be disabled together). \nAs this repo is marked as supported for PHP 5.4 and above, I do not want to change the short tags.\nI see that you are also adding a placeholder for the URL, and a required tag to the input. This is nice. If you'd like to submit a separate PR with those changes, or update this PR to remove your changes to the short tags, we are happy to merge it!. @Assimilationstheorie thank you for your concern but the short_open_tag directive was removed in PHP 7.0, and was separated to not include <?= in PHP 5.4. So the only people this would cause a potential error for is people using <= PHP 5.3, which is not supported by this library.. @Assimilationstheorie additionally, there is a version of this library (v1-master) which supports PHP 5.2 and 5.3, if you need those versions supported.. Same with #1454, there is no reason to replace <?= short tags.. Why replace PHP short tags? <? has been fully removed, but as of PHP 5.4 <?= is okay.. Would you like to add required to index.php or any other samples?. Please add the other files to this PR so we encapsulate all the changes in a single commit and pull request!. After reviewing all changes that have been made since v2.2.1, this release is more appropriately v.2.2.2 since no enhancements have been made. . Hey Matt! This is a great example, but we really should be directing users to use google/cloud-text-to-speech and not to this library.. once this branch is merged into master, we should tag the version of google/auth using semantic versioning\n. This could better be written:\nphp\nreturn $this->resumeUri ?: $this->fetchResumeUri();\n. we need to get rid of unnecessary whitespace\n. You are right... we are still supporting 5.2 for this branch. Good catch.\n. Please trim this whitespace as well\n. Because google/auth has guzzle as a dependency. \nBut you're right, we should add guzzle to this library also. That way, if google/auth updates their guzzle version, it will cause a composer conflict rather than just breaking this library.\n. What we've done in other parts of the library is something like this:\nphp\n$request = $this->http->createRequest(\n    'POST',\n    Google_Client::OAUTH2_REVOKE_URI,\n    [\n        'body' => ['token' => $tokenString],\n        'headers' => [\n            'Cache-Control' => 'no-store',\n            'Content-Type' => 'application/x-www-form-urlencoded',\n        ],\n    ]\n);\nThis would accomplish the same as above.\n. yeah I don't like it either. It should be:\nphp\nsprintf('Failed to retrieve verification certificates: \"%s\".', $url)\nand also at the top it would be better as\nphp\nif (0 !== strpos($url, 'http')) {\n   //...\n}\n. Hey Matt! Thanks for the heads up. Yeah, I've noticed the newer docs are for 6. This was on my list but a lower priority. We will definitely look into the effort required to upgrade. \n. Sorry Michael! I saw \"mt\" and my brain filled in the blanks. \nWe will make it a priority to switch to Guzzle 6 before tagging this release. Thanks for reaching out!\n. @mtdowling upgrading to v6 will take some consideration, as the entire underlying google auth library is built on GuzzleHttp\\SubscriberInterface.\nI suppose I could convert the subscriber classes to implement _invoke(), and then create the HandlerStack from that, but currently the idea is the GuzzleHttp\\Client is passed in and \"authenticated\", but since 'handler' is a constructor-only argument, this won't be possible.\nThe user must create the GuzzleHttp\\Client and explicitly add our auth handlers, or we create a default client for them. So $googleClient->getAuthHandler() could return the callable for them to push on their stack. This is more work for the users than I would like to get a custom Http Client, but less magical than an authorize method. Is this the only way?\n. My understanding is the functionality of this class will be added to google/auth\n. This chunk of code can be removed, and the next line below should be:\nphp\nif ($issuer && !in_array($iss, (array) $issuer)) {\n. change to OAUTH2_ISSUER_HTTPS\n. I would like to see a comment here\nphp\n// support HTTP and HTTPS issuers\n// @see https://developers.google.com/identity/sign-in/web/backend-auth\n. done!\n. I am really trying to keep this guide simple. As the stack overflow thread shows, some users are entirely unfamiliar with composer. Sending them to the website for installation will just increase the bounce rate. That is why I went this way... to get them up and going the fastest.\n. that only works if they've taken the time to install composer globally. If they've done that, I assume they know the difference (and I mention it in the quote below)\n. yeah, hmm... I meant it specifically for those who downloaded the release w/o composer. But you're right, it's confusing.\n. Yes, but composer should still be encouraged, hence the example.\nOn Tue, Nov 3, 2015 at 5:30 PM Takashi Matsuo notifications@github.com\nwrote:\n\nIn README.md\nhttps://github.com/google/google-api-php-client/pull/729#discussion_r43832430\n:\n\n@@ -16,7 +16,34 @@ http://developers.google.com/api-client-library/php\n## Installation ##\n-For the latest installation and setup instructions, see the documentation.\n+The Releases page lists all stable versions. Download any file\n+with the name google-api-php-client-[RELEASE_NAME].zip for a package including this library and its dependencies.\n+\n+### Composer\n+\n+Install this library via composer by running the following command:\n+\n+```sh\n+# change directories to the root of your project\n+cd /path/to/my-project\n+# if you don't already have composer, install it\n+curl -sS https://getcomposer.org/installer | php\n\nWell, people who don't know composer can still download the zip file,\nright?\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/729/files#r43832430\n.\n. no clue, but I think you're right... pointing to the composer website is a better long term solution, and will make for a cleaner readme\n. @kesar this is a deprecated file meant to move users of v1.x over to 2 with minimal difficulty. If a user has a custom vendor directory, they should not be using this file anyway, so I don't think it's worth handling this edge case.\n\n@tmatsuo I am unsure what that would accomplish.\n. The assumption is the exception indicates the response isn't JSON, rather than indicating an actual error.\n. Also, whatever the non-JSON is gets returned, so nothing super valuable is thrown away (IMHO), just whatever parse error was discovered by json_decode.\n. Yes it does... it's very counter intuitive, and I don't like it, but it does.\nWe could also call it with trim and then the template could have a new line. I'm not a particular fan of either way.\n. yeah I think so :D\n. I understand why they are doing this - if there are no headers, then the first line should still only have one new-line between it and the body, so this prevents an unnecessary newline character if there are no headers.\n. this will be updated to a tagged version once we have one\n. done\n. this test does not require an access token, so we should remove this line.\n. Access tokens are stored in cache, yes. But the whole point is to fix #806. So we either break some of our users and be extra secure, or choose to be standard with other file caches and make file permissions looser. \n. Added username hash. see #840\n. This is the system user executing the code, so it's pretty unlikely they'll collide. \n. Agreed with @tmatsuo this is not a general-purpose file cache. it is a credentials cache. So we'll stay on the safe side here.\n. I don't want usernames showing in the directory path, it seems sloppy. Using the full md5 brings the likelyhood of collisions to essentially zero.\nI made the root directory 0777 and the individual ones 0700. If this isn't acceptable, I'm going to remove this file all together and let everyone write their own implementations (kidding but kinda serious...)\n. This is true. We can assume if it's an error, it's safe to pull the body into memory.\n. fixed! PTAL\n. it almost certainly does not work on windows, although I haven't checked.\n. I could add a note that this is only necessary outside of GAE/GCE, in addition to adding a \"for example\" above, so it's clear putenv is just one way to set an environment variable.\n. a note has been added\n. I'd really rather not. The logic is very minimal, and creating a utility would require a new class. Also, the logic here is only to preserve BC. Next time we break BC, I plan to make MemoryCacheItemPool the default, and remove the Stash logic all together.\n. NOW it will! \ud83d\ude04 \n. this conditional is not necessary, please remove it!. This indentation is off - this should be back four spaces, and the array arguments should only be indented 2 spaces. . Let's use a variable name like $context, to match with the PSR spec. . Let's make the method signature look like this:\nprivate function log($level, $txt, $name, $parameter = null)\nThen we can make \"info\" and \"error\" the first argument to these calls, and consolidate two methods into one.. Why is this preferable to is_null?. Why is this order preferable? . This should be under 80 characters, so it can be wrapped like this:\nphp\n    if (\n        !empty($errors) && \n        isset($errors[0]['reason'], $this->retryMap[$errors[0]['reason']])\n    ) {. This is great! However, we have a place for helper functions like this in examples/templates/base.php. Please move this function there.. We can just follow the model of the other validation functions if this fails:\n```php\nif (!validateCsrfToken()) {\n  echo invalidCsrfTokenWarning();\n  return;\n}\n// and in base.php\nfunction invalidCsrfTokenWarning()\n{\n    return 'The CSRF token is invalid, your session probably expired. Please refresh the page ';\n}\n``. See above comment and we can get rid of this block.. Let's make a new functiongetCsrfTokenthat generates this if it doesn't exist.. is any of this necessary? I don't understand why we need to remove the csrf token on logout, or why the validate function needs to be called. At the very least we can just unset the token.. elseif not required since the previous statement returns true. Just add another if.. these changes here make me very nervous to merge this change. This will fundamentally change how requests are made, and so is a BC break. . good catch, should bestring|null` though. What the point of this? By default methods return null if no value is returned. Can we get this guy to follow coding standards? E.g. wrap at 80 characters and use proper comment blocks:\n```\n/*\n * Some Google Service (Google_Service_Directory_Resource_Channels and \n * Google_Service_Reports_Resource_Channels) use a different servicePath value \n * that should override the default servicePath value, it's represented by a / \n * before the resource path. All other Services have no / before the path\n /. ",
    "portaseb": "Well, i've finally found what's the problem...\nIt come from a \"bad\" configuration on Google App \"Add the Client ID with scopes on the Google Apps console ;\". In fact, i have put a space between scopes (and not a coma) and the problem is there !\nSo it's possible to help others developers to identify this and could be very usefull.\nSebastien\n. ",
    "MrHash": "In my case every query is unique so caching is not necessary. Is there a way to set a null cache?\n. ",
    "mateisilviu": "If my variable $local_kml has < 650 characters , let's say 500. The script works and the row is inserted.\n. It works on Google API Explorer.\n. ",
    "sumitc": "Hi Silvano & Ianbarber\nHere's the code for you. It follows the server side error that I'm getting.\n\n```\nsession_start();\nrequire_once 'Google/Client.php';\nrequire_once 'Google/Http/MediaFileUpload.php';\nrequire_once 'Google/Service/Drive.php';\n//globals\n$fileId = \"0AkWiRdvx2HRzdHMxOFp2SnRZUjJCUjJiM3VGU3Jsdmc\";\n$client = new Google_Client();\n$client->addScope(\"https://www.googleapis.com/auth/drive\");\n$service = new Google_Service_Drive($client);\nif (isset($_REQUEST['logout'])) {\n  unset($_SESSION['upload_token']);\n}\nif (isset($_GET['code'])) {\n  $client->authenticate($_GET['code']);\n  $_SESSION['upload_token'] = $client->getAccessToken();\n  $redirect = 'http://' . $_SERVER['HTTP_HOST'] . $_SERVER['PHP_SELF'];\n  header('Location: ' . filter_var($redirect, FILTER_SANITIZE_URL));\n}\nif (isset($_SESSION['upload_token']) && $_SESSION['upload_token']) {\n  $client->setAccessToken($_SESSION['upload_token']);\n  if ($client->isAccessTokenExpired()) {\n    unset($_SESSION['upload_token']);\n  }\n} else {\n  $authUrl = $client->createAuthUrl();\n}\necho \"stage 1\";\nif ($client->getAccessToken())\n{\n    //temp file creation\n    $data = file_get_contents('temp/test_dashboard.xls');\nif (isset($data) && $data)\n{\n    // Now lets try and send the metadata as well using multipart!\n    $file = new Google_Service_Drive_DriveFile();\n    echo \"<BR><BR>stage 2\";\n    if (isset($file))\n    {\n        $file->setTitle(\"temp upload\");\n        echo \"<BR><BR>stage 3\";\n\n        $result2 = $service->files->insert(\n            $file,\n            array(\n              'data'       =>  $data,\n              'mimeType'   => 'application/vnd.google-apps.spreadsheet',\n              'uploadType' => 'multipart'\n            )\n        );\n\n        echo \"Result: \";\n        var_dump($result2->title);\n    }\n    else\n    {\n        echo \"No file object\";\n    }\n\n}\nelse\n{\n    echo \"File read failed\";    \n}\n\n}\nelse\n{\n    echo \"No access token\";\n}\n```\n\nServer ERROR:\nPHP Fatal error:  Uncaught exception 'Google_Service_Exception' with message 'Error calling POST https://www.googleapis.com/upload/drive/v2/files?uploadType=multipart&key=xxxxxxxxxx: (400) Bad Request' in /base/data/home/apps/s~t-dashboard-mtsumit/1.373482401940458788/Google/Http/REST.php:74\nStack trace:\n0 /base/data/home/apps/s~t-dashboard-mtsumit/1.373482401940458788/Google/Http/REST.php(44): Google_Http_REST::decodeHttpResponse(Object(Google_Http_Request))\n1 /base/data/home/apps/s~t-dashboard-mtsumit/1.373482401940458788/Google/Client.php(487): Google_Http_REST::execute(Object(Google_Client), Object(Google_Http_Request))\n2 /base/data/home/apps/s~t-dashboard-mtsumit/1.373482401940458788/Google/Service/Resource.php(195): Google_Client->execute(Object(Google_Http_Request))\n3 /base/data/home/apps/s~t-dashboard-mtsumit/1.373482401940458788/Google/Service/Drive.php(1694): Google_Service_Resource->call('insert', Array, 'Google_Service_...')\n4 /base/data/home/apps/s~t-dashboard-mtsumit/1.3734824019 in /base/data/home/apps/s~t-dashboard-mtsumit/1.373482401940458788/Google/Http/REST.php on line 74\n. Figured out that the code is perfectly ok.\n400 Bad request is coming because of the file data that I'm trying to upload in the request.\nSO I have an XLS file which has some data beforehand - that I intend to update to an already existing google spreadsheet.\nCan anyone suggest, how can I keep updating/synching a google spreadsheet from an external XLS file?\n. ",
    "The-Lion": "I am not completely sure if we discuss the same issue, but I think you have to look at the 'approval_prompt'. It has changed from 'force' in version 0.6 to 'auto' in v1.0. Only if approval_prompt is set to force, authentication will return a refresh_token.\nSo call $client->setApprovalPrompt('force') if you would like to receive a refresh_token.\n. The default value of 'access_type' has indeed also been changed from 'offline' in v0.6 to 'online' in v1.0. So I think this should definitely be mentioned in the '0.6->1.0 migration guide'.\nIn my case if I set the offline access type, the access token does expire in ~1 hour (I can't use it anymore) and refreshing the token will give a new one.\n. No, but that shouldn't happen of course. The token is valid until 3600 seconds after it is created. So you just have to check $client->isAccessTokenExpired().\n. ",
    "markopavlovic": "If I got you right, then:\n1. You should not be trying to hide the URL to avoid conflicts (nither you can, since oauth requires code response), instead you should structure your code or routes differently to avoid conflits now and in future.\n2. This really depends on how did you set-up your code environment.\nWhat I would suggest you to do within your code is to route callback differently for each api or put a condition like some param \"?network=X\".\nSo for example, user doing a auth. with facebook would be:\n\"site.com/auth/facebook?code=x\"\nor google\n\"site.com/auth/google?code=x\"\nor you could just use param like:\n\"http://www.site.com/members/php?code=x&NETWORK=google\"\nThis way you will be able to avoid any conflicts with cross-api auth. Then you should probably connect cmodel function which follows the pattern for what you are doing with user auth data (store it in db?) and apply it on each network. There is many things up to this depending on what you need and what you have.\nAnother suggestion before all of this would be that you try to learn more about how to structure your web project, else you will always run into conflicts with your code, better get it done then pay for it later, right? Google terms like \"mvc\", \"routes\", \"oauth\"...\n. @umershaikh not quite sure where or how is your Google API client located, but still I guess that since 0.67 some namespace and directory pathings have changed also.\nI would suggest couple of things to try out:\n1. Try to locate Google/Auth/AssertionCredentials.php and see if it is there now, if not, manualy change it in your execution file.\n2.  If you use namespaces (autoloader) Call in the begining of your class php use \\Google; and see if it will correct pathing, not sure which version of wp you are running.\n3. Try to just find the correct pathing by up-ing the directory like \"../../Google/Auth/AssertionCredentials.php\" or start from your root with magic constants like\nphp\nrequire_once(__DIR__.\"Google/Auth/AssertionCredentials.php\");\n// or\nrequire_once(\"../../Google/Auth/AssertionCredentials.php\");\nhope it helps, cheers\n. ",
    "davidstanley01": "I had this error. I had to go through about 20 files and update the require_once paths... And I downloaded the client to use today.  It'd be great if this was PSR-0 compliant...\n. ",
    "cacacobra": "Very Thanks :+1: \n. ",
    "GoktugOzturk": "I've submitted the online CLA form 5m ago.\nG\u00f6ktu\u011f \u00d6zt\u00fcrk\n\nOn 17 \u015eub 2014, at 13:22, Ian Barber notifications@github.com wrote:\nThanks I was about to make this change. have you signed the CLA: https://developers.google.com/api-client-library/php/contribute (see links there)?\n\u2014\nReply to this email directly or view it on GitHub.\n. \n",
    "patryyyck": "Thanks for your help!\n. ",
    "anthonyhlcheng": "Hey, no problem. Always nice to help others here! Thanks anyway.\n. ",
    "dazwin": "Answering my own question - the access token returned by the authenticate() call returns the entire JSON response, not the actual Google Access Token (which is embedded inside this response). I can extract id_token etc. from there\n. ",
    "ghost": "scope is https://www.googleapis.com/auth/drive\n. by the way, it only happens with document fo type \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n. nothing, the problem is not solved (((((\n. did exactly the same that you did. got the following response\nphp\nobject(Google_Http_Request)[46]\n  private 'batchHeaders' => \n    array\n      'Content-Type' => string 'application/http' (length=16)\n      'Content-Transfer-Encoding' => string 'binary' (length=6)\n      'MIME-Version' => string '1.0' (length=3)\n  protected 'queryParams' => \n    array\n      'key' => string 'xxxxxxxxx@developer.gserviceaccount.com' (length=42)\n      'exportFormat' => string 'xlsx' (length=4)\n  protected 'requestMethod' => string 'GET' (length=3)\n  protected 'requestHeaders' => \n    array\n      'authorization' => string 'Bearer ya29.1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' (length=77)\n  protected 'baseComponent' => string 'https://docs.google.com' (length=23)\n  protected 'path' => string '/feeds/download/spreadsheets/Export' (length=35)\n  protected 'postBody' => null\n  protected 'userAgent' => null\n  protected 'canGzip' => null\n  protected 'responseHttpCode' => int 404\n  protected 'responseHeaders' => \n    array\n      'cache-control' => string 'no-cache, no-store, max-age=0, must-revalidate' (length=46)\n      'pragma' => string 'no-cache' (length=8)\n      'expires' => string 'Fri, 01 Jan 1990 00:00:00 GMT' (length=29)\n      'date' => string 'Mon, 31 Mar 2014 08:10:48 GMT' (length=29)\n      'content-type' => string 'text/html; charset=utf-8' (length=24)\n      'set-cookie' => string 'NID=67=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX;Domain=.google.com;Path=/;Expires=Tue, 30-Sep-2014 08:10:48 GMT;HttpOnly' (length=208)\n      'p3p' => string 'CP=\"This is not a P3P policy! See http://www.google.com/support/accounts/bin/answer.py?hl=en&answer=151657 for more info.\"' (length=122)\n      'x-chromium-appcache-fallback-override' => string 'disallow-fallback' (length=17)\n      'x-content-type-options' => string 'nosniff' (length=7)\n      'x-frame-options' => string 'SAMEORIGIN' (length=10)\n      'x-xss-protection' => string '1; mode=block' (length=13)\n      'server' => string 'GSE' (length=3)\n      'alternate-protocol' => string '443:quic' (length=8)\n      'transfer-encoding' => string 'chunked' (length=7)\n  protected 'responseBody' => string '<!DOCTYPE html><html lang=\"en\" ><head><meta name=\"description\" content=\"Web word processing, spreadsheets and presentations\"><link rel=\"shortcut icon\" href=\"//ssl.gstatic.com/docs/common/drive_favicon1.ico\"><title>Google Drive \u0432\u0402\u201c Page Not Found</title><link href=\"//fonts.googleapis.com/css?family=Open+Sans:300\" rel=\"stylesheet\" type=\"text/css\"><style>/* Copyright 2014 Google Inc. All Rights Reserved. */\n.goog-inline-block{position:relative;display:-moz-inline-box;display:inline-block}* html .goog-inline-block{display:inline}*:first-child+html .goog-inline-block{display:inline}#drive-logo{color:#91959c;font-family:\"Open Sans\",Arial,sans-serif;font-size:27px;font-weight:300;position:absolute;text-shadow:0 1px 1px white;white-space:nowrap}#drive-logo img{padding:0 0.4em 0 0;position:relative;top:2px;vertical-align:middle}#drive-logo a{color:#91959c;text-decoration:none}#drive-logo span.goog-inline-block{margin-top:2px;vertical-align:top}</style><style type=\"text/css\">body {background-color: #fff; font-family: Arial,sans-serif; font-size: 13px; margin: 0; padding: 0;}a, a:link, a:visited {color: #112ABB;}</style><style type=\"text/css\">.errorMessage {font-size: 12pt; font-weight: bold; line-height: 150%;}</style></head><body><div style=\"margin: auto; max-width: 750px;\"><div style=\"margin: 80px 40px 20px 40px; position:relative; \"><div style=\"position: absolute; top: -80px;\"><h1 id=\"drive-logo\"><a href=\"/\"><img src=\"//www.google.com/images/logos/google_logo_41.png\" width=\"116\" height=\"41\" alt=\"Google logo\" ><span class=\"goog-inline-block\">Drive</span></a></h1></div><div align=\"center\"><p class=\"errorMessage\" style=\"padding-top: 50px\">Sorry, the file you have requested does not exist.</p><p> Please check the address and try again.</p><div style=\"background: #F0F6FF; border: 1px solid black; margin-top: 35px; padding: 10px 125px; width: 300px;\"><p><strong>Get stuff done with Google Drive</strong></p><p>Apps in Google Drive make it easy to create, store and share online documents, spreadsheets, presentations and more.</p><p>Learn more at <a href=\"https://drive.google.com/start/apps\">drive.google.com/start/apps</a>.</p></div></div></div></div></body></html>' (length=2186)\n  protected 'expectedClass' => null\n  public 'accessKey' => null\n. Yep, you're right. I did this while configuring client \nphp\n$client->setDeveloperKey(developer_key);\nwhich is not needed usin OAuth2.\nI'll test it more. Thanks a lot.\n. Hi, I am also having a problem with this:\nif($client->isAccessTokenExpired()) {\n      $client->refreshToken($refreshtoken);\n      $_SESSION['access_token'] = $client->getAccessToken();\n}\nThere is no 'id_token' returned in the access token which throws an error when I am verifying the ID token. Thoughts?\n. I fixed the problem of not getting an id_token back, but now even if I get a new token using a refresh token, the access_token is updated, but the id_token is the same as before. This throws an exception when I try to validate it, as the token is expired. How do I force it to give me a new id_token when I request a new access token?\n. Hi, sorry, I've posted it here: https://github.com/google/google-api-php-client/issues/213\n. Thanks for the update. I originally just kept the session and the user logged in and didn't bother verifying the id_token. But if your solution works, this is more ideal. However, I remember that the \"id_token\" field wasn't even in the access_token in the JWT. How does your solution get around that?\n. It is really hard to tell. It is more likely that ide doesn't detect it well and might require annotation in classes or something like that but it is not really a big issue. Perhaps newer versions will address the issue and make the inspector better. Nothing needs to be done on your end right now I think, thanks for response.\n. The above code doesn't resolve the issue on the App Engine development server on PHP SDK 1.9.35:  \n$client->setHttpClient(new GuzzleHttp\\Client(['verify' => 'curl-ca-bundle.crt']));\nUncaught exception 'GuzzleHttp\\Exception\\RequestException' with message 'cURL error 60: SSL certificate problem: unable to get local issuer certificate'\nWhen trying to disable verification completely:  \n$client->setHttpClient(new GuzzleHttp\\Client(['verify' => false]));\nUncaught exception 'GuzzleHttp\\Exception\\RequestException' with message 'cURL error 0: The cURL request was retried 3 times and did not succeed. The most likely reason for the failure is that cURL was unable to rewind the body of the request and subsequent retries resulted in the same error.\nIn both cases the error is accompanied by one or more warnings:\nWarning: curl_setopt_array(): cannot represent a stream of type MEMORY as a STDIO FILE*\n. Brent,\nDidn't install with composer but downloaded the 2.0.0RC4 zip file and it seems guzzle 6 is the library that is included in that.\nCouldn't see anywhere the option to use an older guzzle using the download method.\nJacko\n. Brent,\nGave it a go, got 5.3 installed on my server but 5.4.45 in the vhost where I was planning to run the service. Could not install from root as it defaulted to 5.3 and failed.\nAbout time I upgraded my server!! On the other hand, I commented out the only curl_reset call and have successfully got my in app product details with no issue or serious fault. Will keep monitoring but will probably upgrade to a younger PHP.\nThanks for the advice.\nJacko\n. @bshaffer Thank you for your reply. Yes, I tried with Service account, however, its not giving me the same results as I have in my Google Drive. You can check the results here\nAnd here is what I actually have in my Google Drive\nWould you please explain why this happens?\n. @bshaffer Here is the source code I've written:\n``` php\n<?php\ninclude_once DIR . '/vendor/autoload.php';\n$client = new Google_Client();\n$credentialsFile = DIR . '/credentials/service_account.json';\nif (!file_exists($credentialsFile)) {\n    throw new RuntimeException('Service account credentials Not Found!');\n}\n$client->setAuthConfig($credentialsFile);\n$client->setApplicationName(\"Service Account Example\");\n$client->setScopes(Google_Service_Drive::DRIVE);\n$service = new Google_Service_Drive($client);\n$files = $service->files->listFiles();\nprint '';\nforeach ($files as $file) {\n    print_r($file);\n    print PHP_EOL . '--------------' . PHP_EOL;\n}\nprint '';\n``\n. Not an empty array... It contains only one file.\n. @bshaffer I got an exception when I do that.\nPlease help me correct the issue. https://googledrive-sunlean.c9users.io/\n. @bshaffer it looks like using thesetSubject()method is treated as an impersonation and that's the cause of the error. Does this mean every service account has its own google drive instance that is independent of the owner (Me)?\n. @bshaffer After getting rid of thesetSubject()line, I tried to insert some files and it worked just fine. it's just working on a mysterious drive :) I want it to work on MY OWN drive. Is this one of the issues that the latest SDK has? Maybe I might have to check out an older SDK.\n. @bshaffer As long as I am using a@gmail.com` account, I don't need to create a Google App account in order to do this, do I?\n. @bshaffer I actually referred to this example that exists in the SDK.\nhttps://github.com/google/google-api-php-client/blob/master/examples/service-account.php\nFor oAuth server-to-server interaction, I referred to this:\nhttps://developers.google.com/api-client-library/php/auth/service-accounts\nProbably the example is not for the right case?\n. @bshaffer I know that,  but the example should work for my case. Can you give me sample code that do the job for me? I need it done ASAP... I know this is out of your interest/service but I'd like to ask you to for me :) I was not able to get the API to work for my case or to find any examples on the Internet that works with Google Drive. I have to use the service account because it shouldn't be asking me to log in.\n. @bshaffer This is not using service accounts. I wrote the code that combines the 2 examples (service account and file uploading) as you can see. As this reference says, I thought service accounts should work against my own google drive. Instead, it works against another mysterious google drive space that's independent of my drive and owned by that service account, which makes it impossible to access the files with my own google account. Is that a problem with the PHP SDK? Should I try version 1 or other SDK in other languages?\n. Does that mean it won't be updated to support the DCM API v2.3? Or does it mean that the update to the new API version will happen automatically before the sunset date on february 29?\n. Thanks, it works like a charm ! \n```\n$client = new \\Google_Client();\n$client->useApplicationDefaultCredentials();\n$client->setScopes(['https://www.googleapis.com/auth/admin.directory.resource.calendar','https://www.googleapis.com/auth/admin.directory.resource.calendar.readonly']);\n$client->setSubject('user@domain.com');\n$directoryService = new \\Google_Service_Directory($client);\n$resources = $directoryService->resources_calendars->listResourcesCalendars('my_customer')->getItems();\n```\n. I have the exact same behavior with people API... . Find the solution for the people API : see #1168. But not the same solution for the calendar API. . Seems to be solved in 2.1.3. \nI can now ask for the requestSyncToken in optParams\n\n'requestSyncToken' => true \n\n. ",
    "yomexzo": "having an issue around this too.. earlier today, i get a redirect in the header when i try to use an export link.. and i took care of it..\nnow, i get response code 404.. when in fact the file with the id exists.... sigh\nstudied the OAuth2::authenticatedRequest and the Stream::makeRequest functions but no indication to the cause\n. didn't try those.. but i copied the export link and pasted in my browser.. it sure worked & downloaded... :(\nthe response headers that came with the 404 error has content-type equal to \"text/html; charset=utf-8\" that seems wrong without a redirect given same url\nSee code below to see my handling\n``` php\ndo{\n            $ret['url'] = $downloadUrl;\n          if ($downloadUrl) {\n            $request = new Google_Http_Request($downloadUrl, 'GET', null, null);\n            // $httpRequest = $client->getIo()->makeRequest($request);\n            $httpRequest = $client->getAuth()->authenticatedRequest($request);\n            $ret['response_code'] = $httpRequest->getResponseHttpCode();\n            $ret['response_headers'] = $httpRequest->getResponseHeaders();\n            // dump($ret);\n            if ($ret['response_code'] == 200) {\n                if($httpRequest->getResponseBody()){\n                    // tricky stuff here.. use truth table to understand what i did. leverages on the fact that for OR, when a condition is met, subsequent conditions are not evaluated\n                    if(empty($max_size) || strlen($httpRequest->getResponseBody()) <= $max_size){\n                        $ret['stream'] = $httpRequest->getResponseBody();\n                        $ret['message'] = \"ok\";\n                    }else{\n                        $ret['message'] = \"File is larger than \".(int)($max_size/1000000).\"mb\";\n                    }\n                }else{\n                    $ret['message'] = \"No content received\";\n                }\n            }else{\n                $ret['message'] = \"Error encountered fetching file. Response code \".$httpRequest->getResponseHttpCode().\" gotten. \".$cc;\n            }\n          }\n          $downloadUrl = !empty($ret['response_headers']['location']) ? $ret['response_headers']['location'] : $downloadUrl;\n          $cc += 1;\n    }while($ret['response_code'] == 302);\n\n```\n. still 404. you checked out my code? any foul play?\n. any updates please?\n. ",
    "grayxr": "It worked when I used the method:\nphp\n$client->setClassConfig('Google_Http_Request', 'disable_gzip', true);\nHowever, is there a way to have it work with gzip still enabled?\n. ",
    "elyobo": "Just to note for any others that come across this, I'm using the Drive API with a service account, and it definitely does work.  My code is essentially the same as @silvolu's and it's working fine.\n. I'm pulling down the text/csv file, perhaps that makes a difference?  I do notice that there seems to be some sort of strange caching - unless I happen to have the file open in a browser at the time, I often get an older, out of date version of the file, and I'm not sure how to get around that (if anyone else here knows, please enlighten me).\nExample code to follow, but it's more or less the same of yours (but possibly useful for others; finding docs on how to set up a service account is a pain).\n- $config['google']['config_file'] is a reference to the JSON config file containing that the Google console gives you your credentials in\n- $config['google']['key_file'] is the pk12 file for the credentials downloaded from the Google console\n- $config['resources']['file_id'] is the ID of the file I'm downloading (and I've given view access to the email address associated with the service account using the share settings on the file)\n- $config['resources']['worksheet_id'] is the ID of the worksheet in the spreadsheet that I want\n``` php\n<?php\nuse Google_Client as GoogleClient;\nuse Google_Auth_AssertionCredentials as GoogleAssertionCredentials;\nuse Google_Service_Drive as GoogleServiceDrive;\nuse Google_Http_Request as GoogleHttpRequest;\n// Definition to expand in config file\ndefine('ROOT_DIR', dirname(DIR));\n// Standard composer autoloader\nrequire DIR . '/../vendor/autoload.php';\n// Load config\n$config = parse_ini_file(ROOT_DIR . '/config/config.ini', true);\n$google = json_decode(file_get_contents($config['google']['config_file']), true);\n// Create google client using config\n$client = new GoogleClient;\n$cred   = new GoogleAssertionCredentials(\n    $google['client_email'],\n    array(\n        GoogleServiceDrive::DRIVE_METADATA_READONLY,\n        GoogleServiceDrive::DRIVE_READONLY,\n    ),\n    file_get_contents($config['google']['key_file'])\n);\n$client->setAssertionCredentials($cred);\n$drive = new GoogleServiceDrive($client);\n// Pull down the file content\n$file    = $drive->files->get($config['resources']['file_id']);\n$url     = $file->getExportLinks()['text/csv'] . '&gid=' . $config['resources']['worksheet_id'];\n$request = new GoogleHttpRequest($url);\n$http    = $client->getAuth()->authenticatedRequest($request);\nif ($http->getResponseHttpCode() !== 200) {\n    echo \"Failed downloading file content.\\n\";\n    exit -1;\n}\n// Process file content into an array of arrays, one for each row\n$rows    = array_map('str_getcsv', explode(\"\\n\", $http->getResponseBody()));\n```\n. Just noting this down in case someone else stumbles in to the same problem.  This was eventually resolved this morning; the service account user that is using the API needs to have manage and view access to the Google Tag Manager account, not just the container that is present on the site being verified.\nThe level of access required is surprisingly high and the HTTP 503 response is very misleading as to the underlying problem.\n. Thanks, I'll try to follow it up with them (if I can find where).  I've only started playing with this API recently and, given how new the Webmasters support was, I wanted to check here first to confirm it wasn't something that I was doing or a bug in the new library.\n. They have a support forum (not API specific though) and I've followed up there.\n. Total silence in the support forum; do you have any other ideas where I might be able to find support for API bugs @ianbarber ?\n. I did a few days back, adding a bounty and all, but it didn't get much attention.  I'll just leave it out for now; hopefully they'll notice and resolve it some day!\n. Do you have any objections to additional dependencies (e.g. monolog) or would you prefer it all built in house?  If built in house, can I assume that it should comply with PSR-3 Logger Interface (which monolog does)?\nNote that the current version of monolog does have a PHP 5.3 dependency (might be able to use an older version until google-api-php-client shifts to PHP 5.3 though).\n. I did have some idea of implementing it, but haven't had any free time (and it doesn't look like I'll have any for a while, sorry).\n. CLA signed.\nI haven't used memcached with sockets, but from the documents it seems like the \"host\" could be any filesystem path that points to a socket, not just \"unix\".  If that's correct, then we could possibly check is_file/is_readable.\n. Haven't tried yet, but it looks good from your description.  I'll try to have a look soon.  Thanks!\n. Just as a heads up, v201409 is out of date, with a sunset date of 14 July at the moment (I just got bitten having not upgraded to 201409...)\nhttps://developers.google.com/adwords/api/docs/sunset-dates\n. @bshaffer the UPGRADING docs note that .p12 is deprecated, but it seems like it has actually been removed, is that correct?  If so the notes should indicate that (or, alternatively, describe how .p12 can still be used).. I deliberately kept the scope to just allowing port zero, rather than adding in validation, but if you do want to validate things then is_numeric allows through a lot of things that you probably don't want (e.g. \"-1\", \"+0123.45e6\", \"0xf4c3b00c\", \"0b10100111001\").  If you do want to start validating things, then you should use ctype_digit and possibly throw a different Exception to distinguish invalid values from missing ones.\n. ",
    "haydenmorris88": "How did you get it to work with service account?. I manage to get the content but it doesnt appear to be the correct data.\nCode:\n$exportLinks = $file -> getExportLinks();\n$downloadUrl = $exportLinks['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'];\n$request = new Google_Http_Request($downloadUrl);\n$httpRequest = $client -> getAuth() -> authenticatedRequest($request);\n$data = $httpRequest -> getResponseBody();\n. Using ['text/csv'] seems to have made it work thanks.\n. ",
    "kbond": "Sorry to necro this but I just started having this problem today. Was working fine up until now. I can still get see the exportLinks but when I try and request them, I get a 404.\n. I was able to solve my issue with a work-around. It seems the id changed on a bunch of my documents. I could get the file with the old id but the export links were for the old id and gave a 404. I was able to get the new id from the alternateLink field and use it.\nIt looks like previously the API would redirect but it no longer does...\n. ",
    "piernik": "ok I forgot - I mean FusionTables\nI wrote here because there's noting in Your doc so it's could be improved\nhttp://stackoverflow.com/questions/22096205/how-to-attach-file-in-importrows-fusion-tables\n. ",
    "nandosangenetto": "Why this feature is forgotten?\n. ",
    "ymkjp": "@devplanete ping ping\n. I also have similar problem.\nTo use this library with spl_autoload_register, I should comment out or delete all require_once lines.\nBut, yes, I know that this library supports PHP 5.2.1 and we cannot use spl_autoload_register (It's from PHP 5 >= 5.1.2).\nSo any suggestion to address this issue?\n. ",
    "mishan": "Original issue: http://code.google.com/p/google-api-php-client/issues/detail?id=401\n. Verified this is all gravy now. Thanks!\n. This addresses #109 \n. @silvolu \n. @silvolu As far as stream goes not sure entirely, but I preserved the behavior with this patch. I can do some further testing to see.\nI'll go ahead and sign the CLA, sorry I missed that.\n. @silvolu The CLAs linked to from there are 404 :( http://code.google.com/legal/corporate-cla-v1.0.html\n. @silvolu Is this current? https://developers.google.com/open-source/cla/corporate\n. Rebased. Checking with legal really quick if they're still here and will submit CLA as soon as I can. Thanks!\n. Legal dept @ Tagged (my employer) signed off on it. I filled out the form, scanned to PDF, and submitted it via email.\nThanks again.\n. @gws Ack. Taking a look, thanks!\n. See #189 for a broad fix for this. Also cleans up code dupe.\n. @silvolu I re-generated cacerts.pem using http://curl.haxx.se/docs/parse-certs.txt -- though I removed the extra fingerprint data as the file grew huge with them and it didn't seem totally necessary. Let me know if you want me to regen with fingerprints.\n. @jonof Good catch on 7.31.0 vs 7.30.0 -- just verified on http://curl.haxx.se/changes.html that the quirk must be applied to versions prior to 7.30.0, not prior to 7.31.0. I opened up a broader fix for this, see #189 \n. Interesting... The discrepancy seems to include the Proxy-agent: field which isn't handled by the code or other examples I've seen. Is it possibly for you to turn off addition of that field? It seems superfluous. I bet, though, that recent libcURL versions handle calculating all those lines. Makes me think we're handling the \"bad header size\" problem wrong if we're searching only for the HTTP/1.0 200 Connection established line.\nI'm willing to bet it's that Proxy-agent field -- if you have control over the proxy and can disable that extra field, that may solve your problem with a code change. However, I'd like to make the libcURL quirk handling stuff more versatile for these situations then.\n. @silvolu @ianbarber \n. Hm @djvirgen is right. Basically this fixes it for the most part except users of this function won't be able to override that which has already been set in $this->options without @djvirgen 's tweak.\nThanks!\n. Addressed @djvirgen 's comment in #122 -- thanks again everyone!\n. @ianbarber @silvolu Sorry, a colleague points out that my fix needs a slight tweak.\n. @silvolu @ianbarber Removing a dupe'd file that causes problems for non-Linux users. Didn't run into this until I pulled the changes into our repo and non-Linux users began complaining.\n. @ianbarber @silvolu \n. @silvolu \n. IMHO, In general, it's best to use $_SERVER['REQUEST_TIME'] if available -- makes the code more testable as it's easy to mock the $_SERVER variable.\n. @silvolu \nThis ought to fix issues #109, #117, #171 as @gws mentions in a comment on #109 \n. Ehrm that failed the build. Hold on...\n. Figured out my derp, let's see if passes CI now.\n. Seems I've appeased the CI gods. Thank goodness for unit tests. This really could use some unit tests as well to prevent regressions.\n. @gws Nice!\n. :+1: I like this idea. I originally authored the patch to not apply the workaround to cURL versions that had the calculation fixed (since it would then break with those.) I can't really think of anything better -- if RHEL patched this and kept the version # as one that's \"broken\", then it seems that a configuration flag is a good solution.\n. @silvolu \n. :+1: :ship: :it: \n. ",
    "gws": "@mishan I think this fix is incomplete because parseHttpResponse() is not always called. See the execute() method in Google_Http_REST for an example of this.\nOne way this problem can be reproduced in current master is by testing the Calendar service on old (\"quirky\") versions of cURL from behind a proxy.\nRelated: #109, #117, #171 \n. @mishan Ah, very nice! Thanks!\n. What you have here is good, and we should keep it.\nUnfortunately it doesn't fix the list of issues you mention - there are logic issues remaining in parseHttpResponse which I've attempted to address in #190.\nI believe this together with #190 address the cURL issues for good!\n. @Gemmu The only thing I can think of is adding a configurable flag which forces the workaround off, skipping the version check. Then, you could add this configuration variable to machines which have the RHEL patch until RHEL catches up to a cURL version where the fix has been implemented.\nHaving that flag in place wouldn't be a problem for for cURL versions >= 7.30.0 either, which would lower the chances of misconfiguration on an upgrade that bumped the cURL version.\n. @Gemmu I've created a branch in my own repo with an example of the above idea: https://github.com/gws/google-api-php-client/commit/26115279c3df36d69997a441885bf4c7e957024f\nYou would use it like this wherever you construct your API client object $client:\nphp\n$client->setClassConfig('Google_IO_Curl', 'disable_proxy_workaround', true);\nI can't think of a good way to test this, but I can submit a PR if you think this would work for you...\n. @Gemmu Great! I'm glad it works for you.\nI'm not familiar with the release schedule either, but I've opened #816 - let's take further discussion there once it passes CI and review.\n. This is only failing CI because of an unrelated issue - v1-master's autoload function is not conventionally named.\n. ",
    "wibblymat": "It looks like the same fix was made here: https://github.com/ianbarber/google-api-php-client/commit/b54cbbc1c9b9421d8f15fece3b48e7388c126e24#diff-12 but undone later.\n. @ianbarber done.\n. ",
    "pentium10": "@ianbarber That's cool. Do you need anything from me?\n. For example this is really nasty way to figure out how to obtain:\nphp\n try {\n            $resp = new Google_Service_Bigquery_TableDataInsertAllResponse();\n            $resp = $bq->tabledata->insertAll($project_id, $dataset_id, static::tableId(), $request);\n            $errors = new Google_Service_Bigquery_TableDataInsertAllResponseInsertErrors();\n            $errors = @$resp->getInsertErrors();\n            if (!empty($errors)) {\n                $error_msg = '';\n                if (is_array($errors)) {\n                    $line = 0;\n                    foreach ($errors as $eP) {\n                        $arr = $eP->getErrors();\n                        if (is_array($arr)) {\n                            foreach ($arr as $e) {\n                                switch ($e->getReason()) {\n                                    case \"stopped\":\n                                        break;\n                                    default:\n                                        $error_msg.= sprintf(\"Error on line %s, reason: %s, msg: %s\\r\\n\", $line, $e->getReason(), $e->getMessage());\n                                        break;\n                                }\n                            }\n                        } else {\n                            $error_msg.= json_encode($arr) . \"\\r\\n\";\n                        }\n                        $line++;\n                    }\n                    $this->setErrorMessage($error_msg);\n                } else {\n                    $this->setErrorMessage($errors);\n                }\n                //print_r($errors);\n                //exit;\n                return false;\n            }\n            return true;\n        } catch (Google_Service_Exception $e) {\n            $this->setErrors($e->getErrors())->setErrorMessage($e->getMessage());\n            throw $e;\n        }\n. ",
    "madebydavid": "The collection_key issue also affects other classes such as Google_Service_Translate_TranslationsListResponse where the value should be 'data'\n``` php\nclass Google_Service_Translate_TranslationsListResponse extends Google_Collection\n{\n  protected $translationsType = 'Google_Service_Translate_TranslationsResource';\n  protected $translationsDataType = 'array';\n  protected $collection_key = 'data';\npublic function setTranslations($translations)\n  {\n    $this->translations = $translations;\n  }\npublic function getTranslations()\n  {\n    return $this->translations;\n  }\n}\n```\nIs the generator for these classes somewhere within this project, or another project where we can submit a pull request?\nThanks,\n. ",
    "jonof": "I believe the problem is that the header length should only be adjusted for curl versions >= 7.30.0 since https://github.com/bagder/curl/commit/bc6037ed3ec029b9f1372f708521fcada4a74af7 suggests that it was first fixed in that release.\nThe code should perhaps read:\npublic function parseHttpResponse($respData, $headerSize)\n  {\n    if (stripos($respData, self::CONNECTION_ESTABLISHED) !== false) {\n      $respData = str_ireplace(self::CONNECTION_ESTABLISHED, '', $respData);\n      if (!$this->needsQuirk()) {\n        $headerSize -= strlen(self::CONNECTION_ESTABLISHED);\n      }\n    }\nAlso, the constant for 7.30.0 would be 0x071E00.\n~~I'm double checking this at the moment.~~\nEDIT: This is what I've come up with: https://github.com/jonof/google-api-php-client/commit/0fe93ee9f60813b738a98dd28e894aa95f787d9a\nI'll have to send a CLA if you want to accept it.\n. ",
    "stepanselyuk": "It's not fix all cases. From the logs (of the Facebook API client, which use same part of the code):\n```\nHTTP/1.0 200 Connection established\nProxy-agent: Kerio Control/7.1.1 build 1971\nHTTP/1.1 200 OK\nETag: \"5cda087310bbcd784e519292768580d683236e09\"\nContent-Type: application/json; charset=UTF-8\nPragma: no-cache\nAccess-Control-Allow-Origin: *\nX-FB-Rev: 1272844\nCache-Control: private, no-cache, no-store, must-revalidate\nExpires: Sat, 01 Jan 2000 00:00:00 GMT\nX-FB-Debug: tHoKhGeGW3vBjkYKlk/zSpKDhDpQXwFIGa3STiCmcPg=\nDate: Tue, 03 Jun 2014 09:41:24 GMT\nConnection: keep-alive\nContent-Length: 228\n```\nDetected headers size from Curl: 426\nContent-Length: 228\nCalculated header size: 510\nSo I use condition like this:\nphp\n...\nif ( preg_match( '/Content-Length: (\\d+)/', $respData, $m ) ) {\n    $headerSize = mb_strlen( $respData ) - $m[ 1 ];\n}\n...\n. Mishan, this is not my proxy, not under my control.\n. ",
    "pavlomr": "Same situation \n$respData for parseHttpResponse is:\n```\nHTTP/1.0 200 Connection Established\nProxy-agent: Apache/2.2.27 (Amazon)\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store, max-age=0, must-revalidate\nPragma: no-cache\nExpires: Fri, 01 Jan 1990 00:00:00 GMT\nDate: Tue, 10 Jun 2014 06:48:18 GMT\nETag: \"QBUNLRiC-3DOriVs-5K8xJenK9E/F8tr8ic5K_AwceHDZeTfMPwIb0k\"\nContent-Type: application/json; charset=UTF-8\nX-Content-Type-Options: nosniff\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nServer: GSE\nAlternate-Protocol: 443:quic\nTransfer-Encoding: chunked\n{\n\n}\n```\nmy workaround (i have api client in my repository):\n```\n--- Google_IO.php       (revision 1251)\n+++ Google_IO.php       (working copy)\n@@ -26,7 +26,7 @@\n  * @author Chris Chabot chabotc@google.com\n/\n abstract class Google_IO {\n-  const CONNECTION_ESTABLISHED = \"HTTP/1.0 200 Connection established\\r\\n\\r\\n\";\n+  const CONNECTION_ESTABLISHED = \"HTTP/1.0 200 Connection established\";\n   const FORM_URLENCODED = 'application/x-www-form-urlencoded';\n   /\n    * An utility function that first calls $this->auth->sign($request) and then executes makeRequest()\n--- Google_CurlIO.php   (revision 1251)\n+++ Google_CurlIO.php   (working copy)\n@@ -164,7 +164,7 @@\n    /\n   private static function parseHttpResponse($respData, $headerSize) {\n     if (stripos($respData, parent::CONNECTION_ESTABLISHED) !== false) {\n-      $respData = str_ireplace(parent::CONNECTION_ESTABLISHED, '', $respData);\n+      list($proxyHeaders, $respData) = explode(\"\\r\\n\\r\\n\", $respData, 2);\n     }\n if ($headerSize) {\n\n```\n. ",
    "vinhlh": "i have my own response \nHTTP/1.1 200 Connection established HTTP/1.1 200 OK Content-Type: application/json; charset=utf-8 Cache-Control: no-cache, no-store, max-age=0, must-revalidate Pragma: no-cache Expires: Fri, 01 Jan 1990 00:00:00 GMT Date: Wed, 25 Jun 2014 11:54:11 GMT Content-Disposition: attachment; filename=\"json.txt\"; filename*=UTF-8''json.txt X-Content-Type-Options: nosniff X-Frame-Options: SAMEORIGIN X-XSS-Protection: 1; mode=block Server: GSE Alternate-Protocol: 443:quic Transfer-Encoding: chunked { \"access_token\" : \"ya29.LgCu6cw-CibM2yEAAAD-rGIPeFU1pTKiuX3WCsHm34p2BeFCE0B50o0R-fGUQXdymRhil9vPHRdBvW16SM8\", \"token_type\" : \"Bearer\", \"expires_in\" : 3600, \"id_token\" : \"eyJhbGciOiJSUzI1NiIsImtpZCI6IjA2ZDE5NzdjOTRiOWEwMDA3MjQwZThhN2NiYTJlOGQ2ZDE5MWJiNGUifQ.eyJpc3MiOiJhY2NvdW50cy5nb29nbGUuY29tIiwiaWQiOiIxMTMxMjM5OTMwMTU0MzA3MzY1NTIiLCJzdWIiOiIxMTMxMjM5OTMwMTU0MzA3MzY1NTIiLCJhenAiOiIyMzEwNzc4ODQ4ODAtazQyY3ZmZWcxNnF1dTg3ZTJ0cnRubmRuZ3J2cGdvN3AuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJlbWFpbCI6Imh1bmcudmpuaEBnbWFpbC5jb20iLCJhdF9oYXNoIjoiaGZHa3hXTXhsbmxFVFpwUWZsWEtkUSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJhdWQiOiIyMzEwNzc4ODQ4ODAtazQyY3ZmZWcxNnF1dTg3ZTJ0cnRubmRuZ3J2cGdvN3AuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJ0b2tlbl9oYXNoIjoiaGZHa3hXTXhsbmxFVFpwUWZsWEtkUSIsInZlcmlmaWVkX2VtYWlsIjp0cnVlLCJjaWQiOiIyMzEwNzc4ODQ4ODAtazQyY3ZmZWcxNnF1dTg3ZTJ0cnRubmRuZ3J2cGdvN3AuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJpYXQiOjE0MDM2OTY5NTEsImV4cCI6MTQwMzcwMDg1MX0.U86U0sv6KNw6ji36PCWxkmd405ft_GB2gYYuOV13oRNbglS62Fo4yel_C7825ZOi1oHG6yKNFqEs_jtgwLHsor2cjIt53aRqvd3y5frYDFOsFnAGSFiDaOMXl1d_QcwiKJ6sN_LYX6Ti7sd9ph1KOCwi7BF689F9NbOM_xQED7A\" }\nthe solution of pavlomr dont work for me, because there are any \\r\\n characters.\ni am using latest version, curl, and throught proxy.\nMake Steam as IO default class will work temporarylly for me :(\n. i think i found my problem same here\nhttps://github.com/google/google-api-php-client/issues/117\n. ",
    "adamors": "This is still a problem.\n. I see. Right now I tried overriding the Google_Client and Google_IO_Curl classes, and had to change the visibility of their attributes in order to do so. \n. I needed to override those classes because I could not see a way around changing the settings used with curl. I was trying to access the service through a proxy and needed to modify those settings. \nThen I needed to override the client class to load my own class for curl.\n. ",
    "romanopablo": "Anyone has solved this? i had to replace the 1rst header with empty value. But i need a more elegant solution.... ",
    "FKobus": "I filled in the form for the CLA that you mentioned in other pull requests. So that's handled.\n. Hi Ian,\nI didn't know that the service files are generated from the discovery. If so, the search call is definitely a bug.\nNo, mqlread is not available via the explorer. How can we manage to add support for it in this client? My code works perfectly on the mqlread functions. So I want to use that instead of the basic search. But I want to maintain updates going smoothly in the future.\nIs there anyway I can help with getting the support for mql into the API explorer?\n. Hi Ian,\nThanks for fixing the call method. Can you send me in the right direction to add the mqlread function? Where can I ask the freebase team to add that support?\nThanks in advance.\n. ",
    "uquaisse": "Ok great\n. ",
    "stephanvierkant": "Thanks! I did: http://stackoverflow.com/questions/22324890/download-a-mailbox-using-email-audit-admin-sdk\n. I still have some problems to implement this. It seems like the documentation is not correct or there is a bug somewhere. I've got the API client working (i.e. Drive works), but the email audit doesn't work properly (\"You are not authorized to access this API.\"). Could it be a bug?\n. ",
    "divyabatra": "thanks for your help..\n. ",
    "DavidAnderson684": "It occurs to me that I can achieve my goal by using the Range: header, and downloading in small chunks until I've got the whole file. Feel free to close this issue if you think that's the best solution rather than streaming direct to a file handle.\n. You're completely right... thank you.\nWhat I'm not seeing now is how to adapt that code to actually resume. It looks like I would need to be able to keep track of the value of the resumeUri property of the Google_Http_MediaFileUpload object, and store that locally - and re-use it when I need to resume (if the initial upload gets aborted). But this property is kept private. Any ideas? Or even example code? (I looked - couldn't find any).\nBest wishes,\nDavid\n. Indeed, by making Google_Http_MediaFileUpload::resumeUri to be a public property, I can successfully resume.Google_Http_MediaFileUpload::progress also needs to be public. With just those two alterations, I am successfully resuming at any point I like. (By locally remembering those two values in between each chunk; I can then restore the state full by writing back to those values from my remembered values at a later point).\nObviously this can't be the proper way to do it... any clues?\nDavid\n. That's only any good if you've still got the original request object lying around, isn't it? i.e. No good if you're a separate process entirely.\nIn my case, it can be a separate process entirely. The previous PHP process, in such a case, usually got killed off by the webserver for reaching a time-limit. It needs to resume.\nHere's my code (is working for me - after I made those properties public, that is, which I realise isn't the official way you'd want to do it (get and set methods, etc.))... the relevant bit is in the 'upload_file' function: http://plugins.svn.wordpress.org/updraftplus/trunk/methods/googledrive.php\n. By the way... if you try to resume from a point that is not exactly the point where you left off (e.g. if you try to resume from a point 1000 bytes earlier), then at some later indeterminate (i.e. any number of chunks later), stage the server will give an error and after that you have to restart the whole upload from the beginning. This particular one looked more like a server issue than the SDK, but might be worth looking at.\n. Done.\n. Hi,\nWhat does \"stuff in discovery\" mean?\nDavid\n. @lemoslincoin - see: https://github.com/yasirsiddiqui/php-google-cloud-print and https://github.com/yasirsiddiqui/php-google-cloud-print/issues/1\n. I wanted to ask about this also, as I am using the SDK as part of a WordPress plugin - WordPress supports PHP 5.2.4 onwards. (I know: nobody sane should be using PHP 5.2 now... but sadly, it's still out there, and if you have a 500,000 install base on a WP plugin, there are plenty of people who'll complain if it breaks...)\nDavid\n. My code also has to set Google_Http_MediaFileUpload::progress in order to resume, so that has to be settable too.\n. It's still there. I don't seem to have a way to re-open directly, so will open a new one.. @mattwhisenhunt We didn't fix it. We put to one side investigations into whether the stream handler would be useful.. ",
    "dd32": "CLA submitted using public github email.\n. ",
    "Dundee": "Great, thanks!\n. ",
    "simoncast": "Quite possibly. HHVM is mostly equivalent to 5.4. I just tried PHP5-FPM and it worked with the specified mod. The PHP version was\u00a0PHP 5.5.10-1+deb.sury.org~precise+1\nOn 10 April 2014 at 17:03:28, Ian Barber (notifications@github.com) wrote:\nHmm, that constant is only in 5.4 from a quick search. We'll need to define it if not present, but otherwise sounds like a good fix.\n\u2014\nReply to this email directly or view it on GitHub.\n. Sorry, I\u2019ve not had a chance to investigate further and I\u2019ve also not seen it happen recently. I\u2019ll keep an eye on it.\nOn 14 May 2014 at 18:51:31, Ian Barber (notifications@github.com) wrote:\nI am presuming you are calling verifyIdToken somewhere, but the token is not present. I'll close this for now, but if you have test code that reproduces the issue let us know! I suspect it's probably a case of calling verifyIdtoken when users aren't signed in though.\n\u2014\nReply to this email directly or view it on GitHub.\n. ",
    "tcope25": "I'm still having this issue. Anyone else?\n. ",
    "ganey": "I spent ages trying to get this to work. In case anyone else ends up looking here, I ended up putting file_get_contents around the key location:\n$credentials = new \\Google_Auth_AssertionCredentials(\n                    $client_email,\n                    $scopes,\n                    file_get_contents('/some/folder/keyname.p12)\n                );\n. ",
    "jbduzan": "it fail inside OAuth2:verifySignedJwtWithCerts. \nLine 500 of OAuth 2.php\n// Check signature\n    $verified = false;\n    foreach ($certs as $keyName => $pem) {\n      $public_key = new Google_Verifier_Pem($pem);\n      if ($public_key->verify($signed, $signature)) {\n        $verified = true;\n        break;\n      }\n    }\n. Seems to happen when Pem::verify call openssl_verify, it always return 0 (not -1, never get the exception thrown)\n. seems to be good, is there a way to flush this cache ? \n. deleted the google_client folder from temp directory, error still here\n. i just did a new authentification.\nThe token look like the same than last week for me.\nBut https://www.googleapis.com/oauth2/v1/tokeninfo?id_token=token return valid informations\n. retrieving it from the callback function of my signin button in javascript. It's a property of my access token\n. seems to have a really old version : OpenSSL 0.9.8q 2 Dec 2010\n. ",
    "ZeroNilZero": "It's timezone fault!\nin my case it's work(day), not work(night after 12AM), work again(tomorrow)!\nwhen it's stop working, just set timezone to America/New_York and its work, remove timezone then stop working.\nAnd its happened because of some country have future date window rather than usA.\nyou know that if you change your system date time then SSL stop working.\nI think it's the same problem. google sign it for it's own today but actually your yesterday!\nphp 7.1\nmacOS Sierra\nTimezone 3:30\n. ",
    "doubleOrt": "@NexProME Are you sure ? i just used both date_default_timezone_set('America/Los_Angeles'); and date_default_timezone_set('America/New_York'); and it's still not working. However, i can confirm that it does work during the day and stops working as darkness conquers the sky.. @ianbarber Moving to OpenSSL/1.0.2l (this is the version of OpenSSL that is printed out by phpinfo()) didn't fix the issue. What should i do now ?. @bshaffer  Tried all these options and, nope, not working. . ",
    "citaliano": "I also want to point out that those same users also do not appear as a result of using this tool:\nhttps://developers.google.com/admin-sdk/directory/v1/reference/users/list\nSo it isn't my code that's the issue.\n. I tried that, but there is no response. Has Google abandoned supporting the\nAPIs? I miss the days of  the Google Group.\nOn Fri, Apr 18, 2014 at 2:44 PM, Ian Barber notifications@github.comwrote:\n\nClosed #164 https://github.com/google/google-api-php-client/issues/164.\n\nReply to this email directly or view it on GitHubhttps://github.com/google/google-api-php-client/issues/164\n.\n. Is that considered a \"Core Service\" though? I know they won't support you\nfor anything else.\n\nOn Fri, Apr 18, 2014 at 2:59 PM, Silvano Luciani\nnotifications@github.comwrote:\n\n@citaliano https://github.com/citaliano you should report your problem\nto the Google Apps technical support using the Admin Console for the domain.\n\nReply to this email directly or view it on GitHubhttps://github.com/google/google-api-php-client/issues/164#issuecomment-40834782\n.\n. \n",
    "frieser": "I have this issue too, I figure that is not fault of the client library, but do you know a workaround for this problem? I found this http://milancermak.wordpress.com/2012/08/24/server-side-verification-of-google-play-subsc/ but it hope it is solved since 2012\n. ",
    "chixor": "Oh, didn't see that there. Signed.\n. ",
    "CedNet": "I reverted back to 1.0.1 beta and the response is totally different. This is what you get with 1.0.1. And which works! \nobject Google_Service_Translate_TranslationsResource (4) {\npublic detectedSourceLanguage -> NULL\npublic translatedText -> string (33) \"Svar p\u251c\u00d1 unders\u251c\u00a9kelsen av nyhets\"\nprotected data -> array()\nprotected processed -> array()\n}\nPlease let me know what has changed. Thanks!\n. Hi again. I actually know too little about the setup of this package to so any digging into the code. \nIf you test you see above which answer your new code should respond with. \nBtw google does state that their code is beta and will not have backward compatibility. Do you work with fixed versiospas you update your own code? \n. ",
    "itsnotvalid": "@ianbarber after upgrading to 1.1.1, it still doesn't work and the same bug is reproducible using the code from @CedNet. Please reopen either of the bugs, thanks.\n. ",
    "LeonB": "I'm having the same issue. return $this->modelData['data']['translations']; worked for me.\n. ",
    "satyamong": "how to solve or tell me the step by step process \n. ",
    "SergeC": "It's in master branch here https://github.com/google/google-api-php-client/blob/master/src/Google/Service/Freebase.php#L280\n. I opened issue on FreeBase issue tracker https://bugs.freebase.com/browse/API-102 . No response during half a year. I forced to reopen this issue again because problem not solved. \n. ",
    "Bersam": "Duplicate Issue: https://github.com/google/google-api-php-client/pull/123\n. ",
    "derekperkins": "Selecting a different auth type in configuration sounds like the best option.\nWould it matter if one auth class wasn't 5.2 compatible? That class is only applicable if you're actually hosting on App Engine, which means you're at least on 5.4.\n. You could do a check for the php version and throw an exception in the client construct or new auth class if their version doesn't support namespaces.\n. ",
    "developer10": "Tried that before, didn't work. Tried it again - still doesn't work. So event though you closed this issue, it remains. \nFor this method inside Client.php it says Fatal error:  Using $this when not in object context in...:\npublic function getIo()\n{\nif (!isset($this->io)) {\n$class = $this->config->getIoClass();\n$this->io = new $class($this);\n}\nreturn $this->io;\n}\n. That code is present in one of Google's example tutorials. But anyway i believe it is wrong. However, not sure why then $client->getIo() doesn't work because $client object is instantiated and getIo() method is public.\n. ",
    "NeoCsatornaja": "Can I get solution for this problem?\nhttp://stackoverflow.com/questions/36958669/upload-video-to-youtube-with-one-single-button-using-javascript\n. ",
    "petersowah": "I'm having the same problem. I need to know if you have the solution to the problem yet. Thanks.\n. @ianbarber My code is posted below;\n``` php\n<?php\nuse \\Google_Client;\nclass GoogleController extends \\BaseController {\nprotected $client;\n\npublic function __construct(Google_Client $googleClient = null)\n{\n    $this->client = $googleClient;\n    if($this->client)\n    {\n        $this->client->setApplicationName('APP_NAME');\n        $this->client->setClientId('CLIENT_ID');\n        $this->client->setClientSecret('CLIENT_SECRET');\n        $this->client->setRedirectUri('REDIRECT_URI');\n        $this->client->setScopes('email profile');\n    }\n}\n\npublic function isLoggedIn()\n{\n    return Session::get('access_token');\n}\n\npublic function getAuthUrl()\n{\n    return Redirect::to($this->client->createAuthUrl());\n}\n\npublic function checkRedirectCode()\n{\n    if (Input::get('code')) {\n\n        $this->client->authenticate(Input::get('code'));\n\n        $this->setToken($this->client->getAccessToken());\n\n        $payload = $this->getPayload();\n\n        echo 'pre', print_r($payload), '</pre>';\n\n        return true;\n    }\n\n    return false;\n}\n\npublic function setToken($token)\n{\n    Session::put('access_token',$token);\n\n    $this->client->setAccessToken($token);\n}\n\npublic function googleLoginCallback()\n{\n//  $code = Input::get('code');\n    $this->setToken($this->client->getAccessToken());\n    $payload = $this->getPayload();\n\n}\n\npublic function getPayload()\n{\n    $payload = $this->client->verifyIdToken()->getAttributes();\n\n    return $payload;\n}\n\n}\n```\nand that returns the error Undefined index:id_token. I'm using the laravel framework. Thanks so much.\n. I found a solution to my problem. I called the checkRedirectCode() in googleLoginCallback()\n. ",
    "mhayes14": "Having the same issue here. Auth has been working for months and then decided to pack up today with this error. Still investigating.\n. So if I revoke access to the app from my account, then authorize again, the id_token is there and everything works fine. Second login onwards and the id_token is missing again, until I deauthorize and start again. I have stepped through (and actually ended up rewriting some of) both my code and the Google API code and cannot find any issues.\nDocs (e.g. https://developers.google.com/api-client-library/php/guide/aaa_idtoken) suggest that the id_token should be there just as it always has been. I have a bunch of apps where Google auth is failing all of a sudden today due to this id_token being missing. Does anybody have any pointers? My setup is similar to the token_id example: https://github.com/google/google-api-php-client/blob/master/examples/idtoken.php\nEdit: For now I am going to start making a call to https://www.googleapis.com/oauth2/v3/userinfo?access_token= (I'm not sure how this is done with the library or if it can be, if not I will just use curl). I would love to know why the id_token has gone missing today though as it has caused me and my users a lot of grief. The userinfo request should do for now though, at least they will be able to login.\nEdit 2: Typically, just as I was about to apply the fix mentioned in my edit, everything is working as normal now and the id_token is being returned. Google issue? I was hesitant to believe it was a Google issue originally because 1) I could not find any kind of API status anywhere mentioning this and 2) Google... reliability problems?? Never!\nCheers\n. @robinmessage That's nuts. It looks like you're correct. It says in another section (https://developers.google.com/accounts/docs/OAuth2Login#scope-param) \"The scope value must begin with the string openid and then include profile or email or both.\". Why would they change something like that without backwards compatability? Surely the PHP library should be handling prepending the \"openid\" part anyway.\nStrangely everything has just started magically working again right now, not sure if it will stay this way though after having issues all day long so I'm still a bit on edge.\n. Have confirmation via someone at Stackoverflow that there was a Google issue however it has now been resolved.\nhttp://stackoverflow.com/questions/25790135/occasionally-missing-return-parameter-id-token\nhttp://stackoverflow.com/questions/25796344/missing-parameter-from-return-id-token\nNow I have to try and catch up on the lost time which I spent messing around with this :dash: \n. ",
    "robinmessage": "BlueHayes: We are experiencing the same problem. It looks like Google may have changed things so your OAuth2 scope needs to contain openid email whereas before it worked without this. See https://developers.google.com/accounts/docs/OAuth2Login#sendauthrequest for more details of the scope you need to provide.\n. ",
    "mzmmlds": "i had the same problem, but i resolved to by passing id_token with verifyIdToken() function. Below is the complete code for reference.\nif (Session::has('access_token')){ \n         $token = Session::get('access_token');\n```\n     $idToken = json_decode($token);\n $token_data = $client->verifyIdToken($idToken->id_token)->getAttributes();\n $user_id = $token_data['payload']['sub'];\n\n dd($user_id);\n\n $client->setAccessToken($token);\n\n```\n}\ni'm using laravel framework.\n. ",
    "judgej": "@mzmmlds Is this still working for you? The $client->verifyIdToken($idToken->id_token) statement for me is returning boolean false rather than an object. I'm guessing it isn't verifying for whatever reason, but https://jwt.io/ does decode the idToken correctly. Is there a way to decode it without verifying it?\nOr maybe I need to find out why it is not verifying correctly? Edit: ha, correct secret but wrong client_id. I seemed to have only copied half the client ID into my app, it was was still authorising users, but failing on the idToken signature verification.\nHowever, both $client->verifyIdToken($idToken->id_token) and $client->verifyIdToken() are returning the array of JWT details, not an object. The ->getAttributes() must be dropped completely. This is mentioned as a change to the API client here. This is very interesting. None of the examples in the documentation tackle the problem of persisting the refreshed token at all. Instead, they keep using the initial token, which should include the refresh_token, over and over. That appears to work, but having put in a $client->setTokenCallback() as suggested by @dbbk I am seeing that the first request on every single page attempts to use the initial stored access token, finds it has expired, silently renews it using the initial stored refresh_token. Then on the next page, it goes through the whole process again. The access token is being renewed every single time the API is accessed (once per page).\nThat can't be good for network traffic! So the examples given seem to work beyond the 3600 seconds of the initial token being issued, but they are not working in the way people think they are.\nWhen persisting the new access token, it needs to be provided in the same form as it was originally (access token, expiry time, refresh token etc.) since that is exactly what was persisted for the original authentication, is exactly what is given to the API client each time it is used, and is exactly where the API client gets the refresh token from when it needs it. So if it is being replaced in storage with a refreshed version, it needs to be complete enough, so that new one will work in another 3600 seconds when that expires.\nNote: I am not manually renewing the token when its time has expired. I just letting the API client do that for me silently, which it will do (presumably on getting a 401) only if the access token it is given includes the refresh token in its structure.\nAdditional:\nThe API client auto-refresh seems to be time-based. Given the persisted access token, the created time needs to be updated too. This stores it in the session, as per many examples that store the original in the session with $_SESSION['token'] = $client->getAccessToken();:\nphp\n$client->setTokenCallback(function ($cacheKey, $accessToken) use ($client) {\n    // Persist the access token.\n    $_SESSION['token']['access_token'] = $accessToken;\n    // Without moving the created time on, the API client will refresh on every page load.\n    $_SESSION['token']['created'] = time();\n});\nNow the question is what happens on the edge case? If the stored timestamp says the token has not expired, but Google with a server 5mS ahead of my clock says it has expired. Does the API client still silently refresh the token, or does it raise an exception? Getting the timing right to test this would be near impossible, so I guess I'm going to have to dive into the code. Edit: ah yes, I just wind the created time back after the token has expired. The API client cannot handle that - just raises an exception with a 401 error. That's a shame, because the token could expire at ANY time during ANY API call, and having it caught in the core API client so the token can be refreshed, followed by a retry of the API call, makes a lot of sense. There is really no reason the application using this library should have to handle it on every remote call.. ",
    "LindaLawton": "use examples / simple-query.php simply exchange the Google/Service/Books.php for Analytics.php and create an Analytics service.    I'm working on a side GitHub project for sample / examples for each of the Google APIs. \n. Yes it is possible to upload a file to Google drive in a specific directory.   Try asking for help on StackOverflow http://stackoverflow.com/questions/tagged/google-api-php-client or http://stackoverflow.com/questions/tagged/google-drive-sdk\n. There is someone else with this error message on StackOverflow.  His is related to plus.login. I think he is doing it wrong, but that's beside the point.  The point is they are both seeing this Unable to Connect: '0' error message, which makes me wonder.   So i thought i would bring it to your attention.  http://stackoverflow.com/q/23742576/1841839\n. Just as an off chance that its this.   When you created your app in Developers console did you remember to go to Apis & auths -> consent Screen and add an email Address and Product name?  Both those values must be set or you get an error from the client. The thing is its a different error message in .net client lib (think its invalid client_id), but i wonder if maybe the PHP client lib just isn't spiting out the same error message.    I can't test this until I get home tonight, was just an idea.\n. @rowanrh  i tested the simple-query.php example and it works fine.   I'm wondering it has something to do with your connection, your app set up in Google Developer Console, or even that you didn't copy the full Google Directory.  \nSo here is an insane test.  The following zip is a working example using my API key.\n1.  If it doesn't work then its probably your connection. \n2.  If it does work then its probably your app key or the directory\n    a. try and swap it for your app key.  If it doesn't work we know its your app key that's bugged.   If it does then your all set, and can start having fun with the APIs.  :)  \nIf it does work with my app key but not yours we need to fix yours.  Its a development App key, I delete it from time to time, because i tend to leak it out on the net by mistake, or like now to help people test issues. \nhttp://www.daimto.com/Tutorials/PHP/Books.zip\n@WaldoJeffers looking into yours now.  I'm still trying to recreate the bug.\n. You should just be able to do http://localhost/books/\nLast idea, I was also unable to get Apache on windows to work with the client lib when i tried a month ago.  I wondered if it had to do with the fact that all the includes where using the Linux Dir (/) structure and Apache on windows well looks for the windows Dir structure ()  Someone recommended i try XAMPP and it worked like a charm  https://www.apachefriends.org/index.html .    If that doesn't work i'm out of ideas.  \nbtw where are you in the world?\n. Ahh thank you.  Is v1 staying?  I will change my links in the tutorial to that then.\n. @bshaffer adding composer to my tutorials seams a bit over kill.    I would rather keep them pure code but i will look into it. \n. I don't have an application I have a tutorial. So there is no \"directly into your repository\" No code is committed anywhere besides to the WordPress page. \nI am looking for the best way of creating tutorials that wont break when you guys update stuff.     I would appreciate your advice in that.   This is the second time I have had to update all of my tutorials because of a change.  The first was when you added autoload.php.\nBTW keep up the awesome work you are doing on this library.  I really appropriate it.\n. As stated in the documentation Accounts: list. Lists all accounts to which the user has access.  This is the current authenticated user.    I searched the Link you posted there is nothing in there that states its application based.  If you can link me the exact statement i will send it off to the Google Analytics API team for correction.\nThe results returned by the API are correct.   \nEven the old legacy v2  Account Feed The account feed is the entry point to all management information for the authenticated user.\nEach request you send against the google api is against the authenticated user.   It has nothing to do with the authenticated applications access.   This is something ingrained in OAuth and not related to the PHP client library.  If anything it would be related to the Google Analytics API. \n. Tip:  Account Summaries: list   will get back all the Accounts -> web properties -> and views that a user has access to in one call :)\n. Links to another question on stack along the same lines. Google Analytics Reporting API V4 with \u201cRequest had invalid authentication credentials\u201d\n. @yasithao3  thats what approval prompt force does.  It forces the user to consent to your access again.  If you want a refresh token you must have the users consent for that.    \nYou should be saving the refresh token the first time you received one.  They do not expire.  . Links to question on Stackoverflow Empty batch encountered error in DoubleClick Serach API using google-api-php-client. I can verify that there is nothing wrong with the request it self.   I tested it using the Google .net client library and it worked fine.     \nI have googled around and this looked like it could be client library related. \nhttps://groups.google.com/forum/#!topic/my-business-api/cIp9Oj7vt0o\nhttps://groups.google.com/forum/#!topic/my-business-api/O0Bfkmzh1VQ\nhttp://stackoverflow.com/questions/39185845/creating-a-sheet-with-more-than-1000-rows\nhttps://github.com/GoogleCloudPlatform/google-cloud-php/issues/183. Not all files have a downloadUrl it depends on the file type.    You should ask this question on Stackoverflow.com. With which API?  This is a client library which helps you access google apis.  If you have an api realted question you may want to try asking on STackoverflow.com. so sending an empty array would be acceptable?. In your opinion what is the best way for users to do this?   I was hoping to be able to have a single function which would take the parameters.   I am worried your option two will confuse users.  \nI am in the process of building the generated sample templates for this library.    Any guidance you can to give in building solid samples which will follow your best practice guidelines would be appreciated.   Google-APIs-PHP-Samples . I thought this library used the standard generator the one written in python.   . so there is no interest in fixing this issue?. @tmatsuo which method are you looking for?  If you want something add to the V3 of google drive you will need to post an issue on the Google drive api issue forum.  We can only build an library out of what they offer.. check that $gClient isn't null before running a getAccessToken\nThis appears to be a question about how to use the client library rather than an issue with the client library. Please post questions on stack overflow using the tag google-api-php-clinet someone there should be able to assist you.\n@mattwhisenhunt recommend closing this.. function filtersListExample($service, $userId, $optParams)\n{\n    try\n    {\n        // Parameter validation.\n        if ($service == null)\n            throw new Exception(\"service is required.\");\n        if ($optParams == null)\n            throw new Exception(\"optParams is required.\");\n        if (userId == null)\n            throw new Exception(\"userId is required.\");\n        // Make the request and return the results.\n        return $service->filters->ListFilters($userId, $optParams);\n    }\n    catch (Exception $e)\n    {\n        print \"An error occurred: \" . $e->getMessage();\n    }\n}\nlink. There is a limit to the number of requests that you can make in a day and batch does not help you with this limit.   There is also a limit on uploads thats kind of a stealth limit,  its not documented.    Even though your using copy I would strongly suspect that its also using the upload limit as you are technically moving files.\nLets say my quota is 20 and I send four batch requests with five requests in each request to batch.   I have still blown out my quota of 20 because the total number of requests within the batch is 20.\nThere is no purpose to batching other then removing the back and forth with the server.     As for the file upload quota it is not documented because google tends to change it a lot.    Last I heard it was around 50 per user.   You seem to have been lucky to get more then that.\nThis isnt an issue with the client library this is an issue with Quotas in Google APIs.   that being said i have pinged someone on that team to see if he can give me any hard info on what the quota limit is.. try\n   $shortlink = $service->url->insert(\"https://example.com\");\n\nIf that doesnt work try\n   $optParams = array('fields' => '*');\n   $shortlink = $service->url->insert(\"https://example.com\",  $optParams);    . Links to [Can't quickstart with PHP for Google Analytics](https://stackoverflow.com/q/50898330/1841839)  Note this is not my question i am just linking it here for documentation reasons.. The [v1-master](https://github.com/google/google-api-php-client/tree/v1-master) branch is for use without composer.  Your going to have to see what that does and load things accordingly.\n\nTry checking the examples in that branch here  if you have any questions put a question up on stack overflow i should spot it.  Tag it google-api-php-clinet.     session_start();\n    include_once \"templates/base.php\";\nrequire_once realpath(dirname(__FILE__) . '/../src/Google/autoload.php');\n\nShould work even without using composer the issue is where you have put your files.  When you download the library the paths have to be correct or your not going to be able to find autoload.php.. I think you should post a question on stackoverflow this is not an issue with the client library but an issue with your ability to use the tutorials provided.  You should follow with tutorial Hello analytics\nIf you cant use composer you simply need to download this branch v1-master  and make sure the src/Google directory is in your directory with your file. \n. The Google+ API is read only there is no way to post to it.    You can post to your domains account using the Google+ domains API but these posts will not show up on the Google+ social media website.\nThis question really isnt related to this library but rather to Google APIs themselves. . have you tried adding valid scopes like\nGoogle_Service_Drive::DRIVE\nGoogle_Service_Sheets::SPREADSHEETS. Because my way is the documented way of using this library.  Which uses the variables that were created for the purpose.  Yours is a string that you yourself typed and may or may not be typed in correctly.\n\nThat being said your first call doesnt work because you are calling it in correctly.   If you check the documentation files.get has a required parameter of fileid followed by an option string array containing the option parameters.\n$response = $service->files->get($sheetID, array('supportsTeamDrives' => true));\n\n. Yes quota user should be working with this library.  \n$optParams['quotaUser'] = \"ABCXYZ123\";\n$analytics->reports->batchGet( $body, $optParams )\n\nYour code looks correct to me.  \nYou haven't mentioned which quota error you are getting with this.  However remember the quota with the Google Analytics API is based upon the view and not upon the user.   Also due to the batching nature if you are sending more then one report you can easily hit a quota.    If its coming from the same IP address going against the same view using a different quotaUser i dont think its going to help you.. make sure your file isnt named php.php or something like that.\nBeyond that Please post questions on stack overflow using the tag google-api-php-clinet I would be happy to have a look. Each API and each method within an API has a different number of max value that can be returned by a call.  The max results that can be returned by YouTube.Subscriptions is 50 per call.  \n\nmaxResults | unsigned integerThe\u00a0maxResults\u00a0parameter specifies the maximum number of items that should be returned in the result set. Acceptable values are\u00a00\u00a0to\u00a050, inclusive. The default value is\u00a05.\n\nYou will need to use pageToken and preform pagination to retrieve additional records. \n. This appears to be a question about how to use the client library rather than an issue with the client library.  Please post questions on stack overflow using the tag google-api-php-clinet someone there should be able to assist you.  . This appears to be a question about how to use the client library rather than an issue with the client library.  Please post questions on stack overflow using the tag google-api-php-clinet someone there should be able to assist you.  \n@mattwhisenhunt  recommend closing this.. I would love more information about the new endpoint will it work with all APIs?\nI was not aware there would be a new endpoint the documentation seams to emply its being removed not replaced. I supposed the issue could be with my understanding of the word homogeneous which I don't understand in this context.. OK now I think i understand that part. \nHowever lets consider this now \n\nTo identify whether you use JSON-RPC, you can check whether you send requests to https://www.googleapis.com/rpc or https://content.googleapis.com/rpc. If you do, you should migrate.\n\nAs I understand it the document says that batching should work with the new endpoint and shows an example of the JS library using the new endpont.    However my understanding which may be wrong was that not all of the Google APIs apis supported using this rpc endpoint.  Which is why the discovery doc says \n\n\"batchPath\": \"batch/calendar/v3\",\n\nSo am I to understand that the Client libraries will all be regenerated to support this new endpoint and not completely remove the batching ability from the libraries. (with the exception of heterogeneous  requests)   There by adding JSON_RPC support.\n. > If you are currently forming homogeneous batch requests\n\nAnd you are using Google API Client Libraries, then simply update to the latest versions.\nIf you are using non-Google API client libraries or no client library (i.e making raw HTTP requests), then:\n1. Change the endpoint from www.googleapis.com/batch to www.googleapis.com/batch//.\n2. Or, simply read the value of 'batchPath' from the API's discovery doc and use that value.\n\nWe are currently using that end point so what exactly are they discontinuing? is the HTTP www.googleapis.com/batch still going to work or not\nLooks like this library uses the global batch path batch.php   Its probably going to have to be changed to build the batch path with in each api which means a change to the script building each api from the discovery service.. remove  \n$request->setFields(\"hidden\");\n\nfrom your request. The redirect URI you are sending is\n\nstoragerelay://http/bunny-6969.appspot.com?id=auth446392\nclient_id=609295648701-sa2phkabvkieheivu2320jvee0ugb3od.apps.googleusercontent.com\nss_domain=http://bunny-6969.appspot.com\ngsiwebsdk=shim\n\nYou cant do that.  first of all storagerelay will never work it needs to be a true path to a website. and you cant have any fragments on the end.    Redirect uri you are sending must exactly match the ones you have listed in Google developer console.. Sounds like YouTube API.    Can you include your code please.   Remember that Youtube is channel based so if you authenticated to one channel you can only upload to that channel.. Can one of you just put your code up on stack overflow so i can take a look save us a bit of time :). assuming this is drive v3 it doesn't return the fields you don't ask for.   do a file.get with the optional parameter of fields=. I already have a sample for that method but its hard to know what he's doing with the information he has posted.  However his code does have name which means its likely v3 hes using as v2 was title so adding fields= should fix the problem.\nI don't think we need more samples than the ones generated unless you want something more specific like upload or batching.    \nI just need to generate them more often but no one has asked recently so I haven't generated for php or .net in a while.. ## Actual documetnation\nOnly place i know if it being documented is here Migrate to Google Drive API v3\n\nFull resources are no longer returned by default. Use the fields query parameter to request specific fields to be returned. If left unspecified only a subset of commonly used fields are returned.\n\nContradicting documentation\nThe page you mention Performance Tips says.\n\nBy default, the server sends back the full representation of a resource after processing requests. For better performance, you can ask the server to send only the fields you really need and get a partial response instead.\n\nThis statement is not true for all method types.  You may have better luck getting them to fix the documentation than I have had over the years.  I suspect that a lot of the documentation for this api was copied from the v2 documentation.   This \"feature\" was not present in the v2 of the google drive api there everything was always returned and developers could chose to limit what data was returned.    \nMy attempts at clarification\nI have a question about this on stack overflow from when the api was first released How to get full file get response from Google Drive V3  I contacted the team and this was working as intended.   They do not want you returning everything.   \nMy drive sample FilesListSample.php sets fields * by default to avoid an issue with this.\nBackground info\nExample  try me\n GET https://www.googleapis.com/drive/v3/files?access_token={your token}\n\nreturns a list of \n{\n   \"kind\": \"drive#file\",\n   \"id\": \"18MAoTSsg28mCBhInjYSop-gr3Prj0QdQcWkTCPxgycU\",\n   \"name\": \"Facts about You - GDD India\",\n   \"mimeType\": \"application/vnd.google-apps.presentation\"\n  },\nThe issue then being that if the full files#resource is not returned then the client library fills in null for the values that the API doesnt return \nExample 2  try me\nGET https://www.googleapis.com/drive/v3/files?fields=*&access_token={your token}\n\nreturns \n{\n   \"kind\": \"drive#file\",\n   \"id\": \"18MAoTSsg28mCBhInjYSop-gr3Prj0QdQcWkTCPxgycU\",\n   \"name\": \"Facts about You - GDD India\",\n   \"mimeType\": \"application/vnd.google-apps.presentation\",\n   \"starred\": false,\n   \"trashed\": false,\n   \"explicitlyTrashed\": false,\n   \"parents\": [\n    \"0B-1TopiXd27DRm5RSlpHck43WXc\"\n   ],\n   \"spaces\": [\n    \"drive\"\n   ],\n ..... add everything here\na full files#resource  there by populating everything in the response from the library.  \nTip\nAsking me questions about inner workings of google apis tends to result in wall of text.  Sorry :). to my knowledge text to speech API is not a discovery services API and there for not supported by this library.. This is what I have generated now\nhttps://github.com/LindaLawton/Google-APIs-PHP-Samples/tree/master/Samples\nI am not seeing it so it must have either failed to generate or this is a new API that was released since I last generated samples.\nWhich means I need to run it again and see what shows up :). Make sure you have added the service account email address as a user on YouTube analytics\nTBH I am really not sure that it supposed service account authorization. >(403) Forbidden\nIs an authentication error.  The user you are authenticated with does not have permissions to do what you are trying to do.     You may think you are authorizing correctly but you wont have permissions to do anything.   A service account is not you its a user that needs permission to access data.\nI just did some checking You can't use a service account when making a YouTube Analytics API request. You need to use an account that is either the owner of the YouTube channel or a content owner associated with the channel. \nYou will need to go through the OAuth 2 flow once while signed in as the Google Account that owns the YouTube channel, and the saved OAuth 2 refresh token could then be used repeatedly in the future to get fresh access tokens which can be used to run reports.. this might help \n\nOauth2Authentication.php\noauth2callback.php. You are getting  (403) Forbidden because you are not authenticated or you dont have access.\n\n\nWhy is there one link (v1) in the YouTubeAnalytics.php and an error that returns another (v2)?\n\nThis would be an error in the API or really weird error in the generater for that api.  \nThere is only one version of the YouTube analytics api released currently  you can see that here.  https://www.googleapis.com/discovery/v1/apis or here https://www.googleapis.com/discovery/v1/apis/youtubeAnalytics/v1/rest\nIt is unrelated to your first issue.\n. please add your code its hard to assist without knowing what you are doing.. @mattwhisenhunt please tag bug or needs investigation.. Your code looks fine which means the 500 error is coming from someplace else in your code this is unrelated the the code you have posted here which will make it hard for us to help you.\nDo a print_r on $event.   your issue may be htmlLink\n. @mxdpeep adding something to the calendar list is useless it just going to add it to the list on the left hand side of the current users Google calendar web view it has nothing to do with sharing it.\n@prafullwizorbit what do you mean by sharing exactly you just want to give someone else access to your calendar?\nCheck out acl. insert  you can add someone else to the permission on the calendar just make sure to set notification 8n this person will probably have to add it to their calendar list them selves I seam to remember that it doesn't do that automatically\n$rule = new Google_Service_Calendar_AclRule();\n$scope = new Google_Service_Calendar_AclRuleScope();\n$scope->setType(\"scopeType\");\n$scope->setValue(\"scopeValue\");\n$rule->setScope($scope);\n$rule->setRole(\"role\");\n$createdRule = $service->acl->insert('primary', $rule);\necho $createdRule->getId();\n. What documentation are you referring  to?  do you have a link?. That's just the generated source code for this library.   This files are generated from the discovery doc for the API are you suggesting there is an issue in that?\nhave you tried checking the documentation when does it say should be returned?\nhttps://developers.google.com/people/api/rest/#rest-resource-v1people. You might find it easier to use the Google cloud php client library with this api.  While the Google APIs php client library will technical work with the visions api the cloud library is designed to work with this type of API\nhttps://cloud.google.com/vision/docs/libraries#client-libraries-install-php\n```\nrequire 'vendor/autoload.php';\nuse Google\\Cloud\\Vision\\VisionClient;\n$vision = new VisionClient([\n    'projectId' => 'my_project'\n]);\n// Annotate an image, detecting faces.\n$image = $vision->image(\n    fopen('/data/family_photo.jpg', 'r'),\n    ['faces']\n);\n$annotation = $vision->annotate($image);\n// Determine if the detected faces have headwear.\nforeach ($annotation->faces() as $key => $face) {\n    if ($face->hasHeadwear()) {\n        echo \"Face $key has headwear.\\n\";\n    }\n}\n```\n. try cloning the v1 master branch its the branch without composer. . You need to request off line access then you will get a refresh token returned to you.  You can then set your code up to use the refresh token to request a new access token.   \nAccess tokens are only good for an hour refresh tokens are for the most part continue to work forever.\nYou could do something like this just store the refresh token in a file someplace\nrequire_once __DIR__ . '/vendor/autoload.php';\nrequire_once __DIR__ . '/Oauth2Authentication.php';\n// Start a session to persist credentials.\nsession_start();\n// Handle authorization flow from the server.\nif (! isset($_GET['code'])) {\n    $client = buildClient();\n    $auth_url = $client->createAuthUrl();\n    header('Location: ' . filter_var($auth_url, FILTER_SANITIZE_URL));\n} else {\n    $client = buildClient();\n    $client->authenticate($_GET['code']); // Exchange the authencation code for a refresh token and access token.\n    // Add access token and refresh token to seession.\n    $_SESSION['access_token'] = $client->getAccessToken();\n    $_SESSION['refresh_token'] = $client->getRefreshToken();    \n    //Redirect back to main script\n    $redirect_uri = str_replace(\"oauth2callback.php\",$_SESSION['mainScript'],$client->getRedirectUri());    \n    header('Location: ' . filter_var($redirect_uri, FILTER_SANITIZE_URL));\n}\n?>\nCode ripped from my gmail sample oauth2callback.php. ## inline comments to your questions.\n\nUm maybe is my poor understanding about gmail api, but if we delete the session we have to login into our google account again, \n\nYes, unless you have off line access and a refresh token stored which can then be used to request a new access token to access the api.\n\nis there any way to send email like using PHPmailer or etc without redirecting to auth page.  \n\nThis will probably require you go though the SMTP server and use a long and password to access a users account.\n\nSo it means a user will be get confirmations email from my google account who is register a account it something like that? \n\nSounds about right.\nmy comment\nIf you want to send an email without running your script going though the gmail api your going to have to go though the IMAP or SMTP server and use a login and password to access your gmail account.   That is unless you figure out how to get oauth to work with the SMTP server i have never had time to work that one out.  Xoauth2 protocol\nThis may sound like the better solution for you since it sounds like its your own account your trying to access anyway.  Just remember this is the mail server you are accessing not the api so the requests are different.   . First off JavaScript dosent return a refresh token.  JavaScript uses an implicit login type.\nSecond using a refresh token that was generated by one client will not work with another. so no you can't swap tokens between clients \nexample:   login php app send  refresh token to c# backend service with not work as you will be using two different client types\n\nphp browser\nc# native\n\nNow that being said there is some magic in the Android SDK that allows for this.\nthird Oauth is not intended to work with an iframe I will be very surprised if you get a Google login screen to show in that.   you should always open a browser window so the user can see the URL and not be tricked into logging into a fake site.. last I knew it was not possible to get a refresh token from client side JavaScript code.\nAuthorization code - life time around five minutes used in hybrid authorization flow.  can only be used once to get the first access token and refresh token\nauthorization code, access token and refresh token are all generated based upon the client id , client secret and the user logging in.  This is why I don't think you will be able to mix them.    \nI also don't think this question really belongs here I think you would be better off taking it to stack overflow and reading the rfc for Oauth2.\n. > This is basically the line that is failing at https://github.com/googleapis/google-api-php-client/blob/master/src/Google/Client.php#L192 as it gets no access_code with the auth token from JavaScript. I am really unsure how to proceed. I will have to try further and see what I am missing but as far as I can see everything should be matching, client configuration (id, secrets or api key are about the same account), permissions etc.\nSounds to me like your code is wrong put it up on stack overflow we can bring it back here if it is an issue with the library and not an issue of incompatible clients or code.    If you are feeding it a refresh token this library should not be asking for an access_code.\nTrying to compare Google login to Facebook is not going to get you anything except a headache.  Its best to accept that they are two different companies with different security policies for their developers.. @nielsnl68  i have some generated adsence samples here they might help https://github.com/LindaLawton/Google-APIs-PHP-Samples/tree/master/Samples. invalid_grant \u201cInvalid JWT\n\n{ \u201cerror\u201d: \u201cinvalid_grant\u201d, \u201cerror_description\u201d: \u201cInvalid JWT: Token must be a short-lived token (60 minutes) and in a reasonable timeframe. Check your iat and exp values and use a clock with skew to account for clock differences between systems.\u201d }\n\n\nYour server\u2019s clock is not in sync with NTP. (Solution: check the server time if its incorrect fix it. )\n\ninvalid_grant: Code was already redeemed\nThis error requires a little explanation. When the user clicks authenticate you are given an authentication code. You take this code and exchange it for your access token and refresh token.  Means that you are taking an authentication code that has already been used and trying to get another access token / refresh token for it. Authentication code can only be used once and they do expire so they need to be used quickly.\nInvalid_grant: bad request\nNormally means that the client id and secrete you are using to refresh the access token. Was not the one that was use to create the refresh token you are using.\nTry and authenticate again get a new refresh token.\n{\u201cerror\u201d: \u201cinvalid_grant\u201d, \u201cerror_description\u201d: \u201cBad Request\u201d}\nOld Refresh token\n\nThe refresh token limit has been exceeded.       (Solution: Nothing you can do they cant have more refresh tokens in use)\n Applications can request multiple refresh tokens. For example, this is useful in situations where a user wants to install an application on multiple machines.  In this case, two refresh tokens are required, one for each installation. When the number of refresh tokens exceeds the limit, older tokens become invalid. If the application attempts to use an invalidated refresh token, an invalid_grant error response is returned. The limit for each unique pair of OAuth 2.0 client and is 25 refresh tokens (note that this limit is subject to change). If the application continues to request refresh tokens for the same Client/Account pair, once the 26th token is issued, the 1st refresh token that was previously issued will become invalid. The 27th requested refresh token would invalidate the 2nd previously issued token and so on.. \n",
    "mxaddict": "I just signed the CLA, Cheers.\n. @slxjhuang This change fixed that?\n. Anyone still running that version should choose a different profession, as they have been running a vulnerable version of PHP for over 4yrs. I don't think we should be encouraging the use of such outdated and insecure versions by adding support for it.\n<<<< So that is the reason why 5.2.1 is the officially listed version that the Library supports? on README?\n. BTW, we are running a Legacy app on internal servers with no external access with over 3K files that would all need editing to support any version of PHP that is newer than 5.2.x.\n. I think this merge/pull request is going to start a flame war, So I will be closing it :100: %\n. ",
    "slxjhuang": "Hi Ian,\nThank for fixing the google php api getAccessToken = [] problem. :+1: \n. @mxaddict just find a place to say thanks.....@ianbarber\n. ",
    "Gemmu": "Unfortunately this doesn't work on RedHat 7.2 where the libcurl version 7.29 has been patched with the proxy-header-length fix from 7.30.\n\n\nThu Nov 27 2014 Kamil Dudka kdudka@redhat.com 7.29.0-20\n  ...\ninclude response headers added by proxy in CURLINFO_HEADER_SIZE (#1161182)\n\n\nSadly on both of out production machines (RHEL 7.1 and 7.2) curl_version() returns the same info with or without the patch. So it only works on the older machine without the patch.\nPlease tell if anyone has any suggestions as to how to make it work on both of the machines. Would upgrade to google-api version 2.0 help? I see that it doesn't contain this class at all anymore. This could mean a lot changes to our own code using the client though.\n. Thank you @gws. I copied your fork and setting the flag works as intended. Would it be possible to see a new release on the packagist.org containing this workaround any time soon? I'm no that familiar with the release schedule of the api.\n. For those who are interested, the question on StackOverflow: http://stackoverflow.com/q/25010505/1980027\n. I tested this new configurable feature under RedHat 7.1 and 7.2 (latter has the patched libcurl). I found that using this new flag to disable the workaround, made our code functional again on both of our machines. Please do tell if there's anything more I can help with in order to get this to packagist.org.\n. ",
    "bluesclues9": "I was thinking the same too but may be, \"Authorization: Bearer \" setting in the Request Header is not used that extensively for other calls.\nOnce I changed to exclude \"Authorization: Bearer xxxxx\". It started working fine. I could get Google+ results\n. tokeninfo is already in our server code for access_token, refresh_token, id_token verfication provided by the clients (over SSL). This is done for lack of one-time-code flow support for iOS devices.\nAfter that step, we are trying to retrieve additional details about the user such as Name and other User Profile specific details. That's why we had to make this call.\n. I tried with cURL and it fails even by cURL\nNOTE: If I don't set the \"Authorization: Bearer xxxxxx\", it works in cURL\n$access_token = \"ya29.1.AADtN_WeGn6B_dl52kO8zdDIWA8yTLZY3bBCK4zxxxxx\";\n$ch_subs = curl_init();\ncurl_setopt($ch_subs, CURLOPT_URL, 'https://www.googleapis.com/plus/v1/people/xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx?key=AxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxA');\ncurl_setopt($ch_subs, CURLOPT_RETURNTRANSFER, true);\ncurl_setopt($ch_subs, CURLOPT_SSL_VERIFYPEER, false);\ncurl_setopt($ch_subs, CURLOPT_HTTPHEADER, array('Authorization: Bearer ' . $access_token)); $subs_return = curl_exec($ch_subs);\ncurl_close($ch_subs);\nI get the same error. What could be wrong with this?\ncURL Output\n{\n \"error\": {\n  \"errors\": [\n   {\n    \"domain\": \"global\",\n    \"reason\": \"authError\",\n    \"message\": \"Invalid Credentials\",\n    \"locationType\": \"header\",\n    \"location\": \"Authorization\"\n   }\n  ],\n  \"code\": 401,\n  \"message\": \"Invalid Credentials\"\n }\n}\ncURL Output\n. ",
    "SkySrfr": "I just want to verify that the token is signed by Google and intended for my app. I originally tried verifyIdToken($token) without the audience and it ended up comparing the client id to null, always returning false. Since verifyIdToken in /Auth/OAuth2.php has the possibility of both $token and $audience, I feel like Client.php should also. \n. You're right, that was my mistake. I wasn't calling setClientId() prior to the verification. Now I understand better how it works, thanks! Sorry for the bug report!\n. ",
    "pctraverse": "Thanks, Linda, hope to get an answer.\n. ",
    "rowanrh": "Both IE & FireFox failed on the query as written (i.e. '&key=') with HTTP 400 errors.\nHowever, when I dropped the '&key=' (i.e. so the query ended '&filter=free-ebooks') the query worked, IE with a file open/save prompt for 'volumes.json', FireFox with data, i.e. the json opened.\nI must say that I have never heard of Google blocking, but then Google have a local office and doing quite well business-wise  :-)\n. I deleted the existing key, then generated a new API key for the project.\nThe code failed with the same error message, as did a blank key.\nI then checked the key by calling manually (as per your original request)\nusing the newly-generated API key. The calls worked in both IE & FireFox.\nMy PC experience being mainly in Windows LOB applications I know very\nlittle about PHP & Apache.\nThat said, the application appears to fail when PHP or Apache (i,e.\nlocalhost / 127.0.0.1) are involved.\nIs it possible that the problem might lie there ?\n.......................................\nLater. The Apache error log reports the following:\n[Mon May 19 09:51:42.575700 2014] [mpm_winnt:warn] pid 1592:tid 804The specified network name is no longer available.  : AH00341:\nwinnt_accept: Asynchronous AcceptEx failed.\nThis appears to be as the result of a long-outstanding bug in Apache. I\nhave downloaded the latest version of Apache - 2.4.9 vs. the 2.4.6 that I\nam running - and will install it tomorrow.\nWill let you know of the results ...\nOn Mon, May 19, 2014 at 9:01 PM, Ian Barber notifications@github.comwrote:\n\nAh OK, sounds like the key is the problem if it works without then: can\nyou check that the Books API is enabled in the developer console for the\nproject associated with that key?\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/google/google-api-php-client/issues/196#issuecomment-43542774\n.\n. My apologies: I abbreviated the reply.\n\nThe Books API is enabled in the console. That said, I created the initial\nSimple API key before enabling the Books API, so - just in case - I deleted\nthe first key then created a new Simple API key i.e. after the Books API\nwas enabled. According to the instructions the first key should have\nworked, but hey, we are talking about computers - and programmers - here!\n:)\nI have tested with a blank key and two generated Simple API keys. The\nresults (thus far) are that a manual call always works. whereas a\nprogrammatic call never works,\nMany thanks for your assistance thus far.\nOn Mon, May 19, 2014 at 11:16 PM, Ian Barber notifications@github.comwrote:\n\nYeah, sorry, I wasn't questioning the key, but whether the API was enabled\nin the APIs section of the project. If you go to the developer console, in\nthe same menu as credentials there should be an APIs menu - can you check\nBooks is enabled in that list? Being that you have the same issue when\nmaking the call directly, I suspect the apache issues are unrelated.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/google/google-api-php-client/issues/196#issuecomment-43559374\n.\n. Thanks for the heads-up. I also reported my error (i.e. this one) but\nunfortunately no responses.\n\nWhat is interesting is that the code is completely different yet the\nfailure is the same ...  8(\nOn Tue, May 20, 2014 at 11:13 AM, Linda Lawton notifications@github.comwrote:\n\nThere is someone else with this error message on StackOverflow. His is\nrelated to plus.login. I think he is doing it wrong, but that's beside the\npoint. The point is they are both seeing this Unable to Connect: '0' error\nmessage, which makes me wonder. So i thought i would bring it to your\nattention. http://stackoverflow.com/q/23742576/1841839\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/google/google-api-php-client/issues/196#issuecomment-43602897\n.\n. Hi Linda -\n\nAfter upgrading to Apache 2.4.9 I went to the console, added the email\naddress & product name, saved then tried again. No luck: the same error\nmessage was returned.\nThe Apache log is alos still returning he same error, i.e.: [Tue May 20\n14:44:25.180600 2014] [mpm_winnt:warn] pid 8104:tid 836The\nspecified network name is no longer available.  : AH00341: winnt_accept:\nAsynchronous AcceptEx failed.\nOn Tue, May 20, 2014 at 11:55 AM, Linda Lawton notifications@github.comwrote:\n\nJust as an off chance that its this. When you created your app in\nDevelopers console did you remember to go to Apis & auths -> consent Screen\nand add an email Address and Product name? Both those values must be set or\nyou get an error from the client. The thing is its a different error\nmessage in .net client lib (think its invalid client_id), but i wonder if\nmaybe the PHP client lib just isn't spiting out the same error message.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/google/google-api-php-client/issues/196#issuecomment-43606602\n.\n. Hi Linda -\n\nLet me start by thanking you for your efforts - you have no idea how much\nthey are appreciated.\nI unzipped your file and copied the results to the Apache document root,\ni.e. \"c:/etc/Apache24/htdocs\"\nI then started \"localhost\" in IE and selected the \"Books\" folder. IE\nreturned a HTTP 500. Firefox did the same.\nI then ran the query manually. It worked 100%.\nThe Apache error log was clean, whilst the PHP error log reported as\nbefore, i.e.\n[20-May-2014 16:57:00 UTC] PHP Fatal error:  Uncaught exception\n'Google_IO_Exception' with message 'HTTP Error: Unable to connect: '0'' in\nC:\\etc\\Apache24\\htdocs\\Books\\Google\\IO\\Stream.php:118\nStack trace:\n0 C:\\etc\\Apache24\\htdocs\\Books\\Google\\IO\\Abstract.php(122):\nGoogle_IO_Stream->executeRequest(Object(Google_Http_Request))\n1 C:\\etc\\Apache24\\htdocs\\Books\\Google\\Http\\REST.php(42):\nGoogle_IO_Abstract->makeRequest(Object(Google_Http_Request))\n2 C:\\etc\\Apache24\\htdocs\\Books\\Google\\Client.php(499):\nGoogle_Http_REST::execute(Object(Google_Client),\nObject(Google_Http_Request))\n3 C:\\etc\\Apache24\\htdocs\\Books\\Google\\Service\\Resource.php(195):\nGoogle_Client->execute(Object(Google_Http_Request))\n4 C:\\etc\\Apache24\\htdocs\\Books\\Google\\Service\\Books.php(2304):\nGoogle_Service_Resource->call('list', Array, 'Google_Service_...')\n5 C:\\etc\\Apache24\\htdocs\\Books\\index.php(58):\nGoogle_Service_Books_Volumes_Resource->listVolumes('Henry David Tho...',\nArray)\n6 {main}\nthrown in C:\\etc\\Apache24\\htdocs\\Books\\Google\\IO\\Stream.php on line 118\nI agree that it must be a connection problem. Is there anything in Apache\nhttpd.conf or httpd-vhosts.conf that requires setting ? Or PHP ?\nOn Tue, May 20, 2014 at 5:14 PM, Linda Lawton notifications@github.comwrote:\n\n@rowanrh https://github.com/rowanrh i tested the simple-query.php\nexample and it works fine. I'm wondering it has something to do with your\nconnection, your app set up in Google Developer Console, or even that you\ndidn't copy the full Google Directory.\nSo here is an insane test. The following zip is a working example using my\nAPI key.\n1. If it doesn't work then its probably your connection.\n2. If it does work then its probably your app key or the directory\na. try and swap it for your app key. If it doesn't work we know its your\napp key that's bugged. If it does then your all set, and can start having\nfun with the APIs. :)\nIf it does work with my app key but not yours we need to fix yours. Its a\ndevelopment App key, delete from time to time it because i tend to leak it\nout on the net by mistake, or like now to help people test issues.\nhttp://www.daimto.com/Tutorials/PHP/Books.zip\n@WaldoJeffers https://github.com/WaldoJeffers looking into yours now.\nI'm still trying to recreate the bug.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/google/google-api-php-client/issues/196#issuecomment-43639475\n.\n. Hi Linda -\n\nhttp://localhost/books/ doesn't work for me \nWindows is in fact capable of using both '\\' and '/', though I will agree\nthat sometimes it gets a tad flustered  :)\nThat said, I ran the code through PhpStorm and it happily resolved all file\nreferences.\nI have now asked the members of Apache Lounge for assistance, and will\nadvise of any news.\nOnce more, thanks for the assistance.\nOn Tue, May 20, 2014 at 7:40 PM, Linda Lawton notifications@github.comwrote:\n\nYou should just be able to do http://localhost/books/\nLast idea, I was also unable to get Apache on windows to work with the\nclient lib when i tried a month ago. I wondered if it had to do with the\nfact that all the includes where using the Linux Dir (/) structure and\nApache on windows well looks for the windows Dir structure () Someone\nrecommended i try XAMPP and it worked like a charm\nhttps://www.apachefriends.org/index.html . If that doesn't work i'm out\nof ideas.\n\u2014\nReply to this email directly or view it on GitHubhttps://github.com/google/google-api-php-client/issues/196#issuecomment-43658934\n.\n. Hi Linda -\n\nApologies, I missed your question. I am in South Africa.\n. Hi -\nI finally resolved the issue by changing the following PHP.ini settings:\n1. I set (by uncommenting) the extension=php_openssl.dll - necessary for 'https' URLs; and\n2. I set the time-zone. Google is fussy about times, so this might have affected the outcome.\nThanks to all for the assistance.\n. @Waldo: My pleasure - I'm glad that I could assist.\n. No change - the results are identical.\nStepping through the code it looks as though the access token is retrieved, but somehow the system fails to obtain an ID token.\n. I have a developer console linked to my Google gmail account.\nI created a new project, then linked the Google+ & Book API's to the project.\nI generated a new Client ID for web applications and used the credentials to replace the values in idtoken.php\nFrom my Googling it appears that the idtoken entry is only generated where it make sense, i.e. the profile, email and opened scopes. I have tried all three without success.\nAnother comment on Google stated that idtokens were only generated for service accounts ??\nMany thanks\n. The example worked this morning.\nThe only over-night changes were (a) the Identity Toolkit API was added to the project's API's and (b) my machine was rebooted.\nAs for the balance: I used the \"Client Id for a web application\" credentials and a scope of \"openid\" in the client query. The project API's used: Books & Identity Toolkit (was Books and Google+)\n. ",
    "WaldoJeffers": "@LindaLawton \nHey ! I'm the \"someone else who is doing it wrong\" (no offense taken, I'm new to google php client library and I am trying to follow different tutorials regarding the subject). Please could you tell me what I am doing wrong so I could update my code, and maybe solve the problem ?\nI also updated my post on StackOverflow in the comments. I am not sure at all but I think the Apache configuration has something to do with it. When I uploaded the same files on an online \"regular\" server, this strange error did not show up. (Instead, I get Error fetching OAuth2 access token, message: 'invalid_grant').\nWhat is very weird is that the code obtained when running the tests on WAMPServer (localhost) is actually valid (it works when used with a cURL request, I get a refresh_token) but the code obtained when running the tests online is not ! I get \"invalid grant, invalid code\" error.\nI use the same client_id & client_secret in both cases.\nI can not understand it. My javascript origin is correct (when I try to change a single letter, I instantly get an origin_mismatch error when clicking on the sign-in button).\nI don't know if it can help you; I'm willing to run any tests that come to your mind.\nAs for your suggestion Linda, in my case, email Adress and Product are correctly set, and displayed when the app asks my permission.\nEDIT : Regarding my issue local vs server, maybe it is linked to this topic on StackOverflow\n. @rowanrh : It did indeed solve the problem for me too. Thank you very much sir !\n. ",
    "MarcAlfa": "Hi, i had the same problem with wamp. I resolved it just enabling the php_curl extension in wamp.\nThat's works for me\n. ",
    "alexylem": "I had the same error with nginx/php-fpm which got fixed by installing & enabling curl php extension.. ",
    "RHochstenbach": "This was the Calendar API.\n. Managed to fix it in the Google_Calender class (Google_CalendarService.php), in the __construct method. Added the syncToken element to $this->events (line 736)\n$this->events = new Google_EventsServiceResource($this, $this->serviceName, 'events', json_decode('{\"methods\": { <....> \"list\": {\"id\": \"calendar.events.list\", \"path\": \"calendars/{calendarId}/events\", \"httpMethod\": \"GET\", \"parameters\": {\"alwaysIncludeEmail\": {\"type\": \"boolean\", \"location\": \"query\"}, \"calendarId\": {\"type\": \"string\", \"required\": true, \"location\": \"path\"}, \"iCalUID\": {\"type\": \"string\", \"location\": \"query\"}, \"maxAttendees\": {\"type\": \"integer\", \"format\": \"int32\", \"minimum\": \"1\", \"location\": \"query\"}, \"maxResults\": {\"type\": \"integer\", \"format\": \"int32\", \"minimum\": \"1\", \"location\": \"query\"}, \"orderBy\": {\"type\": \"string\", \"enum\": [\"startTime\", \"updated\"], \"location\": \"query\"}, \"pageToken\": {\"type\": \"string\", \"location\": \"query\"}, \"q\": {\"type\": \"string\", \"location\": \"query\"}, \"showDeleted\": {\"type\": \"boolean\", \"location\": \"query\"}, \"showHiddenInvitations\": {\"type\": \"boolean\", \"location\": \"query\"}, \"singleEvents\": {\"type\": \"boolean\", \"location\": \"query\"}, \"timeMax\": {\"type\": \"string\", \"format\": \"date-time\", \"location\": \"query\"}, \"syncToken\": {\"type\": \"string\", \"location\": \"query\"}, \"timeMin\": {\"type\": \"string\", \"format\": \"date-time\", \"location\": \"query\"} <....>\n. That did the trick. Apparently I was using the svn branch on googlecode.com, which seems outdated. Using the latest Github version seems to work fine.\n. ",
    "bkahlert": "Looking for this feature myself.\n. ",
    "hugohuynh": "I have tried  Partial download by setting Range in header. It's not working. Please advise. Thanks\n. This one cost me a lot of time to debug. Please support orderBy. Thanks\n. ",
    "onema": "Will do, thanks.\n. Okay form submitted :)\n. Thank you for your answer and for letting me know about potential breaking changes between 1.0.* and 1.1.*. \nBut what I would like to know is if you have adopted semver at all on any of your current versions v1.1.*?\nThank you\n. ",
    "cloudward": "the $_GET['code'] value is correct and everything up to that ->authenticate() call was working fine... the getAuthURL worked and it redirected back to the oauth2callback handler.\nthe firewall is allowing external requests as some other curl calls in the system are working.\ni think it might be the cache too... memcache doesn't work local, and you need to pass in a host and port to memcache... how do i pass in those host and port into the client so it is used?   how do i swap to the Null cache?\nwhere would it fit into this code:\nrequire_once 'ease/lib/Google/Client.php';\n    $client = new Google_Client();\n    $client->setClientId($this->config['gapp_client_id']);\n    $client->setClientSecret($this->config['gapp_client_secret']);\n    $client->setRedirectUri((isset($_SERVER['HTTPS']) && $_SERVER['HTTPS']=='on' ? 'https' : 'http') . '://' . $_SERVER['HTTP_HOST'] . '/oauth2callback');\n    $client->setScopes('https://spreadsheets.google.com/feeds https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.readonly');\n    try {\n        $client->authenticate($_GET['code']);\n    } catch(Google_Auth_Exception $e) {\n. require_once 'ease/lib/Google/Cache/Null.php'\n$null_cache = new Google_Cache_Null();\n$client->setCache($null_cache);\n??\n. it looks like the constructor requires the client to be passed in... that seems weird... so would it be:\nrequire_once 'ease/lib/Google/Cache/Null.php';\n$null_cache = new Google_Cache_Null($client);\n$client->setCache($null_cache);\nwhy do i have to pass in the $client if i also have to call setCache on the client??\n. no... same error:\n[Fri May 30 20:56:05.300070 2014] [core:notice] [pid 28838] AH00052: child pid 11662 exit signal Illegal instruction (4)\ni used this code on the client right before i called authenticate:\nrequire_once 'ease/lib/Google/Cache/Null.php';\n    $null_cache = new Google_Cache_Null($client);\n    $client->setCache($null_cache);\nis the cache required?  i'm using AWS elasticache and have a host and port, but i can't see how to get that host and port into the Google_Cache_Memcache object... it seems like you set it with the client first, but i don't see how\n. i tested the same code on my local Google SDK through AppEngineLauncher and it worked... also worked deployed to appspot.com, but still getting the same error when deployed to AWS Beanstalk using PHP 5.5\n. i created a brand new environment on AWS Elastic Beanstalk... using PHP 5.4 instead, as that matches the version on App Engine, but i got the same result... \n[Mon Jun 02 05:59:35.990503 2014] [core:notice] [pid 1798] AH00052: child pid 2121 exit signal Illegal instruction (4)\ni still haven't isolated the exact command in the client that is triggering the error.\ndo you know of any compile flags for php or apache that might break the client?   i'm wondering if amazon's platform has a bug, or if the client could be changed to make it work.\n. i've filed support tickets with amazon as well, but haven't heard back.   this is a very critical issue for us as we can't get google stuff working on elastic beanstalk until this error is fixed.   we have gold level support with google, but i'm not sure if that extends to debugging the dependancies of the provided google API client. \n. i see in the composer.json file:\n    \"require-dev\": {\n      \"phpunit/phpunit\": \"3.7.*\"\n    },\nis phpunit required on any machine running the client?   if that was the issue, i would expect to see some kind of error in the PHP log about a missing class.... the \"invalid instruction\" error leads me to believe that PHP or apache were compiled with the wrong CPU flags, but i don't have enough evidence either way.\n. thanks, that's what i'm doing right now.... the Null cache didn't help, but it still worked on app engine.\nthe requirements here:\nhttps://developers.google.com/api-client-library/php/start/installation\nsay that \"Support for a writeable file system or Memcache.\" is a requirement...\nbut it seems like turning off the cache on app engine (which doesn't have a writeable filesystem) still works even if the client cache is change to \"null\"\nso i'm trying to set up the memcache host and port in the client like this right before i call the authenticate method:\nif(isset($this->config['memcache_host']) && trim($this->config['memcache_host'])!='') {\n            $client->setClassConfig('Google_Cache_Memcache', 'host', $this->config['memcache_host']);\n            if(isset($this->config['memcache_port']) && trim($this->config['memcache_port'])!='') {\n                $client->setClassConfig('Google_Cache_Memcache', 'port', $this->config['memcache_port']);\n            } else {\n                $client->setClassConfig('Google_Cache_Memcache', 'port', 11211);\n            }\n            require_once 'ease/lib/Google/Cache/Memcache.php';\n            $cache = new Google_Cache_Memcache($client);\n            $client->setCache($cache);\n        }\n. yeah, i saw that too... been banging my head on this all week.   we do have JSON extension and json decode does work.   \ni'm not sure about the curl extensions... this is from phpinfo() for curl:\ncurl\ncURL support    enabled\ncURL Information    7.36.0\nAge 3\nFeatures\nAsynchDNS   Yes\nDebug   No\nGSS-Negotiate   Yes\nIDN Yes\nIPv6    Yes\nLargefile   Yes\nNTLM    Yes\nSPNEGO  No\nSSL Yes\nSSPI    No\nkrb4    No\nlibz    Yes\nCharConv    No\nProtocols   dict, file, ftp, ftps, gopher, http, https, imap, imaps, ldap, ldaps, pop3, pop3s, rtsp, scp, sftp, smtp, smtps, telnet, tftp\nHost    x86_64-redhat-linux-gnu\nSSL Version NSS/3.15.3\nZLib Version    1.2.7\nlibSSH Version  libssh2/1.4.2\ni thought the API client used php streams, so not sure if that would matter.\n. setting the cache up to use an external memcache host and port didn't work either.   it seems like the external request is the issue, but that doesn't make sense because the getAuthUri method is working and that is the same type of external request. \n. i saw this issue with libcurl 7.36... \nhttp://curl.haxx.se/mail/tracker-2014-05/0037.html\nmaybe an issue there? \n. so, this seems to be a bug with libcurl, but i did find a fix... forcing curl to use SSLv3 fixes the problem.\ncurl_setopt($curl, CURLOPT_SSLVERSION, 3);\ncould you update the API client to force this setting?\n. i added the single line in /Google/IO/Curl.php at line 64 (right after the CURLOPT_SSL_VERIFYPEER setting):\ncurl_setopt($curl, CURLOPT_SSLVERSION, 3);\nafter that, everything worked.\nis there a reason version 3 of SSL wouldn't be preferred?  i've heard version 2 is weak and shouldn't be trusted, but version 3 just seems like bandaids on top of version 2... either way, this works, and i'm leaving it as is for now, i'd just rather not have to make this same change every time the client is updated.\n. what would be the best way of passing in that curl option while creating my $client?  i see that the curl library goes through the $this->options to set curl options, but i don't see a way to set those values with the client before calling authenticate \n. ",
    "ShinyChang": "I had trouble with require_once() too.\n. ",
    "ltrebing": "I\u2019m completely new to this project, so I might be missing something, but wouldn\u2019t this \u201cmove to autoloading\u201d thing be a rather trivial task? Just ditch all the require_once() statements, write an autoload.php file, adjust the composer.json file, and it\u2019s done, right? This should even work with PHP 5.2 as spl_autoload_register has already been around since 5.1.2.\nAny thoughts on this, maybe even from @ianbarber or @silvolu? If you think that my guesses make some sense, let\u2019s just open an issue for this and I\u2019ll be glad to do the work.\n. One thing worth considering: The old include path method allowed for case-independent class names (cf. 7c4088e87efd7eece1d83f716ed502e67fe5adbb where referencing Google_Cache_Apc as Google_Cache_APC just worked, but failed when using the autoloader). Should I add some fallback logic to ensure maximum backwards compatibility (at a slight performance cost) or should we rely on people fixing their code as I did for that CacheTest.php file?\n. ",
    "chukkynze": "Honestly, I think you're right. Autoloading would be a quick fix.\n_Chukky Nze http://www.linkedin.com/profile/view?id=76897164&trk=tab_pro_Web\n& Data Consultant http://www.linkedin.com/in/chukwumanze/\nLMU MBA\nhttp://images.businessweek.com/slideshows/20110114/twenty-top-ideas-for-a-better-mba#slide3\nFounder NotaryToolz.com http://www.NotaryToolz.com\nOn Wed, Oct 1, 2014 at 4:21 PM, Lars Trebing notifications@github.com\nwrote:\n\nI\u2019m completely new to this project, so I might be missing something, but\nwouldn\u2019t this \u201cmove to autoloading\u201d thing be a rather trivial task? Just\nditch all the require_once() statements, write an autoload.php file, adjust\nthe composer.json file, and it\u2019s done, right? This should even work with\nPHP 5.2 as spl_autoload_register has already been around since 5.1.2.\nAny thoughts on this, maybe even from @ianbarber\nhttps://github.com/ianbarber or @silvolu https://github.com/silvolu?\nIf you think that my guesses make some sense, let\u2019s just open an issue for\nthis and I\u2019ll be glad to do the work.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/209#issuecomment-57557264\n.\n. \n",
    "jfosnight": "I am having the exact same problem.  Did you ever find a solution?\n. I ended up eventually editing the Google API src.  I added this: \"$this->token['id_token'] = $token['id_token'];\" right after line 325 in the OAuth2.php file: https://github.com/google/google-api-php-client/blob/master/src/Google/Auth/OAuth2.php#L325\nAdding that single line fixed all the problems that I was having.  Is this the correct solution, maybe not, but it worked for me.\n. From what I can tell, when the refreshToken method is called, it uses the $refresh_token arg and makes a call to https://accounts.google.com/o/oauth2/token.  This call then returns what the refreshtToken method labels as the $token.  This $token contains 'access_token', 'expires_in', 'created', and 'id_token'.  I am simply assigning the newly retrieved 'id_token' to the class variable id_token.  Then when the verifyIdToken method is called, it using the class variable id_token.  It is my understanding that the id_token is essentially the complete JWT.  The JWT contains the 'access_token' (I think) as well as quite a bit of other information.\nI asked about this problem elsewhere and they said that it may be bug in the library.  They are suppose to be looking into it.\n. ",
    "elcodedocle": "After extracting the json post body using xdebug and noticing it didn't work either when testing it in the playground, I did some more research and it seems that all I had to do was to set isExportable to true.\nphp\n$table->setIsExportable('true');\nIssue closed.\n. ",
    "loomtronic": "Any ETA on a fix? Hard to create a GCE instance without setting the ipv4Range\n. Same thing happens in Compute.php in the Google_Service_Compute_FirewallAllowed class\n. pretty sure it's supposed to be $db_settings->setBackupConfiguration(array($db_backup));\nbut I don't have time to test it\n. @ianbarber Re: a previous comment on batching being enabled in general\nI could not get it working in Drive, I get a 404 error - when the same request works w/o batching.  It would be amazing if it worked in Drive.  Trying to upload a few hundred files takes ten to fifteen minutes.\nThis page makes it seem like it should work on any service you want to batch, though... https://developers.google.com/api-client-library/php/guide/batch\n. According to Google for Work Support\n\"Basically, the answer is no, you cannot send batch requests to Drive and you can only upload files to Drive via single requests. \"\n. ",
    "sagar-b": "Thanks for your reply. As -\nmy drive api status is on & how should i capture the result as it is not reaching there. As soon as i click \non the accept button it comes back to the start page. you can view the attach screen shot.\n\n. It is not reaching there.\nOn 18-Jun-2014 12:43 am, \"Ian Barber\" notifications@github.com wrote:\n\nSorry, I meant result from your script - the $result2 object.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/219#issuecomment-46352008\n.\n. 1. I am sending you the url where i kept the working example file of api.\n   http://rttweetapp.netai.net/google-api-php/examples/\n2. on the consent screen i am getting this path.\n\nhttps://accounts.google.com/o/oauth2/auth?response_type=code&redirect_uri=http%3A%2F%2Fwww.assessme-nt.com%2Fgoogle-api-php%2Fexamples%2F&client_id=295583883710-rgqmqkck6mf4t2d9iov1kgn7l73e18lh.apps.googleusercontent.com&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive&access_type=online&approval_prompt=auto\n. ",
    "mimdeveloper": "I had to set path of src folder using this:\nset_include_path(\"/Applications/MAMP/htdocs/GA PHP/src/\");\n. Apologies. I am kinda new to php (Objective C mostly.) so I could not figure out I had to set path of src folder using this: \nset_include_path(\"/Applications/MAMP/htdocs/GA PHP/src/\");\nThat solved my issue. Hopefully this will help others.\n. ",
    "webalexstudio": "Thx for your answer\n. ",
    "mappedinn": "Yes it does!\n. Thank you @ianbarber \n. Me too...\n. Thank you!\nOne thing you missed to tell me is to share the table on google drive with client id.\n. thanks again.\n. Any news on for the users of the google compute engine? @austinh @thejaswip @marslangoog \n. ",
    "marius-cojocariu": "I'm using the 1.0.4-beta version on a php 5.2.17 server.\n. ",
    "paulhuisman": "I second this.\n. ",
    "VinceG": "@silvolu Appreciate that. I understand the hassle involved in maintaining projects. a new repo, that's probably what i am going to do. \nThanks.\n. @ianbarber Sure, no problem.\n. ",
    "garethmccumskey": "I seem to be having same issues as OP but with the Gmail API and exchanging the Client ID for the email address did not resolve the issue. I can see from my stack trace I get the following:\nGoogle_Auth_OAuth2 ->refreshTokenRequest (array('grant_type' => 'assertion', 'assertion_type' => 'http://oauth.net/grant_type/jwt/1.0/bearer', 'assertion' => 'Long string of characters for the assertion')) \nin /path/to/Google/Auth/OAuth2.php at line 307\nI have the correct scope set against the user in the Google Apps admin backend for the Email Address for the Service account. My Auth object:\n``` php\n  $scopes = array('https://www.googleapis.com/auth/gmail.readonly',   \n  'https://www.googleapis.com/auth/admin.directory.user', \n  'https://www.googleapis.com/auth/admin.directory.group', \n  'https://www.googleapis.com/auth/admin.directory.orgunit');\n$auth = new \\Google_Auth_AssertionCredentials(\n      'xxx@developer.gserviceaccount.com',\n      $scopes,\n      $key,\n      'notasecret'\n    );\n```\nBeen at this for days. Any help would be greatly appreciated.\n. ",
    "rafasashi": "I use Google_Auth_AssertionCredentials to access a gmail account from server to server. It was working well from both development and production servers but now the production one get the \u201cerror\u201d : \u201cinvalid_grant\u201d. As suggested by ianbarber I have implemented a new client id with new p12 key but the service remains unreachable on production. Is it due to a blocking mechanism by ip?\n. Apparently the problem was the system time being off. Worked by Resynchronizing via NTP with:\nsudo ntpdate pool.ntp.org\nhttp://stackoverflow.com/questions/11973162/google-analytics-api-oauth-exception-invalid-grant-with-service-account-same/30259766#30259766\n. ",
    "aacevedoday": "Perfecto, efectivamente el inconveniente esta en la hora de la maquina. Gracias!! rafasashi\n. ",
    "usaussie": "I'll see if i can find out anything from the API group directly, but that method doesn't appear to be able to take a response type parameter... so it should be returning the same kind of response as any of the other calls. If i get a definitive answer from them, i'll post back here. Thanks.\n. I've posted this to the API support issue tracker: \nhttps://code.google.com/a/google.com/p/apps-api-issues/issues/detail?id=3599&colspec=API%20ID%20Type%20Status%20Priority%20Stars%20Opened%20Summary\nI'll post back here if i get an answer.\n. I signed it!\n. Thanks Brent. I included google/apiclient-services:dev-master per your note, but my app still makes use of the V1 client library, and is using the groupssettings class from it (instead of from the apiclient-services package). Is there a best practice method of forcing use of the newer class, seeing as though they share the same namespace? \n. It's part of a Zend Framework app, and yes, the autoload.php is included at\nthe top of the main index.php file.\n......................................\nNick Young\nusaussie@gmail.com\nOn Wed, May 25, 2016 at 4:33 PM, Brent Shaffer notifications@github.com\nwrote:\n\nHow are you managing autoloading? Are you including vendor/autoload.php\nat the top of your PHP file?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/959#issuecomment-221698388\n. I think that did it. It's working in my local environment. Now i just need to get an updated version of PHP in my production environment... as i was welcomed with this during composer update :-(\n\ngoogle/apiclient-services dev-master requires php >=5.4 -> your PHP version (5.3.3)\nSo.... changing my initial composer.json from\n\"google/apiclient\": \"1.x\",\nto \n\"google/apiclient-services\": \"dev-master\",\n\"google/apiclient\": \"dev-v1-master\",\nseems to have done the trick.\nThanks for the help.\n. --ignore-platform-reqs\nI've learned my one thing for the day. Time to head home :-)\nThanks again.\n. ",
    "dayt": "The method returns an xml formatted response for some reason. I posted what worked for me here: \nhttps://code.google.com/a/google.com/p/apps-api-issues/issues/detail?id=3599&colspec=API%20ID%20Type%20Status%20Priority%20Stars%20Opened%20Summary\n. I'm just using the example  user-example.php with a modification to check the access token. The idea was to log the user out if the token is expired, but it always logs the user out. For verification purposes, I took all the log-out code and just used the following:\necho $client->isAccessTokenExpired();\nThe returned value is always 1\n. Turns out in my code I was checking to see if the token was expired before I set the token. Works great once I fixed that!\n. ",
    "shoover56": "My Bad. I can replace out the +/ symbols before assigning the raw data. This isn't a bug for the client, so i'll close this.\n. ",
    "EvanCoh": "I was installing the \"google/apiclient\": \"1.0.*@beta\" release which is why gmail it is not included. You are correct. Thank you.\n. I removed the beta version I had and install dev and it is working fine.  Thank you.\n. ",
    "kroikie": "I have not been able to reproduce your issue. I used:\n$attach = $service->users_messages_attachments->get($userId, $message->getId(), $attachId);\nprint_r($attach);\nThe expected output was printed.\nMy PHP version is 5.3.10 and I'm using the latest version of this client library (as of 11 July 2014).\n. ",
    "karptonite": "I looked into it a bit. Here is the situation: PHP should already default to UTC if no time zone is explicitly. However, it will issue a warning in that case. I'm assuming that the code here is intended to prevent a warning from being issued. If that is the case, I don't know how to fix this problem. Anything you could do to check whether the default timezone is set by date_default_timezone_set() will trigger the warning if it is not set, as far as I can tell.\n. ",
    "volkan": "@ianbarber your welcome. It's done.\n. ",
    "pugsley": "No worries, cheers.\n. I've found the only way to get this to work as you're intending is to set approval prompt to force. Automatic approval prompts never return refresh tokens (even when offline is set).\nphp\n$client->setApprovalPrompt(\"force\");\n. ",
    "mstrogaly": "Maybe you could move the require statements into a separate file per api/feature,\nthen you can use require on those separate files or autoload with modern PHP.\nWhy do you need to support such an ancient PHP version anyways? 5.2 is from 2007!\n. ",
    "franz-josef-kaiser": "@ianbarber PHP 5.2 because of WordPress? You know that those stats are fake, right? They/Automattic can't divide by version and are including all installs that are pinging. Therefore they include highly outdated (abandoned) installs that just happen to still live some where. \n. ",
    "robwithhair": "Am I right in thinking 1.0.4-beta is the most stable for production use right now? \n. PHP Warning:  require_once(Google/Auth/AssertionCredentials.php): failed to open stream: No such file or directory in /var/www/appinstitute.co.uk/models/cloudStorage/google-api-php-client/src/Google/Client.php on line 18\n. still getting error in 1.0.4-beta\n. Lots of these require once statements seem to be wrong.\n. Shouldn't they be looking at relative directories using DIR . '/../Google' for example? \n. oops Github removed my underscores I Meant \nrequire_once __DIR__ . '/../Google/foo.php';\n. Thank you!  No way I'd have found that without the nudge in the right direction.  Thanks so much. \n. Could perhaps an installation link be added to the readme? \n. My bad.  it's mimeType not contentType.  However, could do with some more documentation / code comments on this.\n. Quickly submitted a pull request as at work. \n. I've only tried storage API.  I'm fairly sure it is supported as part of the storage API because it looks like it's included in the batch request examples on https://cloud.google.com/storage/docs/json_api/v1/how-tos/batch.  \nI've prepared this 'as minimal as I can' example.  \n```\n        $sources = array('Assets/takeawayImportLarge.csv', 'Assets/longStringFile.txt');\n        $destinations = array('toBeDeleted/takeawayImportLarge.csv', 'toBeDeleted/longStringFile.txt');\n    // OK, lets upload our batches\n    $client = self::client();\n    $client->setUseBatch(true);\n    $requestBatch = new Google_Http_Batch($client);\n    foreach ($sources as $key => $source) {\n        $destination = $destinations[$key];\n        $args = array('uploadType' => 'multipart',\n            'name' => $destination\n          );\n        $obj = new Google_Service_Storage_StorageObject();\n        $obj->setName($destination);\n        $args['data'] = file_get_contents($source); \n        $args['mimeType'] = static::getMime($source);\n        $request = static::service()->objects->insert('gs.appbuild.io', $obj, $args);\n        //var_dump($request);\n        $requestBatch->add($request, 'file-' . $source);\n    }\n    $results = $requestBatch->execute();\n    $client->setUseBatch(false);\n    var_dump($results);\n\n```\nHope this helps, could really do with batching as uploading lots of small files is really slow in php at the mo.\nOn a slightly unrelated note, if you don't mind me picking your brain, does the php-client-library support getting large files from storage?  It seems like the whole file would need to be loaded into memory and then saved?  Can you advise a way I might be able to do that from php?\n. I'm already using multipart, but tried every combination I could think of.\n$args = array('uploadType' => 'multipart',\n                'name' => $destination\n              );\nI think it's perhaps the batch upload URL that might be wrong?\nThanks for the tip.  Running some tests to see which download method is fastest.\nWas thinking curl, copy() or file_put_contents() but with a stream input.\n. Maybe some methods on the storage object like getData() and getDataToFile()?\n. Re DL: Testing on Large files I didn't see much difference between the speed of requests, however testing downloading multiple small files showed a significant speed increase using curl.\n. I am in touch with google cloud support re this issue with batch uploads.  I believe they are talking to the Cloud Storage Devs.\n. After talking via cloud support with the Cloud Storage dev team it seems that upload batching is not supported but does work at a different endpoint.  Google prefer multi threaded upload as this allows them to spread their server resources more easily, however as php isn't usually multithreaded without custom compile, in PHP batch uploading could be a significant speed increase.  I will paste below the exact response I received from Cloud Support re Cloud Storage.\n. Hello,\nI spoke with the Cloud Storage team about batch uploads and you are correct, the JSON API does not support batch uploads (nor does the XML API). The documentation on [1] is misleading and I've filed a bug to get it fixed.\nIf you absolutely must do batch uploading you can experiment with using the /upload/storage/batch endpoint directly instead of /batch which does have some support for multipart requests wrapped in an outer multipart request. Usage of that endpoint however is not recommended or supported.\nI understand that you cannot use multi-threaded php in your current environment, bu the recommended approach is to perform multiple uploads in parallel using threading. Requests made in parallel can be appropriately balanced across the cloud storage service while batch requests cannot be spread across Google's resources as efficiently.\nSincerely,\nJordan\n[1] https://cloud.google.com/storage/docs/json_api/v1/how-tos/batch\n. Above is exact response from Cloud support.  Is there anyway we could multithread uploads?  Guess we'll need to look at recompiling php, which isn't possible in many scenarios?\n. ",
    "joni-jones": "The issue still is actual.\nI have simple code:\nphp\nrequire_once 'Google/Client.php';\n$client = new Google_Client();\nBut get this error on page: Class 'app\\controllers\\Google_Client' not found.\nUPD: composer package already installed.\n. ",
    "oherych": "I`m use library \"google/apiclient\" and all ok\n. ",
    "ravigohil999": "This worked for me\nuse Google_Client;\nuse Google_Service_YouTube;\nTry it out and have fun.. ",
    "lracicot": "The duplicate class names are not in the google-api-php-client itself. This library is meant to be installed within other project and there is the problem. I may already have a class named Google_Client, in my source or in another third party.\nGood news: namespaces (required by psr-0) are designed to avoid this problem. As it says: [ http://php.net/manual/en/language.namespaces.rationale.php ]\n\"namespaces are designed to solve two problems that authors of libraries and applications encounter when creating re-usable code elements such as classes or functions:\n1. Name collisions between code you create, and internal PHP classes/functions/constants or third-party classes/functions/constants.\"\nAlso, prs-0 is, before everything else, is an autoloading convention and it would be very interseting to be able to load the library in a defined standard way.\n. @harikt This library is totally not PSR-0 compliant, as the first rule is:\nA fully-qualified namespace and class must have the following structure \\\\\\\nAnd for many other reasons. See: http://www.php-fig.org/psr/psr-0/\n. ",
    "harikt": "@ianbarber you could make use of the spl autoload http://php.net/manual/en/function.spl-autoload-register.php . To my knowledge this library is already PSR-0 compatible.\n. @lracicot I am already there in the mailing list for quite some time.\nWhat about the old Solar, Zend , Twig , Pear ... .\nIn this case the namespace is Google_ . May be with definitions it don't satisy :-/ .\n. ",
    "navneetccna": "yes i am doing it before the generating the auth url.\n. this is my code every thing is working fine for 1-2 hours but after that my token get expired and i am unable to refresh that as i mention previously.\ninclude_once('../../../functions/drives_connections.php');\n$api_connections=new Api_Connections();\n$apidetails=$api_connections->api_connections();\n$client_details=$apidetails[\"google_api\"];\n$client_id = $client_details[\"client_id\"];\n$client_secret = $client_details[\"client_secret\"];\n$redirect_uri = $client_details[\"redirect_uri\"];\n/********\n  ATTENTION: Fill in these values! Make sure\n  the redirect URI is to this page, e.g:\n  http://localhost:8080/fileupload.php\n **********/\n$client = new Google_Client();\n$client->setClientId($client_id);\n$client->setClientSecret($client_secret);\n$client->setRedirectUri($redirect_uri);\n$client->addScope(\"https://www.googleapis.com/auth/drive\");\n$client->setAccessType(\"offline\");\n$service = new Google_Service_Drive($client);\nif (isset($_REQUEST['logout'])) {\n  unset($_SESSION['upload_token']);\n}\nif (isset($_GET['code'])) {\n  $client->authenticate($_GET['code']);\n$client->setApprovalPrompt(\"auto\");\n$_SESSION['upload_token'] = $client->getAccessToken();\n}\n. can you please provide a working example for the same in this repo with other examples ?\n. ok let me try $client->setApprovalPrompt(\"force\"); this with my code.\n. can you please provide a working example for the same in this repo with other examples ?\n. As i try and change $client->setApprovalPrompt(\"auto\"); to $client->setApprovalPrompt(\"force\"); still didnt receive any refresh token in response \n{\"access_token\":\"ya29.VwDJ4UGbKTKsyRwAAADusG-fltPrvhT_RtbHA5uiLLLU0pmXzerpqwkOSrv0CQ\",\"token_type\":\"Bearer\",\"expires_in\":3598,\"created\":1407152019}\ncan you please provide a working example for the same in this repo with other examples ?\n. nop\n. yes i tried that too also i removed app from user account and tried this again\n. check new code and got the solution \nreturn isset($this->modelData[$key]) ? $this->modelData[$key] : null;\n. ",
    "edmundluong": "I can confirm that after struggling with getting a refresh token, forcing the approval prompt and setting the access type to offline is sufficient to solve the issue. I did have to revoke the previous authorization to get this working as well.\nSomething as such (I extended the Google_Client class for my implementation):\n// ignore the $this-> values\n$this->setClientId($this->_clientID); \n$this->setClientSecret($this->_clientSecret);\n$this->setRedirectUri($this->_redirectURI);\n$this->setDeveloperKey($this->_devKey);\n$this->setScopes(array('https://www.googleapis.com/auth/analytics.readonly'));\n$this->setAccessType('offline');\n$this->setApprovalPrompt('force');\nKeep up the good work guys!\n. ",
    "ip512": "I use the same code and for my application I need  to autorize it twice. One time to get authorized for access, and another time to get offline access and retrieve refresh token.\nIs there a way to ask both permissions at the same time ?\n. Actually I was confused by the message that is displayed when user authorize the application. The first time, nothing is displayed about offline access, but the refresh_token is well returned. If I call the authorize URL another time with forced promt, the message displayed show explicitly an offline access request (even if the access is already granted).\nThis looks weird, but it works fine if I test the presence of resfresh_token. By the way, I use json_decode($client->getAccessToken()) to get the refresh token. Is there another way to check if the refresh token is available ?\n. I created PR #309 \n. That's done!\n. ",
    "erfanimani": "@ianbarber, good article on why not to use approval_prompt=force. The reason why people do this, I'm guessing, is because almost all of the PHP code samples found on the developers.google.com don't actually save the refresh token when refreshing the access token.\nExample: https://developers.google.com/apps-script/guides/rest/api\n// Refresh the token if it's expired.\nif ($client->isAccessTokenExpired()) {\n    $client->refreshToken($client->getRefreshToken());\n    file_put_contents($credentialsPath, $client->getAccessToken());\n}\nAbove sample only saves the new access token (which doesn't contain the refresh token) and nowhere is explained that you'll need to save the refresh token separately, otherwise you'll lose it after the first time your access token is expired.\nThe code sample basically works for the first two access tokens, then it'll stop working.\nSomething like this would have been better:\nif ($client->isAccessTokenExpired()) {\n        $refreshToken = $client->getRefreshToken();\n        $client->refreshToken($refreshToken);\n        $newAccessToken = $client->getAccessToken();\n        $newAccessToken['refresh_token'] = $refreshToken;\n        file_put_contents($credentialsPath, json_encode($newAccessToken));\n    }\nThis is probably a frequent cause of \"Dang, why did it lose my refresh token? Again?!\" \n. Also, calling $client->setIncludeGrantedScopes(true); without setting scopes explicitly will throw Invalid or Empty Node passed to getItem constructor.\n. I've got my app to work, but the workaround isn't very nice. I'm only setting the scopes on the client when creating the authentication URL (createAuthUrl). In any other scenario I'm setting a bogus scope to prevent the lib from erroring out. \n. Edit: actually, my bad - class_exists throws a warning in various PHP frameworks and that's why I got the assumption that tedivm/stash was a hard dependency while in reality it's not. Again, not the lib's fault - but the framework as it doesn't conform to PSR-4 standards\n\nAutoloader implementations MUST NOT throw exceptions, MUST NOT raise errors of any level, and SHOULD NOT return a value.\n. \n",
    "genebustam": "@erfanimani you sir are a gentleman and a scholar.\nThat was the exact reason why it wasn't working. And I'm sure it's the reason why it wasn't working for @navneetccna either. Those code examples should be updated by Google.\n. ",
    "dxdc": "Google has updated their PHP quickstart, with an improved method to handle this:\nhttps://developers.google.com/apps-script/guides/rest/quickstart/php\nSnippet below:\n```php\n  // Load previously authorized credentials from a file.\n  $credentialsPath = expandHomeDirectory(CREDENTIALS_PATH);\n  if (file_exists($credentialsPath)) {\n    $accessToken = json_decode(file_get_contents($credentialsPath), true);\n  } else {\n    // Request authorization from the user.\n    $authUrl = $client->createAuthUrl();\n    printf(\"Open the following link in your browser:\\n%s\\n\", $authUrl);\n    print 'Enter verification code: ';\n    $authCode = trim(fgets(STDIN));\n// Exchange authorization code for an access token.\n$accessToken = $client->fetchAccessTokenWithAuthCode($authCode);\n\n// Store the credentials to disk.\nif(!file_exists(dirname($credentialsPath))) {\n  mkdir(dirname($credentialsPath), 0700, true);\n}\nfile_put_contents($credentialsPath, json_encode($accessToken));\nprintf(\"Credentials saved to %s\\n\", $credentialsPath);\n\n}\n  $client->setAccessToken($accessToken);\n// Refresh the token if it's expired.\n  if ($client->isAccessTokenExpired()) {\n    $client->fetchAccessTokenWithRefreshToken($client->getRefreshToken());\n    file_put_contents($credentialsPath, json_encode($client->getAccessToken()));\n  }\n  return $client;\n```. ",
    "webgurus": "Hey guys, \nI have a huge problem where absolutely no error is returned from google nor php. I've written a google client oauth2 connect model, which is perfectly working when I'm running it on my dev environment on my mac (I'm not using a simple localhost, it's actually vagrant what I'm using to mirror the production server as much as possible) but it doesn't work when I push it to production. It's just simply not returning any error. The code reaches the part where I have the auth code from Google and it hangs at the part where I'm trying to exchange it for a token ( $client->authenticate($auth_code) ). I really don't know what am I doing wrong, since everything is working perfect without errors on dev site (which has a public link by the way, and I tried accessing it from different public IP addresses). The moment I push the code to a live server, it just stops authenticating. I have the correct oauth credentials set up for every production server, redirect uri is correct. I simply don't know what am I doing wrong.... ",
    "jmcgranahan": "I am having this same error as previous users, even with the modified \"refresh token\". I even deleted my directory and started over and got the same error so I don't know what to do next. Can anyone give me guidance? Here's the error (and this is without making any modifications to the file quickstart.php):\nFatal error: Uncaught LogicException: refresh token must be passed in or set as part of setAccessToken in C:\\Users\\mcgranj\\Dropbox\\eBay_web\\google\\vendor\\google\\apiclient\\src\\Google\\Client.php:258 Stack trace: #0 C:\\Users\\mcgranj\\Dropbox\\eBay_web\\google\\quickstart.php(69): Google_Client->fetchAccessTokenWithRefreshToken(NULL) #1 C:\\Users\\mcgranj\\Dropbox\\eBay_web\\google\\quickstart.php(98): getClient() #2 {main} thrown in C:\\Users\\mcgranj\\Dropbox\\eBay_web\\google\\vendor\\google\\apiclient\\src\\Google\\Client.php on line 258. ",
    "yidas": "@pugsley is right!\nIn PHP SDK, adding $client->setApprovalPrompt(\"force\") will work for Token refresh.\n$client->setAccessType('offline');\n$client->setApprovalPrompt('force');. ",
    "ragingdave": "Alright well in that case, I was only trying to override the base_path for one service, not all, so I ended up doing a change and making the private configuration var protected, so on an extended Google_Config, I can just set anything to whatever I need it to be, which come to think might be a nice change to have overall. If this sounds good, I could make a pull request with that change.\n. ",
    "tomshaw": "@silvolu Awesome! Worked perfectly. Thank you.\n. ",
    "nareau": "Created playlist file\n. ",
    "ivelfan": "I still use the lastest commit.\nI don't think so, I tried to use a direct connexion instead of entreprise proxy and it is the same result.\n. It's a proxy issue, sorry.\n. ",
    "vincetg2": "Looks like Google_Http_CacheParser::isExpired() uses strtotime() and Google_IO_Abstract->makeRequest() uses date().\nBoth strtotime() and date() can be affected by the value of date.timezone, so it seems that those uses of these functions may have relied on it being UTC.\nWould it be worth changing date.timezone temporarily and then restoring the original date.timezone before and after the use of strtotime() and date()?\n. Actually, for date(), it looks like gmdate() can be used as a drop-in replacement to get UTC-zoned output.\n. ",
    "FlorianSW": "Sent\n. ",
    "sc0ttkclark": "So every app that includes it in their code has to add a new include path? I went ahead and did that, but that's the first time I've had to do that for a third-party API when building an app.\n. ",
    "Scorcher": "Yes, you can. You should check token changes after each call to Google API. If changed - store it and use new one next time. If you will use old one (ignoring changes) - the library will update token every time (it is one more request).\nSee these two sections for detailed understanding: https://developers.google.com/accounts/docs/OAuth2WebServer#offline\n. Now I wrote these code to have opportunity multiprocess communicate with API. TokenProvider is more pretty :) and can be integrated with onRefreshCallback idea #300.\n``` php\n// method called after each library (api) request\n    protected function checkAndUpdateToken()\n    {\n        $newToken = $this->getClient()->getAccessToken();\n        if ( $newToken !== $this->token )\n        {\n            $currentToken = GoogleTokens::updateTokenByAccount($this->clientId,\n                $this->accountName, $newToken);\n            $this->token = $currentToken;\n            if ( $newToken !== $currentToken )\n                $this->getClient()->setAccessToken($this->token);\n        }\n    }\n/**\n * Set Token to storage if it is newer then already stored and return current token\n *\n * @param string $clientId - clientId\n * @param string $accountName - account name\n * @param string $token - new token\n *\n * @return string current token\n *\n * @throws CException\n */\npublic static function updateTokenByAccount($clientId, $accountName, $token)\n{\n    if ( self::getLock() === false )\n        throw new CException('Can not get lock to update token');\n    // get token from storage\n    $criteria = new CDbCriteria;\n    $criteria->compare( 'client_id', $clientId, false );\n    $criteria->compare( 'account_name', $accountName, false );\n    /** @var GoogleTokens $googleToken */\n    $googleToken = self::model()->find($criteria);\n    if ( $googleToken === null )\n    {\n        // set base data if it is new\n        $googleToken = new self();\n        $googleToken->client_id = $clientId;\n        $googleToken->account_name = $accountName;\n    }\n    else\n    {\n        // compare age of stored and new token\n        $tStored = json_decode($googleToken->token);\n        $tNew = json_decode($token);\n        if ( $tNew['created'] < $tStored['created'] )\n        {\n            // if stored token is newer - just return it without saving \"new one\"\n            self::releaseLock();\n            return $googleToken->token;\n        }\n    }\n    $googleToken->lastUpdate = date('Y-m-d H:i:s');\n    $googleToken->token = $token;\n    if ( $googleToken->save() !== true )\n        throw new CException('Can not save token by account: clientId='.$clientId\n        .'; accountName='.$accountName.';');\n    self::releaseLock();\n\n    return $token;\n}\n\n```\n. ",
    "tmatsuo": "Can we close this now? #905 seems merged.\n. Closing. Feel free to re open if you think differently. @Scorcher Is this issue still relevant? If so, are you able to create a pull request for this feature?. @bshaffer I think the implementation around token has been changed, so can we close this now?. @whatthejeff Does it make sense for you to create a Pull Request for this issue?. Now the issue should be moved to:\nhttps://github.com/google/google-api-php-client-services. @patkar Closing here, but feel free to open a new one on the other repo. Thanks!. Feel free to reopen if it's still relevant. The repro script will help a lot. . Should we move this issue to https://github.com/google/google-api-php-client-services ?. Ok, let's close this. @bshaffer Can you share some information about how to generate the code in google-api-php-client-services, and where is the generator code, etc so that I will be able to fix this issue, or feel free to take this issue by yourself.. Hi, it seems like @BenWise9000 has a wordaround. @erikverheij Does it make sense to close this issue, or should we still fix this?. Closing this for now. Please re-open if you come up with reproducible code!. @maxgalbu Is the link in https://github.com/google/google-api-php-client/issues/508#issuecomment-84279445 still pointing to the right code?. Hi everyone.\nSorry for keeping the issue left open for a long time. It looks like the code in question was refactored in this repo. Can anyone confirm if it is still happening? If so, can you add reproducible code?\nThanks. Ok, let's close. Hi everyone, it looks like the code in question is refactored. Is this still relevant?. I recommend that you use https://github.com/googlecloudplatform/google-cloud-php. I tried to reproduce it but failed. The code is as follows:\n```php\n<?php\nrequire_once DIR . '/vendor/autoload.php';\n$client = new Google_Client();\n$client->setApplicationName('PubsubSTest');\n$client->useApplicationDefaultCredentials();\n$client->setScopes(array(\n    'https://www.googleapis.com/auth/cloud-platform'\n));\n$pubsub = new Google_Service_Pubsub($client);\n$resp = $pubsub->projects_topics->listProjectsTopics('projects/tmatsuo-test');\nvar_dump($resp);\n``. @danbyrne I'm closing this, but feel free to re-open with a repro. Thanks!\n. @woofyman99 Hi, thanks for the report. where is the pull request?. @nebadom Sorry for the late reply, but is this issue still relevant? Do you want to have a whole list of messages? If so, there is a concern with memory consumption. It is a far better design to use the nextpage token. Ideally it is great if all theList*` methods returns a generator for the whole result, but since this library supports PHP 5.4, it is difficult for now.\nMaybe we should stop supporting PHP 5.4 or older. @bshaffer WDYT?. @nebadom Oh, maybe you're on App Engine PHP standard? I think the generator approach won't work well on App Engine Standard beyond the Deadline.. Adding a possible cause\n* Cache conflict between two installation?. @ghost Sounds like it was the server side issue. Closing for now. Please reopen if it's still an issue.. Sorry, but it's not a Q&A forum. Please use StackOverflow for Q&A. Seems like there's a workaround?. @borgogelli The original stackoverflow question seems to have some answers. Closing for now, but feel free to re open if it's still an issue.. Closing for now. Please re-open if it's still an issue.. Seems like we can close this. Sorry, but if it's a question, consider using stackoverflow. Seems like we can close this. Is this still an issue?. Closing for now.. Closing. Please re-open if it's still an issue.. https://github.com/google/google-api-php-client-services/blob/b00efad5e592afc4d385854bf9096fa7eed0178e/src/Google/Service/ShoppingContent/Resource/Inventory.php#L40\nMaybe you can pass the $optParams?. Please re-open if it's still an issue. Sorry, but for questions, please use Stackoverflow. If the service is really not available for your country, there's nothing we can do in the client library.\nPlease re-open if you think it's an issue within the library.. Closing, but feel free to re-open if it's still an issue.. Sorry, but for the question, consider using stackoverflow. Seems like it's not an issue within the library. Sorry, but for questions, consider using stackoverflow. Is this still an issue?\nAlso is everyone aware of the google/cloud library has Datastore package?. Closing, please reopen if it's still an issue. Seems like there's a workaround on the original stackoverflow question.. I don't think it's library's bug. Is this related?\nhttp://stackoverflow.com/questions/34717916/android-google-drive-api-getdownloadurl-return-null. Really a big one! I took a quick glance and put some comments.\n. Seems like App Engine now supports cURL:\nhttps://cloud.google.com/appengine/docs/php/#PHP_cURL_support\nHave you tried that?\n. Sorry, apparently you tried them. I think we should make it (App Engine cURL support) work also.\n. I'd appreciate it if you could add little bit more context. What problem this patch will fix? Is there an original bug?\n. LGTM\n. LGTM\n. LGTM\n. LGTM\n. Oh nevermind. RC2 fixes the issue :)\n. Oh, I LGTMed, but did undo LGTM. Can you revert? See https://github.com/google/google-api-php-client/pull/839#discussion_r52365593\n. @huebs \nThat's a good point. I have a proposal.\n. LGTM\n. LGTM\n. LGTM\n. LGTM\n. LGTM\n. LGTM\n. LGTM\n. LGTM\n. Sweet! Thanks!\n. Guys thanks for the discussion.\n@bshaffer Does it make sense to create the UserRefreshCredentials only when\n- the original access token is expired\n- isset($token['refresh_token'])\n- the credential is not UserRefreshCredentials\n  ?\n. Now the if clause is\nphp\n      if ($this->isAccessTokenExpired() && isset($token['refresh_token'])) {\n        $credentials = $this->createUserRefreshCredentials(\n            $scopes,\n            $token['refresh_token']\n        );\n      }\nIt causes the $credentials will be cleared when you call the 2nd API call.\nSo I'm thinking something like:\nph\n      if ($this->isAccessTokenExpired() && isset($token['refresh_token'])\n          && ! $credentials instanceof UserRefreshCredentials) {\n        $credentials = $this->createUserRefreshCredentials(\n            $scopes,\n            $token['refresh_token']\n        );\n      }\nso that if you call the API again, the $credentials will keep holding the same UserRefreshCredentials. I think this will solve the issue described in https://github.com/google/google-api-php-client/pull/905#issuecomment-202046445\n. @bshaffer Oh I got it. Somehow I thought $credentials is an instance variable.\nWell, then how about to have an instance variable that holds the UserRefreshCredentials and do the same check?\nphp\n    /**\n     * @var UserRefreshCredentials $userRefreshCredentials\n     */\n    private $userRefreshCredentials;\n    ...\n    ...\n    if ($this->isAccessTokenExpired() && isset($token['refresh_token'])) {\n        if (!isset($this->userRefreshCredentials)) {\n            $this->userRefreshCredentials = $this->createUserRefreshCredentials(\n                $scopes,\n                $token['refresh_token']\n            );\n        }\n        $credentials = $this->userRefreshCredentials;\n    }\n. Oh, we already has $this->lastCredentials, then we can check\nif ($this->isAccessTokenExpired() && isset($token['refresh_token'])) {\n        if (! $this->lastCredentials instanceof UserRefreshCredentials) {\n            $credentials = $this->createUserRefreshCredentials(\n                $scopes,\n                $token['refresh_token']\n            );\n        } else {\n          $credentials = $this->lastCredentials;\n        }\n    }\nWhat do you think?\n. Sure, if we can set the brand new access token to the client object, that's better.\n. I'm fine with both of them\n. LGTM\n. One question. Looking briefly, I think now it's a user's responsibility to configure the cache. Am I right? If so, can you add a brief documentation too?\n. LGTM\nOne question. Can you guess the cache key? If so, I think you can always get the current auth token from the cache. Do we still need the callback?\n. LGTM\n. https://getcomposer.org/doc/02-libraries.md#lock-file\nFor libraries, it makes sense to not have composer.lock file in the repo, because the composer.lock file in libraries won't lock your application's dependencies. In my opinion, libraries should have as loose restriction as possible to allow maximum flexibility on application that rely on them.\n. Ideally, each api service package should be an independent composer package because API release should conform to semantic versioning.\nEven if that happens, it is still a responsibility of application to stick to a specific version.\nFor example, if you use php-datastore-client v2.0.0 and the datastore releases v3.0.0 API, we will start having it as a default. This is because we want to provide the latest version by default.\nUnfortunately, currently google/apiclient-services contains all of the services. Potentially we can just tag it as 1.0.0, and weekly increment the major version (potentially we can check the API version change, but it's a bit of work).\nThen still, application has a responsibility of sticking to a specific release tag of google/apiclient-services. Normally, if you don't want to be annoyed by any compatibility changes, your best bet is to check the current latest version on the repo, and use that specific version of google/apiclient-services.\nI hope it does alleviate your issue.\nRe: semantic versioning\nBasically what you're saying is right. Ideally we should follow this, but because of the current way of how google/apiclient-services package is built, it's a bit hard to always provide the most appropriate version number. So I'm proposing weekly major version increases.\nLast but not least, @bshaffer did a great job of automating the release of google/apiclient-services. I would like to ask you to be less oppressive. The current state is not ideal, but it's significantly improved than it was before.\nIf we have indefinite time, we can provide ideal situation, but unfortunately our resource is limited and the current form is a result of some pragmatic compromises.\nI hope this helps you to understand the current situation.\n. LGTM\n. LGTM\n. lgtm\n. LGTM\n. LGTM with a minor nit\n. sounds good too\n. Re: retry on 40x\nSome cases (I think only) for 403, it's recommended.\nExample:\nhttps://developers.google.com/analytics/devguides/reporting/core/v3/errors\n\n403   userRateLimitExceeded: Retry using exponential back-off. You need to slow down the rate at which you are sending the requests.. @ManInTheBox LGTM\n\n@bshaffer WDYT?. Sorry about the inconveniences. I'd like to hear input from you. Is there an equivalent feature in V3? If not, does it make sense to add something to the API V3?. Let's have a generic workaround with providing a library generator available. PR is already opened at:\nhttps://github.com/googleapis/google-api-php-client-services/pull/132/files\n. @Assimilationstheorie I don't disagree. How do you want to proceed? Do you want to make another change on this PR and merge this first? or Do you want to file another issue and wait for us to fix them?. It's rather a question. Why composer.json doesn't have GuzzleHttp as a dependency?\n. getBody()->replaceFields() doesn't seem straightforward.\nCan you simply do as follows:\nphp\n$request = $this->http->createRequest('POST', Google_Client::OAUTH2_REVOKE_URI)\n    ->addHeader('Cache-Control', 'no-store')\n    ->addHeader('Content-Type', 'application/x-www-form-urlencoded')\n    ->setPostField('token', $tokenString);\nor something?\n. Maybe I'm wrong, but this string concatenation is little bit hard to read. Is it feasible to use String.format-ish thingy here?\n. Add a newline at the end?\n. I still see the call for replaceFields...\n. I would defer it to the guide on the composer website.\n. There are multiple way to install composer and the command line varies. How about just \nsh\n$ composer require google/apiclient\n?\n. Is the path /path/to/google-api-php-client correct?\n. I would say /path/to/your-project\n. Here is the reaosn why.\nWell, curling a script from the web and pipe it into an interpreter, might be a trend, but in my opinion, it's dangerous in some senses. When composer website started to suggest more secure way, this document will provide an orphaned, insecure instruction.\n. Well, people who don't know composer can still download the zip file, right?\n. On https://getcomposer.org/doc/00-intro.md\nThere is a mention about Windows installer, which is better than the command line we are showing. Does the command line work with Windows console?\n. Good point :)\nCan you use __DIR__ . '/../autoload.php' instead?\n. > I am unsure what that would accomplish.\n@bshaffer I think it should work even you use custom vendor directory. I may be wrong though.\n. Ah, OK. I misunderstand that src/Google/autoload.php is installed when you're using composer. \n. Alright. LGTM\n. Now the exception is just thrown away. Is it possible to log details as a warning?\n. I see. Thanks.\n. Does Request::getHeadersAsString() have a newline at the beginning? Otherwise it will be in the same line with the $firstLine as far as I read the code.\n. The implementation is:\nhttps://github.com/guzzle/guzzle/blob/5.3/src/Message/AbstractMessage.php#L206\nIs it safe to assume they won't change the implementation?\n. 0777 seems little bit dangerous. What kind of data will be in the cache? Is any sensitive data there? Does it make sense to use 0770 instead?\n. 0660 here too\n. Ok, let me think about it.\n. I think the root user's cache should not be accessible from other users.\nDoes it make sense to prefix the cache directory with the username?\n. > CLI cache cleaners will be unable to remove files created by the web interface.\nWhy do you need to cleanup?\n\nThe web interface will not be able to read files created by a CLI cache warmer.\n\nIs this a big problem?\nThink about this scenario.\nI have downloaded the credentials file and stored secretly, only available for root.\nroot process will create a cache which contains the access token from the credentials.\nThen any other users should not be able to read that cache.\nThe correct approach for the cron scenario is to run the process as an appropriate user, not root.\n. Can you just use the whole username? The first 2 letters of the md5 hash of the usernames easily collision.\n. Can you change the order of them?\nphp\n$dirHash = $userHash . DIRECTORY_SEPARATOR . $fileHash;\nThen there will be no permission issue.\nAlso, maybe you can just use the username, instead of a hash of the username? What's the purpose of hashing the username? The md5 hash collision may be unlikely, but from the security standpoint, it needs to be theoretically perfect.\n. Ok, I wanted to make sure the collisions are not the problem and I found one of the shortest collision is between binary values way longer than the usual usernames.\n4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2\ncollides with\n4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2\nThanks for being patient\n. Does this command work on Windows?\n. I'm concerning the envvar\n. If you hit Ctrl+C while waiting for the token, what happens with the webserver process?\n. It might be an edge case, but if the isAltMedia == true, and the response was an error, it seems that the error message will be thrown away.\n. Nit: Embedding the environment variable into the code will reduce the benefit from Application Default Credentials.\nI think there is ADC support, right?\n. Can you create a utility for creating a cache and reuse it?\n. Hm, ok, I can live with that.\n. Nit:\nIf the assert fails, will the unset statement still be executed?\n. How about the one for the pageHeader in the same file?. Looks good to me, but I want @bshaffer to decide. Here is another short tag. Another short tag. Do you want to do is_file(TESTFILE) instead?. ",
    "minedun6": "Well, I did dig a little bit more in The api using the Api Explorer and other tools, and I've found out that not all the responses of the youtube api countain the statistics section, I did understand that the resource must be Youtube Video to actually ask for the statistics section (viewCount, likeCount, dislikeCount ....) but actually there is some unecessary stuff within the api but hopefully google will help out again ^^\n. ",
    "danielbachhuber": "Done\n. ",
    "romainneutron": "It seems the error comes from a wrong variable name: I provided a wrong $client_id. Developers should use the Email address provided in the console instead of the client id\n. ",
    "luiscoms": "I'm getting the same error, but I didn't found the solution\n. ",
    "vbuck": "Well, I think I answered my own question. See here for the answer on SO:\nhttp://stackoverflow.com/questions/11851316/oauth2-signing-error-in-google-analytics-api-using-google-client\nTo summarize: PHP < 5.3.x expects that the 4th parameter in openssl_sign to be an integer, where Google_Signer_P12 is giving it a string.\n. ",
    "aran112000": "Hi @ianbarber, \nThanks for the reply.\nIssues have been raised a number of times and nothing ever appears to be happening with them yet the community is crying out for support to annotate via the APIs - Is there any way this could be nudged perhaps if it's not something you're able to accept as a bug/request via GitHub?\nhttps://code.google.com/p/analytics-issues/issues/detail?id=53 - 389 people have starred\nhttps://code.google.com/p/gdata-issues/issues/detail?id=1793 - 259 people have starred\n. ",
    "ctessmer": "+100 to @elyobo \n. ",
    "edgeprod": "Any status here? Is this something you're actively developing, elyobo?\n. No problem at all! All work is voluntary in nature, your only commitments are the ones you make. :) I just didn't want to re-implement something if you were already working on a solution. Maybe you can put some eyeballs on it when we have something fleshed out.\n. Ticket was a bit stale, and I'd like to move this one off of the radar. Change made, CLA submitted.\n. ",
    "whatthejeff": "394 is my stab at this. It works out of the box without any dependencies, but can be configured to delegate to more feature-rich PSR-3 logging libraries like monolog.\n. @ianbarber Seems like this can probably be closed as well.\n. Since a bit of this library is already machine-generated, maybe it makes sense to generate a classmap at the same time? There's a great library called phpab that can auto-generate PHP 5.2 compatible classmap autoloaders. \nOne of the nice things about classmaps is they won't accidentally include someone else's files and they won't waste resources checking the filesystem for classes that either don't exist or don't belong to them. Also, classmaps can avoid a lot of the letter casing issues the current implementation suffers from. For example, the current implementation can actually include the same file more than once on case-insensitive filesystems. The following code will trigger a fatal error on most macs:\n``` php\nrequire_once 'autoload.php';\n$service = new Google_Service_Reseller(new Google_Client());\n// Fatal error: Cannot redeclare class Google_Service_Reseller\nclass_exists(\u2018Google_Service_reseller_addresss\u2019);\n```\nThis happened to me recently with some code that dynamically builds models and it was really confusing that a call to class_exists could trigger a fatal error about a totally different class.\n. Alright, sounds good.\n. Only thing I can see that was missing from my PR is adding vendor and composer.lock to .gitignore.\n. > HOP_BY_HOP is there since first commit, there is no trace of it in the diffs of commit history,\n$HOP_BY_HOP was added to the cURL IO class here:\nhttps://code.google.com/p/google-api-php-client/source/detail?r=347\nThe code that uses $HOP_BY_HOP was later refactored to the Google_IO_Abstract class when native streams support was added here:\nhttps://code.google.com/p/google-api-php-client/source/detail?r=580\nUnfortunately, the $HOP_BY_HOP variable was never moved to the Google_IO_Abstract class with the code that relied on it. Instead, it was left in the cURL IO class which was not available in the GitHub version of this lib until it was ported in #93 (sans the $HOP_BY_HOP variable).\nWhat's really interesting is I don't think this code ever worked as expected. It was intended to comply with the now obsolete rfc2616 13.5.1, but actually does the exact opposite of what the RFC suggests. Seems the code was incorrectly ported from  httplib2.py.\n. Oh, okay that makes sense. I noticed it had been failing for quite some time and figured maybe it was expected. Good to know the fix is on the way though :+1: \n. Superseded by #407.\n. Seems like the individual IO classes (Google_IO_Curl and Google_IO_Stream) are intended to handle this. Do you have a small, reproducible example where this isn't working?\n. Sorry for the giant PR :). If you want to test, you can get it started with something as simple as:\n``` php\n$config = new Google_Config();\n$config->setLoggerClass('Google_Logger_File');\n$client = new Google_Client($config);\n// Make some API calls...\n```\nAfter this, you should start getting debugging output in your console (the default file is php://stdout). You can control the amount of data that's logged with:\nphp\n$client->getLogger()->setLevel('info') // or whatever lowest level you want to see\nAnd you should be able to adjust the configs in an INI file if you're using one.\nThe events I picked to log were the ones I thought gave the best understanding / context of the full workflow while I was working on integrating some of these services. I'm happy to make adjustments, though.\n. Sample output with Google_Logger_Abstract[allow_newlines] = true:\n[17/Nov/2014:05:59:44 -0500] INFO: Service Call {\n    \"service\": \"siteVerification\",\n    \"resource\": \"webResource\",\n    \"method\": \"insert\",\n    \"arguments\": {\n        \"verificationMethod\": {\n            \"location\": \"query\",\n            \"type\": \"string\",\n            \"value\": \"FILE\"\n        }\n    }\n}\n[17/Nov/2014:05:59:44 -0500] DEBUG: File cache hit {\n    \"key\": \"***\",\n    \"file\": \"***\",\n    \"var\": {\n        \"access_token\": \"***\",\n        \"expires_in\": 3600,\n        \"created\": 1416134161\n    }\n}\n[17/Nov/2014:05:59:44 -0500] DEBUG: OAuth2 access token expired \n[17/Nov/2014:05:59:44 -0500] INFO: OAuth2 access token refresh with Signed JWT assertion grants. \n[17/Nov/2014:05:59:44 -0500] DEBUG: cURL request {\n    \"url\": \"https://accounts.google.com/o/oauth2/token\",\n    \"method\": \"POST\",\n    \"headers\": {\n        \"content-type\": \"application/x-www-form-urlencoded\",\n        \"content-length\": 858\n    },\n    \"body\": \"***\"\n}\n[17/Nov/2014:05:59:44 -0500] DEBUG: cURL response {\n    \"code\": 200,\n    \"headers\": {\n        \"content-type\": \"application/json; charset=utf-8\",\n        \"cache-control\": \"no-cache, no-store, max-age=0, must-revalidate\",\n        \"pragma\": \"no-cache\",\n        \"expires\": \"Fri, 01 Jan 1990 00:00:00 GMT\",\n        \"date\": \"Mon, 17 Nov 2014 10:59:44 GMT\",\n        \"content-disposition\": \"attachment; filename=\\\"json.txt\\\"; filename*=UTF-8''json.txt\",\n        \"x-content-type-options\": \"nosniff\",\n        \"x-frame-options\": \"SAMEORIGIN\",\n        \"x-xss-protection\": \"1; mode=block\",\n        \"server\": \"GSE\",\n        \"alternate-protocol\": \"443:quic,p=0.01\",\n        \"transfer-encoding\": \"chunked\"\n    },\n    \"body\": {\n        \"access_token\": \"***\",\n        \"token_type\": \"Bearer\",\n        \"expires_in\": 3600\n    }\n}\n[17/Nov/2014:05:59:44 -0500] DEBUG: File cache set {\n    \"key\": \"***\",\n    \"file\": \"***\",\n    \"var\": {\n        \"access_token\": \"***\",\n        \"expires_in\": 3600,\n        \"created\": 1416221984\n    }\n}\n[17/Nov/2014:05:59:44 -0500] DEBUG: OAuth2 authentication \n[17/Nov/2014:05:59:44 -0500] DEBUG: cURL request {\n    \"url\": \"https://www.googleapis.com/siteVerification/v1/webResource?verificationMethod=FILE\",\n    \"method\": \"POST\",\n    \"headers\": {\n        \"content-type\": \"application/json; charset=UTF-8\",\n        \"authorization\": \"Bearer ***\",\n        \"accept-encoding\": \"gzip\",\n        \"content-length\": 105\n    },\n    \"body\": {\n        \"verificationMethod\": \"FILE\",\n        \"site\": {\n            \"type\": \"SITE\",\n            \"identifier\": \"***\"\n        }\n    }\n}\n[17/Nov/2014:05:59:45 -0500] DEBUG: cURL response {\n    \"code\": 200,\n    \"headers\": {\n        \"cache-control\": \"no-cache, no-store, max-age=0, must-revalidate\",\n        \"pragma\": \"no-cache\",\n        \"expires\": \"Fri, 01 Jan 1990 00:00:00 GMT\",\n        \"date\": \"Mon, 17 Nov 2014 10:59:45 GMT\",\n        \"vary\": \"Origin\\nX-Origin\",\n        \"content-type\": \"application/json; charset=UTF-8\",\n        \"content-encoding\": \"gzip\",\n        \"x-content-type-options\": \"nosniff\",\n        \"x-frame-options\": \"SAMEORIGIN\",\n        \"x-xss-protection\": \"1; mode=block\",\n        \"server\": \"GSE\",\n        \"alternate-protocol\": \"443:quic,p=0.01\",\n        \"transfer-encoding\": \"chunked\"\n    },\n    \"body\": {\n        \"id\": \"***\",\n        \"site\": {\n            \"type\": \"SITE\",\n            \"identifier\": \"***\"\n        },\n        \"owners\": [\n            \"***\"\n        ]\n    }\n}\n. No problem. Let me know if there's anything I can do to help.\n. @ianbarber No problem.\nPS: Did you get the email I sent you last week? I realize this is sort of out of context, but I'm not sure how else to get in touch with you.\n. Alright, PR rebased and all tests are passing. Let me know if you need any help with the documentation. We definitely want to remind people not to use debug-level logging in production (for the obvious security/performance concerns).\n. > I was trying to access the service through a proxy and needed to modify those settings.\nYou should be able to do something like:\nphp\n$client = new Google_Client();\n$curl = new Google_IO_Curl($client);\n$curl->setOptions(array(\n  CURLOPT_PROXY => '127.0.0.1:8080',\n  // whatever other options\n));\n$client->setIo($curl);\n\nThen I needed to override the client class to load my own class for curl.\n\nYou should be able to do:\n``` php\nclass Google_IO_MyCurl extends Google_IO_Abstract {\n   // ....\n}\n$client = new Google_Client();\n$mycurl = new Google_IO_MyCurl($client);\n$client->setIo($mycurl);\n``\n. :+1: This is how we did it back when we distributed an autoloader with PHPUnit. The autoloader would install to/usr/share/php/PHPUnit/Autoload.php` and you could include it with:\nphp\n require_once 'PHPUnit/Autoload.php';\n. @AdamWill The classmap autoloader generated by composer should work as-is right now. I think the main issue (if I remember correctly) is that composer and its autoloader both require PHP 5.3 and this library is intended to work with PHP 5.2. \n. @AdamWill Oh, sorry. I assumed your last comment was about composer-based installations.\n. Oops, I think this one is my fault. I'll have a fix available shortly.\n. This should be fixed by #425. My apologies for such a simple oversight on my part.\n/ping @ianbarber\n. I think this is a dupe of #246.\n. That method expects the access token to be in a JSON encoded object. From the doc comment:\nphp\n  /**\n   * Set the OAuth 2.0 access token using the string that resulted from calling createAuthUrl()\n   * or Google_Client#getAccessToken().\n   * @param string $accessToken JSON encoded string containing in the following format:\n   * {\"access_token\":\"TOKEN\", \"refresh_token\":\"TOKEN\", \"token_type\":\"Bearer\",\n   *  \"expires_in\":3600, \"id_token\":\"TOKEN\", \"created\":1320790426}\n   */\n  public function setAccessToken($accessToken)\n. Do you have a use case where the current code doesn't work? This seems to work as expected for me:\n``` php\n$service = new Google_Service_Calendar($client);\n$event = $service->events->get('nfl_6_DallasCowboys#sports@group.v.calendar.google.com', '20141205T012500_20141204003');\nprintf(\"Creator: %s\\n\",   $event->getCreator()->getDisplayName());\nprintf(\"Organizer: %s\\n\", $event->getCreator()->getDisplayName());\nprintf(\"Start: %s\\n\",     $event->getStart()->getDateTime());\nprintf(\"End: %s\\n\",       $event->getEnd()->getDateTime());\n```\nPS\u2013I see a few issues with the suggested PR:\n1. The Google_Service_* classes are mostly auto-generated. Generally fixes would need to go into the discovery API.\n2. Google_Service_Calendar_Event::getStart and Google_Service_Calendar_Event::getEnd  are expected to return instances of Google_Service_Calendar_EventDateTime, not a datetime string.\n3. Models that subclass Google_Model already have getter/setter methods for delegating to $modelData. You shouldn't ever need to access $modelData directly.\n. Would you mind providing a more complete example? It's hard to debug without seeing the definition for mime_content_type and without knowing the value of $file_path.\n. Is it possible that your file is either not readable or not a valid png? The code you posted works perfectly for me. If I enter the wrong path or save a non-png file as a png I get the exact same error you got.\n. No problemo.\n. Would you mind providing a more complete example? It's hard to debug without seeing the definition for mime_content_type() and without knowing the value of $file_path.\n. I was only able to reproduce this error with an unreadable $file_path. Otherwise the code worked for me (though I didn't try with a parent id).\n. Should the examples be updated as well? Also, I wonder if the old autoloader should trigger a deprecation warning/notice (maybe E_USER_DEPRECATED for PHP 5.3+).\n. @AdamWill Sorry for the confusion. I wasn't making a comment on the age of the autoloader. In that context \"old\" means \"former.\"\nLong term it probably doesn't make sense for this project to distribute two autoloaders. Even if the former autoloader has only been around for a couple of months, removing it is still a pretty big BC break. The friendly thing to do is deprecate it for a while and then remove it in the next major version release.\n. @AdamWill I was expanding on my previous comment about deprecating the former autoloader. What I was initially suggesting is that we should leave the previous autoloader in its original file and trigger a deprecation error. Something like:\nphp\n<?php\ntrigger_error(\n    'The ... autoloader is deprecated since version X.X and will be removed in X.Y. Please use...', \n    E_USER_DEPRECATED\n);\nrequire_once 'path/to/new/autoloader.php';\n. @AdamWill I am suggesting that moving an autoloader file is a pretty big BC break. It would be friendlier to leave autoload.php in the root project directory with the code from my previous comment. The \"old\" autoloader is /autoload.php and the \"new\" autoloader is /src/Google/autoload.php.\n. Haha, no worries. My apologies for not being clearer from the beginning.\n. Looks much friendlier to me. The only issue I see is that E_USER_DEPRECATED is not available in PHP 5.2. Might be worth falling back to E_USER_WARNING or something similar.\n. Would you mind providing the exact error you are receiving?\n. I think setSlice() expects an array.\nphp\n$request = new Google_Service_QPXExpress_TripOptionsRequest();\n$request->setSolutions(1);\n$request->setPassengers($passenger);\n$request->setSlice(array($slice));\n. > fwiw the composer 'files' thing is kind of a PITA for distributions too \nYeah, this is really just aimed at preventing composer from generating a classmap since we already have an autoloader.\n. Right, but then other projects that list this project as a dependency will have to include both autoloaders.\n. > when using composer src/autoload.php from this project should be ignored.\n@glensc I agree with you. The problem is that many files in this project manually include the non-composer autoloader. You end up with both autoloaders loaded regardless. This suggestion was only aimed at making sure you don't have two autoloaders responsible for the same classes.\n. @glensc FWIW, I also prefer composer's optimized autoloaders. I think I even suggested using a classmap as the default autoloader in a different ticket.\n. @glensc Yeah, I had also considered that solution. My concern was that it could break autoloading for projects that are using composer for some libs, but have used an alternate install method for this lib.\n. Could it be this? https://code.google.com/a/google.com/p/apps-api-issues/issues/detail?id=3684\n. Yeah, I think this is expected behavior. From https://groups.google.com/d/msg/google-calendar-api/r17_Q3kpvVM/_VsGUYPENJ4J:\n\ncolor is right now a private event property [...] You can only see and modify this private property if you have at least write access\n. No problemo :)\n. I'm no expert, but I think this is the intended behavior. It's essentially the same behavior as if you upload an image using the share box without actually sharing it. You can still access the image by URL, but it doesn't show up in any albums.\n\nIn the future, you may want to ask questions like this on stackoverflow. This project doesn't really offer general support via GitHub.\n. Just to be sure, have you tested with var_dump() instead of print_r()? The print_r() function doesn't print a value for false. For instance:\nphp > $test = new stdClass;\nphp > $test->useDefault = false;\nphp > print_r($test);\nstdClass Object\n(\n    [useDefault] => \n)\nphp > var_dump($test);\nobject(stdClass)#1 (1) {\n  [\"useDefault\"]=>\n  bool(false)\n}\n. This is more or less covered by #445.\n. https://github.com/google/google-api-php-client/tree/master/tests\n. I think they use the books API because it's pretty simple and doesn't require much setup. To be fair, they also have examples for the Drive API which is pretty popular. You can also find some examples for the reseller API here: https://github.com/google/enterprise-deployments/tree/master/apps/php\n. I don't think Cloud Print is currently supported (see #132).\n. :+1: Would be happy to help with this!\n. Looks like the unit tests would've caught this. Might make sense to add them to the build process that generates these classes.\n. This library has a file cache that is enabled by default. The base path is configurable, but it defaults to a directory called Google_Client in your systems temporary directory. The weird hash is just an md5 of the file's contents. The e4 directory is just the first two characters in the filename hash so that you don't end up with too many files in one directory.\n. The file it's trying to open is /tmp/Google_Client/e4/e4376171b3c41df2c55e1a689f6386c9. Your system has open_basedir configured to /var/zpanel/hostdata/zadmin/public_html/:/var/zpanel/temp/ which means PHP is only allowed to open files in either the /var/zpanel/hostdata/zadmin/public_html directory or the /var/zpanel/temp directory. So if you want to use the file cache, you will need to make sure it's base dir is in one of those directories.\n. You should be able to configure your cache directory like this:\nphp\n$client = new Google_Client();\n$client->setClassConfig('Google_Cache_File', 'directory', '/var/zpanel/temp/Google_Client');\n. I'm not really familiar with the analytics lib you are using, but I'm guessing you would need to provide it  $client or somehow configure the client it provides.\n. > I'll ask the developer about how to provide his package with the right $client information then, right?\nThat sounds like the best thing to do :)\n. ",
    "Trii": "Is there a script you use to auto generate these classes based off of the discovery doc that you can make part of the repo? That would also resolve this feature without having to depend on another project that hasn't been updated.\n. Thanks! That would solve all of this.\nOn Sep 15, 2014 6:27 PM, \"Ian Barber\" notifications@github.com wrote:\n\nIts the same project as that one - but one running on an internal service\nhere. I will ask whether anyone can update the open source version.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/316#issuecomment-55668768\n.\n. Since we use this here at Kaplan, I can also contribute bugfixes and features as needed. I've signed a CLA from a contribution to https://github.com/GoogleCloudPlatform/endpoints-proto-datastore so I assume it's the same one you need right?\n. Hi @ianbarber would you mind nudging the guys about uploading the latest templates to https://code.google.com/p/google-apis-client-generator/ ? I'm having issues with the global usage of $apiConfig in the older version of Google_Client I am stuck with (0.6) and can't upgrade without upgraded client libs for my service.\n\nI'm using cloud endpoints on two different app engine projects and the baseUrl is set in the global scope so I can never reuse an existing Google_Client once I create an api client pointing to another baseUrl\n. Awesome, thank you very much!\n. Good point. What about ignoring port and forcing it to 0 if the host protocol is unix?\n. Ports should always be numeric so this may be better solved as:\nphp\nif (empty($this->host) || !is_numeric($this->port)) {\n. ",
    "craigiswayne": "For newer versions of the Google API\nnew Google_Service_Analytics( $google_client );. Ran into a similar issue, at the end I had to commit Google's API files  into my plugin to ensure that it's reading the right files... Added a few class exists checks, method checks and exception catches to fix this\nDon't take this the wrong way... but\nat the end of the day, this is not Google's problem... its yours. ",
    "temuri416": "See https://github.com/google/google-api-php-client/issues/860.\n. @caleblloyd Do you mind sharing the working version of batch upload? Does the code in #860 look right to you?\n. @caleblloyd @bshaffer \nWhoa. After moving those lines as described above code from #860 works PERFECT!\nNow... Is that a bug or a feature? What's Google gonna do about it?\n. Thanks, guys.\nSo, for argument's sake, if I tweak Resources.php as described above, would V3 API continue supporting it?\nMy code from #860 works great now.\n. I know, I know.\nThat's not the point. My question is how Google would look at this \"bonus\" feature?\nI can always extend or write my own wrapper. But since this behaviour contradicts the docs - can I count on this or will it get \"fixed\" (i.e. removed)?\n. @caleblloyd \nThat's strange. Because I tried with master and v2.0.0RC5 and it does not work.\nThis however fixed it for me in Resources.php:\n\nI moved the lines you've indicated after it returns with ->shouldDefer().\n. I see what you're saying and you're right.\nI didn't bother checking contents of uploaded files - they're all 0 bytes.\nWhat is the \"correct\" URL that should be set?\n. @bshaffer \nThanks for your response.\nI tried as you suggested and result is exactly the same.\nI'd like to point out the following:\n1. You were looking at V2 reference, while my question was about V3. So, my code is using the right syntax.\n2. Even if I omit 'parents' property, all uploaded files should be placed in account's root folder. Which isn't happening either (with batched uploads).\n3. If I disable batched uploads everything works as expected. V3 documentation does not require changes to the way ->files->create() is called to be compatible with batched uploads.\n4. It does not look like permissions issue, as I'm trying to upload files in the newly created folder (again, it is all fine with sequential upload).\nIt definitely looks like a bug.\nAny other suggestions/ideas?\nCheers!\n. Are you referring to this?\nNote: You cannot use a media upload object in a batch request.\nAre all uploads considered \"media uploads\"?\n. ",
    "dinozombie": "I was thinking about the full text search API for datastore https://cloud.google.com/appengine/docs/python/search/ but since I couldn't find it on the Discovery service now I'm sad. Thanks anyway.\n. ",
    "tomwalder": "Sorry, (very) late reply. If you want to access the Search API from AppEngine, you can do it with this:\nhttps://github.com/tomwalder/php-appengine-search\nIt will not work remotely - it uses the Protocol Buffer access which only works from AppEngine.\nDisclaimer: I am the author.\n. +1\n. Try something like this?\nphp\n$obj_client = new \\Google_Client();\n$obj_client->setAssertionCredentials($obj_client->loadServiceAccountJson(\n      '/path/to/file.json',\n      [\\Google_Service_Datastore::DATASTORE, \\Google_Service_Datastore::USERINFO_EMAIL]\n));\nObviously, you'll need to define the right scopes for your use case.\n. Have you considered using (my) wrapper library. Makes most Datastore operations trivial from PHP.\nIt supports \"putting\" multiple entities of the same Kind at once.\nhttps://github.com/tomwalder/php-gds\n. ",
    "doapp-ryanp": "There is support, just not straight forward in the api doc.  The upload files doc helped. For others that run across this, here is the code:\nphp\n$pub->edits_apks->upload($packageId,$id,array(\n            'uploadType'=>'media',\n            'data'=>file_get_contents($localApkPath)\n        ));\n. @joshuatam I'm guessing the newer versions of the SDK dont allow this. My post was from 2014.. ",
    "benaduggan": "Is there a way to feed the apk to the client in a stream? \ndoing a \"file_get_contents($localApkPath)\" can get hairy if we're talking apps that could easily be several hundred mbs.\n. ",
    "joshuatam": "Hi @doapp-ryanp it is not working\njson\n{ \"error\": { \"errors\": [ { \"domain\": \"androidpublisher\", \"reason\": \"editNotFound\", \"message\": \"Edit not found for this application.\" } ], \"code\": 404, \"message\": \"Edit not found for this application.\" } }. @doapp-ryanp I finally get it working, the reason for the error is that the editid supplied is wrong.. ",
    "long1eu": "Hi @joshuatam ! Where can I get the editId?. ",
    "Christophe235": "To get the editID, you have to make a http request like this:\nhttps://developers.google.com/android-publisher/api-ref/edits/insert\n@long1eu  . ",
    "DanezBs": "solved : \nNote: some features (service accounts and id token verification) require PHP 5.3.0 and above due to cryptographic algorithm requirements.\n. ",
    "isaacbacon1": "Ok, thank you. I will find another library to do what i need to do.\n. ",
    "xow": "Whoops read the license wrong, long day\n. ",
    "TheLonelyGhost": "Fyi, this would break compatibility with PHP5.2.x and require 5.3+\n. Shoot, I stand corrected. Perhaps I confused the concept of autoloading in PHP with the composer's specific implementation, which involves namespaces and therefore requires PHP5.3+. Carry on.\n. ",
    "dParadiz": "Can't you just remove all require statements for the code.\n. ",
    "eibt": "Done \ud83d\udc4d, signed \"Ivan Barrios\"\n. ",
    "peetersdiet": "@edgeprod @ianbarber I didn't find time last week for a PR. And I was also a bit reluctant to submit a CLA for such a trivial, small codechange.\nGood to see it's fixed. Happy to report it. \n. ",
    "abusalam": "Issue #352\n. If it worth rethrowing i may send PR, however it is very rare issue, I have found it because my webserver has no access to google.\nHOP_BY_HOP is there since first commit, there is no trace of it in the diffs of commit history,\n. ",
    "buley": "The documentation suggests that this is how you can delegate authority to a service account to be able to access a Gmail user for Google Apps for Work: https://developers.google.com/admin-sdk/directory/v1/guides/delegation#delegate_domain-wide_authority_to_your_service_account\nHowever, in practice the Gmail API does not seem to support service accounts http://stackoverflow.com/q/24550256/317937\n. Thanks to whomever reported this issue. I just copypasta'd the Analytics Hello World and found myself in similar situations. Path forward was laid out for me in @ShelterJames's link: \nhttps://github.com/google/google-api-php-client/blob/master/UPGRADING.md#google_auth_assertioncredentials-has-been-removed\nAnyways, commenting to say that I've been working with this lib for a few years. While the auth tweaks are minimal, I'm finding that the interface has been tremendously simplified for service accounts. This is a welcome change. Thank you @google team.\n. ",
    "murgatroid99": "I was talking about $this->io in the authenticatedRequest method. $this->io does not exist, so that method will always fail with a fatal error. This seems to imply that nobody uses this class.\n. ",
    "lostick": "Cheers for the heads up! I have submitted my CLA.\nRegarding the SSL version, setting it to 1 will indeed pick TLSv1.\n. ",
    "jeremyFreeAgent": "Ok thanks @ianbarber I'll do that. Actually the library do not use the composer autoload. I want to clean all that by removing all the require statement. That PR was a first move but I can go more deeply.\n. Still WIP.\n. ",
    "mayeco": "Thanks @jeremyFreeAgent \n. :+1: \n. ",
    "iankberry": "Looks like someone else just beat me to this in commit 5ae124c. Feel free to close this.\n. ",
    "michaelbausor": "This class no longer exists. cc @bshaffer . The original issue seems to be resolved. If there are still outstanding issues, please file a new bug.. @teddyfran The previous post seems to give a resolution to the \"Unauthorized client or scope in request.\" error described in the original post. Your error seems different, and better tracked by https://github.com/google/google-api-php-client/issues/1142 Is that correct?. This doesn't seem like the right repo for this question. If you are still having problems please reopen and clarify the problem.. We recommend you start using the BigQuery library here: https://github.com/GoogleCloudPlatform/google-cloud-php. Resolved. Duplicate of https://github.com/google/google-api-php-client/issues/1097. Resolved - we are not doing this across languages. LGTM. I am not sure what behaviour we want here in the case that the $crypto_strong parameter comes back false. Should we emit a warning? It seems wrong to fail completely, as that is not a great experience for users trying to test out the example code on their local machine.. ",
    "Alex-1966": "\nThis may be a question that has to go to the cloud team rather than being a library issue,\n\ndon't know, but i noticed there is a problem with the memcache'd access tokens in AppIdentityService or  Google_Auth_AppIdentity. Both classes do not check the expiration_time of the token, that comes back from memcache. memcache seems not deleting every of those expired tokens.\nActually i did a workaround in my auth-script, if the token is expired i delete the tokens in memcache und do a new auth, since there is no refreshToken in Google_Auth_AppIdentity, i.e.:\n.....\n$token = $auth->authenticateForScope(DRIVE_SCOPE);\nif (!$token) {\n die(\"Could not authenticate to AppIdentity service\");\n}\nif( $token[\"expiration_time\"] < $act_time ){ \n    $memcache = new \\Memcache();\n    $memcache_key = \"Google_Auth_AppIdentity::\".DRIVE_SCOPE;\n    $memcache->delete($memcache_key);\n    $memcache_key = \"ah_app_identity:\".DRIVE_SCOPE;\n    $memcache->delete($memcache_key);\n    $auth = new Google_Auth_AppIdentity($client);\n    $token = $auth->authenticateForScope(DRIVE_SCOPE);\n       // finally i get a fresh, valid token\n}\n. ",
    "vlajos": "I have signed it already.\n. ",
    "lubberscorrado": "Well , i must admit that it is now working even  without that change. But at that time it was driving me mad because google always sent back the content in binary format. Anyway it was witthin that code:\n$plus = new Google_Service_Plus($client);\n    $user_profile = $plus->people->get('me');\n. i still/again have that problem and used the most recent commit. i implemented the patch to make it work again\n. ",
    "hidehide55": "For tuning.\nI want to reduce response payload size. I want to try it and check for performance.\nDefault, response JSON contain \\n and indent white spaces.\nIf I set prettyPrint false, response JSON not contain those.\nThanks.\n. ",
    "scholtz": "it did throw a PHP warning when updated from the older version of google api php client\n. ",
    "haimat": "I understand that it doesn't work for you with a random string, that doesn't work for me either. But I am quite surprised that my code example also doesn't work for you. Maybe I really do miss an important step? I can post more of my code, but the example above is basically all I am doing.\n. Ok, so I did some more research on this issue. The code that I get from Google has the following format:\n4/JpnXiNfJMsElcCN1S3lj-k_vufPzNAvrMLLHV_8zPY8.4llVaowOQ7kQYFZr95uygvVjvxmpkwI\nNote the . character in the string. I experimented a bit with this code. It turned out that I can modify or even remove the whole part after this dot in the string. In every such case the call to authenticate() succeeds.\nHowever, as soon as I change only one character in the code part before the dot in the string, the authenticate() fails as it should.\nIs this second part of the code not relevant for authentication?\n. ",
    "ShivarajRH": "How can handle 'invalid_grant: Code was already redeemed.' error, same way access token expire error we use $client->isAccessTokenExpired()...?\n. ",
    "povtasci": "Hey guys.\ni have code like this \n$client = new Google_Client();\n$client->setApplicationName('App Name');\n$client->setClientId($this->config->getValueByKey(\"GPConnect:clientId\"));\n$client->setClientSecret($this->config->getValueByKey(\"GPConnect:clientSecret\"));\n$client->setRedirectUri($this->config->getValueByKey(\"GPConnect:redirectUri\"));\n$client->setDeveloperKey($this->config->getValueByKey(\"GPConnect:developerKey\"));\n$client->setScopes(array(\n        \"https://www.googleapis.com/auth/plus.login\",\n        \"https://www.googleapis.com/auth/plus.profile.emails.read\",\n));\n$plus = new Google_PlusService($client);\nif (isset($_GET['code'])) {\n    $client->authenticate();\nand get the Error fetching OAuth2 access token, message: 'invalid_grant, Code was already redeemed.' error. \ncan you please help me with this issue ?\nwhere can be the problem ?\n. ",
    "ZoRDoK": "Similar problem\n. ",
    "PrafullaKumarSahu": "Any luck ?\n. It is already same in my case still I am facing the same problem. I think there is some problem with getting refresh token \nif (!isset($_SESSION['access_token'])) {\n        //$client->authenticate($_GET['code']);\n        $client->authenticate($this->options['authenication_code']);\n        $accessToken = $client->getAccessToken();\n        $refreshToken = $client->getRefreshToken();\n        //var_dump($refreshToken);\n        $_SESSION['access_token'] = $refreshToken ? $refreshToken : $accessToken;\n    }\n. @champsupertramp You  have to store the refresh to ken you are getting in your first authentication and reuse that to generate accesssToken later.\nI have posted multiple questions and answers on stackoverflow after spending some months working on google client api .(analytics).\nMay be some are useful for you.\ncheck comments :- http://stackoverflow.com/questions/33754177/google-analytics-custom-plugin-getting-error-invalid-grant\n. @champsupertramp  my best wishes to you .\n. ",
    "champsupertramp": "I'm having similar issues.\nGoogle Authenticate Exception: Error fetching OAuth2 access token, message: 'invalid_grant: Code was already redeemed.'\nPHP code after granted permission:\n``` PHP\n$client = new Google_Client();\n            $client->setAccessType('offline');\n            $client->setClientId($this->client_id);\n            $client->setClientSecret($this->client_secret);\n            $client->setRedirectUri($this->redirect_uri);\n            $client->setScopes(array(\n                    \"https://www.googleapis.com/auth/plus.login\",\n                    \"https://www.googleapis.com/auth/plus.profile.emails.read\",\n            ));\n        try{\n\n                if( isset( $_REQUEST['code'] ) && ! empty( $_REQUEST['code'] ) ){\n                        $client->authenticate(  $_REQUEST['code']);\n                        $gtoken = $client->getAccessToken();\n                        $_SESSION['gplus_token'] = $gtoken;\n                }\n\n                try{\n                    $service = new Google_Service_Oauth2($client);\n                    $profile = $service->userinfo->get();\n                }catch(Google_Service_Exception $e){\n                    die( 'UM Social Login - Google Service Exception: '.$e->getMessage().'<br/> Redirect URI: '.$this->redirect_uri,'UM Social Login - Google Error' );\n                }\n\n        } catch (Google_Auth_Exception $e) {\n                die( 'UM Social Login - Google Authenticate Exception: '.$e->getMessage().'<br/> Redirect URI: '.$this->redirect_uri,'UM Social Login - Google Error' );\n        }\n\n```\n. @PrafullaKumarSahu  Thanks a lot! I'm checking those links now. \n. ",
    "Skysplit": "+1 for this\nit would be nice to have docs like theese (src/Google/Service/Drive.php):\nphp\n/**\n * @var Google_Service_Drive_About_Resource\n */\npublic $about;\n/**\n * @var Google_Service_Drive_Apps_Resource\n */\npublic $apps;\n/**\n * @var Google_Service_Drive_Changes_Resource\n */\npublic $changes;\n/**\n * @var Google_Service_Drive_Changes_Resource\n */\npublic $channels;\n/**\n * @var Google_Service_Drive_Children_Resource\n */\npublic $children;\n/**\n * @var Google_Service_Drive_Comments_Resource\n */\npublic $comments;\n/**\n * @var Google_Service_Drive_Files_Resource\n */\npublic $files;\n/**\n * @var Google_Service_Drive_Parents_Resource\n */\npublic $parents;\n/**\n * @var Google_Service_Drive_Permissions_Resource\n */\npublic $permissions;\n/**\n * @var Google_Service_Drive_Properties_Resource\n */\npublic $properties;\n/**\n * @var Google_Service_Drive_Realtime_Resource\n */\npublic $realtime;\n/**\n * @var Google_Service_Drive_Replies_Resource\n */\npublic $replies;\n/**\n * @var Google_Service_Drive_Revisions_Resource\n */\npublic $revisions;\nThis would make API much easier to use with IDE's\n. Thanks ;) I missed that issue while searching, though I think they're pretty much connected, as phpdoc is the source of autocompletion for IDE.\n. ",
    "fireproofsocks": "+1.  Trying to figure out how to translate the methods defined in https://developers.google.com/google-apps/calendar/v3/reference/ into useable code is unnecessarily arduous. \n. Yep, did that before I posted: http://cl.ly/image/2l083z0D451O\nTo review, that JSON file has the following keys it its hash:\n- private_key_id\n- private_key\n- client_email\n- client_id\n- type\nThe source code in src/Google/Client.php looks for the following:\n- installed (or web)\n- client_id\n- client_secret\n- redirect_uris\nHowever, going through this a THIRD time popped open a different screen: http://cl.ly/463l3J1T0J2U but there was an error that flickered in there, and the JSON that got generated had the same keys as the first 2 attempts (i.e. the incorrect ones).\nSo I repeat my frustrated grumblings here: the docs do not represent what's available in the dashboard. What am I missing here?\n. I'd be satisfied if the documentation were adequate and/or usable.  It's staggering to me that Google's service SDK's are so bloody hard to convert to working examples.  If \"Documentation Driven Development\" isn't a thing, perhaps it should be. (Continued grumble...)\n. ",
    "three3211": "+1\n. ",
    "theofidry": "+1\n. +1 I'm amazed to see that this library has been coded to be compatible in PHP5.2. The upgrade in PHP5.3 would be a very good move since as mention @atrauzzi it will enable the use of namespaces!\nI'm a bit surprised that the requirements are so low: when you take a look at Symfony2 they don't bother below PHP5.3 and for Symfony3 are talking about using PHP5.5 as a minimal version. Same for Zend 3. Since the two biggest PHP framework are making the move why not Google? The of lower version of PHP seem so marginal or dropping so fast, it would make sense. Worse case the current version could be kept but not developed anymore.\n. ",
    "touhonoob": "+1\n. ",
    "dant89": "+1\n. ",
    "jeckel": "+1\n. ",
    "reecube": "+1. ",
    "doodoori2": "\ud83d\udc4d \nIt will be very helpful for IDE type hint. \n\n. ",
    "xsimo": "+1. ",
    "mattwhisenhunt": "These are now available at developers.google.com/resources/api-libraries/documentation/API_NAME/API_VERSION/php/latest/\nFor example: https://developers.google.com/resources/api-libraries/documentation/ml/v1/php/latest/. This is (now?) possible it is just poorly documented. #1140 is tracking it as a docs issue.. Fixed in https://github.com/googleapis/google-api-php-client-services/pull/132/commits/f59a178b5441dd170c943aed56afd8748b90734a. Thank you for filing this issue. We asked some clarifying questions a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to re-open this issue with more information.. This issue may no longer be relevant due to its age. Feel free to re-open.. This issue may no longer be relevant due to its age. Feel free to re-open.. It looks like a member of our great community answered your questions. Thanks Community! Please feel free to reopen if you have any more questions.. It looks like a member of our great community answered your questions. Thanks Community! Please feel free to reopen if you have any more questions.. Thank you for filing this issue. We asked some clarifying questions a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to re-open this issue with more information.. I think those methods are still in the client library even though they have been removed from the latest version of the API itself: https://developers.google.com/blogger/docs/3.0/reference/\nWere you able to find a different solution?. This issue will be addressed by a fix to google/google-api-php-client-services#44.. This issue may no longer be relevant due to its age. Feel free to re-open.. Don't modify, inherit!\nphp\nclass Reseller_Sandbox_Service extends Google_Service_Reseller {\n    public function __construct(Google_Client $client)\n    {\n        parent::__construct($client);\n        $this->servicePath = 'apps/reseller/v1sandbox/';\n    }\n}. This issue may no longer be relevant due to its age. Feel free to re-open.. Thanks for the heads up. Looks like the correct link is https://github.com/google/google-api-php-client-services/blob/master/src/Google/Service/Kgsearch.php. @vikasmalhotra08, are you still searching to a solution to this issue?. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. This issue may no longer be relevant due to its age. If that is not the case let us know and we will re-open.. This issue may no longer be relevant due to its age. Feel free to re-open.. @josedsilva Are you still looking for a solution to this issue?. It looks like a member of our great community answered your questions. Thanks Community! Please add a comment if you have any more questions and we can reopen this issue.. Thank you for your feature request. This client library is currently in maintenance mode. We are fixing necessary bugs and adding essential features to ensure this library continues to meet your needs for accessing Google APIs. After careful consideration, we have decided not to proceed with this enhancement. If you disagree, please feel free to re-open this issue and explain why you believe it is essential for users of this client library.. This issue may no longer be relevant due to its age. Feel free to re-open.. @DavidAnderson684, are you using the v1 branch? What is your fix in your code base?. Let's close this for now and reopen if anyone asks for help with v1. . @aaronlague, did you clear up this issue you are having?. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. Thank you for filing this issue. We asked some clarifying questions a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to re-open this issue with more information.. Can you reproduce this issue in API Explorer or Try This API?. @chiragvels is this something you are still trying to track down?. This issue may no longer be relevant due to its age. Feel free to re-open.. This issue may no longer be relevant due to its age. Feel free to re-open.. It looks like a member of our great community answered your questions. Thanks Community! Please feel free to reopen if you have any more questions.. You probably want to start using the People API.. This issue may no longer be relevant due to its age. Feel free to re-open.. I would go with the StackOverflow answer. What a great resource.. Thank you for filing this issue.\nPlease feel free to comment with more information and we will re-open this issue.. This issue may no longer be relevant due to its age. Feel free to re-open.. Thank you for your bug report. This client library is currently in maintenance mode. We are fixing necessary bugs and adding essential features to ensure this library continues to meet your needs for accessing Google APIs. After careful consideration, we have decided not to fix this bug since there is an acceptable work-around. If you disagree, please feel free to re-open this issue and explain why you believe fixing it is essential for users of this client library.. You may want to start with some example code from a different API just to get the OAuth2 part working: https://developers.google.com/gmail/api/quickstart/php. Thank you for filing this issue. We offered some guidance a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. Did you get this working yet?. Thank you for filing this issue. We asked some clarifying questions a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. So it has methods from Model (parent class) but not members and methods of the derived Google_Service_Analytics_McfDataRows?. Thank you for filing this issue. We asked some clarifying questions a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. Thank you for filing this issue. We asked some clarifying questions a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to re-open this issue with more information.. @PsychodelEKS Is this still an issue for you? I still haven't looked at the v1 branch at all.. This issue may no longer be relevant due to its age. If that is not the case let us know and we will re-open.. This issue may no longer be relevant due to its age. If that is not the case let us know and we will re-open.. This issue may no longer be relevant due to its age. If that is not the case let us know and we will re-open.. It looks like the Google+ API doesn't support that anymore.. The APIs are changing all the time to reflect those changes the autogenerated client-services are regenerated.\nDid this behavior start after a composer update?. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. Thank you for your feature request. This client library is currently in maintenance mode. We are fixing necessary bugs and adding essential features to ensure this library continues to meet your needs for accessing Google APIs. After careful consideration, we have decided not to proceed with this enhancement. If you disagree, please feel free to re-open this issue and explain why you believe it is essential for users of this client library.. Duplicate of #1172. It looks like a member of our great community answered your questions. Thanks Community! Please feel free to reopen if you have any more questions.. This issue may no longer be relevant due to its age. If that is not the case let us know and we will re-open.. This issue may no longer be relevant due to its age. Feel free to re-open.. It looks like a member of our great community answered your questions. Thanks Community! Please feel free to reopen if you have any more questions.. It looks like a member of our great community answered your questions. Thanks Community! Please feel free to reopen if you have any more questions.. I haven't been able to reproduce this. Please let me know if you find a reliable way to.. So it sounds like you got it working?. vendor/google/apiclient-services. This issue may no longer be relevant due to its age. Feel free to re-open.. That is a great question. Here is the quickest way I have found to set headers:\nphp\n$client->setDefer(true);\n$request = $youtube->playlists->listPlaylists('snippet', array('id' => '6KzzScZSUrs'));\n$request = $request->withHeader(\"If-None-Match\", \"\\\"$etag\\\");\n$results = $client->execute($request);. This issue may no longer be relevant due to its age. Feel free to re-open.\nPS Please see the new Sheets API.. Thank you for your feature request. This client library is currently in maintenance mode. We are fixing necessary bugs and adding essential features to ensure this library continues to meet your needs for accessing Google APIs. After careful consideration, we have decided not to proceed with this enhancement. If you disagree, please feel free to re-open this issue and explain why you believe it is essential for users of this client library.. It looks like a member of our great community answered your questions. Thanks Community! Please feel free to reopen if you have any more questions.. You may want to use API Explorer to poke around and find all the required fields. It sounds like you need to include currency in an update query.. Thank you for filing this issue. We suggested some course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. Maybe just attach a gist instead.. Thank you for filing this issue. We asked some clarifying questions a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. I am going to close this but it should still be searchable.. Please include the error you are receiving. . Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. I wasn't able to reproduce this result. Please include a bit longer code snippet.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. @waleedmazhar have you experienced this problem since 2.1.3 and the inclusion of requestSyncToken in optParams?. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. If anyone in this issue is still experiencing problems. Let me know and I will reopen this immediately.. This issue is not related to this client library at all.\nAs @net-tools says, you could use this library on a PHP server to download the files there and then give out the link to that server.\nI think Google Drive API is designed to not have direct links but I know very little about that particular API.. I don't understand your question 'Are there any claims that are mandatory?' if v1 is still working for you I would stick with that for as long as possible.\nIs Google_Signer_P12 the only breaking change keeping you from moving to v2?. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. This issue may no longer be relevant due to its age. If that is not the case let us know and we will re-open.. It looks like a member of our great community answered your questions. Thanks Community! Please feel free to reopen if you have any more questions.. It looks like a member of our great community answered your questions. Thanks Community! Please add a comment if you have any more questions and we can reopen this issue.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. This issue may no longer be relevant due to its age. If that is not the case let us know and we will re-open.. It looks like they are hardcoded: https://github.com/google/google-api-php-client/blob/a68d080658241cd059cd3434c55193630197f47f/src/Google/Client.php#L947. Thank you for your bug report. This client library is currently in maintenance mode. We are fixing necessary bugs and adding essential features to ensure this library continues to meet your needs for accessing Google APIs. After careful consideration, we have decided not to fix this bug since there is an acceptable work-around. If you disagree, please feel free explain why you believe fixing it is essential for users of this client library.. Check out https://github.com/GoogleCloudPlatform/google-cloud-php to access this Google Cloud API. . It may be a minimum limit. Have you tested this on API Explorer?. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. Looks like this have been fixed.. Duplicate of #692. @spydev it looks like someone from our great community answered your question. Thanks Community! Please reopen if you still have questions.\n@KyleWiering Thanks for the suggestion. I think the message itself comes from the API, I think the library docs could use a note about our extensive use of exceptions. Thanks!. @induraniv @Wakodebe @garciacarmonaam @luispinonferrer-capgemini \nGoogle_Client is located in src/Google/Client.php of the package archive.\nThe error 'Fatal error: Class 'Google_Client' not found' indicates that Client.php was not included/required explicitly or automatically. That is typically due to a line like\nphp\ninclude_once __DIR__ . '/../vendor/autoload.php';\nnot resolving to the correct location (in the package archive: vendor/autoload.php). The path of autoload is relative any file with this line so make sure to account for that if you paste this line into other files.. This issue may no longer be relevant due to its age. If that is not the case let us know and we will re-open.\nI will just add that I have gotten a lot benefit out of using mitmproxy or Charles to track down these Invalid JSON payload errors.. Thank you for filing this issue. Some clarifying questions were asked a week or more ago and never answered. We are unable to proceed with this issue until then, so we are closing it. Please feel free to re-open this issue with more information.. It sounds like you got a valid Invalid Value message. You may want to dig into the API reference and find out why it doesn't like those characters. . Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. What service are you accessing?. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. I found this page. For more/better help with this PHP api-client I am going to need more details about the error or obstacle you are running into.. I agree and going forward working samples in even more languages for even more APIs should be available, they are already starting to emerge for some APIs. Because this client library is in maintenance mode, back-filling examples for every API is too low priority.\nA short term workaround for you might be using a different API's PHP example (for some working OAuth code) and the Python example as a kind of mash up starting point. . It looks like a member of our great community answered your questions. Thanks Community! Please add a comment if you have any more questions and we can reopen this issue.. Duplicate of #36760655, #36761485. Are you receiving an error? Please include steps to reproduce.. Thank you for filing this issue. We asked some clarifying questions a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. This issue may no longer be relevant due to its age. If that is not the case let us know and we will re-open.. Our releases come with all the dependencies and an autoload script.. Thank you for filing this issue. We didn't see any follow up in over a week so we are closing it. Please feel free to re-open this issue with more information.. @cruz93 It looks like you are using a different library: https://github.com/googleads/googleads-php-lib did you find help?\n@nikky-kajavadara Have you found a solution yet? If not be sure to include some more context around what part of google-api-php-client you are using.. Thank you for filing this issue. We asked some clarifying questions a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to re-open this issue with more information.. @beatscode My Business does not use service accounts as far as I know.\n@Grummfy Have you seen https://github.com/google/google-api-php-client/issues/801#issuecomment-171417538? It is pretty thorough walk-through of getting going with service accounts.. This issue may no longer be relevant due to its age. If that is not the case let us know and we will re-open.. Should do. Are you running into any problems?. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. For Datastore please use https://github.com/GoogleCloudPlatform/google-cloud-php. Did you call $client->authorize() after you set its configuration?. Looks like the API defines it as string:\nhttps://analyticsreporting.googleapis.com/$discovery/rest?version=v4\nhttps://developers.google.com/analytics/devguides/reporting/core/v4/rest/v4/reports/batchGet#reportrequest. After looking through our API docs I came to the same conclusion as this Stack Overflow answer: Use either the Google Drive or Picasa APIs to upload and then link to that image in a Google+ comment.. I am not on the GMail team but I think that is by design. Some labels you can't change.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. Is it working from API Explorer?. Thank you for filing this issue. We asked some clarifying questions a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to re-open this issue with more information.. @robyone67 sorry for the delay on this one. Did you try downgrading to resolve this issue?. This issue may no longer be relevant due to its age. If that is not the case let us know and we will re-open.. @oxycoder You might be better served by opening a new issue and explaining you problem in greater detail. Include a code snippet of broken code and what you expect its behavior should be. It also helps to know what API you are trying to access.. This thread seems resolved. If anyone is still having problems let's address them in a new issue.. It sounds like you might want to recompile PHP.\nIn a slightly unrelated note have you seen the new Google Cloud libraries.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. Looks like your question was answered by helpful community members. Thanks community! Please feel free re-open if I misread the thread.. We publish a NodeJS API client as well, check out https://github.com/google/google-api-nodejs-client/. Other than that I would need to ask for you for more context to be able to answer your question.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. It looks like the original issue here has been resolved.\nThanks everybody for the ad blocker tips. It seems that people are landing here and finding it helpful.. Just to add to what @net-tools said, it looks like you are looking for the Content-Disposition header:\nhttps://stackoverflow.com/a/3102276\n. I am not sure what you need the API for at all then. Upload a file, click on Get sharable link (chain icon in top right). You're done. . It doesn't sound like your problem fits a intended use case of Google Drive. Happily, there is an upgrade. Please check out https://cloud.google.com/storage/ to get all the bells and whistles!. Thank you for filing this issue. We asked some clarifying questions a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to re-open this issue with more information.. Looks like your question was answered by helpful community members. Thanks community! Please feel free re-open if I misread the thread.. Looks like your question was answered by helpful community members. Thanks community! Please feel free re-open if I misread the thread.. @alexgheorghiu What API is returning a completely empty response?. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a few days ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. It looks like a member of our great community answered your questions. Thanks Community! Please add a comment if you have any more questions and we can reopen this issue.. Looks like your question was answered by helpful community members. Thanks community! Please feel free re-open if I misread the thread.. It looks like you need at least one other sheet in the document before you delete your desired sheet.. Thank you for filing this issue. We didn't see any follow up in over a week so we are closing it. Please feel free to re-open this issue with more information.. What API are you working with?. Thank you for filing this issue. We asked some clarifying questions a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to re-open this issue with more information.. This might be what you are looking for:\n\nA scope for a metric defines the level at which that metric is defined - PRODUCT, HIT, SESSION, or USER. Metric values can also be reported at scopes greater than its primary scope. E.g., ga:pageviews and ga:transactions can be reported at SESSION and USER level by just adding them up for each hit that occurs in those sessions or for those users.\n\nhttps://developers.google.com/analytics/devguides/reporting/core/v4/rest/v4/reports/batchGet. Great. Holler if you need anything else.. Are you using the PHP library from https://developers.google.com/my-business/samples/?. Thank you for filing this issue. We asked some clarifying questions a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to re-open this issue with more information.. Here is what I finally got working:\n```php\ntry {\n    $tl = new Google_Service_Tasks_TaskList();\n    $tl->setTitle(\"A new list\");\n    $tasklist = $service->tasklists->insert($tl);\n} catch(Google_Service_Exception $e){\n    echo $e->getMessage() . \"\\n\";\n}\n```\nLooks like some examples need to be updated. I got my bad example from https://developers.google.com/google-apps/tasks/v1/reference/tasklists/insert. Did you notice any other pages that need updating?. @Avtonom, it looks like you were making yourself a ticket and got the wrong repo.. I think I understand your request now. For now use the PHP library available at https://developers.google.com/my-business/samples/.. You need to pass in $token (the whole array) ie: refreshToken($token).. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. Hi @mvcmaker, sorry it has taken be so long to circle back around to this one.\nId Tokens are typically involved when you want to use Google Sign-In or more generally Google's OAuth 2.0 just for authentication but have your own resources you want to manage authorization to.\nSo verifyIdToken is something you will only want to do as often as say 'Sign-up' or 'Lost Password' just to make sure they are who they say they are and get some basic info about them.\nAm I guessing your use case right or are there other Google APIs you are integrating into your app?. It sounds like where you want to start is  https://developers.google.com/identity/protocols/OAuth2WebServer and multi-api.php. Up until now you have been experimenting with a related feature called OpenID Connect which is only the authentication bit of authentication/authorization.\nI pointed you to the multi-api example because it sounds like you might want to use more than just Google Plus in the future.. $client->setAccessType('offline');. Sorry I must have been looking at the other issue you had opened and I had been poring of idtoken.php. You definitely want that line.\n\naccess_type\nRecommended. Indicates whether your application can refresh access tokens when the user is not present at the browser. Valid parameter values are\u00a0online, which is the default value, andoffline.\nSet the value to\u00a0offline\u00a0if your application needs to refresh access tokens when the user is not present at the browser. This is the method of refreshing access tokens described later in this document.\nThis value instructs the Google authorization server to return a refresh token\u00a0and\u00a0an access token the first time that your application exchanges an authorization code for tokens.\u00a0To set this value in PHP, call the\u00a0setAccessType\u00a0function:$client->setAccessType('offline');\nRefreshing an access token (offline access)\nAccess tokens periodically expire. You can refresh an access token without prompting the user for permission (including when the user is not present) if you requested offline access to the scopes associated with the token.\nIf you use a Google API Client Library, the client object refreshes the access token as needed as long as you configure that object for offline access.\nIf you are not using a client library, you need to set the access_type HTTP query parameter to offline when redirecting the user to Google's OAuth 2.0 server. In that case, Google's authorization server returns a refresh token when you exchange an authorization code for an access token. Then, if the access token expires (or at any other time), you can use a refresh token to obtain a new access token.\nRequesting offline access is a requirement for any application that needs to access a Google API when the user is not present. For example, an app that performs backup services or executes actions at predetermined times needs to be able to refresh its access token when the user is not present. The default style of access is called online.\nServer-side web applications, installed applications, and devices all obtain refresh tokens during the authorization process.\n\nhttps://developers.google.com/identity/protocols/OAuth2WebServer#offline. That is correct.. You should be able to use the fields parameter to get a smaller result back.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. Thanks for the heads up. We will get that changed ASAP.. I will dig into it over in client-services.. Sorry for the delay. Are you still experiencing this issue?. This issue may no longer be relevant due to its age. If that is not the case let us know and we will re-open.. What method is being called to raise that exception?. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. I'm going to need more information to be able to help you:\nDid you start from one of the sample projects provided by Google?\nAre you using an OAuth 2.0 client credential?\n. Thank you for filing this issue. We asked some clarifying questions a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. It looks like there are only batch get methods: https://developers.google.com/people/api/rest/.. Looks like you might want to use a different API, Contacts: https://developers.google.com/google-apps/contacts/v3/#batch_operations. Looks like this one is answered! Please do let us know if you run into any more problems.. Thank you for your feature request. This client library is currently in maintenance mode. We are fixing necessary bugs and adding essential features to ensure this library continues to meet your needs for accessing Google APIs. After careful consideration, we have decided not to proceed with this enhancement. If you disagree, please feel free to re-open this issue and explain why you believe it is essential for users of this client library.. It looks like a member of our great community answered your questions. Thanks Community! Please add a comment if you have any more questions and we can reopen this issue.. It looks like this is being answered on SO.. Thank you for your feature request. This client library is currently in maintenance mode. We are fixing necessary bugs and adding essential features to ensure this library continues to meet your needs for accessing Google APIs. After careful consideration, we have decided not to proceed with this enhancement. If you disagree, please feel free to re-open this issue and explain why you believe it is essential for users of this client library.. Thank you for your bug report. This client library is currently in maintenance mode. We are fixing necessary bugs and adding essential features to ensure this library continues to meet your needs for accessing Google APIs. After careful consideration, we have decided not to fix this bug since there is an acceptable work-around. If you disagree, please feel free explain why you believe fixing it is essential for users of this client library.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. I can't find anything related to this in the API docs either.\nThis PHP client can only perform queries the API library provides. It looks to me like you are going to have to perform multiple requests.\n. Thank you for filing this issue. We didn't see any follow up in over a week so we are closing it. Please feel free to re-open this issue with more information.. Are you trying to use a specific API or use Google OAuth for something else? For the most part I use this project with an API service, for example [Gmail].(https://developers.google.com/gmail/api/quickstart/php). @centurianii glad to hear you found a solution that works for you. Give us a holler if you need anything else.. Great point. In fact, my hope is that we can leave Github issues for detailed bug reports with steps to reproduce and start asking and answering usage questions on StackOverflow, too. #google-api-php-client. I don't think that is something we are going to support.. First two things off the top of my head:\nCan you create a working request in API Explorer: https://developers.google.com/apis-explorer/#search/dfareporting/dfareporting/v2.8/dfareporting.reports.files.get?\nAnd in the included Google/Service/Dfareporting.php file is the servicePath the latest version:\nphp\n$this->servicePath = 'dfareporting/v2.8/;'. Thank you for filing this issue. We asked some clarifying questions a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to re-open this issue with more information.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. @brainslcdevshop could you try reproducing this in API Explorer.. This kinda sounds like a server-side API issue. If that is not the case let we can re-open this.. You probably have a slight skew between the clock on the server that mints the tokens and the clock on the server that's validating the token - if the iat or nbf is in the future, then the token isn't yet valid.\nOne solution would be to use a small leeway, like this:\nphp\nJWT::$leeway = 5; // Allows a 5 second tolerance on timing checks. Duplicate of #1172. Are you inserting an event or updating one?\nDo you get an error response? If not, try including reminders in fields so they come back in the response and please include that.\nMore generally, please include as much as information as you can to help us reproduce your result.. Sorry this slipped through the cracks. Fields is a request field that specifies which fields to include in a partial response.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. There is an open issue in the services repo that will address this issue. https://github.com/google/google-api-php-client-services/issues/44. It looks like the latest release does not have a release package. I am looking into that and in the mean time the non-composer work around is to download the source zip from 2.2.1 and google-api-php-client-2.2.0.zip from the previous release and copy the latter's vendor directory into your 2.2.1 directory tree.. Duplicate of #1344. @immyemperor good point, what issue did you want me to look at it.\n@jshrek I tried reproducing your problem and got a similar error response (Login Required).\nI suspect you would have more luck with one of the Service classes:\nphp\n$youtube = new Google_Service_YouTube(getClient());\ntry {\n  $broadcastsResponse = $youtube->liveBroadcasts->listLiveBroadcasts(...);\n  foreach ($broadcastsResponse['items'] as $broadcastItem) {\n    echo $broadcastItem . \"\\n\";\n  }\n} catch(Google_Service_Exception $e) {\n    echo $e->getMessage() . \"\\n\";\n}\n. Thank you for filing this issue. We asked some clarifying questions or suggested some course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. @immyemperor, you can definitely use server side Java if you prefer that: https://github.com/google/google-api-Java-client. As is it, you have not provided enough detail about the PHP errors you are receiving to enable me to give you meaningful answers.. Thank you for filing this issue. It looks like this is actually a feature request for the YouTube Data API. \nIf you believe that part of this issue still needs to be addressed in this client library, then feel free to re-open this issue with more information.\n. Google_Service_People_Person::getBirthdays. Sending a couple of samples requests thru the API Explorer might bring some clarity to this issue. At very least you will be able to isolate whether it is a problem with your client or the API.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. Sounds like this may have been a problem with a library being pinned at a certain version in composer. see #1376. isAccessTokenExpired is testing value usually passed in by $client->setAccessToken(\u2026). Make sure you are passing the entire JSON string, not only the token part.\nTypically this string is either fetched from the server $client->fetchAccessTokenWithAuthCode(\u2026) or retrieved from a cache on disk json_decode(file_get_contents($credentialsPath), true).. It looks like a member of our great community answered your questions. Thanks Community! Please add a comment if you have any more questions and we can reopen this issue.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. isAccessTokenExpired is testing value usually passed in by $client->setAccessToken(\u2026). Make sure you are passing the entire JSON string, not only the token part.\nTypically this string is either fetched from the server $client->fetchAccessTokenWithAuthCode(\u2026) or retrieved from a cache on disk json_decode(file_get_contents($credentialsPath), true).. Duplicate of #871 . @jjeeknowre , @kevinszuchet looks like this issue slipped through the cracks. Are you still having problems with fetchAccessTokenWithRefreshToken?. @ardabeyazoglu You may get this error with fetchAccessTokenWithAuthCode if you try to use the same code again.\n@zim32 If you are still having problems please create a new issue with as much detail as possible, especially a code snippet that reproduces this error for you.. It looks like you are going to be limited to the format specified in the API Reference.\n. There is not a PHP example for the Google Search Console API but you can adapt the python one and a PHP example from another API and get up to speed pretty quickly.\nHere are the docs and I find the API Explorer to be an invaluable resource as well.. I would get your query working in API Explorer or the 'Try this API' feature of REFER\u00caNCIA with your date range. That may give you an insight in to which methods or parameters you need to use from the services classes.\nThose cURL and Javascript tabs are new to me, and depending on your comfort level either PHP's libcurl module or frontend Javascript you maybe get some mileage out of using the code generated in the full page mode of Try this API.. I don't have any experience with that API, but I did read something about using custom fields yesterday. It maybe that the API is intentionally simple with the expectation most people with want to extend it in a unknown way.\nI think in general that is right though, you tend to have to download all entries from an API and store them in a cache or database and then only filter them in an interesting way.. I don't know how to do that and I am not going to be able to figure it out in the foreseeable future. You might want to search or ask on StackOverflow. I will leave this issue open for a few weeks in case anyone else sees it and knows the answer.. From the list of properties in the Search Console. Click Manage property->Delete property. That is correct. The problem is with the generator code (which is in limbo and not really owned by any team.) I am tracking the problem in this issue: https://github.com/google/google-api-php-client-services/issues/44 . Yeah, that is right. So I guess the current workaround is to get it off PyPI or Github and run it for a single version of a service.. https://github.com/googleapis/google-api-php-client-services/pull/132 got a little long in the tooth it is now at https://github.com/googleapis/google-api-php-client-services/pull/145.. It looks like a member of our great community answered your questions. Thanks Community! Please add a comment if you have any more questions and we can reopen this issue.. @mdomocos I thought you were asked that an example be added to documentation but maybe you just wanted a quick answer. Looks like you got two great answers.. Thank you for filing this issue. We investigated and determined that this is actually a server-side issue. Please re-file it with the appropriate Google API issue tracker: https://developers.google.com/analytics/help/. If you believe that part of this issue still needs to be addressed in this client library, then feel free to re-open this issue with more information.\n. It looks like this can be closed. @aa-ahmed-aa, thanks for posting a solution for future search results. @net-tools, as always thanks for all the help you offer.. Thank you for filing this issue. @net-tools asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. Thank you for filing this issue. @net-tools asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. Please try upgrading your version of Guzzle.. Yeah I always have to look it up too. -L stands for location as in the follow the Location field in the response header.\ncurl -OL https://github.com/google/google-api-php-client/releases/download/v2.2.1/google-api-php-client-2.2.1.zip\n . Looks like this issue can be closed. Thanks, @LindaLawton . Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. It looks like a member of our great community answered your questions. Thanks Community! Please add a comment if you have any more questions and we can reopen this issue.. It looks like that file Userinfoplus.php is installed by composer at vendor/google/apiclient-services/src/Google/Service/Oauth2/Userinfoplus.php.\nDid you flatten those services directories by replacing /'s with _'s?\nAre you letting composer's autoloader handle the includes/requires or are you doing it manually?. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. Ben, I am curious if this result is reproducible in another client. Would you take a second to try a secondary request with the pageToken from an initial response in API Explorer. If that comes back with new results, you may want to use Charles Web Proxy to make sure pageToken is included in subsequent requests.. ####Short Answer\nLooks like it has been reported: https://issuetracker.google.com/issues/35207538\nLong Answer\nReally great semi-recent changes have been rolling out on https://developers.google.com . Most API teams have a Support tab with links to Issue Tracker or links at the bottom of each page. The Reference tabs are great. There are too many to keep a list of so I usually just open a new tab and search for \"Youtube API support\" or \"Google API AdSense\"\nThanks for opening an issue. I'm happy to reopen it, just post another comment. \n. Thanks for opening this issue. It looks like you have received an answer on SO. I'm happy to reopen this thread, just add a comment.. Thank you for your feature request. This client library is currently in maintenance mode. We are fixing necessary bugs and adding essential features to ensure this library continues to meet your needs for accessing Google APIs. After careful consideration, we have decided not to proceed with this enhancement. If you disagree, please feel free to re-open this issue and explain why you believe it is essential for users of this client library.. @timothymarois HEY-YO you gotchme. It is a canned response.\nI guess another way of putting it would have been: We are in the middle of a full rewrite anyways but we are playing are cards close to the chest until we know exact release dates. We are really excited that this new version is going to address some of the shortcomings of the current client library. Additionally, we want to make sure we are supporting current users of this client library especially with issues that are deal breakers. That is why we really encourage new issues being created and triaged and addressed. We also don't want to fall victims to the CADT model, so I am trying to get the bug count down as close to 0 as possible. That is a lot of work to do so we have employed some techniques, courteous, canned responses in this case, to get things done faster.\nGratifyingly, we have a fantastic community of developers from all over the world that are willing to jump in and test code and answer questions and submit PRs. So if my consideration seems too brief to be careful it is only in an attempt to make it also timely but never final. It's my attempt to avoid the unnecessary effort of others and also give the original feature requester info they need to make decisions as soon as possible.. Checkout https://github.com/google/google-api-php-client-services/ . There could be any number of reasons this has happened. https://stackoverflow.com/questions/17813621/oauth2-0-token-strange-behaviour-invalid-credentials-401 has a good list of things to check.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. This warning has been cropping up when an older version of Guzzle is used with PHP 7.2. If upgrading Guzzle doesn't work please include a full stack trace as well as version of PHP and Guzzle.. One work around is to copy your composer.json to a new directory and run composer install and then to use that vendor directory to replace your old one. Another is to use a packaged release provided by us at https://github.com/google/google-api-php-client/releases. You may want to copy your composer.json file into a new directory and composer install to get a fresh vendor directory. You could then either diff the two vendor directories for a controlled upgrade or just replace the old one altogether.\nYou may also want to include your composer.json file in this issue if you need help debugging it.. Try it with all three scopes:\nphp\ndefine('SCOPES', implode(' ', array(\n    Google_Service_Sheets::SPREADSHEETS,\n    Google_Service_Sheets::DRIVE,\n    Google_Service_Sheets::DRIVE_FILE) \n));\nI don't know why the docs say one of those three are required. My experience with scopes is the more the merrier and do whatever Try this API or API Explorer do.. I haven't been able to reproduce your result. Is it possible you made a change that that empties out $requestBody?\nThe only other thing I would mention is you probably want values in another array so they insert across instead of down:\nnew Google_Service_Sheets_ValueRange([\n    'values' => [$values]\n]);. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. @mcannon354 It looks like you need to implode(' ', ) your scopes array.. @n00dl3 by the by, are you looking for help to get it working in 5.4 or letting us know so we can fix the docs or both?. In this case the call to insert just builds a request (sets the URL and headers like Bearer). nextChunk is the one that sends (opens network connection, sends data, waits for reply from server).\nYou should have several nextChunks per inserts. It looks like you are only sending the first frame of the buffered file. You need to keep freading until you get every last byte:\nphp\n$status = false;\n$handle = fopen($videoPath, \"rb\");\nwhile (!$status && !feof($handle)) {\n  $chunk = fread($handle, $chunkSizeBytes);\n  $status = $media->nextChunk($chunk);\n}\nPart of the reason insert isn't named something more apt like buildInsertRequest is so it will closely match the HTTP API method all of which are listed on the very great API Explorer which is my favorite place to find links to the docs. In this case you still need to click through the Reference tab to get a description of the insert method.\nFinally the PHP code generated for each API is in this repo's sister repo: https://github.com/google/google-api-php-client-services/.\n. It looks like a member of our great community answered your questions. Thanks Community! Please add a comment if you have any more questions and we can reopen this issue.. Assuming you either run composer install or download a release the methods for the Google Custom Search API will be in vendor/google/apiclient-services/src/Google/Service/Customsearch.php. But you shouldn't have to worry about that if you are including the autoloader file: include_once __DIR__ . '/../vendor/autoload.php';. I think we are all on the same page. Any change will not go into this client library until the API change happens next year.. I reproduced this error from the code you provided. My approach was just to look at the request in-flight (using mitmproxy, Charles works too) From that it looks like the easiest fix will be to change the last line in your foreach loop to \nphp\n        $requests[] = [\"updateSheetProperties\"=> $request];. Fixed in https://github.com/googleapis/google-api-php-client-services/commit/3bf818b9b643a4cd979fba52a0dc515edb9d5d95. Please do, that would be great, thank you.\nOn Tue, Mar 27, 2018 at 12:57 PM Brent Shaffer notifications@github.com\nwrote:\n\nHere is the state of PHP 5 usage overall. I can pull up internal numbers\nas well and send them to you personally.\nhttps://w3techs.com/technologies/details/pl-php/5/all\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/1405#issuecomment-376654478,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AFAP25PS0jVxKzA13QEtyCgzmAKV_vNuks5tipmygaJpZM4S9Wsf\n.\n. Looks like you need to double check that what is in your php app matches what is in your Developer Console.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. You should be able to follow these steps https://getcomposer.org/download/ on any server or instance with php installed.. What API are you accessing? Also please include a list of steps and a small snippet of sample code that can be used to reproduce the problem.\n. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action nearly a week ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. It looks like this an API problem affecting several people. You might want to pick one of those recent issues to add a comment to that you are also experiencing this error. Be sure to include any details that might help pinpoint the source of the error.. Thanks for creating this issue. I am not understanding your problem yet, this library does not offer any error display capabilities.\n\nPlease attach a working code sample, list what you expect to happen and what is actually happening.\nYou may also consider asking your question on StackOverflow if it is not a bug report. Some really helpful folks watch that more closely than they do this repo.. By throwing an exception the library lets an app developer (the user of the library) decide if they want to keep on going (by handling with a catch) or stop the world and end execution all together. Both can be valid decisions. . We offer a release with all the dependencies included so you don't need to run composer:\nhttps://github.com/google/google-api-php-client/releases\n. I don't know much about Composer. When I did a composer install (looks like on Mar 9th) it pulled down guzzlehttp/psr7 1.4.2 what version of google/apiclient is installed?. This issue looks resolved. Add a comment if that is not the case.. https://developers.google.com/gmail/api/v1/reference/users/messages/send#examples\nAre you using all four scopes?\nphp\ndefine('SCOPES', implode(' ', array(\n  Google_Service_Gmail::MAIL_GOOGLE_COM,\n  Google_Service_Gmail::GMAIL_MODIFY,\n  Google_Service_Gmail::GMAIL_COMPOSE,\n  Google_Service_Gmail::GMAIL_SEND)\n));. Please upgrade to the latest version. It is no longer pinned to 1.2.*.. Duplicate of #1413  . @johnsky007 if you are still having any problems add any detail to #1413.. +@bshaffer . Please supply a complete code sample that is not working and describe the behavior you are expecting.. It looks like a member of our great community answered your questions. Thanks Community! Please add a comment if you have any more questions and we can reopen this issue.. Duplicate of #1343 google/google-api-php-client-services#44. Thanks for opening this issue. That class is autogenerated and the annotation would be overwritten if we tried to fix it with a PR. I have found the rest reference to be the most helpful resource when understanding these APIs and methods.. Not sure what API you are talking about, but how it works is: an API team documents changes to methods or fields or APIs in a discovery doc and all the GA APIs (and lots of the beta) are list in our main discovery doc. The classes for this library autogenerated by parsing those discovery docs.\nSo to answer your question, I think so. Watch the release of client-services for the change you are looking for. . Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. @DE-co-DE does this resolve your issue? Are the descriptions getting set even though they aren't coming back in the response?. @LindaLawton Do you know where this is documented?\nThere is at least one place in the documentation that contradicts the behavior of the API: https://developers.google.com/drive/api/v3/performance#partial\n@JustinBeckwith Should we tweak the existing Drive examples to highlight using fields?. Thanks for creating this issue.. Thanks for the heads up. I have passed your feedback along.\n. The release page has all this repo's code and its dependencies:\nhttps://github.com/google/google-api-php-client/releases\nUnlike most client/server network communication projects, this is just a\nclient project and not at all helpful in implementing one's own server.\nOn Mon, Apr 30, 2018 at 2:20 AM anilshah694 notifications@github.com\nwrote:\n\nhi\nhow to download complete code and how to implement on my server?\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/1424, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AFAP2_zGxg5quqzB6TTgdnrXsMvs9ZCjks5tttdPgaJpZM4TsUPt\n.\n. Bah, I misread the question. Sorry about that, @anilshah694; thanks for the question. It looks to be resolved, so I am going to close this issue.. Could you include an example of code that is causing this behavior?. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. This seems inaccurate: https://github.com/google/google-api-php-client/blob/0c4a7b6eaefe8b0a6334c044feab9790095b2ddb/composer.json#L12\n\nI don't know much about Composer. Is there a way to upgrade google/apiclient first so Composer knows about its newer expanded dependency matrix?. This seems resolved. Thanks @LindaLawton! @xryst if you still have questions just add a comment and we will reopen this issue.. It looks like this is an API issue. You seem to have taken all the right steps. I'm sorry to say creating an issue in this repo doesn't expedite one in Issue Tracker.. This is being tracked at https://issuetracker.google.com/issues/80362795. It looks like a member of our great community answered your questions. Thanks Community! Please add a comment if you have any more questions and we can reopen this issue.. @dwsupplee Please review it, I guess my only hang up is not including a sample_video.flv file and thus not having a working sample. . Yes, it is a copy and paste job. From the full sample setting.\nOn Fri, Jun 8, 2018 at 11:41 AM David Supplee notifications@github.com\nwrote:\n\nIs this just copied over from here\nhttps://developers.google.com/youtube/v3/docs/videos/insert? I have\nbeen putting together some notes, and there are some definite issues with\nthat code (in my testing, it doesn't just work out of the box). It\nlooks like this sample\nhttps://github.com/youtube/api-samples/blob/master/php/resumable_upload.php\nfollows a similar pattern but is updated to be more idiomatic and to work\ncorrectly. I'd recommend we just link out to the latter sample, but if we\nprefer to have something different living in this repo I'd be happy to post\nmy notes so this can be useful for our users.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/1435#issuecomment-395852025,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AFAP27Trq2vW1AQfmsZkyX2w6ovqYKkYks5t6sVFgaJpZM4UdC4o\n.\n. Duplicate of #443. Thanks for your earlier feedback, Alexander.\nThere is no plan to change the API as defined at https://developers.google.com/people/api/rest/. You can see  at the top of the discovery doc it gets little tweaks all the time but nothing on the scale that you are asking for.\n\nThere is a plan to generate better IDE helps (#443) that might override source code documentation in IDEs and text editors. But that is low priority internally and hasn't piqued anyone's interest in the community yet.. Make sure to call $this->service->getClient()->setUseBatch(true); before createBatch.. Seems like this issue got resolved.. Lastly, on the Releases page you can find zip files containing the library with composer update run already.\n@omermujtaba, please leave another comment if you need anything else.. @michaeldprice Thanks for the heads up. I just added those assets to v2.2.2.. It looks like a member of our great community answered your questions. Thanks Community! Please add a comment if you have any more questions and we can reopen this issue.. Thanks for creating this issue.. It sounds like you want to pick one auth flow and stick with it. So to pick the right one let me ask you some questions:\nAre you trying to use over the air installs?\nAre you trying to interact with the My Business API via JS in the browser and via PHP on the server?\nAre you trying to persist auth between requests to your single page JS app?\n. I don't think you want to swap credentials between apps like that.\n@LindaLawton any ideas? . Thanks for your feedback.. I haven't been able to reproduce the HTML response. Maybe you could recreate it in a reproducible way in Postman or curl. Or maybe capture more of your request details in Charles Proxy or mitmproxy.\nphp\n$client->setHttpClient(new GuzzleHttp\\Client(['proxy'=> 'localhost:8080','verify'=> 0]));\nI agree about the response format, I think this client code itself has built in assumptions about the response coming back as JSON. Maybe that is why it is blowing up in REST.php where you don't expect it (just thinking out loud/ not sure)\n@teo1978 your messages seem overwrought given the subject matter. If you need someone to talk about PHP or anything feel free to reach out via email.\n. @teo1978, I don't think there is an undelete. Just post it again, this time without the profanity.. I don't know all the ins and outs of composer. Please attach your composer.json file to make it easier to recreate this issue.. This git is google/apiclient so you'll want to just composer install after a clone.\nYou can run composer require google/apiclient:^2.0 from a different directory/project to treat this git as a dependency.. Looking at https://firebase.google.com/docs/cloud-messaging/server it seems that you would use the Cloud Functions API which is included as one of the services in this library. Good question, thanks. Please comment if you have anymore questions.. Looks like they are both going to the same place: https://github.com/googleapis/google-api-php-client/blob/593058802a4bada447e541a454601025c38bb2a9/src/Google/Client.php#L306-L308\nOne must have been left in to support older code bases.. Duplicate of #1366 . @MiguelQueiroz The DIY workaround is to run the generator on the v2 json file. It may require a little Python knowledge though.. @MiguelQueiroz, I ran into this page last week: https://developers.google.com/drive/api/v3/migration\nIt explains why trash went away.\nLooks like you can call update(['trashed'=>true])\n. Good question. It looks like you want https://github.com/googleads/googleads-php-lib.\nSee https://developers.google.com/doubleclick-publishers/docs/start. You might want to check out https://developers.google.com/doubleclick-publishers/community. Duplicate of #932. Hi @naveedali2 !\nI have looked at this and can't reproduce this behavior. Would you run a composer show and let me know what version google/apiclient-services is on?. Duplicate of #1489 . Check out this example from https://developers.google.com/drive/api/v2/reference/files/list, the trick is to page through the entire list of files.\n```php\n/\n * Retrieve a list of File resources.\n \n * @param Google_Service_Drive $service Drive API service instance.\n * @return Array List of Google_Service_Drive_DriveFile resources.\n /\nfunction retrieveAllFiles($service) {\n  $result = array();\n  $pageToken = NULL;\ndo {\n    try {\n      $parameters = array();\n      if ($pageToken) {\n        $parameters['pageToken'] = $pageToken;\n      }\n      $files = $service->files->listFiles($parameters);\n  $result = array_merge($result, $files->getItems());\n  $pageToken = $files->getNextPageToken();\n} catch (Exception $e) {\n  print \"An error occurred: \" . $e->getMessage();\n  $pageToken = NULL;\n}\n\n} while ($pageToken);\n  return $result;\n}\n. Hi @clevertree. Where are you finding Walletobjects.php? Please link to which specific API you are trying to access. It looks to me like Walletobjects is probably deprecated and currently the Google Pay API does not have a generally published definition/discovery document (otherwise it would show up on [API Explorer](https://developers.google.com/apis-explorer/#p/)).. Thanks cool. I didn't know this library was being vendor'd in other projects like that. Depending on how close you want to stick to the code provided you can either do it manually as you suggest or the line that handles the rest of the includes in the example is https://github.com/google-pay/s2ap-quickstart-php/blob/master/header.php#L27. Let me know if you have anymore questions.. Thanks @Yahav!. Looks like I had this issue misclassified. This warning is caused by your argument to listFiles. It needs to be in the form ['q'=> 'fill_In_Drive_Folder_ID_Here'] See https://developers.google.com/drive/api/v3/search-parameters for other 'q's.. Right now this client library only supports v3 of the Drive API. You will want to use files.get with ?fields=parents to list parents: https://developers.google.com/drive/api/v3/migration. Hi @siburny \ud83d\udc4b\nThanks for the suggestion and maybe it is superfluous but we want to have the context there that it is not versions 1 or 3.. Just so we are on the same page what does the following output?batch\nmkdir testdir\ncd testdir\n..\\composer require google/apiclient:^2.0\n..\\composer show\n```. This just hit me this morning.\nLet's change this to add a note that DOS users need to escape the escape character: composer require google/apiclient:^^2.0\n. I don't know a quick answer to this one. I would start with the documentation of the API you are using. Is that part of the GSuite?\nOne resource I find very useful when I don't know exactly which action I need to call but I have a general direction is API Explorer.. After looking at some pages I don't think this can be done programmatically (or even administratively). :wave: Hi @markosjal,\nSounds like you are looking for version 1.1.8\nhttps://github.com/google/google-api-php-client/tree/v1-master. I got the 1.1.8 from Packagist.org.\nIn your project directory I would try:\n*composer* require google/apiclient:^1.0\nOn Tue, Aug 14, 2018 at 1:17 PM markosjal notifications@github.com wrote:\n\nlooking atthe link below I see 1.1.7 but no 1.1.8.\nhttps://github.com/google/google-api-php-client/releases?after=v2.0.1\nwhen I try to do the composer install I get\nroot@gvsip:/var/www/gvauth/goog $ php composer.phar install\nDo not run Composer as root/super user! See https://getcomposer.org/root\nfor details\nLoading composer repositories with package information\nInstalling dependencies (including require-dev) from lock file\nYour requirements could not be resolved to an installable set of packages.\nProblem 1\n- Installation request for guzzlehttp/guzzle 5.2.0 -> satisfiable by\nguzzlehttp/guzzle[5.2.0].\n- guzzlehttp/guzzle 5.2.0 requires php >=5.4.0 -> your PHP version (5.3.3)\ndoes not satisfy that requirement.\nProblem 2\n- Installation request for guzzlehttp/ringphp 1.1.0 -> satisfiable by\nguzzlehttp/ringphp[1.1.0].\n- guzzlehttp/ringphp 1.1.0 requires php >=5.4.0 -> your PHP version\n(5.3.3) does not satisfy that requirement.\nProblem 3\n- Installation request for guzzlehttp/streams 3.0.0 -> satisfiable by\nguzzlehttp/streams[3.0.0].\n- guzzlehttp/streams 3.0.0 requires php >=5.4.0 -> your PHP version\n(5.3.3) does not satisfy that requirement.\nProblem 4\n- Installation request for react/promise v2.4.0 -> satisfiable by\nreact/promise[v2.4.0].\n- react/promise v2.4.0 requires php >=5.4.0 -> your PHP version (5.3.3)\ndoes not satisfy that requirement.\nI amm worried that installing a newer PHP may break something else\n\u2014\nYou are receiving this because you modified the open/close state.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/1494#issuecomment-413001537,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AFAP20bl1Wl2t5dhRE-nvG0n6rM3wLhEks5uQzA_gaJpZM4V7uVG\n.\n. https://developers.google.com/blogger/docs/3.0/reference/\nhttps://developers.google.com/resources/api-libraries/documentation/blogger/v3/php/latest/. Between lines 8 and 9 you need to test that $token is an array with an access_token key and not and error key.\n\nphp\n    if ($token['error']) {\n        error_log(\"$token[error]: $token[error_description]\");\n    }. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. :wave: Hi @sylviadiva \nIs this question somehow related to the SQLAdmin API and this (google-api-php-client) library?\nIf so please include a code snippet that isolates the behavior of this library. Thanks.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. Thanks for creating this issue. To help me reproduce the problem you are seeing please include the example code you are using and a details list of steps to perform to consistently observe this behavior.. Have either of you been able to verify that $_SESSION variables are leaking to other clients? What environment and versions are you running?. Seems like this issue is more or less resolved. Thanks for opening it. Please feel free add a comment and we can reopen.. I guess the fallback process failed too?\nYou could try removing vendor/google/apiclient-services and trying again.. Sounds like it is working for you. Give us a holler if you need anything else.. @mss-mohdali is this still an issue for you?. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. It sounds like you are talking about the Custom Search JSON API. I'm not really connected to that product in any way. But I'm going to try to answer your questions albeit in a very unofficial capacity:\nThe 100 result limit is intentional. I think of CSE not as a data science tool but as a high level tool that helps you create great experiences for your audience quickly.\nRight, the paid version does have that same limit.\nTwo approaches to getting more results occur off the top of my head: use a set of more specific queries that each result in less than 100 results; crawl the pages yourself, web crawlers are really fun projects.\nRanges are related to filtering and sorting, which may be another way to chunk those 4000 results down to smaller parts. You will need to choose what field to restrict though.. :fish: Short Answer:\nhttps://github.com/spatie/crawler\n\ud83c\udfa3 Long Answer:\nhttp://aosabook.org/en/500L/a-web-crawler-with-asyncio-coroutines.html\n+\nhttps://toys.lerdorf.com/archives/57-ZeroMQ-+-libevent-in-PHP.html\nGimme a holler if you have anymore questions.\n. There's the People API https://developers.google.com/people/ which is what I think you are looking for.\nThere is also the Directory API in G Suite but that is more for administrating  a lot of people in an enterprise or organization directory. . Hi, good question. A call to a service/resource method ($service->files->create() for example) will either return an instance of a class derived from either Google_Model or Google_Collection (Google_Service_Drive_DriveFile) or throw an exception that will have a \"code\" field as well as \"message\" and \"errors\". . Greetings @drrhf,\nI was under the impression this got fixed. What's your version of guzzle (composer info)? Please attach a sample of code that reproduces this issue. . @drrhf It looks like release 2.2.2 shipped with Guzzle 6.3.3. Can you verify those version numbers again (Guzzle's in vendor//ClientInterface.php) and mock up some code snippet that reproduces the error you are hitting?. Hello. :wave:\nUnfortunately, that is not a feature that ever got added to this client.. I'm not sure if I understand the first part of your question, but no I can't think of any gotchas. I would say it is probably easier to instantiate services and clients per client than trying to manage state by swapping out ids (or clients). But I don't think that is what you are suggesting. \nDid you hit any snags last week?. Thank you for your feature request. This client library is currently in maintenance mode. We are fixing necessary bugs and adding essential features to ensure this library continues to meet your needs for accessing Google APIs. After consideration, we have decided not to proceed with this enhancement. If you disagree, please add a comment to this issue and explain why you believe it is essential for users of this client library.. My first guess would be that there is a proxy in the third environment.\nYou might want to try to get other connections to timeout: a request with command line curl or a guzzle request to a different host in PHP.. It seems like this got resolved. Let us know if you have anymore questions.. The Authorization header holds an access token not an ID token (the other auth, authentication).\nThe page you linked shows an example of putting the ID token in the body of a POST request but I'm sure VueJS will let you add new header entries to your AJAX calls and minimize the changes you make to your PHP code.. I hope my last comment answered your question, if not let me know.. @JustinBeckwith I can put together a updated v2 example if the repo owners want a PR.. @LindaLawton, I'm am going to close this issue. Hopefully links your samples with be found and help people with a more modern version of this client.. @codersneha3012 So code that was working is not anymore. Which error state does it end up in?. More than willing to reopen if you are still having this issue.. You can already use set a proxy:\nphp\n$client->setHttpClient(new GuzzleHttp\\Client(['proxy'=> $proxy]));\n$payload = $client->verifyIdToken($idtoken);. Hi @ShirGrinblat :wave:\nIt looks like you may have found file at src\\Google\\autoload.php and changed the scripts in the example directory to point at that. They should all be pointing at ../vendor/autoload.php:\nphp\ninclude_once __DIR__ . '/../vendor/autoload.php';\n``\nBut that doesn't exist on a cleangit clone. You will need to runcomposer install` for that vendor directory to show up and then warnings should go away.\nSee\nhttps://github.com/googleapis/google-api-php-client/tree/master/examples#how-to-run-the-examples\nhttps://github.com/googleapis/google-api-php-client#installation\nLet me know if you have any other questions.. Hi David,\nIt sounds like the fix for this is the @throws tag. I will do some testing and find out.. It sounds like you are looking for https://developers.google.com/drive/api/v3/integrate-open and https://developers.google.com/drive/api/v3/manage-sharing\n. Let's start by checking that the API is enabled in the Google APIs Console.. Make sure $scopes has both https://www.googleapis.com/auth/calendar and https://www.googleapis.com/auth/calendar.events.. @chenliangliang008 It seems like you have got this issue resolved. Let me know if that is not the case.. Drive will attempt to automatically detect an appropriate value from uploaded content if no value is provided. The value cannot be changed unless a new revision is uploaded.\nIf a file is created with a Google Doc MIME type, the uploaded content will be imported if possible. The supported import formats are published in the About resource.\n. https://developers.google.com/identity/protocols/OAuth2 walks you through how to use this library and  Google API Console automate authentication and authorization.. Hi @Nehadigi :wave:\nThe Google Drive API has a pretty slick search interface https://developers.google.com/drive/api/v3/search-parameters.\nTo do want you are looking for just use mimeType:\nphp\n$driveService->files->listFiles(['q'=> \"mimeType = 'application/vnd.google-apps.folder'\"]);\n. I think it is parents with an s because you can put one file in multiple folders (labels). To get the file's complete ancestry you could get a list of all the folders $driveService->files->listFiles(['q'=> \"mimeType = 'application/vnd.google-apps.folder'\"]); and then match parents to ids.. If it is a group wouldn't you want to call $directory->groups->get('somegroup@domain.com');? I am not very familiar with this particular API.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. I'm sorry it looks like this API is only available to authorized integration partners.\nhttps://www.google.com/ads/hotels/find-a-partner/. I would say check your partner agreement to be sure.\nAll of our services for this library are generated from the same place as that reference you linked: another API called Discovery. Typically partners with access to a limited-access API also have access to the discovery doc. Sometimes the API team just generates client libraries and distributes those.\nWe don't merge PRs to the services repo because it is all auto-generated anyways.\nI hope that answers your question, I'm not sure in what sense it might be a bad idea.. The intention of this code is indeed: test the result of the assignment to verify the usability of $json.\nNot a PHP bug. Though other languages would not allow it.. Thanks for opening this issue. Let us know if you have anymore questions.. I'm having a hard time understanding what issue you experiencing. Could you attach a snippet of code that is not working and explain what behavior you are expecting to see.. Check out the latest version of this example in this repo.\nPlease let me know where you got that older version from and I will try to update it. Thanks. I seem to have avoided answering your question directly, sorry about that, that was unintentional. You are right about the scope, it looks like you want 'email'. I would double check your script against the version I linked and make sure there aren't any other changes you need to make.. Let me know if you have any other questions.. Please include a snippet of the code you are trying to get working.. Thank you for filing this issue. We asked some clarifying questions or suggested a course of action a week or more ago and never heard back from you. We are unable to proceed with this issue until then, so we are closing it. Please feel free to comment with more information and we will re-open this issue.. @wangrong1994 Can you confirm that you still receive this error after uploading your app manually for the first time?. Looks like this one is resolved.. Looks like you are right on all counts. I suspect this is an intentional design choice on the part of the API team: after you set keywords you can't unset set them.\nI'm going to close this issue because it is not an issue with this library. Like @benparisi19 said setting it to a meaningless value like '.' is probably the best workaround.. Access tokens do expire after an hour. To refresh them after that time you need have a refresh token which will be provided the first time they log in and authorize your app if you have set access type to offline:\nphp\n$client->setAccessType(\"offline\");\n$auth_url = $client->createAuthUrl();\nheader('Location: ' . filter_var($auth_url, FILTER_SANITIZE_URL));\nIf your access token has a refresh token you can refresh without prompting the user for permission:\nphp\nif ($client->isAccessTokenExpired()) {\n  $client->fetchAccessTokenWithRefreshToken($client->getRefreshToken());\n}\n. Let us know if you need anything else.. Thanks for the PR. I'm going to close it because the change to PHP 7.2 was about passing NULL to the function and in fact encourages use of get_class() without any argument.\nhttps://secure.php.net/manual/en/migration72.incompatible.php#migration72.incompatible.no-null-to-get_class. @marcobaroni1991, the fix in your snippet would be\nphp\n        $tag->setParameter( [$tagManagerParameter] );\nGive us a holler if you need anything else.. Hi @cjdocare!\nI have simplified your snippet a bit and I think it should work for you now.\n```php\n$content = file_get_contents($file_path);\n$fileMetadata = new Google_Service_Drive_DriveFile(array(\n                        'name' => 'dummy_name',\n                        'mimeType' => 'application/pdf'));\n$file = $service->files->create($fileMetadata, array(\n                        'data' => $content,\n                        'uploadType' => 'multipart',\n                        'fields' => 'id'));\n. This library might actually be overkill for Google Custom Search API. [Using REST to Invoke the API](https://developers.google.com/custom-search/v1/using_rest) is a great guide to get started with the API. Just json_decode the results of file_get_contents to the URL in the request example:php\n<?php\n$key = 'YOUR_KEY_HERE';\n$query = 'https://www.googleapis.com/customsearch/v1?q=lectures&cx=017576662512468239146:omuauf_lfve&key='. $key;\n$res = json_decode(file_get_contents($query));\nforeach ($res->items as $item) {\n    echo \"$item->title $item->link\";\n    echo PHP_EOL;\n}\n```\nIf you really want to use this library and are unsure how with an API that only requires an API key, check out the Google Books example and adapt it to the Custom Search service. The API Explorer may help.. Give us a holler or a comment below if you need anything else.. I'm sorry that error isn't related to this library and we can't help you with that.. Batch requests are to do a lot of different things with the same set of credentials. You need separate flows for each identity represented by an access token.\n\"array\" in the function signature is actually a map in this case. It typically has the following keys: access_token, token_type, expires_in, refresh_token, created.. Unfortunately, I do not The batch example in this repo uses developer keys not OAuth tokens.\nTwo things I would like to note:\nFor one user why store 10 different tokens? You can simply create one access token with enough scopes to make all your requests with. The refresh token portion expires after one hour anyways.\nIn most situations the difference between 10 smaller requests and one batch request is negligible. The only time I suggest preferring batched requests is when the API's documentation suggest/require it.. Please provide more details on how to reproduce this error include the snippet of PHP that is producing this unexpected result. (Make sure to remove keys and secrets). It looks like this is expected behavior. My guess is they don't want you using webviews. Check out https://developers.google.com/identity/sign-in/ios/sign-in. I'm sorry I can't be of more help but the scope of this library is almost completely back-end PHP code. Please let me know if I can help you in that realm.. The metrics from the Google Analytics API won't show up as data types in this library, rather they are passed in as data:\n```php\n  // Create the Metrics object.\n  $country = new Google_Service_AnalyticsReporting_Metric();\n  $country->setExpression(\"ga:country\");\n  $country->setAlias(\"sessions\");\n$gender = new Google_Service_AnalyticsReporting_Metric();\n  $gender->setExpression(\"ga:gender\");\n  $gender->setAlias(\"sessions\");\n$usertype = new Google_Service_AnalyticsReporting_Metric();\n  $usertype->setExpression(\"ga:userType\");\n  $usertype->setAlias(\"sessions\");\n// Create the ReportRequest object.\n  $request = new Google_Service_AnalyticsReporting_ReportRequest();\n  $request->setViewId($VIEW_ID);\n  $request->setDateRanges($dateRange);\n  $request->setMetrics(array($countries, $gender, $usertype));\n```. Thanks for filing this issue. It looks like it has been addressed, if that is not the case let us know in the comments.. Duplicate of #827 . Please see the discussion there and in linked issues for help with your question.. Your question is not related to this library. StackOverflow is probably the right place to ask it.. Sounds like you are looking for https://github.com/googleapis/google-auth-library-php. @dwsupplee, good idea. PTAL. Hi, Callum. :wave: Looks like it is named JobService, definitely not the first place I would have looked either.\nThanks for your question.. It needs to be in a directory above the one in which idtoken.php is located, that is two directories above base.php.\nMake sure to not let your oauth-credentials.json file be web accessible.\nJust add a comment if you have any other questions.. Shouldn't this be Blogger not Google?. It's a good change. In this case I just think Blogger would have a bit more meaning.. @BostonBud Thanks for reporting this. The quickest fix for you is to another line of initialization near the top of getClient():\nphp\n    $client->setRedirectUri(\"urn:ietf:wg:oauth:2.0:oob\");\nMy best guess would be that the credentials.json file doesn't have a redirect_uris entry. Did you create your credentials on the Quickstart page? It looks like this library assumes you are using credentials for an OAuth client of type Other (installed).. Create an OAuth Client ID in the console of Application Type: Other. #### 1.\nIn this case it looks like they are there by default:\nphp\n$event->getDescription()\n$event->getLocation()\n$event->getCreator()->displayName\nIn general, if an object's properties are not getting populated, a list of fields you want back from the API:\nphp\n$optParams = array(\n  'maxResults' => 10,\n  'orderBy' => 'startTime',\n  'singleEvents' => true,\n  'timeMin' => date('c'),\n  'fields'=> 'description,items(creator/displayName,location)',\n);\nI always use API Explorer to help me pick.\n2.\ntimeMin and timeMax control the time frame of your query.. Just leave a comment if you need anything else.. How about:\nphp\ntry {\n    $purchase = $service->purchases_subscriptions->get($packageName, $subscriptionId, $purchaseToken);\n}\ncatch (Google_Service_Exception $e) {\n    $json = $e->getMessage();\n}\n. My Business is a bit of an oddball, it is not listed in the API directory available through the Discovery API and it requires a developer key and project acceptance into My Business. There is a tool on the way that will help developers maintain their own version of such service classes. When it is ready and you have a project with My Business enabled you should be able to run:\nphp\nexport API_KEY=yourkey\nbin/generate 'https://mybusiness.googleapis.com/$discovery/rest?version=v4&key=$API_KEY' generated-output\nand then you can move the contents of generated-output/mybusiness-v4 anywhere you want in your include path.\nThat discovery URL has been known to change as new versions come out so keep and eye on https://developers.google.com/my-business/reference/rest/\n. Duplicate of #1538 . This library might actually be overkill for Google Custom Search API. Using REST to Invoke the API is a great guide to get started with the API. Just json_decode the results of file_get_contents to the URL in the request example:\n```php\n<?php\n$key = 'YOUR_KEY_HERE';\n$query = 'https://www.googleapis.com/customsearch/v1?q=lectures&cx=017576662512468239146:omuauf_lfve&key='. $key;\n$res = json_decode(file_get_contents($query));\nforeach ($res->queries->nextPage as $page) {\n    print_r($page);\n}\n```\nIf you really want to use this library and are unsure how with an API that only requires an API key, check out the Google Books example and adapt it to the Custom Search service. The API Explorer may help.. I'm sorry about that. I must have read your question too quickly.\nTo answer your question, no that API does not specify any method with a nextPageToken property.. That is one of the standard document stubs in every API's documentation section. It appears it has not been customized for the API in question.. This doesn't seem to have been an issue since June.\nhttps://github.com/googleapis/google-api-php-client/releases/download/v2.2.2/google-api-php-client-2.2.2.zip\nhttps://github.com/googleapis/google-api-php-client/releases/download/v2.2.1/google-api-php-client-2.2.1.zip\nboth have vendor directories. I need more detail about your problem to be able to help you solve it.. Hi @stecca21. No there shouldn't be any caching of responses in this client. You will definitely need to execute new requests to the API though:\nphp\n$results = $driveService->teamdrives->listTeamdrives()\nI am not really familiar with the Drive API but it may be that the only difference between a deleted and not deleted folder is that the trashed field is set. I don't know why a new folder would take so long to show up via API calls.\nFinally I will just note that you might be interested in tools like API Explorer or mitmproxy or Charles. Those are always helpful to me when I am getting an unexpected result and I'm trying to figure out why.\nhttps://developers.google.com/apis-explorer/#p/drive/v3/drive.files.list\nhttps://mitmproxy.org/\nhttps://github.com/googleapis/google-api-php-client#debugging-your-http-request-using-charles. Sounds great if that approach is working for you. You may also want to look into receiving push notifications.\nAnd of course please add comments below if you have any more questions. . I just took a peek at that API endpoint in API explorer and it looks like you need the following scopes:\n\nhttps://www.googleapis.com/auth/youtube\nhttps://www.googleapis.com/auth/youtube.force-ssl\nhttps://www.googleapis.com/auth/youtube.readonly\n\nphp\n$client->setScopes('https://www.googleapis.com/auth/youtube https://www.googleapis.com/auth/youtube.force-ssl https://www.googleapis.com/auth/youtube.readonly');\nAlso see https://developers.google.com/youtube/v3/live/docs/liveStreams/list. As an aside, I noticed you are using both OAuth and developer key auth. You don't need both and can delete the developer key lines.. The YouTube API does not support service accounts. The best way I know how do tell which APIs use service accounts is to click on one of the enabled APIs in https://console.developers.google.com. Then click credentials and see if your service account credentials load in that per-API view.\nYou are right that it is easy to breeze through necessary auth/auth knowledge, especially when you are trying to get an example working. It's kinda long but https://developers.google.com/identity/protocols/OAuth2WebServer should give you everything you need to know to get authorized to start making API calls.\nPlease feel free to comment below if you have anymore questions.. You will need user validation once, the very first time. After that it won't be needed again.. ",
    "gabrielkaputa": "In the documentation I see https://developers.google.com/google-apps/calendar/v3/reference/events that endTimeUnspecified is not writable. So maybe this is the answer I am looking for. Then the question is if there has to be a setEndTimeUnspecified method.\n. ",
    "marcovanest": ":+1: \n. ",
    "mail2rvg": "NULL values are not present in the JSON string. \nWe did a quick fix by using a preserved value that'll be replaced by a NULL value and will be included in the JSON string.\n. ",
    "alexkvak": "+1\n. +1\n. ",
    "yapro": "+1\n. I prepared the new patch https://github.com/google/google-api-php-client/pull/484\n. this ->id using in the first level of nesting (it checking looking for the named property in specific nesting).\n. I signed CLA on the page https://cla.developers.google.com/clas\n. Your idea is good. I will wait implementation.\n. ",
    "TheXardas": "+1\n. ",
    "denlapaev": "+1\n. ",
    "Strate": "+\n. ",
    "dweingart": "This code (stripping null attributes) also causes problems for the Directory API.\nIf you want to clear any of the array attributes of the Google_Service_Directory_User object (like emails, phones, or addresses) setting these properties to the empty array doesn't work. Only sending NULL (in the JSON) works to clear the attribute in my testing.\nHowever, there is no way to set the properties to NULL and have the nulls preserved with the current Google_Model code.\n. ",
    "viralpandya": "Having same issue (c#) and not able to send null value using (NULL_VALUE) with Datetime, it gives an error of malformat of date value.\nAnyone to help?\n. @bshaffer: Thank you for your reply! But for c#, I could not find one. So sent this question to this group.\n. ",
    "thabeloM": "ok so i finally got it working by adding \"request_visible_actions\" in my auth url, all along i was using \"requestvisibleactions\" but now my problem is the inserted moments can only be seen under app activities and not in my streams, how can i get the public to view my streams?  the app is only targeted to post in the administrator's stream not spam other users or is there another api you can advise to use?\n. ",
    "odin-delrio": "Done!\n. ",
    "Wayn0": "I can confirm, I had the issue today.\n. ",
    "dhiraj": "For all those people who land up here from searching on Google, if all you want to do is verify the token (and perhaps get the user's email address for completing your own authentication) then you do not need to use:\n$gclient->setAccessToken($id_token_from_mobile);\nInstead, you can directly pass the id_token to the verify function, and get the data out, which includes the email address, like so:\n$token_data = $gclient->verifyIdToken($id_token_from_mobile)->getAttributes();\n. ",
    "Errvald": "My bad didn't replace the correct files when updating the client.\n. ",
    "Rikkert2x": "Thanks for taking a look,\nWe are new to the Google API and havent seen we could use a second function like  \"getDisplayName()\".\nThat fixed the problem.\n. <?php\nsession_start();\ninclude_once \"templates/base.php\";\nrequire_once realpath(dirname(FILE) . '/../autoload.php');\n$client_id = 'xxxxx.apps.googleusercontent.com'; //Client ID\n$service_account_name = 'xxxxx@developer.gserviceaccount.com'; //Email Address\n$key_file_location = 'xxxxx.p12'; //key.p12\necho pageHeader(\"Rickdeman-WMS\");\n$client = new Google_Client();\n$client->setApplicationName(\"Rickdeman-WMS\");\nif (isset($_SESSION['service_token'])) {\n  $client->setAccessToken($_SESSION['service_token']);\n}\n$key = file_get_contents($key_file_location);\n$cred = new Google_Auth_AssertionCredentials(\n    $service_account_name,\n    array(\n        'https://www.googleapis.com/auth/calendar',\n    ),\n    $key\n);\n$client->setAssertionCredentials($cred);\nif ($client->getAuth()->isAccessTokenExpired()) {\n  $client->getAuth()->refreshTokenWithAssertion($cred);\n}\n$calendar = new Google_Service_Calendar($client);\n$contacts = new Google_Service_Contacts($client);\necho \"\\r\\n\" ;\nprint_r ($calendar ->calendarList->listCalendarList());\necho '' ;\n//$ResultC = $service->colors->get() ;\n?>\n\n\n\nI found out that the Curl recieved the data wrong already. so there is nothing we can do here.\nI did report the bug at google and it got categorized at the moment.\nhttps://code.google.com/a/google.com/p/apps-api-issues/issues/detail?id=3688\nClosed\n. ",
    "kennyvn": "$file_path = \"/www/home/public/images/footer-logo.png\"\nand my mime_content_type function : \nprivate function mime_content_type($filename) {\n```\n    $mime_types = array(\n    'txt' => 'text/plain',\n    'htm' => 'text/html',\n    'html' => 'text/html',\n    'php' => 'text/html',\n    'css' => 'text/css',\n    'js' => 'application/javascript',\n    'json' => 'application/json',\n    'xml' => 'application/xml',\n    'swf' => 'application/x-shockwave-flash',\n    'flv' => 'video/x-flv',\n\n    // images\n    'png' => 'image/png',\n    'jpe' => 'image/jpeg',\n    'jpeg' => 'image/jpeg',\n    'jpg' => 'image/jpeg',\n    'gif' => 'image/gif',\n    'bmp' => 'image/bmp',\n    'ico' => 'image/vnd.microsoft.icon',\n    'tiff' => 'image/tiff',\n    'tif' => 'image/tiff',\n    'svg' => 'image/svg+xml',\n    'svgz' => 'image/svg+xml',\n\n    // archives\n    'zip' => 'application/zip',\n    'rar' => 'application/x-rar-compressed',\n    'exe' => 'application/x-msdownload',\n    'msi' => 'application/x-msdownload',\n    'cab' => 'application/vnd.ms-cab-compressed',\n\n    // audio/video\n    'mp3' => 'audio/mpeg',\n    'qt' => 'video/quicktime',\n    'mov' => 'video/quicktime',\n\n    // adobe\n    'pdf' => 'application/pdf',\n    'psd' => 'image/vnd.adobe.photoshop',\n    'ai' => 'application/postscript',\n    'eps' => 'application/postscript',\n    'ps' => 'application/postscript',\n\n    // ms office\n    'doc' => 'application/msword',\n    'rtf' => 'application/rtf',\n    'xls' => 'application/vnd.ms-excel',\n    'ppt' => 'application/vnd.ms-powerpoint',\n\n    // open office\n    'odt' => 'application/vnd.oasis.opendocument.text',\n    'ods' => 'application/vnd.oasis.opendocument.spreadsheet',\n);\n$ext = pathinfo($filename, PATHINFO_EXTENSION);\nif (array_key_exists($ext, $mime_types)) {\n    return $mime_types[$ext];\n}\nelseif (function_exists('finfo_open')) {\n    $finfo = finfo_open(FILEINFO_MIME);\n    $mimetype = finfo_file($finfo, $filename);\n    finfo_close($finfo);\n    return $mimetype;\n}\nelse {\n    return 'application/octet-stream';\n}\n\n}\n```\n. when i change to banner.jpg ( other image ) it's work .. maybe my footer-logo.png is problem. i don't understand, but many thanks whatthejeff.\n.  $file_path = \"/www/home/html/public/css/bootstrap.css\"\nand my mime_content_type() function : \nprivate function mime_content_type($filename) {\n```\n    $mime_types = array(\n    'txt' => 'text/plain',\n    'htm' => 'text/html',\n    'html' => 'text/html',\n    'php' => 'text/html',\n    'css' => 'text/css',\n    'js' => 'application/javascript',\n    'json' => 'application/json',\n    'xml' => 'application/xml',\n    'swf' => 'application/x-shockwave-flash',\n    'flv' => 'video/x-flv',\n\n    // images\n    'png' => 'image/png',\n    'jpe' => 'image/jpeg',\n    'jpeg' => 'image/jpeg',\n    'jpg' => 'image/jpeg',\n    'gif' => 'image/gif',\n    'bmp' => 'image/bmp',\n    'ico' => 'image/vnd.microsoft.icon',\n    'tiff' => 'image/tiff',\n    'tif' => 'image/tiff',\n    'svg' => 'image/svg+xml',\n    'svgz' => 'image/svg+xml',\n\n    // archives\n    'zip' => 'application/zip',\n    'rar' => 'application/x-rar-compressed',\n    'exe' => 'application/x-msdownload',\n    'msi' => 'application/x-msdownload',\n    'cab' => 'application/vnd.ms-cab-compressed',\n\n    // audio/video\n    'mp3' => 'audio/mpeg',\n    'qt' => 'video/quicktime',\n    'mov' => 'video/quicktime',\n\n    // adobe\n    'pdf' => 'application/pdf',\n    'psd' => 'image/vnd.adobe.photoshop',\n    'ai' => 'application/postscript',\n    'eps' => 'application/postscript',\n    'ps' => 'application/postscript',\n\n    // ms office\n    'doc' => 'application/msword',\n    'rtf' => 'application/rtf',\n    'xls' => 'application/vnd.ms-excel',\n    'ppt' => 'application/vnd.ms-powerpoint',\n\n    // open office\n    'odt' => 'application/vnd.oasis.opendocument.text',\n    'ods' => 'application/vnd.oasis.opendocument.spreadsheet',\n);\n$ext = pathinfo($filename, PATHINFO_EXTENSION);\nif (array_key_exists($ext, $mime_types)) {\n    return $mime_types[$ext];\n}\nelseif (function_exists('finfo_open')) {\n    $finfo = finfo_open(FILEINFO_MIME);\n    $mimetype = finfo_file($finfo, $filename);\n    finfo_close($finfo);\n    return $mimetype;\n}\nelse {\n    return 'application/octet-stream';\n}\n\n}\n```\n. thanks whatthejeff, my mistake, 2 problem of file_path, when i code on window and test on linux \n. But what happen if i upload large file, and i can't remember id of file? \nThanks whatthejeff so much \n. ",
    "glensc": "how about dropping \"require_once\" lines from classes? the documentation already says you should first load autoloader, meaning you do not need to do that again from classes themselves.\n. i prefer composer based autoloader, because composer can write optimized version (-o). and with composer there will be only one spl_autoload method registered, instead of two (composer one and this one from project)\nwhen using composer src/autoload.php from this project should be ignored.\nso -2 for this PR\n. well, the classloader from classes should be removed eventually. but in my own projects i've used such hack:\nphp\nif (!class_exists('Composer\\Autoload\\ClassLoader', false)) {\n// setup classloader for outside composer usage\n}\nthis could be put to this project's autoload.php to avoid two of them being setup. this should be done part of #437 imho.\n. ah yes, my solution only solves for Composer autoloader.\n. so, maybe in classes which load autoload.php use such snippet:\nphp\n// do this only if autoload not yet invoked\nif (!class_exists('Google_Client')) {\n  require_once dirname(__FILE__) . '/../autoload.php';\n}\nthis will try to autoload Google_Client using existing methods, and if none registered, go for it's own.\ni assume Google_Client is always necessary, but could be any other base class.\n. i suggest not  to rely on relative paths, as those get resolved from include_path. \nuse sth like this instead:\nphp\nrequire_once dirname(__FILE__) . '/src/Google/autoload.php';\n. ",
    "s1x": "Sure.\n(Actual key was replaced with X)\n``` php\n( ! ) Fatal error: Uncaught exception 'Google_Service_Exception' with message 'Error calling POST https://www.googleapis.com/qpxExpress/v1/trips/search?key=X: (500) Internal server error for request id \"rNN8aXO9gHJyOdnYd0LFdA\".' in H:\\Webserver\\htdocs\\AirFares\\lib\\googleClientAPI\\src\\Google\\Http\\REST.php on line 111\n( ! ) Google_Service_Exception: Error calling POST https://www.googleapis.com/qpxExpress/v1/trips/search?key=X: (500) Internal server error for request id \"rNN8aXO9gHJyOdnYd0LFdA\". in H:\\Webserver\\htdocs\\AirFares\\lib\\googleClientAPI\\src\\Google\\Http\\REST.php on line 111\nCall Stack\nTime    Memory  Function    Location\n1   0.0006  140232  {main}( )   ..\\index.php:0\n2   0.0088  706296  Google_Service_QPXExpress_Trips_Resource->search( ) ..\\index.php:34\n3   0.0088  707256  Google_Service_Resource->call( )    ..\\QPXExpress.php:91\n4   0.0174  930608  Google_Client->execute( )   ..\\Resource.php:230\n5   0.0178  931040  Google_Http_REST::execute( )    ..\\Client.php:564\n6   0.0189  954760  Google_Task_Runner->run( )  ..\\REST.php:47\n```\n. Sorry for my late response - Christmas and New Year :-)\nMaking the $slice an array worked. Perfect!\n:+1: \n. ",
    "Nazardo": "Thanks for the link, sorry I forgot to check the upstream issue log.\nIt looks like the same issue but I am not so sure.\nI am not quering a public calendar, but a private one. I have added my service account to the list of allowed user with a \"read only\" profile. The account is then used by my PHP application (server-to-server OAuth).\nI have now upgraded my service account permissions on the calendar to \"read/write\" and colorId is correctly returned by the API call.\nThanks again for the help.\n. It does not make much sense to me the way colours read/write permissions are managed, but this is definitely not a php client library issue. :-)\nThanks for the clarification.\nCheers,\n-- M.\n. ",
    "SDKiller": ":+1: \n. You are using wrong key.\nCreate \"Client ID for web application\" and download it's json file\n. ",
    "majkel89": "I have already started writing parser to add those comments automatically :8ball: \nhttps://github.com/majkel89/misc/blob/master/GoogleApiPhpClient/GoogleApiAddHints.php\nPS: It would be nice to have snippets of documentation as well.\n. ",
    "tyteen4a03": "This would be highly appreciated. Trying to figure out what classes a method can return is rather cumbersome.\n. CLA Signed.\n. ",
    "garak": "Well, PSR-2 is just about following another standard, but of course it doesn't add anything about functionality, it's only coding style-related.\nPSR-4 is current autoloading standard proposed by FIG:\n. @samsamm777 you don't have to persuade me: I'm a super-fan of every standard. PSRs rock!\nMy point was: first priority should be for namespacing and better file organization, since the current one is just a mess. If this change can come along with coding standard, that would be the best.\n. I can't see how 82da936 could be related to this issue...\n. ",
    "ircmaxell": "Good point, removed comment (confused PSR2+PSR4 for a second).\n. @ianbarber PHP prior to 5.6 did not match SAN names: http://phpsecurity.readthedocs.org/en/latest/Transport-Layer-Security-%28HTTPS-SSL-and-TLS%29.html\nIf you can switch to CURL, it can correctly match the certificate.\n. @erickoledadevrel The default configuration does not contain trailing slashes: https://github.com/google/google-api-php-client/blob/master/src/Google/Config.php#L52 therefore, I took the approach to strip the trailing slash here and then add it at the combination step. I could add it back in the line above, but not really sure the benefit either way...\n. Can you test the PR #597 to see if that rectifies the issue? (It should, and based on testing looks good). I just want to double-confirm prior to pushing.\n. I've merged that fix into master. Will check about pulling a release.\nThanks again!\n. Verified as per #596, merging.\n. Thanks!\n. TBH, I could go either way. Considering that it's a completely undocumented parameter in public docs, and the only documented reference is in config.php:\n// Don't change these unless you're working against a special development\n  // or testing environment.\n  'base_path' => 'https://www.googleapis.com',\nI could see it going either way. It's up to you.\n. ",
    "samsamm777": "@garak its not really 'just another coding style'. I think its really important that php code open sourced to the community adheres to all the common practices etc. It will make for much happier adoption of your api's and much easier for other community members to contribute to your project. PSR is clearly defined and well structured. It makes sense to adopt it.\n. @garak  i see! yes of course prioritize for sure. namespacing will give a massive benefit. good to see this sdk is on the right tracks.\n. +1\n. how on earth did i not see that!\n. @silvolu Great! I can contribute too, my company will actively be using this sdk in the near future, so i'll be heavily involved with it.\nAlso all the media upload bits should be covered off with guzzle. http://guzzle.readthedocs.org/en/latest/streams.html\n. surely the access token should be in the constructor? we dont want to have to keep passing that about in our code. Im not sure if the static Service class is the best approach for building your services. Why not just the actual class? you can have a singleton static build method if you wish also, this gives a bit of flexibility, especially for people using service containers and doing their dependency injection properly. also static methods make for tricky unit testing/mocking\n``` php\n<?php\nuse Google\\UrlShortener;\n$shortener = UrlShortener::factory(array(\n    \"version\" => \"v1\",\n    \"access_token\" => \"ya29.DwHfdfdfdfdfdfdfdfdf\"\n));\n$short = $shortener->insertUrl(array(\n    \"resource\" => array(\n        \"longUrl\" => \"http://riskcompletefailure.com\"\n    )\n));\nvar_dump($short);\n```\nEach service can just extend the guzzle\\Client class to provide all your HTTP request/response stuff.\n. @ianbarber I have a feeling hand rolling would suite the php community much better as you'll be able to accept pull requests etc. Being a bit behind the curve with bleeding edge api's is probably an acceptable compromise.\n. ",
    "TomasVotruba": ":+1: , For some stats of PHP usage: http://seld.be/notes/my-view-of-php-version-adoption\n. I signed it!\n. Sure :)\n. Thanks for the question. I guess it's the same reason as for using Windows 8 over Windows 95.\nPHPUnit 5.0 is now out and using deprecated packages makes it more complicated to develop than otherwise.\n. Ok, thanks.\n. ",
    "atrauzzi": "Looking forward to the removal of underscores in class names and the addition of namespacing.  Simplify! :)\nAlso agree that 5.4/5.5 should be the minimum.\n. 5.5 on GAE and 5.6 locally, FWIW, this problem isn't happening locally.\n. I manually deployed some diagnostic code to GAE which contained the following:\nvar_dump(__NAMESPACE__);\n...just prior to the line in question.  The value is coming back as \"\", so PHP does not think it's in any particular namespace at the moment.\n. @sjlangley - I don't know why, but when I go between curl lite (happens) and regular curl (doesn't happen), the issue goes away...  I'll be updating our google issue tracker ticket.\n. @sjlangley @samuelwilliams - Any progress on this issue?  Running into it again trying to launch my app.\n. ",
    "kesar": ":+1: \n. Are you working in this implementation in any branch? I could help with guzzle integration.\n. I think you should use .p12 file. This is an example:\n``` php\n$service_account_name = '543534543fdsfsfsfs@developer.gserviceaccount.com'; //Email Address\n$key_file_location    = DIR . '/gfdgdfgd-sfsdfsdfs.p12'; //key.p12\n$client = new Google_Client();\n$client->setApplicationName(\"Client_Library_Examples\");\n$service = new Google_Service_Prediction($client);\n$key  = file_get_contents($key_file_location);\n$cred = new Google_Auth_AssertionCredentials(\n    $service_account_name,\n    array(\n        'https://www.googleapis.com/auth/devstorage.full_control',\n        'https://www.googleapis.com/auth/devstorage.read_only',\n        'https://www.googleapis.com/auth/devstorage.read_write',\n        'https://www.googleapis.com/auth/prediction'\n    ),\n    $key\n);\n$client->setAssertionCredentials($cred);\nif ($client->getAuth()->isAccessTokenExpired()) {\n    $client->getAuth()->refreshTokenWithAssertion($cred);\n}\n. This looks like you have a connectivity problem. Perhaps you have a firewall blocking your connection.\n. Your client needs a token to perform any activity. Parameter in revoke() is in the case that you want to revoke a different token, but you still need client with a valid token.\n.\nI find it absolutely pathetic that you can't even get your documentation/code samples together.\n```\nGood thing about being open source is that people like you can contribute to get this better :)\n. That will be great! thanks! :+1: \n. :+1: \n. It's hard to review a PR like this one ;-) \nNot sure if there is an issue and consensus about what CS rules is following this library. \n. change is reverted\n. :+1: \n. nope, I think its an error in the script that generate classes from documentation\n. > Ha! Interesting! Can we fix that?\nThat script is not public :disappointed: \n. Yep, it's a smart way to keep updated all the SDKs for different languages :)\n. :+1: \n. :+1: \n. looks good to me! :+1: \n. I can see the other one too:\nhttps://github.com/google/google-api-php-client/blob/master/src/Google/Service/YouTube.php#L165\n```\n * @opt_param string onBehalfOfContentOwner Note: This parameter is intended\n   * exclusively for YouTube content partners.\n\n@opt_param string onBehalfOf ID of the Google+ Page for the channel that the\nrequest is on behalf of.\n``\n. There is a PR related to this: https://github.com/google/google-api-php-client/pull/601 soon will be removed\n. if this is public I would make it optional\n. I would add some UT related to crossClient\n. param iscrossClientnotcrossIdentity`\n. vendor could have a different folder name ( https://getcomposer.org/doc/06-config.md#vendor-dir )\n. \n",
    "morales2k": "+1\nEagerly looking forward to this.... the library is getting in my way without namespaces, my database library has a clas named \"query\" and a method named \"get\"  and somewhere along the line, \"get\" from the \"query\" class returns a google api obj.... I am royally stuck.... no easy way out of this one and anyway I look at this all I see is a LOT of code rewriting....\n. ",
    "mbardelmeijer": ":+1: \n. ",
    "jshayes": ":+1: \nWould love to be able to PSR-4 autoload this.\n. ",
    "wrossmann": "Please, please, please embrace PSR-4 and abandon the classmap autoloader.\nAs it stands composer's autoload_classmap.php contains a 3541-entry array and weighs in at 432,029 bytes. This means that every time vendor/autoload.php is included this behemoth file may need to be yanked from disk. Once the autoloader is initialized we're now looking at a fair bit of additional memory usage as well.\nQuick test script:\n<?php\n$start = microtime(true);\nprintf(\"Cur: %10.3f kB Peak: %10.3f kB\\n\", memory_get_usage()/1024, memory_get_peak_usage()/1024);\nrequire('vendor/autoload.php');\nprintf(\"Cur: %10.3f kB Peak: %10.3f kB\\n\", memory_get_usage()/1024, memory_get_peak_usage()/1024);\nprintf(\"Microseconds: %d\\n\", (microtime(true) - $start)*1000000);\nCurrent master:\nCur:    220.820 kB Peak:    224.859 kB\nCur:   1216.398 kB Peak:   1783.805 kB\nMicroseconds: 6632\nAn unrelated project using PSR-4 autoloaders, essentially a baseline for composer:\nCur:    220.969 kB Peak:    225.016 kB\nCur:    345.812 kB Peak:    373.320 kB\nMicroseconds: 1103\nBy no means an exhaustive test, but certainly worth considering.\n. ",
    "kkopachev": "@Sammitch when using  --optimize option, composer will generate classmap-based autoloader even for psr-4 libraries.\n. ",
    "deconf": "We could also check the function name, and if it wasn't customized we could throw an exception. But that may be a drawback for those using the library outside a CMS.\nA recommendation in the README it's a good idea.\n. I've signed it few minutes ago, thanks!\n. ",
    "maroke": "OMG! I was using print_r. Now with var_dump I can see that the value is false.....So, what I'm doing wrong with reminders??\n\nI'm creating events without problems, only I have problems with reminders.\n\nMaybe I'm not doing a step, but I don't know what it is :(\nThanks for your help!\n. Please, anyone could provide some code creating an event with reminders that works ok??\n. Hi ianbarber, I have captured the value of $postBody in /Service/Resource.php function call, and later I have paste the json in https://developers.google.com/apis-explorer/#p/  .... and the event has been created with reminders. I'll keep looking for the problem. Thanks\n. I stopped trying to find the problem temporarily to do other things, because I was stuck with this task. \nIn fact, I don't know what more can I do. As you can see I captured the response, I pasted the json in apis-explorer and it worked ok.... :/\n. ",
    "mmaiolinoc90": "tengo problemas con insert de google calendar no encuentro la manera de adaptarlo a mi sistema web\n. ",
    "fdnetty": "Hi, \nI have the same issue with the lastest 1.X.X release ( 1.1.7), the event is created, all works fine excepted the reminder : \nHere is my code : \n```\n$event = new Google_Service_Calendar_Event();\n$event->setSummary($event_info['event_text']);\n$time = new DateTime();\n$timeStart = new Google_Service_Calendar_EventDateTime();\n$timeStart->setDateTime($time->setTimestamp($event_info['time_start'])->format(DateTime::ATOM));\n$timeEnd = new Google_Service_Calendar_EventDateTime();\n$timeEnd->setDateTime($time->setTimestamp($event_info['time_end'])->format(DateTime::ATOM));\n$event->setStart($timeStart); \n$event->setEnd($timeEnd);   \n$event->setDescription($event_info['content']);\n$event->setLocation($event_info['where']);\n//Add reminders\n//setDefaultReminders\nif($event_info['remind']){\n    $set_reminders = new Google_Service_Calendar_EventReminders();\n    $set_reminders->setUseDefault(FALSE);\n    $set_reminders->setOverrides(array(\n        array(\n            'method' => \"popup\", \n            'minutes' => $event_info['remind']/60\n        )\n    ));\n    $event->setReminders($set_reminders);\n}\n$createdEvent = $service->events->insert($cal_id, $event);\n```\nAnd var_dump() before the insert : \n```\nobject(Google_Service_Calendar_Event)#313 (55) {\n  [\"collection_key\":protected]=>\n  string(10) \"recurrence\"\n  [\"internal_gapi_mappings\":protected]=>\n  array(0) {\n  }\n  [\"anyoneCanAddSelf\"]=>\n  NULL\n  [\"attachmentsType\":protected]=>\n  string(39) \"Google_Service_Calendar_EventAttachment\"\n  [\"attachmentsDataType\":protected]=>\n  string(5) \"array\"\n  [\"attendeesType\":protected]=>\n  string(37) \"Google_Service_Calendar_EventAttendee\"\n  [\"attendeesDataType\":protected]=>\n  string(5) \"array\"\n  [\"attendeesOmitted\"]=>\n  NULL\n  [\"colorId\"]=>\n  NULL\n  [\"created\"]=>\n  NULL\n  [\"creatorType\":protected]=>\n  string(36) \"Google_Service_Calendar_EventCreator\"\n  [\"creatorDataType\":protected]=>\n  string(0) \"\"\n  [\"description\"]=>\n  string(0) \"\"\n  [\"endType\":protected]=>\n  string(37) \"Google_Service_Calendar_EventDateTime\"\n  [\"endDataType\":protected]=>\n  string(0) \"\"\n  [\"endTimeUnspecified\"]=>\n  NULL\n  [\"etag\"]=>\n  NULL\n  [\"extendedPropertiesType\":protected]=>\n  string(47) \"Google_Service_Calendar_EventExtendedProperties\"\n  [\"extendedPropertiesDataType\":protected]=>\n  string(0) \"\"\n  [\"gadgetType\":protected]=>\n  string(35) \"Google_Service_Calendar_EventGadget\"\n  [\"gadgetDataType\":protected]=>\n  string(0) \"\"\n  [\"guestsCanInviteOthers\"]=>\n  NULL\n  [\"guestsCanModify\"]=>\n  NULL\n  [\"guestsCanSeeOtherGuests\"]=>\n  NULL\n  [\"hangoutLink\"]=>\n  NULL\n  [\"htmlLink\"]=>\n  NULL\n  [\"iCalUID\"]=>\n  NULL\n  [\"id\"]=>\n  NULL\n  [\"kind\"]=>\n  NULL\n  [\"location\"]=>\n  string(0) \"\"\n  [\"locked\"]=>\n  NULL\n  [\"organizerType\":protected]=>\n  string(38) \"Google_Service_Calendar_EventOrganizer\"\n  [\"organizerDataType\":protected]=>\n  string(0) \"\"\n  [\"originalStartTimeType\":protected]=>\n  string(37) \"Google_Service_Calendar_EventDateTime\"\n  [\"originalStartTimeDataType\":protected]=>\n  string(0) \"\"\n  [\"privateCopy\"]=>\n  NULL\n  [\"recurrence\"]=>\n  NULL\n  [\"recurringEventId\"]=>\n  NULL\n  [\"remindersType\":protected]=>\n  string(38) \"Google_Service_Calendar_EventReminders\"\n  [\"remindersDataType\":protected]=>\n  string(0) \"\"\n  [\"sequence\"]=>\n  NULL\n  [\"sourceType\":protected]=>\n  string(35) \"Google_Service_Calendar_EventSource\"\n  [\"sourceDataType\":protected]=>\n  string(0) \"\"\n  [\"startType\":protected]=>\n  string(37) \"Google_Service_Calendar_EventDateTime\"\n  [\"startDataType\":protected]=>\n  string(0) \"\"\n  [\"status\"]=>\n  NULL\n  [\"summary\"]=>\n  string(4) \"Test\"\n  [\"transparency\"]=>\n  NULL\n  [\"updated\"]=>\n  NULL\n  [\"visibility\"]=>\n  NULL\n  [\"modelData\":protected]=>\n  array(0) {\n  }\n  [\"processed\":protected]=>\n  array(0) {\n  }\n  [\"start\"]=>\n  object(Google_Service_Calendar_EventDateTime)#315 (6) {\n    [\"internal_gapi_mappings\":protected]=>\n    array(0) {\n    }\n    [\"date\"]=>\n    NULL\n    [\"dateTime\"]=>\n    string(25) \"2016-12-02T09:45:00+01:00\"\n    [\"timeZone\"]=>\n    NULL\n    [\"modelData\":protected]=>\n    array(0) {\n    }\n    [\"processed\":protected]=>\n    array(0) {\n    }\n  }\n  [\"end\"]=>\n  object(Google_Service_Calendar_EventDateTime)#316 (6) {\n    [\"internal_gapi_mappings\":protected]=>\n    array(0) {\n    }\n    [\"date\"]=>\n    NULL\n    [\"dateTime\"]=>\n    string(25) \"2016-12-02T11:15:00+01:00\"\n    [\"timeZone\"]=>\n    NULL\n    [\"modelData\":protected]=>\n    array(0) {\n    }\n    [\"processed\":protected]=>\n    array(0) {\n    }\n  }\n  [\"reminders\"]=>\n  object(Google_Service_Calendar_EventReminders)#317 (8) {\n    [\"collection_key\":protected]=>\n    string(9) \"overrides\"\n    [\"internal_gapi_mappings\":protected]=>\n    array(0) {\n    }\n    [\"overridesType\":protected]=>\n    string(37) \"Google_Service_Calendar_EventReminder\"\n    [\"overridesDataType\":protected]=>\n    string(5) \"array\"\n    [\"useDefault\"]=>\n    bool(false)\n    [\"modelData\":protected]=>\n    array(0) {\n    }\n    [\"processed\":protected]=>\n    array(0) {\n    }\n    [\"overrides\"]=>\n    array(1) {\n      [0]=>\n      array(2) {\n        [\"method\"]=>\n        string(5) \"popup\"\n        [\"minutes\"]=>\n        int(30)\n      }\n    }\n  }\n}\n```\nCan you help me ? Thank you all !\n. ",
    "moiseevigor": "Any insight on this issue? Have the same problem with reminders\n```\n  function createEvent($ev)\n  {\n    $event = new Google_Service_Calendar_Event();\n    $event->setSummary($ev['title']);\n    $event->setLocation($ev['where']);\n    $event->setDescription($ev['desc']);\n$start = new Google_Service_Calendar_EventDateTime();\n$end = new Google_Service_Calendar_EventDateTime();\n\nif($ev['allday'])\n{\n  $start->setDate($ev['startDate']);\n  $end->setDate($ev['endDate']);\n}\nelse\n{\n  $start->setDateTime(\"{$ev['startDate']}T{$ev['startTime']}:00.000{$ev['tzOffset']}:00\");\n  $end->setDateTime(\"{$ev['endDate']}T{$ev['endTime']}:00.000{$ev['tzOffset']}:00\");\n}\n\n$event->setStart($start);\n$event->setEnd($end);\n$event->setAttendees($ev['attendees']);\n\nif(isset($event['reminder']) && $event['reminder'])\n{\n  $reminders = new Google_Service_Calendar_EventReminders();\n  $reminders->setUseDefault(false);\n\n  $reminder = new Google_Service_Calendar_EventReminder();\n  $reminder->setMethod('email');\n  $reminder->setMinutes(24 * 60);\n\n  $reminders->setOverrides(array($reminder));\n  $event->setReminders($reminders);\n}\n\ntry {\n  $createdEvent = $this->service->events->insert($ev['id_google_calendar'], $event);\n} catch(Exception $e) {\n  Sys::exceptionHandler($e);\n  return array(\n    'status' => $e->getCode(),\n    'message' => $e->getMessage(),\n    'body' => $e->getTraceAsString(),\n    'id_google_calendar' => null);\n}\n\nreturn array(\n  'status' => '200',\n  'message' => '',\n  'body' => json_encode($createdEvent),\n  'id_google_calendar' => $createdEvent->getId()\n);\n\n} // END FUNCTION createEvent\n```\nThe I see in returned body\n{\n    \"anyoneCanAddSelf\": null,\n    \"attendeesOmitted\": null,\n    \"colorId\": null,\n    \"created\": \"2017-04-07T16:02:54.000Z\",\n    \"description\": \"Note: \",\n    \"endTimeUnspecified\": null,\n    \"etag\": \"\\\"2983161949118000\\\"\",\n    \"guestsCanInviteOthers\": null,\n    \"guestsCanModify\": null,\n    \"guestsCanSeeOtherGuests\": null,\n    \"hangoutLink\": null,\n    \"htmlLink\": \"https:\\/\\/www.google.com\\/calendar\\/event?eid=b2NwYTJua28zdHY2djhqMWkwMzNtazVfOGcgdGtndGloYm5zNzdtcHZlN3RoZ3JpNGpmZjRAZw\",\n    \"iCalUID\": \"ocpa2nko3tv6v3j5i033mk3k87@google.com\",\n    \"id\": \"ocpa2nko4tv6v3j1i335mk5k8g\",\n    \"kind\": \"calendar#event\",\n    \"location\": null,\n    \"locked\": null,\n    \"privateCopy\": null,\n    \"recurrence\": null,\n    \"recurringEventId\": null,\n    \"sequence\": 0,\n    \"status\": \"confirmed\",\n    \"summary\": \"test 123\",\n    \"transparency\": null,\n    \"updated\": \"2017-04-07T16:02:54.559Z\",\n    \"visibility\": null\n}. ",
    "balrog2000": "This works for me well:\n\n    $reminders = new Google_Service_Calendar_EventReminders();\n    $reminders->setUseDefault(false);\n    $reminders->setOverrides([\n        [\n            \"method\"    => \"popup\",\n            \"minutes\"   => 5,\n        ],\n        [\n            \"method\"    => \"popup\",\n            \"minutes\"   => 60,\n        ],\n        [\n            \"method\"    => \"popup\",\n            \"minutes\"   => 60 * 24,\n        ],\n    ]);\n    $event->setReminders($reminders);\n\n. \n",
    "Janmay": "It works well via the API explorer. With the client library I use service account to access API, and it's ok for Analytics API and Site Verification API.  There is not warning or error to access Webmasters API. It just like that I have not verified sites, which actually I does, and via Site Verification API I can get them.\n. I have already verified my service account email as owner of sites. It did not work.\n. ",
    "shuler": "I've added service account email as a simple user with restricted permission in Google Search Console and it worked for me\n. ",
    "noyfactor": "For future reference - I'm an idiot. It just doesn't show on the page, I assume it's because of the < and > .\n3 hours of work down the drain.\n. ",
    "goldsky": "Ok, just have played the api a bit,\nI made a simple upload form:\n_uploadFile.php_\n``` php\n<?php\nrequire_once dirname(dirname(FILE)) . DIRECTORY_SEPARATOR . 'google-api-php-client/autoload.php';\nsession_start();\ndefine('GCS_APP_NAME', 'Google Cloud Storage PHP Starter Application');\ndefine('GCS_EMAIL_ADDRESS', '{{DELETED}}@developer.gserviceaccount.com');\ndefine('GCS_PRIMARY_KEY_FILE', '{{DELETED}}.p12');\nif (!file_exists(GCS_PRIMARY_KEY_FILE)) {\n    die('missing the location of primary key file, given: ' . GCS_PRIMARY_KEY_FILE);\n}\ndefine('GCS_CLIENT_ID', '{{DELETED}}.apps.googleusercontent.com');\ndefine('GCS_DEFAULT_BUCKET_NAME', '{{DELETED}}');\ndefine('GCS_SCOPES', serialize(array('https://www.googleapis.com/auth/devstorage.full_control')));\n$client = new Google_Client();\n$client->setApplicationName(GCS_APP_NAME);\n$client->setClientId(GCS_CLIENT_ID);\n$client->setScopes(unserialize(GCS_SCOPES));\n$service = new Google_Service_Storage($client);\nif (isset($_SESSION['service_token'])) {\n    $client->setAccessToken($_SESSION['service_token']);\n}\n$key = file_get_contents(GCS_PRIMARY_KEY_FILE);\n$cred = new Google_Auth_AssertionCredentials(\n        GCS_EMAIL_ADDRESS\n        , unserialize(GCS_SCOPES)\n        , $key\n);\n$client->setAssertionCredentials($cred);\nif ($client->getAuth()->isAccessTokenExpired()) {\n    $client->getAuth()->refreshTokenWithAssertion($cred);\n}\n$_SESSION['service_token'] = $client->getAccessToken();\nif (isset($_FILES['fileToUpload']) && !empty($_FILES['fileToUpload'])) {\n    $file = $_FILES['fileToUpload'];\n    $ext = @pathinfo($file['name'], PATHINFO_EXTENSION);\n    $ext = strtolower($ext);\n    $size = @filesize($file['tmp_name']);\n/**\n * Upload the file\n */\n$filePath = $file['tmp_name'];\n$fileName = $file['name'];\n$handle = fopen($filePath, \"rb\");\nfseek($handle, 0);\n$postBody = new Google_Service_Storage_StorageObject();\n$postBody->setName($fileName);\n$postBody->setUpdated(date(\"c\"));\n$postBody->setGeneration(time());\n$postBody->setSize($size);\n$postBody->setContentType($file['type']);\n$chunkSizeBytes = 1 * 1024 * 1024;\n$client->setDefer(true);\n$request = $service->objects->insert(GCS_DEFAULT_BUCKET_NAME, $postBody, array(\n    'name' => $fileName,\n    'projection' => 'full',\n    'uploadType' => 'resumable',\n));\n$media = new Google_Http_MediaFileUpload(\n        $client, $request, $file['type'], null, true, $chunkSizeBytes\n);\n$media->setFileSize($size);\n$status = false;\nwhile (!$status && !feof($handle)) {\n    $chunk = fread($handle, $chunkSizeBytes);\n    $status = $media->nextChunk($chunk);\n}\nfclose($handle);\n// this was the error:\n// $client->setDefer(true);\n$client->setDefer(false);\n\n/**\n * Apply ACL\n */\n$acl = new Google_Service_Storage_ObjectAccessControl();\n$acl->setEntity('allUsers');\n$acl->setRole('READER');\n// this was the error:\n// $service->objects->objectAccessControls->insert(GCS_DEFAULT_BUCKET_NAME, $fileName, $acl);\n$service->objectAccessControls->insert(GCS_DEFAULT_BUCKET_NAME, $fileName, $acl);\n\n}\n?>\n<!DOCTYPE html>\n\n\n\n            Select file to upload:\n\n\n\n\n\n```\nThe file was uploaded successfully, but the ACL returned FATAL ERROR\n```\nNotice: Undefined property: Google_Service_Storage_Objects_Resource::$objectAccessControls in D:\\localhost\\google-cloud\\jajal\\uploadFile.php on line 81\nFatal error: Call to a member function insert() on a non-object in D:\\localhost\\google-cloud\\jajal\\uploadFile.php on line 81\n```\n. Crap, found the problem\nWhen uploading the file, the loop still has $client->setDefer(true); at end of the loop.\nAnd, on plain example:\nphp\n$service->objects->objectAccessControls->insert(GCS_DEFAULT_BUCKET_NAME, $fileName, $acl);\nsupposed to be\nphp\n$service->objectAccessControls->insert(GCS_DEFAULT_BUCKET_NAME, $fileName, $acl);\nSorry for disturbing.\n. ",
    "eRadical": "I can do some basic examples.\n@ianbarber is it ok if I add examples in \"examples/Service/Bigquery\"... (thus mimicking the structure of the client library) ?\n. @ianbarber  I started a repo as you said at https://github.com/eRadical/google-api-php-client-examples \nI'll be happy to merge pull request that will enrich it.\nI know I've digged into the API myself for an AppEngine & BigQuery application... maybe it will be of help.\n. I have started a repo with examples at https://github.com/eRadical/google-api-php-client-examples\nIt's not much yet but I hope it will grow over time.\n. A \"recommended\" section should be introduced but the library should not \u00abforce\u00bb a version for education purpose. The \"minimum\" is as it says \u00abminimum\u00bb = if you are going to use it with a previous version than the \"minimum\" the library is not going to be functional. Functionality is already crippled under 5.2.x.\nA library purpose is to offer functionality not enforce a version.\nYES... we definitely need to put pressure on DevOps and/or system administrators to upgrade PHP version... but that is completely another thing.\n[Please don't get me wrong I personally use 5.5 and do not have any server with PHP under 5.4... but I make it my business to be interested in this.]\n. Having the same issue:\n[message:protected] => HTTP Error: Unable to connect: 'fopen(https://www.googleapis.com/bigquery/v2/projects/%PROJECT-ID%/jobs): failed to open stream: Unsupported SSL context options are set. The following options are present, but have been ignored: cafile\nFetch error'\n    [string:Exception:private] => \n    [code:protected] => 2\n    [file:protected] =>....................vendor/google/apiclient/src/Google/IO/Stream.php\n    [line:protected] => 141\nEdit:\nForgot to mention it is intermittent!\n. @bshaffer AppEngine has no 'cafile' option... This is the reason of pull request #631 .\n. @nebadom  the pull request #631  was not merged yet!\n. @mxmz- The new version uses Guzzle behind the scenes which as I've seen adds the two options.\nStill looking for a way to disable that!\n. Yes... Guzzle forces those options. And I don't think there is a way of turning them off.\nFor now after `composer install ' I comment the code from within the Guzzle lib.\nYes it's not perfect but it gives me clear/clean logs.\n. This fix is rather worrisome...\nWhat it actually means is that you are moving from CURL_SSLVERSION_TLSv1 (that is TLS v1.x) to CURL_SSLVERSION_SSLv3 which was deprecated recently (SSLv3 is disabled by default since version 7.39.0 or curl library).\nAt a given time in future (when PHP will catch up with the curl library) the code will probably error out.\nHave you tried commenting out the line?... Thus leaving the curl library to decide what \"ssl\" version to use as this is the default behavior in curl (quote: CURL_SSLVERSION_DEFAULT \u00bb The default action. This will attempt to figure out the remote SSL protocol version.)\n. I'm sure in the long term will pay off.\nAre you going to make a pull request out of it?\n[ I can do that if you don't want/have time! ]\n. @bshaffer Any thoughts on this one?\n. Worst case... there might be servers without TLS \u00bb as a radical response we can say \"suits them well\".\nThe problem is in negotiation as CURL_SSLVERSION_DEFAULT assures the negotiation from within the underlying curl library.\nSetting a fixed protocol breaks negotiation as the connection will be tried only at that version.\nPHP page recommends not setting any value for CURLOPT_SSLVERSION see: http://php.net/manual/en/function.curl-setopt.php\nAt http://curl.haxx.se/libcurl/c/CURLOPT_SSLVERSION.html it is mentioned that \n- SSLv2 is disabled by default since 7.18.1\n- SSLv3 is disabled by default since 7.39.0\n  If someone has an older curl library then it means it is not interested that much in security anyway...\nThe other drawback is that setting it to 1 which is CURL_SSLVERSION_TLSv1 means that the library will only try with TLS 1.0... thus ignoring possible existing TLS 1.1 or TLS 1.2.\nI still think it's a better option.\n. @bshaffer Is this ok?\n. This was already discussed in Case #639 and addressed in Pull Request #644 .\n. I'll test tomorrow to see if all is ok w/ Monolog\\Handler\\SyslogHandler and let you know!\n. All checks are ok!\n. The shorthand version\n$a = ['short', 'version'];\nwas introduced in PHP 5.5!\nYou need to upgrade to at least that version... but... that version is now unsupported so you should really go all the way to PHP 5.6. At the time I write this you have 4 month of active development pr PHP5.6.\n. Can you please close this issue?\n. ",
    "FlashT": "Thank You!\n16 sty 2015 16:11 \"Gabriel PREDA\" notifications@github.com napisa\u0142(a):\n\nI can do some basic examples.\n@ianbarber https://github.com/ianbarber is it ok if I add examples in\n\"examples/Service/Bigquery\"... (thus mimicking the structure of the client\nlibrary) ?\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/453#issuecomment-70266709\n.\n. \n",
    "damienfa": "Yes, I need it too !\n. ",
    "spolischook": ":+1:  Please, it's needed. People that already use namespaces - can't live without it\n. ",
    "joglomedia": "How about creating a new branch for refactoring the codebase in standard\nPSR? So, we can contribute on this new branch\nOn Feb 8, 2015 5:22 PM, \"Sergey Polischook\" notifications@github.com\nwrote:\n\n[image: :+1:] Please, it's needed. People that already use namespaces -\ncan't live without it\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/454#issuecomment-73405025\n.\n. Hai  google/google-api-php-client, \n\nCoba tebak - Aku akan penuhi keinginan kamu! \nAku kirimkan voucher Rp 75.000 sehingga kamu bisa mendapatkan apa yang ada di wishlist kamu. \nSelamat berbelanja! \n[1] ACCEPT GIFT > \n Links\n  1 - http://t.bhm02.net/018m3py3a1gf9IrCoDBwtIW2aYF8UtrXntj7Xvps_9ARBaSEA5EKPqEuFRjxMRiBPkngSIqwcYpYQnPvJn8pX8BnWbiRW6ehn6pzvDB6oH13U5DVIdDLQp2fUGKcnuCf78ae5lNse3Ir8Dx65DFRJSw_hC1a5DCbSLi50rUGUpznbDXdxXHDPqXZWGIf8etRPFjAqHQ5RA03X1YG6F2e_m1Q://api.sociablelabs.net/shortlink/api/shortlinks/100319262752653312/follow\nZalora secara otomatis akan memasukkan kamu dalam daftar penerima Newsletter saat kamu menerima hadiah dari teman. Kamu dapat memilih untuk  [2] unsubscribe  setiap saat. \n Links\n  2 - http://t.bhm02.net/018m3py3a1gf9IrCoDBwtIW2aYF8UtrXntj7Xvps_9ARBaSEA5EKPqEuFRjxMRiBPkngSIqwcYpYQnPvJn8pX8BnWbiRW6ehn6pzvDB6oH13U5DVIdDLQp2fUGKcnuCf78ae5lNse3Ir8Dx65DFRJSw_hC1a5DCbSLi50rUGUpznbDXdxXHDPqXZWGIf8etRPFjAqHQ5RA03X1YG6F2e_m1Q://api.behavemail.net/unsub/5qkj4lpw3yxfuomt2kxnra3hxn2kwc4micw3moiexday4oceefy5drznwaccbdhnnssgw36nb2zukjjvw5fxvqsdilcrmm3sb3ym6djm5rfl4dtyj3qkeyowjuzrypqzhpm6fqqrj76mkcdj7pbo5wlz34hynj6x3m2ogng2ejshczdqak3edw2j442hzfycl3zryvdqhqjzlpgm45hwhfwzoqu4xsixv75x6otb4daxwo6x3khzqfmgt7c3rw5hg3rkp264pyrl3u3wwqftvf464txpokkpeohgmb3za34p6dk7qvgsjn7c2jzssfq5srbeiy3jo6tbrmhys6iqgcziojpmi4wsxybklpbhtfo4cglha4o4fn4jre2gahlkctcb7gbbmpin3b5xue6bvteo32u5nrtv4kpyuopmrd5wewhnw3zr5bftbyov72ehz4ifny2h7b4rw\nDengan berkunjung ke alamat email di atas, kamu menyetujui  [3] Syarat & Kebijakan Zalora  dan menerima pemberitahuan tentang penawaran dan promo Zalora. \n Links\n  3 - http://t.bhm02.net/018m3py3a1gf9IrCoDBwtIW2aYF8UtrXntj7Xvps_9ARBaSEA5EKPqEuFRjxMRiBPkngSIqwcYpYQnPvJn8pX8BnWbiRW6ehn6pzvDB6oH13U5DVIdDLQp2fUGKcnuCf78ae5lNse3Ir8Dx65DFRJSw_hC1a5DCbSLi50rUGUpznbDXdxXHDPqXZWGIf8etRPFjAqHQ5RA03X1YG6F2e_m1Q://www.zalora.co.id/privacy-policy/\nUnit A-5-1, Level 5, Block A, Southgate Commerical Centre \n No. 2, Jalan Dua, Off Jalan Chan Sow Lin \n 55200 Kuala Lumpur \n\u00a9 2015. Zalora atau perusahaan afiliasi. Hak Cipta Dilindungi Undang-Undang. \n. ",
    "freekmurze": "I'm looking for a clear example on how to use a Service account json file can be used? It's not clear how the aformentioned Google_Client:loadServiceAccountJson should be used. Is there any documentation on this?\n. ",
    "adamellsworth": "@freekmurze it looks like it's going to be deprecated (setAuthConfig preffered):\nhttps://github.com/google/google-api-php-client/blob/18dd5534280318598e8770cb7929e9a542e91c0d/UPGRADING.md#google_auth_assertioncredentials-has-been-removed\n. ",
    "r3wt": "Full code:\n``` php\n//configuration file\nrequire DIR . DIRECTORY_SEPARATOR . 'libs' . DIRECTORY_SEPARATOR . 'bootstrap.php';\n$client = new Google_Client();\n$client->setApplicationName($app_name);\n$client->setClientId($client_id);\n$client->setClientSecret($client_secret);\n$client->setRedirectUri($redirect_uri);\n$client->setScopes('https://www.googleapis.com/auth/contacts.readonly');\n@$do = $_GET['do'] or null;\nswitch($do) {\n    case 'logout':\n        unset($_SESSION['access_token']);\n        header('Location:'. $login_uri);\n    break;\n    case 'login':\n        if(isset($_SESSION['access_token'])){\n            header('Location: '. $loggedin_uri);\n        } else {\n            echo \"\";\n        }\n    break;\n    case 'loggedin':\n        @$cmd = $_GET['command'] or null;\n        if (isset($_SESSION['access_token'])) {\n            $_SESSION['access_token'] = $client->getAccessToken();\n            $token_data = $client->verifyIdToken()->getAttributes();\n            $client->setAccessToken($_SESSION['access_token']);\n            //process commands\n        } else {\n            die('client not authenticated!');\n        }\n    break;\n    default:\n        if (isset($_GET['code'])) {\n        $client->authenticate($_GET['code']);\n        $_SESSION['access_token'] = $client->getAccessToken();\n        header('Location: ' . $loggedin_uri);\n    }\n    else if (isset($_SESSION['access_token'])) {\n        header('Location: ' . $loggedin_uri);\n    } else {\n        header('Location: ' . $login_uri);\n    }\nbreak;\n\n}\n``\n. i can see that it is expecting a string with 3.however the issued json token has exactly 1.and 2-` in the \"access_token\" property of the json. could you please clarify if the api has changed, and this library is just out of date?\n. bump\n. ",
    "mukund-indianic": "I am not able to retrieve any attributes with getAttributes(), returns following error: \nCall to a member function getAttributes() on array\nScope: \n 'https://www.googleapis.com/auth/userinfo.profile', \n'https://www.googleapis.com/auth/plus.me', \n'https://www.googleapis.com/auth/userinfo.email'\n$auth = $this->google_client->authenticate($_GET['code']);\n$r = $this->google_client->verifyIdToken();\nif($r){\n        $user_data = $r->getAttributes();\n}\nWhen I pass access_token to verifyIdToken it returns empty result\nex.$r = $this->google_client->verifyIdToken($auth['access_token']);\nelse verifyIdToken will return array\nAnd also how would I get gender, birthdate etc socpes.\n. ",
    "bgold0": "I get this same error. This simple code does it:\n$payload = $googleClient->verifyIdToken($token);. This is happening to me too. Anyone who has found any other information please let me know\n\n. ",
    "theacodes": "Submitted PR #458 for the initial stab. I wasn't sure if I should create a new test class for this or if I should extend the existing one. @ianbarber PTAL? \n. Satisfied by PR #458.\n. Will do tomorrow or Friday. I should be able to mock the http call to the\nmetadata server. Thanks!\nOn Wed, Jan 21, 2015, 5:55 PM Ian Barber notifications@github.com wrote:\n\nThanks! I would do a separate test, and make sure to skip it if not\nrunning on compute engine I guess.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/458#issuecomment-70939117\n.\n. Added the tests - pretty straightforward as I mostly adapted the tests from the regular OAuth2 test cases. @ianbarber PTAL, let me know if there's anything else needed here. Additionally, I can add an example if desired.\n. No problem!\n. @bshaffer I'm going to merge this as the text here has been approved by myself and danom and is being broadly applied to all languages, but holler if you have any concerns.. Hi @teo1978! I think the missing piece of the puzzle is that if you use access type offline and you've already gotten a refresh token at some point in the past, the authorization service will only give you an access token. You need to do prompt='consent' (which is documented somewhere in this long page).\n\nAnd yes, in general you need to keep the access token given as long as possible - basically, keep it until it fails to get a new access token - then, mark it as invalid and prompt the user again.\nI'm going to go ahead and close this, but if you need any more help please feel free to comment.\n. ",
    "Kak3n": "Hello could I ask how exactly I can set cURL options?\n. thanks btw what is the difference betwen v1 and v2?\nD\u0148a streda, 25. m\u00e1ja 2016 Brent Shaffer notifications@github.com\nnap\u00edsal(a):\n\n@Kak3n https://github.com/Kak3n if you are using v2, you would set them\nthrough the guzzle library. See this page\nhttp://docs.guzzlephp.org/en/latest/request-options.html for more info.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/461#issuecomment-221641612\n. thanks.\n\n2016-05-25 20:51 GMT+02:00 Brent Shaffer notifications@github.com:\n\nv2 is the current version, but the docs on developer.google.com have not\nbeen updated for them yet. If you are just starting your project, use v2\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/461#issuecomment-221670772\n. Should it be fixed in newest version?\n. thanks ok.\n\n2016-05-25 18:49 GMT+02:00 Brent Shaffer notifications@github.com:\n\n@Kak3n https://github.com/Kak3n v2.0.0-RC5\nhttps://github.com/google/google-api-php-client/releases and on have\nhad this change.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/828#issuecomment-221632975\n. \n",
    "riggsfolly": "I have to admit, that an example would be very useful.\nI know contacts has not been moved up to the V3 api, but a sample using OAuth2 from the V3 api and a suggested mechanism to access the Contacts would be Very Much Appreciated.\nAny chance one of you Google bods could put something together for us meer mortals to follow.\nI have been trying to make use of as much of the V3 Api as possible to access contacts in a similiarly elegant ways as is done for other service but I admit I am struggling a bit.\n. This code works, but it is not very pretty. Its based on one of the other google-api-php-client examples, so you will have to install the google-api-php-client to get it to work.\nAll it does it return the Contacts in json format, it does nothing with them as yet.\nI have hidden the keys etc in another include So you will have to fiddle with this bit\nrequire_once $_SERVER['DOCUMENT_ROOT'] . '/../googleapi.secrets/secrets.inc.php';\nAnyway, here it is, for what its worth, if you make any headway to an elegant solution please let me know.\n```\n <?php\n/\n * Copyright 2011 Google Inc.\n \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n \n *     http://www.apache.org/licenses/LICENSE-2.0\n \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\ninclude_once \"templates/base.php\";\nsession_start();\nrequire_once $_SERVER['DOCUMENT_ROOT'] . '/../googleapi.secrets/secrets.inc.php';\nrequire_once realpath(dirname(FILE) . '/includes/googleapi/autoload.php');\n/********\n  ATTENTION: Fill in these values! Make sure\n  the redirect URI is to this page, e.g:\n  http://localhost:8080/user-example.php\n **********/\n$client_id = GOOGLE_API_CLIENT_ID;\n$client_secret = GOOGLE_API_CLIENT_SECRET;\n$scriptUri = \"http://\".$_SERVER[\"HTTP_HOST\"].$_SERVER['PHP_SELF'];\n$redirect_uri = $scriptUri;\n/********\n  Make an API request on behalf of a user. In\n  this case we need to have a valid OAuth 2.0\n  token for the user, so we need to send them\n  through a login flow. To do this we need some\n  information from our API console project.\n **********/\n$client = new Google_Client();\n$client->setClientId($client_id);\n$client->setClientSecret($client_secret);\n$client->setRedirectUri($redirect_uri);\n//$client->addScope(\"https://www.googleapis.com/auth/contacts.readonly\");\n$client->addScope(\"https://www.google.com/m8/feeds\");\n/********\n  A general service created\n **********/\n//$contacts = new Google_Service($client);\n/********\n  Boilerplate auth management - see\n  user-example.php for details.\n **********/\nif (isset($_REQUEST['logout'])) {\n  unset($_SESSION['access_token']);\n}\nif (isset($_GET['code'])) {\n  $client->authenticate($_GET['code']);\n  $_SESSION['access_token'] = $client->getAccessToken();\n  $redirect = 'http://' . $_SERVER['HTTP_HOST'] . $_SERVER['PHP_SELF'];\n  header('Location: ' . filter_var($redirect, FILTER_SANITIZE_URL));\n}\nif (isset($_SESSION['access_token']) && $_SESSION['access_token']) {\n  $client->setAccessToken($_SESSION['access_token']);\n} else {\n  $authUrl = $client->createAuthUrl();\n}\n/********\n  If we're signed in, retrieve contacts\n **********/\nif ($client->getAccessToken()) {\n  $_SESSION['access_token'] = $client->getAccessToken();\n$access_token = json_decode($client->getAccessToken())->access_token;\n//$url = 'https://www.google.com/m8/feeds/contacts/default/full?max-results=3&alt=json&v=3.0&oauth_token='.$access_token;\n  $url = 'https://www.google.com/m8/feeds/contacts/default/full?alt=json&v=3.0&oauth_token='.$access_token;\n$response =  file_get_contents($url);\n}\necho pageHeader(\"User Query - Multiple APIs\");\nif (\n    $client_id == ''\n    || $client_secret == ''\n    || $redirect_uri == '') {\n  echo missingClientSecretsWarning();\n}\n?>\n\n\n<?php\nif (isset($authUrl)) {\n  echo \"Connect Me!\";\n} else {\n  echo \"Results Of Contacts List:\";\n  //$t = str_replace(\"\\n\", '', $response);\n  $j = json_decode($response);\n  echo print_r($j);\n  file_put_contents('d:\\php_source\\tst.json', $response);\n}\n?>\n  \n\n<?php echo pageFooter(FILE);\n```\n. ",
    "keevitaja": "@riggsfolly do you have some working code you could share or nothing at all?\n. @riggsfolly thank you so much!\n. @riggsfolly i know, why google does not provide any official support :) it is xml hell!\nhttp://laravel.io/bin/jQan3#\nTo get the elements i turn this xml to dom document and access it with xpath. I think it is only reasonable solution as there are just some many element types.\n. So, this what i came up with. I used Laravel 5 to build it, but there is not much Laravel going on...\nhttps://github.com/keevitaja/google-contacts-api-hell/blob/master/app/Http/Controllers/HomeController.php\nhttps://github.com/keevitaja/google-contacts-api-hell/tree/master/app/Services/GoogleApi\n```\narray(1) {\n    [\"fullName\"] \"Firstname Lastname\"\n}\narray(1) {\n    [\"orgName\"] \"test_company\"\n}\narray(1) {\n    [\"email\"] array(2) {\n        [\"work\"] \"kala@kala.ee\"\n        [\"home\"] \"test@test.ee\"\n    }\n}\narray(1) {\n    [\"phoneNumber\"] array(2) {\n        [\"mobile\"] \"+372555555\"\n        [\"work\"] \"+372555666\"\n    }\n}\n```\n. @ianbarber any idea why i get bad request while updating the contact?\nthis is the xml: http://laravel.io/bin/oke2w\nand here is the code i am using:\nhttps://github.com/keevitaja/google-contacts-api-hell/blob/master/app/Http/Controllers/HomeController.php#L77\nhttps://github.com/keevitaja/google-contacts-api-hell/blob/master/app/Services/GoogleApi/XmlParser.php\ni get the contact data, modify it and try to put it back... doesn't work.\n. ",
    "net-tools": "Hi,\nI don't know if it will help you : http://www.ibm.com/developerworks/xml/library/x-phpgooglecontact/index.html. The Auth part is using old Zend framework.\nAlso, if you want to use this google-api-php-client API, you can easily rewrite the Auth part to use google-api-php-client API. That's what I did last year.\nFor example  : \n$req =new Google_Http_Request($id, 'PUT', array('If-Match'=>$etag, 'content-type'=>'application/atom+xml'), $xml);\n$response = $client->getAuth()->authenticatedRequest($req);\n$body = $response->getResponseBody();\n$id is the contact id field found in the xml data retrieved previously.\n$etag is a mandatory header field ; you should use the etag value which you will find in the xml data\n$xml is a xml formatted string with updated contact data.\n$client is a Google_Client object.\nAlso, the api documentation is quite useful : https://developers.google.com/google-apps/contacts/v3/index#getting_started as it explains the protocol and required parameters.\n. Hi,\nThanks for this work. I may use it in the future, as my XML handling is a nightmare compared to yours... !\n. Although I don't see the point of answering to a 2 years old post, here is my late contribution to this thread. Some months ago, I wrote a PHP library implementing missing Google services API in the official lib : CloudPrint and Contacts.\nThe Github page is here and a specific readme file for CloudPrint is here.. Hi Ruben,\nAre still looking for a Contacts service ? If so, I'm currently working on a PHP library handling all dirty stuff with the raw http Contacts API. The library is looking like all other Google PHP libraries, such as Calendar or Gmail. \nFor example, to create a contact, you will do : \n```php\n    // creating a contact\n    $c = new Contact();\n    $c->familyName = 'Smith';\n    $c->givenName = 'John';\n    $c->title = $c->givenName . ' ' . $c->familyName;\n    $c->emails = array((object)array(\n                                'address' => 'john.smith@test.com',\n                                'primary' => true,\n                                'rel' => Contact::TYPE_HOME\n                            ));\n// send the request to create the contact and get an updated Contact object with etag, links and other api-related stuff\n$newc = $service->contacts->create($c);\n\n```\nIf you are interested, I will give you all required information (as the Readme file on the repository is a bit messy actually, I will have to split it in several files...). Code updated with new Batch.php, everything works as expected ! Thanks.\n. I signed it!\n. Typo error has been corrected, sorry !\n. Thanks for replying so quickly, since I was not sure how this issue could be solved on my side (I'm not experienced in the Google auth process). \nSince I'm not concerned by the cache issue with multiple users (for the time being, my application is single-user), I'm using the Client (RC4) file ; as soon as the caching issue is solved I will update it.\nThanks again, have a nice day!\n. Hi,\nAfter some tests with RC5 and the Client class no longer caching tokens, here are some details about circumstances when the issue mentionned in my first post occurs (or NOT occur) : \n- issue occurs when using tokens that have been first obtained with setAccessType('offline') ; offline tokens include a refresh token that is used to fetch a new short-lived token.\n- issue occurs when the PHP library automatically refreshes the expired token (first request is OK, token is refreshed ; second request throws an exception)\n- issue does NOT occur when we are manually refreshing the expired token in our application :\n```\n// we assume that the token is stored in database or some persistent storage (that's the aim \n// of using offline tokens) ; we set the token in the library\n$client->setAccessToken($our_token);\n// testing if token is expired (that's true if it has been first obtained more \n// than our hour ago)\nif ( $client->isAccessTokenExpired() )\n{\n    // manually refreshing the token ; the library returns a short-lived token that\n    // is valid for one hour\n    $token = $client->fetchAccessTokenWithRefreshToken($our_token['refresh_token']);\n// do some stuff with the short-live token obtained\n\n}\n```\nMaybe I was not using the API the right way (letting it refreshing the token as needed). Now, by manually refreshing the token (if needed), RC5 is fine.\n. Oh yes ! That's the first thing I tried ! \nI saw the logic in Client.php, and I still can't figure out why it's not working as expected. I tried to insert debug print_r at critical lines in Client.php to see what was going on, but I had to admit this was beyond my knowledge (and required debug time !).\nAll I can say is that RC4 and caching is fine, RC5 with caching deactivated has this issue.\nTo be more precise : the issue does not occur as long as the newly fetched token is active (one hour). After that delay, the token stored in access_token is expired and must be refreshed by the library. This is the case where the issue occurs : access token is expired and we have to work with refreshed tokens.\nThe first request is handled correctly, the expired token is refreshed, but if it's followed in the source code by a second request, the second one fails (the token is not refreshed, and the \"old\" expired one is used). \nThis use case is typical of reading data, modifying stuff, and writing back to Google any changes.\nI had a long 2 hours debug session last week-end but I failed to conclude anything about why this does not work as expected...\n. Here is the print_r output of line 351 (sensitive data replaced by dummy values) ; the code I use is reading data, and then writing by updated data, so there's two refreshed tokens used. But the second one fails to be fetched (it fails at line 83 in /vendor/google/auth/src/Credentials/UserRefreshCredentials.php, that 's what some debug here told me) :\n$this->auth->fetchAuthToken($httpHandler); \ndebug data :\n```\nGoogle\\Auth\\Credentials\\UserRefreshCredentials Object\n(\n    [auth:protected] => Google\\Auth\\OAuth2 Object\n        (\n            [authorizationUri:Google\\Auth\\OAuth2:private] => \n            [tokenCredentialUri:Google\\Auth\\OAuth2:private] => GuzzleHttp\\Psr7\\Uri Object\n                (\n                    [scheme:GuzzleHttp\\Psr7\\Uri:private] => https\n                    [userInfo:GuzzleHttp\\Psr7\\Uri:private] => \n                    [host:GuzzleHttp\\Psr7\\Uri:private] => www.googleapis.com\n                    [port:GuzzleHttp\\Psr7\\Uri:private] => \n                    [path:GuzzleHttp\\Psr7\\Uri:private] => /oauth2/v3/token\n                    [query:GuzzleHttp\\Psr7\\Uri:private] => \n                    [fragment:GuzzleHttp\\Psr7\\Uri:private] => \n                )\n        [redirectUri:Google\\Auth\\OAuth2:private] => \n        [clientId:Google\\Auth\\OAuth2:private] => xxxxxxxxxxxxx.apps.googleusercontent.com\n        [clientSecret:Google\\Auth\\OAuth2:private] => -xxxxxxxxxcx7d-RUYuOVw4b\n        [username:Google\\Auth\\OAuth2:private] => \n        [password:Google\\Auth\\OAuth2:private] => \n        [scope:Google\\Auth\\OAuth2:private] => Array\n            (\n                [0] => http://www.google.com/m8/feeds/\n            )\n\n        [state:Google\\Auth\\OAuth2:private] => \n        [code:Google\\Auth\\OAuth2:private] => \n        [issuer:Google\\Auth\\OAuth2:private] => \n        [audience:Google\\Auth\\OAuth2:private] => \n        [principal:Google\\Auth\\OAuth2:private] => \n        [sub:Google\\Auth\\OAuth2:private] => \n        [expiry:Google\\Auth\\OAuth2:private] => 60\n        [signingKey:Google\\Auth\\OAuth2:private] => \n        [signingAlgorithm:Google\\Auth\\OAuth2:private] => \n        [refreshToken:Google\\Auth\\OAuth2:private] => 1/xxxxxxxVy19ge0VAKaIb0SWfAczPT0owkCfQm0PTFHBactUREZofsF9C7PrpE-j\n        [accessToken:Google\\Auth\\OAuth2:private] => \n        [idToken:Google\\Auth\\OAuth2:private] => \n        [expiresIn:Google\\Auth\\OAuth2:private] => \n        [expiresAt:Google\\Auth\\OAuth2:private] => \n        [issuedAt:Google\\Auth\\OAuth2:private] => \n        [grantType:Google\\Auth\\OAuth2:private] => \n        [extensionParams:Google\\Auth\\OAuth2:private] => Array\n            (\n            )\n\n    )\n\n)\nuserRefreshCredentials::fetchAuthTokenGoogle\\Auth\\Credentials\\UserRefreshCredentials Object\n(\n    [auth:protected] => Google\\Auth\\OAuth2 Object\n        (\n            [authorizationUri:Google\\Auth\\OAuth2:private] => \n            [tokenCredentialUri:Google\\Auth\\OAuth2:private] => GuzzleHttp\\Psr7\\Uri Object\n                (\n                    [scheme:GuzzleHttp\\Psr7\\Uri:private] => https\n                    [userInfo:GuzzleHttp\\Psr7\\Uri:private] => \n                    [host:GuzzleHttp\\Psr7\\Uri:private] => www.googleapis.com\n                    [port:GuzzleHttp\\Psr7\\Uri:private] => \n                    [path:GuzzleHttp\\Psr7\\Uri:private] => /oauth2/v3/token\n                    [query:GuzzleHttp\\Psr7\\Uri:private] => \n                    [fragment:GuzzleHttp\\Psr7\\Uri:private] => \n                )\n        [redirectUri:Google\\Auth\\OAuth2:private] => \n        [clientId:Google\\Auth\\OAuth2:private] =>xxxxxxx.apps.googleusercontent.com\n        [clientSecret:Google\\Auth\\OAuth2:private] => -xxxxxxxPhAcx7d-RUYuOVw4b\n        [username:Google\\Auth\\OAuth2:private] => \n        [password:Google\\Auth\\OAuth2:private] => \n        [scope:Google\\Auth\\OAuth2:private] => Array\n            (\n                [0] => http://www.google.com/m8/feeds/\n            )\n\n        [state:Google\\Auth\\OAuth2:private] => \n        [code:Google\\Auth\\OAuth2:private] => \n        [issuer:Google\\Auth\\OAuth2:private] => \n        [audience:Google\\Auth\\OAuth2:private] => \n        [principal:Google\\Auth\\OAuth2:private] => \n        [sub:Google\\Auth\\OAuth2:private] => \n        [expiry:Google\\Auth\\OAuth2:private] => 60\n        [signingKey:Google\\Auth\\OAuth2:private] => \n        [signingAlgorithm:Google\\Auth\\OAuth2:private] => \n        [refreshToken:Google\\Auth\\OAuth2:private] => 1/xxxxxxxqVy19ge0VAKaIb0SWfAczPT0owkCfQm0PTFHBactUREZofsF9C7PrpE-j\n        [accessToken:Google\\Auth\\OAuth2:private] => \n        [idToken:Google\\Auth\\OAuth2:private] => \n        [expiresIn:Google\\Auth\\OAuth2:private] => \n        [expiresAt:Google\\Auth\\OAuth2:private] => \n        [issuedAt:Google\\Auth\\OAuth2:private] => \n        [grantType:Google\\Auth\\OAuth2:private] => \n        [extensionParams:Google\\Auth\\OAuth2:private] => Array\n            (\n            )\n\n    )\n\n```\nas you can see requests look alike... But the second one fails ! \n. I hope the guys here will be able to patch this caching/token issue soon !\n. Nice work, it works perfectly ! I can now rely on the library to refresh the tokens as needed ; I deleted in my code the isAccessTokenExpired() stuff mentionned above.\nThanks !\n. Hi,\nAre you refering to current release (v2 RC5) ? I don't think so, as I can't find the line/file mentionned in you post.\nCould you be more precise about the library version you are using ? I used to have some issues with refreshing tokens and your post could be useful\n. Sorry, I don't use composer, so I can't help you (I downloaded the full release here [https://github.com/google/google-api-php-client/releases/tag/v2.0.0-RC5])\n. Hi,\nYou have missed all the setup instructions !\nYou have to either use Composer or include vendor/autoload.php if you have downloaded the full release (which includes vendor/*).\nPlease refer to instructions on library home page : https://github.com/google/google-api-php-client\n. Hi,\nI had similar issue as yours (saving and refreshing the token). Why do you bother with detecting a refreshed token, whereas you could just ask the library whether the token is expired or not ? If so, you commit it to your database (for future use). If not, you continue to use it. \nHere is a piece of code I'm using :\n```\n// read token from the API or from your database, if it has been saved\n$t = $client->getAccessToken();\nprint_r($t); // should output several fields (including expires_in and refresh_token)\n// if token is expired\nif ( $client->isAccessTokenExpired() )\n{\n   // fetch refreshed token, but this one is short-lived (one hour validity) ; you CAN'T save it to your \n   // database for future use !\n   $short_lived_token = $client->fetchAccessTokenWithRefreshToken($t['refresh_token']);\n// for future calls in the API and the script lifetime, set the refresh token just obtained\n   $client->setAccessToken($short_lived_token);\n$t['access_token'] = $short_lived_token['access_token'];\n   $t['created'] = $short_lived_token['created'];\n   $t['expires_in'] = $short_lived_token['expires_in'];\n// do some stuff to save the token in your database, for future use\n}\n```\nHope this helps a bit !\n. Are you sure you are using the last RC ? As your issue reminds me of mine described here (and addressed by a pull request)\nSee here : https://github.com/google/google-api-php-client/issues/849\n. I say that because the token obtained by fetchAccessTokenWithRefreshToken does not contain any refresh_token field ; the expires_in field is set to expire the token 1 hour later. If you save the fetchAccessTokenWithRefreshToken in the database, you are loosing the refresh_token part !\nThis is what I learnt some weeks ago, I don't think it has changed.\n. Woooh ! It was clearly written in the docs I read, I still I didn't catch it ! Didn't realize at the moment I was refering to pre 1.0 versions. \nThanks a lot for your answer !\n\"Issue\" closed.\n. Maybe on the Google API Explorer ? Methods are the same whichever language you code with.\nSome links (PHP  samples available) : \n\nDrive API\n\nCalendar API\nGmail\n. Have you tried files.get with alt=media standard parameter ?\n\nDrive v3 reference.\nThere may be a quota to downloads, but you could store the file in a local cache on your host, for example.. I'm using Drive API and I'm not having this issue. \nDo you still have it ? Have you tried to setup your Google_Client with direct method calls instead of using the json file ? :\nphp\n$client->setClientId('xxxx');\n$client->setClientSecret('xxx');\nBy the way, I'm not sure the setSubject is relevant, unless you are using a service account.. Yes, the code uri parameter is valid only once. \nThanks to fetchAccessTokenWithAuthCode you exchange this code to an access token.\nDepending on your setup (offline access or not), the token may be used for 1 hour or indefinitely used (in that case, the token includes a refresh token).\nSave the token in session, as mohe2015 suggested, database or any relevant storage, and reuse-it at any time through setAccessToken.. Hi,\nAlthough I understand your point, I don't see why (from a user perspective) we would have to break existing code \"just\" to introduces namespaces instead of pseudo naming convention such as Google_Service_Resource. That's a lot of work (in the API here, and in users scripts) for a small benefit.\nAnd if you really want to stick to PSR-x, I think it's only recommandations ; by the way, from your excerpt : \n\n\"code written for 5.2.x and before SHOULD use...\"\n\n\"SHOULD\" is not \"MUST\" ;-)\nLet's see what @bshaffer and others users thinks of this \"issue\".. Hi,\nYou have misunderstood the API reference. export method is only to convert a Google Doc and download it. Google docs are documents created on the web interface through Docs, Sheets, or Slides.\nOther kind of documents (in particular, uploaded files such as your docx word file) should be downloaded through an authorized GET request along with the alt=media query parameter.\nFrom API reference about v3 downloads : \nphp\n$fileId = '0BwwA4oUTeiV1UVNwOHItT0xfa2M';\n$response = $driveService->files->get($fileId, array(\n  'alt' => 'media' ));\n$content = $response->getBody()->getContents();\n. Hi,\nI'm not sure to understand what you are exactly looking for, and what you do not want as a solution (you should have formatted nicely your question, as a 20 lines paragraph is rather unpleasant to read).\nTo get files and set the name, I get the binary data : \nphp\n$psr7_response = $service->files->export($fileid, $mimeType);\nif ( $psr7_response->getStatusCode() == 200 )\n    $body = (string) $psr7_response->getBody();\nelse\n        die('Error');\nand then I output the body to stdout with the right headers to provide a filename to browser downloaded content :  \nphp\nheader(\"Content-Type: $mimeType\");\ndie($body);\nOf course, the file payload first goes from Google servers to my host, in the $body var, and then the payload is sent to the client browser. This is not really smart, as it doesn't save bandwith and take twice more time as if the payload could be directly downloaded from the client browser.\nThe only way the client browser could download the files directly from Google servers (saving your host bandwith) would be to set the files as public (or semi-public, with a sharing link) ; then, any browser client could click on the sharing link and download the file (the filename would be automatically set).\nIf your files are private, with no sharing link, I don't think you can't go around PHP download to your host and then sending data to browser, as I do.\n. Since the API doesn't provide any means of setting the filename when using the public download link, there may be no solution to what you intend to do... Sorry.. Precisely (I didn't mentionned the Content-Disposition header, as I assumed it should be known by any webmaster).\nHowever, the header can only be used in the process I described, but @chadismydad  is looking for a way to do this directly through the API, saving his server bandwidth.. Hi,\nYou have to first list folders, and then explore each folder for files.\nThe trick to list only folders is to set the q query parameter with the right mimetype : \nphp\n$drive->files->listFiles(array('q' => \"trashed = false AND mimeType='application/vnd.google-apps.folder'\"));\nThe response here will only contain folders in your drive account. Then process in a loop each of this folders to find its files, thanks to the parents property : we select only files having $folder->id as a parent. Said otherwise, we select only $folder->id childs : \nphp\n// loop content here\n$drive->files->listFiles(array('q' => \"trashed = false AND '{$folder->id} IN parents' \"));\n// endloop content\n. Well, json_decode and get the message property ? \n- see if $json = json_decode($e->getMessage()) succeeds or not (if so, we have a json string ; otherwise, plain text error message)\n- if so, $json->error->errors[0]->message is set with the error message. Currently the Composer library for services has all services in it, and you can't ask Composer to download part of the lib. This is not the intended behavior.\nHowever, you could download the full release) on your computer, remove all services not needed, and upload to your host only relevant files.. Or you can also download the full release (including dependencies) : https://github.com/google/google-api-php-client#download-the-release, please read the readme file.\nShared hosting should not prevent you from using Composer, unless your host don't want outbound connections to Packagist.... Send a request to $service->users_settings_filters->listUsersSettingsFilters($userid) and you should get a ListFiltersResponse object, with a filter property being an array of Google_Service_Gmail_Filter objects.\nIf I'm wrong, the best way to find out is to print_r the stuff returned by the API call (I always do that for tricky things with missing samples).\nhttps://developers.google.com/gmail/api/v1/reference/users/settings/filters/list\n. Hi,\nYou are talking about Google Contacts in the thread title, but you are then using People API (two different things).\nFor Google Contacts, the correct scope is http://www.google.com/m8/feeds/ ; however, there's no official PHP API available, you'll have to deal with the raw protocol and xml feeds.\n. Hi,\nMaybe you are missing the right scope to allow read AND write access to the calendar ? Correct scope is https://www.googleapis.com/auth/calendar (not https://www.googleapis.com/auth/calendar.readonly).\nIf the event is not created, you should have an exception thrown. Try enclosing the above code in a try/catch block with debug stuff in the catch part.\n. Why not have a look at the API reference first ? \nFirst https://developers.google.com/drive/v3/reference/files/list for basic protocol knowledge\nand\nhttps://developers.google.com/api-client-library/php/start/get_started for PHP stuff. ",
    "loosenut": "@riggsfolly - Thanks so much for that code!  I've been going crazy trying to figure this out.   I actually got this working with https://www.googleapis.com/auth/contacts.readonly, and without the feeds scope, fwiw.\n. ",
    "amandal1810": "@riggsfolly - Thanks a lot for your code! I am now trying to integrate this with Laravel 4.2. Any guidance on that? Thank you!\n. ",
    "DivineOmega": "I've created a PHP library for the Google Contacts API (v3) that can be installed with composer. It has setup instructions in the readme file. It needs a little work in some places, but it is MIT licensed and works well for the basics of contact retrieval, updating and creation.\nLink: https://github.com/rapidwebltd/php-google-contacts-v3-api\nHopeful this will be helpful for anyone having difficulties manually implementing this.\n. @am63 Thanks for the kind words. The library is not perfect yet, but it is certainly better than having to do it all manually! If you do make use of it, I'd appreciate any feedback and, of course, contributions are welcome.\n. @jonnywilliamson This looks interesting. I assume this interacts with the regular Google Contacts service at https://contacts.google.com/ ?. @jonnywilliamson Okay. Well, if it does, this may finally be a more reasonable API for Google Contacts.. @abel672 I made a library for the Google People API recently. Link: https://github.com/rapidwebltd/php-google-people-api\nWith it, you can get all contacts and loop through them just by doing something similar to the following:\nphp\n// Retrieval all contacts\nforeach($people->all() as $contact) {\n    echo $contact->resourceName.' - ';\n    if ($contact->names) {\n        echo $contact->names[0]->displayName;\n    }\n    echo PHP_EOL;\n}. ",
    "Arvind11": "Hi, \nHow can we fetch postal addresses along with phone numbers...???\nAny help always be appreciated....\nThanks in advance......\n. ",
    "rajeshtomjoe": "I have made some changes to @DivineOmega repository to support the latest google api php client.\nLink: https://github.com/rajeshtomjoe/php-google-contacts-v3-api\n. ",
    "jonnywilliamson": "@everyone\nJust incase you didn't know, the google PEOPLE api has now added support for updating / creating etc contacts.\nIt's fairly new.\nhttps://developers.google.com/people/api/rest/v1/people. I found today and haven't started playing with it yet.. > If you're looking to save the access token somewhere, this is tricky, as it's not currently being saved back to the Google_Client. But it is stored in cache, so you could retrieve it using $client->getCache().\nYes just so there's no confusion to my question:\nI can see that the API is using the refresh_token automatically for me - also my request for data is successful so I know the API is working well. As you say, I just can't see how to get my hands on the new access_token and expires_in values etc from the request the API sent.\nI haven't played around with the cache yet at all (I didn't even know there was one). I will do so now - however out of interest, when would the cache get updated with those new values? Immediately after the authorise() method or after the Google_Task_Runner run() method etc?\nJust a little unfamiliar with the code.\nAlso just wondering how everyone else manages this as it would appear as a common scenario? \nAm I doing it wrong? (Very common occurrence for me!!!)\nThank you for getting back to me.\n. Hi again,\nOk so having looked at the cache object I can see that there is indeed a key that holds the new access_token, that's a good start - thanks!\nThe key name is long and tricky (!!) using the clientId and scopes as you've shown above...however, there's only the new access_token and no expires_in data etc - like you would get back had we used the fetchAccessTokenWithRefreshToken method manually.\nIt feels like this might just be a feature in progress? Perhaps I should wait a while until this gets fleshed out a bit more with the Google_Client code? \nOr have I read too much between the lines above and it's not really something you're planning on implementing...in which case, maybe I should put a request in. I'll have to read your etiquette rules too, don't want to appear rude and demanding :)\nThank you. \n. Just noticed this issue/request too..looks very similar. https://github.com/google/google-api-php-client/issues/300\n. @bshaffer - Hey I'm only able to get looking at this today. Just about to check out the new code! Thanks!\n. Its been a while since I looked at this...I'll be digging into it again in a few weeks.\nPerhaps it might be the case now that ->getAccessToken() returns the NEW token if it was created with the refresh token...however when this issue was first made, that was NOT how it worked.. @bshaffer \nSo I took a look at this last night, it works kinda great! \nI can easily get access to the access_token and expiry time now if the API is forced to refresh the access_token because the one I supplied has expired etc.\nHowever, I'm left wondering how best to use this. As far as I can see there's no event system (or any observation pattern) in the API, so I'm struggling to come up for the best way to know when to call the getLastReceivedToken method so I can save/update the new access_token\nWhen I make more than one request, the getLastReceivedToken method always seems to return NULL. I'm not sure why...\nHere's some pseudo code of what I mean:\nImagine my saved access_token in the database is now a day old...\n``` php\n$client = new Google_Client(['myconfigvalues']);\n$client->setAccessToken('OldaccessTokenRetrievedFromDatabase');\n\n$cal = new Google_Service_Calendar($client);\n\n//This will show the expired token that was taken from the database\nvar_dump($client->getAccessToken());\n\n\n//We make a request and the API magically asks and receives a NEW access_token. Brilliant.\n$request1 =  $cal->calendarList->listCalendarList();\nvar_dump($client->getLastReceivedToken()); //New access_token\n\n//So far so good. I could technically save this data right now. But say I wanted to do a number of\n   //requests....checking after EVERY request is very tedious.\n//Let's fire off another request:\n$request2 = $cal->calendarList->get('myemailaddress@gmail.com');\nvar_dump($client->getLastReceivedToken());  //Null returned\n\n//MMMm. Now getLastReceivedToken() is showing NULL\n\n```\nI'm sure this is something to do with the cache, but I'm not sure.\nAs it stands this is a great start. However, my work flow has me making multiple requests to the google_service rather than just one (eg, get a list of users' calendars, then insert an event if they have one called \"work\" etc.). Unless I've coded something badly, it appears that the getLastReceivedToken method only works after the 1st request.\nWhat I was hoping to do was override the __destruct method on the Google_Client and when it was being destroyed I was going to check for any new tokens and save them to the database for that user for the next time.\nHave I picked this up wrong?\n. So tracing through the code, I think this is where the issue \nSo it all works well for the 1st request, but if there is a second request, in Google_Client the authorize method gets called and this code is used:\n\nOn line 353, $this->getAccessToken is called again, but because the Google_client has never been updated with the new access_token that it managed to get in the last request, it still retrieves the old stale one that was set when Google_Client was created.\nThat means that the lastCredentials gets reset to just the refresh token...wiping away the previous new access_token.\nNow in the AuthTokenMiddleware:\n\nThe cache gets set, and uses the last new access_token to make the second request which will work perfectly.\nHowever at no stage is this passed back to the Google_Client.\nI have no idea what to do to fix that, I'm struggling getting my head around the architecture here, but I hope that helps to explain what the issue is.\nThank you!\n. HI @am63 Thanks for replying.\nI'm definitely using RC6. From my composer.lock file:\n\nI'm currently using something very similar to your code at the moment, testing the access_token when I set it with the Users saved one.\nIf it's expired/stale I get a new one and save it, then set that one in the Google_Client.\nHowever all that work is done already in the API! It checks if it's expired. It checks if its invalid. It fetches a new one using the refresh token. It uses the new one for any requests (via the cache it seems).\nJust trying to see why we need to write that boilerplate code to do all that when all I need is to grab the tokens that were used by the library when it's shutting down.\nThere's one line in your code that surprises me:\n\n// fetch refreshed token, but this one is short-lived (one hour validity) ; you CAN'T save it to your \n  // database for future use !\n\nWhy do you say that? \nI have plenty of requests that will be done within an hour of the last one, and so using the token again is fine. Just curious.\nThanks though!\n. @am63 Ah ok. \nI'm working with Laravel, luckily it's smart enough to know that if I send an update command to the database with an array that only has an access_token and expires_in field, it will update only those fields and not remove the refresh_token etc for that user.\nBut as a warning for others, that's fair enough :)\n. I'm sorry for high-jacking this PR conversation, but things just keep jumping out at me.\nSo @am63  you said earlier on:\n\nWhy do you bother with detecting a refreshed token, whereas you could just ask the library whether the token is expired or not ? \n\nAnd you followed it up with this code:\nphp\n$t = $client->getAccessToken();\n// if token is expired\nif ( $client->isAccessTokenExpired() ){\n[...]\n}\nThis is actually pretty worthless IMHO.\nWhen we have a look at the isAccessTokenExpired() method, you find that it's nothing more than a time checker.\nThe code looks like this (comments removed):\n``` php\n  public function isAccessTokenExpired()\n  {\n    if (!$this->token) {\n      return true;\n    }\n$created = 0;\nif (isset($this->token['created'])) {\n  $created = $this->token['created'];\n} elseif (isset($this->token['id_token'])) {\n  $idToken = $this->token['id_token'];\n  if (substr_count($idToken, '.') == 2) {\n    $parts = explode('.', $idToken);\n    $payload = json_decode(base64_decode($parts[1]), true);\n    if ($payload && isset($payload['iat'])) {\n      $created = $payload['iat'];\n    }\n  }\n}\n// If the token is set to expire in the next 30 seconds.\n$expired = ($created\n        + ($this->token['expires_in'] - 30)) < time();\nreturn $expired;\n\n}\n```\nAs you can see, it literally only checks to see if the time left on the token is more than 30 secs otherwise it just says the token has expired.\nThis does no checking to see if the token has been revoked, if it's actually a valid token (ie, the string of characters hasn't be tampered with)  etc.\nIf you really wanted to check is the token valid, you need to check with Google. Something like this:\n``` php\n    protected function isAccessTokenInvalid($token)\n    {\n        $http = $this->client->authorize();\n    $result = json_decode(\n        $http->get('https://www.googleapis.com/oauth2/v1/tokeninfo?access_token='.$token)->getBody()\n    );\n\n    if (isset($result->error)) {\n        //Bad Token - invalid, corrupt etc.\n        return true;\n    }\n\n    return false;\n}\n\n```\nBasically it seems the work flow should be simple:\n1) Create Google_Client and add a token. (It might be old and invalid, it might be new and valid).\n2) Make requests. Api detects what needs to happen if token is old. Gets new token and uses it. (Currently the API does this).\n3) When finished all requests, return the tokens used. They can be saved if needed for the next time.\nWouldn't that bypass all the checks and bolierplate code we have to do at the moment?\n. I would love to be able to say which of those two options seems better, but I'm not sure I'm up to speed with the entire API code base to give a constructive opinion.\nI am happy to give way to your better judgement.\nThank you for reading though my long rants above :)\n. Again apologies, but the question is above my skill level to answer!\n. Wait?! What?\nIsn't it the access_token that expires and you use a refresh_token to get a new one? The refresh_token doesn't expire unless revoked?\nSorry just a little confused here.. Sorry a little confused here.\nIf I have a refresh_token and pass it to the client along with the access_token, and the client detects that the access_token is expired and magically/automatically gets me a NEW one using the refresh_token...\nWhy would you need to get the refresh_token returned to you again? Surely it doesn't expire (unless revoked?)\nDid I misunderstand that PR #1121 ?. OK,\nI must have been confused when I saw this note at the bottom on the google oauth playground:\n\n. >I ran into the lack of refresh token issue immediately when I started using this library to access the gmail API in \"offline\" mode (or whatever it is called).\nI think a lot of people miss the fact that the refresh_token is only ever issued at the VERY start when the oauth has been complete for the first time.\nIt's like your only chance to grab it and save it for later use. I think a lot of people believe it should be returned to them on every request, but that's not what google does....at least when I was making my app a year or so ago!. ",
    "abel672": "I am checking the People API, I don't find method to get all the contacts at once. Did you guys found something about this at the end?. @DivineOmega Thanks!. Will have a try on it.. ",
    "egeriis": "This should do?\nphp\n$client = new Google_Client();\n$client->setDeveloperKey('...');\n$translate = new Google_Service_Translate($client);\n$translations = $translate->translations->listTranslations('Text to translate', 'da');\n. ",
    "davidrojo": "Same here, you can checkt it with this code:\n``` php\n$client = new \\Google_Client();\n$client->setApplicationName(\"AutomatedTranslations\");\n$client->setDeveloperKey(GOOGLE_API_KEY);\n$service = new \\Google_Service_Translate($client);\n$result = $service->translations->listTranslations('Hola buenos dias', 'en', ['source' => 'es']);\nprint_r($result); // You can see here that the text is translated\n$text = $result->getTranslations();\nprint_r($text); //  You can see here that getTranslations returns empty array\n```\nThe problem is that the API request is returning the next json.\njson\n{\n    \"data\": {\n        \"translations\": [\n            {\n                \"translatedText\": \"Hallo Welt\"\n            }\n        ]\n    }\n}\nAn then the Google_Service_Translate_TranslationsListResponse has the next format\nGoogle_Service_Translate_TranslationsListResponse Object\n(\n    [collection_key:protected] => translations\n    [internal_gapi_mappings:protected] => Array\n        (\n        )\n    [translationsType:protected] => Google_Service_Translate_TranslationsResource\n    [translationsDataType:protected] => array\n    [modelData:protected] => Array\n        (\n            [data] => Array\n                (\n                    [translations] => Array\n                        (\n                            [0] => Array\n                                (\n                                    [translatedText] => Hello good morning\n                                )\n                        )\n                )\n            [translations] => Array\n                (\n                )\n        )\n    [processed:protected] => Array\n        (\n            [translations] => 1\n        )\n)\nAs you can see, the json response is filled into modelData->data->translations, and it should be modelData->translations, this is because the json response has a \"data\" in the response...\nI have quickfixed this overwritting the constructor of Google_Service_Translate_TranslationsListResponse in src/Service/Translate.php at line 337\nphp\nclass Google_Service_Translate_TranslationsListResponse extends Google_Collection\n ....\n  function __construct(){\n    if (func_num_args() == 1 && is_array(func_get_arg(0))) {\n        $array = func_get_arg(0);\n        if (count($array) == 1 && isset($array['data'])){\n            // QuickFix if the array has only one element and its name is \"data\"\n            parent::__construct($array['data']);\n        }   \n        else{\n            parent::__construct(func_get_args());\n        }\n    }\n    else{\n        parent::__construct(func_get_args());\n    }\n  }\n}\n. ",
    "tegansnyder": "@davidrojo good work. xDebug tracing leads same conclusion. PR #523 has been submitted.\n. Makes sense :) thanks for the explanation\n. ",
    "tmcdos": "I had the same problem but with Google_Service_Translate()->detections->detect() method. The solution by @davidrojo does not work with version 2.2.2 of the library because the constructor is marked as final in the parent class so I had to fix the issue in a simpler way\nphp\nclass Google_Service_Translate_DetectionsListResponse extends Google_Collection\n{\n  ....\n  /**\n   * @return Google_Service_Translate_DetectionsResourceItems\n   */\n  public function getDetections()\n  {\n    return $this->data['detections'];\n  }\n}. ",
    "lincolnlemos": "@DavidAnderson684 , \nDo you have any progress with this?\n. ",
    "gothick": "If it helps, you can use this library at least to help with Google Cloud Print, even though the Discovery methods aren't generated for you. For example, I use this library to authenticate a Service Account, then add the Google Cloud Print scope (https://www.googleapis.com/auth/cloudprint), and use the authenticated Guzzle object I'm passed back from authorize() to call Cloud Print methods \"manually\", and it works fine.. @net-tools I think it was very worthwhile responding to a 2-year-old post, given that I was looking for a decent Google Cloud Print API library at the weekend and didn't find yours! Thanks.. ",
    "RobinCK": "In additionalParams need to add\n'uploadType' => 'multipart',\nor \n'uploadType' => 'media',\n. ",
    "koconder": "Id +1 this motion :+1: - I've had headaches with some big requests, mainly with YT. Would be happy to help!\n. ",
    "erikverheij": "I'm not sure why you refer to the Freebase API. \nThe Google_Service_Drive_Files_Resource/insert() method used in the example actually allows to set the postbody as the first param. For the following methods of Fusion tables it should also be possible to set the postbody; \nGoogle_Service_Fusiontables_Table_Resource/importRows() - Currenty not possible to set the postbody\nGoogle_Service_Fusiontables_Table_Resource/importTable() - Currenty not possible to set the postbody\nGoogle_Service_Fusiontables_Table_Resource/patch() - Seems to work fine\nGoogle_Service_Fusiontables_Table_Resource/replaceRows() - Currenty not possible to set the postbody\nGoogle_Service_Fusiontables_Table_Resource/update() - Seems to work fine\nSee this page for more information about the options for uploading in fusion tables; https://developers.google.com/fusiontables/docs/v2/reference/table/replaceRows\n. Hi, sorry I missed  the workaround of @BenWis e9000. Currently I don't have access to the project using this library so closing this issue seems like the best option. . ",
    "BenWise9000": "@erikverheij  API Version 1.1.7 works for me doing the following (for ReplaceRows):\n```php\n        $client = new Google_Client();\n        $client->setApplicationName('My application name');\n        $serviceAccountName = 'something@something';\n    $privateKey = file_get_contents('/path/to/keyfile.p12');\n\n    $credentials = new \\Google_Auth_AssertionCredentials(\n        $serviceAccountName,\n        ['https://www.googleapis.com/auth/fusiontables'],\n        $privateKey\n    );\n\n    $client->setAssertionCredentials($credentials);\n    if ($client->getAuth()->isAccessTokenExpired()) {\n        $client->getAuth()->refreshTokenWithAssertion();\n    }\n\n    $service = new \\Google_Service_Fusiontables($client);\n    $tableId = 'aTableIdString';\n    $tsvData = file_get_contents('/path/to/tsv/file.tsv');\n    $reqData = $service->table->get($tableId);\n    $service->table->replaceRows($tableId, ['postBody' => $reqData, 'data' => $tsvData, 'mimeType' => 'application/octet-stream',\n        'uploadType' => 'multipart', 'delimiter' => \"\\t\"]);\n\n```\n. ",
    "ericuldall": "Not sure why that error isn't caught and handled gracefully.\n. Sorry, not exactly sure how to reproduce the problem.\n. Also getting this issue.\n. Garbage in the log is bad. I'm running this on app engine and now I can't tell which errors really need attention because they all show the same error label. Not so bad in a low traffic system, but when you're getting millions of requests every day, it gets a bit laborious finding where the errors are.\n. I just upgraded to the new v2 version of the library and i'm getting this error again, however the IO/Stream.php file does not seem to exist. Am I missing something?\n. Yes, I ended up finding it in there. Thanks.\n. I think perhaps there was a dependency out of sync. I installed a new version prebuilt and removed all .gitignore files before committing to my repo. Now things are working fine on remote.\n. ",
    "nickrobarov": "Came across the same problem. \nDeleting the cache files in the tmp dir solved the problem but this might happen again.\n. ",
    "nathanmarks": "@samsamm777 I'm about to use this version of the library for a project at work. Do you mind sharing some more details about the issues you encountered that triggered this discussion?\n. ",
    "quantumpacket": "Signing data which is security related would probably not be a concern for anyone who has not updated from PHP 5.2. There are reasons for minimum version requirements. PHP 5.2 had reached EOL in January 2011.\nAnyone still running that version should choose a different profession, as they have been running a vulnerable version of PHP for over 4yrs. I don't think we should be encouraging the use of such outdated and insecure versions by adding support for it.\n:-1:  -1 on this change.\n. Minimum version requirements is always a hot topic :P The readme states why they chose that minimum version. If we are to prevent end users from shooting themselves in the foot by using vulnerable versions, we should stop handing them the bullets. Each new lower version supported just adds more code to maintain for backwards compatibility, and says to the end user \"hey, go ahead and use a vulnerable version because we support you on that\".\nWith PHP7 on the horizon, which would have PHP 5.4 reach EOL shortly after, do we really want to be adding additional support that many EOLed versions back? I'd be fine for adding additional support for maybe 5.3, 5.4 even though they are EOL, but there has to be a point where it's just not advised. If the PHP community is to ever upgrade from 5.2, then major vendors needs to stop supporting such old versions.\nYour legacy app can be more relaxed with updating, due to it being on an internal server. This repo on the other hand is likely to be used on primarily public facing services, which should not be encouraged to using vulnerable versions.\nI don't want to turn this into a flame war about version requirements. So not going to argue about it. I apologize if I came off as rude or anything, just stating my opinion on adding additional support for such old versions.\nHere is some reading on the subject by Anthony Ferrara and why I have this opinion:\nhttp://blog.ircmaxell.com/2014/12/on-php-version-requirements.html\nhttp://blog.ircmaxell.com/2014/12/php-install-statistics.html\n. php\nif (isset($result['error'], $result['error']['errors'])) {\nShould just be:\nphp\nif (isset($result['error']['errors'])) {\nFor $result['error']['errors'] to exist it already implies that $result['error'] would already exist. Right?\n. ",
    "hollycoder": "Closed\n. ",
    "drsii": "Hey @hollycoder can you please stop using fraudulent cards to purchase our products. Twice in 4 months, we're on to you.\n. We're Cartalyst and we're not flattered that you love our products so much that would steal from others to use them. I wouldn't think it's worth it to ruin what little reputation you might have as a developer.\n. Both card holders from each time your github account was associated with separate account creations said they're cards had been stolen. There is a cost buddy and an extra fee to me. Not only have you stolen from the people whose cards you stole, you have stolen $150.00 from me, and an extra $30.00 in chargeback fees.\nYou've also stolen from all my employees who work hard providing support and great products. Taking advantage of their effort and time is even more insulting. \nKarma will catch up with you.\n. You forgot to delete my screenshot.\n\n. ",
    "kirkbushell": "Why not just report him? It's unacceptable and fraudulent behaviour.\n. ",
    "greydnls": "This is not okay. Not in the slightest. Disgusting. I just can't even. \n. ",
    "brunogaspar": "hahah nice try hollythief\n. ",
    "pulkitjalan": "Hi @ianbarber \nThanks for your reply, I tried this out however ran into the problem where the library is trying to parse the response as json...\nBelow is what I tried, and as far as I can tell it is downloading the file.\nphp\n$file = $storage->objects->get($bucket, $path, ['alt' => 'media']);\nWhen running this I get a Google_Service_Exception with the message Invalid json in service response\nIts caused in src/Google/Http/REST.php on line 123.\n``` php\nif ($code != '204') {\n    $decoded = json_decode($body, true);\n    if ($decoded === null || $decoded === \"\") {\n        $error = \"Invalid json in service response: $body\";\n        if ($client) {\n            $client->getLogger()->error($error);\n        }\n        throw new Google_Service_Exception($error); // <=========== Here\n    }\nif ($response->getExpectedClass()) {\n    $class = $response->getExpectedClass();\n    $decoded = new $class($decoded);\n}\n\n}\n```\nThe response code for this request was 200. Any ideas for a possible fix, or will the request have to be done manually?\n. Done, yea just signed the CLA. Thanks.\n. ",
    "dheeraj2dj": "@ianbarber @pulkitjalan Thank you guys! This helped me: \n$file = $storage->objects->get($bucket, $object, ['alt' => 'media']); \n:+1: \n. ",
    "shyandsy": "@dheeraj2dj there is no $storage->objects now. ",
    "Sky-Nik": "@ianbarber, @dheeraj2dj, @pulkitjalan, parameter alt does not support value 'media' now, what should I do?. ",
    "googlebot": "Thanks for your pull request.\nIt looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA) at https://cla.developers.google.com/.\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check the information on your CLA or see this help article on setting the email on your git commits.\nOnce you've done that, please reply here to let us know.  If you signed the CLA as a corporation, please let us know the company's name.\n need_sender_cla \n. Thanks for your pull request.\nIt looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA) at https://cla.developers.google.com/.\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check the information on your CLA or see this help article on setting the email on your git commits.\nOnce you've done that, please reply here to let us know.  If you signed the CLA as a corporation, please let us know the company's name.\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.\nIt looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA) at https://cla.developers.google.com/.\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check the information on your CLA or see this help article on setting the email on your git commits.\nOnce you've done that, please reply here to let us know.  If you signed the CLA as a corporation, please let us know the company's name.\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.\nIt looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA) at https://cla.developers.google.com/.\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check the information on your CLA or see this help article on setting the email on your git commits.\nOnce you've done that, please reply here to let us know.  If you signed the CLA as a corporation, please let us know the company's name.\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for the commit author(s).  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\n need_author_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for the commit author(s).  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\n need_author_cla \n. CLAs look good, thanks!\n ok \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for the commit author(s).  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\n need_author_cla \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for the commit author(s).  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\n need_author_cla \n. CLAs look good, thanks!\n ok \n. CLAs look good, thanks!\n ok \n. We found a Contributor License Agreement for you (the sender of this pull request) and all commit authors, but as best as we can tell these commits were authored by someone else.  If that's the case,  please add them to this pull request and have them confirm that they're okay with these commits being contributed to Google.  If we're mistaken and you did author these commits, just reply here to confirm.\n need_author_consent \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project, in which case you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. We found a Contributor License Agreement for you (the sender of this pull request) and all commit authors, but as best as we can tell these commits were authored by someone else.  If that's the case,  please add them to this pull request and have them confirm that they're okay with these commits being contributed to Google.  If we're mistaken and you did author these commits, just reply here to confirm.\n need_author_consent \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. We found a Contributor License Agreement for you (the sender of this pull request) and all commit authors, but as best as we can tell these commits were authored by someone else.  If that's the case,  please add them to this pull request and have them confirm that they're okay with these commits being contributed to Google.  If we're mistaken and you did author these commits, just reply here to confirm.\n need_author_consent \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for the commit author(s).  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\n need_author_cla \n. CLAs look good, thanks!\n ok \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for the commit author(s).  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\n need_author_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf you signed the CLA as a corporation, please let us know the company's name.\n\n need_sender_cla \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for the commit author(s).  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\n need_author_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf your company signed a CLA, they designated a Point of Contact who decides which employees are authorized to participate. You may need to contact the Point of Contact for your company and ask to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the project maintainer to go/cla#troubleshoot.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for the commit author(s).  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again.\n need_author_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf your company signed a CLA, they designated a Point of Contact who decides which employees are authorized to participate. You may need to contact the Point of Contact for your company and ask to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the project maintainer to go/cla#troubleshoot.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for the commit author(s).  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again.\n need_author_cla \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for the commit author(s).  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again.\n need_author_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf your company signed a CLA, they designated a Point of Contact who decides which employees are authorized to participate. You may need to contact the Point of Contact for your company and ask to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the project maintainer to go/cla#troubleshoot.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf your company signed a CLA, they designated a Point of Contact who decides which employees are authorized to participate. You may need to contact the Point of Contact for your company and ask to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the project maintainer to go/cla#troubleshoot.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf your company signed a CLA, they designated a Point of Contact who decides which employees are authorized to participate. You may need to contact the Point of Contact for your company and ask to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the project maintainer to go/cla#troubleshoot.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf your company signed a CLA, they designated a Point of Contact who decides which employees are authorized to participate. You may need to contact the Point of Contact for your company and ask to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the project maintainer to go/cla#troubleshoot.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address.  Check your existing CLA data and verify that your email is set on your git commits.\nIf your company signed a CLA, they designated a Point of Contact who decides which employees are authorized to participate. You may need to contact the Point of Contact for your company and ask to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the project maintainer to go/cla#troubleshoot.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address on your commit.  Check your existing CLA data and verify that your email is set on your git commits.\nIf your company signed a CLA, they designated a Point of Contact who decides which employees are authorized to participate. You may need to contact the Point of Contact for your company and ask to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the project maintainer to go/cla#troubleshoot. The email used to register you as an authorized contributor must be the email used for the Git commit.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again. If the bot doesn't comment, it means it doesn't think anything has changed.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address on your commit.  Check your existing CLA data and verify that your email is set on your git commits.\nIf your company signed a CLA, they designated a Point of Contact who decides which employees are authorized to participate. You may need to contact the Point of Contact for your company and ask to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the project maintainer to go/cla#troubleshoot. The email used to register you as an authorized contributor must be the email used for the Git commit.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again. If the bot doesn't comment, it means it doesn't think anything has changed.\n\n need_sender_cla \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address on your commit.  Check your existing CLA data and verify that your email is set on your git commits.\nIf your company signed a CLA, they designated a Point of Contact who decides which employees are authorized to participate. You may need to contact the Point of Contact for your company and ask to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the project maintainer to go/cla#troubleshoot. The email used to register you as an authorized contributor must be the email used for the Git commit.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again. If the bot doesn't comment, it means it doesn't think anything has changed.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. Thanks for your pull request.  It looks like this may be your first contribution to a Google open source project. Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll verify.  Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your GitHub username or you're using a different email address on your commit.  Check your existing CLA data and verify that your email is set on your git commits.\nIf your company signed a CLA, they designated a Point of Contact who decides which employees are authorized to participate. You may need to contact the Point of Contact for your company and ask to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the project maintainer to go/cla#troubleshoot. The email used to register you as an authorized contributor must be the email used for the Git commit.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again. If the bot doesn't comment, it means it doesn't think anything has changed.\n\n need_sender_cla \n. \nThanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed (or fixed any issues), please reply here (e.g. I signed it!) and we'll verify it.\n\nWhat to do if you already signed the CLA\nIndividual signers\n\nIt's possible we don't have your GitHub username or you're using a different email address on your commit. Check your existing CLA data and verify that your email is set on your git commits.\n\nCorporate signers\n\nYour company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to go/cla#troubleshoot (Public version).\nThe email used to register you as an authorized contributor must be the email used for the Git commit. Check your existing CLA data and verify that your email is set on your git commits.\nThe email used to register you as an authorized contributor must also be attached to your GitHub account.\n\n need_sender_cla \n. \nThanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed (or fixed any issues), please reply here (e.g. I signed it!) and we'll verify it.\n\nWhat to do if you already signed the CLA\nIndividual signers\n\nIt's possible we don't have your GitHub username or you're using a different email address on your commit. Check your existing CLA data and verify that your email is set on your git commits.\n\nCorporate signers\n\nYour company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to go/cla#troubleshoot (Public version).\nThe email used to register you as an authorized contributor must be the email used for the Git commit. Check your existing CLA data and verify that your email is set on your git commits.\nThe email used to register you as an authorized contributor must also be attached to your GitHub account.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for all the commit author(s) or Co-authors.  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again. If the bot doesn't comment, it means it doesn't think anything has changed.\n need_author_cla \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for all the commit author(s) or Co-authors.  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again. If the bot doesn't comment, it means it doesn't think anything has changed.\n need_author_cla \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for all the commit author(s) or Co-authors.  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again. If the bot doesn't comment, it means it doesn't think anything has changed.\n need_author_cla \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for all the commit author(s) or Co-authors.  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again. If the bot doesn't comment, it means it doesn't think anything has changed.\n need_author_cla \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for all the commit author(s) or Co-authors.  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again. If the bot doesn't comment, it means it doesn't think anything has changed.\n need_author_cla \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for all the commit author(s) or Co-authors.  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again. If the bot doesn't comment, it means it doesn't think anything has changed.\n need_author_cla \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for all the commit author(s) or Co-authors.  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again. If the bot doesn't comment, it means it doesn't think anything has changed.\n need_author_cla \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for all the commit author(s) or Co-authors.  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again. If the bot doesn't comment, it means it doesn't think anything has changed.\n need_author_cla \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for all the commit author(s) or Co-authors.  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again. If the bot doesn't comment, it means it doesn't think anything has changed.\n need_author_cla \n. We found a Contributor License Agreement for you (the sender of this pull request), but were unable to find agreements for all the commit author(s) or Co-authors.  If you authored these, maybe you used a different email address in the git commits than was used to sign the CLA (login here to double check)?  If these were authored by someone else, then they will need to sign a CLA as well, and confirm that they're okay with these being contributed to Google.\nIn order to pass this check, please resolve this problem and have the pull request author add another comment and the bot will run again. If the bot doesn't comment, it means it doesn't think anything has changed.\n need_author_cla \n. \nThanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed (or fixed any issues), please reply here (e.g. I signed it!) and we'll verify it.\n\nWhat to do if you already signed the CLA\nIndividual signers\n\nIt's possible we don't have your GitHub username or you're using a different email address on your commit. Check your existing CLA data and verify that your email is set on your git commits.\n\nCorporate signers\n\nYour company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to go/cla#troubleshoot (Public version).\nThe email used to register you as an authorized contributor must be the email used for the Git commit. Check your existing CLA data and verify that your email is set on your git commits.\nThe email used to register you as an authorized contributor must also be attached to your GitHub account.\n\n need_sender_cla \n. \nThanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed (or fixed any issues), please reply here (e.g. I signed it!) and we'll verify it.\n\nWhat to do if you already signed the CLA\nIndividual signers\n\nIt's possible we don't have your GitHub username or you're using a different email address on your commit. Check your existing CLA data and verify that your email is set on your git commits.\n\nCorporate signers\n\nYour company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to go/cla#troubleshoot (Public version).\nThe email used to register you as an authorized contributor must be the email used for the Git commit. Check your existing CLA data and verify that your email is set on your git commits.\nThe email used to register you as an authorized contributor must also be attached to your GitHub account.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. \nThanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed (or fixed any issues), please reply here (e.g. I signed it!) and we'll verify it.\n\nWhat to do if you already signed the CLA\nIndividual signers\n\nIt's possible we don't have your GitHub username or you're using a different email address on your commit. Check your existing CLA data and verify that your email is set on your git commits.\n\nCorporate signers\n\nYour company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to go/cla#troubleshoot (Public version).\nThe email used to register you as an authorized contributor must be the email used for the Git commit. Check your existing CLA data and verify that your email is set on your git commits.\nThe email used to register you as an authorized contributor must also be attached to your GitHub account.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. So there's good news and bad news.\n:thumbsup: The good news is that everyone that needs to sign a CLA (the pull request submitter and all commit authors) have done so.  Everything is all good there.\n:confused: The bad news is that it appears that one or more commits were authored or co-authored by someone other than the pull request submitter.  We need to confirm that all authors are ok with their commits being contributed to this project.  Please have them confirm that here in the pull request.\nNote to project maintainer: This is a terminal state, meaning the cla/google commit status will not change from this state. It's up to you to confirm consent of the commit author(s) and merge this pull request when appropriate.\n need_author_consent \n. CLAs look good, thanks!\n ok \n. \nThanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed (or fixed any issues), please reply here (e.g. I signed it!) and we'll verify it.\n\nWhat to do if you already signed the CLA\nIndividual signers\n\nIt's possible we don't have your GitHub username or you're using a different email address on your commit. Check your existing CLA data and verify that your email is set on your git commits.\n\nCorporate signers\n\nYour company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to go/cla#troubleshoot (Public version).\nThe email used to register you as an authorized contributor must be the email used for the Git commit. Check your existing CLA data and verify that your email is set on your git commits.\nThe email used to register you as an authorized contributor must also be attached to your GitHub account.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. \nThanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed (or fixed any issues), please reply here (e.g. I signed it!) and we'll verify it.\n\nWhat to do if you already signed the CLA\nIndividual signers\n\nIt's possible we don't have your GitHub username or you're using a different email address on your commit. Check your existing CLA data and verify that your email is set on your git commits.\n\nCorporate signers\n\nYour company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to go/cla#troubleshoot (Public version).\nThe email used to register you as an authorized contributor must be the email used for the Git commit. Check your existing CLA data and verify that your email is set on your git commits.\nThe email used to register you as an authorized contributor must also be attached to your GitHub account.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. \nThanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed (or fixed any issues), please reply here (e.g. I signed it!) and we'll verify it.\n\nWhat to do if you already signed the CLA\nIndividual signers\n\nIt's possible we don't have your GitHub username or you're using a different email address on your commit. Check your existing CLA data and verify that your email is set on your git commits.\n\nCorporate signers\n\nYour company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to go/cla#troubleshoot (Public version).\nThe email used to register you as an authorized contributor must be the email used for the Git commit. Check your existing CLA data and verify that your email is set on your git commits.\nThe email used to register you as an authorized contributor must also be attached to your GitHub account.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. \nThanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed (or fixed any issues), please reply here (e.g. I signed it!) and we'll verify it.\n\nWhat to do if you already signed the CLA\nIndividual signers\n\nIt's possible we don't have your GitHub username or you're using a different email address on your commit. Check your existing CLA data and verify that your email is set on your git commits.\n\nCorporate signers\n\nYour company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to go/cla#troubleshoot (Public version).\nThe email used to register you as an authorized contributor must be the email used for the Git commit. Check your existing CLA data and verify that your email is set on your git commits.\nThe email used to register you as an authorized contributor must also be attached to your GitHub account.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. \nThanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed (or fixed any issues), please reply here (e.g. I signed it!) and we'll verify it.\n\nWhat to do if you already signed the CLA\nIndividual signers\n\nIt's possible we don't have your GitHub username or you're using a different email address on your commit. Check your existing CLA data and verify that your email is set on your git commits.\n\nCorporate signers\n\nYour company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to go/cla#troubleshoot (Public version).\nThe email used to register you as an authorized contributor must be the email used for the Git commit. Check your existing CLA data and verify that your email is set on your git commits.\nThe email used to register you as an authorized contributor must also be attached to your GitHub account.\n\n need_sender_cla \n. \nThanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed (or fixed any issues), please reply here (e.g. I signed it!) and we'll verify it.\n\nWhat to do if you already signed the CLA\nIndividual signers\n\nIt's possible we don't have your GitHub username or you're using a different email address on your commit. Check your existing CLA data and verify that your email is set on your git commits.\n\nCorporate signers\n\nYour company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to go/cla#troubleshoot (Public version).\nThe email used to register you as an authorized contributor must be the email used for the Git commit. Check your existing CLA data and verify that your email is set on your git commits.\nThe email used to register you as an authorized contributor must also be attached to your GitHub account.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. \nThanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).\n:memo: Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed (or fixed any issues), please reply here (e.g. I signed it!) and we'll verify it.\n\nWhat to do if you already signed the CLA\nIndividual signers\n\nIt's possible we don't have your GitHub username or you're using a different email address on your commit. Check your existing CLA data and verify that your email is set on your git commits.\n\nCorporate signers\n\nYour company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to go/cla#troubleshoot (Public version).\nThe email used to register you as an authorized contributor must be the email used for the Git commit. Check your existing CLA data and verify that your email is set on your git commits.\nThe email used to register you as an authorized contributor must also be attached to your GitHub account.\n\n need_sender_cla \n. CLAs look good, thanks!\n ok \n. ",
    "chrissachs": "I filled the form at https://cla.developers.google.com/clas - not sure if this already qualifies as \"signed\"?\n. ",
    "kvasko": "Thanks for your answer. Based on your e-mail I added the \"retry\" to the function but I am still getting the same error randomly. Example this was today some minutes ago:\n[19-Feb-2015 03:05:59 Europe/Budapest] PHP Fatal error:  Uncaught exception 'Google_Service_Exception' with message 'Error calling GET https://www.googleapis.com/drive/v2/files?pageToken=xxx&q=mimeType+%21%3D+%27application%2Fvnd.google-apps.folder%27+and+not+%27me%27+in+owners+and+trashed%3Dfalse: (500) Internal Error' in /var/www/html/ibackup/google-api-php-client/src/Google/Http/REST.php:111\nStack trace:\n0 /var/www/html/ibackup/google-api-php-client/src/Google/Http/REST.php(63): Google_Http_REST::decodeHttpResponse(Object(Google_Http_Request), Object(Google_Client))\n1 [internal function]: Google_Http_REST::doExecute(Object(Google_Client), Object(Google_Http_Request))\n2 /var/www/html/ibackup/google-api-php-client/src/Google/Task/Runner.php(172): call_user_func_array(Array, Array)\n3 /var/www/html/ibackup/google-api-php-client/src/Google/Http/REST.php(47): Google_Task_Runner->run()\n4 /var/www/html/ibackup/google-api-php-client/src/Google/Client.php(564): Google_Http_REST::execute(Objec in /var/www/html/ibackup/google-api-php-client/src/Google/Http/REST.php on line 111\nHere is the modified function by me:\nfunction retrieveAllFiles($service) {\n  $result = array();\n  $pageToken = NULL;\ndo {\n    for ($n = 0; $n < 5; ++$n) {\n    try {\n      $parameters = array();\n      $parameters['q'] = \"mimeType != 'application/vnd.google-apps.folder' and trashed=false\";\n      if ($pageToken) {\n        $parameters['pageToken'] = $pageToken;\n      }\n      $files = $service->files->listFiles($parameters);\n$result = array_merge($result, $files->getItems());\n  $pageToken = $files->getNextPageToken();\n} catch (Exception $e) {\n  print \"An error occurred: \" . $e->getMessage();\n  //$pageToken = NULL;\n  usleep((1 << $n) * 1000 + rand(0, 1000));\n}\n}\n} while ($pageToken);\n  return $result;\n}\nBecause of this error I am very frustrated because many times its came up in the middle of the process therefore I lost 1-2 hours work. When I got it the script stopped working and i had to start it again. \nIf the backoff solution isn't solved this issue than how can I solve it? Or is it any solution to catch this error anyhow without restart the script?\nI am appreciating all help!\nBR,\nKriszti\u00e1n \n. Yes, I checked it more than twice.\nDo you have any idea how can I continue my script from the current state if I can't catch the error? \nI tried to use the PageToken value from the above mentioned error to continue the work. But when I set the $pageToken = xxx; value at the start of my script I received always the same http 500 error. (I don't know it should work or not.) After I set back the $pageToken  to NULL and my script again started working. \nMaybe if I send my codes to you would you be so kind to check what can cause this problem? \n. ",
    "hdwebpros": "Thanks for the reply. I see the path it's trying to use is this:\n/var/zpanel/hostdata/zadmin/public_html/:/var/zpanel/temp/\nSo, are you saying my system is generating this path as it's temp directory?\n. I'm with you until \n\"So if you want to use the file cache, you will need to make sure it's base dir is in one of those directories.\"\nWhat do you mean? How would I set file cache's base dir as that? Thanks in advance for the speedy help\n. Sorry, I must not be getting it quite right. In a controller, I have\n$client = new Google_Client();\n        $client->setClassConfig('Google_Cache_File', 'directory', '/var/zpanel/temp/Google_Client');\n        $site_id = Analytics::getSiteIdByUrl('http://example.com'); //I have my site in there\n        $stats = Analytics::query($site_id, '7daysAgo', 'yesterday', 'ga:visits,ga:pageviews');\n        dd($stats);\nand that still errors out to\nfile_exists(): open_basedir restriction in effect. File(/tmp/Google_Client/e4/e4376171b3c41df2c55e1a689f6386c9) is not within the allowed path(s): (/var/zpanel/hostdata/zadmin/public_html/:/var/zpanel/temp/)\nWhat else could it be?\n. @ianbarber I'm not updating that file. I'm just in a controller. The file that's shown in the exception is\nvendor/google/apiclient/src/Google/Cache/File.php\n@whatthejeff As for configuration, the file at app/config/packages/thujohn/analytics/config.php (https://github.com/thujohn/analytics-l4/blob/master/src/config/config.php) just has these options:\nclient_id, service_email, certificate_path, use_objects. \nI'll ask the developer about how to provide his package with the right $client information then, right? Is there anything else I can do?\n. AAAHHH!  Got it fixed :)\n\n$client = Analytics::getClient();\n$client->setClassConfig('Google_Cache_File', 'directory', storage_path('google_cache'));\n$site_id = Analytics::getSiteIdByUrl('http://www.example.com');\n    $stats = Analytics::query($site_id, '7daysAgo', 'yesterday', 'ga:visits,ga:pageviews');\n    dd($stats);\n\nSetting the storage path correctly like shown above did the trick\n. So, I will close this issue eventually, but now that I have it working, I can't seem to get the data I want from it. How do you include dimensions in your query?\nI'm trying for example to see the number of visits per source in the last week. But I can't specify ga:source as a dimension, or set any dimension for that matter. The exception is:\narray_merge(): Argument #2 is not an array\nHow would I take my code shown above and pull in visits per source? \n. Got it.\n['dimensions' => 'ga:source']\n. We got it figured out. Thanks\n. ",
    "odelalleau": "Thanks for confirming that it should work, I'll try to dig deeper next time I run into it. So far I had it happen only a couple of times in the past week, so it's definetely not common.\n. I believe I have repro steps and they suggest the issue may not be related to this library. It seems like the problem occurs when I try to refresh an expired access token during a POST (for instance I create a new event in a form on my website, hit \"Submit\", and it freezes when attempting to synch to Google to add the event to my calendar). But if I try to refresh the access token while processing a GET request it seems to work fine. And I'm calling the exact same API code...\nI can test it only every hour or so as I need to wait for the token to expire, so I'm not 100% sure yet this behavior is consistent. I'll be running more tests during the week and report back.\n. I'm going to close this issue as I seriously doubt the root of this problem comes from this library. I suspect something funky going on with my local dev webserver and/or Symfony. I'll let you know if I ever figure it out :) (for now I believe I found a workaround)\n. ",
    "thejaswip": "Probably you are right, I would suggest , to get rid of the method all together if i could ! is kind of duplicate and without serving much of purpose i could think of .\n. ## I guess you can close this ISSUE after the email from Google Below ,\nDear App Engine Developer, \nThe previous announcement contained an error.\nThe line \u201cThe tempnam() and sys_get_temp_dir() functions are not available\u201d should read as \u201cThe tempnam() and sys_get_temp_dir() functions are now available\u201d. \nApologies for the inconvenience. \n- The PHP for App Engine Team \n---- \u00a9 2015 Google Inc. 1600 Amphitheatre Parkway, Mountain View, CA 94043 \nYou have received this mandatory email service announcement to update you about important changes to Google Cloud Platform or your account.\n. +1\n. i agree with tibee ! please kindly review\n. +1\n. Me too , downgrading by using\ncomposer require firebase/php-jwt:4.0\nfixed the problem for me !!! largely this is becoming a problem when things are not getting properly tested with this library for example we should have some sort of max version set in the composer file for which this library has been tested without me having to google search for solutions !\n. ",
    "cajax": "Sure.\n. OK. So, after some testing I couldn't reporduce the problem on clean Symfony installation. Looks like it happens only to my large project with many dependecies and which was initially developed with old Google Apis lib (Zend).\nI believe you may close this issue. Sorry to bother you.\n. ",
    "deepak360": "Fatal error: Class 'Google_Service' not found in C:\\xampp\\htdocs\\database\\youtube\\Google\\Service\\YouTube.php on line 32\n. ",
    "cikatomo": "yes same\n. ",
    "avinashseth": "/signin.php - Class 'Google_Service_Plus' not found in gplus-quickstart-php-master/signin.php\n. ",
    "sktandon0121": "I have also this error @deepak360 \n. ",
    "nine-hundred": "I have also this error @deepak360 . ",
    "dawguk": "@ianbarber I did try a few tests using the API explorer, and I was getting the response that I expected, while in my code, I still was getting the wrong type returned.\nHowever, in testing this again today using identical code, it appears to be returning the correct ProductStatus type. Odd. Maybe something has been tweaked on the API, because I haven't updated my library.\nI will close this ticket for now as this issue doesn't appear to be relevant any more.\n. I understand that this is a closed issue, but I've just started seeing a number of issues (today) which points at some sort of SSL related issue in completely unrelated service calls and would like some more clarity.\nI'm performing custombatch() on Products, which is returning either one of two errors:\nSSL connect error\nor\nFailed to connect to 2a00:1450:4009:800::200a: Network is unreachable\nBoth look as though they are messages passed in directly from the API, as I don't appear to be able to find these strings in the library anywhere.\nShould the suggestion of using the cURL IO variant still stand in this case? If not, should I be raising a new issue?\n. ",
    "PaulNaylor": "Thanks!\n. ",
    "SteveEdson": "I'm not on app engine, but maybe it still applies?\nI've updated to the latest version of the SDK now, so I'll see how things go.\nCheers\n. Cool, thanks guys.\n. ",
    "toweringmedia": "I have the same issue, were you able to solve it? \n. I may have gotten past that last issue update shortly. This is what I did. \nDownload the latest version from here https://github.com/google/google-api-php-client/releases/tag/1.1.2. \nThanks Ian!\n. ",
    "damek132": "Got the same issue, library is installed with magento. The error is the following:\nFatal error: Class 'Google_Config' not found in /home/lasulaco/public_html/vendor/google/apiclient/src/Google/Client.php on line 80\nNow the line that seems to be a problem is the following:\nif (!class_exists('Google_Client')) {\nrequire_once realpath(dirname(FILE) . '/../../autoload.php');\n}\nWith the default src folder there is also an autoloader file, any ideas on this.\n. Perhaps this is to do with the https extension that you need to allow? Just a suggestion.\n. ",
    "makushatnik": "The same problem. I downloaded the google-api-client with help of Composer.\nGoogle_Config class don't exists in my /vendor directory.\nVersion of google-api-client - 2.0\n. ",
    "ildarkhasanshin": "same problem\nbut i helped in the project folder to run a command\ncomposer require google / apiclient: ^ 2.0\nhttps://github.com/google/google-api-php-client#installation\nubuntu 16.04\n. ",
    "joelbladt-zz": "I can't remember to restricted the developer key in a certain IP or IP Range. I have configured an Access Control with .htaccess on my server.\nCan this maybe reproduce the Error?\n. ",
    "vlastv": "I just submitted the CLA.\n. ",
    "maxgalbu": "The exception is on this line: https://github.com/google/google-api-php-client/blob/master/src/Google/Http/REST.php#L121\n. Probably this line is more correct:\nhttps://github.com/google/google-api-php-client/blob/e190c5b2ed586eaef431d4d0e5f7d6e72c0deb71/src/Google/Http/REST.php#L121. ",
    "giltotherescue": "I just submitted the CLA.\n. I checked the build failure. Here is what it says:\nPHP Fatal error:  Cannot redeclare class Google_Service_SQLAdmin_OperationError in /home/travis/build/google/google-api-php-client/src/Google/Service/SQLAdmin.php on line 2740\nI did not make any changes to this file, so there must be a pre-existing bug in this release.\n. ",
    "kevindecapite": "I'm getting the same error. It used to work and I haven't changed anything (to my knowledge). Running Mavericks 10.10.2.\n. What I don't understand, is why I'm not getting this error on my production version of this app, but only in my local environment.\n. I upgraded my openssl library to 1.0.2a via MacPorts and am still having the issue.\n. ",
    "ElteHupkes": "I'm not actually using this library, but found this issue through Google and figured I'd contribute my two cents.\nIt seems to be related to the new SSL certificate that Google issued for googleapis on March 19th. The domain used for the token endpoint (www.googleapis.com) is in this certificate's Alternative Names (the common name is *.storage.googleapis.com), which is somehow not picked up by stream_socket_client or the SSL library backing it. I suspect the configuration was different for the previous certificate, but I don't actually have it so I'm not sure.\nApart from disabling SSL host verification (which you shouldn't want) I currently have no idea how to circumvent this error unfortunately.\n. I read somewhere someone suggested updating libssl - if the bug is caused by that, there might just be different versions on your different machines.\nFor me, it's happening on production though :(.\n. ",
    "jonatanaxe": "https://github.com/bluevisiontec/GoogleShoppingApi/issues/24#issuecomment-85539228\n. ",
    "sam-ecomdev": "If anyone else is looking for a solution promotion_id is treated as a custom attribute.\nGeneric/custom attribute names are to be submitted without underscores. To submit a promotion id, use the following syntax:\n\"customAttributes\": [\n  {\n   \"name\": \"promotion id\",\n   \"type\": \"text\",\n   \"value\": \"foo\"\n  }\n ]\n. ",
    "Ewan-GrandSlam": "Thats the weird part, my above code doesnt actually seem to throw a real error (on the insert or maybe im reading that error wrong)\nother errors i get would be a stacktrace leading to the REST.php ill try to get more detailed when I can reach those logs once again.\n. It seemed to be an issue with bigquery itself.\n. ",
    "johnbacon": "The CLA has been signed.\nOn Fri, Apr 3, 2015 at 2:46 PM, googlebot notifications@github.com wrote:\n\nThanks for your pull request.\nIt looks like this may be your first contribution to a Google open source\nproject, in which case you'll need to sign a Contributor License Agreement\n(CLA) at https://cla.developers.google.com/.\nIf you've already signed a CLA, it's possible we don't have your GitHub\nusername or you're using a different email address. Check the information\non your CLA https://cla.developers.google.com/clas or see this help\narticle on setting the email on your git commits\nhttps://help.github.com/articles/setting-your-email-in-git/.\nOnce you've done that, please reply here to let us know. If you signed the\nCLA as a corporation, please let us know the company's name.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/516#issuecomment-89389279\n.\n. \n",
    "Blueprinter": "Oh, okay.  I get it now.  The user isn't supposed to substitute their client Id into that spot.  Yah, I did easily misunderstand that.\n. ",
    "mbn18": "@ianbarber , more info about the process. Let me know if you need anything else.\n1. I use Google Apps for domain.\n2. the caller is a server with a private key and allowed scopes (No need for the client to auth)\n3. The script use delegation to support all the domain users\n4. API version is 1.1.2\nThis is the construct:\n``` php\npublic function __construct($userEmail)\n{\n    $credentials = new Google_Auth_AssertionCredentials (\n        $this->clientEmail,\n        $this->scopes,\n        $this->getPrivateKeyContent(),\n        'notasecret',\n        'http://oauth.net/grant_type/jwt/1.0/bearer',\n        $userEmail\n    );\n$this->client = new Google_Client();\n$this->client->setAssertionCredentials($credentials);\n\n}\n```\nHere I batch and pass the request\n``` php\n$messages = $this->getService()->users_messages->listUsersMessages('me', $params);\n$this->client->setUseBatch(true);\n$batch = new \\Google_Http_Batch($this->client);\nif (!empty($messages)) {\n    foreach ($messages as $message) {\n        $req = $this->getService()->users_messages->get('me', $message->getId(), ['format'=>'metadata', 'metadataHeaders'=>['From', 'Subject']]);\n        $batch->add($req);\n    }\n    $results = $batch->execute();\n```\nAnd the dump unfiltered with all the headers from the answer:\narray (size=20)\n  0 => \n    object(Google_Service_Gmail_MessagePartHeader)[622]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'Delivered-To' (length=12)\n      public 'value' => string 'contact@some-domain.co.il' (length=21)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  1 => \n    object(Google_Service_Gmail_MessagePartHeader)[631]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'Received' (length=8)\n      public 'value' => string 'by 10.182.113.39 with SMTP id iv7csp1208020obb;        Fri, 10 Apr 2015 09:58:11 -0700 (PDT)' (length=92)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  2 => \n    object(Google_Service_Gmail_MessagePartHeader)[632]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'X-Received' (length=10)\n      public 'value' => string 'by 10.180.214.99 with SMTP id nz3mr6585724wic.82.1428685089012;        Fri, 10 Apr 2015 09:58:09 -0700 (PDT)' (length=108)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  3 => \n    object(Google_Service_Gmail_MessagePartHeader)[633]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'Return-Path' (length=11)\n      public 'value' => string '<user@some-domain.com>' (length=22)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  4 => \n    object(Google_Service_Gmail_MessagePartHeader)[634]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'Received' (length=8)\n      public 'value' => string 'from omail120.walla.co.il (omail120.walla.co.il. [192.118.71.120])        by mx.google.com with ESMTPS id ur1si3986432wjc.192.2015.04.10.09.58.08        for <contact@some-domain.co.il>        (version=TLSv1 cipher=RC4-SHA bits=128/128);        Fri, 10 Apr 2015 09:58:09 -0700 (PDT)' (length=277)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  5 => \n    object(Google_Service_Gmail_MessagePartHeader)[635]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'Received-SPF' (length=12)\n      public 'value' => string 'pass (google.com: domain of user@some-domain.com designates 192.118.71.120 as permitted sender) client-ip=192.118.71.120;' (length=121)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  6 => \n    object(Google_Service_Gmail_MessagePartHeader)[636]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'Authentication-Results' (length=22)\n      public 'value' => string 'mx.google.com;       spf=pass (google.com: domain of user@some-domain.com designates 192.118.71.120 as permitted sender) smtp.mail=user@some-domain.com' (length=151)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  7 => \n    object(Google_Service_Gmail_MessagePartHeader)[637]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'Received' (length=8)\n      public 'value' => string 'from omail120.walla.co.il (omail120 [127.0.0.1]) by omail120.walla.co.il (8.14.3/8.13.5) with ESMTP id t3AGw7Cn025409 for <contact@some-domain.co.il>; Fri, 10 Apr 2015 19:58:07 +0300' (length=178)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  8 => \n    object(Google_Service_Gmail_MessagePartHeader)[638]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'Received' (length=8)\n      public 'value' => string '(from informix@localhost) by omail120.walla.co.il (8.14.3/8.13.1/Submit) id t3AGw76C025406; Fri, 10 Apr 2015 19:58:07 +0300' (length=123)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  9 => \n    object(Google_Service_Gmail_MessagePartHeader)[639]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'Date' (length=4)\n      public 'value' => string 'Fri, 10 Apr 2015 19:58:07 +0300' (length=31)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  10 => \n    object(Google_Service_Gmail_MessagePartHeader)[640]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'Received' (length=8)\n      public 'value' => string 'from ([109.67.180.44]) by omail120.walla.co.il ([192.118.71.120]) with HTTP; Fri, 10 Apr 2015 19:58:07 +0300' (length=108)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  11 => \n    object(Google_Service_Gmail_MessagePartHeader)[641]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'From' (length=4)\n      public 'value' => string '\"Some string\" <user@some-domain.com>' (length=42)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  12 => \n    object(Google_Service_Gmail_MessagePartHeader)[642]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'X-Sender' (length=8)\n      public 'value' => string 'user@some-domain.com' (length=20)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  13 => \n    object(Google_Service_Gmail_MessagePartHeader)[643]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'X-Originating-Email' (length=19)\n      public 'value' => string '[user@some-domain.com]' (length=22)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  14 => \n    object(Google_Service_Gmail_MessagePartHeader)[644]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'X-Originating-IP' (length=16)\n      public 'value' => string '[109.67.180.44]' (length=15)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  15 => \n    object(Google_Service_Gmail_MessagePartHeader)[645]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'To' (length=2)\n      public 'value' => string '<contact@some-domain.co.il>' (length=23)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  16 => \n    object(Google_Service_Gmail_MessagePartHeader)[646]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'Subject' (length=7)\n      public 'value' => string 'Re: Some string' (length=42)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  17 => \n    object(Google_Service_Gmail_MessagePartHeader)[647]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'Message-Id' (length=10)\n      public 'value' => string '<some-id@some-domain.com>' (length=44)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  18 => \n    object(Google_Service_Gmail_MessagePartHeader)[648]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'MIME-Version' (length=12)\n      public 'value' => string '1.0' (length=3)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n  19 => \n    object(Google_Service_Gmail_MessagePartHeader)[649]\n      protected 'internal_gapi_mappings' => \n        array (size=0)\n          empty\n      public 'name' => string 'Content-Type' (length=12)\n      public 'value' => string 'multipart/mixed; boundary=\"------=_EREZ_P_WallaMail_70097_2061_P_0\"' (length=67)\n      protected 'modelData' => \n        array (size=0)\n          empty\n      protected 'processed' => \n        array (size=0)\n          empty\n. ",
    "carbonturtle": "I'm having the same issue, where it works as expected if I specify ONE header name in the metadataHeaders argument, but if use more than one, the get request returns ALL headers.  Is there a way to pass multiple headers via the metadataHeaders parameter that works?\n(btw, I saw that 1.1.3 was just released so I updated right away, hoping it would fix this problem, but no such luck.)\nEDIT: Just wanted to confirm that the request URL appears to be corrected formed, at least insofar as the metadataHeaders values are concerned:\nhttps://www.googleapis.com/gmail/v1/users/me/messages/14cafef24d50346f?format=metadata&metadataHeaders=Subject&metadataHeaders=From\n. I made the same request using the API Explorer, and it worked as expected-- showing only the 2 headers I requested.  The request URL it shows is this:\nhttps://www.googleapis.com/gmail/v1/users/me/messages/14cafef24d50346f?metadataHeaders=from&metadataHeaders=subject&format=metadata&key={YOUR_API_KEY}\nI noticed that the field names were all lowercase, so I changed my code accordingly, but it didn't make a difference.  My request URL (obtained using a call to the getUrl() method) doesn't have the key, but I assume the request is getting authenticated, since it does return information (albeit more than I'm requesting).\nIs it possible that the order of the parameters is making the difference?  That's the only other difference I see...\n. ",
    "bananastalktome": "I am having the same problem, and it appears that it only occurs when requests are made using Google_Http_Batch. When making requests without batching, specifying individual headers to return (using $client->users_messages->get('me', $message->getId(), array('format' => 'metadata', 'metadataHeaders' => ['From', 'To'])); for example) works fine.\nEDIT:\nLooking a bit deeper, it seems that the Google_Http_Batch::execute function calls toBatchString on the request object (I assume this is the Google_Http_Request::toBatchString function), which uses php's http_build_query function to turn the params passed in to query params.\nWhen calling a batch request for a message using, for example, $client->users_messages->get('me', $message->getId(), array('format' => 'metadata', 'metadataHeaders' => ['From', 'To']));, the params are turned to ?format=metadata&metadataHeaders%5B0%5D=From&metadataHeaders%5B1%5D=To as a result. Passing only a single string (or an array with only a single value) for metadataHeaders does not result in this issue.\n. ",
    "blacksage21": "Perhaps the solution is to circumvent the API Library and make the calls through cUrl. If performance is an issue,  i came across a multirequest/asynchronous cUrl library; Multirequest. \nIt probably means you wont be able to use Google's native classes but it should get the job done.\n. ",
    "orougereaumelijoe": "Same problem, in batch mode.\n. ",
    "laurencei": "@tmatsuo - its working for me\n$service->users_messages->get('me',$message->getId(), ['format' => 'metadata', 'metadataHeaders' => ['To', 'Subject']]);.\n",
    "polothy": "Thanks for the reply, I'll go with the .p12 file.\n. ",
    "chancegarcia": "I noticed the same issue when re-running the auth process.\nOn the second run through of \nphp\n $client->authenticate($_GET['code']);\nwill return an access token but fail to give you a refresh token as requested.\nThis seems to be because you haven't manually revoked the token through the google account/security settings (https://security.google.com/settings/security/permissions).\n. ",
    "harshitism": "Can you please help me out how to resolve this problem .\nI have hosted my website on bigrock server and try to integrate google login.\n. ",
    "coinsprofit": "Thank you!\nI asked questions. But received no answer:\nhttp://stackoverflow.com/questions/29759826/enabling-the-live-broadcastings-via-api\nhttps://webapps.stackexchange.com/questions/76240/enabling-the-live-broadcastings-via-api\n. ",
    "samuelsh": "Yep,\nLooks like a WAD.\n\"Please make sure you use EXACTLY the same openid.realm value during the migration flows as you used during the initial OpenID2 flows: any mismatch in those values (even a missing trailing slash char) will lead to completely different openid identifier values.\"\nhttp://stackoverflow.com/a/23051643/524743\nThanks Ian\n. ",
    "gmorel": ":+1: \n. ",
    "DimitriGilbert": "Sorry, i had something overwriting my credential on the server. i just found out.\n. ",
    "woofyman99": "Pull request sent.  The sample code actually work fine since it\u2019s using a local file.  If you were reading from a URL, it would be very slow.\nThis code monkey\u2019s your sample code and is very, very, very slow.\nhttps://developers.google.com/youtube/v3/code_samples/php#resumable_uploads https://developers.google.com/youtube/v3/code_samples/php#resumable_uploads\n\nOn Apr 27, 2015, at 1:02 PM, Ian Barber notifications@github.com wrote:\nInteresting, thanks! Please do send a pull request if you have an improved version of the chunking.\n\u2014\nReply to this email directly or view it on GitHub https://github.com/google/google-api-php-client/issues/546#issuecomment-96741304.\n. The pull request was already merged.\nOn Feb 15, 2017, at 12:59 PM, Takashi Matsuo notifications@github.com wrote:\n@woofyman99 https://github.com/woofyman99 Hi, thanks for the report. where is the pull request?\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub https://github.com/google/google-api-php-client/issues/546#issuecomment-280087764, or mute the thread https://github.com/notifications/unsubscribe-auth/AAVy3A4IL-p6gmiyIkdUS11HmEBhCJIpks5rcz0IgaJpZM4EIBV0.\n\n\n. No problem, done.\n. ",
    "notsureifkevin": ":+1: there are certain features in dev-master that we could use. With >250 commits untagged, it seems to me that a new tag would be on the horizon.\n. ",
    "TeckniX": "Just another proof:\n'https://developers.google.com/analytics/devguides/reporting/core/v3/coreDevguide'  - Last updated April 7, 2015.\nYet the call to the PHP analytics service is: $analytics = new apiAnalyticsService($client); :-1: \n. @kesar :+1:  :100: \nI'll try to keep my code clean and create a PR for an Analytics PR :P \n. I agree :100: on the Documentation being bad.\nThis is how I do my authentication and it seems to work well:\n``` php\nrequire_once 'google-api-php-client/src/Google/autoload.php';\nsession_start();\n$client = new Google_Client();\n$client->setApplicationName('Hello Analytics API Sample');\n/********\n  If we have an access token, we can carry on.\n  Otherwise, we'll get one with the help of an\n  assertion credential. In other examples the list\n  of scopes was managed by the Client, but here\n  we have to list them manually. We also supply\n  the service account\n **********/\n$cred = new Google_Auth_AssertionCredentials(\n    $client_email,\n    $scopes,\n    $private_key\n);\nif (isset($_SESSION['service_token'])) {\n  $client->setAccessToken($_SESSION['service_token']);\n} else {\n  $client->setAssertionCredentials($cred);\n}\nif ($client->getAuth()->isAccessTokenExpired()) {\n  $client->getAuth()->refreshTokenWithAssertion($cred);\n}\n$_SESSION['service_token'] = $client->getAccessToken();\n// Create service object\n$storageService =  new Google_Service_Storage($client);\n```\nOne of the key elements missing from your sample is the following:\ninclude_once \"templates/base.php\";\nWhich was taken from: https://github.com/google/google-api-php-client/blob/master/examples/service-account.php\nIf you look at the template definition: https://github.com/google/google-api-php-client/blob/master/examples/templates/base.php it has the proper pageHeader function that you mentioned.\n. I made some quick edits to my comments - make sure it's all the same.\nOr provide more details on the error.\n. Glad it all got worked out :+1: \n. ",
    "alessioguglielmo": "Ok, I've added your code in my page. It blocks execution on\n$client->getAuth()->refreshTokenWithAssertion($cred);\nand fails page loading\nMoreover, my webserver is running on an VM which has read_only rights on the storage, I changed\n$scopes = array('https://www.googleapis.com/auth/devstorage.read_only');\nsame results\n. Ok, was a \"file not found\" problem. Private key must be placed in webserver root directory, not the same directory where is placed PHP page, in order to work correctly with file_get_contents function.\nThanks for the help!\nB.R.\n. ",
    "franchos25": "tanks. \n. ",
    "imotski": "Hi Ianbarber,\ncould you please post an actual google-api-user-example. Your link doesn't function.\nthx. ",
    "TopResults": "Will that was close but still not uploading. I inserted your suggestion and it looks to be running as it takes longer to execute. Than when done no uploaded video and no var_dumps on status or media. Which tells me that caused an error. If I remove your suggestion still no upload but I do get var_dump data.\nAny one have issues? I am using the latest version of this package.\n. Yes here is what I am using - which includes your execute code. The var_dumps do not even execute when inserting $client->execute($insertRequest); if I remove this all is OK. I will post those in a separate post.\n$key = file_get_contents($_SERVER['DOCUMENT_ROOT'] . '/google-api-php-client/token.txt');\nset_include_path($_SERVER['DOCUMENT_ROOT'] . '/google-api-php-client/');\nrequire_once 'src/Google/autoload.php';\nrequire_once 'src/Google/Client.php';\nrequire_once 'src/Google/Service/YouTube.php';\n$application_name = 'Video Uploader';\n$client_secret = 'xxxxxxxxxxxxxxxxxxx';\n$client_id = 'xxxxxxxxxxxxxxxxxxx.apps.googleusercontent.com';\n$scope = array('https://www.googleapis.com/auth/youtube.upload', 'https://www.googleapis.com/auth/youtube', 'https://www.googleapis.com/auth/youtubepartner');\n$videoPath = \"/i2v/out/\".$row[\"outputPath\"];\ntry {\n    $client = new Google_Client();\n    $client->setApplicationName($application_name);\n    $client->setClientId($client_id);\n    $client->setAccessType('offline');\n    $client->setAccessToken($key);\n    $client->setScopes($scope);\n    $client->setClientSecret($client_secret);\n    if ($client->getAccessToken()) {\n        if ($client->isAccessTokenExpired()) {\n            $newToken = json_decode($client->getAccessToken());\n            $client->refreshToken($newToken->refresh_token);\n            file_put_contents($_SERVER['DOCUMENT_ROOT'] . '/google-api-php-client/token.txt', $client->getAccessToken());\n        }\n        $youtube = new Google_Service_YouTube($client);\n        $snippet = new Google_Service_YouTube_VideoSnippet();\n        $snippet->setTitle($videoTitle);\n        $snippet->setDescription($videoDescription);\n        $snippet->setTags($videoTags);\n        $snippet->setCategoryId(\"22\");\n        $status = new Google_Service_YouTube_VideoStatus();\n        $status->privacyStatus = \"public\";\n        $video = new Google_Service_YouTube_Video();\n        $video->setSnippet($snippet);\n        $video->setStatus($status);\n        $client->setDefer(true);\n        $insertRequest = $youtube->videos->insert(\"status,snippet\", $video);\n        $media = new Google_Http_MediaFileUpload(\n            $client,\n            $insertRequest,\n            'video/*',\n            null,\n            false\n        );\n        $client->execute($insertRequest);\n        $client->setDefer(false);\n        var_dump($status);\n        var_dump($media);\n    }\n}\n. Here is the results for the var_dump($status); and var_dump($media); which I only get if execute is not inserted. I xxx out my tokens from these posts - they are being process correctly in the originals.\nThanks so much for helping as maybe I am just missing something (crossing fingers)\n```\nobject(Google_Service_YouTube_VideoStatus)#30 (11) {\n  [\"internal_gapi_mappings\":protected]=>\n  array(0) {\n  }\n  [\"embeddable\"]=>\n  NULL\n  [\"failureReason\"]=>\n  NULL\n  [\"license\"]=>\n  NULL\n  [\"privacyStatus\"]=>\n  string(6) \"public\"\n  [\"publicStatsViewable\"]=>\n  NULL\n  [\"publishAt\"]=>\n  NULL\n  [\"rejectionReason\"]=>\n  NULL\n  [\"uploadStatus\"]=>\n  NULL\n  [\"modelData\":protected]=>\n  array(0) {\n  }\n  [\"processed\":protected]=>\n  array(0) {\n  }\n}\nobject(Google_Http_MediaFileUpload)#49 (11) {\n  [\"mimeType\":\"Google_Http_MediaFileUpload\":private]=>\n  string(7) \"video/\"\n  [\"data\":\"Google_Http_MediaFileUpload\":private]=>\n  NULL\n  [\"resumable\":\"Google_Http_MediaFileUpload\":private]=>\n  bool(false)\n  [\"chunkSize\":\"Google_Http_MediaFileUpload\":private]=>\n  int(262144)\n  [\"size\":\"Google_Http_MediaFileUpload\":private]=>\n  int(0)\n  [\"resumeUri\":\"Google_Http_MediaFileUpload\":private]=>\n  NULL\n  [\"progress\":\"Google_Http_MediaFileUpload\":private]=>\n  int(0)\n  [\"client\":\"Google_Http_MediaFileUpload\":private]=>\n  object(Google_Client)#1 (9) {\n    [\"auth\":\"Google_Client\":private]=>\n    object(Google_Auth_OAuth2)#3 (4) {\n      [\"assertionCredentials\":\"Google_Auth_OAuth2\":private]=>\n      NULL\n      [\"state\":\"Google_Auth_OAuth2\":private]=>\n      NULL\n      [\"token\":\"Google_Auth_OAuth2\":private]=>\n      array(5) {\n        [\"access_token\"]=>\n        string(83) \"xxxxxxxxxxxxxxxxxxx\"\n        [\"token_type\"]=>\n        string(6) \"Bearer\"\n        [\"expires_in\"]=>\n        int(3600)\n        [\"refresh_token\"]=>\n        string(66) \"xxxxxxxxxxxxxxxxxxx\"\n        [\"created\"]=>\n        int(1432074295)\n      }\n      [\"client\":\"Google_Auth_OAuth2\":private]=>\n      RECURSION\n    }\n    [\"io\":\"Google_Client\":private]=>\n    object(Google_IO_Curl)#7 (2) {\n      [\"options\":\"Google_IO_Curl\":private]=>\n      array(2) {\n        [78]=>\n        int(100)\n        [13]=>\n        int(100)\n      }\n      [\"client\":protected]=>\n      RECURSION*\n    }\n    [\"cache\":\"Google_Client\":private]=>\n    NULL\n    [\"config\":\"Google_Client\":private]=>\n    object(Google_Config)#2 (1) {\n      [\"configuration\":protected]=>\n      array(7) {\n        [\"application_name\"]=>\n        string(26) \"Video Uploader\"\n        [\"auth_class\"]=>\n        string(18) \"Google_Auth_OAuth2\"\n        [\"io_class\"]=>\n        string(14) \"Google_IO_Curl\"\n        [\"cache_class\"]=>\n        string(17) \"Google_Cache_File\"\n        [\"logger_class\"]=>\n        string(18) \"Google_Logger_Null\"\n        [\"base_path\"]=>\n        string(26) \"https://www.googleapis.com\"\n        [\"classes\"]=>\n        array(9) {\n          [\"Google_IO_Abstract\"]=>\n          array(1) {\n            [\"request_timeout_seconds\"]=>\n            int(100)\n          }\n          [\"Google_Logger_Abstract\"]=>\n          array(4) {\n            [\"level\"]=>\n            string(5) \"debug\"\n            [\"log_format\"]=>\n            string(42) \"[%datetime%] %level%: %message% %context%\n\"\n            [\"date_format\"]=>\n            string(13) \"d/M/Y:H:i:s O\"\n            [\"allow_newlines\"]=>\n            bool(true)\n          }\n          [\"Google_Logger_File\"]=>\n          array(3) {\n            [\"file\"]=>\n            string(12) \"php://stdout\"\n            [\"mode\"]=>\n            int(416)\n            [\"lock\"]=>\n            bool(false)\n          }\n          [\"Google_Http_Request\"]=>\n          array(2) {\n            [\"disable_gzip\"]=>\n            bool(true)\n            [\"enable_gzip_for_uploads\"]=>\n            bool(false)\n          }\n          [\"Google_Auth_OAuth2\"]=>\n          array(13) {\n            [\"client_id\"]=>\n            string(72) \"xxxxxxxxxxxxxxxxxxx.apps.googleusercontent.com\"\n            [\"client_secret\"]=>\n            string(24) \"xxxxxxxxxxxxxxxxxxx\"\n            [\"redirect_uri\"]=>\n            string(0) \"\"\n            [\"developer_key\"]=>\n            string(0) \"\"\n            [\"hd\"]=>\n            string(0) \"\"\n            [\"prompt\"]=>\n            string(0) \"\"\n            [\"openid.realm\"]=>\n            string(0) \"\"\n            [\"include_granted_scopes\"]=>\n            string(0) \"\"\n            [\"login_hint\"]=>\n            string(0) \"\"\n            [\"request_visible_actions\"]=>\n            string(0) \"\"\n            [\"access_type\"]=>\n            string(7) \"offline\"\n            [\"approval_prompt\"]=>\n            string(4) \"auto\"\n            [\"federated_signon_certs_url\"]=>\n            string(42) \"https://www.googleapis.com/oauth2/v1/certs\"\n          }\n          [\"Google_Task_Runner\"]=>\n          array(5) {\n            [\"initial_delay\"]=>\n            int(1)\n            [\"max_delay\"]=>\n            int(60)\n            [\"factor\"]=>\n            int(2)\n            [\"jitter\"]=>\n            float(0.5)\n            [\"retries\"]=>\n            int(0)\n          }\n          [\"Google_Service_Exception\"]=>\n          array(1) {\n            [\"retry_map\"]=>\n            array(4) {\n              [500]=>\n              int(-1)\n              [503]=>\n              int(-1)\n              [\"rateLimitExceeded\"]=>\n              int(-1)\n              [\"userRateLimitExceeded\"]=>\n              int(-1)\n            }\n          }\n          [\"Google_IO_Exception\"]=>\n          array(1) {\n            [\"retry_map\"]=>\n            array(5) {\n              [6]=>\n              int(-1)\n              [7]=>\n              int(-1)\n              [28]=>\n              int(-1)\n              [35]=>\n              int(-1)\n              [52]=>\n              int(-1)\n            }\n          }\n          [\"Google_Cache_File\"]=>\n          array(1) {\n            [\"directory\"]=>\n            string(18) \"/tmp/Google_Client\"\n          }\n        }\n      }\n    }\n    [\"logger\":\"Google_Client\":private]=>\n    object(Google_Logger_Null)#5 (4) {\n      [\"level\":protected]=>\n      int(100)\n      [\"logFormat\":protected]=>\n      string(42) \"[%datetime%] %level%: %message% %context%\n\"\n      [\"dateFormat\":protected]=>\n      string(13) \"d/M/Y:H:i:s O\"\n      [\"allowNewLines\":protected]=>\n      bool(true)\n    }\n    [\"deferExecution\":\"Google_Client\":private]=>\n    bool(false)\n    [\"requestedScopes\":protected]=>\n    array(3) {\n      [0]=>\n      string(46) \"https://www.googleapis.com/auth/youtube.upload\"\n      [1]=>\n      string(39) \"https://www.googleapis.com/auth/youtube\"\n      [2]=>\n      string(46) \"https://www.googleapis.com/auth/youtubepartner\"\n    }\n    [\"services\":protected]=>\n    array(0) {\n    }\n    [\"authenticated\":\"Google_Client\":private]=>\n    bool(false)\n  }\n  [\"request\":\"Google_Http_MediaFileUpload\":private]=>\n  object(Google_Http_Request)#32 (15) {\n    [\"batchHeaders\":\"Google_Http_Request\":private]=>\n    array(3) {\n      [\"Content-Type\"]=>\n      string(16) \"application/http\"\n      [\"Content-Transfer-Encoding\"]=>\n      string(6) \"binary\"\n      [\"MIME-Version\"]=>\n      string(3) \"1.0\"\n    }\n    [\"queryParams\":protected]=>\n    array(2) {\n      [\"part\"]=>\n      string(14) \"status,snippet\"\n      [\"uploadType\"]=>\n      string(9) \"multipart\"\n    }\n    [\"requestMethod\":protected]=>\n    string(4) \"POST\"\n    [\"requestHeaders\":protected]=>\n    array(2) {\n      [\"content-type\"]=>\n      string(36) \"multipart/related; boundary=92065581\"\n      [\"authorization\"]=>\n      string(90) \"Bearer xxxxxxxxxxxxxxxxxxx\"\n    }\n    [\"baseComponent\":protected]=>\n    string(33) \"https://www.googleapis.com/upload\"\n    [\"path\":protected]=>\n    string(18) \"/youtube/v3/videos\"\n    [\"postBody\":protected]=>\n    string(808) \"--92065581\nContent-Type: application/json; charset=UTF-8\n{\"snippet\":{\"categoryId\":\"22\",\"description\":\"Video description goes here\",\"tags\":[\"Tag One\",\"Tag Two\",\"Tag Three\"],\"title\":\"Video title goes here\"},\"status\":{\"privacyStatus\":\"public\"}}\n--92065581\nContent-Type: video/*\nContent-Transfer-Encoding: base64\n--92065581--\"\n    [\"userAgent\":protected]=>\n    NULL\n    [\"canGzip\":protected]=>\n    NULL\n    [\"responseHttpCode\":protected]=>\n    NULL\n    [\"responseHeaders\":protected]=>\n    NULL\n    [\"responseBody\":protected]=>\n    NULL\n    [\"expectedClass\":protected]=>\n    string(28) \"Google_Service_YouTube_Video\"\n    [\"expectedRaw\":protected]=>\n    bool(false)\n    [\"accessKey\"]=>\n    NULL\n  }\n  [\"boundary\":\"Google_Http_MediaFileUpload\":private]=>\n  bool(false)\n  [\"httpResultCode\":\"Google_Http_MediaFileUpload\":private]=>\n  NULL\n}\n```\n. Sorry about that; I just realize what you meant. There is a new coding to download. I been away and just read that email letting me know about your new version. Let me download and try this. BRB\n. I updated to the latest version and still the same results with no vars being dumped. If I block out that one section, I get the results, just not the ones I was hoping for.\nI just checked the var_dumps and they are the same as noted above - in case this is something I am doing wrong and if that is the case I apologize.\n. This seems to be where I am having my issue with this script.\n$status = $media->nextChunk($chunk);\nIf I comment this out the script works but doesn't upload. It use it the script stalls out and there are no errors what so ever, I have PHP setup to track full errors and it isn't detecting nothing.\n. Ok, this looks promising. I am now getting the following error from Google. What I did was turn off throw exceptions within your scripting.\nAfter doing this I get my status results from Google and here is why it isn't uploading.\n[\"responseBody\":protected]=>\n    string(259) \"{\n        \"error\": {\n            \"errors\": [\n            {\n            \"domain\": \"youtube.video\",\n                \"reason\": \"invalidDescription\",\n                \"message\": \"Bad Request\",\n                \"locationType\": \"other\",\n                \"location\": \"body.snippet.description\"\n            }\n            ],\n        \"code\": 400,\n        \"message\": \"Bad Request\"\n    }\n}\nI have HTML in my description - I have  we not allowed these?\n. Solved, I was using  which was allowed in JAVA Applets. I switched to PHP and kept the same format. Not allowed.\nAs for PHP Exceptions - that is just odd that the server I am using has an issue with them and why I wasn't getting any errors to track. I had to go old school and track line by line until I found what gave.\nI am using PHP 5.3.3 - either or, all is good and I am uploading. Thanks so much for your patience.\n. ",
    "nebadom": "I did it by using try / catch because every once in a while google servers fails... and when that happens, you end up with just a fraction of the messages.\nTry using this:\ntry {\n        $messages = $service->users_messages->listUsersMessages('me',$optParams);\n    } catch (Exception $e) {            // if any error is detected\n        return false;               // exits the function\n    }\nWhat I did was to get the nextpage token in EVERY query, then retrieve 100 messages ID, then try again using the nextpage token retrieved in the previous pass.\nAnd I've been able to get ALL the messages. It works, it's just a pain to do it.\n. I did it the \"hard way\": I retrieve every nextpage token and then retrieved every 500 items in batches, using a \"task\". Doing so it could take several minutes processing it, but it worked for the purpose I wanted it.. I have a open ticket on this subject:\nhttps://github.com/google/google-api-php-client/issues/608\nWith no response so far.\n. I'm getting this error every other week, and for one day only. Something is wrong with the SSL and the API. I just can't find what it is.\nThe good part: it doesn't affect functionality. Being honest, it is just garbage in the log.\n. The error is back...I'm gettin tons of this errors in the log, yet the application is working.\nI just don't know what it is or what part of the code is triggering the error.\nAny suggestions? anybody?\n. I've been studing this thing and I'm thinking - please correct me if I'm wrong - that this could be a certificate error: cacerts.pem.\nLooking into Stream.php (the only place in the code where the 'cafile' is present), I can see that the code is loading a public certificate list. And I took the liberty to check every certificate... all of them valid.\nSo, again, if anyone has a clue of what might be going on, that will be most appreciated.\n. I commented the line 91 as proposed and it worked like a charm.\nThanks!\n. Im just testing the last tagged version (1.1.5) and the \"Unsupported SSL context options are set. The following options are present, but have been ignored: cafile\" is still present.\n. I'm using google cloud. I have no php.ini but app.yaml. And no, I have no such \"curl.cafile\" anywhere in my code.\nWhat I'm doing is the same as before: commented the line 91 from Stream.php (even with the last 1.1.5 version) and I got rid of the log errors related to cafile. Is not what we might call a \"clean solution\", but it works.\n. @ajck the file is inside the Google Api Php client folder:\n\\google-api-php-client\\src\\Google\\IO\\Stream.php\n. Try $this->commit() at the end of the exec() to stop batching.\n. I have made a change in the app.yaml so every logged in user in gmail gets served a different uri from my app. That works. Now I face a new issue: how can I make the PHPSESSID and SACSID cookies to use an specific path instead of the whole domain?\nI've read the whole documentation about the UserService but it seems all I can do is redirect to this:\nUserService::createLoginURL($_SERVER['REQUEST_URI']);\nAnd that takes care of the authentication. How can I restringe the scope so the cookies gets the appropriate path?\n. I had this issue \"kind of\" solved assigning a SACSID cookie to individual paths in my server. So, each concurrent user would get served a different \"folder\", each with an unique SACSID cookie. Doing that, I was able to allow up to 4 concurrent users to work with my app.\nThen, on monday this week (Feb 1st, 2016) everything started to fail: the session_start() would not recognize but the root SACSID, allowing one and only one user at-a-time to access my app. I assume that some changes were made to the server system breaking my \"hack\". Really guys???\nDoes anyone, really, anyone knows how to allow multiple signed-in users? Any tips?\n. Put it this way:\nI have this app that I want multiple users from the SAME browser to access it. I'm talking:  I want users from gmail to access my app. Currently, only the 1st user of Google/Gmail (the main user) is allowed to access my app. If I want another user, I have to trigger UserService::createLoginURL($_SERVER['REQUEST_URI']); if I want another user to access it. Most frustrating is that I can't have multiple users from the same browser accessing my app simultaneusly.\nIs there a way I can overcome this? I used to play with the SACSID cookies so I could define one per user per path. But now, all of the sudden this week, that stopped from working... is like if the session manager is not reading any SACSID cookie that is not \"root\".\n. Basically, what I want is to mimick the google ?authuser=1 behavior. Any thoughts?\n. Ok, I was able to do this by:\n- Asking authorization to each user attempting to access the folders\n- Storing the user information into $_SESSION (into an array)\n- Comparing such array data to the user attepmting to access the path: if it was not authorized to that path, then prompts for authorization.\nSo far so good. I'm back in business.\n. ",
    "erickoledadevrel": "I would suggest the ladder. Regardless of what the API supports or defaults to, the library must have JSON returned in order to function correctly. Therefore I think it should explicitly request it for all requests. \n. The rootUrl field in the discovery document does contains the slash by default, and since you are naming this field root_url instead of base_path it's probably better to have it respect the format of rootUrl and contain the trailing slash.\n. ",
    "navneet10sep": "According to me issue is in the google-api-php-client because it works in the API explorer page. \nhttps://developers.google.com/gmail/api/v1/reference/users/threads/list. \nHere is the code i tried from the example \nfunction listThreads($service, $userId) {\n  $threads = array();\n  $pageToken = NULL;\n  do {\n    try {\n      $opt_param = array( 'maxResults'  => 1   );\n      if ($pageToken) {\n        $opt_param['pageToken'] = $pageToken;\n      }\n      $threadsResponse = $service->users_threads->listUsersThreads($userId, $opt_param);\n      if ($threadsResponse->getThreads()) {\n        $threads = array_merge($threads, $threadsResponse->getThreads());\n        $pageToken = $threadsResponse->getNextPageToken();\n      }\n    } catch (Exception $e) {\n      print 'An error occurred: ' . $e->getMessage();\n      $pageToken = NULL;\n    }\n  } while ($pageToken);\nforeach ($threads as $thread) {\n    print 'Thread with ID: ' . $thread->getId() . '';\n  }\nreturn $threads;\n}\n. ",
    "rahnas": "is it not fixed yet?. ",
    "ak8zs": "It is working..\ni was doing the same mistake as in posted code.. remove the loop which checks for nextPageToken. \nfor fixing see Stackover Flow\n. ",
    "bustamantelujano": "\nIt is working..\ni was doing the same mistake as in posted code.. remove the loop which checks for nextPageToken.\nfor fixing see Stackover Flow\n\nThis works for me, thanks :D. ",
    "tehmaestro": "I signed the cla.\n. ",
    "jonathanhunsucker": "If you don't want to modify the source code to add the custom rootUrl, create an ini file with these contents:\nbase_path = 'https://pubsub.googleapis.com'\nThen inject the configuration, by creating the client like so, instead:\n$client = new Google_Client(new Google_Config($path_to_your_ini));\nOnce pubsub exits beta, it might be migrated to www.google.com, which would save us from this wokaround.\n. ",
    "s-chizhik": "@bshaffer, I've tested my code with dev-master revision. Seems it works fine! Would you be kind to tag this changes?\n. Also, when somebody will make a tag, look please to this small fix.\n. Suppose I can close this issue due to date.\n. +1\nAlso, I guess it might be related => https://github.com/google/google-api-php-client/issues/567\n. Anybody here?\n. @bshaffer, so what we're going to do? :grinning:\n. ",
    "kumardippu": "Below are the code I'm trying but nothing print..... \n$pub_service = new Google_Service_Pubsub($client);\n$topicsList = $pub_service->projects_topics->listProjectsTopics('https://pubsub.googleapis.com/v1beta2/projects/qustn-1051');\n//$topicsList = $pub_service->projects_topics->listProjectsTopics('projects/qustn-1051');\nprint_r($topicsList);exit;\n. ",
    "hashtagfoundation": "will this change also be made in the v1-master branch?   i'm using v1-master for a PHP App Engine app.... should i be using master instead?   the github page and other google docs say to use v1-master.\n. ",
    "dt-rush": "Someone else with this issue seems to have found a googler who knows of the issue, has reproduced it, is working on it, and who provides a work-around.\nAt the very least, the error message looks the same. Can you test if the suggested work-around works for you?\n. ",
    "adetogni": "Hi dt-rush. I have the same issue with SSL and I checked that link. However the solution proposed does not apply as at line 107 there is not that code and I couldn't find anywhere else in Stream.php.\nIt's very annoying as it happens randomly...\n. @sjlangley yep, that's an option but it's pretty time consuming as my app does a LOT of calls to Storage, in many files. I'm pretty sure I'll add some bugs when modifying such a big amount of code :)\n. ",
    "sjlangley": "This is an intermittent fetch error connecting to the backend - if possible add some retry logic to the write.\n. The google php api client is not part of app engine, you should probably file this issue over on it's github project.\n. Maybe add this line just before to help you debug:\nsyslog(LOG_DEBIUG, 'Defined classes: ' . print_r(get_declared_classes(), true));\n. ",
    "GuillaumeRossolini": "Hi,\nThis fix was not included in the latest release. Any ideas as to why?\nThanks,\n. Line number changed in recent releases.\nThe fix is now to add the following:\ncurl_setopt($curl, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_0);\nBefore or after this line:\ncurl_setopt($curl, CURLOPT_URL, $request->getUrl());\nwhich is still inside Google_IO_Curl::executeRequest()\n. Hi\nHas this issue been closed because of the v2 release? I'd venture not everybody will upgrade right away, so maybe this fix could make it to the next v1 relase?\nThanks,\n. Hi\nDid you try the fix suggested in issue #571?\n. ",
    "jpeak5": "I'm not using this project, but in googling, I came across the fix posted here. I found a potentially better solution in yet another project that I'm not involved with ;) here https://github.com/jackalope/jackalope-jackrabbit/issues/89\nBasically, upgrading ubuntu 14.04 curl from version 7.35 to 7.36 \n\nhth .... \n",
    "rossdotparker": "Ian,\nThanks for getting back to me. The collision idea is interesting, but no,\nthe GUIDs are different, and there are no collisions elsewhere on the\nsystem. Also, the issue is only on one instance, but if there was a\ncollision, I would expect it on both. I also figured that fact that they\nare under different domains/vhosts, would give further protection against\nthis.\nAlso, it works fine for the first hour, and the access token is also stored\nin the session variable, using $guid.\nAny other ideas?\nRoss\nOn Wed, Jun 3, 2015 at 11:36 AM, Ian Barber notifications@github.com\nwrote:\n\nAre you sure $_SESSION['guid'] is working properly? Maybe you're getting\ncollisions between the two instances, and its messing up the refresh token\nstorage on one?\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/573#issuecomment-108178804\n.\n\n\nHusband, father, son, brother, friend, coder, teacher & coordinator of\nICT.\nBlog .  http://rossparker.org\nTweets . @rossdotparker https://twitter.com/rossdotparker\nOpensource .  http://gibbonedu.org\n. tmatsuo thanks for adding a new idea here. I can't remember the exact details (I forgot to come back and update the post), but at some point this one was resolved. Wish I could say how! Going to close this now. Cheers. Ross.. ",
    "connexas": "I didn't set the path by myself. I'm even not allowed to do changes for that. I only can use it because the scripts are running at a big webhosting company.\n. ",
    "alcoheca": "I get the same error message if I run code using this library with two different user accounts. The /tmp/google-api-php-client folder is owned by the first user who runs the code, and can't be accessed by other users.\n. I'm running it in a CLI manner.\nAlso I wasn't aware you could specify the cache directory, need to RTFM a bit closer\n. Amazing, thanks!\n. ",
    "betollaque": "Hello, I get a similar error whenI Insert Google Calendar Entries with Service Account: `Warning: mkdir(): Permission denied in /mydomain.com/app/google-api-php-client/src/Google/Cache/File.php on line 149\nFatal error: Uncaught exception 'Google_Cache_Exception' with message 'Could not create storage directory: /tmp/Google_Client/d5' in/mydomain.com/app/google-api-php-client/src/Google/Cache/File.php:154 Stack trace: #0 /mydomain.com/app/google-api-php-client/src/Google/Cache/File.php(139): Google_Cache_File->getCacheDir('5277a54f911ee9a...', true) #1 /mydomain.com/app/google-api-php-client/src/Google/Cache/File.php(134): Google_Cache_File->getCacheFile('5277a54f911ee9a...', true) #2 /mydomain.com/app/google-api-php-client/src/Google/Cache/File.php(95): Google_Cache_File->getWriteableCacheFile('5277a54f911ee9a...') #3 /mydomain.com/app/google-api-php-client/src/Google/Auth/OAuth2.php(322): Google_Cache_File->set('5277a54f911ee9a...', '{\"access_token\"...') #4 /mydomain.com/app/_database/db_tools.php(1361): Google_Auth_OAuth2->refreshTokenWithAssertion(Object(Google_Auth_AssertionCredentia in /mydomain.com/app/google-api-php-client/src/Google/Cache/File.php on line 154`\nMy code works perfectly in localhost but when I run it in my server It shows this error above.\n. Hello! I found a solution:\nConfig.php\nLine 143:  'directory' => '/path/to/shared/cache'\nThis works for me. I'm using the last stable realese 1.1.7.\n. ",
    "playwebs": "$client = new Google_Client();\n$client->setClassConfig('Google_Cache_File', array('directory' => '/path/to/cache/directory'));\n. ",
    "gbittmann": "I'm seeing this problem. It seems to make the login fail.\n. Have you tried adding a php.ini to your root that includes:\nextension = \"php_curl.dll\"\nI had a similar problem with gitkit + app engine php local and this solved the problem.\n. ",
    "awl100": "// Here is how I fixed it in my own code for my Google calendar service when I moved to a different host without the need to touch Google's code. \n$config = new Google_Config();\n$config->setClassConfig('Google_Cache_File', array('directory' => '../tmp/cache'));\n$client = new Google_Client($config);\n. ",
    "rude-one": "Shut the fuck up!\nSent from my iPhone\n\nOn Jun 2, 2015, at 8:38 PM, Ian Barber notifications@github.com wrote:\nSounds like your service account doesn't have authorization. Have you delegated authority to it on your domain?\n\u2014\nReply to this email directly or view it on GitHub.\n. \n",
    "lomvel": "Yes, I think I have. I've added this scope : https://www.googleapis.com/auth/apps.licensing for the service account's client id.\nI use the same client id for Drive and Directory Api without any problem.\n. It was a token conflict with the other api. Thanks\n. ",
    "stecca21": "That's all the error I get :(\nI have looked over the Google API errors before posting here (not that I\ncouldn't have missed it) but came up empty.\nIs there any way to make the errors more verbose? Would a var dump of any\nof those variables shed some light?\nAllison Stec\nSenior Developer & Asset Management Specialist\nColorhythm\nhttp://www.colorhythm.com\nMain Office: +1 415-399-9921\nFax: +1 415-399-9928\nastec@colorhythm.com\nOn Tue, Jun 2, 2015 at 11:42 PM, Ian Barber notifications@github.com\nwrote:\n\nDo you get any more detail on the error? YouTube has a pretty good list of\nerror details that can point in the right direction:\nhttps://developers.google.com/youtube/v3/docs/errors\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/576#issuecomment-108179237\n.\n. I had a tough time getting FileLogger to work, but was able to dump the response from getResumeUri so i could get more info.\n\nYou were right on with it being related to bad values being set. Thanks for the direction.\n. @mattwhisenhunt I started off using listTeamdrives() but quickly noticed that new TeamDrives didn't always show up in the list after being created. This led me to bake in a verification that the drive comes back in a results set before moving on in the code, and using list is not efficient in that case.\nI'm now instead doing a search for the newly created Teamdrive via id to verify it exists.  Still, I have to wrap this in a 'while' loop until a result comes back.. ",
    "mikeytown2": "What was the fix, what values where bad?\nEDIT: $youtube->videos->insert('status,snippet,recordingDetails', $video);\nI was missing recordingDetails from the first parameter of the insert method. Detecting what objects have been set inside of the Google_Service_YouTube_Video object, inside of the insert/update methods would be nice.. ",
    "RogerG14": "Oh, i thought that that's why the status flag was for, let me try it. I'll come back with what happened. Although the API can handle this size of files right? 10 GB and up, if I have the space available of course. So should it try to read the same chunk, or skip it or what's the logic behind the catch/retry?\n. Could i alter the modified date (as the files will only be opened, they can't be edited) so i could filter them with a custom date I inserted? Even if the date is before the creation of the document?\n. I tried it with both of those already before posting here. I didn't have CURL before and the script worked, using 1.1.4 and now neither version is working.\nP.S: Apparently I posted  a different thing in Stack. Let me post it again and ill link you.\n. http://stackoverflow.com/questions/33354163/curl-issue-while-doing-a-resumable-upload\n. nslookup googleapis.com\nServer:         74.220.195.27\nAddress:        74.220.195.27#53\nNon-authoritative answer:\nName:   googleapis.com\nAddress: 216.58.217.196\nping googleapis.com\nPING googleapis.com (74.125.224.84) 56(84) bytes of data.\n64 bytes from lax17s02-in-f20.1e100.net (74.125.224.84): icmp_req=1 ttl=56 time=16.2 ms\n64 bytes from lax17s02-in-f20.1e100.net (74.125.224.84): icmp_req=2 ttl=56 time=16.1 ms\n64 bytes from lax17s02-in-f20.1e100.net (74.125.224.84): icmp_req=3 ttl=56 time=16.1 ms\n64 bytes from lax17s02-in-f20.1e100.net (74.125.224.84): icmp_req=4 ttl=56 time=16.2 ms\n64 bytes from lax17s02-in-f20.1e100.net (74.125.224.84): icmp_req=5 ttl=56 time=16.3 ms\n64 bytes from lax17s02-in-f20.1e100.net (74.125.224.84): icmp_req=6 ttl=56 time=16.3 ms\n64 bytes from lax17s02-in-f20.1e100.net (74.125.224.84): icmp_req=7 ttl=56 time=16.1 ms\n64 bytes from lax17s02-in-f20.1e100.net (74.125.224.84): icmp_req=8 ttl=56 time=16.2 ms\n64 bytes from lax17s02-in-f20.1e100.net (74.125.224.84): icmp_req=9 ttl=56 time=16.2 ms\n64 bytes from lax17s02-in-f20.1e100.net (74.125.224.84): icmp_req=10 ttl=56 time=16.2 ms\n64 bytes from lax17s02-in-f20.1e100.net (74.125.224.84): icmp_req=11 ttl=56 time=16.3 ms\n64 bytes from lax17s02-in-f20.1e100.net (74.125.224.84): icmp_req=12 ttl=56 time=16.3 ms\n64 bytes from lax17s02-in-f20.1e100.net (74.125.224.84): icmp_req=13 ttl=56 time=16.3 ms\ntelnet www.googleapis.com 443\nTrying 216.58.216.138...\nConnected to googleapis.l.google.com.\nEscape character is '^]'.\nIt seems to have connectivity, maybe it's intermitent?\n. Would it be reasonable to change all my project to 2.0 or just this script? (This is the only one that has trouble, as it's the only script that uploads files that are heavy (up to 25GB)\n. ",
    "tareq-halaby": "Looks like I was overloading Google_Model with my own model which have the same name.\nAfter figuring this out, everything is working fine.\n. ",
    "brianpoole": "I signed it!\n. ",
    "mjacobus": "I signed it!\n. @kesar yeah, I know. Besides this is a unsolicited PR =) You guys do not need to feel bad about not merging this ;). I do feel however, that it is important to follow the CS widely adopted by the community, since they will be the consumers and potential contributors of the API.\n@ianbarber  The goal was that php-cs-fixer would fix indentation, but it apparently was not consistent. I can try to check if this is configurable to 2 spaces indentation, although I would strongly recommend using 4 to follow the community standards, as mentioned above.\nIf you guys are willing to merge I can try to make the changes this weekend and modify this PR or create a new one.\nCheers!\n. Looks good for me too!\n. ",
    "localheinz": "@mjacobus \nHow about making this part of the build process? \nHere's an example from a different project:\n- https://github.com/zendframework/modules.zendframework.com/blob/master/.travis.yml#L31\n. @mjacobus \nNever mind my example, we've already got a configuration for phpcs right here: https://github.com/google/google-api-php-client/blob/master/style/ruleset.xml\n. @ianbarber @kesar @mjacobus \nDo you want to take a look at #604?\n. If you clone the repository on a case-insensitive OS, you end up with a dirty working tree, is there a reason for it?\n\n\n. @kesar \nHa! Interesting! Can we fix that?\n. @kesar \nInteresting nonetheless that Google generates code from documentation, rather than the other way around.\n. I signed it, yo!\n. ",
    "fonsclaessen": "In MediaFileUpload.php  \nWhen you examine the Post url you see there is a double /\n//upload\nI changed this function :\n  private function transformToUploadUrl()\n  {\n    $base = $this->request->getBaseComponent();\n    //$this->request->setBaseComponent($base . '/upload');\n    $this->request->setBaseComponent($base . 'upload');  //fix\n  }\nThis solved the double / in de upload URL\nIt works for me.\n. ",
    "borgogelli": "Ok , but If I should only use \n$client->verifyIdToken($id_token);\nhow can I use other objects like Google_Service_Oauth2 which require authentication ?\nFor example, when I use:\n$google_oauth2 = new \\Google_Service_Oauth2($client);\nI get:\nError calling GET https://www.googleapis.com/oauth2/v2/userinfo: (401) Invalid Credentials\n. I signed it\n. ",
    "austinh": "Any update?\n. Thanks. Are there plans in the work for the regular php api to work outside the App Engine environment? And if so anyway I can help?\n. ",
    "marslangoog": "The App Engine SDK is now open-sourced: https://github.com/GoogleCloudPlatform/appengine-php-sdk but the GCS wrapper won't work outside the App Engine environment yet.\n. The plan is to get it work in Managed VMs (https://cloud.google.com/appengine/docs/managed-vms/) first, and eventually in any environment. That said, the wrapper could theoretically work in its current form with some modifications to the auth layer.\n. This is a known issue: https://code.google.com/p/googleappengine/issues/detail?id=12287\n. ",
    "pdewouters": "I also experience the same issue.\n. :+1: thanks!\n. ",
    "bobertm": "bingo. #597 fixes the issue.\nThanks for your quick help.\n. ",
    "wilrnh": "p.s the foreach does not throw any errors, it just does nothing. I think its because $bucket->valid() returns false all the time.\n. Doesnt seem at all possible. Ended up doing something like\n``` php\n        $nextPageToken = NULL;\n        do {\n          $objs = $client->objects->listObjects($bucket, [\n            \"pageToken\"  => $nextPageToken\n          ]);\n      $nextPageToken = $objs->getNextPageToken();\n\n      foreach($objs->getItems() as $item)\n      {\n        ...\n      }\n    } while ( $nextPageToken );\n\n```\n. ",
    "austinmcorso": "Thank you, this was my issue.\n. ",
    "odevaux": "Thank you for your answer ! I figured out it was my composer settings that made me get v1.1.4 of google/apiclient and no v1.1.5 in which the bug was actually fixed.\n. ",
    "karensg": "I am not using any SSL certificates so I commented this line out of IO/Stream.php\n$requestSslContext[\"cafile\"] = dirname(__FILE__) . '/cacerts.pem';\nThat solved my issue for now until this problem is fixed.\n. ",
    "jfradj": "Also getting this issue.\nI don't think I made any changes that could lead to it.\n. The v2 is now using Guzzle.\nJust make a full search of \"cafile\" to find where you'll to comment.\n. I confirm, the issue is back.\nIn v2.0.0-RC4, the Google_Task_Runner class declares (lines [79, 83]):\nPHP\nCURLE_COULDNT_RESOLVE_HOST => self::TASK_RETRY_ALWAYS,\nCURLE_COULDNT_CONNECT => self::TASK_RETRY_ALWAYS,\nCURLE_OPERATION_TIMEOUTED => self::TASK_RETRY_ALWAYS,\nCURLE_SSL_CONNECT_ERROR => self::TASK_RETRY_ALWAYS,\nCURLE_GOT_NOTHING => self::TASK_RETRY_ALWAYS\nTheses constants are available only if the curl extension is loaded.\nFor instance I'm using it on a Google App Engine product which doesn't have the curl extension enable.\nSo the code produces some warnings like:\nUse of undefined constant CURLE_OPERATION_TIMEOUTED\n. ",
    "mak73kur": "Hi @nebadom,\nfile_get_contents in GAE environment uses proxy service called URL Fetch to make requests and exception comes from there.\n- When connecting to web sites using HTTPS, the default behavior is to validate the certificate of the host and reject requests where the vertificate does not match. This is the opposite to the default behavior of PHP, and to change this behavior you can set the value of verify_peer to false in the ssl section of the context parameters.\n- All other values of ssl contexts options are ignored.\n  (From documentation )\nSo, for URL Fetch only possible parameter in ssl context is verify_peer, any other parameter ignored and writes warning with unnecessary high log level every time the request is made. \nTo fix this, you could comment cafile key from ssl contenxt in IO/Stream.php file like suggested by @karensg. It can be safely removed because it does nothing in GAE PHP runtime.\n. ",
    "ajck": "I'm getting the same error, but with \"allow_self_signed\" as well as \"cafile\" being ignored.\n@nebadom @karensg where exactly is the Stream.php file you are editing please? Couldn't find it in the app engine folder on my Windows 7 box...\nThanks\n. ",
    "maksimluzik": "Also getting this error when calling Google API permission->delete\nUnsupported SSL context options are set. The following options are present, but have been ignored: allow_self_signed, cafile\nI am using version google/apiclient:^2.0.0@RC and they refactored it a bit and there is no Stream.php anymore.\n. ",
    "MeinAccount": "The issue is currently not resolved. Getting Unsupported SSL context options are set. The following options are present, but have been ignored: allow_self_signed, cafile when running on App Engine.\n. ",
    "vzool": "Hi,\nGuys, are talking about development or production environment?\nI really used this to communicate with GCM on production which I feel it is still inside Google Main Land, and now I need to connect to open web \"Outside Google\", which is a bad idea to use this technique as I think.\nBecause, I feel any warnings about SSL is told me it is insecure practice.\nI don't know, maybe GCM Servers are outside too, Ha ha ha.\nI just put cacert.pem to the app root directory and still no luck.\nIs there any clear solution for a hosted project on GAE which make our project safe to connect with any foreign sever on the web?\nThanks. ",
    "corycburke": "This seems to be an issue of a misconfiguration on our part. We were creating a new client to do a sub request and not setting the timeout again on that client.\nClosing this as it is a non-issue. Apologies for the confusion.\n. ",
    "AnthumChris": "As of today (v2.2.0), the following code correctly sets the timeout for 3 seconds and I tested to verify:\n$google_client = new Google_Client();\n$google_client->getHttpClient()->setDefaultOption('timeout', 3);\nYou could also set the connect_timeout, which would occur before timeout:\n$google_client->getHttpClient()->setDefaultOption('connect_timeout', 2);. ",
    "x000zh": "setDefaultOption was removed in  Guzzle 6.\nI have to extend Google_Client modify the Google_Client::createDefaultHttpClient() method.. ",
    "brynnbp": "Anyone know how to access these resources? Still dead.\n. I think those might be formerly be the items linked in sidebar now, for example:\nhttps://developers.google.com/api-client-library/php/auth/web-app\n. ",
    "jeanpaulgalea": "I signed it!\n. Preferably permission bits are set on fopen, but PHP doesn't allow that. I've looked into umask but that might introduce other issues since other scripts might be running under the same process.\n. ",
    "KevBurnsJr": "+1\nv1beta1 is deprecated. This library is out of date.\n. ",
    "pffy": "+1\n. ",
    "mvanbaak": "+1 \n. http://semver.org/\nWould be very nice if you guys at google could read that, start caring about your users, and NOT break things because you release a new patch version!\n. ",
    "andywooyay": "I signed it!\n. ",
    "ghprod": "Add this scope https://www.googleapis.com/auth/userinfo.email\n``` php\n$oauth2 = new Google_Service_Oauth2($client);\ndump($oauth2->userinfo->get());\n```\n. ",
    "monkeymars": "@TheNavigat so is it just load Client.php in codeigniter?\n. ",
    "TheNavigat": "Although I'm a bit confused by the comment, but I guess that bit answers your  question.\n\"The solution anyway is to replace Google_Client with Google_Config. Doing that will make it work seamlessly.\"\n. It's a bit difficult for me to remember what happened, so most of the following is just recalling, I apologize if something's wrong.\nWhat I'm saying is that the Google_Client class is coded in the same exact file where this condition is, so class_exists will always return true, regardless of whether autoload.php is actually loaded or not. That causes an error because the rest of the files are never loaded.\nThe solution I suggested is based on the fact that Google_Config is a class in a completely independent file, so class_exists will only return true if the whole stack is actually loaded, which is supposed to only happen when autoload.php is, in fact, loaded.\n. ",
    "RyanGordon": "It looks like some of the comments need to be updated with these changes: https://github.com/google/google-api-php-client/pull/637/files#diff-e5af3393c6631c01b5cff4ab345a7efbR551\n. ",
    "gjellis": "I did comment out this line and thing still worked.  So this must be the better fix.\nThank you\n. Thank you for the help.  If you don't mind, I will let you take the lead here and put in a pull request.\nThanks\n. ",
    "ramsysx": "This is security risk. It's necessary to correct and announce immediately.\nPlease hurry.\n. ",
    "Abbe98": "This also happens when running the HelloAnalytics.php.\nIt would be great to get this working as it's an official example from Google.\n. I used the latest version this Saturday.\nOn Nov 2, 2015 22:27, \"Brent Shaffer\" notifications@github.com wrote:\n\nI would be interested to know if this happens with the newer version of\nthe library, if anybody has time to test it.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/640#issuecomment-153162470\n.\n. On the current master I got the error that the autoload has moved to vendor/autoload.php(seams weird as I'm not using composer and no vendor/ exists)...\n. Okey will install the master-branch from Composer then...\nOn Nov 7, 2015 01:29, \"Brent Shaffer\" notifications@github.com wrote:\n@Abbe98 https://github.com/Abbe98 composer is required in the new\nversion, or you can download the release here\nhttps://github.com/google/google-api-php-client/releases and the vendor\ndirectory is included.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/640#issuecomment-154585896\n.\n. The crash is fixed!\n. When looking into it I guess it's a issue with the GAE SDK, the SDK should emulate the CA bundle used on GAE it self.\n. \n",
    "mf01": "@bshaffer I've used the new lib and the issue was gone. Currently I've an authentication problem to storage but this shouldn't depend to this lib. I have to make more tests.\n. @bshaffer I have another problem during update to the new version including composer.\nThis line will produce the error.\nThis is the issue.\n\nNotice: Object of class google\\appengine\\runtime\\CurlLite could not be converted to int in [path-to-project]\\lib\\google-api-php-client-2.0.0-RC1\\vendor\\guzzlehttp\\ringphp\\src\\Client\\CurlHandler.php on line 109\nNotice: Object of class google\\appengine\\runtime\\CurlLite could not be converted to int in [path-to-project]\\lib\\google-api-php-client-2.0.0-RC1\\vendor\\guzzlehttp\\ringphp\\src\\Client\\CurlHandler.php on line 118\nFatal error: Uncaught exception 'google\\appengine\\runtime\\CurlLiteOptionNotSupportedException' with message 'Option 20056 is not supported by this curl implementation.' in [path-to-gae]\\appengine\\runtime\\CurlLite.php:487 Stack trace:\n#0 [path-to-gae]\\appengine\\runtime\\CurlLite.php(215): google\\appengine\\runtime\\CurlLite->setOption(20056, NULL)\n#1 [path-to-gae]\\appengine\\runtime\\CurlLiteStub.php(1325): google\\appengine\\runtime\\CurlLite->setOptionsArray(Array)\n#2 [path-to-project]\\lib\\google-api-php-client-2.0.0-RC1\\vendor\\guzzlehttp\\ringphp\\src\\Client\\CurlHandler.php(130): curl_setopt_array(Object(google\\appengine\\runtime\\CurlLite), Array)\n#3 [path-to-project]\\lib\\google-api-php-client-2.0.0-RC1\\vendor\\guzzlehttp\\rin in [path-to-project]\\lib\\google-api-php-client-2.0.0-RC1\\vendor\\guzzlehttp\\guzzle\\src\\Exception\\RequestException.php on line 51\nMaybe I'm wrong or did forgotten something. But it's not working using Google App Engine (local) environment.\n. I'm sorry. The issue is still there.\nSo I've forced true return.\n    // set StreamHandler on AppEngine by default\n    if (true || $this->isAppEngine()) {\n      $options['handler'] = new StreamHandler();\n    }\n\nAnd I have a different message. \nWarning: Missing argument 1 for Monolog\\Handler\\StreamHandler::__construct(), called in [path-to-project]\\lib\\google-api-php-client-2.0.0-RC1\\src\\Google\\Client.php on line 1042 and defined in [path-to-project]\\lib\\google-api-php-client-2.0.0-RC1\\vendor\\monolog\\monolog\\src\\Monolog\\Handler\\StreamHandler.php on line 42\nNotice: Undefined variable: stream in [path-to-project]\\lib\\google-api-php-client-2.0.0-RC1\\vendor\\monolog\\monolog\\src\\Monolog\\Handler\\StreamHandler.php on line 45\nNotice: Undefined variable: stream in [path-to-project]\\lib\\google-api-php-client-2.0.0-RC1\\vendor\\monolog\\monolog\\src\\Monolog\\Handler\\StreamHandler.php on line 47\nFatal error: Uncaught exception 'InvalidArgumentException' with message 'A stream must either be a resource or a string.' in [path-to-project]\\lib\\google-api-php-client-2.0.0-RC1\\vendor\\monolog\\monolog\\src\\Monolog\\Handler\\StreamHandler.php:50 Stack trace:\n#0 [path-to-project]\\lib\\google-api-php-client-2.0.0-RC1\\src\\Google\\Client.php(1042): Monolog\\Handler\\StreamHandler->__construct()\n#1 [path-to-project]\\lib\\google-api-php-client-2.0.0-RC1\\src\\Google\\Client.php(1027): Google_Client->createDefaultHttpClient()\n#2 [path-to-project]\\lib\\google-api-php-client-2.0.0-RC1\\src\\Google\\Service\\Resource.php(190): Google_Client->getHttpClient()\n#3 [path-to-project]\\lib\\google-api-php-client-2.0.0-RC1\\vendor\\monolog\\monolog\\src\\Monolog\\Handler\\StreamHandler.php on line 50\n. Any news in this case?. ",
    "minobedin": "I found the solution. The filter must be passed as array of object. I change this line:\n$filtri->setFilters(array( $filtro ));\nand\n$request->setDimensionFilterGroups(array($filtri));\nand now the code works\n. ",
    "phpgeekfr": "Thank you!\nI had the exact same problem, filters were not taken into account.\nI already tried to give an array of filters to \"setFilters\" but not to \"setDimensionFilterGroups\".\n. ",
    "PromInc": "Well done @minobedin - I was just struggling with this today as well, but your fix was just the trick!\n. In my experience, I could never get filter groups to work.  Though I couldn't figure out how to get it to work in the (https://developers.google.com/apis-explorer/#p/webmasters/v3/webmasters.searchanalytics.query)[api explorer] either.  (If you have tips on how to set the group I'd appreciate any tips!)\nThat said, my guess without testing your code is that the block group is the issue:\n$filtergroup = new Google_Service_Webmasters_ApiDimensionFilterGroup();\n$filtergroup->setGroupType('and');\n$filtergroup->setFilters(array($filter));\n$query->setDimensionFilterGroups(array($filtergroup));\n. I do a server to server connection.\nHere are the steps I'm using to create the account, as well as my full repository for accessing the API.\nhttps://github.com/PromInc/organic-search-analytics\nFor reference, the script that builds my API call is organic-search-analytics/inc/code/dataCapture.php\nYou'll notice thought that I am not using DimensionFilterGroups - I haven't been able to get them to work in the API explorer and thus was not able to verify that they work in my API script.\nThat said, when I was testing with the groups I believe I would get an empty response - not an error.  What is the response you are getting?  Is there an error code associated?\n. ",
    "riconeitzel": "I'm very sorry but even the \"array\" code fix doesn't work at our end. Perhaps I just missed a crucial part, but here's my code and it looks like the one above!\n``` php\n        $query = new Google_Service_Webmasters_SearchAnalyticsQueryRequest();\n        $query->setAggregationType('byPage');\n        $query->setSearchType('web');\n        $query->setRowLimit('5000');\n        $query->setDimensions(array('page', 'query', 'country', 'device'));\n        $query->setStartDate($startDate);\n        $query->setEndDate($endDate);\n    $filter = new Google_Service_Webmasters_ApiDimensionFilter();\n    $filter->setDimension('device');\n    $filter->setOperator('equals');\n    $filter->setExpression('Mobile');\n\n    $filtergroup = new Google_Service_Webmasters_ApiDimensionFilterGroup();\n    $filtergroup->setGroupType('and');\n    $filtergroup->setFilters(array($filter));\n    $query->setDimensionFilterGroups(array($filtergroup));\n\n    $response = $service->searchanalytics->query('https://www.\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022.de/', $query);\n\n```\nThanks for your second pair of eyes.\nRico\n. are you accessing the API with a machine (server-to-server) user or your real G-user account?!\n. ",
    "cjmling": "@minobedin  Thanks That worked for me :+1: \n. ",
    "nisarkhalid": "\ninstead of DimensionFilterGroups, i used this method and it works \nhere is my sample code working with single filter and multiple filters using PHP\n\n//in params for single filter\n'dimFilter'    => array(\n    'dimensionName' => 'ga:browser',\n    'operator'      => 'EXACT',\n    'expression'   => 'Safari'\n),\n//in params for multiple filter\n'dimFilter'    => array(\n'filters' => array(\n    array(\n        'dimensionName' => 'ga:browser',\n        'operator'      => 'EXACT',\n        'expression'   => 'Chrome'\n    ),\n    array(\n        'dimensionName' => 'ga:medium',\n        'operator'      => 'EXACT',\n        'expression'   => 'organic'\n    ),\n    array(\n        'dimensionName' => 'ga:country',\n        'operator'      => 'EXACT',\n        'expression'   => 'Pakistan'\n    ),\n    array(\n        'dimensionName' => 'ga:operatingSystem',\n        'operator'      => 'EXACT',\n        'expression'   => 'Windows'\n    )\n)\n\n),\n\nhere is PHP code \n\n//for single filter \nif (isset($param['dimFilter']) && isset($param['dimFilter']['dimensionName']) && isset($param['dimFilter']['operator']) && isset($param['dimFilter']['expression'])) {\n    $filter = new Google_Service_AnalyticsReporting_DimensionFilter();\n\n    $filter->setDimensionName($param['dimFilter']['dimensionName']);\n    $filter->setOperator($param['dimFilter']['operator']);\n    $filter->setExpressions($param['dimFilter']['expression']);\n\n    if (isset($param['dimFilter']['exclude'] ))\n        $filter->setNot($param['dimFilter']['exclude']);\n\n    $filter_clause = new Google_Service_AnalyticsReporting_DimensionFilterClause();\n    $filter_clause->setFilters($filter);\n\n    $filtersGroup = $filter_clause;\n\n//for multiple filters\n    }else if(isset($param['dimFilter']['filters'])){\n    $filtersGroup = array();\n    foreach( $param['dimFilter']['filters'] as $filter ) {\n\n        $dimensionFilter = new Google_Service_AnalyticsReporting_DimensionFilter();\n        $dimensionFilter->setDimensionName( $filter['dimensionName'] );\n        $dimensionFilter->setOperator( $filter['operator'] );\n        $dimensionFilter->setExpressions( $filter['expression'] );\n\n        /*if (isset($param['dimFilter']['exclude'] ))\n            $filter->setNot($param['dimFilter']['exclude']);*/\n\n        $filter_clause = new Google_Service_AnalyticsReporting_DimensionFilterClause();\n        $filter_clause->setFilters($dimensionFilter);\n\n        $filtersGroup[] = $filter_clause;\n    }\n}\n\n\nsetting up request\n\n$request->setDimensionFilterClauses($filtersGroup);\n. ",
    "kennblvnp": "Is this your own class, \"Google_Service_Webmasters_ApiDimensionFilterGroup\"?. ",
    "enzommx": "Yup, I see what you are saying.  How I discovered this problem (and the fix) was via this PHP article on the spl_autoload_register function: http://php.net/manual/en/function.spl-autoload-register.php \nScroll down to the Example 1, and you'll see where it talks about this.\n. ",
    "apothan": "Getting the same issue when I have updated this lib. How did you solve it?\n. This is no longer a bug in v2. This can potentially be closed. I am not sure if v1 will still be maintained.\n. ",
    "ktello": "Same here, hopefully this gets solved soon\n. ",
    "itsazzad": "I signed it!\n. Did you get the solution? I am trying to test now.\n. I see. I was using browser key instead of server key. And here I will need to use my public ip instead of local ip.\nIsn't it?\n. ",
    "samuelwilliams": "What version of PHP are you running?\n. ",
    "cdman": "There seems to be some kind of memory corruption issue, possibly related to loading curl.so on GAE. See https://code.google.com/p/googleappengine/issues/detail?id=12451\n. I don't think this is fixed - see https://issuetracker.google.com/issues/35899850 where the code.google.com issue was migrated - and which is still marked as an unsolved bug.\nThen again, the issue is most probably not related to google-api-php-client but rather to some memory corruption in the Google Appengine Standard PHP runtime.. ",
    "ijt": "@atrauzzi can you point to some code that reproduces this issue?. Hi Attila, I deployed your test case to\nhttps://b35899850-php-structures.appspot.com\nhttps://www.google.com/url?q=https://b35899850-php-structures.appspot.com/&sa=D&usg=AFQjCNESDgJTNALFvHcDgmY1mo4CN4F5FQ\nand\nit seems to be working. If you find that this is still a problem, please\nsend a reproducing test case and I will look into it.\nOn Sun, Mar 19, 2017 at 12:07 PM, Attila-Mihaly Balazs \nnotifications@github.com wrote:\n\nI don't think this is fixed - see https://issuetracker.google.\ncom/issues/35899850 where the code.google.com issue was migrated - and\nwhich is still marked as an unsolved bug.\nThen again, the issue is most probably not related to\ngoogle-api-php-client but rather to some memory corruption in the Google\nAppengine Standard PHP runtime.\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/650#issuecomment-287639082,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAA8qtnxa14QvLWRqwpW-bM1bAG-VrJ1ks5rnX0GgaJpZM4F0bVu\n.\n. \n",
    "tpnprins": "Same here! Would be great if this is implemented.\n. Thanks!\n. ",
    "hiddenpearls": "Yeah!\nOn Thu, Sep 10, 2015 at 2:25 AM, tpnprins notifications@github.com wrote:\n\nSame here! Would be great if this is implemented.\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/656#issuecomment-139050318\n.\n\n\nMuhammad Adnan\ntwitter: @hiddenpearls http://www.twitter.com/hiddenpearls\nI blog too do u know ?  adnan.pk http://www.adnan.pk/\nFailure takes you higher than success ..!\nhttp://www.youtube.com/watch?v=HbEpeiYdzh8\n. awesome!\nOn Thu, Sep 10, 2015 at 9:38 PM, Brent Shaffer notifications@github.com\nwrote:\n\nThe PR of the Beast\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/656#issuecomment-139305029\n.\n\n\nMuhammad Adnan\ntwitter: @hiddenpearls http://www.twitter.com/hiddenpearls\nI blog too do u know ?  adnan.pk http://www.adnan.pk/\nFailure takes you higher than success ..!\nhttp://www.youtube.com/watch?v=HbEpeiYdzh8\n. Here is my function that lists all the files and then I am trying to get downloadURL but it is empty in returned Object as well.\nfunction listAllFiles($driveService){\n```\n$parameters = array(\n    'maxResults' => '10'\n    );\n//$_GET['action']\n$results = $driveService->files->listFiles($parameters);\necho '';\nforeach($results->getItems() as $file){\nformatPre(json_encode($file->getDownloadUrl()));\n\necho '<tr><td><img src=\"'. $file->iconLink .'\"/> ' . $file->title . '</td><td><a href=\"' . $file->alternateLink . '\" target=\"_blank\">View</a> <a href=\"?action=download\">Download</a> <a href=\"?action=trash\">Trash</a> </td><td><a href=\"?action=delete\">Delete</a></td></tr>';\n\n}\necho '';\n```\n}\n. Hey @mattwhisenhunt \nI worked on this thing couple of years ago. I am not sure if this issue is still valid or not. You can test it in the current codebase and continue ;)\nCheers!. ",
    "antonioperic": "@nebadom you can use \nhttps://www.googleapis.com/oauth2/v1/userinfo?alt=json&access_token=your_token\n. ",
    "ekr3peeK": "I've tried the manual caching, which solved the problem with the long execution time of the verifyIdToken method, but now, my curl request to get the userinfo(https://www.googleapis.com/userinfo/v2/me) takes around 4 seconds.\nStrangely, when I first started debugging my functions, my first tought was that the long execution time of the script comes from this curl request, and now, it really does come from here.\nBut I can't understand why:|\nSo, before cached certs, verifyIdToken took around 5 seconds, but the curl request didn't take up more than a second, now, with cached certs, verifyIdToken takes around 0.01 second to execute, while the curl requests execution time was raised to 5 seconds.\nI will try your other suggested method also.\n. The problem was on my side, everything works fine now. If anyone is facing simmilar problems, while curl-ing www.googleapis.com, check that curl can correctly resolve the DNS or not.\n. The problem was, not with the php-api but with php's curl function, because it took 5 seconds for it to resolve the DNS when I was trying to access www.googleapis.com. I added \"curl_setopt($curl, CURLOPT_IPRESOLVE, CURL_IPRESOLVE_V4);\" to my code, and this solved the problem.\nHere's a stackoverflow, related to the problem, thank you for taking the time and trying to help me out here:)\nhttp://stackoverflow.com/questions/32481611/curl-from-php-takes-more-time-than-curl-via-putty?noredirect=1#comment52826922_32481611\n. ",
    "crishoj": "I managed to duplicate this issue with my pull request (#665). Apologies.\n. See #664 and https://groups.google.com/forum/#!topic/google-content-api-for-shopping/5I8MHpfbH4A for context.\n. Now code standards compliant. \n. ",
    "tbetbetbe": "LGTM\n. LGTM, but before I merge, can you update the description to summarize why some files were deleted.\n. Yes, that would be nice as well.\n. ",
    "mojmirdurik": "I signed it!)\n2015-09-10 20:05 GMT+02:00 googlebot notifications@github.com:\n\nThanks for your pull request. It looks like this may be your first\ncontribution to a Google open source project, in which case you'll need to\nsign a Contributor License Agreement (CLA).\n[image: :memo:] Please visit https://cla.developers.google.com/\nhttps://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll\nverify. Thanks.\n\nIf you've already signed a CLA, it's possible we don't have your\n  GitHub username or you're using a different email address. Check your\n  existing CLA data https://cla.developers.google.com/clas and verify\n  that your email is set on your git commits\n  https://help.github.com/articles/setting-your-email-in-git/.\nIf you signed the CLA as a corporation, please let us know the\n  company's name.\n\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/668#issuecomment-139329738\n.\n. ok :) Thank you for your feedback.\n\n2015-10-09 19:45 GMT+02:00 Brent Shaffer notifications@github.com:\n\nThis is an innocuous change, but also it's not going to really fix\nanything either (If someone included Client.php manually then this change\nwould prevent a fatal error, but we don't want to encourage that behavior\nanyway)\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/668#issuecomment-146944425\n.\n. \n",
    "CBox": "Solved it - the passenger is required!\n. ",
    "dmitrydymarchuk": "I sent pull request #672 \n. Yes, I have, but I need to set different chunkSize for every step and recall constuctor for this is bad way.\n. ",
    "max-voloshin": "@bshaffer it allows to use Google API more efficiently (without extra API calls) in case when we import different chunks of data from external sources and we don't know quantity and size of these chunks from the beginning.\n. @bshaffer sure, we upload over 1 GB data to Google Analytics data set with different size of chunks.\nNote: we don't have ability to buffer external data in order to use equal size of chunks.\n. ",
    "tillz": "Sorry, i'm not that familiar with rebasing. Can i just close this PR and send a new one, consisting of one commit?\nSidenote: the newlines on blank lines seem to be inconsistent in this repo. I think the reason of this is that the phpcs ruleset accepts whitespaces in blank lines. Possibly setting 'ignoreBlankLines' to false here would solve the problem (and save much work!)\n. Please have a look at #675, as it implements the same functionality.\n. @bshaffer According to the README.md, PHP 5.2 is supported, but according to the docs, this was introduced in 5.3?\n. ",
    "timint": "No Sir. Uploaded as is. The file File.php is in it's Cache folder untouched. I will do some more debugging tomorrow what's going on inside the autoloader. I wil also checkout a new build. Stay tuned.\n. Invalid issue ticket. The FTP software skipped transfering folders named cache/.\n. This is one of those times when something very smart out of one aspect is not the brightest idea out of another. :~ A big apreciation for the fast replies. I am back on track and it's all rolling fine.\n. ",
    "alinr": "I face the same problem. @riconeitzel: did you find a workaround for this?\n. ",
    "mtdowling": "Guzzle 3 code is basically unmaintained at this point (I'm the author). If you want to use this code, it might be better to fork it or vendor it. Alternatively, the PSR-7 stuff newer versions of Guzzle uses has the parser as well:\n- https://github.com/guzzle/psr7/blob/master/src/functions.php#L440\n- https://github.com/guzzle/psr7/blob/master/src/functions.php#L468\n. I noticed that library is using Guzzle version 5.x. 5.x is mostly in a maintenance mode at this point, and most development efforts are focused on version 6. Lots of libraries are adopting version 6 because it uses PSR-7 and has a much better story for async requests (for example, Drupal 8, Goutte, AWS SDK for PHP, etc.). I would strongly recommend that if you are building some new, that you use Guzzle 6 so that you're using something that will be maintained well into the future, and so that your libraries will be compatible with newer versions of other libraries in the ecosystem. Alternatively, you could support both versions, which helps to future proof your project. This is something we did in the AWS SDK for PHP: https://github.com/aws/aws-sdk-php/tree/master/src/Handler\n. It's Michael :) and no problem. Feel free to reach out to me directly if you have any questions, or just mention me on any issues you want help with. I'm happy to help.\n. ",
    "maury91": "I signed it!\n. tillz i've see your code, as you say they do the exact same thing, but i don't like the way how you have changed the name of a method \"getResumeUri\" -> \"fetchResumeUri\", if in someone else project exists a class that extend Google_Http_MediaFileUpload, this break his code.\nI think that simply make public the variable resumeUri, is more clean\n. Seems right, thanks @bshaffer for the info, if I've other patches to do I'll keep it mind\n. ",
    "gonzzza007": "Yes, it would be nice to be able to set such setting for the API. Currently we have to alter the source code.\n. ",
    "cnelissen": "+1\n. Yes please. The 2.0 version is pretty much a non-starter for me because I already require Guzzle 6 due to some other dependencies. I am sure other people will be in the same boat.\n. Two that I am using right now are influxdb/influxdb-php and mailgun/mailgun-php.\n. ",
    "hakimio": "Any progress?. ",
    "ecoopnet": "I signed it!\nMy company name is \"tech vein, Inc.\".\n. Thanks @bshaffer. I added your fix to this PR.\nPlease add tests.\n. ",
    "sqrrrl": "The API key only identifies the calling application, not the content owner. Drive operates on user owned data and since the owner of the application and the owner of the content are (usually) not the same, oauth is used to delegate permission and identify which account we're operating on.\nTo your question about why not infer the content owner from the application? For one, applications can have multiple owners. That makes any attempt to infer the correct account ambiguous (arbitrarily pick one) at best, expensive (if we want things like the union of all owners) at worst. Contrary to what you think, from the server's perspective it's not at all obvious which account your inserting into when you're making an unauthorized request.\n. The alt parameter is, literally, to request an alternate representation. The default is JSON, but some APIs like Drive and others have resources that have multiple representations -- JSON for metadata, blobs for content. Same for storage and a few others.\nIn those cases, the methods do have an expected class when the default JSON representation is used. But for media representations, it doesn't make sense to use them.\n. FYI - Already updated #728 with some additional tests, but they're fairly superficial.\n. Should pass in an expected class here. One of the key things is ignoring the expected class when alt=media is present. Not specifying one in the first place can mask regressions.\n. ",
    "shivasurya": "thanks! \n. ",
    "BeauBouchard": "I signed it!\n. ",
    "DicsyDel": "@bshaffer But there is no support for beta features (beta version), only for v1. How we can get support for beta version? (I've provided a link to the API: https://www.googleapis.com/discovery/v1/apis/compute/beta/rest). We need lables functionality.\nRegards,\nIgor\n. ",
    "bstump": "No, I just did a \"composer update\" and everything stopped working in my web application. Didn't see the upgrading.md file. Thanks!\n. ",
    "DManstrator": "I got (nearly) the same problem.\nWarning: file_exists() [function.file-exists]: open_basedir restriction in effect. File(/tmp/Google_Client/19/19431c28c9844f253b7493fd88125111) is not within the allowed path(s): (/users/dmanstrator/www:/users/_temp/dmanstrator) in /users/dmanstrator/www/vendor/google/apiclient/src/Google/Cache/File.php on line 45\nI went into the AssertionCredentials.php and changed the $useCache variable to be false as default ($this->useCache = false;) but it doesn't change a thing.\nI can't access my php.ini because I get hosted by bplaced.net, any tips for me?\nThanks in advance.\nEdit: After looking around, I found a way.\nPHP\n$client = new Google_Client();\n$client->setClassConfig('Google_Cache_File', array('directory' => '/users/_temp/dmanstrator'));\nJust set the value of \"directory\" to one of the allowed paths.. ",
    "mcordingley": "Nevermind. It seems to be working now. Huh.\n. ",
    "mTorres": "That's because the master branch is using composer. Install composer and then run composer require \"google/apiclient:~2.0@dev\" from the terminal located on your project root directory. After that you'll have on your project root the vendor subfolder with the autoload file that you must include.\nOr you could just download the v1 :-)\n. This is because Guzzle couldn't find the CA bundle of your system to check the SSL certificates. See the Guzzle FAQ for more info.\nAlso, if you have to create your own CA bundle (you must update that periodically!) check this.\nI'm not sure if from the Google Client side there's anything doable to solve this (probably lots of work for little gain?)\n. Weather you use composer or not is completely up to you. Composer is just a tool to get the library downloaded, you can do that by downloading a ZIP file from github and then manually creating an autoloader (or requiring each used file).\nAs for an example, I've just pushed a gist with a working sample to reproduce an issue, maybe you'll find it useful? You should definetly check the official documentation\n. Yes RC5 is working, thanks!\n. Maybe related to #819?\n. Ok more information, I've tried with different versions of the google/apiclient, the google/auth and guzzlehttp/guzzle. The summary is as follows:\n| APICLIENT | AUTH | Guzzle | Result |\n| --- | --- | --- | --- |\n| 2.0-RC1 | 0.3 | 5.2 | OK |\n| 2.0-RC2 | 0.4 | 5.2 | OK |\n| 2.0-RC3 | 0.4 | 5.2 | OK |\n| 2.0-RC4 | 0.5 | 5.2 | error |\n| 2.0-RC4 | 0.5 | 6.0 | error |\nIn conclusion, from 2.0-RC1..RC3 it's working but RC4 shows the issue\n. BTW to install a composer version just run composer require \"google/apiclient:2.0-RC5@dev\". Your problem is that the v2 branch is still in developement and composer does not install developement branches if you don't specifically say it (hence the @dev at the end of the version).\n. ",
    "rahul9878": "HI @bshaffer ,\nAll the documentation on google and other place uses some functions that are deprecated/removed like Google_Auth_AssertionCredentials() and if i use new functions in place of these deprecated functions then i get error(above). Is there not a latest documentation for this library? The documentation given by  you in the above comment also use that deprecated/removed functions. I am unable to use these new functions in correct way.\n. ",
    "iftikhardirv": "Hi,\nError was in this function  $results = getResults($analytics, $rows->getdefaultProfileId());\nI put bellow code and its working now but i think something is wrong\ntry {\n            $results = getResults($analytics, $rows->getdefaultProfileId());\n        } catch (Exception $exc) {\n            $results = getResults($analytics, $rows->getdefaultProfileId());\n        }\n. Hi @bshaffer \nI want to get analytic data once authorized just like we using other apis and they ask for some api key and secret key and they don't need to login again and again.\n. No i didn't how can i add refresh token ? bellow is my script \n``` php\nerror_reporting(E_ALL);\nini_set('display_errors', 1);\n// Load the Google API PHP Client Library.\nrequire_once 'src/Google/autoload.php';\n// Start a session to persist credentials.\nsession_start();\n// Create the client object and set the authorization configuration\n// from the client_secretes.json you downloaded from the developer console.\n$client = new Google_Client();\n$client->setAuthConfigFile('client_secrets.json');\n$client->addScope(Google_Service_Analytics::ANALYTICS_READONLY);\n$client->setAccessType(\"offline\");\nif (isset($_SESSION['access_token']) && $_SESSION['access_token']) {\n    // Set the access token on the client.\n//    $_SESSION['access_token'] = $client->refreshToken($_SESSION['access_token']);\n    $client->setAccessToken($_SESSION['access_token']);\n    // Create an authorized analytics service object.\n    $analytics = new Google_Service_Analytics($client);\n    // Get the first view (profile) id for the authorized user.\n    $profile = getFirstProfileId($analytics, ACC_ID, ACTION_TYPE);\n} else {\n    $redirect_uri = 'http://' . $_SERVER['HTTP_HOST'] . '/google-api/oauth2callback.php';\n    //echo $redirect_uri;exit;\n    header('Location: ' . filter_var($redirect_uri, FILTER_SANITIZE_URL));\n}\n\n$client->revokeToken();\n```\n. This is my oauth2callback.php file script \n``` php\nrequire_once 'src/Google/autoload.php';\n// Start a session to persist credentials.\nsession_start();\n// Create the client object and set the authorization configuration\n// from the client_secrets.json you downloaded from the Developers Console.\n$client = new Google_Client();\n$client->setAuthConfigFile('client_secrets.json');\n$client->setRedirectUri('http://' . $_SERVER['HTTP_HOST'] . '/google-api/oauth2callback.php');\n$client->addScope(Google_Service_Analytics::ANALYTICS_READONLY);\n// Handle authorization flow from the server.\nif (! isset($_GET['code'])) {\n  $auth_url = $client->createAuthUrl();\n  header('Location: ' . filter_var($auth_url, FILTER_SANITIZE_URL));\n} else {\n  $client->authenticate($_GET['code']);\n  $_SESSION['access_token'] = $client->getAccessToken();\n  $redirect_uri = 'http://' . $_SERVER['HTTP_HOST'] . '/google-api';\n  header('Location: ' . filter_var($redirect_uri, FILTER_SANITIZE_URL));\n}\n```\n. i should remove the \" if else \" script ? or only remove the if part ?\n. if I used bellow code and remove the authurl then it stuck me on oauth2callback.php \n$client->authenticate($_GET['code']);\n$_SESSION['access_token'] = $client->getAccessToken();\n$redirect_uri = 'http://' . $_SERVER['HTTP_HOST'] . '/google-api';\nheader('Location: ' . filter_var($redirect_uri, FILTER_SANITIZE_URL));\nI don't remembered now but I've used your old library. I've seen your new library you did lot of changes  but I didn't updated yet.\n. It didn't send me back to main url, it stuck on oauth2callback.php. I'm confused I want to access data using $client->setAuthConfigFile('client_secrets.json'); only. I don't want to direct me login page and after authenticating it give me access to data.\nAlso let me know is it possible to get google play statistics using this API ?\n. ",
    "santoshkverma212": "Hi  , I'm working on  google-api-php-client-master  ,  Set application_name,oauth2_client_id, oauth2_client_secret,developer_key,site_name  config.php  but  show  \nFatal error: Uncaught exception: 'Google_ServiceException' with message 'Error calling GET https://www.googleapis.com/customsearch/v1?q=burrito&cx=x1ncfes5s54&key=AIzaSyAg9moxq_kk3lZHz6tiwkaVHOEd6Pz8qWM: (403) The request did not specify any referer. Please ensure that the client is sending referer or use the API Console to remove the referer restrictions.' in D:\\xampp\\htdocs\\google-api-php-client-master\\src\\io\\Google_REST.php:66 Stack trace: #0 D:\\xampp\\htdocs\\google-api-php-client-master\\src\\io\\Google_REST.php(36): Google_REST::decodeHttpResponse(Object(Google_HttpRequest)) #1 D:\\xampp\\htdocs\\google-api-php-client-master\\src\\service\\Google_ServiceResource.php(186): Google_REST::execute(Object(Google_HttpRequest)) #2 D:\\xampp\\htdocs\\google-api-php-client-master\\src\\contrib\\Google_CustomsearchService.php(70): Google_ServiceResource->__call('list', Array) #3 D:\\xampp\\htdocs\\google-api-php-client-master\\examples\\customSearch\\index.php(31): Google_CseServiceResource->listCse('burrito', Array) #4 {main} thrown in D:\\xampp\\htdocs\\google-api-php-client-master\\src\\io\\Google_REST.php on line 66\nPlease help me regards this.  Thanks  Regards \n. ",
    "ArchanaShet": "Can I get the step by step configuration of Google API for Google Analytics Audit generation by using Management API v3?\nIt must display audit report.\nFor Ex : http://mixedanalytics.com/en/dashboard#/app\ufeff. I am trying to implement an app using Google API and am facing the following error:\nFatal error: Uncaught exception 'Google_Service_Exception' with message '{\"error\":{\"errors\":[{\"domain\":\"global\",\"reason\":\"required\",\"message\":\"Login Required\",\"locationType\":\"header\",\"location\":\"Authorization\"}],\"code\":401,\"message\":\"Login Required\"}}' in E:\\xampp\\htdocs\\App\\vendor\\google\\apiclient\\src\\Google\\Http\\REST.php:118 Stack trace: #0 E:\\xampp\\htdocs\\App\\vendor\\google\\apiclient\\src\\Google\\Http\\REST.php(94): Google_Http_REST::decodeHttpResponse(Object(GuzzleHttp\\Psr7\\Response), Object(GuzzleHttp\\Psr7\\Request), 'Google_Service_...') #1 [internal function]: Google_Http_REST::doExecute(Object(GuzzleHttp\\Client), Object(GuzzleHttp\\Psr7\\Request), 'Google_Service_...') #2 E:\\xampp\\htdocs\\App\\vendor\\google\\apiclient\\src\\Google\\Task\\Runner.php(181): call_user_func_array(Array, Array) #3 E:\\xampp\\htdocs\\App\\vendor\\google\\apiclient\\src\\Google\\Http\\REST.php(58): Google_Task_Runner->run() #4 E:\\xampp\\htdocs\\App\\vendor\\google\\apiclient\\src\\Google\\Client.php(779): Google_Http_REST::execute(Object(GuzzleHttp\\Client), Object(Guzzl in E:\\xampp\\htdocs\\App\\vendor\\google\\apiclient\\src\\Google\\Http\\REST.php on line 118. ",
    "digracesion": "i've been having the same issue. it was working previously, but then i got the same error message. i'm pretty sure my library is up to date though since it was up and running only moments before the error appeared.. ",
    "prajoshvm": "I am having the same issue when using google job service, is there any solution?. ",
    "jomarocas": "ok same bug, i still use the v1 branch. ",
    "dwsupplee": "\nUsers of your package will have to select a concrete adapter in their project to make your package installable. Best point them to the virtual package howto page.\n\nThe requirement of an additional dependency on the consumer of the package definitely gives me some pause.\n. Hey Brent, since we'll need to be doing something similar in the gcloud library I'd love it if we could sync up on how to move forward with this. :)\n. Well, as tempting as option number 2 sounds - I much prefer a good hard day's work. Sounds like a solid plan!\n. I agree with @bshaffer that all I see is the method name loadKey for the versions of phpseclib pinned by the client (~0.3.10|~2.0). \n@Saqibm128 which version of google/apiclient are you pinned to?\nThe following installs, but includes a client back to before phpseclib was introduced into the library, so I'm not sure where a conflict with loadKey would come up.\njson\n\"require\": {\n    \"google/apiclient\": \"*\",\n    \"phpseclib/phpseclib\": \"dev-master\"\n}\nPulling in a newer version conflicts, google/apiclient v2.0.0 requires phpseclib/phpseclib ~2.0 -> satisfiable by phpseclib/phpseclib[2.0.x-dev].\njson\n\"require\": {\n    \"google/apiclient\": \"~2.0\",\n    \"phpseclib/phpseclib\": \"dev-master\"\n}\nI'm not sure there is anything we can do here.. Happy to take a look.\n@mattwhisenhunt is this ready for me to review, or would you prefer I wait until the WIP flag is removed?\n@JustinBeckwith The new group notifications are really slick - but I don't seem to be getting any when tagging \"google/yoshi-php\".  \ud83d\ude15 . Is this just copied over from here? I have been putting together some notes, and there are some definite issues with that code (in my testing, it doesn't just work out of the box). It looks like this sample follows a similar pattern but is updated to be more idiomatic and to work correctly. I'd recommend we just link out to the latter sample, but if we prefer to have something different living in this repo I'd be happy to post my notes so this can be useful for our users.. @mattwhisenhunt is this okay to merge?. Hi @mattwhisenhunt \ud83d\udc4b. Just a friendly reminder there's a few places that need to be updated with the new location of CONTRIBUTING.md.. Good thought on the update :) - however I agree with Matt here. @vijay-qlogic, can we please update to Blogger?. > However, in https://github.com/googleapis/google-api-php-client-services/blob/d7a06d07832dbc6759d8f27ef29ccd6caed62735/src/Google/Service/Oauth2.php#L35 the old scopes are being referenced.\nThese scopes are auto-generated off of the latest discovery document found here. I expect once the shut-down is complete on March 7 that these scopes will be updated, and new constants should be available.\n\nWill these deprecated scopes cause a problem for when they get shut down when calling createAuthUrl?\n\nYes, I believe they would. You'll want to hard-code in the usage of profile, openid, and email as scopes until new constants are available in the generated code. This is certainly confusing, and I apologize for the hassle.\n@chandon, @PederBennedsen, @robthomas82 - I don't fully understand the issue you're running up against. Are you running into issues due to usage of the deprecated constants defined here? If so, please make sure you update your code to use the latest scopes which will be taking precedence after the upcoming the Google+ shutdown. I'm going to go ahead and close this out for now, but please feel free to re-open if there is anything else can help touch on.. Hi @ZGINMADAO, could you share a code snippet so we can help take a look?. @ZGINMADAO make sure you call getSiteEntry on the SitesListResponse to get an array you can iterate over, for example:\n```php\n$results = $service->sites->listSites();\nforeach ($results->getSiteEntry() as $entry) {\n    var_dump($entry->getSiteUrl());\n}\n```. I'm going to close this out now, please feel free to re-open if you're still running in to any issues.. Thanks for the PR @Yahav :)\nFrom what I can tell, it looks like the retry key of the client configuration should map here, so the original code looks correct. In order to provide custom retry maps, I believe what we need to do is expose a retryMap setting in the Google_Client constructor which we can pass down into Google_Http_REST like so:\nphp\nreturn Google_Http_REST::execute($http, $request, $expectedClass, $this->config['retry'], $this->config['retryMap']);\nWDYT?. Confirmed this does the trick.\nLGTM, except for one tiny nit. This is now breaking the line length guidelines (my fault, it was the way I formatted the code in my suggestion). Could we break this apart over some newlines?\nphp\nreturn Google_Http_REST::execute(\n    $http,\n    $request,\n    $expectedClass,\n    $this->config['retry'],\n    $this->config['retry_map']\n);. Could we please drop the whitespace here? LGTM otherwise.. ",
    "vinkla": ":+1: \n. ",
    "gigmaps": "@bshaffer even https://packagist.org/packages/aws/aws-sdk-php requires Guzzle 5.3.* at minimum\nusing a composer.json like:\n{\n    \"require\": {\n         \"google/apiclient\": \"^2.0.0@RC\",\n        \"aws/aws-sdk-php\": \"3.*\",\n     }\n}\nresults in the following composer output:\nProblem 1\n    - Conclusion: remove google/apiclient v2.0.0-RC2\n    - Conclusion: don't install google/apiclient v2.0.0-RC2\n    - google/apiclient v2.0.0-RC1 requires google/auth v0.3 -> satisfiable by google/auth[v0.3].\n    - Installation request for google/apiclient ^2.0.0@RC -> satisfiable by google/apiclient[v2.0.0-RC1, v2.0.0-RC2].\n    - Conclusion: don't install aws/aws-sdk-php 3.10.1\n    - aws/aws-sdk-php 3.0.0 requires guzzlehttp/guzzle ^5.3 || ^6.0.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.0.1 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.0.2 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.0.3 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.0.4 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.0.5 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.0.6 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.0.7 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.1.0 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.10.0 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.2.0 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.2.1 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.2.2 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.2.3 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.2.4 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.2.5 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.2.6 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.3.0 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.3.1 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.3.2 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.3.3 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.3.4 requires guzzlehttp/guzzle >=5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.3.5 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.3.6 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.3.7 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.3.8 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.4.0 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.4.1 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.5.0 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.6.0 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.7.0 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.8.0 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.8.1 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.8.2 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.9.0 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.9.1 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.9.2 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.9.3 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - aws/aws-sdk-php 3.9.4 requires guzzlehttp/guzzle ~5.3|~6.0.1|~6.1 -> satisfiable by guzzlehttp/guzzle[5.3.0, 6.0.1, 6.0.2, 6.1.0].\n    - Can only install one of: guzzlehttp/guzzle[5.3.0, 5.2.0].\n    - Can only install one of: guzzlehttp/guzzle[6.0.0, 5.2.0].\n    - Can only install one of: guzzlehttp/guzzle[6.0.1, 5.2.0].\n    - Can only install one of: guzzlehttp/guzzle[6.0.2, 5.2.0].\n    - Can only install one of: guzzlehttp/guzzle[6.1.0, 5.2.0].\n    - google/auth v0.3 requires guzzlehttp/guzzle 5.2.* -> satisfiable by guzzlehttp/guzzle[5.2.0].\n    - Conclusion: remove guzzlehttp/guzzle 5.2.0|install aws/aws-sdk-php 3.10.1\n    - Installation request for aws/aws-sdk-php 3.* -> satisfiable by aws/aws-sdk-php[3.0.0, 3.0.1, 3.0.2, 3.0.3, 3.0.4, 3.0.5, 3.0.6, 3.0.7, 3.1.0, 3.10.0, 3.10.1, 3.2.0, 3.2.1, 3.2.2, 3.2.3, 3.2.4, 3.2.5, 3.2.6, 3.3.0, 3.3.1, 3.3.2, 3.3.3, 3.3.4, 3.3.5, 3.3.6, 3.3.7, 3.3.8, 3.4.0, 3.4.1, 3.5.0, 3.6.0, 3.7.0, 3.8.0, 3.8.1, 3.8.2, 3.9.0, 3.9.1, 3.9.2, 3.9.3, 3.9.4].\n. ",
    "behunin": "You know me so well @bshaffer, I am feeling brave and desperate today :)\n. PSR-6! \ud83d\ude01 That guys bias against PSR-6 is ill founded, and is proven as such in the comments.\n. Stash the json\n. What API are your targeting? Calendars?\n. The best way I have found to submit dateTime to google is to instantiate the DateTime class in php and then format it to the DATE_ATOM format, which PHP recommends for ISO-8601 compatibility.\n$format = 'Y-m-d\\TH:i:sP'; //DATE_ATOM\n$endDate = new DateTime($eventModel->event_ends_datetime);\n$endsDate = $endDate->format($format);\n. Sorry, I should have mentioned this before, with PHP DateTime, the Timezone is set to the servers default timezone if you don't set the Timezone when you instantiate DateTime. \nThis should work for you:\nphp\n$starDate = new \\DateTime($event->calendar_starts_datetime, new DateTimeZone('Europe/Athens'));\n$endDate = new \\DateTime($event->calendar_ends_datetime, new DateTimeZone('Europe/Athens'));\nThen remove both:\nphp\n$start->setTimeZone('Europe/Athens');\n$end->setTimeZone('Europe/Athens');\nFYI Timezone has to be set this way( i.e.)\nphp\n$date->setTimeZone(new DateTimeZone('Europe/Amsterdam');\n. +1 @mattwisenhunt \nHave you seen the new labels with descriptions?\nI feel like a maintenance label with this wonderful response of yours as the description would be great. \nIt would also be wonderful if you googlers played the promise card on EVERYTHING. Lol\nI just want to async n' wait on your hand already. :). ",
    "uxweb": "HI!, i'm using the dev-add-support-for-guzzle-6 branch.\nI'm working with the YouTube Service classes but i'm getting this error:\nMediaFileUpload.php line 310:\nCall to undefined method GuzzleHttp\\Psr7\\Request::setHeader()\nThis is a Laravel 5.1 application and by default it includes guzzle 6.1.1 which won't let me install the RC version of this library :(.\nIs there a way to use the RC with guzzle 6?\nThanks!\n. ",
    "brutto": "In my composer.json with these dependences: \n...\n\"firebase/php-jwt\": \"^3.0\",\n\"google/apiclient\": \"v2.0.0-RC1\"\n...\noutput after > composer update command:\nProblem 1\n    - google/apiclient v2.0.0-RC1 requires google/auth v0.3 -> satisfiable by google/auth[v0.3].\n    - google/apiclient v2.0.0-RC1 requires google/auth v0.3 -> satisfiable by google/auth[v0.3].\n    - google/auth v0.3 requires firebase/php-jwt 2.0.0 -> no matching package found.\n    - google/auth v0.3 requires firebase/php-jwt 2.0.0 -> no matching package found.\n    - Installation request for google/apiclient v2.0.0-RC1 -> satisfiable by google/apiclient[v2.0.0-RC1].\ncomposer.json with these dependences: \n...\n\"firebase/php-jwt\": \"^3.0\",\n\"google/auth\": \"dev-master\",\n\"google/apiclient\": \"v2.0.0-RC1\"\n...\noutput problem:\nProblem 1\n    - google/apiclient v2.0.0-RC1 requires google/auth v0.3 -> no matching package found.\n    - google/apiclient v2.0.0-RC1 requires google/auth v0.3 -> no matching package found.\n    - Installation request for google/apiclient v2.0.0-RC1 -> satisfiable by google/apiclient[v2.0.0-RC1].\nOr am i right that you suggest to fork current google/apiclient and change composer.json there with \"google/auth\": \"~v0.3\" additionally?\n. yap int ok now, thanks\n. ",
    "brianhogg": "No problem!  Yes I was able to switch branches no problem, just feels like it would be best to have the unstable version not be on the default/master branch.  But if you're able to update all the documentation everywhere that works too :)\n. ",
    "heradonbenin": "i can't see the folder GuzzleHttp on the cloned repository\n. ",
    "martinlevington": "odd as the library was installed using composer.\nas described here\nhttps://developers.google.com/api-client-library/php/start/installation\nI confirm it is fixed in version 1.1.6\n. ",
    "aylesworthDev": "I have run into this issue after downloading the 1.1.7 release, the file was named UriTemplate.php, but file_exists() was looking for URITemplate.php  (I var_dumped out the $classPath in the google_api_php_client_autoload() function). Renaming the file has fixed it.\n. ",
    "tibee": "I signed it!\nOn Mon, Nov 2, 2015 at 2:53 PM, googlebot notifications@github.com wrote:\n\nThanks for your pull request. It looks like this may be your first\ncontribution to a Google open source project. Before we can look at your\npull request, you'll need to sign a Contributor License Agreement (CLA).\n[image: :memo:] Please visit https://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll\nverify. Thanks.\n\nIf you've already signed a CLA, it's possible we don't have your\n  GitHub username or you're using a different email address. Check your\n  existing CLA data and verify that your email is set on your git commits\n  .\nIf you signed the CLA as a corporation, please let us know the\n  company's name.\n\n\u2014\nReply to this email directly or view it on GitHub.\n. Certainly not.\n\nIt makes PHP Notice.\nSee manual:\nhttp://en.php.net/manual/en/language.types.array.php#language.types.array.foo-bar\nPHP Notice:  Use of undefined constant domain - assumed 'domain'.\nPHP Notice:  Use of undefined constant message - assumed 'message'.\n. Correct link:\nhttp://www.php.net/manual/en/language.types.array.php#language.types.array.foo-bar\n. ",
    "SurferJeffAtGoogle": "LGTM.\n. Can we update a test to exercise this new code path?\n. LGTM.\n. Add a test that checks the Google_Client::setAuthConfig() code path.\n. ",
    "wstoettinger": "Thanks for the quick response! Am I assuming correctly, that this requires to set up an Apps Script project first? Maybe I'm getting it wrong, but this looks a bit too complicated to setup for such very basic needs. \nI'd basically just like to add rows to an existing spreadsheet or update them (with data from a registration form in this case, so much similar to what google forms does). This shouldn't be more complicated than selecting the spreadsheet/worksheet via name or id and sending an array for insert or update (of course the authentication has to happen before). \nBefore Google shut down the username/password authentication, I used this neat library (it requires ZEND 1) which shows quite nicely how easily it could be done: http://www.farinspace.com/saving-form-data-to-google-spreadsheets/. Unfortunately it neither works with service accounts, nor on the GAE.\n. ",
    "verbruggenalex": "The only difference I can come up with between my dev server and localhost is I'm working on port 8080 and 4433 on my localhost. Could that interfere with Guzzle requests?\nPS: I'm just writing a Drupal module for uploading videos to YouTube. And I want people to be able to disable SSL verification just for testing purposes if they encounter the same problem as I am. I'm well aware never to do this on a production server.\n. The authentication was working in RC1 and not anymore in RC2 if that helps narrow it down.\n. ",
    "jatasya": "you can checkout the below link\n[(http://stackoverflow.com/questions/29822686/curl-error-60-ssl-certificate-unable-to-get-local-issuer-certificate/34883260#34883260)]\n. ",
    "AdnanHussainTurki": "You can check out this video:\nhttps://youtu.be/fWyV9Kt3wUM. ",
    "dannyrb": "It looks like this was taken care of here:\nhttps://github.com/google/google-api-php-client/issues/717\nSetting a composer dependency on v ^2@DEV seems to do the trick, while @RC is still broken for this.\n. @bshaffer Thanks for the quick turnaround :+1: \n. ",
    "ascalabro": "Your reply makes sense. When I downgrade to v1, it works as expected for me without changing any code, surprisingly. When calling the service from the OAuth2 playground it also works as expected.\nThat's why I suspect it must be internal code at fault. I will look more into why this is happening within the scope of this project and return.\n. Google_Auth_AssertionCredentials has been removed in 2.x\nThe docs seem to be behind and not updated\nSee UPGRADING.md\n. @ShelterJames I've encountered several issues with 2.x since it's been released.\nTo prevent delay in development due to bugs, I've switched my composer back to \"google/apiclient\": \"1.*\" and all works fine\n. ",
    "ShelterJames": "Oh, I've just found https://github.com/google/google-api-php-client/blob/master/UPGRADING.md\nSo it's the docs at https://developers.google.com/analytics/devguides/reporting/core/v3/quickstart/service-php that are wrong.\n. I've gone back to V1 and got some data out .... so guess issue is https://developers.google.com/analytics/devguides/reporting/core/v3/quickstart/service-php should mention it's V1 of the lib. Anyway, thanks.\n. Ah, I see\n\ngit clone -b v1-master\n\nFirstly, sorry if I was a bit harsh. Stupid day yesterday.\nI think the reason I missed that the first time is that I was looking for composer setup. I'd seen the Github repo and knew this was an option, so grabbed the version from there. So things I would do:\n1) I think the only place https://developers.google.com/analytics/devguides/reporting/core/v3/quickstart/service-php mentions this is in the git command, which I missed as I didn't read the command in detail. I would put a sentence is Step 2 of that page, something like \"Note this tutorial applies to V1 of the library - please make sure you check that out from branch v1-master\". \n2) Ideally, section 2 should mention Composer setup and again be very clear in pointing out to use the version string \"1.*\". This would involve changing\nrequire_once 'google-api-php-client/src/Google/autoload.php';\nin section 3 to have require statements for both composer and direct download, something like:\n// If you downloaded directly .... \nrequire_once 'google-api-php-client/src/Google/autoload.php';\n// If you downloaded with composer ....\nrequire_once 'vendor/autoload.php';\nwith maybe a line at the top saying \"Use whichever 'require_once' statement matches your method of download, and remove the other one.\"\n3) The composer setup section in https://github.com/google/google-api-php-client/blob/master/README.md could mention both versions, something like:\ncomposer require google/apiclient:^2.0.0@RC\nNote the documentation at developers.google.com refers to V1 of this library. If you want to use the older version, instead use:\ncomposer require google/apiclient:1.*\nThanks,\nJames\n. ",
    "KevinBatdorf": "Quick fix if this error is bothering you. Just checks if the offset exists using array_key_exists(). \nphp\n// Collection.php\nprivate function coerceType($offset)\n  {\n  $typeKey = $this->keyType($this->collection_key);\n  if (isset($this->$typeKey) &&\n  array_key_exists($offset,$this->modelData[$this->collection_key]) &&\n  !is_object($this->modelData[$this->collection_key][$offset])) {\n    $type = $this->$typeKey;\n    $this->modelData[$this->collection_key][$offset] =\n        new $type($this->modelData[$this->collection_key][$offset]);\n  } else {\n    throw new Exception(\"woah there!\");\n  }\n}\n. ",
    "ruslan-polutsygan": "I signed it!\n. I'm OK with this if it is expected. \nI probably read text not carefully.\n. ",
    "pitbred": "Ohh, i must use update function, but here \nhttps://cloud.google.com/storage/docs/json_api/v1/buckets/patch#try-it\npossible to set null for MainPageSuffix, nevermind...\n. ",
    "mrajabtech": "I figured the Google_model's final constructor was not triggered because of another library with the same class name Google_model. I had to rename it to fix the issue. Apologies. \n. ",
    "sraul2015": "Even I am facing same issue. I tried sample example on local environment for the first time and it gave same error. Has anyone resolved this? what is the cause? any pointers \n. ",
    "tigerhawkvok": "Ahh, PHP 5.4 whereas my client's server is 5.3. Closing.\n. ",
    "rkhatak": "Hope this will help:\n $google_account = array(\n            'email' => 'service account email',\n            'key' => file_get_contents('../client_secrets.json'),\n            'profile' => projectId\n        );\n$client = new Google_Client();\n    $client->setApplicationName('demomunch');\n    $this->object = new Google_Service_Analytics($client);\n    $scopes = array(Google_Service_Analytics::ANALYTICS_READONLY);\n    $client->setScopes($scopes);\n    $client->setAuthConfigFile('../client_secrets.json');\n    if ($client->isAccessTokenExpired()) {\n        $client->refreshTokenWithAssertion();\n    }\nIts working for me.\n. ",
    "parapet3": "bshaffer this does not solve the problem. I deleted the vendor folder, removed the repository section and ran composer again. No luck.\n. ",
    "Ennorath": "@bshaffer \nCan i use only library without composer? \nI have this error - Class 'Google\\Auth\\OAuth2' not found in... \nBut Client.php have line:\nuse Google\\Auth\\OAuth2; \n. @bshaffer How install composer on hosting? Please, help\n. ",
    "bocharsky-bw": "@bshaffer So how to do this changes and avoid overwriting on the next update?\n. Well, for now I just want to improve code quality here.\n. Yea, it'll be a bit hard this way. Thanks for explanation how it works.\n. ",
    "OlivierBarbier": "I signed it!\n. Right.\n\nLe 3 d\u00e9c. 2015 \u00e0 22:18, Nick B. notifications@github.com a \u00e9crit :\nif (isset($result['error'], $result['error']['errors'])) {\nShould just be:\nif (isset($result['error']['errors'])) {\nFor $result['error']['errors'] to exist it already implies that $result['error'] would already exist. Right?\n\u2014\nReply to this email directly or view it on GitHub.\n. \n",
    "austinpray": "I was getting \ngoogle/apiclient dev-master requires guzzlehttp/guzzle 5.2.* -> no matching package found.\nrequiring this branch via\n\"google/apiclient\": \"dev-add-support-for-guzzle-6#305fd9c43ccc7921ab71cd848b0420c3e8f620fd\"\nFixes the issue. Thanks for this!\n. Thanks guys!\n. ",
    "jordikroon": "I signed it!\n. Fixed #769\n. Yes you're right. I've removed the parameters from the usages.\n. ",
    "caleblloyd": "RE: the change made on: https://github.com/google/google-api-php-client/blob/master/src/Google/Cache/File.php#L76\nit seems to me that this statement now has no effect, since the output is not assigned to a variable. did you mean to leave it as:\n$data =  unserialize($data);\n. @bshaffer just recreated this with 2.0.0RC4 using Guzzle6.\nThe shouldDefer() conditional is returning the request before it is transformed for upload.  Looks to me like Lines 204-212 need to be moved to right before the function's return statement on line 232. https://github.com/google/google-api-php-client/blob/master/src/Google/Service/Resource.php#L204-L212\nHere's the code:\n```\nuse GuzzleHttp\\Psr7;\nuse \\Google_Http_MediaFileUpload;\nuse \\Google_Service_Storage_StorageObject;\n// These are custom helpers I've implemented\n/ @var \\Google_Client $googleClient */\n$googleClient = $google->getClient();\n/ @var \\GuzzleHttp\\Client $httpClient /\n$httpClient = $google->getHttpClient();\n/ @var \\Google_Service_Storage $storage /\n$storage = $google->getStorage();\n$bucket = 'example';\n$stream = Psr7\\stream_for(\"hello\");\n// Params to pass a stream for the HTTP Body in $storage->objects->insert\n$params = [\n    'data' => $stream,\n    'mimeType' => 'text/plain',\n];\n// Metadata object for new Google Cloud Storage object\n$obj = new Google_Service_Storage_StorageObject();\n$obj->contentType = \"text/plain\";\n// Serial Upload - Works\n$obj->name = \"serial\";\n$response = $storage->objects->insert($bucket, $obj, $params);\necho \"Serial uploaded to: \".$response->mediaLink.PHP_EOL;\n// Batch Upload - Fails\n$googleClient->setUseBatch(true);\n$obj->name = \"batch\";\n/* @var \\GuzzleHttp\\Psr7\\Request $request /\n$request = $storage->objects->insert($bucket, $obj, $params);\ntry {\n    $response = json_decode($httpClient->send($request)->getBody(), true);\n    echo \"Batch uploaded to: \".$response['mediaLink'].PHP_EOL;\n} catch (\\Exception $e){\n    echo $e->getMessage().PHP_EOL;\n}\n// Batch Upload Hacked - Works\n$upload = new Google_Http_MediaFileUpload($googleClient, $request, $obj->contentType, $stream);\n$request = $upload->getRequest();\n$response = json_decode($httpClient->send($request)->getBody(), true);\necho \"Batch Hacked uploaded to: \".$response['mediaLink'].PHP_EOL;\n```\nOutput is:\n``\nSerial uploaded to: https://www.googleapis.com/download/storage/v1/b/example/o/serial?generation=123&alt=media\nClient error:POST https://www.googleapis.com/storage/v1/b/example/oresulted in a400 Bad Request` response:\n{\n    \"error\": {\n    \"errors\": [\n   {\n       \"domain\": \"global\",\n    \"reason\": \"wrongUrlForUpload\",\n    \"message\": \"Upload reque (truncated...)\nBatch Hacked uploaded to: https://www.googleapis.com/download/storage/v1/b/example/o/batch?generation=123&alt=media\n```\nWhen I move Lines 204-212 to right before line 232, everything works as expected:\nSerial uploaded to: https://www.googleapis.com/download/storage/v1/b/example/o/serial?generation=123&alt=media\nBatch uploaded to: https://www.googleapis.com/download/storage/v1/b/example/o/batch?generation=123&alt=media\n. Thanks, @bshaffer!\n. @bshaffer the underlying call here is using Guzzle's Batch, which really is a bunch of single upload requests to different endpoints executed in a pool.  It's not actually uploading multiple files to the same endpoint (that's what these other issues seem to be referring to)\nBut yes, I am performing multiple uploads at once to Google Cloud Storage using batch mode through the v2 PHP API.\n. I actually get the Guzzle HTTP requests from the v2 PHP API and pass them to \\GuzzleHttp\\Pool.  Looks like this may circumvent the v2 API's Batch functionality.\n\\GuzzleHttp\\Pool executes the requests through libcurl in an event loop, so they do happen asynchronously.\nHere is a code sample of how I perform multiple uploads to Google Cloud Storage.  Note, you need to be running 2.0.0rc5 at least for this to work properly due to https://github.com/google/google-api-php-client/pull/789\n```\n/* @var \\Google_Client $client /\n$client->setUseBatch(true);\n/* @var \\GuzzleHttp\\Psr7\\Request[] $requests /\n$requests = [];\nforeach ($docs as $doc) {\n    $obj = new \\Google_Service_Storage_StorageObject();\n    $obj->name = $doc['name'];\n    $obj->contentType = \"text/plain\";\n    $requests[] = $storage->objects->insert(\n        'bucket-name',\n        $obj,\n        [\n            'data' => new \\GuzzleHttp\\Psr7\\LazyOpenStream($doc['file_name'], 'r'),\n            'mimeType' => $obj->contentType,\n       ]\n    );\n}\n$httpClient = $client->getHttpClient();\n/* @var \\GuzzleHttp\\Client $httpClient /\n$batch = new \\GuzzleHttp\\Pool::batch($httpClient, $requests);\nforeach ($batch as $i => $response) {\n    if ($response instanceof \\Exception) {\n        // something happened\n    } else {\n        // all good\n    }\n}\n```\n. @temuri416 when you mention \"Whoa. After moving those lines as described above code from #860 works PERFECT!\" \nThat was a bug resolved Dec 30th 2015 and first tagged in v2.0.0RC5.  If you update to v2.0.0RC5, you should get the fix in your vendored library.\n. @temuri416 the line numbers referenced in this issue have since changed.  You basically reversed the code back to what it was in v2.0.0RC4.  Are you sure that a valid file was uploaded at all when you change these lines back?\nThe problem that I was running into in RC4 is that the Google_Http_MediaFileUpload object mutates the URL of the uploaded file to the correct URL.  If it hits shouldDefer() without calling Google_Http_MediaFileUpload first (as you have reverted your code to do), the URL to upload the file to never gets properly set.\n. ",
    "SaradambalMunusamy": "Any updates regarding version issue,  we need API V 3 support drive in google-api-php-client immediately.\nPlease any one update.\n. ",
    "dmatora": "i got this fixed by changing google/auth from latest to 0.4\n. ",
    "Philippus": "Thank you @dmatora ! This had us stumped for hours.\n. Thanks @bshaffer for the help. We made a silly mistake, we were using the wrong e-mail address as the subject (...@company instead of ...@gmail.com)\n. ",
    "maxdlx": "signed\n. ",
    "jkenn99": "I signed it!\n. 0.5 is tagged and supports guzzle 6\n. ",
    "DavidPrevot": "\ncan you sign the CLA\n\nJust signed it (recorded at Dec 28, 2015 10:01 PST), sorry for the delay.\n. ",
    "vikasmalhotra08": "Hi \nI checked this issue: #263\nSeems to be that format for access token described in above issue does not match with the format been generated in new api. \nThat might be the reason why API is throwing a 'Invalid code' exception. \nFormat in #263 is \n{\"access_token\":\"ya29.PgB0miRDMD3H-iAAAAD88eQLK9N84muCYYR4TEhwffsj5yNJBXMt34Sd6B815Q\",\"token_type\":\"Bearer\",\"expires_in\":3597,\"created\":1404986763}\nThe format that I am getting is:\n(\n    [access_token] => ya29.UwLS9jTLZC8tMTLR1y47mbAE0dHVI6vaS4X_CxIDXGQcJNfO4UWKiIUbb61zyNB4DuY8Bearer36001/1bUTEa-GSiWphKKbiwV8Ts2i4rOAJWByBnYoNjyQjaxIgOrJDtdun6zK6XiATCKT1450896768\n)\n. Looks like a bug but I am not sure, I made the following changes in the code to get it working:\nwhile getting contents, I used serialize function \nExample: $accessToken = serialize (file_get_contents($credentialsPath));\nwhile inserting contents, I used deserialize function\nExample: $accessToken = derialize(file_put_contents($credentialsPath, $accessToken););\n. ",
    "Jpsy": "Same problem here.\nIn my case it happens with the quickstart.php shown at:  https://developers.google.com/apps-script/guides/rest/quickstart/php\nIt is either buggy or not compatible with the 2.0 version of this library. Inserting serialize() in all places that write $accessToken and unserialize() in all places that read $accessToken fixed the problem for me too.\n. Correction:\nAs the accessToken file has the extension .json it makes much more sense to really store in JSON format. So the correct patches for quickstart.php would be:\n```\n    FROM: $accessToken = file_get_contents($credentialsPath);\n    TO:   $accessToken = json_decode(file_get_contents($credentialsPath), true);  // don't miss the second parameter true here!!!\nFROM: file_put_contents($credentialsPath, $accessToken);\nTO:   file_put_contents($credentialsPath, json_encode($accessToken));\n\nFROM: file_put_contents($credentialsPath, $client->getAccessToken());\nTO:   file_put_contents($credentialsPath, json_encode($client->getAccessToken()));\n\n```\n. ",
    "developerside": "i'm also getting this error its fresh from composer did you fix this issue please advise bro\n. Hi @awoyele sorry but no one seems to care. yes i have followed all the steps but its not working. ",
    "Sharma-Ravin": "I want to access the list of spread sheets in google drive. But having error mentioned below  : \nFatal error: Uncaught LogicException: refresh token must be passed in or set as part of setAccessToken in C:\\xampp\\htdocs\\newsheet1\\vendor\\google\\apiclient\\src\\Google\\Client.php:258 Stack trace: #0 C:\\xampp\\htdocs\\newsheet1\\quickstart.php(53): Google_Client->fetchAccessTokenWithRefreshToken(NULL) #1 C:\\xampp\\htdocs\\newsheet1\\quickstart.php(77): getClient() #2 {main} thrown in C:\\xampp\\htdocs\\newsheet1\\vendor\\google\\apiclient\\src\\Google\\Client.php on line 258\nMy code is given below:\n`<?php\nrequire_once DIR . '/vendor/autoload.php';\ndefine('APPLICATION_NAME', 'Google Sheets API PHP Quickstart');\ndefine('CREDENTIALS_PATH', 'secretkey.json');\ndefine('CLIENT_SECRET_PATH', DIR . '/client_secret.json');\n// If modifying these scopes, delete your previously saved credentials\n// at ~/.credentials/sheets.googleapis.com-php-quickstart.json\ndefine('SCOPES', implode(' ', array(\n  Google_Service_Sheets::SPREADSHEETS_READONLY)\n));\n/\nif (php_sapi_name() != 'cli') {\n  throw new Exception('This application must be run on the command line.');\n}\n/\n/*\n * Returns an authorized API client.\n * @return Google_Client the authorized client object\n /\nfunction getClient() {\n  $client = new Google_Client();\n  $client->setApplicationName(APPLICATION_NAME);\n  $client->setScopes(['https://www.googleapis.com/auth/drive','https://spreadsheets.google.com/feeds']);\n  $client->setAuthConfig(CLIENT_SECRET_PATH);\n  $client->setAccessType('offline');\n// Load previously authorized credentials from a file.\n  $credentialsPath = expandHomeDirectory(CREDENTIALS_PATH);\n  if (file_exists($credentialsPath)) {\n    $accessToken = json_decode(file_get_contents($credentialsPath), true);\n  } else {\n    // Request authorization from the user.\n    $authUrl = $client->createAuthUrl();\nprintf(\"Open the following link in your browser:\\n%s\\n\", $authUrl);\nprint 'Enter verification code: ';\n$authCode = trim(fgets(STDIN));\n\n// Exchange authorization code for an access token.\n$accessToken = $client->fetchAccessTokenWithAuthCode($authCode);\n\n// Store the credentials to disk.\nif(!file_exists(dirname($credentialsPath))) {\n  mkdir(dirname($credentialsPath), 0700, true);\n}\n//print_r($accessToken); \necho file_put_contents($credentialsPath, json_encode($accessToken));\n//print_r($accessToken); \nprintf(\"Credentials saved to %s\\n\", $credentialsPath);\n\n}\n  $client->setAccessToken($accessToken);\n// Refresh the token if it's expired.\n  if ($client->isAccessTokenExpired()) {\n    $client->fetchAccessTokenWithRefreshToken($client->getRefreshToken());\n    if(!isset($new_token['refresh_token']))\n    {\n        $new_token['refresh_token'] = $refresh_token;\n    }\n    file_put_contents($credentialsPath, json_encode($client->getAccessToken()));\n  }\n  return $client;\n}\n/*\n * Expands the home directory alias '~' to the full path.\n * @param string $path the path to expand.\n * @return string the expanded path.\n /\nfunction expandHomeDirectory($path) {\n  $homeDirectory = getenv('HOME');\n  if (empty($homeDirectory)) {\n    $homeDirectory = getenv('HOMEDRIVE') . getenv('HOMEPATH');\n  }\n  return str_replace('~', realpath($homeDirectory), $path);\n}\n// Get the API client and construct the service object.\n$client = getClient();\n$service = new Google_Service_Sheets($client);\n// Prints the names and majors of students in a sample spreadsheet:\n// https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit\n$spreadsheetId = '1yjDwbfDOrC5Vsu5MTw1fDjTFuUytSoVAQnd0tPyOUKE';\n$range = 'accesssheet!A2:E';\n$response = $service->spreadsheets_values->get($spreadsheetId, $range);\n$values = $response->getValues();\nif (count($values) == 0) {\n  print \"No data found.\\n\";\n} else {\n  print \"Name, Major:\\n\";\n  foreach ($values as $row) {\n    // Print columns A and E, which correspond to indices 0 and 4.\n    printf(\"%s, %s\\n\", $row[0], $row[4]);\n  }\n}\n`. I want to get the drive's spreadsheets list. I am using the Drive api. while running apitest.php file. I face the error:\nPHP Fatal error:  Uncaught InvalidArgumentException: json key is missing the typ\ne field in C:\\xampp\\htdocs\\googleSheets\\vendor\\google\\auth\\src\\CredentialsLoader\n.php:129\nStack trace:\n0 C:\\xampp\\htdocs\\googleSheets\\vendor\\google\\auth\\src\\CredentialsLoader.php(82)\n: Google\\Auth\\CredentialsLoader::makeCredentials('https://www.goo...', Object(Gu\nzzleHttp\\Psr7\\Stream))\n1 C:\\xampp\\htdocs\\googleSheets\\vendor\\google\\auth\\src\\ApplicationDefaultCredent\nials.php(137): Google\\Auth\\CredentialsLoader::fromEnv('https://www.goo...')\n2 C:\\xampp\\htdocs\\googleSheets\\vendor\\google\\apiclient\\src\\Google\\Client.php(10\n54): Google\\Auth\\ApplicationDefaultCredentials::getCredentials('https://www.goo.\n..')\n3 C:\\xampp\\htdocs\\googleSheets\\vendor\\google\\apiclient\\src\\Google\\Client.php(22\n6): Google_Client->createApplicationDefaultCredentials()\n4 C:\\xampp\\htdocs\\googleSheets\\apitest.php(37): Google_Client->fetchAccessToken\nWithAssertion()\n5 {main}\nthrown in C:\\xampp\\htdocs\\googleSheets\\vendor\\google\\auth\\src\\CredentialsLoade\nr.php on line 129\nFatal error: Uncaught InvalidArgumentException: json key is missing the type fie\nld in C:\\xampp\\htdocs\\googleSheets\\vendor\\google\\auth\\src\\CredentialsLoader.php:\n129\nStack trace:\n0 C:\\xampp\\htdocs\\googleSheets\\vendor\\google\\auth\\src\\CredentialsLoader.php(82)\n: Google\\Auth\\CredentialsLoader::makeCredentials('https://www.goo...', Object(Gu\nzzleHttp\\Psr7\\Stream))\n1 C:\\xampp\\htdocs\\googleSheets\\vendor\\google\\auth\\src\\ApplicationDefaultCredent\nials.php(137): Google\\Auth\\CredentialsLoader::fromEnv('https://www.goo...')\n2 C:\\xampp\\htdocs\\googleSheets\\vendor\\google\\apiclient\\src\\Google\\Client.php(10\n54): Google\\Auth\\ApplicationDefaultCredentials::getCredentials('https://www.goo.\n..')\n3 C:\\xampp\\htdocs\\googleSheets\\vendor\\google\\apiclient\\src\\Google\\Client.php(22\n6): Google_Client->createApplicationDefaultCredentials()\n4 C:\\xampp\\htdocs\\googleSheets\\apitest.php(37): Google_Client->fetchAccessToken\nWithAssertion()\n5 {main}\nthrown in C:\\xampp\\htdocs\\googleSheets\\vendor\\google\\auth\\src\\CredentialsLoade\nr.php on line 129. ",
    "AsimTariq": "@Jpsy You are an angel! Thanks, your solution worked for me on the quickstart project \ud83d\udc4d . ",
    "guicara": "This code doesn't work anymore with Google API Client RC5 because the last version use Guzzle 6.\nYou should use this syntax instead:\n$client->setHttpClient(new \\GuzzleHttp\\Client(array(\n        'verify' => 'C:\\Windows\\curl-ca-bundle.crt',\n    )));\n. ",
    "neovea": "Hello I have the same issue. Whatever I set php to use the latest curl certificate, the problem remains.\nI'm having the issue on windows 7. Is there a fix ?\nThanks\n. I gave up in it.\n. ",
    "ace411": "The guzzle package is downloaded with the google dependencies and I cannot access the Guzzle classes and methods via the $client = new Guzzle\\Http\\Client (); syntax. \nI am working with a testing server and need some help.\n. ",
    "TLMcode": "For those that still want/need to know.\nThe php.ini entry curl.cainfo has to point to a cacert.pem\nSo: curl.cainfo = \"PATH_TO/cacert.pem\"\nSee here: https://git.io/vKRgY\nGet the pem cert here ( there should also be one in the cURL dir ) :  https://curl.haxx.se/ca/cacert.pem\nhth\n. ",
    "razikallayi": "It still exist in my local system. I tried it in a hosting space and it is working fine. ",
    "SkydiveMarius": "It seems that there is no ready original PHP Contacts library from Google out there.\nBut there are already a few open source third party libraries.\nMaybe you can use/customize them.\nFor the \"low level\" HTTP communication please consult: https://developers.google.com/google-apps/contacts/v3/\n. ",
    "zyberspace": "Signed it.\n. Ok, seems like this didn't fix anything at all. Don't know why but these notices are back even it worked like an hour ago.\nWill close this pull request now and maybe open a second one if i will ever fix this issue.\n. Ok, i really messed up here, sry. So the original line only served guzzle 5 while i was using guzzle 6.\nSo these changes did actually nothing in guzzle 6 even it worked in my tests.\nAlso Guzzle 5 throws an exception when this gets used in production (even the tests are working, because i relied on them to test this in guzzle 5 before i installed guzzle 5 in my production app).\nSo i am gonna close this now and search for a way to remove these ssl context options in guzzle 6 even it doesn't seem like this is possible without some big changes.\n. ",
    "sivabalan02": "Hai bshaffer, sorry for late reply. I updated the issue with the code itself\n. ",
    "daftspunk": "@sivabalan02 After extensive testing, it looks like newly generated P12 files are no longer usable in v1 at all. Tested Google_Service_Analytics::ANALYTICS_READONLY scope only. Even the JSON files using v1 don't seem to play nicely.\nHere is the code and documentation changes we used for the upgrade from 1.0 to 2.0, it might help you.\n. All old P12 files that were set up prior to the Google Developer Tools UI changes are working fine with the v1 library. Any new accounts with P12 files receive the invalid_grant error even using the identical PHP code base. It leads me to believe it is an issue with the API.\nWhen attempting to use the JSON file for auth, v1 was looking for a key called \"client_secret\" in the JSON file which is missing from those newly generated by the Dev Tools. Among other missing keys, it outputs error Invalid client secret JSON file. I do not have an old [working] JSON file from the previous Dev Tools to compare with.\n. ",
    "JamesVanWaza": "I signed it!\nOn Wed, Jan 6, 2016 at 10:42 PM googlebot notifications@github.com wrote:\n\nThanks for your pull request. It looks like this may be your first\ncontribution to a Google open source project. Before we can look at your\npull request, you'll need to sign a Contributor License Agreement (CLA).\n[image: :memo:] Please visit https://cla.developers.google.com/\nhttps://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll\nverify. Thanks.\n\nIf you've already signed a CLA, it's possible we don't have your\n  GitHub username or you're using a different email address. Check your\n  existing CLA data https://cla.developers.google.com/clas and verify\n  that your email is set on your git commits\n  https://help.github.com/articles/setting-your-email-in-git/.\nIf you signed the CLA as a corporation, please let us know the\n  company's name.\n\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/798#issuecomment-169540304\n.\n\nJames Gacuca\njgacuca@gmail.com\n(202)-569-1159\n. \n",
    "Gummibeer": "@bshaffer Thanks a lot for your detailed explanation! :+1:\nIt allowed me to refactor an old Adapter for laravel piece by piece.\n. Ok, thanks - than I will walk through the Migration guide and upgrade after it.\nhttps://developers.google.com/drive/v3/web/migration\n. ",
    "AndreyNazarchuk": "@bshaffer Now it says 'Requested client not authorized', even though I just pushed accept and copied the code and put it in the fetch function!\n. @bshaffer It did once, then after that I cant get it to show up again.\n. @bshaffer How can I ensure token is fetched as expected?\n. ",
    "ahait": "@bshaffer Your post saved my day!! I've been trying all kinds of things, and couldnt make it work as I wanted to, and your step-by-step guide has just been wonderful!! Thank YOU! After almost 10 hours of work with this: THANK YOU !. ",
    "abhay1003": "hey, I am bigner in PHP and i want to upload csv/pdf file in drive programatically.\n```php\nnamespace GoogleApi;\nrequire 'GoogleApi/Client.php';\nrequire 'GoogleApi/Contrib/apiOauth2Service.php';\nrequire 'GoogleApi/Contrib/apiDriveService.php';\n$pdfFile = 'files/pdf.pdf';\n//$pdfFile = 'files/report.csv';\n// API Console: https://code.google.com/apis/console/\n// Create an API project (\"web applications\") and put the client id and client secret in config.ini.\n// Set up the Drive SDK in the API console.\n// Create a Chrome extension, set the \"container\" and \"api_console_project_id\" parameters, and install it.\n$config = parse_ini_file('php.ini'); // client_id, client_secret\n// initialise the client\n$client = new Client();\n$client->setUseObjects(true);\n$client->setAuthClass('apiOAuth2');\n$client->setScopes(array('https://www.googleapis.com/auth/drive.file'));\n$client->setClientId($config['932339130642-s0t08hcbtvbnp8e6e9f9q7c2gdkba7hn.apps.googleusercontent.com']);\n$client->setClientSecret($config['u1cKtQ2b6iQ5zZJF7zYNQrUu']);\n$client->setRedirectUri($config['http://localhost/test/driver_data']);\n$client->setAccessToken(authenticate($client));\n// initialise the Google Drive service\n$service = new apiDriveService($client);\n// create and upload a new Google Drive file, including the data\ntry {\n    $file = new DriveFile;\n    $file->setTitle(basename($pdfFile));\n    $file->setMimeType('application/pdf');\n$result = $service->files->insert($file, array('data' => file_get_contents($pdfFile), 'mimeType' => 'application/pdf'));\n\n}\ncatch (Exception $e) {\n    print $e->getMessage();\n}\nprint_r($result);\nfunction authenticate($client, $file = 'token.json'){\n    if (file_exists($file)) return file_get_contents($file);\n$_GET['code'] = ''; // insert the verification code here\n\n// print the authentication URL\nif (!$_GET['code']) {\n    exit($client->createAuthUrl(array('https://www.googleapis.com/auth/drive.file')) . \"\\n\");\n}\n\nfile_put_contents($file, $client->authenticate());\nexit('Authentication saved to token.json - now run this script again.');\n\n}\n```\nI am using above code but not working...Please help me.\nThank You. ",
    "rmtngh": "@bshaffer \nHi Brent,\nThanks for your detailed explanation, however I tried all the steps and I could get the app to show up in my account's authorized clients page, But I still get \"unauthorized_client\" error when I switch to service account's credentials and try to impersonate the account for which I authorized the app.\n$client->setSubject('<ACCOUNT_THAT_AUTHORIZED_APP>@gmail.com');\nI tried deleting service account, shutting down the project, starting everything over again, changing service account permissions (owner, editor, ...)\nIs there anything else I can try?\n. ",
    "ignacvucko": "I am having the exact same issue.\n1) I got the code\n2) Successfully used it to fetch a token\n3) Verified that my app is listed in the \"Third-party apps\" for my personal gmail account.\n4) Use the service account json file and successfully call:\n  putenv(\"GOOGLE_APPLICATION_CREDENTIALS=/path/to/my/service/account/json/file.json\");\n  $client = new Google_Client();\n  $client->useApplicationDefaultCredentials();\n  $client->addScope(Google_Service_Drive::DRIVE);\n  $client->setSubject(\"my personal gmail address\");\n  $service = new Google_Service_Drive($client);\n5) But then when I try to call the below to list the files, I get an authentication error:\n   $optParams = array(  'pageSize' => 10,  'fields' => 'nextPageToken, files(id, name)' );\n   $results = $service->files->listFiles($optParams);\nFatal error: Uncaught exception 'Google_Service_Exception' with message '{\n \"error\": \"unauthorized_client\",\n \"error_description\": \"Client is unauthorized to retrieve access tokens using this method.\"\n}\nAny idea what I might be doing wrong?\nDoes this only work for GSuite accounts and not regular personal Gmail accounts.\nThanks.. ",
    "0x42h": "@ignacvucko; my best guess is;\n\nDoes this only work for GSuite accounts and not regular personal Gmail accounts.\n\nYes, this is probably so, but let me check tomorrow.. ",
    "josedsilva": "\n\n\nWhoops, looks like something went wrong.\n\n1/1\nGoogle_Exception in MediaFileUpload.php line 299:\nFailed to start the resumable upload (HTTP 200)\n\n\n\n in MediaFileUpload.php line 299\nat Google_Http_MediaFileUpload->getResumeUri() in MediaFileUpload.php line 138\nat Google_Http_MediaFileUpload->nextChunk('ID3\u0004\u0001\u0014TXXX\u0012major_brandmp42TXXX\u0011minor_version0TXXX\u001ccompatible_brandsisommp42TDEN\u00152015-04-21 06:05:39TSSE\u000eLavf54.6.100\ufffd\ufffdPInfo\u0007\u0006Qv\u0005(a#\u0006\b\u000b\n\u0010\u0012\u0015\u0018\u001a\u001d\u001f\"$'),.1368;>@CEHJMORTWY\\^adfiknpsuxz}\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdPd\u000f\ufffdi\b\n \u0001\u0001\ufffd 4\ufffd\u0004LAMEUUU@\u0004\ufffd\u0018\f\ufffd\ufffd\ufffd\ufffdV\ufffd\ufffd@\ufffd.\u000f(\u0514\ufffd\ufffd\u000b yDRP\ufffd\ufffd8%\u00140\ufffdb\u001c%e\u001c\ufffd\ufffd\ufffd=\ufffd\ufffd\ufffd\ufffd\ufffd\"2tyL\ufffd\ufffd\ufffd1\ufffd\u001cC\ufffd\ufffd\ufffd\ufffd0\ufffd\ufffd\ufffdLbtx\ufffd0\ufffddeH\u0012\ufffd?\ufffdk\ufffd\ufffd23\u0018Z<S!\ufffd\ufffdpJ(ab\ufffd,&2`\b\ufffd\ufffd\ufffd\ufffd2>\ufffd'\ufffd\ufffd\ufffd\ufffd\ufffdZ\u0010sDJ_\ufffd|0\ufffd \ufffd\ufffd\u0011\b8\u0019\ufffd\ufffd\ufffd\ufffd\ufffd|\ufffd\ufffdq?\ufffd/\ufffd_\ufffdCB\ufffd\ufffdRdV\u000f\ufffdi\b\n \u0001\u0001\ufffd 4\ufffd\u0004\u000e.\bD    \ufffd\ufffd\b\u0018xNZQnP>AA\ufffd\ufffd\f\ufffd\ufffd\ufffd\ufffd\ufffd\u0007\ufffd\ufffdY\ufffdd=E\ufffd\u076b\ufffd*\ufffd\ufffd4\ufffd\ufffdt\ufffd\ufffd-&d\ufffdF \u0010k\n24}X\ufffd\ufffd\\]\ufffdH`\ufffd9M\ufffd'\u0683\ufffd8\ufffd\u05b3\ufffd\ufffd\ufffd\ufffd\u007f\ufffdf\ufffd\ufffd{>\ufffd\ufffdb.\u000e\u001a\ufffdvP\ufffd\ufffd8\u0010\ufffd7\ufffd\ufffd\ufffd\ufffd\ufffdZ\ufffd\ufffd\ufffd  \ufffd4\\\ufffd\ufffd{\ufffd\ufffd\ufffd4U>\ufffdf\ufffd\ufffd\u070d5a\u0001\u001aA\u0e25tD\ufffd(\ufffd\ufffdQf,\ufffdg\ufffdb\ufffd \ufffd\ufffdRd\ufffd\u000f\ufffdi\b\n \u0001\u0001\ufffd 4\ufffd\u0004\ufffdI\u000e\ufffd\ufffd\ufffd+^\u001d\ufffdj\ufffd\ufffd,\ufffdG3j\ufffdEl\ufffd\ufffd\u001d\ufffdq\ufffdRP\ufffd2\u0012N\ufffdj\b\ufffd\ufffd\ufffd\ufffd:\ufffd\u0004U\ufffd=/E&\ufffd\ufffd(\nSome very large Binary data. Binary data blocks deleted to focus on issue at hand\n\ufffdH\ufffd\ufffd\ufffd9#i\ufffdb.X\ud6a3\u0770\u0326d'\ufffd\ufffd\u0186\ufffd\ufffd\u000e\uf876;\u007fO\ufffd\ufffd\ufffd\u0455\ufffd\ufffd`@$\ufffd\u001bR \u001a\ufffd\u000eSy\ufffdQ^yv\ufffds\ufffd&\ufffd\ufffd\u000ewo\ufffd\ufffd \u0007\u023c[ \ufffdX\ufffd\ufffdv\ufffdydnU$r25\ufffd(\ufffde\u001a\b\u00f7mh\"\ufffdx\ufffd\ufffdU\ufffd\ufffd\ufffd\ufffdRd\u074f\u00111\u0013\u0701\ufffdA\ufffd%\ufffd;\ufffd\u0019%9\u0004LKr\u0007\ufffd\ufffd\ufffd\ufffd\ufffd\u4549,~\ufffdSg\ufffd\ufffdP\ufffd2\ufffd\ufffd\ufffdb\ufffd\ufffd #k\ufffdln\ufffd\ufffd\ufffd\ufffd.u\ufffd\ufffdG-S\ufffd\ufffdU\ufffd\u06a7#:\u0005tv\ufffd\u000f\ufffd\u0017\ufffd!\ucda4\ufffd\u0015\u0004\u0006\ufffd\ufffdW\u0080hf\u0004\fE\ufffd%\u001b3\ufffdpx\u0011\ufffd\u0017h!W|\ufffdo\u0005\ufffd\ufffd]\ufffd\ufffd\u07af\ufffd\u007fG\ufffd]\ufffd\u000e)3\ufffd\ufffdj\ufffd^\ufffdDP\u0015yi\ufffd\ufffd&\ufffd\ufffd*\u0014\ufffdQ\u000e\ufffd\u0019e\u001e\ufffd+\ufffd\u000f\ufffd\ufffd#\ufffdYp\ufffdaXcn)B\u001c\ufffd,P\ufffd.\u0012\ufffd\ufffd\u000f\u0016\ufffddO\ufffd\n\ufffd\ufffdRd\ufffd\f\u0011\ufffd\u0012\ufffd\b1\ufffd(\ufffd\ufffd\u0019eK\ufffd\ufffd]rG\ufffd\ufffd\ufffd\u000em\ufffd\u01d5(:\ufffd\ufffdp\ufffd\ufffd\ufffdY\u06f5v\ufffd\u001f\ufffdGF\ufffdA$\ufffd\ufffdR\u0016\ufffd\bU\ufffd\ufffd\ufffd[\ufffd\b\ufffd\ufffd\ufffd\ufffd\u001ac\ufffdC\ufffdv8[\ufffd{\ufffd=\ufffdX'\uc0a2\u000b\ufffdE\u0001\u000f\ufffdO\ufffd\ufffd\ufffd\ufffd\u06c0\ufffda\ufffd\ufffd)\u0010    \ufffd*b\ufffdJ]\u0013CMD\ufffd\ufffd\ufffd\u0014Bn\u0006\ufffd\ufffd\ufffdwift\ufffdz\u0400\u001f`\ufffdz(r;G\ufffd\u014a,'\u000b\ufffd\ufffd_\ufffd+\ufffd\ufffdU[\ufffd\ufffd\u001b\ufffd,Q\ufffd\ufffd\ufffd') in TestController.php line 313\nat TestController->doResumableUpload(object(Google_Client)) in TestController.php line 253\nat TestController->getTestUploadResumable(object(Request)) in TestController.php line 239\nat TestController->getHandleGoogleOauthcallback(object(Request))\nat call_user_func_array(array(object(TestController), 'getHandleGoogleOauthcallback'), array(object(Request))) in compiled.php line 8832\nat Controller->callAction('getHandleGoogleOauthcallback', array(object(Request))) in compiled.php line 8901\nat ControllerDispatcher->call(object(TestController), object(Route), 'getHandleGoogleOauthcallback') in compiled.php line 8881\nat ControllerDispatcher->Illuminate\\Routing\\{closure}(object(Request))\nat call_user_func(object(Closure), object(Request)) in compiled.php line 9538\nat Pipeline->Illuminate\\Pipeline\\{closure}(object(Request))\nat call_user_func(object(Closure), object(Request)) in compiled.php line 9520\nat Pipeline->then(object(Closure)) in compiled.php line 8882\nat ControllerDispatcher->callWithinStack(object(TestController), object(Route), object(Request), 'getHandleGoogleOauthcallback') in compiled.php line 8867\nat ControllerDispatcher->dispatch(object(Route), object(Request), 'TestController', 'getHandleGoogleOauthcallback') in compiled.php line 7842\nat Route->runWithCustomDispatcher(object(Request)) in compiled.php line 7813\nat Route->run(object(Request)) in compiled.php line 7466\nat Router->Illuminate\\Routing\\{closure}(object(Request))\nat call_user_func(object(Closure), object(Request)) in compiled.php line 9538\nat Pipeline->Illuminate\\Pipeline\\{closure}(object(Request))\nat call_user_func(object(Closure), object(Request)) in compiled.php line 9520\nat Pipeline->then(object(Closure)) in compiled.php line 7467\nat Router->runRouteWithinStack(object(Route), object(Request)) in compiled.php line 7455\nat Router->dispatchToRoute(object(Request)) in compiled.php line 7440\nat Router->dispatch(object(Request)) in compiled.php line 2066\nat Kernel->Illuminate\\Foundation\\Http\\{closure}(object(Request))\nat call_user_func(object(Closure), object(Request)) in compiled.php line 9538\nat Pipeline->Illuminate\\Pipeline\\{closure}(object(Request)) in Cors.php line 25\nat Cors->handle(object(Request), object(Closure))\nat call_user_func_array(array(object(Cors), 'handle'), array(object(Request), object(Closure))) in compiled.php line 9530\nat Pipeline->Illuminate\\Pipeline\\{closure}(object(Request)) in compiled.php line 12785\nat ShareErrorsFromSession->handle(object(Request), object(Closure))\nat call_user_func_array(array(object(ShareErrorsFromSession), 'handle'), array(object(Request), object(Closure))) in compiled.php line 9530\nat Pipeline->Illuminate\\Pipeline\\{closure}(object(Request)) in compiled.php line 11434\nat StartSession->handle(object(Request), object(Closure))\nat call_user_func_array(array(object(StartSession), 'handle'), array(object(Request), object(Closure))) in compiled.php line 9530\nat Pipeline->Illuminate\\Pipeline\\{closure}(object(Request)) in compiled.php line 12523\nat AddQueuedCookiesToResponse->handle(object(Request), object(Closure))\nat call_user_func_array(array(object(AddQueuedCookiesToResponse), 'handle'), array(object(Request), object(Closure))) in compiled.php line 9530\nat Pipeline->Illuminate\\Pipeline\\{closure}(object(Request)) in compiled.php line 12462\nat EncryptCookies->handle(object(Request), object(Closure))\nat call_user_func_array(array(object(EncryptCookies), 'handle'), array(object(Request), object(Closure))) in compiled.php line 9530\nat Pipeline->Illuminate\\Pipeline\\{closure}(object(Request)) in compiled.php line 2687\nat CheckForMaintenanceMode->handle(object(Request), object(Closure))\nat call_user_func_array(array(object(CheckForMaintenanceMode), 'handle'), array(object(Request), object(Closure))) in compiled.php line 9530\nat Pipeline->Illuminate\\Pipeline\\{closure}(object(Request))\nat call_user_func(object(Closure), object(Request)) in compiled.php line 9520\nat Pipeline->then(object(Closure)) in compiled.php line 2013\nat Kernel->sendRequestThroughRouter(object(Request)) in compiled.php line 1999\nat Kernel->handle(object(Request)) in index.php line 53\n\n\n\n\n. Hi Matt,\n\nIf the issue is resolved in the later/newer versions of the Google API PHP\nclient library (ver 1.1.6+) then please close this issue. I haven't tested\nver 2.0+ of the php client library.\n\nOn Tue, Jan 9, 2018 at 12:00 AM, Matt Whisenhunt \nwrote:\n\n> @josedsilva  Are you still looking for a\n> solution to this issue?\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> ,\n> or mute the thread\n> \n> .\n>\n.",
    "nicolasbadia": "It indeed seem that switching to RC3 fixes the issue.\n. ",
    "funivan": "+1 \n. ",
    "gourlaa": "Thanks for your answer.\nI suspect there is also a problem for iOS & Android with this redirect_uri : urn:ietf:wg:oauth:2.0:oob, or urn:ietf:wg:oauth:2.0:oob:auto ?\nDocs : https://developers.google.com/identity/protocols/OAuth2InstalledApp\nHave a great day.\n. ",
    "coveralls": "\nChanges Unknown when pulling 36617a83b4027d072cdd8bce144616ee8df037d3 on net-tools:patch-1 into  on google:master.\n. ",
    "mtricht": "@bshaffer When will you manually run the script to update all the APIs? I don't really wanna fork and apply the changes myself. I'm using a lot of the services provided here.\n. Full version of code:\n```\n$googleClient = new Google_Client();\n$googleClient->setAuthConfigFile('doubleClick.json');\n$googleClient->addScope([\n    'https://www.googleapis.com/auth/dfareporting',\n    'https://www.googleapis.com/auth/dfatrafficking',\n    'https://www.googleapis.com/auth/userinfo.email',\n]);\n$googleClient->setRedirectUri('http://myredirecturl.com');\n$googleClient->setAccessType('offline');\n$googleClient->setApprovalPrompt('force');\n$googleClient->setAccessToken(array(\n    'access_token' => 'myAccessToken',\n    'expires_in' => 3600,\n    'created' => strtotime('2016-03-04 XX:XX:XX') - 3600\n));\n$url = 'https://www.googleapis.com/dfareporting/v2.4/reports/39164646/files/220870887?alt=media';\n$httpClient = $googleClient->authorize();\n$request = new GuzzleHttp\\Message\\Request('GET', $url);\n$httpClient->send($request);\n```\nThe access token is valid as I'm able to call endpoints of the DCM/DFA API.\nI checked if the ScopedAccessTokenSubscriber is attached to the GuzzleClient and it is (as the unit test is also asserting), however the onBefore method is never called. What could be the cause of this?\nEDIT: Yep, was doing it wrong. Correct way for guzzle 5.3 is:\n$url = 'https://www.googleapis.com/dfareporting/v2.4/reports/39164646/files/220870887?alt=media';\n$httpClient = $googleClient->authorize();\n$httpClient->get($url);\nThe event emitter is only transmitted to either the HTTP client or request, never both. Couldn't find this in guzzle's documentation, so took quite some time to figure this out.\n. ",
    "levieraf": "Following the documentation, they say that you must create a request without body then, after to retrieve the upload_id using the class Google_Http_MediaFileUpload you start passing all the RAW instead of only the attachments.\nraw.txt\n```\nMIME-Version: 1.0\nReceived: by 10.192.167.220 with HTTP; Sun, 1 Apr 2018 17:47:43 -0700 (PDT)\nDate: Sun, 1 Apr 2018 19:47:43 -0500\nMessage-ID: CAKRR12qweXg@mail.gmail.com\nSubject: subject_body\nFrom: Foobar From foobar_from@gmail.com\nTo: Foobar To foobar_to@gmail.com\nContent-Type: multipart/mixed; boundary=\"001a11406f8c08bfa20568d2f0b6\"\n--001a11406f8c08bfa20568d2f0b6\nContent-Type: text/plain; charset=\"UTF-8\"\nbody\n--001a11406f8c08bfa20568d2f0b6\nContent-Type: image/png; name=\"my_image.png\"\nContent-Disposition: attachment; filename=\"my_image.png\"\nContent-Transfer-Encoding: base64\nX-Attachment-Id: f_jfhimck00\niVBORw0KGgoAAAANSUhEUgAAAVIAAAFaCAYAAABMhtWCAAAMFWlDQ1BJQ0MgUHJvZmlsZQAASImV\nVwdYU8kWnltSCAktEAEpoTdBepXei4B0sBGSQEKJkBBU7MqigmsXUazoqoiiawFkURFRLCwC9vpQ\nRGVlXSxgQeVNCuj62vfO903unzPnnPnPuefONwOAsi0rNzcbVQEgR5AvjAn2YyYlpzBJTwACUKAA\nrIAWiy3K9Y2OjgBQRp9/l6Fb0BrKdWtJrH+d/6+iyuGK2AAg0RCncUTsHIhPAIBrsnOF+QAQ2qDe\naHZ+rgQPQKwuhAQBIOISnCHDmhKcJsMTpDZxMf4Q+wBAprJYwgwAlCS8mQXsDBhHScLRVsDhCyDe\nBrEXm8fiQPwA4gk5ObMgViZDbJ72XZyMv8VMG4vJYmWMYVkuUiEH8EW52ay5/2c5/rfkZItH1zCE\n.\n.\n.\n.\n6kVyHxyn0Prk001HppTrJ9SC7pNeB3+7vvxilig0PIqw31HMf+mRl3UaO03kSCufaCPCpWlOYpPL\n0u8y0X/Ko++O0k8wV61alRcNfjP7JIqEtC/+N4qkbIST1g+5c0wjqZK1PmatONGRSSy4AAMnu+D3\nj3wfm/XDNs8rXrQiGyK29SJ00snLKkJNhSEmtPslWAPU18LGN5hOdJ7u4f8H5v3LO301ZZIAAAAA\nSUVORK5CYII=\n--001a11406f8c08bfa20568d2f0b6--\n```\nsend_email.php\n```\n$msg = new \\Google_Service_Gmail_Mesage();\n// ****\n// Important to start the process\n$msg->setRaw(''); \n$this->client->setDefer(true); \n$request = $this->service->users_messages->send('me', $msg, array('uploadType' => 'resumable'));\n// ****\n$chunkSizeBytes = 1 * 1024 * 1024;\n$media = new  \\Google_Http_MediaFileUpload(\n    $this->client,\n    $request,\n    'message/rfc822',\n    null,\n    true,\n    $chunkSizeBytes\n);\n$media->setFileSize($attachmentSize);\n$status = false;\n// --> and this is the part that documentation does not mention!!! \n// the maximum of this Raw-Message should not be more than 35MB\n// On summary: \n// headers + body message + attachments = 35 MB\n$handle = fopen('raw.txt', \"rb\"); \nwhile (!$status && !feof($handle)) {\n    $chunk = fread($handle, $chunkSizeBytes);\n    $status = $media->nextChunk($chunk);\n}\n$result = false;\nif($status != false) {\n    $result = $status;\n}\nfclose($handle);\n$this->client->setDefer(false);\n// get message id :)\nprint $result->getId();\n```\nThe key here is prepare the raw text with all the attachments, having each one on base64\nOther important thing is that according to the documentation you only can upload a media until 35MB.\nhttps://developers.google.com/gmail/api/v1/reference/users/messages/send\nOther important thing as well to finish my comments, for simple upload which is 5MB, only in that case you must pass the raw as base64 in that case.\n```\ntry {\n    $send_data= rtrim(strtr(base64_encode($raw), '+/', '-_'), '=');\n    $message = new \\Google_Service_Gmail_Mesage();\n    $message->setRaw($send_data);\n$message = $service->users_messages->send($userId, $message);\nprint 'Message with ID: ' . $message->getId() . ' sent.';\nreturn $message;\n\n} catch (Exception $e) {\n    print 'An error occurred: ' . $e->getMessage();\n}\n```\nGood luck! :)\n. Hi guys this is what I do to upload files to drive, this works great for me, take what you need and go ahead:\n```\n$file = new \\Google_Service_Drive_DriveFile($options);\n$file->title = $data['file_name'];\n$chunkSizeBytes = 100 * 1024 * 1024; // 100 MB\n// Call the API with the media upload, defer so it doesn't immediately return.\n$client->setDefer(true);\n$request = $service->files->create($file, [ 'uploadType' => 'resumable', 'fields' => 'id' ]);\n// Create a media file upload to represent our upload process.\n$media = new \\Google_Http_MediaFileUpload(\n    $client,\n    $request,\n    mime_content_type($data['filepath']),\n    null,\n    true,\n    $chunkSizeBytes\n);\n$media->setFileSize(filesize($data['filepath']));\n$media->setChunkSize($chunkSizeBytes);\n$status = false;\n$handle = fopen($data['filepath'], \"rb\");\nwhile(!$status && !feof($handle)){\n    $chunk = fread($handle, $chunkSizeBytes);\n    $status = $media->nextChunk($chunk);\n}\n$result = false;\nif($status != false){\n    $result = $status;\n}\nfclose($handle);\n// Reset to the client to execute requests immediately in the future.\n$client->setDefer(false);\nprint is_object($result) && isset($result->id) ? $result->id : false;\n```. @kocoten1992 and how did you fix it? I mean how did you resolve upload the document in the end?\n. @kocoten1992 ohhh nice! well, remember to bring me a coffee xD! . ",
    "huebs": "One more note about the security of this implementation: it's impossible to grant any permissions to world.  I can't think of any valid reasons for needing that ability.\n. I foresee two problems with using hashed usernames as directory names for namespacing.\n- CLI cache cleaners will be unable to remove files created by the web interface.\n- The web interface will not be able to read files created by a CLI cache warmer.\nWhen creating my pull request, my first inclination was to follow the pattern used by Symfony's HttpCache:\n``` php\n    /\n     * Save data for the given key.\n     \n     * @param string $key  The store key\n     * @param string $data The data to store\n     \n     * @return bool\n     */\n    private function save($key, $data)\n    {\n        $path = $this->getPath($key);\n        if (!is_dir(dirname($path)) && false === @mkdir(dirname($path), 0777, true) && !is_dir(dirname($path))) {\n            return false;\n        }\n    $tmpFile = tempnam(dirname($path), basename($path));\n    if (false === $fp = @fopen($tmpFile, 'wb')) {\n        return false;\n    }\n    @fwrite($fp, $data);\n    @fclose($fp);\n\n    if ($data != file_get_contents($tmpFile)) {\n        return false;\n    }\n\n    if (false === @rename($tmpFile, $path)) {\n        return false;\n    }\n\n    @chmod($path, 0666 & ~umask());\n}\n\n```\nThe same pattern of using php's built-in umask() function is also used by the CacheWarmer.  I went with a $umask variable rather than a call to umask() because I wanted to maintain the library's existing default functionality (directories created with 700 permissions, files saved with 600 permissions).\nIn the spirit of following standard practices, I've surveyed the current cache implementations of a few PHP frameworks.\nThe cache implementation (seen above) for Symfony, my framework of choice, creates directories with 777 permissions and there isn't an easy way to customize the behavior.  On the other hand, file permissions can be customized because they are calculated using the default umask: 0666 & ~umask().  The ClassLoader creates directories and files using the same logic (as do the ResourceCheckerConfigCache, ContainerBuilderDebugDumpPass, and CompilerDebugDumpPass).\nI also looked at Doctrine, Symfony's companion ORM framework, which includes a FileLockRegion cache that creates directories with 775 permissions by default and files with 664 permissions -- neither is easily customizable.\nNext, I looked at the Laravel framework. The FileStore creates directories with 777 permissions using the Filesystem::makeDirectory() method and can't be easily customized, whereas files are created with system default permissions using the Filesystem:put() method (which simply calls file_put_contents() without a subsequent call to chmod()).\nLastly, I looked at the CakePHP framework. The cache's FileEngine creates directories with 775 permissions with no easy method of customization.  Meanwhile, files are created with permission which are controlled by a configurable mask variable which defaults to 0664.\nMy 2\u00a2: If the goal is to adhere to standard practices, I'd either use the Symfony (777 for directories, 0666 & ~umask() for files) or Laravel (777 for directories, no change to files) method.\n. Making bots happy. :smiley:\n. At the very least, the directory permissions need to be relaxed. As this is currently implemented, if the first user to call this function creates any directory defined in the base path (e.g. the default google-api-php-client directory), all other users would be unable to create their cache directories because they wouldn't have read or write permissions to the base directory. The same goes for the hash prefix directories.\n. @bshaffer, I see it's already merged but, to answer your question, it looks good to me. Thanks for taking the time to work through this issue (same to @tmatsuo).\n. @tmatsuo, as I mentioned in #817:\n\nI foresee two problems with using hashed usernames as directory names for namespacing.\n- CLI cache cleaners will be unable to remove files created by the web interface.\n- The web interface will not be able to read files created by a CLI cache warmer.\n. This test case can be removed as it now just duplicates the previous one.\n. That doesn't address the problem of the base directory's permissions.  You could solve this by also changing:\n\nphp\nif (!mkdir($storageDir, 0700, true)) {\nto\nphp\nif (!(mkdir($this->path, 0777, true) && mkdir($storageDir, 0700, true))) {\n. ",
    "smurfxx": "Thank you very much for the example, I downloaded a wong version of Google API PHP Library, now I downloaded the one that doesn't need composer and infact everything is ok!\nNow I can go on and develop my web application, thank you very much!\n. ",
    "ajcerqueti": "Confirm this is also happening with Gmail API as well. For me, it's caching the last successful user to send an email, and subsequent calls are trying delegate to that user, as the client is retaining that user. Can't find which cache it could be though, I've cleared apc cache etc.\nCan't revert to RC3 because other core dependencies require a newer version of Guzzle. Stuck.\n. As a workaround, delete the contents of /tmp/google-api-php-client before you create a client. There was a file (/tmp/google-api-php-client/d4/d41d8cd98f00b204e9800998ecf8427e) with the old access code, which is where it's being cached by the client.\nI can understand why it's doing this, but it should probably check when a new access token is set, or there should be some functionality to clear the cache. Happy to implement and make a pull request if someone can suggest what the preferred solution is.\n. ",
    "donriga": "Yes, how to fix? Bug?\nProblem in version google/apiclient:^2.0.0@RC\nVersion \"google/apiclient\": \"1.0.*@beta\" is worked correct.\n. Waiting to fix))\n. ",
    "thilanga": "I signed it!\n. ",
    "mseshachalam": "Nope, Why do we need to set developerkey if we are using service account's json credentials ? \nSomeone replied on google product forums regarding this. I was using sites add API to add an page URL not a domain name. I was adding something like, http://example.com/blog/2016-02-18-hello but the api is intended to use to add the domain name like http://example.com/ . \nAm I wrong ?\n. ",
    "YuanXiong": "On my server, the system time is 2 min prior to the current time so I got this problem. The system admin may have to run the ntp service for date updates.\n. ",
    "jslewis90": "Mine shows 5 hours later than what what the Google Token returns, even using the latest version.\n. ",
    "martinfrith": "Now is impossible to set leeway outside vendor. Please rollback this fix.. @bshaffer thank you for considering my suggestion. Cheers. . ",
    "hamzawain7": "In google-api-php-client/src/Google/AccessToken/Verify.php line 213 you are not adding 1 to JWT leeway like you mentioned in the comments but rather setting it to 1. Kindly fix it.\n`\nif (property_exists($jwtClass, 'leeway')) {\n            // adds 1 second to JWT leeway\n            // @see https://github.com/google/google-api-php-client/issues/827\n            $jwtClass::$leeway = 1;\n        }\n`. ",
    "dyegonery": "This solution didn't worked with me. So, I tried adding 60 seconds to JWT leeway:\nif (property_exists($jwtClass, 'leeway')) {\n// adds 1 second to JWT leeway\n// @see #827\n$jwtClass::$leeway += 60;\n}\n. ",
    "FG-Developer": "Hello,\nI have that same problem me too, The problem is solving when i changing $leeway variable value as \"+=60\", but i do not want change in core file of package. But i don't find any way overwrite this variable on another place.\nThere is any way changing that variable another place?\nI'm using 2.1.2 version on laravel as package.. ",
    "bestdna": "Thank you for your reply.\nThere was problem with my network.\nAnd it was solved clearly.\n:)\n. ",
    "ericnorris": "Hey @bshaffer, thanks for the response! I am aware of the functions, but the point I was trying to make was that if you want to write v1 code that can be upgradeable to v2, using Google_Client::loadServiceAccountJson would mean you would have issues later on.\nBoth v1 and v2 have the Google_Client::setAuthConfig function, so if the v1 version was updated to work with the new-style JSON config you'd have no troubles dropping in v2 when you were able to upgrade. If you used a separate function (Google_Client::loadServiceAccountJson) you would need to remember to change this usage when you were able to upgrade.\nI realize v1 is deprecated but it does seem that it is still being updated (v1.1.7 was released 7 days ago and v1.1.6 was just a few short months ago). Backporting would be really helpful to those who are unable to upgrade a major version yet, but would like to in the future.\n. ",
    "ArtemGordinsky": "Hi,\nPretty sure the errors in our case weren't intermittent at all \u2013 100% of the requests failed for three days straight. Fortunately, it seems to have been finally fixed yesterday, so I'll go ahead and close this issue.\n. ",
    "sarasad": "hii , \ni'm having the same problem , how did u slove it please \nhelp. Thank youu , \ni did that but still not working :( . Thank you so much for replying \nbut still same problem :( \nthis is the msg i gt exactly  : \nFatal error: Uncaught exception 'GuzzleHttp\\Exception\\RequestException' with message 'cURL error 60: SSL certificate problem: unable to get local issuer certificate (see http://curl.haxx.se/libcurl/c/libcurl-errors.html)' in C:\\xampp\\htdocs\\api-samples-master\\php\\vendor\\guzzlehttp\\guzzle\\src\\Handler\\CurlFactory.php:188 Stack trace: #0 C:\\xampp\\htdocs\\api-samples-master\\php\\vendor\\guzzlehttp\\guzzle\\src\\Handler\\CurlFactory.php(151): GuzzleHttp\\Handler\\CurlFactory::createRejection(Object(GuzzleHttp\\Handler\\EasyHandle), Array) #1 C:\\xampp\\htdocs\\api-samples-master\\php\\vendor\\guzzlehttp\\guzzle\\src\\Handler\\CurlFactory.php(104): GuzzleHttp\\Handler\\CurlFactory::finishError(Object(GuzzleHttp\\Handler\\CurlHandler), Object(GuzzleHttp\\Handler\\EasyHandle), Object(GuzzleHttp\\Handler\\CurlFactory)) #2 C:\\xampp\\htdocs\\api-samples-master\\php\\vendor\\guzzlehttp\\guzzle\\src\\Handler\\CurlHandler.php(43): GuzzleHttp\\Handler\\CurlFactory::finish(Object(GuzzleHttp\\Handler\\CurlHandler), Object(GuzzleHttp\\Handler\\EasyHandle), Object(GuzzleHttp\\Handler\\ in C:\\xampp\\htdocs\\api-samples-master\\php\\vendor\\guzzlehttp\\guzzle\\src\\Handler\\CurlFactory.php on line 188. ",
    "aingelc12ell": "Looks like this problem occurs from a local location (like your workstation). \nHad the same problem.\nHowever, when I uploaded and ran it on my webserver, it works.\nSame thing, I'd like to know how to resolve it, running from my machine.. ",
    "cylosh": "put 'verify' => false. ",
    "df257": "I have same problem! Can you tell me how solve it? @amitsadana444 \ncurl.cainfo = \"xxx\\cacert.pem\" it not work\nI modify php.ini  in xxx/apache/bin. \n. @bshaffer It not work, problems still exist. My environment is wampserver2.5, win32. php.ini is in apache/bin. \nAdd this code: $client->setHttpClient(new GuzzleHttp\\Client(['verify' => false]));\nSomething is difference.....\n\n. Problem solved. ",
    "ATXcoder": "I have WAMP running on my Windows box and was able to solve this issue following @bshaffer instructions but with some minor adjustments. One thing to keep in mind at least if you are running WAMP (not sure if the same applies to LAMP) is that WAMP may be using two different versions of PHP (for me it was version 5 & 7). It uses version 5 for the command line and version 7 for web apps. Here's how I fixed mine:\n\n\nPlacing the cacert.perm from https://curl.haxx.se/ca/cacert.pem in the correct folder. In my case it was \"C:\\wamp\\bin\\php\\php5.6.19\\extras\\ssl\". \n\n\nModify php.ini, found in folder \"C:\\Wamp\\bin\\php\\php5.6.19\".  Find the following section\n;;;;;;;;;;;;;;;;;;;;\n; php.ini Options  ;\n;;;;;;;;;;;;;;;;;;;;\nand add the following line to that section (modify the folder path to match where you placed the cacert.pem file): \ncurl.cainfo = \"C:\\wamp\\bin\\php\\php5.6.19\\extras\\ssl\\cacert.pem\" \n\n\nSave the file\n\n\nRestart PHP (I just click in the WAMP icon in the system tray and click on \"Restart All Services\"\n\n\nYou should then be able to run the Google Calendar API Quickstart example.. ",
    "Stankim": "Thank you  bshaffer. Worked for me. Using xampp in windows. ",
    "Hujjat": "@ATXcoder did not work on wamp. I still get the same errors. . ",
    "basitmakine": "@bshaffer Adding cacert.pem did the trick for me on XAMPP Windows. Thanks!. ",
    "sstankov": "See how this guy fixed it: https://translate.google.bg/translate?hl=en&sl=ja&u=https://qiita.com/kd9951/items/c5d2add24afe861ebe2e&prev=search. ",
    "abdul202": "i have another apprrocahe it works for me\nopen vendor\\guzzlehttp\\guzzle\\src\\Handler\\CurlFactory.php\nand change thsi\n```\n$conf[CURLOPT_SSL_VERIFYHOST] = 2;\n                $conf[CURLOPT_SSL_VERIFYPEER] = true;\n```\nto this\n$conf[CURLOPT_SSL_VERIFYHOST] = 0;\n                $conf[CURLOPT_SSL_VERIFYPEER] = FALSE;\nit's a temporary solution if you upated this file the changes will lost. ",
    "Mohd-Hasan": "thanks @abdul202 it is working. ",
    "brsvrgn": "thanks @abdul202 also worked for me.. ",
    "TomixChiu": "\n\nSave the following to cacert.pem: https://curl.haxx.se/ca/cacert.pem\nput it here:\nC:\\xampp\\php\\extras\\ssl\\cacert.pem\n\n\nin your php.ini put this line in this section:\n  ```\n  ;;;;;;;;;;;;;;;;;;;;\n  ; php.ini Options  ;\n  ;;;;;;;;;;;;;;;;;;;;\n\ncurl.cainfo = \"C:\\xampp\\php\\extras\\ssl\\cacert.pem\"\n  ```\n* restart your webserver/apache\n\nI follw your steps, and solve this problem, thanks!. ",
    "Sauron22": "I just download   .zip and put the folder  on my project on htdocs in loclalhost using xampp, i have the same error \nphp\nsession_start();\n\n<p//Include Google client library \nrequire_once 'google-api-php-client-2.0.0-RC5/vendor/autoload.php';\n//include_once 'vendor/Google_Oauth2Service.php';\n/\n * Configuration and setup Google API\n /\n$clientId = 'InsertGoogleClientID';\n$clientSecret = 'InsertGoogleClientSecret';\n$redirectURL = 'http://localhost/school/index2.php';\n//Call Google API\n$gClient = new Google_Client();\n$gClient->setApplicationName('Login to CodexWorld.com');\n$gClient->setClientId($clientId);\n$gClient->setClientSecret($clientSecret);\n$gClient->setRedirectUri($redirectURL);\n$google_oauthV2 =  new Google_Oauth2Service;\n?>\nthat was my Code\nwhat im doing wrong ? . ",
    "hamiderremli": "I have the same pb. I've tried with composer and download alternatively the zip without any impact... always the error: ... Fatal error: Uncaught Error: Class 'Google_Oauth2Service' not found in .... ",
    "kunit": "Test script(test.php) owner 'develop'.\n```\nrequire_once '/path/to/your-project/vendor/autoload.php';\numask(0);\n$cache = new Google_Cache_File(DIR . '/test');\n$cache->set('test', '123');\n```\nTest script use original Google_Cache_File run, raise error.\nThis error is same name directory create, because get_current_user() returns same value 'develop'.\ndevelop% sudo php test.php\ndevelop% php test.php\nPHP Warning:  mkdir(): Permission denied in /path/to/your-project/src/Google/Cache/File.php on line 176\n. remove the exception, change log-level.\n. ",
    "JustinBeckwith": "LGTM\n. @bshaffer what are the next steps with this one?. Do we have a sample of this one?  Seems like a nice thing to add :). @mattwhisenhunt perhaps an opportunity for another sample?. This issue was moved to GoogleCloudPlatform/google-cloud-php#1084. Greetings folks!  So as it would turn out, this is available in this library!\nhttps://github.com/google/google-api-php-client-services/tree/master/src/Google/Service/Texttospeech\nWe just need a sample on how to use it. . Greetings!  We'd love to help, but we need more information.  If you can post your code...  we'd be happy to help!. Looks like this one is answered!  Please do let us know if you run into any more problems.. Let's use this issue to resolve #1399 :)  Just say \"Fixes #1399\" in the description to auto-close the issue!. @chingor13 @bshaffer @dwsupplee would one of you mind giving this a one over?. @dwsupplee I'm still trying to get the yoshi-php group figured out :(. Thank you for checking this out @dwsupplee :)  \n@mattwhisenhunt If there is an existing place for the same code on github, I'm in favor of using that sample code and directing the user there.  Please modify the README in the examples directory to call out to the stuff in the YouTube repo \ud83d\udc4d \n. Nice!  Can we add unit/regression test coverage here though?. Greetings! No, the project isn't dead :)  We are spending a lot of time over in https://github.com/GoogleCloudPlatform/google-cloud-php these days, but you should start to see more work in this repo in the coming weeks.  . Greetings! We'd be happy to help out, answer questions, and even fix bugs. I am however, going to have to ask you to monitor your language :) We're all humans here who would love to help, but please keep things respectful. We're working on getting a code of conduct in all of our repositories, but for now let this one be your guide. Thanks!. Greetings!  We'd be happy to help out, answer questions, and even fix bugs.  I am however, going to have to ask you to monitor your language :)  We're all humans here who would love to help, but please keep things respectful.  We're working on getting a code of conduct in all of our repositories, but for now let this one be your guide.  Thanks!. ",
    "tristanbailey": "Thank you so much for posting this any your code work @am63. I set up a new server and composer bumped googleapi from version 1.1.6 to 1.1.7 and it broke any second pages to try and get an access_token from the refresh_token. So I would agree with you the access_token is valid for the first setup with user interaction, but the second time we call it \"offline\" in a cron job the refresh_token will not create a access_token and we get invalid_grant error from the api. \nSo at least the 2 days of trying to debug what I had broken in the code can be a new task to update the code for this updated package.\n. @bshaffer I saw you PR, is this fix for the v2.* branch or should it also work for the 1.1.* one?\nWe have not move to v2 as its still marked RC.\n. @bshaffer Thanks for sharing, and fixing the mentioned issue. I have the same symptoms. Api works fine getting the first token and then does not want to get a second access token when offline.  I will look for steps and repost as a new issue here or on SO.\n. ",
    "xdanik": "Damm it...\nComposer has downloaded old release...\nI have \"google/apiclient\": \"^1.1\"\nAny idea about way to force him to install newest branch?\nBecause I am getting \"Nothing to install or update\" and if I run \"composer require google/apiclient:^2.0.0@RC\" i get \"The requested package google/apiclient could not be found in any version\"\n. For me it is now working fine out of the box...\nI just have to change my code because accessToken is now Array (insted of JSON string)\n. Yeap.. I already figured it out.\nFor me is version 2.0-RC5 working OK out of the box without any modifications.\nBut am63 is still having some issues...\n. ",
    "recipe": "+1\n. You have to upgrade php version on the server.\n. ",
    "daniroyo": "Agree\n. ",
    "PurpleBooth": "I signed it as Purple Booth Ltd\n. Looks like this is actually from #463. As this is a generated library this won't fix it.\n. ",
    "armetiz": "Hi @bshaffer \nYou right, getErrors is available. But it simply return an array of un-typed array.\nRight now,\nI have a dedicated GoogleErrorsDecoder that is constructed with the result of Google_Service_Exception::getErrors. \nAn helper function hasError allow me to easily check the kind of error that is throw from GoogleAPI.\nWhat I'm trying to say.\nI can't use the try/catch with the exception matching system.\n``` php\ntry {\n  $this->subscribeToPushNotification($memberId);\n}\ncatch (\\Google_Service_Exception $e) {\n  $errors = $e->getErrors();\n$webHookUrlUnauthorized = false;\n  foreach($errors as $error) {\n    if(isset($error[\"reason\"]) && $error[\"reason\"] === \"push.webhookUrlUnauthorized\") {\n      $webHookUrlUnauthorized = true;\n    }\n  }\nif(!$webHookUrlUnauthorized) {\n    throw $e;\n  }\n}\n```\nThe above example is very complex to read..\nphp\ntry {\n  $this->subscribeToPushNotification($memberId);\n}\ncatch (\\Google_WebHook_Url_Unauthorized $e) {\n}\nThe above is very simple to read..\nRegards.\n. ",
    "flaveris": "Hey guys,\nthank you for the fix. But it's still not working for me. I use GuzzleHttp 5 (can't use version 6 because my other dependencies).\nAttempted to load class \"Response\" from namespace \"Psr\\Http\\Message\".\nDid you forget a \"use\" statement for e.g. \"GuzzleHttp\\Message\\Response\", \"DZunke\\SlackBundle\\Slack\\Client\\Response\", \"Buzz\\Message\\Response\", \"Symfony\\Component\\BrowserKit\\Response\", \"Symfony\\Component\\HttpFoundation\\Response\" or \"GuzzleHttp\\Psr7\\Response\"?\n500 Internal Server Error - ClassNotFoundException (Symfony 2.7 framework)\nin vendor\\google\\apiclient\\src\\Google\\Http\\REST.php at line 84\nAnd I cannot see any Response class in Psr\\Http\\Message.\nDo you have any thoughts on this?\n. @bshaffer Thanks for a quick fix!\n. ",
    "aaronlague": "Do you have an exact working example of how to insert new events on google calendar using google-api-php-client. I've been trying to figure out how it would work step by step none from the documentation helped. I am missing that part after authentication how do I display the events from the calendar - I followed the setup instructions - I can now authenticate, the only remaining thing is to display events\nThanks in advance\n. I've been referring to this post from Stack Overflow\nhttp://stackoverflow.com/questions/18690653/create-simple-google-calendar-event-in-php\nlike I said I can only authenticate but not really adding to the calendar itself - am i missing something?\n. Hi good day,\nI have a question, is it possible to modify the expiry of the access_token?  or of the session itself? or at least when the session expires,  redirect or create a status message.\nSorry for barging in to this thread, it just so happen that I am having trouble with keeping the session for a longer time for the google api\nthanks\n. ",
    "Fneufneu": "I signed it!\n. Okey, i mean now in v3, files.get return only few settings and the object is almost empty: no filesize, md5, etc ... \nit miss properties and i can't a proper way to get it\n. ",
    "lptn": "Hey @konrados \nPossibly you use invalid filters. Try to use a valid relative URL for ga:pagePath (with leading slash) . ",
    "themags-company": "O.k. solved that my self, at least the p12 wrong encoding.\nExporting the key from: https://console.developers.google.com/permissions/serviceaccounts?project=_ on Windows does not work, you should use Linux some other distribution.\nExporting the key from such, did the work for me... that's kind of strange behavior, I think at least there should be a warning message, stating you SHOULD use another operating system, instead developers waste days in debugging that...\nThanks in advance for the \"FAST\" response also.\nNot happy from really happy from your support.\nKind regards\n. ",
    "amit-extreme": "```php\n  // Create and configure a new client object.\n        $client = new \\Google_Client();\n        $client->setApplicationName(\"{application name}\");\n        $analytics = new \\Google_Service_Analytics($client);\n        $cred = new \\Google_Auth_AssertionCredentials(\n            $service_account_email,\n            array(\\Google_Service_Analytics::ANALYTICS_READONLY),\n              \"{your private_key}\"\n        );   \n        $client->setAssertionCredentials($cred);\n        if($client->getAuth()->isAccessTokenExpired()) {\n            $client->getAuth()->refreshTokenWithAssertion($cred);\n        }\n        $optParams = [\n            'dimensions' => 'ga:date',\n            'sort'=>'-ga:date'\n        ] ;       \n    $results = $analytics->data_ga->get(\n       'ga:{View ID}',\n       $date_from,\n       $date_to,\n       'ga:sessions,ga:users,ga:pageviews,ga:bounceRate,ga:hits,ga:avgSessionDuration',\n       $optParams\n       );\n\n        $rows = $results->getRows();\n        $rows_re_align = [] ;\n        foreach($rows as $key=>$row) {\n            foreach($row as $k=>$d) {\n                $rows_re_align[$k][$key] = $d ;\n            }\n        }           \n        $optParams = array(\n                    'dimensions' => 'rt:medium'\n            );\n        try {\n          $results1 = $analytics->data_realtime->get(\n              'ga:{View ID}',\n              'rt:activeUsers',\n              $optParams);\n          // Success. \n        } catch (apiServiceException $e) {\n          // Handle API service exceptions.\n          $error = $e->getMessage();\n        }\n        $active_users = $results1->totalsForAllResults ;\n        return [\n            'data'=> $rows_re_align ,\n            'summary'=>$results->getTotalsForAllResults(),\n            'active_users'=>$active_users['rt:activeUsers']\n            ] ;\n\n```\nUnfortunately I get error from Google_Auth_Exception\nUnable to parse the p12 file. Is this a .p12 file? Is the password correct? OpenSSL error: error:0D06B08E:asn1 encoding routines:ASN1_D2I_READ_BIO:not enough data\nplease give solution. ",
    "jdpedrie": "As @bshaffer mentioned above, p12 credentials files are deprecated. Are you able to replace them with a json credentials file?. If you don't want to use composer, you can download one of the releases from the releases page. (Choose one of the .zip files such as google-api-php-client-2.1.1.zip.)\nThose will still have all the required dependencies though. The only difference is that the composer install piece is done for you.. @vipkhongtin please open a new issue and provide additional information: What API are you accessing? Also please include a list of steps and a small snippet of sample code that can be used to reproduce the problem.. @vijay-qlogic any update?. I'm on the fence here. This would change behavior, which in a legacy library such as this is dangerous, but I do see how one would expect that it would clear the queue after sending.\nHowever, there are existing (and simple) workarounds, chiefly simply calling $service->createBatch() again to create a new, clean batch.\nPerhaps improved documentation is a better solution here.\n@bshaffer @dwsupplee any thoughts?. Hi @jpcodeforit,\nThe stackoverflow link you provided is 404. Looks like it was removed (hopefully because you solved the problem! :smile:). If you're still having issues, please update this issue with more detail and reopen it.. Hi @levansonqs,\nSorry you're having trouble. To help though, we need more information. Can you share the code you're using to construct the Google API client, and the code which is raising the error? Be sure to redact any private information from code you share.. Hi @ankitdeveloper,\nThe answer given by Chris in the ruby issue also applies to us. As the discovery document does not provide the attributes you're looking for, we cannot add support to this library. You may be able to accomplish your goals using the Google_Service_ShoppingContent_OrderLineItemReturnInfo::setPolicyUrl() method.. Certainly! You can communicate with the team responsible for the Shopping Content API here.. Try replacing $message->getSnippet() with the following:\nphp\n$body = base64_decode($message->getPayload()->getParts()[0]->getBody()->getData());. You could use the value of $message->getThreadId() to call Users.threads.get, then search the list of messages for the reply you need.. Hi @pragneshrupapara,\nUnfortunately, this forum is more intended to resolve bugs and specific support requests related to the Google API PHP Client. The answers I've given you thus far were obtained by studying the Gmail API reference documentation. I'd suggest taking some time to read and understand the underlying API. If you have questions regarding implementation details, we suggest searching https://stackoverflow.com/questions/tagged/gmail-api, and if your question has not yet been answered, posting for assistance.\nThat said, should you run into problems which are specific to this client, please ask and we'll continue to attempt to assist you.\nedit: This question on Stackoverflow may provide some specific guidance you would find useful.. Hi @zh7314,\nDo calls to other Google APIs succeed? Are you sure it's specifically related to the Docs API rather than a client or application server misconfiguration?\nIf you've verified that the problem is specific to Docs, we are unfortunately not well positioned to assist with API problems. The team suggests using Stackoverflow for technical assistance and monitors questions asked using the google-docs-api tag. You can also review the How To Get Help page on the Google Docs API support site.. Please feel free to update and reopen if you are still having issues and have not had any luck with the support channels I shared.. Thanks for the report @crtl. I've opened #1592 to fix this.. Hi @rubenperezpro,\nUnfortunately, without additional information it's hard to assist much. Have you checked to see if the slow connection times are specific to Google services? Perhaps try making an HTTP call to another service and comparing. If both are slow, you'll need to debug the reasons why your server is having trouble getting a decent connection.\nThis forum is for issues specifically related to the API client. We're certainly happy to help however we can, but before we can, we need to know whether the problems you're having are related to a problem with the API client.. @rubenperezpro have you checked your server logs to see if there are any issues which may not be immediately apparent?. You can accomplish this in a manner similar to the other language examples you shared by using middlewares:\n```php\nuse GuzzleHttp\\Client;\nuse GuzzleHttp\\Psr7\\Uri;\nuse GuzzleHttp\\Middleware;\nuse GuzzleHttp\\HandlerStack;\nuse GuzzleHttp\\Handler\\CurlHandler;\n// Set this value to the country you want.\n$countryCode = 'DE';\n$client = new Google_Client();\n$client->setApplicationName(\"My_Project\");\n$client->setDeveloperKey( $google_books_api_key );\n$service = new Google_Service_Books($client);\n$optParams = [];\n$handler = new CurlHandler;\n$stack = HandlerStack::create($handler);\n$stack->push(Middleware::mapRequest(function ($request) use ($countryCode) {\n    $request = $request->withUri(Uri::withQueryValue(\n        $request->getUri(),\n        'country',\n        $countryCode\n    ));\nreturn $request;\n\n}));\n$guzzle = new Client([\n    'handler' => $stack\n]);\n$client->setHttpClient($guzzle);\n$results = $service->volumes->listVolumes($terms, $optParams);\n```\nMiddleware is a set of functions which are used to modify requests and responses. This example adds a request middleware, which prior to dispatching the request, will add country=$countryCode to the URI query string.\nThis example is simplified to some extent, and you'll need to work on it a bit. The big issue is that this middleware will add the country code to every request sent from this instance of Google_Client. I suggest adding additional logic to limit the modification to this request only.. Sure, thanks for the heads up.. This generally indicates an issue with your server. Have you replicated the issue in another environment (i.e. locally, or on another server in a different location)?. Please provide additional information as to what the expected outcome is, and what is actually happening. A code snippet without context doesn't give us enough data to assist.. ",
    "limonte": "I signed it!\n. There's an issue in CI build, I need some help:\n\n. Thank @bshaffer for the explanation. I think I'm fixing my error in wrong place.\nThis might be the right place: https://github.com/laravel/socialite/pull/135\n. ",
    "himmerman": "Do you have access to user data on your credentials?\nI think the call should be something like  this\n$webmastersService = new Google_Service_Webmasters($this->client);\n$webmastersService->urlcrawlerrorscounts->query($url, $category, $latestCountsOnly, $platform);. Search console sites and site data is considered user data and cannot be accessed by service accounts. You have to make an Oauth 2 interface and save the token to a file and use that token in your app. Make sure the app refreshes the token when it expires:\nphp\nif ($client->isAccessTokenExpired()) {\n    $client->refreshToken($this->token['refresh_token']);\n    $token = $client->getAccessToken(); // save this to a file\n}\n. that is not the right service object for search console.\n$search_console = new Google_Service_Webmasters($client);\nwhile making the client object be sure to add the correct scope:\nclient->addScope('https://www.googleapis.com/auth/webmasters');. ",
    "chiragvels": "Hello,\n@mattwhisenhunt Never received the clarifying questions.\nCan you please let me know what the questions about?\n@himmerman Thanks for reply, Not able to post the answer. Yes, I have Used same way as mentioned by you to get counts, but unfortunately not able to post at that time.\n$webmastersService = new Google_Service_Webmasters($client);\n$urlcrawlerrorscounts = $webmastersService->urlcrawlerrorscounts;\n$urlcrawlerrorscounts = $urlcrawlerrorscounts->query($url);\nThanks,\n. @mattwhisenhunt No, I am not able to reproduce same issue.\nI am closing down this thread.. I have asked for the Google Webmaster Tools API and not Custom Search.\nThanks\nOn Fri, 30 Nov 2018 at 11:54 PM, Matt Whisenhunt notifications@github.com\nwrote:\n\nThis library might actually be overkill for Google Custom Search API. Using\nREST to Invoke the API\nhttps://developers.google.com/custom-search/v1/using_rest is a great\nguide to get started with the API. Just json_decode the results of\nfile_get_contents to the URL in the request example:\n<?php$key = 'YOUR_KEY_HERE';$query = 'https://www.googleapis.com/customsearch/v1?q=lectures&cx=017576662512468239146:omuauf_lfve&key='. $key;$res = json_decode(file_get_contents($query));foreach ($res->queries->nextPage as $page) {    print_r($page);}\nIf you really want to use this library and are unsure how with an API that\nonly requires an API key, check out the Google Books example\nhttps://github.com/googleapis/google-api-php-client/blob/master/examples/simple-query.php\nand adapt it to the Custom Search service. The API Explorer\nhttps://developers.google.com/apis-explorer/#p/customsearch/v1/search.cse.list\nmay help.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/googleapis/google-api-php-client/issues/1559#issuecomment-443294040,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAEjEvRGLhq1jysv09AQwSs7cDGeVW_Jks5u0XfFgaJpZM4Y7APp\n.\n. Okay Matt,\n\nThanks for the answer. Actually one of doc page mentions that you need to\nuse nextPageToken to realise optimisation done.\nThanks\nOn Sat, 1 Dec 2018 at 6:45 AM, Matt Whisenhunt notifications@github.com\nwrote:\n\nI'm sorry about that. I must have read your question too quickly.\nTo answer your question, no that API does not specify any method with a\nnextPageToken property.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/googleapis/google-api-php-client/issues/1559#issuecomment-443386025,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAEjEkcw0wItsX7CncR2XPpVSHDdWzS2ks5u0dgxgaJpZM4Y7APp\n.\n. \n",
    "nickyoung87": "Hey thanks for the response. We did end up figuring out the issue was deep within our code and were able to get it working how we need.\n. ",
    "chaegumi": "Hi @bshaffer ,\nPHP7\nand\nMy composer.json file:\n``` php\n{\n    \"require\": {\n        \"slim/slim\": \"^3.4\",\n        \"monolog/monolog\": \"^1.20\",\n        \"slim/php-view\": \"^2.1\",\n        \"facebook/php-sdk-v4\": \"^5.2\",\n        \"google/apiclient\": \"^2.0\"\n    }\n}\n```\nI do like below:\n``` php\n$client = new Google_Client();\n// $client->setAssertionCredentials($credentials);\n$scopes = [Google_Service_Plus::PLUS_ME, Google_Service_PlusDomains::PLUS_STREAM_WRITE];\n\n$client->setAuthConfig('../My Project-d2d94d5f2479.json');\n$client->setApplicationName('My Project');\n$client->setScopes($scopes);\n// if($client->getAuth()->isAccessTokenExpired()){\n    // $client->getAuth()->refreshTokenWithAssertion();\n// }\n// $client->useDefaultApplicationCredentials();\n\n$plus = new Google_Service_Plus($client);\n\n// $plusdomains = new Google_Service_PlusDomains($client);\n\n// var_dump($plusdomains);\n// $result = $plusdomains->activities->insert('me', array(\n    // 'object' => array(\n        // 'originalContent' => 'Happy Monday!'\n    // ),\n    // 'access' => array(\n        // 'items' => array(\n            // array('type' => 'domain')\n        // ),\n        // 'domainRestricted' => TRUE\n    // )\n// ));\n\n$result = $plus->people->get('me');\n\n$response->getBody()->write(var_export($result, true));\n\nreturn $response;\n\n```\nBut It don't return expected value\n``` php\nGoogle_Service_Plus_Person::__set_state(array(\n   'collection_key' => 'urls',\n   'aboutMe' => NULL,\n   'ageRangeType' => 'Google_Service_Plus_PersonAgeRange',\n   'ageRangeDataType' => '',\n   'birthday' => NULL,\n   'braggingRights' => NULL,\n   'circledByCount' => 0,\n   'coverType' => 'Google_Service_Plus_PersonCover',\n   'coverDataType' => '',\n   'currentLocation' => NULL,\n   'displayName' => '',\n   'domain' => NULL,\n   'emailsType' => 'Google_Service_Plus_PersonEmails',\n   'emailsDataType' => 'array',\n   'etag' => '\"xw0en60W6-NurXn4VBU-CMjSPEw/0uxhj8-IvPqkPEvO9g0YNortZTk\"',\n   'gender' => NULL,\n   'id' => '101422423155895591717',\n   'imageType' => 'Google_Service_Plus_PersonImage',\n   'imageDataType' => '',\n   'isPlusUser' => false,\n   'kind' => 'plus#person',\n   'language' => NULL,\n   'nameType' => 'Google_Service_Plus_PersonName',\n   'nameDataType' => '',\n   'nickname' => NULL,\n   'objectType' => 'person',\n   'occupation' => NULL,\n   'organizationsType' => 'Google_Service_Plus_PersonOrganizations',\n   'organizationsDataType' => 'array',\n   'placesLivedType' => 'Google_Service_Plus_PersonPlacesLived',\n   'placesLivedDataType' => 'array',\n   'plusOneCount' => NULL,\n   'relationshipStatus' => NULL,\n   'skills' => NULL,\n   'tagline' => NULL,\n   'url' => NULL,\n   'urlsType' => 'Google_Service_Plus_PersonUrls',\n   'urlsDataType' => 'array',\n   'verified' => false,\n   'internal_gapi_mappings' => \n  array (\n  ),\n   'modelData' => \n  array (\n    'name' => \n    array (\n      'familyName' => '',\n      'givenName' => '',\n    ),\n    'image' => \n    array (\n      'url' => 'https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=50',\n      'isDefault' => true,\n    ),\n  ),\n   'processed' => \n  array (\n  ),\n))\n```\nThanks.\n. Hi @bshaffer ,\nSo hardly to use service account\n``` php\n$result = $plus->people->get($userID);\n// return my account info\n$result = $plusdomains->activities->insert($userID, $activity);\n// 403 Forbidden\n```\nI test this method https://developers.google.com/identity/protocols/OAuth2ServiceAccount\nreturn message:\n``` json\n{\n  \"error\": \"invalid_grant\",\n  \"error_description\": \"Invalid JWT: Failed audience check. The right audience is https://www.googleapis.com/oauth2/v4/token?grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer&assertion=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.ew0KCQkiaXNzIiA9PiAiYXV0b3Bvc3RlckBjYXJlZnVsLWNoaW1lcmEtMTM3MDIzLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwNCgkJInNjb3BlIiA9PiAiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9wbHVzLm1lIiwNCgkJImF1ZCIgPT4gImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL29hdXRoMi92NC90b2tlbiIsDQoJCSJleHAiID0-IDE0NjgzODM2NDksDQoJCSJpYXQiID0-IDE0NjgzODE4NDkNCgl9.ZW5jZGRkZGQ\"\n}\n```\nand this method https://developers.google.com/api-client-library/php/auth/service-accounts\nreturn message:\nhttps://github.com/google/google-api-php-client/blob/master/UPGRADING.md#google_auth_assertioncredentials-has-been-removed\nSo i don't know what's the right way to auto post on google plus page use service account.\nIs there have a complete use service account with jwt article?\nThanks.\n. ",
    "jRazer": "Hi! May be this helps - http://www.nextscripts.com/google-plus-automated-posting/ \nBut - only for WordPress\n. ",
    "jqr108": "Getting the same error with version 1.1.6 and \n$scopes = ['https://www.googleapis.com/auth/analytics.readonly'];\n Good to know it's not a version issue at least.\nSeems maybe Google updated their API to disallow top level accounts being impersonated, but I haven't seen that documented anywhere online yet.\nMy Stack Overflow about it here:\nhttp://stackoverflow.com/questions/35923375/impersonated-user-unauthorized-in-google-analytics-api-using-service-account\nAuthorization still works without the $user_to_impersonate, but I need to impersonate our main company account in order to access all our GA accounts.\n. @jmckay56 Thanks dude!\n. @bshaffer How do you go about reauthorizing an impersonated user? \n. @bshaffer Thanks bshaffer, that did it!\nCouple notes for anyone else with this issue that follows Option Two above:\n$client->fetchAccessTokenFromAuthCode($code);\nshould be\n$client->fetchAccessTokenWithAuthCode($code);\nand if you're using v1 you'll want to use \n$client->authenticate($code);\n. ",
    "btibor91": "Google probably changed the handling of service accounts and this doesn't work anymore.\n. ",
    "jmckay56": "This was not an issues with the api. but with the google api.  Which has been resolved.\n. Hi \nI am using Using V.2.0.0 RC6 connecting to the Google My Business API\n        $user_to_impersonate = 'uti@gmail.com';\n        $scopes = ['array_of_scopes'];\n$client = new \\Google_Client();\n    $client->setSubject($user_to_impersonate);\n    $client->setAuthConfig('/path/to/service-account.json');\n    $client->setScopes($scopes);\nThis is working for me.\n. ",
    "k0nG": "oh super. Sorry I had a look in the code and I couldn't see that.\nThanks for quick reply.\n. ",
    "cedricziel": "Great, thx!\n. ",
    "dbbk": "I've faced this same issue, and managed to get it working with this Laravel code:\n```\n$client->setTokenCallback(function ($cacheKey, $accessToken) use ($client) {\n            $tokenToSave = Auth::user()->token;\n            $tokenToSave['created'] = time();\n            $tokenToSave['access_token'] = $accessToken;\n        Auth::user()->update(['token' => $tokenToSave]);\n    });\n\n```\nThe problem is because the token callback only returns the access token, the rest of the token is no longer valid, particularly created and id_token. I've had to manually override created to stop the client from thinking it's permanently expired.\nIs there any way of getting the full token back? Currently it appears that I can only get a valid id_token from the initial authorisation - any subsequent (automatic by the client) refreshes invalidated it and I have no way of getting it back.. ",
    "gsi-delmo": "Probably I am missing something here but it was as simple as this when I tested some weeks ago:\n$current_token = read_token_from_db(); //JSON as string\n$client->setAccessToken($current_token);\n//make some operation with Google services... then\n$last_token = $client->getAccessToken();\nif ($last_token != $current_token)\n{\n    write_token_to_db($last_token);\n}\nAccording to my tests $client->getAccessToken() will return the new access token if it was refreshed internally.\nIs this not enough? Am I wrong?\n. ",
    "tcurtin": "I'm getting a similar error, but not sure if its the same cause, and the fix you mention above isn't resolving my issue.\nError calling GET https://www.googleapis.com/admin/directory/v1/groups/groupname%40domain.com/members: (404) Resource Not Found: groupKey\nIn URITemplate.php, changing\n```\n          $value = implode($list_sep, $values);\n          if ($value == '') {\n            return false;\n          }\n```\nto \n```\n          $value = implode($list_sep, $values[1]);\n          if ($value == '') {\n            return false;\n          }\n```\ndoesn't resolve the problem for me - same error.\nI haven't actually tried this call in a while, so I'm not sure the last time it worked properly, but I don't believe it was caused by a change on my end...\nFWIW, the API test also returns the same error \"Resource Not Found: groupKey\":\nhttps://developers.google.com/admin-sdk/directory/v1/reference/members/list#try-it\n. ",
    "andreityuhai": "I also had the same issue.\nYou're probably passing groupKey within optional parameters array. listMembers method is expecting groupKey to be first parameter and optParams array - as second parameter.\nProper request should look like:\n```php\nputenv(\"GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account.json\");\n$client = new Google_Client();\n$client->useApplicationDefaultCredentials();\n//@param $account - service account email\n$client->setSubject($account);\n$client->addScope(Google_Service_Directory::ADMIN_DIRECTORY_GROUP);\n$service = new Google_Service_Directory($client);\n//@param $directory_group_id - Google directory group id\n$groupKey = $directory_group_id;\n$optParams = array(\n  'maxResults' => 1000\n);\n$results = $service->members->listMembers($groupKey, $optParams);\n$members = $results->getMembers();\nif (count($members) == 0) {\n  //...\n}\nelse {\n  foreach ($members as $member) {\n    //...\n  }\n}\n```. ",
    "redayoub": "Up\n. Any help please.\n. up\n. ",
    "JBerkvens": "include_once \"google-api-php-client/vendor/autoload.php\";\n$private_key_file = '/location/to/secret.json';\n$scopes = array('https://www.googleapis.com/auth/admin.directory.group', 'https://www.googleapis.com/auth/admin.directory.group.member', 'https://www.googleapis.com/auth/admin.directory.user');\n$client = new Google_Client();\nputenv('GOOGLE_APPLICATION_CREDENTIALS='.$private_key_file);\n$client->useApplicationDefaultCredentials();\n$client->setScopes($scopes);\n$service = new Google_Service_Directory($client); //Here I get the error.\n$results = $service->members->listMembers('mailing@list.com', array())->getMembers();\nprint_r($results);\n. ",
    "DHANDAPANISATTANATHAN": "In Stack overflow already asked this, They replied, I m waiting when officially will deliver this\nhttp://stackoverflow.com/questions/35864527/download-csv-file-using-google-drive-v3v2-works-perfect-throws-error-403/36290123#36290123\n. Hi,\nAny updates. Plz reply!\n. Hi,\nAny updates why LIBVER = 2.1.2 still in VER 2.1.3?. ",
    "danielmirchandani": "I realize now that the rest of the classes are in the global namespace, so \"ExpiredException\" is the only class that needs an additional \"use\" statement.\n. This was solved with pull-request #919.\n. I've updated the pull request based on your comments.\n. ",
    "waprin": "lgtm\n. ",
    "viction": "The most recent composer update seemed to fix my issue... Google_Utils_UriTemplate auto loads as expected now.  Sorry I don't have more insight.\n. @bshaffer, I wanted to follow-up with my definitive solution.  \nEverything was working in my test/stage/production environments, but my dev continued to have issues with the auto_include without the explicit require hack I outlined originally.\nI discovered that somewhere along the way, the UriTemplate.php file was named/renamed URITemplate.php -- therefore, the autocomplete had issues finding the file because of case discrepancy even though the class name was correct in that file.\nNot sure why composer didn't update/fine/fix the file name? - regardless, now works as expected in all my environments.\n. ",
    "hkirsman": "Ok, it's available in apiclient-services so instead of (in composer.json):\n{\n    \"require\": {\n        \"google/apiclient\": \"^2.0.0@RC\"\n    }\n}\nI do this:\n{\n    \"require\": {\n        \"google/apiclient\": \"2.0.0-RC7\",\n        \"google/apiclient-services\": \"@dev\"\n    }\n}\n. Pretty sure it didn't. But I'll recheck.\n. If I remove it from composer.json then I get:\n```\n\u21d2  composer update\nYou are running composer with xdebug enabled. This has a major impact on runtime performance. See https://getcomposer.org/xdebug\nLoading composer repositories with package information\nUpdating dependencies (including require-dev)\nYour requirements could not be resolved to an installable set of packages.\nProblem 1\n    - Installation request for google/apiclient 2.0.0-RC7 -> satisfiable by google/apiclient[v2.0.0-RC7].\n    - google/apiclient v2.0.0-RC7 requires google/apiclient-services *@dev -> no matching package found.\nPotential causes:\n - A typo in the package name\n - The package is not available in a stable-enough version according to your minimum-stability setting\n   see https://getcomposer.org/doc/04-schema.md#minimum-stability for more details.\nRead https://getcomposer.org/doc/articles/troubleshooting.md for further common problems.\n```\nI'm trying both:\n```\n{\n    \"require\": {\n        \"google/apiclient\": \"2.0.0-RC7\"\n    }\n}\n```\nand\n```\n{\n\"require\": {\n    \"google/apiclient\": \"^2.0.0@RC\"\n}\n\n}\n```\nBut latter doesn't include the setStartRow() probably because it can't find apiclient-services.\n. This works! Thank you very much!\n. ",
    "cyphix333": "I just downloaded it via GitHub via the download zip option. When I navigate to that directory on GitHub you will see the YouTube file isn't there.\nI will try those other options - thanks!\n. Ok, I just downloaded it via the releases page and there is still no YouTube.php file in the Services directory. :(\nThe project I am working on atm doesn't use Composer, but I will use that option somehow if nothing else works.\n. Ahhhh, my bad, I was looking in the src directory.\nDo I need all the files/folders from that directory?\nThanks for your help!\n. Great, thanks!\n. ",
    "guizput": "Ok I found it in the Master V1 branch.\n. ",
    "khurramar": "@guizput should you combine the files from v1 branch into the master branch?\n. I can't even discover Google/Service/YouTube.php at all in api. That leads all example php files with error at 2nd require_once  \n\nrequire_once(Google/Service/YouTube.php): failed to open stream\n\nNothing found about it...\n. ",
    "Eldair": "Hello,\nOkey, this is how I get the results (response)\nphp\n$response = $mcf->get(\n            'ga:'.$request->profile,\n            $start,\n            $end,\n            'mcf:assistedConversions',\n            [\n                'dimensions' => 'mcf:source',\n                'sort' => '-mcf:assistedConversions',\n                'max-results' => '10'\n            ]\n        );\nwhich works fine and returns results.\nBut I have to do\n$report = $response->toSimpleObject();\nin order to be able to itterate over the results, otherwise it won't work because data is not properly set inside metadata property of Google_Service_Analytics_McfDataRows class.\n. Hi @mattwhisenhunt sorry for not responding earlier, it has been year and a half since I posted the issue.\nEach results row is an instance of Google_Service_Analytics_McfDataRows but all methods (getConversionPathValue, getPrimitiveValue) return either null or []\nWhen I try to iterate over one row I get Undefined offset: 1 {\"exception\":\"[object] (ErrorException(code: 0): Undefined offset: 1 at /home/vagrant/Code/app/vendor/google/apiclient/src/Google/Collection.php:95). ",
    "radzserg": "Actually was able to do that. But it doesn't looks good. Have to override functions. \n``` php\n $service = new Google_Service_Drive($client);\n$client = $service->getClient();\n$client->setDefer(true);\n$request = $service->files->get($googleDriveId, ['alt' => 'media']);\n$http = $client->authorize();\ntry {\n            $httpHandler = Google\\Auth\\HttpHandler\\HttpHandlerFactory::build($client);\n            $response = $httpHandler($request, [\n                'progress' => function($downloadTotalSize, $downloadedSize, $uploadTotalSize, $uploadedSize) {\n                    // do all work here\n                }\n            ]);\n        } catch (GuzzleHttp\\Exception\\RequestException $e) {\n            // if Guzzle throws an exception, catch it and handle the response\n            if (!$e->hasResponse()) {\n                throw $e;\n            }\n        $response = $e->getResponse();\n    }\n\n    return Google_Http_REST::decodeHttpResponse($response, $request, 'Google_Service_Drive_DriveFile');\n\n```\nThere's no way to pass extra params look at \n``` php\n// Google_Http_REST::doExecute \ntry {\n      $httpHandler = HttpHandlerFactory::build($client);\n      $response = $httpHandler($request, / I need to pass options here /);\n```\n. ",
    "xorexore": "Same problem here.\nI tried to use:\n$client->setAuthConfig('client_secret.json');\nBut then I got these notices (and it isn't working either):\n```\nPHP Notice:  Undefined index: client_secret in google-api-php-client/vendor/google/apiclient/src/Google/Client.php on line 862\nNotice: Undefined index: client_secret in google-api-php-client/vendor/google/apiclient/src/Google/Client.php on line 862\n```\n. I've updated to latest version of composer and still doesn't work.\n. ",
    "JayPHP": "@xorexore It turns out I was downloading the wrong client secret. You have to download the client secret for the service not the client account.\n. ",
    "ShailendraPrSingh": "from where to download to download the client secret for the service ?. ",
    "wickywills": "\n@xorexore It turns out I was downloading the wrong client secret. You have to download the client secret for the service not the client account.\n\nI'm having the same error here, but I don't understand this answer. I only have one download link on the Credentials section, and that is to the right, under the heading of \"OAuth 2.0 client IDs\". I downloaded the only file I could on the page as a JSON file, but still get the same error.. ",
    "ramsesdelr": "This worked for me, on the Account Services page I click on Furnish a new private key, this key will generate a JSON file that will contain the type field. You can check the steps here. ",
    "enumag": "Signed.\n. ",
    "sumitdnit": "error message is: \"Undefined property: Google_Service_YouTube::$commentThreads\" .\nI found \"public $commentThreads & public $comments\" is not in \"Youtube.php\" file in below path \"vendor\\google\\apiclient\\src\\Google\\Service\"\n. ",
    "mcohoon": "I signed it!\n. ",
    "DenisOgr": "@bshaffer thanx. it helped me.\n. ",
    "devnix": "I have this same issue. I've granted domain-wide delegation but it still does not work.\n``` php\n<?php\n    $client = new \\Google_Client();\n    $client->useApplicationDefaultCredentials();\n//$client->setAuthConfig(CLIENT_SECRET_PATH);\n\n$client->useApplicationDefaultCredentials();\n$client->setSubject('info@mytestdomain.es');     // Actually I'm using an email from a verified domain\n\n$client->addScope(\\Google_Service_Drive::DRIVE);\n\n// Your redirect URI can be any registered URI, but in this example\n// we redirect back to this same page\n$redirect_uri = 'http://' . $_SERVER['HTTP_HOST'] . $_SERVER['PHP_SELF'];\n$client->setRedirectUri($redirect_uri);\n\nif (isset($_GET['code'])) {\n  $token = $client->fetchAccessTokenWithAuthCode($_GET['code']);\n  $client->setAccessToken($token);\n}\n\n$service = new \\Google_Service_Drive($client);\n\n$file = new \\Google_Service_Drive_DriveFile();\n$result = $service->files->create(\n    $file,\n    array(\n      'data' => file_get_contents(_TEST_FILE_),\n      'mimeType' => 'application/octet-stream',\n      'uploadType' => 'media'\n    )\n);\n\n```\nThe exceptions seems to be throwed from the $result = $service->files->create( line.\n. ",
    "Sajgoniarz": "Same problem, but with Calendar API. It occurs in Kohana framework solution and deployed locally. Version at test server and pure-php localhost solution works ok. Error rise until i remove impersonation line. . ",
    "paulcanning": "In fact, I just added the following to the Google_Client() config and the error has gone.\n\n$client->setClassConfig('Google_Http_Request', 'disable_gzip', true);\n\nCould it be my WAMP install is lacking GZIP? I cannot seem to find any mention of it in the Apache or PHP settings.\n. So, no way other then using command line? \n. Do you know of any way what-so-ever to do this via PHP?\n. ",
    "giwrgos88": "yes the calendars\n. @Behunin is working with your way, thanks a lot\n. From where I will get the $attendeeId value?\n. It is working thanks a lot for your help\n. ",
    "PsychodelEKS": "Played around with this myself - the problem is with\n`Google_Http_Request::toBatchString (Http/Request.php)\nit uses http_build_query to rebuild url with query string for report and breaks the url, because some parameters which are specified as arrays must not be treated as array when building url, i.e.:\n$params = array(\n'metrics' => array('metr_1', 'metr_2'),\n'dimensions' => array('dim_1', 'dim_2'),\n)\nare converted to:\nmetric%5B0%5D=metr_1&metric%5B1%5D=metr_2&dimensions%5B0%5D=dim_1&dimensions%5B1%5D=dim_2\nand must be:\nmetric=metr_1&metric=metr_2&dimensions=dim_1&dimensions=dim_2\nthat is handled correctly for non-batch requests with Google_Http_REST::createRequestUri,\nbut this method uses modified parameters array which is not stored for later usage in request itself\nthe easy way to fix this seems to use prebuilt url from the request and to remove server addr from it:\n$path = str_replace('https://www.googleapis.com', '', $this->getUrl()); but not sure if totally conforms all the requirements (works fine for me)\n$path = preg_replace('/(dimension|metric)%5B\\d+?%5D/im', '$1', $path); is more fool-proof, but still not of production quality\n. @mattwhisenhunt \nI did not actually update the lib since the issue was created, so dunno if it was fixed or not.\nSince Google seems to migrate to DFP API now, we've moved to it from this one, so for me - not an issue anymore =). ",
    "nickrussell": "@bshaffer, it'd be great to provide clarity on including the Sheets.php services, as the documentation outlined in https://developers.google.com/sheets/quickstart/php explains that everything is provided as part of the composer install:\nphp composer.phar require google/apiclient:1.*\nThis does not include Sheets.php as part of the Google api package. Is there potentially a more curent google/apiclient:version that should be specified to include this?\nUpdate\nI ended up creating a Service.php file in google-api-php-client/src/Google/Service/Sheets.php and copied the contents of Sheets.php to it. I updated /vendor/composer/autoload_classmap.php line 3562 with:\n'Google_Service_Sheets' => $vendorDir . '/google/apiclient/src/Google/Service/Sheets.php',\nThis resolved the issue for me.\n@bshaffer still very interested in your feedback.\n. ",
    "dadrados": "I'm with @nickrussell. \n. ",
    "rhysemmerson": "Yep I had an old version Stash in my composer.json\n. ",
    "vincentwongso": "Ok, I think I know what might be the issue. It's not with google-php-api-client but with the dependency that is google-oauth (https://github.com/google/google-auth-library-php). It doesn't support guzzlehttp/psr7 1.3 yet it only supports the 1.2. So the one that needs to be upgraded is the google-oauth.\n. ",
    "ekupershlak": "LGTM\n. ",
    "bencromwell": "I see what you mean - at first I thought you meant the package in general now I see you meant that specific version. \nComposer update does indeed work: \n- Removing guzzlehttp/psr7 (1.3.0)\n- Installing guzzlehttp/psr7 (1.2.3)\n  Downloading: 100%  \nCan only assume judging by semver that any implementation using these deps (older version) is missing backwards compatible fixes.\nThanks for opening the PR :+1: \n. ",
    "arafathussein": "any solution for this issue?. ",
    "anmolio": "@bshaffer  : Still facing the same issue ! What to do ?. ",
    "mediatomcat": "Did you ever find a solution?. The composer file is the same one in this git.  I am basically downloading the git and running the composer require file.   I have tried adding the \"google/apiclient:^2.0\" directly to the composer file, but you still get the same error.. ",
    "AlecHFerguson": "I'm confused as to why this PR was declined.  I ran into a breaking API change between minor versions of your package; a bug that can be prevented by the exact changes proposed here.\nBundler, npm, and most other dependency managers recommend committing the lockfile, and Composer is no exception:\nhttps://getcomposer.org/doc/01-basic-usage.md#composer-lock-the-lock-file\nThe justification is simple: 3rd party packages change, so don't let those breaking changes creep into your project.  The solution you're proposing requires that users of the Google API Client have knowledge of your package's dependencies, a prospect that seems to undermine the case for using libraries.\n. ",
    "AwesomeBobX64": "That is not true. I don't believe you understand the semantic versioning specification that your package versions imply. Please check out semver.org and reconsider our pull requests.\nSent from my iPhone\n\nOn Jul 14, 2016, at 10:38 AM, Brent Shaffer notifications@github.com wrote:\n@AlecHFerguson If this library included a composer.lock file, it would not have any affect in your project. Instead, your library should include a composer.lock file to lock these dependencies.\nThe downstream google/apiclient-services repository has 100+ APIs which are often updated. They do not follow semantic versioning, which makes it impossible to provide both the flexibility to update to the latest version and the guarantee that updating won't break your code.\nThe current implementation allows you to lock the downstream google/apiclient-services dependency to a version if you need to, or get the latest APIs when desired.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub, or mute the thread.\n. 1. That composer.lock file WILL lock the consumers of this package to only download the dependency versions identified in the composer.lock file. That is the purpose of including the composer.lock file in version control.\n2. If your dependencies aren't stable, lock down to stable versions via the composer.lock file. v0.3 vs v0.2 completely changed the interfaces of the classes and is a breaking change. This is why it is important to lock down these dependency versions.\n\nAn update in the auth package caused our dependency on the google/apiclient to fail because even though we had locked into 2.0.0 of the google/apiclient package, it's dependency on the google/auth package was loose enough that even though my code hadn't changed, the dependency code HAD and I was encountering bugs from the now updated google/auth package.\nThe dependencies should be locked down in a composer.lock file because of problems like these. When you have tested new versions of your dependencies still work with your package, then release a new version of your package with an updated composer.lock file which locks in which dependencies were tested to work with the new version of your package.\nThis is not an uncommon practice with mature, versioned package development processes.\nPlease reconsider.\n. Okay then, rather than committing the composer.lock file can you fix the linking of the dependencies in the composer.json and to follow the semantic versioning specifications so that bugs aren't introduced when a dependency increases in a minor version?\nJust installing v2.0.0 of the google/apiclient package on two different days of the same week resulted in breaking changes due to the loose coupling of different versions of the dependencies.\nBinding to @dev is too lose and allowed breaking changes between v0.2 and v0.3 to make the library unusable. It should not be the responsibility of every consumer of the package to handle the introduction of breaking changes when installing the same version of the package.\n. ",
    "techiemon": "Thanks!  I believe the v1-master branch worked, it certainly installs fine.  It's a existing project so laravel 5.2 is to much of a leap. \n. ",
    "madebyrogal": "Yes, I tried, and it worked, but empty string like this '' delete value, but I wanted to skip value.\n. ",
    "biakaveron": "\n@madebyrogal have you tried using Google_Model::NULL_VALUE?\n\nworks, thank you!\n. ",
    "dareks84": "I signed it\n. Hello, thanks for answer,\ni using PHP 5.5.9\nI found issue, its problem print_r and <pre>, if using var_dump() all ok.\n. ",
    "seliver": "this is happening because the documentation is outdated. check here: https://stackoverflow.com/questions/39792859/google-oauth-2-0-with-service-account-with-php-invalid-token-format-error\nyou only need this in the getClient method: \n```\nfunction getClient() {\n    $client = new Google_Client();\n    $client->setAuthConfig('private_key.json');\n    $client->setApplicationName('theName');\n    $client->setScopes(Google_Service_Sheets::SPREADSHEETS_READONLY);\n    return $client;\n}\n```. ",
    "imadtoubal": "I had this same issue before, go to this directory:\nC:\\Users\\<your-name>\\.credentials and you find a file that starts by sheets.googleapis.com (or something of this sort). Delete that file and try again.\nThis worked for me, i hope it solves your issue as well :). ",
    "saifrehman15": "I have the same issue but above solution not working for me . \nFatal error: Uncaught InvalidArgumentException: invalid json token in E:\\xampp\\htdocs\\php-oauth2-example\\vendor\\google\\apiclient\\src\\Google\\Client.php:430 Stack trace: #0 E:\\xampp\\htdocs\\php-oauth2-example\\index.php(71): Google_Client->setAccessToken(NULL) #1 E:\\xampp\\htdocs\\php-oauth2-example\\index.php(95): getClient() #2 {main} thrown in E:\\xampp\\htdocs\\php-oauth2-example\\vendor\\google\\apiclient\\src\\Google\\Client.php on line 430\n. ",
    "orvice": "@bshaffer \nHi,  \n$httpClient = new GuzzleHttp\\Client([\n    'proxy' => '127.0.0.1:10245', // since this is what yours is running on\n    'verify' => false, // otherwise HTTPS requests will fail.\n]);\nits still not working, and this proxy is working in my chrome.\n. hi, I am using privoxy to cover a socket proxy to http  proxy,and this http proxy is working in chrome.\nbecause google is blocked in china.\n. ",
    "ashik906": "Hello @bshaffer \nI given full path for credentialsfile\n$credentialsFile = '/var/www/html/example.com/analiytics/client_secrets.json';\n$client->setAuthConfig($credentialsFile);\nThis error genrate\nDeprecated: google-api-php-client's autoloader was moved to vendor/autoload.php in 2.0.0. This redirect will be removed in 2.1. Please adjust your code to use the new location. in /var/www/html/example.com/analiytics/google-api-php-client-2.0.0/src/Google/autoload.php on line 19\nand also every time link redirect to google authentication url after show data\nDeprecated: google-api-php-client's autoloader was moved to vendor/autoload.php in 2.0.0. This redirect will be removed in 2.1. Please adjust your code to use the new location. in /var/www/html/example.com/analiytics/google-api-php-client-2.0.0/src/Google/autoload.php on line 19\nFirst view (profile) found: All Web Site Data\nTotal sessions: 50\nTotal Pageviews: 124\nTotal User: 27\nThankyou\n. Hello @bshaffer,\nwe are using Google Analytics API in PHP project. But when i connect with API it gives error..\nPlease visit this link\nhttp://www.4lifesystem.com/analiytics/analytic.php\nError:\nCatchable fatal error: Argument 3 passed to Google_AuthHandler_Guzzle6AuthHandler::attachCredentials() must be callable, string given, called in /var/www/html/4lifesystem.com/analiytics/google-api-php-client-2.0.0/src/Google/Client.php on line 370 and defined in /var/www/html/4lifesystem.com/analiytics/google-api-php-client-2.0.0/src/Google/AuthHandler/Guzzle6AuthHandler.php on line 30\n\nHere is my code\n\nphp\nerror_reporting(E_ALL);\nini_set('display_errors', 1);\n\n<p// Load the Google API PHP Client Library.\nrequire_once 'google-api-php-client-2.0.0/vendor/autoload.php';\n$analytics = initializeAnalytics();\n$profile = getFirstProfileId($analytics);\n$results = getResults($analytics, $profile);\nprintResults($results);\nfunction initializeAnalytics()\n{\n// Creates and returns the Analytics Reporting service object.\n// Use the developers console and download your service account\n// credentials in JSON format. Place them in this directory or\n// change the key file location if necessary.\n$KEY_FILE_LOCATION = DIR . '/lifesystem-c091337ab43b.json';\n// Create and configure a new client object.\n$client = new Google_Client();\n$client->setApplicationName(\"lifesystem\");\n$client->setAuthConfig($KEY_FILE_LOCATION);\n$client->setScopes('https://www.googleapis.com/auth/analytics.readonly');\n$analytics = new Google_Service_Analytics($client);\nreturn $analytics;\n}\nfunction getFirstProfileId($analytics) {\n// Get the user's first view (profile) ID.\n// Get the list of accounts for the authorized user.\n$accounts = $analytics->management_accounts->listManagementAccounts();\nif (count($accounts->getItems()) > 0) {\n$items = $accounts->getItems();\n$firstAccountId = $items[0]->getId();\n// Get the list of properties for the authorized user.\n$properties = $analytics->management_webproperties\n    ->listManagementWebproperties($firstAccountId);\nif (count($properties->getItems()) > 0) {\n  $items = $properties->getItems();\n  $firstPropertyId = $items[0]->getId();\n// Get the list of views (profiles) for the authorized user.\n  $profiles = $analytics->management_profiles\n      ->listManagementProfiles($firstAccountId, $firstPropertyId);\nif (count($profiles->getItems()) > 0) {\n    $items = $profiles->getItems();\n// Return the first view (profile) ID.\nreturn $items[0]->getId();\n} else {\n    throw new Exception('No views (profiles) found for this user.');\n  }\n} else {\n  throw new Exception('No properties found for this user.');\n}\n} else {\nthrow new Exception('No accounts found for this user.');\n}\n}\nfunction getResults($analytics, $profileId) {\n// Calls the Core Reporting API and queries for the number of sessions\n// for the last seven days.\n$profileId=79768194;\nreturn $analytics->data_ga->get(\n'ga:' . $profileId,\n'7daysAgo',\n'today',\n'ga:sessions');\n}\nfunction printResults($results) {\n// Parses the response from the Core Reporting API and prints\n// the profile name and total sessions.\nif (count($results->getRows()) > 0) {\n// Get the profile name.\n$profileName = $results->getProfileInfo()->getProfileName();\n// Get the entry for the first entry in the first row.\n$rows = $results->getRows();\n$sessions = $rows[0][0];\n// Print the results.\nprint \"First view (profile) found: $profileName\\n\";\nprint \"Total sessions: $sessions\\n\";\n} else {\nprint \"No results found.\\n\";\n}\n}\n. ",
    "nmartin4321": "@bshaffer I ditto the above and even after updating the path to: require_once '/path/to/google-api-php-client/vendor/autoload.php'; while I no longer get \n\nDeprecated: google-api-php-client's autoloader was moved.. >\n\nI still get a set of errors similar to @ashik906 : \n\nFatal error: Uncaught exception 'InvalidArgumentException' with message 'file does not exist' in /var/www/html/example.com/analiytics/google-api-php-client-2.0.0/src/Google/Client.php:839 Stack trace: #0 /var/www/html/example.com/analiytics/google-api-php-client-2.0.0/src/Google/Client.php(824): Google_Client->setAuthConfig('client_secrets....') #1 /var/www/html/example.com/analiytics/index.php(13): Google_Client->setAuthConfigFile('client_secrets....') #2 {main} thrown in /var/www/html/example.com/analiytics/google-api-php-client-2.0.0/src/Google/Client.php on line 839\n. Thanks @bshaffer , apologies I should have set some context.  I followed all instructions here: https://developers.google.com/analytics/devguides/reporting/core/v3/quickstart/web-php\nUsing Windows 7 (IIS 7+ with IIS Express PHP v 7) \nInstalled Composer & verified all dependencies are in place.\n\nIn 'Client.php' the referenced line suggests that there's something wrong with the information being passed for the Auth config:\npublic function setAuthConfig($config)\n  {\n    if (is_string($config)) {\n      if (!file_exists($config)) {\n        throw new InvalidArgumentException('file does not exist');\n      } ...\nSome more googling suggested that I use json_decode() in my index.php and oauth2callback.php fields for the 'client_secrets.json'.  I did this and it seems to move beyond the error I posted earlier but still throws an odd error where it spits out hundreds of lines showing the same thing:\n[Mon Jul 25 15:02:33 2016] PHP Deprecated:  google-api-php-client's autoloader was moved to vendor/autoload.php in 2.0.0. This redirect will be removed in 2.1.  Please adjust your code to use the new location. in C:\\Users\\XXXXXX\\vendor\\google\\apiclient\\src\\Google\\autoload.php on line 20\nNow the problem is, I have also confirmed that all my references to the autoload.php in question are updated.  (as \"C:\\Users\\XXXXXX\\\"  is doc root, I've equivalents of $file = '/vendor/autoload.php'; in each location)\nSo, I'm still not sure the the json_decode() effort actually helped.  Making no other changes, if I revert my json_decode() update, I get back to the original error.  Any thoughts? \n. @bshaffer this is perfect, thank you!  applying the path seemed to do the trick (I'd assumed since all the files were in the same directory that it'd pick it up if I just left it with the file name.)\nAlso, thanks for the pointer on v4.  If I encounter further issues, I'll move there.\nAgain, thank you!  U R Legend!\n. ",
    "abhishekroy007": "I've done everything you have suggested \"https://github.com/google/google-api-php-client/issues/988\" here but still getting this error.\nFatal error: Uncaught InvalidArgumentException: file does not exist in D:\\xampp\\htdocs\\Google\\vendor\\google\\apiclient\\src\\Google\\Client.php:839 Stack trace: #0 D:\\xampp\\htdocs\\Google\\HelloAnalytics.php(23): Google_Client->setAuthConfig('D:\\xampp\\htdocs...') #1 D:\\xampp\\htdocs\\Google\\HelloAnalytics.php(6): initializeAnalytics() #2 {main} thrown in D:\\xampp\\htdocs\\Google\\vendor\\google\\apiclient\\src\\Google\\Client.php on line 839 \nI have the credentials file at the correct location and has set the location correctly.\n. ",
    "thegregthomp": "I attempted to do this exact same thing in node.js and it works fine. My conclusion is that there's something wrong with the way the impersonation works. The node auth with impersonation works similar to the way v1.x worked. \n$credentials = new Google_Auth_AssertionCredentials(\n    $client_email,\n    $scopes,\n    $private_key,\n    'notasecret',\n    'http://oauth.net/grant_type/jwt/1.0/bearer',\n    $user_to_impersonate,\n    );\nThe new way of impersonating, setSubject, doesn't seem to work for me. I may be doing it wrong but I'd love some input from you others.\n. ",
    "CNSKnight": "I am struggling similarly with Google_Service_Gmail - too many hours now.\nSuper curious to know as well, why @bshaffer 's block on pre-authenticating the service client here is fully undocumented here and here???\n. thx for replying Brent.  You may be speaking of the \"beta\"  php client,  but the flow is still fairly ident regardless of,  no? \nmeantime,  I've found no way to drop a message into my (own) gmail inbox from a web server -  the literally simplest thing one would want to do :l\n. Indeed currently stuck on the Auth. Outlined here\nThanks.\n. um...\"WAD\"?\nOn Fri, Aug 12, 2016 at 6:54 PM Brent Shaffer notifications@github.com\nwrote:\n\nThe getErrors function is for errors that return from the APIs in this\nformat:\n{\n    \"error\": {\n        \"errors\": [\n            { \"code\": 400, \"message\": \"error message\" }\n        ]\n    }\n}\nYeah this isn't great in the scenario you described, but that's an auth\nerror, and has a different error format than the API errors. So\nunfortunately this particular issue is probably WAD.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/1027#issuecomment-239578969,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AANbefpbBc0mq2oIfOaG_V7b_Rxk4tuyks5qfPmmgaJpZM4Jiaml\n.\n. who gnu\n\nOn Fri, Aug 12, 2016 at 7:28 PM Brent Shaffer notifications@github.com\nwrote:\n\nWorking as Designed\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/1027#issuecomment-239583412,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AANbebhpTw2jRnEE8DVgrUkFnzk2Uf2nks5qfQGRgaJpZM4Jiaml\n.\n. \n",
    "DerManoMann": "I do have the same issue with a special twist: The code does work for a quite old service account. Trying to run it with a new developer account/service-account/json file the behaviour is exactly the same.\nWithout the \n$client->setSubject('email@server.com');\nthe code works fine - except that, of course, there is no useful data coming back.\n. Right, here are some more details about my code/setup. Forgive me if this is not the best place but I am getting a bit desperate here and it would be good to establish whether this is a code or config issue....\n```\nuse Google_Client;\nuse Google_Service_Webmasters;\n$client = new Google_Client();\n$client->setApplicationName('s2s-test');\n$client->setAuthConfig('auth.json');\n$client->setScopes([Google_Service_Webmasters::WEBMASTERS_READONLY]);\n$client->setSubject('user@email.com');\n$service = new Google_Service_Webmasters($client);\n$siteListResponse = $service->sites->listSites();\n```\nAs for the auth.json I did:\na) Login as user@email.com at ttps://console.developers.google.com/iam-admin/serviceaccounts\nb) Create/select project\nc) Create new service account\n- download private key\n- select editor role\n- check DwD\nd) Create key in JSON format\nAs mentioned above the code does work for an older account that already had an existing service account.\nI've tried the new auth.json file with some sample python code  from here: https://github.com/google/google-api-python-client and the service_account sample code works fine with it.\nEither I have missed another step in configuring the service account or new accounts do behave slightly different.\nOTOH, the python code doesn't do anything like setSubject('..')...\n. @negreanucalin Yes, I ended up following options 2 from here: https://github.com/google/google-api-php-client/issues/801#issuecomment-171417538\nNot ideal, but it does work - I even wrote a little page with a form to deal with validate the new token, etc. so I do not have to start digging again!\n. @negreanucalin That is no problem - the token validation you have to do once only. After that you have a OAuth user/app with permission to access your account and you use the p12/json file just like before\n. Hmm, no, could try that I guess. However, why does the code as-is work with older accounts?. Nope. I haven't been in the situation yet where I need a new account, but dreading the day.. I did try the auth suggestion and the issue still exists.\nHowever, I have come to the conclusion that this is due to limited understanding on how the auth stuff works.\nI am happy for this to be closed as we can cope with the accounts that we have for now (unless they stop working, that is).. ",
    "negreanucalin": "@DerManoMann: Yep, I can relate. In python we didn't need a method like setSubject('..') as well. Did you figure out a solution? :(\n. @DerManoMann Unfortunately I would need to do my data processing in a cron job :( . thanks for the advice \n. Thank you for the reply!!! The problem is that I would like to send it as a dependency in several classes so that I can test properly :( At least it works (with the hacky solution...against all odds) somehow :D\n. ",
    "coogle": "I am also having difficulty with this code. Here's the thing -- at first the code worked fine, but now when I'm trying to refresh it breaks on the refresh:\n```\n        $credentials = new \\Google_Auth_AssertionCredentials(\n            \\Config::get('services.google.service_account_credentials.client_email'),\n            \\Config::get('services.google.service_account_credentials.scopes', []),\n            \\Config::get('services.google.service_account_credentials.private_key'),\n            'notasecret',\n            'http://oauth.net/grant_type/jwt/1.0/bearer',\n            $user\n        );\n    $googleClient = new \\Google_Client();\n    //$googleClient->setCache(new \\Google_Cache_Apc($googleClient));\n    $googleClient->setAssertionCredentials($credentials);\n\n    if($googleClient->getAuth()->isAccessTokenExpired()) {\n        $googleClient->getAuth()->refreshTokenWithAssertion();\n    }\n\n    return json_decode($googleClient->getAuth()->getAccessToken(), true);\n\n```\nThis returns in error when calling refreshTokenWithAssertion(): \n{ \"error\" : \"unauthorized_client\", \"error_description\" : \"Unauthorized client or scope in request.\" }\n. Doh! If anyone finds this and is wondering the same thing (I can't upgrade to API 2.0 yet because of dependencies on 1.1 still :-/) turns out the problem was mine. Follow these instructions:\nhttps://developers.google.com/api-client-library/php/auth/service-accounts\nMy issue here was that my scopes array in PHP had one more scope in it than my service account had access to. Thus, not authorized! I didn't notice at first because the particular thing I was doing using Google APIs was authorized.\n. ",
    "teddyfran": "@michaelbausor The original issue was resolved? Can you elaborate on that for me.  I am having the exact same issue.  I have code that was working for about a week and then all of a sudden started to get the Error retrieving token: unauthorized_client, Client is unauthorized to retrieve access tokens using this method.  I'm worried as this prevents my app from performing its core functions.  Please advise.  . Hi, this is an issue that all of a sudden I'm starting to have now too.  Has anyone else solved the issue?. ",
    "gmotov": "This code\n$parent = new Google_Service_Drive_ParentReferen();\n        $parent->setId($request->request->get('parentId'));\n        $file->setParents(array($parent));\nyou can replace with\n$file->setParents(array($request->request->get('parentId')));\nand this:\n$data = $request->files->get('file');\nreplace with\n$data = file_get_contents($request->files->get('file'));\nit might be helpful\n. ",
    "shubaivan": "@gmotov very thnks\n. work fine \n```\n    if ($request->request->get('parentId') !== null) {\n        $parent = new \\Google_Service_Drive_ParentReference();\n        $parent->setId($request->request->get('parentId'));\n        $file->setParents(array($parent));\n    }\n$insertArray = [\n    'mimeType' => isset($fileUpload) ? $fileUpload->getClientMimeType() :  $request->request->get('mimeType')\n];\n\nif (isset($fileUpload)) {\n    $insertArray ['uploadType'] = 'media';\n    $insertArray ['data'] = file_get_contents($fileUpload);\n}\n\ntry {\n    $createdFile = $service->files->insert($file, $insertArray);\n\n    return View::create()\n        ->setStatusCode(200)\n        ->setData([$createdFile]);\n\n} catch (\\Exception $e) {\n    $view = $this->view((array) self::ERROR_OCCURRED . $e->getMessage(), 400);\n    return $this->handleView($view);\n}\n\n```\n. this my access token\n{\"access_token\":\"ya29.Ci8lA1JTu9CB81dOFy-nzszViRgCI2CvvKVrCd0Lq-8I0QR_dIrl-_7RccdGt1Islg\",\"token_type\":\"Bearer\",\"expires_in\":3578,\"id_token\":\"xxxx\",\"created\":1468957368} \nnot have refresh token because grom google get refreshToken = null ot need set null with key refresh token or this dosn't metter ?\n``$client = $this->get('artel.google.api.client');\n/** @var CodeUserReference[] $accessToken */\n$accessToken = $this->get('doctrine.orm.entity_manager')->getRepository('ArtelProfileBundle:CodeUserReference')\n    ->getReferenceAccessClient($user);\nif ($accessToken) {\n    $client->setAccessToken($accessToken[0]->getAccessTokenClient());\n} else {\n    $view = $this->view(['No accessToken was found for this user id'], 400);\n    return $this->handleView($view);\n}\n\n$isExpired = $client->isAccessTokenExpired(); // true (bool Returns True if the access_token is expired.)\n$refresh = $client->getRefreshToken(); //null because not gahe refresh token\n\n$client->getGoogleClient()->setAccessType (\"offline\"); //your recomendation\n$client->getGoogleClient()->setApprovalPrompt (\"force\"); //your recomendation\n\n$isAgainExpired = $client->isAccessTokenExpired(); // still true (expired)\n\n$service = new \\Google_Service_Drive($client->getGoogleClient());\n$file = new \\Google_Service_Drive_DriveFile();\n$file->setName($request->request->get('title')\n    ? $request->request->get('title')\n    : $request->files->get('file')->getClientOriginalName()\n);\n$file->setDescription($request->request->get('description'));\n$file->setMimeType($request->request->get('mimeType')\n    ? $request->request->get('mimeType')\n    : $request->files->get('file')->getClientMimeType()\n);\n\n// Set the parent folder.\nif ($request->request->get('parentId') != null) {\n    $parent = new Google_Service_Drive_ParentReferen();\n    $parent->setId($request->request->get('parentId'));\n    $file->setParents(array($parent));\n}\n\ntry {\n    $data = $request->files->get('file');\n\n    $createdFile = $service->files->create($file, array(\n        'data' => $data,\n        'mimeType' => $request->request->get('mimeType')\n            ? $request->request->get('mimeType')\n            : $request->files->get('file')->getClientMimeType(),\n        'uploadType' => 'media'\n    ));\n\n    // Uncomment the following line to print the File ID\n    // print 'File ID: %s' % $createdFile->getId();\n    return View::create()\n        ->setStatusCode(200)\n        ->setData([$createdFile]);\n\n} catch (\\Exception $e) {\n    $view = $this->view((array) $e->getMessage(), 400);\n    return $this->handleView($view);\n}`\n\n```\nstill have exception - The OAuth 2.0 access token has expired, and a refresh token is not available. Refresh tokens are not returned for responses that were auto-approved.\n. - In my code too $client = new Google_Client() but in wrapper, in constructor.\n- I get access token from HWIO bundle:\nhwi_oauth:\n       connect:\n         account_connector: app.provider.user_provider\n       firewall_name: secured_area\n       resource_owners:\n           google:\n               type:                google\n               client_id:           xxx\n               client_secret:       xxx\n               scope:               \"https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/drive\"\nand after I get access token I set it in DB. Then in Action I create wrapper for google api (new Google Client ()) and set this client my accesss token from DB. How to refresh my access token? I try in action use function google api lib setAccessType and setApprovalPrompt, but not efect \n$client->getGoogleClient()->setAccessType (\"offline\"); //your recomendation\n$client->getGoogleClient()->setApprovalPrompt (\"force\"); //your recomendation\nwhen I create object wrapper I create new Google Client \npublic function __construct(array $config, LoggerInterface $symfonyLogger = null)\n       {\n        // True if objects should be returned by the service classes.\n        // False if associative arrays should be returned (default behavior).\n        $config['use_objects'] = true;\n        $client = new \\Google_Client($config);\n        if ($symfonyLogger) {\n            //BC for Google API 1.0\n            if (class_exists('\\Google_Logger_Psr')) {\n                $googleLogger = new \\Google_Logger_Psr($client, $symfonyLogger);\n                $client->setLogger($googleLogger);\n            } else {\n                $client->setLogger($symfonyLogger);\n            }\n        }\n        $client -> setApplicationName($config['application_name']);\n        $client -> setClientId($config['oauth2_client_id']);\n        $client -> setClientSecret($config['oauth2_client_secret']);\n        $client -> setRedirectUri($config['oauth2_redirect_uri']);\n        $client -> setDeveloperKey($config['developer_key']);\n        $this -> client = $client;\n    }\nconfig this is:\n`happy_r_google_api:\n    application_name: carbon-quanta-137312\n    oauth2_client_id: xxx.apps.googleusercontent.com\n    oauth2_client_secret: xxx\n    oauth2_redirect_uri: null\n    developer_key: null\n    site_name: aog.local.com\n`\nand if in action I set to Google Client some parameters this is same if I add constructorI, so what I'am doing wrong ? \n. Yes, I add to wrapper\n$client -> setAccessType ($config['access_type']);\n $client -> setApprovalPrompt ($config['approval_prompt']);\nbut still have\n\"The OAuth 2.0 access token has expired, and a refresh token is not available. Refresh tokens are not returned for responses that were auto-approved.\"\nand after rebuild project, I lost function create and now have insert, this is a magic, I dont change version in composer json :)\n$createdFile = $service->files->insert($file, array(\n            'data' => $data,\n            'mimeType' => $request->request->get('mimeType')\n                ? $request->request->get('mimeType')\n                : $request->files->get('file')->getClientMimeType(),\n            'uploadType' => 'media'\n        ));\nearly I have\n$createdFile = $service->files->create($file, array(\n            'data' => $data,\n            'mimeType' => $request->request->get('mimeType')\n                ? $request->request->get('mimeType')\n                : $request->files->get('file')->getClientMimeType(),\n            'uploadType' => 'media'\n        ));\n. when user connect to github first they have window with scope, where user accept this scope and after I have in response accessToken.\n. I understan. I get access token from HWIO bundle and I add in config HWIO bundle              access_type:         offline, approval_prompt:     force and in response I have refresh token not null\ngoogle:\n        type:                google\n        client_id:           xxx\n        client_secret:       xxx\n        scope:               \"https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/drive\"\n        options:\n            access_type:         offline\n            approval_prompt:     force\n. @bshaffer No, I don't have continue problem, now I have refresh_token in response and this issue closed\n. I find :)\n```\nconvert boolean Whether to convert this file to the corresponding Google Docs format. (Default: false)\n$insertArray = [\n    'mimeType' => $fileUpload->getMimeType(),\n    'uploadType' => 'media',\n    'data' => file_get_contents($fileUpload),\n    'convert' => true\n];\n\n```\n. ",
    "omergisha": "Try \n$client->setAccessType (\"offline\");\n$client->setApprovalPrompt (\"force\");\n. In my code I assumed $client = new Google_Client();. Also, I am not familiar with the way you request the access token.\nFor you to get the refresh token, you need to specify access_type and approval_prompt in the same place where you specify scope and redirect_uri.\n. OK.\nSo from what I understand, you should add to your config :\naccess_type: offline\napproval_prompt: force\nAnd in your else statement\n$client->setAccessType ($config['access_type']);\n$client->setApprovalPrompt ($config['approval_prompt']);\n. I assume you go through the whole process and open a window for the user to give permission to use the account?\nBecause, if not, then this is probably your problem:\nRefresh tokens are not returned for responses that were auto-approved.\nAnd you need to go through that process, as far as I understand.\n. ",
    "sumitbaggabhai": "php\n\n<prequire_once 'vendor/autoload.php';\nsession_start();\n/\n * You can acquire an OAuth 2.0 client ID and client secret from the\n * {{ Google Cloud Console }} <{{ https://cloud.google.com/console }}>\n * For more information about using OAuth 2.0 to access Google APIs, please see:\n * https://developers.google.com/youtube/v3/guides/authentication\n * Please ensure that you have enabled the YouTube Data API for your project.\n /\n$OAUTH2_CLIENT_ID = 'xxxxxxxxxxxxxxxx.apps.googleusercontent.com'; // Enter your Client ID here\n$OAUTH2_CLIENT_SECRET = 'xxxxxxxxxxxxxx'; // Enter your Client Secret here\n$REDIRECT = filter_var('https://developers.google.com/oauthplayground', FILTER_SANITIZE_URL);\n$APPNAME = \"xxxxx\";\n$client = new Google_Client();\n$client->setClientId($OAUTH2_CLIENT_ID);\n$client->setClientSecret($OAUTH2_CLIENT_SECRET);\n$client->setScopes('https://www.googleapis.com/auth/youtube');\n$client->setRedirectUri($REDIRECT);\n$client->setApplicationName($APPNAME);\n$client->setAccessType('offline');\n$client->setApprovalPrompt('force');\n// Define an object that will be used to make all API requests.\n$youtube = new Google_Service_YouTube($client);\nif (isset($_GET['code'])) {\n    if (strval($_SESSION['state']) !== strval($_GET['state'])) {\n        die('The session state did not match.');\n    }\n$client->authenticate($_GET['code']);\n$_SESSION['token'] = $client->getAccessToken();\n\n}\nif (isset($_SESSION['token'])) {\n    $client->setAccessToken($_SESSION['token']);\n    echo \"Access Token: \" . json_encode($_SESSION['token']);\n}\n// Check to ensure that the access token was successfully acquired.\nif ($client->getAccessToken()) {\n    try {\n        // Call the channels.list method to retrieve information about the\n        // currently authenticated user's channel.\n        $channelsResponse = $youtube->channels->listChannels('contentDetails', array('mine' => 'true'));\n    $htmlBody = '';\n    foreach ($channelsResponse['items'] as $channel) {\n        // Extract the unique playlist ID that identifies the list of videos\n        // uploaded to the channel, and then call the playlistItems.list method\n        // to retrieve that list.\n        $uploadsListId = $channel['contentDetails']['relatedPlaylists']['uploads'];\n\n        $playlistItemsResponse = $youtube->playlistItems->listPlaylistItems('snippet', array(\n            'playlistId' => $uploadsListId,\n            'maxResults' => 50\n        ));\n\n        $htmlBody .= \"<h3>Videos in list $uploadsListId</h3><ul>\";\n        foreach ($playlistItemsResponse['items'] as $playlistItem) {\n            $htmlBody .= sprintf('<li>%s (%s)</li>', $playlistItem['snippet']['title'],\n                $playlistItem['snippet']['resourceId']['videoId']);\n        }\n        $htmlBody .= '</ul>';\n    }\n} catch (Google_ServiceException $e) {\n    $htmlBody .= sprintf('<p>A service error occurred: <code>%s</code></p>',\n        htmlspecialchars($e->getMessage()));\n} catch (Google_Exception $e) {\n    $htmlBody .= sprintf('<p>An client error occurred: <code>%s</code></p>',\n        htmlspecialchars($e->getMessage()));\n}\n\n$_SESSION['token'] = $client->getAccessToken();\n\n} else {\n    $state = mt_rand();\n    $client->setState($state);\n    $_SESSION['state'] = $state;\n$authUrl = $client->createAuthUrl();\n$htmlBody = <<<END\n\nAuthorization Required\nYou need to authorise access before proceeding.\nEND;\n}\n?>\ndoctype html\n\n\nMy Uploads\n\n\nphp echo $htmlBody;?\n\n\n// please help me solve this i am not get token. ",
    "lightlinksolution": "how to get token, for Authorization: Bearer. ",
    "mike42": "Please check your PHP version. The README states that you need PHP 5.4.0 or higher, which was released in 2012.\nYou can get the same error if you paste the content of ./src/Google/Client.php into an online syntax checker for PHP 5.3.\n. I can replicate what you're seeing, and I believe that this behaviour is expected for sub-1.0 versions of dependencies (please see composer docs):\n\nFor pre-1.0 versions it also acts with safety in mind and treats ^0.3 as >=0.3.0 <0.4.0.\n\nOnce this change appears in a release, you would get the new version.\nOtherwise, as you note, your options are to either use the currently released dependencies:\n$ composer require google/apiclient\nUsing version ^2.0 for google/apiclient\n...\n  - Installing google/apiclient-services (v0.5)\n...\n  - Installing google/apiclient (v2.0.2)\nOr to switch to a dev version and cross your fingers, basically:\n$ composer require google/apiclient:dev-master\n...\n  - Installing google/apiclient-services (v0.6)\n...\n  - Installing google/apiclient (dev-master b9410f9)\n    Cloning b9410f923f312b2a80c5cb9d10c80ed09b8e5da2\n. ",
    "peterdd": "I used https://github.com/google/google-api-php-client/releases/download/v2.0.2/google-api-php-client-2.0.2_PHP54.zip\nand the screenshot was taken from this unzipped...\n. Looks good. Thanks. :-)\n. ",
    "mphimla2": "G+\n. ",
    "etienne-gauvin": "I solved it by changing the directive google_app_engine.enable_curl_lite to \"0\" in php.ini.\nBut now I've got an other error \"No system CA bundle could be found in any of the the common system locations.\"\nI tried to add the line\nphp\n$client->setHttpClient(\n    new GuzzleHttp\\Client([ 'verify' => false ])\n);\nbut that would be too easy, and I got a 400 Bad Request from the Google API.\nI'll try to get one of these \"CA bundle\", should solve my problem.\nBut it looks like this problem isn't related to the google-api-php-client anymore, so, bye.\n. ",
    "stomaskovic": "Encountered the same problem and can confirm.\n. ",
    "gdhnz": "I've just re-tried my code after updating to dev-master and it's now performing as expected.\nThanks.\n. ",
    "holtkamp": "I signed it!\nOn 12 August 2016 at 11:24, googlebot notifications@github.com wrote:\n\nThanks for your pull request. It looks like this may be your first\ncontribution to a Google open source project. Before we can look at your\npull request, you'll need to sign a Contributor License Agreement (CLA).\n\ud83d\udcdd Please visit https://cla.developers.google.com/\nhttps://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll\nverify. Thanks.\n\nIf you've already signed a CLA, it's possible we don't have your\n  GitHub username or you're using a different email address. Check your\n  existing CLA data https://cla.developers.google.com/clas and verify\n  that your email is set on your git commits\n  https://help.github.com/articles/setting-your-email-in-git/.\nIf you signed the CLA as a corporation, please let us know the\n  company's name.\n\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/1029#issuecomment-239401230,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAvY1cJdwSon_IiVLDqtcvynY8SWYlIuks5qfDvSgaJpZM4Ji6ky\n.\n. Closing, posted it here https://github.com/google/google-api-php-client-services/issues/28\n. \n",
    "inverse": "I signed it!\n. ",
    "cmcfadden": "Yeah, I'm running against the current master head for tedivm/stash (6aec97c9cc413223136e5f62dd200cf5eb932d1b)\n. It's definitely odd - here are a few more clues.  What's happening is the JWT->verify function is failing for all of the available certs in the cases where it fails.  However, it's more sporadic than I first realized.  If I repeatedly try to auth, I'll get a mix of successes and failures.  \nDisabling the cache in Verify.php (commenting out the cache fetch in getFederatedSignOnCerts) seems to resolve it consistently - I haven't made it fail ever with that disabled.  Unfortunately it doesn't look like it's possible to disable caching entirely if I've got stash loaded for other uses in the app (without modifying verify.php).  \nVery odd.\n. One more note - if I just curl the URL for certs, I get back different results pretty consistently - sometimes three certs, sometimes four, and different results for different hosts.  Is there somewhere that explains what to expect from that from google?\n. ",
    "jaredtking": "I'm running into similar issues on 2.0.3. What happens is that verifyIdToken() works and then after the next day or so it stops working. Each time I've been able to get it working again by clearing out the certificates cache. I'm using symfony/cache, which is PSR-6 compatible, instead of using tedvim/stash.\n. ",
    "dimre01": "To clarify: is it possible to create an instance of Google_Service_YouTubeAnalytics with the most recent version of the API?\n. ",
    "enesyurtlu": "https://github.com/google/google-api-php-client-services newest repo is here.\n. ",
    "kimmer99": "Yeah, that's what I was afraid of - thanks.\n. Yep - sorry \n. ",
    "baurma": "When calling $client->setAccessToken(), make sure you are passing the entire json string, not only the token part. The json string contains the expires_in timestamp which is evaluated in isAccessTokenExpired\n. @rizalio: Not sure. What I can imaging is that json_encode returns FALSE. Verify json_encode works. Instead of\n $this->client->setAccessToken(json_encode($data));\ntry something like\nif ($json = json_encode($data)) {\n  echo \"json is $json\\n\";\n  $this->client->setAccessToken($json);\n} else {\n  die(\"json_encode failed\");\n}\nalso verify that the string reported by \"json is\" contains all the required data.\n. ",
    "alenmjis": "Thank you @baurma  worked out for me. I was passing token alone for checking.\n. ",
    "eugenecooper": "Thanks @baurma. I had the same issue as above and you really saved my day.. ",
    "massivebrains": "Thank you @baurma  i was also passing the string alone.. ",
    "rizalio": "@baurma I can't get it work by passing the JSON string to setAccessToken() method, if I try to use $client->getAccessToken() is only return the array containeing the access token\n[\n     \"access_token\" => \"the token string.....\"\n]\n\nThis is the test() method from Drive class.\npublic function test() {\n    return $this->client->getAccessToken();\n}\nand this is how i get the access token.\n```\npublic function authenticate($data = []) {\n    if(!is_array($data)) {\n        return false;\n    }\n$data = $this->client->fetchAccessTokenWithAuthCode($data['code']);\nfile_put_contents($this->config['credential'], json_encode($data, JSON_PRETTY_PRINT));\n$this->client->setAccessToken(json_encode($data));\nreturn true;\n\n}\n``\nthedataarray is auth code & scope from google after the OAuth complete & the$this->config['credential']` is the json file where I save the Access Token. \nbut.. this keep the isAccessTokenExpired() method not work.\n\nFYI I'm using Laravel 5.4 and google/apiclient library. Thanks for your help I'm very appreciated!\n. This code take from Google\\Client.php \n```\n/\n   * Attempt to exchange a code for an valid authentication token.\n   * Helper wrapped around the OAuth 2.0 implementation.\n   \n   * @param $code string code from accounts.google.com\n   * @return array access token\n   /\n  public function fetchAccessTokenWithAuthCode($code)\n  {\n    if (strlen($code) == 0) {\n      throw new InvalidArgumentException(\"Invalid code\");\n    }\n$auth = $this->getOAuth2Service();\n$auth->setCode($code);\n$auth->setRedirectUri($this->getRedirectUri());\n\n$httpHandler = HttpHandlerFactory::build($this->getHttpClient());\n$creds = $auth->fetchAuthToken($httpHandler);\nif ($creds && isset($creds['access_token'])) {\n  $creds['created'] = time();\n  $this->setAccessToken($creds);\n}\n\nreturn $creds;\n\n}\n```\nthese method has been set the access token, do we doesn't need to set the access token again???. @baurma I also think like that, but when I'm use the getAccessToken() method, the SDK return the sccess_token array that mean (maybe) the JSON is set successfully. But I'm not try it yet, Thanks for your help I'll try it!. Oops! My mistake :joy: I'm setting the setAccessToken() method on the __construct() with parameter only the access_token string :joy: because I want to set the \\Google_Service_Drive that need the $client instance on my $service property :joy:\n\nThanks for your help!. ",
    "chauhanbhargav": "I have an access token and set this access token from my request.\nafter that, I have to fetch user object, Below error generate.\nNotice: Undefined index: expires_in in opt/lampp/htdocs/project/vendor/google/apiclient/src/Google/Client.php\n**here is my code.\n    $client = new Google_Client();\n    $client->setApplicationName(env('GOOGLE_APP_NAME'));\n    $client->setClientId(env('GOOGLE_CLIENT_ID'));\n    $client->setClientSecret(env('GOOGLE_CLIENT_SECRET'));\n    $client->setRedirectUri('http://localhost:8000');\n    $client->setDeveloperKey(env('GOOGLE_API_KEY'));\n    $client->setAccessToken($request->authToken);\n    $plus = new Google_Service_Plus($client);\n    dd($plus->people->get('me'));**\n\n. ",
    "litan1106": "opps wrong repo.\n. ",
    "chriscct7": "Prs #1047 and #1048 opened. When both are merged, this issue is solved in both the legacy and new API branches.\n. > Wow, I'm pretty shocked it's allowed to change the default behavior here. \nYeah, I was as well. We use the PHP Google API for a our Google Analytics plugin that we write for the WordPress platform, and we probably get a dozen tickets a week at least from this issue (the currently deployed version uses an older version of the API which had more of these calls in it; we're getting ready to launch a new version that uses the latest & greatest). From what we can tell, from talking to a couple of the hosting companies involved like HostEurope, they do it as \"a security measure\" because substituting an escaped value of ampersand somehow makes it safer. I presume its assuming a usecase of people outputting it as a template language as well, but I don't fully understand their usecase either (I just know it completely breaks things). Who knows. I know WordPress has hardcoded the third parameter of all of the core http_build_query calls to the correct default value for this reason.\n. I should note, we were originally just going to wrap an ini_set to force it back whenever our plugin was loaded, but give there's only 1 call to it in the new API, we've gone ahead and done these prs on our fork of the PHP API which we're shipping with our rewrite.\n. I should also note that it's not just hosts doing this. There are older versions of Drupal where the Drupal application actually does this: https://www.drupal.org/node/2476237\n. I signed it!\n. Indeed you are correct on this. Didn't notice the v2 API always only has 1 parameter. I think you can close this.\n. I signed it!\n. So I'm thinking for a test, as opposed to testing this exact case, we could ini_set the value to &amp in like the bootstrap, because hypothetically, if everything is working correctly nothing should fail if that is done. Or did you have a specific approach in mind?\n. @bshaffer sorry for the delay. I've enabled the edit from maintainers and have added unit tests for both the normal and &amp; values of the arg_seperator. Unit test and fixes have been verified against an unfixed fork of repo that was updated with just the unit tests.\n. Not a problem!\nOn Jan 9, 2017 2:33 PM, \"Brent Shaffer\" notifications@github.com wrote:\n\nSorry for the delay as well! Merged, thank you.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/1048#issuecomment-271384004,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ABQ2XYpojZoaqox0fv7_kkbID6Q5dq_Lks5rQouKgaJpZM4JyuL1\n.\n. @bshaffer Version 2.x requires PHP 5.4 or newer though right?. @danoscarmike + @bshaffer is this for the 5.2 compatible version only or for master as well? For those building new php based applications which client library should we be using?. \n",
    "ilinkMathew": "The latest release of google-api-php-client (v2.0.3) has the append functions included in it. Do check it out \n. ",
    "emestud": "The page has been updated. Thanks very much for pointing that out.\n. ",
    "john-main-croud": "I signed it!\n. ",
    "shakaran": "Duplicate of #1063 even if this PR was more old, since this fail the travis, this probably could be closed\n. ",
    "boredom2": "Similar problem here. We cant update the Microsoft Azure Package, which needs JWT 4.0 now. Is it possible to support JWT 4.0 in this Project also?\n. Is it possible, that someone releases a Version with JWT@4.0?\n. I need it:-)\nThe Microsoft Azure SDK has been updated and is only compatible with JWT 4.0 now.\nSo its really complicated to include Google and Azure with different dependencies for this Lib.\n. ",
    "tomschlick": "Another issue with this. Laravel Spark requires ~4.0\n. Another request for this from another laravel/spark user. Can't upgrade spark without it.\nDoesn't look like there are any breaking changes in the 3.0->4.0 migration so are there any reasons not to upgrade?\n. Any update? google/google-auth-library-php#137 has been merged.\n. ",
    "angular-tools": "Have same issue when installing this with aws/aws-sdk-php because it requires guzzlehttp/psr7[1.3.1]\n```\n- google/auth v0.8 requires guzzlehttp/psr7 1.2.* -> satisfiable by guzzlehttp/psr7[1.2.0, 1.2.1, 1.2.2, 1.2.3].\n\nInstallation request for guzzlehttp/psr7 (locked at 1.3.1) -> satisfiable by guzzlehttp/psr7[1.3.1].\n```\n\nHow can I sort this?\n. ",
    "ashbeats": "@angular-tools this is not related to the firebase pkg. Just happens that both reference guzzle. \nYou can try to update \"google-api-php-client\" to use guzzle v1.3.1. If it passes all tests, submit a push req or configure composer to use your fork. \n. ok. it's signed. \n. I'm using laravel/spark, which requires firebase v4.0. \n. ",
    "jamesgraham": "Can this be upgraded to v5 now?. ",
    "awoyele": "Did you find a solution?. ",
    "ajucken": "I'm having the same issue :/ Any solutions yet?. Did you follow the Instructions in Step 1. on this site?\nhttps://developers.google.com/google-apps/calendar/quickstart/php. ",
    "JoshHighland": "I had this error until reading this and figuring out that path to my auth file was wrong.. ",
    "hamzazafeer": "I am facing same issue.. i revised my first step. i forgot to add clinet_secret.json. After adding this file, my error is solved.. ",
    "yamenshahin": "Sorry, but I have the file in the right directory and still get this error.. ",
    "nghoanghiep": "client_secrets.json with an s, I missed the s. ",
    "etremblay": "This PR would be very appreciated !\n. ",
    "JsChiSurf": "Just ended up here as a result of a search after finding the same behavior.\n. The important point for me is, I had setup access to the Calendar API back in January, and downloaded this library, and that version of the library, when the access token has expired, renews and passes back both the new token and the (original) refresh token, for saving / caching the file off for use after the next expiration, using:\n// Refresh the token if it's expired.\nif ($client->isAccessTokenExpired()) {\n  $client->refreshToken($client->getRefreshToken());\n  file_put_contents($credentialsPath, $client->getAccessToken());\n}\nHas this behavior intentionally changed in this version?  The current version calls (by way of example in the quick start):\n// Refresh the token if it's expired.\nif ($client->isAccessTokenExpired()) {\n  $client->fetchAccessTokenWithRefreshToken($client->getRefreshToken());\n  file_put_contents($credentialsPath, json_encode($client->getAccessToken()));\n}\nWhich no longer includes the refresh token.  Meaning, doing nothing different using the \"same\" library, under the new scripts, you can only maintain access for 2 hours (original token, followed by refresh token), but when the third attempt occurs, since the refresh token is no longer present, you're DOA.\nI certainly understand how to extract and save off the refresh token manually for later use, but one did not have to do this manually using the library a short time ago, so the behavior has changed (intentional?).\nRolanyang's suggestion makes sense from my perspective and resolves the \"issue\".\n. ",
    "LetterboxDelivery": "I was also seeing the same problem with offline access.\nHowever it looks like we actually needed to store the original refresh_token given to us at first authorisation to be reused later on. I had assumed a new refresh_token would be generated so kept overwriting the returned access token data stored in the DB.\nI am now simply appending the original refresh_token back into the access token array and storing it again.\n. ",
    "rolanyang": "Perhaps at some point in the past,  the refresh token was being returned but is no longer now.  I wonder if there is logic on the server side that might have stopped the return of refresh tokens if the oauth permissions were revoked.  If that is the case and, in the future, the server does start returning refresh tokens again, then this might be better:\nif (!isset($creds['refresh_token']) {\n        $creds['refresh_token'] = $refreshToken;\n    }\n. ",
    "djhr": "In case the behavior was intentionally changed, then the documentation/quickstart needs to be updated accordingly, otherwise everybody will be induced to this mistake...\n. I have $client->setAccessType('offline'); doesn't make the refresh token to be returned, at least not for me.. ",
    "daniel-zahariev": "Be sure to add $client->setAccessType('offline');. I've also came across this 'error'\n. ",
    "scottnimos": "I too am having the same issue I think it is definitely a server side issue . ",
    "sadashivdalvi": "I am facing the same problem the problem here is that the call for refreshing token using the refresh token doesn't set the refresh token and sends only the access token.  Complete description written in #1102 \nSeems that the library is not considering the accessType when refreshing the token.\nThanks,\nSadashiv.. Sorry for creating this dupe issue.  It is dupe with https://github.com/google/google-api-php-client/issues/1064 but still please update as I can see others are also facing the same issue.\nThanks,\nSadashiv. ",
    "jeez09": "I am also facing the same issue , 'refresh token must be passed in or set as part of setAccessToken'\nNot sure what wrong /how to resolve it . \nHas anyone found the solution . it was working good for first time , after 6 hrs its giving me the above error . ",
    "heukirne": "Besides\n$client->setAccessType('offline');\nNeed to include force prompt to Google return the refresh token:\n$client->setApprovalPrompt('force');\nWorks for me.. Besides\n$client->setAccessType('offline');\nNeed to include force prompt to Google return the refresh token:\n$client->setApprovalPrompt('force');\nWorks for me.. Besides\n$client->setAccessType('offline');\nNeed to include force prompt to Google return the refresh token:\n$client->setApprovalPrompt('force');\nWorks for me.. You can see all my code: https://github.com/heukirne/geolocated-restricted-events/blob/master/generate_credentials.php\nIt's basically the Google Calendar Api PHP Example\nhttps://developers.google.com/google-apps/calendar/quickstart/php. Probably the serverAuthCode from Ionic 3 doesn't allow offline access that release the refresh token. Maybe you need to set the access_type to offline in Ionic somewhere.. Sorry, I can tell you.\nYou probably should take a look at Java Google Auth Api and look for how you can force the refresh_token.\nhttps://github.com/EddyVerbruggen/cordova-plugin-googleplus/blob/master/src/android/GooglePlus.java. So, I suggest you to close this issue and open another in cordova-plugin-googleplus.. ",
    "gth": "The initial oauth sequence must include the line of code below -\n$client->setApprovalPrompt('force'); \nWithout this, when accessToken expires, there will be no refreshToken available - the getRefreshToken() function will return null, which in turn causes fetchAccessTokenWithRefreshToken to fail.  \nI don't know if this setApprovalPrompt setting is a legitimate requirement of what I'm trying to do, or relates to an issue elsewhere within the Google Client PHP API.  I just know it fixes the problem of the various quickstart.php samples published by Google that fail to refresh expired access tokens.. As an issue, isn't this still open? getRefreshToken() should, well, get a refresh token, yes?\nIf the API is behaving as intended (which would require some explanation), then the code on the Google Sample for PHP needs to be amended.. ",
    "heavendragon": "After set\n$client->setAccessType('offline');\n$client->setApprovalPrompt('force');\nDon't forget to delete your previous credential token.. ",
    "nathanmarcos": "I signed it!\n. ",
    "acrolink": "There is a possibility that this is a PHP 7.1 bug since the same error is reported by various PHP applications.\nUpdate 31-12-16: It is in fact not a PHP 7.1 bug. I thought that since this behavior is not documented in the backwards incompatibility page at php.net .. The PHP team will update the relevant documentation there in near future... ",
    "SerafimArts": "This is not a bug of php 7.1. This is bug of very old deprecated guzzle library. @bshaffer this is side effect of other library. Just close this issue, its not a problem of google-api-vk-client ;). ",
    "sztanpet": "Not using composer, downloaded a release but we are no longer using the library so no longer involved in fixing the bug, sorry.. ",
    "ryan-schroeder": "I was still having this because guzzle was installed globally at 5.3.0; updating the global guzzle (or deleting it) fixed for me, took a while to figure out =). ",
    "AxxlForce": "im only getting a subset containing the following properties:\nanyoneCanAddSelf\nattendeesOmitted\ncolorId\ncreated\ndescription\nendTimeUnspecified\netag\nguestsCanInviteOthers\nguestsCanModify\nguestsCanSeeOtherGuests\nhangoutLink\nhtmlLink\niCalUID\nid\nkind\nlocation\nlocked\nprivateCopy\nrecurrence\nrecurringEventId\nsequence\nstatus\nsummary\ntransparency\nupdated\nvisibility\n. solution found, see: http://stackoverflow.com/questions/39904921/google-api-php-client-and-service-account-date-of-event-missing\n. ",
    "Matheus-Ribeiro95": "I did it here boys, was a stupid error in array.\nThanks for the amazing API!\n. ",
    "alexghi": "Google_Auth_LoginTicket was removed.  Calls to Google_Client::verifyIdToken now returns\n    the payload of the ID Token as an array if the verification is successful. - taken from google's UPGRADING.md\n. ",
    "dkrausahma": "When you say \"sporadic\" do you mean after 3600 seconds? That would be the time when the access token is expired and you would have to get a new one.\nI am having the same issue and i do understand that it is due to the expired access token. This is my particular code sequence (which is quite similar to yours):\n``` php\n    / This env variable holds the path to the keyfile with the JSON based certificate. It will be required by the Google API Client /\n    putenv( 'GOOGLE_APPLICATION_CREDENTIALS=' . $objApplication->getConfig( 'App::GoogleAuthServiceAccoutKeyAsJson' ) );\n    try{\n    /* Using Stash for caching */\n    //$objCache = new Pool( new FileSystem );\n\n    //$objCacheLogger = new Logger;\n    //$hdTokenCallback = function( $cacheKey, $accessToken ) use ( $objCacheLogger ) {\n    //    $objCacheLogger->debug( sprintf( 'A new access token \\'%s\\' has beeen received for the cache key %s', $accessToken, $cacheKey ) );\n    //};\n\n    /* Creating the client */\n    $objGoogleApiClient = new \\Google_Client();\n    $objGoogleApiClient->useApplicationDefaultCredentials();\n    $objGoogleApiClient->setApplicationName( 'myTestApplication' );\n    $objGoogleApiClient->setAccessType( 'offline' );\n    $objGoogleApiClient->setScopes( [ 'https://www.googleapis.com/auth/webmasters.readonly' ] );\n    //$objGoogleApiClient->setCache( $objCache );\n    //$objGoogleApiClient->setTokenCallback( $hdTokenCallback );\n\n    /* Refresh token when expired */\n    if( $objGoogleApiClient->isAccessTokenExpired() ){\n        $objGoogleApiClient->refreshTokenWithAssertion();\n    }\n\n    /* Creating the actual service */\n    $this->objGoogleService = new \\Google_Service_Webmasters( $objGoogleApiClient );\n\n} catch( \\Google_Exception $objException ){\n    die(\" An exception has occured!\" );\n}\n\n```\nI have also diggged into what feels like the entire documentation there is in the Internet ;-). But i still get the expiration after 3600. I am as well using a service account and this code runs on the console. \nWhat am i doing wrong, why am getting the expiration? Is this part \nphp\n        /* Refresh token when expired */\n        if( $objGoogleApiClient->isAccessTokenExpired() ){\n            $objGoogleApiClient->refreshTokenWithAssertion();\n        }\nnot enough to do the refreshing? I used a debugger but could not find a refresh token passed back to Client.php, it was always null. Recreated millions of service accounts and went through the initial authentication process expecting to get one, but none which i could save away and use for later refreshing process.\nAs opposed to omnicodagithub i am getting the 401 not sporadically but regularly after one hour.\nAbove code is using google/apiclient v2.0.3.\nThanks for any advice.\n. -- Even when I copy Google's own examples they often don't seem to work or only work temporarily\nWhich is why i want to solve this approach here now because i already spent too much time trying to resolve this. Version 1 of the API worked fine (at least for the Search Console) but i was missing the setStartRow() for result sets exceeding 5000 rows in the old version. Along with the composer support it makes sense for me to update to version 2.\n. Update:\nJust for the heck of it i downgraded the Google Api Client to v.2.0.2 and am realizing that above code works perfectly, also after 3600 seconds have been exceeded. Refreshing the access token works just fine. So without having gone into depth the mentioned misbehaviour only occurs with the Api Client in v.2.0.3. \n. ",
    "omnicodagithub": "It was the expiration. I've decided to go with OAuth instead but that's also seeming to be a nightmare to set up. Even when I copy Google's own examples they often don't seem to work or only work temporarily.\n. Just an update from me. So to test I am storing the entire access token in the database (access_key, token_type, expires_in, refresh_key and created). I am using this token from the database with the setAccessToken method. This is almost always resulting in a 401 \"Invalid Credentials\" error. When I test this same key in the Google API Playground it works fine, so it doesn't seem to be the access token.\nNot sure if I'm not quite understanding it, but if I'm using an access token from the database, then the cache shouldn't affect this should it? By the way, it did actually work earlier for a while using this method. This issue really has me scratching my head as one time it's working fine, the next it's not working.\n. Hi @bshaffer! Thanks for the help by the way.\nOk, so here is the stack trace:\nStack trace:\n0 C:\\xampp\\htdocs\\marketingtool\\vendor\\google\\apiclient\\src\\Google\\Http\\REST.php(94): Google_Http_REST::decodeHttpResponse(Object(GuzzleHttp\\Psr7\\Response), Object(GuzzleHttp\\Psr7\\Request), 'Google_Service_...')\n1 [internal function]: Google_Http_REST::doExecute(Object(GuzzleHttp\\Client), Object(GuzzleHttp\\Psr7\\Request), 'Google_Service_...')\n2 C:\\xampp\\htdocs\\marketingtool\\vendor\\google\\apiclient\\src\\Google\\Task\\Runner.php(181): call_user_func_array(Array, Array)\n3 C:\\xampp\\htdocs\\marketingtool\\vendor\\google\\apiclient\\src\\Google\\Http\\REST.php(58): Google_Task_Runner->run()\n4 C:\\xampp\\htdocs\\marketingtool\\vendor\\google\\apiclient\\src\\Google\\Client.php(781): Google_Http_REST::execute(Object(GuzzleHttp\\Client), Object(GuzzleHttp\\Psr7\\Request), 'Google_Service_...', Array)\n5 C:\\xampp\\htdocs\\marketingtool\\vendor\\google\\apiclient\\src\\Google\\Service\\Resource.php(232): Google_Client->execute(Object(GuzzleHttp\\Psr7\\Request), 'Google_Service_...')\n6 C:\\xampp\\htdocs\\marketingtool\\vendor\\google\\apiclient-services\\src\\Google\\Service\\Webmasters\\Resource\\Searchanalytics.php(48): Google_Service_Resource->call('query', Array, 'Google_Service_...')\n7 C:\\xampp\\htdocs\\marketingtool\\app\\Http\\Controllers\\SearchConsoleController.php(146): Google_Service_Webmasters_Resource_Searchanalytics->query('http://www.omni...', Object(Google_Service_Webmasters_SearchAnalyticsQueryRequest))\n8 [internal function]: App\\Http\\Controllers\\SearchConsoleController->test()\n9 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Controller.php(55): call_user_func_array(Array, Array)\n10 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\ControllerDispatcher.php(44): Illuminate\\Routing\\Controller->callAction('test', Array)\n11 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Route.php(190): Illuminate\\Routing\\ControllerDispatcher->dispatch(Object(Illuminate\\Routing\\Route), Object(App\\Http\\Controllers\\SearchConsoleController), 'test')\n12 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Route.php(144): Illuminate\\Routing\\Route->runController()\n13 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Router.php(642): Illuminate\\Routing\\Route->run(Object(Illuminate\\Http\\Request))\n14 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Pipeline.php(53): Illuminate\\Routing\\Router->Illuminate\\Routing{closure}(Object(Illuminate\\Http\\Request))\n15 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Middleware\\SubstituteBindings.php(41): Illuminate\\Routing\\Pipeline->Illuminate\\Routing{closure}(Object(Illuminate\\Http\\Request))\n16 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Pipeline\\Pipeline.php(137): Illuminate\\Routing\\Middleware\\SubstituteBindings->handle(Object(Illuminate\\Http\\Request), Object(Closure))\n17 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Pipeline.php(33): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline{closure}(Object(Illuminate\\Http\\Request))\n18 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Auth\\Middleware\\Authenticate.php(43): Illuminate\\Routing\\Pipeline->Illuminate\\Routing{closure}(Object(Illuminate\\Http\\Request))\n19 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Pipeline\\Pipeline.php(137): Illuminate\\Auth\\Middleware\\Authenticate->handle(Object(Illuminate\\Http\\Request), Object(Closure))\n20 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Pipeline.php(33): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline{closure}(Object(Illuminate\\Http\\Request))\n21 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Http\\Middleware\\VerifyCsrfToken.php(65): Illuminate\\Routing\\Pipeline->Illuminate\\Routing{closure}(Object(Illuminate\\Http\\Request))\n22 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Pipeline\\Pipeline.php(137): Illuminate\\Foundation\\Http\\Middleware\\VerifyCsrfToken->handle(Object(Illuminate\\Http\\Request), Object(Closure))\n23 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Pipeline.php(33): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline{closure}(Object(Illuminate\\Http\\Request))\n24 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\View\\Middleware\\ShareErrorsFromSession.php(49): Illuminate\\Routing\\Pipeline->Illuminate\\Routing{closure}(Object(Illuminate\\Http\\Request))\n25 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Pipeline\\Pipeline.php(137): Illuminate\\View\\Middleware\\ShareErrorsFromSession->handle(Object(Illuminate\\Http\\Request), Object(Closure))\n26 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Pipeline.php(33): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline{closure}(Object(Illuminate\\Http\\Request))\n27 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Session\\Middleware\\StartSession.php(64): Illuminate\\Routing\\Pipeline->Illuminate\\Routing{closure}(Object(Illuminate\\Http\\Request))\n28 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Pipeline\\Pipeline.php(137): Illuminate\\Session\\Middleware\\StartSession->handle(Object(Illuminate\\Http\\Request), Object(Closure))\n29 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Pipeline.php(33): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline{closure}(Object(Illuminate\\Http\\Request))\n30 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Cookie\\Middleware\\AddQueuedCookiesToResponse.php(37): Illuminate\\Routing\\Pipeline->Illuminate\\Routing{closure}(Object(Illuminate\\Http\\Request))\n31 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Pipeline\\Pipeline.php(137): Illuminate\\Cookie\\Middleware\\AddQueuedCookiesToResponse->handle(Object(Illuminate\\Http\\Request), Object(Closure))\n32 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Pipeline.php(33): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline{closure}(Object(Illuminate\\Http\\Request))\n33 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Cookie\\Middleware\\EncryptCookies.php(59): Illuminate\\Routing\\Pipeline->Illuminate\\Routing{closure}(Object(Illuminate\\Http\\Request))\n34 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Pipeline\\Pipeline.php(137): Illuminate\\Cookie\\Middleware\\EncryptCookies->handle(Object(Illuminate\\Http\\Request), Object(Closure))\n35 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Pipeline.php(33): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline{closure}(Object(Illuminate\\Http\\Request))\n36 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Pipeline\\Pipeline.php(104): Illuminate\\Routing\\Pipeline->Illuminate\\Routing{closure}(Object(Illuminate\\Http\\Request))\n37 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Router.php(644): Illuminate\\Pipeline\\Pipeline->then(Object(Closure))\n38 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Router.php(618): Illuminate\\Routing\\Router->runRouteWithinStack(Object(Illuminate\\Routing\\Route), Object(Illuminate\\Http\\Request))\n39 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Router.php(596): Illuminate\\Routing\\Router->dispatchToRoute(Object(Illuminate\\Http\\Request))\n40 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Http\\Kernel.php(267): Illuminate\\Routing\\Router->dispatch(Object(Illuminate\\Http\\Request))\n41 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Pipeline.php(53): Illuminate\\Foundation\\Http\\Kernel->Illuminate\\Foundation\\Http{closure}(Object(Illuminate\\Http\\Request))\n42 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Http\\Middleware\\CheckForMaintenanceMode.php(46): Illuminate\\Routing\\Pipeline->Illuminate\\Routing{closure}(Object(Illuminate\\Http\\Request))\n43 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Pipeline\\Pipeline.php(137): Illuminate\\Foundation\\Http\\Middleware\\CheckForMaintenanceMode->handle(Object(Illuminate\\Http\\Request), Object(Closure))\n44 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Routing\\Pipeline.php(33): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline{closure}(Object(Illuminate\\Http\\Request))\n45 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Pipeline\\Pipeline.php(104): Illuminate\\Routing\\Pipeline->Illuminate\\Routing{closure}(Object(Illuminate\\Http\\Request))\n46 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Http\\Kernel.php(149): Illuminate\\Pipeline\\Pipeline->then(Object(Closure))\n47 C:\\xampp\\htdocs\\marketingtool\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Http\\Kernel.php(116): Illuminate\\Foundation\\Http\\Kernel->sendRequestThroughRouter(Object(Illuminate\\Http\\Request))\n48 C:\\xampp\\htdocs\\marketingtool\\public\\index.php(54): Illuminate\\Foundation\\Http\\Kernel->handle(Object(Illuminate\\Http\\Request))\n49 {main}\nRegarding point two, when using Charles I can see that a different access_token is being used for authorisation. The one I am using for setAccessToken() is definitely the correct one (I'm printing it out to the page so I can confirm). Is there a cached one and is that one being used instead of the one I'm passing to setAccessToken()?\n. @bshaffer Hmm weird. I was using useApplicationDefaultCredentialsbefore, but I stopped using it days ago. I was originally using service accounts, but I decided instead to go with just OAauth. I'm using setAuthConfig, but that only looks as though it uses useApplicationDefaultCredentials if the JSON file has a type of 'service_account'.\nI added this last night, just to test, so it could be this as the reason for useApplicationDefaultCredentials:\nif( $client->isAccessTokenExpired() ){\n        $cache->clear();\n         $client->refreshTokenWithAssertion();\n   }\nEdit: I did what @chonthu suggested and I just cleared the cache. I started getting results again after that.\n. ",
    "0bp": "We have the same issue with v2.0.3\nif ($client->isAccessTokenExpired()) {\n    $client->fetchAccessTokenWithRefreshToken($refreshToken);\n}\nWe see expired access token and ~30 seconds after fetching a new access token the API responds with \"Invalid Credentials\".\nRe-initialising the client when the access token expires works as a current \"dirty but worky\" solution. \n. ",
    "chonthu": "@omnicodagithub I had the same issue, but I think I have a solution, @bshaffer does some checks for cache in the library prebuilt, can you try this?\n```\n  $cache = new Stash\\Pool(new Stash\\Driver\\FileSystem); // or whatever\n  $client->setCache($cache);\nif( $client->isAccessTokenExpired() ){\n        $cache->clear();\n         $client->refreshTokenWithAssertion();\n   }\n```\n. @bshaffer looking at the github compare with a previous stable version; It seems cache is set always, in memory or filesystem if pool library is available\nThis is why clearing works, since when you clear it makes a brand new token refresh call (which defeats the whole purpose of cache)\nHope this was helpful, maybe I have some time tomorrow I can submit a pull request for the line to check if whats in cache is expired first before using it\n. ",
    "mikegioia": "I just wanted to mention that we're still seeing this error in 2.0.3 (as well as the last 1.x release). The only thing that worked was manually fetching a new access token, as mentioned above. My hack is to do that on the first 401 and retry the API call but I would obviously prefer if this just worked.\nPlease let me know if there's anything you'd like me to provide. I can send stack traces, and I'm using the Calendar API.. ",
    "BVMiko": "I ran into this problem and have been working around it for months; finally got around to tracing down this bug.  The Stash library's response appears to include expired cache data which is properly flagged as a Miss (which could be a benefit for some situations), however the Google Auth library never tests it to confirm it should be used.  This pull request does a proper verification of the response; and allows us to replace hacks like the one suggested in October by @chonthu (which was clearing the entire Stash cache on every hit).  My client setup code now no longer needs to test for expiration or manually refresh the tokens.. ",
    "hfuccillo": "I'm having the same issue! \nWhen I set alt = 'CSV' it throws an exception: throw new Google_Service_Exception(\"Invalid json in service response: $body\");\nIn /src/Google/Http/REST.php line 86.\n. ",
    "etchen99": "This line here says alt is fine:\nhttps://github.com/google/google-api-php-client-services/blob/a80b8ba13130960f1850542c587de165b4480389/src/Google/Service/AdExchangeSeller/Resource/AccountsReports.php#L31\nHowever, these lines are problematic because they try to decode the csv as json:\nhttps://github.com/google/google-api-php-client/blob/43996f09df274158fd04fce98e8a82effe5f3717/src/Google/Http/REST.php#L125-L129\nOne solution is to add another condition here:\nhttps://github.com/google/google-api-php-client/blob/43996f09df274158fd04fce98e8a82effe5f3717/src/Google/Service/Resource.php#L218-L220\nso that it works for csv, in addition to media.  Don't know if it would break other code though.  If this is fine, I can add this and make a pull request.\nThen you'd access the csv using:\n$report = $service->accounts_reports->generate($name, $startDate,\n                $endDate, $optParams);\n$csv = (string) $report->getBody();\nWorks for me.. ",
    "spescina": "I signed it!\n. ",
    "lucacaimi": "I was using an old version of tedvim/stash, PSR-6 support starts from version v0.14.1\nhttps://github.com/tedious/Stash/releases/tag/v0.14.1. ",
    "mwithheld": "Docs on the GitHub main page (README.md) should be updated: remove the reference to Stash, replace with an example for MemoryCache (presumably phpFastCache?).  Please include a link to the MemoryCache source.. ",
    "r4ndsen": "we had the same issue. our workaround was to re-instanciate the client instead of trying to fetch another access token. that solved it for now until google provides a fix\n. ",
    "Kunimaru": "\n// If the token is set to expire in the next 30 seconds.\n\nIt seems to consider delay and might expect you to get time yourself.\nI think this is because \"created\" value depends on timezone.. ",
    "danielemontesi": "I signed it!\n. ",
    "domrachev-insegment": "I just press Download button on main page.\nThanx\n. ",
    "lasselehtinen": "Windows is not case sensitive and Linux is. So try changing the reference to the class Google_Service_Youtube to Google_Service_YouTube.\n. ",
    "AlexandreGerault": "I'm sorry but I don't see any difference... Maybe I didn't understand your answer (I understood for case sensitive).\nEDIT : OHHHHHH ! Thanks ! This is T and not t !!! Thanks !!!\n. @avinash-thombre The library was already installed. It was just a case sensitive issue.. ",
    "schm-dt": "Thanks, @lasselehtinen \ud83e\udd47 . Couldn't for the life of me work out what I had done wrong.. ",
    "avinash-thombre": "It will require Google_Service_YouTube library to make it workout. Try installing the library and this error is particular for libraries.. ",
    "Senegal": "hi! any updates?. ",
    "Champikasampath": "use the constructor\n    $config = [\n      'client_secret' => $credentials['client_secret']->web->client_secret,\n      'client_id' => $credentials['client_secret']->web->client_id,\n      'redirect_uri' => $credentials['client_secret']->web->redirect_uris[0]\n    ];\n    $client = new \\Google_Client($config);. ",
    "DevDGD": "did you find an answer?. ",
    "josh1600": "I am having similar problems and it is wrecking my business... I just can't get the token system working without it overwriting with nulls. Please help!. ",
    "chawker21": "My understanding is that you need to pass a username and password through a grant_type parameter in your URL request.  I havent got it to work myself yet but reading the documentation, it needs to make a callback when the token is expired and be able to log in automatically.  I believe this is so that if you were to log  in on a friends computer you would not want them to access a refresh token so unless you specifically code your username and password into the request it wont grant a refresh token.  you can check this out.\nthis is the oauth 2 documentation.  \nhttps://tools.ietf.org/html/draft-ietf-oauth-v2-22#section-6. ",
    "yasithao3": "\nBesides\n$client->setAccessType('offline');\nNeed to include force prompt to Google return the refresh token:\n$client->setApprovalPrompt('force');\nWorks for me.\n\nOnce done this it will return the refresh_code. That's fine. but when we set setAprrovalPrompt to 'force' every time it shows the consent screen to the user. is there any workaround for this? . ",
    "tomaspinho": "@bshaffer had to hack up my own version of the library to fix this issue with this fix. Why was the PR not merged? :(. looks great! thanks for the response ;). ",
    "teo1978": "I think it was a bug in eAccelerator. I'll be more careful with my language, but (and I'm really doing a great effort to keep my language civil right now) I think you deleted a comment of mine that actually contained a useful workaround.\nPlease restore it. Feel free to edit it to remove profanity (I think it was just one word), but I think deleting it is disproportionate. I won't waste my time rewriting it, but it contained vital information for any user that is affected by the issue and needs a workaround, and I suspect it might even help you diagnose and fix the issue.. > Dear Teo, it looks like you have a bug somewhere, you don't need to create\na new client.\nI guess you have read my deleted comment then. (please would you restore it??)\nWell, it looks to me like you have a bug somewhere. If I don't create a new client, as described in the original post, it doesn't work. If I do, it works. It makes sense that I shouldn't need to create a new client. That's the issue.\nEven if there is something wrong in my code (which I can't see), I should get a sensible exception and/or a json response with a sensible error message. Not an HTML response that is meant for end users of the website, not the API.. I don't understand why you now close the issue and categorize it as question.\nIt's not a question, it's a bug, and the fact that you are unable to reproduce it doesn't make it any less of a bug.. And again, please undelete my comment: it contains a workaround that can be useful to users affected by this issue, which also could give insight into the root cause. There's no reason for it to be deleted.. \nIf it shows there is a deleted comment, there must be a way to undelete it available to the repository admins. If there isn't, please report it as an issue to GitHub because it would be ridiculous.\n@mxdpeep  mentioned creating a new client, which is something he must have read in my comment (unless I'm misunderstanding what he said)\n\nJust post it again\n\nYeah right. . I'll try my best, it's difficult to hold back one's frustration. I don't think I have ever seen anything as poorly documented as Google's APIs and their PHP libraries.\nNow, regarding the issue at hand, I have figured it out in detail.\nThe problem is that, when the user gets redirected back to the application after giving his consent, and the application calls \n$client->authenticate($_GET['code'])\neven if I ALWAYS set 'offline' access, the array returned by getAccessToken() sometimes contains a refresh_token element, sometimes it doesn't.\nIt seems that it only contains the refresh_token when the user grants the application access for the first time (i.e. has to click \"allow\"), or perhaps also when the user gets through the permissions screen a subsequent time (i.e. without having to click \"allow\" because he already authorized the app) if the last token has expired - but not in the other cases.\nNow, to me that is plain wrong (and I'm under the impression this is the API's fault, not the library's, but I'm not 100% sure). But if this is the expected behavior AND there's a good reason for this weird design, then it should definitely be documented and there should be examples.\nThe following workflow, which looks totally reasonable and seems to be pretty much the one suggested by the documentation (actually, the docs say very little about STORING access tokens, and in the examples there's NOTHING, so one can only infer), does not work:\n\nif you had previously stored an access token (the array returned by getAccessToken()), retrieve it and use it (i.e. setAccessToken())\notherwise, redirect the user to Google's auth url\nwhen the user is redirected back to the app with a $_GET['code'], exchange the code for an access token, and store it.\n\nThis only works as long as:\n- the first time you send the user to Google's auth url, you must save the token. You cannot afford to \"miss\" that opportunity, and then send the user to the auth url once more, and save the token on that occasion, because then you will not get the refresh token.\n- you must not send the user to Google's auth url if you already have a token (which includes a refresh_token). One would expect that if you send the user to the authentication page unnecessarily, nothing bad should happen (besides the minor annoyance for the user of going through an unnecessary redirect). But that is not the case. If you already have a valid token that is not expired and you do send the user to the authentication url, he'll come back with a code from which you'll obtain a token that does not contain the refresh_token. So, if you overwrite your stored token array with the fresh one, without inspecting its contents, you'll loose the refresh token.\nSo, you have 2 options:\n A) you carefully observe the caveats above, don't miss the opportunity to save the token the very first time, and make sure to never send the user to the auth url if you already have a token that works\n B) you take special care of storing the refresh_token, and when you exchange a code for a token, if it does not contain a refresh_token and you do have a refresh_token stored previously, you make sure not to delete the old refresh_token, which is still valid. That is, when you obtain an array from getAccessToken() (after calling authenticate()), you must not blindly store it overriding any previous token array you had previously stored. You must make sure that, if you had one that contained a refresh_token and the new one does not contain a refresh_token, the old refresh_token is kept.\nStill, even in case B, which is more robust than A, you cannot afford to miss the opportunity to store the refresh_token the first time, because the next time you may not get it.\nNow, you can't tell me that this is intuitive and that one is supposed to figure this out by reading the current documentation or the examples.\nIf authenticate() simply always fetched a refresh_token together with the access token (as long as the access type is offline), regardless of whether it's the first login or not, one wouldn't have to worry about any of this.. > Hi @teo1978! I think the missing piece of the puzzle is that if you use access type offline and you've already gotten a refresh token at some point in the past, the authorization service will only give you an access token\nExactly, that's the missing piece of the puzzle.\nSo why do you close the issue without adding the missing piece to the documentation?\nThis behavior is far from obvious (indeed it's plain wrong, there's no valid reason why the authorization srvice shouldn't give you a refresh token every time - but I guess that's the API's fault, not the library's) and hence should be thoroughly documented.. ",
    "jane027": "Thanks for giving your solution. I have add my redirect uri in the field mentioned by you. But after adding redirect uri, still got the same issue \"Redirect URI Mismatch\"\nMy Redirect URI is: http://www.teststore.com/module/googleshopping/getrefreshtoken\nWhat's wrong here?. ",
    "hellboy81": "@jane027 How can u solved this problem?. ",
    "redochka": "i have the same problem, how to solve please?. I am extremely sure that I have put the exact same URL. I also checked that there is no trailing white spaces, etc. \nI have already setup perfectly fine this in the past, but today with this URL it's stuck... :(. Same problem with suggestion 1\nThanks for the suggestion 2, but i believe this is not the problem because if i replace vilagem.com with any other domain it works. . > If that doesn't work, try using your front controller so you have a normal URL, i.e. https://www.villagem.com/oauth_redirect\nYou are right !!!\nBut why it is the problem happening only with villagem.com domain ?. The bug was a missing s in (http instead of https) when trying to get the token. I am sorry to have bother you with this. I close the ticket. Thanks Bshaffer for your assistance.. ",
    "alwinaugustin": "Thanks a lot !!!. ",
    "juangonzaq": "i have the same problem, i dont know if this resolved, i need help.... ",
    "stevenscg": "Many refresh tokens do expire, though typically after a large amount of time (weeks, months, years, etc). Also for some systems, the refresh token may be expired after it has been used once. I can't remember if that is per the spec or not.\nI ran into the lack of refresh token issue immediately when I started using this library to access the gmail API in \"offline\" mode (or whatever it is called).\n. @bshaffer Was createBatch working before this PR? I'm on v2.1.2 and about to build some batch operations. Wondering if I need to run against master or wait for a point release or can stay on 2.1.2 for now. . Will do. Haven't had any issues with the Gmail API so far, but will upgrade when the release is cut. Thanks!. @rogervila setAuthConfig accepts an array or a file. Does that solve your issue?. @bshaffer Do you happen to know if the auth_uri and token_uri values from the auth configuration object downloaded from the developer console used by the library?. ",
    "mikejichaow": "Can someone help verify when did this get fix? looks like the current commit is after v2.1.0. What's the plan to have another release? I'd love to have a new release asap since I don't have access to install composer yet. Thanks!. @bshaffer Hey, I thought you guys made tests already. Is there anyway I can get the composer processed autoload files so I can test it? Also, is there a way to set the parameter on how long does the token expire? I know on default its always 3600. . @bshaffer I've been trying to get composer working but got the following errors:\nProblem 1\n    - The requested package google/apiclient No version set (parsed as 1.0.0) is satisfiable by google/apiclient[No version set (parsed as 1.0.0)] but these conflict with your requirements or minimum-stability.\nProblem 2\n    - The requested package minimum-stability could not be found in any version, there may be a typo in the package name.\nWhat are the settings I should use for composer.json?. Got it. Thank you. \nTo test it though, is there a way to set expiration time to be shorter/longer? I tried to just call fetchAccessTokenWithRefreshToken before it expires. It passed and logged in but did not seem to update the token. Even though the file modified time is changed which means it got written to. The token is still the same. Will it only got updated after 3600 s?. @arronhatton did u check if you have the refresh token for the first time u make a call? and the second time (after expired) you should call again and it will give u back the refresh token. my test using it works fine now.. ",
    "Micle86": "bshaffer \u044f \u0441\u0447\u0438\u0442\u0430\u044e \u0447\u0442\u043e \u0444\u0430\u0439\u043b \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c refresh token. ",
    "aaronhatton": "I have updated using Composer and have also downloaded the release manually and am still having issues, please can you advise. Error message I am getting daily is:\nFatal error: Uncaught LogicException: refresh token must be passed in or set as part of setAccessToken. Found my issue, was using OAuth 2.0 for web server instead of server to server. ",
    "calebdelnay": "There is a bug in this PR. The code adds a 'jwt' config key but then uses $this->jwt instead of the correct $this->config['jwt'] when creating the token verifier. A PHP notice is raised:\nNotice: Undefined property: Google_Client::$jwt in Google_Client->verifyIdToken() (line 697 of .../vendor/google/apiclient/src/Google/Client.php).. ",
    "mattsims": "Thank you so much for taking the time to do this @bshaffer, much appreciated!. ",
    "hlaporthein": "Hello @bshaffer , I did exactly as you mentioned above but, the while loop is going infinity. So, I created a log file and logs file shows too many 255 from $response->getHeaderLine( 'Content-Length' ). Could you tell me why I am getting infinity loop.\n```\n//Download in 1 MB chunks\n    $chunkSizeBytes = 1 * 1024 * 1024;\n    $chunkStart     = 0;\n// get the authorized Guzzle HTTP Client from Google_Client\n    $http = $client->authorize();\n// get the file ID and file size\n    $files    = $service->files->listFiles( [\n        'q'      => \"name='photo4.jpg'\",\n        'fields' => 'files(id,size)',\n    ] );\n    $fileId   = $files[0]->id;\n    $fileSize = intval( $files[0]->size );\n// make a call for each chunk and write it to a file\n    $fileHandle = fopen( CO_THEME_DOC_ROOT . '/photo4.jpg', 'a+' );\n    $logs = fopen(CO_THEME_DOC_ROOT .'logs.txt', 'a');\n    do {\n        $chunkEnd   = $chunkStart + $chunkSizeBytes;\n        $response   = $http->request(\n            'GET',\n            sprintf( '/drive/v3/files/%s', $fileId ),\n            [\n                'query'   => [ 'alt' => 'media' ],\n                'headers' => [\n                    'Range' => sprintf( 'bytes=%s-%s', $chunkStart, $chunkEnd ),\n                ],\n            ]\n        );\n        $chunkStart = $chunkEnd + 1;\n        fwrite( $fileHandle, $response->getBody()->getContents() );\n        fwrite($logs, $response->getHeaderLine( 'Content-Length' ) .\"\\n\");\n    } while ( $response->getHeaderLine( 'Content-Length' ) > 0 );\n// close the file handle\n    fclose( $logs );\n    fclose( $fileHandle );\n```. ",
    "daemon-byte": "for reasons I still can't figure out my original credential file creates a JWT signature failure but the 2nd one I generated now never dies so that's good enough for me :) Thanks for solving it so quickly.. ",
    "shalomabitan": "Hi,\nCan you bump google-api-services to v0.11 I'm having some issues with the code base the would be fixed by v0.11. I'm talking about when you run composer it still installs the old composer.json, not the new version you have now.\nFor example, adding parameter field historyTypes to $service->users_history->listUsersHistory($userId, $opt_param); throws an exception (list) unknown parameter: 'historyTypes' which is fixed by version 0.11\nThanks :). ",
    "IDLOCKED": "I signed it!. ",
    "alibehroozi": "Thanks for your attention\ntoken is valid because I return that in every request\nBut every thing I do , I will see \"Forbidden 403\".\nWould you please give me a piece of code that post to google plus page ?\nThe bad thing is I try the google api explorer And I get 403 Forbidden too.\nIf you give me a code that works , You resolve my problem.. Nope. ",
    "sunil-lulla": "Which email address are you using? \nIf the email address of the that you are using ends with gmail.com, then it won't work. The Domains API only works with apps.google.com accounts that use custom domains.. ",
    "BilalBasha": "I need an account in apps.google.com, soo i m going to buy to post in google plus.\nWhich plan i need to buy.???. I need an account in apps.google.com, soo i m going to buy to post in google plus.\nWhich plan i need to buy.???. ",
    "Big-Shark": "I signed it!. ",
    "titanproger": "Thank you!  Works good.. ",
    "dinihou": "hi @bshaffer \nsorry for the late , this my php info\n(i can't attach so i upload )\nhttp://ge.tt/6bcXXRi2\nthank u for helping me bro\n. ",
    "panslaw": "Solved - I hope so\nI added $this->client->getCache()->clear(); before $this->client->setAccessToken($accessToken);. I'm glad I can helped :). ",
    "dodubassman": "Man... You just saved my day. It's been 3 days I'm working this exact same issue doing the exact same query (Country then gender, then Age range). Thanks a lot!. ",
    "Voziv": "Hi,\nI've created a code sample here: voziv/google-api-php-client-1140\nIt makes sense that the raw response is returned when requesting ['alt' => 'media']. However it was not mentioned in the function phpdocs. It's only mentioned in the middle of the function Google_Service_Resource::call()\nThe only reason this came up as an issue originally was due to a change in Guzzle when I updated from an older version to google/google-api-php-client ^2.1 1 year ago.\nPossible Fixes\n- Could add a note in the function comment.\n- Could change the @return Google_Service_Storage_StorageObject to be @return Google_Service_Storage_StorageObject|GuzzleHttp\\Psr7\\Response\n- Refactoring to make file media fetching a separate function. Probably not worth doing until a major release\nNot sure if changing @return is desirable in this case.. ",
    "MarcGuay": "This issue is no longer sporadic, I can no longer connect to the subject account through the service account.. Still not working for me.. Seems like using refresh tokens is the way to go, I'm still working on an implementation that automatically refreshes without the user having to re-authorize.  Some helpful info here: https://github.com/google/google-api-php-client/issues/801.. I am also having this problem.. I believe that the OP is using a service account.  My problem was resolved by \"Delegating domain-wide authority to the service account\" as described here: https://developers.google.com/identity/protocols/OAuth2ServiceAccount#delegatingauthority. @JURALOVE I'm not sure that I understand your question but I don't believe I had to change any code after following the instructions for delegating domain-wide authority.. ",
    "MueR": "Same here.. Well, I know no one will be helped with this comment, but last week as I was about to give up and create a very detailed post here, it suddenly started working for me (and has continued to do so since). I'm only using the Directory and GMail APIs though. . ",
    "jpreston84": "I've had the same issue with the Calendar API. My code is wrapped inside a helper class, but should still be useful...\n$this->client = new \\Google_Client;\n$this->client->setAuthConfig( $this->config->secret );\n$this->client->setScopes( [ \\Google_Service_Calendar::CALENDAR_READONLY ] );\n$this->client->setSubject( $this->config->impersonateUser );\nThe problem here seems to be the scope. Changing from this...\n$this->client->setScopes( [ \\Google_Service_Calendar::CALENDAR_READONLY ] );\n...to this...\n$this->client->setScopes( [ \\Google_Service_Calendar::CALENDAR ] );\n...appears to work. At the least, it's able to access at least one calendar on the domain, and is not throwing the credential error. I have no idea why a read-only scope wouldn't work, and this does seem kind of like a kludge to make things work this way.\nI hope this helps someone else who's facing the same issue.. ",
    "vanBrunneren": "I'm also having this issue with the Drive API\n```\n$client = new \\Google_Client();\n$client->useApplicationDefaultCredentials();\n$client->setScopes([ \\Google_Service_Drive::DRIVE ]);\n$client->setSubject($subjectEmail);\n$service = new \\Google_Service_Drive($client);\n$service->files->get($fileId);\n```\nchanging scopes didn't made any differences..... this became a real blocker for us, we're not longer able to make requests with a system user to our drive files. Is there a way to get around this issue I tried everything I found on google but nothing worked.... I also thought about a solution like this but in every documentation it's described like I'm trying it to, so I really don't know why it is not working like it's described on google. I finally made it\nAfter a couple of trys I realized I was delegating domain-wide-access to the wrong Client-ID. I always thought this should be the same as the \"client_email\" I'm using in the script. But it is really (really, really, really) important, that this is the \"client_id\" (as mentioned in the documentation by the way). This is not an email or a string it's just a simple number you get when you create a key for the Service Account.. Maybe this will help anyone. \nWhen we built the service the user from $client->setSubject($user) was an alias to one of our domain admins, this worked as it should. After that we removed this alias and the email address $user became a \"email-group\". Since this change the error above appeared. When we switched $user back to a valid user with access on the google drive, the service worked again.. ",
    "BunnyHolder": "$this->setCacheConfig([\n            'lifetime' => 0\n        ]);\nAnd scopes only base names like _DRIVE, _CALENDAR etc.. ",
    "cotton9": "I ran into this issue, but was able to resolve it.  Using a service account w/ domain-wide access, I was able to use the Calendar API to list events, but not if I used setSubject to impersonate a user.  \nAlthough I had both of the required Calendar API scopes listed here under my domain-wide scopes, I also had to add ht.ps://www.google.com/calendar/feeds/, which is listed as an \"Apps Script API\" scope.\n. ",
    "sttlte": "I'm having a similar issue. Although I've tried using the alt=media parameter, it downloads a file with a random jumbled name. It looks like the file id, actually.. My files are indeed public. I'm also trying to not use my server bandwidth if that's possible. I've used this Google API link to download the public files: https://www.googleapis.com/drive/v3/files/file-id?alt=media&access_token={access-token}, but the file name comes out to be just the file id. The sharing link you get by setting the files as public is not ideal if the files are bigger than 25mb. Google shows a virus scan warning page if that is so.. I realize that the API provides no means for setting the filename, but people have done this before and they didn't need to set the filename. It just worked right off the bat for them. I can even give you a website as a working example to prove that it is possible.. I was never able to solve this problem. @matiasgq Could you explain your solution a little more in depth for me? Are you using your server bandwidth at all, or are you using blobs?. I need the API because I want to create truly direct download links for any file size. The shareable link only works for up to 25mb sized files, and then there is an intermediate virus scan page. I'd like to use wget or cURL to download drive files directly.. I've tried this before and it didn't work. I think it may have something to do with the cookies. Is there a way I can do this in PHP to automate the process? I need to be able to hand out one link to a group of people and have it work without any fuss. Can you explain how this guy does it?? https://links-safety.com/download.php?id=[file-id]. Are you using a service account?. ",
    "johan-lejdung": "I ended up moving over to google/cloud-storage instead. \nBut yes the fact that I were no longer able to create any signed URLs using the newer version was what was keeping me from upgrading the version. I were talking about JWT claims. I really dont like the idea of sticking to an old and outdated version, just because. \n  . Not really. I used it to sign a URL. All that is mentioned about the removed class Google_Signer_P12 is:\nfirebase/jwt is now used for all JWT signing and verifying. As a result, the following classes have been changed or removed:\n- Removed Google_Signer_P12\n- Removed Google_Verifier_Pem\n- Removed Google_Auth_LoginTicket (see below)\nWhat i would have liked to know, before swapping libs altogether, is how to sign the JWT (eg. what data should be present and in what order).. I haven't worked with this in a long time. So I'm not able to fully answer that. ",
    "mavelar": "I signed it!. ",
    "JURALOVE": "Hello net-tools and MarcGuay\nThank you for all. I'll study your suggestions on the next week and I'll talk about my progresss. One thing more, I'm trying to use a service account.. @MarcGuay  one question. When you have enabled \"Delegating domain-wide ...\", Have you had to make some thing to run??? Thank you for your help. Thank you friends. I have found a solution for my problem, but finally I haven't used service account. ",
    "mohe2015": "I think it means the code is valid just once. You should save the $token var f\u00fcr example in the user's session var after you generated it from the code using fetchAccessTokenWithAuthCode. Then you just have to call setAccessToken with the previous saved token.. ",
    "MiguelQueiroz": "Drive API. But i looks like its V3. ",
    "asmehra95": "i have created an app which which uploads files stored on server to user's drive account. It is working perfectly on localhost, but when i uploaded it to ec2 instance(Linux), It stopped working. It authenticates the users from browser but cant't even list their files. It seems like \n$service->files->listFiles(array(     'q' => \"mimeType='application/vnd.google-apps.folder'\",     'spaces' => 'drive',     'pageToken' => $pageToken,     'fields' => 'nextPageToken, files(id, name)',   ));\nthis particular code doesn't execute on server. Is there a special library that needs to be installed for it. . The issue seemed to be the version of php. It required php7 for execution but 5.4 was not installed. I installed php 7 but version was not compatible with 2.4 version of apache for strange reasons. I uninstalled it and installed apache 2.4 on ec2 instance and everything is working now.. ",
    "mspee": "Sorry, this should be in the services github channel . ",
    "rogervila": "Almost. My idea was to directly pass the json string, without having to json_decode the string before passing it.\nI know is not a big issue, but I like to skip this kind of steps before using a package method. . ",
    "jacurtis": "Thanks to @stevenscg for pointing out that you can pass in an array.  I was trying to do the same thing as @rogervila in that I wanted to create the authjson myself (as opposed to fetching a file).\nI was creating the json in another method by making a PHP array and json_encodeing it into a JSON string. Found out that it attempts to fetch the file instead of recognizing it as a JSON string.\nBut now that I know I can pass an array directly in, that makes it easier. Just removed the json_encode() so that it was getting an actual array and now it works great.  I see no need to change the package.. ",
    "vkisku": "delete the composer.json and other composer related files from the directory and you will be fine. you can also omit ^2.0(version), that will install the latest version if that is what you want.. ",
    "danielhiga": "I also have problems with this. I often have more than a second offset.\nI set leeway before instantiate Google_AccessToken_Verify. But this code overrides my value for 1 second.\n. I signed the CLA just before the pull request.. https://github.com/firebase/php-jwt/blob/master/src/JWT.php\nline 30:  public static $leeway = 0;\n$leeway is not an instance variable, you change the value globally.. this works:\nFirebase\\JWT\\JWT::$leeway = LEEWAY; //some value\n$client = new Google_Client(['jwt' => new Firebase\\JWT\\JWT()]);\nthank you. ",
    "adrienlamotte": "Same here. \nFor the moment I just changed Verify.php to : \n$jwtClass::$leeway += 1;. ",
    "highstrike": "When is this going to get fixed?. ",
    "StenKoning": "Please fix. @mattwhisenhunt . nope\n2018-06-13 15:16 GMT+02:00 Scott Bowler notifications@github.com:\n\nAny word on this?\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/1172#issuecomment-396932857,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ADTjpAcw7OLW7DlH0jJGqQq975uramaOks5t8RCTgaJpZM4McLD7\n.\n. \n",
    "sciamano89": "Please fix. Should take 1 second to add a + in front of an =\n\ud83d\ude01 . ",
    "scottybo": "Any word on this?. @bshaffer please could you review and approve this fix - it's a massive roadblock for us. I've added another issue related to this which some might find useful #1589 . ",
    "yourchoice": "..PHP Fatal error:  Uncaught exception 'Google_Service_Exception' with message '{\n  \"error\": {\n    \"code\": 503,\n    \"message\": \"The service is currently unavailable.\",\n    \"errors\": [\n      {\n        \"message\": \"The service is currently unavailable.\",\n        \"domain\": \"global\",\n        \"reason\": \"backendError\"\n      }\n    ],\n    \"status\": \"UNAVAILABLE\"\n  }\n}. ",
    "kalessil": "I signed it!. Awesome, thank you @bshaffer !. null === $cache does the same, but without operating on calls stack, so it simply faster.\nAnd de-facto using is_null already judged as a bad practice.. isset() faster, e.g. Symfony used it for some performance optimizations, so we just put \"faster\" to fail part of condition at first place. Micro-optimization I would say.. Oh, good catch - fixing it.. ",
    "xgretsch": "So is there genuinely no solution which does the authentication in less than 5000 files?. ",
    "rasiciliano": "Yes i dont understand how to install in my we without composer. thanks @bshaffer i do that!! .  but them i get this \"Parse error: syntax error, unexpected '[' in /home/tripleho/public_html/presite/calendar/vendor/guzzlehttp/psr7/src/functions.php on line 78\"\nits a bug on the API ? \n. ",
    "ManInTheBox": "I signed it!. ",
    "JorricksTU": "How can I be so stupid.. I completely missed the readMe.. Sorry for the annoying issue, please remove it if possible :). ",
    "dluces": "@bshaffer You're absolutely right. This should have been a dependency issue in my project. . I signed it!. ",
    "irasmaster": "Resolved :). @omarllorens @go-yaro In my case, it was a server problem. Puppet updated libc, after what apt should restart dependant services, including php-fpm, but it didn't. So solution was the script to restart PHP after every package update.. ",
    "omarllorens": "@irasmaster Can you explain how did you fixed this error, please?. Thank you @irasmaster !. ",
    "go-yaro": "@irasmaster i have a same error with you. can you talk more about the solution? thx. @ianbarber it works for me. thank you.. ",
    "Paratron": "I had the same error today developing locally in a vagrant box.\nTurns out the vagrant box had network issues after my machine went once to hibernate and back up. I restarted the vagrant instance end everything works fine again!. ",
    "masjoey": "just restart your server from whm. ",
    "ashley7": "Just restart your server. When I was on localhost, Some requests would return that error and sometimes they would pass and return results, but since I went live, I have never seen them, even the speeds increased. ",
    "jrosell": "\nJust restart your server\n\nYou are right. Some system packages were updated but their related services were not restarted. ",
    "Simprosys-InfoMedia": "Hello, We are also getting Same Daily at the same time. So can you someone please help me how to resolver this permanently?. ",
    "dextermb": "I am having the same issue with an undefined index of expires_in at Client.php:480 (isAccessTokenExpired()).\nHere is a quick fix:\nreturn ($created + (isset($this->token['expires_in']) ? $this->token['expires_in'] : 3600 - 30)) < time();. @elvis-hammerulo surely your fix doesn't actually resolve the issue, you're just skipping checking if the access token has expired or not. You're making extra requests where they might not be needed? \ud83d\udc80 . ",
    "elvis-hammerulo": "Thanks dextermb,\nI already resolved the issue by adding  refreshToken() method in order to get the 'expires_in' variable since I'm using laravel socialite on login authentication to get token.       \n$token = $client->refreshToken(Session::get('google_provider_token'));\n$client->setAccessToken($token);\nSo, no need to update the core file everytime the composer updates ran :). ",
    "spydev": "By using the almost same procedure as above I am getting bad request result while inserting offline conversion using google-api-php-client library\nfollowing is the error\n```\nGuzzleHttp\\Psr7\\Response Object\n(\n    [reasonPhrase:GuzzleHttp\\Psr7\\Response:private] => Bad Request\n    [statusCode:GuzzleHttp\\Psr7\\Response:private] => 400\n    [headers:GuzzleHttp\\Psr7\\Response:private] => Array\n        (\n            [Vary] => Array\n                (\n                    [0] => X-Origin\n                    [1] => Origin,Accept-Encoding\n                )\n        [Content-Type] => Array\n            ( [0] => application/json; charset=UTF-8  )\n        [Date] => Array\n            ( [0] => Tue, 09 May 2017 08:53:17 GMT )\n        [Expires] => Array\n            ( [0] => Tue, 09 May 2017 08:53:17 GMT )\n        [Cache-Control] => Array\n            ( [0] => private, max-age=0 )\n        [X-Content-Type-Options] => Array\n            ([0] => nosniff )\n        [X-Frame-Options] => Array\n            ( [0] => SAMEORIGIN )\n        [X-XSS-Protection] => Array\n            ( [0] => 1; mode=block )\n        [Server] => Array\n            ( [0] => GSE )\n        [Alt-Svc] => Array\n            ( [0] => quic=\":443\"; ma=2592000; v=\"37,36,35\")\n        [Accept-Ranges] => Array\n            ([0] => none)\n        [Transfer-Encoding] => Array\n            ([0] => chunked )\n    )\n[headerNames:GuzzleHttp\\Psr7\\Response:private] => Array\n    (\n        [vary] => Vary\n        [content-type] => Content-Type\n        [date] => Date\n        [expires] => Expires\n        [cache-control] => Cache-Control\n        [x-content-type-options] => X-Content-Type-Options\n        [x-frame-options] => X-Frame-Options\n        [x-xss-protection] => X-XSS-Protection\n        [server] => Server\n        [alt-svc] => Alt-Svc\n        [accept-ranges] => Accept-Ranges\n        [transfer-encoding] => Transfer-Encoding\n    )\n\n[protocol:GuzzleHttp\\Psr7\\Response:private] => 1.1\n[stream:GuzzleHttp\\Psr7\\Response:private] => GuzzleHttp\\Psr7\\Stream Object\n    (\n        [stream:GuzzleHttp\\Psr7\\Stream:private] => Resource id #11\n        [size:GuzzleHttp\\Psr7\\Stream:private] => \n        [seekable:GuzzleHttp\\Psr7\\Stream:private] => 1\n        [readable:GuzzleHttp\\Psr7\\Stream:private] => 1\n        [writable:GuzzleHttp\\Psr7\\Stream:private] => 1\n        [uri:GuzzleHttp\\Psr7\\Stream:private] => php://temp\n        [customMetadata:GuzzleHttp\\Psr7\\Stream:private] => Array\n            (\n            )\n    )\n\n)\n```\nfollowing is the my code sample\n``\nputenv('GOOGLE_APPLICATION_CREDENTIALS=/MY-PATH/MY-SERVICE-ACCOUNT-KEY.json');\n$Client = new Google_Client();\n$Client->useApplicationDefaultCredentials();$Client->setScopes(['https://www.googleapis.com/auth/doubleclicksearch']);\n$Http = $Client->authorize();`\n$body = '{\n\"kind\": \"doubleclicksearch#conversionList\",\n\"conversion\": [{\n\"conversionId\": \"'.$_REQUEST['call_id'].'\", \n\"conversionTimestamp\": \"'.strtotime($_REQUEST['call_timestamp']).'\",\n\"segmentationType\": \"FLOODLIGHT\",\n\"clickId\": \"'.$_REQUEST[\"gclid\"].'\",\n\"segmentationName\": \"My Activity Name\",\n\"type\": \"ACTION\",\n\"quantityMillis\": 1\n}]\n}';\n```\nThen I tried http request by using two different methods but getting same result \nmethod 1\n$res = $Http->request('post', 'https://www.googleapis.com/doubleclicksearch/v2/conversion', ['body' => $body]);\nmethod 2\n$res = $Http->post('https://www.googleapis.com/doubleclicksearch/v2/conversion', ['body' => $body]);\nprint_r($res);\nAny help will be appreciated. ",
    "mehdi89": "Not working for me too \nI am trying to https://actions.googleapis.com/v2/conversations:send endpoint \n\n$notification = [\n                                    'userNotification' => [\n                                        'title' => \"Test Action Notificaiton from Backend\"\n                                    ],\n                                    'target' => [\n                                        'userId' => $deviceInfo->notification_sender_id,\n                                        'intent' => $deviceInfo->intent,\n                                        'locale' => 'en-US'\n                                    ]\n                                ];\n                                $url = 'https://actions.googleapis.com/v2/conversations:send';\n                                $response = $httpClient->post($url, ['body' => $notification]);\n\nPlease suggest which way it will work.\nThank you . ",
    "kalifg": "Thank you!. I signed it!. Sorry about that, I misread the error!. ",
    "Chathula": "i tried again.. i can see the requests on Google API Console. but it shows client errros... this is what i get when i try to work...\nGoogle_Service_Exception in REST.php line 118:\n{\n\"error\": {\n\"errors\": [\n{\n\"domain\": \"global\",\n\"reason\": \"forbidden\",\n\"message\": \"Forbidden\"\n}\n],\n\"code\": 403,\n\"message\": \"Forbidden\"\n}\n}. @ir3nicus, we can't post through the normal gmail account.we have to use a gsuite account to get full acess for plusDomain features. i think that we have to access google api through that gsuite account email.. @abraham so then how buffer, hootsuite type websites post the content to the G+. i wanted to do the same thing.... @abraham can i/our company get that too?. ",
    "ir3nicus": "Hello, \nI have the same problem as you. Also \"Forbidden\" status. Have you found any solution? \nThank you in advance. Hello, ok thank you for replay. When I access Plus Domain API.( I launched\nnew app from Google Suite Account). Then every Google user can access it or\nonly users that has Google Suite Account too?\n2017-05-01 18:44 GMT+02:00 Brent Shaffer notifications@github.com:\n\nClosed #1195 https://github.com/google/google-api-php-client/issues/1195\n.\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/1195#event-1064178593,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ADtoqEc_De9pcGOiWvggZsEJpuxM9oGSks5r1gv1gaJpZM4M3oqM\n.\n\n\n--\nPozdrawiam\nMarcin Mazanek\n. ",
    "abraham": "It doesn't matter who creates the Google Console API app. What matters is that the user whose credentials are being used for the request is a paid G Suite user. Last I checked the posted content had to be private to that company as well.. Google has a handful of partners that have elevated access.. As far as I know Google will reach out to any companies they are interested in adding to the program.. 2 isn't needed. Assuming a G Suite organization is configured their users can us any app and post to their domain's Google+ via that app.\nBut basically yes. @gmail.com users can't generally post to Google+ through the API.. ",
    "newhouse": "Just spent a good amount of time reading the G+ docs (likely not well enough) and getting all the OAuth dance, API Console Project stuff, etc, out of the way...only to find that all attempts to use any access_token granted to my app/credentials would be responded to with this same 403 Forbidden:\n{\n    \"error\": {\n        \"errors\": [\n            {\n                \"domain\": \"global\",\n                \"reason\": \"forbidden\",\n                \"message\": \"Forbidden\"\n            }\n        ],\n        \"code\": 403,\n        \"message\": \"Forbidden\"\n    }\n}\nIf I'm understanding correctly what @abraham and @bshaffer have been saying it's that this will never work unless:\n1. I have a G Suite domain set up for my domain (let's say it's example.com).\n2. I have connected my App and my domain example.com to one another.\n3. The User who's gone through the OAuth process and granted my app permissions must be an @example.com User.\nOR\n4. I am considered \"special\" by Google and elevated permissions are granted to my app allowing for free users with @gmail.com, etc, domains to be accessed by my app.\nIs that correct, and is it not enough to do steps 1. and 2. only? If so, I'm afraid this would render all my work on this useless since we'd want to allow arbitrary Users to grant our app access to do things on their behalf.. ",
    "gasserol": "Hi, any idea on how to contact google to become 'special' under point 4 of @newhouse post? . ",
    "Neven-Biruski-DefenseCode": "I signed it!. The easiest way to confirm the vulnerabilities is to visit the provided sample URLs. Even if you only run them on loopback adapter (which usually makes little sense for the production environment ;), the vulnerability can still be abused from any site on the Internet due to missing CSRF protection.\nhtmlspecialchars (according to the php manual) converts special characters to HTML entities. For example, if you take a look at the sample URLs in my first comment (and URL decode them, as php does), by using htmlspecialchars(), you can ensure that during the creation of the response certain characters from the URL become escaped - \" would become \\\", < \\< and > \\>. That will stop most XSS attacks. \nIf the PHP_SELF itself was the point of misunderstanding, please check out how certain webservers handle extra characters after the name of the php script. For example, Apache will happily accept url such as vulnerablesite.com/script.php/\">alert(42) , execute script.php, and the javascript from the url will still end up in PHP_SELF variable.\nFeel free to ask for more clarification if needed.. ",
    "sirdarckcat": "@Neven-Biruski-DefenseCode  thank you for your report. We are tracking this bug internally at b/37360079.. you need to check the return value of the second parameter\nhttp://php.net/manual/en/function.openssl-random-pseudo-bytes.php. ",
    "FrontEndCoffee": "I understand your choice, though I would like to remind you that if you want to eventually do it it might be better to do it early so less code gets broken.. ",
    "sitecarp": "I'm experiencing the same problem. I downloaded the full release v2.1.3 and got this error:\nFatal error: Uncaught exception 'Exception' with message 'This library must be installed via composer or by downloading the full package. . Yep! Sorry about that.. ",
    "jclee100": "Strangely, after I made the change I managed to install without version\nconflict.\nOn Wed, 26 Apr 2017 at 10:14 PM, Brent Shaffer notifications@github.com\nwrote:\n\nThis change actually makes the library requirements more strict and not\nless, so this would not resolve a version conflict.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/1202#issuecomment-297421731,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ADsQdbBHoslYZ5mmN2coTUrotYQPp_Nqks5rz1FJgaJpZM4M_t75\n.\n. \n",
    "ulrichdohou": "I got it. There was another version (the old one) in the project. tks. ",
    "garycarlyle": "I think I tried that but I installed Composer on my shared server with SSH and it all works great now. =). ",
    "ahsan-riaz": "@bshaffer thanks for reply, actually I am using Google_Service_AnalyticsReporting API Client and want to apply limit on maximum results. how can i achieve this?\nAs for Page order I am using following function: setOrderBys()\n. ",
    "beeradmoore": "I signed it!. I signed it!. I signed it! (third times a charm right?). ",
    "KyleWiering": "I've provided an answer on stack overflow, the summary is:\nphp\n$ConversionList = new Google_Service_Doubleclicksearch_ConversionList();\n$conversionList->setKind('doubleclicksearch#conversionList');\n$conversionList['conversion'] = [$conversion]; // iterator magic\nThis issue is potentially close-able. I do not see this as a bug in the google-api-php-client, but error messaging / debug from the client could be better.. ",
    "simonericci": "Whoops, /src folder missing... thanks @bshaffer. Posted on Stack Overflow too, sorry for the off topic.\nThe weird thing is that credentials from google (IAM google service account as application owner) should grant all access (read and write) to FT. I am closing the thread as off topic in any case.\nThanks.. ",
    "induraniv": "Class 'vendor\\Google\\src\\Google\\Google_Client' not found\nApi installed manually, not via Composer.. ",
    "Wakodebe": "I have the same problem, but havent find a solution yet\n. Any help. ",
    "garciacarmonaam": "Did somebody find out a solution finally?. ",
    "ravcing": "php\n\n<prequire 'C:\\xampp\\phpMyAdmin\\vendor\\autoload.php';\nuse Google\\Cloud\\Translate\\TranslateClient;. ",
    "luispinonferrer-capgemini": "Any solution ?. ",
    "tusharzore1": "check the file composer.json\nand add \"vendor/google/apiclient/src/Google\" in classmap array if not exist.\nand run composer dump-autoload\n\"autoload\": {\n        \"classmap\": [\n            \"vendor/google/apiclient/src/Google\"\n        ]\n}. Yeah, Definitely.\nBut somehow laravel framework not able to find class  Google_Client into autoload.php. It needs \nclass mapping via classmap array.. ",
    "Mohamm6d": "I have same error no any one could resolve this ?. ",
    "chandumisti": "i did not get the solution to the above problem.  Uncaught exception 'Google_Service_Exception' with message '{\"error\":{\"errors\":[{\"domain\":\"usageLimits\",\"reason\":\"accessNotConfigured\",\"message\":\"Project 254734002464 is not found and cannot be used for API calls. If it is recently created, enable Google Analytics API by visiting https://console.developers.google.com/apis/api/analytics.googleapis.com/overview?project=254734002464 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.\",\"extendedHelp\":\"https://console.developers.google.com/apis/api/analytics.googleapis.com/overview?project=254734002464\"}],\"code\":403,\"message\":\"Project 254734002464 is not found and cannot be used for API calls. If it is recently created, enable Google Analytics API by visiting https://console.developers.google.com/apis/api/analytics.googleapis.com/overview?project=254734002464 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.\"}}' in /var/www/html/m in /var/www/html/myapi/vendor/google/apiclient/src/Google/Http/REST.php on line 118\n. enable.. but it is showing 0 user in my analytics account\nOn Wed, 23 Jan 2019 at 20:39, Brent Shaffer notifications@github.com\nwrote:\n\n@chandumisti https://github.com/chandumisti\nYou need to enable the Google Analytics API. You can do so by visiting the\nfollowing url:\nhttps://console.developers.google.com/apis/api/analytics.googleapis.com/overview?project=254734002464\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub\nhttps://github.com/googleapis/google-api-php-client/issues/1222#issuecomment-456837290,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AsyY7i_9MaxSdMUwJ7M8tRo2wqbj4boRks5vGHs6gaJpZM4NZP5m\n.\n. \n",
    "arnold12": "I m trying to implement google add group member API and i m getting this error.\nFatal error: Uncaught exception 'Google_Service_Exception' with message '{ \"error\": { \"errors\": [ { \"domain\": \"global\", \"reason\": \"invalid\", \"message\": \"Invalid Input: memberKey\" } ], \"code\": 400, \"message\": \"Invalid Input: memberKey\" } } ' in /var/www/lists/admin/gsuite/google-api-php-client-2.2.2/src/Google/Http/REST.php:118 Stack trace: #0 /var/www/lists/admin/gsuite/google-api-php-client-2.2.2/src/Google/Http/REST.php(94): Google_Http_REST::decodeHttpResponse(Object(GuzzleHttp\\Psr7\\Response), Object(GuzzleHttp\\Psr7\\Request), 'Google_Service_...') #1 [internal function]: Google_Http_REST::doExecute(Object(GuzzleHttp\\Client), Object(GuzzleHttp\\Psr7\\Request), 'Google_Service_...') #2 /var/www/lists/admin/gsuite/google-api-php-client-2.2.2/src/Google/Task/Runner.php(176): call_user_func_array(Array, Array) #3 /var/www/lists/admin/gsuite/google-api-php-client-2.2.2/src/Google/Http/REST.php(58): Google_Task_Runner->run() #4 /var/www/lists/admin/gsuite/google-api-php-client-2.2.2/src/Google/Client in /var/www/lists/admin/gsuite/google-api-php-client-2.2.2/src/Google/Http/REST.php on line 118. ",
    "campbekj": "Check to make sure you set domain-wide delegation on your service account and make sure you authorized your service account inside G Suite. See https://developers.google.com/identity/protocols/OAuth2ServiceAccount?hl=en_US#delegatingauthority. ",
    "bigmethos": "Google Drive using a Delegate token.. ",
    "strarsis": "@upendtu: In related library google-api-php-client-services Street View Publish API is mentioned in code.\nAlthough the source looks simple enough, I am still looking for documentation/API reference for it.. @mattwhisenhunt: An example for publishing/updating photospheres using the google-api-php-client together with google-api-php-client-services, including minimal OAuth, would be a great starting point for me.. ",
    "prtk418": "@bazzhar70 were you able to solve this?\ni am also facing same issue:\nPHP Fatal error:  Uncaught exception 'Google_Service_Exception' with message 'Failed to parse Content-Range header.' in vendor/google/apiclient/src/Google/Http/REST.php:118\n\nStack trace:\n#0 vendor/google/apiclient/src/Google/Http/REST.php(94): Google_Http_REST::decodeHttpResponse(Object(GuzzleHttp\\Psr7\\Response), Object(GuzzleHttp\\Psr7\\Request), NULL)\n#1 [internal function]: Google_Http_REST::doExecute(Object(GuzzleHttp\\Client), Object(GuzzleHttp\\Psr7\\Request), NULL)\n#2 vendor/google/apiclient/src/Google/Task/Runner.php(176): call_user_func_array(Array, Array)\n#3 vendor/google/apiclient/src/Google/Http/REST.php(58): Google_Task_Runner->run()\n#4 vendor/google/apiclient/src/Google/Client.php(788): Google_Http_R in /var/www/html/website-redesign/application/libraries/hla_app_log/vendor/google/apiclient/src/Google/Http/REST.php on line 118\n. ",
    "kocoten1992": "In my case, I was upload a directory :face_with_head_bandage: , something like this:\n$gdrive->resumableUpload('/home/myuser/Downloads');. it was thank to you @levieraf , my code is similar to your, and you said it work, so I take a step back and realize my mistake.\nThe error message was no helping though.. ",
    "duvanvargas": "Im having the same issue\n. ",
    "kevinkhuat": "I am able to replicate the same issue you described. I debugged through the code and I didn't see anything stand out. If I have time this week, I'll try to directly hit the api using Postman to see if I get different results.. @J05HI \nI was able to hit the api directly using Postman, and I was not able to add an expiration time. I didn't see an option to set an expirationTime when creating a new permission. I did see one for updating one\nhttps://developers.google.com/drive/v3/reference/permissions/update\nI tried making a request to update the permission, but I got this message:\n{\n \"error\": {\n  \"errors\": [\n   {\n    \"domain\": \"global\",\n    \"reason\": \"cannotSetExpiration\",\n    \"message\": \"Expiration dates cannot be set on this item.\"\n   }\n  ],\n  \"code\": 403,\n  \"message\": \"Expiration dates cannot be set on this item.\"\n }\n}\nI'm not too sure why the permission can't be set.. ",
    "J05HI": "@kevinkhuat \nOkay great :) . @kevinkhuat \nThanks for your effort! Maybe a bug.\nA Google guy should look at this @bshaffer . @bshaffer\nNoone would like to fix this? . Thanks!\nI hope it'll be fixed soon :) . ",
    "sirsquall": "Thank you for the update :). ",
    "kelaskakap": "It's impossible for now to Post data to Blogger using service account. I get success with Aouth method. I'll close this question. Thank you.. ",
    "ozturkmtn": "how can i do it now?. ",
    "nikky-kajavadara": "i am getting that same error.\nFatal error:  Uncaught GuzzleHttp\\Exception\\ClientException: Client error: POST https://www.googleapis.com/oauth2/v4/token resulted in a 400 Bad Request response:\n{\n \"error\": \"invalid_grant\",\n \"error_description\": \"Bad Request\"\n}\nin vendor/guzzlehttp/guzzle/src/Exception/RequestException.php:111\nplease help.. ",
    "beatscode": "I get the same responses using Google My business api. Errors are incredibly unhelpful. Also no sane way to reproduce the request in the OAuth playground.. ",
    "360noscope": "Oh i didn't copy entire API folder how stupid me~~ :P. ",
    "enzonotario": "I also try with $gClient->setApprovalPrompt('force'); but doesn't work too. \nCan you tell me how is your client? that code is in your api?. I see your code and tryied it. It works perfectly! But I'm using PHP as an API. \nSo, from the client (ionic 3), I get an serverAuthCode, that I send to my PHP API and exchange for an access_token. In that way, using the same code (but without generating an authUrl), I don't get any refresh_token.\nDo you know any way to approach this case?. Yes, I already setted the access type to offline:\nwindow['plugins'].googleplus.login(\n  {\n    'scopes': 'xxx',\n    'webClientId': 'xxx',\n    'offline': true,\n  }, (gPlusResponse) => {\n    // ...\n  }, (errors) => {\n    // ...\n  }\n);\n}\nIt gives me a serverAuthCode that I exchange for a authCode, that works perfectly until it expires. That's why I want to get an refresh_token. But I can't. I don't understand why. All seems to be good.. Thanks so much! I thought that it was a problem of my API (and this library).\nThanks again!. ",
    "zmears": "Did you resolve this issue? I have the same problem with with the My Business API.. ",
    "danielgsims": "Hi @DerManoMann! Are you still having issues with this, and did you try the auth suggestion? If this isn't something we're actively trying to work through still, I'd like to close this issue.. Hi @bizmate and @nukkerone! I saw this comment open up on this closed thread. Seems like a legitimate issue, I'm not sure why it was closed, but let's see if we can figure it out!\nThe Google_Client::fetchAccessTokenWithAuthCode or Google_Client::authenticate sounds like it should do what we want here. @bizmate - Can you walk me through what's happening? \nFollowing the function, it appears to instantiate the OAuth2 Service, sets the authorization code on the service, and attempts to fetch the Auth Token. It looks like the call should use the correct authorization_code grant. \n@bizmate - It might be helpful to step through debug parts of that result?\n. After reading through this @bizmate, it looks like you\u2019re just trying to mix incompatible solutions. I didn\u2019t realize you weren\u2019t obtaining a compatible token in your original request. We\u2019re not able to change the OAuth workflow to accommodate your request. I hope this cleared anything up!. Hi @drrhf. I'm just getting up to speed here and haven't had a chance to look at this one. It sounds like you verified that this is an issue with Guzzle? Have you opened an issue for Guzzle on github? \nI don't know what has changed there between Guzzle versions and PHP versions, but altering vendor code isn't a great solution; composer will inevitably overwrite that file and you will lose your change.\nI will review this in depth soon and verify that we're interfacing with Guzzle correctly. Could you provide me a sample of your code that leads to your stack trace above?. I did a little bit of research here:\nVersion 2 of Monolog is still in development. At the time of writing this comment, it has a beta release in packagist. I looked at compatibility of the library as of this commit: https://github.com/Seldaek/monolog/commit/ebb804e432e8fe0fe96828f30d89c45581d36d07.\nThe PSR-3 Usage of Monolog remains consistent. This library uses the SyslogHandler and StreamHandler for Monolog, which also are consistent, other than type hinting.\nMonolog 2 requires PHP 7.1, so when Version 2 is released, we will need to support Monolog 1.X for lower versions of PHP.. Hey @bochuanWorkland! Sorry we haven't got an answer to you yet. I added some code formatting to your comment to help make it easier to read. I'll start looking into your issue and see if I can find out what's going on.. Hi @robolmos. Thanks for sharing this with us!\nI reviewed the doc for service account access that you shared. It sounds like your issue was specifically by using service account credentials while using sheets, but the documentation uses SQL Admin as an example. The rest of the usage is implied based on the specific service you're using.\nWhen looking at the PHP Quick Start guide for the Sheets API, it covers requiring valid scope: https://developers.google.com/sheets/api/quickstart/php\nI think cross referencing these docs covers how to use sheets with service account credentials, but I will pass this issue onto some others to see what they think! Thanks again.. Hi there @eeahktzugr! I'm sorry to hear you're having some unexpected behavior. If you're still having an issue, could you provide some example code of your problem? Also, could you provide what you were running from the console? I'll help dig into what's going on to see what behavior changed. Thanks!. Hi @ivanfretes. I think having a Google Keep API would be great too! Unfortunately, there isn't one right now. The best way to let the team know you would like an API is by providing feedback through the Google Keep application.\nIf and when they publish an API, we will gladly create a library to help you integrate your PHP applications with it!. Hi @sawmurai! Could you first provide a unit test that fails the problem. It should also help prove that your change fixes any underlying problems. Thanks!. Hey @bshaffer. I'm getting a 404 on your link. Could you double that for me? Thanks!. Hi @marcus-at-localhorst! Unfortunately, we don't have direct support for Firebase Storage in any of our PHP libraries. There might be some options for you to get it working, but it might take a little bit of effort. Firebase Storage is using Google Cloud Storage (you can read about it here: https://firebase.google.com/docs/storage/). You can leverage the Google Cloud PHP library to access storage (https://github.com/googleapis/google-cloud-php), but you will have to handle authorization of your clients yourself.  You can leverage a JWT library (such as https://github.com/firebase/php-jwt) to validate the JWT.\nA second option would be to integrate with the Firebase APIs directly. \nA third option is that you may be able to find a Third Party library on Packagist, but remember that any package from an untrusted vendor is a potential and easily exploitable attack vector for your application.\nA final option would be to look at some other languages. There are official Firebase Admin APIs for NodeJs, Go, Java and Python. \nI know none of these are the greatest solution, but I hope you can find something that works for you!. Hi @sawmurai! Thanks for opening the issue. We'll keep track of it via the PR, I'll try to get to it soon!. Hi @babushona! Thanks for the detailed question. From looking through the Client code, I believe this is the intended behavior. Here's the area in the code that ultimately handles authorization for all of the requests:\nhttps://github.com/googleapis/google-api-php-client/blob/master/src/Google/Client.php#L359-L363\nI hope this helps answer any questions you might have, if not, please let us know!. Hi @ashujangra. Are you having issues with this still?. Hi @chiragvels! It looks like the API only supports sorting by click count descending, which is the default sorting operation. If you need to sort in any other way, you will have to pull all of your data and sort yourself. I hope this helps!\n. @scottybo - Thanks for the info here. I'll do some investigation and find out what we need to change here to keep things working.. ",
    "sypherlev": "Sorry, I'll see if I can explain a bit more. I'm using the API client to make queries to YouTube Analytics in a system built on Yii2, as follows:\nIn the Yii controller constructor:\n$this->client = new \\Google_Client();\n$this->client->setScopes([\\Google_Service_YouTubeAnalytics::YT_ANALYTICS_READONLY, \\Google_Service_YouTubeAnalytics::YT_ANALYTICS_MONETARY_READONLY]);\n$this->client->setAuthConfig(Yii::getAlias('@root').'/client_secret.json');\n$this->client->setDeveloperKey(Yii::$app->params['ytoauth_apikey']);\n$this->client->setAccessType('offline');\n$this->client->setApprovalPrompt('force');\n$this->client->setRedirectUri('http://'.$_SERVER['HTTP_HOST'].'/api/web/youtubeapi/reportoauth');\n$key = file_get_contents(Yii::getAlias('@root').'/key.json');\nif(strlen($key) > 0) {\n    $keyjson = json_decode($key, true);\n    $this->client->setAccessToken($keyjson);\n}\nThen the actual query:\n/* $startDate and $endDate already set in the format Y-m-d */\n$youtube = new \\Google_Service_YouTubeAnalytics($this->client);\n$additional = ['filters' => 'video=='.implode(',', $filters)];\n$additional['dimensions'] = 'month,video';\n$metrics = array('estimatedMinutesWatched,averageViewDuration,views,estimatedRevenue');\n$ids = 'contentOwner=='.$contentowner;\n$results = $youtube->reports->query($ids, $startDate, $endDate, $metrics, $additional);\nI'm condensing it a bit but that's more or less how it goes. I found that the Oauth handshake worked fine, getting and using refresh tokens worked fine, but no other queries to the API worked.\nLine 275 in src/Google/Service/Resource.php has the following check:\nif (isset($paramSpec['repeated']) && is_array($paramSpec['value']))\nThe problem is that if $paramSpec['repeated'] is not set, then execution jumps to line 280 without ever looking at whether $paramSpec['value'] is an array.\nAt line 280:\n$queryVars[] = $paramName . '=' . rawurlencode(rawurldecode($paramSpec['value']));\nThis assumes $paramSpec['value'] is going to be a string. If it's not, then rawurldecode() fails with a warning and the request doesn't work. That's what happened every time I tried to run a query, hence adding in another is_array check to make sure that $paramSpec['value'] will be a string when it hits that line.\nAgain I'm not completely sure if setting $paramSpec['value'] to the first element in the array is a good solution at that point, but it seemed to work okay.. However it gets fixed doesn't matter to me :P I've made that change in the patch.. ",
    "amosmos": "I signed it!. OMG OMG OMG I contributed to a Google package OMG OMG OMG. ",
    "ndom91": "If you try this with the API explorer, it spits out an error about the labels not containing quotes. Try submitting it surrounded in quotes. This is issue I've been having, trying to get it to work in PHP. I've got it working with my labels in the API Explorer so I know it should work technically. However I cant get the labels formatted correctly with quotation marks, etc. in my PHP code in order for the API to accept it. \nY u make this so hard, google?!. ",
    "cubiclesoft": "Your instructions for using Composer are:\ncomposer require google/apiclient:^2.0\nWhich is exactly what I ran before running Decomposer.  Decomposer is a post-Composer tool.  Here's some more output:\n```\n\nphp composer.phar require google/apiclient:^2.0\n./composer.json has been created\nLoading composer repositories with package information\nUpdating dependencies (including require-dev)\nPackage operations: 12 installs, 0 updates, 0 removals\n  - Installing psr/http-message (1.0.1): Loading from cache\n  - Installing guzzlehttp/psr7 (1.2.3): Loading from cache\n  - Installing guzzlehttp/promises (v1.3.1): Loading from cache\n  - Installing guzzlehttp/guzzle (6.2.0): Loading from cache\n  - Installing phpseclib/phpseclib (2.0.6): Loading from cache\n  - Installing psr/log (1.0.2): Loading from cache\n  - Installing monolog/monolog (1.23.0): Loading from cache\n  - Installing firebase/php-jwt (v3.0.0): Loading from cache\n  - Installing google/apiclient-services (v0.13): Downloading (100%)\n  - Installing psr/cache (1.0.1): Loading from cache\n  - Installing google/auth (v0.8): Loading from cache\n  - Installing google/apiclient (v2.0.0): Loading from cache\nphpseclib/phpseclib suggests installing ext-libsodium (SSH2/SFTP can make use of some algorithms provided by the libsodium-php extension.)\nphpseclib/phpseclib suggests installing ext-gmp (Install the GMP (GNU Multiple Precision) extension in order to speed up arbitrary precision integer arithmetic operations.)\nmonolog/monolog suggests installing aws/aws-sdk-php (Allow sending log messages to AWS services like DynamoDB)\nmonolog/monolog suggests installing doctrine/couchdb (Allow sending log messages to a CouchDB server)\nmonolog/monolog suggests installing ext-amqp (Allow sending log messages to an AMQP server (1.0+ required))\nmonolog/monolog suggests installing ext-mongo (Allow sending log messages to a MongoDB server)\nmonolog/monolog suggests installing graylog2/gelf-php (Allow sending log messages to a GrayLog2 server)\nmonolog/monolog suggests installing mongodb/mongodb (Allow sending log messages to a MongoDB server via PHP Driver)\nmonolog/monolog suggests installing php-amqplib/php-amqplib (Allow sending log messages to an AMQP server using php-amqplib)\nmonolog/monolog suggests installing php-console/php-console (Allow sending log messages to Google Chrome)\nmonolog/monolog suggests installing rollbar/rollbar (Allow sending log messages to Rollbar)\nmonolog/monolog suggests installing ruflin/elastica (Allow sending log messages to an Elastic Search server)\nmonolog/monolog suggests installing sentry/sentry (Allow sending log messages to a Sentry server)\ngoogle/apiclient suggests installing tedivm/stash (For caching certs and tokens (using Google_Client::setCache))\nWriting lock file\nGenerating autoload files\nfindstr /msic:\"SubscriberInterface\" *\ncomposer.phar\nvendor\\google\\auth\\src\\Subscriber\\AuthTokenSubscriber.php\nvendor\\google\\auth\\src\\Subscriber\\ScopedAccessTokenSubscriber.php\nvendor\\google\\auth\\src\\Subscriber\\SimpleSubscriber.php\n```\n\nOnly those four files contain references to SubscriberInterface (and the first one is irrelevant).  Guzzle 6.2.0 does not appear to have the interface.  Decomposer hasn't even been run at this point.. ",
    "o0alexela0o": "Found it. The problem is in v3. Not showing those values, but getting all data.\n. ",
    "matiasgq": "Are you sure? Is it not possible to get the downloadUrl parameter?\n. I am trying to do almost the same, could you solve it? @chadismydad \n. I solved it by downloading the file, cached and getting the data it gives me.\n. @chadismydad Sure. Look what I do is try to download the file with curl and get the temporary url that drive gives you, that is to say first you need to have the temporary url that gives you the download button that has drive. Once I have obtained the url that will be something like this https://drive.google.com/uc?export=download&id=$id&confirm=$confirm, I enter by means of curl and get the header location that this url generates for me. And that location, I use it to download. Sorry if you don't understand, I'm using the translator.. Thankiu. ",
    "rpgayatri": "Hi @o0alexela0o I am facing the same issue. How to get the values of those parameters which the API is returning as null? . @Shotster I had a similar issue when I wanted to fetch content of the google drive file. And then I had to dig deeper into the other drive APIs.\nservice = GoogleDocs.getDriveService();             \nExport export = service.files().export(docId, \"text/html\");\nHttpResponse response = export.executeMedia();\nThis piece of code fetched me the document in the response. And then I parsed the response as a String. Hope this could help you in some way.. ",
    "Shotster": "I'm experiencing this as well. The getWebViewLink() and getIconLink() methods (among others) return null. Other methods, such as getName(), do return a value. Can anyone shed some light?\nEDIT: It just occurred to me that this could be a scoping issue. I'll look into it out and report back.. Does not appear to be an issue with OAuth2 scopes! \ud83d\ude15 Thought sure that was it. Oh well.... Thanks, @rpgayatri. What @o0alexela0o said just sunk in - i.e. that v3 of the Drive REST API just doesn't work like it should. Version 2 of the Drive REST API seems to work, but it apparently isn't supported by the PHP client library. This page directs developers to v3, which is broken. \ud83d\ude15. I understand now that since this problem lies with the REST API and not the library, this issue should remain closed.\nFWIW, my work-around was to call the REST API v2 endpoint directly as described in the readme under Making HTTP Requests Directly.. ",
    "watawep23": "Hello,\nI'm new here and i have also experienced this problem and come up with this solution:\n$files = $drive->files->listFiles(array(\n      'q' => \"'root' in parents\",\n      'fields' => 'nextPageToken, files(id, name, webViewLink, mimeType)'\n))->getFiles();\nAdd the \"webViewLink\" in files property.\nHope this helps.. Try this bro.\n```\n$fileMetadata = new Google_Service_Drive_DriveFile(array(\n    'name' => 'My Report',\n    'mimeType' => 'application/vnd.google-apps.spreadsheet'));\n$content = file_get_contents('files/report.csv');\n$file = $driveService->files->create($fileMetadata, array(\n    'data' => $content,\n    'mimeType' => 'text/csv',\n    'uploadType' => 'multipart',\n    'fields' => 'id'));\nprintf(\"File ID: %s\\n\", $file->id);\n```. Hi Matt,\nIt gives me funny characters when i try to upload a file\n\n. ",
    "danoscarmike": "@bshaffer @michaelbausor can you please review?. @chriscct7 apologies for the slow response.  Rest assured we continue to support these libraries.  This notice means that the libraries in this repository are considered mature and complete; so we do not expect to add any more major features.  We will continue to support these libraries, fix bugs, and add minor features as required.  We will also continue to release new versions of all API libraries as they are available; and release new API libraries as new services become available.\nFor those building new php applications using Google Cloud APIs we also encourage you to look at the latest client libraries available on cloud.google.com and developed open-source here on GitHub at googlecloudplatform/google-cloud-php.\nThanks for reaching out!. ",
    "aaronhuisinga": "@bshaffer This would solve a ton of issues with changes to API methods without having to wait for library updates. +1 for getting this merged in ASAP!. ",
    "Feniksss": "I found the solution. https://github.com/google/google-api-php-client/issues/969. ",
    "zmilkman": "NVM - needed to download from https://github.com/google/google-api-php-client/releases instead of downloading the folder.. ",
    "devanghire": "download from that link https://github.com/google/google-api-php-client/releases/google-api-php-client-2.2.2.zip. ",
    "robyone67": "No one can help me? Basically, I found out that I can no longer use google drive apis through a service account, \"impersonating\" an existing user! I've found several similar posts here, but nobody deals with this problem. Does anyone have the same problem?. ",
    "bryannielsen": "I saw a bunch of \"unauthorized_client\" errors recently and I was using the latest version 2.2.0.  After downgrading to 2.1.3 everything is working fine with impersonating users.. ",
    "fingal56": "I'm using current (v0.16) version of google/apiclient-services after composer update. \nMain library google/apiclient is (v2.2.0). I've also tried to downgrade main library to (v.2.1.0) which puts  google/apiclient-services to version (v0.11.0)\nI got same error output \nGoogle_Service_Exception\n{\n\"error\": {\n\"errors\": [\n{\n\"domain\": \"global\",\n\"reason\": \"required\",\n\"message\": \"Missing required field: [resource.applicationDataTransfer]\"\n}\n],\n\"code\": 400,\n\"message\": \"Missing required field: [resource.applicationDataTransfer]\"\n}\n}\nI'm able to manage  users, groups or group members easily. Listing of all performed transfers also works fine. But insert throws that error and it doesn't make much sense to me. . Could anybody at least try to replicate mentioned error ? So I would know if it's a bug or error on my side. Thanks.... Eventually I've got answer from stackoverflow. The issue was with this line\n$newTransfer->setApplicationDataTransfers($appDataTransfer);\nsetApplicationDataTransfers method expects an array of Google_Service_DataTransfer_DataTransfer \nso correct parameter is as array . Now it works as it's supposed to\n$newTransfer->setApplicationDataTransfers([$appDataTransfer]);. ",
    "B-Poignant": "I have same issue, i follow google reference but server side verification fail every time.\nHTML + Javascript \n```HTML\n\n\n    function onSignIn(googleUser) {\n        var profile = googleUser.getBasicProfile();\n        console.log('ID: ' + profile.getId()); \n        console.log('Name: ' + profile.getName());\n        console.log('Image URL: ' + profile.getImageUrl());\n        console.log('Email: ' + profile.getEmail());\n                // ok here, everything is displayed</p>\n<pre><code>    var id_token = googleUser.getAuthResponse().id_token;\n\n    var xhr = new XMLHttpRequest();\n    xhr.open('POST', \"{{URL(\"sessions/sso/google\");}}\");\n    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n    xhr.onload = function() {\n      console.log('Signed in as: ' + xhr.responseText);\n    };\n    xhr.send('idtoken=' + id_token);\n\n  }\n</code></pre>\n<p>\n\n\nPHPPHP\n$id_token = input::post('idtoken');\n$client = new Google_Client(['client_id' => self::client_id]);\n$payload = $client->verifyIdToken($id_token);\nvar_dump($payload);//bool(false)\n```. ",
    "ernofi": "@mvcmaker if you drop the client id argument from the Google_Client-constructor, does it work then? I had this same problem but the reason was I was using wrong client id... @MarsVard yes it does.. @MarsVard If you take a look here:\nhttps://github.com/google/google-api-php-client/blob/d669e0f3b92da94d5b4ed960d462dd3b0de920ea/src/Google/AccessToken/Verify.php#L106-L110\nIt isn't sending the client_id anywhere. It is just comparing it to \"aud\" property of idToken. So you can do like:\n```php\n$idToken = 'EAA....etc...';\n$iosToken = 'client-id-of-ios@googleapis.com';\n$androidToken = 'client-id-of-ios@googleapis.com';\n$client = new \\Google_Client();\n$data = $client->verifyIdToken($idToken);\nreturn $data && in_array($data['aud'], [ $iosToken, $androidToken ]);\n```\n. ",
    "MarsVard": "@ernofi does your verifyToken call work without client_id?. @ernofi @mvcmaker it's working for us without setting a client_id in php, can somebody clarify why the docs are stating otherwise?\nWe are using a different client_id for android and another one for iOS because we generated a different id for each platform.\nAnd on the web-server we don't set any id while calling verifyToken... this works, while it shouldn't in our opinion.... any ideas?\nEdit\nOk, we figured it out.\n1. your clients should use their own client_ids (android and iOS seperately).\n2. your server knows these client_ids and uses these to verify the tokens, depending on the client that sends it.\nSo if your server gets a token from android, it should use the android client_id, if it gets a token from iOS it should use the iOS client_id to verify the token.\nthat's it.\nnote: on iOS you should use an iOS auth client, while on android you should use a web auth client, the android auth client keeps throwing and \"Api exception 10\". @ernofi I know, but using the android client_id in android keeps throwing an \"ApiException: 10\", I'm 100% sure my key sha1 and package name are correct on the developer console. ",
    "oxycoder": "Any idea how to solve this problem?\nI have exactly same situation. Except the verification work on local machine and fail on production server.\nLocal machine running MacOS with LibreSSL 2.2.7\nProduction server running Ubuntu 16.04 with OpenSSL OpenSSL 1.1.0h  27 Mar 2018\nAt this moment, this method work for me on both local and production:\n$verify = new Google_AccessToken_Verify();\n return $verify->verifyIdToken($token);. ",
    "irealme": "Hello CHDuBar, I was having same problem, but you are passing wrong arguments to $mediaUploadAnswer = $plusdomains->media->insert('me', 'cloud', $mediaUpload);. There should be\n$service->media->insert('me','cloud',$file,array(\n                'data' => $file_data,\n                'mimeType' => $file_mime,\n                'uploadType' => 'media',\n            ));\nwhere,\n$file_data = file_get_contents( $file_path);\n$file_title = basename( $file_path);\n$file_mime = $this->mime_content_type($file_title);\n$file = new Google_Service_PlusDomains_Media();\n$file->setDisplayName($file_title);\n$file->setSummary(\"This is {$file_mime} file\");. Let me know if its helpful for you or not \ud83d\udc4d . ",
    "obscurecloud": "This got me going. \nIf you are trying to do a media.insert with the Google Plus API PHP SDK, this is the answer. \nSmall change I had to make though:\n$file_mime = $this->mime_content_type($file_title);\nto \n$file_mime = mime_content_type($file_path);\nIf you are working with remote files, check out the comment:\nhttp://php.net/manual/en/function.finfo-file.php#119467. ",
    "brainslcdevshop": "@irealme thanks, you are help me. \nand \nif need only image upload can type as like under\n$file_mime  = 'image/*';. Scopes\nhttp://i.prntscr.com/IVs4E5yHQLi30sYazCaKNw.png\nGet Token \nhttp://i.prntscr.com/afhAgxzgRz_AflG3fkLgrA.png. @mattwhisenhunt thank you for answer, will check.. ",
    "deepakmittal": "I am facing similar issue. Did you find anything ?. ",
    "vali82": "Unfortunately I think that Authentication with Service Accounts is NOT available for adsense api,\nBUT I used the oauth authentication and saved the temporary token into a file on server (try to save it somewhere that is pretty safe) and each time my cron job try to connect to google adsense api, I'm using this saved token (user action is no longer needed as it was in the first time when the token doesn't exist yet). Even if this token is a temporary one, you can refresh it each time you want. \nSo do not spend any time trying to implement service accounts as authentication for adsense api. . ",
    "eramadani": "you have to deactivate ad blocker. ",
    "NikitaKharkov": "When I wanted to activate Google Ads API I just turn off AdBlock for all sites and It have worked! . @vazgen It's just a chrome extension. So if you added it you have to turn it off.\nGoogle it! :). ",
    "vazgen": "What is ad blocker ? where to deactivate it ?. ",
    "GasparMDQ": "Exactly the same problem here. We patch it putting a constraint on our composer.json not allowing firebase/php-jwt going over version 4.*. @mirko77 \ncomposer.json.txt\n. The PR was accepted and included in the project. By looking at the branches, I seems that will be available on version 2.2.1 (whenever they release it). ",
    "ken-boom": "This was driving me nuts, I was wondering why my Google Signin randomly broken -_-. ",
    "mirko77": "@GasparMDQ could you post your composer.json?. ",
    "kenji-1996": "Any update on this? Should i downgrade my api composer to 2.0?. @bshaffer if my current build is working with a slightly lower version of firebase working is there any reason to update to 2.2.1? or should I sit tight unless theres something in 2.2.1 i see as needed. @thejaswip thanks for the fix, fucking bizzare that official google doc here https://developers.google.com/identity/sign-in/web/backend-auth will lead to this error, I guess with so many projects they deal with these things can happen quite easily.. Seems my friend had an extremely low version of PHP for god knows what reason and refuses to update it on his private server\nI purchased hosting on PHP version 7 and it works perfectly. ",
    "yetithefoot": "Is there any solutions for direct downloads via curl with correct Content-Disposition?. ",
    "chaoticmass": "I am also having a problem with this. Some guidance on this would be appreciated.. Actually, I found this is working for me:\n$folder_metadata = new Google_Service_Drive_DriveFile(array(\n    'name'=>$directory_name,\n    'mimeType'=>'application/vnd.google-apps.folder',\n    'parents'=>array($prop_folder_id),\n    'teamDriveId'=>$job['team_drive_id'],\n    'appProperties'=>array(\n        'prop_id'=>$job['prop_id']\n    )\n));.\n",
    "SanderVanCamp": "Still not getting it. @chaoticmass, could you provide some more context? Could you post the actual call to $service->files->create()? Or even more? I'm really struggling! \nThank you!. ",
    "Inchie": "@chaoticmass @SanderVanCamp The snippet works to create app properties. But the method $driveService->files->listFiles()... don't list the new properties...... ",
    "brynhood": "just for readers who are struggling how to do this:\n$file = new Google_Service_Drive_DriveFile(array(\n            'name'=> \"Hello World!\",\n            'mimeType' => 'application/octet-stream',\n            'uploadType' => 'multipart',\n            'properties' => array('expiredon' => 'test')\n        ));\n        $result2 = $service->files->create(\n            $file,\n            array(\n               'data' => file_get_contents('mylocalfile.pdf'),\n            )\n        );\nand get them back with:\n```\n$filelist=$service->files->listFiles(array(\n'pageSize' => 10, \n'fields' => \"nextPageToken,files(properties,,id,name,size,mimeType,parents)\",\n'q' => 'properties has { key=\"expiredon\" and value=\"test\" }'))->getFiles();\n```. ",
    "m-nienberg": "Me too. See issue #1279 . ",
    "narainsagar": "@serkolch The following issue \"id_token must be passed in or set as part of setAccessToken\" fixed when I provided \"email\" scope.\ni.e., $client->addScope(\"email\");\nreference: https://github.com/google/google-api-php-client/blob/master/examples/idtoken.php\nHope this helps.. ",
    "mahamood": "any help..?. please give me suggestions. ",
    "xtratio": "See https://stackoverflow.com/questions/39314833/google-api-client-refresh-token-must-be-passed-in-or-set-as-part-of-setaccessto. ",
    "bizmate": "I am glad i searched for this but i must say all these edge cases make it really annoying.. Are you trying to use over the air installs?\nR: No credentials over the air (it looks like app specific but mine is a web app)\nAre you trying to interact with the My Business API via JS in the browser and via PHP on the server?\nR: Yes, acquire a type of temporary authentication that i then pass to the PHP backend (ie the refresh and authentication tokens) such that i can interact with the API on behalf of these user offline.\nAre you trying to persist auth between requests to your single page JS app?\nR: Yes, the user has a settings panel to authenticate and configure the resources to use. At this point I see Google architected the authentication with the logic of an access code to convert into auth and refresh tokens. The app then renders also when the user is not authenticated for other public users. I just would like to avoid polling or redirects. Other Oath2, flows for instance are browser embedded, no redirect, once a user is authenticated the JS SDK handles the return of the user with its authentication information or a failure if the user does not accept permissions. \n. hi, do you think the above is feasible? Any further info you would like from me?. @mattwhisenhunt  I always assume some best practices are used and that an object fetched from an API , a DTO, is consistent across different interfaces of the same API (either this being the JS or PHP one). A redirect is not possible in my app. Also polling a different context (for instance checking my backend while waiting for the credentials to be fetched on a separate iframe) feels extremely dirty in 2018. There must be a better way. I hope you guys see where I am coming from.. Hi @mattwhisenhunt why was the issue closed?. @nukkerone maybe open your ticket, it looks like they got upset with my comments. Maybe they will reply to yours with an actual answer. @danielgsims thank you for re-opening. I will try to explain my understanding with further details. \nThe PHP way is to ask users to open the dialog where they authenticate and then the auth code is provided back to php. This is achieved with redirects so when the user connects he/she is sent away from the site and then redirected back when the app is authorised. \nSo assuming the happy path is followed, thus the user has allowed the app access:\n- user on app page clicks on Connect -> this goes to google for authentication (previous page is gone, dead in browser history) and selection of the account. \n- Google redirect back to a redirect page (provided by the app) with the auth code. App can continue to work by using the authcode and exchanging it for access and refresh codes. (this is indeed if using Google_Client::fetchAccessTokenWithAuthCode with ->setRedirectUri('http://MyAppService/code')\nThe problem is that the original app page is a module in a dynamic page where an entry point (so the returning redirecting URL) cannot be implemented. Example, MyAppService is embedded in site SomeOnlineBusiness.com . On SomeOnlineBusiness.com I cannot define an entry point, like\n SomeOnlineBusiness.com/myAppServiceGoogleAuth because my app could be rendered with an Iframe and this information is not passed down to the iframe. Also I dont want to disrupt the original page on SomeOnlineBusiness where the user is waiting for authentication with redirects.\nAlternative, what I would like to achieve instead, Javascript does a similar thing where the auth code is generated within the same javascript context. I tried to get the auth code from MyAppService in Javascript but when I  use it in PHP it fails getting the access and refresh codes.\nThe above is the overall description and I hope provides all the information required. \nI can start sharing further code snippets if required.. Hi @LindaLawton \nTo clarify, I have never said that Javascript does return a refresh token \nJavascript does a similar thing where the auth code is generated within the same javascript context\njavascript\nGoogleAuth.grantOfflineAccess( \n{\nscope: 'https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/plus.business.manage https://www.googleapis.com/auth/plus.me openid email profile'\n} ).then( function(resp){ \nvar auth_code = resp.code; console.log(\"AuthCode:\" + auth_code) \n} \n)\nAbove is largely based on https://developers.google.com/identity/sign-in/web/reference#googleauthgrantofflineaccessoptions \nCan an auth code generated from JavaScript be used in the php call below? \nThe JS example works on my machine but I am wondering if what is mentioned there as auth_code is the same as per wording in the php client and then thus I can use it to exchange it with the access code? \nIt might be confusing but as far as i understand the exchange is\n 1 get auth token (this is by generating a link the user is sent to from PHP)\n 2 exchange (for instance from php sdk) with refresh and access token. \nThis is code is step 2 above\n$client->fetchAccessTokenWithAuthCode($code);\n$accessToken = $client->getAccessToken();\nIt is interesting you just said refresh token that was generated by one client will not work with another (and makes sense because JS can just pop the end user for an access token), but this is not what I am trying to achieve.. > last I knew it was not possible to get a refresh token from client side JavaScript code.\nAs I already mentioned this is not what I am doing or what I am trying to do. I just need to know why the auth token from JavaScript is not working in the PHP client.\n\nAuthorization code - life time around five minutes used in hybrid authorization flow. can only be used once to get the first access token and refresh token\nThis is perfectly fine, I just want to pass this from Javascript to my server and use it instantly in PHP to fetch access and refresh token. This is what is failing right now\nauthorization code, access token and refresh token are all generated based upon the client id , client secret and the user logging in. This is why I don't think you will be able to mix them.\nThis is not a problem, I am using the same client id, secret and handling that same single user interaction in both PHP and JavaScript\nI also don't think this question really belongs here I think you would be better off taking it to stack overflow and reading the rfc for Oauth2.\n\nI would not have opened this ticket if this was not specific to this client, but please close it if you really think this is the case. If you do close it please confirm the why too for the benefit also of any reader.\nOauth2 specifications do not force or expect redirects as a solution and I am trying to work around this as it breaks user experience as detailed above.\n. This is basically the line that is failing at https://github.com/googleapis/google-api-php-client/blob/master/src/Google/Client.php#L192 as it gets no access_code with the auth token from JavaScript. I am really unsure how to proceed. I will have to try further and see what I am missing but as far as I can see everything should be matching, client configuration (id, secrets or api key are about the same account), permissions etc.\nIf you have any idea please let me know. @danielgsims @LindaLawton thank you for your replies. It is a shame the token from JavaScript does not work in the PHP side. This forces the use of redirects and they are very bad for user experience.\nAll other solutions on Oauth based authentication I use or ever publish is always based on a solution that never relies on redirects \nFYI, see how Facebook (Graph API) provides the Login/Connect facility through Javascript SDK and then you can just use the short lived tokens to get permanents tokens with PHP. PHP never gets involved with redirects.\nBye for now. Hi, just a quick update with the link to my Stack Overflow question here https://stackoverflow.com/questions/54349749/google-mybusiness-access-from-webservers-without-redirects. Can documentation be contributed to? It is obvious it is left behind  as it is still using authenticate instead of fetch... methods\n. ",
    "ricardofontanelli": "I signed it!. I signed it!. I signed it!. I signed it!. @bshaffer, is it ok now? Please, where can I report that the service URL at these four pages should be fixed?\n- https://developers.google.com/admin-sdk/directory/v1/reference/channels/stop: service URL and API Explorer;\n- https://developers.google.com/admin-sdk/reports/v1/reference/channels/stop: service URL and API Explorer;\n- https://developers.google.com/admin-sdk/directory/v1/guides/push#stopping-notifications: service URL;\n-https://developers.google.com/admin-sdk/reports/v1/guides/push#stopping-notifications: service URL. Have a look ate the google/apiclient-services classes, all of that classes have the same structure in the constructor method, for example the Google_Service_Calendar: \n$this->rootUrl = 'https://www.googleapis.com/';\n$this->servicePath = 'calendar/v3/';\n$this->version = 'v3';\n$this->serviceName = 'calendar';\nIt means that the rootUrl is the URI of the service (always ended with a slash) and in all service classes the servicePath property ends with \"/\", it means that the old test was testing a behavior that would never happen wioth the servicePath value! I've changed my local environment and there's no problem with the way that the requests are built (Drive. Calendar, Classroom and Directory)!\nThe the main purpose of this PR is that in every service class, each resource returns a property called path, and there are only two cases where the path property starts with \"/\", Google_Service_Directory > Google_Service_Directory_Resource_Channels > stop and Google_Service_Reports > Google_Service_Reports_Resource_Channels > stop. \nFor these two cases, the servicePath property should be overrided for the path value to build the correct service, because the endpoint structure is different of all other class resources. With the current implementation, we can't stop channels signed to Directory and Reports services because the lib creates a wrong endpoint address.. ",
    "lordhyde": "closed. I found that the string needs to be decoded in associative mode to work..",
    "hosamalzagh": "i am so sorry for late\ni ask about google analysis api. i check it now  and i found this \nhttps://www.phpclasses.org/package/7690-PHP-Retrieve-site-statistics-from-Google-Analytics.html. ",
    "gnosis75": "sorry for this!. ",
    "sera527": "@mattwhisenhunt how to find out which argument is invalid?. ",
    "andrey-helldar": "I signed it!. I recreate the clean PR. The problem is that using an offline token, nothing is returned.. I realized reading the table from API Google.Sheets using api key for web-servers.\nI must say that before that I forgot to open access to this table. When access is opened - the data began to be read without problems.\nBUT the problem was that when you called the method isAccessTokenExpired(), it always returned true.. Example:\nThere is a web application that can work with both client_id and api_key.\nThe choice of the authorization method is in the settings (the programmer himself sets the desired value).\nQuestion: how does the code know about the expiration date of the key, if it does not know what it is using - client_id or api_key?. ",
    "MazettePatacaisse": "yessssssssss, i have found the solution! Son like i thaught, Google_Oauth2Service is depreciated since new api^^\nthere's new method!\nThank's to this person....really! he save my time......\nhttps://stackoverflow.com/questions/8326133/google-oauth-2-php-call-to-userinfo?lq=1. ",
    "mvcmaker": "Sorry for the delay. I was stopped with the project and now we have reopened again. This solution fails. The refreshToken method is the call to fetchAccessTokenFromRefreshToken() method. As you can see in the Google_Client this definition throws an LogicException when no refresh_token is present:\n```\n public function fetchAccessTokenWithRefreshToken($refreshToken = null)\n  {\n    if (null === $refreshToken) {\n      if (!isset($this->token['refresh_token'])) {\n        throw new LogicException(\n            'refresh token must be passed in or set as part of setAccessToken'\n        );\n      }\n...\n```\nThis means that if I'm not able to get a refresh_token from whenever be, I will not be able to refresh my access token again. Is this a php limitation?\nThanks,\nDani. Hi @mattwhisenhunt My idea is like I do on facebook api is to keep the same token refreshed via refresh token process, each day or each hour in order that I can interact with the google api from one user all the times I want, by exaplme publishing things in the post's google + user, retrieving the profile photo change, etc... But without refreshing the token I can only use one time, the first time that the android app sends me the id token and get retrieve the user information, then after 1 hour, the id token has no sense to exist in our database.. @mattwhisenhunt the only thing I want is the thing that performs the button in the oauth 2.0 playground online tool (https://developers.google.com/oauthplayground), when you go to step 2, you exchange the authorization code for tokens, and you can press whenever you want the refresh access token in order to renew the id_token and give 3600 seconds of new live. This is what I want to do via php.. @mattwhisenhunt what do you mean with this line of code? Do you mean that must be removed?. In a nutshell, there's no reason that from my php application I can't update the tokens by using refreshToken due I'm using well the setAccessType to offline. Is this correct?. ",
    "voycey": "Ah fantastic - thanks!. ",
    "peterviergutz": "I am upgrading from v2.7 to v2.8 of the  Dfareporting service, which is included in the google/apiclient-services - sorry, missed that in the report.. I can confirm your PR solves the issue - thanks a lot for the quick fix! \ud83d\ude80 . ",
    "NickStarlight": "The example code still wrong.. ",
    "Phobetor": "I signed it!. Hi @bshaffer\nThanks for reviewing the changes. I fixed the return type hint and explained the added return statement.. You are right. I fixed that.. This is about clean code mainly. An indication that the method returns null on purpose and not because someone forgot a statement. PhpStorm for example raises a warning when returns with and without values are mixed.. ",
    "clingle": "Are only methods with \"batch\" in the name able to be batched? I'm not knowledgeable on Google's method-naming standard.\nOur use-case is to allow users to be able to sync contacts between our system and Google, so requiring a request to be made for every single creation during the initial sync of ~2k contacts or more will take quite a bit of time, even if using Guzzle in parallel. Is there a better way to approach that issue if using Google_Http_Batch isn't an option?. We originally were (are) using the Contacts API but we had to write our own library because the api-php-client-services repo has no classes for it, at least that I could find. Contacts appears to be on the path to deprecation because it uses Gdata, and even recommends the People API in its documentation at the top of its main page now. I guess at this point it's a \"wait and see\" if the People API gets more of the batch functionality that is currently present in the Contacts API. Either way, thanks for the help!. I was passing the client as follows:\nphp\n$this->client->setAccessToken($accessToken);\n$this->client->setUseBatch(true);\n$batch = new Google_Http_Batch($this->client);\nBut you mentioning the wrong rootUrl turned out to be helpful. The third parameter of the Google_Http_Batch constructor accepts a rootUrl to use, so the new instance looks like this:\nphp\n$batch = new Google_Http_Batch($this->client, false, 'https://people.googleapis.com');\nI'm almost positive I tried setting the rootUrl previously when attempting to find a solution with no success (perhaps I was incorrectly setting it for each individual request being added to the batch instead of the Google_Http_Batch instance itself) but it appears to be working now. The issue now is hitting the rate limit of the API itself, but I had already submitted a request to have our limit increased so I'm waiting for the results of that. Good find!. ",
    "amosyuen": "Looks like the rootUrl is set incorrectly. It should point to https://people.googleapis.com instead of https://www.googleapis.com\nAre you passing in the client when construction the batch request as in the examples?. ",
    "redcapital": "I signed it!. ",
    "MitsunagaKikuchi": "I had the same problem, but this code seems to work.\nPlease try this.\n```\n            $request = new \\Google_Service_TagManager_Tag();\n            $request->setName('conversion_linker');\n            $request->setType('gclidw');\n            $request->setFiringTriggerId(['2147479553']);   // All Page View\n            $request->setTagFiringOption('oncePerEvent');\n       // No other parameter is required for standard setting\n\n```. ",
    "ravigehlot": "Hello Matt, yes someone is trying to help me though we still haven't arrived on a plausible solution. At this point, I am ditching the PHP client altogether.. ",
    "masayuki14": "I signed it!. Thanks for the mentoring.. ",
    "Konafets": "@Johnhhorton As far as I see in the composer.json the namespace is Google_, not very common to do it that way, but it is not in the global \\ namespace. . I think you should follow the PSR-Standards for namesspaces (PSR-0 and PSR-4) and add a proper vendor name + get rid of underscores in the lib name.\nWhat was your consideration which lead you to the decision to not fix this issue?. ",
    "hawkidoki": "Hello!\nI stumble upon the exact same problem while writing a plugin. Duplicator Pro use an old version of Google_Client(). Would you be kind enough to share you code modification in order to make it work?\nThanks in advance!. ",
    "mmesarina": "@Johnhhorton \nDid you find a workaround for this problem? If so, could you share?\nthank you\n\nI'm working in the context of WordPress plugins. In WordPress, you have no way to control what other plugins are doing. This means that if another plugin is using a library (via copy/paste or composer), developers run the risk of conflicting packages.\nI'm using a utility https://github.com/TypistTech/imposter that modifies namesspaces allowing me to scope all the vendor libaries for my project without creating conflicts.\n\\Google_Client is registered in the global namespace, and I haven't been able to figure how using composer or the utility above to change that (without editing the vendor files manually). This is producing a conflict with a 3rd party plugin that is using an old version of google/apiclient.\nWhile this isn't an issue for single composer projects, it's a massive problem for WordPress plugin development.\nI'm working in the context of WordPress plugins. In WordPress, you have no way to control what other plugins are doing. This means that if another plugin is using a library (via copy/paste or composer), developers run the risk of conflicting packages.\nI'm using a utility https://github.com/TypistTech/imposter that modifies namesspaces allowing me to scope all the vendor libaries for my project without creating conflicts.\n\\Google_Client is registered in the global namespace, and I haven't been able to figure how using composer or the utility above to change that (without editing the vendor files manually). This is producing a conflict with a 3rd party plugin that is using an old version of google/apiclient.\nWhile this isn't an issue for single composer projects, it's a massive problem for WordPress plugin development.\n\n. ",
    "jshrek": "I beleive (but am not 100% sure) that refresh tokens do not expire so that you can always use the refresh token to get a new token. If you display token and refresh token to your screen you should see an EXPIRE field. The Token probably has 3600 (1 hour) as it's expiry. What does Refresh Token show?. Using shared hosting so installing Composer is not an option.\nI am trying to use the SERVICE ACCOUNT KEY setup in Google Developers Console so can access private liveStream and liveBroadcast informaton from YouTube API.\nThere must be a simpler way to do this :(. Shared host wont let me install Composer.\nThe readme file even says to use the require_once '/path/to/google-api-php-client/vendor/autoload.php'; however as I pointed out before, there is no VENDOR folder in the downloaded release v2.2.1\nAnd also, again, if you look at the autoload.php file it is also referencing /vendor/autuload.php and will ALWAYS generate an error.\nAnd the full release also is missing the GuzzleHttp\\ClientInterface class\nEDIT: Posted this before I saw mattwhisenhunt reponse above... trying that now.\n. Copying VENDOR folder from 2.2.0 to 2.2.1 seems to have solved all the problems.\nThanks @mattwhisenhunt \n. Posted issue here:\nhttps://issuetracker.google.com/issues/69732600. ",
    "ggepenyan": "So what's the final answer. I can see it's that refresh token does not expire. Am I correct??. ",
    "UKNC": "You must write your code to anticipate the possibility that a granted refresh token might no longer work. A refresh token might stop working for one of these reasons:\nThe user has revoked your app's access.\nThe refresh token has not been used for six months.\nThe user changed passwords and the refresh token contains Gmail scopes.\nThe user account has exceeded a maximum number of granted (live) refresh tokens.\nhttps://developers.google.com/identity/protocols/OAuth2\nYou can try to getAccessToken which will use refresh token for that purpose. If the call fails, that means refresh token is not valid.. ",
    "gladsonrobinson": "Hi @usamamashkoor @mattwhisenhunt Have you got any updates on it.. ",
    "usamamashkoor": "@gladsonrobinson i have to get all the videos then i have to filter out the public videos by my self.. ",
    "centurianii": "Trying to make a social login. The service I enabled was G+ for getting user's profile-email. Sometimes it does work but mostly gives error as in stackoverflow link.\nOne thought I had was about composer as I use my own loader and I do not receive errors for classes not loaded from my code. I understand that some of the dependencies load static files like GuzzleHttp with functions.php but I do load these also. In stackoverflow link I added a full example that easily(?) can someone run with composer running.\nAt the moment I managed to succed in getting user logged in using php-curl but most of the time it needs 2 requests to get user info. What I'm talking about is a replacement of thousand lines of code-the whole library-with just 40-50 lines! \nAnyway, I have to decide if this library worths the effort or I should continue with curl as my next step will be to manipulate Google drive (with curl?). . ",
    "parulkamra": "ok thankyou :-). ",
    "alexej123": "@mattwhisenhunt It works neither for inserting nor for updating. No error response. The events get correctly inserted / updated but with no reminders added. What do you mean by fields? Thanks!. ",
    "Swennet": "What solution did you end up going for @enguerranws ? I have the same issue, I only need a few of the APIs and don't want to add ~20MB of files to my WordPress plugin.. Completely agree with this. Including this API in my project makes development unbearably slow, not to mention the CPU usage when crawling all the PHP files for changes.\nIs there an alternative to using the PHP API? Could I do the same with the JavaScript API instead?. Please reconsider this feature. I do not need the entire ~40MB of the API Client, and it slows down my production environment. Other ways of using the Google API through PHP are poorly documented and using this API is the easiest way to get things working.. Quite easily, allow the user to create a \"build\" including only the sections of the API that they actually use.. I've actually found numerous people complaining about it, both on here and on Stack Overflow.. ",
    "Retalyx": "Same problem here, any information?. ",
    "slaFFik": "You should install the lib via composer require google/apiclient.\nThis Google API client is intended to be used with composer. It will generate a correct autoload file, that you should be using to include the lib in your app.. https://github.com/google/google-api-php-client/issues/1344#issuecomment-346077047. Of course, I was doing exactly that. But for some reason got a response without expires_in, saved it in DB to reuse later, and passed to setAccessToken() which uses the array keys blindly.\nMy main point was that when I use legitimately the API with $client->setIncludeGrantedScopes( false );, the $creds array fron fetch...() method didn't contain the expires_in key, which is required in other parts of your library.. ",
    "squarecandy": "Also experiencing this as an issue on my setup.\nPlease continue to support a non-composer install option going forward.. Thank you!. ",
    "sloboy": "This is the same issue as #1381\nI was stumped for days...please update the readme to reflect different version for non-composer to save others time.  . ",
    "steevec": "Yes, the lead from the google help page give us the wrong zip => google-api-php-client-master.zip without vendor folder\nhttps://developers.google.com/api-client-library/php/start/installation. ",
    "bhuwan81": "oh. ",
    "immyemperor": "Brother, it's just people suck at estimating and prioritizing. I've been stuck with this same issue for two months and received no help.. i am getting scope error on google oauth not for youtube...i don't know why this error is being thrown i have done whatever provided in google signin documentation...this is the first time i am using php for this earlier with android it was working for me even very easy in implementation...so if you could help sorting this issue i will be very thankful to you.. ",
    "ingokasch": "Same here. I stored the original access and refresh token in the database. While using them later the response does not contain the required expires_in index.\nTested on v0.42.\nEDIT:\nI managed to fix the  issue by storing the properties \"created\" and \"expires_in\" in addition to the \"access_token\" and \"refresh_token\" after the initial request:\n$foo->setAccessToken($result['access_token']);\n$foo->setRefreshAccessToken($result['refresh_token']);\n$foo->setAccessTokenCreated($result['created']);\n$foo->setAccessTokenExpiresIn($result['expires_in']);\nOn the next request I create an array containing not only the \"access_token\" (like before), but also the properties \"created\" and \"expires_in\" as stored in the above snipped:\n```\n$this->_accessToken = [\n    'access_token' => $foo->getAccessToken(),\n    'created' => $foo->getAccessTokenCreated(),\n    'expires_in' => $foo->getAccessTokenExpiresIn(),\n];\n$this->_client->setAccessToken($this->_accessToken);\n```\nI my case it was an error in my implementation, the api is working as expected.\nsolved.",
    "obayesshelton": "that worked for me! I was passing the token as a string than the json which included the refresh etc . ",
    "deviantintegral": "I signed it!. ",
    "artemiusgreat": "If I comment line with setAuthConfig() I'm getting response with some empty object.\n```\nGoogle_Service_Firestore_BatchGetDocumentsResponse Object\n(\n    [foundType:protected] => Google_Service_Firestore_Document\n    [foundDataType:protected] => \n    [missing] => \n    [readTime] => \n    [transaction] => \n    [internal_gapi_mappings:protected] => Array\n        (\n        )\n[modelData:protected] => Array\n    (\n    )\n\n[processed:protected] => Array\n    (\n    )\n\n)\n```. Probably not an issue. \nI was an \"editor\" in FireStore, went to the page with a list of Service Accounts and created a new one for my project, looks like credentials of editor was not enough.\nThen I went to FireStore Console >> Project Settings >> FireBase Admin SDK >> Generate New Private Key. This generated JSON credentials for Service Account created by \"owner\"\nNow I'm getting response as shown above, so HTTP request works fine, just can't figure out why Response doesn't display all collections in my FireStore.. I don't know why neither batchGet nor getCollectionIds worked for me, but I managed to get list of documents for specific collection using get() method\n$response = $store->projects_databases_documents->get($location . '/documents/dictionaries');. ",
    "RobbMLewis": "Thank you!  I was trying to update older code when it wasn't returned all at once.  . ",
    "kevinszuchet": "I have the same problem, if I use the refreshToken method it returns me an invalid_grant error\nI use revokeToken and go to the consent screen every time the token expires (but obviously this way is quite annoying).. ",
    "ardabeyazoglu": "@mattwhisenhunt I get the same error with fetchAccessTokenWithAuthCode. This was working some time ago.. ",
    "zim32": "Have this bug too in 2.2.2. Reverting to previous versions helps me. ",
    "msolters": "Oh, didn't mean to open this on the upstream branch! Disregard. ",
    "luizcarlospedrosogomes": "using the docs i get number impressions for date, i do use the docs. for get impressios i see example python.\nfor indexed i use this code:\n\ndebug($sitemaps->listSitemaps(\"http://www.dimba.com.br/\"));\n\nbut return :\nobject(Google_Service_Webmasters_SitemapsListResponse) {\n    [protected] collection_key => 'sitemap'\n    [protected] internal_gapi_mappings => array()\n    [protected] sitemapType => 'Google_Service_Webmasters_WmxSitemap'\n    [protected] sitemapDataType => 'array'\n    [protected] modelData => array(\n        'sitemap' => array(\n            (int) 0 => array(\n                'path' => 'http://www.dominui.com.br/sitemap.xml',\n                'lastSubmitted' => '2017-12-31T17:06:56.592Z',\n                'isPending' => false,\n                'isSitemapsIndex' => false,\n                'type' => 'sitemap',\n                'lastDownloaded' => '2018-01-03T11:42:39.262Z',\n                'warnings' => '0',\n                'errors' => '0',\n                'contents' => array(\n                    (int) 0 => array(\n                        'type' => 'web',\n                        'submitted' => '4',\n                        'indexed' => '0'\n                    )\n                )\n            )\n        )\n    )\n    [protected] processed => array()\n}\nI need the indexed page number to be associated with a date.\nI also need the date range to be sent as a parameter.\njust as it is in\nhttps://www.google.com/webmasters/tools/index-status?hl=pt-BR&siteUrl={mydominio}\n\nbasically it is exactly as it is in the graph of indexed pages of google.\nI already read the documentation and found nothing.\nI also tried crawling directly on the google page, but with no success.\nAny more ideas? will it be that google api does not let you get the graph of indexed pages?. \nBasically the api documentation does not say there is a return for indexing. just for click, position, ctr and print.\nI am deducing this simple functionality does not exist in google api.\nIs that right?. Thanks for the answers.\nis there a way to get the index status graph?\nI would have an example, it could be in another API or language, for me to adapt.\nthank you. https://webmasters.googleblog.com/2018/01/introducing-new-search-console.html. ",
    "vijayp4you": "Issue resolved. \nwhen we remove service account email id. still site is linked with that email id under permission level unverified account.\nif you want to delete site from webmasters linked with service account first u need to remove the service account emailid then u can delete it. \nelse error will come.\n. if site is removed by delete the site or domain expired.  still it is displaying in list of sites.\nhow to hide the sites which are not in webmaster tools. ",
    "umerpervaiz12": "    In codeigniter controller construct\n    ```\n  ```\n\ninclude_once APPPATH.\"libraries/google-api-php-client/Google_Client.php\";\n        include_once APPPATH.\"libraries/google-api-php-client/contrib/Google_Oauth2Service.php\";\n```\n        // Google Project API Credentials\n        $clientId = 'sdsd';\n        $clientSecret = 'sdsdsd';\n        $redirectUrl = 'http:/xyz.com/online_marketplace_controller/google_login';\n    // Google Client Configuration\n    $gClient = new Google_Client();\n    $gClient->setApplicationName('Login to Pustera.com');\n    $gClient->setClientId($clientId);\n    $gClient->setClientSecret($clientSecret);\n    $gClient->setRedirectUri($redirectUrl); \n    $google_oauthV2 = new Google_Oauth2Service($gClient);\n\n    $this->session->set_userdata('auth_google', $gClient->createAuthUrl());\n\n// here google login function\npublic function google_login(){\n    // Include the google api php libraries\n     $this->load->model('online_marketplace_model');\n\n    if(isset($_REQUEST['code'])) {\n    $gClient->authenticate();\n    $this->session->set_userdata('token', $gClient->getAccessToken());\n    redirect($redirectUrl);\n}\n\n     $token = $this->session->userdata('token');\n    if(!empty($token)) {\n    $gClient->setAccessToken($token);\n     }\n\n   if($gClient->getAccessToken()) {\n    $userProfile = $google_oauthV2->userinfo->get();\n    // Preparing data for database insertion\n    $userData['oauth_provider'] = 'google';\n    $userData['oauth_uid'] = $userProfile['id'];\n    $userData['first_name'] = $userProfile['given_name'];\n    $userData['last_name'] = $userProfile['family_name'];\n    $userData['email'] = $userProfile['email'];\n     $userID = $this->online_marketplace_model->checkUser($userData);\n\n    // Insert or update user data\n    }\n     redirect('online_marketplace_controller/index');\n\n}\n```. ",
    "hugochinchilla": "My mistake,\na comment on a monolog Issue made me think there was a version 2 and while trying to install it with composer the error was a conflict with this library instead of the fact of the version being inexistent.\nSorry for the noise.. ",
    "prashanth-sams": "Thank you @mattwhisenhunt; I opened a ticket on the above link on Jan 18th; and haven't heard back yet. Would be great if you can escalate this issue since it affects our productivity.\nhttps://issuetracker.google.com/issues/72137085. ",
    "aa-ahmed-aa": "with the code above i can replace the last 12 line with the code that lists all of the contacts in my account and it works successfully \nhere is the code i can put and it works successfully \n```php\n$optParams = array(\n    'pageSize' => 10,\n    'personFields' => 'names,emailAddresses',\n);\n$results = $service->people_connections->listPeopleConnections('people/me', $optParams);\nif (count($results->getConnections()) == 0) {\n    print \"No connections found.\\n\";\n} else {\n    print \"People:\\n\";\n    foreach ($results->getConnections() as $person) {\n        if (count($person->getNames()) == 0) {\n            print \"No names found for this connection\\n\";\n        } else {\n            $names = $person->getNames();\n            $name = $names[0];\n            printf(\"%s \\n\", $name->getDisplayName());\n        }\n    }\n}\n```. ",
    "brianjcollins": "I wasn't able to figure it out so  I decided to spend my time on creating the FCM service files.  Works like a champ now.  . For what it's worth... I figured I would add a gist containing the couple files I created to use the service to send notifications until FCM is added to the official services repo.\nhttps://gist.github.com/brianjcollins/eb12662799ecb09beeeffa70a663765d. This is great and I would totally use this if I needed to do it again.. ",
    "Repox": "I had the same issue and your proposed solution gave me an idea on how to solve it by making requests directly:\nhttps://gist.github.com/Repox/64ac4b3582f8ac42a6a1b41667db7440\nI hope this helps someone.. ",
    "Saqibm128": "I signed it!\n. Sorry I think I was using master instead of a specific version. On master, they made this change, which was causing this issue for me.. Specific line on master.\nhttps://github.com/phpseclib/phpseclib/blob/master/phpseclib/Crypt/RSA.php#L467. Entirely my mistake. Accidentally manually placed wrong version of phpseclib into the vendor folder. Closing request. Thank you. ",
    "ginc": "Stack trace for the same issue: \n```\nGuzzleHttp\\Handler\\CurlFactory::release() - ROOT/vendor/guzzlehttp/guzzle/src/Handler/CurlFactory.php, line 67\n--\n\u00a0 | GuzzleHttp\\Handler\\CurlFactory::finish() - ROOT/vendor/guzzlehttp/guzzle/src/Handler/CurlFactory.php, line 107\n\u00a0 | GuzzleHttp\\Handler\\CurlHandler::__invoke() - ROOT/vendor/guzzlehttp/guzzle/src/Handler/CurlHandler.php, line 43\n\u00a0 | GuzzleHttp\\Handler\\Proxy::GuzzleHttp\\Handler{closure}() - ROOT/vendor/guzzlehttp/guzzle/src/Handler/Proxy.php, line 28\n\u00a0 | GuzzleHttp\\Handler\\Proxy::GuzzleHttp\\Handler{closure}() - ROOT/vendor/guzzlehttp/guzzle/src/Handler/Proxy.php, line 51\n\u00a0 | GuzzleHttp\\PrepareBodyMiddleware::__invoke() - ROOT/vendor/guzzlehttp/guzzle/src/PrepareBodyMiddleware.php, line 72\n\u00a0 | GuzzleHttp\\Middleware::GuzzleHttp{closure}() - ROOT/vendor/guzzlehttp/guzzle/src/Middleware.php, line 30\n\u00a0 | GuzzleHttp\\RedirectMiddleware::__invoke() - ROOT/vendor/guzzlehttp/guzzle/src/RedirectMiddleware.php, line 68\n\u00a0 | GuzzleHttp\\Middleware::GuzzleHttp{closure}() - ROOT/vendor/guzzlehttp/guzzle/src/Middleware.php, line 57\n\u00a0 | GuzzleHttp\\HandlerStack::__invoke() - ROOT/vendor/guzzlehttp/guzzle/src/HandlerStack.php, line 67\n\u00a0 | GuzzleHttp\\Client::transfer() - ROOT/vendor/guzzlehttp/guzzle/src/Client.php, line 275\n\u00a0 | GuzzleHttp\\Client::sendAsync() - ROOT/vendor/guzzlehttp/guzzle/src/Client.php, line 97\n\u00a0 | GuzzleHttp\\Client::send() - ROOT/vendor/guzzlehttp/guzzle/src/Client.php, line 104\n\u00a0 | Google\\Auth\\HttpHandler\\Guzzle6HttpHandler::__invoke() - ROOT/vendor/google/auth/src/HttpHandler/Guzzle6HttpHandler.php, line 34\n\u00a0 | Google\\Auth\\OAuth2::fetchAuthToken() - ROOT/vendor/google/auth/src/OAuth2.php, line 501\n\u00a0 | Google_Client::fetchAccessTokenWithAuthCode() - ROOT/vendor/google/apiclient/src/Google/Client.php, line 191\n```\nIt seems that this issue has been already been solved in guzzle https://github.com/guzzle/guzzle/pull/1686, however google api links to a specific version of guzzle which is older than the fix. . ",
    "nickaguilarh": "Same type of error when using:\n$client = new Google_Client(['client_id' => $CLIENT_ID]); \n$payload = $client->verifyIdToken($id_token);\n\"count(): Parameter must be an array or an object that implements Countable\". ",
    "trobaniellu": "The problem is in PHP 7.2 the parameter for count() can't be NULL. The warning in the first post gets displayed when $this->handles equals NULL. Just replace line 67 in CurlFactory.php with the following:\nif (($this->handles ? count($this->handles) : 0) >= $this->maxHandles) {. ",
    "mxdpeep": "Please try upgrading your version of Guzzle.\ns pozdravem,\nFilip O\u0161\u010d\u00e1dal\nOn Mon, Jun 18, 2018 at 8:25 AM Linda Lawton notifications@github.com\nwrote:\n\nLinks to Can't quickstart with PHP for Google Analytics\nhttps://stackoverflow.com/q/50898330/1841839\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/1377#issuecomment-397953716,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAEmXukQxg_rRnAxoTq4eZVZinRpCavNks5t90fggaJpZM4RsLDh\n.\n. 1. create a Service Account and download JSON credentials\n2. share the Sheet for writing with the Service Account\n\nthe working code:\nsettings\n$range = \"Sheet1!A1:Z\";\n$spreadsheetId = $cfg[\"tickets_csv\"]; // actual CSV ID\nclient\n$client = new \\Google_Client();\n$client->setApplicationName($cfg[\"applicationname\"]); // some name\n$client->useApplicationDefaultCredentials();\n$client->setScopes([\\Google_Service_Sheets::SPREADSHEETS]);\n$client->setAuthConfig(ROOT.\"/\".$cfg[\"credentials\"]); // the credentials\nJSON file\n$client->setAccessType(\"offline\");\n$service = new \\Google_Service_Sheets($client);\n$body = new \\Google_Service_Sheets_ValueRange([\"values\" => $values]); //\narray of arrays, each line for a new row\n$params = [\"valueInputOption\" => $cfg[\"valueinputoption\"]]; // \"\nUSER_ENTERED\"\n$result = $service->spreadsheets_values->append($spreadsheetId, $range,\n$body, $params);\ns pozdravem,\nFilip O\u0161\u010d\u00e1dal\nOn Mon, Jun 11, 2018 at 11:53 PM, Matt Whisenhunt notifications@github.com\nwrote:\n\nI haven't been able to reproduce your result. Is it possible you made a\nchange that that empties out $requestBody?\nThe only other thing I would mention is you probably want values in\nanother array so they insert across instead of down:\nnew Google_Service_Sheets_ValueRange([\n    'values' => [$values]\n]);\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/1396#issuecomment-396399392,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAEmXvPaeKAF0G3IdavKraeYBjXX4_Mdks5t7ubIgaJpZM4SmGqk\n.\n.  MIME type of a zip file is application/octet-stream\n\ns pozdravem,\nFilip O\u0161\u010d\u00e1dal\nOn Tue, Jun 5, 2018 at 1:08 PM, Chalda Pnuzig notifications@github.com\nwrote:\n\nHi,\nI have this code:\n$client = new Google_Client();$client->setAuthConfig('file.json');$client->setScopes(array(   Google_Service_Drive::DRIVE,    Google_Service_Drive::DRIVE_READONLY,));$service  = new Google_Service_Drive($client);$fileid = '1GDeQU7mVbipmQlPTTccmznUeJ0AgFyNrGA4TfzTgEys'; // Example spreadsheet file$response = $service->files->export($fileid, 'application/zip', array('alt' => 'media'));$content = $responsedownload->getBody()->getContents();\n$content variable is always empty.\nIf I change application/zip mime to application/pdf or text/csv it works\nwell.\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/1432, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AAEmXgzVcsUkZy1FH2_tZetdqQnGvZgZks5t5mahgaJpZM4UanQE\n.\n. Use Acl: insert to create an access control rule for a user\n- https://developers.google.com/google-apps/calendar/v3/reference/acl\n\n$service = new Google_Service_Calendar($client);\n$calendarListEntry = new Google_Service_Calendar_CalendarListEntry();\n$calendarListEntry->setId($calendarId);\n$createdCalendarListEntry =\n$service->calendarList->insert($calendarListEntry);\necho $createdCalendarListEntry->getSummary();\nI have used Google search on term \"how to share google calendar using php\n\" \ud83d\ude0e\ud83d\ude0e\ud83d\ude0e. this may help:\nhttps://hotexamples.com/examples/-/Google_Service_Calendar_AclRule/setRole/php-google_service_calendar_aclrule-setrole-method-examples.html\ns pozdravem,\nFilip O\u0161\u010d\u00e1dal\nOn Wed, Jun 6, 2018 at 10:50 AM, prafullwizorbit notifications@github.com\nwrote:\n\nHii,\nHere is my code\n$rule = new Google_Service_Calendar_AclRule(); $scope = new\nGoogle_Service_Calendar_AclRuleScope(); $scope->setType(\"default\");\n$scope->setValue(\"sharewithsomeonexyz@gmail.com\");\n$rule->setScope($scope); $rule->setRole(\"reader\");\nany help or suggestion by anyone.\nThanks\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/1434, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AAEmXhN4dDfxBR1kxEoEqIJKotj1jLt4ks5t55e8gaJpZM4UcPpW\n.\n. have you run \"composer update\" first?\n\nhttps://getcomposer.org/doc/01-basic-usage.md\ns pozdravem,\nFilip O\u0161\u010d\u00e1dal\nOn Wed, Jun 20, 2018 at 9:18 PM omermujtaba notifications@github.com\nwrote:\n\nI'm am working on a website, for that I require Google Client API, but I\ncan only use FTP for this.\nI am following this tutorial:\nhttps://developers.google.com/sheets/api/quickstart/php\nWhat have I done\n\ndownloaded the git repo from here:\n   https://github.com/google/google-api-php-client\nPut the repo in my working directory\nRun the quickstart script\n\nError I get\nFatal error: require(): Failed opening required\n'/homepages/2/d723604012/htdocs/anytimesignals.com/vendor/autoload.php'\n(include_path='.:/usr/lib/php7.1') in /homepages/2/d723604012/htdocs/\nanytimesignals.com/index.php on line 2\nPLEASE HELP! :)\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/1463, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AAEmXuNlSeQQ7cDynDkZ8cOzXU6xhRK0ks5t-p_qgaJpZM4Uv1kJ\n.\n. Dear Teo, it looks like you have a bug somewhere, you don't need to create\na new client.\n\ns pozdravem,\nFilip O\u0161\u010d\u00e1dal\nOn Mon, Jul 2, 2018 at 1:46 AM teo1978 notifications@github.com wrote:\n\nI'll be more careful with my language, but (and I'm really doing a great\neffort to keep my language civil right now) I think you deleted a comment\nof mine that actually contained a useful workaround.\nPlease restore it. Feel free to edit it to remove profanity (I think it\nwas just one word), but I think deleting it is disproportionate. I won't\nwaste time rewriting it, and it contained vital information for any user\nthat is affected by the issue and needs a workaround, and I suspect it\nmight even help you diagnose and fix the issue.\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/1474#issuecomment-401641457,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAEmXgfyJ6EZG6S_oj0FibgkFVj6bCz1ks5uCV9UgaJpZM4U-Z3H\n.\n. You add the login_hint parameter with an account value to the\nauthentication request.\n\nps: try Google next time for such a simple question\ns pozdravem,\nFilip O\u0161\u010d\u00e1dal\nOn Thu, Jul 5, 2018 at 5:41 PM edgargaza notifications@github.com wrote:\n\nHey everyone! I would like to ask if there's some way to let the user\nselect an specific account before logging in. In some other apis (like JS)\nit would be an specific provider option called \"prompt\". If you set the\nvalue of this option to \"select_account\", the api will let you to select an\nspecific account, even if you're already logged and/or with only one\naccount \"linked\".\nThank you so much!\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/1478, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AAEmXkvyYUdyln-cTPlH2fUMM5-yp-yoks5uDjOkgaJpZM4VEHby\n.\n. If your public application uses scopes that permit access to certain user\ndata, it must pass review. If you see unverified app on the screen when\ntesting your application, you must submit a verification request to remove\nit. Find out more about unverified apps\nhttps://support.google.com/cloud/answer/7454865 in the Help Center.\n\nI had to go through verification too, just to use \"scope\" => \"profile email\"\nps: the reason of 403 is stated in the error itself\ns pozdravem,\nFilip O\u0161\u010d\u00e1dal\nhttps://fredbrooker.gscloud.cz https://fredbrooker.gscloud.cz\nOn Wed, Dec 26, 2018 at 7:34 PM sharmasandeep410 notifications@github.com\nwrote:\n\n4youplay\nHave you find answer ? I am facing same problem.\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/googleapis/google-api-php-client/issues/1527#issuecomment-450006201,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAEmXrkUmD0Ot_0bk7XSxS-KwZtD6-DUks5u88E3gaJpZM4W5BqD\n.\n. that's not realistic, not gonna happen\n\ud83d\ude36\nyou may code your own library for that purpose, just follow the original\ndocumentation\n\nBTW: mpdf library is 100 MB, so it's not so huge \ud83c\udf1e\ns pozdravem,\nFilip O\u0161\u010d\u00e1dal\nOn Mon, Dec 17, 2018 at 11:54 PM vB Results, LLC. notifications@github.com\nwrote:\n\nI'm only using one API plus authentication and the unzipped size of the\ngoogle api is over 40MB. Please allow us to pick which API's we use so the\nfinal size is smaller.\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/googleapis/google-api-php-client/issues/1569, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AAEmXoJuNpK62kFU7IiCjwExsMZydRpIks5u6CCjgaJpZM4ZXR4t\n.\n. user curl\n\nhttps://developers.google.com/youtube/v3/docs/videos/update\ns pozdravem,\nFilip O\u0161\u010d\u00e1dal\nOn Tue, Dec 18, 2018 at 1:09 AM vB Results, LLC. notifications@github.com\nwrote:\n\nIf I am just using the calls I mentioned (YT update via oauth), is there a\nsafe way to delete what I'm not using?\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/googleapis/google-api-php-client/issues/1569#issuecomment-448046967,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAEmXk8HwETnt2-pL8p-18INeS9pPo6Gks5u6DIpgaJpZM4ZXR4t\n.\n. > Please reconsider this feature. I do not need the entire ~40MB of the API Client, and it slows down my production environment. Other ways of using the Google API through PHP are poorly documented and using this API is the easiest way to get things working.\n\nhow would you split an API client?? :octocat: . out of the 45 MB API client size the Protocol Buffers are responsible for\nwhomping 28 MB\nyou can easily create a script of your own and remove folders not in use\nwithin vendor/google/cloud\nthe biggest folder is just ~ 1 MB in size, 32 folders > actually there's\nnobody other complaining about the size of the client package :D\nFilip O\u0161\u010d\u00e1dal\nhttps://fredbrooker.gscloud.cz/cs https://fredbrooker.gscloud.cz/cs\nOn Sat, Feb 2, 2019 at 2:36 PM Swennet notifications@github.com wrote:\n\nQuite easily, allow the user to create a \"build\" including only the\nsections of the API that they actually use.\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/googleapis/google-api-php-client/issues/1569#issuecomment-459965619,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAEmXutLLXgAz8CwtmMan_QgMKpVS4b-ks5vJZRXgaJpZM4ZXR4t\n.\n. https://bitbucket.org/gscloud/gscloud/src/master/app/v1/LoginPresenter.php\n\nline 35+\ns pozdravem,\nFilip O\u0161\u010d\u00e1dal\nhttps://fredbrooker.gscloud.cz https://fredbrooker.gscloud.cz\nOn Fri, Dec 28, 2018 at 9:10 AM NxKai notifications@github.com wrote:\n\nI've been keeping track of this issue since the news broke out. I found\nthis link here https://stackoverflow.com/a/24510214/10560484 about a\nway to do it just by using the default email scope given. Does anyone know\nhow to use it on the Client Library? Help would be much appreciated. Thanks!\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/googleapis/google-api-php-client/issues/1570#issuecomment-450314263,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AAEmXulx2B9VUEWS9tys5qCg0wRREnk_ks5u9dIJgaJpZM4Zdkw9\n.\n. I am using PHP League for OAuth client, Google+ issues already fixed. the problem is due to the apostrophes IMHO\n\nFilip O\u0161\u010d\u00e1dal\nhttps://fredbrooker.gscloud.cz/cs https://fredbrooker.gscloud.cz/cs\nOn Tue, Jan 29, 2019 at 7:22 PM babushona notifications@github.com wrote:\n\nOS: Windows 10\nPHP Version 5.6.26\nPackage name and version: google-api-php-client v2.2.2\nI want to get list of children under a folder using V3 API.\nhttps://developers.google.com/drive/api/v3/search-parameters\nThis is the code I used. $drive is google_Service_Drive(). I could get the\nstorage quota etc using $drive. So, its already authenticated.\n0ABh5NHZAS9DZUk9PVA is the folder ID whose children I am querying for.\necho \"Child Listing: BEGIN\";\ntry {\n  $files = $drive->files->listFiles(array(\n                                            'q' => \"'0ABh5NHZAS9DZUk9PVA'+in+parents\",\n                                          ))->getFiles();\n  } catch (Google_Exception $e) {\n    echo \"In Catch::ERROR : \" . $e->getMessage();\n  }\n  echo \"Child Listing: END\";\nThis is what Charles captured\n[image: image]\nhttps://user-images.githubusercontent.com/46716000/51928907-fe8f5000-241c-11e9-8886-845e9a37d296.png\nSo, the client library is correctly URL-encoding the queryString. The\nGoogle API server is supposed to decode it back before executing the API\nservice. But it is returning Error.\nThen I tried the same query using Guzzle HTTP Client. Here is the code.\n$folder_id = \"0ABh5NHZAS9DZUk9PVA\";\n$httpClient = new GuzzleHttp\\Client([\n    'proxy' => 'localhost:8888', // by default, Charles runs on localhost port 8888\n    'verify' => false, // otherwise HTTPS requests will fail.\n]);\n    $r = $httpClient ->request('GET', \"https://www.googleapis.com/drive/v3/files\",\n        [\n            'headers' =>  [\n                'Cache-Control'=> 'no-store',\n                'Content-Type' => 'application/x-www-form-urlencoded',\n                'Authorization' => 'Bearer '.$acc_token,\n            ],\n            'query' => ['q' => \"'\".$folder_id.\"'+in+parents\"]\n        ]\n    );\nThis is what Charles captured\n[image: image]\nhttps://user-images.githubusercontent.com/46716000/51929364-10bdbe00-241e-11e9-8eed-b086f6d75568.png\nGuzzle's \"query\" option also performs URL-encoding. Hence same response\nfrom Google API Service.\nThen I tried this code to bypass Guzzle's URL-encoding.\n$folder_id = \"0ABh5NHZAS9DZUk9PVA\";\n$httpClient = new GuzzleHttp\\Client([\n    'proxy' => 'localhost:8888', // by default, Charles runs on localhost port 8888\n    'verify' => false, // otherwise HTTPS requests will fail.\n]);\n$r = $httpClient ->request('GET', \"https://www.googleapis.com/drive/v3/files?q='\".$folder_id.\"'+in+parents\",\n        [\n            'headers' =>  [\n                'Cache-Control'=> 'no-store',\n                'Content-Type' => 'application/x-www-form-urlencoded',\n                'Authorization' => 'Bearer '.$acc_token,\n            ],\n            //'query' => ['q' => \"'\".$folder_id.\"'+in+parents\"]\n        ]\n    );\nAnd Voila, The API worked!!! This is what Charles showed,\n[image: image]\nhttps://user-images.githubusercontent.com/46716000/51930110-d3f2c680-241f-11e9-8509-05a1e1776fcd.png\nSo, when the query String is \"NOT\" URL-encoded, the API service worked.\nIt seems a bug to me...in the Google API service itself, not in PHP client\nlibrary.\nI don't know where bug for Google API should be filed. I believe some\nGoogle folks who developed the API service, are in development team of PHP\nclient library too. Hence filing the bug here with a hope that somebody\nfrom the dev team here will report it to the API dev team.\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/googleapis/google-api-php-client/issues/1588, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AAEmXnyarcft2bJtA9E5iCJietykKy9zks5vIJFEgaJpZM4aYpXw\n.\n. \n",
    "morfinismo": "Domain wide delegation can take up to 24 hours to kick in. So if 24 hours\nhaven't passed, this might be a propagation issue.\n\nFrancisco Morf\u00edn\nWeb Developer\nhttps://mygapps.tools/\nhttps://stackoverflow.com/users/5983596/morfinismo\nhttps://twitter.com/morfinismo\nhttps://plus.google.com/u/0/+FranciscoMorfin9\nOn Tue, Jan 30, 2018 at 3:54 AM, hfrid notifications@github.com wrote:\n\nI have done the following:\n\nCreated a service account with Domain-wide Delegation, downloaded\n   the corresponding .JSON\nSetup https://mail.google.com/ permissions for the client-ID of the\n   account created in step 1.\nInstalled v2.2.1 of google-api-php-client.\n\nTrying to run the following code:\n<?php\n  putenv('GOOGLE_APPLICATION_CREDENTIALS=service-account.json');\n  $client = new Google_Client();\n  $client->useApplicationDefaultCredentials();\n  $client->setScopes('https://mail.google.com');\n  $client->setSubject('user@mydomain.com');\n$google_mail = new Google_Service_Gmail($client);\n  $google_mail->users_messages->listUsersMessages('me');\nGetting \"Client is unauthorized to retrieve access tokens using this\nmethod.\" error.. this is on a Ubuntu server 14.04.5 LTS and PHP 5.5.9\nplease advice!\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/1379, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/APwTbTyVJX9IlmKla5uPM3eS4mAnZh9bks5tPubNgaJpZM4RyC9b\n.\n. \n",
    "hfrid": "Seems like my problem was resolved by adding more scopes to the google admin api rights:\nhttps://mail.google.com/, https://www.googleapis.com/auth/email.migration, https://www.googleapis.com/auth/gmail.insert, https://www.googleapis.com/auth/gmail.labels. ",
    "danielroe": "I'm facing this issue as well. I have followed the instructions on creating a service account, including allowing API access in Cloud Console and adding scopes.\nI have tested the query in API Explorer, and confirmed that it only requires the scopes I have permitted it.\n```$client = new \\Google_Client();\n$client->setApplicationName('My App');\n$client->useApplicationDefaultCredentials();\n$client->setSubject('my@email.com);\n$client->setScopes([\\Google_Service_Directory::ADMIN_DIRECTORY_USER_READONLY]);\n// Option 1\n$service = new \\Google_Service_Directory($client);\n$options = ['domain' => 'my.domain.com'];\n$service->users->listUsers($options);\n// Option 2\n$httpClient = $client->authorize();\n$httpClient->get('https://www.googleapis.com/admin/directory/v1/users?domain=my.domain.com');\n```\nWith option 2, it errors out on making a POST request to https://oauth2.googleapis.com/token, but only on calling $httpClient->get(). An access token is successfully fetched, as is confirmed when I test with the $client->setTokenCallback() method.\nAny help would be most welcome.. ",
    "hbriceno": "FTR, I had a similar issue with \"Client is unauthorized to retrieve access tokens using this method.\" and the fix was to enter the Client ID (ie a number) and not the service account name (blah@...gserviceaccount.com) in the Client Access when authorizing the scopes.. ",
    "gplcart": "Ok found the answer on SO\nhttps://stackoverflow.com/questions/38073640/google-analytics-api-v4-using-php-ordering-output\nThe correct usage\n$order->setOrderType(\"VALUE\");\n$order->setSortOrder(\"DESCENDING\");\nNot so obvious!. ",
    "leemunkiat": "I have download the google-api-php-client folder and upload to my ftp via filezilla, then i using require_once ('/google-api-php-client-2.2.1/vendor/autoload.php' ); to call the folder but it show blank page to me, its possible the path problem or must install using composer?. @LindaLawton i find out the problem why i can direct call the php file by download from here, below are the autoload.php code:\n`<?php\n// autoload.php @generated by Composer\nrequire_once DIR . '/composer/autoload_real.php';\nreturn ComposerAutoloaderInit4bcd804d35cc650d1fb52c557725a2a1::getLoader();\n`\nhow can i got the autoload.php correctly without generate using composer?. @LindaLawton i try the code you provide, i cant find the base.php file, i download the google api php client from here https://github.com/google/google-api-php-client/releases \nI have modify the code it into\nsession_start();\nrequire_once 'google-api-php-client-2.2.1/src/Google/autoload.php');\nits still cant work. Below are my autoload.php code in the Google folder\n`<?php\n/\n * THIS FILE IS FOR BACKWARDS COMPATIBLITY ONLY\n \n * If you were not already including this file in your project, please ignore it\n /\n$file = DIR . '/../../vendor/autoload.php';\nif (!file_exists($file)) {\n  $exception = 'This library must be installed via composer or by downloading the full package.';\n  $exception .= ' See the instructions at https://github.com/google/google-api-php-client#installation.';\n  throw new Exception($exception);\n}\n$error = 'google-api-php-client\\'s autoloader was moved to vendor/autoload.php in 2.0.0. This ';\n$error .= 'redirect will be removed in 2.1. Please adjust your code to use the new location.';\ntrigger_error($error, E_USER_DEPRECATED);\nrequire_once $file;`\nThank you. @LindaLawton Below are my full code\n`<?php \nsession_start();\nrequire_once 'google-api-php-client-2.2.1/src/Google/autoload.php');\n$accessToken = initializeAnalytics();\nfunction initializeAnalytics()\n{\n  $KEY_FILE_LOCATION ='client_secret_917950001739-6vodhfsbpmipoh29fl3f1pkqmo7u9dhv.apps.googleusercontent.com.json';\n$client = new Google_Client();\n  $client -> setApplicationName(\"testing\");\n  $client -> setAuthConfig($KEY_FILE_LOCATION);\n  $client -> setScopes(['https://www.googleapis.com/auth/analytics.readonly']);\n  $client -> refreshTokenWithAssertion();\n  $client -> setAccessType(\"offline\");\n  $client -> setRedirectUri('http://' . $_SERVER['HTTP_HOST'] . '/testing-embed.php');\n  $token = $client->getAccessToken();\n  $accessToken = $token['access_token'];\nreturn $accessToken;\n}\necho $accessToken;\n?>\nhtml\n\n\n\n\n\n\n\n(function(w,d,s,g,js,fs){\n  g=w.gapi||(w.gapi={});g.analytics={q:[],ready:function(f){this.q.push(f);}};\n  js=d.createElement(s);fs=d.getElementsByTagName(s)[0];\n  js.src='https://apis.google.com/js/platform.js';\n  fs.parentNode.insertBefore(js,fs);js.onload=function(){g.load('analytics');};\n}(window,document,'script'));\n\n\n\ngapi.analytics.ready(function() {\n\n  /**\n   * Authorize the user immediately if the user has already granted access.\n   * If no access has been created, render an authorize button inside the\n   * element with the ID \"embed-api-auth-container\".\n   */\n    gapi.analytics.auth.authorize({\n      'serverAuth': {\n        'access_token': '<?php echo $accessToken ?>'\n      }\n    });\n\n\n  /**\n   * Create a new ViewSelector instance to be rendered inside of an\n   * element with the id \"view-selector-container\".\n   */\n  var viewSelector = new gapi.analytics.ViewSelector({\n    container: 'view-selector-container'\n  });\n\n  // Render the view selector to the page.\n  viewSelector.execute();\n\n\n  /**\n   * Create a new DataChart instance with the given query parameters\n   * and Google chart options. It will be rendered inside an element\n   * with the id \"chart-container\".\n   */\n  var dataChart = new gapi.analytics.googleCharts.DataChart({\n    query: {\n      ids: \"168634971\", \n      metrics: 'ga:sessions',\n      dimensions: 'ga:date',\n      'start-date': '30daysAgo',\n      'end-date': 'yesterday'\n    },\n    chart: {\n      container: 'chart-container',\n      type: 'LINE',\n      options: {\n        width: '100%'\n      }\n    }\n  });\n\n\n  /**\n   * Render the dataChart on the page whenever a new view is selected.\n   */\n  viewSelector.on('change', function(ids) {\n    dataChart.set({query: {ids: ids}}).execute();\n  });\n\n});\n\n\n`. ok, thanks for your help!. ",
    "MecOnLine": "Eu assinei!\nOn Wed, Feb 7, 2018 at 3:01 AM, googlebot notifications@github.com wrote:\n\nThanks for your pull request. It looks like this may be your first\ncontribution to a Google open source project. Before we can look at your\npull request, you'll need to sign a Contributor License Agreement (CLA).\n\ud83d\udcdd Please visit https://cla.developers.google.com/\nhttps://cla.developers.google.com/ to sign.\nOnce you've signed, please reply here (e.g. I signed it!) and we'll\nverify. Thanks.\n\n\nIf you've already signed a CLA, it's possible we don't have your\n   GitHub username or you're using a different email address on your commit.\n   Check your existing CLA data https://cla.developers.google.com/clas\n   and verify that your email is set on your git commits\n   https://help.github.com/articles/setting-your-email-in-git/.\nIf your company signed a CLA, they designated a Point of Contact who\n   decides which employees are authorized to participate. You may need to\n   contact the Point of Contact for your company and ask to be added to the\n   group of authorized contributors. If you don't know who your Point of\n   Contact is, direct the project maintainer to go/cla#troubleshoot. The email\n   used to register you as an authorized contributor must be the email used\n   for the Git commit.\nIn order to pass this check, please resolve this problem and have\n   the pull request author add another comment and the bot will run again. If\n   the bot doesn't comment, it means it doesn't think anything has changed.\n\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/pull/1382#issuecomment-363657930,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AiRuEzOtMJKwfj_2sZQ00CnWWx8B8TUMks5tSS4wgaJpZM4R8JXF\n.\n. \n",
    "newincentivesdeveloper": "Why would the scope be different between the two functions? They both are authorized for scope https://www.googleapis.com/auth/drive, which should give me access to everything, according to the documentation.. Thank you! That worked. My scope appears to have been fine.. ",
    "denji": "@LindaLawton  The documentation describes only ::DRIVE https://github.com/google/google-api-php-client#authentication-with-oauth\nphp\nhttps://www.googleapis.com/auth/{drive,spreadsheets,youtube,...}{,readonly}\n....\nGoogle_Service_{Service}::{SERVICESCOPE}. ",
    "dynamicstm": "We did it manually. But we haven't changed the dir structure in such way.\nOn Monday, February 19, 2018, Matt Whisenhunt notifications@github.com\nwrote:\n\nIt looks like that file Userinfoplus.php is installed by composer at\nvendor/google/apiclient-services/src/Google/Service/\nOauth2/Userinfoplus.php.\nDid you flatten those services directories by replacing /'s with _'s?\nAre you letting composer's autoloader handle the includes/requires or are\nyou doing it manually?\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/google/google-api-php-client/issues/1386#issuecomment-366760184,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/ACURvB4tUq1ZiuFxNE0Bz_EmiXUEWwhaks5tWbC3gaJpZM4SKmZr\n.\n\n\n-- \nAbel Seyoum Ar'aya\n+251-912-37-77-21\n+251-91-163-94-70\n\nOcellinet Software Development P.L.C\nYour Partner in Automating Your Domain Expertise\nwww.Ocellinet.com http://www.ocellinet.com/\n\nDynamic S.tm\nDynamic Interactive Solutions\nwww.Dynamicstm.com\nDynamicstm@dynamicstm.com\n\nThe information in this email and in any attachments is CONFIDENTIAL and\nmay be\nPRIVILEGED. If you have received it by mistake, please destroy this message,\ndelete any copies held on your systems and notify the sender immediately;\nyou\nshould not copy it or disclose its contents to anyone. All messages sent to\nand\nfrom Ocellinet Software Development P.L.C, Dzineware and Dynamic Solutions\nmay be monitored to ensure compliance with internal policies and to protect\nour business.\nEmails are not secure and cannot be guaranteed to be error free because\nthey can be intercepted, amended, lost, destroyed or contain viruses.\nAnyone who communicates with us by email is taken\nto accept these risks. The content of any email addressed to our clients is\nsubject to our usual terms of business.\n. ",
    "benparisi19": "Sorry I didn't make it clear in the first post. I am setting maxResults to 50 and using pagination, successfully getting a new pageToken for each page, but the results that are returned when the pageToken is used in a subsequent request return the same 50 channels but a new pageToken.. Ah, they are both bugs with the API! Total of 1000 results with mySubscribers and only duplicate responses with myRecentSubscribers, so that solves the mystery. Where do I go to report a bug with the API?. @mattwhisenhunt Thanks for the info! My code is based on the PHP example for a resumable upload in the API docs, but what that example is missing, and what I still am unable to work out is how resuming a failed upload is meant to work. For example, say your script is executing (it's initialized everything and started sending over chunks), but then something goes wrong and your script stops executing 1/2 way through the video upload. What I am essentially trying to do is use the resume uri to continue sending the next chunk from where we left off rather than restarting everything. I don't know how to do that (if it's even possible because I could be misunderstanding the purpose of the resume uri), because you need $media->resume($resumeUri); to set the resume uri, but you need to call Google_Http_MediaFileUpload again to use $media and to do that you need to call $youtube->videos->insert(\"status,snippet\", $video); again to get $insertRequest to pass to it. I assume doing that just makes YouTube think you're trying to upload a new video, but I don't see any obvious way to store $insertRequest or $media in a database or however for use again if something goes wrong and the script needs to be restarted and the resume uri is going to be used to resume the previously started video upload. Hopefully that all makes sense. I think I have an idea now how to work around it, but it would obviously be nice to understand how it's intended to be used. I suppose I could work it out myself if I could figure out where the code that's called by $youtube->videos->insert(); lives in the library to fully understand what's being returned by that function.. ",
    "timothymarois": "@mattwhisenhunt careful consideration? Really? Meaning you considered remaining obsolete. This API is useless in a modern era. Nonetheless, this API needs a full rewrite anyways. . ",
    "bulgariamitko": "I think my questions is irrelevant and i was not able to find this class using the github search, but i guess it exists and everything is ok. so i am closing my issue as i cant delete it.. ",
    "wubs23": "what is a full stack trace? \nmy php version is 7.2.2\nI am also pretty sure guzzle is version 6, since\nwhen I update guzzle via \"composer update guzzlehttp/guzzle\" it says \n\"Updating dependencies (including require-dev)\nNothing to install or update\nGenerating autoload files\" \n. So.. I am trying to update Guzzle to 6.0.3, but this doesn't work, since it says guzzlehttp/guzzle 6.3.0 requires guzzlehttp/psr7^1.4\nbut if I try to install psr7[1.4] it won't let me, since it says google/auth v0.8 requires guzzlehttp/psr7 1.2. but these conflict with your requirements or minimum-stability.\nSo is there any work-around?. Thank you. This indeed solved the problems.. ",
    "ruvictor": "This solution didn't work form me.... ",
    "vinnoangel": "The problem is in PHP 7.2 the parameter for count() can't be NULL. The warning gets displayed when $this->handles equals NULL. Just replace line 67 in CurlFactory.php with the following:\nif (($this->handles ? count($this->handles) : 0) >= $this->maxHandles) {. ",
    "inandi": "\nThe problem is in PHP 7.2 the parameter for count() can't be NULL. The warning gets displayed when $this->handles equals NULL. Just replace line 67 in CurlFactory.php with the following:\nif (($this->handles ? count($this->handles) : 0) >= $this->maxHandles) {\n\nit worked thanks @vinnoangel . ",
    "billhance": "Does the file exist at vendor/psr/cache/src/CacheItemPoolInterface.php? . If you didn't use composer, how does your autoloader know where to look for the files to load? . ",
    "junelmujar": "Yes, it does exist. Shouldn't it suppose to look at /google-api-php-client-2.2.1/vendor/psr/cache/src/CacheItemPoolInterface.php as it does have one in there? Btw the library was installed by copying the whole folder to the server and not using composer.. ",
    "Dresing": "I thoroughly look through my composer.json file and found a personal error on a package i hadn't upgraded properly, helped to look with fresh eyes. Sincerly my fault and thank you for assistance.. ",
    "scofield-ua": "I had the same error. Installation of newer version solved it:\ncomposer require google/apiclient:^2.2. ",
    "mbougarne": "Thank you Matt!\nIt is worked when I try it using Try this API But when I try with php using cURL i got : \njavascript\n{ \n    \"error\": \n    { \n        \"code\": 400, \n        \"message\": \"Invalid JSON payload received. Unknown name \\\"\\\": Root element must be a message.\", \n        \"status\": \"INVALID_ARGUMENT\", \n        \"details\": [ \n            { \n                \"@type\": \"type.googleapis.com/google.rpc.BadRequest\", \n                \"fieldViolations\": [ \n                    { \n                        \"description\": \"Invalid JSON payload received. Unknown name \\\"\\\": Root element must be a message.\" \n                    } \n                ] \n            } \n        ] \n    } \n}. ",
    "mcannon354": "I have a similar issue with the Google Slides API (PHP). I took Matt's advice and added all three (I think I did it correctly). I tried adding $client->useApplicationDefaultCredentials(), like Filip had in his code, and I got a different error, so I commented it out.\nI started with the PHP Quickstart example from the Google Slides API using CLI, which only reads from an existing slides file to determine information and output it to the shell. That worked for me and it was PRESENTATIONS_READONLY.\nI modified it so that it will create a slide, so I had to make it PRESENTATIONS. Below is my code, and then the response (after taking @mattwhisenhunt 's advice above and using all three). I get the same error codes, but I have provided the additional responses from REST.php also. I could not figure out which line in my code actually was causing the problem.\nBelow are the CODE (with Id values replaced with \"...not shared here...\"), COMMAND, and RESPONSE. Please help as you are able. Thanks! (@mattwhisenhunt do I need to create a new item for this?)\nCODE: (with comments all removed)\n```php\n<?php\nrequire 'C:\\xampp\\vendor\\autoload.php';\nfunction getClient()\n{\n    $client = new Google_Client();\n    $client->setApplicationName('Google Slides API TEST1');\n    $client->setScopes(array(\n        Google_Service_Slides::PRESENTATIONS,\n        Google_Service_Slides::DRIVE,\n        Google_Service_Slides::DRIVE_FILE)\n    );\n    $client->setAuthConfig('client_secret.json');\n    $client->setAccessType('offline');\n$credentialsPath = expandHomeDirectory('credentials.json');\nif (file_exists($credentialsPath)) {\n    $accessToken = json_decode(file_get_contents($credentialsPath), true);\n} else {\n    $authUrl = $client->createAuthUrl();\n    printf(\"Open the following link in your browser:\\n%s\\n\", $authUrl);\n    print 'Enter verification code: ';\n    $authCode = trim(fgets(STDIN));\n\n    $accessToken = $client->fetchAccessTokenWithAuthCode($authCode);\n\n    if (!file_exists(dirname($credentialsPath))) {\n        mkdir(dirname($credentialsPath), 0700, true);\n    }\n    file_put_contents($credentialsPath, json_encode($accessToken));\n    printf(\"Credentials saved to %s\\n\", $credentialsPath);\n}\n$client->setAccessToken($accessToken);\n\nif ($client->isAccessTokenExpired()) {\n    $client->fetchAccessTokenWithRefreshToken($client->getRefreshToken());\n    file_put_contents($credentialsPath, json_encode($client->getAccessToken()));\n}\nreturn $client;\n\n}\nfunction expandHomeDirectory($path)\n{\n    $homeDirectory = getenv('HOME');\n    if (empty($homeDirectory)) {\n        $homeDirectory = getenv('HOMEDRIVE') . getenv('HOMEPATH');\n    }\n    return str_replace('~', realpath($homeDirectory), $path);\n}\n$client = getClient();\n$service = new Google_Service_Slides($client);\n$title = \"Google Slides API TEST1\";\n$presentation = new Google_Service_Slides_Presentation(array(\n    'title' => $title\n));\n$presentation = $service->presentations->create($presentation);\nprintf(\"Created presentation with ID: %s\\n\", $presentation->presentationId);\necho $presentationId;\n```\nCOMMAND:\n# php GoogleSlidesAPI-TEST1.php\nRESPONSE:\n```\nPHP Fatal error:  Uncaught Google_Service_Exception: {\n  \"error\": {\n    \"code\": 403,\n    \"message\": \"Request had insufficient authentication scopes.\",\n    \"errors\": [\n      {\n        \"message\": \"Request had insufficient authentication scopes.\",\n        \"domain\": \"global\",\n        \"reason\": \"forbidden\"\n      }\n    ],\n    \"status\": \"PERMISSION_DENIED\"\n  }\n}\n in C:\\xampp\\vendor\\google\\apiclient\\src\\Google\\Http\\REST.php:118\nStack trace:\n0 C:\\xampp\\vendor\\google\\apiclient\\src\\Google\\Http\\REST.php(94): Google_Http_REST::decodeHttpResponse(Object(GuzzleHttp\\Psr7\\Response), Object(GuzzleHttp\\Psr7\\Request), 'Google_Service_...')\n1 C:\\xampp\\vendor\\google\\apiclient\\src\\Google\\Task\\Runner.php(176): Google_Http_REST::doExecute(Object(GuzzleHttp\\Client), Object(GuzzleHttp\\Psr7\\Request), 'Google_Service_...')\n2 C:\\xampp\\vendor\\google\\apiclient\\src\\Google\\Http\\REST.php(58): Google_Task_Runner->run()\n3 C:\\xampp\\vendor\\google\\apiclient\\src\\Google\\Client.php(788): Google_Http_REST::execute(Object(GuzzleHttp\\Client), Object(GuzzleHttp\\Psr7\\Re in C:\\xampp\\vendor\\google\\apiclient\\src\\Google\\Http\\REST.php on line 118\nFatal error: Uncaught Google_Service_Exception: {\n  \"error\": {\n    \"code\": 403,\n    \"message\": \"Request had insufficient authentication scopes.\",\n    \"errors\": [\n      {\n        \"message\": \"Request had insufficient authentication scopes.\",\n        \"domain\": \"global\",\n        \"reason\": \"forbidden\"\n      }\n    ],\n    \"status\": \"PERMISSION_DENIED\"\n  }\n}\n in C:\\xampp\\vendor\\google\\apiclient\\src\\Google\\Http\\REST.php:118\nStack trace:\n0 C:\\xampp\\vendor\\google\\apiclient\\src\\Google\\Http\\REST.php(94): Google_Http_REST::decodeHttpResponse(Object(GuzzleHttp\\Psr7\\Response), Object(GuzzleHttp\\Psr7\\Request), 'Google_Service_...')\n1 C:\\xampp\\vendor\\google\\apiclient\\src\\Google\\Task\\Runner.php(176): Google_Http_REST::doExecute(Object(GuzzleHttp\\Client), Object(GuzzleHttp\\Psr7\\Request), 'Google_Service_...')\n2 C:\\xampp\\vendor\\google\\apiclient\\src\\Google\\Http\\REST.php(58): Google_Task_Runner->run()\n3 C:\\xampp\\vendor\\google\\apiclient\\src\\Google\\Client.php(788): Google_Http_REST::execute(Object(GuzzleHttp\\Client), Object(GuzzleHttp\\Psr7\\Re in C:\\xampp\\vendor\\google\\apiclient\\src\\Google\\Http\\REST.php on line 118\n```. ",
    "rodrigomojeda": "I've solved this problem by deleting token.json content in order to re-trigger the validation process.. ",
    "n00dl3": "Thank you, @mattwhisenhunt and @bshaffer. I was just letting you know in order to fix the docs. I managed to upgrade \"the monster\" to php 5.6 :wink: .. ",
    "mikemcmullan": "Yes, you can use this library to upload excel files then convert them to Google Sheets if you want.. This may be premature on my part but if anyone is interested in future proofing their application it's quit simple to pass the new endpoint when instantiating new batch requests:\n$batch = new Google_Http_Batch($this->client, false, null, 'batch/drive/v3');. Reading through this blog post: https://developers.googleblog.com/2018/03/discontinuing-support-for-json-rpc-and.html batch requests are still going to be supported but only for homogenous requests. Not sure if their official documentation has been updated to reflect this.. Took me a minute to understand what they meant as well. Simply means you\ncan only make batch requests to one API at a time. So for instance you\ncould group requests going to drive but if some of them were for calendar\nthose requests would have to be in a separate batch request.\nLet me know if that makes sense.. As far as I know JSON_RPC will be completely removed in a year, the blog post says to switch over to regular http api calls. As for the api specific batch calls they'll probably add a batch class to each api service.. ",
    "amin007": "Thank you very much. ",
    "toabm": "Thank you @LindaLawton , I already did, but similar output: \nAn error occurred: {\n  \"error\": {\n    \"code\": 400,\n    \"message\": \"Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[0]': Cannot find field\n    Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[1]': Cannot find field\n    Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[2]': Cannot find field\n    Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[3]': Cannot find field\n    Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[4]': Cannot find field\n    Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[5]': Cannot find field\n    Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[6]': Cannot find field\n    Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[7]': Cannot find field\n    Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[8]': Cannot find field\n    Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[9]': Cannot find field.\",\n    \"errors\": [\n      {\n        \"message\": \"Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[0]': Cannot find field\n        Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[1]': Cannot find field\n        Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[2]': Cannot find field\n        Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[3]': Cannot find field\n        Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[4]': Cannot find field\n        Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[5]': Cannot find field\n        Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[6]': Cannot find field\n        Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[7]': Cannot find field\n        Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[8]': Cannot find field\n        Invalid JSON payload received. Unknown name \\\"properties\\\" at 'requests[9]': Cannot find field.\",\n        \"domain\": \"global\",\n        \"reason\": \"badRequest\"\n      }\n    ],\n    \"status\": \"INVALID_ARGUMENT\"\n  }\n}\n\nThis is the request sent by the call() method of Resource.php, is the path ok?\nGuzzleHttp\\Psr7\\Request Object ( \n    [method:GuzzleHttp\\Psr7\\Request:private] => POST \n    [requestTarget:GuzzleHttp\\Psr7\\Request:private] => \n    [uri:GuzzleHttp\\Psr7\\Request:private] => GuzzleHttp\\Psr7\\Uri \n    Object ( [scheme:GuzzleHttp\\Psr7\\Uri:private] => https \n    [host:GuzzleHttp\\Psr7\\Uri:private] => www.googleapis.com \n    [port:GuzzleHttp\\Psr7\\Uri:private] => \n    [path:GuzzleHttp\\Psr7\\Uri:private] => /drive/v3/files/sheetId/copy.\n",
    "AlexisVidal": "need help. i have a problem, in redirect uri i typed http://localhost/hotel/AuthCallback/IndexAsync \nbut when it run it looks for http://localhost/AuthCallback/IndexAsync missing hotel folder and fails cause not exist. ",
    "basherr": "Sorry I just forget to add that property within optParams\n$optParams = array(\n            'q' => 'fullText contains \\'\"basheer\"\\'',\n            'pageSize' => 10,\n            'fields' => 'nextPageToken, files(id, name, webContentLink, mimeType)' <---\n        );. ",
    "vipkhongtin": "I also have errors Failed to start the resumable upload (HTTP 403) [] []\nPlease help me :(. > @vipkhongtin please open a new issue and provide additional information: What API are you accessing? Also please include a list of steps and a small snippet of sample code that can be used to reproduce the problem.\nplease give me your fb :)\n. ",
    "leesalminen": "The solution was to switch to a Service Account for Auth instead of an API Key. . ",
    "saffabook": "Hi thank you for your reply. \nIf there is not error display capabilities then I guess its not a bug. Perhaps I could suggest an enhancement. \nWhen I request analytics data, and its a positive result. I can read that data and process it on the next step. \nie when I run this $analytics->data_ga->get and I get the results, its available for me to work on. \nHowever if there is a error, ie someone revokes the permission, or some failure then the code just stops and I cant do work on it, ie the above error shows in my original post above. There is no easy solution if this error arises for me to deal with it. \nAnyways, I came up with a bit of an ugly solution but it works very well when time is short. \nIn this file, google-api-php/google/apiclient/src/Google/Http/REST.php I simply added this line on line 117\n$json = json_decode($body, true);\nreturn $json;\nand commented out the below because this just stops everything. \n//throw new Google_Service_Exception($body, $code, null, self::getResponseErrors($body));\nWith this ugly hack, it allows me to work with the error. I have my solution despite it being not so pretty. I hope this is enough for you to understand the situation. My apologies if I have not explained it properly.  . ",
    "AndriusCTR": "Hi,\nAnd how can I install it into my project? I use composer for adding all libraries into my project. \nWill I have two versions of guzzlehttp/psr7 after this installation?\nThanks. Thanks @bshaffer i did run the same command on live server and it seems to work properly (at least installation was successful). Maybe something was messed up on my local dev pc before.... ",
    "onassar": "Thanks for the link @mattwhisenhunt \nYes I'm using the scopes properly; what I missed was how to generate the actual \"message\".\nFor anyone else in this position in the future, you need to generate a valid message body (likely using a 3rd party library). This includes things like the recipient, the body, the subject, bcc, cc, attachments, etc.\nI'm using Swift Mailer to do this.\nHere's an example:\nphp\n$swiftMessage = new Swift_Message('Wonderful Subject');\n$swiftMessage->setTo(['receiver@domain.org']);\n$swiftMessage->setBody('Here is the message itself');\n$validMessageBody = $swiftMessage->toString();\nYou then set this in the Google_Service_Gmail_Message object you've created, like so:\nphp\n$message = new Google_Service_Gmail_Message();\n$body = strtr(\n    base64_encode($validMessageBody),\n    array('+' => '-', '/' => '_')\n);\n$message->setRaw($body);\nThat's what you want to set, and then send.\nGosh I hit my head against the wall for ages trying to figure out this one lololol. ",
    "wadewadewadewadewadewade": "I'm getting what sounds like the same behavior as @Chijioke1 using this code.\n$client = new Google_Client();\n$client->setAuthConfig('client_secret.json');\n$client->setRedirectUri('z');\n$client->setAccessType(\"offline\");\n$client->setIncludeGrantedScopes(true);\n$token = $client->fetchAccessTokenWithAuthCode($code); // this is invalid: \"Could not determine client ID from request.\"\nThe client_secret.json file is my oAuth 2.0 client secret file downloaded from https://console.developers.google.com/apis/credentials and looks something like this (but without newlines/spacing):\n{\n    \"web\": {\n        \"client_id\": \"x.apps.googleusercontent.com\",\n        \"project_id\": \"y\",\n        \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\n        \"token_uri\": \"https://accounts.google.com/o/oauth2/token\",\n        \"auth_provider_x509_cert_url\": \"https://www.googleapis.com/oauth2/v1/certs\",\n        \"redirect_uris\": [\"z\"],\n        \"javascript_origins\": [\"http://localhost\"]\n    }\n}. x, y, and z are replacements for legitimate values, BTW. @nikosolihin It looks like authenticate is sort of just an alias for fetchAccessTokenWithAuthCode, no?\nhttps://github.com/google/google-api-php-client/blob/master/src/Google/Client.php#L167\npublic function authenticate($code)\n  {\n    return $this->fetchAccessTokenWithAuthCode($code);\n  }. @nikosolihin Does your client secret JSON file look like mine: with all of the values nested within that 'web' property?\nI'm curious if maybe I'm using the wrong secret file...like maybe I should use the service JSON file that has no nesting and has the \"type\": \"service_account\", property.. @nikosolihin OK, I think I figured out an important part of this issue here. My Web Application for Client oAuth was auto-generated by Google when I was working on a previous version of the app I'm working on. It looks like the client_secret.json file for auto-generated Clients doesn't contain the \"client_secret\" property!\nSo now that I manually generated an oAuth 2.0 client ID i get past that client_id error, But now I'm getting a unauthorized_client error I need to sort out. I'll figure that out tho.\nBut it seems like auto-generated oAuth 2.0 client JSON files not including the same properties as manually-generated ones is a Google developer's console bug...\nThanks for the help, @nikosolihin !. ",
    "nikosolihin": "@wadewadewadewadewadewade Have you tried using $client->authenticate($code) instead of fetchAccessTokenWithAuthCode()?\nI fixed the \"Could not determine client ID from request\" issue by recreating a new client secret json file and using authenticate(). \nHowever, a new issue arose - my $token came with everything except the \"refresh_token\" field so I can't get new access token even though my access type is offline.. @wadewadewadewadewadewade Ah, I see. Yes, in that case fetchAccessTokenWithAuthCode and authenticate are interchangeable.\nMy secret looks exactly like yours except that it has the key \"client_secret\". I was using an older secret before which was missing this key (similar situation like yours). Regenerating a new secret seems to bring it back.. Glad to help. ",
    "jaylin507": "getting same issue\u2026\u2026. Thanks!. ",
    "DenisSokoloff": "I found way to send w/o Access Token\n```\nprivate function sendNotification($_token, $_title, $_body, $_link)\n    {\n        $SERVER_KEY = \"AAAA....\";\n    $data = array(\n        \"to\" => $_token,\n        //\"content_available\"   => false,\n        \"notification\" => array\n        (\n            \"title\"         => $_title,\n            \"body\"          => $_body,\n            \"icon\"          => \"https://...../icons/android-icon-192x192.png\",\n            \"click_action\"  => $_link.\"?\".(new DateTime())->getTimestamp()\n        )\n    );\n    $data_string = json_encode($data);\n\n    $ch = curl_init('https://fcm.googleapis.com/fcm/send');\n\n    curl_setopt($ch, CURLOPT_CUSTOMREQUEST,     \"POST\");\n    curl_setopt($ch, CURLOPT_POSTFIELDS,        $data_string);\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER,    true);\n    curl_setopt($ch, CURLOPT_HTTPHEADER,\n        array(\n            'Content-Type: application/json',\n            'Authorization: key='.$SERVER_KEY\n        ))  ;\n    $result = curl_exec($ch);\n    var_dump($result);\n    curl_close ($ch);\n\n    return $result;\n}\n\n```\n. ",
    "MGerasimchuk": "See this: https://gist.github.com/Repox/64ac4b3582f8ac42a6a1b41667db7440. ",
    "andrewgorpenko": "It's not a problem in google-api-php-client package, but in google/auth. It contains outdated php-jwt required versions (no v5 support). Will it be a problem to add a new v5 to google/auth package?\nThe answer to your question: can't tell exactly, but after a dozen of attempts it doesn't seem that there is a way to do so.. Guess what. Reinstalled Laravel, Passport and Google API client. everything seems to work fine. Strange bug... By the way thanks :). ",
    "xryst": "Good day, @LindaLawton !\nI haven't service account authorization error.\nAuthorization occurs without problems\nAn error occurs on this portion of the code:\nphp\n$response = $analytics->reports->query('channel=='.$channel.'', '2018-05-01', '2018-05-11', 'subscribersGained');\nWhen I use this function, I get the following error\nError calling GET https://www.googleapis.com/youtube/analytics/v1/reports?ids=channel{CHANEL_NAME}&start-date=2018-05-01&end-date=2018-05-11&metrics=subscribersGained: (403) Forbidde\nPlease note which URL is listed in the error: .../youtube/analytics/v1/reports...\nNote which link should be in accordance with the file YouTubeAnalytics.php (\\vendor\\google\\apiclient-services\\src\\Google\\Service)\n\nhttps://youtubeanalytics.googleapis.com/v2/reports\n\nHere's how to create a link in a file YouTubeAnalytics.php (\\vendor\\google\\apiclient-services\\src\\Google\\Service)\nphp\n    parent::__construct($client);\n    $this->rootUrl = 'https://youtubeanalytics.googleapis.com/';\n    $this->servicePath = '';\n    $this->version = 'v2';\nWhy is there one link (v1) in the YouTubeAnalytics.php and an error that returns another (v2)?. @LindaLawton \n\nIs an authentication error. The user you are authenticated with does not have permissions to do what you are trying to do. You may think you are authorizing correctly but you wont have permissions to do anything. A service account is not you its a user that needs permission to access data.\nI just did some checking You can't use a service account when making a YouTube Analytics API request. You need to use an account that is either the owner of the YouTube channel or a content owner associated with the channel.\nYou will need to go through the OAuth 2 flow once while signed in as the Google Account that owns the YouTube channel, and the saved OAuth 2 refresh token could then be used repeatedly in the future to get fresh access tokens which can be used to run reports.\n\nThank you! I will check it!\n. ",
    "achabill": "Thanks, it was some other unrelated code.. ",
    "prafullwizorbit": "Hello mxdpeep & JustinBeckwith \n                         Thanks for your answer but this code is not for sharing the calendar, its showing the summary only.\nThanks. Thanks for help\nI found the solution:here it is\nhttps://stackoverflow.com/questions/21523094/send-invitation-using-google-calendar-api-in-php?utm_medium=organic&utm_source=google_rich_qa&utm_campaign=google_rich_qa. Thanks again for quick reply. ",
    "bologer": "@LindaLawton source code documentation . @LindaLawton I know that it is generated. So is it planned to return an array of emails for me?. @mattwhisenhunt okay, thank you for a quick reply.. ",
    "Assimilationstheorie": "I signed it!. The Project is full of Short-Tags. I would start to fix it and rebuild the project, but im not sure if this a good idea, because we must rebuild a lot of things! What did you say? If you promise that the project will not be finished now, I will develop it until i die! :D. No Issue, i fix it self. I make another PR and start this week with fix all other files. Okay? :). Hey @bshaffer \nShort PHP-Tags are configured in php.ini -> \"short_open_tag\". Any Configuration in this File are unique and not the same for all people. When you use the \"long tag\", this will work on all configurations because thats the \"default way\". We eliminate a potential Error! :). @bshaffer - Ahh! I see! Never stop learning! :) Thanks for this info!\nI will change the short-tags and create a new PR now! :)\nUpdate: Now #1456 . Oh okay. I rebuild the warning system, but the stupid Google Bot can't accept my request, because the \"CLA\" is wrong...\nGood Luck, crazy Project!. Hm. :(. Stupid Bot! I accept the CLA with the same E-Mail... Why you can't understand it. :C. Same with #1439 :). Same with #1439 :). I would add it to all other files, yes.. Deal or no deal? . Hey @tmatsuo \nI create a new PR for this. :). ",
    "michaeldprice": "I noticed that there was only a \"source code\" option. My mistake.\nDownloaded 2.2.1 for now.. ",
    "jafarpagerjaya": "Um maybe is my poor understanding about gmail api, but if we delete the session we have to login into our google account again, is there any way to send email like using PHPmailer or etc without redirecting to auth page. So it means a user will be get confirmations email from my google account who is register a account it something like that? Sorry for my stupid questions. \ni'm try to make those like this but it always need auth from my google account. \n`<?php\nclass Mail {\n    private $_client,\n            $_client_id,\n            $_client_secret,\n            $_redirect_uri,\n            $_send_from,\n            $_send_to = array(),\n            $_subject,\n            $_message,\n            $_errors = array(),\n            $_service_gmail,\n            $_service_gmail_message;\nprivate static $_session = 'gmail_access_token';\n\npublic function __construct() {\n    if (count(Config::get('api/google/gmail'))) {\n        $this->_client_id = Config::get('api/google/gmail/client_id');\n        $this->_client_secret = Config::get('api/google/gmail/client_secret');\n        $this->_redirect_uri = Config::get('api/google/gmail/redirect_uri');\n    }\n    // Create object Google Client\n    return $this->_client = new Google_Client();\n}\n\npublic function sendMail($send_to = array(), $subject = '', $message = '') {\n    if (empty($this->_client_id)) {\n        $this->addError('Need to set the client_id API');\n    }\n    if (empty($this->_client_secret)) {\n        $this->addError('Need to set the client_secret API');\n    }\n    if (empty($this->_redirect_uri)) {\n        $this->addError('Need to set the redirect_uri API');\n    }\n    if (!empty($send_to)) {\n        $this->_send_to = $send_to;\n    }\n    if (!empty($subject)) {\n        $this->_subject = $subject;\n    }\n    if (!empty($message)) {\n        $this->_message = $message;\n    }\n    if (empty($this->_send_to)) {\n        $this->addError('Need to set destination email address');\n    }\n    if (empty($this->_message)) {\n        $this->addError('Need to set message content');\n    }\n    if (count($this->_errors)) {\n        print_r($this->getErrors());\n        die();\n    }\n\n    $this->_client->setClientId($this->_client_id);\n    $this->_client->setClientSecret($this->_client_secret);\n    $this->_client->setRedirectUri($this->_redirect_uri);\n    $this->_client->setAccessType('offline');\n    $this->_client->setApprovalPrompt('force');\n    $guzzleClient = new \\GuzzleHttp\\Client(array( 'curl' => array( CURLOPT_SSL_VERIFYPEER => false, ), ));\n    $this->_client->setHttpClient($guzzleClient);\n    // Set access to compose email\n    $this->_client->addScope(\"https://www.googleapis.com/auth/gmail.compose\");\n\n    // Check if have auth token then insert in into session using setToken method\n    if (isset($_REQUEST['code'])) {\n        $this->_client->authenticate($_REQUEST['code']);\n        $_SESSION[self::$_session] = $this->_client->getAccessToken();\n        $url = $this->_redirect_uri;\n        header('Location: '. filter_var($url, FILTER_VALIDATE_URL));\n    }\n\n    // Check token is in session\n    if (isset($_SESSION[self::$_session]) AND !empty($_SESSION[self::$_session]) ) {\n        $this->_client->setAccessToken($_SESSION[self::$_session]);            \n        $this->_service_gmail = new Google_Service_Gmail($this->_client);\n    } else {\n        // Failed Authentication\n        $authUrl = $this->_client->createAuthUrl();\n        header(\"Location: \" . $authUrl);\n    }\n\n    $strSubject = $this->_subject . date('M d, Y h:i:s A');\n    $strRawMessage = \"From: \" . $this->_send_from . \"\\r\\n\";\n    $strRawMessage .= \"To: \" . $this->_send_to . \"\\r\\n\";\n    $strRawMessage .= 'Subject: =?utf-8?B?' . base64_encode($strSubject) . \"?=\\r\\n\";\n    $strRawMessage .= \"MIME-Version: 1.0\\r\\n\";\n    $strRawMessage .= \"Content-Type: text/html; charset=utf-8\\r\\n\";\n    $strRawMessage .= 'Content-Transfer-Encoding: quoted-printable' . \"\\r\\n\\r\\n\";\n    $strRawMessage .= $this->_message;\n\n    try {\n        // The message needs to be encoded in Base64URL\n        $mime = rtrim(strtr(base64_encode($strRawMessage), '+/', '-_'), '=');\n        $this->_service_gmail_message = new Google_Service_Gmail_Message();\n        $this->_service_gmail_message->setRaw($mime);\n        //The special value **me** can be used to indicate the authenticated user.\n        $this->_service_gmail->users_messages->send(\"me\", $this->_service_gmail_message);\n\n        print('Message sent object');\n\n    } catch (Exception $e) {\n        print($e->getMessage());\n        unset($_SESSION[self::$_session]);\n    }\n}\n\nprivate function addError($error) {\n    return $this->_errors[] = $error;\n}\n\nprivate function getErrors() {\n    return $this->_errors;\n}\n\npublic function setSendFrom($send_from) {\n    $this->_send_from = trim($send_from);\n}\n\npublic function setSendTo($send_to) {\n    $this->_send_to = $send_to;\n}\n\npublic function getSendTo() {\n    $send_to;\n    if (count($this->_send_to) > 1) {\n        $send_to = implode(', ', $this->_send_to);\n    } else {\n        $send_to = $this->_send_to;\n    }\n    return $send_to;\n}\n\npublic function setSubject($subject) {\n    $this->_subject = trim($subject);\n}\n\npublic function getSubject() {\n    return $this->_subject;\n}\n\npublic function setMessage($message) {\n    $this->_message = trim($message);\n}\n\npublic function getMessage() {\n    return $this->_message;\n}\n\npublic function setClientId($client_id) {\n    $this->_client_id = $client_id;\n}\n\npublic function getClientId() {\n    return $this->_client_id;\n}\n\npublic function setClientSecret($client_secret) {\n    $this->_client_secret = $client_secret;\n}\n\npublic function getClientSecret() {\n    return $this->_client_secret;\n}\n\npublic function setRedirectUri($client_id) {\n    $this->_client_id = $client_id;\n}\n\npublic function getRedirectUri($redirect_uri) {\n    return $this->_redirect_uri = $redirect_uri;\n}\n\n}`\nSo far i made like that. ",
    "Tefached95": "Well I don't know what was going on, but I completely removed my OAuth ID on Google's console, created a new one, redownloaded my client_secret.json and now it seems to be working perfectly, both with and without the state.\nI'll provide any info if anyone needs it, but I consider this issue closed.. ",
    "nukkerone": "\nHi @mattwhisenhunt why was the issue closed?\n\nIm having the same issue, in fact this should be possible to do as shown in the official sign-in documentation: https://developers.google.com/identity/sign-in/web/server-side-flow\nThere are examples for the java sdk and the python sdk. The php sdk does not seem to comply and looks hardcoded for the redirect approach.. ",
    "edgargaza": "Bro, I swear I did and I didn't find anything... I love you tho, thx for the answer!. ",
    "siburny": "Actually, there is a separate function to set prompt called setPrompt: https://github.com/google/google-api-php-client/blob/593058802a4bada447e541a454601025c38bb2a9/src/Google/Client.php#L640-L643. I signed it!. The best way is not to specify version at all, so the latest could be installed.. I should've been more clear why I proposed this change. If you run the exact command from the docs\ncomposer require google/apiclient:^2.0\ncomposer will install version 2.0.0. However, the latest one is 2.2.2 (at the moment).\nIf you prefer not to specify the minor (.x) version in the docs, then we should use the following:\ncomposer require google/apiclient:2.*. My php and composer versions \n```\nc:\\Downloads>php -v\nPHP 7.2.8 (cli) (built: Jul 18 2018 10:03:02) ( NTS MSVC15 (Visual C++ 2017) x64 )\nCopyright (c) 1997-2018 The PHP Group\nZend Engine v3.2.0, Copyright (c) 1998-2018 Zend Technologies\n    with Xdebug v2.7.0alpha1, Copyright (c) 2002-2018, by Derick Rethans\nc:\\Downloads>composer -V\nComposer version 1.7.1 2018-08-07 09:39:23\n. Of course. Here is the output on my dev machine:\nc:\\Downloads\\testdir>composer require google/apiclient:^2.0\n./composer.json has been created\nLoading composer repositories with package information\nUpdating dependencies (including require-dev)\nPackage operations: 12 installs, 0 updates, 0 removals\n  - Installing psr/http-message (1.0.1): Loading from cache\n  - Installing guzzlehttp/psr7 (1.2.3): Loading from cache\n  - Installing guzzlehttp/promises (v1.3.1): Loading from cache\n  - Installing guzzlehttp/guzzle (6.2.0): Loading from cache\n  - Installing phpseclib/phpseclib (2.0.11): Loading from cache\n  - Installing psr/log (1.0.2): Loading from cache\n  - Installing monolog/monolog (1.23.0): Loading from cache\n  - Installing firebase/php-jwt (v3.0.0): Loading from cache\n  - Installing google/apiclient-services (v0.64): Loading from cache\n  - Installing psr/cache (1.0.1): Loading from cache\n  - Installing google/auth (v0.8): Loading from cache\n  - Installing google/apiclient (v2.0.0): Loading from cache\nphpseclib/phpseclib suggests installing ext-libsodium (SSH2/SFTP can make use of some algorithms provided by the libsodium-php extension.)\nphpseclib/phpseclib suggests installing ext-mcrypt (Install the Mcrypt extension in order to speed up a few other cryptographic operations.)\nphpseclib/phpseclib suggests installing ext-gmp (Install the GMP (GNU Multiple Precision) extension in order to speed up arbitrary precision integer arithmetic operations.)\nmonolog/monolog suggests installing aws/aws-sdk-php (Allow sending log messages to AWS services like DynamoDB)\nmonolog/monolog suggests installing doctrine/couchdb (Allow sending log messages to a CouchDB server)\nmonolog/monolog suggests installing ext-amqp (Allow sending log messages to an AMQP server (1.0+ required))\nmonolog/monolog suggests installing ext-mongo (Allow sending log messages to a MongoDB server)\nmonolog/monolog suggests installing graylog2/gelf-php (Allow sending log messages to a GrayLog2 server)\nmonolog/monolog suggests installing mongodb/mongodb (Allow sending log messages to a MongoDB server via PHP Driver)\nmonolog/monolog suggests installing php-amqplib/php-amqplib (Allow sending log messages to an AMQP server using php-amqplib)\nmonolog/monolog suggests installing php-console/php-console (Allow sending log messages to Google Chrome)\nmonolog/monolog suggests installing rollbar/rollbar (Allow sending log messages to Rollbar)\nmonolog/monolog suggests installing ruflin/elastica (Allow sending log messages to an Elastic Search server)\nmonolog/monolog suggests installing sentry/sentry (Allow sending log messages to a Sentry server)\ngoogle/apiclient suggests installing tedivm/stash (For caching certs and tokens (using Google_Client::setCache))\nWriting lock file\nGenerating autoload files\nc:\\Downloads\\testdir>composer show\nfirebase/php-jwt          v3.0.0 A simple library to encode and decode JSON Web Tokens (JWT) in PHP. Should confor...\ngoogle/apiclient          v2.0.0 Client library for Google APIs\ngoogle/apiclient-services v0.64  Client library for Google APIs\ngoogle/auth               v0.8   Google Auth Library for PHP\nguzzlehttp/guzzle         6.2.0  Guzzle is a PHP HTTP client library\nguzzlehttp/promises       v1.3.1 Guzzle promises library\nguzzlehttp/psr7           1.2.3  PSR-7 message implementation\nmonolog/monolog           1.23.0 Sends your logs to files, sockets, inboxes, databases and various web services\nphpseclib/phpseclib       2.0.11 PHP Secure Communications Library - Pure-PHP implementations of RSA, AES, SSH2, S...\npsr/cache                 1.0.1  Common interface for caching libraries\npsr/http-message          1.0.1  Common interface for HTTP messages\npsr/log                   1.0.2  Common interface for logging libraries\n```\nAlso, here is the content of the created composer.json (notice the missing caret symbol):\n{\n    \"require\": {\n        \"google/apiclient\": \"2.0\"\n    }\n}. Unfortunately, composer require google/apiclient:^^2.0 command produces the same results:\nfirebase/php-jwt          v3.0.0 A simple library to encode and decode JSON Web Tokens (JWT) in PHP. Should confor...\ngoogle/apiclient          v2.0.0 Client library for Google APIs\ngoogle/apiclient-services v0.64  Client library for Google APIs\ngoogle/auth               v0.8   Google Auth Library for PHP\nguzzlehttp/guzzle         6.2.0  Guzzle is a PHP HTTP client library\nguzzlehttp/promises       v1.3.1 Guzzle promises library\nguzzlehttp/psr7           1.2.3  PSR-7 message implementation\nmonolog/monolog           1.23.0 Sends your logs to files, sockets, inboxes, databases and various web services\nphpseclib/phpseclib       2.0.11 PHP Secure Communications Library - Pure-PHP implementations of RSA, AES, SSH2, S...\npsr/cache                 1.0.1  Common interface for caching libraries\npsr/http-message          1.0.1  Common interface for HTTP messages\npsr/log                   1.0.2  Common interface for logging libraries. So after trial and error, I found the right command: you need to include \"quotes\" around version number\ncomposer require google/apiclient:\"^2.0\"\nwhich will produce correct results:\nfirebase/php-jwt          v5.0.0 A simple library to encode and decode JSON Web Tokens (JWT) in PHP. Should confor...\ngoogle/apiclient          v2.2.2 Client library for Google APIs\ngoogle/apiclient-services v0.64  Client library for Google APIs\ngoogle/auth               v1.3.2 Google Auth Library for PHP\nguzzlehttp/guzzle         6.3.3  Guzzle is a PHP HTTP client library\nguzzlehttp/promises       v1.3.1 Guzzle promises library\nguzzlehttp/psr7           1.4.2  PSR-7 message implementation that also provides common utility methods\nmonolog/monolog           1.23.0 Sends your logs to files, sockets, inboxes, databases and various web services\nphpseclib/phpseclib       2.0.11 PHP Secure Communications Library - Pure-PHP implementations of RSA, AES, SSH2, S...\npsr/cache                 1.0.1  Common interface for caching libraries\npsr/http-message          1.0.1  Common interface for HTTP messages\npsr/log                   1.0.2  Common interface for logging libraries. ",
    "thanosalexander": "I already checked the documentation and all services but i didnt find any solution about this.. \nI tried too with other tools like pupeteer to download csv manually but no luck too!\nIts weird for google to miss this functionality. ",
    "AroundtheGlobe": "I've got the same error with similar code after updating the library. \ncomposer show output: \ngoogle/apiclient              v2.2.2  Client library for Google APIs\ngoogle/apiclient-services     v0.64   Client library for Google APIs\ngoogle/auth                   v1.3.2  Google Auth Library for PHP\nI am trying to execute this code: \n$json = $analytics->reports->query('channel=='.$arrRow['youtubeid'].'', $datePast , $today, 'views', array('dimensions' => 'country', 'sort' => '-views')); \nWhen I replace the old(er) Google library the code above works again. . ",
    "clevertree": "Thanks for the response Matt. Here's the sample code where I found the library:\nhttps://github.com/google-pay/s2ap-quickstart-php/tree/master/google-api-client/src/Google/Service\nAlso I received this library from Google via zipfile after signing up for the new GPay API, so maybe this hasn't been released yet. I might also be misunderstanding something. Thanks!. ",
    "vegeman": "Hello @mattwhisenhunt \nIn Google pay's official document, it used a lot of src/Google/Service/Walletobjects.php feature. I suggest the official module and document should sync their function for better understanding ;). ",
    "Yahav": "I signed it!. Can someone merge this?. Hmm, you actually may be right.. Done, should be alright now.  can you confirm?. Done. done. ",
    "anshulbhawsar": "This is a part of G suite client php library. I have also modify the code but there is no any updates. I'm not getting any help from api explorer.. ",
    "markosjal": "looking atthe link below I see 1.1.7 but no 1.1.8.\nhttps://github.com/google/google-api-php-client/releases?after=v2.0.1\nwhen I try to do the composer install I get\nroot@gvsip:/var/www/gvauth/goog $ php composer.phar install\nDo not run Composer as root/super user! See https://getcomposer.org/root for details\nLoading composer repositories with package information\nInstalling dependencies (including require-dev) from lock file\nYour requirements could not be resolved to an installable set of packages.\nProblem 1\n    - Installation request for guzzlehttp/guzzle 5.2.0 -> satisfiable by guzzlehttp/guzzle[5.2.0].\n    - guzzlehttp/guzzle 5.2.0 requires php >=5.4.0 -> your PHP version (5.3.3) does not satisfy that requirement.\n  Problem 2\n    - Installation request for guzzlehttp/ringphp 1.1.0 -> satisfiable by guzzlehttp/ringphp[1.1.0].\n    - guzzlehttp/ringphp 1.1.0 requires php >=5.4.0 -> your PHP version (5.3.3) does not satisfy that requirement.\n  Problem 3\n    - Installation request for guzzlehttp/streams 3.0.0 -> satisfiable by guzzlehttp/streams[3.0.0].\n    - guzzlehttp/streams 3.0.0 requires php >=5.4.0 -> your PHP version (5.3.3) does not satisfy that requirement.\n  Problem 4\n    - Installation request for react/promise v2.4.0 -> satisfiable by react/promise[v2.4.0].\n    - react/promise v2.4.0 requires php >=5.4.0 -> your PHP version (5.3.3) does not satisfy that requirement.\nI amm  worried that installing a newer PHP may break something else. I tried as you said\n*composer* require google/apiclient:^1.0\n-bash: composer.json: command not found\nIs this what you meant?\nphp composer require google/apiclient:^1.0\n{\n    \"name\": \"googleplus/quickstart\",\n    \"description\": \"This quick-start app is built in PHP and lets you get started with the Google+ platform in a few minutes.\",\n    \"license\": \"Apache-2.0\",\n    \"repositories\": [\n        {\n            \"type\": \"package\",\n            \"package\": {\n                \"name\": \"google/apiclient\",\n                \"version\": \"1.1.7\",\n                \"source\": {\n                    \"url\": \"https://github.com/google/google-api-php-client.git\",\n                    \"type\": \"git\",\n                    \"reference\": \"v1-master\"\n                },\n                \"autoload\": {\n                    \"classmap\": [\n                        \"src/\"\n                    ]\n                }\n            }\n        }\n    ],\n    \"require\": {\n        \"silex/silex\": \"1.0.@dev\",\n        \"twig/twig\": \">=1.8,<2.0-dev\",\n        \"google/apiclient\": \"1.1.\",\n        \"guzzlehttp/guzzle\": \"5.2.\"\n    }\n}\n. Thanks anyway , I give up.\nbig waste of time for me\nall documentation now refers to newer versions impossible for me to figure out\nthis is why older versions need to have the documentation maintained too. ",
    "4youplay": "```\n<?php\n/\n * Copyright 2011 Google Inc.\n \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n \n *     http://www.apache.org/licenses/LICENSE-2.0\n \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\ninclude_once DIR . '/googleapi/vendor/autoload.php';\ninclude_once \"templates/base.php\";\ninclude('config.php');\nsession_start();\necho pageHeader(\"Retrieving An Id Token\");\n/*******\n * Ensure you've downloaded your oauth credentials\n ********/\n/********\n * NOTICE:\n * The redirect URI is to the current page, e.g:\n * http://localhost:8080/idtoken.php\n *******/\n$client_id = '----deleted----';\n$client_secret = '---deleted---';\n$redirect_uri = 'http://' . $_SERVER['HTTP_HOST'] . $_SERVER['PHP_SELF'];\n$client = new Google_Client();\n$client->setClientId($client_id);\n$client->setClientSecret($client_secret);\n$client->setRedirectUri($redirect_uri);\n$client->setScopes('profile');\n/******\n * If we're logging out we just need to clear our\n * local access token in this case\n ******/\nif (isset($_REQUEST['logout'])) {\n  unset($_SESSION['id_token_token']);\n}\n/******\n * If we have a code back from the OAuth 2.0 flow,\n * we need to exchange that with the\n * Google_Client::fetchAccessTokenWithAuthCode()\n * function. We store the resultant access token\n * bundle in the session, and redirect to ourself.\n ******/\nif (isset($_GET['code'])) {\n  $token = $client->fetchAccessTokenWithAuthCode($_GET['code']);\n  // store in the session also\n  $_SESSION['id_token_token'] = $token;\n  // redirect back to the example\n  header('Location: ' . filter_var($redirect_uri, FILTER_SANITIZE_URL));\n  return;\n}\n/******\n  If we have an access token, we can make\n  requests, else we generate an authentication URL.\n ******/\nif (\n  !empty($_SESSION['id_token_token'])\n  && isset($_SESSION['id_token_token'])\n) {\n  $client->setAccessToken($_SESSION['id_token_token']);\n} else {\n  $authUrl = $client->createAuthUrl();\n}\n/******\n  If we're signed in we can go ahead and retrieve\n  the ID token, which is part of the bundle of\n  data that is exchange in the authenticate step\n  - we only need to do a network call if we have\n  to retrieve the Google certificate to verify it,\n  and that can be cached.\n *********/\nif ($client->getAccessToken()) {\n  $token_data = $client->verifyIdToken();\n}\n?>\nphp if (isset($authUrl)): ?\n\n\nConnect Me!\n\nphp else: ?\n\n\n<prevar_export($token_data);\n\n?>\n\nphp endif ?\n```\n\nI open Firefox and Chrome, each one with different account, i click on Connect Me!, after that i see the same values of the   $token_data array, aud, sub, name.... Pracucci my workaroud was removing the redirect part. I think is related to the $Session. . \nIf i remove the scope parameter the login and redirect happens with success.\n```\n$client = new Google_Client();\n$client->setClientId($client_id);\n$client->setClientSecret($client_secret);\n$client->setRedirectUri($redirect_uri);\n$client->addScope(\"profile\");\n$service = new Google_Service_Oauth2($client);\n/*******\n  If we have a code back from the OAuth 2.0 flow,\n  we need to exchange that with the authenticate()\n  function. We store the resultant access token\n  bundle in the session, and redirect to ourself.\n/\nif (isset($_GET['code'])) {\n  $client->authenticate($_GET['code']);\n  $_SESSION['access_token'] = $client->getAccessToken();\n  header('Location: ' . filter_var($redirect_uri, FILTER_SANITIZE_URL));\n  return;\n}\n/********\n  If we have an access token, we can make\n  requests, else we generate an authentication URL.\n **********/\nif (isset($_SESSION['access_token']) && $_SESSION['access_token']) {\n  $client->setAccessToken($_SESSION['access_token']);\n} else {\n  $authUrl = $client->createAuthUrl();\n}\n```. Thanks Matt, but i already used the newest version (install via composer and directly), same results.\nI used the example idtoken.php in this repo, but gives me every time 403 Forbidden, the 'profile' scope isnt working.. ",
    "pracucci": "We're experiencing the same issue and - after hours of debugging - we've no clue on the root cause. We're still debugging and will share any information as soon as we find it.. ",
    "thickey256": "I signed it!. I didn't even realise abhor is a real word, so thats my bad.  Perhaps my change is a bit of a better fit?. ",
    "squierll": "I removed vendor/google and then installed again, and now works.. ",
    "viertel": "Hello @mattwhisenhunt ,\nfirst of all, thank you for your answer. You are right, I speak about the Custom Search JSON API. \nAt the moment, I am already trying to find a web crawler which I can configure such that all subsites of a concrete link will be crawled. \nFor example: \nThe concrete URL is \"https://www.nintendo.com/games/detail/super-mario-party-switch\".\nSo my plan is to crawl all URLs starting with \"https://www.nintendo.com/games/detail/\" and containing \"switch\" in the last part of the URL. Which would be all pages for Switch games.\nDo you have an idea how to do that? A code example for php would be nice.\nHave a nice weekend.\nGreetings, \nviertel. ",
    "adamsilverstein": "\ud83c\udf89 . ",
    "nikolasr200": "file in previous version was left URITemplate and hadn't been renamed to UriTemplate in my file system.\nProblem solved.. ",
    "drrhf": "Matt,\nI don't use Composer. \nRather I downloaded what I thought was the latest release: google-api-php-client-2.2.2.\nThanks,\nBob\n. You are correct.  Somehow I was using a version of guzzle that had (in src\\Handler\\CurlFactory.php)\n\"private $handles;\"   In guzzle Version 6.3.3 this is replaced with \"private $handles = [];\" and the code works correctly with PHP Version 7.2.8.\nThanks,\nBob\n. Just wondered if you looked at this. There is a simple work-around, but I don't know the consequences. \nIn C:\\wamp64\\creds\\google-api-php-client-2.2.2\\vendor\\guzzlehttp\\psr7\\src\\Stream.php\nreplace Line 199\ndiff\n-      } elseif (fseek($this->stream, $offset, $whence) === -1) {\n+      } elseif (fseek($this->stream, $offset) === -1) {. Have you opened an issue for Guzzle on github? No.\naltering vendor code isn't a great solution; composer will inevitably overwrite that file and you will lose your change. I agree.\nCould you provide me a sample of your code that leads to your stack trace above? This will take me some time and I am not sure how useful it will be to you.  I use a MVC architecture, with different operations in several different files.  \nI think the key point is that the code works perfectly with PHP version 7.2.8.\nIt fails with the errors above when I switch to PHP version 7.3.0, and it works fine with version 7.3.0 when I remove the $whence argument from the fseek function call above.\nIt seems that maybe there was a change in the fseek function between the two PHP versions.. ",
    "Renkas": "This is fixed in Guzzle 6.3\nThis library installs Guzzle 6.2.3 (at least it has done so for me). manually updating Guzzle in my project fixed this issue for me.. ",
    "emanuelcanha": "Thanks for the information.\nIf we add that functionality is just a matter of checking the token audience against an array of client IDs or is there anything else we need to be aware of?\n. We are only using the library to authenticate users on our backend server. We need to verify JWT tokens from multiple apps, which have different Client IDs.\nBesides the integrity checks, the library is also checking that the Client ID (aka audience) sent by the app is the same as the Client ID set on the backend. The change I'm suggesting is to allow for multiple Client IDs to be set on the backend. This would make it the same as the other languages.. ",
    "yehudahkay": "@mattwhisenhunt thank you, yes I needed a proxy thank you. ",
    "nielsnl68": "Would you mind showing the changes here.? I just need to generate a adsense report. And i'm getting a bit lost with all the api's available.. ",
    "codersneha3012": "Hi,\nI have fixed this issue but please could you help me with this issue.. ",
    "NVD-R": "I signed it!\n. ",
    "chenliangliang008": "addition\ncode as below.\nphp\n\n<prequire_once DIR.'/google-api-php-client/vendor/autoload.php';\n$json_path = DIR.'/google-api-php-client/key/hoge1123.json';\n    $calendarId='m45gnl8k65evae50n9bsdsdsadsadgroup.calendar.google.com';\n    $json_string = file_get_contents($json_path, true);\n    $json = json_decode($json_string, true);\n    $scopes = array('https://www.googleapis.com/auth/calendar');\n    $client = new Google_Client();\n    $client->setApplicationName(\"Google Calendar PHP API\");\n    $client->setAuthConfig($json_path);\n    $client->setScopes($scopes);\n    if ($client->isAccessTokenExpired()) {\n        $client->refreshTokenWithAssertion();\n    }\n$service = new Google_Service_Calendar($client);\n$event = new Google_Service_Calendar_Event(array(\n  'summary' => 'test20180911',\n  'start' => array(\n    'dateTime' => '2018-09-12T11:00:00+09:00',\n    'timeZone' => 'Asia/Tokyo',\n   ),\n  'end' => array(\n    'dateTime' => '2018-09-12T12:12:00+09:00',\n    'timeZone' => 'Asia/Tokyo',\n   ),\n));\n$event = $service->events->insert($calendarId, $event);\nprintf('Event created: %s\\n', $event->htmlLink);. Thank you for your reply.\nYes, the calendar API is enabled in the APIs console.. ",
    "Nehadigi": "This is not working. If want to upload the file on my drive then there should be a way to upload image without authenticate again and again. All user file will upload on my drive. I know but google drive giving me 1 level directories. Is that possible to fetch it in the tree form,\nhere is my code:-\n$service = new Google_Service_Drive($client);\n$parameters['q'] = \"mimeType='application/vnd.google-apps.folder' and 'FolderID' in parents and trashed=false\";\n$parameters['orderBy'] = \"name\";\n$folders = $service->files->listFiles($parameters);. ",
    "joyeffect": "@mattwhisenhunt thanks for reply, yes, this is correct way to get a group. But I'm confused, why I got 400 error code? I don't have a user with such email address. \nHmm... after all I said, now I think that expected 404 code it's not a right way too, because formally, I already have registered resource with email somegroup@domain.com, and it does not matter what kind of resource it is.\n. If $directory->groups->get('someuser@domain.com'); will be called with a nonexistent group but with an existing user an error 404 will be returned. It does not make sense, because I cannot create a group with the existing user with the same email address.\nI believe that this issue does not apply to this SDK, the problem lies in the Google API response.\n . ",
    "SPie": "What does the response of $gClient->fetchAccessTokenWithAuthCode($_GET['code']); look like?\nI tried to reproduce this issue (with my own dev application oc) but it works for me. I get an array as response with an access token.. ",
    "stucchi": "Yes @mattwhisenhunt you are right, but what if you work for one of them (I am, for example)... \nI am extending the library on my own, and it works perfectly, I'd love to speed up the development time for PHP users in my same situation. Is this a bad idea or it makes some sense for me to build something and share it, even if not everyone will be able to use it ?. ",
    "sharmasandeep410": "4youplay \nHave you find answer ? I am facing same problem.. ",
    "amindeed": "1532 will maybe provide more details about this issue..",
    "nokite": "I have the same problem. Since the Google API console UI was updated, I can't get the API key to work. I follow the same steps as before.\nI'm using Fastlane to submit an APK by using an API key.\nI get \"projectNotLinked: The project id used to call the Google Play Developer API has not been linked in the Google Play Developer Console.\"\nI can see the project ID from the API console listed in the Google Play console. Under: Users & Permissions > Users with access. I've also given it all the necessary permissions (Release manager). \nI created the key using:\nCreate service account\nRole: Service accounts - Service account user\nJSON key\nEdit: A few hours later a tried this: I uploaded the Android app manually, and after that the API access seems to work. It looks like the error I was seeing was simply the wrong one. It should have been similar to \"no app found with the ID specified\".. ",
    "jseparovic1": "Hi, I have the same problem I found out that we are missing refreshToken. Problem is that refreshToken is not returned  inside accesToken payload (when calling $client->getAccessToken()) but it should be returned.\nYou can see part of code inside getRefreshToken()method. \nif (isset($this->token['refresh_token'])) {\n      return $this->token['refresh_token'];\n  }\nAnd $token is accessToken that you provide with $client->setAccessToken()\nSo the question is, how to get refreshToken from google?. ",
    "edubacco": "Same error here.\nIf I run this code (I've simplyfied it a bit)\n```\n<?php\n$redirectCallbackUri = 'https://';\n$accessToken = '';\n$accountID = '***';\n$containerID = '10045636';\n$workspaceID = '5';\n$GClient = new \\Google_Client();\n$scopes = ['https://www.googleapis.com/auth/tagmanager.edit.containers'];\n$credentialFile      = '/path/to/credential.json';\n$GClient->setAccessType( 'offline' );\n$GClient->setIncludeGrantedScopes( true );\n$GClient->setRedirectUri( $redirectCallbackUri );\n$GClient->setScopes( $scopes );\n$state = \"Some state handling\";\n$GClient->setState( $state );\nif ( empty( $accessToken ) ) {\n    $auth_url = $GClient->createAuthUrl();\n    header( 'Location: ' . filter_var( $auth_url, FILTER_SANITIZE_URL ) );\n    die();\n}\n$GClient->setAccessToken( $accessToken );\n$GClient->setAuthConfig( $credentialFile );\n$GClient->setScopes( $scopes );\n$TmService = new Google_Service_TagManager_Tag();\n$TmService->setName( 'UA-1271*-1' );\n$TmService->setType( \"ua\" );\n$params = new Google_Service_TagManager_Parameter();\n$params->setKey( \"trackingId\" ); #e se qui ci va il codice proprio??\n$params->setValue( $tagId );\n$params->setType( \"template\" );\n$TmService->setParameter( $params );\nreturn $TmService->accounts_containers_workspaces_tags->create( \"accounts/{$accountID}/containers/{$containerID}/workspaces/{$workspaceID}\", $TmService );\n``\nI obtain this exception:Google_Service_Exception: code: 400; msg: {\" error \": {\" errors \": [{\" domain \":\" global \",\" reason \":\" invalidArgument \",\" message \":\" Bad Request \"}],\" code \": 400,\" message \":\" Bad Request \"}}I cannot understand the reason, but it seems related to the PHP SDK. Using the online console all works good.\nThe authentication part works good, it'sTmService->accounts_containers_workspaces_tags->create` that does not work as expected.\nEduardo. I've found the problem.\nWhen you create a new Google_Service_TagManager_Tag, you have to create Google_Service_TagManager_Parameter too and set it on the Service.\nBut those parameters needs to be inserted in an array. So:\n$TmService = new Google_Service_TagManager_Tag();\n[...]\n$params = new Google_Service_TagManager_Parameter();\n[...]\n/** LOOK HERE: **/\n$params_arr = [];\n$params_arr[] = $params;\n/** END OF FIX **/\n$TmService->setParameter( $params_arr );. ",
    "marcobaroni1991": "Thx guys! Now all work correctly!!! @edubacco @mattwhisenhunt . ",
    "adrianlaraperez88": "Is no bug is problem in the server and set_time_limit.thanks. ",
    "burakbuylu": "Okay but I have more than token and I want to subscribe a 1 user with my 10 token with batch request. How can I set my tokens? If I set just 1 token how can I send batch request?\nDo you have some examples? @mattwhisenhunt . Thanks for reply, I can explation clearly; we are work in social accounts management company. We will renew tokens with apis before the request. \nAfter we send subscribers with our tokens in our application users. We storing tokens for this.\nWe have applicaton and users an example;\nApplication 1:\n- User 1\n- User 2\n- User 3\n- User 4\nIf new user added the queue like User 5. Must be follow user 1 to 4 and others can be follow user 5.  API can be do this for us. But batch not work for this request..\nWe have 10.000 more token. How can I subscribe it to 1 user from 9999 users?. ",
    "sundarpenumarthiwiomw": "Thanks for your response @mattwhisenhunt.  I'm working on a splash page for logging into a wifi network.  Because of this, you may not be able to reproduce the error on your end due to the hardware restrictions.  But what's happening is that when logging in using Safari or Chrome, it works fine.  But when the iOS WiFi Login app runs, it gives the error stated above.  \nI can provide you with the different useragents I get on different browsers and also on the iOS app. \nThe Google ID I created is for a Web Application because it's just an html page, and I am not the creator the iOS app that logs in when connecting to WiFi.  On all other hardware devices, it uses the browser to login to WiFi, and so there's no issue.  It's only on iOS that causes this problem.  If there is a way to allow overriding the user agent or something like that, I'd appreciate it.\nUser Agents:\nIphone Safari (Working)\nmozilla/5.0 (iPhone; CPU iPhone OS 11_3 like Mac OS X)\nApple WebKit/605.1.1.5 (KHTML, like Gecko) Version/11.0 Mobile/15E148 Safari/604.1\nChrome Iphone (Working)\nmozilla/5.0 (iPhone; CPU iPhone OS 11_3 like Mac OS X)\nApple WebKit/604.1.34 (KHTML, like Gecko) CriOS/70.0.3538.75 Version/11.0 Mobile/15E148 Safari/604.1\nSplash page iOS app (Not Working) - 403 Error\nmozilla/5.0 (iPhone; CPU iPhone OS 11_3 like Mac OS X)\nApple WebKit/605.1.1.5 (KHTML, like Gecko) Mobile/15E302\nCode snippet below\nhtml\n\n\n\n Latest compiled and minified CSS \n\n\n\n\n        function onSignIn(googleUser) \n        {\n            var profile = googleUser.getBasicProfile();\n            $(\"#email\").text(profile.getEmail());\n        }\n    \n\n\n\n\n\n\n\n\nTIA.. ",
    "caleuanhopkins": "@mattwhisenhunt Perfect, thanks for looking to this for me. Is there plans to update the directory name to match the service name (client events)?\nEDIT:\nJust had a look in the JobService directory, looks like this was the V2 directory and so Client Events hasn't been copied over to the V3 Cloud Talent Solution directory. Makes a bit more sense now.. ",
    "ddbruce": "I signed it!. ",
    "vijay-qlogic": "@mattwhisenhunt I think I misunderstood the Issue. . ",
    "BostonBud": "Thanks for letting me know.   When I replaced the setRedirectURI with the one you suggested, I get the prompt in DOS to copy the long URL and place it in a browser.  I've probably totally screwed up my credentials trying various things to get this thing working.  What are the steps / options for setting up my credentials the way that QuickStart.php needs them?  When I go to the suggested URL I now get the message: The redirect URI in the request, urn:ietf:wg:oauth:2.0:oob, can only be used by a Client ID for native application. It is not allowed for the WEB client type. You can create a Client ID for native application at https://console.developers.google.com/apis/credentials/oauthclient. That did it.  Thanks.  I can see my test event.  It returns the event name and time.  I actually want to see a secondary calendar that I created under the Google account.  When I replace the statement $calendarId = 'primary'; with $calendarId = '(a long string)'; it prints out the upcoming events for that secondary calendar.  All is great!  However I have a few follow-up questions:\n1) I can't see the contents of the field \"Description\", Location Creator, etc.  How would I get a more verbose response?\n2) How can I get historical events (from say 9/1/2018) as well a future events? \nThank you very much for all your help. . ",
    "desmeit": "Thank you very much.. ",
    "jpcodeforit": "@jdpedrie .yup .after posting within few min i got sollution for my issue.THanks :). ",
    "ronlinet": "I have taken off the API key and modified the setScope as advised the error doesn't go away. I am trying to automate the log in and I expect to extract all running live streaming. Is this supposed to work in this context ?\nGoogle_Service_Exception (401)\n{ \"error\": { \"errors\": [ { \"domain\": \"global\", \"reason\": \"required\", \"message\": \"Login Required\", \"locationType\": \"header\", \"location\": \"Authorization\" } ], \"code\": 401, \"message\": \"Login Required\" } }. I have reused the code from https://developers.google.com/youtube/v3/live/docs/liveStreams/list , the $client->getAccessToken() is returning null so it cannot work. Is this library supposed to work for this use case?\n    $client = new Google_Client();\n    $client->setClientId(self::OAUTH2_CLIENT_ID);\n    $client->setClientSecret( self::OAUTH2_CLIENT_SECRET);\n    $client->setScopes('https://www.googleapis.com/auth/youtube');\n    $redirect = filter_var('http://' . $_SERVER['HTTP_HOST'] . $_SERVER['PHP_SELF'],\n        FILTER_SANITIZE_URL);\n    $client->setRedirectUri($redirect);\n\n    // Define an object that will be used to make all API requests.\n    $youtube = new Google_Service_YouTube($client);\n\n    // Check if an auth token exists for the required scopes\n    $tokenSessionKey = 'token-' . $client->prepareScopes();\n    if (isset($_GET['code'])) {\n        if (strval($_SESSION['state']) !== strval($_GET['state'])) {\n            die('The session state did not match.');\n        }\n\n        $client->authenticate($_GET['code']);\n        $_SESSION[$tokenSessionKey] = $client->getAccessToken();\n        header('Location: ' . $redirect);\n    }\n\n    if (isset($_SESSION[$tokenSessionKey])) {\n        $client->setAccessToken($_SESSION[$tokenSessionKey]);\n    }\n\n    $htmlBody = '';\n\n    // Check to ensure that the access token was successfully acquired.\n    if ($client->getAccessToken()) {\n        try {\n            // Execute an API request that lists the streams owned by the user who\n            // authorized the request.\n            $streamsResponse = $youtube->liveStreams->listLiveStreams('id,snippet', array(\n                'mine' => 'true',\n            ));\n\n            $htmlBody .= \"<h3>Live Streams</h3><ul>\";\n            foreach ($streamsResponse['items'] as $streamItem) {\n                $htmlBody .= sprintf('<li>%s (%s)</li>', $streamItem['snippet']['title'],\n                    $streamItem['id']);\n            }\n            $htmlBody .= '</ul>';\n\n        } catch (Google_Service_Exception $e) {\n            $htmlBody = sprintf('<p>A service error occurred: <code>%s</code></p>',\n                htmlspecialchars($e->getMessage()));\n        } catch (Google_Exception $e) {\n            $htmlBody = sprintf('<p>An client error occurred: <code>%s</code></p>',\n                htmlspecialchars($e->getMessage()));\n        }\n\n        $_SESSION[$tokenSessionKey] = $client->getAccessToken();\n    }\n\n    var_dump( $client->getAccessToken() );. So what I am looking for is OAuth 2.0 for server-side standalone authorization and the correct approach may be the Service Account Connection  => https://laracasts.com/discuss/channels/tips/google-api-service-account-connection-laravel-5  . I am trying to use this library to list my private YouTube videos through my website. The list should be available as soon as user open the page without user validation. Can or cannot this be done with this library?. The login error was there because I didn\u2019t click through Authentication Url.  @mattwhisenhunt  thank you for you assistance your library does its work I have just tried to use it in a wrong context.  .\n",
    "Darkbelg": "i'm also having this issue. The default endpoint is no longer correct. And it's not really documented how and where to find the new one.\nIn order to do batch results for the youtube api i have to do this:\n$batch = new Google_Http_Batch($client,false,null,\"batch/youtube/v3/\");\nThe batch path plus the service path seem to be the same not sure if this is just coincidence;. ",
    "millyhung": "The default api base path of Google_Client is https://www.googleapis.com, so it uses https://www.googleapis.com/batch as the endpoint.\nYou could change it by setConfig() in Google_Client before create $batch:\nphp\n$client->setConfig('base_path', 'https://indexing.googleapis.com');\nOr create a batch instance by Google_Service_Indexing.\n```php\n$client = new \\Google_Client();\n$client->setAuthConfig('/var/www/html/privateKey.json');\n$client->addScope('https://www.googleapis.com/auth/indexing');\n$client->setUseBatch(true);\n$service = new \\Google_Service_Indexing($client);\n$batch = $service->createBatch();\n// add request\n$postBody = new \\Google_Service_Indexing_UrlNotification();\n$postBody->setType('URL_UPDATED');\n$postBody->setUrl('https://example.com/jobs/' . $jobs[$i]['job_id']);\n$batch ->add($service->urlNotifications->publish($postBody));\n// ---- add request\n$results = $batch->execute(); // it does authorize in execute()\n```. ",
    "levansonqs": "Thanks my mistake. I forget change project id when call firebase. ",
    "vbresults": "If I am just using the calls I mentioned (YT update via oauth), is there a safe way to delete what I'm not using?. ",
    "NxKai": "I've been keeping track of this issue since the news broke out. I found this link here about a way to do it just by using the default email scope given. Does anyone know how to use it on the Client Library? Help would be much appreciated. Thanks!\n. ",
    "eissasoubhi": "I got the email too saying Google+ Sign-in has been fully deprecated.\nWill there be a support for the changes Google made for Google+ Sign-in?. ",
    "Nazalas": "I am using the client->createAuthUrl() method. Will this continue to work correctly after the Google+ deprecation?. ",
    "artetrad": "I am using the Google_Client's verifyIdToken method. Will this continue to work after the Google+ deprecation?. ",
    "nacesprin": "What is the alternative to?\n$plus = new Google_Service_Plus($client);\n$me = $plus->people->get('me');. ",
    "tylik1": "UPD.\nI was using Socialite Laravel plugin to authorize via Google. In latest release they've fixed issue. \nFrom the commit I can see that the main change was made in the endpoint\nFrom: \nhttps://www.googleapis.com/plus/v1/people/me\nTo:\nhttps://www.googleapis.com/userinfo/v2/me\nHere is the link if anyone is interested in complete changes list\nhttps://github.com/laravel/socialite/pull/319/commits\n. ",
    "ApacheEx": "Hybridauth has been also migrated to Google Sign In, more info here: https://github.com/hybridauth/hybridauth/commit/6123c31700bda7acd49cef7f1f0c138b60f39070. ",
    "w-schmidenberg": "\nWhat is the alternative to?\n$plus = new Google_Service_Plus($client);\n$me = $plus->people->get('me');\n\n@nacesprin I changed the scope to:\n$client->addScope(['email','profile']);\nAfter you fetch the Access Token, you can use this:\n$token_data = $client->verifyIdToken();\nto provide the email.\n. ",
    "sawmurai": "I signed it!. Hm actually I think I just misunderstood the code. I think this PR can be closed then.. ",
    "NoiseEee": "Hi... I'm going to close this after a few hours of messing around and trying many, many things.\nI don't use Windows often, but I did notice the \"antimalware executable\" going crazy when I was installing this (again, on the VM).  I had a hunch it was interfering, so I could have either increased the composer timeout or disabled the \"Real-time protection\" that Windows was offering. I chose the latter and it installed perfectly.  So try disabling host antivirus if dear reader is having similar issues...  . ",
    "ankitdeveloper": "@jdpedrie thank you for a reply. I have checked his response and understand that there is no specification about return label in their document. Can we reach out to Google for same? . ",
    "babushona": "Thanks jdpedrie for putting my code in the original post in a code block.\nUpon further investigations, the bug seems to be stemming from the four POST parameters, that are required for refreshing token, not being URL encoded before passing to Guzzle HTTP client.\nI created my own test function using Guzzle HTTP client,\nCode:\n```\n//$httpClnt as Guzzle HTTP client object\n//Returns Object that was returned by Google API\nfunction fetchAccessTokenWithRefreshToken(){\n   $httpClnt= new GuzzleHttp\\Client([\n   //   'proxy' => 'localhost:8888', // by default, Charles runs on localhost port 8888\n    'verify' => false, // otherwise HTTPS requests will fail.\n  ]);\n$old_acc_token = \"\"; //Original access token from Auth flow\n  //$refresh_token = \"1\\/RKK_6YUq-v-mjgkgw72iuhfwblbfawlkjnfsa7y4kjbfbf\"; //Returns Bad Request\n  $refresh_token = \"1%2fRKK_6YUq-v-mjgkgw72iuhfwblbfawlkjnfsa7y4kjbfbf\"; //Works\n  $client_id = \"\";\n  $clnt_secret = \"\";\necho \"fetchAccessTokenWithRefreshToken::old_acc_token=\".$old_acc_token.\"\";\n  echo \"fetchAccessTokenWithRefreshToken::refresh_token=\".$refresh_token.\"\";\n  echo \"fetchAccessTokenWithRefreshToken::client_id=\".$client_id.\"\";\n  echo \"fetchAccessTokenWithRefreshToken::client_secret=\".$clnt_secret.\"\";\n  $post_body_str =  \"grant_type=refresh_token\" . \"&\".\n                    \"refresh_token=\".$refresh_token . \"&\".\n                    \"client_id=\".$client_id. \"&\".\n                    \"client_secret=\".$clnt_secret;\n$r = $httpClnt->request('POST', 'https://www.googleapis.com/oauth2/v4/token',\n      [\n          'headers' =>  [\n                          'Cache-Control'=> 'no-store',\n                          'Content-Type' => 'application/x-www-form-urlencoded',\n                        ],\n          'body' => $post_body_str\n      ]\n  );\n  var_dump($r);\n  echo \"Response Body\";\n  //http://docs.guzzlephp.org/en/stable/quickstart.html#using-responses\n  $r_body = $r->getBody();\n// Implicitly cast the body to a string and echo it\n  echo $r_body;\n  //echo \"fetchAccessTokenWithRefreshToken::r=\"$r.\"\";\nreturn json_decode($r_body);\n}\n```\nSo, when I supply all parameters in the POST string in URL encoded format, the API works. Otherwise it causes the API to return \"Bad Request\". The google_client->fetchAccessTokenWithRefreshToken() method must be missing URL encoding the parameters.\n. The apostrophes are required by the documentation.\nhttps://developers.google.com/drive/api/v3/search-parameters\n\nThe API actually worked with 'raw' apostrophes.\nFunny thing is that in the same listFiles method, you can pass other parameters, like files.\n$files = $drive->files->listFiles(array(\n                                            'fields' => \"files(id, name, mimeType, parents, properties, trashed, quotaBytesUsed, kind, size)\"\n                                      ))->getFiles();\nThis too gets urlEncoded and same API is called and works.\n\nSo, the Google API service is accepting 'files' in urlEncoded format but not 'q'.. ",
    "cesutherland": "I may be running into this as well \u2014 periodically, our users will fail to authenticate w/ invalid_grant/Bad Request.. We tracked this down to a storage issue on our end \u2014 it was unrelated to what's reported here.. ",
    "pragneshrupapara": "\nTry replacing $message->getSnippet() with the following:\n$body = base64_decode($message->getPayload()->getParts()[0]->getBody()->getData());\n\nIf I need only reply of an email then what should I do? Please suggest me?\nThank you very much for your help . Hello @jdpedrie \nI have used \n\n$message->getThreadId()\n\nand used below getThread function then also I am getting truncated message.\n\nfunction getThread($service, $userId, $threadId) {\n  try {\n    $thread = $service->users_threads->get($userId, $threadId);\n    $messages = $thread->getMessages();\n    $msgCount = count($messages);\n    print 'Number of Messages in the Thread: ' . $msgCount;\n    return $thread;\n  } catch (Exception $e){\n    print 'An error occurred: ' . $e->getMessage();\n  }\n}\n\nWhile I am using your first suggestion \n\n$body = base64_decode($message->getPayload()->getParts()[0]->getBody()->getData());\n\nThen I am getting encoded characters instead of proper email, please check below scenario\n1) Original email content screenshot\n\n2) I am getting below result via $body = base64_decode($message->getPayload()->getParts()[0]->getBody()->getData());\n\n. ",
    "marcus-at-localhorst": "@danielgsims thank you so much for your time and confirmation that this is not possible with this package. \nI was finally able to connect the dots and implement it myself.\nThe key was (and that's what the Firebase JavaScript SDK is doing under the hood), using Google Identity Service to obtain the JWT and then create an uri with https://firebasestorage.googleapis.com/v0/... as endpoint (unlike all the other url google cloud storage schemes like https://googleapis.com/download/storage/v1/b/....).\nThen just sign all calls to https://firebasestorage.googleapis.com/v0/b/my-bucket.appspot.com/o/projects%2F-s0m31D%2Fpicture.jpg with the JWT and back comes the meta data (incl. a token) or the image (if one is adding ?alt=media onto the url).\nIf somebody is stumbling upon this, I tried to describe it here: https://marcus-obst.de/blog/firebase-storage-and-firebase-auth#tldr. ",
    "ashujangra": "after modify $access_token = $client->fetchAccessTokenWithAuthCode($_GET['code']); I got to know the error that showing invalid_grant. Seriously i don't know whats going wrong, Please help. yes .. . ",
    "chandon": "Incredible that it's not working, this library is not even using openId. We can not use it anymore... We'll try another library to authenticate.... ",
    "PederBennedsen": "Several features were shut down by Google yesterday, so daily operation is affected already.\nWe need a fix immediately or another lib...\n. ",
    "robthomas82": "Just wondering if this will be updated in time for the March 7 deprecation. . ",
    "DoubleZed": "I might be wrong here but isn't it so that the Google Api PHP Client is just a way to connect to Google API and whatever API scope is defined to be called by the code is actually used? So if no Google+ scope is defined, that API is actually not being used.\nFor example in the example on Readme - the scope here has nothing to do with Google+\n$client->addScope(Google_Service_Drive::DRIVE);\nTake a look at MediaWiki Extension:GoogleLogin - that one is using Google API PHP Client but no Google+ API scope is actually called.\nMy point is - take a look at your code - a fix to the Google API PHP Client will probably not fix the issue.. ",
    "rubenperezpro": "@jdpedrie \nthx for your reply (and sorry for my bad English)\nyes example when I use file_get_contents it's working as well\nI think its from Guzzle Client maybe because when I use  CURL  in the normal way all my requests go fast \n. i check logs i found error : \nAH00124: Request exceeded the limit of 10 internal redirects due to probable configuration error. Use 'LimitInternalRecursion' to increase the limit if necessary. Use 'LogLevel debug' to get a backtrace., referer: https://\n. its okay i found solution its fix my problem, i set timeout to guzzle client  :\n         $guzzle = new GuzzleHttp\\Client(['timeout'  => 2.0,]);\n        $client = new Google_Client();\n        $client->setHttpClient($guzzle);\n\nthx @jdpedrie . ",
    "mandavister": "It's exactly how I thought it would need to work but really wouldn't have been able to accomplish it when I look at it now. Works out of the box! Thank you so much.. @jdpedrie Would you like to copy your answer to the exact same question over here. So more people find help to this rather popular problem and you get the fame ;). ",
    "safciplak": "i wanna update local price for example\nMy main currency TRY\nBut i need RUB = russion ruble\nor EUR\nor USD \nor other curriences\ni mean these prices i wanna create a store managment system.\ni read a few stackoverflow issues \nfor examples this one : https://stackoverflow.com/questions/34533440/how-to-change-the-android-in-app-product-local-prices-through-android-publisher\nplease help me \ncheers\n\n. ",
    "ZGINMADAO": "\nHi @ZGINMADAO, could you share a code snippet so we can help take a look?\nthank you  very much for your reply, here is my code. the code references service-account.php in the examples. \n\n. > > Hi @ZGINMADAO, could you share a code snippet so we can help take a look?\n\nthank you  very much for your reply, here is my code. the code references service-account.php in the examples.\n\nthe response\n\n\n\n. ",
    "djvirgen": "According to the documentation on PHP Array Operators:\n\nThe + operator returns the right-hand array appended to the left-hand array; for keys that exist in both arrays, the elements from the left-hand array will be used, and the matching elements from the right-hand array will be ignored.\n\nSo this should be:\n$this->options = $options + $this->options;\nI hope this helps!\n. "
}