{
    "mrclay": "http://code.google.com/p/minify/wiki/FAQ#Why_do_the_CSS_&_HTML_minifiers_add_so_many_line_breaks?\nI'm considering making introduceLinebreaks an option that's off by default.\n. Processing speed isn't a huge deal, memory usage and backtracking in PCRE functions is. In the short term, adding a simple option to NOT introduce line-breaks would be nice.\nIt isn't glamorous work, but the best long-term solution is to port this to PHP. As new features are introduced in the Java version, these would be much easier to port into a direct PHP port than into mine.\n. Please use this configuration in config.php. I no longer intend to support the default Minify_CSS_Compressor component.\n. Thanks!\n. This usage (linking to server-cache files) is not recommended for a number of reasons. For generating HTML, you might want to look at min/utils.php.\n. Thanks. Yes, awhile back I changed the behavior so that each file gets sent separately to its minifier, but for a remote API (and compression) you want everything bundled and sent as one request.\n. Added separate issue https://github.com/mrclay/minify/issues/6\n. Fixed in 3c5543c3ea2ee324b37409910630ae3bfdf41d89\n. Joe, can you verify that f67da8e359059ca877063411f6efd15cc5f9746a (just committed) results in fewer API calls when using ClosureCompiler?\n. Can you watch issue 6 so I can move this conversation there?\n. Fixed in f67da8e359059ca877063411f6efd15cc5f9746a\n. Joe said: \"I assume there are fewer API calls because now I just get the following error: \"Minify: Exception in minifier: POST content larger than 200000 bytes\"\"\n. The branch \"issue6\" moves Minify::_combineMinify to Minify_Process::process and adds support for minifier classes exposing the maximum bytes they can handle. d87780ecb8872a33bd93ed069431f4aff7d38e01\n. I'd forgot about this branch. I think this needs to go in the (eventual) refactoring. It seems just to add to the current mess.\n. Thanks! Fix just committed in master\n. Thanks! I'll test this in a few days. Did you add/change any unit tests for it?\n. Thanks!\n. Just add \"&\" and a number to the URL to trigger far-future Expires. E.g. /min/f=file.js&1\n. Please privately send me one example. The class Minify handles no input. Input is processed by min/index.php and the controller classes, usually MinApp.php.\n. I'm aware of that, but It is not at all being used here for security purposes.\n. This needs rebasing and is way too many changes to evaluate. I would remove all the non-essential commits (e.g. white-space) and switch to using a CDN-served bootstrap. Also I don't to include Bootstrap's unit tests, etc.\n. Latest Bootstrap added in master https://github.com/mrclay/minify/commit/9231aed49f15179f6dff7fd9cb62aa1a7c228996\n. It was not intended/tested for this purpose. It may work, but will certainly modify markup embedded unescaped in CDATA sections, etc.\n. Sounds reasonable. Why not edit the files directly on github and send a pull request?\n. Thanks!\n. Great. Thanks!\n. Git can auto-modify line endings on checkout. I wonder if this is having an effect. I was purposefully leaving some files CRLF because that was part of the minification tests, but that could easily be reduced to a single test. I'm hesitant to introduce so big of a changeset w/o knowing what exactly is going on here.\n. What is the error?\n. Use the pre-minified version and make sure the filename ends with -min.js or .min.js. Minify will not alter these files.\nThough it looks like the latest Rafael version should be safer to run through JSMin. The line:\nheight = +bb[1] + (origin == \"baseline\" ? bb[3] - bb[1] + (+font.face.descent) : (bb[3] - bb[1]) / 2);\nminifies to:\nheight=+bb[1]+(origin==\"baseline\"?bb[3]-bb[1]+(+font.face.descent):(bb[3]-bb[1])/2);\n. Thanks!\n. Could you make utf-8 and SIMPLE_OPTIMIZATIONS the default values and send a new PR?\n. I didn't notice you had added the commit\n. I thought I hit merge! I have to look into this later tonight.\n. I'll manually merge soon. Busy weekend\n. Web 1.0 error: when you re-open a PR, the ajax doesn't add the auto-merge button; you have to reload the page.\n. I'd like to see more docs on how a user would benefit from this. I assume there's some server config involved to take advantage of this in practice.\n. This isn't proper use of a cache layer (the internal workings shouldn't be relied on). I think using CLI tool in your build and being explicit about where output goes is the way to go here.\n. I don't have time to implement this but this JS version looks easiest to port: https://github.com/twolfson/node-jsmin2/blob/master/lib/jsmin.js\n. Agreed, Minify_HTML_Helper::getRawUri should take into account more than the max mtime. Since this is likely to run on every HTML page, it should probably not be more advanced than md5(serialize(arrays of filepaths and individual mtimes)), then cut that into 10 or so digits. Or better, allow non-digits in the trigger for far off expires.\n. To get the mtimes you need the filepaths so we may as well use it (it will involve some refactoring). If we don't someone will complain that they swapped out one file for another and it didn't change...\n. On 6/1/12 7:01 AM, Elan Ruusam\u00e4e wrote:\n\nhere's implementation for 1) - https://gist.github.com/2851198\n\nPlease fork and submit this as a pull request.\nSteve\nhttp://www.mrclay.org/\n. Sorry, your branch is fine. I'll look at this ASAP and probably will merge as is.\n. I did not want tons of old cache files piling up requiring a cleaning process, so cacheId regards everything EXCEPT timestamps. That way, if the user is just altering files, the Minify cache files are reused.\nYou're right that this means the cache is not properly invalidated if MAX(timestamps) doesn't increase. It requires the user to touch() at least one source file in that case.\nI think the only real fix for this is to move to a system like this.\n. Closing in favor of #41\n. I think I'll add a separate config file for the CLI.\n. With the refactoring going on this isn't a priority right now.\n. Could you try raising PHP's pcre.* settings?\n. code.google is the main, github is mirror, but I welcome Github PRs.\n. Can you do rm -rf /tmp/minify_* and then try your dev server again? Minify should be checking cache file existence and readability before trying to use it, so fopen() should not fail under normal operation. Tried unit tests?\n. Done!\n. I would love a PR for that. I haven't had a lot of time to devote to Minify lately.\n. I converted to autoloading 2 months ago so all it should need is the composer.json\n. No, sorry.\n. Great idea. Minify if type missing or one of these: http://tools.ietf.org/html/draft-hoehrmann-script-types-03#section-7\n. I won't be able to get to this anytime soon.\n. Thanks, but fixes for this component should go to https://github.com/tubalmartin/YUI-CSS-compressor-PHP-port\n. Can you send a URL to this CSS file?\n. It finished, but took 45 seconds on my laptop. You should try the CSSMin configuration; I bet it's a lot faster.\n. There's something about the content that causes it to be slow, for CSS the process will never be O(n). You could experiment with taking parts of it out. http://code.google.com/p/minify/wiki/CookBook\n. The answer may be that non-file sources should return MD5(last modified time).\n. Good catch. did not know about this.\n. Done, thx! https://packagist.org/packages/mrclay/minify\n. Debug option seems a good solution but I don't know when I'll have time to work on this :(\nIt wouldn't be super hard to modify JSMin to enable keeping all characters and triggering a function to handle \\ns, but the future is sourcemaps so this doesn't seem worth the effort.\n. Merging #64 into this\n. Closing this in favor of #433\n. Thanks for adding a test!\n. Thanks for the update!\n. Thanks!\n. API might have changed. Have no time to debug this anytime soon.\n. Returning false if fopen fails seems the simplest step forward.\n. Ideal would be to create a \"rebuilding\" file as soon as we recognize the cache is stale and unlink it after saving the new content. If another process sees that file, it serves the stale cached version or waits for it (maybe). But Minify doesn't need to be perfect here. If your site's big enough to have these problems it's time to use a custom approach anyway.\nPermissions problems should get logged.\n. The builder JS should be using jQuery 1.6.3. When/if I upgrade the included jQuery I can change this.\nPlease reopen if I'm missing something, or there is something broken in the default install. Also, a suggestion solution would be nice :)\n. I think this is the failure case:\njs\nsetOuterHeight(\n    eventElement,\n    slotHeight * Math.round(\n        (event.end ? ((event.end - event.start) / MINUTE_MS) : opt('defaultEventMinutes'))\n            / opt('slotMinutes')\n    )\n);\nJSMin sees / opt... as the start of a regexp.\n. Yes, will tag. Thx for the semver link. Definitely need to define the public API more concretely.\n. 2.1.6 is tagged!\n. I don't see the need to distinguish between HTML and HTML5. We should be using HTML5 semantics always. There will be plenty of cases where HTML5 elements will be put in HTML4 documents and we will need to minify them properly.\n. Despite these comments I'm open to this feature. It looks like you'll need to rebase to master.\n. Closure Compiler uses an HTTP API. I'm not sure how much error handling I've built into that wrapper.\n. By default, errors trigger a fallback compression via JSMin: https://github.com/mrclay/minify/blob/master/min/lib/Minify/JS/ClosureCompiler.php#L58\n. In min/config.php, try this:\nphp\nclass MyLogger {\n    public function log($msg, $label) {\n        error_log(\"$label: $msg\");\n    }\n}\n$min_errorLogger = new MyLogger();\n. Moved to #46.\n. Now tagged, thx for the tip.\n. I've not tested the CLI tool on Windows. In bash the expression is expanded to an array of files before it's handed to the executable. Apparently I'd have to call glob() manually in my code.\n. I think due to the shell different I can't support wildcards on Windows.\n. I can't fix this without breaking something else. If you need this feature please use single line comments where appropriate or provide a fix. Both these should work:\n``` js\n// http://example\nalert('success');\n/*\n * http://example\n /\nalert('success');\n``\n. \"Debug mode\" is done by the class Minify_Lines, not a minification engine. \n. There are two solutions to this already\n1. Create a class object with props and have the callback be to a method\n2. Make your content function anonymous and send in vars viause ()` from the surrounding scope\nI kind of think option 1 sounds better than adding argument support since it encourages OO design. Thoughts?\n. Third alternative: extend Minify_Source and have your own logic in getContent(). I'd like to move in the direction of simplifying that component; it's responsible for way too much logic.\n. Try the CSSmin configuration. https://code.google.com/p/minify/wiki/CookBook\nOtherwise use an already minified version and end the filename with -min.css or .min.css\n. If the file is named bootstrap.min.css, Minify_CSS_Compressor will not be used. As a separate issue, I plan to retire Minify_CSS_Compressor in favor of CSSmin. You should use it.\nPHP's PCRE integration is buggy and prone to silent failure. I've given up on trying to fix these cases.\n. @gtraxx https://code.google.com/p/minify/wiki/CookBook#CSSmin_PHP_port\nSee also http://code.google.com/p/minify/wiki/CommonProblems#PHP/Apache_crashes\n. Yes, that code goes in config.php. After, you may want to clear your browser cache.\n. This is a PHP/Apache config issue, not a code problem. http://code.google.com/p/minify/wiki/CommonProblems#PHP/Apache_crashes\n. I'm not against such a feature but I don't have time to add it anytime soon.\n. You will need to develop a special minify function to pre- and post-process these files to support this use case. I don't intend to add this support to Minify.\n. You can debug iOS Safari via desktop safari. Google for how to set this up.\n. Good detective work so far. I use this for easier testing of bugs like this. Just remove bug chunks of the script until you indentify the problem area.\nMy time is super limited right now but if you can help narrow down the failing case I'll give a shot at fixing it.\n. Fixed in master branch.\n. .class1 .class2{} is minified to:\ncss\n.class1\n.class2{}\nI.e. the space is replaced by a newline.\n. Switched to HTTPS URL.\n. See http://stackoverflow.com/a/14394996/3779\n. Yes. The manual patch was moved into the controllers for 2.1.7.\n. Thanks for these.\n. This seems like not a good use of a cache layer (relying on it to make certain artifacts available outside the black box). You can already use Minify::combine or the CLI minify.php to route output to specific locations.\n. Please use http://groups.google.com/group/minify for support.\nIf you made a class that extended Minify_HTML, you could override the _commentCB method and have it always return $m[0].\n. Can you post a URL to that file?\n. This can't be fixed: http://www.mrclay.org/2013/11/27/jsmins-classic-delimma-division-or-regexp-literal/\nMake sure the source filename ends with -min.js or .min.js and Minify will skip JSMin.\n. Will try to merge this soon\n. Merged in https://github.com/mrclay/minify/commit/ef726e261b9815d5a4f7e1c2231a72a2749bee62\n. This is a welcome feature but the implementation is too copy-paste. It looks like you could easily alter the original class to handle both environments. Or refactor so the new class just extends the other, making small changes.\n. Great simple solution. Can you document this use case in MIN.txt?\n. With this iteration why not allow setting the full paths of each config file? Forcing users to keep my choice of filenames seems odd.\n. It would be 2.2.0 and I need to update HISTORY with stuff added since 2.1.7. Wanna help with this?\n. Can't this be done already via the Minify postprocessor option. Your function will be sent the content and the type. This is also better because you're guaranteed to have the full CSS in one string, whereas the combine method sometimes will process the CSS in chunks.\nAlso Minify already bubbles imports to the top. Why is the preprocessor needed?\n. Is there any reason this option shouldn't be on by default? I can't remember why I chose disabled.\n. Consider you have a page that links A.css and B.css, both of which have imports. The order becomes: A-import A B-import B. But if you combine the files and bubble imports the order becomes: A-import B-import A B, which will be valid and you won't notice that the cascade may have changed.\n. I.e. I'd rather Minify produce invalid CSS and force users to thoughtfully adjust their strategy to consider the order rules are received.\n. Looks excellent. Can you rebase this to get rid of the merge commit?\n. Actually, I can do this for you.\n. Merged and tagged. Big thanks!\n. Can you remove the whitespace changes from this? I'm open to making a WS policy across all files, but prefer not to mix with functionality.\n. .editorconfig added.\n. Just curious, what happens if you encode the space like: Testimonial\\20box ?\n. Is this on Windows? Spaces seems to work for me. Escapes are indeed interpreted as directory separators, but that's a separate bug.\n. 3.x work now in master.\n. I'm not crazy about the complexity here. I'm thinking the HTTP clients should be moved to classes or callables or something.\n. The master branch now has v3 dev work. Check it out if you want to dig into this again.\n. Minify is designed for valid stylesheets:\n\n@charset must be written literally, i.e., the 10 characters @charset \" (lowercase, no backslash escapes)...\nhttp://www.w3.org/TR/CSS2/syndata.html#x57\n. Thanks. This could really use a test case, but the plan is to switch Minify to default to using https://github.com/tubalmartin/YUI-CSS-compressor-PHP-port for CSS handling, which is better and seems to incur fewer PCRE-related crashes.\n. (You may want to verify CSSmin handles at-rules, too, but I assume it does.)\n. I'm in the process of moving so this may wait awhile.\n. master is using CSSmin via composer\n. Thanks. Could you normalize to all spaces for indenting and squash these all to 1 commit?\n. With git push you can use -f to force the new commit and this pull request will update.\n. Looks good. Could you add a simple unit test like https://github.com/greensolid-technologies/minify/blob/master/min_unit_tests/test_Minify_Cache_APC.php and tie it into the test_all.php file?\n. Thanks, but this can already be done via the CLI app or you can build something similar trivially using Minify::combine().\n\nAs is, this PR makes a bunch of functionality and style changes I can't accept and the Gen class is completely without documentation and duplicates existing functionality.\n. Minify has to combine files like:\njs\nstatement()\n// file ends with comment\njs\nfunction h() {}\n...which yields:\njs\nstatement()\n// file ends with commentfunction h() {}\nUnless you join the files with \\n; JSMin will break the combined file.\n. No error is those statements. http://codepen.io/anon/pen/IoJfg\n. I promise Minify is not adding them conditionally or examining the files in any way. It's pretty dumb :)\n. Take a look, here's where it's added https://github.com/mrclay/minify/blob/master/min/lib/Minify.php#L468\n. Correctly rewriting relative paths in CSS is a chore and the current config led to the lead headaches across environments (e.g. Windows, where often __FILE__ would be a physical path but document_root would some logical path). I recommend your approach here though: https://code.google.com/p/minify/wiki/AlternateFileLayouts\n. Without the $min_symlinks entry, relative URLs in CSS will break whenever /min/ isn't a direct child of DocumentRoot, such as in http://localhost/mysite/min.\nSince this would simplify use across dev/prod environments (simpler than other solutions I've suggested) I'm inclined to make this change. Wanna make a PR?\n. Wanna give a shot at fixing this?\n. See https://code.google.com/p/minify/wiki/CommonProblems#Output_is_distorted/random_chars\n. Will be happy to reopen and re-sync when @tubalmartin integrates this fix.\n. The general problem is caching/file monitoring; this won't invalidate the cache if imported files are modified, just the ones Minify knows about directly. That's not a huge problem but this should be clearly documented.\n. This looks like LESS will get converted to CSS but due to the different type won't be further processed as CSS, and won't get the necessary URI rewriting.\n. The long term plan is deeper Composer support (#113), so I think in the short term I'd prefer to add extension points to the Minify classes rather than pull more into the repo for particular use cases.\n. @glensc I've added you as project collaborator, thanks for helping move things along.\nCheckout gcode issue 50 for an outline of how I think this should work. Basically, we switch from property read to getLastModified() in Minify_Source, and implement a way to keep track of a list of files so we can quickly pull mtimes without having to re-parse includes on every request.\n. So I kinda think this is next step in refactoring: #114\n. Yeah MinApp is a factory. It probably needs to accept some sort of configuration to define how files get turned into source objects. \nphp\n$lessFactory = function ($file) {\n    if (pathinfo($file, PATHINFO_EXTENSION) == 'less') {\n        return new LessCss_Source($file);\n    }\n};\n$minApp->registerFactory($lessFactory);\nWhen comes time to turn a filepath into an object, we call factories until they give us an object back. At the end of the list is the built-in factory that knows how to return Minify_Sources.\n. But we kinda need this functionality in any API that we want to accept simple strings in place of objects.\n. Reflection sounds OK but since the cache is needed I'd rather inject it in the constructor (e.g. 2nd arg).\n. Two other cases: SASS and a source that actually processes @imports. In fact, we should design a generic TreeSource that allows plugin in the particulars of these cases. They're basically all the same: maintain a list of files that need to be mtime checked, if any change, reprocess.\n. First check out https://groups.google.com/forum/#!topic/minify/PUcDGMM5VYU\nA problem I see here is having the LESS source report its content type as text/less (we certainly don't want to serve that). The source object should shield the rest of the system from the fact that this is a LESS file; I think from the outside it should look just like CSS.\nPlease do check out the WIP_dynamic_objects branch.\n. Yes we should just adapt Minify_Source to accept .less in the short term instead of a special class.\nIt's hard to see what changed in a branch. You can always just open a PR with \"WIP\" in the title and that way we can point out individual lines. I'll do that for the dynamic_objects branch.\n. Yeah, PHPUnit would be ideal, but not high priority for me.\n. Rather I think there will be two suites. Simple web context to make sure environment is suitable (does not double-encode, e.g.), then individual components will have PHPUnits, refactoring as needed to make them testable.\n. Forgot to write: this looks great so far.\n. I merged this into a new 3.0 branch.\n. @glensc FYI I've started work on this, moving the static Minify_Source methods to a new Minify_SourceSet class, and turning the public props into get/setters.\n. These changes aren't worth littering the commit log. If you can isolate this to just the changed lines and squash it all to one commit I'll be happy to accept it.\n. Null cache sounds good to me!\n. FYI my long-term goal is to make Minify a regular object instead of a static class (i.e. give it a constructor and make all methods/properties dynamic).\n. Taking a look at https://github.com/mrclay/minify/tree/api_rework/min/lib/Minify might give you an idea of where I was headed before my free time got eaten up :)\n. E.g. it has a null cache :)\n. An interface is the goal. I don't mind having both. Using an abstract base in place of an interface feels like a code smell to me.\n. Once we add the 3.0.0 tag I'd like to feel good enough about those APIs to support for a few months at least. I feel like we have some momentum to move the design forward quite well and I'd rather not have to keep retagging major versions frequently (for semver).\nWe'll need to rename the interface when we convert to namespaces. So Minify\\CacheInterface\n. I did the rename and merged into 3.0\n. @glensc any input on this?\n. Sorry, my available time to work on this has been spotty. Yes, rebase and we'll make that a new 3.0 branch. Maybe Minify_Source_LessSource and Minify_Css_Less? I'm not worried about names at this point. Easy to change later.\n. Wouldn't it be better to get rid of Minify_Loader and offload all autoloading to composer?\n. I.e. go ahead and make a hard dependency on composer.\n. @glensc yes I'd prefer us not to maintain copies of stuff already on Packagist. Whatever isn't on there, we rename to conform with PSR-0.\n. This feature needs to go away and be replaced by a source map or a version based on real token parsing.\nFeel free to suggest an improvement but I don't have any time to devote to this\n. See https://code.google.com/p/minify/wiki/FAQ\n. Please google for how to make callbacks.\n. Cool. Need to update composer.json so these are in \"required\" section.\n. Since they were distributed before, what do you think about leaving them required for now and moving them to suggested at first major version bump? I'd like to make CSSMin the default CSS minifier then actually.\n. I'm just thinking the developer experience of hitting fatal errors trying to autoload is not great. Would be useful to mention composer in the docs.\n. Tagged 2.2.1\n. It's a good idea. Your basic task is rewriting (.*?\\.css)\\?min to something like min/?f=%1. You'll want to get help from StackOverflow or something.\n. The Minify_HTML class is not actively maintained and is likely to be slow. I would make it an experimental option if I were to use it in a product.\n. The class is released under this license https://github.com/mrclay/minify/blob/master/LICENSE.txt\n. Already done in 3.0. @Scooby-2 give this a shot if you can.\n@glensc Do you think this would cause any BC problems?\n. Replaced by #476. Please take a look.\n. Easiest would be to move to a completely new GH project, wouldn't have to worry about issue numbers. You got any ideas about making this easy?\n. I had planned to export to a temporary GH project, then merge its resources here, but I'm open to other ideas.\n. Find someone who's already done it :) Ask stack overflow. \n\nOn Apr 17, 2015, at 9:03 AM, Elan Ruusam\u00e4e notifications@github.com wrote:\nhow do you merge tickets?\n\u2014\nReply to this email directly or view it on GitHub.\n. Great! Although I recommend using CSSmin instead, as it's more actively maintained. Could you squash these into two commits, one for CSS work, other README?\n. I've deprecated this minifier and switched the project to https://github.com/tubalmartin/YUI-CSS-compressor-PHP-port by default. If you'd still like to fix this, please rebase master. The contents of the min directory are now in the root.\n. JSMin will never handle this well. If it's not bypassing minified files, that's the problem to solve.\n. All file paths go through here, which handles turning off minification for the individual source.\n. ?f only accepts paths from the docroot, so you don't need any leading slashes.\n. I've finished this feature up, squashed the commits, and merged to master. https://github.com/mrclay/minify/commit/d233b65d3dc183933c5be8a16b5b7eaf313ef66c\n. Thanks for this useful addition.\n. Reported by rgrove on 2007-05-03 05:52:00\n- Labels added: Milestone-Release-1.0.1\n- Labels removed: Release-1.0.1\n. Reported by rgrove on 2007-05-03 05:55:05\n- Labels added: Milestone-Release-1.1.0\n- Labels removed: Milestone-Release-1.0.1\n. Changing priority to low. This is a much bigger pain in the ass than I thought it\nwould be.\n\nReported by rgrove on 2007-06-01 17:33:13\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium, Milestone-Release-1.1.0\n. Check out the code for Smarty strip. Might be a good starting point.\n-ji\nReported by pdt256 on 2008-01-23 08:08:28\n. ```\nSee http://code.google.com/p/minify/source/detail?r=50\nTo see in action, checkout and browse to /web/test/test_HTML.php and /web/example/1/\nNeeds more thorough docs.\n```\nReported by mrclay.org on 2008-02-29 00:44:01\n- Status changed: Verified\n. Done and done.\nReported by rgrove on 2007-05-04 05:41:23\n- Status changed: Fixed\n. ```\nI don't think so. Yesterday i implement minify one EDP framework.\nMinifiy take 12sec for minifiying 9 jquery scripts (jquery core, jquery ui, and some\nplugins).\nThis is too much.\n```\nReported by danijel.job on 2012-01-14 14:47:08\n. Use the version on github. It will skip minifying files that end with .min.js or -min.js\nfor one thing, so use pre-minified files where available. Also this process only runs\nonce until your files change.\nReported by mrclay.org on 2012-01-14 15:43:47\n. Reported by rgrove on 2007-05-04 03:51:26\n- Labels added: Milestone-Release-1.0.1\n- Labels removed: Milestone-Release1.0.1\n. Changing to low priority, since the CSS comment hacks I'm aware of are only useful\nwith old, long-abandoned browsers and as such probably aren't widely used anymore.\nReported by rgrove on 2007-05-04 04:02:06\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium, Milestone-Release-1.0.1\n. ```\nv2's Minify_CSS class is passing several test cases with hacks:\nhttp://code.google.com/p/minify/source/browse/trunk/web/test/css/\nsubsilver.css was chosen as a real-world usage scenario, but more testing is\ncertainly needed.\n```\nReported by mrclay.org on 2008-02-29 00:56:40\n- Status changed: Started\n- Labels added: Priority-Medium\n- Labels removed: Priority-Low\n. R82 verifies BMH and MSIE filters are left intact.\nReported by mrclay.org on 2008-05-14 16:16:45\n- Status changed: Fixed\n. Reported by rgrove on 2007-08-28 17:14:01\n- Status changed: Invalid\n. Reported by rgrove on 2007-08-28 17:26:22\n- Status changed: Accepted\n. ```\nYou'd probably have to maintain a patched scriptaculous.js. It probably has code to\nlook for itself in the src attributes of all script elements. This code would have\nto be altered to match against your minify URLs.\n```\nReported by stephen.clay on 2007-09-21 16:56:18\n. ```\nUsing v2 you could specify your files from PATH_INFO (with a custom script) and call\nMinify::serve() with the Files controller[1], allowing a URL like:\n/m.php/prototype.js/scriptaculous.js?load=effects\n[1] http://code.google.com/p/minify/source/browse/trunk/lib/Minify/Controller/Files.php\n```\nReported by mrclay.org on 2008-02-29 01:06:17\n- Status changed: WontFix\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. Reported by rgrove on 2007-05-20 00:10:07\n- Status changed: Invalid\n. Reported by rgrove on 2007-05-20 00:10:33\n- Labels added: Type-Enhancement, Priority-Low\n- Labels removed: Type-Defect, Priority-Medium\n. This is a great idea and is very easy to implement. If someone has, please let me know..\nReported by pdt256 on 2008-01-23 08:10:46\n. ```\nTo use Memcache in v2 you'd just need a wrapper class that implemented\nCache_Lite_File's get() and save() methods. The wrapper would need to store the last\nmodified time in memcache with the content, and make sure get() failed when\nself::$_options['lastModifiedTime'] was later than the stored time.\nThen you'd subclass Minify and rewrite _setupCache() to instantiate the wrapper:\nhttp://code.google.com/p/minify/source/browse/trunk/lib/Minify.php#250\nWhen v2 is released, I'd be willing to look at patches for this.\n```\nReported by mrclay.org on 2008-02-29 00:37:59\n- Status changed: Accepted\n. Reported by mrclay.org on 2008-05-14 16:41:03\n- Status changed: WontFix\n. Reported by rgrove on 2007-05-20 00:11:03\n- Status changed: Invalid\n. JSMin, which Minify uses to compress JS, only works with valid JavaScript. The\nminmax.js file you attached contains JScript conditional comments, which are an\ninvalid Microsoft extension to JS supported only by IE. As a result, the entire\nscript is treated as a comment by standards-compliant JavaScript parsers.\nReported by rgrove on 2007-08-28 17:17:46\n- Status changed: WontFix\n. ```\nVersion 2.1+ won't break the file, but won't minify it either (it ignores but does\nnot delete Jscript conditional comments).\nFWIW this file is bad practice now (IE7+ doesn't need it) and it encouraged a bad \ndesign (should be conditionally linked in the HTML so only IE requested it).\n```\nReported by mrclay.org on 2008-11-27 15:31:33\n- Status changed: Fixed\n. thanks!\nReported by jens@jedisthlm.com on 2008-11-27 16:10:42\n. same applies for jsmin.php (__construct()/jsmin())\nReported by xaos123 on 2007-06-05 13:18:59\n. Reported by rgrove on 2007-06-23 18:06:44\n- Status changed: Fixed\n. Reported by rgrove on 2007-08-28 17:18:09\n- Status changed: Accepted\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. ```\nCould you test the SVN code on IIS? \nIn any case, Minify_CSS no longer tries to rewrite paths, only prepends a given\nstring to relative URIs. E.g. \"../img/\"\n```\nReported by mrclay.org on 2008-02-29 02:52:51\n- Labels added: Priority-High\n- Labels removed: Priority-Low\n. SVN code should not have this issue\nReported by mrclay.org on 2008-05-14 16:39:53\n- Status changed: Fixed\n. Reported by mrclay.org on 2008-05-14 16:54:42\n. Reported by rgrove on 2007-08-28 17:18:28\n- Status changed: Accepted\n- Labels added: Priority-High\n- Labels removed: Priority-Medium\n. I believe the SVN /lib/Minify/CSS.php already preserves these hacks. See the test\ncases in /web/test/css/.\nReported by mrclay.org on 2008-02-29 02:49:39\n- Status changed: Fixed\n. ```\nI later realized that the hash generated for both versions of a file (debug=0 and \ndebug=1) is the same, when shouldn't. So:\npublic function getHash() {\n    if ( isset($_GET['debug']) && (int)$_GET['debug'] ) $debug = 1;\n    return hash('md5', implode('', $this->files). $debug);\n}\nCheers,\nVictor\n```\nReported by espigares on 2007-07-22 11:32:25\n. Reported by rgrove on 2007-08-28 17:18:56\n- Status changed: Accepted\n. ```\nWith the SVN version this will be easy. Have the user code listen for the GET var and\nset all the minifiers to use an identity function. Something like:\nfunction identity($content, $options) { return $content; }\n$minOptions = array();\nif (isset($_GET['debug'])) {\n    $minOptions['minifiers'] = array(\n        'text/css' => 'identity'\n        ,'application/x-javascript' => 'identity'\n        ,'text/html' => 'identity'\n    )\n}\nMinify::serve(\n    'ControllerName'\n    ,array( / controller options / )\n    ,$minOptions\n);\n```\nReported by mrclay.org on 2008-02-29 02:44:25\n. ```\nThe controller and Minify options have been combined, so now this would be slightly\ndifferent:\n$options = array();\nif (isset($_GET['debug'])) {\n    $options['minifiers'] = array(\n        'text/css' => 'identity'\n        ,'application/x-javascript' => 'identity'\n        ,'text/html' => 'identity'\n    )\n}\nMinify::serve('ControllerName', $options);\n```\nReported by mrclay.org on 2008-05-14 16:33:30\n- Status changed: WontFix\n. This was added in 2.1.0, can be enabled in /min/config.php\nReported by mrclay.org on 2008-11-27 15:14:21\n- Status changed: Verified\n. If you're preprocessing your JS files with PHP, then the best solution would be to\nturn on output buffering at the top of the file, then use JSMin to minify the\ncontents of the processed buffer and send that to the browser. I don't plan to add\nPHP preprocessing functionality to Minify.\nReported by rgrove on 2007-08-28 17:21:12\n- Status changed: WontFix\n. ```\nThis can be done in 2.x verions by using a custom Minify_Source object instead of a\nfile path, e.g. in /min/groupsConfig.php. For performance you'd need to provide a \nlast modified time (or emulate one).\nAsk the google group how to get this working.\n```\nReported by mrclay.org on 2008-11-27 15:23:43\n- Status changed: Fixed\n. ```\nJSMin, which Minify uses to compress JS files, works best with JavaScript that passes\na JSLint examination. Ambiguous increment operators like the one in that line are\ngenerally considered unwise since they're guaranteed break when whitespace is removed.\nI recommend changing that line to: var i = 0, string = 'foo' + (i += 1);\n```\nReported by rgrove on 2007-08-28 17:25:40\n- Status changed: WontFix\n. Btw, this is with 5.2.3\nReported by adwords@netcare.at on 2007-08-24 13:09:11\n. Reported by rgrove on 2007-08-28 17:26:10\n- Status changed: Accepted\n- Labels added: Priority-High\n- Labels removed: Priority-Medium\n. SVN version should be E_STRICT compliant except for Cache_Lite_File. Although we're\nrunning a patched version of this, I'd rather not make radical changes to it for full\ncompliance; Cache_Lite_File is well-tested.\nReported by mrclay.org on 2008-02-29 02:14:53\n- Status changed: WontFix\n- Labels added: Priority-Low\n- Labels removed: Priority-High\n. Fixed in 2.x version\nReported by mrclay.org on 2008-11-27 15:25:29\n- Status changed: Verified\n. Reported by rgrove on 2007-08-28 17:06:01\n- Status changed: Invalid\n- Labels removed: Priority-Medium\n. not quite sure why it is invalid. it's a perfectly valid point. a better alternative\nto jsmin and the pre mentioned \nscript is http://joliclic.free.fr/php/javascript-packer/en/\nReported by buggedcom on 2007-08-28 21:15:52\n. ```\nJSMin doesn't \"bail\" on large libraries. The problem you're seeing is that Prototype,\nScriptaculous, and some other libraries are written with bad coding practices that\nJSMin doesn't tolerate. The rule of thumb is that if JSLint throws warnings, you're\nlikely to run into problems with JSMin.\nPacker is a reasonable alternative to JSMin, but whether or not it's better is\narguable. They both have their advantages and disadvantages.\nI'd advise against using your regexp-based minification function. JavaScript is a\nnotoriously difficult language to parse correctly, and those regexps are absolutely\nguaranteed to introduce errors (especially the 'remove extra spaces' regexp, which\ndoesn't take strings into account).\n```\nReported by rgrove on 2007-08-28 21:23:11\n. ```\nI believe I read someone now maintains JSMin-friendly versions of these libraries \n(or you can get pre-minified versions). Regardless, in version 2.x you can use the\nPHP5 Packer (or any other code) for certain files if you want. The configuration is\na little tricky, but ask on the google groups.\n```\nReported by mrclay.org on 2008-11-27 15:37:57\n- Status changed: Fixed\n. The upcoming alpha release will only alter URIs that are relative (images/my.gif) and\nprotocol-relative (//images/my.gif).\nReported by mrclay.org on 2008-02-28 12:15:05\n- Status changed: Started\n. SVN does not have this issue\nReported by mrclay.org on 2008-05-14 16:26:53\n- Status changed: Fixed\n. ```\nHi\nI modified the code a bit so that gzip compression is enabled on the scripts loader\n  $minify->browserCache();\n  ob_start(\"ob_gzhandler\");\n  echo $minify->combine();\n\nAdded that line between and it works like a charm. In fact I am using normal source\nfiles for all js library files.\nYour script is amazing thanks to you.\n```\nReported by hmimthiaz on 2008-01-31 14:29:46\n. See trunk!\nReported by mrclay.org on 2008-02-29 02:10:01\n- Status changed: Verified\n. This is an excellent idea. Thanks.\nReported by rgrove on 2007-09-21 17:21:00\n- Labels added: Type-Enhancement\n- Labels removed: Type-Defect\n. In trunk!\nReported by mrclay.org on 2008-02-29 02:06:56\n- Status changed: Verified\n. SVN version now has an option 'cacheUntil' for setting the Expires header (instead of\nconditional GET). What's still needed is the mechanism for watching files and\nmaintaining the build #. This is probably outside the scope of Minify, but we should\npublish a utility class to do it.\nReported by mrclay.org on 2008-02-29 02:26:18\n- Status changed: Started\n- Labels added: Type-Enhancement\n- Labels removed: Type-Defect\n. Minify_Build now creates \"versioned\" URLs, so one may safely set a far-off Expires\nheader via Minify's \"setExpires\" option. See Minify_Build comment.\nReported by mrclay.org on 2008-05-14 16:44:06\n- Status changed: Fixed\n. ```\nMy apologies.  This is a duplicate request.  See:\nhttp://code.google.com/p/minify/issues/detail?id=19\nI agree with Stephen's comments. :)\n```\nReported by tummblr on 2007-11-07 02:35:08\n. Reported by mrclay.org on 2008-02-29 02:07:54\n- Status changed: Duplicate\n. Reported by rgrove on 2007-11-28 04:21:23\n- Labels added: Type-Enhancement\n- Labels removed: Type-Defect\n. I already have the code for this if you'd like use it\nReported by nick.lemouton on 2007-12-04 03:07:28\n. ```\nWhen I looked at CSS Tidy I found the comment-processing options limited (in light of\nreal-world hacks), but I did steal some minification ideas from it.\nCheck the SVN and see if you can create a wrapper for CSS Tidy. E.g., here's one for\nPacker:\nhttp://code.google.com/p/minify/source/browse/trunk/lib/Minify/Packer.php#737\nI'm certainly open to accepting it with some test cases as a backup CSS minifier.\n```\nReported by mrclay.org on 2008-02-29 02:32:31\n- Status changed: Accepted\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. Reported by mrclay.org on 2008-05-14 16:45:34\n- Status changed: WontFix\n. In the 2.x versions you can (with some configuration hoops) use any function you \nwant for minification. Ask how on the google groups.\nReported by mrclay.org on 2008-11-27 15:41:45\n- Status changed: Fixed\n. Can you give a concrete example of what you're trying to do?\nReported by mrclay.org on 2008-02-28 12:52:15\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. Reported by mrclay.org on 2008-05-14 16:25:39\n- Status changed: WontFix\n. ```\nIf you have a directory structure like this:\n/var/www/shared/js/myjspackage1.js\n/var/www/shared/js/myjspackage2.js\n/var/www/example.com/html/js/myjspackage1.js => symlink to: /var/www/shared/js/myjspackage1.js\n/var/www/otherexample.com/html/js/myjspackage1.js => symlink to: /var/www/shared/js/myjspackage1.js\nMinify won't handle the files in example.com and otherexample.com since they are symbolic\nlinks (and it finds \nthat the realpath is not in the allowed path domain or something).\n```\nReported by grEvenX on 2008-05-14 17:20:02\n. The Groups or Files controllers with Minify 2 should be able to accept symlinks as\nlong as PHP can open the target files. They do not require that the file's realpath()\nbe inside $_SERVER['DOCUMENT_ROOT'].\nReported by mrclay.org on 2008-06-01 03:53:22\n- Status changed: NeedInfo\n. ```\nMinify 2.1 would not work when my entire DOCUMENT_ROOT is symlinked to (running PHP\n5.2.6 on OS X \nLeopard). The fix was to change this line 285 in version 2.1 of lib/Minify/CSS.php\nfrom:\n$path = substr($path, strlen($_SERVER['DOCUMENT_ROOT']));\nto:\n$path = substr($path, strlen(realpath($_SERVER['DOCUMENT_ROOT'])));\nHope this prevents hours of frustration for someone else.\n```\nReported by pvulgaris on 2008-10-07 23:21:19\n. @pvulgaris: Thanks for your help debugging this. I just committed R254 making sure \nall doc root accesses are passed through realpath.\nReported by mrclay.org on 2008-10-08 13:23:26\n- Status changed: Verified\n- Labels added: Priority-High, Release-2.1.0\n- Labels removed: Priority-Low\n. Upcoming alpha code should fix this.\nReported by mrclay.org on 2008-02-28 12:43:05\n- Status changed: Started\n. New SVN code does not have this issue.\nReported by mrclay.org on 2008-05-14 16:24:54\n- Status changed: Fixed\n. This issue still seems to be a problem with the 2.1.5 code i downloaded yesterday. All\nbut a few of the paths come out right but the paths for some still come out with backslashes.\nWhich particular version of the svn code fixes this issue?\nReported by Unsane1047 on 2012-08-14 20:27:05\n. Please enable debug mode (see the wiki) so you can see the steps the URI rewriter is\nusing. Please post the results (trimmed to the problematic URL) to the google group\nuntil we determine this is actually a bug.\nReported by mrclay.org on 2012-08-15 16:57:59\n. Can you be more specific?\nReported by mrclay.org on 2008-02-29 02:05:26\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. Reported by mrclay.org on 2008-05-14 16:21:35\n- Status changed: Invalid\n. See /web/version1/minify.php and /lib/Minify/Controller/Version1.php\nProbably needs a real test suite, but it seems to work.\nReported by mrclay.org on 2008-05-14 16:53:33\n- Status changed: Started\n. ```\nI no longer see exact V1 compatibility as necessary. The \"min\" app in R219 uses the\nVersion1 controller and accepts similar URLs, but anyone succefully using v1 can \njust stick with it or install v2.1 next to it and alter some rewrite rules.\n```\nReported by mrclay.org on 2008-09-11 20:45:11\n- Status changed: WontFix\n- Labels added: Priority-Low\n- Labels removed: Priority-High\n. Moved.\nReported by mrclay.org on 2008-05-22 20:38:16\n- Status changed: Verified\n. sorry, this should not be a defect, its an enhancement request :)\nReported by celebit on 2008-03-10 14:09:55\n. Good idea. I'll make this an option in the new version of minify.php, but this may\nnot be production-ready for a bit.\nhttp://code.google.com/p/minify/source/browse/trunk/web/version1/minify.php\nReported by mrclay.org on 2008-03-10 14:36:23\n- Status changed: Accepted\n- Labels added: Type-Enhancement\n- Labels removed: Type-Defect\n. See Issue 13: http://code.google.com/p/minify/issues/detail?id=13&can=1\nReported by mrclay.org on 2008-05-14 16:49:15\n- Status changed: Duplicate\n. ```\nOf option 1 and 2, I would prefer option 1. Option 2 feels too likely to break.\nCould the license text be added in the PHP code instead of external .txt files? This\nwould seem cleaner to me, each license is just a few lines long, and could just be\nanother option field in the file settings array?\nI would advocate keeping the copyright statement together with the original work, for\n2 reasons:\n1) If the user saves the webpage and moves it, then any non-linked resources would\nbe\nlost.\n2) Several licenses require that the copyright notice must be left intact, as one\nexample the modern BSD license says \"Redistributions of source code must retain the\nabove copyright notice, this list of conditions and the following disclaimer.\"\n```\nReported by jm.spampot on 2008-05-02 18:53:00\n. ```\nOutputting content before calling Minify::serve() will generally not work since\nserve() sends headers and encodes content (so you'd have mixed encoding garbage).\nIf you really want to keep the comments in the PHP code, you can use a\nMinify_Source and directly give it the content:\nnew Minify_Source(array(\n  'id' => 'jsComments' // arbitrary, but required\n  ,'content' => '/ put comments here /'\n  ,'minifier' => ''\n  ,'lastModified' => filemtime(FILE) // allows caching\n))\nOption 3: An option to prepend a multi-line comment that lists the files compressed:\n/ This file contains compressed versions of these source files:\nhttp://example.com/js/jquery.js \nhttp://example.com/js/dojo.js\nhttp://example.com/js/user.js \nPlease see the above files for copyright/license information. /\nI'm still not crazy about it. I think this should be manually done via Option 2,\nrather than a bunch more Minify code.\n```\nReported by mrclay.org on 2008-05-02 20:17:03\n. Option 3 looks good to me. :-)\nReported by jm.spampot on 2008-05-02 22:01:10\n. ```\nTaking cue from the YUI Compressor, I've added a \"preserveComments\" option (default\ntrue) to Minify_Javascript in r79. This preserves multi-line comments that begin with\n\"/*!\".\nThis requires minimal user modification to the sources, and is a pretty simple system\nwith predictable output. \nTODO: revise Minify_CSS to have the same option instead of sniffing for \"copyright\".\n```\nReported by mrclay.org on 2008-05-07 20:21:02\n- Status changed: Started\n. Minify_Javascript now has the \"preserveComments\" option, and, by default, preserves\nmulti-line comments that begin with \"/*!\".\nReported by mrclay.org on 2008-05-14 16:18:43\n- Status changed: Fixed\n. ```\nWhat version of Minify are you using (1.x or from the current SVN)?\nAlthough unrelated to your problem, I think, it's true that minify could possibly\ncombine UTF-8 files resulting in multiple BOMs in the served file. We should probably\njust strip these with something like:\nstr_replace(pack(\"CCC\",0xef,0xbb,0xbf), '', $str);\nOr maybe only those appearing at the beginning of files...\n```\nReported by mrclay.org on 2008-05-20 14:04:24\n- Status changed: Accepted\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. In 2.0.0 Minify_Source::getContent removes any leading BOMs.\nReported by mrclay.org on 2008-05-22 20:37:39\n- Status changed: Started\n. Not sure the FCKE bug has anything to do with Minify, but the BOM issue was resolved,\nso I'm closing this.\nReported by mrclay.org on 2008-06-01 03:33:29\n- Status changed: Fixed\n. Yep. Cache_Lite_File isn't E_STRICT. I'm considering boiling it down to a single\nclass for best performance. Or doing the same with Zend_Cache. With all the real\nworld use Cache_Lite has received I'm hesitant to jump on Zend_Cache just because\nit's \"best practice\" code.\nReported by mrclay.org on 2008-05-30 01:36:02\n- Status changed: Accepted\n. ```\nI am getting this error as well. And in my case, this error outputs in my m.php/css\noutput, so it becomes basically gibberish because it generates all these  \"Warning:\nCannot modify header information - headers already sent\" .\nAny way to remove this error without messing with the error output in PHP?\n```\nReported by FT.MikeLewis on 2008-05-31 19:02:49\n. ```\nOn line 912 of /lib/Cache/Lite/File.php is the method get():\nhttp://code.google.com/p/minify/source/browse/tags/release_2.0.0/lib/Cache/Lite/File.php#912\nIn the parameter list, add a third parameter, $thisValueIgnored = false, so the line\nreads:\nfunction get($id, $group = 'default', $thisValueIgnored = false)\n\nThis change appeases the E_STRICT gods and will be included in 2.0.1.\n```\nReported by mrclay.org on 2008-06-01 02:43:59\n- Status changed: Fixed\n. ```\nNote: I may have spoke to soon. I have figured out how to run from the command line\n-\nI merely had to convert my relative paths to absolute paths.\nIt would be nice if minify provided a function other than serve() which simply\nreturned the minified content. Having to set the quiet and encodeOutput options seems\na little silly when just running via a commandline script.\n```\nReported by mankyd on 2008-05-30 22:28:27\n. ```\nI need to work on the docs :/. For command-line you might just use Minify_Javascript\n(or Minify_CSS) separately and combine the outputs.\nI suppose Minify could sniff for command line usage and use different defaults for\nserve(), but in the interest of keeping Minify lean, you could just set the options\nyou need :)\n```\nReported by mrclay.org on 2008-06-01 00:14:41\n- Status changed: WontFix\n. I labelled this incorrectly.\nReported by mrclay.org on 2008-11-27 15:47:16\n- Status changed: Invalid\n. Could you try the one I've attached to this issue? I tar-red with 7-zip and gzip-ped\nwith the official Win32 executable. http://www.gzip.org/#exe\nReported by mrclay.org on 2008-06-17 18:01:56\n- Status changed: Started\n\n- Attachment: minify-2.0.1.tar.gz\n. ```\nI've been told my tar utility did not set the execute bit on the directories. You may\nneed to do something like the following after untarring:\nchmod -r ug=X minify-2.0.1\nI may abandon the .tar.gz release format if I can't create it acceptably on Windows.\n```\nReported by mrclay.org on 2008-06-24 15:35:05\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. According to a user, the tar and gzip included in http://sourceforge.net/projects/\nunxutils made a usable tar.gz. package on Win32. I'll use this in the future.\nReported by mrclay.org on 2008-06-30 20:24:13\n- Status changed: Fixed\n. This could be fairly easily adapted:\nhttp://interfacelab.com/variables-in-css-via-php/\nReported by mrclay.org on 2008-08-10 03:07:55\n. Another implementation (& more ideas):\nhttp://www.shauninman.com/archive/2008/05/30/check_out_css_cacheer\nReported by mrclay.org on 2008-08-12 03:25:43\n. Reported by mrclay.org on 2008-09-11 20:45:50\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. Yet another: http://sprymedia.co.uk/article/Conditional-CSS\nReported by stephen.clay on 2008-10-14 23:28:40\n. or just add LESS: http://leafo.net/lessphp/\nReported by elan.ruusamae on 2012-03-29 16:26:25\n. Yes, LESS would be perfect!\nReported by juan.complementa on 2015-03-26 10:50:44\n. ```\ncheck the 3.0 branch\nhttps://github.com/mrclay/minify/tree/3.0\naltho it's not finished yet\n```\nReported by elan.ruusamae on 2015-04-13 08:16:09\n. ```\nAre you using the 'setExpires' option in serve()?\nWhen using 'setExpires', Last-Modified and the check for If-Modified-Since are not\nneeded. After the Expires header is sent, under normal browsing the browser will not\nre-request the file at all until the expiration time.\nOnly when you explicitly request the JS/CSS URL or refresh the HTML page will the \nbrowser re-request the file, and when it does it will not send a conditional GET, so\nLast-Modified would be a waste.\nYou can verify this using Fiddler and navigating around on http://\nwww.miamianimalremoval.com/ (uses 'setExpires'). The /min/ URLs are not re-requested\nunless you manually refresh a page, and when you do, IE7 sends Pragma: no-cache, so\nit wouldn't send an If-Modified-Since header anyway.\nIf you want conditional GETs and 304 responses, don't use the 'setExpires' option.\n```\nReported by mrclay.org on 2008-07-17 18:06:47\n- Status changed: NeedInfo\n. ```\nAfter further testing and reading the code I realized this was probably the issue. \nStill, I'm not sure I agree with your statement that on refreshing the page the\nbrowser won't do a conditional get.  In my FF2 and IE7 browsers I can see the\nIf-Modified-Since headers being sent for image requests that had a Last-Modified\nheader on a previous request.  It seems even if there is even partial support for\nthis in browsers having the Last-Modified in there could save some round-trips with\nno adverse affects.\nIn either case, that would be in the realm of a feature request so I assume you can\njust close out this erroneous bug report.  Thanks and sorry for the confusion.\n```\nReported by vadibart on 2008-07-17 18:23:15\n. ```\nSo the requested feature would be: When 'setExpires' is used, Minify should still \nsupport conditional GETs?\nMy reasoning for not supporting conditional GET in this case is that it speeds up \nMinify by not loading ConditionalGet.php at all (in 2.0.2b).\nMy intuition is that, when far-off Expires headers are used, conditional GET \nrequests are pretty rare, but I guess some testing is in order. If you have pages \nthat invite refresh-a-thons (eBay bidding) and conditional GETs are sent, there'd be\na lot of opportunity for bandwidth savings.\n```\nReported by mrclay.org on 2008-07-17 21:00:39\n. Exactly.  I'm also wondering about pages with a meta-refresh (not sure what the\nbehavior is here but I'd bet it acts like a manual refresh) or AJAX-refreshed pages,\nwhich are more and more common.\nReported by vadibart on 2008-07-17 21:23:36\n. ```\nCreated feature request:\nhttp://code.google.com/p/minify/issues/detail?id=37\nInvalidating this issue.\n```\nReported by mrclay.org on 2008-07-17 23:09:18\n. I don't know why I made a separate issue for this.\nReported by mrclay.org on 2008-11-27 15:45:43\n- Status changed: Verified\n. In R156 'maxAge' now replaces 'setExpires' and doesn't prevent conditional GETs.\nReported by mrclay.org on 2008-07-22 23:40:55\n- Status changed: Fixed\n. Yeah, packaging them as one file was a dumb decision on my part. I removed \nCache_Lite completely in 2.0.2 beta in favor of a custom class optimized for fast \nreads. Give that a shot.\nReported by mrclay.org on 2008-07-21 15:37:40\n- Status changed: Fixed\n. Thanks!\nReported by mrclay.org on 2008-07-22 23:44:59\n- Status changed: Verified\n- Labels added: Type-Other, Priority-Low\n- Labels removed: Type-Defect, Priority-Medium\n. Removed LOCK_EX in R160. the file contents is still checked after writing and \ndeleted if not valid, so the exclusive lock isn't really needed.\nReported by mrclay.org on 2008-07-29 04:14:40\n- Status changed: Fixed\n. ```\nThanks for catching this. I'm all for optimizing (or removing) regexs if possible. \nIn this case your fix won't have the same functionality (basically a trim of each \nline). Can you try replacing with these lines instead?\n$html = preg_replace('/^\\s/m', '', $html);\n$html = preg_replace('/\\s$/m', '', $html);\n```\nReported by mrclay.org on 2008-07-28 16:35:23\n- Status changed: Accepted\n. ```\nFixed in R160. ecroyd, can you verify this worked? I combined the patterns suggested\nabove:\n$html = preg_replace('/^\\s+|\\s+$/m', '', $html);\n```\nReported by mrclay.org on 2008-07-29 04:20:19\n- Status changed: Fixed\n. ```\nBoth your latest solution (comment 2) and your earlier solution (comment 1) fix my\nproblem.\nThank you very much for providing such a great tool.\n```\nReported by ecroyd on 2008-07-29 08:34:38\n. Reported by mrclay.org on 2008-07-29 11:54:51\n- Status changed: Verified\n. $uploaderHoursBehind is implemented in R160. I've put SVN on mrclay.org \n($uploaderHoursBehind = 1) and it's solved the problem for me.\nReported by mrclay.org on 2008-07-29 04:12:01\n- Status changed: Fixed\n. ```\nThis should be fixed in R162. Can you verify this file works for you?\nhttp://code.google.com/p/minify/source/browse/trunk/lib/Minify/HTML.php\nThanks for catching this!\n```\nReported by mrclay.org on 2008-07-31 15:20:11\n- Status changed: Fixed\n. This seems to be all fixed now.\nReported by ecroyd on 2008-07-31 20:45:54\n. Reported by mrclay.org on 2008-08-01 02:49:05\n- Status changed: Verified\n. Reported by mrclay.org on 2008-07-31 20:05:46\n- Labels added: Usability\n. Done in R177.\nReported by mrclay.org on 2008-08-19 00:23:55\n- Status changed: Verified\n. ```\nWorking in R167! I think, for simplicity, the default install will have \"lib\" as a \nsubdirectory of \"min\". That way you can just drop \"min\" in DOCUMENT_ROOT and it'll\nJust Work. If you want to put \"lib\" somewhere else, you certainly can, but all the\nclass files are safe within DOC_ROOT now.\nI also want Issue 44 resolved before I close this.\n```\nReported by mrclay.org on 2008-08-12 02:05:45\n- Status changed: Started\n. ```\nR178 has \"lib\" inside \"min\". Left to do:\n\nRename \"web\" to \"min_extras\" (to complement min) and reorganize.\nCreate min/USAGE.txt with simple instructions\n```\n\nReported by mrclay.org on 2008-08-19 04:19:39\n. This seems wrapped up with R219.\nReported by mrclay.org on 2008-09-11 20:39:06\n- Status changed: Verified\n. ```\nI think in general the minifiers need to limit lines lengths if it means using \nnewlines instead of spaces in some cases.\nI'll try out that code. Something like this might be fast (incredibly simple \nexpression + native trim()):\n$html = preg_replace_callback('/>([^<]+)</', array('Minify_HTML', '_cbTrim'), $html);\nfunction _cbTrim($m) {\n  return '>' . trim($m[1]) . ' <';\n}\n```\nReported by mrclay.org on 2008-08-13 02:22:02\n- Status changed: Accepted\n. ```\nCan you try Minify_HTML in R168? \nRather than running 3 patterns on the whole string, there's now one trip across the\nstring with two simple patterns.\nhttp://code.google.com/p/minify/source/diff?old=163&r=168&format=unidiff&path=\n%2Ftrunk%2Flib%2FMinify%2FHTML.php\nI'll consider adding the fallback. But then would these bugs get noticed? ;)\n```\nReported by mrclay.org on 2008-08-13 14:15:35\n- Status changed: Fixed\n. ```\nI've got same bug with long html\nDuring tests I've found that count of mathes is 0 and it do not enter callback function.\nNo errors, no notices, no info to help resolve this bug =(\n```\nReported by swayalex on 2010-01-15 20:32:12\n. @swaylex: can you tell which is the first preg_replace_callback to fail? Does your\ninput have really long lines, or just really long? Ideally attach a failing HTML file.\nReported by mrclay.org on 2010-01-15 21:56:43\n- Status changed: NeedInfo\n. Done in R171!\nReported by mrclay.org on 2008-08-14 06:21:59\n- Status changed: Verified\n. Reported by mrclay.org on 2008-09-11 20:46:16\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. ```\nI have an error [ERROR] :  Failed to minify E:\\Project\\Ti.Ui.Workspace\\Restaurant\\Resources\\ui\\common\\CRUDHandle.js\nWhat is this failed to minify.. how to solve it\n```\nReported by kpm.manikandan on 2014-01-27 11:20:33\n. Fixed in R171! No longer compressing all whitespace to spaces.\nReported by mrclay.org on 2008-08-14 06:20:12\n- Status changed: Verified\n. ```\nGood progress in R188. Minify_CSS_Linearizer::linearize() takes a file path and \nreturns a single stylesheet with all @imports (that could be opened) included and in\n@media blocks where necessary. Afterwards, Minify_CSS_Linearizer::$includedFiles is\nan array of all files included (for change monitoring).\n```\nReported by mrclay.org on 2008-08-28 17:56:27\n- Status changed: Started\n. ```\nHmm, linearize() needs to look out for files it's already included to avoid endless\nrecursion.\n```\nReported by mrclay.org on 2008-08-28 18:11:54\n. ```\nMinify_Source would be better to have accessor functions rather than several public\nproperties and a big magic constructor. This would ease subclassing.\nMinify_ImportSource:\n  private $_contents\n  private $_includedFiles\nprivate function _linearize()\n    run import processor\n    cache file list and copy to $_includedFiles\n    store css to $_contents\nfunction getContent() \n    if content not in $_contents\n      _linearize()\n    return $_contents\nfunction getLastModified()\n    if not in cache\n      _linearize()\n    return max(filemtimes($_includedFiles))\n```\nReported by mrclay.org on 2009-02-26 21:10:18\n. Shelving until 2.1.2 is out.\nReported by mrclay.org on 2009-02-26 21:30:49\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. ```\nSome feedback on such a feature:\n\n\nIt would be useful for me since the main reason i'm using Minify is that i want\nto\nseparate my CSS source code in several well organized files, which is a no-go for\nproduction beyond 2-3 CSS files.\n\n\nRight now i'm using the groups configuration to achieve this. It works fairly well.\n\n\nFor development, i have CSS files called profile-all.css or profile-admin.css (for\ninstance), which are stylesheets with only @import rules in them (plus occasionnal\ndocumentation comments). So if i change a profile stylesheet, i have to replicate the\nchanges in groupsConfig.php; not a big deal, but if Minify can parse the CSS code to\nuse @import rules as an alternative to groups config (for CSS), it's even better.\n\n\n```\nReported by fverschelde on 2009-04-26 21:21:36\n. Issue 223 has been merged into this issue.\nReported by mrclay.org on 2011-03-02 16:19:58\n. I'm waiting for this too.\nIs there a prevision to fix this issue?\nReported by faelsta on 2013-06-25 15:15:11\n. I don't have time to implement this anytime soon. Since we already have groups the ROI\njust isn't there. Comment 3 has the overall plan.\nReported by mrclay.org on 2013-06-25 16:54:19\n- Status changed: Accepted\n. ```\nCan you try 2.0.2 beta? I'll see what I can do for you though.\nWhat do you get from these URLs (after replacing your domain) ?\nhttp://www.domain.com/web/examples/1/m.php/css\nhttp://www.domain.com/web/examples/1/m.php/js\nAre there PHP errors? If you don't see any can you check PHP's error log?\n```\nReported by mrclay.org on 2008-08-29 14:59:58\n- Status changed: Accepted\n. Reported by mrclay.org on 2008-09-11 20:47:20\n- Status changed: NeedInfo\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. Reported by mrclay.org on 2009-01-26 18:50:28\n- Status changed: WontFix\n. Fixed in R238\nReported by mrclay.org on 2008-09-24 19:09:32\n- Status changed: Verified\n. Reported by mrclay.org on 2008-10-07 15:36:47\n- Labels added: Release-2.1.0\n. ```\nIt looks like lines 95 and 96 should be moved before line 87.\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.0/min/lib/Minify/\nHTML.php#95\nCan you see if this change fixes the problem?\nSome of the unit tests might need some adjustments but it shouldn't break any \nfunctionality.\n```\nReported by mrclay.org on 2008-09-25 03:12:14\n- Status changed: Accepted\n- Labels added: Priority-High\n- Labels removed: Priority-Medium\n. ```\nThat resolves it on my test case; it seems like you've added an easy debug mode, so\nis there any reason to introduce newlines?\n```\nReported by joesiegrist on 2008-09-25 03:42:37\n. ```\nThe debug mode is strictly for languages with C style comments (JS + CSS). I guess \nfor HTML it should just turn all minification off. I'll have to check on that.\nExtra newlines were added due to an option in YUI Compressor that mentioned issues\nwith extreme line lengths (one Minify user had a single line over 50000 characters).\nOpening tags with attributes seemed like the safest place to put them without adding\nany bytes.\n```\nReported by mrclay.org on 2008-09-25 11:34:24\n- Status changed: Started\n. Makes sense, thanks for your help.  You're welcome to add https://lastpass.com/ to \nthe list of sites using minify.\nReported by joesiegrist on 2008-09-25 15:26:50\n. Fixed in R239\nReported by mrclay.org on 2008-09-27 21:12:03\n- Status changed: Verified\n. Reported by mrclay.org on 2008-10-07 15:36:39\n- Labels added: Release-2.1.0\n. R286: rewrote Minify_CSS using separate compressor and urirewriter classes. Unit \ntests pass.\n@todo: more testing\nReported by mrclay.org on 2009-01-28 22:08:20\n- Status changed: Started\n. Released in 2.1.2\nReported by mrclay.org on 2009-03-02 22:48:47\n- Status changed: Verified\n- Labels added: Release-2.1.1\n. ```\nFrom docblock: \"This uses a very basic parser easily fooled by comment tokens inside\nstrings or regexes\" i.e. this is a known limitation. Fixing this for JS would \nrequire a rewrite based on JSMin (preserve all characters, add comments) and \nsimilarly for CSS using a full CSS syntax parser. Sound like fun?\nIn the case of JS string I think you can work around this with escapes, i.e. \"*\\/\n*\". Regexps might be harder :(\n```\nReported by mrclay.org on 2008-10-03 23:00:23\n- Status changed: Accepted\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. I agree that this is nasty and probably not worth fixing. I just don't like local\nchanges in libraries like jQuery but I can live with them.\nReported by Jan.Hendrik.Holthusen on 2008-10-04 00:01:56\n. Reported by mrclay.org on 2008-10-07 15:34:17\n- Labels added: Release-2.1.0\n. ```\nHere's a simple patch to stop debug mode inserting errors, instead it will trim and\ncombine files rather than add the line # comments:\nOn line 389 of /min/lib/Minify.php:\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.1/min/lib/\nMinify.php#389\nchange:\n$source->minifier = array('Minify_Lines', 'minify');\nto:\n$source->minifier = 'trim';\n```\nReported by mrclay.org on 2008-11-26 14:39:22\n- Labels added: Priority-Medium\n- Labels removed: Priority-High\n. Issue 71 has been merged into this issue.\nReported by mrclay.org on 2008-11-26 14:42:10\n. ```\nIf you replace the line in Lines.php:\n$inComment = ! $inComment;\nwith:\nif($pos==0 || ($inComment? substr($line, $pos, 3) : substr($line, $pos-1, 3))!='/')\n    $inComment = ! $inComment;\nIt's not perfect but at least minify will work with jquery, and I can't think of any\nvalid code that would use /\n```\nReported by AdamAdept on 2008-12-10 02:23:46\n. ```\nAwesome. Short of rewriting the Lines controller to be a complete JS parser, this is\na good workaround for a common case. I'll check the unit tests and commit when I'm\nback in town. Thanks!\n```\nReported by mrclay.org on 2008-12-10 02:48:53\n. Fixed in R275\nReported by mrclay.org on 2008-12-16 17:15:22\n- Status changed: Fixed\n. Reported by mrclay.org on 2008-12-16 17:19:49\n- Labels added: Release-2.1.1\n- Labels removed: Release-2.1.0\n. Issue 77 has been merged into this issue.\nReported by mrclay.org on 2009-01-21 00:15:33\n. re 4) oh, i see that's how you're ending all of the pages :P\nReported by Keith.Bentrup on 2008-10-05 06:38:59\n. ```\n1+2) Fixed in R249. Thanks for that catch.\n3) It's correct as is.\n5) Querystring URLs sent with Expires are indeed cached by all browsers and this is\naccording to spec. The [http://www.stevesouders.com/blog/2008/08/23/revving-\nfilenames-dont-use-querystring/ limitation] is with the proxy Squid in its default\nconfiguration.\nRight now Javascript in the builder app detects whether mod_rewrite works, but \nthere's no direct way to get this info to Minify_groupUri(). I guess I need to add\na \nanother config option.\n```\nReported by mrclay.org on 2008-10-05 22:53:11\n- Status changed: Fixed\n. ```\nR250 allows the removal of querystrings from generated URIs (set $forceAmpersand to\ntrue in Minify_groupUri) and makes it clearer that min/lib needs to be in the \ninclude_path before utils.php is included. I'd forgotten that Build.php required \nSource.php.\n```\nReported by mrclay.org on 2008-10-05 23:47:35\n- Status changed: Verified\n. ```\nre 3) with \"Minify/Source.php\", I get:\nWarning: require_once(Minify/Source.php) [function.require-once]: failed to open\nstream: No such file or directory in [omitted]/min/lib/Minify/Build.php on line 7\nFatal error: require_once() [function.require]: Failed opening required\n'Minify/Source.php' (include_path='.:/usr/lib/php:/usr/local/lib/php') in\n[omitted]/min/lib/Minify/Build.php on line 7\nIt appears that it's not included in my path.\nAfter a little exploring, I see that you have $min_libPath in config.php and that you\nset the include path in index.php, but it looks like Build.php is required only in\nutils.php, and utils.php is only called before index.php is referenced by the HTML\nsource.\nSo it seems, at least in my situation as per the README where I noticed util.php\nshould be utils.php, it's not in the path (at least, until later)...\n```\nReported by Keith.Bentrup on 2008-10-05 23:50:17\n. lol ... we were probably writing that at the same time.\nReported by Keith.Bentrup on 2008-10-05 23:52:08\n. OK :) Just to finish this issue, could you copy utils.php, Build.php from R250 and \nverify that utils.php loads and Minify_groupUri() works for you as long as you add\n/\nmin/lib to your include_path beforehand?\nReported by mrclay.org on 2008-10-06 11:59:26\n. Reported by mrclay.org on 2008-10-07 15:36:24\n- Labels added: Release-2.1.0\n. ```\nCan you try adding this to config.php?\nini_set('zlib.output_compression', '0');\nI'm guessing that the content is being HTTP encoded (deflate/gzip) twice; once by \nMinify and once by this directive. If this fixes it I need to add that to Minify \nsomewhere.\n```\nReported by mrclay.org on 2008-10-06 15:32:45\n- Status changed: NeedInfo\n. This directive didn't help, but thanks for the clue - Apache was indeed configured to\ncompress it twice :)\nReported by galadia on 2008-10-06 20:21:25\n. Was this Apache setting something that could be detected in $_SERVER or $_ENV? I \nguess a unit test could make an external HTTP call to detect this.\nReported by mrclay.org on 2008-10-06 23:27:56\n- Status changed: Started\n. I really don't know. That was a setting in a custom-made admin panel.\nReported by galadia on 2008-10-06 23:31:32\n. ```\nR252 now can warn of double-encoding in the builder app and gives a warning about \nthis along with the status of PHP's \"zlib.output_compression\" option and if it could\nbe successfully disabled. I think this is about the best I can do here as some auto-\nencoding is undetectable in PHP.\n```\nReported by mrclay.org on 2008-10-07 15:12:02\n- Status changed: Verified\n. Reported by mrclay.org on 2008-10-07 15:36:03\n- Labels added: Release-2.1.0\n. This should be fixed in R251. Can you verify this works for you?\nReported by mrclay.org on 2008-10-06 14:16:21\n- Status changed: Fixed\n- Labels added: Priority-High\n- Labels removed: Priority-Medium\n. Yes seems fixed for the issue i mentioned. thanks\nReported by parism70@hotmail.com on 2008-10-07 10:16:43\n. Reported by mrclay.org on 2008-10-07 11:37:21\n- Status changed: Verified\n. Reported by mrclay.org on 2008-10-07 15:35:07\n- Labels added: Release-2.1.0\n. yeah great i did it this way with autoload. perfect and so easy!!\nReported by bronco.pornguy on 2009-03-09 08:15:24\n. 3.0\n. ```\nThanks, Jason. I made smaller changes in R255 that should achieve the same goal. \nI've attached a patch of these (from R254) but you're probably safe to just replace\nthe 3 files with those in R255. Could you verfiy this works for you?\n```\nReported by mrclay.org on 2008-10-08 14:27:03\n- Status changed: Fixed\n- Labels added: Release-2.1.0\n\n- Attachment: easeZlibRequirement.patch\n. No problem.  My initial testing indicates that your changes are spot on!  Thanks.\nReported by leveillej on 2008-10-08 14:55:27\n. Reported by mrclay.org on 2008-10-08 16:09:47\n- Status changed: Verified\n. PHP Versions 5.2.5\nReported by geek4u on 2008-10-10 17:56:19\n. ```\nCan you try this workaround:\nhttp://code.google.com/p/minify/issues/detail?id=57#c1\nI think you're getting twice-encoded output from Apache mod_deflate/mod_gzip/ or \nPHP's zlib.output_compression.\n```\nReported by mrclay.org on 2008-10-10 22:16:53\n- Status changed: Accepted\n. that makes a lot of sense. i'll have to turn off minfy's compression and see what\nhappens.\nReported by geek4u on 2008-10-11 01:06:34\n. Reported by mrclay.org on 2008-10-20 18:37:02\n- Status changed: Fixed\n- Labels added: Release-2.1.0\n. Thanks for attaching the problematic CSS file. I'll look into this.\nReported by mrclay.org on 2008-10-15 15:12:28\n- Status changed: Accepted\n- Labels added: Priority-High\n- Labels removed: Priority-Medium\n. Maybe it can help you : I have other CSS files in my app but they don't crash.\nReported by coelho.ric on 2008-10-15 15:15:17\n. Have you run the unit test test_Minify_CSS.php ? Does it cause the same crash?\nReported by mrclay.org on 2008-12-16 16:59:36\n- Status changed: NeedInfo\n. Apache crashs even if I comment the \"remove ws in selectors\".\nReported by coelho.ric on 2008-12-17 11:26:05\n. I think moving to a port of YUIC's CSSmin will be much less memory/PCRE intensive.\nReported by mrclay.org on 2010-04-23 15:06:19\n- Status changed: Accepted\n. Issue 218 has been merged into this issue.\nReported by mrclay.org on 2011-01-31 02:36:07\n. ```\nI am having the same issue with WAMP running:\n - Apache 2.2.22 \n - PHP 5.4.3\n - Minify 2.1.5 (Downloaded from: https://code.google.com/p/minify/downloads/detail?name=minify-2.1.5.zip&can=2&q=)\nThe error that gets's sent to the browser is:\nThis webpage is not available\nThe webpage at http://localhost/min_unit_tests/test_Minify_css.php might be temporarily\ndown or it may have moved permanently to a new web address.\nError 103 (net::ERR_CONNECTION_ABORTED): Unknown error.\nThe code that fails is in:\nC:\\wamp\\www\\min\\lib\\Minify\\CSS\\Compressor.php\nThe specific code is:\n// remove ws in selectors\n$css = preg_replace_callback('/\n        (?:              # non-capture\n            \\s\n            [^~>+,\\s]+  # selector part\n            \\s\n            [,>+~]       # combinators\n        )+\n        \\s*\n        [^~>+,\\s]+      # selector part\n        {                # open declaration block\n    /x'\n    ,array($this, '_selectorsCB'), $css);\nIt happens when processing the following css:\nC:\\wamp\\www\\min_unit_tests_test_files\\css\\issue62.css\nHas there been a resolution to this?\nRegards,\nScott\n```\nReported by slaughton@mistro.ag on 2013-05-03 01:11:36\n. ```\nFurther testing reveals that it seems to have something to do with the total number\nof comma space combinations in the file.\nEg;\nfont-family: Verdana, Arial, Lucida, Tahoma;\nIf I remove all css from line 451 the end of the issue62.css file, I get no error.\nHowever if I then add another 3 comma space combinations to any font-family attribute\nin the file I get the error again.\nEg;\nfont-family: Verdana, Arial, Lucida, Tahoma, Algerian, Andalus, Aparajita;\nRegards,\nScott\n```\nReported by slaughton@mistro.ag on 2013-05-03 02:40:59\n. ```\nOk, I have solved the issue!!!  Hopefully this will save someone else out there the\ntime it took me to track this down:\nAfter more research on this I found the following page:\nhttps://bugs.php.net/bug.php?id=25754\nWhich led me to this page:\nhttps://bugs.php.net/bug.php?id=47689\nWhich led me to this page:\nhttp://httpd.apache.org/docs/2.2/mod/mpm_common.html#ThreadStackSize\nAnd after doing a quick google I found this page:\nhttp://stackoverflow.com/questions/5058845/how-do-i-increase-the-stack-size-for-apache-running-under-windows-7\nand In Answer 4 he gives the following example of what to add to the apache http.conf:\n\n   ThreadStackSize 8388608\n\nI did this and now it works.\nSo in the end it was not an issue with minify, or php's preg_replace_callback, it was\nan issue with the Stack Size set in apache.\nI hope this saves someone some time ;-)\nRegards,\nScott\n```\nReported by slaughton@mistro.ag on 2013-05-03 04:38:17\n. wow... thank you Scott!!! :D :D :D :D\nReported by cebasso on 2013-06-25 17:26:05\n. Use CSSmin\n. ```\nI looked into test_Minify_ImportProcessor.php and the problem is in line 29...\nif (FILE === realpath($_SERVER['SCRIPT_FILENAME'])) {\n        echo \"\\n---Output: \" .strlen($actual). \" bytes\\n\\n{$actual}\\n\\n\";\n        if (!$passed) {\n            echo \"---Expected: \" .strlen($expected). \" bytes\\n\\n{$expected}\\n\\n\\n\";\n        }\n    }\nThis if sentence is true.\n```\nReported by vasja.laharnar on 2008-10-18 19:48:02\n. ```\nI tried on another server and i got the same error. So i guess the script isn't that\n'crosssystems' build...\nI got...\n!FAIL: ImportProcessor (1 of 1 tests run so far have failed)\n---Output: 1651 bytes\n@media screen {\n/ some CSS to try to exercise things in general /\n@import  \nurl(min_unit_tests/_test_files/importProcessor/min_unit_tests/_test_files/importProcessor/min_unit_tests/_test_files/css/more.css);\nfrom where we can see that there is no local path prefix... sometimes this general\n$_SERVER variables are disabled due to security reasons so there must be also a\nworkaround for this kind of situation.\n```\nReported by vasja.laharnar on 2008-10-18 19:58:36\n. OK definitely it's the $_SERVER['DOCUMENT_ROOT'] variable. It says on the hosting\nserver that $_SERVER['DOCUMENT_ROOT'] always returns just '/' and i should use\ngetcwd() instead.\nReported by vasja.laharnar on 2008-10-19 08:38:08\n. I manually declared variable $_SERVER['DOCUMENT_ROOT'] in index.php and now it works\ngreat. Nice script.\nReported by vasja.laharnar on 2008-10-19 09:14:27\n. Reported by mrclay.org on 2008-10-20 18:35:22\n- Status changed: Verified\n- Labels added: Release-2.1.0\n. ```\nGreat simple solution. I'll use this technique in all places I use a static callback\nfunction. Thanks.\n```\nReported by mrclay.org on 2008-10-28 14:22:40\n- Status changed: Accepted\n. Patch applied in R275, and technique duplicated in Minify_HTML\nReported by mrclay.org on 2008-12-16 17:16:11\n- Status changed: Verified\n. ```\nYou do not need to extend Minify to do this. Simply create a controller object (load\nit however you want) and pass it as the first parameter to serve(). It's easiest, \nbut not required, to make your controller a subclass of Minify_Controller_Base.\n{{{\n$myController = MyFramework::factory('MinifyController');\nMinify::serve($myController, $options);\n}}}\nserve() only uses its loader if you pass a string. I'm sorry this isn't well-\ndocumented yet; here's the phpdoc line that specifies this:\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.0/min/lib/\nMinify.php#135\n```\nReported by mrclay.org on 2008-10-29 14:43:45\n- Status changed: WontFix\n. I labelled this incorrectly, sorry for the noise.\nReported by mrclay.org on 2008-11-27 15:49:05\n- Status changed: Invalid\n. ```\nSee: http://groups.google.com/group/minify/browse_thread/thread/8b1762d57ccdb21e\nUnit tests should be added to test that .htaccess doesn't cause server errors and \nindex.php is in the DirectoryIndex list (or what have you for other servers).\n```\nReported by mrclay.org on 2008-11-05 19:00:28\n- Status changed: Accepted\n- Labels added: Type-Task, Priority-Low\n- Labels removed: Type-Defect, Priority-Medium\n. ```\nwe ran unit test. there are no .htaccess caused server errors.\njust so you can see, this site is running minify: http://www.acadianationalpark.com/\nthis is hosted on the SAME server as http://www.allglacier.com/attractions/. my\nassumption is that if the above url works fine, that the reasons for the issue\nshouldn't be server-related, unless there is some sort of acute permissions (or\nsomething else i'm not thinking of) restraint being put on\nhttp://www.allglacier.com/attractions/\n```\nReported by abigwonderful on 2008-11-05 19:22:45\n. ```\nindex.php should be in the DirectoryIndex of any correctly configured Apache server\n(with PHP), so I don't think every PHP app should need to test for this.\n```\nReported by mrclay.org on 2008-11-27 15:59:42\n- Status changed: WontFix\n. ```\nI'm out of town for a few more days but try this: Open /min/builder/index.php and \nchange (line 4):\n$encodeOutput = ! ini_get('zlib.output_compression');\n...to...\n$encodeOutput = (function_exists('gzdeflate') && !ini_get\n('zlib.output_compression'));\nDoes this fix everything?\n```\nReported by mrclay.org on 2008-11-18 16:24:03\n- Status changed: Started\n- Labels added: Priority-High\n- Labels removed: Priority-Medium\n. This seems to have taken care of the issue.  I'll perform some more testing and let\nyou know if something comes up.  Thanks Steve.\nReported by leveillej on 2008-11-18 17:09:37\n. BTW, if you're out of town (presumably on vacation), shouldn't you be relaxing? \nThanks again.\nReported by leveillej on 2008-11-18 17:11:01\n. Fixed in R275\nReported by mrclay.org on 2008-12-16 17:17:11\n- Status changed: Verified\n- Labels added: Release-2.1.1\n. ```\nThanks for the patch. Can you post/e-mail me realpath($_SERVER['DOCUMENT_ROOT']) on\nyour system? I fear this patch would break working code on hundreds of systems; I \nwill try it myself and run unit tests when I'm back in town.\n```\nReported by mrclay.org on 2008-11-18 16:07:22\n- Status changed: NeedInfo\n. realpath($_SERVER['DOCUMENT_ROOT']) returns '/usr/local/corpwebsite/webroot';\nReported by even@hpuls.no on 2008-11-18 20:12:50\n. Any more information needed regarding this issue?\nReported by even@hpuls.no on 2008-12-04 15:58:54\n. ```\nYes, sorry. I should've asked for more. Could you put this script inside DOC_ROOT/\nmin/ and send me the output?\nphp\nheader('Content-Type: text/plain');\necho $_SERVER['DOCUMENT_ROOT'], \"\\n\"\n     ,realpath($_SERVER['DOCUMENT_ROOT']), \"\\n\"\n     ,$_SERVER['SCRIPT_FILENAME'], \"\\n\"\n     ,realpath($_SERVER['SCRIPT_FILENAME']), \"\\n\";\n?\nJust trying to establish the off-by-one issue that seems to exist only on your \nserver. Did you check the unit tests before/after making your change?\n```\nReported by mrclay.org on 2008-12-04 16:43:47\n. ```\nOutput of that script was:\n/usr/local/corpwebsite/webroot/\n/usr/local/corpwebsite/webroot\n/usr/local/corpwebsite/webroot/min/docrootest.php\n/usr/local/corpwebsite/webroot/min/docrootest.php\nI didn't check the unit tests, but will install them and come back with output before/after\nmodification.\n```\nReported by even@hpuls.no on 2008-12-04 20:11:35\n. ```\nDOCUMENT_ROOT is incorrect in the $_SERVER array (maybe coming from httpd.conf or \nvhosts.conf). It's a directory path and should not contain a trailing slash. I also\njust ran across a case where DOCROOT was way off. Here's a dirty workaround for the\nmoment (I'm out of town): In /min/config.php add this code:\n// strip '/min/config.php' off the end of FILE\n$_SERVER['DOCUMENT_ROOT'] = substr(FILE, 0, strlen(FILE) - 15);\nLet me know how this does. I don't know if it can fix the unit tests.\n```\nReported by mrclay.org on 2008-12-10 01:06:44\n- Status changed: Started\n. ```\nOk, the issue was too a DOCROOT set in httpd.conf with a trailing slash.\nEven if it's not up to the spec, I suspect that a lot of people have done that, and\napache doesn't warn on it on \n\"configtest\" either. Possible solution would be to check if the docroot contains trailing\nslash? \nI have fixed the docroot in the httpd.conf file for my own sites now, but it might\nbe useful to include it or \nperhaps add it to the FAQ.\nThanks for all the help, Minify rocks! :)\n```\nReported by even@hpuls.no on 2008-12-11 09:44:37\n. ```\nR275 adds a unit test for a properly configured DOCUMENT_ROOT and provides a link to\nthe above workaround if inproper.\n```\nReported by mrclay.org on 2008-12-16 17:18:46\n- Status changed: Fixed\n- Labels added: Release-2.1.1\n. ```\nHi,\nI run min_unit_tests/test_environment.php in my IIS+PHP but after 60 seconds it\nreturns blank page.\nI've checked that DOCUMENT_ROOT is \"c:/inetpub/www\", but my application is in a\ncompletely different folder \"C:/OtherAppsDir/myAppFolder\".\nDo you know where could I change this? \n```\nReported by oscarml on 2008-12-23 11:20:57\n. ```\n@oscarml: Comment 6 above has a workaround for fixing $_SERVER['DOCUMENT_ROOT']. I'd\nlove to know why test_environment.php hung up. Can you check your PHP error log? Not\nsure where that would be on IIS.\n```\nReported by mrclay.org on 2008-12-23 17:24:58\n. ```\nIn case this helps anyone reading this thread, I use a similar (but generic) version\nof the work-around suggested on comment 6:\n//----------------\n$_SERVER['DOCUMENT_ROOT']=str_replace('\\','/',substr($_SERVER['SCRIPT_FILENAME'],0,0\n-strlen($_SERVER['PHP_SELF'])));\n//----------------\nAnd it that doesn't work, you can also try:\n//----------------\n$_SERVER['DOCUMENT_ROOT'] = str_replace( '\\', '/', substr(str_replace('\\\\', '\\',\n$_SERVER['PATH_TRANSLATED']), 0, 0-strlen($_SERVER['PHP_SELF'])));\n//----------------\nI've used it for a while to fix document_root for other php applications on windows\nservers... Interestingly enough, the documentation says minify takes case of this \nissue on version 2 but that didn't work for me.\n```\nReported by diego.alto on 2009-04-22 02:24:05\n. nevermind. I needed to install PHP v. 5. Silly me.\nReported by Msuleimankhan on 2008-11-21 05:50:50\n. Thanks for the bug report anyway :)\nReported by mrclay.org on 2008-11-21 13:49:28\n- Status changed: Invalid\n. Thank you for reporting, I never know if it was not this comment.\n(Google Translator, sorry)\nReported by faustortoloi on 2009-03-02 22:40:09\n. ```\nI guess it might be worth it to add a simple version check in /min/builder/ ... I'll\ndo that in next verion.\n```\nReported by mrclay.org on 2009-03-02 22:48:02\n- Status changed: Accepted\n- Labels added: Type-Task, Priority-Low\n- Labels removed: Type-Defect, Priority-Medium\n. Version check in 2.1.3 builder\nReported by mrclay.org on 2009-07-01 20:24:34\n- Status changed: Verified\n- Labels added: Release-2.1.2\n. ```\nAre you uploading from Windows? Check near the bottom of your config file for info \nand a possible workaround:\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.1/min/config.php#79\nI changed my settings in WinSCP and it took care of this.\nBTW, the lmtime check is done here:\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.1/min/lib/Minify/\nCache/File.php#59\n```\nReported by mrclay.org on 2008-11-22 22:19:40\n- Status changed: NeedInfo\n. I'm sorry, but isn't this function used to check the cache file against the\nif-changed-since header? I am interested in the source files' last modified time check.\nReported by gyelod on 2008-11-22 22:34:56\n. But anyway, you were right. The issue was uploading from Windows.\nReported by gyelod on 2008-11-22 22:45:28\n. Sorry, the source lmtimes are checked here:\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.1/min/lib/Minify/\nSource.php#59\nReported by mrclay.org on 2008-11-22 23:11:57\n- Status changed: Invalid\n. ```\nThis sounds like Issue 55. Check the workaround I just posted:\nhttp://code.google.com/p/minify/issues/detail?id=55#c5\n```\nReported by mrclay.org on 2008-11-26 14:42:09\n- Status changed: Duplicate\n- Merged into: #55\n. ```\nChanging $source->minifier = array('Minify_Lines', 'minify'); to $source->minifier =\n'trim'; solved problems with JS Errors but not with 301 Moved Permamently.\nThis 301 appears when I use tinyMCE.init({ ... }); method of TinyMCE editor. Without\nthis code it works fine but I can't initiate TinyMCE editor\n```\nReported by popec82 on 2008-11-26 14:57:47\n. Could you use an HTTP analyzer like Fiddler to see what URLs are sending the \nredirects? The only redirect code in minify redirects to the root \"/\" of a site.\nReported by mrclay.org on 2008-11-26 16:09:11\n- Status changed: NeedInfo\n- Merged into: #-55\n. ```\nhttp://domain/min?f=/js/jquery.js,/js/tiny_mce/tiny_mce.js,/js/forms.js\nGET /min?f=/js/jquery.js,/js/tiny_mce/tiny_mce.js,/js/forms.js HTTP/1.1\nHost: domain\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; pl; rv:1.9.0.4) Gecko/2008102920\nFirefox/3.0.4\nAccept: /\nAccept-Language: en,en-us;q=0.5\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-2,utf-8;q=0.7,*;q=0.7\nKeep-Alive: 300\nConnection: keep-alive\nReferer: http://domain/test\nCookie: PHPSESSID=db42c9f88aea9804cafbc825d866d70b\nPragma: no-cache\nCache-Control: no-cache\nHTTP/1.x 301 Moved Permanently\nDate: Wed, 26 Nov 2008 16:39:30 GMT\nServer: Apache/2.2.4 (Win32) PHP/5.2.3\nLocation: http://domain/min/?f=/js/jquery.js,/js/tiny_mce/tiny_mce.js,/js/forms.js\nContent-Length: 398\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\nContent-Type: text/html; charset=iso-8859-1\n```\nReported by popec82 on 2008-11-26 16:45:07\n. After writing it as follows\nhttp://domain/min/?f=/js/jquery.js,/js/tiny_mce/tiny_mce.js,/js/forms.js 301\nRedirection disappears but browser still tries to load those url infinite number of\ntimes\nReported by popec82 on 2008-11-26 16:48:53\n. ```\nThe beginning of your new URI is correct: /min/?f=... (not /min?f=...)\nbut it should be:\nhttp://domain/min/?f=js/jquery.js,js/tiny_mce/tiny_mce.js,js/forms.js\n(no root slashes). See if that doesn't help, but again, there's no code path I'm \naware of in Minify that redirects to the same URL. Maybe the JS library is resending\nthe request. If you still have trouble, email me or join the google group.\n```\nReported by mrclay.org on 2008-11-26 18:58:35\n. It still didn't help. If you have some time i would be the best to try Minify with\njQuery, TinyMCE and some basic JS Script that initiates tinyMCE\nReported by popec82 on 2008-11-26 19:18:26\n. ```\nI've run into the same issue.\nThe problem is when using debug mode.\nE.g. in jQuery one line of the source reads:\ns.accepts[ s.dataType ] + \", /\" :\nMinify think that this is a comment for the JavaScript, and starts the line with:\n/ 2717 | s.accepts[ s.dataType ] + \", /\" :\nThe correct output in this case should be\n/ 2717 / s.accepts[ s.dataType ] + \", /\" :\n(slash instead of pipe)\n```\nReported by grEvenX on 2009-01-05 15:43:34\n. ```\n@grEvenX: I believe your problem is Issue 55 (should be fixed in R275). Replace \nLines.php with that file in R275.\nI'm leaving this issue open for the 301 redirect problem popec82 was having (though\nI'm not convinced Minify is causing this).\n```\nReported by mrclay.org on 2009-01-05 16:05:42\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. Anyone still having trouble with this issue should try this beta release:\nhttp://groups.google.com/group/minify/browse_thread/thread/8add5761eb27d67d\nReported by mrclay.org on 2009-01-26 18:49:04\n. Never confirmed redirects caused by Minify\nReported by mrclay.org on 2009-06-30 16:37:55\n- Status changed: WontFix\n. I just run into this issue too.\nIn my page I use min for css and JS. Just the JS one give me a 301 redirect.\nCalling it as : http://domain/autonome/min/?f=modele/defaut/script/js/page/traductions.FR.js,modele/defaut/script/js/page/fonction.js,modele/defaut/script/js/jquery/jquery-1.6.2.min.js,modele/defaut/script/js/jquery/i18n/jquery-ui-i18n.js,modele/defaut/script/js/jquery/i18n/jquery.ui.datepicker-fr.js,modele/defaut/script/js/jquery/jquery-ui-1.8.15.custom.min.js,modele/defaut/script/js/jquery/jquery.colorbox.min.js,modele/defaut/script/js/jquery/jquery.blockUI.min.js,modele/defaut/script/js/page/commun.js,modele/defaut/script/js/jquery/jquery.placeholder.min.js\nReported by n.vincent.lbo on 2011-08-12 12:59:03\n. ```\nIt seems to come from the fact the f parameter isn't read.\nThat's in this code the wrong thing happens (the last redirect) :\n// check for URI versioning\nif (preg_match('/&\\d/', $_SERVER['QUERY_STRING'])) {\n    $min_serveOptions['maxAge'] = 31536000;\n}\nif (isset($_GET['g'])) {\n    // well need groups config\n    $min_serveOptions['minApp']['groups'] = (require MINIFY_MIN_DIR . '/groupsConfig.php');\n}\nif (isset($_GET['f']) || isset($_GET['g'])) {\n    // serve! \n    Minify::serve('MinApp', $min_serveOptions);\n} elseif ($min_enableBuilder) {\n    header('Location: builder/');\n    exit();\n} else {\ndie('test2 - '.print_r($_GET,true));\n    header(\"Location: /\");\n    exit();\n}\n```\nReported by n.vincent.lbo on 2011-08-12 13:05:48\n. It is probably not a minify issue, because doing a die(print_r($_GET,true)); at the\nstart of index.php I can't catch the f parameter anymore. Trying to add remove other\nparameter I could catch each of its, but never the f one. So it should be because of\nthe content of the f parameters.\nReported by n.vincent.lbo on 2011-08-12 13:08:37\n. OK, so it seems that if the parmaeter is more the 512 characters (in my case) it just\ndoesn't catch the parameters. So I have to work with group ^^.\nReported by n.vincent.lbo on 2011-08-12 13:15:49\n. To clarify, you want to include a script in the combined request, but not have it \nrun through JSMin? FYI this can already be done in groupsConfig.php, and I will \ndocument how today on the Wiki.\nReported by mrclay.org on 2008-12-16 14:24:21\n- Status changed: NeedInfo\n. In the user Guide:\nhttp://code.google.com/p/minify/wiki/UserGuide#Customized_Sources_/\n_Options_for_Specific_Files\nReported by mrclay.org on 2009-01-27 16:08:25\n- Status changed: Invalid\n. Fixed in R278\nReported by mrclay.org on 2009-01-06 16:46:56\n- Status changed: Verified\n- Labels added: Release-2.1.1\n. Issue 88 has been merged into this issue.\nReported by mrclay.org on 2009-02-23 01:46:14\n. Fixed in R282!\nReported by mrclay.org on 2009-01-26 17:07:46\n- Status changed: Verified\n- Labels added: Release-2.1.1\n. Sorry didn't attach the patch.\nReported by 1stvamp on 2009-01-13 16:50:53\n\n- Attachment: ConditionalGet.php.patch\n. ```\nWhen max-age is set (even with \"must-revalidate\"), the browser honors it: when you \nbrowse links, further requests for the file are not sent (unless you manually \nrefresh the page). I've just verified this behavior using Fiddler on Opera, Firefox\n3 and IE8b2.\nAre you directly reloading the page (F5) and seeing 304s? Because there's nothing we\ncan do about that AFAIK. Do you have a public URL?\n```\nReported by mrclay.org on 2009-01-13 23:30:19\n- Status changed: NeedInfo\n. My apologies for a useless report. Having taken a look at the problem myself, it\nseems the tech dept had Apache misconfigured so that a pragma directive was also\ncoming through on the live servers (but not on dev), having sorted this out you are\nindeed right about browsers respecting max-age.\nReported by 1stvamp on 2009-01-14 10:15:48\n. No problem.\nReported by mrclay.org on 2009-01-14 12:14:18\n- Status changed: Invalid\n. The expected output and actual output are reversed in my issue report above--my\napologies. The idea is that font names with spaces are having the spaces trimmed,\nrendering, for example \"Times New Roman\" as \"TimesNewRoman\" and thus failing to style\nthe document properly.\nReported by mrrena on 2009-01-14 02:45:21\n. ```\nYou are quoting font names w/ spaces, right? Otherwise it's invalid.\nCould you attach the smallest CSS file that demonstrates this issue?\nWe already have 3 test files where the spaces aren't removed:\n http://code.google.com/p/minify/source/browse/trunk/min_unit_tests/_test_files/css/\nstyles.min.css\n font:12px Courier,\"Courier New\",sans-serif; in:\n  http://code.google.com/p/minify/source/browse/trunk/min_unit_tests/_test_files/css/\nsubsilver.min.css\n* font-family:'Lucida Sans Unicode','Lucida Grande',Sans-Serif,Verdana,Arial; in:\n  http://code.google.com/p/minify/source/browse/trunk/min_unit_tests/_test_files/css/\nvladmirated.min.css\n```\nReported by mrclay.org on 2009-01-14 12:25:57\n- Status changed: NeedInfo\n. ```\nYes, this is one \"bug\" you won't have to worry about. The minifier works as\nadvertised when quotation marks surround the font names. I had removed the quotation\nmarks some time ago, as one of the browsers (I don't recall which one now--it's been\ntoo long--but most likely IE) was choking when they were left in, refusing to render\nthe font when its name was surrounded in quotation marks. However, that is not the\nfault of the minifier.\nIf you would like, you are welcome to delete my original \"bug report\" and this\nthread. I'll figure out what I need to do to get the style sheet with quotation marks\nworking on all browsers--if indeed that is still a problem.\n```\nReported by mrrena on 2009-01-14 18:09:53\n. ```\nNo problem. I remember those kinds of CSS issues and I think they have thankfully\nbeen fixed.\n```\nReported by mrclay.org on 2009-01-14 19:15:27\n- Status changed: Invalid\n. ```\nBy the way, I want to say \"Great product!\" :) My one change was to move it a\ndirectory level deeper, and then modify all references to _minRoot in the _index.js\nfile accordingly:\nvar pos = location.pathname.substr(0,location.pathname.lastIndexOf('/'));\nvar MUB = {\n    _uid : 0\n    ,_minRoot : pos.substr(0,pos.lastIndexOf('/')+1)+'?';\n....... etc.........\nThis way, it reads the current location path, simply trimming off the \"builder\"\ndirectory from its end. While there are probably more elegant ways of doing the same\nthing, this code should work no matter how many levels deep the \"min\" directory\nlives, rather than it being hard-wired to the root. Root is often best as it results\nin shorter URLs, but not always desirable for one reason or another.\n```\nReported by mrrena on 2009-01-14 22:18:42\n. This was fixed in R275. Replacing Lines.php is all you should need.\nReported by mrclay.org on 2009-01-21 00:15:33\n- Status changed: Duplicate\n- Labels added: Release-2.1.1\n- Merged into: #55\n. Thanks.  I apparently fail at searching.\nReported by cneubauer on 2009-01-21 01:44:00\n. ```\nOnly issue I see is:\n$min_cachePath = 'c:\\WINDOWS\\Temp';\nshould be:\n$min_cachePath = 'c:\\WINDOWS\\Temp';\nDoes this help?\n```\nReported by mrclay.org on 2009-01-21 21:43:56\n- Status changed: NeedInfo\n. ```\n1. after not work at all\n\nmy adds to config\n\n$_SERVER['DOCUMENT_ROOT'] = substr($_SERVER['PATH_TRANSLATED'], 0,\nstrlen($_SERVER['SCRIPT_NAME']) * - 1);\n$_SERVER['REQUEST_URI'] = $_SERVER[\"SCRIPT_NAME\"];\nif ( $_SERVER[\"QUERY_STRING\"] != \"\" ){ $_SERVER['REQUEST_URI'] =\n$_SERVER['REQUEST_URI'] . \"?\" . $_SERVER[\"QUERY_STRING\"]; };\n( server is iis 6.0, module php 5.1.6 )\n\ntest_all - good\nhttp://www.denisx.ru/min/index.php?f=_css/stylesheet.css - Bad request\n\nwtf?\n```\nReported by deniskhripkovv on 2009-01-24 12:35:12\n\n- Attachment: test_all_report.txt\n- Attachment: config.php\n. i'm also having this problem with apache... will post if i find a solution.\nReported by sdewald on 2009-01-25 08:22:25\n. ```\nI had the same problem and the builder wasn't showing either. I got it to work by\nspecifying the sub-domain root as the document root in config.php like this:\nif(array_key_exists('SUBDOMAIN_DOCUMENT_ROOT', $_SERVER)){\n    $_SERVER['DOCUMENT_ROOT'] = $_SERVER['SUBDOMAIN_DOCUMENT_ROOT'];\n}\nI'm working with an Apache server and when I initially got the \"Bad Request\" error\nI\nchecked to see what $_SERVER['DOCUMENT_ROOT'] contained. I then combined this with\nthe path to a CSS file and tested with is_file(). The file wasn't found.\nSo I added a PHP file in the same directory as the CSS file which printed the\ncontents of $_SERVER. I found out two important things:\n1. The DOCUMENT_ROOT was one folder short of the actual path to the CSS file.\n2. The actual path was contained in SUBDOMAIN_DOCUMENT_ROOT.\nI added the code above and it worked.\nI could also have added the missing folder like this:\n$_SERVER['DOCUMENT_ROOT'] .= '/folder';\nHowever, I found the first option to be a little more solid and neater.\nThis approach may not solve everyone's problems primarily because\nSUBDOMAIN_DOCUMENT_ROOT may not be available as a standard on all servers. But I hope\nit gives direction on where to look for the problem.\nAnyway, it worked. And I really had to get it to work because Minify is exactly what\nI needed. Minify ROCKS!!! Thanks Mr. Clay.\nBleezapheronn,\nNairobi, Kenya\n```\nReported by Jeffrey.Ouma on 2009-01-25 08:27:47\n. ```\nHey cool, I got it working.  I'm using CakePHP and they have a mod_rewrite rule in\nthe DocumentRoot that looks like this:\n\n   RewriteEngine on\n   RewriteRule    ^$ app/webroot/    [L]\n   RewriteRule    (.*) app/webroot/$1 [L]\n\nI had put minify in my app/webroot directory when I got the 400 bad request errors.\nWhat I did is change the DocumentRoot in my Apache conf file to point to the\napp/webroot directory (which I think is how CakePHP prefers to be setup anyway) and\nreloaded the configuration... presto, it works!\nThanks Nairobi for the help and thank you Mr. Clay for this wonderful program!\n```\nReported by sdewald on 2009-01-25 08:59:01\n. Anyone still having trouble with this issue should try this beta release:\nhttp://groups.google.com/group/minify/browse_thread/thread/8add5761eb27d67d\nReported by mrclay.org on 2009-01-26 18:48:22\n. ```\nomg.\ninstall new ver\nconfig change\n$_SERVER['DOCUMENT_ROOT'] = 'd:\\hst\\denisx-ru_b0d8d0fb\\http';\n$_SERVER['REQUEST_URI'] = $_SERVER[\"SCRIPT_NAME\"];\nif ( $_SERVER[\"QUERY_STRING\"] != \"\" ){ $_SERVER['REQUEST_URI'] =\n$_SERVER['REQUEST_URI'] . \"?\" . $_SERVER[\"QUERY_STRING\"]; };\nhttp://www.denisx.ru/min_unit_tests/test_all.php - good\nhttp://www.denisx.ru/min/index.php?f=_css/stylesheet.css - Bad request\n? \n```\nReported by deniskhripkovv on 2009-01-27 10:03:37\n. ```\n@denis: If you're now using 2.1.2b, replace the config code you added with this:\n$min_documentRoot = 'd:\\hst\\denisx-ru_b0d8d0fb\\http';\nThis is mentioned in the new upgrade instructions:\nhttp://code.google.com/p/minify/source/browse/trunk/UPGRADING.txt?r=283#18\nMinify shouldn't need $_SERVER['REQUEST_URI'] at all.\n```\nReported by mrclay.org on 2009-01-27 12:30:18\n. ```\nI just committed a unit test update that might shed more light on your problem. Just\nreplace your min_unit_tests folder with this one:\nhttp://mrclay.org/min_unit_tests_r284.zip\n```\nReported by mrclay.org on 2009-01-27 16:06:17\n. ```\ni confused :)\nnow install ver 2.1.1\nhttp://denisx.ru/min_unit_tests/test_all.php - bad\nand (r284.zip) http://denisx.ru/min_unit_tests_new/test_all.php - bad\nadding $min_documentRoot = 'd:\\hst\\denisx-ru_b0d8d0fb\\http'; change nothing\nwhere can i download 2.1.2? =)\n```\nReported by deniskhripkovv on 2009-01-31 14:11:40\n. 2.1.2b: see http://groups.google.com/group/minify/browse_thread/\nthread/8add5761eb27d67d\nReported by mrclay.org on 2009-01-31 16:27:21\n. ```\n2.1.2b\n$min_documentRoot = 'd:\\hst\\denisx-ru_b0d8d0fb\\http';\nhttp://www.denisx.ru/min_unit_tests/test_all.php - bad :(\n```\nReported by deniskhripkovv on 2009-02-01 19:16:25\n. ```\n@denis:\nSince you're on Windows, \"/tmp\" is not a valid cache path. The easiest fix is to \ncomment out $min_cachePath and let Minify guess a path to use. If that doesn't work\nyou'll have to figure out a writable directory.\nIt also looks like $_SERVER['REQUEST_URI'] is not being set on your server, so \nyou'll need this code in config.php:\n// from http://davidwalsh.name/iis-php-server-request_uri\n$_SERVER['REQUEST_URI'] = substr($_SERVER['PHP_SELF'], 1);\nif (isset($_SERVER['QUERY_STRING'])) {\n    $_SERVER['REQUEST_URI'] .= '?' . $_SERVER['QUERY_STRING'];\n}\n```\nReported by mrclay.org on 2009-02-02 02:01:38\n. request to close issue as is configuration problem, rather than bug / defect.\nReported by ibnormedia on 2009-02-02 03:04:44\n. @ibnormedia: Agreed.\n@denis: Please use the mailing list for further support on this issue.\nReported by mrclay.org on 2009-02-02 15:58:27\n- Status changed: Invalid\n. ```\ntmp is there. but not working. \n$_SERVER['REQUEST_URI'] include.\n$min_cachePath = preg_replace('/^\\d+;/', '', session_save_path()); is working\nbut now next problem: !WARN: environment : Local HTTP request failed. Testing cannot\ncontinue.\nhttp://www.denisx.ru/min_unit_tests/test_all.php\n```\nReported by deniskhripkovv on 2009-02-02 16:05:21\n. ```\nThis issue is closed. Use the mailing list for support:\nhttp://groups.google.com/group/minify\nP.S. Install FirePHP and enable error logging to see what's going on. See the config\nfile in 2.1.2b for details.\n```\nReported by mrclay.org on 2009-02-02 17:21:43\n. ```\nIn my case I have similar problem (with 2.1.2)\n\"!WARN: environment : Local HTTP request failed. Testing cannot\ncontinue.\"\nbut disabled 'allow_url_fopen' in php.ini was guilty, must be Turn On ;)\n```\nReported by SmallPartOfEternity on 2009-03-01 23:15:40\n. ```\n@SmallPartOfEternity: 'allow_url_fopen' is not needed for operation of Minify, only\nunit testing. Unless you need it for other scripts, you should disable it after \nresolving your other issues.\n```\nReported by mrclay.org on 2009-03-02 14:00:52\n. ```\nI had a similar problem and went back to basics to fix it:\nMake sure that:\n1.  the file exists (auto-copying wasn't working in my IDE)\n2.  it is readable by the script environment (chmod 644 [file]), and\n3.  the cache directory is writable.\n```\nReported by komputerwiz.matt on 2010-12-26 12:27:46\n. ```\nHi,\nEncountered the Response: HTTP/1.0 400 Bad Request error too.\nMake sure that you use absolute paths instead of urls.\nBy mistake I entered whole urls in the builder, this returned no error, I ended up\nwith paths like this in the array:\n'js' => array('//http://www.example.com/assets/js/jquery.colorbox.js', '//http://www.example.com/assets/js/suckerfish.js'),\nChanging this to absolute paths fixed the problem..\nShould look like this:\n'js' => array('//assets/js/jquery.colorbox.js', '//assets/js/suckerfish.js'),\nHave fun with Minify!\nQuokka\n```\nReported by info@kastentafel.nl on 2011-06-01 07:35:55\n. OMG!!!\nBREAKTHROUGH!!!!!\nChange in your config file $min_documentRoot\nto the correct root for example: $min_documentRoot = $_SERVER['DOCUMENT_ROOT'].'/magento'\nor wherever you have the min folder installed\nTHEN TAKE OUT ALL COMMENTS INSIDE JAVASCRIPT FILES BEFORE THE SCRIPT\nOMG so simple no more 400 Bad Requests!!!!!\nReported by dknzdesign on 2012-11-22 14:09:27\n. ```\ngetDigest() is used to determine a cache id to hold the resulting content. The \ncache's freshness is determined by filemtimes (Minify_Source has $lastModifiedTime\nand Minify checks it), but filemtime is not needed in the cache id. In fact you \ndon't want it to, because that would just abandon cache files instead of reusing \nthem. Your proposal would have identical functionality, but would waste disk space\nin the cache directory over time.\nThanks for looking over it though.\n```\nReported by mrclay.org on 2009-01-21 19:30:19\n- Status changed: Invalid\n. Fixed in R279\nReported by mrclay.org on 2009-01-25 16:23:35\n- Status changed: Fixed\n- Labels added: Release-2.1.1\n. Nice thx\nReported by blaci30 on 2009-02-22 21:03:15\n. ```\nAmpersands in URIs are perfectly valid, they only need escaping in HTML. The builder\nalready does this. Eg. it generates:\nURI  : /min/?b=hello&f=1.css,2.css\nHTML : \nThe generated HTML output is valid.\n```\nReported by mrclay.org on 2009-01-25 16:30:50\n- Status changed: Invalid\n. ```\nHey Clay, you are doing fantastic job, thank you for that.\nI am sure it does generate escaped ampersands but i copied and pasted the code which\nbuilder generated. And i wasnt so careful when i added to my pages manually. What i\nmean is some users may miss it and it may create some problems. Thats why i wanted\nto\nbring into your attention. \nI love minify. it is like a life saver ;)\nGreetings, Clay...\n```\nReported by kusadasiguy on 2009-01-25 16:39:58\n. ```\nCan you try 2.1.2beta? (upgrade is pretty simple)\nhttp://groups.google.com/group/minify/browse_thread/thread/8add5761eb27d67d\nWith that in place (and FirePHP logging enabled) we can sprinkle in some \nMinify::logError() in the CSS minifier and figure out what's going wrong.\n```\nReported by mrclay.org on 2009-01-26 21:43:48\n- Status changed: Accepted\n- Labels added: Priority-High\n- Labels removed: Priority-Medium\n. ```\nCan you run test_environment.php directly to see if it gives more info?\nAlso, using the test_Minify_Cache_File.php from R283 (just committed) may make your\ncache file tests pass. It now uses the path you specify in /min/config.php.\n```\nReported by mrclay.org on 2009-01-26 22:11:47\n. ```\nTrying out 2.1.2beta - got the same results for the url listed above\n\n/../images/fieldset-bg.gif\n\nResults of test_environment:\nPASS: environment : DOCUMENT_ROOT should not end in trailing slash (1 of 1 tests run\nso far have passed)\nPASS: environment : DOCUMENT_ROOT should be real path and contain this test file (2\nof 2 tests run so far have passed)\n!FAIL: environment : PHP/server does not auto-HTTP-encode content (1 of 3 tests run\nso far have failed)\nReturned content should be 6 bytes and not HTTP encoded.\nHeaders returned by: http://berad-ols/min_unit_tests/test_environment.php?hello=1\narray (\n  0 => 'HTTP/1.1 200 OK',\n  1 => 'Date: Mon, 26 Jan 2009 23:03:18 GMT',\n  2 => 'Server: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.4 with Suhosin-Patch',\n  3 => 'X-Powered-By: PHP/5.2.4-2ubuntu5.4',\n  4 => 'Vary: Accept-Encoding',\n  5 => 'Content-Encoding: gzip',\n  6 => 'Content-Length: 26',\n  7 => 'Connection: close',\n  8 => 'Content-Type: text/html',\n)\nI've got FirePHP all ready to go, let me know if you want me to run anything in\nparticular, I may dig in a little and see what I can find otherwise.\n```\nReported by bmharris on 2009-01-26 23:03:31\n. After some FirePHP debugging, it looks like its getting the extra \"/\" placed in front\nof it on lines 172-173 of CSS.php, which looks like will require some more debugging\nto see where in _urlCB its happening.  Hopefully that helps somewhat.\nReported by bmharris on 2009-01-26 23:46:09\n. Try this CSS.php. It'll generate 4 messages for each url. If you can't see what's \ngoing on, post em here and I'll walk through it.\nReported by mrclay.org on 2009-01-27 00:59:23\n\n- Attachment: CSS.php\n. ```\nI think I may see what the problem is.  In my setup I have a symbolic link called\n\"static\" that goes to a different directory for shared css/js/images across projects.\n It looks to me like thats causing the issue around line 300 of the CSS.php patch you\nattached as the DOCUMENT_ROOT is not the same as the path to the images in the urls.\n I'll think about this a bit, not sure if its possible to figure out the correct path\nin this situation or not.  This is definitely a corner case issue.\nHere's the output from that:\nMinify: $m = array ( 0 => 'url(../images/exclamation.png)', 1 =>\n'../images/exclamation.png', )\nMinify: self::$_tempCurrentDir = '/var/www/static/external/css'\nMinify: realpath($_SERVER['DOCUMENT_ROOT']) = '/var/www/online_sales/public'\nMinify: $url = '/../images/exclamation.png'\nMinify: $m = array ( 0 =>\n'url(/static/js/yui/datatable/assets/skins/sam/dt-arrow-up.png)', 1 =>\n'/static/js/yui/datatable/assets/skins/sam/dt-arrow-up.png', )\nMinify: self::$_tempCurrentDir = '/var/www/static/external/css'\nMinify: realpath($_SERVER['DOCUMENT_ROOT']) = '/var/www/online_sales/public'\nMinify: $url = '/static/js/yui/datatable/assets/skins/sam/dt-arrow-up.png'\nMinify: $m = array ( 0 =>\n'url(/static/js/yui/datatable/assets/skins/sam/dt-arrow-dn.png)', 1 =>\n'/static/js/yui/datatable/assets/skins/sam/dt-arrow-dn.png', )\nMinify: self::$_tempCurrentDir = '/var/www/static/external/css'\nMinify: realpath($_SERVER['DOCUMENT_ROOT']) = '/var/www/online_sales/public'\nMinify: $url = '/static/js/yui/datatable/assets/skins/sam/dt-arrow-dn.png'\nMinify: $m = array ( 0 => 'url(../images/fieldset-bg.gif)', 1 =>\n'../images/fieldset-bg.gif', )\nMinify: self::$_tempCurrentDir = '/var/www/static/external/css'\nMinify: realpath($_SERVER['DOCUMENT_ROOT']) = '/var/www/online_sales/public'\nMinify: $url = '/../images/fieldset-bg.gif'\nMinify: $m = array ( 0 => 'url(../images/fieldset-bg.gif)', 1 =>\n'../images/fieldset-bg.gif', )\nMinify: self::$_tempCurrentDir = '/var/www/static/external/css'\nMinify: realpath($_SERVER['DOCUMENT_ROOT']) = '/var/www/online_sales/public'\nMinify: $url = '/../images/fieldset-bg.gif'\nMinify: $m = array ( 0 => 'url(../images/fieldset-bg.gif)', 1 =>\n'../images/fieldset-bg.gif', )\nMinify: self::$_tempCurrentDir = '/var/www/static/external/css'\nMinify: realpath($_SERVER['DOCUMENT_ROOT']) = '/var/www/online_sales/public'\nMinify: $url = '/../images/fieldset-bg.gif'\nMinify: $m = array ( 0 => 'url(../images/input-bg.gif)', 1 => '../images/input-bg.gif',\n)\nMinify: self::$_tempCurrentDir = '/var/www/static/external/css'\nMinify: realpath($_SERVER['DOCUMENT_ROOT']) = '/var/www/online_sales/public'\nMinify: $url = '/../images/input-bg.gif'\nMinify: $m = array ( 0 => 'url(../images/exclamation.png)', 1 =>\n'../images/exclamation.png', )\nMinify: self::$_tempCurrentDir = '/var/www/static/external/css'\nMinify: realpath($_SERVER['DOCUMENT_ROOT']) = '/var/www/online_sales/public'\nMinify: $url = '/../images/exclamation.png'\n```\nReported by bmharris on 2009-01-27 15:13:04\n. ```\nI've tracked it down to the portion of code in the Files Controller (line 55), where\nis converts the DOCUMENT_ROOT based file path to the realpath.  This sets up the\nfilepath to not use the symbolic link, which has the side effects we're seeing in the\nurl rewrite process.\nChanging that to not use realpath() and just using $file fixes the issue for me, but\nI can't say it doesn't cause other regression issues, I need to get all the tests\npassing locally for me before making the change to know if its causing real failures.\n```\nReported by bmharris on 2009-01-27 15:45:24\n. ```\nOk, this might be a workaround: Provide your own CSS minifier function that sets/\nresets the doc root (so it's the same as the CSS file while the rewriting takes \nplace).\n// in config.php\nfunction myCssMin($css, $options) {\n    require_once 'Minify/CSS.php';\n    $_SERVER['DOCUMENT_ROOT'] = '/var/www/static/external/css'; // may have to adjust\n    $css = Minify_CSS::minify($css, $options);\n    $_SERVER['DOCUMENT_ROOT'] = '/var/www/online_sales/public';\n    return $css;\n}\n$min_serveOptions['minifiers']['text/css'] = 'myCssMin';\n...At some point I'm going to rewrite Minify_CSS to use Minify_CSS_UriRewriter, \nwhich should make rewriting more flexible.\n```\nReported by mrclay.org on 2009-01-27 16:04:08\n- Status changed: Started\n. I'll look at doing something like that, but ultimately I'm wanting to minfiy/combine\ncss files that are in the document_root, and some that are outside (under the path\nof\nthe symbolic link), so I'm not sure this would handle that.  Thanks for the help and\ntime though, much appreciated!\nReported by bmharris on 2009-01-27 16:22:44\n. ```\nWrapping all the doc roots with realpath() solved issues for a lot of users, but \nI'll look into those and see if there would be a non-realpath fix.\nI think without having some sort of manual config of symbolic links, this is going\nto be impossible to automate in the general case.\nhmm...\n$min_symlinks = array(\n    '/var/www/online_sales/public/css' => '/var/www/static/external/css'\n);\n```\nReported by mrclay.org on 2009-01-27 19:59:08\n. what happen when I don't want to minify css just combine?\nI don't see any uri rewrite happening...\nReported by crirus on 2009-03-13 13:02:52\n. ```\n@bmharris: Can you try the $min_symlinks option available in 2.1.2?\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.2/min/config.php#114\n@crirus: See http://code.google.com/p/minify/wiki/UserGuide under \"Custom \nFunctions\". If you have problems with this, please post on the minify list or open\na \nnew issue if you think there is a bug.\n```\nReported by mrclay.org on 2009-03-13 17:22:30\n- Status changed: Fixed\n. Nice work, that did it for symlinks.\nReported by bmharris on 2009-03-18 14:10:49\n. Fixed in R285. Can you use that revision's HTML.php and verify the fix? It does \nresult in a few more bytes of output (the algorithm isn't smart enough to know if \nthe script is in the head, etc.), but it's indeed a bug, so thanks for submitting it.\nReported by mrclay.org on 2009-01-28 20:21:03\n- Status changed: Fixed\n. ```\nI tested the revision's HTML.php, and it works perfectly. \nBut as you said there is some whitespace around the script-tag in the head. \nThanks for this Fix!\n```\nReported by martin.auswoeger on 2009-01-29 10:53:38\n. Reported by mrclay.org on 2009-03-19 16:51:08\n- Labels added: Release-2.1.1\n. See: http://core.trac.wordpress.org/browser/tags/3.0.1/wp-includes/load.php#L33 (wp_fix_server_vars())\nReported by mrclay.org on 2010-11-10 11:56:53\n. Putting off until \"rewrite\", but improved API a bit in 9a1f306\nReported by mrclay.org on 2011-09-04 00:42:05\n. ```\nMakes sense to me and should be easy.\nMultiple groups might be nice, too: /min/?g=grp1,grp2\n```\nReported by mrclay.org on 2009-02-04 13:09:10\n- Status changed: Accepted\n- Labels added: Type-Enhancement\n- Labels removed: Type-Defect\n. ```\nA comment on this request: it might not be a very good move regarding performance.\nSay you have groups for JS files and CSS files common to all pages in the website.\nThen on a \"Sign in\" page you want to call an additional JS script that does form\nvalidation just for that page.\nIf you call \"?g=js-common\" on the homepage, and then\n\"?g=js-common&f=/js/signin-validation.js\" on the sign-in page, then from the browser\nperspective you have two totally different files: A and B. And A could be 80 KB,\nwhile B would be 85 KB. Even though those two files are very similar (A is a subset\nof B), the browser still has to load 165 KB total for a user going from the Home page\nto the Sign in page.\nAnother solution would be to call the additionnal scripts separately:\n\n\nYou get two server hits, one is 80 KB and the other is 5 KB. You save 80 KB of\nunnecessary downloads. Is that one additionnal server hit a problem? I don't think\nso. What's more, if the user went from the Home page to the Sign in page, then you\nhave:\n\none 80 KB download on the Home page;\none 5 KB download on the Sign in page.\n\nInstead of:\n\nOne 80 KB download on the Home page;\none 85 KB download on the Sign in page.\n\nHere, i'm not saying this request or the multiple groups idea shouldn't be\nimplemented. But in some (many? most?) cases using this feature could be a bad idea\nactually.\n```\nReported by fverschelde on 2009-04-26 21:41:12\n. ```\n@fverschelde: You're completely right, but Minify can already be misused this way; \nwe have to assume that people will use Minify wisely depending on the structure of\ntheir site, how visitors surf it, etc.\nThat said, this feature is pretty low on my priority list and may be a lot more \nmessy than I originally thought.\n```\nReported by mrclay.org on 2009-05-01 18:01:35\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. ```\nJust because it can promote bad practice (for unexperienced users) it does not mean\nit can't be usefull. The example you posted is in my eyes just bad practice. What i\nam just trying to say is that it is ultimately the responsibility of the coder to \noptimize their calls to minify, not the author of minify to prevent you from doing\nthat.\n```\nReported by gilles0181 on 2009-06-08 06:33:08\n. ```\nThis allows the 2.1.3 release to serve both multiple groups (comma-separated keys) \nand files in the same request. Caveats from the docs:\nCaveat: Groups always come before files, but the groups are ordered as requested. \nE.g.\n/f=file.js&g=js1,js2 == /g=js1,js2&f=file.js != /g=js2,js1&f=file.js\nCaveat: If JS group(s) are specified, the method will still allow you to add CSS \nfiles and vice-versa. E.g.:\n/g=js1,js2&f=site.css => Minify will try to process site.css through the Javascript\nminifier, possibly causing an exception.\n```\nReported by mrclay.org on 2009-10-13 00:15:22\n- Status changed: Started\n\n- Attachment: MinApp.php\n. Trunk fixed in R381\nReported by mrclay.org on 2009-10-13 00:57:59\n- Status changed: Fixed\n. FYI, this is coming in 2.1.4\nReported by mrclay.org on 2010-05-17 04:31:05\n- Status changed: Started\n- Labels added: Release-2.1.3\n. 2.1.4 beta has this feature. http://code.google.com/p/minify/downloads/detail?name=minify_2.1.4_beta.zip\nReported by mrclay.org on 2010-07-08 04:59:03\n- Status changed: Fixed\n. ```\nCSS Compressor's code is all entangled with its web front end. Would you like to \nrewrite it as a class with a ::minify($css, $options) method?\nMy favorite consideration is CSSTidy; using a true parser might be necessary if CSS3\nsyntax gets more wacky.\nFrom what I can tell none of these preserve comment hacks. I know these are \nthankfully headed out of style, but I don't want to potentially break users' CSS to\nsave just a few bytes.\n```\nReported by mrclay.org on 2009-02-09 05:41:44\n- Status changed: Accepted\n- Labels added: Type-Enhancement, Priority-Low\n- Labels removed: Type-Defect, Priority-Medium\n. ```\nI don't know if CSSTidy has the same compress ratio as the first one, but it seems to\nknow all optimization rules.\nI whould not set it as default class, just like additional possibility, that I can\nconfigure throw compressorname as a parameter.\nSuch css compressor can make the file 60% smaller, sometimes its not just a few bytes.\nBy minifying javascript you are also breaking users code. So for that case I whould\nbuild a debug mode, in which no css and javascript files will be minified/optimized\n```\nReported by oleg008 on 2009-02-09 10:33:30\n. ```\n2.1.2b has several Javascript fixes. Can you see if the problem still exists with \nthat beta:\nhttp://groups.google.com/group/minify/browse_thread/thread/8add5761eb27d67d\nI'm going to guess the problem is due to your first file ending with a comment.\n```\nReported by mrclay.org on 2009-02-21 20:17:49\n. ```\nIt works perfect with this version! I think I will use it even although is a beta..\nuntil I see another problem (and report it)\nAnd you're right. The first file ended with:\n\"//-->\"\nLet me know if there's any way I can help\n```\nReported by netnotioncom on 2009-02-22 15:58:47\n. Reported by mrclay.org on 2009-02-23 01:46:14\n- Status changed: Duplicate\n- Merged into: #73\n. R291 added option.\nTo Do:\n1. Unit test in test_Minify\n2. Add option to /min/config.php\nReported by mrclay.org on 2009-02-26 17:07:53\n. Completed in R292.\nReported by mrclay.org on 2009-03-01 21:35:38\n- Status changed: Verified\n. it was on linux server, on my localhost (on windows) any fails, everything ok\nReported by SmallPartOfEternity on 2009-03-02 02:09:32\n\n- Attachment: config.php\n. hmmm.. i set output_buffering (in php.ini) to ON and any fails on linux server\nReported by SmallPartOfEternity on 2009-03-02 03:08:28\n. ```\nWhat does \"any fails\" mean? \nPath rewriting depends on server environment settings; please give me the output of\nthis (but I can't guarantee it will help me):\nphp\necho $_SERVER['DOCUMENT_ROOT'], '<br',\n     realpath($_SERVER['DOCUMENT_ROOT']), '',\n     __FILE__;\n```\n\nReported by mrclay.org on 2009-03-02 13:56:02\n- Status changed: NeedInfo\n. ```\nSorry for my english, writing 'any fails' I mean that's minify pass all tests and\nworking properly.\nI have wrong vesrion minify, now everything is ok. Great script! Please close/delete\nthis issue. \nReagrds\n```\nReported by SmallPartOfEternity on 2009-03-05 10:53:00\n. No problem.\nReported by mrclay.org on 2009-03-05 12:57:37\n- Status changed: Invalid\n. @todo, fix typo in docblock for HTTP_ConditionalGet line 48 (should be \n'lastModifiedTime')\nReported by mrclay.org on 2009-03-23 17:57:13\n. ```\nWhether or not Minify continues using them, it appears that HTTP_ConditionalGet \nshould be extended to allow inserting knowledge of the client's Accept-Encoding and\nthe Content-Encoding sent.\nE.g. \nidentity: ETag: \"123456pub\"\ngzip    : ETag: \"123456pub;g\"\ndeflate : ETag: \"123456pub;d\"\nWhen checking If-None-Match I believe it's sufficient to remove the /;\\w$/ from the\nheader and the ETag to be sent, but I'm still foggy as to how proxy caches deal with\nthis and whether Vary should be included at all when ETags are available. Consulting\nthe apache users list...\n```\nReported by mrclay.org on 2009-03-28 22:14:14\n. ETags now vary in R318. Still undecided whether to remove ETag support completely. \nIn order to support ETags properly, we now have to sniff encoding on conditional \nrequests, so there's a performance penalty.\nReported by mrclay.org on 2009-03-30 01:52:19\n- Status changed: Started\n- Labels added: Release-2.1.2\n. Leaving ETags in for 2.1.3 release.\nReported by mrclay.org on 2009-06-30 16:59:21\n- Status changed: NeedInfo\n. Reported by mrclay.org on 2009-07-01 20:26:38\n- Status changed: Verified\n. Thanks! I patched and re-released minify_2.1.2.zip with this fix.\nReported by mrclay.org on 2009-03-04 16:46:00\n- Status changed: Verified\n- Labels added: Priority-High\n- Labels removed: Priority-Medium\n. ```\nStrange. By \"path\" do you mean filesystem path or URI path? Full path or from \ndoc_root?\nIn the cache directory, the plaintext files are like \"minify_[md5]\" (no extension).\nCan you verify that these files are correct (no path at top)? I don't know if this\nis what you meant by \"cache is correct\".\nCan you tell in Firebug if the response is deflated/gzipped?\n```\nReported by mrclay.org on 2009-03-04 17:10:41\n- Status changed: NeedInfo\n. ```\nThe complete filesystem path.\nThe cache is OK - both plain text, deflated and gzipped - meaning there is no extra\npath at the top. \nThe output from minify is indeed deflated/gzipped, but the extra path is at the top\n(not deflated/gzipped) - breaking the browser (and Firebug). If I fecth the output\nfrom minify with wget/curl, remove the extra path line, I'm able to unencode the output.\nSo the simple question (for you who know minify) is, where is the path line added?\nPS! The only \"special\" setting I have, is that I actually have set $min_documentRoot.\n```\nReported by hansfn on 2009-03-04 23:56:30\n. ```\nCould you try the 2.1.2 I uploaded today, install fresh and manually reset your \nconfig.php? \nIs it the path of the cache file or the source file?\nCan we try to resolve this over IM/e-mail? I'm usually on 8AM-5PM GMT-5. Check \nhttp://mrclay.org/ for contact info. I'll probably suggest sticking exit() in \nvarious places :)\n```\nReported by mrclay.org on 2009-03-05 01:25:22\n. ```\nOK, as I predicted in my first post - I had done something very stupid/wrong. When\ndebugging issue 92, I added an \"echo $path;\" statement and forgot to remove it. I\ndownloaded the new 2.1.2 (that you uploaded today) and a recursive diff made the\nerror immediately clear.\nI'm sorry about the noise and wasted time and effort. Please close this issue.\nHans\n```\nReported by hansfn on 2009-03-05 01:57:20\n. No problem.\nReported by mrclay.org on 2009-03-05 12:51:46\n- Status changed: Invalid\n. 7-zip seems to be to blame. Re-zipped with Alzip. Can you verify the new zip works?\nReported by mrclay.org on 2009-03-04 16:05:46\n- Status changed: Fixed\n- Labels added: Priority-High\n- Labels removed: Priority-Medium\n. Fixed in R301\nReported by mrclay.org on 2009-03-05 16:47:42\n- Status changed: Verified\n- Labels added: Release-2.1.2\n. ```\nLet's assume your actual doc root is this:\n'/home/nordhaug/www'\nAdd this to config:\n$min_symlinks = array(\n  '//~nordhaug' => '/home/nordhaug/www'\n);\nWhat's $_SERVER['DOCUMENT_ROOT'] in this setup?\n```\nReported by mrclay.org on 2009-03-05 21:31:46\n- Status changed: NeedInfo\n. ```\nVery close - it's \"/home/nordhaug/html\" ;-)\nAdding the lines you suggested to config.php almost fixed the issue - I now get\n\"~nordhaug/css/menu_bg.jpg\". The leading slash is missing. (I read about symlinks,\nbut didn't see that it could be used like this.)\n$_SERVER['DOCUMENT_ROOT'] is /home/httpd/html\nPS! Thanks for the quick replies.\n```\nReported by hansfn on 2009-03-05 21:49:52\n. ```\nHmm, make sure that your docRoot doesn't end with a slash; that will cause missing \nleading slashes.\nOr it's possible my symlink code has an off-by-one bug. I need to write a unit test\nfor it.\nThe symlinks feature just allows the URI rewriter to \"unresolve\" real file paths \n(e.g. /home/nordhaug/html/myFile) back into fake ones (e.g. /home/nordhaug/html/\n~nordhaug/myFile), so then when you strip off the leading docRoot, you get the \ncorrect root-relative URI (/~nordhaug/myFile).\n```\nReported by mrclay.org on 2009-03-06 00:24:29\n. Then it must be a off-by-one bug, because I did double-check the trailing slash. I\nhave symlinked config.php to config.phps so you can verify for yourself:\nhttp://home.himolde.no/~nordhaug/minify/config.phps\nReported by hansfn on 2009-03-06 00:39:05\n. ```\nIt's a off-by-one bug.\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.2/min/lib/Minify/CSS/\nUriRewriter.php#55\nLine 55 should be:\n$link = str_replace('//', realpath(self::$_docRoot) . '/', $link);\nDoes this fix for you?\n```\nReported by mrclay.org on 2009-03-06 01:14:00\n. ```\nNo, because the symlink is apperently already expanded at this point. I added some\necho statements to display the value of $link in that foreach loop - see\nhttp://home.himolde.no/~nordhaug/minify/?f=css/layout.css\n(I inserted a die() after the loop - if you wondered why the CSS didn't display.)\n```\nReported by hansfn on 2009-03-06 01:42:37\n. Oops. You need both these changes: \nhttp://code.google.com/p/minify/source/detail?r=302\nReported by mrclay.org on 2009-03-06 02:44:33\n. ```\nThx, that did the trick. It wasn't a UserDir issues, but at least we got another bug\nfixed.\nHans\n```\nReported by hansfn on 2009-03-06 06:18:51\n. Reported by mrclay.org on 2009-03-19 16:46:21\n- Status changed: Verified\n. Reported by mrclay.org on 2009-03-19 16:48:01\n- Labels added: Release-2.1.2\n. Basically done in 2.1.3. More work to do in Issue 124.\nReported by mrclay.org on 2009-07-01 19:09:54\n- Status changed: Verified\n- Labels added: Release-2.1.2\n. To what are you setting $min_symlinks in config.php ?\nReported by mrclay.org on 2009-03-18 01:28:42\n. $min_symlinks=array('//' => '/home/user/path/to/public_html');\nReported by kristof@fooman.co.nz on 2009-03-18 01:32:13\n. What is the realpath() of your document_root? And of your CSS file? I think I need \nto write a little app to test this class outside the framework.\nReported by mrclay.org on 2009-03-18 02:33:40\n. ```\nUnfortunately this happened on a server where I only had temporary access. I am using\nthe same code on multiple websites and the thing that stood out was that on the\nLitespeed server the change from 302 needed to be reversed. It works on \"normal\"\nApache sites.\nI will update this post again if I get the chance to obtain better data for debugging.\n```\nReported by kristof@fooman.co.nz on 2009-03-18 20:00:03\n. ```\nWhen you get a chance:\nPlease update your files that were changed in R309, enable debug mode in config.php,\nand add &debug=1 to your minify CSS URI. This will prepend the output with debugging\ninfo for the URI rewriting process.\nThe new rewriter also removes trailing slashes from realpath()s, so it's possible \nthe update could solve some issues.\n```\nReported by mrclay.org on 2009-03-19 16:45:38\n- Status changed: NeedInfo\n- Labels added: Priority-High\n- Labels removed: Priority-Medium\n. Will reopen if we can get better diagnostics from this environment. Let's work this\nout on the support list...\nReported by mrclay.org on 2010-04-23 15:04:09\n- Status changed: WontFix\n. Thanks. I'm refactoring this class right now so I'll look into that.\nReported by mrclay.org on 2009-03-18 14:44:37\n- Status changed: Accepted\n- Labels added: Priority-High\n- Labels removed: Priority-Medium\n. What are your docRoot and symlink settings?\nReported by mrclay.org on 2009-03-18 16:39:55\n. ```\nPlease update your files that were changed in R309, enable debug mode in config.php,\nand add &debug=1 to your minify CSS URI. This will prepend the output with debugging\ninfo for the URI rewriting process.\nThe new rewriter also removes trailing slashes from realpath()s, so it's possible \nthe update could solve some issues.\n```\nReported by mrclay.org on 2009-03-19 16:44:45\n- Status changed: NeedInfo\n. I'm having the same problem also (with latest checkout from Trunk).\nAs I only use UriRewriter class and not the whole minify suite, how do I enable debug\nmode so I can provide additional info?\nReported by layanto@yahoo.com on 2009-05-04 20:37:49\n. @laya... : If you're just using that class, just echo Minify_CSS_UriRewriter::\n$debugText after calling rewrite() or rewriteRelative().\nReported by mrclay.org on 2009-05-04 20:59:58\n. ```\nThanks for the quick reply ;)\nWith the help of $debugText, I have fixed most of my problems (with one problem\nremaining). Previously I was passing $path including the css file name, now I'm\npassing just the path [with dirname($path)].\nInfo:\nTrying to use Minify_CSS_UriRewriter::rewrite with YUI.\nDoc Root: c:\\projects\\abc\\web\nYui located in: c:\\projects\\abc\\web\\yui\nCSS I was testing UriRewriter with:\nc:\\projects\\abc\\web\\yui\\menu\\assets\\skins\\sam\\menu.css\nCode:\n$path = 'c:\\projects\\abc\\web\\yui\\menu\\assets\\skins\\sam\\menu.css'\n$content = Minify_CSS_UriRewriter::rewrite(\n                    file_get_contents($path)\n                    ,dirname($path)\n                    ,'c:\\projects\\abc\\web'\n                    ,array()\n            );  \n$debugText:\ndocRoot : sf_root_dir\\web \ncurrentDir : sf_root_dir\\web\\yui\\menu\\assets\\skins\\sam \nfile-relative URI : ../../../../assets/skins/sam/sprite.png \npath prepended :\nsf_root_dir\\web\\yui\\menu\\assets\\skins\\sam........\\assets\\skins\\sam\\sprite.png \ndocroot stripped : \\yui\\menu\\assets\\skins\\sam........\\assets\\skins\\sam\\sprite.png\ntraversals removed : /yui/menu/assets/assets/skins/sam/sprite.png \nThe correct absolute path should be: /yui/assets/skins/sam/sprite.png\n```\nReported by layanto@yahoo.com on 2009-05-05 02:45:52\n. ```\n@laya... Yep, definitely a bug. When I remove the traversals by hand I get the right\nURI:\n\\yui\\menu\\assets\\skins\\sam........\\assets\\skins\\sam\\sprite.png\n\\yui\\menu\\assets\\skins......\\assets\\skins\\sam\\sprite.png\n\\yui\\menu\\assets....\\assets\\skins\\sam\\sprite.png\n\\yui\\menu..\\assets\\skins\\sam\\sprite.png\n\\yui\\assets\\skins\\sam\\sprite.png\n```\nReported by mrclay.org on 2009-05-05 12:35:03\n- Status changed: Accepted\n. ```\nFix in R328. Can you verify the UriRewriter.php in that rev works for you? I added a\ntestcase with your input and it now passes.\n```\nReported by mrclay.org on 2009-05-05 13:09:44\n- Status changed: Fixed\n- Labels added: Release-2.1.2\n. Fixed!!\nYUI has many deeply nested structure, so hopefully this fix will work with even\ndeeper nesting (more traversals).\nThanks.\nReported by layanto@yahoo.com on 2009-05-05 21:12:26\n. Yay\nReported by mrclay.org on 2009-05-05 21:18:02\n- Status changed: Verified\n. Sort of a general question, but any idea when a tag might be made containing this\nfix?  Not sure if you have a 2.1.3 release in mind.  Your fix seems to have solved\nthe issues I was having regarding this bug, but I'm hesitant to run off of a trunk\ncheckout in case there is work in progress being done.  No rush, just wondering is\nall.  Thanks again.\nReported by bmharris on 2009-06-09 21:02:29\n. 2.1.3 will be tagged soon. There are bigger changes I want in 2.2.\nReported by mrclay.org on 2009-06-11 01:14:51\n. ```\nI'd prefer to keep this out of version control to avoid revving Minify.php with each\nrelease. Is there any other solution that would be helpful?\n```\nReported by mrclay.org on 2009-03-23 23:02:36\n. ```\nThe Zend Framework includes a version constant and it works just fine. I would also\nlike to see this implemented so I could at least know what version of Minify that I\nam \nrunning.\n```\nReported by leeked on 2009-04-21 18:41:41\n. Fair enough. Will be added in next release.\nReported by mrclay.org on 2009-04-21 19:35:44\n- Status changed: Started\n- Labels added: Release-2.1.2\n. Hell, even a README with a version number in it would work :)\nReported by leeked on 2009-04-21 19:38:44\n. Fix in R331\nReported by mrclay.org on 2009-06-30 16:57:49\n- Status changed: Verified\n. Fixed in R318.\nReported by mrclay.org on 2009-03-30 01:49:27\n- Status changed: Verified\n- Labels added: Release-2.1.2\n. ```\nIt seems to have been a matter of setting the correct backtrack_limit.\nI had to set it to at least 550,000. Now I get an output.\nSo this ticket can be closed.\nBye Jochen\n```\nReported by jochen@joschs-robotics.de on 2009-04-09 09:35:44\n. Reported by mrclay.org on 2009-04-21 19:37:18\n- Status changed: Invalid\n. ```\nI revised my code and there were excess requires of Minify_CSS and Minify_Javascript,\nso at the moment, the problem is solved.\nPerhaps, it would be better to have Minify use require_once instead of require to\nmake it more robust.\nFrom my perspective this ticket can be closed.\nBye Jochen\n```\nReported by jochen@joschs-robotics.de on 2009-04-09 09:38:51\n. Thanks. Will change to require_onces.\nReported by mrclay.org on 2009-06-11 01:50:54\n- Status changed: Accepted\n- Labels added: Priority-Low, Release-2.1.2\n- Labels removed: Priority-Medium\n. Fixed in R326\nReported by mrclay.org on 2009-06-30 16:55:43\n- Status changed: Verified\n. http://crisp.tweakblogs.net/blog/1856/jsmin+-version-13.html\nStill waiting for JScript CC support, then I'll do some benchmarks (significantly \nslower than JSMin would be bad). YUI comments might be able to added with some \ncaveats (can minify the content before/after the YUI comments then just combine \nthem).\nReported by mrclay.org on 2009-06-30 16:33:45\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. Not sure I can trust this being supportable at this point. With our JSMin now supporting\n\"+ ++\" syntax, there's not a lot of motivation to move.\nReported by mrclay.org on 2011-09-04 00:25:37\n- Status changed: WontFix\n. Note: This is more of a task/enhancement, but for some reason I could only enter it\nas \na 'defect'.\nReported by leeked on 2009-04-21 18:39:28\n. ```\nHow do you imagine such an integration? What would the API/end user code look like?\nI've yet to do any serious work with ZF, but making Minify easier to work into \nexisting frameworks is a goal I'm behind.\nAt the very least we could host some code in the repo/guide on the wiki.\n```\nReported by mrclay.org on 2009-04-21 19:27:21\n- Status changed: Accepted\n- Labels added: Type-Enhancement\n- Labels removed: Type-Defect\n. ```\nI've done some integration with Zend Framework on projects I work on, and so far its\nconsisted of the following pieces:\n-config file that is an array of js or css files\n-section in the Initializer that uses Zend_Registry to register the array of js/css\nto be used by other classes (view helper)\n-view helper use Minify_Build and config array in Zend_Registry to render the script\ninclude, or include the scripts un-minified if a disabled flag is set (useful for\ndevelopment)\n-last piece is a js.php or css.php file in the public that gets the same js/css\nconfig array, and actually outputs the minified data using Minify::serve();\nThere may be a better way, but so far that's what I've come up with.  I'd be glad to\nhelp out with sharing the View Helper, and other pieces of code as a tutorial of sorts.\n```\nReported by bmharris on 2009-06-09 20:08:02\n. ```\nIt would be great if it tapped into the HeadSCript and HeadStyle plugins, so you \nwouldn't need a config array of files to maintain. By extending those plugins you could\npotentially create a unified minified file per page, and wirte the reference for that\nnew \nfile into the HTML page -- all without affecting anything either the developer or the\nend \nuser comes into regular contact with.\n```\nReported by marcelkornblum on 2010-02-16 11:22:35\n. ```\nI already wrote Zend framework plugins for Minify, although some of the code is\nslightly specific to my own project (and thus you couldn't just drop these two plugin\nfiles in place and use them).  I did this via View Helpers (created one called\nMinifyScript.php and one called MinStyleSheets.php) and then in my layout I call to\n<?= $this->minStyleSheets() ?>\n<?= $this->minifyScript() ?>\n\ninstead of $this->headScript() and $this->headLink() or whatever it was before. \nDownside is that if you had any other  tags they wouldn't print, but in my\ncase I did not.  I imagine MinStyleSheets.php could probably be expanded to clear out\nstylesheet link tags and leave all others in place, and $this->headLink() could still\nbe called, but I didn't fiddle much with it.  Same goes for $this->headScript() (as\na\nresult of how I did this, I had to duplicate some code to handle inline scripts in\nMinifyScript, but if the linked scripts were just cleared out, you could still call\nheadScript() instead which I think is cleaner, but again, I didn't fiddle much with\nit).\nNote that this approach requires you to use the headLink()/headScript() view helpers\nto add javascript and CSS files\n$this->headLink()->appendStylesheet( $this->baseUrl . '/public/userbar.css' );\n$this->headScript()->appendFile( $this->baseUrl . '/public/javascript/userbar.js' );\nIn both functions you'd need to fix getMinUrl() and getBaseUrl(), and replace any\nreferences of FrameWork_Lib::getBaseURI() in the files.\nHopefully the attached files help.\n```\nReported by brandon.farber on 2010-02-16 13:51:09\n\n- Attachment: MinifyScript.php\n- Attachment: MinStyleSheets.php\n. ```\nOh, to add to my last comment, I had a basis for both classes (I didn't write them\nfrom scratch).  Reference to the original code:\nhttp://www.gsdesign.ro/blog/minify-css-in-zendframework/\n```\nReported by brandon.farber on 2010-02-16 13:53:51\n. ```\nYou might want to glimpse at a similar component I have built for my library (which\nuses Zend Framework. It can minify and bundle in a master file css and js using common\nalgorithms such as Yui or Crockford) and of course code from here (big thanks to the\nauthor for the Yui implementation) it uses the headLink and headScript view helpers,\nit can append inline scripting and it caches everything so that the file is not generated\nover and over. The library is still in early development but maybe that could help\nyou a bit in what you would want to achieve. Code is written in PHP5.3. No documentation\nas of yet but who knows, it may still be of use for someone up to today! You can check\nit out here: http://github.com/majisti/Majisti/tree/master/library/Majisti/View/Helper/Head/\n```\nReported by Ratius on 2010-06-21 23:58:50\n. ```\nBrandon made a great start. But I was looking for a drop in replacement for headLink().\nI have made a version which needs Minify on the include path. It outputs the generated\ncss file to a local file instead of calling the php version of minify. I guess the\nweb server can just as well (with less memory usage!) send the static file and headers\nneeded.\nIt is not thoroughly tested and should be considered a draft. The interface of Minify\nis not really that great to use for integration into other applications, as it has\na lot of cross references. But it should do the job.\nUsage:\n1. Add the file to your library.\n2. Set up the view to use the new helper.\n3. Create a folder 'cached' in your document root.\n```\nReported by mkoonstra on 2010-06-30 18:31:26\n\n- Attachment: HeadLink.php\n. ```\nGreat Stuff mkoonstra this is much more along the lines I was looking for.\nI've also implemented a similar solution for HeadScript which uses the google closure\ncompiler:\nhttp://github.com/balupton/balphp/blob/master/lib/Bal/View/Helper/HeadScriptBundler.php\n```\nReported by balupton on 2010-10-16 00:43:12\n. Drop in Zend Script Helpers for Minify -> https://github.com/bubba-h57/zf-helpers\nReported by rob@hines57.com on 2011-02-10 17:20:02\n. thanks\nReported by vinusemail on 2011-02-11 07:49:14\n. Reported by mrclay.org on 2011-09-03 23:43:27\n- Status changed: Started\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. ```\nWhat charset did you use and how was it mangled? Actual input/output of the first \nfew lines would be handy.\nBe aware that Minify automatically sets charset in the Content-Type header (UTF-8 by\ndefault). To change this, add one of these to config.php:\n$min_serveOptions['contentTypeCharset'] = 'ISO-8859-1';\n$min_serveOptions['contentTypeCharset'] = false; // do not set charset\nAlso note you must ensure all combined file have the same (or \"compatible\") \nencoding; they will not be normalized.\n```\nReported by mrclay.org on 2009-04-22 17:25:42\n- Status changed: NeedInfo\n. ```\nWhat charset did you use and how was it mangled?\n\n\nI use UTF-8, as you can see in the following snippet:\n@charset \"UTF-8\";@media screen,projection{body{background:#4d87c7 url\n(\"/css/images/bg_blue.png\") repeat-x top left fixed;padding:10px\n0}#page_margins{margin:0\nThe problem is, that all CSS validators criticise that the @charset declaration\nshould stand ALONE in the FIRST LINE.\n\n\nAlso note you must ensure all combined file have the same (or \"compatible\") \nencoding; they will not be normalized.\n\n\nThey have...\nMaybe I should remove EVERY @charset declaration in my CSS files?\n```\n\n\nReported by p.jerney on 2009-04-24 09:39:31\n. ```\nSince UTF-8 is the default, yes, you can remove all your @charset declarations. Also\nin CSS2.1, UTF-8 is assumed.\nLooking into this more, a trailing newline is not required or even suggested by the\ncurrent spec: http://www.w3.org/TR/CSS21/syndata.html#x50\n...nor by its likely replacement: http://www.w3.org/TR/css3-syntax/#charset\nIndeed the official validator does not complain:\nhttp://jigsaw.w3.org/css-validator/#validate_by_input\nThis is completely valid:\n@charset \"UTF-8\";body{background:#4d87c7;}\nThanks for taking the time to report this.\n```\nReported by mrclay.org on 2009-04-24 13:17:38\n- Status changed: Invalid\n. Issue 172 has been merged into this issue.\nReported by mrclay.org on 2010-04-18 22:47:21\n. Sorry, I meant to enter...\nMinify version: 2.1.2\nPHP version: 5\n...but I don't think that will matter in this case.\nReported by diego.alto on 2009-04-23 15:18:09\n. ```\nI'll be able to look more at this over the weekend. In the meantime, open up this:\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.2/min/lib/Minify/CSS/\nCompressor.php#83\nTry changing: '@\\s/\\([\\s\\S]?)\\/\\s*@'\nTo: '@/\\([\\s\\S]?)\\*/@'\n```\nReported by mrclay.org on 2009-04-23 15:55:30\n- Status changed: Accepted\n. ```\nThanks, for the mean time I've just removed the comment - it's the most obvious easy\nsolution - but of course, it's best to actually fix the issue when you can to stop\nit \nhappening again as it breaks the css and can be tricky to identify the source of the\nproblem.\n```\nReported by diego.alto on 2009-04-23 16:06:34\n. Fix in R325. We lose a few bytes of compression here and there, but worth it to \nbreak less stuff.\nReported by mrclay.org on 2009-05-01 02:55:32\n- Status changed: Verified\n- Labels added: Release-2.1.2\n. ```\nI see what you've done with the fix, but there shouldn't be any need to lose any \nbytes in compression, if you replace every comment with a space, then replace every\nsequence of spaces (ie.: \\s+) with a single space. That way the compression will \nstill be just as efficient but spaces will be left where required.\nYoy may be doing this already, but I couldn't tell from the changes in...\nhttp://code.google.com/p/minify/source/detail?r=325\n```\nReported by diego.alto on 2009-05-01 06:56:50\n. Replacing \\s+ with \" \" led to Issue 49, and, while no user ran into that problem, \nI'd rather not break valid CSS strings. Other ideas?\nReported by mrclay.org on 2009-05-01 11:30:36\n- Status changed: Fixed\n. ```\nI have my own ASP/JS/CSS used in my CMS (although now I use minify for JS/CSS) and I\nhave to overcome a similar issue. In my case, I was satisfied that my code will never\nrequire 2 consecutive spaces and where it does, I can simply change my code \naccordingly... I know that's not the case for minify so here is my suggestion.\nI use a technique in my compressor that goes like this: before making any changes to\nthe code, I remove blocks of the code that I do not wish to be affected.\nSo, in the case of minify, you could\n1. identify string definitions and store them in an array\n2. replace them with a place holder - some string pattern\n3. compress, remove multiple white-spaces, etc...\n4. find string definition place holders\n5. replace them sequentially in the order they appear in the array\nMore specifically, I use this technique to highlight search terms on a HTML page. \nRather than searching for \"word\" and replacing with \"word\" in small\nchunks of text as I build the HTML, I take the entire (finished) string and remove\nall HTML definitions and apply the highlighting using the steps described above.\nI hope that makes sense - and perhaps help in some way...\n```\nReported by diego.alto on 2009-05-01 14:40:31\n. ```\nThe biggest hurdle I see is identifying string definitions. CSS has some wacky \nstring syntax so I think it'd require building a tokenizer, but I haven't looked \ninto it deeply. There are some other CSS min techniques I'd like to port before \ntrying this:\nhttp://regexadvice.com/blogs/mash/archive/2008/04/27/Update-to-CSS-Minification.aspx\nI'm going to mark this Verified and maybe open a separate ticket about whitespace \nlater.\n```\nReported by mrclay.org on 2009-05-01 17:42:40\n- Status changed: Verified\n. ```\nI agree. For the record, I think it would be a matter of hiding all \"expression:\" \ndefinitions and :\\s\"[^\"]\" and :\\s'[^']'\nI don't know much about gzip'ing, but I'm guessing it would take care of white space\nrepetition anyway...\nThose CSS min techniques are pretty cool and will be much more beneficial than this\nanyway...\n```\nReported by diego.alto on 2009-05-01 17:52:41\n. ```\nThe PHP overhead is certainly a concern (though in my limited testing I found Minify\noutperformed Apache with mod_deflate, which apparently doesn't cache encoded \nversions). Also high-traffic sites should probably use a reverse proxy cache like \nsquid, which would cache Minify's output.\nMy issue with releasing workflows with Minify is that everyone has a unique \nworkflow/build process with different variables to consider: files hosted on \nseparate host/CDN? CDN have mod_rewrite (so you can rev URLs)? Should source files\nbe monitored for changes? How would we do this if PHP is out of the loop? cron? What\nabout IIS?\nMaybe a simple tool to output all the groups defined in groupsConfig.php and \nan .htaccess file would be a nice first step...\nIf you have more ideas, hit up the Google group.\n```\nReported by mrclay.org on 2009-04-29 20:58:29\n- Status changed: WontFix\n- Labels added: Type-Enhancement\n- Labels removed: Type-Defect\n. ```\n1. Minify should be sending Content-Type: text/\ncss;charset=UTF-8. As long as this header is sent, the browser shouldn't care about\nthe URL. On your page w/o CSS showing, what's the Content-Type sent? (You'll need an\nHTTP sniffer).\n\nRe: @charset, I want to keep Minify simple: Use UTF-8 in your files. You can \nchange the charset sent by setting $min_serveOptions['contentTypeCharset'] in \nconfig.php, but the minifiers can't handle encodings like UTF-16 anyway. I'm willing\n\nto discuss this more on the Google group.\n\nSomething like this already implemented in 2.1.2:\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.2/min/config.php#69\nMinify should prepend a note to the CSS if you've ended up with an @import not at \nthe top.\n```\n\nReported by mrclay.org on 2009-04-29 20:24:13\n- Status changed: NeedInfo\n. @include essentially dup of Issue 50.\nReported by mrclay.org on 2009-07-01 20:29:41\n- Status changed: Invalid\n. ```\nI just added in R326 a tool to test Minify_HTML output in the browser. At first \ninspection, Minify_HTML output of your home page source validates and displays in \nOpera, but I'll test this in very IE8 soon.\nRe: tabs, can you give me a specific piece of markup from which tabs aren't removed?\n```\nReported by mrclay.org on 2009-05-01 17:21:16\n- Status changed: Accepted\n- Labels added: Priority-Critical\n- Labels removed: Priority-Medium\n. ```\nOh, for the tab problem, I used another source code, from www.bonauer-architekten.ch:\nThe part for the SWFObject beginning with var flashvars=false; contains tabs which\naren't removed.\nThanks for the examination!\nMichael\n```\nReported by michael.heuberger.the.first on 2009-05-02 02:18:16\n. ```\nMichael, Can you still verify this bug exists in Minify 2.1.3? The lines you commented\nout just remove whitespace and convert line endings.\n```\nReported by mrclay.org on 2010-05-09 15:43:59\n- Status changed: NeedInfo\n- Labels added: Priority-Low\n- Labels removed: Priority-Critical\n. ```\nThanks for asking but I am afraid I reported the bug 1 year ago. A lot has changed\nsince then, i.E. we're using something else and now I am unable to reproduce that.\nBut you can copy the HTML code of www.deafzone.ch and test this yourself.\nCheers\nMichael\n```\nReported by heuberger.michael.77 on 2010-05-10 03:34:24\n. ```\nPlease see (just added):\nhttp://code.google.com/p/minify/wiki/CommonProblems#Character_Encodings\nI could be persuaded to change the default behavior to not including charset. If you\nlike that idea, make your case on the Google Groups.\n```\nReported by mrclay.org on 2009-05-05 16:55:47\n- Status changed: Invalid\n. ```\nYes, this code was moved into UriRewriter.php and later fixed in R309.\nI need to make up a release schedul; there are a few smallish bugs that should go in\n2.1.3 and some bigger plans that'd be better for 2.2.\n```\nReported by mrclay.org on 2009-05-18 11:49:23\n- Status changed: Fixed\n. ```\nYour CSS is correctly linked in the HEAD, so obviously this is a bug in YSlow's \nheuristics. It gets it right on mrclay.org, so it may be that the small size of your\ntest page is confusing YSlow. Whatever the case, you can ignore this error.\n```\nReported by mrclay.org on 2009-05-18 19:37:09\n- Status changed: Invalid\n. ```\nMinify (like Apache) prefers deflate over gzip (see URL below) and I'll probably not\nadd an option to change that.\nhttp://stackoverflow.com/questions/878068/enable-moddeflate-to-send-content-encoding-\ngzip/883258#883258\n```\nReported by mrclay.org on 2009-05-19 14:55:06\n- Status changed: Wontfix\n. ```\nApache prefers gzip over deflate!\nIn apache 2.2.9 if you: -\n  1)enable mod_deflate\n  2)add the line: -\n    AddOutputFilterByType DEFLATE text/html text/css application/javascript\nThen Apache will gzipped content.\nIn fact that was the reason, I was asking.\n```\nReported by ruj.sabya on 2009-05-19 15:21:11\n. ```\nI see. I've edited my answer on SO. Basically, IMO mod_deflate has confusing \nconfiguration terms and incomplete documentation w/r/t the actual encodings used.\nI'd definitely like to know if there is some good reason to prefer gzip, even though\nit costs a bit more bandwidth, because I can't find a single major site that prefers\nto send deflate-d content to me. :/\n```\nReported by mrclay.org on 2009-05-19 16:19:30\n. Let's see if we get any answers:\nhttp://stackoverflow.com/questions/883841/why-do-real-world-servers-prefer-gzip-over-\ndeflate-encoding\nReported by mrclay.org on 2009-05-19 16:40:41\n. ```\nCheck the Apache's site itself!\nhttp://httpd.apache.org/docs/2.0/style/css/manual.css\nThat CSS is included in the page below: -\nhttp://httpd.apache.org/docs/2.0/mod/mod_deflate.html\nIf you browse that in FF 3, it they are sending gzipped content.\nAccording the book High Performance Web sites, gzip provides 6% more compression in\naverage.\n```\nReported by ruj.sabya on 2009-05-19 17:10:46\n. ```\nI understand that mod_deflate under Apache 2.2 prefers gzip, as I mentioned in my \nfirst StackOverflow link. Because Apache does this doesn't mean that Minify must.\nGzip does NOT provide more compression than deflate; if the book says or implies \nthis, it's mistaken. Gzip is always a few bytes (~15 in my testing) larger because\nit's a wrapper around deflate.\nIf I get a very good answer from this question, I'll consider dropping deflate:\nhttp://stackoverflow.com/questions/883841/why-do-real-world-servers-prefer-gzip-over-\ndeflate-encoding\n```\nReported by mrclay.org on 2009-05-19 19:57:49\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. ```\nActually the a/a.js has newer modification date.\nAnd, a/old/a.js has older modification date.\nETag should do a hash matching on the content.\nBut currently, minify is serving from the cache, without comparing ETag.\nNOTE: minify works correctly if I place a newer modified file, so \"If-Modified-Since\"\nworks properly.\n```\nReported by ruj.sabya on 2009-05-21 15:10:32\n. ```\nI appreciate the report, but I probably won't fix this.\nCurrently Minify's cache invalidates if the mtime(source) > mtime(cache). This \ninvolves only a few quick filemtime() calls (fast), requires simple logic and \nrequires no metadata be stored in the cache file, allowing us to serve it very fast\nwith readfile().\nYour very reasonable request is for the cache to invalidate when content(source) !=\ncontent(cache), but there are a few reasons I'm not interested in this (today):\n\nIt seems like a rare use case (replacing source files with those with old \nmtimes)... source control/archive exports might cause this, but if you have to do \nthis, you (or your build process) could easily empty the cache directory, or touch()\n\nthe replaced files. Perhaps this warrants documentation on the wiki.\n\nIt would severely hit performance and require drastic changes. At the very \nminimum, on each request PHP would need to run md5_file() on each source file \n(yikes), and at least read several bytes of metadata (either in the cache file or a\n\nseparate file) to verify the hashes match.\nThis cost could be offset somewhat by storing an expiration timestamp for the cache\nfile, then invalidating it when that time is reached. This approach would force \nsource editors to wait to see changes in the minified files unless they manually \nremove cache files, but would at least save Minify from having to read the contents\nof source files on every request.\nIn short: I'd prefer to keep the current fast, simple, imperfect caching system.\n```\nReported by mrclay.org on 2009-05-21 18:12:20\n- Status changed: WontFix\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. ```\nCan't we take different an approach for calculating an ETag?\nFor example: combination of filemtime() and filesize()? Or, something quick like \nthat?\nThis will prevent from calculating expensive md5 of the whole file.\nThis will be very helpful to simplify the build process.\n```\nReported by ruj.sabya on 2009-05-21 18:50:00\n. ```\nI agree, it will not be perfect calculation for ETag.\nBut it will work most of the time (there will be rare chance of failure when a file\nhas different content but same size and same modification date).\n```\nReported by ruj.sabya on 2009-05-21 18:56:40\n. ```\nHmm. We really don't need an expiration on the cache file, but rather a throttle for\nthe validation checks. In other words, for cache validation we could do this \n(pseudocode):\nFunc isCacheFileValid(abc) {\n  // if returns false we'd rebuild abc and abc_hash\n  If is_file(abc) && is_file(abc_hash):\n    If filemtime(abc_hash) over 3 seconds old:\n      Check md5_file(sources) vs contents(abc_hash)\n      If match:\n        Touch(abc_hash). Return true.\n      Else:\n        Return false.\n    Else:\n      Return true.\n  Else:\n    Return false.\n}\nNow on busy server w/ 100s req/s, the vast majority of cache validations will \nrequire only 1 filemtime() and 2 is_file()s, which may even be a performance \nincrease. On a development server, at most the designer would have to wait 3 seconds\nto see a change in what Minify serves.\nThis would still be a big undertaking, so I wouldn't hold your breath, but I'll at\nleast keep it on the table.\n```\nReported by mrclay.org on 2009-05-21 20:59:46\n- Status changed: Accepted\n- Labels added: Type-Enhancement\n- Labels removed: Type-Defect\n. Done in R333/2.1.3\nReported by mrclay.org on 2009-07-01 19:04:35\n- Status changed: Verified\n. It already does: http://code.google.com/p/minify/source/browse/tags/release_2.1.2/\nmin/.htaccess\nDoes it still fail for you on Apache 2.0?\nReported by mrclay.org on 2009-06-30 16:52:11\n- Status changed: NeedInfo\n. I have a similar issue on ProxyPass, minify doesn't work with virtual addresses even\nif local (ProxyPass to another server) it seems to work only on static + local links.\nit would be nice if minify used PHP5 features for fetching the files dynamically.\nReported by ramonck on 2009-11-27 21:21:02\n. @ramonck: Feel free to create a new issue with a more thorough description of what \nyou're trying to do, or better, send a message to the google group.\nReported by mrclay.org on 2009-11-29 05:26:40\n. Reported by mrclay.org on 2010-05-08 19:43:55\n- Status changed: Invalid\n. I'm planning a move to autoloading (see Issue 59). In the meantime, adjusting the \ninclude_path will have to be done manually in these restrictive configs, sorry to \nsay. I suspect autoload will work in these environments, but I don't know for sure.\nReported by mrclay.org on 2009-06-22 14:56:51\n- Status changed: WontFix\n. That's an even better solution.  In the meantime, for those who get stuck with the\nset_include_path() problem, adjust your Apache config by replacing php_admin_value\nwith php_value and restart the server.\nReported by claviska on 2009-06-22 16:44:51\n. Will change to explode in next release. Thanks for the catch.\nReported by mrclay.org on 2009-06-22 16:03:14\n- Status changed: Accepted\n- Labels added: Release-2.1.2\n. Fixed in R333/2.1.3\nReported by mrclay.org on 2009-07-01 19:04:05\n- Status changed: Verified\n. ```\nIt might be nice if ids contained the group name or the list of combined files, \nusing some function to limit length, strip extensions, remove unsafe chars, etc. \nThis could be done in the MinApp controller.\nInstead of: minify_c623e33315b182c85920becc624be27a\nYou'd see: minify_g=css2_c623e33315b182c85920becc624be27a\nor: minify_jQuery,plugin.jqu,plugin2.jq,site_c623e33315b182c85920becc624be27a\nCaveat: memcache keys may be truncated to 250B. Probably a good limit for cache \nids.\n```\nReported by mrclay.org on 2009-07-20 14:00:06\n. Added a while back\nReported by mrclay.org on 2011-09-04 00:43:25\n- Status changed: Verified\n. ```\nIf no cache path is set, the setup should sniff with Solar_Dir, test read/write, and\nsuggest using that directory.\n```\nReported by mrclay.org on 2009-09-09 01:09:24\n. Removed in R331\nReported by mrclay.org on 2009-06-30 18:49:46\n- Status changed: Verified\n. ```\nIdeally all classes should be reworked:\n No work in constructors\n No global state: static methods, hidden dependencies\n HTML/CSS_Compressor: split work into several methods\n Source changes proposed in Issue 50\n Less magic API: Minify constructor accepts a controller (options set in its \nconstructor) and a cache. serve() accepts additional options\n Base controller: \n  analyzeSources() & getDefaultMinifyOptions() move to Minify\n  __construct() takes Request object and options array\n* Request obj (base on Solar_Request w/ some fixes from Zend?) light as possible\nmaybe a \"Minifier\" which compresses sources and combines result.\n```\nReported by mrclay.org on 2009-07-01 20:18:53\n. Reported by mrclay.org on 2012-03-14 13:17:03\n- Status changed: Verified\n. ```\nI vote for 4.\nIE6 users should be encouraged to upgrade.\n```\nReported by mcroxton on 2009-09-08 12:30:35\n. @mcroxton: Most evidence points to workplace IT preventing upgrades. Preventing \ncaching just punishes Minify users by quietly wasting their bandwidth/load. It'll \nprobably still be an option, just not the default behavior.\nReported by mrclay.org on 2009-09-08 18:45:27\n. In R411 and will be in next release. Need to test with real IE6 ideally.\nReported by mrclay.org on 2010-05-09 16:53:16\n- Status changed: Fixed\n. Works for me just fine. Minify 2.1.3, jQuery 1.3.2, PHP version unknown atm. Setting\ndebug through Minify::serve('Files', array( 'debug'=>true )).\nReported by Jan.Hendrik.Holthusen on 2009-07-22 10:18:02\n. ```\nI'm using the groupsConfig.php file to define the list of files, and just generate\nthe URL via Minify_groupUri. Then I add the &debug variable, as explained here:\nhttp://code.google.com/p/minify/wiki/Debugging\nI don't know if the way you did it is equivalent, but I will look into it. \n```\nReported by hi@favrik.com on 2009-07-22 11:12:01\n. Ok, I did a fresh install (previously I just did a file overwrite), tested again, and\nit works as expected. :)  Sorry for the wasted time, please close the issue.\nReported by hi@favrik.com on 2009-07-22 11:55:07\n. No problem! I wish all issues resolved themselves :)\nReported by mrclay.org on 2009-07-22 16:50:41\n- Status changed: Invalid\n. ```\nLast-Modified doesn't cause revalidation, but when the browser re-requests on behalf\nof the user (say, someone hits F5 in IE), Last-Modified or ETag allow that request\nto be conditional and served by the 304 response.\nI suppose if you very, very rarely had re-requests, you could drop Last-Modified \n(ETag is enough for conditional GET and caching in newer proxies) but I just don't\nknow the total impact. Google seems to send LM on long-Expires JS/CSS requests, \nthat's probably enough to convince me it should stay.\nIf you really want to remove it, I could show you how on the mailing list.\n```\nReported by mrclay.org on 2009-07-25 13:52:10\n- Status changed: Invalid\n. ```\nI think Google does that to track usage. \nIf you don't care about tracking resource usage and just want to optimize end user\nperformance for your web app, you don't want the browser to revalidate. Afterall \nhttp://www.mydomain.com/min/?g=jsgroup1&1248544977 should never change. If the group\nof js files are ever modified, there will be new timestamp in the url query and thus\ntreated as a new resource, so revalidating doesn't make sense in that scenario, \nright? (unless you are also trying to track usage, but that can be done from the main\nrequest rather than the request of the associated resources (css, js, etc.).\n```\nReported by Keith.Bentrup on 2009-07-25 18:06:11\n. ```\nInstall an HTTP sniffer like Fiddler and navigate around your site (not reloading \npages). Your browser won't re-request files until the Expires date or max-age is \nreached. Revalidation has nothing to do with Last-Modified.\nIf you're using IE6, this is another issue:\nhttp://groups.google.com/group/minify/browse_thread/thread/11d36ea6239ed0ef\n```\nReported by mrclay.org on 2009-07-25 20:49:39\n. ```\nSorry, perhaps I'm using the wrong word. I was using \"revalidating\" to mean check the\nlast modified date.\nNonetheless, when a browser downloads a URL served by minify like http://www.mydomain.com/min/?g=jsgroup1&1248544977,\nit should never check for a \nmodified version of that URL ... even when the user reloads/revisits the page. That\nresource is permanently cacheable. It will never be modified. We agree on this point,\nright??\nThe group of javascript files may be modified, but then there will also be a new\nURL. \nCurrently, when I user a browser sniffer, I see the browser ask the server if there\nis a modified version of http://www.mydomain.com/min/?g=jsgroup1&1248544977, and I\ndo \nsee a 304 response, but for a highly optimized web app that you want to maximize \ncaching for (or perhaps an app that you want to be able to run offline, too), that\nhas-it-been-modified? request and 304 response are UNnecessary, so they should be \nprevented by sending the appropriate headers to the browser on the first request, \nright?\n```\nReported by Keith.Bentrup on 2009-07-26 14:53:28\n. ```\nThe only time I've seen unnecessary revalidation is the latest Safari after a \nLocation redirect sent with no-cache headers (the default PHP sessions config).\nhttp://groups.google.com/group/minify/browse_thread/thread/c98acffad26a0c88\nEvery Minify response sends an Expires and max-age to prevent revalidation. Even \nwithout the rev number its 30 minutes. If you're seeing unnecessary revalidation, I\nneed full details and a public URL. The Minify URL is not enough, there must be at\nleast two HTML pages that link it and links to navigate between them.\n```\nReported by mrclay.org on 2009-07-26 19:08:45\n- Status changed: NeedInfo\n. Reported by mrclay.org on 2010-01-14 13:49:06\n- Status changed: Invalid\n. Notice this is an enhancement, couldn't figure out how to change it.\nReported by Kramieb on 2009-08-04 13:00:01\n. ```\nJust a note:\n$contents = 0b_get_contents();\nob_end_clean();\nis the same as \n$contents = ob_get_clean();\n```\nReported by Jan.Hendrik.Holthusen on 2009-08-04 16:29:08\n. ```\nEven better:\n<?php ob_start(); ?>\n html \n\nrequire '/min/Minify.php';\nMinify::serve('Page', $ob_end_clean(););\n```\n\n<pReported by Kramieb on 2009-08-04 16:34:57\n. ```\nHow about:\nphp require $_SERVER['DOCUMENT_ROOT'] . '/min/page.php'; ?\n html \npage.php could include all needed Minify files and ob_start('ob_minify_page'). \nob_minify_page() would receive the buffer, check get_included_files() for mtimes, \nand return Minify::serve().\nThis is how http://www.mnot.net/cgi_buffer/ works. It won't work for everyone, but\nI \nlike it.\n```\nReported by mrclay.org on 2009-08-04 16:56:29\n- Status changed: Accepted\n- Labels added: Type-Enhancement, Priority-High\n- Labels removed: Type-Defect, Priority-Medium\n. ```\nDoes that mean it will be cgi_buffer but better?\nOr will this result in an overal compression suite, where you can do something like:\nhttp://pastebin.com/f5b41485\nEven tought of an complete api, will denote it here when I have it ready.\n```\nReported by Kramieb on 2009-08-04 18:13:51\n. ```\nIt would do everything Minify does for JS/CSS files, but for HTML. So, full \nminification of markup and script/style contents, gzip, cache headers, and \nconditional GET.\nI don't want to rewrite href/src to use Minify or automatically inline content. \nThose decisions should stay with the page author.\nThe only initial limitation is that it wouldn't notice the modification of files \npulled in using readfile(), since those don't show up in get_included_files(), but\nmost people don't use readfile for templating anyway.\n```\nReported by mrclay.org on 2009-08-04 18:31:37\n. ```\nFor the case you may want to make it a more generic suit:\nhttp://pastebin.com/f44e13ac2\nOh, and forgot to say it, it won't replace the current functionality, but should be\nnice.\n```\nReported by Kramieb on 2009-08-04 18:40:37\n. ```\nR350 has this working. Just copy the two files in /min/, and at the top of your file:\nrequire $_SERVER['DOCUMENT_ROOT'] . '/min/pageBuffer.php';\nA different API could prevent the page code from being executed at all when the \ncache was fresh (You'd set a server-side maxAge). This would only require that \nanother file be appended:\nrequire $_SERVER['DOCUMENT_ROOT'] . '/min/pageCache_pre.php'; \n/ PHP Page here. Not executed if Minify's cache fresh. /\nrequire $_SERVER['DOCUMENT_ROOT'] . '/min/pageCache_post.php';\n```\nReported by mrclay.org on 2009-08-05 19:53:39\n- Status changed: Started\n. ```\nNoticed a issue, it generates line endings on every first space after the tag title.\nExample:\n\nBecomes:\n\nAnd:\n\nBecomes:\n\n```\nReported by Kramieb on 2009-09-14 17:59:34\n. ```\nThis is done to limit line lengths (which I've been told can cause problems in some\napps) and doesn't add any weight (\"\\n\" = 1 byte).\n```\nReported by mrclay.org on 2009-09-14 21:03:43\n. This doesn't work anymore with the recent minify (files changed), how to get this behavior\nback?\nReported by Kramieb on 2010-04-03 13:19:33\n. Are you using /min/pageBuffer.php? Do you get an error? Checked PHP's error log?\nReported by mrclay.org on 2010-04-03 15:07:20\n. ```\nIt simply wasn't in the latest download. But I just realized it is in the online repo.\nGonna try that first.\n```\nReported by Kramieb on 2010-04-03 15:39:36\n. ```\nthere is a problem with this function\n$root = $modRewriteWorks ? \"/min/f=\" : \"/min/?f=\";\nreturn $root . implode(',', $shortPaths) . \"&\" . $mtime;\nmodRewriteWorks: false\nhttp://examplem.com/min/?g=keyName&1111\nmodRewriteWorks: true\nhttp://examplem.com/min/g=keyName&1111 the second url starts with & and ? is missing.\nFor me the browsers doesn't take the version number it should be http://examplem.com/min/g=keyName?1111\nbecause it was rewriten\n```\nReported by ciprian.mihalache@originals.ro on 2014-04-23 05:56:54\n. What do you mean the \"browser doesn't take the version number\"?\nReported by mrclay.org on 2014-04-23 12:27:22\n- Status changed: NeedInfo\n. btw https://code.google.com/p/minify/wiki/AlternateFileLayouts\nReported by Pich.Dominik on 2014-04-06 11:13:40\n. Original jsmin-php patch for future ref\nhttp://github.com/rgrove/jsmin-php/commit/f89f32db50e943515c7361ebcfb6a2cacf7dc91a\nReported by mrclay.org on 2009-12-21 17:14:48\n. ```\nMark was using these settings:\ndefault_charset = \"UTF-8\"\nmbstring.internal_encoding = UTF-8\nmbstring.func_overload = 7\nand minifying the attached files\n```\nReported by mrclay.org on 2010-05-09 15:49:19\n\n- Attachment: mbstring_test_files.zip\n. These issues should be fixed in 2.1.4\nReported by mrclay.org on 2010-09-30 04:36:12\n- Status changed: Fixed\n. After compression we got it down to 1 pixel. You can find it on the web as \n\"spacer.gif\" (rim shot) No, but that would be nice.\nReported by mrclay.org on 2009-08-28 13:24:59\n- Status changed: Accepted\n- Labels added: Type-Enhancement\n- Labels removed: Type-Defect\n. The atom diagram will have to do for now.\nReported by mrclay.org on 2010-04-23 11:42:21\n- Status changed: Verified\n. Fixed in R411\nReported by mrclay.org on 2011-02-03 22:49:59\n- Status changed: Verified\n. ```\nRe-ordering properties can change effective values, so you need a full CSS parser &\nsome very complicated logic (which no one has developed yet--the article admits if\nyour sheet depends on property order it may be broken).\nIn PHP this would likely have to be built into an extension of CSSTidy's \n\"csstidy_optimise\" class:\nhttp://csstidy.svn.sourceforge.net/viewvc/csstidy/trunk/\nI'm not holding my breath, and I'm likely to stick with our inferior minifier as the\ndefault since it preserves a lot of CSS hacks.\n```\nReported by mrclay.org on 2009-09-21 14:57:18\n- Status changed: WontFix\n. ```\nSteps to solving all character encoding problems in JS/CSS docs:\n1. Convert docs to UTF-8 (if not already)\n2. Send charset=utf-8 in Content-Type\nIf only every problem had such a straightforward solution.\nhttp://annevankesteren.nl/2009/09/utf-8-reasons\n```\nReported by mrclay.org on 2009-09-20 22:47:47\n- Status changed: WontFix\n. ```\nI think this is already possible via the API in a few different ways, and I'll be \nhappy to assist on the google group. You'll probably have to extend the \nMinify_Source class and place the resulting object in groupsConfig.php.\nIt might be cleaner to make this a standalone file rather than try to wedge it into\nthe standard \"min\" app.\n```\nReported by mrclay.org on 2009-09-15 23:00:38\n- Status changed: Invalid\n. ```\nCache IDs are a digest of the following:\n$options['minifiers'] \n$options['minifierOptions']\n$options['postprocessor']\n$options['bubbleCssImports']\nand for each source:\n   id (filename)\n   minifier (usually null)\n   minifyOptions (has the directory of CSS files, usually null for JS files)\nSo if there's any change to one of the source's location/name, options, or global \noptions, you'll get different cache IDs.\nDoes your server have load balancing where DOCUMENT_ROOT changes on different \nrequests? If you had 3 internal servers, you'd get 3 different cache IDs.\n```\nReported by mrclay.org on 2009-09-20 21:51:37\n- Status changed: NeedInfo\n. ```\nHi,\nno load balancing or other fancy stuff used here,\nits a very simple setup.\nThis is my Groups Setup:\nreturn array(\n    'mainjs' => array(\n        new Minify_Source(array(\n            'filepath' => '//js/jquery-1.3.2.min.js',\n            'minifier' => create_function('$a', 'return $a;')\n        )),\n        new Minify_Source(array(\n            'filepath' => '//js/jquery.color.js',\n            'minifier' => create_function('$a', 'return $a;')\n        )),\n        new Minify_Source(array(\n            'filepath' => '//js/jquery.center.js',\n            'minifier' => create_function('$a', 'return $a;')\n        )),\n        '//js/main.js'),\n'iejs' => array('//js/ie.js'),\n'maincss' => array('//css/main.css'),\n'ie6css' => array('//css/ie6.css')\n\n);\nCould it be because of the create_function part?\nWhat is the right way to include a already minified file?\nGreetings\n```\nReported by cg1st8 on 2009-09-21 11:13:10\n. ```\nYes, create_function creates a unique internal function name that probably exists in\nthe serialization.\nYou want: 'minifier' => ''\nSee: http://code.google.com/p/minify/wiki/CustomSource\n```\nReported by mrclay.org on 2009-09-21 14:34:55\n- Status changed: Invalid\n. ```\nOkay thank you\nI found the create_function Example somewhere on this Page.\n```\nReported by cg1st8 on 2009-09-21 16:31:36\n. If it was on the wiki I think I've removed it in a recent cleanup. I made a note \nabout create_function on the CustomSource page.\nReported by mrclay.org on 2009-09-21 16:59:32\n. ```\nYeah nice :)\nIts working great ;)\nThank you very much for your work.\n```\nReported by cg1st8 on 2009-09-21 22:19:29\n. Oops. You got the idea for \"create_function\" from a commented out example in 2.1.3 \ngrouspConfig.php. I'll rewrite/remove this comment in the next release.\nReported by mrclay.org on 2009-10-12 23:24:57\n- Status changed: Accepted\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. Reported by mrclay.org on 2011-09-04 00:48:47\n- Status changed: Verified\n. ```\nFirst suggestion seems reasonable. I'll add a negative value to one of the test \ncases.\nNormalizing indeed can break valid CSS (see URLs below) and who knows what crazy \nfilter/vendor values are out there. I prefer feeling my way around pretty carefully\nin the regexes; peace-of-mind is worth missing a few spaces IMO.\nhttp://code.google.com/p/minify/source/browse/trunk/min_unit_tests/_test_files/css/\nunusual_strings.css\nhttp://code.google.com/p/minify/source/browse/trunk/min_unit_tests/_test_files/css/\nunusual_strings.min.css\n```\nReported by mrclay.org on 2009-09-26 08:35:51\n- Status changed: Accepted\n- Labels added: Type-Enhancement, Release-2.1.3\n- Labels removed: Type-Defect\n. Fixed in R411\nReported by mrclay.org on 2010-05-09 16:47:41\n- Status changed: Fixed\n. ```\nIt's far more likely that appended Javascript/content would be due to a worm infection\nthan to serve legitimate ads on free hosting. I'm leaving out the exit.\n```\nReported by mrclay.org on 2010-05-08 20:30:25\n- Status changed: WontFix\n. In R411\nReported by mrclay.org on 2010-05-09 16:48:21\n- Status changed: Verified\n. ```\nTwo issues here:\n\n/min/index.php/f=css/styles.css will never work because the app doesn't read \nPATH_INFO, just querystring vars, f or g.\n\nWith no f or g set, it falls through to the Builder redirect, which is done via \n\"Location: builder/\" (a relative URI, invalid but works in all browsers). Hence, it\nkeeps trying to redirect to the builder, never getting there.\n\nRewriting isn't working on your host. Particularly:\n\n/min/?f=css/styles.css  and  /min/f=css/styles.css\n...should produce the same output.\nTry adding a RewriteBase:\nRewriteEngine on\nRewriteBase /min/\nRewriteRule ^([a-z]=.*)  index.php?$1  [L,NE]\n```\nReported by mrclay.org on 2009-09-29 19:06:08\n- Status changed: NeedInfo\n. ```\nYou were right, RewriteBase was the key. I also used a RegEx tester to redo the\npattern matching. This works fine now for me:\nRewriteBase /min\nRewriteRule ([gf]=.*) index.php?$1 [L,NE]\n```\nReported by shuffle720 on 2009-09-29 21:03:17\n. ```\nI'd prefer to put this in the next version:\nRewriteEngine On\nYou may need to uncomment this on some servers\nRewriteBase /min\nrewrite URLs like \"/min/f=...\" to \"/min/?f=...\"\nRewriteRule ^([bfg]=.*)  index.php?$1 [L,NE]\n\n\n[bfg] allows you to use a base path: /min/b=css&f=a.css,b.css\n\n\n^ makes sure that the pattern begins directly after \"/min/\". If you don't, you \nrisk breaking URLs like \"/min/foo/bar.php?a=someValue\". Minify doesn't have any such\n\n\nscripts (yet), but I like very targeted rewriting.\nDoes the above work on 1&1 if you uncomment the RewriteBase?\n```\nReported by mrclay.org on 2009-09-29 21:59:38\n- Status changed: Accepted\n- Labels added: Release-2.1.3\n. Yeah, that works!\nReported by shuffle720 on 2009-09-30 23:41:42\n. ```\nHi,\nI did CSS and JS min without ?g=...., all works OK.\nPageSpeed show me 98 and YSlow 92 Point. \nBut Google Webmaster Tools \"Site Performance\" show me, very bad resoults:\nOn average, pages in your site take 3.4 seconds to load (updated on Jan 18, 2010).\nThis is slower than 56% of sites.\n\nGo to URL/ Details: Save up to 70.2 KB, 4 requests, 1 DNS lookups\nCombine external JavaScript\nThere are 2 JavaScript files served from www.techwood.sk. They should be combined\ninto as few files as possible:\n* Go to URLhttp://www.techwood.sk/shared/min/?g=js\n* Go to URLhttp://www.techwood.sk/shared/min/g=js\n\nServe resources from a consistent URL\nThe following resources have identical contents, but are served from different URLs.\nServe these resources from a consistent URL to save 4.19 KB and 1 requests:\n* Go to URLhttp://www.techwood.sk/shared/min/?g=css\n* Go to URLhttp://www.techwood.sk/shared/min/g=css\n\nThe following resources have identical contents, but are served from different URLs.\nServe these resources from a consistent URL to save 52.4 KB and 1 requests:\n* Go to URLhttp://www.techwood.sk/shared/min/?g=js\n* Go to URLhttp://www.techwood.sk/shared/min/g=js\n\nCombine external CSS\nThere are 2 CSS files served from www.techwood.sk. They should be combined into as\nfew files as possible:\n* Go to URLhttp://www.techwood.sk/shared/min/?g=css\n* Go to URLhttp://www.techwood.sk/shared/min/g=css\n\n\nWhat is wrong????\nHelp me pls!\nmy site: www.techwood.sk\n/shared/min/.htaccess:\n\n\nRewriteEngine on\nRewriteBase /shared/min\nRewriteRule ^([a-z]=.*) index.php?$1 [L,NE]\n \n\nIncluding JS, CSS:\n\n\n```\nReported by repcikjuraj on 2010-01-20 09:04:51\n. @repcikjuraj The tool is simply wrong. These tools aren't perfect and you can clearly\nverify there is only 1 request each for Minify's JS/CSS. I recommend smaller/fewer\nimages, and spreading them across a couple subdomains. Even AS IS the page only takes\nabout 1.5s to complete on my end and, once cached, it's super quick.\nReported by mrclay.org on 2010-01-20 13:40:52\n. ```\n@mrclay.org, maybe I found the reason.\n1. Slow loading - I had switched \"Autorun YSlow each time a web page is loaded\" and\nwhen I debug page I used Yslow and PageSpeed often. So it was maybe the reason -\n/beacon/yslow/?. \n2. Doubled adrresses - old address was maybe just in google cache, because now its\nOK.\n```\nReported by repcikjuraj on 2010-01-26 11:48:08\n. Reported by mrclay.org on 2011-09-03 23:47:50\n- Status changed: Invalid\n. Reported by mrclay.org on 2011-09-04 00:47:48\n- Status changed: Fixed\n. ```\nI see: var x='editor'+ ++l;\nThis is a bad coding practice that would be flagged by JSLint, but indeed is a known\nclass of bugs in the JSMin algorithm, and a fix would be quite ugly and probably \npainfully slow and brittle. Two options here:\n\n\nadd parenthesis to the incremented var: var x='editor'+ (++l);\nCKEditor's author might be nice enough to do this for us in a future version, but \nI'd understand if he didn't.\n\n\nServe the file in a group and use a custom source to specify no minifier: http://\ncode.google.com/p/minify/wiki/CustomSource\n```\n\n\nReported by mrclay.org on 2009-10-20 18:03:09\n- Status changed: WontFix\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. Option 3. Switch to the JSMinPlus minifier:\nhttp://code.google.com/p/minify/wiki/CookBook#\n(Slightly)_Better_Javascript_Compression\nIf you have problems with this, please post to the Google Group.\nReported by mrclay.org on 2009-10-20 18:08:50\n. ```\nFound another issue from the same kind : \"invalid increment operand\"\nin ckeditor.js :\n(100)+ +(f[2]||0);\nWhen it is minified, it gives (100)++(f[2]||0);\njust add parenthesis around \"+(f[2]||0)\" :\n(100)+ (+(f[2]||0));\n```\nReported by netelix on 2009-10-26 14:47:05\n. ```\nThe fix is to remove the completely unnecessary second \"+\":\n(100)+ (f[2]||0);\nIt's news to me, but apparently this is valid syntax: 1 + - + - + 1; //2\n```\nReported by mrclay.org on 2009-10-26 15:22:03\n. Issue 168 has been merged into this issue.\nReported by mrclay.org on 2010-05-08 19:36:43\n. Issue 175 has been merged into this issue.\nReported by mrclay.org on 2010-05-08 19:36:58\n. ```\nIn R410, as a workaround JSMin::minify will detect syntax like \"+ ++\" and just return\nthe JS as-is (assuming it's already been minified). The JSMin.php in R410 is safe to\ndrop into release 2.1.3.\nCan someone verify this works OK? I tried to catch all cases like ++ +, ++ ,- ++, etc.\n```\nReported by mrclay.org on 2010-05-08 19:42:30\n- Status changed: Fixed\n. Thanks.  This fixed it for me.  :) http://newhanoian.com\nReported by nathanbrauer on 2010-05-21 09:28:46\n. Reported by mrclay.org on 2010-05-21 14:01:52\n- Status changed: Verified\n- Labels added: Release-2.1.3\n. ```\nThe JSMin just committed to github should now correctly handle this syntax (rather than\nrefusing to minify the input):\nhttps://github.com/mrclay/minify/commit/5b6469467ef72496bfdfe74a7d7b0bb33490074f\nPlease try it out if you can.\n```\nReported by mrclay.org on 2011-06-26 06:43:43\n- Status changed: Fixed\n- Labels added: Priority-High\n- Labels removed: Priority-Low\n. ```\nYou'll need to tell Minify how those virtual directories (which are outside of your\ndocroot) map back into the docroot (as seen by the client). Assuming your CSS files\nare at example.com/css/, you'll do this in config.php:\n$min_symlinks = array(\n  '//css'     => 'D:\\Dev\\i3webdesktop_dev\\resources\\css'\n  ,'//images' => 'D:\\Dev\\i3webdesktop_dev\\resources\\images'\n);\nWith this, the rewriting process will add the essential step (\"symlink unresolved\")\nto map the virtual folders back to the docroot:\nfile-relative URI  : ../images/default/box/tb-blue.gif\npath prepended     : D:\\Dev\\i3webdesktop_dev\\resources\\css..\\images\\default\\box\\tb-\nblue.gif\nsymlink unresolved : D:\\Dev\\i3webdesktop_dev\\system\\globals\\css..\\images\\default\\box\n\\tb-blue.gif\ndocroot stripped   : \\css..\\images\\default\\box\\tb-blue.gif\ntraversals removed : /images/default/box/tb-blue.gif\n```\nReported by mrclay.org on 2009-11-03 02:10:46\n- Status changed: NeedInfo\n. $min_symlinks doesn't work with virtual addresses => http://www.....\nReported by ramonck on 2009-11-27 21:25:44\n. ```\n@ramonck: Minify can only rewrite paths on same system. I've added a wiki entry for\nUriRewriting for example usage.\n```\nReported by mrclay.org on 2009-11-28 14:51:48\n. Closing. User should be able to get this working via wiki docs/support list.\nReported by mrclay.org on 2010-04-23 15:01:49\n- Status changed: Invalid\n. ```\nVery Strange.\nLine 68 has: require_once 'Minify/CSS/UriRewriter.php';\n...so the class should be loaded...or the fatal error should have occurred on 68.\nCan you reinstall? Particularly to re-copy these to your server:\nhttp://minify.googlecode.com/svn/tags/release_2.1.3/min/lib/Minify/CSS/\nUriRewriter.php\nhttp://minify.googlecode.com/svn/tags/release_2.1.3/min/lib/Minify/CSS.php\n```\nReported by mrclay.org on 2009-11-15 14:55:25\n- Status changed: NeedInfo\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. Closing. This looks like a bug in the PHP environment.\nReported by mrclay.org on 2010-04-23 14:59:50\n- Status changed: Invalid\n. ```\nI see. prototype161.js has several XPath expressions containing \"/*\":\nvar xpath = \".//[local-name...\n\"//[local-name()='li' o...\nthis.matcher = ['.//'];...\ndescendant:   \"//\",\nchild:        \"/\",\nreturn cond ? document._getElementsByXPath('.//' + ...\nI'll see if I can add more whitelisting of these expressions, but I probably won't\nget to this very soon. Here's the relevant method:\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.3/min/lib/Minify/\nLines.php#78\nA workaround is to just have the minify() method return the original string. At line\n42 insert:\nif (preg_match('@prototype\\n*.js@', $id)) {\n    // skip troublesome file\n    return $content;\n}\n```\nReported by mrclay.org on 2009-12-01 19:40:57\n- Status changed: Accepted\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. In R411 and will be in next release.\nReported by mrclay.org on 2010-05-09 16:52:03\n- Status changed: Verified\n. ```\nThe next release will use autoloading, so no more requires at all. For your \nsituation you'll have to manually add \"lib\" to your include_path, or use \"php_value\"\ninstead of \"php_admin_value\" in your web config.\nhttp://php.dzone.com/news/setincludepath-failing\n```\nReported by mrclay.org on 2009-12-08 13:00:23\n- Status changed: WontFix\n. Excellent patch, thanks.\nReported by mrclay.org on 2009-12-11 23:32:32\n- Status changed: Started\n- Labels added: Priority-High\n- Labels removed: Priority-Medium\n. In R411 and will be in next release.\nReported by mrclay.org on 2010-05-09 16:50:33\n- Status changed: Verified\n. I'll give it a link, but \n1. I want Minify to stay as portable as possible for shared hosting users. \n2. Unless you're changing your JS files every few seconds, our server-side caching\nmakes the minification a small one-time cost.\n3. It's unknown if this extension has fixed Issue 74\n4. If rumors are true, Minify may have to abandon all use of JSMin due to Google Code\nlicensing restrictions. The relatively new JSMin+ is likely my second choice (if we\ndon't move the project).\nReported by mrclay.org on 2009-12-17 14:16:48\n- Status changed: WontFix\n- Labels added: Type-Enhancement\n- Labels removed: Type-Defect\n. Good idea. Thanks.\nReported by mrclay.org on 2009-12-22 20:00:15\n- Status changed: Accepted\n. This seems to be in (at least) 2.1.5!\nReported by elan.ruusamae on 2012-03-29 19:51:08\n. Thanks for catching these.\nReported by mrclay.org on 2012-03-29 20:13:24\n- Status changed: Verified\n. i mean \"those checks are in 2.1.5 release\", so you can close the ticket :)\nReported by elan.ruusamae on 2012-03-30 22:13:39\n. ok, nvm, it is closed, i mislooked it status \"verified\" as state\nReported by elan.ruusamae on 2012-03-30 22:14:19\n. You have a PHP (or server) setting causing all output to be encoded. Minify tries to\ndisable these, but it can't always do that. Check your PHP settings first.\nReported by mrclay.org on 2010-01-06 16:46:53\n- Status changed: NeedInfo\n. ```\nthe two phpini variables that are most likely causing it are:\nzlib.zlib.output_compression\nzlib.output_compression_level\nIt's mostly likely coming from lib.output_compression_level try setting it to -9:\nini_set('zlib.output_compression_level', '-9');\nAlso make sure zlib.output_compression is set to Off.\nHope that helps\n```\nReported by josh.pendergrass on 2010-04-06 23:34:50\n. Thanks Josh. I'm gonna go ahead and close this.\nReported by mrclay.org on 2010-04-07 00:04:31\n- Status changed: Invalid\n. ```\nA crude solution is already possible:\nhttp://code.google.com/p/minify/wiki/CustomSource#Example:_Content_from_a_URL\nBut something that would be resilient to remote errors is forthcoming, with usage\nlooking something like: (in groupsConfig.php)\n$src1 = new Minify_Source_Url(array(\n  'url' => 'http://3rdparty.com/file.js'\n  ,'contentPattern' => '@if this doesn\\'t match, use backup@'\n  ,'backupFile' => '/path/to/file_backup.js' \n  / many more options /\n));\nreturn array(\n  'js' => array('//js/file1.js', $src1, '//js/file3.js');\n);\n```\nReported by mrclay.org on 2010-01-30 21:20:18\n- Status changed: Started\n- Labels added: Type-Enhancement\n- Labels removed: Type-Defect\n. ```\nGreat! Looking forward for true integration with Minify. \n(Offtopic: Thank you for making this great script, I've reduced HTTP requests from\n16 \nto 2!)\n```\nReported by admin@mrmunk.dk on 2010-02-01 20:19:42\n. ```\nMinify has no \"no-store\" option. Also $min_allowDebugFlag is never passed into the\nserver. The 'debug' server option is set if and only if both the allow is set AND the\nGET var is present. See line 34:\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.3/min/index.php#34 \nI think you're either seeing that in your browser's request headers, or the response\nis being altered by your server for some reason (outside of PHP). Mail me a URL or\npost the Request/Response headers you get from Firebug's Net panel.\n```\nReported by mrclay.org on 2010-02-01 15:19:20\n- Status changed: NeedInfo\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. You were right, the headers were changed by our CDN. I'm sorry. Feel free to close\nthis ticket.\nReported by al-ex@nurfuerspam.de on 2010-02-01 19:03:32\n. Reported by mrclay.org on 2010-04-23 15:09:37\n- Status changed: Invalid\n. ```\nOpen up min/builder/_index.js to line 71:\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.3/min/builder/_index.js#71\nCHANGE:\nvar url = 'http://' + location.host + '/' \nTO:\nvar url = location.protocol + '//' + location.host + '/'\nDoes this fix?\n```\nReported by mrclay.org on 2010-02-01 19:04:24\n- Status changed: Accepted\n. BTW, if not, you should open up Firebug's Net tab and see why the requests are failing.\nReported by mrclay.org on 2010-02-01 19:05:25\n. it works for me now, thanks a lot!\nReported by alexlvjin on 2010-02-02 10:32:02\n. I can confirm that the fix works.\nReported by zero3@zero3.dk on 2013-03-01 13:32:52\n. Fixed on github, have not mirrored here yet\nhttps://github.com/mrclay/minify/commit/cb75a4fd30a11ebd7d445347b31a2ec2197cc713\nReported by mrclay.org on 2013-03-01 14:29:21\n- Status changed: Started\n- Labels added: Priority-High\n- Labels removed: Priority-Medium\n. @locationroura Seek help on the Minify google group.\nReported by mrclay.org on 2013-05-31 17:10:43\n. ```\nThis may not be due to the static, but rather the memory intensive design.\nhttp://crisp.tweakblogs.net/blog/1856/jsmin+-version-13.html#r_35237\nOnly workaround is raising PHP's memory limit...\n```\nReported by mrclay.org on 2010-02-03 20:16:51\n- Status changed: NeedInfo\n. No longer supporting JSMin+\n. Failed writes should probably go to Minify_Logger::log()\nReported by mrclay.org on 2010-02-24 15:45:44\n. Write/unlink errors are logged in 3.0. ```\nYes, that's a good idea, but \"near future\" is unknown. I just haven't had a lot of\ntime to work at home lately and the desired items to overhaul are piling up. I really\nneed to do some thinking and define the next milestone.\nI know the current Minify class will end up as Minify_Server. I've considered moving\nthe HTTP_ classes to a separate project, but then is it worth the maintenance headache...\n```\nReported by mrclay.org on 2010-02-05 00:38:00\n- Labels added: Type-Enhancement, Priority-High, Milestone-2.2\n- Labels removed: Type-Defect, Priority-Medium\n. That'd be really awesome.\nI think there was a ticket regarding proposal as a Zend Framework component, if\nyou'll do this you will have to deal with this anyway (since it will have a prefix\nlike Zend_Minify_).\nReported by stephan.wentz on 2010-02-11 00:45:20\n. And you're sure this is OK in IIS5/6?\nReported by mrclay.org on 2010-02-20 19:55:52\n- Status changed: Accepted\n. Yes, I'm sure that is OK in IIS5/6.\nReported by chihwen.yang on 2010-02-21 01:55:11\n. Reported by mrclay.org on 2010-02-22 14:40:54\n- Status changed: Started\n- Labels added: Release-2.1.3\n. In R411 and will be in next release.\nReported by mrclay.org on 2010-05-09 16:50:14\n- Status changed: Verified\n. ```\nYou're right that this is valid CSS content (it's a bug in our URL matching), but\nURLs should always have \"(\", \")\", and several other chars encoded as they were\ndeclared \"unsafe\": http://tools.ietf.org/html/rfc1738#page-3\nHence, I'm leaning on \"WontFix\"-ing this unless the fix would be simple. This line\ncaptures the url(...) bit:\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.3/min/lib/Minify/CSS/UriRewriter.php#79\nBut passes the inside bit (possibly containing quotes) here:\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.3/min/lib/Minify/CSS/UriRewriter.php#143\n```\nReported by mrclay.org on 2010-02-20 19:39:07\n- Status changed: Accepted\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. FYI: Oops RFC1738 doesn't say parenthesis are unsafe in URLs, in fact they're \n\"special\".\nReported by mrclay.org on 2010-05-10 07:48:31\n. I don't see an easy fix for this\n. ```\nYou can instead rely on an undocumented feature that applies a function after\nminification. In config.php:\nfunction postMin($content, $type) {\n    return ($type === 'text/css')\n       ? preg_replace('/@import.*?;/', '', $content)\n       : $content;\n}\n$min_serveOptions['postprocessor'] = 'postMin';\nI'll mention this in the wiki.\n```\nReported by mrclay.org on 2010-03-25 13:24:18\n- Labels added: Type-Enhancement, Priority-Low, Component-Docs\n- Labels removed: Type-Defect, Priority-Medium\n. Added in R402\nReported by mrclay.org on 2010-03-25 13:50:36\n- Status changed: Verified\n. ```\nThe cache system can already cache binary content. All the logic in your attached\nfile could be placed in a custom Minify_Controller. The controller would validate the\nrequest (which extensions are allowed), find the files, and register minifiers by\nMIME type. Then you'd make a minifier that would, e.g., return the bytes of a\nthumbnail image.\nMinify doesn't send a Content-Transfer-Encoding header, but I doubt this is\nnecessary. For images you'd be wise to disable encoding since gzip would just add\nprocessing overhead for the client.\nSuch a controller/minifier combo would be a neat API demo, but I don't have the time\nto take this on, and it shouldn't be in the default min application.\n```\nReported by mrclay.org on 2010-03-26 14:33:35\n- Status changed: WontFix\n- Labels added: Type-Enhancement\n- Labels removed: Type-Defect\n. ```\nDid you enable the FirePHP logging to make sure the 400 is due to too many files?\nhttp://code.google.com/p/minify/wiki/Debugging\nThe option is merged in here:\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.3/min/lib/Minify/\nController/MinApp.php#26\nYou might just insert a die($cOptions['maxFiles']) after that to see that the option\nis being merged correctly.\n```\nReported by mrclay.org on 2010-04-02 02:52:24\n- Status changed: NeedInfo\n. I think I'm just going to remove this feature in future releases.\nReported by mrclay.org on 2010-04-22 17:30:33\n- Status changed: Accepted\n. Removed in R411\nReported by mrclay.org on 2010-05-09 16:48:57\n- Status changed: Fixed\n. Nice! Thanks.\nReported by mrclay.org on 2010-04-02 02:56:45\n- Status changed: Fixed\n- Labels added: Type-Enhancement\n- Labels removed: Type-Defect\n. ```\nMinify version: 2.1.3\nPHP version: 5.2.12\nWhat steps will reproduce the problem?\n\nSave the above script in \"min/lib/Minify/Cache\".\nAdd the following snipped to \"min/config.php\".\n\nrequire 'lib/Minify/Cache/ZendPlatform.php';\n$min_cachePath = new Minify_Cache_ZendPlatform();\n\nOpen \"min_unit_tests/test_all.php\" in browser.\n\nActual output:\n\"Catchable fatal error:  Object of class Minify_Cache_ZendPlatform could not be converted\nto string in [...]min_unit_tests/test_Minify_Cache_File.php on line 16\"\n```\nReported by webmaster%jjafu.org@gtempaccount.com on 2010-07-11 17:56:48\n. ```\ntest_Minify_Cache_File.php (unwisely) assumes config.php is set up for the File cache.\nSo, TODO in the 2.1.4 branch:\n\nadd ZendPlatform.php\ncreate test_Minify_Cache_ZendPlatform.php (based on http://code.google.com/p/minify/source/browse/branches/2.1.4/min_unit_tests/test_Minify_Cache_APC.php\n)\nfix test_Minify_Cache_File to not depend on config.php\n```\n\nReported by mrclay.org on 2010-07-11 23:03:32\n- Status changed: Started\n- Labels added: Release-2.1.3\n. Integrated in R420\nReported by mrclay.org on 2010-07-25 05:16:08\n- Status changed: Fixed\n. ```\nIs there a pre-minified (with YUICompressor) version you could use? The JSMin \nalgorithm chokes on this syntax and there's not a whole lot we can do about it. The\nsyntax is valid, but doesn't pass JSLint. +(++d) should work.\n```\nReported by mrclay.org on 2010-04-04 06:25:08\n- Status changed: Accepted\n. Reported by mrclay.org on 2010-05-08 19:36:43\n- Status changed: Duplicate\n- Merged into: #144\n. ```\n// As soon as I added more than 10 files the minify \nprocess failed but without a understandable notice of what has failed //\nI'm having the same problem. I can't add more than 10 files. It's says something like\nbad request ...\nError message :\nHTTP/1.0 400 Bad Request\nWhat is it supposed to mean? Can't we combine more than 10 files?\nRegards,\nKathees\n```\nReported by katheeskumar on 2010-04-22 06:34:18\n. ```\nGot it guys! In the config.php (Inside your minify folder) you can find following line\n$min_serveOptions['minApp']['maxFiles'] = 10;\nThis shows maximum number of files. If you want to use more than that all you have\nto\ndo is increase the number.\nI'm very new to minify. Just trying use it in our application. So don't know we will\nencounter any performance or whatever issues if we do that. May be someone can point\nout???\n```\nReported by katheeskumar on 2010-04-22 06:39:36\n. ```\nI already mentioned the maxFiles variable in my post. But I don't see any need of \nsuch a function. It only leads to a failure if you doesn't know about it. And the \nerror file doesn't contain any useful information about the error, so you cannot \nfind out what was going wrong.\nThe bigger issue is the one I mentioned first. If a file is missing you want to \ngroup, the whole group will fail which will in the worst case results in zero JS \nand zero CSS on your page. That really is a big issue for me because it is very \nlikely, that a file might be missing or missspelled or renamed.\n@katheeskumar: We could improve the load speed and overall performance a lot using\nthe group funtionality. And as Google takes the speed of a website in consideration\nwhen calculating the ranking, you should really give it a try. It is very easy to \nintegrate (if use r.g. use the simple query style links) and it saves a lot of \ntraffic and HTTP requests.\n```\nReported by bernhardkau on 2010-04-22 10:23:35\n. ```\nI'll remove maxFiles in the next release (not real soon).\nFor missing files, what I could do is prepend the output with:\n/ ATTENTION: Minify could not find /path/to/file1.js /\n/ ATTENTION: Minify could not find /path/to/file2.js /\nIn detail, missing files would cause 1 Minify_Source object to be the first source.\nIt would always have the same ID (to prevent poisoning the cache with lots of bad\nURLs) and have the message about as its content.\n@bernhardkau: I wouldn't put too much fail in Groups being tremendously faster. PHP\ncertainly does less work (and w/ cleaner URLs), but I've never ABed the performance\ndifference.\n```\nReported by mrclay.org on 2010-04-22 17:50:36\n- Status changed: Accepted\n. 2.1.4 beta has this feature. http://code.google.com/p/minify/downloads/detail?name=minify_2.1.4_beta.zip\nReported by mrclay.org on 2010-07-08 04:56:54\n- Status changed: Fixed\n- Labels added: Release-2.1.3\n. ```\nHi all,\nThanks for the beta fix - it is a much better approach just reporting the missing files.\n In my case for instance, when I upload a quick fix to our site during the upload process\nsomebody may be making the request for the file at the same time, and it's better to\nsee a slightly broken page rather than a completely useless page.\nMore importantly, I noticed that this fix only applies to individual files - it still\nfailes completely if a group contains missing files?\nin my groupsConfig.php:\narray( 'js_puntersparadise' => array('//js/jquery-1.3.2.min.js','//js/missingfile.js'));\n400 Bad Request\nPlease see http://code.google.com/p/minify/wiki/Debugging.\nPlease help!\n```\nReported by Luc.Pettett on 2010-07-26 00:07:47\n. @Luc, I should be able to apply the fix to group files as well.\nReported by mrclay.org on 2010-07-26 01:28:12\n- Status changed: Started\n. Thank-you!  I've been going through the code but can't seem to find out how to fix it.\n Line 83 of Groups.php seems to be where it was already applied, but for some reason\nit doesn't work?\nReported by Luc.Pettett on 2010-07-26 02:01:18\n. The controller is http://code.google.com/p/minify/source/browse/branches/2.1.4/min/lib/Minify/Controller/MinApp.php\nLine 139 has the check in the f= option. I need similar code at line 72.\nReported by mrclay.org on 2010-07-26 02:09:08\n. Thank-you!  It worked for me.  I'm pretty sure i've done a really dodgie hack because\nI have no idea what I'm doing, but it works now.  Attached is the new file.\nReported by Luc.Pettett on 2010-07-26 02:36:17\n\n- Attachment: MinApp.php\n. In git master c8e903e\nReported by mrclay.org on 2011-09-04 01:11:40\n- Status changed: Fixed\n. See commit 2f11b725b\nReported by mrclay.org on 2011-09-04 00:21:49\n- Status changed: Verified\n. ```\nPlease reinstall Minify, or at least HTML.php. There are no syntax errors in the 2.1.3\nrelease. It should match this:\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.3/min/lib/Minify/\nHTML.php\n```\nReported by mrclay.org on 2010-04-17 20:07:06\n- Status changed: NeedInfo\n. Reported by mrclay.org on 2010-05-08 19:30:00\n- Status changed: Invalid\n. Sorry, I searched in open issues only. This issue seems to be \"invalid\".\nReported by mburger313 on 2010-04-18 09:04:36\n. There's a bit about this in the wiki: http://code.google.com/p/minify/wiki/\nCommonProblems#Character_Encodings\nReported by mrclay.org on 2010-04-18 22:47:21\n- Status changed: Duplicate\n- Merged into: #106\n. Fixed, thanks!\nReported by mrclay.org on 2010-04-23 11:38:33\n- Status changed: Verified\n. ```\nShort term solution is to not minify that file:\nhttp://code.google.com/p/minify/wiki/CustomSource#Example:_Specify_a_different_minifier_or_none_at_all\nDoes JSMin actually throw an exception or just mangle the output? Can you find where\nthe problem is?\n```\nReported by mrclay.org on 2010-05-04 16:49:17\n- Status changed: Accepted\n. ```\nResult code :\nErreur\u00a0: invalid increment operand\nFichier Source\u00a0: http://localhost/project/oktMin/?g=js_admin\nLigne\u00a0: 59, Colonne\u00a0: 66\nCode Source\u00a0:\nif(!a.id)a.id=\"dp\"+++this.uuid;var\n-------------------^\n```\nReported by forxer on 2010-05-05 07:20:41\n. ```\nThe solution is as follows.\nFind all occurences of \"+ ++\" inside the jquery-ui.min file and put () around the ++\npart.\nexample:\nOLD: \"ui-tabs-\"+ ++u\nNEW: \"ui-tabs-\"+ (++u)\nThis isn't a fix for why JSMin is breaking, but it does solve the issue. This ticket\nis related http://code.google.com/p/minify/issues/detail?id=144\n```\nReported by robert.shea.o on 2010-05-05 07:55:43\n. Reported by mrclay.org on 2010-05-08 19:36:58\n- Status changed: Duplicate\n- Merged into: #144\n. fix from issue 132 is done. based on that i have that effect\nReported by info@medic-world.de on 2010-05-06 10:45:17\n. ```\nYour summary and steps to reproduce say two different things. Is JSMin slower before\nor after the fix is applied? How much slower? How large is the input? Feel free to\nattach a zip of the input.\nIn most cases Minify can combine the js/css before minifying, but you should try \ndisabling this:\nhttp://code.google.com/p/minify/source/browse/tags/release_2.1.3/min/lib/\nMinify.php#443\nAlter line 443 of Minify.php so that the condition always fails:\nif (0 && Minify_Source::haveNoMinifyPrefs(self::$_controller->sources)) {\nDoes this offer an improvement?\n```\nReported by mrclay.org on 2010-05-06 11:24:26\n- Status changed: NeedInfo\n. ```\n\"..Is JSMin slower before or after the fix is applied..\" before this fix i got fast\nbut incomplete response js/css was cut off. any try result with different cuts.\nAfter that fix the response are always complete but took several minutes.\n(sorry) my minify version is 2.1.3\nyour fix : \"if (0 && Minify_Source::haveNoMinifyPrefs(self::$_controller->sources))\n{\" speed it up but never less 15 seconds.\nany idea? is it a matter of gzip?\n```\nReported by info@medic-world.de on 2010-05-06 13:35:13\n. The patch only changes a couple strlen calls so I don't see why it's crawling. You'd\nhave to insert benchmarking code to figure this out I'm afraid.\nReported by mrclay.org on 2010-05-06 13:52:08\n. ```\nour request looks like this:\n/min/?f=templates/bmgtest/javascript/jquery-1.3.2.min.js,templates/bmgtest/javascript/jquery.flash.js,templates/bmgtest/javascript/jquery.form.js,templates/bmgtest/javascript/jquery.history.js,templates/bmgtest/javascript/jquery.autocomplete.v1.2.js,templates/bmgtest/javascript/jquery.dependClass.js,templates/bmgtest/javascript/jquery.slider-min.js,templates/bmgtest/javascript/jquery.json-2.2.min.js,templates/bmgtest/javascript/search.v1.2.js,templates/bmgtest/javascript/jquery.scrollTo-1.4.2-min.js,templates/bmgtest/javascript/base64.js,templates/bmgtest/javascript/jquery.fancybox1.3.0.js,templates/bmgtest/javascript/jquery.mousewheel-3.0.2.js\ni know that a lot :-) (already set the max script count to 20). \n```\nReported by info@medic-world.de on 2010-05-06 13:53:27\n. \"...have to insert benchmarking code to figure this out I'm afraid.\" i'm not, can you\ngive me a hint where i should set breakpoints? i will keep you informed\nReported by info@medic-world.de on 2010-05-06 13:56:11\n. ```\nBest place I can imagine is before and after the calls to mb_strlen. So, in your\npatched JSMin.php, before/after this line:\n$this->inputLength = $is_mb_strlen ? mb_strlen($this->input, 'ASCII') :\nstrlen($this->input);\n```\nReported by mrclay.org on 2010-05-06 14:03:02\n. btw, sorry issue is only about js files. css works fine\nReported by info@medic-world.de on 2010-05-06 14:03:18\n. ```\nhere the min_unit_test/test_all.php output\nPASS: Minify : 304 response (1 of 1 tests run so far have passed)\nPASS: Minify : cache, and minifier classes aren't loaded for 304s (2 of 2 tests run\nso far have passed)\n!FAIL: Minify : JS and Expires (1 of 3 tests run so far have failed)\nPASS: Minify : Issue 73 (3 of 4 tests run so far have passed)\nPASS: Minify : Issue 89 : bubbleCssImports (4 of 5 tests run so far have passed)\nPASS: Minify : Issue 89 : detect invalid imports (5 of 6 tests run so far have passed)\nPASS: Minify : Issue 89 : don't warn about valid imports (6 of 7 tests run so far\nhave passed)\nPASS: Minify : CSS and Etag/Last-Modified (7 of 8 tests run so far have passed)\nPASS: Minify_Build : single file path (8 of 9 tests run so far have passed)\nPASS: Minify_Build : multiple file paths (9 of 10 tests run so far have passed)\nPASS: Minify_Build : file path and a Minify_Source (10 of 11 tests run so far have\npassed)\nPASS: Minify_Build : uri() with no querystring (11 of 12 tests run so far have passed)\nPASS: Minify_Build : uri() with existing querystring (12 of 13 tests run so far have\npassed)\nPASS: Minify_Cache_APC : store (13 of 14 tests run so far have passed)\nPASS: Minify_Cache_APC : getSize (14 of 15 tests run so far have passed)\nPASS: Minify_Cache_APC : isValid (15 of 16 tests run so far have passed)\nPASS: Minify_Cache_APC : display (16 of 17 tests run so far have passed)\nPASS: Minify_Cache_APC : fetch (17 of 18 tests run so far have passed)\nNOTE: Minify_Cache_File : path is set to: '/tmp'.\nPASS: Minify_Cache_File : store (18 of 19 tests run so far have passed)\nPASS: Minify_Cache_File : getSize (19 of 20 tests run so far have passed)\nPASS: Minify_Cache_File : isValid (20 of 21 tests run so far have passed)\nPASS: Minify_Cache_File : display (21 of 22 tests run so far have passed)\nPASS: Minify_Cache_File : fetch (22 of 23 tests run so far have passed)\nPASS: Minify_Cache_File : store w/ lock (23 of 24 tests run so far have passed)\nPASS: Minify_Cache_File : getSize (24 of 25 tests run so far have passed)\nPASS: Minify_Cache_File : isValid (25 of 26 tests run so far have passed)\nPASS: Minify_Cache_File : display w/ lock (26 of 27 tests run so far have passed)\nPASS: Minify_Cache_File : fetch w/ lock (27 of 28 tests run so far have passed)\nPASS: Minify_Cache_Memcache : store (28 of 29 tests run so far have passed)\nPASS: Minify_Cache_Memcache : getSize (29 of 30 tests run so far have passed)\nPASS: Minify_Cache_Memcache : isValid (30 of 31 tests run so far have passed)\nPASS: Minify_Cache_Memcache : display (31 of 32 tests run so far have passed)\nPASS: Minify_Cache_Memcache : fetch (32 of 33 tests run so far have passed)\nPASS: Minify_CSS : subsilver (33 of 34 tests run so far have passed)\nPASS: Minify_CSS : comments (34 of 35 tests run so far have passed)\nPASS: Minify_CSS : unusual_strings (35 of 36 tests run so far have passed)\nPASS: Minify_CSS : issue62 (36 of 37 tests run so far have passed)\nPASS: Minify_CSS : selectors (37 of 38 tests run so far have passed)\nPASS: Minify_CSS : paths_rewrite (38 of 39 tests run so far have passed)\nPASS: Minify_CSS : hacks (39 of 40 tests run so far have passed)\nPASS: Minify_CSS : vladmirated (40 of 41 tests run so far have passed)\nPASS: Minify_CSS : paths_prepend (41 of 42 tests run so far have passed)\nPASS: Minify_CSS : styles (42 of 43 tests run so far have passed)\nPASS: Minify_CSS_UriRewriter (43 of 44 tests run so far have passed)\nPASS: Minify_CSS_UriRewriter : Issue 99 (44 of 45 tests run so far have passed)\nPASS: Minify_CommentPreserver (45 of 46 tests run so far have passed)\nPASS: Minify_CommentPreserver (46 of 47 tests run so far have passed)\nPASS: Minify_CommentPreserver (47 of 48 tests run so far have passed)\nPASS: Minify_CommentPreserver (48 of 49 tests run so far have passed)\n\nStrict Standards:  mb_strpos() [function.mb-strpos]: It is not safe to rely on the\nsystem's timezone settings. Please use the date.timezone setting, the TZ environment\nvariable or the date_default_timezone_set() function. In case you used any of those\nmethods and you are still getting this warning, you most likely misspelled the\ntimezone identifier. We selected 'Europe/Berlin' for 'CEST/2.0/DST' instead in\n/home/www/httpd/xtcReuter-Dev/htdocs/min/lib/JSMin.php on line 113\n\nWarning:  mb_strpos() [function.mb-strpos]:\nEmpty delimiter in /home/www/httpd/xtcReuter-Dev/htdocs/min/lib/JSMin.php on\nline 113\nPASS: Minify_HTML (49 of 50 tests run so far have passed)\n\nStrict Standards:  mb_strpos() [function.mb-strpos]: It is not safe to rely on the\nsystem's timezone settings. Please use the date.timezone setting, the TZ environment\nvariable or the date_default_timezone_set() function. In case you used any of those\nmethods and you are still getting this warning, you most likely misspelled the\ntimezone identifier. We selected 'Europe/Berlin' for 'CEST/2.0/DST' instead in\n/home/www/httpd/xtcReuter-Dev/htdocs/min/lib/JSMin.php on line 113\n\nWarning:  mb_strpos() [function.mb-strpos]:\nEmpty delimiter in /home/www/httpd/xtcReuter-Dev/htdocs/min/lib/JSMin.php on\nline 113\n\nStrict Standards:  mb_strpos() [function.mb-strpos]: It is not safe to rely on the\nsystem's timezone settings. Please use the date.timezone setting, the TZ environment\nvariable or the date_default_timezone_set() function. In case you used any of those\nmethods and you are still getting this warning, you most likely misspelled the\ntimezone identifier. We selected 'Europe/Berlin' for 'CEST/2.0/DST' instead in\n/home/www/httpd/xtcReuter-Dev/htdocs/min/lib/JSMin.php on line 113\n\nWarning:  mb_strpos() [function.mb-strpos]:\nEmpty delimiter in /home/www/httpd/xtcReuter-Dev/htdocs/min/lib/JSMin.php on\nline 113\nPASS: Minify_HTML (50 of 51 tests run so far have passed)\nPASS: ImportProcessor (51 of 52 tests run so far have passed)\nPASS: ImportProcessor : included right files in right order (52 of 53 tests run so\nfar have passed)\n!FAIL: Minify_Lines (2 of 54 tests run so far have failed)\nPASS: HTTP_Encoder : recognize \"x-gzip\" as gzip (53 of 55 tests run so far have passed)\nPASS: HTTP_Encoder : gzip w/ non-zero q (54 of 56 tests run so far have passed)\nPASS: HTTP_Encoder : gzip w/ zero q (55 of 57 tests run so far have passed)\nPASS: HTTP_Encoder : IE6 w/o \"enhanced security\" (56 of 58 tests run so far have passed)\nPASS: HTTP_Encoder : IE6 w/ \"enhanced security\" (57 of 59 tests run so far have passed)\nPASS: HTTP_Encoder : IE5.5 (58 of 60 tests run so far have passed)\nPASS: HTTP_Encoder : Opera identifying as IE6 (59 of 61 tests run so far have passed)\nPASS: HTTP_Encoder : IE6 w/ \"enhanced security\" (60 of 62 tests run so far have passed)\nPASS: HTTP_Encoder : deflate : uncompress possible (61 of 63 tests run so far have\npassed)\n!FAIL: HTTP_Encoder : deflate : compressed to 20.59% of original (3 of 64 tests run\nso far have failed)\n!FAIL: HTTP_Encoder : gzip : uncompress possible (4 of 65 tests run so far have failed)\n!FAIL: HTTP_Encoder : gzip : compressed to 20.60% of original (5 of 66 tests run so\nfar have failed)\nPASS: HTTP_Encoder : compress : uncompress possible (62 of 67 tests run so far have\npassed)\n!FAIL: HTTP_Encoder : compress : compressed to 20.71% of original (6 of 68 tests run\nso far have failed)\nPASS: HTTP_Encoder : Vary always sent (63 of 69 tests run so far have passed)\nPASS: HTTP_ConditionalGet : client has valid If-Modified-Since (64 of 70 tests run\nso\nfar have passed)\nPASS: HTTP_ConditionalGet : client has valid If-Modified-Since with trailing\nsemicolon (65 of 71 tests run so far have passed)\nPASS: HTTP_ConditionalGet : client has valid ETag (non-encoded version) (66 of 72\ntests run so far have passed)\nPASS: HTTP_ConditionalGet : client has valid ETag (gzip version) (67 of 73 tests run\nso far have passed)\nPASS: HTTP_ConditionalGet : no conditional get (68 of 74 tests run so far have passed)\nPASS: HTTP_ConditionalGet : client has invalid ETag (69 of 75 tests run so far have\npassed)\nPASS: HTTP_ConditionalGet : client has invalid If-Modified-Since (70 of 76 tests run\nso far have passed)\nPASS: JSMin : Overall (71 of 77 tests run so far have passed)\n\nStrict Standards:  mb_strpos() [function.mb-strpos]: It is not safe to rely on the\nsystem's timezone settings. Please use the date.timezone setting, the TZ environment\nvariable or the date_default_timezone_set() function. In case you used any of those\nmethods and you are still getting this warning, you most likely misspelled the\ntimezone identifier. We selected 'Europe/Berlin' for 'CEST/2.0/DST' instead in\n/home/www/httpd/xtcReuter-Dev/htdocs/min/lib/JSMin.php on line 113\n\nWarning:  mb_strpos() [function.mb-strpos]:\nEmpty delimiter in /home/www/httpd/xtcReuter-Dev/htdocs/min/lib/JSMin.php on\nline 113\nPASS: JSMin : Quotes in RegExp literals (Issue 74) (72 of 78 tests run so far have\npassed)\nPASS: environment : DOCUMENT_ROOT should not end in trailing slash (73 of 79 tests\nrun so far have passed)\nPASS: environment : DOCUMENT_ROOT should pass realpath() (74 of 80 tests run so far\nhave passed)\nPASS: environment : DOCUMENT_ROOT should contain this test file (75 of 81 tests run\nso far have passed)\n!FAIL: environment : PHP/server does not auto-HTTP-encode content (7 of 82 tests run\nso far have failed)\n```\nReported by info@medic-world.de on 2010-05-10 11:02:55\n. it seems like it is a matter of gzencode\nReported by info@medic-world.de on 2010-05-10 14:06:03\n. ```\nTry placing mb_internal_encoding('8bit'); in min/config.php. In theory that should\nmake the overloaded functions behave just like the regular ones.\nThe test_HTTP_Encoder.php file has a PHP gzdecode function which makes tons of\nstring function calls.\n```\nReported by mrclay.org on 2010-05-10 14:35:06\n. ```\nyes, thats what it seems like. the problems had just start with activating\nmbstring.func_overload. We have had set gzip already without problems before. When\ni\ndisable\nMinify.php\n281\n//                if (function_exists('gzencode')) {\n//                    self::$_cache->store($cacheId . '.gz', gzencode($content,\nself::$_options['encodeLevel']));\n//                }\nit works fine. otherwise the non zipped cache file is cutted off.\n```\nReported by info@medic-world.de on 2010-05-11 06:52:53\n. ```\nYou might try this for kicks in min/config.php:\n$min_serveOptions['encodeOutput'] = false;\nob_start(\"ob_gzhandler\");\nYou might have to comment out the line in Minify that sets Content-Length since it\nwill be wrong a lot of times.\n```\nReported by mrclay.org on 2010-05-12 00:43:14\n. ```\ncomment out the content length work.\nBut i wont this solution, i think i did a mistake.\n- we had convertet ALL files even css and js to UTF8\n- we had activate function overload in the zend-server and defined UTF8\n- we just had copy&paste the changes from issue 132\n    this solution made a check if funtion overload is active ore not and user strlen\nor mb_strlen($content, 'ASCII'). I think this not needed because the server have do\ndecide if he use multibyte funtions or not. And if i set it manualy with 'ASCII' it\nwill make no sence in our case. \nas i had reported, excluding the gzencode will work, so i have to find out whats up\nthere.\ni even thougt about Minify.php self::$_options['contentTypeCharset'] its defined in\nBase.php as UTF-8. does minify convert js and css to UTF8 if userfile stored as ASCII?\n```\nReported by info@medic-world.de on 2010-05-19 07:37:38\n. ```\nhttp://code.google.com/p/minify/source/browse/branches/2.1.4/ has a lot of work done\nin this area. Everything is now well-tested under mbstring.func_overload, but I don't\nknow if it's gonna help w/ gzencode.\nBTW, mb_internal_encoding('8bit') before any string code seems to be the key\nsolution. It's faster than ASCII, too.\nAs for contentTypeCharset, this just determines what charset is sent in the header.\nMinify does no conversion, but, yes, ASCII is UTF-8, so it converts it by labeling\nit :)\n```\nReported by mrclay.org on 2010-05-19 13:14:37\n. i have tried 2.1.4 and it seems like i missunderstood the problem, looks like there\nwas no issue about gzencode. 2.1.4 works like a charm. i love minify, thanks a lot!\nReported by info@medic-world.de on 2010-05-21 07:16:59\n. ```\nYou're double-escaping the ampersand.\nThis is the (perfectly valid) URL you want:\n  http://mrclay.org/min/g=js&1273622062\nThis is the same URL escaped for HTML: \n  \nThe browser converts \"&\" to \"&\" during parsing, hence, the browser requests the \n\"right\" URL and the original code matches fine.\n```\nReported by mrclay.org on 2010-05-12 04:57:36\n- Status changed: Invalid\n. Try the FirePHP error logging\nhttp://code.google.com/p/minify/wiki/Debugging\nReported by mrclay.org on 2010-05-17 01:30:07\n- Status changed: NeedInfo\n. ```\nHi,\nThx for your reply.\nMy problem doesn't occur in Firefox therefore I'm not sure it will help. The only warning\nI get is when \nlaunching the builder, it's saying \"Warning: It appears output is being automatically\ncompressed, interfering \nwith Minify's own compression. The option \"zlib.output_compression\" is disabled in\nyour PHP configuration so \nthis behavior is likely due to a server option.\" \nOn the mean time, I got an answer from MT support. It seems to be a well-known Safari\n(not Webkit) bug \nsince 4.0 regarding how it handles caching and output compression. Everything is explained\nhere but that \ndidn't help me very much.\nhttps://bugs.webkit.org/show_bug.cgi?id=25786\nBut as I said, everything is working fine in Safari on my local MAMP. Any clue about\nwhich Apache or PHP \nsetting could fix that?\nThanks!\n```\nReported by gregouniasse on 2010-05-17 04:52:28\n. ```\nIf the compression is coming from Apache's DEFLATE filter, you could try \nthis .htaccess from 2.1.4\nhttp://code.google.com/p/minify/source/browse/branches/2.1.4/min/.htaccess\nIf it's caused by zlib.output_compression, you can try to turn that Off via .htaccess\nor in a php.ini in the \"min\" directory.\n```\nReported by mrclay.org on 2010-05-17 05:26:32\n. ```\nThanks a million time!\nzlib.output_compression was already turned off but adding \"SetEnv no-gzip\" did the\ntrick!\nBest,\nG\n```\nReported by gregouniasse on 2010-05-17 05:37:43\n. Great. Fixed in R412\nReported by mrclay.org on 2010-05-17 11:21:14\n- Status changed: Verified\n- Labels added: Release-2.1.3\n. ```\nReplace /min/lib/Minify/CSS/Compressor.php with this new version:\nhttp://code.google.com/p/minify/source/browse/branches/2.1.4/min/lib/Minify/CSS/Compressor.php\nWith it I get this valid output:\n\nhtml\ninput.checkbox{margin:-1px -2px}\n\nIf this doesn't help, could you attach the whole problem file or whittle it down to\nthe smallest case where the error occurs?\n```\nReported by mrclay.org on 2010-05-22 14:45:51\n- Status changed: Started\n- Labels added: Release-2.1.3\n. Sorry, all i'm using from your package is the\nhttp://code.google.com/p/minify/source/browse/trunk/min/lib/JSMin.php file itself\nwith a constructor and then min() call.\nIs this something wrong with this approach?\nAll i want is to have the file minified after all.\nReported by joe7joe7 on 2010-05-22 15:51:07\n. ugh, me being a noob here i guess, is that for JS only? ;>\nReported by joe7joe7 on 2010-05-22 15:57:02\n. Yes :) You want Minify_CSS_Compressor for CSS. I've seen at least one framework\ntrying to use JSMin for CSS (with very buggy results) so you're not the first.\nReported by mrclay.org on 2010-05-22 16:46:36\n- Status changed: Invalid\n- Labels removed: Release-2.1.3\n. Gotcha, thanks for the heads up & sorry for being noob ;>\nTicket is invalid indeed\nReported by joe7joe7 on 2010-05-22 17:46:07\n. The issue was that my host had set the include_path using php_admin_value in the\nvhost.conf above my site directory so minify can't overwrite it.  I'm not sure how\ncommon that is, but it might be worth considering writing it differently so the lib\ndoesn't have to be added to the include_path - the other 6 applications I run on my\nsite don't have such a requirement.\nReported by patstix on 2010-06-07 12:29:21\n. The next major release :) For 2.1.4 maybe I can at least throw an error when the\ninclude_path fails to change.\nReported by mrclay.org on 2010-06-07 14:33:41\n- Status changed: Accepted\n- Labels added: Type-Enhancement, Release-2.1.3\n- Labels removed: Type-Defect\n. http://code.google.com/p/minify/downloads/detail?name=minify_2.1.4_beta.zip\nHas a check in the builder app for the failure of set_include_path(). That will have\nto do for 2.1.4.\nReported by mrclay.org on 2010-07-08 04:53:01\n. 1. Remove the changes in your HTML files (no hrefs/srcs should point to Minify URLs)\n2. Rename /min to something like /min.bak\n3. Test your site (make sure you didn't miss anything in step 1. If you did, rename\nit back to /min)\n4. Remove /min\n5. Remove the \"minify_\" files from your temp directory (usually /tmp on unix) if you\nfeel the need to\nReported by mrclay.org on 2010-06-28 17:36:49\n- Status changed: Started\n- Labels added: Type-Enhancement, Release-2.1.3\n- Labels removed: Type-Defect\n. Patched in R418. Thanks! How's the wrapper working for you?\nReported by mrclay.org on 2010-07-08 01:32:08\n- Status changed: Verified\n- Labels added: Release-2.1.3\n. Thanks patched.\nI use with yuicompressor-2.4.2.jar works fine!\nReported by milly.ca on 2010-07-08 07:40:19\n. R419\nReported by mrclay.org on 2010-07-08 04:26:17\n- Status changed: Verified\n- Labels added: Type-Enhancement, Priority-Low\n- Labels removed: Type-Defect, Priority-Medium\n. Fixed in R420 (ConditionalGet.php and Minify.php particularly)\nReported by mrclay.org on 2010-07-25 05:15:21\n- Status changed: Fixed\n. I can't help without knowing what CSS gets mangled.\nReported by mrclay.org on 2010-07-26 01:41:28\n- Status changed: NeedInfo\n. I had solved the same problem just in this moment. The problem was that one stylesheet\ncontained @media and @charset tags.\nReported by daniel.rotter on 2010-08-03 07:14:43\n. I can also confirm that removing the @charset fixed it on mine too.. Now to find why\ncombined  & minified javascript doesn't work!\nReported by leasingandcontracthire on 2010-09-09 11:00:41\n. ```\nMinify shouldn't be in the business of managing charsets, hence I'm inclined to have\nit strip all @charset declarations and assume the user is competent enough to manage\ngetting all files in UTF-8 or another encoding of their choice. If not UTF-8, they\ncan then change the charset header Minify sends on all requests:\n$min_serveOptions['contentTypeCharset'] = 'myEncoding';\n```\nReported by mrclay.org on 2010-09-09 15:52:37\n. Reported by mrclay.org on 2010-09-19 16:48:46\n. r423 strips all @charsets in Minify_CSS\nReported by mrclay.org on 2010-09-30 04:35:04\n- Status changed: Fixed\n- Labels added: Release-2.1.3\n. ```\njust to clarify the directory for the subdomain is: /var/www/vhosts/mysite.com/subdomains/apps/httpdocs/\nAnd for my site:\n/var/www/vhosts/mysite.com/httpdocs/\nI'm adding the following script to my index file:\nhttp://apps.mysite.com/min/g=js\nAnd in my groups config I have:\n'js' => array('http://apps.mysite.com/script/file1.js', 'http://apps.mysite.com/script/file2.js',\n'http://apps.mysite.com/script/file3.js')\nThanks\n```\nReported by colin.meinke on 2010-07-29 10:00:14\n. I'll reply on the support list:\nhttp://groups.google.com/group/minify\nReported by mrclay.org on 2010-07-29 14:17:51\n- Status changed: Invalid\n. ```\nI'll spare the list in this case. the values in groupsConfig.php must be file paths,\nnot URLs. You can use full paths like: '/var/www/vhosts/mysite.com/httpdocs/js/myFile.js'\nor use // to substitute the current docroot: '//js/myFile.js'\nIt's easiest to use Minify when the files are in the same docroot as Minify is running.\nYou should be able to do:\nhttp://apps.mysite.com/min/b=script&f=file1.js,file2.js\nor in groupsConfig.php:\nreturn array(\n  'js' => '//script/file1.js',\n  // etc.\n);\n```\nReported by mrclay.org on 2010-07-29 14:25:33\n. Perfect! Thankyou.\nReported by colin.meinke on 2010-07-29 15:31:16\n. Nice catch. I'll apply your patch soon. Otherwise is it working OK? I got some denials\nfrom too many requests while I was testing...\nReported by mrclay.org on 2010-08-04 19:48:16\n- Labels added: Release-2.1.3\n. ```\nAgainst an array of twelve files it seemed to run pretty well.\nMy application saves the resulting file and checks upon page request if the source\nfor that minified file has been updated. If that is the case, then it will make a request\njust for that file.\nThis will keep the requests low after the initial patch, this case 12.\nGreat library, makes life much easier.\n```\nReported by olavic on 2010-08-04 20:10:47\n. Fixed in R422\nReported by mrclay.org on 2010-08-06 15:11:20\n- Status changed: Fixed\n. This sounds like a YSlow bug. Try PageSpeed. If there are actual problems in browsers\nwe can reopen this.\nReported by mrclay.org on 2010-09-19 16:47:42\n- Status changed: Invalid\n. What's the URL you're using to call Minify and are you using custom code in groupsConfig.php?\nReported by mrclay.org on 2010-09-19 16:45:51\n- Status changed: NeedInfo\n- Labels added: Release-2.1.3\n. I call Minify inside PHP:\nMinify::serve('Files', $options = array( 'files'=>array('file1.js','file2.js') ));\nReported by rcmag01 on 2010-09-19 19:00:41\n. ...and cached in Memcache\nReported by rcmag01 on 2010-09-19 19:01:53\n. I got it. It's not defect of Minify. I looked in Minify::serve and found out, that all\nfiles are packed in one cache. So even if Minify checks the set of files, it will rebuilt\nit's cache for that set.\nIn attached file you can find my solution.\nI hope the option of separate cache will be built-in in future versions. :)\nReported by rcmag01 on 2010-09-19 21:29:09\n\n- Attachment: test.php\n. ```\nI see, you're optimizing based on knowing your common files will be the same for each\nuser. This would be a bit cleaner use of the API: http://pastebin.com/A06vw1Wh\nParticularly, letting Minify serve the content directly should improve performance\nbecause it caches the output of gzip, whereas Apache has to re-zip every request.\n```\nReported by mrclay.org on 2010-09-20 00:47:02\n- Status changed: Invalid\n. (How do I change the issue Type to \"Enhancement\"?)\nReported by jordi.salvat@salir.com on 2010-09-27 16:03:18\n. Awesome, can't wait to look into these.\nReported by mrclay.org on 2010-09-27 21:13:21\n- Status changed: Accepted\n- Labels added: Type-Enhancement, Release-2.1.3\n- Labels removed: Type-Defect\n. Committed in r423\nReported by mrclay.org on 2010-09-30 04:34:08\n- Status changed: Verified\n. in r423\nReported by mrclay.org on 2010-09-30 04:33:19\n- Status changed: Verified\n. Use 2.1.4 beta, then rename the packed version \"datepicker.min.js\" and Minify won't\ntry to compress it.\nReported by mrclay.org on 2010-09-30 19:06:43\n- Status changed: WontFix\n. ```\nWhat you're seeing is probably double-gzipped output. You likely have Apache/PHP setup\nto automatically encode output.\nTry version 2.1.4b, which should catch more encoding problems.\nThe error log message isn't caused by Minify. Looks like your MySQL PDO wrapper isn't\ninstalled correctly.\n```\nReported by mrclay.org on 2010-10-03 16:04:27\n- Status changed: NeedInfo\n. Reported by mrclay.org on 2011-09-04 01:12:00\n- Status changed: Invalid\n. Reported by mrclay.org on 2011-02-03 22:55:49\n- Labels added: Priority-Medium\n- Labels removed: Priority-High\n. We now have static file serving and proxy caching always available.. ```\nIt's best to keep the CDN libraries separate.\nThat said, you can pull content from URLs, but some PHP knowledge is necessary and\nthere's no error handling at this point: http://code.google.com/p/minify/wiki/CustomSource#Non-File_Sources\n```\nReported by mrclay.org on 2010-10-15 21:57:34\n- Status changed: WontFix\n. ```\nI take it when including CSS in this matter that includes and uls within the CSS will\nnot be re-written?\nThe use case is for a Zend View Helper HeadLink rewrite, to rewrite all the individual\nscript tags into one combined and minified one. I've already written one such implementation\nfor javascript at:\nhttp://github.com/balupton/balphp/blob/master/lib/Bal/View/Helper/HeadScriptBundler.php\nBut for it's CSS implementation I had to start evaluating other options when I discovered\nincludes and urls will have to be re-written.\n```\nReported by balupton on 2010-10-16 00:37:36\n. ```\nCorrect. Minify only does URI rewriting if the Minify_Source object has a non-empty\nfilename property. \nFYI the rewriting is done by this class:\nhttp://code.google.com/p/minify/source/browse/branches/2.1.4/min/lib/Minify/CSS/UriRewriter.php\n@includes would indeed be a problem.\n```\nReported by mrclay.org on 2010-10-16 00:53:22\n. ```\nThanks for the real quick reply :-)\nThat class is definitely a good start with what I would like to do. Hopefully I can\ncome up with a hybrid solution, thanks a whole bunch :-)\n```\nReported by balupton on 2010-10-16 01:03:59\n. ```\nSince the realpath() of each source file is checked to be inside a set of allowed directories,\nI suppose the prohibition of \"../\" is unnecessary (and my rationale for prohibiting\n\"./\" was flimsy, too).\nIt'll be removed!\n```\nReported by mrclay.org on 2010-10-22 18:25:28\n- Status changed: Accepted\n- Labels added: Priority-High, Release-2.1.3\n- Labels removed: Priority-Medium\n. Limitation removed in git master\nReported by mrclay.org on 2011-09-03 23:31:43\n- Status changed: Fixed\n. Which realpath call did you remove?\nReported by mrclay.org on 2010-10-22 18:14:49\n. ```\nHere you are. I don't know how this would affect people who are using the option to\npass an explicit list of symbolic links. But what makes me scratch my head is why you\nwould want to use that option when it would be better to just leave symbolic links\nunresolved so they continue to look just like the web path.\nIndex: lib/minify/Minify/CSS/UriRewriter.php\n--- lib/minify/Minify/CSS/UriRewriter.php       (revision 2480)\n+++ lib/minify/Minify/CSS/UriRewriter.php       (revision 2481)\n@@ -52,9 +52,13 @@         self::$_docRoot = self::_realpath(\n             $docRoot ? $docRoot : $_SERVER['DOCUMENT_ROOT']\n         );\n-        self::$_currentDir = self::_realpath($currentDir);\n+        // tom@punkave.com: the webserver does not resolve symlinks before resolving\n+        // relative paths, so we shouldn't either\n+        // self::$_currentDir = self::_realpath($currentDir);\n+        self::$_currentDir = $currentDir;\n```\nReported by tommybgoode on 2010-10-22 22:03:19\n. ```\nI think you're right. Just because we use realpath to determine file locations for security\npurposes doesn't mean we have to send resolved paths into the URI rewriter. We should\nsend in paths as they're given (in $_SERVER['DOCUMENT_ROOT']) and try resolving first\nagainst that and then secondly against realpath($_SERVER['DOCUMENT_ROOT']). In most\ncases one of those should work.\nThe $min_symlinks feature is occasionally useful in some weird configurations so it\nshould be left in.\nFYI, the realpath() calls were done to solve problems on IIS, where $_SERVER['DOCUMENT_ROOT']\nwas often not a real file path. e.g.:\nf:\\mywebsite  (realpath is c:\\server01\\sites\\mywebsite )\n```\nReported by mrclay.org on 2010-10-22 23:12:04\n- Status changed: Accepted\n- Labels added: Type-Enhancement, Priority-High, Release-2.1.3\n- Labels removed: Type-Defect, Priority-Medium\n. Reported by mrclay.org on 2011-02-03 22:56:30\n- Labels added: Priority-Medium\n- Labels removed: Priority-High\n. ```\nI know this issue is pretty old, but we use a lot of symlinks in our project and minify\nhas a hard time dealing with them.\nI ended up modifying the source code and replacing the calls to realpath with a function\nI wrote myself that basically does all of the ../.. directory resolution without following\nsymlinks.\nIt really simplified things for us and made it so that min_symlinks() wasn't even required\nfor us. Not sure if this would impact other usecases though.\nHere is the function if you wish.\nfunction realpath2($path) {\n   $parts = explode('/', str_replace('\\', '/', $path));\n   $result = array();\nforeach ($parts as $part) {\n      if (!$part || $part == '.')\n         continue;\n      if ($part == '..')\n         array_pop($result);\n      else\n         $result[] = $part;\n   }\n   $result = '/'.implode('/', $result);\n// Do a sanity check.\n   if (realpath($result) != realpath($path))\n      $result = realpath($path);\nreturn $result;\n}\n```\nReported by contact@toddburry.com on 2011-06-09 23:19:36\n. ```\n5, Yes, this is kind of the plan in comment 3: Reserve realpath for verifying the file's\nphysical location, but only remove traversals before handing the path to the URI rewriter.\nThanks.\n```\nReported by mrclay.org on 2011-06-10 00:48:49\n. if I missed a config setting please accept my apologies.\nReported by El.Nego on 2010-10-26 23:16:50\n. ```\nIf you set $min_documentRoot, it actually changes $_SERVER['DOCUMENT_ROOT'] to it. So\nit effectively does what you want, but in a confusing and poorly documented way. If\nI can easily make this clearer in the code for 2.1.4 I'll try, but 2.2 will change\na lot of this.\nTODO: Create a wiki page for all the config options. It's not sufficient to put all\nthat info only in the config.php file.\n```\nReported by mrclay.org on 2010-10-27 10:53:52\n- Labels added: Priority-High, Component-Docs\n- Labels removed: Priority-Medium\n. ```\nThanks a lot mrclay.org think I got it working like I wanted now :) \nMuch appreciated all your time and effort into this project\n```\nReported by El.Nego on 2010-10-28 15:34:31\n. ```\nThanks a lot mrclay.org think I got it working like I wanted now :) \nMuch appreciated all your time and effort into this project\n```\nReported by El.Nego on 2010-10-28 15:34:35\n. Thanks, guess I can't trust WP's info on length limitations\nhttp://en.wikipedia.org/wiki/Filename#Comparison_of_file_name_limitations\nReported by mrclay.org on 2010-10-28 16:20:00\n- Status changed: Accepted\n- Labels added: Priority-Critical\n- Labels removed: Priority-Medium\n. Fixed in git master\nReported by mrclay.org on 2011-09-03 23:22:33\n- Status changed: Fixed\n. ```\nNot the best solution.\nI have a long path to my /www dir (on windows).\nAnd that length limitation wasn't enough, maybe related to total path length.\nchanged to: \"100 - 34 - strlen($prefix)\"\n```\nReported by izikdd on 2012-12-14 14:52:12\n. ```\nIn other words (simplified): \nfind:    }*{} \nreplace: }\n```\nReported by cerieljacobs on 2010-11-03 01:37:48\n. ```\nSounds good to me. \nThis might be safe near the end of processing:\n$css = preg_replace('/}[^\\/}]+{}/', '}', $css);\nThat is, remove the selection only if the area between } and {:\n has no \"/\" (probably the start of a preserved comment)\n has no \"}\" (this could be near/in a media block)\nTODO:\nAdd tests to /min_unit_tests/_test_files/css/styles.css\nAdd expectation to /min_unit_tests/_test_files/css/styles.min.css\nAdd code at line 153 of /min/lib/Minify/CSS/Compressor.php#153\nFeel free to submit patches :)\n```\nReported by mrclay.org on 2010-11-03 14:50:21\n- Status changed: Accepted\n- Labels added: Type-Enhancement, Release-2.1.3\n- Labels removed: Type-Defect\n. Now on CSSmin\n. Did you turn on Firephp logging and verify it's an exception in JSMin?\nhttp://code.google.com/p/minify/wiki/Debugging#400_Bad_Request_errors\nReported by mrclay.org on 2010-11-11 12:42:51\n- Status changed: NeedInfo\n. ```\nHere's what I get from the logs in FirePHP:\nMinify: Exception in /var/www/min/XYZ.js: JSMin: Unterminated RegExp at byte 3705:\n/ (res * this.tileSize.w)); \nIt's not a major problem, obviously, as I can just modify the file to not have lines\nthat begin with a slash.\n```\nReported by mgl.gis on 2010-11-11 16:41:40\n. FWIW JSLint complains about it: \"Bad line breaking before '/'.\" but I don't if that's\ninfluenced by the spec or Crockford's preferences.\nReported by mrclay.org on 2010-11-11 18:16:39\n- Status changed: WontFix\n. Good catch, I'll look into this soon.\nReported by mrclay.org on 2010-11-14 19:11:18\n- Status changed: Accepted\n- Labels added: Priority-Critical\n- Labels removed: Priority-Medium\n. Is there any possibility you have your debug cookie set to match Aedit.Ajax.js ? When\nyou call the URL directly do you get minified output?\nReported by mrclay.org on 2010-11-14 22:03:25\n. ```\ndebug cookie? dont have set such thing.\ni get minified output, when entering following url:\nhttp://127.0.0.1/min/b=Aedit/js&f=jquery-1.4.3.js,jquery.history.js,jquery.form.js,jquery.selectboxes.min.js,jquery.validate.js,jquery.metadata.js,localization/messages_de.js,jquery.purr.js,jquery.effects.core.js,jquery.effects.highlight.js\nit just loads ~ 4s.\nhttp://127.0.0.1/min/b=Aedit/js&f=jquery-1.4.3.js,jquery.history.js,jquery.form.js,jquery.selectboxes.min.js,jquery.validate.js,jquery.metadata.js,localization/messages_de.js,jquery.purr.js,jquery.effects.core.js\nShows instantly.\nDoes this bug appear only on my side?\n```\nReported by Smikesix on 2010-11-14 23:05:26\n. Can you e-mail a zip of those files to steve@mrclay.org? I haven't tested, but I have\na feeling something is causing the cacheId to change every request.\nReported by mrclay.org on 2010-11-15 01:22:36\n. Just tested and can't reproduce this bug on Win XP with latest XAMPP (PHP 5.3.1/Apache\n2.2.14). I think you're going to need to walk through a request using remote debugging\n(xdebug) to figure out what's going on. I'm happy to help if you're willing to put\nthe effort into it. At the very least, watch your cache directory and see what happens\nas you make repeated requests.\nReported by mrclay.org on 2010-11-16 05:17:44\n- Status changed: NeedInfo\n- Labels added: Priority-Medium\n- Labels removed: Priority-Critical\n. Reported by mrclay.org on 2011-09-03 23:45:22\n- Status changed: Invalid\n. This is a feature you can disable if you wish.\nhttp://code.google.com/p/minify/wiki/UriRewriting\nReported by mrclay.org on 2010-11-15 15:25:29\n- Status changed: Invalid\n. ```\nI think this is a bug in Safari's console. Content-Type isn't required on 304 responses\n(Minify doesn't include it), but Safari seems to think it is.\nHeaders are sent correctly in 200 responses, too:\nhttp://redbot.org/?uri=http%3A%2F%2Fcrashplan.probackup.nl%2Fmin%2Fg%3Dcss%260\n```\nReported by mrclay.org on 2010-11-17 22:06:40\n- Status changed: Invalid\n. I think to get this working you'd need to place /min/ inside /var/www/public/site and\ninclude the code on the AlternateFileLayouts wiki page.\nReported by mrclay.org on 2010-12-01 16:54:27\n- Status changed: NeedInfo\n. in fact I don't use minify fully, I'm just using the CSS compressor and UriRewriter\nclass\nReported by myeshopfr on 2010-12-02 08:16:56\n. The rewriter can only produce root-relative URIs, so assuming the URI \"/images/bg_foot.jpg\"\nwould work for you, then you really need to pass in \"/var/www/public/site\" as your\ndocRoot.\nReported by mrclay.org on 2010-12-02 13:17:16\n. ```\nAhh, I thought families with white space MUST be quoted, but it's just \"should\":\nhttp://www.w3.org/TR/CSS2/fonts.html#propdef-font-family\nSince font-families are parsed separately shouldn't be too difficult to fix.\n```\nReported by mrclay.org on 2010-12-01 15:31:26\n- Status changed: Accepted\n- Labels added: Priority-High, Release-2.1.3\n- Labels removed: Priority-Medium\n. Fix in R438. Just replace CSS/Compressor.php\nReported by mrclay.org on 2010-12-20 14:44:50\n- Status changed: Fixed\n. Better fix in r457\nReported by mrclay.org on 2011-06-23 19:24:25\n. Oops! Thanks for catching that.\nReported by mrclay.org on 2010-12-06 14:23:14\n- Labels added: Priority-High, Release-2.1.3\n- Labels removed: Priority-Medium\n. Fix in R437\nReported by mrclay.org on 2010-12-19 21:13:31\n- Status changed: Fixed\n. Minify doesn't send anything different to different browsers. You can check the Debugging\nwiki page and try a post to the minify support group, but odds are you need Javascript\nhelp.\nReported by mrclay.org on 2010-12-11 20:44:24\n- Status changed: WontFix\n. Is the error only in IE8?\nReported by mrclay.org on 2010-12-10 12:09:48\n. My understanding is that you're on a host which injects advertising/tracking code into\nPHP responses. Minify cannot work reliably in this environment. Please open a new ticket\nwith more information if this is not the case.\nReported by mrclay.org on 2010-12-19 21:11:09\n- Status changed: Invalid\n. ```\nA simple solution would be for the user to prepend something like \"http://cdn.example.org/a/a/\"\nand then Minify to automatically remove parent traversals where possible.\n../../images/123.jpg => (prepend)\nhttp://cdn.example.org/a/a/../../images/123.jpg => (remove traversal)\nhttp://cdn.example.org/a/../images/123.jpg => (remove traversal)\nhttp://cdn.example.org/images/123.jpg\nThoughts?\n```\nReported by mrclay.org on 2010-12-14 04:27:35\n- Status changed: Accepted\n- Labels added: Type-Enhancement, Release-2.1.3\n- Labels removed: Type-Defect\n. ```\nThat would work, but it doesn't address the use case I had in mind.\nFor development, user creates CSS and assets with relative paths.\nFor deployment, minify is used to combine, compress and rewrite the CSS to appropriate\npaths. This case is exactly how it is used and works today.\nThe enhancement would be that I don't want to point at my production server (CSS-relative\npath), I want to point to an absolute path for assets.\n```\nReported by darpagc on 2010-12-15 19:11:12\n. ```\nIn config.php you would have code like:\nif (/ is production environment /) {\n  $min_serveOptions['rewriteCssUris'] = false;\n  $min_serveOptions['minifierOptions']['text/css']['prependRelativePath'] = 'http://cdn.example.org/a/a/';\n}\nThe result is that, on development Minify rewrites as normal, but on production the\nrewrited URLs point to the CDN (with \"/a/a/../../\" replaced with \"/\").\n```\nReported by mrclay.org on 2010-12-16 19:09:48\n. R436 adds \"../\" removal to prependRlativePath operations. Just replace UriRewriter.php\nfrom the new version. With my suggestion in comment 3 (branching config code per environment)\nyou should be able to get the desired behavior.\nReported by mrclay.org on 2010-12-19 21:07:54\n- Status changed: Fixed\n. Trunk is a mess and will probably be replaced by the 2.2 branch at some point. Current\nwork is being done on 2.1.4\nReported by mrclay.org on 2010-12-30 04:06:42\n- Status changed: WontFix\n. You must use a source object if your content is not a flat file. See:\nhttp://code.google.com/p/minify/wiki/CustomSource#Non-File_Sources\nPlease use the google group for support.\nReported by mrclay.org on 2011-01-05 15:11:44\n- Status changed: Invalid\n. ```\nThis could work fine with PEAR Log class, if the extra $ident wasn't there.\nrequire_once 'Log.php';\nrequire_once 'Minify/Logger.php';\n$log = Log::singleton('error_log', PEAR_LOG_TYPE_SYSTEM, 'minify');\nMinify_Logger::setLogger($log);\n\nit basically works, but throws warning to errorlog:\n2012-03-29 22:26:41: (mod_fastcgi.c.2699) FastCGI-stderr: PHP Notice:  Undefined index:\n Minify in /usr/share/pear/Log.php on line 591\nminify: A group configuration for \"f\" was not found\ni.e the $label Minify would be expected by pear logger as priority:\npublic static function log($msg, $label = 'Minify') {\n    if (! self::$_logger) return;\n    self::$_logger->log($msg, $label);\n}\n\n```\nReported by elan.ruusamae on 2012-03-29 19:31:49\n. ```\nsuch simple class could do it with Pear logger:\n/*\n * @author Elan Ruusam\u00e4e glen@delfi.ee\n/\nclass Logger {\n    private $logger;\npublic function __construct($ident) {\n    $this->logger = Log::singleton('error_log', PEAR_LOG_TYPE_SYSTEM, $ident);\n}\n\n/**\n * Pass a message to the logger (if set)\n *\n * @param string $msg message to log\n * @return null\n */\npublic function log($msg, $label = 'Minify') {\n    $this->logger->log($msg);\n}\n\n}\n$log = new Logger('Minify');\nMinify_Logger::setLogger($log);\n\n```\nReported by elan.ruusamae on 2012-03-29 19:40:00\n. The plan is to replace Minify_Logger with an interface, and pass the logger directly\ninto Minify::serve() and have it pass it on to the cache, etc. The aim is to remove\nall the statics eventually.\nReported by mrclay.org on 2012-03-29 20:12:54\n. Reported by mrclay.org on 2011-01-31 02:36:06\n- Status changed: Duplicate\n- Merged into: #62\n. Can you find at what point this is crashing (I can never reproduce it)? One/some of\nthe regexes appear to trigger a PHP/PCRE bug.\nReported by mrclay.org on 2011-01-31 02:39:12\n. ```\nThe list of filenames at the beginning of the cache filename is just to help users looking\nthrough their cache folder have an idea of what's in the file (the full length is limited).\nWhat you're probably running into is IE's URL length limit, which is pretty short.\nGenerally any list of this size should be put in the groupsConfig.php file so you can\njust use a URL like: /min/g=commonJs\n```\nReported by mrclay.org on 2011-02-02 18:15:42\n- Status changed: Invalid\n. ```\nThanks a lot for the feedback\nThe resources loaded on different parts of our system are dinamically allocated, I\ncouldnt use fixed group definitions, but managed to implement dynamic minify groups\nwith a little session control.\n```\nReported by rudibr on 2011-02-03 10:46:02\n. ```\nIt would be best for caching/performance if you could identify the common resources\nand place those in a static group. Putting everything in one combined request can be\nbad: changing one part of it means having to download the whole thing again, and the\nuser has to wait for all that processing (the first time at least) on the server.\nIf you need more help, ask on the Google Group.\n```\nReported by mrclay.org on 2011-02-03 12:49:42\n. See: http://code.google.com/p/minify/wiki/UriRewriting\nCan you give a concise use case where Minify is failing?\nReported by mrclay.org on 2011-02-11 13:50:21\n- Status changed: NeedInfo\n. ```\nThanks for your response.\nI this URL rewriting is failing , I checked the generated CSS file and it was not rewriting\nany URLS.\n```\nReported by retheeshnewagesmb on 2011-02-14 09:43:57\n. Please include details: what content should be--but is not--being rewritten, include\ncomments added by Debug Mode.\nReported by mrclay.org on 2011-02-14 22:58:06\n. ```\n/* Minify_CSS_UriRewriter::$debugText\ndocRoot    : /var/www/html/orgdyne\ncurrentDir : /var/www/html/orgdyne/templates/default/css\nfile-relative URI  : ../images/list_icon.jpg\npath prepended     : /var/www/html/orgdyne/templates/default/css/../images/list_icon.jpg\ndocroot stripped   : /templates/default/css/../images/list_icon.jpg\ntraversals removed : /templates/default/images/list_icon.jpg\nfile-relative URI  : ../images/site_bg.jpg\npath prepended     : /var/www/html/orgdyne/templates/default/css/../images/site_bg.jpg\ndocroot stripped   : /templates/default/css/../images/site_bg.jpg\ntraversals removed : /templates/default/images/site_bg.jpg\nAbove are some of debug text I ma getting. traversal removed field is showing the correct\npathe, yet it does not show the image. The issue is because path starts from \"/templates\",\nif we give the \"site_name/templates\" (Full path) from manual rewriting, it is working.\nHow to fix this issue?\n```\nReported by retheeshnewagesmb on 2011-02-16 07:43:50\n. you can see this wiki http://code.google.com/p/minify/wiki/AlternateFileLayouts.\nReported by wangchao20000 on 2011-03-02 03:14:43\n. I'm not convinced this is a bug. If this is still an issue, please bring it up on the\nGoogle Group.\nReported by mrclay.org on 2011-06-24 06:50:10\n- Status changed: Invalid\n. ```\nJSMin, not being a real parser, has a tough time distinguishing between division and\nthe beginning of a regexp literal, and after a line break the original algorithm has\nalways assumed that \"/\" would start a regexp. Maybe this assumption needs some testing?\nOpen http://code.google.com/p/minify/source/browse/branches/2.1.4/min/lib/JSMin.php\nand try changing this:\n    if (false !== strpos(\"\\n{;(,=:[!&|?\", $this->a)) { // we aren't dividing\n        return true;\n    }\n\nto:\n    if ($this->a === \"\\n\") {\n        return false; /* assume division */\n    }\n    if (false !== strpos(\"{;(,=:[!&|?\", $this->a)) { // we aren't dividing\n        return true;\n    }\n\nI'd need to see a lot of testing before I'd release such a change though.\n```\nReported by mrclay.org on 2011-02-21 03:23:31\n- Status changed: WontFix\n. Sorry, this probably won't be implemented anytime soon. It will add a ton of complexity\nto the system and I'd like to have a new frontend cache (like in Symfony2) in place\nfirst.\nReported by mrclay.org on 2011-03-02 16:19:58\n- Status changed: Duplicate\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n- Merged into: #50\n. hey steve\ni have attached how non-minified version is and what minification renders (w/o the\npatch)\nthanks\nReported by gobezu on 2011-03-04 16:19:10\n\n- Attachment: minify_2.1.4_beta_min_lib_minify_html_sample.txt\n. ```\nI don't see how Minify could break the entity in that case (but I'll try it as soon\nas I can).\nIs it possible you are passing in markup in a character encoding incompatible with\nUTF-8? Minify should be able to handle UTF-8 and most ISO8859-*.\n```\nReported by mrclay.org on 2011-03-04 18:53:32\n- Status changed: Accepted\n. ```\nSorry for my delay, or rather I was expecting to receive a notification whenever the\nissue was updated.\nAnyway, none utf-8 incompatible characters are passed. Without my plugin pages rendered\nwithout such mangled characters.\nAttached is a better version as my last take removed all spaces between tags and resulted\nin some oddities.\n```\nReported by gobezu on 2011-03-11 08:56:13\n\n- Attachment: minify_2.1.4_beta_min_lib_minify_html_ver2.txt\n. I cannot duplicate this bug. \"<p>\u00a0</p>\" is not altered in any way. Can you tell me more\nabout your system?\nReported by mrclay.org on 2011-06-23 22:01:35\n- Status changed: NeedInfo\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. ```\nThese spaces are not required in any spec I've seen and our output matches YUICompressor.\nPlease send a URL If you find this in a CSS spec or browser bug, or produce a test\npage if you've discovered a new browser bug.\n```\nReported by mrclay.org on 2011-03-09 15:41:57\n- Status changed: Invalid\n. What was that?\nReported by mrclay.org on 2011-03-10 17:26:51\n- Status changed: Invalid\n. Thanks! Can you be more specific? If you mean \"fixing\" markup sent through Minify_HTML,\nthat's a task better suited for something like Tidy or components made for that purpose.\nReported by mrclay.org on 2011-04-14 13:38:33\n- Status changed: NeedInfo\n. ```\nWhen running the W3C validation tool over my header markup, I receive markup errors\ndue to the stylesheet link href. Here is a sample:\n\nThis causes errors such as:\nError Line 21, Column 78: general entity \"f\" not defined and no default entity\nError Line 21, Column 79: reference to entity \"f\" for which no system identifier could\nbe generated\nWarning Line 38, Column 53: reference not terminated by REFC delimiter\n[...]\nThis is rather trivial, I was just curious whether you had a solution for this issue\n(if you can call it that). Due the the dynamic nature of the website, I cannot use\ngroups as it would pose too much of a hassle (site is large, has many sections, and\nas such, many section specific combinations of style sheets).\nI attempted a mod rewrite approach, but could not get it to work:\n-- CSS/JS Minifier W3C Validator fix\nRewriteBase /lib/min/\nRewriteRule ^b_uri/(.)/f_uri/(.)$ index.php?b=$1&f=$2 [L]\nthe link was modified to this:\n/lib/min/b_uri/style/f_uri/global/global_V1_20110412.css,index6.css,jquery.fancybox.css,widescreen3/fixedwidth5.css\nI would greatly appreciate any ideas.\n```\nReported by peter.p.schaefer on 2011-04-14 13:48:41\n. ```\nThe Builder (http://code.google.com/p/minify/wiki/BuilderApp ) actually outputs HTML\nthat's properly escaped. If you write your own markup, it's up to you to HTML escape\nentities like \"&\".\nI mention this in min/README:\nhttp://code.google.com/p/minify/source/browse/branches/2.1.4/min/README.txt#54\n```\nReported by mrclay.org on 2011-04-14 14:57:54\n- Status changed: Invalid\n. ```\nMr Clay,\nI came up with a hacky solution for this. Basically it tries to get group and version\ndata from a url like: /min/index.php/g/groupName/v/versionNumber\nThe URI fetching and filtering was based on Code Igniter's routing. Based on very limited\ntesting it works just fine. Of course there are a number other query strings that aren't\nsupported by that hack. But for me groups and versioning are enough for now. Anyway,\nif you're interested contact me. Best regards, Claudio\n```\nReported by claudioferreira on 2011-04-27 23:14:46\n. ```\nMinify already supports dropping the \"?\" from URLs on Apache w/ mod_rewrite. E.g.:\nhttp://www.mrclay.org/min/g=js\nhttp://www.mrclay.org/min/g=js&1234 (notice no \"?\")\nThe BuilderApp auto-detects the rewriting, too.\n```\nReported by mrclay.org on 2011-04-28 03:51:57\n- Status changed: Invalid\n. Seems like a straightforward change.\nReported by mrclay.org on 2011-05-12 04:40:57\n- Status changed: Accepted\n- Labels added: Release-2.1.3\n. This issue was closed by revision r459.\nReported by mrclay.org on 2011-06-23 20:28:28\n- Status changed: Fixed\n. fixed in r459. Please try the latest version on 2.1.4 if you can.\nReported by mrclay.org on 2011-06-23 20:29:30\n. ```\nIt will only return JS URLs on the same domain. What's an example URL that it missed\nthat Minify could actually serve? \nBTW, I like the site; I've skated on and off since about '87 and still follow it pretty\nclosely on the web at least.\n```\nReported by mrclay.org on 2011-05-16 18:31:12\n- Status changed: NeedInfo\n. ```\nWow, cool, that's a nice coincidence! Everything I do ties into skateboarding somehow.\n:D I love it.\nIt appears that minify won't recognize URLs like these: http://keepskatinbro.com/wp-content/plugins/nextgen-gallery/shutter/shutter-reloaded.css?ver=1.3.0\nThe simple fix would be to have minify strip the ?get content before doing anything\nelse with the URL.\n```\nReported by TruSktr on 2011-05-16 21:12:11\n. Agreed. Just curious, have you tried one of the WordPress plugins that integrate Minify?\nWP Minify, W3 Total Cache, etc? Those might give you some easier config options than\nusing Minify out-of-the-box, but I haven't tried them myself.\nReported by mrclay.org on 2011-05-16 22:33:51\n- Status changed: Accepted\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. Yeah, i've tried them. But they're just not as customizable as using minify out-of-the-box;\nsomething little thing always ends up breaking for me. I'll have better luck just removing\nall the scripts from wordpress, and placing them manually in the header or footer in\nthe exact order that I need them. Sometimes it also seems that the minify interface\nis easier to use than the plugin interfaces! Minify interface + pasting the url in\nthe theme manually seems to be the cleanest solution since I'm always inside the code\nanyways; the code is my GUI. :D\nReported by TruSktr on 2011-05-18 06:58:58\n. ```\n1 Using f= is not supported.\n2 To use Minify in a site not at the DocumentRoot, use the strategy at: http://code.google.com/p/minify/wiki/AlternateFileLayouts\n```\nReported by mrclay.org on 2011-05-17 14:49:54\n- Status changed: Invalid\n. Agreed.\nReported by mrclay.org on 2011-05-18 18:08:53\n- Status changed: Accepted\n. 2.1.4 branch already preserves the \"!\".\nReported by mrclay.org on 2011-06-23 19:40:33\n- Status changed: Invalid\n. Sorry, I was not aware that this was trunk specific. Was this functionality reverted\nfor a specific reason?\nReported by craigf@togetheragency.co.uk on 2011-07-04 09:54:06\n. The SVN trunk should be identical to the \"current\" release, 2.1.3. FYI the active branch\nof what will be 2.1.4 is now here: https://github.com/mrclay/minify\nReported by mrclay.org on 2011-07-05 15:52:54\n. Thanks. I don't recall why I did it like that in the first place.\nReported by mrclay.org on 2011-05-19 19:02:21\n- Status changed: Started\n. Fixed in r458\nReported by mrclay.org on 2011-06-23 19:38:36\n- Status changed: Verified\n. This sounds like a configuration problem, most likely PHP is not able to write to your\ncache directory. Please post more details about your config (especially if you're using\ncustom source objects in groupsConfig.php) in the Google Group.\nReported by mrclay.org on 2011-05-22 13:47:00\n- Status changed: Invalid\n. Try here: http://groups.google.com/group/minify\nI see no reason why it wouldn't work, but there are some known edge case bugs in the\nJSMin algorithm.\nReported by mrclay.org on 2011-06-10 17:43:21\n- Status changed: Invalid\n. Can you give an example of markup it breaks?\nReported by mrclay.org on 2011-06-17 16:26:31\n. ```\nI had following snippet in a template file and was trying to minify and merge it on\nthe html page. \n View:\nThe output was:\n View: \nHope it helps.\n```\nReported by prasad83.a on 2011-06-21 05:07:44\n. I can't reproduce this bug. The output I get has a newline between \"<div\" and \"class=\".\nCan you give me another example?\nReported by mrclay.org on 2011-06-23 19:28:57\n. ```\nTry the following:\nphp\n\n<pset_include_path(dirname(FILE). '/libs/min/lib' . PATH_SEPARATOR . get_include_path());\ninclude_once 'Minify/HTML.php';\n$input = 'aContent';\necho Minify_HTML::minify($input);\n?>\nOutput was:\naContent\nwhich firefox 4.x interpreted as <divclass=\"aClass\"... and missed applying the style.\n```\nReported by prasad83.a on 2011-06-24 04:57:07\n. ```\nIt's perfectly valid to use \"\\n\" rather than \" \" as whitespace in a tag, and browsers\nshould have no problem parsing it. FF5/XP and FF4/OSX both do fine for me rendering\nthese pages, which are processed by Minify_HTML:\nhttp://mrclay.org/min/builder/\nhttp://fawn.ifas.ufl.edu/mobile/260\nCan you create a public demo page so others can verify this is indeed a FF4 parsing\nbug and not some kind of authoring error?\n```\nReported by mrclay.org on 2011-06-24 21:54:08\n- Status changed: NeedInfo\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. Reported by mrclay.org on 2011-09-03 23:11:35\n- Status changed: Invalid\n. Reported by mrclay.org on 2011-09-03 23:20:28\n- Status changed: Verified\n. php version is 5.1.6\njava is 1.6.0\ncentOS 5\nReported by star212417 on 2011-08-18 09:26:12\n. This seems solved in 2.1.5 (exit code is checked)\nReported by elan.ruusamae on 2012-03-29 19:18:19\n. Reported by mrclay.org on 2012-03-29 20:04:53\n- Status changed: Verified\n. This won't work either. Including full filepaths and mtimes is the only way to catch\nmodifications. On the plus side it won't make MD5's output longer.\nReported by mrclay.org on 2011-09-03 11:55:26\n. Please re-post this message to: http://groups.google.com/group/minify\nReported by mrclay.org on 2011-09-07 16:13:16\n- Status changed: Invalid\n. ```\nI can't duplicate. Using the master branch from github (what I recommend), I get this:\n{margin:0;padding:0}html{height:100%}img.mwaibfTop{margin-top:expression(\"-15px\")}img.mwaibfBot{margin-bottom:expression(\"-4px\")}.clearfix:after{content:\".\";display:block;height:0;clear:both;visibility:hidden}.clearfix{display:inline-block}/*/\nhtml\n.clearfix{height:1%}.clearfix{display:block}/*/\n```\nReported by mrclay.org on 2011-09-19 01:42:47\n- Status changed: NeedInfo\n. ```\nFigured it out.  It's our CMS, Expression Engine 2.  When the \"Debugging\" set to \"0\"\n(turned off) it implements some sort of limit that disrupts the minifying process.\n We apply Minify to Object Oriented Packages of CSS which includes about 50 CSS files.\n It looks like its just choking.  \nThanks for your consideration\n```\nReported by franklinclark on 2011-09-27 23:26:03\n. Can you give an example? And what should be output instead?\nReported by mrclay.org on 2011-10-17 02:13:45\n- Status changed: NeedInfo\n. Thanks for the fast response! I am using this in tandem with lessphp for .less CSS files,\nand I believe I've traced the problem back to lessphp. So it is not a minify issue.\nReported by jsros86 on 2011-10-17 02:41:49\n. See http://code.google.com/p/minify/wiki/CommonProblems#Server_cache_files_won%27t_update\nPerhaps your svn update is give the files old mtimes.\nReported by mrclay.org on 2011-10-25 20:16:56\n- Status changed: NeedInfo\n. ```\nIf you're seeing two \"max-age\" values, then one of them has to be being altered outside\nPHP (by your web server I assume). The code that writes the Cache-Control header in\nMinify is here (it can't write two values):\nhttps://github.com/mrclay/minify/blob/master/min/lib/HTTP/ConditionalGet.php#L155\nIf you make an empty PHP file and call it, does it send Cache-Control:max-age=60 by\ndefault?\n```\nReported by mrclay.org on 2011-11-09 17:43:42\n- Status changed: NeedInfo\n. ```\nshame on me.\nyou are right, i've an .htaccess in root (mostly based on https://github.com/laukstein/ajax-seo/blob/master/.htaccess\n)\n so /min is excluded from redirects, but not from max-age settings\nthanks for all\n```\nReported by daniele.bordignon on 2011-11-10 00:53:11\n. Daniele, does https://github.com/laukstein/ajax-seo/blob/master/.htaccess still returns\nyou any error?\nReported by laukstein on 2013-07-22 06:04:06\n. ```\nI was thinking about this more. I have found myself creating a lot of groups for libs,\none additional thing to this would be create a group say groupJS and groupCSS when\nyou load /min/group.js and /min/group.css it would load the respective option.\nex:\nRewriteRule ^(.*).(js|css)  index.php?g=$1&t=$2 [L,NE]\n```\nReported by charliesmm.web on 2012-04-28 19:28:19\n. ```\nThe current URL format supports multiple groups and files and a versioning number (triggering\na big Expires):\n/min/g=css1,css2&f=help.css,foo/bar.css&124362\nHow would this work in the new format? I'm hesitant to introduce (and have to document\nand support) another format without more clear benefits, but these would be good to\ninclude on the wiki somewhere. Maybe the Cookbook page? Discussing this on the Google\ngroup might be useful.\n```\nReported by mrclay.org on 2012-04-28 23:37:14\n. Reported by mrclay.org on 2012-04-28 23:37:35\n- Labels added: Type-Enhancement, Priority-Low\n- Labels removed: Type-Defect, Priority-Medium\n. Check the wiki for CustomSource. Apache has to execute you script and because it's dynamic\nyou have to have a caching strategy.\nReported by mrclay.org on 2012-02-02 23:28:08\n- Status changed: Invalid\n. Intentional behavior that does not add bytes to the output. See the FAQ section about\nline breaks. Thanks for taking the time to report this though.\nReported by mrclay.org on 2012-02-17 00:10:19\n- Status changed: Invalid\n. Ah, sorry I missed that.\nReported by ultradude25 on 2012-02-28 09:25:12\n. Your webserver is not setup correctly for PHP. See this wiki entry (I just added it):\nhttp://code.google.com/p/minify/wiki/CommonProblems#Directory_Listing_Denied\nReported by mrclay.org on 2012-03-02 15:14:38\n- Status changed: Invalid\n. Worked! Thanks a million.\nReported by markandonis on 2012-03-02 15:20:18\n. It's not a bug, but it's worth considering as a feature.\nReported by mrclay.org on 2012-03-14 13:16:28\n- Status changed: Accepted\n- Labels added: Type-Enhancement, Priority-Low\n- Labels removed: Type-Defect, Priority-Medium\n. No longer adding features to the builder\n. In 3.0\n. Jsmin is never going to support the full ECMA spec w/r/t automatic semicolon insertion,\nbut there may be a fix for this case. In the meantime use a pre-minified version, or\ninsert the semi-colon manually. Leaving out semicolons is poor form.\nReported by mrclay.org on 2012-03-28 18:03:05\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. File at https://github.com/mrclay/jsmin-php\n. this is fixed in git:\nhttps://github.com/mrclay/minify/commit/dfdcdf874a489dbc4da4ce54aecabc88db1bbfab\nReported by elan.ruusamae on 2012-06-05 22:04:42\n. Elan, thanks for the reminder.\nReported by mrclay.org on 2012-06-06 20:39:40\n- Status changed: Verified\n- Labels added: Release-2.1.5\n. See http://code.google.com/p/minify/wiki/CookBook#Processing_Output_After_Minification\nReported by mrclay.org on 2012-04-23 15:57:48\n- Status changed: Invalid\n. No JS minifiers can minify PHP syntax. You have to execute the script and minify the\noutput. See:\nhttp://code.google.com/p/minify/wiki/CustomSource#Example:_Content_from_a_URL\nReported by mrclay.org on 2012-05-03 19:06:34\n- Status changed: Invalid\n. ```\nThanks for pointing me in the right direction and apologies for posting an invalid issue.\nHoping you can give me a little more insight though.\nIf I add this basic example to GroupsConfig:\n$src1 = new Minify_Source(array(\n    'filepath' => '//js/file1.js',\n));\nI'm told class Minify_Source can't be found in my GroupsConfig file.\nMinify_Source is included in Minify which is in index.php and all of the examples use\nthese and are supposed to be aded to GroupsConfig so I'm not sure what's wrong. If\nI include Minify_Source and Minify in GroupsConfig I no longer get those errors. I'm\nusing the latest Minify 2.1.5.\n```\nReported by rayschwartzster on 2012-06-05 15:08:27\n. Discussion moved here: https://groups.google.com/d/msg/minify/X65A3_thsUY/BDxCUwLakCkJ\nPlease open a new ticket only if you've verified via the support list that this is\na bug.\nReported by mrclay.org on 2012-06-05 20:08:20\n. ```\nSorry, my mistake.\nI found what's going wrong.\nI just commented few line codes and added new line to find the file.\n                /*\n                if (0 === strpos($file, '//')) {\n                    $file = $_SERVER['DOCUMENT_ROOT'] . substr($file, 1);\n                }\n                */\n                $file = $_SERVER['DOCUMENT_ROOT'] . '/' . $file;\n\nI think \"isDocRootSet\" should be using in groups configurations.\nAnyway, I fixed my problem :) I'm just sharing this changes, may that can help to other\ndevelopers.\n```\nReported by seyhuncavus on 2012-05-15 08:03:47\n. Please include precisely what problem you were having, and describe your configuration.\nI cannot commit changes that may adversely affect other users.\nReported by mrclay.org on 2012-06-09 02:23:31\n- Status changed: NeedInfo\n. Good catch.\nReported by mrclay.org on 2012-05-30 00:00:01\n- Status changed: Accepted\n. Hello, is there any temporal patch for this? I would like to point it out to somebody\nusing Minify. Thanks\nReported by rfmunoz@fluidsignal.com on 2012-06-04 15:34:29\n. Fixed in 666cd6d89a22:\nFor manual patching (I don't recomment) see: http://code.google.com/p/minify/source/diff?spec=svn666cd6d89a224bbf3715b07be5f2430c4c226a03&old=f7d73dcc566c99223138b525b37f6c6465a6704b&r=666cd6d89a224bbf3715b07be5f2430c4c226a03&format=unidiff&path=%2Fmin%2Flib%2FMinify%2FController%2FMinApp.php\nReported by mrclay.org on 2012-06-04 15:52:54\n- Status changed: Verified\n- Labels added: Release-2.1.5\n. Fixed in 41cb743d6c08\nReported by mrclay.org on 2012-06-04 16:19:36\n- Status changed: Verified\n. Reported by mrclay.org on 2012-06-07 17:45:10\n- Labels added: Release-2.1.5\n. Reported by mrclay.org on 2012-06-09 02:17:34\n- Status changed: Fixed\n- Labels removed: Release-2.1.5\n. ```\nI found that this bug can be fixed by <?php ini_set('pcre.backtrack_limit', 999999999)\nsee http://www.php.net/manual/en/pcre.configuration.php.\nMay be you should add this option to Minify_HTML configuration.\nCheers!\n```\nReported by barbushin on 2012-06-14 10:16:42\n. CommonProblems in the docs covers this.\n. Also consider:\nhttps://github.com/douglascrockford/JSMin/commit/55809e6d07be4a0d3029d48112d16ef833e55cf7\nReported by mrclay.org on 2012-06-13 17:08:18\n. Fixed in master\nReported by mrclay.org on 2013-03-29 14:05:47\n- Status changed: Verified\n. Please see http://code.google.com/p/minify/wiki/CommonProblems#Server_cache_files_won't_update\nReported by mrclay.org on 2012-09-30 21:59:11\n- Status changed: Invalid\n. ```\nhttp://code.google.com/p/minify/wiki/Debugging#Javascript/CSS_Problems\nor if using Minify::serve directly, use the 'debug'/'minifiers' options:\nhttp://code.google.com/p/minify/source/browse/min/lib/Minify.php#130\n```\nReported by mrclay.org on 2012-06-28 14:09:19\n- Status changed: Invalid\n. thanks\nReported by younes.elbiache on 2012-06-28 14:14:14\n. I cannot help with general Javascript support. Seek help from whomever wrote the Zend\nFramework integration.\nReported by mrclay.org on 2012-09-30 21:56:40\n- Status changed: Invalid\n. Keep-Alive should be managed by your web server. I'm not certain that it would be wise\nfor Minify to send this header. I can re-open the ticket if I see convincing evidence;\nfeel free to discuss this on the Google group or Stack Overflow.\nReported by mrclay.org on 2012-07-17 13:17:52\n- Status changed: WontFix\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. Stange with different tools I get different results. Even with the same tools I sometimes\nget the Keep-Alive header in the reponse and sometimes not. So I asume it is not a\nbug in minify.\nReported by bernhardkau on 2012-07-17 13:45:15\n. Chrome seems to think the Keep Alive header is absent. However checking the same files\nin Firefox shows the header being present.\nReported by tinblue on 2013-09-05 10:34:49\n. Fixed in 335800947b31\nReported by mrclay.org on 2012-09-30 22:46:10\n- Status changed: Verified\n. ```\nOk just kidding about the declaration being the only thing. There are namespace stuffs\nused elsewhere as well. \nThe expected outcome of this issue will be to update the requirements page with the\ncorrected requirements.\n```\nReported by eddie@eddiemonge.com on 2012-08-13 20:03:12\n. Now says, \"PHP 5.1.6 / command-line tools require 5.3\". Default installation/usage should\nnot need 5.3.\nReported by mrclay.org on 2012-08-13 20:21:06\n- Status changed: Verified\n- Labels added: Component-Docs\n. Would it be possible to have the CLI be a separate folder or something? My version control\nruns PHPLint and since its 5.2.17, it will not allow the 5.3 code to be accepted.\nReported by eddie@eddiemonge.com on 2012-08-13 20:27:20\n. Eventually, though not real soon, the whole library will be 5.3. If you don't need CLI,\nfork on github and remove it from your branch. That way you can still merge in new\ncommits from upstream.\nReported by mrclay.org on 2012-08-13 20:53:26\n. I forgot to say which file the line numbers were from. They are from Minify/CSS/Compressor.php\nReported by Unsane1047 on 2012-08-14 19:54:14\n. We keep running into limits and bugs in PCRE. You can try raising PCRE's backtrack limit\nand other settings. Not much I can do about it and no one crashes on the same line\n:/\nReported by mrclay.org on 2012-08-15 03:39:48\n. the same here... crashes with non error... i raised PCRE limit, script execution time...\nand nothing happen... just a connection reset by apache... :(\nReported by cebasso on 2013-06-25 17:22:38\n. ```\nhey, i just found a solution here... check this topic\nhttps://code.google.com/p/minify/issues/detail?id=62#c9\nRegards,\nCarlos\n```\nReported by cebasso on 2013-06-25 17:27:42\n. Hmm. There are multi-word fonts in the unit tests and they pass. Try the units on your\nsystem.\nReported by mrclay.org on 2012-09-04 23:46:02\n- Status changed: NeedInfo\n. Please attach to this ticket a larger sample of CSS in which this bug occurred.\nReported by mrclay.org on 2012-09-07 15:38:03\n. Reported by mrclay.org on 2012-09-30 21:53:22\n- Status changed: Invalid\n. Minify sets the include path. These paths are based on PSR-0, not relative paths. I\nintend to ditch require/include for autoloading when I next work on this.\nReported by mrclay.org on 2012-09-19 19:15:31\n- Status changed: Invalid\n. What are you using for the symlinks setting? That's the source of the error.\nReported by mrclay.org on 2012-09-27 14:20:44\n- Status changed: NeedInfo\n. Thanks for the report. Will check this out.\nReported by mrclay.org on 2012-10-11 18:20:45\n- Status changed: Accepted\n. Reported by mrclay.org on 2012-10-11 18:21:32\n- Status changed: Started\n. Not going to support XHTML. Viva HTML5\n. Reported by mrclay.org on 2013-08-26 14:17:53\n- Status changed: Duplicate\n- Merged into: #295\n. ```\nSame problem with require_once 'Minify/CommentPreserver.php'; and require_once 'Minify/CSS/UriRewriter.php';\nin CSS.php\n```\nReported by marco@qball.nl on 2012-12-11 09:43:55\n. Now using composer\n. Fixed, sorry.\nReported by mirzadelic1 on 2013-02-04 22:41:33\n. Sorry for my english\nReported by bellegueulle.damien on 2013-02-21 17:21:18\n. Same problem there. It works on my dev environnement but not on the prod.\nReported by webmaster@iklax.com on 2014-06-11 07:56:00\n. I should clarify, while I know I can go through and change all of the paths within the\nMinifier library, I'm looking for a way to do it without modifying the original Minifier\nlibrary.\nReported by Zxurian on 2013-04-04 06:21:38\n. Please use the google group for support. The master branch has all the latest updates,\nincluding autoloading, so there are no \"require\" statements in class files.\nReported by mrclay.org on 2013-04-04 14:40:03\n- Status changed: Invalid\n. apologies. late when I typed it, thought I was in the groups section.\nReported by Zxurian on 2013-04-04 16:14:37\n. I do not understand this problem. You need to be clearer.\nReported by mrclay.org on 2013-04-11 18:53:53\n- Labels added: Priority-Low\n- Labels removed: Priority-Medium\n. minify html, html5 themes, disturbing.I'm sorry, I know a little bit in your language.\nReported by 39hackteam on 2013-04-13 18:21:32\n. Minify must be set to the new html5.\nReported by 39hackteam on 2013-04-13 18:32:59\n. Dupe of #285.\nReported by mrclay.org on 2013-07-24 18:01:14\n- Status changed: Duplicate\n. Dupe of #285\nReported by mrclay.org on 2013-07-24 18:01:34\n- Status changed: Duplicate\n. ```\nI've got the same Issue, but only the first time I upload a modified File (css). After\na reload of the Page, it works fine.\nI use groupConfig. With 2.1.4 BETA and 2.1.3 it works after upload, in 2.1.5 and 2.1.7\nthe page loads without stylesheet (the first time).\nWith curl I see that a stream may not be syncronized, but I'm not sure about it. \n```\nReported by ptomzig on 2014-05-01 20:12:55\n. Duplicate of #285\nReported by mrclay.org on 2013-07-24 18:00:18\n- Status changed: Duplicate\n. was fixed\n. 404\n. There was a bug in the previous version. Here is the fix.\nReported by danumbahonewilbur on 2013-08-08 22:53:00\n\n- Attachment: minify_uri_builder.php.php\n. ```\nThanks, but this logic is already present: http://code.google.com/p/minify/source/browse/min/lib/Minify/HTML/Helper.php#187\nSee the file min/utils.php for usage.\nIf you can improve on that algorithm feel free to make a pull request here or on github.\n```\nReported by mrclay.org on 2013-08-09 14:52:27\n- Status changed: Invalid\n. Ok thanks!\nReported by danumbahonewilbur on 2013-08-14 23:39:21\n. Issue 279 has been merged into this issue.\nReported by mrclay.org on 2013-08-26 14:17:53\n. ```\nThis is a feature. http://code.google.com/p/minify/wiki/UriRewriting\nPost to the Google group for support on configuring the rewriting.\n```\nReported by mrclay.org on 2013-09-14 23:45:35\n- Status changed: Invalid\n. Doh! I'm duly shamed. Thanks much, works perfectly as advertised! (note to self: RTFM)\nReported by buzcarter on 2013-09-15 20:33:31\n. ```\nprobably same problem as #62.\nUpdate your config file to use CSSMin: http://code.google.com/p/minify/wiki/CookBook#CSSmin_PHP_port\n```\nReported by mrclay.org on 2013-09-26 13:20:54\n- Status changed: Duplicate\n. I'm open to suggestions\n. ```\nSee this line: http://code.google.com/p/minify/source/browse/min/lib/Minify.php#568\nDoes changing 200 to 100 fix it?\n```\nReported by mrclay.org on 2013-10-27 03:59:59\n. Yes, I did change 200 to 100 for the current version of my plugin and it seems to work.\nNot sure if such change affects anything or is the long name there just for info? The\nmd5 is quite sufficient already.\nReported by mr.minhkhang on 2013-10-27 04:02:46\n. The long filenames were to assist people in debugging Minify and deleting certain cache\nfiles manually. 100 should be a lot safer.\nReported by mrclay.org on 2013-10-27 04:10:37\n. This issue was closed by revision 6e0e130a5bfd.\nReported by mrclay.org on 2013-10-27 04:12:30\n- Status changed: Fixed\n. This issue was closed by revision f8b62b358b53.\nReported by mrclay.org on 2013-11-14 01:41:09\n. ```\nPlease try the CSSMin configuration:\nhttp://code.google.com/p/minify/wiki/CookBook#CSSmin_PHP_port\n```\nReported by mrclay.org on 2013-11-05 03:29:12\n. ```\nI can not understand how to use this code. I put it in /min/config.php, but that does\nnot change (not work)\n(\u042f \u043d\u0435 \u043c\u043e\u0433\u0443 \u043f\u043e\u043d\u044f\u0442\u044c \u043a\u0430\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0434\u0430\u043d\u043d\u044b\u043c \u043a\u043e\u0434\u043e\u043c. \u042f \u0432\u0441\u0442\u0430\u0432\u0438\u043b \u0435\u0433\u043e \u0432 /min/config.php, \u043d\u043e\n\u043d\u0438 \u0447\u0435\u0433\u043e \u043d\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u043b\u043e\u0441\u044c)\nI found another version of the solutions (not ideal)\n\u042f \u043d\u0430\u0448\u0435\u043b \u0434\u0440\u0443\u0433\u043e\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u0440\u0435\u0448\u0435\u043d\u0438\u044f (\u043d\u0435 \u0438\u0434\u0435\u0430\u043b\u044c\u043d\u044b\u0439)\nThis problem in the file /min/lib/Minify/CSS/Compressor.php #113-124\n// remove ws in selectors\n$css = preg_replace_callback('/\n        (?:              # non-capture\n            \\s\n            [^~>+,\\s]+  # selector part\n            \\s\n            [,>+~]       # combinators\n        )+\n        \\s*\n        [^~>+,\\s]+      # selector part\n        {                # open declaration block\n    /x'\n    ,array($this, '_selectorsCB'), $css);\na temporary solution to this problem\n(\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u044d\u0442\u043e\u0439 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b)\npreg_match_all('~(url((\\'|\")data:image/(jpeg|gif|png|svg)(.)(\\'|\")))~', $css, $temp_base64,\nPREG_PATTERN_ORDER);\n$css = preg_replace('~(url((\\'|\")data:image/(jpeg|gif|png|svg)(.)(\\'|\")))~', 'temp_base64_c7dc78yhuinm4',\n$css);\n// remove ws in selectors\n$css = preg_replace_callback('/\n        (?:              # non-capture\n            \\s\n            [^~>+,\\s]+  # selector part\n            \\s\n            [,>+~]       # combinators\n        )+\n        \\s*\n        [^~>+,\\s]+      # selector part\n        {                # open declaration block\n    /x'\n    ,array($this, '_selectorsCB'), $css);\n$i = 0;\nforeach ($temp_base64[0] as $return_from_temp) {\n    $css = preg_replace('~temp_base64_c7dc78yhuinm4~', $return_from_temp, $css, ++$i);\n}\n```\nReported by admin@g63.ru on 2013-11-05 04:33:23\n. Paste the code from the wiki (http://pastebin.com/GLd0a1cn) into min/config.php and\nclear your browser cache. CSSmin will be used for compression and it has specific workarounds\nfor this issue. I have no time/interest in patching the Minify_CSS_Compressor class\nat this time.\nReported by mrclay.org on 2013-11-05 13:49:17\n- Status changed: WontFix\n. Ok. Thank you for your help.\nReported by admin@g63.ru on 2013-11-05 17:13:06\n. Please provide a more specific description of the problem. Or seek help here: http://groups.google.com/group/minify\nReported by mrclay.org on 2013-11-11 19:20:52\n. Minify should examine the SCRIPT type attribute if present, and not process the contents\nif it's not a common JavaScript MIME type.\nReported by mrclay.org on 2013-11-12 17:40:26\n- Status changed: Accepted\n. ```\nHello,\nHere is a proposed patch for this issue\nperhaps we can add some values for the \"javascript types allowed\", and let the trim\n?\nin /lib/Minify/HTML.php, near Line 217, patched function _removeScriptCB() (i just\nadded the $typeJS boolean)\nprotected function _removeScriptCB($m)\n    {\n        $openScript = \"<script{$m[2]}\";\n        $js = $m[3];\n    // whitespace surrounding? preserve at least one space\n    $ws1 = ($m[1] === '') ? '' : ' ';\n    $ws2 = ($m[4] === '') ? '' : ' ';\n\n    // check if the script has a type attribute, and check it\n    $typeJS = true; // no type means JS\n    if (preg_match('/type=(\\'|\")?([^ \\'\">]+)(\\'|\")?/i', $m[2], $matches)) {\n      $typeJS = in_array(strtolower($matches[2]), array( \"text/javascript\", \"application/javascript\"\n\n));\n        }\n    if ($typeJS) {\n  // remove HTML comments (and ending \"//\" if present)\n      if ($this->_jsCleanComments) {\n        $js = preg_replace('/(?:^\\\\s*<!--\\\\s*|\\\\s*(?:\\\\/\\\\/)?\\\\s*-->\\\\s*$)/', '',\n\n$js);\n          }\n      // remove CDATA section markers\n  $js = $this->_removeCdata($js);\n\n      // minify\n      $minifier = $this->_jsMinifier\n        ? $this->_jsMinifier\n        : 'trim';\n      $js = call_user_func($minifier, $js);\n}\n\n    return $this->_reservePlace($this->_needsCdata($js)\n        ? \"{$ws1}{$openScript}/*<![CDATA[*/{$js}/*]]>*/</script>{$ws2}\"\n        : \"{$ws1}{$openScript}{$js}</script>{$ws2}\"\n    );\n}\n\nworks for me and handlebars templates like \n ... \n```\nReported by jc@vitalyn.com on 2014-12-30 15:54:35\n. You could try to fix it. I haven't seriously worked on this in years.\n. If it works for you, how about sending a PR?. ```\nAfter a bit experimenting, there is no use in generating correct paths outside of document\nroot.\nEven if we were able to generate the correct path in the example, the fonts would not\nbe available as they are not reachable by the web server.\nHowever, I still think this is a bug since min generated a wrong truncated path without\nany error or notice.\n```\nReported by luigif on 2013-12-26 15:29:40\n. You must configure Minify to handle URLs served from outside the docroot.\nhttp://code.google.com/p/minify/wiki/UriRewriting#Aliases_/_Symlinks_/_Virtual_Directories\nReported by mrclay.org on 2013-12-26 16:37:28\n- Status changed: Invalid\n. Something I forgot to tell: this problems seems related to the regular expression inside\nMinify_Lines::_eolInComment. It replaces patterns like //.*?, so in the case of the\nurl, it will replace from the // after the http: untile the end of line; removing the\ncomment closing: */\nReported by jmcustiel on 2013-12-27 16:24:13\n. ```\n//,gn=/\\?/,yn=/)<[^<])<\\/script>/gi,bn=/([?&])_=[^&]/,wn=/^([\\w+.-]+:)(?:\\/\\/([^\\/?#:])(?::(\\d+)|)|)/\nThis is a part of a jquery file - it is also stripped (and all after that) due to this\nregex match\n```\nReported by wbarski on 2014-02-25 13:36:54\n. Probably fixed by #532\n. Thanks. Can you try this change? https://github.com/mrclay/minify/pull/86/files\nReported by mrclay.org on 2014-01-13 21:52:02\n- Status changed: Started\n. Perfect! thanks!\nReported by dvelasquez@cmj.com on 2014-01-13 22:00:36\n. Fix was merged\n. JSMin should remove comments unless they have IE conditionals. This does not look like\nJSMin output. Closing for now.\nReported by mrclay.org on 2014-04-07 03:09:19\n- Status changed: Invalid\n. Actually, I just saw that on some files the comments are removed. But at a certain point\nthere are not removed anymore. Could that be because of the size of the generated file\n? (1.5M chars) or a memory issue ?\nReported by ambroise.dhenain on 2014-04-07 06:09:12\n. ```\nPlease reopen this issue.\nI searched more about it I'm sure it's because either of the size of the generated\nfile or a memory issue.\nAnyway, it's basically because there are too much big files to process.\nIf I import all my files:\nhttps://gist.githubusercontent.com/Vadorequest/10422717/raw/636fdd6c377424dbc9baea86a76217a4f240fc7f/default.js\nIf I import just a few libraries:\nhttps://gist.github.com/Vadorequest/10422779\nPlease search for \"fancybox/jquery-fancybox-thumbs.js\" and compare between both files.\nYou'll see that on the big one there are comments and on the small they are deleted.\nIt's exactly the same code who generate both files, excepts that on the secnd case\nI don't add the theme assets neither the whole asset folder.\nPlease help me to figure out how I can generate file that doesn't contain slash comments,\nis it a memory allocation problem?\n```\nReported by ambroise.dhenain on 2014-04-10 21:01:51\n. ```\nIf memory were the issue PHP would exit and nothing would be written to cache. I don't\nknow how OpenBuildings has integrated these class files, you need to ask them.\nJSMin and JSMinPlus absolutely do remove comments appropriately.\n```\nReported by mrclay.org on 2014-04-10 21:15:48\n. I'm sory, but what's the link with `OpenBuildings`?\nI don't know what you are refering to.\nThanks.\nReported by ambroise.dhenain on 2014-04-10 21:25:31\n. Okay. I get it. The point is that I didn't get any answer from them since I got into\nthis issue...\nReported by ambroise.dhenain on 2014-04-10 21:32:05\n. I can't support their software.\nReported by mrclay.org on 2014-04-10 21:42:17\n. I'm not asking you to. I'll move to use another soft then, maybe https://code.google.com/p/minify/wiki/CustomSource,\nI should not have issue with this one. Maybe do you know something better? (I use Kohana\nPHP framework 3.3)\nReported by ambroise.dhenain on 2014-04-10 21:46:17\n. else{obj[atn]=atv;};});};};if(obj){obj=$.extend((txt!=''?new String(txt):{}),obj||{});txt=(obj.text)?([obj.text||'']).concat([txt]):txt;if(txt)obj.text=txt;txt='';};var\nout=obj||txt;if(extended){if(txt)out={};txt=out.text||txt||'';if(txt)out.text=txt;if(!simple)out=myArr(out);};return\nout;};var jsVar=function(s){return String(s||'').replace(/-/g,\"_\");};function isNum(s){var\nregexp=/^((-)?([0-9]+)(([\\.\\,]{0,1})([0-9]+))?$)/return(typeof s==\"number\")||regexp.test(String((s&&typeof\ns==\"string\")?jQuery.trim(s):''));};var myArr=function(o){if(!$.isArray(o))o=[o];o.length=o.length;return\no;};if(typeof xml=='string')xml=$.text2xml(xml);if(!xml.nodeType)return null;if(xml.nodeType==3||xml.nodeType==4)return\nxml.nodeValue;var root=(xml.nodeType==9)?xml.documentElement:xml;var out=parseXML(root,true);xml=null;root=null;return\nout;},text2xml:function(str){return $.parseXML(str);}});})(jQuery);;var Configuration={\"locations\":{\"muc\":{\"details\":{\"name\":\"Munich\",\"gps\":{\"latitude\":48.353559,\"longitude\":11.782019}},\"rooms\":{\"VC-MUCDC4OskarMaria@domain.com\":{\"name\":\"KarlValentin\",\"seats\":20},\"MUC-DC1ThereseGiehse@domain.com\":{\"name\":\"herese\nGiese (DC1)\",\"seats\":20},\"MUC-DC2GabrieleMuente@domain.com\":{\"name\":\"Gabriele M\u00fcnter\n(DC2)\",\"seats\":20},\"MUC-DC3Franzvon@domain.com\":{\"name\":\"Franz von Lenbach (DC3)\",\"seats\":20},\"VC-MUCDC4OskarMaria@domain.com\":{\"name\":\"Oskar\nMaria Graf (DC4)\",\"seats\":20},\"MUC-FranzMarc@domain.com\":{\"name\":\"Franz Marc\",\"seats\":20},\"MUC-SeppMoser@domain.com\":{\"name\":\"Sepp\nMoser\",\"seats\":20},\"MUC-KarlValentin@domain.com\":{\"name\":\"Karl Valentin\",\"seats\":20},\"MUC-CarlOrff@domain.com\":{\"name\":\"Carl\nOrff\",\"seats\":20},\"VC-MUCLieslKarlstadt@domain.com\":{\"name\":\"Liesl Karlstadt (VC)\",\"seats\":20}}},\"cgn\":{\"details\":{\"name\":\"Cologne\",\"gps\":{\"latitude\":50.941303,\"longitude\":6.958166}},\"rooms\":{\"CGNAgnes@domain.com\":{\"name\":\"Agnes\",\"seats\":5,\"has\":[\"Screen\",\"WiFi\",\"Whiteboard\"]},\"CGNAlderaan@domain.com\":{\"name\":\"Alderaan\",\"preferForClients\":true,\"seats\":3,\"has\":[\"Whiteboard\",\"WiFi\",\"Phone\"]},\"CGNDagobah@domain.com\":{\"name\":\"Dagobah\",\"preferForClients\":true,\"seats\":7,\"has\":[\"Whiteboard\",\"WiFi\",\"Phone\"]},\"CGNEigelstein@domain.com\":{\"name\":\"Eigelstein\",\"seats\":7,\"has\":[\"Whiteboard\",\"WiFi\",\"Phone\",\"Kicker\"]},\"CGNEndor@domain.com\":{\"name\":\"Endor\",\"preferForClients\":true,\"seats\":6,\"has\":[\"Screen\",\"mobile\nVideo\",\"WiFi\",\"Phone\"]},\"CGNHoth@domain.com\":{\"name\":\"Hoth\",\"preferForClients\":true,\"seats\":6,\"has\":[\"Screen\",\"WiFi\",\"Phone\"]},\"CGNKorriban@domain.com\":{\"name\":\"Korriban\",\"preferForClients\":true,\"seats\":7,\"has\":[\"Whiteboard\",\"WiFi\",\"Phone\"]},\"CGNKwartierLataeng@domain.com\":{\"name\":\"Kwartier\nLataeng\",\"seats\":6,\"has\":[\"Whiteboard\",\"WiFi\",\"Phone\"]},\"CGNMediapark@domain.com\":{\"name\":\"Mediapark\",\"seats\":16,\"has\":[\"Phone\",\"Screen\",\"Video\",\"WiFi\"]},\"CGNMosEisley@domain.com\":{\"name\":\"Mos\nEisley\",\"preferForClients\":true,\"seats\":40,\"has\":[\"projector screen\",\"wifi\",\"mobile\nvideo\"]},\"CGNSeverin@domain.com\":{\"name\":\"Severin\",\"seats\":6,\"has\":[\"Phone\",\"Screen\"]},\"CGNYavin@domain.com\":{\"name\":\"Yavin\",\"preferForClients\":true,\"seats\":3,\"has\":[\"Phone\",\"Video\",\"WiFi\",\"Whiteboard\"]}}}},\"version\":\"1.1\",\"url\":\"./proxy.php?TARGET=https://webmail.domain.com/ews/exchange.asmx&DOMAIN=domain\",\"startWithQuickbook\":true,\"showQuickbookButton\":true,\"minTime\":7,\"maxTime\":20,\"roomColors\":[\"#1D1D1D\",\"#DE2728\",\"#21ADDD\"],\"minColumnWidth\":78,\"defaultNumberOfPersons\":3,\"defaultMeetingTopic\":\"Quickbooked\",\"defaultMeetingOffsetMinutes\":10,\"defaultMeetingDuration\":\"00:30\"};;function\nRGBColor(color_string)\nReported by Pich.Dominik on 2014-04-06 14:13:02\n. Use a pastebin. I need the unminified source.\nReported by mrclay.org on 2014-04-07 02:50:21\n. Use support group, or re-open.\n. ```\nSee https://code.google.com/p/minify/wiki/FAQ#Why_do_the_CSS_&_HTML_minifiers_add_so_many_line_breaks?\nIf you have concrete ideas how to improve the algorithms, please share them.\n```\nReported by mrclay.org on 2014-05-07 20:43:37\n- Status changed: WontFix\n. use the pre-minified version or use CSSmin.\n. dir() shouldn't be required for normal operation, so Minify way work fine even if the\nunit tests fail.\nReported by mrclay.org on 2014-05-23 13:21:09\n- Status changed: Invalid\n. Use support group\n. ```\nHere is the complete diff between the version of Minify, and the possible Minification\nof gtmetrix.com: http://www.diffchecker.com/h6eqk9uj \nThis CSS file is from my web site http://nodecode.de . This website I run with the\nCMS WordPress, the Minify-engine I use in the plugin WP Minify Fix ( http://wordpress.org/plugins/wp-minify-fix/\n) what is a further developed by myself, based on the dead WP Minify plugin. A user\nhas brought to my attention that the minify not engine uses the full potential.\n```\nReported by nodeforum.de on 2014-06-07 09:34:53\n. Please see the second section of https://code.google.com/p/minify/wiki/FAQ\nReported by mrclay.org on 2014-06-07 12:04:36\n- Status changed: WontFix\n. Just a note, it actually made minify useless for me... Site was \"trashed\" (no css) everytime\nminify didn't get to load just once. A\nReported by dino.patti on 2014-06-13 09:13:52\n. Why us Chrome sending conditional GET headers if it can't handle a 304 response? Can\nyou send me a detailed request/response header list?\nReported by mrclay.org on 2014-06-13 10:59:16\n. I suspect you have a local extension that is causing Chrome not to follow the HTTP spec\ncorrectly)\nReported by mrclay.org on 2014-06-13 11:04:49\n. ```\nSearching further into the issue, there might be a transparent proxy between me and\nmy server, which is cause of the issue.\n(With that said, shouldn't Minify handle no-cache in still?)\nThe test i've done now is that i added debug headers, and it seems that the response\ndoes not get served by, something else is responding and not handling no-cache and\nno last-modified,etag header. \n```\nReported by dino.patti on 2014-06-13 11:27:08\n. ```\nRequest\nRequest URL: http://XXXXX.com/min/?f=/css/style.css,/css/photoswipe.css,/css/magnific-popup.css\nRequest Method:GET\nRequest Headersview source\nAccept:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8\nAccept-Encoding:gzip,deflate,sdch\nAccept-Language:en,en-US;q=0.8,da;q=0.6\nCache-Control:no-cache\nConnection:keep-alive\nCookie: XXXXX\nDNT:1\nHost: XXXXX.com\nPragma:no-cache\nUser-Agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2) AppleWebKit/537.36 (KHTML,\nlike Gecko) Chrome/35.0.1916.114 Safari/537.36\nResponse\nStatus Code:304 Not Modified\nCache-Control:max-age=1800\nConnection:Keep-Alive\nDate:Fri, 13 Jun 2014 11:28:55 GMT\nETag:\"pub1402591632\"\nExpires:Fri, 13 Jun 2014 11:58:55 GMT\nKeep-Alive:timeout=5, max=96\nServer:Apache/2.2.22\nVary:Accept-Encoding,User-Agent\nContent empty\nSo both client and server didn't have the content here.\n```\nReported by dino.patti on 2014-06-13 11:31:58\n. ```\nThis can by the way be replicated here in incognito (did try that of course), so if\nit's anything... it's the server or something in between me and the server.\nI'm playing around with some .htaccess now to see if i can disable apache caching (if\nthat is the issue)\n```\nReported by dino.patti on 2014-06-13 11:45:39\n. I'm not sure what is happening, i need to try it out on another server. Something is\nignoring my client and just serving me 304 and empty content.\nReported by dino.patti on 2014-06-13 14:27:13\n. http://www.mrclay.org/ is serving both JS and CSS via minify and forced refresh shows\nno problem.\nReported by mrclay.org on 2014-06-13 14:36:41\n- Status changed: Invalid\n. Minify_CSS_Compressor should not do this. Which CSS minifier are you using?\nReported by mrclay.org on 2014-06-17 20:21:57\n. I was using only CSSmin.php from min/lib directory. I didn't notice there are more compressors\navailable... I will try the other one. Thanks!\nReported by michbak on 2014-06-18 07:10:27\n. This was fixed in the upstream library https://github.com/tubalmartin/YUI-CSS-compressor-PHP-port/issues/14\nReported by mrclay.org on 2014-06-18 13:50:40\n- Status changed: Started\n. Using CSSmin now\n. This must be a problem in your environment. Please post to the Google group.\nReported by mrclay.org on 2014-07-22 16:27:47\n- Status changed: Invalid\n. ```\nCreate a temp directory at E:\\Domains\\sobrancelhadefinitiva.com\\tmp.\nSet $min_cachePath to that value in config.php\nPlease seek further help on the Google Group.\n```\nReported by mrclay.org on 2014-08-03 14:10:45\n- Status changed: Invalid\n. Fixed in master branch. Haven't had time to release 2.1.8.\nReported by mrclay.org on 2014-08-22 18:04:06\n- Status changed: Invalid\n. ```\nMy apologies for having missed that this is already fixed in master.\nHope to see it soon released.\nBest regards,\nsmz\n```\nReported by smz@smz.it on 2014-08-22 23:52:55\n. Reported by mrclay.org on 2014-09-04 12:19:39\n- Status changed: WontFix\n. ```\nExpected output should be:\nstring(14) \"(6).toString()\"\n(not string(12))\n```\nReported by corvass on 2014-10-29 12:15:12\n. JSMin+ is a 3rd party library that unfortunately looks unmaintained. Author: http://crisp.tweakblogs.net/blog/cat/716\nReported by mrclay.org on 2014-12-02 07:20:20\n- Status changed: WontFix\n. I've removed JSMin+. :person_frowning: \n. ```\nnever mind, looks like \"char\" is a reserved word.\nill leave this ticket here, in case some other people run into this issue\njust rename the variable\n```\nReported by cristi.catea on 2014-10-31 17:39:13\n. Reported by mrclay.org on 2014-11-02 05:12:21\n- Status changed: Invalid\n. Prefer to use composer\n. ```\nThis commit fix that issue:\nhttps://github.com/KTOmega/minify/commit/3553016a243cdc2366f1dd1b322e94d11185bc7c\nfile lib/Minify/CSS/Compressor.php\n```\nReported by tfspir on 2015-05-21 09:17:02\n. Please note that I made changes when adding this feature; this PRs adds duplicate code. Also squash this to a single commit and use PSR-2. Ideally the commit message would tell me exactly what has been fixed.\n. See this option: https://github.com/mrclay/minify/blob/master/min/config.php#L105\nYes, each time you request, you'll get a later Expires date to match the Cache-Control: max-age value. If you want the best caching. If you disable caching in your browser you'll see that this is happening on every request. If it doesn't change, you're seeing your browser's cached copy.\n. Browser caching works differently when you load a CSS/JS directly in the address bar, and when you force a page refresh. The caching will work fine just browsing around.\n. You'll get the best caching by appending a version to the URLs like &v=1. If $_GET['v'] is present, Minify uses a year for the max-age. That would mean that you'd have to manually change your URLs whenever you changed a source file.\n. You could do this:\nhtml\n<link rel=\"stylesheet\" href=\"/min?f=styles/reset.css,styles/global.css,styles/jquery-ui.css&amp;v=3307,5211,1235\u201d />\nor just use the Minify_getUri function.\n. Why is this necessary?\n. Would you be willing to just use the 3.0 branch, where you could already extend the Minify class to override _getCacheId()? https://github.com/mrclay/minify/blob/3.0/min/lib/Minify.php#L563\nIn 2.x I'd probably prefer something like\nphp\n$min_serveOptions['cacheIdFunc'] = function ($md5, $name) {\n    return \"minify_{$name}_{$md5}\"; // customize as you wish\n};\nThat gives you access to the hash, whether you choose to use it or not. But really I think this is just messy in this static environment.\n. Sorry, I moved the 3.0 work to the master branch yesterday. It's operational, but all features are not fully tested.\n. Replacing the Minify class in 3.0 is now easy: https://github.com/mrclay/minify/commit/b7b26e3a832a0f15c5861b71376c026bee7c5d97\n. Please use http://groups.google.com/group/minify for support.\n. @glensc thoughts on this idea?\n. Yes, or move the contents of \"min\" into the project root. So the install directions would be:\nsh\ncd /var/www/public_html\ngit clone <url> min\ncd min\ncomposer install\n...and figure out what to do with the other stuff. Maybe separate projects pulled in via composer.\n. Agreed.\n. Please take a look at #474 if you don't mind.\n. Done in UserGuide\n. @glensc Can you give this a quick look? Seem like a good idea?\n. I think CORS support is beyond the scope of Minify, but you could put something like this in config.php:\nphp\nif ($_SERVER['REQUEST_METHOD'] == 'OPTIONS') {\n  // return only the headers and not the content\n  // only allow CORS if we're doing a GET - i.e. no saving for now.\n  if (isset($_SERVER['HTTP_ACCESS_CONTROL_REQUEST_METHOD']) && $_SERVER['HTTP_ACCESS_CONTROL_REQUEST_METHOD'] == 'GET') {\n    header('Access-Control-Allow-Origin: *');\n    header('Access-Control-Allow-Headers: X-Requested-With');\n  }\n  exit;\n}\nFrom https://remysharp.com/2011/04/21/getting-cors-working\n. Better: remove the X-Requested-With header from the requests.\n. php\n$no_query = preg_replace('~\\\\?.*~', '', $url);\n. Fixed by e904f2e1ae5e893f942e07a4860b6c47393844f1. No, but it's just PHP. Try something like:\nphp\nreturn array(\n     'app' => glob($_SERVER['DOCUMENT_ROOT'] . '/app/libs/*.js'),\n);\n. Want to send a pull request? As we bring in more dependencies it's going to be harder to stick to 5.3.\n. Please squash this change into the first commit. If that's too much trouble I can change it on my end.\n. What's the output you get?\n. Minify_HTML handled it fine. Are you passing the <script ...> tags into JSMin? That definitely won't work.\n. Just to be clear, the solution is just to normalize the dir paths?\n. 2.2.1 was the last release before refactoring and should be stable.\n. @iwalz How are configuring symlinks? Have you tried the debug view for CSS?\n. I just merged #476, which might bring the behavior you're expecting. It means you can use the symlink source dir in the URL.\n. #494 may fix this.\n. Send a pull request.\n. Did you check it with static analysis? I know phpstorm can do this.\n. Looks great. PHPUnit is definitely the way to go. Maybe we'll leave min_unit_tests/ in place until they're all converted? It's not a big deal either way to me.\n. Yes, drop test_Minify_CSS.php.\n. I added a temporary phpunit_conversion branch containing this work.\n. If you've tested it, LGTM.\n. This is the only email I got, so I guess we can close this.\n. I set up Travis\n. Could you add basic usage instructions? Maybe at the top of the class or in CookBook.wiki.md?\nFYI I'm on vacation this week so free time is spotty. Thanks for these PRs.\n. Besides lack of instructions if it works for you I'm cool with merging as is.\n. I don't understand it enough to comment, sorry.\n. What are the pros/cons? If you use the API having a fallback seems important.\n. As is, the worst case is you get JSMin with the comment. Maybe we should just document that and leave it.\n. Test failures are unrelated, but the logic of index.php needs to be encapsulated so it can be tested.\n. Based on https://github.com/mrclay/minify/issues/484#issuecomment-161946195, I think this is insufficient.\n. Clear the minify_ files from your cache folder and reload the page. Are cache files being rewritten?\n. I pulled in jQuery, UI, Validate, and Bootstrap and did hard reloads (no browser cache) of ?f=quick-test.js,jquery.min.js,jquery.validate.min.js,jquery-ui.min.js\nOnce cached on the server, there's no difference, but indeed the initial building of the cache went from 150ms to almost 4s. I'll look into this a bit further.\n. Fix in #511, then we could tag 3.0.0.\n. Have you tried the master branch, which includes #511? File layout is a tiny bit different, but should be easy.\n. @sjosen Please send the exact list of filenames you're combining. And after the first request the others are fast?\n. The \"proper\" way would be to use a SourceFactory instance inside Minify_HTML_Helper::getLastModified instead of just assuming that a string represents a served file. This would mean we need more configuration data to set up the cache and SourceFactory instance, and it would be quite a bit slower for CSS/JS files unless we made a special case for them.\nThis probably means Minify_HTML_Helper needs a rewrite to get rid of all static stuff. getUri() has to stay fast and light because people might be using it when generating every HTML request. If it now has to construct objects and use caches it becomes much less attractive for those purposes.\n. Here's where we'd use a SourceFactory: https://github.com/mrclay/minify/blob/7a73d781f2507c899196a4b7dc7607df73e3eb5d/lib/Minify/HTML/Helper.php#L147\n. There are other benefits of using a real SourceFactory: Every file type we support there would automatically be supported by getUri(), we'd use the same docRoot configuration, etc.\n. > how i would able to obtain sourcefactory?, the html helper is static method!\nYeah, that's why I said the whole component needs rewritten, and probably move more of the index.php logic into a DI container so any component can be pulled out with all necessary wiring.\nIt's probably easier to have a process touch() the .less files listed in groupsConfig.php\n. I'm biased but I prefer https://github.com/mrclay/Props over Pimple. NIH!\n. See #512!\n. Fixed by #512\n. I've restarted the Travis tests, if they pass, feel free to merge.\n. Changes are fine. Haven't looked at test fails\n. Please report the bug to https://github.com/tubalmartin/YUI-CSS-compressor-PHP-port. Or you may try updating the version of CSSmin in composer.json.\n. I don't have any way to test Minify_Cache_ZendPlatform(). You'll have to report back errors you receive in error_log.\n. Just run the composer install locally and upload min/ including the \nvendor directory. It includes an .htaccess file so no Apache config \nrequired.\nMinify can modestly help performance, but \"right solution\"? That's a big \ntopic!\nSteve\nOn 2/22/16 1:33 AM, Corsari wrote:\n\nHello\nI'm going to test your super work!\nReading the ocs looks like you must have access to the apache config, \nam I wrong?\nDo you have some doc for situations like mine? I can only upload/edit \nan .htaccess file.\nWill minify work the same? I can't ask my provider to alter his server \nconfig.\nAlso, will minify result as the right solution for google pagespeed \ninsight complains?\n. composer install creates a vendor directory. Upload that with the other code.\n. The 2.2 version runs on PHP 5.2 but I'm not providing support for it. Please ask for help on the mailing list: https://groups.google.com/forum/#!forum/minify\n. I'm thinking of making a 2.3 release simply to deprecate a bunch of APIs I'd like to change/ditch in 3.0. I have a bunch of BC/deprecation code in #512 (master) but I'd rather be able to clear it out for 3.0.\n\n@glensc sound good to you?\n. Would it be a terrible idea to set 2.x as the project's base branch? I feel like too many people are trying to use master when it's clearly not quite ready. When it is we'd tag 3.0.0, make branch 3.0, and set that as the default.\n. 2.3.0 was released\n. Added a commit with an internal Minify\\Config object.\n. I lean towards merging this and updating docs in other PRs.\n. Do you mean you want to serve the cache files directly? They don't have extensions.\n. I'm confused. Minify only creates cache files (minify_...) in the directory specified by $min_cachePath. There are no other files created.\n. Maybe you aren't setting $min_cachePath in which case, Minify would use sys_get_temp_dir().\n. Please use the Google Group for support. http://groups.google.com/group/minify\nSee if debugging helps: https://github.com/mrclay/minify/blob/master/docs/Debugging.wiki.md\n. There are 280 members of the Google group. If they are not helpful you may seek help on StackOverflow or other venues, but GitHub issues are reserved for bugs in the software or docs.\nI've already spent countless hours creating docs like:\nhttps://github.com/mrclay/minify/blob/master/docs/UserGuide.wiki.md\nhttps://github.com/mrclay/minify/blob/master/docs/CommonProblems.wiki.md\nhttps://github.com/mrclay/minify/blob/master/docs/Debugging.wiki.md\nhttp://www.mrclay.org/2008/09/19/minify-21-on-mrclayorg/\n. ~~Please open this issue here: https://github.com/tubalmartin/YUI-CSS-compressor-PHP-port/issues~~\n. To be clear, url(#myClip) should be left alone, but url(foo.svg#myClip) should be rewritten so it has the correct path to the SVG file, right?\n. See #519\n. I guess I don't know what you mean. You can of course serve one file at a time: /min/f=path/to/foo.js\n. Minify instructs you to install it in http://localhost/min. If you install it in http://localhost/mysite/min, you'll need to use URLs like http://localhost/mysite/min/f=mysite/min/quick-test.js since the path is from the document root.\nPlease use the group for support: http://groups.google.com/group/minify\n. Docs are in master:\nhttps://github.com/mrclay/minify/blob/master/docs/Install.wiki.md#installing-as-a-composer-dependency\n. Please take a look at #541. This requires no compilation, but does require a manual directory delete to clear cache.\n. Try $min_serveOptions['encodeOutput'] = false; in your config.php, but ideally there would be a way to disable pagespeed's behavior in a directory.\n. If you can find a safe way to disable pagespeed's behavior, please send a PR updating the docs or .htaccess\n. - [x] remove last 2 commits\n. I merged the first commit.\n. Try the Minify/Lines.php changes in #532. I may back-port the fix to 2.x, but maybe not.\n. Updated to make it cleaner to match tokens without false positives. Adding more exceptions adds more risk, but we can't guarantee perfection without a real tokenizer.\n. Not built in. Feel free to dig into Minify_HTML and make suggestions. Reopen a ticket if you think there's a way to add support.\n. Please see #576. It's not complete but you may help.. So we have to reject :\\/* as starting a comment.\n. PR #532 (master branch)\n. Fixed in #532\n. I need the particular source file which was processed incorrectly and approximately where in that file that things go wrong. Put the source file on pastebin.\nIf you have files there are already minified, make sure their names end with .min.js or -min.js\n. Debugging this is impossible without more info about where the \"unexpected token\" error occurs. You might try the version of JSMin that's in https://github.com/mrclay/minify/pull/537\n. I've merged #537. If that doesn't fix it, you can report it to https://github.com/mrclay/jsmin-php, but I'll need more info.\n. Should we just re-make this API to not depend on static state? Other suggestion?\n. What's the next on this? unmark @internal and document it somewhere?. There's a JS implementation of JSMin that creates maps. Wanna port it into mrclay/jsmin-php\n. I added the link to my comment.\n. Cool. Thanks!\n. I added a simple library to ease integration and overhauled the README.\n. I'm done fiddling with this. Please take it for a spin.\n. @shtse8 @glensc Have you tested this out? I don't want to merge with only my personal testing.. CDATA declarations aren't necessary unless you're serving XHTML as XML, and almost no one's doing that anymore. If they are, Minify_HTML already handles this: https://github.com/mrclay/minify/blob/2.x/min/lib/Minify/HTML.php#L239\nSee the constructor option: https://github.com/mrclay/minify/blob/2.x/min/lib/Minify/HTML.php#L64\n. What are the HTTP response headers for that request?\n. Resource interpreted as Stylesheet but transferred this is a problem with your PHP script response, not Minify. Minify is returning Content-Type: application/x-javascript; charset=utf-8 as expected.\n. You are serving JS, you've already shown Minify is sending the correct Content-Type. This is not a Minify issue.\n. When I reorder the files it works: http://starmaroc-b.com/min/b=bootstrap-soon/js&f=kinetic.js,jquery.final-countdown.js,jquery.particleground.js,japp.js Not sure what this means as it shouldn't make a difference to Minify at all. Try clearing your (server) cached files and check your error logs.\n. There are cache files on the server that must be removed.\n. Use this script to see your cache directory:\nhttps://github.com/mrclay/minify/blob/2.x/min/server-info.php\nThe Minify filenames start with minify_.\n. Use the script I linked to (updated today), not the one that came with Minify.\n. Remove the files in /tmp that start with \"minify_\". E.g. cd /tmp && sudo rm -f minify_*\n. Please use the http://groups.google.com/group/minify group for further support.\n. I've added a commit in #552.\n. This is being removed in version 3.. Indeed looks like a bug. This function needs to bypass where URL starts with data: https://github.com/mrclay/minify/blob/master/lib/Minify/CSS/UriRewriter.php#L283\n. This was fixed a long time ago in https://github.com/mrclay/minify/commit/a2487c7c1af7080b9416ddffdc8284590a73f7b5. Perhaps you're using a separate component that alters URLs?. Can you send a pull request with passing tests?\n. Please send a PR if you want this feature.. In config.php: $min_serveOptions['encodeOutput'] = false;. Make sure it can write to your temp directory. It uses sys_get_temp_dir() to determine this or you can set it via $min_cachePath.. Please report this here: https://github.com/tubalmartin/YUI-CSS-compressor-PHP-port/issues make sure that it hasn't already been fixed.. If a URL is empty, it should be ignored. That's reasonable. You could make the change here and send a pull request. Test would be nice.. > the api has not changed\nThat was not my experience. Before this commit the version of leafo/scssphp that composer installed for me did not have the Leafo\\ScssPhp... classes, so Minify_ScssCssSource failed when testing.. I'd rather wait until this fix is accepted in the 3rd party project and copy that in once accepted.. My preference would be to fork @tubalmartin's repo and keep it a separate dependency with hope he'll return or an active fork will emerge.. Who wants to raise their hand to manage this fork and packagist entry?. Master branch now requires the updated cssmin dependency.. Please see https://github.com/mrclay/minify/blob/2.x/docs/CookBook.wiki.md#cssmin-php-port\nI'm not maintaining Minify_CSS_Compressor anymore, just too many issues, especially with PRCE crashes. You can try https://github.com/mrclay/minify/blob/2.x/docs/CommonProblems.wiki.md#phpapache-crashes. Good idea, thanks.. Please try the changes in #570. Cache ID varies by Minify_Source::getDigest(), which already includes source file paths (_id properties). The bug you're describing shouldn't be possible.. Ah I see. You could influence the cache IDs by something like this:\nphp\n$min_serveOptions['minifiers']['fake'] = $_GET['b'];. Eh, I'll revert this and do it in master.. Closure Compiler is significantly better than JSMin. If you can use it, do so.. I'm going to release 3.0 in a few weeks. Feel free to reopen if it remains a problem with the new one.. Version 3.0 will use a different CSSmin without this quirk. You can do this in 2.x.. You must turn off any auto-encoding that your PHP environment is doing. If you can't, you can try setting $min_serveOptions['encodeOutput'] = true; in config.php.\n. Would you mind moving this to master and adding a PHPUnit test?. I couldn't rebase.. you deleted your fork! Replaced by #576. @boynet Problem with this is that anything can be in HTML comments, so the following preg replaces may totally mangle them and the HTML. In the case we're preserving them, we need to instead replace comments with placeholders (see how we do this for style and script tags).. This is half-baked. Reopen with real solution.. We're no longer using this. 3.0 (in a couple weeks) will use https://github.com/tubalmartin/YUI-CSS-compressor-PHP-port. I'm no longer supporting the 2.x default Minify_CSS_Compressor class. Please see https://github.com/mrclay/minify/blob/2.x/docs/CookBook.wiki.md#cssmin-php-port.. Yeah, 3.0 is losing the local copy and it's fixed there. Thanks. The JSMin is in https://github.com/mrclay/jsmin-php. It only leaves comments that start with /*! purposefully to retain things like copyrights, etc.. Thanks! Merged in d95690abc9734e51321fd9d633ce111a3d4c1eff with some minor changes.. Thanks. This needs a reasonable commit summary and update of the unit tests so they pass.. Good report, I'll look for that.. Fixed in 62370404c86f415c6ef89f8739861298ec3b5656. Run composer install to update vendors and re-generate the autoloader.. Run composer install to update your vendors.\nThe old JSMin was replaced by JSMin\\JSMin, provided by the mrclay/jsmin-php package.. Yes it's autoloaded. It's in vendor/composer/autoload_namespaces.php.. My plan was: 3.x is for fixes and new features. master for breaking changes.. Sounds good. I'll get to this later.. See #599. Thanks! Please submit bugs to https://github.com/tubalmartin/YUI-CSS-compressor-PHP-port. I'm open to updating our copy in the 2.x branch, but there won't be more 2.x releases unless a security issue is found.. Hi, Minify now uses CSSMin from a separate project. Here's the docs for using this in Minify 2.x: https://github.com/mrclay/minify/blob/a36e201ab285ac6208e077a295da15041035e35e/docs/CookBook.wiki.md#cssmin-php-port. Two solutions: https://github.com/mrclay/minify/blob/3.0.0/docs/UserGuide.wiki.md#far-future-expires-headers (also works in 2.x) or https://github.com/mrclay/minify/tree/3.0.0/static . On my machine Minify is at the URL path /local/minify/. In config I set:\n$min_symlinks = array('//root' => __DIR__);\nI requested /local/minify/?f=root/quick-test.css and it worked correctly:\n```\ndocRoot    : /Users/steve/Sites\ncurrentDir : /Users/steve/Sites/local/minify\nsymlinks : array (\n  '/Users/steve/Sites/root' => '/Users/steve/Sites/local/minify',\n)\nfile-relative URI  : more.css\npath prepended     : /Users/steve/Sites/local/minify/more.css\nsymlink unresolved : /Users/steve/Sites/root/more.css\ndocroot stripped   : /root/more.css\ntraversals removed : /root/more.css\n```\nThis is 3.x.. Yes, my $min_symlinks value was available in Minify_CSSmin::minify. I'll try with static tomorrow, indeed may be a bug there.. Sorry. The test data sets are very intertwined at this point.. All tests should pass. You can either adjust them so they do or it'll have to wait until someone else can do it.. @glensc If you're cool with this, merge and tag 3.0.1. You should have push privs.. That's what the ?v= argument is for. Just update the number with each deploy (Minify internally invalidates its internal cache from the filemtimes). Otherwise check out https://github.com/mrclay/minify/blob/master/static/README.md. You can install it with Composer locally then copy the files--including the vendor directory--to your host.. This is normal operation https://github.com/mrclay/minify/blob/master/docs/UriRewriting.wiki.md. Check your error log for warnings/notices. Have you run composer install and are you properly including vendor/autoload.php so that JSMin\\JSMin class can be loaded?. SGTM. Is this testable? Any thoughts @glensc?. You have the wrong software repo. This is a library with nothing to click :). I went ahead and tagged 3.0.2 /cc @glensc . I don't have anything to do with the WP plugin, sorry.. Sorry I did misread. You want to file this with CSSmin or just try updating it via composer. It may already be fixed.. I assume this is to allow ?123 to trigger long expires. Why is this needed?\n. Can you give some examples of using this? Long URLs are definitely a problem, but I'd like this to be documented somewhere.\n. Change this to \"Get a unique cache ID for this request. Generate one if not given in options.\"\n. cacheId needs docs in this section. E.g. 'cacheId' : manually set a specific cache ID/filename to be used for this request (default: null). You will generally not want to set this.\n. Please do not include major whitespace changes in a PR for functionality. If you think Minify should adopt a certain WS/coding standard, please open a separate ticket for that.\n. I need to maintain backwards compatibility here. If someone does not set the doctype key, but does set xhtml, we should use either xhtml or html5\n. This needs to say what values are valid\n. We should validate the string here and set to null if not a valid value.\n. ...then we won't need these checks here.\n. I'd rather this be named MAX_BYTES_DEFAULT. When I see \"OPTIONS_\" I think it's going to be another key name.\n. We don't need this constant. Just have any empty() value e.g. 0 indicate no limit.\n. if ($this->maxBytes) {\n. These should be documented in the $options @param\n. Thank you for including tests! Sorry it's a ghetto DIY suite instead of PHPUnit\n. Shouldn't this be > 0?\n. I'd prefer a more strict pattern:\nphp\n  && !preg_match(`~^about\\:blank(#.*)?~`, $uri) // about:blank\n. The patterns needs a starting anchor: ~about => ~^about\n. Let's use \"base\" for this key.\n. Lines 39, 42, 82: These array keys need to be base, test, and groups\n. Note this condition should've been just empty(). I've simplified this in master. I prefered to not check existence/readability of these files so implementers get instant feedback via PHP error. If the file were missing I think it would be bad to silently fallback to a different configuration.\n. This looks like the beginnings of a utility class. Can't this functionality be rolled into the existing ImportProcessor class?\n. What's the difference between this and Minify_Source? Why is it needed?\n. Do we actually need this null check? Let's just do:\nphp\nif ($source instanceof Minify_Source) {\n    $max = max($max, (int)$source->getLastModified());\n}\n. Looks like lastModified should never be null so we don't even need the cast.\n. Let's get rid of generic object support and require an object matching an interface instead (#116)\n. This particular change reduces readability IMO\n. Wonder why all these lines changed? Line endings?\n. This should actually be a Minify_CacheInterface. There's no benefit in forcing cache classes to extend this.\n. This gives us the future flexibility of setting up sources for any file extension. Though for now we could just add \"less\" to this pattern. We could also make it so you can set these handlers via config vars.\n. I'm thinking we should make this pattern somehow modifiable by option, but also have the default accept every major CSS/JS source file extension, e.g. js, css, less, scss, coffee. Any extensions without a handler will be caught anyway.\n. I debated having different exception classes for each of these failures.\n. This probably shouldn't be able to be disabled.\n. We're assuming anything not .css is JavaScript. Probably bad assumption.\n. Yes. Though I'm thinking we should simplify the handler process to extensions (not patterns).\n. ...instead of a pattern this would be an array of extensions. Then we add a getSupportedExtentions() method that the MinApp controller can pull from.\n. I'd prefer to keep this disabled by default\n. Let's add this to the top of min/index.php (so autoloading is available within the config file) and get rid of the option to set the \"libPath\".\n. It's disappointing we have to make the cache a dependency. Maybe we should add these handlers in the calling code instead of the constructor.\n. Can you explain this TODO a bit more? This looks done to me.\n. Sorry. I don't/didn't understand the question.\n. Oh I see. Sending in 0 (turning off time-based invalidation within the cache) is right, but the source object needs to invalidate the cache if any of the supporting files has changed.\n. I think at this point you want to check all the supporting file mtimes; invalidate the cache if any of them have changed; and store a private lastModified value that would just be read by getLastModified(). So I think you actually need to store two things in the cache: 1. the lessc array, and 2. the old max(all the files).\n. OK, that seems sufficient then.\n. Not a fan of mixing class definition with side effects: https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-1-basic-coding-standard.md#23-side-effects\n. I think this is an improvement. Can we not just mv packer to be PSR-0 compat?\n. Let's make it $min_concatOnly = false;\n. php\nif (!empty($min_concatOnly)) {\n    $min_serveOptions['concatOnly'] = true;\n}\n. This isn't a clean way to do this, and will prevent URIs from being rewritten in CSS, which is necessary even when not minifying. I'd rather set up the source objects so they don't do compression.\n. For JS, set $source->minifier = \"\". For CSS, $source->minifyOptions['compress'] = false;\n. This will break CSS URL rewriting sources. Also the sources must be altered much earlier in serve(). Otherwise these will generate the same cache ID as the normal sources.\n. Around this line would be better: https://github.com/santoja/minify/blob/master/min/lib/Minify.php#L255\n. lowercase array(\n. This is already in the JSMin project I think. Anyway we only need to make sure files are combined correctly.\n. Maybe add suffix=\"Test.php\" to the directory element? That should prevent TestCase.php from being included in the suite.\n. Hmm, this looks like the default anyway. https://github.com/sebastianbergmann/phpunit/blob/5.0/src/Util/Configuration.php#L868\n. We also need \n\"require-dev\": {\n    \"phpunit/phpunit\": \"5.0.*\"\n},\n. This isn't an issue in PHPUnit 5.\n. Hmm, the existing logic demands that the file be in all allowDirs, not any. Big bug!\n. Also rtrim both of these.\n. Don't even do the preg_match; lcfirst() is safe to use either way.\n. BTW, you can ignore this comment, I've filed #497 \n. Please make this private, replace the line comments with a summary in the phpdoc, and for the $path specify that this only handles absolute file paths.\n. What if SERVER_SOFTWARE is \"nginx\"? Maybe we should not check this at all and only throw if SCRIPT_FILENAME or SCRIPT_NAME is missing?\n. We should also throw if the result of this calculation is \"\" or \"/\". In CLI, I think both SCRIPT_FILENAME and SCRIPT_NAME will be the same.\n. Should probably be in \"suggest\" right?\n. Does the default operation preserve comments? If so I think we should just add usage to the cookbook.\n. It's what jsmin.c and the PHP port does.\n. Where should it go?\n. I think Minify::serve. Just getting components shouldn't alter global state.\n. I don't want to mess with process in 2.x. See if the master branch fixes whatever issue you're having.\n. My latest commit handles this for the upcoming 3.0. In 2.x, you should manually set $_SERVER['DOCUMENT_ROOT'].\n. Oops meant to comment out before commit. Thx.\n. will do\n. Extract this last argument to a variable\n. Extract pattern to variable\n. Actually I'd rather break PSR2 for these than sacrifice legibility.\n. Move this to a $defaults array\n. The function call adds a single return opcode. File under micro-optimization; not worth changing.. Thanks for checking, but you missed the preceding t(?:. Shorten this group to t(?:itle) and you'll see how this works.. Didn't want to add these uses? Fine with me either way.. ",
    "MarkVaughn": "Thanks for the response, didn't know the FAQ was there, \nIn  any case if it's true that 8000 characters is the magic number I'm sure that some people wouldn't mind adding 1 byte where they saved a few hundred thousand :)\nSo if the introduceLinebreaks could have multiple options like \n0=>off/1=>sparingly (current) / 2=> aesthetic / 3=> by file /4=>user defined (could be defined in constants)\n2: Where  text could be chunked to 8000-81000 characters before compressing, then find the last \"}\\n\" as break point  after the con\n3: As some people combine an array of smaller files they might not even exceed 8000 chars each so that may be an option for some people to have each line represent one of their files\n4: There could be a predefined comment syntax where the developer can request a break for minify e.g: /break/\nThese other options might be slower for the processing and might keep a few bytes where some could have been saved, but I think in some environments it might be useful to control this. (in the files /break options I could actually know by the line number what file group a certain declaration is in before needing to open a search box)\nIn any case, just a few Ideas thanks for the response and keep up the great work, (or don't, you owe us nothing :D) \nOh and if you want I could try implementing this feature if it's to time consuming for you.  Let me know\n. ",
    "jdespatis": "Hello Steve,\nI guess I have the same problem, I've upgraded HTML.php from 2.1.3 to last git 2.1.4 I guess\nOn 2.1.3, I was able to comment the code:\n```// use newlines before 1st attribute in open tags (to limit line lengths)\n//$this->_html = preg_replace('/(<[a-z-]+)\\s+([^>]+>)/i', \"$1\\n$2\", $this->_html);\n```\nAnd with this little change, I could get all my html code on one line (which is what I want)\nBut it doesn't seem to be possible anymore to do that with 2.1.4, even with this small fix, I get a bunch of new lines\n=> I would like so much to have this new setting you're talking about Steve: introduceLinebreaks. Do you think it's possible?\nFor now I revert to 2.1.3\n```\n. ",
    "lencioni": "Here's a quick patch:\n```\n--- ClosureCompiler.orig.php    2011-09-05 17:03:12.000000000 -0500\n+++ ClosureCompiler.php 2011-10-07 13:25:24.991299000 -0500\n@@ -69,20 +69,33 @@\n         }\n         return $response;\n     }\n-  \n+\n     protected $_fallbackFunc = null;\n protected function _getResponse($postBody)\n {\n\n\n$contents = file_get_contents(self::URL, false, stream_context_create(array(\n'http' => array(\n'method' => 'POST',\n'header' => 'Content-type: application/x-www-form-urlencoded',\n'content' => $postBody,\n'max_redirects' => 0,\n'timeout' => 15,\n)\n)));\nif (ini_get('allow_url_fopen')) {\n$contents = file_get_contents(self::URL, false, stream_context_create(array(\n'http' => array(\n'method' => 'POST',\n'header' => 'Content-type: application/x-www-form-urlencoded',\n'content' => $postBody,\n'max_redirects' => 0,\n'timeout' => 15,\n)\n)));\n} else {\n$ch = curl_init(self::URL);\ncurl_setopt($ch, CURLOPT_POST, true);\ncurl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-type: application/x-www-form-urlencoded'));\ncurl_setopt($ch, CURLOPT_POSTFIELDS, $postBody);\ncurl_setopt($ch, CURLOPT_FOLLOWLOCATION, false);\ncurl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 15);\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n$contents = curl_exec($ch);\ncurl_close($ch);\n}\n+\n         if (false === $contents) {\n             throw new Minify_JS_ClosureCompiler_Exception(\n                \"No HTTP response from server\"\n```\n\nAlthough, I see a bunch of messages like this in my finished JS:\n/* Received errors from Closure Compiler API:\nError(22): Too many compiles performed recently.  Try again later.\n(Using fallback minifier)\n*/\n. I assume there are fewer API calls because now I just get the following error: \"Minify: Exception in minifier: POST content larger than 200000 bytes\"\n. Done\n. Let me know if there is anything I can do to help resolve this issue.\n. Boom, awesome. That is exactly what I was hoping for. Thanks!\n. ",
    "SimonSimCity": "No, I have not tested it yet. Thanks for the respond.\nI'll add/change a unit-test for it.\n. Now I've updated the unittest.\nPlease check it and let me know if you need more information.\n. I've seen that you've done some work on a file I changed too ... let me merge the two commits, run the tests and create a new pull-request.\n. ",
    "meven": "see issue #18\n. ",
    "DevDavido": "missing : in conditional expression\n\n. ",
    "glensc": "no need to make new PR if you haven't merged. pushes to same branch will be stacked to existing pull req :)\n. can you pull now, or something else to do?\n. hmm, where did you merge this? or you forgot to push?\n. well currently it seems you just closed pull request without merging\ni.e no new change in here: https://github.com/mrclay/minify\n. anyway, i added testsuite for this :\nhttps://github.com/glensc/minify/tree/issue-28\ni tried to link that branch to this issue (without creating pull request with another issue), but failed\n. how about just adding count() of files in group to existing mtime value? chances it will get the old value with just adding new file to group are really small (you need then to have all group members mtime be decreased by amount of files being added to group and that's just not that realistic than just having all files in group with same mtime)\nunfortunately $this->_filePaths is empty in groups mode, need to dig more how to get access to files in groups\n. i wonder, is the original mtime calculation still needed?\nas i see two paths:\n1)\n- modify Minify_HTML_Helper::setGroup and fill $this->_filePathChecksum with new method similar to getLastModified, which does crc32(serialize($filepaths))\n- modify Minify_HTML_Helper::getRawUri and append $this->_filePathChecksum to the url, if it is not empty\n2)\nrename Minify_HTML_Helper::getLastModified and do the same in just one iteration over group members\nfor both remains question, perhaps should instead mathematically sum the _filePathChecksum with _lastModified instead of string concat, so the urls won't grow too long? or that would cause weird side effects...\nin fact i have patch ready for 1. already\n. correction: if we rename ->lastmodified to something new (combination of lastmod+filepath) then the result won't be that long, just one number. additionally need to run it over crc32 and do sprintf %u over it (to avoid 32/64 bit differences)\n. here's implementation for 1) - https://gist.github.com/2851198 \n. ping\n. i have forked already, linked to this issue as well, just wanted to know opinion which way to make next commit. but fine. i'll commit the 1) and you can merge:\nhttps://github.com/glensc/minify/tree/issue-28\ndo you really need pull request to merge from there? as that would create another issue in your repository\n. Okay, the checksum of file paths, is working okay, but there's still problem when i replace oldest file with even more older file, i think that here should additionally just sum mtimes together and take just last 4 bytes (to allow 32bit systems overflow and get same result as 64bit systems)\n. rewrite it once again, pls review whole branch diff\nhttps://github.com/glensc/minify/compare/master...issue-28\n. did you have time to review?\n. i think cacheId should be changed as well. otherwise client is told to fetch new content, with new url, however minify internally will still serve old content because for it nothing changed.\ncurrently it tried to understand how internal cacheId works, but i found it doesn't even use files or for it at all. i.e Minify::_getCacheId() has:\nprotected static function _getCacheId($prefix = 'minify')\n    {       \n        $name = preg_replace('/[^a-zA-Z0-9\\\\.=_,]/', '', self::$_controller->selectionId);\n        $name = preg_replace('/\\\\.+/', '.', $name);\n        $name = substr($name, 0, 200 - 34 - strlen($prefix));\n        $md5 = md5(serialize(array(\n            Minify_Source::getDigest(self::$_controller->sources)\n            ,self::$_options['minifiers'] \n            ,self::$_options['minifierOptions']\n            ,self::$_options['postprocessor']\n            ,self::$_options['bubbleCssImports']\n            ,self::VERSION\n        )));\n        return \"{$prefix}_{$name}_{$md5}\";\n    }\nand Minify_Source::getDigest has:\npublic static function getDigest($sources)\n    {  \n        $info = array();\n        foreach ($sources as $source) {\n            $info[] = array(\n                $source->_id, $source->minifier, $source->minifyOptions\n            );\n        }\n        return md5(serialize($info));\n    }\nam i looking something wrong? or this Minify_Source::getDigest shouldn't look mtime/content/path at all currently?\n. this can be closed now\n. oh, and worth to mention that the original commits came from https://github.com/Oyatel/minify\n. indeed, i have experience similar problems, and it's especially worse if you use local java process to do minifying (yui or closure compiler), especially for css as it spawns minify process for each source in a group\nhttps://github.com/mrclay/minify/blob/2.2.0/min/lib/Minify.php#L512\n. btw, the stack overflow bug is fixed in yuicompressor 2.4.7, released on 2011-11-14:\n+ Handle data urls without blowing up Java memory (regex)\n. test passes at this time. reporters problem seems network issue\n. any progress on this? i wanted to run some tests on commandline and got this issue again. and which of the proposed fixes you prefer, i could send PR based on it then\n. btw, return false from fopen can also happen if there's permission issue:\nPHP Warning:  fopen(/var/cache/scms/scms_c9b7e49a67428e048a8505bae5e33d6c.290.js): failed to open stream: Permission denied in /home/glen/scm/delfi/scms/vendor/mrclay/minify/min/lib/Minify/Cache/File.php on line 100\nPHP Warning:  flock() expects parameter 1 to be resource, boolean given in /home/glen/scm/delfi/scms/vendor/mrclay/minify/min/lib/Minify/Cache/File.php on line 101\nPHP Warning:  stream_get_contents() expects parameter 1 to be resource, boolean given in /home/glen/scm/delfi/scms/vendor/mrclay/minify/min/lib/Minify/Cache/File.php on line 102\nPHP Warning:  flock() expects parameter 1 to be resource, boolean given in /home/glen/scm/delfi/scms/vendor/mrclay/minify/min/lib/Minify/Cache/File.php on line 103\nPHP Warning:  fclose() expects parameter 1 to be resource, boolean given in /home/glen/scm/delfi/scms/vendor/mrclay/minify/min/lib/Minify/Cache/File.php on line 104\nPHP Warning:  fopen(/var/cache/scms/scms_71ef198e7a42717920f1a3b873cb3bb6.584.js): failed to open stream: Permission denied in /home/glen/scm/delfi/scms/vendor/mrclay/minify/min/lib/Minify/Cache/File.php on line 100\nPHP Warning:  flock() expects parameter 1 to be resource, boolean given in /home/glen/scm/delfi/scms/vendor/mrclay/minify/min/lib/Minify/Cache/File.php on line 101\nPHP Warning:  stream_get_contents() expects parameter 1 to be resource, boolean given in /home/glen/scm/delfi/scms/vendor/mrclay/minify/min/lib/Minify/Cache/File.php on line 102\nPHP Warning:  flock() expects parameter 1 to be resource, boolean given in /home/glen/scm/delfi/scms/vendor/mrclay/minify/min/lib/Minify/Cache/File.php on line 103\nPHP Warning:  fclose() expects parameter 1 to be resource, boolean given in /home/glen/scm/delfi/scms/vendor/mrclay/minify/min/lib/Minify/Cache/File.php on line 104\n. @kminh yes, but this issue is open because had some idea to solve it \"properly\"\n. that fast-closure-compiler is joke right? it's nodejs project, using python to spawn java processes, there are some more languages not being used in that project!\n. i mean why the npm bindings? seems like overkill ;)\nbut i myself solved similar problem like this: https://github.com/glensc/closure-compiler-httpserver\n. btw, is the python code neccessary for minify, maybe just execute ng directly from minify.\nand is libNailgunTest.jnilib absolutely neccessary?\nalso is @evanw repository dead? as i needed to do some more changes to get it compiled on my linux, i was thinking about sending PR\n. why you closed this PR? i don't see it merged. how do you use with current code nailgun loader?\n. my editor made those changes automatically. i'll try to push -f reverse diff for those\ni think it would help if you put to your project root .editorconfig: http://editorconfig.org/\n. the move is complete afaik. i mean the YUI-CSS-compressor-PHP-port for CSS handling is there\n. @mrclay i believe this is now fixed with cssmin sync with #123?\n. could you rebase (and squash) it instead?\ni can't test wincache myself, so i assume test passed?\n. classloader being reworked in #126\n. @mrclay this can be closed\n. you should report this to upstream, which is https://github.com/tubalmartin/YUI-CSS-compressor-PHP-port.\nmin/lib/CSSmin.php is copy from that project\nand when it's fixed in there, you can make ticket to ask to update from upstream project ...\n. https://github.com/tubalmartin/YUI-CSS-compressor-PHP-port/pull/18\n. fix integrated with #123\n. Perhaps have import support secondary priority, as if you use less without import directive the file caching won't be a big problem. you can use multiple sources instead of importing from .less\n. I actually use minify as library, as the existing frontend provided by minify needed changes\n. actually, seems lessphp php interface itself supports handling sources and caching, so perhaps write custom formatter for lessphp, let lessphp do the caching, and do css  rewriting in lessphp_output_formatter?\nfor  this to work, lessphp needs as input filename, current implementation setups lessphp as minifier, i.e gets input as string of file contents, not filename\n. I don't quite really understand how #114 ties together with overall picture.\ni understand own Source class comes back, i.e LessCss_Source extends Minify_Source but how Minify_Controller_MinApp for example is supposed to create Less_Source instead of Minify_Source based on file extension?\nas directly creating LessCss_Source objects in groups config is somewhat annoying:\nphp\n    'less2' => new LessCss_Source(array(\n        'filepath' => \"$t/lesstest.less\",\n    )),\nand that won't be solution for using $_GET['f']\none idea was to patch MinApp:\n``` php\n    /\n     * @param string $file\n     \n     * @param array $cOptions\n     \n     * @return Minify_Source\n     */\n    protected function _getFileSource($file, $cOptions)\n    {\n        $spec['filepath'] = $file;\n        if ($cOptions['noMinPattern'] && preg_match($cOptions['noMinPattern'], basename($file))) {\n            if (preg_match('~.css$~i', $file)) {\n                $spec['minifyOptions']['compress'] = false;\n            } else {\n                $spec['minifier'] = '';\n            }\n        }\n    if (pathinfo($file, PATHINFO_EXTENSION) == 'less') {\n        return new LessCss_Source($spec);\n    }\n    return new Minify_Source($spec);\n}\n\n```\nthis would solve my usecases (I'm using MinApp only), but not other controllers?\nalso, i would like to get access to Minify cache object in LessCss_Source, to do something like this:\n``` php\n // load the cache\n        $cacheFile = $inputFile . \".cache\";\n    if (file_exists($cacheFile)) {\n        $cache = unserialize(file_get_contents($cacheFile));\n    } else {\n        $cache = $inputFile;\n    }\n\n``\n. AndLessCss_Sourceneeds access to Minify Cache, how to do that? the factory should pass the cache object ifLessCss_Sourceneeds it? stupid simple way would be to see if the class hassetCachemethods via Reflection and then call$source->setCache($this->getCache())` ?\n. cache is needed for this particular class, not sure what other usecases would be.\n. MinApp didn't itself have cache object, so DI would not had worked, so I added this: #120\n. The LessCss_Source committed here works. altho rebased to current master, still requires surrounding changes to work properly, but can be reviewed still\nDoes Minify have a way to enforce cache invalidation by itself? i've passed \"0\" as isValid call, as lessphp itself invalidates the cache. \nAlso, the cacheId generation could be somehow reused, perhaps in Source base class?\nAlso wanted to ask, what is the proper name of the Less Source class?\nAlso I think the actual LessCss_Minify class is not needed if Source class is integrated properly and should be dropped.\n. FYI: my dirty WIP branch where all neccessary things are in place: https://github.com/glensc/minify/tree/lessphp-dev3\ncommit history is dirty, but that branch is not intended for merge\n. So, what now? I really haven't got what should happen next, you haven't really given answers to my questions...\n. i set back text/css in a branch. and i asked should the other class be dropped, etc. did not get answers so this pr not updated\nWIP_dynamic_objects looks good. will do some testing on it. currently briefly went over the code and did not see how to add lesscss source class (still haven't got answer how to name it).\n. You can see what's changed on branch, if you click files tab on the diff: https://github.com/glensc/minify/compare/mrclay:WIP_dynamic_objects...lessphp-dev3\nbut anyway, created new PR for comments: #124\n. merged with #124\n. i have reworked autoloader a bit, but i haven't merged it yet because i'm not sure where's the branch it should be merged into :D. @mrclay: 3.0 branch?\n. @jrchamp it's in dirty branch, which contains merged code from different branches. so as i haven't made PR i can't really say on what branch it is :D and i think such change should go to 3.0 branch as semver dicdates\n. classloader rework: #126\n. i've committed first change: https://github.com/glensc/minify/compare/lastmodified\none unit test failed, so i kept the backward compatible property check as well.\nhowever, the unit test should be probably changed to use Minify_Source, right?\nit probably doesn't hurt to keep the current fallback.\nalso, i would convert the unit test to phpunit, but i'm not sure how to run phpunit from web context\nand from cli context i'm sure emulating the environment will go wrong (all those $_SERVER variables)\n. What about the change itself? :)\n. this is done in 3.0 branch afaik? close ticket?\n. why did you create two new pull requests (#118, #119) if you could just push -f over the existing PR...\n. just merged to master with cherry pick 153e08b5a0ad16fbeb5d7bd6494225914b1840e9\nas you did not do the rebase/squash against master as asked, instead created two more pull requests. hope this will stop your PR flood on same topic.\nwe actually are not interested on code style fixes at this time.\n. I was thinking, maybe add also Null cache implementing the methods that do nothing. this way the code will look simplier even if cache is not configured:\ninstead of\n``` php\nif ($this->cache) {\n  $this->cache->fetch();\n}\n...\nsome other cool code\n...\nif ($this->cache) {\n  $this->cache->store();\n}\n```\ni could just omit the if ($this->cache) statements\nand in getCache if self::$_cache is not set, do:\nphp\n           self::$_cache = new Minify_Cache_Null();\n. I prefer make small steps, then there's chance it will still work, and if bugs appear then they are easy to fix :)\nis this PR ready to be merged or you want Abstract changed to Interface? or add Interface as well?\n. Probably should merge this manually and to 3.0\n. looks good now? and merge this to 3.0 or master?\nwhat's the goal with 3.0? i mean why it's branch not just 'master'?\n. so, need another rename (to Minify_CacheInterface) or merge it?\n. Looks good. min_unit_tests passed, tested with my app too. seems working. \n. so, should i clean and rebase this branch (remove config changes) so you could merge it? and rebase against what branch? and i'm still not clear how this less source class be named in minify tree.\ni'd start with sassphp support, library cames from same vendor, so i don't expect any hard work in there.\n. recreated as clean version ready to be merged\n. in dev version i had some more verbose optional loader that is able to print hint to errorlog:\n``` php\n        $success = @include $map[$class];\n        if ($success !== false) {\n            return;\n        }\n    $errors = array(\n        'JavascriptPacker' => 'http://code.google.com/p/minify/source/browse/trunk/min/lib/Minify/Packer.php',\n    );\n\n    $error = \"The script \\\"{$map[$class]}}\\\" is required\";\n    if (isset($errors[$class])) {\n        $error .= \". Please see: {$errors[$class]}\";\n    }\n\n```\nare you interested in that too?\n. my next step is to add vendor/autoload.php.dist, that can load vendor/autoload.php if exists, fallback to Minify_Loader. append to this PR or make new PR for that?\n. so, in process, remove bundled copies of libraries as well. right?\n. current composer config already uses classmap. i would not change that now\n. you can always use http://phpab.net to generate autoloader if project is missing and do not want to use composer\n. @mrclay something like this? or move the bootstrap.php to min dir? to project root dir?\n. @mrclay any comments to my last https://github.com/mrclay/minify/pull/126#issuecomment-59469509 change? about https://github.com/glensc/minify/commit/0e9e1237c62067074cd13e5f3beea1dff2a4283a\n. #538\n. they are suggested now, and present in require-dev for development\nare you sure you want to enforce as hard dependency? i for example don't use firephp in production.\n. change made.\n. wrong channel. this is php based minify application\n. @mrclay i needed similar solution long time ago. i'll definately have look. it will take some time to get my test site up to check this.\n. you mean create \"minify-archive\" project? i.e have two separate \"minify\" projects?\nor export to new GH project as step for merging it further?\ndefinately should not lose 139 issues/pr's in current GH project!\nso, don't quite follow.\n. how do you merge tickets?\n. @KTOmega yes, move the readme changes to separate PR\n. why? you can rebase, squash, amend, etc this one and push -f this one, and create only one new pr\n. you should do two commits:\n1) rename the file\n2) do markdown related changes\nplease don't open yet another pr to do so, you can push -f and redo all commits as long as you push to same branch\n. @mrclay what was your opinion to add phpunit based testing?\ni would like to add new processor using nailgun to launch closure compiler.\ni would like to add unit test there, but i find phpunit test setup more stright forward than the webbased tests you have now.\nthe current tests can stay, as still need to test with browser.\nbut  the new test i plan to add, would be just testing the new class.\nso, if you say +1, would be appropriate to add second unit test tree?:\n- /phpunit.xml\n- /tests/FooTest.php\n- /tests/Foo2Test.php\nor mix with current /min_unit_tests/ ?\n. unit tests were ported to phpunit in #486\n. seems related: #28\nso could be closed as duplicate of #41 ?\n. i suggest to move cli as separate project (minifier-cli) and use box to build phar. maybe even implement self-update if intending to publish .phars somewhere (bintray?) :)\ni've done the .phar part in eventum-cli\n. yes, #51 and #94\n. 2.1.7 was the version the original bug was reported against\nwhich was released in 2013: https://github.com/mrclay/minify/releases/tag/2.1.7\n3553016a243cdc2366f1dd1b322e94d11185bc7c was committed in 2015\nmake your calculations.\nyou can probably hotfix your code using the patch url:\nhttps://github.com/mrclay/minify/commit/3553016a243cdc2366f1dd1b322e94d11185bc7c.patch\n. that minifier is @deprecated Use CSSmin (tubalmartin/cssmin)\n. the tags were imported from googlecode, don't know what the mean\n. ok, seems the PR was rejected and never merged: #141\n. so, if you wish this to be on master branch as well, rebase against master and make new pr:\nhttps://github.com/mrclay/minify/pull/141#issuecomment-144074104\nthis is the tree you should rebase:\nhttps://github.com/KTOmega/minify/tree/css-fixes\nsomething like this:\n$ git clone https://github.com/KTOmega/minify -b css-fixes\n. i'm not following. you mean git mv composer.json min/ ?\n. @GrahamCampbell care to explain your down-vote?\n. LGTM\n. as with pre-flight, you may also want to specify ttl of the OPTION requests, etc \nhttps://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS\n. well, realpath works for files only, it returns false for urls, so it will fail already now:\nhttps://github.com/mrclay/minify/blob/e596b35fc400611d160183697284401178f1a013/lib/Minify/ImportProcessor.php#L62\nso the change is trivial, so either explode() with ? or use pathinfo() or parse_url() to get path without query string\n. Fixed via #485\n. fixed with #485\n. the \"File '{$spec['filepath']}' is outside \\$allowDirs.\" came to me as suprise too when upgrading to 3.0.\nbut indeed, 3.0 is not released, and i did not read changelog, even if it exists :)\n. i would suggest making efforts using master version (report bugs, make pull requests). it seems to function although i do not use it myself in production yet either.\n. should be solved with 72ae74f1c, similar problem as #496, #497, #498\n. yes, that is what i used\n. okay. will convert as much possible (those that don't need web env), then can decide further\n. do you have ideas how to solve this hack properly?\n7af644e3e165334a0b83ee09bae41174347f907e\n. do you have comments how to make Minify_Lines test to work?\nfirst I hacked DOCUMENT_ROOT value, but then it just outputs empty string.\nphp\n        $_SERVER['DOCUMENT_ROOT'] = __DIR__;\n. should test_Minify_CSS.php just be dropped as Minify_CSS is deprecated  as of 0bc37698?\n. what about this question?\nhttps://github.com/mrclay/minify/pull/486#issuecomment-158127266\n. why did you close this? i have not finished all tests convert!\n. seems continued in #491\n. i did not want to break backward compatibility, therefore the settable static properties remained\nalso dropped second execution of compiler command in case of error. this should be solved somehow better, i.e using proc_open, the actual error is currently shown to error_log anyway.\n. yes, used phpunit tests to test, it passed before and after the changes :)\n. it was fixed second later i committed error: 0873db81b9e3cea4a74390b4dd1bb5690c18b1a7\nwhy is packagist still complaining?\n. it uses same logic as mentioned in #87, i.e commands as done in bin/compile\nstarts daemon if not running, and then doing compilation.\nit could be probably improved, using pidfile instead of ps(1) grep. what you think.\n. but i would still like to hear your opinion how to handle that daemon startup and checking that it is up\n. don't need to understand what is nailgun, just how the class works:\n- before calling closure compiler, need to start a server\n- start server checks processlist and launches process in background\ncurrently, as you can see it just uses ps(1) to check if process runs, and starts if it is not. it is imho not reliable, as it could match wrong processess (of different user, for example). i think should use pid file instead.\n. forcing phpunit 5 makes travis tests to be not ran for older php version. this is not good\n. seems it works with phpunit 4.8 as well. so lowered the dependency\n. doing so, would mean:\n:+1:\n- cleaner interface\n- can actually log or throw to see if there are errors from remote service\n- will not send out original code (could be security issue)\n- can point to file/line of the syntax error\n- obtain compression statistics\n- optionally log warnings\n:-1: \n- no longer always send out valid javascript (*)\n(*) except network errors of course ;)\nso yes, fallback minifier seems neccessary.\n. btw, i wonder does anybody even use this service in production? the api limit seems to last for an hour (according to the error description), but not sure what is the treshold. and there seems no way to have bigger api limit (i.e using access tokens or similar)\n. this PR replaces #496 ?\n. installation says:\n- git checkout from github (not clear where you got it)\n- run composer with --no-dev\nand 3.0 is not released yet, if it will be, then it should contain dependencies in release tarball, no need to run composer then.\n. user installed without following instructions, no feedback from user either over a month, closing\n. eh, i just stumbled upon this bug as well when trying to run minify app (i usually just use own frontend using minify classes, where allowDirs feature is not used)\nthere seems too many issues about the same bug in many forms, can't even figure out which one. i think i'll merge #496 myself tomorrow (making your requested changes myself) after you've accepted the formatting PR.\n. i think this is also resolved with #496\n. i tested with group with two js files, minifier was invoked only once.\nplease share your full config and groupsConfig definitions!\nalso, did you use g= or f= option?\n. how i would able to obtain sourcefactory?, the html helper is static method!\nreferenced branch where i cooked up meanwhile, probably overengineered but wanted to cache repeated calls to same data\n. the touch thing is what i want to avoid, that's not a solution\none way to pass factory i see is via $options array. i have my own frontend to minify, so i have the \"correct\" factory object available.\n. regarding DI, is Pimple way to go?\n. aside, do you see somehow the branch i created being accepted somehow without DI layer changes first?\n. Props seems ok, similar to Pimple\n. it is annoying without this PR. can't run tests without creating bunch of cruft to workaround.\nbasically one can set $this->config->docRoot, but Minify_Env would still call it's own docroot calculation and fail here with the error:\n\nInvalidArgumentException: DOCUMENT_ROOT is not provided and could not be computed\n\nhowever this PR no longer suits, because Props will throw another warning (which is converted to exception) by phpunit: Undefined index: SERVER_SOFTWARE\n <- no longer true, incorrectly applied chunks manually from this PR\ni mean Minify_Env constructor calls docRoot setup, which fails, and in the end the docRoot value is not even needed in the test.\n. how about you just accept this PR, the cli issues can be dealt later.\n. tests fail before these changes already\n1) closure-compiler gets rate limit error\n2) lessphp test that shows wrong behaviour\n3) closure-compiler errors not visible\n. and for sake of tracking, post issue link once you're done with bug report there\n. Installation clearly says you need the tools:\n\"Installation requires PHP 5.3+, SSH access, and access to tools like git and composer or the privileges to install them.\"\nhttps://git-scm.com/\nhttps://getcomposer.org/\n. afaik it's not ready, but should be functional on most parts. i planned to use it in production, but got carried away with other priorities.\nthere's this issue: #499 could mean that caching is totally broken, or it's that specific user problem. don't know.\n. ah, if you use as library, just use dev-master#githash\n. @mrclay yeah, why not\nbut try to limit changes, otherwise we end up with two 3.0 versions :D\n. yea, in github project settings you can point HEAD to different branch than master, i think it's good idea rather\n. from diff looks good, i will probably give it a test sometime soon!\n. yes! i already forget this was PR was not merged :)\n. LGTM!\n. btw, you have two 2.1.5 tags pushed to github: https://github.com/mrclay/minify/releases\n. please make this against master branch, the 2.x branch is in maintenance mode. i guess script in bin is fine.\nif i would write that script, i would but put the code in class, leave the bin script just think wrapper to initialize autoloader and run the class.\n. is that only place that attempts to get App from bootstrap?\nmaybe add setApp method somewhere,\nand in bootstrap require autoload only if some base class from Minify is missing?\ni also mislooked, it is possible to set app instance:\nhttps://github.com/mrclay/minify/blob/de39966e9c2ba90b7e400f92b867f6592e34046f/lib/Minify/HTML/Helper.php#L169-L172\nbut the method itself is marked @internal and not sure are there more places that need prior app($app) calls\n. add link?\n. ah. it's in JavaScript. otherwise I would suggest to merge two projects.\n. no i have not tested. don't need the feature.. @mrclay i would like to get this merged. the PR is ready for merge.\n. 5fb7ea1e disabled method_argument_space:\n1. MrClay/Cli/Arg.php (braces)\n2. MrClay/Cli.php (braces)\n3. Minify.php (braces)\n4. Minify/HTML.php (braces)\n5. Minify/CSSmin.php (braces)\n6. Minify/DebugDetector.php (braces)\n7. Minify/Packer.php (braces)\n8. Minify/YUICompressor.php (indentation, braces)\n9. Minify/Env.php (braces)\n10. Minify/ImportProcessor.php (braces)\n11. Minify/Source/FactoryException.php (braces)\n12. Minify/Source/Factory.php (braces)\n13. Minify/CommentPreserver.php (braces)\n14. Minify/SourceSet.php (braces)\n15. Minify/JS/ClosureCompiler.php (braces)\n16. Minify/CacheInterface.php (braces)\n17. Minify/CSS.php (braces)\n18. Minify/ScssCssSource.php (indentation, braces)\n19. Minify/LessCssSource.php (braces)\n20. Minify/HTML/Helper.php (braces)\n21. Minify/ServeConfiguration.php (braces)\n22. Minify/Lines.php (braces)\n23. Minify/CSS/UriRewriter.php (braces)\n24. Minify/CSS/Compressor.php (braces)\n25. Minify/SourceInterface.php (braces)\n26. Minify/Controller/Base.php (braces)\n27. Minify/Controller/Groups.php (braces)\n28. Minify/Controller/Page.php (braces)\n29. Minify/Controller/MinApp.php (braces)\n30. Minify/Controller/Files.php (braces)\n31. Minify/ControllerInterface.php (braces)\n32. Minify/Cache/Null.php (braces)\n33. Minify/Cache/Memcache.php (indentation, braces)\n34. Minify/Cache/APC.php (braces)\n35. Minify/Cache/File.php (indentation, braces)\n36. Minify/Cache/WinCache.php (lowercase_constants)\n37. Minify/Cache/ZendPlatform.php (braces)\n38. Minify/Cache/XCache.php (braces)\n39. Minify/App.php (braces)\n40. Minify/Source.php (switch_case_space, braces)\n41. Minify/Build.php (indentation, braces)\n42. HTTP/ConditionalGet.php (braces)\n43. HTTP/Encoder.php (braces)\n. continued in #552\n. @elvispdosreis missing context. did you ran some linter? what do you expect to change here? and what's your version? origin of the code (zip download? git checkout?)? php version?\n. @mrclay use permalinks (commit, tag) not branch in links, the line number may change over time and even the file be removed\n. @mrclay any comments?. No version info provided. aside, here are curl request reproducing the problem:\nresponse is gzip compressed:\n```\n\u2794 curl -s 'https://www.hmhship.com/min/?f=/min/quick-test.css&debug=1' -H 'If-None-Match: \"pub1482439458;gz\"' -H 'Accept-Encoding: gzip, deflate, sdch, br' -H 'Accept-Language: et,en;q=0.8,en-US;q=0.6,ru;q=0.4' -H 'Upgrade-Insecure-Requests: 1' -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.100 Safari/537.36' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8' -H 'Cache-Control: max-age=0' -H 'Cookie: X-Mapping-fjhppofk=AB645B0CAE1BE6405643D25CBFCBE4B7' -H 'Connection: keep-alive' -H 'If-Modified-Since: Thu, 22 Dec 2016 20:44:18 GMT' --compressed|file -\n/dev/stdin: gzip compressed data, max compression, from Unix\n```\nthere's even Content-Encoding: gzip header:\n\u2794 curl -sI 'https://www.hmhship.com/min/?f=/min/quick-test.css&debug=1' -H 'If-None-Match: \"pub1482439458;gz\"' -H 'Accept-Encoding: gzip, deflate, sdch, br' -H 'Accept-Language: et,en;q=0.8,en-US;q=0.6,ru;q=0.4' -H 'Upgrade-Insecure-Requests: 1' -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.100 Safari/537.36' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8' -H 'Cache-Control: max-age=0' -H 'Cookie: X-Mapping-fjhppofk=AB645B0CAE1BE6405643D25CBFCBE4B7' -H 'Connection: keep-alive' -H 'If-Modified-Since: Thu, 22 Dec 2016 20:44:18 GMT' --compressed\nHTTP/1.1 200 OK\nServer: nginx/1.4.6 (Ubuntu)\nDate: Thu, 22 Dec 2016 21:05:24 GMT\nContent-Type: text/css; charset=utf-8\nContent-Length: 383\nConnection: keep-alive\nX-Powered-By: PHP/5.5.9-1ubuntu4.14\nVary: Accept-Encoding\nLast-Modified: Thu, 22 Dec 2016 20:44:18 GMT\nETag: \"pub1482439458;gz\"\nCache-Control: max-age=0\nContent-Encoding: gzip\nX-Server: hmhship-live\n. why? the api has not changed, could just relaxed the version construct. see my history in this very specific area.. hmm, need to recheck this. as i'm interested keeping 5.3 still tested in travis.. adding missing cross-reference https://github.com/tubalmartin/YUI-CSS-compressor-PHP-port/pull/34 @rusjoan should had added link here or there. duplicate: #565. version info: DateTime::getTimestamp requires php 5.3.0\nhttp://php.net/manual/en/datetime.gettimestamp.php. did you update 3.0 branch too?. refs 532a010e0eac8df5519ab4f717ec663ff64445da. i'm sorry, i currently use minify as composer vendor, not the app itself.. permalink for the above referred line\nhttps://github.com/mrclay/minify/blob/74042c87adea3f2f0700e896d508635a72ec14ac/lib/Minify/Controller/MinApp.php#L144\n. why did you close it? it's not even merged!. @mrclay pushed two commits to master branch, but i see there's also 3.x branch. should it be merged? i suggest drop the 3.x branch, and keep 2.x and master only as the current way is confusing.\nalso there's milestone 3.0 which is expired. i suggest renaming it to 3.0.0 and close it. would you please merge to proper branches and write down in readme your development model. currently seems my changes went to /dev/null.\naltho as this project does not have active development, to avoid confusion, i'd ditch 3.x branch and keep just master, and 3.x releases cut from master.. ping. you need to use the php api if you need to write css from php. i.e code css minifying yourself.. @mrclay i noticed two 2.1.5 tags present, i propose to delete the v2.1.5 one:\n\nf7d73dc - (tag: v2.1.5, tag: 2.1.5) Better docs, PHPDocs (5 years ago) \n\ncan be done this way from commandline:\n$ git push origin :v2.1.5. /u adds some kind of performance penalty, but i think it's worth the correctness.. tests pass. merging. @sprankhub never link to code on branches, use permalinks (git tag, git commit). in github just press y hotkey. fixed in your issue body.. @sprankhub to make your stats useful, include stats also with zlib compressed, nowadays html pages are sent mostly zlib compressed.. you should never create pull-request from your master branch. as anything you add to your master branch will be included to the pull-request.\nhowever. i can cherry-pick your first commit. but forcing https on environments that lack https support (openssl module, required ssl certs), can create more damage than keeping http:// protocol. so such change not okay for minor patch version.\nas you're stating http:// still works. i'd keep it in.. ran test locally. http:// url always redirects regardless of the passed parameters.\n```\n[~/scm/minify (pr-618)\u2605] \u2794 git diff\ndiff --git a/lib/Minify/JS/ClosureCompiler.php b/lib/Minify/JS/ClosureCompiler.php\nindex b842622..d87aa61 100644\n--- a/lib/Minify/JS/ClosureCompiler.php\n+++ b/lib/Minify/JS/ClosureCompiler.php\n@@ -54,7 +54,7 @@ class Minify_JS_ClosureCompiler\n     /*\n      * @var string $url URL of compiler server. defaults to Google's\n      /\n-    protected $serviceUrl = 'https://closure-compiler.appspot.com/compile';\n+    protected $serviceUrl = 'http://closure-compiler.appspot.com/compile';\n /**\n  * @var int $maxBytes The maximum JS size that can be sent to the compiler server in bytes\n\n[~/scm/minify (pr-618)\u2605] \u2794 phpunit tests/JsClosureCompilerTest.php\nPHPUnit 4.8.35 by Sebastian Bergmann and contributors.\nEE.E.EE\nTime: 1.5 seconds, Memory: 7.25MB\nThere were 5 errors:\n1) JsClosureCompilerTest::test1\nfile_get_contents(http://closure-compiler.appspot.com/compile): failed to open stream: Redirection limit reached, aborting\n/home/glen/scm/minify/lib/Minify/JS/ClosureCompiler.php:185\n/home/glen/scm/minify/lib/Minify/JS/ClosureCompiler.php:141\n/home/glen/scm/minify/lib/Minify/JS/ClosureCompiler.php:86\n/home/glen/scm/minify/tests/JsClosureCompilerTest.php:116\n/home/glen/scm/minify/tests/JsClosureCompilerTest.php:17\n```. duplicate: #618. wanted to add also travis more php versions, but can do that in separate PR.. this project adheres rfc6761 and rfc2606, so no. not sure what you mean...\nyou mean that second if is superfluous?\nphp\nif (isset($spec['encoding'])) {\n            if ('' !== $spec['encoding']) {. Can you add/update unit test?. I'll have look, currently I don't know, i only adopted @Ocramius code to current codebase.\n. Looks like the only difference is in constructor:\nphp\n case 'less' : $this->contentType = 'text/less';\n                   break;\n. i added null check because older php like 5.3 can't do isset() on non-variables. but isset() on variable with null value is true, so it's equivalent check to previous code.\n. original file had two \\r, line 29 and line 30. i'll try to remove them in separate commit\n. committed: ce109925aa11aa31e6b196aa7b931207ff936e5b\nso you should rebase to master as well\nas you were all doing this on github web, you need to switch commandline to do rebase with squash\n. There is benefit, if it's abstract class and implements some common methods. for example log(), or tmpdir(). i could convert it to interface instead of abstract class, but then there's no way it can supply some default methods.\n. i was thinking maybe each registered Source class could provide its patterns and later merge them\n. i would prefer to redo autoloader a bit having detecting composer and fall backing to internal loader (you can see it in my dev branch, click on \" Files changed\" for diff) which branch i should be making PR against? or need to wait you to finish your WIP branches?\n. i asked the TODO in initial PR, did not get response from you:\nDoes Minify have a way to enforce cache invalidation by itself?\ni've passed \"0\" as isValid call, as lessphp itself invalidates the cache.\n. I made it as this as you said earlier to do with DI & constructor. Initially i had it Minify::getCache()\n. Can Minify tell that all cache related to this Source needs to be discarded? I can't think of any, so if you can't neither, then the TODO can be marked done\n. That invalidation is done by lessphp parser on it's own, no need to do anything here in higher level (in minify source)\n. You mean instead if having $this->parsed i should just store $this->lastModified?\nthe above logic works like this:\n1. get lessphp cache structure from minify cache\n2. let lessphp validate the cache and rebuild it if invalid\nresult is that $cache always contains fresh content\nplease see how lessphp handles this: http://leafo.net/lessphp/docs/#compiling_automatically\n. This is to match behavior of composer autoloader. so you could $loader = require autoloader.php; and then do stuff with $loader.\n. - min/lib/Minify/Loader.php is old loader, file should be left as is or completely removed in favour of composer based autoloader\n- JavaScriptPacker is not hosted in minify repo, we don't control it\n. yes, tested that \"Test.php\" suffix, did not work, everything i tested, did not work, even directory exclude. so if you suggest something, test yourself first that it actually works :/\n. \"require-dev\" is for \"development purposes\", running tests, etc in this project (does not propagate when minify is used in other project require block)\nfor \"production\", i.e end users or loaded via dependencies, it's just \"require\" block, it's noted in readme too to add --no-dev\n. probably should add unit tests!\n. this looks like partial BOM strip, why not do correct 3 byte comparison?\n. i never liked the business logic in config file, why this has to stay in config?\n. :+1: for preserving php 5.3 support!\n. you just overwrite previous $files value here...\n. i would prefer if exit is called with integer parameter, and die for textual parameters. they are aliases in php, so this is just personal preference\n. would be nice to document behavior of this function, without having to read the code and think what it is doing.\n. I assume the library is semver compliant and pick 0.3 for php 5.3 and 0.6 for php 5.4+\n. I think they both should rather depend on new Base Source class or the support that these classes have added to Source class. i.e some kind of cleanup/refactoring (in separate PR)\n. noticed this myself too. will fix.\n. The code assumes the cache is not corrupted. so there is always 'files' key present with at least one entry.\n. will remove from here and other tests after PR being merged.\n. i'll try disabling method_argument_space\nactually i was looking for php-cs-fixer to solve the formatting issues that came up in previous PRs.\n. not certainly off-topic. if it's good/maintained/testable library, minify could switch to it.\nunfortunately PHP7+ limits such usage for now. minify works with php 5.3, i personally rely on that.. yeah. it became too ambiguous which one is imported if namespace not visible on the line\n  . ",
    "0b10011": ":+1:\n. ",
    "cobexer": "did this happen?\nthis currently blocks me from adopting minify to minify our css (all paths in the css are already as they should be in the final css - no rewriting required/allowed)\nthanks\n. ",
    "claviska": "I added the following to config.php:\nphp\nini_set('pcre.backtrack_limit', 20000000);\nini_set('pcre.recursion_limit', 20000000);\nI've confirmed via phpinfo() that the local values are in fact bumped up, but I'm still seeing the same result.  Based on what I just read, it seems like this would most likely be the problem.\n. It works when I update the values in php.ini to 1000000.  Any idea why the ini_set() method wouldn't be working?  Either way, I'd suggest at least a comment in the config file to save others some time.\n. ",
    "ndreckshage": "in case this helps...btw im posting this both here and minifys google support group, ill post answer in opposite place to help others if they have same issue...\n[30-Jul-2012 18:27:15] PHP Warning:  fopen() [function.fopen]: Unable to access /tmp/minify_g=js_d7db94b16560dc92a9e359b06c4b7d7a in /home/task/dev_html/min/lib/Minify/Cache/File.php on line 100\n[30-Jul-2012 18:27:15] PHP Warning:  fopen(/tmp/minify_g=js_d7db94b16560dc92a9e359b06c4b7d7a) [function.fopen]: failed to open stream: No such file or directory in /home/task/dev_html/min/lib/Minify/Cache/File.php on line 100\n[30-Jul-2012 18:27:15] PHP Warning:  flock() expects parameter 1 to be resource, boolean given in /home/task/dev_html/min/lib/Minify/Cache/File.php on line 101\n[30-Jul-2012 18:27:15] PHP Warning:  stream_get_contents() expects parameter 1 to be resource, boolean given in /home/task/dev_html/min/lib/Minify/Cache/File.php on line 102\n[30-Jul-2012 18:27:15] PHP Warning:  flock() expects parameter 1 to be resource, boolean given in /home/task/dev_html/min/lib/Minify/Cache/File.php on line 103\n[30-Jul-2012 18:27:15] PHP Warning:  fclose(): supplied argument is not a valid stream resource in /home/task/dev_html/min/lib/Minify/Cache/File.php on line 104\n. ",
    "eddiemonge": "What version of PHP are you using on the server?\n. ",
    "ablears": "I had this issue. I fixed it by changing the cache folder's user and group to www-data, so for anyone else with this problem make sure the cache folder has the correct ownership.\n. ",
    "deadbeef84": "It seems Oyatel already did it :)\nIt was a bit more complicated than I thought at first, to make it play nicely with composer you should remove includes/requires and rely on an autoloader instead. I'm guessing this makes merging this change a bit difficult if you still want to be able to use it without composer.\n. ",
    "blueyed": "+1 Looks good to me (had to make the same change)\n. ",
    "ukch": "Any update on this?\n. ",
    "cindreta": "hey man thank you for the fast replay, yeah here is the link on pastebin: http://pastebin.com/6wjKz8LP\ni've been using minify for years and never had this kind of an issue, maybe it's my apache config or something but every other CSS file ever was minifed without a problem. thx again.\n. i tested it on another icon font pack and it takes like 2mins to finish. could you explain the CSSMin config? how do i use that? why is this happening in the first place?\n. ",
    "enumag": ":+1: This is a must have!\n. ",
    "eminetto": "I agree with @enumag. This is a must have!\n. ",
    "barryvdh": "Using composer would be very nice!\n. ",
    "jrobeson": "@mrclay : is there any problems with merging this ?\n. @mrclay: can you also register it on packagist?\n. no sir.. thank you :)\n. already done.\n. on a related note: do you follow http://semver.org? that will help people decide on which versions to depend on.\n. ",
    "kminh": "Does #94 close this issue?\n. Hello,\nI'm currently using version 2.1.7 and I believe the above commit has not been applied. Can you check?\nThanks.\n. Sorry I saw the \"Release-2.1.5\" label so I thought it was expected to be included in 2.1.7.\nBut I believe this has not been merged with master yet: https://github.com/mrclay/minify/blob/master/lib/Minify/CSS/Compressor.php#L124 ?\nThanks for clarifying.\n. As a matter of preference, the current cache ID is too long and is too verbose, especially when serving the static cached files directly (not via ?f=).\nThis is also useful when you're not using Minify directly. For example I can serve http://example.com/cache/abcxyz123456789-custom-string.js with Minify and custom-string can be used to determine some characteristics of the file.\nI think this is an easy addition and contains no BC break.\n. The above link to the 3.0 branch returns 404. How stable is 3.0 and what PHP version does it require?\nUsing $min_serveOptions works too, but why should we use a closure when a simple setCacheId function and a little change to _getCacheId could work? $min_serveOptions is currently pretty messy IMO.\n. I won't be able to use version 3.0 then. Perhaps I will maintain a fork of 2.x for now and wait until 3.0 is thoroughly tested. Though if you could add setCacheId that would be great.\n. ",
    "Synchro": "It was really just a future-compatibility thing I ran into when auditing my JS - $.browser has been deprecated since Jan 2009 in jQuery 1.3 and was removed in 1.9. As for suggestions, you could fall back to vanilla JS to sniff IE:\njavascript\nif (/msie|MSIE/.test(navigator.userAgent)) {...\nThat would solve the jQuery 1.9 problem, but would still lock out versions of IE that are probably not broken, possibly some old flavours of Opera too. Alternatively you could use $.support I mentioned to spot specific features that you require. There are numerous examples of features that are unique to various versions of IE in this SE question.\n. That's what I meant about unterminated statements. It seems to be adding the semi-colons intermittently so it's clearly thinking about it before adding them. I'm ending up with things like this (In files that don't end in comments and contain all terminated statements) in non-debug mode, and it's breaking things:\njavascript\nx = 1;;\ny = 2;\nThat causes a \"TypeError: 'undefined' is not an object\" on the second line.\n. OK, so can you think of any reason why the semi colon would not be there when minifying either file by itself (and is not in the source files), but is there when they are minified together, given that it doesn't always add one?\n. ",
    "Paperback": "I had issues with a few javascript files causing a 500 error as well; although it might be different issues.\nMinify sometimes has false positives on regex and causes an error \nhttp://code.google.com/p/minify/wiki/CommonProblems\n. ",
    "sembrestels": "Thank you very much!\n. ",
    "kkamkou": "Hello Steve, any news here? It is hard to require your library with composer.\n. duplicates #56 \n. ",
    "jasonlewis": "Yeah tagging stable versions when available would be ideal. :+1:\n. Awesome, great stuff @mrclay. Really appreciate your work. :smile:\n. ",
    "pocesar": "it was a problem with Apache, need to set ThreadStackSize to a reasonable size in Windows, plus increase pcre limits\n. making it quiet made it work\n. nevermind, it's in the docs http://code.google.com/p/minify/wiki/AlternateFileLayouts\n. actually the workaround doesn't work for Kohana for example\n. need to use weird symlinks to make it work:\n'symlinks' => array(\n      '/' . substr(Kohana::$base_url, 0, -1) => (Kohana::$base_url !== '/' ? DOCROOT : '/')\n  ),\n. ",
    "CybotTM": "pls see new pull request.\n. yes, that was not intended, only commit https://github.com/netresearch/minify/commit/b93bf441aa3a45b37138dcb856f4d2afe2646098 should land in this pull request.,\n. ",
    "koichirose": "Yeah, but the browser only reports a 500 error. How can I log that $response somewhere?\nIt occurs, for example, in calls like this:\njs\n$(\"#stats\").dataTable({\n    \"sPaginationType\": \"full_numbers\",\n    \"aoColumnDefs\": [ \n                { \"iDataSort\": sortIndex, \"aTargets\": [ sortIndexTargets ] }\n    ],\n    \"bJQueryUI\": true, //notice this last comma\n});\n. this works great, thank you.\n. ",
    "drbombay14": "Is it (just) the parts where a /*@cc_on comes along that breaks when the preg_replace() is removed? If so then I can just stick with my changes. \nI'd say most folk are much more likely to come across a URL in a /* */ comment than a conditional comment, anyway. \n. ",
    "ashour": "Is this a problem with the default minification engine or another?\n. ",
    "gtraxx": "The problem is identified only under windows, no problem mac or linux\nMinify truncates the result after generating the CSS with Less (example with bootstrap 3)\n. The error is visible only Bootstrap 3, I have no error with jQuery UI or other (only with windows)\n. Should be forced to use CSSmin? Do you have an example of using it ? \nThanks :)\n. How did you forced CSSmin ?\nI analyze the problem because it is only with Bootstrap from 3 Less\n. Hi @mrclay, \nShould I add this function in config.php ?\n``` php\nfunction yuiCssPort($css, $options) {\n    $compressor = new CSSmin();\n    $css = $compressor->run($css, 9999999);\n$css = Minify_CSS_UriRewriter::rewrite(\n    $css,\n    $options['currentDir'],\n    isset($options['docRoot']) ? $options['docRoot'] : $_SERVER['DOCUMENT_ROOT'],\n    isset($options['symlinks']) ? $options['symlinks'] : array()\n);\nreturn $css;\n\n}\n$min_serveOptions['minifiers']['text/css'] = 'yuiCssPort';\n```\nYUICompressor is it necessary ?\nhttps://github.com/yui/yuicompressor/releases\nWith yuiCssPort also makes the apache crash.\n. yuiCssPort also makes the apache crash :/ \nDo you have a solution? CSSmin is can not be used ?\n. And in the htaccess ?\n. Hi, I also try to create the file \"autoload\" without \"composer\"\nBest Regards. I have installed composer and everything works wonderfully, \nthanks. ",
    "FabianKoestring": "Same Problem here. But my apache gets killed everytime i try to minify bootstrap.css.\n. Iam using the minified bootstrap3 version but the error is the same. I tried bootstrap.min.css and bootstrap-min.css.\n. Its caused by \nphp\n$css = preg_replace_callback('/\n                (?:              # non-capture\n                    \\\\s*\n                    [^~>+,\\\\s]+  # selector part\n                    \\\\s*\n                    [,>+~]       # combinators\n                )+\n                \\\\s*\n                [^~>+,\\\\s]+      # selector part\n                {                # open declaration block\n            /x'\n            ,array($this, '_selectorsCB'), $css);\nin Minify_CSS_Compressor::_process\n. Same there. Cssmin also makes the apache crash. ;(\n. +1\n. I've tested this. I cant get it to work. I raised the values for pcre.backtrack_limit and pcre.recursion_limit up to 100000000. But still my apache crashes after a few seconds.\n. Sry for spam.\n<IfModule mpm_winnt_module>\n   ThreadStackSize 8388608\n</IfModule>\nin http.conf worked for me.\n. ",
    "klevie": "I don't think that did the trick - it's already looking for https / http / etc and still returns:\n```\n  [RuntimeException]                                                                              \n  Failed to clone http://github.com/mrclay/minify.git via git, https and http protocols, aborting.  \n\n\ngit://github.com/mrclay/minify.git                                                            \n    fatal: Not a git repository (or any of the parent directories): .git                            \n\n\nhttps://github.com/mrclay/minify.git                                                          \n    fatal: Not a git repository (or any of the parent directories): .git                            \n\n\nhttp://github.com/mrclay/minify.git                                                           \n    fatal: Not a git repository (or any of the parent directories): .git        \n```\n. \n\n",
    "va5ja": "It has something to do with LF and CR chars and function isEOF(). The are a few newlines in plupload.full.min.js. And it is obviously working on Windows because of CR/LF difference.\n. Sorry. It also doesn't work on Windows and it has nothing to do with CR/LF. plupload.full.min.js uses uglify and the output of it is something that JSMin can't digest.\n. Sure, here: https://github.com/moxiecode/plupload/blob/master/js/plupload.full.min.js\n. ",
    "joscha": "@mrclay I made all the changes, please have another look!\n. @mrclay you are right. I fixed the condition and because the commit history got a bit messy, I fixed everything up and pushed it again as one commit. Please check and let me know if there is anything else missing.\n. any news on this?\n. @mrclay are you still thinking about merging this?\n. :heart: \n. yaaaaaay!\n. @mrclay The problem with the java call class is, that it checks for existence of the jar file, which does not work when parameters are added. I am happy to rework it, so the base works with both the java -jar call and nailgun.\nHave you had time to look at #84, yet? I'd love to go one by one.\n. @mrclay it would be awesome if you could have a look at #93 as I would love to have some tests ready before refactoring the class(es).\n. @glensc not a joke at all. Its an implementation of the closure compiler for Nailgun. Basically it holds a JVM process and spawns threads with the closure compiler. That way its blazingly fast with almost no memory requirements.\n. @glensc Yes, we have something similar for our CI environment, but within the Vagrant boxes we use for development is was too slow, because our codebase is quite big and we needed a cache within the service. The problem with the cache was that inside our dev environment we did not have enough RAM (the service used approx. 16GB RAM between ~100 developers). We now have that service on EC2, but the nailgun implementation turned out to be fast enough to be used within Vagrant.\nThe npm bindings came from the project we forked and adapted: https://github.com/evanw/fast-closure-compiler\n. @glensc the python code is not necessary I think - you could also start it via cmd directly or write a shell script.\nI think the jnilib is necessary, yes, because the compiled binary contains platform-specific code. You might find more information about that in the Nailgun docs/repo.\nI am not sure about @evanw s repo, but our fork: https://github.com/Jimdo/fast-closure-compiler contains all needed changes to make it compile on linux.\n. @glensc I closed it because it needs more work before @mrclay will merge it. The usage is easy, you install our nailgun closure compiler fork and point the config to the closure binary in that project.\n. /cc @XiPhe\n. @mrclay any chance of this getting merged?\n. you are right, 'bubbleCssImports' does the trick.\n. @mrclay I don't think so, because you end up with broken CSS if you don't enable it and have import statements that are not at the beginning. It might be a tiny tiny tad faster if you don't have imports at all I guess, because you don't search and apply the regex - but my guess is that the overhead is marginal.\n. good point - for us it is just Google fonts imports, so it is fine.\n. @mrclay any news on this?\n. @mrclay any news on this?\n. I see - we could try extracting an interface that works for both fopen and curl and go from there? \n. I agree, will change the PR\n. Okay, I will update the PR\n. In PHP, unfortunately -200 == true, so personally I think the constant is more clear, but I can change it to if ($this->maxBytes <= 0) { if you prefer that to how it is.\n. :+1: It was actually quite refreshing for a change :smile: \n. @mrclay The ImportProcessor works on a directory. The problem does not exist within a single file, it only occurs when concatenating multiple files together (hence why we need the preprocessor option in Minify_CSS). The actual prependImportStatements method is only an implementation of a specific custom preprocessor being passed to Minify_CSS and thus, I guess, kind of a utility method, however instead of a single method in a utility class it could also be an implementation of a Preprocessor interface with one method if that is something you'd consider better style.\n. Also the ImportProcessor resolves local imports and inlines them. Our problem was having imports from Google Fonts being scattered throughout the minified CSS files, which could not (read: should not) be imported on minifying, but stay within the CSS file as-is.\n. ",
    "joec4i": "Please check it out.\n. Oops, a careless mistake. Sorry about that. It's updated.\n. ",
    "sambauers": "I'll give it a shot and add it to the PR.\n. I changed the way this works slightly in the code. The premise is the same, I just wanted to be able to have a custom config.php, but not necessarily a custom groupConfig.php or config-test.php.\nI also added usage notes in MIN.txt which I am happy to have you review and modify.\n. \"Allow optional custom configs to be optional\" - commit message FTW :thumbsup:\n. Done. I decided to use an array instead of a multiple static variables.\n. Changed 'standard' to 'base'.\n. I haven't been able to run the test suite BTW, so I can't confirm that part.\n. I've added a Pull Request containing the history roll-up for 2.2.0, this issue can probably be closed in favour of https://github.com/mrclay/minify/pull/92\n. Egads, there is an atrocious typo in there:\nanatoher -> another\n. ",
    "GrahamCampbell": "Is this likely to happen soon?\n. I haven't been closely following this repo. Sorry.\n. It looks like the output is gziped and your browser doesn't support it. How old is your browser?\n. :-1: \n. :-1: for changing the vendor folder from the default location.\n. > phpcs\nThat's not \"phpcs\", it's \"php-cs-fixer\". The two are not the same.\n. cs\n. the int cast is preferable to calling the intval function as it's faster, and does exactly the same thing/. Worth changing as a cs rule, if not as a micro optimization. The only reason intval hasn't been removed from the php core is because it can be used with array maps, and the like.. ",
    "davidbehler": "In that case the url is rewritten, but somewhat incorrectly.\ncss\nbackground-image: url(\"../images/Testimonial\\20box.png\");\nturns into \ncss\nbackground-image:url(\"/images/Testimonial/20box.png\");\nUsing %20 works fine though:\ncss\nbackground-image: url(\"../images/Testimonial%20box.png\");\nbecomes\ncss\nbackground-image:url(\"/images/Testimonial%20box.png\")\n. Nope. Server is running on Ubuntu 13.10.\nI tried the debug option and the \"Testimonial Box.png\" variant doesn't even show up in the found matches. The other variants do though.\nAny other info I can provide that might help? I'll try to setup a minimum test case so that you can maybe reproduce this.\nBtw: I actually went through my files and this was the only image with a space in the file name, so it's no longer a pressing issue for me. But would still be a nice fix.\n. Sweet! Thank you!\n. ",
    "msigley": "CSSmin actually handles charsets by saving the first charset occurance and putting that to the top of the CSS file.\nIt however does not currently handle imports and namespaces correctly and only coverts them to lowercase leaving them in their original context. After you make the switch, I can address this is the YUI port.\nIn the meantime this the current pull request serves as a good hotfix for fixing the minified CSS in Safari.\nMy test case was three live sites with the issue. All rendered 100% after the hotfix. I can work on some html examples if you need them.\n. @mrclay hit me up when the conversion is complete and I'll implement the missing at-rules in the YUI port\n. ",
    "greensolid": "Sorry, but I don't understand.\nWhat do you mean?\nBTW I'm also working on a Redis caching class.\n. I let a php beautifier with PEAR style reparse it, hope it looks better now, I will request a new pull with a single commit.\n. OK, forced the new commit.\n. OK, added and resquashed.\n. I reverted the Redis commit, Wincache at least should be good to go?\n. Rebased. Wincache is already working in production for me.\n. ",
    "wgallios": "ahh good to know. Yeah I forked the project, for a submodule. Didn't know it was going to commit back to the main repo. First time lol. But thank you for the feedback, this minifer is awesome =D \n. ",
    "jslegers": "In your example, you do the following :\n``` php\n// Set the document root to be the path of the \"site root\"\n$min_documentRoot = substr(FILE, 0, -15);\n// Set $sitePrefix to the path of the site from the webserver's real docroot\nlist($sitePrefix) = explode('/min/index.php', $_SERVER['SCRIPT_NAME'], 2);\n// Prepend $sitePrefix to the rewritten URIs in CSS files\n$min_symlinks['//' . ltrim($sitePrefix, '/')] = $min_documentRoot;\n```\nI'm not sure why you make it so complex. As far as I can tell, $min_documentRoot = dirname(dirname(__FILE__)); achieves the same result with less code and better performance.\nAlso, it isn't the default setting. Doesn't it make more sense to have this setting as the default?\n. Which standard do you want to follow for class loading?\nI have a minimalistic PSR-0 compatible class loader lying around that I could upload later today if you guys are interested. This loader allows for zero-config autoloading of any PSR-0 compatible classes within one or more folders you choose yourself, and without any dependencies on Composer.\nAdding this (or equivalent) class loader offers you the flexibility of letting your users decide whether they want to use Composer or not, rather than forcing them to use composer.\nLet me know if you're interested. I haven't released the project yet, as I was planning to release it together with a jQuery-like DOM crawler for PHP, but I could release it today or later this week if there's any interest.\n. PSR-0 is the traditional standard most libraries and frameworks implement.\nPSR-4 is a more recent standard that partially breaks with the PSR-4 standard. It released some flak for that and personally I'm not a fan of PSR-4.\nComposer supports both PSR-0 and PSR-4. Its classmap support is intended to define autoloading for all libraries that do not follow PSR-0/4.\nWhile classmap is probably the easiest way to implement autoloading with composer when coming from a non-standard loading strategy, PSR-0 is the best approach if you want both optimal performance and optimal compatibility.\n. @mrclay :\nIn that case, just let me know if you're interested in having your own (Composer compatible) zero-config autoloader. Personally, I think that using your own PSR-0 autoloading class is far easier and far more suitable for small tot mid-size projects than depending on Composer.\nUsing my autoloader (or equivalent), all you really need to do to make a third party library available to your project is adding that library to your \"vendor\" folder (or any other folder in a configurable list of folders).\nIf you're considering the option, I'll upload it as a separate repo on my own account. At that point, you'd still be able to decide whether to use that class or write one yourself.\n. As a sidenote, I found a pure PHP minification library yesterday.\nWhile it doesn't offer the same compression rate as YUI Compressor (see https://github.com/matthiasmullie/minify/issues/21), it could be used as a fallback for YUI Composer for systems where including a JAVA binary isn't an option (for technical or security reasons).\n. ",
    "johndwells": "Yikes, my apologies - I didn't realise that what I was using (2.1.7) was so far behind.  The above error does not occur with the current head.\nSorry & thanks!\n. ",
    "crazyfd": "Google Chrome 34.0.1847\n. ",
    "tomcastleman": "Hi @midorinet \nI am using the following with nginx:\nlocation /min/ {\n        rewrite ^/min/([bfg]=.+) /min/index.php?$1;\n    }\n. ",
    "midorinet": "Hi @tomcastleman \nI can get it running by using rule below\nrewrite  ^/min/([a-z]=.*) /min/index.php?$1  last;. ",
    "jagafirst": "Hi\nI tried the above 2 configuration in Nginx. But its not working\nI am getting 404 Not Found in browser but in Apache its working fine. I do not know whether the issue in NGINX or PHP-FPM.\nMy application is on Yii and compressing ac-clientscript-minify extension \nPlease help to solve this issue. ",
    "rhukster": "I've submitted a pull request against the upstream project.  Thanks!\n. ",
    "jmglsn": ":+1: for that, especially please try to include the used libs with composer. In my current project we are using firephp, included by composer.json - but it conflicts with the firephp version used in minify. The class get's redeclared, both projects are not using any namespaces...\n. @glensc you mean the v2 branch? That's cool but the external components are still copy paste instead of being composer references. Changing this would fix the problem.\n. ",
    "acidvertigo": "will try\n. Yes is a typo error\n. Don't know why! I've edited the code on github webpage\n. Also on editor is the same. Very strange...\n. Thank you\n. ",
    "Vovan-VE": "Sorry, I lied a few. The result is treated as string \"lorem\", division / to string \"+\", multiplication * to string \"ipsum\" and multiplication * to... It would be an regexp /..., but it's a syntax error.\n. ",
    "redbox-cdn": "Hi thank you for reply\nI will check the rewrite snippet. \n Thanks\n. ",
    "szepeviktor": "Thank you for your answer.\nCould share your HTML minification solution with me?\n. I meant the code you use to minify HTML.\nAs I understand it is not HTML.php in this repo.\n. ",
    "Scooby-2": "Hi Steve\nMany thanks for this. Really quick, too. I'll check it out ASAP but having\njust signed up with Arvixe I was having connection problems (both web pages\nand ftp). I raised a Support ticket but after over 24 hours without a\nresponse I am going to cancel. I since discovered from currentlywww.down.com\nthat they suffered a 26-hour outage on April 1st/2nd. I'm now with\nSiteGround but they do have the same directory structure but I'm starting\nagain from scratch.\nI'll keep you posted.\nRegards\nKevin\nOn 5 April 2015 at 20:56, Steve Clay notifications@github.com wrote:\n\n@Scooby-2 https://github.com/Scooby-2 give this a shot if you can.\n@glensc https://github.com/glensc Do you think this would cause any BC\nproblems?\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/mrclay/minify/pull/138#issuecomment-89831980.\n. Hi Steve\nJust to let you know that I effected the changes you suggested but was still having problems because, I think, with my new hosting company the Minify directory was in /~userid/public_html/oldsite/min. I spent a day on it without success but at the same time support were looking into it and they got it working. All I know for sure is that they moved everything up one level, so the site was in public_html and not a sub-directory off that.\nI'm sorry I can't help more but I'm under pressure to get things working quickly.\nThanks for your help and promptness on this.\n. \n",
    "KTOmega": "Oh, and I also converted the README into Markdown, just to look pretty.\n. Two separate pull requests?\n. OK - I'm going to close this PR and open two separate ones.\n. Ah, alright. Sorry, I'm not very experienced with Git. I'll go ahead and make your changes in a bit and change this PR.\n. Alright. README.txt was renamed to README.md and modified accordingly.\n. ",
    "ChristopherWalz": "Can you confirm this as a bug?\n. Thank you. One more question: Why are double slashes at not allowed at this point: https://github.com/mrclay/minify/blob/master/min/lib/Minify/Controller/MinApp.php#L105\nDo I have to replace them by the full domain ?\n. ",
    "santoja": "@mrclay the code has been changed\n. @mrclay verification changed. Now it's on a loop in the serve function\n. I'm sorry @mrclay! I didn't saw your changes, they fixed the same thing.\n. Thanks for all your considerations @mrclay. I'll rework it and commit\n. Fixed! Thank you @GrahamCampbell!\n. ",
    "iflist": "Hi mrclay, we have been using your plugin successfully on our site for a while now. However, I've recently noticed that the expires header for our minified JS files keeps updating to a later date every time I load a page that includes it. I am checking the requests for the page in Chrome dev tools. \nI DO see it working when I navigate directly to the file in my browser, but not within a list of other requests. It shows me a different expires date in each case.\nhttp://iflist.com/min/?f=js/jquery-ui-1.10.0.custom.min.js,js/jquery.slimscroll.min.js,js/global.js,js/modal.js,js/LikeDislikeManager.js,js/CommentManager.js,js/modernizr-latest.js,js/post_page.js,js/file-upload/script.js,js/plugins/select2-3.4.5/select2.min.js,js/plugins/multiple-select/jquery.multiple.select.js,js/file-upload/jquery.filedrop.js,js/trunk8.min.js,js/jquery.waitforimages.min.js,js/jquery.lazyload.min.js\nCan you provide any insight?\n. Thanks. I already noted the max-age setting and that part works fine. I do not have caching disabled in my browser. However, unlike some of the other included files on my pages, the \"Date\" and \"Expires\" on your minified file keep changing on every page load (they are always exactly a half-hour apart), which does not make sense. How will it ever expire?\n\n. Okay, thanks for the explanation. I didn't think I was actually doing a hard refresh, but there could be something to that.\n. Hi mr. clay, I am currently implementing a mini versioning system using this method. However, I am finding that that adding the version number to each file within a comma-separated list causes the file merging to break.\nExample (does not work):\n\nCan you let me know if I am overlooking something?\nThanks!\n\nOn Sep 24, 2015, at 8:10 PM, Steve Clay notifications@github.com wrote:\nYou'll get the best caching by appending a version to the URLs like &v=1. If $_GET['v'] is present, Minify uses a year for the max-age. That would mean that you'd have to manually change your URLs whenever you changed a source file.\n\u2014\nReply to this email directly or view it on GitHub https://github.com/mrclay/minify/issues/469#issuecomment-143086042.\n. Thanks! That format works out well for me. I set the maxAge property in config.php to 31536000 in order to get the expires date set to 1 year in the future, and everything seems to be working correctly.\nOn Oct 12, 2015, at 1:30 PM, Steve Clay notifications@github.com wrote:\nYou could do this:\n<link rel=\"stylesheet\" href=\"/min?f=styles/reset.css,styles/global.css,styles/jquery-ui.css&v=3307,5211,1235\u201d />\nor just use the Minify_getUri https://github.com/mrclay/minify/blob/2.x/min/utils.php#L18 function.\n\u2014\nReply to this email directly or view it on GitHub https://github.com/mrclay/minify/issues/469#issuecomment-147469149.\n. \n",
    "rmoni3000": "I'm having a similar problem with schema script tag \"application/ld+json\", the minify just wipe out the entire JSON inside the tag, how should I proceed?\n. ",
    "scott-thrillist": "Thanks for this patch Steve, but this doesn't work out of the box.  Need to do this on the return:\nreturn $this->_reservePlace($typeJS && $this->_needsCdata($js)\nOtherwise it reinserts the CDATA for \"text/template\"\n. Made here: https://github.com/mrclay/minify/pull/598. I'm not sure what you mean by that, sorry. Do you need me to do anything else so we can merge?. ",
    "danmarsden": "I've just run into this issue with RGraph.line.js too:\n(0).toFixed(\nconverts to\n0.toFixed(\nI'll report it to the RGraph team as well becuase it does look like some weird code but adding it here as it might help others when searching.\n. Here's the RGraph post for anyone interested:\nhttp://www.rgraph.net/forum/message.html/conflict-with-rgraph-and-minify-20151011214210.html\n. ",
    "artworker": "cooooooooooooooool.\ni was so stupid!\n. ",
    "KimTheFirst": "I figured it might just be that the docs weren't updated yet. I've created a pull request.\n. lowercase array(\n. I'll do that shortly. First time using github so just finding my way around.\n. ",
    "ivanblagdan": "It breaks off at <script type=\"text/javascript\">document.write('\nIts part of a bigger source so i can't really figure out if the tag closes somewhere afterward.\n. I think thats the case. This library is actually a dependency in a third party WordPress plugin thats having issues and this seems to be the issue. Sorry I might have been to fast to report here.\nThank you for looking into this!\n. ",
    "BillyGeat": "I have put two var_dumps just before this if-test here\nif (strpos($spec['filepath'], $allowDir) !== 0) {\nand the result of the two comparing parts is:\n$spec['filepath']: string 'D:\\Projekte\\website\\htdocs\\min\\quick-test.js'\n$allowDir: string 'D:\\Projekte\\website\\htdocs/'\nAs you see, the trailing \"/\" in $allowDir is the \"problem\", so (maybe) normalizing the paths (if I understood this correctly) could be the solution.\n. ",
    "iwalz": "There is indeed a problem with this (or at least one).\nI ran into the same issue and I've tried to trace it down. But in fact, whatever I configure in config.php as allowDir or symlink will never end up in Minify_Source_Factory.php - it gots there options from the __construct, but those are using the following lines in index.php:\n``` php\n$sourceFactoryOptions = array();\n// translate legacy setting to option for source factory\nif (isset($min_serveOptions['minApp']['noMinPattern'])) {\n    $sourceFactoryOptions['noMinPattern'] = $min_serveOptions['minApp']['noMinPattern'];\n}\n$sourceFactory = new Minify_Source_Factory($env, $sourceFactoryOptions, $cache);\n```\nI don't see any way to get those variables passed through from config.php ...\nAnd the other weird behaviour: Even if allowDirs could match, how do you recover from the Exception if not the first matches, but the second?\nphp\nforeach ((array)$this->options['allowDirs'] as $allowDir) {\n  if (strpos($spec['filepath'], $allowDir) !== 0) {\n    throw new Minify_Source_FactoryException(\"File '{$spec['filepath']}' is outside \\$allowDirs.\"\n        . \" If the path is resolved via an alias/symlink, look into the \\$min_symlinks option.\");\n    }\n}\nI'd say: \n- [ ] proper merge of the configs needs to be done\n- [ ] Keep state in the loop and throw exception outside of the loop \nI'll try one of the latest release tags to see if this works. Master can't work from my understanding (at least not with the whole documented featuresets - since you're in the middle of a refactoring?!).\nP.S.: This is not a windows related problem.\n. What kind of version would you consider for production usage?\nI've tested the last 3 releases and the master - and none of them worked for me without some code modifications. \nI need:\n- symlinks\n- groups\nSymlinks are not working in older releases because of some hardcoded doc_root prepends in Minify_Controller_MinApp:\n$path = $_SERVER['DOCUMENT_ROOT'] . $uri;\nMaster is not working at all for me (loosing configs, etc).\nI'd really like to use your minifier, but every implementation feels dirty ...\n. You see a chance to get symlinks somehow working on 2.2.1?\nIt's correctly merged to allowDirs, but due to the prepend of the document root, I ended up with something like ?f=../../../foo/bar/blubb.css which might be different in different stages (prod, dev, stage, whatever).\n. ",
    "demidovsky": "Hi everyone, I got the same error message as discussed in this topic (I am running XAMPP under Win7).\nBut I found that the reason is not in trailing slash, but in slash direction.\nAlso I detected that drive letters have different case.\nMy attemp to fix this is here: #496\nAny feedback or improvements would be appreciated.\n. ",
    "BSprite": "I wasn't having success with this issue either.  I made a rather small change to Factory at line 141 inside the foreach loop:\n\n$allowDir = str_replace(array('/', '\\'), DIRECTORY_SEPARATOR, $allowDir);\n\nIt resolved my issue after adding the symlink in the config.  I'll add a PR maybe if anyone else is resolved.\n. ",
    "avalade-martin": "The default settings don't work on my Windows Apache as well.\nI changed line 110 (the last line of function checkIsFile) in lib/Minify/Source/Factory.php to the following to solve the string comparison issue:\nreturn str_replace('\\\\', '/', $realpath);\n. ",
    "momoca": "replace to : \nif (strpos(realpath($spec['filepath']), realpath($allowDir)) !== 0) {\nuse realpath...\n. ",
    "sjosen": "I updated today and load time is now almost 2 minutes for 18 js files in group \n\nNever had any issues with the old version\n. After clearing the tmp dir and empty the browser cache the css file is being generated right away and the js file takes 1 minute.\n\n. I'm still having issues with this. Rebuild takes about 30 seconds. Version 2 takes about 3\n. Hi and thanks\nDon\u2019t know if I\u2019m supposed to reply to this email so sorry if not.\nI tried the master branch and used the provided readme for installing (using composer). I still takes 10x compared to version 2 to process the files. Perhaps I\u2019m doing something wrong :o)\n/ sjosen\n\nOn 29. aug. 2016, at 04.35, Steve Clay notifications@github.com wrote:\nHave you tried the master branch, which includes #511 https://github.com/mrclay/minify/pull/511? File layout is a tiny bit different, but should be easy.\n\u2014\nYou are receiving this because you commented.\nReply to this email directly, view it on GitHub https://github.com/mrclay/minify/issues/499#issuecomment-243019657, or mute the thread https://github.com/notifications/unsubscribe-auth/AEaMGNAAwvYg_K4cuWvGjQ2q7c5ENhJmks5qkkWJgaJpZM4HE5bZ.\n. \n",
    "futtta": "I added this one a couple of months ago, seems applicable?\n. Can't help you out there really, but the easier road forwards could be to use jch-optimize, which seems to use some of mrclay's minify?\n. ",
    "hosamalzagh": "i resolved change Permissions from root to my username and save config.php\n. ",
    "Corsari": "Sorry for this delayed reply\nthank you so much for replying\nMake many css and js files calls to become one or two only, will satisfy so much the current google quality checks.\nI'll do my tests and hopefully update you\nThough the so called above the fold content should be \"inlined\" which requires to insert the CSS part concerning that content in the head part without link to external css and the same for js (looks like)\n. The quicktest.js return this\nYou must set up the project dependencies, run the following commands: curl -sS https://getcomposer.org/installer | php php composer.phar install\nI'm developing on a windows installation of xampp\nI've installed composer for windows and run composer install in the /min directory I have in the windows xampp'  /htdocs directory\nIt has downloaded a lot of dependencies, so I don't understand the above message.\nThough I have no clue of how to run this command in windows\ncurl -sS https://getcomposer.org/installer | php php composer.phar install\nand \"where\" to run it\ncan you help?\n. I've installed curl for windows\nrunning the requested command from inside the min directory it returns this\nD:\\xampp\\htdocs\\min>C:\\\"Program Files\"\\cURL\\bin\\curl -sS https://getcomposer.org/installer | php php composer.phar install\nCould not open input file: php\ncurl: (23) Failed writing body (0 != 16133)\nwhat are the two php strings? Maybe one requires some path to somewhere.\nOne kind questions, was it impossible to provide a working set of files and directories?\n. Sorry I'm really lost\nis there a way to use this without composer with just one download and unzip?\nNext obviously I'll follow the documentation\n. About composer install, I have done it, but the test you suggest gives the above error\n. I went on\nI've uploaded the /min directory (which after composer has its subdirectory called vendor with so many sub dirs) to my hosting provider\nthis is the content of the vendor directory http://snag.gy/IIk44.jpg\nI've tried to run http://www.MyURLname/initia/min/?f=min/quick-test.js\nI get a different error now\nParse error: syntax error, unexpected T_FUNCTION in /web/htdocs/www.MyURLname/home/initia/min/index.php on line 33\ncan you kindly hint about the problem?\nthank you\n. I have noticed that if I run the program /min/server-info.php I get the same error in line n.65\nmy provider runs PHP version: 5.2.172.0\nuh-oh ... looks like you require an higher php version...\n. I've tried these options\n//$min_documentRoot = '';\n//$min_documentRoot = substr(__FILE__, 0, -15);\n//$min_documentRoot = $_SERVER['SUBDOMAIN_DOCUMENT_ROOT'];\nThe default one documentRoot = '' giver 400 bad request as the last one\nThe second one gives \"content coding error\" (sorry translated from Italian)\n. If I run the common php server info test and I have this\nDOCUMENT_ROOT  /web/htdocs/www.websitename.it/home/\nwhere the path to my /tests directory becomes\n/web/htdocs/www.websitename.it/home/tests/\nand so\nmin directory is\n/web/htdocs/www.websitename.it/home/tests/min/\nCSS are in\n/web/htdocs/www.websitename.it/home/tests/css/\nand the index page calling the CSS files is in\n/web/htdocs/www.websitename.it/home/tests/\n. ",
    "highstrike": "I see...\nI use composer and I've added minify as a dependency in my project to compress html, css and js. I call those classes directly. I do not need the caching, controllers and combining. I do that myself.\nI use Minify_HTML for html, CSSmin for css and Minify_JS_ClosureCompiler for js\njson\n\"require\": {\n    \"ext-pcre\": \"*\",\n    \"firephp/firephp-core\": \"~0.4.0\",\n    \"mrclay/jsmin-php\": \"~2\",\n    \"php\": \">=5.3.0\",\n    \"tubalmartin/cssmin\": \"~2.4.8\"\n},\nThe only standalone package is the CSS one tubalmartin/cssmin. I also see mrclay/jsmin-php but i prefer the closure compiler... so that's why i have to require the whole minify package but it's quite outdated because of the lack of releases / tags :disappointed: \n. I could do that, and then forget about updating it for a few years myself.. haha.\nI'll have to write a reminder about it so I don't forget and switch to a release when there will be one eventually or when the components are separated into their own package.\nThanks!\n. :+1: \n. ",
    "Concept211": "No, I mean where Minify stores the actual cache files. I don't know if it's an Windows-related issue or what, but no matter what I change the $min_cachePath filepath to, it always saves the cache files to a directory named cache, one directory up from where I install the application.\nFor instance, I placed Minify in \\libraries\\min and so it creates and places the cache files in \\libraries\\cache. If I place Minify in \\min, it'll create and place the cache in \\cache.\nDoes that make sense?\n. Doh! I'm so sorry for wasting your time. I have a secondary script which minifies the HTML output as well and it was creating that cache directory facepalm\nThanks for all of your hard work on this project - much appreciated!\n. Nevermind. Ended up writing my own expression instead of using suggested ones and it works great. Here's the snippet if anyone needs it:\n// Remove Comments\nfunction postProcess($content, $type) {\n    $content = preg_replace('~\\/\\*\\!.*?\\*\\/~s', \"\\n\", $content);\n    $content = trim($content);\n    return $content;\n}\n$min_serveOptions['postprocessor'] = 'postProcess';. ",
    "Tabrisrp": "That's right. I should add that it's also the case for the mask property. An example:\n```\n\n\n\n\n\n\n\n\n\n        <rect class=\"hbar\" x=\"1\" y=\"0\" width=\"100%\" height=\"100%\"></rect>\n    </svg>\n\n```\nsvg.separator rect.hbar {\n    -webkit-mask: url(#mask-stripe);\n    mask: url(#mask-stripe);\n    fill: #a9a9a9\n}\n. ",
    "ri8ika": "I am trying to use this in joomla. So, I would like to do the following:\ntemplates->index.php:\n<script src=\"<?php echo $this->baseurl ?>/templates/<?php echo $this->template; ?>/javascript/one.js,<?php echo $this->baseurl ?>/templates/<?php echo $this->template; ?>/javascript/two.js\"></script>\nSo, how can I set up exactly? Can you please guide me?\n. ",
    "daneren2005": "I agree that most of that logic should be directly in classes.  I implemented it that way simply because I am calling it from the outside and want to keep Minify vendored.  I am also fine with having it only in 3.0.  I just wrote that against 2.3 since that is the latest release at this point.\n. Updated code sample to add content hashing to compiled files so you can use CloudFlare caching and still get updates when the file contents are changed:\n$newFilePath = $folderName . '/' . $groupName . '-' . md5($minifiedData['content']) . ($fileExtension ? ('.' . $fileExtension) : '');\n. ",
    "otzy": "also committed a fix for DOCUMENT_ROOT issue\n. I'm sorry, master branch looks quite differently. $_SERVER['DOCUMENT_ROOT'] is used in many places and it's hard to figure out whether issue still exists.\nThe problem was that file names were realpathed, but comparison was with not realpathed DOCUMENT_ROOT\nI appreciate if you could pay attention to this problem\n. thanks a lot!\n2016-05-12 19:31 GMT+02:00 Steve Clay notifications@github.com:\n\nIn min/lib/Minify/Controller/MinApp.php\nhttps://github.com/mrclay/minify/pull/527#discussion_r63062361:\n\n@@ -136,13 +136,14 @@ public function setupSources($options) {\n                 $base = '/';\n             }\n             $allowDirs = array();\n-            $document_root = realpath($_SERVER['DOCUMENT_ROOT']);\n\nMy latest commit\nhttps://github.com/mrclay/minify/commit/de39966e9c2ba90b7e400f92b867f6592e34046f\nhandles this for the upcoming 3.0. In 2.x, you should manually set\n$_SERVER['DOCUMENT_ROOT'].\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly or view it on GitHub\nhttps://github.com/mrclay/minify/pull/527/files/42d9041d2d744995c10c0c3bba34648df9864211#r63062361\n. \n",
    "orizzle": "Thanks.  Check the URL again - the source is un-minified\n. ",
    "propertunist": "oh, i just found your combiner plugin for elgg :)\nhttps://github.com/mrclay/Elgg-mrclay_combiner\n. ",
    "Conver": "Very nice. Can't wait to be able to use this function. Hopes it gets included in next version\n. ",
    "shtse8": "Any updates?. ",
    "solleer": "It is because the wrong headers are sent.\n. Nevermind. I fixed it.\n. ",
    "arnisjuraga": "the same problem - if $min_concatOnly = false; then\n~~~js\n})(jQuery);\n;/! http://mths.be/placeholder v2.0.7 by @mathias /\n;(function(window, document, $) {\n~~~\nwill be parsed as:\n~~~js\n/ 340 / })(jQuery);\n;\n/ jquery.placeholder.js /\n/ 1   / /! http://mths.be/placeholder v2.0.7 by @mathias /\n/ 2   | ;(function(window, document, $) {\n~~~. ",
    "Pok4": "http://i.imgur.com/ePF4LxR.png\ntext/html\nedit:\nhttp://i.imgur.com/yYao2hb.png\nedit2:\nI have htaccess. Here is the content:\n```\nImportant rules for our system\nOptions -Multiviews -Indexes +FollowSymLinks\nPHP 7 Settings\nAddType application/x-httpd-php7 php\nModRewrite ON\nRewriteEngine On  \nRouter\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule ^(.*)$ index.php [QSA,L]\nAddOutputFilterByType DEFLATE text/plain\nAddOutputFilterByType DEFLATE text/html\nAddOutputFilterByType DEFLATE text/xml\nAddOutputFilterByType DEFLATE text/css\nAddOutputFilterByType DEFLATE application/xml\nAddOutputFilterByType DEFLATE application/xhtml+xml\nAddOutputFilterByType DEFLATE application/rss+xml\nAddOutputFilterByType DEFLATE application/javascript\nAddOutputFilterByType DEFLATE application/x-javascript\nspecial fonts compression\nAddType application/vnd.ms-fontobject .eot\nAddType application/x-font-ttf .ttf\nAddType application/x-font-opentype .otf\nAddType application/x-font-woff .woff\nAddType image/svg+xml .svg\nAddOutputFilterByType DEFLATE application/x-font-ttf application/x-font-opentype image/svg+xml\nBEGIN Cache-Control Headers\n\n#expires\n  ExpiresActive On\n  ExpiresDefault \"access plus 1 seconds\"\n  ExpiresByType image/x-icon \"access plus 2592000 seconds\"\n  ExpiresByType image/jpg \"access plus 2592000 seconds\"\n  ExpiresByType image/jpeg \"access plus 2592000 seconds\"\n  ExpiresByType image/png \"access plus 2592000 seconds\"\n  ExpiresByType image/gif \"access plus 2592000 seconds\"\n  ExpiresByType application/x-shockwave-flash \"access plus 2592000 seconds\"\n  ExpiresByType text/css \"access plus 604800 seconds\"\n  ExpiresByType text/javascript \"access plus 216000 seconds\"\n  ExpiresByType application/javascript \"access plus 216000 seconds\"\n  ExpiresByType application/x-javascript \"access plus 216000 seconds\"\n  ExpiresByType application/xhtml+xml \"access plus 600 seconds\"\n\n    Header set Cache-Control \"max-age=2592000, public\"\n  \n\n    Header set Cache-Control \"max-age=604800, public\"\n  \n\n    Header set Cache-Control \"max-age=216000, private\"\n  \n#vary\n  Header append Vary Accept-Encoding\n  Header append Vary User-Agent\n#security headers\n  Header set X-XSS-Protection \"1; mode=block\"\n  Header always append X-Frame-Options SAMEORIGIN\n  Header set X-Content-Type-Options: \"nosniff\"\n  Header unset X-Powered-By\n#below not works on some nginx servers\n  ServerSignature Off\n  Header unset Server\n  Header always unset Server\n#etag header unset \n  Header unset ETag\n  FileETag None\n#lastmodified header unset\n  Header unset Last-Modified\n\nlibperl to prevent http flood\nRewriteCond %{HTTP_USER_AGENT} libwww-perl. \nRewriteRule . ? [F,L] \nremove end trailing slash from urls\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteCond %{REQUEST_URI} /(.*)/$\nRewriteRule ^ /%1 [R=301,L]\n```\n. ",
    "salkii": "Thanks for the replay, i don't think so is not working for me is just white pag, can you send me a capture of your screen, this is my screenshot:\n\nanother thing in the first time i generate url is working but when i click ctrl+F5 to clear cash and refresh i get the white page again\nfor example when i delete japp.js and refresh the code is working but when i ctrl+F5 is just a white page\ncan you help me to solve this problem?\n. How i can to clear cache files on the server? can you help me how can i do that?\nThank you!\n. Hi, is no cache files on this directory\nFILE        : /home/starmaro/public_html/min/server-info.php\nSCRIPT_FILENAME : /home/starmaro/public_html/min/server-info.php\nDOCUMENT_ROOT   : /home/starmaro/public_html\nSCRIPT_NAME     : /min/server-info.php\nREQUEST_URI     : /min/server-info.php\n. Is the problem on the minify script or what, as you can is no cache files on the server.\ncan you help me to fix that problem?\n. Ok, i update the file you upload today\nThis is the result:\nFILE        : /home/starmaro/public_html/min/server-info.php\nSCRIPT_FILENAME : /home/starmaro/public_html/min/server-info.php\nDOCUMENT_ROOT   : /home/starmaro/public_html\nSCRIPT_NAME     : /min/server-info.php\nREQUEST_URI     : /min/server-info.php\nCache directory : /tmp\n. ",
    "rhclayto": "That's the result of the PHP7 Compatibility Checker: https://github.com/sstalle/php7cc. ",
    "MikeOtown": "I fixed this issue by modifying lib/Minify.php line:\nif (self::$_options['encodeOutput']) {\nto \nif (false)\nwhy is there no setting for this in config.php?\nCommon Issues document mentions this problem, but it implies that gzip should be disabled on the server.  Why not disable Minify gzip?  So all of my other files can still be zipped.. ",
    "barisunver": "I'm afraid I don't have the skills to prepare such a complex regex rule \ud83d\ude1e or even use GitHub with pull requests and such \ud83d\ude2d . ",
    "rusjoan": "@mrclay I guess you shouldn't wait for those changes in 3rd party project, it seems to be dead. Yay! It's merged now. ok ;)\nbtw why it's faster?. ",
    "bertptrs": "Can we move on with the fork? There has been nothing but silence from the upstream for the past month, and this is a rather breaking issue.\nFor now, I have resorted to using the composer-patches plugin and applying this patch manually.. Ping once again, can you do a release with the correct patch applied?. ",
    "hanaks": "The getDigest function includes only absolute paths on the filesystem. See screenshot:\nhttps://imagebin.ca/v/3BdBNi763oUU\nThese paths are always the same, because they are always pointing to the same physical files, regardless of what is the base path in the urls (the 'b' parameter). But the generated files will have different content, depending on the base path. For example the two requests below will point to the same physical source files and thus the getDigest will return the same for both, but the content of the minified files will be different:\nhttp://www.somedomain.com/subdir/min/?b=subdir%2Fskin&f=default%2Fstyle.css%2Cdefault%2Fmobile.css\nhttp://subdomain.someotherdomain.com/min/?b=skin&f=default%2Fstyle.css%2Cdefault%2Fmobile.css\nThe first minified css file will have urls to images like \"/subdir/skin/default/image/img.png\", the second like \"/skin/default/image/img.png\". The issue is that the generated cache key is the same for both, while the content isn't. The solution is to vary the cache key by the 'b' querystring parameter. So the first should include 'subdir%2Fskin' and the other 'skin'.. ",
    "mashedkeyboard": "At least, I thought this was the problem... hadn't seen that $_SERVER['DOCUMENT_ROOT'] was overridden in index.php. Hmm...\nTime for a \"why has getLastModified() stopped working\" hunt!. Okay, so I gotta admit, I'm confused by this code. Why are we setting $_SERVER['DOCUMENT_ROOT'] manually in the first place? That strikes me as a bad idea.\nFor now, I'm just going to reset it at the top of helper.php, as frankly I'm lost.. ",
    "boynet": "sorry got confused about it anyway I moved it to master\nhttps://github.com/boynet/minify/tree/master\nabout PHPUnit I am afraid that I dont have the knowledge to do that :( anyway its a simple code I hope someone else can help here. ",
    "Shade-": "Hi, I'm still encountering this issue.. ",
    "timkelty": "Related: https://github.com/mrclay/minify/issues/587. ",
    "khalwat": "hmmm. I did a fresh composer install after deleting composer.lock as well as the entire vendor directory.\nIt did include mrclay/jsmin-php in the actual vendor folder, but it's not auto-loaded (it doesn't appear anywhere in the autoload_classmap.php\nIs that expected behavior?. ugh, sorry for that. I can't believe I overlooked autoload_namespaces.php. I can verify that Facebook has fixed this bug.\n\n. ",
    "ruizr-ignacio": "Do you found any solution?. ",
    "olahat90": "Thanks. ",
    "tubalmartin": "Hi @mrclay, just pinging so you consider updating CSSmin lib version to v3.3.x or v4.x. v2.4.x branch should be considered buggy and obsolete.\nv3.3.x and the new v4.x are the most stable by a large margin.. ",
    "walderT": "I have currently no access to my development machine. Can you set a breakpoint at \n\\Minify_CSSmin::minify\nand look if there is the symlink in the $options parameter?\nI am sure, that this was in my case not set. Maybe because I am using the new \"static\" feature?\nOr using a group config?\nMy request:\n/min/static/0/g=cssV3&z=.css\nI will look tomorrow if its different if I use the \"normal\" call, as you in your example. \n. Hi,\nhere is my result.\nRequest:\n/min/&f=/min/quick-test.css\n$options in \\Minify_CSSmin::minify\n```\nArray\n(\n    [docRoot] => /app/web\n    [symlinks] => Array\n        (\n            [//myfiles] => /app/web/myfiles\n            [//min] => /app/web/min\n        )\n[currentDir] => /app/web/min\n\n)\n```\nRequest:\n/min/static/0/&f=/min/quick-test.css\nArray\n(\n    [currentDir] => /app/web/min\n)\ndocRoot is also missing, don't know if this is also required?\n. ",
    "mat-overclockers": "Have you considered using the apcu_bc extension for backwards compatibility?\nhttps://pecl.php.net/package/apcu_bc. ",
    "DiV666": "Sorry, I forgot to include autoload.php. Now it's working.\nThank you.. ",
    "angrybrad": "This also fixes it for 4-byte unicode characters, like \ud841\udf0e \ud841\udf31 \ud841\udf79 \ud843\udc53.. Would be difficult. Was only able to reproduce it using the latest version of MAMP.  Assumed it had something to do with the version of PCRE installed (8.38), but tried outside of MAMP using that same PCRE version and it worked fine. Having a difficult time tracking down what the source is.. ",
    "benface": "Just added some more u flags (in all the preg_ functions in HTML.php, basically) because I could still reproduce the issue with differently formatted HTML (still containing the &nbsp; character).. ",
    "amityweb": "Oh sorry, not sure I how I got here. I remember following several links to \"support\" but must have been something else! Ok thanks for letting me know. . ",
    "sprankhub": "Thanks for your hint, correction and feedback!\nMy numbers were weird, because I copied the source from the \"view sources\" tab, which is not a good idea. I did the test again and also used gzip:\n\n128,0 KB original\n118,9 KB minified with 2.3.2\n118,8 KB minified with 2.3.2 without the artificial line breaks (I simply added a comment to the above linked line)\n25,11 KB original gzipped\n24,70 KB minified with 2.3.2 gzipped\n24,68 KB minified with 2.3.2 without the artificial line breaks gzipped (I simply added a comment to the above linked line)\n\nThe difference is indeed minimal - especially when gzip is used. Hence, it is not a real issue.. ",
    "ToX82": "After a little more digging into the code I have found that setting a few more parameters in my call could solve the same problem:\n    $content = \\Minify_JS_ClosureCompiler::minify($content, [\n        'compilerUrl' => 'https://closure-compiler.appspot.com/compile',\n        'compilation_level' => 'SIMPLE',\n        'output_format' => 'text',\n        'output_info' => 'compiled_code',\n    ]);\n\nStill, I think that setting the default url to https would be useful, since http seems to be deprecated. Also, having those parameters set as default in ClosureCompiler.php would make the code more straightforward for other users in my situation.. ",
    "AlexisFernandez": "When I make any change on my closureCompiler.php file the images of my site disappear...\n. ",
    "wordkeeper": "Hi Steve,\nJust curious, did you actually read the bug report or just see the word\n\u201cWordPress\u201d and assume that this had something to do with a plugin?  I\nnever mentioned a plugin - namely because this bug report has nothing to do\nwith a plugin.\nThis is a stock install if your Minify library with no other code\ninvolved.  The only thing this even has to do with WordPress is that we\nprovided a CSS file to your minifier that is part of a stock WP theme. CSS\nis just CSS, though.  I could have named a CSS file from anywhere.  But\nsince the bug is only manifesting for me so far with this example, I wanted\nto give you that information so you can see the problem with the\nminification with a real css file and track down the problem.\nOn Thu, Dec 14, 2017 at 12:49 PM Steve Clay notifications@github.com\nwrote:\n\nI don't have anything to do with the WP plugin, sorry.\n\u2014\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\nhttps://github.com/mrclay/minify/issues/620#issuecomment-351801284, or mute\nthe thread\nhttps://github.com/notifications/unsubscribe-auth/AAXiVeAYoiCOXQbNU_JQiGBjD03hXnCQks5tAW2bgaJpZM4Q7uiA\n.\n-- \n\n-- \nLance Dockins\nMinister of Magic\nVRAZER, LLC\nOffice: 405.585.2500 \nCell: 405.306.7401 \n. ",
    "nbokkisam": "@mrclay can you please help with this issue?. ",
    "neoswf": "Hey @aman-cfaqs. I got this problem as well. Have you managed to solve it?. ",
    "designcise": "Sorry, nevermind, there was an extra ending curly brace in one of the CSS files, that was making the CSS rules from the last appended file unreadable.. ",
    "dialeleven": "Were you able to fix the issue above @jgodstime? I'm getting the same on Linux Lite. It runs fine on Windows 7 with XAMPP. . ",
    "silvant": "Sorry wrong repository. ",
    "rafaelcavalcanti": "In fact, is when i user the whole code inside the bootstrap.min.css\nThanks. I split the code in two '",
    "dennisenderink": "Shouldn't this be $i < $rgb?\n. ",
    "Ocramius": "Which library are we talking about? If it's the old stuff I worked on 4 years ago, I'm not sure if it should be reused anymore :-)\n. ",
    "lauripiisang": "Should it be Minify_ScssCssSource or Minify_ScssSource? If Minify_ScssCssSource, shouldn't it extend Minify_CssSource?\n. If the class isn't final, Why have private properties in favor of protected ones?\n. \"unique\" amounts to common string + md5 hash these days?\nEither provide some actual uniqueness (via UUID or similar) or drop the word unique\n. Lines 90 - 96 look like something that belongs inside a cache adapter\n. from the implementation of this method, if $cache is an array with at least one value OR an instance of  ArrayAccess , it isn't considered \"stale\", regardless of contents (as long as there's no 'files' index).\n. Why the public visibility all of a sudden, if most of the rest of this class seems to be private?\n. STYLE: seems that half of this method is shifted by one space, here's where the shift starts\n. Why does test include var_dumps ?\n. I find \"~0.3\" a bit more expressive than this.\nThis gives off the notion of a very specific version, but actually, it's \">= 0.3.0 <1.0.0\" (at least since composer 1.0.0 ) https://getcomposer.org/doc/articles/versions.md#caret\n. ",
    "jenstornell": "Ahh, I see. =) Anyway, a bit off topic but I just released an own html minifier. https://github.com/jenstornell/tiny-html-minifier. @glensc I intend to keep it maintained.\nI set PHP7+ to not disapoint anyone, but I've tested it now with https://3v4l.org/ and it works down to 5.4 which I think is fine.. "
}